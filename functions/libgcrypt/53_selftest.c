selftest (void)
{
  SEED_context ctx;
  byte scratch[16];

  /* The test vector is taken from the appendix section B.3 of RFC4269.
   */
  static const byte plaintext[16] = {
    0x83, 0xA2, 0xF8, 0xA2, 0x88, 0x64, 0x1F, 0xB9,
    0xA4, 0xE9, 0xA5, 0xCC, 0x2F, 0x13, 0x1C, 0x7D
  };
  static const byte key[16] = {
    0x47, 0x06, 0x48, 0x08, 0x51, 0xE6, 0x1B, 0xE8,
    0x5D, 0x74, 0xBF, 0xB3, 0xFD, 0x95, 0x61, 0x85
  };
  static const byte ciphertext[16] = {
    0xEE, 0x54, 0xD1, 0x3E, 0xBC, 0xAE, 0x70, 0x6D,
    0x22, 0x6B, 0xC3, 0x14, 0x2C, 0xD4, 0x0D, 0x4A,
  };

  seed_setkey (&ctx, key, sizeof(key), NULL);
  seed_encrypt (&ctx, scratch, plaintext);
  if (memcmp (scratch, ciphertext, sizeof (ciphertext)))
    return "SEED test encryption failed.";
  seed_decrypt (&ctx, scratch, scratch);
  if (memcmp (scratch, plaintext, sizeof (plaintext)))
    return "SEED test decryption failed.";

  return NULL;
}