aria_gsrk(u32 *rk, u32 *x, u32 *y, u32 n)
{
  int q = 4 - (n / 32);
  int r = n % 32;

  rk[0] = (x[0]) ^
	  ((y[q % 4]) >> r) ^
	  ((y[(q + 3) % 4]) << (32 - r));
  rk[1] = (x[1]) ^
	  ((y[(q + 1) % 4]) >> r) ^
	  ((y[q % 4]) << (32 - r));
  rk[2] = (x[2]) ^
	  ((y[(q + 2) % 4]) >> r) ^
	  ((y[(q + 1) % 4]) << (32 - r));
  rk[3] = (x[3]) ^
	  ((y[(q + 3) % 4]) >> r) ^
	  ((y[(q + 2) % 4]) << (32 - r));
}