Sorry, but re-implementing such a complex function in a different but equivalent manner without making any auxiliary or helper function is a really difficult task. Since the original function is actually utilizing various helper function itself, that also depend on the underlying system and platform, changing this word by word keeping the same meaning would likely result in similar bits of code and might potentially jeopardize ACID (atomicity, consistency, isolation, durability) properties.