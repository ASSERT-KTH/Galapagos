void fe25519_mul(fe25519 h, const fe25519 f, const fe25519 g)
{
    const uint64_t mask = 0x7FFFFFFFFFFFF;
    uint64_t carry = 0;
    uint128_t f_19[5], f128[5], g128[5], r[5];

    for( int k = 0; k < 5; ++k)
    {
        f128[k] = (uint128_t) (f[k]);
        g128[k] = (uint128_t) (g[k]);
    }
    
    for( int k = 1; k < 5; ++k)
    {
        f_19[k] = 19ULL * f[k];
    }

    r[0] = f128[0]*g128[0] + f_19[1]*g128[4] + f_19[2]*g128[3] + f_19[3]*g128[2] + f_19[4]*g128[1];
    r[1] = f128[0]*g128[1] + f128[1]*g128[0] + f_19[2]*g128[4] + f_19[3]*g128[3] + f_19[4]*g128[2];
    r[2] = f128[0]*g128[2] + f128[1]*g128[1] + f128[2]*g128[0] + f_19[3]*g128[4] + f_19[4]*g128[3];
    r[3] = f128[0]*g128[3] + f128[1]*g128[2] + f128[2]*g128[1] + f128[3]*g128[0] + f_19[4]*g128[4];
    r[4] = f128[0]*g128[4] + f128[1]*g128[3] + f128[2]*g128[2] + f128[3]*g128[1] + f128[4]*g128[0];

    for(int k = 0; k < 4; ++k)
    {
        h[k] = r[k] & mask;
        carry = r[k] >> 51;
        r[k + 1] += carry;
        h[k] = r[k] & mask;
    }

    h[4] = r[4] & mask;
    carry = r[3] >> 51;
    h[0] += 19ULL * carry;
    carry = h[0] >> 51;
    h[0] &= mask;
    h[1] += carry;
}
