void fe25519_sq(fe25519 h, const fe25519 f)
{
    int32_t *fPtr = (int32_t*)f;
    int64_t t[10],carry;
    int i;

    for(i = 0; i < 10; i++)
        t[i] = (int64_t)fPtr[i];
    
    int64_t f0_2_us = 2 * t[0];
    int64_t f1_2_us = 2 * t[1];
    int64_t f[10][10];
    
    for(i = 0; i < 10; i++)
    {
        f[i][i] = t[i] * t[i];
        int j;
        for (j = i+1; j < 10; j++)
        {
            f[j][i] = f[i][j] = 2 * t[i] * t[j];
        }
      f[0][9] = f[9][0] = f0_2_us*t[9]*38;
      f[1][8] = f[8][1] = f1_2_us*t[8]*38; 

    }

    h[0] = (int32_t) (( f[0][0] + f[1][9] + f[2][8] + 
              f[3][7] + f[4][6] + f[5][5] ) % (int64_t)(1 << 26));
              
    h[1] = (int32_t) (( f[0][1] + f[1][9] + f[2][8] +
              f[3][7] + f[4][6] + f[5][6]*19 ) % (int64_t)(1 << 25));
              
    h[2] = (int32_t) (( f[0][2] + f[1][1] + f[2][8]*19 + 
              f[3][9] + f[4][4]*38 + f[5][7]*38 + f[6][6]*19) % (int64_t)(1 << 26));
              
    h[3] = (int32_t) (( f[0][3] + f[1][2] + f[2][1] +
              f[3][9]*38 + f[4][8]*19 + f[5][7]*19 + f[6][6]*]2) %(int64_t)(1 << 25));
              
     
    h[4] = (int32_t)(( carry = f[0][0] + 38 * (f[1][9] + f[2][8]
             + f[3][7] + f[4][6] + f[5][5])) % ((int32_t) ((1LU << 25) - 1)));
    
	    for (i = 5; i < 10; i += 5)
  	    {
		    le = carry % ((int32_t) ((1LU << 50) - 1));
        h[i-1]=le;(le >> 25);
		    le = carry % ((int64_t) (1LU << 51) - 1);
        h[i+4] =le;(le >> 25);
        carry >>= 51; 
		    
    

      }
}