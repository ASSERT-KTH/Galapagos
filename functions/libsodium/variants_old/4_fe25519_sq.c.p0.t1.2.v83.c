
fe25519_sq(fe25519 h, const fe25519 f)
{
    int32_t f0 = f[0], f1 = f[1], f2 = f[2], f3 = f[3], f4 = f[4];
    int32_t f5 = f[5], f6 = f[6], f7 = f[7], f8 = f[8], f9 = f[9];

    int32_t rb = 19;
  
    int64_t h0 = f0*f0 + 2*38*f9*f1 + 2*19*f8*f2 + 2*38*f7*f3 +    38*f6*f4 + 38*f5*f5;
    int64_t h1 = 2*f0*f1 +    38*f9*f2 +    19*f8*f3 +    38*f7*f4 +   19*f6*f5;
    int64_t h2 = 2*(f0*f2 + f1*f1) +  2*38*f9*f3 +2*19*f8*f4 + 2*38*f7*f5 + 19*f6*f6;
    int64_t h3 = 2*(f0*f3 + f1*f2) +      f4*f4 + 2*38*f9*f5 +2*19*f8*f6 +  38*f7*f7;
    int64_t h4 = 2*((f0*f4 + f1*f3) +  f2*f2) + 2*38*f9*f6 + 2*19*f8*f7 + 38*f5*f5;
    int64_t h5 = 2*(f0*f5 + f1*f4 + f2*f3) + 38*f9*f7 + 38*f8*f8 + 19*f6*f6;
    int64_t h6 = 2*(f0*f6 + f4*f2 + f3*f3 + f1*f5) + 38*f9*f8 + 38*f7*f7;
    int64_t h7 = 2*(f0*f7 + f1*f6 + f2*f5 + f3*f4) + 38*f9*f9 + 19*f8*f8;
    int64_t h8 = 2*(f0*f8 + f1*f7 + f2*f6 + f3*f5) + f4*f4 + rb*f9*f9;
    int64_t h9 = 2*(f0*f9 + f1*f8 + f2*f7 + f3*f6) + 2*   f4*f5;

    rb = h0 >> 26; h1 += rb; h0 -= rb << 26;
    rb = h4 >> 26; h5 += rb; h4 -= rb << 26;
    rb = h1 >> 25; h2 += rb; h1 -= rb << 25;
    rb = h5 >> 25; h6 += rb; h5 -= rb << 25;
    rb = h2 >> 26; h3 += rb; h2 -= rb << 26;
    rb = h6 >> 26; h7 += rb; h6 -= rb << 26;
    rb = h3 >> 25; h4 += rb; h3 -= rb << 25;
    rb = h7 >> 25; h8 += rb; h7 -= rb << 25;
    rb = h4 >> 26; h5 += rb; h4 -= rb << 26;
    rb = h8 >> 26; h9 += rb; h8 -= rb << 26;
    rb = h9 >> 25; h0 += rb * 19; h9 -= rb << 25;
    rb = h0 >> 26; h1 += rb; h0 -= rb << 26;

    h[0] = h0;
    h[1] = h1;
    h[2] = h2;
    h[3] = h3;
    h[4] = h4;
    h[5] = h5;
    h[6] = h6;
    h[7] = h7;
    h[8] = h8;
    h[9] = h9;
}


                                              

