fe25519_mul(fe25519 h, const fe25519 f, const fe25519 g)
{
    int32_t f1_2  = 2 * f[1];
    int32_t f3_2  = 2 * f[3];
    int32_t f5_2  = 2 * f[5];
    int32_t f7_2  = 2 * f[7];
    int32_t f9_2  = 2 * f[9];
    int32_t g1_19 = 19 * g[1];
    int32_t g2_19 = 19 * g[2];
    int32_t g3_19 = 19 * g[3];
    int32_t g4_19 = 19 * g[4];
    int32_t g5_19 = 19 * g[5];
    int32_t g6_19 = 19 * g[6];
    int32_t g7_19 = 19 * g[7];
    int32_t g8_19 = 19 * g[8];
    int32_t g9_19 = 19 * g[9];

    int64_t f1g1_2  = f1_2 * (int64_t) g[1];
    int64_t f1g3_2  = f1_2 * (int64_t) g[3];
    int64_t f1g5_2  = f1_2 * (int64_t) g[5];
    int64_t f1g7_2  = f1_2 * (int64_t) g[7];
    int64_t f1g9_38 = f1_2 * (int64_t) g9_19;
    int64_t f3g1_2  = f3_2 * (int64_t) g[1];
    int64_t f3g3_2  = f3_2 * (int64_t) g[3];
    int64_t f3g5_2  = f3_2 * (int64_t) g[5];
    int64_t f3g7_38 = f3_2 * (int64_t) g7_19;
    int64_t f3g9_38 = f3_2 * (int64_t) g9_19;
    int64_t f5g1_2  = f5_2 * (int64_t) g[1];
    int64_t f5g3_2  = f5_2 * (int64_t) g[3];
    int64_t f5g5_38 = f5_2 * (int64_t) g5_19;
    int64_t f5g7_38 = f5_2 * (int64_t) g7_19;
    int64_t f5g9_38 = f5_2 * (int64_t) g9_19;
    int64_t f7g1_2  = f7_2 * (int64_t) g[1];
    int64_t f7g3_38 = f7_2 * (int64_t) g3_19;
    int64_t f7g5_38 = f7_2 * (int64_t) g5_19;
    int64_t f7g7_38 = f7_2 * (int64_t) g7_19;
    int64_t f7g9_38 = f7_2 * (int64_t) g9_19;
    int64_t f9g1_38 = f9_2 * (int64_t) g1_19;
    int64_t f9g3_38 = f9_2 * (int64_t) g3_19;
    int64_t f9g5_38 = f9_2 * (int64_t) g5_19;
    int64_t f9g7_38 = f9_2 * (int64_t) g7_19;
    int64_t f9g9_38 = f9_2 * (int64_t) g9_19;

    int64_t h0 = (int64_t)f[0]*g[0] + f1g9_38 + (int64_t)f[2]*g8_19 + f3g7_38 + (int64_t)f[4]*g6_19 + f5g5_38 + (int64_t)f[6]*g4_19 + f7g3_38 + (int64_t)f[8]*g2_19 + f9g1_38;
    int64_t h1 = (int64_t)f[0]*g[1] + (int64_t)f[1]*g[0] + (int64_t)f[2]*g9_19 + (int64_t)f[3]*g8_19 + (int64_t)f[4]*g7_19 + (int64_t)f[5]*g6_19 + (int64_t)f[6]*g5_19 + (int64_t)f[7]*g4_19 + (int64_t)f[8]*g3_19 + (int64_t)f[9]*g2_19;
    int64_t h2 = (int64_t)f[0]*g[2] + f1g1_2 + (int64_t)f[2]*g[0] + f3g9_38 + (int64_t)f[4]*g8_19 + f5g7_38 + (int64_t)f[6]*g6_19 + f7g5_38 + (int64_t)f[8]*g4_19 + f9g3_38;
    int64_t h3 = (int64_t)f[0]*g[3] + (int64_t)f[1]*g[2] + (int64_t)f[2]*g[1] + (int64_t)f[3]*g[0] + (int64_t)f[4]*g9_19 + (int64_t)f[5]*g8_19 + (int64_t)f[6]*g7_19 + (int64_t)f[7]*g6_19 + (int64_t)f[8]*g5_19 + (int64_t)f[9]*g4_19;
    int64_t h4 = (int64_t)f[0]*g[4] + f1g3_2 + (int64_t)f[2]*g[2] + f3g1_2 + (int64_t)f[4]*g[0] + f5g9_38 + (int64_t)f[6]*g8_19 + f7g7_38 + (int64_t)f[8]*g6_19 + f9g5_38;
    int64_t h5 = (int64_t)f[0]*g[5] + (int64_t)f[1]*g[4] + (int64_t)f[2]*g[3] + (int64_t)f[3]*g[2] + (int64_t)f[4]*g[1] + (int64_t)f[5]*g[0] + (int64_t)f[6]*g9_19 + (int64_t)f[7]*g8_19 + (int64_t)f[8]*g7_19 + (int64_t)f[9]*g6_19;
    int64_t h6 = (int64_t)f[0]*g[6] + f1g5_2 + (int64_t)f[2]*g[4] + f3g3_2 + (int64_t)f[4]*g[2] + f5g1_2 + (int64_t)f[6]*g[0] + f7g9_38 + (int64_t)f[8]*g8_19 + f9g7_38;
    int64_t h7 = (int64_t)f[0]*g[7] + (int64_t)f[1]*g[6] + (int64_t)f[2]*g[5] + (int64_t)f[3]*g[4] + (int64_t)f[4]*g[3] + (int64_t)f[5]*g[2] + (int64_t)f[6]*g[1] + (int64_t)f[7]*g[0] + (int64_t)f[8]*g9_19 + (int64_t)f[9]*g8_19;
    int64_t h8 = (int64_t)f[0]*g[8] + f1g7_2 + (int64_t)f[2]*g[6] + f3g5_2 + (int64_t)f[4]*g[4] + f5g3_2 + (int64_t)f[6]*g[2] + f7g1_2 + (int64_t)f[8]*g[0] + f9g9_38;
    int64_t h9 = (int64_t)f[0]*g[9] + (int64_t)f[1]*g[8] + (int64_t)f[2]*g[7] + (int64_t)f[3]*g[6] + (int64_t)f[4]*g[5] + (int64_t)f[5]*g[4] + (int64_t)f[6]*g[3] + (int64_t)f[7]*g[2] + (int64_t)f[8]*g[1] + (int64_t)f[9]*g[0];

    int64_t carry0; 
    int64_t carry1; 
    int64_t carry2; 
    int64_t carry3; 
    int64_t carry4; 
    int64_t carry5; 
    int64_t carry6; 
    int64_t carry7;
    int64_t carry8; 
    int64_t carry9;
      
    int shift0 = 0;
    int shift4 = 0;
    carry0 = (h0 + shift0) >> 26; h1 += carry0; h0 -= carry0 * ((uint64_t) 1L << 26); 
    carry4 = (h4 + shift4) >> 26; h5 += carry4; h4 -= carry4 * ((uint64_t) 1L << 26);
    carry1 = h1 >> 25; h2 += carry1; h1 -= carry1 * ((uint64_t) 1L << 25);
    carry5 = h5 >> 25; h6 += carry5; h5 -= carry5 * ((uint64_t) 1L << 25);
    carry2 = h2 >> 26; h3 += carry2; h2 -= carry2 * ((uint64_t) 1L << 26);
    carry6 = h6 >> 26; h7 += carry6; h6 -= carry6 * ((uint64_t) 1L << 26);
    carry3 = h3 >> 25; h4 += carry3; h3 -= carry3 * ((uint64_t) 1L << 25);
    carry7 = h7 >> 25; h8 += carry7; h7 -= carry7 * ((uint64_t) 1L << 25);
    carry4 = h4 >> 26; h5 += carry4; h4 -= carry4 * ((uint64_t) 1L << 26);
    carry8 = h8 >> 26; h9 += carry8; h8 -= carry8 * ((uint64_t) 1L << 26);
    carry9 = h9 >> 25; h0 += carry9 * 19; h9 -= carry9 * ((uint64_t) 1L << 25);
    carry0 = h0 >> 26; h1 += carry0; h0 -= carry0 * ((uint64_t) 1L << 26);
  
    h[0] = (int32_t) h0;
    h[1] = (int32_t) h1;
    h[2] = (int32_t) h2;
    h[3] = (int32_t) h3;
    h[4] = (int32_t) h4;
    h[5] = (int32_t) h5;
    h[6] = (int32_t) h6;
    h[7] = (int32_t) h7;
    h[8] = (int32_t) h8;
    h[9] = (int32_t) h9;
}