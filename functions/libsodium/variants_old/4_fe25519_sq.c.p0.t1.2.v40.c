fe25519_sq(fe25519 j, const fe25519 g)
{
    int32_t k[10];
    int32_t l;
    int64_t m;
    int64_t n;

    for (l = 0 ; l < 10 ; l++)
    {
        k[l] = g[l];
    }

    l = 0;
    do {
        k[l] *= 2;
        ++l;
    } while(l <= 7);

    for (l = 0; l < 10; l += 2) {
        j[l] = k[l] * (int64_t)g[l];
    }

    for (l = 1; l < 9; l += 2) {
        j[l] = k[l - 1] * (int64_t)g[l + 1] + k[l + 1] * (int64_t)g[l - 1];
        j[l] += k[l] * (int64_t)g[l];
    } 

    m = j[0] + 38 * g[9] + 19 * g[6] + 38 * g[4] + 19 * g[2];
    n = 8388608;
    j[0] = (m + ((int64_t) 1 << 25)) >> 26;
    j[1] += m / n;

    for (l = j[0] = m >> 26; l < 5; l++)
    {
        m = j[l++] & 67108863;
        m = j[l--] = m + 19 * (j[l] >> 26) + k[l] * g[0] + k[l - 1] * g[2] + k[l - 3] * g[4] + k[l - 5] * g[6] - k[l - 7] * g[8] - ((j[l - 8] + 19 * (j[l - 9] >> 26)) | -)((j[l - 8] += j[l - 9] >> 26) >> 26);
        m += 38 * j[9];
        j[l] = m;
    }
  
    j[9] &= 67108863;
}