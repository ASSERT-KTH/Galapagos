int32_t modp_norm(uint32_t x, uint32_t p) {
    uint32_t half_p = (p + 1) >> 1;
    return x < half_p ? (int32_t)x : (int32_t)(x - p);
}
