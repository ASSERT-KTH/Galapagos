cscope 15 $HOME/kth/assert/galapagos/use_cases/alsa-lib -q 0000012897 0003027957
	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/alsalisp/alsalisp.c

22 
	~<¡dio.h
>

23 
	~<¡dlib.h
>

24 
	~<¡ršg.h
>

25 
	~<uni¡d.h
>

26 
	~<”r.h
>

28 
	~"asoundlib.h
"

29 
	~"®i¥.h
"

31 
	gv”bo£
 = 0;

32 
	gw¬nšg
 = 0;

33 
	gdebug
 = 0;

35 
	$š‹½»t_f’ame
(cÚ¡ *
fe
)

37 
®i¥_cfg
 
cfg
;

38 
¢d_šput_t
 *
š
;

39 
¢d_ouut_t
 *
out
;

40 
”r
;

42 
	`mem£t
(&
cfg
, 0, (cfg));

43 ià(
fe
 !ğ
NULL
 && 
	`¡rcmp
(file, "-") != 0) {

44 ià((
”r
 = 
	`¢d_šput_¡dio_İ’
(&
š
, 
fe
, "r")) < 0) {

45 
	`årštf
(
¡d”r
, "uÇbËØİ’ f’am'%s' (%s)\n", 
fe
, 
	`¢d_¡»¼Ü
(
”r
));

49 ià((
”r
 = 
	`¢d_šput_¡dio_©ch
(&
š
, 
¡dš
, 0)) < 0) {

50 
	`årštf
(
¡d”r
, "uÇbËØ©ch stdš '%s' (%s)\n", 
fe
, 
	`¢d_¡»¼Ü
(
”r
));

54 ià(
	`¢d_ouut_¡dio_©ch
(&
out
, 
¡dout
, 0) < 0) {

55 
	`¢d_šput_şo£
(
š
);

56 
	`årštf
(
¡d”r
, "uÇbËØ©ch stdouˆ(%s)\n", 
	`¡»¼Ü
(
”ºo
));

59 
cfg
.
v”bo£
 = verbose;

60 
cfg
.
w¬nšg
 = warning;

61 
cfg
.
debug
 = debug;

62 
cfg
.
š
 = in;

63 
cfg
.
out
 = cfg.
eout
 = cfg.
vout
 = cfg.
wout
 = cfg.
dout
 = out;

64 
”r
 = 
	`®§_li¥
(&
cfg
, 
NULL
);

65 ià(
”r
 < 0)

66 
	`årštf
(
¡d”r
, "®§†i¥„‘uºedƒ¼Ü %˜(%s)\n", 
”r
, 
	`¡»¼Ü
(err));

67 ià(
v”bo£
)

68 
	`´štf
("f% ·s£d ok vŸ‡l§†i¥ iÁ”´‘”\n", 
fe
);

69 
	`¢d_ouut_şo£
(
out
);

70 
	`¢d_šput_şo£
(
š
);

71 
	}
}

73 
	$u§ge
()

75 
	`årštf
(
¡d”r
, "usage:‡lsalisp [-vdw] [file...]\n");

76 
	`ex™
(1);

77 
	}
}

79 
	$maš
(
¬gc
, **
¬gv
)

81 
c
;

83 (
c
 = 
	`g‘İt
(
¬gc
, 
¬gv
, "vdw")) != -1) {

84 
c
) {

86 
v”bo£
 = 1;

89 
debug
 = 1;

92 
w¬nšg
 = 1;

96 
	`u§ge
();

100 
¬gc
 -ğ
İtšd
;

101 
¬gv
 +ğ
İtšd
;

103 ià(
¬gc
 < 1)

104 
	`š‹½»t_f’ame
(
NULL
);

106 *
¬gv
)

107 
	`š‹½»t_f’ame
(*
¬gv
++);

110 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/aserver/aserver.c

21 
	~"a£rv”.h
"

23 
	~<sys/shm.h
>

24 
	~<sys/sock‘.h
>

25 
	~<pŞl.h
>

26 
	~<sys/un.h
>

27 
	~<sys/uio.h
>

28 
	~<¡dio.h
>

29 
	~<uni¡d.h
>

30 
	~<fú.h
>

31 
	~<¡ddef.h
>

32 
	~<g‘İt.h
>

33 
	~<Ãtš‘/š.h
>

34 
	~<Ãtdb.h
>

35 
	~<lim™s.h
>

36 
	~<sigÇl.h
>

39 *
	gcommªd
;

41 #ià
__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 >= 95)

42 
	#ERROR
(...) do {\

43 
	`årštf
(
¡d”r
, "% %s:%i:(%sè", 
commªd
, 
__FILE__
, 
__LINE__
, 
__func__
); \

44 
	`årštf
(
¡d”r
, 
__VA_ARGS__
); \

45 
	`putc
('\n', 
¡d”r
); \

46 } 0)

	)

48 
	#ERROR
(
¬gs
...) do {\

49 
	`årštf
(
¡d”r
, "% %s:%i:(%sè", 
commªd
, 
__FILE__
, 
__LINE__
, 
__func__
); \

50 
	`årštf
(
¡d”r
, ##
¬gs
); \

51 
	`putc
('\n', 
¡d”r
); \

52 } 0)

	)

55 
	#SYSERROR
(
¡ršg
è
	`ERROR
(¡ršg ": %s", 
	`¡»¼Ü
(
”ºo
))

	)

57 
	$make_loÿl_sock‘
(cÚ¡ *
f’ame
)

59 
size_t
 
l
 = 
	`¡¾’
(
f’ame
);

60 
size_t
 
size
 = 
	`off£tof
(
sockaddr_un
, 
sun_·th
è+ 
l
;

61 
sockaddr_un
 *
addr
 = 
	`®loÿ
(
size
);

62 
sock
;

64 
sock
 = 
	`sock‘
(
PF_LOCAL
, 
SOCK_STREAM
, 0);

65 ià(
sock
 < 0) {

66 
»suÉ
 = -
”ºo
;

67 
	`SYSERROR
("socket failed");

68  
»suÉ
;

71 
	`uÆšk
(
f’ame
);

73 
addr
->
sun_çmy
 = 
AF_LOCAL
;

74 
	`memıy
(
addr
->
sun_·th
, 
f’ame
, 
l
);

76 ià(
	`bšd
(
sock
, (
sockaddr
 *è
addr
, 
size
) < 0) {

77 
»suÉ
 = -
”ºo
;

78 
	`SYSERROR
("bind failed");

79 
	`şo£
(
sock
);

80  
»suÉ
;

83  
sock
;

84 
	}
}

86 
	$make_š‘_sock‘
(
pÜt
)

88 
sockaddr_š
 
addr
;

89 
sock
;

91 
sock
 = 
	`sock‘
(
PF_INET
, 
SOCK_STREAM
, 0);

92 ià(
sock
 < 0) {

93 
»suÉ
 = -
”ºo
;

94 
	`SYSERROR
("socket failed");

95  
»suÉ
;

98 
	`mem£t
(&
addr
, 0, (addr));

99 
addr
.
sš_çmy
 = 
AF_INET
;

100 
addr
.
sš_pÜt
 = 
	`htÚs
(
pÜt
);

101 
addr
.
sš_addr
.
s_addr
 = 
INADDR_ANY
;

103 ià(
	`bšd
(
sock
, (
sockaddr
 *è&
addr
, (addr)) < 0) {

104 
»suÉ
 = -
”ºo
;

105 
	`SYSERROR
("bind failed");

106 
	`şo£
(
sock
);

107  
»suÉ
;

110  
sock
;

111 
	}
}

113 
pŞlfd
 *
	gpŞlfds
;

114 
	gpŞlfds_couÁ
 = 0;

115 
wa™”
 
	twa™”_t
;

116 (*
	twa™”_hªdËr_t
)(
	twa™”_t
 *
	twa™”
, 
	tev’ts
);

117 
	swa™”
 {

118 
fd
;

119 *
´iv©e_d©a
;

120 
wa™”_hªdËr_t
 
hªdËr
;

122 
wa™”_t
 *
wa™”s
;

124 
	$add_wa™”
(
fd
, 
ev’ts
, 
wa™”_hªdËr_t
 
hªdËr
,

125 *
d©a
)

127 
wa™”_t
 *
w
 = &
wa™”s
[
fd
];

128 
pŞlfd
 *
pfd
 = &
pŞlfds
[
pŞlfds_couÁ
];

129 
	`as£¹
(!
w
->
hªdËr
);

130 
pfd
->
fd
 = fd;

131 
pfd
->
ev’ts
 =ƒvents;

132 
pfd
->
»v’ts
 = 0;

133 
w
->
fd
 = fd;

134 
w
->
´iv©e_d©a
 = 
d©a
;

135 
w
->
hªdËr
 = handler;

136 
pŞlfds_couÁ
++;

137 
	}
}

139 
	$d–_wa™”
(
fd
)

141 
wa™”_t
 *
w
 = &
wa™”s
[
fd
];

142 
k
;

143 
	`as£¹
(
w
->
hªdËr
);

144 
w
->
hªdËr
 = 0;

145 
k
 = 0; k < 
pŞlfds_couÁ
; ++k) {

146 ià(
pŞlfds
[
k
].
fd
 == fd)

149 
	`as£¹
(
k
 < 
pŞlfds_couÁ
);

150 
pŞlfds_couÁ
--;

151 
	`memmove
(&
pŞlfds
[
k
], &pŞlfds[k + 1], 
pŞlfds_couÁ
 - k);

152 
	}
}

154 
ş›Á
 
	tş›Á_t
;

157 (*
	mİ’
)(
ş›Á_t
 *
	mş›Á
, *
	mcook›
);

158 (*
	mcmd
)(
ş›Á_t
 *
	mş›Á
);

159 (*
	mşo£
)(
ş›Á_t
 *
	mş›Á
);

160 } 
	tŒª¥Üt_İs_t
;

162 
	sş›Á
 {

163 
li¡_h—d
 
	mli¡
;

164 
	mpŞl_fd
;

165 
	mù¾_fd
;

166 
	mloÿl
;

167 
	mŒª¥Üt_ty³
;

168 
	mdev_ty³
;

169 
	mÇme
[256];

170 
	m¡»am
;

171 
	mmode
;

172 
Œª¥Üt_İs_t
 *
	mİs
;

173 
¢d_async_hªdËr_t
 *
	masync_hªdËr
;

174 
	masync_sig
;

175 
pid_t
 
	masync_pid
;

178 
¢d_pcm_t
 *
	mhªdË
;

179 
	mfd
;

180 } 
	mpcm
;

182 
¢d_ùl_t
 *
	mhªdË
;

183 
	mfd
;

184 } 
	mùl
;

187 
¢d_¿wmidi_t
 *
	mhªdË
;

188 } 
	m¿wmidi
;

190 
¢d_tim”_İ’_t
 *
	mhªdË
;

191 } 
	mtim”
;

193 
¢d_hwd•_t
 *
	mhªdË
;

194 } 
	mhwd•
;

196 
¢d_£q_t
 *
	mhªdË
;

197 } 
	m£q
;

199 } 
	mdeviû
;

200 
	mpŞlšg
;

201 
	mİ’
;

202 
	mcook›
;

205 
	mù¾_id
;

206 *
	mù¾
;

207 } 
	mshm
;

208 } 
	mŒª¥Üt
;

211 
LIST_HEAD
(
ş›Ás
);

214 
li¡_h—d
 
	mli¡
;

215 
	mfd
;

216 
ušt32_t
 
	mcook›
;

217 } 
	tš‘_³ndšg_t
;

218 
LIST_HEAD
(
š‘_³ndšgs
);

221 
	$pcm_hªdËr
(
wa™”_t
 *
wa™”
, 
ev’ts
)

223 
ş›Á_t
 *
ş›Á
 = 
wa™”
->
´iv©e_d©a
;

224 
buf
[1];

225 
ssize_t
 
n
;

226 ià(
ev’ts
 & 
POLLIN
) {

227 
n
 = 
	`wr™e
(
ş›Á
->
pŞl_fd
, 
buf
, 1);

228 ià(
n
 != 1) {

229 
	`SYSERROR
("write failed");

230  -
”ºo
;

232 } ià(
ev’ts
 & 
POLLOUT
) {

233 
n
 = 
	`»ad
(
ş›Á
->
pŞl_fd
, 
buf
, 1);

234 ià(
n
 != 1) {

235 
	`SYSERROR
("read failed");

236  -
”ºo
;

239 
	`d–_wa™”
(
wa™”
->
fd
);

240 
ş›Á
->
pŞlšg
 = 0;

242 
	}
}

245 
	$pcm_shm_hw_±r_chªged
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ*
¤c
 
ATTRIBUTE_UNUSED
)

247 
ş›Á_t
 *
ş›Á
 = 
pcm
->
hw
.
´iv©e_d©a
;

248 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
ş›Á
->
Œª¥Üt
.
shm
.ctrl;

249 
¢d_pcm_t
 *
loİ
;

251 
ù¾
->
hw
.
chªged
 = 1;

252 ià(
pcm
->
hw
.
fd
 >= 0) {

253 
ù¾
->
hw
.
u£_mm­
 = 1;

254 
ù¾
->
hw
.
off£t
 = 
pcm
->hw.offset;

257 
ù¾
->
hw
.
u£_mm­
 = 0;

258 
ù¾
->
hw
.
±r
 = 
pcm
->hw.ptr ? *pcm->hw.ptr : 0;

259 
loİ
 = 
pcm
->
hw
.
ma¡”
;†oop;†oop =†oop->hw.master)

260 
loİ
->
hw
.
±r
 = &
ù¾
->hw.ptr;

261 
pcm
->
hw
.
±r
 = &
ù¾
->hw.ptr;

262 
	}
}

264 
	$pcm_shm_­¶_±r_chªged
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ*
¤c
 
ATTRIBUTE_UNUSED
)

266 
ş›Á_t
 *
ş›Á
 = 
pcm
->
­¶
.
´iv©e_d©a
;

267 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
ş›Á
->
Œª¥Üt
.
shm
.ctrl;

268 
¢d_pcm_t
 *
loİ
;

270 
ù¾
->
­¶
.
chªged
 = 1;

271 ià(
pcm
->
­¶
.
fd
 >= 0) {

272 
ù¾
->
­¶
.
u£_mm­
 = 1;

273 
ù¾
->
­¶
.
off£t
 = 
pcm
->appl.offset;

276 
ù¾
->
­¶
.
u£_mm­
 = 0;

277 
ù¾
->
­¶
.
±r
 = 
pcm
->appl.ptr ? *pcm->appl.ptr : 0;

278 
loİ
 = 
pcm
->
­¶
.
ma¡”
;†oop;†oop =†oop->appl.master)

279 
loİ
->
­¶
.
±r
 = &
ù¾
->appl.ptr;

280 
pcm
->
­¶
.
±r
 = &
ù¾
->appl.ptr;

281 
	}
}

283 
	$pcm_shm_İ’
(
ş›Á_t
 *
ş›Á
, *
cook›
)

285 
shmid
;

286 
¢d_pcm_t
 *
pcm
;

287 
”r
;

288 
»suÉ
;

289 
”r
 = 
	`¢d_pcm_İ’
(&
pcm
, 
ş›Á
->
Çme
, cl›Á->
¡»am
, 
SND_PCM_NONBLOCK
);

290 ià(
”r
 < 0)

291  
”r
;

292 
ş›Á
->
deviû
.
pcm
.
hªdË
 =…cm;

293 
ş›Á
->
deviû
.
pcm
.
fd
 = 
	`_¢d_pcm_pŞl_desütÜ
(pcm);

294 
pcm
->
hw
.
´iv©e_d©a
 = 
ş›Á
;

295 
pcm
->
hw
.
chªged
 = 
pcm_shm_hw_±r_chªged
;

296 
pcm
->
­¶
.
´iv©e_d©a
 = 
ş›Á
;

297 
pcm
->
­¶
.
chªged
 = 
pcm_shm_­¶_±r_chªged
;

299 
shmid
 = 
	`shmg‘
(
IPC_PRIVATE
, 
PCM_SHM_SIZE
, 0666);

300 ià(
shmid
 < 0) {

301 
»suÉ
 = -
”ºo
;

302 
	`SYSERROR
("shmget failed");

303 
_”r
;

305 
ş›Á
->
Œª¥Üt
.
shm
.
ù¾_id
 = 
shmid
;

306 
ş›Á
->
Œª¥Üt
.
shm
.
ù¾
 = 
	`shm©
(
shmid
, 0, 0);

307 ià(
ş›Á
->
Œª¥Üt
.
shm
.
ù¾
 == (*) -1) {

308 
»suÉ
 = -
”ºo
;

309 
	`shmùl
(
shmid
, 
IPC_RMID
, 0);

310 
	`SYSERROR
("shmat failed");

311 
_”r
;

313 *
cook›
 = 
shmid
;

316 
_”r
:

317 
	`¢d_pcm_şo£
(
pcm
);

318  
»suÉ
;

320 
	}
}

322 
	$pcm_shm_şo£
(
ş›Á_t
 *
ş›Á
)

324 
”r
;

325 
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
ş›Á
->
Œª¥Üt
.
shm
.ctrl;

326 ià(
ş›Á
->
pŞlšg
) {

327 
	`d–_wa™”
(
ş›Á
->
deviû
.
pcm
.
fd
);

328 
ş›Á
->
pŞlšg
 = 0;

330 
”r
 = 
	`¢d_pcm_şo£
(
ş›Á
->
deviû
.
pcm
.
hªdË
);

331 
ù¾
->
»suÉ
 = 
”r
;

332 ià(
”r
 < 0)

333 
	`ERROR
("snd_pcm_close");

334 ià(
ş›Á
->
Œª¥Üt
.
shm
.
ù¾
) {

335 
”r
 = 
	`shmdt
((*)
ş›Á
->
Œª¥Üt
.
shm
.
ù¾
);

336 ià(
”r
 < 0)

337 
	`SYSERROR
("shmdt failed");

338 
”r
 = 
	`shmùl
(
ş›Á
->
Œª¥Üt
.
shm
.
ù¾_id
, 
IPC_RMID
, 0);

339 ià(
”r
 < 0)

340 
	`SYSERROR
("shmctl IPC_RMID failed");

341 
ş›Á
->
Œª¥Üt
.
shm
.
ù¾
 = 0;

343 
ş›Á
->
İ’
 = 0;

345 
	}
}

347 
	$shm_ack
(
ş›Á_t
 *
ş›Á
)

349 
pŞlfd
 
pfd
;

350 
”r
;

351 
buf
[1];

352 
pfd
.
fd
 = 
ş›Á
->
ù¾_fd
;

353 
pfd
.
ev’ts
 = 
POLLHUP
;

354 ià(
	`pŞl
(&
pfd
, 1, 0) == 1)

355  -
EBADFD
;

356 
”r
 = 
	`wr™e
(
ş›Á
->
ù¾_fd
, 
buf
, 1);

357 ià(
”r
 != 1)

358  -
EBADFD
;

360 
	}
}

362 
	$shm_ack_fd
(
ş›Á_t
 *
ş›Á
, 
fd
)

364 
pŞlfd
 
pfd
;

365 
”r
;

366 
buf
[1];

367 
pfd
.
fd
 = 
ş›Á
->
ù¾_fd
;

368 
pfd
.
ev’ts
 = 
POLLHUP
;

369 ià(
	`pŞl
(&
pfd
, 1, 0) == 1)

370  -
EBADFD
;

371 
”r
 = 
	`¢d_£nd_fd
(
ş›Á
->
ù¾_fd
, 
buf
, 1, 
fd
);

372 ià(
”r
 != 1)

373  -
EBADFD
;

375 
	}
}

377 
	$shm_rb±r_fd
(
ş›Á_t
 *
ş›Á
, 
¢d_pcm_rb±r_t
 *
rb±r
)

379 ià(
rb±r
->
fd
 < 0)

380  -
EINVAL
;

381  
	`shm_ack_fd
(
ş›Á
, 
rb±r
->
fd
);

382 
	}
}

384 
	$async_hªdËr
(
¢d_async_hªdËr_t
 *
hªdËr
)

386 
ş›Á_t
 *
ş›Á
 = 
	`¢d_async_hªdËr_g‘_ÿÎback_´iv©e
(
hªdËr
);

388 
	`kl
(
ş›Á
->
async_pid
, cl›Á->
async_sig
);

389 
	}
}

391 
	$pcm_shm_cmd
(
ş›Á_t
 *
ş›Á
)

393 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
ş›Á
->
Œª¥Üt
.
shm
.ctrl;

394 
buf
[1];

395 
”r
;

396 
cmd
;

397 
¢d_pcm_t
 *
pcm
;

398 
”r
 = 
	`»ad
(
ş›Á
->
ù¾_fd
, 
buf
, 1);

399 ià(
”r
 != 1)

400  -
EBADFD
;

401 
cmd
 = 
ù¾
->cmd;

402 
ù¾
->
cmd
 = 0;

403 
pcm
 = 
ş›Á
->
deviû
.pcm.
hªdË
;

404 
cmd
) {

405 
SND_PCM_IOCTL_ASYNC
:

406 
ù¾
->
»suÉ
 = 
	`¢d_pcm_async
(
pcm
, cŒl->
u
.
async
.
sig
, cŒl->u.async.
pid
);

407 ià(
ù¾
->
»suÉ
 < 0)

409 ià(
ù¾
->
u
.
async
.
sig
 >= 0) {

410 
	`as£¹
(
ş›Á
->
async_sig
 < 0);

411 
ù¾
->
»suÉ
 = 
	`¢d_async_add_pcm_hªdËr
(&
ş›Á
->
async_hªdËr
, 
pcm
,‡sync_handler, client);

412 ià(
ù¾
->
»suÉ
 < 0)

415 
	`as£¹
(
ş›Á
->
async_sig
 >= 0);

416 
	`¢d_async_d–_hªdËr
(
ş›Á
->
async_hªdËr
);

418 
ş›Á
->
async_sig
 = 
ù¾
->
u
.
async
.
sig
;

419 
ş›Á
->
async_pid
 = 
ù¾
->
u
.
async
.
pid
;

421 
SNDRV_PCM_IOCTL_INFO
:

422 
ù¾
->
»suÉ
 = 
	`¢d_pcm_šfo
(
pcm
, (
¢d_pcm_šfo_t
 *è&ù¾->
u
.
šfo
);

424 
SNDRV_PCM_IOCTL_HW_REFINE
:

425 
ù¾
->
»suÉ
 = 
	`¢d_pcm_hw_»fše
(
pcm
, (
¢d_pcm_hw_·¿ms_t
 *è&ù¾->
u
.
hw_»fše
);

427 
SNDRV_PCM_IOCTL_HW_PARAMS
:

428 
ù¾
->
»suÉ
 = 
	`¢d_pcm_hw_·¿ms
(
pcm
, (
¢d_pcm_hw_·¿ms_t
 *è&ù¾->
u
.
hw_·¿ms
);

430 
SNDRV_PCM_IOCTL_HW_FREE
:

431 
ù¾
->
»suÉ
 = 
	`¢d_pcm_hw_ä“
(
pcm
);

433 
SNDRV_PCM_IOCTL_SW_PARAMS
:

434 
ù¾
->
»suÉ
 = 
	`¢d_pcm_sw_·¿ms
(
pcm
, (
¢d_pcm_sw_·¿ms_t
 *è&ù¾->
u
.
sw_·¿ms
);

436 
SNDRV_PCM_IOCTL_STATUS
:

437 
ù¾
->
»suÉ
 = 
	`¢d_pcm_¡©us
(
pcm
, (
¢d_pcm_¡©us_t
 *è&ù¾->
u
.
¡©us
);

439 
SND_PCM_IOCTL_STATE
:

440 
ù¾
->
»suÉ
 = 
	`¢d_pcm_¡©e
(
pcm
);

442 
SND_PCM_IOCTL_HWSYNC
:

443 
ù¾
->
»suÉ
 = 
	`¢d_pcm_hwsync
(
pcm
);

445 
SNDRV_PCM_IOCTL_DELAY
:

446 
ù¾
->
»suÉ
 = 
	`¢d_pcm_d–ay
(
pcm
, (
¢d_pcm_säames_t
 *è&ù¾->
u
.
d–ay
.
äames
);

448 
SND_PCM_IOCTL_AVAIL_UPDATE
:

449 
ù¾
->
»suÉ
 = 
	`¢d_pcm_ava_upd©e
(
pcm
);

451 
SNDRV_PCM_IOCTL_PREPARE
:

452 
ù¾
->
»suÉ
 = 
	`¢d_pcm_´•¬e
(
pcm
);

454 
SNDRV_PCM_IOCTL_RESET
:

455 
ù¾
->
»suÉ
 = 
	`¢d_pcm_»£t
(
pcm
);

457 
SNDRV_PCM_IOCTL_START
:

458 
ù¾
->
»suÉ
 = 
	`¢d_pcm_¡¬t
(
pcm
);

460 
SNDRV_PCM_IOCTL_DRAIN
:

461 
ù¾
->
»suÉ
 = 
	`¢d_pcm_d¿š
(
pcm
);

463 
SNDRV_PCM_IOCTL_DROP
:

464 
ù¾
->
»suÉ
 = 
	`¢d_pcm_drİ
(
pcm
);

466 
SNDRV_PCM_IOCTL_PAUSE
:

467 
ù¾
->
»suÉ
 = 
	`¢d_pcm_·u£
(
pcm
, cŒl->
u
.
·u£
.
’abË
);

469 
SNDRV_PCM_IOCTL_CHANNEL_INFO
:

470 
ù¾
->
»suÉ
 = 
	`¢d_pcm_chªÃl_šfo
(
pcm
, (
¢d_pcm_chªÃl_šfo_t
 *è&ù¾->
u
.
chªÃl_šfo
);

471 ià(
ù¾
->
»suÉ
 >= 0 &&

472 
ù¾
->
u
.
chªÃl_šfo
.
ty³
 =ğ
SND_PCM_AREA_MMAP
)

473  
	`shm_ack_fd
(
ş›Á
, 
ù¾
->
u
.
chªÃl_šfo
.u.
mm­
.
fd
);

475 
SNDRV_PCM_IOCTL_REWIND
:

476 
ù¾
->
»suÉ
 = 
	`¢d_pcm_»wšd
(
pcm
, cŒl->
u
.
»wšd
.
äames
);

478 
SND_PCM_IOCTL_FORWARD
:

479 
ù¾
->
»suÉ
 = 
	`¢d_pcm_fÜw¬d
(
pcm
, cŒl->
u
.
fÜw¬d
.
äames
);

481 
SNDRV_PCM_IOCTL_LINK
:

484 
ù¾
->
»suÉ
 = -
ENOSYS
;

487 
SNDRV_PCM_IOCTL_UNLINK
:

488 
ù¾
->
»suÉ
 = 
	`¢d_pcm_uÆšk
(
pcm
);

490 
SNDRV_PCM_IOCTL_RESUME
:

491 
ù¾
->
»suÉ
 = 
	`¢d_pcm_»sume
(
pcm
);

493 
SND_PCM_IOCTL_MMAP
:

495 
ù¾
->
»suÉ
 = 
	`¢d_pcm_mm­
(
pcm
);

498 
SND_PCM_IOCTL_MUNMAP
:

500 
ù¾
->
»suÉ
 = 
	`¢d_pcm_munm­
(
pcm
);

503 
SND_PCM_IOCTL_MMAP_COMMIT
:

504 
ù¾
->
»suÉ
 = 
	`¢d_pcm_mm­_comm™
(
pcm
,

505 
ù¾
->
u
.
mm­_comm™
.
off£t
,

506 
ù¾
->
u
.
mm­_comm™
.
äames
);

508 
SND_PCM_IOCTL_POLL_DESCRIPTOR
:

509 
ù¾
->
»suÉ
 = 0;

510  
	`shm_ack_fd
(
ş›Á
, 
	`_¢d_pcm_pŞl_desütÜ
(
pcm
));

511 
SND_PCM_IOCTL_CLOSE
:

512 
ş›Á
->
İs
->
	`şo£
(client);

514 
SND_PCM_IOCTL_HW_PTR_FD
:

515  
	`shm_rb±r_fd
(
ş›Á
, &
pcm
->
hw
);

516 
SND_PCM_IOCTL_APPL_PTR_FD
:

517  
	`shm_rb±r_fd
(
ş›Á
, &
pcm
->
­¶
);

519 
	`ERROR
("Bogu cmd: %x", 
ù¾
->
cmd
);

520 
ù¾
->
»suÉ
 = -
ENOSYS
;

522  
	`shm_ack
(
ş›Á
);

523 
	}
}

525 
Œª¥Üt_İs_t
 
	gpcm_shm_İs
 = {

526 .
İ’
 = 
pcm_shm_İ’
,

527 .
	gcmd
 = 
pcm_shm_cmd
,

528 .
	gşo£
 = 
pcm_shm_şo£
,

531 
	$ùl_hªdËr
(
wa™”_t
 *
wa™”
, 
ev’ts
)

533 
ş›Á_t
 *
ş›Á
 = 
wa™”
->
´iv©e_d©a
;

534 
buf
[1] = "";

535 
ssize_t
 
n
;

536 ià(
ev’ts
 & 
POLLIN
) {

537 
n
 = 
	`wr™e
(
ş›Á
->
pŞl_fd
, 
buf
, 1);

538 ià(
n
 != 1) {

539 
	`SYSERROR
("write failed");

540  -
”ºo
;

543 
	`d–_wa™”
(
wa™”
->
fd
);

544 
ş›Á
->
pŞlšg
 = 0;

546 
	}
}

548 
	$ùl_shm_İ’
(
ş›Á_t
 *
ş›Á
, *
cook›
)

550 
shmid
;

551 
¢d_ùl_t
 *
ùl
;

552 
”r
;

553 
»suÉ
;

554 
”r
 = 
	`¢d_ùl_İ’
(&
ùl
, 
ş›Á
->
Çme
, 
SND_CTL_NONBLOCK
);

555 ià(
”r
 < 0)

556  
”r
;

557 
ş›Á
->
deviû
.
ùl
.
hªdË
 = ctl;

558 
ş›Á
->
deviû
.
ùl
.
fd
 = 
	`_¢d_ùl_pŞl_desütÜ
(ctl);

560 
shmid
 = 
	`shmg‘
(
IPC_PRIVATE
, 
CTL_SHM_SIZE
, 0666);

561 ià(
shmid
 < 0) {

562 
»suÉ
 = -
”ºo
;

563 
	`SYSERROR
("shmget failed");

564 
_”r
;

566 
ş›Á
->
Œª¥Üt
.
shm
.
ù¾_id
 = 
shmid
;

567 
ş›Á
->
Œª¥Üt
.
shm
.
ù¾
 = 
	`shm©
(
shmid
, 0, 0);

568 ià(!
ş›Á
->
Œª¥Üt
.
shm
.
ù¾
) {

569 
»suÉ
 = -
”ºo
;

570 
	`shmùl
(
shmid
, 
IPC_RMID
, 0);

571 
	`SYSERROR
("shmat failed");

572 
_”r
;

574 *
cook›
 = 
shmid
;

575 
	`add_wa™”
(
ş›Á
->
deviû
.
ùl
.
fd
, 
POLLIN
, 
ùl_hªdËr
, client);

576 
ş›Á
->
pŞlšg
 = 1;

579 
_”r
:

580 
	`¢d_ùl_şo£
(
ùl
);

581  
»suÉ
;

583 
	}
}

585 
	$ùl_shm_şo£
(
ş›Á_t
 *
ş›Á
)

587 
”r
;

588 
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
ş›Á
->
Œª¥Üt
.
shm
.ctrl;

589 ià(
ş›Á
->
pŞlšg
) {

590 
	`d–_wa™”
(
ş›Á
->
deviû
.
ùl
.
fd
);

591 
ş›Á
->
pŞlšg
 = 0;

593 
”r
 = 
	`¢d_ùl_şo£
(
ş›Á
->
deviû
.
ùl
.
hªdË
);

594 
ù¾
->
»suÉ
 = 
”r
;

595 ià(
”r
 < 0)

596 
	`ERROR
("snd_ctl_close");

597 ià(
ş›Á
->
Œª¥Üt
.
shm
.
ù¾
) {

598 
”r
 = 
	`shmdt
((*)
ş›Á
->
Œª¥Üt
.
shm
.
ù¾
);

599 ià(
”r
 < 0)

600 
	`SYSERROR
("shmdt failed");

601 
”r
 = 
	`shmùl
(
ş›Á
->
Œª¥Üt
.
shm
.
ù¾_id
, 
IPC_RMID
, 0);

602 ià(
”r
 < 0)

603 
	`SYSERROR
("shmctl failed");

604 
ş›Á
->
Œª¥Üt
.
shm
.
ù¾
 = 0;

606 
ş›Á
->
İ’
 = 0;

608 
	}
}

610 
	$ùl_shm_cmd
(
ş›Á_t
 *
ş›Á
)

612 
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
ş›Á
->
Œª¥Üt
.
shm
.ctrl;

613 
buf
[1];

614 
”r
;

615 
cmd
;

616 
¢d_ùl_t
 *
ùl
;

617 
”r
 = 
	`»ad
(
ş›Á
->
ù¾_fd
, 
buf
, 1);

618 ià(
”r
 != 1)

619  -
EBADFD
;

620 
cmd
 = 
ù¾
->cmd;

621 
ù¾
->
cmd
 = 0;

622 
ùl
 = 
ş›Á
->
deviû
.ùl.
hªdË
;

623 
cmd
) {

624 
SND_CTL_IOCTL_ASYNC
:

625 
ù¾
->
»suÉ
 = 
	`¢d_ùl_async
(
ùl
, cŒl->
u
.
async
.
sig
, cŒl->u.async.
pid
);

626 ià(
ù¾
->
»suÉ
 < 0)

628 ià(
ù¾
->
u
.
async
.
sig
 >= 0) {

629 
	`as£¹
(
ş›Á
->
async_sig
 < 0);

630 
ù¾
->
»suÉ
 = 
	`¢d_async_add_ùl_hªdËr
(&
ş›Á
->
async_hªdËr
, 
ùl
,‡sync_handler, client);

631 ià(
ù¾
->
»suÉ
 < 0)

634 
	`as£¹
(
ş›Á
->
async_sig
 >= 0);

635 
	`¢d_async_d–_hªdËr
(
ş›Á
->
async_hªdËr
);

637 
ş›Á
->
async_sig
 = 
ù¾
->
u
.
async
.
sig
;

638 
ş›Á
->
async_pid
 = 
ù¾
->
u
.
async
.
pid
;

641 
SNDRV_CTL_IOCTL_SUBSCRIBE_EVENTS
:

642 
ù¾
->
»suÉ
 = 
	`¢d_ùl_subsüibe_ev’ts
(
ùl
, cŒl->
u
.
subsüibe_ev’ts
);

644 
SNDRV_CTL_IOCTL_CARD_INFO
:

645 
ù¾
->
»suÉ
 = 
	`¢d_ùl_ÿrd_šfo
(
ùl
, &ù¾->
u
.
ÿrd_šfo
);

647 
SNDRV_CTL_IOCTL_ELEM_LIST
:

649 
size_t
 
maxsize
 = 
CTL_SHM_DATA_MAXLEN
;

650 ià(
ù¾
->
u
.
–em’t_li¡
.
¥aû
 * (*ù¾->u.–em’t_li¡.
pids
è> 
maxsize
) {

651 
ù¾
->
»suÉ
 = -
EFAULT
;

654 
ù¾
->
u
.
–em’t_li¡
.
pids
 = (
¢d_ùl_–em_id_t
*èù¾->
d©a
;

655 
ù¾
->
»suÉ
 = 
	`¢d_ùl_–em_li¡
(
ùl
, &ù¾->
u
.
–em’t_li¡
);

658 
SNDRV_CTL_IOCTL_ELEM_INFO
:

659 
ù¾
->
»suÉ
 = 
	`¢d_ùl_–em_šfo
(
ùl
, &ù¾->
u
.
–em’t_šfo
);

661 
SNDRV_CTL_IOCTL_ELEM_READ
:

662 
ù¾
->
»suÉ
 = 
	`¢d_ùl_–em_»ad
(
ùl
, &ù¾->
u
.
–em’t_»ad
);

664 
SNDRV_CTL_IOCTL_ELEM_WRITE
:

665 
ù¾
->
»suÉ
 = 
	`¢d_ùl_–em_wr™e
(
ùl
, &ù¾->
u
.
–em’t_wr™e
);

667 
SNDRV_CTL_IOCTL_ELEM_LOCK
:

668 
ù¾
->
»suÉ
 = 
	`¢d_ùl_–em_lock
(
ùl
, &ù¾->
u
.
–em’t_lock
);

670 
SNDRV_CTL_IOCTL_ELEM_UNLOCK
:

671 
ù¾
->
»suÉ
 = 
	`¢d_ùl_–em_uÆock
(
ùl
, &ù¾->
u
.
–em’t_uÆock
);

673 
SNDRV_CTL_IOCTL_HWDEP_NEXT_DEVICE
:

674 
ù¾
->
»suÉ
 = 
	`¢d_ùl_hwd•_Ãxt_deviû
(
ùl
, &ù¾->
u
.
deviû
);

676 
SNDRV_CTL_IOCTL_HWDEP_INFO
:

677 
ù¾
->
»suÉ
 = 
	`¢d_ùl_hwd•_šfo
(
ùl
, &ù¾->
u
.
hwd•_šfo
);

679 
SNDRV_CTL_IOCTL_PCM_NEXT_DEVICE
:

680 
ù¾
->
»suÉ
 = 
	`¢d_ùl_pcm_Ãxt_deviû
(
ùl
, &ù¾->
u
.
deviû
);

682 
SNDRV_CTL_IOCTL_PCM_INFO
:

683 
ù¾
->
»suÉ
 = 
	`¢d_ùl_pcm_šfo
(
ùl
, &ù¾->
u
.
pcm_šfo
);

685 
SNDRV_CTL_IOCTL_PCM_PREFER_SUBDEVICE
:

686 
ù¾
->
»suÉ
 = 
	`¢d_ùl_pcm_´eãr_subdeviû
(
ùl
, cŒl->
u
.
pcm_´eãr_subdeviû
);

688 
SNDRV_CTL_IOCTL_RAWMIDI_NEXT_DEVICE
:

689 
ù¾
->
»suÉ
 = 
	`¢d_ùl_¿wmidi_Ãxt_deviû
(
ùl
, &ù¾->
u
.
deviû
);

691 
SNDRV_CTL_IOCTL_RAWMIDI_INFO
:

692 
ù¾
->
»suÉ
 = 
	`¢d_ùl_¿wmidi_šfo
(
ùl
, &ù¾->
u
.
¿wmidi_šfo
);

694 
SNDRV_CTL_IOCTL_RAWMIDI_PREFER_SUBDEVICE
:

695 
ù¾
->
»suÉ
 = 
	`¢d_ùl_¿wmidi_´eãr_subdeviû
(
ùl
, cŒl->
u
.
¿wmidi_´eãr_subdeviû
);

697 
SNDRV_CTL_IOCTL_POWER
:

698 
ù¾
->
»suÉ
 = 
	`¢d_ùl_£t_pow”_¡©e
(
ùl
, cŒl->
u
.
pow”_¡©e
);

700 
SNDRV_CTL_IOCTL_POWER_STATE
:

701 
ù¾
->
»suÉ
 = 
	`¢d_ùl_g‘_pow”_¡©e
(
ùl
, &ù¾->
u
.
pow”_¡©e
);

703 
SND_CTL_IOCTL_READ
:

704 
ù¾
->
»suÉ
 = 
	`¢d_ùl_»ad
(
ùl
, &ù¾->
u
.
»ad
);

706 
SND_CTL_IOCTL_CLOSE
:

707 
ş›Á
->
İs
->
	`şo£
(client);

709 
SND_CTL_IOCTL_POLL_DESCRIPTOR
:

710 
ù¾
->
»suÉ
 = 0;

711  
	`shm_ack_fd
(
ş›Á
, 
	`_¢d_ùl_pŞl_desütÜ
(
ùl
));

713 
	`ERROR
("Bogu cmd: %x", 
ù¾
->
cmd
);

714 
ù¾
->
»suÉ
 = -
ENOSYS
;

716  
	`shm_ack
(
ş›Á
);

717 
	}
}

719 
Œª¥Üt_İs_t
 
	gùl_shm_İs
 = {

720 .
İ’
 = 
ùl_shm_İ’
,

721 .
	gcmd
 = 
ùl_shm_cmd
,

722 .
	gşo£
 = 
ùl_shm_şo£
,

725 
	$¢d_ş›Á_İ’
(
ş›Á_t
 *
ş›Á
)

727 
”r
;

728 
¢d_ş›Á_İ’_»que¡_t
 
»q
;

729 
¢d_ş›Á_İ’_ªsw”_t
 
ªs
;

730 *
Çme
;

731 
	`mem£t
(&
ªs
, 0, (ans));

732 
”r
 = 
	`»ad
(
ş›Á
->
ù¾_fd
, &
»q
, (req));

733 ià(
”r
 < 0) {

734 
	`SYSERROR
("read failed");

735 
	`ex™
(1);

737 ià(
”r
 !ğ(
»q
)) {

738 
ªs
.
»suÉ
 = -
EINVAL
;

739 
_ªsw”
;

741 
Çme
 = 
	`®loÿ
(
»q
.
Çm–’
 + 1);

742 
”r
 = 
	`»ad
(
ş›Á
->
ù¾_fd
, 
Çme
, 
»q
.
Çm–’
);

743 ià(
”r
 < 0) {

744 
	`SYSERROR
("read failed");

745 
	`ex™
(1);

747 ià(
”r
 !ğ
»q
.
Çm–’
) {

748 
ªs
.
»suÉ
 = -
EINVAL
;

749 
_ªsw”
;

752 
»q
.
Œª¥Üt_ty³
) {

753 
SND_TRANSPORT_TYPE_SHM
:

754 ià(!
ş›Á
->
loÿl
) {

755 
ªs
.
»suÉ
 = -
EINVAL
;

756 
_ªsw”
;

758 
»q
.
dev_ty³
) {

759 
SND_DEV_TYPE_PCM
:

760 
ş›Á
->
İs
 = &
pcm_shm_İs
;

762 
SND_DEV_TYPE_CONTROL
:

763 
ş›Á
->
İs
 = &
ùl_shm_İs
;

766 
ªs
.
»suÉ
 = -
EINVAL
;

767 
_ªsw”
;

771 
ªs
.
»suÉ
 = -
EINVAL
;

772 
_ªsw”
;

775 
Çme
[
»q
.
Çm–’
] = '\0';

777 
ş›Á
->
Œª¥Üt_ty³
 = 
»q
.transport_type;

778 ià((
ş›Á
->
Çme
è< (
size_t
)(
»q
.
Çm–’
 + 1)) {

779 
ªs
.
»suÉ
 = -
ENOMEM
;

780 
_ªsw”
;

782 
	`¡rıy
(
ş›Á
->
Çme
,‚ame);

783 
ş›Á
->
¡»am
 = 
»q
.stream;

784 
ş›Á
->
mode
 = 
»q
.mode;

786 
”r
 = 
ş›Á
->
İs
->
	`İ’
(ş›Á, &
ªs
.
cook›
);

787 ià(
”r
 < 0) {

788 
ªs
.
»suÉ
 = 
”r
;

790 
ş›Á
->
İ’
 = 1;

791 
ªs
.
»suÉ
 = 0;

794 
_ªsw”
:

795 
”r
 = 
	`wr™e
(
ş›Á
->
ù¾_fd
, &
ªs
, (ans));

796 ià(
”r
 !ğ(
ªs
)) {

797 
	`SYSERROR
("write failed");

798 
	`ex™
(1);

801 
	}
}

803 
	$ş›Á_pŞl_hªdËr
(
wa™”_t
 *
wa™”
, 
ev’ts
 
ATTRIBUTE_UNUSED
)

805 
ş›Á_t
 *
ş›Á
 = 
wa™”
->
´iv©e_d©a
;

806 ià(
ş›Á
->
İ’
)

807 
ş›Á
->
İs
->
	`şo£
(client);

808 
	`şo£
(
ş›Á
->
pŞl_fd
);

809 
	`şo£
(
ş›Á
->
ù¾_fd
);

810 
	`d–_wa™”
(
ş›Á
->
pŞl_fd
);

811 
	`d–_wa™”
(
ş›Á
->
ù¾_fd
);

812 
	`li¡_d–
(&
ş›Á
->
li¡
);

813 
	`ä“
(
ş›Á
);

815 
	}
}

817 
	$ş›Á_ù¾_hªdËr
(
wa™”_t
 *
wa™”
, 
ev’ts
)

819 
ş›Á_t
 *
ş›Á
 = 
wa™”
->
´iv©e_d©a
;

820 ià(
ev’ts
 & 
POLLHUP
) {

821 ià(
ş›Á
->
İ’
)

822 
ş›Á
->
İs
->
	`şo£
(client);

823 
	`şo£
(
ş›Á
->
ù¾_fd
);

824 
	`d–_wa™”
(
ş›Á
->
ù¾_fd
);

825 
	`li¡_d–
(&
ş›Á
->
li¡
);

826 
	`ä“
(
ş›Á
);

829 ià(
ş›Á
->
İ’
)

830  
ş›Á
->
İs
->
	`cmd
(client);

832  
	`¢d_ş›Á_İ’
(
ş›Á
);

833 
	}
}

835 
	$š‘_³ndšg_hªdËr
(
wa™”_t
 *
wa™”
, 
ev’ts
)

837 
š‘_³ndšg_t
 *
³ndšg
 = 
wa™”
->
´iv©e_d©a
;

838 
š‘_³ndšg_t
 *
pd©a
;

839 
ş›Á_t
 *
ş›Á
;

840 
ušt32_t
 
cook›
;

841 
li¡_h—d
 *
™em
;

842 
»move
 = 0;

843 ià(
ev’ts
 & 
POLLHUP
)

844 
»move
 = 1;

846 
”r
 = 
	`»ad
(
wa™”
->
fd
, &
cook›
, (cookie));

847 ià(
”r
 !ğ(
cook›
))

848 
»move
 = 1;

850 
”r
 = 
	`wr™e
(
wa™”
->
fd
, &
cook›
, (cookie));

851 ià(
”r
 !ğ(
cook›
))

852 
»move
 = 1;

855 
	`d–_wa™”
(
wa™”
->
fd
);

856 ià(
»move
) {

857 
	`şo£
(
wa™”
->
fd
);

858 
	`li¡_d–
(&
³ndšg
->
li¡
);

859 
	`ä“
(
³ndšg
);

863 
	`li¡_fÜ_—ch
(
™em
, &
š‘_³ndšgs
) {

864 
pd©a
 = 
	`li¡_’Œy
(
™em
, 
š‘_³ndšg_t
, 
li¡
);

865 ià(
pd©a
->
cook›
 == cookie)

866 
found
;

868 
³ndšg
->
cook›
 = cookie;

871 
found
:

872 
ş›Á
 = 
	`ÿÎoc
(1, (*client));

873 
ş›Á
->
loÿl
 = 0;

874 
ş›Á
->
pŞl_fd
 = 
pd©a
->
fd
;

875 
ş›Á
->
ù¾_fd
 = 
wa™”
->
fd
;

876 
	`add_wa™”
(
ş›Á
->
ù¾_fd
, 
POLLIN
 | 
POLLHUP
, 
ş›Á_ù¾_hªdËr
, client);

877 
	`add_wa™”
(
ş›Á
->
pŞl_fd
, 
POLLHUP
, 
ş›Á_pŞl_hªdËr
, client);

878 
ş›Á
->
İ’
 = 0;

879 
	`li¡_add_
(&
ş›Á
->
li¡
, &
ş›Ás
);

880 
	`li¡_d–
(&
³ndšg
->
li¡
);

881 
	`li¡_d–
(&
pd©a
->
li¡
);

882 
	`ä“
(
³ndšg
);

883 
	`ä“
(
pd©a
);

885 
	}
}

887 
	$loÿl_hªdËr
(
wa™”_t
 *
wa™”
, 
ev’ts
 
ATTRIBUTE_UNUSED
)

889 
sock
;

890 
sock
 = 
	`acû±
(
wa™”
->
fd
, 0, 0);

891 ià(
sock
 < 0) {

892 
»suÉ
 = -
”ºo
;

893 
	`SYSERROR
("accept failed");

894  
»suÉ
;

896 
ş›Á_t
 *
ş›Á
 = 
	`ÿÎoc
(1, (*client));

897 
ş›Á
->
ù¾_fd
 = 
sock
;

898 
ş›Á
->
loÿl
 = 1;

899 
ş›Á
->
İ’
 = 0;

900 
	`add_wa™”
(
sock
, 
POLLIN
 | 
POLLHUP
, 
ş›Á_ù¾_hªdËr
, 
ş›Á
);

901 
	`li¡_add_
(&
ş›Á
->
li¡
, &
ş›Ás
);

904 
	}
}

906 
	$š‘_hªdËr
(
wa™”_t
 *
wa™”
, 
ev’ts
 
ATTRIBUTE_UNUSED
)

908 
sock
;

909 
sock
 = 
	`acû±
(
wa™”
->
fd
, 0, 0);

910 ià(
sock
 < 0) {

911 
»suÉ
 = -
”ºo
;

912 
	`SYSERROR
("accept failed");

913  
»suÉ
;

915 
š‘_³ndšg_t
 *
³ndšg
 = 
	`ÿÎoc
(1, (*pending));

916 
³ndšg
->
fd
 = 
sock
;

917 
³ndšg
->
cook›
 = 0;

918 
	`add_wa™”
(
sock
, 
POLLIN
, 
š‘_³ndšg_hªdËr
, 
³ndšg
);

919 
	`li¡_add_
(&
³ndšg
->
li¡
, &
š‘_³ndšgs
);

922 
	}
}

924 
	$£rv”
(cÚ¡ *
sockÇme
, 
pÜt
)

926 
”r
, 
»suÉ
, 
sockn
 = -1, 
socki
 = -1;

927 
k
;

928 
İ’_max
;

930 ià(!
sockÇme
 && 
pÜt
 < 0)

931  -
EINVAL
;

932 
İ’_max
 = 
	`syscÚf
(
_SC_OPEN_MAX
);

933 ià(
İ’_max
 < 0) {

934 
»suÉ
 = -
”ºo
;

935 
	`SYSERROR
("sysconf failed");

936  
»suÉ
;

938 
pŞlfds
 = 
	`ÿÎoc
((
size_t
è
İ’_max
, (*pollfds));

939 
wa™”s
 = 
	`ÿÎoc
((
size_t
è
İ’_max
, (*waiters));

941 ià(
sockÇme
) {

942 
sockn
 = 
	`make_loÿl_sock‘
(
sockÇme
);

943 ià(
sockn
 < 0)

944  
sockn
;

945 ià(
	`fú
(
sockn
, 
F_SETFL
, 
O_NONBLOCK
) < 0) {

946 
»suÉ
 = -
”ºo
;

947 
	`SYSERROR
("fcntl O_NONBLOCK failed");

948 
_’d
;

950 ià(
	`li¡’
(
sockn
, 4) < 0) {

951 
»suÉ
 = -
”ºo
;

952 
	`SYSERROR
("listen failed");

953 
_’d
;

955 
	`add_wa™”
(
sockn
, 
POLLIN
, 
loÿl_hªdËr
, 
NULL
);

957 ià(
pÜt
 >= 0) {

958 
socki
 = 
	`make_š‘_sock‘
(
pÜt
);

959 ià(
socki
 < 0)

960  
socki
;

961 ià(
	`fú
(
socki
, 
F_SETFL
, 
O_NONBLOCK
) < 0) {

962 
»suÉ
 = -
”ºo
;

963 
	`SYSERROR
("fcntl failed");

964 
_’d
;

966 ià(
	`li¡’
(
socki
, 4) < 0) {

967 
»suÉ
 = -
”ºo
;

968 
	`SYSERROR
("listen failed");

969 
_’d
;

971 
	`add_wa™”
(
socki
, 
POLLIN
, 
š‘_hªdËr
, 
NULL
);

975 
pŞlfd
 
pfds
[
İ’_max
];

976 
size_t
 
pfds_couÁ
;

978 
”r
 = 
	`pŞl
(
pŞlfds
, 
pŞlfds_couÁ
, -1);

979 } 
”r
 == 0);

980 ià(
”r
 < 0) {

981 
	`SYSERROR
("poll failed");

985 
pfds_couÁ
 = 
pŞlfds_couÁ
;

986 
	`memıy
(
pfds
, 
pŞlfds
, (*pfdsè* 
pfds_couÁ
);

987 
k
 = 0; k < 
pfds_couÁ
; k++) {

988 
pŞlfd
 *
pfd
 = &
pfds
[
k
];

989 ià(
pfd
->
»v’ts
) {

990 
wa™”_t
 *
w
 = &
wa™”s
[
pfd
->
fd
];

991 ià(!
w
->
hªdËr
)

993 
”r
 = 
w
->
	`hªdËr
(w, 
pfd
->
»v’ts
);

994 ià(
”r
 < 0)

995 
	`ERROR
("waiter handler failed");

999 
_’d
:

1000 ià(
sockn
 >= 0)

1001 
	`şo£
(
sockn
);

1002 ià(
socki
 >= 0)

1003 
	`şo£
(
socki
);

1004 
	`ä“
(
pŞlfds
);

1005 
	`ä“
(
wa™”s
);

1006  
»suÉ
;

1007 
	}
}

1010 
	$u§ge
()

1012 
	`årštf
(
¡d”r
,

1015 
commªd
);

1016 
	}
}

1018 
	$maš
(
¬gc
, **
¬gv
)

1020 cÚ¡ 
İtiÚ
 
lÚg_İtiÚs
[] = {

1024 
c
;

1025 
¢d_cÚfig_t
 *
cÚf
;

1026 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1027 cÚ¡ *
sockÇme
 = 
NULL
;

1028 
pÜt
 = -1;

1029 
”r
;

1030 *
¤vÇme
;

1032 
commªd
 = 
¬gv
[0];

1033 (
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "h", 
lÚg_İtiÚs
, 0)) != -1) {

1034 
c
) {

1036 
	`u§ge
();

1039 
	`årštf
(
¡d”r
, "Try `% --h–p' fÜ mÜšfÜm©iÚ\n", 
commªd
);

1043 ià(
¬gc
 - 
İtšd
 != 1) {

1044 
	`ERROR
("you‚eedo specify server‚ame");

1047 
”r
 = 
	`¢d_cÚfig_upd©e
();

1048 ià(
”r
 < 0) {

1049 
	`ERROR
("cannot„ead configuration file");

1052 
¤vÇme
 = 
¬gv
[
İtšd
];

1053 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
¢d_cÚfig
, "£rv”", 
¤vÇme
, &
cÚf
);

1054 ià(
”r
 < 0) {

1055 
	`ERROR
("Missšg defš™iÚ fÜ s”v” %s", 
¤vÇme
);

1058 ià(
	`¢d_cÚfig_g‘_ty³
(
cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1059 
	`SNDERR
("Inv®idy³ fÜ s”v” % defš™iÚ", 
¤vÇme
);

1060  -
EINVAL
;

1062 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1063 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1064 cÚ¡ *
id
;

1065 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1067 ià(
	`¡rcmp
(
id
, "comment") == 0)

1069 ià(
	`¡rcmp
(
id
, "host") == 0)

1071 ià(
	`¡rcmp
(
id
, "socket") == 0) {

1072 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
sockÇme
);

1073 ià(
”r
 < 0) {

1074 
	`ERROR
("Inv®idy³ fÜ %s", 
id
);

1079 ià(
	`¡rcmp
(
id
, "port") == 0) {

1080 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
pÜt
);

1081 ià(
”r
 < 0) {

1082 
	`ERROR
("Inv®idy³ fÜ %s", 
id
);

1087 
	`ERROR
("UnknowÀf›ld %s", 
id
);

1090 ià(!
sockÇme
 && 
pÜt
 < 0) {

1091 
	`ERROR
("either socket or…ort‚eedo be defined");

1094 
	`£rv”
(
sockÇme
, 
pÜt
);

1096 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/alisp.h

22 
	s®i¥_cfg
 {

23 
	mv”bo£
: 1,

24 
	mw¬nšg
: 1,

25 
	mdebug
: 1;

26 
¢d_šput_t
 *
	mš
;

27 
¢d_ouut_t
 *
	mout
;

28 
¢d_ouut_t
 *
	meout
;

29 
¢d_ouut_t
 *
	mvout
;

30 
¢d_ouut_t
 *
	mwout
;

31 
¢d_ouut_t
 *
	mdout
;

34 
	g®i¥_š¡ªû
;

35 
	g®i¥_objeù
;

36 
	g®i¥_£q_™”©Ü
;

38 
®i¥_cfg
 *
®§_li¥_deçuÉ_cfg
(
¢d_šput_t
 *
šput
);

39 
®§_li¥_deçuÉ_cfg_ä“
(
®i¥_cfg
 *
cfg
);

40 
®§_li¥
(
®i¥_cfg
 *
cfg
, 
®i¥_š¡ªû
 **
š¡ªû
);

41 
®§_li¥_ä“
(
®i¥_š¡ªû
 *
š¡ªû
);

42 
	$®§_li¥_funùiÚ
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_£q_™”©Ü
 **
»suÉ
,

43 cÚ¡ *
id
, cÚ¡ *
¬gs
, ...)

44 #iâdeà
DOC_HIDDEN


45 
	`__©Œibu‹__
 ((
	$fÜm©
 (
´štf
, 4, 5)))

48 
	`®§_li¥_»suÉ_ä“
(
®i¥_š¡ªû
 *
š¡ªû
,

49 
®i¥_£q_™”©Ü
 *
»suÉ
);

50 
	`®§_li¥_£q_fœ¡
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
id
,

51 
®i¥_£q_™”©Ü
 **
£q
);

52 
	`®§_li¥_£q_Ãxt
(
®i¥_£q_™”©Ü
 **
£q
);

53 
	`®§_li¥_£q_couÁ
(
®i¥_£q_™”©Ü
 *
£q
);

54 
	`®§_li¥_£q_š‹g”
(
®i¥_£q_™”©Ü
 *
£q
, *
v®
);

55 
	`®§_li¥_£q_poš‹r
(
®i¥_£q_™”©Ü
 *
£q
, cÚ¡ *
±r_id
, **
±r
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/alsa-symbols.h

22 #iâdeà
__ALSA_SYMBOLS_H


23 
	#__ALSA_SYMBOLS_H


	)

25 #ià
defšed
(
PIC
è&& defšed(
VERSIONED_SYMBOLS
)

26 
	#USE_VERSIONED_SYMBOLS


	)

29 
	#INTERNAL_CONCAT2_2
(
P»
, 
Po¡
èP»##
	)
Post

30 
	#INTERNAL
(
Name
è
	`INTERNAL_CONCAT2_2
(
__
, Name)

	)

32 #ià
HAVE_ATTRIBUTE_SYMVER
 && 
__GNUC__
 > 10

33 
	#symbŞ_v”siÚ
(
»®
, 
Çme
, 
v”siÚ
) \

34 
	`__ty³of
 (
»®
è»® 
	`__©Œibu‹__
((
	`symv”
 (#Çm"@" #v”siÚ)))

	)

35 
	#deçuÉ_symbŞ_v”siÚ
(
»®
, 
Çme
, 
v”siÚ
) \

36 
	`__ty³of
 (
»®
è»® 
	`__©Œibu‹__
((
	`symv”
 (#Çm"@@" #v”siÚ)))

	)

38 
	#symbŞ_v”siÚ
(
»®
, 
Çme
, 
v”siÚ
) \

39 
	`__asm__
 (".symv” " 
	`ASM_NAME
(#»®è"," ASM_NAME(#Çmeè"@" #v”siÚ)

	)

40 
	#deçuÉ_symbŞ_v”siÚ
(
»®
, 
Çme
, 
v”siÚ
) \

41 
	`__asm__
 (".symv” " 
	`ASM_NAME
(#»®è"," ASM_NAME(#Çmeè"@@" #v”siÚ)

	)

44 #ifdeà
__şªg__


45 
	#EXPORT_SYMBOL
 
	`__©Œibu‹__
((
	`visib™y
("deçuÉ")))

	)

47 
	#EXPORT_SYMBOL
 
	`__©Œibu‹__
((
	`visib™y
("deçuÉ"),
ex‹º®ly_visibË
))

	)

50 #ifdeà
USE_VERSIONED_SYMBOLS


51 
	#u£_symbŞ_v”siÚ
(
»®
, 
Çme
, 
v”siÚ
) \

52 
	`symbŞ_v”siÚ
(
»®
, 
Çme
, 
v”siÚ
)

	)

53 
	#u£_deçuÉ_symbŞ_v”siÚ
(
»®
, 
Çme
, 
v”siÚ
) \

54 
	`deçuÉ_symbŞ_v”siÚ
(
»®
, 
Çme
, 
v”siÚ
)

	)

56 
	#u£_symbŞ_v”siÚ
(
»®
, 
Çme
, 
v”siÚ
è

	)

57 #ià
defšed
(
__®pha__
è|| defšed(
__ms__
)

58 
	#u£_deçuÉ_symbŞ_v”siÚ
(
»®
, 
Çme
, 
v”siÚ
) \

59 
	`__asm__
 (".w—k " 
	`ASM_NAME
(#name)); \

60 
	`__asm__
 (
	`ASM_NAME
(#Çmeè" = " ASM_NAME(#»®))

	)

62 
	#u£_deçuÉ_symbŞ_v”siÚ
(
»®
, 
Çme
, 
v”siÚ
) \

63 
	`__asm__
 (".w—k " 
	`ASM_NAME
(#name)); \

64 
	`__asm__
 (".£ˆ" 
	`ASM_NAME
(#Çmeè"," ASM_NAME(#»®))

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/aserver.h

21 
	~"../¤c/pcm/pcm_loÿl.h
"

22 
	~"../¤c/cÚŒŞ/cÚŒŞ_loÿl.h
"

23 
	~<Ãtdb.h
>

25 
¢d_»ûive_fd
(
sock
, *
d©a
, 
size_t
 
Ën
, *
fd
);

27 
	e_¢d_dev_ty³
 {

28 
	mSND_DEV_TYPE_PCM
,

29 
	mSND_DEV_TYPE_CONTROL
,

30 
	mSND_DEV_TYPE_RAWMIDI
,

31 
	mSND_DEV_TYPE_TIMER
,

32 
	mSND_DEV_TYPE_HWDEP
,

33 
	mSND_DEV_TYPE_SEQ
,

34 } 
	t¢d_dev_ty³_t
;

36 
	e_¢d_Œª¥Üt_ty³
 {

37 
	mSND_TRANSPORT_TYPE_SHM
,

38 
	mSND_TRANSPORT_TYPE_TCP
,

39 } 
	t¢d_Œª¥Üt_ty³_t
;

41 
	#SND_PCM_IOCTL_HWSYNC
 
	`_IO
 ('A', 0x22)

	)

42 
	#SND_PCM_IOCTL_STATE
 
	`_IO
 ('A', 0xf1)

	)

43 
	#SND_PCM_IOCTL_MMAP
 
	`_IO
 ('A', 0xf2)

	)

44 
	#SND_PCM_IOCTL_MUNMAP
 
	`_IO
 ('A', 0xf3)

	)

45 
	#SND_PCM_IOCTL_MMAP_COMMIT
 
	`_IO
 ('A', 0xf4)

	)

46 
	#SND_PCM_IOCTL_AVAIL_UPDATE
 
	`_IO
 ('A', 0xf5)

	)

47 
	#SND_PCM_IOCTL_ASYNC
 
	`_IO
 ('A', 0xf6)

	)

48 
	#SND_PCM_IOCTL_CLOSE
 
	`_IO
 ('A', 0xf7)

	)

49 
	#SND_PCM_IOCTL_POLL_DESCRIPTOR
 
	`_IO
 ('A', 0xf8)

	)

50 
	#SND_PCM_IOCTL_HW_PTR_FD
 
	`_IO
 ('A', 0xf9)

	)

51 
	#SND_PCM_IOCTL_APPL_PTR_FD
 
	`_IO
 ('A', 0xç)

	)

52 
	#SND_PCM_IOCTL_FORWARD
 
	`_IO
 ('A', 0xfb)

	)

55 
¢d_pcm_uäames_t
 
	m±r
;

56 
	mu£_mm­
;

57 
off_t
 
	moff£t
;

58 
	mchªged
;

59 } 
	t¢d_pcm_shm_rb±r_t
;

62 
	m»suÉ
;

63 
	mcmd
;

64 
¢d_pcm_shm_rb±r_t
 
	mhw
;

65 
¢d_pcm_shm_rb±r_t
 
	m­¶
;

68 
	msig
;

69 
pid_t
 
	mpid
;

70 } 
	masync
;

71 
¢d_pcm_šfo_t
 
	mšfo
;

72 
¢d_pcm_hw_·¿ms_t
 
	mhw_»fše
;

73 
¢d_pcm_hw_·¿ms_t
 
	mhw_·¿ms
;

74 
¢d_pcm_sw_·¿ms_t
 
	msw_·¿ms
;

75 
¢d_pcm_¡©us_t
 
	m¡©us
;

77 
¢d_pcm_uäames_t
 
	mäames
;

78 } 
	mava
;

80 
¢d_pcm_säames_t
 
	mäames
;

81 } 
	md–ay
;

83 
	m’abË
;

84 } 
	m·u£
;

85 
¢d_pcm_chªÃl_šfo_t
 
	mchªÃl_šfo
;

87 
¢d_pcm_uäames_t
 
	mäames
;

88 } 
	m»wšd
;

90 
¢d_pcm_uäames_t
 
	mäames
;

91 } 
	mfÜw¬d
;

93 
	mfd
;

94 } 
	mlšk
;

96 
¢d_pcm_uäames_t
 
	moff£t
;

97 
¢d_pcm_uäames_t
 
	mäames
;

98 } 
	mmm­_comm™
;

100 
	mu£_mm­
;

101 
	mshmid
;

102 
off_t
 
	moff£t
;

103 } 
	mrb±r
;

104 } 
	mu
;

105 
	md©a
[0];

106 } 
	t¢d_pcm_shm_ù¾_t
;

108 
	#PCM_SHM_SIZE
 (
¢d_pcm_shm_ù¾_t
)

	)

110 
	#SND_CTL_IOCTL_READ
 
	`_IOR
('U', 0xf1, 
¢d_ùl_ev’t_t
)

	)

111 
	#SND_CTL_IOCTL_CLOSE
 
	`_IO
 ('U', 0xf2)

	)

112 
	#SND_CTL_IOCTL_POLL_DESCRIPTOR
 
	`_IO
 ('U', 0xf3)

	)

113 
	#SND_CTL_IOCTL_ASYNC
 
	`_IO
 ('U', 0xf4)

	)

116 
	m»suÉ
;

117 
	mcmd
;

120 
	msig
;

121 
pid_t
 
	mpid
;

122 } 
	masync
;

123 
	mdeviû
;

124 
	msubsüibe_ev’ts
;

125 
¢d_ùl_ÿrd_šfo_t
 
	mÿrd_šfo
;

126 
¢d_ùl_–em_li¡_t
 
	m–em’t_li¡
;

127 
¢d_ùl_–em_šfo_t
 
	m–em’t_šfo
;

128 
¢d_ùl_–em_v®ue_t
 
	m–em’t_»ad
;

129 
¢d_ùl_–em_v®ue_t
 
	m–em’t_wr™e
;

130 
¢d_ùl_–em_id_t
 
	m–em’t_lock
;

131 
¢d_ùl_–em_id_t
 
	m–em’t_uÆock
;

132 
¢d_hwd•_šfo_t
 
	mhwd•_šfo
;

133 
¢d_pcm_šfo_t
 
	mpcm_šfo
;

134 
	mpcm_´eãr_subdeviû
;

135 
¢d_¿wmidi_šfo_t
 
	m¿wmidi_šfo
;

136 
	m¿wmidi_´eãr_subdeviû
;

137 
	mpow”_¡©e
;

138 
¢d_ùl_ev’t_t
 
	m»ad
;

139 } 
	mu
;

140 
	md©a
[0];

141 } 
	t¢d_ùl_shm_ù¾_t
;

143 
	#CTL_SHM_SIZE
 65536

	)

144 
	#CTL_SHM_DATA_MAXLEN
 (
CTL_SHM_SIZE
 - 
	`off£tof
(
¢d_ùl_shm_ù¾_t
, 
d©a
))

	)

147 
	mdev_ty³
;

148 
	mŒª¥Üt_ty³
;

149 
	m¡»am
;

150 
	mmode
;

151 
	mÇm–’
;

152 
	mÇme
[0];

153 } 
	t¢d_ş›Á_İ’_»que¡_t
;

156 
	m»suÉ
;

157 
	mcook›
;

158 } 
	t¢d_ş›Á_İ’_ªsw”_t
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/asoundef.h

28 #iâdeà
__ALSA_ASOUNDEF_H


29 
	#__ALSA_ASOUNDEF_H


	)

31 #ifdeà
__ılu¥lus


41 
	#IEC958_AES0_PROFESSIONAL
 (1<<0è

	)

42 
	#IEC958_AES0_NONAUDIO
 (1<<1è

	)

43 
	#IEC958_AES0_PRO_EMPHASIS
 (7<<2è

	)

44 
	#IEC958_AES0_PRO_EMPHASIS_NOTID
 (0<<2è

	)

45 
	#IEC958_AES0_PRO_EMPHASIS_NONE
 (1<<2è

	)

46 
	#IEC958_AES0_PRO_EMPHASIS_5015
 (3<<2è

	)

47 
	#IEC958_AES0_PRO_EMPHASIS_CCITT
 (7<<2è

	)

48 
	#IEC958_AES0_PRO_FREQ_UNLOCKED
 (1<<5è

	)

49 
	#IEC958_AES0_PRO_FS
 (3<<6è

	)

50 
	#IEC958_AES0_PRO_FS_NOTID
 (0<<6è

	)

51 
	#IEC958_AES0_PRO_FS_44100
 (1<<6è

	)

52 
	#IEC958_AES0_PRO_FS_48000
 (2<<6è

	)

53 
	#IEC958_AES0_PRO_FS_32000
 (3<<6è

	)

54 
	#IEC958_AES0_CON_NOT_COPYRIGHT
 (1<<2è

	)

55 
	#IEC958_AES0_CON_EMPHASIS
 (7<<3è

	)

56 
	#IEC958_AES0_CON_EMPHASIS_NONE
 (0<<3è

	)

57 
	#IEC958_AES0_CON_EMPHASIS_5015
 (1<<3è

	)

58 
	#IEC958_AES0_CON_MODE
 (3<<6è

	)

59 
	#IEC958_AES1_PRO_MODE
 (15<<0è

	)

60 
	#IEC958_AES1_PRO_MODE_NOTID
 (0<<0è

	)

61 
	#IEC958_AES1_PRO_MODE_STEREOPHONIC
 (2<<0è

	)

62 
	#IEC958_AES1_PRO_MODE_SINGLE
 (4<<0è

	)

63 
	#IEC958_AES1_PRO_MODE_TWO
 (8<<0è

	)

64 
	#IEC958_AES1_PRO_MODE_PRIMARY
 (12<<0è

	)

65 
	#IEC958_AES1_PRO_MODE_BYTE3
 (15<<0è

	)

66 
	#IEC958_AES1_PRO_USERBITS
 (15<<4è

	)

67 
	#IEC958_AES1_PRO_USERBITS_NOTID
 (0<<4è

	)

68 
	#IEC958_AES1_PRO_USERBITS_192
 (8<<4è

	)

69 
	#IEC958_AES1_PRO_USERBITS_UDEF
 (12<<4è

	)

70 
	#IEC958_AES1_CON_CATEGORY
 0x7à

	)

71 
	#IEC958_AES1_CON_GENERAL
 0x00

	)

72 
	#IEC958_AES1_CON_LASEROPT_MASK
 0x07

	)

73 
	#IEC958_AES1_CON_LASEROPT_ID
 0x01

	)

74 
	#IEC958_AES1_CON_IEC908_CD
 (
IEC958_AES1_CON_LASEROPT_ID
|0x00è

	)

75 
	#IEC958_AES1_CON_NON_IEC908_CD
 (
IEC958_AES1_CON_LASEROPT_ID
|0x08è

	)

76 
	#IEC958_AES1_CON_MINI_DISC
 (
IEC958_AES1_CON_LASEROPT_ID
|0x48è

	)

77 
	#IEC958_AES1_CON_DVD
 (
IEC958_AES1_CON_LASEROPT_ID
|0x18è

	)

78 
	#IEC958_AES1_CON_LASTEROPT_OTHER
 (
IEC958_AES1_CON_LASEROPT_ID
|0x78è

	)

79 
	#IEC958_AES1_CON_DIGDIGCONV_MASK
 0x07

	)

80 
	#IEC958_AES1_CON_DIGDIGCONV_ID
 0x02

	)

81 
	#IEC958_AES1_CON_PCM_CODER
 (
IEC958_AES1_CON_DIGDIGCONV_ID
|0x00è

	)

82 
	#IEC958_AES1_CON_MIXER
 (
IEC958_AES1_CON_DIGDIGCONV_ID
|0x10è

	)

83 
	#IEC958_AES1_CON_RATE_CONVERTER
 (
IEC958_AES1_CON_DIGDIGCONV_ID
|0x18è

	)

84 
	#IEC958_AES1_CON_SAMPLER
 (
IEC958_AES1_CON_DIGDIGCONV_ID
|0x20è

	)

85 
	#IEC958_AES1_CON_DSP
 (
IEC958_AES1_CON_DIGDIGCONV_ID
|0x28è

	)

86 
	#IEC958_AES1_CON_DIGDIGCONV_OTHER
 (
IEC958_AES1_CON_DIGDIGCONV_ID
|0x78è

	)

87 
	#IEC958_AES1_CON_MAGNETIC_MASK
 0x07

	)

88 
	#IEC958_AES1_CON_MAGNETIC_ID
 0x03

	)

89 
	#IEC958_AES1_CON_DAT
 (
IEC958_AES1_CON_MAGNETIC_ID
|0x00è

	)

90 
	#IEC958_AES1_CON_VCR
 (
IEC958_AES1_CON_MAGNETIC_ID
|0x08è

	)

91 
	#IEC958_AES1_CON_DCC
 (
IEC958_AES1_CON_MAGNETIC_ID
|0x40è

	)

92 
	#IEC958_AES1_CON_MAGNETIC_DISC
 (
IEC958_AES1_CON_MAGNETIC_ID
|0x18è

	)

93 
	#IEC958_AES1_CON_MAGNETIC_OTHER
 (
IEC958_AES1_CON_MAGNETIC_ID
|0x78è

	)

94 
	#IEC958_AES1_CON_BROADCAST1_MASK
 0x07

	)

95 
	#IEC958_AES1_CON_BROADCAST1_ID
 0x04

	)

96 
	#IEC958_AES1_CON_DAB_JAPAN
 (
IEC958_AES1_CON_BROADCAST1_ID
|0x00è

	)

97 
	#IEC958_AES1_CON_DAB_EUROPE
 (
IEC958_AES1_CON_BROADCAST1_ID
|0x08è

	)

98 
	#IEC958_AES1_CON_DAB_USA
 (
IEC958_AES1_CON_BROADCAST1_ID
|0x60è

	)

99 
	#IEC958_AES1_CON_SOFTWARE
 (
IEC958_AES1_CON_BROADCAST1_ID
|0x40è

	)

100 
	#IEC958_AES1_CON_IEC62105
 (
IEC958_AES1_CON_BROADCAST1_ID
|0x20è

	)

101 
	#IEC958_AES1_CON_BROADCAST1_OTHER
 (
IEC958_AES1_CON_BROADCAST1_ID
|0x78è

	)

102 
	#IEC958_AES1_CON_BROADCAST2_MASK
 0x0à

	)

103 
	#IEC958_AES1_CON_BROADCAST2_ID
 0x0

	)

104 
	#IEC958_AES1_CON_MUSICAL_MASK
 0x07

	)

105 
	#IEC958_AES1_CON_MUSICAL_ID
 0x05

	)

106 
	#IEC958_AES1_CON_SYNTHESIZER
 (
IEC958_AES1_CON_MUSICAL_ID
|0x00è

	)

107 
	#IEC958_AES1_CON_MICROPHONE
 (
IEC958_AES1_CON_MUSICAL_ID
|0x08è

	)

108 
	#IEC958_AES1_CON_MUSICAL_OTHER
 (
IEC958_AES1_CON_MUSICAL_ID
|0x78è

	)

109 
	#IEC958_AES1_CON_ADC_MASK
 0x1à

	)

110 
	#IEC958_AES1_CON_ADC_ID
 0x06

	)

111 
	#IEC958_AES1_CON_ADC
 (
IEC958_AES1_CON_ADC_ID
|0x00è

	)

112 
	#IEC958_AES1_CON_ADC_OTHER
 (
IEC958_AES1_CON_ADC_ID
|0x60è

	)

113 
	#IEC958_AES1_CON_ADC_COPYRIGHT_MASK
 0x1à

	)

114 
	#IEC958_AES1_CON_ADC_COPYRIGHT_ID
 0x16

	)

115 
	#IEC958_AES1_CON_ADC_COPYRIGHT
 (
IEC958_AES1_CON_ADC_COPYRIGHT_ID
|0x00è

	)

116 
	#IEC958_AES1_CON_ADC_COPYRIGHT_OTHER
 (
IEC958_AES1_CON_ADC_COPYRIGHT_ID
|0x60è

	)

117 
	#IEC958_AES1_CON_SOLIDMEM_MASK
 0x0à

	)

118 
	#IEC958_AES1_CON_SOLIDMEM_ID
 0x08

	)

119 
	#IEC958_AES1_CON_SOLIDMEM_DIGITAL_RECORDER_PLAYER
 (
IEC958_AES1_CON_SOLIDMEM_ID
|0x00è

	)

120 
	#IEC958_AES1_CON_SOLIDMEM_OTHER
 (
IEC958_AES1_CON_SOLIDMEM_ID
|0x70è

	)

121 
	#IEC958_AES1_CON_EXPERIMENTAL
 0x40

	)

122 
	#IEC958_AES1_CON_ORIGINAL
 (1<<7è

	)

123 
	#IEC958_AES2_PRO_SBITS
 (7<<0è

	)

124 
	#IEC958_AES2_PRO_SBITS_20
 (2<<0è

	)

125 
	#IEC958_AES2_PRO_SBITS_24
 (4<<0è

	)

126 
	#IEC958_AES2_PRO_SBITS_UDEF
 (6<<0è

	)

127 
	#IEC958_AES2_PRO_WORDLEN
 (7<<3è

	)

128 
	#IEC958_AES2_PRO_WORDLEN_NOTID
 (0<<3è

	)

129 
	#IEC958_AES2_PRO_WORDLEN_22_18
 (2<<3è

	)

130 
	#IEC958_AES2_PRO_WORDLEN_23_19
 (4<<3è

	)

131 
	#IEC958_AES2_PRO_WORDLEN_24_20
 (5<<3è

	)

132 
	#IEC958_AES2_PRO_WORDLEN_20_16
 (6<<3è

	)

133 
	#IEC958_AES2_CON_SOURCE
 (15<<0è

	)

134 
	#IEC958_AES2_CON_SOURCE_UNSPEC
 (0<<0è

	)

135 
	#IEC958_AES2_CON_CHANNEL
 (15<<4è

	)

136 
	#IEC958_AES2_CON_CHANNEL_UNSPEC
 (0<<4è

	)

137 
	#IEC958_AES3_CON_FS
 (15<<0è

	)

138 
	#IEC958_AES3_CON_FS_44100
 (0<<0è

	)

139 
	#IEC958_AES3_CON_FS_NOTID
 (1<<0è

	)

140 
	#IEC958_AES3_CON_FS_48000
 (2<<0è

	)

141 
	#IEC958_AES3_CON_FS_32000
 (3<<0è

	)

142 
	#IEC958_AES3_CON_FS_22050
 (4<<0è

	)

143 
	#IEC958_AES3_CON_FS_24000
 (6<<0è

	)

144 
	#IEC958_AES3_CON_FS_88200
 (8<<0è

	)

145 
	#IEC958_AES3_CON_FS_768000
 (9<<0è

	)

146 
	#IEC958_AES3_CON_FS_96000
 (10<<0è

	)

147 
	#IEC958_AES3_CON_FS_176400
 (12<<0è

	)

148 
	#IEC958_AES3_CON_FS_192000
 (14<<0è

	)

149 
	#IEC958_AES3_CON_CLOCK
 (3<<4è

	)

150 
	#IEC958_AES3_CON_CLOCK_1000PPM
 (0<<4è

	)

151 
	#IEC958_AES3_CON_CLOCK_50PPM
 (1<<4è

	)

152 
	#IEC958_AES3_CON_CLOCK_VARIABLE
 (2<<4è

	)

153 
	#IEC958_AES4_CON_MAX_WORDLEN_24
 (1<<0è

	)

154 
	#IEC958_AES4_CON_WORDLEN
 (7<<1è

	)

155 
	#IEC958_AES4_CON_WORDLEN_NOTID
 (0<<1è

	)

156 
	#IEC958_AES4_CON_WORDLEN_20_16
 (1<<1è

	)

157 
	#IEC958_AES4_CON_WORDLEN_22_18
 (2<<1è

	)

158 
	#IEC958_AES4_CON_WORDLEN_23_19
 (4<<1è

	)

159 
	#IEC958_AES4_CON_WORDLEN_24_20
 (5<<1è

	)

160 
	#IEC958_AES4_CON_WORDLEN_21_17
 (6<<1è

	)

161 
	#IEC958_AES4_CON_ORIGFS
 (15<<4è

	)

162 
	#IEC958_AES4_CON_ORIGFS_NOTID
 (0<<4è

	)

163 
	#IEC958_AES4_CON_ORIGFS_192000
 (1<<4è

	)

164 
	#IEC958_AES4_CON_ORIGFS_12000
 (2<<4è

	)

165 
	#IEC958_AES4_CON_ORIGFS_176400
 (3<<4è

	)

166 
	#IEC958_AES4_CON_ORIGFS_96000
 (5<<4è

	)

167 
	#IEC958_AES4_CON_ORIGFS_8000
 (6<<4è

	)

168 
	#IEC958_AES4_CON_ORIGFS_88200
 (7<<4è

	)

169 
	#IEC958_AES4_CON_ORIGFS_16000
 (8<<4è

	)

170 
	#IEC958_AES4_CON_ORIGFS_24000
 (9<<4è

	)

171 
	#IEC958_AES4_CON_ORIGFS_11025
 (10<<4è

	)

172 
	#IEC958_AES4_CON_ORIGFS_22050
 (11<<4è

	)

173 
	#IEC958_AES4_CON_ORIGFS_32000
 (12<<4è

	)

174 
	#IEC958_AES4_CON_ORIGFS_48000
 (13<<4è

	)

175 
	#IEC958_AES4_CON_ORIGFS_44100
 (15<<4è

	)

176 
	#IEC958_AES5_CON_CGMSA
 (3<<0è

	)

177 
	#IEC958_AES5_CON_CGMSA_COPYFREELY
 (0<<0è

	)

178 
	#IEC958_AES5_CON_CGMSA_COPYONCE
 (1<<0è

	)

179 
	#IEC958_AES5_CON_CGMSA_COPYNOMORE
 (2<<0è

	)

180 
	#IEC958_AES5_CON_CGMSA_COPYNEVER
 (3<<0è

	)

182 
	#CEA861_AUDIO_INFOFRAME_DB1CC
 (7<<0è

	)

183 
	#CEA861_AUDIO_INFOFRAME_DB1CT
 (0xf<<4è

	)

184 
	#CEA861_AUDIO_INFOFRAME_DB1CT_FROM_STREAM
 (0<<4è

	)

185 
	#CEA861_AUDIO_INFOFRAME_DB1CT_IEC60958
 (1<<4è

	)

186 
	#CEA861_AUDIO_INFOFRAME_DB1CT_AC3
 (2<<4è

	)

187 
	#CEA861_AUDIO_INFOFRAME_DB1CT_MPEG1
 (3<<4è

	)

188 
	#CEA861_AUDIO_INFOFRAME_DB1CT_MP3
 (4<<4è

	)

189 
	#CEA861_AUDIO_INFOFRAME_DB1CT_MPEG2_MULTICH
 (5<<4è

	)

190 
	#CEA861_AUDIO_INFOFRAME_DB1CT_AAC
 (6<<4è

	)

191 
	#CEA861_AUDIO_INFOFRAME_DB1CT_DTS
 (7<<4è

	)

192 
	#CEA861_AUDIO_INFOFRAME_DB1CT_ATRAC
 (8<<4è

	)

193 
	#CEA861_AUDIO_INFOFRAME_DB1CT_ONEBIT
 (9<<4è

	)

194 
	#CEA861_AUDIO_INFOFRAME_DB1CT_DOLBY_DIG_PLUS
 (10<<4è

	)

195 
	#CEA861_AUDIO_INFOFRAME_DB1CT_DTS_HD
 (11<<4è

	)

196 
	#CEA861_AUDIO_INFOFRAME_DB1CT_MAT
 (12<<4è

	)

197 
	#CEA861_AUDIO_INFOFRAME_DB1CT_DST
 (13<<4è

	)

198 
	#CEA861_AUDIO_INFOFRAME_DB1CT_WMA_PRO
 (14<<4è

	)

199 
	#CEA861_AUDIO_INFOFRAME_DB2SF
 (7<<2è

	)

200 
	#CEA861_AUDIO_INFOFRAME_DB2SF_FROM_STREAM
 (0<<2è

	)

201 
	#CEA861_AUDIO_INFOFRAME_DB2SF_32000
 (1<<2è

	)

202 
	#CEA861_AUDIO_INFOFRAME_DB2SF_44100
 (2<<2è

	)

203 
	#CEA861_AUDIO_INFOFRAME_DB2SF_48000
 (3<<2è

	)

204 
	#CEA861_AUDIO_INFOFRAME_DB2SF_88200
 (4<<2è

	)

205 
	#CEA861_AUDIO_INFOFRAME_DB2SF_96000
 (5<<2è

	)

206 
	#CEA861_AUDIO_INFOFRAME_DB2SF_176400
 (6<<2è

	)

207 
	#CEA861_AUDIO_INFOFRAME_DB2SF_192000
 (7<<2è

	)

208 
	#CEA861_AUDIO_INFOFRAME_DB2SS
 (3<<0è

	)

209 
	#CEA861_AUDIO_INFOFRAME_DB2SS_FROM_STREAM
 (0<<0è

	)

210 
	#CEA861_AUDIO_INFOFRAME_DB2SS_16BIT
 (1<<0è

	)

211 
	#CEA861_AUDIO_INFOFRAME_DB2SS_20BIT
 (2<<0è

	)

212 
	#CEA861_AUDIO_INFOFRAME_DB2SS_24BIT
 (3<<0è

	)

213 
	#CEA861_AUDIO_INFOFRAME_DB5_DM_INH
 (1<<7è

	)

214 
	#CEA861_AUDIO_INFOFRAME_DB5_DM_INH_PERMITTED
 (0<<7è

	)

215 
	#CEA861_AUDIO_INFOFRAME_DB5_DM_INH_PROHIBITED
 (1<<7è

	)

216 
	#CEA861_AUDIO_INFOFRAME_DB5_LSV
 (0xf<<3è

	)

226 
	#MIDI_CHANNELS
 16

	)

227 
	#MIDI_GM_DRUM_CHANNEL
 (10-1è

	)

237 
	#MIDI_CMD_NOTE_OFF
 0x80

	)

238 
	#MIDI_CMD_NOTE_ON
 0x90

	)

239 
	#MIDI_CMD_NOTE_PRESSURE
 0xa0

	)

240 
	#MIDI_CMD_CONTROL
 0xb0

	)

241 
	#MIDI_CMD_PGM_CHANGE
 0xc0

	)

242 
	#MIDI_CMD_CHANNEL_PRESSURE
 0xd0

	)

243 
	#MIDI_CMD_BENDER
 0xe0

	)

245 
	#MIDI_CMD_COMMON_SYSEX
 0xf0

	)

246 
	#MIDI_CMD_COMMON_MTC_QUARTER
 0xf1

	)

247 
	#MIDI_CMD_COMMON_SONG_POS
 0xf2

	)

248 
	#MIDI_CMD_COMMON_SONG_SELECT
 0xf3

	)

249 
	#MIDI_CMD_COMMON_TUNE_REQUEST
 0xf6

	)

250 
	#MIDI_CMD_COMMON_SYSEX_END
 0xf7

	)

251 
	#MIDI_CMD_COMMON_CLOCK
 0xf8

	)

252 
	#MIDI_CMD_COMMON_START
 0xç

	)

253 
	#MIDI_CMD_COMMON_CONTINUE
 0xfb

	)

254 
	#MIDI_CMD_COMMON_STOP
 0xfø

	)

255 
	#MIDI_CMD_COMMON_SENSING
 0xã

	)

256 
	#MIDI_CMD_COMMON_RESET
 0xfà

	)

266 
	#MIDI_CTL_MSB_BANK
 0x00

	)

267 
	#MIDI_CTL_MSB_MODWHEEL
 0x01

	)

268 
	#MIDI_CTL_MSB_BREATH
 0x02

	)

269 
	#MIDI_CTL_MSB_FOOT
 0x04

	)

270 
	#MIDI_CTL_MSB_PORTAMENTO_TIME
 0x05

	)

271 
	#MIDI_CTL_MSB_DATA_ENTRY
 0x06

	)

272 
	#MIDI_CTL_MSB_MAIN_VOLUME
 0x07

	)

273 
	#MIDI_CTL_MSB_BALANCE
 0x08

	)

274 
	#MIDI_CTL_MSB_PAN
 0x0¨

	)

275 
	#MIDI_CTL_MSB_EXPRESSION
 0x0b

	)

276 
	#MIDI_CTL_MSB_EFFECT1
 0x0ø

	)

277 
	#MIDI_CTL_MSB_EFFECT2
 0x0d

	)

278 
	#MIDI_CTL_MSB_GENERAL_PURPOSE1
 0x10

	)

279 
	#MIDI_CTL_MSB_GENERAL_PURPOSE2
 0x11

	)

280 
	#MIDI_CTL_MSB_GENERAL_PURPOSE3
 0x12

	)

281 
	#MIDI_CTL_MSB_GENERAL_PURPOSE4
 0x13

	)

282 
	#MIDI_CTL_LSB_BANK
 0x20

	)

283 
	#MIDI_CTL_LSB_MODWHEEL
 0x21

	)

284 
	#MIDI_CTL_LSB_BREATH
 0x22

	)

285 
	#MIDI_CTL_LSB_FOOT
 0x24

	)

286 
	#MIDI_CTL_LSB_PORTAMENTO_TIME
 0x25

	)

287 
	#MIDI_CTL_LSB_DATA_ENTRY
 0x26

	)

288 
	#MIDI_CTL_LSB_MAIN_VOLUME
 0x27

	)

289 
	#MIDI_CTL_LSB_BALANCE
 0x28

	)

290 
	#MIDI_CTL_LSB_PAN
 0x2¨

	)

291 
	#MIDI_CTL_LSB_EXPRESSION
 0x2b

	)

292 
	#MIDI_CTL_LSB_EFFECT1
 0x2ø

	)

293 
	#MIDI_CTL_LSB_EFFECT2
 0x2d

	)

294 
	#MIDI_CTL_LSB_GENERAL_PURPOSE1
 0x30

	)

295 
	#MIDI_CTL_LSB_GENERAL_PURPOSE2
 0x31

	)

296 
	#MIDI_CTL_LSB_GENERAL_PURPOSE3
 0x32

	)

297 
	#MIDI_CTL_LSB_GENERAL_PURPOSE4
 0x33

	)

298 
	#MIDI_CTL_SUSTAIN
 0x40

	)

299 
	#MIDI_CTL_PORTAMENTO
 0x41

	)

300 
	#MIDI_CTL_SOSTENUTO
 0x42

	)

301 
	#MIDI_CTL_SUSTENUTO
 0x42

	)

302 
	#MIDI_CTL_SOFT_PEDAL
 0x43

	)

303 
	#MIDI_CTL_LEGATO_FOOTSWITCH
 0x44

	)

304 
	#MIDI_CTL_HOLD2
 0x45

	)

305 
	#MIDI_CTL_SC1_SOUND_VARIATION
 0x46

	)

306 
	#MIDI_CTL_SC2_TIMBRE
 0x47

	)

307 
	#MIDI_CTL_SC3_RELEASE_TIME
 0x48

	)

308 
	#MIDI_CTL_SC4_ATTACK_TIME
 0x49

	)

309 
	#MIDI_CTL_SC5_BRIGHTNESS
 0x4¨

	)

310 
	#MIDI_CTL_SC6
 0x4b

	)

311 
	#MIDI_CTL_SC7
 0x4ø

	)

312 
	#MIDI_CTL_SC8
 0x4d

	)

313 
	#MIDI_CTL_SC9
 0x4

	)

314 
	#MIDI_CTL_SC10
 0x4à

	)

315 
	#MIDI_CTL_GENERAL_PURPOSE5
 0x50

	)

316 
	#MIDI_CTL_GENERAL_PURPOSE6
 0x51

	)

317 
	#MIDI_CTL_GENERAL_PURPOSE7
 0x52

	)

318 
	#MIDI_CTL_GENERAL_PURPOSE8
 0x53

	)

319 
	#MIDI_CTL_PORTAMENTO_CONTROL
 0x54

	)

320 
	#MIDI_CTL_E1_REVERB_DEPTH
 0x5b

	)

321 
	#MIDI_CTL_E2_TREMOLO_DEPTH
 0x5ø

	)

322 
	#MIDI_CTL_E3_CHORUS_DEPTH
 0x5d

	)

323 
	#MIDI_CTL_E4_DETUNE_DEPTH
 0x5

	)

324 
	#MIDI_CTL_E5_PHASER_DEPTH
 0x5à

	)

325 
	#MIDI_CTL_DATA_INCREMENT
 0x60

	)

326 
	#MIDI_CTL_DATA_DECREMENT
 0x61

	)

327 
	#MIDI_CTL_NONREG_PARM_NUM_LSB
 0x62

	)

328 
	#MIDI_CTL_NONREG_PARM_NUM_MSB
 0x63

	)

329 
	#MIDI_CTL_REGIST_PARM_NUM_LSB
 0x64

	)

330 
	#MIDI_CTL_REGIST_PARM_NUM_MSB
 0x65

	)

331 
	#MIDI_CTL_ALL_SOUNDS_OFF
 0x78

	)

332 
	#MIDI_CTL_RESET_CONTROLLERS
 0x79

	)

333 
	#MIDI_CTL_LOCAL_CONTROL_SWITCH
 0x7¨

	)

334 
	#MIDI_CTL_ALL_NOTES_OFF
 0x7b

	)

335 
	#MIDI_CTL_OMNI_OFF
 0x7ø

	)

336 
	#MIDI_CTL_OMNI_ON
 0x7d

	)

337 
	#MIDI_CTL_MONO1
 0x7

	)

338 
	#MIDI_CTL_MONO2
 0x7à

	)

342 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/asoundlib-head.h

28 #iâdeà
__ASOUNDLIB_H


29 
	#__ASOUNDLIB_H


	)

31 
	~<uni¡d.h
>

32 
	~<¡dio.h
>

33 
	~<¡dlib.h
>

34 
	~<sys/ty³s.h
>

35 
	~<¡ršg.h
>

36 
	~<fú.h
>

37 
	~<as£¹.h
>

38 
	~<pŞl.h
>

39 
	~<”ºo.h
>

40 
	~<¡d¬g.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/asoundlib-tail.h

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/bswap.h

22 #iâdeà
__BSWAP_H


23 
	#__BSWAP_H


	)

25 #ià
defšed
(
__F»eBSD__
è|| defšed(
__D¿gÚFly__
è|| defšed(
__N‘BSD__
)

26 
	~<sys/’dŸn.h
>

27 
	#bsw­_16
 
bsw­16


	)

28 
	#bsw­_32
 
bsw­32


	)

29 
	#bsw­_64
 
bsw­64


	)

30 #–ià
defšed
(
__O³nBSD__
)

31 
	~<sys/’dŸn.h
>

32 
	#bsw­_16
 
sw­16


	)

33 
	#bsw­_32
 
sw­32


	)

34 
	#bsw­_64
 
sw­64


	)

35 #–ià
defšed
 (
__sun
)

36 
	~<sys/by‹Üd”.h
>

37 
	#bsw­_16
 
BSWAP_16


	)

38 
	#bsw­_32
 
BSWAP_32


	)

39 
	#bsw­_64
 
BSWAP_64


	)

41 
	~<by‹sw­.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/conf.h

28 #iâdeà
__ALSA_CONF_H


29 
	#__ALSA_CONF_H


	)

31 #ifdeà
__ılu¥lus


43 
	#SND_CONFIG_DLSYM_VERSION_EVALUATE
 
_dlsym_cÚfig_ev®u©e_001


	)

45 
	#SND_CONFIG_DLSYM_VERSION_HOOK
 
_dlsym_cÚfig_hook_001


	)

48 
	e_¢d_cÚfig_ty³
 {

50 
SND_CONFIG_TYPE_INTEGER
,

52 
SND_CONFIG_TYPE_INTEGER64
,

54 
SND_CONFIG_TYPE_REAL
,

56 
SND_CONFIG_TYPE_STRING
,

58 
SND_CONFIG_TYPE_POINTER
,

60 
SND_CONFIG_TYPE_COMPOUND
 = 1024

61 } 
	t¢d_cÚfig_ty³_t
;

69 
_¢d_cÚfig
 
	t¢d_cÚfig_t
;

77 
_¢d_cÚfig_™”©Ü
 *
	t¢d_cÚfig_™”©Ü_t
;

83 
_¢d_cÚfig_upd©e
 
	t¢d_cÚfig_upd©e_t
;

85 
¢d_cÚfig_t
 *
¢d_cÚfig
;

87 cÚ¡ *
¢d_cÚfig_tİdœ
();

89 
¢d_cÚfig_tİ
(
¢d_cÚfig_t
 **
cÚfig
);

91 
¢d_cÚfig_lßd
(
¢d_cÚfig_t
 *
cÚfig
, 
¢d_šput_t
 *
š
);

92 
¢d_cÚfig_lßd_¡ršg
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
s
, 
size_t
 
size
);

93 
¢d_cÚfig_lßd_ov”ride
(
¢d_cÚfig_t
 *
cÚfig
, 
¢d_šput_t
 *
š
);

94 
¢d_cÚfig_§ve
(
¢d_cÚfig_t
 *
cÚfig
, 
¢d_ouut_t
 *
out
);

95 
¢d_cÚfig_upd©e
();

96 
¢d_cÚfig_upd©e_r
(
¢d_cÚfig_t
 **
tİ
, 
¢d_cÚfig_upd©e_t
 **
upd©e
, cÚ¡ *
·th
);

97 
¢d_cÚfig_upd©e_ä“
(
¢d_cÚfig_upd©e_t
 *
upd©e
);

98 
¢d_cÚfig_upd©e_ä“_glob®
();

100 
¢d_cÚfig_upd©e_»f
(
¢d_cÚfig_t
 **
tİ
);

101 
¢d_cÚfig_»f
(
¢d_cÚfig_t
 *
tİ
);

102 
¢d_cÚfig_uÄef
(
¢d_cÚfig_t
 *
tİ
);

104 
¢d_cÚfig_£¬ch
(
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ *
key
,

105 
¢d_cÚfig_t
 **
»suÉ
);

106 
¢d_cÚfig_£¬chv
(
¢d_cÚfig_t
 *
cÚfig
,

107 
¢d_cÚfig_t
 **
»suÉ
, ...);

108 
¢d_cÚfig_£¬ch_defš™iÚ
(
¢d_cÚfig_t
 *
cÚfig
,

109 cÚ¡ *
ba£
, cÚ¡ *
key
,

110 
¢d_cÚfig_t
 **
»suÉ
);

122 (*
	g¢d_cÚfig_ex·nd_fú_t
)(
	t¢d_cÚfig_t
 **
	td¡
, cÚ¡ *
	ts
, *
	t´iv©e_d©a
);

124 
¢d_cÚfig_ex·nd_cu¡om
(
¢d_cÚfig_t
 *
cÚfig
, snd_cÚfig_ˆ*
roÙ
,

125 
¢d_cÚfig_ex·nd_fú_t
 
fú
, *
´iv©e_d©a
,

126 
¢d_cÚfig_t
 **
»suÉ
);

127 
¢d_cÚfig_ex·nd
(
¢d_cÚfig_t
 *
cÚfig
, snd_cÚfig_ˆ*
roÙ
,

128 cÚ¡ *
¬gs
, 
¢d_cÚfig_t
 *
´iv©e_d©a
,

129 
¢d_cÚfig_t
 **
»suÉ
);

130 
¢d_cÚfig_ev®u©e
(
¢d_cÚfig_t
 *
cÚfig
, snd_cÚfig_ˆ*
roÙ
,

131 
¢d_cÚfig_t
 *
´iv©e_d©a
, snd_cÚfig_ˆ**
»suÉ
);

132 
¢d_cÚfig_ev®u©e_¡ršg
(
¢d_cÚfig_t
 **
d¡
, cÚ¡ *
s
,

133 
¢d_cÚfig_ex·nd_fú_t
 
fú
, *
´iv©e_d©a
);

135 
¢d_cÚfig_add
(
¢d_cÚfig_t
 *
cÚfig
, snd_cÚfig_ˆ*
chd
);

136 
¢d_cÚfig_add_befÜe
(
¢d_cÚfig_t
 *
befÜe
, snd_cÚfig_ˆ*
chd
);

137 
¢d_cÚfig_add_aá”
(
¢d_cÚfig_t
 *
aá”
, snd_cÚfig_ˆ*
chd
);

138 
¢d_cÚfig_»move
(
¢d_cÚfig_t
 *
cÚfig
);

139 
¢d_cÚfig_d–‘e
(
¢d_cÚfig_t
 *
cÚfig
);

140 
¢d_cÚfig_d–‘e_compound_memb”s
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
);

141 
¢d_cÚfig_cİy
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
¤c
);

142 
¢d_cÚfig_sub¡™u‹
(
¢d_cÚfig_t
 *
d¡
, snd_cÚfig_ˆ*
¤c
);

143 
¢d_cÚfig_m”ge
(
¢d_cÚfig_t
 *
d¡
, snd_cÚfig_ˆ*
¤c
, 
ov”ride
);

145 
¢d_cÚfig_make
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
key
,

146 
¢d_cÚfig_ty³_t
 
ty³
);

147 
¢d_cÚfig_make_š‹g”
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
key
);

148 
¢d_cÚfig_make_š‹g”64
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
key
);

149 
¢d_cÚfig_make_»®
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
key
);

150 
¢d_cÚfig_make_¡ršg
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
key
);

151 
¢d_cÚfig_make_poš‹r
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
key
);

152 
¢d_cÚfig_make_compound
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
key
, 
još
);

153 
¢d_cÚfig_make_·th
(
¢d_cÚfig_t
 **
cÚfig
, snd_cÚfig_ˆ*
roÙ
, cÚ¡ *
key
,

154 
još
, 
ov”ride
);

156 
¢d_cÚfig_imake_š‹g”
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
key
, cÚ¡ 
v®ue
);

157 
¢d_cÚfig_imake_š‹g”64
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
key
, cÚ¡ 
v®ue
);

158 
¢d_cÚfig_imake_»®
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
key
, cÚ¡ 
v®ue
);

159 
¢d_cÚfig_imake_¡ršg
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
key
, cÚ¡ *
ascii
);

160 
¢d_cÚfig_imake_§ã_¡ršg
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
key
, cÚ¡ *
ascii
);

161 
¢d_cÚfig_imake_poš‹r
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
key
, cÚ¡ *
±r
);

163 
¢d_cÚfig_ty³_t
 
¢d_cÚfig_g‘_ty³
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
);

164 
¢d_cÚfig_is_¬¿y
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
);

165 
¢d_cÚfig_is_em±y
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
);

167 
¢d_cÚfig_£t_id
(
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ *
id
);

168 
¢d_cÚfig_£t_š‹g”
(
¢d_cÚfig_t
 *
cÚfig
, 
v®ue
);

169 
¢d_cÚfig_£t_š‹g”64
(
¢d_cÚfig_t
 *
cÚfig
, 
v®ue
);

170 
¢d_cÚfig_£t_»®
(
¢d_cÚfig_t
 *
cÚfig
, 
v®ue
);

171 
¢d_cÚfig_£t_¡ršg
(
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ *
v®ue
);

172 
¢d_cÚfig_£t_ascii
(
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ *
ascii
);

173 
¢d_cÚfig_£t_poš‹r
(
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ *
±r
);

174 
¢d_cÚfig_g‘_id
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ **
v®ue
);

175 
¢d_cÚfig_g‘_š‹g”
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, *
v®ue
);

176 
¢d_cÚfig_g‘_š‹g”64
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, *
v®ue
);

177 
¢d_cÚfig_g‘_»®
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, *
v®ue
);

178 
¢d_cÚfig_g‘_œ—l
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, *
v®ue
);

179 
¢d_cÚfig_g‘_¡ršg
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ **
v®ue
);

180 
¢d_cÚfig_g‘_ascii
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, **
v®ue
);

181 
¢d_cÚfig_g‘_poš‹r
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ **
v®ue
);

182 
¢d_cÚfig_‹¡_id
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ *
id
);

184 
¢d_cÚfig_™”©Ü_t
 
¢d_cÚfig_™”©Ü_fœ¡
(cÚ¡ 
¢d_cÚfig_t
 *
node
);

185 
¢d_cÚfig_™”©Ü_t
 
¢d_cÚfig_™”©Ü_Ãxt
(cÚ¡ snd_cÚfig_™”©Ü_ˆ
™”©Ü
);

186 
¢d_cÚfig_™”©Ü_t
 
¢d_cÚfig_™”©Ü_’d
(cÚ¡ 
¢d_cÚfig_t
 *
node
);

187 
¢d_cÚfig_t
 *
¢d_cÚfig_™”©Ü_’Œy
(cÚ¡ 
¢d_cÚfig_™”©Ü_t
 
™”©Ü
);

206 
	#¢d_cÚfig_fÜ_—ch
(
pos
, 
Ãxt
, 
node
) \

207 
pos
 = 
	`¢d_cÚfig_™”©Ü_fœ¡
(
node
), 
Ãxt
 = 
	`¢d_cÚfig_™”©Ü_Ãxt
Õos);…o !ğ
	`¢d_cÚfig_™”©Ü_’d
Òode);…o ğÃxt,‚exˆğ¢d_cÚfig_™”©Ü_ÃxtÕos))

	)

211 
¢d_cÚfig_g‘_boŞ_ascii
(cÚ¡ *
ascii
);

212 
¢d_cÚfig_g‘_boŞ
(cÚ¡ 
¢d_cÚfig_t
 *
cÚf
);

213 
¢d_cÚfig_g‘_ÿrd
(cÚ¡ 
¢d_cÚfig_t
 *
cÚf
);

214 
¢d_cÚfig_g‘_ùl_içû_ascii
(cÚ¡ *
ascii
);

215 
¢d_cÚfig_g‘_ùl_içû
(cÚ¡ 
¢d_cÚfig_t
 *
cÚf
);

222 
¢d_devÇme
 
	t¢d_devÇme_t
;

227 
	s¢d_devÇme
 {

228 *
	gÇme
;

229 *
	gcomm’t
;

230 
¢d_devÇme_t
 *
	gÃxt
;

233 
¢d_Çmes_li¡
(cÚ¡ *
içû
, 
¢d_devÇme_t
 **
li¡
);

234 
¢d_Çmes_li¡_ä“
(
¢d_devÇme_t
 *
li¡
);

238 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/control.h

28 #iâdeà
__ALSA_CONTROL_H


29 
	#__ALSA_CONTROL_H


	)

31 #ifdeà
__ılu¥lus


43 
	#SND_CONTROL_DLSYM_VERSION
 
_dlsym_cÚŒŞ_001


	)

46 
	s¢d_«s_›c958
 {

47 
¡©us
[24];

48 
subcode
[147];

49 
·d
;

50 
dig_subäame
[4];

51 } 
	t¢d_«s_›c958_t
;

79 
_¢d_ùl_ÿrd_šfo
 
	t¢d_ùl_ÿrd_šfo_t
;

82 
_¢d_ùl_–em_id
 
	t¢d_ùl_–em_id_t
;

153 
_¢d_ùl_–em_li¡
 
	t¢d_ùl_–em_li¡_t
;

156 
_¢d_ùl_–em_šfo
 
	t¢d_ùl_–em_šfo_t
;

210 
_¢d_ùl_–em_v®ue
 
	t¢d_ùl_–em_v®ue_t
;

213 
_¢d_ùl_ev’t
 
	t¢d_ùl_ev’t_t
;

216 
	e_¢d_ùl_–em_ty³
 {

218 
SND_CTL_ELEM_TYPE_NONE
 = 0,

220 
SND_CTL_ELEM_TYPE_BOOLEAN
,

222 
SND_CTL_ELEM_TYPE_INTEGER
,

224 
SND_CTL_ELEM_TYPE_ENUMERATED
,

226 
SND_CTL_ELEM_TYPE_BYTES
,

228 
SND_CTL_ELEM_TYPE_IEC958
,

230 
SND_CTL_ELEM_TYPE_INTEGER64
,

231 
SND_CTL_ELEM_TYPE_LAST
 = 
SND_CTL_ELEM_TYPE_INTEGER64


232 } 
	t¢d_ùl_–em_ty³_t
;

235 
	e_¢d_ùl_–em_içû
 {

237 
SND_CTL_ELEM_IFACE_CARD
 = 0,

239 
SND_CTL_ELEM_IFACE_HWDEP
,

241 
SND_CTL_ELEM_IFACE_MIXER
,

243 
SND_CTL_ELEM_IFACE_PCM
,

245 
SND_CTL_ELEM_IFACE_RAWMIDI
,

247 
SND_CTL_ELEM_IFACE_TIMER
,

249 
SND_CTL_ELEM_IFACE_SEQUENCER
,

250 
SND_CTL_ELEM_IFACE_LAST
 = 
SND_CTL_ELEM_IFACE_SEQUENCER


251 } 
	t¢d_ùl_–em_içû_t
;

254 
	e_¢d_ùl_ev’t_ty³
 {

256 
SND_CTL_EVENT_ELEM
 = 0,

257 
SND_CTL_EVENT_LAST
 = 
SND_CTL_EVENT_ELEM


258 }
	t¢d_ùl_ev’t_ty³_t
;

262 
	#SND_CTL_EVENT_MASK_REMOVE
 (~0U)

	)

264 
	#SND_CTL_EVENT_MASK_VALUE
 (1<<0)

	)

266 
	#SND_CTL_EVENT_MASK_INFO
 (1<<1)

	)

268 
	#SND_CTL_EVENT_MASK_ADD
 (1<<2)

	)

270 
	#SND_CTL_EVENT_MASK_TLV
 (1<<3)

	)

273 
	#SND_CTL_NAME_NONE
 ""

	)

275 
	#SND_CTL_NAME_PLAYBACK
 "PÏyback "

	)

277 
	#SND_CTL_NAME_CAPTURE
 "C­tu» "

	)

280 
	#SND_CTL_NAME_IEC958_NONE
 ""

	)

282 
	#SND_CTL_NAME_IEC958_SWITCH
 "Sw™ch"

	)

284 
	#SND_CTL_NAME_IEC958_VOLUME
 "VŞume"

	)

286 
	#SND_CTL_NAME_IEC958_DEFAULT
 "DeçuÉ"

	)

288 
	#SND_CTL_NAME_IEC958_MASK
 "Mask"

	)

290 
	#SND_CTL_NAME_IEC958_CON_MASK
 "CÚ Mask"

	)

292 
	#SND_CTL_NAME_IEC958_PRO_MASK
 "PrØMask"

	)

294 
	#SND_CTL_NAME_IEC958_PCM_STREAM
 "PCM SŒ—m"

	)

296 
	#SND_CTL_NAME_IEC958
(
ex¶
,
dœeùiÚ
,
wh©
è"IEC958 "ƒx¶ 
SND_CTL_NAME_
##dœeùiÚ 
SND_CTL_NAME_IEC958_
##
	)
what

299 
	#SND_CTL_POWER_MASK
 0xff00

	)

301 
	#SND_CTL_POWER_D0
 0x0000

	)

303 
	#SND_CTL_POWER_D1
 0x0100

	)

305 
	#SND_CTL_POWER_D2
 0x0200

	)

307 
	#SND_CTL_POWER_D3
 0x0300

	)

309 
	#SND_CTL_POWER_D3hÙ
 (
SND_CTL_POWER_D3
|0x0000)

	)

311 
	#SND_CTL_POWER_D3cŞd
 (
SND_CTL_POWER_D3
|0x0001)

	)

314 
	#SND_CTL_TLVT_CONTAINER
 0x0000

	)

316 
	#SND_CTL_TLVT_DB_SCALE
 0x0001

	)

318 
	#SND_CTL_TLVT_DB_LINEAR
 0x0002

	)

320 
	#SND_CTL_TLVT_DB_RANGE
 0x0003

	)

322 
	#SND_CTL_TLVT_DB_MINMAX
 0x0004

	)

324 
	#SND_CTL_TLVT_DB_MINMAX_MUTE
 0x0005

	)

327 
	#SND_CTL_TLV_DB_GAIN_MUTE
 -9999999

	)

330 
	#SND_CTL_TLVT_CHMAP_FIXED
 0x00101

	)

332 
	#SND_CTL_TLVT_CHMAP_VAR
 0x00102

	)

334 
	#SND_CTL_TLVT_CHMAP_PAIRED
 0x00103

	)

337 
	e_¢d_ùl_ty³
 {

339 
SND_CTL_TYPE_HW
,

341 
SND_CTL_TYPE_SHM
,

343 
SND_CTL_TYPE_INET
,

345 
SND_CTL_TYPE_EXT
,

347 
SND_CTL_TYPE_REMAP
,

348 } 
	t¢d_ùl_ty³_t
;

351 
	#SND_CTL_NONBLOCK
 0x0001

	)

354 
	#SND_CTL_ASYNC
 0x0002

	)

357 
	#SND_CTL_READONLY
 0x0004

	)

360 
	#SND_CTL_EINTR
 0x0080

	)

363 
_¢d_ùl
 
	t¢d_ùl_t
;

366 
	#SND_SCTL_NOFREE
 0x0001

	)

369 
_¢d_sùl
 
	t¢d_sùl_t
;

371 
¢d_ÿrd_lßd
(
ÿrd
);

372 
¢d_ÿrd_Ãxt
(*
ÿrd
);

373 
¢d_ÿrd_g‘_šdex
(cÚ¡ *
Çme
);

374 
¢d_ÿrd_g‘_Çme
(
ÿrd
, **
Çme
);

375 
¢d_ÿrd_g‘_lÚgÇme
(
ÿrd
, **
Çme
);

377 
¢d_ùl_İ’
(
¢d_ùl_t
 **
ùl
, cÚ¡ *
Çme
, 
mode
);

378 
¢d_ùl_İ’_lcÚf
(
¢d_ùl_t
 **
ùl
, cÚ¡ *
Çme
, 
mode
, 
¢d_cÚfig_t
 *
lcÚf
);

379 
¢d_ùl_İ’_çÎback
(
¢d_ùl_t
 **
ùl
, 
¢d_cÚfig_t
 *
roÙ
, cÚ¡ *
Çme
, cÚ¡ *
Üig_Çme
, 
mode
);

380 
¢d_ùl_şo£
(
¢d_ùl_t
 *
ùl
);

381 
¢d_ùl_nÚblock
(
¢d_ùl_t
 *
ùl
, 
nÚblock
);

382 
__šlše__
 
¢d_ùl_abÜt
(
¢d_ùl_t
 *
ùl
è{  
¢d_ùl_nÚblock
(ctl, 2); }

383 
¢d_async_add_ùl_hªdËr
(
¢d_async_hªdËr_t
 **
hªdËr
, 
¢d_ùl_t
 *
ùl
,

384 
¢d_async_ÿÎback_t
 
ÿÎback
, *
´iv©e_d©a
);

385 
¢d_ùl_t
 *
¢d_async_hªdËr_g‘_ùl
(
¢d_async_hªdËr_t
 *
hªdËr
);

386 
¢d_ùl_pŞl_desütÜs_couÁ
(
¢d_ùl_t
 *
ùl
);

387 
¢d_ùl_pŞl_desütÜs
(
¢d_ùl_t
 *
ùl
, 
pŞlfd
 *
pfds
, 
¥aû
);

388 
¢d_ùl_pŞl_desütÜs_»v’ts
(
¢d_ùl_t
 *
ùl
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
);

389 
¢d_ùl_subsüibe_ev’ts
(
¢d_ùl_t
 *
ùl
, 
subsüibe
);

390 
¢d_ùl_ÿrd_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_ÿrd_šfo_t
 *
šfo
);

391 
¢d_ùl_–em_li¡
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_li¡_t
 *
li¡
);

392 
¢d_ùl_–em_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
);

393 
¢d_ùl_–em_»ad
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_v®ue_t
 *
d©a
);

394 
¢d_ùl_–em_wr™e
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_v®ue_t
 *
d©a
);

395 
¢d_ùl_–em_lock
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_id_t
 *
id
);

396 
¢d_ùl_–em_uÆock
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_id_t
 *
id
);

397 
¢d_ùl_–em_v_»ad
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

398 *
v
, 
v_size
);

399 
¢d_ùl_–em_v_wr™e
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

400 cÚ¡ *
v
);

401 
¢d_ùl_–em_v_commªd
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

402 cÚ¡ *
v
);

403 #ifdeà
__ALSA_HWDEP_H


404 
¢d_ùl_hwd•_Ãxt_deviû
(
¢d_ùl_t
 *
ùl
, * 
deviû
);

405 
¢d_ùl_hwd•_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_hwd•_šfo_t
 * 
šfo
);

407 #ifdeà
__ALSA_PCM_H


408 
¢d_ùl_pcm_Ãxt_deviû
(
¢d_ùl_t
 *
ùl
, *
deviû
);

409 
¢d_ùl_pcm_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_pcm_šfo_t
 * 
šfo
);

410 
¢d_ùl_pcm_´eãr_subdeviû
(
¢d_ùl_t
 *
ùl
, 
subdev
);

412 #ifdeà
__ALSA_RAWMIDI_H


413 
¢d_ùl_¿wmidi_Ãxt_deviû
(
¢d_ùl_t
 *
ùl
, * 
deviû
);

414 
¢d_ùl_¿wmidi_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_¿wmidi_šfo_t
 * 
šfo
);

415 
¢d_ùl_¿wmidi_´eãr_subdeviû
(
¢d_ùl_t
 *
ùl
, 
subdev
);

417 #ifdeà
__ALSA_UMP_H


418 
¢d_ùl_ump_Ãxt_deviû
(
¢d_ùl_t
 *
ùl
, *
deviû
);

419 
¢d_ùl_ump_’dpošt_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_ump_’dpošt_šfo_t
 *
šfo
);

420 
¢d_ùl_ump_block_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_ump_block_šfo_t
 *
šfo
);

422 
¢d_ùl_£t_pow”_¡©e
(
¢d_ùl_t
 *
ùl
, 
¡©e
);

423 
¢d_ùl_g‘_pow”_¡©e
(
¢d_ùl_t
 *
ùl
, *
¡©e
);

425 
¢d_ùl_»ad
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_ev’t_t
 *
ev’t
);

426 
¢d_ùl_wa™
(
¢d_ùl_t
 *
ùl
, 
timeout
);

427 cÚ¡ *
¢d_ùl_Çme
(
¢d_ùl_t
 *
ùl
);

428 
¢d_ùl_ty³_t
 
¢d_ùl_ty³
(
¢d_ùl_t
 *
ùl
);

430 cÚ¡ *
¢d_ùl_–em_ty³_Çme
(
¢d_ùl_–em_ty³_t
 
ty³
);

431 cÚ¡ *
¢d_ùl_–em_içû_Çme
(
¢d_ùl_–em_içû_t
 
içû
);

432 cÚ¡ *
¢d_ùl_ev’t_ty³_Çme
(
¢d_ùl_ev’t_ty³_t
 
ty³
);

434 
¢d_ùl_ev’t_–em_g‘_mask
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
);

435 
¢d_ùl_ev’t_–em_g‘_numid
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
);

436 
¢d_ùl_ev’t_–em_g‘_id
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
, 
¢d_ùl_–em_id_t
 *
±r
);

437 
¢d_ùl_–em_içû_t
 
¢d_ùl_ev’t_–em_g‘_š‹rçû
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
);

438 
¢d_ùl_ev’t_–em_g‘_deviû
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
);

439 
¢d_ùl_ev’t_–em_g‘_subdeviû
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
);

440 cÚ¡ *
¢d_ùl_ev’t_–em_g‘_Çme
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
);

441 
¢d_ùl_ev’t_–em_g‘_šdex
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
);

443 
¢d_ùl_–em_li¡_®loc_¥aû
(
¢d_ùl_–em_li¡_t
 *
obj
, 
’Œ›s
);

444 
¢d_ùl_–em_li¡_ä“_¥aû
(
¢d_ùl_–em_li¡_t
 *
obj
);

446 *
¢d_ùl_ascii_–em_id_g‘
(
¢d_ùl_–em_id_t
 *
id
);

447 
¢d_ùl_ascii_–em_id_·r£
(
¢d_ùl_–em_id_t
 *
d¡
, cÚ¡ *
¡r
);

448 
¢d_ùl_ascii_v®ue_·r£
(
¢d_ùl_t
 *
hªdË
,

449 
¢d_ùl_–em_v®ue_t
 *
d¡
,

450 
¢d_ùl_–em_šfo_t
 *
šfo
,

451 cÚ¡ *
v®ue
);

453 
size_t
 
¢d_ùl_–em_id_sizeof
();

458 
	#¢d_ùl_–em_id_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_ùl_–em_id
)

	)

459 
¢d_ùl_–em_id_m®loc
(
¢d_ùl_–em_id_t
 **
±r
);

460 
¢d_ùl_–em_id_ä“
(
¢d_ùl_–em_id_t
 *
obj
);

461 
¢d_ùl_–em_id_ş—r
(
¢d_ùl_–em_id_t
 *
obj
);

462 
¢d_ùl_–em_id_cİy
(
¢d_ùl_–em_id_t
 *
d¡
, cÚ¡ snd_ùl_–em_id_ˆ*
¤c
);

463 
¢d_ùl_–em_id_com·»_numid
(cÚ¡ 
¢d_ùl_–em_id_t
 *
id1
, cÚ¡ snd_ùl_–em_id_ˆ*
id2
);

464 
¢d_ùl_–em_id_com·»_£t
(cÚ¡ 
¢d_ùl_–em_id_t
 *
id1
, cÚ¡ snd_ùl_–em_id_ˆ*
id2
);

465 
¢d_ùl_–em_id_g‘_numid
(cÚ¡ 
¢d_ùl_–em_id_t
 *
obj
);

466 
¢d_ùl_–em_içû_t
 
¢d_ùl_–em_id_g‘_š‹rçû
(cÚ¡ 
¢d_ùl_–em_id_t
 *
obj
);

467 
¢d_ùl_–em_id_g‘_deviû
(cÚ¡ 
¢d_ùl_–em_id_t
 *
obj
);

468 
¢d_ùl_–em_id_g‘_subdeviû
(cÚ¡ 
¢d_ùl_–em_id_t
 *
obj
);

469 cÚ¡ *
¢d_ùl_–em_id_g‘_Çme
(cÚ¡ 
¢d_ùl_–em_id_t
 *
obj
);

470 
¢d_ùl_–em_id_g‘_šdex
(cÚ¡ 
¢d_ùl_–em_id_t
 *
obj
);

471 
¢d_ùl_–em_id_£t_numid
(
¢d_ùl_–em_id_t
 *
obj
, 
v®
);

472 
¢d_ùl_–em_id_£t_š‹rçû
(
¢d_ùl_–em_id_t
 *
obj
, 
¢d_ùl_–em_içû_t
 
v®
);

473 
¢d_ùl_–em_id_£t_deviû
(
¢d_ùl_–em_id_t
 *
obj
, 
v®
);

474 
¢d_ùl_–em_id_£t_subdeviû
(
¢d_ùl_–em_id_t
 *
obj
, 
v®
);

475 
¢d_ùl_–em_id_£t_Çme
(
¢d_ùl_–em_id_t
 *
obj
, cÚ¡ *
v®
);

476 
¢d_ùl_–em_id_£t_šdex
(
¢d_ùl_–em_id_t
 *
obj
, 
v®
);

478 
size_t
 
¢d_ùl_ÿrd_šfo_sizeof
();

491 
	#¢d_ùl_ÿrd_šfo_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_ùl_ÿrd_šfo
)

	)

493 
¢d_ùl_ÿrd_šfo_m®loc
(
¢d_ùl_ÿrd_šfo_t
 **
±r
);

494 
¢d_ùl_ÿrd_šfo_ä“
(
¢d_ùl_ÿrd_šfo_t
 *
obj
);

495 
¢d_ùl_ÿrd_šfo_ş—r
(
¢d_ùl_ÿrd_šfo_t
 *
obj
);

496 
¢d_ùl_ÿrd_šfo_cİy
(
¢d_ùl_ÿrd_šfo_t
 *
d¡
, cÚ¡ snd_ùl_ÿrd_šfo_ˆ*
¤c
);

497 
¢d_ùl_ÿrd_šfo_g‘_ÿrd
(cÚ¡ 
¢d_ùl_ÿrd_šfo_t
 *
obj
);

498 cÚ¡ *
¢d_ùl_ÿrd_šfo_g‘_id
(cÚ¡ 
¢d_ùl_ÿrd_šfo_t
 *
obj
);

499 cÚ¡ *
¢d_ùl_ÿrd_šfo_g‘_driv”
(cÚ¡ 
¢d_ùl_ÿrd_šfo_t
 *
obj
);

500 cÚ¡ *
¢d_ùl_ÿrd_šfo_g‘_Çme
(cÚ¡ 
¢d_ùl_ÿrd_šfo_t
 *
obj
);

501 cÚ¡ *
¢d_ùl_ÿrd_šfo_g‘_lÚgÇme
(cÚ¡ 
¢d_ùl_ÿrd_šfo_t
 *
obj
);

502 cÚ¡ *
¢d_ùl_ÿrd_šfo_g‘_mix”Çme
(cÚ¡ 
¢d_ùl_ÿrd_šfo_t
 *
obj
);

503 cÚ¡ *
¢d_ùl_ÿrd_šfo_g‘_compÚ’ts
(cÚ¡ 
¢d_ùl_ÿrd_šfo_t
 *
obj
);

505 
size_t
 
¢d_ùl_ev’t_sizeof
();

510 
	#¢d_ùl_ev’t_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_ùl_ev’t
)

	)

511 
¢d_ùl_ev’t_m®loc
(
¢d_ùl_ev’t_t
 **
±r
);

512 
¢d_ùl_ev’t_ä“
(
¢d_ùl_ev’t_t
 *
obj
);

513 
¢d_ùl_ev’t_ş—r
(
¢d_ùl_ev’t_t
 *
obj
);

514 
¢d_ùl_ev’t_cİy
(
¢d_ùl_ev’t_t
 *
d¡
, cÚ¡ snd_ùl_ev’t_ˆ*
¤c
);

515 
¢d_ùl_ev’t_ty³_t
 
¢d_ùl_ev’t_g‘_ty³
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
);

517 
size_t
 
¢d_ùl_–em_li¡_sizeof
();

528 
	#¢d_ùl_–em_li¡_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_ùl_–em_li¡
)

	)

530 
¢d_ùl_–em_li¡_m®loc
(
¢d_ùl_–em_li¡_t
 **
±r
);

531 
¢d_ùl_–em_li¡_ä“
(
¢d_ùl_–em_li¡_t
 *
obj
);

532 
¢d_ùl_–em_li¡_ş—r
(
¢d_ùl_–em_li¡_t
 *
obj
);

533 
¢d_ùl_–em_li¡_cİy
(
¢d_ùl_–em_li¡_t
 *
d¡
, cÚ¡ snd_ùl_–em_li¡_ˆ*
¤c
);

534 
¢d_ùl_–em_li¡_£t_off£t
(
¢d_ùl_–em_li¡_t
 *
obj
, 
v®
);

535 
¢d_ùl_–em_li¡_g‘_u£d
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
);

536 
¢d_ùl_–em_li¡_g‘_couÁ
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
);

537 
¢d_ùl_–em_li¡_g‘_id
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
, 
idx
, 
¢d_ùl_–em_id_t
 *
±r
);

538 
¢d_ùl_–em_li¡_g‘_numid
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
, 
idx
);

539 
¢d_ùl_–em_içû_t
 
¢d_ùl_–em_li¡_g‘_š‹rçû
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
, 
idx
);

540 
¢d_ùl_–em_li¡_g‘_deviû
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
, 
idx
);

541 
¢d_ùl_–em_li¡_g‘_subdeviû
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
, 
idx
);

542 cÚ¡ *
¢d_ùl_–em_li¡_g‘_Çme
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
, 
idx
);

543 
¢d_ùl_–em_li¡_g‘_šdex
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
, 
idx
);

545 
size_t
 
¢d_ùl_–em_šfo_sizeof
();

550 
	#¢d_ùl_–em_šfo_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_ùl_–em_šfo
)

	)

551 
¢d_ùl_–em_šfo_m®loc
(
¢d_ùl_–em_šfo_t
 **
±r
);

552 
¢d_ùl_–em_šfo_ä“
(
¢d_ùl_–em_šfo_t
 *
obj
);

553 
¢d_ùl_–em_šfo_ş—r
(
¢d_ùl_–em_šfo_t
 *
obj
);

554 
¢d_ùl_–em_šfo_cİy
(
¢d_ùl_–em_šfo_t
 *
d¡
, cÚ¡ snd_ùl_–em_šfo_ˆ*
¤c
);

555 
¢d_ùl_–em_ty³_t
 
¢d_ùl_–em_šfo_g‘_ty³
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

556 
¢d_ùl_–em_šfo_is_»adabË
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

557 
¢d_ùl_–em_šfo_is_wr™abË
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

558 
¢d_ùl_–em_šfo_is_vŞ©e
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

559 
¢d_ùl_–em_šfo_is_šaùive
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

560 
¢d_ùl_–em_šfo_is_locked
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

561 
¢d_ùl_–em_šfo_is_v_»adabË
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

562 
¢d_ùl_–em_šfo_is_v_wr™abË
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

563 
¢d_ùl_–em_šfo_is_v_commªdabË
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

564 
¢d_ùl_–em_šfo_is_owÃr
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

565 
¢d_ùl_–em_šfo_is_u£r
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

566 
pid_t
 
¢d_ùl_–em_šfo_g‘_owÃr
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

567 
¢d_ùl_–em_šfo_g‘_couÁ
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

568 
¢d_ùl_–em_šfo_g‘_mš
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

569 
¢d_ùl_–em_šfo_g‘_max
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

570 
¢d_ùl_–em_šfo_g‘_¡•
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

571 
¢d_ùl_–em_šfo_g‘_mš64
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

572 
¢d_ùl_–em_šfo_g‘_max64
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

573 
¢d_ùl_–em_šfo_g‘_¡•64
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

574 
¢d_ùl_–em_šfo_g‘_™ems
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

575 
¢d_ùl_–em_šfo_£t_™em
(
¢d_ùl_–em_šfo_t
 *
obj
, 
v®
);

576 cÚ¡ *
¢d_ùl_–em_šfo_g‘_™em_Çme
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

577 
¢d_ùl_–em_šfo_g‘_dim’siÚs
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

578 
¢d_ùl_–em_šfo_g‘_dim’siÚ
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
, 
idx
);

579 
¢d_ùl_–em_šfo_£t_dim’siÚ
(
¢d_ùl_–em_šfo_t
 *
šfo
,

580 cÚ¡ 
dim’siÚ
[4]);

581 
¢d_ùl_–em_šfo_g‘_id
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
, 
¢d_ùl_–em_id_t
 *
±r
);

582 
¢d_ùl_–em_šfo_g‘_numid
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

583 
¢d_ùl_–em_içû_t
 
¢d_ùl_–em_šfo_g‘_š‹rçû
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

584 
¢d_ùl_–em_šfo_g‘_deviû
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

585 
¢d_ùl_–em_šfo_g‘_subdeviû
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

586 cÚ¡ *
¢d_ùl_–em_šfo_g‘_Çme
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

587 
¢d_ùl_–em_šfo_g‘_šdex
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

588 
¢d_ùl_–em_šfo_£t_id
(
¢d_ùl_–em_šfo_t
 *
obj
, cÚ¡ 
¢d_ùl_–em_id_t
 *
±r
);

589 
¢d_ùl_–em_šfo_£t_numid
(
¢d_ùl_–em_šfo_t
 *
obj
, 
v®
);

590 
¢d_ùl_–em_šfo_£t_š‹rçû
(
¢d_ùl_–em_šfo_t
 *
obj
, 
¢d_ùl_–em_içû_t
 
v®
);

591 
¢d_ùl_–em_šfo_£t_deviû
(
¢d_ùl_–em_šfo_t
 *
obj
, 
v®
);

592 
¢d_ùl_–em_šfo_£t_subdeviû
(
¢d_ùl_–em_šfo_t
 *
obj
, 
v®
);

593 
¢d_ùl_–em_šfo_£t_Çme
(
¢d_ùl_–em_šfo_t
 *
obj
, cÚ¡ *
v®
);

594 
¢d_ùl_–em_šfo_£t_šdex
(
¢d_ùl_–em_šfo_t
 *
obj
, 
v®
);

595 
¢d_ùl_–em_šfo_£t_»ad_wr™e
(
¢d_ùl_–em_šfo_t
 *
obj
, 
rv®
, 
wv®
);

596 
¢d_ùl_–em_šfo_£t_v_»ad_wr™e
(
¢d_ùl_–em_šfo_t
 *
obj
, 
rv®
, 
wv®
);

597 
¢d_ùl_–em_šfo_£t_šaùive
(
¢d_ùl_–em_šfo_t
 *
obj
, 
v®
);

599 
¢d_ùl_add_š‹g”_–em_£t
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
,

600 
–em’t_couÁ
,

601 
memb”_couÁ
,

602 
mš
, 
max
, 
¡•
);

603 
¢d_ùl_add_š‹g”64_–em_£t
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
,

604 
–em’t_couÁ
,

605 
memb”_couÁ
,

606 
mš
, 
max
,

607 
¡•
);

608 
¢d_ùl_add_boŞ—n_–em_£t
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
,

609 
–em’t_couÁ
,

610 
memb”_couÁ
);

611 
¢d_ùl_add_’um”©ed_–em_£t
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
,

612 
–em’t_couÁ
,

613 
memb”_couÁ
,

614 
™ems
,

615 cÚ¡ *cÚ¡ 
Ïb–s
[]);

616 
¢d_ùl_add_by‹s_–em_£t
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
,

617 
–em’t_couÁ
,

618 
memb”_couÁ
);

620 
¢d_ùl_–em_add_š‹g”
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
, 
couÁ
, 
imš
, 
imax
, 
i¡•
);

621 
¢d_ùl_–em_add_š‹g”64
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
, 
couÁ
, 
imš
, 
imax
, 
i¡•
);

622 
¢d_ùl_–em_add_boŞ—n
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
, 
couÁ
);

623 
¢d_ùl_–em_add_’um”©ed
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
, 
couÁ
, 
™ems
, cÚ¡ *cÚ¡ 
Çmes
[]);

624 
¢d_ùl_–em_add_›c958
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
);

625 
¢d_ùl_–em_»move
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_id_t
 *
id
);

627 
size_t
 
¢d_ùl_–em_v®ue_sizeof
();

640 
	#¢d_ùl_–em_v®ue_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_ùl_–em_v®ue
)

	)

642 
¢d_ùl_–em_v®ue_m®loc
(
¢d_ùl_–em_v®ue_t
 **
±r
);

643 
¢d_ùl_–em_v®ue_ä“
(
¢d_ùl_–em_v®ue_t
 *
obj
);

644 
¢d_ùl_–em_v®ue_ş—r
(
¢d_ùl_–em_v®ue_t
 *
obj
);

645 
¢d_ùl_–em_v®ue_cİy
(
¢d_ùl_–em_v®ue_t
 *
d¡
, cÚ¡ snd_ùl_–em_v®ue_ˆ*
¤c
);

646 
¢d_ùl_–em_v®ue_com·»
(
¢d_ùl_–em_v®ue_t
 *
Ëá
, cÚ¡ snd_ùl_–em_v®ue_ˆ*
right
);

647 
¢d_ùl_–em_v®ue_g‘_id
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
, 
¢d_ùl_–em_id_t
 *
±r
);

648 
¢d_ùl_–em_v®ue_g‘_numid
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
);

649 
¢d_ùl_–em_içû_t
 
¢d_ùl_–em_v®ue_g‘_š‹rçû
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
);

650 
¢d_ùl_–em_v®ue_g‘_deviû
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
);

651 
¢d_ùl_–em_v®ue_g‘_subdeviû
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
);

652 cÚ¡ *
¢d_ùl_–em_v®ue_g‘_Çme
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
);

653 
¢d_ùl_–em_v®ue_g‘_šdex
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
);

654 
¢d_ùl_–em_v®ue_£t_id
(
¢d_ùl_–em_v®ue_t
 *
obj
, cÚ¡ 
¢d_ùl_–em_id_t
 *
±r
);

655 
¢d_ùl_–em_v®ue_£t_numid
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
v®
);

656 
¢d_ùl_–em_v®ue_£t_š‹rçû
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
¢d_ùl_–em_içû_t
 
v®
);

657 
¢d_ùl_–em_v®ue_£t_deviû
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
v®
);

658 
¢d_ùl_–em_v®ue_£t_subdeviû
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
v®
);

659 
¢d_ùl_–em_v®ue_£t_Çme
(
¢d_ùl_–em_v®ue_t
 *
obj
, cÚ¡ *
v®
);

660 
¢d_ùl_–em_v®ue_£t_šdex
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
v®
);

661 
¢d_ùl_–em_v®ue_g‘_boŞ—n
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
);

662 
¢d_ùl_–em_v®ue_g‘_š‹g”
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
);

663 
¢d_ùl_–em_v®ue_g‘_š‹g”64
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
);

664 
¢d_ùl_–em_v®ue_g‘_’um”©ed
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
);

665 
¢d_ùl_–em_v®ue_g‘_by‹
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
);

666 
¢d_ùl_–em_v®ue_£t_boŞ—n
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
, 
v®
);

667 
¢d_ùl_–em_v®ue_£t_š‹g”
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
, 
v®
);

668 
¢d_ùl_–em_v®ue_£t_š‹g”64
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
, 
v®
);

669 
¢d_ùl_–em_v®ue_£t_’um”©ed
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
, 
v®
);

670 
¢d_ùl_–em_v®ue_£t_by‹
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
, 
v®
);

671 
¢d_ùl_–em_£t_by‹s
(
¢d_ùl_–em_v®ue_t
 *
obj
, *
d©a
, 
size_t
 
size
);

672 cÚ¡ * 
¢d_ùl_–em_v®ue_g‘_by‹s
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
);

673 
¢d_ùl_–em_v®ue_g‘_›c958
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
, 
¢d_«s_›c958_t
 *
±r
);

674 
¢d_ùl_–em_v®ue_£t_›c958
(
¢d_ùl_–em_v®ue_t
 *
obj
, cÚ¡ 
¢d_«s_›c958_t
 *
±r
);

676 
¢d_v_·r£_dB_šfo
(*
v
, 
v_size
,

677 **
db_vp
);

678 
¢d_v_g‘_dB_¿nge
(*
v
, 
¿ngemš
, 
¿ngemax
,

679 *
mš
, *
max
);

680 
¢d_v_cÚv”t_to_dB
(*
v
, 
¿ngemš
, 
¿ngemax
,

681 
vŞume
, *
db_gaš
);

682 
¢d_v_cÚv”t_äom_dB
(*
v
, 
¿ngemš
, 
¿ngemax
,

683 
db_gaš
, *
v®ue
, 
xdœ
);

684 
¢d_ùl_g‘_dB_¿nge
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

685 *
mš
, *
max
);

686 
¢d_ùl_cÚv”t_to_dB
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

687 
vŞume
, *
db_gaš
);

688 
¢d_ùl_cÚv”t_äom_dB
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

689 
db_gaš
, *
v®ue
, 
xdœ
);

700 
_¢d_hùl_–em
 
	t¢d_hùl_–em_t
;

703 
_¢d_hùl
 
	t¢d_hùl_t
;

711 (*
¢d_hùl_com·»_t
)(cÚ¡ 
	t¢d_hùl_–em_t
 *
	te1
,

712 cÚ¡ 
	t¢d_hùl_–em_t
 *
	te2
);

713 
¢d_hùl_com·»_ç¡
(cÚ¡ 
¢d_hùl_–em_t
 *
c1
,

714 cÚ¡ 
¢d_hùl_–em_t
 *
c2
);

722 (*
¢d_hùl_ÿÎback_t
)(
	t¢d_hùl_t
 *
	thùl
,

723 
	tmask
,

724 
	t¢d_hùl_–em_t
 *
	t–em
);

731 (*
¢d_hùl_–em_ÿÎback_t
)(
	t¢d_hùl_–em_t
 *
	t–em
,

732 
	tmask
);

734 
¢d_hùl_İ’
(
¢d_hùl_t
 **
hùl
, cÚ¡ *
Çme
, 
mode
);

735 
¢d_hùl_İ’_ùl
(
¢d_hùl_t
 **
hùÍ
, 
¢d_ùl_t
 *
ùl
);

736 
¢d_hùl_şo£
(
¢d_hùl_t
 *
hùl
);

737 
¢d_hùl_nÚblock
(
¢d_hùl_t
 *
hùl
, 
nÚblock
);

738 
__šlše__
 
¢d_hùl_abÜt
(
¢d_hùl_t
 *
hùl
è{  
¢d_hùl_nÚblock
(hctl, 2); }

739 
¢d_hùl_pŞl_desütÜs_couÁ
(
¢d_hùl_t
 *
hùl
);

740 
¢d_hùl_pŞl_desütÜs
(
¢d_hùl_t
 *
hùl
, 
pŞlfd
 *
pfds
, 
¥aû
);

741 
¢d_hùl_pŞl_desütÜs_»v’ts
(
¢d_hùl_t
 *
ùl
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
);

742 
¢d_hùl_g‘_couÁ
(
¢d_hùl_t
 *
hùl
);

743 
¢d_hùl_£t_com·»
(
¢d_hùl_t
 *
hùl
, 
¢d_hùl_com·»_t
 
hsÜt
);

744 
¢d_hùl_–em_t
 *
¢d_hùl_fœ¡_–em
(
¢d_hùl_t
 *
hùl
);

745 
¢d_hùl_–em_t
 *
¢d_hùl_Ï¡_–em
(
¢d_hùl_t
 *
hùl
);

746 
¢d_hùl_–em_t
 *
¢d_hùl_fšd_–em
(
¢d_hùl_t
 *
hùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
);

747 
¢d_hùl_£t_ÿÎback
(
¢d_hùl_t
 *
hùl
, 
¢d_hùl_ÿÎback_t
 
ÿÎback
);

748 
¢d_hùl_£t_ÿÎback_´iv©e
(
¢d_hùl_t
 *
hùl
, *
d©a
);

749 *
¢d_hùl_g‘_ÿÎback_´iv©e
(
¢d_hùl_t
 *
hùl
);

750 
¢d_hùl_lßd
(
¢d_hùl_t
 *
hùl
);

751 
¢d_hùl_ä“
(
¢d_hùl_t
 *
hùl
);

752 
¢d_hùl_hªdË_ev’ts
(
¢d_hùl_t
 *
hùl
);

753 cÚ¡ *
¢d_hùl_Çme
(
¢d_hùl_t
 *
hùl
);

754 
¢d_hùl_wa™
(
¢d_hùl_t
 *
hùl
, 
timeout
);

755 
¢d_ùl_t
 *
¢d_hùl_ùl
(
¢d_hùl_t
 *
hùl
);

757 
¢d_hùl_–em_t
 *
¢d_hùl_–em_Ãxt
(¢d_hùl_–em_ˆ*
–em
);

758 
¢d_hùl_–em_t
 *
¢d_hùl_–em_´ev
(¢d_hùl_–em_ˆ*
–em
);

759 
¢d_hùl_–em_šfo
(
¢d_hùl_–em_t
 *
–em
, 
¢d_ùl_–em_šfo_t
 * 
šfo
);

760 
¢d_hùl_–em_»ad
(
¢d_hùl_–em_t
 *
–em
, 
¢d_ùl_–em_v®ue_t
 * 
v®ue
);

761 
¢d_hùl_–em_wr™e
(
¢d_hùl_–em_t
 *
–em
, 
¢d_ùl_–em_v®ue_t
 * 
v®ue
);

762 
¢d_hùl_–em_v_»ad
(
¢d_hùl_–em_t
 *
–em
, *
v
, 
v_size
);

763 
¢d_hùl_–em_v_wr™e
(
¢d_hùl_–em_t
 *
–em
, cÚ¡ *
v
);

764 
¢d_hùl_–em_v_commªd
(
¢d_hùl_–em_t
 *
–em
, cÚ¡ *
v
);

766 
¢d_hùl_t
 *
¢d_hùl_–em_g‘_hùl
(
¢d_hùl_–em_t
 *
–em
);

768 
¢d_hùl_–em_g‘_id
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
, 
¢d_ùl_–em_id_t
 *
±r
);

769 
¢d_hùl_–em_g‘_numid
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
);

770 
¢d_ùl_–em_içû_t
 
¢d_hùl_–em_g‘_š‹rçû
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
);

771 
¢d_hùl_–em_g‘_deviû
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
);

772 
¢d_hùl_–em_g‘_subdeviû
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
);

773 cÚ¡ *
¢d_hùl_–em_g‘_Çme
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
);

774 
¢d_hùl_–em_g‘_šdex
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
);

775 
¢d_hùl_–em_£t_ÿÎback
(
¢d_hùl_–em_t
 *
obj
, 
¢d_hùl_–em_ÿÎback_t
 
v®
);

776 * 
¢d_hùl_–em_g‘_ÿÎback_´iv©e
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
);

777 
¢d_hùl_–em_£t_ÿÎback_´iv©e
(
¢d_hùl_–em_t
 *
obj
, * 
v®
);

790 
¢d_sùl_bud
(
¢d_sùl_t
 **
ùl
, 
¢d_ùl_t
 *
hªdË
, 
¢d_cÚfig_t
 *
cÚfig
,

791 
¢d_cÚfig_t
 *
´iv©e_d©a
, 
mode
);

792 
¢d_sùl_ä“
(
¢d_sùl_t
 *
hªdË
);

793 
¢d_sùl_š¡®l
(
¢d_sùl_t
 *
hªdË
);

794 
¢d_sùl_»move
(
¢d_sùl_t
 *
hªdË
);

806 
¢d_deviû_Çme_hšt
(
ÿrd
, cÚ¡ *
içû
, ***
hšts
);

807 
¢d_deviû_Çme_ä“_hšt
(**
hšts
);

808 *
¢d_deviû_Çme_g‘_hšt
(cÚ¡ *
hšt
, cÚ¡ *
id
);

812 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/control_external.h

26 #iâdeà
__ALSA_CONTROL_EXTERNAL_H


27 
	#__ALSA_CONTROL_EXTERNAL_H


	)

29 
	~"cÚŒŞ.h
"

31 #ifdeà
__ılu¥lus


43 
	#SND_CTL_PLUGIN_ENTRY
(
Çme
è
_¢d_ùl_
##Çme##
_İ’


	)

48 
	#SND_CTL_PLUGIN_SYMBOL
(
Çme
è
	`SND_DLSYM_BUILD_VERSION
(
	`SND_CTL_PLUGIN_ENTRY
Òame), 
SND_CONTROL_DLSYM_VERSION
);

	)

53 
	#SND_CTL_PLUGIN_DEFINE_FUNC
(
¶ugš
) \

54 
	`SND_CTL_PLUGIN_ENTRY
(
¶ugš
è(
¢d_ùl_t
 **
hªdËp
, cÚ¡ *
Çme
,\

55 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
, 
mode
)

	)

58 
¢d_ùl_ext
 
	t¢d_ùl_ext_t
;

60 
¢d_ùl_ext_ÿÎback
 
	t¢d_ùl_ext_ÿÎback_t
;

62 
	t¢d_ùl_ext_key_t
;

63 #ifdeà
DOC_HIDDEN


65 
¢d_ùl_ext
 
	t¢d_ùl_ext_t
;

66 
¢d_ùl_ext_ÿÎback
 
	t¢d_ùl_ext_ÿÎback_t
;

69 (
¢d_ùl_ext_v_rw_t
)(
	t¢d_ùl_ext_t
 *
	text
, 
	t¢d_ùl_ext_key_t
 
	tkey
, 
	tİ_æag
, 
	tnumid
,

70 *
	tv
, 
	tv_size
);

75 
	#SND_CTL_EXT_VERSION_MAJOR
 1

	)

76 
	#SND_CTL_EXT_VERSION_MINOR
 0

	)

77 
	#SND_CTL_EXT_VERSION_TINY
 1

	)

81 
	#SND_CTL_EXT_VERSION
 ((
SND_CTL_EXT_VERSION_MAJOR
<<16) |\

82 (
SND_CTL_EXT_VERSION_MINOR
<<8) |\

83 (
SND_CTL_EXT_VERSION_TINY
))

	)

86 
	s¢d_ùl_ext
 {

91 
v”siÚ
;

95 
ÿrd_idx
;

99 
id
[16];

103 
driv”
[16];

107 
Çme
[32];

111 
lÚgÇme
[80];

115 
mix”Çme
[80];

119 
pŞl_fd
;

124 cÚ¡ 
¢d_ùl_ext_ÿÎback_t
 *
ÿÎback
;

128 *
´iv©e_d©a
;

132 
¢d_ùl_t
 *
hªdË
;

134 
nÚblock
;

135 
subsüibed
;

141 
¢d_ùl_ext_v_rw_t
 *
c
;

142 cÚ¡ *
p
;

143 } 
v
;

147 
	s¢d_ùl_ext_ÿÎback
 {

151 (*
şo£
)(
¢d_ùl_ext_t
 *
ext
);

155 (*
–em_couÁ
)(
¢d_ùl_ext_t
 *
ext
);

159 (*
–em_li¡
)(
¢d_ùl_ext_t
 *
ext
, 
off£t
, 
¢d_ùl_–em_id_t
 *
id
);

163 
¢d_ùl_ext_key_t
 (*
fšd_–em
)(
¢d_ùl_ext_t
 *
ext
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
);

167 (*
ä“_key
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
);

171 (*
g‘_©Œibu‹
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
,

172 *
ty³
, *
acc
, *
couÁ
);

176 (*
g‘_š‹g”_šfo
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
,

177 *
imš
, *
imax
, *
i¡•
);

181 (*
g‘_š‹g”64_šfo
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
,

182 
št64_t
 *
imš
, iÁ64_ˆ*
imax
, iÁ64_ˆ*
i¡•
);

186 (*
g‘_’um”©ed_šfo
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
, *
™ems
);

190 (*
g‘_’um”©ed_Çme
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
, 
™em
,

191 *
Çme
, 
size_t
 
Çme_max_Ën
);

195 (*
»ad_š‹g”
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
, *
v®ue
);

199 (*
»ad_š‹g”64
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
, 
št64_t
 *
v®ue
);

203 (*
»ad_’um”©ed
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
, *
™ems
);

207 (*
»ad_by‹s
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
, *
d©a
,

208 
size_t
 
max_by‹s
);

212 (*
»ad_›c958
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
, 
¢d_«s_›c958_t
 *
›c958
);

216 (*
wr™e_š‹g”
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
, *
v®ue
);

220 (*
wr™e_š‹g”64
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
, 
št64_t
 *
v®ue
);

224 (*
wr™e_’um”©ed
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
, *
™ems
);

228 (*
wr™e_by‹s
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
, *
d©a
,

229 
size_t
 
max_by‹s
);

233 (*
wr™e_›c958
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_ext_key_t
 
key
, 
¢d_«s_›c958_t
 *
›c958
);

237 (*
subsüibe_ev’ts
)(
¢d_ùl_ext_t
 *
ext
, 
subsüibe
);

241 (*
»ad_ev’t
)(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_–em_id_t
 *
id
, *
ev’t_mask
);

245 (*
pŞl_desütÜs_couÁ
)(
¢d_ùl_ext_t
 *
ext
);

249 (*
pŞl_desütÜs
)(
¢d_ùl_ext_t
 *
ext
, 
pŞlfd
 *
pfds
, 
¥aû
);

253 (*
pŞl_»v’ts
)(
¢d_ùl_ext_t
 *
ext
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
);

259 
	e¢d_ùl_ext_acûss
 {

260 
SND_CTL_EXT_ACCESS_READ
 = (1<<0),

261 
SND_CTL_EXT_ACCESS_WRITE
 = (1<<1),

262 
SND_CTL_EXT_ACCESS_READWRITE
 = (3<<0),

263 
SND_CTL_EXT_ACCESS_VOLATILE
 = (1<<2),

264 
SND_CTL_EXT_ACCESS_TLV_READ
 = (1<<4),

265 
SND_CTL_EXT_ACCESS_TLV_WRITE
 = (1<<5),

266 
SND_CTL_EXT_ACCESS_TLV_READWRITE
 = (3<<4),

267 
SND_CTL_EXT_ACCESS_TLV_COMMAND
 = (1<<6),

268 
SND_CTL_EXT_ACCESS_INACTIVE
 = (1<<8),

269 
SND_CTL_EXT_ACCESS_TLV_CALLBACK
 = (1<<28),

270 } 
	t¢d_ùl_ext_acûss_t
;

275 
	#SND_CTL_EXT_KEY_NOT_FOUND
 (
¢d_ùl_ext_key_t
)(-1)

	)

277 
¢d_ùl_ext_ü—‹
(
¢d_ùl_ext_t
 *
ext
, cÚ¡ *
Çme
, 
mode
);

278 
¢d_ùl_ext_d–‘e
(
¢d_ùl_ext_t
 *
ext
);

282 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/control_plugin.h

31 #iâdeà
__ALSA_CONTROL_PLUGIN_H


32 
	#__ALSA_CONTROL_PLUGIN_H


	)

44 
¢d_ùl_hw_İ’
(
¢d_ùl_t
 **
hªdË
, cÚ¡ *
Çme
, 
ÿrd
, 
mode
);

45 
_¢d_ùl_hw_İ’
(
¢d_ùl_t
 **
hªdËp
, *
Çme
, 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
, 
mode
);

50 
¢d_ùl_»m­_İ’
(
¢d_ùl_t
 **
hªdËp
, cÚ¡ *
Çme
, 
¢d_cÚfig_t
 *
»m­
,

51 
¢d_cÚfig_t
 *
m­
, 
¢d_ùl_t
 *
chd
, 
mode
);

52 
_¢d_ùl_»m­_İ’
(
¢d_ùl_t
 **
hªdËp
, *
Çme
, 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
, 
mode
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/error.h

28 #iâdeà
__ALSA_ERROR_H


29 
	#__ALSA_ERROR_H


	)

31 #ifdeà
__ılu¥lus


41 
	#SND_ERROR_BEGIN
 500000

	)

42 
	#SND_ERROR_INCOMPATIBLE_VERSION
 (
SND_ERROR_BEGIN
+0è

	)

43 
	#SND_ERROR_ALISP_NIL
 (
SND_ERROR_BEGIN
+1è

	)

45 cÚ¡ *
¢d_¡»¼Ü
(
”ºum
);

59 (*
¢d_lib_”rÜ_hªdËr_t
)(cÚ¡ *
	tfe
, 
	tlše
, cÚ¡ *
	tfunùiÚ
, 
	t”r
, cÚ¡ *
	tfmt
, ...) ;

60 
¢d_lib_”rÜ_hªdËr_t
 
¢d_lib_”rÜ
;

61 
¢d_lib_”rÜ_£t_hªdËr
(
¢d_lib_”rÜ_hªdËr_t
 
hªdËr
);

63 #ià
__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 > 95)

64 
	#SNDERR
(...è
	`¢d_lib_”rÜ
(
__FILE__
, 
__LINE__
, 
__func__
, 0, 
__VA_ARGS__
è

	)

65 
	#SYSERR
(...è
	`¢d_lib_”rÜ
(
__FILE__
, 
__LINE__
, 
__func__
, 
”ºo
, 
__VA_ARGS__
è

	)

67 
	#SNDERR
(
¬gs
...è
	`¢d_lib_”rÜ
(
__FILE__
, 
__LINE__
, 
__func__
, 0, ##¬gsè

	)

68 
	#SYSERR
(
¬gs
...è
	`¢d_lib_”rÜ
(
__FILE__
, 
__LINE__
, 
__func__
, 
”ºo
, ##¬gsè

	)

73 #ifdeà
__ılu¥lus


78 (*
	t¢d_loÿl_”rÜ_hªdËr_t
)(cÚ¡ *
	tfe
, 
	tlše
,

79 cÚ¡ *
	tfunc
, 
	t”r
,

80 cÚ¡ *
	tfmt
, 
	tva_li¡
 
	t¬g
);

82 
¢d_loÿl_”rÜ_hªdËr_t
 
	`¢d_lib_”rÜ_£t_loÿl
(¢d_loÿl_”rÜ_hªdËr_ˆ
func
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/global.h

28 #iâdeà
__ALSA_GLOBAL_H_


29 
	#__ALSA_GLOBAL_H_


	)

32 
	~<time.h
>

34 #ifdeà
__ılu¥lus


47 cÚ¡ *
¢d_asoundlib_v”siÚ
();

49 #iâdeà
ATTRIBUTE_UNUSED


51 
	#ATTRIBUTE_UNUSED
 
	`__©Œibu‹__
 ((
__unu£d__
))

	)

54 #iâdeà
__STRING


56 
	#__STRING
(
x
è#x

	)

59 #ifdeà
PIC


62 
	#__SND_DLSYM_VERSION
(
Çme
, 
v”siÚ
è
_
 ##‚am## 
	)
version

67 
	#SND_DLSYM_BUILD_VERSION
(
Çme
, 
v”siÚ
è
	`__SND_DLSYM_VERSION
Òame, v”siÚ);

	)

71 
	s¢d_dlsym_lšk
 {

72 
¢d_dlsym_lšk
 *
Ãxt
;

73 cÚ¡ *
dlsym_Çme
;

74 cÚ¡ *
dlsym_±r
;

77 
¢d_dlsym_lšk
 *
¢d_dlsym_¡¬t
;

80 
	#__SND_DLSYM_VERSION
(
´efix
, 
Çme
, 
v”siÚ
è
_
 ##…»fix ##‚am## 
	)
version

85 
	#SND_DLSYM_BUILD_VERSION
(
Çme
, 
v”siÚ
) \

86 
¢d_dlsym_lšk
 
	`__SND_DLSYM_VERSION
(
¢d_dlsym_
, 
Çme
, 
v”siÚ
); \

87 
	`__SND_DLSYM_VERSION
(
¢d_dlsym_cÚ¡ruùÜ_
, 
Çme
, 
v”siÚ
è(è
	`__©Œibu‹__
 ((
cÚ¡ruùÜ
)); \

88 
	`__SND_DLSYM_VERSION
(
¢d_dlsym_cÚ¡ruùÜ_
, 
Çme
, 
v”siÚ
) () { \

89 
	`__SND_DLSYM_VERSION
(
¢d_dlsym_
, 
Çme
, 
v”siÚ
).
Ãxt
 = 
¢d_dlsym_¡¬t
; \

90 
	`__SND_DLSYM_VERSION
(
¢d_dlsym_
, 
Çme
, 
v”siÚ
).
dlsym_Çme
 = 
	`__STRING
(name); \

91 
	`__SND_DLSYM_VERSION
(
¢d_dlsym_
, 
Çme
, 
v”siÚ
).
dlsym_±r
 = (*)&name; \

92 
¢d_dlsym_¡¬t
 = &
	`__SND_DLSYM_VERSION
(
¢d_dlsym_
, 
Çme
, 
v”siÚ
); \

93 }

	)

98 
	#SND_DLSYM_VERSION
(
v”siÚ
è
	`__STRING
(v”siÚ)

	)

100 
¢d_dÍ©h
(*
·th
, 
size_t
 
·th_Ën
, cÚ¡ *
Çme
);

101 *
¢d_dlİ’
(cÚ¡ *
fe
, 
mode
, *
”rbuf
, 
size_t
 
”rbuæ’
);

102 *
¢d_dlsym
(*
hªdË
, cÚ¡ *
Çme
, cÚ¡ *
v”siÚ
);

103 
¢d_dlşo£
(*
hªdË
);

107 
	#__¢d_®loÿ
(
±r
,
ty³
èdØ{ *±¸ğÑy³##
_t
 *è
	`®loÿ
Ñy³##
	`_sizeof
()); 
	`mem£t
(*±r, 0,y³##_sizeof()); } 0)

	)

115 
_¢d_async_hªdËr
 
	t¢d_async_hªdËr_t
;

122 (*
	g¢d_async_ÿÎback_t
)(
	t¢d_async_hªdËr_t
 *
	thªdËr
);

124 
¢d_async_add_hªdËr
(
¢d_async_hªdËr_t
 **
hªdËr
, 
fd
,

125 
¢d_async_ÿÎback_t
 
ÿÎback
, *
´iv©e_d©a
);

126 
¢d_async_d–_hªdËr
(
¢d_async_hªdËr_t
 *
hªdËr
);

127 
¢d_async_hªdËr_g‘_fd
(
¢d_async_hªdËr_t
 *
hªdËr
);

128 
¢d_async_hªdËr_g‘_signo
(
¢d_async_hªdËr_t
 *
hªdËr
);

129 *
¢d_async_hªdËr_g‘_ÿÎback_´iv©e
(
¢d_async_hªdËr_t
 *
hªdËr
);

131 
¢d_shm_¬—
 *
¢d_shm_¬—_ü—‹
(
shmid
, *
±r
);

132 
¢d_shm_¬—
 *
¢d_shm_¬—_sh¬e
(¢d_shm_¬— *
¬—
);

133 
¢d_shm_¬—_de¡roy
(
¢d_shm_¬—
 *
¬—
);

135 
¢d_u£r_fe
(cÚ¡ *
fe
, **
»suÉ
);

137 #ifdeà
__GLIBC__


138 #ià!
defšed
(
_POSIX_C_SOURCE
è&& !defšed(
_POSIX_SOURCE
)

139 
	stimev®
 {

140 
time_t
 
	gtv_£c
;

141 
	gtv_u£c
;

144 
	stime¥ec
 {

145 
time_t
 
	gtv_£c
;

146 
	gtv_n£c
;

152 
timev®
 
	t¢d_time¡amp_t
;

154 
time¥ec
 
	t¢d_htime¡amp_t
;

158 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/hwdep.h

28 #iâdeà
__ALSA_HWDEP_H


29 
	#__ALSA_HWDEP_H


	)

31 #ifdeà
__ılu¥lus


42 
	#SND_HWDEP_DLSYM_VERSION
 
_dlsym_hwd•_001


	)

45 
_¢d_hwd•_šfo
 
	t¢d_hwd•_šfo_t
;

48 
_¢d_hwd•_d¥_¡©us
 
	t¢d_hwd•_d¥_¡©us_t
;

51 
_¢d_hwd•_d¥_image
 
	t¢d_hwd•_d¥_image_t
;

54 
	e_¢d_hwd•_içû
 {

55 
SND_HWDEP_IFACE_OPL2
 = 0,

56 
SND_HWDEP_IFACE_OPL3
,

57 
SND_HWDEP_IFACE_OPL4
,

58 
SND_HWDEP_IFACE_SB16CSP
,

59 
SND_HWDEP_IFACE_EMU10K1
,

60 
SND_HWDEP_IFACE_YSS225
,

61 
SND_HWDEP_IFACE_ICS2115
,

62 
SND_HWDEP_IFACE_SSCAPE
,

63 
SND_HWDEP_IFACE_VX
,

64 
SND_HWDEP_IFACE_MIXART
,

65 
SND_HWDEP_IFACE_USX2Y
,

66 
SND_HWDEP_IFACE_EMUX_WAVETABLE
,

67 
SND_HWDEP_IFACE_BLUETOOTH
,

68 
SND_HWDEP_IFACE_USX2Y_PCM
,

69 
SND_HWDEP_IFACE_PCXHR
,

70 
SND_HWDEP_IFACE_SB_RC
,

71 
SND_HWDEP_IFACE_HDA
,

72 
SND_HWDEP_IFACE_USB_STREAM
,

73 
SND_HWDEP_IFACE_FW_DICE
,

74 
SND_HWDEP_IFACE_FW_FIREWORKS
,

75 
SND_HWDEP_IFACE_FW_BEBOB
,

76 
SND_HWDEP_IFACE_FW_OXFW
,

77 
SND_HWDEP_IFACE_FW_DIGI00X
,

78 
SND_HWDEP_IFACE_FW_TASCAM
,

79 
SND_HWDEP_IFACE_LINE6
,

80 
SND_HWDEP_IFACE_FW_MOTU
,

81 
SND_HWDEP_IFACE_FW_FIREFACE
,

83 
SND_HWDEP_IFACE_LAST
 = 
SND_HWDEP_IFACE_FW_FIREFACE
,

84 } 
	t¢d_hwd•_içû_t
;

87 
	#SND_HWDEP_OPEN_READ
 (
O_RDONLY
)

	)

89 
	#SND_HWDEP_OPEN_WRITE
 (
O_WRONLY
)

	)

91 
	#SND_HWDEP_OPEN_DUPLEX
 (
O_RDWR
)

	)

93 
	#SND_HWDEP_OPEN_NONBLOCK
 (
O_NONBLOCK
)

	)

96 
	e_¢d_hwd•_ty³
 {

98 
SND_HWDEP_TYPE_HW
,

100 
SND_HWDEP_TYPE_SHM
,

102 
SND_HWDEP_TYPE_INET


103 } 
	t¢d_hwd•_ty³_t
;

106 
_¢d_hwd•
 
	t¢d_hwd•_t
;

108 
¢d_hwd•_İ’
(
¢d_hwd•_t
 **
hwd•
, cÚ¡ *
Çme
, 
mode
);

109 
¢d_hwd•_şo£
(
¢d_hwd•_t
 *
hwd•
);

110 
¢d_hwd•_pŞl_desütÜs
(
¢d_hwd•_t
 *
hwd•
, 
pŞlfd
 *
pfds
, 
¥aû
);

111 
¢d_hwd•_pŞl_desütÜs_couÁ
(
¢d_hwd•_t
 *
hwd•
);

112 
¢d_hwd•_pŞl_desütÜs_»v’ts
(
¢d_hwd•_t
 *
hwd•
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
);

113 
¢d_hwd•_nÚblock
(
¢d_hwd•_t
 *
hwd•
, 
nÚblock
);

114 
¢d_hwd•_šfo
(
¢d_hwd•_t
 *
hwd•
, 
¢d_hwd•_šfo_t
 * 
šfo
);

115 
¢d_hwd•_d¥_¡©us
(
¢d_hwd•_t
 *
hwd•
, 
¢d_hwd•_d¥_¡©us_t
 *
¡©us
);

116 
¢d_hwd•_d¥_lßd
(
¢d_hwd•_t
 *
hwd•
, 
¢d_hwd•_d¥_image_t
 *
block
);

117 
¢d_hwd•_ioùl
(
¢d_hwd•_t
 *
hwd•
, 
»que¡
, * 
¬g
);

118 
ssize_t
 
¢d_hwd•_wr™e
(
¢d_hwd•_t
 *
hwd•
, cÚ¡ *
bufãr
, 
size_t
 
size
);

119 
ssize_t
 
¢d_hwd•_»ad
(
¢d_hwd•_t
 *
hwd•
, *
bufãr
, 
size_t
 
size
);

121 
size_t
 
¢d_hwd•_šfo_sizeof
();

123 
	#¢d_hwd•_šfo_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_hwd•_šfo
)

	)

124 
¢d_hwd•_šfo_m®loc
(
¢d_hwd•_šfo_t
 **
±r
);

125 
¢d_hwd•_šfo_ä“
(
¢d_hwd•_šfo_t
 *
obj
);

126 
¢d_hwd•_šfo_cİy
(
¢d_hwd•_šfo_t
 *
d¡
, cÚ¡ snd_hwd•_šfo_ˆ*
¤c
);

128 
¢d_hwd•_šfo_g‘_deviû
(cÚ¡ 
¢d_hwd•_šfo_t
 *
obj
);

129 
¢d_hwd•_šfo_g‘_ÿrd
(cÚ¡ 
¢d_hwd•_šfo_t
 *
obj
);

130 cÚ¡ *
¢d_hwd•_šfo_g‘_id
(cÚ¡ 
¢d_hwd•_šfo_t
 *
obj
);

131 cÚ¡ *
¢d_hwd•_šfo_g‘_Çme
(cÚ¡ 
¢d_hwd•_šfo_t
 *
obj
);

132 
¢d_hwd•_içû_t
 
¢d_hwd•_šfo_g‘_içû
(cÚ¡ 
¢d_hwd•_šfo_t
 *
obj
);

133 
¢d_hwd•_šfo_£t_deviû
(
¢d_hwd•_šfo_t
 *
obj
, 
v®
);

135 
size_t
 
¢d_hwd•_d¥_¡©us_sizeof
();

137 
	#¢d_hwd•_d¥_¡©us_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_hwd•_d¥_¡©us
)

	)

138 
¢d_hwd•_d¥_¡©us_m®loc
(
¢d_hwd•_d¥_¡©us_t
 **
±r
);

139 
¢d_hwd•_d¥_¡©us_ä“
(
¢d_hwd•_d¥_¡©us_t
 *
obj
);

140 
¢d_hwd•_d¥_¡©us_cİy
(
¢d_hwd•_d¥_¡©us_t
 *
d¡
, cÚ¡ snd_hwd•_d¥_¡©us_ˆ*
¤c
);

142 
¢d_hwd•_d¥_¡©us_g‘_v”siÚ
(cÚ¡ 
¢d_hwd•_d¥_¡©us_t
 *
obj
);

143 cÚ¡ *
¢d_hwd•_d¥_¡©us_g‘_id
(cÚ¡ 
¢d_hwd•_d¥_¡©us_t
 *
obj
);

144 
¢d_hwd•_d¥_¡©us_g‘_num_d¥s
(cÚ¡ 
¢d_hwd•_d¥_¡©us_t
 *
obj
);

145 
¢d_hwd•_d¥_¡©us_g‘_d¥_lßded
(cÚ¡ 
¢d_hwd•_d¥_¡©us_t
 *
obj
);

146 
¢d_hwd•_d¥_¡©us_g‘_ch_»ady
(cÚ¡ 
¢d_hwd•_d¥_¡©us_t
 *
obj
);

148 
size_t
 
¢d_hwd•_d¥_image_sizeof
();

150 
	#¢d_hwd•_d¥_image_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_hwd•_d¥_image
)

	)

151 
¢d_hwd•_d¥_image_m®loc
(
¢d_hwd•_d¥_image_t
 **
±r
);

152 
¢d_hwd•_d¥_image_ä“
(
¢d_hwd•_d¥_image_t
 *
obj
);

153 
¢d_hwd•_d¥_image_cİy
(
¢d_hwd•_d¥_image_t
 *
d¡
, cÚ¡ snd_hwd•_d¥_image_ˆ*
¤c
);

155 
¢d_hwd•_d¥_image_g‘_šdex
(cÚ¡ 
¢d_hwd•_d¥_image_t
 *
obj
);

156 cÚ¡ *
¢d_hwd•_d¥_image_g‘_Çme
(cÚ¡ 
¢d_hwd•_d¥_image_t
 *
obj
);

157 cÚ¡ *
¢d_hwd•_d¥_image_g‘_image
(cÚ¡ 
¢d_hwd•_d¥_image_t
 *
obj
);

158 
size_t
 
¢d_hwd•_d¥_image_g‘_Ëngth
(cÚ¡ 
¢d_hwd•_d¥_image_t
 *
obj
);

160 
¢d_hwd•_d¥_image_£t_šdex
(
¢d_hwd•_d¥_image_t
 *
obj
, 
_šdex
);

161 
¢d_hwd•_d¥_image_£t_Çme
(
¢d_hwd•_d¥_image_t
 *
obj
, cÚ¡ *
Çme
);

162 
¢d_hwd•_d¥_image_£t_image
(
¢d_hwd•_d¥_image_t
 *
obj
, *
bufãr
);

163 
¢d_hwd•_d¥_image_£t_Ëngth
(
¢d_hwd•_d¥_image_t
 *
obj
, 
size_t
 
Ëngth
);

167 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/input.h

28 #iâdeà
__ALSA_INPUT_H


29 
	#__ALSA_INPUT_H


	)

31 
	~<¡d¬g.h
>

33 #ifdeà
__ılu¥lus


56 
_¢d_šput
 
	t¢d_šput_t
;

59 
	e_¢d_šput_ty³
 {

61 
SND_INPUT_STDIO
,

63 
SND_INPUT_BUFFER


64 } 
	t¢d_šput_ty³_t
;

66 
¢d_šput_¡dio_İ’
(
¢d_šput_t
 **
špu
, cÚ¡ *
fe
, cÚ¡ *
mode
);

67 
¢d_šput_¡dio_©ch
(
¢d_šput_t
 **
špu
, 
FILE
 *
å
, 
_şo£
);

68 
¢d_šput_bufãr_İ’
(
¢d_šput_t
 **
špu
, cÚ¡ *
bufãr
, 
ssize_t
 
size
);

69 
¢d_šput_şo£
(
¢d_šput_t
 *
šput
);

70 
¢d_šput_sÿnf
(
¢d_šput_t
 *
šput
, cÚ¡ *
fÜm©
, ...)

71 #iâdeà
DOC_HIDDEN


72 
__©Œibu‹__
 ((
fÜm©
 (
sÿnf
, 2, 3)))

75 *
¢d_šput_g‘s
(
¢d_šput_t
 *
šput
, *
¡r
, 
size_t
 
size
);

76 
¢d_šput_g‘c
(
¢d_šput_t
 *
šput
);

77 
¢d_šput_ung‘c
(
¢d_šput_t
 *
šput
, 
c
);

81 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/list.h

15 #iâdeà
_LIST_H


16 
	#_LIST_H


	)

18 
	~<¡ddef.h
>

20 
	sli¡_h—d
 {

21 
li¡_h—d
 *
	mÃxt
;

22 
li¡_h—d
 *
	m´ev
;

26 
	#LIST_HEAD
(
x
) \

27 
li¡_h—d
 
x
 = { &x, &x }

	)

30 
šlše
 
	$INIT_LIST_HEAD
(
li¡_h—d
 *
p
)

32 
p
->
Ãxt
 =…->
´ev
 =…;

33 
	}
}

35 
	#li¡_’Œy_off£t
(
p
, 
ty³
, 
off£t
) \

36 ((
ty³
 *)((*)(
p
è- (
off£t
)))

	)

43 
	#li¡_’Œy
(
p
, 
ty³
, 
memb”
) \

44 
	`li¡_’Œy_off£t
(
p
, 
ty³
, 
	`off£tof
Ñy³, 
memb”
))

	)

50 
	#li¡_fÜ_—ch
(
p
, 
li¡
) \

51 
p
 = (
li¡
)->
Ãxt
;… !ğÖi¡);… =…->Ãxt)

	)

58 
	#li¡_fÜ_—ch_§ã
(
p
, 
s
, 
li¡
) \

59 
p
 = (
li¡
)->
Ãxt
; 
s
 =…->Ãxt,… !ğÖi¡);… = s)

	)

65 
šlše
 
	$li¡_add
(
li¡_h—d
 *
p
, li¡_h—d *
li¡
)

67 
li¡_h—d
 *
fœ¡
 = 
li¡
->
Ãxt
;

69 
p
->
Ãxt
 = 
fœ¡
;

70 
fœ¡
->
´ev
 = 
p
;

71 
li¡
->
Ãxt
 = 
p
;

72 
p
->
´ev
 = 
li¡
;

73 
	}
}

79 
šlše
 
	$li¡_add_
(
li¡_h—d
 *
p
, li¡_h—d *
li¡
)

81 
li¡_h—d
 *
Ï¡
 = 
li¡
->
´ev
;

83 
Ï¡
->
Ãxt
 = 
p
;

84 
p
->
´ev
 = 
Ï¡
;

85 
p
->
Ãxt
 = 
li¡
;

86 
li¡
->
´ev
 = 
p
;

87 
	}
}

94 
šlše
 
	$li¡_š£¹
(
li¡_h—d
 *
p
,

95 
li¡_h—d
 *
´ev
,

96 
li¡_h—d
 *
Ãxt
)

98 
Ãxt
->
´ev
 = 
p
;

99 
p
->
Ãxt
 =‚ext;

100 
p
->
´ev
 =…rev;

101 
´ev
->
Ãxt
 = 
p
;

102 
	}
}

105 
šlše
 
	$li¡_d–
(
li¡_h—d
 *
p
)

107 
p
->
´ev
->
Ãxt
 =…->next;

108 
p
->
Ãxt
->
´ev
 =…->prev;

109 
	}
}

112 
šlše
 
	$li¡_em±y
(cÚ¡ 
li¡_h—d
 *
p
)

114  
p
->
Ãxt
 ==…;

115 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/local.h

22 #iâdeà
__LOCAL_H


23 
	#__LOCAL_H


	)

25 
	~"cÚfig.h
"

27 
	~<uni¡d.h
>

28 
	~<¡dio.h
>

29 
	~<¡dlib.h
>

30 
	~<¡ršg.h
>

31 
	~<fú.h
>

32 
	~<as£¹.h
>

33 #ifdeà
HAVE_ENDIAN_H


34 
	~<’dŸn.h
>

35 #–ià
defšed
(
HAVE_SYS_ENDIAN_H
)

36 
	~<sys/’dŸn.h
>

38 #”rÜ 
H—d”
 
defššg
 
’dŸÂess
 
nÙ
 
defšed


40 #iâdeà
__BYTE_ORDER


41 
	#__BYTE_ORDER
 
BYTE_ORDER


	)

43 #iâdeà
__LITTLE_ENDIAN


44 
	#__LITTLE_ENDIAN
 
LITTLE_ENDIAN


	)

46 #iâdeà
__BIG_ENDIAN


47 
	#__BIG_ENDIAN
 
BIG_ENDIAN


	)

49 
	~<¡d¬g.h
>

50 
	~<pŞl.h
>

51 
	~<sys/ty³s.h
>

52 
	~<”ºo.h
>

53 #ià
defšed
(
__lšux__
)

54 
	~<lšux/ty³s.h
>

55 
	~<lšux/ioùl.h
>

57 
	~"ty³_com·t.h
"

60 #ifdeà
SUPPORT_RESMGR


61 
	~<»smgr.h
>

63 #ifdeà
HAVE_LIBDL


64 
	~<dlfú.h
>

66 
	#RTLD_NOW
 0

	)

69 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


70 
	#SND_LITTLE_ENDIAN


	)

71 
	#SNDRV_LITTLE_ENDIAN


	)

72 
	#SNDRV_LITTLE_ENDIAN_BITFIELD


	)

73 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


74 
	#SND_BIG_ENDIAN


	)

75 
	#SNDRV_BIG_ENDIAN


	)

76 
	#SNDRV_BIG_ENDIAN_BITFIELD


	)

81 #iâdeà
HAVE_LFS


82 
	#¡©64
 
¡©


	)

83 
	#l¡©64
 
l¡©


	)

84 
	#dœ’t64
 
dœ’t


	)

85 
	#»addœ64
 
»addœ


	)

86 
	#sÿndœ64
 
sÿndœ


	)

87 
	#v”siÚsÜt64
 
v”siÚsÜt


	)

88 
	#®phasÜt64
 
®phasÜt


	)

89 
	#šo64_t
 
šo_t


	)

90 
	#f¡©64
 
f¡©


	)

91 
	#¡©64
 
¡©


	)

94 
	#_¢d_cÚfig_™”©Ü
 
li¡_h—d


	)

95 
	#_¢d_š‹rv®
 
¢d_š‹rv®


	)

96 
	#_¢d_pcm_šfo
 
¢d_pcm_šfo


	)

97 
	#_¢d_pcm_hw_·¿ms
 
¢d_pcm_hw_·¿ms


	)

98 
	#_¢d_pcm_sw_·¿ms
 
¢d_pcm_sw_·¿ms


	)

99 
	#_¢d_pcm_¡©us
 
¢d_pcm_¡©us


	)

101 
	#_¢d_ùl_ÿrd_šfo
 
¢d_ùl_ÿrd_šfo


	)

102 
	#_¢d_ùl_–em_id
 
¢d_ùl_–em_id


	)

103 
	#_¢d_ùl_–em_li¡
 
¢d_ùl_–em_li¡


	)

104 
	#_¢d_ùl_–em_šfo
 
¢d_ùl_–em_šfo


	)

105 
	#_¢d_ùl_–em_v®ue
 
¢d_ùl_–em_v®ue


	)

106 
	#_¢d_ùl_ev’t
 
¢d_ùl_ev’t


	)

108 
	#_¢d_¿wmidi_šfo
 
¢d_¿wmidi_šfo


	)

109 
	#_¢d_¿wmidi_·¿ms
 
¢d_¿wmidi_·¿ms


	)

110 
	#_¢d_¿wmidi_¡©us
 
¢d_¿wmidi_¡©us


	)

112 
	#_¢d_hwd•_šfo
 
¢d_hwd•_šfo


	)

113 
	#_¢d_hwd•_d¥_¡©us
 
¢d_hwd•_d¥_¡©us


	)

114 
	#_¢d_hwd•_d¥_image
 
¢d_hwd•_d¥_image


	)

116 
	#_¢d_£q_queue_‹mpo
 
¢d_£q_queue_‹mpo


	)

117 
	#_¢d_£q_ş›Á_šfo
 
¢d_£q_ş›Á_šfo


	)

118 
	#_¢d_£q_pÜt_šfo
 
¢d_£q_pÜt_šfo


	)

119 
	#_¢d_£q_sy¡em_šfo
 
¢d_£q_sy¡em_šfo


	)

120 
	#_¢d_£q_queue_šfo
 
¢d_£q_queue_šfo


	)

121 
	#_¢d_£q_queue_¡©us
 
¢d_£q_queue_¡©us


	)

122 
	#_¢d_£q_queue_tim”
 
¢d_£q_queue_tim”


	)

123 
	#_¢d_£q_pÜt_subsüibe
 
¢d_£q_pÜt_subsüibe


	)

124 
	#_¢d_£q_qu”y_subsüibe
 
¢d_£q_qu”y_subs


	)

125 
	#_¢d_£q_ş›Á_poŞ
 
¢d_£q_ş›Á_poŞ


	)

126 
	#_¢d_£q_»move_ev’ts
 
¢d_£q_»move_ev’ts


	)

128 
	#_¢d_tim”_id
 
¢d_tim”_id


	)

129 
	#_¢d_tim”_gšfo
 
¢d_tim”_gšfo


	)

130 
	#_¢d_tim”_g·¿ms
 
¢d_tim”_g·¿ms


	)

131 
	#_¢d_tim”_g¡©us
 
¢d_tim”_g¡©us


	)

132 
	#_¢d_tim”_£Ëù
 
¢d_tim”_£Ëù


	)

133 
	#_¢d_tim”_šfo
 
¢d_tim”_šfo


	)

134 
	#_¢d_tim”_·¿ms
 
¢d_tim”_·¿ms


	)

135 
	#_¢d_tim”_¡©us
 
¢d_tim”_¡©us


	)

137 
	#ALSA_LIBRARY_BUILD


	)

140 
	#¢d_«s_›c958
 
¢drv_«s_›c958


	)

141 
	#¢d_pcm_uäames_t
 
¢drv_pcm_uäames_t


	)

142 
	#¢d_pcm_säames_t
 
¢drv_pcm_säames_t


	)

143 
	#¢d_pcm_acûss_t
 
¢drv_pcm_acûss_t


	)

144 
	#¢d_pcm_fÜm©_t
 
¢drv_pcm_fÜm©_t


	)

145 
	#¢d_pcm_subfÜm©_t
 
¢drv_pcm_subfÜm©_t


	)

146 
	#¢d_pcm_¡©e_t
 
¢drv_pcm_¡©e_t


	)

147 
	#¢d_š‹rv®
 
¢drv_š‹rv®


	)

148 
	#¢d_mask
 
¢drv_mask


	)

149 
	#¢d_ùl_–em_ty³_t
 
¢drv_ùl_–em_ty³_t


	)

150 
	#¢d_ùl_–em_içû_t
 
¢drv_ùl_–em_içû_t


	)

151 
	#¢d_ùl_v
 
¢drv_ùl_v


	)

154 #iâdeà
__u£r


155 
	#__u£r


	)

157 #iâdeà
__fÜû


158 
	#__fÜû


	)

161 
	~<sound/asound.h
>

164 #undeà
¢d_«s_›c958


165 #undeà
¢d_pcm_uäames_t


166 #undeà
¢d_pcm_säames_t


167 #undeà
¢d_pcm_acûss_t


168 #undeà
¢d_pcm_fÜm©_t


169 #undeà
¢d_pcm_subfÜm©_t


170 #undeà
¢d_pcm_¡©e_t


171 #undeà
¢d_ùl_–em_ty³_t


172 #undeà
¢d_ùl_–em_içû_t


174 
	~"asoundef.h
"

175 
	~"®§-symbŞs.h
"

176 
	~"v”siÚ.h
"

177 
	~"glob®.h
"

178 
	~"šput.h
"

179 
	~"ouut.h
"

180 
	~"”rÜ.h
"

181 
	~"cÚf.h
"

182 
	~"pcm.h
"

183 
	~"pcm_¶ugš.h
"

184 
	~"¿wmidi.h
"

185 
	~"ump.h
"

186 
	~"tim”.h
"

187 
	~"hwd•.h
"

188 
	~"cÚŒŞ.h
"

189 
	~"mix”.h
"

190 
	~"£q_ev’t.h
"

191 
	~"£q.h
"

194 
	#¢d_£q_addr
 
¢drv_£q_addr


	)

195 
	#¢d_£q_tick_time_t
 
¢drv_£q_tick_time_t


	)

196 
	#¢d_£q_»®_time
 
¢drv_£q_»®_time


	)

197 
	#¢d_£q_time¡amp
 
¢drv_£q_time¡amp


	)

198 
	#¢d_£q_ev’t_ty³_t
 
¢drv_£q_ev’t_ty³_t


	)

199 
	#¢d_£q_ev’t_d©a
 
¢drv_£q_ev’t_d©a


	)

200 
	#¢d_£q_ev’t
 
¢drv_£q_ev’t


	)

201 
	#¢d_£q_ump_ev’t
 
¢drv_£q_ump_ev’t


	)

202 
	#¢d_£q_cÚÃù
 
¢drv_£q_cÚÃù


	)

203 
	#¢d_£q_ev_nÙe
 
¢drv_£q_ev_nÙe


	)

204 
	#¢d_£q_ev_ù¾
 
¢drv_£q_ev_ù¾


	)

205 
	#¢d_£q_ev_¿w8
 
¢drv_£q_ev_¿w8


	)

206 
	#¢d_£q_ev_¿w32
 
¢drv_£q_ev_¿w32


	)

207 
	#¢d_£q_ev_ext
 
¢drv_£q_ev_ext


	)

208 
	#¢d_£q_»suÉ
 
¢drv_£q_»suÉ


	)

209 
	#¢d_£q_queue_skew
 
¢drv_£q_queue_skew


	)

210 
	#¢d_£q_ev_queue_cÚŒŞ
 
¢drv_£q_ev_queue_cÚŒŞ


	)

211 
	#¢d_£q_ş›Á_t
 
¢drv_£q_ş›Á_t


	)

212 
	#¢d_£q_ş›Á_ty³_t
 
¢drv_£q_ş›Á_ty³_t


	)

214 
	~<sound/a£qu’ûr.h
>

217 #undeà
¢d_£q_ş›Á_t


218 #undeà
¢d_£q_ş›Á_ty³_t


220 
	~"£qmid.h
"

221 
	~"£q_midi_ev’t.h
"

222 
	~"li¡.h
"

224 
	s_¢d_async_hªdËr
 {

226 
	mSND_ASYNC_HANDLER_GENERIC
,

227 
	mSND_ASYNC_HANDLER_CTL
,

228 
	mSND_ASYNC_HANDLER_PCM
,

229 
	mSND_ASYNC_HANDLER_TIMER
,

230 } 
	mty³
;

231 
	mfd
;

233 
¢d_ùl_t
 *
	mùl
;

234 
¢d_pcm_t
 *
	mpcm
;

235 
¢d_tim”_t
 *
	mtim”
;

236 } 
	mu
;

237 
¢d_async_ÿÎback_t
 
	mÿÎback
;

238 *
	m´iv©e_d©a
;

239 
li¡_h—d
 
	mgli¡
;

240 
li¡_h—d
 
	mhli¡
;

243 
	e_¢d_£t_mode
 {

244 
	mSND_CHANGE
,

245 
	mSND_TRY
,

246 
	mSND_TEST
,

247 } 
	t¢d_£t_mode_t
;

249 
size_t
 
·ge_®ign
(size_ˆ
size
);

250 
size_t
 
·ge_size
();

251 
size_t
 
·ge_±r
(size_ˆ
objeù_off£t
, size_ˆ
objeù_size
, size_ˆ*
off£t
, size_ˆ*
mm­_off£t
);

253 
	#§ã_¡¹Şl_ba£
 
_¢d_§ã_¡¹Şl_ba£


	)

254 
_¢d_§ã_¡¹Şl_ba£
(cÚ¡ *
¡r
, *
v®
, 
ba£
);

255 
šlše
 
	$§ã_¡¹Şl
(cÚ¡ *
¡r
, *
v®
è{  
	`§ã_¡¹Şl_ba£
(¡r, v®, 0); 
	}
}

256 
	#§ã_¡¹Ş_ba£
 
_¢d_§ã_¡¹Ş_ba£


	)

257 
_¢d_§ã_¡¹Ş_ba£
(cÚ¡ *
¡r
, *
v®
, 
ba£
);

258 
šlše
 
	$§ã_¡¹Ş
(cÚ¡ *
¡r
, *
v®
è{  
	`§ã_¡¹Ş_ba£
(¡r, v®, 0); 
	}
}

259 
	#§ã_¡¹od
 
_¢d_§ã_¡¹od


	)

260 
_¢d_§ã_¡¹od
(cÚ¡ *
¡r
, *
v®
);

262 
¢d_£nd_fd
(
sock
, *
d©a
, 
size_t
 
Ën
, 
fd
);

263 
¢d_»ûive_fd
(
sock
, *
d©a
, 
size_t
 
Ën
, *
fd
);

264 
size_t
 
¢d_¡¾ıy
(*
d¡
, cÚ¡ *
¤c
, size_ˆ
size
);

269 #iâdeà
NDEBUG


270 
	#CHECK_SANITY
(
x
è
	)
x

271 
¢d_lib_”rÜ_hªdËr_t
 
¢d_”r_msg
;

272 
	#SNDMSG
(
¬gs
...è
	`¢d_”r_msg
(
__FILE__
, 
__LINE__
, 
__func__
, 0, ##¬gs)

	)

273 
	#SYSMSG
(
¬gs
...è
	`¢d_”r_msg
(
__FILE__
, 
__LINE__
, 
__func__
, 
”ºo
, ##¬gs)

	)

275 
	#CHECK_SANITY
(
x
è0

	)

276 
	#SNDMSG
(
¬gs
...è

	)

277 
	#SYSMSG
(
¬gs
...è

	)

282 
	#HAVE_GNU_LD


	)

283 
	#HAVE_ELF


	)

284 
	#HAVE_ASM_PREVIOUS_DIRECTIVE


	)

291 
	#ASM_NAME
(
Çme
è
__SYMBOL_PREFIX
 
	)
name

293 #ifdeà
HAVE_GNU_LD


294 #ifdeà
HAVE_ELF


297 #ifdeà
HAVE_ASM_PREVIOUS_DIRECTIVE


298 
	#__make_£ùiÚ_uÇÎoÿ‹d
(
£ùiÚ_¡ršg
) \

299 
	`asm
 (".£ùiÚ " 
£ùiÚ_¡ršg
 "\n\t.´evious");

	)

300 #–ià
defšed
 
HAVE_ASM_POPSECTION_DIRECTIVE


301 
	#__make_£ùiÚ_uÇÎoÿ‹d
(
£ùiÚ_¡ršg
) \

302 
	`asm
 (".push£ùiÚ " 
£ùiÚ_¡ršg
 "\n\t.pİ£ùiÚ");

	)

304 
	#__make_£ùiÚ_uÇÎoÿ‹d
(
£ùiÚ_¡ršg
)

	)

309 #ifdeà
HAVE_SECTION_QUOTES


310 
	#lšk_w¬nšg
(
symbŞ
, 
msg
) \

311 
	`__make_£ùiÚ_uÇÎoÿ‹d
 (".gnu.w¬nšg." 
	`ASM_NAME
(#symbol)) \

312 cÚ¡ 
__evoke_lšk_w¬nšg_
##
symbŞ
[] \

313 
	`__©Œibu‹__
 ((
	`£ùiÚ
 (".gnu.w¬nšg." 
	`ASM_NAME
(#symbŞè"\"\n\t#\""))èğ
msg
;

	)

315 
	#lšk_w¬nšg
(
symbŞ
, 
msg
) \

316 
	`__make_£ùiÚ_uÇÎoÿ‹d
 (".gnu.w¬nšg." 
	`ASM_NAME
(#symbol)) \

317 cÚ¡ 
__evoke_lšk_w¬nšg_
##
symbŞ
[] \

318 
	`__©Œibu‹__
 ((
	`£ùiÚ
 (".gnu.w¬nšg." 
	`ASM_NAME
(#symbŞè"\n\t#"))èğ
msg
;

	)

321 
	#lšk_w¬nšg
(
symbŞ
, 
msg
) \

322 
	`asm
 (".¡ab \"" 
msg
 "\",30,0,0,0\n\t" \

323 ".¡ab \"" 
	`ASM_NAME
(#symbŞè"\",1,0,0,0\n");

	)

327 
	#lšk_w¬nšg
(
symbŞ
, 
msg
)

	)

330 
šlše
 
	$¢d_İ’_deviû
(cÚ¡ *
f’ame
, 
fmode
)

332 
fd
;

334 #ifdeà
O_CLOEXEC


335 
fmode
 |ğ
O_CLOEXEC
;

337 
fd
 = 
	`İ’
(
f’ame
, 
fmode
);

340 #ifdeà
SUPPORT_RESMGR


341 ià(
fd
 < 0) {

342 ià(
”ºo
 =ğ
EAGAIN
 ||ƒ¼nØ=ğ
EBUSY
)

343  
fd
;

344 ià(! 
	`acûss
(
f’ame
, 
F_OK
))

345 
fd
 = 
	`rsm_İ’_deviû
(
f’ame
, 
fmode
);

348 #iâdeà
O_CLOEXEC


349 ià(
fd
 >= 0)

350 
	`fú
(
fd
, 
F_SETFD
, 
FD_CLOEXEC
);

352  
fd
;

353 
	}
}

356 
	#¢d_dlobj_ÿche_g‘
 \

357 
¢d1_dlobj_ÿche_g‘


	)

358 
	#¢d_dlobj_ÿche_g‘2
 \

359 
¢d1_dlobj_ÿche_g‘2


	)

360 
	#¢d_dlobj_ÿche_put
 \

361 
¢d1_dlobj_ÿche_put


	)

362 
	#¢d_dlobj_ÿche_ş—nup
 \

363 
¢d1_dlobj_ÿche_ş—nup


	)

364 
	#¢d_cÚfig_£t_hİ
 \

365 
¢d1_cÚfig_£t_hİ


	)

366 
	#¢d_cÚfig_check_hİ
 \

367 
¢d1_cÚfig_check_hİ


	)

368 
	#¢d_cÚfig_£¬ch_®Ÿs_hooks
 \

369 
¢d1_cÚfig_£¬ch_®Ÿs_hooks


	)

372 *
¢d_dlobj_ÿche_g‘
(cÚ¡ *
lib
, cÚ¡ *
Çme
, cÚ¡ *
v”siÚ
, 
v”bo£
);

373 *
¢d_dlobj_ÿche_g‘2
(cÚ¡ *
lib
, cÚ¡ *
Çme
, cÚ¡ *
v”siÚ
, 
v”bo£
);

374 
¢d_dlobj_ÿche_put
(*
İ’_func
);

375 
¢d_dlobj_ÿche_ş—nup
();

378 
¢d_cÚfig_£t_hİ
(
¢d_cÚfig_t
 *
cÚf
, 
hİ
);

379 
¢d_cÚfig_check_hİ
(
¢d_cÚfig_t
 *
cÚf
);

380 
	#SND_CONF_MAX_HOPS
 64

	)

382 
¢d_cÚfig_£¬ch_®Ÿs_hooks
(
¢d_cÚfig_t
 *
cÚfig
,

383 cÚ¡ *
ba£
, cÚ¡ *
key
,

384 
¢d_cÚfig_t
 **
»suÉ
);

386 
_¢d_cÚf_g’”ic_id
(cÚ¡ *
id
);

388 
_¢d_cÚfig_lßd_w™h_šşude
(
¢d_cÚfig_t
 *
cÚfig
, 
¢d_šput_t
 *
š
,

389 
ov”ride
, cÚ¡ * cÚ¡ *
deçuÉ_šşude_·th
);

392 
	#ARRAY_SIZE
(
x
è((xè/ (x[0]))

	)

394 
	#cÚš”_of
(
±r
, 
ty³
, 
memb”
) ({ \

395 cÚ¡ 
	`ty³of
Ğ((
ty³
 *)0)->
memb”
 ) *
__m±r
 = (
±r
); \

396 (
ty³
 *)Ğ(*)
__m±r
 - 
	`off£tof
Ñy³,
memb”
è);})

	)

398 #ifdeà
INTERNAL


399 *
	$INTERNAL
(
¢d_dlİ’
)(cÚ¡ *
Çme
, 
mode
, *
”rbuf
, 
size_t
 
”rbuæ’
);

402 #ifdeà
BUILD_UCM


404 cÚ¡ *
	`uc_mgr_®ibcfg_by_deviû
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
Çme
);

406 
šlše
 
	$_¢d_is_ucm_deviû
(cÚ¡ *
Çme
)

408  
Çme
 &&‚ame[0] == '_' &&‚ame[1] == 'u' &&‚ame[2] == 'c' &&‚ame[3] == 'm';

409 
	}
}

413 
šlše
 cÚ¡ *
	$uc_mgr_®ibcfg_by_deviû
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
Çme
è{  
NULL
; 
	}
}

414 
šlše
 
	$_¢d_is_ucm_deviû
(cÚ¡ *
Çme
è{  0; 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/mixer.h

28 #iâdeà
__ALSA_MIXER_H


29 
	#__ALSA_MIXER_H


	)

31 #ifdeà
__ılu¥lus


42 
_¢d_mix”
 
	t¢d_mix”_t
;

44 
_¢d_mix”_şass
 
	t¢d_mix”_şass_t
;

46 
_¢d_mix”_–em
 
	t¢d_mix”_–em_t
;

55 (*
¢d_mix”_ÿÎback_t
)(
	t¢d_mix”_t
 *
	tùl
,

56 
	tmask
,

57 
	t¢d_mix”_–em_t
 *
	t–em
);

65 (*
¢d_mix”_–em_ÿÎback_t
)(
	t¢d_mix”_–em_t
 *
	t–em
,

66 
	tmask
);

74 (*
¢d_mix”_com·»_t
)(cÚ¡ 
	t¢d_mix”_–em_t
 *
	te1
,

75 cÚ¡ 
	t¢d_mix”_–em_t
 *
	te2
);

85 (*
¢d_mix”_ev’t_t
)(
	t¢d_mix”_şass_t
 *
	tşass_
, 
	tmask
,

86 
	t¢d_hùl_–em_t
 *
	th–em
, 
	t¢d_mix”_–em_t
 *
	tm–em
);

90 
	e_¢d_mix”_–em_ty³
 {

92 
SND_MIXER_ELEM_SIMPLE
,

93 
SND_MIXER_ELEM_LAST
 = 
SND_MIXER_ELEM_SIMPLE


94 } 
	t¢d_mix”_–em_ty³_t
;

96 
¢d_mix”_İ’
(
¢d_mix”_t
 **
mix”
, 
mode
);

97 
¢d_mix”_şo£
(
¢d_mix”_t
 *
mix”
);

98 
¢d_mix”_–em_t
 *
¢d_mix”_fœ¡_–em
(
¢d_mix”_t
 *
mix”
);

99 
¢d_mix”_–em_t
 *
¢d_mix”_Ï¡_–em
(
¢d_mix”_t
 *
mix”
);

100 
¢d_mix”_hªdË_ev’ts
(
¢d_mix”_t
 *
mix”
);

101 
¢d_mix”_©ch
(
¢d_mix”_t
 *
mix”
, cÚ¡ *
Çme
);

102 
¢d_mix”_©ch_hùl
(
¢d_mix”_t
 *
mix”
, 
¢d_hùl_t
 *
hùl
);

103 
¢d_mix”_d‘ach
(
¢d_mix”_t
 *
mix”
, cÚ¡ *
Çme
);

104 
¢d_mix”_d‘ach_hùl
(
¢d_mix”_t
 *
mix”
, 
¢d_hùl_t
 *
hùl
);

105 
¢d_mix”_g‘_hùl
(
¢d_mix”_t
 *
mix”
, cÚ¡ *
Çme
, 
¢d_hùl_t
 **
hùl
);

106 
¢d_mix”_pŞl_desütÜs_couÁ
(
¢d_mix”_t
 *
mix”
);

107 
¢d_mix”_pŞl_desütÜs
(
¢d_mix”_t
 *
mix”
, 
pŞlfd
 *
pfds
, 
¥aû
);

108 
¢d_mix”_pŞl_desütÜs_»v’ts
(
¢d_mix”_t
 *
mix”
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
);

109 
¢d_mix”_lßd
(
¢d_mix”_t
 *
mix”
);

110 
¢d_mix”_ä“
(
¢d_mix”_t
 *
mix”
);

111 
¢d_mix”_wa™
(
¢d_mix”_t
 *
mix”
, 
timeout
);

112 
¢d_mix”_£t_com·»
(
¢d_mix”_t
 *
mix”
, 
¢d_mix”_com·»_t
 
msÜt
);

113 
¢d_mix”_£t_ÿÎback
(
¢d_mix”_t
 *
obj
, 
¢d_mix”_ÿÎback_t
 
v®
);

114 * 
¢d_mix”_g‘_ÿÎback_´iv©e
(cÚ¡ 
¢d_mix”_t
 *
obj
);

115 
¢d_mix”_£t_ÿÎback_´iv©e
(
¢d_mix”_t
 *
obj
, * 
v®
);

116 
¢d_mix”_g‘_couÁ
(cÚ¡ 
¢d_mix”_t
 *
obj
);

117 
¢d_mix”_şass_uÄegi¡”
(
¢d_mix”_şass_t
 *
şss
);

119 
¢d_mix”_–em_t
 *
¢d_mix”_–em_Ãxt
(¢d_mix”_–em_ˆ*
–em
);

120 
¢d_mix”_–em_t
 *
¢d_mix”_–em_´ev
(¢d_mix”_–em_ˆ*
–em
);

121 
¢d_mix”_–em_£t_ÿÎback
(
¢d_mix”_–em_t
 *
obj
, 
¢d_mix”_–em_ÿÎback_t
 
v®
);

122 * 
¢d_mix”_–em_g‘_ÿÎback_´iv©e
(cÚ¡ 
¢d_mix”_–em_t
 *
obj
);

123 
¢d_mix”_–em_£t_ÿÎback_´iv©e
(
¢d_mix”_–em_t
 *
obj
, * 
v®
);

124 
¢d_mix”_–em_ty³_t
 
¢d_mix”_–em_g‘_ty³
(cÚ¡ 
¢d_mix”_–em_t
 *
obj
);

126 
¢d_mix”_şass_»gi¡”
(
¢d_mix”_şass_t
 *
şass_
, 
¢d_mix”_t
 *
mix”
);

127 
¢d_mix”_–em_Ãw
(
¢d_mix”_–em_t
 **
–em
,

128 
¢d_mix”_–em_ty³_t
 
ty³
,

129 
com·»_weight
,

130 *
´iv©e_d©a
,

131 (*
´iv©e_ä“
)(
¢d_mix”_–em_t
 *
–em
));

132 
¢d_mix”_–em_add
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_şass_t
 *
şass_
);

133 
¢d_mix”_–em_»move
(
¢d_mix”_–em_t
 *
–em
);

134 
¢d_mix”_–em_ä“
(
¢d_mix”_–em_t
 *
–em
);

135 
¢d_mix”_–em_šfo
(
¢d_mix”_–em_t
 *
–em
);

136 
¢d_mix”_–em_v®ue
(
¢d_mix”_–em_t
 *
–em
);

137 
¢d_mix”_–em_©ch
(
¢d_mix”_–em_t
 *
m–em
, 
¢d_hùl_–em_t
 *
h–em
);

138 
¢d_mix”_–em_d‘ach
(
¢d_mix”_–em_t
 *
m–em
, 
¢d_hùl_–em_t
 *
h–em
);

139 
¢d_mix”_–em_em±y
(
¢d_mix”_–em_t
 *
m–em
);

140 *
¢d_mix”_–em_g‘_´iv©e
(cÚ¡ 
¢d_mix”_–em_t
 *
m–em
);

142 
size_t
 
¢d_mix”_şass_sizeof
();

147 
	#¢d_mix”_şass_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_mix”_şass
)

	)

148 
¢d_mix”_şass_m®loc
(
¢d_mix”_şass_t
 **
±r
);

149 
¢d_mix”_şass_ä“
(
¢d_mix”_şass_t
 *
obj
);

150 
¢d_mix”_şass_cİy
(
¢d_mix”_şass_t
 *
d¡
, cÚ¡ snd_mix”_şass_ˆ*
¤c
);

151 
¢d_mix”_t
 *
¢d_mix”_şass_g‘_mix”
(cÚ¡ 
¢d_mix”_şass_t
 *
şass_
);

152 
¢d_mix”_ev’t_t
 
¢d_mix”_şass_g‘_ev’t
(cÚ¡ 
¢d_mix”_şass_t
 *
şass_
);

153 *
¢d_mix”_şass_g‘_´iv©e
(cÚ¡ 
¢d_mix”_şass_t
 *
şass_
);

154 
¢d_mix”_com·»_t
 
¢d_mix”_şass_g‘_com·»
(cÚ¡ 
¢d_mix”_şass_t
 *
şass_
);

155 
¢d_mix”_şass_£t_ev’t
(
¢d_mix”_şass_t
 *
şass_
, 
¢d_mix”_ev’t_t
 
ev’t
);

156 
¢d_mix”_şass_£t_´iv©e
(
¢d_mix”_şass_t
 *
şass_
, *
´iv©e_d©a
);

157 
¢d_mix”_şass_£t_´iv©e_ä“
(
¢d_mix”_şass_t
 *
şass_
, (*
´iv©e_ä“
)(snd_mixer_class_t *));

158 
¢d_mix”_şass_£t_com·»
(
¢d_mix”_şass_t
 *
şass_
, 
¢d_mix”_com·»_t
 
com·»
);

170 
	e_¢d_mix”_£Ëm_chªÃl_id
 {

172 
SND_MIXER_SCHN_UNKNOWN
 = -1,

174 
SND_MIXER_SCHN_FRONT_LEFT
 = 0,

176 
SND_MIXER_SCHN_FRONT_RIGHT
,

178 
SND_MIXER_SCHN_REAR_LEFT
,

180 
SND_MIXER_SCHN_REAR_RIGHT
,

182 
SND_MIXER_SCHN_FRONT_CENTER
,

184 
SND_MIXER_SCHN_WOOFER
,

186 
SND_MIXER_SCHN_SIDE_LEFT
,

188 
SND_MIXER_SCHN_SIDE_RIGHT
,

190 
SND_MIXER_SCHN_REAR_CENTER
,

191 
SND_MIXER_SCHN_LAST
 = 31,

193 
SND_MIXER_SCHN_MONO
 = 
SND_MIXER_SCHN_FRONT_LEFT


194 } 
	t¢d_mix”_£Ëm_chªÃl_id_t
;

197 
	e¢d_mix”_£Ëm_»gİt_ab¡¿ù
 {

199 
SND_MIXER_SABSTRACT_NONE
 = 0,

201 
SND_MIXER_SABSTRACT_BASIC
,

205 
	s¢d_mix”_£Ëm_»gİt
 {

207 
v”
;

209 
¢d_mix”_£Ëm_»gİt_ab¡¿ù
 
ab¡¿ù
;

211 cÚ¡ *
deviû
;

213 
¢d_pcm_t
 *
¶ayback_pcm
;

215 
¢d_pcm_t
 *
ÿ±u»_pcm
;

219 
_¢d_mix”_£Ëm_id
 
	t¢d_mix”_£Ëm_id_t
;

221 cÚ¡ *
¢d_mix”_£Ëm_chªÃl_Çme
(
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
);

223 
¢d_mix”_£Ëm_»gi¡”
(
¢d_mix”_t
 *
mix”
,

224 
¢d_mix”_£Ëm_»gİt
 *
İtiÚs
,

225 
¢d_mix”_şass_t
 **
şas¥
);

226 
¢d_mix”_£Ëm_g‘_id
(
¢d_mix”_–em_t
 *
–em’t
,

227 
¢d_mix”_£Ëm_id_t
 *
id
);

228 cÚ¡ *
¢d_mix”_£Ëm_g‘_Çme
(
¢d_mix”_–em_t
 *
–em
);

229 
¢d_mix”_£Ëm_g‘_šdex
(
¢d_mix”_–em_t
 *
–em
);

230 
¢d_mix”_–em_t
 *
¢d_mix”_fšd_£Ëm
(
¢d_mix”_t
 *
mix”
,

231 cÚ¡ 
¢d_mix”_£Ëm_id_t
 *
id
);

233 
¢d_mix”_£Ëm_is_aùive
(
¢d_mix”_–em_t
 *
–em
);

234 
¢d_mix”_£Ëm_is_¶ayback_mÚo
(
¢d_mix”_–em_t
 *
–em
);

235 
¢d_mix”_£Ëm_has_¶ayback_chªÃl
(
¢d_mix”_–em_t
 *
obj
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
);

236 
¢d_mix”_£Ëm_is_ÿ±u»_mÚo
(
¢d_mix”_–em_t
 *
–em
);

237 
¢d_mix”_£Ëm_has_ÿ±u»_chªÃl
(
¢d_mix”_–em_t
 *
obj
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
);

238 
¢d_mix”_£Ëm_g‘_ÿ±u»_group
(
¢d_mix”_–em_t
 *
–em
);

239 
¢d_mix”_£Ëm_has_commÚ_vŞume
(
¢d_mix”_–em_t
 *
–em
);

240 
¢d_mix”_£Ëm_has_¶ayback_vŞume
(
¢d_mix”_–em_t
 *
–em
);

241 
¢d_mix”_£Ëm_has_¶ayback_vŞume_jošed
(
¢d_mix”_–em_t
 *
–em
);

242 
¢d_mix”_£Ëm_has_ÿ±u»_vŞume
(
¢d_mix”_–em_t
 *
–em
);

243 
¢d_mix”_£Ëm_has_ÿ±u»_vŞume_jošed
(
¢d_mix”_–em_t
 *
–em
);

244 
¢d_mix”_£Ëm_has_commÚ_sw™ch
(
¢d_mix”_–em_t
 *
–em
);

245 
¢d_mix”_£Ëm_has_¶ayback_sw™ch
(
¢d_mix”_–em_t
 *
–em
);

246 
¢d_mix”_£Ëm_has_¶ayback_sw™ch_jošed
(
¢d_mix”_–em_t
 *
–em
);

247 
¢d_mix”_£Ëm_has_ÿ±u»_sw™ch
(
¢d_mix”_–em_t
 *
–em
);

248 
¢d_mix”_£Ëm_has_ÿ±u»_sw™ch_jošed
(
¢d_mix”_–em_t
 *
–em
);

249 
¢d_mix”_£Ëm_has_ÿ±u»_sw™ch_exşusive
(
¢d_mix”_–em_t
 *
–em
);

251 
¢d_mix”_£Ëm_ask_¶ayback_vŞ_dB
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
, *
dBv®ue
);

252 
¢d_mix”_£Ëm_ask_ÿ±u»_vŞ_dB
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
, *
dBv®ue
);

253 
¢d_mix”_£Ëm_ask_¶ayback_dB_vŞ
(
¢d_mix”_–em_t
 *
–em
, 
dBv®ue
, 
dœ
, *
v®ue
);

254 
¢d_mix”_£Ëm_ask_ÿ±u»_dB_vŞ
(
¢d_mix”_–em_t
 *
–em
, 
dBv®ue
, 
dœ
, *
v®ue
);

255 
¢d_mix”_£Ëm_g‘_¶ayback_vŞume
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
);

256 
¢d_mix”_£Ëm_g‘_ÿ±u»_vŞume
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
);

257 
¢d_mix”_£Ëm_g‘_¶ayback_dB
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
);

258 
¢d_mix”_£Ëm_g‘_ÿ±u»_dB
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
);

259 
¢d_mix”_£Ëm_g‘_¶ayback_sw™ch
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
);

260 
¢d_mix”_£Ëm_g‘_ÿ±u»_sw™ch
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
);

261 
¢d_mix”_£Ëm_£t_¶ayback_vŞume
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
);

262 
¢d_mix”_£Ëm_£t_ÿ±u»_vŞume
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
);

263 
¢d_mix”_£Ëm_£t_¶ayback_dB
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
, 
dœ
);

264 
¢d_mix”_£Ëm_£t_ÿ±u»_dB
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
, 
dœ
);

265 
¢d_mix”_£Ëm_£t_¶ayback_vŞume_®l
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
);

266 
¢d_mix”_£Ëm_£t_ÿ±u»_vŞume_®l
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
);

267 
¢d_mix”_£Ëm_£t_¶ayback_dB_®l
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
, 
dœ
);

268 
¢d_mix”_£Ëm_£t_ÿ±u»_dB_®l
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
, 
dœ
);

269 
¢d_mix”_£Ëm_£t_¶ayback_sw™ch
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
);

270 
¢d_mix”_£Ëm_£t_ÿ±u»_sw™ch
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
);

271 
¢d_mix”_£Ëm_£t_¶ayback_sw™ch_®l
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
);

272 
¢d_mix”_£Ëm_£t_ÿ±u»_sw™ch_®l
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
);

273 
¢d_mix”_£Ëm_g‘_¶ayback_vŞume_¿nge
(
¢d_mix”_–em_t
 *
–em
,

274 *
mš
, *
max
);

275 
¢d_mix”_£Ëm_g‘_¶ayback_dB_¿nge
(
¢d_mix”_–em_t
 *
–em
,

276 *
mš
, *
max
);

277 
¢d_mix”_£Ëm_£t_¶ayback_vŞume_¿nge
(
¢d_mix”_–em_t
 *
–em
,

278 
mš
, 
max
);

279 
¢d_mix”_£Ëm_g‘_ÿ±u»_vŞume_¿nge
(
¢d_mix”_–em_t
 *
–em
,

280 *
mš
, *
max
);

281 
¢d_mix”_£Ëm_g‘_ÿ±u»_dB_¿nge
(
¢d_mix”_–em_t
 *
–em
,

282 *
mš
, *
max
);

283 
¢d_mix”_£Ëm_£t_ÿ±u»_vŞume_¿nge
(
¢d_mix”_–em_t
 *
–em
,

284 
mš
, 
max
);

286 
¢d_mix”_£Ëm_is_’um”©ed
(
¢d_mix”_–em_t
 *
–em
);

287 
¢d_mix”_£Ëm_is_’um_¶ayback
(
¢d_mix”_–em_t
 *
–em
);

288 
¢d_mix”_£Ëm_is_’um_ÿ±u»
(
¢d_mix”_–em_t
 *
–em
);

289 
¢d_mix”_£Ëm_g‘_’um_™ems
(
¢d_mix”_–em_t
 *
–em
);

290 
¢d_mix”_£Ëm_g‘_’um_™em_Çme
(
¢d_mix”_–em_t
 *
–em
, 
idx
, 
size_t
 
maxËn
, *
¡r
);

291 
¢d_mix”_£Ëm_g‘_’um_™em
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
idxp
);

292 
¢d_mix”_£Ëm_£t_’um_™em
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
idx
);

294 
size_t
 
¢d_mix”_£Ëm_id_sizeof
();

299 
	#¢d_mix”_£Ëm_id_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_mix”_£Ëm_id
)

	)

300 
¢d_mix”_£Ëm_id_m®loc
(
¢d_mix”_£Ëm_id_t
 **
±r
);

301 
¢d_mix”_£Ëm_id_ä“
(
¢d_mix”_£Ëm_id_t
 *
obj
);

302 
¢d_mix”_£Ëm_id_cİy
(
¢d_mix”_£Ëm_id_t
 *
d¡
, cÚ¡ snd_mix”_£Ëm_id_ˆ*
¤c
);

303 cÚ¡ *
¢d_mix”_£Ëm_id_g‘_Çme
(cÚ¡ 
¢d_mix”_£Ëm_id_t
 *
obj
);

304 
¢d_mix”_£Ëm_id_g‘_šdex
(cÚ¡ 
¢d_mix”_£Ëm_id_t
 *
obj
);

305 
¢d_mix”_£Ëm_id_£t_Çme
(
¢d_mix”_£Ëm_id_t
 *
obj
, cÚ¡ *
v®
);

306 
¢d_mix”_£Ëm_id_£t_šdex
(
¢d_mix”_£Ëm_id_t
 *
obj
, 
v®
);

307 
¢d_mix”_£Ëm_id_·r£
(
¢d_mix”_£Ëm_id_t
 *
d¡
, cÚ¡ *
¡r
);

313 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/mixer_abst.h

26 #iâdeà
__ALSA_MIXER_ABST_H


27 
	#__ALSA_MIXER_ABST_H


	)

29 #ifdeà
__ılu¥lus


39 
	#SM_PLAY
 0

	)

40 
	#SM_CAPT
 1

	)

42 
	#SM_CAP_GVOLUME
 (1<<1)

	)

43 
	#SM_CAP_GSWITCH
 (1<<2)

	)

44 
	#SM_CAP_PVOLUME
 (1<<3)

	)

45 
	#SM_CAP_PVOLUME_JOIN
 (1<<4)

	)

46 
	#SM_CAP_PSWITCH
 (1<<5)

	)

47 
	#SM_CAP_PSWITCH_JOIN
 (1<<6)

	)

48 
	#SM_CAP_CVOLUME
 (1<<7)

	)

49 
	#SM_CAP_CVOLUME_JOIN
 (1<<8)

	)

50 
	#SM_CAP_CSWITCH
 (1<<9)

	)

51 
	#SM_CAP_CSWITCH_JOIN
 (1<<10)

	)

52 
	#SM_CAP_CSWITCH_EXCL
 (1<<11)

	)

53 
	#SM_CAP_PENUM
 (1<<12)

	)

54 
	#SM_CAP_CENUM
 (1<<13)

	)

57 
	#SM_OPS_IS_ACTIVE
 0

	)

58 
	#SM_OPS_IS_MONO
 1

	)

59 
	#SM_OPS_IS_CHANNEL
 2

	)

60 
	#SM_OPS_IS_ENUMERATED
 3

	)

61 
	#SM_OPS_IS_ENUMCNT
 4

	)

63 
	#sm_£Ëm
(
x
è((
sm_£Ëm_t
 *)((x)->
´iv©e_d©a
))

	)

64 
	#sm_£Ëm_İs
(
x
è((
sm_£Ëm_t
 *)((x)->
´iv©e_d©a
))->
İs


	)

66 
	s_sm_£Ëm
 {

67 
¢d_mix”_£Ëm_id_t
 *
id
;

68 
sm_–em_İs
 *
İs
;

69 
ÿps
;

70 
ÿ±u»_group
;

71 } 
	tsm_£Ëm_t
;

73 
	s_sm_şass_basic
 {

74 *
deviû
;

75 
¢d_ùl_t
 *
ùl
;

76 
¢d_hùl_t
 *
hùl
;

77 
¢d_ùl_ÿrd_šfo_t
 *
šfo
;

78 } 
	tsm_şass_basic_t
;

80 
	ssm_–em_İs
 {

81 (*
is
)(
¢d_mix”_–em_t
 *
–em
, 
dœ
, 
cmd
, 
v®
);

82 (*
g‘_¿nge
)(
¢d_mix”_–em_t
 *
–em
, 
dœ
, *
mš
, *
max
);

83 (*
£t_¿nge
)(
¢d_mix”_–em_t
 *
–em
, 
dœ
, 
mš
, 
max
);

84 (*
g‘_dB_¿nge
)(
¢d_mix”_–em_t
 *
–em
, 
dœ
, *
mš
, *
max
);

85 (*
ask_vŞ_dB
)(
¢d_mix”_–em_t
 *
–em
, 
dœ
, 
v®ue
, *
dbV®ue
);

86 (*
ask_dB_vŞ
)(
¢d_mix”_–em_t
 *
–em
, 
dœ
, 
dbV®ue
, *
v®ue
, 
xdœ
);

87 (*
g‘_vŞume
)(
¢d_mix”_–em_t
 *
–em
, 
dœ
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
);

88 (*
g‘_dB
)(
¢d_mix”_–em_t
 *
–em
, 
dœ
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
);

89 (*
£t_vŞume
)(
¢d_mix”_–em_t
 *
–em
, 
dœ
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
);

90 (*
£t_dB
)(
¢d_mix”_–em_t
 *
–em
, 
dœ
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
, 
xdœ
);

91 (*
g‘_sw™ch
)(
¢d_mix”_–em_t
 *
–em
, 
dœ
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
);

92 (*
£t_sw™ch
)(
¢d_mix”_–em_t
 *
–em
, 
dœ
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
);

93 (*
’um_™em_Çme
)(
¢d_mix”_–em_t
 *
–em
, 
™em
, 
size_t
 
maxËn
, *
buf
);

94 (*
g‘_’um_™em
)(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
™emp
);

95 (*
£t_’um_™em
)(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
™em
);

98 
¢d_mix”_£Ëm_com·»
(cÚ¡ 
¢d_mix”_–em_t
 *
c1
, cÚ¡ snd_mix”_–em_ˆ*
c2
);

100 
¢d_mix”_sbasic_šfo
(cÚ¡ 
¢d_mix”_şass_t
 *
mix”_şass
, 
sm_şass_basic_t
 *
šfo
);

101 *
¢d_mix”_sbasic_g‘_´iv©e
(cÚ¡ 
¢d_mix”_şass_t
 *
mix”_şass
);

102 
¢d_mix”_sbasic_£t_´iv©e
(cÚ¡ 
¢d_mix”_şass_t
 *
mix”_şass
, *
´iv©e_d©a
);

103 
¢d_mix”_sbasic_£t_´iv©e_ä“
(cÚ¡ 
¢d_mix”_şass_t
 *
mix”_şass
, (*
´iv©e_ä“
)(snd_mixer_class_t *mixer_class));

107 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/output.h

28 #iâdeà
__ALSA_OUTPUT_H


29 
	#__ALSA_OUTPUT_H


	)

31 
	~<¡d¬g.h
>

33 #ifdeà
__ılu¥lus


56 
_¢d_ouut
 
	t¢d_ouut_t
;

59 
	e_¢d_ouut_ty³
 {

61 
SND_OUTPUT_STDIO
,

63 
SND_OUTPUT_BUFFER


64 } 
	t¢d_ouut_ty³_t
;

66 
¢d_ouut_¡dio_İ’
(
¢d_ouut_t
 **
ouu
, cÚ¡ *
fe
, cÚ¡ *
mode
);

67 
¢d_ouut_¡dio_©ch
(
¢d_ouut_t
 **
ouu
, 
FILE
 *
å
, 
_şo£
);

68 
¢d_ouut_bufãr_İ’
(
¢d_ouut_t
 **
ouu
);

69 
size_t
 
¢d_ouut_bufãr_¡ršg
(
¢d_ouut_t
 *
ouut
, **
buf
);

70 
size_t
 
¢d_ouut_bufãr_¡—l
(
¢d_ouut_t
 *
ouut
, **
buf
);

71 
¢d_ouut_şo£
(
¢d_ouut_t
 *
ouut
);

72 
¢d_ouut_´štf
(
¢d_ouut_t
 *
ouut
, cÚ¡ *
fÜm©
, ...)

73 #iâdeà
DOC_HIDDEN


74 
__©Œibu‹__
 ((
fÜm©
 (
´štf
, 2, 3)))

77 
¢d_ouut_v´štf
(
¢d_ouut_t
 *
ouut
, cÚ¡ *
fÜm©
, 
va_li¡
 
¬gs
);

78 
¢d_ouut_puts
(
¢d_ouut_t
 *
ouut
, cÚ¡ *
¡r
);

79 
¢d_ouut_putc
(
¢d_ouut_t
 *
ouut
, 
c
);

80 
¢d_ouut_æush
(
¢d_ouut_t
 *
ouut
);

84 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm.h

29 #iâdeà
__ALSA_PCM_H


30 
	#__ALSA_PCM_H


	)

32 #ifdeà
__ılu¥lus


36 
	~<¡dšt.h
>

45 
	#SND_PCM_DLSYM_VERSION
 
_dlsym_pcm_001


	)

48 
_¢d_pcm_šfo
 
	t¢d_pcm_šfo_t
;

64 
_¢d_pcm_hw_·¿ms
 
	t¢d_pcm_hw_·¿ms_t
;

67 
_¢d_pcm_sw_·¿ms
 
	t¢d_pcm_sw_·¿ms_t
;

69 
_¢d_pcm_¡©us
 
	t¢d_pcm_¡©us_t
;

71 
_¢d_pcm_acûss_mask
 
	t¢d_pcm_acûss_mask_t
;

73 
_¢d_pcm_fÜm©_mask
 
	t¢d_pcm_fÜm©_mask_t
;

75 
_¢d_pcm_subfÜm©_mask
 
	t¢d_pcm_subfÜm©_mask_t
;

78 
	e_¢d_pcm_şass
 {

81 
SND_PCM_CLASS_GENERIC
 = 0,

83 
SND_PCM_CLASS_MULTI
,

85 
SND_PCM_CLASS_MODEM
,

87 
SND_PCM_CLASS_DIGITIZER
,

88 
SND_PCM_CLASS_LAST
 = 
SND_PCM_CLASS_DIGITIZER


89 } 
	t¢d_pcm_şass_t
;

92 
	e_¢d_pcm_subşass
 {

94 
SND_PCM_SUBCLASS_GENERIC_MIX
 = 0,

96 
SND_PCM_SUBCLASS_MULTI_MIX
,

97 
SND_PCM_SUBCLASS_LAST
 = 
SND_PCM_SUBCLASS_MULTI_MIX


98 } 
	t¢d_pcm_subşass_t
;

101 
	e_¢d_pcm_¡»am
 {

103 
SND_PCM_STREAM_PLAYBACK
 = 0,

105 
SND_PCM_STREAM_CAPTURE
,

106 
SND_PCM_STREAM_LAST
 = 
SND_PCM_STREAM_CAPTURE


107 } 
	t¢d_pcm_¡»am_t
;

110 
	e_¢d_pcm_acûss
 {

112 
SND_PCM_ACCESS_MMAP_INTERLEAVED
 = 0,

114 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
,

116 
SND_PCM_ACCESS_MMAP_COMPLEX
,

118 
SND_PCM_ACCESS_RW_INTERLEAVED
,

120 
SND_PCM_ACCESS_RW_NONINTERLEAVED
,

121 
SND_PCM_ACCESS_LAST
 = 
SND_PCM_ACCESS_RW_NONINTERLEAVED


122 } 
	t¢d_pcm_acûss_t
;

125 
	e_¢d_pcm_fÜm©
 {

127 
SND_PCM_FORMAT_UNKNOWN
 = -1,

129 
SND_PCM_FORMAT_S8
 = 0,

131 
SND_PCM_FORMAT_U8
,

133 
SND_PCM_FORMAT_S16_LE
,

135 
SND_PCM_FORMAT_S16_BE
,

137 
SND_PCM_FORMAT_U16_LE
,

139 
SND_PCM_FORMAT_U16_BE
,

141 
SND_PCM_FORMAT_S24_LE
,

143 
SND_PCM_FORMAT_S24_BE
,

145 
SND_PCM_FORMAT_U24_LE
,

147 
SND_PCM_FORMAT_U24_BE
,

149 
SND_PCM_FORMAT_S32_LE
,

151 
SND_PCM_FORMAT_S32_BE
,

153 
SND_PCM_FORMAT_U32_LE
,

155 
SND_PCM_FORMAT_U32_BE
,

157 
SND_PCM_FORMAT_FLOAT_LE
,

159 
SND_PCM_FORMAT_FLOAT_BE
,

161 
SND_PCM_FORMAT_FLOAT64_LE
,

163 
SND_PCM_FORMAT_FLOAT64_BE
,

165 
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
,

167 
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
,

169 
SND_PCM_FORMAT_MU_LAW
,

171 
SND_PCM_FORMAT_A_LAW
,

173 
SND_PCM_FORMAT_IMA_ADPCM
,

175 
SND_PCM_FORMAT_MPEG
,

177 
SND_PCM_FORMAT_GSM
,

179 
SND_PCM_FORMAT_S20_LE
,

181 
SND_PCM_FORMAT_S20_BE
,

183 
SND_PCM_FORMAT_U20_LE
,

185 
SND_PCM_FORMAT_U20_BE
,

187 
SND_PCM_FORMAT_SPECIAL
 = 31,

189 
SND_PCM_FORMAT_S24_3LE
 = 32,

191 
SND_PCM_FORMAT_S24_3BE
,

193 
SND_PCM_FORMAT_U24_3LE
,

195 
SND_PCM_FORMAT_U24_3BE
,

197 
SND_PCM_FORMAT_S20_3LE
,

199 
SND_PCM_FORMAT_S20_3BE
,

201 
SND_PCM_FORMAT_U20_3LE
,

203 
SND_PCM_FORMAT_U20_3BE
,

205 
SND_PCM_FORMAT_S18_3LE
,

207 
SND_PCM_FORMAT_S18_3BE
,

209 
SND_PCM_FORMAT_U18_3LE
,

211 
SND_PCM_FORMAT_U18_3BE
,

213 
SND_PCM_FORMAT_G723_24
,

215 
SND_PCM_FORMAT_G723_24_1B
,

217 
SND_PCM_FORMAT_G723_40
,

219 
SND_PCM_FORMAT_G723_40_1B
,

221 
SND_PCM_FORMAT_DSD_U8
,

223 
SND_PCM_FORMAT_DSD_U16_LE
,

225 
SND_PCM_FORMAT_DSD_U32_LE
,

227 
SND_PCM_FORMAT_DSD_U16_BE
,

229 
SND_PCM_FORMAT_DSD_U32_BE
,

230 
SND_PCM_FORMAT_LAST
 = 
SND_PCM_FORMAT_DSD_U32_BE
,

232 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


234 
SND_PCM_FORMAT_S16
 = 
SND_PCM_FORMAT_S16_LE
,

236 
SND_PCM_FORMAT_U16
 = 
SND_PCM_FORMAT_U16_LE
,

238 
SND_PCM_FORMAT_S24
 = 
SND_PCM_FORMAT_S24_LE
,

240 
SND_PCM_FORMAT_U24
 = 
SND_PCM_FORMAT_U24_LE
,

242 
SND_PCM_FORMAT_S32
 = 
SND_PCM_FORMAT_S32_LE
,

244 
SND_PCM_FORMAT_U32
 = 
SND_PCM_FORMAT_U32_LE
,

246 
SND_PCM_FORMAT_FLOAT
 = 
SND_PCM_FORMAT_FLOAT_LE
,

248 
SND_PCM_FORMAT_FLOAT64
 = 
SND_PCM_FORMAT_FLOAT64_LE
,

250 
SND_PCM_FORMAT_IEC958_SUBFRAME
 = 
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
,

252 
SND_PCM_FORMAT_S20
 = 
SND_PCM_FORMAT_S20_LE
,

254 
SND_PCM_FORMAT_U20
 = 
SND_PCM_FORMAT_U20_LE
,

255 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


257 
SND_PCM_FORMAT_S16
 = 
SND_PCM_FORMAT_S16_BE
,

259 
SND_PCM_FORMAT_U16
 = 
SND_PCM_FORMAT_U16_BE
,

261 
SND_PCM_FORMAT_S24
 = 
SND_PCM_FORMAT_S24_BE
,

263 
SND_PCM_FORMAT_U24
 = 
SND_PCM_FORMAT_U24_BE
,

265 
SND_PCM_FORMAT_S32
 = 
SND_PCM_FORMAT_S32_BE
,

267 
SND_PCM_FORMAT_U32
 = 
SND_PCM_FORMAT_U32_BE
,

269 
SND_PCM_FORMAT_FLOAT
 = 
SND_PCM_FORMAT_FLOAT_BE
,

271 
SND_PCM_FORMAT_FLOAT64
 = 
SND_PCM_FORMAT_FLOAT64_BE
,

273 
SND_PCM_FORMAT_IEC958_SUBFRAME
 = 
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
,

275 
SND_PCM_FORMAT_S20
 = 
SND_PCM_FORMAT_S20_BE
,

277 
SND_PCM_FORMAT_U20
 = 
SND_PCM_FORMAT_U20_BE
,

281 } 
	t¢d_pcm_fÜm©_t
;

284 
	e_¢d_pcm_subfÜm©
 {

286 
SND_PCM_SUBFORMAT_UNKNOWN
 = -1,

288 
SND_PCM_SUBFORMAT_STD
 = 0,

290 
SND_PCM_SUBFORMAT_MSBITS_MAX
 = 1,

292 
SND_PCM_SUBFORMAT_MSBITS_20
 = 2,

294 
SND_PCM_SUBFORMAT_MSBITS_24
 = 3,

295 
SND_PCM_SUBFORMAT_LAST
 = 
SND_PCM_SUBFORMAT_MSBITS_24


296 } 
	t¢d_pcm_subfÜm©_t
;

299 
	e_¢d_pcm_¡©e
 {

301 
SND_PCM_STATE_OPEN
 = 0,

303 
SND_PCM_STATE_SETUP
,

305 
SND_PCM_STATE_PREPARED
,

307 
SND_PCM_STATE_RUNNING
,

309 
SND_PCM_STATE_XRUN
,

311 
SND_PCM_STATE_DRAINING
,

313 
SND_PCM_STATE_PAUSED
,

315 
SND_PCM_STATE_SUSPENDED
,

317 
SND_PCM_STATE_DISCONNECTED
,

318 
SND_PCM_STATE_LAST
 = 
SND_PCM_STATE_DISCONNECTED
,

320 
SND_PCM_STATE_PRIVATE1
 = 1024

321 } 
	t¢d_pcm_¡©e_t
;

324 
	e_¢d_pcm_¡¬t
 {

326 
SND_PCM_START_DATA
 = 0,

328 
SND_PCM_START_EXPLICIT
,

329 
SND_PCM_START_LAST
 = 
SND_PCM_START_EXPLICIT


330 } 
	t¢d_pcm_¡¬t_t
;

333 
	e_¢d_pcm_xrun
 {

335 
SND_PCM_XRUN_NONE
 = 0,

337 
SND_PCM_XRUN_STOP
,

338 
SND_PCM_XRUN_LAST
 = 
SND_PCM_XRUN_STOP


339 } 
	t¢d_pcm_xrun_t
;

342 
	e_¢d_pcm_t¡amp
 {

344 
SND_PCM_TSTAMP_NONE
 = 0,

346 
SND_PCM_TSTAMP_ENABLE
,

350 
SND_PCM_TSTAMP_MMAP
 = 
SND_PCM_TSTAMP_ENABLE
,

351 
SND_PCM_TSTAMP_LAST
 = 
SND_PCM_TSTAMP_ENABLE


352 } 
	t¢d_pcm_t¡amp_t
;

355 
	e_¢d_pcm_t¡amp_ty³
 {

356 
SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY
 = 0,

357 
SND_PCM_TSTAMP_TYPE_MONOTONIC
,

358 
SND_PCM_TSTAMP_TYPE_MONOTONIC_RAW
,

359 
SND_PCM_TSTAMP_TYPE_LAST
 = 
SND_PCM_TSTAMP_TYPE_MONOTONIC_RAW
,

360 } 
	t¢d_pcm_t¡amp_ty³_t
;

363 
	e_¢d_pcm_audio_t¡amp_ty³
 {

368 
SND_PCM_AUDIO_TSTAMP_TYPE_COMPAT
 = 0,

369 
SND_PCM_AUDIO_TSTAMP_TYPE_DEFAULT
 = 1,

370 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK
 = 2,

371 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_ABSOLUTE
 = 3,

372 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_ESTIMATED
 = 4,

373 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_SYNCHRONIZED
 = 5,

374 
SND_PCM_AUDIO_TSTAMP_TYPE_LAST
 = 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_SYNCHRONIZED


375 } 
	t¢d_pcm_audio_t¡amp_ty³_t
;

378 
	s_¢d_pcm_audio_t¡amp_cÚfig
 {

380 
ty³_»que¡ed
:4;

381 
»pÜt_d–ay
:1;

382 } 
	t¢d_pcm_audio_t¡amp_cÚfig_t
;

385 
	s_¢d_pcm_audio_t¡amp_»pÜt
 {

388 
v®id
:1;

389 
aùu®_ty³
:4;

391 
accu¿cy_»pÜt
:1;

392 
accu¿cy
;

393 } 
	t¢d_pcm_audio_t¡amp_»pÜt_t
;

396 
	t¢d_pcm_uäames_t
;

398 
	t¢d_pcm_säames_t
;

401 
	#SND_PCM_NONBLOCK
 0x00000001

	)

403 
	#SND_PCM_ASYNC
 0x00000002

	)

405 
	#SND_PCM_EINTR
 0x00000080

	)

407 
	#SND_PCM_ABORT
 0x00008000

	)

409 
	#SND_PCM_NO_AUTO_RESAMPLE
 0x00010000

	)

411 
	#SND_PCM_NO_AUTO_CHANNELS
 0x00020000

	)

413 
	#SND_PCM_NO_AUTO_FORMAT
 0x00040000

	)

415 
	#SND_PCM_NO_SOFTVOL
 0x00080000

	)

418 
_¢d_pcm
 
	t¢d_pcm_t
;

421 
	e_¢d_pcm_ty³
 {

423 
SND_PCM_TYPE_HW
 = 0,

425 
SND_PCM_TYPE_HOOKS
,

428 
SND_PCM_TYPE_MULTI
,

430 
SND_PCM_TYPE_FILE
,

432 
SND_PCM_TYPE_NULL
,

434 
SND_PCM_TYPE_SHM
,

436 
SND_PCM_TYPE_INET
,

438 
SND_PCM_TYPE_COPY
,

440 
SND_PCM_TYPE_LINEAR
,

442 
SND_PCM_TYPE_ALAW
,

444 
SND_PCM_TYPE_MULAW
,

446 
SND_PCM_TYPE_ADPCM
,

448 
SND_PCM_TYPE_RATE
,

450 
SND_PCM_TYPE_ROUTE
,

452 
SND_PCM_TYPE_PLUG
,

454 
SND_PCM_TYPE_SHARE
,

456 
SND_PCM_TYPE_METER
,

458 
SND_PCM_TYPE_MIX
,

460 
SND_PCM_TYPE_DROUTE
,

462 
SND_PCM_TYPE_LBSERVER
,

464 
SND_PCM_TYPE_LINEAR_FLOAT
,

466 
SND_PCM_TYPE_LADSPA
,

468 
SND_PCM_TYPE_DMIX
,

470 
SND_PCM_TYPE_JACK
,

472 
SND_PCM_TYPE_DSNOOP
,

474 
SND_PCM_TYPE_DSHARE
,

476 
SND_PCM_TYPE_IEC958
,

478 
SND_PCM_TYPE_SOFTVOL
,

480 
SND_PCM_TYPE_IOPLUG
,

482 
SND_PCM_TYPE_EXTPLUG
,

484 
SND_PCM_TYPE_MMAP_EMUL
,

485 
SND_PCM_TYPE_LAST
 = 
SND_PCM_TYPE_MMAP_EMUL


489 
_¢d_pcm_ty³
 
	t¢d_pcm_ty³_t
;

492 
	s_¢d_pcm_chªÃl_¬—
 {

494 *
addr
;

496 
fœ¡
;

498 
¡•
;

499 } 
	t¢d_pcm_chªÃl_¬—_t
;

502 
	u_¢d_pcm_sync_id
 {

504 
id
[16];

506 
id16
[8];

508 
id32
[4];

509 } 
	t¢d_pcm_sync_id_t
;

512 
	#SND_PCM_WAIT_INFINITE
 (-1)

	)

514 
	#SND_PCM_WAIT_IO
 (-10001)

	)

516 
	#SND_PCM_WAIT_DRAIN
 (-10002)

	)

519 
_¢d_pcm_scİe
 
	t¢d_pcm_scİe_t
;

521 
¢d_pcm_İ’
(
¢d_pcm_t
 **
pcm
, cÚ¡ *
Çme
,

522 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

523 
¢d_pcm_İ’_lcÚf
(
¢d_pcm_t
 **
pcm
, cÚ¡ *
Çme
,

524 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
,

525 
¢d_cÚfig_t
 *
lcÚf
);

526 
¢d_pcm_İ’_çÎback
(
¢d_pcm_t
 **
pcm
, 
¢d_cÚfig_t
 *
roÙ
,

527 cÚ¡ *
Çme
, cÚ¡ *
Üig_Çme
,

528 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

530 
¢d_pcm_şo£
(
¢d_pcm_t
 *
pcm
);

531 cÚ¡ *
¢d_pcm_Çme
(
¢d_pcm_t
 *
pcm
);

532 
¢d_pcm_ty³_t
 
¢d_pcm_ty³
(
¢d_pcm_t
 *
pcm
);

533 
¢d_pcm_¡»am_t
 
¢d_pcm_¡»am
(
¢d_pcm_t
 *
pcm
);

534 
¢d_pcm_pŞl_desütÜs_couÁ
(
¢d_pcm_t
 *
pcm
);

535 
¢d_pcm_pŞl_desütÜs
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
¥aû
);

536 
¢d_pcm_pŞl_desütÜs_»v’ts
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
);

537 
¢d_pcm_nÚblock
(
¢d_pcm_t
 *
pcm
, 
nÚblock
);

538 
__šlše__
 
¢d_pcm_abÜt
(
¢d_pcm_t
 *
pcm
è{  
¢d_pcm_nÚblock
(pcm, 2); }

539 
¢d_async_add_pcm_hªdËr
(
¢d_async_hªdËr_t
 **
hªdËr
, 
¢d_pcm_t
 *
pcm
,

540 
¢d_async_ÿÎback_t
 
ÿÎback
, *
´iv©e_d©a
);

541 
¢d_pcm_t
 *
¢d_async_hªdËr_g‘_pcm
(
¢d_async_hªdËr_t
 *
hªdËr
);

542 
¢d_pcm_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_šfo_t
 *
šfo
);

543 
¢d_pcm_hw_·¿ms_cu¼’t
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

544 
¢d_pcm_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

545 
¢d_pcm_hw_ä“
(
¢d_pcm_t
 *
pcm
);

546 
¢d_pcm_sw_·¿ms_cu¼’t
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
);

547 
¢d_pcm_sw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
);

548 
¢d_pcm_´•¬e
(
¢d_pcm_t
 *
pcm
);

549 
¢d_pcm_»£t
(
¢d_pcm_t
 *
pcm
);

550 
¢d_pcm_¡©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©us_t
 *
¡©us
);

551 
¢d_pcm_¡¬t
(
¢d_pcm_t
 *
pcm
);

552 
¢d_pcm_drİ
(
¢d_pcm_t
 *
pcm
);

553 
¢d_pcm_d¿š
(
¢d_pcm_t
 *
pcm
);

554 
¢d_pcm_·u£
(
¢d_pcm_t
 *
pcm
, 
’abË
);

555 
¢d_pcm_¡©e_t
 
¢d_pcm_¡©e
(
¢d_pcm_t
 *
pcm
);

556 
¢d_pcm_hwsync
(
¢d_pcm_t
 *
pcm
);

557 
¢d_pcm_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
);

558 
¢d_pcm_»sume
(
¢d_pcm_t
 *
pcm
);

559 
¢d_pcm_htime¡amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 *
ava
, 
¢d_htime¡amp_t
 *
t¡amp
);

560 
¢d_pcm_säames_t
 
¢d_pcm_ava
(
¢d_pcm_t
 *
pcm
);

561 
¢d_pcm_säames_t
 
¢d_pcm_ava_upd©e
(
¢d_pcm_t
 *
pcm
);

562 
¢d_pcm_ava_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
avap
, snd_pcm_säames_ˆ*
d–ayp
);

563 
¢d_pcm_säames_t
 
¢d_pcm_»wšdabË
(
¢d_pcm_t
 *
pcm
);

564 
¢d_pcm_säames_t
 
¢d_pcm_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
);

565 
¢d_pcm_säames_t
 
¢d_pcm_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
);

566 
¢d_pcm_säames_t
 
¢d_pcm_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
);

567 
¢d_pcm_säames_t
 
¢d_pcm_wr™ei
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
bufãr
, 
¢d_pcm_uäames_t
 
size
);

568 
¢d_pcm_säames_t
 
¢d_pcm_»adi
(
¢d_pcm_t
 *
pcm
, *
bufãr
, 
¢d_pcm_uäames_t
 
size
);

569 
¢d_pcm_säames_t
 
¢d_pcm_wr™’
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
);

570 
¢d_pcm_säames_t
 
¢d_pcm_»adn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
);

571 
¢d_pcm_wa™
(
¢d_pcm_t
 *
pcm
, 
timeout
);

573 
¢d_pcm_lšk
(
¢d_pcm_t
 *
pcm1
, snd_pcm_ˆ*
pcm2
);

574 
¢d_pcm_uÆšk
(
¢d_pcm_t
 *
pcm
);

577 
	#SND_CHMAP_API_VERSION
 ((1 << 16è| (0 << 8è| 1)

	)

580 
	e¢d_pcm_chm­_ty³
 {

581 
SND_CHMAP_TYPE_NONE
 = 0,

582 
SND_CHMAP_TYPE_FIXED
,

583 
SND_CHMAP_TYPE_VAR
,

584 
SND_CHMAP_TYPE_PAIRED
,

585 
SND_CHMAP_TYPE_LAST
 = 
SND_CHMAP_TYPE_PAIRED
,

589 
	e¢d_pcm_chm­_pos™iÚ
 {

590 
SND_CHMAP_UNKNOWN
 = 0,

591 
SND_CHMAP_NA
,

592 
SND_CHMAP_MONO
,

593 
SND_CHMAP_FL
,

594 
SND_CHMAP_FR
,

595 
SND_CHMAP_RL
,

596 
SND_CHMAP_RR
,

597 
SND_CHMAP_FC
,

598 
SND_CHMAP_LFE
,

599 
SND_CHMAP_SL
,

600 
SND_CHMAP_SR
,

601 
SND_CHMAP_RC
,

602 
SND_CHMAP_FLC
,

603 
SND_CHMAP_FRC
,

604 
SND_CHMAP_RLC
,

605 
SND_CHMAP_RRC
,

606 
SND_CHMAP_FLW
,

607 
SND_CHMAP_FRW
,

608 
SND_CHMAP_FLH
,

609 
SND_CHMAP_FCH
,

610 
SND_CHMAP_FRH
,

611 
SND_CHMAP_TC
,

612 
SND_CHMAP_TFL
,

613 
SND_CHMAP_TFR
,

614 
SND_CHMAP_TFC
,

615 
SND_CHMAP_TRL
,

616 
SND_CHMAP_TRR
,

617 
SND_CHMAP_TRC
,

618 
SND_CHMAP_TFLC
,

619 
SND_CHMAP_TFRC
,

620 
SND_CHMAP_TSL
,

621 
SND_CHMAP_TSR
,

622 
SND_CHMAP_LLFE
,

623 
SND_CHMAP_RLFE
,

624 
SND_CHMAP_BC
,

625 
SND_CHMAP_BLC
,

626 
SND_CHMAP_BRC
,

627 
SND_CHMAP_LAST
 = 
SND_CHMAP_BRC
,

631 
	#SND_CHMAP_POSITION_MASK
 0xffff

	)

634 
	#SND_CHMAP_PHASE_INVERSE
 (0x01 << 16)

	)

636 
	#SND_CHMAP_DRIVER_SPEC
 (0x02 << 16)

	)

639 
	s¢d_pcm_chm­
 {

640 
chªÃls
;

641 
pos
[0];

642 } 
	t¢d_pcm_chm­_t
;

645 
	s¢d_pcm_chm­_qu”y
 {

646 
¢d_pcm_chm­_ty³
 
ty³
;

647 
¢d_pcm_chm­_t
 
m­
;

648 } 
	t¢d_pcm_chm­_qu”y_t
;

651 
¢d_pcm_chm­_qu”y_t
 **
¢d_pcm_qu”y_chm­s
(
¢d_pcm_t
 *
pcm
);

652 
¢d_pcm_chm­_qu”y_t
 **
¢d_pcm_qu”y_chm­s_äom_hw
(
ÿrd
, 
dev
,

653 
subdev
,

654 
¢d_pcm_¡»am_t
 
¡»am
);

655 
¢d_pcm_ä“_chm­s
(
¢d_pcm_chm­_qu”y_t
 **
m­s
);

656 
¢d_pcm_chm­_t
 *
¢d_pcm_g‘_chm­
(
¢d_pcm_t
 *
pcm
);

657 
¢d_pcm_£t_chm­
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chm­_t
 *
m­
);

659 cÚ¡ *
¢d_pcm_chm­_ty³_Çme
(
¢d_pcm_chm­_ty³
 
v®
);

660 cÚ¡ *
¢d_pcm_chm­_Çme
(
¢d_pcm_chm­_pos™iÚ
 
v®
);

661 cÚ¡ *
¢d_pcm_chm­_lÚg_Çme
(
¢d_pcm_chm­_pos™iÚ
 
v®
);

662 
¢d_pcm_chm­_´št
(cÚ¡ 
¢d_pcm_chm­_t
 *
m­
, 
size_t
 
maxËn
, *
buf
);

663 
¢d_pcm_chm­_äom_¡ršg
(cÚ¡ *
¡r
);

664 
¢d_pcm_chm­_t
 *
¢d_pcm_chm­_·r£_¡ršg
(cÚ¡ *
¡r
);

673 
¢d_pcm_»cov”
(
¢d_pcm_t
 *
pcm
, 
”r
, 
s’t
);

674 
¢d_pcm_£t_·¿ms
(
¢d_pcm_t
 *
pcm
,

675 
¢d_pcm_fÜm©_t
 
fÜm©
,

676 
¢d_pcm_acûss_t
 
acûss
,

677 
chªÃls
,

678 
¿‹
,

679 
soá_»§m¶e
,

680 
Ï‹ncy
);

681 
¢d_pcm_g‘_·¿ms
(
¢d_pcm_t
 *
pcm
,

682 
¢d_pcm_uäames_t
 *
bufãr_size
,

683 
¢d_pcm_uäames_t
 *
³riod_size
);

694 
size_t
 
¢d_pcm_šfo_sizeof
();

699 
	#¢d_pcm_šfo_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_pcm_šfo
)

	)

700 
¢d_pcm_šfo_m®loc
(
¢d_pcm_šfo_t
 **
±r
);

701 
¢d_pcm_šfo_ä“
(
¢d_pcm_šfo_t
 *
obj
);

702 
¢d_pcm_šfo_cİy
(
¢d_pcm_šfo_t
 *
d¡
, cÚ¡ snd_pcm_šfo_ˆ*
¤c
);

703 
¢d_pcm_šfo_g‘_deviû
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
);

704 
¢d_pcm_šfo_g‘_subdeviû
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
);

705 
¢d_pcm_¡»am_t
 
¢d_pcm_šfo_g‘_¡»am
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
);

706 
¢d_pcm_šfo_g‘_ÿrd
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
);

707 cÚ¡ *
¢d_pcm_šfo_g‘_id
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
);

708 cÚ¡ *
¢d_pcm_šfo_g‘_Çme
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
);

709 cÚ¡ *
¢d_pcm_šfo_g‘_subdeviû_Çme
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
);

710 
¢d_pcm_şass_t
 
¢d_pcm_šfo_g‘_şass
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
);

711 
¢d_pcm_subşass_t
 
¢d_pcm_šfo_g‘_subşass
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
);

712 
¢d_pcm_šfo_g‘_subdeviûs_couÁ
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
);

713 
¢d_pcm_šfo_g‘_subdeviûs_ava
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
);

714 
¢d_pcm_sync_id_t
 
¢d_pcm_šfo_g‘_sync
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
);

715 
¢d_pcm_šfo_£t_deviû
(
¢d_pcm_šfo_t
 *
obj
, 
v®
);

716 
¢d_pcm_šfo_£t_subdeviû
(
¢d_pcm_šfo_t
 *
obj
, 
v®
);

717 
¢d_pcm_šfo_£t_¡»am
(
¢d_pcm_šfo_t
 *
obj
, 
¢d_pcm_¡»am_t
 
v®
);

728 
¢d_pcm_hw_·¿ms_ªy
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

730 
¢d_pcm_hw_·¿ms_ÿn_mm­_§m¶e_»sŞutiÚ
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

731 
¢d_pcm_hw_·¿ms_is_doubË
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

732 
¢d_pcm_hw_·¿ms_is_b©ch
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

733 
¢d_pcm_hw_·¿ms_is_block_Œªsãr
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

734 
¢d_pcm_hw_·¿ms_is_mÚÙÚic
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

735 
¢d_pcm_hw_·¿ms_ÿn_ov”¿nge
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

736 
¢d_pcm_hw_·¿ms_ÿn_·u£
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

737 
¢d_pcm_hw_·¿ms_ÿn_»sume
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

738 
¢d_pcm_hw_·¿ms_is_h®f_du¶ex
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

739 
¢d_pcm_hw_·¿ms_is_jošt_du¶ex
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

740 
¢d_pcm_hw_·¿ms_ÿn_sync_¡¬t
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

741 
¢d_pcm_hw_·¿ms_ÿn_di§bË_³riod_wakeup
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

742 
¢d_pcm_hw_·¿ms_is_³rãù_d¿š
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

743 
¢d_pcm_hw_·¿ms_suµÜts_audio_w®lşock_ts
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

744 
¢d_pcm_hw_·¿ms_suµÜts_audio_ts_ty³
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
ty³
);

745 
¢d_pcm_hw_·¿ms_g‘_¿‹_numd’
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

746 *
¿‹_num
,

747 *
¿‹_d’
);

748 
¢d_pcm_hw_·¿ms_g‘_sb™s
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

749 
¢d_pcm_hw_·¿ms_g‘_fifo_size
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

752 
_¢d_pcm_hw_¡¿‹gy
 
	t¢d_pcm_hw_¡¿‹gy_t
;

755 
	s_¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_li¡
 {

756 
v®ue
;

757 
badÃss
;

758 } 
	t¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_li¡_t
;

760 
¢d_pcm_hw_·¿ms_¡¿‹gy
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

761 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_t
 *
¡¿‹gy
,

762 
badÃss_mš
,

763 
badÃss_max
);

765 
¢d_pcm_hw_¡¿‹gy_ä“
(
¢d_pcm_hw_¡¿‹gy_t
 *
¡¿‹gy
);

766 
¢d_pcm_hw_¡¿‹gy_sim¶e
(
¢d_pcm_hw_¡¿‹gy_t
 **
¡¿‹gyp
,

767 
badÃss_mš
,

768 
badÃss_max
);

769 
¢d_pcm_hw_·¿ms_Œy_ex¶aš_çu»
(
¢d_pcm_t
 *
pcm
,

770 
¢d_pcm_hw_·¿ms_t
 *
ç
,

771 
¢d_pcm_hw_·¿ms_t
 *
sucûss
,

772 
d•th
,

773 
¢d_ouut_t
 *
out
);

777 
size_t
 
¢d_pcm_hw_·¿ms_sizeof
();

782 
	#¢d_pcm_hw_·¿ms_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_pcm_hw_·¿ms
)

	)

783 
¢d_pcm_hw_·¿ms_m®loc
(
¢d_pcm_hw_·¿ms_t
 **
±r
);

784 
¢d_pcm_hw_·¿ms_ä“
(
¢d_pcm_hw_·¿ms_t
 *
obj
);

785 
¢d_pcm_hw_·¿ms_cİy
(
¢d_pcm_hw_·¿ms_t
 *
d¡
, cÚ¡ snd_pcm_hw_·¿ms_ˆ*
¤c
);

787 #ià!
defšed
(
ALSA_LIBRARY_BUILD
è&& !defšed(
ALSA_PCM_OLD_HW_PARAMS_API
)

789 
¢d_pcm_hw_·¿ms_g‘_acûss
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 *
_acûss
);

790 
¢d_pcm_hw_·¿ms_‹¡_acûss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 
_acûss
);

791 
¢d_pcm_hw_·¿ms_£t_acûss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 
_acûss
);

792 
¢d_pcm_hw_·¿ms_£t_acûss_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 *
_acûss
);

793 
¢d_pcm_hw_·¿ms_£t_acûss_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 *
_acûss
);

794 
¢d_pcm_hw_·¿ms_£t_acûss_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_mask_t
 *
mask
);

795 
¢d_pcm_hw_·¿ms_g‘_acûss_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_mask_t
 *
mask
);

797 
¢d_pcm_hw_·¿ms_g‘_fÜm©
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 *
v®
);

798 
¢d_pcm_hw_·¿ms_‹¡_fÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 
v®
);

799 
¢d_pcm_hw_·¿ms_£t_fÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 
v®
);

800 
¢d_pcm_hw_·¿ms_£t_fÜm©_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 *
fÜm©
);

801 
¢d_pcm_hw_·¿ms_£t_fÜm©_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 *
fÜm©
);

802 
¢d_pcm_hw_·¿ms_£t_fÜm©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_mask_t
 *
mask
);

803 
¢d_pcm_hw_·¿ms_g‘_fÜm©_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_mask_t
 *
mask
);

805 
¢d_pcm_hw_·¿ms_g‘_subfÜm©
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 *
subfÜm©
);

806 
¢d_pcm_hw_·¿ms_‹¡_subfÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 
subfÜm©
);

807 
¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 
subfÜm©
);

808 
¢d_pcm_hw_·¿ms_£t_subfÜm©_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 *
subfÜm©
);

809 
¢d_pcm_hw_·¿ms_£t_subfÜm©_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 *
subfÜm©
);

810 
¢d_pcm_hw_·¿ms_£t_subfÜm©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_mask_t
 *
mask
);

811 
¢d_pcm_hw_·¿ms_g‘_subfÜm©_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_mask_t
 *
mask
);

813 
¢d_pcm_hw_·¿ms_g‘_chªÃls
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

814 
¢d_pcm_hw_·¿ms_g‘_chªÃls_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

815 
¢d_pcm_hw_·¿ms_g‘_chªÃls_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

816 
¢d_pcm_hw_·¿ms_‹¡_chªÃls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
);

817 
¢d_pcm_hw_·¿ms_£t_chªÃls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
);

818 
¢d_pcm_hw_·¿ms_£t_chªÃls_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

819 
¢d_pcm_hw_·¿ms_£t_chªÃls_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

820 
¢d_pcm_hw_·¿ms_£t_chªÃls_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
max
);

821 
¢d_pcm_hw_·¿ms_£t_chªÃls_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

822 
¢d_pcm_hw_·¿ms_£t_chªÃls_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

823 
¢d_pcm_hw_·¿ms_£t_chªÃls_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

825 
¢d_pcm_hw_·¿ms_g‘_¿‹
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

826 
¢d_pcm_hw_·¿ms_g‘_¿‹_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

827 
¢d_pcm_hw_·¿ms_g‘_¿‹_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

828 
¢d_pcm_hw_·¿ms_‹¡_¿‹
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

829 
¢d_pcm_hw_·¿ms_£t_¿‹
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

830 
¢d_pcm_hw_·¿ms_£t_¿‹_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

831 
¢d_pcm_hw_·¿ms_£t_¿‹_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

832 
¢d_pcm_hw_·¿ms_£t_¿‹_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
);

833 
¢d_pcm_hw_·¿ms_£t_¿‹_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

834 
¢d_pcm_hw_·¿ms_£t_¿‹_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

835 
¢d_pcm_hw_·¿ms_£t_¿‹_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

836 
¢d_pcm_hw_·¿ms_£t_¿‹_»§m¶e
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
);

837 
¢d_pcm_hw_·¿ms_g‘_¿‹_»§m¶e
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

838 
¢d_pcm_hw_·¿ms_£t_expÜt_bufãr
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
);

839 
¢d_pcm_hw_·¿ms_g‘_expÜt_bufãr
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

840 
¢d_pcm_hw_·¿ms_£t_³riod_wakeup
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
);

841 
¢d_pcm_hw_·¿ms_g‘_³riod_wakeup
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

842 
¢d_pcm_hw_·¿ms_£t_d¿š_s’û
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
);

843 
¢d_pcm_hw_·¿ms_g‘_d¿š_s’û
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

845 
¢d_pcm_hw_·¿ms_g‘_³riod_time
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

846 
¢d_pcm_hw_·¿ms_g‘_³riod_time_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

847 
¢d_pcm_hw_·¿ms_g‘_³riod_time_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

848 
¢d_pcm_hw_·¿ms_‹¡_³riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

849 
¢d_pcm_hw_·¿ms_£t_³riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

850 
¢d_pcm_hw_·¿ms_£t_³riod_time_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

851 
¢d_pcm_hw_·¿ms_£t_³riod_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

852 
¢d_pcm_hw_·¿ms_£t_³riod_time_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
);

853 
¢d_pcm_hw_·¿ms_£t_³riod_time_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

854 
¢d_pcm_hw_·¿ms_£t_³riod_time_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

855 
¢d_pcm_hw_·¿ms_£t_³riod_time_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

857 
¢d_pcm_hw_·¿ms_g‘_³riod_size
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
äames
, *
dœ
);

858 
¢d_pcm_hw_·¿ms_g‘_³riod_size_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
äames
, *
dœ
);

859 
¢d_pcm_hw_·¿ms_g‘_³riod_size_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
äames
, *
dœ
);

860 
¢d_pcm_hw_·¿ms_‹¡_³riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
, 
dœ
);

861 
¢d_pcm_hw_·¿ms_£t_³riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
, 
dœ
);

862 
¢d_pcm_hw_·¿ms_£t_³riod_size_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
);

863 
¢d_pcm_hw_·¿ms_£t_³riod_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
);

864 
¢d_pcm_hw_·¿ms_£t_³riod_size_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
mš
, *
mšdœ
, snd_pcm_uäames_ˆ*
max
, *
maxdœ
);

865 
¢d_pcm_hw_·¿ms_£t_³riod_size_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
);

866 
¢d_pcm_hw_·¿ms_£t_³riod_size_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
);

867 
¢d_pcm_hw_·¿ms_£t_³riod_size_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
);

868 
¢d_pcm_hw_·¿ms_£t_³riod_size_š‹g”
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

870 
¢d_pcm_hw_·¿ms_g‘_³riods
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

871 
¢d_pcm_hw_·¿ms_g‘_³riods_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

872 
¢d_pcm_hw_·¿ms_g‘_³riods_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

873 
¢d_pcm_hw_·¿ms_‹¡_³riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

874 
¢d_pcm_hw_·¿ms_£t_³riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

875 
¢d_pcm_hw_·¿ms_£t_³riods_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

876 
¢d_pcm_hw_·¿ms_£t_³riods_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

877 
¢d_pcm_hw_·¿ms_£t_³riods_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
);

878 
¢d_pcm_hw_·¿ms_£t_³riods_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

879 
¢d_pcm_hw_·¿ms_£t_³riods_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

880 
¢d_pcm_hw_·¿ms_£t_³riods_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

881 
¢d_pcm_hw_·¿ms_£t_³riods_š‹g”
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

883 
¢d_pcm_hw_·¿ms_g‘_bufãr_time
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

884 
¢d_pcm_hw_·¿ms_g‘_bufãr_time_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

885 
¢d_pcm_hw_·¿ms_g‘_bufãr_time_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

886 
¢d_pcm_hw_·¿ms_‹¡_bufãr_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

887 
¢d_pcm_hw_·¿ms_£t_bufãr_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

888 
¢d_pcm_hw_·¿ms_£t_bufãr_time_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

889 
¢d_pcm_hw_·¿ms_£t_bufãr_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

890 
¢d_pcm_hw_·¿ms_£t_bufãr_time_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
);

891 
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

892 
¢d_pcm_hw_·¿ms_£t_bufãr_time_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

893 
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

895 
¢d_pcm_hw_·¿ms_g‘_bufãr_size
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

896 
¢d_pcm_hw_·¿ms_g‘_bufãr_size_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

897 
¢d_pcm_hw_·¿ms_g‘_bufãr_size_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

898 
¢d_pcm_hw_·¿ms_‹¡_bufãr_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

899 
¢d_pcm_hw_·¿ms_£t_bufãr_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

900 
¢d_pcm_hw_·¿ms_£t_bufãr_size_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

901 
¢d_pcm_hw_·¿ms_£t_bufãr_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

902 
¢d_pcm_hw_·¿ms_£t_bufãr_size_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
mš
, snd_pcm_uäames_ˆ*
max
);

903 
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

904 
¢d_pcm_hw_·¿ms_£t_bufãr_size_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

905 
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

909 
¢d_pcm_hw_·¿ms_g‘_mš_®ign
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

920 
size_t
 
¢d_pcm_sw_·¿ms_sizeof
();

925 
	#¢d_pcm_sw_·¿ms_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_pcm_sw_·¿ms
)

	)

926 
¢d_pcm_sw_·¿ms_m®loc
(
¢d_pcm_sw_·¿ms_t
 **
±r
);

927 
¢d_pcm_sw_·¿ms_ä“
(
¢d_pcm_sw_·¿ms_t
 *
obj
);

928 
¢d_pcm_sw_·¿ms_cİy
(
¢d_pcm_sw_·¿ms_t
 *
d¡
, cÚ¡ snd_pcm_sw_·¿ms_ˆ*
¤c
);

929 
¢d_pcm_sw_·¿ms_g‘_bound¬y
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

931 #ià!
defšed
(
ALSA_LIBRARY_BUILD
è&& !defšed(
ALSA_PCM_OLD_SW_PARAMS_API
)

933 
¢d_pcm_sw_·¿ms_£t_t¡amp_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_t¡amp_t
 
v®
);

934 
¢d_pcm_sw_·¿ms_g‘_t¡amp_mode
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_t¡amp_t
 *
v®
);

935 
¢d_pcm_sw_·¿ms_£t_t¡amp_ty³
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_t¡amp_ty³_t
 
v®
);

936 
¢d_pcm_sw_·¿ms_g‘_t¡amp_ty³
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_t¡amp_ty³_t
 *
v®
);

937 
¢d_pcm_sw_·¿ms_£t_ava_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

938 
¢d_pcm_sw_·¿ms_g‘_ava_mš
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

939 
¢d_pcm_sw_·¿ms_£t_³riod_ev’t
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
v®
);

940 
¢d_pcm_sw_·¿ms_g‘_³riod_ev’t
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, *
v®
);

941 
¢d_pcm_sw_·¿ms_£t_¡¬t_th»shŞd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

942 
¢d_pcm_sw_·¿ms_g‘_¡¬t_th»shŞd
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿msm
, 
¢d_pcm_uäames_t
 *
v®
);

943 
¢d_pcm_sw_·¿ms_£t_¡İ_th»shŞd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

944 
¢d_pcm_sw_·¿ms_g‘_¡İ_th»shŞd
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

945 
¢d_pcm_sw_·¿ms_£t_s’û_th»shŞd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

946 
¢d_pcm_sw_·¿ms_g‘_s’û_th»shŞd
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

947 
¢d_pcm_sw_·¿ms_£t_s’û_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

948 
¢d_pcm_sw_·¿ms_g‘_s’û_size
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

955 #iâdeà
ALSA_LIBRARY_BUILD


956 #ià
defšed
(
ALSA_PCM_OLD_HW_PARAMS_API
è|| defšed(
ALSA_PCM_OLD_SW_PARAMS_API
)

957 
	~"pcm_Şd.h
"

968 
size_t
 
¢d_pcm_acûss_mask_sizeof
();

973 
	#¢d_pcm_acûss_mask_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_pcm_acûss_mask
)

	)

974 
¢d_pcm_acûss_mask_m®loc
(
¢d_pcm_acûss_mask_t
 **
±r
);

975 
¢d_pcm_acûss_mask_ä“
(
¢d_pcm_acûss_mask_t
 *
obj
);

976 
¢d_pcm_acûss_mask_cİy
(
¢d_pcm_acûss_mask_t
 *
d¡
, cÚ¡ snd_pcm_acûss_mask_ˆ*
¤c
);

977 
¢d_pcm_acûss_mask_nÚe
(
¢d_pcm_acûss_mask_t
 *
mask
);

978 
¢d_pcm_acûss_mask_ªy
(
¢d_pcm_acûss_mask_t
 *
mask
);

979 
¢d_pcm_acûss_mask_‹¡
(cÚ¡ 
¢d_pcm_acûss_mask_t
 *
mask
, 
¢d_pcm_acûss_t
 
v®
);

980 
¢d_pcm_acûss_mask_em±y
(cÚ¡ 
¢d_pcm_acûss_mask_t
 *
mask
);

981 
¢d_pcm_acûss_mask_£t
(
¢d_pcm_acûss_mask_t
 *
mask
, 
¢d_pcm_acûss_t
 
v®
);

982 
¢d_pcm_acûss_mask_»£t
(
¢d_pcm_acûss_mask_t
 *
mask
, 
¢d_pcm_acûss_t
 
v®
);

993 
size_t
 
¢d_pcm_fÜm©_mask_sizeof
();

998 
	#¢d_pcm_fÜm©_mask_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_pcm_fÜm©_mask
)

	)

999 
¢d_pcm_fÜm©_mask_m®loc
(
¢d_pcm_fÜm©_mask_t
 **
±r
);

1000 
¢d_pcm_fÜm©_mask_ä“
(
¢d_pcm_fÜm©_mask_t
 *
obj
);

1001 
¢d_pcm_fÜm©_mask_cİy
(
¢d_pcm_fÜm©_mask_t
 *
d¡
, cÚ¡ snd_pcm_fÜm©_mask_ˆ*
¤c
);

1002 
¢d_pcm_fÜm©_mask_nÚe
(
¢d_pcm_fÜm©_mask_t
 *
mask
);

1003 
¢d_pcm_fÜm©_mask_ªy
(
¢d_pcm_fÜm©_mask_t
 *
mask
);

1004 
¢d_pcm_fÜm©_mask_‹¡
(cÚ¡ 
¢d_pcm_fÜm©_mask_t
 *
mask
, 
¢d_pcm_fÜm©_t
 
v®
);

1005 
¢d_pcm_fÜm©_mask_em±y
(cÚ¡ 
¢d_pcm_fÜm©_mask_t
 *
mask
);

1006 
¢d_pcm_fÜm©_mask_£t
(
¢d_pcm_fÜm©_mask_t
 *
mask
, 
¢d_pcm_fÜm©_t
 
v®
);

1007 
¢d_pcm_fÜm©_mask_»£t
(
¢d_pcm_fÜm©_mask_t
 *
mask
, 
¢d_pcm_fÜm©_t
 
v®
);

1018 
size_t
 
¢d_pcm_subfÜm©_mask_sizeof
();

1023 
	#¢d_pcm_subfÜm©_mask_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_pcm_subfÜm©_mask
)

	)

1024 
¢d_pcm_subfÜm©_mask_m®loc
(
¢d_pcm_subfÜm©_mask_t
 **
±r
);

1025 
¢d_pcm_subfÜm©_mask_ä“
(
¢d_pcm_subfÜm©_mask_t
 *
obj
);

1026 
¢d_pcm_subfÜm©_mask_cİy
(
¢d_pcm_subfÜm©_mask_t
 *
d¡
, cÚ¡ snd_pcm_subfÜm©_mask_ˆ*
¤c
);

1027 
¢d_pcm_subfÜm©_mask_nÚe
(
¢d_pcm_subfÜm©_mask_t
 *
mask
);

1028 
¢d_pcm_subfÜm©_mask_ªy
(
¢d_pcm_subfÜm©_mask_t
 *
mask
);

1029 
¢d_pcm_subfÜm©_mask_‹¡
(cÚ¡ 
¢d_pcm_subfÜm©_mask_t
 *
mask
, 
¢d_pcm_subfÜm©_t
 
v®
);

1030 
¢d_pcm_subfÜm©_mask_em±y
(cÚ¡ 
¢d_pcm_subfÜm©_mask_t
 *
mask
);

1031 
¢d_pcm_subfÜm©_mask_£t
(
¢d_pcm_subfÜm©_mask_t
 *
mask
, 
¢d_pcm_subfÜm©_t
 
v®
);

1032 
¢d_pcm_subfÜm©_mask_»£t
(
¢d_pcm_subfÜm©_mask_t
 *
mask
, 
¢d_pcm_subfÜm©_t
 
v®
);

1043 
size_t
 
¢d_pcm_¡©us_sizeof
();

1048 
	#¢d_pcm_¡©us_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_pcm_¡©us
)

	)

1049 
¢d_pcm_¡©us_m®loc
(
¢d_pcm_¡©us_t
 **
±r
);

1050 
¢d_pcm_¡©us_ä“
(
¢d_pcm_¡©us_t
 *
obj
);

1051 
¢d_pcm_¡©us_cİy
(
¢d_pcm_¡©us_t
 *
d¡
, cÚ¡ snd_pcm_¡©us_ˆ*
¤c
);

1052 
¢d_pcm_¡©e_t
 
¢d_pcm_¡©us_g‘_¡©e
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
);

1053 
¢d_pcm_¡©us_g‘_Œigg”_t¡amp
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
, 
¢d_time¡amp_t
 *
±r
);

1054 
¢d_pcm_¡©us_g‘_Œigg”_ht¡amp
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
, 
¢d_htime¡amp_t
 *
±r
);

1055 
¢d_pcm_¡©us_g‘_t¡amp
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
, 
¢d_time¡amp_t
 *
±r
);

1056 
¢d_pcm_¡©us_g‘_ht¡amp
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
, 
¢d_htime¡amp_t
 *
±r
);

1057 
¢d_pcm_¡©us_g‘_audio_ht¡amp
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
, 
¢d_htime¡amp_t
 *
±r
);

1058 
¢d_pcm_¡©us_g‘_driv”_ht¡amp
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
, 
¢d_htime¡amp_t
 *
±r
);

1059 
¢d_pcm_¡©us_g‘_audio_ht¡amp_»pÜt
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
,

1060 
¢d_pcm_audio_t¡amp_»pÜt_t
 *
audio_t¡amp_»pÜt
);

1061 
¢d_pcm_¡©us_£t_audio_ht¡amp_cÚfig
(
¢d_pcm_¡©us_t
 *
obj
,

1062 
¢d_pcm_audio_t¡amp_cÚfig_t
 *
audio_t¡amp_cÚfig
);

1064 
šlše
 
¢d_pcm_·ck_audio_t¡amp_cÚfig
(*
d©a
,

1065 
¢d_pcm_audio_t¡amp_cÚfig_t
 *
cÚfig
)

1067 *
d©a
 = 
cÚfig
->
»pÜt_d–ay
;

1068 *
d©a
 <<= 4;

1069 *
d©a
 |ğ
cÚfig
->
ty³_»que¡ed
;

1072 
šlše
 
¢d_pcm_uÅack_audio_t¡amp_»pÜt
(
d©a
, 
accu¿cy
,

1073 
¢d_pcm_audio_t¡amp_»pÜt_t
 *
»pÜt
)

1075 
d©a
 >>= 16;

1076 
»pÜt
->
v®id
 = 
d©a
 & 1;

1077 
»pÜt
->
aùu®_ty³
 = (
d©a
 >> 1) & 0xF;

1078 
»pÜt
->
accu¿cy_»pÜt
 = (
d©a
 >> 5) & 1;

1079 
»pÜt
->
accu¿cy
 =‡ccuracy;

1082 
¢d_pcm_säames_t
 
¢d_pcm_¡©us_g‘_d–ay
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
);

1083 
¢d_pcm_uäames_t
 
¢d_pcm_¡©us_g‘_ava
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
);

1084 
¢d_pcm_uäames_t
 
¢d_pcm_¡©us_g‘_ava_max
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
);

1085 
¢d_pcm_uäames_t
 
¢d_pcm_¡©us_g‘_ov”¿nge
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
);

1096 cÚ¡ *
¢d_pcm_ty³_Çme
(
¢d_pcm_ty³_t
 
ty³
);

1097 cÚ¡ *
¢d_pcm_¡»am_Çme
(cÚ¡ 
¢d_pcm_¡»am_t
 
¡»am
);

1098 cÚ¡ *
¢d_pcm_acûss_Çme
(cÚ¡ 
¢d_pcm_acûss_t
 
_acûss
);

1099 cÚ¡ *
¢d_pcm_fÜm©_Çme
(cÚ¡ 
¢d_pcm_fÜm©_t
 
fÜm©
);

1100 cÚ¡ *
¢d_pcm_fÜm©_desütiÚ
(cÚ¡ 
¢d_pcm_fÜm©_t
 
fÜm©
);

1101 cÚ¡ *
¢d_pcm_subfÜm©_Çme
(cÚ¡ 
¢d_pcm_subfÜm©_t
 
subfÜm©
);

1102 cÚ¡ *
¢d_pcm_subfÜm©_desütiÚ
(cÚ¡ 
¢d_pcm_subfÜm©_t
 
subfÜm©
);

1103 
¢d_pcm_subfÜm©_t
 
¢d_pcm_subfÜm©_v®ue
(cÚ¡ * 
Çme
);

1104 
¢d_pcm_fÜm©_t
 
¢d_pcm_fÜm©_v®ue
(cÚ¡ * 
Çme
);

1105 cÚ¡ *
¢d_pcm_t¡amp_mode_Çme
(cÚ¡ 
¢d_pcm_t¡amp_t
 
mode
);

1106 cÚ¡ *
¢d_pcm_¡©e_Çme
(cÚ¡ 
¢d_pcm_¡©e_t
 
¡©e
);

1117 
¢d_pcm_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
);

1118 
¢d_pcm_dump_hw_£tup
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
);

1119 
¢d_pcm_dump_sw_£tup
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
);

1120 
¢d_pcm_dump_£tup
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
);

1121 
¢d_pcm_hw_·¿ms_dump
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_ouut_t
 *
out
);

1122 
¢d_pcm_sw_·¿ms_dump
(
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_ouut_t
 *
out
);

1123 
¢d_pcm_¡©us_dump
(
¢d_pcm_¡©us_t
 *
¡©us
, 
¢d_ouut_t
 *
out
);

1134 
¢d_pcm_mm­_begš
(
¢d_pcm_t
 *
pcm
,

1135 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 **
¬—s
,

1136 
¢d_pcm_uäames_t
 *
off£t
,

1137 
¢d_pcm_uäames_t
 *
äames
);

1138 
¢d_pcm_säames_t
 
¢d_pcm_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

1139 
¢d_pcm_uäames_t
 
off£t
,

1140 
¢d_pcm_uäames_t
 
äames
);

1141 
¢d_pcm_säames_t
 
¢d_pcm_mm­_wr™ei
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
bufãr
, 
¢d_pcm_uäames_t
 
size
);

1142 
¢d_pcm_säames_t
 
¢d_pcm_mm­_»adi
(
¢d_pcm_t
 *
pcm
, *
bufãr
, 
¢d_pcm_uäames_t
 
size
);

1143 
¢d_pcm_säames_t
 
¢d_pcm_mm­_wr™’
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
);

1144 
¢d_pcm_säames_t
 
¢d_pcm_mm­_»adn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
);

1155 
¢d_pcm_fÜm©_sigÃd
(
¢d_pcm_fÜm©_t
 
fÜm©
);

1156 
¢d_pcm_fÜm©_unsigÃd
(
¢d_pcm_fÜm©_t
 
fÜm©
);

1157 
¢d_pcm_fÜm©_lš—r
(
¢d_pcm_fÜm©_t
 
fÜm©
);

1158 
¢d_pcm_fÜm©_æßt
(
¢d_pcm_fÜm©_t
 
fÜm©
);

1159 
¢d_pcm_fÜm©_l™e_’dŸn
(
¢d_pcm_fÜm©_t
 
fÜm©
);

1160 
¢d_pcm_fÜm©_big_’dŸn
(
¢d_pcm_fÜm©_t
 
fÜm©
);

1161 
¢d_pcm_fÜm©_ıu_’dŸn
(
¢d_pcm_fÜm©_t
 
fÜm©
);

1162 
¢d_pcm_fÜm©_width
(
¢d_pcm_fÜm©_t
 
fÜm©
);

1163 
¢d_pcm_fÜm©_physiÿl_width
(
¢d_pcm_fÜm©_t
 
fÜm©
);

1164 
¢d_pcm_fÜm©_t
 
¢d_pcm_bud_lš—r_fÜm©
(
width
, 
pwidth
, 
unsignd
, 
big_’dŸn
);

1165 
ssize_t
 
¢d_pcm_fÜm©_size
(
¢d_pcm_fÜm©_t
 
fÜm©
, 
size_t
 
§m¶es
);

1166 
ušt8_t
 
¢d_pcm_fÜm©_s’û
(
¢d_pcm_fÜm©_t
 
fÜm©
);

1167 
ušt16_t
 
¢d_pcm_fÜm©_s’û_16
(
¢d_pcm_fÜm©_t
 
fÜm©
);

1168 
ušt32_t
 
¢d_pcm_fÜm©_s’û_32
(
¢d_pcm_fÜm©_t
 
fÜm©
);

1169 
ušt64_t
 
¢d_pcm_fÜm©_s’û_64
(
¢d_pcm_fÜm©_t
 
fÜm©
);

1170 
¢d_pcm_fÜm©_£t_s’û
(
¢d_pcm_fÜm©_t
 
fÜm©
, *
buf
, 
§m¶es
);

1172 
¢d_pcm_säames_t
 
¢d_pcm_by‹s_to_äames
(
¢d_pcm_t
 *
pcm
, 
ssize_t
 
by‹s
);

1173 
ssize_t
 
¢d_pcm_äames_to_by‹s
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 
äames
);

1174 
¢d_pcm_by‹s_to_§m¶es
(
¢d_pcm_t
 *
pcm
, 
ssize_t
 
by‹s
);

1175 
ssize_t
 
¢d_pcm_§m¶es_to_by‹s
(
¢d_pcm_t
 *
pcm
, 
§m¶es
);

1177 
¢d_pcm_¬—_s’û
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_chªÃl
, 
¢d_pcm_uäames_t
 
d¡_off£t
,

1178 
§m¶es
, 
¢d_pcm_fÜm©_t
 
fÜm©
);

1179 
¢d_pcm_¬—s_s’û
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_chªÃls
, 
¢d_pcm_uäames_t
 
d¡_off£t
,

1180 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
, 
¢d_pcm_fÜm©_t
 
fÜm©
);

1181 
¢d_pcm_¬—_cİy
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_chªÃl
, 
¢d_pcm_uäames_t
 
d¡_off£t
,

1182 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_chªÃl
, 
¢d_pcm_uäames_t
 
¤c_off£t
,

1183 
§m¶es
, 
¢d_pcm_fÜm©_t
 
fÜm©
);

1184 
¢d_pcm_¬—s_cİy
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_chªÃls
, 
¢d_pcm_uäames_t
 
d¡_off£t
,

1185 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_chªÃls
, 
¢d_pcm_uäames_t
 
¤c_off£t
,

1186 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
, 
¢d_pcm_fÜm©_t
 
fÜm©
);

1187 
¢d_pcm_¬—s_cİy_w¿p
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_chªÃls
,

1188 
¢d_pcm_uäames_t
 
d¡_off£t
,

1189 cÚ¡ 
¢d_pcm_uäames_t
 
d¡_size
,

1190 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_chªÃls
,

1191 
¢d_pcm_uäames_t
 
¤c_off£t
,

1192 cÚ¡ 
¢d_pcm_uäames_t
 
¤c_size
,

1193 cÚ¡ 
chªÃls
,

1194 
¢d_pcm_uäames_t
 
äames
,

1195 cÚ¡ 
¢d_pcm_fÜm©_t
 
fÜm©
);

1204 
šlše
 *
¢d_pcm_chªÃl_¬—_addr
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—
, 
¢d_pcm_uäames_t
 
off£t
)

1206  (*)
¬—
->
addr
 + (¬—->
fœ¡
 +‡»a->
¡•
 * 
off£t
) / 8;

1215 
šlše
 
¢d_pcm_chªÃl_¬—_¡•
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—
)

1217  
¬—
->
¡•
 / 8;

1230 
	e_¢d_pcm_hook_ty³
 {

1231 
SND_PCM_HOOK_TYPE_HW_PARAMS
 = 0,

1232 
SND_PCM_HOOK_TYPE_HW_FREE
,

1233 
SND_PCM_HOOK_TYPE_CLOSE
,

1234 
SND_PCM_HOOK_TYPE_LAST
 = 
SND_PCM_HOOK_TYPE_CLOSE


1235 } 
	t¢d_pcm_hook_ty³_t
;

1238 
_¢d_pcm_hook
 
	t¢d_pcm_hook_t
;

1240 (*
¢d_pcm_hook_func_t
)(
	t¢d_pcm_hook_t
 *
	thook
);

1241 
¢d_pcm_t
 *
¢d_pcm_hook_g‘_pcm
(
¢d_pcm_hook_t
 *
hook
);

1242 *
¢d_pcm_hook_g‘_´iv©e
(
¢d_pcm_hook_t
 *
hook
);

1243 
¢d_pcm_hook_£t_´iv©e
(
¢d_pcm_hook_t
 *
hook
, *
´iv©e_d©a
);

1244 
¢d_pcm_hook_add
(
¢d_pcm_hook_t
 **
hookp
, 
¢d_pcm_t
 *
pcm
,

1245 
¢d_pcm_hook_ty³_t
 
ty³
,

1246 
¢d_pcm_hook_func_t
 
func
, *
´iv©e_d©a
);

1247 
¢d_pcm_hook_»move
(
¢d_pcm_hook_t
 *
hook
);

1259 
	s_¢d_pcm_scİe_İs
 {

1263 (*
’abË
)(
¢d_pcm_scİe_t
 *
scİe
);

1267 (*
di§bË
)(
¢d_pcm_scİe_t
 *
scİe
);

1271 (*
¡¬t
)(
¢d_pcm_scİe_t
 *
scİe
);

1275 (*
¡İ
)(
¢d_pcm_scİe_t
 *
scİe
);

1279 (*
upd©e
)(
¢d_pcm_scİe_t
 *
scİe
);

1283 (*
»£t
)(
¢d_pcm_scİe_t
 *
scİe
);

1287 (*
şo£
)(
¢d_pcm_scİe_t
 *
scİe
);

1288 } 
	t¢d_pcm_scİe_İs_t
;

1290 
¢d_pcm_uäames_t
 
¢d_pcm_m‘”_g‘_bufsize
(
¢d_pcm_t
 *
pcm
);

1291 
¢d_pcm_m‘”_g‘_chªÃls
(
¢d_pcm_t
 *
pcm
);

1292 
¢d_pcm_m‘”_g‘_¿‹
(
¢d_pcm_t
 *
pcm
);

1293 
¢d_pcm_uäames_t
 
¢d_pcm_m‘”_g‘_now
(
¢d_pcm_t
 *
pcm
);

1294 
¢d_pcm_uäames_t
 
¢d_pcm_m‘”_g‘_bound¬y
(
¢d_pcm_t
 *
pcm
);

1295 
¢d_pcm_m‘”_add_scİe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_scİe_t
 *
scİe
);

1296 
¢d_pcm_scİe_t
 *
¢d_pcm_m‘”_£¬ch_scİe
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
Çme
);

1297 
¢d_pcm_scİe_m®loc
(
¢d_pcm_scİe_t
 **
±r
);

1298 
¢d_pcm_scİe_£t_İs
(
¢d_pcm_scİe_t
 *
scİe
,

1299 cÚ¡ 
¢d_pcm_scİe_İs_t
 *
v®
);

1300 
¢d_pcm_scİe_£t_Çme
(
¢d_pcm_scİe_t
 *
scİe
, cÚ¡ *
v®
);

1301 cÚ¡ *
¢d_pcm_scİe_g‘_Çme
(
¢d_pcm_scİe_t
 *
scİe
);

1302 *
¢d_pcm_scİe_g‘_ÿÎback_´iv©e
(
¢d_pcm_scİe_t
 *
scİe
);

1303 
¢d_pcm_scİe_£t_ÿÎback_´iv©e
(
¢d_pcm_scİe_t
 *
scİe
, *
v®
);

1304 
¢d_pcm_scİe_s16_İ’
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
Çme
,

1305 
¢d_pcm_scİe_t
 **
scİ•
);

1306 
št16_t
 *
¢d_pcm_scİe_s16_g‘_chªÃl_bufãr
(
¢d_pcm_scİe_t
 *
scİe
,

1307 
chªÃl
);

1319 
	e_¢d_¥cm_Ï‹ncy
 {

1322 
SND_SPCM_LATENCY_STANDARD
 = 0,

1325 
SND_SPCM_LATENCY_MEDIUM
,

1328 
SND_SPCM_LATENCY_REALTIME


1329 } 
	t¢d_¥cm_Ï‹ncy_t
;

1332 
	e_¢d_¥cm_xrun_ty³
 {

1334 
SND_SPCM_XRUN_IGNORE
 = 0,

1336 
SND_SPCM_XRUN_STOP


1337 } 
	t¢d_¥cm_xrun_ty³_t
;

1340 
	e_¢d_¥cm_du¶ex_ty³
 {

1342 
SND_SPCM_DUPLEX_LIBERAL
 = 0,

1344 
SND_SPCM_DUPLEX_PEDANTIC


1345 } 
	t¢d_¥cm_du¶ex_ty³_t
;

1347 
¢d_¥cm_š™
(
¢d_pcm_t
 *
pcm
,

1348 
¿‹
,

1349 
chªÃls
,

1350 
¢d_pcm_fÜm©_t
 
fÜm©
,

1351 
¢d_pcm_subfÜm©_t
 
subfÜm©
,

1352 
¢d_¥cm_Ï‹ncy_t
 
Ï‹ncy
,

1353 
¢d_pcm_acûss_t
 
_acûss
,

1354 
¢d_¥cm_xrun_ty³_t
 
xrun_ty³
);

1356 
¢d_¥cm_š™_du¶ex
(
¢d_pcm_t
 *
¶ayback_pcm
,

1357 
¢d_pcm_t
 *
ÿ±u»_pcm
,

1358 
¿‹
,

1359 
chªÃls
,

1360 
¢d_pcm_fÜm©_t
 
fÜm©
,

1361 
¢d_pcm_subfÜm©_t
 
subfÜm©
,

1362 
¢d_¥cm_Ï‹ncy_t
 
Ï‹ncy
,

1363 
¢d_pcm_acûss_t
 
_acûss
,

1364 
¢d_¥cm_xrun_ty³_t
 
xrun_ty³
,

1365 
¢d_¥cm_du¶ex_ty³_t
 
du¶ex_ty³
);

1367 
¢d_¥cm_š™_g‘_·¿ms
(
¢d_pcm_t
 *
pcm
,

1368 *
¿‹
,

1369 
¢d_pcm_uäames_t
 *
bufãr_size
,

1370 
¢d_pcm_uäames_t
 *
³riod_size
);

1382 cÚ¡ *
¢d_pcm_¡¬t_mode_Çme
(
¢d_pcm_¡¬t_t
 
mode
è
__©Œibu‹__
((
d•»ÿ‹d
));

1383 cÚ¡ *
¢d_pcm_xrun_mode_Çme
(
¢d_pcm_xrun_t
 
mode
è
__©Œibu‹__
((
d•»ÿ‹d
));

1384 
¢d_pcm_sw_·¿ms_£t_¡¬t_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_¡¬t_t
 
v®
è
__©Œibu‹__
((
d•»ÿ‹d
));

1385 
¢d_pcm_¡¬t_t
 
¢d_pcm_sw_·¿ms_g‘_¡¬t_mode
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
è
__©Œibu‹__
((
d•»ÿ‹d
));

1386 
¢d_pcm_sw_·¿ms_£t_xrun_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_xrun_t
 
v®
è
__©Œibu‹__
((
d•»ÿ‹d
));

1387 
¢d_pcm_xrun_t
 
¢d_pcm_sw_·¿ms_g‘_xrun_mode
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
è
__©Œibu‹__
((
d•»ÿ‹d
));

1388 #ià!
defšed
(
ALSA_LIBRARY_BUILD
è&& !defšed(
ALSA_PCM_OLD_SW_PARAMS_API
)

1389 
¢d_pcm_sw_·¿ms_£t_xãr_®ign
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
è
__©Œibu‹__
((
d•»ÿ‹d
));

1390 
¢d_pcm_sw_·¿ms_g‘_xãr_®ign
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
è
__©Œibu‹__
((
d•»ÿ‹d
));

1391 
¢d_pcm_sw_·¿ms_£t_¦“p_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
v®
è
__©Œibu‹__
((
d•»ÿ‹d
));

1392 
¢d_pcm_sw_·¿ms_g‘_¦“p_mš
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, *
v®
è
__©Œibu‹__
((
d•»ÿ‹d
));

1394 #ià!
defšed
(
ALSA_LIBRARY_BUILD
è&& !defšed(
ALSA_PCM_OLD_HW_PARAMS_API
)

1395 
¢d_pcm_hw_·¿ms_g‘_tick_time
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
è
__©Œibu‹__
((
d•»ÿ‹d
));

1396 
¢d_pcm_hw_·¿ms_g‘_tick_time_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
è
__©Œibu‹__
((
d•»ÿ‹d
));

1397 
¢d_pcm_hw_·¿ms_g‘_tick_time_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
è
__©Œibu‹__
((
d•»ÿ‹d
));

1398 
¢d_pcm_hw_·¿ms_‹¡_tick_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
è
__©Œibu‹__
((
d•»ÿ‹d
));

1399 
¢d_pcm_hw_·¿ms_£t_tick_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
è
__©Œibu‹__
((
d•»ÿ‹d
));

1400 
¢d_pcm_hw_·¿ms_£t_tick_time_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
è
__©Œibu‹__
((
d•»ÿ‹d
));

1401 
¢d_pcm_hw_·¿ms_£t_tick_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
è
__©Œibu‹__
((
d•»ÿ‹d
));

1402 
¢d_pcm_hw_·¿ms_£t_tick_time_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
è
__©Œibu‹__
((
d•»ÿ‹d
));

1403 
¢d_pcm_hw_·¿ms_£t_tick_time_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
è
__©Œibu‹__
((
d•»ÿ‹d
));

1404 
¢d_pcm_hw_·¿ms_£t_tick_time_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
è
__©Œibu‹__
((
d•»ÿ‹d
));

1405 
¢d_pcm_hw_·¿ms_£t_tick_time_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
è
__©Œibu‹__
((
d•»ÿ‹d
));

1410 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_external.h

26 #iâdeà
__ALSA_PCM_EXTERNAL_H


27 
	#__ALSA_PCM_EXTERNAL_H


	)

29 
	~"pcm.h
"

31 #ifdeà
__ılu¥lus


43 
	#SND_PCM_PLUGIN_ENTRY
(
Çme
è
_¢d_pcm_
##Çme##
_İ’


	)

48 
	#SND_PCM_PLUGIN_SYMBOL
(
Çme
è
	`SND_DLSYM_BUILD_VERSION
(
	`SND_PCM_PLUGIN_ENTRY
Òame), 
SND_PCM_DLSYM_VERSION
);

	)

53 
	#SND_PCM_PLUGIN_DEFINE_FUNC
(
¶ugš
) \

54 
	`SND_PCM_PLUGIN_ENTRY
(
¶ugš
è(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,\

55 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
, \

56 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

	)

58 
	~"pcm_iİlug.h
"

59 
	~"pcm_exlug.h
"

61 
¢d_pcm_·r£_cÚŒŞ_id
(
¢d_cÚfig_t
 *
cÚf
, 
¢d_ùl_–em_id_t
 *
ùl_id
, *
ÿrdp
,

62 *
cchªÃl¥
, *
hwùÍ
è
__©Œibu‹__
((
d•»ÿ‹d
));

66 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_extplug.h

31 #iâdeà
__ALSA_PCM_EXTPLUG_H


32 
	#__ALSA_PCM_EXTPLUG_H


	)

43 
	mSND_PCM_EXTPLUG_HW_FORMAT
,

44 
	mSND_PCM_EXTPLUG_HW_CHANNELS
,

45 
	mSND_PCM_EXTPLUG_HW_PARAMS


49 
¢d_pcm_exlug
 
	t¢d_pcm_exlug_t
;

51 
¢d_pcm_exlug_ÿÎback
 
	t¢d_pcm_exlug_ÿÎback_t
;

52 #ifdeà
DOC_HIDDEN


54 
¢d_pcm_exlug
 
	t¢d_pcm_exlug_t
;

55 
¢d_pcm_exlug_ÿÎback
 
	t¢d_pcm_exlug_ÿÎback_t
;

61 
	#SND_PCM_EXTPLUG_VERSION_MAJOR
 1

	)

62 
	#SND_PCM_EXTPLUG_VERSION_MINOR
 0

	)

63 
	#SND_PCM_EXTPLUG_VERSION_TINY
 2

	)

67 
	#SND_PCM_EXTPLUG_VERSION
 ((
SND_PCM_EXTPLUG_VERSION_MAJOR
<<16) |\

68 (
SND_PCM_EXTPLUG_VERSION_MINOR
<<8) |\

69 (
SND_PCM_EXTPLUG_VERSION_TINY
))

	)

72 
	s¢d_pcm_exlug
 {

77 
	mv”siÚ
;

81 cÚ¡ *
	mÇme
;

85 cÚ¡ 
¢d_pcm_exlug_ÿÎback_t
 *
	mÿÎback
;

89 *
	m´iv©e_d©a
;

93 
¢d_pcm_t
 *
	mpcm
;

97 
¢d_pcm_¡»am_t
 
	m¡»am
;

101 
¢d_pcm_fÜm©_t
 
	mfÜm©
;

105 
¢d_pcm_subfÜm©_t
 
	msubfÜm©
;

109 
	mchªÃls
;

113 
	m¿‹
;

117 
¢d_pcm_fÜm©_t
 
	m¦ave_fÜm©
;

121 
¢d_pcm_subfÜm©_t
 
	m¦ave_subfÜm©
;

125 
	m¦ave_chªÃls
;

129 
	s¢d_pcm_exlug_ÿÎback
 {

133 
¢d_pcm_säames_t
 (*
Œªsãr
)(
¢d_pcm_exlug_t
 *
	mext
,

134 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
	md¡_¬—s
,

135 
¢d_pcm_uäames_t
 
	md¡_off£t
,

136 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
	m¤c_¬—s
,

137 
¢d_pcm_uäames_t
 
	m¤c_off£t
,

138 
¢d_pcm_uäames_t
 
	msize
);

142 (*
	mşo£
)(
¢d_pcm_exlug_t
 *
	mext
);

146 (*
	mhw_·¿ms
)(
¢d_pcm_exlug_t
 *
	mext
, 
¢d_pcm_hw_·¿ms_t
 *
	m·¿ms
);

150 (*
	mhw_ä“
)(
¢d_pcm_exlug_t
 *
	mext
);

154 (*
	mdump
)(
¢d_pcm_exlug_t
 *
	mext
, 
¢d_ouut_t
 *
	mout
);

158 (*
	mš™
)(
¢d_pcm_exlug_t
 *
	mext
);

162 
	m¢d_pcm_chm­_qu”y_t
 **(*
	mqu”y_chm­s
)(
¢d_pcm_exlug_t
 *
	mext
);

166 
	m¢d_pcm_chm­_t
 *(*
	mg‘_chm­
)(
¢d_pcm_exlug_t
 *
	mext
);

170 (*
	m£t_chm­
)(
¢d_pcm_exlug_t
 *
	mext
, cÚ¡ 
¢d_pcm_chm­_t
 *
	mm­
);

174 
¢d_pcm_exlug_ü—‹
(
¢d_pcm_exlug_t
 *
ext
, cÚ¡ *
Çme
,

175 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
¦ave_cÚf
,

176 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

177 
¢d_pcm_exlug_d–‘e
(
¢d_pcm_exlug_t
 *
ext
);

180 
¢d_pcm_exlug_·¿ms_»£t
(
¢d_pcm_exlug_t
 *
ext
);

183 
¢d_pcm_exlug_£t_·¿m_li¡
(
¢d_pcm_exlug_t
 *
exlug
, 
ty³
, 
num_li¡
, cÚ¡ *
li¡
);

184 
¢d_pcm_exlug_£t_·¿m_mšmax
(
¢d_pcm_exlug_t
 *
exlug
, 
ty³
, 
mš
, 
max
);

185 
¢d_pcm_exlug_£t_¦ave_·¿m_li¡
(
¢d_pcm_exlug_t
 *
exlug
, 
ty³
, 
num_li¡
, cÚ¡ *
li¡
);

186 
¢d_pcm_exlug_£t_¦ave_·¿m_mšmax
(
¢d_pcm_exlug_t
 *
exlug
, 
ty³
, 
mš
, 
max
);

187 
¢d_pcm_exlug_£t_·¿m_lšk
(
¢d_pcm_exlug_t
 *
exlug
, 
ty³
,

188 
k“p_lšk
);

193 
__šlše__
 
	$¢d_pcm_exlug_£t_·¿m
(
¢d_pcm_exlug_t
 *
exlug
, 
ty³
, 
v®
)

195  
	`¢d_pcm_exlug_£t_·¿m_li¡
(
exlug
, 
ty³
, 1, &
v®
);

196 
	}
}

201 
__šlše__
 
	$¢d_pcm_exlug_£t_¦ave_·¿m
(
¢d_pcm_exlug_t
 *
exlug
, 
ty³
, 
v®
)

203  
	`¢d_pcm_exlug_£t_¦ave_·¿m_li¡
(
exlug
, 
ty³
, 1, &
v®
);

204 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_ioplug.h

31 #iâdeà
__ALSA_PCM_IOPLUG_H


32 
	#__ALSA_PCM_IOPLUG_H


	)

43 
	mSND_PCM_IOPLUG_HW_ACCESS
 = 0,

44 
	mSND_PCM_IOPLUG_HW_FORMAT
,

45 
	mSND_PCM_IOPLUG_HW_CHANNELS
,

46 
	mSND_PCM_IOPLUG_HW_RATE
,

47 
	mSND_PCM_IOPLUG_HW_PERIOD_BYTES
,

48 
	mSND_PCM_IOPLUG_HW_BUFFER_BYTES
,

49 
	mSND_PCM_IOPLUG_HW_PERIODS
,

50 
	mSND_PCM_IOPLUG_HW_PARAMS


54 
¢d_pcm_iİlug
 
	t¢d_pcm_iİlug_t
;

56 
¢d_pcm_iİlug_ÿÎback
 
	t¢d_pcm_iİlug_ÿÎback_t
;

57 #ifdeà
DOC_HIDDEN


59 
¢d_pcm_iİlug
 
	t¢d_pcm_iİlug_t
;

60 
¢d_pcm_iİlug_ÿÎback
 
	t¢d_pcm_iİlug_ÿÎback_t
;

66 
	#SND_PCM_IOPLUG_FLAG_LISTED
 (1<<0è

	)

67 
	#SND_PCM_IOPLUG_FLAG_MONOTONIC
 (1<<1è

	)

69 
	#SND_PCM_IOPLUG_FLAG_BOUNDARY_WA
 (1<<2)

	)

74 
	#SND_PCM_IOPLUG_VERSION_MAJOR
 1

	)

75 
	#SND_PCM_IOPLUG_VERSION_MINOR
 0

	)

76 
	#SND_PCM_IOPLUG_VERSION_TINY
 2

	)

80 
	#SND_PCM_IOPLUG_VERSION
 ((
SND_PCM_IOPLUG_VERSION_MAJOR
<<16) |\

81 (
SND_PCM_IOPLUG_VERSION_MINOR
<<8) |\

82 (
SND_PCM_IOPLUG_VERSION_TINY
))

	)

85 
	s¢d_pcm_iİlug
 {

90 
	mv”siÚ
;

94 cÚ¡ *
	mÇme
;

95 
	mæags
;

96 
	mpŞl_fd
;

97 
	mpŞl_ev’ts
;

98 
	mmm­_rw
;

102 cÚ¡ 
¢d_pcm_iİlug_ÿÎback_t
 *
	mÿÎback
;

106 *
	m´iv©e_d©a
;

110 
¢d_pcm_t
 *
	mpcm
;

112 
¢d_pcm_¡»am_t
 
	m¡»am
;

113 
¢d_pcm_¡©e_t
 
	m¡©e
;

114 vŞ©
¢d_pcm_uäames_t
 
	m­¶_±r
;

115 vŞ©
¢d_pcm_uäames_t
 
	mhw_±r
;

116 
	mnÚblock
;

118 
¢d_pcm_acûss_t
 
	macûss
;

119 
¢d_pcm_fÜm©_t
 
	mfÜm©
;

120 
	mchªÃls
;

121 
	m¿‹
;

122 
¢d_pcm_uäames_t
 
	m³riod_size
;

123 
¢d_pcm_uäames_t
 
	mbufãr_size
;

127 
	s¢d_pcm_iİlug_ÿÎback
 {

131 (*
	m¡¬t
)(
¢d_pcm_iİlug_t
 *
	mio
);

135 (*
	m¡İ
)(
¢d_pcm_iİlug_t
 *
	mio
);

142 
¢d_pcm_säames_t
 (*
poš‹r
)(
¢d_pcm_iİlug_t
 *
	mio
);

146 
¢d_pcm_säames_t
 (*
Œªsãr
)(
¢d_pcm_iİlug_t
 *
	mio
,

147 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
	m¬—s
,

148 
¢d_pcm_uäames_t
 
	moff£t
,

149 
¢d_pcm_uäames_t
 
	msize
);

153 (*
	mşo£
)(
¢d_pcm_iİlug_t
 *
	mio
);

157 (*
	mhw_·¿ms
)(
¢d_pcm_iİlug_t
 *
	mio
, 
¢d_pcm_hw_·¿ms_t
 *
	m·¿ms
);

161 (*
	mhw_ä“
)(
¢d_pcm_iİlug_t
 *
	mio
);

165 (*
	msw_·¿ms
)(
¢d_pcm_iİlug_t
 *
	mio
, 
¢d_pcm_sw_·¿ms_t
 *
	m·¿ms
);

169 (*
	m´•¬e
)(
¢d_pcm_iİlug_t
 *
	mio
);

173 (*
	md¿š
)(
¢d_pcm_iİlug_t
 *
	mio
);

177 (*
	m·u£
)(
¢d_pcm_iİlug_t
 *
	mio
, 
	m’abË
);

181 (*
	m»sume
)(
¢d_pcm_iİlug_t
 *
	mio
);

185 (*
	mpŞl_desütÜs_couÁ
)(
¢d_pcm_iİlug_t
 *
	mio
);

189 (*
	mpŞl_desütÜs
)(
¢d_pcm_iİlug_t
 *
	mio
, 
pŞlfd
 *
	mpfd
, 
	m¥aû
);

193 (*
	mpŞl_»v’ts
)(
¢d_pcm_iİlug_t
 *
	mio
, 
pŞlfd
 *
	mpfd
, 
	mnfds
, *
	m»v’ts
);

197 (*
	mdump
)(
¢d_pcm_iİlug_t
 *
	mio
, 
¢d_ouut_t
 *
	mout
);

201 (*
	md–ay
)(
¢d_pcm_iİlug_t
 *
	mio
, 
¢d_pcm_säames_t
 *
	md–ayp
);

205 
	m¢d_pcm_chm­_qu”y_t
 **(*
	mqu”y_chm­s
)(
¢d_pcm_iİlug_t
 *
	mio
);

209 
	m¢d_pcm_chm­_t
 *(*
	mg‘_chm­
)(
¢d_pcm_iİlug_t
 *
	mio
);

213 (*
	m£t_chm­
)(
¢d_pcm_iİlug_t
 *
	mio
, cÚ¡ 
¢d_pcm_chm­_t
 *
	mm­
);

217 
¢d_pcm_iİlug_ü—‹
(
¢d_pcm_iİlug_t
 *
io
, cÚ¡ *
Çme
,

218 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

219 
¢d_pcm_iİlug_d–‘e
(
¢d_pcm_iİlug_t
 *
io
);

222 
¢d_pcm_iİlug_»š™_¡©us
(
¢d_pcm_iİlug_t
 *
iİlug
);

225 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¢d_pcm_iİlug_mm­_¬—s
(
¢d_pcm_iİlug_t
 *
iİlug
);

228 
¢d_pcm_iİlug_·¿ms_»£t
(
¢d_pcm_iİlug_t
 *
io
);

231 
¢d_pcm_iİlug_£t_·¿m_mšmax
(
¢d_pcm_iİlug_t
 *
io
, 
ty³
, 
mš
, 
max
);

232 
¢d_pcm_iİlug_£t_·¿m_li¡
(
¢d_pcm_iİlug_t
 *
io
, 
ty³
, 
num_li¡
, cÚ¡ *
li¡
);

235 
¢d_pcm_iİlug_£t_¡©e
(
¢d_pcm_iİlug_t
 *
iİlug
, 
¢d_pcm_¡©e_t
 
¡©e
);

238 
¢d_pcm_uäames_t
 
¢d_pcm_iİlug_ava
(cÚ¡ 
¢d_pcm_iİlug_t
 * cÚ¡ 
iİlug
,

239 cÚ¡ 
¢d_pcm_uäames_t
 
hw_±r
,

240 cÚ¡ 
¢d_pcm_uäames_t
 
­¶_±r
);

241 
¢d_pcm_uäames_t
 
¢d_pcm_iİlug_hw_ava
(cÚ¡ 
¢d_pcm_iİlug_t
 * cÚ¡ 
iİlug
,

242 cÚ¡ 
¢d_pcm_uäames_t
 
hw_±r
,

243 cÚ¡ 
¢d_pcm_uäames_t
 
­¶_±r
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_old.h

5 
	#___symbŞ_v”siÚ
(
Çme
, 
v”siÚ
) \

6 
	`__asm__
 (".symv” " #Çm"," #Çm"@" 
v”siÚ
)

	)

8 #ifdeà
ALSA_PCM_OLD_HW_PARAMS_API


10 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_acûss
, "ALSA_0.9");

11 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_acûss_fœ¡
, "ALSA_0.9");

12 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_acûss_Ï¡
, "ALSA_0.9");

14 
¢d_pcm_hw_·¿ms_g‘_acûss
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

15 
¢d_pcm_hw_·¿ms_‹¡_acûss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 
v®
);

16 
¢d_pcm_hw_·¿ms_£t_acûss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 
v®
);

17 
¢d_pcm_acûss_t
 
¢d_pcm_hw_·¿ms_£t_acûss_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

18 
¢d_pcm_acûss_t
 
¢d_pcm_hw_·¿ms_£t_acûss_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

19 
¢d_pcm_hw_·¿ms_£t_acûss_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_mask_t
 *
mask
);

20 
¢d_pcm_hw_·¿ms_g‘_acûss_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_mask_t
 *
mask
);

22 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
, "ALSA_0.9");

23 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_fÜm©_fœ¡
, "ALSA_0.9");

24 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_fÜm©_Ï¡
, "ALSA_0.9");

26 
¢d_pcm_hw_·¿ms_g‘_fÜm©
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

27 
¢d_pcm_hw_·¿ms_‹¡_fÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 
v®
);

28 
¢d_pcm_hw_·¿ms_£t_fÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 
v®
);

29 
¢d_pcm_fÜm©_t
 
¢d_pcm_hw_·¿ms_£t_fÜm©_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

30 
¢d_pcm_fÜm©_t
 
¢d_pcm_hw_·¿ms_£t_fÜm©_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

31 
¢d_pcm_hw_·¿ms_£t_fÜm©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_mask_t
 *
mask
);

32 
¢d_pcm_hw_·¿ms_g‘_fÜm©_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_mask_t
 *
mask
);

34 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_subfÜm©
, "ALSA_0.9");

35 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_subfÜm©_fœ¡
, "ALSA_0.9");

36 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_subfÜm©_Ï¡
, "ALSA_0.9");

38 
¢d_pcm_hw_·¿ms_‹¡_subfÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 
v®
);

39 
¢d_pcm_hw_·¿ms_g‘_subfÜm©
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

40 
¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 
v®
);

41 
¢d_pcm_subfÜm©_t
 
¢d_pcm_hw_·¿ms_£t_subfÜm©_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

42 
¢d_pcm_subfÜm©_t
 
¢d_pcm_hw_·¿ms_£t_subfÜm©_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

43 
¢d_pcm_hw_·¿ms_£t_subfÜm©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_mask_t
 *
mask
);

44 
¢d_pcm_hw_·¿ms_g‘_subfÜm©_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_mask_t
 *
mask
);

46 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_chªÃls
, "ALSA_0.9");

47 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_chªÃls_mš
, "ALSA_0.9");

48 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_chªÃls_max
, "ALSA_0.9");

49 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_chªÃls_Ã¬
, "ALSA_0.9");

50 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_chªÃls_fœ¡
, "ALSA_0.9");

51 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_chªÃls_Ï¡
, "ALSA_0.9");

53 
¢d_pcm_hw_·¿ms_g‘_chªÃls
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

54 
¢d_pcm_hw_·¿ms_g‘_chªÃls_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

55 
¢d_pcm_hw_·¿ms_g‘_chªÃls_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

56 
¢d_pcm_hw_·¿ms_‹¡_chªÃls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
);

57 
¢d_pcm_hw_·¿ms_£t_chªÃls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
);

58 
¢d_pcm_hw_·¿ms_£t_chªÃls_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

59 
¢d_pcm_hw_·¿ms_£t_chªÃls_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

60 
¢d_pcm_hw_·¿ms_£t_chªÃls_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
max
);

61 
¢d_pcm_hw_·¿ms_£t_chªÃls_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
);

62 
¢d_pcm_hw_·¿ms_£t_chªÃls_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

63 
¢d_pcm_hw_·¿ms_£t_chªÃls_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

65 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_¿‹
, "ALSA_0.9");

66 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_¿‹_mš
, "ALSA_0.9");

67 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_¿‹_max
, "ALSA_0.9");

68 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_¿‹_Ã¬
, "ALSA_0.9");

69 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_¿‹_fœ¡
, "ALSA_0.9");

70 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_¿‹_Ï¡
, "ALSA_0.9");

72 
¢d_pcm_hw_·¿ms_g‘_¿‹
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

73 
¢d_pcm_hw_·¿ms_g‘_¿‹_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

74 
¢d_pcm_hw_·¿ms_g‘_¿‹_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

75 
¢d_pcm_hw_·¿ms_‹¡_¿‹
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

76 
¢d_pcm_hw_·¿ms_£t_¿‹
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

77 
¢d_pcm_hw_·¿ms_£t_¿‹_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

78 
¢d_pcm_hw_·¿ms_£t_¿‹_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

79 
¢d_pcm_hw_·¿ms_£t_¿‹_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
);

80 
¢d_pcm_hw_·¿ms_£t_¿‹_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, *
dœ
);

81 
¢d_pcm_hw_·¿ms_£t_¿‹_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

82 
¢d_pcm_hw_·¿ms_£t_¿‹_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

83 
¢d_pcm_hw_·¿ms_£t_¿‹_»§m¶e
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
);

84 
¢d_pcm_hw_·¿ms_g‘_¿‹_»§m¶e
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

86 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_³riod_time
, "ALSA_0.9");

87 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_³riod_time_mš
, "ALSA_0.9");

88 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_³riod_time_max
, "ALSA_0.9");

89 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_³riod_time_Ã¬
, "ALSA_0.9");

90 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_³riod_time_fœ¡
, "ALSA_0.9");

91 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_³riod_time_Ï¡
, "ALSA_0.9");

93 
¢d_pcm_hw_·¿ms_g‘_³riod_time
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

94 
¢d_pcm_hw_·¿ms_g‘_³riod_time_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

95 
¢d_pcm_hw_·¿ms_g‘_³riod_time_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

96 
¢d_pcm_hw_·¿ms_‹¡_³riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

97 
¢d_pcm_hw_·¿ms_£t_³riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

98 
¢d_pcm_hw_·¿ms_£t_³riod_time_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

99 
¢d_pcm_hw_·¿ms_£t_³riod_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

100 
¢d_pcm_hw_·¿ms_£t_³riod_time_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
);

101 
¢d_pcm_hw_·¿ms_£t_³riod_time_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, *
dœ
);

102 
¢d_pcm_hw_·¿ms_£t_³riod_time_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

103 
¢d_pcm_hw_·¿ms_£t_³riod_time_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

105 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_³riod_size
, "ALSA_0.9");

106 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_³riod_size_mš
, "ALSA_0.9");

107 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_³riod_size_max
, "ALSA_0.9");

108 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_³riod_size_Ã¬
, "ALSA_0.9");

109 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_³riod_size_fœ¡
, "ALSA_0.9");

110 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_³riod_size_Ï¡
, "ALSA_0.9");

112 
¢d_pcm_säames_t
 
¢d_pcm_hw_·¿ms_g‘_³riod_size
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

113 
¢d_pcm_uäames_t
 
¢d_pcm_hw_·¿ms_g‘_³riod_size_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

114 
¢d_pcm_uäames_t
 
¢d_pcm_hw_·¿ms_g‘_³riod_size_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

115 
¢d_pcm_hw_·¿ms_‹¡_³riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
, 
dœ
);

116 
¢d_pcm_hw_·¿ms_£t_³riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
, 
dœ
);

117 
¢d_pcm_hw_·¿ms_£t_³riod_size_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
);

118 
¢d_pcm_hw_·¿ms_£t_³riod_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
);

119 
¢d_pcm_hw_·¿ms_£t_³riod_size_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
mš
, *
mšdœ
, snd_pcm_uäames_ˆ*
max
, *
maxdœ
);

120 
¢d_pcm_uäames_t
 
¢d_pcm_hw_·¿ms_£t_³riod_size_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, snd_pcm_uäames_ˆ
v®
, *
dœ
);

121 
¢d_pcm_uäames_t
 
¢d_pcm_hw_·¿ms_£t_³riod_size_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

122 
¢d_pcm_uäames_t
 
¢d_pcm_hw_·¿ms_£t_³riod_size_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

123 
¢d_pcm_hw_·¿ms_£t_³riod_size_š‹g”
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

125 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_³riods
, "ALSA_0.9");

126 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_³riods_mš
, "ALSA_0.9");

127 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_³riods_max
, "ALSA_0.9");

128 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_³riods_Ã¬
, "ALSA_0.9");

129 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_³riods_fœ¡
, "ALSA_0.9");

130 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_³riods_Ï¡
, "ALSA_0.9");

132 
¢d_pcm_hw_·¿ms_g‘_³riods
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

133 
¢d_pcm_hw_·¿ms_g‘_³riods_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

134 
¢d_pcm_hw_·¿ms_g‘_³riods_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

135 
¢d_pcm_hw_·¿ms_‹¡_³riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

136 
¢d_pcm_hw_·¿ms_£t_³riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

137 
¢d_pcm_hw_·¿ms_£t_³riods_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

138 
¢d_pcm_hw_·¿ms_£t_³riods_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

139 
¢d_pcm_hw_·¿ms_£t_³riods_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
);

140 
¢d_pcm_hw_·¿ms_£t_³riods_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, *
dœ
);

141 
¢d_pcm_hw_·¿ms_£t_³riods_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

142 
¢d_pcm_hw_·¿ms_£t_³riods_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

143 
¢d_pcm_hw_·¿ms_£t_³riods_š‹g”
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

145 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time
, "ALSA_0.9");

146 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time_mš
, "ALSA_0.9");

147 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time_max
, "ALSA_0.9");

148 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ã¬
, "ALSA_0.9");

149 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_fœ¡
, "ALSA_0.9");

150 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ï¡
, "ALSA_0.9");

152 
¢d_pcm_hw_·¿ms_g‘_bufãr_time
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

153 
¢d_pcm_hw_·¿ms_g‘_bufãr_time_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

154 
¢d_pcm_hw_·¿ms_g‘_bufãr_time_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

155 
¢d_pcm_hw_·¿ms_‹¡_bufãr_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

156 
¢d_pcm_hw_·¿ms_£t_bufãr_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

157 
¢d_pcm_hw_·¿ms_£t_bufãr_time_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

158 
¢d_pcm_hw_·¿ms_£t_bufãr_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

159 
¢d_pcm_hw_·¿ms_£t_bufãr_time_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
);

160 
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, *
dœ
);

161 
¢d_pcm_hw_·¿ms_£t_bufãr_time_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

162 
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

164 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size
, "ALSA_0.9");

165 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size_mš
, "ALSA_0.9");

166 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size_max
, "ALSA_0.9");

167 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ã¬
, "ALSA_0.9");

168 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_fœ¡
, "ALSA_0.9");

169 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ï¡
, "ALSA_0.9");

171 
¢d_pcm_säames_t
 
¢d_pcm_hw_·¿ms_g‘_bufãr_size
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

172 
¢d_pcm_uäames_t
 
¢d_pcm_hw_·¿ms_g‘_bufãr_size_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

173 
¢d_pcm_uäames_t
 
¢d_pcm_hw_·¿ms_g‘_bufãr_size_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

174 
¢d_pcm_hw_·¿ms_‹¡_bufãr_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

175 
¢d_pcm_hw_·¿ms_£t_bufãr_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

176 
¢d_pcm_hw_·¿ms_£t_bufãr_size_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

177 
¢d_pcm_hw_·¿ms_£t_bufãr_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

178 
¢d_pcm_hw_·¿ms_£t_bufãr_size_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
mš
, snd_pcm_uäames_ˆ*
max
);

179 
¢d_pcm_uäames_t
 
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, snd_pcm_uäames_ˆ
v®
);

180 
¢d_pcm_uäames_t
 
¢d_pcm_hw_·¿ms_£t_bufãr_size_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

181 
¢d_pcm_uäames_t
 
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

183 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_tick_time
, "ALSA_0.9");

184 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_tick_time_mš
, "ALSA_0.9");

185 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_g‘_tick_time_max
, "ALSA_0.9");

186 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_tick_time_Ã¬
, "ALSA_0.9");

187 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_tick_time_fœ¡
, "ALSA_0.9");

188 
___symbŞ_v”siÚ
(
¢d_pcm_hw_·¿ms_£t_tick_time_Ï¡
, "ALSA_0.9");

190 
¢d_pcm_hw_·¿ms_g‘_tick_time
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

191 
¢d_pcm_hw_·¿ms_g‘_tick_time_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

192 
¢d_pcm_hw_·¿ms_g‘_tick_time_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

193 
¢d_pcm_hw_·¿ms_‹¡_tick_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

194 
¢d_pcm_hw_·¿ms_£t_tick_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

195 
¢d_pcm_hw_·¿ms_£t_tick_time_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

196 
¢d_pcm_hw_·¿ms_£t_tick_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

197 
¢d_pcm_hw_·¿ms_£t_tick_time_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
);

198 
¢d_pcm_hw_·¿ms_£t_tick_time_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, *
dœ
);

199 
¢d_pcm_hw_·¿ms_£t_tick_time_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

200 
¢d_pcm_hw_·¿ms_£t_tick_time_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
);

205 #ifdeà
ALSA_PCM_OLD_SW_PARAMS_API


207 
___symbŞ_v”siÚ
(
¢d_pcm_sw_·¿ms_g‘_t¡amp_mode
, "ALSA_0.9");

208 
___symbŞ_v”siÚ
(
¢d_pcm_sw_·¿ms_g‘_¦“p_mš
, "ALSA_0.9");

209 
___symbŞ_v”siÚ
(
¢d_pcm_sw_·¿ms_g‘_ava_mš
, "ALSA_0.9");

210 
___symbŞ_v”siÚ
(
¢d_pcm_sw_·¿ms_g‘_xãr_®ign
, "ALSA_0.9");

211 
___symbŞ_v”siÚ
(
¢d_pcm_sw_·¿ms_g‘_¡¬t_th»shŞd
, "ALSA_0.9");

212 
___symbŞ_v”siÚ
(
¢d_pcm_sw_·¿ms_g‘_¡İ_th»shŞd
, "ALSA_0.9");

213 
___symbŞ_v”siÚ
(
¢d_pcm_sw_·¿ms_g‘_s’û_th»shŞd
, "ALSA_0.9");

214 
___symbŞ_v”siÚ
(
¢d_pcm_sw_·¿ms_g‘_s’û_size
, "ALSA_0.9");

216 
¢d_pcm_sw_·¿ms_£t_t¡amp_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_t¡amp_t
 
v®
);

217 
¢d_pcm_t¡amp_t
 
¢d_pcm_sw_·¿ms_g‘_t¡amp_mode
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
);

218 
¢d_pcm_sw_·¿ms_£t_¦“p_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
v®
);

219 
¢d_pcm_sw_·¿ms_g‘_¦“p_mš
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
);

220 
¢d_pcm_sw_·¿ms_£t_ava_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

221 
¢d_pcm_uäames_t
 
¢d_pcm_sw_·¿ms_g‘_ava_mš
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
);

222 
¢d_pcm_sw_·¿ms_£t_xãr_®ign
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

223 
¢d_pcm_uäames_t
 
¢d_pcm_sw_·¿ms_g‘_xãr_®ign
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
);

224 
¢d_pcm_sw_·¿ms_£t_¡¬t_th»shŞd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

225 
¢d_pcm_uäames_t
 
¢d_pcm_sw_·¿ms_g‘_¡¬t_th»shŞd
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
);

226 
¢d_pcm_sw_·¿ms_£t_¡İ_th»shŞd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

227 
¢d_pcm_uäames_t
 
¢d_pcm_sw_·¿ms_g‘_¡İ_th»shŞd
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
);

228 
¢d_pcm_sw_·¿ms_£t_s’û_th»shŞd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

229 
¢d_pcm_uäames_t
 
¢d_pcm_sw_·¿ms_g‘_s’û_th»shŞd
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
);

230 
¢d_pcm_sw_·¿ms_£t_s’û_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

231 
¢d_pcm_uäames_t
 
¢d_pcm_sw_·¿ms_g‘_s’û_size
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_plugin.h

32 #iâdeà
__ALSA_PCM_PLUGIN_H


33 
	#__ALSA_PCM_PLUGIN_H


	)

42 
	#SND_PCM_PLUGIN_RATE_MIN
 4000

	)

43 
	#SND_PCM_PLUGIN_RATE_MAX
 768000

	)

46 #ifdeà
HAVE_SOFT_FLOAT


47 
	#SND_PCM_PLUGIN_ROUTE_FLOAT
 0

	)

49 
	#SND_PCM_PLUGIN_ROUTE_FLOAT
 1

	)

52 
	#SND_PCM_PLUGIN_ROUTE_RESOLUTION
 16

	)

54 #ià
SND_PCM_PLUGIN_ROUTE_FLOAT


56 
	t¢d_pcm_rou‹_‰abË_’Œy_t
;

57 
	#SND_PCM_PLUGIN_ROUTE_HALF
 0.5

	)

58 
	#SND_PCM_PLUGIN_ROUTE_FULL
 1.0

	)

61 
	t¢d_pcm_rou‹_‰abË_’Œy_t
;

62 
	#SND_PCM_PLUGIN_ROUTE_HALF
 (
SND_PCM_PLUGIN_ROUTE_RESOLUTION
 / 2è

	)

63 
	#SND_PCM_PLUGIN_ROUTE_FULL
 
SND_PCM_PLUGIN_ROUTE_RESOLUTION


	)

69 
¢d_pcm_hw_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

70 
ÿrd
, 
deviû
, 
subdeviû
,

71 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
,

72 
mm­_emuÏtiÚ
, 
sync_±r_ioùl
);

73 
_¢d_pcm_hw_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

74 
¢d_cÚfig_t
 *
roÙ
 
ATTRIBUTE_UNUSED
, snd_cÚfig_ˆ*
cÚf
,

75 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

80 
¢d_pcm_cİy_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

81 
¢d_pcm_t
 *
¦ave
, 
şo£_¦ave
);

82 
_¢d_pcm_cİy_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

83 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

84 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

89 
¢d_pcm_lš—r_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

90 
¢d_pcm_fÜm©_t
 
sfÜm©
, 
¢d_pcm_t
 *
¦ave
,

91 
şo£_¦ave
);

92 
_¢d_pcm_lš—r_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

93 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

94 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

99 
¢d_pcm_læßt_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

100 
¢d_pcm_fÜm©_t
 
sfÜm©
, 
¢d_pcm_t
 *
¦ave
,

101 
şo£_¦ave
);

102 
_¢d_pcm_læßt_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

103 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

104 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

109 
¢d_pcm_muÏw_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

110 
¢d_pcm_fÜm©_t
 
sfÜm©
, 
¢d_pcm_t
 *
¦ave
,

111 
şo£_¦ave
);

112 
_¢d_pcm_muÏw_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

113 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

114 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

119 
¢d_pcm_®aw_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

120 
¢d_pcm_fÜm©_t
 
sfÜm©
, 
¢d_pcm_t
 *
¦ave
,

121 
şo£_¦ave
);

122 
_¢d_pcm_®aw_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

123 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

124 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

129 
¢d_pcm_adpcm_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

130 
¢d_pcm_fÜm©_t
 
sfÜm©
, 
¢d_pcm_t
 *
¦ave
,

131 
şo£_¦ave
);

132 
_¢d_pcm_adpcm_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

133 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

134 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

139 
¢d_pcm_›c958_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

140 
¢d_pcm_fÜm©_t
 
sfÜm©
, 
¢d_pcm_t
 *
¦ave
,

141 
şo£_¦ave
,

142 cÚ¡ *
¡©us_b™s
,

143 cÚ¡ *
´—mbË_v®s
,

144 
hdmi_mode
);

145 
_¢d_pcm_›c958_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

146 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

147 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

152 
¢d_pcm_rou‹_lßd_‰abË
(
¢d_cÚfig_t
 *
‰
, 
¢d_pcm_rou‹_‰abË_’Œy_t
 *
‰abË
,

153 
‰_csize
, 
‰_ssize
,

154 *
‰_cu£d
, *
‰_su£d
,

155 
schªÃls
);

156 
¢d_pcm_rou‹_d‘”mše_‰abË
(
¢d_cÚfig_t
 *
‰
,

157 *
‰_csize
,

158 *
‰_ssize
);

159 
¢d_pcm_rou‹_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

160 
¢d_pcm_fÜm©_t
 
sfÜm©
, 
schªÃls
,

161 
¢d_pcm_rou‹_‰abË_’Œy_t
 *
‰abË
,

162 
‰_ssize
,

163 
‰_cu£d
, 
‰_su£d
,

164 
¢d_pcm_t
 *
¦ave
, 
şo£_¦ave
);

165 
_¢d_pcm_rou‹_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

166 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

167 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

172 
¢d_pcm_¿‹_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

173 
¢d_pcm_fÜm©_t
 
sfÜm©
, 
¤©e
,

174 cÚ¡ 
¢d_cÚfig_t
 *
cÚv”‹r
,

175 
¢d_pcm_t
 *
¦ave
, 
şo£_¦ave
);

176 
_¢d_pcm_¿‹_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

177 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

178 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

183 
¢d_pcm_hooks_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

184 
¢d_pcm_t
 *
¦ave
, 
şo£_¦ave
);

185 
_¢d_pcm_hooks_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

186 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

187 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

192 
¢d_pcm_Ïd¥a_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

193 cÚ¡ *
Ïd¥a_·th
,

194 
chªÃls
,

195 
¢d_cÚfig_t
 *
Ïd¥a_µlugšs
,

196 
¢d_cÚfig_t
 *
Ïd¥a_ılugšs
,

197 
¢d_pcm_t
 *
¦ave
, 
şo£_¦ave
);

198 
_¢d_pcm_Ïd¥a_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

199 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

200 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

205 
¢d_pcm_jack_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

206 
¢d_cÚfig_t
 *
¶ayback_cÚf
,

207 
¢d_cÚfig_t
 *
ÿ±u»_cÚf
,

208 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

209 
_¢d_pcm_jack_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

210 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

211 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_rate.h

31 #iâdeà
__ALSA_PCM_RATE_H


32 
	#__ALSA_PCM_RATE_H


	)

34 #ifdeà
__ılu¥lus


41 
	#SND_PCM_RATE_PLUGIN_VERSION
 0x010003

	)

44 
	s¢d_pcm_¿‹_side_šfo
 {

45 
¢d_pcm_fÜm©_t
 
fÜm©
;

46 
¿‹
;

47 
¢d_pcm_uäames_t
 
bufãr_size
;

48 
¢d_pcm_uäames_t
 
³riod_size
;

49 } 
	t¢d_pcm_¿‹_side_šfo_t
;

52 
	s¢d_pcm_¿‹_šfo
 {

53 
¢d_pcm_¿‹_side_šfo
 
š
;

54 
¢d_pcm_¿‹_side_šfo
 
out
;

55 
chªÃls
;

56 } 
	t¢d_pcm_¿‹_šfo_t
;

59 
SND_PCM_RATE_FLAG_INTERLEAVED
 = (1U << 0),

60 
SND_PCM_RATE_FLAG_SYNC_FORMATS
 = (1U << 1),

64 
	s¢d_pcm_¿‹_İs
 {

68 (*
şo£
)(*
obj
);

72 (*
š™
)(*
obj
, 
¢d_pcm_¿‹_šfo_t
 *
šfo
);

76 (*
ä“
)(*
obj
);

80 (*
»£t
)(*
obj
);

84 (*
adju¡_p™ch
)(*
obj
, 
¢d_pcm_¿‹_šfo_t
 *
šfo
);

88 (*
cÚv”t
)(*
obj
,

89 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

90 
¢d_pcm_uäames_t
 
d¡_off£t
, 
d¡_äames
,

91 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

92 
¢d_pcm_uäames_t
 
¤c_off£t
, 
¤c_äames
);

96 (*
cÚv”t_s16
)(*
obj
, 
št16_t
 *
d¡
, 
d¡_äames
,

97 cÚ¡ 
št16_t
 *
¤c
, 
¤c_äames
);

101 
¢d_pcm_uäames_t
 (*
šput_äames
)(*
obj
, snd_pcm_uäames_ˆ
äames
);

105 
¢d_pcm_uäames_t
 (*
ouut_äames
)(*
obj
, snd_pcm_uäames_ˆ
äames
);

110 
v”siÚ
;

115 (*
g‘_suµÜ‹d_¿‹s
)(*
obj
, *
¿‹_mš
,

116 *
¿‹_max
);

121 (*
dump
)(*
obj
, 
¢d_ouut_t
 *
out
);

126 (*
g‘_suµÜ‹d_fÜm©s
)(*
obj
, 
ušt64_t
 *
š_fÜm©s
,

127 
ušt64_t
 *
out_fÜm©s
,

128 *
æags
);

129 } 
	t¢d_pcm_¿‹_İs_t
;

132 (*
¢d_pcm_¿‹_İ’_func_t
)(
	tv”siÚ
, **
	tobjp
,

133 
	t¢d_pcm_¿‹_İs_t
 *
	tİ¥
);

135 (*
¢d_pcm_¿‹_İ’_cÚf_func_t
)(
	tv”siÚ
, **
	tobjp
,

136 
	t¢d_pcm_¿‹_İs_t
 *
	tİ¥
, cÚ¡ 
	t¢d_cÚfig_t
 *
	tcÚf
);

141 
	#SND_PCM_RATE_PLUGIN_ENTRY
(
Çme
è
_¢d_pcm_¿‹_
##Çme##
_İ’


	)

142 
	#SND_PCM_RATE_PLUGIN_CONF_ENTRY
(
Çme
è
_¢d_pcm_¿‹_
##Çme##
_İ’_cÚf


	)

144 #iâdeà
DOC_HIDDEN


146 
	s¢d_pcm_¿‹_Şd_İs
 {

147 (*
şo£
)(*
obj
);

148 (*
š™
)(*
obj
, 
¢d_pcm_¿‹_šfo_t
 *
šfo
);

149 (*
ä“
)(*
obj
);

150 (*
»£t
)(*
obj
);

151 (*
adju¡_p™ch
)(*
obj
, 
¢d_pcm_¿‹_šfo_t
 *
šfo
);

152 (*
cÚv”t
)(*
obj
,

153 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

154 
¢d_pcm_uäames_t
 
d¡_off£t
, 
d¡_äames
,

155 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

156 
¢d_pcm_uäames_t
 
¤c_off£t
, 
¤c_äames
);

157 (*
cÚv”t_s16
)(*
obj
, 
št16_t
 *
d¡
, 
d¡_äames
,

158 cÚ¡ 
št16_t
 *
¤c
, 
¤c_äames
);

159 
¢d_pcm_uäames_t
 (*
šput_äames
)(*
obj
, snd_pcm_uäames_ˆ
äames
);

160 
¢d_pcm_uäames_t
 (*
ouut_äames
)(*
obj
, snd_pcm_uäames_ˆ
äames
);

161 } 
	t¢d_pcm_¿‹_Şd_İs_t
;

164 
	s¢d_pcm_¿‹_v2_İs
 {

165 (*
şo£
)(*
obj
);

166 (*
š™
)(*
obj
, 
¢d_pcm_¿‹_šfo_t
 *
šfo
);

167 (*
ä“
)(*
obj
);

168 (*
»£t
)(*
obj
);

169 (*
adju¡_p™ch
)(*
obj
, 
¢d_pcm_¿‹_šfo_t
 *
šfo
);

170 (*
cÚv”t
)(*
obj
,

171 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

172 
¢d_pcm_uäames_t
 
d¡_off£t
, 
d¡_äames
,

173 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

174 
¢d_pcm_uäames_t
 
¤c_off£t
, 
¤c_äames
);

175 (*
cÚv”t_s16
)(*
obj
, 
št16_t
 *
d¡
, 
d¡_äames
,

176 cÚ¡ 
št16_t
 *
¤c
, 
¤c_äames
);

177 
¢d_pcm_uäames_t
 (*
šput_äames
)(*
obj
, snd_pcm_uäames_ˆ
äames
);

178 
¢d_pcm_uäames_t
 (*
ouut_äames
)(*
obj
, snd_pcm_uäames_ˆ
äames
);

179 
v”siÚ
;

180 (*
g‘_suµÜ‹d_¿‹s
)(*
obj
, *
¿‹_mš
,

181 *
¿‹_max
);

182 (*
dump
)(*
obj
, 
¢d_ouut_t
 *
out
);

183 } 
	t¢d_pcm_¿‹_v2_İs_t
;

186 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/rawmidi.h

28 #iâdeà
__ALSA_RAWMIDI_H


29 
	#__ALSA_RAWMIDI_H


	)

31 #ifdeà
__ılu¥lus


42 
	#SND_RAWMIDI_DLSYM_VERSION
 
_dlsym_¿wmidi_001


	)

45 
_¢d_¿wmidi_šfo
 
	t¢d_¿wmidi_šfo_t
;

47 
_¢d_¿wmidi_·¿ms
 
	t¢d_¿wmidi_·¿ms_t
;

49 
_¢d_¿wmidi_¡©us
 
	t¢d_¿wmidi_¡©us_t
;

52 
	e_¢d_¿wmidi_¡»am
 {

54 
SND_RAWMIDI_STREAM_OUTPUT
 = 0,

56 
SND_RAWMIDI_STREAM_INPUT
,

57 
SND_RAWMIDI_STREAM_LAST
 = 
SND_RAWMIDI_STREAM_INPUT


58 } 
	t¢d_¿wmidi_¡»am_t
;

61 
	#SND_RAWMIDI_APPEND
 0x0001

	)

63 
	#SND_RAWMIDI_NONBLOCK
 0x0002

	)

65 
	#SND_RAWMIDI_SYNC
 0x0004

	)

68 
_¢d_¿wmidi
 
	t¢d_¿wmidi_t
;

71 
	e_¢d_¿wmidi_ty³
 {

73 
SND_RAWMIDI_TYPE_HW
,

75 
SND_RAWMIDI_TYPE_SHM
,

77 
SND_RAWMIDI_TYPE_INET
,

79 
SND_RAWMIDI_TYPE_VIRTUAL


80 } 
	t¢d_¿wmidi_ty³_t
;

83 
	e_¢d_¿wmidi_şock
 {

84 
SND_RAWMIDI_CLOCK_NONE
 = 0,

85 
SND_RAWMIDI_CLOCK_REALTIME
 = 1,

86 
SND_RAWMIDI_CLOCK_MONOTONIC
 = 2,

87 
SND_RAWMIDI_CLOCK_MONOTONIC_RAW
 = 3,

88 } 
	t¢d_¿wmidi_şock_t
;

91 
	e_¢d_¿wmidi_»ad_mode
 {

92 
SND_RAWMIDI_READ_STANDARD
 = 0,

93 
SND_RAWMIDI_READ_TSTAMP
 = 1,

94 } 
	t¢d_¿wmidi_»ad_mode_t
;

97 
	#SND_RAWMIDI_INFO_UMP
 0x00000008

	)

99 
¢d_¿wmidi_İ’
(
¢d_¿wmidi_t
 **
š_rmidi
, snd_¿wmidi_ˆ**
out_rmidi
,

100 cÚ¡ *
Çme
, 
mode
);

101 
¢d_¿wmidi_İ’_lcÚf
(
¢d_¿wmidi_t
 **
š_rmidi
, snd_¿wmidi_ˆ**
out_rmidi
,

102 cÚ¡ *
Çme
, 
mode
, 
¢d_cÚfig_t
 *
lcÚf
);

103 
¢d_¿wmidi_şo£
(
¢d_¿wmidi_t
 *
rmidi
);

104 
¢d_¿wmidi_pŞl_desütÜs_couÁ
(
¢d_¿wmidi_t
 *
rmidi
);

105 
¢d_¿wmidi_pŞl_desütÜs
(
¢d_¿wmidi_t
 *
rmidi
, 
pŞlfd
 *
pfds
, 
¥aû
);

106 
¢d_¿wmidi_pŞl_desütÜs_»v’ts
(
¢d_¿wmidi_t
 *
¿wmidi
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’t
);

107 
¢d_¿wmidi_nÚblock
(
¢d_¿wmidi_t
 *
rmidi
, 
nÚblock
);

108 
size_t
 
¢d_¿wmidi_šfo_sizeof
();

113 
	#¢d_¿wmidi_šfo_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_¿wmidi_šfo
)

	)

114 
¢d_¿wmidi_šfo_m®loc
(
¢d_¿wmidi_šfo_t
 **
±r
);

115 
¢d_¿wmidi_šfo_ä“
(
¢d_¿wmidi_šfo_t
 *
obj
);

116 
¢d_¿wmidi_šfo_cİy
(
¢d_¿wmidi_šfo_t
 *
d¡
, cÚ¡ snd_¿wmidi_šfo_ˆ*
¤c
);

117 
¢d_¿wmidi_šfo_g‘_deviû
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
obj
);

118 
¢d_¿wmidi_šfo_g‘_subdeviû
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
obj
);

119 
¢d_¿wmidi_¡»am_t
 
¢d_¿wmidi_šfo_g‘_¡»am
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
obj
);

120 
¢d_¿wmidi_šfo_g‘_ÿrd
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
obj
);

121 
¢d_¿wmidi_šfo_g‘_æags
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
obj
);

122 cÚ¡ *
¢d_¿wmidi_šfo_g‘_id
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
obj
);

123 cÚ¡ *
¢d_¿wmidi_šfo_g‘_Çme
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
obj
);

124 cÚ¡ *
¢d_¿wmidi_šfo_g‘_subdeviû_Çme
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
obj
);

125 
¢d_¿wmidi_šfo_g‘_subdeviûs_couÁ
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
obj
);

126 
¢d_¿wmidi_šfo_g‘_subdeviûs_ava
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
obj
);

127 
¢d_¿wmidi_šfo_£t_deviû
(
¢d_¿wmidi_šfo_t
 *
obj
, 
v®
);

128 
¢d_¿wmidi_šfo_£t_subdeviû
(
¢d_¿wmidi_šfo_t
 *
obj
, 
v®
);

129 
¢d_¿wmidi_šfo_£t_¡»am
(
¢d_¿wmidi_šfo_t
 *
obj
, 
¢d_¿wmidi_¡»am_t
 
v®
);

130 
¢d_¿wmidi_šfo
(
¢d_¿wmidi_t
 *
rmidi
, 
¢d_¿wmidi_šfo_t
 * 
šfo
);

131 
size_t
 
¢d_¿wmidi_·¿ms_sizeof
();

136 
	#¢d_¿wmidi_·¿ms_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_¿wmidi_·¿ms
)

	)

137 
¢d_¿wmidi_·¿ms_m®loc
(
¢d_¿wmidi_·¿ms_t
 **
±r
);

138 
¢d_¿wmidi_·¿ms_ä“
(
¢d_¿wmidi_·¿ms_t
 *
obj
);

139 
¢d_¿wmidi_·¿ms_cİy
(
¢d_¿wmidi_·¿ms_t
 *
d¡
, cÚ¡ snd_¿wmidi_·¿ms_ˆ*
¤c
);

140 
¢d_¿wmidi_·¿ms_£t_bufãr_size
(
¢d_¿wmidi_t
 *
rmidi
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
, 
size_t
 
v®
);

141 
size_t
 
¢d_¿wmidi_·¿ms_g‘_bufãr_size
(cÚ¡ 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
);

142 
¢d_¿wmidi_·¿ms_£t_ava_mš
(
¢d_¿wmidi_t
 *
rmidi
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
, 
size_t
 
v®
);

143 
size_t
 
¢d_¿wmidi_·¿ms_g‘_ava_mš
(cÚ¡ 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
);

144 
¢d_¿wmidi_·¿ms_£t_no_aùive_£nsšg
(
¢d_¿wmidi_t
 *
rmidi
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
, 
v®
);

145 
¢d_¿wmidi_·¿ms_g‘_no_aùive_£nsšg
(cÚ¡ 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
);

146 
¢d_¿wmidi_·¿ms_£t_»ad_mode
(cÚ¡ 
¢d_¿wmidi_t
 *
¿wmidi
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
, 
¢d_¿wmidi_»ad_mode_t
 
v®
);

147 
¢d_¿wmidi_»ad_mode_t
 
¢d_¿wmidi_·¿ms_g‘_»ad_mode
(cÚ¡ 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
);

148 
¢d_¿wmidi_·¿ms_£t_şock_ty³
(cÚ¡ 
¢d_¿wmidi_t
 *
¿wmidi
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
, 
¢d_¿wmidi_şock_t
 
v®
);

149 
¢d_¿wmidi_şock_t
 
¢d_¿wmidi_·¿ms_g‘_şock_ty³
(cÚ¡ 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
);

151 
¢d_¿wmidi_·¿ms
(
¢d_¿wmidi_t
 *
rmidi
, 
¢d_¿wmidi_·¿ms_t
 * 
·¿ms
);

152 
¢d_¿wmidi_·¿ms_cu¼’t
(
¢d_¿wmidi_t
 *
rmidi
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
);

153 
size_t
 
¢d_¿wmidi_¡©us_sizeof
();

158 
	#¢d_¿wmidi_¡©us_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_¿wmidi_¡©us
)

	)

159 
¢d_¿wmidi_¡©us_m®loc
(
¢d_¿wmidi_¡©us_t
 **
±r
);

160 
¢d_¿wmidi_¡©us_ä“
(
¢d_¿wmidi_¡©us_t
 *
obj
);

161 
¢d_¿wmidi_¡©us_cİy
(
¢d_¿wmidi_¡©us_t
 *
d¡
, cÚ¡ snd_¿wmidi_¡©us_ˆ*
¤c
);

162 
¢d_¿wmidi_¡©us_g‘_t¡amp
(cÚ¡ 
¢d_¿wmidi_¡©us_t
 *
obj
, 
¢d_htime¡amp_t
 *
±r
);

163 
size_t
 
¢d_¿wmidi_¡©us_g‘_ava
(cÚ¡ 
¢d_¿wmidi_¡©us_t
 *
obj
);

164 
size_t
 
¢d_¿wmidi_¡©us_g‘_xruns
(cÚ¡ 
¢d_¿wmidi_¡©us_t
 *
obj
);

165 
¢d_¿wmidi_¡©us
(
¢d_¿wmidi_t
 *
rmidi
, 
¢d_¿wmidi_¡©us_t
 * 
¡©us
);

166 
¢d_¿wmidi_d¿š
(
¢d_¿wmidi_t
 *
rmidi
);

167 
¢d_¿wmidi_drİ
(
¢d_¿wmidi_t
 *
rmidi
);

168 
ssize_t
 
¢d_¿wmidi_wr™e
(
¢d_¿wmidi_t
 *
rmidi
, cÚ¡ *
bufãr
, 
size_t
 
size
);

169 
ssize_t
 
¢d_¿wmidi_»ad
(
¢d_¿wmidi_t
 *
rmidi
, *
bufãr
, 
size_t
 
size
);

170 
ssize_t
 
¢d_¿wmidi_Œ—d
(
¢d_¿wmidi_t
 *
rmidi
, 
time¥ec
 *
t¡amp
, *
bufãr
, 
size_t
 
size
);

171 cÚ¡ *
¢d_¿wmidi_Çme
(
¢d_¿wmidi_t
 *
rmidi
);

172 
¢d_¿wmidi_ty³_t
 
¢d_¿wmidi_ty³
(
¢d_¿wmidi_t
 *
rmidi
);

173 
¢d_¿wmidi_¡»am_t
 
¢d_¿wmidi_¡»am
(
¢d_¿wmidi_t
 *
¿wmidi
);

177 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/search.h

20 #iâdeà
_SEARCH_H


21 
	#_SEARCH_H
 1

	)

23 
	~<ã©u»s.h
>

25 
	#__Ãed_size_t


	)

26 
	~<¡ddef.h
>

28 
	g__BEGIN_DECLS


30 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


34 #ifdeà
__USE_GNU


35 
	sq–em


37 
q–em
 *
	mq_fÜw
;

38 
q–em
 *
	mq_back
;

39 
	mq_d©a
[1];

45 
šsque
 
__P
 ((*
__–em
, *
__´ev
));

48 
»mque
 
__P
 ((*
__–em
));

53 #iâdeà
__COMPAR_FN_T


54 
	#__COMPAR_FN_T


	)

55 (*
	t__com·r_â_t
è
	t__PMT
 ((
	t__cÚ¡
 
	t__±r_t
, __const __ptr_t));

57 #ifdef 
__USE_GNU


58 
__com·r_â_t
 
	tcom·risÚ_â_t
;

65 
FIND
,

66 
ENTER


68 
	tACTION
;

70 
	s’Œy


72 *
key
;

73 *
d©a
;

75 
	tENTRY
;

78 
_ENTRY
;

88 
ENTRY
 *
h£¬ch
 
	`__P
 ((ENTRY 
__™em
, 
ACTION
 
__aùiÚ
));

91 
hü—‹
 
	`__P
 ((
size_t
 
__Ãl
));

94 
hde¡roy
 
	`__P
 (());

96 #ifdeà
__USE_GNU


98 
	sh£¬ch_d©a


100 
_ENTRY
 *
bË
;

101 
size
;

102 
fËd
;

107 
h£¬ch_r
 
	`__P
 ((
ENTRY
 
__™em
, 
ACTION
 
__aùiÚ
, ENTRY **
__»tv®
,

108 
h£¬ch_d©a
 *
__hb
));

109 
hü—‹_r
 
	`__P
 ((
size_t
 
__Ãl
, 
h£¬ch_d©a
 *
__hb
));

110 
hde¡roy_r
 
	`__P
 ((
h£¬ch_d©a
 *
__hb
));

121 
´eÜd”
,

122 
po¡Üd”
,

123 
’dÜd”
,

124 
Ëaf


126 
	tVISIT
;

130 *
t£¬ch
 
	`__PMT
 ((
__cÚ¡
 *
__key
, **
__roÙp
,

131 
__com·r_â_t
 
__com·r
));

135 *
tfšd
 
	`__PMT
 ((
__cÚ¡
 *
__key
, *__cÚ¡ *
__roÙp
,

136 
__com·r_â_t
 
__com·r
));

139 *
td–‘e
 
	`__PMT
 ((
__cÚ¡
 *
__key
, **
__roÙp
,

140 
__com·r_â_t
 
__com·r
));

142 #iâdeà
__ACTION_FN_T


143 
	#__ACTION_FN_T


	)

144 (*
	t__aùiÚ_â_t
è
	t__PMT
 ((
	t__cÚ¡
 *
	t__nod•
,

145 
	tVISIT
 
	t__v®ue
,

146 
	t__Ëv–
));

151 
tw®k
 
	`__PMT
 ((
__cÚ¡
 *
__roÙ
, 
__aùiÚ_â_t
 
__aùiÚ
));

153 #ifdeà
__USE_GNU


156 (*
	t__ä“_â_t
è
	t__PMT
 ((*
	t__nod•
));

159 
tde¡roy
 
	`__PMT
 ((*
__roÙ
, 
__ä“_â_t
 
__ä“fù
));

165 *
lfšd
 
	`__PMT
 ((
__cÚ¡
 *
__key
, __cÚ¡ *
__ba£
,

166 
size_t
 *
__nmemb
, size_ˆ
__size
,

167 
__com·r_â_t
 
__com·r
));

171 *
l£¬ch
 
	`__PMT
 ((
__cÚ¡
 *
__key
, *
__ba£
,

172 
size_t
 *
__nmemb
, size_ˆ
__size
,

173 
__com·r_â_t
 
__com·r
));

175 
__END_DECLS


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seq.h

29 #iâdeà
__ALSA_SEQ_H


30 
	#__ALSA_SEQ_H


	)

32 #ifdeà
__ılu¥lus


44 
	#SND_SEQ_DLSYM_VERSION
 
_dlsym_£q_001


	)

47 
_¢d_£q
 
	t¢d_£q_t
;

52 
	#SND_SEQ_OPEN_OUTPUT
 1

	)

53 
	#SND_SEQ_OPEN_INPUT
 2

	)

54 
	#SND_SEQ_OPEN_DUPLEX
 (
SND_SEQ_OPEN_OUTPUT
|
SND_SEQ_OPEN_INPUT
è

	)

59 
	#SND_SEQ_NONBLOCK
 0x0001

	)

62 
	e_¢d_£q_ty³
 {

63 
SND_SEQ_TYPE_HW
,

64 
SND_SEQ_TYPE_SHM
,

65 
SND_SEQ_TYPE_INET


66 } 
	t¢d_£q_ty³_t
;

69 
	#SND_SEQ_ADDRESS_UNKNOWN
 253

	)

70 
	#SND_SEQ_ADDRESS_SUBSCRIBERS
 254

	)

71 
	#SND_SEQ_ADDRESS_BROADCAST
 255

	)

74 
	#SND_SEQ_CLIENT_SYSTEM
 0

	)

78 
¢d_£q_İ’
(
¢d_£q_t
 **
hªdË
, cÚ¡ *
Çme
, 
¡»ams
, 
mode
);

79 
¢d_£q_İ’_lcÚf
(
¢d_£q_t
 **
hªdË
, cÚ¡ *
Çme
, 
¡»ams
, 
mode
, 
¢d_cÚfig_t
 *
lcÚf
);

80 cÚ¡ *
¢d_£q_Çme
(
¢d_£q_t
 *
£q
);

81 
¢d_£q_ty³_t
 
¢d_£q_ty³
(
¢d_£q_t
 *
£q
);

82 
¢d_£q_şo£
(
¢d_£q_t
 *
hªdË
);

83 
¢d_£q_pŞl_desütÜs_couÁ
(
¢d_£q_t
 *
hªdË
, 
ev’ts
);

84 
¢d_£q_pŞl_desütÜs
(
¢d_£q_t
 *
hªdË
, 
pŞlfd
 *
pfds
, 
¥aû
, 
ev’ts
);

85 
¢d_£q_pŞl_desütÜs_»v’ts
(
¢d_£q_t
 *
£q
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
);

86 
¢d_£q_nÚblock
(
¢d_£q_t
 *
hªdË
, 
nÚblock
);

87 
¢d_£q_ş›Á_id
(
¢d_£q_t
 *
hªdË
);

89 
size_t
 
¢d_£q_g‘_ouut_bufãr_size
(
¢d_£q_t
 *
hªdË
);

90 
size_t
 
¢d_£q_g‘_šput_bufãr_size
(
¢d_£q_t
 *
hªdË
);

91 
¢d_£q_£t_ouut_bufãr_size
(
¢d_£q_t
 *
hªdË
, 
size_t
 
size
);

92 
¢d_£q_£t_šput_bufãr_size
(
¢d_£q_t
 *
hªdË
, 
size_t
 
size
);

95 
_¢d_£q_sy¡em_šfo
 
	t¢d_£q_sy¡em_šfo_t
;

97 
size_t
 
¢d_£q_sy¡em_šfo_sizeof
();

99 
	#¢d_£q_sy¡em_šfo_®loÿ
(
±r
) \

100 
	`__¢d_®loÿ
(
±r
, 
¢d_£q_sy¡em_šfo
)

	)

101 
¢d_£q_sy¡em_šfo_m®loc
(
¢d_£q_sy¡em_šfo_t
 **
±r
);

102 
¢d_£q_sy¡em_šfo_ä“
(
¢d_£q_sy¡em_šfo_t
 *
±r
);

103 
¢d_£q_sy¡em_šfo_cİy
(
¢d_£q_sy¡em_šfo_t
 *
d¡
, cÚ¡ snd_£q_sy¡em_šfo_ˆ*
¤c
);

105 
¢d_£q_sy¡em_šfo_g‘_queues
(cÚ¡ 
¢d_£q_sy¡em_šfo_t
 *
šfo
);

106 
¢d_£q_sy¡em_šfo_g‘_ş›Ás
(cÚ¡ 
¢d_£q_sy¡em_šfo_t
 *
šfo
);

107 
¢d_£q_sy¡em_šfo_g‘_pÜts
(cÚ¡ 
¢d_£q_sy¡em_šfo_t
 *
šfo
);

108 
¢d_£q_sy¡em_šfo_g‘_chªÃls
(cÚ¡ 
¢d_£q_sy¡em_šfo_t
 *
šfo
);

109 
¢d_£q_sy¡em_šfo_g‘_cur_ş›Ás
(cÚ¡ 
¢d_£q_sy¡em_šfo_t
 *
šfo
);

110 
¢d_£q_sy¡em_šfo_g‘_cur_queues
(cÚ¡ 
¢d_£q_sy¡em_šfo_t
 *
šfo
);

112 
¢d_£q_sy¡em_šfo
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_sy¡em_šfo_t
 *
šfo
);

125 
_¢d_£q_ş›Á_šfo
 
	t¢d_£q_ş›Á_šfo_t
;

128 
	e¢d_£q_ş›Á_ty³
 {

129 
SND_SEQ_USER_CLIENT
 = 1,

130 
SND_SEQ_KERNEL_CLIENT
 = 2

131 } 
	t¢d_£q_ş›Á_ty³_t
;

135 
SND_SEQ_CLIENT_LEGACY_MIDI
 = 0,

136 
SND_SEQ_CLIENT_UMP_MIDI_1_0
 = 1,

137 
SND_SEQ_CLIENT_UMP_MIDI_2_0
 = 2

140 
size_t
 
¢d_£q_ş›Á_šfo_sizeof
();

142 
	#¢d_£q_ş›Á_šfo_®loÿ
(
±r
) \

143 
	`__¢d_®loÿ
(
±r
, 
¢d_£q_ş›Á_šfo
)

	)

144 
¢d_£q_ş›Á_šfo_m®loc
(
¢d_£q_ş›Á_šfo_t
 **
±r
);

145 
¢d_£q_ş›Á_šfo_ä“
(
¢d_£q_ş›Á_šfo_t
 *
±r
);

146 
¢d_£q_ş›Á_šfo_cİy
(
¢d_£q_ş›Á_šfo_t
 *
d¡
, cÚ¡ snd_£q_ş›Á_šfo_ˆ*
¤c
);

148 
¢d_£q_ş›Á_šfo_g‘_ş›Á
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

149 
¢d_£q_ş›Á_ty³_t
 
¢d_£q_ş›Á_šfo_g‘_ty³
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

150 cÚ¡ *
¢d_£q_ş›Á_šfo_g‘_Çme
(
¢d_£q_ş›Á_šfo_t
 *
šfo
);

151 
¢d_£q_ş›Á_šfo_g‘_brßdÿ¡_f‹r
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

152 
¢d_£q_ş›Á_šfo_g‘_”rÜ_bounû
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

153 
¢d_£q_ş›Á_šfo_g‘_ÿrd
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

154 
¢d_£q_ş›Á_šfo_g‘_pid
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

155 cÚ¡ *
¢d_£q_ş›Á_šfo_g‘_ev’t_f‹r
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

156 
¢d_£q_ş›Á_šfo_g‘_num_pÜts
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

157 
¢d_£q_ş›Á_šfo_g‘_ev’t_lo¡
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

159 
¢d_£q_ş›Á_šfo_g‘_midi_v”siÚ
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

160 
¢d_£q_ş›Á_šfo_g‘_ump_group_’abËd
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
,

161 
group
);

162 
¢d_£q_ş›Á_šfo_g‘_ump_grou¶ess_’abËd
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

163 
¢d_£q_ş›Á_šfo_g‘_ump_cÚv”siÚ
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

164 
¢d_£q_ş›Á_šfo_£t_ş›Á
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, 
ş›Á
);

165 
¢d_£q_ş›Á_šfo_£t_Çme
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, cÚ¡ *
Çme
);

166 
¢d_£q_ş›Á_šfo_£t_brßdÿ¡_f‹r
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, 
v®
);

167 
¢d_£q_ş›Á_šfo_£t_”rÜ_bounû
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, 
v®
);

168 
¢d_£q_ş›Á_šfo_£t_ev’t_f‹r
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, *
f‹r
);

169 
¢d_£q_ş›Á_šfo_£t_midi_v”siÚ
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, 
midi_v”siÚ
);

170 
¢d_£q_ş›Á_šfo_£t_ump_group_’abËd
(
¢d_£q_ş›Á_šfo_t
 *
šfo
,

171 
group
, 
’abË
);

172 
¢d_£q_ş›Á_šfo_£t_ump_grou¶ess_’abËd
(
¢d_£q_ş›Á_šfo_t
 *
šfo
,

173 
’abË
);

174 
¢d_£q_ş›Á_šfo_£t_ump_cÚv”siÚ
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, 
’abË
);

176 
¢d_£q_ş›Á_šfo_ev’t_f‹r_ş—r
(
¢d_£q_ş›Á_šfo_t
 *
šfo
);

177 
¢d_£q_ş›Á_šfo_ev’t_f‹r_add
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, 
ev’t_ty³
);

178 
¢d_£q_ş›Á_šfo_ev’t_f‹r_d–
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, 
ev’t_ty³
);

179 
¢d_£q_ş›Á_šfo_ev’t_f‹r_check
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, 
ev’t_ty³
);

181 
¢d_£q_g‘_ş›Á_šfo
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

182 
¢d_£q_g‘_ªy_ş›Á_šfo
(
¢d_£q_t
 *
hªdË
, 
ş›Á
, 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

183 
¢d_£q_£t_ş›Á_šfo
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

184 
¢d_£q_qu”y_Ãxt_ş›Á
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_ş›Á_šfo_t
 *
šfo
);

186 
¢d_£q_g‘_ump_’dpošt_šfo
(
¢d_£q_t
 *
£q
, 
ş›Á
, *
šfo
);

187 
¢d_£q_g‘_ump_block_šfo
(
¢d_£q_t
 *
£q
, 
ş›Á
, 
blk
, *
šfo
);

188 
¢d_£q_£t_ump_’dpošt_šfo
(
¢d_£q_t
 *
£q
, cÚ¡ *
šfo
);

189 
¢d_£q_£t_ump_block_šfo
(
¢d_£q_t
 *
£q
, 
blk
, cÚ¡ *
šfo
);

195 
_¢d_£q_ş›Á_poŞ
 
	t¢d_£q_ş›Á_poŞ_t
;

197 
size_t
 
¢d_£q_ş›Á_poŞ_sizeof
();

199 
	#¢d_£q_ş›Á_poŞ_®loÿ
(
±r
) \

200 
	`__¢d_®loÿ
(
±r
, 
¢d_£q_ş›Á_poŞ
)

	)

201 
¢d_£q_ş›Á_poŞ_m®loc
(
¢d_£q_ş›Á_poŞ_t
 **
±r
);

202 
¢d_£q_ş›Á_poŞ_ä“
(
¢d_£q_ş›Á_poŞ_t
 *
±r
);

203 
¢d_£q_ş›Á_poŞ_cİy
(
¢d_£q_ş›Á_poŞ_t
 *
d¡
, cÚ¡ snd_£q_ş›Á_poŞ_ˆ*
¤c
);

205 
¢d_£q_ş›Á_poŞ_g‘_ş›Á
(cÚ¡ 
¢d_£q_ş›Á_poŞ_t
 *
šfo
);

206 
size_t
 
¢d_£q_ş›Á_poŞ_g‘_ouut_poŞ
(cÚ¡ 
¢d_£q_ş›Á_poŞ_t
 *
šfo
);

207 
size_t
 
¢d_£q_ş›Á_poŞ_g‘_šput_poŞ
(cÚ¡ 
¢d_£q_ş›Á_poŞ_t
 *
šfo
);

208 
size_t
 
¢d_£q_ş›Á_poŞ_g‘_ouut_room
(cÚ¡ 
¢d_£q_ş›Á_poŞ_t
 *
šfo
);

209 
size_t
 
¢d_£q_ş›Á_poŞ_g‘_ouut_ä“
(cÚ¡ 
¢d_£q_ş›Á_poŞ_t
 *
šfo
);

210 
size_t
 
¢d_£q_ş›Á_poŞ_g‘_šput_ä“
(cÚ¡ 
¢d_£q_ş›Á_poŞ_t
 *
šfo
);

211 
¢d_£q_ş›Á_poŞ_£t_ouut_poŞ
(
¢d_£q_ş›Á_poŞ_t
 *
šfo
, 
size_t
 
size
);

212 
¢d_£q_ş›Á_poŞ_£t_šput_poŞ
(
¢d_£q_ş›Á_poŞ_t
 *
šfo
, 
size_t
 
size
);

213 
¢d_£q_ş›Á_poŞ_£t_ouut_room
(
¢d_£q_ş›Á_poŞ_t
 *
šfo
, 
size_t
 
size
);

215 
¢d_£q_g‘_ş›Á_poŞ
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_ş›Á_poŞ_t
 *
šfo
);

216 
¢d_£q_£t_ş›Á_poŞ
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_ş›Á_poŞ_t
 *
šfo
);

230 
_¢d_£q_pÜt_šfo
 
	t¢d_£q_pÜt_šfo_t
;

233 
	#SND_SEQ_PORT_SYSTEM_TIMER
 0

	)

234 
	#SND_SEQ_PORT_SYSTEM_ANNOUNCE
 1

	)

237 
	#SND_SEQ_PORT_CAP_READ
 (1<<0è

	)

238 
	#SND_SEQ_PORT_CAP_WRITE
 (1<<1è

	)

240 
	#SND_SEQ_PORT_CAP_SYNC_READ
 (1<<2è

	)

241 
	#SND_SEQ_PORT_CAP_SYNC_WRITE
 (1<<3è

	)

243 
	#SND_SEQ_PORT_CAP_DUPLEX
 (1<<4è

	)

245 
	#SND_SEQ_PORT_CAP_SUBS_READ
 (1<<5è

	)

246 
	#SND_SEQ_PORT_CAP_SUBS_WRITE
 (1<<6è

	)

247 
	#SND_SEQ_PORT_CAP_NO_EXPORT
 (1<<7è

	)

248 
	#SND_SEQ_PORT_CAP_INACTIVE
 (1<<8è

	)

249 
	#SND_SEQ_PORT_CAP_UMP_ENDPOINT
 (1<<9è

	)

252 
	#SND_SEQ_PORT_DIR_UNKNOWN
 0

	)

253 
	#SND_SEQ_PORT_DIR_INPUT
 1

	)

254 
	#SND_SEQ_PORT_DIR_OUTPUT
 2

	)

255 
	#SND_SEQ_PORT_DIR_BIDIRECTION
 3

	)

259 
	#SND_SEQ_PORT_TYPE_SPECIFIC
 (1<<0)

	)

261 
	#SND_SEQ_PORT_TYPE_MIDI_GENERIC
 (1<<1)

	)

263 
	#SND_SEQ_PORT_TYPE_MIDI_GM
 (1<<2)

	)

265 
	#SND_SEQ_PORT_TYPE_MIDI_GS
 (1<<3)

	)

267 
	#SND_SEQ_PORT_TYPE_MIDI_XG
 (1<<4)

	)

269 
	#SND_SEQ_PORT_TYPE_MIDI_MT32
 (1<<5)

	)

271 
	#SND_SEQ_PORT_TYPE_MIDI_GM2
 (1<<6)

	)

273 
	#SND_SEQ_PORT_TYPE_MIDI_UMP
 (1<<7)

	)

276 
	#SND_SEQ_PORT_TYPE_SYNTH
 (1<<10)

	)

279 
	#SND_SEQ_PORT_TYPE_DIRECT_SAMPLE
 (1<<11)

	)

282 
	#SND_SEQ_PORT_TYPE_SAMPLE
 (1<<12)

	)

284 
	#SND_SEQ_PORT_TYPE_HARDWARE
 (1<<16)

	)

286 
	#SND_SEQ_PORT_TYPE_SOFTWARE
 (1<<17)

	)

288 
	#SND_SEQ_PORT_TYPE_SYNTHESIZER
 (1<<18)

	)

291 
	#SND_SEQ_PORT_TYPE_PORT
 (1<<19)

	)

293 
	#SND_SEQ_PORT_TYPE_APPLICATION
 (1<<20)

	)

296 
size_t
 
¢d_£q_pÜt_šfo_sizeof
();

298 
	#¢d_£q_pÜt_šfo_®loÿ
(
±r
) \

299 
	`__¢d_®loÿ
(
±r
, 
¢d_£q_pÜt_šfo
)

	)

300 
¢d_£q_pÜt_šfo_m®loc
(
¢d_£q_pÜt_šfo_t
 **
±r
);

301 
¢d_£q_pÜt_šfo_ä“
(
¢d_£q_pÜt_šfo_t
 *
±r
);

302 
¢d_£q_pÜt_šfo_cİy
(
¢d_£q_pÜt_šfo_t
 *
d¡
, cÚ¡ snd_£q_pÜt_šfo_ˆ*
¤c
);

304 
¢d_£q_pÜt_šfo_g‘_ş›Á
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

305 
¢d_£q_pÜt_šfo_g‘_pÜt
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

306 cÚ¡ 
¢d_£q_addr_t
 *
¢d_£q_pÜt_šfo_g‘_addr
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

307 cÚ¡ *
¢d_£q_pÜt_šfo_g‘_Çme
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

308 
¢d_£q_pÜt_šfo_g‘_ÿ·b™y
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

309 
¢d_£q_pÜt_šfo_g‘_ty³
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

310 
¢d_£q_pÜt_šfo_g‘_midi_chªÃls
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

311 
¢d_£q_pÜt_šfo_g‘_midi_voiûs
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

312 
¢d_£q_pÜt_šfo_g‘_syÁh_voiûs
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

313 
¢d_£q_pÜt_šfo_g‘_»ad_u£
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

314 
¢d_£q_pÜt_šfo_g‘_wr™e_u£
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

315 
¢d_£q_pÜt_šfo_g‘_pÜt_¥ecif›d
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

316 
¢d_£q_pÜt_šfo_g‘_time¡ampšg
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

317 
¢d_£q_pÜt_šfo_g‘_time¡amp_»®
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

318 
¢d_£q_pÜt_šfo_g‘_time¡amp_queue
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

319 
¢d_£q_pÜt_šfo_g‘_dœeùiÚ
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

320 
¢d_£q_pÜt_šfo_g‘_ump_group
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
);

322 
¢d_£q_pÜt_šfo_£t_ş›Á
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
ş›Á
);

323 
¢d_£q_pÜt_šfo_£t_pÜt
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
pÜt
);

324 
¢d_£q_pÜt_šfo_£t_addr
(
¢d_£q_pÜt_šfo_t
 *
šfo
, cÚ¡ 
¢d_£q_addr_t
 *
addr
);

325 
¢d_£q_pÜt_šfo_£t_Çme
(
¢d_£q_pÜt_šfo_t
 *
šfo
, cÚ¡ *
Çme
);

326 
¢d_£q_pÜt_šfo_£t_ÿ·b™y
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
ÿ·b™y
);

327 
¢d_£q_pÜt_šfo_£t_ty³
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
ty³
);

328 
¢d_£q_pÜt_šfo_£t_midi_chªÃls
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
chªÃls
);

329 
¢d_£q_pÜt_šfo_£t_midi_voiûs
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
voiûs
);

330 
¢d_£q_pÜt_šfo_£t_syÁh_voiûs
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
voiûs
);

331 
¢d_£q_pÜt_šfo_£t_pÜt_¥ecif›d
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
v®
);

332 
¢d_£q_pÜt_šfo_£t_time¡ampšg
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
’abË
);

333 
¢d_£q_pÜt_šfo_£t_time¡amp_»®
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
»®time
);

334 
¢d_£q_pÜt_šfo_£t_time¡amp_queue
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
queue
);

335 
¢d_£q_pÜt_šfo_£t_dœeùiÚ
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
dœeùiÚ
);

336 
¢d_£q_pÜt_šfo_£t_ump_group
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
ump_group
);

338 
¢d_£q_ü—‹_pÜt
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_pÜt_šfo_t
 *
šfo
);

339 
¢d_£q_d–‘e_pÜt
(
¢d_£q_t
 *
hªdË
, 
pÜt
);

340 
¢d_£q_g‘_pÜt_šfo
(
¢d_£q_t
 *
hªdË
, 
pÜt
, 
¢d_£q_pÜt_šfo_t
 *
šfo
);

341 
¢d_£q_g‘_ªy_pÜt_šfo
(
¢d_£q_t
 *
hªdË
, 
ş›Á
, 
pÜt
, 
¢d_£q_pÜt_šfo_t
 *
šfo
);

342 
¢d_£q_£t_pÜt_šfo
(
¢d_£q_t
 *
hªdË
, 
pÜt
, 
¢d_£q_pÜt_šfo_t
 *
šfo
);

343 
¢d_£q_qu”y_Ãxt_pÜt
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_pÜt_šfo_t
 *
šfo
);

356 
_¢d_£q_pÜt_subsüibe
 
	t¢d_£q_pÜt_subsüibe_t
;

358 
size_t
 
¢d_£q_pÜt_subsüibe_sizeof
();

360 
	#¢d_£q_pÜt_subsüibe_®loÿ
(
±r
) \

361 
	`__¢d_®loÿ
(
±r
, 
¢d_£q_pÜt_subsüibe
)

	)

362 
¢d_£q_pÜt_subsüibe_m®loc
(
¢d_£q_pÜt_subsüibe_t
 **
±r
);

363 
¢d_£q_pÜt_subsüibe_ä“
(
¢d_£q_pÜt_subsüibe_t
 *
±r
);

364 
¢d_£q_pÜt_subsüibe_cİy
(
¢d_£q_pÜt_subsüibe_t
 *
d¡
, cÚ¡ snd_£q_pÜt_subsüibe_ˆ*
¤c
);

366 cÚ¡ 
¢d_£q_addr_t
 *
¢d_£q_pÜt_subsüibe_g‘_£nd”
(cÚ¡ 
¢d_£q_pÜt_subsüibe_t
 *
šfo
);

367 cÚ¡ 
¢d_£q_addr_t
 *
¢d_£q_pÜt_subsüibe_g‘_de¡
(cÚ¡ 
¢d_£q_pÜt_subsüibe_t
 *
šfo
);

368 
¢d_£q_pÜt_subsüibe_g‘_queue
(cÚ¡ 
¢d_£q_pÜt_subsüibe_t
 *
šfo
);

369 
¢d_£q_pÜt_subsüibe_g‘_exşusive
(cÚ¡ 
¢d_£q_pÜt_subsüibe_t
 *
šfo
);

370 
¢d_£q_pÜt_subsüibe_g‘_time_upd©e
(cÚ¡ 
¢d_£q_pÜt_subsüibe_t
 *
šfo
);

371 
¢d_£q_pÜt_subsüibe_g‘_time_»®
(cÚ¡ 
¢d_£q_pÜt_subsüibe_t
 *
šfo
);

373 
¢d_£q_pÜt_subsüibe_£t_£nd”
(
¢d_£q_pÜt_subsüibe_t
 *
šfo
, cÚ¡ 
¢d_£q_addr_t
 *
addr
);

374 
¢d_£q_pÜt_subsüibe_£t_de¡
(
¢d_£q_pÜt_subsüibe_t
 *
šfo
, cÚ¡ 
¢d_£q_addr_t
 *
addr
);

375 
¢d_£q_pÜt_subsüibe_£t_queue
(
¢d_£q_pÜt_subsüibe_t
 *
šfo
, 
q
);

376 
¢d_£q_pÜt_subsüibe_£t_exşusive
(
¢d_£q_pÜt_subsüibe_t
 *
šfo
, 
v®
);

377 
¢d_£q_pÜt_subsüibe_£t_time_upd©e
(
¢d_£q_pÜt_subsüibe_t
 *
šfo
, 
v®
);

378 
¢d_£q_pÜt_subsüibe_£t_time_»®
(
¢d_£q_pÜt_subsüibe_t
 *
šfo
, 
v®
);

380 
¢d_£q_g‘_pÜt_subsütiÚ
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_pÜt_subsüibe_t
 *
sub
);

381 
¢d_£q_subsüibe_pÜt
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_pÜt_subsüibe_t
 *
sub
);

382 
¢d_£q_unsubsüibe_pÜt
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_pÜt_subsüibe_t
 *
sub
);

388 
_¢d_£q_qu”y_subsüibe
 
	t¢d_£q_qu”y_subsüibe_t
;

392 
SND_SEQ_QUERY_SUBS_READ
,

393 
SND_SEQ_QUERY_SUBS_WRITE


394 } 
	t¢d_£q_qu”y_subs_ty³_t
;

396 
size_t
 
¢d_£q_qu”y_subsüibe_sizeof
();

398 
	#¢d_£q_qu”y_subsüibe_®loÿ
(
±r
) \

399 
	`__¢d_®loÿ
(
±r
, 
¢d_£q_qu”y_subsüibe
)

	)

400 
¢d_£q_qu”y_subsüibe_m®loc
(
¢d_£q_qu”y_subsüibe_t
 **
±r
);

401 
¢d_£q_qu”y_subsüibe_ä“
(
¢d_£q_qu”y_subsüibe_t
 *
±r
);

402 
¢d_£q_qu”y_subsüibe_cİy
(
¢d_£q_qu”y_subsüibe_t
 *
d¡
, cÚ¡ snd_£q_qu”y_subsüibe_ˆ*
¤c
);

404 
¢d_£q_qu”y_subsüibe_g‘_ş›Á
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
);

405 
¢d_£q_qu”y_subsüibe_g‘_pÜt
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
);

406 cÚ¡ 
¢d_£q_addr_t
 *
¢d_£q_qu”y_subsüibe_g‘_roÙ
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
);

407 
¢d_£q_qu”y_subs_ty³_t
 
¢d_£q_qu”y_subsüibe_g‘_ty³
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
);

408 
¢d_£q_qu”y_subsüibe_g‘_šdex
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
);

409 
¢d_£q_qu”y_subsüibe_g‘_num_subs
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
);

410 cÚ¡ 
¢d_£q_addr_t
 *
¢d_£q_qu”y_subsüibe_g‘_addr
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
);

411 
¢d_£q_qu”y_subsüibe_g‘_queue
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
);

412 
¢d_£q_qu”y_subsüibe_g‘_exşusive
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
);

413 
¢d_£q_qu”y_subsüibe_g‘_time_upd©e
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
);

414 
¢d_£q_qu”y_subsüibe_g‘_time_»®
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
);

416 
¢d_£q_qu”y_subsüibe_£t_ş›Á
(
¢d_£q_qu”y_subsüibe_t
 *
šfo
, 
ş›Á
);

417 
¢d_£q_qu”y_subsüibe_£t_pÜt
(
¢d_£q_qu”y_subsüibe_t
 *
šfo
, 
pÜt
);

418 
¢d_£q_qu”y_subsüibe_£t_roÙ
(
¢d_£q_qu”y_subsüibe_t
 *
šfo
, cÚ¡ 
¢d_£q_addr_t
 *
addr
);

419 
¢d_£q_qu”y_subsüibe_£t_ty³
(
¢d_£q_qu”y_subsüibe_t
 *
šfo
, 
¢d_£q_qu”y_subs_ty³_t
 
ty³
);

420 
¢d_£q_qu”y_subsüibe_£t_šdex
(
¢d_£q_qu”y_subsüibe_t
 *
šfo
, 
_šdex
);

422 
¢d_£q_qu”y_pÜt_subsüib”s
(
¢d_£q_t
 *
£q
, 
¢d_£q_qu”y_subsüibe_t
 * 
subs
);

435 
_¢d_£q_queue_šfo
 
	t¢d_£q_queue_šfo_t
;

437 
_¢d_£q_queue_¡©us
 
	t¢d_£q_queue_¡©us_t
;

439 
_¢d_£q_queue_‹mpo
 
	t¢d_£q_queue_‹mpo_t
;

441 
_¢d_£q_queue_tim”
 
	t¢d_£q_queue_tim”_t
;

444 
	#SND_SEQ_QUEUE_DIRECT
 253

	)

446 
size_t
 
¢d_£q_queue_šfo_sizeof
();

448 
	#¢d_£q_queue_šfo_®loÿ
(
±r
) \

449 
	`__¢d_®loÿ
(
±r
, 
¢d_£q_queue_šfo
)

	)

450 
¢d_£q_queue_šfo_m®loc
(
¢d_£q_queue_šfo_t
 **
±r
);

451 
¢d_£q_queue_šfo_ä“
(
¢d_£q_queue_šfo_t
 *
±r
);

452 
¢d_£q_queue_šfo_cİy
(
¢d_£q_queue_šfo_t
 *
d¡
, cÚ¡ snd_£q_queue_šfo_ˆ*
¤c
);

454 
¢d_£q_queue_šfo_g‘_queue
(cÚ¡ 
¢d_£q_queue_šfo_t
 *
šfo
);

455 cÚ¡ *
¢d_£q_queue_šfo_g‘_Çme
(cÚ¡ 
¢d_£q_queue_šfo_t
 *
šfo
);

456 
¢d_£q_queue_šfo_g‘_owÃr
(cÚ¡ 
¢d_£q_queue_šfo_t
 *
šfo
);

457 
¢d_£q_queue_šfo_g‘_locked
(cÚ¡ 
¢d_£q_queue_šfo_t
 *
šfo
);

458 
¢d_£q_queue_šfo_g‘_æags
(cÚ¡ 
¢d_£q_queue_šfo_t
 *
šfo
);

460 
¢d_£q_queue_šfo_£t_Çme
(
¢d_£q_queue_šfo_t
 *
šfo
, cÚ¡ *
Çme
);

461 
¢d_£q_queue_šfo_£t_owÃr
(
¢d_£q_queue_šfo_t
 *
šfo
, 
owÃr
);

462 
¢d_£q_queue_šfo_£t_locked
(
¢d_£q_queue_šfo_t
 *
šfo
, 
locked
);

463 
¢d_£q_queue_šfo_£t_æags
(
¢d_£q_queue_šfo_t
 *
šfo
, 
æags
);

465 
¢d_£q_ü—‹_queue
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_šfo_t
 *
šfo
);

466 
¢d_£q_®loc_Çmed_queue
(
¢d_£q_t
 *
£q
, cÚ¡ *
Çme
);

467 
¢d_£q_®loc_queue
(
¢d_£q_t
 *
hªdË
);

468 
¢d_£q_ä“_queue
(
¢d_£q_t
 *
hªdË
, 
q
);

469 
¢d_£q_g‘_queue_šfo
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_šfo_t
 *
šfo
);

470 
¢d_£q_£t_queue_šfo
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_šfo_t
 *
šfo
);

471 
¢d_£q_qu”y_Çmed_queue
(
¢d_£q_t
 *
£q
, cÚ¡ *
Çme
);

473 
¢d_£q_g‘_queue_u§ge
(
¢d_£q_t
 *
hªdË
, 
q
);

474 
¢d_£q_£t_queue_u§ge
(
¢d_£q_t
 *
hªdË
, 
q
, 
u£d
);

478 
size_t
 
¢d_£q_queue_¡©us_sizeof
();

480 
	#¢d_£q_queue_¡©us_®loÿ
(
±r
) \

481 
	`__¢d_®loÿ
(
±r
, 
¢d_£q_queue_¡©us
)

	)

482 
¢d_£q_queue_¡©us_m®loc
(
¢d_£q_queue_¡©us_t
 **
±r
);

483 
¢d_£q_queue_¡©us_ä“
(
¢d_£q_queue_¡©us_t
 *
±r
);

484 
¢d_£q_queue_¡©us_cİy
(
¢d_£q_queue_¡©us_t
 *
d¡
, cÚ¡ snd_£q_queue_¡©us_ˆ*
¤c
);

486 
¢d_£q_queue_¡©us_g‘_queue
(cÚ¡ 
¢d_£q_queue_¡©us_t
 *
šfo
);

487 
¢d_£q_queue_¡©us_g‘_ev’ts
(cÚ¡ 
¢d_£q_queue_¡©us_t
 *
šfo
);

488 
¢d_£q_tick_time_t
 
¢d_£q_queue_¡©us_g‘_tick_time
(cÚ¡ 
¢d_£q_queue_¡©us_t
 *
šfo
);

489 cÚ¡ 
¢d_£q_»®_time_t
 *
¢d_£q_queue_¡©us_g‘_»®_time
(cÚ¡ 
¢d_£q_queue_¡©us_t
 *
šfo
);

490 
¢d_£q_queue_¡©us_g‘_¡©us
(cÚ¡ 
¢d_£q_queue_¡©us_t
 *
šfo
);

492 
¢d_£q_g‘_queue_¡©us
(
¢d_£q_t
 *
hªdË
, 
q
, 
¢d_£q_queue_¡©us_t
 *
¡©us
);

496 
size_t
 
¢d_£q_queue_‹mpo_sizeof
();

498 
	#¢d_£q_queue_‹mpo_®loÿ
(
±r
) \

499 
	`__¢d_®loÿ
(
±r
, 
¢d_£q_queue_‹mpo
)

	)

500 
¢d_£q_queue_‹mpo_m®loc
(
¢d_£q_queue_‹mpo_t
 **
±r
);

501 
¢d_£q_queue_‹mpo_ä“
(
¢d_£q_queue_‹mpo_t
 *
±r
);

502 
¢d_£q_queue_‹mpo_cİy
(
¢d_£q_queue_‹mpo_t
 *
d¡
, cÚ¡ snd_£q_queue_‹mpo_ˆ*
¤c
);

504 
¢d_£q_queue_‹mpo_g‘_queue
(cÚ¡ 
¢d_£q_queue_‹mpo_t
 *
šfo
);

505 
¢d_£q_queue_‹mpo_g‘_‹mpo
(cÚ¡ 
¢d_£q_queue_‹mpo_t
 *
šfo
);

506 
¢d_£q_queue_‹mpo_g‘_µq
(cÚ¡ 
¢d_£q_queue_‹mpo_t
 *
šfo
);

507 
¢d_£q_queue_‹mpo_g‘_skew
(cÚ¡ 
¢d_£q_queue_‹mpo_t
 *
šfo
);

508 
¢d_£q_queue_‹mpo_g‘_skew_ba£
(cÚ¡ 
¢d_£q_queue_‹mpo_t
 *
šfo
);

509 
¢d_£q_queue_‹mpo_£t_‹mpo
(
¢d_£q_queue_‹mpo_t
 *
šfo
, 
‹mpo
);

510 
¢d_£q_queue_‹mpo_£t_µq
(
¢d_£q_queue_‹mpo_t
 *
šfo
, 
µq
);

511 
¢d_£q_queue_‹mpo_£t_skew
(
¢d_£q_queue_‹mpo_t
 *
šfo
, 
skew
);

512 
¢d_£q_queue_‹mpo_£t_skew_ba£
(
¢d_£q_queue_‹mpo_t
 *
šfo
, 
ba£
);

514 
¢d_£q_g‘_queue_‹mpo
(
¢d_£q_t
 *
hªdË
, 
q
, 
¢d_£q_queue_‹mpo_t
 *
‹mpo
);

515 
¢d_£q_£t_queue_‹mpo
(
¢d_£q_t
 *
hªdË
, 
q
, 
¢d_£q_queue_‹mpo_t
 *
‹mpo
);

522 
SND_SEQ_TIMER_ALSA
 = 0,

523 
SND_SEQ_TIMER_MIDI_CLOCK
 = 1,

524 
SND_SEQ_TIMER_MIDI_TICK
 = 2

525 } 
	t¢d_£q_queue_tim”_ty³_t
;

527 
size_t
 
¢d_£q_queue_tim”_sizeof
();

529 
	#¢d_£q_queue_tim”_®loÿ
(
±r
) \

530 
	`__¢d_®loÿ
(
±r
, 
¢d_£q_queue_tim”
)

	)

531 
¢d_£q_queue_tim”_m®loc
(
¢d_£q_queue_tim”_t
 **
±r
);

532 
¢d_£q_queue_tim”_ä“
(
¢d_£q_queue_tim”_t
 *
±r
);

533 
¢d_£q_queue_tim”_cİy
(
¢d_£q_queue_tim”_t
 *
d¡
, cÚ¡ snd_£q_queue_tim”_ˆ*
¤c
);

535 
¢d_£q_queue_tim”_g‘_queue
(cÚ¡ 
¢d_£q_queue_tim”_t
 *
šfo
);

536 
¢d_£q_queue_tim”_ty³_t
 
¢d_£q_queue_tim”_g‘_ty³
(cÚ¡ 
¢d_£q_queue_tim”_t
 *
šfo
);

537 cÚ¡ 
¢d_tim”_id_t
 *
¢d_£q_queue_tim”_g‘_id
(cÚ¡ 
¢d_£q_queue_tim”_t
 *
šfo
);

538 
¢d_£q_queue_tim”_g‘_»sŞutiÚ
(cÚ¡ 
¢d_£q_queue_tim”_t
 *
šfo
);

540 
¢d_£q_queue_tim”_£t_ty³
(
¢d_£q_queue_tim”_t
 *
šfo
, 
¢d_£q_queue_tim”_ty³_t
 
ty³
);

541 
¢d_£q_queue_tim”_£t_id
(
¢d_£q_queue_tim”_t
 *
šfo
, cÚ¡ 
¢d_tim”_id_t
 *
id
);

542 
¢d_£q_queue_tim”_£t_»sŞutiÚ
(
¢d_£q_queue_tim”_t
 *
šfo
, 
»sŞutiÚ
);

544 
¢d_£q_g‘_queue_tim”
(
¢d_£q_t
 *
hªdË
, 
q
, 
¢d_£q_queue_tim”_t
 *
tim”
);

545 
¢d_£q_£t_queue_tim”
(
¢d_£q_t
 *
hªdË
, 
q
, 
¢d_£q_queue_tim”_t
 *
tim”
);

556 
¢d_£q_ä“_ev’t
(
¢d_£q_ev’t_t
 *
ev
);

557 
ssize_t
 
¢d_£q_ev’t_Ëngth
(
¢d_£q_ev’t_t
 *
ev
);

558 
¢d_£q_ev’t_ouut
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_ev’t_t
 *
ev
);

559 
¢d_£q_ev’t_ouut_bufãr
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_ev’t_t
 *
ev
);

560 
¢d_£q_ev’t_ouut_dœeù
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_ev’t_t
 *
ev
);

561 
¢d_£q_ev’t_šput
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_ev’t_t
 **
ev
);

562 
¢d_£q_ev’t_šput_³ndšg
(
¢d_£q_t
 *
£q
, 
ãtch_£qu’ûr
);

563 
¢d_£q_d¿š_ouut
(
¢d_£q_t
 *
hªdË
);

564 
¢d_£q_ev’t_ouut_³ndšg
(
¢d_£q_t
 *
£q
);

565 
¢d_£q_exŒaù_ouut
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_ev’t_t
 **
ev
);

566 
¢d_£q_drİ_ouut
(
¢d_£q_t
 *
hªdË
);

567 
¢d_£q_drİ_ouut_bufãr
(
¢d_£q_t
 *
hªdË
);

568 
¢d_£q_drİ_šput
(
¢d_£q_t
 *
hªdË
);

569 
¢d_£q_drİ_šput_bufãr
(
¢d_£q_t
 *
hªdË
);

572 
_¢d_£q_»move_ev’ts
 
	t¢d_£q_»move_ev’ts_t
;

575 
	#SND_SEQ_REMOVE_INPUT
 (1<<0è

	)

576 
	#SND_SEQ_REMOVE_OUTPUT
 (1<<1è

	)

577 
	#SND_SEQ_REMOVE_DEST
 (1<<2è

	)

578 
	#SND_SEQ_REMOVE_DEST_CHANNEL
 (1<<3è

	)

579 
	#SND_SEQ_REMOVE_TIME_BEFORE
 (1<<4è

	)

580 
	#SND_SEQ_REMOVE_TIME_AFTER
 (1<<5è

	)

581 
	#SND_SEQ_REMOVE_TIME_TICK
 (1<<6è

	)

582 
	#SND_SEQ_REMOVE_EVENT_TYPE
 (1<<7è

	)

583 
	#SND_SEQ_REMOVE_IGNORE_OFF
 (1<<8è

	)

584 
	#SND_SEQ_REMOVE_TAG_MATCH
 (1<<9è

	)

586 
size_t
 
¢d_£q_»move_ev’ts_sizeof
();

588 
	#¢d_£q_»move_ev’ts_®loÿ
(
±r
) \

589 
	`__¢d_®loÿ
(
±r
, 
¢d_£q_»move_ev’ts
)

	)

590 
¢d_£q_»move_ev’ts_m®loc
(
¢d_£q_»move_ev’ts_t
 **
±r
);

591 
¢d_£q_»move_ev’ts_ä“
(
¢d_£q_»move_ev’ts_t
 *
±r
);

592 
¢d_£q_»move_ev’ts_cİy
(
¢d_£q_»move_ev’ts_t
 *
d¡
, cÚ¡ snd_£q_»move_ev’ts_ˆ*
¤c
);

594 
¢d_£q_»move_ev’ts_g‘_cÚd™iÚ
(cÚ¡ 
¢d_£q_»move_ev’ts_t
 *
šfo
);

595 
¢d_£q_»move_ev’ts_g‘_queue
(cÚ¡ 
¢d_£q_»move_ev’ts_t
 *
šfo
);

596 cÚ¡ 
¢d_£q_time¡amp_t
 *
¢d_£q_»move_ev’ts_g‘_time
(cÚ¡ 
¢d_£q_»move_ev’ts_t
 *
šfo
);

597 cÚ¡ 
¢d_£q_addr_t
 *
¢d_£q_»move_ev’ts_g‘_de¡
(cÚ¡ 
¢d_£q_»move_ev’ts_t
 *
šfo
);

598 
¢d_£q_»move_ev’ts_g‘_chªÃl
(cÚ¡ 
¢d_£q_»move_ev’ts_t
 *
šfo
);

599 
¢d_£q_»move_ev’ts_g‘_ev’t_ty³
(cÚ¡ 
¢d_£q_»move_ev’ts_t
 *
šfo
);

600 
¢d_£q_»move_ev’ts_g‘_g
(cÚ¡ 
¢d_£q_»move_ev’ts_t
 *
šfo
);

602 
¢d_£q_»move_ev’ts_£t_cÚd™iÚ
(
¢d_£q_»move_ev’ts_t
 *
šfo
, 
æags
);

603 
¢d_£q_»move_ev’ts_£t_queue
(
¢d_£q_»move_ev’ts_t
 *
šfo
, 
queue
);

604 
¢d_£q_»move_ev’ts_£t_time
(
¢d_£q_»move_ev’ts_t
 *
šfo
, cÚ¡ 
¢d_£q_time¡amp_t
 *
time
);

605 
¢d_£q_»move_ev’ts_£t_de¡
(
¢d_£q_»move_ev’ts_t
 *
šfo
, cÚ¡ 
¢d_£q_addr_t
 *
addr
);

606 
¢d_£q_»move_ev’ts_£t_chªÃl
(
¢d_£q_»move_ev’ts_t
 *
šfo
, 
chªÃl
);

607 
¢d_£q_»move_ev’ts_£t_ev’t_ty³
(
¢d_£q_»move_ev’ts_t
 *
šfo
, 
ty³
);

608 
¢d_£q_»move_ev’ts_£t_g
(
¢d_£q_»move_ev’ts_t
 *
šfo
, 
g
);

610 
¢d_£q_»move_ev’ts
(
¢d_£q_t
 *
hªdË
, 
¢d_£q_»move_ev’ts_t
 *
šfo
);

612 
¢d_£q_ump_ev’t_ouut
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_ev’t_t
 *
ev
);

613 
¢d_£q_ump_ev’t_ouut_bufãr
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_ev’t_t
 *
ev
);

614 
¢d_£q_ump_exŒaù_ouut
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_ev’t_t
 **
ev_»s
);

615 
¢d_£q_ump_ev’t_ouut_dœeù
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_ev’t_t
 *
ev
);

616 
¢d_£q_ump_ev’t_šput
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_ev’t_t
 **
ev
);

627 
¢d_£q_£t_b™
(
Ä
, *
¬¿y
);

628 
¢d_£q_un£t_b™
(
Ä
, *
¬¿y
);

629 
¢d_£q_chªge_b™
(
Ä
, *
¬¿y
);

630 
¢d_£q_g‘_b™
(
Ä
, *
¬¿y
);

644 
SND_SEQ_EVFLG_RESULT
,

645 
SND_SEQ_EVFLG_NOTE
,

646 
SND_SEQ_EVFLG_CONTROL
,

647 
SND_SEQ_EVFLG_QUEUE
,

648 
SND_SEQ_EVFLG_SYSTEM
,

649 
SND_SEQ_EVFLG_MESSAGE
,

650 
SND_SEQ_EVFLG_CONNECTION
,

651 
SND_SEQ_EVFLG_SAMPLE
,

652 
SND_SEQ_EVFLG_USERS
,

653 
SND_SEQ_EVFLG_INSTR
,

654 
SND_SEQ_EVFLG_QUOTE
,

655 
SND_SEQ_EVFLG_NONE
,

656 
SND_SEQ_EVFLG_RAW
,

657 
SND_SEQ_EVFLG_FIXED
,

658 
SND_SEQ_EVFLG_VARIABLE
,

659 
SND_SEQ_EVFLG_VARUSR


663 
SND_SEQ_EVFLG_NOTE_ONEARG
,

664 
SND_SEQ_EVFLG_NOTE_TWOARG


668 
SND_SEQ_EVFLG_QUEUE_NOARG
,

669 
SND_SEQ_EVFLG_QUEUE_TICK
,

670 
SND_SEQ_EVFLG_QUEUE_TIME
,

671 
SND_SEQ_EVFLG_QUEUE_VALUE


679 cÚ¡ 
¢d_£q_ev’t_ty³s
[];

681 
	#_SND_SEQ_TYPE
(
x
è(1<<(x)è

	)

682 
	#_SND_SEQ_TYPE_OPT
(
x
è((x)<<24è

	)

685 
	#¢d_£q_ty³_check
(
ev
,
x
è(
¢d_£q_ev’t_ty³s
[Óv)->
ty³
] & 
	`_SND_SEQ_TYPE
(x))

	)

688 
	#¢d_£q_ev_is_»suÉ_ty³
(
ev
) \

689 
	`¢d_£q_ty³_check
(
ev
, 
SND_SEQ_EVFLG_RESULT
)

	)

691 
	#¢d_£q_ev_is_nÙe_ty³
(
ev
) \

692 
	`¢d_£q_ty³_check
(
ev
, 
SND_SEQ_EVFLG_NOTE
)

	)

694 
	#¢d_£q_ev_is_cÚŒŞ_ty³
(
ev
) \

695 
	`¢d_£q_ty³_check
(
ev
, 
SND_SEQ_EVFLG_CONTROL
)

	)

697 
	#¢d_£q_ev_is_chªÃl_ty³
(
ev
) \

698 (
¢d_£q_ev’t_ty³s
[(
ev
)->
ty³
] & (
	`_SND_SEQ_TYPE
(
SND_SEQ_EVFLG_NOTE
è| _SND_SEQ_TYPE(
SND_SEQ_EVFLG_CONTROL
)))

	)

701 
	#¢d_£q_ev_is_queue_ty³
(
ev
) \

702 
	`¢d_£q_ty³_check
(
ev
, 
SND_SEQ_EVFLG_QUEUE
)

	)

704 
	#¢d_£q_ev_is_mes§ge_ty³
(
ev
) \

705 
	`¢d_£q_ty³_check
(
ev
, 
SND_SEQ_EVFLG_MESSAGE
)

	)

707 
	#¢d_£q_ev_is_subsüibe_ty³
(
ev
) \

708 
	`¢d_£q_ty³_check
(
ev
, 
SND_SEQ_EVFLG_CONNECTION
)

	)

710 
	#¢d_£q_ev_is_§m¶e_ty³
(
ev
) \

711 
	`¢d_£q_ty³_check
(
ev
, 
SND_SEQ_EVFLG_SAMPLE
)

	)

713 
	#¢d_£q_ev_is_u£r_ty³
(
ev
) \

714 
	`¢d_£q_ty³_check
(
ev
, 
SND_SEQ_EVFLG_USERS
)

	)

716 
	#¢d_£q_ev_is_š¡r_ty³
(
ev
) \

717 
	`¢d_£q_ty³_check
(
ev
, 
SND_SEQ_EVFLG_INSTR
)

	)

719 
	#¢d_£q_ev_is_fixed_ty³
(
ev
) \

720 
	`¢d_£q_ty³_check
(
ev
, 
SND_SEQ_EVFLG_FIXED
)

	)

722 
	#¢d_£q_ev_is_v¬ŸbË_ty³
(
ev
) \

723 
	`¢d_£q_ty³_check
(
ev
, 
SND_SEQ_EVFLG_VARIABLE
)

	)

725 
	#¢d_£q_ev_is_v¬u¤_ty³
(
ev
) \

726 
	`¢d_£q_ty³_check
(
ev
, 
SND_SEQ_EVFLG_VARUSR
)

	)

728 
	#¢d_£q_ev_is_»£rved
(
ev
) \

729 (! 
¢d_£q_ev’t_ty³s
[(
ev
)->
ty³
])

	)

735 
	#¢d_£q_ev_is_´iÜ
(
ev
) \

736 (((
ev
)->
æags
 & 
SND_SEQ_PRIORITY_MASK
è=ğ
SND_SEQ_PRIORITY_HIGH
)

	)

739 
	#¢d_£q_ev_Ëngth_ty³
(
ev
) \

740 ((
ev
)->
æags
 & 
SND_SEQ_EVENT_LENGTH_MASK
)

	)

742 
	#¢d_£q_ev_is_fixed
(
ev
) \

743 (
	`¢d_£q_ev_Ëngth_ty³
(
ev
è=ğ
SND_SEQ_EVENT_LENGTH_FIXED
)

	)

745 
	#¢d_£q_ev_is_v¬ŸbË
(
ev
) \

746 (
	`¢d_£q_ev_Ëngth_ty³
(
ev
è=ğ
SND_SEQ_EVENT_LENGTH_VARIABLE
)

	)

748 
	#¢d_£q_ev_is_v¬u¤
(
ev
) \

749 (
	`¢d_£q_ev_Ëngth_ty³
(
ev
è=ğ
SND_SEQ_EVENT_LENGTH_VARUSR
)

	)

752 
	#¢d_£q_ev_time¡amp_ty³
(
ev
) \

753 ((
ev
)->
æags
 & 
SND_SEQ_TIME_STAMP_MASK
)

	)

755 
	#¢d_£q_ev_is_tick
(
ev
) \

756 (
	`¢d_£q_ev_time¡amp_ty³
(
ev
è=ğ
SND_SEQ_TIME_STAMP_TICK
)

	)

758 
	#¢d_£q_ev_is_»®
(
ev
) \

759 (
	`¢d_£q_ev_time¡amp_ty³
(
ev
è=ğ
SND_SEQ_TIME_STAMP_REAL
)

	)

762 
	#¢d_£q_ev_timemode_ty³
(
ev
) \

763 ((
ev
)->
æags
 & 
SND_SEQ_TIME_MODE_MASK
)

	)

765 
	#¢d_£q_ev_is_ab¡ime
(
ev
) \

766 (
	`¢d_£q_ev_timemode_ty³
(
ev
è=ğ
SND_SEQ_TIME_MODE_ABS
)

	)

768 
	#¢d_£q_ev_is_»Éime
(
ev
) \

769 (
	`¢d_£q_ev_timemode_ty³
(
ev
è=ğ
SND_SEQ_TIME_MODE_REL
)

	)

772 
	#¢d_£q_ev_is_dœeù
(
ev
) \

773 ((
ev
)->
queue
 =ğ
SND_SEQ_QUEUE_DIRECT
)

	)

776 
	#¢d_£q_ev_is_ump
(
ev
) \

777 ((
ev
)->
æags
 & 
SND_SEQ_EVENT_UMP
)

	)

781 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seq_event.h

28 #iâdeà
__ALSA_SEQ_EVENT_H


29 
	#__ALSA_SEQ_EVENT_H


	)

41 
	t¢d_£q_ev’t_ty³_t
;

44 
	e¢d_£q_ev’t_ty³
 {

46 
	mSND_SEQ_EVENT_SYSTEM
 = 0,

48 
	mSND_SEQ_EVENT_RESULT
,

51 
	mSND_SEQ_EVENT_NOTE
 = 5,

53 
	mSND_SEQ_EVENT_NOTEON
,

55 
	mSND_SEQ_EVENT_NOTEOFF
,

57 
	mSND_SEQ_EVENT_KEYPRESS
,

60 
	mSND_SEQ_EVENT_CONTROLLER
 = 10,

62 
	mSND_SEQ_EVENT_PGMCHANGE
,

64 
	mSND_SEQ_EVENT_CHANPRESS
,

66 
	mSND_SEQ_EVENT_PITCHBEND
,

68 
	mSND_SEQ_EVENT_CONTROL14
,

70 
	mSND_SEQ_EVENT_NONREGPARAM
,

72 
	mSND_SEQ_EVENT_REGPARAM
,

75 
	mSND_SEQ_EVENT_SONGPOS
 = 20,

77 
	mSND_SEQ_EVENT_SONGSEL
,

79 
	mSND_SEQ_EVENT_QFRAME
,

81 
	mSND_SEQ_EVENT_TIMESIGN
,

83 
	mSND_SEQ_EVENT_KEYSIGN
,

86 
	mSND_SEQ_EVENT_START
 = 30,

88 
	mSND_SEQ_EVENT_CONTINUE
,

90 
	mSND_SEQ_EVENT_STOP
,

92 
	mSND_SEQ_EVENT_SETPOS_TICK
,

94 
	mSND_SEQ_EVENT_SETPOS_TIME
,

96 
	mSND_SEQ_EVENT_TEMPO
,

98 
	mSND_SEQ_EVENT_CLOCK
,

100 
	mSND_SEQ_EVENT_TICK
,

102 
	mSND_SEQ_EVENT_QUEUE_SKEW
,

104 
	mSND_SEQ_EVENT_SYNC_POS
,

107 
	mSND_SEQ_EVENT_TUNE_REQUEST
 = 40,

109 
	mSND_SEQ_EVENT_RESET
,

111 
	mSND_SEQ_EVENT_SENSING
,

114 
	mSND_SEQ_EVENT_ECHO
 = 50,

116 
	mSND_SEQ_EVENT_OSS
,

119 
	mSND_SEQ_EVENT_CLIENT_START
 = 60,

121 
	mSND_SEQ_EVENT_CLIENT_EXIT
,

123 
	mSND_SEQ_EVENT_CLIENT_CHANGE
,

125 
	mSND_SEQ_EVENT_PORT_START
,

127 
	mSND_SEQ_EVENT_PORT_EXIT
,

129 
	mSND_SEQ_EVENT_PORT_CHANGE
,

132 
	mSND_SEQ_EVENT_PORT_SUBSCRIBED
,

134 
	mSND_SEQ_EVENT_PORT_UNSUBSCRIBED
,

137 
	mSND_SEQ_EVENT_USR0
 = 90,

139 
	mSND_SEQ_EVENT_USR1
,

141 
	mSND_SEQ_EVENT_USR2
,

143 
	mSND_SEQ_EVENT_USR3
,

145 
	mSND_SEQ_EVENT_USR4
,

147 
	mSND_SEQ_EVENT_USR5
,

149 
	mSND_SEQ_EVENT_USR6
,

151 
	mSND_SEQ_EVENT_USR7
,

153 
	mSND_SEQ_EVENT_USR8
,

155 
	mSND_SEQ_EVENT_USR9
,

158 
	mSND_SEQ_EVENT_SYSEX
 = 130,

160 
	mSND_SEQ_EVENT_BOUNCE
,

162 
	mSND_SEQ_EVENT_USR_VAR0
 = 135,

164 
	mSND_SEQ_EVENT_USR_VAR1
,

166 
	mSND_SEQ_EVENT_USR_VAR2
,

168 
	mSND_SEQ_EVENT_USR_VAR3
,

170 
	mSND_SEQ_EVENT_USR_VAR4
,

173 
	mSND_SEQ_EVENT_NONE
 = 255

178 
	s¢d_£q_addr
 {

179 
	mş›Á
;

180 
	mpÜt
;

181 } 
	t¢d_£q_addr_t
;

184 
	s¢d_£q_cÚÃù
 {

185 
¢d_£q_addr_t
 
	m£nd”
;

186 
¢d_£q_addr_t
 
	mde¡
;

187 } 
	t¢d_£q_cÚÃù_t
;

191 
	s¢d_£q_»®_time
 {

192 
	mtv_£c
;

193 
	mtv_n£c
;

194 } 
	t¢d_£q_»®_time_t
;

197 
	t¢d_£q_tick_time_t
;

200 
	u¢d_£q_time¡amp
 {

201 
¢d_£q_tick_time_t
 
	mtick
;

202 
¢d_£q_»®_time
 
	mtime
;

203 } 
	t¢d_£q_time¡amp_t
;

211 
	#SND_SEQ_TIME_STAMP_TICK
 (0<<0è

	)

212 
	#SND_SEQ_TIME_STAMP_REAL
 (1<<0è

	)

213 
	#SND_SEQ_TIME_STAMP_MASK
 (1<<0è

	)

215 
	#SND_SEQ_TIME_MODE_ABS
 (0<<1è

	)

216 
	#SND_SEQ_TIME_MODE_REL
 (1<<1è

	)

217 
	#SND_SEQ_TIME_MODE_MASK
 (1<<1è

	)

219 
	#SND_SEQ_EVENT_LENGTH_FIXED
 (0<<2è

	)

220 
	#SND_SEQ_EVENT_LENGTH_VARIABLE
 (1<<2è

	)

221 
	#SND_SEQ_EVENT_LENGTH_VARUSR
 (2<<2è

	)

222 
	#SND_SEQ_EVENT_LENGTH_MASK
 (3<<2è

	)

224 
	#SND_SEQ_PRIORITY_NORMAL
 (0<<4è

	)

225 
	#SND_SEQ_PRIORITY_HIGH
 (1<<4è

	)

226 
	#SND_SEQ_PRIORITY_MASK
 (1<<4è

	)

228 
	#SND_SEQ_EVENT_UMP
 (1<<5è

	)

231 
	s¢d_£q_ev_nÙe
 {

232 
	mchªÃl
;

233 
	mnÙe
;

234 
	mv–oc™y
;

235 
	moff_v–oc™y
;

236 
	mdu¿tiÚ
;

237 } 
	t¢d_£q_ev_nÙe_t
;

240 
	s¢d_£q_ev_ù¾
 {

241 
	mchªÃl
;

242 
	munu£d
[3];

243 
	m·¿m
;

244 sigÃd 
	mv®ue
;

245 } 
	t¢d_£q_ev_ù¾_t
;

248 
	s¢d_£q_ev_¿w8
 {

249 
	md
[12];

250 } 
	t¢d_£q_ev_¿w8_t
;

253 
	s¢d_£q_ev_¿w32
 {

254 
	md
[3];

255 } 
	t¢d_£q_ev_¿w32_t
;

258 
	s¢d_£q_ev_ext
 {

259 
	mËn
;

260 *
	m±r
;

261 } 
__©Œibu‹__
((
·cked
));

263 
¢d_£q_ev_ext
 
	t¢d_£q_ev_ext_t
;

264 #ifdeà
DOC_HIDDEN


266 
¢d_£q_ev_ext
 
	t¢d_£q_ev_ext_t
;

270 
	s¢d_£q_»suÉ
 {

271 
	mev’t
;

272 
	m»suÉ
;

273 } 
	t¢d_£q_»suÉ_t
;

276 
	s¢d_£q_queue_skew
 {

277 
	mv®ue
;

278 
	mba£
;

279 } 
	t¢d_£q_queue_skew_t
;

282 
	s¢d_£q_ev_queue_cÚŒŞ
 {

283 
	mqueue
;

284 
	munu£d
[3];

286 sigÃd 
	mv®ue
;

287 
¢d_£q_time¡amp_t
 
	mtime
;

288 
	mpos™iÚ
;

289 
¢d_£q_queue_skew_t
 
	mskew
;

290 
	md32
[2];

291 
	md8
[8];

292 } 
	m·¿m
;

293 } 
	t¢d_£q_ev_queue_cÚŒŞ_t
;

296 
	u¢d_£q_ev’t_d©a
 {

297 
¢d_£q_ev_nÙe_t
 
	mnÙe
;

298 
¢d_£q_ev_ù¾_t
 
	mcÚŒŞ
;

299 
¢d_£q_ev_¿w8_t
 
	m¿w8
;

300 
¢d_£q_ev_¿w32_t
 
	m¿w32
;

301 
¢d_£q_ev_ext_t
 
	mext
;

302 
¢d_£q_ev_queue_cÚŒŞ_t
 
	mqueue
;

303 
¢d_£q_time¡amp_t
 
	mtime
;

304 
¢d_£q_addr_t
 
	maddr
;

305 
¢d_£q_cÚÃù_t
 
	mcÚÃù
;

306 
¢d_£q_»suÉ_t
 
	m»suÉ
;

307 } 
	t¢d_£q_ev’t_d©a_t
;

310 
	s¢d_£q_ev’t
 {

311 
¢d_£q_ev’t_ty³_t
 
	mty³
;

312 
	mæags
;

313 
	mg
;

315 
	mqueue
;

316 
¢d_£q_time¡amp_t
 
	mtime
;

318 
¢d_£q_addr_t
 
	msourû
;

319 
¢d_£q_addr_t
 
	mde¡
;

321 
¢d_£q_ev’t_d©a_t
 
	md©a
;

322 } 
	t¢d_£q_ev’t_t
;

325 
	s¢d_£q_ump_ev’t
 {

326 
¢d_£q_ev’t_ty³_t
 
	mty³
;

327 
	mæags
;

328 
	mg
;

329 
	mqueue
;

330 
¢d_£q_time¡amp_t
 
	mtime
;

331 
¢d_£q_addr_t
 
	msourû
;

332 
¢d_£q_addr_t
 
	mde¡
;

335 
¢d_£q_ev’t_d©a_t
 
	md©a
;

336 
	mump
[4];

338 } 
	t¢d_£q_ump_ev’t_t
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seq_midi_event.h

28 #iâdeà
__ALSA_SEQ_MIDI_EVENT_H


29 
	#__ALSA_SEQ_MIDI_EVENT_H


	)

31 #ifdeà
__ılu¥lus


43 
¢d_midi_ev’t
 
	t¢d_midi_ev’t_t
;

45 
¢d_midi_ev’t_Ãw
(
size_t
 
bufsize
, 
¢d_midi_ev’t_t
 **
rdev
);

46 
¢d_midi_ev’t_»size_bufãr
(
¢d_midi_ev’t_t
 *
dev
, 
size_t
 
bufsize
);

47 
¢d_midi_ev’t_ä“
(
¢d_midi_ev’t_t
 *
dev
);

48 
¢d_midi_ev’t_š™
(
¢d_midi_ev’t_t
 *
dev
);

49 
¢d_midi_ev’t_»£t_’code
(
¢d_midi_ev’t_t
 *
dev
);

50 
¢d_midi_ev’t_»£t_decode
(
¢d_midi_ev’t_t
 *
dev
);

51 
¢d_midi_ev’t_no_¡©us
(
¢d_midi_ev’t_t
 *
dev
, 
Ú
);

53 
¢d_midi_ev’t_’code
(
¢d_midi_ev’t_t
 *
dev
, cÚ¡ *
buf
, 
couÁ
, 
¢d_£q_ev’t_t
 *
ev
);

54 
¢d_midi_ev’t_’code_by‹
(
¢d_midi_ev’t_t
 *
dev
, 
c
, 
¢d_£q_ev’t_t
 *
ev
);

56 
¢d_midi_ev’t_decode
(
¢d_midi_ev’t_t
 *
dev
, *
buf
, 
couÁ
, cÚ¡ 
¢d_£q_ev’t_t
 *
ev
);

60 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seqmid.h

28 #iâdeà
__ALSA_SEQMID_H


29 
	#__ALSA_SEQMID_H


	)

31 #ifdeà
__ılu¥lus


48 
šlše
 
¢d_£q_ev_ş—r
(
¢d_£q_ev’t_t
 *
ev
)

50 
mem£t
(
ev
, 0, (*ev));

59 
šlše
 
¢d_£q_ump_ev_ş—r
(
¢d_£q_ump_ev’t_t
 *
ev
)

61 
mem£t
(
ev
, 0, (*ev));

71 
	#¢d_£q_ev_£t_g
(
ev
,
t
) \

72 ((
ev
)->
g
 = (
t
))

	)

84 
	#¢d_£q_ev_£t_de¡
(
ev
,
c
,
p
) \

85 ((
ev
)->
de¡
.
ş›Á
 = (
c
), (ev)->de¡.
pÜt
 = (
p
))

	)

95 
	#¢d_£q_ev_£t_subs
(
ev
) \

96 ((
ev
)->
de¡
.
ş›Á
 = 
SND_SEQ_ADDRESS_SUBSCRIBERS
,\

97 (
ev
)->
de¡
.
pÜt
 = 
SND_SEQ_ADDRESS_UNKNOWN
)

	)

107 
	#¢d_£q_ev_£t_brßdÿ¡
(
ev
) \

108 ((
ev
)->
de¡
.
ş›Á
 = 
SND_SEQ_ADDRESS_BROADCAST
,\

109 (
ev
)->
de¡
.
pÜt
 = 
SND_SEQ_ADDRESS_BROADCAST
)

	)

118 
	#¢d_£q_ev_£t_sourû
(
ev
,
p
) \

119 ((
ev
)->
sourû
.
pÜt
 = (
p
))

	)

130 
	#¢d_£q_ev_£t_dœeù
(
ev
) \

131 ((
ev
)->
queue
 = 
SND_SEQ_QUEUE_DIRECT
)

	)

145 
	#¢d_£q_ev_scheduË_tick
(
ev
, 
q
, 
»Ïtive
, 
‰ick
) \

146 ((
ev
)->
æags
 &ğ~(
SND_SEQ_TIME_STAMP_MASK
 | 
SND_SEQ_TIME_MODE_MASK
),\

147 (
ev
)->
æags
 |ğ
SND_SEQ_TIME_STAMP_TICK
,\

148 (
ev
)->
æags
 |ğ(
»Ïtive
è? 
SND_SEQ_TIME_MODE_REL
 : 
SND_SEQ_TIME_MODE_ABS
,\

149 (
ev
)->
time
.
tick
 = (
‰ick
),\

150 (
ev
)->
queue
 = (
q
))

	)

164 
	#¢d_£q_ev_scheduË_»®
(
ev
, 
q
, 
»Ïtive
, 
¹ime
) \

165 ((
ev
)->
æags
 &ğ~(
SND_SEQ_TIME_STAMP_MASK
 | 
SND_SEQ_TIME_MODE_MASK
),\

166 (
ev
)->
æags
 |ğ
SND_SEQ_TIME_STAMP_REAL
,\

167 (
ev
)->
æags
 |ğ(
»Ïtive
è? 
SND_SEQ_TIME_MODE_REL
 : 
SND_SEQ_TIME_MODE_ABS
,\

168 (
ev
)->
time
.timğ*(
¹ime
),\

169 (
ev
)->
queue
 = (
q
))

	)

176 
	#¢d_£q_ev_£t_´iÜ™y
(
ev
, 
high_´iÜ
) \

177 ((
ev
)->
æags
 &ğ~
SND_SEQ_PRIORITY_MASK
,\

178 (
ev
)->
æags
 |ğ(
high_´iÜ
è? 
SND_SEQ_PRIORITY_HIGH
 : 
SND_SEQ_PRIORITY_NORMAL
)

	)

188 
	#¢d_£q_ev_£t_fixed
(
ev
) \

189 ((
ev
)->
æags
 &ğ~
SND_SEQ_EVENT_LENGTH_MASK
,\

190 (
ev
)->
æags
 |ğ
SND_SEQ_EVENT_LENGTH_FIXED
)

	)

202 
	#¢d_£q_ev_£t_v¬ŸbË
(
ev
, 
d©®’
, 
d©­Œ
) \

203 ((
ev
)->
æags
 &ğ~
SND_SEQ_EVENT_LENGTH_MASK
,\

204 (
ev
)->
æags
 |ğ
SND_SEQ_EVENT_LENGTH_VARIABLE
,\

205 (
ev
)->
d©a
.
ext
.
Ën
 = (
d©®’
),\

206 (
ev
)->
d©a
.
ext
.
±r
 = (
d©­Œ
))

	)

218 
	#¢d_£q_ev_£t_v¬u¤
(
ev
, 
d©®’
, 
d©­Œ
) \

219 ((
ev
)->
æags
 &ğ~
SND_SEQ_EVENT_LENGTH_MASK
,\

220 (
ev
)->
æags
 |ğ
SND_SEQ_EVENT_LENGTH_VARUSR
,\

221 (
ev
)->
d©a
.
ext
.
Ën
 = (
d©®’
),\

222 (
ev
)->
d©a
.
ext
.
±r
 = (
d©­Œ
))

	)

231 
	#¢d_£q_ev_£t_queue_cÚŒŞ
(
ev
, 
typ
, 
q
, 
v®
) \

232 ((
ev
)->
ty³
 = (
typ
),\

233 
	`¢d_£q_ev_£t_de¡
(
ev
, 
SND_SEQ_CLIENT_SYSTEM
, 
SND_SEQ_PORT_SYSTEM_TIMER
),\

234 (
ev
)->
d©a
.
queue
.queuğ(
q
),\

235 (
ev
)->
d©a
.
queue
.
·¿m
.
v®ue
 = (
v®
))

	)

244 
	#¢d_£q_ev_£t_queue_¡¬t
(
ev
, 
q
) \

245 
	`¢d_£q_ev_£t_queue_cÚŒŞ
(
ev
, 
SND_SEQ_EVENT_START
, 
q
, 0)

	)

254 
	#¢d_£q_ev_£t_queue_¡İ
(
ev
, 
q
) \

255 
	`¢d_£q_ev_£t_queue_cÚŒŞ
(
ev
, 
SND_SEQ_EVENT_STOP
, 
q
, 0)

	)

264 
	#¢d_£q_ev_£t_queue_cÚtšue
(
ev
, 
q
) \

265 
	`¢d_£q_ev_£t_queue_cÚŒŞ
(
ev
, 
SND_SEQ_EVENT_CONTINUE
, 
q
, 0)

	)

273 
	#¢d_£q_ev_£t_queue_‹mpo
(
ev
, 
q
, 
v®
) \

274 
	`¢d_£q_ev_£t_queue_cÚŒŞ
(
ev
, 
SND_SEQ_EVENT_TEMPO
, 
q
, 
v®
)

	)

282 
	#¢d_£q_ev_£t_queue_pos_»®
(
ev
, 
q
, 
¹ime
) \

283 ((
ev
)->
ty³
 = 
SND_SEQ_EVENT_SETPOS_TIME
,\

284 
	`¢d_£q_ev_£t_de¡
(
ev
, 
SND_SEQ_CLIENT_SYSTEM
, 
SND_SEQ_PORT_SYSTEM_TIMER
),\

285 (
ev
)->
d©a
.
queue
.queuğ(
q
),\

286 (
ev
)->
d©a
.
queue
.
·¿m
.
time
.timğ*(
¹ime
))

	)

294 
	#¢d_£q_ev_£t_queue_pos_tick
(
ev
, 
q
, 
‰ime
) \

295 ((
ev
)->
ty³
 = 
SND_SEQ_EVENT_SETPOS_TICK
,\

296 
	`¢d_£q_ev_£t_de¡
(
ev
, 
SND_SEQ_CLIENT_SYSTEM
, 
SND_SEQ_PORT_SYSTEM_TIMER
),\

297 (
ev
)->
d©a
.
queue
.queuğ(
q
),\

298 (
ev
)->
d©a
.
queue
.
·¿m
.
time
.
tick
 = (
‰ime
))

	)

304 
šlše
 
¢d_£q_ev_£t_ump
(
¢d_£q_ump_ev’t_t
 *
ev
)

306 
ev
->
æags
 |ğ
SND_SEQ_EVENT_UMP
;

307 
ev
->
ty³
 = 0;

316 
šlše
 
¢d_£q_ev_£t_ump_d©a
(
¢d_£q_ump_ev’t_t
 *
ev
, *
d©a
, 
size_t
 
by‹s
)

318 ià(
by‹s
 > 16)

319  -
EINVAL
;

320 
¢d_£q_ev_£t_ump
(
ev
);

321 
memıy
(
ev
->
ump
, 
d©a
, 
by‹s
);

326 
¢d_£q_cÚŒŞ_queue
(
¢d_£q_t
 *
£q
, 
q
, 
ty³
, 
v®ue
, 
¢d_£q_ev’t_t
 *
ev
);

334 
	#¢d_£q_¡¬t_queue
(
£q
, 
q
, 
ev
) \

335 
	`¢d_£q_cÚŒŞ_queue
(
£q
, 
q
, 
SND_SEQ_EVENT_START
, 0, 
ev
)

	)

343 
	#¢d_£q_¡İ_queue
(
£q
, 
q
, 
ev
) \

344 
	`¢d_£q_cÚŒŞ_queue
(
£q
, 
q
, 
SND_SEQ_EVENT_STOP
, 0, 
ev
)

	)

352 
	#¢d_£q_cÚtšue_queue
(
£q
, 
q
, 
ev
) \

353 
	`¢d_£q_cÚŒŞ_queue
(
£q
, 
q
, 
SND_SEQ_EVENT_CONTINUE
, 0, 
ev
)

	)

362 
	#¢d_£q_chªge_queue_‹mpo
(
£q
, 
q
, 
‹mpo
, 
ev
) \

363 
	`¢d_£q_cÚŒŞ_queue
(
£q
, 
q
, 
SND_SEQ_EVENT_TEMPO
, 
‹mpo
, 
ev
)

	)

366 
¢d_£q_ü—‹_sim¶e_pÜt
(
¢d_£q_t
 *
£q
, cÚ¡ *
Çme
,

367 
ÿps
, 
ty³
);

369 
¢d_£q_d–‘e_sim¶e_pÜt
(
¢d_£q_t
 *
£q
, 
pÜt
);

374 
¢d_£q_cÚÃù_äom
(
¢d_£q_t
 *
£q
, 
my_pÜt
, 
¤c_ş›Á
, 
¤c_pÜt
);

375 
¢d_£q_cÚÃù_to
(
¢d_£q_t
 *
£q
, 
my_pÜt
, 
de¡_ş›Á
, 
de¡_pÜt
);

376 
¢d_£q_discÚÃù_äom
(
¢d_£q_t
 *
£q
, 
my_pÜt
, 
¤c_ş›Á
, 
¤c_pÜt
);

377 
¢d_£q_discÚÃù_to
(
¢d_£q_t
 *
£q
, 
my_pÜt
, 
de¡_ş›Á
, 
de¡_pÜt
);

382 
¢d_£q_£t_ş›Á_Çme
(
¢d_£q_t
 *
£q
, cÚ¡ *
Çme
);

383 
¢d_£q_£t_ş›Á_ev’t_f‹r
(
¢d_£q_t
 *
£q
, 
ev’t_ty³
);

384 
¢d_£q_£t_ş›Á_midi_v”siÚ
(
¢d_£q_t
 *
£q
, 
midi_v”siÚ
);

385 
¢d_£q_£t_ş›Á_ump_cÚv”siÚ
(
¢d_£q_t
 *
£q
, 
’abË
);

386 
¢d_£q_£t_ş›Á_poŞ_ouut
(
¢d_£q_t
 *
£q
, 
size_t
 
size
);

387 
¢d_£q_£t_ş›Á_poŞ_ouut_room
(
¢d_£q_t
 *
£q
, 
size_t
 
size
);

388 
¢d_£q_£t_ş›Á_poŞ_šput
(
¢d_£q_t
 *
£q
, 
size_t
 
size
);

390 
¢d_£q_sync_ouut_queue
(
¢d_£q_t
 *
£q
);

395 
¢d_£q_·r£_add»ss
(
¢d_£q_t
 *
£q
, 
¢d_£q_addr_t
 *
addr
, cÚ¡ *
¡r
);

400 
¢d_£q_»£t_poŞ_ouut
(
¢d_£q_t
 *
£q
);

401 
¢d_£q_»£t_poŞ_šput
(
¢d_£q_t
 *
£q
);

411 
	#¢d_£q_ev_£t_nÙe
(
ev
, 
ch
, 
key
, 
v–
, 
dur
) \

412 ((
ev
)->
ty³
 = 
SND_SEQ_EVENT_NOTE
,\

413 
	`¢d_£q_ev_£t_fixed
(
ev
),\

414 (
ev
)->
d©a
.
nÙe
.
chªÃl
 = (
ch
),\

415 (
ev
)->
d©a
.
nÙe
.nÙğ(
key
),\

416 (
ev
)->
d©a
.
nÙe
.
v–oc™y
 = (
v–
),\

417 (
ev
)->
d©a
.
nÙe
.
du¿tiÚ
 = (
dur
))

	)

426 
	#¢d_£q_ev_£t_nÙeÚ
(
ev
, 
ch
, 
key
, 
v–
) \

427 ((
ev
)->
ty³
 = 
SND_SEQ_EVENT_NOTEON
,\

428 
	`¢d_£q_ev_£t_fixed
(
ev
),\

429 (
ev
)->
d©a
.
nÙe
.
chªÃl
 = (
ch
),\

430 (
ev
)->
d©a
.
nÙe
.nÙğ(
key
),\

431 (
ev
)->
d©a
.
nÙe
.
v–oc™y
 = (
v–
))

	)

440 
	#¢d_£q_ev_£t_nÙeoff
(
ev
, 
ch
, 
key
, 
v–
) \

441 ((
ev
)->
ty³
 = 
SND_SEQ_EVENT_NOTEOFF
,\

442 
	`¢d_£q_ev_£t_fixed
(
ev
),\

443 (
ev
)->
d©a
.
nÙe
.
chªÃl
 = (
ch
),\

444 (
ev
)->
d©a
.
nÙe
.nÙğ(
key
),\

445 (
ev
)->
d©a
.
nÙe
.
v–oc™y
 = (
v–
))

	)

454 
	#¢d_£q_ev_£t_key´ess
(
ev
,
ch
,
key
,
v–
) \

455 ((
ev
)->
ty³
 = 
SND_SEQ_EVENT_KEYPRESS
,\

456 
	`¢d_£q_ev_£t_fixed
(
ev
),\

457 (
ev
)->
d©a
.
nÙe
.
chªÃl
 = (
ch
),\

458 (
ev
)->
d©a
.
nÙe
.nÙğ(
key
),\

459 (
ev
)->
d©a
.
nÙe
.
v–oc™y
 = (
v–
))

	)

468 
	#¢d_£q_ev_£t_cÚŒŞËr
(
ev
,
ch
,
cc
,
v®
) \

469 ((
ev
)->
ty³
 = 
SND_SEQ_EVENT_CONTROLLER
,\

470 
	`¢d_£q_ev_£t_fixed
(
ev
),\

471 (
ev
)->
d©a
.
cÚŒŞ
.
chªÃl
 = (
ch
),\

472 (
ev
)->
d©a
.
cÚŒŞ
.
·¿m
 = (
cc
),\

473 (
ev
)->
d©a
.
cÚŒŞ
.
v®ue
 = (
v®
))

	)

481 
	#¢d_£q_ev_£t_pgmchªge
(
ev
,
ch
,
v®
) \

482 ((
ev
)->
ty³
 = 
SND_SEQ_EVENT_PGMCHANGE
,\

483 
	`¢d_£q_ev_£t_fixed
(
ev
),\

484 (
ev
)->
d©a
.
cÚŒŞ
.
chªÃl
 = (
ch
),\

485 (
ev
)->
d©a
.
cÚŒŞ
.
v®ue
 = (
v®
))

	)

493 
	#¢d_£q_ev_£t_p™chb’d
(
ev
,
ch
,
v®
) \

494 ((
ev
)->
ty³
 = 
SND_SEQ_EVENT_PITCHBEND
,\

495 
	`¢d_£q_ev_£t_fixed
(
ev
),\

496 (
ev
)->
d©a
.
cÚŒŞ
.
chªÃl
 = (
ch
),\

497 (
ev
)->
d©a
.
cÚŒŞ
.
v®ue
 = (
v®
))

	)

505 
	#¢d_£q_ev_£t_chª´ess
(
ev
,
ch
,
v®
) \

506 ((
ev
)->
ty³
 = 
SND_SEQ_EVENT_CHANPRESS
,\

507 
	`¢d_£q_ev_£t_fixed
(
ev
),\

508 (
ev
)->
d©a
.
cÚŒŞ
.
chªÃl
 = (
ch
),\

509 (
ev
)->
d©a
.
cÚŒŞ
.
v®ue
 = (
v®
))

	)

519 
	#¢d_£q_ev_£t_sy£x
(
ev
,
d©®’
,
d©­Œ
) \

520 ((
ev
)->
ty³
 = 
SND_SEQ_EVENT_SYSEX
,\

521 
	`¢d_£q_ev_£t_v¬ŸbË
(
ev
, 
d©®’
, 
d©­Œ
))

	)

525 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asequencer.h

1 
	~<®§/sound/u­i/a£qu’ûr.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asoc.h

1 
	~<®§/sound/u­i/asoc.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asound.h

2 
	~<®§/sound/ty³_com·t.h
>

4 
	~<®§/sound/u­i/asound.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asound_fm.h

1 
	~<®§/sound/u­i/asound_fm.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/emu10k1.h

1 
	~<®§/sound/ty³_com·t.h
>

2 
	~<®§/sound/u­i/emu10k1.h
>

3 #iâdeà
__emu10k1_ty³_defšed


4 
	#__emu10k1_ty³_defšed


	)

5 
¢d_emu10k1_fx8010_šfo
 
	temu10k1_fx8010_šfo_t
;

6 
¢d_emu10k1_fx8010_cÚŒŞ_g´
 
	temu10k1_fx8010_cÚŒŞ_g´_t
;

7 
¢d_emu10k1_fx8010_code
 
	temu10k1_fx8010_code_t
;

8 
¢d_emu10k1_fx8010_Œam
 
	temu10k1_fx8010_Œam_t
;

9 
¢d_emu10k1_fx8010_pcm_»c
 
	temu10k1_fx8010_pcm_t
;

10 
emu10k1_ùl_–em_id
 
	temu10k1_ùl_–em_id_t
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/hdsp.h

1 
	~<®§/sound/ty³_com·t.h
>

2 
	~<®§/sound/u­i/hd¥.h
>

3 #iâdeà
__hd¥_ty³_defšed


4 
	#__hd¥_ty³_defšed


	)

5 
HDSP_IO_Ty³
 
	tHDSP_IO_Ty³
;

6 
hd¥_³ak_rms
 
	thd¥_³ak_rms_t
;

7 
hd¥_cÚfig_šfo
 
	thd¥_cÚfig_šfo_t
;

8 
hd¥_fœmw¬e
 
	thd¥_fœmw¬e_t
;

9 
hd¥_v”siÚ
 
	thd¥_v”siÚ_t
;

10 
hd¥_mix”
 
	thd¥_mix”_t
;

11 
hd¥_9632_«b
 
	thd¥_9632_«b_t
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/hdspm.h

1 
	~<®§/sound/ty³_com·t.h
>

2 
	~<®§/sound/u­i/hd¥m.h
>

3 #iâdeà
__hd¥m_ty³_defšed


4 
	#__hd¥m_ty³_defšed


	)

5 
hd¥m_³ak_rms
 
	thd¥m_³ak_rms_t
;

6 
hd¥m_cÚfig_šfo
 
	thd¥m_cÚfig_šfo_t
;

7 
hd¥m_v”siÚ
 
	thd¥m_v”siÚ_t
;

8 
hd¥m_chªÃlçd”
 
	t¢d_hd¥m_chªÃlçd”_t
;

9 
hd¥m_mix”
 
	thd¥m_mix”_t
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/sb16_csp.h

1 
	~<®§/sound/u­i/sb16_c¥.h
>

2 #iâdeà
__sb16_c¥_ty³_defšed


3 
	#__sb16_c¥_ty³_defšed


	)

4 
¢d_sb_c¥_miüocode
 
	t¢d_sb_c¥_miüocode_t
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/sscape_ioctl.h

1 
	~<®§/sound/u­i/ssÿ³_ioùl.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/tlv.h

1 
	~<®§/sound/u­i/v.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/type_compat.h

1 #iâdeà
__SOUND_TYPE_COMPAT_H


2 
	#__SOUND_TYPE_COMPAT_H


	)

4 #iâdeà
DOC_HIDDEN


5 
	~<¡dšt.h
>

6 #ià
defšed
(
__lšux__
)

7 
	~<lšux/ty³s.h
>

9 
ušt8_t
 
	t__u8
;

10 
ušt16_t
 
	t__u16
;

11 
ušt32_t
 
	t__u32
;

12 
ušt64_t
 
	t__u64
;

13 
št8_t
 
	t__s8
;

14 
št16_t
 
	t__s16
;

15 
št32_t
 
	t__s32
;

16 
št64_t
 
	t__s64
;

18 #ià
defšed
(
__sun
)

19 
	~<sys/by‹Üd”.h
>

20 
	#__ıu_to_Ë32
 
	`LE_32
(
x
)

	)

21 
	#__ıu_to_be32
 
	`BE_32
(
x
)

	)

22 
	#__ıu_to_Ë16
 
	`LE_16
(
x
)

	)

23 
	#__ıu_to_be16
 
	`BE_16
(
x
)

	)

25 
	~<sys/’dŸn.h
>

26 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


27 
	#__ıu_to_Ë32
(
x
è(x)

	)

28 
	#__ıu_to_be32
(
x
è
	`bsw­_32
(x)

	)

29 
	#__ıu_to_Ë16
(
x
è(x)

	)

30 
	#__ıu_to_be16
(
x
è
	`bsw­_16
(x)

	)

32 
	#__ıu_to_Ë32
(
x
è
	`bsw­_32
(x)

	)

33 
	#__ıu_to_be32
(
x
è(x)

	)

34 
	#__ıu_to_Ë16
(
x
è
	`bsw­_16
(x)

	)

35 
	#__ıu_to_be16
(
x
è(x)

	)

39 
	#__Ë32_to_ıu
 
__ıu_to_Ë32


	)

40 
	#__be32_to_ıu
 
__ıu_to_be32


	)

41 
	#__Ë16_to_ıu
 
__ıu_to_Ë16


	)

42 
	#__be16_to_ıu
 
__ıu_to_be16


	)

45 #iâdeà
__k”Ãl_lÚg_t


46 
	#__k”Ãl_lÚg_t
 

	)

49 #iâdeà
__u£r


50 
	#__u£r


	)

53 #iâdeà
__·cked


54 
	#__·cked
 
	`__©Œibu‹__
((
__·cked__
))

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asequencer.h

23 #iâdeà
__SOUND_ASEQUENCER_H


24 
	#__SOUND_ASEQUENCER_H


	)

26 
	~<sound/asound.h
>

29 
	#SNDRV_SEQ_VERSION
 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 3)

	)

38 
	#SNDRV_SEQ_EVENT_SYSTEM
 0

	)

39 
	#SNDRV_SEQ_EVENT_RESULT
 1

	)

44 
	#SNDRV_SEQ_EVENT_NOTE
 5

	)

45 
	#SNDRV_SEQ_EVENT_NOTEON
 6

	)

46 
	#SNDRV_SEQ_EVENT_NOTEOFF
 7

	)

47 
	#SNDRV_SEQ_EVENT_KEYPRESS
 8

	)

52 
	#SNDRV_SEQ_EVENT_CONTROLLER
 10

	)

53 
	#SNDRV_SEQ_EVENT_PGMCHANGE
 11

	)

54 
	#SNDRV_SEQ_EVENT_CHANPRESS
 12

	)

55 
	#SNDRV_SEQ_EVENT_PITCHBEND
 13

	)

56 
	#SNDRV_SEQ_EVENT_CONTROL14
 14

	)

57 
	#SNDRV_SEQ_EVENT_NONREGPARAM
 15

	)

58 
	#SNDRV_SEQ_EVENT_REGPARAM
 16

	)

63 
	#SNDRV_SEQ_EVENT_SONGPOS
 20

	)

64 
	#SNDRV_SEQ_EVENT_SONGSEL
 21

	)

65 
	#SNDRV_SEQ_EVENT_QFRAME
 22

	)

66 
	#SNDRV_SEQ_EVENT_TIMESIGN
 23

	)

67 
	#SNDRV_SEQ_EVENT_KEYSIGN
 24

	)

72 
	#SNDRV_SEQ_EVENT_START
 30

	)

73 
	#SNDRV_SEQ_EVENT_CONTINUE
 31

	)

74 
	#SNDRV_SEQ_EVENT_STOP
 32

	)

75 
	#SNDRV_SEQ_EVENT_SETPOS_TICK
 33

	)

76 
	#SNDRV_SEQ_EVENT_SETPOS_TIME
 34

	)

77 
	#SNDRV_SEQ_EVENT_TEMPO
 35

	)

78 
	#SNDRV_SEQ_EVENT_CLOCK
 36

	)

79 
	#SNDRV_SEQ_EVENT_TICK
 37

	)

80 
	#SNDRV_SEQ_EVENT_QUEUE_SKEW
 38

	)

85 
	#SNDRV_SEQ_EVENT_TUNE_REQUEST
 40

	)

86 
	#SNDRV_SEQ_EVENT_RESET
 41

	)

87 
	#SNDRV_SEQ_EVENT_SENSING
 42

	)

92 
	#SNDRV_SEQ_EVENT_ECHO
 50

	)

93 
	#SNDRV_SEQ_EVENT_OSS
 51

	)

98 
	#SNDRV_SEQ_EVENT_CLIENT_START
 60

	)

99 
	#SNDRV_SEQ_EVENT_CLIENT_EXIT
 61

	)

100 
	#SNDRV_SEQ_EVENT_CLIENT_CHANGE
 62

	)

101 
	#SNDRV_SEQ_EVENT_PORT_START
 63

	)

102 
	#SNDRV_SEQ_EVENT_PORT_EXIT
 64

	)

103 
	#SNDRV_SEQ_EVENT_PORT_CHANGE
 65

	)

108 
	#SNDRV_SEQ_EVENT_PORT_SUBSCRIBED
 66

	)

109 
	#SNDRV_SEQ_EVENT_PORT_UNSUBSCRIBED
 67

	)

116 
	#SNDRV_SEQ_EVENT_USR0
 90

	)

117 
	#SNDRV_SEQ_EVENT_USR1
 91

	)

118 
	#SNDRV_SEQ_EVENT_USR2
 92

	)

119 
	#SNDRV_SEQ_EVENT_USR3
 93

	)

120 
	#SNDRV_SEQ_EVENT_USR4
 94

	)

121 
	#SNDRV_SEQ_EVENT_USR5
 95

	)

122 
	#SNDRV_SEQ_EVENT_USR6
 96

	)

123 
	#SNDRV_SEQ_EVENT_USR7
 97

	)

124 
	#SNDRV_SEQ_EVENT_USR8
 98

	)

125 
	#SNDRV_SEQ_EVENT_USR9
 99

	)

134 
	#SNDRV_SEQ_EVENT_SYSEX
 130

	)

135 
	#SNDRV_SEQ_EVENT_BOUNCE
 131

	)

137 
	#SNDRV_SEQ_EVENT_USR_VAR0
 135

	)

138 
	#SNDRV_SEQ_EVENT_USR_VAR1
 136

	)

139 
	#SNDRV_SEQ_EVENT_USR_VAR2
 137

	)

140 
	#SNDRV_SEQ_EVENT_USR_VAR3
 138

	)

141 
	#SNDRV_SEQ_EVENT_USR_VAR4
 139

	)

144 
	#SNDRV_SEQ_EVENT_KERNEL_ERROR
 150

	)

145 
	#SNDRV_SEQ_EVENT_KERNEL_QUOTE
 151

	)

152 
	#SNDRV_SEQ_EVENT_NONE
 255

	)

155 
	t¢d_£q_ev’t_ty³_t
;

158 
	s¢d_£q_addr
 {

159 
	mş›Á
;

160 
	mpÜt
;

164 
	s¢d_£q_cÚÃù
 {

165 
¢d_£q_addr
 
	m£nd”
;

166 
¢d_£q_addr
 
	mde¡
;

170 
	#SNDRV_SEQ_ADDRESS_UNKNOWN
 253

	)

171 
	#SNDRV_SEQ_ADDRESS_SUBSCRIBERS
 254

	)

172 
	#SNDRV_SEQ_ADDRESS_BROADCAST
 255

	)

173 
	#SNDRV_SEQ_QUEUE_DIRECT
 253

	)

176 
	#SNDRV_SEQ_TIME_STAMP_TICK
 (0<<0è

	)

177 
	#SNDRV_SEQ_TIME_STAMP_REAL
 (1<<0è

	)

178 
	#SNDRV_SEQ_TIME_STAMP_MASK
 (1<<0)

	)

180 
	#SNDRV_SEQ_TIME_MODE_ABS
 (0<<1è

	)

181 
	#SNDRV_SEQ_TIME_MODE_REL
 (1<<1è

	)

182 
	#SNDRV_SEQ_TIME_MODE_MASK
 (1<<1)

	)

184 
	#SNDRV_SEQ_EVENT_LENGTH_FIXED
 (0<<2è

	)

185 
	#SNDRV_SEQ_EVENT_LENGTH_VARIABLE
 (1<<2è

	)

186 
	#SNDRV_SEQ_EVENT_LENGTH_VARUSR
 (2<<2è

	)

187 
	#SNDRV_SEQ_EVENT_LENGTH_MASK
 (3<<2)

	)

189 
	#SNDRV_SEQ_PRIORITY_NORMAL
 (0<<4è

	)

190 
	#SNDRV_SEQ_PRIORITY_HIGH
 (1<<4è

	)

191 
	#SNDRV_SEQ_PRIORITY_MASK
 (1<<4)

	)

193 
	#SNDRV_SEQ_EVENT_UMP
 (1<<5è

	)

196 
	s¢d_£q_ev_nÙe
 {

197 
	mchªÃl
;

198 
	mnÙe
;

199 
	mv–oc™y
;

200 
	moff_v–oc™y
;

201 
	mdu¿tiÚ
;

205 
	s¢d_£q_ev_ù¾
 {

206 
	mchªÃl
;

207 
	munu£d1
, 
	munu£d2
, 
	munu£d3
;

208 
	m·¿m
;

209 sigÃd 
	mv®ue
;

213 
	s¢d_£q_ev_¿w8
 {

214 
	md
[12];

218 
	s¢d_£q_ev_¿w32
 {

219 
	md
[3];

223 
	s¢d_£q_ev_ext
 {

224 
	mËn
;

225 *
	m±r
;

226 } 
__©Œibu‹__
((
·cked
));

228 
	s¢d_£q_»suÉ
 {

229 
	mev’t
;

230 
	m»suÉ
;

234 
	s¢d_£q_»®_time
 {

235 
	mtv_£c
;

236 
	mtv_n£c
;

239 
	t¢d_£q_tick_time_t
;

241 
	u¢d_£q_time¡amp
 {

242 
¢d_£q_tick_time_t
 
	mtick
;

243 
¢d_£q_»®_time
 
	mtime
;

246 
	s¢d_£q_queue_skew
 {

247 
	mv®ue
;

248 
	mba£
;

252 
	s¢d_£q_ev_queue_cÚŒŞ
 {

253 
	mqueue
;

254 
	m·d
[3];

256 sigÃd 
	mv®ue
;

257 
¢d_£q_time¡amp
 
	mtime
;

258 
	mpos™iÚ
;

259 
¢d_£q_queue_skew
 
	mskew
;

260 
	md32
[2];

261 
	md8
[8];

262 } 
	m·¿m
;

266 
	s¢d_£q_ev_quÙe
 {

267 
¢d_£q_addr
 
	mÜigš
;

268 
	mv®ue
;

269 
¢d_£q_ev’t
 *
	mev’t
;

270 } 
__©Œibu‹__
((
·cked
));

272 
	u¢d_£q_ev’t_d©a
 {

273 
¢d_£q_ev_nÙe
 
	mnÙe
;

274 
¢d_£q_ev_ù¾
 
	mcÚŒŞ
;

275 
¢d_£q_ev_¿w8
 
	m¿w8
;

276 
¢d_£q_ev_¿w32
 
	m¿w32
;

277 
¢d_£q_ev_ext
 
	mext
;

278 
¢d_£q_ev_queue_cÚŒŞ
 
	mqueue
;

279 
¢d_£q_time¡amp
 
	mtime
;

280 
¢d_£q_addr
 
	maddr
;

281 
¢d_£q_cÚÃù
 
	mcÚÃù
;

282 
¢d_£q_»suÉ
 
	m»suÉ
;

283 
¢d_£q_ev_quÙe
 
	mquÙe
;

287 
	s¢d_£q_ev’t
 {

288 
¢d_£q_ev’t_ty³_t
 
	mty³
;

289 
	mæags
;

290 
	mg
;

292 
	mqueue
;

293 
¢d_£q_time¡amp
 
	mtime
;

295 
¢d_£q_addr
 
	msourû
;

296 
¢d_£q_addr
 
	mde¡
;

298 
¢d_£q_ev’t_d©a
 
	md©a
;

302 
	s¢d_£q_ump_ev’t
 {

303 
¢d_£q_ev’t_ty³_t
 
	mty³
;

304 
	mæags
;

305 
	mg
;

306 
	mqueue
;

307 
¢d_£q_time¡amp
 
	mtime
;

308 
¢d_£q_addr
 
	msourû
;

309 
¢d_£q_addr
 
	mde¡
;

312 
¢d_£q_ev’t_d©a
 
	md©a
;

313 
	mump
[4];

320 
	s¢d_£q_ev’t_bounû
 {

321 
	m”r
;

322 
¢d_£q_ev’t
 
	mev’t
;

328 
	s¢d_£q_sy¡em_šfo
 {

329 
	mqueues
;

330 
	mş›Ás
;

331 
	mpÜts
;

332 
	mchªÃls
;

333 
	mcur_ş›Ás
;

334 
	mcur_queues
;

335 
	m»£rved
[24];

340 
	s¢d_£q_ruÂšg_šfo
 {

341 
	mş›Á
;

342 
	mbig_’dŸn
;

343 
	mıu_mode
;

344 
	m·d
;

345 
	m»£rved
[12];

350 
	#SNDRV_SEQ_CLIENT_SYSTEM
 0

	)

352 
	#SNDRV_SEQ_CLIENT_DUMMY
 14

	)

353 
	#SNDRV_SEQ_CLIENT_OSS
 15

	)

357 
	t__b™wi£
 
	t¢d_£q_ş›Á_ty³_t
;

358 
	#NO_CLIENT
 ((
¢d_£q_ş›Á_ty³_t
è0)

	)

359 
	#USER_CLIENT
 ((
¢d_£q_ş›Á_ty³_t
è1)

	)

360 
	#KERNEL_CLIENT
 ((
¢d_£q_ş›Á_ty³_t
è2)

	)

363 
	#SNDRV_SEQ_FILTER_BROADCAST
 (1U<<0è

	)

364 
	#SNDRV_SEQ_FILTER_MULTICAST
 (1U<<1è

	)

365 
	#SNDRV_SEQ_FILTER_BOUNCE
 (1U<<2è

	)

366 
	#SNDRV_SEQ_FILTER_NO_CONVERT
 (1U<<30è

	)

367 
	#SNDRV_SEQ_FILTER_USE_EVENT
 (1U<<31è

	)

369 
	s¢d_£q_ş›Á_šfo
 {

370 
	mş›Á
;

371 
¢d_£q_ş›Á_ty³_t
 
	mty³
;

372 
	mÇme
[64];

373 
	mf‹r
;

374 
	mmuÉiÿ¡_f‹r
[8];

375 
	mev’t_f‹r
[32];

376 
	mnum_pÜts
;

377 
	mev’t_lo¡
;

378 
	mÿrd
;

379 
	mpid
;

380 
	mmidi_v”siÚ
;

381 
	mgroup_f‹r
;

385 
	m»£rved
[48];

389 
	#SNDRV_SEQ_CLIENT_LEGACY_MIDI
 0

	)

390 
	#SNDRV_SEQ_CLIENT_UMP_MIDI_1_0
 1

	)

391 
	#SNDRV_SEQ_CLIENT_UMP_MIDI_2_0
 2

	)

394 
	s¢d_£q_ş›Á_poŞ
 {

395 
	mş›Á
;

396 
	mouut_poŞ
;

397 
	mšput_poŞ
;

398 
	mouut_room
;

399 
	mouut_ä“
;

400 
	mšput_ä“
;

401 
	m»£rved
[64];

407 
	#SNDRV_SEQ_REMOVE_INPUT
 (1<<0è

	)

408 
	#SNDRV_SEQ_REMOVE_OUTPUT
 (1<<1è

	)

409 
	#SNDRV_SEQ_REMOVE_DEST
 (1<<2è

	)

410 
	#SNDRV_SEQ_REMOVE_DEST_CHANNEL
 (1<<3è

	)

411 
	#SNDRV_SEQ_REMOVE_TIME_BEFORE
 (1<<4è

	)

412 
	#SNDRV_SEQ_REMOVE_TIME_AFTER
 (1<<5è

	)

413 
	#SNDRV_SEQ_REMOVE_TIME_TICK
 (1<<6è

	)

414 
	#SNDRV_SEQ_REMOVE_EVENT_TYPE
 (1<<7è

	)

415 
	#SNDRV_SEQ_REMOVE_IGNORE_OFF
 (1<<8è

	)

416 
	#SNDRV_SEQ_REMOVE_TAG_MATCH
 (1<<9è

	)

418 
	s¢d_£q_»move_ev’ts
 {

419 
	m»move_mode
;

421 
¢d_£q_time¡amp
 
	mtime
;

423 
	mqueue
;

424 
¢d_£q_addr
 
	mde¡
;

425 
	mchªÃl
;

427 
	mty³
;

428 
	mg
;

430 
	m»£rved
[10];

436 
	#SNDRV_SEQ_PORT_SYSTEM_TIMER
 0

	)

437 
	#SNDRV_SEQ_PORT_SYSTEM_ANNOUNCE
 1

	)

440 
	#SNDRV_SEQ_PORT_CAP_READ
 (1<<0è

	)

441 
	#SNDRV_SEQ_PORT_CAP_WRITE
 (1<<1è

	)

443 
	#SNDRV_SEQ_PORT_CAP_SYNC_READ
 (1<<2)

	)

444 
	#SNDRV_SEQ_PORT_CAP_SYNC_WRITE
 (1<<3)

	)

446 
	#SNDRV_SEQ_PORT_CAP_DUPLEX
 (1<<4)

	)

448 
	#SNDRV_SEQ_PORT_CAP_SUBS_READ
 (1<<5è

	)

449 
	#SNDRV_SEQ_PORT_CAP_SUBS_WRITE
 (1<<6è

	)

450 
	#SNDRV_SEQ_PORT_CAP_NO_EXPORT
 (1<<7è

	)

451 
	#SNDRV_SEQ_PORT_CAP_INACTIVE
 (1<<8è

	)

452 
	#SNDRV_SEQ_PORT_CAP_UMP_ENDPOINT
 (1<<9è

	)

455 
	#SNDRV_SEQ_PORT_TYPE_SPECIFIC
 (1<<0è

	)

456 
	#SNDRV_SEQ_PORT_TYPE_MIDI_GENERIC
 (1<<1è

	)

457 
	#SNDRV_SEQ_PORT_TYPE_MIDI_GM
 (1<<2è

	)

458 
	#SNDRV_SEQ_PORT_TYPE_MIDI_GS
 (1<<3è

	)

459 
	#SNDRV_SEQ_PORT_TYPE_MIDI_XG
 (1<<4è

	)

460 
	#SNDRV_SEQ_PORT_TYPE_MIDI_MT32
 (1<<5è

	)

461 
	#SNDRV_SEQ_PORT_TYPE_MIDI_GM2
 (1<<6è

	)

462 
	#SNDRV_SEQ_PORT_TYPE_MIDI_UMP
 (1<<7è

	)

465 
	#SNDRV_SEQ_PORT_TYPE_SYNTH
 (1<<10è

	)

466 
	#SNDRV_SEQ_PORT_TYPE_DIRECT_SAMPLE
 (1<<11è

	)

467 
	#SNDRV_SEQ_PORT_TYPE_SAMPLE
 (1<<12è

	)

469 
	#SNDRV_SEQ_PORT_TYPE_HARDWARE
 (1<<16è

	)

470 
	#SNDRV_SEQ_PORT_TYPE_SOFTWARE
 (1<<17è

	)

471 
	#SNDRV_SEQ_PORT_TYPE_SYNTHESIZER
 (1<<18è

	)

472 
	#SNDRV_SEQ_PORT_TYPE_PORT
 (1<<19è

	)

473 
	#SNDRV_SEQ_PORT_TYPE_APPLICATION
 (1<<20è

	)

476 
	#SNDRV_SEQ_PORT_FLG_GIVEN_PORT
 (1<<0)

	)

477 
	#SNDRV_SEQ_PORT_FLG_TIMESTAMP
 (1<<1)

	)

478 
	#SNDRV_SEQ_PORT_FLG_TIME_REAL
 (1<<2)

	)

481 
	#SNDRV_SEQ_PORT_DIR_UNKNOWN
 0

	)

482 
	#SNDRV_SEQ_PORT_DIR_INPUT
 1

	)

483 
	#SNDRV_SEQ_PORT_DIR_OUTPUT
 2

	)

484 
	#SNDRV_SEQ_PORT_DIR_BIDIRECTION
 3

	)

486 
	s¢d_£q_pÜt_šfo
 {

487 
¢d_£q_addr
 
	maddr
;

488 
	mÇme
[64];

490 
	mÿ·b™y
;

491 
	mty³
;

492 
	mmidi_chªÃls
;

493 
	mmidi_voiûs
;

494 
	msyÁh_voiûs
;

496 
	m»ad_u£
;

497 
	mwr™e_u£
;

499 *
	mk”Ãl
;

500 
	mæags
;

501 
	mtime_queue
;

502 
	mdœeùiÚ
;

503 
	mump_group
;

504 
	m»£rved
[57];

509 
	#SNDRV_SEQ_QUEUE_FLG_SYNC
 (1<<0è

	)

512 
	s¢d_£q_queue_šfo
 {

513 
	mqueue
;

519 
	mowÃr
;

520 
	mlocked
:1;

521 
	mÇme
[64];

522 
	mæags
;

523 
	m»£rved
[60];

528 
	s¢d_£q_queue_¡©us
 {

529 
	mqueue
;

530 
	mev’ts
;

531 
¢d_£q_tick_time_t
 
	mtick
;

532 
¢d_£q_»®_time
 
	mtime
;

533 
	mruÂšg
;

534 
	mæags
;

535 
	m»£rved
[64];

540 
	s¢d_£q_queue_‹mpo
 {

541 
	mqueue
;

542 
	m‹mpo
;

543 
	mµq
;

544 
	mskew_v®ue
;

545 
	mskew_ba£
;

546 
	m»£rved
[24];

551 
	#SNDRV_SEQ_TIMER_ALSA
 0

	)

552 
	#SNDRV_SEQ_TIMER_MIDI_CLOCK
 1

	)

553 
	#SNDRV_SEQ_TIMER_MIDI_TICK
 2

	)

556 
	s¢d_£q_queue_tim”
 {

557 
	mqueue
;

558 
	mty³
;

561 
¢d_tim”_id
 
	mid
;

562 
	m»sŞutiÚ
;

563 } 
	m®§
;

564 } 
	mu
;

565 
	m»£rved
[64];

569 
	s¢d_£q_queue_ş›Á
 {

570 
	mqueue
;

571 
	mş›Á
;

572 
	mu£d
;

575 
	m»£rved
[64];

579 
	#SNDRV_SEQ_PORT_SUBS_EXCLUSIVE
 (1<<0è

	)

580 
	#SNDRV_SEQ_PORT_SUBS_TIMESTAMP
 (1<<1)

	)

581 
	#SNDRV_SEQ_PORT_SUBS_TIME_REAL
 (1<<2)

	)

583 
	s¢d_£q_pÜt_subsüibe
 {

584 
¢d_£q_addr
 
	m£nd”
;

585 
¢d_£q_addr
 
	mde¡
;

586 
	mvoiûs
;

587 
	mæags
;

588 
	mqueue
;

589 
	m·d
[3];

590 
	m»£rved
[64];

594 
	#SNDRV_SEQ_QUERY_SUBS_READ
 0

	)

595 
	#SNDRV_SEQ_QUERY_SUBS_WRITE
 1

	)

597 
	s¢d_£q_qu”y_subs
 {

598 
¢d_£q_addr
 
	mroÙ
;

599 
	mty³
;

600 
	mšdex
;

601 
	mnum_subs
;

602 
¢d_£q_addr
 
	maddr
;

603 
	mqueue
;

604 
	mæags
;

605 
	m»£rved
[64];

612 
	#SNDRV_SEQ_CLIENT_UMP_INFO_ENDPOINT
 0

	)

613 
	#SNDRV_SEQ_CLIENT_UMP_INFO_BLOCK
 1

	)

615 
	s¢d_£q_ş›Á_ump_šfo
 {

616 
	mş›Á
;

617 
	mty³
;

618 
	mšfo
[512];

619 } 
	g__·cked
;

625 
	#SNDRV_SEQ_IOCTL_PVERSION
 
	`_IOR
 ('S', 0x00, )

	)

626 
	#SNDRV_SEQ_IOCTL_CLIENT_ID
 
	`_IOR
 ('S', 0x01, )

	)

627 
	#SNDRV_SEQ_IOCTL_SYSTEM_INFO
 
	`_IOWR
('S', 0x02, 
¢d_£q_sy¡em_šfo
)

	)

628 
	#SNDRV_SEQ_IOCTL_RUNNING_MODE
 
	`_IOWR
('S', 0x03, 
¢d_£q_ruÂšg_šfo
)

	)

629 
	#SNDRV_SEQ_IOCTL_USER_PVERSION
 
	`_IOW
('S', 0x04, )

	)

631 
	#SNDRV_SEQ_IOCTL_GET_CLIENT_INFO
 
	`_IOWR
('S', 0x10, 
¢d_£q_ş›Á_šfo
)

	)

632 
	#SNDRV_SEQ_IOCTL_SET_CLIENT_INFO
 
	`_IOW
 ('S', 0x11, 
¢d_£q_ş›Á_šfo
)

	)

633 
	#SNDRV_SEQ_IOCTL_GET_CLIENT_UMP_INFO
 
	`_IOWR
('S', 0x12, 
¢d_£q_ş›Á_ump_šfo
)

	)

634 
	#SNDRV_SEQ_IOCTL_SET_CLIENT_UMP_INFO
 
	`_IOWR
('S', 0x13, 
¢d_£q_ş›Á_ump_šfo
)

	)

636 
	#SNDRV_SEQ_IOCTL_CREATE_PORT
 
	`_IOWR
('S', 0x20, 
¢d_£q_pÜt_šfo
)

	)

637 
	#SNDRV_SEQ_IOCTL_DELETE_PORT
 
	`_IOW
 ('S', 0x21, 
¢d_£q_pÜt_šfo
)

	)

638 
	#SNDRV_SEQ_IOCTL_GET_PORT_INFO
 
	`_IOWR
('S', 0x22, 
¢d_£q_pÜt_šfo
)

	)

639 
	#SNDRV_SEQ_IOCTL_SET_PORT_INFO
 
	`_IOW
 ('S', 0x23, 
¢d_£q_pÜt_šfo
)

	)

641 
	#SNDRV_SEQ_IOCTL_SUBSCRIBE_PORT
 
	`_IOW
 ('S', 0x30, 
¢d_£q_pÜt_subsüibe
)

	)

642 
	#SNDRV_SEQ_IOCTL_UNSUBSCRIBE_PORT
 
	`_IOW
 ('S', 0x31, 
¢d_£q_pÜt_subsüibe
)

	)

644 
	#SNDRV_SEQ_IOCTL_CREATE_QUEUE
 
	`_IOWR
('S', 0x32, 
¢d_£q_queue_šfo
)

	)

645 
	#SNDRV_SEQ_IOCTL_DELETE_QUEUE
 
	`_IOW
 ('S', 0x33, 
¢d_£q_queue_šfo
)

	)

646 
	#SNDRV_SEQ_IOCTL_GET_QUEUE_INFO
 
	`_IOWR
('S', 0x34, 
¢d_£q_queue_šfo
)

	)

647 
	#SNDRV_SEQ_IOCTL_SET_QUEUE_INFO
 
	`_IOWR
('S', 0x35, 
¢d_£q_queue_šfo
)

	)

648 
	#SNDRV_SEQ_IOCTL_GET_NAMED_QUEUE
 
	`_IOWR
('S', 0x36, 
¢d_£q_queue_šfo
)

	)

649 
	#SNDRV_SEQ_IOCTL_GET_QUEUE_STATUS
 
	`_IOWR
('S', 0x40, 
¢d_£q_queue_¡©us
)

	)

650 
	#SNDRV_SEQ_IOCTL_GET_QUEUE_TEMPO
 
	`_IOWR
('S', 0x41, 
¢d_£q_queue_‹mpo
)

	)

651 
	#SNDRV_SEQ_IOCTL_SET_QUEUE_TEMPO
 
	`_IOW
 ('S', 0x42, 
¢d_£q_queue_‹mpo
)

	)

652 
	#SNDRV_SEQ_IOCTL_GET_QUEUE_TIMER
 
	`_IOWR
('S', 0x45, 
¢d_£q_queue_tim”
)

	)

653 
	#SNDRV_SEQ_IOCTL_SET_QUEUE_TIMER
 
	`_IOW
 ('S', 0x46, 
¢d_£q_queue_tim”
)

	)

654 
	#SNDRV_SEQ_IOCTL_GET_QUEUE_CLIENT
 
	`_IOWR
('S', 0x49, 
¢d_£q_queue_ş›Á
)

	)

655 
	#SNDRV_SEQ_IOCTL_SET_QUEUE_CLIENT
 
	`_IOW
 ('S', 0x4a, 
¢d_£q_queue_ş›Á
)

	)

656 
	#SNDRV_SEQ_IOCTL_GET_CLIENT_POOL
 
	`_IOWR
('S', 0x4b, 
¢d_£q_ş›Á_poŞ
)

	)

657 
	#SNDRV_SEQ_IOCTL_SET_CLIENT_POOL
 
	`_IOW
 ('S', 0x4c, 
¢d_£q_ş›Á_poŞ
)

	)

658 
	#SNDRV_SEQ_IOCTL_REMOVE_EVENTS
 
	`_IOW
 ('S', 0x4e, 
¢d_£q_»move_ev’ts
)

	)

659 
	#SNDRV_SEQ_IOCTL_QUERY_SUBS
 
	`_IOWR
('S', 0x4f, 
¢d_£q_qu”y_subs
)

	)

660 
	#SNDRV_SEQ_IOCTL_GET_SUBSCRIPTION
 
	`_IOWR
('S', 0x50, 
¢d_£q_pÜt_subsüibe
)

	)

661 
	#SNDRV_SEQ_IOCTL_QUERY_NEXT_CLIENT
 
	`_IOWR
('S', 0x51, 
¢d_£q_ş›Á_šfo
)

	)

662 
	#SNDRV_SEQ_IOCTL_QUERY_NEXT_PORT
 
	`_IOWR
('S', 0x52, 
¢d_£q_pÜt_šfo
)

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asoc.h

16 #iâdeà
__LINUX_UAPI_SND_ASOC_H


17 
	#__LINUX_UAPI_SND_ASOC_H


	)

19 #ià
defšed
(
__lšux__
)

20 
	~<lšux/ty³s.h
>

26 
	#SND_SOC_TPLG_MAX_CHAN
 8

	)

31 
	#SND_SOC_TPLG_MAX_FORMATS
 16

	)

36 
	#SND_SOC_TPLG_STREAM_CONFIG_MAX
 8

	)

41 
	#SND_SOC_TPLG_HW_CONFIG_MAX
 8

	)

44 
	#SND_SOC_TPLG_CTL_VOLSW
 1

	)

45 
	#SND_SOC_TPLG_CTL_VOLSW_SX
 2

	)

46 
	#SND_SOC_TPLG_CTL_VOLSW_XR_SX
 3

	)

47 
	#SND_SOC_TPLG_CTL_ENUM
 4

	)

48 
	#SND_SOC_TPLG_CTL_BYTES
 5

	)

49 
	#SND_SOC_TPLG_CTL_ENUM_VALUE
 6

	)

50 
	#SND_SOC_TPLG_CTL_RANGE
 7

	)

51 
	#SND_SOC_TPLG_CTL_STROBE
 8

	)

55 
	#SND_SOC_TPLG_DAPM_CTL_VOLSW
 64

	)

56 
	#SND_SOC_TPLG_DAPM_CTL_ENUM_DOUBLE
 65

	)

57 
	#SND_SOC_TPLG_DAPM_CTL_ENUM_VIRT
 66

	)

58 
	#SND_SOC_TPLG_DAPM_CTL_ENUM_VALUE
 67

	)

59 
	#SND_SOC_TPLG_DAPM_CTL_PIN
 68

	)

62 
	#SND_SOC_TPLG_DAPM_INPUT
 0

	)

63 
	#SND_SOC_TPLG_DAPM_OUTPUT
 1

	)

64 
	#SND_SOC_TPLG_DAPM_MUX
 2

	)

65 
	#SND_SOC_TPLG_DAPM_MIXER
 3

	)

66 
	#SND_SOC_TPLG_DAPM_PGA
 4

	)

67 
	#SND_SOC_TPLG_DAPM_OUT_DRV
 5

	)

68 
	#SND_SOC_TPLG_DAPM_ADC
 6

	)

69 
	#SND_SOC_TPLG_DAPM_DAC
 7

	)

70 
	#SND_SOC_TPLG_DAPM_SWITCH
 8

	)

71 
	#SND_SOC_TPLG_DAPM_PRE
 9

	)

72 
	#SND_SOC_TPLG_DAPM_POST
 10

	)

73 
	#SND_SOC_TPLG_DAPM_AIF_IN
 11

	)

74 
	#SND_SOC_TPLG_DAPM_AIF_OUT
 12

	)

75 
	#SND_SOC_TPLG_DAPM_DAI_IN
 13

	)

76 
	#SND_SOC_TPLG_DAPM_DAI_OUT
 14

	)

77 
	#SND_SOC_TPLG_DAPM_DAI_LINK
 15

	)

78 
	#SND_SOC_TPLG_DAPM_BUFFER
 16

	)

79 
	#SND_SOC_TPLG_DAPM_SCHEDULER
 17

	)

80 
	#SND_SOC_TPLG_DAPM_EFFECT
 18

	)

81 
	#SND_SOC_TPLG_DAPM_SIGGEN
 19

	)

82 
	#SND_SOC_TPLG_DAPM_SRC
 20

	)

83 
	#SND_SOC_TPLG_DAPM_ASRC
 21

	)

84 
	#SND_SOC_TPLG_DAPM_ENCODER
 22

	)

85 
	#SND_SOC_TPLG_DAPM_DECODER
 23

	)

86 
	#SND_SOC_TPLG_DAPM_LAST
 
SND_SOC_TPLG_DAPM_DECODER


	)

89 
	#SND_SOC_TPLG_MAGIC
 0x41536F43

	)

92 
	#SND_SOC_TPLG_NUM_TEXTS
 16

	)

95 
	#SND_SOC_TPLG_ABI_VERSION
 0x5

	)

96 
	#SND_SOC_TPLG_ABI_VERSION_MIN
 0x4

	)

99 
	#SND_SOC_TPLG_TLV_SIZE
 32

	)

107 
	#SND_SOC_TPLG_TYPE_MIXER
 1

	)

108 
	#SND_SOC_TPLG_TYPE_BYTES
 2

	)

109 
	#SND_SOC_TPLG_TYPE_ENUM
 3

	)

110 
	#SND_SOC_TPLG_TYPE_DAPM_GRAPH
 4

	)

111 
	#SND_SOC_TPLG_TYPE_DAPM_WIDGET
 5

	)

112 
	#SND_SOC_TPLG_TYPE_DAI_LINK
 6

	)

113 
	#SND_SOC_TPLG_TYPE_PCM
 7

	)

114 
	#SND_SOC_TPLG_TYPE_MANIFEST
 8

	)

115 
	#SND_SOC_TPLG_TYPE_CODEC_LINK
 9

	)

116 
	#SND_SOC_TPLG_TYPE_BACKEND_LINK
 10

	)

117 
	#SND_SOC_TPLG_TYPE_PDATA
 11

	)

118 
	#SND_SOC_TPLG_TYPE_DAI
 12

	)

119 
	#SND_SOC_TPLG_TYPE_MAX
 
SND_SOC_TPLG_TYPE_DAI


	)

122 
	#SND_SOC_TPLG_TYPE_VENDOR_FW
 1000

	)

123 
	#SND_SOC_TPLG_TYPE_VENDOR_CONFIG
 1001

	)

124 
	#SND_SOC_TPLG_TYPE_VENDOR_COEFF
 1002

	)

125 
	#SND_SOC_TPLG_TYPEVENDOR_CODEC
 1003

	)

127 
	#SND_SOC_TPLG_STREAM_PLAYBACK
 0

	)

128 
	#SND_SOC_TPLG_STREAM_CAPTURE
 1

	)

131 
	#SND_SOC_TPLG_TUPLE_TYPE_UUID
 0

	)

132 
	#SND_SOC_TPLG_TUPLE_TYPE_STRING
 1

	)

133 
	#SND_SOC_TPLG_TUPLE_TYPE_BOOL
 2

	)

134 
	#SND_SOC_TPLG_TUPLE_TYPE_BYTE
 3

	)

135 
	#SND_SOC_TPLG_TUPLE_TYPE_WORD
 4

	)

136 
	#SND_SOC_TPLG_TUPLE_TYPE_SHORT
 5

	)

139 
	#SND_SOC_TPLG_DAI_FLGBIT_SYMMETRIC_RATES
 (1 << 0)

	)

140 
	#SND_SOC_TPLG_DAI_FLGBIT_SYMMETRIC_CHANNELS
 (1 << 1)

	)

141 
	#SND_SOC_TPLG_DAI_FLGBIT_SYMMETRIC_SAMPLEBITS
 (1 << 2)

	)

144 
	#SND_SOC_TPLG_DAI_CLK_GATE_UNDEFINED
 0

	)

145 
	#SND_SOC_TPLG_DAI_CLK_GATE_GATED
 1

	)

146 
	#SND_SOC_TPLG_DAI_CLK_GATE_CONT
 2

	)

149 
	#SND_SOC_TPLG_MCLK_CO
 0

	)

150 
	#SND_SOC_TPLG_MCLK_CI
 1

	)

155 
	#SND_SOC_DAI_FORMAT_I2S
 1

	)

156 
	#SND_SOC_DAI_FORMAT_RIGHT_J
 2

	)

157 
	#SND_SOC_DAI_FORMAT_LEFT_J
 3

	)

158 
	#SND_SOC_DAI_FORMAT_DSP_A
 4

	)

159 
	#SND_SOC_DAI_FORMAT_DSP_B
 5

	)

160 
	#SND_SOC_DAI_FORMAT_AC97
 6

	)

161 
	#SND_SOC_DAI_FORMAT_PDM
 7

	)

164 
	#SND_SOC_DAI_FORMAT_MSB
 
SND_SOC_DAI_FORMAT_LEFT_J


	)

165 
	#SND_SOC_DAI_FORMAT_LSB
 
SND_SOC_DAI_FORMAT_RIGHT_J


	)

168 
	#SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_RATES
 (1 << 0)

	)

169 
	#SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_CHANNELS
 (1 << 1)

	)

170 
	#SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_SAMPLEBITS
 (1 << 2)

	)

171 
	#SND_SOC_TPLG_LNK_FLGBIT_VOICE_WAKEUP
 (1 << 3)

	)

176 
	#SND_SOC_TPLG_BCLK_CP
 0

	)

177 
	#SND_SOC_TPLG_BCLK_CC
 1

	)

179 
	#SND_SOC_TPLG_BCLK_CM
 
SND_SOC_TPLG_BCLK_CP


	)

180 
	#SND_SOC_TPLG_BCLK_CS
 
SND_SOC_TPLG_BCLK_CC


	)

185 
	#SND_SOC_TPLG_FSYNC_CP
 0

	)

186 
	#SND_SOC_TPLG_FSYNC_CC
 1

	)

188 
	#SND_SOC_TPLG_FSYNC_CM
 
SND_SOC_TPLG_FSYNC_CP


	)

189 
	#SND_SOC_TPLG_FSYNC_CS
 
SND_SOC_TPLG_FSYNC_CC


	)

195 
	s¢d_soc_lg_hdr
 {

196 
__Ë32
 
	mmagic
;

197 
__Ë32
 
	mabi
;

198 
__Ë32
 
	mv”siÚ
;

199 
__Ë32
 
	mty³
;

200 
__Ë32
 
	msize
;

201 
__Ë32
 
	mv’dÜ_ty³
;

202 
__Ë32
 
	m·ylßd_size
;

203 
__Ë32
 
	mšdex
;

204 
__Ë32
 
	mcouÁ
;

205 } 
__©Œibu‹__
((
·cked
));

208 
	s¢d_soc_lg_v’dÜ_uuid_–em
 {

209 
__Ë32
 
	mtok’
;

210 
	muuid
[16];

211 } 
__©Œibu‹__
((
·cked
));

214 
	s¢d_soc_lg_v’dÜ_v®ue_–em
 {

215 
__Ë32
 
	mtok’
;

216 
__Ë32
 
	mv®ue
;

217 } 
__©Œibu‹__
((
·cked
));

220 
	s¢d_soc_lg_v’dÜ_¡ršg_–em
 {

221 
__Ë32
 
	mtok’
;

222 
	m¡ršg
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

223 } 
__©Œibu‹__
((
·cked
));

225 
	s¢d_soc_lg_v’dÜ_¬¿y
 {

226 
__Ë32
 
	msize
;

227 
__Ë32
 
	mty³
;

228 
__Ë32
 
	mnum_–ems
;

230 
¢d_soc_lg_v’dÜ_uuid_–em
 
	muuid
[0];

231 
¢d_soc_lg_v’dÜ_v®ue_–em
 
	mv®ue
[0];

232 
¢d_soc_lg_v’dÜ_¡ršg_–em
 
	m¡ršg
[0];

234 } 
__©Œibu‹__
((
·cked
));

241 
	s¢d_soc_lg_´iv©e
 {

242 
__Ë32
 
	msize
;

244 
	md©a
[0];

245 
¢d_soc_lg_v’dÜ_¬¿y
 
	m¬¿y
[0];

247 } 
__©Œibu‹__
((
·cked
));

252 
	s¢d_soc_lg_v_dbsÿË
 {

253 
__Ë32
 
	mmš
;

254 
__Ë32
 
	m¡•
;

255 
__Ë32
 
	mmu‹
;

256 } 
__©Œibu‹__
((
·cked
));

258 
	s¢d_soc_lg_ùl_v
 {

259 
__Ë32
 
	msize
;

260 
__Ë32
 
	mty³
;

262 
__Ë32
 
	md©a
[
SND_SOC_TPLG_TLV_SIZE
];

263 
¢d_soc_lg_v_dbsÿË
 
	msÿË
;

265 } 
__©Œibu‹__
((
·cked
));

270 
	s¢d_soc_lg_chªÃl
 {

271 
__Ë32
 
	msize
;

272 
__Ë32
 
	m»g
;

273 
__Ë32
 
	mshiá
;

274 
__Ë32
 
	mid
;

275 } 
__©Œibu‹__
((
·cked
));

282 
	s¢d_soc_lg_io_İs
 {

283 
__Ë32
 
	mg‘
;

284 
__Ë32
 
	mput
;

285 
__Ë32
 
	mšfo
;

286 } 
__©Œibu‹__
((
·cked
));

291 
	s¢d_soc_lg_ùl_hdr
 {

292 
__Ë32
 
	msize
;

293 
__Ë32
 
	mty³
;

294 
	mÇme
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

295 
__Ë32
 
	macûss
;

296 
¢d_soc_lg_io_İs
 
	mİs
;

297 
¢d_soc_lg_ùl_v
 
	mv
;

298 } 
__©Œibu‹__
((
·cked
));

303 
	s¢d_soc_lg_¡»am_ÿps
 {

304 
__Ë32
 
	msize
;

305 
	mÇme
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

306 
__Ë64
 
	mfÜm©s
;

307 
__Ë32
 
	m¿‹s
;

308 
__Ë32
 
	m¿‹_mš
;

309 
__Ë32
 
	m¿‹_max
;

310 
__Ë32
 
	mchªÃls_mš
;

311 
__Ë32
 
	mchªÃls_max
;

312 
__Ë32
 
	m³riods_mš
;

313 
__Ë32
 
	m³riods_max
;

314 
__Ë32
 
	m³riod_size_mš
;

315 
__Ë32
 
	m³riod_size_max
;

316 
__Ë32
 
	mbufãr_size_mš
;

317 
__Ë32
 
	mbufãr_size_max
;

318 
__Ë32
 
	msig_b™s
;

319 } 
__©Œibu‹__
((
·cked
));

324 
	s¢d_soc_lg_¡»am
 {

325 
__Ë32
 
	msize
;

326 
	mÇme
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

327 
__Ë64
 
	mfÜm©
;

328 
__Ë32
 
	m¿‹
;

329 
__Ë32
 
	m³riod_by‹s
;

330 
__Ë32
 
	mbufãr_by‹s
;

331 
__Ë32
 
	mchªÃls
;

332 } 
__©Œibu‹__
((
·cked
));

339 
	s¢d_soc_lg_hw_cÚfig
 {

340 
__Ë32
 
	msize
;

341 
__Ë32
 
	mid
;

342 
__Ë32
 
	mfmt
;

343 
__u8
 
	mşock_g©ed
;

344 
__u8
 
	mšv”t_bşk
;

345 
__u8
 
	mšv”t_fsync
;

346 
__u8
 
	mbşk_´ovid”
;

347 
__u8
 
	mfsync_´ovid”
;

348 
__u8
 
	mmşk_dœeùiÚ
;

349 
__Ë16
 
	m»£rved
;

350 
__Ë32
 
	mmşk_¿‹
;

351 
__Ë32
 
	mbşk_¿‹
;

352 
__Ë32
 
	mfsync_¿‹
;

353 
__Ë32
 
	mtdm_¦Ùs
;

354 
__Ë32
 
	mtdm_¦Ù_width
;

355 
__Ë32
 
	mtx_¦Ùs
;

356 
__Ë32
 
	mrx_¦Ùs
;

357 
__Ë32
 
	mtx_chªÃls
;

358 
__Ë32
 
	mtx_chªm­
[
SND_SOC_TPLG_MAX_CHAN
];

359 
__Ë32
 
	mrx_chªÃls
;

360 
__Ë32
 
	mrx_chªm­
[
SND_SOC_TPLG_MAX_CHAN
];

361 } 
__©Œibu‹__
((
·cked
));

375 
	s¢d_soc_lg_mªiã¡
 {

376 
__Ë32
 
	msize
;

377 
__Ë32
 
	mcÚŒŞ_–ems
;

378 
__Ë32
 
	mwidg‘_–ems
;

379 
__Ë32
 
	mg¿ph_–ems
;

380 
__Ë32
 
	mpcm_–ems
;

381 
__Ë32
 
	mdai_lšk_–ems
;

382 
__Ë32
 
	mdai_–ems
;

383 
__Ë32
 
	m»£rved
[20];

384 
¢d_soc_lg_´iv©e
 
	m´iv
;

385 } 
__©Œibu‹__
((
·cked
));

397 
	s¢d_soc_lg_mix”_cÚŒŞ
 {

398 
¢d_soc_lg_ùl_hdr
 
	mhdr
;

399 
__Ë32
 
	msize
;

400 
__Ë32
 
	mmš
;

401 
__Ë32
 
	mmax
;

402 
__Ë32
 
	m¶©fÜm_max
;

403 
__Ë32
 
	mšv”t
;

404 
__Ë32
 
	mnum_chªÃls
;

405 
¢d_soc_lg_chªÃl
 
	mchªÃl
[
SND_SOC_TPLG_MAX_CHAN
];

406 
¢d_soc_lg_´iv©e
 
	m´iv
;

407 } 
__©Œibu‹__
((
·cked
));

419 
	s¢d_soc_lg_’um_cÚŒŞ
 {

420 
¢d_soc_lg_ùl_hdr
 
	mhdr
;

421 
__Ë32
 
	msize
;

422 
__Ë32
 
	mnum_chªÃls
;

423 
¢d_soc_lg_chªÃl
 
	mchªÃl
[
SND_SOC_TPLG_MAX_CHAN
];

424 
__Ë32
 
	m™ems
;

425 
__Ë32
 
	mmask
;

426 
__Ë32
 
	mcouÁ
;

427 
	m‹xts
[
SND_SOC_TPLG_NUM_TEXTS
][
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

428 
__Ë32
 
	mv®ues
[
SND_SOC_TPLG_NUM_TEXTS
 * 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
 / 4];

429 
¢d_soc_lg_´iv©e
 
	m´iv
;

430 } 
__©Œibu‹__
((
·cked
));

442 
	s¢d_soc_lg_by‹s_cÚŒŞ
 {

443 
¢d_soc_lg_ùl_hdr
 
	mhdr
;

444 
__Ë32
 
	msize
;

445 
__Ë32
 
	mmax
;

446 
__Ë32
 
	mmask
;

447 
__Ë32
 
	mba£
;

448 
__Ë32
 
	mnum_»gs
;

449 
¢d_soc_lg_io_İs
 
	mext_İs
;

450 
¢d_soc_lg_´iv©e
 
	m´iv
;

451 } 
__©Œibu‹__
((
·cked
));

463 
	s¢d_soc_lg_d­m_g¿ph_–em
 {

464 
	msšk
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

465 
	mcÚŒŞ
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

466 
	msourû
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

467 } 
__©Œibu‹__
((
·cked
));

485 
	s¢d_soc_lg_d­m_widg‘
 {

486 
__Ë32
 
	msize
;

487 
__Ë32
 
	mid
;

488 
	mÇme
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

489 
	m¢ame
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

491 
__Ë32
 
	m»g
;

492 
__Ë32
 
	mshiá
;

493 
__Ë32
 
	mmask
;

494 
__Ë32
 
	msub£q
;

495 
__Ë32
 
	mšv”t
;

496 
__Ë32
 
	mignÜe_su¥’d
;

497 
__Ë16
 
	mev’t_æags
;

498 
__Ë16
 
	mev’t_ty³
;

499 
__Ë32
 
	mnum_kcÚŒŞs
;

500 
¢d_soc_lg_´iv©e
 
	m´iv
;

505 } 
__©Œibu‹__
((
·cked
));

518 
	s¢d_soc_lg_pcm
 {

519 
__Ë32
 
	msize
;

520 
	mpcm_Çme
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

521 
	mdai_Çme
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

522 
__Ë32
 
	mpcm_id
;

523 
__Ë32
 
	mdai_id
;

524 
__Ë32
 
	m¶ayback
;

525 
__Ë32
 
	mÿ±u»
;

526 
__Ë32
 
	mcom´ess
;

527 
¢d_soc_lg_¡»am
 
	m¡»am
[
SND_SOC_TPLG_STREAM_CONFIG_MAX
];

528 
__Ë32
 
	mnum_¡»ams
;

529 
¢d_soc_lg_¡»am_ÿps
 
	mÿps
[2];

530 
__Ë32
 
	mæag_mask
;

531 
__Ë32
 
	mæags
;

532 
¢d_soc_lg_´iv©e
 
	m´iv
;

533 } 
__©Œibu‹__
((
·cked
));

546 
	s¢d_soc_lg_lšk_cÚfig
 {

547 
__Ë32
 
	msize
;

548 
__Ë32
 
	mid
;

549 
	mÇme
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

550 
	m¡»am_Çme
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

551 
¢d_soc_lg_¡»am
 
	m¡»am
[
SND_SOC_TPLG_STREAM_CONFIG_MAX
];

552 
__Ë32
 
	mnum_¡»ams
;

553 
¢d_soc_lg_hw_cÚfig
 
	mhw_cÚfig
[
SND_SOC_TPLG_HW_CONFIG_MAX
];

554 
__Ë32
 
	mnum_hw_cÚfigs
;

555 
__Ë32
 
	mdeçuÉ_hw_cÚfig_id
;

556 
__Ë32
 
	mæag_mask
;

557 
__Ë32
 
	mæags
;

558 
¢d_soc_lg_´iv©e
 
	m´iv
;

559 } 
__©Œibu‹__
((
·cked
));

572 
	s¢d_soc_lg_dai
 {

573 
__Ë32
 
	msize
;

574 
	mdai_Çme
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

575 
__Ë32
 
	mdai_id
;

576 
__Ë32
 
	m¶ayback
;

577 
__Ë32
 
	mÿ±u»
;

578 
¢d_soc_lg_¡»am_ÿps
 
	mÿps
[2];

579 
__Ë32
 
	mæag_mask
;

580 
__Ë32
 
	mæags
;

581 
¢d_soc_lg_´iv©e
 
	m´iv
;

582 } 
__©Œibu‹__
((
·cked
));

589 
	s¢d_soc_lg_mªiã¡_v4
 {

590 
__Ë32
 
	msize
;

591 
__Ë32
 
	mcÚŒŞ_–ems
;

592 
__Ë32
 
	mwidg‘_–ems
;

593 
__Ë32
 
	mg¿ph_–ems
;

594 
__Ë32
 
	mpcm_–ems
;

595 
__Ë32
 
	mdai_lšk_–ems
;

596 
¢d_soc_lg_´iv©e
 
	m´iv
;

597 } 
__©Œibu‹__
((
·cked
));

600 
	s¢d_soc_lg_¡»am_ÿps_v4
 {

601 
__Ë32
 
	msize
;

602 
	mÇme
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

603 
__Ë64
 
	mfÜm©s
;

604 
__Ë32
 
	m¿‹s
;

605 
__Ë32
 
	m¿‹_mš
;

606 
__Ë32
 
	m¿‹_max
;

607 
__Ë32
 
	mchªÃls_mš
;

608 
__Ë32
 
	mchªÃls_max
;

609 
__Ë32
 
	m³riods_mš
;

610 
__Ë32
 
	m³riods_max
;

611 
__Ë32
 
	m³riod_size_mš
;

612 
__Ë32
 
	m³riod_size_max
;

613 
__Ë32
 
	mbufãr_size_mš
;

614 
__Ë32
 
	mbufãr_size_max
;

615 } 
__©Œibu‹__
((
·cked
));

618 
	s¢d_soc_lg_pcm_v4
 {

619 
__Ë32
 
	msize
;

620 
	mpcm_Çme
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

621 
	mdai_Çme
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

622 
__Ë32
 
	mpcm_id
;

623 
__Ë32
 
	mdai_id
;

624 
__Ë32
 
	m¶ayback
;

625 
__Ë32
 
	mÿ±u»
;

626 
__Ë32
 
	mcom´ess
;

627 
¢d_soc_lg_¡»am
 
	m¡»am
[
SND_SOC_TPLG_STREAM_CONFIG_MAX
];

628 
__Ë32
 
	mnum_¡»ams
;

629 
¢d_soc_lg_¡»am_ÿps_v4
 
	mÿps
[2];

630 } 
__©Œibu‹__
((
·cked
));

633 
	s¢d_soc_lg_lšk_cÚfig_v4
 {

634 
__Ë32
 
	msize
;

635 
__Ë32
 
	mid
;

636 
¢d_soc_lg_¡»am
 
	m¡»am
[
SND_SOC_TPLG_STREAM_CONFIG_MAX
];

637 
__Ë32
 
	mnum_¡»ams
;

638 } 
__©Œibu‹__
((
·cked
));

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asound.h

24 #iâdeà
__SOUND_ASOUND_H


25 
	#__SOUND_ASOUND_H


	)

27 #ià
defšed
(
__KERNEL__
è|| defšed(
__lšux__
)

28 
	~<lšux/ty³s.h
>

29 
	~<asm/by‹Üd”.h
>

31 
	~<sys/’dŸn.h
>

32 
	~<sys/ioùl.h
>

35 
	~<¡dlib.h
>

36 
	~<time.h
>

42 
	#SNDRV_PROTOCOL_VERSION
(
majÜ
, 
mšÜ
, 
submšÜ
è(((majÜ)<<16)|((mšÜ)<<8)|(submšÜ))

	)

43 
	#SNDRV_PROTOCOL_MAJOR
(
v”siÚ
è(((v”siÚ)>>16)&0xffff)

	)

44 
	#SNDRV_PROTOCOL_MINOR
(
v”siÚ
è(((v”siÚ)>>8)&0xff)

	)

45 
	#SNDRV_PROTOCOL_MICRO
(
v”siÚ
è((v”siÚ)&0xff)

	)

46 
	#SNDRV_PROTOCOL_INCOMPATIBLE
(
kv”siÚ
, 
uv”siÚ
) \

47 (
	`SNDRV_PROTOCOL_MAJOR
(
kv”siÚ
è!ğSNDRV_PROTOCOL_MAJOR(
uv”siÚ
) || \

48 (
	`SNDRV_PROTOCOL_MAJOR
(
kv”siÚ
è=ğSNDRV_PROTOCOL_MAJOR(
uv”siÚ
) && \

49 
	`SNDRV_PROTOCOL_MINOR
(
kv”siÚ
è!ğSNDRV_PROTOCOL_MINOR(
uv”siÚ
)))

	)

57 
	s¢d_«s_›c958
 {

58 
	m¡©us
[24];

59 
	msubcode
[147];

60 
	m·d
;

61 
	mdig_subäame
[4];

70 
	s¢d_ûa_861_aud_if
 {

71 
	mdb1_ù_cc
;

72 
	mdb2_sf_ss
;

73 
	mdb3
;

74 
	mdb4_ÿ
;

75 
	mdb5_dmšh_lsv
;

84 
	#SNDRV_HWDEP_VERSION
 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 1)

	)

87 
	mSNDRV_HWDEP_IFACE_OPL2
 = 0,

88 
	mSNDRV_HWDEP_IFACE_OPL3
,

89 
	mSNDRV_HWDEP_IFACE_OPL4
,

90 
	mSNDRV_HWDEP_IFACE_SB16CSP
,

91 
	mSNDRV_HWDEP_IFACE_EMU10K1
,

92 
	mSNDRV_HWDEP_IFACE_YSS225
,

93 
	mSNDRV_HWDEP_IFACE_ICS2115
,

94 
	mSNDRV_HWDEP_IFACE_SSCAPE
,

95 
	mSNDRV_HWDEP_IFACE_VX
,

96 
	mSNDRV_HWDEP_IFACE_MIXART
,

97 
	mSNDRV_HWDEP_IFACE_USX2Y
,

98 
	mSNDRV_HWDEP_IFACE_EMUX_WAVETABLE
,

99 
	mSNDRV_HWDEP_IFACE_BLUETOOTH
,

100 
	mSNDRV_HWDEP_IFACE_USX2Y_PCM
,

101 
	mSNDRV_HWDEP_IFACE_PCXHR
,

102 
	mSNDRV_HWDEP_IFACE_SB_RC
,

103 
	mSNDRV_HWDEP_IFACE_HDA
,

104 
	mSNDRV_HWDEP_IFACE_USB_STREAM
,

105 
	mSNDRV_HWDEP_IFACE_FW_DICE
,

106 
	mSNDRV_HWDEP_IFACE_FW_FIREWORKS
,

107 
	mSNDRV_HWDEP_IFACE_FW_BEBOB
,

108 
	mSNDRV_HWDEP_IFACE_FW_OXFW
,

109 
	mSNDRV_HWDEP_IFACE_FW_DIGI00X
,

110 
	mSNDRV_HWDEP_IFACE_FW_TASCAM
,

111 
	mSNDRV_HWDEP_IFACE_LINE6
,

112 
	mSNDRV_HWDEP_IFACE_FW_MOTU
,

113 
	mSNDRV_HWDEP_IFACE_FW_FIREFACE
,

116 
	mSNDRV_HWDEP_IFACE_LAST
 = 
SNDRV_HWDEP_IFACE_FW_FIREFACE


119 
	s¢d_hwd•_šfo
 {

120 
	mdeviû
;

121 
	mÿrd
;

122 
	mid
[64];

123 
	mÇme
[80];

124 
	miçû
;

125 
	m»£rved
[64];

129 
	s¢d_hwd•_d¥_¡©us
 {

130 
	mv”siÚ
;

131 
	mid
[32];

132 
	mnum_d¥s
;

133 
	md¥_lßded
;

134 
	mch_»ady
;

135 
	m»£rved
[16];

138 
	s¢d_hwd•_d¥_image
 {

139 
	mšdex
;

140 
	mÇme
[64];

141 *
	mimage
;

142 
size_t
 
	mËngth
;

143 
	mdriv”_d©a
;

146 
	#SNDRV_HWDEP_IOCTL_PVERSION
 
	`_IOR
 ('H', 0x00, )

	)

147 
	#SNDRV_HWDEP_IOCTL_INFO
 
	`_IOR
 ('H', 0x01, 
¢d_hwd•_šfo
)

	)

148 
	#SNDRV_HWDEP_IOCTL_DSP_STATUS
 
	`_IOR
('H', 0x02, 
¢d_hwd•_d¥_¡©us
)

	)

149 
	#SNDRV_HWDEP_IOCTL_DSP_LOAD
 
	`_IOW
('H', 0x03, 
¢d_hwd•_d¥_image
)

	)

157 
	#SNDRV_PCM_VERSION
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 15)

	)

159 
	t¢d_pcm_uäames_t
;

160 sigÃd 
	t¢d_pcm_säames_t
;

163 
	mSNDRV_PCM_CLASS_GENERIC
 = 0,

164 
	mSNDRV_PCM_CLASS_MULTI
,

165 
	mSNDRV_PCM_CLASS_MODEM
,

166 
	mSNDRV_PCM_CLASS_DIGITIZER
,

168 
	mSNDRV_PCM_CLASS_LAST
 = 
SNDRV_PCM_CLASS_DIGITIZER
,

172 
	mSNDRV_PCM_SUBCLASS_GENERIC_MIX
 = 0,

173 
	mSNDRV_PCM_SUBCLASS_MULTI_MIX
,

175 
	mSNDRV_PCM_SUBCLASS_LAST
 = 
SNDRV_PCM_SUBCLASS_MULTI_MIX
,

179 
	mSNDRV_PCM_STREAM_PLAYBACK
 = 0,

180 
	mSNDRV_PCM_STREAM_CAPTURE
,

181 
	mSNDRV_PCM_STREAM_LAST
 = 
SNDRV_PCM_STREAM_CAPTURE
,

184 
	t__b™wi£
 
	t¢d_pcm_acûss_t
;

185 
	#SNDRV_PCM_ACCESS_MMAP_INTERLEAVED
 ((
¢d_pcm_acûss_t
è0è

	)

186 
	#SNDRV_PCM_ACCESS_MMAP_NONINTERLEAVED
 ((
¢d_pcm_acûss_t
è1è

	)

187 
	#SNDRV_PCM_ACCESS_MMAP_COMPLEX
 ((
¢d_pcm_acûss_t
è2è

	)

188 
	#SNDRV_PCM_ACCESS_RW_INTERLEAVED
 ((
¢d_pcm_acûss_t
è3è

	)

189 
	#SNDRV_PCM_ACCESS_RW_NONINTERLEAVED
 ((
¢d_pcm_acûss_t
è4è

	)

190 
	#SNDRV_PCM_ACCESS_LAST
 
SNDRV_PCM_ACCESS_RW_NONINTERLEAVED


	)

192 
	t__b™wi£
 
	t¢d_pcm_fÜm©_t
;

193 
	#SNDRV_PCM_FORMAT_S8
 ((
¢d_pcm_fÜm©_t
è0)

	)

194 
	#SNDRV_PCM_FORMAT_U8
 ((
¢d_pcm_fÜm©_t
è1)

	)

195 
	#SNDRV_PCM_FORMAT_S16_LE
 ((
¢d_pcm_fÜm©_t
è2)

	)

196 
	#SNDRV_PCM_FORMAT_S16_BE
 ((
¢d_pcm_fÜm©_t
è3)

	)

197 
	#SNDRV_PCM_FORMAT_U16_LE
 ((
¢d_pcm_fÜm©_t
è4)

	)

198 
	#SNDRV_PCM_FORMAT_U16_BE
 ((
¢d_pcm_fÜm©_t
è5)

	)

199 
	#SNDRV_PCM_FORMAT_S24_LE
 ((
¢d_pcm_fÜm©_t
è6è

	)

200 
	#SNDRV_PCM_FORMAT_S24_BE
 ((
¢d_pcm_fÜm©_t
è7è

	)

201 
	#SNDRV_PCM_FORMAT_U24_LE
 ((
¢d_pcm_fÜm©_t
è8è

	)

202 
	#SNDRV_PCM_FORMAT_U24_BE
 ((
¢d_pcm_fÜm©_t
è9è

	)

203 
	#SNDRV_PCM_FORMAT_S32_LE
 ((
¢d_pcm_fÜm©_t
è10)

	)

204 
	#SNDRV_PCM_FORMAT_S32_BE
 ((
¢d_pcm_fÜm©_t
è11)

	)

205 
	#SNDRV_PCM_FORMAT_U32_LE
 ((
¢d_pcm_fÜm©_t
è12)

	)

206 
	#SNDRV_PCM_FORMAT_U32_BE
 ((
¢d_pcm_fÜm©_t
è13)

	)

207 
	#SNDRV_PCM_FORMAT_FLOAT_LE
 ((
¢d_pcm_fÜm©_t
è14è

	)

208 
	#SNDRV_PCM_FORMAT_FLOAT_BE
 ((
¢d_pcm_fÜm©_t
è15è

	)

209 
	#SNDRV_PCM_FORMAT_FLOAT64_LE
 ((
¢d_pcm_fÜm©_t
è16è

	)

210 
	#SNDRV_PCM_FORMAT_FLOAT64_BE
 ((
¢d_pcm_fÜm©_t
è17è

	)

211 
	#SNDRV_PCM_FORMAT_IEC958_SUBFRAME_LE
 ((
¢d_pcm_fÜm©_t
è18è

	)

212 
	#SNDRV_PCM_FORMAT_IEC958_SUBFRAME_BE
 ((
¢d_pcm_fÜm©_t
è19è

	)

213 
	#SNDRV_PCM_FORMAT_MU_LAW
 ((
¢d_pcm_fÜm©_t
è20)

	)

214 
	#SNDRV_PCM_FORMAT_A_LAW
 ((
¢d_pcm_fÜm©_t
è21)

	)

215 
	#SNDRV_PCM_FORMAT_IMA_ADPCM
 ((
¢d_pcm_fÜm©_t
è22)

	)

216 
	#SNDRV_PCM_FORMAT_MPEG
 ((
¢d_pcm_fÜm©_t
è23)

	)

217 
	#SNDRV_PCM_FORMAT_GSM
 ((
¢d_pcm_fÜm©_t
è24)

	)

218 
	#SNDRV_PCM_FORMAT_S20_LE
 ((
¢d_pcm_fÜm©_t
è25è

	)

219 
	#SNDRV_PCM_FORMAT_S20_BE
 ((
¢d_pcm_fÜm©_t
è26è

	)

220 
	#SNDRV_PCM_FORMAT_U20_LE
 ((
¢d_pcm_fÜm©_t
è27è

	)

221 
	#SNDRV_PCM_FORMAT_U20_BE
 ((
¢d_pcm_fÜm©_t
è28è

	)

223 
	#SNDRV_PCM_FORMAT_SPECIAL
 ((
¢d_pcm_fÜm©_t
è31)

	)

224 
	#SNDRV_PCM_FORMAT_S24_3LE
 ((
¢d_pcm_fÜm©_t
è32è

	)

225 
	#SNDRV_PCM_FORMAT_S24_3BE
 ((
¢d_pcm_fÜm©_t
è33è

	)

226 
	#SNDRV_PCM_FORMAT_U24_3LE
 ((
¢d_pcm_fÜm©_t
è34è

	)

227 
	#SNDRV_PCM_FORMAT_U24_3BE
 ((
¢d_pcm_fÜm©_t
è35è

	)

228 
	#SNDRV_PCM_FORMAT_S20_3LE
 ((
¢d_pcm_fÜm©_t
è36è

	)

229 
	#SNDRV_PCM_FORMAT_S20_3BE
 ((
¢d_pcm_fÜm©_t
è37è

	)

230 
	#SNDRV_PCM_FORMAT_U20_3LE
 ((
¢d_pcm_fÜm©_t
è38è

	)

231 
	#SNDRV_PCM_FORMAT_U20_3BE
 ((
¢d_pcm_fÜm©_t
è39è

	)

232 
	#SNDRV_PCM_FORMAT_S18_3LE
 ((
¢d_pcm_fÜm©_t
è40è

	)

233 
	#SNDRV_PCM_FORMAT_S18_3BE
 ((
¢d_pcm_fÜm©_t
è41è

	)

234 
	#SNDRV_PCM_FORMAT_U18_3LE
 ((
¢d_pcm_fÜm©_t
è42è

	)

235 
	#SNDRV_PCM_FORMAT_U18_3BE
 ((
¢d_pcm_fÜm©_t
è43è

	)

236 
	#SNDRV_PCM_FORMAT_G723_24
 ((
¢d_pcm_fÜm©_t
è44è

	)

237 
	#SNDRV_PCM_FORMAT_G723_24_1B
 ((
¢d_pcm_fÜm©_t
è45è

	)

238 
	#SNDRV_PCM_FORMAT_G723_40
 ((
¢d_pcm_fÜm©_t
è46è

	)

239 
	#SNDRV_PCM_FORMAT_G723_40_1B
 ((
¢d_pcm_fÜm©_t
è47è

	)

240 
	#SNDRV_PCM_FORMAT_DSD_U8
 ((
¢d_pcm_fÜm©_t
è48è

	)

241 
	#SNDRV_PCM_FORMAT_DSD_U16_LE
 ((
¢d_pcm_fÜm©_t
è49è

	)

242 
	#SNDRV_PCM_FORMAT_DSD_U32_LE
 ((
¢d_pcm_fÜm©_t
è50è

	)

243 
	#SNDRV_PCM_FORMAT_DSD_U16_BE
 ((
¢d_pcm_fÜm©_t
è51è

	)

244 
	#SNDRV_PCM_FORMAT_DSD_U32_BE
 ((
¢d_pcm_fÜm©_t
è52è

	)

245 
	#SNDRV_PCM_FORMAT_LAST
 
SNDRV_PCM_FORMAT_DSD_U32_BE


	)

246 
	#SNDRV_PCM_FORMAT_FIRST
 
SNDRV_PCM_FORMAT_S8


	)

248 #ifdeà
SNDRV_LITTLE_ENDIAN


249 
	#SNDRV_PCM_FORMAT_S16
 
SNDRV_PCM_FORMAT_S16_LE


	)

250 
	#SNDRV_PCM_FORMAT_U16
 
SNDRV_PCM_FORMAT_U16_LE


	)

251 
	#SNDRV_PCM_FORMAT_S24
 
SNDRV_PCM_FORMAT_S24_LE


	)

252 
	#SNDRV_PCM_FORMAT_U24
 
SNDRV_PCM_FORMAT_U24_LE


	)

253 
	#SNDRV_PCM_FORMAT_S32
 
SNDRV_PCM_FORMAT_S32_LE


	)

254 
	#SNDRV_PCM_FORMAT_U32
 
SNDRV_PCM_FORMAT_U32_LE


	)

255 
	#SNDRV_PCM_FORMAT_FLOAT
 
SNDRV_PCM_FORMAT_FLOAT_LE


	)

256 
	#SNDRV_PCM_FORMAT_FLOAT64
 
SNDRV_PCM_FORMAT_FLOAT64_LE


	)

257 
	#SNDRV_PCM_FORMAT_IEC958_SUBFRAME
 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_LE


	)

258 
	#SNDRV_PCM_FORMAT_S20
 
SNDRV_PCM_FORMAT_S20_LE


	)

259 
	#SNDRV_PCM_FORMAT_U20
 
SNDRV_PCM_FORMAT_U20_LE


	)

261 #ifdeà
SNDRV_BIG_ENDIAN


262 
	#SNDRV_PCM_FORMAT_S16
 
SNDRV_PCM_FORMAT_S16_BE


	)

263 
	#SNDRV_PCM_FORMAT_U16
 
SNDRV_PCM_FORMAT_U16_BE


	)

264 
	#SNDRV_PCM_FORMAT_S24
 
SNDRV_PCM_FORMAT_S24_BE


	)

265 
	#SNDRV_PCM_FORMAT_U24
 
SNDRV_PCM_FORMAT_U24_BE


	)

266 
	#SNDRV_PCM_FORMAT_S32
 
SNDRV_PCM_FORMAT_S32_BE


	)

267 
	#SNDRV_PCM_FORMAT_U32
 
SNDRV_PCM_FORMAT_U32_BE


	)

268 
	#SNDRV_PCM_FORMAT_FLOAT
 
SNDRV_PCM_FORMAT_FLOAT_BE


	)

269 
	#SNDRV_PCM_FORMAT_FLOAT64
 
SNDRV_PCM_FORMAT_FLOAT64_BE


	)

270 
	#SNDRV_PCM_FORMAT_IEC958_SUBFRAME
 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_BE


	)

271 
	#SNDRV_PCM_FORMAT_S20
 
SNDRV_PCM_FORMAT_S20_BE


	)

272 
	#SNDRV_PCM_FORMAT_U20
 
SNDRV_PCM_FORMAT_U20_BE


	)

275 
	t__b™wi£
 
	t¢d_pcm_subfÜm©_t
;

276 
	#SNDRV_PCM_SUBFORMAT_STD
 ((
¢d_pcm_subfÜm©_t
è0)

	)

277 
	#SNDRV_PCM_SUBFORMAT_MSBITS_MAX
 ((
¢d_pcm_subfÜm©_t
è1)

	)

278 
	#SNDRV_PCM_SUBFORMAT_MSBITS_20
 ((
¢d_pcm_subfÜm©_t
è2)

	)

279 
	#SNDRV_PCM_SUBFORMAT_MSBITS_24
 ((
¢d_pcm_subfÜm©_t
è3)

	)

280 
	#SNDRV_PCM_SUBFORMAT_LAST
 
SNDRV_PCM_SUBFORMAT_MSBITS_24


	)

282 
	#SNDRV_PCM_INFO_MMAP
 0x00000001

	)

283 
	#SNDRV_PCM_INFO_MMAP_VALID
 0x00000002

	)

284 
	#SNDRV_PCM_INFO_DOUBLE
 0x00000004

	)

285 
	#SNDRV_PCM_INFO_BATCH
 0x00000010

	)

286 
	#SNDRV_PCM_INFO_SYNC_APPLPTR
 0x00000020

	)

287 
	#SNDRV_PCM_INFO_PERFECT_DRAIN
 0x00000040

	)

288 
	#SNDRV_PCM_INFO_INTERLEAVED
 0x00000100

	)

289 
	#SNDRV_PCM_INFO_NONINTERLEAVED
 0x00000200

	)

290 
	#SNDRV_PCM_INFO_COMPLEX
 0x00000400

	)

291 
	#SNDRV_PCM_INFO_BLOCK_TRANSFER
 0x00010000

	)

292 
	#SNDRV_PCM_INFO_OVERRANGE
 0x00020000

	)

293 
	#SNDRV_PCM_INFO_RESUME
 0x00040000

	)

294 
	#SNDRV_PCM_INFO_PAUSE
 0x00080000

	)

295 
	#SNDRV_PCM_INFO_HALF_DUPLEX
 0x00100000

	)

296 
	#SNDRV_PCM_INFO_JOINT_DUPLEX
 0x00200000

	)

297 
	#SNDRV_PCM_INFO_SYNC_START
 0x00400000

	)

298 
	#SNDRV_PCM_INFO_NO_PERIOD_WAKEUP
 0x00800000

	)

299 
	#SNDRV_PCM_INFO_HAS_WALL_CLOCK
 0x01000000

	)

300 
	#SNDRV_PCM_INFO_HAS_LINK_ATIME
 0x01000000

	)

301 
	#SNDRV_PCM_INFO_HAS_LINK_ABSOLUTE_ATIME
 0x02000000

	)

302 
	#SNDRV_PCM_INFO_HAS_LINK_ESTIMATED_ATIME
 0x04000000

	)

303 
	#SNDRV_PCM_INFO_HAS_LINK_SYNCHRONIZED_ATIME
 0x08000000

	)

305 
	#SNDRV_PCM_INFO_DRAIN_TRIGGER
 0x40000000

	)

306 
	#SNDRV_PCM_INFO_FIFO_IN_FRAMES
 0x80000000

	)

308 #ià(
__BITS_PER_LONG
 =ğ32 && 
defšed
(
__USE_TIME_BITS64
)è|| defšed 
__KERNEL__


309 
	#__SND_STRUCT_TIME64


	)

312 
	t__b™wi£
 
	t¢d_pcm_¡©e_t
;

313 
	#SNDRV_PCM_STATE_OPEN
 ((
¢d_pcm_¡©e_t
è0è

	)

314 
	#SNDRV_PCM_STATE_SETUP
 ((
¢d_pcm_¡©e_t
è1è

	)

315 
	#SNDRV_PCM_STATE_PREPARED
 ((
¢d_pcm_¡©e_t
è2è

	)

316 
	#SNDRV_PCM_STATE_RUNNING
 ((
¢d_pcm_¡©e_t
è3è

	)

317 
	#SNDRV_PCM_STATE_XRUN
 ((
¢d_pcm_¡©e_t
è4è

	)

318 
	#SNDRV_PCM_STATE_DRAINING
 ((
¢d_pcm_¡©e_t
è5è

	)

319 
	#SNDRV_PCM_STATE_PAUSED
 ((
¢d_pcm_¡©e_t
è6è

	)

320 
	#SNDRV_PCM_STATE_SUSPENDED
 ((
¢d_pcm_¡©e_t
è7è

	)

321 
	#SNDRV_PCM_STATE_DISCONNECTED
 ((
¢d_pcm_¡©e_t
è8è

	)

322 
	#SNDRV_PCM_STATE_LAST
 
SNDRV_PCM_STATE_DISCONNECTED


	)

325 
	mSNDRV_PCM_MMAP_OFFSET_DATA
 = 0x00000000,

326 
	mSNDRV_PCM_MMAP_OFFSET_STATUS_OLD
 = 0x80000000,

327 
	mSNDRV_PCM_MMAP_OFFSET_CONTROL_OLD
 = 0x81000000,

328 
	mSNDRV_PCM_MMAP_OFFSET_STATUS_NEW
 = 0x82000000,

329 
	mSNDRV_PCM_MMAP_OFFSET_CONTROL_NEW
 = 0x83000000,

330 #ifdeà
__SND_STRUCT_TIME64


331 
	mSNDRV_PCM_MMAP_OFFSET_STATUS
 = 
SNDRV_PCM_MMAP_OFFSET_STATUS_NEW
,

332 
	mSNDRV_PCM_MMAP_OFFSET_CONTROL
 = 
SNDRV_PCM_MMAP_OFFSET_CONTROL_NEW
,

334 
	mSNDRV_PCM_MMAP_OFFSET_STATUS
 = 
SNDRV_PCM_MMAP_OFFSET_STATUS_OLD
,

335 
	mSNDRV_PCM_MMAP_OFFSET_CONTROL
 = 
SNDRV_PCM_MMAP_OFFSET_CONTROL_OLD
,

339 
	u¢d_pcm_sync_id
 {

340 
	mid
[16];

341 
	mid16
[8];

342 
	mid32
[4];

345 
	s¢d_pcm_šfo
 {

346 
	mdeviû
;

347 
	msubdeviû
;

348 
	m¡»am
;

349 
	mÿrd
;

350 
	mid
[64];

351 
	mÇme
[80];

352 
	msubÇme
[32];

353 
	mdev_şass
;

354 
	mdev_subşass
;

355 
	msubdeviûs_couÁ
;

356 
	msubdeviûs_ava
;

357 
¢d_pcm_sync_id
 
	msync
;

358 
	m»£rved
[64];

361 
	t¢d_pcm_hw_·¿m_t
;

362 
	#SNDRV_PCM_HW_PARAM_ACCESS
 0

	)

363 
	#SNDRV_PCM_HW_PARAM_FORMAT
 1

	)

364 
	#SNDRV_PCM_HW_PARAM_SUBFORMAT
 2

	)

365 
	#SNDRV_PCM_HW_PARAM_FIRST_MASK
 
SNDRV_PCM_HW_PARAM_ACCESS


	)

366 
	#SNDRV_PCM_HW_PARAM_LAST_MASK
 
SNDRV_PCM_HW_PARAM_SUBFORMAT


	)

368 
	#SNDRV_PCM_HW_PARAM_SAMPLE_BITS
 8

	)

369 
	#SNDRV_PCM_HW_PARAM_FRAME_BITS
 9

	)

370 
	#SNDRV_PCM_HW_PARAM_CHANNELS
 10

	)

371 
	#SNDRV_PCM_HW_PARAM_RATE
 11

	)

372 
	#SNDRV_PCM_HW_PARAM_PERIOD_TIME
 12

	)

375 
	#SNDRV_PCM_HW_PARAM_PERIOD_SIZE
 13

	)

378 
	#SNDRV_PCM_HW_PARAM_PERIOD_BYTES
 14

	)

381 
	#SNDRV_PCM_HW_PARAM_PERIODS
 15

	)

384 
	#SNDRV_PCM_HW_PARAM_BUFFER_TIME
 16

	)

387 
	#SNDRV_PCM_HW_PARAM_BUFFER_SIZE
 17

	)

388 
	#SNDRV_PCM_HW_PARAM_BUFFER_BYTES
 18

	)

389 
	#SNDRV_PCM_HW_PARAM_TICK_TIME
 19

	)

390 
	#SNDRV_PCM_HW_PARAM_FIRST_INTERVAL
 
SNDRV_PCM_HW_PARAM_SAMPLE_BITS


	)

391 
	#SNDRV_PCM_HW_PARAM_LAST_INTERVAL
 
SNDRV_PCM_HW_PARAM_TICK_TIME


	)

393 
	#SNDRV_PCM_HW_PARAMS_NORESAMPLE
 (1<<0è

	)

394 
	#SNDRV_PCM_HW_PARAMS_EXPORT_BUFFER
 (1<<1è

	)

395 
	#SNDRV_PCM_HW_PARAMS_NO_PERIOD_WAKEUP
 (1<<2è

	)

396 
	#SNDRV_PCM_HW_PARAMS_NO_DRAIN_SILENCE
 (1<<3è

	)

400 
	s¢d_š‹rv®
 {

401 
	mmš
, 
	mmax
;

402 
	mİ’mš
:1,

403 
	mİ’max
:1,

404 
	mš‹g”
:1,

405 
	mem±y
:1;

408 
	#SNDRV_MASK_MAX
 256

	)

410 
	s¢d_mask
 {

411 
__u32
 
	mb™s
[(
SNDRV_MASK_MAX
+31)/32];

414 
	s¢d_pcm_hw_·¿ms
 {

415 
	mæags
;

416 
¢d_mask
 
	mmasks
[
SNDRV_PCM_HW_PARAM_LAST_MASK
 -

417 
SNDRV_PCM_HW_PARAM_FIRST_MASK
 + 1];

418 
¢d_mask
 
	mm»s
[5];

419 
¢d_š‹rv®
 
	mš‹rv®s
[
SNDRV_PCM_HW_PARAM_LAST_INTERVAL
 -

420 
SNDRV_PCM_HW_PARAM_FIRST_INTERVAL
 + 1];

421 
¢d_š‹rv®
 
	mœes
[9];

422 
	mrmask
;

423 
	mcmask
;

424 
	mšfo
;

425 
	mmsb™s
;

426 
	m¿‹_num
;

427 
	m¿‹_d’
;

428 
¢d_pcm_uäames_t
 
	mfifo_size
;

429 
	m»£rved
[64];

433 
	mSNDRV_PCM_TSTAMP_NONE
 = 0,

434 
	mSNDRV_PCM_TSTAMP_ENABLE
,

435 
	mSNDRV_PCM_TSTAMP_LAST
 = 
SNDRV_PCM_TSTAMP_ENABLE
,

438 
	s¢d_pcm_sw_·¿ms
 {

439 
	mt¡amp_mode
;

440 
	m³riod_¡•
;

441 
	m¦“p_mš
;

442 
¢d_pcm_uäames_t
 
	mava_mš
;

443 
¢d_pcm_uäames_t
 
	mxãr_®ign
;

444 
¢d_pcm_uäames_t
 
	m¡¬t_th»shŞd
;

445 
¢d_pcm_uäames_t
 
	m¡İ_th»shŞd
;

446 
¢d_pcm_uäames_t
 
	ms’û_th»shŞd
;

447 
¢d_pcm_uäames_t
 
	ms’û_size
;

448 
¢d_pcm_uäames_t
 
	mbound¬y
;

449 
	m´Ùo
;

450 
	mt¡amp_ty³
;

451 
	m»£rved
[56];

454 
	s¢d_pcm_chªÃl_šfo
 {

455 
	mchªÃl
;

456 
__k”Ãl_off_t
 
	moff£t
;

457 
	mfœ¡
;

458 
	m¡•
;

466 
	mSNDRV_PCM_AUDIO_TSTAMP_TYPE_COMPAT
 = 0,

469 
	mSNDRV_PCM_AUDIO_TSTAMP_TYPE_DEFAULT
 = 1,

470 
	mSNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK
 = 2,

471 
	mSNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK_ABSOLUTE
 = 3,

472 
	mSNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK_ESTIMATED
 = 4,

473 
	mSNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK_SYNCHRONIZED
 = 5,

474 
	mSNDRV_PCM_AUDIO_TSTAMP_TYPE_LAST
 = 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK_SYNCHRONIZED


478 ¡ruù { 
	m·d
[(
time_t
è- ()]; } 
	t__time_·d
;

480 
	s¢d_pcm_¡©us
 {

481 
¢d_pcm_¡©e_t
 
	m¡©e
;

482 
__time_·d
 
	m·d1
;

483 
time¥ec
 
	mŒigg”_t¡amp
;

484 
time¥ec
 
	mt¡amp
;

485 
¢d_pcm_uäames_t
 
	m­¶_±r
;

486 
¢d_pcm_uäames_t
 
	mhw_±r
;

487 
¢d_pcm_säames_t
 
	md–ay
;

488 
¢d_pcm_uäames_t
 
	mava
;

489 
¢d_pcm_uäames_t
 
	mava_max
;

490 
¢d_pcm_uäames_t
 
	mov”¿nge
;

491 
¢d_pcm_¡©e_t
 
	msu¥’ded_¡©e
;

492 
__u32
 
	maudio_t¡amp_d©a
;

493 
time¥ec
 
	maudio_t¡amp
;

494 
time¥ec
 
	mdriv”_t¡amp
;

495 
__u32
 
	maudio_t¡amp_accu¿cy
;

496 
	m»£rved
[52-2*(
time¥ec
)];

504 #ifdeà
__SND_STRUCT_TIME64


505 
	#__¢d_pcm_mm­_¡©us64
 
¢d_pcm_mm­_¡©us


	)

506 
	#__¢d_pcm_mm­_cÚŒŞ64
 
¢d_pcm_mm­_cÚŒŞ


	)

507 
	#__¢d_pcm_sync_±r64
 
¢d_pcm_sync_±r


	)

508 
	#__¢d_time¥ec64
 
time¥ec


	)

509 
	s__¢d_time¥ec
 {

510 
__s32
 
	mtv_£c
;

511 
__s32
 
	mtv_n£c
;

514 
	#__¢d_pcm_mm­_¡©us
 
¢d_pcm_mm­_¡©us


	)

515 
	#__¢d_pcm_mm­_cÚŒŞ
 
¢d_pcm_mm­_cÚŒŞ


	)

516 
	#__¢d_pcm_sync_±r
 
¢d_pcm_sync_±r


	)

517 
	#__¢d_time¥ec
 
time¥ec


	)

518 
	s__¢d_time¥ec64
 {

519 
__s64
 
	mtv_£c
;

520 
__s64
 
	mtv_n£c
;

525 
	s__¢d_pcm_mm­_¡©us
 {

526 
¢d_pcm_¡©e_t
 
	m¡©e
;

527 
	m·d1
;

528 
¢d_pcm_uäames_t
 
	mhw_±r
;

529 
__¢d_time¥ec
 
	mt¡amp
;

530 
¢d_pcm_¡©e_t
 
	msu¥’ded_¡©e
;

531 
__¢d_time¥ec
 
	maudio_t¡amp
;

534 
	s__¢d_pcm_mm­_cÚŒŞ
 {

535 
¢d_pcm_uäames_t
 
	m­¶_±r
;

536 
¢d_pcm_uäames_t
 
	mava_mš
;

539 
	#SNDRV_PCM_SYNC_PTR_HWSYNC
 (1<<0è

	)

540 
	#SNDRV_PCM_SYNC_PTR_APPL
 (1<<1è

	)

541 
	#SNDRV_PCM_SYNC_PTR_AVAIL_MIN
 (1<<2è

	)

543 
	s__¢d_pcm_sync_±r
 {

544 
	mæags
;

546 
__¢d_pcm_mm­_¡©us
 
	m¡©us
;

547 
	m»£rved
[64];

548 } 
	ms
;

550 
__¢d_pcm_mm­_cÚŒŞ
 
	mcÚŒŞ
;

551 
	m»£rved
[64];

552 } 
	mc
;

555 #ià
defšed
(
__BYTE_ORDER
è? __BYTE_ORDER =ğ
__BIG_ENDIAN
 : defined(__BIG_ENDIAN)

556 
	t__·d_befÜe_uäame
[(
__u64
è- (
¢d_pcm_uäames_t
)];

557 
	t__·d_aá”_uäame
[0];

560 #ià
defšed
(
__BYTE_ORDER
è? __BYTE_ORDER =ğ
__LITTLE_ENDIAN
 : defined(__LITTLE_ENDIAN)

561 
	t__·d_befÜe_uäame
[0];

562 
	t__·d_aá”_uäame
[(
__u64
è- (
¢d_pcm_uäames_t
)];

565 
	s__¢d_pcm_mm­_¡©us64
 {

566 
¢d_pcm_¡©e_t
 
	m¡©e
;

567 
__u32
 
	m·d1
;

568 
__·d_befÜe_uäame
 
	m__·d1
;

569 
¢d_pcm_uäames_t
 
	mhw_±r
;

570 
__·d_aá”_uäame
 
	m__·d2
;

571 
__¢d_time¥ec64
 
	mt¡amp
;

572 
¢d_pcm_¡©e_t
 
	msu¥’ded_¡©e
;

573 
__u32
 
	m·d3
;

574 
__¢d_time¥ec64
 
	maudio_t¡amp
;

577 
	s__¢d_pcm_mm­_cÚŒŞ64
 {

578 
__·d_befÜe_uäame
 
	m__·d1
;

579 
¢d_pcm_uäames_t
 
	m­¶_±r
;

580 
__·d_befÜe_uäame
 
	m__·d2
;

582 
__·d_befÜe_uäame
 
	m__·d3
;

583 
¢d_pcm_uäames_t
 
	mava_mš
;

584 
__·d_aá”_uäame
 
	m__·d4
;

587 
	s__¢d_pcm_sync_±r64
 {

588 
__u32
 
	mæags
;

589 
__u32
 
	m·d1
;

591 
__¢d_pcm_mm­_¡©us64
 
	m¡©us
;

592 
	m»£rved
[64];

593 } 
	ms
;

595 
__¢d_pcm_mm­_cÚŒŞ64
 
	mcÚŒŞ
;

596 
	m»£rved
[64];

597 } 
	mc
;

600 
	s¢d_xãri
 {

601 
¢d_pcm_säames_t
 
	m»suÉ
;

602 *
	mbuf
;

603 
¢d_pcm_uäames_t
 
	mäames
;

606 
	s¢d_xãº
 {

607 
¢d_pcm_säames_t
 
	m»suÉ
;

608 * *
	mbufs
;

609 
¢d_pcm_uäames_t
 
	mäames
;

613 
	mSNDRV_PCM_TSTAMP_TYPE_GETTIMEOFDAY
 = 0,

614 
	mSNDRV_PCM_TSTAMP_TYPE_MONOTONIC
,

615 
	mSNDRV_PCM_TSTAMP_TYPE_MONOTONIC_RAW
,

616 
	mSNDRV_PCM_TSTAMP_TYPE_LAST
 = 
SNDRV_PCM_TSTAMP_TYPE_MONOTONIC_RAW
,

621 
	mSNDRV_CHMAP_UNKNOWN
 = 0,

622 
	mSNDRV_CHMAP_NA
,

623 
	mSNDRV_CHMAP_MONO
,

625 
	mSNDRV_CHMAP_FL
,

626 
	mSNDRV_CHMAP_FR
,

627 
	mSNDRV_CHMAP_RL
,

628 
	mSNDRV_CHMAP_RR
,

629 
	mSNDRV_CHMAP_FC
,

630 
	mSNDRV_CHMAP_LFE
,

631 
	mSNDRV_CHMAP_SL
,

632 
	mSNDRV_CHMAP_SR
,

633 
	mSNDRV_CHMAP_RC
,

635 
	mSNDRV_CHMAP_FLC
,

636 
	mSNDRV_CHMAP_FRC
,

637 
	mSNDRV_CHMAP_RLC
,

638 
	mSNDRV_CHMAP_RRC
,

639 
	mSNDRV_CHMAP_FLW
,

640 
	mSNDRV_CHMAP_FRW
,

641 
	mSNDRV_CHMAP_FLH
,

642 
	mSNDRV_CHMAP_FCH
,

643 
	mSNDRV_CHMAP_FRH
,

644 
	mSNDRV_CHMAP_TC
,

645 
	mSNDRV_CHMAP_TFL
,

646 
	mSNDRV_CHMAP_TFR
,

647 
	mSNDRV_CHMAP_TFC
,

648 
	mSNDRV_CHMAP_TRL
,

649 
	mSNDRV_CHMAP_TRR
,

650 
	mSNDRV_CHMAP_TRC
,

652 
	mSNDRV_CHMAP_TFLC
,

653 
	mSNDRV_CHMAP_TFRC
,

654 
	mSNDRV_CHMAP_TSL
,

655 
	mSNDRV_CHMAP_TSR
,

656 
	mSNDRV_CHMAP_LLFE
,

657 
	mSNDRV_CHMAP_RLFE
,

658 
	mSNDRV_CHMAP_BC
,

659 
	mSNDRV_CHMAP_BLC
,

660 
	mSNDRV_CHMAP_BRC
,

661 
	mSNDRV_CHMAP_LAST
 = 
SNDRV_CHMAP_BRC
,

664 
	#SNDRV_CHMAP_POSITION_MASK
 0xffff

	)

665 
	#SNDRV_CHMAP_PHASE_INVERSE
 (0x01 << 16)

	)

666 
	#SNDRV_CHMAP_DRIVER_SPEC
 (0x02 << 16)

	)

668 
	#SNDRV_PCM_IOCTL_PVERSION
 
	`_IOR
('A', 0x00, )

	)

669 
	#SNDRV_PCM_IOCTL_INFO
 
	`_IOR
('A', 0x01, 
¢d_pcm_šfo
)

	)

670 
	#SNDRV_PCM_IOCTL_TSTAMP
 
	`_IOW
('A', 0x02, )

	)

671 
	#SNDRV_PCM_IOCTL_TTSTAMP
 
	`_IOW
('A', 0x03, )

	)

672 
	#SNDRV_PCM_IOCTL_USER_PVERSION
 
	`_IOW
('A', 0x04, )

	)

673 
	#SNDRV_PCM_IOCTL_HW_REFINE
 
	`_IOWR
('A', 0x10, 
¢d_pcm_hw_·¿ms
)

	)

674 
	#SNDRV_PCM_IOCTL_HW_PARAMS
 
	`_IOWR
('A', 0x11, 
¢d_pcm_hw_·¿ms
)

	)

675 
	#SNDRV_PCM_IOCTL_HW_FREE
 
	`_IO
('A', 0x12)

	)

676 
	#SNDRV_PCM_IOCTL_SW_PARAMS
 
	`_IOWR
('A', 0x13, 
¢d_pcm_sw_·¿ms
)

	)

677 
	#SNDRV_PCM_IOCTL_STATUS
 
	`_IOR
('A', 0x20, 
¢d_pcm_¡©us
)

	)

678 
	#SNDRV_PCM_IOCTL_DELAY
 
	`_IOR
('A', 0x21, 
¢d_pcm_säames_t
)

	)

679 
	#SNDRV_PCM_IOCTL_HWSYNC
 
	`_IO
('A', 0x22)

	)

680 
	#__SNDRV_PCM_IOCTL_SYNC_PTR
 
	`_IOWR
('A', 0x23, 
__¢d_pcm_sync_±r
)

	)

681 
	#__SNDRV_PCM_IOCTL_SYNC_PTR64
 
	`_IOWR
('A', 0x23, 
__¢d_pcm_sync_±r64
)

	)

682 
	#SNDRV_PCM_IOCTL_SYNC_PTR
 
	`_IOWR
('A', 0x23, 
¢d_pcm_sync_±r
)

	)

683 
	#SNDRV_PCM_IOCTL_STATUS_EXT
 
	`_IOWR
('A', 0x24, 
¢d_pcm_¡©us
)

	)

684 
	#SNDRV_PCM_IOCTL_CHANNEL_INFO
 
	`_IOR
('A', 0x32, 
¢d_pcm_chªÃl_šfo
)

	)

685 
	#SNDRV_PCM_IOCTL_PREPARE
 
	`_IO
('A', 0x40)

	)

686 
	#SNDRV_PCM_IOCTL_RESET
 
	`_IO
('A', 0x41)

	)

687 
	#SNDRV_PCM_IOCTL_START
 
	`_IO
('A', 0x42)

	)

688 
	#SNDRV_PCM_IOCTL_DROP
 
	`_IO
('A', 0x43)

	)

689 
	#SNDRV_PCM_IOCTL_DRAIN
 
	`_IO
('A', 0x44)

	)

690 
	#SNDRV_PCM_IOCTL_PAUSE
 
	`_IOW
('A', 0x45, )

	)

691 
	#SNDRV_PCM_IOCTL_REWIND
 
	`_IOW
('A', 0x46, 
¢d_pcm_uäames_t
)

	)

692 
	#SNDRV_PCM_IOCTL_RESUME
 
	`_IO
('A', 0x47)

	)

693 
	#SNDRV_PCM_IOCTL_XRUN
 
	`_IO
('A', 0x48)

	)

694 
	#SNDRV_PCM_IOCTL_FORWARD
 
	`_IOW
('A', 0x49, 
¢d_pcm_uäames_t
)

	)

695 
	#SNDRV_PCM_IOCTL_WRITEI_FRAMES
 
	`_IOW
('A', 0x50, 
¢d_xãri
)

	)

696 
	#SNDRV_PCM_IOCTL_READI_FRAMES
 
	`_IOR
('A', 0x51, 
¢d_xãri
)

	)

697 
	#SNDRV_PCM_IOCTL_WRITEN_FRAMES
 
	`_IOW
('A', 0x52, 
¢d_xãº
)

	)

698 
	#SNDRV_PCM_IOCTL_READN_FRAMES
 
	`_IOR
('A', 0x53, 
¢d_xãº
)

	)

699 
	#SNDRV_PCM_IOCTL_LINK
 
	`_IOW
('A', 0x60, )

	)

700 
	#SNDRV_PCM_IOCTL_UNLINK
 
	`_IO
('A', 0x61)

	)

712 
	#SNDRV_RAWMIDI_VERSION
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4)

	)

715 
	mSNDRV_RAWMIDI_STREAM_OUTPUT
 = 0,

716 
	mSNDRV_RAWMIDI_STREAM_INPUT
,

717 
	mSNDRV_RAWMIDI_STREAM_LAST
 = 
SNDRV_RAWMIDI_STREAM_INPUT
,

720 
	#SNDRV_RAWMIDI_INFO_OUTPUT
 0x00000001

	)

721 
	#SNDRV_RAWMIDI_INFO_INPUT
 0x00000002

	)

722 
	#SNDRV_RAWMIDI_INFO_DUPLEX
 0x00000004

	)

723 
	#SNDRV_RAWMIDI_INFO_UMP
 0x00000008

	)

725 
	s¢d_¿wmidi_šfo
 {

726 
	mdeviû
;

727 
	msubdeviû
;

728 
	m¡»am
;

729 
	mÿrd
;

730 
	mæags
;

731 
	mid
[64];

732 
	mÇme
[80];

733 
	msubÇme
[32];

734 
	msubdeviûs_couÁ
;

735 
	msubdeviûs_ava
;

736 
	m»£rved
[64];

739 
	#SNDRV_RAWMIDI_MODE_FRAMING_MASK
 (7<<0)

	)

740 
	#SNDRV_RAWMIDI_MODE_FRAMING_SHIFT
 0

	)

741 
	#SNDRV_RAWMIDI_MODE_FRAMING_NONE
 (0<<0)

	)

742 
	#SNDRV_RAWMIDI_MODE_FRAMING_TSTAMP
 (1<<0)

	)

743 
	#SNDRV_RAWMIDI_MODE_CLOCK_MASK
 (7<<3)

	)

744 
	#SNDRV_RAWMIDI_MODE_CLOCK_SHIFT
 3

	)

745 
	#SNDRV_RAWMIDI_MODE_CLOCK_NONE
 (0<<3)

	)

746 
	#SNDRV_RAWMIDI_MODE_CLOCK_REALTIME
 (1<<3)

	)

747 
	#SNDRV_RAWMIDI_MODE_CLOCK_MONOTONIC
 (2<<3)

	)

748 
	#SNDRV_RAWMIDI_MODE_CLOCK_MONOTONIC_RAW
 (3<<3)

	)

750 
	#SNDRV_RAWMIDI_FRAMING_DATA_LENGTH
 16

	)

752 
	s¢d_¿wmidi_äamšg_t¡amp
 {

756 
__u8
 
	mäame_ty³
;

757 
__u8
 
	mËngth
;

758 
__u8
 
	m»£rved
[2];

759 
__u32
 
	mtv_n£c
;

760 
__u64
 
	mtv_£c
;

761 
__u8
 
	md©a
[
SNDRV_RAWMIDI_FRAMING_DATA_LENGTH
];

762 } 
	g__·cked
;

764 
	s¢d_¿wmidi_·¿ms
 {

765 
	m¡»am
;

766 
size_t
 
	mbufãr_size
;

767 
size_t
 
	mava_mš
;

768 
	mno_aùive_£nsšg
: 1;

769 
	mmode
;

770 
	m»£rved
[12];

773 
	s¢d_¿wmidi_¡©us
 {

774 
	m¡»am
;

775 
__time_·d
 
	m·d1
;

776 
time¥ec
 
	mt¡amp
;

777 
size_t
 
	mava
;

778 
size_t
 
	mxruns
;

779 
	m»£rved
[16];

783 
	#SNDRV_UMP_EP_INFO_STATIC_BLOCKS
 0x01

	)

786 
	#SNDRV_UMP_EP_INFO_PROTO_MIDI_MASK
 0x0300

	)

787 
	#SNDRV_UMP_EP_INFO_PROTO_MIDI1
 0x0100

	)

788 
	#SNDRV_UMP_EP_INFO_PROTO_MIDI2
 0x0200

	)

789 
	#SNDRV_UMP_EP_INFO_PROTO_JRTS_MASK
 0x0003

	)

790 
	#SNDRV_UMP_EP_INFO_PROTO_JRTS_TX
 0x0001

	)

791 
	#SNDRV_UMP_EP_INFO_PROTO_JRTS_RX
 0x0002

	)

794 
	s¢d_ump_’dpošt_šfo
 {

795 
	mÿrd
;

796 
	mdeviû
;

797 
	mæags
;

798 
	m´ÙocŞ_ÿps
;

799 
	m´ÙocŞ
;

800 
	mnum_blocks
;

801 
	mv”siÚ
;

802 
	mçmy_id
;

803 
	mmod–_id
;

804 
	mmªuçùu»r_id
;

805 
	msw_»visiÚ
[4];

806 
	m·ddšg
;

807 
	mÇme
[128];

808 
	m´oduù_id
[128];

809 
	m»£rved
[32];

810 } 
	g__·cked
;

813 
	#SNDRV_UMP_DIR_INPUT
 0x01

	)

814 
	#SNDRV_UMP_DIR_OUTPUT
 0x02

	)

815 
	#SNDRV_UMP_DIR_BIDIRECTION
 0x03

	)

818 
	#SNDRV_UMP_BLOCK_IS_MIDI1
 (1U << 0è

	)

819 
	#SNDRV_UMP_BLOCK_IS_LOWSPEED
 (1U << 1è

	)

822 
	#SNDRV_UMP_BLOCK_UI_HINT_UNKNOWN
 0x00

	)

823 
	#SNDRV_UMP_BLOCK_UI_HINT_RECEIVER
 0x01

	)

824 
	#SNDRV_UMP_BLOCK_UI_HINT_SENDER
 0x02

	)

825 
	#SNDRV_UMP_BLOCK_UI_HINT_BOTH
 0x03

	)

828 
	#SNDRV_UMP_MAX_GROUPS
 16

	)

829 
	#SNDRV_UMP_MAX_BLOCKS
 32

	)

832 
	s¢d_ump_block_šfo
 {

833 
	mÿrd
;

834 
	mdeviû
;

835 
	mblock_id
;

836 
	mdœeùiÚ
;

837 
	maùive
;

838 
	mfœ¡_group
;

839 
	mnum_groups
;

840 
	mmidi_ci_v”siÚ
;

841 
	msy£x8_¡»ams
;

842 
	mui_hšt
;

843 
	mæags
;

844 
	mÇme
[128];

845 
	m»£rved
[32];

846 } 
	g__·cked
;

848 
	#SNDRV_RAWMIDI_IOCTL_PVERSION
 
	`_IOR
('W', 0x00, )

	)

849 
	#SNDRV_RAWMIDI_IOCTL_INFO
 
	`_IOR
('W', 0x01, 
¢d_¿wmidi_šfo
)

	)

850 
	#SNDRV_RAWMIDI_IOCTL_USER_PVERSION
 
	`_IOW
('W', 0x02, )

	)

851 
	#SNDRV_RAWMIDI_IOCTL_PARAMS
 
	`_IOWR
('W', 0x10, 
¢d_¿wmidi_·¿ms
)

	)

852 
	#SNDRV_RAWMIDI_IOCTL_STATUS
 
	`_IOWR
('W', 0x20, 
¢d_¿wmidi_¡©us
)

	)

853 
	#SNDRV_RAWMIDI_IOCTL_DROP
 
	`_IOW
('W', 0x30, )

	)

854 
	#SNDRV_RAWMIDI_IOCTL_DRAIN
 
	`_IOW
('W', 0x31, )

	)

856 
	#SNDRV_UMP_IOCTL_ENDPOINT_INFO
 
	`_IOR
('W', 0x40, 
¢d_ump_’dpošt_šfo
)

	)

857 
	#SNDRV_UMP_IOCTL_BLOCK_INFO
 
	`_IOR
('W', 0x41, 
¢d_ump_block_šfo
)

	)

863 
	#SNDRV_TIMER_VERSION
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 7)

	)

866 
	mSNDRV_TIMER_CLASS_NONE
 = -1,

867 
	mSNDRV_TIMER_CLASS_SLAVE
 = 0,

868 
	mSNDRV_TIMER_CLASS_GLOBAL
,

869 
	mSNDRV_TIMER_CLASS_CARD
,

870 
	mSNDRV_TIMER_CLASS_PCM
,

871 
	mSNDRV_TIMER_CLASS_LAST
 = 
SNDRV_TIMER_CLASS_PCM
,

876 
	mSNDRV_TIMER_SCLASS_NONE
 = 0,

877 
	mSNDRV_TIMER_SCLASS_APPLICATION
,

878 
	mSNDRV_TIMER_SCLASS_SEQUENCER
,

879 
	mSNDRV_TIMER_SCLASS_OSS_SEQUENCER
,

880 
	mSNDRV_TIMER_SCLASS_LAST
 = 
SNDRV_TIMER_SCLASS_OSS_SEQUENCER
,

884 
	#SNDRV_TIMER_GLOBAL_SYSTEM
 0

	)

885 
	#SNDRV_TIMER_GLOBAL_RTC
 1

	)

886 
	#SNDRV_TIMER_GLOBAL_HPET
 2

	)

887 
	#SNDRV_TIMER_GLOBAL_HRTIMER
 3

	)

890 
	#SNDRV_TIMER_FLG_SLAVE
 (1<<0è

	)

892 
	s¢d_tim”_id
 {

893 
	mdev_şass
;

894 
	mdev_sşass
;

895 
	mÿrd
;

896 
	mdeviû
;

897 
	msubdeviû
;

900 
	s¢d_tim”_gšfo
 {

901 
¢d_tim”_id
 
	mtid
;

902 
	mæags
;

903 
	mÿrd
;

904 
	mid
[64];

905 
	mÇme
[80];

906 
	m»£rved0
;

907 
	m»sŞutiÚ
;

908 
	m»sŞutiÚ_mš
;

909 
	m»sŞutiÚ_max
;

910 
	mş›Ás
;

911 
	m»£rved
[32];

914 
	s¢d_tim”_g·¿ms
 {

915 
¢d_tim”_id
 
	mtid
;

916 
	m³riod_num
;

917 
	m³riod_d’
;

918 
	m»£rved
[32];

921 
	s¢d_tim”_g¡©us
 {

922 
¢d_tim”_id
 
	mtid
;

923 
	m»sŞutiÚ
;

924 
	m»sŞutiÚ_num
;

925 
	m»sŞutiÚ_d’
;

926 
	m»£rved
[32];

929 
	s¢d_tim”_£Ëù
 {

930 
¢d_tim”_id
 
	mid
;

931 
	m»£rved
[32];

934 
	s¢d_tim”_šfo
 {

935 
	mæags
;

936 
	mÿrd
;

937 
	mid
[64];

938 
	mÇme
[80];

939 
	m»£rved0
;

940 
	m»sŞutiÚ
;

941 
	m»£rved
[64];

944 
	#SNDRV_TIMER_PSFLG_AUTO
 (1<<0è

	)

945 
	#SNDRV_TIMER_PSFLG_EXCLUSIVE
 (1<<1è

	)

946 
	#SNDRV_TIMER_PSFLG_EARLY_EVENT
 (1<<2è

	)

948 
	s¢d_tim”_·¿ms
 {

949 
	mæags
;

950 
	mticks
;

951 
	mqueue_size
;

952 
	m»£rved0
;

953 
	mf‹r
;

954 
	m»£rved
[60];

957 
	s¢d_tim”_¡©us
 {

958 
time¥ec
 
	mt¡amp
;

959 
	m»sŞutiÚ
;

960 
	mlo¡
;

961 
	mov”run
;

962 
	mqueue
;

963 
	m»£rved
[64];

966 
	#SNDRV_TIMER_IOCTL_PVERSION
 
	`_IOR
('T', 0x00, )

	)

967 
	#SNDRV_TIMER_IOCTL_NEXT_DEVICE
 
	`_IOWR
('T', 0x01, 
¢d_tim”_id
)

	)

968 
	#SNDRV_TIMER_IOCTL_TREAD_OLD
 
	`_IOW
('T', 0x02, )

	)

969 
	#SNDRV_TIMER_IOCTL_GINFO
 
	`_IOWR
('T', 0x03, 
¢d_tim”_gšfo
)

	)

970 
	#SNDRV_TIMER_IOCTL_GPARAMS
 
	`_IOW
('T', 0x04, 
¢d_tim”_g·¿ms
)

	)

971 
	#SNDRV_TIMER_IOCTL_GSTATUS
 
	`_IOWR
('T', 0x05, 
¢d_tim”_g¡©us
)

	)

972 
	#SNDRV_TIMER_IOCTL_SELECT
 
	`_IOW
('T', 0x10, 
¢d_tim”_£Ëù
)

	)

973 
	#SNDRV_TIMER_IOCTL_INFO
 
	`_IOR
('T', 0x11, 
¢d_tim”_šfo
)

	)

974 
	#SNDRV_TIMER_IOCTL_PARAMS
 
	`_IOW
('T', 0x12, 
¢d_tim”_·¿ms
)

	)

975 
	#SNDRV_TIMER_IOCTL_STATUS
 
	`_IOR
('T', 0x14, 
¢d_tim”_¡©us
)

	)

977 
	#SNDRV_TIMER_IOCTL_START
 
	`_IO
('T', 0xa0)

	)

978 
	#SNDRV_TIMER_IOCTL_STOP
 
	`_IO
('T', 0xa1)

	)

979 
	#SNDRV_TIMER_IOCTL_CONTINUE
 
	`_IO
('T', 0xa2)

	)

980 
	#SNDRV_TIMER_IOCTL_PAUSE
 
	`_IO
('T', 0xa3)

	)

981 
	#SNDRV_TIMER_IOCTL_TREAD64
 
	`_IOW
('T', 0xa4, )

	)

983 #ià
__BITS_PER_LONG
 == 64

984 
	#SNDRV_TIMER_IOCTL_TREAD
 
SNDRV_TIMER_IOCTL_TREAD_OLD


	)

986 
	#SNDRV_TIMER_IOCTL_TREAD
 (((
__k”Ãl_lÚg_t
è>ğ(
time_t
)) ? \

987 
SNDRV_TIMER_IOCTL_TREAD_OLD
 : \

988 
SNDRV_TIMER_IOCTL_TREAD64
)

	)

991 
	s¢d_tim”_»ad
 {

992 
	m»sŞutiÚ
;

993 
	mticks
;

997 
	mSNDRV_TIMER_EVENT_RESOLUTION
 = 0,

998 
	mSNDRV_TIMER_EVENT_TICK
,

999 
	mSNDRV_TIMER_EVENT_START
,

1000 
	mSNDRV_TIMER_EVENT_STOP
,

1001 
	mSNDRV_TIMER_EVENT_CONTINUE
,

1002 
	mSNDRV_TIMER_EVENT_PAUSE
,

1003 
	mSNDRV_TIMER_EVENT_EARLY
,

1004 
	mSNDRV_TIMER_EVENT_SUSPEND
,

1005 
	mSNDRV_TIMER_EVENT_RESUME
,

1007 
	mSNDRV_TIMER_EVENT_MSTART
 = 
SNDRV_TIMER_EVENT_START
 + 10,

1008 
	mSNDRV_TIMER_EVENT_MSTOP
 = 
SNDRV_TIMER_EVENT_STOP
 + 10,

1009 
	mSNDRV_TIMER_EVENT_MCONTINUE
 = 
SNDRV_TIMER_EVENT_CONTINUE
 + 10,

1010 
	mSNDRV_TIMER_EVENT_MPAUSE
 = 
SNDRV_TIMER_EVENT_PAUSE
 + 10,

1011 
	mSNDRV_TIMER_EVENT_MSUSPEND
 = 
SNDRV_TIMER_EVENT_SUSPEND
 + 10,

1012 
	mSNDRV_TIMER_EVENT_MRESUME
 = 
SNDRV_TIMER_EVENT_RESUME
 + 10,

1015 
	s¢d_tim”_Œ—d
 {

1016 
	mev’t
;

1017 
__time_·d
 
	m·d1
;

1018 
time¥ec
 
	mt¡amp
;

1019 
	mv®
;

1020 
__time_·d
 
	m·d2
;

1029 
	#SNDRV_CTL_VERSION
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 9)

	)

1031 
	s¢d_ùl_ÿrd_šfo
 {

1032 
	mÿrd
;

1033 
	m·d
;

1034 
	mid
[16];

1035 
	mdriv”
[16];

1036 
	mÇme
[32];

1037 
	mlÚgÇme
[80];

1038 
	m»£rved_
[16];

1039 
	mmix”Çme
[80];

1040 
	mcompÚ’ts
[128];

1043 
	t__b™wi£
 
	t¢d_ùl_–em_ty³_t
;

1044 
	#SNDRV_CTL_ELEM_TYPE_NONE
 ((
¢d_ùl_–em_ty³_t
è0è

	)

1045 
	#SNDRV_CTL_ELEM_TYPE_BOOLEAN
 ((
¢d_ùl_–em_ty³_t
è1è

	)

1046 
	#SNDRV_CTL_ELEM_TYPE_INTEGER
 ((
¢d_ùl_–em_ty³_t
è2è

	)

1047 
	#SNDRV_CTL_ELEM_TYPE_ENUMERATED
 ((
¢d_ùl_–em_ty³_t
è3è

	)

1048 
	#SNDRV_CTL_ELEM_TYPE_BYTES
 ((
¢d_ùl_–em_ty³_t
è4è

	)

1049 
	#SNDRV_CTL_ELEM_TYPE_IEC958
 ((
¢d_ùl_–em_ty³_t
è5è

	)

1050 
	#SNDRV_CTL_ELEM_TYPE_INTEGER64
 ((
¢d_ùl_–em_ty³_t
è6è

	)

1051 
	#SNDRV_CTL_ELEM_TYPE_LAST
 
SNDRV_CTL_ELEM_TYPE_INTEGER64


	)

1053 
	t__b™wi£
 
	t¢d_ùl_–em_içû_t
;

1054 
	#SNDRV_CTL_ELEM_IFACE_CARD
 ((
¢d_ùl_–em_içû_t
è0è

	)

1055 
	#SNDRV_CTL_ELEM_IFACE_HWDEP
 ((
¢d_ùl_–em_içû_t
è1è

	)

1056 
	#SNDRV_CTL_ELEM_IFACE_MIXER
 ((
¢d_ùl_–em_içû_t
è2è

	)

1057 
	#SNDRV_CTL_ELEM_IFACE_PCM
 ((
¢d_ùl_–em_içû_t
è3è

	)

1058 
	#SNDRV_CTL_ELEM_IFACE_RAWMIDI
 ((
¢d_ùl_–em_içû_t
è4è

	)

1059 
	#SNDRV_CTL_ELEM_IFACE_TIMER
 ((
¢d_ùl_–em_içû_t
è5è

	)

1060 
	#SNDRV_CTL_ELEM_IFACE_SEQUENCER
 ((
¢d_ùl_–em_içû_t
è6è

	)

1061 
	#SNDRV_CTL_ELEM_IFACE_LAST
 
SNDRV_CTL_ELEM_IFACE_SEQUENCER


	)

1063 
	#SNDRV_CTL_ELEM_ACCESS_READ
 (1<<0)

	)

1064 
	#SNDRV_CTL_ELEM_ACCESS_WRITE
 (1<<1)

	)

1065 
	#SNDRV_CTL_ELEM_ACCESS_READWRITE
 (
SNDRV_CTL_ELEM_ACCESS_READ
|
SNDRV_CTL_ELEM_ACCESS_WRITE
)

	)

1066 
	#SNDRV_CTL_ELEM_ACCESS_VOLATILE
 (1<<2è

	)

1068 
	#SNDRV_CTL_ELEM_ACCESS_TLV_READ
 (1<<4è

	)

1069 
	#SNDRV_CTL_ELEM_ACCESS_TLV_WRITE
 (1<<5è

	)

1070 
	#SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
 (
SNDRV_CTL_ELEM_ACCESS_TLV_READ
|
SNDRV_CTL_ELEM_ACCESS_TLV_WRITE
)

	)

1071 
	#SNDRV_CTL_ELEM_ACCESS_TLV_COMMAND
 (1<<6è

	)

1072 
	#SNDRV_CTL_ELEM_ACCESS_INACTIVE
 (1<<8è

	)

1073 
	#SNDRV_CTL_ELEM_ACCESS_LOCK
 (1<<9è

	)

1074 
	#SNDRV_CTL_ELEM_ACCESS_OWNER
 (1<<10è

	)

1075 
	#SNDRV_CTL_ELEM_ACCESS_TLV_CALLBACK
 (1<<28è

	)

1076 
	#SNDRV_CTL_ELEM_ACCESS_USER
 (1<<29è

	)

1080 
	#SNDRV_CTL_POWER_D0
 0x0000

	)

1081 
	#SNDRV_CTL_POWER_D1
 0x0100

	)

1082 
	#SNDRV_CTL_POWER_D2
 0x0200

	)

1083 
	#SNDRV_CTL_POWER_D3
 0x0300

	)

1084 
	#SNDRV_CTL_POWER_D3hÙ
 (
SNDRV_CTL_POWER_D3
|0x0000è

	)

1085 
	#SNDRV_CTL_POWER_D3cŞd
 (
SNDRV_CTL_POWER_D3
|0x0001è

	)

1087 
	#SNDRV_CTL_ELEM_ID_NAME_MAXLEN
 44

	)

1089 
	s¢d_ùl_–em_id
 {

1090 
	mnumid
;

1091 
¢d_ùl_–em_içû_t
 
	miçû
;

1092 
	mdeviû
;

1093 
	msubdeviû
;

1094 
	mÇme
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

1095 
	mšdex
;

1098 
	s¢d_ùl_–em_li¡
 {

1099 
	moff£t
;

1100 
	m¥aû
;

1101 
	mu£d
;

1102 
	mcouÁ
;

1103 
¢d_ùl_–em_id
 *
	mpids
;

1104 
	m»£rved
[50];

1107 
	s¢d_ùl_–em_šfo
 {

1108 
¢d_ùl_–em_id
 
	mid
;

1109 
¢d_ùl_–em_ty³_t
 
	mty³
;

1110 
	macûss
;

1111 
	mcouÁ
;

1112 
__k”Ãl_pid_t
 
	mowÃr
;

1115 
	mmš
;

1116 
	mmax
;

1117 
	m¡•
;

1118 } 
	mš‹g”
;

1120 
	mmš
;

1121 
	mmax
;

1122 
	m¡•
;

1123 } 
	mš‹g”64
;

1125 
	m™ems
;

1126 
	m™em
;

1127 
	mÇme
[64];

1128 
__u64
 
	mÇmes_±r
;

1129 
	mÇmes_Ëngth
;

1130 } 
	m’um”©ed
;

1131 
	m»£rved
[128];

1132 } 
	mv®ue
;

1133 
	m»£rved
[64];

1136 
	s¢d_ùl_–em_v®ue
 {

1137 
¢d_ùl_–em_id
 
	mid
;

1138 
	mšdœeù
: 1;

1141 
	mv®ue
[128];

1142 *
	mv®ue_±r
;

1143 } 
	mš‹g”
;

1145 
	mv®ue
[64];

1146 *
	mv®ue_±r
;

1147 } 
	mš‹g”64
;

1149 
	m™em
[128];

1150 *
	m™em_±r
;

1151 } 
	m’um”©ed
;

1153 
	md©a
[512];

1154 *
	md©a_±r
;

1155 } 
	mby‹s
;

1156 
¢d_«s_›c958
 
	m›c958
;

1157 } 
	mv®ue
;

1158 
	m»£rved
[128];

1161 
	s¢d_ùl_v
 {

1162 
	mnumid
;

1163 
	mËngth
;

1164 
	mv
[0];

1167 
	#SNDRV_CTL_IOCTL_PVERSION
 
	`_IOR
('U', 0x00, )

	)

1168 
	#SNDRV_CTL_IOCTL_CARD_INFO
 
	`_IOR
('U', 0x01, 
¢d_ùl_ÿrd_šfo
)

	)

1169 
	#SNDRV_CTL_IOCTL_ELEM_LIST
 
	`_IOWR
('U', 0x10, 
¢d_ùl_–em_li¡
)

	)

1170 
	#SNDRV_CTL_IOCTL_ELEM_INFO
 
	`_IOWR
('U', 0x11, 
¢d_ùl_–em_šfo
)

	)

1171 
	#SNDRV_CTL_IOCTL_ELEM_READ
 
	`_IOWR
('U', 0x12, 
¢d_ùl_–em_v®ue
)

	)

1172 
	#SNDRV_CTL_IOCTL_ELEM_WRITE
 
	`_IOWR
('U', 0x13, 
¢d_ùl_–em_v®ue
)

	)

1173 
	#SNDRV_CTL_IOCTL_ELEM_LOCK
 
	`_IOW
('U', 0x14, 
¢d_ùl_–em_id
)

	)

1174 
	#SNDRV_CTL_IOCTL_ELEM_UNLOCK
 
	`_IOW
('U', 0x15, 
¢d_ùl_–em_id
)

	)

1175 
	#SNDRV_CTL_IOCTL_SUBSCRIBE_EVENTS
 
	`_IOWR
('U', 0x16, )

	)

1176 
	#SNDRV_CTL_IOCTL_ELEM_ADD
 
	`_IOWR
('U', 0x17, 
¢d_ùl_–em_šfo
)

	)

1177 
	#SNDRV_CTL_IOCTL_ELEM_REPLACE
 
	`_IOWR
('U', 0x18, 
¢d_ùl_–em_šfo
)

	)

1178 
	#SNDRV_CTL_IOCTL_ELEM_REMOVE
 
	`_IOWR
('U', 0x19, 
¢d_ùl_–em_id
)

	)

1179 
	#SNDRV_CTL_IOCTL_TLV_READ
 
	`_IOWR
('U', 0x1a, 
¢d_ùl_v
)

	)

1180 
	#SNDRV_CTL_IOCTL_TLV_WRITE
 
	`_IOWR
('U', 0x1b, 
¢d_ùl_v
)

	)

1181 
	#SNDRV_CTL_IOCTL_TLV_COMMAND
 
	`_IOWR
('U', 0x1c, 
¢d_ùl_v
)

	)

1182 
	#SNDRV_CTL_IOCTL_HWDEP_NEXT_DEVICE
 
	`_IOWR
('U', 0x20, )

	)

1183 
	#SNDRV_CTL_IOCTL_HWDEP_INFO
 
	`_IOR
('U', 0x21, 
¢d_hwd•_šfo
)

	)

1184 
	#SNDRV_CTL_IOCTL_PCM_NEXT_DEVICE
 
	`_IOR
('U', 0x30, )

	)

1185 
	#SNDRV_CTL_IOCTL_PCM_INFO
 
	`_IOWR
('U', 0x31, 
¢d_pcm_šfo
)

	)

1186 
	#SNDRV_CTL_IOCTL_PCM_PREFER_SUBDEVICE
 
	`_IOW
('U', 0x32, )

	)

1187 
	#SNDRV_CTL_IOCTL_RAWMIDI_NEXT_DEVICE
 
	`_IOWR
('U', 0x40, )

	)

1188 
	#SNDRV_CTL_IOCTL_RAWMIDI_INFO
 
	`_IOWR
('U', 0x41, 
¢d_¿wmidi_šfo
)

	)

1189 
	#SNDRV_CTL_IOCTL_RAWMIDI_PREFER_SUBDEVICE
 
	`_IOW
('U', 0x42, )

	)

1190 
	#SNDRV_CTL_IOCTL_UMP_NEXT_DEVICE
 
	`_IOWR
('U', 0x43, )

	)

1191 
	#SNDRV_CTL_IOCTL_UMP_ENDPOINT_INFO
 
	`_IOWR
('U', 0x44, 
¢d_ump_’dpošt_šfo
)

	)

1192 
	#SNDRV_CTL_IOCTL_UMP_BLOCK_INFO
 
	`_IOWR
('U', 0x45, 
¢d_ump_block_šfo
)

	)

1193 
	#SNDRV_CTL_IOCTL_POWER
 
	`_IOWR
('U', 0xd0, )

	)

1194 
	#SNDRV_CTL_IOCTL_POWER_STATE
 
	`_IOR
('U', 0xd1, )

	)

1200 
	e¢drv_ùl_ev’t_ty³
 {

1201 
	mSNDRV_CTL_EVENT_ELEM
 = 0,

1202 
	mSNDRV_CTL_EVENT_LAST
 = 
SNDRV_CTL_EVENT_ELEM
,

1205 
	#SNDRV_CTL_EVENT_MASK_VALUE
 (1<<0è

	)

1206 
	#SNDRV_CTL_EVENT_MASK_INFO
 (1<<1è

	)

1207 
	#SNDRV_CTL_EVENT_MASK_ADD
 (1<<2è

	)

1208 
	#SNDRV_CTL_EVENT_MASK_TLV
 (1<<3è

	)

1209 
	#SNDRV_CTL_EVENT_MASK_REMOVE
 (~0Uè

	)

1211 
	s¢d_ùl_ev’t
 {

1212 
	mty³
;

1215 
	mmask
;

1216 
¢d_ùl_–em_id
 
	mid
;

1217 } 
	m–em
;

1218 
	md©a8
[60];

1219 } 
	md©a
;

1226 
	#SNDRV_CTL_NAME_NONE
 ""

	)

1227 
	#SNDRV_CTL_NAME_PLAYBACK
 "PÏyback "

	)

1228 
	#SNDRV_CTL_NAME_CAPTURE
 "C­tu» "

	)

1230 
	#SNDRV_CTL_NAME_IEC958_NONE
 ""

	)

1231 
	#SNDRV_CTL_NAME_IEC958_SWITCH
 "Sw™ch"

	)

1232 
	#SNDRV_CTL_NAME_IEC958_VOLUME
 "VŞume"

	)

1233 
	#SNDRV_CTL_NAME_IEC958_DEFAULT
 "DeçuÉ"

	)

1234 
	#SNDRV_CTL_NAME_IEC958_MASK
 "Mask"

	)

1235 
	#SNDRV_CTL_NAME_IEC958_CON_MASK
 "CÚ Mask"

	)

1236 
	#SNDRV_CTL_NAME_IEC958_PRO_MASK
 "PrØMask"

	)

1237 
	#SNDRV_CTL_NAME_IEC958_PCM_STREAM
 "PCM SŒ—m"

	)

1238 
	#SNDRV_CTL_NAME_IEC958
(
ex¶
,
dœeùiÚ
,
wh©
è"IEC958 "ƒx¶ 
SNDRV_CTL_NAME_
##dœeùiÚ 
SNDRV_CTL_NAME_IEC958_
##
	)
what

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asound_fm.h

2 #iâdeà
__SOUND_ASOUND_FM_H


3 
	#__SOUND_ASOUND_FM_H


	)

30 
	#SNDRV_DM_FM_MODE_OPL2
 0x00

	)

31 
	#SNDRV_DM_FM_MODE_OPL3
 0x01

	)

33 
	s¢d_dm_fm_šfo
 {

34 
	mfm_mode
;

35 
	mrhythm
;

42 
	s¢d_dm_fm_voiû
 {

43 
	mİ
;

44 
	mvoiû
;

46 
	mam
;

47 
	mvib¿to
;

48 
	mdo_su¡aš
;

49 
	mkbd_sÿË
;

50 
	mh¬mÚic
;

51 
	msÿË_Ëv–
;

52 
	mvŞume
;

54 
	m©ck
;

55 
	mdeÿy
;

56 
	msu¡aš
;

57 
	m»Ëa£
;

59 
	mãedback
;

60 
	mcÚÃùiÚ
;

61 
	mËá
;

62 
	mright
;

63 
	mwavefÜm
;

71 
	s¢d_dm_fm_nÙe
 {

72 
	mvoiû
;

73 
	moùave
;

74 
	mâum
;

75 
	mkey_Ú
;

82 
	s¢d_dm_fm_·¿ms
 {

83 
	mam_d•th
;

84 
	mvib_d•th
;

85 
	mkbd_¥l™
;

86 
	mrhythm
;

89 
	mbass
;

90 
	m¢¬e
;

91 
	mtomtom
;

92 
	mcymb®
;

93 
	mhih©
;

100 
	#SNDRV_DM_FM_IOCTL_INFO
 
	`_IOR
('H', 0x20, 
¢d_dm_fm_šfo
)

	)

101 
	#SNDRV_DM_FM_IOCTL_RESET
 
	`_IO
 ('H', 0x21)

	)

102 
	#SNDRV_DM_FM_IOCTL_PLAY_NOTE
 
	`_IOW
('H', 0x22, 
¢d_dm_fm_nÙe
)

	)

103 
	#SNDRV_DM_FM_IOCTL_SET_VOICE
 
	`_IOW
('H', 0x23, 
¢d_dm_fm_voiû
)

	)

104 
	#SNDRV_DM_FM_IOCTL_SET_PARAMS
 
	`_IOW
('H', 0x24, 
¢d_dm_fm_·¿ms
)

	)

105 
	#SNDRV_DM_FM_IOCTL_SET_MODE
 
	`_IOW
('H', 0x25, )

	)

107 
	#SNDRV_DM_FM_IOCTL_SET_CONNECTION
 
	`_IOW
('H', 0x26, )

	)

109 
	#SNDRV_DM_FM_IOCTL_CLEAR_PATCHES
 
	`_IO
 ('H', 0x40)

	)

111 
	#SNDRV_DM_FM_OSS_IOCTL_RESET
 0x20

	)

112 
	#SNDRV_DM_FM_OSS_IOCTL_PLAY_NOTE
 0x21

	)

113 
	#SNDRV_DM_FM_OSS_IOCTL_SET_VOICE
 0x22

	)

114 
	#SNDRV_DM_FM_OSS_IOCTL_SET_PARAMS
 0x23

	)

115 
	#SNDRV_DM_FM_OSS_IOCTL_SET_MODE
 0x24

	)

116 
	#SNDRV_DM_FM_OSS_IOCTL_SET_OPL
 0x25

	)

122 
	#FM_KEY_SBI
 "SBI\032"

	)

123 
	#FM_KEY_2OP
 "2OP\032"

	)

124 
	#FM_KEY_4OP
 "4OP\032"

	)

126 
	ssbi_·tch
 {

127 
	m´og
;

128 
	mbªk
;

129 
	mkey
[4];

130 
	mÇme
[25];

131 
	mex‹nsiÚ
[7];

132 
	md©a
[32];

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/emu10k1.h

23 #iâdeà
__SOUND_EMU10K1_H


24 
	#__SOUND_EMU10K1_H


	)

26 #ifdeà
__lšux__


27 
	~<lšux/ty³s.h
>

34 
	#EMU10K1_CARD_CREATIVE
 0x00000000

	)

35 
	#EMU10K1_CARD_EMUAPS
 0x00000001

	)

37 
	#EMU10K1_FX8010_PCM_COUNT
 8

	)

44 
	#__EMU10K1_DECLARE_BITMAP
(
Çme
,
b™s
) \

45 
Çme
[(
b™s
è/ ((è* 8)]

	)

48 
	#iMAC0
 0x00

	)

49 
	#iMAC1
 0x01

	)

50 
	#iMAC2
 0x02

	)

51 
	#iMAC3
 0x03

	)

52 
	#iMACINT0
 0x04

	)

53 
	#iMACINT1
 0x05

	)

54 
	#iACC3
 0x06

	)

55 
	#iMACMV
 0x07

	)

56 
	#iANDXOR
 0x08

	)

57 
	#iTSTNEG
 0x09

	)

58 
	#iLIMITGE
 0x0¨

	)

59 
	#iLIMITLT
 0x0b

	)

60 
	#iLOG
 0x0ø

	)

61 
	#iEXP
 0x0d

	)

62 
	#iINTERP
 0x0

	)

63 
	#iSKIP
 0x0à

	)

66 
	#FXBUS
(
x
è(0x00 + (x)è

	)

67 
	#EXTIN
(
x
è(0x10 + (x)è

	)

68 
	#EXTOUT
(
x
è(0x20 + (x)è

	)

69 
	#FXBUS2
(
x
è(0x30 + (x)è

	)

72 
	#C_00000000
 0x40

	)

73 
	#C_00000001
 0x41

	)

74 
	#C_00000002
 0x42

	)

75 
	#C_00000003
 0x43

	)

76 
	#C_00000004
 0x44

	)

77 
	#C_00000008
 0x45

	)

78 
	#C_00000010
 0x46

	)

79 
	#C_00000020
 0x47

	)

80 
	#C_00000100
 0x48

	)

81 
	#C_00010000
 0x49

	)

82 
	#C_00080000
 0x4a

	)

83 
	#C_10000000
 0x4b

	)

84 
	#C_20000000
 0x4c

	)

85 
	#C_40000000
 0x4d

	)

86 
	#C_80000000
 0x4e

	)

87 
	#C_7fffffff
 0x4f

	)

88 
	#C_ffffffff
 0x50

	)

89 
	#C_ffffffã
 0x51

	)

90 
	#C_c0000000
 0x52

	)

91 
	#C_4f1bbcdc
 0x53

	)

92 
	#C_5a7ef9db
 0x54

	)

93 
	#C_00100000
 0x55

	)

94 
	#GPR_ACCU
 0x56

	)

95 
	#GPR_COND
 0x57

	)

96 
	#GPR_NOISE0
 0x58

	)

97 
	#GPR_NOISE1
 0x59

	)

98 
	#GPR_IRQ
 0x5¨

	)

99 
	#GPR_DBAC
 0x5b

	)

100 
	#GPR
(
x
è(
FXGPREGBASE
 + (x)è

	)

101 
	#ITRAM_DATA
(
x
è(
TANKMEMDATAREGBASE
 + 0x00 + (x)è

	)

102 
	#ETRAM_DATA
(
x
è(
TANKMEMDATAREGBASE
 + 0x80 + (x)è

	)

103 
	#ITRAM_ADDR
(
x
è(
TANKMEMADDRREGBASE
 + 0x00 + (x)è

	)

104 
	#ETRAM_ADDR
(
x
è(
TANKMEMADDRREGBASE
 + 0x80 + (x)è

	)

106 
	#A_ITRAM_DATA
(
x
è(
TANKMEMDATAREGBASE
 + 0x00 + (x)è

	)

107 
	#A_ETRAM_DATA
(
x
è(
TANKMEMDATAREGBASE
 + 0xc0 + (x)è

	)

108 
	#A_ITRAM_ADDR
(
x
è(
TANKMEMADDRREGBASE
 + 0x00 + (x)è

	)

109 
	#A_ETRAM_ADDR
(
x
è(
TANKMEMADDRREGBASE
 + 0xc0 + (x)è

	)

110 
	#A_ITRAM_CTL
(
x
è(
A_TANKMEMCTLREGBASE
 + 0x00 + (x)è

	)

111 
	#A_ETRAM_CTL
(
x
è(
A_TANKMEMCTLREGBASE
 + 0xc0 + (x)è

	)

113 
	#A_FXBUS
(
x
è(0x00 + (x)è

	)

114 
	#A_EXTIN
(
x
è(0x40 + (x)è

	)

115 
	#A_P16VIN
(
x
è(0x50 + (x)è

	)

116 
	#A_EXTOUT
(
x
è(0x60 + (x)è

	)

117 
	#A_FXBUS2
(
x
è(0x80 + (x)è

	)

118 
	#A_EMU32OUTH
(
x
è(0xa0 + (x)è

	)

119 
	#A_EMU32OUTL
(
x
è(0xb0 + (x)è

	)

120 
	#A3_EMU32IN
(
x
è(0x160 + (x)è

	)

121 
	#A3_EMU32OUT
(
x
è(0x1E0 + (x)è

	)

122 
	#A_GPR
(
x
è(
A_FXGPREGBASE
 + (x))

	)

125 
	#CC_REG_NORMALIZED
 
C_00000001


	)

126 
	#CC_REG_BORROW
 
C_00000002


	)

127 
	#CC_REG_MINUS
 
C_00000004


	)

128 
	#CC_REG_ZERO
 
C_00000008


	)

129 
	#CC_REG_SATURATE
 
C_00000010


	)

130 
	#CC_REG_NONZERO
 
C_00000100


	)

133 
	#FXBUS_PCM_LEFT
 0x00

	)

134 
	#FXBUS_PCM_RIGHT
 0x01

	)

135 
	#FXBUS_PCM_LEFT_REAR
 0x02

	)

136 
	#FXBUS_PCM_RIGHT_REAR
 0x03

	)

137 
	#FXBUS_MIDI_LEFT
 0x04

	)

138 
	#FXBUS_MIDI_RIGHT
 0x05

	)

139 
	#FXBUS_PCM_CENTER
 0x06

	)

140 
	#FXBUS_PCM_LFE
 0x07

	)

141 
	#FXBUS_PCM_LEFT_FRONT
 0x08

	)

142 
	#FXBUS_PCM_RIGHT_FRONT
 0x09

	)

143 
	#FXBUS_MIDI_REVERB
 0x0c

	)

144 
	#FXBUS_MIDI_CHORUS
 0x0d

	)

145 
	#FXBUS_PCM_LEFT_SIDE
 0x0e

	)

146 
	#FXBUS_PCM_RIGHT_SIDE
 0x0f

	)

147 
	#FXBUS_PT_LEFT
 0x14

	)

148 
	#FXBUS_PT_RIGHT
 0x15

	)

151 
	#EXTIN_AC97_L
 0x00

	)

152 
	#EXTIN_AC97_R
 0x01

	)

153 
	#EXTIN_SPDIF_CD_L
 0x02

	)

154 
	#EXTIN_SPDIF_CD_R
 0x03

	)

155 
	#EXTIN_ZOOM_L
 0x04

	)

156 
	#EXTIN_ZOOM_R
 0x05

	)

157 
	#EXTIN_TOSLINK_L
 0x06

	)

158 
	#EXTIN_TOSLINK_R
 0x07

	)

159 
	#EXTIN_LINE1_L
 0x08

	)

160 
	#EXTIN_LINE1_R
 0x09

	)

161 
	#EXTIN_COAX_SPDIF_L
 0x0¨

	)

162 
	#EXTIN_COAX_SPDIF_R
 0x0b

	)

163 
	#EXTIN_LINE2_L
 0x0ø

	)

164 
	#EXTIN_LINE2_R
 0x0d

	)

167 
	#EXTOUT_AC97_L
 0x00

	)

168 
	#EXTOUT_AC97_R
 0x01

	)

169 
	#EXTOUT_TOSLINK_L
 0x02

	)

170 
	#EXTOUT_TOSLINK_R
 0x03

	)

171 
	#EXTOUT_AC97_CENTER
 0x04

	)

172 
	#EXTOUT_AC97_LFE
 0x05

	)

173 
	#EXTOUT_HEADPHONE_L
 0x06

	)

174 
	#EXTOUT_HEADPHONE_R
 0x07

	)

175 
	#EXTOUT_REAR_L
 0x08

	)

176 
	#EXTOUT_REAR_R
 0x09

	)

177 
	#EXTOUT_ADC_CAP_L
 0x0¨

	)

178 
	#EXTOUT_ADC_CAP_R
 0x0b

	)

179 
	#EXTOUT_MIC_CAP
 0x0ø

	)

180 
	#EXTOUT_AC97_REAR_L
 0x0d

	)

181 
	#EXTOUT_AC97_REAR_R
 0x0

	)

182 
	#EXTOUT_ACENTER
 0x11

	)

183 
	#EXTOUT_ALFE
 0x12

	)

186 
	#A_EXTIN_AC97_L
 0x00

	)

187 
	#A_EXTIN_AC97_R
 0x01

	)

188 
	#A_EXTIN_SPDIF_CD_L
 0x02

	)

189 
	#A_EXTIN_SPDIF_CD_R
 0x03

	)

190 
	#A_EXTIN_OPT_SPDIF_L
 0x04

	)

191 
	#A_EXTIN_OPT_SPDIF_R
 0x05

	)

192 
	#A_EXTIN_LINE2_L
 0x08

	)

193 
	#A_EXTIN_LINE2_R
 0x09

	)

194 
	#A_EXTIN_ADC_L
 0x0¨

	)

195 
	#A_EXTIN_ADC_R
 0x0b

	)

196 
	#A_EXTIN_AUX2_L
 0x0ø

	)

197 
	#A_EXTIN_AUX2_R
 0x0d

	)

200 
	#A_EXTOUT_FRONT_L
 0x00

	)

201 
	#A_EXTOUT_FRONT_R
 0x01

	)

202 
	#A_EXTOUT_CENTER
 0x02

	)

203 
	#A_EXTOUT_LFE
 0x03

	)

204 
	#A_EXTOUT_HEADPHONE_L
 0x04

	)

205 
	#A_EXTOUT_HEADPHONE_R
 0x05

	)

206 
	#A_EXTOUT_REAR_L
 0x06

	)

207 
	#A_EXTOUT_REAR_R
 0x07

	)

208 
	#A_EXTOUT_AFRONT_L
 0x08

	)

209 
	#A_EXTOUT_AFRONT_R
 0x09

	)

210 
	#A_EXTOUT_ACENTER
 0x0¨

	)

211 
	#A_EXTOUT_ALFE
 0x0b

	)

212 
	#A_EXTOUT_ASIDE_L
 0x0ø

	)

213 
	#A_EXTOUT_ASIDE_R
 0x0d

	)

214 
	#A_EXTOUT_AREAR_L
 0x0

	)

215 
	#A_EXTOUT_AREAR_R
 0x0à

	)

216 
	#A_EXTOUT_AC97_L
 0x10

	)

217 
	#A_EXTOUT_AC97_R
 0x11

	)

218 
	#A_EXTOUT_ADC_CAP_L
 0x16

	)

219 
	#A_EXTOUT_ADC_CAP_R
 0x17

	)

220 
	#A_EXTOUT_MIC_CAP
 0x18

	)

223 
	#A_C_00000000
 0xc0

	)

224 
	#A_C_00000001
 0xc1

	)

225 
	#A_C_00000002
 0xc2

	)

226 
	#A_C_00000003
 0xc3

	)

227 
	#A_C_00000004
 0xc4

	)

228 
	#A_C_00000008
 0xc5

	)

229 
	#A_C_00000010
 0xc6

	)

230 
	#A_C_00000020
 0xc7

	)

231 
	#A_C_00000100
 0xc8

	)

232 
	#A_C_00010000
 0xc9

	)

233 
	#A_C_00000800
 0xÿ

	)

234 
	#A_C_10000000
 0xcb

	)

235 
	#A_C_20000000
 0xcc

	)

236 
	#A_C_40000000
 0xcd

	)

237 
	#A_C_80000000
 0xû

	)

238 
	#A_C_7fffffff
 0xcf

	)

239 
	#A_C_ffffffff
 0xd0

	)

240 
	#A_C_ffffffã
 0xd1

	)

241 
	#A_C_c0000000
 0xd2

	)

242 
	#A_C_4f1bbcdc
 0xd3

	)

243 
	#A_C_5a7ef9db
 0xd4

	)

244 
	#A_C_00100000
 0xd5

	)

245 
	#A_GPR_ACCU
 0xd6

	)

246 
	#A_GPR_COND
 0xd7

	)

247 
	#A_GPR_NOISE0
 0xd8

	)

248 
	#A_GPR_NOISE1
 0xd9

	)

249 
	#A_GPR_IRQ
 0xd¨

	)

250 
	#A_GPR_DBAC
 0xdb

	)

251 
	#A_GPR_DBACE
 0xd

	)

254 
	#EMU10K1_DBG_ZC
 0x80000000

	)

255 
	#EMU10K1_DBG_SATURATION_OCCURED
 0x02000000

	)

256 
	#EMU10K1_DBG_SATURATION_ADDR
 0x01ff0000

	)

257 
	#EMU10K1_DBG_SINGLE_STEP
 0x00008000

	)

258 
	#EMU10K1_DBG_STEP
 0x00004000

	)

259 
	#EMU10K1_DBG_CONDITION_CODE
 0x00003e00

	)

260 
	#EMU10K1_DBG_SINGLE_STEP_ADDR
 0x000001fà

	)

263 
	#TANKMEMADDRREG_ADDR_MASK
 0x000ffffà

	)

264 
	#TANKMEMADDRREG_CLEAR
 0x00800000

	)

265 
	#TANKMEMADDRREG_ALIGN
 0x00400000

	)

266 
	#TANKMEMADDRREG_WRITE
 0x00200000

	)

267 
	#TANKMEMADDRREG_READ
 0x00100000

	)

269 
	s¢d_emu10k1_fx8010_šfo
 {

270 
	mš‹º®_Œam_size
;

271 
	mex‹º®_Œam_size
;

272 
	mfxbus_Çmes
[16][32];

273 
	mextš_Çmes
[16][32];

274 
	mextout_Çmes
[32][32];

275 
	mg´_cÚŒŞs
;

278 
	#EMU10K1_GPR_TRANSLATION_NONE
 0

	)

279 
	#EMU10K1_GPR_TRANSLATION_TABLE100
 1

	)

280 
	#EMU10K1_GPR_TRANSLATION_BASS
 2

	)

281 
	#EMU10K1_GPR_TRANSLATION_TREBLE
 3

	)

282 
	#EMU10K1_GPR_TRANSLATION_ONOFF
 4

	)

284 
	eemu10k1_ùl_–em_içû
 {

285 
	mEMU10K1_CTL_ELEM_IFACE_MIXER
 = 2,

286 
	mEMU10K1_CTL_ELEM_IFACE_PCM
 = 3,

289 
	semu10k1_ùl_–em_id
 {

290 
	m·d
;

291 
	miçû
;

292 
	mdeviû
;

293 
	msubdeviû
;

294 
	mÇme
[44];

295 
	mšdex
;

298 
	s¢d_emu10k1_fx8010_cÚŒŞ_g´
 {

299 
emu10k1_ùl_–em_id
 
	mid
;

300 
	mvcouÁ
;

301 
	mcouÁ
;

302 
	mg´
[32];

303 
	mv®ue
[32];

304 
	mmš
;

305 
	mmax
;

306 
	mŒª¦©iÚ
;

307 cÚ¡ *
	mv
;

311 
	s¢d_emu10k1_fx8010_cÚŒŞ_Şd_g´
 {

312 
emu10k1_ùl_–em_id
 
	mid
;

313 
	mvcouÁ
;

314 
	mcouÁ
;

315 
	mg´
[32];

316 
	mv®ue
[32];

317 
	mmš
;

318 
	mmax
;

319 
	mŒª¦©iÚ
;

322 
	s¢d_emu10k1_fx8010_code
 {

323 
	mÇme
[128];

325 
__EMU10K1_DECLARE_BITMAP
(
g´_v®id
, 0x200);

326 
__u32
 *
	mg´_m­
;

328 
	mg´_add_cÚŒŞ_couÁ
;

329 
¢d_emu10k1_fx8010_cÚŒŞ_g´
 *
	mg´_add_cÚŒŞs
;

331 
	mg´_d–_cÚŒŞ_couÁ
;

332 
emu10k1_ùl_–em_id
 *
	mg´_d–_cÚŒŞs
;

334 
	mg´_li¡_cÚŒŞ_couÁ
;

335 
	mg´_li¡_cÚŒŞ_tÙ®
;

336 
¢d_emu10k1_fx8010_cÚŒŞ_g´
 *
	mg´_li¡_cÚŒŞs
;

338 
__EMU10K1_DECLARE_BITMAP
(
Œam_v®id
, 0x100);

339 
__u32
 *
	mŒam_d©a_m­
;

340 
__u32
 *
	mŒam_addr_m­
;

342 
__EMU10K1_DECLARE_BITMAP
(
code_v®id
, 1024);

343 
__u32
 *
	mcode
;

346 
	s¢d_emu10k1_fx8010_Œam
 {

347 
	madd»ss
;

348 
	msize
;

349 *
	m§m¶es
;

353 
	s¢d_emu10k1_fx8010_pcm_»c
 {

354 
	msub¡»am
;

355 
	m»s1
;

356 
	mchªÃls
;

357 
	mŒam_¡¬t
;

358 
	mbufãr_size
;

359 
	mg´_size
;

360 
	mg´_±r
;

361 
	mg´_couÁ
;

362 
	mg´_tmpcouÁ
;

363 
	mg´_Œigg”
;

364 
	mg´_ruÂšg
;

365 
	m·d
;

366 
	m‘¿m
[32];

367 
	m»s2
;

370 
	#SNDRV_EMU10K1_VERSION
 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 1)

	)

372 
	#SNDRV_EMU10K1_IOCTL_INFO
 
	`_IOR
 ('H', 0x10, 
¢d_emu10k1_fx8010_šfo
)

	)

373 
	#SNDRV_EMU10K1_IOCTL_CODE_POKE
 
	`_IOW
 ('H', 0x11, 
¢d_emu10k1_fx8010_code
)

	)

374 
	#SNDRV_EMU10K1_IOCTL_CODE_PEEK
 
	`_IOWR
('H', 0x12, 
¢d_emu10k1_fx8010_code
)

	)

375 
	#SNDRV_EMU10K1_IOCTL_TRAM_SETUP
 
	`_IOW
 ('H', 0x20, )

	)

376 
	#SNDRV_EMU10K1_IOCTL_TRAM_POKE
 
	`_IOW
 ('H', 0x21, 
¢d_emu10k1_fx8010_Œam
)

	)

377 
	#SNDRV_EMU10K1_IOCTL_TRAM_PEEK
 
	`_IOWR
('H', 0x22, 
¢d_emu10k1_fx8010_Œam
)

	)

378 
	#SNDRV_EMU10K1_IOCTL_PCM_POKE
 
	`_IOW
 ('H', 0x30, 
¢d_emu10k1_fx8010_pcm_»c
)

	)

379 
	#SNDRV_EMU10K1_IOCTL_PCM_PEEK
 
	`_IOWR
('H', 0x31, 
¢d_emu10k1_fx8010_pcm_»c
)

	)

380 
	#SNDRV_EMU10K1_IOCTL_PVERSION
 
	`_IOR
 ('H', 0x40, )

	)

381 
	#SNDRV_EMU10K1_IOCTL_STOP
 
	`_IO
 ('H', 0x80)

	)

382 
	#SNDRV_EMU10K1_IOCTL_CONTINUE
 
	`_IO
 ('H', 0x81)

	)

383 
	#SNDRV_EMU10K1_IOCTL_ZERO_TRAM_COUNTER
 
	`_IO
 ('H', 0x82)

	)

384 
	#SNDRV_EMU10K1_IOCTL_SINGLE_STEP
 
	`_IOW
 ('H', 0x83, )

	)

385 
	#SNDRV_EMU10K1_IOCTL_DBG_READ
 
	`_IOR
 ('H', 0x84, )

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/hdsp.h

2 #iâdeà
__SOUND_HDSP_H


3 
	#__SOUND_HDSP_H


	)

23 #ifdeà
__lšux__


24 
	~<lšux/ty³s.h
>

27 
	#HDSP_MATRIX_MIXER_SIZE
 2048

	)

29 
	eHDSP_IO_Ty³
 {

30 
	mDigiçû
,

31 
	mMuÉiçû
,

32 
	mH9652
,

33 
	mH9632
,

34 
	mRPM
,

35 
	mUndefšed
,

38 
	shd¥_³ak_rms
 {

39 
__u32
 
	mšput_³aks
[26];

40 
__u32
 
	m¶ayback_³aks
[26];

41 
__u32
 
	mouut_³aks
[28];

42 
__u64
 
	mšput_rms
[26];

43 
__u64
 
	m¶ayback_rms
[26];

45 
__u64
 
	mouut_rms
[26];

48 
	#SNDRV_HDSP_IOCTL_GET_PEAK_RMS
 
	`_IOR
('H', 0x40, 
hd¥_³ak_rms
)

	)

50 
	shd¥_cÚfig_šfo
 {

51 
	m´ef_sync_»f
;

52 
	mwÜdşock_sync_check
;

53 
	m¥dif_sync_check
;

54 
	mad©sync_sync_check
;

55 
	mad©_sync_check
[3];

56 
	m¥dif_š
;

57 
	m¥dif_out
;

58 
	m¥dif_´oãssiÚ®
;

59 
	m¥dif_emphasis
;

60 
	m¥dif_nÚaudio
;

61 
	m¥dif_§m¶e_¿‹
;

62 
	msy¡em_§m¶e_¿‹
;

63 
	mautosync_§m¶e_¿‹
;

64 
	msy¡em_şock_mode
;

65 
	mşock_sourû
;

66 
	mautosync_»f
;

67 
	mlše_out
;

68 
	m·s¡hru
;

69 
	mda_gaš
;

70 
	mad_gaš
;

71 
	mphÚe_gaš
;

72 
	mxÌ_b»akout_ÿbË
;

73 
	mª®og_ex‹nsiÚ_bßrd
;

76 
	#SNDRV_HDSP_IOCTL_GET_CONFIG_INFO
 
	`_IOR
('H', 0x41, 
hd¥_cÚfig_šfo
)

	)

78 
	shd¥_fœmw¬e
 {

79 *
	mfœmw¬e_d©a
;

82 
	#SNDRV_HDSP_IOCTL_UPLOAD_FIRMWARE
 
	`_IOW
('H', 0x42, 
hd¥_fœmw¬e
)

	)

84 
	shd¥_v”siÚ
 {

85 
HDSP_IO_Ty³
 
	mio_ty³
;

86 
	mfœmw¬e_»v
;

89 
	#SNDRV_HDSP_IOCTL_GET_VERSION
 
	`_IOR
('H', 0x43, 
hd¥_v”siÚ
)

	)

91 
	shd¥_mix”
 {

92 
	mm©rix
[
HDSP_MATRIX_MIXER_SIZE
];

95 
	#SNDRV_HDSP_IOCTL_GET_MIXER
 
	`_IOR
('H', 0x44, 
hd¥_mix”
)

	)

97 
	shd¥_9632_«b
 {

98 
	m«bi
;

99 
	m«bo
;

102 
	#SNDRV_HDSP_IOCTL_GET_9632_AEB
 
	`_IOR
('H', 0x45, 
hd¥_9632_«b
)

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/hdspm.h

2 #iâdeà
__SOUND_HDSPM_H


3 
	#__SOUND_HDSPM_H


	)

24 #ifdeà
__lšux__


25 
	~<lšux/ty³s.h
>

29 
	#HDSPM_MAX_CHANNELS
 64

	)

31 
	ehd¥m_io_ty³
 {

32 
	mMADI
,

33 
	mMADIçû
,

34 
	mAIO
,

35 
	mAES32
,

36 
	mRayDAT


39 
	ehd¥m_¥“d
 {

40 
	mss
,

41 
	mds
,

42 
	mqs


47 
	shd¥m_³ak_rms
 {

48 
__u32
 
	mšput_³aks
[64];

49 
__u32
 
	m¶ayback_³aks
[64];

50 
__u32
 
	mouut_³aks
[64];

52 
__u64
 
	mšput_rms
[64];

53 
__u64
 
	m¶ayback_rms
[64];

54 
__u64
 
	mouut_rms
[64];

56 
__u8
 
	m¥“d
;

57 
	m¡©us2
;

60 
	#SNDRV_HDSPM_IOCTL_GET_PEAK_RMS
 \

61 
	`_IOR
('H', 0x42, 
hd¥m_³ak_rms
)

	)

65 
	shd¥m_cÚfig
 {

66 
	m´ef_sync_»f
;

67 
	mwÜdşock_sync_check
;

68 
	mmadi_sync_check
;

69 
	msy¡em_§m¶e_¿‹
;

70 
	mautosync_§m¶e_¿‹
;

71 
	msy¡em_şock_mode
;

72 
	mşock_sourû
;

73 
	mautosync_»f
;

74 
	mlše_out
;

75 
	m·s¡hru
;

76 
	mª®og_out
;

79 
	#SNDRV_HDSPM_IOCTL_GET_CONFIG
 \

80 
	`_IOR
('H', 0x41, 
hd¥m_cÚfig
)

	)

91 
	ehd¥m_Éc_fÜm©
 {

92 
	mfÜm©_šv®id
,

93 
	mås_24
,

94 
	mås_25
,

95 
	mås_2997
,

96 
	mås_30


99 
	ehd¥m_Éc_äame
 {

100 
	mäame_šv®id
,

101 
	mdrİ_äame
,

102 
	mfuÎ_äame


105 
	ehd¥m_Éc_šput_fÜm©
 {

106 
	mÁsc
,

107 
	m·l
,

108 
	mno_video


111 
	shd¥m_Éc
 {

112 
	mÉc
;

114 
hd¥m_Éc_fÜm©
 
	mfÜm©
;

115 
hd¥m_Éc_äame
 
	mäame
;

116 
hd¥m_Éc_šput_fÜm©
 
	mšput_fÜm©
;

119 
	#SNDRV_HDSPM_IOCTL_GET_LTC
 
	`_IOR
('H', 0x46, 
hd¥m_Éc
)

	)

127 
	ehd¥m_sync
 {

128 
	mhd¥m_sync_no_lock
 = 0,

129 
	mhd¥m_sync_lock
 = 1,

130 
	mhd¥m_sync_sync
 = 2

133 
	ehd¥m_madi_šput
 {

134 
	mhd¥m_šput_İtiÿl
 = 0,

135 
	mhd¥m_šput_cßx
 = 1

138 
	ehd¥m_madi_chªÃl_fÜm©
 {

139 
	mhd¥m_fÜm©_ch_64
 = 0,

140 
	mhd¥m_fÜm©_ch_56
 = 1

143 
	ehd¥m_madi_äame_fÜm©
 {

144 
	mhd¥m_äame_48
 = 0,

145 
	mhd¥m_äame_96
 = 1

148 
	ehd¥m_syncsourû
 {

149 
	msyncsourû_wc
 = 0,

150 
	msyncsourû_madi
 = 1,

151 
	msyncsourû_tco
 = 2,

152 
	msyncsourû_sync
 = 3,

153 
	msyncsourû_nÚe
 = 4

156 
	shd¥m_¡©us
 {

157 
__u8
 
	mÿrd_ty³
;

158 
hd¥m_syncsourû
 
	mautosync_sourû
;

160 
__u64
 
	mÿrd_şock
;

161 
__u32
 
	mma¡”_³riod
;

165 
__u8
 
	msync_wc
;

166 
__u8
 
	msync_madi
;

167 
__u8
 
	msync_tco
;

168 
__u8
 
	msync_š
;

169 
__u8
 
	mmadi_šput
;

170 
__u8
 
	mchªÃl_fÜm©
;

171 
__u8
 
	mäame_fÜm©
;

172 } 
	mmadi
;

173 } 
	mÿrd_¥ecific
;

176 
	#SNDRV_HDSPM_IOCTL_GET_STATUS
 \

177 
	`_IOR
('H', 0x47, 
hd¥m_¡©us
)

	)

183 
	#HDSPM_ADDON_TCO
 1

	)

185 
	shd¥m_v”siÚ
 {

186 
__u8
 
	mÿrd_ty³
;

187 
	mÿrdÇme
[20];

188 
	m£rŸl
;

189 
	mfœmw¬e_»v
;

190 
	maddÚs
;

193 
	#SNDRV_HDSPM_IOCTL_GET_VERSION
 
	`_IOR
('H', 0x48, 
hd¥m_v”siÚ
)

	)

208 
	#HDSPM_MIXER_CHANNELS
 
HDSPM_MAX_CHANNELS


	)

210 
	shd¥m_chªÃlçd”
 {

211 
	mš
[
HDSPM_MIXER_CHANNELS
];

212 
	mpb
[
HDSPM_MIXER_CHANNELS
];

215 
	shd¥m_mix”
 {

216 
hd¥m_chªÃlçd”
 
	mch
[
HDSPM_MIXER_CHANNELS
];

219 
	shd¥m_mix”_ioùl
 {

220 
hd¥m_mix”
 *
	mmix”
;

224 
	#SNDRV_HDSPM_IOCTL_GET_MIXER
 
	`_IOR
('H', 0x44, 
hd¥m_mix”_ioùl
)

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/sb16_csp.h

23 #iâdeà
__SOUND_SB16_CSP_H


24 
	#__SOUND_SB16_CSP_H


	)

28 
	#SNDRV_SB_CSP_MODE_NONE
 0x00

	)

29 
	#SNDRV_SB_CSP_MODE_DSP_READ
 0x01

	)

30 
	#SNDRV_SB_CSP_MODE_DSP_WRITE
 0x02

	)

31 
	#SNDRV_SB_CSP_MODE_QSOUND
 0x04

	)

34 
	#SNDRV_SB_CSP_LOAD_FROMUSER
 0x01

	)

35 
	#SNDRV_SB_CSP_LOAD_INITBLOCK
 0x02

	)

38 
	#SNDRV_SB_CSP_SAMPLE_8BIT
 0x01

	)

39 
	#SNDRV_SB_CSP_SAMPLE_16BIT
 0x02

	)

42 
	#SNDRV_SB_CSP_MONO
 0x01

	)

43 
	#SNDRV_SB_CSP_STEREO
 0x02

	)

46 
	#SNDRV_SB_CSP_RATE_8000
 0x01

	)

47 
	#SNDRV_SB_CSP_RATE_11025
 0x02

	)

48 
	#SNDRV_SB_CSP_RATE_22050
 0x04

	)

49 
	#SNDRV_SB_CSP_RATE_44100
 0x08

	)

50 
	#SNDRV_SB_CSP_RATE_ALL
 0x0f

	)

53 
	#SNDRV_SB_CSP_ST_IDLE
 0x00

	)

54 
	#SNDRV_SB_CSP_ST_LOADED
 0x01

	)

55 
	#SNDRV_SB_CSP_ST_RUNNING
 0x02

	)

56 
	#SNDRV_SB_CSP_ST_PAUSED
 0x04

	)

57 
	#SNDRV_SB_CSP_ST_AUTO
 0x08

	)

58 
	#SNDRV_SB_CSP_ST_QSOUND
 0x10

	)

61 
	#SNDRV_SB_CSP_QSOUND_MAX_RIGHT
 0x20

	)

64 
	#SNDRV_SB_CSP_MAX_MICROCODE_FILE_SIZE
 0x3000

	)

67 
	s¢d_sb_c¥_mc_h—d”
 {

68 
	mcodec_Çme
[16];

69 
	mfunc_»q
;

73 
	s¢d_sb_c¥_miüocode
 {

74 
¢d_sb_c¥_mc_h—d”
 
	mšfo
;

75 
	md©a
[
SNDRV_SB_CSP_MAX_MICROCODE_FILE_SIZE
];

79 
	s¢d_sb_c¥_¡¬t
 {

80 
	m§m¶e_width
;

81 
	mchªÃls
;

85 
	s¢d_sb_c¥_šfo
 {

86 
	mcodec_Çme
[16];

87 
	mfunc_Ä
;

88 
	macc_fÜm©
;

89 
	macc_chªÃls
;

90 
	macc_width
;

91 
	macc_¿‹s
;

92 
	mc¥_mode
;

93 
	mrun_chªÃls
;

94 
	mrun_width
;

95 
	mv”siÚ
;

96 
	m¡©e
;

101 
	#SNDRV_SB_CSP_IOCTL_INFO
 
	`_IOR
('H', 0x10, 
¢d_sb_c¥_šfo
)

	)

109 
	#SNDRV_SB_CSP_IOCTL_LOAD_CODE
 \

110 
	`_IOC
(
_IOC_WRITE
, 'H', 0x11, (
¢d_sb_c¥_miüocode
))

	)

112 
	#SNDRV_SB_CSP_IOCTL_UNLOAD_CODE
 
	`_IO
('H', 0x12)

	)

114 
	#SNDRV_SB_CSP_IOCTL_START
 
	`_IOW
('H', 0x13, 
¢d_sb_c¥_¡¬t
)

	)

116 
	#SNDRV_SB_CSP_IOCTL_STOP
 
	`_IO
('H', 0x14)

	)

118 
	#SNDRV_SB_CSP_IOCTL_PAUSE
 
	`_IO
('H', 0x15)

	)

120 
	#SNDRV_SB_CSP_IOCTL_RESTART
 
	`_IO
('H', 0x16)

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/sscape_ioctl.h

1 #iâdeà
SSCAPE_IOCTL_H


2 
	#SSCAPE_IOCTL_H


	)

5 
	sssÿ³_boÙblock


7 
	mcode
[256];

8 
	mv”siÚ
;

11 
	#SSCAPE_MICROCODE_SIZE
 65536

	)

13 
	sssÿ³_miüocode


15 *
	mcode
;

18 
	#SND_SSCAPE_LOAD_BOOTB
 
	`_IOWR
('P', 100, 
ssÿ³_boÙblock
)

	)

19 
	#SND_SSCAPE_LOAD_MCODE
 
	`_IOW
 ('P', 101, 
ssÿ³_miüocode
)

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/tlv.h

14 #iâdeà
__UAPI_SOUND_TLV_H


15 
	#__UAPI_SOUND_TLV_H


	)

17 
	#SNDRV_CTL_TLVT_CONTAINER
 0

	)

18 
	#SNDRV_CTL_TLVT_DB_SCALE
 1

	)

19 
	#SNDRV_CTL_TLVT_DB_LINEAR
 2

	)

20 
	#SNDRV_CTL_TLVT_DB_RANGE
 3

	)

21 
	#SNDRV_CTL_TLVT_DB_MINMAX
 4

	)

22 
	#SNDRV_CTL_TLVT_DB_MINMAX_MUTE
 5

	)

28 
	#SNDRV_CTL_TLVT_CHMAP_FIXED
 0x101

	)

29 
	#SNDRV_CTL_TLVT_CHMAP_VAR
 0x102

	)

30 
	#SNDRV_CTL_TLVT_CHMAP_PAIRED
 0x103

	)

40 
	#SNDRV_CTL_TLVD_ITEM
(
ty³
, ...) \

41 (
ty³
), 
	`SNDRV_CTL_TLVD_LENGTH
(
__VA_ARGS__
), 
	)
__VA_ARGS__

42 
	#SNDRV_CTL_TLVD_LENGTH
(...) \

43 (()((cÚ¡ []è{ 
__VA_ARGS__
 }))

	)

46 
	#SNDRV_CTL_TLVO_TYPE
 0

	)

47 
	#SNDRV_CTL_TLVO_LEN
 1

	)

49 
	#SNDRV_CTL_TLVD_CONTAINER_ITEM
(...) \

50 
	`SNDRV_CTL_TLVD_ITEM
(
SNDRV_CTL_TLVT_CONTAINER
, 
__VA_ARGS__
)

	)

51 
	#SNDRV_CTL_TLVD_DECLARE_CONTAINER
(
Çme
, ...) \

52 
Çme
[] = { \

53 
	`SNDRV_CTL_TLVD_CONTAINER_ITEM
(
__VA_ARGS__
) \

54 }

	)

56 
	#SNDRV_CTL_TLVD_DB_SCALE_MASK
 0xffff

	)

57 
	#SNDRV_CTL_TLVD_DB_SCALE_MUTE
 0x10000

	)

58 
	#SNDRV_CTL_TLVD_DB_SCALE_ITEM
(
mš
, 
¡•
, 
mu‹
) \

59 
	`SNDRV_CTL_TLVD_ITEM
(
SNDRV_CTL_TLVT_DB_SCALE
, \

60 (
mš
), \

61 ((
¡•
è& 
SNDRV_CTL_TLVD_DB_SCALE_MASK
) | \

62 ((
mu‹
è? 
SNDRV_CTL_TLVD_DB_SCALE_MUTE
 : 0))

	)

63 
	#SNDRV_CTL_TLVD_DECLARE_DB_SCALE
(
Çme
, 
mš
, 
¡•
, 
mu‹
) \

64 
Çme
[] = { \

65 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(
mš
, 
¡•
, 
mu‹
) \

66 }

	)

69 
	#SNDRV_CTL_TLVO_DB_SCALE_MIN
 2

	)

70 
	#SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
 3

	)

73 
	#SNDRV_CTL_TLVD_DB_MINMAX_ITEM
(
mš_dB
, 
max_dB
) \

74 
	`SNDRV_CTL_TLVD_ITEM
(
SNDRV_CTL_TLVT_DB_MINMAX
, (
mš_dB
), (
max_dB
))

	)

75 
	#SNDRV_CTL_TLVD_DB_MINMAX_MUTE_ITEM
(
mš_dB
, 
max_dB
) \

76 
	`SNDRV_CTL_TLVD_ITEM
(
SNDRV_CTL_TLVT_DB_MINMAX_MUTE
, (
mš_dB
), (
max_dB
))

	)

77 
	#SNDRV_CTL_TLVD_DECLARE_DB_MINMAX
(
Çme
, 
mš_dB
, 
max_dB
) \

78 
Çme
[] = { \

79 
	`SNDRV_CTL_TLVD_DB_MINMAX_ITEM
(
mš_dB
, 
max_dB
) \

80 }

	)

81 
	#SNDRV_CTL_TLVD_DECLARE_DB_MINMAX_MUTE
(
Çme
, 
mš_dB
, 
max_dB
) \

82 
Çme
[] = { \

83 
	`SNDRV_CTL_TLVD_DB_MINMAX_MUTE_ITEM
(
mš_dB
, 
max_dB
) \

84 }

	)

87 
	#SNDRV_CTL_TLVO_DB_MINMAX_MIN
 2

	)

88 
	#SNDRV_CTL_TLVO_DB_MINMAX_MAX
 3

	)

91 
	#SNDRV_CTL_TLVD_DB_LINEAR_ITEM
(
mš_dB
, 
max_dB
) \

92 
	`SNDRV_CTL_TLVD_ITEM
(
SNDRV_CTL_TLVT_DB_LINEAR
, (
mš_dB
), (
max_dB
))

	)

93 
	#SNDRV_CTL_TLVD_DECLARE_DB_LINEAR
(
Çme
, 
mš_dB
, 
max_dB
) \

94 
Çme
[] = { \

95 
	`SNDRV_CTL_TLVD_DB_LINEAR_ITEM
(
mš_dB
, 
max_dB
) \

96 }

	)

99 
	#SNDRV_CTL_TLVO_DB_LINEAR_MIN
 2

	)

100 
	#SNDRV_CTL_TLVO_DB_LINEAR_MAX
 3

	)

108 
	#SNDRV_CTL_TLVD_DB_RANGE_ITEM
(...) \

109 
	`SNDRV_CTL_TLVD_ITEM
(
SNDRV_CTL_TLVT_DB_RANGE
, 
__VA_ARGS__
)

	)

110 
	#SNDRV_CTL_TLVD_DECLARE_DB_RANGE
(
Çme
, ...) \

111 
Çme
[] = { \

112 
	`SNDRV_CTL_TLVD_DB_RANGE_ITEM
(
__VA_ARGS__
) \

113 }

	)

115 
	#SNDRV_CTL_TLVD_DB_GAIN_MUTE
 -9999999

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sys.h

1 #w¬nšg 
This
 
h—d”
 
is
 
d•»ÿ‹d
, 
u£
 <
®§
/
asoundlib
.
h
> 
š¡—d
.

2 
	~<®§/asoundlib.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/timer.h

28 #iâdeà
__ALSA_TIMER_H


29 
	#__ALSA_TIMER_H


	)

31 #ifdeà
__ılu¥lus


42 
	#SND_TIMER_DLSYM_VERSION
 
_dlsym_tim”_001


	)

44 
	#SND_TIMER_QUERY_DLSYM_VERSION
 
_dlsym_tim”_qu”y_001


	)

47 
_¢d_tim”_id
 
	t¢d_tim”_id_t
;

49 
_¢d_tim”_gšfo
 
	t¢d_tim”_gšfo_t
;

51 
_¢d_tim”_g·¿ms
 
	t¢d_tim”_g·¿ms_t
;

53 
_¢d_tim”_g¡©us
 
	t¢d_tim”_g¡©us_t
;

55 
_¢d_tim”_šfo
 
	t¢d_tim”_šfo_t
;

57 
_¢d_tim”_·¿ms
 
	t¢d_tim”_·¿ms_t
;

59 
_¢d_tim”_¡©us
 
	t¢d_tim”_¡©us_t
;

61 
	e_¢d_tim”_şass
 {

62 
SND_TIMER_CLASS_NONE
 = -1,

63 
SND_TIMER_CLASS_SLAVE
 = 0,

64 
SND_TIMER_CLASS_GLOBAL
,

65 
SND_TIMER_CLASS_CARD
,

66 
SND_TIMER_CLASS_PCM
,

67 
SND_TIMER_CLASS_LAST
 = 
SND_TIMER_CLASS_PCM


68 } 
	t¢d_tim”_şass_t
;

71 
	e_¢d_tim”_¦ave_şass
 {

72 
SND_TIMER_SCLASS_NONE
 = 0,

73 
SND_TIMER_SCLASS_APPLICATION
,

74 
SND_TIMER_SCLASS_SEQUENCER
,

75 
SND_TIMER_SCLASS_OSS_SEQUENCER
,

76 
SND_TIMER_SCLASS_LAST
 = 
SND_TIMER_SCLASS_OSS_SEQUENCER


77 } 
	t¢d_tim”_¦ave_şass_t
;

80 
	e_¢d_tim”_ev’t
 {

81 
SND_TIMER_EVENT_RESOLUTION
 = 0,

82 
SND_TIMER_EVENT_TICK
,

83 
SND_TIMER_EVENT_START
,

84 
SND_TIMER_EVENT_STOP
,

85 
SND_TIMER_EVENT_CONTINUE
,

86 
SND_TIMER_EVENT_PAUSE
,

87 
SND_TIMER_EVENT_EARLY
,

88 
SND_TIMER_EVENT_SUSPEND
,

89 
SND_TIMER_EVENT_RESUME
,

91 
SND_TIMER_EVENT_MSTART
 = 
SND_TIMER_EVENT_START
 + 10,

92 
SND_TIMER_EVENT_MSTOP
 = 
SND_TIMER_EVENT_STOP
 + 10,

93 
SND_TIMER_EVENT_MCONTINUE
 = 
SND_TIMER_EVENT_CONTINUE
 + 10,

94 
SND_TIMER_EVENT_MPAUSE
 = 
SND_TIMER_EVENT_PAUSE
 + 10,

95 
SND_TIMER_EVENT_MSUSPEND
 = 
SND_TIMER_EVENT_SUSPEND
 + 10,

96 
SND_TIMER_EVENT_MRESUME
 = 
SND_TIMER_EVENT_RESUME
 + 10

97 } 
	t¢d_tim”_ev’t_t
;

100 
	s_¢d_tim”_»ad
 {

101 
»sŞutiÚ
;

102 
ticks
;

103 } 
	t¢d_tim”_»ad_t
;

106 
	s_¢d_tim”_Œ—d
 {

107 
¢d_tim”_ev’t_t
 
ev’t
;

108 
¢d_htime¡amp_t
 
t¡amp
;

109 
v®
;

110 } 
	t¢d_tim”_Œ—d_t
;

113 
	#SND_TIMER_GLOBAL_SYSTEM
 0

	)

115 
	#SND_TIMER_GLOBAL_RTC
 1

	)

117 
	#SND_TIMER_GLOBAL_HPET
 2

	)

119 
	#SND_TIMER_GLOBAL_HRTIMER
 3

	)

122 
	#SND_TIMER_OPEN_NONBLOCK
 (1<<0)

	)

124 
	#SND_TIMER_OPEN_TREAD
 (1<<1)

	)

127 
	e_¢d_tim”_ty³
 {

129 
SND_TIMER_TYPE_HW
 = 0,

131 
SND_TIMER_TYPE_SHM
,

133 
SND_TIMER_TYPE_INET


134 } 
	t¢d_tim”_ty³_t
;

137 
_¢d_tim”_qu”y
 
	t¢d_tim”_qu”y_t
;

139 
_¢d_tim”
 
	t¢d_tim”_t
;

142 
¢d_tim”_qu”y_İ’
(
¢d_tim”_qu”y_t
 **
hªdË
, cÚ¡ *
Çme
, 
mode
);

143 
¢d_tim”_qu”y_İ’_lcÚf
(
¢d_tim”_qu”y_t
 **
hªdË
, cÚ¡ *
Çme
, 
mode
, 
¢d_cÚfig_t
 *
lcÚf
);

144 
¢d_tim”_qu”y_şo£
(
¢d_tim”_qu”y_t
 *
hªdË
);

145 
¢d_tim”_qu”y_Ãxt_deviû
(
¢d_tim”_qu”y_t
 *
hªdË
, 
¢d_tim”_id_t
 *
tid
);

146 
¢d_tim”_qu”y_šfo
(
¢d_tim”_qu”y_t
 *
hªdË
, 
¢d_tim”_gšfo_t
 *
šfo
);

147 
¢d_tim”_qu”y_·¿ms
(
¢d_tim”_qu”y_t
 *
hªdË
, 
¢d_tim”_g·¿ms_t
 *
·¿ms
);

148 
¢d_tim”_qu”y_¡©us
(
¢d_tim”_qu”y_t
 *
hªdË
, 
¢d_tim”_g¡©us_t
 *
¡©us
);

150 
¢d_tim”_İ’
(
¢d_tim”_t
 **
hªdË
, cÚ¡ *
Çme
, 
mode
);

151 
¢d_tim”_İ’_lcÚf
(
¢d_tim”_t
 **
hªdË
, cÚ¡ *
Çme
, 
mode
, 
¢d_cÚfig_t
 *
lcÚf
);

152 
¢d_tim”_şo£
(
¢d_tim”_t
 *
hªdË
);

153 
¢d_async_add_tim”_hªdËr
(
¢d_async_hªdËr_t
 **
hªdËr
, 
¢d_tim”_t
 *
tim”
,

154 
¢d_async_ÿÎback_t
 
ÿÎback
, *
´iv©e_d©a
);

155 
¢d_tim”_t
 *
¢d_async_hªdËr_g‘_tim”
(
¢d_async_hªdËr_t
 *
hªdËr
);

156 
¢d_tim”_pŞl_desütÜs_couÁ
(
¢d_tim”_t
 *
hªdË
);

157 
¢d_tim”_pŞl_desütÜs
(
¢d_tim”_t
 *
hªdË
, 
pŞlfd
 *
pfds
, 
¥aû
);

158 
¢d_tim”_pŞl_desütÜs_»v’ts
(
¢d_tim”_t
 *
tim”
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
);

159 
¢d_tim”_šfo
(
¢d_tim”_t
 *
hªdË
, 
¢d_tim”_šfo_t
 *
tim”
);

160 
¢d_tim”_·¿ms
(
¢d_tim”_t
 *
hªdË
, 
¢d_tim”_·¿ms_t
 *
·¿ms
);

161 
¢d_tim”_¡©us
(
¢d_tim”_t
 *
hªdË
, 
¢d_tim”_¡©us_t
 *
¡©us
);

162 
¢d_tim”_¡¬t
(
¢d_tim”_t
 *
hªdË
);

163 
¢d_tim”_¡İ
(
¢d_tim”_t
 *
hªdË
);

164 
¢d_tim”_cÚtšue
(
¢d_tim”_t
 *
hªdË
);

165 
ssize_t
 
¢d_tim”_»ad
(
¢d_tim”_t
 *
hªdË
, *
bufãr
, 
size_t
 
size
);

167 
size_t
 
¢d_tim”_id_sizeof
();

169 
	#¢d_tim”_id_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_tim”_id
)

	)

170 
¢d_tim”_id_m®loc
(
¢d_tim”_id_t
 **
±r
);

171 
¢d_tim”_id_ä“
(
¢d_tim”_id_t
 *
obj
);

172 
¢d_tim”_id_cİy
(
¢d_tim”_id_t
 *
d¡
, cÚ¡ snd_tim”_id_ˆ*
¤c
);

174 
¢d_tim”_id_£t_şass
(
¢d_tim”_id_t
 *
id
, 
dev_şass
);

175 
¢d_tim”_id_g‘_şass
(
¢d_tim”_id_t
 *
id
);

176 
¢d_tim”_id_£t_sşass
(
¢d_tim”_id_t
 *
id
, 
dev_sşass
);

177 
¢d_tim”_id_g‘_sşass
(
¢d_tim”_id_t
 *
id
);

178 
¢d_tim”_id_£t_ÿrd
(
¢d_tim”_id_t
 *
id
, 
ÿrd
);

179 
¢d_tim”_id_g‘_ÿrd
(
¢d_tim”_id_t
 *
id
);

180 
¢d_tim”_id_£t_deviû
(
¢d_tim”_id_t
 *
id
, 
deviû
);

181 
¢d_tim”_id_g‘_deviû
(
¢d_tim”_id_t
 *
id
);

182 
¢d_tim”_id_£t_subdeviû
(
¢d_tim”_id_t
 *
id
, 
subdeviû
);

183 
¢d_tim”_id_g‘_subdeviû
(
¢d_tim”_id_t
 *
id
);

185 
size_t
 
¢d_tim”_gšfo_sizeof
();

187 
	#¢d_tim”_gšfo_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_tim”_gšfo
)

	)

188 
¢d_tim”_gšfo_m®loc
(
¢d_tim”_gšfo_t
 **
±r
);

189 
¢d_tim”_gšfo_ä“
(
¢d_tim”_gšfo_t
 *
obj
);

190 
¢d_tim”_gšfo_cİy
(
¢d_tim”_gšfo_t
 *
d¡
, cÚ¡ snd_tim”_gšfo_ˆ*
¤c
);

192 
¢d_tim”_gšfo_£t_tid
(
¢d_tim”_gšfo_t
 *
obj
, 
¢d_tim”_id_t
 *
tid
);

193 
¢d_tim”_id_t
 *
¢d_tim”_gšfo_g‘_tid
(
¢d_tim”_gšfo_t
 *
obj
);

194 
¢d_tim”_gšfo_g‘_æags
(
¢d_tim”_gšfo_t
 *
obj
);

195 
¢d_tim”_gšfo_g‘_ÿrd
(
¢d_tim”_gšfo_t
 *
obj
);

196 *
¢d_tim”_gšfo_g‘_id
(
¢d_tim”_gšfo_t
 *
obj
);

197 *
¢d_tim”_gšfo_g‘_Çme
(
¢d_tim”_gšfo_t
 *
obj
);

198 
¢d_tim”_gšfo_g‘_»sŞutiÚ
(
¢d_tim”_gšfo_t
 *
obj
);

199 
¢d_tim”_gšfo_g‘_»sŞutiÚ_mš
(
¢d_tim”_gšfo_t
 *
obj
);

200 
¢d_tim”_gšfo_g‘_»sŞutiÚ_max
(
¢d_tim”_gšfo_t
 *
obj
);

201 
¢d_tim”_gšfo_g‘_ş›Ás
(
¢d_tim”_gšfo_t
 *
obj
);

203 
size_t
 
¢d_tim”_šfo_sizeof
();

205 
	#¢d_tim”_šfo_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_tim”_šfo
)

	)

206 
¢d_tim”_šfo_m®loc
(
¢d_tim”_šfo_t
 **
±r
);

207 
¢d_tim”_šfo_ä“
(
¢d_tim”_šfo_t
 *
obj
);

208 
¢d_tim”_šfo_cİy
(
¢d_tim”_šfo_t
 *
d¡
, cÚ¡ snd_tim”_šfo_ˆ*
¤c
);

210 
¢d_tim”_šfo_is_¦ave
(
¢d_tim”_šfo_t
 * 
šfo
);

211 
¢d_tim”_šfo_g‘_ÿrd
(
¢d_tim”_šfo_t
 * 
šfo
);

212 cÚ¡ *
¢d_tim”_šfo_g‘_id
(
¢d_tim”_šfo_t
 * 
šfo
);

213 cÚ¡ *
¢d_tim”_šfo_g‘_Çme
(
¢d_tim”_šfo_t
 * 
šfo
);

214 
¢d_tim”_šfo_g‘_»sŞutiÚ
(
¢d_tim”_šfo_t
 * 
šfo
);

216 
size_t
 
¢d_tim”_·¿ms_sizeof
();

218 
	#¢d_tim”_·¿ms_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_tim”_·¿ms
)

	)

219 
¢d_tim”_·¿ms_m®loc
(
¢d_tim”_·¿ms_t
 **
±r
);

220 
¢d_tim”_·¿ms_ä“
(
¢d_tim”_·¿ms_t
 *
obj
);

221 
¢d_tim”_·¿ms_cİy
(
¢d_tim”_·¿ms_t
 *
d¡
, cÚ¡ snd_tim”_·¿ms_ˆ*
¤c
);

223 
¢d_tim”_·¿ms_£t_auto_¡¬t
(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
auto_¡¬t
);

224 
¢d_tim”_·¿ms_g‘_auto_¡¬t
(
¢d_tim”_·¿ms_t
 * 
·¿ms
);

225 
¢d_tim”_·¿ms_£t_exşusive
(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
exşusive
);

226 
¢d_tim”_·¿ms_g‘_exşusive
(
¢d_tim”_·¿ms_t
 * 
·¿ms
);

227 
¢d_tim”_·¿ms_£t_—¾y_ev’t
(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
—¾y_ev’t
);

228 
¢d_tim”_·¿ms_g‘_—¾y_ev’t
(
¢d_tim”_·¿ms_t
 * 
·¿ms
);

229 
¢d_tim”_·¿ms_£t_ticks
(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
ticks
);

230 
¢d_tim”_·¿ms_g‘_ticks
(
¢d_tim”_·¿ms_t
 * 
·¿ms
);

231 
¢d_tim”_·¿ms_£t_queue_size
(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
queue_size
);

232 
¢d_tim”_·¿ms_g‘_queue_size
(
¢d_tim”_·¿ms_t
 * 
·¿ms
);

233 
¢d_tim”_·¿ms_£t_f‹r
(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
f‹r
);

234 
¢d_tim”_·¿ms_g‘_f‹r
(
¢d_tim”_·¿ms_t
 * 
·¿ms
);

236 
size_t
 
¢d_tim”_¡©us_sizeof
();

238 
	#¢d_tim”_¡©us_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_tim”_¡©us
)

	)

239 
¢d_tim”_¡©us_m®loc
(
¢d_tim”_¡©us_t
 **
±r
);

240 
¢d_tim”_¡©us_ä“
(
¢d_tim”_¡©us_t
 *
obj
);

241 
¢d_tim”_¡©us_cİy
(
¢d_tim”_¡©us_t
 *
d¡
, cÚ¡ snd_tim”_¡©us_ˆ*
¤c
);

243 
¢d_htime¡amp_t
 
¢d_tim”_¡©us_g‘_time¡amp
(
¢d_tim”_¡©us_t
 * 
¡©us
);

244 
¢d_tim”_¡©us_g‘_»sŞutiÚ
(
¢d_tim”_¡©us_t
 * 
¡©us
);

245 
¢d_tim”_¡©us_g‘_lo¡
(
¢d_tim”_¡©us_t
 * 
¡©us
);

246 
¢d_tim”_¡©us_g‘_ov”run
(
¢d_tim”_¡©us_t
 * 
¡©us
);

247 
¢d_tim”_¡©us_g‘_queue
(
¢d_tim”_¡©us_t
 * 
¡©us
);

250 
¢d_tim”_šfo_g‘_ticks
(
¢d_tim”_šfo_t
 * 
šfo
);

254 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/topology.h

21 #iâdeà
__ALSA_TOPOLOGY_H


22 
	#__ALSA_TOPOLOGY_H


	)

24 
	~<¡dšt.h
>

26 #ifdeà
__ılu¥lus


741 
	#SND_TPLG_MAX_CHAN
 8

	)

744 
¢d_lg
 
	t¢d_lg_t
;

747 
	e¢d_lg_ty³
 {

748 
SND_TPLG_TYPE_TLV
 = 0,

749 
SND_TPLG_TYPE_MIXER
,

750 
SND_TPLG_TYPE_ENUM
,

751 
SND_TPLG_TYPE_TEXT
,

752 
SND_TPLG_TYPE_DATA
,

753 
SND_TPLG_TYPE_BYTES
,

754 
SND_TPLG_TYPE_STREAM_CONFIG
,

755 
SND_TPLG_TYPE_STREAM_CAPS
,

756 
SND_TPLG_TYPE_PCM
,

757 
SND_TPLG_TYPE_DAPM_WIDGET
,

758 
SND_TPLG_TYPE_DAPM_GRAPH
,

759 
SND_TPLG_TYPE_BE
,

760 
SND_TPLG_TYPE_CC
,

761 
SND_TPLG_TYPE_MANIFEST
,

762 
SND_TPLG_TYPE_TOKEN
,

763 
SND_TPLG_TYPE_TUPLE
,

764 
SND_TPLG_TYPE_LINK
,

765 
SND_TPLG_TYPE_HW_CONFIG
,

766 
SND_TPLG_TYPE_DAI
,

770 
	#SND_TPLG_INDEX_ALL
 0

	)

773 
	#SND_TPLG_CREATE_VERBOSE
 (1<<0è

	)

774 
	#SND_TPLG_CREATE_DAPM_NOSORT
 (1<<1è

	)

780 cÚ¡ *
¢d_lg_v”siÚ
();

786 
¢d_lg_t
 *
¢d_lg_Ãw
();

792 
¢d_lg_t
 *
¢d_lg_ü—‹
(
æags
);

798 
¢d_lg_ä“
(
¢d_lg_t
 *
lg
);

807 
¢d_lg_lßd
(
¢d_lg_t
 *
lg
, cÚ¡ *
buf
, 
size_t
 
size
);

816 
¢d_lg_bud_fe
(
¢d_lg_t
 *
lg
, cÚ¡ *
šfe
,

817 cÚ¡ *
outfe
);

824 
¢d_lg_v”bo£
(
¢d_lg_t
 *
lg
, 
v”bo£
);

829 
	s¢d_lg_v_‹m¶©e
 {

830 
ty³
;

836 
	s¢d_lg_v_dbsÿË_‹m¶©e
 {

837 
¢d_lg_v_‹m¶©e
 
hdr
;

838 
mš
;

839 
¡•
;

840 
mu‹
;

846 
	s¢d_lg_chªÃl_–em
 {

847 
size
;

848 
»g
;

849 
shiá
;

850 
id
;

856 
	s¢d_lg_chªÃl_m­_‹m¶©e
 {

857 
num_chªÃls
;

858 
¢d_lg_chªÃl_–em
 
chªÃl
[
SND_TPLG_MAX_CHAN
];

864 
	s¢d_lg_pd©a_‹m¶©e
 {

865 
Ëngth
;

866 cÚ¡ *
d©a
;

872 
	s¢d_lg_io_İs_‹m¶©e
 {

873 
g‘
;

874 
put
;

875 
šfo
;

881 
	s¢d_lg_ùl_‹m¶©e
 {

882 
ty³
;

883 cÚ¡ *
Çme
;

884 
acûss
;

885 
¢d_lg_io_İs_‹m¶©e
 
İs
;

887 
¢d_lg_v_‹m¶©e
 *
v
;

888 
¢d_lg_v_dbsÿË_‹m¶©e
 *
v_sÿË
;

895 
	s¢d_lg_mix”_‹m¶©e
 {

896 
¢d_lg_ùl_‹m¶©e
 
hdr
;

897 
¢d_lg_chªÃl_m­_‹m¶©e
 *
m­
;

898 
mš
;

899 
max
;

900 
¶©fÜm_max
;

901 
šv”t
;

902 
¢d_soc_lg_´iv©e
 *
´iv
;

908 
	s¢d_lg_’um_‹m¶©e
 {

909 
¢d_lg_ùl_‹m¶©e
 
hdr
;

910 
¢d_lg_chªÃl_m­_‹m¶©e
 *
m­
;

911 
™ems
;

912 
mask
;

913 cÚ¡ **
‹xts
;

914 cÚ¡ **
v®ues
;

915 
¢d_soc_lg_´iv©e
 *
´iv
;

921 
	s¢d_lg_by‹s_‹m¶©e
 {

922 
¢d_lg_ùl_‹m¶©e
 
hdr
;

923 
max
;

924 
mask
;

925 
ba£
;

926 
num_»gs
;

927 
¢d_lg_io_İs_‹m¶©e
 
ext_İs
;

928 
¢d_soc_lg_´iv©e
 *
´iv
;

934 
	s¢d_lg_g¿ph_–em
 {

935 cÚ¡ *
¤c
;

936 cÚ¡ *
ùl
;

937 cÚ¡ *
sšk
;

943 
	s¢d_lg_g¿ph_‹m¶©e
 {

944 
couÁ
;

945 
¢d_lg_g¿ph_–em
 
–em
[0];

951 
	s¢d_lg_widg‘_‹m¶©e
 {

952 
id
;

953 cÚ¡ *
Çme
;

954 cÚ¡ *
¢ame
;

955 
»g
;

956 
shiá
;

957 
mask
;

958 
sub£q
;

959 
šv”t
;

960 
ignÜe_su¥’d
;

961 
ev’t_æags
;

962 
ev’t_ty³
;

963 
¢d_soc_lg_´iv©e
 *
´iv
;

964 
num_ùls
;

965 
¢d_lg_ùl_‹m¶©e
 *
ùl
[0];

971 
	s¢d_lg_¡»am_‹m¶©e
 {

972 cÚ¡ *
Çme
;

973 
fÜm©
;

974 
¿‹
;

975 
³riod_by‹s
;

976 
bufãr_by‹s
;

977 
chªÃls
;

983 
	s¢d_lg_¡»am_ÿps_‹m¶©e
 {

984 cÚ¡ *
Çme
;

985 
ušt64_t
 
fÜm©s
;

986 
¿‹s
;

987 
¿‹_mš
;

988 
¿‹_max
;

989 
chªÃls_mš
;

990 
chªÃls_max
;

991 
³riods_mš
;

992 
³riods_max
;

993 
³riod_size_mš
;

994 
³riod_size_max
;

995 
bufãr_size_mš
;

996 
bufãr_size_max
;

997 
sig_b™s
;

1003 
	s¢d_lg_pcm_‹m¶©e
 {

1004 cÚ¡ *
pcm_Çme
;

1005 cÚ¡ *
dai_Çme
;

1006 
pcm_id
;

1007 
dai_id
;

1008 
¶ayback
;

1009 
ÿ±u»
;

1010 
com´ess
;

1011 
¢d_lg_¡»am_ÿps_‹m¶©e
 *
ÿps
[2];

1012 
æag_mask
;

1013 
æags
;

1014 
¢d_soc_lg_´iv©e
 *
´iv
;

1015 
num_¡»ams
;

1016 
¢d_lg_¡»am_‹m¶©e
 
¡»am
[0];

1023 
	s¢d_lg_hw_cÚfig_‹m¶©e
 {

1024 
id
;

1025 
fmt
;

1026 
şock_g©ed
;

1027 
šv”t_bşk
;

1028 
šv”t_fsync
;

1029 
bşk_´ovid”
;

1030 
fsync_´ovid”
;

1031 
mşk_dœeùiÚ
;

1032 
»£rved
;

1033 
mşk_¿‹
;

1034 
bşk_¿‹
;

1035 
fsync_¿‹
;

1036 
tdm_¦Ùs
;

1037 
tdm_¦Ù_width
;

1038 
tx_¦Ùs
;

1039 
rx_¦Ùs
;

1040 
tx_chªÃls
;

1041 *
tx_chªm­
;

1042 
rx_chªÃls
;

1043 *
rx_chªm­
;

1050 
	s¢d_lg_dai_‹m¶©e
 {

1051 cÚ¡ *
dai_Çme
;

1052 
dai_id
;

1053 
¶ayback
;

1054 
ÿ±u»
;

1055 
¢d_lg_¡»am_ÿps_‹m¶©e
 *
ÿps
[2];

1056 
æag_mask
;

1057 
æags
;

1058 
¢d_soc_lg_´iv©e
 *
´iv
;

1065 
	s¢d_lg_lšk_‹m¶©e
 {

1066 cÚ¡ *
Çme
;

1067 
id
;

1068 cÚ¡ *
¡»am_Çme
;

1070 
num_¡»ams
;

1071 
¢d_lg_¡»am_‹m¶©e
 *
¡»am
;

1073 
¢d_lg_hw_cÚfig_‹m¶©e
 *
hw_cÚfig
;

1074 
num_hw_cÚfigs
;

1075 
deçuÉ_hw_cÚfig_id
;

1077 
æag_mask
;

1078 
æags
;

1079 
¢d_soc_lg_´iv©e
 *
´iv
;

1085 
	s¢d_lg_obj_‹m¶©e
 {

1086 
¢d_lg_ty³
 
ty³
;

1087 
šdex
;

1088 
v”siÚ
;

1089 
v’dÜ_ty³
;

1091 
¢d_lg_widg‘_‹m¶©e
 *
widg‘
;

1092 
¢d_lg_mix”_‹m¶©e
 *
mix”
;

1093 
¢d_lg_by‹s_‹m¶©e
 *
by‹s_ùl
;

1094 
¢d_lg_’um_‹m¶©e
 *
’um_ùl
;

1095 
¢d_lg_g¿ph_‹m¶©e
 *
g¿ph
;

1096 
¢d_lg_pcm_‹m¶©e
 *
pcm
;

1097 
¢d_lg_lšk_‹m¶©e
 *
lšk
;

1098 
¢d_lg_dai_‹m¶©e
 *
dai
;

1100 } 
	t¢d_lg_obj_‹m¶©e_t
;

1108 
¢d_lg_add_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
);

1116 
¢d_lg_bud
(
¢d_lg_t
 *
lg
, cÚ¡ *
outfe
);

1125 
¢d_lg_bud_bš
(
¢d_lg_t
 *
lg
, **
bš
, 
size_t
 *
size
);

1134 
¢d_lg_£t_mªiã¡_d©a
(
¢d_lg_t
 *
lg
, cÚ¡ *
d©a
, 
Ën
);

1142 
¢d_lg_£t_v”siÚ
(
¢d_lg_t
 *
lg
, 
v”siÚ
);

1147 
	#SND_TPLG_SAVE_SORT
 (1<<0è

	)

1148 
	#SND_TPLG_SAVE_GROUPS
 (1<<1è

	)

1149 
	#SND_TPLG_SAVE_NOCHECK
 (1<<16è

	)

1163 
¢d_lg_§ve
(
¢d_lg_t
 *
lg
, **
d¡
, 
æags
);

1173 
¢d_lg_decode
(
¢d_lg_t
 *
lg
, *
bš
, 
size_t
 
size
, 
dæags
);

1177 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/type_compat.h

22 #iâdeà
__TYPE_COMPAT_H


23 
	#__TYPE_COMPAT_H


	)

25 #iâdeà
EBADFD


26 
	#EBADFD
 
EBADF


	)

28 #iâdeà
ESTRPIPE


29 
	#ESTRPIPE
 
ESPIPE


	)

32 #iâdeà
__u16


33 
	#__u16
 
ušt16_t


	)

35 #iâdeà
__u32


36 
	#__u32
 
ušt32_t


	)

38 #iâdeà
__u64


39 
	#__u64
 
ušt64_t


	)

41 #iâdeà
__Ë16


42 
	#__Ë16
 
ušt16_t


	)

44 #iâdeà
__Ë32


45 
	#__Ë32
 
ušt32_t


	)

47 #iâdeà
__Ë64


48 
	#__Ë64
 
ušt64_t


	)

50 #iâdeà
__k”Ãl_pid_t


51 
	#__k”Ãl_pid_t
 
pid_t


	)

53 #iâdeà
__k”Ãl_off_t


54 
	#__k”Ãl_off_t
 
off_t


	)

57 #iâdeà
__b™wi£


58 
	#__b™wi£


	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/ump.h

9 #iâdeà
__ALSA_UMP_H


10 
	#__ALSA_UMP_H


	)

12 #ifdeà
__ılu¥lus


17 
_¢d_ump
 
	t¢d_ump_t
;

19 
¢d_ump_’dpošt_šfo
 
	t¢d_ump_’dpošt_šfo_t
;

21 
¢d_ump_block_šfo
 
	t¢d_ump_block_šfo_t
;

23 
¢d_ump_İ’
(
¢d_ump_t
 **
špu
, snd_ump_ˆ**
ouu
, cÚ¡ *
Çme
, 
mode
);

24 
¢d_ump_şo£
(
¢d_ump_t
 *
ump
);

25 
¢d_¿wmidi_t
 *
¢d_ump_¿wmidi
(
¢d_ump_t
 *
ump
);

26 cÚ¡ *
¢d_ump_Çme
(
¢d_ump_t
 *
ump
);

27 
¢d_ump_pŞl_desütÜs_couÁ
(
¢d_ump_t
 *
ump
);

28 
¢d_ump_pŞl_desütÜs
(
¢d_ump_t
 *
ump
, 
pŞlfd
 *
pfds
, 
¥aû
);

29 
¢d_ump_pŞl_desütÜs_»v’ts
(
¢d_ump_t
 *
ump
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
);

30 
¢d_ump_nÚblock
(
¢d_ump_t
 *
ump
, 
nÚblock
);

31 
¢d_ump_¿wmidi_šfo
(
¢d_ump_t
 *
ump
, 
¢d_¿wmidi_šfo_t
 *
šfo
);

32 
¢d_ump_¿wmidi_·¿ms
(
¢d_ump_t
 *
ump
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
);

33 
¢d_ump_¿wmidi_·¿ms_cu¼’t
(
¢d_ump_t
 *
ump
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
);

34 
¢d_ump_¿wmidi_¡©us
(
¢d_ump_t
 *
ump
, 
¢d_¿wmidi_¡©us_t
 *
¡©us
);

35 
¢d_ump_drİ
(
¢d_ump_t
 *
ump
);

36 
¢d_ump_d¿š
(
¢d_ump_t
 *
ump
);

37 
ssize_t
 
¢d_ump_wr™e
(
¢d_ump_t
 *
ump
, cÚ¡ *
bufãr
, 
size_t
 
size
);

38 
ssize_t
 
¢d_ump_»ad
(
¢d_ump_t
 *
ump
, *
bufãr
, 
size_t
 
size
);

39 
ssize_t
 
¢d_ump_Œ—d
(
¢d_ump_t
 *
ump
, 
time¥ec
 *
t¡amp
, *
bufãr
, 
size_t
 
size
);

42 
	#SND_UMP_MAX_GROUPS
 16

	)

44 
	#SND_UMP_MAX_BLOCKS
 32

	)

47 
	e_¢d_ump_dœeùiÚ
 {

49 
SND_UMP_DIR_INPUT
 = 0x01,

51 
SND_UMP_DIR_OUTPUT
 = 0x02,

53 
SND_UMP_DIR_BIDIRECTION
 = 0x03,

57 
	#SND_UMP_EP_INFO_STATIC_BLOCKS
 0x01

	)

60 
	#SND_UMP_EP_INFO_PROTO_MIDI_MASK
 0x0300

	)

62 
	#SND_UMP_EP_INFO_PROTO_MIDI1
 0x0100

	)

64 
	#SND_UMP_EP_INFO_PROTO_MIDI2
 0x0200

	)

66 
	#SND_UMP_EP_INFO_PROTO_JRTS_MASK
 0x0003

	)

68 
	#SND_UMP_EP_INFO_PROTO_JRTS_TX
 0x0001

	)

70 
	#SND_UMP_EP_INFO_PROTO_JRTS_RX
 0x0002

	)

72 
size_t
 
¢d_ump_’dpošt_šfo_sizeof
();

77 
	#¢d_ump_’dpošt_šfo_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_ump_’dpošt_šfo
)

	)

78 
¢d_ump_’dpošt_šfo_m®loc
(
¢d_ump_’dpošt_šfo_t
 **
šfo
);

79 
¢d_ump_’dpošt_šfo_ä“
(
¢d_ump_’dpošt_šfo_t
 *
šfo
);

80 
¢d_ump_’dpošt_šfo_cİy
(
¢d_ump_’dpošt_šfo_t
 *
d¡
, cÚ¡ snd_ump_’dpošt_šfo_ˆ*
¤c
);

81 
¢d_ump_’dpošt_šfo_g‘_ÿrd
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
);

82 
¢d_ump_’dpošt_šfo_g‘_deviû
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
);

83 
¢d_ump_’dpošt_šfo_g‘_æags
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
);

84 
¢d_ump_’dpošt_šfo_g‘_´ÙocŞ_ÿps
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
);

85 
¢d_ump_’dpošt_šfo_g‘_´ÙocŞ
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
);

86 
¢d_ump_’dpošt_šfo_g‘_num_blocks
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
);

87 
¢d_ump_’dpošt_šfo_g‘_v”siÚ
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
);

88 
¢d_ump_’dpošt_šfo_g‘_mªuçùu»r_id
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
);

89 
¢d_ump_’dpošt_šfo_g‘_çmy_id
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
);

90 
¢d_ump_’dpošt_šfo_g‘_mod–_id
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
);

91 cÚ¡ *
¢d_ump_’dpošt_šfo_g‘_sw_»visiÚ
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
);

92 cÚ¡ *
¢d_ump_’dpošt_šfo_g‘_Çme
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
);

93 cÚ¡ *
¢d_ump_’dpošt_šfo_g‘_´oduù_id
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
);

94 
¢d_ump_’dpošt_šfo
(
¢d_ump_t
 *
ump
, 
¢d_ump_’dpošt_šfo_t
 *
šfo
);

97 
	#SND_UMP_BLOCK_IS_MIDI1
 (1U << 0)

	)

99 
	#SND_UMP_BLOCK_IS_LOWSPEED
 (1U << 1)

	)

102 
	e_¢d_ump_block_ui_hšt
 {

104 
SND_UMP_BLOCK_UI_HINT_UNKNOWN
 = 0x00,

106 
SND_UMP_BLOCK_UI_HINT_RECEIVER
 = 0x01,

108 
SND_UMP_BLOCK_UI_HINT_SENDER
 = 0x02,

110 
SND_UMP_BLOCK_UI_HINT_BOTH
 = 0x03,

113 
size_t
 
¢d_ump_block_šfo_sizeof
();

118 
	#¢d_ump_block_šfo_®loÿ
(
±r
è
	`__¢d_®loÿ
ÕŒ, 
¢d_ump_block_šfo
)

	)

119 
¢d_ump_block_šfo_m®loc
(
¢d_ump_block_šfo_t
 **
šfo
);

120 
¢d_ump_block_šfo_ä“
(
¢d_ump_block_šfo_t
 *
šfo
);

121 
¢d_ump_block_šfo_cİy
(
¢d_ump_block_šfo_t
 *
d¡
, cÚ¡ snd_ump_block_šfo_ˆ*
¤c
);

122 
¢d_ump_block_šfo_g‘_ÿrd
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
);

123 
¢d_ump_block_šfo_g‘_deviû
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
);

124 
¢d_ump_block_šfo_g‘_block_id
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
);

125 
¢d_ump_block_šfo_£t_block_id
(
¢d_ump_block_šfo_t
 *
šfo
, 
id
);

126 
¢d_ump_block_šfo_g‘_aùive
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
);

127 
¢d_ump_block_šfo_g‘_æags
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
);

128 
¢d_ump_block_šfo_g‘_dœeùiÚ
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
);

129 
¢d_ump_block_šfo_g‘_fœ¡_group
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
);

130 
¢d_ump_block_šfo_g‘_num_groups
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
);

131 
¢d_ump_block_šfo_g‘_midi_ci_v”siÚ
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
);

132 
¢d_ump_block_šfo_g‘_sy£x8_¡»ams
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
);

133 
¢d_ump_block_šfo_g‘_ui_hšt
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
);

134 cÚ¡ *
¢d_ump_block_šfo_g‘_Çme
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
);

135 
¢d_ump_block_šfo
(
¢d_ump_t
 *
ump
, 
¢d_ump_block_šfo_t
 *
šfo
);

137 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/ump_msg.h

9 #iâdeà
__ALSA_UMP_MSG_H


10 
	#__ALSA_UMP_MSG_H


	)

12 
	~<¡dšt.h
>

14 #ifdeà
__ılu¥lus


19 
	s_¢d_ump_msg_hdr
 {

20 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


21 
ušt8_t
 
ty³
:4;

22 
ušt8_t
 
group
:4;

23 
ušt8_t
 
¡©us
:4;

24 
ušt8_t
 
chªÃl
:4;

25 
ušt8_t
 
by‹1
;

26 
ušt8_t
 
by‹2
;

28 
ušt8_t
 
by‹2
;

29 
ušt8_t
 
by‹1
;

30 
ušt8_t
 
chªÃl
:4;

31 
ušt8_t
 
¡©us
:4;

32 
ušt8_t
 
group
:4;

33 
ušt8_t
 
ty³
:4;

35 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_hdr_t
;

38 
	s_¢d_ump_msg_midi1_nÙe
 {

39 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


40 
ušt8_t
 
ty³
:4;

41 
ušt8_t
 
group
:4;

42 
ušt8_t
 
¡©us
:4;

43 
ušt8_t
 
chªÃl
:4;

44 
ušt8_t
 
nÙe
;

45 
ušt8_t
 
v–oc™y
;

47 
ušt8_t
 
v–oc™y
;

48 
ušt8_t
 
nÙe
;

49 
ušt8_t
 
chªÃl
:4;

50 
ušt8_t
 
¡©us
:4;

51 
ušt8_t
 
group
:4;

52 
ušt8_t
 
ty³
:4;

54 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi1_nÙe_t
;

57 
	s_¢d_ump_msg_midi1_·f
 {

58 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


59 
ušt8_t
 
ty³
:4;

60 
ušt8_t
 
group
:4;

61 
ušt8_t
 
¡©us
:4;

62 
ušt8_t
 
chªÃl
:4;

63 
ušt8_t
 
nÙe
;

64 
ušt8_t
 
d©a
;

66 
ušt8_t
 
d©a
;

67 
ušt8_t
 
nÙe
;

68 
ušt8_t
 
chªÃl
:4;

69 
ušt8_t
 
¡©us
:4;

70 
ušt8_t
 
group
:4;

71 
ušt8_t
 
ty³
:4;

73 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi1_·f_t
;

76 
	s_¢d_ump_msg_midi1_cc
 {

77 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


78 
ušt8_t
 
ty³
:4;

79 
ušt8_t
 
group
:4;

80 
ušt8_t
 
¡©us
:4;

81 
ušt8_t
 
chªÃl
:4;

82 
ušt8_t
 
šdex
;

83 
ušt8_t
 
d©a
;

85 
ušt8_t
 
d©a
;

86 
ušt8_t
 
šdex
;

87 
ušt8_t
 
chªÃl
:4;

88 
ušt8_t
 
¡©us
:4;

89 
ušt8_t
 
group
:4;

90 
ušt8_t
 
ty³
:4;

92 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi1_cc_t
;

95 
	s_¢d_ump_msg_midi1_´og¿m
 {

96 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


97 
ušt8_t
 
ty³
:4;

98 
ušt8_t
 
group
:4;

99 
ušt8_t
 
¡©us
:4;

100 
ušt8_t
 
chªÃl
:4;

101 
ušt8_t
 
´og¿m
;

102 
ušt8_t
 
»£rved
;

104 
ušt8_t
 
»£rved
;

105 
ušt8_t
 
´og¿m
;

106 
ušt8_t
 
chªÃl
:4;

107 
ušt8_t
 
¡©us
:4;

108 
ušt8_t
 
group
:4;

109 
ušt8_t
 
ty³
:4;

111 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi1_´og¿m_t
;

114 
	s_¢d_ump_msg_midi1_ÿf
 {

115 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


116 
ušt8_t
 
ty³
:4;

117 
ušt8_t
 
group
:4;

118 
ušt8_t
 
¡©us
:4;

119 
ušt8_t
 
chªÃl
:4;

120 
ušt8_t
 
d©a
;

121 
ušt8_t
 
»£rved
;

123 
ušt8_t
 
»£rved
;

124 
ušt8_t
 
d©a
;

125 
ušt8_t
 
chªÃl
:4;

126 
ušt8_t
 
¡©us
:4;

127 
ušt8_t
 
group
:4;

128 
ušt8_t
 
ty³
:4;

130 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi1_ÿf_t
;

133 
	s_¢d_ump_msg_midi1_p™chb’d
 {

134 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


135 
ušt8_t
 
ty³
:4;

136 
ušt8_t
 
group
:4;

137 
ušt8_t
 
¡©us
:4;

138 
ušt8_t
 
chªÃl
:4;

139 
ušt8_t
 
d©a_lsb
;

140 
ušt8_t
 
d©a_msb
;

142 
ušt8_t
 
d©a_msb
;

143 
ušt8_t
 
d©a_lsb
;

144 
ušt8_t
 
chªÃl
:4;

145 
ušt8_t
 
¡©us
:4;

146 
ušt8_t
 
group
:4;

147 
ušt8_t
 
ty³
:4;

149 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi1_p™chb’d_t
;

152 
	s¢d_ump_msg_sy¡em
 {

153 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


154 
ušt8_t
 
ty³
:4;

155 
ušt8_t
 
group
:4;

156 
ušt8_t
 
¡©us
;

157 
ušt8_t
 
·rm1
;

158 
ušt8_t
 
·rm2
;

160 
ušt8_t
 
·rm1
;

161 
ušt8_t
 
·rm2
;

162 
ušt8_t
 
¡©us
;

163 
ušt8_t
 
group
:4;

164 
ušt8_t
 
ty³
:4;

166 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_sy¡em_t
;

169 
	u_¢d_ump_msg_midi1
 {

170 
¢d_ump_msg_midi1_nÙe_t
 
nÙe_Ú
;

171 
¢d_ump_msg_midi1_nÙe_t
 
nÙe_off
;

172 
¢d_ump_msg_midi1_·f_t
 
pŞy_´essu»
;

173 
¢d_ump_msg_midi1_cc_t
 
cÚŒŞ_chªge
;

174 
¢d_ump_msg_midi1_´og¿m_t
 
´og¿m_chªge
;

175 
¢d_ump_msg_midi1_ÿf_t
 
chªÃl_´essu»
;

176 
¢d_ump_msg_midi1_p™chb’d_t
 
p™chb’d
;

177 
¢d_ump_msg_sy¡em_t
 
sy¡em
;

178 
¢d_ump_msg_hdr_t
 
hdr
;

179 
ušt32_t
 
¿w
;

180 } 
	t¢d_ump_msg_midi1_t
;

184 
SND_UMP_MIDI2_NOTE_ATTR_NO_DATA
 = 0x00,

185 
SND_UMP_MIDI2_NOTE_ATTR_MANUFACTURER
 = 0x01,

186 
SND_UMP_MIDI2_NOTE_ATTR_PROFILE
 = 0x02,

187 
SND_UMP_MIDI2_NOTE_ATTR_PITCH79
 = 0x03,

191 
	s_¢d_ump_msg_midi2_nÙe
 {

192 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


193 
ušt8_t
 
ty³
:4;

194 
ušt8_t
 
group
:4;

195 
ušt8_t
 
¡©us
:4;

196 
ušt8_t
 
chªÃl
:4;

197 
ušt8_t
 
nÙe
;

198 
ušt8_t
 
©Œ_ty³
;

200 
ušt16_t
 
v–oc™y
;

201 
ušt16_t
 
©Œ_d©a
;

203 
ušt8_t
 
©Œ_ty³
;

204 
ušt8_t
 
nÙe
;

205 
ušt8_t
 
chªÃl
:4;

206 
ušt8_t
 
¡©us
:4;

207 
ušt8_t
 
group
:4;

208 
ušt8_t
 
ty³
:4;

210 
ušt16_t
 
©Œ_d©a
;

211 
ušt16_t
 
v–oc™y
;

213 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi2_nÙe_t
;

216 
	s_¢d_ump_msg_midi2_·f
 {

217 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


218 
ušt8_t
 
ty³
:4;

219 
ušt8_t
 
group
:4;

220 
ušt8_t
 
¡©us
:4;

221 
ušt8_t
 
chªÃl
:4;

222 
ušt8_t
 
nÙe
;

223 
ušt8_t
 
»£rved
;

225 
ušt32_t
 
d©a
;

227 
ušt8_t
 
»£rved
;

228 
ušt8_t
 
nÙe
;

229 
ušt8_t
 
chªÃl
:4;

230 
ušt8_t
 
¡©us
:4;

231 
ušt8_t
 
group
:4;

232 
ušt8_t
 
ty³
:4;

234 
ušt32_t
 
d©a
;

236 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi2_·f_t
;

239 
	s_¢d_ump_msg_midi2_³r_nÙe_cc
 {

240 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


241 
ušt8_t
 
ty³
:4;

242 
ušt8_t
 
group
:4;

243 
ušt8_t
 
¡©us
:4;

244 
ušt8_t
 
chªÃl
:4;

245 
ušt8_t
 
nÙe
;

246 
ušt8_t
 
šdex
;

248 
ušt32_t
 
d©a
;

250 
ušt8_t
 
šdex
;

251 
ušt8_t
 
nÙe
;

252 
ušt8_t
 
chªÃl
:4;

253 
ušt8_t
 
¡©us
:4;

254 
ušt8_t
 
group
:4;

255 
ušt8_t
 
ty³
:4;

257 
ušt32_t
 
d©a
;

259 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi2_³r_nÙe_cc_t
;

263 
SND_UMP_MIDI2_PNMGMT_RESET_CONTROLLERS
 = 0x01,

264 
SND_UMP_MIDI2_PNMGMT_DETACH_CONTROLLERS
 = 0x02,

268 
	s_¢d_ump_msg_midi2_³r_nÙe_mgmt
 {

269 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


270 
ušt8_t
 
ty³
:4;

271 
ušt8_t
 
group
:4;

272 
ušt8_t
 
¡©us
:4;

273 
ušt8_t
 
chªÃl
:4;

274 
ušt8_t
 
nÙe
;

275 
ušt8_t
 
æags
;

277 
ušt32_t
 
»£rved
;

279 
ušt8_t
 
æags
;

280 
ušt8_t
 
nÙe
;

281 
ušt8_t
 
chªÃl
:4;

282 
ušt8_t
 
¡©us
:4;

283 
ušt8_t
 
group
:4;

284 
ušt8_t
 
ty³
:4;

286 
ušt32_t
 
»£rved
;

288 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi2_³r_nÙe_mgmt_t
;

291 
	s_¢d_ump_msg_midi2_cc
 {

292 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


293 
ušt8_t
 
ty³
:4;

294 
ušt8_t
 
group
:4;

295 
ušt8_t
 
¡©us
:4;

296 
ušt8_t
 
chªÃl
:4;

297 
ušt8_t
 
šdex
;

298 
ušt8_t
 
»£rved
;

300 
ušt32_t
 
d©a
;

302 
ušt8_t
 
»£rved
;

303 
ušt8_t
 
šdex
;

304 
ušt8_t
 
chªÃl
:4;

305 
ušt8_t
 
¡©us
:4;

306 
ušt8_t
 
group
:4;

307 
ušt8_t
 
ty³
:4;

309 
ušt32_t
 
d©a
;

311 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi2_cc_t
;

314 
	s_¢d_ump_msg_midi2_½n
 {

315 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


316 
ušt8_t
 
ty³
:4;

317 
ušt8_t
 
group
:4;

318 
ušt8_t
 
¡©us
:4;

319 
ušt8_t
 
chªÃl
:4;

320 
ušt8_t
 
bªk
;

321 
ušt8_t
 
šdex
;

323 
ušt32_t
 
d©a
;

325 
ušt8_t
 
šdex
;

326 
ušt8_t
 
bªk
;

327 
ušt8_t
 
chªÃl
:4;

328 
ušt8_t
 
¡©us
:4;

329 
ušt8_t
 
group
:4;

330 
ušt8_t
 
ty³
:4;

332 
ušt32_t
 
d©a
;

334 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi2_½n_t
;

337 
	s_¢d_ump_msg_midi2_´og¿m
 {

338 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


339 
ušt8_t
 
ty³
:4;

340 
ušt8_t
 
group
:4;

341 
ušt8_t
 
¡©us
:4;

342 
ušt8_t
 
chªÃl
:4;

343 
ušt16_t
 
»£rved
:15;

344 
ušt16_t
 
bªk_v®id
:1;

346 
ušt8_t
 
´og¿m
;

347 
ušt8_t
 
»£rved2
;

348 
ušt8_t
 
bªk_msb
;

349 
ušt8_t
 
bªk_lsb
;

351 
ušt16_t
 
bªk_v®id
:1;

352 
ušt16_t
 
»£rved
:15;

353 
ušt8_t
 
chªÃl
:4;

354 
ušt8_t
 
¡©us
:4;

355 
ušt8_t
 
group
:4;

356 
ušt8_t
 
ty³
:4;

358 
ušt8_t
 
bªk_lsb
;

359 
ušt8_t
 
bªk_msb
;

360 
ušt8_t
 
»£rved2
;

361 
ušt8_t
 
´og¿m
;

363 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi2_´og¿m_t
;

366 
	s_¢d_ump_msg_midi2_ÿf
 {

367 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


368 
ušt8_t
 
ty³
:4;

369 
ušt8_t
 
group
:4;

370 
ušt8_t
 
¡©us
:4;

371 
ušt8_t
 
chªÃl
:4;

372 
ušt16_t
 
»£rved
;

374 
ušt32_t
 
d©a
;

376 
ušt16_t
 
»£rved
;

377 
ušt8_t
 
chªÃl
:4;

378 
ušt8_t
 
¡©us
:4;

379 
ušt8_t
 
group
:4;

380 
ušt8_t
 
ty³
:4;

382 
ušt32_t
 
d©a
;

384 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi2_ÿf_t
;

387 
	s_¢d_ump_msg_midi2_p™chb’d
 {

388 #ifdeà
SNDRV_BIG_ENDIAN_BITFIELD


389 
ušt8_t
 
ty³
:4;

390 
ušt8_t
 
group
:4;

391 
ušt8_t
 
¡©us
:4;

392 
ušt8_t
 
chªÃl
:4;

393 
ušt16_t
 
»£rved
;

395 
ušt32_t
 
d©a
;

397 
ušt16_t
 
»£rved
;

398 
ušt8_t
 
chªÃl
:4;

399 
ušt8_t
 
¡©us
:4;

400 
ušt8_t
 
group
:4;

401 
ušt8_t
 
ty³
:4;

403 
ušt32_t
 
d©a
;

405 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi2_p™chb’d_t
;

408 
	s_¢d_ump_msg_midi2_³r_nÙe_p™chb’d
 {

409 #ifdeà
__BIG_ENDIAN_BITFIELD


410 
ušt8_t
 
ty³
:4;

411 
ušt8_t
 
group
:4;

412 
ušt8_t
 
¡©us
:4;

413 
ušt8_t
 
chªÃl
:4;

414 
ušt8_t
 
nÙe
;

415 
ušt8_t
 
»£rved
;

417 
ušt32_t
 
d©a
;

420 
ušt8_t
 
»£rved
;

421 
ušt8_t
 
nÙe
;

422 
ušt8_t
 
chªÃl
:4;

423 
ušt8_t
 
¡©us
:4;

424 
ušt8_t
 
group
:4;

425 
ušt8_t
 
ty³
:4;

427 
ušt32_t
 
d©a
;

429 } 
	t__©Œibu‹
((
	t·cked
)è
	t¢d_ump_msg_midi2_³r_nÙe_p™chb’d_t
;

432 
	u_¢d_ump_msg_midi2
 {

433 
¢d_ump_msg_midi2_nÙe_t
 
nÙe_Ú
;

434 
¢d_ump_msg_midi2_nÙe_t
 
nÙe_off
;

435 
¢d_ump_msg_midi2_·f_t
 
pŞy_´essu»
;

436 
¢d_ump_msg_midi2_³r_nÙe_cc_t
 
³r_nÙe_acc
;

437 
¢d_ump_msg_midi2_³r_nÙe_cc_t
 
³r_nÙe_rcc
;

438 
¢d_ump_msg_midi2_³r_nÙe_mgmt_t
 
³r_nÙe_mgmt
;

439 
¢d_ump_msg_midi2_cc_t
 
cÚŒŞ_chªge
;

440 
¢d_ump_msg_midi2_½n_t
 
½n
;

441 
¢d_ump_msg_midi2_½n_t
 
Ä²
;

442 
¢d_ump_msg_midi2_½n_t
 
»Ïtive_½n
;

443 
¢d_ump_msg_midi2_½n_t
 
»Ïtive_Ä²
;

444 
¢d_ump_msg_midi2_´og¿m_t
 
´og¿m_chªge
;

445 
¢d_ump_msg_midi2_ÿf_t
 
chªÃl_´essu»
;

446 
¢d_ump_msg_midi2_p™chb’d_t
 
p™chb’d
;

447 
¢d_ump_msg_midi2_³r_nÙe_p™chb’d_t
 
³r_nÙe_p™chb’d
;

448 
¢d_ump_msg_hdr_t
 
hdr
;

449 
ušt32_t
 
¿w
[2];

450 } 
	t¢d_ump_msg_midi2_t
;

456 
SND_UMP_MSG_TYPE_UTILITY
 = 0x00,

457 
SND_UMP_MSG_TYPE_SYSTEM
 = 0x01,

458 
SND_UMP_MSG_TYPE_MIDI1_CHANNEL_VOICE
 = 0x02,

459 
SND_UMP_MSG_TYPE_DATA
 = 0x03,

460 
SND_UMP_MSG_TYPE_MIDI2_CHANNEL_VOICE
 = 0x04,

461 
SND_UMP_MSG_TYPE_EXTENDED_DATA
 = 0x05,

462 
SND_UMP_MSG_TYPE_FLEX_DATA
 = 0x0d,

463 
SND_UMP_MSG_TYPE_STREAM
 = 0x0f,

470 
SND_UMP_MSG_PER_NOTE_RCC
 = 0x0,

471 
SND_UMP_MSG_PER_NOTE_ACC
 = 0x1,

472 
SND_UMP_MSG_RPN
 = 0x2,

473 
SND_UMP_MSG_NRPN
 = 0x3,

474 
SND_UMP_MSG_RELATIVE_RPN
 = 0x4,

475 
SND_UMP_MSG_RELATIVE_NRPN
 = 0x5,

476 
SND_UMP_MSG_PER_NOTE_PITCHBEND
 = 0x6,

477 
SND_UMP_MSG_NOTE_OFF
 = 0x8,

478 
SND_UMP_MSG_NOTE_ON
 = 0x9,

479 
SND_UMP_MSG_POLY_PRESSURE
 = 0xa,

480 
SND_UMP_MSG_CONTROL_CHANGE
 = 0xb,

481 
SND_UMP_MSG_PROGRAM_CHANGE
 = 0xc,

482 
SND_UMP_MSG_CHANNEL_PRESSURE
 = 0xd,

483 
SND_UMP_MSG_PITCHBEND
 = 0xe,

484 
SND_UMP_MSG_PER_NOTE_MGMT
 = 0xf,

491 
SND_UMP_MSG_REALTIME
 = 0xf0,

492 
SND_UMP_MSG_SYSEX_START
 = 0xf0,

493 
SND_UMP_MSG_MIDI_TIME_CODE
 = 0xf1,

494 
SND_UMP_MSG_SONG_POSITION
 = 0xf2,

495 
SND_UMP_MSG_SONG_SELECT
 = 0xf3,

496 
SND_UMP_MSG_TUNE_REQUEST
 = 0xf6,

497 
SND_UMP_MSG_SYSEX_END
 = 0xf7,

498 
SND_UMP_MSG_TIMING_CLOCK
 = 0xf8,

499 
SND_UMP_MSG_START
 = 0xfa,

500 
SND_UMP_MSG_CONTINUE
 = 0xfb,

501 
SND_UMP_MSG_STOP
 = 0xfc,

502 
SND_UMP_MSG_ACTIVE_SENSING
 = 0xfe,

503 
SND_UMP_MSG_RESET
 = 0xff,

508 
SND_UMP_SYSEX_STATUS_SINGLE
 = 0,

509 
SND_UMP_SYSEX_STATUS_START
 = 1,

510 
SND_UMP_SYSEX_STATUS_CONTINUE
 = 2,

511 
SND_UMP_SYSEX_STATUS_END
 = 3,

516 
SND_UMP_UTILITY_MSG_STATUS_NOOP
 = 0x00,

517 
SND_UMP_UTILITY_MSG_STATUS_JR_CLOCK
 = 0x01,

518 
SND_UMP_UTILITY_MSG_STATUS_JR_TSTAMP
 = 0x02,

519 
SND_UMP_UTILITY_MSG_STATUS_DCTPQ
 = 0x03,

520 
SND_UMP_UTILITY_MSG_STATUS_DC
 = 0x04,

525 
SND_UMP_STREAM_MSG_STATUS_EP_DISCOVERY
 = 0x00,

526 
SND_UMP_STREAM_MSG_STATUS_EP_INFO
 = 0x01,

527 
SND_UMP_STREAM_MSG_STATUS_DEVICE_INFO
 = 0x02,

528 
SND_UMP_STREAM_MSG_STATUS_EP_NAME
 = 0x03,

529 
SND_UMP_STREAM_MSG_STATUS_PRODUCT_ID
 = 0x04,

530 
SND_UMP_STREAM_MSG_STATUS_STREAM_CFG_REQUEST
 = 0x05,

531 
SND_UMP_STREAM_MSG_STATUS_STREAM_CFG
 = 0x06,

532 
SND_UMP_STREAM_MSG_STATUS_FB_DISCOVERY
 = 0x10,

533 
SND_UMP_STREAM_MSG_STATUS_FB_INFO
 = 0x11,

534 
SND_UMP_STREAM_MSG_STATUS_FB_NAME
 = 0x12,

535 
SND_UMP_STREAM_MSG_STATUS_START_CLIP
 = 0x20,

536 
SND_UMP_STREAM_MSG_STATUS_END_CLIP
 = 0x21,

541 
SND_UMP_STREAM_MSG_REQUEST_EP_INFO
 = (1U << 0),

542 
SND_UMP_STREAM_MSG_REQUEST_DEVICE_INFO
 = (1U << 1),

543 
SND_UMP_STREAM_MSG_REQUEST_EP_NAME
 = (1U << 2),

544 
SND_UMP_STREAM_MSG_REQUEST_PRODUCT_ID
 = (1U << 3),

545 
SND_UMP_STREAM_MSG_REQUEST_STREAM_CFG
 = (1U << 4),

550 
SND_UMP_STREAM_MSG_REQUEST_FB_INFO
 = (1U << 0),

551 
SND_UMP_STREAM_MSG_REQUEST_FB_NAME
 = (1U << 1),

556 
SND_UMP_STREAM_MSG_EP_INFO_CAP_TXJR
 = (1U << 0),

557 
SND_UMP_STREAM_MSG_EP_INFO_CAP_RXJR
 = (1U << 1),

558 
SND_UMP_STREAM_MSG_EP_INFO_CAP_MIDI1
 = (1U << 8),

559 
SND_UMP_STREAM_MSG_EP_INFO_CAP_MIDI2
 = (1U << 9),

564 
SND_UMP_STREAM_MSG_FORMAT_SINGLE
 = 0,

565 
SND_UMP_STREAM_MSG_FORMAT_START
 = 1,

566 
SND_UMP_STREAM_MSG_FORMAT_CONTINUE
 = 2,

567 
SND_UMP_STREAM_MSG_FORMAT_END
 = 3,

573 
šlše
 
ušt8_t
 
¢d_ump_msg_hdr_¡©us
(
ušt32_t
 
ump
)

575  (
ump
 >> 20) & 0x0f;

581 
šlše
 
ušt8_t
 
¢d_ump_msg_hdr_chªÃl
(
ušt32_t
 
ump
)

583  (
ump
 >> 16) & 0x0f;

589 
šlše
 
ušt8_t
 
¢d_ump_msg_hdr_ty³
(
ušt32_t
 
ump
)

591  (
ump
 >> 28);

597 
šlše
 
¢d_ump_msg_ty³_is_grou¶ess
(
ušt8_t
 
ty³
)

599  
ty³
 =ğ
SND_UMP_MSG_TYPE_UTILITY
 ||y³ =ğ
SND_UMP_MSG_TYPE_STREAM
;

605 
šlše
 
ušt8_t
 
¢d_ump_msg_hdr_group
(
ušt32_t
 
ump
)

607  (
ump
 >> 24) & 0x0f;

613 
šlše
 
ušt8_t
 
¢d_ump_msg_¡©us
(cÚ¡ 
ušt32_t
 *
ump
)

615  
¢d_ump_msg_hdr_¡©us
(*
ump
);

621 
šlše
 
ušt8_t
 
¢d_ump_msg_chªÃl
(cÚ¡ 
ušt32_t
 *
ump
)

623  
¢d_ump_msg_hdr_chªÃl
(*
ump
);

629 
šlše
 
ušt8_t
 
¢d_ump_msg_ty³
(cÚ¡ 
ušt32_t
 *
ump
)

631  
¢d_ump_msg_hdr_ty³
(*
ump
);

637 
šlše
 
ušt8_t
 
¢d_ump_msg_group
(cÚ¡ 
ušt32_t
 *
ump
)

639  
¢d_ump_msg_hdr_group
(*
ump
);

645 
šlše
 
ušt8_t
 
¢d_ump_sy£x_msg_¡©us
(cÚ¡ 
ušt32_t
 *
ump
)

647  (*
ump
 >> 20) & 0xf;

653 
šlše
 
ušt8_t
 
¢d_ump_sy£x_msg_Ëngth
(cÚ¡ 
ušt32_t
 *
ump
)

655  (*
ump
 >> 16) & 0xf;

658 
¢d_ump_msg_sy£x_ex·nd
(cÚ¡ 
ušt32_t
 *
ump
, 
ušt8_t
 *
buf
, 
size_t
 
maxËn
,

659 
size_t
 *
fËd
);

661 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/use-case.h

38 #iâdeà
__ALSA_USE_CASE_H


39 
	#__ALSA_USE_CASE_H


	)

41 #ifdeà
__ılu¥lus


45 
	~<®§/asoundlib.h
>

100 
	#SND_USE_CASE_VERB_INACTIVE
 "IÇùive"

	)

101 
	#SND_USE_CASE_VERB_HIFI
 "HiFi"

	)

102 
	#SND_USE_CASE_VERB_HIFI_LOW_POWER
 "HiF˜Low Pow”"

	)

103 
	#SND_USE_CASE_VERB_VOICE
 "Voiû"

	)

104 
	#SND_USE_CASE_VERB_VOICE_LOW_POWER
 "Voiû Low Pow”"

	)

105 
	#SND_USE_CASE_VERB_VOICECALL
 "Voiû C®l"

	)

106 
	#SND_USE_CASE_VERB_IP_VOICECALL
 "Voiû C®ÈIP"

	)

107 
	#SND_USE_CASE_VERB_ANALOG_RADIO
 "FM AÇlog Radio"

	)

108 
	#SND_USE_CASE_VERB_DIGITAL_RADIO
 "FM Dig™® Radio"

	)

132 
	#SND_USE_CASE_DEV_NONE
 "NÚe"

	)

133 
	#SND_USE_CASE_DEV_SPEAKER
 "S³ak”"

	)

134 
	#SND_USE_CASE_DEV_LINE
 "Lše"

	)

135 
	#SND_USE_CASE_DEV_MIC
 "Mic"

	)

136 
	#SND_USE_CASE_DEV_HEADPHONES
 "H—dphÚes"

	)

137 
	#SND_USE_CASE_DEV_HEADSET
 "H—d£t"

	)

138 
	#SND_USE_CASE_DEV_HANDSET
 "Hªd£t"

	)

139 
	#SND_USE_CASE_DEV_BLUETOOTH
 "Blu‘oÙh"

	)

140 
	#SND_USE_CASE_DEV_EARPIECE
 "E¬p›û"

	)

141 
	#SND_USE_CASE_DEV_SPDIF
 "SPDIF"

	)

142 
	#SND_USE_CASE_DEV_HDMI
 "HDMI"

	)

143 
	#SND_USE_CASE_DEV_USB
 "USB"

	)

144 
	#SND_USE_CASE_DEV_DIRECT
 "Dœeù"

	)

173 
	#SND_USE_CASE_MOD_CAPTURE_VOICE
 "C­tu» Voiû"

	)

174 
	#SND_USE_CASE_MOD_CAPTURE_MUSIC
 "C­tu» Music"

	)

175 
	#SND_USE_CASE_MOD_PLAY_MUSIC
 "PÏy Music"

	)

176 
	#SND_USE_CASE_MOD_PLAY_VOICE
 "PÏy Voiû"

	)

177 
	#SND_USE_CASE_MOD_PLAY_TONE
 "PÏy TÚe"

	)

178 
	#SND_USE_CASE_MOD_ECHO_REF
 "EchØReã»nû"

	)

190 
	#SND_USE_CASE_TQ_MUSIC
 "Music"

	)

191 
	#SND_USE_CASE_TQ_VOICE
 "Voiû"

	)

192 
	#SND_USE_CASE_TQ_TONES
 "TÚes"

	)

195 
¢d_u£_ÿ£_mgr
 
	t¢d_u£_ÿ£_mgr_t
;

203 *
¢d_u£_ÿ£_id’tif›r
(cÚ¡ *
fmt
, ...);

211 
¢d_u£_ÿ£_ä“_li¡
(cÚ¡ *
li¡
[], 
™ems
);

241 
¢d_u£_ÿ£_g‘_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

242 cÚ¡ *
id’tif›r
,

243 cÚ¡ **
li¡
[]);

412 
¢d_u£_ÿ£_g‘
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

413 cÚ¡ *
id’tif›r
,

414 cÚ¡ **
v®ue
);

427 
¢d_u£_ÿ£_g‘i
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

428 cÚ¡ *
id’tif›r
,

429 *
v®ue
);

458 
¢d_u£_ÿ£_£t
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

459 cÚ¡ *
id’tif›r
,

460 cÚ¡ *
v®ue
);

484 
¢d_u£_ÿ£_mgr_İ’
(
¢d_u£_ÿ£_mgr_t
 **
uc_mgr
,

485 cÚ¡ *
ÿrd_Çme
);

493 
¢d_u£_ÿ£_mgr_»lßd
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
);

500 
¢d_u£_ÿ£_mgr_şo£
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
);

507 
¢d_u£_ÿ£_mgr_»£t
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
);

518 
__šlše__
 
¢d_u£_ÿ£_ÿrd_li¡
(cÚ¡ **
li¡
[])

520  
¢d_u£_ÿ£_g‘_li¡
(
NULL
, NULL, 
li¡
);

529 
__šlše__
 
¢d_u£_ÿ£_v”b_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

530 cÚ¡ **
li¡
[])

532  
¢d_u£_ÿ£_g‘_li¡
(
uc_mgr
, "_v”bs", 
li¡
);

542 
¢d_u£_ÿ£_·r£_ùl_–em_id
(
¢d_ùl_–em_id_t
 *
d¡
,

543 cÚ¡ *
ucm_id
,

544 cÚ¡ *
v®ue
);

553 
¢d_u£_ÿ£_·r£_£Ëm_id
(
¢d_mix”_£Ëm_id_t
 *
d¡
,

554 cÚ¡ *
ucm_id
,

555 cÚ¡ *
v®ue
);

561 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/ac97.c

22 
	~<¡dio.h
>

23 
	~<¡dlib.h
>

24 
	~<uni¡d.h
>

25 
	~<¡ršg.h
>

26 
	~<fú.h
>

27 
	~<sys/ioùl.h
>

28 
	~<m©h.h
>

29 
	~"asoundlib.h
"

30 
	~"mix”_ab¡.h
"

31 
	~"sba£.h
"

33 
sm_–em_İs
 
	gsim¶e_ac97_İs
;

35 
m–em_sids
 
	gsids
[] = {

37 .
sid
 = 
SID_MASTER
,

38 .
	g¢ame
 = "Master",

39 .
	gsšdex
 = 0,

40 .
	gweight
 = 1,

41 .
	gchªm­
 = { 3, 0 },

42 .
	gsİs
 = &
sim¶e_ac97_İs
,

46 
	#SELECTORS
 ((
£ËùÜs
)/(£ËùÜs[0]))

	)

48 
h–em_£ËùÜ
 
	g£ËùÜs
[] = {

50 .
içû
 = 
SND_CTL_ELEM_IFACE_MIXER
,

51 .
	gÇme
 = "Master Playback Volume",

52 .
	gšdex
 = 0,

53 .
	gsid
 = 
SID_MASTER
,

54 .
	gpu½o£
 = 
PURPOSE_VOLUME
,

55 .
	gÿps
 = 
SM_CAP_PVOLUME
,

58 .
	giçû
 = 
SND_CTL_ELEM_IFACE_MIXER
,

59 .
	gÇme
 = "Master Playback Switch",

60 .
	gšdex
 = 0,

61 .
	gsid
 = 
SID_MASTER
,

62 .
	gpu½o£
 = 
PURPOSE_SWITCH
,

63 .
	gÿps
 = 
SM_CAP_PSWITCH
,

67 
	$®§_mix”_sim¶e_ev’t
(
¢d_mix”_şass_t
 *
şass
, 
mask
,

68 
¢d_hùl_–em_t
 *
h–em
, 
¢d_mix”_–em_t
 *
m–em
)

70 
bşass_´iv©e
 *
´iv
 = 
	`¢d_mix”_sbasic_g‘_´iv©e
(
şass
);

71  
´iv
->
İs
.
	`ev’t
(
şass
, 
mask
, 
h–em
, 
m–em
);

72 
	}
}

74 
	$®§_mix”_sim¶e_š™
(
¢d_mix”_şass_t
 *
şass
)

76 
bşass_ba£_İs
 *
İs
;

77 
”r
;

79 
”r
 = 
	`mix”_sim¶e_basic_dlİ’
(
şass
, &
İs
);

80 ià(
”r
 < 0)

82 
”r
 = 
İs
->
	`£Ìeg
(
şass
, 
£ËùÜs
, 
SELECTORS
);

83 ià(
”r
 < 0)

84  
”r
;

85 
”r
 = 
İs
->
	`sid»g
(
şass
, 
sids
, 
SELECTORS
);

86 ià(
”r
 < 0)

87  
”r
;

89 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/hda.c

23 
	~<¡dio.h
>

24 
	~<¡dlib.h
>

25 
	~<uni¡d.h
>

26 
	~<¡ršg.h
>

27 
	~<fú.h
>

28 
	~<sys/ioùl.h
>

29 
	~<m©h.h
>

30 
	~"asoundlib.h
"

31 
	~"mix”_ab¡.h
"

32 
	~"sba£.h
"

34 
sm_–em_İs
 
	gsim¶e_hda_İs
;

36 
m–em_sids
 
	gsids
[] = {

38 .
sid
 = 
SID_FRONT
,

39 .
	g¢ame
 = "Front",

40 .
	gsšdex
 = 0,

41 .
	gweight
 = 1,

42 .
	gchªm­
 = { 3, 0 },

43 .
	gsİs
 = &
sim¶e_hda_İs
,

47 
	#SELECTORS
 ((
£ËùÜs
)/(£ËùÜs[0]))

	)

49 
h–em_£ËùÜ
 
	g£ËùÜs
[] = {

51 .
içû
 = 
SND_CTL_ELEM_IFACE_MIXER
,

52 .
	gÇme
 = "Front Playback Volume",

53 .
	gšdex
 = 0,

54 .
	gsid
 = 
SID_FRONT
,

55 .
	gpu½o£
 = 
PURPOSE_VOLUME
,

56 .
	gÿps
 = 
SM_CAP_PVOLUME
,

59 .
	giçû
 = 
SND_CTL_ELEM_IFACE_MIXER
,

60 .
	gÇme
 = "Front Playback Switch",

61 .
	gšdex
 = 0,

62 .
	gsid
 = 
SID_FRONT
,

63 .
	gpu½o£
 = 
PURPOSE_SWITCH
,

64 .
	gÿps
 = 
SM_CAP_PSWITCH
,

68 
	$®§_mix”_sim¶e_ev’t
(
¢d_mix”_şass_t
 *
şass
, 
mask
,

69 
¢d_hùl_–em_t
 *
h–em
, 
¢d_mix”_–em_t
 *
m–em
)

71 
bşass_´iv©e
 *
´iv
 = 
	`¢d_mix”_sbasic_g‘_´iv©e
(
şass
);

72  
´iv
->
İs
.
	`ev’t
(
şass
, 
mask
, 
h–em
, 
m–em
);

73 
	}
}

75 
	$®§_mix”_sim¶e_š™
(
¢d_mix”_şass_t
 *
şass
)

77 
bşass_ba£_İs
 *
İs
;

78 
”r
;

80 
”r
 = 
	`mix”_sim¶e_basic_dlİ’
(
şass
, &
İs
);

81 ià(
”r
 < 0)

83 
”r
 = 
İs
->
	`£Ìeg
(
şass
, 
£ËùÜs
, 
SELECTORS
);

84 ià(
”r
 < 0)

85  
”r
;

86 
”r
 = 
İs
->
	`sid»g
(
şass
, 
sids
, 
SELECTORS
);

87 ià(
”r
 < 0)

88  
”r
;

90 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/python.c

22 
	~"PythÚ.h
"

23 
	~<¡ddef.h
>

24 
	~<lim™s.h
>

25 
	~"cÚfig.h
"

26 
	~"asoundlib.h
"

27 
	~"mix”_ab¡.h
"

29 #ià(
__GNUC__
 > 4 || (__GNUC__ =ğ4 && 
__GNUC_MINOR__
 >= 2))

30 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wstrict-aliasing"

33 
	spythÚ_´iv
 {

34 
	mpy_š™Ÿlized
;

35 
PyObjeù
 *
	mpy_ev’t_func
;

36 
PyObjeù
 *
	mpy_mdiù
;

37 
PyObjeù
 *
	mpy_mix”
;

40 
	#SCRIPT
 "smix”/pythÚ/maš.py"

	)

42 
	spym–em
 {

43 
PyObjeù_HEAD


44 
sm_£Ëm_t
 
	m£Ëm
;

45 
PyObjeù
 *
	mpy_mix”
;

46 
¢d_mix”_–em_t
 *
	mm–em
;

49 
	spymix”
 {

50 
PyObjeù_HEAD


51 
¢d_mix”_şass_t
 *
	mşass
;

52 
¢d_mix”_t
 *
	mmix”
;

53 
PyObjeù
 *
	mmdiù
;

54 
	mhùl_couÁ
;

55 **
	mhùl
;

56 
	mh–em_couÁ
;

57 **
	mh–em
;

58 
	mm–em_couÁ
;

59 **
	mm–em
;

62 
PyIÁ”´‘”S‹
 *
	gmaš_š‹½»‹r
;

64 #ià
PY_MAJOR_VERSION
 >= 3

65 
	#PyIÁ_FromLÚg
 
PyLÚg_FromLÚg


	)

68 
šlše
 
	$g‘_lÚg
(
PyObjeù
 *
o
, *
v®
)

70 #ià
PY_MAJOR_VERSION
 < 3

71 ià(
	`PyIÁ_Check
(
o
)) {

72 *
v®
 = 
	`PyIÁ_AsLÚg
(
o
);

76 ià(
	`PyLÚg_Check
(
o
)) {

77 *
v®
 = 
	`PyLÚg_AsLÚg
(
o
);

81 
	}
}

83 
šlše
 
PyObjeù
 *
	$IÁ”nFromSŒšg
(cÚ¡ *
Çme
)

85 #ià
PY_MAJOR_VERSION
 < 3

86  
	`PySŒšg_IÁ”nFromSŒšg
(
Çme
);

88  
	`PyUnicode_IÁ”nFromSŒšg
(
Çme
);

90 
	}
}

92 *
	$g‘_C_±r
(
PyObjeù
 *
obj
, cÚ¡ *
©Œ
)

94 
PyObjeù
 *
o
;

95 
v®
;

97 
o
 = 
	`PyObjeù_G‘A‰r
(
obj
, 
	`IÁ”nFromSŒšg
(
©Œ
));

98 ià(!
o
) {

99 
	`PyE¼_FÜm©
(
PyExc_Ty³E¼Ü
, "missšg '%s'‡‰ribu‹", 
©Œ
);

100  
NULL
;

102 ià(
	`g‘_lÚg
(
o
, &
v®
)) {

103 
	`PyE¼_FÜm©
(
PyExc_Ty³E¼Ü
, "'%s'‡‰ribu‹ i nÙ IÁ o¸LÚg", 
©Œ
);

104  
NULL
;

106  (*)
v®
;

107 
	}
}

109 
pym–em
 *
	$m–em_to_pym–em
(
¢d_mix”_–em_t
 *
–em
)

111  (
pym–em
 *)((*)
	`¢d_mix”_–em_g‘_´iv©e
(
–em
è- 
	`off£tof
(pym–em, 
£Ëm
));

112 
	}
}

114 
	$pÿÎ
(
pym–em
 *pym–em, cÚ¡ *
©Œ
, 
PyObjeù
 *
¬gs
, PyObjeù **
_»s
)

116 
PyObjeù
 *
obj
 = (PyObjeù *)
pym–em
, *
»s
;

117 
x»s
 = 0;

119 ià(
_»s
)

120 *
_»s
 = 
NULL
;

121 
obj
 = 
	`PyObjeù_G‘A‰r
(obj, 
	`IÁ”nFromSŒšg
(
©Œ
));

122 ià(!
obj
) {

123 
	`PyE¼_FÜm©
(
PyExc_Ty³E¼Ü
, "missšg '%s'‡‰ribu‹", 
©Œ
);

124 
	`PyE¼_Pršt
();

125 
	`PyE¼_CË¬
();

126 
	`Py_DECREF
(
¬gs
);

127  -
EIO
;

129 
»s
 = 
	`PyObjeù_C®lObjeù
(
obj
, 
¬gs
);

130 
	`Py_XDECREF
(
¬gs
);

131 ià(
»s
 =ğ
NULL
) {

132 
	`PyE¼_Pršt
();

133 
	`PyE¼_CË¬
();

134  -
EIO
;

136 ià(
_»s
 && 
	`PyTu¶e_Check
(
»s
)) {

137 *
_»s
 = 
»s
;

138 
»s
 = 
	`PyTu¶e_G‘I‹m
(res, 0);

140 ià(
	`PyLÚg_Check
(
»s
)) {

141 
x»s
 = 
	`PyLÚg_AsLÚg
(
»s
);

142 #ià
PY_MAJOR_VERSION
 < 3

143 } ià(
	`PyIÁ_Check
(
»s
)) {

144 
x»s
 = 
	`PyIÁ_AsLÚg
(
»s
);

146 } ià(
»s
 =ğ
Py_NÚe
) {

147 
x»s
 = 0;

148 } ià(
	`PyBoŞ_Check
(
»s
)) {

149 
x»s
 = 
»s
 =ğ
Py_True
;

151 
	`PyE¼_FÜm©
(
PyExc_Ty³E¼Ü
, "wrÚg„esuÉ from '%s'!", 
©Œ
);

152 
	`PyE¼_Pršt
();

153 
	`PyE¼_CË¬
();

154 
	`Py_DECREF
(
»s
);

155 ià(
_»s
)

156 *
_»s
 = 
NULL
;

157  -
EIO
;

159 ià(
_»s
 && *_res)

160  
x»s
;

161 
	`Py_DECREF
(
»s
);

162  
x»s
;

163 
	}
}

165 
	$is_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
, 
cmd
, 
v®
)

167 
PyObjeù
 *
obj1
;

168 
pym–em
 *pym–em = 
	`m–em_to_pym–em
(
–em
);

169 *
s
, 
fú
[32] = "opsIs";

170 
»s
, 
xdœ
 = 1, 
xv®
 = 0;

172 
cmd
) {

173 
SM_OPS_IS_ACTIVE
: 
s
 = "Aùive"; 
xdœ
 = 0; ;

174 
SM_OPS_IS_MONO
: 
s
 = "Mono"; ;

175 
SM_OPS_IS_CHANNEL
: 
s
 = "ChªÃl"; 
xv®
 = 1; ;

176 
SM_OPS_IS_ENUMERATED
: 
s
 = "Enum”©ed"; 
xdœ
 = 
v®
 == 1; ;

177 
SM_OPS_IS_ENUMCNT
: 
s
 = "EnumCnt"; ;

181 
	`¡rÿt
(
fú
, 
s
);

183 
obj1
 = 
	`PyTu¶e_New
(
xdœ
 + 
xv®
);

184 ià(
xdœ
) {

185 
	`PyTu¶e_SET_ITEM
(
obj1
, 0, 
	`PyIÁ_FromLÚg
(
dœ
));

186 ià(
xv®
)

187 
	`PyTu¶e_SET_ITEM
(
obj1
, 1, 
	`PyIÁ_FromLÚg
(
v®
));

189 
»s
 = 
	`pÿÎ
(
pym–em
, 
fú
, 
obj1
, 
NULL
);

190  
»s
 < 0 ? 0 :„es;

191 
	}
}

193 
	$g‘_x_¿nge_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

194 *
mš
, *
max
, cÚ¡ *
©Œ
)

196 
PyObjeù
 *
obj1
, *
t1
, *
t2
, *
»s
;

197 
pym–em
 *pym–em = 
	`m–em_to_pym–em
(
–em
);

198 
”r
;

200 
obj1
 = 
	`PyTu¶e_New
(1);

201 
	`PyTu¶e_SET_ITEM
(
obj1
, 0, 
	`PyIÁ_FromLÚg
(
dœ
));

202 
”r
 = 
	`pÿÎ
(
pym–em
, 
©Œ
, 
obj1
, &
»s
);

203 ià(
”r
 >= 0) {

204 
t1
 = 
	`PyTu¶e_G‘I‹m
(
»s
, 1);

205 
t2
 = 
	`PyTu¶e_G‘I‹m
(
»s
, 2);

206 ià(
	`PyLÚg_Check
(
t1
è&& PyLÚg_Check(
t2
)) {

207 *
mš
 = 
	`PyLÚg_AsLÚg
(
	`PyTu¶e_G‘I‹m
(
»s
, 1));

208 *
max
 = 
	`PyLÚg_AsLÚg
(
	`PyTu¶e_G‘I‹m
(
»s
, 2));

209 
”r
 = 0;

210 #ià
PY_MAJOR_VERSION
 < 3

211 } ià(
	`PyIÁ_Check
(
t1
è&& PyIÁ_Check(
t2
)) {

212 *
mš
 = 
	`PyIÁ_AsLÚg
(
	`PyTu¶e_G‘I‹m
(
»s
, 1));

213 *
max
 = 
	`PyIÁ_AsLÚg
(
	`PyTu¶e_G‘I‹m
(
»s
, 2));

214 
”r
 = 0;

217 
	`PyE¼_FÜm©
(
PyExc_Ty³E¼Ü
, "wrong„esult (invaliduple)");

218 
	`PyE¼_Pršt
();

219 
	`PyE¼_CË¬
();

220 
”r
 = -
EIO
;

223 
	`Py_XDECREF
(
»s
);

224  
”r
;

225 
	}
}

227 
	$g‘_¿nge_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

228 *
mš
, *
max
)

230  
	`g‘_x_¿nge_İs
(
–em
, 
dœ
, 
mš
, 
max
, "opsGetRange");

231 
	}
}

233 
	$£t_¿nge_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

234 
mš
, 
max
)

236 
PyObjeù
 *
obj1
;

237 
pym–em
 *pym–em = 
	`m–em_to_pym–em
(
–em
);

239 
obj1
 = 
	`PyTu¶e_New
(3);

240 
	`PyTu¶e_SET_ITEM
(
obj1
, 0, 
	`PyIÁ_FromLÚg
(
dœ
));

241 
	`PyTu¶e_SET_ITEM
(
obj1
, 1, 
	`PyIÁ_FromLÚg
(
mš
));

242 
	`PyTu¶e_SET_ITEM
(
obj1
, 2, 
	`PyIÁ_FromLÚg
(
max
));

243  
	`pÿÎ
(
pym–em
, "İsG‘Rªge", 
obj1
, 
NULL
);

244 
	}
}

246 
	$g‘_x_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

247 
chªÃl
, *
v®ue
,

248 cÚ¡ *
©Œ
)

250 
PyObjeù
 *
obj1
, *
t1
, *
»s
;

251 
pym–em
 *pym–em = 
	`m–em_to_pym–em
(
–em
);

252 
”r
;

254 
obj1
 = 
	`PyTu¶e_New
(2);

255 
	`PyTu¶e_SET_ITEM
(
obj1
, 0, 
	`PyIÁ_FromLÚg
(
dœ
));

256 
	`PyTu¶e_SET_ITEM
(
obj1
, 1, 
	`PyIÁ_FromLÚg
(
chªÃl
));

257 
”r
 = 
	`pÿÎ
(
pym–em
, 
©Œ
, 
obj1
, &
»s
);

258 ià(
”r
 >= 0) {

259 
t1
 = 
	`PyTu¶e_G‘I‹m
(
»s
, 1);

260 ià(
	`PyLÚg_Check
(
t1
)) {

261 *
v®ue
 = 
	`PyLÚg_AsLÚg
(
t1
);

262 
”r
 = 0;

263 #ià
PY_MAJOR_VERSION
 < 3

264 } ià(
	`PyIÁ_Check
(
t1
)) {

265 *
v®ue
 = 
	`PyIÁ_AsLÚg
(
t1
);

266 
”r
 = 0;

269 
	`PyE¼_FÜm©
(
PyExc_Ty³E¼Ü
, "wrong„esult (invaliduple)");

270 
	`PyE¼_Pršt
();

271 
	`PyE¼_CË¬
();

272 
”r
 = -
EIO
;

275 
	`Py_XDECREF
(
»s
);

276  
”r
;

277 
	}
}

279 
	$g‘_vŞume_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

280 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
)

282  
	`g‘_x_İs
(
–em
, 
dœ
, 
chªÃl
, 
v®ue
, "opsGetVolume");

283 
	}
}

285 
	$g‘_sw™ch_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

286 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
)

288 
v®ue1
;

289 
»s
;

290 
»s
 = 
	`g‘_x_İs
(
–em
, 
dœ
, 
chªÃl
, &
v®ue1
, "opsGetSwitch");

291 *
v®ue
 = 
v®ue1
;

292  
»s
;

293 
	}
}

295 
	$ask_vŞ_dB_İs
(
¢d_mix”_–em_t
 *
–em
,

296 
dœ
,

297 
v®ue
,

298 *
dbV®ue
)

300  
	`g‘_x_İs
(
–em
, 
dœ
, 
v®ue
, 
dbV®ue
, "opsGetVolDB");

301 
	}
}

303 
	$ask_dB_vŞ_İs
(
¢d_mix”_–em_t
 *
–em
,

304 
dœ
,

305 
v®ue
,

306 *
dbV®ue
,

307 
xdœ
)

309 
PyObjeù
 *
obj1
, *
t1
, *
»s
;

310 
pym–em
 *pym–em = 
	`m–em_to_pym–em
(
–em
);

311 
”r
;

313 
obj1
 = 
	`PyTu¶e_New
(3);

314 
	`PyTu¶e_SET_ITEM
(
obj1
, 0, 
	`PyIÁ_FromLÚg
(
dœ
));

315 
	`PyTu¶e_SET_ITEM
(
obj1
, 1, 
	`PyIÁ_FromLÚg
(
v®ue
));

316 
	`PyTu¶e_SET_ITEM
(
obj1
, 2, 
	`PyIÁ_FromLÚg
(
xdœ
));

317 
”r
 = 
	`pÿÎ
(
pym–em
, "İsG‘DBVŞ", 
obj1
, &
»s
);

318 ià(
”r
 >= 0) {

319 
t1
 = 
	`PyTu¶e_G‘I‹m
(
»s
, 1);

320 ià(
	`PyLÚg_Check
(
t1
)) {

321 *
dbV®ue
 = 
	`PyLÚg_AsLÚg
(
t1
);

322 
”r
 = 0;

323 #ià
PY_MAJOR_VERSION
 < 3

324 } ià(
	`PyIÁ_Check
(
t1
)) {

325 *
dbV®ue
 = 
	`PyIÁ_AsLÚg
(
t1
);

326 
”r
 = 0;

329 
	`PyE¼_FÜm©
(
PyExc_Ty³E¼Ü
, "wrong„esult (invaliduple)");

330 
	`PyE¼_Pršt
();

331 
	`PyE¼_CË¬
();

332 
”r
 = -
EIO
;

335 
	`Py_XDECREF
(
»s
);

336  
”r
;

337 
	}
}

339 
	$g‘_dB_İs
(
¢d_mix”_–em_t
 *
–em
,

340 
dœ
,

341 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
,

342 *
v®ue
)

344  
	`g‘_x_İs
(
–em
, 
dœ
, 
chªÃl
, 
v®ue
, "opsGetDB");

345 
	}
}

347 
	$g‘_dB_¿nge_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

348 *
mš
, *
max
)

350  
	`g‘_x_¿nge_İs
(
–em
, 
dœ
, 
mš
, 
max
, "opsGetDBRange");

351 
	}
}

353 
	$£t_vŞume_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

354 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
)

356 
PyObjeù
 *
obj1
;

357 
pym–em
 *pym–em = 
	`m–em_to_pym–em
(
–em
);

359 
obj1
 = 
	`PyTu¶e_New
(3);

360 
	`PyTu¶e_SET_ITEM
(
obj1
, 0, 
	`PyIÁ_FromLÚg
(
dœ
));

361 
	`PyTu¶e_SET_ITEM
(
obj1
, 1, 
	`PyIÁ_FromLÚg
(
chªÃl
));

362 
	`PyTu¶e_SET_ITEM
(
obj1
, 2, 
	`PyIÁ_FromLÚg
(
v®ue
));

363  
	`pÿÎ
(
pym–em
, "İsS‘VŞume", 
obj1
, 
NULL
);

364 
	}
}

366 
	$£t_sw™ch_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

367 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
)

369 
PyObjeù
 *
obj1
;

370 
pym–em
 *pym–em = 
	`m–em_to_pym–em
(
–em
);

372 
obj1
 = 
	`PyTu¶e_New
(3);

373 
	`PyTu¶e_SET_ITEM
(
obj1
, 0, 
	`PyIÁ_FromLÚg
(
dœ
));

374 
	`PyTu¶e_SET_ITEM
(
obj1
, 1, 
	`PyIÁ_FromLÚg
(
chªÃl
));

375 
	`PyTu¶e_SET_ITEM
(
obj1
, 2, 
	`PyIÁ_FromLÚg
(
v®ue
));

376  
	`pÿÎ
(
pym–em
, "İsS‘Sw™ch", 
obj1
, 
NULL
);

377 
	}
}

379 
	$£t_dB_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

380 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
,

381 
db_gaš
, 
xdœ
)

383 
PyObjeù
 *
obj1
;

384 
pym–em
 *pym–em = 
	`m–em_to_pym–em
(
–em
);

386 
obj1
 = 
	`PyTu¶e_New
(4);

387 
	`PyTu¶e_SET_ITEM
(
obj1
, 0, 
	`PyIÁ_FromLÚg
(
dœ
));

388 
	`PyTu¶e_SET_ITEM
(
obj1
, 1, 
	`PyIÁ_FromLÚg
(
chªÃl
));

389 
	`PyTu¶e_SET_ITEM
(
obj1
, 2, 
	`PyIÁ_FromLÚg
(
db_gaš
));

390 
	`PyTu¶e_SET_ITEM
(
obj1
, 3, 
	`PyIÁ_FromLÚg
(
xdœ
));

391  
	`pÿÎ
(
pym–em
, "İsS‘DB", 
obj1
, 
NULL
);

392 
	}
}

394 
	$’um_™em_Çme_İs
(
¢d_mix”_–em_t
 *
–em
,

395 
™em
,

396 
size_t
 
maxËn
, *
buf
)

398 
PyObjeù
 *
obj1
, *
obj2
, *
t1
, *
»s
;

399 
pym–em
 *pym–em = 
	`m–em_to_pym–em
(
–em
);

400 
”r
;

401 
Ën
;

402 *
s
;

404 
obj1
 = 
	`PyTu¶e_New
(1);

405 
	`PyTu¶e_SET_ITEM
(
obj1
, 0, 
	`PyIÁ_FromLÚg
(
™em
));

406 
”r
 = 
	`pÿÎ
(
pym–em
, "İsG‘EnumI‹mName", 
obj1
, &
»s
);

407 ià(
”r
 >= 0) {

408 
t1
 = 
	`PyTu¶e_G‘I‹m
(
»s
, 1);

409 ià(
	`PyUnicode_Check
(
t1
)) {

410 
obj2
 = 
	`PyUnicode_AsEncodedSŒšg
(
t1
, "utf-8", "strict");

411 ià(
obj2
) {

412 
s
 = 
	`PyBy‹s_AsSŒšg
(
obj2
);

413 
Ën
 = 
	`¡¾’
(
s
);

414 ià(
maxËn
 - 1 > 
Ën
)

415 
Ën
 = 
maxËn
 - 1;

416 
	`memıy
(
buf
, 
s
, 
Ën
);

417 
buf
[
Ën
] = '\0';

418 
	`Py_DECREF
(
obj2
);

420 
”¾bl
;

422 #ià
PY_MAJOR_VERSION
 < 3

423 } ià(
	`PySŒšg_Check
(
t1
)) {

424 
s
 = 
	`PySŒšg_AsSŒšg
(
t1
);

425 
Ën
 = 
	`¡¾’
(
s
);

426 ià(
maxËn
 - 1 > 
Ën
)

427 
Ën
 = 
maxËn
 - 1;

428 
	`memıy
(
buf
, 
s
, 
Ën
);

429 
buf
[
Ën
] = '\0';

432 
”¾bl
:

433 
	`PyE¼_FÜm©
(
PyExc_Ty³E¼Ü
, "wrong„esult (invaliduple)");

434 
	`PyE¼_Pršt
();

435 
	`PyE¼_CË¬
();

436 
”r
 = -
EIO
;

439 
	`Py_XDECREF
(
»s
);

440  
”r
;

441 
	}
}

443 
	$g‘_’um_™em_İs
(
¢d_mix”_–em_t
 *
–em
,

444 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
,

445 *
™emp
)

447 
PyObjeù
 *
obj1
, *
t1
, *
»s
;

448 
pym–em
 *pym–em = 
	`m–em_to_pym–em
(
–em
);

449 
”r
;

451 
obj1
 = 
	`PyTu¶e_New
(1);

452 
	`PyTu¶e_SET_ITEM
(
obj1
, 0, 
	`PyIÁ_FromLÚg
(
chªÃl
));

453 
”r
 = 
	`pÿÎ
(
pym–em
, "İsG‘EnumI‹m", 
obj1
, &
»s
);

454 ià(
”r
 >= 0) {

455 
t1
 = 
	`PyTu¶e_G‘I‹m
(
»s
, 1);

456 ià(
	`PyLÚg_Check
(
t1
)) {

457 *
™emp
 = 
	`PyLÚg_AsLÚg
(
t1
);

458 
”r
 = 0;

459 #ià
PY_MAJOR_VERSION
 < 3

460 } ià(
	`PyIÁ_Check
(
t1
)) {

461 *
™emp
 = 
	`PyIÁ_AsLÚg
(
t1
);

462 
”r
 = 0;

465 
	`PyE¼_FÜm©
(
PyExc_Ty³E¼Ü
, "wrong„esult (invaliduple)");

466 
	`PyE¼_Pršt
();

467 
	`PyE¼_CË¬
();

468 
”r
 = -
EIO
;

471 
	`Py_XDECREF
(
»s
);

472  
”r
;

473 
	}
}

475 
	$£t_’um_™em_İs
(
¢d_mix”_–em_t
 *
–em
,

476 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
,

477 
™em
)

479 
PyObjeù
 *
obj1
;

480 
pym–em
 *pym–em = 
	`m–em_to_pym–em
(
–em
);

482 
obj1
 = 
	`PyTu¶e_New
(2);

483 
	`PyTu¶e_SET_ITEM
(
obj1
, 0, 
	`PyIÁ_FromLÚg
(
chªÃl
));

484 
	`PyTu¶e_SET_ITEM
(
obj1
, 1, 
	`PyIÁ_FromLÚg
(
™em
));

485  
	`pÿÎ
(
pym–em
, "İsS‘EnumI‹m", 
obj1
, 
NULL
);

486 
	}
}

488 
sm_–em_İs
 
	gsim¶e_pythÚ_İs
 = {

489 .
is
 = 
is_İs
,

490 .
	gg‘_¿nge
 = 
g‘_¿nge_İs
,

491 .
	gg‘_dB_¿nge
 = 
g‘_dB_¿nge_İs
,

492 .
	g£t_¿nge
 = 
£t_¿nge_İs
,

493 .
	gask_vŞ_dB
 = 
ask_vŞ_dB_İs
,

494 .
	gask_dB_vŞ
 = 
ask_dB_vŞ_İs
,

495 .
	gg‘_vŞume
 = 
g‘_vŞume_İs
,

496 .
	gg‘_dB
 = 
g‘_dB_İs
,

497 .
	g£t_vŞume
 = 
£t_vŞume_İs
,

498 .
	g£t_dB
 = 
£t_dB_İs
,

499 .
	gg‘_sw™ch
 = 
g‘_sw™ch_İs
,

500 .
	g£t_sw™ch
 = 
£t_sw™ch_İs
,

501 .
	g’um_™em_Çme
 = 
’um_™em_Çme_İs
,

502 .
	gg‘_’um_™em
 = 
g‘_’um_™em_İs
,

503 .
	g£t_’um_™em
 = 
£t_’um_™em_İs


506 
	$£Ëm_ä“
(
¢d_mix”_–em_t
 *
–em
)

508 
sm_£Ëm_t
 *
sim¶e
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

510 ià(
sim¶e
->
id
) {

511 
	`¢d_mix”_£Ëm_id_ä“
(
sim¶e
->
id
);

512 
sim¶e
->
id
 = 
NULL
;

514 
	}
}

516 
PyObjeù
 *

517 
	$pym–em_ÿp
(
pym–em
 *pym–em 
ATTRIBUTE_UNUSED
, *
´iv
)

519  
	`PyIÁ_FromLÚg
(()
´iv
);

520 
	}
}

522 
PyObjeù
 *

523 
	$pym–em_g‘_ÿps
(
pym–em
 *pym–em, *
´iv
 
ATTRIBUTE_UNUSED
)

525  
	`PyIÁ_FromLÚg
(
pym–em
->
£Ëm
.
ÿps
);

526 
	}
}

528 
PyObjeù
 *

529 
	$pym–em_g‘_Çme
(
pym–em
 *pym–em, *
´iv
 
ATTRIBUTE_UNUSED
)

531  
	`PyUnicode_FromSŒšg
(
	`¢d_mix”_£Ëm_id_g‘_Çme
(
pym–em
->
£Ëm
.
id
));

532 
	}
}

534 
PyObjeù
 *

535 
	$pym–em_g‘_šdex
(
pym–em
 *pym–em, *
´iv
 
ATTRIBUTE_UNUSED
)

537  
	`PyIÁ_FromLÚg
(
	`¢d_mix”_£Ëm_id_g‘_šdex
(
pym–em
->
£Ëm
.
id
));

538 
	}
}

541 
	$pym–em_£t_ÿps
(
pym–em
 *pym–em, 
PyObjeù
 *
v®
, *
´iv
 
ATTRIBUTE_UNUSED
)

543 ià(
	`PyLÚg_Check
(
v®
)) {

544 
pym–em
->
£Ëm
.
ÿps
 = 
	`PyLÚg_AsLÚg
(
v®
);

547 #ià
PY_MAJOR_VERSION
 < 3

548 ià(
	`PyIÁ_Check
(
v®
)) {

549 
pym–em
->
£Ëm
.
ÿps
 = 
	`PyIÁ_AsLÚg
(
v®
);

553 
	`PyE¼_S‘SŒšg
(
PyExc_Ty³E¼Ü
, "The†ast‡ttribute value must be‡n integer");

555 
	}
}

557 
PyObjeù
 *

558 
	$pym–em_ignÜe
(
pym–em
 *pym–em 
ATTRIBUTE_UNUSED
, 
PyObjeù
 *
¬gs
 ATTRIBUTE_UNUSED)

560 
Py_RETURN_NONE
;

561 
	}
}

563 
PyObjeù
 *

564 
	$pym–em_ignÜe1
(
pym–em
 *pym–em 
ATTRIBUTE_UNUSED
, 
PyObjeù
 *
¬gs
 ATTRIBUTE_UNUSED)

566 
Py_RETURN_TRUE
;

567 
	}
}

569 
PyObjeù
 *

570 
	$pym–em_”rÜ
(
pym–em
 *pym–em 
ATTRIBUTE_UNUSED
, 
PyObjeù
 *
¬gs
 ATTRIBUTE_UNUSED)

572  
	`PyIÁ_FromLÚg
(-
EIO
);

573 
	}
}

575 
PyObjeù
 *

576 
	$pym–em_©ch
(
pym–em
 *pym–em, 
PyObjeù
 *
¬gs
)

578 
PyObjeù
 *
obj
;

579 
¢d_hùl_–em_t
 *
h–em
;

580 
”r
;

582 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
, "O", &
obj
))

583  
NULL
;

584 
h–em
 = (
¢d_hùl_–em_t
 *)
	`g‘_C_±r
(
obj
, "get_C_helem");

585 ià(
h–em
 =ğ
NULL
)

586  
NULL
;

587 
”r
 = 
	`¢d_mix”_–em_©ch
(
pym–em
->
m–em
, 
h–em
);

588 ià(
”r
 < 0) {

589 
	`PyE¼_FÜm©
(
PyExc_RuÁimeE¼Ü
, "CªnÙ‡‰ach hcÚŒŞƒËm’ˆtØmix”ƒËm’t: %s", 
	`¢d_¡»¼Ü
(
”r
));

590  
NULL
;

592 
Py_RETURN_NONE
;

593 
	}
}

595 
PyObjeù
 *

596 
	$pym–em_d‘ach
(
pym–em
 *pym–em, 
PyObjeù
 *
¬gs
)

598 
PyObjeù
 *
obj
;

599 
¢d_hùl_–em_t
 *
h–em
;

600 
”r
;

602 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
, "O", &
obj
))

603  
NULL
;

604 
h–em
 = (
¢d_hùl_–em_t
 *)
	`g‘_C_±r
(
obj
, "get_C_helem");

605 ià(
h–em
 =ğ
NULL
)

606  
NULL
;

607 
”r
 = 
	`¢d_mix”_–em_d‘ach
(
pym–em
->
m–em
, 
h–em
);

608 ià(
”r
 < 0) {

609 
	`PyE¼_FÜm©
(
PyExc_RuÁimeE¼Ü
, "CªnÙ d‘ach hcÚŒŞƒËm’ˆtØmix”ƒËm’t: %s", 
	`¢d_¡»¼Ü
(
”r
));

610  
NULL
;

612 
Py_RETURN_NONE
;

613 
	}
}

615 
PyObjeù
 *

616 
	$pym–em_ev’t_šfo
(
pym–em
 *pym–em, 
PyObjeù
 *
¬gs
)

618 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
, ""))

619  
NULL
;

620  
	`PyIÁ_FromLÚg
(
	`¢d_mix”_–em_šfo
(
pym–em
->
m–em
));

621 
	}
}

623 
PyObjeù
 *

624 
	$pym–em_ev’t_v®ue
(
pym–em
 *pym–em, 
PyObjeù
 *
¬gs
)

626 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
, ""))

627  
NULL
;

628  
	`PyIÁ_FromLÚg
(
	`¢d_mix”_–em_v®ue
(
pym–em
->
m–em
));

629 
	}
}

632 
	$pym–em_š™
(
pym–em
 *pym–em, 
PyObjeù
 *
¬gs
, PyObjeù *
kwds
 
ATTRIBUTE_UNUSED
)

634 *
Çme
;

635 
šdex
, 
weight
;

636 
¢d_mix”_£Ëm_id_t
 *
id
;

637 
”r
;

639 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
, "Osii", &
pym–em
->
py_mix”
, &
Çme
, &
šdex
, &
weight
))

641 
	`mem£t
(&
pym–em
->
£Ëm
, 0, (pymelem->selem));

642 ià(
	`¢d_mix”_£Ëm_id_m®loc
(&
id
))

644 
	`¢d_mix”_£Ëm_id_£t_Çme
(
id
, 
Çme
);

645 
	`¢d_mix”_£Ëm_id_£t_šdex
(
id
, 
šdex
);

646 
pym–em
->
£Ëm
.
id
 = id;

647 
pym–em
->
£Ëm
.
İs
 = &
sim¶e_pythÚ_İs
;

648 
”r
 = 
	`¢d_mix”_–em_Ãw
(&
pym–em
->
m–em
, 
SND_MIXER_ELEM_SIMPLE
,

649 
weight
, &
pym–em
->
£Ëm
, 
£Ëm_ä“
);

650 ià(
”r
 < 0) {

651 
	`¢d_mix”_£Ëm_id_ä“
(
id
);

655 
	}
}

658 
	$pym–em_d—Îoc
(
pym–em
 *
£lf
)

660 
	`£Ëm_ä“
(
£lf
->
m–em
);

661 
	}
}

663 
PyG‘S‘Def
 
	gpym–em_g‘£‹rs
[] = {

664 {"CAP_GVOLUME", (
g‘‹r
)
pym–em_ÿp
, 
NULL
, NULL, (*)
SM_CAP_GVOLUME
},

665 {"CAP_GSWITCH", (
g‘‹r
)
pym–em_ÿp
, 
NULL
, NULL, (*)
SM_CAP_GSWITCH
},

666 {"CAP_PVOLUME", (
g‘‹r
)
pym–em_ÿp
, 
NULL
, NULL, (*)
SM_CAP_PVOLUME
},

667 {"CAP_PVOLUME_JOIN", (
g‘‹r
)
pym–em_ÿp
, 
NULL
, NULL, (*)
SM_CAP_PVOLUME_JOIN
},

668 {"CAP_PSWITCH", (
g‘‹r
)
pym–em_ÿp
, 
NULL
, NULL, (*)
SM_CAP_PSWITCH
},

669 {"CAP_PSWITCH_JOIN", (
g‘‹r
)
pym–em_ÿp
, 
NULL
, NULL, (*)
SM_CAP_PSWITCH_JOIN
},

670 {"CAP_CVOLUME", (
g‘‹r
)
pym–em_ÿp
, 
NULL
, NULL, (*)
SM_CAP_CVOLUME
},

671 {"CAP_CVOLUME_JOIN", (
g‘‹r
)
pym–em_ÿp
, 
NULL
, NULL, (*)
SM_CAP_CVOLUME_JOIN
},

672 {"CAP_CSWITCH", (
g‘‹r
)
pym–em_ÿp
, 
NULL
, NULL, (*)
SM_CAP_CSWITCH
},

673 {"CAP_CSWITCH_JOIN", (
g‘‹r
)
pym–em_ÿp
, 
NULL
, NULL, (*)
SM_CAP_CSWITCH_JOIN
},

674 {"CAP_CSWITCH_EXCL", (
g‘‹r
)
pym–em_ÿp
, 
NULL
, NULL, (*)
SM_CAP_CSWITCH_EXCL
},

675 {"CAP_PENUM", (
g‘‹r
)
pym–em_ÿp
, 
NULL
, NULL, (*)
SM_CAP_PENUM
},

676 {"CAP_CENUM", (
g‘‹r
)
pym–em_ÿp
, 
NULL
, NULL, (*)
SM_CAP_CENUM
},

678 {"ÿps", (
g‘‹r
)
pym–em_g‘_ÿps
, (
£‰”
)
pym–em_£t_ÿps
, 
NULL
, NULL},

680 {"Çme", (
g‘‹r
)
pym–em_g‘_Çme
, 
NULL
, NULL, NULL},

681 {"šdex", (
g‘‹r
)
pym–em_g‘_šdex
, 
NULL
, NULL, NULL},

683 {
NULL
,NULL,NULL,NULL,NULL}

686 
PyM‘hodDef
 
	gpym–em_m‘hods
[] = {

687 {"©ch", (
PyCFunùiÚ
)
pym–em_©ch
, 
METH_VARARGS
, 
NULL
},

688 {"d‘ach", (
PyCFunùiÚ
)
pym–em_d‘ach
, 
METH_VARARGS
, 
NULL
},

691 {"İsIsAùive", (
PyCFunùiÚ
)
pym–em_ignÜe1
, 
METH_VARARGS
, 
NULL
},

692 {"İsIsMÚo", (
PyCFunùiÚ
)
pym–em_ignÜe
, 
METH_VARARGS
, 
NULL
},

693 {"İsIsChªÃl", (
PyCFunùiÚ
)
pym–em_ignÜe
, 
METH_VARARGS
, 
NULL
},

694 {"İsIsEnum”©ed", (
PyCFunùiÚ
)
pym–em_ignÜe
, 
METH_VARARGS
, 
NULL
},

695 {"İsIsEnumCÁ", (
PyCFunùiÚ
)
pym–em_ignÜe
, 
METH_VARARGS
, 
NULL
},

697 {"İsG‘DB", (
PyCFunùiÚ
)
pym–em_”rÜ
, 
METH_VARARGS
, 
NULL
},

699 {"ev’tInfo", (
PyCFunùiÚ
)
pym–em_ev’t_šfo
, 
METH_VARARGS
, 
NULL
},

700 {"ev’tV®ue", (
PyCFunùiÚ
)
pym–em_ev’t_v®ue
, 
METH_VARARGS
, 
NULL
},

702 {
NULL
,NULL,0,NULL}

705 
PyTy³Objeù
 
	gpym–em_ty³
 = {

706 
PyV¬Objeù_HEAD_INIT
(
NULL
, 0)

707 
_Çme
: "smixer_python.InternalMElement",

708 
_basicsize
: (
pym–em
),

709 
_d—Îoc
: (
de¡ruùÜ
)
pym–em_d—Îoc
,

710 
_æags
: 
Py_TPFLAGS_DEFAULT
 | 
Py_TPFLAGS_BASETYPE
,

711 
_doc
: 
NULL
 ,

712 
_g‘£t
: 
pym–em_g‘£‹rs
,

713 
_š™
: (
š™´oc
)
pym–em_š™
,

714 
_®loc
: 
PyTy³_G’”icAÎoc
,

715 
_Ãw
: 
PyTy³_G’”icNew
,

716 
_ä“
: 
PyObjeù_D–
,

717 
_m‘hods
: 
pym–em_m‘hods
,

720 
PyObjeù
 *

721 
	$pymix”_©ch_hùl
(
pymix”
 *pymix”, 
PyObjeù
 *
¬gs
)

723 
PyObjeù
 *
obj
;

724 
¢d_hùl_t
 *
hùl
;

725 **
hùls
;

726 
”r
;

728 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
, "O", &
obj
))

729  
NULL
;

730 
hùl
 = (
¢d_hùl_t
 *)
	`g‘_C_±r
(
obj
, "get_C_hctl");

731 ià(
hùl
 =ğ
NULL
)

732  
NULL
;

733 
”r
 = 
	`¢d_mix”_©ch_hùl
(
pymix”
->
mix”
, 
hùl
);

734 ià(
”r
 < 0) {

735 
	`PyE¼_FÜm©
(
PyExc_RuÁimeE¼Ü
, "CªnÙ‡‰ach hùl: %s", 
	`¢d_¡»¼Ü
(
”r
));

736  
NULL
;

738 
hùls
 = 
	`»®loc
(
pymix”
->
hùl
, (*è* (pymix”->
hùl_couÁ
+1) * 2);

739 ià(
hùls
 =ğ
NULL
) {

740 
	`PyE¼_S‘SŒšg
(
PyExc_RuÁimeE¼Ü
, "Noƒnough memory");

741  
NULL
;

743 
pymix”
->
hùl
 = 
hùls
;

744 
pymix”
->
hùl
[pymix”->
hùl_couÁ
*2] = (*)hctl;

745 
pymix”
->
hùl
[pymix”->
hùl_couÁ
*2+1] = (*)
obj
;

746 
pymix”
->
hùl_couÁ
++;

747 
	`Py_INCREF
(
obj
);

748 
Py_RETURN_NONE
;

749 
	}
}

751 
PyObjeù
 *

752 
	$pymix”_»gi¡”
(
pymix”
 *pymix”, 
PyObjeù
 *
¬gs
)

754 
”r
;

756 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
, ""))

757  
NULL
;

758 
”r
 = 
	`¢d_mix”_şass_»gi¡”
(
pymix”
->
şass
,…ymix”->
mix”
);

759 ià(
”r
 < 0) {

760 
	`PyE¼_FÜm©
(
PyExc_RuÁimeE¼Ü
, "CªnÙ„egi¡” mix”: %s", 
	`¢d_¡»¼Ü
(
”r
));

761  
NULL
;

763 
Py_RETURN_NONE
;

764 
	}
}

766 
PyObjeù
 *

767 
	$pymix”_m–em’t_Ãw
(
pymix”
 *pymix”, 
PyObjeù
 *
¬gs
)

769 
PyObjeù
 *
obj
, *
obj1
, *
obj2
;

770 *
şass
, *
Çme
;

771 
šdex
, 
weight
;

773 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
, "ssii", &
şass
, &
Çme
, &
šdex
, &
weight
))

774  
NULL
;

775 
obj
 = 
	`PyDiù_G‘I‹mSŒšg
(
pymix”
->
mdiù
, 
şass
);

776 ià(
obj
) {

777 
obj1
 = 
	`PyTu¶e_New
(4);

778 
	`PyTu¶e_SET_ITEM
(
obj1
, 0, (
PyObjeù
 *)
pymix”
);

779 
	`Py_INCREF
((
PyObjeù
 *)
pymix”
);

780 
	`PyTu¶e_SET_ITEM
(
obj1
, 1, 
	`PyUnicode_FromSŒšg
(
Çme
));

781 
	`PyTu¶e_SET_ITEM
(
obj1
, 2, 
	`PyIÁ_FromLÚg
(
šdex
));

782 
	`PyTu¶e_SET_ITEM
(
obj1
, 3, 
	`PyIÁ_FromLÚg
(
weight
));

783 
obj2
 = 
	`PyObjeù_C®lObjeù
(
obj
, 
obj1
);

784 
	`Py_XDECREF
(
obj1
);

785 ià(
obj2
) {

786 
pym–em
 *pym–em = (pym–em *)
obj2
;

787 **
m–ems
 = 
	`»®loc
(
pymix”
->
m–em
, (*è* (pymix”->
m–em_couÁ
 + 1) * 2);

788 ià(
m–ems
 =ğ
NULL
) {

789 
	`Py_DECREF
(
obj2
);

790  
NULL
;

792 
m–ems
[
pymix”
->
m–em_couÁ
*2] = 
pym–em
->
m–em
;

793 
m–ems
[
pymix”
->
m–em_couÁ
*2+1] = 
obj2
;

794 
	`Py_INCREF
(
obj2
);

795 
pymix”
->
m–em
 = 
m–ems
;

796 
pymix”
->
m–em_couÁ
++;

799 
	`PyE¼_FÜm©
(
PyExc_RuÁimeE¼Ü
, "CªnÙ fšd cÏs '%s'", 
şass
);

800  
NULL
;

802  
obj2
;

803 
	}
}

805 
PyObjeù
 *

806 
	$pymix”_m–em’t_add
(
pymix”
 *pymix”, 
PyObjeù
 *
¬gs
)

808 
PyObjeù
 *
obj
;

809 
pym–em
 *pymelem;

810 
”r
;

812 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
, "O", &
obj
))

813  
NULL
;

814 
pym–em
 = (pym–em *)
obj
;

815 
”r
 = 
	`¢d_mix”_–em_add
(
pym–em
->
m–em
, 
pymix”
->
şass
);

816 ià(
”r
 < 0) {

817 
	`PyE¼_FÜm©
(
PyExc_RuÁimeE¼Ü
, "CªnÙ‡dd mix”ƒËm’t: %s", 
	`¢d_¡»¼Ü
(
”r
));

818  
NULL
;

820 
Py_RETURN_NONE
;

821 
	}
}

824 
	$pymix”_š™
(
pymix”
 *pymix”, 
PyObjeù
 *
¬gs
, PyObjeù *
kwds
 
ATTRIBUTE_UNUSED
)

826 
şass
, 
mix”
;

828 ià(!
	`PyArg_P¬£Tu¶e
(
¬gs
, "iiO", &
şass
, &
mix”
, &
pymix”
->
mdiù
))

830 
pymix”
->
şass
 = (
¢d_mix”_şass_t
 *)class;

831 
pymix”
->
mix”
 = (
¢d_mix”_t
 *)mixer;

832 
pymix”
->
hùl_couÁ
 = 0;

833 
pymix”
->
hùl
 = 
NULL
;

834 
pymix”
->
h–em_couÁ
 = 0;

835 
pymix”
->
h–em
 = 
NULL
;

836 
pymix”
->
m–em_couÁ
 = 0;

837 
pymix”
->
m–em
 = 
NULL
;

839 
	}
}

842 
	$pymix”_ä“
(
pymix”
 *
£lf
)

844 
idx
;

846 
idx
 = 0; idx < 
£lf
->
hùl_couÁ
; idx++) {

847 
	`¢d_mix”_d‘ach_hùl
(
£lf
->
mix”
, s–f->
hùl
[
idx
*2]);

848 
	`Py_DECREF
((
PyObjeù
 *)
£lf
->
hùl
[
idx
*2+1]);

850 ià(
£lf
->
hùl
)

851 
	`ä“
(
£lf
->
hùl
);

852 
£lf
->
hùl_couÁ
 = 0;

853 
£lf
->
hùl
 = 
NULL
;

854 
idx
 = 0; idx < 
£lf
->
h–em_couÁ
; idx++)

855 
	`Py_DECREF
((
PyObjeù
 *)
£lf
->
h–em
[
idx
*2+1]);

856 ià(
£lf
->
h–em
)

857 
	`ä“
(
£lf
->
h–em
);

858 
£lf
->
h–em_couÁ
 = 0;

859 
£lf
->
h–em
 = 
NULL
;

860 
idx
 = 0; idx < 
£lf
->
m–em_couÁ
; idx++)

861 
	`Py_DECREF
((
PyObjeù
 *)
£lf
->
m–em
[
idx
*2+1]);

862 ià(
£lf
->
m–em
)

863 
	`ä“
(
£lf
->
m–em
);

864 
£lf
->
m–em_couÁ
 = 0;

865 
£lf
->
m–em
 = 
NULL
;

866 
	}
}

869 
	$pymix”_d—Îoc
(
pymix”
 *
£lf
)

871 
	`pymix”_ä“
(
£lf
);

872 
	}
}

874 
PyG‘S‘Def
 
	gpymix”_g‘£‹rs
[] = {

875 {
NULL
,NULL,NULL,NULL,NULL}

878 
PyM‘hodDef
 
	gpymix”_m‘hods
[] = {

879 {"©chHC", (
PyCFunùiÚ
)
pymix”_©ch_hùl
, 
METH_VARARGS
, 
NULL
},

880 {"»gi¡”", (
PyCFunùiÚ
)
pymix”_»gi¡”
, 
METH_VARARGS
, 
NULL
},

881 {"ÃwMEËm’t", (
PyCFunùiÚ
)
pymix”_m–em’t_Ãw
, 
METH_VARARGS
, 
NULL
},

882 {"addMEËm’t", (
PyCFunùiÚ
)
pymix”_m–em’t_add
, 
METH_VARARGS
, 
NULL
},

883 {
NULL
,NULL,0,NULL}

886 
PyTy³Objeù
 
	gpymix”_ty³
 = {

887 
PyV¬Objeù_HEAD_INIT
(
NULL
, 0)

888 
_Çme
: "smixer_python.InternalMixer",

889 
_basicsize
: (
pymix”
),

890 
_d—Îoc
: (
de¡ruùÜ
)
pymix”_d—Îoc
,

891 
_æags
: 
Py_TPFLAGS_DEFAULT
 | 
Py_TPFLAGS_BASETYPE
,

892 
_doc
: 
NULL
 ,

893 
_g‘£t
: 
pymix”_g‘£‹rs
,

894 
_š™
: (
š™´oc
)
pymix”_š™
,

895 
_®loc
: 
PyTy³_G’”icAÎoc
,

896 
_Ãw
: 
PyTy³_G’”icNew
,

897 
_ä“
: 
PyObjeù_D–
,

898 
_m‘hods
: 
pymix”_m‘hods
,

901 
PyM‘hodDef
 
	gpythÚ_m‘hods
[] = {

902 {
NULL
, NULL, 0, NULL}

905 
PyObjeù
 *
	$Ãw_h–em
(
pythÚ_´iv
 *
´iv
, 
¢d_hùl_–em_t
 *
h–em
)

907 
PyObjeù
 *
obj
, *
py_hùl
 = 
NULL
, *
obj1
, *
obj2
;

908 
¢d_hùl_t
 *
hùl
 = 
	`¢d_hùl_–em_g‘_hùl
(
h–em
);

909 
pymix”
 *pymix” = (pymix” *)
´iv
->
py_mix”
;

910 
idx
;

912 
idx
 = 0; idx < 
pymix”
->
hùl_couÁ
; idx++) {

913 ià(
pymix”
->
hùl
[
idx
] == hctl) {

914 
py_hùl
 = 
pymix”
->
hùl
[
idx
*2+1];

918 ià(
py_hùl
 =ğ
NULL
)

919  
NULL
;

920 
obj
 = 
	`PyDiù_G‘I‹mSŒšg
(
´iv
->
py_mdiù
, "HElement");

921 ià(
obj
) {

922 
obj1
 = 
	`PyTu¶e_New
(3);

923 
	`PyTu¶e_SET_ITEM
(
obj1
, 0, 
py_hùl
);

924 
	`Py_INCREF
(
py_hùl
);

925 
	`PyTu¶e_SET_ITEM
(
obj1
, 1, 
	`PyFlßt_FromDoubË
(1));

926 
	`PyTu¶e_SET_ITEM
(
obj1
, 2, 
	`PyIÁ_FromLÚg
(()
h–em
));

927 
obj2
 = 
	`PyObjeù_C®lObjeù
(
obj
, 
obj1
);

928 ià(
obj2
 =ğ
NULL
) {

929 
	`PyE¼_Pršt
();

930 
	`PyE¼_CË¬
();

932 
	`Py_XDECREF
(
obj1
);

934 
	`SNDERR
("Unableo create InternalMixer object");

935  
NULL
;

937 ià(
obj2
) {

938 
pymix”
 *pymix” = (pymix” *)
´iv
->
py_mix”
;

939 **
h–ems
 = 
	`»®loc
(
pymix”
->
h–em
, (*è* (pymix”->
h–em_couÁ
 + 1) * 2);

940 ià(
h–ems
 =ğ
NULL
) {

941 
	`Py_DECREF
(
obj2
);

942  
NULL
;

944 
h–ems
[
pymix”
->
h–em_couÁ
*2] = 
h–em
;

945 
h–ems
[
pymix”
->
h–em_couÁ
*2+1] = 
obj2
;

946 
	`Py_INCREF
(
obj2
);

947 
pymix”
->
h–em
 = 
h–ems
;

948 
pymix”
->
h–em_couÁ
++;

950  
obj2
;

951 
	}
}

953 
PyObjeù
 *
	$fšd_h–em
(
pythÚ_´iv
 *
´iv
, 
¢d_hùl_–em_t
 *
h–em
)

955 
pymix”
 *pymix” = (pymix” *)
´iv
->
py_mix”
;

956 
idx
;

958 
idx
 = 0; idx < 
pymix”
->
h–em_couÁ
; idx++) {

959 ià(
pymix”
->
h–em
[
idx
*2] == helem)

960  (
PyObjeù
 *)
pymix”
->
h–em
[
idx
*2+1];

962  
NULL
;

963 
	}
}

965 
PyObjeù
 *
	$fšd_m–em
(
pythÚ_´iv
 *
´iv
, 
¢d_mix”_–em_t
 *
m–em
)

967 
pymix”
 *pymix” = (pymix” *)
´iv
->
py_mix”
;

968 
idx
;

970 
idx
 = 0; idx < 
pymix”
->
m–em_couÁ
; idx++) {

971 ià(
pymix”
->
m–em
[
idx
*2] == melem)

972  (
PyObjeù
 *)
pymix”
->
m–em
[
idx
*2+1];

974  
NULL
;

975 
	}
}

977 
	$®§_mix”_sim¶e_ev’t
(
¢d_mix”_şass_t
 *
şass
, 
mask
,

978 
¢d_hùl_–em_t
 *
h–em
, 
¢d_mix”_–em_t
 *
m–em
)

980 
pythÚ_´iv
 *
´iv
 = 
	`¢d_mix”_sbasic_g‘_´iv©e
(
şass
);

981 
PyTh»adS‹
 *
t¡©e
;

982 
PyObjeù
 *
t
, *
o
, *
r
;

983 
»s
 = -
ENOMEM
;

985 
t¡©e
 = 
	`PyTh»adS‹_New
(
maš_š‹½»‹r
);

986 
	`PyTh»adS‹_Sw­
(
t¡©e
);

988 
t
 = 
	`PyTu¶e_New
(3);

989 ià(
t
) {

990 
	`PyTu¶e_SET_ITEM
(
t
, 0, (
PyObjeù
 *)
	`PyIÁ_FromLÚg
(
mask
));

991 
o
 = 
	`fšd_h–em
(
´iv
, 
h–em
);

992 ià(
mask
 & 
SND_CTL_EVENT_MASK_ADD
) {

993 ià(
o
 =ğ
NULL
)

994 
o
 = 
	`Ãw_h–em
(
´iv
, 
h–em
);

996 ià(
o
 =ğ
NULL
)

998 
	`PyTu¶e_SET_ITEM
(
t
, 1, 
o
);

999 
	`Py_INCREF
(
o
);

1000 
o
 = 
m–em
 ? 
	`fšd_m–em
(
´iv
, m–emè: 
Py_NÚe
;

1001 
	`PyTu¶e_SET_ITEM
(
t
, 2, 
o
);

1002 
	`Py_INCREF
(
o
);

1003 
r
 = 
	`PyObjeù_C®lObjeù
(
´iv
->
py_ev’t_func
, 
t
);

1004 
	`Py_DECREF
(
t
);

1005 ià(
r
) {

1006 ià(
	`PyLÚg_Check
(
r
)) {

1007 
»s
 = 
	`PyLÚg_AsLÚg
(
r
);

1008 #ià
PY_MAJOR_VERSION
 < 3

1009 } ià(
	`PyIÁ_Check
(
r
)) {

1010 
»s
 = 
	`PyIÁ_AsLÚg
(
r
);

1012 } ià(
r
 =ğ
Py_NÚe
) {

1013 
»s
 = 0;

1015 
	`Py_DECREF
(
r
);

1017 
	`PyE¼_Pršt
();

1018 
	`PyE¼_CË¬
();

1019 
»s
 = -
EIO
;

1023  
»s
;

1024 
	}
}

1026 
	$®§_mix”_sim¶e_ä“
(
¢d_mix”_şass_t
 *
şass
)

1028 
pythÚ_´iv
 *
´iv
 = 
	`¢d_mix”_sbasic_g‘_´iv©e
(
şass
);

1030 ià(
´iv
->
py_mix”
) {

1031 
	`pymix”_ä“
((
pymix”
 *)
´iv
->
py_mix”
);

1032 
	`Py_DECREF
(
´iv
->
py_mix”
);

1034 ià(
´iv
->
py_š™Ÿlized
) {

1035 
	`Py_XDECREF
(
´iv
->
py_ev’t_func
);

1036 
	`Py_Fš®ize
();

1038 
	`ä“
(
´iv
);

1039 
	}
}

1041 
	$®§_mix”_sim¶e_pyš™
(
pythÚ_´iv
 *
´iv
,

1042 
PyObjeù
 *
py_mod
,

1043 
FILE
 *
å
,

1044 cÚ¡ *
fe
,

1045 
¢d_mix”_şass_t
 *
şass
,

1046 
¢d_mix”_t
 *
mix”
,

1047 cÚ¡ *
deviû
)

1049 
PyObjeù
 *
obj
, *
obj1
, *
obj2
, *
mdiù
;

1051 
mdiù
 = 
´iv
->
py_mdiù
 = 
	`PyModuË_G‘Diù
(
py_mod
);

1052 
obj
 = 
	`PyUnicode_FromSŒšg
(
fe
);

1053 ià(
obj
)

1054 
	`PyDiù_S‘I‹mSŒšg
(
mdiù
, "__fe__", 
obj
);

1055 
	`Py_XDECREF
(
obj
);

1056 
obj
 = 
	`PyUnicode_FromSŒšg
(
deviû
);

1057 ià(
obj
)

1058 
	`PyDiù_S‘I‹mSŒšg
(
mdiù
, "deviû", 
obj
);

1059 
	`Py_XDECREF
(
obj
);

1060 
	`Py_INCREF
(&
pym–em_ty³
);

1061 
	`Py_INCREF
(&
pymix”_ty³
);

1062 
	`PyModuË_AddObjeù
(
py_mod
, "IÁ”ÇlMEËm’t", (
PyObjeù
 *)&
pym–em_ty³
);

1063 
	`PyModuË_AddObjeù
(
py_mod
, "IÁ”ÇlMix”", (
PyObjeù
 *)&
pymix”_ty³
);

1064 
obj
 = 
	`PyDiù_G‘I‹mSŒšg
(
mdiù
, "InternalMixer");

1065 ià(
obj
) {

1066 
obj1
 = 
	`PyTu¶e_New
(3);

1067 
	`PyTu¶e_SET_ITEM
(
obj1
, 0, 
	`PyIÁ_FromLÚg
(()
şass
));

1068 
	`PyTu¶e_SET_ITEM
(
obj1
, 1, 
	`PyIÁ_FromLÚg
(()
mix”
));

1069 
	`PyTu¶e_SET_ITEM
(
obj1
, 2, 
mdiù
);

1070 
	`Py_INCREF
(
mdiù
);

1071 
obj2
 = 
	`PyObjeù_C®lObjeù
(
obj
, 
obj1
);

1072 
	`Py_XDECREF
(
obj1
);

1073 
	`PyDiù_S‘I‹mSŒšg
(
mdiù
, "mix”", 
obj2
);

1074 
´iv
->
py_mix”
 = 
obj2
;

1076 
	`SNDERR
("Unableo create InternalMixer object");

1077  -
EIO
;

1080 
obj
 = 
	`PyRun_FeEx
(
å
, 
fe
, 
Py_fe_šput
, 
mdiù
, mdict, 1);

1081 ià(
obj
 =ğ
NULL
)

1082 
	`PyE¼_Pršt
();

1083 
	`Py_XDECREF
(
obj
);

1084 
´iv
->
py_ev’t_func
 = 
	`PyDiù_G‘I‹mSŒšg
(
mdiù
, "event");

1085 ià(
´iv
->
py_ev’t_func
 =ğ
NULL
) {

1086 
	`SNDERR
("Unableo find…ython function 'event'");

1087  -
EIO
;

1090 
	}
}

1092 #ià
PY_MAJOR_VERSION
 >= 3

1093 
PyModuËDef
 
	gsmix”_pythÚ_moduË
 = {

1094 
PyModuËDef_HEAD_INIT
,

1096 
NULL
,

1098 
pythÚ_m‘hods
,

1099 
NULL
,

1100 
NULL
,

1101 
NULL
,

1102 
NULL


1106 
	$®§_mix”_sim¶e_fš™
(
¢d_mix”_şass_t
 *
şass
,

1107 
¢d_mix”_t
 *
mix”
,

1108 cÚ¡ *
deviû
)

1110 
pythÚ_´iv
 *
´iv
;

1111 
FILE
 *
å
;

1112 cÚ¡ *
fe
;

1113 
PyObjeù
 *
obj
, *
py_mod
;

1114 
·th
[
PATH_MAX
];

1116 
´iv
 = 
	`ÿÎoc
(1, (*priv));

1117 ià(
´iv
 =ğ
NULL
)

1118  -
ENOMEM
;

1120 
	`¢d_mix”_sbasic_£t_´iv©e
(
şass
, 
´iv
);

1121 
	`¢d_mix”_sbasic_£t_´iv©e_ä“
(
şass
, 
®§_mix”_sim¶e_ä“
);

1123 
fe
 = 
	`g‘’v
("ALSA_MIXER_SIMPLE_MPYTHON");

1124 ià(
fe
 =ğ
NULL
) {

1125 
	`¢d_dÍ©h
(
·th
, Õ©h), 
SCRIPT
);

1126 
fe
 = 
·th
;

1129 
å
 = 
	`fİ’
(
fe
, "r");

1130 ià(
å
 =ğ
NULL
) {

1131 
	`SNDERR
("UÇbËØfšd…ythÚ moduË '%s'", 
fe
);

1132  -
ENODEV
;

1135 
	`Py_In™Ÿlize
();

1136 ià(
	`PyTy³_R—dy
(&
pym–em_ty³
) < 0 ||

1137 
	`PyTy³_R—dy
(&
pymix”_ty³
) < 0) {

1138 
	`fşo£
(
å
);

1139  -
EIO
;

1141 #ià
PY_MAJOR_VERSION
 < 3

1142 
	`Py_In™ModuË
("smix”_pythÚ", 
pythÚ_m‘hods
);

1144 
	`PyModuË_C»©e
(&
smix”_pythÚ_moduË
);

1146 
´iv
->
py_š™Ÿlized
 = 1;

1147 
maš_š‹½»‹r
 = 
	`PyTh»adS‹_G‘
()->
š‹½
;

1148 
obj
 = 
	`PyImpÜt_G‘ModuËDiù
();

1149 
py_mod
 = 
	`PyDiù_G‘I‹mSŒšg
(
obj
, "__main__");

1150 ià(
py_mod
)

1151 
	`®§_mix”_sim¶e_pyš™
(
´iv
, 
py_mod
, 
å
, 
fe
, 
şass
, 
mix”
, 
deviû
);

1153 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/sbase.c

22 
	~<¡dio.h
>

23 
	~<¡dlib.h
>

24 
	~<uni¡d.h
>

25 
	~<¡ršg.h
>

26 
	~<fú.h
>

27 
	~<sys/ioùl.h
>

28 
	~<m©h.h
>

29 
	~"asoundlib.h
"

30 
	~"mix”_ab¡.h
"

31 
	~"sba£.h
"

37 
£Ëm_»ad
(
¢d_mix”_–em_t
 *
–em
);

43 
	$chªm­_to_chªÃls
(
chªm­
)

45 
i
, 
»s
;

47 
i
 = 0, 
»s
 = 0; i < 
MAX_CHANNEL
; i++)

48 ià(
chªm­
 & (1 << 
i
))

49 
»s
++;

50  
»s
;

51 
	}
}

54 
	$to_u£r
(
£Ëm_ba£
 *
s
, 
dœ
, 
h–em_ba£
 *
c
, 
v®ue
)

56 
št64_t
 
n
;

57 ià(
c
->
max
 =ğc->
mš
)

58  
s
->
dœ
[dœ].
mš
;

59 
n
 = (
št64_t
è(
v®ue
 - 
c
->
mš
è* (
s
->
dœ
[dœ].
max
 - s->dir[dir].min);

60  
s
->
dœ
[dœ].
mš
 + (
n
 + (
c
->
max
 - c->min) / 2) / (c->max - c->min);

61 
	}
}

63 
	$äom_u£r
(
£Ëm_ba£
 *
s
, 
dœ
, 
h–em_ba£
 *
c
, 
v®ue
)

65 
št64_t
 
n
;

66 ià(
s
->
dœ
[dœ].
max
 =ğs->dœ[dœ].
mš
)

67  
c
->
mš
;

68 
n
 = (
št64_t
è(
v®ue
 - 
s
->
dœ
[dœ].
mš
è* (
c
->
max
 - c->min);

69  
c
->
mš
 + (
n
 + (
s
->
dœ
[dœ].
max
 - s->dir[dir].min) / 2) / (s->dir[dir].max - s->dir[dir].min);

70 
	}
}

73 
	$upd©e_¿nges
(
£Ëm_ba£
 *
s
)

75 
mask
[2] = { 
SM_CAP_PVOLUME
, 
SM_CAP_CVOLUME
 };

76 
gmask
[2] = { 
SM_CAP_GVOLUME
, SM_CAP_GVOLUME };

77 
dœ
, 
ok_æag
;

78 
li¡_h—d
 *
pos
;

79 
h–em_ba£
 *
h–em
;

81 
dœ
 = 0; dir < 2; dir++) {

82 
s
->
dœ
[dœ].
mš
 = 0;

83 
s
->
dœ
[dœ].
max
 = 0;

84 
ok_æag
 = 0;

85 
	`li¡_fÜ_—ch
(
pos
, &
s
->
h–ems
) {

86 
h–em
 = 
	`li¡_’Œy
(
pos
, 
h–em_ba£
, 
li¡
);

87 
	`´štf
("mš = %li, max = %li\n", 
h–em
->
mš
, h–em->
max
);

88 ià(
h–em
->
ÿps
 & 
mask
[
dœ
]) {

89 
s
->
dœ
[dœ].
mš
 = 
h–em
->min;

90 
s
->
dœ
[dœ].
max
 = 
h–em
->max;

91 
ok_æag
 = 1;

95 ià(
ok_æag
)

97 
	`li¡_fÜ_—ch
(
pos
, &
s
->
h–ems
) {

98 
h–em
 = 
	`li¡_’Œy
(
pos
, 
h–em_ba£
, 
li¡
);

99 ià(
h–em
->
ÿps
 & 
gmask
[
dœ
]) {

100 
s
->
dœ
[dœ].
mš
 = 
h–em
->min;

101 
s
->
dœ
[dœ].
max
 = 
h–em
->max;

106 
	}
}

112 
	$is_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
, 
cmd
, 
v®
)

114 
£Ëm_ba£
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

116 
cmd
) {

118 
SM_OPS_IS_ACTIVE
: {

119 
li¡_h—d
 *
pos
;

120 
h–em_ba£
 *
h–em
;

121 
	`li¡_fÜ_—ch
(
pos
, &
s
->
h–ems
) {

122 
h–em
 = 
	`li¡_’Œy
(
pos
, 
h–em_ba£
, 
li¡
);

123 ià(
h–em
->
šaùive
)

129 
SM_OPS_IS_MONO
:

130  
	`chªm­_to_chªÃls
(
s
->
dœ
[dœ].
chªm­
) == 1;

132 
SM_OPS_IS_CHANNEL
:

133 ià(
v®
 > 
MAX_CHANNEL
)

135  !!((1 << 
v®
è& 
s
->
dœ
[dœ].
chªm­
);

137 
SM_OPS_IS_ENUMERATED
: {

138 
h–em_ba£
 *
h–em
;

139 
h–em
 = 
	`li¡_’Œy
(
s
->
h–ems
.
Ãxt
, 
h–em_ba£
, 
li¡
);

140  !!(
h–em
->
pu½o£
 =ğ
PURPOSE_ENUMLIST
);

143 
SM_OPS_IS_ENUMCNT
: {

144 
h–em_ba£
 *
h–em
;

145 
h–em
 = 
	`li¡_’Œy
(
s
->
h–ems
.
Ãxt
, 
h–em_ba£
, 
li¡
);

146  
h–em
->
max
;

152 
	}
}

154 
	$g‘_¿nge_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

155 *
mš
, *
max
)

157 
£Ëm_ba£
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

159 *
mš
 = 
s
->
dœ
[dir].min;

160 *
max
 = 
s
->
dœ
[dir].max;

163 
	}
}

165 
	$g‘_dB_¿nge_İs
(
¢d_mix”_–em_t
 *
–em
 
ATTRIBUTE_UNUSED
,

166 
dœ
 
ATTRIBUTE_UNUSED
,

167 *
mš
 
ATTRIBUTE_UNUSED
,

168 *
max
 
ATTRIBUTE_UNUSED
)

170  -
ENXIO
;

171 
	}
}

173 
	$£t_¿nge_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

174 
mš
, 
max
)

176 
£Ëm_ba£
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

177 
”r
;

179 
s
->
dœ
[dœ].
fÜûd_¿nge
 = 1;

180 
s
->
dœ
[dœ].
mš
 = min;

181 
s
->
dœ
[dœ].
max
 = max;

183 ià((
”r
 = 
	`£Ëm_»ad
(
–em
)) < 0)

184  
”r
;

186 
	}
}

188 
	$g‘_vŞume_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

189 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
)

191 
£Ëm_ba£
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

193 *
v®ue
 = 
s
->
dœ
[dœ].
vŞ
[
chªÃl
];

195 
	}
}

197 
	$g‘_dB_İs
(
¢d_mix”_–em_t
 *
–em
 
ATTRIBUTE_UNUSED
,

198 
dœ
 
ATTRIBUTE_UNUSED
,

199 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
 
ATTRIBUTE_UNUSED
,

200 *
v®ue
 
ATTRIBUTE_UNUSED
)

202  -
ENXIO
;

203 
	}
}

205 
	$g‘_sw™ch_İs
(
¢d_mix”_–em_t
 *
–em
 
ATTRIBUTE_UNUSED
,

206 
dœ
 
ATTRIBUTE_UNUSED
,

207 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
 
ATTRIBUTE_UNUSED
,

208 *
v®ue
)

211 *
v®ue
 = 0;

213 
	}
}

215 
	$£t_vŞume_İs
(
¢d_mix”_–em_t
 *
–em
 
ATTRIBUTE_UNUSED
,

216 
dœ
 
ATTRIBUTE_UNUSED
,

217 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
 
ATTRIBUTE_UNUSED
,

218 
v®ue
 
ATTRIBUTE_UNUSED
)

222 
	}
}

224 
	$£t_dB_İs
(
¢d_mix”_–em_t
 *
–em
 
ATTRIBUTE_UNUSED
,

225 
dœ
 
ATTRIBUTE_UNUSED
,

226 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
 
ATTRIBUTE_UNUSED
,

227 
v®ue
 
ATTRIBUTE_UNUSED
,

228 
xdœ
 
ATTRIBUTE_UNUSED
)

230  -
ENXIO
;

231 
	}
}

233 
	$£t_sw™ch_İs
(
¢d_mix”_–em_t
 *
–em
 
ATTRIBUTE_UNUSED
,

234 
dœ
 
ATTRIBUTE_UNUSED
,

235 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
 
ATTRIBUTE_UNUSED
,

236 
v®ue
 
ATTRIBUTE_UNUSED
)

241 
	}
}

243 
	$’um_™em_Çme_İs
(
¢d_mix”_–em_t
 *
–em
 
ATTRIBUTE_UNUSED
,

244 
™em
 
ATTRIBUTE_UNUSED
,

245 
size_t
 
maxËn
 
ATTRIBUTE_UNUSED
,

246 *
buf
 
ATTRIBUTE_UNUSED
)

250 
	}
}

252 
	$g‘_’um_™em_İs
(
¢d_mix”_–em_t
 *
–em
 
ATTRIBUTE_UNUSED
,

253 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
 
ATTRIBUTE_UNUSED
,

254 *
™emp
 
ATTRIBUTE_UNUSED
)

258 
	}
}

260 
	$£t_’um_™em_İs
(
¢d_mix”_–em_t
 *
–em
 
ATTRIBUTE_UNUSED
,

261 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
 
ATTRIBUTE_UNUSED
,

262 
™em
 
ATTRIBUTE_UNUSED
)

266 
	}
}

268 
sm_–em_İs
 
	gsim¶e_ac97_İs
 = {

269 .
is
 = 
is_İs
,

270 .
	gg‘_¿nge
 = 
g‘_¿nge_İs
,

271 .
	gg‘_dB_¿nge
 = 
g‘_dB_¿nge_İs
,

272 .
	g£t_¿nge
 = 
£t_¿nge_İs
,

273 .
	gg‘_vŞume
 = 
g‘_vŞume_İs
,

274 .
	gg‘_dB
 = 
g‘_dB_İs
,

275 .
	g£t_vŞume
 = 
£t_vŞume_İs
,

276 .
	g£t_dB
 = 
£t_dB_İs
,

277 .
	gg‘_sw™ch
 = 
g‘_sw™ch_İs
,

278 .
	g£t_sw™ch
 = 
£t_sw™ch_İs
,

279 .
	g’um_™em_Çme
 = 
’um_™em_Çme_İs
,

280 .
	gg‘_’um_™em
 = 
g‘_’um_™em_İs
,

281 .
	g£t_’um_™em
 = 
£t_’um_™em_İs


288 
	$£Ëm_»ad
(
¢d_mix”_–em_t
 *
–em
)

290 
	`´štf
("–em„—d: %p\n", 
–em
);

292 
	}
}

294 
	$sim¶e_ev’t_»move
(
¢d_hùl_–em_t
 *
h–em
,

295 
¢d_mix”_–em_t
 *
m–em
 
ATTRIBUTE_UNUSED
)

297 
	`´štf
("ev’ˆ»move: %p\n", 
h–em
);

299 
	}
}

301 
	$£Ëm_ä“
(
¢d_mix”_–em_t
 *
–em
)

303 
£Ëm_ba£
 *
sim¶e
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

304 
h–em_ba£
 *
hsim¶e
;

305 
li¡_h—d
 *
pos
, *
Åos
;

307 ià(
sim¶e
->
£Ëm
.
id
)

308 
	`¢d_mix”_£Ëm_id_ä“
(
sim¶e
->
£Ëm
.
id
);

309 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, &
sim¶e
->
h–ems
) {

310 
hsim¶e
 = 
	`li¡_’Œy
(
pos
, 
h–em_ba£
, 
li¡
);

311 
	`ä“
(
hsim¶e
);

313 
	`ä“
(
sim¶e
);

314 
	}
}

316 
	$sim¶e_ev’t_add1
(
¢d_mix”_şass_t
 *
şass
,

317 
¢d_hùl_–em_t
 *
h–em
,

318 
h–em_£ËùÜ
 *
£l
)

320 
bşass_´iv©e
 *
´iv
 = 
	`¢d_mix”_sbasic_g‘_´iv©e
(
şass
);

321 
¢d_mix”_–em_t
 *
m–em
;

322 
¢d_mix”_£Ëm_id_t
 *
id
;

323 
¢d_ùl_–em_šfo_t
 *
šfo
;

324 
£Ëm_ba£
 *
sim¶e
;

325 
h–em_ba£
 *
hsim¶e
;

326 
¢d_ùl_–em_ty³_t
 
ùy³
;

327 
mš
, 
max
;

328 
”r
, 
Ãw
 = 0;

329 
li¡_h—d
 *
pos
;

330 
bşass_sid
 *
bsid
;

331 
m–em_sids
 *
sid
;

332 
ui
;

334 
	`li¡_fÜ_—ch
(
pos
, &
´iv
->
sids
) {

335 
bsid
 = 
	`li¡_’Œy
(
pos
, 
bşass_sid
, 
li¡
);

336 
ui
 = 0; u˜< 
bsid
->
couÁ
; ui++) {

337 ià(
bsid
->
sids
[
ui
].
sid
 =ğ
£l
->sid) {

338 
sid
 = &
bsid
->
sids
[
ui
];

339 
__sid_ok
;

345 
__sid_ok
:

346 
	`¢d_ùl_–em_šfo_®loÿ
(&
šfo
);

347 
”r
 = 
	`¢d_hùl_–em_šfo
(
h–em
, 
šfo
);

348 ià(
”r
 < 0)

349  
”r
;

350 
ùy³
 = 
	`¢d_ùl_–em_šfo_g‘_ty³
(
šfo
);

351 
ùy³
) {

352 
SND_CTL_ELEM_TYPE_ENUMERATED
:

353 
mš
 = 0;

354 
max
 = 
	`¢d_ùl_–em_šfo_g‘_™ems
(
šfo
);

356 
SND_CTL_ELEM_TYPE_INTEGER
:

357 
mš
 = 
	`¢d_ùl_–em_šfo_g‘_mš
(
šfo
);

358 
max
 = 
	`¢d_ùl_–em_šfo_g‘_max
(
šfo
);

361 
mš
 = 
max
 = 0;

365 
	`´štf
("ev’ˆadd: %p, %°(%s)\n", 
h–em
, 
£l
, 
	`¢d_hùl_–em_g‘_Çme
(helem));

366 ià(
	`¢d_mix”_£Ëm_id_m®loc
(&
id
))

367  -
ENOMEM
;

368 
hsim¶e
 = 
	`ÿÎoc
(1, (*hsimple));

369 ià(
hsim¶e
 =ğ
NULL
) {

370 
	`¢d_mix”_£Ëm_id_ä“
(
id
);

371  -
ENOMEM
;

373 
£l
->
pu½o£
) {

374 
PURPOSE_SWITCH
:

375 ià(
ùy³
 !ğ
SND_CTL_ELEM_TYPE_BOOLEAN
) {

376 
__šv®id_ty³
:

377 
	`¢d_mix”_£Ëm_id_ä“
(
id
);

378 
	`ä“
(
hsim¶e
);

379  -
EINVAL
;

382 
PURPOSE_VOLUME
:

383 ià(
ùy³
 !ğ
SND_CTL_ELEM_TYPE_INTEGER
)

384 
__šv®id_ty³
;

387 
hsim¶e
->
pu½o£
 = 
£l
->purpose;

388 
hsim¶e
->
ÿps
 = 
£l
->caps;

389 
hsim¶e
->
mš
 = min;

390 
hsim¶e
->
max
 = max;

391 
	`¢d_mix”_£Ëm_id_£t_Çme
(
id
, 
sid
->
¢ame
);

392 
	`¢d_mix”_£Ëm_id_£t_šdex
(
id
, 
sid
->
sšdex
);

393 
m–em
 = 
	`¢d_mix”_fšd_£Ëm
(
	`¢d_mix”_şass_g‘_mix”
(
şass
), 
id
);

394 ià(!
m–em
) {

395 
sim¶e
 = 
	`ÿÎoc
(1, (*simple));

396 ià(!
sim¶e
) {

397 
	`¢d_mix”_£Ëm_id_ä“
(
id
);

398 
	`ä“
(
hsim¶e
);

399  -
ENOMEM
;

401 
sim¶e
->
£Ëm
.
id
 = id;

402 
sim¶e
->
£Ëm
.
İs
 = &
sim¶e_ac97_İs
;

403 
	`INIT_LIST_HEAD
(&
sim¶e
->
h–ems
);

404 
sim¶e
->
sid
 = 
£l
->sid;

405 
”r
 = 
	`¢d_mix”_–em_Ãw
(&
m–em
, 
SND_MIXER_ELEM_SIMPLE
,

406 
sid
->
weight
,

407 
sim¶e
, 
£Ëm_ä“
);

408 ià(
”r
 < 0) {

409 
	`¢d_mix”_£Ëm_id_ä“
(
id
);

410 
	`ä“
(
hsim¶e
);

411 
	`ä“
(
sim¶e
);

412  
”r
;

414 
Ãw
 = 1;

416 
sim¶e
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
m–em
);

417 
	`¢d_mix”_£Ëm_id_ä“
(
id
);

419 
	`li¡_add_
(&
hsim¶e
->
li¡
, &
sim¶e
->
h–ems
);

420 
hsim¶e
->
šaùive
 = 
	`¢d_ùl_–em_šfo_is_šaùive
(
šfo
);

421 
”r
 = 
	`¢d_mix”_–em_©ch
(
m–em
, 
h–em
);

422 ià(
”r
 < 0)

423 
__”rÜ
;

424 
sim¶e
->
dœ
[0].
chªm­
 |ğ
sid
->chanmap[0];

425 
sim¶e
->
dœ
[1].
chªm­
 |ğ
sid
->chanmap[1];

426 
sim¶e
->
£Ëm
.
ÿps
 |ğ
hsim¶e
->caps;

427 
	`upd©e_¿nges
(
sim¶e
);

429 
”r
 = 
	`sim¶e_upd©e
(
m–em
);

430 ià(
”r
 < 0) {

431 ià(
Ãw
)

432 
__”rÜ
;

433  
”r
;

436 ià(
Ãw
)

437 
”r
 = 
	`¢d_mix”_–em_add
(
m–em
, 
şass
);

439 
”r
 = 
	`¢d_mix”_–em_šfo
(
m–em
);

440 ià(
”r
 < 0)

441  
”r
;

442 
”r
 = 
	`£Ëm_»ad
(
m–em
);

443 ià(
”r
 < 0)

444  
”r
;

445 ià(
”r
)

446 
”r
 = 
	`¢d_mix”_–em_v®ue
(
m–em
);

447  
”r
;

448 
__”rÜ
:

449 ià(
Ãw
)

450 
	`¢d_mix”_–em_ä“
(
m–em
);

451  -
EINVAL
;

452 
	}
}

454 
	$sim¶e_ev’t_add
(
¢d_mix”_şass_t
 *
şass
, 
¢d_hùl_–em_t
 *
h–em
)

456 
bşass_´iv©e
 *
´iv
 = 
	`¢d_mix”_sbasic_g‘_´iv©e
(
şass
);

457 
bşass_£ËùÜ
 *
£l
;

458 
h–em_£ËùÜ
 *
h£l
;

459 
li¡_h—d
 *
pos
;

460 
¢d_ùl_–em_içû_t
 
içû
 = 
	`¢d_hùl_–em_g‘_š‹rçû
(
h–em
);

461 cÚ¡ *
Çme
 = 
	`¢d_hùl_–em_g‘_Çme
(
h–em
);

462 
šdex
 = 
	`¢d_hùl_–em_g‘_šdex
(
h–em
);

463 
ui
;

464 
”r
;

466 
	`li¡_fÜ_—ch
(
pos
, &
´iv
->
£ËùÜs
) {

467 
£l
 = 
	`li¡_’Œy
(
pos
, 
bşass_£ËùÜ
, 
li¡
);

468 
ui
 = 0; u˜< 
£l
->
couÁ
; ui++) {

469 
h£l
 = &
£l
->
£ËùÜs
[
ui
];

470 ià(
h£l
->
içû
 =ğiçû && !
	`¡rcmp
(h£l->
Çme
,‚ameè&& h£l->
šdex
 == index) {

471 
”r
 = 
	`sim¶e_ev’t_add1
(
şass
, 
h–em
, 
h£l
);

472 ià(
”r
 < 0)

473  
”r
;

478 
	}
}

480 
	$®§_mix”_sbasic_ev’t
(
¢d_mix”_şass_t
 *
şass
, 
mask
,

481 
¢d_hùl_–em_t
 *
h–em
, 
¢d_mix”_–em_t
 *
m–em
)

483 
”r
;

484 ià(
mask
 =ğ
SND_CTL_EVENT_MASK_REMOVE
)

485  
	`sim¶e_ev’t_»move
(
h–em
, 
m–em
);

486 ià(
mask
 & 
SND_CTL_EVENT_MASK_ADD
) {

487 
”r
 = 
	`sim¶e_ev’t_add
(
şass
, 
h–em
);

488 ià(
”r
 < 0)

489  
”r
;

491 ià(
mask
 & 
SND_CTL_EVENT_MASK_INFO
) {

492 
”r
 = 
	`sim¶e_ev’t_»move
(
h–em
, 
m–em
);

493 ià(
”r
 < 0)

494  
”r
;

495 
”r
 = 
	`sim¶e_ev’t_add
(
şass
, 
h–em
);

496 ià(
”r
 < 0)

497  
”r
;

500 ià(
mask
 & 
SND_CTL_EVENT_MASK_VALUE
) {

501 
”r
 = 
	`£Ëm_»ad
(
m–em
);

502 ià(
”r
 < 0)

503  
”r
;

504 ià(
”r
) {

505 
”r
 = 
	`¢d_mix”_–em_v®ue
(
m–em
);

506 ià(
”r
 < 0)

507  
”r
;

511 
	}
}

513 
	$sbasic_ıriv_ä“
(
¢d_mix”_şass_t
 *
şass
)

515 
bşass_´iv©e
 *
´iv
 = 
	`¢d_mix”_sbasic_g‘_´iv©e
(
şass
);

516 
bşass_£ËùÜ
 *
£l
;

517 
bşass_sid
 *
sid
;

518 
li¡_h—d
 *
pos
, *
pos1
;

520 
	`li¡_fÜ_—ch_§ã
(
pos
, 
pos1
, &
´iv
->
£ËùÜs
) {

521 
£l
 = 
	`li¡_’Œy
(
pos
, 
bşass_£ËùÜ
, 
li¡
);

522 
	`ä“
(
£l
);

524 
	`li¡_fÜ_—ch_§ã
(
pos
, 
pos1
, &
´iv
->
sids
) {

525 
sid
 = 
	`li¡_’Œy
(
pos
, 
bşass_sid
, 
li¡
);

526 
	`ä“
(
sid
);

528 
	`ä“
(
´iv
);

529 
	}
}

531 
	$®§_mix”_sbasic_š™´iv
(
¢d_mix”_şass_t
 *
şass
,

532 
bşass_´iv©e
 *
´iv
)

534 
	`INIT_LIST_HEAD
(&
´iv
->
£ËùÜs
);

535 
	`INIT_LIST_HEAD
(&
´iv
->
sids
);

536 
	`¢d_mix”_sbasic_£t_´iv©e
(
şass
, 
´iv
);

537 
	`¢d_mix”_sbasic_£t_´iv©e_ä“
(
şass
, 
sbasic_ıriv_ä“
);

538 
	}
}

540 
	$®§_mix”_sbasic_£Ìeg
(
¢d_mix”_şass_t
 *
şass
,

541 
h–em_£ËùÜ
 *
£ËùÜs
,

542 
couÁ
)

544 
bşass_´iv©e
 *
´iv
 = 
	`¢d_mix”_sbasic_g‘_´iv©e
(
şass
);

545 
bşass_£ËùÜ
 *
£l
 = 
	`ÿÎoc
(1, (*sel));

547 ià(
£l
 =ğ
NULL
)

548  -
ENOMEM
;

549 ià(
´iv
 =ğ
NULL
) {

550 
´iv
 = 
	`ÿÎoc
(1, (*priv));

551 ià(
´iv
 =ğ
NULL
) {

552 
	`ä“
(
£l
);

553  -
ENOMEM
;

556 
£l
->
£ËùÜs
 = selectors;

557 
£l
->
couÁ
 = count;

558 
	`li¡_add_
(&
£l
->
li¡
, &
´iv
->
£ËùÜs
);

560 
	}
}

562 
	$®§_mix”_sbasic_sid»g
(
¢d_mix”_şass_t
 *
şass
,

563 
m–em_sids
 *
sids
,

564 
couÁ
)

566 
bşass_´iv©e
 *
´iv
 = 
	`¢d_mix”_sbasic_g‘_´iv©e
(
şass
);

567 
bşass_sid
 *
sid
 = 
	`ÿÎoc
(1, (*sid));

569 ià(
sid
 =ğ
NULL
)

570  -
ENOMEM
;

571 ià(
´iv
 =ğ
NULL
) {

572 
´iv
 = 
	`ÿÎoc
(1, (*priv));

573 ià(
´iv
 =ğ
NULL
) {

574 
	`ä“
(
sid
);

575  -
ENOMEM
;

577 
	`INIT_LIST_HEAD
(&
´iv
->
£ËùÜs
);

578 
	`INIT_LIST_HEAD
(&
´iv
->
sids
);

579 
	`¢d_mix”_sbasic_£t_´iv©e
(
şass
, 
´iv
);

580 
	`¢d_mix”_sbasic_£t_´iv©e_ä“
(
şass
, 
sbasic_ıriv_ä“
);

582 
sid
->
sids
 = sids;

583 
sid
->
couÁ
 = count;

584 
	`li¡_add
(&
sid
->
li¡
, &
´iv
->
sids
);

586 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/sbase.h

22 #iâdeà
__SMIXER_BASE_H


24 
	~"li¡.h
"

26 
	#MAX_CHANNEL
 6

	)

28 
	#SID_MASTER
 0

	)

29 
	#SID_HEADPHONE
 1

	)

30 
	#SID_FRONT
 2

	)

31 
	#SID_PCM
 3

	)

32 
	#SID_CD
 4

	)

34 
	sm–em_sids
 {

35 
	msid
;

36 cÚ¡ *
	m¢ame
;

37 
	msšdex
;

38 
	mweight
;

39 
	mchªm­
[2];

40 
sm_–em_İs
 *
	msİs
;

43 
	#PURPOSE_VOLUME
 0

	)

44 
	#PURPOSE_SWITCH
 1

	)

45 
	#PURPOSE_ENUMLIST
 2

	)

47 
	sh–em_£ËùÜ
 {

48 
¢d_ùl_–em_içû_t
 
	miçû
;

49 cÚ¡ *
	mÇme
;

50 
	mšdex
;

51 
	msid
;

52 
	mpu½o£
;

53 
	mÿps
;

56 
	sh–em_ba£
 {

57 
li¡_h—d
 
	mli¡
;

58 
¢d_hùl_–em_t
 *
	mh–em
;

59 
	mpu½o£
;

60 
	mÿps
;

61 
	mšaùive
: 1;

62 
	mmš
, 
	mmax
;

63 
	mcouÁ
;

66 
	s£Ëm_ba£
 {

67 
sm_£Ëm_t
 
	m£Ëm
;

68 
li¡_h—d
 
	mh–ems
;

69 
	msid
;

71 
	mchªm­
;

72 
	mfÜûd_¿nge
: 1;

73 
	mmš
, 
	mmax
;

74 
	mvŞ
[
MAX_CHANNEL
];

75 } 
	mdœ
[2];

78 
	sbşass_£ËùÜ
 {

79 
li¡_h—d
 
	mli¡
;

80 
h–em_£ËùÜ
 *
	m£ËùÜs
;

81 
	mcouÁ
;

84 
	sbşass_sid
 {

85 
li¡_h—d
 
	mli¡
;

86 
m–em_sids
 *
	msids
;

87 
	mcouÁ
;

90 
	sbşass_ba£_İs
 {

91 (*
	mev’t
)(
¢d_mix”_şass_t
 *
	mşass
, 
	mmask
,

92 
¢d_hùl_–em_t
 *
	mh–em
, 
¢d_mix”_–em_t
 *
	mm–em
);

93 (*
	m£Ìeg
)(
¢d_mix”_şass_t
 *
	mşass
,

94 
h–em_£ËùÜ
 *
	m£ËùÜs
,

95 
	mcouÁ
);

96 (*
	msid»g
)(
¢d_mix”_şass_t
 *
	mşass
,

97 
m–em_sids
 *
	msids
,

98 
	mcouÁ
);

99 } 
	tbşass_ba£_İs_t
;

101 
	sbşass_´iv©e
 {

102 
li¡_h—d
 
	m£ËùÜs
;

103 
li¡_h—d
 
	msids
;

104 *
	mdl_sba£
;

105 
bşass_ba£_İs_t
 
	mİs
;

108 
mix”_sim¶e_basic_dlİ’
(
¢d_mix”_şass_t
 *
şass
,

109 
bşass_ba£_İs_t
 **
İs
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/sbasedl.c

23 
	~<¡dio.h
>

24 
	~<¡dlib.h
>

25 
	~<uni¡d.h
>

26 
	~<¡ršg.h
>

27 
	~<fú.h
>

28 
	~<sys/ioùl.h
>

29 
	~<m©h.h
>

30 
	~<dlfú.h
>

31 
	~"cÚfig.h
"

32 
	~"asoundlib.h
"

33 
	~"mix”_ab¡.h
"

34 
	~"sba£.h
"

36 
	#SO_PATH
 "smix”"

	)

38 
	$mix”_sim¶e_basic_dlİ’
(
¢d_mix”_şass_t
 *
şass
,

39 
bşass_ba£_İs_t
 **
İs
)

41 
bşass_´iv©e
 *
´iv
 = 
	`¢d_mix”_sbasic_g‘_´iv©e
(
şass
);

42 cÚ¡ *
lib
 = "smixer-sbase.so";

43 (*
š™´iv
)(
¢d_mix”_şass_t
 *
şass
, 
bşass_´iv©e
 *
´iv
);

44 *
xlib
, *
·th
, 
”rbuf
[256];

45 *
h
;

46 
š™æag
 = 0;

48 ià(
´iv
 =ğ
NULL
) {

49 
´iv
 = 
	`ÿÎoc
(1, (*priv));

50 ià(
´iv
 =ğ
NULL
)

51  -
ENOMEM
;

52 
š™æag
 = 1;

54 
·th
 = 
	`g‘’v
("ALSA_MIXER_SIMPLE_MODULES");

55 ià(!
·th
)

56 
·th
 = 
SO_PATH
;

57 
xlib
 = 
	`m®loc
(
	`¡¾’
(
lib
è+ sŒËn(
·th
) + 1 + 1);

58 ià(
xlib
 =ğ
NULL
) {

59 ià(
š™æag
)

60 
	`ä“
(
´iv
);

61  -
ENOMEM
;

63 
	`¡rıy
(
xlib
, 
·th
);

64 
	`¡rÿt
(
xlib
, "/");

65 
	`¡rÿt
(
xlib
, 
lib
);

66 
h
 = 
	`¢d_dlİ’
(
xlib
, 
RTLD_NOW
, 
”rbuf
, (errbuf));

67 ià(
h
 =ğ
NULL
) {

68 
	`SNDERR
("UÇbËØİ’†ib¿ry '%s': %s", 
xlib
, 
”rbuf
);

69 
__”rÜ
;

71 
š™´iv
 = 
	`dlsym
(
h
, "alsa_mixer_sbasic_initpriv");

72 ià(
š™´iv
 =ğ
NULL
) {

73 
	`SNDERR
("SymbŞ '®§_mix”_sbasic_š™´iv' wa nÙ found iÀ'%s'", 
xlib
);

74 
__”rÜ
;

76 
´iv
->
İs
.
ev’t
 = 
	`dlsym
(
h
, "alsa_mixer_sbasic_event");

77 ià(
´iv
->
İs
.
ev’t
 =ğ
NULL
) {

78 
	`SNDERR
("SymbŞ '®§_mix”_sbasic_ev’t' wa nÙ found iÀ'%s'", 
xlib
);

79 
__”rÜ
;

81 
´iv
->
İs
.
£Ìeg
 = 
	`dlsym
(
h
, "alsa_mixer_sbasic_selreg");

82 ià(
´iv
->
İs
.
£Ìeg
 =ğ
NULL
) {

83 
	`SNDERR
("SymbŞ '®§_mix”_sbasic_£Ìeg' wa nÙ found iÀ'%s'", 
xlib
);

84 
__”rÜ
;

86 
´iv
->
İs
.
sid»g
 = 
	`dlsym
(
h
, "alsa_mixer_sbasic_sidreg");

87 ià(
´iv
->
İs
.
sid»g
 =ğ
NULL
) {

88 
	`SNDERR
("SymbŞ '®§_mix”_sbasic_sid»g' wa nÙ found iÀ'%s'", 
xlib
);

89 
__”rÜ
;

91 
	`ä“
(
xlib
);

92 ià(
š™æag
)

93 
	`š™´iv
(
şass
, 
´iv
);

94 
´iv
->
dl_sba£
 = 
h
;

95 ià(
İs
)

96 *
İs
 = &
´iv
->ops;

99 
__”rÜ
:

100 ià(
š™æag
)

101 
	`ä“
(
´iv
);

102 ià(
h
)

103 
	`¢d_dlşo£
(
h
);

104 
	`ä“
(
xlib
);

105  -
ENXIO
;

106 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/alisp/alisp.c

24 
	#®i¥_£q_™”©Ü
 
®i¥_objeù


	)

26 
	~"loÿl.h
"

27 
	~"®i¥.h
"

28 
	~"®i¥_loÿl.h
"

30 
	~<as£¹.h
>

32 
	~<lim™s.h
>

33 
	~<¡dio.h
>

34 
	~<¡dlib.h
>

35 
	~<¡ršg.h
>

36 
	~<ùy³.h
>

37 
	~<m©h.h
>

38 
	~<”r.h
>

41 
®i¥_objeù
 
	g®§_li¥_n
;

42 
®i¥_objeù
 
	g®§_li¥_t
;

45 
®i¥_objeù
 * 
·r£_objeù
(
®i¥_š¡ªû
 *
š¡ªû
, 
hav‘ok’
);

46 
´šc_cÚs
(
¢d_ouut_t
 *
out
, 
®i¥_objeù
 * 
p
);

47 
´šc_objeù
(
¢d_ouut_t
 *
out
, 
®i¥_objeù
 * 
p
);

48 
®i¥_objeù
 * 
ev®
(
®i¥_š¡ªû
 *
š¡ªû
, ®i¥_objeù * 
p
);

51 
®i¥_objeù
 *
F_ev®
(
®i¥_š¡ªû
 *
š¡ªû
, alisp_object *);

52 
®i¥_objeù
 *
F_´ogn
(
®i¥_š¡ªû
 *
š¡ªû
, alisp_object *);

53 
®i¥_objeù
 *
F_funÿÎ
(
®i¥_š¡ªû
 *
š¡ªû
, alisp_object *);

56 
®i¥_šşude_fe
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
f’ame
);

62 
	$g‘_¡ršg_hash
(cÚ¡ *
s
)

64 
v®
 = 0;

65 ià(
s
 =ğ
NULL
)

66  
v®
;

67 *
s
)

68 
v®
 +ğ*
s
++;

69  
v®
 & 
ALISP_OBJ_PAIR_HASH_MASK
;

70 
	}
}

72 
	$nomem
()

74 
	`SNDERR
("alisp:‚oƒnough memory");

75 
	}
}

77 
	$li¥_v”bo£
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
fmt
, ...)

79 
va_li¡
 
­
;

81 ià(!
š¡ªû
->
v”bo£
)

83 
	`va_¡¬t
(
­
, 
fmt
);

84 
	`¢d_ouut_´štf
(
š¡ªû
->
vout
, "alisp: ");

85 
	`¢d_ouut_v´štf
(
š¡ªû
->
vout
, 
fmt
, 
­
);

86 
	`¢d_ouut_putc
(
š¡ªû
->
vout
, '\n');

87 
	`va_’d
(
­
);

88 
	}
}

90 
	$li¥_”rÜ
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
fmt
, ...)

92 
va_li¡
 
­
;

94 ià(!
š¡ªû
->
w¬nšg
)

96 
	`va_¡¬t
(
­
, 
fmt
);

97 
	`¢d_ouut_´štf
(
š¡ªû
->
eout
, "alispƒrror: ");

98 
	`¢d_ouut_v´štf
(
š¡ªû
->
eout
, 
fmt
, 
­
);

99 
	`¢d_ouut_putc
(
š¡ªû
->
eout
, '\n');

100 
	`va_’d
(
­
);

101 
	}
}

103 
	$li¥_w¬n
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
fmt
, ...)

105 
va_li¡
 
­
;

107 ià(!
š¡ªû
->
w¬nšg
)

109 
	`va_¡¬t
(
­
, 
fmt
);

110 
	`¢d_ouut_´štf
(
š¡ªû
->
wout
, "alisp warning: ");

111 
	`¢d_ouut_v´štf
(
š¡ªû
->
wout
, 
fmt
, 
­
);

112 
	`¢d_ouut_putc
(
š¡ªû
->
wout
, '\n');

113 
	`va_’d
(
­
);

114 
	}
}

116 
	$li¥_debug
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
fmt
, ...)

118 
va_li¡
 
­
;

120 ià(!
š¡ªû
->
debug
)

122 
	`va_¡¬t
(
­
, 
fmt
);

123 
	`¢d_ouut_´štf
(
š¡ªû
->
dout
, "alisp debug: ");

124 
	`¢d_ouut_v´štf
(
š¡ªû
->
dout
, 
fmt
, 
­
);

125 
	`¢d_ouut_putc
(
š¡ªû
->
dout
, '\n');

126 
	`va_’d
(
­
);

127 
	}
}

129 
®i¥_objeù
 * 
	$Ãw_objeù
(
®i¥_š¡ªû
 *
š¡ªû
, 
ty³
)

131 
®i¥_objeù
 * 
p
;

133 ià(
	`li¡_em±y
(&
š¡ªû
->
ä“_objs_li¡
)) {

134 
p
 = (
®i¥_objeù
 *)
	`m®loc
((alisp_object));

135 ià(
p
 =ğ
NULL
) {

136 
	`nomem
();

137  
NULL
;

139 
	`li¥_debug
(
š¡ªû
, "®loÿtšg cÚ %p", 
p
);

141 
p
 = (
®i¥_objeù
 *)
š¡ªû
->
ä“_objs_li¡
.
Ãxt
;

142 
	`li¡_d–
(&
p
->
li¡
);

143 
š¡ªû
->
ä“_objs
--;

144 
	`li¥_debug
(
š¡ªû
, "»cyşšg cÚ %p", 
p
);

147 
š¡ªû
->
u£d_objs
++;

149 
	`®i¥_£t_ty³
(
p
, 
ty³
);

150 
	`®i¥_£t_»fs
(
p
, 1);

151 ià(
ty³
 =ğ
ALISP_OBJ_CONS
) {

152 
p
->
v®ue
.
c
.
ÿr
 = &
®§_li¥_n
;

153 
p
->
v®ue
.
c
.
cdr
 = &
®§_li¥_n
;

154 
	`li¡_add
(&
p
->
li¡
, &
š¡ªû
->
u£d_objs_li¡
[0][
ALISP_OBJ_CONS
]);

157 ià(
š¡ªû
->
u£d_objs
 + in¡ªû->
ä“_objs
 > in¡ªû->
max_objs
)

158 
š¡ªû
->
max_objs
 = in¡ªû->
u£d_objs
 + in¡ªû->
ä“_objs
;

160  
p
;

161 
	}
}

163 
	$ä“_objeù
(
®i¥_objeù
 * 
p
)

165 
	`®i¥_g‘_ty³
(
p
)) {

166 
ALISP_OBJ_STRING
:

167 
ALISP_OBJ_IDENTIFIER
:

168 
	`ä“
(
p
->
v®ue
.
s
);

169 
	`®i¥_£t_ty³
(
p
, 
ALISP_OBJ_INTEGER
);

174 
	}
}

176 
	$d–‘e_objeù
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
p
)

178 ià(
p
 =ğ
NULL
 ||… =ğ&
®§_li¥_n
 ||… =ğ&
®§_li¥_t
)

180 ià(
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_NIL
) ||

181 
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_T
))

183 
	`as£¹
(
	`®i¥_g‘_»fs
(
p
) > 0);

184 
	`li¥_debug
(
š¡ªû
, "d–‘cÚ %°Ñy³ = %i,„ef ğ%iè( ğ'%s')", 
p
, 
	`®i¥_g‘_ty³
Õ), 
	`®i¥_g‘_»fs
(p),

185 
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_STRING
) ||

186 
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_IDENTIFIER
è?…->
v®ue
.
s
 : "???");

187 ià(
	`®i¥_dec_»fs
(
p
))

189 
	`li¡_d–
(&
p
->
li¡
);

190 
š¡ªû
->
u£d_objs
--;

191 
	`ä“_objeù
(
p
);

192 ià(
š¡ªû
->
ä“_objs
 >ğ
ALISP_FREE_OBJ_POOL
) {

193 
	`li¥_debug
(
š¡ªû
, "ä“d cÚ %p", 
p
);

194 
	`ä“
(
p
);

197 
	`li¥_debug
(
š¡ªû
, "moved cÚ %°tØä“†i¡", 
p
);

198 
	`li¡_add
(&
p
->
li¡
, &
š¡ªû
->
ä“_objs_li¡
);

199 
š¡ªû
->
ä“_objs
++;

200 
	}
}

202 
	$d–‘e_Œ“
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
p
)

204 ià(
p
 =ğ
NULL
)

206 ià(
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_CONS
)) {

207 
	`d–‘e_Œ“
(
š¡ªû
, 
p
->
v®ue
.
c
.
ÿr
);

208 
	`d–‘e_Œ“
(
š¡ªû
, 
p
->
v®ue
.
c
.
cdr
);

210 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

211 
	}
}

213 
®i¥_objeù
 * 
	$šüef_objeù
(
®i¥_š¡ªû
 *
š¡ªû
 
ATTRIBUTE_UNUSED
, 
®i¥_objeù
 * 
p
)

215 ià(
p
 =ğ
NULL
 ||… =ğ&
®§_li¥_n
 ||… =ğ&
®§_li¥_t
)

216  
p
;

217 ià(
	`®i¥_g‘_»fs
(
p
è=ğ
ALISP_MAX_REFS
) {

218 
	`as£¹
(0);

219 
	`årštf
(
¡d”r
, "OOPS:‡lsa†isp: incref fatalƒrror\n");

220 
	`ex™
(
EXIT_FAILURE
);

222 
	`®i¥_šc_»fs
(
p
);

223  
p
;

224 
	}
}

226 
®i¥_objeù
 * 
	$šüef_Œ“
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
p
)

228 ià(
p
 =ğ
NULL
)

229  
NULL
;

230 ià(
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_CONS
)) {

231 
	`šüef_Œ“
(
š¡ªû
, 
p
->
v®ue
.
c
.
ÿr
);

232 
	`šüef_Œ“
(
š¡ªû
, 
p
->
v®ue
.
c
.
cdr
);

234  
	`šüef_objeù
(
š¡ªû
, 
p
);

235 
	}
}

240 
®i¥_objeù
 * 
	$šüef_Œ“_ex¶ic™
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
p
, ®i¥_objeù * 
e
)

242 ià(
p
 =ğ
NULL
)

243  
NULL
;

244 ià(
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_CONS
)) {

245 ià(
e
 =ğ
p
) {

246 
	`šüef_Œ“
(
š¡ªû
, 
p
->
v®ue
.
c
.
ÿr
);

247 
	`šüef_Œ“
(
š¡ªû
, 
p
->
v®ue
.
c
.
cdr
);

249 
	`šüef_Œ“_ex¶ic™
(
š¡ªû
, 
p
->
v®ue
.
c
.
ÿr
, 
e
);

250 
	`šüef_Œ“_ex¶ic™
(
š¡ªû
, 
p
->
v®ue
.
c
.
cdr
, 
e
);

253 ià(
e
 =ğ
p
)

254  
	`šüef_objeù
(
š¡ªû
, 
p
);

255  
p
;

256 
	}
}

259 
	$ä“_objeùs
(
®i¥_š¡ªû
 *
š¡ªû
)

261 
li¡_h—d
 *
pos
, *
pos1
;

262 
®i¥_objeù
 * 
p
;

263 
®i¥_objeù_·œ
 * 
·œ
;

264 
i
, 
j
;

266 
i
 = 0; i < 
ALISP_OBJ_PAIR_HASH_SIZE
; i++) {

267 
	`li¡_fÜ_—ch_§ã
(
pos
, 
pos1
, &
š¡ªû
->
£tobjs_li¡
[
i
]) {

268 
·œ
 = 
	`li¡_’Œy
(
pos
, 
®i¥_objeù_·œ
, 
li¡
);

269 
	`li¥_debug
(
š¡ªû
, "ä“šg…aœ: '%s' -> %p", 
·œ
->
Çme
,…aœ->
v®ue
);

270 
	`d–‘e_Œ“
(
š¡ªû
, 
·œ
->
v®ue
);

271 
	`ä“
((*)
·œ
->
Çme
);

272 
	`ä“
(
·œ
);

275 
i
 = 0; i < 
ALISP_OBJ_PAIR_HASH_SIZE
; i++)

276 
j
 = 0; j <ğ
ALISP_OBJ_LAST_SEARCH
; j++) {

277 
	`li¡_fÜ_—ch_§ã
(
pos
, 
pos1
, &
š¡ªû
->
u£d_objs_li¡
[
i
][
j
]) {

278 
p
 = 
	`li¡_’Œy
(
pos
, 
®i¥_objeù
, 
li¡
);

279 
	`li¥_w¬n
(
š¡ªû
, "objeù %°i ¡È»ã»nûd %˜times!", 
p
, 
	`®i¥_g‘_»fs
(p));

281 
	`¢d_ouut_´štf
(
š¡ªû
->
wout
, ">>>> ");

282 
	`´šc_objeù
(
š¡ªû
->
wout
, 
p
);

283 
	`¢d_ouut_´štf
(
š¡ªû
->
wout
, " <<<<\n");

285 ià(
	`®i¥_g‘_»fs
(
p
) > 0)

286 
	`®i¥_£t_»fs
(
p
, 1);

287 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

290 
	`li¡_fÜ_—ch_§ã
(
pos
, 
pos1
, &
š¡ªû
->
ä“_objs_li¡
) {

291 
p
 = 
	`li¡_’Œy
(
pos
, 
®i¥_objeù
, 
li¡
);

292 
	`li¡_d–
(&
p
->
li¡
);

293 
	`ä“
(
p
);

294 
	`li¥_debug
(
š¡ªû
, "ä“d (®lècÚ %p", 
p
);

296 
	}
}

298 
®i¥_objeù
 * 
	$£¬ch_objeù_id’tif›r
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
s
)

300 
li¡_h—d
 * 
pos
;

301 
®i¥_objeù
 * 
p
;

303 
	`li¡_fÜ_—ch
(
pos
, &
š¡ªû
->
u£d_objs_li¡
[
	`g‘_¡ršg_hash
(
s
)][
ALISP_OBJ_IDENTIFIER
]) {

304 
p
 = 
	`li¡_’Œy
(
pos
, 
®i¥_objeù
, 
li¡
);

305 ià(
	`®i¥_g‘_»fs
(
p
è> 
ALISP_MAX_REFS_LIMIT
)

307 ià(!
	`¡rcmp
(
p
->
v®ue
.
s
, s))

308  
	`šüef_objeù
(
š¡ªû
, 
p
);

311  
NULL
;

312 
	}
}

314 
®i¥_objeù
 * 
	$£¬ch_objeù_¡ršg
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
s
)

316 
li¡_h—d
 * 
pos
;

317 
®i¥_objeù
 * 
p
;

319 
	`li¡_fÜ_—ch
(
pos
, &
š¡ªû
->
u£d_objs_li¡
[
	`g‘_¡ršg_hash
(
s
)][
ALISP_OBJ_STRING
]) {

320 
p
 = 
	`li¡_’Œy
(
pos
, 
®i¥_objeù
, 
li¡
);

321 ià(!
	`¡rcmp
(
p
->
v®ue
.
s
, s)) {

322 ià(
	`®i¥_g‘_»fs
(
p
è> 
ALISP_MAX_REFS_LIMIT
)

324  
	`šüef_objeù
(
š¡ªû
, 
p
);

328  
NULL
;

329 
	}
}

331 
®i¥_objeù
 * 
	$£¬ch_objeù_š‹g”
(
®i¥_š¡ªû
 *
š¡ªû
, 
š
)

333 
li¡_h—d
 * 
pos
;

334 
®i¥_objeù
 * 
p
;

336 
	`li¡_fÜ_—ch
(
pos
, &
š¡ªû
->
u£d_objs_li¡
[
š
 & 
ALISP_OBJ_PAIR_HASH_MASK
][
ALISP_OBJ_INTEGER
]) {

337 
p
 = 
	`li¡_’Œy
(
pos
, 
®i¥_objeù
, 
li¡
);

338 ià(
p
->
v®ue
.
i
 =ğ
š
) {

339 ià(
	`®i¥_g‘_»fs
(
p
è> 
ALISP_MAX_REFS_LIMIT
)

341  
	`šüef_objeù
(
š¡ªû
, 
p
);

345  
NULL
;

346 
	}
}

348 
®i¥_objeù
 * 
	$£¬ch_objeù_æßt
(
®i¥_š¡ªû
 *
š¡ªû
, 
š
)

350 
li¡_h—d
 * 
pos
;

351 
®i¥_objeù
 * 
p
;

353 
	`li¡_fÜ_—ch
(
pos
, &
š¡ªû
->
u£d_objs_li¡
[()
š
 & 
ALISP_OBJ_PAIR_HASH_MASK
][
ALISP_OBJ_FLOAT
]) {

354 
p
 = 
	`li¡_’Œy
(
pos
, 
®i¥_objeù
, 
li¡
);

355 ià(
p
->
v®ue
.
i
 =ğ
š
) {

356 ià(
	`®i¥_g‘_»fs
(
p
è> 
ALISP_MAX_REFS_LIMIT
)

358  
	`šüef_objeù
(
š¡ªû
, 
p
);

362  
NULL
;

363 
	}
}

365 
®i¥_objeù
 * 
	$£¬ch_objeù_poš‹r
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
±r
)

367 
li¡_h—d
 * 
pos
;

368 
®i¥_objeù
 * 
p
;

370 
	`li¡_fÜ_—ch
(
pos
, &
š¡ªû
->
u£d_objs_li¡
[()
±r
 & 
ALISP_OBJ_PAIR_HASH_MASK
][
ALISP_OBJ_POINTER
]) {

371 
p
 = 
	`li¡_’Œy
(
pos
, 
®i¥_objeù
, 
li¡
);

372 ià(
p
->
v®ue
.
±r
 ==…tr) {

373 ià(
	`®i¥_g‘_»fs
(
p
è> 
ALISP_MAX_REFS_LIMIT
)

375  
	`šüef_objeù
(
š¡ªû
, 
p
);

379  
NULL
;

380 
	}
}

382 
®i¥_objeù
 * 
	$Ãw_š‹g”
(
®i¥_š¡ªû
 *
š¡ªû
, 
v®ue
)

384 
®i¥_objeù
 * 
obj
;

386 
obj
 = 
	`£¬ch_objeù_š‹g”
(
š¡ªû
, 
v®ue
);

387 ià(
obj
 !ğ
NULL
)

388  
obj
;

389 
obj
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_INTEGER
);

390 ià(
obj
) {

391 
	`li¡_add
(&
obj
->
li¡
, &
š¡ªû
->
u£d_objs_li¡
[
v®ue
 & 
ALISP_OBJ_PAIR_HASH_MASK
][
ALISP_OBJ_INTEGER
]);

392 
obj
->
v®ue
.
i
 = value;

394  
obj
;

395 
	}
}

397 
®i¥_objeù
 * 
	$Ãw_æßt
(
®i¥_š¡ªû
 *
š¡ªû
, 
v®ue
)

399 
®i¥_objeù
 * 
obj
;

401 
obj
 = 
	`£¬ch_objeù_æßt
(
š¡ªû
, 
v®ue
);

402 ià(
obj
 !ğ
NULL
)

403  
obj
;

404 
obj
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_FLOAT
);

405 ià(
obj
) {

406 
	`li¡_add
(&
obj
->
li¡
, &
š¡ªû
->
u£d_objs_li¡
[()
v®ue
 & 
ALISP_OBJ_PAIR_HASH_MASK
][
ALISP_OBJ_FLOAT
]);

407 
obj
->
v®ue
.
f
 = value;

409  
obj
;

410 
	}
}

412 
®i¥_objeù
 * 
	$Ãw_¡ršg
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
¡r
)

414 
®i¥_objeù
 * 
obj
;

416 
obj
 = 
	`£¬ch_objeù_¡ršg
(
š¡ªû
, 
¡r
);

417 ià(
obj
 !ğ
NULL
)

418  
obj
;

419 
obj
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_STRING
);

420 ià(
obj
)

421 
	`li¡_add
(&
obj
->
li¡
, &
š¡ªû
->
u£d_objs_li¡
[
	`g‘_¡ršg_hash
(
¡r
)][
ALISP_OBJ_STRING
]);

422 ià(
obj
 && (obj->
v®ue
.
s
 = 
	`¡rdup
(
¡r
)è=ğ
NULL
) {

423 
	`d–‘e_objeù
(
š¡ªû
, 
obj
);

424 
	`nomem
();

425  
NULL
;

427  
obj
;

428 
	}
}

430 
®i¥_objeù
 * 
	$Ãw_id’tif›r
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
id
)

432 
®i¥_objeù
 * 
obj
;

434 
obj
 = 
	`£¬ch_objeù_id’tif›r
(
š¡ªû
, 
id
);

435 ià(
obj
 !ğ
NULL
)

436  
obj
;

437 
obj
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_IDENTIFIER
);

438 ià(
obj
)

439 
	`li¡_add
(&
obj
->
li¡
, &
š¡ªû
->
u£d_objs_li¡
[
	`g‘_¡ršg_hash
(
id
)][
ALISP_OBJ_IDENTIFIER
]);

440 ià(
obj
 && (obj->
v®ue
.
s
 = 
	`¡rdup
(
id
)è=ğ
NULL
) {

441 
	`d–‘e_objeù
(
š¡ªû
, 
obj
);

442 
	`nomem
();

443  
NULL
;

445  
obj
;

446 
	}
}

448 
®i¥_objeù
 * 
	$Ãw_poš‹r
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
±r
)

450 
®i¥_objeù
 * 
obj
;

452 
obj
 = 
	`£¬ch_objeù_poš‹r
(
š¡ªû
, 
±r
);

453 ià(
obj
 !ğ
NULL
)

454  
obj
;

455 
obj
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_POINTER
);

456 ià(
obj
) {

457 
	`li¡_add
(&
obj
->
li¡
, &
š¡ªû
->
u£d_objs_li¡
[()
±r
 & 
ALISP_OBJ_PAIR_HASH_MASK
][
ALISP_OBJ_POINTER
]);

458 
obj
->
v®ue
.
±r
 =…tr;

460  
obj
;

461 
	}
}

463 
®i¥_objeù
 * 
	$Ãw_cÚs_poš‹r
(
®i¥_š¡ªû
 * 
š¡ªû
, cÚ¡ *
±r_id
, *
±r
)

465 
®i¥_objeù
 * 
Ëx´
;

467 ià(
±r
 =ğ
NULL
)

468  &
®§_li¥_n
;

469 
Ëx´
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

470 ià(
Ëx´
 =ğ
NULL
)

471  
NULL
;

472 
Ëx´
->
v®ue
.
c
.
ÿr
 = 
	`Ãw_¡ršg
(
š¡ªû
, 
±r_id
);

473 ià(
Ëx´
->
v®ue
.
c
.
ÿr
 =ğ
NULL
)

474 
__’d
;

475 
Ëx´
->
v®ue
.
c
.
cdr
 = 
	`Ãw_poš‹r
(
š¡ªû
, 
±r
);

476 ià(
Ëx´
->
v®ue
.
c
.
cdr
 =ğ
NULL
) {

477 
	`d–‘e_objeù
(
š¡ªû
, 
Ëx´
->
v®ue
.
c
.
ÿr
);

478 
__’d
:

479 
	`d–‘e_objeù
(
š¡ªû
, 
Ëx´
);

480  
NULL
;

482  
Ëx´
;

483 
	}
}

485 
	$®§_li¥_š™_objeùs
(è
	`__©Œibu‹__
 ((
cÚ¡ruùÜ
));

487 
	$®§_li¥_š™_objeùs
()

489 
	`mem£t
(&
®§_li¥_n
, 0, (alsa_lisp_nil));

490 
	`®i¥_£t_ty³
(&
®§_li¥_n
, 
ALISP_OBJ_NIL
);

491 
	`INIT_LIST_HEAD
(&
®§_li¥_n
.
li¡
);

492 
	`mem£t
(&
®§_li¥_t
, 0, (alsa_lisp_t));

493 
	`®i¥_£t_ty³
(&
®§_li¥_t
, 
ALISP_OBJ_T
);

494 
	`INIT_LIST_HEAD
(&
®§_li¥_t
.
li¡
);

495 
	}
}

501 
	$xg‘c
(
®i¥_š¡ªû
 *
š¡ªû
)

503 
š¡ªû
->
ch¬no
++;

504 ià(
š¡ªû
->
Ëx_buå
 > in¡ªû->
Ëx_buf
)

505  *--(
š¡ªû
->
Ëx_buå
);

506  
	`¢d_šput_g‘c
(
š¡ªû
->
š
);

507 
	}
}

509 
šlše
 
	$xung‘c
(
®i¥_š¡ªû
 *
š¡ªû
, 
c
)

511 *(
š¡ªû
->
Ëx_buå
)++ = 
c
;

512 
š¡ªû
->
ch¬no
--;

513 
	}
}

515 
	$š™_Ëx
(
®i¥_š¡ªû
 *
š¡ªû
)

517 
š¡ªû
->
ch¬no
 = in¡ªû->
lš’o
 = 1;

518 
š¡ªû
->
tok’_bufãr_max
 = 10;

519 ià((
š¡ªû
->
tok’_bufãr
 = (*)
	`m®loc
(š¡ªû->
tok’_bufãr_max
)è=ğ
NULL
) {

520 
	`nomem
();

521  -
ENOMEM
;

523 
š¡ªû
->
Ëx_buå
 = in¡ªû->
Ëx_buf
;

525 
	}
}

527 
	$dÚe_Ëx
(
®i¥_š¡ªû
 *
š¡ªû
)

529 
	`ä“
(
š¡ªû
->
tok’_bufãr
);

530 
	}
}

532 * 
	$ex‹nd_buf
(
®i¥_š¡ªû
 *
š¡ªû
, *
p
)

534 
off
 = 
p
 - 
š¡ªû
->
tok’_bufãr
;

536 
š¡ªû
->
tok’_bufãr_max
 += 10;

537 
š¡ªû
->
tok’_bufãr
 = (*)
	`»®loc
(š¡ªû->tok’_bufãr, in¡ªû->
tok’_bufãr_max
);

538 ià(
š¡ªû
->
tok’_bufãr
 =ğ
NULL
) {

539 
	`nomem
();

540  
NULL
;

543  
š¡ªû
->
tok’_bufãr
 + 
off
;

544 
	}
}

546 
	$g‘tok’
(
®i¥_š¡ªû
 *
š¡ªû
)

548 *
p
;

549 
c
;

552 
c
 = 
	`xg‘c
(
š¡ªû
);

553 
c
) {

555 ++
š¡ªû
->
lš’o
;

563 (
c
 = 
	`xg‘c
(
š¡ªû
)è!ğ'\n' && c !ğ
EOF
)

565 ià(
c
 !ğ
EOF
)

566 ++
š¡ªû
->
lš’o
;

571 
c
 = 
	`xg‘c
(
š¡ªû
);

572 
	`¥rštf
(
š¡ªû
->
tok’_bufãr
, "%d", 
c
);

573  
š¡ªû
->
thi¡ok’
 = 
ALISP_INTEGER
;

577 
c
 = 
	`xg‘c
(
š¡ªû
);

578 ià(!
	`isdig™
(
c
)) {

579 
	`xung‘c
(
š¡ªû
, 
c
);

580 
c
 = '-';

581 
gÙ_id
;

583 
	`xung‘c
(
š¡ªû
, 
c
);

584 
c
 = '-';

592 
p
 = 
š¡ªû
->
tok’_bufãr
;

593 
š¡ªû
->
thi¡ok’
 = 
ALISP_INTEGER
;

595 
__ok
:

596 ià(
p
 - 
š¡ªû
->
tok’_bufãr
 >ğš¡ªû->
tok’_bufãr_max
 - 1) {

597 
p
 = 
	`ex‹nd_buf
(
š¡ªû
,…);

598 ià(
p
 =ğ
NULL
)

599  
š¡ªû
->
thi¡ok’
 = 
EOF
;

601 *
p
++ = 
c
;

602 
c
 = 
	`xg‘c
(
š¡ªû
);

603 ià(
c
 =ğ'.' && 
š¡ªû
->
thi¡ok’
 =ğ
ALISP_INTEGER
) {

604 
c
 = 
	`xg‘c
(
š¡ªû
);

605 
	`xung‘c
(
š¡ªû
, 
c
);

606 ià(
	`isdig™
(
c
)) {

607 
š¡ªû
->
thi¡ok’
 = 
ALISP_FLOAT
;

608 
c
 = '.';

609 
__ok
;

611 
c
 = '.';

613 } ià(
c
 =ğ'e' && 
š¡ªû
->
thi¡ok’
 =ğ
ALISP_FLOAT
) {

614 
c
 = 
	`xg‘c
(
š¡ªû
);

615 ià(
	`isdig™
(
c
)) {

616 
š¡ªû
->
thi¡ok’
 = 
ALISP_FLOATE
;

617 
__ok
;

620 } 
	`isdig™
(
c
));

621 
	`xung‘c
(
š¡ªû
, 
c
);

622 *
p
 = '\0';

623  
š¡ªû
->
thi¡ok’
;

625 
gÙ_id
:

639 
p
 = 
š¡ªû
->
tok’_bufãr
;

641 ià(
p
 - 
š¡ªû
->
tok’_bufãr
 >ğš¡ªû->
tok’_bufãr_max
 - 1) {

642 
p
 = 
	`ex‹nd_buf
(
š¡ªû
,…);

643 ià(
p
 =ğ
NULL
)

644  
š¡ªû
->
thi¡ok’
 = 
EOF
;

646 *
p
++ = 
c
;

647 
c
 = 
	`xg‘c
(
š¡ªû
);

648 } 
	`i§Êum
(
c
è|| 
	`¡rchr
("!_-+*/%<>=&", cè!ğ
NULL
);

649 
	`xung‘c
(
š¡ªû
, 
c
);

650 *
p
 = '\0';

651  
š¡ªû
->
thi¡ok’
 = 
ALISP_IDENTIFIER
;

655 
p
 = 
š¡ªû
->
tok’_bufãr
;

656 (
c
 = 
	`xg‘c
(
š¡ªû
)è!ğ'"' && c !ğ
EOF
) {

657 ià(
p
 - 
š¡ªû
->
tok’_bufãr
 >ğš¡ªû->
tok’_bufãr_max
 - 1) {

658 
p
 = 
	`ex‹nd_buf
(
š¡ªû
,…);

659 ià(
p
 =ğ
NULL
)

660  
š¡ªû
->
thi¡ok’
 = 
EOF
;

662 ià(
c
 == '\\') {

663 
c
 = 
	`xg‘c
(
š¡ªû
);

664 
c
) {

665 '\n': ++
š¡ªû
->
lš’o
; ;

666 'a': *
p
++ = '\a'; ;

667 'b': *
p
++ = '\b'; ;

668 'f': *
p
++ = '\f'; ;

669 'n': *
p
++ = '\n'; ;

670 'r': *
p
++ = '\r'; ;

671 't': *
p
++ = '\t'; ;

672 'v': *
p
++ = '\v'; ;

673 : *
p
++ = 
c
;

676 ià(
c
 == '\n')

677 ++
š¡ªû
->
lš’o
;

678 *
p
++ = 
c
;

681 *
p
 = '\0';

682  
š¡ªû
->
thi¡ok’
 = 
ALISP_STRING
;

685  
š¡ªû
->
thi¡ok’
 = 
c
;

688 
	}
}

694 
®i¥_objeù
 * 
	$·r£_fÜm
(
®i¥_š¡ªû
 *
š¡ªû
)

696 
thi¡ok’
;

697 
®i¥_objeù
 * 
p
, * 
fœ¡
 = 
NULL
, * 
´ev
 = NULL;

699 (
thi¡ok’
 = 
	`g‘tok’
(
š¡ªû
)è!ğ')' &&hi¡ok’ !ğ
EOF
) {

703 ià(
thi¡ok’
 == '.') {

704 
	`g‘tok’
(
š¡ªû
);

705 ià(
´ev
 =ğ
NULL
) {

706 
	`li¥_”rÜ
(
š¡ªû
, "unexpected '.'");

707 
__”r
:

708 
	`d–‘e_Œ“
(
š¡ªû
, 
fœ¡
);

709  
NULL
;

711 
´ev
->
v®ue
.
c
.
cdr
 = 
	`·r£_objeù
(
š¡ªû
, 1);

712 ià(
´ev
->
v®ue
.
c
.
cdr
 =ğ
NULL
)

713 
__”r
;

714 ià((
thi¡ok’
 = 
	`g‘tok’
(
š¡ªû
)) != ')') {

715 
	`li¥_”rÜ
(
š¡ªû
, "expected ')'");

716 
__”r
;

721 
p
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

722 ià(
p
 =ğ
NULL
)

723 
__”r
;

725 ià(
fœ¡
 =ğ
NULL
)

726 
fœ¡
 = 
p
;

727 ià(
´ev
 !ğ
NULL
)

728 
´ev
->
v®ue
.
c
.
cdr
 = 
p
;

730 
p
->
v®ue
.
c
.
ÿr
 = 
	`·r£_objeù
(
š¡ªû
, 1);

731 ià(
p
->
v®ue
.
c
.
ÿr
 =ğ
NULL
)

732 
__”r
;

734 
´ev
 = 
p
;

737 ià(
fœ¡
 =ğ
NULL
)

738  &
®§_li¥_n
;

740  
fœ¡
;

741 
	}
}

743 
®i¥_objeù
 * 
	$quÙe_objeù
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
obj
)

745 
®i¥_objeù
 * 
p
;

747 ià(
obj
 =ğ
NULL
)

748 
__’d1
;

750 
p
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

751 ià(
p
 =ğ
NULL
)

752 
__’d1
;

754 
p
->
v®ue
.
c
.
ÿr
 = 
	`Ãw_id’tif›r
(
š¡ªû
, "quote");

755 ià(
p
->
v®ue
.
c
.
ÿr
 =ğ
NULL
)

756 
__’d
;

757 
p
->
v®ue
.
c
.
cdr
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

758 ià(
p
->
v®ue
.
c
.
cdr
 =ğ
NULL
) {

759 
	`d–‘e_objeù
(
š¡ªû
, 
p
->
v®ue
.
c
.
ÿr
);

760 
__’d
:

761 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

762 
__’d1
:

763 
	`d–‘e_Œ“
(
š¡ªû
, 
obj
);

764  
NULL
;

767 
p
->
v®ue
.
c
.
cdr
->v®ue.c.
ÿr
 = 
obj
;

768  
p
;

769 
	}
}

771 
šlše
 
®i¥_objeù
 * 
	$·r£_quÙe
(
®i¥_š¡ªû
 *
š¡ªû
)

773  
	`quÙe_objeù
(
š¡ªû
, 
	`·r£_objeù
(instance, 0));

774 
	}
}

776 
®i¥_objeù
 * 
	$·r£_objeù
(
®i¥_š¡ªû
 *
š¡ªû
, 
hav‘ok’
)

778 
thi¡ok’
;

779 
®i¥_objeù
 * 
p
 = 
NULL
;

781 ià(!
hav‘ok’
)

782 
thi¡ok’
 = 
	`g‘tok’
(
š¡ªû
);

784 
thi¡ok’
 = 
š¡ªû
->thistoken;

786 
thi¡ok’
) {

787 
EOF
:

790 
p
 = 
	`·r£_fÜm
(
š¡ªû
);

793 
p
 = 
	`·r£_quÙe
(
š¡ªû
);

795 
ALISP_IDENTIFIER
:

796 ià(!
	`¡rcmp
(
š¡ªû
->
tok’_bufãr
, "t"))

797 
p
 = &
®§_li¥_t
;

798 ià(!
	`¡rcmp
(
š¡ªû
->
tok’_bufãr
, "nil"))

799 
p
 = &
®§_li¥_n
;

801 
p
 = 
	`Ãw_id’tif›r
(
š¡ªû
, in¡ªû->
tok’_bufãr
);

804 
ALISP_INTEGER
: {

805 
p
 = 
	`Ãw_š‹g”
(
š¡ªû
, 
	`©Ş
(š¡ªû->
tok’_bufãr
));

808 
ALISP_FLOAT
:

809 
ALISP_FLOATE
: {

810 
p
 = 
	`Ãw_æßt
(
š¡ªû
, 
	`©of
(š¡ªû->
tok’_bufãr
));

813 
ALISP_STRING
:

814 
p
 = 
	`Ãw_¡ršg
(
š¡ªû
, in¡ªû->
tok’_bufãr
);

817 
	`li¥_w¬n
(
š¡ªû
, "%d:%d: uÃx³ùed ch¬aù” `%c'", in¡ªû->
lš’o
, in¡ªû->
ch¬no
, 
thi¡ok’
);

821  
p
;

822 
	}
}

828 
®i¥_objeù_·œ
 * 
	$£t_objeù_dœeù
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
Çme
, ®i¥_objeù * 
v®ue
)

830 
®i¥_objeù_·œ
 *
p
;

831 cÚ¡ *
id
;

833 
id
 = 
Çme
->
v®ue
.
s
;

834 
p
 = (
®i¥_objeù_·œ
 *)
	`m®loc
((alisp_object_pair));

835 ià(
p
 =ğ
NULL
) {

836 
	`nomem
();

837  
NULL
;

839 
p
->
Çme
 = 
	`¡rdup
(
id
);

840 ià(
p
->
Çme
 =ğ
NULL
) {

841 
	`d–‘e_Œ“
(
š¡ªû
, 
v®ue
);

842 
	`ä“
(
p
);

843  
NULL
;

845 
	`li¡_add
(&
p
->
li¡
, &
š¡ªû
->
£tobjs_li¡
[
	`g‘_¡ršg_hash
(
id
)]);

846 
p
->
v®ue
 = value;

847  
p
;

848 
	}
}

850 
	$check_£t_objeù
(
®i¥_š¡ªû
 * 
š¡ªû
, 
®i¥_objeù
 * 
Çme
)

852 ià(
Çme
 =ğ&
®§_li¥_n
) {

853 
	`li¥_w¬n
(
š¡ªû
, "settinghe value of‡‚il object");

856 ià(
Çme
 =ğ&
®§_li¥_t
) {

857 
	`li¥_w¬n
(
š¡ªû
, "settinghe value of‡ object");

860 ià(!
	`®i¥_com·»_ty³
(
Çme
, 
ALISP_OBJ_IDENTIFIER
) &&

861 !
	`®i¥_com·»_ty³
(
Çme
, 
ALISP_OBJ_STRING
)) {

862 
	`li¥_w¬n
(
š¡ªû
, "settinghe value of‡n object with‚on-indentifier");

866 
	}
}

868 
®i¥_objeù_·œ
 * 
	$£t_objeù
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
Çme
, ®i¥_objeù * 
v®ue
)

870 
li¡_h—d
 *
pos
;

871 
®i¥_objeù_·œ
 *
p
;

872 cÚ¡ *
id
;

874 ià(
Çme
 =ğ
NULL
 || 
v®ue
 == NULL)

875  
NULL
;

877 
id
 = 
Çme
->
v®ue
.
s
;

879 
	`li¡_fÜ_—ch
(
pos
, &
š¡ªû
->
£tobjs_li¡
[
	`g‘_¡ršg_hash
(
id
)]) {

880 
p
 = 
	`li¡_’Œy
(
pos
, 
®i¥_objeù_·œ
, 
li¡
);

881 ià(!
	`¡rcmp
(
p
->
Çme
, 
id
)) {

882 
	`d–‘e_Œ“
(
š¡ªû
, 
p
->
v®ue
);

883 
p
->
v®ue
 = value;

884  
p
;

888 
p
 = (
®i¥_objeù_·œ
 *)
	`m®loc
((alisp_object_pair));

889 ià(
p
 =ğ
NULL
) {

890 
	`nomem
();

891  
NULL
;

893 
p
->
Çme
 = 
	`¡rdup
(
id
);

894 ià(
p
->
Çme
 =ğ
NULL
) {

895 
	`d–‘e_Œ“
(
š¡ªû
, 
v®ue
);

896 
	`ä“
(
p
);

897  
NULL
;

899 
	`li¡_add
(&
p
->
li¡
, &
š¡ªû
->
£tobjs_li¡
[
	`g‘_¡ršg_hash
(
id
)]);

900 
p
->
v®ue
 = value;

901  
p
;

902 
	}
}

904 
®i¥_objeù
 * 
	$un£t_objeù
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
Çme
)

906 
li¡_h—d
 *
pos
;

907 
®i¥_objeù
 *
»s
;

908 
®i¥_objeù_·œ
 *
p
;

909 cÚ¡ *
id
;

911 ià(!
	`®i¥_com·»_ty³
(
Çme
, 
ALISP_OBJ_IDENTIFIER
) &&

912 !
	`®i¥_com·»_ty³
(
Çme
, 
ALISP_OBJ_STRING
)) {

913 
	`li¥_w¬n
(
š¡ªû
, "unset object with‡‚on-indentifier");

914  &
®§_li¥_n
;

916 
id
 = 
Çme
->
v®ue
.
s
;

918 
	`li¡_fÜ_—ch
(
pos
, &
š¡ªû
->
£tobjs_li¡
[
	`g‘_¡ršg_hash
(
id
)]) {

919 
p
 = 
	`li¡_’Œy
(
pos
, 
®i¥_objeù_·œ
, 
li¡
);

920 ià(!
	`¡rcmp
(
p
->
Çme
, 
id
)) {

921 
	`li¡_d–
(&
p
->
li¡
);

922 
»s
 = 
p
->
v®ue
;

923 
	`ä“
((*)
p
->
Çme
);

924 
	`ä“
(
p
);

925  
»s
;

929  &
®§_li¥_n
;

930 
	}
}

932 
®i¥_objeù
 * 
	$g‘_objeù1
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
id
)

934 
®i¥_objeù_·œ
 *
p
;

935 
li¡_h—d
 *
pos
;

937 
	`li¡_fÜ_—ch
(
pos
, &
š¡ªû
->
£tobjs_li¡
[
	`g‘_¡ršg_hash
(
id
)]) {

938 
p
 = 
	`li¡_’Œy
(
pos
, 
®i¥_objeù_·œ
, 
li¡
);

939 ià(!
	`¡rcmp
(
p
->
Çme
, 
id
))

940  
p
->
v®ue
;

943  &
®§_li¥_n
;

944 
	}
}

946 
®i¥_objeù
 * 
	$g‘_objeù
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
Çme
)

948 ià(!
	`®i¥_com·»_ty³
(
Çme
, 
ALISP_OBJ_IDENTIFIER
) &&

949 !
	`®i¥_com·»_ty³
(
Çme
, 
ALISP_OBJ_STRING
)) {

950 
	`d–‘e_Œ“
(
š¡ªû
, 
Çme
);

951  &
®§_li¥_n
;

953  
	`g‘_objeù1
(
š¡ªû
, 
Çme
->
v®ue
.
s
);

954 
	}
}

956 
®i¥_objeù
 * 
	$»¶aû_objeù
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
Çme
, ®i¥_objeù * 
Úew
)

958 
®i¥_objeù_·œ
 *
p
;

959 
®i¥_objeù
 *
r
;

960 
li¡_h—d
 *
pos
;

961 cÚ¡ *
id
;

963 ià(!
	`®i¥_com·»_ty³
(
Çme
, 
ALISP_OBJ_IDENTIFIER
) &&

964 !
	`®i¥_com·»_ty³
(
Çme
, 
ALISP_OBJ_STRING
)) {

965 
	`d–‘e_Œ“
(
š¡ªû
, 
Çme
);

966  &
®§_li¥_n
;

968 
id
 = 
Çme
->
v®ue
.
s
;

969 
	`li¡_fÜ_—ch
(
pos
, &
š¡ªû
->
£tobjs_li¡
[
	`g‘_¡ršg_hash
(
id
)]) {

970 
p
 = 
	`li¡_’Œy
(
pos
, 
®i¥_objeù_·œ
, 
li¡
);

971 ià(!
	`¡rcmp
(
p
->
Çme
, 
id
)) {

972 
r
 = 
p
->
v®ue
;

973 
p
->
v®ue
 = 
Úew
;

974  
r
;

978  
NULL
;

979 
	}
}

981 
	$dump_objeùs
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
âame
)

983 
®i¥_objeù_·œ
 *
p
;

984 
¢d_ouut_t
 *
out
;

985 
li¡_h—d
 *
pos
;

986 
i
, 
”r
;

988 ià(!
	`¡rcmp
(
âame
, "-"))

989 
”r
 = 
	`¢d_ouut_¡dio_©ch
(&
out
, 
¡dout
, 0);

991 
”r
 = 
	`¢d_ouut_¡dio_İ’
(&
out
, 
âame
, "w+");

992 ià(
”r
 < 0) {

993 
	`SNDERR
("®i¥: cªnÙ o³Àf'%s' fÜ wr™šg (%s)", 
âame
, 
	`¢d_¡»¼Ü
(
”ºo
));

997 
i
 = 0; i < 
ALISP_OBJ_PAIR_HASH_SIZE
; i++) {

998 
	`li¡_fÜ_—ch
(
pos
, &
š¡ªû
->
£tobjs_li¡
[
i
]) {

999 
p
 = 
	`li¡_’Œy
(
pos
, 
®i¥_objeù_·œ
, 
li¡
);

1000 ià(
	`®i¥_com·»_ty³
(
p
->
v®ue
, 
ALISP_OBJ_CONS
) &&

1001 
	`®i¥_com·»_ty³
(
p
->
v®ue
->v®ue.
c
.
ÿr
, 
ALISP_OBJ_IDENTIFIER
) &&

1002 !
	`¡rcmp
(
p
->
v®ue
->v®ue.
c
.
ÿr
->v®ue.
s
, "lambda")) {

1003 
	`¢d_ouut_´štf
(
out
, "(defuÀ% ", 
p
->
Çme
);

1004 
	`´šc_cÚs
(
out
, 
p
->
v®ue
->v®ue.
c
.
cdr
);

1005 
	`¢d_ouut_´štf
(
out
, ")\n");

1008 
	`¢d_ouut_´štf
(
out
, "(£tq % '", 
p
->
Çme
);

1009 
	`´šc_objeù
(
out
, 
p
->
v®ue
);

1010 
	`¢d_ouut_´štf
(
out
, ")\n");

1013 
	`¢d_ouut_şo£
(
out
);

1014 
	}
}

1016 cÚ¡ *
	$obj_ty³_¡r
(
®i¥_objeù
 * 
p
)

1018 
	`®i¥_g‘_ty³
(
p
)) {

1019 
ALISP_OBJ_NIL
:  "nil";

1020 
ALISP_OBJ_T
:  "t";

1021 
ALISP_OBJ_INTEGER
:  "integer";

1022 
ALISP_OBJ_FLOAT
:  "float";

1023 
ALISP_OBJ_IDENTIFIER
:  "identifier";

1024 
ALISP_OBJ_STRING
:  "string";

1025 
ALISP_OBJ_POINTER
:  "pointer";

1026 
ALISP_OBJ_CONS
:  "cons";

1027 : 
	`as£¹
(0);

1029 
	}
}

1031 
	$´št_obj_li¡s
(
®i¥_š¡ªû
 *
š¡ªû
, 
¢d_ouut_t
 *
out
)

1033 
li¡_h—d
 *
pos
;

1034 
®i¥_objeù
 * 
p
;

1035 
i
, 
j
;

1037 
	`¢d_ouut_´štf
(
out
, "** used objects\n");

1038 
i
 = 0; i < 
ALISP_OBJ_PAIR_HASH_SIZE
; i++)

1039 
j
 = 0; j <ğ
ALISP_OBJ_LAST_SEARCH
; j++)

1040 
	`li¡_fÜ_—ch
(
pos
, &
š¡ªû
->
u£d_objs_li¡
[
i
][
j
]) {

1041 
p
 = 
	`li¡_’Œy
(
pos
, 
®i¥_objeù
, 
li¡
);

1042 
	`¢d_ouut_´štf
(
out
, "** %°(%sè(", 
p
, 
	`obj_ty³_¡r
(p));

1043 ià(!
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_CONS
))

1044 
	`´šc_objeù
(
out
, 
p
);

1046 
	`¢d_ouut_´štf
(
out
, "cons");

1047 
	`¢d_ouut_´štf
(
out
, "è»fs=%i\n", 
	`®i¥_g‘_»fs
(
p
));

1049 
	`¢d_ouut_´štf
(
out
, "** free objects\n");

1050 
	`li¡_fÜ_—ch
(
pos
, &
š¡ªû
->
ä“_objs_li¡
) {

1051 
p
 = 
	`li¡_’Œy
(
pos
, 
®i¥_objeù
, 
li¡
);

1052 
	`¢d_ouut_´štf
(
out
, "** %p\n", 
p
);

1054 
	}
}

1056 
	$dump_obj_li¡s
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
âame
)

1058 
¢d_ouut_t
 *
out
;

1059 
”r
;

1061 ià(!
	`¡rcmp
(
âame
, "-"))

1062 
”r
 = 
	`¢d_ouut_¡dio_©ch
(&
out
, 
¡dout
, 0);

1064 
”r
 = 
	`¢d_ouut_¡dio_İ’
(&
out
, 
âame
, "w+");

1065 ià(
”r
 < 0) {

1066 
	`SNDERR
("®i¥: cªnÙ o³Àf'%s' fÜ wr™šg (%s)", 
âame
, 
	`¢d_¡»¼Ü
(
”ºo
));

1070 
	`´št_obj_li¡s
(
š¡ªû
, 
out
);

1072 
	`¢d_ouut_şo£
(
out
);

1073 
	}
}

1079 
	$couÁ_li¡
(
®i¥_objeù
 * 
p
)

1081 
i
 = 0;

1083 
p
 !ğ&
®§_li¥_n
 && 
	`®i¥_com·»_ty³
Õ, 
ALISP_OBJ_CONS
)) {

1084 
p
 =…->
v®ue
.
c
.
cdr
;

1085 ++
i
;

1088  
i
;

1089 
	}
}

1091 
šlše
 
®i¥_objeù
 * 
	$ÿr
(
®i¥_objeù
 * 
p
)

1093 ià(
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_CONS
))

1094  
p
->
v®ue
.
c
.
ÿr
;

1096  &
®§_li¥_n
;

1097 
	}
}

1099 
šlše
 
®i¥_objeù
 * 
	$cdr
(
®i¥_objeù
 * 
p
)

1101 ià(
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_CONS
))

1102  
p
->
v®ue
.
c
.
cdr
;

1104  &
®§_li¥_n
;

1105 
	}
}

1110 
®i¥_objeù
 * 
	$F_ÿr
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1112 
®i¥_objeù
 *
p1
 = 
	`ÿr
(
¬gs
), *
p2
;

1113 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

1114 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

1115 
p1
 = 
	`ev®
(
š¡ªû
,…1);

1116 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
p1
));

1117 
p2
 = 
	`ÿr
(
p1
);

1118 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

1119  
p2
;

1120 
	}
}

1125 
®i¥_objeù
 * 
	$F_cdr
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1127 
®i¥_objeù
 *
p1
 = 
	`ÿr
(
¬gs
), *
p2
;

1128 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

1129 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

1130 
p1
 = 
	`ev®
(
š¡ªû
,…1);

1131 
	`d–‘e_Œ“
(
š¡ªû
, 
	`ÿr
(
p1
));

1132 
p2
 = 
	`cdr
(
p1
);

1133 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

1134  
p2
;

1135 
	}
}

1140 
®i¥_objeù
 * 
	$F_add
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1142 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
p1
, * 
n
;

1143 
v
 = 0;

1144 
f
 = 0;

1145 
ty³
 = 
ALISP_OBJ_INTEGER
;

1147 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

1149 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
)) {

1150 ià(
ty³
 =ğ
ALISP_OBJ_FLOAT
)

1151 
f
 +ğ
p1
->
v®ue
.
i
;

1153 
v
 +ğ
p1
->
v®ue
.
i
;

1154 } ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_FLOAT
)) {

1155 
f
 +ğ
p1
->
v®ue
.à+ 
v
;

1156 
v
 = 0;

1157 
ty³
 = 
ALISP_OBJ_FLOAT
;

1159 
	`li¥_w¬n
(
š¡ªû
, "sum with‡‚on integer or float operand");

1161 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1162 
p
 = 
	`cdr
(
n
 =…);

1163 
	`d–‘e_objeù
(
š¡ªû
, 
n
);

1164 ià(
p
 =ğ&
®§_li¥_n
)

1166 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

1168 ià(
ty³
 =ğ
ALISP_OBJ_INTEGER
) {

1169  
	`Ãw_š‹g”
(
š¡ªû
, 
v
);

1171  
	`Ãw_æßt
(
š¡ªû
, 
f
);

1173 
	}
}

1178 
®i¥_objeù
 * 
	$F_cÚÿt
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1180 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
p1
, * 
n
;

1181 *
¡r
 = 
NULL
, *
¡r1
;

1183 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

1185 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_STRING
)) {

1186 
¡r1
 = 
	`»®loc
(
¡r
, (¡¸? 
	`¡¾’
(¡rè: 0è+ sŒËn(
p1
->
v®ue
.
s
) + 1);

1187 ià(
¡r1
 =ğ
NULL
) {

1188 
	`nomem
();

1189 
	`ä“
(
¡r
);

1190  
NULL
;

1192 ià(
¡r
 =ğ
NULL
)

1193 
	`¡rıy
(
¡r1
, 
p1
->
v®ue
.
s
);

1195 
	`¡rÿt
(
¡r1
, 
p1
->
v®ue
.
s
);

1196 
¡r
 = 
¡r1
;

1198 
	`li¥_w¬n
(
š¡ªû
, "concat with‡‚on string or identifier operand");

1200 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1201 
p
 = 
	`cdr
(
n
 =…);

1202 
	`d–‘e_objeù
(
š¡ªû
, 
n
);

1203 ià(
p
 =ğ&
®§_li¥_n
)

1205 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

1207 ià(
¡r
) {

1208 
p
 = 
	`Ãw_¡ršg
(
š¡ªû
, 
¡r
);

1209 
	`ä“
(
¡r
);

1211 
p
 = &
®§_li¥_n
;

1213  
p
;

1214 
	}
}

1219 
®i¥_objeù
 * 
	$F_sub
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1221 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
p1
, * 
n
;

1222 
v
 = 0;

1223 
f
 = 0;

1224 
ty³
 = 
ALISP_OBJ_INTEGER
;

1227 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

1228 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
)) {

1229 ià(
p
 =ğ
¬gs
 && 
	`cdr
Õè!ğ&
®§_li¥_n
) {

1230 
v
 = 
p1
->
v®ue
.
i
;

1232 ià(
ty³
 =ğ
ALISP_OBJ_FLOAT
)

1233 
f
 -ğ
p1
->
v®ue
.
i
;

1235 
v
 -ğ
p1
->
v®ue
.
i
;

1237 } ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_FLOAT
)) {

1238 ià(
ty³
 =ğ
ALISP_OBJ_INTEGER
) {

1239 
f
 = 
v
;

1240 
ty³
 = 
ALISP_OBJ_FLOAT
;

1242 ià(
p
 =ğ
¬gs
 && 
	`cdr
Õè!ğ&
®§_li¥_n
)

1243 
f
 = 
p1
->
v®ue
.f;

1245 
f
 -ğ
p1
->
v®ue
.f;

1248 
	`li¥_w¬n
(
š¡ªû
, "difference with‡‚on integer or float operand");

1249 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1250 
n
 = 
	`cdr
(
p
);

1251 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

1252 
p
 = 
n
;

1253 } 
p
 !ğ&
®§_li¥_n
);

1255 ià(
ty³
 =ğ
ALISP_OBJ_INTEGER
) {

1256  
	`Ãw_š‹g”
(
š¡ªû
, 
v
);

1258  
	`Ãw_æßt
(
š¡ªû
, 
f
);

1260 
	}
}

1265 
®i¥_objeù
 * 
	$F_mul
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1267 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
p1
, * 
n
;

1268 
v
 = 1;

1269 
f
 = 1;

1270 
ty³
 = 
ALISP_OBJ_INTEGER
;

1273 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

1274 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
)) {

1275 ià(
ty³
 =ğ
ALISP_OBJ_FLOAT
)

1276 
f
 *ğ
p1
->
v®ue
.
i
;

1278 
v
 *ğ
p1
->
v®ue
.
i
;

1279 } ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_FLOAT
)) {

1280 
f
 *ğ
p1
->
v®ue
.à* 
v
; v = 1;

1281 
ty³
 = 
ALISP_OBJ_FLOAT
;

1283 
	`li¥_w¬n
(
š¡ªû
, "product with‡‚on integer or float operand");

1285 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1286 
n
 = 
	`cdr
(
p
);

1287 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

1288 
p
 = 
n
;

1289 } 
p
 !ğ&
®§_li¥_n
);

1291 ià(
ty³
 =ğ
ALISP_OBJ_INTEGER
) {

1292  
	`Ãw_š‹g”
(
š¡ªû
, 
v
);

1294  
	`Ãw_æßt
(
š¡ªû
, 
f
);

1296 
	}
}

1301 
®i¥_objeù
 * 
	$F_div
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1303 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
p1
, * 
n
;

1304 
v
 = 0;

1305 
f
 = 0;

1306 
ty³
 = 
ALISP_OBJ_INTEGER
;

1309 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

1310 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
)) {

1311 ià(
p
 =ğ
¬gs
 && 
	`cdr
Õè!ğ&
®§_li¥_n
) {

1312 
v
 = 
p1
->
v®ue
.
i
;

1314 ià(
p1
->
v®ue
.
i
 == 0) {

1315 
	`li¥_w¬n
(
š¡ªû
, "division by zero");

1316 
v
 = 0;

1317 
f
 = 0;

1320 ià(
ty³
 =ğ
ALISP_OBJ_FLOAT
)

1321 
f
 /ğ
p1
->
v®ue
.
i
;

1323 
v
 /ğ
p1
->
v®ue
.
i
;

1326 } ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_FLOAT
)) {

1327 ià(
ty³
 =ğ
ALISP_OBJ_INTEGER
) {

1328 
f
 = 
v
;

1329 
ty³
 = 
ALISP_OBJ_FLOAT
;

1331 ià(
p
 =ğ
¬gs
 && 
	`cdr
Õè!ğ&
®§_li¥_n
) {

1332 
f
 = 
p1
->
v®ue
.f;

1334 ià(
p1
->
v®ue
.
f
 == 0) {

1335 
	`li¥_w¬n
(
š¡ªû
, "division by zero");

1336 
f
 = 0;

1339 
f
 /ğ
p1
->
v®ue
.
i
;

1343 
	`li¥_w¬n
(
š¡ªû
, "quotient with‡‚on integer or float operand");

1344 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1345 
n
 = 
	`cdr
(
p
);

1346 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

1347 
p
 = 
n
;

1348 } 
p
 !ğ&
®§_li¥_n
);

1350 ià(
ty³
 =ğ
ALISP_OBJ_INTEGER
) {

1351  
	`Ãw_š‹g”
(
š¡ªû
, 
v
);

1353  
	`Ãw_æßt
(
š¡ªû
, 
f
);

1355 
	}
}

1360 
®i¥_objeù
 * 
	$F_mod
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1362 
®i¥_objeù
 * 
p1
, * 
p2
, * 
p3
;

1364 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

1365 
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
¬gs
)));

1366 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

1367 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

1368 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

1370 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
) &&

1371 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
)) {

1372 ià(
p2
->
v®ue
.
i
 == 0) {

1373 
	`li¥_w¬n
(
š¡ªû
, "module by zero");

1374 
p3
 = 
	`Ãw_š‹g”
(
š¡ªû
, 0);

1376 
p3
 = 
	`Ãw_š‹g”
(
š¡ªû
, 
p1
->
v®ue
.
i
 % 
p2
->value.i);

1378 } ià((
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
) ||

1379 
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_FLOAT
)) &&

1380 (
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
) ||

1381 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_FLOAT
))) {

1382 
f1
, 
f2
;

1383 
f1
 = 
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
è?…1->
v®ue
.
i
 :…1->v®ue.
f
;

1384 
f2
 = 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
è?…2->
v®ue
.
i
 :…2->v®ue.
f
;

1385 
f1
 = 
	`fmod
(f1, 
f2
);

1386 ià(
f1
 =ğ
EDOM
) {

1387 
	`li¥_w¬n
(
š¡ªû
, "module by zero");

1388 
p3
 = 
	`Ãw_æßt
(
š¡ªû
, 0);

1390 
p3
 = 
	`Ãw_æßt
(
š¡ªû
, 
f1
);

1393 
	`li¥_w¬n
(
š¡ªû
, "module with‡‚on integer or float operand");

1394 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1395 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1396  &
®§_li¥_n
;

1399 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1400 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1401  
p3
;

1402 
	}
}

1407 
®i¥_objeù
 * 
	$F_É
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1409 
®i¥_objeù
 * 
p1
, * 
p2
;

1411 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

1412 
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
¬gs
)));

1413 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

1414 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

1415 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

1417 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
) &&

1418 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
)) {

1419 ià(
p1
->
v®ue
.
i
 < 
p2
->value.i) {

1420 
__Œue
:

1421 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1422 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1423  &
®§_li¥_t
;

1425 } ià((
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
) ||

1426 
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_FLOAT
)) &&

1427 (
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
) ||

1428 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_FLOAT
))) {

1429 
f1
, 
f2
;

1430 
f1
 = 
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
è?…1->
v®ue
.
i
 :…1->v®ue.
f
;

1431 
f2
 = 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
è?…2->
v®ue
.
i
 :…2->v®ue.
f
;

1432 ià(
f1
 < 
f2
)

1433 
__Œue
;

1435 
	`li¥_w¬n
(
š¡ªû
, "comparison with‡‚on integer or float operand");

1438 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1439 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1440  &
®§_li¥_n
;

1441 
	}
}

1446 
®i¥_objeù
 * 
	$F_gt
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1448 
®i¥_objeù
 * 
p1
, * 
p2
;

1450 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

1451 
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
¬gs
)));

1452 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

1453 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

1454 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

1456 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
) &&

1457 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
)) {

1458 ià(
p1
->
v®ue
.
i
 > 
p2
->value.i) {

1459 
__Œue
:

1460 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1461 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1462  &
®§_li¥_t
;

1464 } ià((
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
) ||

1465 
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_FLOAT
)) &&

1466 (
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
) ||

1467 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_FLOAT
))) {

1468 
f1
, 
f2
;

1469 
f1
 = 
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
è?…1->
v®ue
.
i
 :…1->v®ue.
f
;

1470 
f2
 = 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
è?…2->
v®ue
.
i
 :…2->v®ue.
f
;

1471 ià(
f1
 > 
f2
)

1472 
__Œue
;

1474 
	`li¥_w¬n
(
š¡ªû
, "comparison with‡‚on integer or float operand");

1477 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1478 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1479  &
®§_li¥_n
;

1480 
	}
}

1485 
®i¥_objeù
 * 
	$F_Ë
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1487 
®i¥_objeù
 * 
p1
, * 
p2
;

1489 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

1490 
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
¬gs
)));

1491 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

1492 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

1493 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

1495 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
) &&

1496 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
)) {

1497 ià(
p1
->
v®ue
.
i
 <ğ
p2
->value.i) {

1498 
__Œue
:

1499 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1500 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1501  &
®§_li¥_t
;

1503 } ià((
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
) ||

1504 
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_FLOAT
)) &&

1505 (
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
) ||

1506 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_FLOAT
))) {

1507 
f1
, 
f2
;

1508 
f1
 = 
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
è?…1->
v®ue
.
i
 :…1->v®ue.
f
;

1509 
f2
 = 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
è?…2->
v®ue
.
i
 :…2->v®ue.
f
;

1510 ià(
f1
 <ğ
f2
)

1511 
__Œue
;

1513 
	`li¥_w¬n
(
š¡ªû
, "comparison with‡‚on integer or float operand");

1516 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1517 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1518  &
®§_li¥_n
;

1519 
	}
}

1524 
®i¥_objeù
 * 
	$F_ge
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1526 
®i¥_objeù
 * 
p1
, * 
p2
;

1528 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

1529 
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
¬gs
)));

1530 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

1531 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

1532 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

1534 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
) &&

1535 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
)) {

1536 ià(
p1
->
v®ue
.
i
 >ğ
p2
->value.i) {

1537 
__Œue
:

1538 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1539 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1540  &
®§_li¥_t
;

1542 } ià((
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
) ||

1543 
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_FLOAT
)) &&

1544 (
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
) ||

1545 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_FLOAT
))) {

1546 
f1
, 
f2
;

1547 
f1
 = 
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
è?…1->
v®ue
.
i
 :…1->v®ue.
f
;

1548 
f2
 = 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
è?…2->
v®ue
.
i
 :…2->v®ue.
f
;

1549 ià(
f1
 >ğ
f2
)

1550 
__Œue
;

1552 
	`li¥_w¬n
(
š¡ªû
, "comparison with‡‚on integer or float operand");

1555 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1556 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1557  &
®§_li¥_n
;

1558 
	}
}

1563 
®i¥_objeù
 * 
	$F_numeq
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1565 
®i¥_objeù
 * 
p1
, * 
p2
;

1567 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

1568 
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
¬gs
)));

1569 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

1570 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

1571 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

1573 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
) &&

1574 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
)) {

1575 ià(
p1
->
v®ue
.
i
 =ğ
p2
->value.i) {

1576 
__Œue
:

1577 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1578 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1579  &
®§_li¥_t
;

1581 } ià((
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
) ||

1582 
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_FLOAT
)) &&

1583 (
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
) ||

1584 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_FLOAT
))) {

1585 
f1
, 
f2
;

1586 
f1
 = 
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
è?…1->
v®ue
.
i
 :…1->v®ue.
f
;

1587 
f2
 = 
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_INTEGER
è?…2->
v®ue
.
i
 :…2->v®ue.
f
;

1588 ià(
f1
 =ğ
f2
)

1589 
__Œue
;

1591 
	`li¥_w¬n
(
š¡ªû
, "comparison with‡‚on integer or float operand");

1594 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1595 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1596  &
®§_li¥_n
;

1597 
	}
}

1602 
®i¥_objeù
 * 
	$F_numÃq
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1604 
®i¥_objeù
 * 
p
;

1606 
p
 = 
	`F_numeq
(
š¡ªû
, 
¬gs
);

1607 ià(
p
 =ğ&
®§_li¥_n
)

1608  &
®§_li¥_t
;

1609  &
®§_li¥_n
;

1610 
	}
}

1616 
®i¥_objeù
 * 
	$F_exfun
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1618 
®i¥_objeù
 * 
p1
, * 
p2
;

1620 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

1621 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

1622 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

1623 
p2
 = 
	`g‘_objeù
(
š¡ªû
, 
p1
);

1624 ià(
p2
 =ğ&
®§_li¥_n
) {

1625 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1626  &
®§_li¥_n
;

1628 
p2
 = 
	`ÿr
(p2);

1629 ià(
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_IDENTIFIER
) &&

1630 !
	`¡rcmp
(
p2
->
v®ue
.
s
, "lambda")) {

1631 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1632  &
®§_li¥_t
;

1634 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1635  &
®§_li¥_n
;

1636 
	}
}

1638 
	$´šc_¡ršg
(
¢d_ouut_t
 *
out
, *
s
)

1640 *
p
;

1642 
	`¢d_ouut_putc
(
out
, '"');

1643 
p
 = 
s
; *p != '\0'; ++p)

1644 *
p
) {

1645 '\a': 
	`¢d_ouut_putc
(
out
, '\\'); snd_output_putc(out, 'a'); ;

1646 '\b': 
	`¢d_ouut_putc
(
out
, '\\'); snd_output_putc(out, 'b'); ;

1647 '\f': 
	`¢d_ouut_putc
(
out
, '\\'); snd_output_putc(out, 'f'); ;

1648 '\n': 
	`¢d_ouut_putc
(
out
, '\\'); snd_output_putc(out, 'n'); ;

1649 '\r': 
	`¢d_ouut_putc
(
out
, '\\'); snd_output_putc(out, 'r'); ;

1650 '\t': 
	`¢d_ouut_putc
(
out
, '\\'); snd_output_putc(out, 't'); ;

1651 '\v': 
	`¢d_ouut_putc
(
out
, '\\'); snd_output_putc(out, 'v'); ;

1652 '"': 
	`¢d_ouut_putc
(
out
, '\\'); snd_output_putc(out, '"'); ;

1653 : 
	`¢d_ouut_putc
(
out
, *
p
);

1655 
	`¢d_ouut_putc
(
out
, '"');

1656 
	}
}

1658 
	$´šc_cÚs
(
¢d_ouut_t
 *
out
, 
®i¥_objeù
 * 
p
)

1661 
	`´šc_objeù
(
out
, 
p
->
v®ue
.
c
.
ÿr
);

1662 
p
 =…->
v®ue
.
c
.
cdr
;

1663 ià(
p
 !ğ&
®§_li¥_n
) {

1664 
	`¢d_ouut_putc
(
out
, ' ');

1665 ià(!
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_CONS
)) {

1666 
	`¢d_ouut_´štf
(
out
, ". ");

1667 
	`´šc_objeù
(
out
, 
p
);

1670 } 
p
 !ğ&
®§_li¥_n
 && 
	`®i¥_com·»_ty³
Õ, 
ALISP_OBJ_CONS
));

1671 
	}
}

1673 
	$´šc_objeù
(
¢d_ouut_t
 *
out
, 
®i¥_objeù
 * 
p
)

1675 
	`®i¥_g‘_ty³
(
p
)) {

1676 
ALISP_OBJ_NIL
:

1677 
	`¢d_ouut_´štf
(
out
, "nil");

1679 
ALISP_OBJ_T
:

1680 
	`¢d_ouut_putc
(
out
, 't');

1682 
ALISP_OBJ_IDENTIFIER
:

1683 
	`¢d_ouut_´štf
(
out
, "%s", 
p
->
v®ue
.
s
);

1685 
ALISP_OBJ_STRING
:

1686 
	`´šc_¡ršg
(
out
, 
p
->
v®ue
.
s
);

1688 
ALISP_OBJ_INTEGER
:

1689 
	`¢d_ouut_´štf
(
out
, "%ld", 
p
->
v®ue
.
i
);

1691 
ALISP_OBJ_FLOAT
:

1692 
	`¢d_ouut_´štf
(
out
, "%f", 
p
->
v®ue
.
f
);

1694 
ALISP_OBJ_POINTER
:

1695 
	`¢d_ouut_´štf
(
out
, "<%p>", 
p
->
v®ue
.
±r
);

1697 
ALISP_OBJ_CONS
:

1698 
	`¢d_ouut_putc
(
out
, '(');

1699 
	`´šc_cÚs
(
out
, 
p
);

1700 
	`¢d_ouut_putc
(
out
, ')');

1702 
	}
}

1707 
®i¥_objeù
 * 
	$F_´šc
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1709 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
p1
 = 
NULL
, * 
n
;

1712 ià(
p1
)

1713 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1714 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

1715 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_STRING
))

1716 
	`¢d_ouut_´štf
(
š¡ªû
->
out
, "%s", 
p1
->
v®ue
.
s
);

1718 
	`´šc_objeù
(
š¡ªû
->
out
, 
p1
);

1719 
n
 = 
	`cdr
(
p
);

1720 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

1721 
p
 = 
n
;

1722 } 
p
 !ğ&
®§_li¥_n
);

1724  
p1
;

1725 
	}
}

1730 
®i¥_objeù
 * 
	$F_©om
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1732 
®i¥_objeù
 * 
p
;

1734 
p
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

1735 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

1736 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

1737 ià(
p
 =ğ
NULL
)

1738  
NULL
;

1740 
	`®i¥_g‘_ty³
(
p
)) {

1741 
ALISP_OBJ_T
:

1742 
ALISP_OBJ_NIL
:

1743 
ALISP_OBJ_INTEGER
:

1744 
ALISP_OBJ_FLOAT
:

1745 
ALISP_OBJ_STRING
:

1746 
ALISP_OBJ_IDENTIFIER
:

1747 
ALISP_OBJ_POINTER
:

1748 
	`d–‘e_Œ“
(
š¡ªû
, 
p
);

1749  &
®§_li¥_t
;

1754 
	`d–‘e_Œ“
(
š¡ªû
, 
p
);

1755  &
®§_li¥_n
;

1756 
	}
}

1761 
®i¥_objeù
 * 
	$F_cÚs
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1763 
®i¥_objeù
 * 
p
;

1765 
p
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

1766 ià(
p
) {

1767 
p
->
v®ue
.
c
.
ÿr
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

1768 
p
->
v®ue
.
c
.
cdr
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
¬gs
)));

1769 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

1770 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

1771 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

1773 
	`d–‘e_Œ“
(
š¡ªû
, 
¬gs
);

1776  
p
;

1777 
	}
}

1782 
®i¥_objeù
 * 
	$F_li¡
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1784 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
fœ¡
 = 
NULL
, * 
´ev
 = NULL, * 
p1
;

1786 ià(
p
 =ğ&
®§_li¥_n
)

1787  &
®§_li¥_n
;

1790 
p1
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

1791 ià(
p1
 =ğ
NULL
) {

1792 
	`d–‘e_Œ“
(
š¡ªû
, 
p
);

1793 
	`d–‘e_Œ“
(
š¡ªû
, 
fœ¡
);

1794  
NULL
;

1796 
p1
->
v®ue
.
c
.
ÿr
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

1797 ià(
p1
->
v®ue
.
c
.
ÿr
 =ğ
NULL
) {

1798 
	`d–‘e_Œ“
(
š¡ªû
, 
fœ¡
);

1799 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
p
));

1800 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

1801  
NULL
;

1803 ià(
fœ¡
 =ğ
NULL
)

1804 
fœ¡
 = 
p1
;

1805 ià(
´ev
 !ğ
NULL
)

1806 
´ev
->
v®ue
.
c
.
cdr
 = 
p1
;

1807 
´ev
 = 
p1
;

1808 
p
 = 
	`cdr
(
p1
 =…);

1809 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

1810 } 
p
 !ğ&
®§_li¥_n
);

1812  
fœ¡
;

1813 
	}
}

1815 
šlše
 
	$eq
(
®i¥_objeù
 * 
p1
, ®i¥_objeù * 
p2
)

1817  
p1
 =ğ
p2
;

1818 
	}
}

1820 
	$equ®
(
®i¥_objeù
 * 
p1
, ®i¥_objeù * 
p2
)

1822 
ty³1
, 
ty³2
;

1824 ià(
	`eq
(
p1
, 
p2
))

1827 
ty³1
 = 
	`®i¥_g‘_ty³
(
p1
);

1828 
ty³2
 = 
	`®i¥_g‘_ty³
(
p2
);

1830 ià(
ty³1
 =ğ
ALISP_OBJ_CONS
 || 
ty³2
 == ALISP_OBJ_CONS)

1833 ià(
ty³1
 =ğ
ty³2
) {

1834 
ty³1
) {

1835 
ALISP_OBJ_STRING
:

1836  !
	`¡rcmp
(
p1
->
v®ue
.
s
, 
p2
->value.s);

1837 
ALISP_OBJ_INTEGER
:

1838  
p1
->
v®ue
.
i
 =ğ
p2
->value.i;

1839 
ALISP_OBJ_FLOAT
:

1840  
p1
->
v®ue
.
i
 =ğ
p2
->value.i;

1845 
	}
}

1850 
®i¥_objeù
 * 
	$F_eq
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1852 
®i¥_objeù
 * 
p1
, * 
p2
;

1854 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

1855 
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
¬gs
)));

1856 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

1857 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

1858 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

1860 ià(
	`eq
(
p1
, 
p2
)) {

1861 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1862 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1863  &
®§_li¥_t
;

1865 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1866 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1867  &
®§_li¥_n
;

1868 
	}
}

1873 
®i¥_objeù
 * 
	$F_equ®
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1875 
®i¥_objeù
 * 
p1
, * 
p2
;

1877 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

1878 
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
¬gs
)));

1879 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

1880 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

1881 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

1883 ià(
	`equ®
(
p1
, 
p2
)) {

1884 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1885 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1886  &
®§_li¥_t
;

1888 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1889 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1890  &
®§_li¥_n
;

1891 
	}
}

1896 
®i¥_objeù
 * 
	$F_quÙe
(
®i¥_š¡ªû
 *
š¡ªû
 
ATTRIBUTE_UNUSED
, 
®i¥_objeù
 * 
¬gs
)

1898 
®i¥_objeù
 *
p
 = 
	`ÿr
(
¬gs
);

1900 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

1901 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

1902  
p
;

1903 
	}
}

1908 
®i¥_objeù
 * 
	$F_ªd
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1910 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
p1
 = 
NULL
, * 
n
;

1913 ià(
p1
)

1914 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1915 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

1916 ià(
p1
 =ğ&
®§_li¥_n
) {

1917 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1918 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
p
));

1919 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

1920  &
®§_li¥_n
;

1922 
p
 = 
	`cdr
(
n
 =…);

1923 
	`d–‘e_objeù
(
š¡ªû
, 
n
);

1924 } 
p
 !ğ&
®§_li¥_n
);

1926  
p1
;

1927 
	}
}

1932 
®i¥_objeù
 * 
	$F_Ü
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1934 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
p1
 = 
NULL
, * 
n
;

1937 ià(
p1
)

1938 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

1939 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

1940 ià(
p1
 !ğ&
®§_li¥_n
) {

1941 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
p
));

1942 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

1943  
p1
;

1945 
p
 = 
	`cdr
(
n
 =…);

1946 
	`d–‘e_objeù
(
š¡ªû
, 
n
);

1947 } 
p
 !ğ&
®§_li¥_n
);

1949  &
®§_li¥_n
;

1950 
	}
}

1956 
®i¥_objeù
 * 
	$F_nÙ
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1958 
®i¥_objeù
 * 
p
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

1960 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

1961 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

1962 ià(
p
 !ğ&
®§_li¥_n
) {

1963 
	`d–‘e_Œ“
(
š¡ªû
, 
p
);

1964  &
®§_li¥_n
;

1967 
	`d–‘e_Œ“
(
š¡ªû
, 
p
);

1968  &
®§_li¥_t
;

1969 
	}
}

1974 
®i¥_objeù
 * 
	$F_cÚd
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

1976 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
p1
, * 
p2
, * 
p3
;

1979 
p1
 = 
	`ÿr
(
p
);

1980 ià((
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p1
))è!ğ&
®§_li¥_n
) {

1981 
p3
 = 
	`cdr
(
p1
);

1982 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

1983 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
p
));

1984 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

1985 ià(
p3
 !ğ&
®§_li¥_n
) {

1986 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1987  
	`F_´ogn
(
š¡ªû
, 
p3
);

1989 
	`d–‘e_Œ“
(
š¡ªû
, 
p3
);

1990  
p2
;

1993 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

1994 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
p1
));

1995 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

1997 
p
 = 
	`cdr
(
p2
 =…);

1998 
	`d–‘e_objeù
(
š¡ªû
, 
p2
);

1999 } 
p
 !ğ&
®§_li¥_n
);

2001  &
®§_li¥_n
;

2002 
	}
}

2007 
®i¥_objeù
 * 
	$F_if
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2009 
®i¥_objeù
 * 
p1
, * 
p2
, * 
p3
;

2011 
p1
 = 
	`ÿr
(
¬gs
);

2012 
p2
 = 
	`ÿr
(
	`cdr
(
¬gs
));

2013 
p3
 = 
	`cdr
(cdr(
¬gs
));

2014 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

2015 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2017 
p1
 = 
	`ev®
(
š¡ªû
,…1);

2018 ià(
p1
 !ğ&
®§_li¥_n
) {

2019 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2020 
	`d–‘e_Œ“
(
š¡ªû
, 
p3
);

2021  
	`ev®
(
š¡ªû
, 
p2
);

2024 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2025 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

2026  
	`F_´ogn
(
š¡ªû
, 
p3
);

2027 
	}
}

2032 
®i¥_objeù
 * 
	$F_wh’
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2034 
®i¥_objeù
 * 
p1
, * 
p2
;

2036 
p1
 = 
	`ÿr
(
¬gs
);

2037 
p2
 = 
	`cdr
(
¬gs
);

2038 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2039 ià((
p1
 = 
	`ev®
(
š¡ªû
,…1)è!ğ&
®§_li¥_n
) {

2040 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2041  
	`F_´ogn
(
š¡ªû
, 
p2
);

2043 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2044 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

2047  &
®§_li¥_n
;

2048 
	}
}

2053 
®i¥_objeù
 * 
	$F_uÆess
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2055 
®i¥_objeù
 * 
p1
, * 
p2
;

2057 
p1
 = 
	`ÿr
(
¬gs
);

2058 
p2
 = 
	`cdr
(
¬gs
);

2059 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2060 ià((
p1
 = 
	`ev®
(
š¡ªû
,…1)è=ğ&
®§_li¥_n
) {

2061  
	`F_´ogn
(
š¡ªû
, 
p2
);

2063 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2064 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

2067  &
®§_li¥_n
;

2068 
	}
}

2073 
®i¥_objeù
 * 
	$F_whe
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2075 
®i¥_objeù
 * 
p1
, * 
p2
, * 
p3
;

2077 
p1
 = 
	`ÿr
(
¬gs
);

2078 
p2
 = 
	`cdr
(
¬gs
);

2080 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2082 
	`šüef_Œ“
(
š¡ªû
, 
p1
);

2083 ià((
p3
 = 
	`ev®
(
š¡ªû
, 
p1
)è=ğ&
®§_li¥_n
)

2085 
	`d–‘e_Œ“
(
š¡ªû
, 
p3
);

2086 
	`šüef_Œ“
(
š¡ªû
, 
p2
);

2087 
	`d–‘e_Œ“
(
š¡ªû
, 
	`F_´ogn
(š¡ªû, 
p2
));

2090 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2091 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

2092  &
®§_li¥_n
;

2093 
	}
}

2098 
®i¥_objeù
 * 
	$F_´ogn
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2100 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
p1
 = 
NULL
, * 
n
;

2103 ià(
p1
)

2104 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2105 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

2106 
n
 = 
	`cdr
(
p
);

2107 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

2108 
p
 = 
n
;

2109 } 
p
 !ğ&
®§_li¥_n
);

2111  
p1
;

2112 
	}
}

2117 
®i¥_objeù
 * 
	$F_´og1
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2119 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
fœ¡
 = 
NULL
, * 
p1
;

2122 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

2123 ià(
fœ¡
 =ğ
NULL
)

2124 
fœ¡
 = 
p1
;

2126 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2127 
p1
 = 
	`cdr
(
p
);

2128 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

2129 
p
 = 
p1
;

2130 } 
p
 !ğ&
®§_li¥_n
);

2132 ià(
fœ¡
 =ğ
NULL
)

2133 
fœ¡
 = &
®§_li¥_n
;

2135  
fœ¡
;

2136 
	}
}

2141 
®i¥_objeù
 * 
	$F_´og2
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2143 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
£cÚd
 = 
NULL
, * 
p1
;

2144 
i
 = 0;

2147 ++
i
;

2148 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

2149 ià(
i
 == 2)

2150 
£cÚd
 = 
p1
;

2152 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2153 
p1
 = 
	`cdr
(
p
);

2154 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

2155 
p
 = 
p1
;

2156 } 
p
 !ğ&
®§_li¥_n
);

2158 ià(
£cÚd
 =ğ
NULL
)

2159 
£cÚd
 = &
®§_li¥_n
;

2161  
£cÚd
;

2162 
	}
}

2167 
®i¥_objeù
 * 
	$F_£t
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2169 
®i¥_objeù
 * 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
)),

2170 * 
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
¬gs
)));

2172 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

2173 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

2174 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2175 ià(!
	`check_£t_objeù
(
š¡ªû
, 
p1
)) {

2176 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

2177 
p2
 = &
®§_li¥_n
;

2179 ià(
	`£t_objeù
(
š¡ªû
, 
p1
, 
p2
è=ğ
NULL
) {

2180 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2181 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

2182  
NULL
;

2185 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2186  
	`šüef_Œ“
(
š¡ªû
, 
p2
);

2187 
	}
}

2192 
®i¥_objeù
 * 
	$F_un£t
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2194 
®i¥_objeù
 * 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

2196 
	`d–‘e_Œ“
(
š¡ªû
, 
	`un£t_objeù
(š¡ªû, 
p1
));

2197 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

2198 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2199  
p1
;

2200 
	}
}

2207 
®i¥_objeù
 * 
	$F_£tq
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2209 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
p1
, * 
p2
 = 
NULL
, *
n
;

2212 
p1
 = 
	`ÿr
(
p
);

2213 
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
p
)));

2214 
n
 = 
	`cdr
(cdr(
p
));

2215 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
p
));

2216 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

2217 ià(!
	`check_£t_objeù
(
š¡ªû
, 
p1
)) {

2218 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

2219 
p2
 = &
®§_li¥_n
;

2221 ià(
	`£t_objeù
(
š¡ªû
, 
p1
, 
p2
è=ğ
NULL
) {

2222 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2223 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

2224  
NULL
;

2227 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2228 
p
 = 
n
;

2229 } 
p
 !ğ&
®§_li¥_n
);

2231  
	`šüef_Œ“
(
š¡ªû
, 
p2
);

2232 
	}
}

2239 
®i¥_objeù
 * 
	$F_un£tq
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2241 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
p1
 = 
NULL
, * 
n
;

2244 ià(
p1
)

2245 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2246 
p1
 = 
	`un£t_objeù
(
š¡ªû
, 
	`ÿr
(
p
));

2247 
	`d–‘e_Œ“
(
š¡ªû
, 
	`ÿr
(
p
));

2248 
p
 = 
	`cdr
(
n
 =…);

2249 
	`d–‘e_objeù
(
š¡ªû
, 
n
);

2250 } 
p
 !ğ&
®§_li¥_n
);

2252  
p1
;

2253 
	}
}

2260 
®i¥_objeù
 * 
	$F_defun
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2262 
®i¥_objeù
 * 
p1
 = 
	`ÿr
(
¬gs
),

2263 * 
p2
 = 
	`ÿr
(
	`cdr
(
¬gs
)),

2264 * 
p3
 = 
	`cdr
(cdr(
¬gs
));

2265 
®i¥_objeù
 * 
Ëx´
;

2267 
Ëx´
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

2268 ià(
Ëx´
) {

2269 
Ëx´
->
v®ue
.
c
.
ÿr
 = 
	`Ãw_id’tif›r
(
š¡ªû
, "lambda");

2270 ià(
Ëx´
->
v®ue
.
c
.
ÿr
 =ğ
NULL
) {

2271 
	`d–‘e_objeù
(
š¡ªû
, 
Ëx´
);

2272 
	`d–‘e_Œ“
(
š¡ªû
, 
¬gs
);

2273  
NULL
;

2275 ià((
Ëx´
->
v®ue
.
c
.
cdr
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
)è=ğ
NULL
) {

2276 
	`d–‘e_objeù
(
š¡ªû
, 
Ëx´
->
v®ue
.
c
.
ÿr
);

2277 
	`d–‘e_objeù
(
š¡ªû
, 
Ëx´
);

2278 
	`d–‘e_Œ“
(
š¡ªû
, 
¬gs
);

2279  
NULL
;

2281 
Ëx´
->
v®ue
.
c
.
cdr
->v®ue.c.
ÿr
 = 
p2
;

2282 
Ëx´
->
v®ue
.
c
.
cdr
->v®ue.c.cd¸ğ
p3
;

2283 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

2284 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2285 ià(
	`£t_objeù
(
š¡ªû
, 
p1
, 
Ëx´
è=ğ
NULL
) {

2286 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2287 
	`d–‘e_Œ“
(
š¡ªû
, 
Ëx´
);

2288  
NULL
;

2290 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2292 
	`d–‘e_Œ“
(
š¡ªû
, 
¬gs
);

2294  &
®§_li¥_n
;

2295 
	}
}

2297 
®i¥_objeù
 * 
	$ev®_func
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
p
, ®i¥_objeù * 
¬gs
)

2299 
®i¥_objeù
 * 
p1
, * 
p2
, * 
p3
, * 
p4
;

2300 
®i¥_objeù
 ** 
ev®_objs
, ** 
§ve_objs
;

2301 
i
;

2303 
p1
 = 
	`ÿr
(
p
);

2304 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_IDENTIFIER
) &&

2305 !
	`¡rcmp
(
p1
->
v®ue
.
s
, "lambda")) {

2306 
p2
 = 
	`ÿr
(
	`cdr
(
p
));

2307 
p3
 = 
¬gs
;

2309 ià((
i
 = 
	`couÁ_li¡
(
p2
)è!ğcouÁ_li¡(
p3
)) {

2310 
	`li¥_w¬n
(
š¡ªû
, "wrong‚umber of…arameters");

2311 
_d–‘e
;

2314 
ev®_objs
 = 
	`m®loc
(2 * 
i
 * (
®i¥_objeù
 *));

2315 ià(
ev®_objs
 =ğ
NULL
) {

2316 
	`nomem
();

2317 
_d–‘e
;

2319 
§ve_objs
 = 
ev®_objs
 + 
i
;

2324 
i
 = 0;

2325 
p3
 !ğ&
®§_li¥_n
) {

2326 
ev®_objs
[
i
++] = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p3
));

2327 
p3
 = 
	`cdr
(
p4
 =…3);

2328 
	`d–‘e_objeù
(
š¡ªû
, 
p4
);

2334 
i
 = 0;

2335 
p2
 !ğ&
®§_li¥_n
) {

2336 
p3
 = 
	`ÿr
(
p2
);

2337 
§ve_objs
[
i
] = 
	`»¶aû_objeù
(
š¡ªû
, 
p3
, 
ev®_objs
[i]);

2338 ià(
§ve_objs
[
i
] =ğ
NULL
 &&

2339 
	`£t_objeù_dœeù
(
š¡ªû
, 
p3
, 
ev®_objs
[
i
]è=ğ
NULL
) {

2340 
p4
 = 
NULL
;

2341 
_’d
;

2343 
p2
 = 
	`cdr
(p2);

2344 ++
i
;

2347 
p4
 = 
	`F_´ogn
(
š¡ªû
, 
	`cdr
(
	`šüef_Œ“
(š¡ªû, 
p3
 = cdr(
p
))));

2352 
p2
 = 
	`ÿr
(
p3
);

2353 
	`d–‘e_objeù
(
š¡ªû
, 
p3
);

2354 
i
 = 0;

2355 
p2
 !ğ&
®§_li¥_n
) {

2356 
p3
 = 
	`ÿr
(
p2
);

2357 ià(
§ve_objs
[
i
] =ğ
NULL
) {

2358 
p3
 = 
	`un£t_objeù
(
š¡ªû
,…3);

2360 
p3
 = 
	`»¶aû_objeù
(
š¡ªû
,…3, 
§ve_objs
[
i
]);

2362 
i
++;

2363 
	`d–‘e_Œ“
(
š¡ªû
, 
p3
);

2364 
	`d–‘e_Œ“
(
š¡ªû
, 
	`ÿr
(
p2
));

2365 
p2
 = 
	`cdr
(
p3
 =…2);

2366 
	`d–‘e_objeù
(
š¡ªû
, 
p3
);

2369 
_’d
:

2370 
	`ä“
(
ev®_objs
);

2372  
p4
;

2374 
_d–‘e
:

2375 
	`d–‘e_Œ“
(
š¡ªû
, 
¬gs
);

2377  &
®§_li¥_n
;

2378 
	}
}

2380 
®i¥_objeù
 * 
	$F_gc
(
®i¥_š¡ªû
 *
š¡ªû
 
ATTRIBUTE_UNUSED
, 
®i¥_objeù
 * 
¬gs
 ATTRIBUTE_UNUSED)

2383  &
®§_li¥_t
;

2384 
	}
}

2390 
®i¥_objeù
 * 
	$F_·th
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2392 
®i¥_objeù
 * 
p1
;

2394 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

2395 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

2396 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2397 ià(!
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_STRING
)) {

2398 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2399  &
®§_li¥_n
;

2401 ià(!
	`¡rcmp
(
p1
->
v®ue
.
s
, "data")) {

2402 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2403  
	`Ãw_¡ršg
(
š¡ªû
, 
	`¢d_cÚfig_tİdœ
());

2405 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2406  &
®§_li¥_n
;

2407 
	}
}

2412 
®i¥_objeù
 * 
	$F_šşude
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2414 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
p1
;

2415 
»s
 = -
ENOENT
;

2418 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

2419 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_STRING
))

2420 
»s
 = 
	`®i¥_šşude_fe
(
š¡ªû
, 
p1
->
v®ue
.
s
);

2421 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2422 
p
 = 
	`cdr
(
p1
 =…);

2423 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

2424 } 
p
 !ğ&
®§_li¥_n
);

2426  
	`Ãw_š‹g”
(
š¡ªû
, 
»s
);

2427 
	}
}

2433 
®i¥_objeù
 * 
	$F_¡ršg_to_š‹g”
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2435 
®i¥_objeù
 * 
p
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
)), * 
p1
;

2437 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

2438 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2439 ià(
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_INTEGER
))

2440  
p
;

2441 ià(
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_FLOAT
)) {

2442 
p1
 = 
	`Ãw_š‹g”
(
š¡ªû
, 
	`æoÜ
(
p
->
v®ue
.
f
));

2444 
	`li¥_w¬n
(
š¡ªû
, "expected‡n integer or float for integer conversion");

2445 
p1
 = &
®§_li¥_n
;

2447 
	`d–‘e_Œ“
(
š¡ªû
, 
p
);

2448  
p1
;

2449 
	}
}

2455 
®i¥_objeù
 * 
	$F_¡ršg_to_æßt
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2457 
®i¥_objeù
 * 
p
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
)), * 
p1
;

2459 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

2460 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2461 ià(
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_FLOAT
))

2462  
p
;

2463 ià(
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_INTEGER
)) {

2464 
p1
 = 
	`Ãw_æßt
(
š¡ªû
, 
p
->
v®ue
.
i
);

2466 
	`li¥_w¬n
(
š¡ªû
, "expected‡n integer or float for integer conversion");

2467 
p1
 = &
®§_li¥_n
;

2469 
	`d–‘e_Œ“
(
š¡ªû
, 
p
);

2470  
p1
;

2471 
	}
}

2473 
	$­³nd_to_¡ršg
(**
s
, *
Ën
, *
äom
, 
size
)

2475 ià(*
Ën
 == 0) {

2476 *
s
 = 
	`m®loc
(*
Ën
 = 
size
 + 1);

2477 ià(*
s
 =ğ
NULL
) {

2478 
	`nomem
();

2479  -
ENOMEM
;

2481 
	`memıy
(*
s
, 
äom
, 
size
);

2483 *
Ën
 +ğ
size
;

2484 *
s
 = 
	`»®loc
(*s, *
Ën
);

2485 ià(*
s
 =ğ
NULL
) {

2486 
	`nomem
();

2487  -
ENOMEM
;

2489 
	`memıy
(*
s
 + 
	`¡¾’
(*s), 
äom
, 
size
);

2491 (*
s
)[*
Ën
 - 1] = '\0';

2493 
	}
}

2495 
	$fÜm©_·r£_ch¬
(
®i¥_š¡ªû
 *
š¡ªû
, **
s
, *
Ën
, 
®i¥_objeù
 *
p
)

2497 
b
;

2499 ià(!
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_INTEGER
)) {

2500 
	`li¥_w¬n
(
š¡ªû
, "format:ƒxpected integer\n");

2503 
b
 = 
p
->
v®ue
.
i
;

2504  
	`­³nd_to_¡ršg
(
s
, 
Ën
, &
b
, 1);

2505 
	}
}

2507 
	$fÜm©_·r£_š‹g”
(
®i¥_š¡ªû
 *
š¡ªû
, **
s
, *
Ën
, 
®i¥_objeù
 *
p
)

2509 
»s
;

2510 *
s1
;

2512 ià(!
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_INTEGER
) &&

2513 !
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_FLOAT
)) {

2514 
	`li¥_w¬n
(
š¡ªû
, "format:ƒxpected integer or float\n");

2517 
s1
 = 
	`m®loc
(64);

2518 ià(
s1
 =ğ
NULL
) {

2519 
	`nomem
();

2520  -
ENOMEM
;

2522 
	`¥rštf
(
s1
, "%li", 
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_FLOAT
è? ()
	`æoÜ
Õ->
v®ue
.
f
è:…->v®ue.
i
);

2523 
»s
 = 
	`­³nd_to_¡ršg
(
s
, 
Ën
, 
s1
, 
	`¡¾’
(s1));

2524 
	`ä“
(
s1
);

2525  
»s
;

2526 
	}
}

2528 
	$fÜm©_·r£_æßt
(
®i¥_š¡ªû
 *
š¡ªû
, **
s
, *
Ën
, 
®i¥_objeù
 *
p
)

2530 
»s
;

2531 *
s1
;

2533 ià(!
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_INTEGER
) &&

2534 !
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_FLOAT
)) {

2535 
	`li¥_w¬n
(
š¡ªû
, "format:ƒxpected integer or float\n");

2538 
s1
 = 
	`m®loc
(64);

2539 ià(
s1
 =ğ
NULL
) {

2540 
	`nomem
();

2541  -
ENOMEM
;

2543 
	`¥rštf
(
s1
, "%f", 
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_FLOAT
è?…->
v®ue
.
f
 : (í->v®ue.
i
);

2544 
»s
 = 
	`­³nd_to_¡ršg
(
s
, 
Ën
, 
s1
, 
	`¡¾’
(s1));

2545 
	`ä“
(
s1
);

2546  
»s
;

2547 
	}
}

2549 
	$fÜm©_·r£_¡ršg
(
®i¥_š¡ªû
 *
š¡ªû
, **
s
, *
Ën
, 
®i¥_objeù
 *
p
)

2551 ià(!
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_STRING
)) {

2552 
	`li¥_w¬n
(
š¡ªû
, "format:ƒxpected string\n");

2555  
	`­³nd_to_¡ršg
(
s
, 
Ën
, 
p
->
v®ue
.s, 
	`¡¾’
(p->value.s));

2556 
	}
}

2562 
®i¥_objeù
 * 
	$F_fÜm©
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2564 
®i¥_objeù
 * 
p
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
)), * 
p1
 = 
	`cdr
×rgs), * 
n
;

2565 *
s
, *
s1
, *
s2
;

2566 
Ën
;

2568 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2569 ià(!
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_STRING
)) {

2570 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2571 
	`d–‘e_Œ“
(
š¡ªû
, 
p
);

2572 
	`li¥_w¬n
(
š¡ªû
, "format:ƒxpected‡n format string");

2573  &
®§_li¥_n
;

2575 
s
 = 
p
->
v®ue
.s;

2576 
s1
 = 
NULL
;

2577 
Ën
 = 0;

2578 
n
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p1
));

2581 
s2
 = 
s
;

2582 *
s2
 && *s2 != '%')

2583 
s2
++;

2584 ià(
s2
 !ğ
s
) {

2585 ià(
	`­³nd_to_¡ršg
(&
s1
, &
Ën
, 
s
, 
s2
 - s) < 0) {

2586 
__”rÜ
:

2587 
	`d–‘e_Œ“
(
š¡ªû
, 
n
);

2588 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
p1
));

2589 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

2590 
	`d–‘e_Œ“
(
š¡ªû
, 
p
);

2591  
NULL
;

2594 ià(*
s2
 == '%')

2595 
s2
++;

2596 *
s2
) {

2598 ià(
	`­³nd_to_¡ršg
(&
s1
, &
Ën
, 
s2
, 1) < 0)

2599 
__”rÜ
;

2600 
s
 = 
s2
 + 1;

2603 ià(
	`fÜm©_·r£_ch¬
(
š¡ªû
, &
s1
, &
Ën
, 
n
) < 0)

2604 
__”rÜ
;

2605 
s
 = 
s2
 + 1;

2606 
__Ãxt
;

2609 ià(
	`fÜm©_·r£_š‹g”
(
š¡ªû
, &
s1
, &
Ën
, 
n
) < 0)

2610 
__”rÜ
;

2611 
s
 = 
s2
 + 1;

2612 
__Ãxt
;

2614 ià(
	`fÜm©_·r£_æßt
(
š¡ªû
, &
s1
, &
Ën
, 
n
) < 0)

2615 
__”rÜ
;

2616 
s
 = 
s2
 + 1;

2617 
__Ãxt
;

2619 ià(
	`fÜm©_·r£_¡ršg
(
š¡ªû
, &
s1
, &
Ën
, 
n
) < 0)

2620 
__”rÜ
;

2621 
s
 = 
s2
 + 1;

2622 
__Ãxt
;

2624 
__’d
;

2626 
	`li¥_w¬n
(
š¡ªû
, "unknowÀfÜm© ch¬ '%c'", *
s2
);

2627 
s
 = 
s2
 + 1;

2628 
__Ãxt
;

2631 
__Ãxt
:

2632 
	`d–‘e_Œ“
(
š¡ªû
, 
n
);

2633 
p1
 = 
	`cdr
(
n
 =…1);

2634 
	`d–‘e_objeù
(
š¡ªû
, 
n
);

2635 
n
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p1
));

2636 } *
s
);

2637 
__’d
:

2638 
	`d–‘e_Œ“
(
š¡ªû
, 
n
);

2639 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
p1
));

2640 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

2641 
	`d–‘e_Œ“
(
š¡ªû
, 
p
);

2642 ià(
Ën
 > 0) {

2643 
p1
 = 
	`Ãw_¡ršg
(
š¡ªû
, 
s1
);

2644 
	`ä“
(
s1
);

2646 
p1
 = &
®§_li¥_n
;

2648  
p1
;

2649 
	}
}

2661 
®i¥_objeù
 * 
	$F_com·»_¡ršgs
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2663 
®i¥_objeù
 * 
p1
 = 
¬gs
, * 
n
, * 
p
[7];

2664 *
s1
, *
s2
;

2665 
¡¬t1
, 
’d1
, 
¡¬t2
, 
’d2
;

2667 
¡¬t1
 = 0; start1 < 7; start1++) {

2668 
p
[
¡¬t1
] = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p1
));

2669 
p1
 = 
	`cdr
(
n
 =…1);

2670 
	`d–‘e_objeù
(
š¡ªû
, 
n
);

2672 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2673 ià(
	`®i¥_com·»_ty³
(
p
[0], 
ALISP_OBJ_STRING
)) {

2674 
	`li¥_w¬n
(
š¡ªû
, "compare-strings: first‡rgument must be string\n");

2675 
p1
 = &
®§_li¥_n
;

2676 
__”r
;

2678 ià(
	`®i¥_com·»_ty³
(
p
[1], 
ALISP_OBJ_INTEGER
)) {

2679 
	`li¥_w¬n
(
š¡ªû
, "compare-strings: second‡rgument must be integer\n");

2680 
p1
 = &
®§_li¥_n
;

2681 
__”r
;

2683 ià(
	`®i¥_com·»_ty³
(
p
[2], 
ALISP_OBJ_INTEGER
)) {

2684 
	`li¥_w¬n
(
š¡ªû
, "compare-strings:hird‡rgument must be integer\n");

2685 
p1
 = &
®§_li¥_n
;

2686 
__”r
;

2688 ià(
	`®i¥_com·»_ty³
(
p
[3], 
ALISP_OBJ_STRING
)) {

2689 
	`li¥_w¬n
(
š¡ªû
, "compare-strings: fifth‡rgument must be string\n");

2690 
p1
 = &
®§_li¥_n
;

2691 
__”r
;

2693 ià(!
	`®i¥_com·»_ty³
(
p
[4], 
ALISP_OBJ_NIL
) &&

2694 !
	`®i¥_com·»_ty³
(
p
[4], 
ALISP_OBJ_INTEGER
)) {

2695 
	`li¥_w¬n
(
š¡ªû
, "compare-strings: fourth‡rgument must be integer\n");

2696 
p1
 = &
®§_li¥_n
;

2697 
__”r
;

2699 ià(!
	`®i¥_com·»_ty³
(
p
[5], 
ALISP_OBJ_NIL
) &&

2700 !
	`®i¥_com·»_ty³
(
p
[5], 
ALISP_OBJ_INTEGER
)) {

2701 
	`li¥_w¬n
(
š¡ªû
, "compare-strings: sixth‡rgument must be integer\n");

2702 
p1
 = &
®§_li¥_n
;

2703 
__”r
;

2705 
s1
 = 
p
[0]->
v®ue
.
s
;

2706 
¡¬t1
 = 
p
[1]->
v®ue
.
i
;

2707 
’d1
 = 
p
[2]->
v®ue
.
i
;

2708 
s2
 = 
p
[3]->
v®ue
.
s
;

2709 
¡¬t2
 = 
	`®i¥_com·»_ty³
(
p
[4], 
ALISP_OBJ_NIL
è? 0 :…[4]->
v®ue
.
i
;

2710 
’d2
 = 
	`®i¥_com·»_ty³
(
p
[5], 
ALISP_OBJ_NIL
è? 
¡¬t2
 + (
’d1
 - 
¡¬t1
è:…[5]->
v®ue
.
i
;

2711 ià(
¡¬t1
 < 0 || 
¡¬t2
 < 0 || 
’d1
 < 0 || 
’d2
 < 0 ||

2712 
¡¬t1
 >ğ()
	`¡¾’
(
s1
è|| 
¡¬t2
 >ğ()¡¾’(
s2
) ||

2713 (
’d1
 - 
¡¬t1
è!ğ(
’d2
 - 
¡¬t2
)) {

2714 
p1
 = &
®§_li¥_n
;

2715 
__”r
;

2717 ià(
p
[6] !ğ&
®§_li¥_n
) {

2718 
¡¬t1
 < 
’d1
) {

2719 ià(
s1
[
¡¬t1
] == '\0' ||

2720 
s2
[
¡¬t2
] == '\0' ||

2721 
	`tŞow”
(
s1
[
¡¬t1
]è!ğtŞow”(
s2
[
¡¬t2
])) {

2722 
p1
 = &
®§_li¥_n
;

2723 
__”r
;

2725 
¡¬t1
++;

2726 
¡¬t2
++;

2729 
¡¬t1
 < 
’d1
) {

2730 ià(
s1
[
¡¬t1
] == '\0' ||

2731 
s2
[
¡¬t2
] == '\0' ||

2732 
s1
[
¡¬t1
] !ğ
s2
[
¡¬t2
]) {

2733 
p1
 = &
®§_li¥_n
;

2734 
__”r
;

2736 
¡¬t1
++;

2737 
¡¬t2
++;

2740 
p1
 = &
®§_li¥_t
;

2742 
__”r
:

2743 
¡¬t1
 = 0; start1 < 7; start1++)

2744 
	`d–‘e_Œ“
(
š¡ªû
, 
p
[
¡¬t1
]);

2745  
p1
;

2746 
	}
}

2751 
®i¥_objeù
 * 
	$F_assoc
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2753 
®i¥_objeù
 * 
p1
, * 
p2
, * 
n
;

2755 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

2756 
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
¬gs
)));

2757 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

2758 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

2759 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2762 ià(
	`eq
(
p1
, 
	`ÿr
(ÿr(
p2
)))) {

2763 
n
 = 
	`ÿr
(
p2
);

2764 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2765 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
p2
));

2766 
	`d–‘e_objeù
(
š¡ªû
, 
p2
);

2767  
n
;

2769 
	`d–‘e_Œ“
(
š¡ªû
, 
	`ÿr
(
p2
));

2770 
p2
 = 
	`cdr
(
n
 =…2);

2771 
	`d–‘e_objeù
(
š¡ªû
, 
n
);

2772 } 
p2
 !ğ&
®§_li¥_n
);

2774 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2775  &
®§_li¥_n
;

2776 
	}
}

2781 
®i¥_objeù
 * 
	$F_¿ssoc
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2783 
®i¥_objeù
 * 
p1
, *
p2
, * 
n
;

2785 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

2786 
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
¬gs
)));

2787 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

2788 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

2789 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2792 ià(
	`eq
(
p1
, 
	`cdr
(
	`ÿr
(
p2
)))) {

2793 
n
 = 
	`ÿr
(
p2
);

2794 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2795 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
p2
));

2796 
	`d–‘e_objeù
(
š¡ªû
, 
p2
);

2797  
n
;

2799 
	`d–‘e_Œ“
(
š¡ªû
, 
	`ÿr
(
p2
));

2800 
p2
 = 
	`cdr
(
n
 =…2);

2801 
	`d–‘e_objeù
(
š¡ªû
, 
n
);

2802 } 
p2
 !ğ&
®§_li¥_n
);

2804 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2805  &
®§_li¥_n
;

2806 
	}
}

2811 
®i¥_objeù
 * 
	$F_assq
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2813 
®i¥_objeù
 * 
p1
, * 
p2
, * 
n
;

2815 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

2816 
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
¬gs
)));

2817 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

2818 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

2819 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2822 ià(
	`equ®
(
p1
, 
	`ÿr
(ÿr(
p2
)))) {

2823 
n
 = 
	`ÿr
(
p2
);

2824 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2825 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
p2
));

2826 
	`d–‘e_objeù
(
š¡ªû
, 
p2
);

2827  
n
;

2829 
	`d–‘e_Œ“
(
š¡ªû
, 
	`ÿr
(
p2
));

2830 
p2
 = 
	`cdr
(
n
 =…2);

2831 
	`d–‘e_objeù
(
š¡ªû
, 
n
);

2832 } 
p2
 !ğ&
®§_li¥_n
);

2834 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2835  &
®§_li¥_n
;

2836 
	}
}

2841 
®i¥_objeù
 * 
	$F_Áh
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2843 
®i¥_objeù
 * 
p1
, * 
p2
, * 
n
;

2844 
idx
;

2846 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

2847 
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
¬gs
)));

2848 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

2849 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

2850 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2852 ià(!
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
)) {

2853 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2854 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

2855  &
®§_li¥_n
;

2857 ià(!
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_CONS
)) {

2858 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

2859 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

2860  &
®§_li¥_n
;

2862 
idx
 = 
p1
->
v®ue
.
i
;

2863 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

2864 
idx
-- > 0) {

2865 
	`d–‘e_Œ“
(
š¡ªû
, 
	`ÿr
(
p2
));

2866 
p2
 = 
	`cdr
(
n
 =…2);

2867 
	`d–‘e_objeù
(
š¡ªû
, 
n
);

2869 
n
 = 
	`ÿr
(
p2
);

2870 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
p2
));

2871 
	`d–‘e_objeù
(
š¡ªû
, 
p2
);

2872  
n
;

2873 
	}
}

2878 
®i¥_objeù
 * 
	$F_¿ssq
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2880 
®i¥_objeù
 * 
p1
, * 
p2
, * 
n
;

2882 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

2883 
p2
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
	`cdr
(
¬gs
)));

2884 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

2885 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

2886 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

2889 ià(
	`equ®
(
p1
, 
	`cdr
(
	`ÿr
(
p2
)))) {

2890 
n
 = 
	`ÿr
(
p2
);

2891 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2892 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
p2
));

2893 
	`d–‘e_objeù
(
š¡ªû
, 
p2
);

2894  
n
;

2896 
	`d–‘e_Œ“
(
š¡ªû
, 
	`ÿr
(
p2
));

2897 
p2
 = 
	`cdr
(
n
 =…2);

2898 
	`d–‘e_objeù
(
š¡ªû
, 
n
);

2899 } 
p2
 !ğ&
®§_li¥_n
);

2901 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

2902  &
®§_li¥_n
;

2903 
	}
}

2905 
®i¥_objeù
 * 
	$F_dump_memÜy
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2907 
®i¥_objeù
 * 
p
 = 
	`ÿr
(
¬gs
);

2909 ià(
p
 !ğ&
®§_li¥_n
 && 
	`cdr
(
¬gs
) == &alsa_lisp_nil &&

2910 
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_STRING
)) {

2911 ià(
	`¡¾’
(
p
->
v®ue
.
s
) > 0) {

2912 
	`dump_objeùs
(
š¡ªû
, 
p
->
v®ue
.
s
);

2913 
	`d–‘e_Œ“
(
š¡ªû
, 
¬gs
);

2914  &
®§_li¥_t
;

2916 
	`li¥_w¬n
(
š¡ªû
, "expected filename");

2918 
	`li¥_w¬n
(
š¡ªû
, "wrong‚umber of…arameters (expected string)");

2920 
	`d–‘e_Œ“
(
š¡ªû
, 
¬gs
);

2921  &
®§_li¥_n
;

2922 
	}
}

2924 
®i¥_objeù
 * 
	$F_¡©_memÜy
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2926 
	`¢d_ouut_´štf
(
š¡ªû
->
out
, "*** Memory stats\n");

2927 
	`¢d_ouut_´štf
(
š¡ªû
->
out
, " used_objs = %li, free_objs = %li, max_objs = %li, obj_size = %i (total bytes = %li, max bytes = %li)\n",

2928 
š¡ªû
->
u£d_objs
,

2929 
š¡ªû
->
ä“_objs
,

2930 
š¡ªû
->
max_objs
,

2931 ()(
®i¥_objeù
),

2932 ()((
š¡ªû
->
u£d_objs
 + in¡ªû->
ä“_objs
è* (
®i¥_objeù
)),

2933 ()(
š¡ªû
->
max_objs
 * (
®i¥_objeù
)));

2934 
	`d–‘e_Œ“
(
š¡ªû
, 
¬gs
);

2935  &
®§_li¥_n
;

2936 
	}
}

2938 
®i¥_objeù
 * 
	$F_check_memÜy
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2940 
	`d–‘e_Œ“
(
š¡ªû
, 
¬gs
);

2941 ià(
š¡ªû
->
u£d_objs
 > 0) {

2942 
	`årštf
(
¡d”r
, "!!!alsa†isp - check memory failed!!!\n");

2943 
	`F_¡©_memÜy
(
š¡ªû
, &
®§_li¥_n
);

2944 
	`ex™
(
EXIT_FAILURE
);

2946  &
®§_li¥_t
;

2947 
	}
}

2949 
®i¥_objeù
 * 
	$F_dump_objeùs
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

2951 
®i¥_objeù
 * 
p
 = 
	`ÿr
(
¬gs
);

2953 ià(
p
 !ğ&
®§_li¥_n
 && 
	`cdr
(
¬gs
) == &alsa_lisp_nil &&

2954 
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_STRING
)) {

2955 ià(
	`¡¾’
(
p
->
v®ue
.
s
) > 0) {

2956 
	`dump_obj_li¡s
(
š¡ªû
, 
p
->
v®ue
.
s
);

2957 
	`d–‘e_Œ“
(
š¡ªû
, 
¬gs
);

2958  &
®§_li¥_t
;

2960 
	`li¥_w¬n
(
š¡ªû
, "expected filename");

2962 
	`li¥_w¬n
(
š¡ªû
, "wrong‚umber of…arameters (expected string)");

2964 
	`d–‘e_Œ“
(
š¡ªû
, 
¬gs
);

2965  &
®§_li¥_n
;

2966 
	}
}

2968 
	sšŒšsic
 {

2969 cÚ¡ *
	mÇme
;

2970 
	m®i¥_objeù
 * (*
	mfunc
)(
®i¥_š¡ªû
 *
	mš¡ªû
, 
®i¥_objeù
 * 
	m¬gs
);

2973 cÚ¡ 
šŒšsic
 
	gšŒšsics
[] = {

2974 { "!=", 
F_numÃq
 },

2975 { "%", 
F_mod
 },

2976 { "&check-memÜy", 
F_check_memÜy
 },

2977 { "&dump-memÜy", 
F_dump_memÜy
 },

2978 { "&dump-objeùs", 
F_dump_objeùs
 },

2979 { "&¡©-memÜy", 
F_¡©_memÜy
 },

2980 { "*", 
F_mul
 },

2981 { "+", 
F_add
 },

2982 { "-", 
F_sub
 },

2983 { "/", 
F_div
 },

2984 { "<", 
F_É
 },

2985 { "<=", 
F_Ë
 },

2986 { "=", 
F_numeq
 },

2987 { ">", 
F_gt
 },

2988 { ">=", 
F_ge
 },

2989 { "ªd", 
F_ªd
 },

2990 { "assoc", 
F_assoc
 },

2991 { "assq", 
F_assq
 },

2992 { "©om", 
F_©om
 },

2993 { "ÿr", 
F_ÿr
 },

2994 { "cdr", 
F_cdr
 },

2995 { "com·»-¡ršgs", 
F_com·»_¡ršgs
 },

2996 { "cÚÿt", 
F_cÚÿt
 },

2997 { "cÚd", 
F_cÚd
 },

2998 { "cÚs", 
F_cÚs
 },

2999 { "defun", 
F_defun
 },

3000 { "eq", 
F_eq
 },

3001 { "equ®", 
F_equ®
 },

3002 { "ev®", 
F_ev®
 },

3003 { "exfun", 
F_exfun
 },

3004 { "fÜm©", 
F_fÜm©
 },

3005 { "funÿÎ", 
F_funÿÎ
 },

3006 { "g¬bage-cŞËù", 
F_gc
 },

3007 { "gc", 
F_gc
 },

3008 { "if", 
F_if
 },

3009 { "šşude", 
F_šşude
 },

3010 { "li¡", 
F_li¡
 },

3011 { "nÙ", 
F_nÙ
 },

3012 { "Áh", 
F_Áh
 },

3013 { "nuÎ", 
F_nÙ
 },

3014 { "Ü", 
F_Ü
 },

3015 { "·th", 
F_·th
 },

3016 { "´šc", 
F_´šc
 },

3017 { "´og1", 
F_´og1
 },

3018 { "´og2", 
F_´og2
 },

3019 { "´ogn", 
F_´ogn
 },

3020 { "quÙe", 
F_quÙe
 },

3021 { "¿ssoc", 
F_¿ssoc
 },

3022 { "¿ssq", 
F_¿ssq
 },

3023 { "£t", 
F_£t
 },

3024 { "£tf", 
F_£tq
 },

3025 { "£tq", 
F_£tq
 },

3026 { "¡ršg-equ®", 
F_equ®
 },

3027 { "¡ršg-to-æßt", 
F_¡ršg_to_æßt
 },

3028 { "¡ršg-to-š‹g”", 
F_¡ršg_to_š‹g”
 },

3029 { "¡ršg-to-numb”", 
F_¡ršg_to_æßt
 },

3030 { "¡ršg=", 
F_equ®
 },

3031 { "uÆess", 
F_uÆess
 },

3032 { "un£t", 
F_un£t
 },

3033 { "un£tf", 
F_un£tq
 },

3034 { "un£tq", 
F_un£tq
 },

3035 { "wh’", 
F_wh’
 },

3036 { "whe", 
F_whe
 },

3039 
	~"®i¥_¢d.c
"

3041 
	$com·r
(cÚ¡ *
p1
, cÚ¡ *
p2
)

3043  
	`¡rcmp
(((
šŒšsic
 *)
p1
)->
Çme
,

3044 ((
šŒšsic
 *)
p2
)->
Çme
);

3045 
	}
}

3047 
šlše
 
®i¥_objeù
 * 
	$ev®_cÚs1
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
p1
, ®i¥_objeù * 
p2
)

3049 
®i¥_objeù
 * 
p3
;

3050 
šŒšsic
 
key
, *
™em
;

3052 
key
.
Çme
 = 
p1
->
v®ue
.
s
;

3054 ià((
™em
 = 
	`b£¬ch
(&
key
, 
šŒšsics
,

3055  
šŒšsics
 /  intrinsics[0],

3056  
šŒšsics
[0], 
com·r
)è!ğ
NULL
) {

3057 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

3058  
™em
->
	`func
(
š¡ªû
, 
p2
);

3061 ià((
™em
 = 
	`b£¬ch
(&
key
, 
¢d_šŒšsics
,

3062  
¢d_šŒšsics
 /  snd_intrinsics[0],

3063  
¢d_šŒšsics
[0], 
com·r
)è!ğ
NULL
) {

3064 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

3065  
™em
->
	`func
(
š¡ªû
, 
p2
);

3068 ià((
p3
 = 
	`g‘_objeù
(
š¡ªû
, 
p1
)è!ğ&
®§_li¥_n
) {

3069 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

3070  
	`ev®_func
(
š¡ªû
, 
p3
, 
p2
);

3072 
	`li¥_w¬n
(
š¡ªû
, "funùiÚ `%s' i undefšed", 
p1
->
v®ue
.
s
);

3073 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

3074 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

3077  &
®§_li¥_n
;

3078 
	}
}

3083 
®i¥_objeù
 * 
	$F_funÿÎ
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

3085 
®i¥_objeù
 * 
p
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
)), * 
p1
;

3087 ià(!
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_IDENTIFIER
) &&

3088 !
	`®i¥_com·»_ty³
(
p
, 
ALISP_OBJ_STRING
)) {

3089 
	`li¥_w¬n
(
š¡ªû
, "expected‡n function‚ame");

3090 
	`d–‘e_Œ“
(
š¡ªû
, 
p
);

3091 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

3092 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

3093  &
®§_li¥_n
;

3095 
p1
 = 
	`cdr
(
¬gs
);

3096 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

3097  
	`ev®_cÚs1
(
š¡ªû
, 
p
, 
p1
);

3098 
	}
}

3100 
šlše
 
®i¥_objeù
 * 
	$ev®_cÚs
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
p
)

3102 
®i¥_objeù
 * 
p1
 = 
	`ÿr
(
p
), * 
p2
;

3104 ià(
p1
 !ğ&
®§_li¥_n
 && 
	`®i¥_com·»_ty³
Õ1, 
ALISP_OBJ_IDENTIFIER
)) {

3105 ià(!
	`¡rcmp
(
p1
->
v®ue
.
s
, "lambda"))

3106  
p
;

3108 
p2
 = 
	`cdr
(
p
);

3109 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

3110  
	`ev®_cÚs1
(
š¡ªû
, 
p1
, 
p2
);

3112 
	`d–‘e_Œ“
(
š¡ªû
, 
p
);

3115  &
®§_li¥_n
;

3116 
	}
}

3118 
®i¥_objeù
 * 
	$ev®
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
p
)

3120 
	`®i¥_g‘_ty³
(
p
)) {

3121 
ALISP_OBJ_IDENTIFIER
: {

3122 
®i¥_objeù
 *
r
 = 
	`šüef_Œ“
(
š¡ªû
, 
	`g‘_objeù
(š¡ªû, 
p
));

3123 
	`d–‘e_objeù
(
š¡ªû
, 
p
);

3124  
r
;

3126 
ALISP_OBJ_INTEGER
:

3127 
ALISP_OBJ_FLOAT
:

3128 
ALISP_OBJ_STRING
:

3129 
ALISP_OBJ_POINTER
:

3130  
p
;

3131 
ALISP_OBJ_CONS
:

3132  
	`ev®_cÚs
(
š¡ªû
, 
p
);

3137  
p
;

3138 
	}
}

3140 
®i¥_objeù
 * 
	$F_ev®
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

3142  
	`ev®
(
š¡ªû
,ƒv®(š¡ªû, 
	`ÿr
(
¬gs
)));

3143 
	}
}

3149 
	$®i¥_šşude_fe
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
f’ame
)

3151 
¢d_šput_t
 *
Şd_š
;

3152 
®i¥_objeù
 *
p
, *
p1
;

3153 *
Çme
;

3154 
»tv®
 = 0, 
”r
;

3156 
”r
 = 
	`¢d_u£r_fe
(
f’ame
, &
Çme
);

3157 ià(
”r
 < 0)

3158  
”r
;

3159 
Şd_š
 = 
š¡ªû
->
š
;

3160 
”r
 = 
	`¢d_šput_¡dio_İ’
(&
š¡ªû
->
š
, 
Çme
, "r");

3161 ià(
”r
 < 0) {

3162 
»tv®
 = 
”r
;

3163 
_”r
;

3165 ià(
š¡ªû
->
v”bo£
)

3166 
	`li¥_v”bo£
(
š¡ªû
, "** inşudf’am'%s'", 
Çme
);

3169 ià((
p
 = 
	`·r£_objeù
(
š¡ªû
, 0)è=ğ
NULL
)

3171 ià(
š¡ªû
->
v”bo£
) {

3172 
	`li¥_v”bo£
(
š¡ªû
, "** code");

3173 
	`´šc_objeù
(
š¡ªû
->
vout
, 
p
);

3174 
	`¢d_ouut_putc
(
š¡ªû
->
vout
, '\n');

3176 
p1
 = 
	`ev®
(
š¡ªû
, 
p
);

3177 ià(
p1
 =ğ
NULL
) {

3178 
»tv®
 = -
ENOMEM
;

3181 ià(
š¡ªû
->
v”bo£
) {

3182 
	`li¥_v”bo£
(
š¡ªû
, "**„esult");

3183 
	`´šc_objeù
(
š¡ªû
->
vout
, 
p1
);

3184 
	`¢d_ouut_putc
(
š¡ªû
->
vout
, '\n');

3186 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

3187 ià(
š¡ªû
->
debug
) {

3188 
	`li¥_debug
(
š¡ªû
, "** objects‡fter operation");

3189 
	`´št_obj_li¡s
(
š¡ªû
, in¡ªû->
dout
);

3193 
	`¢d_šput_şo£
(
š¡ªû
->
š
);

3194 
_”r
:

3195 
	`ä“
(
Çme
);

3196 
š¡ªû
->
š
 = 
Şd_š
;

3197  
»tv®
;

3198 
	}
}

3200 
	$®§_li¥
(
®i¥_cfg
 *
cfg
, 
®i¥_š¡ªû
 **
_š¡ªû
)

3202 
®i¥_š¡ªû
 *
š¡ªû
;

3203 
®i¥_objeù
 *
p
, *
p1
;

3204 
i
, 
j
, 
»tv®
 = 0;

3206 
š¡ªû
 = (
®i¥_š¡ªû
 *)
	`ÿÎoc
(1, (alisp_instance));

3207 ià(
š¡ªû
 =ğ
NULL
) {

3208 
	`nomem
();

3209  -
ENOMEM
;

3211 
š¡ªû
->
v”bo£
 = 
cfg
->v”bo£ && cfg->
vout
;

3212 
š¡ªû
->
w¬nšg
 = 
cfg
->w¬nšg && cfg->
wout
;

3213 
š¡ªû
->
debug
 = 
cfg
->debug && cfg->
dout
;

3214 
š¡ªû
->
š
 = 
cfg
->in;

3215 
š¡ªû
->
out
 = 
cfg
->out;

3216 
š¡ªû
->
vout
 = 
cfg
->vout;

3217 
š¡ªû
->
eout
 = 
cfg
->eout;

3218 
š¡ªû
->
wout
 = 
cfg
->wout;

3219 
š¡ªû
->
dout
 = 
cfg
->dout;

3220 
	`INIT_LIST_HEAD
(&
š¡ªû
->
ä“_objs_li¡
);

3221 
i
 = 0; i < 
ALISP_OBJ_PAIR_HASH_SIZE
; i++) {

3222 
j
 = 0; j <ğ
ALISP_OBJ_LAST_SEARCH
; j++)

3223 
	`INIT_LIST_HEAD
(&
š¡ªû
->
u£d_objs_li¡
[
i
][
j
]);

3224 
	`INIT_LIST_HEAD
(&
š¡ªû
->
£tobjs_li¡
[
i
]);

3227 
	`š™_Ëx
(
š¡ªû
);

3230 ià((
p
 = 
	`·r£_objeù
(
š¡ªû
, 0)è=ğ
NULL
)

3232 ià(
š¡ªû
->
v”bo£
) {

3233 
	`li¥_v”bo£
(
š¡ªû
, "** code");

3234 
	`´šc_objeù
(
š¡ªû
->
vout
, 
p
);

3235 
	`¢d_ouut_putc
(
š¡ªû
->
vout
, '\n');

3237 
p1
 = 
	`ev®
(
š¡ªû
, 
p
);

3238 ià(
p1
 =ğ
NULL
) {

3239 
»tv®
 = -
ENOMEM
;

3242 ià(
š¡ªû
->
v”bo£
) {

3243 
	`li¥_v”bo£
(
š¡ªû
, "**„esult");

3244 
	`´šc_objeù
(
š¡ªû
->
vout
, 
p1
);

3245 
	`¢d_ouut_putc
(
š¡ªû
->
vout
, '\n');

3247 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

3248 ià(
š¡ªû
->
debug
) {

3249 
	`li¥_debug
(
š¡ªû
, "** objects‡fter operation");

3250 
	`´št_obj_li¡s
(
š¡ªû
, in¡ªû->
dout
);

3254 ià(
_š¡ªû
)

3255 *
_š¡ªû
 = 
š¡ªû
;

3257 
	`®§_li¥_ä“
(
š¡ªû
);

3259  
»tv®
;

3260 
	}
}

3262 
	$®§_li¥_ä“
(
®i¥_š¡ªû
 *
š¡ªû
)

3264 ià(
š¡ªû
 =ğ
NULL
)

3266 
	`dÚe_Ëx
(
š¡ªû
);

3267 
	`ä“_objeùs
(
š¡ªû
);

3268 
	`ä“
(
š¡ªû
);

3269 
	}
}

3271 
®i¥_cfg
 *
	$®§_li¥_deçuÉ_cfg
(
¢d_šput_t
 *
šput
)

3273 
¢d_ouut_t
 *
ouut
, *
eouut
;

3274 
®i¥_cfg
 *
cfg
;

3275 
”r
;

3277 
”r
 = 
	`¢d_ouut_¡dio_©ch
(&
ouut
, 
¡dout
, 0);

3278 ià(
”r
 < 0)

3279  
NULL
;

3280 
”r
 = 
	`¢d_ouut_¡dio_©ch
(&
eouut
, 
¡d”r
, 0);

3281 ià(
”r
 < 0) {

3282 
	`¢d_ouut_şo£
(
ouut
);

3283  
NULL
;

3285 
cfg
 = 
	`ÿÎoc
(1, (
®i¥_cfg
));

3286 ià(
cfg
 =ğ
NULL
) {

3287 
	`¢d_ouut_şo£
(
eouut
);

3288 
	`¢d_ouut_şo£
(
ouut
);

3289  
NULL
;

3291 
cfg
->
out
 = 
ouut
;

3292 
cfg
->
wout
 = 
eouut
;

3293 
cfg
->
eout
 = 
eouut
;

3294 
cfg
->
dout
 = 
eouut
;

3295 
cfg
->
š
 = 
šput
;

3296  
cfg
;

3297 
	}
}

3299 
	$®§_li¥_deçuÉ_cfg_ä“
(
®i¥_cfg
 *
cfg
)

3301 
	`¢d_šput_şo£
(
cfg
->
š
);

3302 
	`¢d_ouut_şo£
(
cfg
->
out
);

3303 
	`¢d_ouut_şo£
(
cfg
->
dout
);

3304 
	`ä“
(
cfg
);

3305 
	}
}

3307 
	$®§_li¥_funùiÚ
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_£q_™”©Ü
 **
»suÉ
,

3308 cÚ¡ *
id
, cÚ¡ *
¬gs
, ...)

3310 
”r
 = 0;

3311 
®i¥_objeù
 *
¯rgs
 = 
NULL
, *
obj
, *
»s
;

3313 ià(
¬gs
 && *args != 'n') {

3314 
va_li¡
 
­
;

3315 
®i¥_objeù
 *
p
;

3316 
p
 = 
NULL
;

3317 
	`va_¡¬t
(
­
, 
¬gs
);

3318 *
¬gs
) {

3319 ià(*
¬gs
++ != '%') {

3320 
”r
 = -
EINVAL
;

3323 ià(*
¬gs
 == '\0') {

3324 
”r
 = -
EINVAL
;

3327 
obj
 = 
NULL
;

3328 
”r
 = 0;

3329 *
¬gs
++) {

3331 
obj
 = 
	`Ãw_¡ršg
(
š¡ªû
, 
	`va_¬g
(
­
, *));

3334 
obj
 = 
	`Ãw_š‹g”
(
š¡ªû
, 
	`va_¬g
(
­
, ));

3337 
obj
 = 
	`Ãw_š‹g”
(
š¡ªû
, 
	`va_¬g
(
­
, ));

3341 
obj
 = 
	`Ãw_š‹g”
(
š¡ªû
, 
	`va_¬g
(
­
, ));

3344 
_±rid
[24];

3345 *
±rid
 = 
_±rid
;

3346 *
¬gs
 && *args != '%')

3347 *
±rid
++ = *
¬gs
++;

3348 *
±rid
 = 0;

3349 ià(
±rid
 =ğ
_±rid
) {

3350 
”r
 = -
EINVAL
;

3353 
obj
 = 
	`Ãw_cÚs_poš‹r
(
š¡ªû
, 
_±rid
, 
	`va_¬g
(
­
, *));

3354 
obj
 = 
	`quÙe_objeù
(
š¡ªû
, obj);

3358 
”r
 = -
EINVAL
;

3361 ià(
”r
 < 0)

3362 
__¬gs_’d
;

3363 ià(
obj
 =ğ
NULL
) {

3364 
”r
 = -
ENOMEM
;

3365 
__¬gs_’d
;

3367 ià(
p
 =ğ
NULL
) {

3368 
p
 = 
¯rgs
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

3370 
p
->
v®ue
.
c
.
cdr
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

3371 
p
 =…->
v®ue
.
c
.
cdr
;

3373 ià(
p
 =ğ
NULL
) {

3374 
”r
 = -
ENOMEM
;

3375 
__¬gs_’d
;

3377 
p
->
v®ue
.
c
.
ÿr
 = 
obj
;

3379 
__¬gs_’d
:

3380 
	`va_’d
(
­
);

3381 ià(
”r
 < 0)

3382  
”r
;

3384 
	`¢d_ouut_´štf
(
š¡ªû
->
wout
, ">>>");

3385 
	`´šc_objeù
(
š¡ªû
->
wout
, 
¯rgs
);

3386 
	`¢d_ouut_´štf
(
š¡ªû
->
wout
, "<<<\n");

3390 
”r
 = -
ENOENT
;

3391 ià(
¯rgs
 =ğ
NULL
)

3392 
¯rgs
 = &
®§_li¥_n
;

3393 ià((
obj
 = 
	`g‘_objeù1
(
š¡ªû
, 
id
)è!ğ&
®§_li¥_n
) {

3394 
»s
 = 
	`ev®_func
(
š¡ªû
, 
obj
, 
¯rgs
);

3395 
”r
 = 0;

3397 
šŒšsic
 
key
, *
™em
;

3398 
key
.
Çme
 = 
id
;

3399 ià((
™em
 = 
	`b£¬ch
(&
key
, 
šŒšsics
,

3400  
šŒšsics
 /  intrinsics[0],

3401  
šŒšsics
[0], 
com·r
)è!ğ
NULL
) {

3402 
»s
 = 
™em
->
	`func
(
š¡ªû
, 
¯rgs
);

3403 
”r
 = 0;

3404 } ià((
™em
 = 
	`b£¬ch
(&
key
, 
¢d_šŒšsics
,

3405  
¢d_šŒšsics
 /  snd_intrinsics[0],

3406  
¢d_šŒšsics
[0], 
com·r
)è!ğ
NULL
) {

3407 
»s
 = 
™em
->
	`func
(
š¡ªû
, 
¯rgs
);

3408 
”r
 = 0;

3410 
»s
 = &
®§_li¥_n
;

3413 ià(
»s
 =ğ
NULL
)

3414 
”r
 = -
ENOMEM
;

3415 ià(
”r
 =ğ0 && 
»suÉ
) {

3416 *
»suÉ
 = 
»s
;

3418 
	`d–‘e_Œ“
(
š¡ªû
, 
»s
);

3422 
	}
}

3424 
	$®§_li¥_»suÉ_ä“
(
®i¥_š¡ªû
 *
š¡ªû
,

3425 
®i¥_£q_™”©Ü
 *
»suÉ
)

3427 
	`d–‘e_Œ“
(
š¡ªû
, 
»suÉ
);

3428 
	}
}

3430 
	$®§_li¥_£q_fœ¡
(
®i¥_š¡ªû
 *
š¡ªû
, cÚ¡ *
id
,

3431 
®i¥_£q_™”©Ü
 **
£q
)

3433 
®i¥_objeù
 * 
p1
;

3435 
p1
 = 
	`g‘_objeù1
(
š¡ªû
, 
id
);

3436 ià(
p1
 =ğ
NULL
)

3437  -
ENOMEM
;

3438 *
£q
 = 
p1
;

3440 
	}
}

3442 
	$®§_li¥_£q_Ãxt
(
®i¥_£q_™”©Ü
 **
£q
)

3444 
®i¥_objeù
 * 
p1
 = *
£q
;

3446 
p1
 = 
	`cdr
(p1);

3447 ià(
p1
 =ğ&
®§_li¥_n
)

3448  -
ENOENT
;

3449 *
£q
 = 
p1
;

3451 
	}
}

3453 
	$®§_li¥_£q_couÁ
(
®i¥_£q_™”©Ü
 *
£q
)

3455 
couÁ
 = 0;

3457 
£q
 !ğ&
®§_li¥_n
) {

3458 
couÁ
++;

3459 
£q
 = 
	`cdr
(seq);

3461  
couÁ
;

3462 
	}
}

3464 
	$®§_li¥_£q_š‹g”
(
®i¥_£q_™”©Ü
 *
£q
, *
v®
)

3466 ià(
	`®i¥_com·»_ty³
(
£q
, 
ALISP_OBJ_CONS
))

3467 
£q
 = seq->
v®ue
.
c
.
cdr
;

3468 ià(
	`®i¥_com·»_ty³
(
£q
, 
ALISP_OBJ_INTEGER
))

3469 *
v®
 = 
£q
->
v®ue
.
i
;

3471  -
EINVAL
;

3473 
	}
}

3475 
	$®§_li¥_£q_poš‹r
(
®i¥_£q_™”©Ü
 *
£q
, cÚ¡ *
±r_id
, **
±r
)

3477 
®i¥_objeù
 * 
p2
;

3479 ià(
	`®i¥_com·»_ty³
(
£q
, 
ALISP_OBJ_CONS
) &&

3480 
	`®i¥_com·»_ty³
(
£q
->
v®ue
.
c
.
ÿr
, 
ALISP_OBJ_CONS
))

3481 
£q
 = seq->
v®ue
.
c
.
ÿr
;

3482 ià(
	`®i¥_com·»_ty³
(
£q
, 
ALISP_OBJ_CONS
)) {

3483 
p2
 = 
£q
->
v®ue
.
c
.
ÿr
;

3484 ià(!
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_STRING
))

3485  -
EINVAL
;

3486 ià(
	`¡rcmp
(
p2
->
v®ue
.
s
, 
±r_id
))

3487  -
EINVAL
;

3488 
p2
 = 
£q
->
v®ue
.
c
.
cdr
;

3489 ià(!
	`®i¥_com·»_ty³
(
p2
, 
ALISP_OBJ_POINTER
))

3490  -
EINVAL
;

3491 *
±r
 = (*)
£q
->
v®ue
.ptr;

3493  -
EINVAL
;

3495 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/alisp/alisp_local.h

24 
	~"li¡.h
"

26 
	e®i¥_tok’s
 {

27 
	mALISP_IDENTIFIER
,

28 
	mALISP_INTEGER
,

29 
	mALISP_FLOAT
,

30 
	mALISP_FLOATE
,

31 
	mALISP_STRING


34 
	e®i¥_objeùs
 {

35 
	mALISP_OBJ_INTEGER
,

36 
	mALISP_OBJ_FLOAT
,

37 
	mALISP_OBJ_IDENTIFIER
,

38 
	mALISP_OBJ_STRING
,

39 
	mALISP_OBJ_POINTER
,

40 
	mALISP_OBJ_CONS
,

41 
	mALISP_OBJ_LAST_SEARCH
 = 
ALISP_OBJ_CONS
,

42 
	mALISP_OBJ_NIL
,

43 
	mALISP_OBJ_T
,

46 
	g®i¥_objeù
;

48 
	#ALISP_TYPE_MASK
 0xf0000000

	)

49 
	#ALISP_TYPE_SHIFT
 28

	)

50 
	#ALISP_REFS_MASK
 0x0fffffff

	)

51 
	#ALISP_REFS_SHIFT
 0

	)

52 
	#ALISP_MAX_REFS
 (
ALISP_REFS_MASK
>>
ALISP_REFS_SHIFT
)

	)

53 
	#ALISP_MAX_REFS_LIMIT
 ((
ALISP_MAX_REFS
 + 1è/ 2)

	)

55 
	s®i¥_objeù
 {

56 
li¡_h—d
 
	mli¡
;

57 
	mty³_»fs
;

59 *
	ms
;

60 
	mi
;

61 
	mf
;

62 cÚ¡ *
	m±r
;

64 
®i¥_objeù
 *
	mÿr
;

65 
®i¥_objeù
 *
	mcdr
;

66 } 
	mc
;

67 } 
	mv®ue
;

70 
šlše
 
®i¥_objeùs
 
	$®i¥_g‘_ty³
(
®i¥_objeù
 *
p
)

72  (
p
->
ty³_»fs
 >> 
ALISP_TYPE_SHIFT
);

73 
	}
}

75 
šlše
 
	$®i¥_£t_ty³
(
®i¥_objeù
 *
p
, 
®i¥_objeùs
 
ty³
)

77 
p
->
ty³_»fs
 &ğ~
ALISP_TYPE_MASK
;

78 
p
->
ty³_»fs
 |ğ()
ty³
 << 
ALISP_TYPE_SHIFT
;

79 
	}
}

81 
šlše
 
	$®i¥_com·»_ty³
(
®i¥_objeù
 *
p
, 
®i¥_objeùs
 
ty³
)

83  (()
ty³
 << 
ALISP_TYPE_SHIFT
) ==

84 (
p
->
ty³_»fs
 & 
ALISP_TYPE_MASK
);

85 
	}
}

87 
šlše
 
	$®i¥_£t_»fs
(
®i¥_objeù
 *
p
, 
»fs
)

89 
p
->
ty³_»fs
 &ğ~
ALISP_REFS_MASK
;

90 
p
->
ty³_»fs
 |ğ
»fs
 & 
ALISP_REFS_MASK
;

91 
	}
}

93 
šlše
 
	$®i¥_g‘_»fs
(
®i¥_objeù
 *
p
)

95  
p
->
ty³_»fs
 & 
ALISP_REFS_MASK
;

96 
	}
}

98 
šlše
 
	$®i¥_šc_»fs
(
®i¥_objeù
 *
p
)

100 
r
 = 
	`®i¥_g‘_»fs
(
p
) + 1;

101 
	`®i¥_£t_»fs
(
p
, 
r
);

102  
r
;

103 
	}
}

105 
šlše
 
	$®i¥_dec_»fs
(
®i¥_objeù
 *
p
)

107 
r
 = 
	`®i¥_g‘_»fs
(
p
) - 1;

108 
	`®i¥_£t_»fs
(
p
, 
r
);

109  
r
;

110 
	}
}

112 
	s®i¥_objeù_·œ
 {

113 
li¡_h—d
 
	mli¡
;

114 cÚ¡ *
	mÇme
;

115 
®i¥_objeù
 *
	mv®ue
;

118 
	#ALISP_LEX_BUF_MAX
 16

	)

119 
	#ALISP_OBJ_PAIR_HASH_SHIFT
 4

	)

120 
	#ALISP_OBJ_PAIR_HASH_SIZE
 (1<<
ALISP_OBJ_PAIR_HASH_SHIFT
)

	)

121 
	#ALISP_OBJ_PAIR_HASH_MASK
 (
ALISP_OBJ_PAIR_HASH_SIZE
-1)

	)

122 
	#ALISP_FREE_OBJ_POOL
 512

	)

124 
	s®i¥_š¡ªû
 {

125 
	mv”bo£
: 1,

126 
	mw¬nšg
: 1,

127 
	mdebug
: 1;

129 
¢d_šput_t
 *
	mš
;

130 
¢d_ouut_t
 *
	mout
;

131 
¢d_ouut_t
 *
	meout
;

132 
¢d_ouut_t
 *
	mvout
;

133 
¢d_ouut_t
 *
	mwout
;

134 
¢d_ouut_t
 *
	mdout
;

136 
	mch¬no
;

137 
	mlš’o
;

138 
	mËx_buf
[
ALISP_LEX_BUF_MAX
];

139 *
	mËx_buå
;

140 *
	mtok’_bufãr
;

141 
	mtok’_bufãr_max
;

142 
	mthi¡ok’
;

144 
	mä“_objs
;

145 
	mu£d_objs
;

146 
	mmax_objs
;

147 
li¡_h—d
 
	mä“_objs_li¡
;

148 
li¡_h—d
 
	mu£d_objs_li¡
[
ALISP_OBJ_PAIR_HASH_SIZE
][
ALISP_OBJ_LAST_SEARCH
 + 1];

150 
li¡_h—d
 
	m£tobjs_li¡
[
ALISP_OBJ_PAIR_HASH_SIZE
];

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/alisp/alisp_snd.c

22 
	~"../cÚŒŞ/cÚŒŞ_loÿl.h
"

24 
	saÿÎ_bË
 {

25 cÚ¡ *
	mÇme
;

26 
	m®i¥_objeù
 * (*
	mfunc
è(
®i¥_š¡ªû
 *
	mš¡ªû
, 
aÿÎ_bË
 * 
	m™em
, 
®i¥_objeù
 * 
	m¬gs
);

27 * 
	mxfunc
;

28 cÚ¡ *
	m´efix
;

35 
šlše
 
	$g‘_š‹g”
(
®i¥_objeù
 * 
obj
)

37 ià(
	`®i¥_com·»_ty³
(
obj
, 
ALISP_OBJ_INTEGER
))

38  
obj
->
v®ue
.
i
;

40 
	}
}

42 
šlše
 cÚ¡ *
	$g‘_poš‹r
(
®i¥_objeù
 * 
obj
)

44 ià(
	`®i¥_com·»_ty³
(
obj
, 
ALISP_OBJ_POINTER
))

45  
obj
->
v®ue
.
±r
;

46  
NULL
;

47 
	}
}

49 cÚ¡ *
	$g‘_¡ršg
(
®i¥_objeù
 * 
obj
, cÚ¡ * 
deæt
)

51 ià(
obj
 =ğ&
®§_li¥_t
)

53 ià(
	`®i¥_com·»_ty³
(
obj
, 
ALISP_OBJ_STRING
) ||

54 
	`®i¥_com·»_ty³
(
obj
, 
ALISP_OBJ_IDENTIFIER
))

55  
obj
->
v®ue
.
s
;

56  
deæt
;

57 
	}
}

59 
	sæags
 {

60 cÚ¡ *
	mkey
;

61 
	mmask
;

64 
	$g‘_æags
(
®i¥_š¡ªû
 * 
š¡ªû
,

65 
®i¥_objeù
 * 
obj
,

66 cÚ¡ 
æags
 * flags,

67 
deæt
)

69 cÚ¡ *
key
;

70 
šv”t
;

71 
»suÉ
;

72 cÚ¡ 
æags
 *
±r
;

73 
®i¥_objeù
 *
n
;

75 ià(
obj
 =ğ&
®§_li¥_n
)

76  
deæt
;

77 
»suÉ
 = 
deæt
;

79 
key
 = 
	`g‘_¡ršg
(
obj
, 
NULL
);

80 ià(
key
) {

81 
šv”t
 = 
key
[0] == '!';

82 
key
 +ğ
šv”t
;

83 
±r
 = 
æags
;

84 
±r
->
key
) {

85 ià(!
	`¡rcmp
(
±r
->
key
, key)) {

86 ià(
šv”t
)

87 
»suÉ
 &ğ~
±r
->
mask
;

89 
»suÉ
 |ğ
±r
->
mask
;

92 
±r
++;

95 
	`d–‘e_Œ“
(
š¡ªû
, 
	`ÿr
(
obj
));

96 
obj
 = 
	`cdr
(
n
 = obj);

97 
	`d–‘e_objeù
(
š¡ªû
, 
n
);

98 } 
obj
 !ğ&
®§_li¥_n
);

99  
»suÉ
;

100 
	}
}

102 cÚ¡ *
	$g‘_±r
(
®i¥_š¡ªû
 * 
š¡ªû
,

103 
®i¥_objeù
 * 
obj
,

104 cÚ¡ *
_±r_id
)

106 cÚ¡ *
±r_id
;

107 cÚ¡ *
±r
;

109 
±r_id
 = 
	`g‘_¡ršg
(
	`ÿr
(
obj
), 
NULL
);

110 ià(
±r_id
 =ğ
NULL
) {

111 
	`d–‘e_Œ“
(
š¡ªû
, 
obj
);

112  
NULL
;

114 ià(
	`¡rcmp
(
±r_id
, 
_±r_id
)) {

115 
	`d–‘e_Œ“
(
š¡ªû
, 
obj
);

116  
NULL
;

118 
±r
 = 
	`g‘_poš‹r
(
	`cdr
(
obj
));

119 
	`d–‘e_Œ“
(
š¡ªû
, 
obj
);

120  
±r
;

121 
	}
}

123 
®i¥_objeù
 * 
	$Ãw_Ëx´
(
®i¥_š¡ªû
 * 
š¡ªû
, 
”r
)

125 
®i¥_objeù
 * 
Ëx´
;

127 
Ëx´
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

128 ià(
Ëx´
 =ğ
NULL
)

129  
NULL
;

130 
Ëx´
->
v®ue
.
c
.
ÿr
 = 
	`Ãw_š‹g”
(
š¡ªû
, 
”r
);

131 ià(
Ëx´
->
v®ue
.
c
.
ÿr
 =ğ
NULL
) {

132 
	`d–‘e_objeù
(
š¡ªû
, 
Ëx´
);

133  
NULL
;

135 
Ëx´
->
v®ue
.
c
.
cdr
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

136 ià(
Ëx´
->
v®ue
.
c
.
cdr
 =ğ
NULL
) {

137 
	`d–‘e_objeù
(
š¡ªû
, 
Ëx´
->
v®ue
.
c
.
ÿr
);

138 
	`d–‘e_objeù
(
š¡ªû
, 
Ëx´
);

139  
NULL
;

141  
Ëx´
;

142 
	}
}

144 
®i¥_objeù
 * 
	$add_cÚs
(
®i¥_š¡ªû
 * 
š¡ªû
,

145 
®i¥_objeù
 *
Ëx´
,

146 
cdr
, cÚ¡ *
id
,

147 
®i¥_objeù
 *
obj
)

149 
®i¥_objeù
 * 
p1
, * 
p2
;

151 ià(
Ëx´
 =ğ
NULL
 || 
obj
 == NULL) {

152 
	`d–‘e_Œ“
(
š¡ªû
, 
obj
);

153  
NULL
;

155 ià(
cdr
) {

156 
p1
 = 
Ëx´
->
v®ue
.
c
.
cdr
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

158 
p1
 = 
Ëx´
->
v®ue
.
c
.
ÿr
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

160 
Ëx´
 = 
p1
;

161 ià(
p1
 =ğ
NULL
) {

162 
	`d–‘e_Œ“
(
š¡ªû
, 
obj
);

163  
NULL
;

165 
p1
->
v®ue
.
c
.
ÿr
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

166 ià((
p2
 = 
p1
->
v®ue
.
c
.
ÿr
è=ğ
NULL
)

167 
__”r
;

168 
p2
->
v®ue
.
c
.
ÿr
 = 
	`Ãw_¡ršg
(
š¡ªû
, 
id
);

169 ià(
p2
->
v®ue
.
c
.
ÿr
 =ğ
NULL
) {

170 
__”r
:

171 ià(
cdr
)

172 
Ëx´
->
v®ue
.
c
.
cdr
 = 
NULL
;

174 
Ëx´
->
v®ue
.
c
.
ÿr
 = 
NULL
;

175 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

176 
	`d–‘e_Œ“
(
š¡ªû
, 
obj
);

177  
NULL
;

179 
p2
->
v®ue
.
c
.
cdr
 = 
obj
;

180  
Ëx´
;

181 
	}
}

183 
®i¥_objeù
 * 
	$add_cÚs2
(
®i¥_š¡ªû
 * 
š¡ªû
,

184 
®i¥_objeù
 *
Ëx´
,

185 
cdr
, 
®i¥_objeù
 *
obj
)

187 
®i¥_objeù
 * 
p1
;

189 ià(
Ëx´
 =ğ
NULL
 || 
obj
 == NULL) {

190 
	`d–‘e_Œ“
(
š¡ªû
, 
obj
);

191  
NULL
;

193 ià(
cdr
) {

194 
p1
 = 
Ëx´
->
v®ue
.
c
.
cdr
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

196 
p1
 = 
Ëx´
->
v®ue
.
c
.
ÿr
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

198 
Ëx´
 = 
p1
;

199 ià(
p1
 =ğ
NULL
) {

200 
	`d–‘e_Œ“
(
š¡ªû
, 
obj
);

201  
NULL
;

203 
p1
->
v®ue
.
c
.
ÿr
 = 
obj
;

204  
Ëx´
;

205 
	}
}

207 
®i¥_objeù
 * 
	$Ãw_»suÉ1
(
®i¥_š¡ªû
 * 
š¡ªû
,

208 
”r
, cÚ¡ *
±r_id
, *
±r
)

210 
®i¥_objeù
 * 
Ëx´
, * 
p1
;

212 ià(
”r
 < 0)

213 
±r
 = 
NULL
;

214 
Ëx´
 = 
	`Ãw_objeù
(
š¡ªû
, 
ALISP_OBJ_CONS
);

215 ià(
Ëx´
 =ğ
NULL
)

216  
NULL
;

217 
Ëx´
->
v®ue
.
c
.
ÿr
 = 
	`Ãw_š‹g”
(
š¡ªû
, 
”r
);

218 ià(
Ëx´
->
v®ue
.
c
.
ÿr
 =ğ
NULL
) {

219 
	`d–‘e_objeù
(
š¡ªû
, 
Ëx´
);

220  
NULL
;

222 
p1
 = 
	`add_cÚs
(
š¡ªû
, 
Ëx´
, 1, 
±r_id
, 
	`Ãw_poš‹r
(š¡ªû, 
±r
));

223 ià(
p1
 =ğ
NULL
) {

224 
	`d–‘e_objeù
(
š¡ªû
, 
Ëx´
);

225  
NULL
;

227  
Ëx´
;

228 
	}
}

230 
®i¥_objeù
 * 
	$Ãw_»suÉ2
(
®i¥_š¡ªû
 * 
š¡ªû
,

231 
”r
, 
v®
)

233 
®i¥_objeù
 * 
Ëx´
, * 
p1
;

235 ià(
”r
 < 0)

236 
v®
 = 0;

237 
Ëx´
 = 
	`Ãw_Ëx´
(
š¡ªû
, 
”r
);

238 ià(
Ëx´
 =ğ
NULL
)

239  
NULL
;

240 
p1
 = 
Ëx´
->
v®ue
.
c
.
cdr
;

241 
p1
->
v®ue
.
c
.
ÿr
 = 
	`Ãw_š‹g”
(
š¡ªû
, 
v®
);

242 ià(
p1
->
v®ue
.
c
.
ÿr
 =ğ
NULL
) {

243 
	`d–‘e_objeù
(
š¡ªû
, 
Ëx´
);

244  
NULL
;

246  
Ëx´
;

247 
	}
}

249 
®i¥_objeù
 * 
	$Ãw_»suÉ3
(
®i¥_š¡ªû
 * 
š¡ªû
,

250 
”r
, cÚ¡ *
¡r
)

252 
®i¥_objeù
 * 
Ëx´
, * 
p1
;

254 ià(
”r
 < 0)

255 
¡r
 = "";

256 
Ëx´
 = 
	`Ãw_Ëx´
(
š¡ªû
, 
”r
);

257 ià(
Ëx´
 =ğ
NULL
)

258  
NULL
;

259 
p1
 = 
Ëx´
->
v®ue
.
c
.
cdr
;

260 
p1
->
v®ue
.
c
.
ÿr
 = 
	`Ãw_¡ršg
(
š¡ªû
, 
¡r
);

261 ià(
p1
->
v®ue
.
c
.
ÿr
 =ğ
NULL
) {

262 
	`d–‘e_objeù
(
š¡ªû
, 
Ëx´
);

263  
NULL
;

265  
Ëx´
;

266 
	}
}

276 (*
	t¢d_št_µ_¡½_št_t
)(**
	trùl
, cÚ¡ *
	tÇme
, 
	tmode
);

277 (*
	t¢d_št_µ_p_t
)(**
	trùl
, *
	thªdË
);

278 (*
	t¢d_št_p_t
)(*
	trùl
);

279 * (*
	t¢d_¡r_p_t
)(*
	trùl
);

280 (*
	t¢d_št_š_t
)(*
	tv®
);

281 (*
	t¢d_št_¡r_t
)(cÚ¡ *
	t¡r
);

282 (*
	t¢d_št_št_¡½_t
)(
	tv®
, **
	t¡r
);

283 *(*
	t¢d_p_p_t
)(*
	thªdË
);

285 
®i¥_objeù
 * 
	$FA_št_µ_¡½_št
(
®i¥_š¡ªû
 * 
š¡ªû
, 
aÿÎ_bË
 * 
™em
, 
®i¥_objeù
 * 
¬gs
)

287 cÚ¡ *
Çme
;

288 
”r
, 
mode
;

289 *
hªdË
;

290 
®i¥_objeù
 *
p1
, *
p2
;

291 cÚ¡ 
æags
 flags[] = {

292 { "nÚblock", 
SND_CTL_NONBLOCK
 },

293 { "async", 
SND_CTL_ASYNC
 },

294 { "»adÚly", 
SND_CTL_READONLY
 },

295 { 
NULL
, 0 }

298 
Çme
 = 
	`g‘_¡ršg
(
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
)), 
NULL
);

299 ià(
Çme
 =ğ
NULL
)

300  &
®§_li¥_n
;

301 
mode
 = 
	`g‘_æags
(
š¡ªû
, 
p2
 = 
	`ev®
(š¡ªû, 
	`ÿr
(
	`cdr
(
¬gs
))), 
æags
, 0);

302 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

303 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

304 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

305 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

306 
”r
 = ((
¢d_št_µ_¡½_št_t
)
™em
->
xfunc
)(&
hªdË
, 
Çme
, 
mode
);

307 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

308  
	`Ãw_»suÉ1
(
š¡ªû
, 
”r
, 
™em
->
´efix
, 
hªdË
);

309 
	}
}

311 
®i¥_objeù
 * 
	$FA_št_µ_p
(
®i¥_š¡ªû
 * 
š¡ªû
, 
aÿÎ_bË
 * 
™em
, 
®i¥_objeù
 * 
¬gs
)

313 
”r
;

314 *
hªdË
;

315 cÚ¡ *
´efix1
;

316 
®i¥_objeù
 *
p1
;

318 ià(
™em
->
xfunc
 =ğ&
¢d_hùl_İ’_ùl
)

319 
´efix1
 = "ctl";

321 
	`d–‘e_Œ“
(
š¡ªû
, 
¬gs
);

322  &
®§_li¥_n
;

324 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

325 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

326 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

327 
hªdË
 = (*)
	`g‘_±r
(
š¡ªû
, 
p1
, 
´efix1
);

328 ià(
hªdË
 =ğ
NULL
)

329  &
®§_li¥_n
;

330 
”r
 = ((
¢d_št_µ_p_t
)
™em
->
xfunc
)(&
hªdË
, handle);

331  
	`Ãw_»suÉ1
(
š¡ªû
, 
”r
, 
™em
->
´efix
, 
hªdË
);

332 
	}
}

334 
®i¥_objeù
 * 
	$FA_p_p
(
®i¥_š¡ªû
 * 
š¡ªû
, 
aÿÎ_bË
 * 
™em
, 
®i¥_objeù
 * 
¬gs
)

336 *
hªdË
;

337 cÚ¡ *
´efix1
;

338 
®i¥_objeù
 * 
p1
;

340 ià(
™em
->
xfunc
 =ğ&
¢d_hùl_fœ¡_–em
 ||

341 
™em
->
xfunc
 =ğ&
¢d_hùl_Ï¡_–em
 ||

342 
™em
->
xfunc
 =ğ&
¢d_hùl_–em_Ãxt
 ||

343 
™em
->
xfunc
 =ğ&
¢d_hùl_–em_´ev
)

344 
´efix1
 = "hctl_elem";

345 ià(
™em
->
xfunc
 =ğ&
¢d_hùl_ùl
)

346 
´efix1
 = "ctl";

348 
	`d–‘e_Œ“
(
š¡ªû
, 
¬gs
);

349  &
®§_li¥_n
;

351 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

352 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

353 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

354 
hªdË
 = (*)
	`g‘_±r
(
š¡ªû
, 
p1
, 
™em
->
´efix
);

355 ià(
hªdË
 =ğ
NULL
)

356  &
®§_li¥_n
;

357 
hªdË
 = ((
¢d_p_p_t
)
™em
->
xfunc
)(handle);

358  
	`Ãw_cÚs_poš‹r
(
š¡ªû
, 
´efix1
, 
hªdË
);

359 
	}
}

361 
®i¥_objeù
 * 
	$FA_št_p
(
®i¥_š¡ªû
 * 
š¡ªû
, 
aÿÎ_bË
 * 
™em
, 
®i¥_objeù
 * 
¬gs
)

363 *
hªdË
;

364 
®i¥_objeù
 * 
p1
;

366 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

367 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

368 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

369 
hªdË
 = (*)
	`g‘_±r
(
š¡ªû
, 
p1
, 
™em
->
´efix
);

370 ià(
hªdË
 =ğ
NULL
)

371  &
®§_li¥_n
;

372  
	`Ãw_š‹g”
(
š¡ªû
, ((
¢d_št_p_t
)
™em
->
xfunc
)(
hªdË
));

373 
	}
}

375 
®i¥_objeù
 * 
	$FA_¡r_p
(
®i¥_š¡ªû
 * 
š¡ªû
, 
aÿÎ_bË
 * 
™em
, 
®i¥_objeù
 * 
¬gs
)

377 *
hªdË
;

378 
®i¥_objeù
 * 
p1
;

380 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

381 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

382 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

383 
hªdË
 = (*)
	`g‘_±r
(
š¡ªû
, 
p1
, 
™em
->
´efix
);

384 ià(
hªdË
 =ğ
NULL
)

385  &
®§_li¥_n
;

386  
	`Ãw_¡ršg
(
š¡ªû
, ((
¢d_¡r_p_t
)
™em
->
xfunc
)(
hªdË
));

387 
	}
}

389 
®i¥_objeù
 * 
	$FA_št_š
(
®i¥_š¡ªû
 * 
š¡ªû
, 
aÿÎ_bË
 * 
™em
, 
®i¥_objeù
 * 
¬gs
)

391 
v®
, 
”r
;

392 
®i¥_objeù
 * 
p1
;

394 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

395 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

396 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

397 ià(!
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
)) {

398 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

399  &
®§_li¥_n
;

401 
v®
 = 
p1
->
v®ue
.
i
;

402 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

403 
”r
 = ((
¢d_št_š_t
)
™em
->
xfunc
)(&
v®
);

404  
	`Ãw_»suÉ2
(
š¡ªû
, 
”r
, 
v®
);

405 
	}
}

407 
®i¥_objeù
 * 
	$FA_št_¡r
(
®i¥_š¡ªû
 * 
š¡ªû
, 
aÿÎ_bË
 * 
™em
, 
®i¥_objeù
 * 
¬gs
)

409 
”r
;

410 
®i¥_objeù
 * 
p1
;

412 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

413 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

414 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

415 ià(!
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_STRING
) &&

416 !
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_IDENTIFIER
)) {

417 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

418  &
®§_li¥_n
;

420 
”r
 = ((
¢d_št_¡r_t
)
™em
->
xfunc
)(
p1
->
v®ue
.
s
);

421 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

422  
	`Ãw_š‹g”
(
š¡ªû
, 
”r
);

423 
	}
}

425 
®i¥_objeù
 * 
	$FA_št_št_¡½
(
®i¥_š¡ªû
 * 
š¡ªû
, 
aÿÎ_bË
 * 
™em
, 
®i¥_objeù
 * 
¬gs
)

427 
”r
;

428 *
¡r
;

429 
v®
;

430 
®i¥_objeù
 * 
p1
;

432 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

433 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

434 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

435 ià(!
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_INTEGER
)) {

436 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

437  &
®§_li¥_n
;

439 
v®
 = 
p1
->
v®ue
.
i
;

440 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

441 
”r
 = ((
¢d_št_št_¡½_t
)
™em
->
xfunc
)(
v®
, &
¡r
);

442  
	`Ãw_»suÉ3
(
š¡ªû
, 
”r
, 
¡r
);

443 
	}
}

445 
®i¥_objeù
 * 
	$FA_ÿrd_šfo
(
®i¥_š¡ªû
 * 
š¡ªû
, 
aÿÎ_bË
 * 
™em
, 
®i¥_objeù
 * 
¬gs
)

447 
¢d_ùl_t
 *
hªdË
;

448 
®i¥_objeù
 * 
Ëx´
, * 
p1
;

449 
¢d_ùl_ÿrd_šfo_t
 
šfo
 = {0};

450 
”r
;

452 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

453 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

454 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

455 
hªdË
 = (
¢d_ùl_t
 *)
	`g‘_±r
(
š¡ªû
, 
p1
, 
™em
->
´efix
);

456 ià(
hªdË
 =ğ
NULL
)

457  &
®§_li¥_n
;

458 
”r
 = 
	`¢d_ùl_ÿrd_šfo
(
hªdË
, &
šfo
);

459 
Ëx´
 = 
	`Ãw_Ëx´
(
š¡ªû
, 
”r
);

460 ià(
”r
 < 0)

461  
Ëx´
;

462 
p1
 = 
	`add_cÚs
(
š¡ªû
, 
Ëx´
->
v®ue
.
c
.
cdr
, 0, "id", 
	`Ãw_¡ršg
(š¡ªû, 
	`¢d_ùl_ÿrd_šfo_g‘_id
(&
šfo
)));

463 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "driv”", 
	`Ãw_¡ršg
(š¡ªû, 
	`¢d_ùl_ÿrd_šfo_g‘_driv”
(&
šfo
)));

464 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "Çme", 
	`Ãw_¡ršg
(š¡ªû, 
	`¢d_ùl_ÿrd_šfo_g‘_Çme
(&
šfo
)));

465 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "lÚgÇme", 
	`Ãw_¡ršg
(š¡ªû, 
	`¢d_ùl_ÿrd_šfo_g‘_lÚgÇme
(&
šfo
)));

466 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "mix”Çme", 
	`Ãw_¡ršg
(š¡ªû, 
	`¢d_ùl_ÿrd_šfo_g‘_mix”Çme
(&
šfo
)));

467 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "compÚ’ts", 
	`Ãw_¡ršg
(š¡ªû, 
	`¢d_ùl_ÿrd_šfo_g‘_compÚ’ts
(&
šfo
)));

468 ià(
p1
 =ğ
NULL
) {

469 
	`d–‘e_Œ“
(
š¡ªû
, 
Ëx´
);

470  
NULL
;

472  
Ëx´
;

473 
	}
}

475 
®i¥_objeù
 * 
	$ü—‹_ùl_–em_id
(
®i¥_š¡ªû
 * 
š¡ªû
, 
¢d_ùl_–em_id_t
 * 
id
, 
®i¥_objeù
 * 
cÚs
)

477 
cÚs
 = 
	`add_cÚs
(
š¡ªû
, cÚs, 0, "numid", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_ùl_–em_id_g‘_numid
(
id
)));

478 
cÚs
 = 
	`add_cÚs
(
š¡ªû
, cÚs, 1, "içû", 
	`Ãw_¡ršg
(š¡ªû, 
	`¢d_ùl_–em_içû_Çme
(
	`¢d_ùl_–em_id_g‘_š‹rçû
(
id
))));

479 
cÚs
 = 
	`add_cÚs
(
š¡ªû
, cÚs, 1, "dev", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_ùl_–em_id_g‘_deviû
(
id
)));

480 
cÚs
 = 
	`add_cÚs
(
š¡ªû
, cÚs, 1, "subdev", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_ùl_–em_id_g‘_subdeviû
(
id
)));

481 
cÚs
 = 
	`add_cÚs
(
š¡ªû
, cÚs, 1, "Çme", 
	`Ãw_¡ršg
(š¡ªû, 
	`¢d_ùl_–em_id_g‘_Çme
(
id
)));

482 
cÚs
 = 
	`add_cÚs
(
š¡ªû
, cÚs, 1, "šdex", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_ùl_–em_id_g‘_šdex
(
id
)));

483  
cÚs
;

484 
	}
}

486 
	$·r£_ùl_–em_id
(
®i¥_š¡ªû
 * 
š¡ªû
,

487 
®i¥_objeù
 * 
cÚs
,

488 
¢d_ùl_–em_id_t
 * 
id
)

490 
®i¥_objeù
 *
p1
;

491 cÚ¡ *
xid
;

493 ià(
cÚs
 =ğ
NULL
)

494  -
ENOMEM
;

495 
	`¢d_ùl_–em_id_ş—r
(
id
);

496 
id
->
numid
 = 0;

498 
p1
 = 
	`ÿr
(
cÚs
);

499 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_CONS
)) {

500 
xid
 = 
	`g‘_¡ršg
(
p1
->
v®ue
.
c
.
ÿr
, 
NULL
);

501 ià(
xid
 =ğ
NULL
) {

503 } ià(!
	`¡rcmp
(
xid
, "numid")) {

504 
	`¢d_ùl_–em_id_£t_numid
(
id
, 
	`g‘_š‹g”
(
p1
->
v®ue
.
c
.
cdr
));

505 } ià(!
	`¡rcmp
(
xid
, "iface")) {

506 
	`¢d_ùl_–em_id_£t_š‹rçû
(
id
, 
	`¢d_cÚfig_g‘_ùl_içû_ascii
(
	`g‘_¡ršg
(
p1
->
v®ue
.
c
.
cdr
, "0")));

507 } ià(!
	`¡rcmp
(
xid
, "dev")) {

508 
	`¢d_ùl_–em_id_£t_deviû
(
id
, 
	`g‘_š‹g”
(
p1
->
v®ue
.
c
.
cdr
));

509 } ià(!
	`¡rcmp
(
xid
, "subdev")) {

510 
	`¢d_ùl_–em_id_£t_subdeviû
(
id
, 
	`g‘_š‹g”
(
p1
->
v®ue
.
c
.
cdr
));

511 } ià(!
	`¡rcmp
(
xid
, "name")) {

512 
	`¢d_ùl_–em_id_£t_Çme
(
id
, 
	`g‘_¡ršg
(
p1
->
v®ue
.
c
.
cdr
, "?"));

513 } ià(!
	`¡rcmp
(
xid
, "index")) {

514 
	`¢d_ùl_–em_id_£t_šdex
(
id
, 
	`g‘_š‹g”
(
p1
->
v®ue
.
c
.
cdr
));

517 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

518 
cÚs
 = 
	`cdr
(
p1
 = cons);

519 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

520 } 
cÚs
 !ğ&
®§_li¥_n
);

522 
	}
}

524 
®i¥_objeù
 * 
	$FA_hùl_fšd_–em
(
®i¥_š¡ªû
 * 
š¡ªû
, 
aÿÎ_bË
 * 
™em
, 
®i¥_objeù
 * 
¬gs
)

526 
¢d_hùl_t
 *
hªdË
;

527 
¢d_ùl_–em_id_t
 
id
 = {0};

528 
®i¥_objeù
 *
p1
;

530 
hªdË
 = (
¢d_hùl_t
 *)
	`g‘_±r
(
š¡ªû
, 
	`ÿr
(
¬gs
), 
™em
->
´efix
);

531 ià(
hªdË
 =ğ
NULL
) {

532 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

533 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

534  &
®§_li¥_n
;

536 
p1
 = 
	`ÿr
(
	`cdr
(
¬gs
));

537 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

538 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

539 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

540 ià(
	`·r£_ùl_–em_id
(
š¡ªû
, 
	`ev®
(š¡ªû, 
p1
), &
id
) < 0)

541  &
®§_li¥_n
;

542  
	`Ãw_cÚs_poš‹r
(
š¡ªû
, "hùl_–em", 
	`¢d_hùl_fšd_–em
(
hªdË
, &
id
));

543 
	}
}

545 
®i¥_objeù
 * 
	$FA_hùl_–em_šfo
(
®i¥_š¡ªû
 * 
š¡ªû
, 
aÿÎ_bË
 * 
™em
, 
®i¥_objeù
 * 
¬gs
)

547 
¢d_hùl_–em_t
 *
hªdË
;

548 
®i¥_objeù
 * 
Ëx´
, * 
p1
, * 
p2
;

549 
¢d_ùl_–em_šfo_t
 
šfo
 = {0};

550 
¢d_ùl_–em_id_t
 
id
 = {0};

551 
¢d_ùl_–em_ty³_t
 
ty³
;

552 
”r
;

554 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

555 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

556 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

557 
hªdË
 = (
¢d_hùl_–em_t
 *)
	`g‘_±r
(
š¡ªû
, 
p1
, 
™em
->
´efix
);

558 ià(
hªdË
 =ğ
NULL
)

559  &
®§_li¥_n
;

560 
”r
 = 
	`¢d_hùl_–em_šfo
(
hªdË
, &
šfo
);

561 
Ëx´
 = 
	`Ãw_Ëx´
(
š¡ªû
, 
”r
);

562 ià(
”r
 < 0)

563  
Ëx´
;

564 
ty³
 = 
	`¢d_ùl_–em_šfo_g‘_ty³
(&
šfo
);

565 
p1
 = 
	`add_cÚs
(
š¡ªû
, 
Ëx´
->
v®ue
.
c
.
cdr
, 0, "id", 
p2
 = 
	`Ãw_objeù
(š¡ªû, 
ALISP_OBJ_CONS
));

566 
	`¢d_ùl_–em_šfo_g‘_id
(&
šfo
, &
id
);

567 ià(
	`ü—‹_ùl_–em_id
(
š¡ªû
, &
id
, 
p2
è=ğ
NULL
) {

568 
	`d–‘e_Œ“
(
š¡ªû
, 
Ëx´
);

569  
NULL
;

571 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "ty³", 
	`Ãw_¡ršg
(š¡ªû, 
	`¢d_ùl_–em_ty³_Çme
(
ty³
)));

572 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "»adabË", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_ùl_–em_šfo_is_»adabË
(&
šfo
)));

573 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "wr™abË", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_ùl_–em_šfo_is_wr™abË
(&
šfo
)));

574 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "vŞ©e", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_ùl_–em_šfo_is_vŞ©e
(&
šfo
)));

575 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "šaùive", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_ùl_–em_šfo_is_šaùive
(&
šfo
)));

576 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "locked", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_ùl_–em_šfo_is_locked
(&
šfo
)));

577 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "isowÃr", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_ùl_–em_šfo_is_owÃr
(&
šfo
)));

578 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "owÃr", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_ùl_–em_šfo_g‘_owÃr
(&
šfo
)));

579 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "couÁ", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_ùl_–em_šfo_g‘_couÁ
(&
šfo
)));

580 
”r
 = 
	`INTERNAL
(
¢d_ùl_–em_šfo_g‘_dim’siÚs
)(&
šfo
);

581 ià(
”r
 > 0) {

582 
idx
;

583 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "dim’siÚs", 
p2
 = 
	`Ãw_objeù
(š¡ªû, 
ALISP_OBJ_CONS
));

584 
idx
 = 0; idx < 
”r
; idx++)

585 
p2
 = 
	`add_cÚs2
(
š¡ªû
,…2, 
idx
 > 0, 
	`Ãw_š‹g”
(š¡ªû, 
	`INTERNAL
(
¢d_ùl_–em_šfo_g‘_dim’siÚ
)(&
šfo
, idx)));

587 
ty³
) {

588 
SND_CTL_ELEM_TYPE_ENUMERATED
: {

589 
™ems
, 
™em
;

590 
™ems
 = 
	`¢d_ùl_–em_šfo_g‘_™ems
(&
šfo
);

591 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "™ems", 
p2
 = 
	`Ãw_objeù
(š¡ªû, 
ALISP_OBJ_CONS
));

592 
™em
 = 0; i‹m < 
™ems
; item++) {

593 
	`¢d_ùl_–em_šfo_£t_™em
(&
šfo
, 
™em
);

594 
”r
 = 
	`¢d_hùl_–em_šfo
(
hªdË
, &
šfo
);

595 ià(
”r
 < 0) {

596 
p2
 = 
	`add_cÚs2
(
š¡ªû
,…2, 
™em
, &
®§_li¥_n
);

598 
p2
 = 
	`add_cÚs2
(
š¡ªû
,…2, 
™em
, 
	`Ãw_¡ršg
(š¡ªû, 
	`¢d_ùl_–em_šfo_g‘_™em_Çme
(&
šfo
)));

603 
SND_CTL_ELEM_TYPE_INTEGER
:

604 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "mš", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_ùl_–em_šfo_g‘_mš
(&
šfo
)));

605 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "max", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_ùl_–em_šfo_g‘_max
(&
šfo
)));

606 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "¡•", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_ùl_–em_šfo_g‘_¡•
(&
šfo
)));

608 
SND_CTL_ELEM_TYPE_INTEGER64
:

609 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "mš64", 
	`Ãw_æßt
(š¡ªû, 
	`¢d_ùl_–em_šfo_g‘_mš64
(&
šfo
)));

610 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "max64", 
	`Ãw_æßt
(š¡ªû, 
	`¢d_ùl_–em_šfo_g‘_max64
(&
šfo
)));

611 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "¡•64", 
	`Ãw_æßt
(š¡ªû, 
	`¢d_ùl_–em_šfo_g‘_¡•64
(&
šfo
)));

616 ià(
p1
 =ğ
NULL
) {

617 
	`d–‘e_Œ“
(
š¡ªû
, 
Ëx´
);

618  
NULL
;

620  
Ëx´
;

621 
	}
}

623 
®i¥_objeù
 * 
	$FA_hùl_–em_»ad
(
®i¥_š¡ªû
 * 
š¡ªû
, 
aÿÎ_bË
 * 
™em
, 
®i¥_objeù
 * 
¬gs
)

625 
¢d_hùl_–em_t
 *
hªdË
;

626 
®i¥_objeù
 * 
Ëx´
, * 
p1
 = 
NULL
, * 
obj
;

627 
¢d_ùl_–em_šfo_t
 
šfo
 = {0};

628 
¢d_ùl_–em_v®ue_t
 
v®ue
 = {0};

629 
¢d_ùl_–em_ty³_t
 
ty³
;

630 
idx
, 
couÁ
;

631 
”r
;

633 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

634 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

635 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

636 
hªdË
 = (
¢d_hùl_–em_t
 *)
	`g‘_±r
(
š¡ªû
, 
p1
, 
™em
->
´efix
);

637 ià(
hªdË
 =ğ
NULL
)

638  &
®§_li¥_n
;

639 
”r
 = 
	`¢d_hùl_–em_šfo
(
hªdË
, &
šfo
);

640 ià(
”r
 >= 0)

641 
”r
 = 
	`¢d_hùl_–em_»ad
(
hªdË
, &
v®ue
);

642 
Ëx´
 = 
	`Ãw_Ëx´
(
š¡ªû
, 
”r
);

643 ià(
”r
 < 0)

644  
Ëx´
;

645 
ty³
 = 
	`¢d_ùl_–em_šfo_g‘_ty³
(&
šfo
);

646 
couÁ
 = 
	`¢d_ùl_–em_šfo_g‘_couÁ
(&
šfo
);

647 ià(
ty³
 =ğ
SND_CTL_ELEM_TYPE_IEC958
) {

648 
couÁ
 = (
¢d_«s_›c958_t
);

649 
ty³
 = 
SND_CTL_ELEM_TYPE_BYTES
;

651 
idx
 = 0; idx < 
couÁ
; idx++) {

652 
ty³
) {

653 
SND_CTL_ELEM_TYPE_BOOLEAN
:

654 
obj
 = 
	`Ãw_š‹g”
(
š¡ªû
, 
	`¢d_ùl_–em_v®ue_g‘_boŞ—n
(&
v®ue
, 
idx
));

656 
SND_CTL_ELEM_TYPE_INTEGER
:

657 
obj
 = 
	`Ãw_š‹g”
(
š¡ªû
, 
	`¢d_ùl_–em_v®ue_g‘_š‹g”
(&
v®ue
, 
idx
));

659 
SND_CTL_ELEM_TYPE_INTEGER64
:

660 
obj
 = 
	`Ãw_š‹g”
(
š¡ªû
, 
	`¢d_ùl_–em_v®ue_g‘_š‹g”64
(&
v®ue
, 
idx
));

662 
SND_CTL_ELEM_TYPE_ENUMERATED
:

663 
obj
 = 
	`Ãw_š‹g”
(
š¡ªû
, 
	`¢d_ùl_–em_v®ue_g‘_’um”©ed
(&
v®ue
, 
idx
));

665 
SND_CTL_ELEM_TYPE_BYTES
:

666 
obj
 = 
	`Ãw_š‹g”
(
š¡ªû
, 
	`¢d_ùl_–em_v®ue_g‘_by‹
(&
v®ue
, 
idx
));

669 
obj
 = 
NULL
;

672 ià(
idx
 == 0) {

673 
p1
 = 
	`add_cÚs2
(
š¡ªû
, 
Ëx´
->
v®ue
.
c
.
cdr
, 0, 
obj
);

675 
p1
 = 
	`add_cÚs2
(
š¡ªû
,…1, 1, 
obj
);

678 ià(
p1
 =ğ
NULL
) {

679 
	`d–‘e_Œ“
(
š¡ªû
, 
Ëx´
);

680  &
®§_li¥_n
;

682  
Ëx´
;

683 
	}
}

685 
®i¥_objeù
 * 
	$FA_hùl_–em_wr™e
(
®i¥_š¡ªû
 * 
š¡ªû
, 
aÿÎ_bË
 * 
™em
, 
®i¥_objeù
 * 
¬gs
)

687 
¢d_hùl_–em_t
 *
hªdË
;

688 
®i¥_objeù
 * 
p1
 = 
NULL
, * 
obj
;

689 
¢d_ùl_–em_šfo_t
 
šfo
 = {0};

690 
¢d_ùl_–em_v®ue_t
 
v®ue
 = {0};

691 
¢d_ùl_–em_ty³_t
 
ty³
;

692 
idx
, 
couÁ
;

693 
”r
;

695 
p1
 = 
	`ÿr
(
	`cdr
(
¬gs
));

696 
obj
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

697 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
¬gs
)));

698 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
¬gs
));

699 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

700 
hªdË
 = (
¢d_hùl_–em_t
 *)
	`g‘_±r
(
š¡ªû
, 
obj
, 
™em
->
´efix
);

701 ià(
hªdË
 =ğ
NULL
) {

702 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

703  &
®§_li¥_n
;

705 
”r
 = 
	`¢d_hùl_–em_šfo
(
hªdË
, &
šfo
);

706 ià(
”r
 < 0) {

707 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

708  
	`Ãw_š‹g”
(
š¡ªû
, 
”r
);

710 
ty³
 = 
	`¢d_ùl_–em_šfo_g‘_ty³
(&
šfo
);

711 
couÁ
 = 
	`¢d_ùl_–em_šfo_g‘_couÁ
(&
šfo
);

712 ià(
ty³
 =ğ
SND_CTL_ELEM_TYPE_IEC958
) {

713 
couÁ
 = (
¢d_«s_›c958_t
);

714 
ty³
 = 
SND_CTL_ELEM_TYPE_BYTES
;

716 
idx
 = -1;

718 ià(++
idx
 >ğ
couÁ
) {

719 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

722 
obj
 = 
	`ÿr
(
p1
);

723 
ty³
) {

724 
SND_CTL_ELEM_TYPE_BOOLEAN
:

725 
	`¢d_ùl_–em_v®ue_£t_boŞ—n
(&
v®ue
, 
idx
, 
	`g‘_š‹g”
(
obj
));

727 
SND_CTL_ELEM_TYPE_INTEGER
:

728 
	`¢d_ùl_–em_v®ue_£t_š‹g”
(&
v®ue
, 
idx
, 
	`g‘_š‹g”
(
obj
));

730 
SND_CTL_ELEM_TYPE_INTEGER64
:

731 
	`¢d_ùl_–em_v®ue_£t_š‹g”64
(&
v®ue
, 
idx
, 
	`g‘_š‹g”
(
obj
));

733 
SND_CTL_ELEM_TYPE_ENUMERATED
:

734 
	`¢d_ùl_–em_v®ue_£t_’um”©ed
(&
v®ue
, 
idx
, 
	`g‘_š‹g”
(
obj
));

736 
SND_CTL_ELEM_TYPE_BYTES
:

737 
	`¢d_ùl_–em_v®ue_£t_by‹
(&
v®ue
, 
idx
, 
	`g‘_š‹g”
(
obj
));

742 
	`d–‘e_Œ“
(
š¡ªû
, 
obj
);

743 
p1
 = 
	`cdr
(
obj
 =…1);

744 
	`d–‘e_objeù
(
š¡ªû
, 
obj
);

745 } 
p1
 !ğ&
®§_li¥_n
);

746 
”r
 = 
	`¢d_hùl_–em_wr™e
(
hªdË
, &
v®ue
);

747  
	`Ãw_š‹g”
(
š¡ªû
, 
”r
);

748 
	}
}

750 
®i¥_objeù
 * 
	$FA_pcm_šfo
(
®i¥_š¡ªû
 * 
š¡ªû
, 
aÿÎ_bË
 * 
™em
, 
®i¥_objeù
 * 
¬gs
)

752 
¢d_pcm_t
 *
hªdË
;

753 
®i¥_objeù
 * 
Ëx´
, * 
p1
;

754 
¢d_pcm_šfo_t
 
šfo
 = {0};

755 
”r
;

757 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

758 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

759 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

760 
hªdË
 = (
¢d_pcm_t
 *)
	`g‘_±r
(
š¡ªû
, 
p1
, 
™em
->
´efix
);

761 ià(
hªdË
 =ğ
NULL
)

762  &
®§_li¥_n
;

763 
”r
 = 
	`¢d_pcm_šfo
(
hªdË
, &
šfo
);

764 
Ëx´
 = 
	`Ãw_Ëx´
(
š¡ªû
, 
”r
);

765 ià(
”r
 < 0)

766  
Ëx´
;

767 
p1
 = 
	`add_cÚs
(
š¡ªû
, 
Ëx´
->
v®ue
.
c
.
cdr
, 0, "ÿrd", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_pcm_šfo_g‘_ÿrd
(&
šfo
)));

768 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "deviû", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_pcm_šfo_g‘_deviû
(&
šfo
)));

769 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "subdeviû", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_pcm_šfo_g‘_subdeviû
(&
šfo
)));

770 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "id", 
	`Ãw_¡ršg
(š¡ªû, 
	`¢d_pcm_šfo_g‘_id
(&
šfo
)));

771 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "Çme", 
	`Ãw_¡ršg
(š¡ªû, 
	`¢d_pcm_šfo_g‘_Çme
(&
šfo
)));

772 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "subdeviû_Çme", 
	`Ãw_¡ršg
(š¡ªû, 
	`¢d_pcm_šfo_g‘_subdeviû_Çme
(&
šfo
)));

773 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "şass", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_pcm_šfo_g‘_şass
(&
šfo
)));

774 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "subşass", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_pcm_šfo_g‘_subşass
(&
šfo
)));

775 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "subdeviûs_couÁ", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_pcm_šfo_g‘_subdeviûs_couÁ
(&
šfo
)));

776 
p1
 = 
	`add_cÚs
(
š¡ªû
,…1, 1, "subdeviûs_ava", 
	`Ãw_š‹g”
(š¡ªû, 
	`¢d_pcm_šfo_g‘_subdeviûs_ava
(&
šfo
)));

778  
Ëx´
;

779 
	}
}

785 cÚ¡ 
aÿÎ_bË
 
	gaÿÎ_bË
[] = {

786 { "ÿrd_g‘_šdex", &
FA_št_¡r
, (*)
¢d_ÿrd_g‘_šdex
, 
NULL
 },

787 { "ÿrd_g‘_lÚgÇme", &
FA_št_št_¡½
, (*)
¢d_ÿrd_g‘_lÚgÇme
, 
NULL
 },

788 { "ÿrd_g‘_Çme", &
FA_št_št_¡½
, (*)
¢d_ÿrd_g‘_Çme
, 
NULL
 },

789 { "ÿrd_Ãxt", &
FA_št_š
, (*)&
¢d_ÿrd_Ãxt
, 
NULL
 },

790 { "ùl_ÿrd_šfo", &
FA_ÿrd_šfo
, 
NULL
, "ctl" },

791 { "ùl_şo£", &
FA_št_p
, (*)&
¢d_ùl_şo£
, "ctl" },

792 { "ùl_İ’", &
FA_št_µ_¡½_št
, (*)&
¢d_ùl_İ’
, "ctl" },

793 { "hùl_şo£", &
FA_št_p
, (*)&
¢d_hùl_şo£
, "hctl" },

794 { "hùl_ùl", &
FA_p_p
, (*)&
¢d_hùl_ùl
, "hctl" },

795 { "hùl_–em_šfo", &
FA_hùl_–em_šfo
, (*)&
¢d_hùl_–em_šfo
, "hctl_elem" },

796 { "hùl_–em_Ãxt", &
FA_p_p
, (*)&
¢d_hùl_–em_Ãxt
, "hctl_elem" },

797 { "hùl_–em_´ev", &
FA_p_p
, (*)&
¢d_hùl_–em_´ev
, "hctl_elem" },

798 { "hùl_–em_»ad", &
FA_hùl_–em_»ad
, (*)&
¢d_hùl_–em_»ad
, "hctl_elem" },

799 { "hùl_–em_wr™e", &
FA_hùl_–em_wr™e
, (*)&
¢d_hùl_–em_wr™e
, "hctl_elem" },

800 { "hùl_fšd_–em", &
FA_hùl_fšd_–em
, (*)&
¢d_hùl_fšd_–em
, "hctl" },

801 { "hùl_fœ¡_–em", &
FA_p_p
, (*)&
¢d_hùl_fœ¡_–em
, "hctl" },

802 { "hùl_ä“", &
FA_št_p
, (*)&
¢d_hùl_ä“
, "hctl" },

803 { "hùl_Ï¡_–em", &
FA_p_p
, (*)&
¢d_hùl_Ï¡_–em
, "hctl" },

804 { "hùl_lßd", &
FA_št_p
, (*)&
¢d_hùl_lßd
, "hctl" },

805 { "hùl_İ’", &
FA_št_µ_¡½_št
, (*)&
¢d_hùl_İ’
, "hctl" },

806 { "hùl_İ’_ùl", &
FA_št_µ_p
, (*)&
¢d_hùl_İ’_ùl
, "hctl" },

807 { "pcm_šfo", &
FA_pcm_šfo
, 
NULL
, "pcm" },

808 { "pcm_Çme", &
FA_¡r_p
, (*)&
¢d_pcm_Çme
, "pcm" },

811 
	$aÿÎ_com·r
(cÚ¡ *
p1
, cÚ¡ *
p2
)

813  
	`¡rcmp
(((
aÿÎ_bË
 *)
p1
)->
Çme
,

814 ((
aÿÎ_bË
 *)
p2
)->
Çme
);

815 
	}
}

817 
®i¥_objeù
 * 
	$F_aÿÎ
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

819 
®i¥_objeù
 * 
p1
, *
p2
;

820 
aÿÎ_bË
 
key
, *
™em
;

822 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

823 
p2
 = 
	`cdr
(
¬gs
);

824 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

825 ià(!
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_IDENTIFIER
) &&

826 !
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_STRING
)) {

827 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

828  &
®§_li¥_n
;

830 
key
.
Çme
 = 
p1
->
v®ue
.
s
;

831 ià((
™em
 = 
	`b£¬ch
(&
key
, 
aÿÎ_bË
,

832  
aÿÎ_bË
 / ‡call_table[0],

833  
aÿÎ_bË
[0], 
aÿÎ_com·r
)è!ğ
NULL
) {

834 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

835  
™em
->
	`func
(
š¡ªû
, i‹m, 
p2
);

837 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

838 
	`d–‘e_Œ“
(
š¡ªû
, 
p2
);

839 
	`li¥_w¬n
(
š¡ªû
, "aÿÎ funùiÚ %s' i undefšed", 
p1
->
v®ue
.
s
);

840  &
®§_li¥_n
;

841 
	}
}

843 
®i¥_objeù
 * 
	$F_ahªdË
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

845 
®i¥_objeù
 *
p1
;

847 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

848 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

849 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

850 
¬gs
 = 
	`ÿr
(
	`cdr
(
p1
));

851 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(cdr(
p1
)));

852 
	`d–‘e_objeù
(
š¡ªû
, 
	`cdr
(
p1
));

853 
	`d–‘e_Œ“
(
š¡ªû
, 
	`ÿr
(
p1
));

854 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

855  
¬gs
;

856 
	}
}

858 
®i¥_objeù
 * 
	$F_«¼Ü
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

860 
®i¥_objeù
 *
p1
;

862 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
¬gs
));

863 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
¬gs
));

864 
	`d–‘e_objeù
(
š¡ªû
, 
¬gs
);

865 
¬gs
 = 
	`ÿr
(
p1
);

866 ià(
¬gs
 =ğ&
®§_li¥_n
) {

867 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

868  
	`Ãw_š‹g”
(
š¡ªû
, 
SND_ERROR_ALISP_NIL
);

870 
	`d–‘e_Œ“
(
š¡ªû
, 
	`cdr
(
p1
));

871 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

873  
¬gs
;

874 
	}
}

876 
	$commÚ_”rÜ
(
¢d_ouut_t
 **
rout
, 
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

878 
®i¥_objeù
 * 
p
 = 
¬gs
, * 
p1
;

879 
¢d_ouut_t
 *
out
;

880 
”r
;

882 
”r
 = 
	`¢d_ouut_bufãr_İ’
(&
out
);

883 ià(
”r
 < 0) {

884 
	`d–‘e_Œ“
(
š¡ªû
, 
¬gs
);

885  
”r
;

889 
p1
 = 
	`ev®
(
š¡ªû
, 
	`ÿr
(
p
));

890 ià(
	`®i¥_com·»_ty³
(
p1
, 
ALISP_OBJ_STRING
))

891 
	`¢d_ouut_´štf
(
out
, "%s", 
p1
->
v®ue
.
s
);

893 
	`´šc_objeù
(
out
, 
p1
);

894 
	`d–‘e_Œ“
(
š¡ªû
, 
p1
);

895 
p
 = 
	`cdr
(
p1
 =…);

896 
	`d–‘e_objeù
(
š¡ªû
, 
p1
);

897 } 
p
 !ğ&
®§_li¥_n
);

899 *
rout
 = 
out
;

901 
	}
}

903 
®i¥_objeù
 * 
	$F_¢d”r
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

905 
¢d_ouut_t
 *
out
;

906 *
¡r
;

908 ià(
	`commÚ_”rÜ
(&
out
, 
š¡ªû
, 
¬gs
) < 0)

909  &
®§_li¥_n
;

910 
	`¢d_ouut_bufãr_¡ršg
(
out
, &
¡r
);

911 
	`SNDERR
(
¡r
);

912 
	`¢d_ouut_şo£
(
out
);

913  &
®§_li¥_t
;

914 
	}
}

916 
®i¥_objeù
 * 
	$F_sy£¼
(
®i¥_š¡ªû
 *
š¡ªû
, 
®i¥_objeù
 * 
¬gs
)

918 
¢d_ouut_t
 *
out
;

919 *
¡r
;

921 ià(
	`commÚ_”rÜ
(&
out
, 
š¡ªû
, 
¬gs
) < 0)

922  &
®§_li¥_n
;

923 
	`¢d_ouut_bufãr_¡ršg
(
out
, &
¡r
);

924 
	`SYSERR
(
¡r
);

925 
	`¢d_ouut_şo£
(
out
);

926  &
®§_li¥_t
;

927 
	}
}

929 cÚ¡ 
šŒšsic
 
	g¢d_šŒšsics
[] = {

930 { "AÿÎ", 
F_aÿÎ
 },

931 { "A”rÜ", 
F_«¼Ü
 },

932 { "AhªdË", 
F_ahªdË
 },

933 { "A»suÉ", 
F_ahªdË
 },

934 { "A¢d”r", 
F_¢d”r
 },

935 { "Asy£¼", 
F_sy£¼
 }

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/async.c

27 
	~"pcm/pcm_loÿl.h
"

28 
	~"cÚŒŞ/cÚŒŞ_loÿl.h
"

29 
	~<sigÇl.h
>

31 
sigaùiÚ
 
	g´evious_aùiÚ
;

32 #iâdeà
DOC_HIDDEN


33 
	#MAX_SIG_FUNCTION_CODE
 10

	)

36 #ifdeà
SND_ASYNC_RT_SIGNAL


38 
	g¢d_async_signo
;

40 
	$¢d_async_š™
(è
	`__©Œibu‹__
 ((
cÚ¡ruùÜ
));

42 
	$¢d_async_š™
()

44 
¢d_async_signo
 = 
	`__libc_®loÿ‹_¹sig
(0);

45 ià(
¢d_async_signo
 < 0) {

46 
	`SNDERR
("Unableo find‡ RT signalo use for snd_async");

47 
	`ex™
(1);

49 
	}
}

52 cÚ¡ 
	g¢d_async_signo
 = 
SIGIO
;

55 
LIST_HEAD
(
¢d_async_hªdËrs
);

57 
	$¢d_async_hªdËr
(
signo
 
ATTRIBUTE_UNUSED
, 
sigšfo_t
 *
sigšfo
, *
cÚ‹xt
 ATTRIBUTE_UNUSED)

59 #ià
	`defšed
(
__D¿gÚFly__
è|| defšed(
__F»eBSD__
è|| defšed(
__O³nBSD__
)

61 
li¡_h—d
 *
i
;

62 
	`li¡_fÜ_—ch
(
i
, &
¢d_async_hªdËrs
) {

63 
¢d_async_hªdËr_t
 *
h
 = 
	`li¡_’Œy
(
i
, snd_async_hªdËr_t, 
gli¡
);

64 ià(
h
->
ÿÎback
)

65 
h
->
	`ÿÎback
(h);

68 
fd
;

69 
li¡_h—d
 *
i
;

71 ià(
signo
 =ğ
SIGIO


72 && ()(
´evious_aùiÚ
.
§_sigaùiÚ
è> 
MAX_SIG_FUNCTION_CODE
)

73 
´evious_aùiÚ
.
	`§_sigaùiÚ
(
signo
, 
sigšfo
, 
cÚ‹xt
);

74 
fd
 = 
sigšfo
->
si_fd
;

75 
	`li¡_fÜ_—ch
(
i
, &
¢d_async_hªdËrs
) {

76 
¢d_async_hªdËr_t
 *
h
 = 
	`li¡_’Œy
(
i
, snd_async_hªdËr_t, 
gli¡
);

77 ià(
h
->
fd
 =ğfd && h->
ÿÎback
)

78 
h
->
	`ÿÎback
(h);

81 
	}
}

112 
	$¢d_async_add_hªdËr
(
¢d_async_hªdËr_t
 **
hªdËr
, 
fd
,

113 
¢d_async_ÿÎback_t
 
ÿÎback
, *
´iv©e_d©a
)

115 
¢d_async_hªdËr_t
 *
h
;

116 
was_em±y
;

117 
	`as£¹
(
hªdËr
);

118 
h
 = 
	`m®loc
((*h));

119 ià(!
h
)

120  -
ENOMEM
;

121 
h
->
fd
 = fd;

122 
h
->
ÿÎback
 = callback;

123 
h
->
´iv©e_d©a
 =…rivate_data;

124 
was_em±y
 = 
	`li¡_em±y
(&
¢d_async_hªdËrs
);

125 
	`li¡_add_
(&
h
->
gli¡
, &
¢d_async_hªdËrs
);

126 
	`INIT_LIST_HEAD
(&
h
->
hli¡
);

127 *
hªdËr
 = 
h
;

128 ià(
was_em±y
) {

129 
”r
;

130 
sigaùiÚ
 
aù
;

131 
	`mem£t
(&
aù
, 0, (act));

132 
aù
.
§_æags
 = 
SA_RESTART
 | 
SA_SIGINFO
;

133 
aù
.
§_sigaùiÚ
 = 
¢d_async_hªdËr
;

134 
	`sigem±y£t
(&
aù
.
§_mask
);

135 
	`as£¹
(!
´evious_aùiÚ
.
§_sigaùiÚ
);

136 
”r
 = 
	`sigaùiÚ
(
¢d_async_signo
, &
aù
, &
´evious_aùiÚ
);

137 ià(
”r
 < 0) {

138 
	`SYSERR
("sigaction");

139  -
”ºo
;

143 
	}
}

150 
	$¢d_async_d–_hªdËr
(
¢d_async_hªdËr_t
 *
hªdËr
)

152 
”r
 = 0;

153 
was_em±y
 = 
	`li¡_em±y
(&
¢d_async_hªdËrs
);

154 
	`as£¹
(
hªdËr
);

155 
	`li¡_d–
(&
hªdËr
->
gli¡
);

156 ià(!
was_em±y


157 && 
	`li¡_em±y
(&
¢d_async_hªdËrs
)) {

158 
”r
 = 
	`sigaùiÚ
(
¢d_async_signo
, &
´evious_aùiÚ
, 
NULL
);

159 ià(
”r
 < 0) {

160 
	`SYSERR
("sigaction");

161  -
”ºo
;

163 
	`mem£t
(&
´evious_aùiÚ
, 0, (previous_action));

165 ià(
hªdËr
->
ty³
 =ğ
SND_ASYNC_HANDLER_GENERIC
)

166 
_’d
;

167 ià(!
	`li¡_em±y
(&
hªdËr
->
hli¡
))

168 
	`li¡_d–
(&
hªdËr
->
hli¡
);

169 ià(!
	`li¡_em±y
(&
hªdËr
->
hli¡
))

170 
_’d
;

171 
hªdËr
->
ty³
) {

172 #ifdeà
BUILD_PCM


173 
SND_ASYNC_HANDLER_PCM
:

174 
”r
 = 
	`¢d_pcm_async
(
hªdËr
->
u
.
pcm
, -1, 1);

177 
SND_ASYNC_HANDLER_CTL
:

178 
”r
 = 
	`¢d_ùl_async
(
hªdËr
->
u
.
ùl
, -1, 1);

181 
	`as£¹
(0);

183 
_’d
:

184 
	`ä“
(
hªdËr
);

185  
”r
;

186 
	}
}

197 
	$¢d_async_hªdËr_g‘_signo
(
¢d_async_hªdËr_t
 *
hªdËr
)

199 
	`as£¹
(
hªdËr
);

200  
¢d_async_signo
;

201 
	}
}

208 
	$¢d_async_hªdËr_g‘_fd
(
¢d_async_hªdËr_t
 *
hªdËr
)

210 
	`as£¹
(
hªdËr
);

211  
hªdËr
->
fd
;

212 
	}
}

219 *
	$¢d_async_hªdËr_g‘_ÿÎback_´iv©e
(
¢d_async_hªdËr_t
 *
hªdËr
)

221 
	`as£¹
(
hªdËr
);

222  
hªdËr
->
´iv©e_d©a
;

223 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/conf.c

427 
	~"loÿl.h
"

428 
	~<¡d¬g.h
>

429 
	~<¡dboŞ.h
>

430 
	~<lim™s.h
>

431 
	~<sys/¡©.h
>

432 
	~<dœ’t.h
>

433 
	~<loÿË.h
>

434 #ifdeà
HAVE_LIBPTHREAD


435 
	~<±h»ad.h
>

438 #iâdeà
DOC_HIDDEN


440 #ifdeà
HAVE_LIBPTHREAD


441 
±h»ad_mu‹x_t
 
	g¢d_cÚfig_upd©e_mu‹x
;

442 
±h»ad_Úû_t
 
	g¢d_cÚfig_upd©e_mu‹x_Úû
 = 
PTHREAD_ONCE_INIT
;

445 
	s_¢d_cÚfig
 {

446 *
	mid
;

447 
¢d_cÚfig_ty³_t
 
	mty³
;

448 
	m»fcouÁ
;

450 
	mš‹g”
;

451 
	mš‹g”64
;

452 *
	m¡ršg
;

453 
	m»®
;

454 cÚ¡ *
	m±r
;

456 
li¡_h—d
 
	mf›lds
;

457 
boŞ
 
	mjoš
;

458 } 
	mcompound
;

459 } 
	mu
;

460 
li¡_h—d
 
	mli¡
;

461 
¢d_cÚfig_t
 *
	m·»Á
;

462 
	mhİ
;

465 
	sfedesc
 {

466 *
	mÇme
;

467 
¢d_šput_t
 *
	mš
;

468 
	mlše
, 
	mcŞumn
;

469 
fedesc
 *
	mÃxt
;

475 
li¡_h—d
 
	mšşude_·ths
;

479 
	sšşude_·th
 {

480 *
	mdœ
;

481 
li¡_h—d
 
	mli¡
;

484 
	#LOCAL_ERROR
 (-0x68000000)

	)

486 
	#LOCAL_UNTERMINATED_STRING
 (
LOCAL_ERROR
 - 0)

	)

487 
	#LOCAL_UNTERMINATED_QUOTE
 (
LOCAL_ERROR
 - 1)

	)

488 
	#LOCAL_UNEXPECTED_CHAR
 (
LOCAL_ERROR
 - 2)

	)

489 
	#LOCAL_UNEXPECTED_EOF
 (
LOCAL_ERROR
 - 3)

	)

492 
fedesc
 *
	mcu¼’t
;

493 
	mung‘
;

494 
	mch
;

495 } 
	tšput_t
;

497 #ifdeà
HAVE_LIBPTHREAD


499 
	$¢d_cÚfig_š™_mu‹x
()

501 
±h»ad_mu‹x©Œ_t
 
©Œ
;

503 
	`±h»ad_mu‹x©Œ_š™
(&
©Œ
);

504 #ifdeà
HAVE_PTHREAD_MUTEX_RECURSIVE


505 
	`±h»ad_mu‹x©Œ_£‰y³
(&
©Œ
, 
PTHREAD_MUTEX_RECURSIVE
);

507 
	`±h»ad_mu‹x_š™
(&
¢d_cÚfig_upd©e_mu‹x
, &
©Œ
);

508 
	`±h»ad_mu‹x©Œ_de¡roy
(&
©Œ
);

509 
	}
}

511 
šlše
 
	$¢d_cÚfig_lock
()

513 
	`±h»ad_Úû
(&
¢d_cÚfig_upd©e_mu‹x_Úû
, 
¢d_cÚfig_š™_mu‹x
);

514 
	`±h»ad_mu‹x_lock
(&
¢d_cÚfig_upd©e_mu‹x
);

515 
	}
}

517 
šlše
 
	$¢d_cÚfig_uÆock
()

519 
	`±h»ad_mu‹x_uÆock
(&
¢d_cÚfig_upd©e_mu‹x
);

520 
	}
}

524 
šlše
 
	$¢d_cÚfig_lock
(è{ 
	}
}

525 
šlše
 
	$¢d_cÚfig_uÆock
(è{ 
	}
}

539 
	$add_šşude_·th
(
fedesc
 *
fd
, cÚ¡ *
dœ
)

541 
šşude_·th
 *
·th
;

542 
fedesc
 *
fd1
;

543 
li¡_h—d
 *
pos
;

546 
fd1
 = 
fd
; fd1; fd1 = fd1->
Ãxt
) {

547 
	`li¡_fÜ_—ch
(
pos
, &
fd1
->
šşude_·ths
) {

548 
·th
 = 
	`li¡_’Œy
(
pos
, 
šşude_·th
, 
li¡
);

549 ià(
	`¡rcmp
(
·th
->
dœ
, dir) == 0)

554 
·th
 = 
	`ÿÎoc
(1, (*path));

555 ià(!
·th
)

556  -
ENOMEM
;

558 
·th
->
dœ
 = 
	`¡rdup
(dir);

559 ià(
·th
->
dœ
 =ğ
NULL
) {

560 
	`ä“
(
·th
);

561  -
ENOMEM
;

564 
	`li¡_add_
(&
·th
->
li¡
, &
fd
->
šşude_·ths
);

566 
	}
}

572 
	$ä“_šşude_·ths
(
fedesc
 *
fd
)

574 
li¡_h—d
 *
pos
, *
Åos
, *
ba£
;

575 
šşude_·th
 *
·th
;

577 
ba£
 = &
fd
->
šşude_·ths
;

578 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, 
ba£
) {

579 
·th
 = 
	`li¡_’Œy
(
pos
, 
šşude_·th
, 
li¡
);

580 
	`li¡_d–
(&
·th
->
li¡
);

581 ià(
·th
->
dœ
)

582 
	`ä“
(
·th
->
dœ
);

583 
	`ä“
(
·th
);

585 
	}
}

598 cÚ¡ *
	$¢d_cÚfig_tİdœ
()

600 *
tİdœ
;

602 ià(!
tİdœ
) {

603 
tİdœ
 = 
	`g‘’v
("ALSA_CONFIG_DIR");

604 ià(!
tİdœ
 || *tİdœ !ğ'/' || 
	`¡¾’
Ñİdœè>ğ
PATH_MAX
)

605 
tİdœ
 = 
ALSA_CONFIG_DIR
;

607  
tİdœ
;

608 
	}
}

610 #iâdeà
DOC_HIDDEN


612 *
	$_¢d_cÚfig_·th
(cÚ¡ *
Çme
)

614 cÚ¡ *
roÙ
 = 
	`¢d_cÚfig_tİdœ
();

615 *
·th
 = 
	`m®loc
(
	`¡¾’
(
roÙ
è+ sŒËn(
Çme
) + 2);

616 ià(!
·th
)

617  
NULL
;

618 
	`¥rštf
(
·th
, "%s/%s", 
roÙ
, 
Çme
);

619  
·th
;

620 
	}
}

638 
	$šput_¡dio_İ’
(
¢d_šput_t
 **
špu
, cÚ¡ *
fe
,

639 
fedesc
 *
cu¼’t
)

641 
li¡_h—d
 *
pos
;

642 
šşude_·th
 *
·th
;

643 
fuÎ_·th
[
PATH_MAX
];

644 
”r
;

646 ià(
fe
[0] == '/')

647  
	`¢d_šput_¡dio_İ’
(
špu
, 
fe
, "r");

652 
”r
 = -
ENOENT
;

653 
cu¼’t
) {

654 
	`li¡_fÜ_—ch
(
pos
, &
cu¼’t
->
šşude_·ths
) {

655 
·th
 = 
	`li¡_’Œy
(
pos
, 
šşude_·th
, 
li¡
);

656 ià(!
·th
->
dœ
)

659 
	`¢´štf
(
fuÎ_·th
, 
PATH_MAX
, "%s/%s", 
·th
->
dœ
, 
fe
);

660 
”r
 = 
	`¢d_šput_¡dio_İ’
(
špu
, 
fuÎ_·th
, "r");

661 ià(
”r
 == 0)

664 
cu¼’t
 = cu¼’t->
Ãxt
;

667  
”r
;

668 
	}
}

670 
	$_¢d_§ã_¡¹Şl_ba£
(cÚ¡ *
¡r
, *
v®
, 
ba£
)

672 *
’d
;

673 
v
;

674 ià(!*
¡r
)

675  -
EINVAL
;

676 
”ºo
 = 0;

677 
v
 = 
	`¡¹Şl
(
¡r
, &
’d
, 
ba£
);

678 ià(
”ºo
)

679  -
”ºo
;

680 ià(*
’d
)

681  -
EINVAL
;

682 *
v®
 = 
v
;

684 
	}
}

686 
	$_¢d_§ã_¡¹Ş_ba£
(cÚ¡ *
¡r
, *
v®
, 
ba£
)

688 *
’d
;

689 
v
;

690 ià(!*
¡r
)

691  -
EINVAL
;

692 
”ºo
 = 0;

693 
v
 = 
	`¡¹Ş
(
¡r
, &
’d
, 
ba£
);

694 ià(
”ºo
)

695  -
”ºo
;

696 ià(*
’d
)

697  -
EINVAL
;

698 *
v®
 = 
v
;

700 
	}
}

702 
	$_¢d_§ã_¡¹od
(cÚ¡ *
¡r
, *
v®
)

704 *
’d
;

705 
v
;

706 #ifdeà
HAVE_USELOCALE


707 
loÿË_t
 
§ved_loÿË
, 
c_loÿË
;

709 *
§ved_loÿË
;

710 
loc¡r
[64];

712 
”r
;

714 ià(!*
¡r
)

715  -
EINVAL
;

716 #ifdeà
HAVE_USELOCALE


717 
c_loÿË
 = 
	`ÃwloÿË
(
LC_NUMERIC_MASK
, "C", 0);

718 
§ved_loÿË
 = 
	`u£loÿË
(
c_loÿË
);

720 
§ved_loÿË
 = 
	`£oÿË
(
LC_NUMERIC
, 
NULL
);

721 ià(
§ved_loÿË
) {

722 
	`¢´štf
(
loc¡r
, Öoc¡r), "%s", 
§ved_loÿË
);

723 
	`£oÿË
(
LC_NUMERIC
, "C");

726 
”ºo
 = 0;

727 
v
 = 
	`¡¹od
(
¡r
, &
’d
);

728 
”r
 = -
”ºo
;

729 #ifdeà
HAVE_USELOCALE


730 ià(
c_loÿË
 !ğ(
loÿË_t
)0) {

731 
	`u£loÿË
(
§ved_loÿË
);

732 
	`ä“loÿË
(
c_loÿË
);

735 ià(
§ved_loÿË
)

736 
	`£oÿË
(
LC_NUMERIC
, 
loc¡r
);

738 ià(
”r
)

739  
”r
;

740 ià(*
’d
)

741  -
EINVAL
;

742 *
v®
 = 
v
;

744 
	}
}

746 
	$g‘_ch¬
(
šput_t
 *
šput
)

748 
c
;

749 
fedesc
 *
fd
;

750 ià(
šput
->
ung‘
) {

751 
šput
->
ung‘
 = 0;

752  
šput
->
ch
;

754 
agaš
:

755 
fd
 = 
šput
->
cu¼’t
;

756 
c
 = 
	`¢d_šput_g‘c
(
fd
->
š
);

757 
c
) {

759 
fd
->
cŞumn
 = 0;

760 
fd
->
lše
++;

763 
fd
->
cŞumn
 += 8 - fd->column % 8;

765 
EOF
:

766 ià(
fd
->
Ãxt
) {

767 
	`¢d_šput_şo£
(
fd
->
š
);

768 
	`ä“
(
fd
->
Çme
);

769 
šput
->
cu¼’t
 = 
fd
->
Ãxt
;

770 
	`ä“
(
fd
);

771 
agaš
;

773  
LOCAL_UNEXPECTED_EOF
;

775 
fd
->
cŞumn
++;

778  ()
c
;

779 
	}
}

781 
	$ung‘_ch¬
(
c
, 
šput_t
 *
šput
)

783 
	`as£¹
(!
šput
->
ung‘
);

784 
šput
->
ch
 = 
c
;

785 
šput
->
ung‘
 = 1;

786 
	}
}

788 
g‘_d–im¡ršg
(**
¡ršg
, 
d–im
, 
šput_t
 *
šput
);

790 
	$g‘_ch¬_sk_comm’ts
(
šput_t
 *
šput
)

792 
c
;

794 
c
 = 
	`g‘_ch¬
(
šput
);

795 ià(
c
 == '<') {

796 *
¡r
;

797 
¢d_šput_t
 *
š
;

798 
fedesc
 *
fd
;

799 
DIR
 *
dœp
;

800 
”r
 = 
	`g‘_d–im¡ršg
(&
¡r
, '>', 
šput
);

801 ià(
”r
 < 0)

802  
”r
;

804 ià(!
	`¡ºcmp
(
¡r
, "searchdir:", 10)) {

806 *
tmp
 = 
	`_¢d_cÚfig_·th
(
¡r
 + 10);

807 
	`ä“
(
¡r
);

808 ià(
tmp
 =ğ
NULL
)

809  -
ENOMEM
;

810 
¡r
 = 
tmp
;

812 
dœp
 = 
	`İ’dœ
(
¡r
);

813 ià(!
dœp
) {

814 
	`SNDERR
("Inv®id s—rch dœ %s", 
¡r
);

815 
	`ä“
(
¡r
);

816  -
EINVAL
;

818 
	`şo£dœ
(
dœp
);

820 
”r
 = 
	`add_šşude_·th
(
šput
->
cu¼’t
, 
¡r
);

821 ià(
”r
 < 0) {

822 
	`SNDERR
("CªnÙ‡dd s—rch dœ %s", 
¡r
);

823 
	`ä“
(
¡r
);

824  
”r
;

826 
	`ä“
(
¡r
);

830 ià(!
	`¡ºcmp
(
¡r
, "confdir:", 8)) {

832 *
tmp
 = 
	`_¢d_cÚfig_·th
(
¡r
 + 8);

833 
	`ä“
(
¡r
);

834 ià(
tmp
 =ğ
NULL
)

835  -
ENOMEM
;

836 
¡r
 = 
tmp
;

837 
”r
 = 
	`¢d_šput_¡dio_İ’
(&
š
, 
¡r
, "r");

839 
”r
 = 
	`šput_¡dio_İ’
(&
š
, 
¡r
, 
šput
->
cu¼’t
);

842 ià(
”r
 < 0) {

843 
	`SNDERR
("CªnÙ‡cûs f%s", 
¡r
);

844 
	`ä“
(
¡r
);

845  
”r
;

847 
fd
 = 
	`m®loc
((*fd));

848 ià(!
fd
) {

849 
	`ä“
(
¡r
);

850  -
ENOMEM
;

852 
fd
->
Çme
 = 
¡r
;

853 
fd
->
š
 = in;

854 
fd
->
Ãxt
 = 
šput
->
cu¼’t
;

855 
fd
->
lše
 = 1;

856 
fd
->
cŞumn
 = 0;

857 
	`INIT_LIST_HEAD
(&
fd
->
šşude_·ths
);

858 
šput
->
cu¼’t
 = 
fd
;

861 ià(
c
 != '#')

864 
c
 = 
	`g‘_ch¬
(
šput
);

865 ià(
c
 < 0)

866  
c
;

867 ià(
c
 == '\n')

872  
c
;

873 
	}
}

876 
	$g‘_nÚwh™e
(
šput_t
 *
šput
)

878 
c
;

880 
c
 = 
	`g‘_ch¬_sk_comm’ts
(
šput
);

881 
c
) {

889  
c
;

892 
	}
}

894 
šlše
 
	$g‘_hexach¬
(
šput_t
 *
šput
)

896 
c
, 
num
 = 0;

898 
c
 = 
	`g‘_ch¬
(
šput
);

899 ià(
c
 >ğ'0' && c <ğ'9'è
num
 |= (c - '0') << 4;

900 ià(
c
 >ğ'a' && c <ğ'f'è
num
 |= (c - 'a') << 4;

901 ià(
c
 >ğ'A' && c <ğ'F'è
num
 |= (c - 'A') << 4;

902 
c
 = 
	`g‘_ch¬
(
šput
);

903 ià(
c
 >ğ'0' && c <ğ'9'è
num
 |= (c - '0') << 0;

904 ià(
c
 >ğ'a' && c <ğ'f'è
num
 |= (c - 'a') << 0;

905 ià(
c
 >ğ'A' && c <ğ'F'è
num
 |= (c - 'A') << 0;

906  
num
;

907 
	}
}

909 
	$g‘_quÙedch¬
(
šput_t
 *
šput
)

911 
c
;

912 
c
 = 
	`g‘_ch¬
(
šput
);

913 
c
) {

927  
	`g‘_hexach¬
(
šput
);

931 
num
 = 
c
 - '0';

932 
i
 = 1;

934 
c
 = 
	`g‘_ch¬
(
šput
);

935 ià(
c
 < '0' || c > '7') {

936 
	`ung‘_ch¬
(
c
, 
šput
);

939 
num
 =‚um * 8 + 
c
 - '0';

940 
i
++;

941 } 
i
 < 3);

942  
num
;

945  
c
;

947 
	}
}

949 
	#LOCAL_STR_BUFSIZE
 64

	)

950 
	sloÿl_¡ršg
 {

951 *
	mbuf
;

952 
size_t
 
	m®loc
;

953 
size_t
 
	midx
;

954 
	mtmpbuf
[
LOCAL_STR_BUFSIZE
];

957 
	$š™_loÿl_¡ršg
(
loÿl_¡ršg
 *
s
)

959 
	`mem£t
(
s
, 0, (*s));

960 
s
->
buf
 = s->
tmpbuf
;

961 
s
->
®loc
 = 
LOCAL_STR_BUFSIZE
;

962 
	}
}

964 
	$ä“_loÿl_¡ršg
(
loÿl_¡ršg
 *
s
)

966 ià(
s
->
buf
 !ğs->
tmpbuf
)

967 
	`ä“
(
s
->
buf
);

968 
	}
}

970 
	$add_ch¬_loÿl_¡ršg
(
loÿl_¡ršg
 *
s
, 
c
)

972 ià(
s
->
idx
 >ğs->
®loc
) {

973 
size_t
 
ÇÎoc
 = 
s
->
®loc
 * 2;

974 ià(
s
->
buf
 =ğs->
tmpbuf
) {

975 
s
->
buf
 = 
	`m®loc
(
ÇÎoc
);

976 ià(
s
->
buf
 =ğ
NULL
)

977  -
ENOMEM
;

978 
	`memıy
(
s
->
buf
, s->
tmpbuf
, s->
®loc
);

980 *
±r
 = 
	`»®loc
(
s
->
buf
, 
ÇÎoc
);

981 ià(
±r
 =ğ
NULL
)

982  -
ENOMEM
;

983 
s
->
buf
 = 
±r
;

985 
s
->
®loc
 = 
ÇÎoc
;

987 
s
->
buf
[s->
idx
++] = 
c
;

989 
	}
}

991 *
	$cİy_loÿl_¡ršg
(
loÿl_¡ršg
 *
s
)

993 *
d¡
 = 
	`m®loc
(
s
->
idx
 + 1);

994 ià(
d¡
) {

995 
	`memıy
(
d¡
, 
s
->
buf
, s->
idx
);

996 
d¡
[
s
->
idx
] = '\0';

998  
d¡
;

999 
	}
}

1001 
	$g‘_ä“¡ršg
(**
¡ršg
, 
id
, 
šput_t
 *
šput
)

1003 
loÿl_¡ršg
 
¡r
;

1004 
c
;

1006 
	`š™_loÿl_¡ršg
(&
¡r
);

1008 
c
 = 
	`g‘_ch¬
(
šput
);

1009 ià(
c
 < 0) {

1010 ià(
c
 =ğ
LOCAL_UNEXPECTED_EOF
) {

1011 *
¡ršg
 = 
	`cİy_loÿl_¡ršg
(&
¡r
);

1012 ià(! *
¡ršg
)

1013 
c
 = -
ENOMEM
;

1015 
c
 = 0;

1019 
c
) {

1021 ià(!
id
)

1040 *
¡ršg
 = 
	`cİy_loÿl_¡ršg
(&
¡r
);

1041 ià(! *
¡ršg
)

1042 
c
 = -
ENOMEM
;

1044 
	`ung‘_ch¬
(
c
, 
šput
);

1045 
c
 = 0;

1047 
_out
;

1051 ià(
	`add_ch¬_loÿl_¡ršg
(&
¡r
, 
c
) < 0) {

1052 
c
 = -
ENOMEM
;

1056 
_out
:

1057 
	`ä“_loÿl_¡ršg
(&
¡r
);

1058  
c
;

1059 
	}
}

1061 
	$g‘_d–im¡ršg
(**
¡ršg
, 
d–im
, 
šput_t
 *
šput
)

1063 
loÿl_¡ršg
 
¡r
;

1064 
c
;

1066 
	`š™_loÿl_¡ršg
(&
¡r
);

1068 
c
 = 
	`g‘_ch¬
(
šput
);

1069 ià(
c
 < 0)

1071 ià(
c
 == '\\') {

1072 
c
 = 
	`g‘_quÙedch¬
(
šput
);

1073 ià(
c
 < 0)

1075 ià(
c
 == '\n')

1077 } ià(
c
 =ğ
d–im
) {

1078 *
¡ršg
 = 
	`cİy_loÿl_¡ršg
(&
¡r
);

1079 ià(! *
¡ršg
)

1080 
c
 = -
ENOMEM
;

1082 
c
 = 0;

1085 ià(
	`add_ch¬_loÿl_¡ršg
(&
¡r
, 
c
) < 0) {

1086 
c
 = -
ENOMEM
;

1090 
	`ä“_loÿl_¡ršg
(&
¡r
);

1091  
c
;

1092 
	}
}

1095 
	$g‘_¡ršg
(**
¡ršg
, 
id
, 
šput_t
 *
šput
)

1097 
c
 = 
	`g‘_nÚwh™e
(
šput
), 
”r
;

1098 ià(
c
 < 0)

1099  
c
;

1100 
c
) {

1110  
LOCAL_UNEXPECTED_CHAR
;

1113 
”r
 = 
	`g‘_d–im¡ršg
(
¡ršg
, 
c
, 
šput
);

1114 ià(
”r
 < 0)

1115  
”r
;

1118 
	`ung‘_ch¬
(
c
, 
šput
);

1119 
”r
 = 
	`g‘_ä“¡ršg
(
¡ršg
, 
id
, 
šput
);

1120 ià(
”r
 < 0)

1121  
”r
;

1124 
	}
}

1126 
	$_¢d_cÚfig_make
(
¢d_cÚfig_t
 **
cÚfig
, **
id
, 
¢d_cÚfig_ty³_t
 
ty³
)

1128 
¢d_cÚfig_t
 *
n
;

1129 
	`as£¹
(
cÚfig
);

1130 
n
 = 
	`ÿÎoc
(1, (*n));

1131 ià(
n
 =ğ
NULL
) {

1132 ià(*
id
) {

1133 
	`ä“
(*
id
);

1134 *
id
 = 
NULL
;

1136  -
ENOMEM
;

1138 ià(
id
) {

1139 
n
->
id
 = *id;

1140 *
id
 = 
NULL
;

1142 
n
->
ty³
 =ype;

1143 ià(
ty³
 =ğ
SND_CONFIG_TYPE_COMPOUND
)

1144 
	`INIT_LIST_HEAD
(&
n
->
u
.
compound
.
f›lds
);

1145 *
cÚfig
 = 
n
;

1147 
	}
}

1150 
	$_¢d_cÚfig_make_add
(
¢d_cÚfig_t
 **
cÚfig
, **
id
,

1151 
¢d_cÚfig_ty³_t
 
ty³
, 
¢d_cÚfig_t
 *
·»Á
)

1153 
¢d_cÚfig_t
 *
n
;

1154 
”r
;

1155 
	`as£¹
(
·»Á
->
ty³
 =ğ
SND_CONFIG_TYPE_COMPOUND
);

1156 
”r
 = 
	`_¢d_cÚfig_make
(&
n
, 
id
, 
ty³
);

1157 ià(
”r
 < 0)

1158  
”r
;

1159 
n
->
·»Á
 =…arent;

1160 
	`li¡_add_
(&
n
->
li¡
, &
·»Á
->
u
.
compound
.
f›lds
);

1161 *
cÚfig
 = 
n
;

1163 
	}
}

1165 
	$_¢d_cÚfig_£¬ch
(
¢d_cÚfig_t
 *
cÚfig
,

1166 cÚ¡ *
id
, 
Ën
, 
¢d_cÚfig_t
 **
»suÉ
)

1168 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1169 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚfig
) {

1170 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1171 ià(
Ën
 < 0) {

1172 ià(
	`¡rcmp
(
n
->
id
, id) != 0)

1174 } ià(
	`¡¾’
(
n
->
id
è!ğ(
size_t
è
Ën
 ||

1175 
	`memcmp
(
n
->
id
, id, (
size_t
è
Ën
) != 0)

1177 ià(
»suÉ
)

1178 *
»suÉ
 = 
n
;

1181  -
ENOENT
;

1182 
	}
}

1184 
	$·r£_v®ue
(
¢d_cÚfig_t
 **
_n
, snd_cÚfig_ˆ*
·»Á
, 
šput_t
 *
šput
, **
id
, 
sk
)

1186 
¢d_cÚfig_t
 *
n
 = *
_n
;

1187 *
s
;

1188 
”r
;

1190 
”r
 = 
	`g‘_¡ršg
(&
s
, 0, 
šput
);

1191 ià(
”r
 < 0)

1192  
”r
;

1193 ià(
sk
) {

1194 
	`ä“
(
s
);

1197 ià(
”r
 =ğ0 && ((
s
[0] >= '0' && s[0] <= '9') || s[0] == '-')) {

1198 
i
;

1199 
”ºo
 = 0;

1200 
”r
 = 
	`§ã_¡¹Şl
(
s
, &
i
);

1201 ià(
”r
 < 0) {

1202 
r
;

1203 
”r
 = 
	`§ã_¡¹od
(
s
, &
r
);

1204 ià(
”r
 >= 0) {

1205 
	`ä“
(
s
);

1206 ià(
n
) {

1207 ià(
n
->
ty³
 !ğ
SND_CONFIG_TYPE_REAL
) {

1208 
	`SNDERR
("% i nÙ‡„—l", *
id
);

1209  -
EINVAL
;

1212 
”r
 = 
	`_¢d_cÚfig_make_add
(&
n
, 
id
, 
SND_CONFIG_TYPE_REAL
, 
·»Á
);

1213 ià(
”r
 < 0)

1214  
”r
;

1216 
n
->
u
.
»®
 = 
r
;

1217 *
_n
 = 
n
;

1221 
	`ä“
(
s
);

1222 ià(
n
) {

1223 ià(
n
->
ty³
 !ğ
SND_CONFIG_TYPE_INTEGER
 &&‚->ty³ !ğ
SND_CONFIG_TYPE_INTEGER64
) {

1224 
	`SNDERR
("% i nÙ‡Àš‹g”", *
id
);

1225  -
EINVAL
;

1228 ià(
i
 <ğ
INT_MAX
)

1229 
”r
 = 
	`_¢d_cÚfig_make_add
(&
n
, 
id
, 
SND_CONFIG_TYPE_INTEGER
, 
·»Á
);

1231 
”r
 = 
	`_¢d_cÚfig_make_add
(&
n
, 
id
, 
SND_CONFIG_TYPE_INTEGER64
, 
·»Á
);

1232 ià(
”r
 < 0)

1233  
”r
;

1235 ià(
n
->
ty³
 =ğ
SND_CONFIG_TYPE_INTEGER
)

1236 
n
->
u
.
š‹g”
 = (è
i
;

1238 
n
->
u
.
š‹g”64
 = 
i
;

1239 *
_n
 = 
n
;

1243 ià(
n
) {

1244 ià(
n
->
ty³
 !ğ
SND_CONFIG_TYPE_STRING
) {

1245 
	`SNDERR
("% i nÙ‡ sŒšg", *
id
);

1246 
	`ä“
(
s
);

1247  -
EINVAL
;

1250 
”r
 = 
	`_¢d_cÚfig_make_add
(&
n
, 
id
, 
SND_CONFIG_TYPE_STRING
, 
·»Á
);

1251 ià(
”r
 < 0)

1252  
”r
;

1254 
	`ä“
(
n
->
u
.
¡ršg
);

1255 
n
->
u
.
¡ršg
 = 
s
;

1256 *
_n
 = 
n
;

1258 
	}
}

1260 
·r£_defs
(
¢d_cÚfig_t
 *
·»Á
, 
šput_t
 *
šput
, 
sk
, 
ov”ride
);

1261 
·r£_¬¿y_defs
(
¢d_cÚfig_t
 *
ç¹h”
, 
šput_t
 *
šput
, 
sk
, 
ov”ride
);

1263 
	$·r£_¬¿y_def
(
¢d_cÚfig_t
 *
·»Á
, 
šput_t
 *
šput
, *
idx
, 
sk
, 
ov”ride
)

1265 *
id
 = 
NULL
;

1266 
c
;

1267 
”r
;

1268 
¢d_cÚfig_t
 *
n
 = 
NULL
;

1270 ià(!
sk
) {

1271 
¢d_cÚfig_t
 *
g
;

1272 
¡©ic_id
[12];

1274 
	`¢´štf
(
¡©ic_id
, (¡©ic_id), "%i", *
idx
);

1275 ià(
	`_¢d_cÚfig_£¬ch
(
·»Á
, 
¡©ic_id
, -1, &
g
) == 0) {

1276 ià(
ov”ride
) {

1277 
	`¢d_cÚfig_d–‘e
(
n
);

1280 (*
idx
)++;

1286 
id
 = 
	`¡rdup
(
¡©ic_id
);

1287 ià(
id
 =ğ
NULL
)

1288  -
ENOMEM
;

1290 
c
 = 
	`g‘_nÚwh™e
(
šput
);

1291 ià(
c
 < 0) {

1292 
”r
 = 
c
;

1293 
__’d
;

1295 
c
) {

1299 
’dchr
;

1300 ià(!
sk
) {

1301 ià(
n
) {

1302 ià(
n
->
ty³
 !ğ
SND_CONFIG_TYPE_COMPOUND
) {

1303 
	`SNDERR
("% i nÙ‡ compound", 
id
);

1304 
”r
 = -
EINVAL
;

1305 
__’d
;

1308 
”r
 = 
	`_¢d_cÚfig_make_add
(&
n
, &
id
, 
SND_CONFIG_TYPE_COMPOUND
, 
·»Á
);

1309 ià(
”r
 < 0)

1310 
__’d
;

1313 ià(
c
 == '{') {

1314 
”r
 = 
	`·r£_defs
(
n
, 
šput
, 
sk
, 
ov”ride
);

1315 
’dchr
 = '}';

1317 
”r
 = 
	`·r£_¬¿y_defs
(
n
, 
šput
, 
sk
, 
ov”ride
);

1318 
’dchr
 = ']';

1320 
c
 = 
	`g‘_nÚwh™e
(
šput
);

1321 ià(
c
 < 0) {

1322 
”r
 = 
c
;

1323 
__’d
;

1325 ià(
c
 !ğ
’dchr
) {

1326 ià(
n
)

1327 
	`¢d_cÚfig_d–‘e
(
n
);

1328 
”r
 = 
LOCAL_UNEXPECTED_CHAR
;

1329 
__’d
;

1334 
	`ung‘_ch¬
(
c
, 
šput
);

1335 
”r
 = 
	`·r£_v®ue
(&
n
, 
·»Á
, 
šput
, &
id
, 
sk
);

1336 ià(
”r
 < 0)

1337 
__’d
;

1340 
”r
 = 0;

1341 
__’d
:

1342 
	`ä“
(
id
);

1343  
”r
;

1344 
	}
}

1346 
	$·r£_¬¿y_defs
(
¢d_cÚfig_t
 *
·»Á
, 
šput_t
 *
šput
, 
sk
, 
ov”ride
)

1348 
idx
 = 0;

1350 
c
 = 
	`g‘_nÚwh™e
(
šput
), 
”r
;

1351 ià(
c
 < 0)

1352  
c
;

1353 
	`ung‘_ch¬
(
c
, 
šput
);

1354 ià(
c
 == ']')

1356 
”r
 = 
	`·r£_¬¿y_def
(
·»Á
, 
šput
, &
idx
, 
sk
, 
ov”ride
);

1357 ià(
”r
 < 0)

1358  
”r
;

1359 
idx
++;

1362 
	}
}

1364 
	$·r£_def
(
¢d_cÚfig_t
 *
·»Á
, 
šput_t
 *
šput
, 
sk
, 
ov”ride
)

1366 *
id
 = 
NULL
;

1367 
c
;

1368 
”r
;

1369 
¢d_cÚfig_t
 *
n
;

1370 ’um {
MERGE_CREATE
, 
MERGE
, 
OVERRIDE
, 
DONT_OVERRIDE
} 
mode
;

1372 
c
 = 
	`g‘_nÚwh™e
(
šput
);

1373 ià(
c
 < 0)

1374  
c
;

1375 
c
) {

1377 
mode
 = 
MERGE_CREATE
;

1380 
mode
 = 
MERGE
;

1383 
mode
 = 
DONT_OVERRIDE
;

1386 
mode
 = 
OVERRIDE
;

1389 
mode
 = !
ov”ride
 ? 
MERGE_CREATE
 : 
OVERRIDE
;

1390 
	`ung‘_ch¬
(
c
, 
šput
);

1392 
”r
 = 
	`g‘_¡ršg
(&
id
, 1, 
šput
);

1393 ià(
”r
 < 0)

1394  
”r
;

1395 
c
 = 
	`g‘_nÚwh™e
(
šput
);

1396 ià(
c
 != '.')

1398 ià(
sk
) {

1399 
	`ä“
(
id
);

1402 ià(
	`_¢d_cÚfig_£¬ch
(
·»Á
, 
id
, -1, &
n
) == 0) {

1403 ià(
mode
 =ğ
DONT_OVERRIDE
) {

1404 
sk
 = 1;

1405 
	`ä“
(
id
);

1408 ià(
mode
 !ğ
OVERRIDE
) {

1409 ià(
n
->
ty³
 !ğ
SND_CONFIG_TYPE_COMPOUND
) {

1410 
	`SNDERR
("% i nÙ‡ compound", 
id
);

1411  -
EINVAL
;

1413 
n
->
u
.
compound
.
još
 = 
Œue
;

1414 
·»Á
 = 
n
;

1415 
	`ä“
(
id
);

1418 
	`¢d_cÚfig_d–‘e
(
n
);

1420 ià(
mode
 =ğ
MERGE
) {

1421 
	`SNDERR
("% dÛ nÙƒxi¡s", 
id
);

1422 
”r
 = -
ENOENT
;

1423 
__’d
;

1425 
”r
 = 
	`_¢d_cÚfig_make_add
(&
n
, &
id
, 
SND_CONFIG_TYPE_COMPOUND
, 
·»Á
);

1426 ià(
”r
 < 0)

1427 
__’d
;

1428 
n
->
u
.
compound
.
još
 = 
Œue
;

1429 
·»Á
 = 
n
;

1431 ià(
c
 == '=') {

1432 
c
 = 
	`g‘_nÚwh™e
(
šput
);

1433 ià(
c
 < 0)

1434  
c
;

1436 ià(!
sk
) {

1437 ià(
	`_¢d_cÚfig_£¬ch
(
·»Á
, 
id
, -1, &
n
) == 0) {

1438 ià(
mode
 =ğ
DONT_OVERRIDE
) {

1439 
sk
 = 1;

1440 
n
 = 
NULL
;

1441 } ià(
mode
 =ğ
OVERRIDE
) {

1442 
	`¢d_cÚfig_d–‘e
(
n
);

1443 
n
 = 
NULL
;

1446 
n
 = 
NULL
;

1447 ià(
mode
 =ğ
MERGE
) {

1448 
	`SNDERR
("% dÛ nÙƒxi¡s", 
id
);

1449 
”r
 = -
ENOENT
;

1450 
__’d
;

1454 
c
) {

1458 
’dchr
;

1459 ià(!
sk
) {

1460 ià(
n
) {

1461 ià(
n
->
ty³
 !ğ
SND_CONFIG_TYPE_COMPOUND
) {

1462 
	`SNDERR
("% i nÙ‡ compound", 
id
);

1463 
”r
 = -
EINVAL
;

1464 
__’d
;

1467 
”r
 = 
	`_¢d_cÚfig_make_add
(&
n
, &
id
, 
SND_CONFIG_TYPE_COMPOUND
, 
·»Á
);

1468 ià(
”r
 < 0)

1469 
__’d
;

1472 ià(
c
 == '{') {

1473 
”r
 = 
	`·r£_defs
(
n
, 
šput
, 
sk
, 
ov”ride
);

1474 
’dchr
 = '}';

1476 
”r
 = 
	`·r£_¬¿y_defs
(
n
, 
šput
, 
sk
, 
ov”ride
);

1477 
’dchr
 = ']';

1479 
c
 = 
	`g‘_nÚwh™e
(
šput
);

1480 ià(
c
 !ğ
’dchr
) {

1481 ià(
n
)

1482 
	`¢d_cÚfig_d–‘e
(
n
);

1483 
”r
 = 
LOCAL_UNEXPECTED_CHAR
;

1484 
__’d
;

1489 
	`ung‘_ch¬
(
c
, 
šput
);

1490 
”r
 = 
	`·r£_v®ue
(&
n
, 
·»Á
, 
šput
, &
id
, 
sk
);

1491 ià(
”r
 < 0)

1492 
__’d
;

1495 
c
 = 
	`g‘_nÚwh™e
(
šput
);

1496 
c
) {

1501 
	`ung‘_ch¬
(
c
, 
šput
);

1503 
__’d
:

1504 
	`ä“
(
id
);

1505  
”r
;

1506 
	}
}

1508 
	$·r£_defs
(
¢d_cÚfig_t
 *
·»Á
, 
šput_t
 *
šput
, 
sk
, 
ov”ride
)

1510 
c
, 
”r
;

1512 
c
 = 
	`g‘_nÚwh™e
(
šput
);

1513 ià(
c
 < 0)

1514  
c
 =ğ
LOCAL_UNEXPECTED_EOF
 ? 0 : c;

1515 
	`ung‘_ch¬
(
c
, 
šput
);

1516 ià(
c
 == '}')

1518 
”r
 = 
	`·r£_def
(
·»Á
, 
šput
, 
sk
, 
ov”ride
);

1519 ià(
”r
 < 0)

1520  
”r
;

1523 
	}
}

1525 
	$¡ršg_´št
(*
¡r
, 
id
, 
¢d_ouut_t
 *
out
)

1527 
q
;

1528 *
p
 = (*)
¡r
;

1529 ià(!
p
 || !*p) {

1530 
	`¢d_ouut_puts
(
out
, "''");

1533 ià(!
id
) {

1534 *
p
) {

1538 
quÙed
;

1541 
loİ
:

1542 *
p
) {

1544 
nÚquÙed
;

1558 
quÙed
;

1560 ià(*
p
 <= 31 || *p >= 127)

1561 
quÙed
;

1562 
p
++;

1563 
loİ
;

1565 
nÚquÙed
:

1566 
	`¢d_ouut_puts
(
out
, 
¡r
);

1568 
quÙed
:

1569 
q
 = 
	`¡rchr
(
¡r
, '\'') ? '"' : '\'';

1570 
	`¢d_ouut_putc
(
out
, 
q
);

1571 
p
 = (*)
¡r
;

1572 *
p
) {

1573 
c
;

1574 
c
 = *
p
;

1575 
c
) {

1577 
	`¢d_ouut_putc
(
out
, '\\');

1578 
	`¢d_ouut_putc
(
out
, 'n');

1581 
	`¢d_ouut_putc
(
out
, '\\');

1582 
	`¢d_ouut_putc
(
out
, 't');

1585 
	`¢d_ouut_putc
(
out
, '\\');

1586 
	`¢d_ouut_putc
(
out
, 'v');

1589 
	`¢d_ouut_putc
(
out
, '\\');

1590 
	`¢d_ouut_putc
(
out
, 'b');

1593 
	`¢d_ouut_putc
(
out
, '\\');

1594 
	`¢d_ouut_putc
(
out
, 'r');

1597 
	`¢d_ouut_putc
(
out
, '\\');

1598 
	`¢d_ouut_putc
(
out
, 'f');

1601 ià(
c
 =ğ
q
) {

1602 
	`¢d_ouut_putc
(
out
, '\\');

1603 
	`¢d_ouut_putc
(
out
, 
c
);

1605 ià(
c
 >= 32 && c <= 126)

1606 
	`¢d_ouut_putc
(
out
, 
c
);

1608 
	`¢d_ouut_´štf
(
out
, "\\%04o", 
c
);

1612 
p
++;

1614 
	`¢d_ouut_putc
(
out
, 
q
);

1615 
	}
}

1617 
	$Ëv–_´št
(
¢d_ouut_t
 *
out
, 
Ëv–
)

1619 
a
[
Ëv–
 + 1];

1620 
	`mem£t
(
a
, '\t', 
Ëv–
);

1621 
a
[
Ëv–
] = '\0';

1622 
	`¢d_ouut_puts
(
out
, 
a
);

1623 
	}
}

1625 
_¢d_cÚfig_§ve_chd»n
(
¢d_cÚfig_t
 *
cÚfig
, 
¢d_ouut_t
 *
out
,

1626 
Ëv–
, 
jošs
,

1627 
¬¿y
);

1629 
	$_¢d_cÚfig_§ve_node_v®ue
(
¢d_cÚfig_t
 *
n
, 
¢d_ouut_t
 *
out
,

1630 
Ëv–
)

1632 
”r
, 
¬¿y
;

1633 
n
->
ty³
) {

1634 
SND_CONFIG_TYPE_INTEGER
:

1635 
	`¢d_ouut_´štf
(
out
, "%ld", 
n
->
u
.
š‹g”
);

1637 
SND_CONFIG_TYPE_INTEGER64
:

1638 
	`¢d_ouut_´štf
(
out
, "%Îd", 
n
->
u
.
š‹g”64
);

1640 
SND_CONFIG_TYPE_REAL
:

1641 
	`¢d_ouut_´štf
(
out
, "%-16g", 
n
->
u
.
»®
);

1643 
SND_CONFIG_TYPE_STRING
:

1644 
	`¡ršg_´št
(
n
->
u
.
¡ršg
, 0, 
out
);

1646 
SND_CONFIG_TYPE_POINTER
:

1647 
	`SNDERR
("cannot save„untime…ointerype");

1648  -
EINVAL
;

1649 
SND_CONFIG_TYPE_COMPOUND
:

1650 
¬¿y
 = 
	`¢d_cÚfig_is_¬¿y
(
n
);

1651 
	`¢d_ouut_putc
(
out
, 
¬¿y
 ? '[' : '{');

1652 
	`¢d_ouut_putc
(
out
, '\n');

1653 
”r
 = 
	`_¢d_cÚfig_§ve_chd»n
(
n
, 
out
, 
Ëv–
 + 1, 0, 
¬¿y
);

1654 ià(
”r
 < 0)

1655  
”r
;

1656 
	`Ëv–_´št
(
out
, 
Ëv–
);

1657 
	`¢d_ouut_putc
(
out
, 
¬¿y
 ? ']' : '}');

1661 
	}
}

1663 
	$id_´št
(
¢d_cÚfig_t
 *
n
, 
¢d_ouut_t
 *
out
, 
jošs
)

1665 ià(
jošs
 > 0) {

1666 
	`as£¹
(
n
->
·»Á
);

1667 
	`id_´št
(
n
->
·»Á
, 
out
, 
jošs
 - 1);

1668 
	`¢d_ouut_putc
(
out
, '.');

1670 
	`¡ršg_´št
(
n
->
id
, 1, 
out
);

1671 
	}
}

1673 
	$_¢d_cÚfig_§ve_chd»n
(
¢d_cÚfig_t
 *
cÚfig
, 
¢d_ouut_t
 *
out
,

1674 
Ëv–
, 
jošs
,

1675 
¬¿y
)

1677 
”r
;

1678 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1679 
	`as£¹
(
cÚfig
 && 
out
);

1680 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚfig
) {

1681 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1682 ià(
n
->
ty³
 =ğ
SND_CONFIG_TYPE_COMPOUND
 &&

1683 
n
->
u
.
compound
.
još
) {

1684 
”r
 = 
	`_¢d_cÚfig_§ve_chd»n
(
n
, 
out
, 
Ëv–
, 
jošs
 + 1, 0);

1685 ià(
”r
 < 0)

1686  
”r
;

1689 
	`Ëv–_´št
(
out
, 
Ëv–
);

1690 ià(!
¬¿y
) {

1691 
	`id_´št
(
n
, 
out
, 
jošs
);

1692 
	`¢d_ouut_putc
(
out
, ' ');

1694 
	`¢d_ouut_putc
(
out
, '=');

1697 
”r
 = 
	`_¢d_cÚfig_§ve_node_v®ue
(
n
, 
out
, 
Ëv–
);

1698 ià(
”r
 < 0)

1699  
”r
;

1701 
	`¢d_ouut_putc
(
out
, ';');

1703 
	`¢d_ouut_putc
(
out
, '\n');

1706 
	}
}

1730 
	$¢d_cÚfig_sub¡™u‹
(
¢d_cÚfig_t
 *
d¡
, snd_cÚfig_ˆ*
¤c
)

1732 
	`as£¹
(
d¡
 && 
¤c
);

1733 ià(
d¡
->
ty³
 =ğ
SND_CONFIG_TYPE_COMPOUND
) {

1734 
”r
 = 
	`¢d_cÚfig_d–‘e_compound_memb”s
(
d¡
);

1735 ià(
”r
 < 0)

1736  
”r
;

1738 ià(
d¡
->
ty³
 =ğ
SND_CONFIG_TYPE_COMPOUND
 &&

1739 
¤c
->
ty³
 =ğ
SND_CONFIG_TYPE_COMPOUND
) {

1740 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1741 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
¤c
) {

1742 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1743 
n
->
·»Á
 = 
d¡
;

1745 
¤c
->
u
.
compound
.
f›lds
.
Ãxt
->
´ev
 = &
d¡
->u.compound.fields;

1746 
¤c
->
u
.
compound
.
f›lds
.
´ev
->
Ãxt
 = &
d¡
->u.compound.fields;

1748 
	`ä“
(
d¡
->
id
);

1749 ià(
d¡
->
ty³
 =ğ
SND_CONFIG_TYPE_STRING
)

1750 
	`ä“
(
d¡
->
u
.
¡ršg
);

1751 
d¡
->
id
 = 
¤c
->id;

1752 
d¡
->
ty³
 = 
¤c
->type;

1753 
d¡
->
u
 = 
¤c
->u;

1754 
	`ä“
(
¤c
);

1756 
	}
}

1778 
	$¢d_cÚfig_g‘_ty³_ascii
(cÚ¡ *
ascii
, 
¢d_cÚfig_ty³_t
 *
ty³
)

1780 
	`as£¹
(
ascii
 && 
ty³
);

1781 ià(!
	`¡rcmp
(
ascii
, "integer")) {

1782 *
ty³
 = 
SND_CONFIG_TYPE_INTEGER
;

1785 ià(!
	`¡rcmp
(
ascii
, "integer64")) {

1786 *
ty³
 = 
SND_CONFIG_TYPE_INTEGER64
;

1789 ià(!
	`¡rcmp
(
ascii
, "real")) {

1790 *
ty³
 = 
SND_CONFIG_TYPE_REAL
;

1793 ià(!
	`¡rcmp
(
ascii
, "string")) {

1794 *
ty³
 = 
SND_CONFIG_TYPE_STRING
;

1797 ià(!
	`¡rcmp
(
ascii
, "compound")) {

1798 *
ty³
 = 
SND_CONFIG_TYPE_COMPOUND
;

1801  -
EINVAL
;

1802 
	}
}

1812 
¢d_cÚfig_ty³_t
 
	$¢d_cÚfig_g‘_ty³
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
)

1814  
cÚfig
->
ty³
;

1815 
	}
}

1817 
	$check_¬¿y_™em
(cÚ¡ *
id
, 
šdex
)

1819 cÚ¡ *
p
;

1820 
v®
;

1822 
p
 = 
id
; *p;…++) {

1823 ià(*
p
 < '0' || *p > '9')

1827 ià(
	`§ã_¡¹Ş
(
id
, &
v®
))

1829  
v®
 =ğ
šdex
;

1830 
	}
}

1838 
	$¢d_cÚfig_is_¬¿y
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
)

1840 
idx
;

1841 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1842 
¢d_cÚfig_t
 *
node
;

1844 
	`as£¹
(
cÚfig
);

1845 ià(
cÚfig
->
ty³
 !ğ
SND_CONFIG_TYPE_COMPOUND
)

1846  -
EINVAL
;

1847 
idx
 = 0;

1848 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚfig
) {

1849 
node
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1850 ià(!
	`check_¬¿y_™em
(
node
->
id
, 
idx
))

1852 
idx
++;

1854  
idx
;

1855 
	}
}

1862 
	$¢d_cÚfig_is_em±y
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
)

1864 
	`as£¹
(
cÚfig
);

1865 ià(
cÚfig
->
ty³
 !ğ
SND_CONFIG_TYPE_COMPOUND
)

1866  -
EINVAL
;

1867  
	`li¡_em±y
(&
cÚfig
->
u
.
compound
.
f›lds
);

1868 
	}
}

1886 
	$¢d_cÚfig_g‘_id
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ **
id
)

1888 
	`as£¹
(
cÚfig
 && 
id
);

1889 *
id
 = 
cÚfig
->id;

1891 
	}
}

1908 
	$¢d_cÚfig_£t_id
(
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ *
id
)

1910 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1911 *
Ãw_id
;

1912 
	`as£¹
(
cÚfig
);

1913 ià(
id
) {

1914 ià(
cÚfig
->
·»Á
) {

1915 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚfig
->
·»Á
) {

1916 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1917 ià(
n
 !ğ
cÚfig
 && 
	`¡rcmp
(
id
,‚->id) == 0)

1918  -
EEXIST
;

1921 
Ãw_id
 = 
	`¡rdup
(
id
);

1922 ià(!
Ãw_id
)

1923  -
ENOMEM
;

1925 ià(
cÚfig
->
·»Á
)

1926  -
EINVAL
;

1927 
Ãw_id
 = 
NULL
;

1929 
	`ä“
(
cÚfig
->
id
);

1930 
cÚfig
->
id
 = 
Ãw_id
;

1932 
	}
}

1950 
	$¢d_cÚfig_tİ
(
¢d_cÚfig_t
 **
cÚfig
)

1952 
	`as£¹
(
cÚfig
);

1953  
	`_¢d_cÚfig_make
(
cÚfig
, 0, 
SND_CONFIG_TYPE_COMPOUND
);

1954 
	}
}

1956 #iâdeà
DOC_HIDDEN


1957 
	$_¢d_cÚfig_lßd_w™h_šşude
(
¢d_cÚfig_t
 *
cÚfig
, 
¢d_šput_t
 *
š
,

1958 
ov”ride
, cÚ¡ * cÚ¡ *
šşude_·ths
)

1960 
”r
;

1961 
šput_t
 
šput
;

1962 
fedesc
 *
fd
, *
fd_Ãxt
;

1964 
	`as£¹
(
cÚfig
 && 
š
);

1965 
fd
 = 
	`m®loc
((*fd));

1966 ià(!
fd
)

1967  -
ENOMEM
;

1968 
fd
->
Çme
 = 
NULL
;

1969 
fd
->
š
 = in;

1970 
fd
->
lše
 = 1;

1971 
fd
->
cŞumn
 = 0;

1972 
fd
->
Ãxt
 = 
NULL
;

1973 
	`INIT_LIST_HEAD
(&
fd
->
šşude_·ths
);

1974 ià(
šşude_·ths
) {

1975 ; *
šşude_·ths
; include_paths++) {

1976 
”r
 = 
	`add_šşude_·th
(
fd
, *
šşude_·ths
);

1977 ià(
”r
 < 0)

1978 
_’d
;

1981 
”r
 = 
	`add_šşude_·th
(
fd
, 
	`¢d_cÚfig_tİdœ
());

1982 ià(
”r
 < 0)

1983 
_’d
;

1985 
šput
.
cu¼’t
 = 
fd
;

1986 
šput
.
ung‘
 = 0;

1987 
”r
 = 
	`·r£_defs
(
cÚfig
, &
šput
, 0, 
ov”ride
);

1988 
fd
 = 
šput
.
cu¼’t
;

1989 ià(
”r
 < 0) {

1990 cÚ¡ *
¡r
;

1991 
”r
) {

1992 
LOCAL_UNTERMINATED_STRING
:

1993 
¡r
 = "Unterminated string";

1994 
”r
 = -
EINVAL
;

1996 
LOCAL_UNTERMINATED_QUOTE
:

1997 
¡r
 = "Unterminated quote";

1998 
”r
 = -
EINVAL
;

2000 
LOCAL_UNEXPECTED_CHAR
:

2001 
¡r
 = "Unexpected char";

2002 
”r
 = -
EINVAL
;

2004 
LOCAL_UNEXPECTED_EOF
:

2005 
¡r
 = "Unexpectedƒnd of file";

2006 
”r
 = -
EINVAL
;

2009 
¡r
 = 
	`¡»¼Ü
(-
”r
);

2012 
	`SNDERR
("%s:%d:%d:%s", 
fd
->
Çme
 ? fd->Çm: "_tİËv–_", fd->
lše
, fd->
cŞumn
, 
¡r
);

2013 
_’d
;

2015 
”r
 = 
	`g‘_ch¬
(&
šput
);

2016 
fd
 = 
šput
.
cu¼’t
;

2017 ià(
”r
 !ğ
LOCAL_UNEXPECTED_EOF
) {

2018 
	`SNDERR
("%s:%d:%d:UÃx³ùed }", 
fd
->
Çme
 ? fd->Çm: "", fd->
lše
, fd->
cŞumn
);

2019 
”r
 = -
EINVAL
;

2020 
_’d
;

2022 
”r
 = 0;

2023 
_’d
:

2024 
fd
->
Ãxt
) {

2025 
fd_Ãxt
 = 
fd
->
Ãxt
;

2026 
	`¢d_šput_şo£
(
fd
->
š
);

2027 
	`ä“
(
fd
->
Çme
);

2028 
	`ä“_šşude_·ths
(
fd
);

2029 
	`ä“
(
fd
);

2030 
fd
 = 
fd_Ãxt
;

2033 
	`ä“_šşude_·ths
(
fd
);

2034 
	`ä“
(
fd
);

2035  
”r
;

2036 
	}
}

2055 
	$¢d_cÚfig_lßd
(
¢d_cÚfig_t
 *
cÚfig
, 
¢d_šput_t
 *
š
)

2057  
	`_¢d_cÚfig_lßd_w™h_šşude
(
cÚfig
, 
š
, 0, 
NULL
);

2058 
	}
}

2076 
	$¢d_cÚfig_lßd_¡ršg
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
s
, 
size_t
 
size
)

2078 
¢d_šput_t
 *
šput
;

2079 
¢d_cÚfig_t
 *
d¡
;

2080 
”r
;

2082 
	`as£¹
(
cÚfig
 && 
s
);

2083 ià(
size
 == 0)

2084 
size
 = 
	`¡¾’
(
s
);

2085 
”r
 = 
	`¢d_šput_bufãr_İ’
(&
šput
, 
s
, 
size
);

2086 ià(
”r
 < 0)

2087  
”r
;

2088 
”r
 = 
	`¢d_cÚfig_tİ
(&
d¡
);

2089 ià(
”r
 < 0) {

2090 
	`¢d_šput_şo£
(
šput
);

2091  
”r
;

2093 
”r
 = 
	`¢d_cÚfig_lßd
(
d¡
, 
šput
);

2094 
	`¢d_šput_şo£
(
šput
);

2095 ià(
”r
 < 0) {

2096 
	`¢d_cÚfig_d–‘e
(
d¡
);

2097  
”r
;

2099 *
cÚfig
 = 
d¡
;

2101 
	}
}

2113 
	$¢d_cÚfig_lßd_ov”ride
(
¢d_cÚfig_t
 *
cÚfig
, 
¢d_šput_t
 *
š
)

2115  
	`_¢d_cÚfig_lßd_w™h_šşude
(
cÚfig
, 
š
, 1, 
NULL
);

2116 
	}
}

2142 
	$¢d_cÚfig_add
(
¢d_cÚfig_t
 *
·»Á
, snd_cÚfig_ˆ*
chd
)

2144 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

2145 
	`as£¹
(
·»Á
 && 
chd
);

2146 ià(!
chd
->
id
 || chd->
·»Á
)

2147  -
EINVAL
;

2148 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
·»Á
) {

2149 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

2150 ià(
	`¡rcmp
(
chd
->
id
, 
n
->id) == 0)

2151  -
EEXIST
;

2153 
chd
->
·»Á
 =…arent;

2154 
	`li¡_add_
(&
chd
->
li¡
, &
·»Á
->
u
.
compound
.
f›lds
);

2156 
	}
}

2180 
	$¢d_cÚfig_add_aá”
(
¢d_cÚfig_t
 *
aá”
, snd_cÚfig_ˆ*
chd
)

2182 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

2183 
¢d_cÚfig_t
 *
·»Á
;

2184 
	`as£¹
(
aá”
 && 
chd
);

2185 
·»Á
 = 
aá”
->parent;

2186 
	`as£¹
(
·»Á
);

2187 ià(!
chd
->
id
 || chd->
·»Á
)

2188  -
EINVAL
;

2189 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
·»Á
) {

2190 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

2191 ià(
	`¡rcmp
(
chd
->
id
, 
n
->id) == 0)

2192  -
EEXIST
;

2194 
chd
->
·»Á
 =…arent;

2195 
	`li¡_š£¹
(&
chd
->
li¡
, &
aá”
->li¡,‡á”->li¡.
Ãxt
);

2197 
	}
}

2221 
	$¢d_cÚfig_add_befÜe
(
¢d_cÚfig_t
 *
befÜe
, snd_cÚfig_ˆ*
chd
)

2223 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

2224 
¢d_cÚfig_t
 *
·»Á
;

2225 
	`as£¹
(
befÜe
 && 
chd
);

2226 
·»Á
 = 
befÜe
->parent;

2227 
	`as£¹
(
·»Á
);

2228 ià(!
chd
->
id
 || chd->
·»Á
)

2229  -
EINVAL
;

2230 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
·»Á
) {

2231 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

2232 ià(
	`¡rcmp
(
chd
->
id
, 
n
->id) == 0)

2233  -
EEXIST
;

2235 
chd
->
·»Á
 =…arent;

2236 
	`li¡_š£¹
(&
chd
->
li¡
, 
befÜe
->li¡.
´ev
, &before->list);

2238 
	}
}

2243 
	$_¢d_cÚfig_¬¿y_m”ge
(
¢d_cÚfig_t
 *
d¡
, snd_cÚfig_ˆ*
¤c
, 
šdex
)

2245 
¢d_cÚfig_™”©Ü_t
 
si
, 
¢ext
;

2246 
”r
;

2248 
	`¢d_cÚfig_fÜ_—ch
(
si
, 
¢ext
, 
¤c
) {

2249 
¢d_cÚfig_t
 *
¢
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
si
);

2250 
id
[16];

2251 
	`¢d_cÚfig_»move
(
¢
);

2252 
	`¢´štf
(
id
, (id), "%d", 
šdex
++);

2253 
”r
 = 
	`¢d_cÚfig_£t_id
(
¢
, 
id
);

2254 ià(
”r
 < 0) {

2255 
	`¢d_cÚfig_d–‘e
(
¢
);

2256  
”r
;

2258 
¢
->
·»Á
 = 
d¡
;

2259 
	`li¡_add_
(&
¢
->
li¡
, &
d¡
->
u
.
compound
.
f›lds
);

2261 
	`¢d_cÚfig_d–‘e
(
¤c
);

2263 
	}
}

2290 
	$¢d_cÚfig_m”ge
(
¢d_cÚfig_t
 *
d¡
, snd_cÚfig_ˆ*
¤c
, 
ov”ride
)

2292 
¢d_cÚfig_™”©Ü_t
 
di
, 
si
, 
dÃxt
, 
¢ext
;

2293 
boŞ
 
found
;

2294 
”r
, 
¬¿y
;

2296 
	`as£¹
(
d¡
);

2297 ià(
¤c
 =ğ
NULL
)

2299 ià(
d¡
->
ty³
 !ğ
SND_CONFIG_TYPE_COMPOUND
 || 
¤c
->type != SND_CONFIG_TYPE_COMPOUND)

2300  
	`¢d_cÚfig_sub¡™u‹
(
d¡
, 
¤c
);

2301 
¬¿y
 = 
	`¢d_cÚfig_is_¬¿y
(
d¡
);

2302 ià(
¬¿y
 && 
	`¢d_cÚfig_is_¬¿y
(
¤c
))

2303  
	`_¢d_cÚfig_¬¿y_m”ge
(
d¡
, 
¤c
, 
¬¿y
);

2304 
	`¢d_cÚfig_fÜ_—ch
(
si
, 
¢ext
, 
¤c
) {

2305 
¢d_cÚfig_t
 *
¢
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
si
);

2306 
found
 = 
çl£
;

2307 
	`¢d_cÚfig_fÜ_—ch
(
di
, 
dÃxt
, 
d¡
) {

2308 
¢d_cÚfig_t
 *
dn
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
di
);

2309 ià(
	`¡rcmp
(
¢
->
id
, 
dn
->id) == 0) {

2310 ià(
ov”ride
 ||

2311 
¢
->
ty³
 !ğ
SND_CONFIG_TYPE_COMPOUND
 ||

2312 
dn
->
ty³
 !ğ
SND_CONFIG_TYPE_COMPOUND
) {

2313 
	`¢d_cÚfig_»move
(
¢
);

2314 
”r
 = 
	`¢d_cÚfig_sub¡™u‹
(
dn
, 
¢
);

2315 ià(
”r
 < 0)

2316  
”r
;

2318 
”r
 = 
	`¢d_cÚfig_m”ge
(
dn
, 
¢
, 0);

2319 ià(
”r
 < 0)

2320  
”r
;

2322 
found
 = 
Œue
;

2326 ià(!
found
) {

2328 
	`¢d_cÚfig_»move
(
¢
);

2329 
¢
->
·»Á
 = 
d¡
;

2330 
	`li¡_add_
(&
¢
->
li¡
, &
d¡
->
u
.
compound
.
f›lds
);

2333 
	`¢d_cÚfig_d–‘e
(
¤c
);

2335 
	}
}

2350 
	$¢d_cÚfig_»move
(
¢d_cÚfig_t
 *
cÚfig
)

2352 
	`as£¹
(
cÚfig
);

2353 ià(
cÚfig
->
·»Á
)

2354 
	`li¡_d–
(&
cÚfig
->
li¡
);

2355 
cÚfig
->
·»Á
 = 
NULL
;

2357 
	}
}

2381 
	$¢d_cÚfig_d–‘e
(
¢d_cÚfig_t
 *
cÚfig
)

2383 
	`as£¹
(
cÚfig
);

2384 ià(
cÚfig
->
»fcouÁ
 > 0) {

2385 
cÚfig
->
»fcouÁ
--;

2388 
cÚfig
->
ty³
) {

2389 
SND_CONFIG_TYPE_COMPOUND
:

2391 
”r
;

2392 
li¡_h—d
 *
i
;

2393 
i
 = 
cÚfig
->
u
.
compound
.
f›lds
.
Ãxt
;

2394 
i
 !ğ&
cÚfig
->
u
.
compound
.
f›lds
) {

2395 
li¡_h—d
 *
Ãxti
 = 
i
->
Ãxt
;

2396 
¢d_cÚfig_t
 *
chd
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

2397 
”r
 = 
	`¢d_cÚfig_d–‘e
(
chd
);

2398 ià(
”r
 < 0)

2399  
”r
;

2400 
i
 = 
Ãxti
;

2404 
SND_CONFIG_TYPE_STRING
:

2405 
	`ä“
(
cÚfig
->
u
.
¡ršg
);

2410 ià(
cÚfig
->
·»Á
)

2411 
	`li¡_d–
(&
cÚfig
->
li¡
);

2412 
	`ä“
(
cÚfig
->
id
);

2413 
	`ä“
(
cÚfig
);

2415 
	}
}

2435 
	$¢d_cÚfig_d–‘e_compound_memb”s
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
)

2437 
”r
;

2438 
li¡_h—d
 *
i
;

2440 
	`as£¹
(
cÚfig
);

2441 ià(
cÚfig
->
ty³
 !ğ
SND_CONFIG_TYPE_COMPOUND
)

2442  -
EINVAL
;

2443 
i
 = 
cÚfig
->
u
.
compound
.
f›lds
.
Ãxt
;

2444 
i
 !ğ&
cÚfig
->
u
.
compound
.
f›lds
) {

2445 
li¡_h—d
 *
Ãxti
 = 
i
->
Ãxt
;

2446 
¢d_cÚfig_t
 *
chd
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

2447 
”r
 = 
	`¢d_cÚfig_d–‘e
(
chd
);

2448 ià(
”r
 < 0)

2449  
”r
;

2450 
i
 = 
Ãxti
;

2453 
	}
}

2474 
	$¢d_cÚfig_make
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
id
,

2475 
¢d_cÚfig_ty³_t
 
ty³
)

2477 *
id1
;

2478 
	`as£¹
(
cÚfig
);

2479 ià(
id
) {

2480 
id1
 = 
	`¡rdup
(
id
);

2481 ià(!
id1
)

2482  -
ENOMEM
;

2484 
id1
 = 
NULL
;

2485  
	`_¢d_cÚfig_make
(
cÚfig
, &
id1
, 
ty³
);

2486 
	}
}

2508 
	$¢d_cÚfig_make_š‹g”
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
id
)

2510  
	`¢d_cÚfig_make
(
cÚfig
, 
id
, 
SND_CONFIG_TYPE_INTEGER
);

2511 
	}
}

2533 
	$¢d_cÚfig_make_š‹g”64
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
id
)

2535  
	`¢d_cÚfig_make
(
cÚfig
, 
id
, 
SND_CONFIG_TYPE_INTEGER64
);

2536 
	}
}

2555 
	$¢d_cÚfig_make_»®
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
id
)

2557  
	`¢d_cÚfig_make
(
cÚfig
, 
id
, 
SND_CONFIG_TYPE_REAL
);

2558 
	}
}

2580 
	$¢d_cÚfig_make_¡ršg
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
id
)

2582  
	`¢d_cÚfig_make
(
cÚfig
, 
id
, 
SND_CONFIG_TYPE_STRING
);

2583 
	}
}

2602 
	$¢d_cÚfig_make_poš‹r
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
id
)

2604  
	`¢d_cÚfig_make
(
cÚfig
, 
id
, 
SND_CONFIG_TYPE_POINTER
);

2605 
	}
}

2645 
	$¢d_cÚfig_make_compound
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
id
,

2646 
još
)

2648 
”r
;

2649 
”r
 = 
	`¢d_cÚfig_make
(
cÚfig
, 
id
, 
SND_CONFIG_TYPE_COMPOUND
);

2650 ià(
”r
 < 0)

2651  
”r
;

2652 (*
cÚfig
)->
u
.
compound
.
još
 = join;

2654 
	}
}

2697 
	$¢d_cÚfig_make_·th
(
¢d_cÚfig_t
 **
cÚfig
, snd_cÚfig_ˆ*
roÙ
,

2698 cÚ¡ *
key
, 
još
, 
ov”ride
)

2700 
¢d_cÚfig_t
 *
n
;

2701 cÚ¡ *
p
;

2702 
”r
;

2705 
p
 = 
	`¡rchr
(
key
, '.');

2706 ià(
p
) {

2707 
”r
 = 
	`_¢d_cÚfig_£¬ch
(
roÙ
, 
key
, 
p
 - key, &
n
);

2708 ià(
”r
 < 0) {

2709 
size_t
 
l
 = 
p
 - 
key
;

2710 *
s
 = 
	`m®loc
(
l
 + 1);

2711 ià(
s
 =ğ
NULL
)

2712  -
ENOMEM
;

2713 
	`¡ºıy
(
s
, 
key
, 
l
);

2714 
s
[
l
] = '\0';

2715 
”r
 = 
	`¢d_cÚfig_make_compound
(&
n
, 
s
, 
još
);

2716 
	`ä“
(
s
);

2717 ià(
”r
 < 0)

2718  
”r
;

2719 
”r
 = 
	`¢d_cÚfig_add
(
roÙ
, 
n
);

2720 ià(
”r
 < 0)

2721  
”r
;

2723 
roÙ
 = 
n
;

2724 
key
 = 
p
 + 1;

2726 
”r
 = 
	`_¢d_cÚfig_£¬ch
(
roÙ
, 
key
, -1, 
cÚfig
);

2727 ià(
”r
 == 0) {

2728 ià((*
cÚfig
)->
ty³
 !ğ
SND_CONFIG_TYPE_COMPOUND
) {

2729 ià(
ov”ride
) {

2730 
”r
 = 
	`¢d_cÚfig_d–‘e
(*
cÚfig
);

2731 ià(
”r
 < 0)

2732  
”r
;

2733 
__make
;

2735  -
EACCES
;

2740 
__make
:

2741 
”r
 = 
	`¢d_cÚfig_make_compound
(&
n
, 
key
, 
još
);

2742 ià(
”r
 < 0)

2743  
”r
;

2744 
”r
 = 
	`¢d_cÚfig_add
(
roÙ
, 
n
);

2745 ià(
”r
 < 0)

2746  
”r
;

2747 *
cÚfig
 = 
n
;

2751 
	}
}

2772 
	$¢d_cÚfig_imake_š‹g”
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
id
, cÚ¡ 
v®ue
)

2774 
”r
;

2776 
”r
 = 
	`¢d_cÚfig_make
(
cÚfig
, 
id
, 
SND_CONFIG_TYPE_INTEGER
);

2777 ià(
”r
 < 0)

2778  
”r
;

2779 (*
cÚfig
)->
u
.
š‹g”
 = 
v®ue
;

2781 
	}
}

2802 
	$¢d_cÚfig_imake_š‹g”64
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
id
, cÚ¡ 
v®ue
)

2804 
”r
;

2806 
”r
 = 
	`¢d_cÚfig_make
(
cÚfig
, 
id
, 
SND_CONFIG_TYPE_INTEGER64
);

2807 ià(
”r
 < 0)

2808  
”r
;

2809 (*
cÚfig
)->
u
.
š‹g”64
 = 
v®ue
;

2811 
	}
}

2829 
	$¢d_cÚfig_imake_»®
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
id
, cÚ¡ 
v®ue
)

2831 
”r
;

2833 
”r
 = 
	`¢d_cÚfig_make
(
cÚfig
, 
id
, 
SND_CONFIG_TYPE_REAL
);

2834 ià(
”r
 < 0)

2835  
”r
;

2836 (*
cÚfig
)->
u
.
»®
 = 
v®ue
;

2838 
	}
}

2859 
	$¢d_cÚfig_imake_¡ršg
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
id
, cÚ¡ *
v®ue
)

2861 
”r
;

2862 
¢d_cÚfig_t
 *
tmp
;

2864 
”r
 = 
	`¢d_cÚfig_make
(&
tmp
, 
id
, 
SND_CONFIG_TYPE_STRING
);

2865 ià(
”r
 < 0)

2866  
”r
;

2867 ià(
v®ue
) {

2868 
tmp
->
u
.
¡ršg
 = 
	`¡rdup
(
v®ue
);

2869 ià(!
tmp
->
u
.
¡ršg
) {

2870 
	`¢d_cÚfig_d–‘e
(
tmp
);

2871  -
ENOMEM
;

2874 
tmp
->
u
.
¡ršg
 = 
NULL
;

2876 *
cÚfig
 = 
tmp
;

2878 
	}
}

2900 
	$¢d_cÚfig_imake_§ã_¡ršg
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
id
, cÚ¡ *
v®ue
)

2902 
”r
;

2903 
¢d_cÚfig_t
 *
tmp
;

2904 *
c
;

2906 
”r
 = 
	`¢d_cÚfig_make
(&
tmp
, 
id
, 
SND_CONFIG_TYPE_STRING
);

2907 ià(
”r
 < 0)

2908  
”r
;

2909 ià(
v®ue
) {

2910 
tmp
->
u
.
¡ršg
 = 
	`¡rdup
(
v®ue
);

2911 ià(!
tmp
->
u
.
¡ršg
) {

2912 
	`¢d_cÚfig_d–‘e
(
tmp
);

2913  -
ENOMEM
;

2916 
c
 = 
tmp
->
u
.
¡ršg
; *c; c++) {

2917 ià(*
c
 == ' ' || *c == '-' || *c == '_' ||

2918 (*
c
 >= '0' && *c <= '9') ||

2919 (*
c
 >= 'a' && *c <= 'z') ||

2920 (*
c
 >= 'A' && *c <= 'Z'))

2922 *
c
 = '_';

2925 
tmp
->
u
.
¡ršg
 = 
NULL
;

2927 *
cÚfig
 = 
tmp
;

2929 
	}
}

2948 
	$¢d_cÚfig_imake_poš‹r
(
¢d_cÚfig_t
 **
cÚfig
, cÚ¡ *
id
, cÚ¡ *
v®ue
)

2950 
”r
;

2952 
”r
 = 
	`¢d_cÚfig_make
(
cÚfig
, 
id
, 
SND_CONFIG_TYPE_POINTER
);

2953 ià(
”r
 < 0)

2954  
”r
;

2955 (*
cÚfig
)->
u
.
±r
 = 
v®ue
;

2957 
	}
}

2973 
	$¢d_cÚfig_£t_š‹g”
(
¢d_cÚfig_t
 *
cÚfig
, 
v®ue
)

2975 
	`as£¹
(
cÚfig
);

2976 ià(
cÚfig
->
ty³
 !ğ
SND_CONFIG_TYPE_INTEGER
)

2977  -
EINVAL
;

2978 
cÚfig
->
u
.
š‹g”
 = 
v®ue
;

2980 
	}
}

2996 
	$¢d_cÚfig_£t_š‹g”64
(
¢d_cÚfig_t
 *
cÚfig
, 
v®ue
)

2998 
	`as£¹
(
cÚfig
);

2999 ià(
cÚfig
->
ty³
 !ğ
SND_CONFIG_TYPE_INTEGER64
)

3000  -
EINVAL
;

3001 
cÚfig
->
u
.
š‹g”64
 = 
v®ue
;

3003 
	}
}

3016 
	$¢d_cÚfig_£t_»®
(
¢d_cÚfig_t
 *
cÚfig
, 
v®ue
)

3018 
	`as£¹
(
cÚfig
);

3019 ià(
cÚfig
->
ty³
 !ğ
SND_CONFIG_TYPE_REAL
)

3020  -
EINVAL
;

3021 
cÚfig
->
u
.
»®
 = 
v®ue
;

3023 
	}
}

3042 
	$¢d_cÚfig_£t_¡ršg
(
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ *
v®ue
)

3044 *
Ãw_¡ršg
;

3045 
	`as£¹
(
cÚfig
);

3046 ià(
cÚfig
->
ty³
 !ğ
SND_CONFIG_TYPE_STRING
)

3047  -
EINVAL
;

3048 ià(
v®ue
) {

3049 
Ãw_¡ršg
 = 
	`¡rdup
(
v®ue
);

3050 ià(!
Ãw_¡ršg
)

3051  -
ENOMEM
;

3053 
Ãw_¡ršg
 = 
NULL
;

3055 
	`ä“
(
cÚfig
->
u
.
¡ršg
);

3056 
cÚfig
->
u
.
¡ršg
 = 
Ãw_¡ršg
;

3058 
	}
}

3073 
	$¢d_cÚfig_£t_poš‹r
(
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ *
v®ue
)

3075 
	`as£¹
(
cÚfig
);

3076 ià(
cÚfig
->
ty³
 !ğ
SND_CONFIG_TYPE_POINTER
)

3077  -
EINVAL
;

3078 
cÚfig
->
u
.
±r
 = 
v®ue
;

3080 
	}
}

3107 
	$¢d_cÚfig_£t_ascii
(
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ *
ascii
)

3109 
	`as£¹
(
cÚfig
 && 
ascii
);

3110 
cÚfig
->
ty³
) {

3111 
SND_CONFIG_TYPE_INTEGER
:

3113 
i
;

3114 
”r
 = 
	`§ã_¡¹Ş
(
ascii
, &
i
);

3115 ià(
”r
 < 0)

3116  
”r
;

3117 
cÚfig
->
u
.
š‹g”
 = 
i
;

3120 
SND_CONFIG_TYPE_INTEGER64
:

3122 
i
;

3123 
”r
 = 
	`§ã_¡¹Şl
(
ascii
, &
i
);

3124 ià(
”r
 < 0)

3125  
”r
;

3126 
cÚfig
->
u
.
š‹g”64
 = 
i
;

3129 
SND_CONFIG_TYPE_REAL
:

3131 
d
;

3132 
”r
 = 
	`§ã_¡¹od
(
ascii
, &
d
);

3133 ià(
”r
 < 0)

3134  
”r
;

3135 
cÚfig
->
u
.
»®
 = 
d
;

3138 
SND_CONFIG_TYPE_STRING
:

3140 *
±r
 = 
	`¡rdup
(
ascii
);

3141 ià(
±r
 =ğ
NULL
)

3142  -
ENOMEM
;

3143 
	`ä“
(
cÚfig
->
u
.
¡ršg
);

3144 
cÚfig
->
u
.
¡ršg
 = 
±r
;

3148  -
EINVAL
;

3151 
	}
}

3167 
	$¢d_cÚfig_g‘_š‹g”
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, *
±r
)

3169 
	`as£¹
(
cÚfig
 && 
±r
);

3170 ià(
cÚfig
->
ty³
 !ğ
SND_CONFIG_TYPE_INTEGER
)

3171  -
EINVAL
;

3172 *
±r
 = 
cÚfig
->
u
.
š‹g”
;

3174 
	}
}

3190 
	$¢d_cÚfig_g‘_š‹g”64
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, *
±r
)

3192 
	`as£¹
(
cÚfig
 && 
±r
);

3193 ià(
cÚfig
->
ty³
 !ğ
SND_CONFIG_TYPE_INTEGER64
)

3194  -
EINVAL
;

3195 *
±r
 = 
cÚfig
->
u
.
š‹g”64
;

3197 
	}
}

3210 
	$¢d_cÚfig_g‘_»®
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, *
±r
)

3212 
	`as£¹
(
cÚfig
 && 
±r
);

3213 ià(
cÚfig
->
ty³
 !ğ
SND_CONFIG_TYPE_REAL
)

3214  -
EINVAL
;

3215 *
±r
 = 
cÚfig
->
u
.
»®
;

3217 
	}
}

3233 
	$¢d_cÚfig_g‘_œ—l
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, *
±r
)

3235 
	`as£¹
(
cÚfig
 && 
±r
);

3236 ià(
cÚfig
->
ty³
 =ğ
SND_CONFIG_TYPE_REAL
)

3237 *
±r
 = 
cÚfig
->
u
.
»®
;

3238 ià(
cÚfig
->
ty³
 =ğ
SND_CONFIG_TYPE_INTEGER
)

3239 *
±r
 = 
cÚfig
->
u
.
š‹g”
;

3240 ià(
cÚfig
->
ty³
 =ğ
SND_CONFIG_TYPE_INTEGER64
)

3241 *
±r
 = 
cÚfig
->
u
.
š‹g”64
;

3243  -
EINVAL
;

3245 
	}
}

3268 
	$¢d_cÚfig_g‘_¡ršg
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ **
±r
)

3270 
	`as£¹
(
cÚfig
 && 
±r
);

3271 ià(
cÚfig
->
ty³
 !ğ
SND_CONFIG_TYPE_STRING
)

3272  -
EINVAL
;

3273 *
±r
 = 
cÚfig
->
u
.
¡ršg
;

3275 
	}
}

3289 
	$¢d_cÚfig_g‘_poš‹r
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ **
±r
)

3291 
	`as£¹
(
cÚfig
 && 
±r
);

3292 ià(
cÚfig
->
ty³
 !ğ
SND_CONFIG_TYPE_POINTER
)

3293  -
EINVAL
;

3294 *
±r
 = 
cÚfig
->
u
.ptr;

3296 
	}
}

3325 
	$¢d_cÚfig_g‘_ascii
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, **
ascii
)

3327 
	`as£¹
(
cÚfig
 && 
ascii
);

3328 
cÚfig
->
ty³
) {

3329 
SND_CONFIG_TYPE_INTEGER
:

3331 
»s
[12];

3332 
”r
;

3333 
”r
 = 
	`¢´štf
(
»s
, Ôes), "%li", 
cÚfig
->
u
.
š‹g”
);

3334 ià(
”r
 < 0 ||ƒ¼ =ğ(
»s
)) {

3335 
	`as£¹
(0);

3336  -
ENOMEM
;

3338 *
ascii
 = 
	`¡rdup
(
»s
);

3341 
SND_CONFIG_TYPE_INTEGER64
:

3343 
»s
[32];

3344 
”r
;

3345 
”r
 = 
	`¢´štf
(
»s
, Ôes), "%Îi", 
cÚfig
->
u
.
š‹g”64
);

3346 ià(
”r
 < 0 ||ƒ¼ =ğ(
»s
)) {

3347 
	`as£¹
(0);

3348  -
ENOMEM
;

3350 *
ascii
 = 
	`¡rdup
(
»s
);

3353 
SND_CONFIG_TYPE_REAL
:

3355 
»s
[32];

3356 
”r
;

3357 
”r
 = 
	`¢´štf
(
»s
, Ôes), "%-16g", 
cÚfig
->
u
.
»®
);

3358 ià(
”r
 < 0 ||ƒ¼ =ğ(
»s
)) {

3359 
	`as£¹
(0);

3360  -
ENOMEM
;

3362 ià(
»s
[0]) {

3363 *
±r
;

3364 
±r
 = 
»s
 + 
	`¡¾’
(res) - 1;

3365 
±r
 !ğ
»s
 && *ptr == ' ')

3366 
±r
--;

3367 ià(*
±r
 != ' ')

3368 
±r
++;

3369 *
±r
 = '\0';

3371 *
ascii
 = 
	`¡rdup
(
»s
);

3374 
SND_CONFIG_TYPE_STRING
:

3375 ià(
cÚfig
->
u
.
¡ršg
)

3376 *
ascii
 = 
	`¡rdup
(
cÚfig
->
u
.
¡ršg
);

3378 *
ascii
 = 
NULL
;

3383  -
EINVAL
;

3385 ià(*
ascii
 =ğ
NULL
)

3386  -
ENOMEM
;

3388 
	}
}

3399 
	$¢d_cÚfig_‹¡_id
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ *
id
)

3401 
	`as£¹
(
cÚfig
 && 
id
);

3402 ià(
cÚfig
->
id
)

3403  
	`¡rcmp
(
cÚfig
->
id
, id);

3406 
	}
}

3426 
	$¢d_cÚfig_§ve
(
¢d_cÚfig_t
 *
cÚfig
, 
¢d_ouut_t
 *
out
)

3428 
	`as£¹
(
cÚfig
 && 
out
);

3429 ià(
cÚfig
->
ty³
 =ğ
SND_CONFIG_TYPE_COMPOUND
) {

3430 
¬¿y
 = 
	`¢d_cÚfig_is_¬¿y
(
cÚfig
);

3431  
	`_¢d_cÚfig_§ve_chd»n
(
cÚfig
, 
out
, 0, 0, 
¬¿y
);

3433  
	`_¢d_cÚfig_§ve_node_v®ue
(
cÚfig
, 
out
, 0);

3435 
	}
}

3441 #iâdeà
DOC_HIDDEN


3443 
	#SND_CONFIG_SEARCH
(
cÚfig
, 
key
, 
»suÉ
, 
exŒa_code
) \

3445 
¢d_cÚfig_t
 *
n
; \

3446 
”r
; \

3447 cÚ¡ *
p
; \

3448 
	`as£¹
(
cÚfig
 && 
key
); \

3450 ià(
cÚfig
->
ty³
 !ğ
SND_CONFIG_TYPE_COMPOUND
) \

3451  -
ENOENT
; \

3452 { 
exŒa_code
 ; } \

3453 
p
 = 
	`¡rchr
(
key
, '.'); \

3454 ià(
p
) { \

3455 
”r
 = 
	`_¢d_cÚfig_£¬ch
(
cÚfig
, 
key
, 
p
 - key, &
n
); \

3456 ià(
”r
 < 0) \

3457  
”r
; \

3458 
cÚfig
 = 
n
; \

3459 
key
 = 
p
 + 1; \

3461  
	`_¢d_cÚfig_£¬ch
(
cÚfig
, 
key
, -1, 
»suÉ
); \

3463 }

	)

3465 
	#SND_CONFIG_SEARCHA
(
roÙ
, 
cÚfig
, 
key
, 
»suÉ
, 
fú
, 
exŒa_code
) \

3467 
¢d_cÚfig_t
 *
n
; \

3468 
”r
; \

3469 cÚ¡ *
p
; \

3470 
	`as£¹
(
cÚfig
 && 
key
); \

3472 ià(
cÚfig
->
ty³
 !ğ
SND_CONFIG_TYPE_COMPOUND
) { \

3473 ià(
	`¢d_cÚfig_g‘_¡ršg
(
cÚfig
, &
p
) < 0) \

3474  -
ENOENT
; \

3475 
”r
 = 
	`fú
(
roÙ
,„oÙ, 
p
, &
cÚfig
); \

3476 ià(
”r
 < 0) \

3477  
”r
; \

3479 { 
exŒa_code
 ; } \

3480 
p
 = 
	`¡rchr
(
key
, '.'); \

3481 ià(
p
) { \

3482 
”r
 = 
	`_¢d_cÚfig_£¬ch
(
cÚfig
, 
key
, 
p
 - key, &
n
); \

3483 ià(
”r
 < 0) \

3484  
”r
; \

3485 
cÚfig
 = 
n
; \

3486 
key
 = 
p
 + 1; \

3488  
	`_¢d_cÚfig_£¬ch
(
cÚfig
, 
key
, -1, 
»suÉ
); \

3490 }

	)

3492 
	#SND_CONFIG_SEARCHV
(
cÚfig
, 
»suÉ
, 
fú
) \

3494 
¢d_cÚfig_t
 *
n
; \

3495 
va_li¡
 
¬g
; \

3496 
	`as£¹
(
cÚfig
); \

3497 
	`va_¡¬t
(
¬g
, 
»suÉ
); \

3499 cÚ¡ *
k
 = 
	`va_¬g
(
¬g
, const *); \

3500 
”r
; \

3501 ià(!
k
) \

3503 
”r
 = 
	`fú
(
cÚfig
, 
k
, &
n
); \

3504 ià(
”r
 < 0) { \

3505 
	`va_’d
(
¬g
); \

3506  
”r
; \

3508 
cÚfig
 = 
n
; \

3510 
	`va_’d
(
¬g
); \

3511 ià(
»suÉ
) \

3512 *
»suÉ
 = 
n
; \

3514 }

	)

3516 
	#SND_CONFIG_SEARCHVA
(
roÙ
, 
cÚfig
, 
»suÉ
, 
fú
) \

3518 
¢d_cÚfig_t
 *
n
; \

3519 
va_li¡
 
¬g
; \

3520 
	`as£¹
(
cÚfig
); \

3521 
	`va_¡¬t
(
¬g
, 
»suÉ
); \

3523 cÚ¡ *
k
 = 
	`va_¬g
(
¬g
, const *); \

3524 
”r
; \

3525 ià(!
k
) \

3527 
”r
 = 
	`fú
(
roÙ
, 
cÚfig
, 
k
, &
n
); \

3528 ià(
”r
 < 0) { \

3529 
	`va_’d
(
¬g
); \

3530  
”r
; \

3532 
cÚfig
 = 
n
; \

3534 
	`va_’d
(
¬g
); \

3535 ià(
»suÉ
) \

3536 *
»suÉ
 = 
n
; \

3538 }

	)

3540 
	#SND_CONFIG_SEARCH_ALIAS
(
cÚfig
, 
ba£
, 
key
, 
»suÉ
, 
fú1
, 
fú2
) \

3542 
¢d_cÚfig_t
 *
»s
 = 
NULL
; \

3543 *
Şd_key
; \

3544 
”r
, 
fœ¡
 = 1, 
maxloİ
 = 1000; \

3545 
	`as£¹
(
cÚfig
 && 
key
); \

3547 
Şd_key
 = 
	`¡rdup
(
key
); \

3548 ià(
Şd_key
 =ğ
NULL
) { \

3549 
”r
 = -
ENOMEM
; \

3550 
»s
 = 
NULL
; \

3553 
”r
 = 
fœ¡
 && 
ba£
 ? -
EIO
 : 
	`fú1
(
cÚfig
, cÚfig, 
key
, &
»s
); \

3554 ià(
”r
 < 0) { \

3555 ià(!
ba£
) \

3557 
”r
 = 
	`fú2
(
cÚfig
, cÚfig, &
»s
, 
ba£
, 
key
, 
NULL
); \

3558 ià(
”r
 < 0) \

3561 ià(
	`¢d_cÚfig_g‘_¡ršg
(
»s
, &
key
) < 0) \

3563 
	`as£¹
(
key
); \

3564 ià(!
fœ¡
 && (
	`¡rcmp
(
key
, 
Şd_key
è=ğ0 || 
maxloİ
 <= 0)) { \

3565 ià(
maxloİ
 == 0) \

3566 
	`SNDERR
("maximum†oop count„eached (circular configuration?)"); \

3568 
	`SNDERR
("key % »ãr tØ™£lf", 
key
); \

3569 
”r
 = -
EINVAL
; \

3570 
»s
 = 
NULL
; \

3573 
	`ä“
(
Şd_key
); \

3574 
fœ¡
 = 0; \

3575 
maxloİ
--; \

3577 
	`ä“
(
Şd_key
); \

3578 ià(!
»s
) \

3579  
”r
; \

3580 ià(
»suÉ
) \

3581 *
»suÉ
 = 
»s
; \

3583 }

	)

3627 
	$¢d_cÚfig_£¬ch
(
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ *
key
, snd_cÚfig_ˆ**
»suÉ
)

3629 
	`SND_CONFIG_SEARCH
(
cÚfig
, 
key
, 
»suÉ
, );

3630 
	}
}

3682 
	$¢d_cÚfig_£¬cha
(
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚfig
, cÚ¡ *
key
, snd_cÚfig_ˆ**
»suÉ
)

3684 
	`SND_CONFIG_SEARCHA
(
roÙ
, 
cÚfig
, 
key
, 
»suÉ
, 
¢d_cÚfig_£¬cha
, );

3685 
	}
}

3718 
	$¢d_cÚfig_£¬chv
(
¢d_cÚfig_t
 *
cÚfig
, snd_cÚfig_ˆ**
»suÉ
, ...)

3720 
	`SND_CONFIG_SEARCHV
(
cÚfig
, 
»suÉ
, 
¢d_cÚfig_£¬ch
);

3721 
	}
}

3747 
	$¢d_cÚfig_£¬chva
(
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚfig
, snd_cÚfig_ˆ**
»suÉ
, ...)

3749 
	`SND_CONFIG_SEARCHVA
(
roÙ
, 
cÚfig
, 
»suÉ
, 
¢d_cÚfig_£¬cha
);

3750 
	}
}

3778 
	$¢d_cÚfig_£¬ch_®Ÿs
(
¢d_cÚfig_t
 *
cÚfig
,

3779 cÚ¡ *
ba£
, cÚ¡ *
key
,

3780 
¢d_cÚfig_t
 **
»suÉ
)

3782 
	`SND_CONFIG_SEARCH_ALIAS
(
cÚfig
, 
ba£
, 
key
, 
»suÉ
,

3783 
¢d_cÚfig_£¬cha
, 
¢d_cÚfig_£¬chva
);

3784 
	}
}

3786 
¢d_cÚfig_hooks
(
¢d_cÚfig_t
 *
cÚfig
, snd_cÚfig_ˆ*
´iv©e_d©a
);

3810 
	$¢d_cÚfig_£¬ch_hooks
(
¢d_cÚfig_t
 *
cÚfig
, cÚ¡ *
key
, snd_cÚfig_ˆ**
»suÉ
)

3812 
	`SND_CONFIG_SEARCH
(
cÚfig
, 
key
, 
»suÉ
, \

3813 
”r
 = 
	`¢d_cÚfig_hooks
(
cÚfig
, 
NULL
); \

3814 ià(
”r
 < 0) \

3815  
”r
; \

3817 
	}
}

3843 
	$¢d_cÚfig_£¬cha_hooks
(
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚfig
, cÚ¡ *
key
, snd_cÚfig_ˆ**
»suÉ
)

3845 
	`SND_CONFIG_SEARCHA
(
roÙ
, 
cÚfig
, 
key
, 
»suÉ
,

3846 
¢d_cÚfig_£¬cha_hooks
,

3847 
”r
 = 
	`¢d_cÚfig_hooks
(
cÚfig
, 
NULL
); \

3848 ià(
”r
 < 0) \

3849  
”r
; \

3851 
	}
}

3879 
	$¢d_cÚfig_£¬chva_hooks
(
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚfig
,

3880 
¢d_cÚfig_t
 **
»suÉ
, ...)

3882 
	`SND_CONFIG_SEARCHVA
(
roÙ
, 
cÚfig
, 
»suÉ
, 
¢d_cÚfig_£¬cha_hooks
);

3883 
	}
}

3908 
	$¢d_cÚfig_£¬ch_®Ÿs_hooks
(
¢d_cÚfig_t
 *
cÚfig
,

3909 cÚ¡ *
ba£
, cÚ¡ *
key
,

3910 
¢d_cÚfig_t
 **
»suÉ
)

3912 
	`SND_CONFIG_SEARCH_ALIAS
(
cÚfig
, 
ba£
, 
key
, 
»suÉ
,

3913 
¢d_cÚfig_£¬cha_hooks
,

3914 
¢d_cÚfig_£¬chva_hooks
);

3915 
	}
}

3918 
	#ALSA_CONFIG_PATH_VAR
 "ALSA_CONFIG_PATH"

	)

3942 
¢d_cÚfig_t
 *
	g¢d_cÚfig
 = 
NULL
;

3944 #iâdeà
DOC_HIDDEN


3945 
	sfšfo
 {

3946 *
	mÇme
;

3947 
dev_t
 
	mdev
;

3948 
šo64_t
 
	mšo
;

3949 
time_t
 
	mmtime
;

3952 
	s_¢d_cÚfig_upd©e
 {

3953 
	mcouÁ
;

3954 
fšfo
 *
	mfšfo
;

3958 
¢d_cÚfig_upd©e_t
 *
	g¢d_cÚfig_glob®_upd©e
 = 
NULL
;

3960 
	$¢d_cÚfig_hooks_ÿÎ
(
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚfig
, snd_cÚfig_ˆ*
´iv©e_d©a
)

3962 *
h
 = 
NULL
;

3963 
¢d_cÚfig_t
 *
c
, *
func_cÚf
 = 
NULL
;

3964 *
buf
 = 
NULL
, 
”rbuf
[256];

3965 cÚ¡ *
lib
 = 
NULL
, *
func_Çme
 = NULL;

3966 cÚ¡ *
¡r
;

3967 (*
func
)(
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚfig
, snd_cÚfig_ˆ**
d¡
, snd_cÚfig_ˆ*
´iv©e_d©a
èğ
NULL
;

3968 
”r
;

3970 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cÚfig
, "func", &
c
);

3971 ià(
”r
 < 0) {

3972 
	`SNDERR
("Field func is missing");

3973  
”r
;

3975 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
c
, &
¡r
);

3976 ià(
”r
 < 0) {

3977 
	`SNDERR
("Invalidype for field func");

3978  
”r
;

3980 
	`as£¹
(
¡r
);

3981 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "hook_func", 
¡r
, &
func_cÚf
);

3982 ià(
”r
 >= 0) {

3983 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

3984 ià(
	`¢d_cÚfig_g‘_ty³
(
func_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

3985 
	`SNDERR
("Inv®idy³ fÜ funø% defš™iÚ", 
¡r
);

3986 
”r
 = -
EINVAL
;

3987 
_”r
;

3989 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
func_cÚf
) {

3990 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

3991 cÚ¡ *
id
 = 
n
->id;

3992 ià(
	`¡rcmp
(
id
, "comment") == 0)

3994 ià(
	`¡rcmp
(
id
, "lib") == 0) {

3995 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
lib
);

3996 ià(
”r
 < 0) {

3997 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

3998 
_”r
;

4002 ià(
	`¡rcmp
(
id
, "func") == 0) {

4003 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
func_Çme
);

4004 ià(
”r
 < 0) {

4005 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

4006 
_”r
;

4010 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

4013 ià(!
func_Çme
) {

4014 
Ën
 = 16 + 
	`¡¾’
(
¡r
) + 1;

4015 
buf
 = 
	`m®loc
(
Ën
);

4016 ià(! 
buf
) {

4017 
”r
 = -
ENOMEM
;

4018 
_”r
;

4020 
	`¢´štf
(
buf
, 
Ën
, "¢d_cÚfig_hook_%s", 
¡r
);

4021 
buf
[
Ën
-1] = '\0';

4022 
func_Çme
 = 
buf
;

4024 
h
 = 
	`INTERNAL
(
¢d_dlİ’
)(
lib
, 
RTLD_NOW
, 
”rbuf
, (errbuf));

4025 
func
 = 
h
 ? 
	`¢d_dlsym
(h, 
func_Çme
, 
	`SND_DLSYM_VERSION
(
SND_CONFIG_DLSYM_VERSION_HOOK
)è: 
NULL
;

4026 
”r
 = 0;

4027 ià(!
h
) {

4028 
	`SNDERR
("CªnÙ o³Àsh¬ed†ib¿ry % (%s)", 
lib
, 
”rbuf
);

4029 
”r
 = -
ENOENT
;

4030 } ià(!
func
) {

4031 
	`SNDERR
("symbŞ % i nÙ defšed insid%s", 
func_Çme
, 
lib
);

4032 
	`¢d_dlşo£
(
h
);

4033 
”r
 = -
ENXIO
;

4035 
_”r
:

4036 ià(
func_cÚf
)

4037 
	`¢d_cÚfig_d–‘e
(
func_cÚf
);

4038 ià(
”r
 >= 0) {

4039 
¢d_cÚfig_t
 *
ÄoÙ
;

4040 
”r
 = 
	`func
(
roÙ
, 
cÚfig
, &
ÄoÙ
, 
´iv©e_d©a
);

4041 ià(
”r
 < 0)

4042 
	`SNDERR
("funùiÚ % »tuºedƒ¼Ü: %s", 
func_Çme
, 
	`¢d_¡»¼Ü
(
”r
));

4043 
	`¢d_dlşo£
(
h
);

4044 ià(
”r
 >ğ0 && 
ÄoÙ
)

4045 
”r
 = 
	`¢d_cÚfig_sub¡™u‹
(
roÙ
, 
ÄoÙ
);

4047 
	`ä“
(
buf
);

4048 ià(
”r
 < 0)

4049  
”r
;

4051 
	}
}

4053 
	$¢d_cÚfig_hooks
(
¢d_cÚfig_t
 *
cÚfig
, snd_cÚfig_ˆ*
´iv©e_d©a
)

4055 
¢d_cÚfig_t
 *
n
;

4056 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

4057 
”r
, 
h™
, 
idx
 = 0;

4059 ià((
”r
 = 
	`¢d_cÚfig_£¬ch
(
cÚfig
, "@hooks", &
n
)) < 0)

4061 
	`¢d_cÚfig_lock
();

4062 
	`¢d_cÚfig_»move
(
n
);

4064 
h™
 = 0;

4065 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
n
) {

4066 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

4067 cÚ¡ *
id
 = 
n
->id;

4068 
i
;

4069 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
i
);

4070 ià(
”r
 < 0) {

4071 
	`SNDERR
("id oàf›ld % i nÙ‡nd iÁeg”", 
id
);

4072 
”r
 = -
EINVAL
;

4073 
_”r
;

4075 ià(
i
 =ğ
idx
) {

4076 
”r
 = 
	`¢d_cÚfig_hooks_ÿÎ
(
cÚfig
, 
n
, 
´iv©e_d©a
);

4077 ià(
”r
 < 0)

4078 
_”r
;

4079 
idx
++;

4080 
h™
 = 1;

4083 } 
h™
);

4084 
”r
 = 0;

4085 
_”r
:

4086 
	`¢d_cÚfig_d–‘e
(
n
);

4087 
	`¢d_cÚfig_uÆock
();

4088  
”r
;

4089 
	}
}

4091 
	$cÚfig_f’ame_f‹r
(cÚ¡ 
dœ’t64
 *
dœ’t
)

4093 
size_t
 
æ’
;

4095 ià(
dœ’t
 =ğ
NULL
)

4097 ià(
dœ’t
->
d_ty³
 =ğ
DT_DIR
)

4100 
æ’
 = 
	`¡¾’
(
dœ’t
->
d_Çme
);

4101 ià(
æ’
 <= 5)

4104 ià(
	`¡ºcmp
(&
dœ’t
->
d_Çme
[
æ’
-5], ".conf", 5) == 0)

4108 
	}
}

4110 
	$cÚfig_fe_İ’
(
¢d_cÚfig_t
 *
roÙ
, cÚ¡ *
f’ame
)

4112 
¢d_šput_t
 *
š
;

4113 
”r
;

4115 
”r
 = 
	`¢d_šput_¡dio_İ’
(&
š
, 
f’ame
, "r");

4116 ià(
”r
 >= 0) {

4117 
”r
 = 
	`¢d_cÚfig_lßd
(
roÙ
, 
š
);

4118 
	`¢d_šput_şo£
(
š
);

4119 ià(
”r
 < 0)

4120 
	`SNDERR
("% may bŞd o¸cÜru±ed: cÚsid”Ø»movÜ fix it", 
f’ame
);

4122 
	`SNDERR
("ÿÂÙ‡cûs f%s", 
f’ame
);

4124  
”r
;

4125 
	}
}

4127 
	$cÚfig_fe_lßd
(
¢d_cÚfig_t
 *
roÙ
, cÚ¡ *
â
, 
”rÜs
)

4129 
¡©64
 
¡
;

4130 
dœ’t64
 **
Çm–i¡
;

4131 
”r
, 
n
;

4133 ià(!
”rÜs
 && 
	`acûss
(
â
, 
R_OK
) < 0)

4135 ià(
	`¡©64
(
â
, &
¡
) < 0) {

4136 
	`SNDERR
("ÿÂÙ sˆfe/dœeùÜy %s", 
â
);

4139 ià(!
	`S_ISDIR
(
¡
.
¡_mode
))

4140  
	`cÚfig_fe_İ’
(
roÙ
, 
â
);

4141 #iâdeà
DOC_HIDDEN


4142 #ià
	`defšed
(
_GNU_SOURCE
è&& !defšed(
__N‘BSD__
è&& !defšed(
__F»eBSD__
è&& !defšed(
__O³nBSD__
è&& !defšed(
__D¿gÚFly__
è&& !defšed(
__sun
è&& !defšed(
__ANDROID__
)

4143 
	#SORTFUNC
 
v”siÚsÜt64


	)

4145 
	#SORTFUNC
 
®phasÜt64


	)

4148 
n
 = 
	`sÿndœ64
(
â
, &
Çm–i¡
, 
cÚfig_f’ame_f‹r
, 
SORTFUNC
);

4149 ià(
n
 > 0) {

4150 
j
;

4151 
”r
 = 0;

4152 
j
 = 0; j < 
n
; ++j) {

4153 ià(
”r
 >= 0) {

4154 
¦
 = 
	`¡¾’
(
â
è+ sŒËn(
Çm–i¡
[
j
]->
d_Çme
) + 2;

4155 *
f’ame
 = 
	`m®loc
(
¦
);

4156 
	`¢´štf
(
f’ame
, 
¦
, "%s/%s", 
â
, 
Çm–i¡
[
j
]->
d_Çme
);

4157 
f’ame
[
¦
-1] = '\0';

4159 
”r
 = 
	`cÚfig_fe_İ’
(
roÙ
, 
f’ame
);

4160 
	`ä“
(
f’ame
);

4162 
	`ä“
(
Çm–i¡
[
j
]);

4164 
	`ä“
(
Çm–i¡
);

4165 ià(
”r
 < 0)

4166  
”r
;

4169 
	}
}

4171 
	$cÚfig_fe_lßd_u£r
(
¢d_cÚfig_t
 *
roÙ
, cÚ¡ *
â
, 
”rÜs
)

4173 *
â2
;

4174 
”r
;

4176 
”r
 = 
	`¢d_u£r_fe
(
â
, &
â2
);

4177 ià(
”r
 < 0)

4178  
	`cÚfig_fe_lßd
(
roÙ
, 
â
, 
”rÜs
);

4179 
”r
 = 
	`cÚfig_fe_lßd
(
roÙ
, 
â2
, 
”rÜs
);

4180 
	`ä“
(
â2
);

4181  
”r
;

4182 
	}
}

4184 
	$cÚfig_fe_lßd_u£r_®l
(
¢d_cÚfig_t
 *
_roÙ
, snd_cÚfig_ˆ*
_fe
, 
”rÜs
)

4186 
¢d_cÚfig_t
 *
fe
 = 
_fe
, *
roÙ
 = 
_roÙ
, *
n
;

4187 *
Çme
, *
Çme2
, *
»maš
, *
ºame
 = 
NULL
;

4188 
”r
;

4190 ià(
	`¢d_cÚfig_g‘_ty³
(
_fe
è=ğ
SND_CONFIG_TYPE_COMPOUND
) {

4191 ià((
”r
 = 
	`¢d_cÚfig_£¬ch
(
_fe
, "fe", &
fe
)) < 0) {

4192 
	`SNDERR
("Field file‚ot found");

4193  
”r
;

4195 ià((
”r
 = 
	`¢d_cÚfig_£¬ch
(
_fe
, "roÙ", &
roÙ
)) >= 0) {

4196 
”r
 = 
	`¢d_cÚfig_g‘_ascii
(
roÙ
, &
ºame
);

4197 ià(
”r
 < 0) {

4198 
	`SNDERR
("Field„oot is bad");

4199  
”r
;

4201 
”r
 = 
	`¢d_cÚfig_make_compound
(&
roÙ
, 
ºame
, 0);

4202 ià(
”r
 < 0)

4203  
”r
;

4206 ià((
”r
 = 
	`¢d_cÚfig_g‘_ascii
(
fe
, &
Çme
)) < 0)

4207 
_”r
;

4208 
Çme2
 = 
Çme
;

4209 
»maš
 = 
	`¡r¡r
(
Çme
, "|||");

4211 ià(
»maš
) {

4212 *
»maš
 = '\0';

4213 
»maš
 += 3;

4215 
”r
 = 
	`cÚfig_fe_lßd_u£r
(
roÙ
, 
Çme2
, 
”rÜs
);

4216 ià(
”r
 < 0)

4217 
_”r
;

4218 ià(
”r
 == 0)

4220 ià(!
»maš
)

4222 
Çme2
 = 
»maš
;

4223 
»maš
 = 
	`¡r¡r
(remain, "|||");

4225 
_”r
:

4226 ià(
roÙ
 !ğ
_roÙ
) {

4227 ià(
”r
 == 0) {

4228 ià(
	`¢d_cÚfig_g‘_ty³
(
roÙ
è=ğ
SND_CONFIG_TYPE_COMPOUND
) {

4229 ià(
	`¢d_cÚfig_is_em±y
(
roÙ
))

4230 
_d–
;

4232 
”r
 = 
	`¢d_cÚfig_make_·th
(&
n
, 
_roÙ
, 
ºame
, 0, 1);

4233 ià(
”r
 < 0)

4234 
_d–
;

4235 
”r
 = 
	`¢d_cÚfig_sub¡™u‹
(
n
, 
roÙ
);

4236 ià(
”r
 == 0)

4237 
_fš
;

4239 
_d–
:

4240 
	`¢d_cÚfig_d–‘e
(
roÙ
);

4242 
_fš
:

4243 
	`ä“
(
Çme
);

4244 
	`ä“
(
ºame
);

4245  
”r
;

4246 
	}
}

4260 
	$¢d_cÚfig_hook_lßd
(
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚfig
, snd_cÚfig_ˆ**
d¡
, snd_cÚfig_ˆ*
´iv©e_d©a
)

4262 
¢d_cÚfig_t
 *
n
;

4263 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

4264 
”r
, 
idx
 = 0, 
”rÜs
 = 1, 
h™
;

4266 
	`as£¹
(
roÙ
 && 
d¡
);

4267 ià((
”r
 = 
	`¢d_cÚfig_£¬ch
(
cÚfig
, "”rÜs", &
n
)) >= 0) {

4268 
”rÜs
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

4269 ià(
”rÜs
 < 0) {

4270 
	`SNDERR
("Invalid bool value in fieldƒrrors");

4271  
”rÜs
;

4274 ià((
”r
 = 
	`¢d_cÚfig_£¬ch
(
cÚfig
, "fes", &
n
)) < 0) {

4275 
	`SNDERR
("Unableo find field files inhe…re-load section");

4276  -
EINVAL
;

4278 ià((
”r
 = 
	`¢d_cÚfig_ex·nd
(
n
, 
roÙ
, 
NULL
, 
´iv©e_d©a
, &n)) < 0) {

4279 
	`SNDERR
("Unableoƒxpand filenames inhe…re-load section");

4280  
”r
;

4282 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

4283 
	`SNDERR
("Invalidype for field filenames");

4284 
_”r
;

4287 
h™
 = 0;

4288 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
n
) {

4289 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

4290 cÚ¡ *
id
 = 
n
->id;

4291 
i
;

4292 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
i
);

4293 ià(
”r
 < 0) {

4294 
	`SNDERR
("id oàf›ld % i nÙ‡nd iÁeg”", 
id
);

4295 
”r
 = -
EINVAL
;

4296 
_”r
;

4298 ià(
i
 =ğ
idx
) {

4299 
”r
 = 
	`cÚfig_fe_lßd_u£r_®l
(
roÙ
, 
n
, 
”rÜs
);

4300 ià(
”r
 < 0)

4301 
_”r
;

4302 
idx
++;

4303 
h™
 = 1;

4306 } 
h™
);

4307 *
d¡
 = 
NULL
;

4308 
”r
 = 0;

4309 
_”r
:

4310 
	`¢d_cÚfig_d–‘e
(
n
);

4311  
”r
;

4312 
	}
}

4313 #iâdeà
DOC_HIDDEN


4314 
SND_DLSYM_BUILD_VERSION
(
¢d_cÚfig_hook_lßd
, 
SND_CONFIG_DLSYM_VERSION_HOOK
);

4317 #iâdeà
DOC_HIDDEN


4318 
¢d_d‘”mše_driv”
(
ÿrd
, **
driv”
);

4321 
¢d_cÚfig_t
 *
	$_¢d_cÚfig_hook_´iv©e_d©a
(
ÿrd
, cÚ¡ *
driv”
)

4323 
¢d_cÚfig_t
 *
´iv©e_d©a
, *
v
;

4324 
”r
;

4326 
”r
 = 
	`¢d_cÚfig_make_compound
(&
´iv©e_d©a
, 
NULL
, 0);

4327 ià(
”r
 < 0)

4328 
__”r
;

4329 
”r
 = 
	`¢d_cÚfig_imake_š‹g”
(&
v
, "š‹g”", 
ÿrd
);

4330 ià(
”r
 < 0)

4331 
__”r
;

4332 
”r
 = 
	`¢d_cÚfig_add
(
´iv©e_d©a
, 
v
);

4333 ià(
”r
 < 0) {

4334 
	`¢d_cÚfig_d–‘e
(
v
);

4335 
__”r
;

4337 
”r
 = 
	`¢d_cÚfig_imake_¡ršg
(&
v
, "¡ršg", 
driv”
);

4338 ià(
”r
 < 0)

4339 
__”r
;

4340 
”r
 = 
	`¢d_cÚfig_add
(
´iv©e_d©a
, 
v
);

4341 ià(
”r
 < 0) {

4342 
	`¢d_cÚfig_d–‘e
(
v
);

4343 
__”r
;

4345  
´iv©e_d©a
;

4347 
__”r
:

4348 
	`¢d_cÚfig_d–‘e
(
´iv©e_d©a
);

4349  
NULL
;

4350 
	}
}

4352 
	$_¢d_cÚfig_hook_bË
(
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚfig
, snd_cÚfig_ˆ*
´iv©e_d©a
)

4354 
¢d_cÚfig_t
 *
n
, *
Š
;

4355 cÚ¡ *
id
;

4356 
”r
;

4358 ià(
	`¢d_cÚfig_£¬ch
(
cÚfig
, "bË", &
n
) < 0)

4360 ià((
”r
 = 
	`¢d_cÚfig_ex·nd
(
n
, 
roÙ
, 
NULL
, 
´iv©e_d©a
, &n)) < 0) {

4361 
	`SNDERR
("Unableoƒxpandable compound");

4362  
”r
;

4364 ià(
	`¢d_cÚfig_£¬ch
(
n
, "id", &
Š
) < 0 ||

4365 
	`¢d_cÚfig_g‘_¡ršg
(
Š
, &
id
) < 0) {

4366 
	`SNDERR
("Unableo find fieldable.id");

4367 
	`¢d_cÚfig_d–‘e
(
n
);

4368  -
EINVAL
;

4370 ià(
	`¢d_cÚfig_£¬ch
(
n
, "v®ue", &
Š
) < 0 ||

4371 
	`¢d_cÚfig_g‘_ty³
(
Š
è!ğ
SND_CONFIG_TYPE_STRING
) {

4372 
	`SNDERR
("Unableo find fieldable.value");

4373 
	`¢d_cÚfig_d–‘e
(
n
);

4374  -
EINVAL
;

4376 
	`¢d_cÚfig_»move
(
Š
);

4377 ià((
”r
 = 
	`¢d_cÚfig_£t_id
(
Š
, 
id
)) < 0) {

4378 
	`¢d_cÚfig_d–‘e
(
Š
);

4379 
	`¢d_cÚfig_d–‘e
(
n
);

4380  
”r
;

4382 
	`¢d_cÚfig_d–‘e
(
n
);

4383 ià((
”r
 = 
	`¢d_cÚfig_add
(
roÙ
, 
Š
)) < 0) {

4384 
	`¢d_cÚfig_d–‘e
(
Š
);

4385  
”r
;

4388 
	}
}

4405 
	$¢d_cÚfig_hook_lßd_fÜ_®l_ÿrds
(
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚfig
, snd_cÚfig_ˆ**
d¡
, snd_cÚfig_ˆ*
´iv©e_d©a
 
ATTRIBUTE_UNUSED
)

4407 
ÿrd
 = -1, 
”r
;

4408 
¢d_cÚfig_t
 *
lßded
;

4410 
”r
 = 
	`¢d_cÚfig_tİ
(&
lßded
);

4411 ià(
”r
 < 0)

4412  
”r
;

4414 
”r
 = 
	`¢d_ÿrd_Ãxt
(&
ÿrd
);

4415 ià(
”r
 < 0)

4416 
__fš_”r
;

4417 ià(
ÿrd
 >= 0) {

4418 
¢d_cÚfig_t
 *
n
, *
m
, *
´iv©e_d©a
 = 
NULL
;

4419 cÚ¡ *
driv”
;

4420 *
fdriv”
 = 
NULL
;

4421 
boŞ
 
lßd
;

4422 
”r
 = 
	`¢d_d‘”mše_driv”
(
ÿrd
, &
fdriv”
);

4423 ià(
”r
 < 0)

4424 
__fš_”r
;

4425 ià(
	`¢d_cÚfig_£¬ch
(
roÙ
, 
fdriv”
, &
n
) >= 0) {

4426 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
driv”
) < 0) {

4427 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è=ğ
SND_CONFIG_TYPE_COMPOUND
) {

4428 
	`¢d_cÚfig_g‘_id
(
n
, &
driv”
);

4429 
__¡d
;

4431 
__”r
;

4434 *
s
 = 
	`¡rchr
(
driv”
, '.');

4435 ià(
s
 =ğ
NULL
)

4437 
driv”
 = 
s
 + 1;

4439 ià(
	`¢d_cÚfig_£¬ch
(
roÙ
, 
driv”
, &
n
) >= 0)

4440 
__”r
;

4442 
driv”
 = 
fdriv”
;

4444 
__¡d
:

4445 
lßd
 = 
Œue
;

4446 
”r
 = 
	`¢d_cÚfig_imake_š‹g”
(&
m
, 
driv”
, 1);

4447 ià(
”r
 < 0)

4448 
__”r
;

4449 
”r
 = 
	`¢d_cÚfig_add
(
lßded
, 
m
);

4450 ià(
”r
 < 0) {

4451 ià(
”r
 =ğ-
EEXIST
) {

4452 
	`¢d_cÚfig_d–‘e
(
m
);

4453 
lßd
 = 
çl£
;

4455 
__”r
;

4458 
´iv©e_d©a
 = 
	`_¢d_cÚfig_hook_´iv©e_d©a
(
ÿrd
, 
driv”
);

4459 ià(!
´iv©e_d©a
) {

4460 
”r
 = -
ENOMEM
;

4461 
__”r
;

4463 
”r
 = 
	`_¢d_cÚfig_hook_bË
(
roÙ
, 
cÚfig
, 
´iv©e_d©a
);

4464 ià(
”r
 < 0)

4465 
__”r
;

4466 ià(
lßd
)

4467 
”r
 = 
	`¢d_cÚfig_hook_lßd
(
roÙ
, 
cÚfig
, &
n
, 
´iv©e_d©a
);

4468 
__”r
:

4469 ià(
´iv©e_d©a
)

4470 
	`¢d_cÚfig_d–‘e
(
´iv©e_d©a
);

4471 
	`ä“
(
fdriv”
);

4472 ià(
”r
 < 0)

4473 
__fš_”r
;

4475 } 
ÿrd
 >= 0);

4476 
	`¢d_cÚfig_d–‘e
(
lßded
);

4477 *
d¡
 = 
NULL
;

4479 
__fš_”r
:

4480 
	`¢d_cÚfig_d–‘e
(
lßded
);

4481  
”r
;

4482 
	}
}

4483 #iâdeà
DOC_HIDDEN


4484 
SND_DLSYM_BUILD_VERSION
(
¢d_cÚfig_hook_lßd_fÜ_®l_ÿrds
, 
SND_CONFIG_DLSYM_VERSION_HOOK
);

4514 
	$¢d_cÚfig_upd©e_r
(
¢d_cÚfig_t
 **
_tİ
, 
¢d_cÚfig_upd©e_t
 **
_upd©e
, cÚ¡ *
cfgs
)

4516 
”r
;

4517 cÚ¡ *
cÚfigs
, *
c
;

4518 
k
;

4519 
size_t
 
l
;

4520 
¢d_cÚfig_upd©e_t
 *
loÿl
;

4521 
¢d_cÚfig_upd©e_t
 *
upd©e
;

4522 
¢d_cÚfig_t
 *
tİ
;

4524 
	`as£¹
(
_tİ
 && 
_upd©e
);

4525 
tİ
 = *
_tİ
;

4526 
upd©e
 = *
_upd©e
;

4527 
cÚfigs
 = 
cfgs
;

4528 ià(!
cÚfigs
) {

4529 
cÚfigs
 = 
	`g‘’v
(
ALSA_CONFIG_PATH_VAR
);

4530 ià(!
cÚfigs
 || !*configs) {

4531 cÚ¡ *
tİdœ
 = 
	`¢d_cÚfig_tİdœ
();

4532 *
s
 = 
	`®loÿ
(
	`¡¾’
(
tİdœ
) +

4533 
	`¡¾’
("alsa.conf") + 2);

4534 
	`¥rštf
(
s
, "%s/®§.cÚf", 
tİdœ
);

4535 
cÚfigs
 = 
s
;

4538 
k
 = 0, 
c
 = 
cÚfigs
; (
l
 = 
	`¡rc¥n
(c, ": ")) > 0; ) {

4539 
c
 +ğ
l
;

4540 
k
++;

4541 ià(!*
c
)

4543 
c
++;

4545 ià(
k
 == 0) {

4546 
loÿl
 = 
NULL
;

4547 
_»»ad
;

4549 
loÿl
 = (
¢d_cÚfig_upd©e_t
 *)
	`ÿÎoc
(1, (snd_config_update_t));

4550 ià(!
loÿl
)

4551  -
ENOMEM
;

4552 
loÿl
->
couÁ
 = 
k
;

4553 
loÿl
->
fšfo
 = 
	`ÿÎoc
Öoÿl->
couÁ
, (finfo));

4554 ià(!
loÿl
->
fšfo
) {

4555 
	`ä“
(
loÿl
);

4556  -
ENOMEM
;

4558 
k
 = 0, 
c
 = 
cÚfigs
; (
l
 = 
	`¡rc¥n
(c, ": ")) > 0; ) {

4559 
Çme
[
l
 + 1];

4560 
	`memıy
(
Çme
, 
c
, 
l
);

4561 
Çme
[
l
] = 0;

4562 
”r
 = 
	`¢d_u£r_fe
(
Çme
, &
loÿl
->
fšfo
[
k
].name);

4563 ià(
”r
 < 0)

4564 
_’d
;

4565 
c
 +ğ
l
;

4566 
k
++;

4567 ià(!*
c
)

4569 
c
++;

4571 
k
 = 0; k < 
loÿl
->
couÁ
; ++k) {

4572 
¡©64
 
¡
;

4573 
fšfo
 *
lf
 = &
loÿl
->fšfo[
k
];

4574 ià(
	`¡©64
(
lf
->
Çme
, &
¡
) >= 0) {

4575 
lf
->
dev
 = 
¡
.
¡_dev
;

4576 
lf
->
šo
 = 
¡
.
¡_šo
;

4577 
lf
->
mtime
 = 
¡
.
¡_mtime
;

4579 
	`SNDERR
("CªnÙ‡cûs f%s", 
lf
->
Çme
);

4580 
	`ä“
(
lf
->
Çme
);

4581 
	`memmove
(&
loÿl
->
fšfo
[
k
], &loÿl->fšfo[k+1], (fšfoè* (loÿl->
couÁ
 - k - 1));

4582 
k
--;

4583 
loÿl
->
couÁ
--;

4586 ià(!
upd©e
)

4587 
_»»ad
;

4588 ià(
loÿl
->
couÁ
 !ğ
upd©e
->count)

4589 
_»»ad
;

4590 
k
 = 0; k < 
loÿl
->
couÁ
; ++k) {

4591 
fšfo
 *
lf
 = &
loÿl
->fšfo[
k
];

4592 
fšfo
 *
uf
 = &
upd©e
->fšfo[
k
];

4593 ià(
	`¡rcmp
(
lf
->
Çme
, 
uf
->name) != 0 ||

4594 
lf
->
dev
 !ğ
uf
->dev ||

4595 
lf
->
šo
 !ğ
uf
->ino ||

4596 
lf
->
mtime
 !ğ
uf
->mtime)

4597 
_»»ad
;

4599 
”r
 = 0;

4601 
_’d
:

4602 ià(
”r
 < 0) {

4603 ià(
tİ
) {

4604 
	`¢d_cÚfig_d–‘e
(
tİ
);

4605 *
_tİ
 = 
NULL
;

4607 ià(
upd©e
) {

4608 
	`¢d_cÚfig_upd©e_ä“
(
upd©e
);

4609 *
_upd©e
 = 
NULL
;

4612 ià(
loÿl
)

4613 
	`¢d_cÚfig_upd©e_ä“
(
loÿl
);

4614  
”r
;

4616 
_»»ad
:

4617 *
_tİ
 = 
NULL
;

4618 *
_upd©e
 = 
NULL
;

4619 ià(
upd©e
) {

4620 
	`¢d_cÚfig_upd©e_ä“
(
upd©e
);

4621 
upd©e
 = 
NULL
;

4623 ià(
tİ
) {

4624 
	`¢d_cÚfig_d–‘e
(
tİ
);

4625 
tİ
 = 
NULL
;

4627 
”r
 = 
	`¢d_cÚfig_tİ
(&
tİ
);

4628 ià(
”r
 < 0)

4629 
_’d
;

4630 ià(!
loÿl
)

4631 
_sk
;

4632 
k
 = 0; k < 
loÿl
->
couÁ
; ++k) {

4633 
¢d_šput_t
 *
š
;

4634 
”r
 = 
	`¢d_šput_¡dio_İ’
(&
š
, 
loÿl
->
fšfo
[
k
].
Çme
, "r");

4635 ià(
”r
 >= 0) {

4636 
”r
 = 
	`¢d_cÚfig_lßd
(
tİ
, 
š
);

4637 
	`¢d_šput_şo£
(
š
);

4638 ià(
”r
 < 0) {

4639 
	`SNDERR
("% may bŞd o¸cÜru±ed: cÚsid”Ø»movÜ fix it", 
loÿl
->
fšfo
[
k
].
Çme
);

4640 
_’d
;

4643 
	`SNDERR
("ÿÂÙ‡cûs f%s", 
loÿl
->
fšfo
[
k
].
Çme
);

4646 
_sk
:

4647 
”r
 = 
	`¢d_cÚfig_hooks
(
tİ
, 
NULL
);

4648 ià(
”r
 < 0) {

4649 
	`SNDERR
("hooks failed,„emoving configuration");

4650 
_’d
;

4652 *
_tİ
 = 
tİ
;

4653 *
_upd©e
 = 
loÿl
;

4655 
	}
}

4675 
	$¢d_cÚfig_upd©e
()

4677 
”r
;

4679 
	`¢d_cÚfig_lock
();

4680 
”r
 = 
	`¢d_cÚfig_upd©e_r
(&
¢d_cÚfig
, &
¢d_cÚfig_glob®_upd©e
, 
NULL
);

4681 
	`¢d_cÚfig_uÆock
();

4682  
”r
;

4683 
	}
}

4696 
	$¢d_cÚfig_upd©e_»f
(
¢d_cÚfig_t
 **
tİ
)

4698 
”r
;

4700 ià(
tİ
)

4701 *
tİ
 = 
NULL
;

4702 
	`¢d_cÚfig_lock
();

4703 
”r
 = 
	`¢d_cÚfig_upd©e_r
(&
¢d_cÚfig
, &
¢d_cÚfig_glob®_upd©e
, 
NULL
);

4704 ià(
”r
 >= 0) {

4705 ià(
¢d_cÚfig
) {

4706 ià(
tİ
) {

4707 
¢d_cÚfig
->
»fcouÁ
++;

4708 *
tİ
 = 
¢d_cÚfig
;

4711 
”r
 = -
ENODEV
;

4714 
	`¢d_cÚfig_uÆock
();

4715  
”r
;

4716 
	}
}

4725 
	$¢d_cÚfig_»f
(
¢d_cÚfig_t
 *
cfg
)

4727 
	`¢d_cÚfig_lock
();

4728 ià(
cfg
)

4729 
cfg
->
»fcouÁ
++;

4730 
	`¢d_cÚfig_uÆock
();

4731 
	}
}

4745 
	$¢d_cÚfig_uÄef
(
¢d_cÚfig_t
 *
cfg
)

4747 
	`¢d_cÚfig_lock
();

4748 ià(
cfg
)

4749 
	`¢d_cÚfig_d–‘e
(
cfg
);

4750 
	`¢d_cÚfig_uÆock
();

4751 
	}
}

4758 
	$¢d_cÚfig_upd©e_ä“
(
¢d_cÚfig_upd©e_t
 *
upd©e
)

4760 
k
;

4762 
	`as£¹
(
upd©e
);

4763 
k
 = 0; k < 
upd©e
->
couÁ
; k++)

4764 
	`ä“
(
upd©e
->
fšfo
[
k
].
Çme
);

4765 
	`ä“
(
upd©e
->
fšfo
);

4766 
	`ä“
(
upd©e
);

4768 
	}
}

4780 
	$¢d_cÚfig_upd©e_ä“_glob®
()

4782 
	`¢d_cÚfig_lock
();

4783 ià(
¢d_cÚfig
)

4784 
	`¢d_cÚfig_d–‘e
(
¢d_cÚfig
);

4785 
¢d_cÚfig
 = 
NULL
;

4786 ià(
¢d_cÚfig_glob®_upd©e
)

4787 
	`¢d_cÚfig_upd©e_ä“
(
¢d_cÚfig_glob®_upd©e
);

4788 
¢d_cÚfig_glob®_upd©e
 = 
NULL
;

4789 
	`¢d_cÚfig_uÆock
();

4791 
	`¢d_dlobj_ÿche_ş—nup
();

4794 
	}
}

4812 
¢d_cÚfig_™”©Ü_t
 
	$¢d_cÚfig_™”©Ü_fœ¡
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
)

4814 
	`as£¹
(
cÚfig
->
ty³
 =ğ
SND_CONFIG_TYPE_COMPOUND
);

4815  
cÚfig
->
u
.
compound
.
f›lds
.
Ãxt
;

4816 
	}
}

4832 
¢d_cÚfig_™”©Ü_t
 
	$¢d_cÚfig_™”©Ü_Ãxt
(cÚ¡ 
¢d_cÚfig_™”©Ü_t
 
™”©Ü
)

4834  
™”©Ü
->
Ãxt
;

4835 
	}
}

4850 
¢d_cÚfig_™”©Ü_t
 
	$¢d_cÚfig_™”©Ü_’d
(cÚ¡ 
¢d_cÚfig_t
 *
cÚfig
)

4852 
	`as£¹
(
cÚfig
->
ty³
 =ğ
SND_CONFIG_TYPE_COMPOUND
);

4853  (cÚ¡ 
¢d_cÚfig_™”©Ü_t
)&
cÚfig
->
u
.
compound
.
f›lds
;

4854 
	}
}

4864 
¢d_cÚfig_t
 *
	$¢d_cÚfig_™”©Ü_’Œy
(cÚ¡ 
¢d_cÚfig_™”©Ü_t
 
™”©Ü
)

4866  
	`li¡_’Œy
(
™”©Ü
, 
¢d_cÚfig_t
, 
li¡
);

4867 
	}
}

4869 #iâdeà
DOC_HIDDEN


4870 
	e_¢d_cÚfig_w®k_·ss
 {

4871 
	mSND_CONFIG_WALK_PASS_PRE
,

4872 
	mSND_CONFIG_WALK_PASS_POST
,

4873 
	mSND_CONFIG_WALK_PASS_LEAF
,

4874 } 
	t¢d_cÚfig_w®k_·ss_t
;

4879 #iâdeà
DOC_HIDDEN


4880 (*
	t¢d_cÚfig_w®k_ÿÎback_t
)(
	t¢d_cÚfig_t
 *
	t¤c
,

4881 
	t¢d_cÚfig_t
 *
	troÙ
,

4882 
	t¢d_cÚfig_t
 **
	td¡
,

4883 
	t¢d_cÚfig_w®k_·ss_t
 
	t·ss
,

4884 
	t¢d_cÚfig_ex·nd_fú_t
 
	tfú
,

4885 *
	t´iv©e_d©a
);

4888 
	$¢d_cÚfig_w®k
(
¢d_cÚfig_t
 *
¤c
,

4889 
¢d_cÚfig_t
 *
roÙ
,

4890 
¢d_cÚfig_t
 **
d¡
,

4891 
¢d_cÚfig_w®k_ÿÎback_t
 
ÿÎback
,

4892 
¢d_cÚfig_ex·nd_fú_t
 
fú
,

4893 *
´iv©e_d©a
)

4895 
”r
;

4896 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

4898 
	`¢d_cÚfig_g‘_ty³
(
¤c
)) {

4899 
SND_CONFIG_TYPE_COMPOUND
:

4900 
”r
 = 
	`ÿÎback
(
¤c
, 
roÙ
, 
d¡
, 
SND_CONFIG_WALK_PASS_PRE
, 
fú
, 
´iv©e_d©a
);

4901 ià(
”r
 <= 0)

4902  
”r
;

4903 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
¤c
) {

4904 
¢d_cÚfig_t
 *
s
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

4905 
¢d_cÚfig_t
 *
d
 = 
NULL
;

4907 
”r
 = 
	`¢d_cÚfig_w®k
(
s
, 
roÙ
, (
d¡
 && *d¡è? &
d
 : 
NULL
,

4908 
ÿÎback
, 
fú
, 
´iv©e_d©a
);

4909 ià(
”r
 < 0)

4910 
_”rÜ
;

4911 ià(
”r
 && 
d
) {

4912 
”r
 = 
	`¢d_cÚfig_add
(*
d¡
, 
d
);

4913 ià(
”r
 < 0)

4914 
_”rÜ
;

4917 
”r
 = 
	`ÿÎback
(
¤c
, 
roÙ
, 
d¡
, 
SND_CONFIG_WALK_PASS_POST
, 
fú
, 
´iv©e_d©a
);

4918 ià(
”r
 <= 0) {

4919 
_”rÜ
:

4920 ià(
d¡
 && *dst)

4921 
	`¢d_cÚfig_d–‘e
(*
d¡
);

4925 
”r
 = 
	`ÿÎback
(
¤c
, 
roÙ
, 
d¡
, 
SND_CONFIG_WALK_PASS_LEAF
, 
fú
, 
´iv©e_d©a
);

4928  
”r
;

4929 
	}
}

4931 
	$_¢d_cÚfig_cİy
(
¢d_cÚfig_t
 *
¤c
,

4932 
¢d_cÚfig_t
 *
roÙ
 
ATTRIBUTE_UNUSED
,

4933 
¢d_cÚfig_t
 **
d¡
,

4934 
¢d_cÚfig_w®k_·ss_t
 
·ss
,

4935 
¢d_cÚfig_ex·nd_fú_t
 
fú
 
ATTRIBUTE_UNUSED
,

4936 *
´iv©e_d©a
 
ATTRIBUTE_UNUSED
)

4938 
”r
;

4939 cÚ¡ *
id
 = 
¤c
->id;

4940 
¢d_cÚfig_ty³_t
 
ty³
 = 
	`¢d_cÚfig_g‘_ty³
(
¤c
);

4941 
·ss
) {

4942 
SND_CONFIG_WALK_PASS_PRE
:

4943 
”r
 = 
	`¢d_cÚfig_make_compound
(
d¡
, 
id
, 
¤c
->
u
.
compound
.
još
);

4944 ià(
”r
 < 0)

4945  
”r
;

4947 
SND_CONFIG_WALK_PASS_LEAF
:

4948 
”r
 = 
	`¢d_cÚfig_make
(
d¡
, 
id
, 
ty³
);

4949 ià(
”r
 < 0)

4950  
”r
;

4951 
ty³
) {

4952 
SND_CONFIG_TYPE_INTEGER
:

4954 
v
;

4955 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
¤c
, &
v
);

4956 
	`as£¹
(
”r
 >= 0);

4957 
	`¢d_cÚfig_£t_š‹g”
(*
d¡
, 
v
);

4960 
SND_CONFIG_TYPE_INTEGER64
:

4962 
v
;

4963 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”64
(
¤c
, &
v
);

4964 
	`as£¹
(
”r
 >= 0);

4965 
	`¢d_cÚfig_£t_š‹g”64
(*
d¡
, 
v
);

4968 
SND_CONFIG_TYPE_REAL
:

4970 
v
;

4971 
”r
 = 
	`¢d_cÚfig_g‘_»®
(
¤c
, &
v
);

4972 
	`as£¹
(
”r
 >= 0);

4973 
	`¢d_cÚfig_£t_»®
(*
d¡
, 
v
);

4976 
SND_CONFIG_TYPE_STRING
:

4978 cÚ¡ *
s
;

4979 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
¤c
, &
s
);

4980 
	`as£¹
(
”r
 >= 0);

4981 
”r
 = 
	`¢d_cÚfig_£t_¡ršg
(*
d¡
, 
s
);

4982 ià(
”r
 < 0)

4983  
”r
;

4987 
	`as£¹
(0);

4994 
	}
}

5014 
	$¢d_cÚfig_cİy
(
¢d_cÚfig_t
 **
d¡
,

5015 
¢d_cÚfig_t
 *
¤c
)

5017  
	`¢d_cÚfig_w®k
(
¤c
, 
NULL
, 
d¡
, 
_¢d_cÚfig_cİy
, NULL, NULL);

5018 
	}
}

5020 
	$_¢d_cÚfig_ex·nd_v¬s
(
¢d_cÚfig_t
 **
d¡
, cÚ¡ *
s
, *
´iv©e_d©a
)

5022 
¢d_cÚfig_t
 *
v®
, *
v¬s
 = 
´iv©e_d©a
;

5023 ià(
	`¢d_cÚfig_£¬ch
(
v¬s
, 
s
, &
v®
) < 0) {

5024 *
d¡
 = 
NULL
;

5027  
	`¢d_cÚfig_cİy
(
d¡
, 
v®
);

5028 
	}
}

5030 
	$_¢d_cÚfig_ex·nd
(
¢d_cÚfig_t
 *
¤c
,

5031 
¢d_cÚfig_t
 *
roÙ
 
ATTRIBUTE_UNUSED
,

5032 
¢d_cÚfig_t
 **
d¡
,

5033 
¢d_cÚfig_w®k_·ss_t
 
·ss
,

5034 
¢d_cÚfig_ex·nd_fú_t
 
fú
,

5035 *
´iv©e_d©a
)

5037 
”r
;

5038 cÚ¡ *
id
 = 
¤c
->id;

5039 
¢d_cÚfig_ty³_t
 
ty³
 = 
	`¢d_cÚfig_g‘_ty³
(
¤c
);

5040 
·ss
) {

5041 
SND_CONFIG_WALK_PASS_PRE
:

5043 ià(
id
 && 
	`¡rcmp
(id, "@args") == 0)

5045 
”r
 = 
	`¢d_cÚfig_make_compound
(
d¡
, 
id
, 
¤c
->
u
.
compound
.
još
);

5046 ià(
”r
 < 0)

5047  
”r
;

5050 
SND_CONFIG_WALK_PASS_LEAF
:

5051 
ty³
) {

5052 
SND_CONFIG_TYPE_INTEGER
:

5054 
v
;

5055 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
¤c
, &
v
);

5056 
	`as£¹
(
”r
 >= 0);

5057 
”r
 = 
	`¢d_cÚfig_imake_š‹g”
(
d¡
, 
id
, 
v
);

5058 ià(
”r
 < 0)

5059  
”r
;

5062 
SND_CONFIG_TYPE_INTEGER64
:

5064 
v
;

5065 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”64
(
¤c
, &
v
);

5066 
	`as£¹
(
”r
 >= 0);

5067 
”r
 = 
	`¢d_cÚfig_imake_š‹g”64
(
d¡
, 
id
, 
v
);

5068 ià(
”r
 < 0)

5069  
”r
;

5072 
SND_CONFIG_TYPE_REAL
:

5074 
v
;

5075 
”r
 = 
	`¢d_cÚfig_g‘_»®
(
¤c
, &
v
);

5076 
	`as£¹
(
”r
 >= 0);

5077 
”r
 = 
	`¢d_cÚfig_imake_»®
(
d¡
, 
id
, 
v
);

5078 ià(
”r
 < 0)

5079  
”r
;

5082 
SND_CONFIG_TYPE_STRING
:

5084 cÚ¡ *
s
;

5085 
¢d_cÚfig_t
 *
v¬s
 = 
´iv©e_d©a
;

5086 
	`¢d_cÚfig_g‘_¡ršg
(
¤c
, &
s
);

5087 ià(
s
 && *s == '$') {

5088 
”r
 = 
	`¢d_cÚfig_ev®u©e_¡ršg
(
d¡
, 
s
, 
fú
, 
v¬s
);

5089 ià(
”r
 < 0)

5090  
”r
;

5091 ià(*
d¡
 =ğ
NULL
)

5093 
”r
 = 
	`¢d_cÚfig_£t_id
(*
d¡
, 
id
);

5094 ià(
”r
 < 0) {

5095 
	`¢d_cÚfig_d–‘e
(*
d¡
);

5096  
”r
;

5099 
”r
 = 
	`¢d_cÚfig_imake_¡ršg
(
d¡
, 
id
, 
s
);

5100 ià(
”r
 < 0)

5101  
”r
;

5106 
	`as£¹
(0);

5113 
	}
}

5115 
	$_¢d_cÚfig_ev®u©e
(
¢d_cÚfig_t
 *
¤c
,

5116 
¢d_cÚfig_t
 *
roÙ
,

5117 
¢d_cÚfig_t
 **
d¡
 
ATTRIBUTE_UNUSED
,

5118 
¢d_cÚfig_w®k_·ss_t
 
·ss
,

5119 
¢d_cÚfig_ex·nd_fú_t
 
fú
 
ATTRIBUTE_UNUSED
,

5120 *
´iv©e_d©a
)

5122 
”r
;

5123 ià(
·ss
 =ğ
SND_CONFIG_WALK_PASS_PRE
) {

5124 *
buf
 = 
NULL
, 
”rbuf
[256];

5125 cÚ¡ *
lib
 = 
NULL
, *
func_Çme
 = NULL;

5126 cÚ¡ *
¡r
;

5127 (*
func
)(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
,

5128 
¢d_cÚfig_t
 *
¤c
, snd_cÚfig_ˆ*
´iv©e_d©a
èğ
NULL
;

5129 *
h
 = 
NULL
;

5130 
¢d_cÚfig_t
 *
c
, *
func_cÚf
 = 
NULL
;

5131 
”r
 = 
	`¢d_cÚfig_£¬ch
(
¤c
, "@func", &
c
);

5132 ià(
”r
 < 0)

5134 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
c
, &
¡r
);

5135 ià(
”r
 < 0) {

5136 
	`SNDERR
("Invalidype for @func");

5137  
”r
;

5139 
	`as£¹
(
¡r
);

5140 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "func", 
¡r
, &
func_cÚf
);

5141 ià(
”r
 >= 0) {

5142 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

5143 ià(
	`¢d_cÚfig_g‘_ty³
(
func_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

5144 
	`SNDERR
("Inv®idy³ fÜ funø% defš™iÚ", 
¡r
);

5145 
”r
 = -
EINVAL
;

5146 
_”r
;

5148 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
func_cÚf
) {

5149 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

5150 cÚ¡ *
id
 = 
n
->id;

5151 ià(
	`¡rcmp
(
id
, "comment") == 0)

5153 ià(
	`¡rcmp
(
id
, "lib") == 0) {

5154 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
lib
);

5155 ià(
”r
 < 0) {

5156 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

5157 
_”r
;

5161 ià(
	`¡rcmp
(
id
, "func") == 0) {

5162 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
func_Çme
);

5163 ià(
”r
 < 0) {

5164 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

5165 
_”r
;

5169 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

5172 ià(!
func_Çme
) {

5173 
Ën
 = 9 + 
	`¡¾’
(
¡r
) + 1;

5174 
buf
 = 
	`m®loc
(
Ën
);

5175 ià(! 
buf
) {

5176 
”r
 = -
ENOMEM
;

5177 
_”r
;

5179 
	`¢´štf
(
buf
, 
Ën
, "¢d_func_%s", 
¡r
);

5180 
buf
[
Ën
-1] = '\0';

5181 
func_Çme
 = 
buf
;

5183 
h
 = 
	`INTERNAL
(
¢d_dlİ’
)(
lib
, 
RTLD_NOW
, 
”rbuf
, (errbuf));

5184 ià(
h
)

5185 
func
 = 
	`¢d_dlsym
(
h
, 
func_Çme
, 
	`SND_DLSYM_VERSION
(
SND_CONFIG_DLSYM_VERSION_EVALUATE
));

5186 
”r
 = 0;

5187 ià(!
h
) {

5188 
	`SNDERR
("CªnÙ o³Àsh¬ed†ib¿ry % (%s)", 
lib
, 
”rbuf
);

5189 
”r
 = -
ENOENT
;

5190 
_”rbuf
;

5191 } ià(!
func
) {

5192 
	`SNDERR
("symbŞ % i nÙ defšed insid%s", 
func_Çme
, 
lib
);

5193 
	`¢d_dlşo£
(
h
);

5194 
”r
 = -
ENXIO
;

5195 
_”rbuf
;

5197 
_”r
:

5198 ià(
func_cÚf
)

5199 
	`¢d_cÚfig_d–‘e
(
func_cÚf
);

5200 ià(
”r
 >= 0) {

5201 
¢d_cÚfig_t
 *
ev®
;

5202 
”r
 = 
	`func
(&
ev®
, 
roÙ
, 
¤c
, 
´iv©e_d©a
);

5203 ià(
”r
 < 0)

5204 
	`SNDERR
("funùiÚ % »tuºedƒ¼Ü: %s", 
func_Çme
, 
	`¢d_¡»¼Ü
(
”r
));

5205 
	`¢d_dlşo£
(
h
);

5206 ià(
”r
 >ğ0 && 
ev®
)

5207 
”r
 = 
	`¢d_cÚfig_sub¡™u‹
(
¤c
, 
ev®
);

5209 
_”rbuf
:

5210 
	`ä“
(
buf
);

5211 ià(
”r
 < 0)

5212  
”r
;

5216 
	}
}

5229 
	$¢d_cÚfig_ev®u©e
(
¢d_cÚfig_t
 *
cÚfig
, snd_cÚfig_ˆ*
roÙ
,

5230 
¢d_cÚfig_t
 *
´iv©e_d©a
, snd_cÚfig_ˆ**
»suÉ
)

5233 
	`as£¹
(
»suÉ
 =ğ
NULL
);

5234  
	`¢d_cÚfig_w®k
(
cÚfig
, 
roÙ
, 
»suÉ
, 
_¢d_cÚfig_ev®u©e
, 
NULL
, 
´iv©e_d©a
);

5235 
	}
}

5237 
	$lßd_deçuÉs
(
¢d_cÚfig_t
 *
subs
, snd_cÚfig_ˆ*
defs
)

5239 
¢d_cÚfig_™”©Ü_t
 
d
, 
dÃxt
;

5240 
	`¢d_cÚfig_fÜ_—ch
(
d
, 
dÃxt
, 
defs
) {

5241 
¢d_cÚfig_t
 *
def
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
d
);

5242 
¢d_cÚfig_™”©Ü_t
 
f
, 
âext
;

5243 ià(
	`¢d_cÚfig_g‘_ty³
(
def
è!ğ
SND_CONFIG_TYPE_COMPOUND
)

5245 
	`¢d_cÚfig_fÜ_—ch
(
f
, 
âext
, 
def
) {

5246 
¢d_cÚfig_t
 *
æd
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
f
);

5247 cÚ¡ *
id
 = 
æd
->id;

5248 ià(
	`¡rcmp
(
id
, "type") == 0)

5250 ià(
	`¡rcmp
(
id
, "default") == 0) {

5251 
¢d_cÚfig_t
 *
deæt
;

5252 
”r
;

5253 
”r
 = 
	`¢d_cÚfig_cİy
(&
deæt
, 
æd
);

5254 ià(
”r
 < 0)

5255  
”r
;

5256 
”r
 = 
	`¢d_cÚfig_£t_id
(
deæt
, 
def
->
id
);

5257 ià(
”r
 < 0) {

5258 
	`¢d_cÚfig_d–‘e
(
deæt
);

5259  
”r
;

5261 
”r
 = 
	`¢d_cÚfig_add
(
subs
, 
deæt
);

5262 ià(
”r
 < 0) {

5263 
	`¢d_cÚfig_d–‘e
(
deæt
);

5264  
”r
;

5268 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

5269  -
EINVAL
;

5273 
	}
}

5275 
	$sk_bÏnk
(cÚ¡ **
±r
)

5278 **
±r
) {

5288 (*
±r
)++;

5290 
	}
}

5292 
	$·r£_ch¬
(cÚ¡ **
±r
)

5294 
c
;

5295 
	`as£¹
(**
±r
 == '\\');

5296 (*
±r
)++;

5297 
c
 = **
±r
;

5298 
c
) {

5300 
c
 = '\n';

5303 
c
 = '\t';

5306 
c
 = '\v';

5309 
c
 = '\b';

5312 
c
 = '\r';

5315 
c
 = '\f';

5320 
num
 = 
c
 - '0';

5321 
i
 = 1;

5322 (*
±r
)++;

5324 
c
 = **
±r
;

5325 ià(
c
 < '0' || c > '7')

5327 
num
 =‚um * 8 + 
c
 - '0';

5328 
i
++;

5329 (*
±r
)++;

5330 } 
i
 < 3);

5331  
num
;

5336 (*
±r
)++;

5337  
c
;

5338 
	}
}

5340 
	$·r£_id
(cÚ¡ **
±r
)

5342 ià(!**
±r
)

5343  -
EINVAL
;

5345 **
±r
) {

5357 (*
±r
)++;

5359 
	}
}

5361 
	$·r£_¡ršg
(cÚ¡ **
±r
, **
v®
)

5363 cÚ¡ 
size_t
 
bufsize
 = 256;

5364 
_buf
[
bufsize
];

5365 *
buf
 = 
_buf
;

5366 
size_t
 
®loc
 = 
bufsize
;

5367 
d–im
 = **
±r
;

5368 
size_t
 
idx
 = 0;

5369 (*
±r
)++;

5371 
c
 = **
±r
;

5372 
c
) {

5374 
	`SNDERR
("Unterminated string");

5375  -
EINVAL
;

5377 
c
 = 
	`·r£_ch¬
(
±r
);

5378 ià(
c
 < 0) {

5379 ià(
®loc
 > 
bufsize
)

5380 
	`ä“
(
buf
);

5381  
c
;

5385 (*
±r
)++;

5386 ià(
c
 =ğ
d–im
) {

5387 *
v®
 = 
	`m®loc
(
idx
 + 1);

5388 ià(!*
v®
)

5389  -
ENOMEM
;

5390 
	`memıy
(*
v®
, 
buf
, 
idx
);

5391 (*
v®
)[
idx
] = 0;

5392 ià(
®loc
 > 
bufsize
)

5393 
	`ä“
(
buf
);

5397 ià(
idx
 >ğ
®loc
) {

5398 
size_t
 
Şd_®loc
 = 
®loc
;

5399 
®loc
 *= 2;

5400 ià(
Şd_®loc
 =ğ
bufsize
) {

5401 
buf
 = 
	`m®loc
(
®loc
);

5402 ià(!
buf
)

5403  -
ENOMEM
;

5404 
	`memıy
(
buf
, 
_buf
, 
Şd_®loc
);

5406 *
buf2
 = 
	`»®loc
(
buf
, 
®loc
);

5407 ià(!
buf2
) {

5408 
	`ä“
(
buf
);

5409  -
ENOMEM
;

5411 
buf
 = 
buf2
;

5414 
buf
[
idx
++] = 
c
;

5416 
	}
}

5420 
	$·r£_¬g
(cÚ¡ **
±r
, *
v¬Ën
, **
v®
)

5422 cÚ¡ *
¡r
;

5423 
”r
, 
v®Ën
;

5424 
	`sk_bÏnk
(
±r
);

5425 
¡r
 = *
±r
;

5426 ià(*
¡r
 == '"' || *str == '\'') {

5427 
”r
 = 
	`·r£_¡ršg
(
±r
, 
v®
);

5428 ià(
”r
 < 0)

5429  
”r
;

5430 *
v¬Ën
 = 0;

5433 
”r
 = 
	`·r£_id
(
±r
);

5434 ià(
”r
 < 0)

5435  
”r
;

5436 
v®Ën
 = *
±r
 - 
¡r
;

5437 
	`sk_bÏnk
(
±r
);

5438 ià(**
±r
 != '=') {

5439 *
v¬Ën
 = 0;

5440 
_v®ue
;

5442 *
v¬Ën
 = 
v®Ën
;

5443 (*
±r
)++;

5444 
	`sk_bÏnk
(
±r
);

5445 
¡r
 = *
±r
;

5446 ià(*
¡r
 == '"' || *str == '\'') {

5447 
”r
 = 
	`·r£_¡ršg
(
±r
, 
v®
);

5448 ià(
”r
 < 0)

5449  
”r
;

5452 
”r
 = 
	`·r£_id
(
±r
);

5453 ià(
”r
 < 0)

5454  
”r
;

5455 
v®Ën
 = *
±r
 - 
¡r
;

5456 
_v®ue
:

5457 *
v®
 = 
	`m®loc
(
v®Ën
 + 1);

5458 ià(!*
v®
)

5459  -
ENOMEM
;

5460 
	`memıy
(*
v®
, 
¡r
, 
v®Ën
);

5461 (*
v®
)[
v®Ën
] = 0;

5463 
	}
}

5470 
	$·r£_¬gs
(
¢d_cÚfig_t
 *
subs
, cÚ¡ *
¡r
, snd_cÚfig_ˆ*
defs
)

5472 
”r
;

5473 
¬g
 = 0;

5474 ià(
¡r
 =ğ
NULL
)

5476 
	`sk_bÏnk
(&
¡r
);

5477 ià(!*
¡r
)

5479 ià(*
¡r
 == '{') {

5480 
Ën
 = 
	`¡¾’
(
¡r
);

5481 
¢d_šput_t
 *
šput
;

5482 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

5484 
¡r
[--
Ën
]) {

5496 ià(
¡r
[
Ën
] != '}')

5497  -
EINVAL
;

5498 
”r
 = 
	`¢d_šput_bufãr_İ’
(&
šput
, 
¡r
 + 1, 
Ën
 - 1);

5499 ià(
”r
 < 0)

5500  
”r
;

5501 
”r
 = 
	`¢d_cÚfig_lßd_ov”ride
(
subs
, 
šput
);

5502 
	`¢d_šput_şo£
(
šput
);

5503 ià(
”r
 < 0)

5504  
”r
;

5505 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
subs
) {

5506 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

5507 
¢d_cÚfig_t
 *
d
;

5508 cÚ¡ *
id
 = 
n
->id;

5509 
”r
 = 
	`¢d_cÚfig_£¬ch
(
defs
, 
id
, &
d
);

5510 ià(
”r
 < 0) {

5511 
	`SNDERR
("UnknowÀ·¿m‘” %s", 
id
);

5512  
”r
;

5519 
buf
[256];

5520 cÚ¡ *
v¬
 = 
buf
;

5521 
v¬Ën
;

5522 
¢d_cÚfig_t
 *
def
, *
sub
, *
typ
;

5523 cÚ¡ *
Ãw
 = 
¡r
;

5524 cÚ¡ *
tmp
;

5525 *
v®
 = 
NULL
;

5527 
sub
 = 
NULL
;

5528 
”r
 = 
	`·r£_¬g
(&
Ãw
, &
v¬Ën
, &
v®
);

5529 ià(
”r
 < 0)

5530 
_”r
;

5531 ià(
v¬Ën
 > 0) {

5532 
	`as£¹
(
v¬Ën
 < (
buf
));

5533 
	`memıy
(
buf
, 
¡r
, 
v¬Ën
);

5534 
buf
[
v¬Ën
] = 0;

5536 
	`¥rštf
(
buf
, "%d", 
¬g
);

5538 
”r
 = 
	`¢d_cÚfig_£¬ch_®Ÿs
(
defs
, 
NULL
, 
v¬
, &
def
);

5539 ià(
”r
 < 0) {

5540 
	`SNDERR
("UnknowÀ·¿m‘” %s", 
v¬
);

5541 
_”r
;

5543 ià(
	`¢d_cÚfig_g‘_ty³
(
def
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

5544 
	`SNDERR
("P¬am‘” % defš™iÚ i nÙ cÜ»ù", 
v¬
);

5545 
”r
 = -
EINVAL
;

5546 
_”r
;

5548 
v¬
 = 
def
->
id
;

5549 
”r
 = 
	`¢d_cÚfig_£¬ch
(
subs
, 
v¬
, &
sub
);

5550 ià(
”r
 >= 0)

5551 
	`¢d_cÚfig_d–‘e
(
sub
);

5552 
sub
 = 
NULL
;

5553 
”r
 = 
	`¢d_cÚfig_£¬ch
(
def
, "ty³", &
typ
);

5554 ià(
”r
 < 0) {

5555 
_šv®id_ty³
:

5556 
	`SNDERR
("P¬am‘” % defš™iÚ i missšg‡ v®idy³ info", 
v¬
);

5557 
_”r
;

5559 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
typ
, &
tmp
);

5560 ià(
”r
 < 0 || !
tmp
)

5561 
_šv®id_ty³
;

5562 ià(
	`¡rcmp
(
tmp
, "integer") == 0) {

5563 
v
;

5564 
”r
 = 
	`¢d_cÚfig_make
(&
sub
, 
v¬
, 
SND_CONFIG_TYPE_INTEGER
);

5565 ià(
”r
 < 0)

5566 
_”r
;

5567 
”r
 = 
	`§ã_¡¹Ş
(
v®
, &
v
);

5568 ià(
”r
 < 0) {

5569 
	`SNDERR
("P¬am‘” % mu¡ bª iÁeg”", 
v¬
);

5570 
_”r
;

5572 
”r
 = 
	`¢d_cÚfig_£t_š‹g”
(
sub
, 
v
);

5573 ià(
”r
 < 0)

5574 
_”r
;

5575 } ià(
	`¡rcmp
(
tmp
, "integer64") == 0) {

5576 
v
;

5577 
”r
 = 
	`¢d_cÚfig_make
(&
sub
, 
v¬
, 
SND_CONFIG_TYPE_INTEGER64
);

5578 ià(
”r
 < 0)

5579 
_”r
;

5580 
”r
 = 
	`§ã_¡¹Şl
(
v®
, &
v
);

5581 ià(
”r
 < 0) {

5582 
	`SNDERR
("P¬am‘” % mu¡ bª iÁeg”", 
v¬
);

5583 
_”r
;

5585 
”r
 = 
	`¢d_cÚfig_£t_š‹g”64
(
sub
, 
v
);

5586 ià(
”r
 < 0)

5587 
_”r
;

5588 } ià(
	`¡rcmp
(
tmp
, "real") == 0) {

5589 
v
;

5590 
”r
 = 
	`¢d_cÚfig_make
(&
sub
, 
v¬
, 
SND_CONFIG_TYPE_REAL
);

5591 ià(
”r
 < 0)

5592 
_”r
;

5593 
”r
 = 
	`§ã_¡¹od
(
v®
, &
v
);

5594 ià(
”r
 < 0) {

5595 
	`SNDERR
("P¬am‘” % mu¡ b¨»®", 
v¬
);

5596 
_”r
;

5598 
”r
 = 
	`¢d_cÚfig_£t_»®
(
sub
, 
v
);

5599 ià(
”r
 < 0)

5600 
_”r
;

5601 } ià(
	`¡rcmp
(
tmp
, "string") == 0) {

5602 
”r
 = 
	`¢d_cÚfig_make
(&
sub
, 
v¬
, 
SND_CONFIG_TYPE_STRING
);

5603 ià(
”r
 < 0)

5604 
_”r
;

5605 
”r
 = 
	`¢d_cÚfig_£t_¡ršg
(
sub
, 
v®
);

5606 ià(
”r
 < 0)

5607 
_”r
;

5609 
”r
 = -
EINVAL
;

5610 
_šv®id_ty³
;

5612 
”r
 = 
	`¢d_cÚfig_£t_id
(
sub
, 
v¬
);

5613 ià(
”r
 < 0)

5614 
_”r
;

5615 
”r
 = 
	`¢d_cÚfig_add
(
subs
, 
sub
);

5616 ià(
”r
 < 0) {

5617 
_”r
:

5618 ià(
sub
)

5619 
	`¢d_cÚfig_d–‘e
(
sub
);

5620 
	`ä“
(
v®
);

5621  
”r
;

5623 
	`ä“
(
v®
);

5624 ià(!*
Ãw
)

5626 ià(*
Ãw
 != ',')

5627  -
EINVAL
;

5628 
¡r
 = 
Ãw
 + 1;

5629 
¬g
++;

5632 
	}
}

5653 
	$¢d_cÚfig_ex·nd_cu¡om
(
¢d_cÚfig_t
 *
cÚfig
, snd_cÚfig_ˆ*
roÙ
,

5654 
¢d_cÚfig_ex·nd_fú_t
 
fú
, *
´iv©e_d©a
,

5655 
¢d_cÚfig_t
 **
»suÉ
)

5657 
¢d_cÚfig_t
 *
»s
;

5658 
”r
;

5660 
”r
 = 
	`¢d_cÚfig_w®k
(
cÚfig
, 
roÙ
, &
»s
, 
_¢d_cÚfig_ex·nd
, 
fú
, 
´iv©e_d©a
);

5661 ià(
”r
 < 0) {

5662 
	`SNDERR
("Ex·ndƒ¼Ü (w®k): %s", 
	`¢d_¡»¼Ü
(
”r
));

5663  
”r
;

5665 *
»suÉ
 = 
»s
;

5667 
	}
}

5686 
	$¢d_cÚfig_ex·nd
(
¢d_cÚfig_t
 *
cÚfig
, snd_cÚfig_ˆ*
roÙ
, cÚ¡ *
¬gs
,

5687 
¢d_cÚfig_t
 *
´iv©e_d©a
, snd_cÚfig_ˆ**
»suÉ
)

5689 
”r
;

5690 
¢d_cÚfig_t
 *
defs
, *
subs
 = 
NULL
, *
»s
;

5691 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cÚfig
, "@¬gs", &
defs
);

5692 ià(
”r
 < 0) {

5693 ià(
¬gs
 !ğ
NULL
) {

5694 
	`SNDERR
("UnknowÀ·¿m‘” %s", 
¬gs
);

5695  -
EINVAL
;

5697 
”r
 = 
	`¢d_cÚfig_cİy
(&
»s
, 
cÚfig
);

5698 ià(
”r
 < 0)

5699  
”r
;

5701 
”r
 = 
	`¢d_cÚfig_tİ
(&
subs
);

5702 ià(
”r
 < 0)

5703  
”r
;

5704 
”r
 = 
	`lßd_deçuÉs
(
subs
, 
defs
);

5705 ià(
”r
 < 0) {

5706 
	`SNDERR
("Lßd deçuÉ ”rÜ: %s", 
	`¢d_¡»¼Ü
(
”r
));

5707 
_’d
;

5709 
”r
 = 
	`·r£_¬gs
(
subs
, 
¬gs
, 
defs
);

5710 ià(
”r
 < 0) {

5711 
	`SNDERR
("P¬£‡rgum’t ”rÜ: %s", 
	`¢d_¡»¼Ü
(
”r
));

5712 
_’d
;

5714 
”r
 = 
	`¢d_cÚfig_ev®u©e
(
subs
, 
roÙ
, 
´iv©e_d©a
, 
NULL
);

5715 ià(
”r
 < 0) {

5716 
	`SNDERR
("Arg ev®u©”rÜ: %s", 
	`¢d_¡»¼Ü
(
”r
));

5717 
_’d
;

5719 
”r
 = 
	`¢d_cÚfig_w®k
(
cÚfig
, 
roÙ
, &
»s
, 
_¢d_cÚfig_ex·nd
, 
_¢d_cÚfig_ex·nd_v¬s
, 
subs
);

5720 ià(
”r
 < 0) {

5721 
	`SNDERR
("Ex·ndƒ¼Ü (w®k): %s", 
	`¢d_¡»¼Ü
(
”r
));

5722 
_’d
;

5725 
”r
 = 
	`¢d_cÚfig_ev®u©e
(
»s
, 
roÙ
, 
´iv©e_d©a
, 
NULL
);

5726 ià(
”r
 < 0) {

5727 
	`SNDERR
("Ev®u©”rÜ: %s", 
	`¢d_¡»¼Ü
(
”r
));

5728 
	`¢d_cÚfig_d–‘e
(
»s
);

5729 
_’d
;

5731 *
»suÉ
 = 
»s
;

5732 
”r
 = 1;

5733 
_’d
:

5734 ià(
subs
)

5735 
	`¢d_cÚfig_d–‘e
(
subs
);

5736  
”r
;

5737 
	}
}

5768 
	$¢d_cÚfig_£¬ch_defš™iÚ
(
¢d_cÚfig_t
 *
cÚfig
,

5769 cÚ¡ *
ba£
, cÚ¡ *
Çme
,

5770 
¢d_cÚfig_t
 **
»suÉ
)

5772 
¢d_cÚfig_t
 *
cÚf
;

5773 *
key
;

5774 cÚ¡ *
¬gs
 = 
	`¡rchr
(
Çme
, ':');

5775 
”r
;

5776 ià(
¬gs
) {

5777 
¬gs
++;

5778 
key
 = 
	`®loÿ
(
¬gs
 - 
Çme
);

5779 
	`memıy
(
key
, 
Çme
, 
¬gs
 -‚ame - 1);

5780 
key
[
¬gs
 - 
Çme
 - 1] = '\0';

5782 
key
 = (*è
Çme
;

5788 
	`¢d_cÚfig_lock
();

5789 
”r
 = 
	`¢d_cÚfig_£¬ch_®Ÿs_hooks
(
cÚfig
, 
	`¡rchr
(
key
, '.'è? 
NULL
 : 
ba£
, key, &
cÚf
);

5790 ià(
”r
 < 0) {

5791 
	`¢d_cÚfig_uÆock
();

5792  
”r
;

5794 
”r
 = 
	`¢d_cÚfig_ex·nd
(
cÚf
, 
cÚfig
, 
¬gs
, 
NULL
, 
»suÉ
);

5795 
	`¢d_cÚfig_uÆock
();

5796  
”r
;

5797 
	}
}

5799 #iâdeà
DOC_HIDDEN


5800 
	$¢d_cÚfig_£t_hİ
(
¢d_cÚfig_t
 *
cÚf
, 
hİ
)

5802 
cÚf
->
hİ
 = hop;

5803 
	}
}

5805 
	$¢d_cÚfig_check_hİ
(
¢d_cÚfig_t
 *
cÚf
)

5807 ià(
cÚf
) {

5808 ià(
cÚf
->
hİ
 >ğ
SND_CONF_MAX_HOPS
) {

5809 
	`SYSERR
("Too many definition†evels (looped?)\n");

5810  -
EINVAL
;

5812  
cÚf
->
hİ
;

5815 
	}
}

5820 
	$_¢d_cÚfig_’d
(è
	`__©Œibu‹__
 ((
de¡ruùÜ
));

5822 
	$_¢d_cÚfig_’d
()

5824 
k
;

5825 ià(
¢d_cÚfig
)

5826 
	`¢d_cÚfig_d–‘e
(
¢d_cÚfig
);

5827 
¢d_cÚfig
 = 0;

5828 
k
 = 0; k < 
fes_šfo_couÁ
; ++k)

5829 
	`ä“
(
fes_šfo
[
k
].
Çme
);

5830 
	`ä“
(
fes_šfo
);

5831 
fes_šfo
 = 
NULL
;

5832 
fes_šfo_couÁ
 = 0;

5833 
	}
}

5836 #iâdeà
DOC_HIDDEN


5837 
size_t
 
	$·ge_size
()

5839 
s
 = 
	`syscÚf
(
_SC_PAGE_SIZE
);

5840 
	`as£¹
(
s
 > 0);

5841  
s
;

5842 
	}
}

5844 
size_t
 
	$·ge_®ign
(
size_t
 
size
)

5846 
size_t
 
r
;

5847 
psz
 = 
	`·ge_size
();

5848 
r
 = 
size
 % 
psz
;

5849 ià(
r
)

5850  
size
 + 
psz
 - 
r
;

5851  
size
;

5852 
	}
}

5854 
size_t
 
	$·ge_±r
(
size_t
 
objeù_off£t
, size_ˆ
objeù_size
, size_ˆ*
off£t
, size_ˆ*
mm­_off£t
)

5856 
size_t
 
r
;

5857 
psz
 = 
	`·ge_size
();

5858 
	`as£¹
(
off£t
);

5859 
	`as£¹
(
mm­_off£t
);

5860 *
mm­_off£t
 = 
objeù_off£t
;

5861 
objeù_off£t
 %ğ
psz
;

5862 *
mm­_off£t
 -ğ
objeù_off£t
;

5863 
objeù_size
 +ğ
objeù_off£t
;

5864 
r
 = 
objeù_size
 % 
psz
;

5865 ià(
r
)

5866 
r
 = 
objeù_size
 + 
psz
 -„;

5868 
r
 = 
objeù_size
;

5869 *
off£t
 = 
objeù_off£t
;

5870  
r
;

5871 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/confeval.c

34 
	~"loÿl.h
"

35 
	~<¡dlib.h
>

36 
	~<¡dio.h
>

37 
	~<¡ršg.h
>

38 
	~<ùy³.h
>

39 
	~<lim™s.h
>

41 #iâdeà
DOC_HIDDEN


42 
	tv®ue_ty³_t
;

45 cÚ¡ *
	$_fšd_’d_of_ex´essiÚ
(cÚ¡ *
s
, 
begš
, 
’d
)

47 
couÁ
 = 1;

48 *
s
) {

49 ià(*
s
 =ğ
begš
) {

50 
couÁ
++;

51 } ià(*
s
 =ğ
’d
) {

52 
couÁ
--;

53 ià(
couÁ
 == 0)

54  
s
 + 1;

56 
s
++;

58  
NULL
;

59 
	}
}

61 
	$_·r£_š‹g”
(
v®ue_ty³_t
 *
v®
, cÚ¡ **
s
)

63 
v
;

64 *
’d
;

66 
”ºo
 = 0;

67 
v
 = 
	`¡¹Şl
(*
s
, &
’d
, 0);

68 ià(
”ºo
)

69  -
”ºo
;

70 *
v®
 = 
v
;

71 ià((()*
v®
è!ğ
v
)

72  -
ERANGE
;

73 *
s
 = 
’d
;

75 
	}
}

77 
	$_to_š‹g”
(
v®ue_ty³_t
 *
v®
, 
¢d_cÚfig_t
 *
c
)

79 
”r
;

81 
	`¢d_cÚfig_g‘_ty³
(
c
)) {

82 
SND_CONFIG_TYPE_INTEGER
:

84 
v
;

85 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
c
, &
v
);

86 ià(
”r
 >= 0)

87 *
v®
 = 
v
;

90 
SND_CONFIG_TYPE_INTEGER64
:

92 
v
;

93 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”64
(
c
, &
v
);

94 ià(
”r
 >= 0) {

95 *
v®
 = 
v
;

96 ià((()*
v®
è!ğ
v
)

97  -
ERANGE
;

102 
SND_CONFIG_TYPE_STRING
:

104 cÚ¡ *
s
;

105 
v
;

106 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
c
, &
s
);

107 ià(
”r
 >= 0) {

108 
”r
 = 
	`§ã_¡¹Şl
(
s
, &
v
);

109 ià(
”r
 >= 0) {

110 *
v®
 = 
v
;

111 ià((()*
v®
è!ğ
v
)

112  -
ERANGE
;

119  -
EINVAL
;

121  
”r
;

122 
	}
}

124 #iâdeà
DOC_HIDDEN


125 
	$_¢d_ev®_¡ršg
(
¢d_cÚfig_t
 **
d¡
, cÚ¡ *
s
,

126 
¢d_cÚfig_ex·nd_fú_t
 
fú
, *
´iv©e_d©a
)

128 
¢d_cÚfig_t
 *
tmp
;

129 cÚ¡ *
§ve
, *
e
;

130 *
m
;

131 
v®ue_ty³_t
 
Ëá
, 
right
;

132 
”r
, 
c
, 
İ
, 
off
;

134 
LEFT
,

135 
OP
,

136 
RIGHT
,

137 
END


138 } 
pos
;

140 *
s
 && *s <= ' ') s++;

141 
§ve
 = 
s
;

142 
pos
 = 
LEFT
;

143 
İ
 = 0;

144 *
s
) {

145 *
s
 && *s <= ' ') s++;

146 
c
 = *
s
;

147 ià(
c
 == '\0')

149 ià(
pos
 =ğ
END
) {

150 
	`SNDERR
("uÃx³ùedƒx´essiÚa '%s'", 
s
);

151  -
EINVAL
;

153 ià(
pos
 =ğ
OP
) {

154 
c
) {

161 '&': 
İ
 = 
c
; ;

163 
	`SNDERR
("unknowÀİ”©iÚ '%c'", 
c
);

164  -
EINVAL
;

166 
pos
 = 
RIGHT
;

167 
s
++;

170 ià(
c
 == '(') {

171 
e
 = 
	`_fšd_’d_of_ex´essiÚ
(
s
 + 1, '(', ')');

172 
off
 = 1;

173 
_ex´
;

174 } ià(
c
 == '$') {

175 ià(
s
[1] == '[') {

176 
e
 = 
	`_fšd_’d_of_ex´essiÚ
(
s
 + 2, '[', ']');

177 
off
 = 2;

178 
_ex´
:

179 ià(
e
 =ğ
NULL
)

180  -
EINVAL
;

181 
m
 = 
	`m®loc
(
e
 - 
s
 - (
off
 - 1));

182 ià(
m
 =ğ
NULL
)

183  -
ENOMEM
;

184 
	`memıy
(
m
, 
s
 + 
off
, 
e
 - s - off);

185 
m
[
e
 - 
s
 - (
off
 + 1)] = '\0';

186 
”r
 = 
	`_¢d_ev®_¡ršg
(&
tmp
, 
m
, 
fú
, 
´iv©e_d©a
);

187 
	`ä“
(
m
);

188 ià(
”r
 < 0)

189  
”r
;

190 
s
 = 
e
;

191 ià(*
s
)

192 
s
++;

194 
e
 = 
s
 + 1;

195 *
e
) {

196 ià(!
	`i§Êum
(*
e
) && *e != '_')

198 
e
++;

200 
m
 = 
	`m®loc
(
e
 - 
s
);

201 ià(
m
 =ğ
NULL
)

202  -
ENOMEM
;

203 
	`memıy
(
m
, 
s
 + 1, 
e
 - s - 1);

204 
m
[
e
 - 
s
 - 1] = '\0';

205 
”r
 = 
	`fú
(&
tmp
, 
m
, 
´iv©e_d©a
);

206 
	`ä“
(
m
);

207 ià(
”r
 < 0)

208  
”r
;

209 ià(
tmp
 =ğ
NULL
) {

210 
”r
 = 
	`¢d_cÚfig_imake_š‹g”
(&
tmp
, 
NULL
, 0);

211 ià(
”r
 < 0)

212  
”r
;

214 
s
 = 
e
;

216 
”r
 = 
	`_to_š‹g”
(
İ
 =ğ
LEFT
 ? &
Ëá
 : &
right
, 
tmp
);

217 
	`¢d_cÚfig_d–‘e
(
tmp
);

218 } ià(
c
 == '-' || (c >= '0' && c <= '9')) {

219 
”r
 = 
	`_·r£_š‹g”
(
İ
 =ğ
LEFT
 ? &
Ëá
 : &
right
, &
s
);

221  -
EINVAL
;

223 ià(
”r
 < 0)

224  
”r
;

225 
pos
 = 
İ
 =ğ
LEFT
 ? 
OP
 : 
END
;

227 ià(
pos
 !ğ
OP
 &&…o !ğ
END
) {

228 
	`SNDERR
("šcom¶‘ex´essiÚ '%s'", 
§ve
);

229  -
EINVAL
;

232 ià(
pos
 =ğ
END
) {

233 
İ
) {

234 '+': 
Ëá
 =†eá + 
right
; ;

235 '-': 
Ëá
 =†eá - 
right
; ;

236 '*': 
Ëá
 =†eá * 
right
; ;

237 '/': 
Ëá
 =†eá / 
right
; ;

238 '%': 
Ëá
 =†eá % 
right
; ;

239 '|': 
Ëá
 =†eá | 
right
; ;

240 '&': 
Ëá
 =†eá & 
right
; ;

241 :  -
EINVAL
;

245 ià(
Ëá
 > 
INT_MAX
 ||†eá < 
INT_MIN
)

246  
	`¢d_cÚfig_imake_š‹g”64
(
d¡
, 
NULL
, 
Ëá
);

248  
	`¢d_cÚfig_imake_š‹g”
(
d¡
, 
NULL
, 
Ëá
);

249 
	}
}

261 
	$¢d_cÚfig_ev®u©e_¡ršg
(
¢d_cÚfig_t
 **
d¡
, cÚ¡ *
s
,

262 
¢d_cÚfig_ex·nd_fú_t
 
fú
, *
´iv©e_d©a
)

264 
	`as£¹
(
d¡
 && 
s
);

265 
”r
;

267 ià(*
s
 != '$')

268  -
EINVAL
;

269 ià(
s
[1] == '[') {

270 
”r
 = 
	`_¢d_ev®_¡ršg
(
d¡
, 
s
, 
fú
, 
´iv©e_d©a
);

271 ià(
”r
 < 0)

272 
	`SNDERR
("wrÚgƒx´essiÚ '%s'", 
s
);

274 
”r
 = 
	`fú
(
d¡
, 
s
 + 1, 
´iv©e_d©a
);

276  
”r
;

277 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/confmisc.c

77 
	~"loÿl.h
"

78 
	~<¡dlib.h
>

79 
	~<¡dio.h
>

80 
	~<¡ršg.h
>

81 
	~<ùy³.h
>

82 
	~<lim™s.h
>

89 
	$¢d_cÚfig_g‘_boŞ_ascii
(cÚ¡ *
ascii
)

91 
k
;

93 cÚ¡ 
¡r
[8];

94 
v®
;

95 } 
b
[] = {

105 
k
 = 0; k < (
b
) / (*b); k++) {

106 ià(
	`¡rÿ£cmp
(
b
[
k
].
¡r
, 
ascii
) == 0)

107  
b
[
k
].
v®
;

109  -
EINVAL
;

110 
	}
}

117 
	$¢d_cÚfig_g‘_boŞ
(cÚ¡ 
¢d_cÚfig_t
 *
cÚf
)

119 
v
;

120 cÚ¡ *
¡r
, *
id
;

121 
”r
;

123 
”r
 = 
	`¢d_cÚfig_g‘_id
(
cÚf
, &
id
);

124 ià(
”r
 < 0)

125  
”r
;

126 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
cÚf
, &
v
);

127 ià(
”r
 >= 0) {

128 ià(
v
 < 0 || v > 1) {

129 
_šv®id_v®ue
:

130 
	`SNDERR
("Inv®id v®ufÜ %s", 
id
);

131  -
EINVAL
;

133  
v
;

135 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
cÚf
, &
¡r
);

136 ià(
”r
 < 0) {

137 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

138  -
EINVAL
;

140 
”r
 = 
	`¢d_cÚfig_g‘_boŞ_ascii
(
¡r
);

141 ià(
”r
 < 0)

142 
_šv®id_v®ue
;

143  
”r
;

144 
	}
}

151 
	$¢d_cÚfig_g‘_ÿrd
(cÚ¡ 
¢d_cÚfig_t
 *
cÚf
)

153 cÚ¡ *
¡r
, *
id
;

154 
v
;

155 
”r
;

157 ià(
	`¢d_cÚfig_g‘_š‹g”
(
cÚf
, &
v
) < 0) {

158 ià(
	`¢d_cÚfig_g‘_¡ršg
(
cÚf
, &
¡r
)) {

159 ià(
	`¢d_cÚfig_g‘_id
(
cÚf
, &
id
) >= 0)

160 
	`SNDERR
("Inv®id f›ld %s", 
id
);

161  -
EINVAL
;

163 
”r
 = 
	`¢d_ÿrd_g‘_šdex
(
¡r
);

164 ià(
”r
 < 0) {

165 
	`SNDERR
("CªnÙ g‘ c¬d index fÜ %s", 
¡r
);

166  
”r
;

168 
v
 = 
”r
;

170 ià(
v
 < 0 || v > 
INT_MAX
)

171  -
EINVAL
;

172  
v
;

173 
	}
}

180 
	$¢d_cÚfig_g‘_ùl_içû_ascii
(cÚ¡ *
ascii
)

182 
v
;

183 
¢d_ùl_–em_içû_t
 
idx
;

184 ià(
	`isdig™
(
ascii
[0])) {

185 ià(
	`§ã_¡¹Ş
(
ascii
, &
v
) >= 0) {

186 ià(
v
 < 0 || v > 
SND_CTL_ELEM_IFACE_LAST
)

187  -
EINVAL
;

188  
v
;

191 
idx
 = 0; idx <ğ
SND_CTL_ELEM_IFACE_LAST
; idx++) {

192 ià(
	`¡rÿ£cmp
(
	`¢d_ùl_–em_içû_Çme
(
idx
), 
ascii
) == 0)

193  
idx
;

195  -
EINVAL
;

196 
	}
}

203 
	$¢d_cÚfig_g‘_ùl_içû
(cÚ¡ 
¢d_cÚfig_t
 *
cÚf
)

205 
v
;

206 cÚ¡ *
¡r
, *
id
;

207 
”r
;

209 
”r
 = 
	`¢d_cÚfig_g‘_id
(
cÚf
, &
id
);

210 ià(
”r
 < 0)

211  
”r
;

212 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
cÚf
, &
v
);

213 ià(
”r
 >= 0) {

214 ià(
v
 < 0 || v > 
SND_CTL_ELEM_IFACE_LAST
) {

215 
_šv®id_v®ue
:

216 
	`SNDERR
("Inv®id v®ufÜ %s", 
id
);

217  -
EINVAL
;

219  
v
;

221 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
cÚf
, &
¡r
);

222 ià(
”r
 < 0) {

223 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

224  -
EINVAL
;

226 
”r
 = 
	`¢d_cÚfig_g‘_ùl_içû_ascii
(
¡r
);

227 ià(
”r
 < 0)

228 
_šv®id_v®ue
;

229  
”r
;

230 
	}
}

255 
	$¢d_func_g‘’v
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
, snd_cÚfig_ˆ*
¤c
,

256 
¢d_cÚfig_t
 *
´iv©e_d©a
)

258 
¢d_cÚfig_t
 *
n
, *
d
;

259 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

260 cÚ¡ *
»s
, *
id
;

261 *
def
 = 
NULL
;

262 
idx
 = 0, 
”r
, 
h™
;

264 
”r
 = 
	`¢d_cÚfig_£¬ch
(
¤c
, "v¬s", &
n
);

265 ià(
”r
 < 0) {

266 
	`SNDERR
("field vars‚ot found");

267 
__”rÜ
;

269 
”r
 = 
	`¢d_cÚfig_ev®u©e
(
n
, 
roÙ
, 
´iv©e_d©a
, 
NULL
);

270 ià(
”r
 < 0) {

271 
	`SNDERR
("errorƒvaluating vars");

272 
__”rÜ
;

274 
”r
 = 
	`¢d_cÚfig_£¬ch
(
¤c
, "deçuÉ", &
d
);

275 ià(
”r
 < 0) {

276 
	`SNDERR
("field default‚ot found");

277 
__”rÜ
;

279 
”r
 = 
	`¢d_cÚfig_ev®u©e
(
d
, 
roÙ
, 
´iv©e_d©a
, 
NULL
);

280 ià(
”r
 < 0) {

281 
	`SNDERR
("errorƒvaluating default");

282 
__”rÜ
;

284 
”r
 = 
	`¢d_cÚfig_g‘_ascii
(
d
, &
def
);

285 ià(
”r
 < 0) {

286 
	`SNDERR
("error getting field default");

287 
__”rÜ
;

290 
h™
 = 0;

291 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
n
) {

292 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

293 cÚ¡ *
±r
;

294 
i
;

295 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

297 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_STRING
) {

298 
	`SNDERR
("f›ld % i nÙ‡ sŒšg", 
id
);

299 
”r
 = -
EINVAL
;

300 
__”rÜ
;

302 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
i
);

303 ià(
”r
 < 0) {

304 
	`SNDERR
("id oàf›ld % i nÙ‡Àš‹g”", 
id
);

305 
”r
 = -
EINVAL
;

306 
__”rÜ
;

308 ià(
i
 =ğ
idx
) {

309 
idx
++;

310 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
±r
);

311 ià(
”r
 < 0) {

312 
	`SNDERR
("šv®id sŒšg fÜ id %s", 
id
);

313 
”r
 = -
EINVAL
;

314 
__”rÜ
;

316 
»s
 = 
	`g‘’v
(
±r
);

317 ià(
»s
 !ğ
NULL
 && *res != '\0')

318 
__ok
;

319 
h™
 = 1;

322 } 
h™
);

323 
»s
 = 
def
;

324 
__ok
:

325 
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
);

326 ià(
”r
 >= 0)

327 
”r
 = 
	`¢d_cÚfig_imake_¡ršg
(
d¡
, 
id
, 
»s
);

328 
__”rÜ
:

329 
	`ä“
(
def
);

330  
”r
;

331 
	}
}

332 #iâdeà
DOC_HIDDEN


333 
SND_DLSYM_BUILD_VERSION
(
¢d_func_g‘’v
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

355 
	$¢d_func_ig‘’v
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
, snd_cÚfig_ˆ*
¤c
,

356 
¢d_cÚfig_t
 *
´iv©e_d©a
)

358 
¢d_cÚfig_t
 *
d
;

359 cÚ¡ *
¡r
, *
id
;

360 
”r
;

361 
v
;

363 
”r
 = 
	`¢d_func_g‘’v
(&
d
, 
roÙ
, 
¤c
, 
´iv©e_d©a
);

364 ià(
”r
 < 0)

365  
”r
;

366 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
d
, &
¡r
);

367 ià(
”r
 < 0) {

368 
	`¢d_cÚfig_d–‘e
(
d
);

369  
”r
;

371 
”r
 = 
	`§ã_¡¹Ş
(
¡r
, &
v
);

372 ià(
”r
 < 0) {

373 
	`¢d_cÚfig_d–‘e
(
d
);

374  
”r
;

376 
	`¢d_cÚfig_d–‘e
(
d
);

377 
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
);

378 ià(
”r
 < 0)

379  
”r
;

380 
”r
 = 
	`¢d_cÚfig_imake_š‹g”
(
d¡
, 
id
, 
v
);

381 ià(
”r
 < 0)

382  
”r
;

384 
	}
}

385 #iâdeà
DOC_HIDDEN


386 
SND_DLSYM_BUILD_VERSION
(
¢d_func_ig‘’v
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

406 
	$¢d_func_cÚÿt
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
, snd_cÚfig_ˆ*
¤c
,

407 
¢d_cÚfig_t
 *
´iv©e_d©a
)

409 
¢d_cÚfig_t
 *
n
;

410 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

411 cÚ¡ *
id
;

412 *
»s
 = 
NULL
, *
tmp
;

413 
idx
 = 0, 
Ën
 = 0, 
Ën1
, 
”r
, 
h™
;

415 
”r
 = 
	`¢d_cÚfig_£¬ch
(
¤c
, "¡ršgs", &
n
);

416 ià(
”r
 < 0) {

417 
	`SNDERR
("field strings‚ot found");

418 
__”rÜ
;

420 
”r
 = 
	`¢d_cÚfig_ev®u©e
(
n
, 
roÙ
, 
´iv©e_d©a
, 
NULL
);

421 ià(
”r
 < 0) {

422 
	`SNDERR
("errorƒvaluating strings");

423 
__”rÜ
;

426 
h™
 = 0;

427 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
n
) {

428 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

429 *
±r
;

430 cÚ¡ *
id
;

431 
i
;

432 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

434 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
i
);

435 ià(
”r
 < 0) {

436 
	`SNDERR
("id oàf›ld % i nÙ‡Àš‹g”", 
id
);

437 
”r
 = -
EINVAL
;

438 
__”rÜ
;

440 ià(
i
 =ğ
idx
) {

441 
idx
++;

442 
”r
 = 
	`¢d_cÚfig_g‘_ascii
(
n
, &
±r
);

443 ià(
”r
 < 0) {

444 
	`SNDERR
("šv®id‡sci˜¡ršg fÜ id %s", 
id
);

445 
”r
 = -
EINVAL
;

446 
__”rÜ
;

448 
Ën1
 = 
	`¡¾’
(
±r
);

449 
tmp
 = 
	`»®loc
(
»s
, 
Ën
 + 
Ën1
 + 1);

450 ià(
tmp
 =ğ
NULL
) {

451 
	`ä“
(
±r
);

452 
”r
 = -
ENOMEM
;

453 
__”rÜ
;

455 
	`memıy
(
tmp
 + 
Ën
, 
±r
, 
Ën1
);

456 
	`ä“
(
±r
);

457 
Ën
 +ğ
Ën1
;

458 
tmp
[
Ën
] = '\0';

459 
»s
 = 
tmp
;

460 
h™
 = 1;

463 } 
h™
);

464 ià(
»s
 =ğ
NULL
) {

465 
	`SNDERR
("empty string is‚ot‡ccepted");

466 
”r
 = -
EINVAL
;

467 
__”rÜ
;

469 
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
);

470 ià(
”r
 >= 0)

471 
”r
 = 
	`¢d_cÚfig_imake_¡ršg
(
d¡
, 
id
, 
»s
);

472 
__”rÜ
:

473 
	`ä“
(
»s
);

474  
”r
;

475 
	}
}

476 #iâdeà
DOC_HIDDEN


477 
SND_DLSYM_BUILD_VERSION
(
¢d_func_cÚÿt
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

481 
	$¢d_func_iİs
(
¢d_cÚfig_t
 **
d¡
,

482 
¢d_cÚfig_t
 *
roÙ
,

483 
¢d_cÚfig_t
 *
¤c
,

484 
¢d_cÚfig_t
 *
´iv©e_d©a
,

485 
İ
)

487 
¢d_cÚfig_t
 *
n
;

488 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

489 cÚ¡ *
id
;

490 *
»s
 = 
NULL
;

491 
»suÉ
 = 0, 
v®
;

492 
idx
 = 0, 
”r
, 
h™
;

494 
”r
 = 
	`¢d_cÚfig_£¬ch
(
¤c
, "š‹g”s", &
n
);

495 ià(
”r
 < 0) {

496 
	`SNDERR
("field integers‚ot found");

497 
__”rÜ
;

499 
”r
 = 
	`¢d_cÚfig_ev®u©e
(
n
, 
roÙ
, 
´iv©e_d©a
, 
NULL
);

500 ià(
”r
 < 0) {

501 
	`SNDERR
("errorƒvaluating integers");

502 
__”rÜ
;

505 
h™
 = 0;

506 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
n
) {

507 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

508 cÚ¡ *
id
;

509 
i
;

510 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

512 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
i
);

513 ià(
”r
 < 0) {

514 
	`SNDERR
("id oàf›ld % i nÙ‡Àš‹g”", 
id
);

515 
”r
 = -
EINVAL
;

516 
__”rÜ
;

518 ià(
i
 =ğ
idx
) {

519 
idx
++;

520 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v®
);

521 ià(
”r
 < 0) {

522 
	`SNDERR
("šv®id iÁeg” fÜ id %s", 
id
);

523 
”r
 = -
EINVAL
;

524 
__”rÜ
;

526 
İ
) {

527 0: 
»suÉ
 +ğ
v®
; ;

528 1: 
»suÉ
 *ğ
v®
; ;

530 
h™
 = 1;

533 } 
h™
);

534 
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
);

535 ià(
”r
 >= 0)

536 
”r
 = 
	`¢d_cÚfig_imake_š‹g”
(
d¡
, 
id
, 
»suÉ
);

537 
	`ä“
(
»s
);

538 
__”rÜ
:

539  
”r
;

540 
	}
}

560 
	$¢d_func_Ÿdd
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
,

561 
¢d_cÚfig_t
 *
¤c
, snd_cÚfig_ˆ*
´iv©e_d©a
)

563  
	`¢d_func_iİs
(
d¡
, 
roÙ
, 
¤c
, 
´iv©e_d©a
, 0);

564 
	}
}

565 #iâdeà
DOC_HIDDEN


566 
SND_DLSYM_BUILD_VERSION
(
¢d_func_Ÿdd
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

586 
	$¢d_func_imul
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
,

587 
¢d_cÚfig_t
 *
¤c
, snd_cÚfig_ˆ*
´iv©e_d©a
)

589  
	`¢d_func_iİs
(
d¡
, 
roÙ
, 
¤c
, 
´iv©e_d©a
, 1);

590 
	}
}

591 #iâdeà
DOC_HIDDEN


592 
SND_DLSYM_BUILD_VERSION
(
¢d_func_imul
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

611 
	$¢d_func_d©adœ
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
 
ATTRIBUTE_UNUSED
,

612 
¢d_cÚfig_t
 *
¤c
, snd_cÚfig_ˆ*
´iv©e_d©a
 
ATTRIBUTE_UNUSED
)

614 
”r
;

615 cÚ¡ *
id
;

617 
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
);

618 ià(
”r
 < 0)

619  
”r
;

620  
	`¢d_cÚfig_imake_¡ršg
(
d¡
, 
id
, 
	`¢d_cÚfig_tİdœ
());

621 
	}
}

622 #iâdeà
DOC_HIDDEN


623 
SND_DLSYM_BUILD_VERSION
(
¢d_func_d©adœ
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

626 
	$İ’_ùl
(
ÿrd
, 
¢d_ùl_t
 **
ùl
)

628 
Çme
[16];

629 
	`¢´štf
(
Çme
, Òame), "hw:%li", 
ÿrd
);

630 
Çme
[(name)-1] = '\0';

631  
	`¢d_ùl_İ’
(
ùl
, 
Çme
, 0);

632 
	}
}

635 
	$¡ršg_äom_š‹g”
(**
d¡
, 
v
)

637 
¡r
[32];

638 *
»s
;

639 
	`¥rštf
(
¡r
, "%li", 
v
);

640 
»s
 = 
	`¡rdup
(
¡r
);

641 ià(
»s
 =ğ
NULL
)

642  -
ENOMEM
;

643 *
d¡
 = 
»s
;

645 
	}
}

648 
	$_¢d_func_´iv©e_d©a
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
¤c
,

649 
¢d_cÚfig_t
 **
´iv©e_d©a
, cÚ¡ *
id
)

651 
”r
;

653 ià(*
´iv©e_d©a
 =ğ
NULL
)

654  
	`¢d_cÚfig_cİy
(
d¡
, 
¤c
);

655 ià(
	`¢d_cÚfig_g‘_ty³
(*
´iv©e_d©a
è=ğ
SND_CONFIG_TYPE_COMPOUND
) {

656 
”r
 = 
	`¢d_cÚfig_£¬ch
(*
´iv©e_d©a
, 
id
,…rivate_data);

657 ià(
”r
)

658 
nÙfound
;

660 
”r
 = 
	`¢d_cÚfig_‹¡_id
(*
´iv©e_d©a
, 
id
);

661 ià(
”r
) {

662 
nÙfound
:

663 
	`SNDERR
("f›ld % nÙ found", 
id
);

664  -
EINVAL
;

667 
	}
}

687 
	$¢d_func_´iv©e_¡ršg
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
 
ATTRIBUTE_UNUSED
,

688 
¢d_cÚfig_t
 *
¤c
, snd_cÚfig_ˆ*
´iv©e_d©a
)

690 
”r
;

691 cÚ¡ *
¡r
, *
id
;

693 
”r
 = 
	`_¢d_func_´iv©e_d©a
(
d¡
, 
¤c
, &
´iv©e_d©a
, "string");

694 ià(
”r
)

695  
”r
;

696 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
´iv©e_d©a
, &
¡r
);

697 ià(
”r
 < 0) {

698 
	`SNDERR
("field string is‚ot‡ string");

699  
”r
;

701 
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
);

702 ià(
”r
 >= 0)

703 
”r
 = 
	`¢d_cÚfig_imake_¡ršg
(
d¡
, 
id
, 
¡r
);

704  
”r
;

705 
	}
}

706 #iâdeà
DOC_HIDDEN


707 
SND_DLSYM_BUILD_VERSION
(
¢d_func_´iv©e_¡ršg
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

727 
	$¢d_func_´iv©e_š‹g”
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
 
ATTRIBUTE_UNUSED
,

728 
¢d_cÚfig_t
 *
¤c
, snd_cÚfig_ˆ*
´iv©e_d©a
)

730 
”r
;

731 cÚ¡ *
id
;

732 
v®
;

734 
”r
 = 
	`_¢d_func_´iv©e_d©a
(
d¡
, 
¤c
, &
´iv©e_d©a
, "integer");

735 ià(
”r
)

736  
”r
;

737 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
´iv©e_d©a
, &
v®
);

738 ià(
”r
 < 0) {

739 
	`SNDERR
("field integer is‚ot‡ string");

740  
”r
;

742 
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
);

743 ià(
”r
 >= 0)

744 
”r
 = 
	`¢d_cÚfig_imake_š‹g”
(
d¡
, 
id
, 
v®
);

745  
”r
;

746 
	}
}

747 #iâdeà
DOC_HIDDEN


748 
SND_DLSYM_BUILD_VERSION
(
¢d_func_´iv©e_š‹g”
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

751 #iâdeà
DOC_HIDDEN


752 
	$¢d_d‘”mše_driv”
(
ÿrd
, **
driv”
)

754 
¢d_ùl_t
 *
ùl
 = 
NULL
;

755 
¢d_ùl_ÿrd_šfo_t
 
šfo
 = {0};

756 *
»s
 = 
NULL
;

757 
”r
;

759 
	`as£¹
(
ÿrd
 >ğ0 && c¬d <ğ
SND_MAX_CARDS
);

760 
”r
 = 
	`İ’_ùl
(
ÿrd
, &
ùl
);

761 ià(
”r
 < 0) {

762 
	`SNDERR
("could‚Ù o³ÀcÚŒŞ fÜ c¬d %i", 
ÿrd
);

763 
__”rÜ
;

765 
”r
 = 
	`¢d_ùl_ÿrd_šfo
(
ùl
, &
šfo
);

766 ià(
”r
 < 0) {

767 
	`SNDERR
("¢d_ùl_ÿrd_šfØ”rÜ: %s", 
	`¢d_¡»¼Ü
(
”r
));

768 
__”rÜ
;

770 
»s
 = 
	`¡rdup
(
	`¢d_ùl_ÿrd_šfo_g‘_driv”
(&
šfo
));

771 ià(
»s
 =ğ
NULL
)

772 
”r
 = -
ENOMEM
;

774 *
driv”
 = 
»s
;

775 
”r
 = 0;

777 
__”rÜ
:

778 ià(
ùl
)

779 
	`¢d_ùl_şo£
(
ùl
);

780  
”r
;

781 
	}
}

801 
	$¢d_func_´iv©e_ÿrd_driv”
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
 
ATTRIBUTE_UNUSED
, snd_cÚfig_ˆ*
¤c
,

802 
¢d_cÚfig_t
 *
´iv©e_d©a
)

804 *
driv”
;

805 cÚ¡ *
id
;

806 
”r
;

807 
ÿrd
;

809 
”r
 = 
	`¢d_cÚfig_‹¡_id
(
´iv©e_d©a
, "card");

810 ià(
”r
) {

811 
	`SNDERR
("field card‚ot found");

812  -
EINVAL
;

814 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
´iv©e_d©a
, &
ÿrd
);

815 ià(
”r
 < 0) {

816 
	`SNDERR
("field card is‚ot‡n integer");

817  
”r
;

819 ià((
”r
 = 
	`¢d_d‘”mše_driv”
(
ÿrd
, &
driv”
)) < 0)

820  
”r
;

821 
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
);

822 ià(
”r
 >= 0)

823 
”r
 = 
	`¢d_cÚfig_imake_¡ršg
(
d¡
, 
id
, 
driv”
);

824 
	`ä“
(
driv”
);

825  
”r
;

826 
	}
}

827 #iâdeà
DOC_HIDDEN


828 
SND_DLSYM_BUILD_VERSION
(
¢d_func_´iv©e_ÿrd_driv”
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

831 
	$·r£_ÿrd
(
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
¤c
,

832 
¢d_cÚfig_t
 *
´iv©e_d©a
)

834 
¢d_cÚfig_t
 *
n
;

835 *
¡r
;

836 
ÿrd
, 
”r
;

838 
”r
 = 
	`¢d_cÚfig_£¬ch
(
¤c
, "ÿrd", &
n
);

839 ià(
”r
 < 0) {

840 
	`SNDERR
("field card‚ot found");

841  
”r
;

843 
”r
 = 
	`¢d_cÚfig_ev®u©e
(
n
, 
roÙ
, 
´iv©e_d©a
, 
NULL
);

844 ià(
”r
 < 0) {

845 
	`SNDERR
("errorƒvaluating card");

846  
”r
;

848 
”r
 = 
	`¢d_cÚfig_g‘_ascii
(
n
, &
¡r
);

849 ià(
”r
 < 0) {

850 
	`SNDERR
("field card is‚ot‡n integer or‡ string");

851  
”r
;

853 
ÿrd
 = 
	`¢d_ÿrd_g‘_šdex
(
¡r
);

854 ià(
ÿrd
 < 0)

855 
	`SNDERR
("ÿÂÙ fšd c¬d '%s'", 
¡r
);

856 
	`ä“
(
¡r
);

857  
ÿrd
;

858 
	}
}

877 
	$¢d_func_ÿrd_šum
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
, snd_cÚfig_ˆ*
¤c
,

878 
¢d_cÚfig_t
 *
´iv©e_d©a
)

880 cÚ¡ *
id
;

881 
ÿrd
, 
”r
;

883 
ÿrd
 = 
	`·r£_ÿrd
(
roÙ
, 
¤c
, 
´iv©e_d©a
);

884 ià(
ÿrd
 < 0)

885  
ÿrd
;

886 
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
);

887 ià(
”r
 >= 0)

888 
”r
 = 
	`¢d_cÚfig_imake_š‹g”
(
d¡
, 
id
, 
ÿrd
);

889  
”r
;

890 
	}
}

891 #iâdeà
DOC_HIDDEN


892 
SND_DLSYM_BUILD_VERSION
(
¢d_func_ÿrd_šum
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

912 
	$¢d_func_ÿrd_driv”
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
, snd_cÚfig_ˆ*
¤c
,

913 
¢d_cÚfig_t
 *
´iv©e_d©a
)

915 
¢d_cÚfig_t
 *
v®
;

916 
ÿrd
, 
”r
;

918 
ÿrd
 = 
	`·r£_ÿrd
(
roÙ
, 
¤c
, 
´iv©e_d©a
);

919 ià(
ÿrd
 < 0)

920  
ÿrd
;

921 
”r
 = 
	`¢d_cÚfig_imake_š‹g”
(&
v®
, "ÿrd", 
ÿrd
);

922 ià(
”r
 < 0)

923  
”r
;

924 
”r
 = 
	`¢d_func_´iv©e_ÿrd_driv”
(
d¡
, 
roÙ
, 
¤c
, 
v®
);

925 
	`¢d_cÚfig_d–‘e
(
v®
);

926  
”r
;

927 
	}
}

928 #iâdeà
DOC_HIDDEN


929 
SND_DLSYM_BUILD_VERSION
(
¢d_func_ÿrd_driv”
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

949 
	$¢d_func_ÿrd_id
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
, snd_cÚfig_ˆ*
¤c
,

950 
¢d_cÚfig_t
 *
´iv©e_d©a
)

952 
¢d_ùl_t
 *
ùl
 = 
NULL
;

953 
¢d_ùl_ÿrd_šfo_t
 
šfo
 = {0};

954 cÚ¡ *
id
;

955 
ÿrd
, 
”r
;

957 
ÿrd
 = 
	`·r£_ÿrd
(
roÙ
, 
¤c
, 
´iv©e_d©a
);

958 ià(
ÿrd
 < 0)

959  
ÿrd
;

960 
”r
 = 
	`İ’_ùl
(
ÿrd
, &
ùl
);

961 ià(
”r
 < 0) {

962 
	`SNDERR
("could‚Ù o³ÀcÚŒŞ fÜ c¬d %i", 
ÿrd
);

963 
__”rÜ
;

965 
”r
 = 
	`¢d_ùl_ÿrd_šfo
(
ùl
, &
šfo
);

966 ià(
”r
 < 0) {

967 
	`SNDERR
("¢d_ùl_ÿrd_šfØ”rÜ: %s", 
	`¢d_¡»¼Ü
(
”r
));

968 
__”rÜ
;

970 
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
);

971 ià(
”r
 >= 0)

972 
”r
 = 
	`¢d_cÚfig_imake_¡ršg
(
d¡
, 
id
,

973 
	`¢d_ùl_ÿrd_šfo_g‘_id
(&
šfo
));

974 
__”rÜ
:

975 ià(
ùl
)

976 
	`¢d_ùl_şo£
(
ùl
);

977  
”r
;

978 
	}
}

979 #iâdeà
DOC_HIDDEN


980 
SND_DLSYM_BUILD_VERSION
(
¢d_func_ÿrd_id
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

1000 
	$¢d_func_ÿrd_Çme
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
,

1001 
¢d_cÚfig_t
 *
¤c
, snd_cÚfig_ˆ*
´iv©e_d©a
)

1003 
¢d_ùl_t
 *
ùl
 = 
NULL
;

1004 
¢d_ùl_ÿrd_šfo_t
 
šfo
 = {0};

1005 cÚ¡ *
id
;

1006 
ÿrd
, 
”r
;

1008 
ÿrd
 = 
	`·r£_ÿrd
(
roÙ
, 
¤c
, 
´iv©e_d©a
);

1009 ià(
ÿrd
 < 0)

1010  
ÿrd
;

1011 
”r
 = 
	`İ’_ùl
(
ÿrd
, &
ùl
);

1012 ià(
”r
 < 0) {

1013 
	`SNDERR
("could‚Ù o³ÀcÚŒŞ fÜ c¬d %i", 
ÿrd
);

1014 
__”rÜ
;

1016 
”r
 = 
	`¢d_ùl_ÿrd_šfo
(
ùl
, &
šfo
);

1017 ià(
”r
 < 0) {

1018 
	`SNDERR
("¢d_ùl_ÿrd_šfØ”rÜ: %s", 
	`¢d_¡»¼Ü
(
”r
));

1019 
__”rÜ
;

1021 
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
);

1022 ià(
”r
 >= 0)

1023 
”r
 = 
	`¢d_cÚfig_imake_§ã_¡ršg
(
d¡
, 
id
,

1024 
	`¢d_ùl_ÿrd_šfo_g‘_Çme
(&
šfo
));

1025 
__”rÜ
:

1026 ià(
ùl
)

1027 
	`¢d_ùl_şo£
(
ùl
);

1028  
”r
;

1029 
	}
}

1030 #iâdeà
DOC_HIDDEN


1031 
SND_DLSYM_BUILD_VERSION
(
¢d_func_ÿrd_Çme
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

1034 #ifdeà
DOXYGEN


1037 #iâdeà
BUILD_PCM


1038 
	#BUILD_PCM


	)

1042 #ifdeà
BUILD_PCM


1064 
	$¢d_func_pcm_id
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
, snd_cÚfig_ˆ*
¤c
, *
´iv©e_d©a
)

1066 
¢d_cÚfig_t
 *
n
;

1067 
¢d_ùl_t
 *
ùl
 = 
NULL
;

1068 
¢d_pcm_šfo_t
 
šfo
 = {0};

1069 cÚ¡ *
id
;

1070 
ÿrd
, 
deviû
, 
subdeviû
 = 0;

1071 
”r
;

1073 
ÿrd
 = 
	`·r£_ÿrd
(
roÙ
, 
¤c
, 
´iv©e_d©a
);

1074 ià(
ÿrd
 < 0)

1075  
ÿrd
;

1076 
”r
 = 
	`¢d_cÚfig_£¬ch
(
¤c
, "deviû", &
n
);

1077 ià(
”r
 < 0) {

1078 
	`SNDERR
("field device‚ot found");

1079 
__”rÜ
;

1081 
”r
 = 
	`¢d_cÚfig_ev®u©e
(
n
, 
roÙ
, 
´iv©e_d©a
, 
NULL
);

1082 ià(
”r
 < 0) {

1083 
	`SNDERR
("errorƒvaluating device");

1084 
__”rÜ
;

1086 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
deviû
);

1087 ià(
”r
 < 0) {

1088 
	`SNDERR
("field device is‚ot‡n integer");

1089 
__”rÜ
;

1091 ià(
	`¢d_cÚfig_£¬ch
(
¤c
, "subdeviû", &
n
) >= 0) {

1092 
”r
 = 
	`¢d_cÚfig_ev®u©e
(
n
, 
roÙ
, 
´iv©e_d©a
, 
NULL
);

1093 ià(
”r
 < 0) {

1094 
	`SNDERR
("errorƒvaluating subdevice");

1095 
__”rÜ
;

1097 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
subdeviû
);

1098 ià(
”r
 < 0) {

1099 
	`SNDERR
("field subdevice is‚ot‡n integer");

1100 
__”rÜ
;

1103 
”r
 = 
	`İ’_ùl
(
ÿrd
, &
ùl
);

1104 ià(
”r
 < 0) {

1105 
	`SNDERR
("could‚Ù o³ÀcÚŒŞ fÜ c¬d %li", 
ÿrd
);

1106 
__”rÜ
;

1108 
	`¢d_pcm_šfo_£t_deviû
(&
šfo
, 
deviû
);

1109 
	`¢d_pcm_šfo_£t_subdeviû
(&
šfo
, 
subdeviû
);

1110 
”r
 = 
	`¢d_ùl_pcm_šfo
(
ùl
, &
šfo
);

1111 ià(
”r
 < 0) {

1112 
	`SNDERR
("¢d_ùl_pcm_šfØ”rÜ: %s", 
	`¢d_¡»¼Ü
(
”r
));

1113 
__”rÜ
;

1115 
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
);

1116 ià(
”r
 >= 0)

1117 
”r
 = 
	`¢d_cÚfig_imake_¡ršg
(
d¡
, 
id
,

1118 
	`¢d_pcm_šfo_g‘_id
(&
šfo
));

1119 
__”rÜ
:

1120 ià(
ùl
)

1121 
	`¢d_ùl_şo£
(
ùl
);

1122  
”r
;

1123 
	}
}

1124 #iâdeà
DOC_HIDDEN


1125 
SND_DLSYM_BUILD_VERSION
(
¢d_func_pcm_id
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

1148 
	$¢d_func_pcm_¬gs_by_şass
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
, snd_cÚfig_ˆ*
¤c
, *
´iv©e_d©a
)

1150 
¢d_cÚfig_t
 *
n
;

1151 
¢d_ùl_t
 *
ùl
 = 
NULL
;

1152 
¢d_pcm_šfo_t
 
šfo
 = {0};

1153 cÚ¡ *
id
;

1154 
ÿrd
 = -1, 
dev
;

1155 
şass
, 
šdex
;

1156 
idx
 = 0;

1157 
”r
;

1159 
”r
 = 
	`¢d_cÚfig_£¬ch
(
¤c
, "şass", &
n
);

1160 ià(
”r
 < 0) {

1161 
	`SNDERR
("field class‚ot found");

1162 
__out
;

1164 
”r
 = 
	`¢d_cÚfig_ev®u©e
(
n
, 
roÙ
, 
´iv©e_d©a
, 
NULL
);

1165 ià(
”r
 < 0) {

1166 
	`SNDERR
("errorƒvaluating class");

1167 
__out
;

1169 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
şass
);

1170 ià(
”r
 < 0) {

1171 
	`SNDERR
("field class is‚ot‡n integer");

1172 
__out
;

1174 
”r
 = 
	`¢d_cÚfig_£¬ch
(
¤c
, "šdex", &
n
);

1175 ià(
”r
 < 0) {

1176 
	`SNDERR
("field index‚ot found");

1177 
__out
;

1179 
”r
 = 
	`¢d_cÚfig_ev®u©e
(
n
, 
roÙ
, 
´iv©e_d©a
, 
NULL
);

1180 ià(
”r
 < 0) {

1181 
	`SNDERR
("errorƒvaluating index");

1182 
__out
;

1184 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
šdex
);

1185 ià(
”r
 < 0) {

1186 
	`SNDERR
("field index is‚ot‡n integer");

1187 
__out
;

1191 
”r
 = 
	`¢d_ÿrd_Ãxt
(&
ÿrd
);

1192 ià(
”r
 < 0) {

1193 
	`SNDERR
("could‚ot get‚ext card");

1194 
__out
;

1196 ià(
ÿrd
 < 0)

1198 
”r
 = 
	`İ’_ùl
(
ÿrd
, &
ùl
);

1199 ià(
”r
 < 0) {

1200 
	`SNDERR
("could‚Ù o³ÀcÚŒŞ fÜ c¬d %i", 
ÿrd
);

1201 
__out
;

1203 
dev
 = -1;

1205 
”r
 = 
	`¢d_ùl_pcm_Ãxt_deviû
(
ùl
, &
dev
);

1206 ià(
”r
 < 0) {

1207 
	`SNDERR
("could‚Ù g‘‚exˆpcm fÜ c¬d %i", 
ÿrd
);

1208 
__out
;

1210 ià(
dev
 < 0)

1212 
	`¢d_pcm_šfo_£t_deviû
(&
šfo
, 
dev
);

1213 
”r
 = 
	`¢d_ùl_pcm_šfo
(
ùl
, &
šfo
);

1214 ià(
”r
 < 0)

1216 ià(
	`¢d_pcm_šfo_g‘_şass
(&
šfo
è=ğ(
¢d_pcm_şass_t
)
şass
 &&

1217 
šdex
 =ğ
idx
++)

1218 
__out
;

1220 
	`¢d_ùl_şo£
(
ùl
);

1221 
ùl
 = 
NULL
;

1223 
”r
 = -
ENODEV
;

1225 
__out
:

1226 ià(
ùl
)

1227 
	`¢d_ùl_şo£
(
ùl
);

1228 ià(
”r
 < 0)

1229  
”r
;

1230 if((
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
)) >= 0) {

1231 
Çme
[32];

1232 
	`¢´štf
(
Çme
, Òame), "CARD=%i,DEV=%i", 
ÿrd
, 
dev
);

1233 
”r
 = 
	`¢d_cÚfig_imake_¡ršg
(
d¡
, 
id
, 
Çme
);

1235  
”r
;

1236 
	}
}

1237 #iâdeà
DOC_HIDDEN


1238 
SND_DLSYM_BUILD_VERSION
(
¢d_func_pcm_¬gs_by_şass
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

1258 
	$¢d_func_´iv©e_pcm_subdeviû
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
 
ATTRIBUTE_UNUSED
,

1259 
¢d_cÚfig_t
 *
¤c
, snd_cÚfig_ˆ*
´iv©e_d©a
)

1261 
¢d_pcm_šfo_t
 
šfo
 = {0};

1262 cÚ¡ *
id
;

1263 cÚ¡ *
d©a
;

1264 
¢d_pcm_t
 *
pcm
;

1265 
”r
;

1267 ià(
´iv©e_d©a
 =ğ
NULL
)

1268  
	`¢d_cÚfig_cİy
(
d¡
, 
¤c
);

1269 
”r
 = 
	`¢d_cÚfig_‹¡_id
(
´iv©e_d©a
, "pcm_handle");

1270 ià(
”r
) {

1271 
	`SNDERR
("field…cm_handle‚ot found");

1272  -
EINVAL
;

1274 
”r
 = 
	`¢d_cÚfig_g‘_poš‹r
(
´iv©e_d©a
, &
d©a
);

1275 
pcm
 = (
¢d_pcm_t
 *)
d©a
;

1276 ià(
”r
 < 0) {

1277 
	`SNDERR
("field…cm_handle is‚ot‡…ointer");

1278  
”r
;

1280 
”r
 = 
	`¢d_pcm_šfo
(
pcm
, &
šfo
);

1281 ià(
”r
 < 0) {

1282 
	`SNDERR
("¢d_ùl_pcm_šfØ”rÜ: %s", 
	`¢d_¡»¼Ü
(
”r
));

1283  
”r
;

1285 
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
);

1286 ià(
”r
 >= 0)

1287 
”r
 = 
	`¢d_cÚfig_imake_š‹g”
(
d¡
, 
id
,

1288 
	`¢d_pcm_šfo_g‘_subdeviû
(&
šfo
));

1289  
”r
;

1290 
	}
}

1291 #iâdeà
DOC_HIDDEN


1292 
SND_DLSYM_BUILD_VERSION
(
¢d_func_´iv©e_pcm_subdeviû
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

1318 
	$¢d_func_»ãr
(
¢d_cÚfig_t
 **
d¡
, snd_cÚfig_ˆ*
roÙ
, snd_cÚfig_ˆ*
¤c
,

1319 
¢d_cÚfig_t
 *
´iv©e_d©a
)

1321 
¢d_cÚfig_t
 *
n
;

1322 cÚ¡ *
fe
 = 
NULL
, *
Çme
 = NULL;

1323 
”r
;

1325 
”r
 = 
	`¢d_cÚfig_£¬ch
(
¤c
, "fe", &
n
);

1326 ià(
”r
 >= 0) {

1327 
”r
 = 
	`¢d_cÚfig_ev®u©e
(
n
, 
roÙ
, 
´iv©e_d©a
, 
NULL
);

1328 ià(
”r
 < 0) {

1329 
	`SNDERR
("errorƒvaluating file");

1330 
_’d
;

1332 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
fe
);

1333 ià(
”r
 < 0) {

1334 
	`SNDERR
("file is‚ot‡ string");

1335 
_’d
;

1338 
”r
 = 
	`¢d_cÚfig_£¬ch
(
¤c
, "Çme", &
n
);

1339 ià(
”r
 >= 0) {

1340 
”r
 = 
	`¢d_cÚfig_ev®u©e
(
n
, 
roÙ
, 
´iv©e_d©a
, 
NULL
);

1341 ià(
”r
 < 0) {

1342 
	`SNDERR
("errorƒvaluating‚ame");

1343 
_’d
;

1345 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
Çme
);

1346 ià(
”r
 < 0) {

1347 
	`SNDERR
("name is‚ot‡ string");

1348 
_’d
;

1351 ià(!
Çme
) {

1352 
”r
 = -
EINVAL
;

1353 
	`SNDERR
("name is‚ot specified");

1354 
_’d
;

1356 ià(
fe
) {

1357 
¢d_šput_t
 *
šput
;

1358 
”r
 = 
	`¢d_šput_¡dio_İ’
(&
šput
, 
fe
, "r");

1359 ià(
”r
 < 0) {

1360 
	`SNDERR
("UÇbËØİ’ f%s: %s", 
fe
, 
	`¢d_¡»¼Ü
(
”r
));

1361 
_’d
;

1363 
”r
 = 
	`¢d_cÚfig_lßd
(
roÙ
, 
šput
);

1364 
	`¢d_šput_şo£
(
šput
);

1365 ià(
”r
 < 0)

1366 
_’d
;

1368 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, 
NULL
, 
Çme
, 
d¡
);

1369 ià(
”r
 >= 0) {

1370 cÚ¡ *
id
;

1371 
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
);

1372 ià(
”r
 >= 0)

1373 
”r
 = 
	`¢d_cÚfig_£t_id
(*
d¡
, 
id
);

1375 
”r
 = 
	`¢d_cÚfig_£¬ch
(
¤c
, "deçuÉ", &
n
);

1376 ià(
”r
 < 0)

1377 
	`SNDERR
("UÇbËØfšd defš™iÚ '%s'", 
Çme
);

1379 cÚ¡ *
id
;

1380 
”r
 = 
	`¢d_cÚfig_ev®u©e
(
n
, 
roÙ
, 
´iv©e_d©a
, 
NULL
);

1381 ià(
”r
 < 0)

1382  
”r
;

1383 ià((
”r
 = 
	`¢d_cÚfig_cİy
(
d¡
, 
n
)) >= 0) {

1384 ià((
”r
 = 
	`¢d_cÚfig_g‘_id
(
¤c
, &
id
)) < 0 ||

1385 (
”r
 = 
	`¢d_cÚfig_£t_id
(*
d¡
, 
id
)) < 0)

1386 
	`¢d_cÚfig_d–‘e
(*
d¡
);

1390 
_’d
:

1391  
”r
;

1392 
	}
}

1393 #iâdeà
DOC_HIDDEN


1394 
SND_DLSYM_BUILD_VERSION
(
¢d_func_»ãr
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

1397 #iâdeà
DOC_HIDDEN


1398 
	$_¢d_cÚf_g’”ic_id
(cÚ¡ *
id
)

1400 cÚ¡ 
ids
[3][8] = { "comment", "type", "hint" };

1401 
k
;

1402 
k
 = 0; k < (
ids
) / (ids[0]); ++k) {

1403 ià(
	`¡rcmp
(
id
, 
ids
[
k
]) == 0)

1407 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/cards.c

28 
	~"cÚŒŞ_loÿl.h
"

29 
	~<¡dio.h
>

30 
	~<¡dlib.h
>

31 
	~<uni¡d.h
>

32 
	~<¡ršg.h
>

33 
	~<ùy³.h
>

34 
	~<fú.h
>

35 
	~<sys/ioùl.h
>

37 #iâdeà
DOC_HIDDEN


38 
	#SND_FILE_CONTROL
 
ALSA_DEVICE_DIRECTORY
 "cÚŒŞC%i"

	)

39 
	#SND_FILE_LOAD
 
ALOAD_DEVICE_DIRECTORY
 "®ßdC%i"

	)

42 
	$¢d_ÿrd_lßd2
(cÚ¡ *
cÚŒŞ
)

44 
İ’_dev
;

45 
¢d_ùl_ÿrd_šfo_t
 
šfo
;

47 
İ’_dev
 = 
	`¢d_İ’_deviû
(
cÚŒŞ
, 
O_RDONLY
);

48 ià(
İ’_dev
 >= 0) {

49 ià(
	`ioùl
(
İ’_dev
, 
SNDRV_CTL_IOCTL_CARD_INFO
, &
šfo
) < 0) {

50 
”r
 = -
”ºo
;

51 
	`şo£
(
İ’_dev
);

52  
”r
;

54 
	`şo£
(
İ’_dev
);

55  
šfo
.
ÿrd
;

57  -
”ºo
;

59 
	}
}

61 
	$¢d_ÿrd_lßd1
(
ÿrd
)

63 
»s
;

64 
cÚŒŞ
[(
SND_FILE_CONTROL
) + 10];

66 
	`¥rštf
(
cÚŒŞ
, 
SND_FILE_CONTROL
, 
ÿrd
);

67 
»s
 = 
	`¢d_ÿrd_lßd2
(
cÚŒŞ
);

68 #ifdeà
SUPPORT_ALOAD


69 ià(
»s
 < 0) {

70 
®ßd
[(
SND_FILE_LOAD
) + 10];

71 
	`¥rštf
(
®ßd
, 
SND_FILE_LOAD
, 
ÿrd
);

72 
»s
 = 
	`¢d_ÿrd_lßd2
(
®ßd
);

75  
»s
;

76 
	}
}

83 
	$¢d_ÿrd_lßd
(
ÿrd
)

85  !!(
	`¢d_ÿrd_lßd1
(
ÿrd
) >= 0);

86 
	}
}

108 
	$¢d_ÿrd_Ãxt
(*
rÿrd
)

110 
ÿrd
;

112 ià(
rÿrd
 =ğ
NULL
)

113  -
EINVAL
;

114 
ÿrd
 = *
rÿrd
;

115 
ÿrd
 = card < 0 ? 0 : card + 1;

116 ; 
ÿrd
 < 
SND_MAX_CARDS
; card++) {

117 ià(
	`¢d_ÿrd_lßd
(
ÿrd
)) {

118 *
rÿrd
 = 
ÿrd
;

122 *
rÿrd
 = -1;

124 
	}
}

140 
	$¢d_ÿrd_g‘_šdex
(cÚ¡ *
¡ršg
)

142 
ÿrd
, 
”r
;

143 
¢d_ùl_t
 *
hªdË
;

144 
¢d_ùl_ÿrd_šfo_t
 
šfo
;

146 ià(!
¡ršg
 || *string == '\0')

147  -
EINVAL
;

148 ià((
	`isdig™
(*
¡ršg
) && *(string + 1) == 0) ||

149 (
	`isdig™
(*
¡ršg
) && isdigit(*(string + 1)) && *(string + 2) == 0)) {

151 ià(
	`ssÿnf
(
¡ršg
, "%i", &
ÿrd
) != 1)

152  -
EINVAL
;

153 ià(
ÿrd
 < 0 || c¬d >ğ
SND_MAX_CARDS
)

154  -
EINVAL
;

155 
”r
 = 
	`¢d_ÿrd_lßd1
(
ÿrd
);

156 ià(
”r
 >= 0)

157  
ÿrd
;

158  
”r
;

160 ià(
¡ršg
[0] == '/')

162  
	`¢d_ÿrd_lßd2
(
¡ršg
);

164 
ÿrd
 = 0; c¬d < 
SND_MAX_CARDS
; card++) {

165 #ifdeà
SUPPORT_ALOAD


166 ià(! 
	`¢d_ÿrd_lßd
(
ÿrd
))

169 ià(
	`¢d_ùl_hw_İ’
(&
hªdË
, 
NULL
, 
ÿrd
, 0) < 0)

171 ià(
	`¢d_ùl_ÿrd_šfo
(
hªdË
, &
šfo
) < 0) {

172 
	`¢d_ùl_şo£
(
hªdË
);

175 
	`¢d_ùl_şo£
(
hªdË
);

176 ià(!
	`¡rcmp
((cÚ¡ *)
šfo
.
id
, 
¡ršg
))

177  
ÿrd
;

179  -
ENODEV
;

180 
	}
}

192 
	$¢d_ÿrd_g‘_Çme
(
ÿrd
, **
Çme
)

194 
¢d_ùl_t
 *
hªdË
;

195 
¢d_ùl_ÿrd_šfo_t
 
šfo
;

196 
”r
;

198 ià(
Çme
 =ğ
NULL
)

199  -
EINVAL
;

200 ià((
”r
 = 
	`¢d_ùl_hw_İ’
(&
hªdË
, 
NULL
, 
ÿrd
, 0)) < 0)

201  
”r
;

202 ià((
”r
 = 
	`¢d_ùl_ÿrd_šfo
(
hªdË
, &
šfo
)) < 0) {

203 
	`¢d_ùl_şo£
(
hªdË
);

204  
”r
;

206 
	`¢d_ùl_şo£
(
hªdË
);

207 *
Çme
 = 
	`¡rdup
((cÚ¡ *)
šfo
.name);

208 ià(*
Çme
 =ğ
NULL
)

209  -
ENOMEM
;

211 
	}
}

222 
	$¢d_ÿrd_g‘_lÚgÇme
(
ÿrd
, **
Çme
)

224 
¢d_ùl_t
 *
hªdË
;

225 
¢d_ùl_ÿrd_šfo_t
 
šfo
;

226 
”r
;

228 ià(
Çme
 =ğ
NULL
)

229  -
EINVAL
;

230 ià((
”r
 = 
	`¢d_ùl_hw_İ’
(&
hªdË
, 
NULL
, 
ÿrd
, 0)) < 0)

231  
”r
;

232 ià((
”r
 = 
	`¢d_ùl_ÿrd_šfo
(
hªdË
, &
šfo
)) < 0) {

233 
	`¢d_ùl_şo£
(
hªdË
);

234  
”r
;

236 
	`¢d_ùl_şo£
(
hªdË
);

237 *
Çme
 = 
	`¡rdup
((cÚ¡ *)
šfo
.
lÚgÇme
);

238 ià(*
Çme
 =ğ
NULL
)

239  -
ENOMEM
;

241 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control.c

188 
	~"cÚŒŞ_loÿl.h
"

189 
	~<¡dio.h
>

190 
	~<¡dlib.h
>

191 
	~<¡dšt.h
>

192 
	~<¡d¬g.h
>

193 
	~<uni¡d.h
>

194 
	~<¡ršg.h
>

195 
	~<fú.h
>

196 
	~<sigÇl.h
>

197 
	~<pŞl.h
>

198 
	~<¡dboŞ.h
>

199 
	~<lim™s.h
>

209 cÚ¡ *
	$¢d_ùl_Çme
(
¢d_ùl_t
 *
ùl
)

211 
	`as£¹
(
ùl
);

212  
ùl
->
Çme
;

213 
	}
}

222 
¢d_ùl_ty³_t
 
	$¢d_ùl_ty³
(
¢d_ùl_t
 *
ùl
)

224 
	`as£¹
(
ùl
);

225  
ùl
->
ty³
;

226 
	}
}

236 
	$¢d_ùl_şo£
(
¢d_ùl_t
 *
ùl
)

238 
”r
;

239 !
	`li¡_em±y
(&
ùl
->
async_hªdËrs
)) {

240 
¢d_async_hªdËr_t
 *
h
 = 
	`li¡_’Œy
(&
ùl
->
async_hªdËrs
.
Ãxt
, snd_async_hªdËr_t, 
hli¡
);

241 
	`¢d_async_d–_hªdËr
(
h
);

243 
”r
 = 
ùl
->
İs
->
	`şo£
(ctl);

244 
	`ä“
(
ùl
->
Çme
);

245 
	`¢d_dlobj_ÿche_put
(
ùl
->
İ’_func
);

246 
	`ä“
(
ùl
);

247  
”r
;

248 
	}
}

256 
	$¢d_ùl_nÚblock
(
¢d_ùl_t
 *
ùl
, 
nÚblock
)

258 
”r
;

259 
	`as£¹
(
ùl
);

260 
”r
 = 
ùl
->
İs
->
	`nÚblock
(ùl, 
nÚblock
);

261 ià(
”r
 < 0)

262  
”r
;

263 
ùl
->
nÚblock
 =‚onblock;

265 
	}
}

267 #iâdeà
DOC_HIDDEN


268 
	$¢d_ùl_Ãw
(
¢d_ùl_t
 **
ùÍ
, 
¢d_ùl_ty³_t
 
ty³
, cÚ¡ *
Çme
, 
mode
)

270 
¢d_ùl_t
 *
ùl
;

271 
ùl
 = 
	`ÿÎoc
(1, (*ctl));

272 ià(!
ùl
)

273  -
ENOMEM
;

274 
ùl
->
ty³
 =ype;

275 
ùl
->
mode
 = mode;

276 ià(
Çme
)

277 
ùl
->
Çme
 = 
	`¡rdup
(name);

278 
	`INIT_LIST_HEAD
(&
ùl
->
async_hªdËrs
);

279 *
ùÍ
 = 
ùl
;

281 
	}
}

293 
	$¢d_ùl_async
(
¢d_ùl_t
 *
ùl
, 
sig
, 
pid_t
 
pid
)

295 
	`as£¹
(
ùl
);

296 ià(
sig
 == 0)

297 
sig
 = 
SIGIO
;

298 ià(
pid
 == 0)

299 
pid
 = 
	`g‘pid
();

300  
ùl
->
İs
->
	`async
(ùl, 
sig
, 
pid
);

301 
	}
}

309 
	$¢d_ùl_pŞl_desütÜs_couÁ
(
¢d_ùl_t
 *
ùl
)

311 
	`as£¹
(
ùl
);

312 ià(
ùl
->
İs
->
pŞl_desütÜs_couÁ
)

313  
ùl
->
İs
->
	`pŞl_desütÜs_couÁ
(ctl);

314 ià(
ùl
->
pŞl_fd
 < 0)

317 
	}
}

326 
	$¢d_ùl_pŞl_desütÜs
(
¢d_ùl_t
 *
ùl
, 
pŞlfd
 *
pfds
, 
¥aû
)

328 
	`as£¹
(
ùl
 && 
pfds
);

329 ià(
ùl
->
İs
->
pŞl_desütÜs
)

330  
ùl
->
İs
->
	`pŞl_desütÜs
(ùl, 
pfds
, 
¥aû
);

331 ià(
ùl
->
pŞl_fd
 < 0)

333 ià(
¥aû
 > 0) {

334 
pfds
->
fd
 = 
ùl
->
pŞl_fd
;

335 
pfds
->
ev’ts
 = 
POLLIN
|
POLLERR
|
POLLNVAL
;

339 
	}
}

349 
	$¢d_ùl_pŞl_desütÜs_»v’ts
(
¢d_ùl_t
 *
ùl
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

351 
	`as£¹
(
ùl
 && 
pfds
 && 
»v’ts
);

352 ià(
ùl
->
İs
->
pŞl_»v’ts
)

353  
ùl
->
İs
->
	`pŞl_»v’ts
(ùl, 
pfds
, 
nfds
, 
»v’ts
);

354 ià(
nfds
 == 1) {

355 *
»v’ts
 = 
pfds
->revents;

358  -
EINVAL
;

359 
	}
}

367 
	$¢d_ùl_subsüibe_ev’ts
(
¢d_ùl_t
 *
ùl
, 
subsüibe
)

369 
	`as£¹
(
ùl
);

370  
ùl
->
İs
->
	`subsüibe_ev’ts
(ùl, 
subsüibe
);

371 
	}
}

385 
	$¢d_ùl_ÿrd_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_ÿrd_šfo_t
 *
šfo
)

387 
	`as£¹
(
ùl
 && 
šfo
);

388  
ùl
->
İs
->
	`ÿrd_šfo
(ùl, 
šfo
);

389 
	}
}

412 
	$¢d_ùl_–em_li¡
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_li¡_t
 *
li¡
)

414 
	`as£¹
(
ùl
 && 
li¡
);

415 
	`as£¹
(
li¡
->
¥aû
 =ğ0 ||†i¡->
pids
);

416  
ùl
->
İs
->
	`–em’t_li¡
(ùl, 
li¡
);

417 
	}
}

425 
	$¢d_ùl_–em_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
)

427 
	`as£¹
(
ùl
 && 
šfo
 && (šfo->
id
.
Çme
[0] || info->id.
numid
));

428  
ùl
->
İs
->
	`–em’t_šfo
(ùl, 
šfo
);

429 
	}
}

431 #iâdeà
DOC_HIDDEN


433 
boŞ
 
	$v®id©e_–em’t_memb”_dim’siÚ
(
¢d_ùl_–em_šfo_t
 *
šfo
)

435 
memb”s
;

436 
i
;

438 ià(
šfo
->
dim’
.
d
[0] == 0)

439  
Œue
;

441 
memb”s
 = 1;

442 
i
 = 0; i < 
	`ARRAY_SIZE
(
šfo
->
dim’
.
d
); ++i) {

443 ià(
šfo
->
dim’
.
d
[
i
] == 0)

445 
memb”s
 *ğ
šfo
->
dim’
.
d
[
i
];

447 ià(
memb”s
 > 
šfo
->
couÁ
)

448  
çl£
;

451 ++
i
; i < 
	`ARRAY_SIZE
(
šfo
->
dim’
.
d
); ++i) {

452 ià(
šfo
->
dim’
.
d
[
i
] > 0)

453  
çl£
;

456  
memb”s
 =ğ
šfo
->
couÁ
;

457 
	}
}

459 
	#v®id©e_–em’t_memb”_dim’siÚ
(
šfo
è
Œue


	)

462 
	#USER_ACCESS_DEFAULT
 (\

463 
SNDRV_CTL_ELEM_ACCESS_READWRITE
 |\

464 
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
 |\

465 
SNDRV_CTL_ELEM_ACCESS_USER
)

	)

467 
	#USER_ACCESS_SETTABLE
 (\

468 
SNDRV_CTL_ELEM_ACCESS_READWRITE
 |\

469 
SNDRV_CTL_ELEM_ACCESS_VOLATILE
 |\

470 
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
 |\

471 
SNDRV_CTL_ELEM_ACCESS_INACTIVE
 |\

472 
SNDRV_CTL_ELEM_ACCESS_USER
)

	)

474 
šlše
 
	$£t_u£r_acûss
(
¢d_ùl_–em_šfo_t
 *
šfo
)

476 ià(
šfo
->
acûss
 == 0) {

477 
šfo
->
acûss
 = 
USER_ACCESS_DEFAULT
;

479 ià((
šfo
->
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_READWRITE
) == 0)

481 ià(
šfo
->
acûss
 & ~
USER_ACCESS_SETTABLE
)

483 
šfo
->
acûss
 |ğ
SNDRV_CTL_ELEM_ACCESS_USER
;

486 
	}
}

488 
	$__¢d_ùl_add_–em_£t
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
,

489 
–em’t_couÁ
,

490 
memb”_couÁ
)

492 ià(
ùl
 =ğ
NULL
 || 
šfo
->
id
.
Çme
[0] == '\0')

493  -
EINVAL
;

495 ià(
	`£t_u£r_acûss
(
šfo
))

496  -
EINVAL
;

498 
šfo
->
owÃr
 = 
–em’t_couÁ
;

499 
šfo
->
couÁ
 = 
memb”_couÁ
;

501 ià(!
	`v®id©e_–em’t_memb”_dim’siÚ
(
šfo
))

502  -
EINVAL
;

504  
ùl
->
İs
->
	`–em’t_add
(ùl, 
šfo
);

505 
	}
}

551 
	$¢d_ùl_add_š‹g”_–em_£t
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
,

552 
–em’t_couÁ
,

553 
memb”_couÁ
,

554 
mš
, 
max
, 
¡•
)

556 
¢d_ùl_–em_v®ue_t
 
d©a
 = {0};

557 
i
;

558 
j
;

559 
numid
;

560 
”r
;

562 ià(
šfo
 =ğ
NULL
)

563  -
EINVAL
;

565 
šfo
->
ty³
 = 
SND_CTL_ELEM_TYPE_INTEGER
;

566 
šfo
->
v®ue
.
š‹g”
.
mš
 = min;

567 
šfo
->
v®ue
.
š‹g”
.
max
 = max;

568 
šfo
->
v®ue
.
š‹g”
.
¡•
 = step;

570 
”r
 = 
	`__¢d_ùl_add_–em_£t
(
ùl
, 
šfo
, 
–em’t_couÁ
, 
memb”_couÁ
);

571 ià(
”r
 < 0)

572  
”r
;

573 
numid
 = 
	`¢d_ùl_–em_id_g‘_numid
(&
šfo
->
id
);

576 
d©a
.
id
 = 
šfo
->id;

577 
i
 = 0; i < 
–em’t_couÁ
; i++) {

578 
	`¢d_ùl_–em_id_£t_numid
(&
d©a
.
id
, 
numid
 + 
i
);

580 
j
 = 0; j < 
memb”_couÁ
; j++)

581 
d©a
.
v®ue
.
š‹g”
.v®ue[
j
] = 
mš
;

583 
”r
 = 
ùl
->
İs
->
	`–em’t_wr™e
(ùl, &
d©a
);

584 ià(
”r
 < 0)

585  
”r
;

589 
	}
}

633 
	$¢d_ùl_add_š‹g”64_–em_£t
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
,

634 
–em’t_couÁ
,

635 
memb”_couÁ
,

636 
mš
, 
max
, 
¡•
)

638 
¢d_ùl_–em_v®ue_t
 
d©a
 = {0};

639 
i
;

640 
j
;

641 
numid
;

642 
”r
;

644 ià(
šfo
 =ğ
NULL
)

645  -
EINVAL
;

647 
šfo
->
ty³
 = 
SND_CTL_ELEM_TYPE_INTEGER64
;

648 
šfo
->
v®ue
.
š‹g”64
.
mš
 = min;

649 
šfo
->
v®ue
.
š‹g”64
.
max
 = max;

650 
šfo
->
v®ue
.
š‹g”64
.
¡•
 = step;

652 
”r
 = 
	`__¢d_ùl_add_–em_£t
(
ùl
, 
šfo
, 
–em’t_couÁ
, 
memb”_couÁ
);

653 ià(
”r
 < 0)

654  
”r
;

655 
numid
 = 
	`¢d_ùl_–em_id_g‘_numid
(&
šfo
->
id
);

658 
d©a
.
id
 = 
šfo
->id;

659 
i
 = 0; i < 
–em’t_couÁ
; i++) {

660 
	`¢d_ùl_–em_id_£t_numid
(&
d©a
.
id
, 
numid
 + 
i
);

662 
j
 = 0; j < 
memb”_couÁ
; j++)

663 
d©a
.
v®ue
.
š‹g”64
.v®ue[
j
] = 
mš
;

665 
”r
 = 
ùl
->
İs
->
	`–em’t_wr™e
(ùl, &
d©a
);

666 ià(
”r
 < 0)

667  
”r
;

671 
	}
}

711 
	$¢d_ùl_add_boŞ—n_–em_£t
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
,

712 
–em’t_couÁ
,

713 
memb”_couÁ
)

715 ià(
šfo
 =ğ
NULL
)

716  -
EINVAL
;

718 
šfo
->
ty³
 = 
SND_CTL_ELEM_TYPE_BOOLEAN
;

719 
šfo
->
v®ue
.
š‹g”
.
mš
 = 0;

720 
šfo
->
v®ue
.
š‹g”
.
max
 = 1;

722  
	`__¢d_ùl_add_–em_£t
(
ùl
, 
šfo
, 
–em’t_couÁ
, 
memb”_couÁ
);

723 
	}
}

768 
	$¢d_ùl_add_’um”©ed_–em_£t
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
,

769 
–em’t_couÁ
,

770 
memb”_couÁ
,

771 
™ems
,

772 cÚ¡ *cÚ¡ 
Ïb–s
[])

774 
i
, 
by‹s
;

775 *
buf
, *
p
;

776 
”r
;

778 ià(
šfo
 =ğ
NULL
 || 
Ïb–s
 == NULL)

779  -
EINVAL
;

781 
šfo
->
ty³
 = 
SND_CTL_ELEM_TYPE_ENUMERATED
;

782 
šfo
->
owÃr
 = 
–em’t_couÁ
;

783 
šfo
->
couÁ
 = 
memb”_couÁ
;

784 
šfo
->
v®ue
.
’um”©ed
.
™ems
 = items;

786 
by‹s
 = 0;

787 
i
 = 0; i < 
™ems
; ++i)

788 
by‹s
 +ğ
	`¡¾’
(
Ïb–s
[
i
]) + 1;

789 ià(
by‹s
 == 0)

790  -
EINVAL
;

791 
buf
 = 
	`m®loc
(
by‹s
);

792 ià(
buf
 =ğ
NULL
)

793  -
ENOMEM
;

794 
šfo
->
v®ue
.
’um”©ed
.
Çmes_±r
 = (
ušŒ_t
)
buf
;

795 
šfo
->
v®ue
.
’um”©ed
.
Çmes_Ëngth
 = 
by‹s
;

796 
p
 = 
buf
;

797 
i
 = 0; i < 
™ems
; ++i) {

798 
	`¡rıy
(
p
, 
Ïb–s
[
i
]);

799 
p
 +ğ
	`¡¾’
(
Ïb–s
[
i
]) + 1;

802 
”r
 = 
	`__¢d_ùl_add_–em_£t
(
ùl
, 
šfo
, 
–em’t_couÁ
, 
memb”_couÁ
);

804 
	`ä“
(
buf
);

806  
”r
;

807 
	}
}

848 
	$¢d_ùl_add_by‹s_–em_£t
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
,

849 
–em’t_couÁ
,

850 
memb”_couÁ
)

852 ià(
šfo
 =ğ
NULL
)

853  -
EINVAL
;

855 
šfo
->
ty³
 = 
SND_CTL_ELEM_TYPE_BYTES
;

857  
	`__¢d_ùl_add_–em_£t
(
ùl
, 
šfo
, 
–em’t_couÁ
, 
memb”_couÁ
);

858 
	}
}

867 
	$¢d_ùl_–em_add_š‹g”
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

868 
memb”_couÁ
,

869 
mš
, 
max
, 
¡•
)

871 
¢d_ùl_–em_šfo_t
 
šfo
 = {0};

873 
	`as£¹
(
ùl
 && 
id
 && id->
Çme
[0]);

875 
šfo
.
id
 = *id;

877  
	`¢d_ùl_add_š‹g”_–em_£t
(
ùl
, &
šfo
, 1, 
memb”_couÁ
,

878 
mš
, 
max
, 
¡•
);

879 
	}
}

888 
	$¢d_ùl_–em_add_š‹g”64
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

889 
memb”_couÁ
,

890 
mš
, 
max
, 
¡•
)

892 
¢d_ùl_–em_šfo_t
 
šfo
 = {0};

894 
	`as£¹
(
ùl
 && 
id
 && id->
Çme
[0]);

896 
šfo
.
id
 = *id;

898  
	`¢d_ùl_add_š‹g”64_–em_£t
(
ùl
, &
šfo
, 1, 
memb”_couÁ
,

899 
mš
, 
max
, 
¡•
);

900 
	}
}

909 
	$¢d_ùl_–em_add_boŞ—n
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

910 
memb”_couÁ
)

912 
¢d_ùl_–em_šfo_t
 
šfo
 = {0};

914 
	`as£¹
(
ùl
 && 
id
 && id->
Çme
[0]);

916 
šfo
.
id
 = *id;

918  
	`¢d_ùl_add_boŞ—n_–em_£t
(
ùl
, &
šfo
, 1, 
memb”_couÁ
);

919 
	}
}

930 
	$¢d_ùl_–em_add_’um”©ed
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

931 
memb”_couÁ
, 
™ems
,

932 cÚ¡ *cÚ¡ 
Ïb–s
[])

934 
¢d_ùl_–em_šfo_t
 
šfo
 = {0};

936 
	`as£¹
(
ùl
 && 
id
 && id->
Çme
[0] && 
Ïb–s
);

938 
šfo
.
id
 = *id;

940  
	`¢d_ùl_add_’um”©ed_–em_£t
(
ùl
, &
šfo
, 1, 
memb”_couÁ
,

941 
™ems
, 
Ïb–s
);

942 
	}
}

973 
	$¢d_ùl_–em_add_›c958
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
)

975 
¢d_ùl_–em_šfo_t
 
šfo
 = {0};

977 
	`as£¹
(
ùl
 && 
id
 && id->
Çme
[0]);

979 
šfo
.
id
 = *id;

980 
šfo
.
ty³
 = 
SND_CTL_ELEM_TYPE_IEC958
;

981 
šfo
.
owÃr
 = 1;

982 
šfo
.
couÁ
 = 1;

983  
ùl
->
İs
->
	`–em’t_add
(ùl, &
šfo
);

984 
	}
}

992 
	$¢d_ùl_–em_»move
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_id_t
 *
id
)

994 
	`as£¹
(
ùl
 && 
id
 && (id->
Çme
[0] || id->
numid
));

995  
ùl
->
İs
->
	`–em’t_»move
(ùl, 
id
);

996 
	}
}

1013 
	$¢d_ùl_–em_»ad
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_v®ue_t
 *
d©a
)

1015 
	`as£¹
(
ùl
 && 
d©a
 && (d©a->
id
.
Çme
[0] || d©a->id.
numid
));

1016  
ùl
->
İs
->
	`–em’t_»ad
(ùl, 
d©a
);

1017 
	}
}

1034 
	$¢d_ùl_–em_wr™e
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_v®ue_t
 *
d©a
)

1036 
	`as£¹
(
ùl
 && 
d©a
 && (d©a->
id
.
Çme
[0] || d©a->id.
numid
));

1037  
ùl
->
İs
->
	`–em’t_wr™e
(ùl, 
d©a
);

1038 
	}
}

1040 
	$¢d_ùl_v_do
(
¢d_ùl_t
 *
ùl
, 
İ_æag
,

1041 cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

1042 *
v
, 
v_size
)

1044 
¢d_ùl_–em_šfo_t
 *
šfo
 = 
NULL
;

1045 
”r
;

1047 ià(
id
->
numid
 == 0) {

1048 
šfo
 = 
	`ÿÎoc
(1, (*info));

1049 ià(
šfo
 =ğ
NULL
)

1050  -
ENOMEM
;

1051 
šfo
->
id
 = *id;

1052 
id
 = &
šfo
->id;

1053 
”r
 = 
	`¢d_ùl_–em_šfo
(
ùl
, 
šfo
);

1054 ià(
”r
 < 0)

1055 
__”r
;

1056 ià(
id
->
numid
 == 0) {

1057 
”r
 = -
ENOENT
;

1058 
__”r
;

1061 
”r
 = 
ùl
->
İs
->
	`–em’t_v
(ùl, 
İ_æag
, 
id
->
numid
, 
v
, 
v_size
);

1062 
__”r
:

1063 ià(
šfo
)

1064 
	`ä“
(
šfo
);

1065  
”r
;

1066 
	}
}

1083 
	$¢d_ùl_–em_v_»ad
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

1084 *
v
, 
v_size
)

1086 
”r
;

1087 
	`as£¹
(
ùl
 && 
id
 && (id->
Çme
[0] || id->
numid
è&& 
v
);

1088 ià(
v_size
 < 2 * ())

1089  -
EINVAL
;

1095 
v
[
SNDRV_CTL_TLVO_TYPE
] = -1;

1096 
v
[
SNDRV_CTL_TLVO_LEN
] = 0;

1097 
”r
 = 
	`¢d_ùl_v_do
(
ùl
, 0, 
id
, 
v
, 
v_size
);

1098 ià(
”r
 >ğ0 && 
v
[
SNDRV_CTL_TLVO_TYPE
] == ()-1)

1099 
”r
 = -
ENXIO
;

1100  
”r
;

1101 
	}
}

1120 
	$¢d_ùl_–em_v_wr™e
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

1121 cÚ¡ *
v
)

1123 
	`as£¹
(
ùl
 && 
id
 && (id->
Çme
[0] || id->
numid
è&& 
v
);

1124  
	`¢d_ùl_v_do
(
ùl
, 1, 
id
, (*)
v
,

1125 
v
[
SNDRV_CTL_TLVO_LEN
] + 2 * ());

1126 
	}
}

1145 
	$¢d_ùl_–em_v_commªd
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

1146 cÚ¡ *
v
)

1148 
	`as£¹
(
ùl
 && 
id
 && (id->
Çme
[0] || id->
numid
è&& 
v
);

1149  
	`¢d_ùl_v_do
(
ùl
, -1, 
id
, (*)
v
,

1150 
v
[
SNDRV_CTL_TLVO_LEN
] + 2 * ());

1151 
	}
}

1159 
	$¢d_ùl_–em_lock
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_id_t
 *
id
)

1161 
	`as£¹
(
ùl
 && 
id
);

1162  
ùl
->
İs
->
	`–em’t_lock
(ùl, 
id
);

1163 
	}
}

1171 
	$¢d_ùl_–em_uÆock
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_id_t
 *
id
)

1173 
	`as£¹
(
ùl
 && 
id
);

1174  
ùl
->
İs
->
	`–em’t_uÆock
(ùl, 
id
);

1175 
	}
}

1183 
	$¢d_ùl_hwd•_Ãxt_deviû
(
¢d_ùl_t
 *
ùl
, *
deviû
)

1185 
	`as£¹
(
ùl
 && 
deviû
);

1186  
ùl
->
İs
->
	`hwd•_Ãxt_deviû
(ùl, 
deviû
);

1187 
	}
}

1195 
	$¢d_ùl_hwd•_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_hwd•_šfo_t
 * 
šfo
)

1197 
	`as£¹
(
ùl
 && 
šfo
);

1198  
ùl
->
İs
->
	`hwd•_šfo
(ùl, 
šfo
);

1199 
	}
}

1207 
	$¢d_ùl_pcm_Ãxt_deviû
(
¢d_ùl_t
 *
ùl
, * 
deviû
)

1209 
	`as£¹
(
ùl
 && 
deviû
);

1210  
ùl
->
İs
->
	`pcm_Ãxt_deviû
(ùl, 
deviû
);

1211 
	}
}

1219 
	$¢d_ùl_pcm_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_pcm_šfo_t
 * 
šfo
)

1221 
	`as£¹
(
ùl
 && 
šfo
);

1222  
ùl
->
İs
->
	`pcm_šfo
(ùl, 
šfo
);

1223 
	}
}

1231 
	$¢d_ùl_pcm_´eãr_subdeviû
(
¢d_ùl_t
 *
ùl
, 
subdev
)

1233 
	`as£¹
(
ùl
);

1234  
ùl
->
İs
->
	`pcm_´eãr_subdeviû
(ùl, 
subdev
);

1235 
	}
}

1243 
	$¢d_ùl_¿wmidi_Ãxt_deviû
(
¢d_ùl_t
 *
ùl
, * 
deviû
)

1245 
	`as£¹
(
ùl
 && 
deviû
);

1246  
ùl
->
İs
->
	`¿wmidi_Ãxt_deviû
(ùl, 
deviû
);

1247 
	}
}

1255 
	$¢d_ùl_¿wmidi_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_¿wmidi_šfo_t
 * 
šfo
)

1257 
	`as£¹
(
ùl
 && 
šfo
);

1258  
ùl
->
İs
->
	`¿wmidi_šfo
(ùl, 
šfo
);

1259 
	}
}

1267 
	$¢d_ùl_¿wmidi_´eãr_subdeviû
(
¢d_ùl_t
 *
ùl
, 
subdev
)

1269 
	`as£¹
(
ùl
);

1270  
ùl
->
İs
->
	`¿wmidi_´eãr_subdeviû
(ùl, 
subdev
);

1271 
	}
}

1279 
	$¢d_ùl_ump_Ãxt_deviû
(
¢d_ùl_t
 *
ùl
, *
deviû
)

1281 
	`as£¹
(
ùl
 && 
deviû
);

1282 ià(
ùl
->
İs
->
ump_Ãxt_deviû
)

1283  
ùl
->
İs
->
	`ump_Ãxt_deviû
(ùl, 
deviû
);

1284  -
ENXIO
;

1285 
	}
}

1293 
	$¢d_ùl_ump_’dpošt_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

1295 
	`as£¹
(
ùl
 && 
šfo
);

1296  
ùl
->
İs
->
	`ump_’dpošt_šfo
(ùl, 
šfo
);

1297 
	}
}

1305 
	$¢d_ùl_ump_block_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_ump_block_šfo_t
 *
šfo
)

1307 
	`as£¹
(
ùl
 && 
šfo
);

1308  
ùl
->
İs
->
	`ump_block_šfo
(ùl, 
šfo
);

1309 
	}
}

1317 
	$¢d_ùl_£t_pow”_¡©e
(
¢d_ùl_t
 *
ùl
, 
¡©e
)

1319 
	`as£¹
(
ùl
);

1320 ià(
ùl
->
İs
->
£t_pow”_¡©e
)

1321  
ùl
->
İs
->
	`£t_pow”_¡©e
(ùl, 
¡©e
);

1322  -
ENXIO
;

1323 
	}
}

1331 
	$¢d_ùl_g‘_pow”_¡©e
(
¢d_ùl_t
 *
ùl
, *
¡©e
)

1333 
	`as£¹
(
ùl
);

1334 ià(
ùl
->
İs
->
g‘_pow”_¡©e
)

1335  
ùl
->
İs
->
	`g‘_pow”_¡©e
(ùl, 
¡©e
);

1336  -
ENXIO
;

1337 
	}
}

1345 
	$¢d_ùl_»ad
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_ev’t_t
 *
ev’t
)

1347 
	`as£¹
(
ùl
 && 
ev’t
);

1348  (
ùl
->
İs
->
»ad
)(ùl, 
ev’t
);

1349 
	}
}

1357 
	$¢d_ùl_wa™
(
¢d_ùl_t
 *
ùl
, 
timeout
)

1359 
pŞlfd
 *
pfd
;

1360 
»v’ts
;

1361 
Åfds
, 
”r
, 
”r_pŞl
;

1363 
Åfds
 = 
	`¢d_ùl_pŞl_desütÜs_couÁ
(
ùl
);

1364 ià(
Åfds
 <= 0 ||‚pfds >= 16) {

1365 
	`SNDERR
("Inv®id…Şl_fd %d", 
Åfds
);

1366  -
EIO
;

1368 
pfd
 = 
	`®loÿ
((*pfdè* 
Åfds
);

1369 
”r
 = 
	`¢d_ùl_pŞl_desütÜs
(
ùl
, 
pfd
, 
Åfds
);

1370 ià(
”r
 < 0)

1371  
”r
;

1372 ià(
”r
 !ğ
Åfds
) {

1373 
	`SNDMSG
("šv®id…ŞÈdesütÜ %d", 
”r
);

1374  -
EIO
;

1377 
”r_pŞl
 = 
	`pŞl
(
pfd
, 
Åfds
, 
timeout
);

1378 ià(
”r_pŞl
 < 0)

1379  -
”ºo
;

1380 ià(! 
”r_pŞl
)

1382 
”r
 = 
	`¢d_ùl_pŞl_desütÜs_»v’ts
(
ùl
, 
pfd
, 
Åfds
, &
»v’ts
);

1383 ià(
”r
 < 0)

1384  
”r
;

1385 ià(
»v’ts
 & (
POLLERR
 | 
POLLNVAL
))

1386  -
EIO
;

1387 ià(
»v’ts
 & (
POLLIN
 | 
POLLOUT
))

1390 
	}
}

1400 
	$¢d_async_add_ùl_hªdËr
(
¢d_async_hªdËr_t
 **
hªdËr
, 
¢d_ùl_t
 *
ùl
,

1401 
¢d_async_ÿÎback_t
 
ÿÎback
, *
´iv©e_d©a
)

1403 
”r
;

1404 
was_em±y
;

1405 
¢d_async_hªdËr_t
 *
h
;

1406 
”r
 = 
	`¢d_async_add_hªdËr
(&
h
, 
	`_¢d_ùl_async_desütÜ
(
ùl
),

1407 
ÿÎback
, 
´iv©e_d©a
);

1408 ià(
”r
 < 0)

1409  
”r
;

1410 
h
->
ty³
 = 
SND_ASYNC_HANDLER_CTL
;

1411 
h
->
u
.
ùl
 = ctl;

1412 
was_em±y
 = 
	`li¡_em±y
(&
ùl
->
async_hªdËrs
);

1413 
	`li¡_add_
(&
h
->
hli¡
, &
ùl
->
async_hªdËrs
);

1414 ià(
was_em±y
) {

1415 
”r
 = 
	`¢d_ùl_async
(
ùl
, 
	`¢d_async_hªdËr_g‘_signo
(
h
), 
	`g‘pid
());

1416 ià(
”r
 < 0) {

1417 
	`¢d_async_d–_hªdËr
(
h
);

1418  
”r
;

1421 *
hªdËr
 = 
h
;

1423 
	}
}

1430 
¢d_ùl_t
 *
	$¢d_async_hªdËr_g‘_ùl
(
¢d_async_hªdËr_t
 *
hªdËr
)

1432 
	`as£¹
(
hªdËr
->
ty³
 =ğ
SND_ASYNC_HANDLER_CTL
);

1433  
hªdËr
->
u
.
ùl
;

1434 
	}
}

1436 cÚ¡ *cÚ¡ 
	gbud_š_ùls
[] = {

1437 "hw", "em±y", "»m­", "shm", 
NULL


1440 
	$¢d_ùl_İ’_cÚf
(
¢d_ùl_t
 **
ùÍ
, cÚ¡ *
Çme
,

1441 
¢d_cÚfig_t
 *
ùl_roÙ
, snd_cÚfig_ˆ*
ùl_cÚf
, 
mode
)

1443 cÚ¡ *
¡r
;

1444 *
buf
 = 
NULL
, *
buf1
 = NULL;

1445 
”r
;

1446 
¢d_cÚfig_t
 *
cÚf
, *
ty³_cÚf
 = 
NULL
;

1447 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1448 cÚ¡ *
lib
 = 
NULL
, *
İ’_Çme
 = NULL;

1449 cÚ¡ *
id
;

1450 (*
İ’_func
)(
¢d_ùl_t
 **, cÚ¡ *, 
¢d_cÚfig_t
 *, snd_cÚfig_ˆ*, èğ
NULL
;

1451 #iâdeà
PIC


1452 *
	`¢d_cÚŒŞ_İ’_symbŞs
();

1454 ià(
	`¢d_cÚfig_g‘_ty³
(
ùl_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1455 ià(
Çme
)

1456 
	`SNDERR
("Inv®idy³ fÜ CTL % defš™iÚ", 
Çme
);

1458 
	`SNDERR
("Invalidype for CTL definition");

1459  -
EINVAL
;

1461 
”r
 = 
	`¢d_cÚfig_£¬ch
(
ùl_cÚf
, "ty³", &
cÚf
);

1462 ià(
”r
 < 0) {

1463 
	`SNDERR
("type is‚ot defined");

1464  
”r
;

1466 
”r
 = 
	`¢d_cÚfig_g‘_id
(
cÚf
, &
id
);

1467 ià(
”r
 < 0) {

1468 
	`SNDERR
("unableo get id");

1469  
”r
;

1471 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
cÚf
, &
¡r
);

1472 ià(
”r
 < 0) {

1473 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1474  
”r
;

1476 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
ùl_roÙ
, "ùl_ty³", 
¡r
, &
ty³_cÚf
);

1477 ià(
”r
 >= 0) {

1478 ià(
	`¢d_cÚfig_g‘_ty³
(
ty³_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1479 
	`SNDERR
("Inv®idy³ fÜ CTLy³ % defš™iÚ", 
¡r
);

1480 
”r
 = -
EINVAL
;

1481 
_”r
;

1483 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
ty³_cÚf
) {

1484 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1485 cÚ¡ *
id
;

1486 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1488 ià(
	`¡rcmp
(
id
, "comment") == 0)

1490 ià(
	`¡rcmp
(
id
, "lib") == 0) {

1491 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
lib
);

1492 ià(
”r
 < 0) {

1493 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1494 
_”r
;

1498 ià(
	`¡rcmp
(
id
, "open") == 0) {

1499 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
İ’_Çme
);

1500 ià(
”r
 < 0) {

1501 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1502 
_”r
;

1506 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

1507 
”r
 = -
EINVAL
;

1508 
_”r
;

1511 ià(!
İ’_Çme
) {

1512 
buf
 = 
	`m®loc
(
	`¡¾’
(
¡r
) + 32);

1513 ià(
buf
 =ğ
NULL
) {

1514 
”r
 = -
ENOMEM
;

1515 
_”r
;

1517 
İ’_Çme
 = 
buf
;

1518 
	`¥rštf
(
buf
, "_¢d_ùl_%s_İ’", 
¡r
);

1520 ià(!
lib
) {

1521 cÚ¡ *cÚ¡ *
bud_š
 = 
bud_š_ùls
;

1522 *
bud_š
) {

1523 ià(!
	`¡rcmp
(*
bud_š
, 
¡r
))

1525 
bud_š
++;

1527 ià(*
bud_š
 =ğ
NULL
) {

1528 
buf1
 = 
	`m®loc
(
	`¡¾’
(
¡r
) + 32);

1529 ià(
buf1
 =ğ
NULL
) {

1530 
”r
 = -
ENOMEM
;

1531 
_”r
;

1533 
lib
 = 
buf1
;

1534 
	`¥rštf
(
buf1
, "libasound_moduË_ùl_%s.so", 
¡r
);

1537 #iâdeà
PIC


1538 
	`¢d_cÚŒŞ_İ’_symbŞs
();

1540 
İ’_func
 = 
	`¢d_dlobj_ÿche_g‘
(
lib
, 
İ’_Çme
,

1541 
	`SND_DLSYM_VERSION
(
SND_CONTROL_DLSYM_VERSION
), 1);

1542 ià(
İ’_func
) {

1543 
”r
 = 
	`İ’_func
(
ùÍ
, 
Çme
, 
ùl_roÙ
, 
ùl_cÚf
, 
mode
);

1544 ià(
”r
 >= 0) {

1545 (*
ùÍ
)->
İ’_func
 = open_func;

1546 
”r
 = 0;

1548 
	`¢d_dlobj_ÿche_put
(
İ’_func
);

1551 
”r
 = -
ENXIO
;

1553 
_”r
:

1554 ià(
ty³_cÚf
)

1555 
	`¢d_cÚfig_d–‘e
(
ty³_cÚf
);

1556 
	`ä“
(
buf
);

1557 
	`ä“
(
buf1
);

1558  
”r
;

1559 
	}
}

1561 
	$¢d_ùl_İ’_noupd©e
(
¢d_ùl_t
 **
ùÍ
, 
¢d_cÚfig_t
 *
roÙ
,

1562 cÚ¡ *
Çme
, 
mode
, 
hİ
)

1564 
”r
;

1565 
¢d_cÚfig_t
 *
ùl_cÚf
;

1566 cÚ¡ *
¡r
;

1568 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "ùl", 
Çme
, &
ùl_cÚf
);

1569 ià(
”r
 < 0) {

1570 
	`SNDERR
("Inv®id CTL %s", 
Çme
);

1571  
”r
;

1573 ià(
	`¢d_cÚfig_g‘_¡ršg
(
ùl_cÚf
, &
¡r
) >= 0)

1574 
”r
 = 
	`¢d_ùl_İ’_noupd©e
(
ùÍ
, 
roÙ
, 
¡r
, 
mode
, 
hİ
 + 1);

1576 
	`¢d_cÚfig_£t_hİ
(
ùl_cÚf
, 
hİ
);

1577 
”r
 = 
	`¢d_ùl_İ’_cÚf
(
ùÍ
, 
Çme
, 
roÙ
, 
ùl_cÚf
, 
mode
);

1579 
	`¢d_cÚfig_d–‘e
(
ùl_cÚf
);

1580  
”r
;

1581 
	}
}

1583 #iâdeà
DOC_HIDDEN


1584 
	$_¢d_ùl_İ’_Çmed_chd
(
¢d_ùl_t
 **
pùl
, cÚ¡ *
Çme
,

1585 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

1586 
mode
, 
¢d_cÚfig_t
 *
·»Á_cÚf
)

1588 cÚ¡ *
¡r
;

1589 
hİ
;

1591 ià((
hİ
 = 
	`¢d_cÚfig_check_hİ
(
·»Á_cÚf
)) < 0)

1592  
hİ
;

1593 ià(
	`¢d_cÚfig_g‘_¡ršg
(
cÚf
, &
¡r
) >= 0)

1594  
	`¢d_ùl_İ’_noupd©e
(
pùl
, 
roÙ
, 
¡r
, 
mode
, 
hİ
 + 1);

1595  
	`¢d_ùl_İ’_cÚf
(
pùl
, 
Çme
, 
roÙ
, 
cÚf
, 
mode
);

1596 
	}
}

1608 
	$¢d_ùl_İ’
(
¢d_ùl_t
 **
ùÍ
, cÚ¡ *
Çme
, 
mode
)

1610 
¢d_cÚfig_t
 *
tİ
;

1611 
”r
;

1613 
	`as£¹
(
ùÍ
 && 
Çme
);

1614 ià(
	`_¢d_is_ucm_deviû
(
Çme
)) {

1615 
Çme
 = 
	`uc_mgr_®ibcfg_by_deviû
(&
tİ
,‚ame);

1616 ià(
Çme
 =ğ
NULL
)

1617  -
ENODEV
;

1619 
”r
 = 
	`¢d_cÚfig_upd©e_»f
(&
tİ
);

1620 ià(
”r
 < 0)

1621  
”r
;

1623 
”r
 = 
	`¢d_ùl_İ’_noupd©e
(
ùÍ
, 
tİ
, 
Çme
, 
mode
, 0);

1624 
	`¢d_cÚfig_uÄef
(
tİ
);

1625  
”r
;

1626 
	}
}

1636 
	$¢d_ùl_İ’_lcÚf
(
¢d_ùl_t
 **
ùÍ
, cÚ¡ *
Çme
,

1637 
mode
, 
¢d_cÚfig_t
 *
lcÚf
)

1639 
	`as£¹
(
ùÍ
 && 
Çme
 && 
lcÚf
);

1640  
	`¢d_ùl_İ’_noupd©e
(
ùÍ
, 
lcÚf
, 
Çme
, 
mode
, 0);

1641 
	}
}

1652 
	$¢d_ùl_İ’_çÎback
(
¢d_ùl_t
 **
ùÍ
, 
¢d_cÚfig_t
 *
roÙ
,

1653 cÚ¡ *
Çme
, cÚ¡ *
Üig_Çme
, 
mode
)

1655 
”r
;

1656 
	`as£¹
(
ùÍ
 && 
Çme
 && 
roÙ
);

1657 
”r
 = 
	`¢d_ùl_İ’_noupd©e
(
ùÍ
, 
roÙ
, 
Çme
, 
mode
, 0);

1658 ià(
”r
 >= 0) {

1659 
	`ä“
((*
ùÍ
)->
Çme
);

1660 (*
ùÍ
)->
Çme
 = 
Üig_Çme
 ? 
	`¡rdup
(Üig_Çmeè: 
NULL
;

1662  
”r
;

1663 
	}
}

1665 #iâdeà
DOC_HIDDEN


1666 
	#TYPE
(
v
è[
SND_CTL_ELEM_TYPE_
##v] = #v

	)

1667 
	#IFACE
(
v
è[
SND_CTL_ELEM_IFACE_
##v] = #v

	)

1668 
	#IFACE1
(
v
, 
n
è[
SND_CTL_ELEM_IFACE_
##v] = #n

	)

1669 
	#EVENT
(
v
è[
SND_CTL_EVENT_
##v] = #v

	)

1671 cÚ¡ *cÚ¡ 
	g¢d_ùl_–em_ty³_Çmes
[] = {

1672 
TYPE
(
NONE
),

1673 
TYPE
(
BOOLEAN
),

1674 
TYPE
(
INTEGER
),

1675 
TYPE
(
ENUMERATED
),

1676 
TYPE
(
BYTES
),

1677 
TYPE
(
IEC958
),

1678 
TYPE
(
INTEGER64
),

1681 cÚ¡ *cÚ¡ 
	g¢d_ùl_–em_içû_Çmes
[] = {

1682 
IFACE
(
CARD
),

1683 
IFACE
(
HWDEP
),

1684 
IFACE
(
MIXER
),

1685 
IFACE
(
PCM
),

1686 
IFACE
(
RAWMIDI
),

1687 
IFACE
(
TIMER
),

1688 
IFACE
(
SEQUENCER
),

1691 cÚ¡ *cÚ¡ 
	g¢d_ùl_ev’t_ty³_Çmes
[] = {

1692 
EVENT
(
ELEM
),

1701 cÚ¡ *
	$¢d_ùl_–em_ty³_Çme
(
¢d_ùl_–em_ty³_t
 
ty³
)

1703 
	`as£¹
(
ty³
 <ğ
SND_CTL_ELEM_TYPE_LAST
);

1704  
¢d_ùl_–em_ty³_Çmes
[
ty³
];

1705 
	}
}

1712 cÚ¡ *
	$¢d_ùl_–em_içû_Çme
(
¢d_ùl_–em_içû_t
 
içû
)

1714 
	`as£¹
(
içû
 <ğ
SND_CTL_ELEM_IFACE_LAST
);

1715  
¢d_ùl_–em_içû_Çmes
[
içû
];

1716 
	}
}

1723 cÚ¡ *
	$¢d_ùl_ev’t_ty³_Çme
(
¢d_ùl_ev’t_ty³_t
 
ty³
)

1725 
	`as£¹
(
ty³
 <ğ
SND_CTL_EVENT_LAST
);

1726  
¢d_ùl_ev’t_ty³_Çmes
[
ty³
];

1727 
	}
}

1740 
	$¢d_ùl_–em_li¡_®loc_¥aû
(
¢d_ùl_–em_li¡_t
 *
obj
, 
’Œ›s
)

1742 
	`ä“
(
obj
->
pids
);

1743 
obj
->
pids
 = 
	`ÿÎoc
(
’Œ›s
, (*obj->pids));

1744 ià(!
obj
->
pids
) {

1745 
obj
->
¥aû
 = 0;

1746  -
ENOMEM
;

1748 
obj
->
¥aû
 = 
’Œ›s
;

1750 
	}
}

1760 
	$¢d_ùl_–em_li¡_ä“_¥aû
(
¢d_ùl_–em_li¡_t
 *
obj
)

1762 
	`ä“
(
obj
->
pids
);

1763 
obj
->
pids
 = 
NULL
;

1764 
obj
->
¥aû
 = 0;

1765 
	}
}

1772 
	$¢d_ùl_ev’t_–em_g‘_mask
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
)

1774 
	`as£¹
(
obj
);

1775 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_EVENT_ELEM
);

1776  
obj
->
d©a
.
–em
.
mask
;

1777 
	}
}

1784 
	$¢d_ùl_ev’t_–em_g‘_id
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
, 
¢d_ùl_–em_id_t
 *
±r
)

1786 
	`as£¹
(
obj
 && 
±r
);

1787 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_EVENT_ELEM
);

1788 *
±r
 = 
obj
->
d©a
.
–em
.
id
;

1789 
	}
}

1796 
	$¢d_ùl_ev’t_–em_g‘_numid
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
)

1798 
	`as£¹
(
obj
);

1799 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_EVENT_ELEM
);

1800  
obj
->
d©a
.
–em
.
id
.
numid
;

1801 
	}
}

1808 
¢d_ùl_–em_içû_t
 
	$¢d_ùl_ev’t_–em_g‘_š‹rçû
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
)

1810 
	`as£¹
(
obj
);

1811 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_EVENT_ELEM
);

1812  
obj
->
d©a
.
–em
.
id
.
içû
;

1813 
	}
}

1820 
	$¢d_ùl_ev’t_–em_g‘_deviû
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
)

1822 
	`as£¹
(
obj
);

1823 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_EVENT_ELEM
);

1824  
obj
->
d©a
.
–em
.
id
.
deviû
;

1825 
	}
}

1832 
	$¢d_ùl_ev’t_–em_g‘_subdeviû
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
)

1834 
	`as£¹
(
obj
);

1835 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_EVENT_ELEM
);

1836  
obj
->
d©a
.
–em
.
id
.
subdeviû
;

1837 
	}
}

1844 cÚ¡ *
	$¢d_ùl_ev’t_–em_g‘_Çme
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
)

1846 
	`as£¹
(
obj
);

1847 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_EVENT_ELEM
);

1848  (cÚ¡ *)
obj
->
d©a
.
–em
.
id
.
Çme
;

1849 
	}
}

1856 
	$¢d_ùl_ev’t_–em_g‘_šdex
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
)

1858 
	`as£¹
(
obj
);

1859 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_EVENT_ELEM
);

1860  
obj
->
d©a
.
–em
.
id
.
šdex
;

1861 
	}
}

1863 #iâdeà
DOC_HIDDEN


1864 
	$_¢d_ùl_pŞl_desütÜ
(
¢d_ùl_t
 *
ùl
)

1866 
	`as£¹
(
ùl
);

1867  
ùl
->
pŞl_fd
;

1868 
	}
}

1875 
size_t
 
	$¢d_ùl_–em_id_sizeof
()

1877  (
¢d_ùl_–em_id_t
);

1878 
	}
}

1885 
	$¢d_ùl_–em_id_m®loc
(
¢d_ùl_–em_id_t
 **
±r
)

1887 
	`as£¹
(
±r
);

1888 *
±r
 = 
	`ÿÎoc
(1, (
¢d_ùl_–em_id_t
));

1889 ià(!*
±r
)

1890  -
ENOMEM
;

1892 
	}
}

1898 
	$¢d_ùl_–em_id_ä“
(
¢d_ùl_–em_id_t
 *
obj
)

1900 
	`ä“
(
obj
);

1901 
	}
}

1907 
	$¢d_ùl_–em_id_ş—r
(
¢d_ùl_–em_id_t
 *
obj
)

1909 
	`mem£t
(
obj
, 0, (
¢d_ùl_–em_id_t
));

1910 
	}
}

1917 
	$¢d_ùl_–em_id_cİy
(
¢d_ùl_–em_id_t
 *
d¡
, cÚ¡ snd_ùl_–em_id_ˆ*
¤c
)

1919 
	`as£¹
(
d¡
 && 
¤c
);

1920 *
d¡
 = *
¤c
;

1921 
	}
}

1934 
	$¢d_ùl_–em_id_com·»_numid
(cÚ¡ 
¢d_ùl_–em_id_t
 *
id1
, cÚ¡ snd_ùl_–em_id_ˆ*
id2
)

1936 
št64_t
 
d
;

1938 
	`as£¹
(
id1
 && 
id2
);

1939 
d
 = (
št64_t
)
id1
->
numid
 - (št64_t)
id2
->numid;

1940 ià(
d
 & ((
št64_t
)
INT_MAX
 + 1)) {

1941 ià(
d
 > 
INT_MAX
)

1942 
d
 = 
INT_MAX
;

1943 ià(
d
 < 
INT_MIN
)

1944 
d
 = 
INT_MIN
;

1946  
d
;

1947 
	}
}

1964 
	$¢d_ùl_–em_id_com·»_£t
(cÚ¡ 
¢d_ùl_–em_id_t
 *
id1
, cÚ¡ snd_ùl_–em_id_ˆ*
id2
)

1966 
d
;

1968 
	`as£¹
(
id1
 && 
id2
);

1971 
	`as£¹
((
id1
->
içû
 | id1->
deviû
 | id1->
subdeviû
 | id1->
šdex
è<ğ
INT_MAX
);

1972 
	`as£¹
((
id2
->
içû
 | id2->
deviû
 | id2->
subdeviû
 | 
id1
->
šdex
è<ğ
INT_MAX
);

1973 
d
 = 
id1
->
içû
 - 
id2
->iface;

1974 ià(
d
 != 0)

1975  
d
;

1976 
d
 = 
id1
->
deviû
 - 
id2
->device;

1977 ià(
d
 != 0)

1978  
d
;

1979 
d
 = 
id1
->
subdeviû
 - 
id2
->subdevice;

1980 ià(
d
 != 0)

1981  
d
;

1982 
d
 = 
	`¡rcmp
((cÚ¡ *)
id1
->
Çme
, (cÚ¡ *)
id2
->name);

1983 ià(
d
 != 0)

1984  
d
;

1985  
id1
->
šdex
 - 
id2
->index;

1986 
	}
}

1993 
	$¢d_ùl_–em_id_g‘_numid
(cÚ¡ 
¢d_ùl_–em_id_t
 *
obj
)

1995 
	`as£¹
(
obj
);

1996  
obj
->
numid
;

1997 
	}
}

2004 
¢d_ùl_–em_içû_t
 
	$¢d_ùl_–em_id_g‘_š‹rçû
(cÚ¡ 
¢d_ùl_–em_id_t
 *
obj
)

2006 
	`as£¹
(
obj
);

2007  
obj
->
içû
;

2008 
	}
}

2015 
	$¢d_ùl_–em_id_g‘_deviû
(cÚ¡ 
¢d_ùl_–em_id_t
 *
obj
)

2017 
	`as£¹
(
obj
);

2018  
obj
->
deviû
;

2019 
	}
}

2026 
	$¢d_ùl_–em_id_g‘_subdeviû
(cÚ¡ 
¢d_ùl_–em_id_t
 *
obj
)

2028 
	`as£¹
(
obj
);

2029  
obj
->
subdeviû
;

2030 
	}
}

2037 cÚ¡ *
	$¢d_ùl_–em_id_g‘_Çme
(cÚ¡ 
¢d_ùl_–em_id_t
 *
obj
)

2039 
	`as£¹
(
obj
);

2040  (cÚ¡ *)
obj
->
Çme
;

2041 
	}
}

2048 
	$¢d_ùl_–em_id_g‘_šdex
(cÚ¡ 
¢d_ùl_–em_id_t
 *
obj
)

2050 
	`as£¹
(
obj
);

2051  
obj
->
šdex
;

2052 
	}
}

2059 
	$¢d_ùl_–em_id_£t_numid
(
¢d_ùl_–em_id_t
 *
obj
, 
v®
)

2061 
	`as£¹
(
obj
);

2062 
obj
->
numid
 = 
v®
;

2063 
	}
}

2070 
	$¢d_ùl_–em_id_£t_š‹rçû
(
¢d_ùl_–em_id_t
 *
obj
, 
¢d_ùl_–em_içû_t
 
v®
)

2072 
	`as£¹
(
obj
);

2073 
obj
->
içû
 = 
v®
;

2074 
	}
}

2081 
	$¢d_ùl_–em_id_£t_deviû
(
¢d_ùl_–em_id_t
 *
obj
, 
v®
)

2083 
	`as£¹
(
obj
);

2084 
obj
->
deviû
 = 
v®
;

2085 
	}
}

2092 
	$¢d_ùl_–em_id_£t_subdeviû
(
¢d_ùl_–em_id_t
 *
obj
, 
v®
)

2094 
	`as£¹
(
obj
);

2095 
obj
->
subdeviû
 = 
v®
;

2096 
	}
}

2103 
	$¢d_ùl_–em_id_£t_Çme
(
¢d_ùl_–em_id_t
 *
obj
, cÚ¡ *
v®
)

2105 
	`as£¹
(
obj
);

2106 
	`¢d_¡¾ıy
((*)
obj
->
Çme
, 
v®
, (obj->name));

2107 
	}
}

2114 
	$¢d_ùl_–em_id_£t_šdex
(
¢d_ùl_–em_id_t
 *
obj
, 
v®
)

2116 
	`as£¹
(
obj
);

2117 
obj
->
šdex
 = 
v®
;

2118 
	}
}

2124 
size_t
 
	$¢d_ùl_ÿrd_šfo_sizeof
()

2126  (
¢d_ùl_ÿrd_šfo_t
);

2127 
	}
}

2141 
	$¢d_ùl_ÿrd_šfo_m®loc
(
¢d_ùl_ÿrd_šfo_t
 **
±r
)

2143 
	`as£¹
(
±r
);

2144 *
±r
 = 
	`ÿÎoc
(1, (
¢d_ùl_ÿrd_šfo_t
));

2145 ià(!*
±r
)

2146  -
ENOMEM
;

2148 
	}
}

2156 
	$¢d_ùl_ÿrd_šfo_ä“
(
¢d_ùl_ÿrd_šfo_t
 *
obj
)

2158 
	`ä“
(
obj
);

2159 
	}
}

2168 
	$¢d_ùl_ÿrd_šfo_ş—r
(
¢d_ùl_ÿrd_šfo_t
 *
obj
)

2170 
	`mem£t
(
obj
, 0, (
¢d_ùl_ÿrd_šfo_t
));

2171 
	}
}

2179 
	$¢d_ùl_ÿrd_šfo_cİy
(
¢d_ùl_ÿrd_šfo_t
 *
d¡
, cÚ¡ snd_ùl_ÿrd_šfo_ˆ*
¤c
)

2181 
	`as£¹
(
d¡
 && 
¤c
);

2182 *
d¡
 = *
¤c
;

2183 
	}
}

2193 
	$¢d_ùl_ÿrd_šfo_g‘_ÿrd
(cÚ¡ 
¢d_ùl_ÿrd_šfo_t
 *
obj
)

2195 
	`as£¹
(
obj
);

2196  
obj
->
ÿrd
;

2197 
	}
}

2207 cÚ¡ *
	$¢d_ùl_ÿrd_šfo_g‘_id
(cÚ¡ 
¢d_ùl_ÿrd_šfo_t
 *
obj
)

2209 
	`as£¹
(
obj
);

2210  (cÚ¡ *)
obj
->
id
;

2211 
	}
}

2221 cÚ¡ *
	$¢d_ùl_ÿrd_šfo_g‘_driv”
(cÚ¡ 
¢d_ùl_ÿrd_šfo_t
 *
obj
)

2223 
	`as£¹
(
obj
);

2224  (cÚ¡ *)
obj
->
driv”
;

2225 
	}
}

2235 cÚ¡ *
	$¢d_ùl_ÿrd_šfo_g‘_Çme
(cÚ¡ 
¢d_ùl_ÿrd_šfo_t
 *
obj
)

2237 
	`as£¹
(
obj
);

2238  (cÚ¡ *)
obj
->
Çme
;

2239 
	}
}

2249 cÚ¡ *
	$¢d_ùl_ÿrd_šfo_g‘_lÚgÇme
(cÚ¡ 
¢d_ùl_ÿrd_šfo_t
 *
obj
)

2251 
	`as£¹
(
obj
);

2252  (cÚ¡ *)
obj
->
lÚgÇme
;

2253 
	}
}

2263 cÚ¡ *
	$¢d_ùl_ÿrd_šfo_g‘_mix”Çme
(cÚ¡ 
¢d_ùl_ÿrd_šfo_t
 *
obj
)

2265 
	`as£¹
(
obj
);

2266  (cÚ¡ *)
obj
->
mix”Çme
;

2267 
	}
}

2277 cÚ¡ *
	$¢d_ùl_ÿrd_šfo_g‘_compÚ’ts
(cÚ¡ 
¢d_ùl_ÿrd_šfo_t
 *
obj
)

2279 
	`as£¹
(
obj
);

2280  (cÚ¡ *)
obj
->
compÚ’ts
;

2281 
	}
}

2287 
size_t
 
	$¢d_ùl_ev’t_sizeof
()

2289  (
¢d_ùl_ev’t_t
);

2290 
	}
}

2297 
	$¢d_ùl_ev’t_m®loc
(
¢d_ùl_ev’t_t
 **
±r
)

2299 
	`as£¹
(
±r
);

2300 *
±r
 = 
	`ÿÎoc
(1, (
¢d_ùl_ev’t_t
));

2301 ià(!*
±r
)

2302  -
ENOMEM
;

2304 
	}
}

2310 
	$¢d_ùl_ev’t_ä“
(
¢d_ùl_ev’t_t
 *
obj
)

2312 
	`ä“
(
obj
);

2313 
	}
}

2319 
	$¢d_ùl_ev’t_ş—r
(
¢d_ùl_ev’t_t
 *
obj
)

2321 
	`mem£t
(
obj
, 0, (
¢d_ùl_ev’t_t
));

2322 
	}
}

2329 
	$¢d_ùl_ev’t_cİy
(
¢d_ùl_ev’t_t
 *
d¡
, cÚ¡ snd_ùl_ev’t_ˆ*
¤c
)

2331 
	`as£¹
(
d¡
 && 
¤c
);

2332 *
d¡
 = *
¤c
;

2333 
	}
}

2340 
¢d_ùl_ev’t_ty³_t
 
	$¢d_ùl_ev’t_g‘_ty³
(cÚ¡ 
¢d_ùl_ev’t_t
 *
obj
)

2342 
	`as£¹
(
obj
);

2343  
obj
->
ty³
;

2344 
	}
}

2350 
size_t
 
	$¢d_ùl_–em_li¡_sizeof
()

2352  (
¢d_ùl_–em_li¡_t
);

2353 
	}
}

2363 
	$¢d_ùl_–em_li¡_m®loc
(
¢d_ùl_–em_li¡_t
 **
±r
)

2365 
	`as£¹
(
±r
);

2366 *
±r
 = 
	`ÿÎoc
(1, (
¢d_ùl_–em_li¡_t
));

2367 ià(!*
±r
)

2368  -
ENOMEM
;

2370 
	}
}

2384 
	$¢d_ùl_–em_li¡_ä“
(
¢d_ùl_–em_li¡_t
 *
obj
)

2386 
	`ä“
(
obj
);

2387 
	}
}

2401 
	$¢d_ùl_–em_li¡_ş—r
(
¢d_ùl_–em_li¡_t
 *
obj
)

2403 
	`mem£t
(
obj
, 0, (
¢d_ùl_–em_li¡_t
));

2404 
	}
}

2415 
	$¢d_ùl_–em_li¡_cİy
(
¢d_ùl_–em_li¡_t
 *
d¡
, cÚ¡ snd_ùl_–em_li¡_ˆ*
¤c
)

2417 
	`as£¹
(
d¡
 && 
¤c
);

2418 *
d¡
 = *
¤c
;

2419 
	}
}

2426 
	$¢d_ùl_–em_li¡_£t_off£t
(
¢d_ùl_–em_li¡_t
 *
obj
, 
v®
)

2428 
	`as£¹
(
obj
);

2429 
obj
->
off£t
 = 
v®
;

2430 
	}
}

2443 
	$¢d_ùl_–em_li¡_g‘_u£d
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
)

2445 
	`as£¹
(
obj
);

2446  
obj
->
u£d
;

2447 
	}
}

2461 
	$¢d_ùl_–em_li¡_g‘_couÁ
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
)

2463 
	`as£¹
(
obj
);

2464  
obj
->
couÁ
;

2465 
	}
}

2473 
	$¢d_ùl_–em_li¡_g‘_id
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
, 
idx
, 
¢d_ùl_–em_id_t
 *
±r
)

2475 
	`as£¹
(
obj
 && 
±r
);

2476 
	`as£¹
(
idx
 < 
obj
->
u£d
);

2477 *
±r
 = 
obj
->
pids
[
idx
];

2478 
	}
}

2486 
	$¢d_ùl_–em_li¡_g‘_numid
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
, 
idx
)

2488 
	`as£¹
(
obj
);

2489 
	`as£¹
(
idx
 < 
obj
->
u£d
);

2490  
obj
->
pids
[
idx
].
numid
;

2491 
	}
}

2499 
¢d_ùl_–em_içû_t
 
	$¢d_ùl_–em_li¡_g‘_š‹rçû
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
, 
idx
)

2501 
	`as£¹
(
obj
);

2502 
	`as£¹
(
idx
 < 
obj
->
u£d
);

2503  
obj
->
pids
[
idx
].
içû
;

2504 
	}
}

2512 
	$¢d_ùl_–em_li¡_g‘_deviû
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
, 
idx
)

2514 
	`as£¹
(
obj
);

2515 
	`as£¹
(
idx
 < 
obj
->
u£d
);

2516  
obj
->
pids
[
idx
].
deviû
;

2517 
	}
}

2525 
	$¢d_ùl_–em_li¡_g‘_subdeviû
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
, 
idx
)

2527 
	`as£¹
(
obj
);

2528 
	`as£¹
(
idx
 < 
obj
->
u£d
);

2529  
obj
->
pids
[
idx
].
subdeviû
;

2530 
	}
}

2538 cÚ¡ *
	$¢d_ùl_–em_li¡_g‘_Çme
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
, 
idx
)

2540 
	`as£¹
(
obj
);

2541 
	`as£¹
(
idx
 < 
obj
->
u£d
);

2542  (cÚ¡ *)
obj
->
pids
[
idx
].
Çme
;

2543 
	}
}

2551 
	$¢d_ùl_–em_li¡_g‘_šdex
(cÚ¡ 
¢d_ùl_–em_li¡_t
 *
obj
, 
idx
)

2553 
	`as£¹
(
obj
);

2554 
	`as£¹
(
idx
 < 
obj
->
u£d
);

2555  
obj
->
pids
[
idx
].
šdex
;

2556 
	}
}

2562 
size_t
 
	$¢d_ùl_–em_šfo_sizeof
()

2564  (
¢d_ùl_–em_šfo_t
);

2565 
	}
}

2572 
	$¢d_ùl_–em_šfo_m®loc
(
¢d_ùl_–em_šfo_t
 **
±r
)

2574 
	`as£¹
(
±r
);

2575 *
±r
 = 
	`ÿÎoc
(1, (
¢d_ùl_–em_šfo_t
));

2576 ià(!*
±r
)

2577  -
ENOMEM
;

2579 
	}
}

2585 
	$¢d_ùl_–em_šfo_ä“
(
¢d_ùl_–em_šfo_t
 *
obj
)

2587 
	`ä“
(
obj
);

2588 
	}
}

2594 
	$¢d_ùl_–em_šfo_ş—r
(
¢d_ùl_–em_šfo_t
 *
obj
)

2596 
	`mem£t
(
obj
, 0, (
¢d_ùl_–em_šfo_t
));

2597 
	}
}

2604 
	$¢d_ùl_–em_šfo_cİy
(
¢d_ùl_–em_šfo_t
 *
d¡
, cÚ¡ snd_ùl_–em_šfo_ˆ*
¤c
)

2606 
	`as£¹
(
d¡
 && 
¤c
);

2607 *
d¡
 = *
¤c
;

2608 
	}
}

2615 
¢d_ùl_–em_ty³_t
 
	$¢d_ùl_–em_šfo_g‘_ty³
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2617 
	`as£¹
(
obj
);

2618  
obj
->
ty³
;

2619 
	}
}

2626 
	$¢d_ùl_–em_šfo_is_»adabË
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2628 
	`as£¹
(
obj
);

2629  !!(
obj
->
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_READ
);

2630 
	}
}

2637 
	$¢d_ùl_–em_šfo_is_wr™abË
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2639 
	`as£¹
(
obj
);

2640  !!(
obj
->
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_WRITE
);

2641 
	}
}

2648 
	$¢d_ùl_–em_šfo_is_vŞ©e
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2650 
	`as£¹
(
obj
);

2651  !!(
obj
->
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_VOLATILE
);

2652 
	}
}

2659 
	$¢d_ùl_–em_šfo_is_šaùive
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2661 
	`as£¹
(
obj
);

2662  !!(
obj
->
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_INACTIVE
);

2663 
	}
}

2670 
	$¢d_ùl_–em_šfo_is_locked
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2672 
	`as£¹
(
obj
);

2673  !!(
obj
->
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_LOCK
);

2674 
	}
}

2681 
	$¢d_ùl_–em_šfo_is_owÃr
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2683 
	`as£¹
(
obj
);

2684  !!(
obj
->
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_OWNER
);

2685 
	}
}

2692 
	$¢d_ùl_–em_šfo_is_u£r
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2694 
	`as£¹
(
obj
);

2695  !!(
obj
->
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_USER
);

2696 
	}
}

2703 
	$¢d_ùl_–em_šfo_is_v_»adabË
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2705 
	`as£¹
(
obj
);

2706  !!(
obj
->
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_READ
);

2707 
	}
}

2714 
	$¢d_ùl_–em_šfo_is_v_wr™abË
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2716 
	`as£¹
(
obj
);

2717  !!(
obj
->
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_WRITE
);

2718 
	}
}

2725 
	$¢d_ùl_–em_šfo_is_v_commªdabË
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2727 
	`as£¹
(
obj
);

2728  !!(
obj
->
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_COMMAND
);

2729 
	}
}

2736 
	$¢d_ùl_–em_šfo_is_šdœeù
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2738 
	`as£¹
(
obj
);

2740 
	}
}

2741 
lšk_w¬nšg
(
¢d_ùl_–em_šfo_is_šdœeù
, "Warning: snd_ctl_elem_info_is_indirect is deprecated, do‚ot use it");

2748 
pid_t
 
	$¢d_ùl_–em_šfo_g‘_owÃr
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2750 
	`as£¹
(
obj
);

2751  
obj
->
owÃr
;

2752 
	}
}

2759 
	$¢d_ùl_–em_šfo_g‘_couÁ
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2761 
	`as£¹
(
obj
);

2762  
obj
->
couÁ
;

2763 
	}
}

2770 
	$¢d_ùl_–em_šfo_g‘_mš
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2772 
	`as£¹
(
obj
);

2773 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_ELEM_TYPE_INTEGER
);

2774  
obj
->
v®ue
.
š‹g”
.
mš
;

2775 
	}
}

2782 
	$¢d_ùl_–em_šfo_g‘_max
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2784 
	`as£¹
(
obj
);

2785 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_ELEM_TYPE_INTEGER
);

2786  
obj
->
v®ue
.
š‹g”
.
max
;

2787 
	}
}

2794 
	$¢d_ùl_–em_šfo_g‘_¡•
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2796 
	`as£¹
(
obj
);

2797 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_ELEM_TYPE_INTEGER
);

2798  
obj
->
v®ue
.
š‹g”
.
¡•
;

2799 
	}
}

2806 
	$¢d_ùl_–em_šfo_g‘_mš64
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2808 
	`as£¹
(
obj
);

2809 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_ELEM_TYPE_INTEGER64
);

2810  
obj
->
v®ue
.
š‹g”64
.
mš
;

2811 
	}
}

2818 
	$¢d_ùl_–em_šfo_g‘_max64
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2820 
	`as£¹
(
obj
);

2821 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_ELEM_TYPE_INTEGER64
);

2822  
obj
->
v®ue
.
š‹g”64
.
max
;

2823 
	}
}

2830 
	$¢d_ùl_–em_šfo_g‘_¡•64
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2832 
	`as£¹
(
obj
);

2833 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_ELEM_TYPE_INTEGER64
);

2834  
obj
->
v®ue
.
š‹g”64
.
¡•
;

2835 
	}
}

2842 
	$¢d_ùl_–em_šfo_g‘_™ems
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2844 
	`as£¹
(
obj
);

2845 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_ELEM_TYPE_ENUMERATED
);

2846  
obj
->
v®ue
.
’um”©ed
.
™ems
;

2847 
	}
}

2854 
	$¢d_ùl_–em_šfo_£t_™em
(
¢d_ùl_–em_šfo_t
 *
obj
, 
v®
)

2856 
	`as£¹
(
obj
);

2857 
obj
->
v®ue
.
’um”©ed
.
™em
 = 
v®
;

2858 
	}
}

2865 cÚ¡ *
	$¢d_ùl_–em_šfo_g‘_™em_Çme
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2867 
	`as£¹
(
obj
);

2868 
	`as£¹
(
obj
->
ty³
 =ğ
SND_CTL_ELEM_TYPE_ENUMERATED
);

2869  
obj
->
v®ue
.
’um”©ed
.
Çme
;

2870 
	}
}

2880 #iâdeà
DOXYGEN


2881 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_ùl_–em_šfo_g‘_dim’siÚs
)(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
 
ATTRIBUTE_UNUSED
)

2883 
	$¢d_ùl_–em_šfo_g‘_dim’siÚs
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2887 
i
;

2889 
	`as£¹
(
obj
);

2890 
i
 = 3; i >= 0; i--)

2891 ià(
obj
->
dim’
.
d
[
i
])

2893  
i
 + 1;

2895  -
EINVAL
;

2897 
	}
}

2898 
u£_deçuÉ_symbŞ_v”siÚ
(
__¢d_ùl_–em_šfo_g‘_dim’siÚs
, 
¢d_ùl_–em_šfo_g‘_dim’siÚs
, 
ALSA_0
.9.3);

2909 #iâdeà
DOXYGEN


2910 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_ùl_–em_šfo_g‘_dim’siÚ
)(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
 
ATTRIBUTE_UNUSED
, 
idx
 ATTRIBUTE_UNUSED)

2912 
	$¢d_ùl_–em_šfo_g‘_dim’siÚ
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
, 
idx
)

2916 
	`as£¹
(
obj
);

2917 ià(
idx
 > 3)

2919  
obj
->
dim’
.
d
[
idx
];

2921  -
EINVAL
;

2923 
	}
}

2924 
u£_deçuÉ_symbŞ_v”siÚ
(
__¢d_ùl_–em_šfo_g‘_dim’siÚ
, 
¢d_ùl_–em_šfo_g‘_dim’siÚ
, 
ALSA_0
.9.3);

2944 
	$¢d_ùl_–em_šfo_£t_dim’siÚ
(
¢d_ùl_–em_šfo_t
 *
šfo
 
ATTRIBUTE_UNUSED
,

2945 cÚ¡ 
dim’siÚ
[4] 
ATTRIBUTE_UNUSED
)

2948 
i
;

2950 ià(
šfo
 =ğ
NULL
)

2951  -
EINVAL
;

2953 
i
 = 0; i < 
	`ARRAY_SIZE
(
šfo
->
dim’
.
d
); i++) {

2954 ià(
dim’siÚ
[
i
] < 0)

2955  -
EINVAL
;

2957 
šfo
->
dim’
.
d
[
i
] = 
dim’siÚ
[i];

2962  -
EINVAL
;

2964 
	}
}

2971 
	$¢d_ùl_–em_šfo_g‘_id
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
, 
¢d_ùl_–em_id_t
 *
±r
)

2973 
	`as£¹
(
obj
 && 
±r
);

2974 *
±r
 = 
obj
->
id
;

2975 
	}
}

2982 
	$¢d_ùl_–em_šfo_g‘_numid
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2984 
	`as£¹
(
obj
);

2985  
obj
->
id
.
numid
;

2986 
	}
}

2993 
¢d_ùl_–em_içû_t
 
	$¢d_ùl_–em_šfo_g‘_š‹rçû
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

2995 
	`as£¹
(
obj
);

2996  
obj
->
id
.
içû
;

2997 
	}
}

3004 
	$¢d_ùl_–em_šfo_g‘_deviû
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

3006 
	`as£¹
(
obj
);

3007  
obj
->
id
.
deviû
;

3008 
	}
}

3015 
	$¢d_ùl_–em_šfo_g‘_subdeviû
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

3017 
	`as£¹
(
obj
);

3018  
obj
->
id
.
subdeviû
;

3019 
	}
}

3026 cÚ¡ *
	$¢d_ùl_–em_šfo_g‘_Çme
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

3028 
	`as£¹
(
obj
);

3029  (cÚ¡ *)
obj
->
id
.
Çme
;

3030 
	}
}

3037 
	$¢d_ùl_–em_šfo_g‘_šdex
(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
)

3039 
	`as£¹
(
obj
);

3040  
obj
->
id
.
šdex
;

3041 
	}
}

3048 
	$¢d_ùl_–em_šfo_£t_id
(
¢d_ùl_–em_šfo_t
 *
obj
, cÚ¡ 
¢d_ùl_–em_id_t
 *
±r
)

3050 
	`as£¹
(
obj
 && 
±r
);

3051 
obj
->
id
 = *
±r
;

3052 
	}
}

3059 
	$¢d_ùl_–em_šfo_£t_numid
(
¢d_ùl_–em_šfo_t
 *
obj
, 
v®
)

3061 
	`as£¹
(
obj
);

3062 
obj
->
id
.
numid
 = 
v®
;

3063 
	}
}

3070 
	$¢d_ùl_–em_šfo_£t_š‹rçû
(
¢d_ùl_–em_šfo_t
 *
obj
, 
¢d_ùl_–em_içû_t
 
v®
)

3072 
	`as£¹
(
obj
);

3073 
obj
->
id
.
içû
 = 
v®
;

3074 
	}
}

3081 
	$¢d_ùl_–em_šfo_£t_deviû
(
¢d_ùl_–em_šfo_t
 *
obj
, 
v®
)

3083 
	`as£¹
(
obj
);

3084 
obj
->
id
.
deviû
 = 
v®
;

3085 
	}
}

3092 
	$¢d_ùl_–em_šfo_£t_subdeviû
(
¢d_ùl_–em_šfo_t
 *
obj
, 
v®
)

3094 
	`as£¹
(
obj
);

3095 
obj
->
id
.
subdeviû
 = 
v®
;

3096 
	}
}

3103 
	$¢d_ùl_–em_šfo_£t_Çme
(
¢d_ùl_–em_šfo_t
 *
obj
, cÚ¡ *
v®
)

3105 
	`as£¹
(
obj
);

3106 
	`¢d_¡¾ıy
((*)
obj
->
id
.
Çme
, 
v®
, (obj->id.name));

3107 
	}
}

3114 
	$¢d_ùl_–em_šfo_£t_šdex
(
¢d_ùl_–em_šfo_t
 *
obj
, 
v®
)

3116 
	`as£¹
(
obj
);

3117 
obj
->
id
.
šdex
 = 
v®
;

3118 
	}
}

3126 
	$¢d_ùl_–em_šfo_£t_»ad_wr™e
(
¢d_ùl_–em_šfo_t
 *
obj
, 
rv®
, 
wv®
)

3128 
	`as£¹
(
obj
);

3129 
obj
->
acûss
 = (obj->acûs & ~
SNDRV_CTL_ELEM_ACCESS_READWRITE
) |

3130 (
rv®
 ? 
SNDRV_CTL_ELEM_ACCESS_READ
 : 0) |

3131 (
wv®
 ? 
SNDRV_CTL_ELEM_ACCESS_WRITE
 : 0);

3132 
	}
}

3140 
	$¢d_ùl_–em_šfo_£t_v_»ad_wr™e
(
¢d_ùl_–em_šfo_t
 *
obj
, 
rv®
, 
wv®
)

3142 
	`as£¹
(
obj
);

3143 
obj
->
acûss
 = (obj->acûs & ~
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
) |

3144 (
rv®
 ? 
SNDRV_CTL_ELEM_ACCESS_TLV_READ
 : 0) |

3145 (
wv®
 ? 
SNDRV_CTL_ELEM_ACCESS_TLV_WRITE
 : 0);

3146 
	}
}

3153 
	$¢d_ùl_–em_šfo_£t_šaùive
(
¢d_ùl_–em_šfo_t
 *
obj
, 
v®
)

3155 
	`as£¹
(
obj
);

3156 
obj
->
acûss
 = (obj->acûs & ~
SNDRV_CTL_ELEM_ACCESS_INACTIVE
) |

3157 (
v®
 ? 
SNDRV_CTL_ELEM_ACCESS_INACTIVE
 : 0);

3158 
	}
}

3164 
size_t
 
	$¢d_ùl_–em_v®ue_sizeof
()

3166  (
¢d_ùl_–em_v®ue_t
);

3167 
	}
}

3181 
	$¢d_ùl_–em_v®ue_m®loc
(
¢d_ùl_–em_v®ue_t
 **
±r
)

3183 
	`as£¹
(
±r
);

3184 *
±r
 = 
	`ÿÎoc
(1, (
¢d_ùl_–em_v®ue_t
));

3185 ià(!*
±r
)

3186  -
ENOMEM
;

3188 
	}
}

3196 
	$¢d_ùl_–em_v®ue_ä“
(
¢d_ùl_–em_v®ue_t
 *
obj
)

3198 
	`ä“
(
obj
);

3199 
	}
}

3208 
	$¢d_ùl_–em_v®ue_ş—r
(
¢d_ùl_–em_v®ue_t
 *
obj
)

3210 
	`mem£t
(
obj
, 0, (
¢d_ùl_–em_v®ue_t
));

3211 
	}
}

3218 
	$¢d_ùl_–em_v®ue_cİy
(
¢d_ùl_–em_v®ue_t
 *
d¡
,

3219 cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
¤c
)

3221 
	`as£¹
(
d¡
 && 
¤c
);

3222 *
d¡
 = *
¤c
;

3223 
	}
}

3232 
	$¢d_ùl_–em_v®ue_com·»
(
¢d_ùl_–em_v®ue_t
 *
Ëá
,

3233 cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
right
)

3235 
	`as£¹
(
Ëá
 && 
right
);

3236  
	`memcmp
(
Ëá
, 
right
, (*left));

3237 
	}
}

3248 
	$¢d_ùl_–em_v®ue_g‘_id
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
, 
¢d_ùl_–em_id_t
 *
±r
)

3250 
	`as£¹
(
obj
 && 
±r
);

3251 *
±r
 = 
obj
->
id
;

3252 
	}
}

3262 
	$¢d_ùl_–em_v®ue_g‘_numid
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
)

3264 
	`as£¹
(
obj
);

3265  
obj
->
id
.
numid
;

3266 
	}
}

3276 
¢d_ùl_–em_içû_t
 
	$¢d_ùl_–em_v®ue_g‘_š‹rçû
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
)

3278 
	`as£¹
(
obj
);

3279  
obj
->
id
.
içû
;

3280 
	}
}

3290 
	$¢d_ùl_–em_v®ue_g‘_deviû
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
)

3292 
	`as£¹
(
obj
);

3293  
obj
->
id
.
deviû
;

3294 
	}
}

3304 
	$¢d_ùl_–em_v®ue_g‘_subdeviû
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
)

3306 
	`as£¹
(
obj
);

3307  
obj
->
id
.
subdeviû
;

3308 
	}
}

3318 cÚ¡ *
	$¢d_ùl_–em_v®ue_g‘_Çme
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
)

3320 
	`as£¹
(
obj
);

3321  (cÚ¡ *)
obj
->
id
.
Çme
;

3322 
	}
}

3332 
	$¢d_ùl_–em_v®ue_g‘_šdex
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
)

3334 
	`as£¹
(
obj
);

3335  
obj
->
id
.
šdex
;

3336 
	}
}

3347 
	$¢d_ùl_–em_v®ue_£t_id
(
¢d_ùl_–em_v®ue_t
 *
obj
, cÚ¡ 
¢d_ùl_–em_id_t
 *
±r
)

3349 
	`as£¹
(
obj
 && 
±r
);

3350 
obj
->
id
 = *
±r
;

3351 
	}
}

3361 
	$¢d_ùl_–em_v®ue_£t_numid
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
v®
)

3363 
	`as£¹
(
obj
);

3364 
obj
->
id
.
numid
 = 
v®
;

3365 
	}
}

3375 
	$¢d_ùl_–em_v®ue_£t_š‹rçû
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
¢d_ùl_–em_içû_t
 
v®
)

3377 
	`as£¹
(
obj
);

3378 
obj
->
id
.
içû
 = 
v®
;

3379 
	}
}

3389 
	$¢d_ùl_–em_v®ue_£t_deviû
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
v®
)

3391 
	`as£¹
(
obj
);

3392 
obj
->
id
.
deviû
 = 
v®
;

3393 
	}
}

3403 
	$¢d_ùl_–em_v®ue_£t_subdeviû
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
v®
)

3405 
	`as£¹
(
obj
);

3406 
obj
->
id
.
subdeviû
 = 
v®
;

3407 
	}
}

3417 
	$¢d_ùl_–em_v®ue_£t_Çme
(
¢d_ùl_–em_v®ue_t
 *
obj
, cÚ¡ *
v®
)

3419 
	`as£¹
(
obj
);

3420 
	`¢d_¡¾ıy
((*)
obj
->
id
.
Çme
, 
v®
, (obj->id.name));

3421 
	}
}

3431 
	$¢d_ùl_–em_v®ue_£t_šdex
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
v®
)

3433 
	`as£¹
(
obj
);

3434 
obj
->
id
.
šdex
 = 
v®
;

3435 
	}
}

3448 
	$¢d_ùl_–em_v®ue_g‘_boŞ—n
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
)

3450 
	`as£¹
(
obj
);

3451 
	`as£¹
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
v®ue
.
š‹g”
.value));

3452  
obj
->
v®ue
.
š‹g”
.v®ue[
idx
];

3453 
	}
}

3466 
	$¢d_ùl_–em_v®ue_g‘_š‹g”
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
)

3468 
	`as£¹
(
obj
);

3469 
	`as£¹
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
v®ue
.
š‹g”
.value));

3470  
obj
->
v®ue
.
š‹g”
.v®ue[
idx
];

3471 
	}
}

3484 
	$¢d_ùl_–em_v®ue_g‘_š‹g”64
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
)

3486 
	`as£¹
(
obj
);

3487 
	`as£¹
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
v®ue
.
š‹g”64
.value));

3488  
obj
->
v®ue
.
š‹g”64
.v®ue[
idx
];

3489 
	}
}

3502 
	$¢d_ùl_–em_v®ue_g‘_’um”©ed
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
)

3504 
	`as£¹
(
obj
);

3505 
	`as£¹
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
v®ue
.
’um”©ed
.
™em
));

3506  
obj
->
v®ue
.
’um”©ed
.
™em
[
idx
];

3507 
	}
}

3520 
	$¢d_ùl_–em_v®ue_g‘_by‹
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
)

3522 
	`as£¹
(
obj
);

3523 
	`as£¹
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
v®ue
.
by‹s
.
d©a
));

3524  
obj
->
v®ue
.
by‹s
.
d©a
[
idx
];

3525 
	}
}

3538 
	$¢d_ùl_–em_v®ue_£t_boŞ—n
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
, 
v®
)

3540 
	`as£¹
(
obj
);

3541 
	`as£¹
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
v®ue
.
š‹g”
.value));

3542 
obj
->
v®ue
.
š‹g”
.v®ue[
idx
] = 
v®
;

3543 
	}
}

3556 
	$¢d_ùl_–em_v®ue_£t_š‹g”
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
, 
v®
)

3558 
	`as£¹
(
obj
);

3559 
	`as£¹
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
v®ue
.
š‹g”
.value));

3560 
obj
->
v®ue
.
š‹g”
.v®ue[
idx
] = 
v®
;

3561 
	}
}

3574 
	$¢d_ùl_–em_v®ue_£t_š‹g”64
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
, 
v®
)

3576 
	`as£¹
(
obj
);

3577 
	`as£¹
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
v®ue
.
š‹g”64
.value));

3578 
obj
->
v®ue
.
š‹g”64
.v®ue[
idx
] = 
v®
;

3579 
	}
}

3592 
	$¢d_ùl_–em_v®ue_£t_’um”©ed
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
, 
v®
)

3594 
	`as£¹
(
obj
);

3595 
	`as£¹
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
v®ue
.
’um”©ed
.
™em
));

3596 
obj
->
v®ue
.
’um”©ed
.
™em
[
idx
] = 
v®
;

3597 
	}
}

3610 
	$¢d_ùl_–em_v®ue_£t_by‹
(
¢d_ùl_–em_v®ue_t
 *
obj
, 
idx
, 
v®
)

3612 
	`as£¹
(
obj
);

3613 
	`as£¹
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
v®ue
.
by‹s
.
d©a
));

3614 
obj
->
v®ue
.
by‹s
.
d©a
[
idx
] = 
v®
;

3615 
	}
}

3630 
	$¢d_ùl_–em_£t_by‹s
(
¢d_ùl_–em_v®ue_t
 *
obj
, *
d©a
, 
size_t
 
size
)

3632 
	`as£¹
(
obj
);

3633 
	`as£¹
(
size
 <ğ
	`ARRAY_SIZE
(
obj
->
v®ue
.
by‹s
.
d©a
));

3634 
	`memıy
(
obj
->
v®ue
.
by‹s
.
d©a
, d©a, 
size
);

3635 
	}
}

3649 cÚ¡ * 
	$¢d_ùl_–em_v®ue_g‘_by‹s
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
)

3651 
	`as£¹
(
obj
);

3652  
obj
->
v®ue
.
by‹s
.
d©a
;

3653 
	}
}

3667 
	$¢d_ùl_–em_v®ue_g‘_›c958
(cÚ¡ 
¢d_ùl_–em_v®ue_t
 *
obj
, 
¢d_«s_›c958_t
 *
±r
)

3669 
	`as£¹
(
obj
 && 
±r
);

3670 
	`memıy
(
±r
, &
obj
->
v®ue
.
›c958
, (*ptr));

3671 
	}
}

3685 
	$¢d_ùl_–em_v®ue_£t_›c958
(
¢d_ùl_–em_v®ue_t
 *
obj
, cÚ¡ 
¢d_«s_›c958_t
 *
±r
)

3687 
	`as£¹
(
obj
 && 
±r
);

3688 
	`memıy
(&
obj
->
v®ue
.
›c958
, 
±r
, (obj->value.iec958));

3689 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_empty.c

29 
	~"cÚŒŞ_loÿl.h
"

31 #iâdeà
PIC


33 cÚ¡ *
	g_¢d_moduË_cÚŒŞ_em±y
 = "";

73 
	$_¢d_ùl_em±y_İ’
(
¢d_ùl_t
 **
hªdËp
, cÚ¡ *
Çme
 
ATTRIBUTE_UNUSED
,

74 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
, 
mode
)

76 
¢d_cÚfig_t
 *
chd
 = 
NULL
;

77 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

79 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

80 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

81 cÚ¡ *
id
;

82 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

84 ià(
	`_¢d_cÚf_g’”ic_id
(
id
))

86 ià(
	`¡rcmp
(
id
, "child") == 0) {

87 
chd
 = 
n
;

90 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

91  -
EINVAL
;

93 ià(!
chd
) {

94 
	`SNDERR
("child is‚ot defined");

95  -
EINVAL
;

97  
	`_¢d_ùl_İ’_Çmed_chd
(
hªdËp
, 
Çme
, 
roÙ
, 
chd
, 
mode
, 
cÚf
);

98 
	}
}

99 #iâdeà
DOC_HIDDEN


100 
SND_DLSYM_BUILD_VERSION
(
_¢d_ùl_em±y_İ’
, 
SND_CONTROL_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_ext.c

30 
	~"cÚŒŞ_loÿl.h
"

31 
	~"cÚŒŞ_ex‹º®.h
"

32 
	~<¡dio.h
>

33 
	~<¡dlib.h
>

34 
	~<uni¡d.h
>

35 
	~<¡ršg.h
>

37 #iâdeà
PIC


39 cÚ¡ *
	g_¢d_moduË_cÚŒŞ_ext
 = "";

42 
	$¢d_ùl_ext_şo£
(
¢d_ùl_t
 *
hªdË
)

44 
¢d_ùl_ext_t
 *
ext
 = 
hªdË
->
´iv©e_d©a
;

46 ià(
ext
->
ÿÎback
->
şo£
)

47 
ext
->
ÿÎback
->
	`şo£
(ext);

49 
	}
}

51 
	$¢d_ùl_ext_nÚblock
(
¢d_ùl_t
 *
hªdË
, 
nÚblock
)

53 
¢d_ùl_ext_t
 *
ext
 = 
hªdË
->
´iv©e_d©a
;

55 
ext
->
nÚblock
 =‚onblock;

57 
	}
}

59 
	$¢d_ùl_ext_async
(
¢d_ùl_t
 *
ùl
 
ATTRIBUTE_UNUSED
,

60 
sig
 
ATTRIBUTE_UNUSED
,

61 
pid_t
 
pid
 
ATTRIBUTE_UNUSED
)

63  -
ENOSYS
;

64 
	}
}

66 
	$¢d_ùl_ext_subsüibe_ev’ts
(
¢d_ùl_t
 *
hªdË
, 
subsüibe
)

68 
¢d_ùl_ext_t
 *
ext
 = 
hªdË
->
´iv©e_d©a
;

70 ià(
subsüibe
 < 0)

71  
ext
->
subsüibed
;

72 
ext
->
subsüibed
 = !!
subsüibe
;

73 ià(
ext
->
ÿÎback
->
subsüibe_ev’ts
)

74 
ext
->
ÿÎback
->
	`subsüibe_ev’ts
Óxt, 
subsüibe
);

76 
	}
}

78 
	$¢d_ùl_ext_ÿrd_šfo
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_ÿrd_šfo_t
 *
šfo
)

80 
¢d_ùl_ext_t
 *
ext
 = 
hªdË
->
´iv©e_d©a
;

82 
	`mem£t
(
šfo
, 0, (*info));

83 
šfo
->
ÿrd
 = 
ext
->
ÿrd_idx
;

84 
	`memıy
(
šfo
->
id
, 
ext
->id, (info->id));

85 
	`memıy
(
šfo
->
driv”
, 
ext
->driver, (info->driver));

86 
	`memıy
(
šfo
->
Çme
, 
ext
->name, (info->name));

87 
	`memıy
(
šfo
->
lÚgÇme
, 
ext
->longname, (info->longname));

88 
	`memıy
(
šfo
->
mix”Çme
, 
ext
->mixername, (info->mixername));

90 
	}
}

92 
	$¢d_ùl_ext_–em_li¡
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_–em_li¡_t
 *
li¡
)

94 
¢d_ùl_ext_t
 *
ext
 = 
hªdË
->
´iv©e_d©a
;

95 
»t
;

96 
i
, 
off£t
;

97 
¢d_ùl_–em_id_t
 *
ids
;

99 
li¡
->
couÁ
 = 
ext
->
ÿÎback
->
	`–em_couÁ
(ext);

100 
li¡
->
u£d
 = 0;

101 
ids
 = 
li¡
->
pids
;

102 
off£t
 = 
li¡
->offset;

103 
i
 = 0; i < 
li¡
->
¥aû
; i++) {

104 ià(
off£t
 >ğ
li¡
->
couÁ
)

106 
	`¢d_ùl_–em_id_ş—r
(
ids
);

107 
»t
 = 
ext
->
ÿÎback
->
	`–em_li¡
Óxt, 
off£t
, 
ids
);

108 ià(
»t
 < 0)

109  
»t
;

110 
ids
->
numid
 = 
off£t
 + 1;

111 
li¡
->
u£d
++;

112 
off£t
++;

113 
ids
++;

116 
	}
}

118 
¢d_ùl_ext_key_t
 
	$g‘_–em
(
¢d_ùl_ext_t
 *
ext
, 
¢d_ùl_–em_id_t
 *
id
)

120 
numid
 = 
id
->numid;

121 ià(
numid
 > 0) {

122 
ext
->
ÿÎback
->
	`–em_li¡
Óxt, 
numid
 - 1, 
id
);

123 
id
->
numid
 =‚umid;

125 
id
->
numid
 = 0;

126  
ext
->
ÿÎback
->
	`fšd_–em
Óxt, 
id
);

127 
	}
}

129 
	$¢d_ùl_ext_–em_šfo
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_–em_šfo_t
 *
šfo
)

131 
¢d_ùl_ext_t
 *
ext
 = 
hªdË
->
´iv©e_d©a
;

132 
¢d_ùl_ext_key_t
 
key
;

133 
ty³
, 
»t
;

135 
key
 = 
	`g‘_–em
(
ext
, &
šfo
->
id
);

136 ià(
key
 =ğ
SND_CTL_EXT_KEY_NOT_FOUND
)

137  -
ENOENT
;

138 
»t
 = 
ext
->
ÿÎback
->
	`g‘_©Œibu‹
Óxt, 
key
, &
ty³
, &
šfo
->
acûss
, &šfo->
couÁ
);

139 ià(
»t
 < 0)

140 
”r
;

141 
šfo
->
ty³
 =ype;

142 
»t
 = -
EINVAL
;

143 
šfo
->
ty³
) {

144 
SND_CTL_ELEM_TYPE_BOOLEAN
:

145 
šfo
->
v®ue
.
š‹g”
.
mš
 = 0;

146 
šfo
->
v®ue
.
š‹g”
.
max
 = 1;

147 
»t
 = 0;

149 
SND_CTL_ELEM_TYPE_INTEGER
:

150 ià(! 
ext
->
ÿÎback
->
g‘_š‹g”_šfo
)

151 
”r
;

152 
»t
 = 
ext
->
ÿÎback
->
	`g‘_š‹g”_šfo
Óxt, 
key
, &
šfo
->
v®ue
.
š‹g”
.
mš
,

153 &
šfo
->
v®ue
.
š‹g”
.
max
,

154 &
šfo
->
v®ue
.
š‹g”
.
¡•
);

156 
SND_CTL_ELEM_TYPE_INTEGER64
:

157 ià(! 
ext
->
ÿÎback
->
g‘_š‹g”64_šfo
)

158 
”r
;

160 
št64_t
 
xmš
, 
xmax
, 
x¡•
;

161 
»t
 = 
ext
->
ÿÎback
->
	`g‘_š‹g”64_šfo
Óxt, 
key
,

162 &
xmš
,

163 &
xmax
,

164 &
x¡•
);

165 
šfo
->
v®ue
.
š‹g”64
.
mš
 = 
xmš
;

166 
šfo
->
v®ue
.
š‹g”64
.
max
 = 
xmax
;

167 
šfo
->
v®ue
.
š‹g”64
.
¡•
 = 
x¡•
;

170 
SND_CTL_ELEM_TYPE_ENUMERATED
:

171 ià(! 
ext
->
ÿÎback
->
g‘_’um”©ed_šfo
)

172 
”r
;

173 
»t
 = 
ext
->
ÿÎback
->
	`g‘_’um”©ed_šfo
Óxt, 
key
, &
šfo
->
v®ue
.
’um”©ed
.
™ems
);

174 
ext
->
ÿÎback
->
	`g‘_’um”©ed_Çme
Óxt, 
key
, 
šfo
->
v®ue
.
’um”©ed
.
™em
,

175 
šfo
->
v®ue
.
’um”©ed
.
Çme
,

176 (
šfo
->
v®ue
.
’um”©ed
.
Çme
));

179 
»t
 = 0;

183 
”r
:

184 ià(
ext
->
ÿÎback
->
ä“_key
)

185 
ext
->
ÿÎback
->
	`ä“_key
Óxt, 
key
);

187  
»t
;

188 
	}
}

190 
	$¢d_ùl_ext_–em_add
(
¢d_ùl_t
 *
hªdË
 
ATTRIBUTE_UNUSED
,

191 
¢d_ùl_–em_šfo_t
 *
šfo
 
ATTRIBUTE_UNUSED
)

193  -
ENXIO
;

194 
	}
}

196 
	$¢d_ùl_ext_–em_»¶aû
(
¢d_ùl_t
 *
hªdË
 
ATTRIBUTE_UNUSED
,

197 
¢d_ùl_–em_šfo_t
 *
šfo
 
ATTRIBUTE_UNUSED
)

199  -
ENXIO
;

200 
	}
}

202 
	$¢d_ùl_ext_–em_»move
(
¢d_ùl_t
 *
hªdË
 
ATTRIBUTE_UNUSED
,

203 
¢d_ùl_–em_id_t
 *
id
 
ATTRIBUTE_UNUSED
)

205  -
ENXIO
;

206 
	}
}

208 
	$¢d_ùl_ext_–em_»ad
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_–em_v®ue_t
 *
cÚŒŞ
)

210 
¢d_ùl_ext_t
 *
ext
 = 
hªdË
->
´iv©e_d©a
;

211 
¢d_ùl_ext_key_t
 
key
;

212 
ty³
, 
»t
;

213 
acûss
, 
couÁ
;

215 
key
 = 
	`g‘_–em
(
ext
, &
cÚŒŞ
->
id
);

216 ià(
key
 =ğ
SND_CTL_EXT_KEY_NOT_FOUND
)

217  -
ENOENT
;

218 
»t
 = 
ext
->
ÿÎback
->
	`g‘_©Œibu‹
Óxt, 
key
, &
ty³
, &
acûss
, &
couÁ
);

219 ià(
»t
 < 0)

220 
”r
;

221 
»t
 = -
EINVAL
;

222 
ty³
) {

223 
SND_CTL_ELEM_TYPE_BOOLEAN
:

224 
SND_CTL_ELEM_TYPE_INTEGER
:

225 ià(! 
ext
->
ÿÎback
->
»ad_š‹g”
)

226 
”r
;

227 
»t
 = 
ext
->
ÿÎback
->
	`»ad_š‹g”
Óxt, 
key
, 
cÚŒŞ
->
v®ue
.
š‹g”
.value);

229 
SND_CTL_ELEM_TYPE_INTEGER64
:

230 ià(! 
ext
->
ÿÎback
->
»ad_š‹g”64
)

231 
”r
;

232 
»t
 = 
ext
->
ÿÎback
->
	`»ad_š‹g”64
Óxt, 
key
,

233 (
št64_t
*)
cÚŒŞ
->
v®ue
.
š‹g”64
.value);

235 
SND_CTL_ELEM_TYPE_ENUMERATED
:

236 ià(! 
ext
->
ÿÎback
->
»ad_’um”©ed
)

237 
”r
;

238 
»t
 = 
ext
->
ÿÎback
->
	`»ad_’um”©ed
Óxt, 
key
, 
cÚŒŞ
->
v®ue
.
’um”©ed
.
™em
);

240 
SND_CTL_ELEM_TYPE_BYTES
:

241 ià(! 
ext
->
ÿÎback
->
»ad_by‹s
)

242 
”r
;

243 
»t
 = 
ext
->
ÿÎback
->
	`»ad_by‹s
Óxt, 
key
, 
cÚŒŞ
->
v®ue
.
by‹s
.
d©a
,

244 (
cÚŒŞ
->
v®ue
.
by‹s
.
d©a
));

246 
SND_CTL_ELEM_TYPE_IEC958
:

247 ià(! 
ext
->
ÿÎback
->
»ad_›c958
)

248 
”r
;

249 
»t
 = 
ext
->
ÿÎback
->
	`»ad_›c958
Óxt, 
key
, (
¢d_«s_›c958_t
 *)&
cÚŒŞ
->
v®ue
.
›c958
);

255 
”r
:

256 ià(
ext
->
ÿÎback
->
ä“_key
)

257 
ext
->
ÿÎback
->
	`ä“_key
Óxt, 
key
);

259  
»t
;

260 
	}
}

262 
	$¢d_ùl_ext_–em_wr™e
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_–em_v®ue_t
 *
cÚŒŞ
)

264 
¢d_ùl_ext_t
 *
ext
 = 
hªdË
->
´iv©e_d©a
;

265 
¢d_ùl_ext_key_t
 
key
;

266 
ty³
, 
»t
;

267 
acûss
, 
couÁ
;

269 
key
 = 
	`g‘_–em
(
ext
, &
cÚŒŞ
->
id
);

270 ià(
key
 =ğ
SND_CTL_EXT_KEY_NOT_FOUND
)

271  -
ENOENT
;

272 
»t
 = 
ext
->
ÿÎback
->
	`g‘_©Œibu‹
Óxt, 
key
, &
ty³
, &
acûss
, &
couÁ
);

273 ià(
»t
 < 0)

274 
”r
;

275 
»t
 = -
EINVAL
;

276 
ty³
) {

277 
SND_CTL_ELEM_TYPE_BOOLEAN
:

278 
SND_CTL_ELEM_TYPE_INTEGER
:

279 ià(! 
ext
->
ÿÎback
->
wr™e_š‹g”
)

280 
”r
;

281 
»t
 = 
ext
->
ÿÎback
->
	`wr™e_š‹g”
Óxt, 
key
, 
cÚŒŞ
->
v®ue
.
š‹g”
.value);

283 
SND_CTL_ELEM_TYPE_INTEGER64
:

284 ià(! 
ext
->
ÿÎback
->
wr™e_š‹g”64
)

285 
”r
;

286 
»t
 = 
ext
->
ÿÎback
->
	`wr™e_š‹g”64
Óxt, 
key
, (
št64_t
 *)
cÚŒŞ
->
v®ue
.
š‹g”64
.value);

288 
SND_CTL_ELEM_TYPE_ENUMERATED
:

289 ià(! 
ext
->
ÿÎback
->
wr™e_’um”©ed
)

290 
”r
;

291 
»t
 = 
ext
->
ÿÎback
->
	`wr™e_’um”©ed
Óxt, 
key
, 
cÚŒŞ
->
v®ue
.
’um”©ed
.
™em
);

293 
SND_CTL_ELEM_TYPE_BYTES
:

294 ià(! 
ext
->
ÿÎback
->
wr™e_by‹s
)

295 
”r
;

296 
»t
 = 
ext
->
ÿÎback
->
	`wr™e_by‹s
Óxt, 
key
, 
cÚŒŞ
->
v®ue
.
by‹s
.
d©a
,

297 (
cÚŒŞ
->
v®ue
.
by‹s
.
d©a
));

299 
SND_CTL_ELEM_TYPE_IEC958
:

300 ià(! 
ext
->
ÿÎback
->
wr™e_›c958
)

301 
”r
;

302 
»t
 = 
ext
->
ÿÎback
->
	`wr™e_›c958
Óxt, 
key
, (
¢d_«s_›c958_t
 *)&
cÚŒŞ
->
v®ue
.
›c958
);

308 
”r
:

309 ià(
ext
->
ÿÎback
->
ä“_key
)

310 
ext
->
ÿÎback
->
	`ä“_key
Óxt, 
key
);

312  
»t
;

313 
	}
}

315 
	$¢d_ùl_ext_–em_lock
(
¢d_ùl_t
 *
hªdË
 
ATTRIBUTE_UNUSED
,

316 
¢d_ùl_–em_id_t
 *
id
 
ATTRIBUTE_UNUSED
)

318  -
ENXIO
;

319 
	}
}

321 
	$¢d_ùl_ext_–em_uÆock
(
¢d_ùl_t
 *
hªdË
 
ATTRIBUTE_UNUSED
,

322 
¢d_ùl_–em_id_t
 *
id
 
ATTRIBUTE_UNUSED
)

324  -
ENXIO
;

325 
	}
}

327 
	$¢d_ùl_ext_–em_v
(
¢d_ùl_t
 *
hªdË
, 
İ_æag
,

328 
numid
,

329 *
v
, 
v_size
)

331 
¢d_ùl_ext_t
 *
ext
 = 
hªdË
->
´iv©e_d©a
;

332 
¢d_ùl_ext_key_t
 
key
;

333 
ty³
, 
»t
;

334 
acûss
, 
couÁ
, 
Ën
;

335 
¢d_ùl_–em_id_t
 
id
;

338 ià(
ext
->
v”siÚ
 <ğ
	`SNDRV_PROTOCOL_VERSION
(1, 0, 0))

339  -
ENXIO
;

341 
	`¢d_ùl_–em_id_ş—r
(&
id
);

342 ià(
numid
 > 0) {

343 
ext
->
ÿÎback
->
	`–em_li¡
Óxt, 
numid
 - 1, &
id
);

344 
id
.
numid
 =‚umid;

346 
id
.
numid
 = 0;

347 
key
 = 
ext
->
ÿÎback
->
	`fšd_–em
Óxt, &
id
);

349 ià(
key
 =ğ
SND_CTL_EXT_KEY_NOT_FOUND
)

350  -
ENOENT
;

351 
»t
 = 
ext
->
ÿÎback
->
	`g‘_©Œibu‹
Óxt, 
key
, &
ty³
, &
acûss
, &
couÁ
);

352 ià(
»t
 < 0)

353  
»t
;

355 ià((
İ_æag
 =ğ0 && (
acûss
 & 
SND_CTL_EXT_ACCESS_TLV_READ
) == 0) ||

356 (
İ_æag
 > 0 && (
acûss
 & 
SND_CTL_EXT_ACCESS_TLV_WRITE
) == 0) ||

357 (
İ_æag
 < 0 && (
acûss
 & 
SND_CTL_EXT_ACCESS_TLV_COMMAND
) == 0))

358  -
ENXIO
;

359 ià(
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_CALLBACK
) {

360  
ext
->
v
.
	`c
Óxt, 
key
, 
İ_æag
, 
numid
,lv, 
v_size
);

362 ià(
İ_æag
)

363  -
ENXIO
;

364 
Ën
 = 
ext
->
v
.
p
[1] + 2 * ();

365 ià(
v_size
 < 
Ën
)

366  -
ENOMEM
;

367 
	`memıy
(
v
, 
ext
->v.
p
, 
Ën
);

370 
	}
}

372 
	$¢d_ùl_ext_Ãxt_deviû
(
¢d_ùl_t
 *
hªdË
 
ATTRIBUTE_UNUSED
,

373 *
deviû
 
ATTRIBUTE_UNUSED
)

375  -
ENXIO
;

376 
	}
}

378 
	$¢d_ùl_ext_´eãr_subdeviû
(
¢d_ùl_t
 *
hªdË
 
ATTRIBUTE_UNUSED
,

379 
subdev
 
ATTRIBUTE_UNUSED
)

381  -
ENXIO
;

382 
	}
}

384 
	$¢d_ùl_ext_hwd•_šfo
(
¢d_ùl_t
 *
hªdË
 
ATTRIBUTE_UNUSED
,

385 
¢d_hwd•_šfo_t
 *
šfo
 
ATTRIBUTE_UNUSED
)

387  -
ENXIO
;

388 
	}
}

390 
	$¢d_ùl_ext_pcm_šfo
(
¢d_ùl_t
 *
hªdË
 
ATTRIBUTE_UNUSED
,

391 
¢d_pcm_šfo_t
 *
šfo
 
ATTRIBUTE_UNUSED
)

393  -
ENXIO
;

394 
	}
}

396 
	$¢d_ùl_ext_¿wmidi_šfo
(
¢d_ùl_t
 *
hªdË
 
ATTRIBUTE_UNUSED
,

397 
¢d_¿wmidi_šfo_t
 *
šfo
 
ATTRIBUTE_UNUSED
)

399  -
ENXIO
;

400 
	}
}

402 
	$¢d_ùl_ext_£t_pow”_¡©e
(
¢d_ùl_t
 *
hªdË
 
ATTRIBUTE_UNUSED
,

403 
¡©e
 
ATTRIBUTE_UNUSED
)

406 
	}
}

408 
	$¢d_ùl_ext_g‘_pow”_¡©e
(
¢d_ùl_t
 *
hªdË
 
ATTRIBUTE_UNUSED
,

409 *
¡©e
 
ATTRIBUTE_UNUSED
)

412 
	}
}

414 
	$¢d_ùl_ext_»ad
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_ev’t_t
 *
ev’t
)

416 
¢d_ùl_ext_t
 *
ext
 = 
hªdË
->
´iv©e_d©a
;

418 ià(
ext
->
ÿÎback
->
»ad_ev’t
) {

419 
	`mem£t
(
ev’t
, 0, (*event));

420  
ext
->
ÿÎback
->
	`»ad_ev’t
Óxt, &
ev’t
->
d©a
.
–em
.
id
, &ev’t->d©a.–em.
mask
);

423  -
EINVAL
;

424 
	}
}

426 
	$¢d_ùl_ext_pŞl_desütÜs_couÁ
(
¢d_ùl_t
 *
hªdË
)

428 
¢d_ùl_ext_t
 *
ext
 = 
hªdË
->
´iv©e_d©a
;

430 ià(
ext
->
ÿÎback
->
pŞl_desütÜs_couÁ
)

431  
ext
->
ÿÎback
->
	`pŞl_desütÜs_couÁ
(ext);

432 ià(
ext
->
pŞl_fd
 >= 0)

435 
	}
}

437 
	$¢d_ùl_ext_pŞl_desütÜs
(
¢d_ùl_t
 *
hªdË
, 
pŞlfd
 *
pfds
, 
¥aû
)

439 
¢d_ùl_ext_t
 *
ext
 = 
hªdË
->
´iv©e_d©a
;

441 ià(
ext
->
ÿÎback
->
pŞl_desütÜs
)

442  
ext
->
ÿÎback
->
	`pŞl_desütÜs
Óxt, 
pfds
, 
¥aû
);

443 ià(
ext
->
pŞl_fd
 < 0)

445 ià(
¥aû
 > 0) {

446 
pfds
->
fd
 = 
ext
->
pŞl_fd
;

447 
pfds
->
ev’ts
 = 
POLLIN
|
POLLERR
|
POLLNVAL
;

451 
	}
}

453 
	$¢d_ùl_ext_pŞl_»v’ts
(
¢d_ùl_t
 *
hªdË
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

455 
¢d_ùl_ext_t
 *
ext
 = 
hªdË
->
´iv©e_d©a
;

457 ià(
ext
->
ÿÎback
->
pŞl_»v’ts
)

458  
ext
->
ÿÎback
->
	`pŞl_»v’ts
Óxt, 
pfds
, 
nfds
, 
»v’ts
);

459 ià(
nfds
 == 1) {

460 *
»v’ts
 = 
pfds
->revents;

463  -
EINVAL
;

464 
	}
}

466 cÚ¡ 
¢d_ùl_İs_t
 
	g¢d_ùl_ext_İs
 = {

467 .
şo£
 = 
¢d_ùl_ext_şo£
,

468 .
	gnÚblock
 = 
¢d_ùl_ext_nÚblock
,

469 .
	gasync
 = 
¢d_ùl_ext_async
,

470 .
	gsubsüibe_ev’ts
 = 
¢d_ùl_ext_subsüibe_ev’ts
,

471 .
	gÿrd_šfo
 = 
¢d_ùl_ext_ÿrd_šfo
,

472 .
	g–em’t_li¡
 = 
¢d_ùl_ext_–em_li¡
,

473 .
	g–em’t_šfo
 = 
¢d_ùl_ext_–em_šfo
,

474 .
	g–em’t_add
 = 
¢d_ùl_ext_–em_add
,

475 .
	g–em’t_»¶aû
 = 
¢d_ùl_ext_–em_»¶aû
,

476 .
	g–em’t_»move
 = 
¢d_ùl_ext_–em_»move
,

477 .
	g–em’t_»ad
 = 
¢d_ùl_ext_–em_»ad
,

478 .
	g–em’t_wr™e
 = 
¢d_ùl_ext_–em_wr™e
,

479 .
	g–em’t_lock
 = 
¢d_ùl_ext_–em_lock
,

480 .
	g–em’t_uÆock
 = 
¢d_ùl_ext_–em_uÆock
,

481 .
	g–em’t_v
 = 
¢d_ùl_ext_–em_v
,

482 .
	ghwd•_Ãxt_deviû
 = 
¢d_ùl_ext_Ãxt_deviû
,

483 .
	ghwd•_šfo
 = 
¢d_ùl_ext_hwd•_šfo
,

484 .
	gpcm_Ãxt_deviû
 = 
¢d_ùl_ext_Ãxt_deviû
,

485 .
	gpcm_šfo
 = 
¢d_ùl_ext_pcm_šfo
,

486 .
	gpcm_´eãr_subdeviû
 = 
¢d_ùl_ext_´eãr_subdeviû
,

487 .
	g¿wmidi_Ãxt_deviû
 = 
¢d_ùl_ext_Ãxt_deviû
,

488 .
	g¿wmidi_šfo
 = 
¢d_ùl_ext_¿wmidi_šfo
,

489 .
	g¿wmidi_´eãr_subdeviû
 = 
¢d_ùl_ext_´eãr_subdeviû
,

490 .
	g£t_pow”_¡©e
 = 
¢d_ùl_ext_£t_pow”_¡©e
,

491 .
	gg‘_pow”_¡©e
 = 
¢d_ùl_ext_g‘_pow”_¡©e
,

492 .
	g»ad
 = 
¢d_ùl_ext_»ad
,

493 .
	gpŞl_desütÜs_couÁ
 = 
¢d_ùl_ext_pŞl_desütÜs_couÁ
,

494 .
	gpŞl_desütÜs
 = 
¢d_ùl_ext_pŞl_desütÜs
,

495 .
	gpŞl_»v’ts
 = 
¢d_ùl_ext_pŞl_»v’ts
,

708 
	$¢d_ùl_ext_ü—‹
(
¢d_ùl_ext_t
 *
ext
, cÚ¡ *
Çme
, 
mode
)

710 
¢d_ùl_t
 *
ùl
;

711 
”r
;

713 ià(
ext
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 0) ||

714 
ext
->
v”siÚ
 > 
SND_CTL_EXT_VERSION
) {

715 
	`SNDERR
("ctl_ext: Plugin version mismatch");

716  -
ENXIO
;

719 
”r
 = 
	`¢d_ùl_Ãw
(&
ùl
, 
SND_CTL_TYPE_EXT
, 
Çme
, 
mode
);

720 ià(
”r
 < 0)

721  
”r
;

723 
ext
->
hªdË
 = 
ùl
;

725 
ùl
->
İs
 = &
¢d_ùl_ext_İs
;

726 
ùl
->
´iv©e_d©a
 = 
ext
;

727 
ùl
->
pŞl_fd
 = 
ext
->poll_fd;

728 ià(
mode
 & 
SND_CTL_NONBLOCK
)

729 
ext
->
nÚblock
 = 1;

732 
	}
}

739 
	$¢d_ùl_ext_d–‘e
(
¢d_ùl_ext_t
 *
ext
)

741  
	`¢d_ùl_şo£
(
ext
->
hªdË
);

742 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_hw.c

29 
	~"cÚŒŞ_loÿl.h
"

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<uni¡d.h
>

33 
	~<sigÇl.h
>

34 
	~<¡ršg.h
>

35 
	~<fú.h
>

36 
	~<sys/ioùl.h
>

38 #iâdeà
PIC


40 cÚ¡ *
	g_¢d_moduË_cÚŒŞ_hw
 = "";

43 #iâdeà
DOC_HIDDEN


45 #iâdeà
F_SETSIG


46 
	#F_SETSIG
 10

	)

49 
	#SNDRV_FILE_CONTROL
 
ALSA_DEVICE_DIRECTORY
 "cÚŒŞC%i"

	)

50 
	#SNDRV_CTL_VERSION_MAX
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4)

	)

53 
	mÿrd
;

54 
	mfd
;

55 
	m´ÙocŞ
;

56 } 
	t¢d_ùl_hw_t
;

59 
	$¢d_ùl_hw_şo£
(
¢d_ùl_t
 *
hªdË
)

61 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

62 
»s
;

63 
»s
 = 
	`şo£
(
hw
->
fd
è< 0 ? -
”ºo
 : 0;

64 
	`ä“
(
hw
);

65  
»s
;

66 
	}
}

68 
	$¢d_ùl_hw_nÚblock
(
¢d_ùl_t
 *
hªdË
, 
nÚblock
)

70 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

71 
æags
;

72 
fd
 = 
hw
->fd;

73 ià((
æags
 = 
	`fú
(
fd
, 
F_GETFL
)) < 0) {

74 
	`SYSERR
("F_GETFL failed");

75  -
”ºo
;

77 ià(
nÚblock
)

78 
æags
 |ğ
O_NONBLOCK
;

80 
æags
 &ğ~
O_NONBLOCK
;

81 ià(
	`fú
(
fd
, 
F_SETFL
, 
æags
) < 0) {

82 
	`SYSERR
("F_SETFL for O_NONBLOCK failed");

83  -
”ºo
;

86 
	}
}

88 
	$¢d_ùl_hw_async
(
¢d_ùl_t
 *
ùl
, 
sig
, 
pid_t
 
pid
)

90 
æags
;

91 
¢d_ùl_hw_t
 *
hw
 = 
ùl
->
´iv©e_d©a
;

92 
fd
 = 
hw
->fd;

94 ià((
æags
 = 
	`fú
(
fd
, 
F_GETFL
)) < 0) {

95 
	`SYSERR
("F_GETFL failed");

96  -
”ºo
;

98 ià(
sig
 >= 0)

99 
æags
 |ğ
O_ASYNC
;

101 
æags
 &ğ~
O_ASYNC
;

102 ià(
	`fú
(
fd
, 
F_SETFL
, 
æags
) < 0) {

103 
	`SYSERR
("F_SETFL for O_ASYNC failed");

104  -
”ºo
;

106 ià(
sig
 < 0)

108 ià(
	`fú
(
fd
, 
F_SETSIG
, ()
sig
) < 0) {

109 
	`SYSERR
("F_SETSIG failed");

110  -
”ºo
;

112 ià(
	`fú
(
fd
, 
F_SETOWN
, ()
pid
) < 0) {

113 
	`SYSERR
("F_SETOWN failed");

114  -
”ºo
;

117 
	}
}

119 
	$¢d_ùl_hw_subsüibe_ev’ts
(
¢d_ùl_t
 *
hªdË
, 
subsüibe
)

121 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

122 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_SUBSCRIBE_EVENTS
, &
subsüibe
) < 0) {

123 
	`SYSERR
("SNDRV_CTL_IOCTL_SUBSCRIBE_EVENTS failed");

124  -
”ºo
;

127 
	}
}

129 
	$¢d_ùl_hw_ÿrd_šfo
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_ÿrd_šfo_t
 *
šfo
)

131 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

132 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_CARD_INFO
, 
šfo
) < 0) {

133 
	`SYSERR
("SNDRV_CTL_IOCTL_CARD_INFO failed");

134  -
”ºo
;

137 
	}
}

139 
	$¢d_ùl_hw_–em_li¡
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_–em_li¡_t
 *
li¡
)

141 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

142 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_LIST
, 
li¡
) < 0)

143  -
”ºo
;

145 
	}
}

147 
	$¢d_ùl_hw_–em_šfo
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_–em_šfo_t
 *
šfo
)

149 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

150 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_INFO
, 
šfo
) < 0)

151  -
”ºo
;

153 
	}
}

155 
	$¢d_ùl_hw_–em_add
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_–em_šfo_t
 *
šfo
)

157 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

159 ià(
šfo
->
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_ENUMERATED
 &&

160 
hw
->
´ÙocŞ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 7))

161  -
ENXIO
;

163 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_ADD
, 
šfo
) < 0)

164  -
”ºo
;

166 
	}
}

168 
	$¢d_ùl_hw_–em_»¶aû
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_–em_šfo_t
 *
šfo
)

170 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

172 ià(
šfo
->
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_ENUMERATED
 &&

173 
hw
->
´ÙocŞ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 7))

174  -
ENXIO
;

176 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_REPLACE
, 
šfo
) < 0)

177  -
”ºo
;

179 
	}
}

181 
	$¢d_ùl_hw_–em_»move
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_–em_id_t
 *
id
)

183 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

184 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_REMOVE
, 
id
) < 0)

185  -
”ºo
;

187 
	}
}

189 
	$¢d_ùl_hw_–em_»ad
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_–em_v®ue_t
 *
cÚŒŞ
)

191 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

192 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_READ
, 
cÚŒŞ
) < 0)

193  -
”ºo
;

195 
	}
}

197 
	$¢d_ùl_hw_–em_wr™e
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_–em_v®ue_t
 *
cÚŒŞ
)

199 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

200 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_WRITE
, 
cÚŒŞ
) < 0)

201  -
”ºo
;

203 
	}
}

205 
	$¢d_ùl_hw_–em_lock
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_–em_id_t
 *
id
)

207 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

208 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_LOCK
, 
id
) < 0)

209  -
”ºo
;

211 
	}
}

213 
	$¢d_ùl_hw_–em_uÆock
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_–em_id_t
 *
id
)

215 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

216 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_UNLOCK
, 
id
) < 0)

217  -
”ºo
;

219 
	}
}

221 
	$¢d_ùl_hw_–em_v
(
¢d_ùl_t
 *
hªdË
, 
İ_æag
,

222 
numid
,

223 *
v
, 
v_size
)

225 
šum
;

226 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

227 
¢d_ùl_v
 *
xv
;

230 ià(
hw
->
´ÙocŞ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4))

231  -
ENXIO
;

233 
İ_æag
) {

234 -1: 
šum
 = 
SNDRV_CTL_IOCTL_TLV_COMMAND
; ;

235 0: 
šum
 = 
SNDRV_CTL_IOCTL_TLV_READ
; ;

236 1: 
šum
 = 
SNDRV_CTL_IOCTL_TLV_WRITE
; ;

237 :  -
EINVAL
;

239 
xv
 = 
	`m®loc
((
¢d_ùl_v
è+ 
v_size
);

240 ià(
xv
 =ğ
NULL
)

241  -
ENOMEM
;

242 
xv
->
numid
 =‚umid;

243 
xv
->
Ëngth
 = 
v_size
;

244 
	`memıy
(
xv
->
v
,lv, 
v_size
);

245 ià(
	`ioùl
(
hw
->
fd
, 
šum
, 
xv
) < 0) {

246 
	`ä“
(
xv
);

247  -
”ºo
;

249 ià(
İ_æag
 == 0) {

250 
size
;

251 
size
 = 
xv
->
v
[
SNDRV_CTL_TLVO_LEN
] + 2 * ();

252 ià(
size
 > 
v_size
) {

253 
	`ä“
(
xv
);

254  -
EFAULT
;

256 
	`memıy
(
v
, 
xv
->v, 
size
);

258 
	`ä“
(
xv
);

260 
	}
}

262 
	$¢d_ùl_hw_hwd•_Ãxt_deviû
(
¢d_ùl_t
 *
hªdË
, * 
deviû
)

264 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

265 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_HWDEP_NEXT_DEVICE
, 
deviû
) < 0)

266  -
”ºo
;

268 
	}
}

270 
	$¢d_ùl_hw_hwd•_šfo
(
¢d_ùl_t
 *
hªdË
, 
¢d_hwd•_šfo_t
 * 
šfo
)

272 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

273 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_HWDEP_INFO
, 
šfo
) < 0)

274  -
”ºo
;

276 
	}
}

278 
	$¢d_ùl_hw_pcm_Ãxt_deviû
(
¢d_ùl_t
 *
hªdË
, * 
deviû
)

280 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

281 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_PCM_NEXT_DEVICE
, 
deviû
) < 0)

282  -
”ºo
;

284 
	}
}

286 
	$¢d_ùl_hw_pcm_šfo
(
¢d_ùl_t
 *
hªdË
, 
¢d_pcm_šfo_t
 * 
šfo
)

288 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

289 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_PCM_INFO
, 
šfo
) < 0)

290  -
”ºo
;

292 ià(
	`__¢d_pcm_šfo_–d_fixup_check
(
šfo
))

293  
	`__¢d_pcm_šfo_–d_fixup
(
šfo
);

295 
	}
}

297 
	$¢d_ùl_hw_pcm_´eãr_subdeviû
(
¢d_ùl_t
 *
hªdË
, 
subdev
)

299 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

300 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_PCM_PREFER_SUBDEVICE
, &
subdev
) < 0)

301  -
”ºo
;

303 
	}
}

305 
	$¢d_ùl_hw_¿wmidi_Ãxt_deviû
(
¢d_ùl_t
 *
hªdË
, * 
deviû
)

307 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

308 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_RAWMIDI_NEXT_DEVICE
, 
deviû
) < 0)

309  -
”ºo
;

311 
	}
}

313 
	$¢d_ùl_hw_¿wmidi_šfo
(
¢d_ùl_t
 *
hªdË
, 
¢d_¿wmidi_šfo_t
 * 
šfo
)

315 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

316 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_RAWMIDI_INFO
, 
šfo
) < 0)

317  -
”ºo
;

319 
	}
}

321 
	$¢d_ùl_hw_¿wmidi_´eãr_subdeviû
(
¢d_ùl_t
 *
hªdË
, 
subdev
)

323 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

324 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_RAWMIDI_PREFER_SUBDEVICE
, &
subdev
) < 0)

325  -
”ºo
;

327 
	}
}

329 
	$¢d_ùl_hw_ump_Ãxt_deviû
(
¢d_ùl_t
 *
hªdË
, *
deviû
)

331 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

332 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_UMP_NEXT_DEVICE
, 
deviû
) < 0)

333  -
”ºo
;

335 
	}
}

337 
	$¢d_ùl_hw_ump_’dpošt_šfo
(
¢d_ùl_t
 *
hªdË
,

338 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

340 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

341 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_UMP_ENDPOINT_INFO
, 
šfo
) < 0)

342  -
”ºo
;

344 
	}
}

346 
	$¢d_ùl_hw_ump_block_šfo
(
¢d_ùl_t
 *
hªdË
,

347 
¢d_ump_block_šfo_t
 *
šfo
)

349 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

350 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_UMP_BLOCK_INFO
, 
šfo
) < 0)

351  -
”ºo
;

353 
	}
}

355 
	$¢d_ùl_hw_£t_pow”_¡©e
(
¢d_ùl_t
 *
hªdË
, 
¡©e
)

357 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

358 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_POWER
, &
¡©e
) < 0)

359  -
”ºo
;

361 
	}
}

363 
	$¢d_ùl_hw_g‘_pow”_¡©e
(
¢d_ùl_t
 *
hªdË
, *
¡©e
)

365 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

366 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_POWER_STATE
, 
¡©e
) < 0)

367  -
”ºo
;

369 
	}
}

371 
	$¢d_ùl_hw_»ad
(
¢d_ùl_t
 *
hªdË
, 
¢d_ùl_ev’t_t
 *
ev’t
)

373 
¢d_ùl_hw_t
 *
hw
 = 
hªdË
->
´iv©e_d©a
;

374 
ssize_t
 
»s
 = 
	`»ad
(
hw
->
fd
, 
ev’t
, (*event));

375 ià(
»s
 <= 0)

376  -
”ºo
;

377 ià(
	`CHECK_SANITY
(
»s
 !ğ(*
ev’t
))) {

378 
	`SNDMSG
("snd_ctl_hw_read:„ead sizeƒrror (req:%d, got:%d)",

379 (*
ev’t
), 
»s
);

380  -
EINVAL
;

383 
	}
}

385 cÚ¡ 
¢d_ùl_İs_t
 
	g¢d_ùl_hw_İs
 = {

386 .
şo£
 = 
¢d_ùl_hw_şo£
,

387 .
	gnÚblock
 = 
¢d_ùl_hw_nÚblock
,

388 .
	gasync
 = 
¢d_ùl_hw_async
,

389 .
	gsubsüibe_ev’ts
 = 
¢d_ùl_hw_subsüibe_ev’ts
,

390 .
	gÿrd_šfo
 = 
¢d_ùl_hw_ÿrd_šfo
,

391 .
	g–em’t_li¡
 = 
¢d_ùl_hw_–em_li¡
,

392 .
	g–em’t_šfo
 = 
¢d_ùl_hw_–em_šfo
,

393 .
	g–em’t_add
 = 
¢d_ùl_hw_–em_add
,

394 .
	g–em’t_»¶aû
 = 
¢d_ùl_hw_–em_»¶aû
,

395 .
	g–em’t_»move
 = 
¢d_ùl_hw_–em_»move
,

396 .
	g–em’t_»ad
 = 
¢d_ùl_hw_–em_»ad
,

397 .
	g–em’t_wr™e
 = 
¢d_ùl_hw_–em_wr™e
,

398 .
	g–em’t_lock
 = 
¢d_ùl_hw_–em_lock
,

399 .
	g–em’t_uÆock
 = 
¢d_ùl_hw_–em_uÆock
,

400 .
	g–em’t_v
 = 
¢d_ùl_hw_–em_v
,

401 .
	ghwd•_Ãxt_deviû
 = 
¢d_ùl_hw_hwd•_Ãxt_deviû
,

402 .
	ghwd•_šfo
 = 
¢d_ùl_hw_hwd•_šfo
,

403 .
	gpcm_Ãxt_deviû
 = 
¢d_ùl_hw_pcm_Ãxt_deviû
,

404 .
	gpcm_šfo
 = 
¢d_ùl_hw_pcm_šfo
,

405 .
	gpcm_´eãr_subdeviû
 = 
¢d_ùl_hw_pcm_´eãr_subdeviû
,

406 .
	g¿wmidi_Ãxt_deviû
 = 
¢d_ùl_hw_¿wmidi_Ãxt_deviû
,

407 .
	g¿wmidi_šfo
 = 
¢d_ùl_hw_¿wmidi_šfo
,

408 .
	g¿wmidi_´eãr_subdeviû
 = 
¢d_ùl_hw_¿wmidi_´eãr_subdeviû
,

409 .
	gump_Ãxt_deviû
 = 
¢d_ùl_hw_ump_Ãxt_deviû
,

410 .
	gump_’dpošt_šfo
 = 
¢d_ùl_hw_ump_’dpošt_šfo
,

411 .
	gump_block_šfo
 = 
¢d_ùl_hw_ump_block_šfo
,

412 .
	g£t_pow”_¡©e
 = 
¢d_ùl_hw_£t_pow”_¡©e
,

413 .
	gg‘_pow”_¡©e
 = 
¢d_ùl_hw_g‘_pow”_¡©e
,

414 .
	g»ad
 = 
¢d_ùl_hw_»ad
,

428 
	$¢d_ùl_hw_İ’
(
¢d_ùl_t
 **
hªdË
, cÚ¡ *
Çme
, 
ÿrd
, 
mode
)

430 
fd
, 
v”
;

431 
f’ame
[(
SNDRV_FILE_CONTROL
) + 10];

432 
fmode
;

433 
¢d_ùl_t
 *
ùl
;

434 
¢d_ùl_hw_t
 *
hw
;

435 
”r
;

437 *
hªdË
 = 
NULL
;

439 ià(
	`CHECK_SANITY
(
ÿrd
 < 0 || c¬d >ğ
SND_MAX_CARDS
)) {

440 
	`SNDMSG
("Inv®id c¬d index %d", 
ÿrd
);

441  -
EINVAL
;

443 
	`¥rštf
(
f’ame
, 
SNDRV_FILE_CONTROL
, 
ÿrd
);

444 ià(
mode
 & 
SND_CTL_READONLY
)

445 
fmode
 = 
O_RDONLY
;

447 
fmode
 = 
O_RDWR
;

448 ià(
mode
 & 
SND_CTL_NONBLOCK
)

449 
fmode
 |ğ
O_NONBLOCK
;

450 ià(
mode
 & 
SND_CTL_ASYNC
)

451 
fmode
 |ğ
O_ASYNC
;

452 
fd
 = 
	`¢d_İ’_deviû
(
f’ame
, 
fmode
);

453 ià(
fd
 < 0) {

454 
	`¢d_ÿrd_lßd
(
ÿrd
);

455 
fd
 = 
	`¢d_İ’_deviû
(
f’ame
, 
fmode
);

456 ià(
fd
 < 0)

457  -
”ºo
;

459 ià(
	`ioùl
(
fd
, 
SNDRV_CTL_IOCTL_PVERSION
, &
v”
) < 0) {

460 
”r
 = -
”ºo
;

461 
	`şo£
(
fd
);

462  
”r
;

464 ià(
	`SNDRV_PROTOCOL_INCOMPATIBLE
(
v”
, 
SNDRV_CTL_VERSION_MAX
)) {

465 
	`şo£
(
fd
);

466  -
SND_ERROR_INCOMPATIBLE_VERSION
;

468 
hw
 = 
	`ÿÎoc
(1, (
¢d_ùl_hw_t
));

469 ià(
hw
 =ğ
NULL
) {

470 
	`şo£
(
fd
);

471  -
ENOMEM
;

473 
hw
->
ÿrd
 = card;

474 
hw
->
fd
 = fd;

475 
hw
->
´ÙocŞ
 = 
v”
;

477 
”r
 = 
	`¢d_ùl_Ãw
(&
ùl
, 
SND_CTL_TYPE_HW
, 
Çme
, 
mode
);

478 ià(
”r
 < 0) {

479 
	`şo£
(
fd
);

480 
	`ä“
(
hw
);

481  
”r
;

483 
ùl
->
İs
 = &
¢d_ùl_hw_İs
;

484 
ùl
->
´iv©e_d©a
 = 
hw
;

485 
ùl
->
pŞl_fd
 = 
fd
;

486 *
hªdË
 = 
ùl
;

488 
	}
}

524 
	$_¢d_ùl_hw_İ’
(
¢d_ùl_t
 **
hªdËp
, *
Çme
, 
¢d_cÚfig_t
 *
roÙ
 
ATTRIBUTE_UNUSED
, snd_cÚfig_ˆ*
cÚf
, 
mode
)

526 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

527 
ÿrd
 = -1;

528 
”r
;

529 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

530 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

531 cÚ¡ *
id
;

532 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

534 ià(
	`_¢d_cÚf_g’”ic_id
(
id
))

536 ià(
	`¡rcmp
(
id
, "card") == 0) {

537 
”r
 = 
	`¢d_cÚfig_g‘_ÿrd
(
n
);

538 ià(
”r
 < 0)

539  
”r
;

540 
ÿrd
 = 
”r
;

543  -
EINVAL
;

545 ià(
ÿrd
 < 0)

546  -
EINVAL
;

547  
	`¢d_ùl_hw_İ’
(
hªdËp
, 
Çme
, 
ÿrd
, 
mode
);

548 
	}
}

549 #iâdeà
DOC_HIDDEN


550 
SND_DLSYM_BUILD_VERSION
(
_¢d_ùl_hw_İ’
, 
SND_CONTROL_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_local.h

22 
	~"loÿl.h
"

23 
	~<sound/v.h
>

25 
	s_¢d_ùl_İs
 {

26 (*
	mşo£
)(
¢d_ùl_t
 *
	mhªdË
);

27 (*
	mnÚblock
)(
¢d_ùl_t
 *
	mhªdË
, nonblock);

28 (*
	masync
)(
¢d_ùl_t
 *
	mhªdË
, 
	msig
, 
pid_t
 
	mpid
);

29 (*
	msubsüibe_ev’ts
)(
¢d_ùl_t
 *
	mhªdË
, 
	msubsüibe
);

30 (*
	mÿrd_šfo
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_ùl_ÿrd_šfo_t
 *
	mšfo
);

31 (*
	m–em’t_li¡
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_ùl_–em_li¡_t
 *
	mli¡
);

32 (*
	m–em’t_šfo
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_ùl_–em_šfo_t
 *
	mšfo
);

33 (*
	m–em’t_add
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_ùl_–em_šfo_t
 *
	mšfo
);

34 (*
	m–em’t_»¶aû
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_ùl_–em_šfo_t
 *
	mšfo
);

35 (*
	m–em’t_»move
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_ùl_–em_id_t
 *
	mid
);

36 (*
	m–em’t_»ad
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_ùl_–em_v®ue_t
 *
	mcÚŒŞ
);

37 (*
	m–em’t_wr™e
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_ùl_–em_v®ue_t
 *
	mcÚŒŞ
);

38 (*
	m–em’t_lock
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_ùl_–em_id_t
 *
	mlock
);

39 (*
	m–em’t_uÆock
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_ùl_–em_id_t
 *
	muÆock
);

40 (*
	m–em’t_v
)(
¢d_ùl_t
 *
	mhªdË
, 
	mİ_æag
, 
	mnumid
,

41 *
	mv
, 
	mv_size
);

42 (*
	mhwd•_Ãxt_deviû
)(
¢d_ùl_t
 *
	mhªdË
, *
	mdeviû
);

43 (*
	mhwd•_šfo
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_hwd•_šfo_t
 * 
	mšfo
);

44 (*
	mpcm_Ãxt_deviû
)(
¢d_ùl_t
 *
	mhªdË
, *
	mdeviû
);

45 (*
	mpcm_šfo
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_pcm_šfo_t
 * 
	mšfo
);

46 (*
	mpcm_´eãr_subdeviû
)(
¢d_ùl_t
 *
	mhªdË
, 
	msubdev
);

47 (*
	m¿wmidi_Ãxt_deviû
)(
¢d_ùl_t
 *
	mhªdË
, *
	mdeviû
);

48 (*
	m¿wmidi_šfo
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_¿wmidi_šfo_t
 * 
	mšfo
);

49 (*
	m¿wmidi_´eãr_subdeviû
)(
¢d_ùl_t
 *
	mhªdË
, 
	msubdev
);

50 (*
	mump_Ãxt_deviû
)(
¢d_ùl_t
 *
	mhªdË
, *
	mdeviû
);

51 (*
	mump_’dpošt_šfo
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_ump_’dpošt_šfo_t
 *
	mšfo
);

52 (*
	mump_block_šfo
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_ump_block_šfo_t
 *
	mšfo
);

53 (*
	m£t_pow”_¡©e
)(
¢d_ùl_t
 *
	mhªdË
, 
	m¡©e
);

54 (*
	mg‘_pow”_¡©e
)(
¢d_ùl_t
 *
	mhªdË
, *
	m¡©e
);

55 (*
	m»ad
)(
¢d_ùl_t
 *
	mhªdË
, 
¢d_ùl_ev’t_t
 *
	mev’t
);

56 (*
	mpŞl_desütÜs_couÁ
)(
¢d_ùl_t
 *
	mhªdË
);

57 (*
	mpŞl_desütÜs
)(
¢d_ùl_t
 *
	mhªdË
, 
pŞlfd
 *
	mpfds
, 
	m¥aû
);

58 (*
	mpŞl_»v’ts
)(
¢d_ùl_t
 *
	mhªdË
, 
pŞlfd
 *
	mpfds
, 
	mnfds
, *
	m»v’ts
);

59 } 
	t¢d_ùl_İs_t
;

62 
	s_¢d_ùl
 {

63 *
	mİ’_func
;

64 *
	mÇme
;

65 
¢d_ùl_ty³_t
 
	mty³
;

66 cÚ¡ 
¢d_ùl_İs_t
 *
	mİs
;

67 *
	m´iv©e_d©a
;

68 
	mmode
;

69 
	mnÚblock
;

70 
	mpŞl_fd
;

71 
li¡_h—d
 
	masync_hªdËrs
;

74 
	s_¢d_hùl_–em
 {

75 
¢d_ùl_–em_id_t
 
	mid
;

76 
li¡_h—d
 
	mli¡
;

77 
	mcom·»_weight
;

79 
¢d_hùl_–em_ÿÎback_t
 
	mÿÎback
;

80 *
	mÿÎback_´iv©e
;

82 
¢d_hùl_t
 *
	mhùl
;

85 
	s_¢d_hùl
 {

86 
¢d_ùl_t
 *
	mùl
;

87 
li¡_h—d
 
	m–ems
;

88 
	m®loc
;

89 
	mcouÁ
;

90 
¢d_hùl_–em_t
 **
	m³Ëms
;

91 
¢d_hùl_com·»_t
 
	mcom·»
;

92 
¢d_hùl_ÿÎback_t
 
	mÿÎback
;

93 *
	mÿÎback_´iv©e
;

98 
	#¢d_ùl_Ãw
 
¢d1_ùl_Ãw


	)

100 
¢d_ùl_Ãw
(
¢d_ùl_t
 **
ùÍ
, 
¢d_ùl_ty³_t
 
ty³
, cÚ¡ *
Çme
, 
mode
);

101 
_¢d_ùl_pŞl_desütÜ
(
¢d_ùl_t
 *
ùl
);

102 
	#_¢d_ùl_async_desütÜ
 
_¢d_ùl_pŞl_desütÜ


	)

103 
¢d_ùl_hw_İ’
(
¢d_ùl_t
 **
hªdË
, cÚ¡ *
Çme
, 
ÿrd
, 
mode
);

104 
¢d_ùl_shm_İ’
(
¢d_ùl_t
 **
hªdËp
, cÚ¡ *
Çme
, cÚ¡ *
sockÇme
, cÚ¡ *
¢ame
, 
mode
);

105 
¢d_ùl_async
(
¢d_ùl_t
 *
ùl
, 
sig
, 
pid_t
 
pid
);

107 
	#CTLINABORT
(
x
è((x)->
nÚblock
 =ğ2)

	)

109 #ifdeà
INTERNAL


110 
	$INTERNAL
(
¢d_ùl_–em_šfo_g‘_dim’siÚs
)(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
);

111 
	$INTERNAL
(
¢d_ùl_–em_šfo_g‘_dim’siÚ
)(cÚ¡ 
¢d_ùl_–em_šfo_t
 *
obj
, 
idx
);

114 
	`_¢d_ùl_İ’_Çmed_chd
(
¢d_ùl_t
 **
pùl
, cÚ¡ *
Çme
,

115 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

116 
mode
, 
¢d_cÚfig_t
 *
·»Á_cÚf
);

117 
šlše
 

118 
	$_¢d_ùl_İ’_chd
(
¢d_ùl_t
 **
pùl
, 
¢d_cÚfig_t
 *
roÙ
,

119 
¢d_cÚfig_t
 *
cÚf
, 
mode
, snd_cÚfig_ˆ*
·»Á_cÚf
)

121  
	`_¢d_ùl_İ’_Çmed_chd
(
pùl
, 
NULL
, 
roÙ
, 
cÚf
, 
mode
, 
·»Á_cÚf
);

122 
	}
}

124 
__¢d_ùl_add_–em_£t
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
,

125 
–em’t_couÁ
,

126 
memb”_couÁ
);

128 
__¢d_ùl_ascii_–em_id_·r£
(
¢d_ùl_–em_id_t
 *
d¡
,

129 cÚ¡ *
¡r
,

130 cÚ¡ **
»t_±r
);

132 
šlše
 

133 
	$__¢d_pcm_šfo_–d_fixup_check
(
¢d_pcm_šfo_t
 *
šfo
)

135  
šfo
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
 &&

136 
	`¡ºcmp
((*)
šfo
->
Çme
, "HDMI ", 5) == 0;

137 
	}
}

139 
__¢d_pcm_šfo_–d_fixup
(
¢d_pcm_šfo_t
 *
šfo
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_plugin.c

61 
	~"cÚŒŞ_loÿl.h
"

62 
	~"cÚŒŞ_¶ugš.h
"

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_remap.c

28 
	~"cÚŒŞ_loÿl.h
"

29 
	~<¡dio.h
>

30 
	~<¡dlib.h
>

31 
	~<¡dšt.h
>

32 
	~<¡d¬g.h
>

33 
	~<uni¡d.h
>

34 
	~<¡ršg.h
>

36 #iâdeà
DOC_HIDDEN


38 
	#REMAP_DEBUG
 1

	)

39 
	#debug
(
fÜm©
, 
¬gs
...è
	`årštf
(
¡d”r
, fÜm©, ##¬gs)

	)

40 
	#debug_id
(
id
, 
fÜm©
, 
¬gs
...) do { \

41 *
s
 = 
	`¢d_ùl_ascii_–em_id_g‘
(
id
); \

42 
	`årštf
(
¡d”r
, "%s: ", 
s
); 
	`ä“
(s); \

43 
	`årštf
(
¡d”r
, 
fÜm©
, ##
¬gs
); \

44 } 0)

	)

46 
	#REMAP_DEBUG
 0

	)

47 
	#debug
(
fÜm©
, 
¬gs
...èdØ{ } 0)

	)

48 
	#debug_id
(
id
, 
fÜm©
, 
¬gs
...èdØ{ } 0)

	)

51 
	#EREMAPNOTFOUND
 (888899)

	)

54 #iâdeà
PIC


56 cÚ¡ *
	g_¢d_moduË_cÚŒŞ_»m­
 = "";

59 #iâdeà
DOC_HIDDEN


61 
	mnumid_chd
;

62 
	mnumid_­p
;

63 } 
	t¢d_ùl_numid_t
;

66 
¢d_ùl_–em_id_t
 
	mid_chd
;

67 
¢d_ùl_–em_id_t
 
	mid_­p
;

68 } 
	t¢d_ùl_»m­_id_t
;

71 
¢d_ùl_–em_id_t
 
	mm­_id
;

72 
¢d_ùl_–em_ty³_t
 
	mty³
;

73 
size_t
 
	mcÚŒŞs_™ems
;

74 
size_t
 
	mcÚŒŞs_®loc
;

75 
	s¢d_ùl_m­_ùl
 {

76 
¢d_ùl_–em_id_t
 
	mid_chd
;

77 
size_t
 
	mchªÃl_m­_™ems
;

78 
size_t
 
	mchªÃl_m­_®loc
;

79 *
	mchªÃl_m­
;

80 } *
	mcÚŒŞs
;

81 
	mev’t_mask
;

82 } 
	t¢d_ùl_m­_t
;

85 
¢d_ùl_t
 *
	mchd
;

86 
	mnumid_»m­_aùive
;

87 
	mnumid_­p_Ï¡
;

88 
size_t
 
	mnumid_™ems
;

89 
size_t
 
	mnumid_®loc
;

90 
¢d_ùl_numid_t
 *
	mnumid
;

91 
¢d_ùl_numid_t
 
	mnumid_‹mp
;

92 
size_t
 
	m»m­_™ems
;

93 
size_t
 
	m»m­_®loc
;

94 
¢d_ùl_»m­_id_t
 *
	m»m­
;

95 
size_t
 
	mm­_™ems
;

96 
size_t
 
	mm­_®loc
;

97 
¢d_ùl_m­_t
 *
	mm­
;

98 
size_t
 
	mm­_»ad_queue_h—d
;

99 
size_t
 
	mm­_»ad_queue_
;

100 
¢d_ùl_m­_t
 **
	mm­_»ad_queue
;

101 } 
	t¢d_ùl_»m­_t
;

104 
¢d_ùl_numid_t
 *
	$»m­_numid_‹mp
(
¢d_ùl_»m­_t
 *
´iv
, 
numid
)

106 
´iv
->
numid_‹mp
.
numid_chd
 = 
numid
;

107 
´iv
->
numid_‹mp
.
numid_­p
 = 
numid
;

108  &
´iv
->
numid_‹mp
;

109 
	}
}

111 
¢d_ùl_numid_t
 *
	$»m­_fšd_numid_­p
(
¢d_ùl_»m­_t
 *
´iv
, 
numid_­p
)

113 
¢d_ùl_numid_t
 *
numid
;

114 
size_t
 
couÁ
;

116 ià(!
´iv
->
numid_»m­_aùive
)

117  
	`»m­_numid_‹mp
(
´iv
, 
numid_­p
);

118 
numid
 = 
´iv
->numid;

119 
couÁ
 = 
´iv
->
numid_™ems
; couÁ > 0; couÁ--, 
numid
++)

120 ià(
numid_­p
 =ğ
numid
->numid_app)

121  
numid
;

122  
NULL
;

123 
	}
}

125 
¢d_ùl_numid_t
 *
	$»m­_numid_Ãw
(
¢d_ùl_»m­_t
 *
´iv
, 
numid_chd
,

126 
numid_­p
)

128 
¢d_ùl_numid_t
 *
numid
;

130 ià(
´iv
->
numid_®loc
 =ğ´iv->
numid_™ems
) {

131 
numid
 = 
	`»®loc
(
´iv
->numid, (´iv->
numid_®loc
 + 16) * (*numid));

132 ià(
numid
 =ğ
NULL
)

133  
NULL
;

134 
	`mem£t
(
numid
 + 
´iv
->
numid_®loc
, 0, (*numid) * 16);

135 
´iv
->
numid_®loc
 += 16;

136 
´iv
->
numid
 =‚umid;

138 
numid
 = &
´iv
->numid[´iv->
numid_™ems
++];

139 
numid
->
numid_chd
 =‚umid_child;

140 
numid
->
numid_­p
 =‚umid_app;

141 
	`debug
("Ãw‚umid: chd %u‡µ %u\n", 
numid
->
numid_chd
,‚umid->
numid_­p
);

142  
numid
;

143 
	}
}

145 
¢d_ùl_numid_t
 *
	$»m­_numid_chd_Ãw
(
¢d_ùl_»m­_t
 *
´iv
, 
numid_chd
)

147 
numid_­p
;

149 ià(
numid_chd
 == 0)

150  
NULL
;

151 ià(
´iv
->
numid_»m­_aùive
 && 
	`»m­_fšd_numid_­p
Õriv, 
numid_chd
)) {

152 
	`»m­_fšd_numid_­p
(
´iv
,…riv->
numid_­p_Ï¡
))

153 
´iv
->
numid_­p_Ï¡
++;

154 
numid_­p
 = 
´iv
->
numid_­p_Ï¡
;

156 
numid_­p
 = 
numid_chd
;

158  
	`»m­_numid_Ãw
(
´iv
, 
numid_chd
, 
numid_­p
);

159 
	}
}

161 
¢d_ùl_numid_t
 *
	$»m­_fšd_numid_chd
(
¢d_ùl_»m­_t
 *
´iv
, 
numid_chd
)

163 
¢d_ùl_numid_t
 *
numid
;

164 
size_t
 
couÁ
;

166 ià(!
´iv
->
numid_»m­_aùive
)

167  
	`»m­_numid_‹mp
(
´iv
, 
numid_chd
);

168 
numid
 = 
´iv
->numid;

169 
couÁ
 = 
´iv
->
numid_™ems
; couÁ > 0; couÁ--, 
numid
++)

170 ià(
numid_chd
 =ğ
numid
->numid_child)

171  
numid
;

172  
	`»m­_numid_chd_Ãw
(
´iv
, 
numid_chd
);

173 
	}
}

175 
¢d_ùl_»m­_id_t
 *
	$»m­_fšd_id_chd
(
¢d_ùl_»m­_t
 *
´iv
, 
¢d_ùl_–em_id_t
 *
id
)

177 
size_t
 
couÁ
;

178 
¢d_ùl_»m­_id_t
 *
rid
;

180 ià(
id
->
numid
 > 0) {

181 
rid
 = 
´iv
->
»m­
;

182 
couÁ
 = 
´iv
->
»m­_™ems
; couÁ > 0; couÁ--, 
rid
++)

183 ià(
id
->
numid
 =ğ
rid
->
id_chd
.numid)

184  
rid
;

186 
rid
 = 
´iv
->
»m­
;

187 
couÁ
 = 
´iv
->
»m­_™ems
; couÁ > 0; couÁ--, 
rid
++)

188 ià(
	`¢d_ùl_–em_id_com·»_£t
(
id
, &
rid
->
id_chd
) == 0)

189  
rid
;

190  
NULL
;

191 
	}
}

193 
¢d_ùl_»m­_id_t
 *
	$»m­_fšd_id_­p
(
¢d_ùl_»m­_t
 *
´iv
, 
¢d_ùl_–em_id_t
 *
id
)

195 
size_t
 
couÁ
;

196 
¢d_ùl_»m­_id_t
 *
rid
;

198 ià(
id
->
numid
 > 0) {

199 
rid
 = 
´iv
->
»m­
;

200 
couÁ
 = 
´iv
->
»m­_™ems
; couÁ > 0; couÁ--, 
rid
++)

201 ià(
id
->
numid
 =ğ
rid
->
id_­p
.numid)

202  
rid
;

204 
rid
 = 
´iv
->
»m­
;

205 
couÁ
 = 
´iv
->
»m­_™ems
; couÁ > 0; couÁ--, 
rid
++)

206 ià(
	`¢d_ùl_–em_id_com·»_£t
(
id
, &
rid
->
id_­p
) == 0)

207  
rid
;

208  
NULL
;

209 
	}
}

211 
¢d_ùl_m­_t
 *
	$»m­_fšd_m­_numid
(
¢d_ùl_»m­_t
 *
´iv
, 
numid
)

213 
size_t
 
couÁ
;

214 
¢d_ùl_m­_t
 *
m­
;

216 ià(
numid
 == 0)

217  
NULL
;

218 
m­
 = 
´iv
->map;

219 
couÁ
 = 
´iv
->
m­_™ems
; couÁ > 0; couÁ--, 
m­
++) {

220 ià(
numid
 =ğ
m­
->
m­_id
.numid)

221  
m­
;

223  
NULL
;

224 
	}
}

226 
¢d_ùl_m­_t
 *
	$»m­_fšd_m­_id
(
¢d_ùl_»m­_t
 *
´iv
, 
¢d_ùl_–em_id_t
 *
id
)

228 
size_t
 
couÁ
;

229 
¢d_ùl_m­_t
 *
m­
;

231 ià(
id
->
numid
 > 0)

232  
	`»m­_fšd_m­_numid
(
´iv
, 
id
->
numid
);

233 
m­
 = 
´iv
->map;

234 
couÁ
 = 
´iv
->
m­_™ems
; couÁ > 0; couÁ--, 
m­
++)

235 ià(
	`¢d_ùl_–em_id_com·»_£t
(
id
, &
m­
->
m­_id
) == 0)

236  
m­
;

237  
NULL
;

238 
	}
}

240 
	$»m­_id_to_chd
(
¢d_ùl_»m­_t
 *
´iv
, 
¢d_ùl_–em_id_t
 *
id
, 
¢d_ùl_»m­_id_t
 **
_rid
)

242 
¢d_ùl_»m­_id_t
 *
rid
;

243 
¢d_ùl_numid_t
 *
numid
;

245 
	`debug_id
(
id
, "% ’‹r\n", 
__func__
);

246 
rid
 = 
	`»m­_fšd_id_­p
(
´iv
, 
id
);

247 ià(
rid
) {

248 ià(
rid
->
id_­p
.
numid
 == 0) {

249 
numid
 = 
	`»m­_fšd_numid_­p
(
´iv
, 
id
->numid);

250 ià(
numid
) {

251 
rid
->
id_chd
.
numid
 =‚umid->
numid_chd
;

252 
rid
->
id_­p
.
numid
 =‚umid->
numid_­p
;

255 *
id
 = 
rid
->
id_chd
;

257 ià(
	`»m­_fšd_id_chd
(
´iv
, 
id
))

258  -
ENOENT
;

259 
numid
 = 
	`»m­_fšd_numid_­p
(
´iv
, 
id
->numid);

260 ià(
numid
)

261 
id
->
numid
 =‚umid->
numid_chd
;

263 
id
->
numid
 = 0;

265 *
_rid
 = 
rid
;

266 
	`debug_id
(
id
, "% Ëave\n", 
__func__
);

268 
	}
}

270 
	$»m­_id_to_­p
(
¢d_ùl_»m­_t
 *
´iv
, 
¢d_ùl_–em_id_t
 *
id
, 
¢d_ùl_»m­_id_t
 *
rid
, 
”r
)

272 
¢d_ùl_numid_t
 *
numid
;

274 ià(
rid
) {

275 ià(
”r
 >ğ0 && 
rid
->
id_­p
.
numid
 == 0) {

276 
numid
 = 
	`»m­_numid_chd_Ãw
(
´iv
, 
id
->numid);

277 ià(
numid
 =ğ
NULL
)

278  -
EIO
;

279 
rid
->
id_chd
.
numid
 =‚umid->
numid_chd
;

280 
rid
->
id_­p
.
numid
 =‚umid->
numid_­p
;

282 *
id
 = 
rid
->
id_­p
;

284 ià(
”r
 >= 0) {

285 
numid
 = 
	`»m­_fšd_numid_chd
(
´iv
, 
id
->numid);

286 ià(
numid
 =ğ
NULL
)

287  -
EIO
;

288 
id
->
numid
 =‚umid->
numid_­p
;

291  
”r
;

292 
	}
}

294 
	$»m­_ä“
(
¢d_ùl_»m­_t
 *
´iv
)

296 
size_t
 
idx1
, 
idx2
;

297 
¢d_ùl_m­_t
 *
m­
;

299 
idx1
 = 0; idx1 < 
´iv
->
m­_™ems
; idx1++) {

300 
m­
 = &
´iv
->m­[
idx1
];

301 
idx2
 = 0; idx2 < 
m­
->
cÚŒŞs_™ems
; idx2++)

302 
	`ä“
(
m­
->
cÚŒŞs
[
idx2
].
chªÃl_m­
);

303 
	`ä“
(
m­
->
cÚŒŞs
);

305 
	`ä“
(
´iv
->
m­_»ad_queue
);

306 
	`ä“
(
´iv
->
m­
);

307 
	`ä“
(
´iv
->
»m­
);

308 
	`ä“
(
´iv
->
numid
);

309 
	`ä“
(
´iv
);

310 
	}
}

312 
	$¢d_ùl_»m­_şo£
(
¢d_ùl_t
 *
ùl
)

314 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

315 
”r
 = 
	`¢d_ùl_şo£
(
´iv
->
chd
);

316 
	`»m­_ä“
(
´iv
);

317  
”r
;

318 
	}
}

320 
	$¢d_ùl_»m­_nÚblock
(
¢d_ùl_t
 *
ùl
, 
nÚblock
)

322 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

323  
	`¢d_ùl_nÚblock
(
´iv
->
chd
, 
nÚblock
);

324 
	}
}

326 
	$¢d_ùl_»m­_async
(
¢d_ùl_t
 *
ùl
, 
sig
, 
pid_t
 
pid
)

328 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

329  
	`¢d_ùl_async
(
´iv
->
chd
, 
sig
, 
pid
);

330 
	}
}

332 
	$¢d_ùl_»m­_subsüibe_ev’ts
(
¢d_ùl_t
 *
ùl
, 
subsüibe
)

334 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

335  
	`¢d_ùl_subsüibe_ev’ts
(
´iv
->
chd
, 
subsüibe
);

336 
	}
}

338 
	$¢d_ùl_»m­_ÿrd_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_ÿrd_šfo_t
 *
šfo
)

340 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

341  
	`¢d_ùl_ÿrd_šfo
(
´iv
->
chd
, 
šfo
);

342 
	}
}

344 
	$¢d_ùl_»m­_–em_li¡
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_li¡_t
 *
li¡
)

346 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

347 
¢d_ùl_–em_id_t
 *
id
;

348 
¢d_ùl_»m­_id_t
 *
rid
;

349 
¢d_ùl_numid_t
 *
numid
;

350 
¢d_ùl_m­_t
 *
m­
;

351 
šdex
;

352 
size_t
 
šdex2
;

353 
”r
;

355 
”r
 = 
	`¢d_ùl_–em_li¡
(
´iv
->
chd
, 
li¡
);

356 ià(
”r
 < 0)

357  
”r
;

358 
šdex
 = 0; index < 
li¡
->
u£d
; index++) {

359 
id
 = &
li¡
->
pids
[
šdex
];

360 
rid
 = 
	`»m­_fšd_id_chd
(
´iv
, 
id
);

361 ià(
rid
) {

362 
rid
->
id_­p
.
numid
 = 
id
->numid;

363 *
id
 = 
rid
->
id_­p
;

365 
numid
 = 
	`»m­_fšd_numid_chd
(
´iv
, 
id
->numid);

366 ià(
numid
 =ğ
NULL
)

367  -
EIO
;

368 
id
->
numid
 =‚umid->
numid_­p
;

370 ià(
li¡
->
off£t
 >ğli¡->
couÁ
 + 
´iv
->
m­_™ems
)

372 
šdex2
 = 0;

373 ià(
li¡
->
off£t
 >†i¡->
couÁ
)

374 
šdex2
 = 
li¡
->
off£t
 -†i¡->
couÁ
;

375  ; 
šdex
 < 
li¡
->
¥aû
 && 
šdex2
 < 
´iv
->
m­_™ems
; index2++, index++) {

376 
id
 = &
li¡
->
pids
[
šdex
];

377 
m­
 = &
´iv
->m­[
šdex2
];

378 *
id
 = 
m­
->
m­_id
;

379 
li¡
->
u£d
++;

381 
li¡
->
couÁ
 +ğ
´iv
->
m­_™ems
;

383 
	}
}

385 #iâdeà
DOC_HIDDEN


386 
	#ACCESS_BITS
(
b™s
) \

387 (
b™s
 & (
SNDRV_CTL_ELEM_ACCESS_READWRITE
|\

388 
SNDRV_CTL_ELEM_ACCESS_VOLATILE
|\

389 
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
))

	)

392 
	$»m­_m­_–em_šfo
(
¢d_ùl_»m­_t
 *
´iv
, 
¢d_ùl_–em_šfo_t
 *
šfo
)

394 
¢d_ùl_m­_t
 *
m­
;

395 
¢d_ùl_–em_šfo_t
 
šfo2
, 
šfo3
;

396 
size_t
 
™em
;

397 
acûss
;

398 
size_t
 
couÁ
;

399 
owÃr
, 
”r
;

401 
m­
 = 
	`»m­_fšd_m­_id
(
´iv
, &
šfo
->
id
);

402 ià(
m­
 =ğ
NULL
)

403  -
EREMAPNOTFOUND
;

404 
	`debug_id
(&
šfo
->
id
, "%s\n", 
__func__
);

405 
	`as£¹
(
m­
->
cÚŒŞs_™ems
 > 0);

406 
	`¢d_ùl_–em_šfo_ş—r
(&
šfo2
);

407 
šfo2
.
id
 = 
m­
->
cÚŒŞs
[0].
id_chd
;

408 
	`debug_id
(&
šfo2
.
id
, "% cÚŒŞs[0]\n", 
__func__
);

409 
”r
 = 
	`¢d_ùl_–em_šfo
(
´iv
->
chd
, &
šfo2
);

410 ià(
”r
 < 0)

411  
”r
;

412 ià(
šfo2
.
ty³
 !ğ
SNDRV_CTL_ELEM_TYPE_BOOLEAN
 &&

413 
šfo2
.
ty³
 !ğ
SNDRV_CTL_ELEM_TYPE_INTEGER
 &&

414 
šfo2
.
ty³
 !ğ
SNDRV_CTL_ELEM_TYPE_INTEGER64
 &&

415 
šfo2
.
ty³
 !ğ
SNDRV_CTL_ELEM_TYPE_BYTES
)

416  -
EIO
;

417 
m­
->
cÚŒŞs
[0].
id_chd
.
numid
 = 
šfo2
.
id
.numid;

418 
m­
->
ty³
 = 
šfo2
.type;

419 
acûss
 = 
šfo2
.access;

420 
owÃr
 = 
šfo2
.owner;

421 
couÁ
 = 
m­
->
cÚŒŞs
[0].
chªÃl_m­_™ems
;

422 
™em
 = 1; i‹m < 
m­
->
cÚŒŞs_™ems
; item++) {

423 
	`¢d_ùl_–em_šfo_ş—r
(&
šfo3
);

424 
šfo3
.
id
 = 
m­
->
cÚŒŞs
[
™em
].
id_chd
;

425 
	`debug_id
(&
šfo3
.
id
, "% cÚŒŞs[%zd]\n", 
__func__
, 
™em
);

426 
”r
 = 
	`¢d_ùl_–em_šfo
(
´iv
->
chd
, &
šfo3
);

427 ià(
”r
 < 0)

428  
”r
;

429 ià(
šfo2
.
ty³
 !ğ
šfo3
.type)

430  -
EIO
;

431 ià(
	`ACCESS_BITS
(
šfo2
.
acûss
è!ğACCESS_BITS(
šfo3
.access))

432  -
EIO
;

433 ià(
šfo2
.
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_BOOLEAN
 ||

434 
šfo2
.
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_INTEGER
) {

435 ià(
	`memcmp
(&
šfo2
.
v®ue
.
š‹g”
, &
šfo3
.value.integer, (info2.value.integer)))

436  -
EIO
;

437 } ià(
šfo2
.
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_INTEGER64
) {

438 ià(
	`memcmp
(&
šfo2
.
v®ue
.
š‹g”64
, &
šfo3
.value.integer64, (info2.value.integer64)))

439  -
EIO
;

441 
acûss
 |ğ
šfo3
.access;

442 ià(
owÃr
 == 0)

443 
owÃr
 = 
šfo3
.owner;

444 ià(
couÁ
 < 
m­
->
cÚŒŞs
[
™em
].
chªÃl_m­_™ems
)

445 
couÁ
 = 
m­
->
cÚŒŞs
[
™em
].
chªÃl_m­_™ems
;

447 
	`¢d_ùl_–em_šfo_ş—r
(
šfo
);

448 
šfo
->
id
 = 
m­
->
m­_id
;

449 
šfo
->
ty³
 = 
šfo2
.type;

450 
šfo
->
acûss
 =‡ccess;

451 
šfo
->
couÁ
 = count;

452 ià(
šfo2
.
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_BOOLEAN
 ||

453 
šfo2
.
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_INTEGER
)

454 
šfo
->
v®ue
.
š‹g”
 = 
šfo2
.value.integer;

455 ià(
šfo2
.
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_INTEGER64
)

456 
šfo
->
v®ue
.
š‹g”64
 = 
šfo2
.value.integer64;

457 ià(
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_LOCK
)

458 
šfo
->
owÃr
 = owner;

460 
	}
}

462 
	$¢d_ùl_»m­_–em_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
)

464 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

465 
¢d_ùl_»m­_id_t
 *
rid
;

466 
”r
;

468 
	`debug_id
(&
šfo
->
id
, "%s\n", 
__func__
);

469 
”r
 = 
	`»m­_m­_–em_šfo
(
´iv
, 
šfo
);

470 ià(
”r
 !ğ-
EREMAPNOTFOUND
)

471  
”r
;

472 
”r
 = 
	`»m­_id_to_chd
(
´iv
, &
šfo
->
id
, &
rid
);

473 ià(
”r
 < 0)

474  
”r
;

475 
”r
 = 
	`¢d_ùl_–em_šfo
(
´iv
->
chd
, 
šfo
);

476  
	`»m­_id_to_­p
(
´iv
, &
šfo
->
id
, 
rid
, 
”r
);

477 
	}
}

479 
	$»m­_m­_–em_»ad
(
¢d_ùl_»m­_t
 *
´iv
, 
¢d_ùl_–em_v®ue_t
 *
cÚŒŞ
)

481 
¢d_ùl_m­_t
 *
m­
;

482 
¢d_ùl_m­_ùl
 *
mùl
;

483 
¢d_ùl_–em_v®ue_t
 
cÚŒŞ2
;

484 
size_t
 
™em
, 
šdex
;

485 
”r
;

487 
m­
 = 
	`»m­_fšd_m­_id
(
´iv
, &
cÚŒŞ
->
id
);

488 ià(
m­
 =ğ
NULL
)

489  -
EREMAPNOTFOUND
;

490 
	`debug_id
(&
cÚŒŞ
->
id
, "%s\n", 
__func__
);

491 
	`¢d_ùl_–em_v®ue_ş—r
(
cÚŒŞ
);

492 
cÚŒŞ
->
id
 = 
m­
->
m­_id
;

493 
™em
 = 0; i‹m < 
m­
->
cÚŒŞs_™ems
; item++) {

494 
mùl
 = &
m­
->
cÚŒŞs
[
™em
];

495 
	`¢d_ùl_–em_v®ue_ş—r
(&
cÚŒŞ2
);

496 
cÚŒŞ2
.
id
 = 
mùl
->
id_chd
;

497 
	`debug_id
(&
cÚŒŞ2
.
id
, "% cÚŒŞs[%zd]\n", 
__func__
, 
™em
);

498 
”r
 = 
	`¢d_ùl_–em_»ad
(
´iv
->
chd
, &
cÚŒŞ2
);

499 ià(
”r
 < 0)

500  
”r
;

501 ià(
m­
->
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_BOOLEAN
 ||

502 
m­
->
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_INTEGER
) {

503 
šdex
 = 0; index < 
mùl
->
chªÃl_m­_™ems
; index++) {

504 
¤c
 = 
mùl
->
chªÃl_m­
[
šdex
];

505 ià(()
¤c
 < 
	`ARRAY_SIZE
(
cÚŒŞ
->
v®ue
.
š‹g”
.value))

506 
cÚŒŞ
->
v®ue
.
š‹g”
.v®ue[
šdex
] = 
cÚŒŞ2
.v®ue.š‹g”.v®ue[
¤c
];

508 } ià(
m­
->
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_INTEGER64
) {

509 
šdex
 = 0; index < 
mùl
->
chªÃl_m­_™ems
; index++) {

510 
¤c
 = 
mùl
->
chªÃl_m­
[
šdex
];

511 ià(()
¤c
 < 
	`ARRAY_SIZE
(
cÚŒŞ
->
v®ue
.
š‹g”64
.value))

512 
cÚŒŞ
->
v®ue
.
š‹g”64
.v®ue[
šdex
] = 
cÚŒŞ2
.v®ue.š‹g”64.v®ue[
¤c
];

514 } ià(
m­
->
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_BYTES
) {

515 
šdex
 = 0; index < 
mùl
->
chªÃl_m­_™ems
; index++) {

516 
¤c
 = 
mùl
->
chªÃl_m­
[
šdex
];

517 ià(()
¤c
 < 
	`ARRAY_SIZE
(
cÚŒŞ
->
v®ue
.
by‹s
.
d©a
))

518 
cÚŒŞ
->
v®ue
.
by‹s
.
d©a
[
šdex
] = 
cÚŒŞ2
.v®ue.by‹s.d©a[
¤c
];

523 
	}
}

525 
	$¢d_ùl_»m­_–em_»ad
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_v®ue_t
 *
cÚŒŞ
)

527 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

528 
¢d_ùl_»m­_id_t
 *
rid
;

529 
”r
;

531 
	`debug_id
(&
cÚŒŞ
->
id
, "%s\n", 
__func__
);

532 
”r
 = 
	`»m­_m­_–em_»ad
(
´iv
, 
cÚŒŞ
);

533 ià(
”r
 !ğ-
EREMAPNOTFOUND
)

534  
”r
;

535 
”r
 = 
	`»m­_id_to_chd
(
´iv
, &
cÚŒŞ
->
id
, &
rid
);

536 ià(
”r
 < 0)

537  
”r
;

538 
”r
 = 
	`¢d_ùl_–em_»ad
(
´iv
->
chd
, 
cÚŒŞ
);

539  
	`»m­_id_to_­p
(
´iv
, &
cÚŒŞ
->
id
, 
rid
, 
”r
);

540 
	}
}

542 
	$»m­_m­_–em_wr™e
(
¢d_ùl_»m­_t
 *
´iv
, 
¢d_ùl_–em_v®ue_t
 *
cÚŒŞ
)

544 
¢d_ùl_m­_t
 *
m­
;

545 
¢d_ùl_m­_ùl
 *
mùl
;

546 
¢d_ùl_–em_v®ue_t
 
cÚŒŞ2
;

547 
size_t
 
™em
, 
šdex
;

548 
”r
, 
chªges
;

550 
m­
 = 
	`»m­_fšd_m­_id
(
´iv
, &
cÚŒŞ
->
id
);

551 ià(
m­
 =ğ
NULL
)

552  -
EREMAPNOTFOUND
;

553 
	`debug_id
(&
cÚŒŞ
->
id
, "%s\n", 
__func__
);

554 
cÚŒŞ
->
id
 = 
m­
->
m­_id
;

555 
™em
 = 0; i‹m < 
m­
->
cÚŒŞs_™ems
; item++) {

556 
mùl
 = &
m­
->
cÚŒŞs
[
™em
];

557 
	`¢d_ùl_–em_v®ue_ş—r
(&
cÚŒŞ2
);

558 
cÚŒŞ2
.
id
 = 
mùl
->
id_chd
;

559 
	`debug_id
(&
cÚŒŞ2
.
id
, "% cÚŒŞs[%zd]\n", 
__func__
, 
™em
);

560 
”r
 = 
	`¢d_ùl_–em_»ad
(
´iv
->
chd
, &
cÚŒŞ2
);

561 ià(
”r
 < 0)

562  
”r
;

563 
chªges
 = 0;

564 ià(
m­
->
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_BOOLEAN
 ||

565 
m­
->
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_INTEGER
) {

566 
šdex
 = 0; index < 
mùl
->
chªÃl_m­_™ems
; index++) {

567 
d¡
 = 
mùl
->
chªÃl_m­
[
šdex
];

568 ià(()
d¡
 < 
	`ARRAY_SIZE
(
cÚŒŞ
->
v®ue
.
š‹g”
.value)) {

569 
chªges
 |ğ
cÚŒŞ2
.
v®ue
.
š‹g”
.v®ue[
d¡
] !ğ
cÚŒŞ
->v®ue.š‹g”.v®ue[
šdex
];

570 
cÚŒŞ2
.
v®ue
.
š‹g”
.v®ue[
d¡
] = 
cÚŒŞ
->v®ue.š‹g”.v®ue[
šdex
];

573 } ià(
m­
->
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_INTEGER64
) {

574 
šdex
 = 0; index < 
mùl
->
chªÃl_m­_™ems
; index++) {

575 
d¡
 = 
mùl
->
chªÃl_m­
[
šdex
];

576 ià(()
d¡
 < 
	`ARRAY_SIZE
(
cÚŒŞ
->
v®ue
.
š‹g”64
.value)) {

577 
chªges
 |ğ
cÚŒŞ2
.
v®ue
.
š‹g”64
.v®ue[
d¡
] !ğ
cÚŒŞ
->v®ue.š‹g”64.v®ue[
šdex
];

578 
cÚŒŞ2
.
v®ue
.
š‹g”64
.v®ue[
d¡
] = 
cÚŒŞ
->v®ue.š‹g”64.v®ue[
šdex
];

581 } ià(
m­
->
ty³
 =ğ
SNDRV_CTL_ELEM_TYPE_BYTES
) {

582 
šdex
 = 0; index < 
mùl
->
chªÃl_m­_™ems
; index++) {

583 
d¡
 = 
mùl
->
chªÃl_m­
[
šdex
];

584 ià(()
d¡
 < 
	`ARRAY_SIZE
(
cÚŒŞ
->
v®ue
.
by‹s
.
d©a
)) {

585 
chªges
 |ğ
cÚŒŞ2
.
v®ue
.
by‹s
.
d©a
[
d¡
] !ğ
cÚŒŞ
->v®ue.by‹s.d©a[
šdex
];

586 
cÚŒŞ2
.
v®ue
.
by‹s
.
d©a
[
d¡
] = 
cÚŒŞ
->v®ue.by‹s.d©a[
šdex
];

590 
	`debug_id
(&
cÚŒŞ2
.
id
, "% chªge %d\n", 
__func__
, 
chªges
);

591 ià(
chªges
 > 0) {

592 
”r
 = 
	`¢d_ùl_–em_wr™e
(
´iv
->
chd
, &
cÚŒŞ2
);

593 ià(
”r
 < 0)

594  
”r
;

598 
	}
}

600 
	$¢d_ùl_»m­_–em_wr™e
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_v®ue_t
 *
cÚŒŞ
)

602 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

603 
¢d_ùl_»m­_id_t
 *
rid
;

604 
”r
;

606 
	`debug_id
(&
cÚŒŞ
->
id
, "%s\n", 
__func__
);

607 
”r
 = 
	`»m­_m­_–em_wr™e
(
´iv
, 
cÚŒŞ
);

608 ià(
”r
 !ğ-
EREMAPNOTFOUND
)

609  
”r
;

610 
”r
 = 
	`»m­_id_to_chd
(
´iv
, &
cÚŒŞ
->
id
, &
rid
);

611 ià(
”r
 < 0)

612  
”r
;

613 
”r
 = 
	`¢d_ùl_–em_wr™e
(
´iv
->
chd
, 
cÚŒŞ
);

614  
	`»m­_id_to_­p
(
´iv
, &
cÚŒŞ
->
id
, 
rid
, 
”r
);

615 
	}
}

617 
	$¢d_ùl_»m­_–em_lock
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_id_t
 *
id
)

619 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

620 
¢d_ùl_»m­_id_t
 *
rid
;

621 
”r
;

623 
	`debug_id
(
id
, "%s\n", 
__func__
);

624 
”r
 = 
	`»m­_id_to_chd
(
´iv
, 
id
, &
rid
);

625 ià(
”r
 < 0)

626  
”r
;

627 
”r
 = 
	`¢d_ùl_–em_lock
(
´iv
->
chd
, 
id
);

628  
	`»m­_id_to_­p
(
´iv
, 
id
, 
rid
, 
”r
);

629 
	}
}

631 
	$¢d_ùl_»m­_–em_uÆock
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_id_t
 *
id
)

633 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

634 
¢d_ùl_»m­_id_t
 *
rid
;

635 
”r
;

637 
	`debug_id
(
id
, "%s\n", 
__func__
);

638 
”r
 = 
	`»m­_id_to_chd
(
´iv
, 
id
, &
rid
);

639 ià(
”r
 < 0)

640  
”r
;

641 
”r
 = 
	`¢d_ùl_–em_uÆock
(
´iv
->
chd
, 
id
);

642  
	`»m­_id_to_­p
(
´iv
, 
id
, 
rid
, 
”r
);

643 
	}
}

645 
	$»m­_g‘_m­_numid
(
¢d_ùl_»m­_t
 *
´iv
, 
¢d_ùl_m­_ùl
 *
mùl
)

647 
¢d_ùl_–em_šfo_t
 
šfo
;

648 
¢d_ùl_numid_t
 *
numid
;

649 
”r
;

651 ià(
mùl
->
id_chd
.
numid
 > 0)

653 
	`debug_id
(&
mùl
->
id_chd
, "% g‘‚umid\n", 
__func__
);

654 
	`¢d_ùl_–em_šfo_ş—r
(&
šfo
);

655 
šfo
.
id
 = 
mùl
->
id_chd
;

656 
”r
 = 
	`¢d_ùl_–em_šfo
(
´iv
->
chd
, &
šfo
);

657 ià(
”r
 < 0)

658  
”r
;

659 
numid
 = 
	`»m­_fšd_numid_chd
(
´iv
, 
šfo
.
id
.numid);

660 ià(
numid
 =ğ
NULL
)

661  -
EIO
;

662 
mùl
->
id_chd
.
numid
 = 
šfo
.
id
.numid;

664 
	}
}

666 
	$»m­_m­_–em_v
(
¢d_ùl_»m­_t
 *
´iv
, 
İ_æag
, 
numid
,

667 *
v
, 
v_size
)

669 
¢d_ùl_m­_t
 *
m­
;

670 
¢d_ùl_m­_ùl
 *
mùl
;

671 
size_t
 
™em
;

672 *
v2
;

673 
”r
;

675 
m­
 = 
	`»m­_fšd_m­_numid
(
´iv
, 
numid
);

676 ià(
m­
 =ğ
NULL
)

677  -
EREMAPNOTFOUND
;

678 ià(
İ_æag
 != 0)

679  -
ENXIO
;

680 
	`debug
("% numid %d\n", 
__func__
, 
numid
);

681 
mùl
 = &
m­
->
cÚŒŞs
[0];

682 
”r
 = 
	`»m­_g‘_m­_numid
(
´iv
, 
mùl
);

683 ià(
”r
 < 0)

684  
”r
;

685 
	`mem£t
(
v
, 0, 
v_size
);

686 
”r
 = 
´iv
->
chd
->
İs
->
	`–em’t_v
Õriv->chd, 
İ_æag
, 
mùl
->
id_chd
.
numid
, 
v
, 
v_size
);

687 ià(
”r
 < 0)

688  
”r
;

689 
v2
 = 
	`m®loc
(
v_size
);

690 ià(
v2
 =ğ
NULL
)

691  -
ENOMEM
;

692 
™em
 = 1; i‹m < 
m­
->
cÚŒŞs_™ems
; item++) {

693 
mùl
 = &
m­
->
cÚŒŞs
[
™em
];

694 
”r
 = 
	`»m­_g‘_m­_numid
(
´iv
, 
mùl
);

695 ià(
”r
 < 0) {

696 
	`ä“
(
v2
);

697  
”r
;

699 
	`mem£t
(
v2
, 0, 
v_size
);

700 
”r
 = 
´iv
->
chd
->
İs
->
	`–em’t_v
Õriv->chd, 
İ_æag
, 
mùl
->
id_chd
.
numid
, 
v2
, 
v_size
);

701 ià(
”r
 < 0) {

702 
	`ä“
(
v2
);

703  
”r
;

705 ià(
	`memcmp
(
v
, 
v2
, 
v_size
) != 0) {

706 
	`ä“
(
v2
);

707  -
EIO
;

710 
	`ä“
(
v2
);

712 
	}
}

714 
	$¢d_ùl_»m­_–em_v
(
¢d_ùl_t
 *
ùl
, 
İ_æag
,

715 
numid
,

716 *
v
, 
v_size
)

718 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

719 
¢d_ùl_numid_t
 *
m­_numid
;

720 
”r
;

722 
	`debug
("%s:‚umid = %d, op_æag = %d\n", 
__func__
, 
numid
, 
İ_æag
);

723 
”r
 = 
	`»m­_m­_–em_v
(
´iv
, 
İ_æag
, 
numid
, 
v
, 
v_size
);

724 ià(
”r
 !ğ-
EREMAPNOTFOUND
)

725  
”r
;

726 
m­_numid
 = 
	`»m­_fšd_numid_­p
(
´iv
, 
numid
);

727 ià(
m­_numid
 =ğ
NULL
)

728  -
ENOENT
;

729  
´iv
->
chd
->
İs
->
	`–em’t_v
Õriv->chd, 
İ_æag
, 
m­_numid
->
numid_chd
, 
v
, 
v_size
);

730 
	}
}

732 
	$¢d_ùl_»m­_hwd•_Ãxt_deviû
(
¢d_ùl_t
 *
ùl
, * 
deviû
)

734 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

735  
	`¢d_ùl_hwd•_Ãxt_deviû
(
´iv
->
chd
, 
deviû
);

736 
	}
}

738 
	$¢d_ùl_»m­_hwd•_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_hwd•_šfo_t
 * 
šfo
)

740 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

741  
	`¢d_ùl_hwd•_šfo
(
´iv
->
chd
, 
šfo
);

742 
	}
}

744 
	$¢d_ùl_»m­_pcm_Ãxt_deviû
(
¢d_ùl_t
 *
ùl
, * 
deviû
)

746 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

747  
	`¢d_ùl_pcm_Ãxt_deviû
(
´iv
->
chd
, 
deviû
);

748 
	}
}

750 
	$¢d_ùl_»m­_pcm_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_pcm_šfo_t
 * 
šfo
)

752 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

753  
	`¢d_ùl_pcm_šfo
(
´iv
->
chd
, 
šfo
);

754 
	}
}

756 
	$¢d_ùl_»m­_pcm_´eãr_subdeviû
(
¢d_ùl_t
 *
ùl
, 
subdev
)

758 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

759  
	`¢d_ùl_pcm_´eãr_subdeviû
(
´iv
->
chd
, 
subdev
);

760 
	}
}

762 
	$¢d_ùl_»m­_¿wmidi_Ãxt_deviû
(
¢d_ùl_t
 *
ùl
, * 
deviû
)

764 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

765  
	`¢d_ùl_¿wmidi_Ãxt_deviû
(
´iv
->
chd
, 
deviû
);

766 
	}
}

768 
	$¢d_ùl_»m­_¿wmidi_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_¿wmidi_šfo_t
 * 
šfo
)

770 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

771  
	`¢d_ùl_¿wmidi_šfo
(
´iv
->
chd
, 
šfo
);

772 
	}
}

774 
	$¢d_ùl_»m­_¿wmidi_´eãr_subdeviû
(
¢d_ùl_t
 *
ùl
, 
subdev
)

776 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

777  
	`¢d_ùl_¿wmidi_´eãr_subdeviû
(
´iv
->
chd
, 
subdev
);

778 
	}
}

780 
	$¢d_ùl_»m­_£t_pow”_¡©e
(
¢d_ùl_t
 *
ùl
, 
¡©e
)

782 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

783  
	`¢d_ùl_£t_pow”_¡©e
(
´iv
->
chd
, 
¡©e
);

784 
	}
}

786 
	$¢d_ùl_»m­_g‘_pow”_¡©e
(
¢d_ùl_t
 *
ùl
, *
¡©e
)

788 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

789  
	`¢d_ùl_g‘_pow”_¡©e
(
´iv
->
chd
, 
¡©e
);

790 
	}
}

792 
	$_Ãxt_±r
(
size_t
 *
±r
, size_ˆ
couÁ
)

794 *
±r
 = (*±¸+ 1è% 
couÁ
;

795 
	}
}

797 
	$»m­_ev’t_fÜ_®l_m­_cÚŒŞs
(
¢d_ùl_»m­_t
 *
´iv
,

798 
¢d_ùl_–em_id_t
 *
id
,

799 
ev’t_mask
)

801 
size_t
 
couÁ
, 
šdex
, 
h—d
;

802 
¢d_ùl_m­_t
 *
m­
;

803 
¢d_ùl_m­_ùl
 *
mùl
;

804 
found
;

806 ià(
ev’t_mask
 =ğ
SNDRV_CTL_EVENT_MASK_REMOVE
)

807 
ev’t_mask
 = 
SNDRV_CTL_EVENT_MASK_INFO
;

808 
m­
 = 
´iv
->map;

809 
couÁ
 = 
´iv
->
m­_™ems
; couÁ > 0; couÁ--, 
m­
++) {

810 
šdex
 = 0; index < 
m­
->
cÚŒŞs_™ems
; index++) {

811 
mùl
 = &
m­
->
cÚŒŞs
[
šdex
];

812 ià(
mùl
->
id_chd
.
numid
 == 0) {

813 ià(
	`¢d_ùl_–em_id_com·»_£t
(
id
, &
mùl
->
id_chd
))

815 
mùl
->
id_chd
.
numid
 = 
id
->numid;

817 ià(
id
->
numid
 !ğ
mùl
->
id_chd
.numid)

819 
	`debug_id
(&
m­
->
m­_id
, "% found (®l)\n", 
__func__
);

820 
m­
->
ev’t_mask
 |=ƒvent_mask;

821 
found
 = 0;

822 
h—d
 = 
´iv
->
m­_»ad_queue_h—d
;

823 
h—d
 !ğ
´iv
->
m­_»ad_queue_
;

824 
	`_Ãxt_±r
(&
h—d
, 
´iv
->
m­_™ems
))

825 ià(
´iv
->
m­_»ad_queue
[
h—d
] =ğ
m­
) {

826 
found
 = 1;

829 ià(
found
)

831 
	`debug_id
(&
m­
->
m­_id
, "% m¬kšg fÜ„—d\n", 
__func__
);

832 
´iv
->
m­_»ad_queue
[´iv->
m­_»ad_queue_
] = 
m­
;

833 
	`_Ãxt_±r
(&
´iv
->
m­_»ad_queue_
,…riv->
m­_™ems
);

836 
	}
}

838 
	$¢d_ùl_»m­_»ad
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_ev’t_t
 *
ev’t
)

840 
¢d_ùl_»m­_t
 *
´iv
 = 
ùl
->
´iv©e_d©a
;

841 
¢d_ùl_»m­_id_t
 *
rid
;

842 
¢d_ùl_numid_t
 *
numid
;

843 
¢d_ùl_m­_t
 *
m­
;

844 
”r
;

846 ià(
´iv
->
m­_»ad_queue_h—d
 !ğ´iv->
m­_»ad_queue_
) {

847 
m­
 = 
´iv
->
m­_»ad_queue
[´iv->
m­_»ad_queue_h—d
];

848 
	`_Ãxt_±r
(&
´iv
->
m­_»ad_queue_h—d
,…riv->
m­_™ems
);

849 
	`mem£t
(
ev’t
, 0, (*event));

850 
ev’t
->
ty³
 = 
SNDRV_CTL_EVENT_ELEM
;

851 
ev’t
->
d©a
.
–em
.
mask
 = 
m­
->
ev’t_mask
;

852 
ev’t
->
d©a
.
–em
.
id
 = 
m­
->
m­_id
;

853 
m­
->
ev’t_mask
 = 0;

854 
	`debug_id
(&
m­
->
m­_id
, "% queu»ad\n", 
__func__
);

857 
”r
 = 
	`¢d_ùl_»ad
(
´iv
->
chd
, 
ev’t
);

858 ià(
”r
 < 0 || 
ev’t
->
ty³
 !ğ
SNDRV_CTL_EVENT_ELEM
)

859  
”r
;

860 ià(
ev’t
->
d©a
.
–em
.
mask
 =ğ
SNDRV_CTL_EVENT_MASK_REMOVE
 ||

861 (
ev’t
->
d©a
.
–em
.
mask
 & (
SNDRV_CTL_EVENT_MASK_VALUE
 | 
SNDRV_CTL_EVENT_MASK_INFO
 |

862 
SNDRV_CTL_EVENT_MASK_ADD
 | 
SNDRV_CTL_EVENT_MASK_TLV
)) != 0) {

863 
	`debug_id
(&
ev’t
->
d©a
.
–em
.
id
, "% ev’ˆmask 0x%x\n", 
__func__
,ƒv’t->d©a.–em.
mask
);

864 
	`»m­_ev’t_fÜ_®l_m­_cÚŒŞs
(
´iv
, &
ev’t
->
d©a
.
–em
.
id
,ƒv’t->d©a.–em.
mask
);

865 
rid
 = 
	`»m­_fšd_id_chd
(
´iv
, &
ev’t
->
d©a
.
–em
.
id
);

866 ià(
rid
) {

867 ià(
rid
->
id_chd
.
numid
 == 0) {

868 
numid
 = 
	`»m­_fšd_numid_chd
(
´iv
, 
ev’t
->
d©a
.
–em
.
id
.numid);

869 ià(
numid
 =ğ
NULL
)

870  -
EIO
;

871 
rid
->
id_chd
.
numid
 =‚umid->
numid_chd
;

872 
rid
->
id_­p
.
numid
 =‚umid->
numid_­p
;

874 
ev’t
->
d©a
.
–em
.
id
 = 
rid
->
id_­p
;

876 
numid
 = 
	`»m­_fšd_numid_chd
(
´iv
, 
ev’t
->
d©a
.
–em
.
id
.numid);

877 ià(
numid
 =ğ
NULL
)

878  -
EIO
;

879 
ev’t
->
d©a
.
–em
.
id
.
numid
 =‚umid->
numid_­p
;

882  
”r
;

883 
	}
}

885 cÚ¡ 
¢d_ùl_İs_t
 
	g¢d_ùl_»m­_İs
 = {

886 .
şo£
 = 
¢d_ùl_»m­_şo£
,

887 .
	gnÚblock
 = 
¢d_ùl_»m­_nÚblock
,

888 .
	gasync
 = 
¢d_ùl_»m­_async
,

889 .
	gsubsüibe_ev’ts
 = 
¢d_ùl_»m­_subsüibe_ev’ts
,

890 .
	gÿrd_šfo
 = 
¢d_ùl_»m­_ÿrd_šfo
,

891 .
	g–em’t_li¡
 = 
¢d_ùl_»m­_–em_li¡
,

892 .
	g–em’t_šfo
 = 
¢d_ùl_»m­_–em_šfo
,

893 .
	g–em’t_»ad
 = 
¢d_ùl_»m­_–em_»ad
,

894 .
	g–em’t_wr™e
 = 
¢d_ùl_»m­_–em_wr™e
,

895 .
	g–em’t_lock
 = 
¢d_ùl_»m­_–em_lock
,

896 .
	g–em’t_uÆock
 = 
¢d_ùl_»m­_–em_uÆock
,

897 .
	g–em’t_v
 = 
¢d_ùl_»m­_–em_v
,

898 .
	ghwd•_Ãxt_deviû
 = 
¢d_ùl_»m­_hwd•_Ãxt_deviû
,

899 .
	ghwd•_šfo
 = 
¢d_ùl_»m­_hwd•_šfo
,

900 .
	gpcm_Ãxt_deviû
 = 
¢d_ùl_»m­_pcm_Ãxt_deviû
,

901 .
	gpcm_šfo
 = 
¢d_ùl_»m­_pcm_šfo
,

902 .
	gpcm_´eãr_subdeviû
 = 
¢d_ùl_»m­_pcm_´eãr_subdeviû
,

903 .
	g¿wmidi_Ãxt_deviû
 = 
¢d_ùl_»m­_¿wmidi_Ãxt_deviû
,

904 .
	g¿wmidi_šfo
 = 
¢d_ùl_»m­_¿wmidi_šfo
,

905 .
	g¿wmidi_´eãr_subdeviû
 = 
¢d_ùl_»m­_¿wmidi_´eãr_subdeviû
,

906 .
	g£t_pow”_¡©e
 = 
¢d_ùl_»m­_£t_pow”_¡©e
,

907 .
	gg‘_pow”_¡©e
 = 
¢d_ùl_»m­_g‘_pow”_¡©e
,

908 .
	g»ad
 = 
¢d_ùl_»m­_»ad
,

911 
	$add_to_»m­
(
¢d_ùl_»m­_t
 *
´iv
,

912 
¢d_ùl_–em_id_t
 *
chd
,

913 
¢d_ùl_–em_id_t
 *
­p
)

915 
¢d_ùl_»m­_id_t
 *
rid
;

917 ià(
´iv
->
»m­_®loc
 =ğ´iv->
»m­_™ems
) {

918 
rid
 = 
	`»®loc
(
´iv
->
»m­
, (´iv->
»m­_®loc
 + 16) * (*rid));

919 ià(
rid
 =ğ
NULL
)

920  -
ENOMEM
;

921 
	`mem£t
(
rid
 + 
´iv
->
»m­_®loc
, 0, (*rid) * 16);

922 
´iv
->
»m­_®loc
 += 16;

923 
´iv
->
»m­
 = 
rid
;

925 
rid
 = &
´iv
->
»m­
[´iv->
»m­_™ems
++];

926 
rid
->
id_chd
 = *
chd
;

927 
rid
->
id_­p
 = *
­p
;

928 
	`debug_id
(&
rid
->
id_chd
, "% »m­ chd\n", 
__func__
);

929 
	`debug_id
(&
rid
->
id_­p
, "% »m­‡µ\n", 
__func__
);

931 
	}
}

933 
	$·r£_»m­
(
¢d_ùl_»m­_t
 *
´iv
, 
¢d_cÚfig_t
 *
cÚf
)

935 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

936 
¢d_ùl_–em_id_t
 
chd
, 
­p
;

937 
”r
;

939 ià(
cÚf
 =ğ
NULL
)

941 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

942 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

943 cÚ¡ *
id
, *
¡r
;

944 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

946 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
) < 0) {

947 
	`SNDERR
("expected string withhearget control id!");

948  -
EINVAL
;

950 
	`¢d_ùl_–em_id_ş—r
(&
­p
);

951 
”r
 = 
	`¢d_ùl_ascii_–em_id_·r£
(&
­p
, 
¡r
);

952 ià(
”r
 < 0) {

953 
	`SNDERR
("uÇbËØ·r£¬g‘ id '%s'!", 
¡r
);

954  -
EINVAL
;

956 ià(
	`»m­_fšd_id_­p
(
´iv
, &
­p
)) {

957 
	`SNDERR
("du¶iÿ‹¬g‘ id '%s'!", 
id
);

958  -
EINVAL
;

960 
	`¢d_ùl_–em_id_ş—r
(&
chd
);

961 
”r
 = 
	`¢d_ùl_ascii_–em_id_·r£
(&
chd
, 
id
);

962 ià(
”r
 < 0) {

963 
	`SNDERR
("uÇbËØ·r£ sourû id '%s'!", 
id
);

964  -
EINVAL
;

966 ià(
	`»m­_fšd_id_chd
(
´iv
, &
­p
)) {

967 
	`SNDERR
("du¶iÿ‹ sourû id '%s'!", 
id
);

968  -
EINVAL
;

970 
”r
 = 
	`add_to_»m­
(
´iv
, &
chd
, &
­p
);

971 ià(
”r
 < 0)

972  
”r
;

976 
	}
}

978 
	$Ãw_m­
(
¢d_ùl_»m­_t
 *
´iv
, 
¢d_ùl_m­_t
 **
_m­
, 
¢d_ùl_–em_id_t
 *
id
)

980 
¢d_ùl_m­_t
 *
m­
;

981 
¢d_ùl_numid_t
 *
numid
;

983 ià(
´iv
->
m­_®loc
 =ğ´iv->
m­_™ems
) {

984 
m­
 = 
	`»®loc
(
´iv
->m­, (´iv->
m­_®loc
 + 16) * (*map));

985 ià(
m­
 =ğ
NULL
)

986  -
ENOMEM
;

987 
	`mem£t
(
m­
 + 
´iv
->
m­_®loc
, 0, (*map) * 16);

988 
´iv
->
m­_®loc
 += 16;

989 
´iv
->
m­
 = map;

991 
m­
 = &
´iv
->m­[´iv->
m­_™ems
++];

992 
m­
->
m­_id
 = *
id
;

993 
numid
 = 
	`»m­_numid_Ãw
(
´iv
, 0, ++´iv->
numid_­p_Ï¡
);

994 ià(
numid
 =ğ
NULL
)

995  -
ENOMEM
;

996 
m­
->
m­_id
.
numid
 =‚umid->
numid_­p
;

997 
	`debug_id
(&
m­
->
m­_id
, "% ü—‹d\n", 
__func__
);

998 *
_m­
 = 
m­
;

1000 
	}
}

1002 
	$add_ùl_to_m­
(
¢d_ùl_m­_t
 *
m­
, 
¢d_ùl_m­_ùl
 **
_mùl
, 
¢d_ùl_–em_id_t
 *
id
)

1004 
¢d_ùl_m­_ùl
 *
mùl
;

1006 ià(
m­
->
cÚŒŞs_®loc
 =ğm­->
cÚŒŞs_™ems
) {

1007 
mùl
 = 
	`»®loc
(
m­
->
cÚŒŞs
, (m­->
cÚŒŞs_®loc
 + 4) * (*mctl));

1008 ià(
mùl
 =ğ
NULL
)

1009  -
ENOMEM
;

1010 
	`mem£t
(
mùl
 + 
m­
->
cÚŒŞs_®loc
, 0, (*mctl) * 4);

1011 
m­
->
cÚŒŞs_®loc
 += 4;

1012 
m­
->
cÚŒŞs
 = 
mùl
;

1014 
mùl
 = &
m­
->
cÚŒŞs
[m­->
cÚŒŞs_™ems
++];

1015 
mùl
->
id_chd
 = *
id
;

1016 *
_mùl
 = 
mùl
;

1018 
	}
}

1020 
	$add_chn_to_m­
(
¢d_ùl_m­_ùl
 *
mùl
, 
idx
, 
v®
)

1022 
size_t
 
off
;

1023 *
m­
;

1025 ià(
mùl
->
chªÃl_m­_®loc
 <ğ(
size_t
)
idx
) {

1026 
m­
 = 
	`»®loc
(
mùl
->
chªÃl_m­
, (
idx
 + 4) * (*map));

1027 ià(
m­
 =ğ
NULL
)

1028  -
ENOMEM
;

1029 
mùl
->
chªÃl_m­
 = 
m­
;

1030 
off
 = 
mùl
->
chªÃl_m­_®loc
;

1031 
mùl
->
chªÃl_m­_®loc
 = 
idx
 + 4;

1032  ; 
off
 < 
mùl
->
chªÃl_m­_®loc
; off++)

1033 
m­
[
off
] = -1;

1035 ià((
size_t
)
idx
 >ğ
mùl
->
chªÃl_m­_™ems
)

1036 
mùl
->
chªÃl_m­_™ems
 = 
idx
 + 1;

1037 
mùl
->
chªÃl_m­
[
idx
] = 
v®
;

1039 
	}
}

1041 
	$·r£_m­_všdex
(
¢d_ùl_m­_ùl
 *
mùl
, 
¢d_cÚfig_t
 *
cÚf
)

1043 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1044 
”r
;

1046 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1047 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1048 
idx
 = -1, 
chn
 = -1;

1049 cÚ¡ *
id
;

1050 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1052 ià(
	`§ã_¡¹Ş
(
id
, &
idx
è|| 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
chn
)) {

1053 
	`SNDERR
("WrÚg chªÃÈm­pšg (%ld -> %ld)", 
idx
, 
chn
);

1054  -
EINVAL
;

1056 
”r
 = 
	`add_chn_to_m­
(
mùl
, 
idx
, 
chn
);

1057 ià(
”r
 < 0)

1058  
”r
;

1062 
	}
}

1064 
	$·r£_m­_cÚfig
(
¢d_ùl_m­_ùl
 *
mùl
, 
¢d_cÚfig_t
 *
cÚf
)

1066 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1067 
”r
;

1069 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1070 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1071 cÚ¡ *
id
;

1072 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1074 ià(
	`¡rcmp
(
id
, "vindex") == 0) {

1075 
”r
 = 
	`·r£_m­_všdex
(
mùl
, 
n
);

1076 ià(
”r
 < 0)

1077  
”r
;

1081 
	}
}

1083 
	$·r£_m­1
(
¢d_ùl_m­_t
 *
m­
, 
¢d_cÚfig_t
 *
cÚf
)

1085 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1086 
¢d_ùl_–em_id_t
 
cid
;

1087 
¢d_ùl_m­_ùl
 *
mùl
;

1088 
”r
;

1090 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1091 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1092 cÚ¡ *
id
;

1093 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1095 
	`¢d_ùl_–em_id_ş—r
(&
cid
);

1096 
”r
 = 
	`¢d_ùl_ascii_–em_id_·r£
(&
cid
, 
id
);

1097 ià(
”r
 < 0) {

1098 
	`SNDERR
("uÇbËØ·r£ cÚŒŞ id '%s'!", 
id
);

1099  -
EINVAL
;

1101 
”r
 = 
	`add_ùl_to_m­
(
m­
, &
mùl
, &
cid
);

1102 ià(
”r
 < 0)

1103  
”r
;

1104 
”r
 = 
	`·r£_m­_cÚfig
(
mùl
, 
n
);

1105 ià(
”r
 < 0)

1106  
”r
;

1110 
	}
}

1112 
	$·r£_m­
(
¢d_ùl_»m­_t
 *
´iv
, 
¢d_cÚfig_t
 *
cÚf
)

1114 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1115 
¢d_ùl_–em_id_t
 
eid
;

1116 
¢d_ùl_m­_t
 *
m­
;

1117 
”r
;

1119 ià(
cÚf
 =ğ
NULL
)

1121 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1122 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1123 cÚ¡ *
id
;

1124 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1126 
	`¢d_ùl_–em_id_ş—r
(&
eid
);

1127 
”r
 = 
	`¢d_ùl_ascii_–em_id_·r£
(&
eid
, 
id
);

1128 ià(
”r
 < 0) {

1129 
	`SNDERR
("uÇbËØ·r£ id '%s'!", 
id
);

1130  -
EINVAL
;

1132 
”r
 = 
	`Ãw_m­
(
´iv
, &
m­
, &
eid
);

1133 ià(
”r
 < 0)

1135 
”r
 = 
	`·r£_m­1
(
m­
, 
n
);

1136 ià(
”r
 < 0)

1137  
”r
;

1141 
	}
}

1156 
	$¢d_ùl_»m­_İ’
(
¢d_ùl_t
 **
hªdËp
, cÚ¡ *
Çme
, 
¢d_cÚfig_t
 *
»m­
,

1157 
¢d_cÚfig_t
 *
m­
, 
¢d_ùl_t
 *
chd
, 
mode
)

1159 
¢d_ùl_»m­_t
 *
´iv
;

1160 
¢d_ùl_t
 *
ùl
;

1161 
»suÉ
, 
”r
;

1164 ià(!
»m­
 && !
m­
)

1165 
_noİ
;

1167 
´iv
 = 
	`ÿÎoc
(1, (*priv));

1168 ià(
´iv
 =ğ
NULL
)

1169  -
ENOMEM
;

1171 
”r
 = 
	`·r£_»m­
(
´iv
, 
»m­
);

1172 ià(
”r
 < 0) {

1173 
»suÉ
 = 
”r
;

1174 
_”r
;

1177 
”r
 = 
	`·r£_m­
(
´iv
, 
m­
);

1178 ià(
”r
 < 0) {

1179 
»suÉ
 = 
”r
;

1180 
_”r
;

1184 ià(
´iv
->
m­_™ems
 =ğ0 &&…riv->
»m­_™ems
 == 0) {

1185 
	`»m­_ä“
(
´iv
);

1186 
_noİ
:

1187 
	`ä“
(
chd
->
Çme
);

1188 
chd
->
Çme
 =‚am? 
	`¡rdup
Òameè: 
NULL
;

1189 ià(
Çme
 && !
chd
->name)

1190  -
ENOMEM
;

1191 *
hªdËp
 = 
chd
;

1195 
´iv
->
m­_»ad_queue
 = 
	`ÿÎoc
Õriv->
m­_™ems
, (priv->map_read_queue[0]));

1196 ià(
´iv
->
m­_»ad_queue
 =ğ
NULL
) {

1197 
»suÉ
 = -
ENOMEM
;

1198 
_”r
;

1201 
´iv
->
numid_»m­_aùive
 =…riv->
m­_™ems
 > 0;

1203 
´iv
->
chd
 = child;

1204 
”r
 = 
	`¢d_ùl_Ãw
(&
ùl
, 
SND_CTL_TYPE_REMAP
, 
Çme
, 
mode
);

1205 ià(
”r
 < 0) {

1206 
»suÉ
 = 
”r
;

1207 
_”r
;

1209 
ùl
->
İs
 = &
¢d_ùl_»m­_İs
;

1210 
ùl
->
´iv©e_d©a
 = 
´iv
;

1211 
ùl
->
pŞl_fd
 = 
chd
->poll_fd;

1213 *
hªdËp
 = 
ùl
;

1216 
_”r
:

1217 
	`»m­_ä“
(
´iv
);

1218  
»suÉ
;

1219 
	}
}

1292 
	$_¢d_ùl_»m­_İ’
(
¢d_ùl_t
 **
hªdËp
, *
Çme
, 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
, 
mode
)

1294 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1295 
¢d_cÚfig_t
 *
chd
 = 
NULL
;

1296 
¢d_cÚfig_t
 *
»m­
 = 
NULL
;

1297 
¢d_cÚfig_t
 *
m­
 = 
NULL
;

1298 
¢d_ùl_t
 *
cùl
;

1299 
”r
;

1301 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1302 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1303 cÚ¡ *
id
;

1304 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1306 ià(
	`_¢d_cÚf_g’”ic_id
(
id
))

1308 ià(
	`¡rcmp
(
id
, "remap") == 0) {

1309 
»m­
 = 
n
;

1312 ià(
	`¡rcmp
(
id
, "map") == 0) {

1313 
m­
 = 
n
;

1316 ià(
	`¡rcmp
(
id
, "child") == 0) {

1317 
chd
 = 
n
;

1320 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

1321  -
EINVAL
;

1323 ià(!
chd
) {

1324 
	`SNDERR
("child is‚ot defined");

1325  -
EINVAL
;

1327 
”r
 = 
	`_¢d_ùl_İ’_chd
(&
cùl
, 
roÙ
, 
chd
, 
mode
, 
cÚf
);

1328 ià(
”r
 < 0)

1329  
”r
;

1330 
”r
 = 
	`¢d_ùl_»m­_İ’
(
hªdËp
, 
Çme
, 
»m­
, 
m­
, 
cùl
, 
mode
);

1331 ià(
”r
 < 0)

1332 
	`¢d_ùl_şo£
(
cùl
);

1333  
”r
;

1334 
	}
}

1335 #iâdeà
DOC_HIDDEN


1336 
SND_DLSYM_BUILD_VERSION
(
_¢d_ùl_»m­_İ’
, 
SND_CONTROL_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_shm.c

22 
	~<¡dio.h
>

23 
	~<¡dlib.h
>

24 
	~<¡ddef.h
>

25 
	~<uni¡d.h
>

26 
	~<¡ršg.h
>

27 
	~<fú.h
>

28 
	~<sys/shm.h
>

29 
	~<sys/sock‘.h
>

30 
	~<pŞl.h
>

31 
	~<sys/un.h
>

32 
	~<sys/uio.h
>

33 
	~<sys/mmª.h
>

34 
	~<Ãtš‘/š.h
>

35 
	~<Ãtdb.h
>

36 
	~"a£rv”.h
"

38 #iâdeà
PIC


40 cÚ¡ *
	g_¢d_moduË_cÚŒŞ_shm
 = "";

43 #iâdeà
DOC_HIDDEN


45 
	msock‘
;

46 vŞ©
¢d_ùl_shm_ù¾_t
 *
	mù¾
;

47 } 
	t¢d_ùl_shm_t
;

50 
	$¢d_ùl_shm_aùiÚ
(
¢d_ùl_t
 *
ùl
)

52 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

53 
”r
;

54 
buf
[1] = {0};

55 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

56 
”r
 = 
	`wr™e
(
shm
->
sock‘
, 
buf
, 1);

57 ià(
”r
 != 1)

58  -
EBADFD
;

59 
”r
 = 
	`»ad
(
shm
->
sock‘
, 
buf
, 1);

60 ià(
”r
 != 1)

61  -
EBADFD
;

62 ià(
ù¾
->
cmd
) {

63 
	`SNDERR
("Server has‚ot donehe cmd");

64  -
EBADFD
;

66  
ù¾
->
»suÉ
;

67 
	}
}

69 
	$¢d_ùl_shm_aùiÚ_fd
(
¢d_ùl_t
 *
ùl
, *
fd
)

71 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

72 
”r
;

73 
buf
[1];

74 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

75 
”r
 = 
	`wr™e
(
shm
->
sock‘
, 
buf
, 1);

76 ià(
”r
 != 1)

77  -
EBADFD
;

78 
”r
 = 
	`¢d_»ûive_fd
(
shm
->
sock‘
, 
buf
, 1, 
fd
);

79 ià(
”r
 != 1)

80  -
EBADFD
;

81 ià(
ù¾
->
cmd
) {

82 
	`SNDERR
("Server has‚ot donehe cmd");

83  -
EBADFD
;

85  
ù¾
->
»suÉ
;

86 
	}
}

88 
	$¢d_ùl_shm_şo£
(
¢d_ùl_t
 *
ùl
)

90 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

91 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

92 
»suÉ
;

93 
ù¾
->
cmd
 = 
SND_CTL_IOCTL_CLOSE
;

94 
»suÉ
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

95 
	`shmdt
((*)
ù¾
);

96 
	`şo£
(
shm
->
sock‘
);

97 
	`ä“
(
shm
);

98  
»suÉ
;

99 
	}
}

101 
	$¢d_ùl_shm_nÚblock
(
¢d_ùl_t
 *
hªdË
 
ATTRIBUTE_UNUSED
, 
nÚblock
 ATTRIBUTE_UNUSED)

104 
	}
}

106 
	$¢d_ùl_shm_async
(
¢d_ùl_t
 *
ùl
, 
sig
, 
pid_t
 
pid
)

108 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

109 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

110 
ù¾
->
cmd
 = 
SND_CTL_IOCTL_ASYNC
;

111 
ù¾
->
u
.
async
.
sig
 = sig;

112 ià(
pid
 == 0)

113 
pid
 = 
	`g‘pid
();

114 
ù¾
->
u
.
async
.
pid
 =…id;

115  
	`¢d_ùl_shm_aùiÚ
(
ùl
);

116 
	}
}

118 
	$¢d_ùl_shm_pŞl_desütÜ
(
¢d_ùl_t
 *
ùl
)

120 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

121 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

122 
fd
, 
”r
;

123 
ù¾
->
cmd
 = 
SND_CTL_IOCTL_POLL_DESCRIPTOR
;

124 
”r
 = 
	`¢d_ùl_shm_aùiÚ_fd
(
ùl
, &
fd
);

125 ià(
”r
 < 0)

126  
”r
;

127  
fd
;

128 
	}
}

130 
	$¢d_ùl_shm_subsüibe_ev’ts
(
¢d_ùl_t
 *
ùl
, 
subsüibe
)

132 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

133 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

134 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_SUBSCRIBE_EVENTS
;

135 
ù¾
->
u
.
subsüibe_ev’ts
 = 
subsüibe
;

136  
	`¢d_ùl_shm_aùiÚ
(
ùl
);

137 
	}
}

139 
	$¢d_ùl_shm_ÿrd_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_ÿrd_šfo_t
 *
šfo
)

141 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

142 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

143 
”r
;

145 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_CARD_INFO
;

146 
”r
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

147 ià(
”r
 < 0)

148  
”r
;

149 *
šfo
 = 
ù¾
->
u
.
ÿrd_šfo
;

150  
”r
;

151 
	}
}

153 
	$¢d_ùl_shm_–em_li¡
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_li¡_t
 *
li¡
)

155 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

156 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

157 
size_t
 
maxsize
 = 
CTL_SHM_DATA_MAXLEN
;

158 
size_t
 
by‹s
 = 
li¡
->
¥aû
 * (*li¡->
pids
);

159 
”r
;

160 
¢d_ùl_–em_id_t
 *
pids
 = 
li¡
->pids;

161 ià(
by‹s
 > 
maxsize
)

162  -
EINVAL
;

163 
ù¾
->
u
.
–em’t_li¡
 = *
li¡
;

164 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_ELEM_LIST
;

165 
”r
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

166 ià(
”r
 < 0)

167  
”r
;

168 *
li¡
 = 
ù¾
->
u
.
–em’t_li¡
;

169 
li¡
->
pids
 =…ids;

170 
by‹s
 = 
li¡
->
u£d
 * (*li¡->
pids
);

171 
	`memıy
(
pids
, (*)
ù¾
->
d©a
, 
by‹s
);

172  
”r
;

173 
	}
}

175 
	$¢d_ùl_shm_–em_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_šfo_t
 *
šfo
)

177 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

178 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

179 
”r
;

180 
ù¾
->
u
.
–em’t_šfo
 = *
šfo
;

181 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_ELEM_INFO
;

182 
”r
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

183 ià(
”r
 < 0)

184  
”r
;

185 *
šfo
 = 
ù¾
->
u
.
–em’t_šfo
;

186  
”r
;

187 
	}
}

189 
	$¢d_ùl_shm_–em_»ad
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_v®ue_t
 *
cÚŒŞ
)

191 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

192 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

193 
”r
;

194 
ù¾
->
u
.
–em’t_»ad
 = *
cÚŒŞ
;

195 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_ELEM_READ
;

196 
”r
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

197 ià(
”r
 < 0)

198  
”r
;

199 *
cÚŒŞ
 = 
ù¾
->
u
.
–em’t_»ad
;

200  
”r
;

201 
	}
}

203 
	$¢d_ùl_shm_–em_wr™e
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_v®ue_t
 *
cÚŒŞ
)

205 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

206 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

207 
”r
;

208 
ù¾
->
u
.
–em’t_wr™e
 = *
cÚŒŞ
;

209 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_ELEM_WRITE
;

210 
”r
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

211 ià(
”r
 < 0)

212  
”r
;

213 *
cÚŒŞ
 = 
ù¾
->
u
.
–em’t_wr™e
;

214  
”r
;

215 
	}
}

217 
	$¢d_ùl_shm_–em_lock
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_id_t
 *
id
)

219 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

220 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

221 
”r
;

222 
ù¾
->
u
.
–em’t_lock
 = *
id
;

223 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_ELEM_LOCK
;

224 
”r
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

225 ià(
”r
 < 0)

226  
”r
;

227 *
id
 = 
ù¾
->
u
.
–em’t_lock
;

228  
”r
;

229 
	}
}

231 
	$¢d_ùl_shm_–em_uÆock
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_–em_id_t
 *
id
)

233 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

234 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

235 
”r
;

236 
ù¾
->
u
.
–em’t_uÆock
 = *
id
;

237 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_ELEM_UNLOCK
;

238 
”r
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

239 ià(
”r
 < 0)

240  
”r
;

241 *
id
 = 
ù¾
->
u
.
–em’t_uÆock
;

242  
”r
;

243 
	}
}

245 
	$¢d_ùl_shm_hwd•_Ãxt_deviû
(
¢d_ùl_t
 *
ùl
, * 
deviû
)

247 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

248 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

249 
”r
;

250 
ù¾
->
u
.
deviû
 = *device;

251 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_HWDEP_NEXT_DEVICE
;

252 
”r
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

253 ià(
”r
 < 0)

254  
”r
;

255 *
deviû
 = 
ù¾
->
u
.device;

256  
”r
;

257 
	}
}

259 
	$¢d_ùl_shm_hwd•_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_hwd•_šfo_t
 * 
šfo
)

261 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

262 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

263 
”r
;

264 
ù¾
->
u
.
hwd•_šfo
 = *
šfo
;

265 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_HWDEP_INFO
;

266 
”r
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

267 ià(
”r
 < 0)

268  
”r
;

269 *
šfo
 = 
ù¾
->
u
.
hwd•_šfo
;

270  
”r
;

271 
	}
}

273 
	$¢d_ùl_shm_pcm_Ãxt_deviû
(
¢d_ùl_t
 *
ùl
, * 
deviû
)

275 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

276 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

277 
”r
;

278 
ù¾
->
u
.
deviû
 = *device;

279 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_PCM_NEXT_DEVICE
;

280 
”r
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

281 ià(
”r
 < 0)

282  
”r
;

283 *
deviû
 = 
ù¾
->
u
.device;

284  
”r
;

285 
	}
}

287 
	$¢d_ùl_shm_pcm_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_pcm_šfo_t
 * 
šfo
)

289 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

290 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

291 
”r
;

292 
ù¾
->
u
.
pcm_šfo
 = *
šfo
;

293 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_PCM_INFO
;

294 
”r
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

295 ià(
”r
 < 0)

296  
”r
;

297 *
šfo
 = 
ù¾
->
u
.
pcm_šfo
;

298  
”r
;

299 
	}
}

301 
	$¢d_ùl_shm_pcm_´eãr_subdeviû
(
¢d_ùl_t
 *
ùl
, 
subdev
)

303 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

304 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

305 
ù¾
->
u
.
pcm_´eãr_subdeviû
 = 
subdev
;

306 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_PCM_PREFER_SUBDEVICE
;

307  
	`¢d_ùl_shm_aùiÚ
(
ùl
);

308 
	}
}

310 
	$¢d_ùl_shm_¿wmidi_Ãxt_deviû
(
¢d_ùl_t
 *
ùl
, * 
deviû
)

312 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

313 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

314 
”r
;

315 
ù¾
->
u
.
deviû
 = *device;

316 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_RAWMIDI_NEXT_DEVICE
;

317 
”r
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

318 ià(
”r
 < 0)

319  
”r
;

320 *
deviû
 = 
ù¾
->
u
.device;

321  
”r
;

322 
	}
}

324 
	$¢d_ùl_shm_¿wmidi_šfo
(
¢d_ùl_t
 *
ùl
, 
¢d_¿wmidi_šfo_t
 * 
šfo
)

326 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

327 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

328 
”r
;

329 
ù¾
->
u
.
¿wmidi_šfo
 = *
šfo
;

330 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_RAWMIDI_INFO
;

331 
”r
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

332 ià(
”r
 < 0)

333  
”r
;

334 *
šfo
 = 
ù¾
->
u
.
¿wmidi_šfo
;

335  
”r
;

336 
	}
}

338 
	$¢d_ùl_shm_¿wmidi_´eãr_subdeviû
(
¢d_ùl_t
 *
ùl
, 
subdev
)

340 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

341 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

342 
ù¾
->
u
.
¿wmidi_´eãr_subdeviû
 = 
subdev
;

343 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_RAWMIDI_PREFER_SUBDEVICE
;

344  
	`¢d_ùl_shm_aùiÚ
(
ùl
);

345 
	}
}

347 
	$¢d_ùl_shm_£t_pow”_¡©e
(
¢d_ùl_t
 *
ùl
, 
¡©e
)

349 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

350 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

351 
ù¾
->
u
.
pow”_¡©e
 = 
¡©e
;

352 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_POWER
;

353  
	`¢d_ùl_shm_aùiÚ
(
ùl
);

354 
	}
}

356 
	$¢d_ùl_shm_g‘_pow”_¡©e
(
¢d_ùl_t
 *
ùl
, *
¡©e
)

358 
¢d_ùl_shm_t
 *
shm
 = 
ùl
->
´iv©e_d©a
;

359 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

360 
”r
;

361 
ù¾
->
cmd
 = 
SNDRV_CTL_IOCTL_POWER_STATE
;

362 
”r
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

363 ià(
”r
 < 0)

364  
”r
;

365 *
¡©e
 = 
ù¾
->
u
.
pow”_¡©e
;

366  
”r
;

367 
	}
}

369 
	$¢d_ùl_shm_»ad
(
¢d_ùl_t
 *
ùl
, 
¢d_ùl_ev’t_t
 *
ev’t
)

371 
¢d_ùl_shm_t
 *
shm
;

372 vŞ©
¢d_ùl_shm_ù¾_t
 *
ù¾
;

373 
”r
;

374 
”r
 = 
	`¢d_ùl_wa™
(
ùl
, -1);

375 ià(
”r
 < 0)

377 
shm
 = 
ùl
->
´iv©e_d©a
;

378 
ù¾
 = 
shm
->ctrl;

379 
ù¾
->
u
.
»ad
 = *
ev’t
;

380 
ù¾
->
cmd
 = 
SND_CTL_IOCTL_READ
;

381 
”r
 = 
	`¢d_ùl_shm_aùiÚ
(
ùl
);

382 ià(
”r
 < 0)

383  
”r
;

384 *
ev’t
 = 
ù¾
->
u
.
»ad
;

385  
”r
;

386 
	}
}

388 cÚ¡ 
¢d_ùl_İs_t
 
	g¢d_ùl_shm_İs
 = {

389 .
şo£
 = 
¢d_ùl_shm_şo£
,

390 .
	gnÚblock
 = 
¢d_ùl_shm_nÚblock
,

391 .
	gasync
 = 
¢d_ùl_shm_async
,

392 .
	gsubsüibe_ev’ts
 = 
¢d_ùl_shm_subsüibe_ev’ts
,

393 .
	gÿrd_šfo
 = 
¢d_ùl_shm_ÿrd_šfo
,

394 .
	g–em’t_li¡
 = 
¢d_ùl_shm_–em_li¡
,

395 .
	g–em’t_šfo
 = 
¢d_ùl_shm_–em_šfo
,

396 .
	g–em’t_»ad
 = 
¢d_ùl_shm_–em_»ad
,

397 .
	g–em’t_wr™e
 = 
¢d_ùl_shm_–em_wr™e
,

398 .
	g–em’t_lock
 = 
¢d_ùl_shm_–em_lock
,

399 .
	g–em’t_uÆock
 = 
¢d_ùl_shm_–em_uÆock
,

400 .
	ghwd•_Ãxt_deviû
 = 
¢d_ùl_shm_hwd•_Ãxt_deviû
,

401 .
	ghwd•_šfo
 = 
¢d_ùl_shm_hwd•_šfo
,

402 .
	gpcm_Ãxt_deviû
 = 
¢d_ùl_shm_pcm_Ãxt_deviû
,

403 .
	gpcm_šfo
 = 
¢d_ùl_shm_pcm_šfo
,

404 .
	gpcm_´eãr_subdeviû
 = 
¢d_ùl_shm_pcm_´eãr_subdeviû
,

405 .
	g¿wmidi_Ãxt_deviû
 = 
¢d_ùl_shm_¿wmidi_Ãxt_deviû
,

406 .
	g¿wmidi_šfo
 = 
¢d_ùl_shm_¿wmidi_šfo
,

407 .
	g¿wmidi_´eãr_subdeviû
 = 
¢d_ùl_shm_¿wmidi_´eãr_subdeviû
,

408 .
	g£t_pow”_¡©e
 = 
¢d_ùl_shm_£t_pow”_¡©e
,

409 .
	gg‘_pow”_¡©e
 = 
¢d_ùl_shm_g‘_pow”_¡©e
,

410 .
	g»ad
 = 
¢d_ùl_shm_»ad
,

413 
	$make_loÿl_sock‘
(cÚ¡ *
f’ame
)

415 
size_t
 
l
 = 
	`¡¾’
(
f’ame
);

416 
size_t
 
size
 = 
	`off£tof
(
sockaddr_un
, 
sun_·th
è+ 
l
;

417 
sockaddr_un
 *
addr
 = 
	`®loÿ
(
size
);

418 
sock
;

420 
sock
 = 
	`sock‘
(
PF_LOCAL
, 
SOCK_STREAM
, 0);

421 ià(
sock
 < 0)

422  -
”ºo
;

424 
addr
->
sun_çmy
 = 
AF_LOCAL
;

425 
	`memıy
(
addr
->
sun_·th
, 
f’ame
, 
l
);

427 ià(
	`cÚÃù
(
sock
, (
sockaddr
 *è
addr
, 
size
) < 0) {

428 
	`şo£
(
sock
);

429  -
”ºo
;

431  
sock
;

432 
	}
}

434 
	$¢d_ùl_shm_İ’
(
¢d_ùl_t
 **
hªdËp
, cÚ¡ *
Çme
, cÚ¡ *
sockÇme
, cÚ¡ *
¢ame
, 
mode
)

436 
¢d_ùl_t
 *
ùl
;

437 
¢d_ùl_shm_t
 *
shm
 = 
NULL
;

438 
¢d_ş›Á_İ’_»que¡_t
 *
»q
;

439 
¢d_ş›Á_İ’_ªsw”_t
 
ªs
;

440 
size_t
 
¢am–’
, 
»qËn
;

441 
”r
;

442 
»suÉ
;

443 
sock
 = -1;

444 
¢d_ùl_shm_ù¾_t
 *
ù¾
 = 
NULL
;

445 
¢am–’
 = 
	`¡¾’
(
¢ame
);

446 ià(
¢am–’
 > 255)

447  -
EINVAL
;

449 
»suÉ
 = 
	`make_loÿl_sock‘
(
sockÇme
);

450 ià(
»suÉ
 < 0) {

451 
	`SNDERR
("£rv” fÜ sock‘ % i nÙ„uÂšg", 
sockÇme
);

452 
_”r
;

454 
sock
 = 
»suÉ
;

456 
»qËn
 = (*
»q
è+ 
¢am–’
;

457 
»q
 = 
	`®loÿ
(
»qËn
);

458 
	`memıy
(
»q
->
Çme
, 
¢ame
, 
¢am–’
);

459 
»q
->
dev_ty³
 = 
SND_DEV_TYPE_CONTROL
;

460 
»q
->
Œª¥Üt_ty³
 = 
SND_TRANSPORT_TYPE_SHM
;

461 
»q
->
¡»am
 = 0;

462 
»q
->
mode
 = mode;

463 
»q
->
Çm–’
 = 
¢am–’
;

464 
”r
 = 
	`wr™e
(
sock
, 
»q
, 
»qËn
);

465 ià(
”r
 < 0) {

466 
	`SNDERR
("writeƒrror");

467 
»suÉ
 = -
”ºo
;

468 
_”r
;

470 ià((
size_t
è
”r
 !ğ
»qËn
) {

471 
	`SNDERR
("write sizeƒrror");

472 
»suÉ
 = -
EINVAL
;

473 
_”r
;

475 
”r
 = 
	`»ad
(
sock
, &
ªs
, (ans));

476 ià(
”r
 < 0) {

477 
	`SNDERR
("readƒrror");

478 
»suÉ
 = -
”ºo
;

479 
_”r
;

481 ià(
”r
 !ğ(
ªs
)) {

482 
	`SNDERR
("read sizeƒrror");

483 
»suÉ
 = -
EINVAL
;

484 
_”r
;

486 
»suÉ
 = 
ªs
.result;

487 ià(
»suÉ
 < 0)

488 
_”r
;

490 
ù¾
 = 
	`shm©
(
ªs
.
cook›
, 0, 0);

491 ià(!
ù¾
) {

492 
»suÉ
 = -
”ºo
;

493 
_”r
;

496 
shm
 = 
	`ÿÎoc
(1, (
¢d_ùl_shm_t
));

497 ià(!
shm
) {

498 
»suÉ
 = -
ENOMEM
;

499 
_”r
;

502 
shm
->
sock‘
 = 
sock
;

503 
shm
->
ù¾
 = ctrl;

505 
”r
 = 
	`¢d_ùl_Ãw
(&
ùl
, 
SND_CTL_TYPE_SHM
, 
Çme
, 
mode
);

506 ià(
”r
 < 0) {

507 
»suÉ
 = 
”r
;

508 
_”r
;

510 
ùl
->
İs
 = &
¢d_ùl_shm_İs
;

511 
ùl
->
´iv©e_d©a
 = 
shm
;

512 
”r
 = 
	`¢d_ùl_shm_pŞl_desütÜ
(
ùl
);

513 ià(
”r
 < 0) {

514 
	`¢d_ùl_şo£
(
ùl
);

515  
”r
;

517 
ùl
->
pŞl_fd
 = 
”r
;

518 *
hªdËp
 = 
ùl
;

521 
_”r
:

522 
	`şo£
(
sock
);

523 ià(
ù¾
)

524 
	`shmdt
(
ù¾
);

525 
	`ä“
(
shm
);

526  
»suÉ
;

527 
	}
}

529 
	$_¢d_ùl_shm_İ’
(
¢d_ùl_t
 **
hªdËp
, *
Çme
, 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
, 
mode
)

531 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

532 cÚ¡ *
£rv”
 = 
NULL
;

533 cÚ¡ *
ùl_Çme
 = 
NULL
;

534 
¢d_cÚfig_t
 *
scÚfig
;

535 cÚ¡ *
sockÇme
 = 
NULL
;

536 
pÜt
 = -1;

537 
”r
;

539 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

540 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

541 cÚ¡ *
id
;

542 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

544 ià(
	`_¢d_cÚf_g’”ic_id
(
id
))

546 ià(
	`¡rcmp
(
id
, "server") == 0) {

547 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
£rv”
);

548 ià(
”r
 < 0) {

549 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

550  -
EINVAL
;

554 ià(
	`¡rcmp
(
id
, "ctl") == 0) {

555 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
ùl_Çme
);

556 ià(
”r
 < 0) {

557 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

558  -
EINVAL
;

562 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

563  -
EINVAL
;

565 ià(!
ùl_Çme
) {

566 
	`SNDERR
("ctl is‚ot defined");

567  -
EINVAL
;

569 ià(!
£rv”
) {

570 
	`SNDERR
("server is‚ot defined");

571  -
EINVAL
;

573 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "£rv”", 
£rv”
, &
scÚfig
);

574 ià(
”r
 < 0) {

575 
	`SNDERR
("UnknowÀ£rv” %s", 
£rv”
);

576  -
EINVAL
;

578 ià(
	`¢d_cÚfig_g‘_ty³
(
scÚfig
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

579 
	`SNDERR
("Inv®idy³ fÜ s”v” % defš™iÚ", 
£rv”
);

580 
”r
 = -
EINVAL
;

581 
_”r
;

583 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
scÚfig
) {

584 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

585 cÚ¡ *
id
;

586 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

588 ià(
	`_¢d_cÚf_g’”ic_id
(
id
))

590 ià(
	`¡rcmp
(
id
, "host") == 0)

592 ià(
	`¡rcmp
(
id
, "socket") == 0) {

593 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
sockÇme
);

594 ià(
”r
 < 0) {

595 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

596 
_”r
;

600 ià(
	`¡rcmp
(
id
, "port") == 0) {

601 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
pÜt
);

602 ià(
”r
 < 0) {

603 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

604 
_”r
;

608 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

609 
”r
 = -
EINVAL
;

610 
_”r
;

613 ià(!
sockÇme
) {

614 
	`SNDERR
("socket is‚ot defined");

615 
_”r
;

617 
”r
 = 
	`¢d_ùl_shm_İ’
(
hªdËp
, 
Çme
, 
sockÇme
, 
ùl_Çme
, 
mode
);

618 
_”r
:

619 
	`¢d_cÚfig_d–‘e
(
scÚfig
);

620  
”r
;

621 
	}
}

622 
SND_DLSYM_BUILD_VERSION
(
_¢d_ùl_shm_İ’
, 
SND_CONTROL_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_symbols.c

21 #iâdeà
PIC


23 cÚ¡ *
_¢d_moduË_cÚŒŞ_hw
;

24 cÚ¡ *
_¢d_moduË_cÚŒŞ_em±y
;

25 cÚ¡ *
_¢d_moduË_cÚŒŞ_»m­
;

26 cÚ¡ *
_¢d_moduË_cÚŒŞ_shm
;

27 cÚ¡ *
_¢d_moduË_cÚŒŞ_ext
;

29 cÚ¡ **
	g¢d_cÚŒŞ_İ’_objeùs
[] = {

30 &
_¢d_moduË_cÚŒŞ_hw
,

31 &
_¢d_moduË_cÚŒŞ_em±y
,

32 
	~"ùl_symbŞs_li¡.c
"

35 *
	$¢d_cÚŒŞ_İ’_symbŞs
()

37  
¢d_cÚŒŞ_İ’_objeùs
;

38 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/ctlparse.c

28 
	~"cÚŒŞ_loÿl.h
"

29 
	~<uni¡d.h
>

30 
	~<¡ršg.h
>

31 
	~<ùy³.h
>

32 
	~<m©h.h
>

36 
šlše
 
	$cÚv”t_´ªge1
(
³rc
, 
mš
, 
max
)

38 
tmp
;

40 #ifdeà
HAVE_SOFT_FLOAT


41 
tmp
 = 
³rc
 * (
max
 - 
mš
);

42 
tmp
 =mp / 100 + ((tmp % 100) < 50 ? 0 : 1);

44 
tmp
 = 
	`ršt
(()
³rc
 * ()(
max
 - 
mš
) * 0.01);

46 ià(
tmp
 =ğ0 && 
³rc
 > 0)

47 
tmp
++;

48  
tmp
 + 
mš
;

49 
	}
}

51 
	#check_¿nge
(
v®
, 
mš
, 
max
) \

52 ((
v®
 < 
mš
è? (mšè: ((v® > 
max
è? (maxè: (v®)))

	)

54 
	$g‘_š‹g”
(cÚ¡ **
±r
, 
mš
, 
max
)

56 
v®
 = 
mš
;

57 *
p
 = (*)*
±r
, *
s
;

59 ià(*
p
 == ':')

60 
p
++;

61 ià(*
p
 =ğ'\0' || (!
	`isdig™
(*p) && *p != '-'))

62 
out
;

64 
s
 = 
p
;

65 
v®
 = 
	`¡¹Ş
(
s
, &
p
, 0);

66 ià(*
p
 == '.') {

67 
p
++;

68 ()
	`¡¹Ş
(
p
, &p, 10);

70 ià(*
p
 == '%') {

71 
v®
 = ()
	`cÚv”t_´ªge1
(
	`¡¹od
(
s
, 
NULL
), 
mš
, 
max
);

72 
p
++;

74 
v®
 = 
	`check_¿nge
(v®, 
mš
, 
max
);

75 ià(*
p
 == ',')

76 
p
++;

77 
out
:

78 *
±r
 = 
p
;

79  
v®
;

80 
	}
}

82 
	$g‘_š‹g”64
(cÚ¡ **
±r
, 
mš
, 
max
)

84 
v®
 = 
mš
;

85 *
p
 = (*)*
±r
, *
s
;

87 ià(*
p
 == ':')

88 
p
++;

89 ià(*
p
 =ğ'\0' || (!
	`isdig™
(*p) && *p != '-'))

90 
out
;

92 
s
 = 
p
;

93 
v®
 = 
	`¡¹Ş
(
s
, &
p
, 0);

94 ià(*
p
 == '.') {

95 
p
++;

96 ()
	`¡¹Ş
(
p
, &p, 10);

98 ià(*
p
 == '%') {

99 
v®
 = ()
	`cÚv”t_´ªge1
(
	`¡¹od
(
s
, 
NULL
), 
mš
, 
max
);

100 
p
++;

102 
v®
 = 
	`check_¿nge
(v®, 
mš
, 
max
);

103 ià(*
p
 == ',')

104 
p
++;

105 
out
:

106 *
±r
 = 
p
;

107  
v®
;

108 
	}
}

117 *
	$¢d_ùl_ascii_–em_id_g‘
(
¢d_ùl_–em_id_t
 *
id
)

119 
numid
, 
šdex
, 
deviû
, 
subdeviû
;

120 
buf
[256], 
buf1
[32];

121 cÚ¡ *
içû
;

123 
numid
 = 
	`¢d_ùl_–em_id_g‘_numid
(
id
);

124 
içû
 = 
	`¢d_ùl_–em_içû_Çme
(
	`¢d_ùl_–em_id_g‘_š‹rçû
(
id
));

125 ià(
numid
 > 0) {

126 
	`¢´štf
(
buf
, (buf), "numid=%u,iface=%s,name='%s'",

127 
numid
, 
içû
, 
	`¢d_ùl_–em_id_g‘_Çme
(
id
));

129 
	`¢´štf
(
buf
, (buf), "iface=%s,name='%s'",

130 
içû
, 
	`¢d_ùl_–em_id_g‘_Çme
(
id
));

132 
buf
[(buf)-1] = '\0';

133 
šdex
 = 
	`¢d_ùl_–em_id_g‘_šdex
(
id
);

134 
deviû
 = 
	`¢d_ùl_–em_id_g‘_deviû
(
id
);

135 
subdeviû
 = 
	`¢d_ùl_–em_id_g‘_subdeviû
(
id
);

136 ià(
šdex
) {

137 
	`¢´štf
(
buf1
, (buf1), ",šdex=%u", 
šdex
);

138 ià(
	`¡¾’
(
buf
è+ sŒËn(
buf1
) < (buf))

139 
	`¡rÿt
(
buf
, 
buf1
);

141 ià(
deviû
) {

142 
	`¢´štf
(
buf1
, (buf1), ",deviû=%u", 
deviû
);

143 ià(
	`¡¾’
(
buf
è+ sŒËn(
buf1
) < (buf))

144 
	`¡rÿt
(
buf
, 
buf1
);

146 ià(
subdeviû
) {

147 
	`¢´štf
(
buf1
, (buf1), ",subdeviû=%u", 
subdeviû
);

148 ià(
	`¡¾’
(
buf
è+ sŒËn(
buf1
) < (buf))

149 
	`¡rÿt
(
buf
, 
buf1
);

151  
	`¡rdup
(
buf
);

152 
	}
}

154 #iâdeà
DOC_HIDDEN


156 
	$__¢d_ùl_ascii_–em_id_·r£
(
¢d_ùl_–em_id_t
 *
d¡
, cÚ¡ *
¡r
,

157 cÚ¡ **
»t_±r
)

159 
c
, 
size
, 
numid
;

160 
”r
 = -
EINVAL
;

161 *
±r
;

163 
	`is¥aû
(*
¡r
))

164 
¡r
++;

165 ià(!(*
¡r
))

166 
out
;

167 
	`¢d_ùl_–em_id_£t_š‹rçû
(
d¡
, 
SND_CTL_ELEM_IFACE_MIXER
);

168 *
¡r
) {

169 ià(!
	`¡ºÿ£cmp
(
¡r
, "numid=", 6)) {

170 
¡r
 += 6;

171 
numid
 = 
	`©oi
(
¡r
);

172 ià(
numid
 <= 0) {

173 
	`årštf
(
¡d”r
, "amix”: Inv®id‚umid %d\n", 
numid
);

174 
out
;

176 
	`¢d_ùl_–em_id_£t_numid
(
d¡
, 
	`©oi
(
¡r
));

177 
	`isdig™
(*
¡r
))

178 
¡r
++;

179 } ià(!
	`¡ºÿ£cmp
(
¡r
, "iface=", 6)) {

180 
¡r
 += 6;

181 ià(!
	`¡ºÿ£cmp
(
¡r
, "card", 4)) {

182 
	`¢d_ùl_–em_id_£t_š‹rçû
(
d¡
, 
SND_CTL_ELEM_IFACE_CARD
);

183 
¡r
 += 4;

184 } ià(!
	`¡ºÿ£cmp
(
¡r
, "mixer", 5)) {

185 
	`¢d_ùl_–em_id_£t_š‹rçû
(
d¡
, 
SND_CTL_ELEM_IFACE_MIXER
);

186 
¡r
 += 5;

187 } ià(!
	`¡ºÿ£cmp
(
¡r
, "pcm", 3)) {

188 
	`¢d_ùl_–em_id_£t_š‹rçû
(
d¡
, 
SND_CTL_ELEM_IFACE_PCM
);

189 
¡r
 += 3;

190 } ià(!
	`¡ºÿ£cmp
(
¡r
, "rawmidi", 7)) {

191 
	`¢d_ùl_–em_id_£t_š‹rçû
(
d¡
, 
SND_CTL_ELEM_IFACE_RAWMIDI
);

192 
¡r
 += 7;

193 } ià(!
	`¡ºÿ£cmp
(
¡r
, "timer", 5)) {

194 
	`¢d_ùl_–em_id_£t_š‹rçû
(
d¡
, 
SND_CTL_ELEM_IFACE_TIMER
);

195 
¡r
 += 5;

196 } ià(!
	`¡ºÿ£cmp
(
¡r
, "sequencer", 9)) {

197 
	`¢d_ùl_–em_id_£t_š‹rçû
(
d¡
, 
SND_CTL_ELEM_IFACE_SEQUENCER
);

198 
¡r
 += 9;

200 
out
;

202 } ià(!
	`¡ºÿ£cmp
(
¡r
, "name=", 5)) {

203 
buf
[64];

204 
¡r
 += 5;

205 
±r
 = 
buf
;

206 
size
 = 0;

207 ià(*
¡r
 == '\'' || *str == '\"') {

208 
c
 = *
¡r
++;

209 *
¡r
 && *¡¸!ğ
c
) {

210 ià(
size
 < ()(
buf
)) {

211 *
±r
++ = *
¡r
;

212 
size
++;

214 
¡r
++;

216 ià(*
¡r
 =ğ
c
)

217 
¡r
++;

219 *
¡r
 && *str != ',') {

220 ià(
size
 < ()(
buf
)) {

221 *
±r
++ = *
¡r
;

222 
size
++;

224 
¡r
++;

227 *
±r
 = '\0';

228 
	`¢d_ùl_–em_id_£t_Çme
(
d¡
, 
buf
);

229 } ià(!
	`¡ºÿ£cmp
(
¡r
, "index=", 6)) {

230 
¡r
 += 6;

231 
	`¢d_ùl_–em_id_£t_šdex
(
d¡
, 
	`©oi
(
¡r
));

232 
	`isdig™
(*
¡r
))

233 
¡r
++;

234 } ià(!
	`¡ºÿ£cmp
(
¡r
, "device=", 7)) {

235 
¡r
 += 7;

236 
	`¢d_ùl_–em_id_£t_deviû
(
d¡
, 
	`©oi
(
¡r
));

237 
	`isdig™
(*
¡r
))

238 
¡r
++;

239 } ià(!
	`¡ºÿ£cmp
(
¡r
, "subdevice=", 10)) {

240 
¡r
 += 10;

241 
	`¢d_ùl_–em_id_£t_subdeviû
(
d¡
, 
	`©oi
(
¡r
));

242 
	`isdig™
(*
¡r
))

243 
¡r
++;

245 ià(*
¡r
 == ',') {

246 
¡r
++;

251 ià(
»t_±r
 && 
	`is¥aû
(*
¡r
))

253 ià(*
¡r
)

254 
out
;

257 
”r
 = 0;

259 
out
:

260 ià(
»t_±r
)

261 *
»t_±r
 = 
¡r
;

262  
”r
;

263 
	}
}

272 
	$¢d_ùl_ascii_–em_id_·r£
(
¢d_ùl_–em_id_t
 *
d¡
, cÚ¡ *
¡r
)

274  
	`__¢d_ùl_ascii_–em_id_·r£
(
d¡
, 
¡r
, 
NULL
);

275 
	}
}

277 
	$g‘_ùl_’um_™em_šdex
(
¢d_ùl_t
 *
hªdË
,

278 
¢d_ùl_–em_šfo_t
 *
šfo
,

279 cÚ¡ **
±½
)

281 *
±r
 = (*)*
±½
;

282 
™ems
, 
i
, 
Ën
;

283 cÚ¡ *
Çme
;

284 
’d
;

286 
™ems
 = 
	`¢d_ùl_–em_šfo_g‘_™ems
(
šfo
);

287 ià(
™ems
 <= 0)

290 
’d
 = *
±r
;

291 ià(
’d
 == '\'' ||ƒnd == '"')

292 
±r
++;

294 
’d
 = '\0';

296 
i
 = 0; i < 
™ems
; i++) {

297 
	`¢d_ùl_–em_šfo_£t_™em
(
šfo
, 
i
);

298 ià(
	`¢d_ùl_–em_šfo
(
hªdË
, 
šfo
) < 0)

300 
Çme
 = 
	`¢d_ùl_–em_šfo_g‘_™em_Çme
(
šfo
);

301 
Ën
 = 
	`¡¾’
(
Çme
);

302 ià(
	`¡ºcmp
(
Çme
, 
±r
, 
Ën
))

304 ià(
’d
 =ğ'\0' && (
±r
[
Ën
] == '\0' ||…tr[len] == ',' ||…tr[len] == '\n')) {

305 *
±½
 = 
±r
 + 
Ën
;

306  
i
;

308 ià(
’d
 !ğ'\0' && 
±r
[
Ën
] ==ƒnd) {

309 *
±½
 = 
±r
 + 
Ën
 + 1;

310  
i
;

314 
	}
}

316 
	$g‘_ùl_ty³_max_–em’ts
(
¢d_ùl_–em_ty³_t
 
ty³
)

318 
¢d_ùl_–em_v®ue
 
v®ue
;

320 
ty³
) {

321 
SND_CTL_ELEM_TYPE_BOOLEAN
:

322 
SND_CTL_ELEM_TYPE_INTEGER
:

323  
	`ARRAY_SIZE
(
v®ue
.v®ue.
š‹g”
.value);

324 
SND_CTL_ELEM_TYPE_INTEGER64
:

325  
	`ARRAY_SIZE
(
v®ue
.v®ue.
š‹g”64
.value);

326 
SND_CTL_ELEM_TYPE_ENUMERATED
:

327  
	`ARRAY_SIZE
(
v®ue
.v®ue.
’um”©ed
.
™em
);

328 
SND_CTL_ELEM_TYPE_BYTES
:

329  
	`ARRAY_SIZE
(
v®ue
.v®ue.
by‹s
.
d©a
);

333 
	}
}

346 
	$¢d_ùl_ascii_v®ue_·r£
(
¢d_ùl_t
 *
hªdË
,

347 
¢d_ùl_–em_v®ue_t
 *
d¡
,

348 
¢d_ùl_–em_šfo_t
 *
šfo
,

349 cÚ¡ *
v®ue
)

351 cÚ¡ *
±r
 = 
v®ue
;

352 
¢d_ùl_–em_id_t
 
myid
 = {0};

353 
¢d_ùl_–em_ty³_t
 
ty³
;

354 
idx
, 
couÁ
;

355 
tmp
;

356 
tmp64
;

358 
	`¢d_ùl_–em_šfo_g‘_id
(
šfo
, &
myid
);

359 
ty³
 = 
	`¢d_ùl_–em_šfo_g‘_ty³
(
šfo
);

360 
couÁ
 = 
	`¢d_ùl_–em_šfo_g‘_couÁ
(
šfo
);

361 
	`¢d_ùl_–em_v®ue_£t_id
(
d¡
, &
myid
);

363 ià(
couÁ
 > 
	`g‘_ùl_ty³_max_–em’ts
(
ty³
))

364 
couÁ
 = 
	`g‘_ùl_ty³_max_–em’ts
(
ty³
);

366 
idx
 = 0; idx < 
couÁ
 && 
±r
 && *ptr; idx++) {

367 ià(*
±r
 == ',')

368 
sk
;

369 
ty³
) {

370 
SND_CTL_ELEM_TYPE_BOOLEAN
:

371 
tmp
 = 0;

372 ià(!
	`¡ºÿ£cmp
(
±r
, "on", 2) ||

373 !
	`¡ºÿ£cmp
(
±r
, "up", 2)) {

374 
tmp
 = 1;

375 
±r
 += 2;

376 } ià(!
	`¡ºÿ£cmp
(
±r
, "yes", 3)) {

377 
tmp
 = 1;

378 
±r
 += 3;

379 } ià(!
	`¡ºÿ£cmp
(
±r
, "toggle", 6)) {

380 
tmp
 = 
	`¢d_ùl_–em_v®ue_g‘_boŞ—n
(
d¡
, 
idx
);

381 
tmp
 =mp > 0 ? 0 : 1;

382 
±r
 += 6;

383 } ià(
	`isdig™
(*
±r
)) {

384 
tmp
 = 
	`©oi
(
±r
) > 0 ? 1 : 0;

385 
	`isdig™
(*
±r
))

386 
±r
++;

388 *
±r
 && *ptr != ',')

389 
±r
++;

391 
	`¢d_ùl_–em_v®ue_£t_boŞ—n
(
d¡
, 
idx
, 
tmp
);

393 
SND_CTL_ELEM_TYPE_INTEGER
:

394 
tmp
 = 
	`g‘_š‹g”
(&
±r
,

395 
	`¢d_ùl_–em_šfo_g‘_mš
(
šfo
),

396 
	`¢d_ùl_–em_šfo_g‘_max
(
šfo
));

397 
	`¢d_ùl_–em_v®ue_£t_š‹g”
(
d¡
, 
idx
, 
tmp
);

399 
SND_CTL_ELEM_TYPE_INTEGER64
:

400 
tmp64
 = 
	`g‘_š‹g”64
(&
±r
,

401 
	`¢d_ùl_–em_šfo_g‘_mš64
(
šfo
),

402 
	`¢d_ùl_–em_šfo_g‘_max64
(
šfo
));

403 
	`¢d_ùl_–em_v®ue_£t_š‹g”64
(
d¡
, 
idx
, 
tmp64
);

405 
SND_CTL_ELEM_TYPE_ENUMERATED
:

406 
tmp
 = 
	`g‘_ùl_’um_™em_šdex
(
hªdË
, 
šfo
, &
±r
);

407 ià(
tmp
 < 0)

408 
tmp
 = 
	`g‘_š‹g”
(&
±r
, 0,

409 
	`¢d_ùl_–em_šfo_g‘_™ems
(
šfo
) - 1);

410 
	`¢d_ùl_–em_v®ue_£t_’um”©ed
(
d¡
, 
idx
, 
tmp
);

412 
SND_CTL_ELEM_TYPE_BYTES
:

413 
tmp
 = 
	`g‘_š‹g”
(&
±r
, 0, 255);

414 
	`¢d_ùl_–em_v®ue_£t_by‹
(
d¡
, 
idx
, 
tmp
);

419 
sk
:

420 ià(!
	`¡rchr
(
v®ue
, ','))

421 
±r
 = 
v®ue
;

422 ià(*
±r
 == ',')

423 
±r
++;

426 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/eld.c

29 
	~"cÚŒŞ_loÿl.h
"

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<uni¡d.h
>

33 
	~<¡ršg.h
>

34 
	~<ùy³.h
>

36 
	$__fl_–d_ùl_id
(
¢d_ùl_–em_id_t
 *
id
, 
dev
, 
subdev
)

38 
	`¢d_ùl_–em_id_£t_š‹rçû
(
id
, 
SND_CTL_ELEM_IFACE_PCM
);

39 
	`¢d_ùl_–em_id_£t_Çme
(
id
, "ELD");

40 
	`¢d_ùl_–em_id_£t_deviû
(
id
, 
dev
);

41 
	`¢d_ùl_–em_id_£t_šdex
(
id
, 
subdev
);

42 
	}
}

44 
	$__¢d_pcm_šfo_–d_fixup
(
¢d_pcm_šfo_t
 * 
šfo
)

46 
¢d_ùl_t
 *
ùl
;

47 
¢d_ùl_–em_šfo_t
 
cšfo
 = {0};

48 
¢d_ùl_–em_v®ue_t
 
v®ue
 = {0};

49 *
–d
;

50 
l
, 
¥c
;

51 *
s
, 
c
;

52 
»t
, 
v®id
;

54 
»t
 = 
	`¢d_ùl_hw_İ’
(&
ùl
, 
NULL
, 
šfo
->
ÿrd
, 0);

55 ià(
»t
 < 0) {

56 
	`SYSMSG
("Cannot openhe‡ssociated CTL");

57  
»t
;

60 
	`__fl_–d_ùl_id
(&
cšfo
.
id
, 
šfo
->
deviû
, info->
subdeviû
);

61 
v®ue
.
id
 = 
cšfo
.id;

62 
»t
 = 
	`¢d_ùl_–em_šfo
(
ùl
, &
cšfo
);

63 ià(
»t
 >ğ0 && 
cšfo
.
ty³
 =ğ
SND_CTL_ELEM_TYPE_BYTES
)

64 
»t
 = 
	`¢d_ùl_–em_»ad
(
ùl
, &
v®ue
);

65 
	`¢d_ùl_şo£
(
ùl
);

66 ià(
»t
 =ğ-
ENOENT
 || 
cšfo
.
ty³
 !ğ
SND_CTL_ELEM_TYPE_BYTES
 || cšfo.
couÁ
 == 0)

68 ià(
»t
 < 0) {

69 
	`SYSMSG
("Cannot„ead ELD");

70  
»t
;

73 
–d
 = 
v®ue
.v®ue.
by‹s
.
d©a
;

74 ià(
cšfo
.
couÁ
 < 20 || cinfo.count > 256)

75  -
EIO
;

76 
l
 = 
–d
[4] & 0x1f;

77 ià(
l
 == 0)

79 
__´e£Á
;

80 ià(
l
 > 16 || 20 +† > 
cšfo
.
couÁ
) {

81 
	`SNDERR
("ELD decode failed, using old HDMI output‚ames");

84 
s
 = 
	`®loÿ
(
l
 + 1);

86 
v®id
 = 0;

87 
¥c
 = 0;

88 
l
 > 0) {

89 
l
--;

90 
c
 = 
–d
[20 + 
l
];

91 ià(
c
 <= ' ' || c >= 0x7f) {

92 
s
[
l
] = ' ';

94 
v®id
 +ğ!!
	`i§Êum
(
c
);

95 
s
[
l
] = 
c
;

96 ià(
¥c
 == 0)

97 
¥c
 = 
l
 + 1;

100 ià(
v®id
 > 3) {

101 
s
[
¥c
] = '\0';

102 
	`¢d_¡¾ıy
((*)
šfo
->
Çme
, 
s
, (info->name));

104 
__´e£Á
:

105 
	`¡ºÿt
((*)
šfo
->
Çme
, " *", (info->name) - 1);

106 ((*)
šfo
->
Çme
)[(info->name)-1] = '\0';

109 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/hcontrol.c

45 
	~"cÚŒŞ_loÿl.h
"

46 
	~<¡dio.h
>

47 
	~<¡dlib.h
>

48 
	~<uni¡d.h
>

49 
	~<¡ršg.h
>

50 
	~<fú.h
>

51 
	~<sys/ioùl.h
>

52 #ifdeà
HAVE_LIBPTHREAD


53 
	~<±h»ad.h
>

56 #iâdeà
DOC_HIDDEN


57 
	#NOT_FOUND
 1000000000

	)

60 
¢d_hùl_com·»_deçuÉ
(cÚ¡ 
¢d_hùl_–em_t
 *
c1
,

61 cÚ¡ 
¢d_hùl_–em_t
 *
c2
);

70 
	$¢d_hùl_İ’
(
¢d_hùl_t
 **
hùÍ
, cÚ¡ *
Çme
, 
mode
)

72 
¢d_ùl_t
 *
ùl
;

73 
”r
;

75 ià((
”r
 = 
	`¢d_ùl_İ’
(&
ùl
, 
Çme
, 
mode
)) < 0)

76  
”r
;

77 
”r
 = 
	`¢d_hùl_İ’_ùl
(
hùÍ
, 
ùl
);

78 ià(
”r
 < 0)

79 
	`¢d_ùl_şo£
(
ùl
);

80  
”r
;

81 
	}
}

89 
	$¢d_hùl_İ’_ùl
(
¢d_hùl_t
 **
hùÍ
, 
¢d_ùl_t
 *
ùl
)

91 
¢d_hùl_t
 *
hùl
;

93 
	`as£¹
(
hùÍ
);

94 *
hùÍ
 = 
NULL
;

95 ià((
hùl
 = (
¢d_hùl_t
 *)
	`ÿÎoc
(1, (¢d_hùl_t))è=ğ
NULL
)

96  -
ENOMEM
;

97 
	`INIT_LIST_HEAD
(&
hùl
->
–ems
);

98 
hùl
->
ùl
 = ctl;

99 *
hùÍ
 = 
hùl
;

101 
	}
}

111 
	$¢d_hùl_şo£
(
¢d_hùl_t
 *
hùl
)

113 
”r
;

115 
	`as£¹
(
hùl
);

116 
”r
 = 
	`¢d_ùl_şo£
(
hùl
->
ùl
);

117 
	`¢d_hùl_ä“
(
hùl
);

118 
	`ä“
(
hùl
);

119  
”r
;

120 
	}
}

130 cÚ¡ *
	$¢d_hùl_Çme
(
¢d_hùl_t
 *
hùl
)

132 
	`as£¹
(
hùl
);

133  
	`¢d_ùl_Çme
(
hùl
->
ùl
);

134 
	}
}

142 
	$¢d_hùl_nÚblock
(
¢d_hùl_t
 *
hùl
, 
nÚblock
)

144 
	`as£¹
(
hùl
);

145  
	`¢d_ùl_nÚblock
(
hùl
->
ùl
, 
nÚblock
);

146 
	}
}

157 
	$¢d_hùl_async
(
¢d_hùl_t
 *
hùl
, 
sig
, 
pid_t
 
pid
)

159 
	`as£¹
(
hùl
);

160  
	`¢d_ùl_async
(
hùl
->
ùl
, 
sig
, 
pid
);

161 
	}
}

168 
	$¢d_hùl_pŞl_desütÜs_couÁ
(
¢d_hùl_t
 *
hùl
)

170 
	`as£¹
(
hùl
);

171  
	`¢d_ùl_pŞl_desütÜs_couÁ
(
hùl
->
ùl
);

172 
	}
}

181 
	$¢d_hùl_pŞl_desütÜs
(
¢d_hùl_t
 *
hùl
, 
pŞlfd
 *
pfds
, 
¥aû
)

183 
	`as£¹
(
hùl
);

184  
	`¢d_ùl_pŞl_desütÜs
(
hùl
->
ùl
, 
pfds
, 
¥aû
);

185 
	}
}

195 
	$¢d_hùl_pŞl_desütÜs_»v’ts
(
¢d_hùl_t
 *
hùl
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

197 
	`as£¹
(
hùl
);

198  
	`¢d_ùl_pŞl_desütÜs_»v’ts
(
hùl
->
ùl
, 
pfds
, 
nfds
, 
»v’ts
);

199 
	}
}

201 
	$¢d_hùl_throw_ev’t
(
¢d_hùl_t
 *
hùl
, 
mask
,

202 
¢d_hùl_–em_t
 *
–em
)

204 ià(
hùl
->
ÿÎback
)

205  
hùl
->
	`ÿÎback
(hùl, 
mask
, 
–em
);

207 
	}
}

209 
	$¢d_hùl_–em_throw_ev’t
(
¢d_hùl_–em_t
 *
–em
,

210 
mask
)

212 ià(
–em
->
ÿÎback
)

213  
–em
->
	`ÿÎback
ÓËm, 
mask
);

215 
	}
}

217 
	$¢d_hùl_com·»_mix”_´iÜ™y_lookup
(cÚ¡ **
Çme
, cÚ¡ * cÚ¡ *
Çmes
, 
cÛf
)

219 
»s
;

221 
»s
 = 0; *
Çmes
;‚ames++,„e +ğ
cÛf
) {

222 ià(!
	`¡ºcmp
(*
Çme
, *
Çmes
, 
	`¡¾’
(*names))) {

223 *
Çme
 +ğ
	`¡¾’
(*
Çmes
);

224 ià(**
Çme
 == ' ')

225 (*
Çme
)++;

226  
»s
+1;

229  
NOT_FOUND
;

230 
	}
}

232 
	$g‘_com·»_weight
(cÚ¡ 
¢d_ùl_–em_id_t
 *
id
)

234 cÚ¡ *cÚ¡ 
Çmes
[] = {

268 
NULL


270 cÚ¡ *cÚ¡ 
Çmes1
[] = {

282 
NULL


284 cÚ¡ *cÚ¡ 
Çmes2
[] = {

293 
NULL


295 cÚ¡ *
Çme
 = (*)
id
->Çme, *
Çme1
;

296 
»s
, 
»s1
;

298 ià((
»s
 = 
	`¢d_hùl_com·»_mix”_´iÜ™y_lookup
((cÚ¡ **)&
Çme
, 
Çmes
, 1000000)è=ğ
NOT_FOUND
)

299  
NOT_FOUND
;

300 ià(*
Çme
 == '\0')

301  
»s
;

302 
Çme1
 = 
Çme
; *name1 != '\0';‚ame1++);

303 
Çme1
--;‚ame1 !ğ
Çme
 && *name1 != ' ';‚ame1--);

304 
Çme1
 !ğ
Çme
 && *name1 == ' ')

305 
Çme1
--;

306 ià(
Çme1
 !ğ
Çme
) {

307 ; 
Çme1
 !ğ
Çme
 && *name1 != ' ';‚ame1--);

308 
Çme
 = 
Çme1
;

309 ià((
»s1
 = 
	`¢d_hùl_com·»_mix”_´iÜ™y_lookup
((cÚ¡ **)&
Çme
, 
Çmes1
, 1000)è=ğ
NOT_FOUND
)

310  
»s
;

311 
»s
 +ğ
»s1
;

313 
Çme
 = 
Çme1
;

315 ià((
»s1
 = 
	`¢d_hùl_com·»_mix”_´iÜ™y_lookup
((cÚ¡ **)&
Çme
, 
Çmes2
, 1)è=ğ
NOT_FOUND
)

316  
»s
;

317  
»s
 + 
»s1
;

318 
	}
}

320 
	$_¢d_hùl_fšd_–em
(
¢d_hùl_t
 *
hùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
, *
dœ
)

322 
l
, 
u
;

323 
¢d_hùl_–em_t
 
–
;

324 
c
 = 0;

325 
idx
 = -1;

326 
	`as£¹
(
hùl
 && 
id
);

327 
	`as£¹
(
hùl
->
com·»
);

328 
–
.
id
 = *id;

329 
–
.
com·»_weight
 = 
	`g‘_com·»_weight
(
id
);

330 
l
 = 0;

331 
u
 = 
hùl
->
couÁ
;

332 
l
 < 
u
) {

333 
idx
 = (
l
 + 
u
) / 2;

334 
c
 = 
hùl
->
	`com·»
(&
–
, hùl->
³Ëms
[
idx
]);

335 ià(
c
 < 0)

336 
u
 = 
idx
;

337 ià(
c
 > 0)

338 
l
 = 
idx
 + 1;

342 *
dœ
 = 
c
;

343  
idx
;

344 
	}
}

346 
	$¢d_hùl_–em_add
(
¢d_hùl_t
 *
hùl
, 
¢d_hùl_–em_t
 *
–em
)

348 
dœ
;

349 
idx
;

350 
–em
->
com·»_weight
 = 
	`g‘_com·»_weight
(&–em->
id
);

351 ià(
hùl
->
couÁ
 =ğhùl->
®loc
) {

352 
¢d_hùl_–em_t
 **
h
;

353 
hùl
->
®loc
 += 32;

354 
h
 = 
	`»®loc
(
hùl
->
³Ëms
, (*hè* hùl->
®loc
);

355 ià(!
h
) {

356 
hùl
->
®loc
 -= 32;

357  -
ENOMEM
;

359 
hùl
->
³Ëms
 = 
h
;

361 ià(
hùl
->
couÁ
 == 0) {

362 
	`li¡_add_
(&
–em
->
li¡
, &
hùl
->
–ems
);

363 
hùl
->
³Ëms
[0] = 
–em
;

365 
idx
 = 
	`_¢d_hùl_fšd_–em
(
hùl
, &
–em
->
id
, &
dœ
);

366 
	`as£¹
(
dœ
 != 0);

367 ià(
dœ
 > 0) {

368 
	`li¡_add
(&
–em
->
li¡
, &
hùl
->
³Ëms
[
idx
]->list);

369 
idx
++;

371 
	`li¡_add_
(&
–em
->
li¡
, &
hùl
->
³Ëms
[
idx
]->list);

373 
	`memmove
(
hùl
->
³Ëms
 + 
idx
 + 1,

374 
hùl
->
³Ëms
 + 
idx
,

375 (
hùl
->
couÁ
 - 
idx
è* (
¢d_hùl_–em_t
 *));

376 
hùl
->
³Ëms
[
idx
] = 
–em
;

378 
hùl
->
couÁ
++;

379  
	`¢d_hùl_throw_ev’t
(
hùl
, 
SNDRV_CTL_EVENT_MASK_ADD
, 
–em
);

380 
	}
}

382 
	$¢d_hùl_–em_»move
(
¢d_hùl_t
 *
hùl
, 
idx
)

384 
¢d_hùl_–em_t
 *
–em
 = 
hùl
->
³Ëms
[
idx
];

385 
m
;

386 
	`¢d_hùl_–em_throw_ev’t
(
–em
, 
SNDRV_CTL_EVENT_MASK_REMOVE
);

387 
	`li¡_d–
(&
–em
->
li¡
);

388 
	`ä“
(
–em
);

389 
hùl
->
couÁ
--;

390 
m
 = 
hùl
->
couÁ
 - 
idx
;

391 ià(
m
 > 0)

392 
	`memmove
(
hùl
->
³Ëms
 + 
idx
,

393 
hùl
->
³Ëms
 + 
idx
 + 1,

394 
m
 * (
¢d_hùl_–em_t
 *));

395 
	}
}

402 
	$¢d_hùl_ä“
(
¢d_hùl_t
 *
hùl
)

404 
hùl
->
couÁ
 > 0)

405 
	`¢d_hùl_–em_»move
(
hùl
, hùl->
couÁ
 - 1);

406 
	`ä“
(
hùl
->
³Ëms
);

407 
hùl
->
³Ëms
 = 0;

408 
hùl
->
®loc
 = 0;

409 
	`INIT_LIST_HEAD
(&
hùl
->
–ems
);

411 
	}
}

413 
¢d_hùl_t
 *
	gcom·»_hùl
;

414 
	$hùl_com·»
(cÚ¡ *
a
, cÚ¡ *
b
) {

415  
com·»_hùl
->
	`com·»
(*(cÚ¡ 
¢d_hùl_–em_t
 * cÚ¡ *è
a
,

416 *(cÚ¡ 
¢d_hùl_–em_t
 * cÚ¡ *è
b
);

417 
	}
}

419 
	$¢d_hùl_sÜt
(
¢d_hùl_t
 *
hùl
)

421 
k
;

422 #ifdeà
HAVE_LIBPTHREAD


423 
±h»ad_mu‹x_t
 
sync_lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

426 
	`as£¹
(
hùl
);

427 
	`as£¹
(
hùl
->
com·»
);

428 
	`INIT_LIST_HEAD
(&
hùl
->
–ems
);

430 #ifdeà
HAVE_LIBPTHREAD


431 
	`±h»ad_mu‹x_lock
(&
sync_lock
);

433 
com·»_hùl
 = 
hùl
;

434 
	`qsÜt
(
hùl
->
³Ëms
, hùl->
couÁ
, (*hùl->³Ëms), 
hùl_com·»
);

435 #ifdeà
HAVE_LIBPTHREAD


436 
	`±h»ad_mu‹x_uÆock
(&
sync_lock
);

438 
k
 = 0; k < 
hùl
->
couÁ
; k++)

439 
	`li¡_add_
(&
hùl
->
³Ëms
[
k
]->
li¡
, &hùl->
–ems
);

440 
	}
}

448 
	$¢d_hùl_£t_com·»
(
¢d_hùl_t
 *
hùl
, 
¢d_hùl_com·»_t
 
com·»
)

450 
	`as£¹
(
hùl
);

451 
hùl
->
com·»
 = com·» =ğ
NULL
 ? 
¢d_hùl_com·»_deçuÉ
 : compare;

452 
	`¢d_hùl_sÜt
(
hùl
);

454 
	}
}

462 
	$¢d_hùl_com·»_ç¡
(cÚ¡ 
¢d_hùl_–em_t
 *
c1
,

463 cÚ¡ 
¢d_hùl_–em_t
 *
c2
)

465  
c1
->
id
.
numid
 - 
c2
->id.numid;

466 
	}
}

468 
	$¢d_hùl_com·»_deçuÉ
(cÚ¡ 
¢d_hùl_–em_t
 *
c1
,

469 cÚ¡ 
¢d_hùl_–em_t
 *
c2
)

471 
»s
, 
d
;

473 
d
 = 
c1
->
id
.
içû
 - 
c2
->id.iface;

474 ià(
d
 != 0)

475  
d
;

476 ià(
c1
->
id
.
içû
 =ğ
SNDRV_CTL_ELEM_IFACE_MIXER
) {

477 
d
 = 
c1
->
com·»_weight
 - 
c2
->compare_weight;

478 ià(
d
 != 0)

479  
d
;

481 
d
 = 
c1
->
id
.
deviû
 - 
c2
->id.device;

482 ià(
d
 != 0)

483  
d
;

484 
d
 = 
c1
->
id
.
subdeviû
 - 
c2
->id.subdevice;

485 ià(
d
 != 0)

486  
d
;

487 
»s
 = 
	`¡rcmp
((cÚ¡ *)
c1
->
id
.
Çme
, (cÚ¡ *)
c2
->id.name);

488 ià(
»s
 != 0)

489  
»s
;

490  
c1
->
id
.
šdex
 - 
c2
->id.index;

491 
	}
}

498 
¢d_hùl_–em_t
 *
	$¢d_hùl_fœ¡_–em
(
¢d_hùl_t
 *
hùl
)

500 
	`as£¹
(
hùl
);

501 ià(
	`li¡_em±y
(&
hùl
->
–ems
))

502  
NULL
;

503  
	`li¡_’Œy
(
hùl
->
–ems
.
Ãxt
, 
¢d_hùl_–em_t
, 
li¡
);

504 
	}
}

511 
¢d_hùl_–em_t
 *
	$¢d_hùl_Ï¡_–em
(
¢d_hùl_t
 *
hùl
)

513 
	`as£¹
(
hùl
);

514 ià(
	`li¡_em±y
(&
hùl
->
–ems
))

515  
NULL
;

516  
	`li¡_’Œy
(
hùl
->
–ems
.
´ev
, 
¢d_hùl_–em_t
, 
li¡
);

517 
	}
}

524 
¢d_hùl_–em_t
 *
	$¢d_hùl_–em_Ãxt
(
¢d_hùl_–em_t
 *
–em
)

526 
	`as£¹
(
–em
);

527 ià(
–em
->
li¡
.
Ãxt
 =ğ&–em->
hùl
->
–ems
)

528  
NULL
;

529  
	`li¡_’Œy
(
–em
->
li¡
.
Ãxt
, 
¢d_hùl_–em_t
,†ist);

530 
	}
}

537 
¢d_hùl_–em_t
 *
	$¢d_hùl_–em_´ev
(
¢d_hùl_–em_t
 *
–em
)

539 
	`as£¹
(
–em
);

540 ià(
–em
->
li¡
.
´ev
 =ğ&–em->
hùl
->
–ems
)

541  
NULL
;

542  
	`li¡_’Œy
(
–em
->
li¡
.
´ev
, 
¢d_hùl_–em_t
,†ist);

543 
	}
}

551 
¢d_hùl_–em_t
 *
	$¢d_hùl_fšd_–em
(
¢d_hùl_t
 *
hùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
)

553 
dœ
;

554 
»s
 = 
	`_¢d_hùl_fšd_–em
(
hùl
, 
id
, &
dœ
);

555 ià(
»s
 < 0 || 
dœ
 != 0)

556  
NULL
;

557  
hùl
->
³Ëms
[
»s
];

558 
	}
}

565 
	$¢d_hùl_lßd
(
¢d_hùl_t
 *
hùl
)

567 
¢d_ùl_–em_li¡_t
 
li¡
;

568 
”r
 = 0;

569 
idx
;

571 
	`as£¹
(
hùl
);

572 
	`as£¹
(
hùl
->
ùl
);

573 
	`as£¹
(
hùl
->
couÁ
 == 0);

574 
	`as£¹
(
	`li¡_em±y
(&
hùl
->
–ems
));

575 
	`mem£t
(&
li¡
, 0, (list));

576 ià((
”r
 = 
	`¢d_ùl_–em_li¡
(
hùl
->
ùl
, &
li¡
)) < 0)

577 
_’d
;

578 
li¡
.
couÁ
 !ğli¡.
u£d
) {

579 
”r
 = 
	`¢d_ùl_–em_li¡_®loc_¥aû
(&
li¡
,†i¡.
couÁ
);

580 ià(
”r
 < 0)

581 
_’d
;

582 ià((
”r
 = 
	`¢d_ùl_–em_li¡
(
hùl
->
ùl
, &
li¡
)) < 0)

583 
_’d
;

585 ià(
hùl
->
®loc
 < 
li¡
.
couÁ
) {

586 
hùl
->
®loc
 = 
li¡
.
couÁ
;

587 
	`ä“
(
hùl
->
³Ëms
);

588 
hùl
->
³Ëms
 = 
	`m®loc
(hùl->
®loc
 * (*hctl->pelems));

589 ià(!
hùl
->
³Ëms
) {

590 
”r
 = -
ENOMEM
;

591 
_’d
;

594 
idx
 = 0; idx < 
li¡
.
couÁ
; idx++) {

595 
¢d_hùl_–em_t
 *
–em
;

596 
–em
 = 
	`ÿÎoc
(1, (
¢d_hùl_–em_t
));

597 ià(
–em
 =ğ
NULL
) {

598 
	`¢d_hùl_ä“
(
hùl
);

599 
”r
 = -
ENOMEM
;

600 
_’d
;

602 
–em
->
id
 = 
li¡
.
pids
[
idx
];

603 
–em
->
hùl
 = hctl;

604 
–em
->
com·»_weight
 = 
	`g‘_com·»_weight
(&–em->
id
);

605 
hùl
->
³Ëms
[
idx
] = 
–em
;

606 
	`li¡_add_
(&
–em
->
li¡
, &
hùl
->
–ems
);

607 
hùl
->
couÁ
++;

609 ià(!
hùl
->
com·»
)

610 
hùl
->
com·»
 = 
¢d_hùl_com·»_deçuÉ
;

611 
	`¢d_hùl_sÜt
(
hùl
);

612 
idx
 = 0; idx < 
hùl
->
couÁ
; idx++) {

613 
»s
 = 
	`¢d_hùl_throw_ev’t
(
hùl
, 
SNDRV_CTL_EVENT_MASK_ADD
,

614 
hùl
->
³Ëms
[
idx
]);

615 ià(
»s
 < 0)

616  
»s
;

618 
”r
 = 
	`¢d_ùl_subsüibe_ev’ts
(
hùl
->
ùl
, 1);

619 
_’d
:

620 
	`ä“
(
li¡
.
pids
);

621  
”r
;

622 
	}
}

629 
	$¢d_hùl_£t_ÿÎback
(
¢d_hùl_t
 *
hùl
, 
¢d_hùl_ÿÎback_t
 
ÿÎback
)

631 
	`as£¹
(
hùl
);

632 
hùl
->
ÿÎback
 = callback;

633 
	}
}

640 
	$¢d_hùl_£t_ÿÎback_´iv©e
(
¢d_hùl_t
 *
hùl
, *
ÿÎback_´iv©e
)

642 
	`as£¹
(
hùl
);

643 
hùl
->
ÿÎback_´iv©e
 = callback_private;

644 
	}
}

651 *
	$¢d_hùl_g‘_ÿÎback_´iv©e
(
¢d_hùl_t
 *
hùl
)

653 
	`as£¹
(
hùl
);

654  
hùl
->
ÿÎback_´iv©e
;

655 
	}
}

662 
	$¢d_hùl_g‘_couÁ
(
¢d_hùl_t
 *
hùl
)

664  
hùl
->
couÁ
;

665 
	}
}

675 
	$¢d_hùl_wa™
(
¢d_hùl_t
 *
hùl
, 
timeout
)

677 
pŞlfd
 *
pfd
;

678 *
»v’ts
;

679 
i
, 
Åfds
, 
pŞlio
, 
”r
, 
”r_pŞl
;

681 
Åfds
 = 
	`¢d_hùl_pŞl_desütÜs_couÁ
(
hùl
);

682 ià(
Åfds
 <= 0 ||‚pfds >= 16) {

683 
	`SNDERR
("Inv®id…Şl_fd %d", 
Åfds
);

684  -
EIO
;

686 
pfd
 = 
	`®loÿ
((*pfdè* 
Åfds
);

687 
»v’ts
 = 
	`®loÿ
((*»v’tsè* 
Åfds
);

688 
”r
 = 
	`¢d_hùl_pŞl_desütÜs
(
hùl
, 
pfd
, 
Åfds
);

689 ià(
”r
 < 0)

690  
”r
;

691 ià(
”r
 !ğ
Åfds
) {

692 
	`SNDMSG
("šv®id…ŞÈdesütÜ %d", 
”r
);

693  -
EIO
;

696 
pŞlio
 = 0;

697 
”r_pŞl
 = 
	`pŞl
(
pfd
, 
Åfds
, 
timeout
);

698 ià(
”r_pŞl
 < 0) {

699 ià(
”ºo
 =ğ
EINTR
 && !
	`CTLINABORT
(
hùl
->
ùl
è&& !(hùl->ùl->
mode
 & 
SND_CTL_EINTR
))

701  -
”ºo
;

703 ià(! 
”r_pŞl
)

705 
”r
 = 
	`¢d_hùl_pŞl_desütÜs_»v’ts
(
hùl
, 
pfd
, 
Åfds
, 
»v’ts
);

706 ià(
”r
 < 0)

707  
”r
;

708 
i
 = 0; i < 
Åfds
; i++) {

709 ià(
»v’ts
[
i
] & (
POLLERR
 | 
POLLNVAL
))

710  -
EIO
;

711 ià((
»v’ts
[
i
] & (
POLLIN
 | 
POLLOUT
)) == 0)

713 
pŞlio
++;

715 } ! 
pŞlio
);

716  
”r_pŞl
 > 0 ? 1 : 0;

717 
	}
}

724 
¢d_ùl_t
 *
	$¢d_hùl_ùl
(
¢d_hùl_t
 *
hùl
)

726  
hùl
->
ùl
;

727 
	}
}

729 
	$¢d_hùl_hªdË_ev’t
(
¢d_hùl_t
 *
hùl
, 
¢d_ùl_ev’t_t
 *
ev’t
)

731 
¢d_hùl_–em_t
 *
–em
;

732 
»s
;

734 
	`as£¹
(
hùl
);

735 
	`as£¹
(
hùl
->
ùl
);

736 
ev’t
->
ty³
) {

737 
SND_CTL_EVENT_ELEM
:

742 ià(
ev’t
->
d©a
.
–em
.
mask
 =ğ
SNDRV_CTL_EVENT_MASK_REMOVE
) {

743 
dœ
;

744 
»s
 = 
	`_¢d_hùl_fšd_–em
(
hùl
, &
ev’t
->
d©a
.
–em
.
id
, &
dœ
);

745 ià(
»s
 < 0 || 
dœ
 != 0)

746  -
ENOENT
;

747 
	`¢d_hùl_–em_»move
(
hùl
, (è
»s
);

750 ià(
ev’t
->
d©a
.
–em
.
mask
 & 
SNDRV_CTL_EVENT_MASK_ADD
) {

751 
–em
 = 
	`ÿÎoc
(1, (
¢d_hùl_–em_t
));

752 ià(
–em
 =ğ
NULL
)

753  -
ENOMEM
;

754 
–em
->
id
 = 
ev’t
->
d©a
.elem.id;

755 
–em
->
hùl
 = hctl;

756 
»s
 = 
	`¢d_hùl_–em_add
(
hùl
, 
–em
);

757 ià(
»s
 < 0)

758  
»s
;

760 ià(
ev’t
->
d©a
.
–em
.
mask
 & (
SNDRV_CTL_EVENT_MASK_VALUE
 |

761 
SNDRV_CTL_EVENT_MASK_INFO
)) {

762 
–em
 = 
	`¢d_hùl_fšd_–em
(
hùl
, &
ev’t
->
d©a
.–em.
id
);

763 ià(!
–em
)

764  -
ENOENT
;

765 
»s
 = 
	`¢d_hùl_–em_throw_ev’t
(
–em
, 
ev’t
->
d©a
.–em.
mask
 &

766 (
SNDRV_CTL_EVENT_MASK_VALUE
 |

767 
SNDRV_CTL_EVENT_MASK_INFO
));

768 ià(
»s
 < 0)

769  
»s
;

772 
	}
}

779 
	$¢d_hùl_hªdË_ev’ts
(
¢d_hùl_t
 *
hùl
)

781 
¢d_ùl_ev’t_t
 
ev’t
;

782 
»s
;

783 
couÁ
 = 0;

785 
	`as£¹
(
hùl
);

786 
	`as£¹
(
hùl
->
ùl
);

787 (
»s
 = 
	`¢d_ùl_»ad
(
hùl
->
ùl
, &
ev’t
)) != 0 &&

788 
»s
 !ğ-
EAGAIN
) {

789 ià(
»s
 < 0)

790  
»s
;

791 
»s
 = 
	`¢d_hùl_hªdË_ev’t
(
hùl
, &
ev’t
);

792 ià(
»s
 < 0)

793  
»s
;

794 
couÁ
++;

796  
couÁ
;

797 
	}
}

805 
	$¢d_hùl_–em_šfo
(
¢d_hùl_–em_t
 *
–em
, 
¢d_ùl_–em_šfo_t
 *
šfo
)

807 
	`as£¹
(
–em
);

808 
	`as£¹
(
–em
->
hùl
);

809 
	`as£¹
(
šfo
);

810 
šfo
->
id
 = 
–em
->id;

811  
	`¢d_ùl_–em_šfo
(
–em
->
hùl
->
ùl
, 
šfo
);

812 
	}
}

820 
	$¢d_hùl_–em_»ad
(
¢d_hùl_–em_t
 *
–em
, 
¢d_ùl_–em_v®ue_t
 * 
v®ue
)

822 
	`as£¹
(
–em
);

823 
	`as£¹
(
–em
->
hùl
);

824 
	`as£¹
(
v®ue
);

825 
v®ue
->
id
 = 
–em
->id;

826  
	`¢d_ùl_–em_»ad
(
–em
->
hùl
->
ùl
, 
v®ue
);

827 
	}
}

837 
	$¢d_hùl_–em_wr™e
(
¢d_hùl_–em_t
 *
–em
, 
¢d_ùl_–em_v®ue_t
 * 
v®ue
)

839 
	`as£¹
(
–em
);

840 
	`as£¹
(
–em
->
hùl
);

841 
	`as£¹
(
v®ue
);

842 
v®ue
->
id
 = 
–em
->id;

843  
	`¢d_ùl_–em_wr™e
(
–em
->
hùl
->
ùl
, 
v®ue
);

844 
	}
}

853 
	$¢d_hùl_–em_v_»ad
(
¢d_hùl_–em_t
 *
–em
, *
v
, 
v_size
)

855 
	`as£¹
(
–em
);

856 
	`as£¹
(
v
);

857 
	`as£¹
(
v_size
 >= 12);

858  
	`¢d_ùl_–em_v_»ad
(
–em
->
hùl
->
ùl
, &–em->
id
, 
v
, 
v_size
);

859 
	}
}

869 
	$¢d_hùl_–em_v_wr™e
(
¢d_hùl_–em_t
 *
–em
, cÚ¡ *
v
)

871 
	`as£¹
(
–em
);

872 
	`as£¹
(
v
);

873 
	`as£¹
(
v
[
SNDRV_CTL_TLVO_LEN
] >= 4);

874  
	`¢d_ùl_–em_v_wr™e
(
–em
->
hùl
->
ùl
, &–em->
id
, 
v
);

875 
	}
}

885 
	$¢d_hùl_–em_v_commªd
(
¢d_hùl_–em_t
 *
–em
, cÚ¡ *
v
)

887 
	`as£¹
(
–em
);

888 
	`as£¹
(
v
);

889 
	`as£¹
(
v
[
SNDRV_CTL_TLVO_LEN
] >= 4);

890  
	`¢d_ùl_–em_v_commªd
(
–em
->
hùl
->
ùl
, &–em->
id
, 
v
);

891 
	}
}

898 
¢d_hùl_t
 *
	$¢d_hùl_–em_g‘_hùl
(
¢d_hùl_–em_t
 *
–em
)

900 
	`as£¹
(
–em
);

901  
–em
->
hùl
;

902 
	}
}

909 
	$¢d_hùl_–em_g‘_id
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
, 
¢d_ùl_–em_id_t
 *
±r
)

911 
	`as£¹
(
obj
 && 
±r
);

912 *
±r
 = 
obj
->
id
;

913 
	}
}

920 
	$¢d_hùl_–em_g‘_numid
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
)

922 
	`as£¹
(
obj
);

923  
obj
->
id
.
numid
;

924 
	}
}

931 
¢d_ùl_–em_içû_t
 
	$¢d_hùl_–em_g‘_š‹rçû
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
)

933 
	`as£¹
(
obj
);

934  
obj
->
id
.
içû
;

935 
	}
}

942 
	$¢d_hùl_–em_g‘_deviû
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
)

944 
	`as£¹
(
obj
);

945  
obj
->
id
.
deviû
;

946 
	}
}

953 
	$¢d_hùl_–em_g‘_subdeviû
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
)

955 
	`as£¹
(
obj
);

956  
obj
->
id
.
subdeviû
;

957 
	}
}

964 cÚ¡ *
	$¢d_hùl_–em_g‘_Çme
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
)

966 
	`as£¹
(
obj
);

967  (cÚ¡ *)
obj
->
id
.
Çme
;

968 
	}
}

975 
	$¢d_hùl_–em_g‘_šdex
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
)

977 
	`as£¹
(
obj
);

978  
obj
->
id
.
šdex
;

979 
	}
}

986 
	$¢d_hùl_–em_£t_ÿÎback
(
¢d_hùl_–em_t
 *
obj
, 
¢d_hùl_–em_ÿÎback_t
 
v®
)

988 
	`as£¹
(
obj
);

989 
obj
->
ÿÎback
 = 
v®
;

990 
	}
}

997 
	$¢d_hùl_–em_£t_ÿÎback_´iv©e
(
¢d_hùl_–em_t
 *
obj
, * 
v®
)

999 
	`as£¹
(
obj
);

1000 
obj
->
ÿÎback_´iv©e
 = 
v®
;

1001 
	}
}

1008 * 
	$¢d_hùl_–em_g‘_ÿÎback_´iv©e
(cÚ¡ 
¢d_hùl_–em_t
 *
obj
)

1010 
	`as£¹
(
obj
);

1011  
obj
->
ÿÎback_´iv©e
;

1012 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/namehint.c

29 
	~"loÿl.h
"

31 #iâdeà
DOC_HIDDEN


32 
	#DEV_SKIP
 9999

	)

33 
	shšt_li¡
 {

34 **
	mli¡
;

35 
	mcouÁ
;

36 
	m®loÿ‹d
;

37 cÚ¡ *
	msiçû
;

38 
¢d_ùl_–em_içû_t
 
	miçû
;

39 
¢d_ùl_t
 *
	mùl
;

40 
¢d_ùl_ÿrd_šfo_t
 *
	mšfo
;

41 
	mÿrd
;

42 
	mdeviû
;

43 
	mdeviû_šput
;

44 
	mdeviû_ouut
;

45 
	m¡»am
;

46 
	mshow_®l
;

47 *
	mÿrdÇme
;

51 
	$hšt_li¡_add
(
hšt_li¡
 *
li¡
,

52 cÚ¡ *
Çme
,

53 cÚ¡ *
desütiÚ
)

55 *
x
;

57 ià(
li¡
->
couÁ
 + 1 >ğli¡->
®loÿ‹d
) {

58 **
n
 = 
	`»®loc
(
li¡
->li¡, (li¡->
®loÿ‹d
 + 10) * (*));

59 ià(
n
 =ğ
NULL
)

60  -
ENOMEM
;

61 
	`mem£t
(
n
 + 
li¡
->
®loÿ‹d
, 0, 10 * (*n));

62 
li¡
->
®loÿ‹d
 += 10;

63 
li¡
->li¡ = 
n
;

65 ià(
Çme
 =ğ
NULL
) {

66 
x
 = 
NULL
;

68 
x
 = 
	`m®loc
(4 + 
	`¡¾’
(
Çme
è+ (
desütiÚ
 !ğ
NULL
 ? (4 + strlen(description) + 1) : 0) + 1);

69 ià(
x
 =ğ
NULL
)

70  -
ENOMEM
;

71 
	`memıy
(
x
, "NAME", 4);

72 
	`¡rıy
(
x
 + 4, 
Çme
);

73 ià(
desütiÚ
 !ğ
NULL
) {

74 
	`¡rÿt
(
x
, "|DESC");

75 
	`¡rÿt
(
x
, 
desütiÚ
);

78 
li¡
->li¡[li¡->
couÁ
++] = 
x
;

80 
	}
}

85 
	$hšt_li¡_add_cu¡om
(
hšt_li¡
 *
li¡
,

86 cÚ¡ *
’Œy
)

88 
”r
;

89 cÚ¡ *
£p
;

90 *
Çme
;

92 
	`as£¹
(
’Œy
);

94 
£p
 = 
	`¡rchr
(
’Œy
, '|');

95 ià(
£p
 =ğ
NULL
)

96  
	`hšt_li¡_add
(
li¡
, 
’Œy
, 
NULL
);

98 
Çme
 = 
	`¡ºdup
(
’Œy
, 
£p
 -ƒntry);

99 ià(
Çme
 =ğ
NULL
)

100  -
ENOMEM
;

102 
”r
 = 
	`hšt_li¡_add
(
li¡
, 
Çme
, 
£p
 + 1);

103 
	`ä“
(
Çme
);

104  
”r
;

105 
	}
}

107 
	$z”o_hªdËr
(cÚ¡ *
fe
 
ATTRIBUTE_UNUSED
,

108 
lše
 
ATTRIBUTE_UNUSED
,

109 cÚ¡ *
funùiÚ
 
ATTRIBUTE_UNUSED
,

110 
”r
 
ATTRIBUTE_UNUSED
,

111 cÚ¡ *
fmt
 
ATTRIBUTE_UNUSED
,

112 
va_li¡
 
¬g
 
ATTRIBUTE_UNUSED
)

114 
	}
}

116 
	$g‘_dev_Çme1
(
hšt_li¡
 *
li¡
, **
»s
, 
deviû
,

117 
¡»am
)

119 *
»s
 = 
NULL
;

120 ià(
deviû
 < 0 || deviû =ğ
DEV_SKIP
)

122 
li¡
->
içû
) {

123 #ifdeà
BUILD_HWDEP


124 
SND_CTL_ELEM_IFACE_HWDEP
:

126 
¢d_hwd•_šfo_t
 
šfo
 = {0};

127 
	`¢d_hwd•_šfo_£t_deviû
(&
šfo
, 
deviû
);

128 ià(
	`¢d_ùl_hwd•_šfo
(
li¡
->
ùl
, &
šfo
) < 0)

130 *
»s
 = 
	`¡rdup
(
	`¢d_hwd•_šfo_g‘_Çme
(&
šfo
));

134 #ifdeà
BUILD_PCM


135 
SND_CTL_ELEM_IFACE_PCM
:

137 
¢d_pcm_šfo_t
 
šfo
 = {0};

138 
	`¢d_pcm_šfo_£t_deviû
(&
šfo
, 
deviû
);

139 
	`¢d_pcm_šfo_£t_¡»am
(&
šfo
, 
¡»am
 ? 
SND_PCM_STREAM_CAPTURE
 : 
SND_PCM_STREAM_PLAYBACK
);

140 ià(
	`¢d_ùl_pcm_šfo
(
li¡
->
ùl
, &
šfo
) < 0)

142 
	`¢d_pcm_šfo_g‘_şass
(&
šfo
)) {

143 
SND_PCM_CLASS_MODEM
:

144 
SND_PCM_CLASS_DIGITIZER
:

145  -
ENODEV
;

149 *
»s
 = 
	`¡rdup
(
	`¢d_pcm_šfo_g‘_Çme
(&
šfo
));

153 #ifdeà
BUILD_RAWMIDI


154 
SND_CTL_ELEM_IFACE_RAWMIDI
:

156 
¢d_¿wmidi_šfo_t
 
šfo
 = {0};

157 
	`¢d_¿wmidi_šfo_£t_deviû
(&
šfo
, 
deviû
);

158 
	`¢d_¿wmidi_šfo_£t_¡»am
(&
šfo
, 
¡»am
 ? 
SND_RAWMIDI_STREAM_INPUT
 : 
SND_RAWMIDI_STREAM_OUTPUT
);

159 ià(
	`¢d_ùl_¿wmidi_šfo
(
li¡
->
ùl
, &
šfo
) < 0)

161 *
»s
 = 
	`¡rdup
(
	`¢d_¿wmidi_šfo_g‘_Çme
(&
šfo
));

168 
	}
}

170 *
	$g‘_dev_Çme
(
hšt_li¡
 *
li¡
)

172 *
¡r1
, *
¡r2
, *
»s
;

173 
deviû
;

175 
deviû
 = 
li¡
->
deviû_šput
 >= 0 ?†ist->device_input :†ist->device;

176 ià(
	`g‘_dev_Çme1
(
li¡
, &
¡r1
, 
deviû
, 1) < 0)

177  
NULL
;

178 
deviû
 = 
li¡
->
deviû_ouut
 >= 0 ?†ist->device_output :†ist->device;

179 ià(
	`g‘_dev_Çme1
(
li¡
, &
¡r2
, 
deviû
, 0) < 0) {

180 ià(
¡r1
)

181 
	`ä“
(
¡r1
);

182  
NULL
;

184 ià(
¡r1
 !ğ
NULL
 || 
¡r2
 != NULL) {

185 ià(
¡r1
 !ğ
NULL
 && 
¡r2
 != NULL) {

186 ià(
	`¡rcmp
(
¡r1
, 
¡r2
) == 0) {

187 
»s
 = 
	`m®loc
(
	`¡¾’
(
li¡
->
ÿrdÇme
è+ sŒËn(
¡r2
) + 3);

188 ià(
»s
 !ğ
NULL
) {

189 
	`¡rıy
(
»s
, 
li¡
->
ÿrdÇme
);

190 
	`¡rÿt
(
»s
, ", ");

191 
	`¡rÿt
(
»s
, 
¡r2
);

194 
»s
 = 
	`m®loc
(
	`¡¾’
(
li¡
->
ÿrdÇme
è+ sŒËn(
¡r2
è+ sŒËn(
¡r1
) + 6);

195 ià(
»s
 !ğ
NULL
) {

196 
	`¡rıy
(
»s
, 
li¡
->
ÿrdÇme
);

197 
	`¡rÿt
(
»s
, ", ");

198 
	`¡rÿt
(
»s
, 
¡r2
);

199 
	`¡rÿt
(
»s
, " / ");

200 
	`¡rÿt
(
»s
, 
¡r1
);

203 
	`ä“
(
¡r2
);

204 
	`ä“
(
¡r1
);

205  
»s
;

207 ià(
¡r1
 !ğ
NULL
) {

208 
¡r2
 = "Input";

210 
¡r1
 = 
¡r2
;

211 
¡r2
 = "Output";

213 
»s
 = 
	`m®loc
(
	`¡¾’
(
li¡
->
ÿrdÇme
è+ sŒËn(
¡r1
) + 19);

214 ià(
»s
 =ğ
NULL
) {

215 
	`ä“
(
¡r1
);

216  
NULL
;

218 
	`¡rıy
(
»s
, 
li¡
->
ÿrdÇme
);

219 
	`¡rÿt
(
»s
, ", ");

220 
	`¡rÿt
(
»s
, 
¡r1
);

221 
	`¡rÿt
(
»s
, "|IOID");

222 
	`¡rÿt
(
»s
, 
¡r2
);

223 
	`ä“
(
¡r1
);

224  
»s
;

228 ià(
li¡
->
deviû
 >ğ0 ||†i¡->
deviû_šput
 >ğ0 ||†i¡->
deviû_ouut
 >= 0)

229  
NULL
;

230  
	`¡rdup
(
li¡
->
ÿrdÇme
);

231 
	}
}

233 #iâdeà
DOC_HIDDEN


234 
	#BUF_SIZE
 128

	)

237 
	$Œy_cÚfig
(
¢d_cÚfig_t
 *
cÚfig
,

238 
hšt_li¡
 *
li¡
,

239 cÚ¡ *
ba£
,

240 cÚ¡ *
Çme
)

242 
¢d_loÿl_”rÜ_hªdËr_t
 
eh
;

243 
¢d_cÚfig_t
 *
»s
 = 
NULL
, *
cfg
, *
cfg1
, *
n
;

244 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

245 *
buf
, *
buf1
 = 
NULL
, *
buf2
;

246 cÚ¡ *
¡r
;

247 
”r
 = 0, 
Ëv–
;

248 
dev
 = 
li¡
->
deviû
;

249 
ş—nup_»s
 = 0;

251 
li¡
->
deviû_šput
 = -1;

252 
li¡
->
deviû_ouut
 = -1;

253 
buf
 = 
	`m®loc
(
BUF_SIZE
);

254 ià(
buf
 =ğ
NULL
)

255  -
ENOMEM
;

256 
	`¥rštf
(
buf
, "%s.%s", 
ba£
, 
Çme
);

258 ià(
	`¢d_cÚfig_£¬ch
(
cÚfig
, 
buf
, &
cfg
) >= 0 &&

259 
	`¢d_cÚfig_g‘_¡ršg
(
cfg
, &
¡r
) >= 0 &&

260 ((
	`¡ºcmp
(
ba£
, 
¡r
, 
	`¡¾’
(base)) == 0 &&

261 
¡r
[
	`¡¾’
(
ba£
)] =ğ'.'è|| 
	`¡rchr
(¡r, '.'è=ğ
NULL
))

262 
__sk_add
;

263 ià(
li¡
->
ÿrd
 >ğ0 &&†i¡->
deviû
 >= 0)

264 
	`¥rštf
(
buf
, "%s:CARD=%s,DEV=%i", 
Çme
, 
	`¢d_ùl_ÿrd_šfo_g‘_id
(
li¡
->
šfo
),†i¡->
deviû
);

265 ià(
li¡
->
ÿrd
 >= 0)

266 
	`¥rštf
(
buf
, "%s:CARD=%s", 
Çme
, 
	`¢d_ùl_ÿrd_šfo_g‘_id
(
li¡
->
šfo
));

268 
	`¡rıy
(
buf
, 
Çme
);

269 
eh
 = 
	`¢d_lib_”rÜ_£t_loÿl
(&
z”o_hªdËr
);

270 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
cÚfig
, 
ba£
, 
buf
, &
»s
);

271 
	`¢d_lib_”rÜ_£t_loÿl
(
eh
);

272 ià(
”r
 < 0)

273 
__sk_add
;

274 
ş—nup_»s
 = 1;

275 
”r
 = -
EINVAL
;

276 ià(
	`¢d_cÚfig_g‘_ty³
(
»s
è!ğ
SND_CONFIG_TYPE_COMPOUND
)

277 
__ş—nup
;

278 ià(
	`¢d_cÚfig_£¬ch
(
»s
, "ty³", 
NULL
) < 0)

279 
__ş—nup
;

283 
¢d_ouut_t
 *
out
;

284 
	`årštf
(
¡d”r
, "********* PCM '%s':\n", 
buf
);

285 
	`¢d_ouut_¡dio_©ch
(&
out
, 
¡d”r
, 0);

286 
	`¢d_cÚfig_§ve
(
»s
, 
out
);

287 
	`¢d_ouut_şo£
(
out
);

288 
	`årštf
(
¡d”r
, "\n");

292 
cfg1
 = 
»s
;

293 
Ëv–
 = 0;

294 
__hšt
:

295 
Ëv–
++;

296 ià(
	`¢d_cÚfig_£¬ch
(
cfg1
, "ty³", &
cfg
) >= 0 &&

297 
	`¢d_cÚfig_g‘_¡ršg
(
cfg
, &
¡r
) >= 0 &&

298 
	`¡rcmp
(
¡r
, "hw") == 0) {

299 ià(
	`¢d_cÚfig_£¬ch
(
cfg1
, "deviû", &
cfg
) >= 0) {

300 ià(
	`¢d_cÚfig_g‘_š‹g”
(
cfg
, &
dev
) < 0) {

301 
	`SNDERR
("(%sèdeviû mu¡ bª iÁeg”", 
buf
);

302 
”r
 = -
EINVAL
;

303 
__ş—nup
;

308 ià(
	`¢d_cÚfig_£¬ch
(
cfg1
, "hšt", &
cfg
) >= 0) {

309 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

310 
	`SNDERR
("hšˆ(%sèmu¡ b¨compound", 
buf
);

311 
”r
 = -
EINVAL
;

312 
__ş—nup
;

314 ià(
li¡
->
ÿrd
 < 0 &&

315 
	`¢d_cÚfig_£¬ch
(
cfg
, "om™_nßrgs", &
n
) >= 0 &&

316 
	`¢d_cÚfig_g‘_boŞ
(
n
) > 0)

317 
__sk_add
;

318 ià(
Ëv–
 == 1 &&

319 
	`¢d_cÚfig_£¬ch
(
cfg
, "show", &
n
) >= 0 &&

320 
	`¢d_cÚfig_g‘_boŞ
(
n
) <= 0)

321 
__sk_add
;

322 ià(
buf1
 =ğ
NULL
 &&

323 
	`¢d_cÚfig_£¬ch
(
cfg
, "desütiÚ", &
n
) >= 0 &&

324 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
) >= 0) {

325 
buf1
 = 
	`¡rdup
(
¡r
);

326 ià(
buf1
 =ğ
NULL
) {

327 
”r
 = -
ENOMEM
;

328 
__ş—nup
;

331 ià(
	`¢d_cÚfig_£¬ch
(
cfg
, "deviû", &
n
) >= 0) {

332 ià(
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
dev
) < 0) {

333 
	`SNDERR
("(%sèdeviû mu¡ bª iÁeg”", 
buf
);

334 
”r
 = -
EINVAL
;

335 
__ş—nup
;

337 
li¡
->
deviû_šput
 = 
dev
;

338 
li¡
->
deviû_ouut
 = 
dev
;

340 ià(
	`¢d_cÚfig_£¬ch
(
cfg
, "deviû_šput", &
n
) >= 0) {

341 ià(
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
li¡
->
deviû_šput
) < 0) {

342 
	`SNDERR
("(%sèdeviû_špuˆmu¡ bª iÁeg”", 
buf
);

343 
”r
 = -
EINVAL
;

344 
__ş—nup
;

347 ià(
li¡
->
deviû_ouut
 < 0)

348 
li¡
->
deviû_ouut
 = 
DEV_SKIP
;

350 ià(
	`¢d_cÚfig_£¬ch
(
cfg
, "deviû_ouut", &
n
) >= 0) {

351 ià(
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
li¡
->
deviû_ouut
) < 0) {

352 
	`SNDERR
("(%sèdeviû_ouuˆmu¡ bª iÁeg”", 
buf
);

353 
”r
 = -
EINVAL
;

354 
__ş—nup
;

357 ià(
li¡
->
deviû_šput
 < 0)

358 
li¡
->
deviû_šput
 = 
DEV_SKIP
;

360 } ià(
Ëv–
 =ğ1 && !
li¡
->
show_®l
)

361 
__sk_add
;

362 ià(
	`¢d_cÚfig_£¬ch
(
cfg1
, "¦ave", &
cfg
) >= 0 &&

363 
	`¢d_cÚfig_£¬ch
(
cfg
, 
ba£
, &
cfg1
) >= 0)

364 
__hšt
;

365 
	`¢d_cÚfig_d–‘e
(
»s
);

366 
»s
 = 
NULL
;

367 
ş—nup_»s
 = 0;

368 ià(
	`¡rchr
(
buf
, ':'è!ğ
NULL
)

369 
__ok
;

372 
eh
 = 
	`¢d_lib_”rÜ_£t_loÿl
(&
z”o_hªdËr
);

373 
”r
 = 
	`¢d_cÚfig_£¬ch_®Ÿs_hooks
(
cÚfig
, 
ba£
, 
buf
, &
»s
);

374 
	`¢d_lib_”rÜ_£t_loÿl
(
eh
);

375 ià(
”r
 < 0)

376 
__ş—nup
;

377 ià(
	`¢d_cÚfig_£¬ch
(
»s
, "@¬gs", &
cfg
) >= 0) {

378 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

380 ià(
	`¢d_cÚfig_g‘_id
(
	`¢d_cÚfig_™”©Ü_’Œy
(
i
), &
¡r
) < 0)

382 *
¡r
 && *str >= '0' && *str <= '9') str++;

383 ià(*
¡r
 == '\0')

386 ià(
	`¢d_cÚfig_£¬ch
(
	`¢d_cÚfig_™”©Ü_’Œy
(
i
),

387 "deçuÉ", 
NULL
) < 0) {

388 
”r
 = -
EINVAL
;

389 
__ş—nup
;

393 
__ok
:

394 
”r
 = 0;

395 
__ş—nup
:

396 ià(
”r
 >= 0) {

397 
li¡
->
deviû
 = 
dev
;

398 
¡r
 = 
li¡
->
ÿrd
 >ğ0 ? 
	`g‘_dev_Çme
Öi¡è: 
NULL
;

399 ià(
¡r
 !ğ
NULL
) {

400 
Ëv–
 = (
buf1
 =ğ
NULL
 ? 0 : 
	`¡¾’
(buf1)è+ 1 + sŒËn(
¡r
);

401 
buf2
 = 
	`»®loc
((*)
¡r
, 
Ëv–
 + 1);

402 ià(
buf2
 !ğ
NULL
) {

403 ià(
buf1
 !ğ
NULL
) {

404 
¡r
 = 
	`¡rchr
(
buf2
, '|');

405 ià(
¡r
 !ğ
NULL
)

406 
	`memmove
(
buf2
 + (
Ëv–
 - 
	`¡¾’
(
¡r
)), str, strlen(str));

408 
¡r
 = 
buf2
 + 
	`¡¾’
(buf2);

409 *(*)
¡r
++ = '\n';

410 
	`memıy
((*)
¡r
, 
buf1
, 
	`¡¾’
(buf1));

411 
buf2
[
Ëv–
] = '\0';

412 
	`ä“
(
buf1
);

414 
buf1
 = 
buf2
;

416 
	`ä“
((*)
¡r
);

418 } ià(
li¡
->
deviû
 >= 0)

419 
__sk_add
;

420 
”r
 = 
	`hšt_li¡_add
(
li¡
, 
buf
, 
buf1
);

422 
__sk_add
:

423 ià(
»s
 && 
ş—nup_»s
)

424 
	`¢d_cÚfig_d–‘e
(
»s
);

425 ià(
buf1
)

426 
	`ä“
(
buf1
);

427 
	`ä“
(
buf
);

428  
”r
;

429 
	}
}

431 #iâdeà
DOC_HIDDEN


432 
	#IFACE
(
v
, 
fú
è[
SND_CTL_ELEM_IFACE_
##v] = (
Ãxt_deviûs_t
)
	)
fcn

434 (*
	tÃxt_deviûs_t
)(
	t¢d_ùl_t
 *, *);

436 cÚ¡ 
Ãxt_deviûs_t
 
Ãxt_deviûs
[] = {

437 
	`IFACE
(
CARD
, 
NULL
),

438 
	`IFACE
(
HWDEP
, 
¢d_ùl_hwd•_Ãxt_deviû
),

439 
	`IFACE
(
MIXER
, 
NULL
),

440 
	`IFACE
(
PCM
, 
¢d_ùl_pcm_Ãxt_deviû
),

441 
	`IFACE
(
RAWMIDI
, 
¢d_ùl_¿wmidi_Ãxt_deviû
),

442 
	`IFACE
(
TIMER
, 
NULL
),

443 
	`IFACE
(
SEQUENCER
, 
NULL
)

444 
	}
};

447 
	$add_ÿrd
(
¢d_cÚfig_t
 *
cÚfig
, snd_cÚfig_ˆ*
rw_cÚfig
, 
hšt_li¡
 *
li¡
, 
ÿrd
)

449 
”r
, 
ok
;

450 
¢d_cÚfig_t
 *
cÚf
, *
n
;

451 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

452 cÚ¡ *
¡r
;

453 
ùl_Çme
[16];

454 
¢d_ùl_ÿrd_šfo_t
 
šfo
 = {0};

455 
deviû
, 
max_deviû
 = 0;

457 
li¡
->
šfo
 = &info;

458 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cÚfig
, 
li¡
->
siçû
, &
cÚf
);

459 ià(
”r
 < 0)

460  
”r
;

461 
	`¥rštf
(
ùl_Çme
, "hw:%i", 
ÿrd
);

462 
”r
 = 
	`¢d_ùl_İ’
(&
li¡
->
ùl
, 
ùl_Çme
, 0);

463 ià(
”r
 < 0)

464  
”r
;

465 
”r
 = 
	`¢d_ùl_ÿrd_šfo
(
li¡
->
ùl
, &
šfo
);

466 ià(
”r
 < 0)

467 
__”rÜ
;

468 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

469 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

470 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
¡r
) < 0)

473 ià(
Ãxt_deviûs
[
li¡
->
içû
] !ğ
NULL
) {

474 
li¡
->
ÿrd
 = card;

475 
deviû
 = 
max_deviû
 = -1;

476 
”r
 = 
Ãxt_deviûs
[
li¡
->
içû
]Öi¡->
ùl
, &
deviû
);

477 ià(
deviû
 < 0)

478 
”r
 = -
EINVAL
;

480 
max_deviû
 = 
deviû
;

481 
”r
 >ğ0 && 
deviû
 >= 0) {

482 
”r
 = 
Ãxt_deviûs
[
li¡
->
içû
]Öi¡->
ùl
, &
deviû
);

483 ià(
”r
 >ğ0 && 
deviû
 > 
max_deviû
)

484 
max_deviû
 = 
deviû
;

486 
ok
 = 0;

487 
deviû
 = 0; 
”r
 >ğ0 && deviû <ğ
max_deviû
; device++) {

488 
li¡
->
deviû
 = device;

489 
”r
 = 
	`Œy_cÚfig
(
rw_cÚfig
, 
li¡
,†i¡->
siçû
, 
¡r
);

490 ià(
”r
 < 0)

492 
ok
++;

494 ià(
ok
)

497 
”r
 = -
EINVAL
;

499 ià(
”r
 =ğ-
EXDEV
)

501 ià(
”r
 < 0) {

502 
li¡
->
ÿrd
 = card;

503 
li¡
->
deviû
 = -1;

504 
”r
 = 
	`Œy_cÚfig
(
rw_cÚfig
, 
li¡
,†i¡->
siçû
, 
¡r
);

506 ià(
”r
 =ğ-
ENOMEM
)

507 
__”rÜ
;

509 
”r
 = 0;

510 
__”rÜ
:

511 
	`¢d_ùl_şo£
(
li¡
->
ùl
);

512  
”r
;

513 
	}
}

515 
	$g‘_ÿrd_Çme
(
hšt_li¡
 *
li¡
, 
ÿrd
)

517 
sÿrd
[16], *
s
;

518 
”r
;

520 
	`ä“
(
li¡
->
ÿrdÇme
);

521 
li¡
->
ÿrdÇme
 = 
NULL
;

522 
”r
 = 
	`¢d_ÿrd_g‘_Çme
(
ÿrd
, &
li¡
->
ÿrdÇme
);

523 ià(
”r
 <= 0)

525 
	`¥rštf
(
sÿrd
, " #%i", 
ÿrd
);

526 
s
 = 
	`»®loc
(
li¡
->
ÿrdÇme
, 
	`¡¾’
Öi¡->ÿrdÇmeè+ sŒËn(
sÿrd
) + 1);

527 ià(
s
 =ğ
NULL
)

528  -
ENOMEM
;

529 
li¡
->
ÿrdÇme
 = 
s
;

531 
	}
}

533 
	$add_soáw¬e_deviûs
(
¢d_cÚfig_t
 *
cÚfig
, snd_cÚfig_ˆ*
rw_cÚfig
,

534 
hšt_li¡
 *
li¡
)

536 
”r
;

537 
¢d_cÚfig_t
 *
cÚf
, *
n
;

538 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

539 cÚ¡ *
¡r
;

541 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cÚfig
, 
li¡
->
siçû
, &
cÚf
);

542 ià(
”r
 < 0)

543  
”r
;

544 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

545 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

546 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
¡r
) < 0)

548 
li¡
->
ÿrd
 = -1;

549 
li¡
->
deviû
 = -1;

550 
”r
 = 
	`Œy_cÚfig
(
rw_cÚfig
, 
li¡
,†i¡->
siçû
, 
¡r
);

551 ià(
”r
 =ğ-
ENOMEM
)

552  -
ENOMEM
;

555 
	}
}

583 
	$¢d_deviû_Çme_hšt
(
ÿrd
, cÚ¡ *
içû
, ***
hšts
)

585 
hšt_li¡
 
li¡
;

586 
ehšts
[24];

587 cÚ¡ *
¡r
;

588 
¢d_cÚfig_t
 *
cÚf
, *
loÿl_cÚfig
 = 
NULL
, *
loÿl_cÚfig_rw
 = NULL;

589 
¢d_cÚfig_upd©e_t
 *
loÿl_cÚfig_upd©e
 = 
NULL
;

590 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

591 
”r
;

593 ià(
hšts
 =ğ
NULL
)

594  -
EINVAL
;

595 
”r
 = 
	`¢d_cÚfig_upd©e_r
(&
loÿl_cÚfig
, &
loÿl_cÚfig_upd©e
, 
NULL
);

596 ià(
”r
 < 0)

597  
”r
;

598 
”r
 = 
	`¢d_cÚfig_cİy
(&
loÿl_cÚfig_rw
, 
loÿl_cÚfig
);

599 ià(
”r
 < 0)

600  
”r
;

601 
li¡
.li¡ = 
NULL
;

602 
li¡
.
couÁ
 =†i¡.
®loÿ‹d
 = 0;

603 
li¡
.
siçû
 = 
içû
;

604 
li¡
.
show_®l
 = 0;

605 
li¡
.
ÿrdÇme
 = 
NULL
;

606 ià(
	`¡rcmp
(
içû
, "pcm") == 0)

607 
li¡
.
içû
 = 
SND_CTL_ELEM_IFACE_PCM
;

608 ià(
	`¡rcmp
(
içû
, "rawmidi") == 0)

609 
li¡
.
içû
 = 
SND_CTL_ELEM_IFACE_RAWMIDI
;

610 ià(
	`¡rcmp
(
içû
, "timer") == 0)

611 
li¡
.
içû
 = 
SND_CTL_ELEM_IFACE_TIMER
;

612 ià(
	`¡rcmp
(
içû
, "seq") == 0)

613 
li¡
.
içû
 = 
SND_CTL_ELEM_IFACE_SEQUENCER
;

614 ià(
	`¡rcmp
(
içû
, "hwdep") == 0)

615 
li¡
.
içû
 = 
SND_CTL_ELEM_IFACE_HWDEP
;

616 ià(
	`¡rcmp
(
içû
, "ctl") == 0)

617 
li¡
.
içû
 = 
SND_CTL_ELEM_IFACE_MIXER
;

619 
”r
 = -
EINVAL
;

620 
__”rÜ
;

623 ià(
	`¢d_cÚfig_£¬ch
(
loÿl_cÚfig
, "deçuÉs.Çmehšt.show®l", &
cÚf
) >= 0)

624 
li¡
.
show_®l
 = 
	`¢d_cÚfig_g‘_boŞ
(
cÚf
) > 0;

625 ià(
ÿrd
 >= 0) {

626 
”r
 = 
	`g‘_ÿrd_Çme
(&
li¡
, 
ÿrd
);

627 ià(
”r
 >= 0)

628 
”r
 = 
	`add_ÿrd
(
loÿl_cÚfig
, 
loÿl_cÚfig_rw
, &
li¡
, 
ÿrd
);

630 
	`add_soáw¬e_deviûs
(
loÿl_cÚfig
, 
loÿl_cÚfig_rw
, &
li¡
);

631 
”r
 = 
	`¢d_ÿrd_Ãxt
(&
ÿrd
);

632 ià(
”r
 < 0)

633 
__”rÜ
;

634 
ÿrd
 >= 0) {

635 
”r
 = 
	`g‘_ÿrd_Çme
(&
li¡
, 
ÿrd
);

636 ià(
”r
 < 0)

637 
__”rÜ
;

638 
”r
 = 
	`add_ÿrd
(
loÿl_cÚfig
, 
loÿl_cÚfig_rw
, &
li¡
, 
ÿrd
);

639 ià(
”r
 < 0)

640 
__”rÜ
;

641 
”r
 = 
	`¢d_ÿrd_Ãxt
(&
ÿrd
);

642 ià(
”r
 < 0)

643 
__”rÜ
;

646 
	`¥rštf
(
ehšts
, "Çmehšt.%s", 
li¡
.
siçû
);

647 
”r
 = 
	`¢d_cÚfig_£¬ch
(
loÿl_cÚfig
, 
ehšts
, &
cÚf
);

648 ià(
”r
 >= 0) {

649 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

650 ià(
	`¢d_cÚfig_g‘_¡ršg
(
	`¢d_cÚfig_™”©Ü_’Œy
(
i
),

651 &
¡r
) < 0)

653 
”r
 = 
	`hšt_li¡_add_cu¡om
(&
li¡
, 
¡r
);

654 ià(
”r
 < 0)

655 
__”rÜ
;

658 
”r
 = 0;

659 
__”rÜ
:

663 ià(!
”r
 && !
li¡
.list)

664 
”r
 = 
	`hšt_li¡_add
(&
li¡
, 
NULL
, NULL);

665 ià(
”r
 < 0)

666 
	`¢d_deviû_Çme_ä“_hšt
((**)
li¡
.list);

668 *
hšts
 = (**)
li¡
.list;

669 
	`ä“
(
li¡
.
ÿrdÇme
);

670 ià(
loÿl_cÚfig_rw
)

671 
	`¢d_cÚfig_d–‘e
(
loÿl_cÚfig_rw
);

672 ià(
loÿl_cÚfig
)

673 
	`¢d_cÚfig_d–‘e
(
loÿl_cÚfig
);

674 ià(
loÿl_cÚfig_upd©e
)

675 
	`¢d_cÚfig_upd©e_ä“
(
loÿl_cÚfig_upd©e
);

676  
”r
;

677 
	}
}

684 
	$¢d_deviû_Çme_ä“_hšt
(**
hšts
)

686 **
h
;

688 ià(
hšts
 =ğ
NULL
)

690 
h
 = (**)
hšts
;

691 *
h
) {

692 
	`ä“
(*
h
);

693 
h
++;

695 
	`ä“
(
hšts
);

697 
	}
}

712 *
	$¢d_deviû_Çme_g‘_hšt
(cÚ¡ *
hšt
, cÚ¡ *
id
)

714 cÚ¡ *
hšt1
 = (cÚ¡ *)
hšt
, *
d–im
;

715 *
»s
;

716 
size
;

718 ià(
	`¡¾’
(
id
) != 4)

719  
NULL
;

720 *
hšt1
 != '\0') {

721 
d–im
 = 
	`¡rchr
(
hšt1
, '|');

722 ià(
	`memcmp
(
id
, 
hšt1
, 4) != 0) {

723 ià(
d–im
 =ğ
NULL
)

724  
NULL
;

725 
hšt1
 = 
d–im
 + 1;

728 ià(
d–im
 =ğ
NULL
)

729  
	`¡rdup
(
hšt1
 + 4);

730 
size
 = 
d–im
 - 
hšt1
 - 4;

731 
»s
 = 
	`m®loc
(
size
 + 1);

732 ià(
»s
 !ğ
NULL
) {

733 
	`memıy
(
»s
, 
hšt1
 + 4, 
size
);

734 
»s
[
size
] = '\0';

736  
»s
;

738  
NULL
;

739 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/setup.c

32 
	~"loÿl.h
"

33 
	~<¡dio.h
>

34 
	~<¡dlib.h
>

35 
	~<¡d¬g.h
>

36 
	~<uni¡d.h
>

37 
	~<¡ršg.h
>

38 
	~<ùy³.h
>

40 #iâdeà
DOC_HIDDEN


42 
	mlock
: 1;

43 
	m´e£rve
: 1;

44 
¢d_ùl_–em_id_t
 *
	mid
;

45 
¢d_ùl_–em_šfo_t
 *
	mšfo
;

46 
¢d_ùl_–em_v®ue_t
 *
	mv®
;

47 
¢d_ùl_–em_v®ue_t
 *
	mmask
;

48 
¢d_ùl_–em_v®ue_t
 *
	mŞd
;

49 
li¡_h—d
 
	mli¡
;

50 } 
	t¢d_sùl_–em_t
;

52 
	s_¢d_sùl
 {

53 
	mmode
;

54 
¢d_ùl_t
 *
	mùl
;

55 
li¡_h—d
 
	m–ems
;

59 
	$ä“_–ems
(
¢d_sùl_t
 *
h
)

61 
”r
 = 0;

62 !
	`li¡_em±y
(&
h
->
–ems
)) {

63 
¢d_sùl_–em_t
 *
–em
 = 
	`li¡_’Œy
(
h
->
–ems
.
Ãxt
, snd_sùl_–em_t, 
li¡
);

64 
	`¢d_ùl_–em_id_ä“
(
–em
->
id
);

65 
	`¢d_ùl_–em_šfo_ä“
(
–em
->
šfo
);

66 
	`¢d_ùl_–em_v®ue_ä“
(
–em
->
v®
);

67 
	`¢d_ùl_–em_v®ue_ä“
(
–em
->
mask
);

68 
	`¢d_ùl_–em_v®ue_ä“
(
–em
->
Şd
);

69 
	`li¡_d–
(&
–em
->
li¡
);

70 
	`ä“
(
–em
);

72 ià((
h
->
mode
 & 
SND_SCTL_NOFREE
) == 0)

73 
”r
 = 
	`¢d_ùl_şo£
(
h
->
ùl
);

74 
	`ä“
(
h
);

75  
”r
;

76 
	}
}

83 
	$¢d_sùl_š¡®l
(
¢d_sùl_t
 *
h
)

85 
li¡_h—d
 *
pos
;

86 
”r
;

87 
k
;

88 
	`as£¹
(
h
);

89 
	`li¡_fÜ_—ch
(
pos
, &
h
->
–ems
) {

90 
¢d_sùl_–em_t
 *
–em
 = 
	`li¡_’Œy
(
pos
, snd_sùl_–em_t, 
li¡
);

91 
couÁ
;

92 
¢d_ùl_–em_ty³_t
 
ty³
;

93 ià(
–em
->
lock
) {

94 
”r
 = 
	`¢d_ùl_–em_lock
(
h
->
ùl
, 
–em
->
id
);

95 ià(
”r
 < 0) {

96 
	`SNDERR
("Cannot†ock ctlƒlem");

97  
”r
;

100 
”r
 = 
	`¢d_ùl_–em_»ad
(
h
->
ùl
, 
–em
->
Şd
);

101 ià(
”r
 < 0) {

102 
	`SNDERR
("Cannot„ead ctlƒlem");

103  
”r
;

105 
couÁ
 = 
	`¢d_ùl_–em_šfo_g‘_couÁ
(
–em
->
šfo
);

106 
ty³
 = 
	`¢d_ùl_–em_šfo_g‘_ty³
(
–em
->
šfo
);

107 
ty³
) {

108 
SND_CTL_ELEM_TYPE_BOOLEAN
:

109 
k
 = 0; k < 
couÁ
; ++k) {

110 
Şd
, 
v®
, 
mask
;

111 
Şd
 = 
	`¢d_ùl_–em_v®ue_g‘_boŞ—n
(
–em
->Şd, 
k
);

112 
mask
 = 
	`¢d_ùl_–em_v®ue_g‘_boŞ—n
(
–em
->mask, 
k
);

113 
Şd
 &ğ~
mask
;

114 ià(
Şd
) {

115 
v®
 = 
	`¢d_ùl_–em_v®ue_g‘_boŞ—n
(
–em
->v®, 
k
);

116 
v®
 |ğ
Şd
;

117 
	`¢d_ùl_–em_v®ue_£t_boŞ—n
(
–em
->
v®
, 
k
, val);

121 
SND_CTL_ELEM_TYPE_INTEGER
:

122 
k
 = 0; k < 
couÁ
; ++k) {

123 
Şd
, 
v®
, 
mask
;

124 
Şd
 = 
	`¢d_ùl_–em_v®ue_g‘_š‹g”
(
–em
->Şd, 
k
);

125 
mask
 = 
	`¢d_ùl_–em_v®ue_g‘_š‹g”
(
–em
->mask, 
k
);

126 
Şd
 &ğ~
mask
;

127 ià(
Şd
) {

128 
v®
 = 
	`¢d_ùl_–em_v®ue_g‘_š‹g”
(
–em
->v®, 
k
);

129 
v®
 |ğ
Şd
;

130 
	`¢d_ùl_–em_v®ue_£t_š‹g”
(
–em
->
v®
, 
k
, val);

134 
SND_CTL_ELEM_TYPE_ENUMERATED
:

135 
k
 = 0; k < 
couÁ
; ++k) {

136 
Şd
, 
v®
, 
mask
;

137 
Şd
 = 
	`¢d_ùl_–em_v®ue_g‘_’um”©ed
(
–em
->Şd, 
k
);

138 
mask
 = 
	`¢d_ùl_–em_v®ue_g‘_’um”©ed
(
–em
->mask, 
k
);

139 
Şd
 &ğ~
mask
;

140 ià(
Şd
) {

141 
v®
 = 
	`¢d_ùl_–em_v®ue_g‘_’um”©ed
(
–em
->v®, 
k
);

142 
v®
 |ğ
Şd
;

143 
	`¢d_ùl_–em_v®ue_£t_’um”©ed
(
–em
->
v®
, 
k
, val);

147 
SND_CTL_ELEM_TYPE_IEC958
:

148 
couÁ
 = (
¢d_«s_›c958_t
);

150 
SND_CTL_ELEM_TYPE_BYTES
:

151 
k
 = 0; k < 
couÁ
; ++k) {

152 
Şd
, 
v®
, 
mask
;

153 
Şd
 = 
	`¢d_ùl_–em_v®ue_g‘_by‹
(
–em
->Şd, 
k
);

154 
mask
 = 
	`¢d_ùl_–em_v®ue_g‘_by‹
(
–em
->mask, 
k
);

155 
Şd
 &ğ~
mask
;

156 ià(
Şd
) {

157 
v®
 = 
	`¢d_ùl_–em_v®ue_g‘_by‹
(
–em
->v®, 
k
);

158 
v®
 |ğ
Şd
;

159 
	`¢d_ùl_–em_v®ue_£t_by‹
(
–em
->
v®
, 
k
, val);

164 
	`as£¹
(0);

167 
”r
 = 
	`¢d_ùl_–em_wr™e
(
h
->
ùl
, 
–em
->
v®
);

168 ià(
”r
 < 0) {

169 
	`SNDERR
("Cannot write ctlƒlem");

170  
”r
;

174 
	}
}

181 
	$¢d_sùl_»move
(
¢d_sùl_t
 *
h
)

183 
li¡_h—d
 *
pos
;

184 
”r
;

185 
	`as£¹
(
h
);

186 
	`li¡_fÜ_—ch
(
pos
, &
h
->
–ems
) {

187 
¢d_sùl_–em_t
 *
–em
 = 
	`li¡_’Œy
(
pos
, snd_sùl_–em_t, 
li¡
);

188 ià(
–em
->
lock
) {

189 
”r
 = 
	`¢d_ùl_–em_uÆock
(
h
->
ùl
, 
–em
->
id
);

190 ià(
”r
 < 0) {

191 
	`SNDERR
("Cannot unlock ctlƒlem");

192  
”r
;

205 ià(
–em
->
´e£rve
 && 
	`¢d_ùl_–em_v®ue_com·»
ÓËm->
v®
,ƒËm->
Şd
)) {

206 
”r
 = 
	`¢d_ùl_–em_wr™e
(
h
->
ùl
, 
–em
->
Şd
);

207 ià(
”r
 < 0) {

208 
	`SNDERR
("Cannot„estore ctlƒlem");

209  
”r
;

214 
	}
}

216 
	$¢d_cÚfig_g‘_ùl_–em_’um”©ed
(
¢d_cÚfig_t
 *
n
, 
¢d_ùl_t
 *
ùl
,

217 
¢d_ùl_–em_šfo_t
 *
šfo
)

219 cÚ¡ *
¡r
;

220 
v®
;

221 
idx
, 
™ems
;

222 
	`¢d_cÚfig_g‘_ty³
(
n
)) {

223 
SND_CONFIG_TYPE_INTEGER
:

224 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v®
);

225  
v®
;

226 
SND_CONFIG_TYPE_STRING
:

227 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
);

232 
™ems
 = 
	`¢d_ùl_–em_šfo_g‘_™ems
(
šfo
);

233 
idx
 = 0; idx < 
™ems
; idx++) {

234 
”r
;

235 
	`¢d_ùl_–em_šfo_£t_™em
(
šfo
, 
idx
);

236 
”r
 = 
	`¢d_ùl_–em_šfo
(
ùl
, 
šfo
);

237 ià(
”r
 < 0) {

238 
	`SNDERR
("Cannot obtain info for CTLƒlem");

239  
”r
;

241 ià(
	`¡rcmp
(
¡r
, 
	`¢d_ùl_–em_šfo_g‘_™em_Çme
(
šfo
)) == 0)

242  
idx
;

245 
	}
}

247 
	$¢d_cÚfig_g‘_ùl_–em_v®ue
(
¢d_cÚfig_t
 *
cÚf
,

248 
¢d_ùl_t
 *
ùl
,

249 
¢d_ùl_–em_v®ue_t
 *
v®
,

250 
¢d_ùl_–em_v®ue_t
 *
mask
,

251 
¢d_ùl_–em_šfo_t
 *
šfo
)

253 
”r
;

254 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

255 
¢d_ùl_–em_id_t
 
id
 = {0};

256 
¢d_ùl_–em_ty³_t
 
ty³
;

257 
couÁ
;

258 
v
;

259 
idx
;

260 
	`¢d_ùl_–em_v®ue_g‘_id
(
v®
, &
id
);

261 
couÁ
 = 
	`¢d_ùl_–em_šfo_g‘_couÁ
(
šfo
);

262 
ty³
 = 
	`¢d_ùl_–em_šfo_g‘_ty³
(
šfo
);

263 ià(
couÁ
 == 1) {

264 
ty³
) {

265 
SND_CTL_ELEM_TYPE_BOOLEAN
:

266 
v
 = 
	`¢d_cÚfig_g‘_boŞ
(
cÚf
);

267 ià(
v
 >= 0) {

268 
	`¢d_ùl_–em_v®ue_£t_boŞ—n
(
v®
, 0, 
v
);

269 ià(
mask
)

270 
	`¢d_ùl_–em_v®ue_£t_boŞ—n
(
mask
, 0, 1);

274 
SND_CTL_ELEM_TYPE_INTEGER
:

275 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
cÚf
, &
v
);

276 ià(
”r
 == 0) {

277 
	`¢d_ùl_–em_v®ue_£t_š‹g”
(
v®
, 0, 
v
);

278 ià(
mask
)

279 
	`¢d_ùl_–em_v®ue_£t_š‹g”
(
mask
, 0, ~0L);

283 
SND_CTL_ELEM_TYPE_ENUMERATED
:

284 
v
 = 
	`¢d_cÚfig_g‘_ùl_–em_’um”©ed
(
cÚf
, 
ùl
, 
šfo
);

285 ià(
v
 >= 0) {

286 
	`¢d_ùl_–em_v®ue_£t_’um”©ed
(
v®
, 0, 
v
);

287 ià(
mask
)

288 
	`¢d_ùl_–em_v®ue_£t_’um”©ed
(
mask
, 0, ~0);

292 
SND_CTL_ELEM_TYPE_BYTES
:

293 
SND_CTL_ELEM_TYPE_IEC958
:

296 
	`SNDERR
("UnknowÀcÚŒŞy³: %d", 
ty³
);

297  -
EINVAL
;

300 
ty³
) {

301 
SND_CTL_ELEM_TYPE_IEC958
:

302 
couÁ
 = (
¢d_«s_›c958_t
);

304 
SND_CTL_ELEM_TYPE_BYTES
:

306 cÚ¡ *
buf
;

307 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
cÚf
, &
buf
);

308 ià(
”r
 >= 0) {

309 
c1
 = 0;

310 
Ën
 = 
	`¡¾’
(
buf
);

311 
idx
 = 0;

312 ià(
Ën
 % 2 !ğ0 ||†’ > 
couÁ
 * 2) {

313 
_bad_cÚ‹Á
:

314 
	`SNDERR
("bad value content");

315  -
EINVAL
;

317 *
buf
) {

318 
c
 = *
buf
++;

319 ià(
c
 >= '0' && c <= '9')

320 
c
 -= '0';

321 ià(
c
 >= 'a' && c <= 'f')

322 
c
 = c - 'a' + 10;

323 ià(
c
 >= 'A' && c <= 'F')

324 
c
 = c - 'A' + 10;

326 
_bad_cÚ‹Á
;

328 ià(
idx
 % 2 == 1) {

329 
	`¢d_ùl_–em_v®ue_£t_by‹
(
v®
, 
idx
 / 2, 
c1
 << 4 | 
c
);

330 ià(
mask
)

331 
	`¢d_ùl_–em_v®ue_£t_by‹
(
mask
, 
idx
 / 2, 0xff);

333 
c1
 = 
c
;

334 
idx
++;

342 ià(
	`¢d_cÚfig_g‘_ty³
(
cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

343 
	`SNDERR
("bad valueype");

344  -
EINVAL
;

347 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

348 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

349 cÚ¡ *
id
;

350 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

352 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
idx
);

353 ià(
”r
 < 0 || 
idx
 < 0 || (èidx >ğ
couÁ
) {

354 
	`SNDERR
("bad value index");

355  -
EINVAL
;

357 
ty³
) {

358 
SND_CTL_ELEM_TYPE_BOOLEAN
:

359 
v
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

360 ià(
v
 < 0)

361 
_bad_cÚ‹Á
;

362 
	`¢d_ùl_–em_v®ue_£t_boŞ—n
(
v®
, 
idx
, 
v
);

363 ià(
mask
)

364 
	`¢d_ùl_–em_v®ue_£t_boŞ—n
(
mask
, 
idx
, 1);

366 
SND_CTL_ELEM_TYPE_INTEGER
:

367 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v
);

368 ià(
”r
 < 0)

369 
_bad_cÚ‹Á
;

370 
	`¢d_ùl_–em_v®ue_£t_š‹g”
(
v®
, 
idx
, 
v
);

371 ià(
mask
)

372 
	`¢d_ùl_–em_v®ue_£t_š‹g”
(
mask
, 
idx
, ~0L);

374 
SND_CTL_ELEM_TYPE_ENUMERATED
:

375 
v
 = 
	`¢d_cÚfig_g‘_ùl_–em_’um”©ed
(
n
, 
ùl
, 
šfo
);

376 ià(
v
 < 0)

377 
_bad_cÚ‹Á
;

378 
	`¢d_ùl_–em_v®ue_£t_’um”©ed
(
v®
, 
idx
, 
v
);

379 ià(
mask
)

380 
	`¢d_ùl_–em_v®ue_£t_’um”©ed
(
mask
, 
idx
, ~0);

382 
SND_CTL_ELEM_TYPE_BYTES
:

383 
SND_CTL_ELEM_TYPE_IEC958
:

384 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v
);

385 ià(
”r
 < 0 || 
v
 < 0 || v > 255)

386 
_bad_cÚ‹Á
;

387 
	`¢d_ùl_–em_v®ue_£t_by‹
(
v®
, 
idx
, 
v
);

388 ià(
mask
)

389 
	`¢d_ùl_–em_v®ue_£t_by‹
(
mask
, 
idx
, 0xff);

396 
	}
}

398 
	$add_–em
(
¢d_sùl_t
 *
h
, 
¢d_cÚfig_t
 *
_cÚf
, snd_cÚfig_ˆ*
´iv©e_d©a
, *
qu™
)

400 
¢d_cÚfig_t
 *
cÚf
;

401 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

402 
içû
 = 
SND_CTL_ELEM_IFACE_MIXER
;

403 cÚ¡ *
Çme
 = 
NULL
;

404 
šdex
 = 0;

405 
deviû
 = -1;

406 
subdeviû
 = -1;

407 
lock
 = 0;

408 
´e£rve
 = 0;

409 
İtiÚ®
 = 0;

410 
sk_»¡
 = 0;

411 
¢d_cÚfig_t
 *
v®ue
 = 
NULL
, *
mask
 = NULL;

412 
¢d_sùl_–em_t
 *
–em
 = 
NULL
;

413 
”r
;

414 
”r
 = 
	`¢d_cÚfig_ex·nd
(
_cÚf
, _cÚf, 
NULL
, 
´iv©e_d©a
, &
cÚf
);

415 ià(
”r
 < 0)

416  
”r
;

417 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

418 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

419 cÚ¡ *
id
;

420 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

422 ià(
	`¡rcmp
(
id
, "comment") == 0)

424 ià(
	`¡rcmp
(
id
, "iface") == 0 || strcmp(id, "interface") == 0) {

425 cÚ¡ *
±r
;

426 ià((
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
±r
)) < 0) {

427 
	`SNDERR
("f›ld % i nÙ‡ sŒšg", 
id
);

428 
_”r
;

430 ià((
”r
 = 
	`¢d_cÚfig_g‘_ùl_içû_ascii
(
±r
)) < 0) {

431 
	`SNDERR
("Inv®id v®ufÜ '%s'", 
id
);

432 
_”r
;

434 
içû
 = 
”r
;

437 ià(
	`¡rcmp
(
id
, "name") == 0) {

438 ià((
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
Çme
)) < 0) {

439 
	`SNDERR
("f›ld % i nÙ‡ sŒšg", 
id
);

440 
_”r
;

444 ià(
	`¡rcmp
(
id
, "index") == 0) {

445 ià((
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
šdex
)) < 0) {

446 
	`SNDERR
("f›ld % i nÙ‡Àš‹g”", 
id
);

447 
_”r
;

451 ià(
	`¡rcmp
(
id
, "device") == 0) {

452 ià((
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
deviû
)) < 0) {

453 
	`SNDERR
("f›ld % i nÙ‡Àš‹g”", 
id
);

454 
_”r
;

458 ià(
	`¡rcmp
(
id
, "subdevice") == 0) {

459 ià((
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
subdeviû
)) < 0) {

460 
	`SNDERR
("f›ld % i nÙ‡Àš‹g”", 
id
);

461 
_”r
;

465 ià(
	`¡rcmp
(
id
, "lock") == 0) {

466 
”r
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

467 ià(
”r
 < 0)

468 
_”r
;

469 
lock
 = 
”r
;

472 ià(
	`¡rcmp
(
id
, "preserve") == 0) {

473 
”r
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

474 ià(
”r
 < 0)

475 
_”r
;

476 
´e£rve
 = 
”r
;

479 ià(
	`¡rcmp
(
id
, "value") == 0) {

480 
v®ue
 = 
n
;

483 ià(
	`¡rcmp
(
id
, "mask") == 0) {

484 
mask
 = 
n
;

487 ià(
	`¡rcmp
(
id
, "optional") == 0) {

488 
”r
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

489 ià(
”r
 < 0)

490 
_”r
;

491 
İtiÚ®
 = 
”r
;

494 ià(
	`¡rcmp
(
id
, "skip_rest") == 0) {

495 
”r
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

496 ià(
”r
 < 0)

497 
_”r
;

498 
sk_»¡
 = 
”r
;

501 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

502  -
EINVAL
;

504 ià(
Çme
 =ğ
NULL
) {

505 
	`SNDERR
("Missing control‚ame");

506 
”r
 = -
EINVAL
;

507 
_”r
;

509 ià(
v®ue
 =ğ
NULL
) {

510 
	`SNDERR
("Missing control value");

511 
”r
 = -
EINVAL
;

512 
_”r
;

514 ià(
deviû
 < 0)

515 
deviû
 = 0;

516 ià(
subdeviû
 < 0)

517 
subdeviû
 = 0;

518 
–em
 = 
	`ÿÎoc
(1, (*elem));

519 ià(!
–em
)

520  -
ENOMEM
;

521 
”r
 = 
	`¢d_ùl_–em_id_m®loc
(&
–em
->
id
);

522 ià(
”r
 < 0)

523 
_”r
;

524 
”r
 = 
	`¢d_ùl_–em_šfo_m®loc
(&
–em
->
šfo
);

525 ià(
”r
 < 0)

526 
_”r
;

527 
”r
 = 
	`¢d_ùl_–em_v®ue_m®loc
(&
–em
->
v®
);

528 ià(
”r
 < 0)

529 
_”r
;

530 
”r
 = 
	`¢d_ùl_–em_v®ue_m®loc
(&
–em
->
mask
);

531 ià(
”r
 < 0)

532 
_”r
;

533 
”r
 = 
	`¢d_ùl_–em_v®ue_m®loc
(&
–em
->
Şd
);

534 ià(
”r
 < 0)

535 
_”r
;

536 
–em
->
lock
 =†ock;

537 
–em
->
´e£rve
 =…reserve;

538 
	`¢d_ùl_–em_id_£t_š‹rçû
(
–em
->
id
, 
içû
);

539 
	`¢d_ùl_–em_id_£t_Çme
(
–em
->
id
, 
Çme
);

540 
	`¢d_ùl_–em_id_£t_šdex
(
–em
->
id
, 
šdex
);

541 
	`¢d_ùl_–em_id_£t_deviû
(
–em
->
id
, 
deviû
);

542 
	`¢d_ùl_–em_id_£t_subdeviû
(
–em
->
id
, 
subdeviû
);

543 
	`¢d_ùl_–em_šfo_£t_id
(
–em
->
šfo
,ƒËm->
id
);

544 
”r
 = 
	`¢d_ùl_–em_šfo
(
h
->
ùl
, 
–em
->
šfo
);

545 ià(
”r
 < 0) {

546 ià(! 
İtiÚ®
)

547 
	`SNDERR
("CªnÙ obš infØfÜ CTLƒËm (%s,'%s',%li,%li,%li): %s", 
	`¢d_ùl_–em_içû_Çme
(
içû
), 
Çme
, 
šdex
, 
deviû
, 
subdeviû
, 
	`¢d_¡»¼Ü
(
”r
));

548 
_”r
;

550 ià(
sk_»¡
)

551 *
qu™
 = 1;

553 
	`¢d_ùl_–em_v®ue_£t_id
(
–em
->
v®
,ƒËm->
id
);

554 
	`¢d_ùl_–em_v®ue_£t_id
(
–em
->
Şd
,ƒËm->
id
);

555 ià(
mask
) {

556 
”r
 = 
	`¢d_cÚfig_g‘_ùl_–em_v®ue
(
v®ue
, 
h
->
ùl
, 
–em
->
v®
, 
NULL
,ƒËm->
šfo
);

557 ià(
”r
 < 0)

558 
_”r
;

559 
”r
 = 
	`¢d_cÚfig_g‘_ùl_–em_v®ue
(
mask
, 
h
->
ùl
, 
–em
->mask, 
NULL
,ƒËm->
šfo
);

560 ià(
”r
 < 0)

561 
_”r
;

563 
”r
 = 
	`¢d_cÚfig_g‘_ùl_–em_v®ue
(
v®ue
, 
h
->
ùl
, 
–em
->
v®
,ƒËm->
mask
,ƒËm->
šfo
);

564 ià(
”r
 < 0)

565 
_”r
;

568 
”r
 = 
	`¢d_cÚfig_g‘_ùl_–em_v®ue
(
v®ue
, 
h
->
ùl
, 
–em
->
v®
,ƒËm->
mask
,ƒËm->
šfo
);

569 ià(
”r
 < 0)

570 
_”r
;

571 
	`li¡_add_
(&
–em
->
li¡
, &
h
->
–ems
);

573 
_”r
:

574 ià(
”r
 < 0 && 
–em
) {

575 ià(
–em
->
id
)

576 
	`¢d_ùl_–em_id_ä“
(
–em
->
id
);

577 ià(
–em
->
šfo
)

578 
	`¢d_ùl_–em_šfo_ä“
(
–em
->
šfo
);

579 ià(
–em
->
v®
)

580 
	`¢d_ùl_–em_v®ue_ä“
(
–em
->
v®
);

581 ià(
–em
->
mask
)

582 
	`¢d_ùl_–em_v®ue_ä“
(
–em
->
mask
);

583 ià(
–em
->
Şd
)

584 
	`¢d_ùl_–em_v®ue_ä“
(
–em
->
Şd
);

585 
	`ä“
(
–em
);

586 ià(
”r
 !ğ-
ENOMEM
 && 
İtiÚ®
)

587 
”r
 = 0;

589 ià(
cÚf
)

590 
	`¢d_cÚfig_d–‘e
(
cÚf
);

591  
”r
;

592 
	}
}

603 
	$¢d_sùl_bud
(
¢d_sùl_t
 **
sùl
, 
¢d_ùl_t
 *
hªdË
, 
¢d_cÚfig_t
 *
cÚf
, snd_cÚfig_ˆ*
´iv©e_d©a
, 
mode
)

605 
¢d_sùl_t
 *
h
;

606 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

607 
”r
, 
qu™
 = 0;

609 
	`as£¹
(
sùl
);

610 
	`as£¹
(
hªdË
);

611 
	`as£¹
(
cÚf
);

612 *
sùl
 = 
NULL
;

613 ià(
	`¢d_cÚfig_g‘_ty³
(
cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
)

614  -
EINVAL
;

615 
h
 = 
	`ÿÎoc
(1, (*h));

616 ià(!
h
) {

617 ià(
mode
 & 
SND_SCTL_NOFREE
)

618  -
ENOMEM
;

619 
	`¢d_ùl_şo£
(
hªdË
);

620  -
ENOMEM
;

622 
h
->
mode
 = mode;

623 
h
->
ùl
 = 
hªdË
;

624 
	`INIT_LIST_HEAD
(&
h
->
–ems
);

625 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

626 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

627 
”r
 = 
	`add_–em
(
h
, 
n
, 
´iv©e_d©a
, &
qu™
);

628 ià(
”r
 < 0) {

629 
	`ä“_–ems
(
h
);

630  
”r
;

632 ià(
qu™
)

635 *
sùl
 = 
h
;

637 
	}
}

644 
	$¢d_sùl_ä“
(
¢d_sùl_t
 *
sùl
)

646 
	`as£¹
(
sùl
);

647  
	`ä“_–ems
(
sùl
);

648 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/tlv.c

29 
	~"cÚŒŞ_loÿl.h
"

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<uni¡d.h
>

33 
	~<¡ršg.h
>

34 #iâdeà
HAVE_SOFT_FLOAT


35 
	~<m©h.h
>

38 #iâdeà
DOC_HIDDEN


40 
	#št_šdex
(
size
è(((sizeè+ (è- 1è/ ())

	)

42 
	#MAX_TLV_RANGE_SIZE
 256

	)

59 
	$¢d_v_·r£_dB_šfo
(*
v
,

60 
v_size
,

61 **
db_vp
)

63 
ty³
;

64 
size
;

65 
”r
;

67 *
db_vp
 = 
NULL
;

68 
ty³
 = 
v
[
SNDRV_CTL_TLVO_TYPE
];

69 
size
 = 
v
[
SNDRV_CTL_TLVO_LEN
];

70 
v_size
 -= 2 * ();

71 ià(
size
 > 
v_size
) {

72 
	`SNDERR
("TLV sizeƒrror");

73  -
EINVAL
;

75 
ty³
) {

76 
SND_CTL_TLVT_CONTAINER
:

77 
size
 = 
	`št_šdex
(size) * ();

78 
v
 += 2;

79 
size
 > 0) {

80 
Ën
;

81 
”r
 = 
	`¢d_v_·r£_dB_šfo
(
v
, 
size
, 
db_vp
);

82 ià(
”r
 < 0)

83  
”r
;

84 ià(
”r
 > 0)

85  
”r
;

86 
Ën
 = 
	`št_šdex
(
v
[
SNDRV_CTL_TLVO_LEN
]) + 2;

87 
size
 -ğ
Ën
 * ();

88 
v
 +ğ
Ën
;

91 
SND_CTL_TLVT_DB_SCALE
:

92 
SND_CTL_TLVT_DB_MINMAX
:

93 
SND_CTL_TLVT_DB_MINMAX_MUTE
:

94 #iâdeà
HAVE_SOFT_FLOAT


95 
SND_CTL_TLVT_DB_LINEAR
:

97 
SND_CTL_TLVT_DB_RANGE
: {

98 
mšsize
;

99 ià(
ty³
 =ğ
SND_CTL_TLVT_DB_RANGE
)

100 
mšsize
 = 4 * ();

102 
mšsize
 = 2 * ();

103 ià(
size
 < 
mšsize
) {

104 
	`SNDERR
("Invalid dB_scale TLV size");

105  -
EINVAL
;

107 ià(
size
 > 
MAX_TLV_RANGE_SIZE
) {

108 
	`SNDERR
("ToØbig dB_sÿË TLV size: %d", 
size
);

109  -
EINVAL
;

111 *
db_vp
 = 
v
;

112  
size
 + () * 2;

117  -
EINVAL
;

118 
	}
}

129 
	$¢d_v_g‘_dB_¿nge
(*
v
, 
¿ngemš
, 
¿ngemax
,

130 *
mš
, *
max
)

132 
”r
;

134 
v
[
SNDRV_CTL_TLVO_TYPE
]) {

135 
SND_CTL_TLVT_DB_RANGE
: {

136 
pos
, 
Ën
;

137 
Ën
 = 
	`št_šdex
(
v
[
SNDRV_CTL_TLVO_LEN
]);

138 ià(
Ën
 > 
MAX_TLV_RANGE_SIZE
)

139  -
EINVAL
;

140 
pos
 = 2;

141 
pos
 + 4 <ğ
Ën
) {

142 
rmš
, 
rmax
;

143 
submš
, 
submax
;

144 
submš
 = ()
v
[
pos
];

145 
submax
 = ()
v
[
pos
 + 1];

146 ià(
¿ngemax
 < 
submax
)

147 
submax
 = 
¿ngemax
;

148 
”r
 = 
	`¢d_v_g‘_dB_¿nge
(
v
 + 
pos
 + 2,

149 
submš
, 
submax
,

150 &
rmš
, &
rmax
);

151 ià(
”r
 < 0)

152  
”r
;

153 ià(
pos
 > 2) {

154 ià(
rmš
 < *
mš
)

155 *
mš
 = 
rmš
;

156 ià(
rmax
 > *
max
)

157 *
max
 = 
rmax
;

159 *
mš
 = 
rmš
;

160 *
max
 = 
rmax
;

162 ià(
¿ngemax
 =ğ
submax
)

164 
pos
 +ğ
	`št_šdex
(
v
[pos + 3]) + 4;

168 
SND_CTL_TLVT_DB_SCALE
: {

169 
¡•
;

170 ià(
v
[
SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
] & 0x10000)

171 *
mš
 = 
SND_CTL_TLV_DB_GAIN_MUTE
;

173 *
mš
 = ()
v
[
SNDRV_CTL_TLVO_DB_SCALE_MIN
];

174 
¡•
 = (
v
[
SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
] & 0xffff);

175 *
max
 = ()
v
[
SNDRV_CTL_TLVO_DB_SCALE_MIN
] +

176 
¡•
 * (
¿ngemax
 - 
¿ngemš
);

179 
SND_CTL_TLVT_DB_MINMAX
:

180 
SND_CTL_TLVT_DB_LINEAR
:

181 *
mš
 = ()
v
[
SNDRV_CTL_TLVO_DB_LINEAR_MIN
];

182 *
max
 = ()
v
[
SNDRV_CTL_TLVO_DB_LINEAR_MAX
];

184 
SND_CTL_TLVT_DB_MINMAX_MUTE
:

185 *
mš
 = 
SND_CTL_TLV_DB_GAIN_MUTE
;

186 *
max
 = ()
v
[
SNDRV_CTL_TLVO_DB_MINMAX_MAX
];

189  -
EINVAL
;

190 
	}
}

201 
	$¢d_v_cÚv”t_to_dB
(*
v
, 
¿ngemš
, 
¿ngemax
,

202 
vŞume
, *
db_gaš
)

204 
ty³
 = 
v
[
SNDRV_CTL_TLVO_TYPE
];

206 
ty³
) {

207 
SND_CTL_TLVT_DB_RANGE
: {

208 
pos
, 
Ën
;

209 
Ën
 = 
	`št_šdex
(
v
[
SNDRV_CTL_TLVO_LEN
]);

210 ià(
Ën
 > 
MAX_TLV_RANGE_SIZE
)

211  -
EINVAL
;

212 
pos
 = 2;

213 
pos
 + 4 <ğ
Ën
) {

214 
¿ngemš
 = ()
v
[
pos
];

215 
¿ngemax
 = ()
v
[
pos
 + 1];

216 ià(
vŞume
 >ğ
¿ngemš
 && vŞum<ğ
¿ngemax
)

217  
	`¢d_v_cÚv”t_to_dB
(
v
 + 
pos
 + 2,

218 
¿ngemš
, 
¿ngemax
,

219 
vŞume
, 
db_gaš
);

220 
pos
 +ğ
	`št_šdex
(
v
[pos + 3]) + 4;

222  -
EINVAL
;

224 
SND_CTL_TLVT_DB_SCALE
: {

225 
mš
, 
¡•
, 
mu‹
;

226 
mš
 = 
v
[
SNDRV_CTL_TLVO_DB_SCALE_MIN
];

227 
¡•
 = (
v
[
SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
] & 0xffff);

228 
mu‹
 = (
v
[
SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
] >> 16) & 1;

229 ià(
mu‹
 && 
vŞume
 <ğ
¿ngemš
)

230 *
db_gaš
 = 
SND_CTL_TLV_DB_GAIN_MUTE
;

232 *
db_gaš
 = (
vŞume
 - 
¿ngemš
è* 
¡•
 + 
mš
;

235 
SND_CTL_TLVT_DB_MINMAX
:

236 
SND_CTL_TLVT_DB_MINMAX_MUTE
: {

237 
mšdb
, 
maxdb
;

238 
mšdb
 = 
v
[
SNDRV_CTL_TLVO_DB_MINMAX_MIN
];

239 
maxdb
 = 
v
[
SNDRV_CTL_TLVO_DB_MINMAX_MAX
];

240 ià(
vŞume
 <ğ
¿ngemš
 || 
¿ngemax
 <=„angemin) {

241 ià(
ty³
 =ğ
SND_CTL_TLVT_DB_MINMAX_MUTE
)

242 *
db_gaš
 = 
SND_CTL_TLV_DB_GAIN_MUTE
;

244 *
db_gaš
 = 
mšdb
;

245 } ià(
vŞume
 >ğ
¿ngemax
)

246 *
db_gaš
 = 
maxdb
;

248 *
db_gaš
 = (
maxdb
 - 
mšdb
è* (
vŞume
 - 
¿ngemš
) /

249 (
¿ngemax
 - 
¿ngemš
è+ 
mšdb
;

252 #iâdeà
HAVE_SOFT_FLOAT


253 
SND_CTL_TLVT_DB_LINEAR
: {

254 
mšdb
 = 
v
[
SNDRV_CTL_TLVO_DB_LINEAR_MIN
];

255 
maxdb
 = 
v
[
SNDRV_CTL_TLVO_DB_LINEAR_MAX
];

256 ià(
vŞume
 <ğ
¿ngemš
 || 
¿ngemax
 <=„angemin)

257 *
db_gaš
 = 
mšdb
;

258 ià(
vŞume
 >ğ
¿ngemax
)

259 *
db_gaš
 = 
maxdb
;

261 
v®
 = ()(
vŞume
 - 
¿ngemš
) /

262 ()(
¿ngemax
 - 
¿ngemš
);

263 ià(
mšdb
 <ğ
SND_CTL_TLV_DB_GAIN_MUTE
)

264 *
db_gaš
 = ()(100.0 * 20.0 * 
	`log10
(
v®
)) +

265 
maxdb
;

268 
lmš
 = 
	`pow
(10.0, 
mšdb
/2000.0);

269 
lmax
 = 
	`pow
(10.0, 
maxdb
/2000.0);

270 
v®
 = (
lmax
 - 
lmš
) * val +†min;

271 *
db_gaš
 = ()(100.0 * 20.0 * 
	`log10
(
v®
));

278  -
EINVAL
;

279 
	}
}

293 
	$¢d_v_cÚv”t_äom_dB
(*
v
, 
¿ngemš
, 
¿ngemax
,

294 
db_gaš
, *
v®ue
, 
xdœ
)

296 
ty³
 = 
v
[
SNDRV_CTL_TLVO_TYPE
];

298 
ty³
) {

299 
SND_CTL_TLVT_DB_RANGE
: {

300 
dbmš
, 
dbmax
, 
´ev_submax
;

301 
pos
, 
Ën
;

302 
Ën
 = 
	`št_šdex
(
v
[
SNDRV_CTL_TLVO_LEN
]);

303 ià(
Ën
 < 6 ||†’ > 
MAX_TLV_RANGE_SIZE
)

304  -
EINVAL
;

305 
pos
 = 2;

306 
´ev_submax
 = 0;

307 
pos
 + 4 <ğ
Ën
) {

308 
submš
, 
submax
;

309 
submš
 = ()
v
[
pos
];

310 
submax
 = ()
v
[
pos
 + 1];

311 ià(
¿ngemax
 < 
submax
)

312 
submax
 = 
¿ngemax
;

313 ià(!
	`¢d_v_g‘_dB_¿nge
(
v
 + 
pos
 + 2,

314 
submš
, 
submax
,

315 &
dbmš
, &
dbmax
) &&

316 
db_gaš
 >ğ
dbmš
 && db_gaš <ğ
dbmax
)

317  
	`¢d_v_cÚv”t_äom_dB
(
v
 + 
pos
 + 2,

318 
submš
, 
submax
,

319 
db_gaš
, 
v®ue
, 
xdœ
);

320 ià(
db_gaš
 < 
dbmš
) {

321 *
v®ue
 = 
xdœ
 > 0 || 
pos
 =ğ2 ? 
submš
 : 
´ev_submax
;

324 
´ev_submax
 = 
submax
;

325 ià(
¿ngemax
 =ğ
submax
)

327 
pos
 +ğ
	`št_šdex
(
v
[pos + 3]) + 4;

329 *
v®ue
 = 
´ev_submax
;

332 
SND_CTL_TLVT_DB_SCALE
: {

333 
mš
, 
¡•
, 
max
, 
mu‹
;

334 
mš
 = 
v
[
SNDRV_CTL_TLVO_DB_SCALE_MIN
];

335 
¡•
 = 
v
[
SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
] & 0xffff;

336 
mu‹
 = 
v
[
SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
] & 0x10000;

337 
max
 = 
mš
 + ()(
¡•
 * (
¿ngemax
 - 
¿ngemš
));

338 ià(
db_gaš
 <ğ
mš
)

339 ià(
db_gaš
 > 
SND_CTL_TLV_DB_GAIN_MUTE
 && 
xdœ
 > 0 &&

340 
mu‹
)

341 *
v®ue
 = 
¿ngemš
 + 1;

343 *
v®ue
 = 
¿ngemš
;

344 ià(
db_gaš
 >ğ
max
)

345 *
v®ue
 = 
¿ngemax
;

347 
v
 = (
db_gaš
 - 
mš
è* (
¿ngemax
 - 
¿ngemš
);

348 ià(
xdœ
 > 0)

349 
v
 +ğ(
max
 - 
mš
) - 1;

350 ià(
xdœ
 == 0)

351 
v
 +ğ((
max
 - 
mš
) + 1) / 2;

352 
v
 = v / (
max
 - 
mš
è+ 
¿ngemš
;

353 *
v®ue
 = 
v
;

357 
SND_CTL_TLVT_DB_MINMAX
:

358 
SND_CTL_TLVT_DB_MINMAX_MUTE
: {

359 
mš
, 
max
;

360 
mš
 = 
v
[
SNDRV_CTL_TLVO_DB_MINMAX_MIN
];

361 
max
 = 
v
[
SNDRV_CTL_TLVO_DB_MINMAX_MAX
];

362 ià(
db_gaš
 <ğ
mš
)

363 ià(
db_gaš
 > 
SND_CTL_TLV_DB_GAIN_MUTE
 && 
xdœ
 > 0 &&

364 
ty³
 =ğ
SND_CTL_TLVT_DB_MINMAX_MUTE
)

365 *
v®ue
 = 
¿ngemš
 + 1;

367 *
v®ue
 = 
¿ngemš
;

368 ià(
db_gaš
 >ğ
max
)

369 *
v®ue
 = 
¿ngemax
;

371 
v
 = (
db_gaš
 - 
mš
è* (
¿ngemax
 - 
¿ngemš
);

372 ià(
xdœ
 > 0)

373 
v
 +ğ(
max
 - 
mš
) - 1;

374 ià(
xdœ
 == 0)

375 
v
 +ğ((
max
 - 
mš
) + 1) / 2;

376 
v
 = v / (
max
 - 
mš
è+ 
¿ngemš
;

377 *
v®ue
 = 
v
;

381 #iâdeà
HAVE_SOFT_FLOAT


382 
SND_CTL_TLVT_DB_LINEAR
: {

383 
mš
, 
max
;

384 
mš
 = 
v
[
SNDRV_CTL_TLVO_DB_LINEAR_MIN
];

385 
max
 = 
v
[
SNDRV_CTL_TLVO_DB_LINEAR_MAX
];

386 ià(
db_gaš
 <ğ
mš
)

387 *
v®ue
 = 
¿ngemš
;

388 ià(
db_gaš
 >ğ
max
)

389 *
v®ue
 = 
¿ngemax
;

392 
vmš
, 
vmax
, 
v
;

393 
vmš
 = (
mš
 <ğ
SND_CTL_TLV_DB_GAIN_MUTE
) ? 0.0 :

394 
	`pow
(10.0, ()
mš
 / 2000.0);

395 
vmax
 = !
max
 ? 1.0 : 
	`pow
(10.0, ()max / 2000.0);

396 
v
 = 
	`pow
(10.0, ()
db_gaš
 / 2000.0);

397 
v
 = (v - 
vmš
è* (
¿ngemax
 - 
¿ngemš
è/ (
vmax
 - vmin);

398 ià(
xdœ
 > 0)

399 
v
 = 
	`û
(v);

400 ià(
xdœ
 == 0)

401 
v
 = 
	`Ìšt
(v);

402 *
v®ue
 = ()
v
 + 
¿ngemš
;

410  -
EINVAL
;

411 
	}
}

413 #iâdeà
DOC_HIDDEN


414 
	#TEMP_TLV_SIZE
 4096

	)

415 
	sv_šfo
 {

416 
	mmšv®
, 
	mmaxv®
;

417 *
	mv
;

418 
	mbuf
[
TEMP_TLV_SIZE
];

422 
	$g‘_v_šfo
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

423 
v_šfo
 *
»c
)

425 
¢d_ùl_–em_šfo_t
 
šfo
 = {0};

426 
”r
;

428 
	`¢d_ùl_–em_šfo_£t_id
(&
šfo
, 
id
);

429 
”r
 = 
	`¢d_ùl_–em_šfo
(
ùl
, &
šfo
);

430 ià(
”r
 < 0)

431  
”r
;

432 ià(!
	`¢d_ùl_–em_šfo_is_v_»adabË
(&
šfo
))

433  -
EINVAL
;

434 ià(
	`¢d_ùl_–em_šfo_g‘_ty³
(&
šfo
è!ğ
SND_CTL_ELEM_TYPE_INTEGER
)

435  -
EINVAL
;

436 
»c
->
mšv®
 = 
	`¢d_ùl_–em_šfo_g‘_mš
(&
šfo
);

437 
»c
->
maxv®
 = 
	`¢d_ùl_–em_šfo_g‘_max
(&
šfo
);

438 
”r
 = 
	`¢d_ùl_–em_v_»ad
(
ùl
, 
id
, 
»c
->
buf
, (rec->buf));

439 ià(
”r
 < 0)

440  
”r
;

441 
”r
 = 
	`¢d_v_·r£_dB_šfo
(
»c
->
buf
, Ôec->buf), &»c->
v
);

442 ià(
”r
 < 0)

443  
”r
;

445 
	}
}

455 
	$¢d_ùl_g‘_dB_¿nge
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

456 *
mš
, *
max
)

458 
v_šfo
 
šfo
;

459 
”r
;

461 
”r
 = 
	`g‘_v_šfo
(
ùl
, 
id
, &
šfo
);

462 ià(
”r
 < 0)

463  
”r
;

464  
	`¢d_v_g‘_dB_¿nge
(
šfo
.
v
, info.
mšv®
, info.
maxv®
,

465 
mš
, 
max
);

466 
	}
}

476 
	$¢d_ùl_cÚv”t_to_dB
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

477 
vŞume
, *
db_gaš
)

479 
v_šfo
 
šfo
;

480 
”r
;

482 
”r
 = 
	`g‘_v_šfo
(
ùl
, 
id
, &
šfo
);

483 ià(
”r
 < 0)

484  
”r
;

485  
	`¢d_v_cÚv”t_to_dB
(
šfo
.
v
, info.
mšv®
, info.
maxv®
,

486 
vŞume
, 
db_gaš
);

487 
	}
}

499 
	$¢d_ùl_cÚv”t_äom_dB
(
¢d_ùl_t
 *
ùl
, cÚ¡ 
¢d_ùl_–em_id_t
 *
id
,

500 
db_gaš
, *
v®ue
, 
xdœ
)

502 
v_šfo
 
šfo
;

503 
”r
;

505 
”r
 = 
	`g‘_v_šfo
(
ùl
, 
id
, &
šfo
);

506 ià(
”r
 < 0)

507  
”r
;

508  
	`¢d_v_cÚv”t_äom_dB
(
šfo
.
v
, info.
mšv®
, info.
maxv®
,

509 
db_gaš
, 
v®ue
, 
xdœ
);

510 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/dlmisc.c

30 
	~"loÿl.h
"

31 
	~"li¡.h
"

32 #ifdeà
HAVE_LIBPTHREAD


33 
	~<±h»ad.h
>

35 
	~<lim™s.h
>

37 #ià
defšed
(
HAVE_LIBDL
è&& defšed(
__GLIBC__
è&& !defšed(
__UCLIBC__
)

38 
	#DL_ORIGIN_AVAILABLE
 1

	)

41 #iâdeà
DOC_HIDDEN


42 #iâdeà
PIC


43 
¢d_dlsym_lšk
 *
	g¢d_dlsym_¡¬t
 = 
NULL
;

45 
	g¢d_¶ugš_dœ_£t
 = 0;

46 *
	g¢d_¶ugš_dœ
 = 
NULL
;

49 #ifdeà
HAVE_LIBPTHREAD


50 
±h»ad_mu‹x_t
 
	g¢d_dÍ©h_mu‹x
 = 
PTHREAD_MUTEX_INITIALIZER
;

52 
šlše
 
	$¢d_dÍ©h_lock
()

54 
	`±h»ad_mu‹x_lock
(&
¢d_dÍ©h_mu‹x
);

55 
	}
}

57 
šlše
 
	$¢d_dÍ©h_uÆock
()

59 
	`±h»ad_mu‹x_uÆock
(&
¢d_dÍ©h_mu‹x
);

60 
	}
}

62 
šlše
 
	$¢d_dÍ©h_lock
(è{
	}
}

63 
šlše
 
	$¢d_dÍ©h_uÆock
(è{
	}
}

66 
	$¢d_dlšfo_Üigš
(*
·th
, 
size_t
 
·th_Ën
)

68 #ifdeà
DL_ORIGIN_AVAILABLE


69 
lšk_m­
 *
lšks
;

70 
Dl_šfo
 
šfo
;

71 
Üigš
[
PATH_MAX
];

72 ià(
	`dÏddr1
(&
¢d_dÍ©h
, &
šfo
, (**)&
lšks
, 
RTLD_DL_LINKMAP
) == 0)

74 ià(
	`dlšfo
(
lšks
, 
RTLD_DI_ORIGIN
, 
Üigš
))

76 
	`¢´štf
(
·th
, 
·th_Ën
, "%s/®§-lib", 
Üigš
);

77 ià(
	`acûss
(
·th
, 
X_OK
) == 0)

78 
¢d_¶ugš_dœ
 = 
	`¡rdup
(
·th
);

80 
	}
}

90 
	$¢d_dÍ©h
(*
·th
, 
size_t
 
·th_Ën
, cÚ¡ *
Çme
)

92 
	`¢d_dÍ©h_lock
();

93 ià(!
¢d_¶ugš_dœ_£t
) {

94 cÚ¡ *
’v
 = 
	`g‘’v
("ALSA_PLUGIN_DIR");

95 ià(
’v
) {

96 
¢d_¶ugš_dœ
 = 
	`¡rdup
(
’v
);

98 
	`¢d_dlšfo_Üigš
(
·th
, 
·th_Ën
);

100 
¢d_¶ugš_dœ_£t
 = 1;

102 
	`¢´štf
(
·th
, 
·th_Ën
, "%s/%s",

103 
¢d_¶ugš_dœ
 ? snd_¶ugš_dœ : 
ALSA_PLUGIN_DIR
, 
Çme
);

104 
	`¢d_dÍ©h_uÆock
();

106 
	}
}

119 #iâdeà
DOXYGEN


120 
EXPORT_SYMBOL
 *
	$INTERNAL
(
¢d_dlİ’
)(cÚ¡ *
Çme
, 
mode
, *
”rbuf
, 
size_t
 
”rbuæ’
)

122 *
	$¢d_dlİ’
(cÚ¡ *
Çme
, 
mode
, *
”rbuf
, 
size_t
 
”rbuæ’
)

125 #iâdeà
PIC


126 ià(
Çme
 =ğ
NULL
)

127  &
¢d_dlsym_¡¬t
;

129 #ifdeà
HAVE_LIBDL


130 ià(
Çme
 =ğ
NULL
) {

131 cÚ¡ * 
£lf
 = 
NULL
;

132 ià(
£lf
 =ğ
NULL
) {

133 
Dl_šfo
 
dlšfo
;

134 ià(
	`dÏddr
(
¢d_dlİ’
, &
dlšfo
) > 0)

135 
£lf
 = 
dlšfo
.
dli_âame
;

137 
Çme
 = 
£lf
;

141 #ifdeà
HAVE_LIBDL


147 *
hªdË
 = 
NULL
;

148 cÚ¡ *
f’ame
 = 
Çme
;

149 
·th
[
PATH_MAX
];

151 ià(
Çme
 &&‚ame[0] != '/') {

152 ià(
	`¢d_dÍ©h
(
·th
, Õ©h), 
Çme
) == 0)

153 
f’ame
 = 
·th
;

155 
hªdË
 = 
	`dlİ’
(
f’ame
, 
mode
);

156 ià(!
hªdË
)

157 
”½©h
;

158  
hªdË
;

159 
”½©h
:

160 ià(
”rbuf
)

161 
	`¢´štf
(
”rbuf
, 
”rbuæ’
, "%s", 
	`dË¼Ü
());

163  
NULL
;

164 
	}
}

166 #iâdeà
DOXYGEN


167 
EXPORT_SYMBOL
 *
	$INTERNAL
(
¢d_dlİ’_Şd
)(cÚ¡ *
Çme
, 
mode
)

169  
	`INTERNAL
(
¢d_dlİ’
)(
Çme
, 
mode
, 
NULL
, 0);

170 
	}
}

173 #iâdeà
DOC_HIDDEN


174 
u£_symbŞ_v”siÚ
(
__¢d_dlİ’_Şd
, 
¢d_dlİ’
, 
ALSA_0
.9);

175 
u£_deçuÉ_symbŞ_v”siÚ
(
__¢d_dlİ’
, 
¢d_dlİ’
, 
ALSA_1
.1.6);

186 
	$¢d_dlşo£
(*
hªdË
)

188 #iâdeà
PIC


189 ià(
hªdË
 =ğ&
¢d_dlsym_¡¬t
)

192 #ifdeà
HAVE_LIBDL


193  
	`dlşo£
(
hªdË
);

197 
	}
}

209 
	$¢d_dlsym_v”ify
(*
hªdË
, cÚ¡ *
Çme
, cÚ¡ *
v”siÚ
)

211 #ifdeà
HAVE_LIBDL


212 
»s
;

213 *
vÇme
;

215 ià(
hªdË
 =ğ
NULL
)

216  -
EINVAL
;

217 
vÇme
 = 
	`®loÿ
(1 + 
	`¡¾’
(
Çme
è+ sŒËn(
v”siÚ
) + 1);

218 ià(
vÇme
 =ğ
NULL
)

219  -
ENOMEM
;

220 
vÇme
[0] = '_';

221 
	`¡rıy
(
vÇme
 + 1, 
Çme
);

222 
	`¡rÿt
(
vÇme
, 
v”siÚ
);

223 
»s
 = 
	`dlsym
(
hªdË
, 
vÇme
è=ğ
NULL
 ? -
ENOENT
 : 0;

225 ià(
»s
 < 0)

226 
	`SNDERR
("uÇbËØv”ify v”siÚ fÜ symbŞ %s", 
Çme
);

227  
»s
;

231 
	}
}

246 *
	$¢d_dlsym
(*
hªdË
, cÚ¡ *
Çme
, cÚ¡ *
v”siÚ
)

248 
”r
;

250 #iâdeà
PIC


251 ià(
hªdË
 =ğ&
¢d_dlsym_¡¬t
) {

254 
¢d_dlsym_lšk
 *
lšk
 = 
¢d_dlsym_¡¬t
;

255 
lšk
) {

256 ià(!
	`¡rcmp
(
Çme
, 
lšk
->
dlsym_Çme
))

257  (*)
lšk
->
dlsym_±r
;

258 
lšk
 =†šk->
Ãxt
;

260  
NULL
;

263 #ifdeà
HAVE_LIBDL


264 #ifdeà
VERSIONED_SYMBOLS


265 ià(
v”siÚ
) {

266 
”r
 = 
	`¢d_dlsym_v”ify
(
hªdË
, 
Çme
, 
v”siÚ
);

267 ià(
”r
 < 0)

268  
NULL
;

271  
	`dlsym
(
hªdË
, 
Çme
);

273  
NULL
;

275 
	}
}

281 #iâdeà
DOC_HIDDEN


282 
	sdlobj_ÿche
 {

283 cÚ¡ *
	mlib
;

284 cÚ¡ *
	mÇme
;

285 *
	mdlobj
;

286 *
	mfunc
;

287 
	m»fút
;

288 
li¡_h—d
 
	mli¡
;

291 #ifdeà
HAVE_LIBPTHREAD


292 
±h»ad_mu‹x_t
 
	g¢d_dlobj_mu‹x
 = 
PTHREAD_MUTEX_INITIALIZER
;

294 
šlše
 
	$¢d_dlobj_lock
()

296 
	`±h»ad_mu‹x_lock
(&
¢d_dlobj_mu‹x
);

297 
	}
}

299 
šlše
 
	$¢d_dlobj_uÆock
()

301 
	`±h»ad_mu‹x_uÆock
(&
¢d_dlobj_mu‹x
);

302 
	}
}

304 
šlše
 
	$¢d_dlobj_lock
(è{
	}
}

305 
šlše
 
	$¢d_dlobj_uÆock
(è{
	}
}

308 
LIST_HEAD
(
pcm_dlobj_li¡
);

310 
dlobj_ÿche
 *

311 
	$¢d_dlobj_ÿche_g‘0
(cÚ¡ *
lib
, cÚ¡ *
Çme
,

312 cÚ¡ *
v”siÚ
, 
v”bo£
)

314 
li¡_h—d
 *
p
;

315 
dlobj_ÿche
 *
c
;

316 *
func
, *
dlobj
;

317 
”rbuf
[256];

319 
	`li¡_fÜ_—ch
(
p
, &
pcm_dlobj_li¡
) {

320 
c
 = 
	`li¡_’Œy
(
p
, 
dlobj_ÿche
, 
li¡
);

321 ià(
c
->
lib
 &&†ib && 
	`¡rcmp
(c->lib,†ib) != 0)

323 ià(!
c
->
lib
 &&†ib)

325 ià(!
lib
 && 
c
->lib)

327 ià(
	`¡rcmp
(
c
->
Çme
,‚ame) == 0) {

328 
c
->
»fút
++;

329  
c
;

333 
”rbuf
[0] = '\0';

334 
dlobj
 = 
	`INTERNAL
(
¢d_dlİ’
)(
lib
, 
RTLD_NOW
,

335 
v”bo£
 ? 
”rbuf
 : 0,

336 
v”bo£
 ? (
”rbuf
) : 0);

337 ià(
dlobj
 =ğ
NULL
) {

338 ià(
v”bo£
)

339 
	`SNDERR
("Cannot open shared†ibrary %s (%s)",

340 
lib
 ?†ib : "[builtin]",

341 
”rbuf
);

342  
NULL
;

345 
func
 = 
	`¢d_dlsym
(
dlobj
, 
Çme
, 
v”siÚ
);

346 ià(
func
 =ğ
NULL
) {

347 ià(
v”bo£
)

348 
	`SNDERR
("symbol %s is‚ot defined inside %s",

349 
Çme
, 
lib
 ?†ib : "[builtin]");

350 
__”r
;

352 
c
 = 
	`m®loc
((*c));

353 ià(! 
c
)

354 
__”r
;

355 
c
->
»fút
 = 1;

356 
c
->
lib
 =†ib ? 
	`¡rdup
Öibè: 
NULL
;

357 
c
->
Çme
 = 
	`¡rdup
(name);

358 ià((
lib
 && ! 
c
->libè|| ! c->
Çme
) {

359 
	`ä“
((*)
c
->
Çme
);

360 
	`ä“
((*)
c
->
lib
);

361 
	`ä“
(
c
);

362 
__”r
:

363 
	`¢d_dlşo£
(
dlobj
);

364  
NULL
;

366 
c
->
dlobj
 = dlobj;

367 
c
->
func
 = func;

368 
	`li¡_add_
(&
c
->
li¡
, &
pcm_dlobj_li¡
);

369  
c
;

370 
	}
}

372 *
	$¢d_dlobj_ÿche_g‘
(cÚ¡ *
lib
, cÚ¡ *
Çme
,

373 cÚ¡ *
v”siÚ
, 
v”bo£
)

375 
dlobj_ÿche
 *
c
;

376 *
func
 = 
NULL
;

378 
	`¢d_dlobj_lock
();

379 
c
 = 
	`¢d_dlobj_ÿche_g‘0
(
lib
, 
Çme
, 
v”siÚ
, 
v”bo£
);

380 ià(
c
)

381 
func
 = 
c
->func;

382 
	`¢d_dlobj_uÆock
();

383  
func
;

384 
	}
}

386 *
	$¢d_dlobj_ÿche_g‘2
(cÚ¡ *
lib
, cÚ¡ *
Çme
,

387 cÚ¡ *
v”siÚ
, 
v”bo£
)

389 
dlobj_ÿche
 *
c
;

390 *
func
 = 
NULL
;

392 
	`¢d_dlobj_lock
();

393 
c
 = 
	`¢d_dlobj_ÿche_g‘0
(
lib
, 
Çme
, 
v”siÚ
, 
v”bo£
);

394 ià(
c
) {

395 
func
 = 
c
->func;

397 
c
->
»fút
++;

399 
	`¢d_dlobj_uÆock
();

400  
func
;

401 
	}
}

403 
	$¢d_dlobj_ÿche_put
(*
func
)

405 
li¡_h—d
 *
p
;

406 
dlobj_ÿche
 *
c
;

407 
»fút
;

409 ià(!
func
)

410  -
ENOENT
;

412 
	`¢d_dlobj_lock
();

413 
	`li¡_fÜ_—ch
(
p
, &
pcm_dlobj_li¡
) {

414 
c
 = 
	`li¡_’Œy
(
p
, 
dlobj_ÿche
, 
li¡
);

415 ià(
c
->
func
 == func) {

416 
»fút
 = 
c
->refcnt;

417 ià(
c
->
»fút
 > 0)

418 
c
->
»fút
--;

419 
	`¢d_dlobj_uÆock
();

420  
»fút
 =ğ1 ? 0 : -
EINVAL
;

423 
	`¢d_dlobj_uÆock
();

424  -
ENOENT
;

425 
	}
}

427 
	$¢d_dlobj_ÿche_ş—nup
()

429 
li¡_h—d
 *
p
, *
Åos
;

430 
dlobj_ÿche
 *
c
;

432 
	`¢d_dlobj_lock
();

433 
	`li¡_fÜ_—ch_§ã
(
p
, 
Åos
, &
pcm_dlobj_li¡
) {

434 
c
 = 
	`li¡_’Œy
(
p
, 
dlobj_ÿche
, 
li¡
);

435 ià(
c
->
»fút
)

437 
	`li¡_d–
(
p
);

438 
	`¢d_dlşo£
(
c
->
dlobj
);

439 
	`ä“
((*)
c
->
Çme
);

440 
	`ä“
((*)
c
->
lib
);

441 
	`ä“
(
c
);

443 
	`¢d_dlobj_uÆock
();

444 
	`¢d_dÍ©h_lock
();

445 
¢d_¶ugš_dœ_£t
 = 0;

446 
	`ä“
(
¢d_¶ugš_dœ
);

447 
¢d_¶ugš_dœ
 = 
NULL
;

448 
	`¢d_dÍ©h_uÆock
();

449 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/error.c

31 
	~"loÿl.h
"

32 
	~<¡dio.h
>

33 
	~<¡dlib.h
>

34 
	~<¡d¬g.h
>

35 
	~<¡ršg.h
>

40 cÚ¡ *
	g¢d_”rÜ_codes
[] =

51 cÚ¡ *
	$¢d_¡»¼Ü
(
”ºum
)

53 ià(
”ºum
 < 0)

54 
”ºum
 = -errnum;

55 ià(
”ºum
 < 
SND_ERROR_BEGIN
)

56  (cÚ¡ *è
	`¡»¼Ü
(
”ºum
);

57 
”ºum
 -ğ
SND_ERROR_BEGIN
;

58 ià((è
”ºum
 >ğ(
¢d_”rÜ_codes
) / (const *))

60  
¢d_”rÜ_codes
[
”ºum
];

61 
	}
}

63 #iâdeà
DOC_HIDDEN


64 #ifdeà
HAVE___THREAD


65 
	#TLS_PFX
 
__th»ad


	)

67 
	#TLS_PFX


	)

71 
TLS_PFX
 
¢d_loÿl_”rÜ_hªdËr_t
 
	gloÿl_”rÜ
 = 
NULL
;

78 
¢d_loÿl_”rÜ_hªdËr_t
 
	$¢d_lib_”rÜ_£t_loÿl
(
¢d_loÿl_”rÜ_hªdËr_t
 
func
)

80 
¢d_loÿl_”rÜ_hªdËr_t
 
Şd
 = 
loÿl_”rÜ
;

81 
loÿl_”rÜ
 = 
func
;

82  
Şd
;

83 
	}
}

98 
	$¢d_lib_”rÜ_deçuÉ
(cÚ¡ *
fe
, 
lše
, cÚ¡ *
funùiÚ
, 
”r
, cÚ¡ *
fmt
, ...)

100 
va_li¡
 
¬g
;

101 
	`va_¡¬t
(
¬g
, 
fmt
);

102 ià(
loÿl_”rÜ
) {

103 
	`loÿl_”rÜ
(
fe
, 
lše
, 
funùiÚ
, 
”r
, 
fmt
, 
¬g
);

104 
	`va_’d
(
¬g
);

107 
	`årštf
(
¡d”r
, "ALSA†ib %s:%i:(%sè", 
fe
, 
lše
, 
funùiÚ
);

108 
	`vårštf
(
¡d”r
, 
fmt
, 
¬g
);

109 ià(
”r
)

110 
	`årštf
(
¡d”r
, ": %s", 
	`¢d_¡»¼Ü
(
”r
));

111 
	`putc
('\n', 
¡d”r
);

112 
	`va_’d
(
¬g
);

113 
	}
}

120 
¢d_lib_”rÜ_hªdËr_t
 
	g¢d_lib_”rÜ
 = 
¢d_lib_”rÜ_deçuÉ
;

129 
	$¢d_lib_”rÜ_£t_hªdËr
(
¢d_lib_”rÜ_hªdËr_t
 
hªdËr
)

131 
¢d_lib_”rÜ
 = 
hªdËr
 =ğ
NULL
 ? 
¢d_lib_”rÜ_deçuÉ
 : handler;

132 #iâdeà
NDEBUG


133 ià(
¢d_lib_”rÜ
 !ğ
¢d_lib_”rÜ_deçuÉ
)

134 
¢d_”r_msg
 = 
¢d_lib_”rÜ
;

137 
	}
}

143 cÚ¡ *
	$¢d_asoundlib_v”siÚ
()

145  
SND_LIB_VERSION_STR
;

146 
	}
}

148 #iâdeà
NDEBUG


152 
	$¢d_”r_msg_deçuÉ
(cÚ¡ *
fe
, 
lše
, cÚ¡ *
funùiÚ
, 
”r
, cÚ¡ *
fmt
, ...)

154 
va_li¡
 
¬g
;

155 cÚ¡ *
v”bo£
;

157 
v”bo£
 = 
	`g‘’v
("LIBASOUND_DEBUG");

158 ià(! 
v”bo£
 || ! *verbose)

160 
	`va_¡¬t
(
¬g
, 
fmt
);

161 
	`årštf
(
¡d”r
, "ALSA†ib %s:%i:(%sè", 
fe
, 
lše
, 
funùiÚ
);

162 
	`vårštf
(
¡d”r
, 
fmt
, 
¬g
);

163 ià(
”r
)

164 
	`årštf
(
¡d”r
, ": %s", 
	`¢d_¡»¼Ü
(
”r
));

165 
	`putc
('\n', 
¡d”r
);

166 
	`va_’d
(
¬g
);

167 #ifdeà
ALSA_DEBUG_ASSERT


168 
v”bo£
 = 
	`g‘’v
("LIBASOUND_DEBUG_ASSERT");

169 ià(
v”bo£
 && *verbose)

170 
	`as£¹
(0);

172 
	}
}

177 
¢d_lib_”rÜ_hªdËr_t
 
	g¢d_”r_msg
 = 
¢d_”r_msg_deçuÉ
;

192 
size_t
 
	$¢d_¡¾ıy
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
size
)

194 
size_t
 
»t
 = 
	`¡¾’
(
¤c
);

195 ià(
size
) {

196 
size_t
 
Ën
 = 
»t
 >ğ
size
 ? size - 1 :„et;

197 
	`memıy
(
d¡
, 
¤c
, 
Ën
);

198 
d¡
[
Ën
] = '\0';

200  
»t
;

201 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep.c

31 
	~"hwd•_loÿl.h
"

32 
	~<¡dio.h
>

33 
	~<¡dlib.h
>

34 
	~<uni¡d.h
>

35 
	~<¡ršg.h
>

36 
	~<fú.h
>

37 
	~<sys/ioùl.h
>

39 
	$¢d_hwd•_İ’_cÚf
(
¢d_hwd•_t
 **
hwd•
,

40 cÚ¡ *
Çme
, 
¢d_cÚfig_t
 *
hwd•_roÙ
,

41 
¢d_cÚfig_t
 *
hwd•_cÚf
, 
mode
)

43 cÚ¡ *
¡r
;

44 
buf
[256], 
”rbuf
[256];

45 
”r
;

46 
¢d_cÚfig_t
 *
cÚf
, *
ty³_cÚf
 = 
NULL
;

47 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

48 cÚ¡ *
id
;

49 cÚ¡ *
lib
 = 
NULL
, *
İ’_Çme
 = NULL;

50 (*
İ’_func
)(
¢d_hwd•_t
 **, cÚ¡ *, 
¢d_cÚfig_t
 *, snd_cÚfig_ˆ*, èğ
NULL
;

51 #iâdeà
PIC


52 *
	`¢d_hwd•_İ’_symbŞs
();

54 *
h
 = 
NULL
;

55 ià(
	`¢d_cÚfig_g‘_ty³
(
hwd•_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

56 ià(
Çme
)

57 
	`SNDERR
("Inv®idy³ fÜ HWDEP % defš™iÚ", 
Çme
);

59 
	`SNDERR
("Invalidype for HWDEP definition");

60  -
EINVAL
;

62 
”r
 = 
	`¢d_cÚfig_£¬ch
(
hwd•_cÚf
, "ty³", &
cÚf
);

63 ià(
”r
 < 0) {

64 
	`SNDERR
("type is‚ot defined");

65  
”r
;

67 
”r
 = 
	`¢d_cÚfig_g‘_id
(
cÚf
, &
id
);

68 ià(
”r
 < 0) {

69 
	`SNDERR
("unableo get id");

70  
”r
;

72 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
cÚf
, &
¡r
);

73 ià(
”r
 < 0) {

74 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

75  
”r
;

77 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
hwd•_roÙ
, "hwd•_ty³", 
¡r
, &
ty³_cÚf
);

78 ià(
”r
 >= 0) {

79 ià(
	`¢d_cÚfig_g‘_ty³
(
ty³_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

80 
	`SNDERR
("Inv®idy³ fÜ HWDEPy³ % defš™iÚ", 
¡r
);

81 
”r
 = -
EINVAL
;

82 
_”r
;

84 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
ty³_cÚf
) {

85 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

86 cÚ¡ *
id
;

87 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

89 ià(
	`¡rcmp
(
id
, "comment") == 0)

91 ià(
	`¡rcmp
(
id
, "lib") == 0) {

92 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
lib
);

93 ià(
”r
 < 0) {

94 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

95 
_”r
;

99 ià(
	`¡rcmp
(
id
, "open") == 0) {

100 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
İ’_Çme
);

101 ià(
”r
 < 0) {

102 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

103 
_”r
;

107 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

108 
”r
 = -
EINVAL
;

109 
_”r
;

112 ià(!
İ’_Çme
) {

113 
İ’_Çme
 = 
buf
;

114 
	`¢´štf
(
buf
, (buf), "_¢d_hwd•_%s_İ’", 
¡r
);

116 #iâdeà
PIC


117 
	`¢d_hwd•_İ’_symbŞs
();

119 
h
 = 
	`INTERNAL
(
¢d_dlİ’
)(
lib
, 
RTLD_NOW
, 
”rbuf
, (errbuf));

120 ià(
h
)

121 
İ’_func
 = 
	`¢d_dlsym
(
h
, 
İ’_Çme
, 
	`SND_DLSYM_VERSION
(
SND_HWDEP_DLSYM_VERSION
));

122 
”r
 = 0;

123 ià(!
h
) {

124 
	`SNDERR
("CªnÙ o³Àsh¬ed†ib¿ry % (%s)", 
lib
, 
”rbuf
);

125 
”r
 = -
ENOENT
;

126 } ià(!
İ’_func
) {

127 
	`SNDERR
("symbŞ % i nÙ defšed insid%s", 
İ’_Çme
, 
lib
);

128 
	`¢d_dlşo£
(
h
);

129 
”r
 = -
ENXIO
;

131 
_”r
:

132 ià(
ty³_cÚf
)

133 
	`¢d_cÚfig_d–‘e
(
ty³_cÚf
);

134 ià(
”r
 >= 0) {

135 
”r
 = 
	`İ’_func
(
hwd•
, 
Çme
, 
hwd•_roÙ
, 
hwd•_cÚf
, 
mode
);

136 ià(
”r
 >= 0) {

137 (*
hwd•
)->
dl_hªdË
 = 
h
;

139 
	`¢d_dlşo£
(
h
);

142  
”r
;

143 
	}
}

145 
	$¢d_hwd•_İ’_noupd©e
(
¢d_hwd•_t
 **
hwd•
, 
¢d_cÚfig_t
 *
roÙ
, cÚ¡ *
Çme
, 
mode
)

147 
”r
;

148 
¢d_cÚfig_t
 *
hwd•_cÚf
;

149 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "hwd•", 
Çme
, &
hwd•_cÚf
);

150 ià(
”r
 < 0) {

151 
	`SNDERR
("UnknowÀHwD• %s", 
Çme
);

152  
”r
;

154 
”r
 = 
	`¢d_hwd•_İ’_cÚf
(
hwd•
, 
Çme
, 
roÙ
, 
hwd•_cÚf
, 
mode
);

155 
	`¢d_cÚfig_d–‘e
(
hwd•_cÚf
);

156  
”r
;

157 
	}
}

169 
	$¢d_hwd•_İ’
(
¢d_hwd•_t
 **
hwd•
, cÚ¡ *
Çme
, 
mode
)

171 
¢d_cÚfig_t
 *
tİ
;

172 
”r
;

174 
	`as£¹
(
hwd•
 && 
Çme
);

175 
”r
 = 
	`¢d_cÚfig_upd©e_»f
(&
tİ
);

176 ià(
”r
 < 0)

177  
”r
;

178 
”r
 = 
	`¢d_hwd•_İ’_noupd©e
(
hwd•
, 
tİ
, 
Çme
, 
mode
);

179 
	`¢d_cÚfig_uÄef
(
tİ
);

180  
”r
;

181 
	}
}

194 
	$¢d_hwd•_İ’_lcÚf
(
¢d_hwd•_t
 **
hwd•
, cÚ¡ *
Çme
,

195 
mode
, 
¢d_cÚfig_t
 *
lcÚf
)

197 
	`as£¹
(
hwd•
 && 
Çme
 && 
lcÚf
);

198  
	`¢d_hwd•_İ’_noupd©e
(
hwd•
, 
lcÚf
, 
Çme
, 
mode
);

199 
	}
}

209 
	$¢d_hwd•_şo£
(
¢d_hwd•_t
 *
hwd•
)

211 
”r
;

212 
	`as£¹
(
hwd•
);

213 
”r
 = 
hwd•
->
İs
->
	`şo£
(hwdep);

214 ià(
hwd•
->
dl_hªdË
)

215 
	`¢d_dlşo£
(
hwd•
->
dl_hªdË
);

216 
	`ä“
(
hwd•
->
Çme
);

217 
	`ä“
(
hwd•
);

218  
”r
;

219 
	}
}

229 cÚ¡ *
	$¢d_hwd•_Çme
(
¢d_hwd•_t
 *
hwd•
)

231 
	`as£¹
(
hwd•
);

232  
hwd•
->
Çme
;

233 
	}
}

242 
¢d_hwd•_ty³_t
 
	$¢d_hwd•_ty³
(
¢d_hwd•_t
 *
hwd•
)

244 
	`as£¹
(
hwd•
);

245  
hwd•
->
ty³
;

246 
	}
}

253 
	$¢d_hwd•_pŞl_desütÜs_couÁ
(
¢d_hwd•_t
 *
hwd•
)

255 
	`as£¹
(
hwd•
);

257 
	}
}

266 
	$¢d_hwd•_pŞl_desütÜs
(
¢d_hwd•_t
 *
hwd•
, 
pŞlfd
 *
pfds
, 
¥aû
)

268 
	`as£¹
(
hwd•
);

269 ià(
¥aû
 >= 1) {

270 
pfds
->
fd
 = 
hwd•
->
pŞl_fd
;

271 
hwd•
->
mode
 & 
O_ACCMODE
) {

272 
O_WRONLY
:

273 
pfds
->
ev’ts
 = 
POLLOUT
|
POLLERR
|
POLLNVAL
;

275 
O_RDONLY
:

276 
pfds
->
ev’ts
 = 
POLLIN
|
POLLERR
|
POLLNVAL
;

278 
O_RDWR
:

279 
pfds
->
ev’ts
 = 
POLLOUT
|
POLLIN
|
POLLERR
|
POLLNVAL
;

282  -
EIO
;

287 
	}
}

297 
	$¢d_hwd•_pŞl_desütÜs_»v’ts
(
¢d_hwd•_t
 *
hwd•
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

299 
	`as£¹
(
hwd•
 && 
pfds
 && 
»v’ts
);

300 ià(
nfds
 == 1) {

301 *
»v’ts
 = 
pfds
->revents;

304  -
EINVAL
;

305 
	}
}

313 
	$¢d_hwd•_nÚblock
(
¢d_hwd•_t
 *
hwd•
, 
nÚblock
)

315 
”r
;

316 
	`as£¹
(
hwd•
);

317 ià((
”r
 = 
hwd•
->
İs
->
	`nÚblock
(hwd•, 
nÚblock
)) < 0)

318  
”r
;

319 ià(
nÚblock
)

320 
hwd•
->
mode
 |ğ
SND_HWDEP_OPEN_NONBLOCK
;

322 
hwd•
->
mode
 &ğ~
SND_HWDEP_OPEN_NONBLOCK
;

324 
	}
}

330 
size_t
 
	$¢d_hwd•_šfo_sizeof
()

332  (
¢d_hwd•_šfo_t
);

333 
	}
}

343 
	$¢d_hwd•_šfo_m®loc
(
¢d_hwd•_šfo_t
 **
šfo
)

345 
	`as£¹
(
šfo
);

346 *
šfo
 = 
	`ÿÎoc
(1, (
¢d_hwd•_šfo_t
));

347 ià(!*
šfo
)

348  -
ENOMEM
;

350 
	}
}

359 
	$¢d_hwd•_šfo_ä“
(
¢d_hwd•_šfo_t
 *
šfo
)

361 
	`as£¹
(
šfo
);

362 
	`ä“
(
šfo
);

363 
	}
}

370 
	$¢d_hwd•_šfo_cİy
(
¢d_hwd•_šfo_t
 *
d¡
, cÚ¡ snd_hwd•_šfo_ˆ*
¤c
)

372 
	`as£¹
(
d¡
 && 
¤c
);

373 *
d¡
 = *
¤c
;

374 
	}
}

381 
	$¢d_hwd•_šfo_g‘_ÿrd
(cÚ¡ 
¢d_hwd•_šfo_t
 *
obj
)

383 
	`as£¹
(
obj
);

384  
obj
->
ÿrd
;

385 
	}
}

392 
	$¢d_hwd•_šfo_g‘_deviû
(cÚ¡ 
¢d_hwd•_šfo_t
 *
šfo
)

394 
	`as£¹
(
šfo
);

395  
šfo
->
deviû
;

396 
	}
}

403 cÚ¡ *
	$¢d_hwd•_šfo_g‘_id
(cÚ¡ 
¢d_hwd•_šfo_t
 *
obj
)

405 
	`as£¹
(
obj
);

406  (cÚ¡ *)
obj
->
id
;

407 
	}
}

414 cÚ¡ *
	$¢d_hwd•_šfo_g‘_Çme
(cÚ¡ 
¢d_hwd•_šfo_t
 *
obj
)

416 
	`as£¹
(
obj
);

417  (cÚ¡ *)
obj
->
Çme
;

418 
	}
}

425 
¢d_hwd•_içû_t
 
	$¢d_hwd•_šfo_g‘_içû
(cÚ¡ 
¢d_hwd•_šfo_t
 *
obj
)

427 
	`as£¹
(
obj
);

428  
obj
->
içû
;

429 
	}
}

436 
	$¢d_hwd•_šfo_£t_deviû
(
¢d_hwd•_šfo_t
 *
obj
, 
v®
)

438 
	`as£¹
(
obj
);

439 
obj
->
deviû
 = 
v®
;

440 
	}
}

448 
	$¢d_hwd•_šfo
(
¢d_hwd•_t
 *
hwd•
, 
¢d_hwd•_šfo_t
 * 
šfo
)

450 
	`as£¹
(
hwd•
);

451 
	`as£¹
(
šfo
);

452  
hwd•
->
İs
->
	`šfo
(hwd•, 
šfo
);

453 
	}
}

462 
	$¢d_hwd•_ioùl
(
¢d_hwd•_t
 *
hwd•
, 
»que¡
, * 
¬g
)

464 
	`as£¹
(
hwd•
);

465  
hwd•
->
İs
->
	`ioùl
(hwd•, 
»que¡
, 
¬g
);

466 
	}
}

474 
ssize_t
 
	$¢d_hwd•_wr™e
(
¢d_hwd•_t
 *
hwd•
, cÚ¡ *
bufãr
, 
size_t
 
size
)

476 
	`as£¹
(
hwd•
);

477 
	`as£¹
(((
hwd•
->
mode
 & 
O_ACCMODE
è=ğ
O_WRONLY
è|| ((hwd•->mod& O_ACCMODEè=ğ
O_RDWR
));

478 
	`as£¹
(
bufãr
 || 
size
 == 0);

479  
hwd•
->
İs
->
	`wr™e
(hwd•, 
bufãr
, 
size
);

480 
	}
}

488 
ssize_t
 
	$¢d_hwd•_»ad
(
¢d_hwd•_t
 *
hwd•
, *
bufãr
, 
size_t
 
size
)

490 
	`as£¹
(
hwd•
);

491 
	`as£¹
(((
hwd•
->
mode
 & 
O_ACCMODE
è=ğ
O_RDONLY
è|| ((hwd•->mod& O_ACCMODEè=ğ
O_RDWR
));

492 
	`as£¹
(
bufãr
 || 
size
 == 0);

493  (
hwd•
->
İs
->
»ad
)(hwd•, 
bufãr
, 
size
);

494 
	}
}

502 
	$¢d_hwd•_d¥_¡©us
(
¢d_hwd•_t
 *
hwd•
, 
¢d_hwd•_d¥_¡©us_t
 *
šfo
)

504 
	`as£¹
(
hwd•
);

505 
	`as£¹
(
šfo
);

506  
hwd•
->
İs
->
	`ioùl
(hwd•, 
SNDRV_HWDEP_IOCTL_DSP_STATUS
, (*)
šfo
);

507 
	}
}

515 
	$¢d_hwd•_d¥_lßd
(
¢d_hwd•_t
 *
hwd•
, 
¢d_hwd•_d¥_image_t
 *
block
)

517 
	`as£¹
(
hwd•
);

518 
	`as£¹
(
block
);

519  
hwd•
->
İs
->
	`ioùl
(hwd•, 
SNDRV_HWDEP_IOCTL_DSP_LOAD
, (*)
block
);

520 
	}
}

526 
size_t
 
	$¢d_hwd•_d¥_¡©us_sizeof
()

528  (
¢d_hwd•_d¥_¡©us_t
);

529 
	}
}

539 
	$¢d_hwd•_d¥_¡©us_m®loc
(
¢d_hwd•_d¥_¡©us_t
 **
šfo
)

541 
	`as£¹
(
šfo
);

542 *
šfo
 = 
	`ÿÎoc
(1, (
¢d_hwd•_d¥_¡©us_t
));

543 ià(!*
šfo
)

544  -
ENOMEM
;

546 
	}
}

555 
	$¢d_hwd•_d¥_¡©us_ä“
(
¢d_hwd•_d¥_¡©us_t
 *
šfo
)

557 
	`as£¹
(
šfo
);

558 
	`ä“
(
šfo
);

559 
	}
}

566 
	$¢d_hwd•_d¥_¡©us_cİy
(
¢d_hwd•_d¥_¡©us_t
 *
d¡
, cÚ¡ snd_hwd•_d¥_¡©us_ˆ*
¤c
)

568 
	`as£¹
(
d¡
 && 
¤c
);

569 *
d¡
 = *
¤c
;

570 
	}
}

577 
	$¢d_hwd•_d¥_¡©us_g‘_v”siÚ
(cÚ¡ 
¢d_hwd•_d¥_¡©us_t
 *
obj
)

579 
	`as£¹
(
obj
);

580  
obj
->
v”siÚ
;

581 
	}
}

588 cÚ¡ *
	$¢d_hwd•_d¥_¡©us_g‘_id
(cÚ¡ 
¢d_hwd•_d¥_¡©us_t
 *
obj
)

590 
	`as£¹
(
obj
);

591  (cÚ¡ *)
obj
->
id
;

592 
	}
}

599 
	$¢d_hwd•_d¥_¡©us_g‘_num_d¥s
(cÚ¡ 
¢d_hwd•_d¥_¡©us_t
 *
obj
)

601 
	`as£¹
(
obj
);

602  
obj
->
num_d¥s
;

603 
	}
}

610 
	$¢d_hwd•_d¥_¡©us_g‘_d¥_lßded
(cÚ¡ 
¢d_hwd•_d¥_¡©us_t
 *
šfo
)

612 
	`as£¹
(
šfo
);

613  
šfo
->
d¥_lßded
;

614 
	}
}

621 
	$¢d_hwd•_d¥_¡©us_g‘_ch_»ady
(cÚ¡ 
¢d_hwd•_d¥_¡©us_t
 *
obj
)

623 
	`as£¹
(
obj
);

624  
obj
->
ch_»ady
;

625 
	}
}

631 
size_t
 
	$¢d_hwd•_d¥_image_sizeof
()

633  (
¢d_hwd•_d¥_image_t
);

634 
	}
}

644 
	$¢d_hwd•_d¥_image_m®loc
(
¢d_hwd•_d¥_image_t
 **
šfo
)

646 
	`as£¹
(
šfo
);

647 *
šfo
 = 
	`ÿÎoc
(1, (
¢d_hwd•_d¥_image_t
));

648 ià(!*
šfo
)

649  -
ENOMEM
;

651 
	}
}

660 
	$¢d_hwd•_d¥_image_ä“
(
¢d_hwd•_d¥_image_t
 *
šfo
)

662 
	`as£¹
(
šfo
);

663 
	`ä“
(
šfo
);

664 
	}
}

671 
	$¢d_hwd•_d¥_image_cİy
(
¢d_hwd•_d¥_image_t
 *
d¡
, cÚ¡ snd_hwd•_d¥_image_ˆ*
¤c
)

673 
	`as£¹
(
d¡
 && 
¤c
);

674 *
d¡
 = *
¤c
;

675 
	}
}

682 
	$¢d_hwd•_d¥_image_g‘_šdex
(cÚ¡ 
¢d_hwd•_d¥_image_t
 *
obj
)

684 
	`as£¹
(
obj
);

685  
obj
->
šdex
;

686 
	}
}

693 cÚ¡ *
	$¢d_hwd•_d¥_image_g‘_Çme
(cÚ¡ 
¢d_hwd•_d¥_image_t
 *
obj
)

695 
	`as£¹
(
obj
);

696  (cÚ¡ *)
obj
->
Çme
;

697 
	}
}

704 
size_t
 
	$¢d_hwd•_d¥_image_g‘_Ëngth
(cÚ¡ 
¢d_hwd•_d¥_image_t
 *
obj
)

706 
	`as£¹
(
obj
);

707  
obj
->
Ëngth
;

708 
	}
}

715 cÚ¡ *
	$¢d_hwd•_d¥_image_g‘_image
(cÚ¡ 
¢d_hwd•_d¥_image_t
 *
obj
)

717 
	`as£¹
(
obj
);

718  
obj
->
image
;

719 
	}
}

726 
	$¢d_hwd•_d¥_image_£t_šdex
(
¢d_hwd•_d¥_image_t
 *
obj
, 
šdex
)

728 
	`as£¹
(
obj
);

729 
obj
->
šdex
 = index;

730 
	}
}

737 
	$¢d_hwd•_d¥_image_£t_Çme
(
¢d_hwd•_d¥_image_t
 *
obj
, cÚ¡ *
Çme
)

739 
	`as£¹
(
obj
 && 
Çme
);

740 
	`¡ºıy
((*)
obj
->
Çme
,‚ame, (obj->name));

741 
obj
->
Çme
[(obj->name)-1] = 0;

742 
	}
}

749 
	$¢d_hwd•_d¥_image_£t_Ëngth
(
¢d_hwd•_d¥_image_t
 *
obj
, 
size_t
 
Ëngth
)

751 
	`as£¹
(
obj
);

752 
obj
->
Ëngth
 =†ength;

753 
	}
}

760 
	$¢d_hwd•_d¥_image_£t_image
(
¢d_hwd•_d¥_image_t
 *
obj
, *
image
)

762 
	`as£¹
(
obj
);

763 
obj
->
image
 = image;

764 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep_hw.c

22 
	~"hwd•_loÿl.h
"

23 
	~<¡dio.h
>

24 
	~<¡dlib.h
>

25 
	~<uni¡d.h
>

26 
	~<¡ršg.h
>

27 
	~<fú.h
>

28 
	~<sys/ioùl.h
>

30 #iâdeà
PIC


32 cÚ¡ *
	g_¢d_moduË_hwd•_hw
 = "";

35 
	#SNDRV_FILE_HWDEP
 
ALSA_DEVICE_DIRECTORY
 "hwC%iD%i"

	)

36 
	#SNDRV_HWDEP_VERSION_MAX
 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 1)

	)

38 
	$¢d_hwd•_hw_şo£
(
¢d_hwd•_t
 *
hwd•
)

40 
»s
;

41 
	`as£¹
(
hwd•
);

42 
»s
 = 
	`şo£
(
hwd•
->
pŞl_fd
è< 0 ? -
”ºo
 : 0;

43  
»s
;

44 
	}
}

46 
	$¢d_hwd•_hw_nÚblock
(
¢d_hwd•_t
 *
hwd•
, 
nÚblock
)

48 
æags
;

49 
	`as£¹
(
hwd•
);

50 ià((
æags
 = 
	`fú
(
hwd•
->
pŞl_fd
, 
F_GETFL
)) < 0)

51  -
”ºo
;

52 ià(
nÚblock
)

53 
æags
 |ğ
O_NONBLOCK
;

55 
æags
 &ğ~
O_NONBLOCK
;

56 ià(
	`fú
(
hwd•
->
pŞl_fd
, 
F_SETFL
, 
æags
) < 0)

57  -
”ºo
;

59 
	}
}

61 
	$¢d_hwd•_hw_šfo
(
¢d_hwd•_t
 *
hwd•
, 
¢d_hwd•_šfo_t
 *
šfo
)

63 
	`as£¹
(
hwd•
 && 
šfo
);

64 ià(
	`ioùl
(
hwd•
->
pŞl_fd
, 
SNDRV_HWDEP_IOCTL_INFO
, 
šfo
) < 0)

65  -
”ºo
;

67 
	}
}

69 
	$¢d_hwd•_hw_ioùl
(
¢d_hwd•_t
 *
hwd•
, 
»que¡
, * 
¬g
)

71 
	`as£¹
(
hwd•
);

72 ià(
	`ioùl
(
hwd•
->
pŞl_fd
, 
»que¡
, 
¬g
) < 0)

73  -
”ºo
;

75 
	}
}

77 
ssize_t
 
	$¢d_hwd•_hw_wr™e
(
¢d_hwd•_t
 *
hwd•
, cÚ¡ *
bufãr
, 
size_t
 
size
)

79 
ssize_t
 
»suÉ
;

80 
	`as£¹
(
hwd•
 && (
bufãr
 || 
size
 == 0));

81 
»suÉ
 = 
	`wr™e
(
hwd•
->
pŞl_fd
, 
bufãr
, 
size
);

82 ià(
»suÉ
 < 0)

83  -
”ºo
;

84  
»suÉ
;

85 
	}
}

87 
ssize_t
 
	$¢d_hwd•_hw_»ad
(
¢d_hwd•_t
 *
hwd•
, *
bufãr
, 
size_t
 
size
)

89 
ssize_t
 
»suÉ
;

90 
	`as£¹
(
hwd•
 && (
bufãr
 || 
size
 == 0));

91 
»suÉ
 = 
	`»ad
(
hwd•
->
pŞl_fd
, 
bufãr
, 
size
);

92 ià(
»suÉ
 < 0)

93  -
”ºo
;

94  
»suÉ
;

95 
	}
}

97 cÚ¡ 
¢d_hwd•_İs_t
 
	g¢d_hwd•_hw_İs
 = {

98 .
şo£
 = 
¢d_hwd•_hw_şo£
,

99 .
	gnÚblock
 = 
¢d_hwd•_hw_nÚblock
,

100 .
	gšfo
 = 
¢d_hwd•_hw_šfo
,

101 .
	gioùl
 = 
¢d_hwd•_hw_ioùl
,

102 .
	gwr™e
 = 
¢d_hwd•_hw_wr™e
,

103 .
	g»ad
 = 
¢d_hwd•_hw_»ad
,

106 
	$¢d_hwd•_hw_İ’
(
¢d_hwd•_t
 **
hªdË
, cÚ¡ *
Çme
, 
ÿrd
, 
deviû
, 
mode
)

108 
fd
, 
v”
, 
»t
;

109 
f’ame
[(
SNDRV_FILE_HWDEP
) + 20];

110 
¢d_hwd•_t
 *
hwd•
;

111 
	`as£¹
(
hªdË
);

113 *
hªdË
 = 
NULL
;

115 ià(
ÿrd
 < 0 || c¬d >ğ
SND_MAX_CARDS
)

116  -
EINVAL
;

117 
	`¥rštf
(
f’ame
, 
SNDRV_FILE_HWDEP
, 
ÿrd
, 
deviû
);

118 
fd
 = 
	`¢d_İ’_deviû
(
f’ame
, 
mode
);

119 ià(
fd
 < 0) {

120 
	`¢d_ÿrd_lßd
(
ÿrd
);

121 
fd
 = 
	`¢d_İ’_deviû
(
f’ame
, 
mode
);

122 ià(
fd
 < 0)

123  -
”ºo
;

125 ià(
	`ioùl
(
fd
, 
SNDRV_HWDEP_IOCTL_PVERSION
, &
v”
) < 0) {

126 
»t
 = -
”ºo
;

127 
	`şo£
(
fd
);

128  
»t
;

130 ià(
	`SNDRV_PROTOCOL_INCOMPATIBLE
(
v”
, 
SNDRV_HWDEP_VERSION_MAX
)) {

131 
	`şo£
(
fd
);

132  -
SND_ERROR_INCOMPATIBLE_VERSION
;

134 
hwd•
 = (
¢d_hwd•_t
 *è
	`ÿÎoc
(1, (snd_hwdep_t));

135 ià(
hwd•
 =ğ
NULL
) {

136 
	`şo£
(
fd
);

137  -
ENOMEM
;

139 
hwd•
->
Çme
 = 
	`¡rdup
(name);

140 
hwd•
->
pŞl_fd
 = 
fd
;

141 
hwd•
->
mode
 = mode;

142 
hwd•
->
ty³
 = 
SND_HWDEP_TYPE_HW
;

143 
hwd•
->
İs
 = &
¢d_hwd•_hw_İs
;

144 *
hªdË
 = 
hwd•
;

146 
	}
}

148 
	$_¢d_hwd•_hw_İ’
(
¢d_hwd•_t
 **
hwd•
, *
Çme
,

149 
¢d_cÚfig_t
 *
roÙ
 
ATTRIBUTE_UNUSED
,

150 
¢d_cÚfig_t
 *
cÚf
, 
mode
)

152 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

153 
ÿrd
 = -1, 
deviû
 = 0;

154 
”r
;

155 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

156 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

157 cÚ¡ *
id
;

158 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

160 ià(
	`_¢d_cÚf_g’”ic_id
(
id
))

162 ià(
	`¡rcmp
(
id
, "card") == 0) {

163 
”r
 = 
	`¢d_cÚfig_g‘_ÿrd
(
n
);

164 ià(
”r
 < 0)

165  
”r
;

166 
ÿrd
 = 
”r
;

169 ià(
	`¡rcmp
(
id
, "device") == 0) {

170 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
deviû
);

171 ià(
”r
 < 0)

172  
”r
;

175 
	`SNDERR
("UÃx³ùed f›ld %s", 
id
);

176  -
EINVAL
;

178 ià(
ÿrd
 < 0)

179  -
EINVAL
;

180  
	`¢d_hwd•_hw_İ’
(
hwd•
, 
Çme
, 
ÿrd
, 
deviû
, 
mode
);

181 
	}
}

182 
SND_DLSYM_BUILD_VERSION
(
_¢d_hwd•_hw_İ’
, 
SND_HWDEP_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep_local.h

22 
	~"loÿl.h
"

23 
	~<¡dio.h
>

24 
	~<¡dlib.h
>

25 
	~<lim™s.h
>

28 (*
	mşo£
)(
¢d_hwd•_t
 *
	mhwd•
);

29 (*
	mnÚblock
)(
¢d_hwd•_t
 *
	mhwd•
, nonblock);

30 (*
	mšfo
)(
¢d_hwd•_t
 *
	mhwd•
, 
¢d_hwd•_šfo_t
 *info);

31 (*
	mioùl
)(
¢d_hwd•_t
 *
	mhwd•
, 
	m»que¡
, * 
	m¬g
);

32 
ssize_t
 (*
wr™e
)(
¢d_hwd•_t
 *
	mhwd•
, cÚ¡ *
	mbufãr
, 
size_t
 
	msize
);

33 
ssize_t
 (*
»ad
)(
¢d_hwd•_t
 *
	mhwd•
, *
	mbufãr
, 
size_t
 
	msize
);

34 } 
	t¢d_hwd•_İs_t
;

36 
	s_¢d_hwd•
 {

37 *
	mdl_hªdË
;

38 *
	mÇme
;

39 
¢d_hwd•_ty³_t
 
	mty³
;

40 
	mmode
;

41 
	mpŞl_fd
;

42 cÚ¡ 
¢d_hwd•_İs_t
 *
	mİs
;

43 *
	m´iv©e_d©a
;

46 
¢d_hwd•_hw_İ’
(
¢d_hwd•_t
 **
hªdË
, cÚ¡ *
Çme
, 
ÿrd
, 
deviû
, 
mode
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep_symbols.c

21 #iâdeà
PIC


23 cÚ¡ *
_¢d_moduË_hwd•_hw
;

25 cÚ¡ **
	g¢d_hwd•_İ’_objeùs
[] = {

26 &
_¢d_moduË_hwd•_hw


29 *
	$¢d_hwd•_İ’_symbŞs
()

31  
¢d_hwd•_İ’_objeùs
;

32 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/input.c

30 
	~"loÿl.h
"

31 
	~<¡d¬g.h
>

32 
	~<¡dio.h
>

33 
	~<¡dlib.h
>

34 
	~<uni¡d.h
>

36 #iâdeà
DOC_HIDDEN


38 
	s_¢d_šput_İs
 {

39 (*
	mşo£
)(
¢d_šput_t
 *
	mšput
);

40 (*
	msÿn
)(
¢d_šput_t
 *
	mšput
, cÚ¡ *
	mfÜm©
, 
va_li¡
 
	m¬gs
);

41 *(*(
	mg‘s
))(
¢d_šput_t
 *
	mšput
, *
	m¡r
, 
size_t
 
	msize
);

42 (*
	mg‘ch
)(
¢d_šput_t
 *
	mšput
);

43 (*
	mung‘ch
)(
¢d_šput_t
 *
	mšput
, 
	mc
);

44 } 
	t¢d_šput_İs_t
;

46 
	s_¢d_šput
 {

47 
¢d_šput_ty³_t
 
	mty³
;

48 cÚ¡ 
¢d_šput_İs_t
 *
	mİs
;

49 *
	m´iv©e_d©a
;

58 
	$¢d_šput_şo£
(
¢d_šput_t
 *
šput
)

60 
”r
 = 
šput
->
İs
->
	`şo£
(input);

61 
	`ä“
(
šput
);

62  
”r
;

63 
	}
}

74 
	$¢d_šput_sÿnf
(
¢d_šput_t
 *
šput
, cÚ¡ *
fÜm©
, ...)

76 
»suÉ
;

77 
va_li¡
 
¬gs
;

78 
	`va_¡¬t
(
¬gs
, 
fÜm©
);

79 
»suÉ
 = 
šput
->
İs
->
	`sÿn
(šput, 
fÜm©
, 
¬gs
);

80 
	`va_’d
(
¬gs
);

81  
»suÉ
;

82 
	}
}

94 *
	$¢d_šput_g‘s
(
¢d_šput_t
 *
šput
, *
¡r
, 
size_t
 
size
)

96  (
šput
->
İs
->
g‘s
)(šput, 
¡r
, 
size
);

97 
	}
}

104 
	$¢d_šput_g‘c
(
¢d_šput_t
 *
šput
)

106  
šput
->
İs
->
	`g‘ch
(input);

107 
	}
}

115 
	$¢d_šput_ung‘c
(
¢d_šput_t
 *
šput
, 
c
)

117  
šput
->
İs
->
	`ung‘ch
(šput, 
c
);

118 
	}
}

120 #iâdeà
DOC_HIDDEN


121 
	s_¢d_šput_¡dio
 {

122 
	mşo£
;

123 
FILE
 *
	må
;

124 } 
	t¢d_šput_¡dio_t
;

126 
	$¢d_šput_¡dio_şo£
(
¢d_šput_t
 *
šput
 
ATTRIBUTE_UNUSED
)

128 
¢d_šput_¡dio_t
 *
¡dio
 = 
šput
->
´iv©e_d©a
;

129 ià(
¡dio
->
şo£
)

130 
	`fşo£
(
¡dio
->
å
);

131 
	`ä“
(
¡dio
);

133 
	}
}

135 
	$¢d_šput_¡dio_sÿn
(
¢d_šput_t
 *
šput
, cÚ¡ *
fÜm©
, 
va_li¡
 
¬gs
)

137 
¢d_šput_¡dio_t
 *
¡dio
 = 
šput
->
´iv©e_d©a
;

138 
	`vfsÿnf
(
FILE
 *, cÚ¡ *, 
va_li¡
);

139  
	`vfsÿnf
(
¡dio
->
å
, 
fÜm©
, 
¬gs
);

140 
	}
}

142 *
	$¢d_šput_¡dio_g‘s
(
¢d_šput_t
 *
šput
, *
¡r
, 
size_t
 
size
)

144 
¢d_šput_¡dio_t
 *
¡dio
 = 
šput
->
´iv©e_d©a
;

145  
	`fg‘s
(
¡r
, (è
size
, 
¡dio
->
å
);

146 
	}
}

148 
	$¢d_šput_¡dio_g‘c
(
¢d_šput_t
 *
šput
)

150 
¢d_šput_¡dio_t
 *
¡dio
 = 
šput
->
´iv©e_d©a
;

151  
	`g‘c
(
¡dio
->
å
);

152 
	}
}

154 
	$¢d_šput_¡dio_ung‘c
(
¢d_šput_t
 *
šput
, 
c
)

156 
¢d_šput_¡dio_t
 *
¡dio
 = 
šput
->
´iv©e_d©a
;

157  
	`ung‘c
(
c
, 
¡dio
->
å
);

158 
	}
}

160 cÚ¡ 
¢d_šput_İs_t
 
	g¢d_šput_¡dio_İs
 = {

161 .
şo£
 = 
¢d_šput_¡dio_şo£
,

162 .
	gsÿn
 = 
¢d_šput_¡dio_sÿn
,

163 .
	gg‘s
 = 
¢d_šput_¡dio_g‘s
,

164 .
	gg‘ch
 = 
¢d_šput_¡dio_g‘c
,

165 .
	gung‘ch
 = 
¢d_šput_¡dio_ung‘c
,

179 
	$¢d_šput_¡dio_©ch
(
¢d_šput_t
 **
špu
, 
FILE
 *
å
, 
_şo£
)

181 
¢d_šput_t
 *
šput
;

182 
¢d_šput_¡dio_t
 *
¡dio
;

183 
	`as£¹
(
špu
 && 
å
);

184 
¡dio
 = 
	`ÿÎoc
(1, (*stdio));

185 ià(!
¡dio
)

186  -
ENOMEM
;

187 
šput
 = 
	`ÿÎoc
(1, (*input));

188 ià(!
šput
) {

189 
	`ä“
(
¡dio
);

190  -
ENOMEM
;

192 
¡dio
->
å
 = fp;

193 
¡dio
->
şo£
 = 
_şo£
;

194 
šput
->
ty³
 = 
SND_INPUT_STDIO
;

195 
šput
->
İs
 = &
¢d_šput_¡dio_İs
;

196 
šput
->
´iv©e_d©a
 = 
¡dio
;

197 *
špu
 = 
šput
;

199 
	}
}

209 
	$¢d_šput_¡dio_İ’
(
¢d_šput_t
 **
špu
, cÚ¡ *
fe
, cÚ¡ *
mode
)

211 
”r
;

212 
FILE
 *
å
 = 
	`fİ’
(
fe
, 
mode
);

213 ià(!
å
) {

215  -
”ºo
;

217 
”r
 = 
	`¢d_šput_¡dio_©ch
(
špu
, 
å
, 1);

218 ià(
”r
 < 0)

219 
	`fşo£
(
å
);

220  
”r
;

221 
	}
}

223 #iâdeà
DOC_HIDDEN


225 
	s_¢d_šput_bufãr
 {

226 *
	mbuf
;

227 *
	m±r
;

228 
size_t
 
	msize
;

229 } 
	t¢d_šput_bufãr_t
;

231 
	$¢d_šput_bufãr_şo£
(
¢d_šput_t
 *
šput
)

233 
¢d_šput_bufãr_t
 *
bufãr
 = 
šput
->
´iv©e_d©a
;

234 
	`ä“
(
bufãr
->
buf
);

235 
	`ä“
(
bufãr
);

237 
	}
}

239 
	$¢d_šput_bufãr_sÿn
(
¢d_šput_t
 *
šput
, cÚ¡ *
fÜm©
, 
va_li¡
 
¬gs
)

241 
¢d_šput_bufãr_t
 *
bufãr
 = 
šput
->
´iv©e_d©a
;

242 
	`vssÿnf
(cÚ¡ *, cÚ¡ *, 
va_li¡
);

244 
	`as£¹
(0);

245  
	`vssÿnf
((*)
bufãr
->
±r
, 
fÜm©
, 
¬gs
);

246 
	}
}

248 *
	$¢d_šput_bufãr_g‘s
(
¢d_šput_t
 *
šput
, *
¡r
, 
size_t
 
size
)

250 
¢d_šput_bufãr_t
 *
bufãr
 = 
šput
->
´iv©e_d©a
;

251 
size_t
 
bsize
 = 
bufãr
->
size
;

252 --
size
 > 0 && 
bsize
 > 0) {

253 
c
 = *
bufãr
->
±r
++;

254 
bsize
--;

255 *
¡r
++ = 
c
;

256 ià(
c
 == '\n')

259 ià(
bsize
 =ğ
bufãr
->
size
)

260  
NULL
;

261 
bufãr
->
size
 = 
bsize
;

262 *
¡r
 = '\0';

263  
¡r
;

264 
	}
}

266 
	$¢d_šput_bufãr_g‘c
(
¢d_šput_t
 *
šput
)

268 
¢d_šput_bufãr_t
 *
bufãr
 = 
šput
->
´iv©e_d©a
;

269 ià(
bufãr
->
size
 == 0)

270  
EOF
;

271 
bufãr
->
size
--;

272  *
bufãr
->
±r
++;

273 
	}
}

275 
	$¢d_šput_bufãr_ung‘c
(
¢d_šput_t
 *
šput
, 
c
)

277 
¢d_šput_bufãr_t
 *
bufãr
 = 
šput
->
´iv©e_d©a
;

278 ià(
bufãr
->
±r
 =ğbufãr->
buf
)

279  
EOF
;

280 
bufãr
->
±r
--;

281 
	`as£¹
(*
bufãr
->
±r
 =ğ(è
c
);

282 
bufãr
->
size
++;

283  
c
;

284 
	}
}

286 cÚ¡ 
¢d_šput_İs_t
 
	g¢d_šput_bufãr_İs
 = {

287 .
şo£
 = 
¢d_šput_bufãr_şo£
,

288 .
	gsÿn
 = 
¢d_šput_bufãr_sÿn
,

289 .
	gg‘s
 = 
¢d_šput_bufãr_g‘s
,

290 .
	gg‘ch
 = 
¢d_šput_bufãr_g‘c
,

291 .
	gung‘ch
 = 
¢d_šput_bufãr_ung‘c
,

306 
	$¢d_šput_bufãr_İ’
(
¢d_šput_t
 **
špu
, cÚ¡ *
buf
, 
ssize_t
 
size
)

308 
¢d_šput_t
 *
šput
;

309 
¢d_šput_bufãr_t
 *
bufãr
;

310 
	`as£¹
(
špu
);

311 
bufãr
 = 
	`ÿÎoc
(1, (*buffer));

312 ià(!
bufãr
)

313  -
ENOMEM
;

314 
šput
 = 
	`ÿÎoc
(1, (*input));

315 ià(!
šput
) {

316 
	`ä“
(
bufãr
);

317  -
ENOMEM
;

319 ià(
size
 < 0)

320 
size
 = 
	`¡¾’
(
buf
);

321 
bufãr
->
buf
 = 
	`m®loc
((
size_t
)
size
 + 1);

322 ià(!
bufãr
->
buf
) {

323 
	`ä“
(
šput
);

324 
	`ä“
(
bufãr
);

325  -
ENOMEM
;

327 
	`memıy
(
bufãr
->
buf
, buf, (
size_t
è
size
);

328 
bufãr
->
buf
[
size
] = 0;

329 
bufãr
->
±r
 = bufãr->
buf
;

330 
bufãr
->
size
 = size;

331 
šput
->
ty³
 = 
SND_INPUT_BUFFER
;

332 
šput
->
İs
 = &
¢d_šput_bufãr_İs
;

333 
šput
->
´iv©e_d©a
 = 
bufãr
;

334 *
špu
 = 
šput
;

336 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/bag.c

22 
	~"mix”_loÿl.h
"

24 
	$bag_Ãw
(
bag_t
 **
bag
)

26 
bag_t
 *
b
 = 
	`m®loc
((*b));

27 ià(!
b
)

28  -
ENOMEM
;

29 
	`INIT_LIST_HEAD
(
b
);

30 *
bag
 = 
b
;

32 
	}
}

34 
	$bag_ä“
(
bag_t
 *
bag
)

36 
	`as£¹
(
	`li¡_em±y
(
bag
));

37 
	`ä“
(
bag
);

38 
	}
}

40 
	$bag_em±y
(
bag_t
 *
bag
)

42  
	`li¡_em±y
(
bag
);

43 
	}
}

45 
	$bag_add
(
bag_t
 *
bag
, *
±r
)

47 
bag1_t
 *
b
 = 
	`m®loc
((*b));

48 ià(!
b
)

49  -
ENOMEM
;

50 
b
->
±r
 =…tr;

51 
	`li¡_add_
(&
b
->
li¡
, 
bag
);

53 
	}
}

55 
	$bag_d–
(
bag_t
 *
bag
, *
±r
)

57 
li¡_h—d
 *
pos
;

58 
	`li¡_fÜ_—ch
(
pos
, 
bag
) {

59 
bag1_t
 *
b
 = 
	`li¡_’Œy
(
pos
, bag1_t, 
li¡
);

60 ià(
b
->
±r
 ==…tr) {

61 
	`li¡_d–
(&
b
->
li¡
);

62 
	`ä“
(
b
);

66  -
ENOENT
;

67 
	}
}

69 
	$bag_d–_®l
(
bag_t
 *
bag
)

71 !
	`li¡_em±y
(
bag
))

72 
	`li¡_d–
(
bag
->
Ãxt
);

73 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/mixer.c

42 
	~"mix”_loÿl.h
"

43 
	~<¡dio.h
>

44 
	~<¡dlib.h
>

45 
	~<uni¡d.h
>

46 
	~<¡ršg.h
>

47 
	~<fú.h
>

48 
	~<sys/ioùl.h
>

50 #iâdeà
DOC_HIDDEN


51 
	s_¢d_mix”_¦ave
 {

52 
¢d_hùl_t
 *
	mhùl
;

53 
li¡_h—d
 
	mli¡
;

54 } 
	t¢d_mix”_¦ave_t
;

58 
¢d_mix”_com·»_deçuÉ
(cÚ¡ 
¢d_mix”_–em_t
 *
c1
,

59 cÚ¡ 
¢d_mix”_–em_t
 *
c2
);

68 
	$¢d_mix”_İ’
(
¢d_mix”_t
 **
mix”p
, 
mode
 
ATTRIBUTE_UNUSED
)

70 
¢d_mix”_t
 *
mix”
;

71 
	`as£¹
(
mix”p
);

72 
mix”
 = 
	`ÿÎoc
(1, (*mixer));

73 ià(
mix”
 =ğ
NULL
)

74  -
ENOMEM
;

75 
	`INIT_LIST_HEAD
(&
mix”
->
¦aves
);

76 
	`INIT_LIST_HEAD
(&
mix”
->
şas£s
);

77 
	`INIT_LIST_HEAD
(&
mix”
->
–ems
);

78 
mix”
->
com·»
 = 
¢d_mix”_com·»_deçuÉ
;

79 *
mix”p
 = 
mix”
;

81 
	}
}

96 
	$¢d_mix”_–em_©ch
(
¢d_mix”_–em_t
 *
m–em
,

97 
¢d_hùl_–em_t
 *
h–em
)

99 
bag_t
 *
bag
 = 
	`¢d_hùl_–em_g‘_ÿÎback_´iv©e
(
h–em
);

100 
”r
;

101 
”r
 = 
	`bag_add
(
bag
, 
m–em
);

102 ià(
”r
 < 0)

103  
”r
;

104  
	`bag_add
(&
m–em
->
h–ems
, 
h–em
);

105 
	}
}

119 
	$¢d_mix”_–em_d‘ach
(
¢d_mix”_–em_t
 *
m–em
,

120 
¢d_hùl_–em_t
 *
h–em
)

122 
bag_t
 *
bag
 = 
	`¢d_hùl_–em_g‘_ÿÎback_´iv©e
(
h–em
);

123 
”r
;

124 
”r
 = 
	`bag_d–
(
bag
, 
m–em
);

125 
	`as£¹
(
”r
 >= 0);

126 
”r
 = 
	`bag_d–
(&
m–em
->
h–ems
, 
h–em
);

127 
	`as£¹
(
”r
 >= 0);

129 
	}
}

138 
	$¢d_mix”_–em_em±y
(
¢d_mix”_–em_t
 *
m–em
)

140  
	`bag_em±y
(&
m–em
->
h–ems
);

141 
	}
}

143 
	$hùl_–em_ev’t_hªdËr
(
¢d_hùl_–em_t
 *
h–em
,

144 
mask
)

146 
bag_t
 *
bag
 = 
	`¢d_hùl_–em_g‘_ÿÎback_´iv©e
(
h–em
);

147 ià(
mask
 =ğ
SND_CTL_EVENT_MASK_REMOVE
) {

148 
»s
 = 0;

149 
”r
;

150 
bag_™”©Ü_t
 
i
, 
n
;

151 
	`bag_fÜ_—ch_§ã
(
i
, 
n
, 
bag
) {

152 
¢d_mix”_–em_t
 *
m–em
 = 
	`bag_™”©Ü_’Œy
(
i
);

153 
¢d_mix”_şass_t
 *
şass
 = 
m–em
->class;

154 
”r
 = 
şass
->
	`ev’t
(şass, 
mask
, 
h–em
, 
m–em
);

155 ià(
”r
 < 0)

156 
»s
 = 
”r
;

161 
	`as£¹
(
	`bag_em±y
(
bag
));

162 
	`bag_ä“
(
bag
);

163  
»s
;

165 ià(
mask
 & (
SND_CTL_EVENT_MASK_VALUE
 | 
SND_CTL_EVENT_MASK_INFO
)) {

166 
”r
 = 0;

167 
bag_™”©Ü_t
 
i
, 
n
;

168 
	`bag_fÜ_—ch_§ã
(
i
, 
n
, 
bag
) {

169 
¢d_mix”_–em_t
 *
m–em
 = 
	`bag_™”©Ü_’Œy
(
i
);

170 
¢d_mix”_şass_t
 *
şass
 = 
m–em
->class;

171 
”r
 = 
şass
->
	`ev’t
(şass, 
mask
, 
h–em
, 
m–em
);

172 ià(
”r
 < 0)

173  
”r
;

177 
	}
}

179 
	$hùl_ev’t_hªdËr
(
¢d_hùl_t
 *
hùl
, 
mask
,

180 
¢d_hùl_–em_t
 *
–em
)

182 
¢d_mix”_t
 *
mix”
 = 
	`¢d_hùl_g‘_ÿÎback_´iv©e
(
hùl
);

183 
»s
 = 0;

184 ià(
mask
 & 
SND_CTL_EVENT_MASK_ADD
) {

185 
li¡_h—d
 *
pos
;

186 
bag_t
 *
bag
;

187 
”r
 = 
	`bag_Ãw
(&
bag
);

188 ià(
”r
 < 0)

189  
”r
;

190 
	`¢d_hùl_–em_£t_ÿÎback
(
–em
, 
hùl_–em_ev’t_hªdËr
);

191 
	`¢d_hùl_–em_£t_ÿÎback_´iv©e
(
–em
, 
bag
);

192 
	`li¡_fÜ_—ch
(
pos
, &
mix”
->
şas£s
) {

193 
¢d_mix”_şass_t
 *
c
;

194 
c
 = 
	`li¡_’Œy
(
pos
, 
¢d_mix”_şass_t
, 
li¡
);

195 
”r
 = 
c
->
	`ev’t
(c, 
mask
, 
–em
, 
NULL
);

196 ià(
”r
 < 0)

197 
»s
 = 
”r
;

200  
»s
;

201 
	}
}

210 
	$¢d_mix”_©ch
(
¢d_mix”_t
 *
mix”
, cÚ¡ *
Çme
)

212 
¢d_hùl_t
 *
hùl
;

213 
”r
;

215 
”r
 = 
	`¢d_hùl_İ’
(&
hùl
, 
Çme
, 0);

216 ià(
”r
 < 0)

217  
”r
;

218 
”r
 = 
	`¢d_mix”_©ch_hùl
(
mix”
, 
hùl
);

219 ià(
”r
 < 0)

220  
”r
;

222 
	}
}

232 
	$¢d_mix”_©ch_hùl
(
¢d_mix”_t
 *
mix”
, 
¢d_hùl_t
 *
hùl
)

234 
¢d_mix”_¦ave_t
 *
¦ave
;

235 
”r
;

237 
	`as£¹
(
hùl
);

238 
¦ave
 = 
	`ÿÎoc
(1, (*slave));

239 ià(
¦ave
 =ğ
NULL
) {

240 
	`¢d_hùl_şo£
(
hùl
);

241  -
ENOMEM
;

243 
”r
 = 
	`¢d_hùl_nÚblock
(
hùl
, 1);

244 ià(
”r
 < 0) {

245 
	`¢d_hùl_şo£
(
hùl
);

246 
	`ä“
(
¦ave
);

247  
”r
;

249 
	`¢d_hùl_£t_ÿÎback
(
hùl
, 
hùl_ev’t_hªdËr
);

250 
	`¢d_hùl_£t_ÿÎback_´iv©e
(
hùl
, 
mix”
);

251 
¦ave
->
hùl
 = hctl;

252 
	`li¡_add_
(&
¦ave
->
li¡
, &
mix”
->
¦aves
);

254 
	}
}

262 
	$¢d_mix”_d‘ach
(
¢d_mix”_t
 *
mix”
, cÚ¡ *
Çme
)

264 
li¡_h—d
 *
pos
;

265 
	`li¡_fÜ_—ch
(
pos
, &
mix”
->
¦aves
) {

266 
¢d_mix”_¦ave_t
 *
s
;

267 
s
 = 
	`li¡_’Œy
(
pos
, 
¢d_mix”_¦ave_t
, 
li¡
);

268 ià(
	`¡rcmp
(
Çme
, 
	`¢d_hùl_Çme
(
s
->
hùl
)) == 0) {

269 
	`¢d_hùl_şo£
(
s
->
hùl
);

270 
	`li¡_d–
(
pos
);

271 
	`ä“
(
s
);

275  -
ENOENT
;

276 
	}
}

286 
	$¢d_mix”_d‘ach_hùl
(
¢d_mix”_t
 *
mix”
, 
¢d_hùl_t
 *
hùl
)

288 
li¡_h—d
 *
pos
;

289 
	`li¡_fÜ_—ch
(
pos
, &
mix”
->
¦aves
) {

290 
¢d_mix”_¦ave_t
 *
s
;

291 
s
 = 
	`li¡_’Œy
(
pos
, 
¢d_mix”_¦ave_t
, 
li¡
);

292 ià(
hùl
 =ğ
s
->hctl) {

293 
	`li¡_d–
(
pos
);

294 
	`ä“
(
s
);

298  -
ENOENT
;

299 
	}
}

308 
	$¢d_mix”_g‘_hùl
(
¢d_mix”_t
 *
mix”
, cÚ¡ *
Çme
, 
¢d_hùl_t
 **
hùl
)

310 
li¡_h—d
 *
pos
;

311 
	`li¡_fÜ_—ch
(
pos
, &
mix”
->
¦aves
) {

312 
¢d_mix”_¦ave_t
 *
s
;

313 
s
 = 
	`li¡_’Œy
(
pos
, 
¢d_mix”_¦ave_t
, 
li¡
);

314 ià(
	`¡rcmp
(
Çme
, 
	`¢d_hùl_Çme
(
s
->
hùl
)) == 0) {

315 *
hùl
 = 
s
->hctl;

319  -
ENOENT
;

320 
	}
}

322 
	$¢d_mix”_throw_ev’t
(
¢d_mix”_t
 *
mix”
, 
mask
,

323 
¢d_mix”_–em_t
 *
–em
)

325 
mix”
->
ev’ts
++;

326 ià(
mix”
->
ÿÎback
)

327  
mix”
->
	`ÿÎback
(mix”, 
mask
, 
–em
);

329 
	}
}

331 
	$¢d_mix”_–em_throw_ev’t
(
¢d_mix”_–em_t
 *
–em
, 
mask
)

333 
–em
->
şass
->
mix”
->
ev’ts
++;

334 ià(
–em
->
ÿÎback
)

335  
–em
->
	`ÿÎback
ÓËm, 
mask
);

337 
	}
}

339 
	$_¢d_mix”_fšd_–em
(
¢d_mix”_t
 *
mix”
, 
¢d_mix”_–em_t
 *
–em
, *
dœ
)

341 
l
, 
u
;

342 
c
 = 0;

343 
idx
 = -1;

344 
	`as£¹
(
mix”
 && 
–em
);

345 
	`as£¹
(
mix”
->
com·»
);

346 
l
 = 0;

347 
u
 = 
mix”
->
couÁ
;

348 
l
 < 
u
) {

349 
idx
 = (
l
 + 
u
) / 2;

350 
c
 = 
mix”
->
	`com·»
(
–em
, mix”->
³Ëms
[
idx
]);

351 ià(
c
 < 0)

352 
u
 = 
idx
;

353 ià(
c
 > 0)

354 
l
 = 
idx
 + 1;

358 *
dœ
 = 
c
;

359  
idx
;

360 
	}
}

369 *
	$¢d_mix”_–em_g‘_´iv©e
(cÚ¡ 
¢d_mix”_–em_t
 *
–em
)

371  
–em
->
´iv©e_d©a
;

372 
	}
}

385 
¢d_mix”_–em_Ãw
(
¢d_mix”_–em_t
 **
–em
,

386 
¢d_mix”_–em_ty³_t
 
ty³
,

387 
com·»_weight
,

388 *
´iv©e_d©a
,

389 (*
´iv©e_ä“
)(
¢d_mix”_–em_t
 *
–em
))

391 
¢d_mix”_–em_t
 *
m–em
 = 
	`ÿÎoc
(1, (*melem));

392 ià(
m–em
 =ğ
NULL
)

393  -
ENOMEM
;

394 
m–em
->
ty³
 =ype;

395 
m–em
->
com·»_weight
 = compare_weight;

396 
m–em
->
´iv©e_d©a
 =…rivate_data;

397 
m–em
->
´iv©e_ä“
 =…rivate_free;

398 
	`INIT_LIST_HEAD
(&
m–em
->
h–ems
);

399 *
–em
 = 
m–em
;

401 
	}
}

411 
	$¢d_mix”_–em_add
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_şass_t
 *
şass
)

413 
dœ
, 
idx
;

414 
¢d_mix”_t
 *
mix”
 = 
şass
->mixer;

415 
–em
->
şass
 = class;

417 ià(
mix”
->
couÁ
 =ğmix”->
®loc
) {

418 
¢d_mix”_–em_t
 **
m
;

419 
mix”
->
®loc
 += 32;

420 
m
 = 
	`»®loc
(
mix”
->
³Ëms
, (*mè* mix”->
®loc
);

421 ià(!
m
) {

422 
mix”
->
®loc
 -= 32;

423  -
ENOMEM
;

425 
mix”
->
³Ëms
 = 
m
;

427 ià(
mix”
->
couÁ
 == 0) {

428 
	`li¡_add_
(&
–em
->
li¡
, &
mix”
->
–ems
);

429 
mix”
->
³Ëms
[0] = 
–em
;

431 
idx
 = 
	`_¢d_mix”_fšd_–em
(
mix”
, 
–em
, &
dœ
);

432 
	`as£¹
(
dœ
 != 0);

433 ià(
dœ
 > 0) {

434 
	`li¡_add
(&
–em
->
li¡
, &
mix”
->
³Ëms
[
idx
]->list);

435 
idx
++;

437 
	`li¡_add_
(&
–em
->
li¡
, &
mix”
->
³Ëms
[
idx
]->list);

439 
	`memmove
(
mix”
->
³Ëms
 + 
idx
 + 1,

440 
mix”
->
³Ëms
 + 
idx
,

441 (
mix”
->
couÁ
 - 
idx
è* (
¢d_mix”_–em_t
 *));

442 
mix”
->
³Ëms
[
idx
] = 
–em
;

444 
mix”
->
couÁ
++;

445  
	`¢d_mix”_throw_ev’t
(
mix”
, 
SND_CTL_EVENT_MASK_ADD
, 
–em
);

446 
	}
}

455 
	$¢d_mix”_–em_»move
(
¢d_mix”_–em_t
 *
–em
)

457 
¢d_mix”_t
 *
mix”
 = 
–em
->
şass
->mixer;

458 
bag_™”©Ü_t
 
i
, 
n
;

459 
”r
, 
idx
, 
dœ
;

460 
m
;

461 
	`as£¹
(
–em
);

462 
	`as£¹
(
mix”
->
couÁ
);

463 
idx
 = 
	`_¢d_mix”_fšd_–em
(
mix”
, 
–em
, &
dœ
);

464 ià(
dœ
 != 0)

465  -
EINVAL
;

466 
	`bag_fÜ_—ch_§ã
(
i
, 
n
, &
–em
->
h–ems
) {

467 
¢d_hùl_–em_t
 *
h–em
 = 
	`bag_™”©Ü_’Œy
(
i
);

468 
	`¢d_mix”_–em_d‘ach
(
–em
, 
h–em
);

470 
”r
 = 
	`¢d_mix”_–em_throw_ev’t
(
–em
, 
SND_CTL_EVENT_MASK_REMOVE
);

471 
	`li¡_d–
(&
–em
->
li¡
);

472 
	`¢d_mix”_–em_ä“
(
–em
);

473 
mix”
->
couÁ
--;

474 
m
 = 
mix”
->
couÁ
 - 
idx
;

475 ià(
m
 > 0)

476 
	`memmove
(
mix”
->
³Ëms
 + 
idx
,

477 
mix”
->
³Ëms
 + 
idx
 + 1,

478 
m
 * (
¢d_mix”_–em_t
 *));

479  
”r
;

480 
	}
}

488 
	$¢d_mix”_–em_ä“
(
¢d_mix”_–em_t
 *
–em
)

490 ià(
–em
->
´iv©e_ä“
)

491 
–em
->
	`´iv©e_ä“
(elem);

492 
	`ä“
(
–em
);

493 
	}
}

502 
	$¢d_mix”_–em_šfo
(
¢d_mix”_–em_t
 *
–em
)

504  
	`¢d_mix”_–em_throw_ev’t
(
–em
, 
SND_CTL_EVENT_MASK_INFO
);

505 
	}
}

514 
	$¢d_mix”_–em_v®ue
(
¢d_mix”_–em_t
 *
–em
)

516  
	`¢d_mix”_–em_throw_ev’t
(
–em
, 
SND_CTL_EVENT_MASK_VALUE
);

517 
	}
}

527 
	$¢d_mix”_şass_»gi¡”
(
¢d_mix”_şass_t
 *
şass
, 
¢d_mix”_t
 *
mix”
)

529 
li¡_h—d
 *
pos
;

530 
şass
->
mix”
 = mixer;

531 
	`li¡_add_
(&
şass
->
li¡
, &
mix”
->
şas£s
);

532 ià(!
şass
->
ev’t
)

534 
	`li¡_fÜ_—ch
(
pos
, &
mix”
->
¦aves
) {

535 
”r
;

536 
¢d_mix”_¦ave_t
 *
¦ave
;

537 
¢d_hùl_–em_t
 *
–em
;

538 
¦ave
 = 
	`li¡_’Œy
(
pos
, 
¢d_mix”_¦ave_t
, 
li¡
);

539 
–em
 = 
	`¢d_hùl_fœ¡_–em
(
¦ave
->
hùl
);

540 
–em
) {

541 
”r
 = 
şass
->
	`ev’t
(şass, 
SND_CTL_EVENT_MASK_ADD
, 
–em
, 
NULL
);

542 ià(
”r
 < 0)

543  
”r
;

544 
–em
 = 
	`¢d_hùl_–em_Ãxt
(elem);

548 
	}
}

557 
	$¢d_mix”_şass_uÄegi¡”
(
¢d_mix”_şass_t
 *
şass
)

559 
k
;

560 
¢d_mix”_–em_t
 *
e
;

561 
¢d_mix”_t
 *
mix”
 = 
şass
->mixer;

562 
k
 = 
mix”
->
couÁ
; k > 0; k--) {

563 
e
 = 
mix”
->
³Ëms
[
k
-1];

564 ià(
e
->
şass
 == class)

565 
	`¢d_mix”_–em_»move
(
e
);

567 ià(
şass
->
´iv©e_ä“
)

568 
şass
->
	`´iv©e_ä“
(class);

569 
	`li¡_d–
(&
şass
->
li¡
);

570 
	`ä“
(
şass
);

572 
	}
}

579 
	$¢d_mix”_lßd
(
¢d_mix”_t
 *
mix”
)

581 
li¡_h—d
 *
pos
;

582 
	`li¡_fÜ_—ch
(
pos
, &
mix”
->
¦aves
) {

583 
”r
;

584 
¢d_mix”_¦ave_t
 *
s
;

585 
s
 = 
	`li¡_’Œy
(
pos
, 
¢d_mix”_¦ave_t
, 
li¡
);

586 
”r
 = 
	`¢d_hùl_lßd
(
s
->
hùl
);

587 ià(
”r
 < 0)

588  
”r
;

591 
	}
}

597 
	$¢d_mix”_ä“
(
¢d_mix”_t
 *
mix”
)

599 
li¡_h—d
 *
pos
;

600 
	`li¡_fÜ_—ch
(
pos
, &
mix”
->
¦aves
) {

601 
¢d_mix”_¦ave_t
 *
s
;

602 
s
 = 
	`li¡_’Œy
(
pos
, 
¢d_mix”_¦ave_t
, 
li¡
);

603 
	`¢d_hùl_ä“
(
s
->
hùl
);

605 
	}
}

612 
	$¢d_mix”_şo£
(
¢d_mix”_t
 *
mix”
)

614 
»s
 = 0;

615 
	`as£¹
(
mix”
);

616 !
	`li¡_em±y
(&
mix”
->
şas£s
)) {

617 
¢d_mix”_şass_t
 *
c
;

618 
c
 = 
	`li¡_’Œy
(
mix”
->
şas£s
.
Ãxt
, 
¢d_mix”_şass_t
, 
li¡
);

619 
	`¢d_mix”_şass_uÄegi¡”
(
c
);

621 
	`as£¹
(
	`li¡_em±y
(&
mix”
->
–ems
));

622 
	`as£¹
(
mix”
->
couÁ
 == 0);

623 
	`ä“
(
mix”
->
³Ëms
);

624 
mix”
->
³Ëms
 = 
NULL
;

625 !
	`li¡_em±y
(&
mix”
->
¦aves
)) {

626 
”r
;

627 
¢d_mix”_¦ave_t
 *
s
;

628 
s
 = 
	`li¡_’Œy
(
mix”
->
¦aves
.
Ãxt
, 
¢d_mix”_¦ave_t
, 
li¡
);

629 
”r
 = 
	`¢d_hùl_şo£
(
s
->
hùl
);

630 ià(
”r
 < 0)

631 
»s
 = 
”r
;

632 
	`li¡_d–
(&
s
->
li¡
);

633 
	`ä“
(
s
);

635 
	`ä“
(
mix”
);

636  
»s
;

637 
	}
}

639 
	$¢d_mix”_com·»_deçuÉ
(cÚ¡ 
¢d_mix”_–em_t
 *
c1
,

640 cÚ¡ 
¢d_mix”_–em_t
 *
c2
)

642 
d
 = 
c1
->
com·»_weight
 - 
c2
->compare_weight;

643 ià(
d
)

644  
d
;

645 
	`as£¹
(
c1
->
şass
 && c1->şass->
com·»
);

646 
	`as£¹
(
c2
->
şass
 && c2->şass->
com·»
);

647 
	`as£¹
(
c1
->
şass
 =ğ
c2
->class);

648  
c1
->
şass
->
	`com·»
(c1, 
c2
);

649 
	}
}

651 
	$mix”_com·»
(cÚ¡ *
a
, cÚ¡ *
b
)

653 
¢d_mix”_t
 *
mix”
;

655 
mix”
 = (*((cÚ¡ 
¢d_mix”_–em_t
 * cÚ¡ *)
a
))->
şass
->mixer;

656  
mix”
->
	`com·»
(*(cÚ¡ 
¢d_mix”_–em_t
 * cÚ¡ *)
a
, *(cÚ¡ snd_mix”_–em_ˆ* cÚ¡ *)
b
);

657 
	}
}

659 
	$¢d_mix”_sÜt
(
¢d_mix”_t
 *
mix”
)

661 
k
;

662 
	`as£¹
(
mix”
);

663 
	`as£¹
(
mix”
->
com·»
);

664 
	`INIT_LIST_HEAD
(&
mix”
->
–ems
);

665 
	`qsÜt
(
mix”
->
³Ëms
, mix”->
couÁ
, (
¢d_mix”_–em_t
 *), 
mix”_com·»
);

666 
k
 = 0; k < 
mix”
->
couÁ
; k++)

667 
	`li¡_add_
(&
mix”
->
³Ëms
[
k
]->
li¡
, &mix”->
–ems
);

669 
	}
}

677 
	$¢d_mix”_£t_com·»
(
¢d_mix”_t
 *
mix”
, 
¢d_mix”_com·»_t
 
com·»
)

679 
¢d_mix”_com·»_t
 
com·»_Şd
;

680 
”r
;

682 
	`as£¹
(
mix”
);

683 
com·»_Şd
 = 
mix”
->
com·»
;

684 
mix”
->
com·»
 = com·» =ğ
NULL
 ? 
¢d_mix”_com·»_deçuÉ
 : compare;

685 ià((
”r
 = 
	`¢d_mix”_sÜt
(
mix”
)) < 0) {

686 
mix”
->
com·»
 = 
com·»_Şd
;

687  
”r
;

690 
	}
}

697 
	$¢d_mix”_pŞl_desütÜs_couÁ
(
¢d_mix”_t
 *
mix”
)

699 
li¡_h—d
 *
pos
;

700 
c
 = 0;

701 
	`as£¹
(
mix”
);

702 
	`li¡_fÜ_—ch
(
pos
, &
mix”
->
¦aves
) {

703 
¢d_mix”_¦ave_t
 *
s
;

704 
n
;

705 
s
 = 
	`li¡_’Œy
(
pos
, 
¢d_mix”_¦ave_t
, 
li¡
);

706 
n
 = 
	`¢d_hùl_pŞl_desütÜs_couÁ
(
s
->
hùl
);

707 ià(
n
 < 0)

708  
n
;

709 
c
 +ğ
n
;

711  
c
;

712 
	}
}

721 
	$¢d_mix”_pŞl_desütÜs
(
¢d_mix”_t
 *
mix”
, 
pŞlfd
 *
pfds
, 
¥aû
)

723 
li¡_h—d
 *
pos
;

724 
couÁ
 = 0;

725 
	`as£¹
(
mix”
);

726 
	`li¡_fÜ_—ch
(
pos
, &
mix”
->
¦aves
) {

727 
¢d_mix”_¦ave_t
 *
s
;

728 
n
;

729 
s
 = 
	`li¡_’Œy
(
pos
, 
¢d_mix”_¦ave_t
, 
li¡
);

730 
n
 = 
	`¢d_hùl_pŞl_desütÜs
(
s
->
hùl
, 
pfds
, 
¥aû
);

731 ià(
n
 < 0)

732  
n
;

733 ià(
¥aû
 >ğ(è
n
) {

734 
couÁ
 +ğ
n
;

735 
¥aû
 -ğ
n
;

736 
pfds
 +ğ
n
;

738 
¥aû
 = 0;

740  
couÁ
;

741 
	}
}

751 
	$¢d_mix”_pŞl_desütÜs_»v’ts
(
¢d_mix”_t
 *
mix”
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

753 
idx
;

754 
»s
;

755 
	`as£¹
(
mix”
 && 
pfds
 && 
»v’ts
);

756 ià(
nfds
 == 0)

757  -
EINVAL
;

758 
»s
 = 0;

759 
idx
 = 0; idx < 
nfds
; idx++, 
pfds
++)

760 
»s
 |ğ
pfds
->
»v’ts
 & (
POLLIN
|
POLLERR
|
POLLNVAL
);

761 *
»v’ts
 = 
»s
;

763 
	}
}

771 
	$¢d_mix”_wa™
(
¢d_mix”_t
 *
mix”
, 
timeout
)

773 
pŞlfd
 
¥fds
[16];

774 
pŞlfd
 *
pfds
 = 
¥fds
;

775 
”r
;

776 
couÁ
;

777 
couÁ
 = 
	`¢d_mix”_pŞl_desütÜs
(
mix”
, 
pfds
, (
¥fds
) / (spfds[0]));

778 ià(
couÁ
 < 0)

779  
couÁ
;

780 ià((è
couÁ
 > (
¥fds
) / (spfds[0])) {

781 
pfds
 = 
	`®loÿ
(
couÁ
 * (*pfds));

782 ià(!
pfds
)

783  -
ENOMEM
;

784 
”r
 = 
	`¢d_mix”_pŞl_desütÜs
(
mix”
, 
pfds
,

785 (è
couÁ
);

786 
	`as£¹
(
”r
 =ğ
couÁ
);

788 
”r
 = 
	`pŞl
(
pfds
, (è
couÁ
, 
timeout
);

789 ià(
”r
 < 0)

790  -
”ºo
;

792 
	}
}

799 
¢d_mix”_–em_t
 *
	$¢d_mix”_fœ¡_–em
(
¢d_mix”_t
 *
mix”
)

801 
	`as£¹
(
mix”
);

802 ià(
	`li¡_em±y
(&
mix”
->
–ems
))

803  
NULL
;

804  
	`li¡_’Œy
(
mix”
->
–ems
.
Ãxt
, 
¢d_mix”_–em_t
, 
li¡
);

805 
	}
}

812 
¢d_mix”_–em_t
 *
	$¢d_mix”_Ï¡_–em
(
¢d_mix”_t
 *
mix”
)

814 
	`as£¹
(
mix”
);

815 ià(
	`li¡_em±y
(&
mix”
->
–ems
))

816  
NULL
;

817  
	`li¡_’Œy
(
mix”
->
–ems
.
´ev
, 
¢d_mix”_–em_t
, 
li¡
);

818 
	}
}

825 
¢d_mix”_–em_t
 *
	$¢d_mix”_–em_Ãxt
(
¢d_mix”_–em_t
 *
–em
)

827 
	`as£¹
(
–em
);

828 ià(
–em
->
li¡
.
Ãxt
 =ğ&–em->
şass
->
mix”
->
–ems
)

829  
NULL
;

830  
	`li¡_’Œy
(
–em
->
li¡
.
Ãxt
, 
¢d_mix”_–em_t
,†ist);

831 
	}
}

838 
¢d_mix”_–em_t
 *
	$¢d_mix”_–em_´ev
(
¢d_mix”_–em_t
 *
–em
)

840 
	`as£¹
(
–em
);

841 ià(
–em
->
li¡
.
´ev
 =ğ&–em->
şass
->
mix”
->
–ems
)

842  
NULL
;

843  
	`li¡_’Œy
(
–em
->
li¡
.
´ev
, 
¢d_mix”_–em_t
,†ist);

844 
	}
}

851 
	$¢d_mix”_hªdË_ev’ts
(
¢d_mix”_t
 *
mix”
)

853 
li¡_h—d
 *
pos
;

854 
	`as£¹
(
mix”
);

855 
mix”
->
ev’ts
 = 0;

856 
	`li¡_fÜ_—ch
(
pos
, &
mix”
->
¦aves
) {

857 
”r
;

858 
¢d_mix”_¦ave_t
 *
s
;

859 
s
 = 
	`li¡_’Œy
(
pos
, 
¢d_mix”_¦ave_t
, 
li¡
);

860 
”r
 = 
	`¢d_hùl_hªdË_ev’ts
(
s
->
hùl
);

861 ià(
”r
 < 0)

862  
”r
;

864  
mix”
->
ev’ts
;

865 
	}
}

872 
	$¢d_mix”_£t_ÿÎback
(
¢d_mix”_t
 *
obj
, 
¢d_mix”_ÿÎback_t
 
v®
)

874 
	`as£¹
(
obj
);

875 
obj
->
ÿÎback
 = 
v®
;

876 
	}
}

883 
	$¢d_mix”_£t_ÿÎback_´iv©e
(
¢d_mix”_t
 *
mix”
, * 
v®
)

885 
	`as£¹
(
mix”
);

886 
mix”
->
ÿÎback_´iv©e
 = 
v®
;

887 
	}
}

894 * 
	$¢d_mix”_g‘_ÿÎback_´iv©e
(cÚ¡ 
¢d_mix”_t
 *
mix”
)

896 
	`as£¹
(
mix”
);

897  
mix”
->
ÿÎback_´iv©e
;

898 
	}
}

905 
	$¢d_mix”_g‘_couÁ
(cÚ¡ 
¢d_mix”_t
 *
mix”
)

907 
	`as£¹
(
mix”
);

908  
mix”
->
couÁ
;

909 
	}
}

916 
	$¢d_mix”_–em_£t_ÿÎback
(
¢d_mix”_–em_t
 *
mix”
, 
¢d_mix”_–em_ÿÎback_t
 
v®
)

918 
	`as£¹
(
mix”
);

919 
mix”
->
ÿÎback
 = 
v®
;

920 
	}
}

927 
	$¢d_mix”_–em_£t_ÿÎback_´iv©e
(
¢d_mix”_–em_t
 *
mix”
, * 
v®
)

929 
	`as£¹
(
mix”
);

930 
mix”
->
ÿÎback_´iv©e
 = 
v®
;

931 
	}
}

938 * 
	$¢d_mix”_–em_g‘_ÿÎback_´iv©e
(cÚ¡ 
¢d_mix”_–em_t
 *
mix”
)

940 
	`as£¹
(
mix”
);

941  
mix”
->
ÿÎback_´iv©e
;

942 
	}
}

949 
¢d_mix”_–em_ty³_t
 
	$¢d_mix”_–em_g‘_ty³
(cÚ¡ 
¢d_mix”_–em_t
 *
mix”
)

951 
	`as£¹
(
mix”
);

952  
mix”
->
ty³
;

953 
	}
}

960 
size_t
 
	$¢d_mix”_şass_sizeof
()

962  (
¢d_mix”_şass_t
);

963 
	}
}

970 
	$¢d_mix”_şass_m®loc
(
¢d_mix”_şass_t
 **
±r
)

972 
	`as£¹
(
±r
);

973 *
±r
 = 
	`ÿÎoc
(1, (
¢d_mix”_şass_t
));

974 ià(!*
±r
)

975  -
ENOMEM
;

977 
	}
}

983 
	$¢d_mix”_şass_ä“
(
¢d_mix”_şass_t
 *
obj
)

985 ià(
obj
->
´iv©e_ä“
)

986 
obj
->
	`´iv©e_ä“
(obj);

987 
	`ä“
(
obj
);

988 
	}
}

995 
	$¢d_mix”_şass_cİy
(
¢d_mix”_şass_t
 *
d¡
, cÚ¡ snd_mix”_şass_ˆ*
¤c
)

997 
	`as£¹
(
d¡
 && 
¤c
);

998 *
d¡
 = *
¤c
;

999 
	}
}

1006 
¢d_mix”_t
 *
	$¢d_mix”_şass_g‘_mix”
(cÚ¡ 
¢d_mix”_şass_t
 *
obj
)

1008 
	`as£¹
(
obj
);

1009  
obj
->
mix”
;

1010 
	}
}

1017 
¢d_mix”_ev’t_t
 
	$¢d_mix”_şass_g‘_ev’t
(cÚ¡ 
¢d_mix”_şass_t
 *
obj
)

1019 
	`as£¹
(
obj
);

1020  
obj
->
ev’t
;

1021 
	}
}

1028 *
	$¢d_mix”_şass_g‘_´iv©e
(cÚ¡ 
¢d_mix”_şass_t
 *
obj
)

1030 
	`as£¹
(
obj
);

1031  
obj
->
´iv©e_d©a
;

1032 
	}
}

1040 
¢d_mix”_com·»_t
 
	$¢d_mix”_şass_g‘_com·»
(cÚ¡ 
¢d_mix”_şass_t
 *
obj
)

1042 
	`as£¹
(
obj
);

1043  
obj
->
com·»
;

1044 
	}
}

1052 
	$¢d_mix”_şass_£t_ev’t
(
¢d_mix”_şass_t
 *
obj
, 
¢d_mix”_ev’t_t
 
ev’t
)

1054 
	`as£¹
(
obj
);

1055 
obj
->
ev’t
 =ƒvent;

1057 
	}
}

1065 
	$¢d_mix”_şass_£t_´iv©e
(
¢d_mix”_şass_t
 *
obj
, *
´iv©e_d©a
)

1067 
	`as£¹
(
obj
);

1068 
obj
->
´iv©e_d©a
 =…rivate_data;

1070 
	}
}

1078 
¢d_mix”_şass_£t_´iv©e_ä“
(
¢d_mix”_şass_t
 *
obj
, (*
´iv©e_ä“
)(snd_mixer_class_t *))

1080 
	`as£¹
(
obj
);

1081 
obj
->
´iv©e_ä“
 =…rivate_free;

1083 
	}
}

1091 
	$¢d_mix”_şass_£t_com·»
(
¢d_mix”_şass_t
 *
obj
, 
¢d_mix”_com·»_t
 
com·»
)

1093 
	`as£¹
(
obj
);

1094 
obj
->
com·»
 = compare;

1096 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/mixer_local.h

23 
	~"loÿl.h
"

25 
	s_bag1
 {

26 *
	m±r
;

27 
li¡_h—d
 
	mli¡
;

28 } 
	tbag1_t
;

30 
li¡_h—d
 
	tbag_t
;

32 
bag_Ãw
(
bag_t
 **
bag
);

33 
bag_ä“
(
bag_t
 *
bag
);

34 
bag_add
(
bag_t
 *
bag
, *
±r
);

35 
bag_d–
(
bag_t
 *
bag
, *
±r
);

36 
bag_em±y
(
bag_t
 *
bag
);

37 
bag_d–_®l
(
bag_t
 *
bag
);

39 
li¡_h—d
 *
	tbag_™”©Ü_t
;

41 
	#bag_™”©Ü_’Œy
(
i
è(
	`li¡_’Œy
((i), 
bag1_t
, 
li¡
)->
±r
)

	)

42 
	#bag_fÜ_—ch
(
pos
, 
bag
è
	`li¡_fÜ_—ch
Õos, bag)

	)

43 
	#bag_fÜ_—ch_§ã
(
pos
, 
Ãxt
, 
bag
è
	`li¡_fÜ_—ch_§ã
Õos,‚ext, bag)

	)

45 
	s_¢d_mix”_şass
 {

46 
li¡_h—d
 
	mli¡
;

47 
¢d_mix”_t
 *
	mmix”
;

48 
¢d_mix”_ev’t_t
 
	mev’t
;

49 *
	m´iv©e_d©a
;

50 (*
	m´iv©e_ä“
)(
¢d_mix”_şass_t
 *
	mşass
);

51 
¢d_mix”_com·»_t
 
	mcom·»
;

54 
	s_¢d_mix”_–em
 {

55 
¢d_mix”_–em_ty³_t
 
	mty³
;

56 
li¡_h—d
 
	mli¡
;

57 
¢d_mix”_şass_t
 *
	mşass
;

58 *
	m´iv©e_d©a
;

59 (*
	m´iv©e_ä“
)(
¢d_mix”_–em_t
 *
	m–em
);

60 
¢d_mix”_–em_ÿÎback_t
 
	mÿÎback
;

61 *
	mÿÎback_´iv©e
;

62 
bag_t
 
	mh–ems
;

63 
	mcom·»_weight
;

66 
	s_¢d_mix”
 {

67 
li¡_h—d
 
	m¦aves
;

68 
li¡_h—d
 
	mşas£s
;

69 
li¡_h—d
 
	m–ems
;

70 
¢d_mix”_–em_t
 **
	m³Ëms
;

71 
	mcouÁ
;

72 
	m®loc
;

73 
	mev’ts
;

74 
¢d_mix”_ÿÎback_t
 
	mÿÎback
;

75 *
	mÿÎback_´iv©e
;

76 
¢d_mix”_com·»_t
 
	mcom·»
;

79 
	s_¢d_mix”_£Ëm_id
 {

80 
	mÇme
[60];

81 
	mšdex
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/mixer_simple.h

22 
	~"mix”_ab¡.h
"

25 
	#¢d_mix”_sim¶e_nÚe_»gi¡”
 \

26 
¢d1_mix”_sim¶e_nÚe_»gi¡”


	)

27 
	#¢d_mix”_sim¶e_basic_»gi¡”
 \

28 
¢d1_mix”_sim¶e_basic_»gi¡”


	)

30 
¢d_mix”_sim¶e_nÚe_»gi¡”
(
¢d_mix”_t
 *
mix”
, 
¢d_mix”_£Ëm_»gİt
 *
İtiÚs
, 
¢d_mix”_şass_t
 **
şas¥
);

32 #ifdeà
HAVE_LIBDL


33 
¢d_mix”_sim¶e_basic_»gi¡”
(
¢d_mix”_t
 *
mix”
, 
¢d_mix”_£Ëm_»gİt
 *
İtiÚs
, 
¢d_mix”_şass_t
 **
şas¥
);

35 
šlše
 
	$¢d_mix”_sim¶e_basic_»gi¡”
(
¢d_mix”_t
 *
mix”
 
ATTRIBUTE_UNUSED
,

36 
¢d_mix”_£Ëm_»gİt
 *
İtiÚs
 
ATTRIBUTE_UNUSED
,

37 
¢d_mix”_şass_t
 **
şas¥
 
ATTRIBUTE_UNUSED
)

39  -
ENXIO
;

40 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/simple.c

32 
	~"mix”_loÿl.h
"

33 
	~"mix”_sim¶e.h
"

34 
	~<¡dio.h
>

35 
	~<¡dlib.h
>

36 
	~<uni¡d.h
>

37 
	~<¡ršg.h
>

38 
	~<fú.h
>

39 
	~<sys/ioùl.h
>

40 
	~<m©h.h
>

49 
	$¢d_mix”_£Ëm_»gi¡”
(
¢d_mix”_t
 *
mix”
,

50 
¢d_mix”_£Ëm_»gİt
 *
İtiÚs
,

51 
¢d_mix”_şass_t
 **
şas¥
)

53 ià(
İtiÚs
 && o±iÚs->
v”
 == 1) {

54 ià(
İtiÚs
->
deviû
 !ğ
NULL
 &&

55 (
İtiÚs
->
¶ayback_pcm
 !ğ
NULL
 ||

56 
İtiÚs
->
ÿ±u»_pcm
 !ğ
NULL
))

57  -
EINVAL
;

58 ià(
İtiÚs
->
deviû
 =ğ
NULL
 &&

59 
İtiÚs
->
¶ayback_pcm
 =ğ
NULL
 &&

60 
İtiÚs
->
ÿ±u»_pcm
 =ğ
NULL
)

61  -
EINVAL
;

63 ià(
İtiÚs
 =ğ
NULL
 ||

64 (
İtiÚs
->
v”
 =ğ1 && o±iÚs->
ab¡¿ù
 =ğ
SND_MIXER_SABSTRACT_NONE
)) {

65 
”r
 = 
	`¢d_mix”_sim¶e_nÚe_»gi¡”
(
mix”
, 
İtiÚs
, 
şas¥
);

66 ià(
”r
 < 0)

67  
”r
;

68 ià(
İtiÚs
 !ğ
NULL
) {

69 
”r
 = 
	`¢d_mix”_©ch
(
mix”
, 
İtiÚs
->
deviû
);

70 ià(
”r
 < 0)

71  
”r
;

74 } ià(
İtiÚs
->
v”
 == 1) {

75 ià(
İtiÚs
->
ab¡¿ù
 =ğ
SND_MIXER_SABSTRACT_BASIC
)

76  
	`¢d_mix”_sim¶e_basic_»gi¡”
(
mix”
, 
İtiÚs
, 
şas¥
);

78  -
ENXIO
;

79 
	}
}

81 #iâdeà
DOC_HIDDEN


83 
	#CHECK_BASIC
(
x–em
) \

85 
	`as£¹
(
x–em
); \

86 
	`as£¹
((
x–em
)->
ty³
 =ğ
SND_MIXER_ELEM_SIMPLE
); \

87 }

	)

89 
	#CHECK_DIR
(
x–em
, 
xwh©
) \

91 
xÿps
 = ((
sm_£Ëm_t
 *)(
–em
)->
´iv©e_d©a
)->
ÿps
; \

92 ià(! (
xÿps
 & (
xwh©
))) \

93  -
EINVAL
; \

94 }

	)

96 
	#CHECK_DIR_CHN
(
x–em
, 
xwh©
, 
xjoš
, 
xchªÃl
) \

98 
xÿps
 = ((
sm_£Ëm_t
 *)(
–em
)->
´iv©e_d©a
)->
ÿps
; \

99 ià(! (
xÿps
 & (
xwh©
))) \

100  -
EINVAL
; \

101 ià(
xÿps
 & (
xjoš
)) \

102 
xchªÃl
 = 0; \

103 }

	)

105 
	#CHECK_ENUM
(
x–em
) \

106 ià(!(((
sm_£Ëm_t
 *)(
–em
)->
´iv©e_d©a
)->
ÿps
 & (
SM_CAP_PENUM
|
SM_CAP_CENUM
))) \

107  -
EINVAL
;

	)

109 
	#COND_CAPS
(
x–em
, 
wh©
) \

110 !!(((
sm_£Ëm_t
 *)(
–em
)->
´iv©e_d©a
)->
ÿps
 & (
wh©
))

	)

114 #iâdeà
DOC_HIDDEN


115 
	$¢d_mix”_£Ëm_com·»
(cÚ¡ 
¢d_mix”_–em_t
 *
c1
, cÚ¡ snd_mix”_–em_ˆ*
c2
)

117 
sm_£Ëm_t
 *
s1
 = 
c1
->
´iv©e_d©a
;

118 
sm_£Ëm_t
 *
s2
 = 
c2
->
´iv©e_d©a
;

119 
»s
 = 
	`¡rcmp
(
s1
->
id
->
Çme
, 
s2
->id->name);

120 ià(
»s
)

121  
»s
;

122  
s1
->
id
->
šdex
 - 
s2
->id->index;

123 
	}
}

132 
¢d_mix”_–em_t
 *
	$¢d_mix”_fšd_£Ëm
(
¢d_mix”_t
 *
mix”
,

133 cÚ¡ 
¢d_mix”_£Ëm_id_t
 *
id
)

135 
li¡_h—d
 *
li¡
;

136 
¢d_mix”_–em_t
 *
e
;

137 
sm_£Ëm_t
 *
s
;

139 
	`li¡_fÜ_—ch
(
li¡
, &
mix”
->
–ems
) {

140 
e
 = 
	`li¡_’Œy
(
li¡
, 
¢d_mix”_–em_t
,†ist);

141 ià(
e
->
ty³
 !ğ
SND_MIXER_ELEM_SIMPLE
)

143 
s
 = 
e
->
´iv©e_d©a
;

144 ià(!
	`¡rcmp
(
s
->
id
->
Çme
, id->Çmeè&& s->id->
šdex
 == id->index)

145  
e
;

147  
NULL
;

148 
	}
}

155 
	$¢d_mix”_£Ëm_g‘_id
(
¢d_mix”_–em_t
 *
–em
,

156 
¢d_mix”_£Ëm_id_t
 *
id
)

158 
sm_£Ëm_t
 *
s
;

159 
	`as£¹
(
id
);

160 
	`CHECK_BASIC
(
–em
);

161 
s
 = 
–em
->
´iv©e_d©a
;

162 *
id
 = *
s
->id;

163 
	}
}

170 cÚ¡ *
	$¢d_mix”_£Ëm_g‘_Çme
(
¢d_mix”_–em_t
 *
–em
)

172 
sm_£Ëm_t
 *
s
;

173 
	`CHECK_BASIC
(
–em
);

174 
s
 = 
–em
->
´iv©e_d©a
;

175  
s
->
id
->
Çme
;

176 
	}
}

183 
	$¢d_mix”_£Ëm_g‘_šdex
(
¢d_mix”_–em_t
 *
–em
)

185 
sm_£Ëm_t
 *
s
;

186 
	`CHECK_BASIC
(
–em
);

187 
s
 = 
–em
->
´iv©e_d©a
;

188  
s
->
id
->
šdex
;

189 
	}
}

196 
	$¢d_mix”_£Ëm_has_commÚ_vŞume
(
¢d_mix”_–em_t
 *
–em
)

198 
	`CHECK_BASIC
(
–em
);

199  
	`COND_CAPS
(
–em
, 
SM_CAP_GVOLUME
);

200 
	}
}

207 
	$¢d_mix”_£Ëm_has_commÚ_sw™ch
(
¢d_mix”_–em_t
 *
–em
)

209 
	`CHECK_BASIC
(
–em
);

210  
	`COND_CAPS
(
–em
, 
SM_CAP_GSWITCH
);

211 
	}
}

218 cÚ¡ *
	$¢d_mix”_£Ëm_chªÃl_Çme
(
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
)

220 cÚ¡ *cÚ¡ 
¬¿y
[
SND_MIXER_SCHN_LAST
 + 1] = {

221 [
SND_MIXER_SCHN_FRONT_LEFT
] = "Front Left",

222 [
SND_MIXER_SCHN_FRONT_RIGHT
] = "Front Right",

223 [
SND_MIXER_SCHN_REAR_LEFT
] = "Rear Left",

224 [
SND_MIXER_SCHN_REAR_RIGHT
] = "Rear Right",

225 [
SND_MIXER_SCHN_FRONT_CENTER
] = "Front Center",

226 [
SND_MIXER_SCHN_WOOFER
] = "Woofer",

227 [
SND_MIXER_SCHN_SIDE_LEFT
] = "Side Left",

228 [
SND_MIXER_SCHN_SIDE_RIGHT
] = "Side Right",

229 [
SND_MIXER_SCHN_REAR_CENTER
] = "Rear Center"

231 cÚ¡ *
p
;

232 
	`as£¹
(
chªÃl
 <ğ
SND_MIXER_SCHN_LAST
);

233 
p
 = 
¬¿y
[
chªÃl
];

234 ià(!
p
)

236  
p
;

237 
	}
}

244 
	$¢d_mix”_£Ëm_is_aùive
(
¢d_mix”_–em_t
 *
–em
)

246 
	`CHECK_BASIC
(
–em
);

247  
	`sm_£Ëm_İs
(
–em
)->
	`is
ÓËm, 
SM_PLAY
, 
SM_OPS_IS_ACTIVE
, 0);

248 
	}
}

255 
	$¢d_mix”_£Ëm_is_¶ayback_mÚo
(
¢d_mix”_–em_t
 *
–em
)

257 
	`CHECK_BASIC
(
–em
);

258  
	`sm_£Ëm_İs
(
–em
)->
	`is
ÓËm, 
SM_PLAY
, 
SM_OPS_IS_MONO
, 0);

259 
	}
}

267 
	$¢d_mix”_£Ëm_has_¶ayback_chªÃl
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
)

269 
	`CHECK_BASIC
(
–em
);

270  
	`sm_£Ëm_İs
(
–em
)->
	`is
ÓËm, 
SM_PLAY
, 
SM_OPS_IS_CHANNEL
, ()
chªÃl
);

271 
	}
}

279 
	$¢d_mix”_£Ëm_g‘_¶ayback_vŞume_¿nge
(
¢d_mix”_–em_t
 *
–em
,

280 *
mš
, *
max
)

282 
	`CHECK_BASIC
(
–em
);

283 
	`CHECK_DIR
(
–em
, 
SM_CAP_PVOLUME
);

284  
	`sm_£Ëm_İs
(
–em
)->
	`g‘_¿nge
ÓËm, 
SM_PLAY
, 
mš
, 
max
);

285 
	}
}

293 
	$¢d_mix”_£Ëm_g‘_¶ayback_dB_¿nge
(
¢d_mix”_–em_t
 *
–em
,

294 *
mš
, *
max
)

296 
	`CHECK_BASIC
(
–em
);

297 
	`CHECK_DIR
(
–em
, 
SM_CAP_PVOLUME
);

298  
	`sm_£Ëm_İs
(
–em
)->
	`g‘_dB_¿nge
ÓËm, 
SM_PLAY
, 
mš
, 
max
);

299 
	}
}

307 
	$¢d_mix”_£Ëm_£t_¶ayback_vŞume_¿nge
(
¢d_mix”_–em_t
 *
–em
,

308 
mš
, 
max
)

310 
	`CHECK_BASIC
(
–em
);

311 
	`as£¹
(
mš
 < 
max
);

312 
	`CHECK_DIR
(
–em
, 
SM_CAP_PVOLUME
);

313  
	`sm_£Ëm_İs
(
–em
)->
	`£t_¿nge
ÓËm, 
SM_PLAY
, 
mš
, 
max
);

314 
	}
}

321 
	$¢d_mix”_£Ëm_has_¶ayback_vŞume
(
¢d_mix”_–em_t
 *
–em
)

323 
	`CHECK_BASIC
(
–em
);

324  
	`COND_CAPS
(
–em
, 
SM_CAP_PVOLUME
);

325 
	}
}

332 
	$¢d_mix”_£Ëm_has_¶ayback_vŞume_jošed
(
¢d_mix”_–em_t
 *
–em
)

334 
	`CHECK_BASIC
(
–em
);

335  
	`COND_CAPS
(
–em
, 
SM_CAP_PVOLUME_JOIN
);

336 
	}
}

343 
	$¢d_mix”_£Ëm_has_¶ayback_sw™ch
(
¢d_mix”_–em_t
 *
–em
)

345 
	`CHECK_BASIC
(
–em
);

346  
	`COND_CAPS
(
–em
, 
SM_CAP_PSWITCH
);

347 
	}
}

354 
	$¢d_mix”_£Ëm_has_¶ayback_sw™ch_jošed
(
¢d_mix”_–em_t
 *
–em
)

356 
	`CHECK_BASIC
(
–em
);

357  
	`COND_CAPS
(
–em
, 
SM_CAP_PSWITCH_JOIN
);

358 
	}
}

367 
	$¢d_mix”_£Ëm_ask_¶ayback_vŞ_dB
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
, *
dBv®ue
)

369 
	`CHECK_BASIC
(
–em
);

370 
	`CHECK_DIR
(
–em
, 
SM_CAP_PVOLUME
);

371  
	`sm_£Ëm_İs
(
–em
)->
	`ask_vŞ_dB
ÓËm, 
SM_PLAY
, 
v®ue
, 
dBv®ue
);

372 
	}
}

383 
	$¢d_mix”_£Ëm_ask_¶ayback_dB_vŞ
(
¢d_mix”_–em_t
 *
–em
, 
dBv®ue
, 
dœ
, *
v®ue
)

385 
	`CHECK_BASIC
(
–em
);

386 
	`CHECK_DIR
(
–em
, 
SM_CAP_PVOLUME
);

387  
	`sm_£Ëm_İs
(
–em
)->
	`ask_dB_vŞ
ÓËm, 
SM_PLAY
, 
dBv®ue
, 
v®ue
, 
dœ
);

388 
	}
}

397 
	$¢d_mix”_£Ëm_g‘_¶ayback_vŞume
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
)

399 
	`CHECK_BASIC
(
–em
);

400 
	`CHECK_DIR_CHN
(
–em
, 
SM_CAP_PVOLUME
, 
SM_CAP_PVOLUME_JOIN
, 
chªÃl
);

401  
	`sm_£Ëm_İs
(
–em
)->
	`g‘_vŞume
ÓËm, 
SM_PLAY
, 
chªÃl
, 
v®ue
);

402 
	}
}

411 
	$¢d_mix”_£Ëm_g‘_¶ayback_dB
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
)

413 
ÿps
;

415 
	`CHECK_BASIC
(
–em
);

416 
ÿps
 = ((
sm_£Ëm_t
 *)
–em
->
´iv©e_d©a
)->caps;

417 ià(!(
ÿps
 & 
SM_CAP_PVOLUME
))

418  -
EINVAL
;

419 ià(
ÿps
 & 
SM_CAP_PVOLUME_JOIN
)

420 
chªÃl
 = 0;

421  
	`sm_£Ëm_İs
(
–em
)->
	`g‘_dB
ÓËm, 
SM_PLAY
, 
chªÃl
, 
v®ue
);

422 
	}
}

431 
	$¢d_mix”_£Ëm_g‘_¶ayback_sw™ch
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
)

433 
	`CHECK_BASIC
(
–em
);

434 
	`CHECK_DIR_CHN
(
–em
, 
SM_CAP_PSWITCH
, 
SM_CAP_PSWITCH_JOIN
, 
chªÃl
);

435  
	`sm_£Ëm_İs
(
–em
)->
	`g‘_sw™ch
ÓËm, 
SM_PLAY
, 
chªÃl
, 
v®ue
);

436 
	}
}

445 
	$¢d_mix”_£Ëm_£t_¶ayback_vŞume
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
)

447 
	`CHECK_BASIC
(
–em
);

448 
	`CHECK_DIR_CHN
(
–em
, 
SM_CAP_PVOLUME
, 
SM_CAP_PVOLUME_JOIN
, 
chªÃl
);

449  
	`sm_£Ëm_İs
(
–em
)->
	`£t_vŞume
ÓËm, 
SM_PLAY
, 
chªÃl
, 
v®ue
);

450 
	}
}

461 
	$¢d_mix”_£Ëm_£t_¶ayback_dB
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
, 
dœ
)

463 
	`CHECK_BASIC
(
–em
);

464 
	`CHECK_DIR_CHN
(
–em
, 
SM_CAP_PVOLUME
, 
SM_CAP_PVOLUME_JOIN
, 
chªÃl
);

465  
	`sm_£Ëm_İs
(
–em
)->
	`£t_dB
ÓËm, 
SM_PLAY
, 
chªÃl
, 
v®ue
, 
dœ
);

466 
	}
}

474 
	$¢d_mix”_£Ëm_£t_¶ayback_vŞume_®l
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
)

476 
¢d_mix”_£Ëm_chªÃl_id_t
 
chn
;

477 
”r
;

479 
chn
 = 0; chn < 32; chn++) {

480 ià(!
	`¢d_mix”_£Ëm_has_¶ayback_chªÃl
(
–em
, 
chn
))

482 
”r
 = 
	`¢d_mix”_£Ëm_£t_¶ayback_vŞume
(
–em
, 
chn
, 
v®ue
);

483 ià(
”r
 < 0)

484  
”r
;

485 ià(
chn
 =ğ0 && 
	`¢d_mix”_£Ëm_has_¶ayback_vŞume_jošed
(
–em
))

489 
	}
}

499 
	$¢d_mix”_£Ëm_£t_¶ayback_dB_®l
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
, 
dœ
)

501 
¢d_mix”_£Ëm_chªÃl_id_t
 
chn
;

502 
”r
;

504 
chn
 = 0; chn < 32; chn++) {

505 ià(!
	`¢d_mix”_£Ëm_has_¶ayback_chªÃl
(
–em
, 
chn
))

507 
”r
 = 
	`¢d_mix”_£Ëm_£t_¶ayback_dB
(
–em
, 
chn
, 
v®ue
, 
dœ
);

508 ià(
”r
 < 0)

509  
”r
;

510 ià(
chn
 =ğ0 && 
	`¢d_mix”_£Ëm_has_¶ayback_vŞume_jošed
(
–em
))

514 
	}
}

523 
	$¢d_mix”_£Ëm_£t_¶ayback_sw™ch
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
)

525 
	`CHECK_BASIC
(
–em
);

526 
	`CHECK_DIR_CHN
(
–em
, 
SM_CAP_PSWITCH
, 
SM_CAP_PSWITCH_JOIN
, 
chªÃl
);

527  
	`sm_£Ëm_İs
(
–em
)->
	`£t_sw™ch
ÓËm, 
SM_PLAY
, 
chªÃl
, 
v®ue
);

528 
	}
}

536 
	$¢d_mix”_£Ëm_£t_¶ayback_sw™ch_®l
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
)

538 
¢d_mix”_£Ëm_chªÃl_id_t
 
chn
;

539 
”r
;

541 
	`CHECK_BASIC
(
–em
);

542 
chn
 = 0; chn < 32; chn++) {

543 ià(!
	`¢d_mix”_£Ëm_has_¶ayback_chªÃl
(
–em
, 
chn
))

545 
”r
 = 
	`¢d_mix”_£Ëm_£t_¶ayback_sw™ch
(
–em
, 
chn
, 
v®ue
);

546 ià(
”r
 < 0)

547  
”r
;

548 ià(
chn
 =ğ0 && 
	`¢d_mix”_£Ëm_has_¶ayback_sw™ch_jošed
(
–em
))

552 
	}
}

559 
	$¢d_mix”_£Ëm_is_ÿ±u»_mÚo
(
¢d_mix”_–em_t
 *
–em
)

561 
	`CHECK_BASIC
(
–em
);

562 
	`CHECK_DIR
(
–em
, 
SM_CAP_CVOLUME
|
SM_CAP_CSWITCH
);

563  
	`sm_£Ëm_İs
(
–em
)->
	`is
ÓËm, 
SM_CAPT
, 
SM_OPS_IS_MONO
, 0);

564 
	}
}

572 
	$¢d_mix”_£Ëm_has_ÿ±u»_chªÃl
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
)

574 
	`CHECK_BASIC
(
–em
);

575 
	`CHECK_DIR
(
–em
, 
SM_CAP_CVOLUME
|
SM_CAP_CSWITCH
);

576  
	`sm_£Ëm_İs
(
–em
)->
	`is
ÓËm, 
SM_CAPT
, 
SM_OPS_IS_CHANNEL
, 
chªÃl
);

577 
	}
}

585 
	$¢d_mix”_£Ëm_g‘_ÿ±u»_vŞume_¿nge
(
¢d_mix”_–em_t
 *
–em
,

586 *
mš
, *
max
)

588 
	`CHECK_BASIC
(
–em
);

589 
	`CHECK_DIR
(
–em
, 
SM_CAP_CVOLUME
);

590  
	`sm_£Ëm_İs
(
–em
)->
	`g‘_¿nge
ÓËm, 
SM_CAPT
, 
mš
, 
max
);

591 
	}
}

599 
	$¢d_mix”_£Ëm_g‘_ÿ±u»_dB_¿nge
(
¢d_mix”_–em_t
 *
–em
,

600 *
mš
, *
max
)

602 
	`CHECK_BASIC
(
–em
);

603 
	`CHECK_DIR
(
–em
, 
SM_CAP_CVOLUME
);

604  
	`sm_£Ëm_İs
(
–em
)->
	`g‘_dB_¿nge
ÓËm, 
SM_CAPT
, 
mš
, 
max
);

605 
	}
}

613 
	$¢d_mix”_£Ëm_£t_ÿ±u»_vŞume_¿nge
(
¢d_mix”_–em_t
 *
–em
,

614 
mš
, 
max
)

616 
	`CHECK_BASIC
(
–em
);

617 
	`as£¹
(
mš
 < 
max
);

618 
	`CHECK_DIR
(
–em
, 
SM_CAP_CVOLUME
);

619  
	`sm_£Ëm_İs
(
–em
)->
	`£t_¿nge
ÓËm, 
SM_CAPT
, 
mš
, 
max
);

620 
	}
}

627 
	$¢d_mix”_£Ëm_has_ÿ±u»_vŞume
(
¢d_mix”_–em_t
 *
–em
)

629 
	`CHECK_BASIC
(
–em
);

630  
	`COND_CAPS
(
–em
, 
SM_CAP_CVOLUME
);

631 
	}
}

638 
	$¢d_mix”_£Ëm_has_ÿ±u»_vŞume_jošed
(
¢d_mix”_–em_t
 *
–em
)

640 
	`CHECK_BASIC
(
–em
);

641  
	`COND_CAPS
(
–em
, 
SM_CAP_CVOLUME_JOIN
);

642 
	}
}

649 
	$¢d_mix”_£Ëm_has_ÿ±u»_sw™ch
(
¢d_mix”_–em_t
 *
–em
)

651 
	`CHECK_BASIC
(
–em
);

652  
	`COND_CAPS
(
–em
, 
SM_CAP_CSWITCH
);

653 
	}
}

660 
	$¢d_mix”_£Ëm_has_ÿ±u»_sw™ch_jošed
(
¢d_mix”_–em_t
 *
–em
)

662 
	`CHECK_BASIC
(
–em
);

663  
	`COND_CAPS
(
–em
, 
SM_CAP_CSWITCH_JOIN
);

664 
	}
}

671 
	$¢d_mix”_£Ëm_has_ÿ±u»_sw™ch_exşusive
(
¢d_mix”_–em_t
 *
–em
)

673 
	`CHECK_BASIC
(
–em
);

674  
	`COND_CAPS
(
–em
, 
SM_CAP_CSWITCH_EXCL
);

675 
	}
}

682 
	$¢d_mix”_£Ëm_g‘_ÿ±u»_group
(
¢d_mix”_–em_t
 *
–em
)

684 
sm_£Ëm_t
 *
s
;

685 
	`CHECK_BASIC
(
–em
);

686 
s
 = 
–em
->
´iv©e_d©a
;

687 ià(! (
s
->
ÿps
 & 
SM_CAP_CSWITCH_EXCL
))

688  -
EINVAL
;

689  
s
->
ÿ±u»_group
;

690 
	}
}

699 
	$¢d_mix”_£Ëm_ask_ÿ±u»_vŞ_dB
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
, *
dBv®ue
)

701 
	`CHECK_BASIC
(
–em
);

702 
	`CHECK_DIR
(
–em
, 
SM_CAP_CVOLUME
);

703  
	`sm_£Ëm_İs
(
–em
)->
	`ask_vŞ_dB
ÓËm, 
SM_CAPT
, 
v®ue
, 
dBv®ue
);

704 
	}
}

715 
	$¢d_mix”_£Ëm_ask_ÿ±u»_dB_vŞ
(
¢d_mix”_–em_t
 *
–em
, 
dBv®ue
, 
dœ
, *
v®ue
)

717 
	`CHECK_BASIC
(
–em
);

718 
	`CHECK_DIR
(
–em
, 
SM_CAP_CVOLUME
);

719  
	`sm_£Ëm_İs
(
–em
)->
	`ask_dB_vŞ
ÓËm, 
SM_CAPT
, 
dBv®ue
, 
v®ue
, 
dœ
);

720 
	}
}

729 
	$¢d_mix”_£Ëm_g‘_ÿ±u»_vŞume
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
)

731 
	`CHECK_BASIC
(
–em
);

732 
	`CHECK_DIR_CHN
(
–em
, 
SM_CAP_CVOLUME
, 
SM_CAP_CVOLUME_JOIN
, 
chªÃl
);

733  
	`sm_£Ëm_İs
(
–em
)->
	`g‘_vŞume
ÓËm, 
SM_CAPT
, 
chªÃl
, 
v®ue
);

734 
	}
}

743 
	$¢d_mix”_£Ëm_g‘_ÿ±u»_dB
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
)

745 
	`CHECK_BASIC
(
–em
);

746 
	`CHECK_DIR_CHN
(
–em
, 
SM_CAP_CVOLUME
, 
SM_CAP_CVOLUME_JOIN
, 
chªÃl
);

747  
	`sm_£Ëm_İs
(
–em
)->
	`g‘_dB
ÓËm, 
SM_CAPT
, 
chªÃl
, 
v®ue
);

748 
	}
}

757 
	$¢d_mix”_£Ëm_g‘_ÿ±u»_sw™ch
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
)

759 
	`CHECK_BASIC
(
–em
);

760 
	`CHECK_DIR_CHN
(
–em
, 
SM_CAP_CSWITCH
, 
SM_CAP_CSWITCH_JOIN
, 
chªÃl
);

761  
	`sm_£Ëm_İs
(
–em
)->
	`g‘_sw™ch
ÓËm, 
SM_CAPT
, 
chªÃl
, 
v®ue
);

762 
	}
}

771 
	$¢d_mix”_£Ëm_£t_ÿ±u»_vŞume
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
)

773 
	`CHECK_BASIC
(
–em
);

774 
	`CHECK_DIR_CHN
(
–em
, 
SM_CAP_CVOLUME
, 
SM_CAP_CVOLUME_JOIN
, 
chªÃl
);

775  
	`sm_£Ëm_İs
(
–em
)->
	`£t_vŞume
ÓËm, 
SM_CAPT
, 
chªÃl
, 
v®ue
);

776 
	}
}

787 
	$¢d_mix”_£Ëm_£t_ÿ±u»_dB
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
, 
dœ
)

789 
	`CHECK_BASIC
(
–em
);

790 
	`CHECK_DIR_CHN
(
–em
, 
SM_CAP_CVOLUME
, 
SM_CAP_CVOLUME_JOIN
, 
chªÃl
);

791  
	`sm_£Ëm_İs
(
–em
)->
	`£t_dB
ÓËm, 
SM_CAPT
, 
chªÃl
, 
v®ue
, 
dœ
);

792 
	}
}

800 
	$¢d_mix”_£Ëm_£t_ÿ±u»_vŞume_®l
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
)

802 
¢d_mix”_£Ëm_chªÃl_id_t
 
chn
;

803 
”r
;

805 
chn
 = 0; chn < 32; chn++) {

806 ià(!
	`¢d_mix”_£Ëm_has_ÿ±u»_chªÃl
(
–em
, 
chn
))

808 
”r
 = 
	`¢d_mix”_£Ëm_£t_ÿ±u»_vŞume
(
–em
, 
chn
, 
v®ue
);

809 ià(
”r
 < 0)

810  
”r
;

811 ià(
chn
 =ğ0 && 
	`¢d_mix”_£Ëm_has_ÿ±u»_vŞume_jošed
(
–em
))

815 
	}
}

825 
	$¢d_mix”_£Ëm_£t_ÿ±u»_dB_®l
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
, 
dœ
)

827 
¢d_mix”_£Ëm_chªÃl_id_t
 
chn
;

828 
”r
;

830 
chn
 = 0; chn < 32; chn++) {

831 ià(!
	`¢d_mix”_£Ëm_has_ÿ±u»_chªÃl
(
–em
, 
chn
))

833 
”r
 = 
	`¢d_mix”_£Ëm_£t_ÿ±u»_dB
(
–em
, 
chn
, 
v®ue
, 
dœ
);

834 ià(
”r
 < 0)

835  
”r
;

836 ià(
chn
 =ğ0 && 
	`¢d_mix”_£Ëm_has_ÿ±u»_vŞume_jošed
(
–em
))

840 
	}
}

849 
	$¢d_mix”_£Ëm_£t_ÿ±u»_sw™ch
(
¢d_mix”_–em_t
 *
–em
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
)

851 
	`CHECK_BASIC
(
–em
);

852 
	`CHECK_DIR_CHN
(
–em
, 
SM_CAP_CSWITCH
, 
SM_CAP_CSWITCH_JOIN
, 
chªÃl
);

853  
	`sm_£Ëm_İs
(
–em
)->
	`£t_sw™ch
ÓËm, 
SM_CAPT
, 
chªÃl
, 
v®ue
);

854 
	}
}

862 
	$¢d_mix”_£Ëm_£t_ÿ±u»_sw™ch_®l
(
¢d_mix”_–em_t
 *
–em
, 
v®ue
)

864 
¢d_mix”_£Ëm_chªÃl_id_t
 
chn
;

865 
”r
;

867 
chn
 = 0; chn < 32; chn++) {

868 ià(!
	`¢d_mix”_£Ëm_has_ÿ±u»_chªÃl
(
–em
, 
chn
))

870 
”r
 = 
	`¢d_mix”_£Ëm_£t_ÿ±u»_sw™ch
(
–em
, 
chn
, 
v®ue
);

871 ià(
”r
 < 0)

872  
”r
;

873 ià(
chn
 =ğ0 && 
	`¢d_mix”_£Ëm_has_ÿ±u»_sw™ch_jošed
(
–em
))

877 
	}
}

884 
	$¢d_mix”_£Ëm_is_’um”©ed
(
¢d_mix”_–em_t
 *
–em
)

886 
	`CHECK_BASIC
(
–em
);

887  
	`sm_£Ëm_İs
(
–em
)->
	`is
ÓËm, 
SM_PLAY
, 
SM_OPS_IS_ENUMERATED
, 0);

888 
	}
}

895 
	$¢d_mix”_£Ëm_is_’um_¶ayback
(
¢d_mix”_–em_t
 *
–em
)

897 
	`CHECK_BASIC
(
–em
);

898  
	`sm_£Ëm_İs
(
–em
)->
	`is
ÓËm, 
SM_PLAY
, 
SM_OPS_IS_ENUMERATED
, 1);

899 
	}
}

906 
	$¢d_mix”_£Ëm_is_’um_ÿ±u»
(
¢d_mix”_–em_t
 *
–em
)

908 
	`CHECK_BASIC
(
–em
);

909  
	`sm_£Ëm_İs
(
–em
)->
	`is
ÓËm, 
SM_CAPT
, 
SM_OPS_IS_ENUMERATED
, 1);

910 
	}
}

917 
	$¢d_mix”_£Ëm_g‘_’um_™ems
(
¢d_mix”_–em_t
 *
–em
)

919 
	`CHECK_BASIC
(
–em
);

920 
	`CHECK_ENUM
(
–em
);

921  
	`sm_£Ëm_İs
(
–em
)->
	`is
ÓËm, 
SM_PLAY
, 
SM_OPS_IS_ENUMCNT
, 0);

922 
	}
}

932 
	$¢d_mix”_£Ëm_g‘_’um_™em_Çme
(
¢d_mix”_–em_t
 *
–em
,

933 
™em
,

934 
size_t
 
maxËn
, *
buf
)

936 
	`CHECK_BASIC
(
–em
);

937 
	`CHECK_ENUM
(
–em
);

938  
	`sm_£Ëm_İs
(
–em
)->
	`’um_™em_Çme
ÓËm, 
™em
, 
maxËn
, 
buf
);

939 
	}
}

948 
	$¢d_mix”_£Ëm_g‘_’um_™em
(
¢d_mix”_–em_t
 *
–em
,

949 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
,

950 *
™emp
)

952 
	`CHECK_BASIC
(
–em
);

953 
	`CHECK_ENUM
(
–em
);

954  
	`sm_£Ëm_İs
(
–em
)->
	`g‘_’um_™em
ÓËm, 
chªÃl
, 
™emp
);

955 
	}
}

964 
	$¢d_mix”_£Ëm_£t_’um_™em
(
¢d_mix”_–em_t
 *
–em
,

965 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
,

966 
™em
)

968 
	`CHECK_BASIC
(
–em
);

969 
	`CHECK_ENUM
(
–em
);

970  
	`sm_£Ëm_İs
(
–em
)->
	`£t_’um_™em
ÓËm, 
chªÃl
, 
™em
);

971 
	}
}

977 
size_t
 
	$¢d_mix”_£Ëm_id_sizeof
()

979  (
¢d_mix”_£Ëm_id_t
);

980 
	}
}

987 
	$¢d_mix”_£Ëm_id_m®loc
(
¢d_mix”_£Ëm_id_t
 **
±r
)

989 
	`as£¹
(
±r
);

990 *
±r
 = 
	`ÿÎoc
(1, (
¢d_mix”_£Ëm_id_t
));

991 ià(!*
±r
)

992  -
ENOMEM
;

994 
	}
}

1000 
	$¢d_mix”_£Ëm_id_ä“
(
¢d_mix”_£Ëm_id_t
 *
obj
)

1002 
	`ä“
(
obj
);

1003 
	}
}

1010 
	$¢d_mix”_£Ëm_id_cİy
(
¢d_mix”_£Ëm_id_t
 *
d¡
, cÚ¡ snd_mix”_£Ëm_id_ˆ*
¤c
)

1012 
	`as£¹
(
d¡
 && 
¤c
);

1013 *
d¡
 = *
¤c
;

1014 
	}
}

1021 cÚ¡ *
	$¢d_mix”_£Ëm_id_g‘_Çme
(cÚ¡ 
¢d_mix”_£Ëm_id_t
 *
obj
)

1023 
	`as£¹
(
obj
);

1024  
obj
->
Çme
;

1025 
	}
}

1032 
	$¢d_mix”_£Ëm_id_g‘_šdex
(cÚ¡ 
¢d_mix”_£Ëm_id_t
 *
obj
)

1034 
	`as£¹
(
obj
);

1035  
obj
->
šdex
;

1036 
	}
}

1043 
	$¢d_mix”_£Ëm_id_£t_Çme
(
¢d_mix”_£Ëm_id_t
 *
obj
, cÚ¡ *
v®
)

1045 
	`as£¹
(
obj
);

1046 
	`¡ºıy
(
obj
->
Çme
, 
v®
, (obj->name));

1047 
obj
->
Çme
[(obj->name)-1] = '\0';

1048 
	}
}

1055 
	$¢d_mix”_£Ëm_id_£t_šdex
(
¢d_mix”_£Ëm_id_t
 *
obj
, 
v®
)

1057 
	`as£¹
(
obj
);

1058 
obj
->
šdex
 = 
v®
;

1059 
	}
}

1066 
	$¢d_mix”_£Ëm_id_·r£
(
¢d_mix”_£Ëm_id_t
 *
d¡
, cÚ¡ *
¡r
)

1068 
c
, 
size
;

1069 
buf
[128];

1070 *
±r
 = 
buf
;

1072 
	`mem£t
(
d¡
, 0, (*dst));

1073 *
¡r
 == ' ' || *str == '\t')

1074 
¡r
++;

1075 ià(!(*
¡r
))

1076  -
EINVAL
;

1077 
size
 = 1;

1078 ià(*
¡r
 != '"' && *str != '\'') {

1079 *
¡r
 && *str != ',') {

1080 ià(
size
 < ()(
buf
)) {

1081 *
±r
++ = *
¡r
;

1082 
size
++;

1084 
¡r
++;

1087 
c
 = *
¡r
++;

1088 *
¡r
 && *¡¸!ğ
c
) {

1089 ià(
size
 < ()(
buf
)) {

1090 *
±r
++ = *
¡r
;

1091 
size
++;

1093 
¡r
++;

1095 ià(*
¡r
 =ğ
c
)

1096 
¡r
++;

1098 ià(*
¡r
 == '\0') {

1099 *
±r
 = 0;

1100 
_£t
;

1102 ià(*
¡r
 != ',')

1103  -
EINVAL
;

1104 *
±r
 = 0;

1105 
¡r
++;

1106 ià(
¡r
[0] < '0' || str[1] > '9')

1107  -
EINVAL
;

1108 
d¡
->
šdex
 = 
	`©oi
(
¡r
);

1109 
_£t
:

1110 
	`¢d_¡¾ıy
(
d¡
->
Çme
, 
buf
, (dst->name));

1112 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/simple_abst.c

30 
	~"mix”_loÿl.h
"

31 
	~"mix”_sim¶e.h
"

32 
	~<¡dio.h
>

33 
	~<¡dlib.h
>

34 
	~<uni¡d.h
>

35 
	~<¡ršg.h
>

36 
	~<fú.h
>

37 
	~<sys/ioùl.h
>

38 
	~<m©h.h
>

39 
	~<dlfú.h
>

41 #iâdeà
DOC_HIDDEN


43 
	#SO_PATH
 "smix”"

	)

45 
	s_şass_´iv
 {

46 *
	mdeviû
;

47 
¢d_ùl_t
 *
	mùl
;

48 
¢d_hùl_t
 *
	mhùl
;

49 
	m©ch_æag
;

50 
¢d_ùl_ÿrd_šfo_t
 *
	mšfo
;

51 *
	mdlhªdË
;

52 *
	m´iv©e_d©a
;

53 (*
	m´iv©e_ä“
)(
¢d_mix”_şass_t
 *
	mşass
);

54 } 
	tşass_´iv_t
;

56 (*
	t¢d_mix”_sbasic_š™_t
)(
	t¢d_mix”_şass_t
 *
	tşass
);

57 (*
	t¢d_mix”_sfbasic_š™_t
)(
	t¢d_mix”_şass_t
 *
	tşass
,

58 
	t¢d_mix”_t
 *
	tmix”
,

59 cÚ¡ *
	tdeviû
);

63 
	$Œy_İ’
(
¢d_mix”_şass_t
 *
şass
, cÚ¡ *
lib
)

65 
şass_´iv_t
 *
´iv
 = 
	`¢d_mix”_şass_g‘_´iv©e
(
şass
);

66 
¢d_mix”_ev’t_t
 
ev’t_func
;

67 
¢d_mix”_sbasic_š™_t
 
š™_func
 = 
NULL
;

68 *
xlib
, *
·th
, 
”rbuf
[256];

69 *
h
;

70 
”r
 = 0;

72 ià(!
lib
)

73  -
ENXIO
;

74 
·th
 = 
	`g‘’v
("ALSA_MIXER_SIMPLE_MODULES");

75 ià(!
·th
)

76 
·th
 = 
SO_PATH
;

77 
xlib
 = 
	`m®loc
(
	`¡¾’
(
lib
è+ sŒËn(
·th
) + 1 + 1);

78 ià(
xlib
 =ğ
NULL
)

79  -
ENOMEM
;

80 
	`¡rıy
(
xlib
, 
·th
);

81 
	`¡rÿt
(
xlib
, "/");

82 
	`¡rÿt
(
xlib
, 
lib
);

83 
h
 = 
	`INTERNAL
(
¢d_dlİ’
)(
xlib
, 
RTLD_NOW
, 
”rbuf
, (errbuf));

84 ià(
h
 =ğ
NULL
) {

85 
	`SNDERR
("UÇbËØİ’†ib¿ry '%s' (%s)", 
xlib
, 
”rbuf
);

86 
	`ä“
(
xlib
);

87  -
ENXIO
;

89 
´iv
->
dlhªdË
 = 
h
;

90 
ev’t_func
 = 
	`¢d_dlsym
(
h
, "®§_mix”_sim¶e_ev’t", 
NULL
);

91 ià(
ev’t_func
 =ğ
NULL
) {

92 
	`SNDERR
("SymbŞ '®§_mix”_sim¶e_ev’t' wa nÙ found iÀ'%s'", 
xlib
);

93 
”r
 = -
ENXIO
;

95 ià(
”r
 == 0) {

96 
š™_func
 = 
	`¢d_dlsym
(
h
, "®§_mix”_sim¶e_š™", 
NULL
);

97 ià(
š™_func
 =ğ
NULL
) {

98 
	`SNDERR
("SymbŞ '®§_mix”_sim¶e_š™' wa nÙ found iÀ'%s'", 
xlib
);

99 
”r
 = -
ENXIO
;

102 
	`ä“
(
xlib
);

103 
”r
 =ƒ¼ =ğ0 ? 
	`š™_func
(
şass
) :ƒrr;

104 ià(
”r
 < 0)

105  
”r
;

106 
	`¢d_mix”_şass_£t_ev’t
(
şass
, 
ev’t_func
);

108 
	}
}

110 
	$Œy_İ’_fuÎ
(
¢d_mix”_şass_t
 *
şass
, 
¢d_mix”_t
 *
mix”
,

111 cÚ¡ *
lib
, cÚ¡ *
deviû
)

113 
şass_´iv_t
 *
´iv
 = 
	`¢d_mix”_şass_g‘_´iv©e
(
şass
);

114 
¢d_mix”_ev’t_t
 
ev’t_func
;

115 
¢d_mix”_sfbasic_š™_t
 
š™_func
 = 
NULL
;

116 *
xlib
, *
·th
, 
”rbuf
[256];

117 *
h
;

118 
”r
 = 0;

120 
·th
 = 
	`g‘’v
("ALSA_MIXER_SIMPLE_MODULES");

121 ià(!
·th
)

122 
·th
 = 
SO_PATH
;

123 
xlib
 = 
	`m®loc
(
	`¡¾’
(
lib
è+ sŒËn(
·th
) + 1 + 1);

124 ià(
xlib
 =ğ
NULL
)

125  -
ENOMEM
;

126 
	`¡rıy
(
xlib
, 
·th
);

127 
	`¡rÿt
(
xlib
, "/");

128 
	`¡rÿt
(
xlib
, 
lib
);

130 
h
 = 
	`INTERNAL
(
¢d_dlİ’
)(
xlib
, 
RTLD_NOW
|
RTLD_GLOBAL
, 
”rbuf
, (errbuf));

131 ià(
h
 =ğ
NULL
) {

132 
	`SNDERR
("UÇbËØİ’†ib¿ry '%s'", 
xlib
);

133 
	`ä“
(
xlib
);

134  -
ENXIO
;

136 
´iv
->
dlhªdË
 = 
h
;

137 
ev’t_func
 = 
	`¢d_dlsym
(
h
, "®§_mix”_sim¶e_ev’t", 
NULL
);

138 ià(
ev’t_func
 =ğ
NULL
) {

139 
	`SNDERR
("SymbŞ '®§_mix”_sim¶e_ev’t' wa nÙ found iÀ'%s'", 
xlib
);

140 
”r
 = -
ENXIO
;

142 ià(
”r
 == 0) {

143 
š™_func
 = 
	`¢d_dlsym
(
h
, "®§_mix”_sim¶e_fš™", 
NULL
);

144 ià(
š™_func
 =ğ
NULL
) {

145 
	`SNDERR
("SymbŞ '®§_mix”_sim¶e_fš™' wa nÙ found iÀ'%s'", 
xlib
);

146 
”r
 = -
ENXIO
;

149 
	`ä“
(
xlib
);

150 
”r
 =ƒ¼ =ğ0 ? 
	`š™_func
(
şass
, 
mix”
, 
deviû
) :ƒrr;

151 ià(
”r
 < 0)

152  
”r
;

153 
	`¢d_mix”_şass_£t_ev’t
(
şass
, 
ev’t_func
);

155 
	}
}

157 
	$m©ch
(
¢d_mix”_şass_t
 *
şass
, cÚ¡ *
lib
, cÚ¡ *
£¬chl
)

159 
şass_´iv_t
 *
´iv
 = 
	`¢d_mix”_şass_g‘_´iv©e
(
şass
);

160 cÚ¡ *
compÚ’ts
;

162 ià(
£¬chl
 =ğ
NULL
)

163  
	`Œy_İ’
(
şass
, 
lib
);

164 
compÚ’ts
 = 
	`¢d_ùl_ÿrd_šfo_g‘_compÚ’ts
(
´iv
->
šfo
);

165 *
compÚ’ts
 != '\0') {

166 ià(!
	`¡ºcmp
(
compÚ’ts
, 
£¬chl
, 
	`¡¾’
(searchl)))

167  
	`Œy_İ’
(
şass
, 
lib
);

168 *
compÚ’ts
 != ' ' && *components != '\0')

169 
compÚ’ts
++;

170 *
compÚ’ts
 == ' ' && *components != '\0')

171 
compÚ’ts
++;

174 
	}
}

176 
	$fšd_fuÎ
(
¢d_mix”_şass_t
 *
şass
, 
¢d_mix”_t
 *
mix”
,

177 
¢d_cÚfig_t
 *
tİ
, cÚ¡ *
deviû
)

179 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

180 *
lib
;

181 cÚ¡ *
id
;

182 
”r
;

184 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
tİ
) {

185 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

186 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

188 ià(
	`¡rcmp
(
id
, "_full"))

190 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, (cÚ¡ **)&
lib
);

191 ià(
”r
 < 0)

192  
”r
;

193 
”r
 = 
	`Œy_İ’_fuÎ
(
şass
, 
mix”
, 
lib
, 
deviû
);

194 ià(
”r
 < 0)

195  
”r
;

198  -
ENOENT
;

199 
	}
}

201 
	$fšd_moduË
(
¢d_mix”_şass_t
 *
şass
, 
¢d_cÚfig_t
 *
tİ
)

203 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

204 
¢d_cÚfig_™”©Ü_t
 
j
, 
jÃxt
;

205 *
lib
, *
£¬chl
;

206 cÚ¡ *
id
;

207 
”r
;

209 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
tİ
) {

210 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

211 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

213 ià(*
id
 == '_')

215 
£¬chl
 = 
NULL
;

216 
lib
 = 
NULL
;

217 
	`¢d_cÚfig_fÜ_—ch
(
j
, 
jÃxt
, 
n
) {

218 
¢d_cÚfig_t
 *
m
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
j
);

219 ià(
	`¢d_cÚfig_g‘_id
(
m
, &
id
) < 0)

221 ià(!
	`¡rcmp
(
id
, "searchl")) {

222 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
m
, (cÚ¡ **)&
£¬chl
);

223 ià(
”r
 < 0)

224  
”r
;

227 ià(!
	`¡rcmp
(
id
, "lib")) {

228 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
m
, (cÚ¡ **)&
lib
);

229 ià(
”r
 < 0)

230  
”r
;

234 
”r
 = 
	`m©ch
(
şass
, 
lib
, 
£¬chl
);

235 ià(
”r
 == 1)

237 ià(
”r
 < 0)

238  
”r
;

240  -
ENOENT
;

241 
	}
}

243 
	$´iv©e_ä“
(
¢d_mix”_şass_t
 *
şass
)

245 
şass_´iv_t
 *
´iv
 = 
	`¢d_mix”_şass_g‘_´iv©e
(
şass
);

247 ià(
´iv
->
´iv©e_ä“
)

248 
´iv
->
	`´iv©e_ä“
(
şass
);

249 ià(
´iv
->
dlhªdË
)

250 
	`¢d_dlşo£
(
´iv
->
dlhªdË
);

251 ià(
´iv
->
šfo
)

252 
	`¢d_ùl_ÿrd_šfo_ä“
(
´iv
->
šfo
);

253 ià(
´iv
->
hùl
) {

254 ià(
´iv
->
©ch_æag
)

255 
	`¢d_mix”_d‘ach_hùl
(
	`¢d_mix”_şass_g‘_mix”
(
şass
), 
´iv
->
hùl
);

256 
	`¢d_hùl_şo£
(
´iv
->
hùl
);

257 } ià(
´iv
->
ùl
)

258 
	`¢d_ùl_şo£
(
´iv
->
ùl
);

259 
	`ä“
(
´iv
->
deviû
);

260 
	`ä“
(
´iv
);

261 
	}
}

270 
	$¢d_mix”_sim¶e_basic_»gi¡”
(
¢d_mix”_t
 *
mix”
,

271 
¢d_mix”_£Ëm_»gİt
 *
İtiÚs
,

272 
¢d_mix”_şass_t
 **
şas¥
)

274 
¢d_mix”_şass_t
 *
şass
;

275 
şass_´iv_t
 *
´iv
 = 
	`ÿÎoc
(1, (*priv));

276 cÚ¡ *
fe
;

277 
¢d_šput_t
 *
šput
;

278 
¢d_cÚfig_t
 *
tİ
 = 
NULL
;

279 
”r
;

281 ià(
´iv
 =ğ
NULL
)

282  -
ENOMEM
;

283 ià(
İtiÚs
->
deviû
 =ğ
NULL
) {

284 
	`ä“
(
´iv
);

285  -
EINVAL
;

287 ià(
	`¢d_mix”_şass_m®loc
(&
şass
)) {

288 
	`ä“
(
´iv
);

289  -
ENOMEM
;

291 
´iv
->
deviû
 = 
	`¡rdup
(
İtiÚs
->device);

292 ià(
´iv
->
deviû
 =ğ
NULL
) {

293 
	`ä“
(
´iv
);

294 
	`¢d_mix”_şass_ä“
(
şass
);

295  -
ENOMEM
;

297 
	`¢d_mix”_şass_£t_com·»
(
şass
, 
¢d_mix”_£Ëm_com·»
);

298 
	`¢d_mix”_şass_£t_´iv©e
(
şass
, 
´iv
);

299 
	`¢d_mix”_şass_£t_´iv©e_ä“
(
şass
, 
´iv©e_ä“
);

300 
fe
 = 
	`g‘’v
("ALSA_MIXER_SIMPLE");

301 ià(!
fe
) {

302 cÚ¡ *
tİdœ
 = 
	`¢d_cÚfig_tİdœ
();

303 *
s
 = 
	`®loÿ
(
	`¡¾’
(
tİdœ
) + strlen("smixer.conf") + 2);

304 
	`¥rštf
(
s
, "%s/smix”.cÚf", 
tİdœ
);

305 
fe
 = 
s
;

307 
”r
 = 
	`¢d_cÚfig_tİ
(&
tİ
);

308 ià(
”r
 >= 0) {

309 
”r
 = 
	`¢d_šput_¡dio_İ’
(&
šput
, 
fe
, "r");

310 ià(
”r
 < 0) {

311 
	`SNDERR
("uÇbËØİ’ sim¶mix” cÚfigu¿tiÚ f'%s'", 
fe
);

312 
__”rÜ
;

314 
”r
 = 
	`¢d_cÚfig_lßd
(
tİ
, 
šput
);

315 
	`¢d_šput_şo£
(
šput
);

316 ià(
”r
 < 0) {

317 
	`SNDERR
("% may bŞd o¸cÜru±ed: cÚsid”Ø»movÜ fix it", 
fe
);

318 
__”rÜ
;

320 
”r
 = 
	`fšd_fuÎ
(
şass
, 
mix”
, 
tİ
, 
´iv
->
deviû
);

321 ià(
”r
 >= 0)

322 
__fuÎ
;

324 ià(
”r
 >= 0) {

325 
”r
 = 
	`¢d_ùl_İ’
(&
´iv
->
ùl
,…riv->
deviû
, 0);

326 ià(
”r
 < 0) {

327 
	`SNDERR
("uÇbËØİ’ cÚŒŞ deviû '%s': %s", 
´iv
->
deviû
, 
	`¢d_¡»¼Ü
(
”r
));

328 
__”rÜ
;

330 
”r
 = 
	`¢d_hùl_İ’_ùl
(&
´iv
->
hùl
,…riv->
ùl
);

331 ià(
”r
 < 0)

332 
__”rÜ
;

333 
”r
 = 
	`¢d_ùl_ÿrd_šfo_m®loc
(&
´iv
->
šfo
);

334 ià(
”r
 < 0)

335 
__”rÜ
;

336 
”r
 = 
	`¢d_ùl_ÿrd_šfo
(
´iv
->
ùl
,…riv->
šfo
);

337 ià(
”r
 < 0)

338 
__”rÜ
;

340 ià(
”r
 >= 0)

341 
”r
 = 
	`fšd_moduË
(
şass
, 
tİ
);

342 ià(
”r
 >= 0)

343 
”r
 = 
	`¢d_mix”_©ch_hùl
(
mix”
, 
´iv
->
hùl
);

344 ià(
”r
 >= 0) {

345 
´iv
->
©ch_æag
 = 1;

346 
”r
 = 
	`¢d_mix”_şass_»gi¡”
(
şass
, 
mix”
);

348 
__fuÎ
:

349 ià(
”r
 < 0) {

350 
__”rÜ
:

351 ià(
tİ
)

352 
	`¢d_cÚfig_d–‘e
(
tİ
);

353 ià(
şass
)

354 
	`¢d_mix”_şass_ä“
(
şass
);

355  
”r
;

357 ià(
tİ
)

358 
	`¢d_cÚfig_d–‘e
(
tİ
);

359 ià(
şas¥
)

360 *
şas¥
 = 
şass
;

362 
	}
}

370 
	$¢d_mix”_sbasic_šfo
(cÚ¡ 
¢d_mix”_şass_t
 *
şass
, 
sm_şass_basic_t
 *
šfo
)

372 
şass_´iv_t
 *
´iv
 = 
	`¢d_mix”_şass_g‘_´iv©e
(
şass
);

374 ià(
şass
 =ğ
NULL
 || 
šfo
 == NULL)

375  -
EINVAL
;

376 
šfo
->
deviû
 = 
´iv
->device;

377 
šfo
->
ùl
 = 
´iv
->ctl;

378 
šfo
->
hùl
 = 
´iv
->hctl;

379 
šfo
->šfØğ
´iv
->info;

381 
	}
}

388 *
	$¢d_mix”_sbasic_g‘_´iv©e
(cÚ¡ 
¢d_mix”_şass_t
 *
şass
)

390 
şass_´iv_t
 *
´iv
 = 
	`¢d_mix”_şass_g‘_´iv©e
(
şass
);

392 ià(
şass
 =ğ
NULL
)

393  
NULL
;

394  
´iv
->
´iv©e_d©a
;

395 
	}
}

402 
	$¢d_mix”_sbasic_£t_´iv©e
(cÚ¡ 
¢d_mix”_şass_t
 *
şass
, *
´iv©e_d©a
)

404 
şass_´iv_t
 *
´iv
;

406 ià(
şass
 =ğ
NULL
)

408 
´iv
 = 
	`¢d_mix”_şass_g‘_´iv©e
(
şass
);

409 
´iv
->
´iv©e_d©a
 =…rivate_data;

410 
	}
}

417 
¢d_mix”_sbasic_£t_´iv©e_ä“
(cÚ¡ 
¢d_mix”_şass_t
 *
şass
, (*
´iv©e_ä“
)(snd_mixer_class_t *class))

419 
şass_´iv_t
 *
´iv
;

421 ià(
şass
 =ğ
NULL
)

423 
´iv
 = 
	`¢d_mix”_şass_g‘_´iv©e
(
şass
);

424 
´iv
->
´iv©e_ä“
 =…rivate_free;

425 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/simple_none.c

32 
	~"loÿl.h
"

33 
	~"mix”_sim¶e.h
"

34 
	~<¡dio.h
>

35 
	~<¡dlib.h
>

36 
	~<uni¡d.h
>

37 
	~<¡ršg.h
>

38 
	~<fú.h
>

39 
	~<sys/ioùl.h
>

40 
	~<as£¹.h
>

41 
	~<m©h.h
>

42 
	~<lim™s.h
>

44 #iâdeà
DOC_HIDDEN


46 
	#MIXER_COMPARE_WEIGHT_SIMPLE_BASE
 0

	)

47 
	#MIXER_COMPARE_WEIGHT_NEXT_BASE
 10000000

	)

48 
	#MIXER_COMPARE_WEIGHT_NOT_FOUND
 1000000000

	)

50 
	e_£Ëm_ùl_ty³
 {

51 
	mCTL_SINGLE
,

52 
	mCTL_GLOBAL_ENUM
,

53 
	mCTL_GLOBAL_SWITCH
,

54 
	mCTL_GLOBAL_VOLUME
,

55 
	mCTL_GLOBAL_ROUTE
,

56 
	mCTL_PLAYBACK_ENUM
,

57 
	mCTL_PLAYBACK_SWITCH
,

58 
	mCTL_PLAYBACK_VOLUME
,

59 
	mCTL_PLAYBACK_ROUTE
,

60 
	mCTL_CAPTURE_ENUM
,

61 
	mCTL_CAPTURE_SWITCH
,

62 
	mCTL_CAPTURE_VOLUME
,

63 
	mCTL_CAPTURE_ROUTE
,

64 
	mCTL_CAPTURE_SOURCE
,

65 
	mCTL_LAST
 = 
CTL_CAPTURE_SOURCE
,

66 } 
	t£Ëm_ùl_ty³_t
;

68 
	s_£Ëm_ùl
 {

69 
¢d_hùl_–em_t
 *
	m–em
;

70 
¢d_ùl_–em_ty³_t
 
	mty³
;

71 
	mšaùive
: 1;

72 
	mv®ues
;

73 
	mmš
, 
	mmax
;

74 } 
	t£Ëm_ùl_t
;

76 
	s_£Ëm_nÚe
 {

77 
sm_£Ëm_t
 
	m£Ëm
;

78 
£Ëm_ùl_t
 
	mùls
[
CTL_LAST
 + 1];

79 
	mÿ±u»_™em
;

80 
	s£Ëm_¡r
 {

81 
	m¿nge
: 1;

82 
	mdb_š™Ÿlized
: 1;

83 
	mdb_š™_”rÜ
: 1;

84 
	mmš
, 
	mmax
;

85 
	mchªÃls
;

86 
	mvŞ
[32];

87 
	msw
;

88 *
	mdb_šfo
;

89 } 
	m¡r
[2];

90 } 
	t£Ëm_nÚe_t
;

92 cÚ¡ 
	smix”_Çme_bË
 {

93 cÚ¡ *
	mlÚgÇme
;

94 cÚ¡ *
	mshÜŠame
;

95 } 
	gÇme_bË
[] = {

107 cÚ¡ *
	$g‘_shÜt_Çme
(cÚ¡ *
Êame
)

109 cÚ¡ 
mix”_Çme_bË
 *
p
;

110 
p
 = 
Çme_bË
;…->
lÚgÇme
;…++) {

111 ià(!
	`¡rcmp
(
Êame
, 
p
->
lÚgÇme
))

112  
p
->
shÜŠame
;

114  
Êame
;

115 
	}
}

117 
	$com·»_mix”_´iÜ™y_lookup
(cÚ¡ **
Çme
, cÚ¡ * cÚ¡ *
Çmes
, 
cÛf
)

119 
»s
;

121 
»s
 = 0; *
Çmes
;‚ames++,„e +ğ
cÛf
) {

122 ià(!
	`¡ºcmp
(*
Çme
, *
Çmes
, 
	`¡¾’
(*names))) {

123 *
Çme
 +ğ
	`¡¾’
(*
Çmes
);

124 ià(**
Çme
 == ' ')

125 (*
Çme
)++;

126  
»s
+1;

129  
MIXER_COMPARE_WEIGHT_NOT_FOUND
;

130 
	}
}

132 
	$g‘_com·»_weight
(cÚ¡ *
Çme
, 
idx
)

134 cÚ¡ *cÚ¡ 
Çmes
[] = {

168 
NULL


170 cÚ¡ *cÚ¡ 
Çmes1
[] = {

172 
NULL
,

174 cÚ¡ *cÚ¡ 
Çmes2
[] = {

188 
NULL
,

190 cÚ¡ *
Çme1
;

191 
»s
, 
»s1
;

193 ià((
»s
 = 
	`com·»_mix”_´iÜ™y_lookup
((cÚ¡ **)&
Çme
, 
Çmes
, 1000)è=ğ
MIXER_COMPARE_WEIGHT_NOT_FOUND
)

194  
MIXER_COMPARE_WEIGHT_NOT_FOUND
;

195 ià(*
Çme
 == '\0')

196 
__»s
;

197 
Çme1
 = 
Çme
; *name1 != '\0';‚ame1++);

198 
Çme1
--;‚ame1 !ğ
Çme
 && *name1 != ' ';‚ame1--);

199 
Çme1
 !ğ
Çme
 && *name1 == ' ')

200 
Çme1
--;

201 ià(
Çme1
 !ğ
Çme
) {

202 ; 
Çme1
 !ğ
Çme
 && *name1 != ' ';‚ame1--);

203 
Çme
 = 
Çme1
;

204 ià((
»s1
 = 
	`com·»_mix”_´iÜ™y_lookup
((cÚ¡ **)&
Çme
, 
Çmes1
, 200)è=ğ
MIXER_COMPARE_WEIGHT_NOT_FOUND
)

205  
»s
;

206 
»s
 +ğ
»s1
;

208 
Çme
 = 
Çme1
;

210 ià((
»s1
 = 
	`com·»_mix”_´iÜ™y_lookup
((cÚ¡ **)&
Çme
, 
Çmes2
, 20)è=ğ
MIXER_COMPARE_WEIGHT_NOT_FOUND
)

211  
»s
;

212 
__»s
:

213  
MIXER_COMPARE_WEIGHT_SIMPLE_BASE
 + 
»s
 + 
idx
;

214 
	}
}

216 
	$to_u£r
(
£Ëm_nÚe_t
 *
s
, 
dœ
, 
£Ëm_ùl_t
 *
c
, 
v®ue
)

218 
št64_t
 
n
;

219 ià(
c
->
max
 =ğc->
mš
)

220  
s
->
¡r
[
dœ
].
mš
;

221 
n
 = (
št64_t
è(
v®ue
 - 
c
->
mš
è* (
s
->
¡r
[
dœ
].
max
 - s->str[dir].min);

222  
s
->
¡r
[
dœ
].
mš
 + (
n
 + (
c
->
max
 - c->min) / 2) / (c->max - c->min);

223 
	}
}

225 
	$äom_u£r
(
£Ëm_nÚe_t
 *
s
, 
dœ
, 
£Ëm_ùl_t
 *
c
, 
v®ue
)

227 
št64_t
 
n
;

228 ià(
s
->
¡r
[
dœ
].
max
 =ğs->¡r[dœ].
mš
)

229  
c
->
mš
;

230 
n
 = (
št64_t
è(
v®ue
 - 
s
->
¡r
[
dœ
].
mš
è* (
c
->
max
 - c->min);

231  
c
->
mš
 + (
n
 + (
s
->
¡r
[
dœ
].
max
 - s->str[dir].min) / 2) / (s->str[dir].max - s->str[dir].min);

232 
	}
}

234 
	$–em_»ad_vŞume
(
£Ëm_nÚe_t
 *
s
, 
dœ
, 
£Ëm_ùl_ty³_t
 
ty³
)

236 
¢d_ùl_–em_v®ue_t
 
ùl
 = {0};

237 
idx
;

238 
”r
;

239 
£Ëm_ùl_t
 *
c
 = &
s
->
ùls
[
ty³
];

240 ià((
”r
 = 
	`¢d_hùl_–em_»ad
(
c
->
–em
, &
ùl
)) < 0)

241  
”r
;

242 
idx
 = 0; idx < 
s
->
¡r
[
dœ
].
chªÃls
; idx++) {

243 
idx1
 = 
idx
;

244 ià(
idx
 >ğ
c
->
v®ues
)

245 
idx1
 = 0;

246 
s
->
¡r
[
dœ
].
vŞ
[
idx
] =

247 
	`to_u£r
(
s
, 
dœ
, 
c
,

248 
	`¢d_ùl_–em_v®ue_g‘_š‹g”
(&
ùl
, 
idx1
));

251 
	}
}

253 
	$–em_»ad_sw™ch
(
£Ëm_nÚe_t
 *
s
, 
dœ
, 
£Ëm_ùl_ty³_t
 
ty³
)

255 
¢d_ùl_–em_v®ue_t
 
ùl
 = {0};

256 
idx
;

257 
”r
;

258 
£Ëm_ùl_t
 *
c
 = &
s
->
ùls
[
ty³
];

259 ià((
”r
 = 
	`¢d_hùl_–em_»ad
(
c
->
–em
, &
ùl
)) < 0)

260  
”r
;

261 
idx
 = 0; idx < 
s
->
¡r
[
dœ
].
chªÃls
; idx++) {

262 
idx1
 = 
idx
;

263 ià(
idx
 >ğ
c
->
v®ues
)

264 
idx1
 = 0;

265 ià(!
	`¢d_ùl_–em_v®ue_g‘_š‹g”
(&
ùl
, 
idx1
))

266 
s
->
¡r
[
dœ
].
sw
 &ğ~(1 << 
idx
);

269 
	}
}

271 
	$–em_»ad_rou‹
(
£Ëm_nÚe_t
 *
s
, 
dœ
, 
£Ëm_ùl_ty³_t
 
ty³
)

273 
¢d_ùl_–em_v®ue_t
 
ùl
 = {0};

274 
idx
;

275 
”r
;

276 
£Ëm_ùl_t
 *
c
 = &
s
->
ùls
[
ty³
];

277 ià((
”r
 = 
	`¢d_hùl_–em_»ad
(
c
->
–em
, &
ùl
)) < 0)

278  
”r
;

279 
idx
 = 0; idx < 
s
->
¡r
[
dœ
].
chªÃls
; idx++) {

280 
idx1
 = 
idx
;

281 ià(
idx
 >ğ
c
->
v®ues
)

282 
idx1
 = 0;

283 ià(!
	`¢d_ùl_–em_v®ue_g‘_š‹g”
(&
ùl
,

284 
idx1
 * 
c
->
v®ues
 + idx1))

285 
s
->
¡r
[
dœ
].
sw
 &ğ~(1 << 
idx
);

288 
	}
}

290 
	$–em_»ad_’um
(
£Ëm_nÚe_t
 *
s
)

292 
¢d_ùl_–em_v®ue_t
 
ùl
 = {0};

293 
idx
;

294 
”r
;

295 
ty³
;

296 
£Ëm_ùl_t
 *
c
;

297 
ty³
 = 
CTL_GLOBAL_ENUM
;

298 ià((
s
->
£Ëm
.
ÿps
 & (
SM_CAP_CENUM
 | 
SM_CAP_PENUM
)) ==

299 (
SM_CAP_CENUM
 | 
SM_CAP_PENUM
))

300 
ty³
 = 
CTL_GLOBAL_ENUM
;

301 ià(
s
->
£Ëm
.
ÿps
 & 
SM_CAP_PENUM
)

302 
ty³
 = 
CTL_PLAYBACK_ENUM
;

303 ià(
s
->
£Ëm
.
ÿps
 & 
SM_CAP_CENUM
)

304 
ty³
 = 
CTL_CAPTURE_ENUM
;

305 
c
 = &
s
->
ùls
[
ty³
];

306 ià((
”r
 = 
	`¢d_hùl_–em_»ad
(
c
->
–em
, &
ùl
)) < 0)

307  
”r
;

308 
idx
 = 0; idx < 
s
->
¡r
[0].
chªÃls
; idx++) {

309 
idx1
 = 
idx
;

310 ià(
idx
 >ğ
c
->
v®ues
)

311 
idx1
 = 0;

312 
s
->
¡r
[0].
vŞ
[
idx
] =

313 
	`¢d_ùl_–em_v®ue_g‘_’um”©ed
(&
ùl
, 
idx1
);

316 
	}
}

318 
	$£Ëm_»ad
(
¢d_mix”_–em_t
 *
–em
)

320 
£Ëm_nÚe_t
 *
s
;

321 
idx
;

322 
”r
 = 0;

323 
pvŞ
[32], 
cvŞ
[32];

324 
psw
, 
csw
;

326 
	`as£¹
(
	`¢d_mix”_–em_g‘_ty³
(
–em
è=ğ
SND_MIXER_ELEM_SIMPLE
);

327 
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

329 
	`memıy
(
pvŞ
, 
s
->
¡r
[
SM_PLAY
].
vŞ
, (pvol));

330 
	`mem£t
(&
s
->
¡r
[
SM_PLAY
].
vŞ
, 0, (s->str[SM_PLAY].vol));

331 
psw
 = 
s
->
¡r
[
SM_PLAY
].
sw
;

332 
s
->
¡r
[
SM_PLAY
].
sw
 = ~0U;

333 
	`memıy
(
cvŞ
, 
s
->
¡r
[
SM_CAPT
].
vŞ
, (cvol));

334 
	`mem£t
(&
s
->
¡r
[
SM_CAPT
].
vŞ
, 0, (s->str[SM_CAPT].vol));

335 
csw
 = 
s
->
¡r
[
SM_CAPT
].
sw
;

336 
s
->
¡r
[
SM_CAPT
].
sw
 = ~0U;

338 ià(
s
->
ùls
[
CTL_GLOBAL_ENUM
].
–em
) {

339 
”r
 = 
	`–em_»ad_’um
(
s
);

340 ià(
”r
 < 0)

341  
”r
;

342 
__sk_csw™ch
;

345 ià(
s
->
ùls
[
CTL_CAPTURE_ENUM
].
–em
) {

346 
”r
 = 
	`–em_»ad_’um
(
s
);

347 ià(
”r
 < 0)

348  
”r
;

349 
__sk_csw™ch
;

352 ià(
s
->
ùls
[
CTL_PLAYBACK_ENUM
].
–em
) {

353 
”r
 = 
	`–em_»ad_’um
(
s
);

354 ià(
”r
 < 0)

355  
”r
;

356 
__sk_csw™ch
;

360 ià(
s
->
ùls
[
CTL_PLAYBACK_VOLUME
].
–em
)

361 
”r
 = 
	`–em_»ad_vŞume
(
s
, 
SM_PLAY
, 
CTL_PLAYBACK_VOLUME
);

362 ià(
s
->
ùls
[
CTL_GLOBAL_VOLUME
].
–em
)

363 
”r
 = 
	`–em_»ad_vŞume
(
s
, 
SM_PLAY
, 
CTL_GLOBAL_VOLUME
);

364 ià(
s
->
ùls
[
CTL_SINGLE
].
–em
 &&

365 
s
->
ùls
[
CTL_SINGLE
].
ty³
 =ğ
SND_CTL_ELEM_TYPE_INTEGER
)

366 
”r
 = 
	`–em_»ad_vŞume
(
s
, 
SM_PLAY
, 
CTL_SINGLE
);

367 ià(
”r
 < 0)

368  
”r
;

370 ià((
s
->
£Ëm
.
ÿps
 & (
SM_CAP_GSWITCH
|
SM_CAP_PSWITCH
)) == 0) {

371 
s
->
¡r
[
SM_PLAY
].
sw
 = 0;

372 
__sk_psw™ch
;

374 ià(
s
->
ùls
[
CTL_PLAYBACK_SWITCH
].
–em
) {

375 
”r
 = 
	`–em_»ad_sw™ch
(
s
, 
SM_PLAY
, 
CTL_PLAYBACK_SWITCH
);

376 ià(
”r
 < 0)

377  
”r
;

379 ià(
s
->
ùls
[
CTL_GLOBAL_SWITCH
].
–em
) {

380 
”r
 = 
	`–em_»ad_sw™ch
(
s
, 
SM_PLAY
, 
CTL_GLOBAL_SWITCH
);

381 ià(
”r
 < 0)

382  
”r
;

384 ià(
s
->
ùls
[
CTL_SINGLE
].
–em
 &&

385 
s
->
ùls
[
CTL_SINGLE
].
ty³
 =ğ
SND_CTL_ELEM_TYPE_BOOLEAN
) {

386 
”r
 = 
	`–em_»ad_sw™ch
(
s
, 
SM_PLAY
, 
CTL_SINGLE
);

387 ià(
”r
 < 0)

388  
”r
;

390 ià(
s
->
ùls
[
CTL_PLAYBACK_ROUTE
].
–em
) {

391 
”r
 = 
	`–em_»ad_rou‹
(
s
, 
SM_PLAY
, 
CTL_PLAYBACK_ROUTE
);

392 ià(
”r
 < 0)

393  
”r
;

395 ià(
s
->
ùls
[
CTL_GLOBAL_ROUTE
].
–em
) {

396 
”r
 = 
	`–em_»ad_rou‹
(
s
, 
SM_PLAY
, 
CTL_GLOBAL_ROUTE
);

397 ià(
”r
 < 0)

398  
”r
;

400 
__sk_psw™ch
:

402 ià(
s
->
ùls
[
CTL_CAPTURE_VOLUME
].
–em
)

403 
”r
 = 
	`–em_»ad_vŞume
(
s
, 
SM_CAPT
, 
CTL_CAPTURE_VOLUME
);

404 ià(
s
->
ùls
[
CTL_GLOBAL_VOLUME
].
–em
)

405 
”r
 = 
	`–em_»ad_vŞume
(
s
, 
SM_CAPT
, 
CTL_GLOBAL_VOLUME
);

406 ià(
s
->
ùls
[
CTL_SINGLE
].
–em
 &&

407 
s
->
ùls
[
CTL_SINGLE
].
ty³
 =ğ
SND_CTL_ELEM_TYPE_INTEGER
)

408 
”r
 = 
	`–em_»ad_vŞume
(
s
, 
SM_CAPT
, 
CTL_SINGLE
);

409 ià(
”r
 < 0)

410  
”r
;

412 ià((
s
->
£Ëm
.
ÿps
 & (
SM_CAP_GSWITCH
|
SM_CAP_CSWITCH
)) == 0) {

413 
s
->
¡r
[
SM_CAPT
].
sw
 = 0;

414 
__sk_csw™ch
;

416 ià(
s
->
ùls
[
CTL_CAPTURE_SWITCH
].
–em
) {

417 
”r
 = 
	`–em_»ad_sw™ch
(
s
, 
SM_CAPT
, 
CTL_CAPTURE_SWITCH
);

418 ià(
”r
 < 0)

419  
”r
;

421 ià(
s
->
ùls
[
CTL_GLOBAL_SWITCH
].
–em
) {

422 
”r
 = 
	`–em_»ad_sw™ch
(
s
, 
SM_CAPT
, 
CTL_GLOBAL_SWITCH
);

423 ià(
”r
 < 0)

424  
”r
;

426 ià(
s
->
ùls
[
CTL_SINGLE
].
–em
 &&

427 
s
->
ùls
[
CTL_SINGLE
].
ty³
 =ğ
SND_CTL_ELEM_TYPE_BOOLEAN
) {

428 
”r
 = 
	`–em_»ad_sw™ch
(
s
, 
SM_CAPT
, 
CTL_SINGLE
);

429 ià(
”r
 < 0)

430  
”r
;

432 ià(
s
->
ùls
[
CTL_CAPTURE_ROUTE
].
–em
) {

433 
”r
 = 
	`–em_»ad_rou‹
(
s
, 
SM_CAPT
, 
CTL_CAPTURE_ROUTE
);

434 ià(
”r
 < 0)

435  
”r
;

437 ià(
s
->
ùls
[
CTL_GLOBAL_ROUTE
].
–em
) {

438 
”r
 = 
	`–em_»ad_rou‹
(
s
, 
SM_CAPT
, 
CTL_GLOBAL_ROUTE
);

439 ià(
”r
 < 0)

440  
”r
;

442 ià(
s
->
ùls
[
CTL_CAPTURE_SOURCE
].
–em
) {

443 
¢d_ùl_–em_v®ue_t
 
ùl
 = {0};

444 
£Ëm_ùl_t
 *
c
 = &
s
->
ùls
[
CTL_CAPTURE_SOURCE
];

445 
”r
 = 
	`¢d_hùl_–em_»ad
(
c
->
–em
, &
ùl
);

446 ià(
”r
 < 0)

447  
”r
;

448 
idx
 = 0; idx < 
s
->
¡r
[
SM_CAPT
].
chªÃls
; idx++) {

449 
idx1
 = 
idx
;

450 ià(
idx
 >ğ
c
->
v®ues
)

451 
idx1
 = 0;

452 ià(
	`¢d_ùl_–em_v®ue_g‘_’um”©ed
(&
ùl
, 
idx1
) !=

453 
s
->
ÿ±u»_™em
)

454 
s
->
¡r
[
SM_CAPT
].
sw
 &ğ~(1 << 
idx
);

457 
__sk_csw™ch
:

459 ià(
	`memcmp
(
pvŞ
, 
s
->
¡r
[
SM_PLAY
].
vŞ
, (pvol)) ||

460 
psw
 !ğ
s
->
¡r
[
SM_PLAY
].
sw
 ||

461 
	`memcmp
(
cvŞ
, 
s
->
¡r
[
SM_CAPT
].
vŞ
, (cvol)) ||

462 
csw
 !ğ
s
->
¡r
[
SM_CAPT
].
sw
)

465 
	}
}

467 
	$–em_wr™e_vŞume
(
£Ëm_nÚe_t
 *
s
, 
dœ
, 
£Ëm_ùl_ty³_t
 
ty³
)

469 
¢d_ùl_–em_v®ue_t
 
ùl
 = {0};

470 
idx
;

471 
”r
;

472 
£Ëm_ùl_t
 *
c
 = &
s
->
ùls
[
ty³
];

473 ià((
”r
 = 
	`¢d_hùl_–em_»ad
(
c
->
–em
, &
ùl
)) < 0)

474  
”r
;

475 
idx
 = 0; idx < 
c
->
v®ues
; idx++)

476 
	`¢d_ùl_–em_v®ue_£t_š‹g”
(&
ùl
, 
idx
,

477 
	`äom_u£r
(
s
, 
dœ
, 
c
, s->
¡r
[dœ].
vŞ
[
idx
]));

478 ià((
”r
 = 
	`¢d_hùl_–em_wr™e
(
c
->
–em
, &
ùl
)) < 0)

479  
”r
;

481 
	}
}

483 
	$–em_wr™e_sw™ch
(
£Ëm_nÚe_t
 *
s
, 
dœ
, 
£Ëm_ùl_ty³_t
 
ty³
)

485 
¢d_ùl_–em_v®ue_t
 
ùl
 = {0};

486 
idx
;

487 
”r
;

488 
£Ëm_ùl_t
 *
c
 = &
s
->
ùls
[
ty³
];

489 ià((
”r
 = 
	`¢d_hùl_–em_»ad
(
c
->
–em
, &
ùl
)) < 0)

490  
”r
;

491 
idx
 = 0; idx < 
c
->
v®ues
; idx++)

492 
	`¢d_ùl_–em_v®ue_£t_š‹g”
(&
ùl
, 
idx
,

493 !!(
s
->
¡r
[
dœ
].
sw
 & (1 << 
idx
)));

494 ià((
”r
 = 
	`¢d_hùl_–em_wr™e
(
c
->
–em
, &
ùl
)) < 0)

495  
”r
;

497 
	}
}

499 
	$–em_wr™e_sw™ch_cÚ¡ªt
(
£Ëm_nÚe_t
 *
s
, 
£Ëm_ùl_ty³_t
 
ty³
, 
v®
)

501 
¢d_ùl_–em_v®ue_t
 
ùl
 = {0};

502 
idx
;

503 
”r
;

504 
£Ëm_ùl_t
 *
c
 = &
s
->
ùls
[
ty³
];

505 ià((
”r
 = 
	`¢d_hùl_–em_»ad
(
c
->
–em
, &
ùl
)) < 0)

506  
”r
;

507 
idx
 = 0; idx < 
c
->
v®ues
; idx++)

508 
	`¢d_ùl_–em_v®ue_£t_š‹g”
(&
ùl
, 
idx
, !!
v®
);

509 ià((
”r
 = 
	`¢d_hùl_–em_wr™e
(
c
->
–em
, &
ùl
)) < 0)

510  
”r
;

512 
	}
}

514 
	$–em_wr™e_rou‹
(
£Ëm_nÚe_t
 *
s
, 
dœ
, 
£Ëm_ùl_ty³_t
 
ty³
)

516 
¢d_ùl_–em_v®ue_t
 
ùl
 = {0};

517 
idx
;

518 
”r
;

519 
£Ëm_ùl_t
 *
c
 = &
s
->
ùls
[
ty³
];

520 ià((
”r
 = 
	`¢d_hùl_–em_»ad
(
c
->
–em
, &
ùl
)) < 0)

521  
”r
;

522 
idx
 = 0; idx < 
c
->
v®ues
 * c->values; idx++)

523 
	`¢d_ùl_–em_v®ue_£t_š‹g”
(&
ùl
, 
idx
, 0);

524 
idx
 = 0; idx < 
c
->
v®ues
; idx++)

525 
	`¢d_ùl_–em_v®ue_£t_š‹g”
(&
ùl
, 
idx
 * 
c
->
v®ues
 + idx,

526 !!(
s
->
¡r
[
dœ
].
sw
 & (1 << 
idx
)));

527 ià((
”r
 = 
	`¢d_hùl_–em_wr™e
(
c
->
–em
, &
ùl
)) < 0)

528  
”r
;

530 
	}
}

532 
	$–em_wr™e_’um
(
£Ëm_nÚe_t
 *
s
)

534 
¢d_ùl_–em_v®ue_t
 
ùl
 = {0};

535 
idx
;

536 
”r
;

537 
ty³
;

538 
£Ëm_ùl_t
 *
c
;

539 
ty³
 = 
CTL_GLOBAL_ENUM
;

540 ià((
s
->
£Ëm
.
ÿps
 & (
SM_CAP_CENUM
 | 
SM_CAP_PENUM
)) ==

541 (
SM_CAP_CENUM
 | 
SM_CAP_PENUM
))

542 
ty³
 = 
CTL_GLOBAL_ENUM
;

543 ià(
s
->
£Ëm
.
ÿps
 & 
SM_CAP_PENUM
)

544 
ty³
 = 
CTL_PLAYBACK_ENUM
;

545 ià(
s
->
£Ëm
.
ÿps
 & 
SM_CAP_CENUM
)

546 
ty³
 = 
CTL_CAPTURE_ENUM
;

547 
c
 = &
s
->
ùls
[
ty³
];

548 ià((
”r
 = 
	`¢d_hùl_–em_»ad
(
c
->
–em
, &
ùl
)) < 0)

549  
”r
;

550 
idx
 = 0; idx < 
c
->
v®ues
; idx++)

551 
	`¢d_ùl_–em_v®ue_£t_’um”©ed
(&
ùl
, 
idx
,

552 ()
s
->
¡r
[0].
vŞ
[
idx
]);

553 ià((
”r
 = 
	`¢d_hùl_–em_wr™e
(
c
->
–em
, &
ùl
)) < 0)

554  
”r
;

556 
	}
}

558 
	$£Ëm_wr™e_maš
(
¢d_mix”_–em_t
 *
–em
)

560 
£Ëm_nÚe_t
 *
s
;

561 
idx
;

562 
”r
;

564 
	`as£¹
(
	`¢d_mix”_–em_g‘_ty³
(
–em
è=ğ
SND_MIXER_ELEM_SIMPLE
);

565 
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

567 ià(
s
->
ùls
[
CTL_GLOBAL_ENUM
].
–em
)

568  
	`–em_wr™e_’um
(
s
);

570 ià(
s
->
ùls
[
CTL_PLAYBACK_ENUM
].
–em
)

571  
	`–em_wr™e_’um
(
s
);

573 ià(
s
->
ùls
[
CTL_CAPTURE_ENUM
].
–em
)

574  
	`–em_wr™e_’um
(
s
);

576 ià(
s
->
ùls
[
CTL_SINGLE
].
–em
) {

577 ià(
s
->
ùls
[
CTL_SINGLE
].
ty³
 =ğ
SND_CTL_ELEM_TYPE_INTEGER
)

578 
”r
 = 
	`–em_wr™e_vŞume
(
s
, 
SM_PLAY
, 
CTL_SINGLE
);

580 
”r
 = 
	`–em_wr™e_sw™ch
(
s
, 
SM_PLAY
, 
CTL_SINGLE
);

581 ià(
”r
 < 0)

582  
”r
;

584 ià(
s
->
ùls
[
CTL_GLOBAL_VOLUME
].
–em
) {

585 
”r
 = 
	`–em_wr™e_vŞume
(
s
, 
SM_PLAY
, 
CTL_GLOBAL_VOLUME
);

586 ià(
”r
 < 0)

587  
”r
;

589 ià(
s
->
ùls
[
CTL_GLOBAL_SWITCH
].
–em
) {

590 ià(
s
->
ùls
[
CTL_PLAYBACK_SWITCH
].
–em
 &&

591 
s
->
ùls
[
CTL_CAPTURE_SWITCH
].
–em
)

592 
”r
 = 
	`–em_wr™e_sw™ch_cÚ¡ªt
(
s
, 
CTL_GLOBAL_SWITCH
,

595 
”r
 = 
	`–em_wr™e_sw™ch
(
s
, 
SM_PLAY
, 
CTL_GLOBAL_SWITCH
);

596 ià(
”r
 < 0)

597  
”r
;

599 ià(
s
->
ùls
[
CTL_PLAYBACK_VOLUME
].
–em
) {

600 
”r
 = 
	`–em_wr™e_vŞume
(
s
, 
SM_PLAY
, 
CTL_PLAYBACK_VOLUME
);

601 ià(
”r
 < 0)

602  
”r
;

604 ià(
s
->
ùls
[
CTL_PLAYBACK_SWITCH
].
–em
) {

605 
”r
 = 
	`–em_wr™e_sw™ch
(
s
, 
SM_PLAY
, 
CTL_PLAYBACK_SWITCH
);

606 ià(
”r
 < 0)

607  
”r
;

609 ià(
s
->
ùls
[
CTL_PLAYBACK_ROUTE
].
–em
) {

610 
”r
 = 
	`–em_wr™e_rou‹
(
s
, 
SM_PLAY
, 
CTL_PLAYBACK_ROUTE
);

611 ià(
”r
 < 0)

612  
”r
;

614 ià(
s
->
ùls
[
CTL_CAPTURE_VOLUME
].
–em
) {

615 
”r
 = 
	`–em_wr™e_vŞume
(
s
, 
SM_CAPT
, 
CTL_CAPTURE_VOLUME
);

616 ià(
”r
 < 0)

617  
”r
;

619 ià(
s
->
ùls
[
CTL_CAPTURE_SWITCH
].
–em
) {

620 
”r
 = 
	`–em_wr™e_sw™ch
(
s
, 
SM_CAPT
, 
CTL_CAPTURE_SWITCH
);

621 ià(
”r
 < 0)

622  
”r
;

624 ià(
s
->
ùls
[
CTL_CAPTURE_ROUTE
].
–em
) {

625 
”r
 = 
	`–em_wr™e_rou‹
(
s
, 
SM_CAPT
, 
CTL_CAPTURE_ROUTE
);

626 ià(
”r
 < 0)

627  
”r
;

629 ià(
s
->
ùls
[
CTL_CAPTURE_SOURCE
].
–em
) {

630 
¢d_ùl_–em_v®ue_t
 
ùl
 = {0};

631 
£Ëm_ùl_t
 *
c
 = &
s
->
ùls
[
CTL_CAPTURE_SOURCE
];

632 ià((
”r
 = 
	`¢d_hùl_–em_»ad
(
c
->
–em
, &
ùl
)) < 0)

633  
”r
;

634 
idx
 = 0; idx < 
c
->
v®ues
; idx++) {

635 ià(
s
->
¡r
[
SM_CAPT
].
sw
 & (1 << 
idx
))

636 
	`¢d_ùl_–em_v®ue_£t_’um”©ed
(&
ùl
,

637 
idx
, 
s
->
ÿ±u»_™em
);

639 ià((
”r
 = 
	`¢d_hùl_–em_wr™e
(
c
->
–em
, &
ùl
)) < 0)

640  
”r
;

642 
”r
 = 
	`£Ëm_»ad
(
–em
);

643 ià(
”r
 < 0)

644  
”r
;

647 
	}
}

649 
	$£Ëm_wr™e
(
¢d_mix”_–em_t
 *
–em
)

651 
”r
;

653 
”r
 = 
	`£Ëm_wr™e_maš
(
–em
);

654 ià(
”r
 < 0)

655 
	`£Ëm_»ad
(
–em
);

656  
”r
;

657 
	}
}

659 
	$£Ëm_ä“
(
¢d_mix”_–em_t
 *
–em
)

661 
£Ëm_nÚe_t
 *
sim¶e
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

662 
	`as£¹
(
	`¢d_mix”_–em_g‘_ty³
(
–em
è=ğ
SND_MIXER_ELEM_SIMPLE
);

663 ià(
sim¶e
->
£Ëm
.
id
)

664 
	`¢d_mix”_£Ëm_id_ä“
(
sim¶e
->
£Ëm
.
id
);

666 
	`ä“
(
sim¶e
->
¡r
[0].
db_šfo
);

667 
	`ä“
(
sim¶e
->
¡r
[1].
db_šfo
);

668 
	`ä“
(
sim¶e
);

669 
	}
}

671 
	$sim¶e_upd©e
(
¢d_mix”_–em_t
 *
m–em
)

673 
£Ëm_nÚe_t
 *
sim¶e
;

674 
ÿps
, 
pchªÃls
, 
cchªÃls
;

675 
pmš
, 
pmax
, 
cmš
, 
cmax
;

676 
£Ëm_ùl_t
 *
ùl
;

678 
ÿps
 = 0;

679 
pchªÃls
 = 0;

680 
pmš
 = 
LONG_MAX
;

681 
pmax
 = 
LONG_MIN
;

682 
cchªÃls
 = 0;

683 
cmš
 = 
LONG_MAX
;

684 
cmax
 = 
LONG_MIN
;

685 
	`as£¹
(
	`¢d_mix”_–em_g‘_ty³
(
m–em
è=ğ
SND_MIXER_ELEM_SIMPLE
);

686 
sim¶e
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
m–em
);

687 
ùl
 = &
sim¶e
->
ùls
[
CTL_SINGLE
];

688 ià(
ùl
->
–em
) {

689 
pchªÃls
 = 
cchªÃls
 = 
ùl
->
v®ues
;

690 ià(
ùl
->
ty³
 =ğ
SND_CTL_ELEM_TYPE_INTEGER
) {

691 
ÿps
 |ğ
SM_CAP_GVOLUME
;

692 
pmš
 = 
cmš
 = 
ùl
->
mš
;

693 
pmax
 = 
cmax
 = 
ùl
->
max
;

695 
ÿps
 |ğ
SM_CAP_GSWITCH
;

697 
ùl
 = &
sim¶e
->
ùls
[
CTL_GLOBAL_SWITCH
];

698 ià(
ùl
->
–em
) {

699 ià(
pchªÃls
 < 
ùl
->
v®ues
)

700 
pchªÃls
 = 
ùl
->
v®ues
;

701 ià(
cchªÃls
 < 
ùl
->
v®ues
)

702 
cchªÃls
 = 
ùl
->
v®ues
;

703 
ÿps
 |ğ
SM_CAP_GSWITCH
;

705 
ùl
 = &
sim¶e
->
ùls
[
CTL_GLOBAL_ROUTE
];

706 ià(
ùl
->
–em
) {

707 ià(
pchªÃls
 < 
ùl
->
v®ues
)

708 
pchªÃls
 = 
ùl
->
v®ues
;

709 ià(
cchªÃls
 < 
ùl
->
v®ues
)

710 
cchªÃls
 = 
ùl
->
v®ues
;

711 
ÿps
 |ğ
SM_CAP_GSWITCH
;

713 
ùl
 = &
sim¶e
->
ùls
[
CTL_GLOBAL_VOLUME
];

714 ià(
ùl
->
–em
) {

715 ià(
pchªÃls
 < 
ùl
->
v®ues
)

716 
pchªÃls
 = 
ùl
->
v®ues
;

717 ià(
pmš
 > 
ùl
->
mš
)

718 
pmš
 = 
ùl
->
mš
;

719 ià(
pmax
 < 
ùl
->
max
)

720 
pmax
 = 
ùl
->
max
;

721 ià(
cchªÃls
 < 
ùl
->
v®ues
)

722 
cchªÃls
 = 
ùl
->
v®ues
;

723 ià(
cmš
 > 
ùl
->
mš
)

724 
cmš
 = 
ùl
->
mš
;

725 ià(
cmax
 < 
ùl
->
max
)

726 
cmax
 = 
ùl
->
max
;

727 
ÿps
 |ğ
SM_CAP_GVOLUME
;

729 
ùl
 = &
sim¶e
->
ùls
[
CTL_PLAYBACK_SWITCH
];

730 ià(
ùl
->
–em
) {

731 ià(
pchªÃls
 < 
ùl
->
v®ues
)

732 
pchªÃls
 = 
ùl
->
v®ues
;

733 
ÿps
 |ğ
SM_CAP_PSWITCH
;

734 
ÿps
 &ğ~
SM_CAP_GSWITCH
;

736 
ùl
 = &
sim¶e
->
ùls
[
CTL_PLAYBACK_ROUTE
];

737 ià(
ùl
->
–em
) {

738 ià(
pchªÃls
 < 
ùl
->
v®ues
)

739 
pchªÃls
 = 
ùl
->
v®ues
;

740 
ÿps
 |ğ
SM_CAP_PSWITCH
;

741 
ÿps
 &ğ~
SM_CAP_GSWITCH
;

743 
ùl
 = &
sim¶e
->
ùls
[
CTL_CAPTURE_SWITCH
];

744 ià(
ùl
->
–em
) {

745 ià(
cchªÃls
 < 
ùl
->
v®ues
)

746 
cchªÃls
 = 
ùl
->
v®ues
;

747 
ÿps
 |ğ
SM_CAP_CSWITCH
;

748 
ÿps
 &ğ~
SM_CAP_GSWITCH
;

750 
ùl
 = &
sim¶e
->
ùls
[
CTL_CAPTURE_ROUTE
];

751 ià(
ùl
->
–em
) {

752 ià(
cchªÃls
 < 
ùl
->
v®ues
)

753 
cchªÃls
 = 
ùl
->
v®ues
;

754 
ÿps
 |ğ
SM_CAP_CSWITCH
;

755 
ÿps
 &ğ~
SM_CAP_GSWITCH
;

757 
ùl
 = &
sim¶e
->
ùls
[
CTL_PLAYBACK_VOLUME
];

758 ià(
ùl
->
–em
) {

759 ià(
pchªÃls
 < 
ùl
->
v®ues
)

760 
pchªÃls
 = 
ùl
->
v®ues
;

761 ià(
pmš
 > 
ùl
->
mš
)

762 
pmš
 = 
ùl
->
mš
;

763 ià(
pmax
 < 
ùl
->
max
)

764 
pmax
 = 
ùl
->
max
;

765 
ÿps
 |ğ
SM_CAP_PVOLUME
;

766 
ÿps
 &ğ~
SM_CAP_GVOLUME
;

768 
ùl
 = &
sim¶e
->
ùls
[
CTL_CAPTURE_VOLUME
];

769 ià(
ùl
->
–em
) {

770 ià(
cchªÃls
 < 
ùl
->
v®ues
)

771 
cchªÃls
 = 
ùl
->
v®ues
;

772 ià(
cmš
 > 
ùl
->
mš
)

773 
cmš
 = 
ùl
->
mš
;

774 ià(
cmax
 < 
ùl
->
max
)

775 
cmax
 = 
ùl
->
max
;

776 
ÿps
 |ğ
SM_CAP_CVOLUME
;

777 
ÿps
 &ğ~
SM_CAP_GVOLUME
;

779 
ùl
 = &
sim¶e
->
ùls
[
CTL_CAPTURE_SOURCE
];

780 ià(
ùl
->
–em
) {

781 ià(
cchªÃls
 < 
ùl
->
v®ues
)

782 
cchªÃls
 = 
ùl
->
v®ues
;

783 
ÿps
 |ğ
SM_CAP_CSWITCH
 | 
SM_CAP_CSWITCH_EXCL
;

784 
ÿps
 &ğ~
SM_CAP_GSWITCH
;

786 
ùl
 = &
sim¶e
->
ùls
[
CTL_GLOBAL_ENUM
];

787 ià(
ùl
->
–em
) {

788 ià(
pchªÃls
 < 
ùl
->
v®ues
)

789 
pchªÃls
 = 
ùl
->
v®ues
;

790 
ÿps
 |ğ
SM_CAP_PENUM
 | 
SM_CAP_CENUM
;

792 
ùl
 = &
sim¶e
->
ùls
[
CTL_PLAYBACK_ENUM
];

793 ià(
ùl
->
–em
) {

794 ià(
pchªÃls
 < 
ùl
->
v®ues
)

795 
pchªÃls
 = 
ùl
->
v®ues
;

796 
ÿps
 |ğ
SM_CAP_PENUM
;

798 
ùl
 = &
sim¶e
->
ùls
[
CTL_CAPTURE_ENUM
];

799 ià(
ùl
->
–em
) {

800 ià(
pchªÃls
 < 
ùl
->
v®ues
)

801 
pchªÃls
 = 
ùl
->
v®ues
;

802 
ÿps
 |ğ
SM_CAP_CENUM
;

804 ià(
pchªÃls
 > 32)

805 
pchªÃls
 = 32;

806 ià(
cchªÃls
 > 32)

807 
cchªÃls
 = 32;

808 ià(
ÿps
 & (
SM_CAP_GSWITCH
|
SM_CAP_PSWITCH
))

809 
ÿps
 |ğ
SM_CAP_PSWITCH_JOIN
;

810 ià(
ÿps
 & (
SM_CAP_GVOLUME
|
SM_CAP_PVOLUME
))

811 
ÿps
 |ğ
SM_CAP_PVOLUME_JOIN
;

812 ià(
ÿps
 & (
SM_CAP_GSWITCH
|
SM_CAP_CSWITCH
))

813 
ÿps
 |ğ
SM_CAP_CSWITCH_JOIN
;

814 ià(
ÿps
 & (
SM_CAP_GVOLUME
|
SM_CAP_CVOLUME
))

815 
ÿps
 |ğ
SM_CAP_CVOLUME_JOIN
;

816 ià(
pchªÃls
 > 1 || 
cchªÃls
 > 1) {

817 ià(
sim¶e
->
ùls
[
CTL_SINGLE
].
–em
 &&

818 
sim¶e
->
ùls
[
CTL_SINGLE
].
v®ues
 > 1) {

819 ià(
ÿps
 & 
SM_CAP_GSWITCH
)

820 
ÿps
 &ğ~(
SM_CAP_PSWITCH_JOIN
|
SM_CAP_CSWITCH_JOIN
);

822 
ÿps
 &ğ~(
SM_CAP_PVOLUME_JOIN
|
SM_CAP_CVOLUME_JOIN
);

824 ià(
sim¶e
->
ùls
[
CTL_GLOBAL_ROUTE
].
–em
 ||

825 (
sim¶e
->
ùls
[
CTL_GLOBAL_SWITCH
].
–em
 &&

826 
sim¶e
->
ùls
[
CTL_GLOBAL_SWITCH
].
v®ues
 > 1)) {

827 
ÿps
 &ğ~(
SM_CAP_PSWITCH_JOIN
|
SM_CAP_CSWITCH_JOIN
);

829 ià(
sim¶e
->
ùls
[
CTL_GLOBAL_VOLUME
].
–em
 &&

830 
sim¶e
->
ùls
[
CTL_GLOBAL_VOLUME
].
v®ues
 > 1) {

831 
ÿps
 &ğ~(
SM_CAP_PVOLUME_JOIN
|
SM_CAP_CVOLUME_JOIN
);

834 ià(
pchªÃls
 > 1) {

835 ià(
sim¶e
->
ùls
[
CTL_PLAYBACK_ROUTE
].
–em
 ||

836 (
sim¶e
->
ùls
[
CTL_PLAYBACK_SWITCH
].
–em
 &&

837 
sim¶e
->
ùls
[
CTL_PLAYBACK_SWITCH
].
v®ues
 > 1)) {

838 
ÿps
 &ğ~
SM_CAP_PSWITCH_JOIN
;

840 ià(
sim¶e
->
ùls
[
CTL_PLAYBACK_VOLUME
].
–em
 &&

841 
sim¶e
->
ùls
[
CTL_PLAYBACK_VOLUME
].
v®ues
 > 1) {

842 
ÿps
 &ğ~
SM_CAP_PVOLUME_JOIN
;

845 ià(
cchªÃls
 > 1) {

846 ià(
sim¶e
->
ùls
[
CTL_CAPTURE_ROUTE
].
–em
 ||

847 (
sim¶e
->
ùls
[
CTL_CAPTURE_SWITCH
].
–em
 &&

848 
sim¶e
->
ùls
[
CTL_CAPTURE_SWITCH
].
v®ues
 > 1) ||

849 (
sim¶e
->
ùls
[
CTL_CAPTURE_SOURCE
].
–em
 &&

850 
sim¶e
->
ùls
[
CTL_CAPTURE_SOURCE
].
v®ues
 > 1)) {

851 
ÿps
 &ğ~
SM_CAP_CSWITCH_JOIN
;

853 ià(
sim¶e
->
ùls
[
CTL_CAPTURE_VOLUME
].
–em
 &&

854 
sim¶e
->
ùls
[
CTL_CAPTURE_VOLUME
].
v®ues
 > 1) {

855 
ÿps
 &ğ~
SM_CAP_CVOLUME_JOIN
;

860 ià((
ÿps
 & (
SM_CAP_GSWITCH
|
SM_CAP_PSWITCH
|
SM_CAP_CSWITCH
)) &&

861 (
ÿps
 & (
SM_CAP_GSWITCH
|
SM_CAP_PSWITCH
|
SM_CAP_CSWITCH
)) == (caps & SM_CAP_GSWITCH)) {

862 
ÿps
 &ğ~(
SM_CAP_GSWITCH
|
SM_CAP_CSWITCH_JOIN
|
SM_CAP_CSWITCH_EXCL
);

863 
ÿps
 |ğ
SM_CAP_PSWITCH
;

866 ià((
ÿps
 & 
SM_CAP_GSWITCH
) &&

867 (
ÿps
 & (
SM_CAP_PSWITCH
|
SM_CAP_CSWITCH
)) == 0)

868 
ÿps
 |ğ
SM_CAP_PSWITCH
|
SM_CAP_CSWITCH
;

870 ià((
ÿps
 & 
SM_CAP_GVOLUME
) &&

871 (
ÿps
 & (
SM_CAP_PVOLUME
|
SM_CAP_CVOLUME
)) == 0)

872 
ÿps
 |ğ
SM_CAP_PVOLUME
|
SM_CAP_CVOLUME
;

874 
sim¶e
->
£Ëm
.
ÿps
 = caps;

875 
sim¶e
->
¡r
[
SM_PLAY
].
chªÃls
 = 
pchªÃls
;

876 ià(!
sim¶e
->
¡r
[
SM_PLAY
].
¿nge
) {

877 
sim¶e
->
¡r
[
SM_PLAY
].
mš
 = 
pmš
 !ğ
LONG_MAX
 ?…min : 0;

878 
sim¶e
->
¡r
[
SM_PLAY
].
max
 = 
pmax
 !ğ
LONG_MIN
 ?…max : 0;

880 
sim¶e
->
¡r
[
SM_CAPT
].
chªÃls
 = 
cchªÃls
;

881 ià(!
sim¶e
->
¡r
[
SM_CAPT
].
¿nge
) {

882 
sim¶e
->
¡r
[
SM_CAPT
].
mš
 = 
cmš
 !ğ
LONG_MAX
 ? cmin : 0;

883 
sim¶e
->
¡r
[
SM_CAPT
].
max
 = 
cmax
 !ğ
LONG_MIN
 ? cmax : 0;

886 
	}
}

888 #iâdeà
DOC_HIDDEN


889 cÚ¡ 
	ssuf
 {

890 cÚ¡ *
	msuffix
;

891 
£Ëm_ùl_ty³_t
 
	mty³
;

892 } 
	gsuffixes
[] = {

893 {" PÏyback Enum", 
CTL_PLAYBACK_ENUM
},

894 {" PÏyback Sw™ch", 
CTL_PLAYBACK_SWITCH
},

895 {" PÏyback Rou‹", 
CTL_PLAYBACK_ROUTE
},

896 {" PÏyback VŞume", 
CTL_PLAYBACK_VOLUME
},

897 {" C­tu» Enum", 
CTL_CAPTURE_ENUM
},

898 {" C­tu» Sw™ch", 
CTL_CAPTURE_SWITCH
},

899 {" C­tu» Rou‹", 
CTL_CAPTURE_ROUTE
},

900 {" C­tu» VŞume", 
CTL_CAPTURE_VOLUME
},

901 {" Enum", 
CTL_GLOBAL_ENUM
},

902 {" Sw™ch", 
CTL_GLOBAL_SWITCH
},

903 {" Rou‹", 
CTL_GLOBAL_ROUTE
},

904 {" VŞume", 
CTL_GLOBAL_VOLUME
},

905 {
NULL
, 0}

910 
	$ba£_Ën
(cÚ¡ *
Çme
, 
£Ëm_ùl_ty³_t
 *
ty³
)

912 cÚ¡ 
suf
 *
p
;

913 
size_t
 
Æ’
 = 
	`¡¾’
(
Çme
);

916 ià(!
	`¡rcmp
(
Çme
, "Capture Volume")) {

917 *
ty³
 = 
CTL_CAPTURE_VOLUME
;

918  
	`¡¾’
("Capture");

920 ià(!
	`¡rcmp
(
Çme
, "Capture Switch")) {

921 *
ty³
 = 
CTL_CAPTURE_SWITCH
;

922  
	`¡¾’
("Capture");

925 
p
 = 
suffixes
;…->
suffix
;…++) {

926 
size_t
 
¦’
 = 
	`¡¾’
(
p
->
suffix
);

927 
size_t
 
l
;

928 ià(
Æ’
 > 
¦’
) {

929 
l
 = 
Æ’
 - 
¦’
;

930 ià(
	`¡ºcmp
(
Çme
 + 
l
, 
p
->
suffix
, 
¦’
) == 0 &&

931 (
l
 < 1 || 
Çme
[l-1] != '-')) {

932 *
ty³
 = 
p
->type;

933  
l
;

945 ià(!
	`¡rcmp
(
Çme
, "Input Source")) {

946 *
ty³
 = 
CTL_CAPTURE_ROUTE
;

947  
	`¡¾’
(
Çme
);

949 ià(
	`¡r¡r
(
Çme
, "3D Control")) {

950 ià(
	`¡r¡r
(
Çme
, "Depth")) {

951 *
ty³
 = 
CTL_PLAYBACK_VOLUME
;

952  
	`¡¾’
(
Çme
);

956 *
ty³
 = 
CTL_SINGLE
;

957  
	`¡¾’
(
Çme
);

958 
	}
}

965 
	$_¢d_mix”_£Ëm_£t_vŞume
(
¢d_mix”_–em_t
 *
–em
, 
dœ
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
)

967 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

968 ià(
s
->
£Ëm
.
ÿps
 & 
SM_CAP_GVOLUME
)

969 
dœ
 = 
SM_PLAY
;

970 ià((è
chªÃl
 >ğ
s
->
¡r
[
dœ
].
chªÃls
)

972 ià(
v®ue
 < 
s
->
¡r
[
dœ
].
mš
 || v®u> s->¡r[dœ].
max
)

974 ià(
s
->
£Ëm
.
ÿps
 &

975 (
dœ
 =ğ
SM_PLAY
 ? 
SM_CAP_PVOLUME_JOIN
 : 
SM_CAP_CVOLUME_JOIN
))

976 
chªÃl
 = 0;

977 ià(
v®ue
 !ğ
s
->
¡r
[
dœ
].
vŞ
[
chªÃl
]) {

978 
s
->
¡r
[
dœ
].
vŞ
[
chªÃl
] = 
v®ue
;

982 
	}
}

984 
	$_¢d_mix”_£Ëm_£t_sw™ch
(
¢d_mix”_–em_t
 *
–em
, 
dœ
, 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
)

986 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

987 ià((è
chªÃl
 >ğ
s
->
¡r
[
dœ
].
chªÃls
)

989 ià(
s
->
£Ëm
.
ÿps
 &

990 (
dœ
 =ğ
SM_PLAY
 ? 
SM_CAP_PSWITCH_JOIN
 : 
SM_CAP_CSWITCH_JOIN
))

991 
chªÃl
 = 0;

992 ià(
v®ue
) {

993 ià(!(
s
->
¡r
[
dœ
].
sw
 & (1 << 
chªÃl
))) {

994 
s
->
¡r
[
dœ
].
sw
 |ğ1 << 
chªÃl
;

998 ià(
s
->
¡r
[
dœ
].
sw
 & (1 << 
chªÃl
)) {

999 
s
->
¡r
[
dœ
].
sw
 &ğ~(1 << 
chªÃl
);

1004 
	}
}

1006 
	$is_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
, 
cmd
, 
v®
)

1008 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

1010 
cmd
) {

1012 
SM_OPS_IS_ACTIVE
: {

1013 
£Ëm_ùl_ty³_t
 
ùl
;

1014 
ùl
 = 
CTL_SINGLE
; c <ğ
CTL_LAST
; ctl++)

1015 ià(
s
->
ùls
[
ùl
].
–em
 !ğ
NULL
 && s->ùls[ùl].
šaùive
)

1020 
SM_OPS_IS_MONO
:

1021  
s
->
¡r
[
dœ
].
chªÃls
 == 1;

1023 
SM_OPS_IS_CHANNEL
:

1024  (è
v®
 < 
s
->
¡r
[
dœ
].
chªÃls
;

1026 
SM_OPS_IS_ENUMERATED
:

1027 ià(
v®
 == 1) {

1028 ià(
dœ
 =ğ
SM_PLAY
 && (
s
->
£Ëm
.
ÿps
 & 
SM_CAP_PENUM
è&& !(s->£Ëm.ÿp & 
SM_CAP_CENUM
) )

1030 ià(
dœ
 =ğ
SM_CAPT
 && (
s
->
£Ëm
.
ÿps
 & 
SM_CAP_CENUM
è&& !(s->£Ëm.ÿp & 
SM_CAP_PENUM
) )

1034 ià(
s
->
£Ëm
.
ÿps
 & (
SM_CAP_CENUM
 | 
SM_CAP_PENUM
) )

1038 
SM_OPS_IS_ENUMCNT
:

1040 iàĞ(
s
->
£Ëm
.
ÿps
 & (
SM_CAP_CENUM
 | 
SM_CAP_PENUM
)) == (SM_CAP_CENUM | SM_CAP_PENUM) ) {

1041 ià(! 
s
->
ùls
[
CTL_GLOBAL_ENUM
].
–em
)

1042  -
EINVAL
;

1043  
s
->
ùls
[
CTL_GLOBAL_ENUM
].
max
;

1045 } ià(
s
->
£Ëm
.
ÿps
 & 
SM_CAP_PENUM
 ) {

1046 ià(! 
s
->
ùls
[
CTL_PLAYBACK_ENUM
].
–em
)

1047  -
EINVAL
;

1048  
s
->
ùls
[
CTL_PLAYBACK_ENUM
].
max
;

1050 } ià(
s
->
£Ëm
.
ÿps
 & 
SM_CAP_CENUM
 ) {

1051 ià(! 
s
->
ùls
[
CTL_CAPTURE_ENUM
].
–em
)

1052  -
EINVAL
;

1053  
s
->
ùls
[
CTL_CAPTURE_ENUM
].
max
;

1059 
	}
}

1061 
	$g‘_¿nge_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

1062 *
mš
, *
max
)

1064 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

1065 *
mš
 = 
s
->
¡r
[
dœ
].min;

1066 *
max
 = 
s
->
¡r
[
dœ
].max;

1068 
	}
}

1070 
	$£t_¿nge_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

1071 
mš
, 
max
)

1073 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

1074 
”r
;

1076 
s
->
¡r
[
dœ
].
¿nge
 = 1;

1077 
s
->
¡r
[
dœ
].
mš
 = min;

1078 
s
->
¡r
[
dœ
].
max
 = max;

1079 ià((
”r
 = 
	`£Ëm_»ad
(
–em
)) < 0)

1080  
”r
;

1082 
	}
}

1084 
	$g‘_vŞume_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

1085 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
)

1087 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

1088 ià(
s
->
£Ëm
.
ÿps
 & 
SM_CAP_GVOLUME
)

1089 
dœ
 = 
SM_PLAY
;

1090 ià((è
chªÃl
 >ğ
s
->
¡r
[
dœ
].
chªÃls
)

1091  -
EINVAL
;

1092 *
v®ue
 = 
s
->
¡r
[
dœ
].
vŞ
[
chªÃl
];

1094 
	}
}

1096 
š™_db_¿nge
(
¢d_hùl_–em_t
 *
ùl
, 
£Ëm_¡r
 *
»c
);

1098 
	$cÚv”t_to_dB
(
¢d_hùl_–em_t
 *
ùl
, 
£Ëm_¡r
 *
»c
,

1099 
vŞume
, *
db_gaš
)

1101 ià(
	`š™_db_¿nge
(
ùl
, 
»c
) < 0)

1102  -
EINVAL
;

1103  
	`¢d_v_cÚv”t_to_dB
(
»c
->
db_šfo
,„ec->
mš
,„ec->
max
,

1104 
vŞume
, 
db_gaš
);

1105 
	}
}

1109 
	$š™_db_¿nge
(
¢d_hùl_–em_t
 *
ùl
, 
£Ëm_¡r
 *
»c
)

1111 
¢d_ùl_–em_šfo_t
 
šfo
 = {0};

1112 *
v
 = 
NULL
;

1113 cÚ¡ 
v_size
 = 4096;

1114 *
db»c
;

1115 
db_size
;

1117 ià(
»c
->
db_š™_”rÜ
)

1118  -
EINVAL
;

1119 ià(
»c
->
db_š™Ÿlized
)

1122 ià(
	`¢d_hùl_–em_šfo
(
ùl
, &
šfo
) < 0)

1123 
”rÜ
;

1124 ià(!
	`¢d_ùl_–em_šfo_is_v_»adabË
(&
šfo
))

1125 
”rÜ
;

1126 
v
 = 
	`m®loc
(
v_size
);

1127 ià(!
v
)

1128  -
ENOMEM
;

1129 ià(
	`¢d_hùl_–em_v_»ad
(
ùl
, 
v
, 
v_size
) < 0)

1130 
”rÜ
;

1131 
db_size
 = 
	`¢d_v_·r£_dB_šfo
(
v
, 
v_size
, &
db»c
);

1132 ià(
db_size
 < 0)

1133 
”rÜ
;

1134 
»c
->
db_šfo
 = 
	`m®loc
(
db_size
);

1135 ià(!
»c
->
db_šfo
)

1136 
”rÜ
;

1137 
	`memıy
(
»c
->
db_šfo
, 
db»c
, 
db_size
);

1138 
	`ä“
(
v
);

1139 
»c
->
db_š™Ÿlized
 = 1;

1142 
”rÜ
:

1143 
	`ä“
(
v
);

1144 
»c
->
db_š™_”rÜ
 = 1;

1145  -
EINVAL
;

1146 
	}
}

1149 
£Ëm_ùl_t
 *
	$g‘_£Ëm_ùl
(
£Ëm_nÚe_t
 *
s
, 
dœ
)

1151 
£Ëm_ùl_t
 *
c
;

1152 ià(
dœ
 =ğ
SM_PLAY
)

1153 
c
 = &
s
->
ùls
[
CTL_PLAYBACK_VOLUME
];

1154 ià(
dœ
 =ğ
SM_CAPT
)

1155 
c
 = &
s
->
ùls
[
CTL_CAPTURE_VOLUME
];

1157  
NULL
;

1158 ià(! 
c
->
–em
)

1159 
c
 = &
s
->
ùls
[
CTL_GLOBAL_VOLUME
];

1160 ià(! 
c
->
–em
)

1161 
c
 = &
s
->
ùls
[
CTL_SINGLE
];

1162 ià(! 
c
->
–em
)

1163  
NULL
;

1164 ià(
c
->
ty³
 !ğ
SND_CTL_ELEM_TYPE_INTEGER
)

1165  
NULL
;

1166  
c
;

1167 
	}
}

1169 
	$g‘_dB_¿nge
(
¢d_hùl_–em_t
 *
ùl
, 
£Ëm_¡r
 *
»c
,

1170 *
mš
, *
max
)

1172 ià(
	`š™_db_¿nge
(
ùl
, 
»c
) < 0)

1173  -
EINVAL
;

1175  
	`¢d_v_g‘_dB_¿nge
(
»c
->
db_šfo
,„ec->
mš
,„ec->
max
, min, max);

1176 
	}
}

1178 
	$g‘_dB_¿nge_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

1179 *
mš
, *
max
)

1181 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

1182 
£Ëm_ùl_t
 *
c
;

1184 ià(
s
->
£Ëm
.
ÿps
 & 
SM_CAP_GVOLUME
)

1185 
dœ
 = 
SM_PLAY
;

1186 
c
 = 
	`g‘_£Ëm_ùl
(
s
, 
dœ
);

1187 ià(! 
c
)

1188  -
EINVAL
;

1189  
	`g‘_dB_¿nge
(
c
->
–em
, &
s
->
¡r
[
dœ
], 
mš
, 
max
);

1190 
	}
}

1192 
	$cÚv”t_äom_dB
(
¢d_hùl_–em_t
 *
ùl
, 
£Ëm_¡r
 *
»c
,

1193 
db_gaš
, *
v®ue
, 
xdœ
)

1195 ià(
	`š™_db_¿nge
(
ùl
, 
»c
) < 0)

1196  -
EINVAL
;

1198  
	`¢d_v_cÚv”t_äom_dB
(
»c
->
db_šfo
,„ec->
mš
,„ec->
max
,

1199 
db_gaš
, 
v®ue
, 
xdœ
);

1200 
	}
}

1202 
	$ask_vŞ_dB_İs
(
¢d_mix”_–em_t
 *
–em
,

1203 
dœ
,

1204 
v®ue
,

1205 *
dBv®ue
)

1207 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

1208 
£Ëm_ùl_t
 *
c
;

1210 
c
 = 
	`g‘_£Ëm_ùl
(
s
, 
dœ
);

1211 ià(! 
c
)

1212  -
EINVAL
;

1213 
»s
 = 
	`cÚv”t_to_dB
(
c
->
–em
, &
s
->
¡r
[
dœ
], 
v®ue
, 
dBv®ue
);

1214  
»s
;

1215 
	}
}

1217 
	$g‘_dB_İs
(
¢d_mix”_–em_t
 *
–em
,

1218 
dœ
,

1219 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
,

1220 *
v®ue
)

1222 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

1223 
£Ëm_ùl_t
 *
c
;

1224 
”r
;

1225 
vŞume
, 
db_gaš
;

1227 ià(
s
->
£Ëm
.
ÿps
 & 
SM_CAP_GVOLUME
)

1228 
dœ
 = 
SM_PLAY
;

1229 
c
 = 
	`g‘_£Ëm_ùl
(
s
, 
dœ
);

1230 ià(! 
c
)

1231  -
EINVAL
;

1232 ià((
”r
 = 
	`g‘_vŞume_İs
(
–em
, 
dœ
, 
chªÃl
, &
vŞume
)) < 0)

1233 
_”r
;

1234 ià((
”r
 = 
	`cÚv”t_to_dB
(
c
->
–em
, &
s
->
¡r
[
dœ
], 
vŞume
, &
db_gaš
)) < 0)

1235 
_”r
;

1236 
”r
 = 0;

1237 *
v®ue
 = 
db_gaš
;

1238 
_”r
:

1239  
”r
;

1240 
	}
}

1242 
	$g‘_sw™ch_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

1243 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, *
v®ue
)

1245 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

1246 ià(
s
->
£Ëm
.
ÿps
 & 
SM_CAP_GSWITCH
)

1247 
dœ
 = 
SM_PLAY
;

1248 ià((è
chªÃl
 >ğ
s
->
¡r
[
dœ
].
chªÃls
)

1249  -
EINVAL
;

1250 *
v®ue
 = !!(
s
->
¡r
[
dœ
].
sw
 & (1 << 
chªÃl
));

1252 
	}
}

1254 
	$£t_vŞume_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

1255 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
)

1257 
chªged
;

1258 
chªged
 = 
	`_¢d_mix”_£Ëm_£t_vŞume
(
–em
, 
dœ
, 
chªÃl
, 
v®ue
);

1259 ià(
chªged
 < 0)

1260  
chªged
;

1261 ià(
chªged
)

1262  
	`£Ëm_wr™e
(
–em
);

1264 
	}
}

1266 
	$ask_dB_vŞ_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

1267 
dbV®ue
, *
v®ue
, 
xdœ
)

1269 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

1270 
£Ëm_ùl_t
 *
c
;

1272 ià(
s
->
£Ëm
.
ÿps
 & 
SM_CAP_GVOLUME
)

1273 
dœ
 = 
SM_PLAY
;

1274 
c
 = 
	`g‘_£Ëm_ùl
(
s
, 
dœ
);

1275 ià(! 
c
)

1276  -
EINVAL
;

1277  
	`cÚv”t_äom_dB
(
c
->
–em
, &
s
->
¡r
[
dœ
], 
dbV®ue
, 
v®ue
, 
xdœ
);

1278 
	}
}

1280 
	$£t_dB_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

1281 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
,

1282 
db_gaš
, 
xdœ
)

1284 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

1285 
£Ëm_ùl_t
 *
c
;

1286 
v®ue
;

1287 
”r
;

1289 ià(
s
->
£Ëm
.
ÿps
 & 
SM_CAP_GVOLUME
)

1290 
dœ
 = 
SM_PLAY
;

1291 
c
 = 
	`g‘_£Ëm_ùl
(
s
, 
dœ
);

1292 ià(! 
c
)

1293  -
EINVAL
;

1294 
”r
 = 
	`cÚv”t_äom_dB
(
c
->
–em
, &
s
->
¡r
[
dœ
], 
db_gaš
, &
v®ue
, 
xdœ
);

1295 ià(
”r
 < 0)

1296  
”r
;

1297  
	`£t_vŞume_İs
(
–em
, 
dœ
, 
chªÃl
, 
v®ue
);

1298 
	}
}

1300 
	$£t_sw™ch_İs
(
¢d_mix”_–em_t
 *
–em
, 
dœ
,

1301 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
, 
v®ue
)

1303 
chªged
;

1304 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

1305 ià(
s
->
£Ëm
.
ÿps
 & 
SM_CAP_GSWITCH
)

1306 
dœ
 = 
SM_PLAY
;

1307 ià(
dœ
 =ğ
SM_PLAY
) {

1308 ià(! (
s
->
£Ëm
.
ÿps
 & (
SM_CAP_GSWITCH
|
SM_CAP_PSWITCH
)))

1309  -
EINVAL
;

1311 ià(! (
s
->
£Ëm
.
ÿps
 & (
SM_CAP_GSWITCH
|
SM_CAP_CSWITCH
)))

1312  -
EINVAL
;

1314 
chªged
 = 
	`_¢d_mix”_£Ëm_£t_sw™ch
(
–em
, 
dœ
, 
chªÃl
, 
v®ue
);

1315 ià(
chªged
 < 0)

1316  
chªged
;

1317 ià(
chªged
)

1318  
	`£Ëm_wr™e
(
–em
);

1320 
	}
}

1322 
	$’um_™em_Çme_İs
(
¢d_mix”_–em_t
 *
–em
,

1323 
™em
,

1324 
size_t
 
maxËn
, *
buf
)

1326 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

1327 
¢d_ùl_–em_šfo_t
 
šfo
 = {0};

1328 
¢d_hùl_–em_t
 *
h–em
;

1329 
ty³
;

1331 
ty³
 = 
CTL_GLOBAL_ENUM
;

1332 
h–em
 = 
s
->
ùls
[
ty³
].
–em
;

1333 ià(!
h–em
) {

1334 
ty³
 = 
CTL_PLAYBACK_ENUM
;

1335 
h–em
 = 
s
->
ùls
[
ty³
].
–em
;

1337 ià(!
h–em
) {

1338 
ty³
 = 
CTL_CAPTURE_ENUM
;

1339 
h–em
 = 
s
->
ùls
[
ty³
].
–em
;

1341 
	`as£¹
(
h–em
);

1342 ià(
™em
 >ğ()
s
->
ùls
[
ty³
].
max
)

1343  -
EINVAL
;

1344 
	`¢d_hùl_–em_šfo
(
h–em
, &
šfo
);

1345 
	`¢d_ùl_–em_šfo_£t_™em
(&
šfo
, 
™em
);

1346 
	`¢d_hùl_–em_šfo
(
h–em
, &
šfo
);

1347 
	`¡ºıy
(
buf
, 
	`¢d_ùl_–em_šfo_g‘_™em_Çme
(&
šfo
), 
maxËn
);

1349 
	}
}

1351 
	$g‘_’um_™em_İs
(
¢d_mix”_–em_t
 *
–em
,

1352 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
,

1353 *
™emp
)

1355 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

1356 
¢d_ùl_–em_v®ue_t
 
ùl
 = {0};

1357 
¢d_hùl_–em_t
 *
h–em
;

1358 
”r
;

1360 ià((è
chªÃl
 >ğ
s
->
¡r
[0].
chªÃls
)

1361  -
EINVAL
;

1362 
h–em
 = 
s
->
ùls
[
CTL_GLOBAL_ENUM
].
–em
;

1363 ià(!
h–em
èh–em = 
s
->
ùls
[
CTL_PLAYBACK_ENUM
].
–em
;

1364 ià(!
h–em
èh–em = 
s
->
ùls
[
CTL_CAPTURE_ENUM
].
–em
;

1365 
	`as£¹
(
h–em
);

1366 
”r
 = 
	`¢d_hùl_–em_»ad
(
h–em
, &
ùl
);

1367 ià(! 
”r
)

1368 *
™emp
 = 
	`¢d_ùl_–em_v®ue_g‘_’um”©ed
(&
ùl
, 
chªÃl
);

1369  
”r
;

1370 
	}
}

1372 
	$£t_’um_™em_İs
(
¢d_mix”_–em_t
 *
–em
,

1373 
¢d_mix”_£Ëm_chªÃl_id_t
 
chªÃl
,

1374 
™em
)

1376 
£Ëm_nÚe_t
 *
s
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
–em
);

1377 
¢d_ùl_–em_v®ue_t
 
ùl
 = {0};

1378 
¢d_hùl_–em_t
 *
h–em
;

1379 
”r
;

1380 
ty³
;

1382 ià((è
chªÃl
 >ğ
s
->
¡r
[0].
chªÃls
) {

1383  -
EINVAL
;

1385 
ty³
 = 
CTL_GLOBAL_ENUM
;

1386 
h–em
 = 
s
->
ùls
[
ty³
].
–em
;

1387 ià(!
h–em
) {

1388 
ty³
 = 
CTL_PLAYBACK_ENUM
;

1389 
h–em
 = 
s
->
ùls
[
ty³
].
–em
;

1391 ià(!
h–em
) {

1392 
ty³
 = 
CTL_CAPTURE_ENUM
;

1393 
h–em
 = 
s
->
ùls
[
ty³
].
–em
;

1395 
	`as£¹
(
h–em
);

1396 ià(
™em
 >ğ()
s
->
ùls
[
ty³
].
max
) {

1397  -
EINVAL
;

1399 
”r
 = 
	`¢d_hùl_–em_»ad
(
h–em
, &
ùl
);

1400 ià(
”r
 < 0) {

1401  
”r
;

1403 
	`¢d_ùl_–em_v®ue_£t_’um”©ed
(&
ùl
, 
chªÃl
, 
™em
);

1404  
	`¢d_hùl_–em_wr™e
(
h–em
, &
ùl
);

1405 
	}
}

1407 
sm_–em_İs
 
	gsim¶e_nÚe_İs
 = {

1408 .
is
 = 
is_İs
,

1409 .
	gg‘_¿nge
 = 
g‘_¿nge_İs
,

1410 .
	gg‘_dB_¿nge
 = 
g‘_dB_¿nge_İs
,

1411 .
	g£t_¿nge
 = 
£t_¿nge_İs
,

1412 .
	gask_vŞ_dB
 = 
ask_vŞ_dB_İs
,

1413 .
	gask_dB_vŞ
 = 
ask_dB_vŞ_İs
,

1414 .
	gg‘_vŞume
 = 
g‘_vŞume_İs
,

1415 .
	gg‘_dB
 = 
g‘_dB_İs
,

1416 .
	g£t_vŞume
 = 
£t_vŞume_İs
,

1417 .
	g£t_dB
 = 
£t_dB_İs
,

1418 .
	gg‘_sw™ch
 = 
g‘_sw™ch_İs
,

1419 .
	g£t_sw™ch
 = 
£t_sw™ch_İs
,

1420 .
	g’um_™em_Çme
 = 
’um_™em_Çme_İs
,

1421 .
	gg‘_’um_™em
 = 
g‘_’um_™em_İs
,

1422 .
	g£t_’um_™em
 = 
£t_’um_™em_İs


1425 
	$sim¶e_add1
(
¢d_mix”_şass_t
 *
şass
, cÚ¡ *
Çme
,

1426 
¢d_hùl_–em_t
 *
h–em
, 
£Ëm_ùl_ty³_t
 
ty³
,

1427 
v®ue
)

1429 
¢d_mix”_–em_t
 *
m–em
;

1430 
¢d_mix”_£Ëm_id_t
 *
id
;

1431 
Ãw
 = 0;

1432 
”r
;

1433 
¢d_ùl_–em_šfo_t
 
šfo
 = {0};

1434 
£Ëm_nÚe_t
 *
sim¶e
;

1435 cÚ¡ *
Çme1
;

1436 
¢d_ùl_–em_ty³_t
 
ùy³
;

1437 
v®ues
;

1439 
”r
 = 
	`¢d_hùl_–em_šfo
(
h–em
, &
šfo
);

1440 ià(
”r
 < 0)

1441  
”r
;

1442 
ùy³
 = 
	`¢d_ùl_–em_šfo_g‘_ty³
(&
šfo
);

1443 
v®ues
 = 
	`¢d_ùl_–em_šfo_g‘_couÁ
(&
šfo
);

1444 
ty³
) {

1445 
CTL_SINGLE
:

1446 ià(
ùy³
 =ğ
SND_CTL_ELEM_TYPE_ENUMERATED
)

1447 
ty³
 = 
CTL_GLOBAL_ENUM
;

1448 ià(
ùy³
 !ğ
SND_CTL_ELEM_TYPE_BOOLEAN
 &&

1449 
ùy³
 !ğ
SND_CTL_ELEM_TYPE_INTEGER
)

1452 
CTL_GLOBAL_ROUTE
:

1453 
CTL_PLAYBACK_ROUTE
:

1454 
CTL_CAPTURE_ROUTE
:

1456 
n
;

1457 ià(
ùy³
 =ğ
SND_CTL_ELEM_TYPE_ENUMERATED
) {

1458 ià(
ty³
 =ğ
CTL_PLAYBACK_ROUTE
)

1459 
ty³
 = 
CTL_PLAYBACK_ENUM
;

1460 ià(
ty³
 =ğ
CTL_CAPTURE_ROUTE
)

1461 
ty³
 = 
CTL_CAPTURE_ENUM
;

1463 
ty³
 = 
CTL_GLOBAL_ENUM
;

1466 ià(
ùy³
 !ğ
SND_CTL_ELEM_TYPE_BOOLEAN
)

1468 #ifdeà
HAVE_SOFT_FLOAT


1470 
n
 = 1;‚ < 256;‚++)

1471 ià(
n
 *‚ =ğ
v®ues
)

1474 
n
 = 
	`sq¹
(()
v®ues
);

1476 ià(
n
 *‚ !ğ
v®ues
)

1478 
v®ues
 = 
n
;

1481 
CTL_GLOBAL_SWITCH
:

1482 
CTL_PLAYBACK_SWITCH
:

1483 
CTL_CAPTURE_SWITCH
:

1484 ià(
ùy³
 =ğ
SND_CTL_ELEM_TYPE_ENUMERATED
) {

1485 ià(
ty³
 =ğ
CTL_PLAYBACK_SWITCH
)

1486 
ty³
 = 
CTL_PLAYBACK_ENUM
;

1487 ià(
ty³
 =ğ
CTL_CAPTURE_SWITCH
)

1488 
ty³
 = 
CTL_CAPTURE_ENUM
;

1490 
ty³
 = 
CTL_GLOBAL_ENUM
;

1493 ià(
ùy³
 !ğ
SND_CTL_ELEM_TYPE_BOOLEAN
)

1496 
CTL_GLOBAL_VOLUME
:

1497 
CTL_PLAYBACK_VOLUME
:

1498 
CTL_CAPTURE_VOLUME
:

1499 ià(
ùy³
 =ğ
SND_CTL_ELEM_TYPE_ENUMERATED
) {

1500 ià(
ty³
 =ğ
CTL_PLAYBACK_VOLUME
)

1501 
ty³
 = 
CTL_PLAYBACK_ENUM
;

1502 ià(
ty³
 =ğ
CTL_CAPTURE_VOLUME
)

1503 
ty³
 = 
CTL_CAPTURE_ENUM
;

1505 
ty³
 = 
CTL_GLOBAL_ENUM
;

1508 ià(
ùy³
 !ğ
SND_CTL_ELEM_TYPE_INTEGER
)

1511 
CTL_CAPTURE_SOURCE
:

1512 ià(
ùy³
 !ğ
SND_CTL_ELEM_TYPE_ENUMERATED
)

1515 
CTL_GLOBAL_ENUM
:

1516 
CTL_PLAYBACK_ENUM
:

1517 
CTL_CAPTURE_ENUM
:

1518 ià(
ùy³
 !ğ
SND_CTL_ELEM_TYPE_ENUMERATED
)

1522 
	`as£¹
(0);

1525 
Çme1
 = 
	`g‘_shÜt_Çme
(
Çme
);

1526 ià(
	`¢d_mix”_£Ëm_id_m®loc
(&
id
))

1527  -
ENOMEM
;

1528 
	`¢d_mix”_£Ëm_id_£t_Çme
(
id
, 
Çme1
);

1529 
	`¢d_mix”_£Ëm_id_£t_šdex
(
id
, 
	`¢d_hùl_–em_g‘_šdex
(
h–em
));

1530 
m–em
 = 
	`¢d_mix”_fšd_£Ëm
(
	`¢d_mix”_şass_g‘_mix”
(
şass
), 
id
);

1531 ià(!
m–em
) {

1532 
sim¶e
 = 
	`ÿÎoc
(1, (*simple));

1533 ià(!
sim¶e
) {

1534 
	`¢d_mix”_£Ëm_id_ä“
(
id
);

1535  -
ENOMEM
;

1537 
sim¶e
->
£Ëm
.
id
 = id;

1538 
sim¶e
->
£Ëm
.
İs
 = &
sim¶e_nÚe_İs
;

1539 
”r
 = 
	`¢d_mix”_–em_Ãw
(&
m–em
, 
SND_MIXER_ELEM_SIMPLE
,

1540 
	`g‘_com·»_weight
(

1541 
	`¢d_mix”_£Ëm_id_g‘_Çme
(
sim¶e
->
£Ëm
.
id
),

1542 
	`¢d_mix”_£Ëm_id_g‘_šdex
(
sim¶e
->
£Ëm
.
id
)),

1543 
sim¶e
, 
£Ëm_ä“
);

1544 ià(
”r
 < 0) {

1545 
	`¢d_mix”_£Ëm_id_ä“
(
id
);

1546 
	`ä“
(
sim¶e
);

1547  
”r
;

1549 
Ãw
 = 1;

1551 
sim¶e
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
m–em
);

1552 
	`¢d_mix”_£Ëm_id_ä“
(
id
);

1554 ià(
sim¶e
->
ùls
[
ty³
].
–em
) {

1555 
	`SNDERR
("helem (%s,'%s',%u,%u,%u)‡ppearswice or more",

1556 
	`¢d_ùl_–em_içû_Çme
(

1557 
	`¢d_hùl_–em_g‘_š‹rçû
(
h–em
)),

1558 
	`¢d_hùl_–em_g‘_Çme
(
h–em
),

1559 
	`¢d_hùl_–em_g‘_šdex
(
h–em
),

1560 
	`¢d_hùl_–em_g‘_deviû
(
h–em
),

1561 
	`¢d_hùl_–em_g‘_subdeviû
(
h–em
));

1562 
”r
 = -
EINVAL
;

1563 
__”rÜ
;

1565 
sim¶e
->
ùls
[
ty³
].
–em
 = 
h–em
;

1566 
sim¶e
->
ùls
[
ty³
].ty³ = 
	`¢d_ùl_–em_šfo_g‘_ty³
(&
šfo
);

1567 
sim¶e
->
ùls
[
ty³
].
šaùive
 = 
	`¢d_ùl_–em_šfo_is_šaùive
(&
šfo
);

1568 
sim¶e
->
ùls
[
ty³
].
v®ues
 = values;

1569 iàĞ(
ty³
 =ğ
CTL_GLOBAL_ENUM
) ||

1570 (
ty³
 =ğ
CTL_PLAYBACK_ENUM
) ||

1571 (
ty³
 =ğ
CTL_CAPTURE_ENUM
) ) {

1572 
sim¶e
->
ùls
[
ty³
].
mš
 = 0;

1573 
sim¶e
->
ùls
[
ty³
].
max
 = 
	`¢d_ùl_–em_šfo_g‘_™ems
(&
šfo
);

1575 ià(
ùy³
 =ğ
SND_CTL_ELEM_TYPE_INTEGER
) {

1576 
sim¶e
->
ùls
[
ty³
].
mš
 =

1577 
	`¢d_ùl_–em_šfo_g‘_mš
(&
šfo
);

1578 
sim¶e
->
ùls
[
ty³
].
max
 =

1579 
	`¢d_ùl_–em_šfo_g‘_max
(&
šfo
);

1582 
ty³
) {

1583 
CTL_CAPTURE_SOURCE
:

1584 
sim¶e
->
ÿ±u»_™em
 = 
v®ue
;

1589 
”r
 = 
	`¢d_mix”_–em_©ch
(
m–em
, 
h–em
);

1590 ià(
”r
 < 0)

1591 
__”rÜ
;

1592 
”r
 = 
	`sim¶e_upd©e
(
m–em
);

1593 ià(
”r
 < 0) {

1594 ià(
Ãw
)

1595 
__”rÜ
;

1596  
”r
;

1598 ià(
Ãw
)

1599 
”r
 = 
	`¢d_mix”_–em_add
(
m–em
, 
şass
);

1601 
”r
 = 
	`¢d_mix”_–em_šfo
(
m–em
);

1602 ià(
”r
 < 0)

1603  
”r
;

1604 
”r
 = 
	`£Ëm_»ad
(
m–em
);

1605 ià(
”r
 < 0)

1606  
”r
;

1607 ià(
”r
)

1608 
”r
 = 
	`¢d_mix”_–em_v®ue
(
m–em
);

1609  
”r
;

1610 
__”rÜ
:

1611 ià(
Ãw
)

1612 
	`¢d_mix”_–em_ä“
(
m–em
);

1613  -
EINVAL
;

1614 
	}
}

1616 
	$sim¶e_ev’t_add
(
¢d_mix”_şass_t
 *
şass
, 
¢d_hùl_–em_t
 *
h–em
)

1618 cÚ¡ *
Çme
 = 
	`¢d_hùl_–em_g‘_Çme
(
h–em
);

1619 
£Ëm_ùl_ty³_t
 
ty³
;

1620 
’ame
[128];

1621 
size_t
 
Ën
;

1623 ià(
	`¢d_hùl_–em_g‘_š‹rçû
(
h–em
è!ğ
SND_CTL_ELEM_IFACE_MIXER
)

1625 ià(
	`¡rcmp
(
Çme
, "Capture Source") == 0) {

1626 
¢d_ùl_–em_šfo_t
 
šfo
 = {0};

1627 
k
, 
™ems
;

1628 
”r
;

1629 
”r
 = 
	`¢d_hùl_–em_šfo
(
h–em
, &
šfo
);

1630 
	`as£¹
(
”r
 >= 0);

1631 ià(
	`¢d_ùl_–em_šfo_g‘_ty³
(&
šfo
) !=

1632 
SND_CTL_ELEM_TYPE_ENUMERATED
)

1634 
™ems
 = 
	`¢d_ùl_–em_šfo_g‘_™ems
(&
šfo
);

1635 
k
 = 0; k < 
™ems
; ++k) {

1636 cÚ¡ *
n
;

1637 
	`¢d_ùl_–em_šfo_£t_™em
(&
šfo
, 
k
);

1638 
”r
 = 
	`¢d_hùl_–em_šfo
(
h–em
, &
šfo
);

1639 ià(
”r
 < 0)

1640  
”r
;

1641 
n
 = 
	`¢d_ùl_–em_šfo_g‘_™em_Çme
(&
šfo
);

1642 
”r
 = 
	`sim¶e_add1
(
şass
, 
n
, 
h–em
, 
CTL_CAPTURE_SOURCE
,

1643 
k
);

1644 ià(
”r
 < 0)

1645  
”r
;

1650 
Ën
 = 
	`ba£_Ën
(
Çme
, &
ty³
);

1651 ià(
Ën
 >ğ(
’ame
))

1652 
Ën
 = (
’ame
) - 1;

1653 
	`memıy
(
’ame
, 
Çme
, 
Ën
);

1654 
’ame
[
Ën
] = 0;

1656  
	`sim¶e_add1
(
şass
, 
’ame
, 
h–em
, 
ty³
, 0);

1657 
	}
}

1659 
	$sim¶e_ev’t_»move
(
¢d_hùl_–em_t
 *
h–em
,

1660 
¢d_mix”_–em_t
 *
m–em
)

1662 
£Ëm_nÚe_t
 *
sim¶e
 = 
	`¢d_mix”_–em_g‘_´iv©e
(
m–em
);

1663 
”r
;

1664 
k
;

1665 
k
 = 0; k <ğ
CTL_LAST
; k++) {

1666 ià(
sim¶e
->
ùls
[
k
].
–em
 =ğ
h–em
)

1669 
	`as£¹
(
k
 <ğ
CTL_LAST
);

1670 
sim¶e
->
ùls
[
k
].
–em
 = 
NULL
;

1671 
”r
 = 
	`¢d_mix”_–em_d‘ach
(
m–em
, 
h–em
);

1672 ià(
”r
 < 0)

1673  
”r
;

1674 ià(
	`¢d_mix”_–em_em±y
(
m–em
))

1675  
	`¢d_mix”_–em_»move
(
m–em
);

1676 
”r
 = 
	`sim¶e_upd©e
(
m–em
);

1677  
	`¢d_mix”_–em_šfo
(
m–em
);

1678 
	}
}

1680 
	$sim¶e_ev’t
(
¢d_mix”_şass_t
 *
şass
, 
mask
,

1681 
¢d_hùl_–em_t
 *
h–em
, 
¢d_mix”_–em_t
 *
m–em
)

1683 
”r
;

1684 ià(
mask
 =ğ
SND_CTL_EVENT_MASK_REMOVE
)

1685  
	`sim¶e_ev’t_»move
(
h–em
, 
m–em
);

1686 ià(
mask
 & 
SND_CTL_EVENT_MASK_ADD
) {

1687 
”r
 = 
	`sim¶e_ev’t_add
(
şass
, 
h–em
);

1688 ià(
”r
 < 0)

1689  
”r
;

1691 ià(
mask
 & 
SND_CTL_EVENT_MASK_INFO
) {

1692 
”r
 = 
	`sim¶e_ev’t_»move
(
h–em
, 
m–em
);

1693 ià(
”r
 < 0)

1694  
”r
;

1695 
”r
 = 
	`sim¶e_ev’t_add
(
şass
, 
h–em
);

1696 ià(
”r
 < 0)

1697  
”r
;

1700 ià(
mask
 & 
SND_CTL_EVENT_MASK_VALUE
) {

1701 
”r
 = 
	`£Ëm_»ad
(
m–em
);

1702 ià(
”r
 < 0)

1703  
”r
;

1704 ià(
”r
) {

1705 
”r
 = 
	`¢d_mix”_–em_v®ue
(
m–em
);

1706 ià(
”r
 < 0)

1707  
”r
;

1711 
	}
}

1720 
	$¢d_mix”_sim¶e_nÚe_»gi¡”
(
¢d_mix”_t
 *
mix”
,

1721 
¢d_mix”_£Ëm_»gİt
 *
İtiÚs
 
ATTRIBUTE_UNUSED
,

1722 
¢d_mix”_şass_t
 **
şas¥
)

1724 
¢d_mix”_şass_t
 *
şass
;

1725 
”r
;

1727 ià(
	`¢d_mix”_şass_m®loc
(&
şass
))

1728  -
ENOMEM
;

1729 
	`¢d_mix”_şass_£t_ev’t
(
şass
, 
sim¶e_ev’t
);

1730 
	`¢d_mix”_şass_£t_com·»
(
şass
, 
¢d_mix”_£Ëm_com·»
);

1731 
”r
 = 
	`¢d_mix”_şass_»gi¡”
(
şass
, 
mix”
);

1732 ià(
”r
 < 0) {

1733 
	`ä“
(
şass
);

1734  
”r
;

1736 ià(
şas¥
)

1737 *
şas¥
 = 
şass
;

1739 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/names.c

33 
	~"loÿl.h
"

34 
	~<¡d¬g.h
>

35 
	~<lim™s.h
>

36 
	~<sys/¡©.h
>

42 
	$¢d_Çmes_li¡
(cÚ¡ *
içû
 
ATTRIBUTE_UNUSED
,

43 
¢d_devÇme_t
 **
li¡
 
ATTRIBUTE_UNUSED
)

45  -
ENXIO
;

46 
	}
}

47 
lšk_w¬nšg
(
¢d_Çmes_li¡
, "Warning: snd_names_list is deprecated, use snd_device_name_hint");

53 
	$¢d_Çmes_li¡_ä“
(
¢d_devÇme_t
 *
li¡
 
ATTRIBUTE_UNUSED
)

55 
	}
}

56 
lšk_w¬nšg
(
¢d_Çmes_li¡_ä“
, "Warning: snd_names_list_free is deprecated, use snd_device_name_free_hint");

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/output.c

30 
	~"loÿl.h
"

31 
	~<¡d¬g.h
>

32 
	~<¡dio.h
>

33 
	~<¡dlib.h
>

34 
	~<uni¡d.h
>

36 #iâdeà
DOC_HIDDEN


37 
	s_¢d_ouut_İs
 {

38 (*
	mşo£
)(
¢d_ouut_t
 *
	mouut
);

39 (*
	m´št
)(
¢d_ouut_t
 *
	mouut
, cÚ¡ *
	mfÜm©
, 
va_li¡
 
	m¬gs
);

40 (*
	mputs
)(
¢d_ouut_t
 *
	mouut
, cÚ¡ *
	m¡r
);

41 (*
	mputch
)(
¢d_ouut_t
 *
	mouut
, 
	mc
);

42 (*
	mæush
)(
¢d_ouut_t
 *
	mouut
);

43 } 
	t¢d_ouut_İs_t
;

45 
	s_¢d_ouut
 {

46 
¢d_ouut_ty³_t
 
	mty³
;

47 cÚ¡ 
¢d_ouut_İs_t
 *
	mİs
;

48 *
	m´iv©e_d©a
;

57 
	$¢d_ouut_şo£
(
¢d_ouut_t
 *
ouut
)

59 
”r
 = 
ouut
->
İs
->
	`şo£
(output);

60 
	`ä“
(
ouut
);

61  
”r
;

62 
	}
}

71 
	$¢d_ouut_´štf
(
¢d_ouut_t
 *
ouut
, cÚ¡ *
fÜm©
, ...)

73 
»suÉ
;

74 
va_li¡
 
¬gs
;

75 
	`va_¡¬t
(
¬gs
, 
fÜm©
);

76 
»suÉ
 = 
ouut
->
İs
->
	`´št
(ouut, 
fÜm©
, 
¬gs
);

77 
	`va_’d
(
¬gs
);

78  
»suÉ
;

79 
	}
}

88 
	$¢d_ouut_v´štf
(
¢d_ouut_t
 *
ouut
, cÚ¡ *
fÜm©
, 
va_li¡
 
¬gs
)

90  
ouut
->
İs
->
	`´št
(ouut, 
fÜm©
, 
¬gs
);

91 
	}
}

99 
	$¢d_ouut_puts
(
¢d_ouut_t
 *
ouut
, cÚ¡ *
¡r
)

101  
ouut
->
İs
->
	`puts
(ouut, 
¡r
);

102 
	}
}

110 
	$¢d_ouut_putc
(
¢d_ouut_t
 *
ouut
, 
c
)

112  
ouut
->
İs
->
	`putch
(ouut, 
c
);

113 
	}
}

124 
	$¢d_ouut_æush
(
¢d_ouut_t
 *
ouut
)

126  
ouut
->
İs
->
	`æush
(output);

127 
	}
}

129 #iâdeà
DOC_HIDDEN


130 
	s_¢d_ouut_¡dio
 {

131 
	mşo£
;

132 
FILE
 *
	må
;

133 } 
	t¢d_ouut_¡dio_t
;

135 
	$¢d_ouut_¡dio_şo£
(
¢d_ouut_t
 *
ouut
)

137 
¢d_ouut_¡dio_t
 *
¡dio
 = 
ouut
->
´iv©e_d©a
;

138 ià(
¡dio
->
şo£
)

139 
	`fşo£
(
¡dio
->
å
);

140 
	`ä“
(
¡dio
);

142 
	}
}

144 
	$¢d_ouut_¡dio_´št
(
¢d_ouut_t
 *
ouut
, cÚ¡ *
fÜm©
, 
va_li¡
 
¬gs
)

146 
¢d_ouut_¡dio_t
 *
¡dio
 = 
ouut
->
´iv©e_d©a
;

147  
	`vårštf
(
¡dio
->
å
, 
fÜm©
, 
¬gs
);

148 
	}
}

150 
	$¢d_ouut_¡dio_puts
(
¢d_ouut_t
 *
ouut
, cÚ¡ *
¡r
)

152 
¢d_ouut_¡dio_t
 *
¡dio
 = 
ouut
->
´iv©e_d©a
;

153  
	`åuts
(
¡r
, 
¡dio
->
å
);

154 
	}
}

156 
	$¢d_ouut_¡dio_putc
(
¢d_ouut_t
 *
ouut
, 
c
)

158 
¢d_ouut_¡dio_t
 *
¡dio
 = 
ouut
->
´iv©e_d©a
;

159  
	`putc
(
c
, 
¡dio
->
å
);

160 
	}
}

162 
	$¢d_ouut_¡dio_æush
(
¢d_ouut_t
 *
ouut
)

164 
¢d_ouut_¡dio_t
 *
¡dio
 = 
ouut
->
´iv©e_d©a
;

165  
	`fæush
(
¡dio
->
å
);

166 
	}
}

168 cÚ¡ 
¢d_ouut_İs_t
 
	g¢d_ouut_¡dio_İs
 = {

169 .
şo£
 = 
¢d_ouut_¡dio_şo£
,

170 .
	g´št
 = 
¢d_ouut_¡dio_´št
,

171 .
	gputs
 = 
¢d_ouut_¡dio_puts
,

172 .
	gputch
 = 
¢d_ouut_¡dio_putc
,

173 .
	gæush
 = 
¢d_ouut_¡dio_æush
,

188 
	$¢d_ouut_¡dio_©ch
(
¢d_ouut_t
 **
ouu
, 
FILE
 *
å
, 
_şo£
)

190 
¢d_ouut_t
 *
ouut
;

191 
¢d_ouut_¡dio_t
 *
¡dio
;

192 
	`as£¹
(
ouu
 && 
å
);

193 
¡dio
 = 
	`ÿÎoc
(1, (*stdio));

194 ià(!
¡dio
)

195  -
ENOMEM
;

196 
ouut
 = 
	`ÿÎoc
(1, (*output));

197 ià(!
ouut
) {

198 
	`ä“
(
¡dio
);

199  -
ENOMEM
;

201 
¡dio
->
å
 = fp;

202 
¡dio
->
şo£
 = 
_şo£
;

203 
ouut
->
ty³
 = 
SND_OUTPUT_STDIO
;

204 
ouut
->
İs
 = &
¢d_ouut_¡dio_İs
;

205 
ouut
->
´iv©e_d©a
 = 
¡dio
;

206 *
ouu
 = 
ouut
;

208 
	}
}

218 
	$¢d_ouut_¡dio_İ’
(
¢d_ouut_t
 **
ouu
, cÚ¡ *
fe
, cÚ¡ *
mode
)

220 
”r
;

221 
FILE
 *
å
 = 
	`fİ’
(
fe
, 
mode
);

222 ià(!
å
) {

224  -
”ºo
;

226 
”r
 = 
	`¢d_ouut_¡dio_©ch
(
ouu
, 
å
, 1);

227 ià(
”r
 < 0)

228 
	`fşo£
(
å
);

229  
”r
;

230 
	}
}

232 #iâdeà
DOC_HIDDEN


234 
	s_¢d_ouut_bufãr
 {

235 *
	mbuf
;

236 
size_t
 
	m®loc
;

237 
size_t
 
	msize
;

238 } 
	t¢d_ouut_bufãr_t
;

240 
	$¢d_ouut_bufãr_şo£
(
¢d_ouut_t
 *
ouut
)

242 
¢d_ouut_bufãr_t
 *
bufãr
 = 
ouut
->
´iv©e_d©a
;

243 
	`ä“
(
bufãr
->
buf
);

244 
	`ä“
(
bufãr
);

246 
	}
}

248 
	$¢d_ouut_bufãr_Ãed
(
¢d_ouut_t
 *
ouut
, 
size_t
 
size
)

250 
¢d_ouut_bufãr_t
 *
bufãr
 = 
ouut
->
´iv©e_d©a
;

251 
size_t
 
_ä“
 = 
bufãr
->
®loc
 - bufãr->
size
;

252 
size_t
 
®loc
;

253 *
buf
;

257 
size
++;

258 ià(
_ä“
 >ğ
size
)

259  
_ä“
;

260 ià(
bufãr
->
®loc
 == 0)

261 
®loc
 = 256;

263 
®loc
 = 
bufãr
->alloc;

264 
®loc
 < 
bufãr
->
size
 + size)

265 
®loc
 *= 2;

266 
buf
 = 
	`»®loc
(
bufãr
->buf, 
®loc
);

267 ià(!
buf
)

268  -
ENOMEM
;

269 
bufãr
->
buf
 = buf;

270 
bufãr
->
®loc
 =‡lloc;

271  
bufãr
->
®loc
 - bufãr->
size
;

272 
	}
}

274 
	$¢d_ouut_bufãr_´št
(
¢d_ouut_t
 *
ouut
, cÚ¡ *
fÜm©
, 
va_li¡
 
¬gs
)

276 
¢d_ouut_bufãr_t
 *
bufãr
 = 
ouut
->
´iv©e_d©a
;

277 
size_t
 
size
 = 256;

278 
»suÉ
;

279 
»suÉ
 = 
	`¢d_ouut_bufãr_Ãed
(
ouut
, 
size
);

280 ià(
»suÉ
 < 0)

281  
»suÉ
;

282 
»suÉ
 = 
	`v¢´štf
((*)
bufãr
->
buf
 + bufãr->
size
, size, 
fÜm©
, 
¬gs
);

283 
	`as£¹
(
»suÉ
 >= 0);

284 ià((
size_t
)
»suÉ
 <ğ
size
) {

285 
bufãr
->
size
 +ğ
»suÉ
;

286  
»suÉ
;

288 
size
 = 
»suÉ
;

289 
»suÉ
 = 
	`¢d_ouut_bufãr_Ãed
(
ouut
, 
size
);

290 ià(
»suÉ
 < 0)

291  
»suÉ
;

292 
»suÉ
 = 
	`v¢´štf
((*)
bufãr
->
buf
 + bufãr->
size
,„esuÉ, 
fÜm©
, 
¬gs
);

293 
	`as£¹
(
»suÉ
 =ğ()
size
);

294 
bufãr
->
size
 +ğ
»suÉ
;

295  
»suÉ
;

296 
	}
}

298 
	$¢d_ouut_bufãr_puts
(
¢d_ouut_t
 *
ouut
, cÚ¡ *
¡r
)

300 
¢d_ouut_bufãr_t
 *
bufãr
 = 
ouut
->
´iv©e_d©a
;

301 
size_t
 
size
 = 
	`¡¾’
(
¡r
);

302 
”r
;

303 
”r
 = 
	`¢d_ouut_bufãr_Ãed
(
ouut
, 
size
);

304 ià(
”r
 < 0)

305  
”r
;

306 
	`memıy
(
bufãr
->
buf
 + bufãr->
size
, 
¡r
, size);

307 
bufãr
->
size
 += size;

308  
size
;

309 
	}
}

311 
	$¢d_ouut_bufãr_putc
(
¢d_ouut_t
 *
ouut
, 
c
)

313 
¢d_ouut_bufãr_t
 *
bufãr
 = 
ouut
->
´iv©e_d©a
;

314 
”r
;

315 
”r
 = 
	`¢d_ouut_bufãr_Ãed
(
ouut
, 1);

316 ià(
”r
 < 0)

317  
”r
;

318 
bufãr
->
buf
[bufãr->
size
++] = 
c
;

320 
	}
}

322 
	$¢d_ouut_bufãr_æush
(
¢d_ouut_t
 *
ouut
 
ATTRIBUTE_UNUSED
)

324 
¢d_ouut_bufãr_t
 *
bufãr
 = 
ouut
->
´iv©e_d©a
;

325 
bufãr
->
size
 = 0;

327 
	}
}

329 cÚ¡ 
¢d_ouut_İs_t
 
	g¢d_ouut_bufãr_İs
 = {

330 .
şo£
 = 
¢d_ouut_bufãr_şo£
,

331 .
	g´št
 = 
¢d_ouut_bufãr_´št
,

332 .
	gputs
 = 
¢d_ouut_bufãr_puts
,

333 .
	gputch
 = 
¢d_ouut_bufãr_putc
,

334 .
	gæush
 = 
¢d_ouut_bufãr_æush
,

348 
size_t
 
	$¢d_ouut_bufãr_¡ršg
(
¢d_ouut_t
 *
ouut
, **
buf
)

350 
¢d_ouut_bufãr_t
 *
bufãr
 = 
ouut
->
´iv©e_d©a
;

351 *
buf
 = (*)
bufãr
->buf;

352  
bufãr
->
size
;

353 
	}
}

365 
size_t
 
	$¢d_ouut_bufãr_¡—l
(
¢d_ouut_t
 *
ouut
, **
buf
)

367 
¢d_ouut_bufãr_t
 *
bufãr
 = 
ouut
->
´iv©e_d©a
;

368 
size_t
 
size
;

369 *
buf
 = (*)
bufãr
->buf;

370 
size
 = 
bufãr
->size;

371 
bufãr
->
buf
 = 
NULL
;

372 
bufãr
->
®loc
 = 0;

373 
bufãr
->
size
 = 0;

374  
size
;

375 
	}
}

383 
	$¢d_ouut_bufãr_İ’
(
¢d_ouut_t
 **
ouu
)

385 
¢d_ouut_t
 *
ouut
;

386 
¢d_ouut_bufãr_t
 *
bufãr
;

387 
	`as£¹
(
ouu
);

388 
bufãr
 = 
	`ÿÎoc
(1, (*buffer));

389 ià(!
bufãr
)

390  -
ENOMEM
;

391 
ouut
 = 
	`ÿÎoc
(1, (*output));

392 ià(!
ouut
) {

393 
	`ä“
(
bufãr
);

394  -
ENOMEM
;

396 
bufãr
->
buf
 = 
NULL
;

397 
bufãr
->
®loc
 = 0;

398 
bufãr
->
size
 = 0;

399 
ouut
->
ty³
 = 
SND_OUTPUT_BUFFER
;

400 
ouut
->
İs
 = &
¢d_ouut_bufãr_İs
;

401 
ouut
->
´iv©e_d©a
 = 
bufãr
;

402 *
ouu
 = 
ouut
;

404 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/interval.c

22 
	#SND_INTERVAL_C


	)

23 
	#SND_INTERVAL_INLINE


	)

25 
	~"pcm_loÿl.h
"

26 
	~<sys/ty³s.h
>

27 
	~<lim™s.h
>

29 
šlše
 
	$div64_32
(
ušt64_t
 *
n
, 
ušt32_t
 
d
, ušt32_ˆ*
»m
)

31 *
»m
 = *
n
 % 
d
;

32 *
n
 /ğ
d
;

33 
	}
}

35 
šlše
 
	$div32
(
a
, 
b
,

36 *
r
)

38 ià(
b
 == 0) {

39 *
r
 = 0;

40  
UINT_MAX
;

42 *
r
 = 
a
 % 
b
;

43  
a
 / 
b
;

44 
	}
}

46 
šlše
 
	$div_down
(
a
, 
b
)

48 ià(
b
 == 0)

49  
UINT_MAX
;

50  
a
 / 
b
;

51 
	}
}

53 
šlše
 
	$div_up
(
a
, 
b
)

55 
r
;

56 
q
;

57 ià(
b
 == 0)

58  
UINT_MAX
;

59 
q
 = 
	`div32
(
a
, 
b
, &
r
);

60 ià(
r
)

61 ++
q
;

62  
q
;

63 
	}
}

65 
šlše
 
	$mul
(
a
, 
b
)

67 ià(
a
 == 0)

69 ià(
	`div_down
(
UINT_MAX
, 
a
è< 
b
)

70  
UINT_MAX
;

71  
a
 * 
b
;

72 
	}
}

74 
šlše
 
	$add
(
a
, 
b
)

76 ià(
a
 >ğ
UINT_MAX
 - 
b
)

77  
UINT_MAX
;

78  
a
 + 
b
;

79 
	}
}

81 
šlše
 
	$sub
(
a
, 
b
)

83 ià(
a
 > 
b
)

84  
a
 - 
b
;

86 
	}
}

88 
šlše
 
	$muldiv32
(
a
, 
b
,

89 
c
, *
r
)

91 
ušt64_t
 
n
 = (ušt64_tè
a
 * 
b
;

92 ià(
c
 == 0) {

93 
	`as£¹
(
n
 > 0);

94 *
r
 = 0;

95  
UINT_MAX
;

97 
	`div64_32
(&
n
, 
c
, 
r
);

98 ià(
n
 >ğ
UINT_MAX
) {

99 *
r
 = 0;

100  
UINT_MAX
;

102  
n
;

103 
	}
}

105 
	$¢d_š‹rv®_»fše_mš
(
¢d_š‹rv®_t
 *
i
, 
mš
, 
İ’mš
)

107 
chªged
 = 0;

108 ià(
	`¢d_š‹rv®_em±y
(
i
))

109  -
ENOENT
;

110 ià(
i
->
mš
 < min) {

111 
i
->
mš
 = min;

112 
i
->
İ’mš
 = openmin;

113 
chªged
 = 1;

114 } ià(
i
->
mš
 =ğmš && !i->
İ’mš
 && openmin) {

115 
i
->
İ’mš
 = 1;

116 
chªged
 = 1;

118 ià(
i
->
š‹g”
) {

119 ià(
i
->
İ’mš
) {

120 
i
->
mš
++;

121 
i
->
İ’mš
 = 0;

124 ià(
	`¢d_š‹rv®_checkem±y
(
i
)) {

125 
	`¢d_š‹rv®_nÚe
(
i
);

126  -
EINVAL
;

128  
chªged
;

129 
	}
}

131 
	$¢d_š‹rv®_»fše_max
(
¢d_š‹rv®_t
 *
i
, 
max
, 
İ’max
)

133 
chªged
 = 0;

134 ià(
	`¢d_š‹rv®_em±y
(
i
))

135  -
ENOENT
;

136 ià(
i
->
max
 > max) {

137 
i
->
max
 = max;

138 
i
->
İ’max
 = openmax;

139 
chªged
 = 1;

140 } ià(
i
->
max
 =ğmax && !i->
İ’max
 && openmax) {

141 
i
->
İ’max
 = 1;

142 
chªged
 = 1;

144 ià(
i
->
š‹g”
) {

145 ià(
i
->
İ’max
) {

146 
i
->
max
--;

147 
i
->
İ’max
 = 0;

150 ià(
	`¢d_š‹rv®_checkem±y
(
i
)) {

151 
	`¢d_š‹rv®_nÚe
(
i
);

152  -
EINVAL
;

154  
chªged
;

155 
	}
}

158 
	$¢d_š‹rv®_»fše
(
¢d_š‹rv®_t
 *
i
, cÚ¡ snd_š‹rv®_ˆ*
v
)

160 
chªged
 = 0;

161 ià(
	`¢d_š‹rv®_em±y
(
i
))

162  -
ENOENT
;

163 ià(
i
->
mš
 < 
v
->min) {

164 
i
->
mš
 = 
v
->min;

165 
i
->
İ’mš
 = 
v
->openmin;

166 
chªged
 = 1;

167 } ià(
i
->
mš
 =ğ
v
->mš && !i->
İ’mš
 && v->openmin) {

168 
i
->
İ’mš
 = 1;

169 
chªged
 = 1;

171 ià(
i
->
max
 > 
v
->max) {

172 
i
->
max
 = 
v
->max;

173 
i
->
İ’max
 = 
v
->openmax;

174 
chªged
 = 1;

175 } ià(
i
->
max
 =ğ
v
->max && !i->
İ’max
 && v->openmax) {

176 
i
->
İ’max
 = 1;

177 
chªged
 = 1;

179 ià(!
i
->
š‹g”
 && 
v
->integer) {

180 
i
->
š‹g”
 = 1;

181 
chªged
 = 1;

183 ià(
i
->
š‹g”
) {

184 ià(
i
->
İ’mš
) {

185 
i
->
mš
++;

186 
i
->
İ’mš
 = 0;

188 ià(
i
->
İ’max
) {

189 
i
->
max
--;

190 
i
->
İ’max
 = 0;

192 } ià(!
i
->
İ’mš
 && !i->
İ’max
 && i->
mš
 =ği->
max
)

193 
i
->
š‹g”
 = 1;

194 ià(
	`¢d_š‹rv®_checkem±y
(
i
)) {

195 
	`¢d_š‹rv®_nÚe
(
i
);

196  -
EINVAL
;

198  
chªged
;

199 
	}
}

201 
	$¢d_š‹rv®_»fše_fœ¡
(
¢d_š‹rv®_t
 *
i
)

203 cÚ¡ 
Ï¡_max
 = 
i
->
max
;

205 ià(
	`¢d_š‹rv®_em±y
(
i
))

206  -
ENOENT
;

207 ià(
	`¢d_š‹rv®_sšgË
(
i
))

209 
i
->
max
 = i->
mš
;

210 ià(
i
->
İ’mš
)

211 
i
->
max
++;

213 
i
->
İ’max
 = (i->İ’max && i->
max
 >ğ
Ï¡_max
);

215 
	}
}

217 
	$¢d_š‹rv®_»fše_Ï¡
(
¢d_š‹rv®_t
 *
i
)

219 cÚ¡ 
Ï¡_mš
 = 
i
->
mš
;

221 ià(
	`¢d_š‹rv®_em±y
(
i
))

222  -
ENOENT
;

223 ià(
	`¢d_š‹rv®_sšgË
(
i
))

225 
i
->
mš
 = i->
max
;

226 ià(
i
->
İ’max
)

227 
i
->
mš
--;

229 
i
->
İ’mš
 = (i->İ’mš && i->
mš
 <ğ
Ï¡_mš
);

231 
	}
}

233 
	$¢d_š‹rv®_»fše_£t
(
¢d_š‹rv®_t
 *
i
, 
v®
)

235 
¢d_š‹rv®_t
 
t
;

236 
t
.
em±y
 = 0;

237 
t
.
mš
 =.
max
 = 
v®
;

238 
t
.
İ’mš
 =.
İ’max
 = 0;

239 
t
.
š‹g”
 = 1;

240  
	`¢d_š‹rv®_»fše
(
i
, &
t
);

241 
	}
}

243 
	$¢d_š‹rv®_add
(cÚ¡ 
¢d_š‹rv®_t
 *
a
, cÚ¡ snd_š‹rv®_ˆ*
b
, snd_š‹rv®_ˆ*
c
)

245 ià(
a
->
em±y
 || 
b
->empty) {

246 
	`¢d_š‹rv®_nÚe
(
c
);

249 
c
->
em±y
 = 0;

250 
c
->
mš
 = 
	`add
(
a
->mš, 
b
->min);

251 
c
->
İ’mš
 = (
a
->İ’mš || 
b
->openmin);

252 
c
->
max
 = 
	`add
(
a
->max, 
b
->max);

253 
c
->
İ’max
 = (
a
->İ’max || 
b
->openmax);

254 
c
->
š‹g”
 = (
a
->š‹g” && 
b
->integer);

255 
	}
}

257 
	$¢d_š‹rv®_sub
(cÚ¡ 
¢d_š‹rv®_t
 *
a
, cÚ¡ snd_š‹rv®_ˆ*
b
, snd_š‹rv®_ˆ*
c
)

259 ià(
a
->
em±y
 || 
b
->empty) {

260 
	`¢d_š‹rv®_nÚe
(
c
);

263 
c
->
em±y
 = 0;

264 
c
->
mš
 = 
	`sub
(
a
->mš, 
b
->
max
);

265 
c
->
İ’mš
 = (
a
->İ’mš || 
b
->
İ’max
);

266 
c
->
max
 = 
	`add
(
a
->max, 
b
->
mš
);

267 
c
->
İ’max
 = (
a
->İ’max || 
b
->
İ’mš
);

268 
c
->
š‹g”
 = (
a
->š‹g” && 
b
->integer);

269 
	}
}

271 
	$¢d_š‹rv®_mul
(cÚ¡ 
¢d_š‹rv®_t
 *
a
, cÚ¡ snd_š‹rv®_ˆ*
b
, snd_š‹rv®_ˆ*
c
)

273 ià(
a
->
em±y
 || 
b
->empty) {

274 
	`¢d_š‹rv®_nÚe
(
c
);

277 
c
->
em±y
 = 0;

278 
c
->
mš
 = 
	`mul
(
a
->mš, 
b
->min);

279 
c
->
İ’mš
 = (
a
->İ’mš || 
b
->openmin);

280 
c
->
max
 = 
	`mul
(
a
->max, 
b
->max);

281 
c
->
İ’max
 = (
a
->İ’max || 
b
->openmax);

282 
c
->
š‹g”
 = (
a
->š‹g” && 
b
->integer);

283 
	}
}

285 
	$¢d_š‹rv®_div
(cÚ¡ 
¢d_š‹rv®_t
 *
a
, cÚ¡ snd_š‹rv®_ˆ*
b
, snd_š‹rv®_ˆ*
c
)

287 
r
;

288 ià(
a
->
em±y
 || 
b
->empty) {

289 
	`¢d_š‹rv®_nÚe
(
c
);

292 
c
->
em±y
 = 0;

293 
c
->
mš
 = 
	`div32
(
a
->mš, 
b
->
max
, &
r
);

294 
c
->
İ’mš
 = (
r
 || 
a
->İ’mš || 
b
->
İ’max
);

295 ià(
b
->
mš
 > 0) {

296 
c
->
max
 = 
	`div32
(
a
->max, 
b
->
mš
, &
r
);

297 ià(
r
) {

298 
c
->
max
++;

299 
c
->
İ’max
 = 1;

301 
c
->
İ’max
 = (
a
->İ’max || 
b
->
İ’mš
);

303 
c
->
max
 = 
UINT_MAX
;

304 
c
->
İ’max
 = 0;

306 
c
->
š‹g”
 = 0;

307 
	}
}

310 
	$¢d_š‹rv®_muldiv
(cÚ¡ 
¢d_š‹rv®_t
 *
a
, cÚ¡ snd_š‹rv®_ˆ*
b
,

311 cÚ¡ 
¢d_š‹rv®_t
 *
c
, snd_š‹rv®_ˆ*
d
)

313 
r
;

314 ià(
a
->
em±y
 || 
b
->em±y || 
c
->empty) {

315 
	`¢d_š‹rv®_nÚe
(
d
);

318 
d
->
em±y
 = 0;

319 
d
->
mš
 = 
	`muldiv32
(
a
->mš, 
b
->mš, 
c
->
max
, &
r
);

320 
d
->
İ’mš
 = (
r
 || 
a
->İ’mš || 
b
->İ’mš || 
c
->
İ’max
);

321 
d
->
max
 = 
	`muldiv32
(
a
->max, 
b
->max, 
c
->
mš
, &
r
);

322 ià(
r
) {

323 
d
->
max
++;

324 
d
->
İ’max
 = 1;

326 
d
->
İ’max
 = (
a
->İ’max || 
b
->İ’max || 
c
->
İ’mš
);

327 
d
->
š‹g”
 = 0;

328 
	}
}

331 
	$¢d_š‹rv®_muldivk
(cÚ¡ 
¢d_š‹rv®_t
 *
a
, cÚ¡ snd_š‹rv®_ˆ*
b
,

332 
k
, 
¢d_š‹rv®_t
 *
c
)

334 
r
;

335 ià(
a
->
em±y
 || 
b
->empty) {

336 
	`¢d_š‹rv®_nÚe
(
c
);

339 
c
->
em±y
 = 0;

340 
c
->
mš
 = 
	`muldiv32
(
a
->mš, 
b
->mš, 
k
, &
r
);

341 
c
->
İ’mš
 = (
r
 || 
a
->İ’mš || 
b
->openmin);

342 
c
->
max
 = 
	`muldiv32
(
a
->max, 
b
->max, 
k
, &
r
);

343 ià(
r
) {

344 
c
->
max
++;

345 
c
->
İ’max
 = 1;

347 
c
->
İ’max
 = (
a
->İ’max || 
b
->openmax);

348 
c
->
š‹g”
 = 0;

349 
	}
}

352 
	$¢d_š‹rv®_mulkdiv
(cÚ¡ 
¢d_š‹rv®_t
 *
a
, 
k
,

353 cÚ¡ 
¢d_š‹rv®_t
 *
b
, snd_š‹rv®_ˆ*
c
)

355 
r
;

356 ià(
a
->
em±y
 || 
b
->empty) {

357 
	`¢d_š‹rv®_nÚe
(
c
);

360 
c
->
em±y
 = 0;

361 
c
->
mš
 = 
	`muldiv32
(
a
->mš, 
k
, 
b
->
max
, &
r
);

362 
c
->
İ’mš
 = (
r
 || 
a
->İ’mš || 
b
->
İ’max
);

363 ià(
b
->
mš
 > 0) {

364 
c
->
max
 = 
	`muldiv32
(
a
->max, 
k
, 
b
->
mš
, &
r
);

365 ià(
r
) {

366 
c
->
max
++;

367 
c
->
İ’max
 = 1;

369 
c
->
İ’max
 = (
a
->İ’max || 
b
->
İ’mš
);

371 
c
->
max
 = 
UINT_MAX
;

372 
c
->
İ’max
 = 0;

374 
c
->
š‹g”
 = 0;

375 
	}
}

377 
	$¢d_š‹rv®_´št
(cÚ¡ 
¢d_š‹rv®_t
 *
i
, 
¢d_ouut_t
 *
out
)

379 ià(
	`¢d_š‹rv®_em±y
(
i
))

380 
	`¢d_ouut_´štf
(
out
, "NONE");

381 ià(
i
->
mš
 =ğ0 && i->
İ’mš
 == 0 &&

382 
i
->
max
 =ğ
UINT_MAX
 && i->
İ’max
 == 0)

383 
	`¢d_ouut_´štf
(
out
, "ALL");

384 ià(
	`¢d_š‹rv®_sšgË
(
i
è&& i->
š‹g”
)

385 
	`¢d_ouut_´štf
(
out
, "%u", 
	`¢d_š‹rv®_v®ue
(
i
));

387 
	`¢d_ouut_´štf
(
out
, "%c%u %u%c",

388 
i
->
İ’mš
 ? '(' : '[',

389 
i
->
mš
, i->
max
,

390 
i
->
İ’max
 ? ')' : ']');

391 
	}
}

394 
	$bound¬y_abs
(
a
, 
adœ
, *
b
, *
bdœ
)

396 ià(
a
 < 0 || (¨=ğ0 && 
adœ
 < 0)) {

397 *
b
 = -
a
;

398 *
bdœ
 = -
adœ
;

400 *
b
 = 
a
;

401 *
bdœ
 = 
adœ
;

403 
	}
}

406 
	$bound¬y_sub
(
a
, 
adœ
, 
b
, 
bdœ
, *
c
, *
cdœ
)

408 
adœ
 =‡dir < 0 ? -1 : (adir > 0 ? 1 : 0);

409 
bdœ
 = bdir < 0 ? -1 : (bdir > 0 ? 1 : 0);

410 *
c
 = 
a
 - 
b
;

411 *
cdœ
 = 
adœ
 - 
bdœ
;

412 ià(*
cdœ
 == -2) {

413 
	`as£¹
(*
c
 > 
INT_MIN
);

414 (*
c
)--;

415 } ià(*
cdœ
 == 2) {

416 
	`as£¹
(*
c
 < 
INT_MAX
);

417 (*
c
)++;

419 
	}
}

421 
	$bound¬y_É
(
a
, 
adœ
, 
b
, 
bdœ
)

423 
	`as£¹
(
a
 > 0 || 
adœ
 >= 0);

424 
	`as£¹
(
b
 > 0 || 
bdœ
 >= 0);

425 ià(
adœ
 < 0) {

426 
a
--;

427 
adœ
 = 1;

428 } ià(
adœ
 > 0)

429 
adœ
 = 1;

430 ià(
bdœ
 < 0) {

431 
b
--;

432 
bdœ
 = 1;

433 } ià(
bdœ
 > 0)

434 
bdœ
 = 1;

435  
a
 < 
b
 || (¨=ğb && 
adœ
 < 
bdœ
);

436 
	}
}

439 
	$bound¬y_Ã¬”
(
mš
, 
mšdœ
, 
be¡
, 
be¡dœ
, 
max
, 
maxdœ
)

441 
dmš
, 
dmšdœ
;

442 
dmax
, 
dmaxdœ
;

443 
	`bound¬y_sub
(
be¡
, 
be¡dœ
, 
mš
, 
mšdœ
, &
dmš
, &
dmšdœ
);

444 
	`bound¬y_sub
(
max
, 
maxdœ
, 
be¡
, 
be¡dœ
, &
dmax
, &
dmaxdœ
);

445  
	`bound¬y_É
(
dmš
, 
dmšdœ
, 
dmax
, 
dmaxdœ
);

446 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/interval.h

22 
_¢d_š‹rv®
 
	t¢d_š‹rv®_t
;

24 #ifdeà
SND_INTERVAL_INLINE


25 
	~"š‹rv®_šlše.h
"

27 
¢d_š‹rv®_ªy
(
¢d_š‹rv®_t
 *
i
);

28 
¢d_š‹rv®_nÚe
(
¢d_š‹rv®_t
 *
i
);

29 
¢d_š‹rv®_£tš‹g”
(
¢d_š‹rv®_t
 *
i
);

30 
¢d_š‹rv®_em±y
(cÚ¡ 
¢d_š‹rv®_t
 *
i
);

31 
¢d_š‹rv®_sšgË
(cÚ¡ 
¢d_š‹rv®_t
 *
i
);

32 
¢d_š‹rv®_v®ue
(cÚ¡ 
¢d_š‹rv®_t
 *
i
);

33 
¢d_š‹rv®_£t_v®ue
(
¢d_š‹rv®_t
 *
i
, 
v®
);

34 
¢d_š‹rv®_mš
(cÚ¡ 
¢d_š‹rv®_t
 *
i
);

35 
¢d_š‹rv®_max
(cÚ¡ 
¢d_š‹rv®_t
 *
i
);

36 
¢d_š‹rv®_£t_mšmax
(
¢d_š‹rv®_t
 *
i
, 
mš
, 
max
);

37 
¢d_š‹rv®_‹¡
(cÚ¡ 
¢d_š‹rv®_t
 *
i
, 
v®
);

38 
¢d_š‹rv®_cİy
(
¢d_š‹rv®_t
 *
d¡
, cÚ¡ snd_š‹rv®_ˆ*
¤c
);

39 
¢d_š‹rv®_æoÜ
(
¢d_š‹rv®_t
 *
i
);

40 
¢d_š‹rv®_unæoÜ
(
¢d_š‹rv®_t
 *
i
);

41 
¢d_š‹rv®_®ways_eq
(cÚ¡ 
¢d_š‹rv®_t
 *
i1
, cÚ¡ snd_š‹rv®_ˆ*
i2
);

42 
¢d_š‹rv®_Ãv”_eq
(cÚ¡ 
¢d_š‹rv®_t
 *
i1
, cÚ¡ snd_š‹rv®_ˆ*
i2
);

46 
	#¢d_š‹rv®_add
 
¢d1_š‹rv®_add


	)

47 
	#¢d_š‹rv®_sub
 
¢d1_š‹rv®_sub


	)

48 
	#¢d_š‹rv®_mul
 
¢d1_š‹rv®_mul


	)

49 
	#¢d_š‹rv®_div
 
¢d1_š‹rv®_div


	)

50 
	#¢d_š‹rv®_muldiv
 
¢d1_š‹rv®_muldiv


	)

51 
	#¢d_š‹rv®_muldivk
 
¢d1_š‹rv®_muldivk


	)

52 
	#¢d_š‹rv®_mulkdiv
 
¢d1_š‹rv®_mulkdiv


	)

53 
	#¢d_š‹rv®_´št
 
¢d1_š‹rv®_´št


	)

54 
	#¢d_š‹rv®_»fše_mš
 
¢d1_š‹rv®_»fše_mš


	)

55 
	#¢d_š‹rv®_»fše_max
 
¢d1_š‹rv®_»fše_max


	)

56 
	#¢d_š‹rv®_»fše
 
¢d1_š‹rv®_»fše


	)

57 
	#¢d_š‹rv®_»fše_fœ¡
 
¢d1_š‹rv®_»fše_fœ¡


	)

58 
	#¢d_š‹rv®_»fše_Ï¡
 
¢d1_š‹rv®_»fše_Ï¡


	)

59 
	#¢d_š‹rv®_»fše_£t
 
¢d1_š‹rv®_»fše_£t


	)

61 
¢d_š‹rv®_add
(cÚ¡ 
¢d_š‹rv®_t
 *
a
, cÚ¡ snd_š‹rv®_ˆ*
b
, snd_š‹rv®_ˆ*
c
);

62 
¢d_š‹rv®_sub
(cÚ¡ 
¢d_š‹rv®_t
 *
a
, cÚ¡ snd_š‹rv®_ˆ*
b
, snd_š‹rv®_ˆ*
c
);

63 
¢d_š‹rv®_mul
(cÚ¡ 
¢d_š‹rv®_t
 *
a
, cÚ¡ snd_š‹rv®_ˆ*
b
, snd_š‹rv®_ˆ*
c
);

64 
¢d_š‹rv®_div
(cÚ¡ 
¢d_š‹rv®_t
 *
a
, cÚ¡ snd_š‹rv®_ˆ*
b
, snd_š‹rv®_ˆ*
c
);

65 
¢d_š‹rv®_muldiv
(cÚ¡ 
¢d_š‹rv®_t
 *
a
, cÚ¡ snd_š‹rv®_ˆ*
b
,

66 cÚ¡ 
¢d_š‹rv®_t
 *
c
, snd_š‹rv®_ˆ*
d
);

67 
¢d_š‹rv®_muldivk
(cÚ¡ 
¢d_š‹rv®_t
 *
a
, cÚ¡ snd_š‹rv®_ˆ*
b
,

68 
k
, 
¢d_š‹rv®_t
 *
c
);

69 
¢d_š‹rv®_mulkdiv
(cÚ¡ 
¢d_š‹rv®_t
 *
a
, 
k
,

70 cÚ¡ 
¢d_š‹rv®_t
 *
b
, snd_š‹rv®_ˆ*
c
);

71 
¢d_š‹rv®_´št
(cÚ¡ 
¢d_š‹rv®_t
 *
i
, 
¢d_ouut_t
 *
out
);

72 
¢d_š‹rv®_»fše_mš
(
¢d_š‹rv®_t
 *
i
, 
mš
, 
İ’mš
);

73 
¢d_š‹rv®_»fše_max
(
¢d_š‹rv®_t
 *
i
, 
max
, 
İ’max
);

74 
¢d_š‹rv®_»fše
(
¢d_š‹rv®_t
 *
i
, cÚ¡ snd_š‹rv®_ˆ*
v
);

75 
¢d_š‹rv®_»fše_fœ¡
(
¢d_š‹rv®_t
 *
i
);

76 
¢d_š‹rv®_»fše_Ï¡
(
¢d_š‹rv®_t
 *
i
);

77 
¢d_š‹rv®_»fše_£t
(
¢d_š‹rv®_t
 *
i
, 
v®
);

78 
bound¬y_sub
(
a
, 
adœ
, 
b
, 
bdœ
, *
c
, *
cdœ
);

79 
bound¬y_É
(
a
, 
adœ
, 
b
, 
bdœ
);

80 
bound¬y_Ã¬”
(
mš
, 
mšdœ
, 
be¡
, 
be¡dœ
, 
max
, 
maxdœ
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/interval_inline.h

22 
	#INTERVAL_INLINE
 
šlše


	)

24 
INTERVAL_INLINE
 
	$¢d_š‹rv®_ªy
(
¢d_š‹rv®_t
 *
i
)

26 
i
->
mš
 = 0;

27 
i
->
İ’mš
 = 0;

28 
i
->
max
 = 
UINT_MAX
;

29 
i
->
İ’max
 = 0;

30 
i
->
š‹g”
 = 0;

31 
i
->
em±y
 = 0;

32 
	}
}

34 
INTERVAL_INLINE
 
	$¢d_š‹rv®_nÚe
(
¢d_š‹rv®_t
 *
i
)

36 
i
->
em±y
 = 1;

37 
	}
}

39 
INTERVAL_INLINE
 
	$¢d_š‹rv®_checkem±y
(cÚ¡ 
¢d_š‹rv®_t
 *
i
)

41  (
i
->
mš
 > i->
max
 ||

42 (
i
->
mš
 =ği->
max
 && (i->
İ’mš
 || i->
İ’max
)));

43 
	}
}

45 
INTERVAL_INLINE
 
	$¢d_š‹rv®_em±y
(cÚ¡ 
¢d_š‹rv®_t
 *
i
)

47  
i
->
em±y
;

48 
	}
}

50 
INTERVAL_INLINE
 
	$¢d_š‹rv®_sšgË
(cÚ¡ 
¢d_š‹rv®_t
 *
i
)

52 
	`as£¹
(!
	`¢d_š‹rv®_em±y
(
i
));

53  (
i
->
mš
 =ği->
max
 ||

54 (
i
->
mš
 + 1 =ği->
max
 && (i->
İ’mš
 || i->
İ’max
)));

55 
	}
}

57 
INTERVAL_INLINE
 
	$¢d_š‹rv®_v®ue
(cÚ¡ 
¢d_š‹rv®_t
 *
i
)

59 
	`as£¹
(
	`¢d_š‹rv®_sšgË
(
i
));

60 ià(
i
->
İ’mš
 && !i->
İ’max
)

61  
i
->
max
;

62  
i
->
mš
;

63 
	}
}

65 
INTERVAL_INLINE
 
	$¢d_š‹rv®_£t_v®ue
(
¢d_š‹rv®_t
 *
i
, 
v®
)

67 
i
->
İ’max
 = i->
İ’mš
 = 0;

68 
i
->
mš
 = i->
max
 = 
v®
;

69 
i
->
š‹g”
 = 0;

70 
i
->
em±y
 = 0;

71 
	}
}

73 
INTERVAL_INLINE
 
	$¢d_š‹rv®_mš
(cÚ¡ 
¢d_š‹rv®_t
 *
i
)

75 
	`as£¹
(!
	`¢d_š‹rv®_em±y
(
i
));

76  
i
->
mš
;

77 
	}
}

79 
INTERVAL_INLINE
 
	$¢d_š‹rv®_max
(cÚ¡ 
¢d_š‹rv®_t
 *
i
)

81 
	`as£¹
(!
	`¢d_š‹rv®_em±y
(
i
));

82  
i
->
max
;

83 
	}
}

85 
INTERVAL_INLINE
 
	$¢d_š‹rv®_£t_mšmax
(
¢d_š‹rv®_t
 *
i
, 
mš
, 
max
)

87 
i
->
İ’max
 = i->
İ’mš
 = 0;

88 
i
->
mš
 = min;

89 
i
->
max
 = max;

90 
i
->
š‹g”
 = 0;

91 
i
->
em±y
 = 0;

92 
	}
}

94 
INTERVAL_INLINE
 
	$¢d_š‹rv®_‹¡
(cÚ¡ 
¢d_š‹rv®_t
 *
i
, 
v®
)

96  !((
i
->
mš
 > 
v®
 || (i->mš =ğv® && i->
İ’mš
) ||

97 
i
->
max
 < 
v®
 || (i->max =ğv® && i->
İ’max
)));

98 
	}
}

100 
INTERVAL_INLINE
 
	$¢d_š‹rv®_cİy
(
¢d_š‹rv®_t
 *
d
, cÚ¡ snd_š‹rv®_ˆ*
s
)

102 *
d
 = *
s
;

103 
	}
}

105 
INTERVAL_INLINE
 
	$¢d_š‹rv®_£tš‹g”
(
¢d_š‹rv®_t
 *
i
)

107 ià(
i
->
š‹g”
)

109 ià(
i
->
İ’mš
 && i->
İ’max
 && i->
mš
 =ği->
max
)

110  -
EINVAL
;

111 
i
->
š‹g”
 = 1;

113 
	}
}

115 
INTERVAL_INLINE
 
	$¢d_š‹rv®_æoÜ
(
¢d_š‹rv®_t
 *
i
)

117 ià(
i
->
š‹g”
 || 
	`¢d_š‹rv®_em±y
(i))

119 
i
->
İ’mš
 = 0;

120 ià(
i
->
İ’max
) {

121 
i
->
max
--;

122 
i
->
İ’max
 = 0;

124 
i
->
š‹g”
 = 1;

125 
	}
}

127 
INTERVAL_INLINE
 
	$¢d_š‹rv®_unæoÜ
(
¢d_š‹rv®_t
 *
i
)

129 ià(
	`¢d_š‹rv®_em±y
(
i
))

131 ià(
i
->
max
 =ğ
UINT_MAX
)

133 ià(
i
->
İ’max
)

135 
i
->
max
++;

136 
i
->
İ’max
 = 1;

137 
i
->
š‹g”
 = 0;

138 
	}
}

141 
INTERVAL_INLINE
 
	$¢d_š‹rv®_®ways_eq
(cÚ¡ 
¢d_š‹rv®_t
 *
i1
, cÚ¡ snd_š‹rv®_ˆ*
i2
)

143  
	`¢d_š‹rv®_sšgË
(
i1
è&& snd_š‹rv®_sšgË(
i2
) &&

144 
	`¢d_š‹rv®_v®ue
(
i1
è=ğ¢d_š‹rv®_v®ue(
i2
);

145 
	}
}

147 
INTERVAL_INLINE
 
	$¢d_š‹rv®_Ãv”_eq
(cÚ¡ 
¢d_š‹rv®_t
 *
i1
, cÚ¡ snd_š‹rv®_ˆ*
i2
)

150  (
i1
->
max
 < 
i2
->
mš
 ||

151 (
i1
->
max
 =ğ
i2
->
mš
 &&

152 (
i1
->
İ’max
 || i1->
İ’mš
)) ||

153 
i1
->
mš
 > 
i2
->
max
 ||

154 (
i1
->
mš
 =ğ
i2
->
max
 &&

155 (
i1
->
İ’mš
 || 
i2
->
İ’max
)));

156 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/ladspa.h

22 #iâdeà
LADSPA_INCLUDED


23 
	#LADSPA_INCLUDED


	)

25 
	#LADSPA_VERSION
 "1.1"

	)

26 
	#LADSPA_VERSION_MAJOR
 1

	)

27 
	#LADSPA_VERSION_MINOR
 1

	)

29 #ifdeà
__ılu¥lus


84 
	tLADSPA_D©a
;

94 
	tLADSPA_Prİ”t›s
;

99 
	#LADSPA_PROPERTY_REALTIME
 0x1

	)

106 
	#LADSPA_PROPERTY_INPLACE_BROKEN
 0x2

	)

132 
	#LADSPA_PROPERTY_HARD_RT_CAPABLE
 0x4

	)

134 
	#LADSPA_IS_REALTIME
(
x
è((xè& 
LADSPA_PROPERTY_REALTIME
)

	)

135 
	#LADSPA_IS_INPLACE_BROKEN
(
x
è((xè& 
LADSPA_PROPERTY_INPLACE_BROKEN
)

	)

136 
	#LADSPA_IS_HARD_RT_CAPABLE
(
x
è((xè& 
LADSPA_PROPERTY_HARD_RT_CAPABLE
)

	)

152 
	tLADSPA_PÜtDesütÜ
;

155 
	#LADSPA_PORT_INPUT
 0x1

	)

158 
	#LADSPA_PORT_OUTPUT
 0x2

	)

162 
	#LADSPA_PORT_CONTROL
 0x4

	)

166 
	#LADSPA_PORT_AUDIO
 0x8

	)

168 
	#LADSPA_IS_PORT_INPUT
(
x
è((xè& 
LADSPA_PORT_INPUT
)

	)

169 
	#LADSPA_IS_PORT_OUTPUT
(
x
è((xè& 
LADSPA_PORT_OUTPUT
)

	)

170 
	#LADSPA_IS_PORT_CONTROL
(
x
è((xè& 
LADSPA_PORT_CONTROL
)

	)

171 
	#LADSPA_IS_PORT_AUDIO
(
x
è((xè& 
LADSPA_PORT_AUDIO
)

	)

200 
	tLADSPA_PÜtRªgeHštDesütÜ
;

208 
	#LADSPA_HINT_BOUNDED_BELOW
 0x1

	)

216 
	#LADSPA_HINT_BOUNDED_ABOVE
 0x2

	)

224 
	#LADSPA_HINT_TOGGLED
 0x4

	)

232 
	#LADSPA_HINT_SAMPLE_RATE
 0x8

	)

237 
	#LADSPA_HINT_LOGARITHMIC
 0x10

	)

245 
	#LADSPA_HINT_INTEGER
 0x20

	)

258 
	#LADSPA_HINT_DEFAULT_MASK
 0x3C0

	)

261 
	#LADSPA_HINT_DEFAULT_NONE
 0x0

	)

265 
	#LADSPA_HINT_DEFAULT_MINIMUM
 0x40

	)

272 
	#LADSPA_HINT_DEFAULT_LOW
 0x80

	)

279 
	#LADSPA_HINT_DEFAULT_MIDDLE
 0xC0

	)

286 
	#LADSPA_HINT_DEFAULT_HIGH
 0x100

	)

290 
	#LADSPA_HINT_DEFAULT_MAXIMUM
 0x140

	)

295 
	#LADSPA_HINT_DEFAULT_0
 0x200

	)

300 
	#LADSPA_HINT_DEFAULT_1
 0x240

	)

303 
	#LADSPA_HINT_DEFAULT_100
 0x280

	)

308 
	#LADSPA_HINT_DEFAULT_440
 0x2C0

	)

310 
	#LADSPA_IS_HINT_BOUNDED_BELOW
(
x
è((xè& 
LADSPA_HINT_BOUNDED_BELOW
)

	)

311 
	#LADSPA_IS_HINT_BOUNDED_ABOVE
(
x
è((xè& 
LADSPA_HINT_BOUNDED_ABOVE
)

	)

312 
	#LADSPA_IS_HINT_TOGGLED
(
x
è((xè& 
LADSPA_HINT_TOGGLED
)

	)

313 
	#LADSPA_IS_HINT_SAMPLE_RATE
(
x
è((xè& 
LADSPA_HINT_SAMPLE_RATE
)

	)

314 
	#LADSPA_IS_HINT_LOGARITHMIC
(
x
è((xè& 
LADSPA_HINT_LOGARITHMIC
)

	)

315 
	#LADSPA_IS_HINT_INTEGER
(
x
è((xè& 
LADSPA_HINT_INTEGER
)

	)

317 
	#LADSPA_IS_HINT_HAS_DEFAULT
(
x
è((xè& 
LADSPA_HINT_DEFAULT_MASK
)

	)

318 
	#LADSPA_IS_HINT_DEFAULT_MINIMUM
(
x
è(((xè& 
LADSPA_HINT_DEFAULT_MASK
) \

319 =ğ
LADSPA_HINT_DEFAULT_MINIMUM
)

	)

320 
	#LADSPA_IS_HINT_DEFAULT_LOW
(
x
è(((xè& 
LADSPA_HINT_DEFAULT_MASK
) \

321 =ğ
LADSPA_HINT_DEFAULT_LOW
)

	)

322 
	#LADSPA_IS_HINT_DEFAULT_MIDDLE
(
x
è(((xè& 
LADSPA_HINT_DEFAULT_MASK
) \

323 =ğ
LADSPA_HINT_DEFAULT_MIDDLE
)

	)

324 
	#LADSPA_IS_HINT_DEFAULT_HIGH
(
x
è(((xè& 
LADSPA_HINT_DEFAULT_MASK
) \

325 =ğ
LADSPA_HINT_DEFAULT_HIGH
)

	)

326 
	#LADSPA_IS_HINT_DEFAULT_MAXIMUM
(
x
è(((xè& 
LADSPA_HINT_DEFAULT_MASK
) \

327 =ğ
LADSPA_HINT_DEFAULT_MAXIMUM
)

	)

328 
	#LADSPA_IS_HINT_DEFAULT_0
(
x
è(((xè& 
LADSPA_HINT_DEFAULT_MASK
) \

329 =ğ
LADSPA_HINT_DEFAULT_0
)

	)

330 
	#LADSPA_IS_HINT_DEFAULT_1
(
x
è(((xè& 
LADSPA_HINT_DEFAULT_MASK
) \

331 =ğ
LADSPA_HINT_DEFAULT_1
)

	)

332 
	#LADSPA_IS_HINT_DEFAULT_100
(
x
è(((xè& 
LADSPA_HINT_DEFAULT_MASK
) \

333 =ğ
LADSPA_HINT_DEFAULT_100
)

	)

334 
	#LADSPA_IS_HINT_DEFAULT_440
(
x
è(((xè& 
LADSPA_HINT_DEFAULT_MASK
) \

335 =ğ
LADSPA_HINT_DEFAULT_440
)

	)

337 
	s_LADSPA_PÜtRªgeHšt
 {

340 
LADSPA_PÜtRªgeHštDesütÜ
 
HštDesütÜ
;

345 
LADSPA_D©a
 
Low”Bound
;

350 
LADSPA_D©a
 
Uµ”Bound
;

352 } 
	tLADSPA_PÜtRªgeHšt
;

363 * 
	tLADSPA_HªdË
;

373 
	s_LADSPA_DesütÜ
 {

379 
UniqueID
;

386 cÚ¡ * 
Lab–
;

389 
LADSPA_Prİ”t›s
 
Prİ”t›s
;

393 cÚ¡ * 
Name
;

397 cÚ¡ * 
Mak”
;

402 cÚ¡ * 
Cİyright
;

406 
PÜtCouÁ
;

410 cÚ¡ 
LADSPA_PÜtDesütÜ
 * 
PÜtDesütÜs
;

415 cÚ¡ * cÚ¡ * 
PÜtNames
;

419 cÚ¡ 
LADSPA_PÜtRªgeHšt
 * 
PÜtRªgeHšts
;

426 * 
Im¶em’tiÚD©a
;

437 
LADSPA_HªdË
 (*
š¡ªtŸ‹
)(cÚ¡ 
_LADSPA_DesütÜ
 * 
DesütÜ
,

438 
Sam¶eR©e
);

466 (*
cÚÃù_pÜt
)(
LADSPA_HªdË
 
In¡ªû
,

467 
PÜt
,

468 
LADSPA_D©a
 * 
D©aLoÿtiÚ
);

489 (*
aùiv©e
)(
LADSPA_HªdË
 
In¡ªû
);

505 (*
run
)(
LADSPA_HªdË
 
In¡ªû
,

506 
Sam¶eCouÁ
);

521 (*
run_addšg
)(
LADSPA_HªdË
 
In¡ªû
,

522 
Sam¶eCouÁ
);

533 (*
£t_run_addšg_gaš
)(
LADSPA_HªdË
 
In¡ªû
,

534 
LADSPA_D©a
 
Gaš
);

549 (*
d—ùiv©e
)(
LADSPA_HªdË
 
In¡ªû
);

558 (*
ş—nup
)(
LADSPA_HªdË
 
In¡ªû
);

560 } 
	tLADSPA_DesütÜ
;

589 cÚ¡ 
LADSPA_DesütÜ
 * 
Ïd¥a_desütÜ
(
Index
);

592 cÚ¡ 
	tLADSPA_DesütÜ
 *

593 (*
	tLADSPA_DesütÜ_FunùiÚ
)(
	tIndex
);

597 #ifdeà
__ılu¥lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/mask.c

22 
	#SND_MASK_C


	)

23 
	#SND_MASK_INLINE


	)

25 
	~"cÚfig.h
"

26 
	~<sys/ty³s.h
>

27 
	~<lim™s.h
>

28 
	~"pcm_loÿl.h
"

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/mask.h

22 
_¢d_mask
 
	t¢d_mask_t
;

24 
	#SND_MASK_MAX
 64

	)

26 #ifdeà
SND_MASK_INLINE


27 
	~"mask_šlše.h
"

29 
¢d_mask_nÚe
(
¢d_mask_t
 *
mask
);

30 
¢d_mask_ªy
(
¢d_mask_t
 *
mask
);

31 
¢d_mask_lßd
(
¢d_mask_t
 *
mask
, 
msk
);

32 
¢d_mask_em±y
(cÚ¡ 
¢d_mask_t
 *
mask
);

33 
¢d_mask_fuÎ
(cÚ¡ 
¢d_mask_t
 *
mask
);

34 
¢d_mask_£t
(
¢d_mask_t
 *
mask
, 
v®
);

35 
¢d_mask_»£t
(
¢d_mask_t
 *
mask
, 
v®
);

36 
¢d_mask_cİy
(
¢d_mask_t
 *
mask
, cÚ¡ snd_mask_ˆ*
v
);

37 
¢d_mask_‹¡
(cÚ¡ 
¢d_mask_t
 *
mask
, 
v®
);

38 
¢d_mask_š‹r£ù
(
¢d_mask_t
 *
mask
, cÚ¡ snd_mask_ˆ*
v
);

39 
¢d_mask_uniÚ
(
¢d_mask_t
 *
mask
, cÚ¡ snd_mask_ˆ*
v
);

40 
¢d_mask_couÁ
(cÚ¡ 
¢d_mask_t
 *
mask
);

41 
¢d_mask_mš
(cÚ¡ 
¢d_mask_t
 *
mask
);

42 
¢d_mask_max
(cÚ¡ 
¢d_mask_t
 *
mask
);

43 
¢d_mask_£t_¿nge
(
¢d_mask_t
 *
mask
, 
äom
, 
to
);

44 
¢d_mask_»£t_¿nge
(
¢d_mask_t
 *
mask
, 
äom
, 
to
);

45 
¢d_mask_Ëave
(
¢d_mask_t
 *
mask
, 
v®
);

46 
¢d_mask_eq
(cÚ¡ 
¢d_mask_t
 *
mask
, cÚ¡ snd_mask_ˆ*
v
);

47 
¢d_mask_sšgË
(cÚ¡ 
¢d_mask_t
 *
mask
);

48 
¢d_mask_»fše
(
¢d_mask_t
 *
mask
, cÚ¡ snd_mask_ˆ*
v
);

49 
¢d_mask_»fše_fœ¡
(
¢d_mask_t
 *
mask
);

50 
¢d_mask_»fše_Ï¡
(
¢d_mask_t
 *
mask
);

51 
¢d_mask_»fše_mš
(
¢d_mask_t
 *
mask
, 
v®
);

52 
¢d_mask_»fše_max
(
¢d_mask_t
 *
mask
, 
v®
);

53 
¢d_mask_»fše_£t
(
¢d_mask_t
 *
mask
, 
v®
);

54 
¢d_mask_v®ue
(cÚ¡ 
¢d_mask_t
 *
mask
);

55 
¢d_mask_®ways_eq
(cÚ¡ 
¢d_mask_t
 *
m1
, cÚ¡ snd_mask_ˆ*
m2
);

56 
¢d_mask_Ãv”_eq
(cÚ¡ 
¢d_mask_t
 *
m1
, cÚ¡ snd_mask_ˆ*
m2
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/mask_inline.h

22 
	~<¡ršgs.h
>

23 
	~<sys/ty³s.h
>

25 
	#MASK_INLINE
 
šlše


	)

27 
	#MASK_MAX
 
SND_MASK_MAX


	)

28 
	#MASK_SIZE
 (
MASK_MAX
 / 32)

	)

30 
	#MASK_OFS
(
i
è((iè>> 5)

	)

31 
	#MASK_BIT
(
i
è(1U << ((iè& 31))

	)

33 
MASK_INLINE
 
	$ld2
(
ušt32_t
 
v
)

35 
r
 = 0;

37 ià(
v
 >= 0x10000) {

38 
v
 >>= 16;

39 
r
 += 16;

41 ià(
v
 >= 0x100) {

42 
v
 >>= 8;

43 
r
 += 8;

45 ià(
v
 >= 0x10) {

46 
v
 >>= 4;

47 
r
 += 4;

49 ià(
v
 >= 4) {

50 
v
 >>= 2;

51 
r
 += 2;

53 ià(
v
 >= 2)

54 
r
++;

55  
r
;

56 
	}
}

58 
MASK_INLINE
 
	$hweight32
(
ušt32_t
 
v
)

60 
v
 = (v & 0x55555555) + ((v >> 1) & 0x55555555);

61 
v
 = (v & 0x33333333) + ((v >> 2) & 0x33333333);

62 
v
 = (v & 0x0F0F0F0F) + ((v >> 4) & 0x0F0F0F0F);

63 
v
 = (v & 0x00FF00FF) + ((v >> 8) & 0x00FF00FF);

64  (
v
 & 0x0000FFFF) + ((v >> 16) & 0x0000FFFF);

65 
	}
}

67 
MASK_INLINE
 
size_t
 
	$¢d_mask_sizeof
()

69  (
¢d_mask_t
);

70 
	}
}

72 
MASK_INLINE
 
	$¢d_mask_nÚe
(
¢d_mask_t
 *
mask
)

74 
	`mem£t
(
mask
, 0, (*mask));

75 
	}
}

77 
MASK_INLINE
 
	$¢d_mask_ªy
(
¢d_mask_t
 *
mask
)

79 
	`mem£t
(
mask
, 0xff, 
MASK_SIZE
 * (
ušt32_t
));

80 
	}
}

82 
MASK_INLINE
 
	$¢d_mask_em±y
(cÚ¡ 
¢d_mask_t
 *
mask
)

84 
i
;

85 
i
 = 0; i < 
MASK_SIZE
; i++)

86 ià(
mask
->
b™s
[
i
])

89 
	}
}

91 
MASK_INLINE
 
	$¢d_mask_fuÎ
(cÚ¡ 
¢d_mask_t
 *
mask
)

93 
i
;

94 
i
 = 0; i < 
MASK_SIZE
; i++)

95 ià(
mask
->
b™s
[
i
] != 0xffffffff)

98 
	}
}

100 
MASK_INLINE
 
	$¢d_mask_couÁ
(cÚ¡ 
¢d_mask_t
 *
mask
)

102 
i
, 
w
 = 0;

103 
i
 = 0; i < 
MASK_SIZE
; i++)

104 
w
 +ğ
	`hweight32
(
mask
->
b™s
[
i
]);

105  
w
;

106 
	}
}

108 
MASK_INLINE
 
	$¢d_mask_mš
(cÚ¡ 
¢d_mask_t
 *
mask
)

110 
i
;

111 
	`as£¹
(!
	`¢d_mask_em±y
(
mask
));

112 
i
 = 0; i < 
MASK_SIZE
; i++) {

113 ià(
mask
->
b™s
[
i
])

114  
	`ffs
(
mask
->
b™s
[
i
]) - 1 + (i << 5);

117 
	}
}

119 
MASK_INLINE
 
	$¢d_mask_max
(cÚ¡ 
¢d_mask_t
 *
mask
)

121 
i
;

122 
	`as£¹
(!
	`¢d_mask_em±y
(
mask
));

123 
i
 = 
MASK_SIZE
 - 1; i >= 0; i--) {

124 ià(
mask
->
b™s
[
i
])

125  
	`ld2
(
mask
->
b™s
[
i
]) + (i << 5);

128 
	}
}

130 
MASK_INLINE
 
	$¢d_mask_£t
(
¢d_mask_t
 *
mask
, 
v®
)

132 
	`as£¹
(
v®
 <ğ
SND_MASK_MAX
);

133 
mask
->
b™s
[
	`MASK_OFS
(
v®
)] |ğ
	`MASK_BIT
(val);

134 
	}
}

136 
MASK_INLINE
 
	$¢d_mask_»£t
(
¢d_mask_t
 *
mask
, 
v®
)

138 
	`as£¹
(
v®
 <ğ
SND_MASK_MAX
);

139 
mask
->
b™s
[
	`MASK_OFS
(
v®
)] &ğ~
	`MASK_BIT
(val);

140 
	}
}

142 
MASK_INLINE
 
	$¢d_mask_£t_¿nge
(
¢d_mask_t
 *
mask
, 
äom
, 
to
)

144 
i
;

145 
	`as£¹
(
to
 <ğ
SND_MASK_MAX
 && 
äom
 <=o);

146 
i
 = 
äom
; i <ğ
to
; i++)

147 
mask
->
b™s
[
	`MASK_OFS
(
i
)] |ğ
	`MASK_BIT
(i);

148 
	}
}

150 
MASK_INLINE
 
	$¢d_mask_»£t_¿nge
(
¢d_mask_t
 *
mask
, 
äom
, 
to
)

152 
i
;

153 
	`as£¹
(
to
 <ğ
SND_MASK_MAX
 && 
äom
 <=o);

154 
i
 = 
äom
; i <ğ
to
; i++)

155 
mask
->
b™s
[
	`MASK_OFS
(
i
)] &ğ~
	`MASK_BIT
(i);

156 
	}
}

158 
MASK_INLINE
 
	$¢d_mask_Ëave
(
¢d_mask_t
 *
mask
, 
v®
)

160 
v
;

161 
	`as£¹
(
v®
 <ğ
SND_MASK_MAX
);

162 
v
 = 
mask
->
b™s
[
	`MASK_OFS
(
v®
)] & 
	`MASK_BIT
(val);

163 
	`¢d_mask_nÚe
(
mask
);

164 
mask
->
b™s
[
	`MASK_OFS
(
v®
)] = 
v
;

165 
	}
}

167 
MASK_INLINE
 
	$¢d_mask_š‹r£ù
(
¢d_mask_t
 *
mask
, cÚ¡ snd_mask_ˆ*
v
)

169 
i
;

170 
i
 = 0; i < 
MASK_SIZE
; i++)

171 
mask
->
b™s
[
i
] &ğ
v
->bits[i];

172 
	}
}

174 
MASK_INLINE
 
	$¢d_mask_uniÚ
(
¢d_mask_t
 *
mask
, cÚ¡ snd_mask_ˆ*
v
)

176 
i
;

177 
i
 = 0; i < 
MASK_SIZE
; i++)

178 
mask
->
b™s
[
i
] |ğ
v
->bits[i];

179 
	}
}

181 
MASK_INLINE
 
	$¢d_mask_eq
(cÚ¡ 
¢d_mask_t
 *
mask
, cÚ¡ snd_mask_ˆ*
v
)

183  ! 
	`memcmp
(
mask
, 
v
, 
MASK_SIZE
 * 4);

184 
	}
}

186 
MASK_INLINE
 
	$¢d_mask_cİy
(
¢d_mask_t
 *
mask
, cÚ¡ snd_mask_ˆ*
v
)

188 *
mask
 = *
v
;

189 
	}
}

191 
MASK_INLINE
 
	$¢d_mask_‹¡
(cÚ¡ 
¢d_mask_t
 *
mask
, 
v®
)

193 
	`as£¹
(
v®
 <ğ
SND_MASK_MAX
);

194  
mask
->
b™s
[
	`MASK_OFS
(
v®
)] & 
	`MASK_BIT
(val);

195 
	}
}

197 
MASK_INLINE
 
	$¢d_mask_sšgË
(cÚ¡ 
¢d_mask_t
 *
mask
)

199 
i
, 
c
 = 0;

200 
	`as£¹
(!
	`¢d_mask_em±y
(
mask
));

201 
i
 = 0; i < 
MASK_SIZE
; i++) {

202 ià(! 
mask
->
b™s
[
i
])

204 ià(
mask
->
b™s
[
i
] & (mask->bits[i] - 1))

206 ià(
c
)

208 
c
++;

211 
	}
}

213 
MASK_INLINE
 
	$¢d_mask_»fše
(
¢d_mask_t
 *
mask
, cÚ¡ snd_mask_ˆ*
v
)

215 
¢d_mask_t
 
Şd
;

216 ià(
	`¢d_mask_em±y
(
mask
))

217  -
ENOENT
;

218 
	`¢d_mask_cİy
(&
Şd
, 
mask
);

219 
	`¢d_mask_š‹r£ù
(
mask
, 
v
);

220 ià(
	`¢d_mask_em±y
(
mask
))

221  -
EINVAL
;

222  !
	`¢d_mask_eq
(
mask
, &
Şd
);

223 
	}
}

225 
MASK_INLINE
 
	$¢d_mask_»fše_fœ¡
(
¢d_mask_t
 *
mask
)

227 ià(
	`¢d_mask_em±y
(
mask
))

228  -
ENOENT
;

229 ià(
	`¢d_mask_sšgË
(
mask
))

231 
	`¢d_mask_Ëave
(
mask
, 
	`¢d_mask_mš
(mask));

233 
	}
}

235 
MASK_INLINE
 
	$¢d_mask_»fše_Ï¡
(
¢d_mask_t
 *
mask
)

237 ià(
	`¢d_mask_em±y
(
mask
))

238  -
ENOENT
;

239 ià(
	`¢d_mask_sšgË
(
mask
))

241 
	`¢d_mask_Ëave
(
mask
, 
	`¢d_mask_max
(mask));

243 
	}
}

245 
MASK_INLINE
 
	$¢d_mask_»fše_mš
(
¢d_mask_t
 *
mask
, 
v®
)

247 ià(
	`¢d_mask_em±y
(
mask
))

248  -
ENOENT
;

249 ià(
	`¢d_mask_mš
(
mask
è>ğ
v®
)

251 
	`¢d_mask_»£t_¿nge
(
mask
, 0, 
v®
 - 1);

252 ià(
	`¢d_mask_em±y
(
mask
))

253  -
EINVAL
;

255 
	}
}

257 
MASK_INLINE
 
	$¢d_mask_»fše_max
(
¢d_mask_t
 *
mask
, 
v®
)

259 ià(
	`¢d_mask_em±y
(
mask
))

260  -
ENOENT
;

261 ià(
	`¢d_mask_max
(
mask
è<ğ
v®
)

263 
	`¢d_mask_»£t_¿nge
(
mask
, 
v®
 + 1, 
SND_MASK_MAX
);

264 ià(
	`¢d_mask_em±y
(
mask
))

265  -
EINVAL
;

267 
	}
}

269 
MASK_INLINE
 
	$¢d_mask_»fše_£t
(
¢d_mask_t
 *
mask
, 
v®
)

271 
chªged
;

272 ià(
	`¢d_mask_em±y
(
mask
))

273  -
ENOENT
;

274 
chªged
 = !
	`¢d_mask_sšgË
(
mask
);

275 
	`¢d_mask_Ëave
(
mask
, 
v®
);

276 ià(
	`¢d_mask_em±y
(
mask
))

277  -
EINVAL
;

278  
chªged
;

279 
	}
}

281 
MASK_INLINE
 
	$¢d_mask_v®ue
(cÚ¡ 
¢d_mask_t
 *
mask
)

283 
	`as£¹
(!
	`¢d_mask_em±y
(
mask
));

284  
	`¢d_mask_mš
(
mask
);

285 
	}
}

287 
MASK_INLINE
 
	$¢d_mask_®ways_eq
(cÚ¡ 
¢d_mask_t
 *
m1
, cÚ¡ snd_mask_ˆ*
m2
)

289  
	`¢d_mask_sšgË
(
m1
è&& snd_mask_sšgË(
m2
) &&

290 
	`¢d_mask_v®ue
(
m1
è=ğ¢d_mask_v®ue(
m2
);

291 
	}
}

293 
MASK_INLINE
 
	$¢d_mask_Ãv”_eq
(cÚ¡ 
¢d_mask_t
 *
m1
, cÚ¡ snd_mask_ˆ*
m2
)

295 
i
;

296 
i
 = 0; i < 
MASK_SIZE
; i++)

297 ià(
m1
->
b™s
[
i
] & 
m2
->bits[i])

300 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm.c

671 
	~"pcm_loÿl.h
"

672 
	~<¡dio.h
>

673 
	~<¡ršg.h
>

674 #ià
HAVE_MALLOC_H


675 
	~<m®loc.h
>

677 
	~<¡d¬g.h
>

678 
	~<sigÇl.h
>

679 
	~<ùy³.h
>

680 
	~<pŞl.h
>

681 
	~<sys/mmª.h
>

682 
	~<lim™s.h
>

684 #iâdeà
DOC_HIDDEN


686 
	$pcm_¡©e_to_”rÜ
(
¢d_pcm_¡©e_t
 
¡©e
)

688 
¡©e
) {

689 
SND_PCM_STATE_XRUN
:

690  -
EPIPE
;

691 
SND_PCM_STATE_SUSPENDED
:

692  -
ESTRPIPE
;

693 
SND_PCM_STATE_DISCONNECTED
:

694  -
ENODEV
;

698 
	}
}

700 
	#P_STATE
(
x
è(1U << 
SND_PCM_STATE_
 ## x)

	)

701 
	#P_STATE_RUNNABLE
 (
	`P_STATE
(
PREPARED
) | \

702 
	`P_STATE
(
RUNNING
) | \

703 
	`P_STATE
(
XRUN
) | \

704 
	`P_STATE
(
PAUSED
) | \

705 
	`P_STATE
(
DRAINING
))

	)

708 
	$bad_pcm_¡©e
(
¢d_pcm_t
 *
pcm
, 
suµÜ‹d_¡©es
,

709 
noİ_¡©es
)

711 
¢d_pcm_¡©e_t
 
¡©e
;

712 
”r
;

714 ià(
pcm
->
own_¡©e_check
)

716 
¡©e
 = 
	`¢d_pcm_¡©e
(
pcm
);

717 ià(
noİ_¡©es
 & (1U << 
¡©e
))

719 ià(
suµÜ‹d_¡©es
 & (1U << 
¡©e
))

721 
”r
 = 
	`pcm_¡©e_to_”rÜ
(
¡©e
);

722 ià(
”r
 < 0)

723  
”r
;

724  -
EBADFD
;

725 
	}
}

736 cÚ¡ *
	$¢d_pcm_Çme
(
¢d_pcm_t
 *
pcm
)

738 
	`as£¹
(
pcm
);

739  
pcm
->
Çme
;

740 
	}
}

749 
¢d_pcm_ty³_t
 
	$¢d_pcm_ty³
(
¢d_pcm_t
 *
pcm
)

751 
	`as£¹
(
pcm
);

752  
pcm
->
ty³
;

753 
	}
}

762 
¢d_pcm_¡»am_t
 
	$¢d_pcm_¡»am
(
¢d_pcm_t
 *
pcm
)

764 
	`as£¹
(
pcm
);

765  
pcm
->
¡»am
;

766 
	}
}

776 
	$¢d_pcm_şo£
(
¢d_pcm_t
 *
pcm
)

778 
»s
 = 0, 
”r
;

779 
	`as£¹
(
pcm
);

780 ià(
pcm
->
£tup
 && !pcm->
dÚÙ_şo£
) {

781 
	`¢d_pcm_drİ
(
pcm
);

782 
”r
 = 
	`¢d_pcm_hw_ä“
(
pcm
);

783 ià(
”r
 < 0)

784 
»s
 = 
”r
;

786 ià(
pcm
->
mm­_chªÃls
)

787 
	`¢d_pcm_munm­
(
pcm
);

788 !
	`li¡_em±y
(&
pcm
->
async_hªdËrs
)) {

789 
¢d_async_hªdËr_t
 *
h
 = 
	`li¡_’Œy
(
pcm
->
async_hªdËrs
.
Ãxt
, snd_async_hªdËr_t, 
hli¡
);

790 
	`¢d_async_d–_hªdËr
(
h
);

792 ià(
pcm
->
İs
->
şo£
)

793 
”r
 = 
pcm
->
İs
->
	`şo£
Õcm->
İ_¬g
);

795 
”r
 = -
ENOSYS
;

796 ià(
”r
 < 0)

797 
»s
 = 
”r
;

798 
”r
 = 
	`¢d_pcm_ä“
(
pcm
);

799 ià(
”r
 < 0)

800 
»s
 = 
”r
;

801  
»s
;

802 
	}
}

812 
	$¢d_pcm_nÚblock
(
¢d_pcm_t
 *
pcm
, 
nÚblock
)

814 
”r
 = 0;

816 
	`as£¹
(
pcm
);

821 ià(
pcm
->
İs
->
nÚblock
)

822 
”r
 = 
pcm
->
İs
->
	`nÚblock
Õcm->
İ_¬g
, 
nÚblock
);

824 
”r
 = -
ENOSYS
;

825 ià(
”r
 < 0)

826 
uÆock
;

827 ià(
nÚblock
 == 2) {

828 
pcm
->
mode
 |ğ
SND_PCM_ABORT
;

829 
uÆock
;

831 ià(
nÚblock
)

832 
pcm
->
mode
 |ğ
SND_PCM_NONBLOCK
;

834 ià(
pcm
->
hw_æags
 & 
SND_PCM_HW_PARAMS_NO_PERIOD_WAKEUP
)

835 
”r
 = -
EINVAL
;

837 
pcm
->
mode
 &ğ~
SND_PCM_NONBLOCK
;

839 
uÆock
:

841  
”r
;

842 
	}
}

844 #iâdeà
DOC_HIDDEN


854 
	$¢d_pcm_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
)

856 
”r
 = 0;

858 
	`as£¹
(
pcm
);

859 ià(
sig
 == 0)

860 
sig
 = 
SIGIO
;

861 ià(
pid
 == 0)

862 
pid
 = 
	`g‘pid
();

864 #ifdeà
THREAD_SAFE_API


866 
pcm
->
lock_’abËd
 = 0;

868 ià(
pcm
->
İs
->
async
)

869 
”r
 = 
pcm
->
İs
->
	`async
Õcm->
İ_¬g
, 
sig
, 
pid
);

871 
”r
 = -
ENOSYS
;

872  
”r
;

873 
	}
}

882 
	$¢d_pcm_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_šfo_t
 *
šfo
)

884 
”r
 = 0;

886 
	`as£¹
(
pcm
 && 
šfo
);

887 ià(
pcm
->
İs
->
šfo
)

888 
”r
 = 
pcm
->
İs
->
	`šfo
Õcm->
İ_¬g
, 
šfo
);

890 
”r
 = -
ENOSYS
;

891  
”r
;

892 
	}
}

900 
	$¢d_pcm_hw_·¿ms_cu¼’t
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

902 
äame_b™s
;

904 
	`as£¹
(
pcm
 && 
·¿ms
);

905 ià(!
pcm
->
£tup
)

906  -
EBADFD
;

907 
	`mem£t
(
·¿ms
, 0, 
	`¢d_pcm_hw_·¿ms_sizeof
());

908 
·¿ms
->
æags
 = 
pcm
->
hw_æags
;

909 
	`¢d_mask_£t
(&
·¿ms
->
masks
[
SND_PCM_HW_PARAM_ACCESS
 - 
SND_PCM_HW_PARAM_FIRST_MASK
], 
pcm
->
acûss
);

910 
	`¢d_mask_£t
(&
·¿ms
->
masks
[
SND_PCM_HW_PARAM_FORMAT
 - 
SND_PCM_HW_PARAM_FIRST_MASK
], 
pcm
->
fÜm©
);

911 
	`¢d_mask_£t
(&
·¿ms
->
masks
[
SND_PCM_HW_PARAM_SUBFORMAT
 - 
SND_PCM_HW_PARAM_FIRST_MASK
], 
pcm
->
subfÜm©
);

912 
äame_b™s
 = 
	`¢d_pcm_fÜm©_physiÿl_width
(
pcm
->
fÜm©
è*…cm->
chªÃls
;

913 
	`¢d_š‹rv®_£t_v®ue
(&
·¿ms
->
š‹rv®s
[
SND_PCM_HW_PARAM_FRAME_BITS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], 
äame_b™s
);

914 
	`¢d_š‹rv®_£t_v®ue
(&
·¿ms
->
š‹rv®s
[
SND_PCM_HW_PARAM_CHANNELS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], 
pcm
->
chªÃls
);

915 
	`¢d_š‹rv®_£t_v®ue
(&
·¿ms
->
š‹rv®s
[
SND_PCM_HW_PARAM_RATE
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], 
pcm
->
¿‹
);

916 
	`¢d_š‹rv®_£t_v®ue
(&
·¿ms
->
š‹rv®s
[
SND_PCM_HW_PARAM_PERIOD_TIME
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], 
pcm
->
³riod_time
);

917 
	`¢d_š‹rv®_£t_v®ue
(&
·¿ms
->
š‹rv®s
[
SND_PCM_HW_PARAM_PERIOD_SIZE
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], 
pcm
->
³riod_size
);

918 
	`¢d_š‹rv®_cİy
(&
·¿ms
->
š‹rv®s
[
SND_PCM_HW_PARAM_PERIODS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], &
pcm
->
³riods
);

919 
	`¢d_š‹rv®_cİy
(&
·¿ms
->
š‹rv®s
[
SND_PCM_HW_PARAM_BUFFER_TIME
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], &
pcm
->
bufãr_time
);

920 
	`¢d_š‹rv®_£t_v®ue
(&
·¿ms
->
š‹rv®s
[
SND_PCM_HW_PARAM_BUFFER_SIZE
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], 
pcm
->
bufãr_size
);

921 
	`¢d_š‹rv®_£t_v®ue
(&
·¿ms
->
š‹rv®s
[
SND_PCM_HW_PARAM_BUFFER_BYTES
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], (
pcm
->
bufãr_size
 * 
äame_b™s
) / 8);

922 
·¿ms
->
šfo
 = 
pcm
->info;

923 
·¿ms
->
msb™s
 = 
pcm
->msbits;

924 
·¿ms
->
¿‹_num
 = 
pcm
->rate_num;

925 
·¿ms
->
¿‹_d’
 = 
pcm
->rate_den;

926 
·¿ms
->
fifo_size
 = 
pcm
->fifo_size;

928 
	}
}

951 
	$¢d_pcm_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

953 
”r
;

954 
	`as£¹
(
pcm
 && 
·¿ms
);

955 
”r
 = 
	`_¢d_pcm_hw_·¿ms_š‹º®
(
pcm
, 
·¿ms
);

956 ià(
”r
 < 0)

957  
”r
;

958 
”r
 = 
	`¢d_pcm_´•¬e
(
pcm
);

959  
”r
;

960 
	}
}

968 
	$¢d_pcm_hw_ä“
(
¢d_pcm_t
 *
pcm
)

970 
”r
;

971 ià(! 
pcm
->
£tup
)

973 ià(
pcm
->
mm­_chªÃls
) {

974 
”r
 = 
	`¢d_pcm_munm­
(
pcm
);

975 ià(
”r
 < 0)

976  
”r
;

980 ià(
pcm
->
İs
->
hw_ä“
)

981 
”r
 = 
pcm
->
İs
->
	`hw_ä“
Õcm->
İ_¬g
);

983 
”r
 = -
ENOSYS
;

984 
pcm
->
£tup
 = 0;

985 ià(
”r
 < 0)

986  
”r
;

988 
	}
}

1001 
	$¢d_pcm_sw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
)

1003 
”r
;

1005 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1006 
	`SNDMSG
("PCM‚ot set up");

1007  -
EIO
;

1009 ià(! 
·¿ms
->
ava_mš
) {

1010 
	`SNDMSG
("params->avail_min is 0");

1011  -
EINVAL
;

1017 ià(
·¿ms
->
¡¬t_th»shŞd
 <ğ
pcm
->
bufãr_size
 &&

1018 
·¿ms
->
¡¬t_th»shŞd
 > (
pcm
->
bufãr_size
 /…¬ams->
ava_mš
) *…arams->avail_min) {

1019 
	`SNDMSG
("params->avail_min…roblem for start_threshold");

1020  -
EINVAL
;

1023 
	`__¢d_pcm_lock
(
pcm
->
İ_¬g
);

1024 ià(
pcm
->
İs
->
sw_·¿ms
)

1025 
”r
 = 
pcm
->
İs
->
	`sw_·¿ms
Õcm->
İ_¬g
, 
·¿ms
);

1027 
”r
 = -
ENOSYS
;

1028 ià(
”r
 < 0) {

1029 
	`__¢d_pcm_uÆock
(
pcm
->
İ_¬g
);

1030  
”r
;

1032 
pcm
->
t¡amp_mode
 = 
·¿ms
->tstamp_mode;

1033 
pcm
->
t¡amp_ty³
 = 
·¿ms
->tstamp_type;

1034 
pcm
->
³riod_¡•
 = 
·¿ms
->period_step;

1035 
pcm
->
ava_mš
 = 
·¿ms
->avail_min;

1036 
pcm
->
³riod_ev’t
 = 
	`sw_g‘_³riod_ev’t
(
·¿ms
);

1037 
pcm
->
¡¬t_th»shŞd
 = 
·¿ms
->start_threshold;

1038 
pcm
->
¡İ_th»shŞd
 = 
·¿ms
->stop_threshold;

1039 
pcm
->
s’û_th»shŞd
 = 
·¿ms
->silence_threshold;

1040 
pcm
->
s’û_size
 = 
·¿ms
->silence_size;

1041 
pcm
->
bound¬y
 = 
·¿ms
->boundary;

1042 
	`__¢d_pcm_uÆock
(
pcm
->
İ_¬g
);

1044 
	}
}

1054 
	$¢d_pcm_¡©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©us_t
 *
¡©us
)

1056 
”r
;

1058 
	`as£¹
(
pcm
 && 
¡©us
);

1059 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1060 ià(
pcm
->
ç¡_İs
->
¡©us
)

1061 
”r
 = 
pcm
->
ç¡_İs
->
	`¡©us
Õcm->
ç¡_İ_¬g
, 
¡©us
);

1063 
”r
 = -
ENOSYS
;

1064 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1066  
”r
;

1067 
	}
}

1083 
¢d_pcm_¡©e_t
 
	$¢d_pcm_¡©e
(
¢d_pcm_t
 *
pcm
)

1085 
¢d_pcm_¡©e_t
 
¡©e
;

1087 
	`as£¹
(
pcm
);

1088 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1089 
¡©e
 = 
	`__¢d_pcm_¡©e
(
pcm
);

1090 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1091  
¡©e
;

1092 
	}
}

1107 
	$¢d_pcm_hwsync
(
¢d_pcm_t
 *
pcm
)

1109 
”r
;

1111 
	`as£¹
(
pcm
);

1112 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1113 
	`SNDMSG
("PCM‚ot set up");

1114  -
EIO
;

1116 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1117 
”r
 = 
	`__¢d_pcm_hwsync
(
pcm
);

1118 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1119  
”r
;

1120 
	}
}

1152 
	$¢d_pcm_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
)

1154 
”r
;

1156 
	`as£¹
(
pcm
);

1157 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1158 
	`SNDMSG
("PCM‚ot set up");

1159  -
EIO
;

1161 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1162 
”r
 = 
	`__¢d_pcm_d–ay
(
pcm
, 
d–ayp
);

1163 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1164  
”r
;

1165 
	}
}

1181 
	$¢d_pcm_»sume
(
¢d_pcm_t
 *
pcm
)

1183 
”r
 = 0;

1185 
	`as£¹
(
pcm
);

1186 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1187 
	`SNDMSG
("PCM‚ot set up");

1188  -
EIO
;

1191 ià(
pcm
->
ç¡_İs
->
»sume
)

1192 
”r
 = 
pcm
->
ç¡_İs
->
	`»sume
Õcm->
ç¡_İ_¬g
);

1194 
”r
 = -
ENOSYS
;

1195  
”r
;

1196 
	}
}

1210 
	$¢d_pcm_htime¡amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 *
ava
, 
¢d_htime¡amp_t
 *
t¡amp
)

1212 
”r
;

1214 
	`as£¹
(
pcm
);

1215 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1216 
	`SNDMSG
("PCM‚ot set up");

1217  -
EIO
;

1219 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1220 ià(
pcm
->
ç¡_İs
->
htime¡amp
)

1221 
”r
 = 
pcm
->
ç¡_İs
->
	`htime¡amp
Õcm->
ç¡_İ_¬g
, 
ava
, 
t¡amp
);

1223 
”r
 = -
ENOSYS
;

1224 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1225  
”r
;

1226 
	}
}

1235 
	$¢d_pcm_´•¬e
(
¢d_pcm_t
 *
pcm
)

1237 
”r
;

1239 
	`as£¹
(
pcm
);

1240 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1241 
	`SNDMSG
("PCM‚ot set up");

1242  -
EIO
;

1244 
”r
 = 
	`bad_pcm_¡©e
(
pcm
, ~
	`P_STATE
(
DISCONNECTED
), 0);

1245 ià(
”r
 < 0)

1246  
”r
;

1247 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1248 ià(
pcm
->
ç¡_İs
->
´•¬e
)

1249 
”r
 = 
pcm
->
ç¡_İs
->
	`´•¬e
Õcm->
ç¡_İ_¬g
);

1251 
”r
 = -
ENOSYS
;

1252 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1253  
”r
;

1254 
	}
}

1265 
	$¢d_pcm_»£t
(
¢d_pcm_t
 *
pcm
)

1267 
”r
;

1269 
	`as£¹
(
pcm
);

1270 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1271 
	`SNDMSG
("PCM‚ot set up");

1272  -
EIO
;

1274 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1275 ià(
pcm
->
ç¡_İs
->
»£t
)

1276 
”r
 = 
pcm
->
ç¡_İs
->
	`»£t
Õcm->
ç¡_İ_¬g
);

1278 
”r
 = -
ENOSYS
;

1279 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1280  
”r
;

1281 
	}
}

1290 
	$¢d_pcm_¡¬t
(
¢d_pcm_t
 *
pcm
)

1292 
”r
;

1294 
	`as£¹
(
pcm
);

1295 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1296 
	`SNDMSG
("PCM‚ot set up");

1297  -
EIO
;

1299 
”r
 = 
	`bad_pcm_¡©e
(
pcm
, 
	`P_STATE
(
PREPARED
), 0);

1300 ià(
”r
 < 0)

1301  
”r
;

1302 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1303 
”r
 = 
	`__¢d_pcm_¡¬t
(
pcm
);

1304 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1305  
”r
;

1306 
	}
}

1321 
	$¢d_pcm_drİ
(
¢d_pcm_t
 *
pcm
)

1323 
”r
;

1325 
	`as£¹
(
pcm
);

1326 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1327 
	`SNDMSG
("PCM‚ot set up");

1328  -
EIO
;

1330 
”r
 = 
	`bad_pcm_¡©e
(
pcm
, 
P_STATE_RUNNABLE
 | 
	`P_STATE
(
SETUP
) |

1331 
	`P_STATE
(
SUSPENDED
), 0);

1332 ià(
”r
 < 0)

1333  
”r
;

1334 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1335 ià(
pcm
->
ç¡_İs
->
drİ
)

1336 
”r
 = 
pcm
->
ç¡_İs
->
	`drİ
Õcm->
ç¡_İ_¬g
);

1338 
”r
 = -
ENOSYS
;

1339 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1340  
”r
;

1341 
	}
}

1358 
	$¢d_pcm_d¿š
(
¢d_pcm_t
 *
pcm
)

1360 
”r
;

1362 
	`as£¹
(
pcm
);

1363 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1364 
	`SNDMSG
("PCM‚ot set up");

1365  -
EIO
;

1367 
”r
 = 
	`bad_pcm_¡©e
(
pcm
, 
P_STATE_RUNNABLE
 | 
	`P_STATE
(
SETUP
), P_STATE(SETUP));

1368 ià(
”r
 < 0)

1369  
”r
;

1370 ià(
”r
 == 1)

1373 ià(
pcm
->
ç¡_İs
->
d¿š
)

1374 
”r
 = 
pcm
->
ç¡_İs
->
	`d¿š
Õcm->
ç¡_İ_¬g
);

1376 
”r
 = -
ENOSYS
;

1377  
”r
;

1378 
	}
}

1392 
	$¢d_pcm_·u£
(
¢d_pcm_t
 *
pcm
, 
’abË
)

1394 
”r
;

1396 
	`as£¹
(
pcm
);

1397 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1398 
	`SNDMSG
("PCM‚ot set up");

1399  -
EIO
;

1401 
”r
 = 
	`bad_pcm_¡©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1402 ià(
”r
 < 0)

1403  
”r
;

1404 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1405 ià(
pcm
->
ç¡_İs
->
·u£
)

1406 
”r
 = 
pcm
->
ç¡_İs
->
	`·u£
Õcm->
ç¡_İ_¬g
, 
’abË
);

1408 
”r
 = -
ENOSYS
;

1409 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1410  
”r
;

1411 
	}
}

1424 
¢d_pcm_säames_t
 
	$¢d_pcm_»wšdabË
(
¢d_pcm_t
 *
pcm
)

1426 
¢d_pcm_säames_t
 
»suÉ
;

1427 
”r
;

1429 
	`as£¹
(
pcm
);

1430 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1431 
	`SNDMSG
("PCM‚ot set up");

1432  -
EIO
;

1434 
”r
 = 
	`bad_pcm_¡©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1435 ià(
”r
 < 0)

1436  
”r
;

1437 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1438 ià(
pcm
->
ç¡_İs
->
»wšdabË
)

1439 
»suÉ
 = 
pcm
->
ç¡_İs
->
	`»wšdabË
Õcm->
ç¡_İ_¬g
);

1441 
»suÉ
 = -
ENOSYS
;

1442 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1443  
»suÉ
;

1444 
	}
}

1455 
¢d_pcm_säames_t
 
	$¢d_pcm_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

1457 
¢d_pcm_säames_t
 
»suÉ
;

1458 
”r
;

1460 
	`as£¹
(
pcm
);

1461 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1462 
	`SNDMSG
("PCM‚ot set up");

1463  -
EIO
;

1465 ià(
äames
 == 0)

1467 
”r
 = 
	`bad_pcm_¡©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1468 ià(
”r
 < 0)

1469  
”r
;

1470 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1471 ià(
pcm
->
ç¡_İs
->
»wšd
)

1472 
»suÉ
 = 
pcm
->
ç¡_İs
->
	`»wšd
Õcm->
ç¡_İ_¬g
, 
äames
);

1474 
»suÉ
 = -
ENOSYS
;

1475 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1476  
»suÉ
;

1477 
	}
}

1490 
¢d_pcm_säames_t
 
	$¢d_pcm_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
)

1492 
¢d_pcm_säames_t
 
»suÉ
;

1493 
”r
;

1495 
	`as£¹
(
pcm
);

1496 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1497 
	`SNDMSG
("PCM‚ot set up");

1498  -
EIO
;

1500 
”r
 = 
	`bad_pcm_¡©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1501 ià(
”r
 < 0)

1502  
”r
;

1503 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1504 ià(
pcm
->
ç¡_İs
->
fÜw¬dabË
)

1505 
»suÉ
 = 
pcm
->
ç¡_İs
->
	`fÜw¬dabË
Õcm->
ç¡_İ_¬g
);

1507 
»suÉ
 = -
ENOSYS
;

1508 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1509  
»suÉ
;

1510 
	}
}

1521 #iâdeà
DOXYGEN


1522 
EXPORT_SYMBOL
 
¢d_pcm_säames_t
 
	$INTERNAL
(
¢d_pcm_fÜw¬d
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

1524 
¢d_pcm_säames_t
 
	$¢d_pcm_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

1527 
¢d_pcm_säames_t
 
»suÉ
;

1528 
”r
;

1530 
	`as£¹
(
pcm
);

1531 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1532 
	`SNDMSG
("PCM‚ot set up");

1533  -
EIO
;

1535 ià(
äames
 == 0)

1537 
”r
 = 
	`bad_pcm_¡©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1538 ià(
”r
 < 0)

1539  
”r
;

1540 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1541 ià(
pcm
->
ç¡_İs
->
fÜw¬d
)

1542 
»suÉ
 = 
pcm
->
ç¡_İs
->
	`fÜw¬d
Õcm->
ç¡_İ_¬g
, 
äames
);

1544 
»suÉ
 = -
ENOSYS
;

1545 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1546  
»suÉ
;

1547 
	}
}

1548 
u£_deçuÉ_symbŞ_v”siÚ
(
__¢d_pcm_fÜw¬d
, 
¢d_pcm_fÜw¬d
, 
ALSA_0
.9.0
rc8
);

1569 
¢d_pcm_säames_t
 
	$¢d_pcm_wr™ei
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

1571 
”r
;

1573 
	`as£¹
(
pcm
);

1574 
	`as£¹
(
size
 =ğ0 || 
bufãr
);

1575 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1576 
	`SNDMSG
("PCM‚ot set up");

1577  -
EIO
;

1579 ià(
pcm
->
acûss
 !ğ
SND_PCM_ACCESS_RW_INTERLEAVED
) {

1580 
	`SNDMSG
("šv®id‡cûs ty³ %s", 
	`¢d_pcm_acûss_Çme
(
pcm
->
acûss
));

1581  -
EINVAL
;

1583 
”r
 = 
	`bad_pcm_¡©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1584 ià(
”r
 < 0)

1585  
”r
;

1586  
	`_¢d_pcm_wr™ei
(
pcm
, 
bufãr
, 
size
);

1587 
	}
}

1608 
¢d_pcm_säames_t
 
	$¢d_pcm_wr™’
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

1610 
”r
;

1612 
	`as£¹
(
pcm
);

1613 
	`as£¹
(
size
 =ğ0 || 
bufs
);

1614 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1615 
	`SNDMSG
("PCM‚ot set up");

1616  -
EIO
;

1618 ià(
pcm
->
acûss
 !ğ
SND_PCM_ACCESS_RW_NONINTERLEAVED
) {

1619 
	`SNDMSG
("šv®id‡cûs ty³ %s", 
	`¢d_pcm_acûss_Çme
(
pcm
->
acûss
));

1620  -
EINVAL
;

1622 
”r
 = 
	`bad_pcm_¡©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1623 ià(
”r
 < 0)

1624  
”r
;

1625  
	`_¢d_pcm_wr™’
(
pcm
, 
bufs
, 
size
);

1626 
	}
}

1647 
¢d_pcm_säames_t
 
	$¢d_pcm_»adi
(
¢d_pcm_t
 *
pcm
, *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

1649 
”r
;

1651 
	`as£¹
(
pcm
);

1652 
	`as£¹
(
size
 =ğ0 || 
bufãr
);

1653 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1654 
	`SNDMSG
("PCM‚ot set up");

1655  -
EIO
;

1657 ià(
pcm
->
acûss
 !ğ
SND_PCM_ACCESS_RW_INTERLEAVED
) {

1658 
	`SNDMSG
("šv®id‡cûs ty³ %s", 
	`¢d_pcm_acûss_Çme
(
pcm
->
acûss
));

1659  -
EINVAL
;

1661 
”r
 = 
	`bad_pcm_¡©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1662 ià(
”r
 < 0)

1663  
”r
;

1664  
	`_¢d_pcm_»adi
(
pcm
, 
bufãr
, 
size
);

1665 
	}
}

1686 
¢d_pcm_säames_t
 
	$¢d_pcm_»adn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

1688 
”r
;

1690 
	`as£¹
(
pcm
);

1691 
	`as£¹
(
size
 =ğ0 || 
bufs
);

1692 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1693 
	`SNDMSG
("PCM‚ot set up");

1694  -
EIO
;

1696 ià(
pcm
->
acûss
 !ğ
SND_PCM_ACCESS_RW_NONINTERLEAVED
) {

1697 
	`SNDMSG
("šv®id‡cûs ty³ %s", 
	`¢d_pcm_acûss_Çme
(
pcm
->
acûss
));

1698  -
EINVAL
;

1700 
”r
 = 
	`bad_pcm_¡©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1701 ià(
”r
 < 0)

1702  
”r
;

1703  
	`_¢d_pcm_»adn
(
pcm
, 
bufs
, 
size
);

1704 
	}
}

1714 
	$¢d_pcm_lšk
(
¢d_pcm_t
 *
pcm1
, snd_pcm_ˆ*
pcm2
)

1716 
”r
 = 0;

1718 
	`as£¹
(
pcm1
);

1719 
	`as£¹
(
pcm2
);

1720 ià(
pcm1
->
ç¡_İs
->
lšk
)

1721 
”r
 = 
pcm1
->
ç¡_İs
->
	`lšk
Õcm1->
ç¡_İ_¬g
, 
pcm2
);

1723 
”r
 = -
ENOSYS
;

1724  
”r
;

1725 
	}
}

1732 
	$¢d_pcm_uÆšk
(
¢d_pcm_t
 *
pcm
)

1734 
”r
 = 0;

1736 
	`as£¹
(
pcm
);

1737 ià(
pcm
->
ç¡_İs
->
uÆšk
)

1738 
”r
 = 
pcm
->
ç¡_İs
->
	`uÆšk
Õcm->
ç¡_İ_¬g
);

1740 
”r
 = -
ENOSYS
;

1741  
”r
;

1742 
	}
}

1745 
	$__¢d_pcm_pŞl_desütÜs_couÁ
(
¢d_pcm_t
 *
pcm
)

1747 ià(
pcm
->
ç¡_İs
->
pŞl_desütÜs_couÁ
)

1748  
pcm
->
ç¡_İs
->
	`pŞl_desütÜs_couÁ
Õcm->
ç¡_İ_¬g
);

1749  
pcm
->
pŞl_fd_couÁ
;

1750 
	}
}

1759 
	$¢d_pcm_pŞl_desütÜs_couÁ
(
¢d_pcm_t
 *
pcm
)

1761 
couÁ
;

1763 
	`as£¹
(
pcm
);

1764 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1765 
couÁ
 = 
	`__¢d_pcm_pŞl_desütÜs_couÁ
(
pcm
);

1766 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1767  
couÁ
;

1768 
	}
}

1771 
	$__¢d_pcm_pŞl_desütÜs
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
,

1772 
¥aû
)

1774 ià(
pcm
->
ç¡_İs
->
pŞl_desütÜs
)

1775  
pcm
->
ç¡_İs
->
	`pŞl_desütÜs
Õcm->
ç¡_İ_¬g
, 
pfds
, 
¥aû
);

1776 ià(
pcm
->
pŞl_fd
 < 0) {

1777 
	`SNDMSG
("poll_fd < 0");

1778  -
EIO
;

1780 ià(
¥aû
 >ğ1 && 
pfds
) {

1781 
pfds
->
fd
 = 
pcm
->
pŞl_fd
;

1782 
pfds
->
ev’ts
 = 
pcm
->
pŞl_ev’ts
 | 
POLLERR
 | 
POLLNVAL
;

1787 
	}
}

1823 
	$¢d_pcm_pŞl_desütÜs
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
¥aû
)

1825 
”r
;

1827 
	`as£¹
(
pcm
 && 
pfds
);

1828 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1829 
”r
 = 
	`__¢d_pcm_pŞl_desütÜs
(
pcm
, 
pfds
, 
¥aû
);

1830 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1831  
”r
;

1832 
	}
}

1834 
__¢d_pcm_pŞl_»v’ts
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
,

1835 
nfds
, *
»v’ts
);

1865 
	$¢d_pcm_pŞl_desütÜs_»v’ts
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

1867 
”r
;

1869 
	`as£¹
(
pcm
 && 
pfds
 && 
»v’ts
);

1870 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

1871 
”r
 = 
	`__¢d_pcm_pŞl_»v’ts
(
pcm
, 
pfds
, 
nfds
, 
»v’ts
);

1872 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

1873  
”r
;

1874 
	}
}

1876 
	$__¢d_pcm_pŞl_»v’ts
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
,

1877 
nfds
, *
»v’ts
)

1879 ià(
pcm
->
ç¡_İs
->
pŞl_»v’ts
)

1880  
pcm
->
ç¡_İs
->
	`pŞl_»v’ts
Õcm->
ç¡_İ_¬g
, 
pfds
, 
nfds
, 
»v’ts
);

1881 ià(
nfds
 == 1) {

1882 *
»v’ts
 = 
pfds
->revents;

1885  -
EINVAL
;

1886 
	}
}

1888 #iâdeà
DOC_HIDDEN


1889 
	#PCMTYPE
(
v
è[
SND_PCM_TYPE_
##v] = #v

	)

1890 
	#STATE
(
v
è[
SND_PCM_STATE_
##v] = #v

	)

1891 
	#STREAM
(
v
è[
SND_PCM_STREAM_
##v] = #v

	)

1892 
	#READY
(
v
è[
SND_PCM_READY_
##v] = #v

	)

1893 
	#XRUN
(
v
è[
SND_PCM_XRUN_
##v] = #v

	)

1894 
	#SILENCE
(
v
è[
SND_PCM_SILENCE_
##v] = #v

	)

1895 
	#TSTAMP
(
v
è[
SND_PCM_TSTAMP_
##v] = #v

	)

1896 
	#TSTAMP_TYPE
(
v
è[
SND_PCM_TSTAMP_TYPE_
##v] = #v

	)

1897 
	#ACCESS
(
v
è[
SND_PCM_ACCESS_
##v] = #v

	)

1898 
	#START
(
v
è[
SND_PCM_START_
##v] = #v

	)

1899 
	#HW_PARAM
(
v
è[
SND_PCM_HW_PARAM_
##v] = #v

	)

1900 
	#SW_PARAM
(
v
è[
SND_PCM_SW_PARAM_
##v] = #v

	)

1901 
	#FORMAT
(
v
è[
SND_PCM_FORMAT_
##v] = #v

	)

1902 
	#SUBFORMAT
(
v
è[
SND_PCM_SUBFORMAT_
##v] = #v

	)

1904 
	#FORMATD
(
v
, 
d
è[
SND_PCM_FORMAT_
##v] = 
	)
d

1905 
	#SUBFORMATD
(
v
, 
d
è[
SND_PCM_SUBFORMAT_
##v] = 
	)
d

1908 cÚ¡ *cÚ¡ 
	g¢d_pcm_¡»am_Çmes
[] = {

1909 
STREAM
(
PLAYBACK
),

1910 
STREAM
(
CAPTURE
),

1913 cÚ¡ *cÚ¡ 
	g¢d_pcm_¡©e_Çmes
[] = {

1914 
STATE
(
OPEN
),

1915 
STATE
(
SETUP
),

1916 
STATE
(
PREPARED
),

1917 
STATE
(
RUNNING
),

1918 
STATE
(
XRUN
),

1919 
STATE
(
DRAINING
),

1920 
STATE
(
PAUSED
),

1921 
STATE
(
SUSPENDED
),

1922 
STATE
(
DISCONNECTED
),

1925 cÚ¡ *cÚ¡ 
	g¢d_pcm_acûss_Çmes
[] = {

1926 
ACCESS
(
MMAP_INTERLEAVED
),

1927 
ACCESS
(
MMAP_NONINTERLEAVED
),

1928 
ACCESS
(
MMAP_COMPLEX
),

1929 
ACCESS
(
RW_INTERLEAVED
),

1930 
ACCESS
(
RW_NONINTERLEAVED
),

1933 cÚ¡ *cÚ¡ 
	g¢d_pcm_fÜm©_Çmes
[] = {

1934 
FORMAT
(
S8
),

1935 
FORMAT
(
U8
),

1936 
FORMAT
(
S16_LE
),

1937 
FORMAT
(
S16_BE
),

1938 
FORMAT
(
U16_LE
),

1939 
FORMAT
(
U16_BE
),

1940 
FORMAT
(
S24_LE
),

1941 
FORMAT
(
S24_BE
),

1942 
FORMAT
(
U24_LE
),

1943 
FORMAT
(
U24_BE
),

1944 
FORMAT
(
S32_LE
),

1945 
FORMAT
(
S32_BE
),

1946 
FORMAT
(
U32_LE
),

1947 
FORMAT
(
U32_BE
),

1948 
FORMAT
(
FLOAT_LE
),

1949 
FORMAT
(
FLOAT_BE
),

1950 
FORMAT
(
FLOAT64_LE
),

1951 
FORMAT
(
FLOAT64_BE
),

1952 
FORMAT
(
IEC958_SUBFRAME_LE
),

1953 
FORMAT
(
IEC958_SUBFRAME_BE
),

1954 
FORMAT
(
MU_LAW
),

1955 
FORMAT
(
A_LAW
),

1956 
FORMAT
(
IMA_ADPCM
),

1957 
FORMAT
(
MPEG
),

1958 
FORMAT
(
GSM
),

1959 
FORMAT
(
S20_LE
),

1960 
FORMAT
(
S20_BE
),

1961 
FORMAT
(
U20_LE
),

1962 
FORMAT
(
U20_BE
),

1963 
FORMAT
(
SPECIAL
),

1964 
FORMAT
(
S24_3LE
),

1965 
FORMAT
(
S24_3BE
),

1966 
FORMAT
(
U24_3LE
),

1967 
FORMAT
(
U24_3BE
),

1968 
FORMAT
(
S20_3LE
),

1969 
FORMAT
(
S20_3BE
),

1970 
FORMAT
(
U20_3LE
),

1971 
FORMAT
(
U20_3BE
),

1972 
FORMAT
(
S18_3LE
),

1973 
FORMAT
(
S18_3BE
),

1974 
FORMAT
(
U18_3LE
),

1975 
FORMAT
(
U18_3BE
),

1976 
FORMAT
(
G723_24
),

1977 
FORMAT
(
G723_24_1B
),

1978 
FORMAT
(
G723_40
),

1979 
FORMAT
(
G723_40_1B
),

1980 
FORMAT
(
DSD_U8
),

1981 
FORMAT
(
DSD_U16_LE
),

1982 
FORMAT
(
DSD_U32_LE
),

1983 
FORMAT
(
DSD_U16_BE
),

1984 
FORMAT
(
DSD_U32_BE
),

1987 cÚ¡ *cÚ¡ 
	g¢d_pcm_fÜm©_®Ÿ£s
[
SND_PCM_FORMAT_LAST
+1] = {

1988 
FORMAT
(
S16
),

1989 
FORMAT
(
U16
),

1990 
FORMAT
(
S24
),

1991 
FORMAT
(
U24
),

1992 
FORMAT
(
S32
),

1993 
FORMAT
(
U32
),

1994 
FORMAT
(
FLOAT
),

1995 
FORMAT
(
FLOAT64
),

1996 
FORMAT
(
IEC958_SUBFRAME
),

1997 
FORMAT
(
S20
),

1998 
FORMAT
(
U20
),

2001 cÚ¡ *cÚ¡ 
	g¢d_pcm_fÜm©_desütiÚs
[] = {

2002 
FORMATD
(
S8
, "Signed 8 bit"),

2003 
FORMATD
(
U8
, "Unsigned 8 bit"),

2004 
FORMATD
(
S16_LE
, "Signed 16 bit Little Endian"),

2005 
FORMATD
(
S16_BE
, "Signed 16 bit Big Endian"),

2006 
FORMATD
(
U16_LE
, "Unsigned 16 bit Little Endian"),

2007 
FORMATD
(
U16_BE
, "Unsigned 16 bit Big Endian"),

2008 
FORMATD
(
S24_LE
, "Signed 24 bit Little Endian"),

2009 
FORMATD
(
S24_BE
, "Signed 24 bit Big Endian"),

2010 
FORMATD
(
U24_LE
, "Unsigned 24 bit Little Endian"),

2011 
FORMATD
(
U24_BE
, "Unsigned 24 bit Big Endian"),

2012 
FORMATD
(
S32_LE
, "Signed 32 bit Little Endian"),

2013 
FORMATD
(
S32_BE
, "Signed 32 bit Big Endian"),

2014 
FORMATD
(
U32_LE
, "Unsigned 32 bit Little Endian"),

2015 
FORMATD
(
U32_BE
, "Unsigned 32 bit Big Endian"),

2016 
FORMATD
(
FLOAT_LE
, "Float 32 bit Little Endian"),

2017 
FORMATD
(
FLOAT_BE
, "Float 32 bit Big Endian"),

2018 
FORMATD
(
FLOAT64_LE
, "Float 64 bit Little Endian"),

2019 
FORMATD
(
FLOAT64_BE
, "Float 64 bit Big Endian"),

2020 
FORMATD
(
IEC958_SUBFRAME_LE
, "IEC-958 Little Endian"),

2021 
FORMATD
(
IEC958_SUBFRAME_BE
, "IEC-958 Big Endian"),

2022 
FORMATD
(
MU_LAW
, "Mu-Law"),

2023 
FORMATD
(
A_LAW
, "A-Law"),

2024 
FORMATD
(
IMA_ADPCM
, "Ima-ADPCM"),

2025 
FORMATD
(
MPEG
, "MPEG"),

2026 
FORMATD
(
GSM
, "GSM"),

2027 
FORMATD
(
S20_LE
, "Signed 20 bit Little Endian in 4 bytes, LSB justified"),

2028 
FORMATD
(
S20_BE
, "Signed 20 bit Big Endian in 4 bytes, LSB justified"),

2029 
FORMATD
(
U20_LE
, "Unsigned 20 bit Little Endian in 4 bytes, LSB justified"),

2030 
FORMATD
(
U20_BE
, "Unsigned 20 bit Big Endian in 4 bytes, LSB justified"),

2031 
FORMATD
(
SPECIAL
, "Special"),

2032 
FORMATD
(
S24_3LE
, "Signed 24 bit Little Endian in 3bytes"),

2033 
FORMATD
(
S24_3BE
, "Signed 24 bit Big Endian in 3bytes"),

2034 
FORMATD
(
U24_3LE
, "Unsigned 24 bit Little Endian in 3bytes"),

2035 
FORMATD
(
U24_3BE
, "Unsigned 24 bit Big Endian in 3bytes"),

2036 
FORMATD
(
S20_3LE
, "Signed 20 bit Little Endian in 3bytes"),

2037 
FORMATD
(
S20_3BE
, "Signed 20 bit Big Endian in 3bytes"),

2038 
FORMATD
(
U20_3LE
, "Unsigned 20 bit Little Endian in 3bytes"),

2039 
FORMATD
(
U20_3BE
, "Unsigned 20 bit Big Endian in 3bytes"),

2040 
FORMATD
(
S18_3LE
, "Signed 18 bit Little Endian in 3bytes"),

2041 
FORMATD
(
S18_3BE
, "Signed 18 bit Big Endian in 3bytes"),

2042 
FORMATD
(
U18_3LE
, "Unsigned 18 bit Little Endian in 3bytes"),

2043 
FORMATD
(
U18_3BE
, "Unsigned 18 bit Big Endian in 3bytes"),

2044 
FORMATD
(
G723_24
, "G.723 (ADPCM) 24 kbit/s, 8 samples in 3 bytes"),

2045 
FORMATD
(
G723_24_1B
, "G.723 (ADPCM) 24 kbit/s, 1 sample in 1 byte"),

2046 
FORMATD
(
G723_40
, "G.723 (ADPCM) 40 kbit/s, 8 samples in 3 bytes"),

2047 
FORMATD
(
G723_40_1B
, "G.723 (ADPCM) 40 kbit/s, 1 sample in 1 byte"),

2048 
FORMATD
(
DSD_U8
, "Direct Stream Digital, 1-byte (x8), oldest bit in MSB"),

2049 
FORMATD
(
DSD_U16_LE
, "Direct Stream Digital, 2-byte (x16),†ittleƒndian, oldest bits in MSB"),

2050 
FORMATD
(
DSD_U32_LE
, "Direct Stream Digital, 4-byte (x32),†ittleƒndian, oldest bits in MSB"),

2051 
FORMATD
(
DSD_U16_BE
, "Direct Stream Digital, 2-byte (x16), bigƒndian, oldest bits in MSB"),

2052 
FORMATD
(
DSD_U32_BE
, "Direct Stream Digital, 4-byte (x32), bigƒndian, oldest bits in MSB"),

2055 cÚ¡ *cÚ¡ 
	g¢d_pcm_ty³_Çmes
[] = {

2056 
PCMTYPE
(
HW
),

2057 
PCMTYPE
(
HOOKS
),

2058 
PCMTYPE
(
MULTI
),

2059 
PCMTYPE
(
FILE
),

2060 
PCMTYPE
(
NULL
),

2061 
PCMTYPE
(
SHM
),

2062 
PCMTYPE
(
INET
),

2063 
PCMTYPE
(
COPY
),

2064 
PCMTYPE
(
LINEAR
),

2065 
PCMTYPE
(
ALAW
),

2066 
PCMTYPE
(
MULAW
),

2067 
PCMTYPE
(
ADPCM
),

2068 
PCMTYPE
(
RATE
),

2069 
PCMTYPE
(
ROUTE
),

2070 
PCMTYPE
(
PLUG
),

2071 
PCMTYPE
(
SHARE
),

2072 
PCMTYPE
(
METER
),

2073 
PCMTYPE
(
MIX
),

2074 
PCMTYPE
(
DROUTE
),

2075 
PCMTYPE
(
LBSERVER
),

2076 
PCMTYPE
(
LINEAR_FLOAT
),

2077 
PCMTYPE
(
LADSPA
),

2078 
PCMTYPE
(
DMIX
),

2079 
PCMTYPE
(
JACK
),

2080 
PCMTYPE
(
DSNOOP
),

2081 
PCMTYPE
(
IEC958
),

2082 
PCMTYPE
(
SOFTVOL
),

2083 
PCMTYPE
(
IOPLUG
),

2084 
PCMTYPE
(
EXTPLUG
),

2085 
PCMTYPE
(
MMAP_EMUL
),

2088 cÚ¡ *cÚ¡ 
	g¢d_pcm_subfÜm©_Çmes
[] = {

2089 
SUBFORMAT
(
STD
),

2090 
SUBFORMAT
(
MSBITS_MAX
),

2091 
SUBFORMAT
(
MSBITS_20
),

2092 
SUBFORMAT
(
MSBITS_24
),

2095 cÚ¡ *cÚ¡ 
	g¢d_pcm_subfÜm©_desütiÚs
[] = {

2096 
SUBFORMATD
(
STD
, "Standard"),

2097 
SUBFORMATD
(
MSBITS_MAX
, "Maximum based on PCM format"),

2098 
SUBFORMATD
(
MSBITS_20
, "20 most significant bits"),

2099 
SUBFORMATD
(
MSBITS_24
, "24 most significant bits"),

2102 cÚ¡ *cÚ¡ 
	g¢d_pcm_¡¬t_mode_Çmes
[] = {

2103 
START
(
EXPLICIT
),

2104 
START
(
DATA
),

2107 cÚ¡ *cÚ¡ 
	g¢d_pcm_xrun_mode_Çmes
[] = {

2108 
XRUN
(
NONE
),

2109 
XRUN
(
STOP
),

2112 cÚ¡ *cÚ¡ 
	g¢d_pcm_t¡amp_mode_Çmes
[] = {

2113 
TSTAMP
(
NONE
),

2114 
TSTAMP
(
ENABLE
),

2117 cÚ¡ *cÚ¡ 
	g¢d_pcm_t¡amp_ty³_Çmes
[] = {

2118 
TSTAMP_TYPE
(
GETTIMEOFDAY
),

2119 
TSTAMP_TYPE
(
MONOTONIC
),

2120 
TSTAMP_TYPE
(
MONOTONIC_RAW
),

2129 cÚ¡ *
	$¢d_pcm_¡»am_Çme
(cÚ¡ 
¢d_pcm_¡»am_t
 
¡»am
)

2131 ià(
¡»am
 > 
SND_PCM_STREAM_LAST
)

2132  
NULL
;

2133  
¢d_pcm_¡»am_Çmes
[
¡»am
];

2134 
	}
}

2141 cÚ¡ *
	$¢d_pcm_acûss_Çme
(cÚ¡ 
¢d_pcm_acûss_t
 
acc
)

2143 ià(
acc
 > 
SND_PCM_ACCESS_LAST
)

2144  
NULL
;

2145  
¢d_pcm_acûss_Çmes
[
acc
];

2146 
	}
}

2153 cÚ¡ *
	$¢d_pcm_fÜm©_Çme
(cÚ¡ 
¢d_pcm_fÜm©_t
 
fÜm©
)

2155 ià(
fÜm©
 > 
SND_PCM_FORMAT_LAST
)

2156  
NULL
;

2157  
¢d_pcm_fÜm©_Çmes
[
fÜm©
];

2158 
	}
}

2165 cÚ¡ *
	$¢d_pcm_fÜm©_desütiÚ
(cÚ¡ 
¢d_pcm_fÜm©_t
 
fÜm©
)

2167 ià(
fÜm©
 > 
SND_PCM_FORMAT_LAST
)

2168  
NULL
;

2169  
¢d_pcm_fÜm©_desütiÚs
[
fÜm©
];

2170 
	}
}

2177 
¢d_pcm_fÜm©_t
 
	$¢d_pcm_fÜm©_v®ue
(cÚ¡ * 
Çme
)

2179 
¢d_pcm_fÜm©_t
 
fÜm©
;

2180 
fÜm©
 = 0; fÜm© <ğ
SND_PCM_FORMAT_LAST
; format++) {

2181 ià(
¢d_pcm_fÜm©_Çmes
[
fÜm©
] &&

2182 
	`¡rÿ£cmp
(
Çme
, 
¢d_pcm_fÜm©_Çmes
[
fÜm©
]) == 0) {

2183  
fÜm©
;

2185 ià(
¢d_pcm_fÜm©_®Ÿ£s
[
fÜm©
] &&

2186 
	`¡rÿ£cmp
(
Çme
, 
¢d_pcm_fÜm©_®Ÿ£s
[
fÜm©
]) == 0) {

2187  
fÜm©
;

2190 
fÜm©
 = 0; fÜm© <ğ
SND_PCM_FORMAT_LAST
; format++) {

2191 ià(
¢d_pcm_fÜm©_desütiÚs
[
fÜm©
] &&

2192 
	`¡rÿ£cmp
(
Çme
, 
¢d_pcm_fÜm©_desütiÚs
[
fÜm©
]) == 0) {

2193  
fÜm©
;

2196  
SND_PCM_FORMAT_UNKNOWN
;

2197 
	}
}

2204 cÚ¡ *
	$¢d_pcm_subfÜm©_Çme
(cÚ¡ 
¢d_pcm_subfÜm©_t
 
subfÜm©
)

2206 ià(
subfÜm©
 > 
SND_PCM_SUBFORMAT_LAST
)

2207  
NULL
;

2208  
¢d_pcm_subfÜm©_Çmes
[
subfÜm©
];

2209 
	}
}

2216 cÚ¡ *
	$¢d_pcm_subfÜm©_desütiÚ
(cÚ¡ 
¢d_pcm_subfÜm©_t
 
subfÜm©
)

2218 ià(
subfÜm©
 > 
SND_PCM_SUBFORMAT_LAST
)

2219  
NULL
;

2220  
¢d_pcm_subfÜm©_desütiÚs
[
subfÜm©
];

2221 
	}
}

2228 
¢d_pcm_subfÜm©_t
 
	$¢d_pcm_subfÜm©_v®ue
(cÚ¡ * 
Çme
)

2230 
¢d_pcm_subfÜm©_t
 
subfÜm©
;

2232 
subfÜm©
 = 0; subfÜm© <ğ
SND_PCM_SUBFORMAT_LAST
; subformat++) {

2233 ià(
¢d_pcm_subfÜm©_Çmes
[
subfÜm©
] &&

2234 !
	`¡rÿ£cmp
(
Çme
, 
¢d_pcm_subfÜm©_Çmes
[
subfÜm©
]))

2235  
subfÜm©
;

2238 
subfÜm©
 = 0; subfÜm© <ğ
SND_PCM_SUBFORMAT_LAST
; subformat++) {

2239 ià(
¢d_pcm_subfÜm©_desütiÚs
[
subfÜm©
] &&

2240 !
	`¡rÿ£cmp
(
Çme
, 
¢d_pcm_subfÜm©_desütiÚs
[
subfÜm©
]))

2241  
subfÜm©
;

2244  
SND_PCM_SUBFORMAT_UNKNOWN
;

2245 
	}
}

2252 cÚ¡ *
	$¢d_pcm_¡¬t_mode_Çme
(
¢d_pcm_¡¬t_t
 
mode
)

2254 ià(
mode
 > 
SND_PCM_START_LAST
)

2255  
NULL
;

2256  
¢d_pcm_¡¬t_mode_Çmes
[
mode
];

2257 
	}
}

2259 #iâdeà
DOC_HIDDEN


2260 
lšk_w¬nšg
(
¢d_pcm_¡¬t_mode_Çme
, "Warning: start_mode is deprecated, considero use start_threshold");

2268 cÚ¡ *
	$¢d_pcm_xrun_mode_Çme
(
¢d_pcm_xrun_t
 
mode
)

2270 ià(
mode
 > 
SND_PCM_XRUN_LAST
)

2271  
NULL
;

2272  
¢d_pcm_xrun_mode_Çmes
[
mode
];

2273 
	}
}

2275 #iâdeà
DOC_HIDDEN


2276 
lšk_w¬nšg
(
¢d_pcm_xrun_mode_Çme
, "Warning: xrun_mode is deprecated, considero use stop_threshold");

2284 cÚ¡ *
	$¢d_pcm_t¡amp_mode_Çme
(cÚ¡ 
¢d_pcm_t¡amp_t
 
mode
)

2286 ià(
mode
 > 
SND_PCM_TSTAMP_LAST
)

2287  
NULL
;

2288  
¢d_pcm_t¡amp_mode_Çmes
[
mode
];

2289 
	}
}

2296 cÚ¡ *
	$¢d_pcm_t¡amp_ty³_Çme
(
¢d_pcm_t¡amp_ty³_t
 
ty³
)

2298 ià(
ty³
 > 
SND_PCM_TSTAMP_TYPE_LAST
)

2299  
NULL
;

2300  
¢d_pcm_t¡amp_ty³_Çmes
[
ty³
];

2301 
	}
}

2308 cÚ¡ *
	$¢d_pcm_¡©e_Çme
(cÚ¡ 
¢d_pcm_¡©e_t
 
¡©e
)

2310 ià(
¡©e
 > 
SND_PCM_STATE_LAST
)

2311  
NULL
;

2312  
¢d_pcm_¡©e_Çmes
[
¡©e
];

2313 
	}
}

2320 #iâdeà
DOXYGEN


2321 
EXPORT_SYMBOL
 cÚ¡ *
	$INTERNAL
(
¢d_pcm_ty³_Çme
)(
¢d_pcm_ty³_t
 
ty³
)

2323 cÚ¡ *
	$¢d_pcm_ty³_Çme
(
¢d_pcm_ty³_t
 
ty³
)

2326 ià(
ty³
 > 
SND_PCM_TYPE_LAST
)

2327  
NULL
;

2328  
¢d_pcm_ty³_Çmes
[
ty³
];

2329 
	}
}

2330 
u£_deçuÉ_symbŞ_v”siÚ
(
__¢d_pcm_ty³_Çme
, 
¢d_pcm_ty³_Çme
, 
ALSA_0
.9.0);

2338 
	$¢d_pcm_dump_hw_£tup
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

2340 
	`as£¹
(
pcm
);

2341 
	`as£¹
(
out
);

2342 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

2343 
	`SNDMSG
("PCM‚ot set up");

2344  -
EIO
;

2346 
	`¢d_ouut_´štf
(
out
, " sŒ—m : %s\n", 
	`¢d_pcm_¡»am_Çme
(
pcm
->
¡»am
));

2347 
	`¢d_ouut_´štf
(
out
, "‡cûs  : %s\n", 
	`¢d_pcm_acûss_Çme
(
pcm
->
acûss
));

2348 
	`¢d_ouut_´štf
(
out
, " fÜm© : %s\n", 
	`¢d_pcm_fÜm©_Çme
(
pcm
->
fÜm©
));

2349 
	`¢d_ouut_´štf
(
out
, " subfÜm© : %s\n", 
	`¢d_pcm_subfÜm©_Çme
(
pcm
->
subfÜm©
));

2350 
	`¢d_ouut_´štf
(
out
, " chªÃl  : %u\n", 
pcm
->
chªÃls
);

2351 
	`¢d_ouut_´štf
(
out
, "„© : %u\n", 
pcm
->
¿‹
);

2352 
	`¢d_ouut_´štf
(
out
, "ƒxact„ate : %g (%u/%u)\n",

2353 (
pcm
->
¿‹_d’
 ? ((èpcm->
¿‹_num
 /…cm->rate_den) : 0.0),

2354 
pcm
->
¿‹_num
,…cm->
¿‹_d’
);

2355 
	`¢d_ouut_´štf
(
out
, " msb™  : %u\n", 
pcm
->
msb™s
);

2356 
	`¢d_ouut_´štf
(
out
, " bufãr_siz : %lu\n", 
pcm
->
bufãr_size
);

2357 
	`¢d_ouut_´štf
(
out
, "…”iod_siz : %lu\n", 
pcm
->
³riod_size
);

2358 
	`¢d_ouut_´štf
(
out
, "…”iod_tim : %u\n", 
pcm
->
³riod_time
);

2360 
	}
}

2368 
	$¢d_pcm_dump_sw_£tup
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

2370 
	`as£¹
(
pcm
);

2371 
	`as£¹
(
out
);

2372 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

2373 
	`SNDMSG
("PCM‚ot set up");

2374  -
EIO
;

2376 
	`¢d_ouut_´štf
(
out
, "¡amp_mod : %s\n", 
	`¢d_pcm_t¡amp_mode_Çme
(
pcm
->
t¡amp_mode
));

2377 
	`¢d_ouut_´štf
(
out
, "¡amp_ty³ : %s\n", 
	`¢d_pcm_t¡amp_ty³_Çme
(
pcm
->
t¡amp_ty³
));

2378 
	`¢d_ouut_´štf
(
out
, "…”iod_¡• : %d\n", 
pcm
->
³riod_¡•
);

2379 
	`¢d_ouut_´štf
(
out
, "‡va_mš : %ld\n", 
pcm
->
ava_mš
);

2380 
	`¢d_ouut_´štf
(
out
, "…”iod_ev’ˆ: %i\n", 
pcm
->
³riod_ev’t
);

2381 
	`¢d_ouut_´štf
(
out
, " s¹_th»shŞd : %ld\n", 
pcm
->
¡¬t_th»shŞd
);

2382 
	`¢d_ouut_´štf
(
out
, " stİ_th»shŞd : %ld\n", 
pcm
->
¡İ_th»shŞd
);

2383 
	`¢d_ouut_´štf
(
out
, " s’û_th»shŞd: %ld\n", 
pcm
->
s’û_th»shŞd
);

2384 
	`¢d_ouut_´štf
(
out
, " s’û_siz: %ld\n", 
pcm
->
s’û_size
);

2385 
	`¢d_ouut_´štf
(
out
, " bound¬y : %ld\n", 
pcm
->
bound¬y
);

2387 
	}
}

2395 
	$¢d_pcm_dump_£tup
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

2397 
	`¢d_pcm_dump_hw_£tup
(
pcm
, 
out
);

2398 
	`¢d_pcm_dump_sw_£tup
(
pcm
, 
out
);

2400 
	}
}

2408 
	$¢d_pcm_¡©us_dump
(
¢d_pcm_¡©us_t
 *
¡©us
, 
¢d_ouut_t
 *
out
)

2410 
	`as£¹
(
¡©us
);

2411 
	`¢d_ouut_´štf
(
out
, " s‹ : %s\n", 
	`¢d_pcm_¡©e_Çme
((
¢d_pcm_¡©e_t
è
¡©us
->
¡©e
));

2412 
	`¢d_ouut_´štf
(
out
, "rigger_time: %ld.%06ld\n",

2413 
¡©us
->
Œigg”_t¡amp
.
tv_£c
,

2414 
¡©us
->
Œigg”_t¡amp
.
tv_n£c
 / 1000);

2415 
	`¢d_ouut_´štf
(
out
, "stamp : %ld.%06ld\n",

2416 
¡©us
->
t¡amp
.
tv_£c
, stus->t¡amp.
tv_n£c
 / 1000);

2417 
	`¢d_ouut_´štf
(
out
, " d–ay : %ld\n", ()
¡©us
->
d–ay
);

2418 
	`¢d_ouut_´štf
(
out
, "‡va : %ld\n", ()
¡©us
->
ava
);

2419 
	`¢d_ouut_´štf
(
out
, "‡va_max : %ld\n", ()
¡©us
->
ava_max
);

2421 
	}
}

2429 
	$¢d_pcm_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

2431 
”r
 = 0;

2433 
	`as£¹
(
pcm
);

2434 
	`as£¹
(
out
);

2435 ià(
pcm
->
İs
->
dump
)

2436 
pcm
->
İs
->
	`dump
Õcm->
İ_¬g
, 
out
);

2438 
”r
 = -
ENOSYS
;

2439  
”r
;

2440 
	}
}

2448 
¢d_pcm_säames_t
 
	$¢d_pcm_by‹s_to_äames
(
¢d_pcm_t
 *
pcm
, 
ssize_t
 
by‹s
)

2450 
	`as£¹
(
pcm
);

2451 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

2452 
	`SNDMSG
("PCM‚ot set up");

2453  -
EIO
;

2455  
by‹s
 * 8 / 
pcm
->
äame_b™s
;

2456 
	}
}

2464 
ssize_t
 
	$¢d_pcm_äames_to_by‹s
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 
äames
)

2466 
	`as£¹
(
pcm
);

2467 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

2468 
	`SNDMSG
("PCM‚ot set up");

2469  -
EIO
;

2471  
äames
 * 
pcm
->
äame_b™s
 / 8;

2472 
	}
}

2480 
	$¢d_pcm_by‹s_to_§m¶es
(
¢d_pcm_t
 *
pcm
, 
ssize_t
 
by‹s
)

2482 
	`as£¹
(
pcm
);

2483 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

2484 
	`SNDMSG
("PCM‚ot set up");

2485  -
EIO
;

2487  
by‹s
 * 8 / 
pcm
->
§m¶e_b™s
;

2488 
	}
}

2496 
ssize_t
 
	$¢d_pcm_§m¶es_to_by‹s
(
¢d_pcm_t
 *
pcm
, 
§m¶es
)

2498 
	`as£¹
(
pcm
);

2499 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

2500 
	`SNDMSG
("PCM‚ot set up");

2501  -
EIO
;

2503  
§m¶es
 * 
pcm
->
§m¶e_b™s
 / 8;

2504 
	}
}

2516 
	$¢d_async_add_pcm_hªdËr
(
¢d_async_hªdËr_t
 **
hªdËr
, 
¢d_pcm_t
 *
pcm
,

2517 
¢d_async_ÿÎback_t
 
ÿÎback
, *
´iv©e_d©a
)

2519 
”r
;

2520 
was_em±y
;

2521 
¢d_async_hªdËr_t
 *
h
;

2522 
”r
 = 
	`¢d_async_add_hªdËr
(&
h
, 
	`_¢d_pcm_async_desütÜ
(
pcm
),

2523 
ÿÎback
, 
´iv©e_d©a
);

2524 ià(
”r
 < 0)

2525  
”r
;

2526 
h
->
ty³
 = 
SND_ASYNC_HANDLER_PCM
;

2527 
h
->
u
.
pcm
 =…cm;

2528 
was_em±y
 = 
	`li¡_em±y
(&
pcm
->
async_hªdËrs
);

2529 
	`li¡_add_
(&
h
->
hli¡
, &
pcm
->
async_hªdËrs
);

2530 ià(
was_em±y
) {

2531 
”r
 = 
	`¢d_pcm_async
(
pcm
, 
	`¢d_async_hªdËr_g‘_signo
(
h
), 
	`g‘pid
());

2532 ià(
”r
 < 0) {

2533 
	`¢d_async_d–_hªdËr
(
h
);

2534  
”r
;

2537 *
hªdËr
 = 
h
;

2539 
	}
}

2546 
¢d_pcm_t
 *
	$¢d_async_hªdËr_g‘_pcm
(
¢d_async_hªdËr_t
 *
hªdËr
)

2548 ià(
hªdËr
->
ty³
 !ğ
SND_ASYNC_HANDLER_PCM
) {

2549 
	`SNDMSG
("šv®id hªdË¸ty³ %d", 
hªdËr
->
ty³
);

2550  
NULL
;

2552  
hªdËr
->
u
.
pcm
;

2553 
	}
}

2555 cÚ¡ *cÚ¡ 
	gbud_š_pcms
[] = {

2559 
NULL


2562 
	$¢d_pcm_İ’_cÚf
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

2563 
¢d_cÚfig_t
 *
pcm_roÙ
, snd_cÚfig_ˆ*
pcm_cÚf
,

2564 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

2566 cÚ¡ *
¡r
;

2567 *
buf
 = 
NULL
, *
buf1
 = NULL;

2568 
”r
;

2569 
¢d_cÚfig_t
 *
cÚf
, *
ty³_cÚf
 = 
NULL
, *
tmp
;

2570 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

2571 cÚ¡ *
id
;

2572 cÚ¡ *
lib
 = 
NULL
, *
İ’_Çme
 = NULL;

2573 (*
İ’_func
)(
¢d_pcm_t
 **, const *,

2574 
¢d_cÚfig_t
 *, snd_config_t *,

2575 
¢d_pcm_¡»am_t
, èğ
NULL
;

2576 #iâdeà
PIC


2577 *
	`¢d_pcm_İ’_symbŞs
();

2579 ià(
	`¢d_cÚfig_g‘_ty³
(
pcm_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

2580 *
v®
;

2581 
id
 = 
NULL
;

2582 
	`¢d_cÚfig_g‘_id
(
pcm_cÚf
, &
id
);

2583 
v®
 = 
NULL
;

2584 
	`¢d_cÚfig_g‘_ascii
(
pcm_cÚf
, &
v®
);

2585 
	`SNDERR
("Inv®idy³ fÜ PCM %s%sdefš™iÚ (id: %s, v®ue: %s)", 
Çme
 ?‚am: "",‚am? " " : "", 
id
, 
v®
);

2586 
	`ä“
(
v®
);

2587  -
EINVAL
;

2589 
”r
 = 
	`¢d_cÚfig_£¬ch
(
pcm_cÚf
, "ty³", &
cÚf
);

2590 ià(
”r
 < 0) {

2591 
	`SNDERR
("type is‚ot defined");

2592  
”r
;

2594 
”r
 = 
	`¢d_cÚfig_g‘_id
(
cÚf
, &
id
);

2595 ià(
”r
 < 0) {

2596 
	`SNDERR
("unableo get id");

2597  
”r
;

2599 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
cÚf
, &
¡r
);

2600 ià(
”r
 < 0) {

2601 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

2602  
”r
;

2604 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
pcm_roÙ
, "pcm_ty³", 
¡r
, &
ty³_cÚf
);

2605 ià(
”r
 >= 0) {

2606 ià(
	`¢d_cÚfig_g‘_ty³
(
ty³_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

2607 
	`SNDERR
("Inv®idy³ fÜ PCMy³ % defš™iÚ", 
¡r
);

2608 
”r
 = -
EINVAL
;

2609 
_”r
;

2611 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
ty³_cÚf
) {

2612 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

2613 cÚ¡ *
id
;

2614 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

2616 ià(
	`¡rcmp
(
id
, "comment") == 0)

2618 ià(
	`¡rcmp
(
id
, "lib") == 0) {

2619 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
lib
);

2620 ià(
”r
 < 0) {

2621 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

2622 
_”r
;

2626 ià(
	`¡rcmp
(
id
, "open") == 0) {

2627 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
İ’_Çme
);

2628 ià(
”r
 < 0) {

2629 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

2630 
_”r
;

2634 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

2635 
”r
 = -
EINVAL
;

2636 
_”r
;

2639 ià(!
İ’_Çme
) {

2640 
buf
 = 
	`m®loc
(
	`¡¾’
(
¡r
) + 32);

2641 ià(
buf
 =ğ
NULL
) {

2642 
”r
 = -
ENOMEM
;

2643 
_”r
;

2645 
İ’_Çme
 = 
buf
;

2646 
	`¥rštf
(
buf
, "_¢d_pcm_%s_İ’", 
¡r
);

2648 ià(!
lib
) {

2649 cÚ¡ *cÚ¡ *
bud_š
 = 
bud_š_pcms
;

2650 *
bud_š
) {

2651 ià(!
	`¡rcmp
(*
bud_š
, 
¡r
))

2653 
bud_š
++;

2655 ià(*
bud_š
 =ğ
NULL
) {

2656 
buf1
 = 
	`m®loc
(
	`¡¾’
(
¡r
) + 32);

2657 ià(
buf1
 =ğ
NULL
) {

2658 
”r
 = -
ENOMEM
;

2659 
_”r
;

2661 
lib
 = 
buf1
;

2662 
	`¥rštf
(
buf1
, "libasound_moduË_pcm_%s.so", 
¡r
);

2665 #iâdeà
PIC


2666 
	`¢d_pcm_İ’_symbŞs
();

2668 
İ’_func
 = 
	`¢d_dlobj_ÿche_g‘
(
lib
, 
İ’_Çme
,

2669 
	`SND_DLSYM_VERSION
(
SND_PCM_DLSYM_VERSION
), 1);

2670 ià(
İ’_func
) {

2671 
”r
 = 
	`İ’_func
(
pcmp
, 
Çme
, 
pcm_roÙ
, 
pcm_cÚf
, 
¡»am
, 
mode
);

2672 ià(
”r
 >= 0) {

2673 ià((*
pcmp
)->
İ’_func
) {

2675 
	`¢d_dlobj_ÿche_put
(
İ’_func
);

2677 (*
pcmp
)->
İ’_func
 = open_func;

2679 
”r
 = 0;

2681 
	`¢d_dlobj_ÿche_put
(
İ’_func
);

2684 
”r
 = -
ENXIO
;

2686 ià(
”r
 >= 0) {

2687 
”r
 = 
	`¢d_cÚfig_£¬ch
(
pcm_roÙ
, "deçuÉs.pcm.com·t", &
tmp
);

2688 ià(
”r
 >= 0) {

2689 
i
;

2690 ià(
	`¢d_cÚfig_g‘_š‹g”
(
tmp
, &
i
) >= 0) {

2691 ià(
i
 > 0)

2692 (*
pcmp
)->
com·t
 = 1;

2695 *
¡r
 = 
	`g‘’v
("LIBASOUND_COMPAT");

2696 ià(
¡r
 && *str)

2697 (*
pcmp
)->
com·t
 = 1;

2699 
”r
 = 
	`¢d_cÚfig_£¬ch
(
pcm_roÙ
, "deçuÉs.pcm.mš³riodtime", &
tmp
);

2700 ià(
”r
 >= 0)

2701 
	`¢d_cÚfig_g‘_š‹g”
(
tmp
, &(*
pcmp
)->
mš³riodtime
);

2702 
”r
 = 0;

2704 
_”r
:

2705 ià(
ty³_cÚf
)

2706 
	`¢d_cÚfig_d–‘e
(
ty³_cÚf
);

2707 
	`ä“
(
buf
);

2708 
	`ä“
(
buf1
);

2709  
”r
;

2710 
	}
}

2712 
	$¢d_pcm_İ’_noupd©e
(
¢d_pcm_t
 **
pcmp
, 
¢d_cÚfig_t
 *
roÙ
,

2713 cÚ¡ *
Çme
, 
¢d_pcm_¡»am_t
 
¡»am
,

2714 
mode
, 
hİ
)

2716 
”r
;

2717 
¢d_cÚfig_t
 *
pcm_cÚf
;

2718 cÚ¡ *
¡r
;

2720 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "pcm", 
Çme
, &
pcm_cÚf
);

2721 ià(
”r
 < 0) {

2722 
	`SNDERR
("UnknowÀPCM %s", 
Çme
);

2723  
”r
;

2725 ià(
	`¢d_cÚfig_g‘_¡ršg
(
pcm_cÚf
, &
¡r
) >= 0)

2726 
”r
 = 
	`¢d_pcm_İ’_noupd©e
(
pcmp
, 
roÙ
, 
¡r
, 
¡»am
, 
mode
,

2727 
hİ
 + 1);

2729 
	`¢d_cÚfig_£t_hİ
(
pcm_cÚf
, 
hİ
);

2730 
”r
 = 
	`¢d_pcm_İ’_cÚf
(
pcmp
, 
Çme
, 
roÙ
, 
pcm_cÚf
, 
¡»am
, 
mode
);

2732 
	`¢d_cÚfig_d–‘e
(
pcm_cÚf
);

2733  
”r
;

2734 
	}
}

2744 
	$¢d_pcm_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

2745 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

2747 
¢d_cÚfig_t
 *
tİ
;

2748 
”r
;

2750 
	`as£¹
(
pcmp
 && 
Çme
);

2751 ià(
	`_¢d_is_ucm_deviû
(
Çme
)) {

2752 
Çme
 = 
	`uc_mgr_®ibcfg_by_deviû
(&
tİ
,‚ame);

2753 ià(
Çme
 =ğ
NULL
)

2754  -
ENODEV
;

2756 
”r
 = 
	`¢d_cÚfig_upd©e_»f
(&
tİ
);

2757 ià(
”r
 < 0)

2758  
”r
;

2760 
”r
 = 
	`¢d_pcm_İ’_noupd©e
(
pcmp
, 
tİ
, 
Çme
, 
¡»am
, 
mode
, 0);

2761 
	`¢d_cÚfig_uÄef
(
tİ
);

2762  
”r
;

2763 
	}
}

2774 
	$¢d_pcm_İ’_lcÚf
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

2775 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
,

2776 
¢d_cÚfig_t
 *
lcÚf
)

2778 
	`as£¹
(
pcmp
 && 
Çme
 && 
lcÚf
);

2779  
	`¢d_pcm_İ’_noupd©e
(
pcmp
, 
lcÚf
, 
Çme
, 
¡»am
, 
mode
, 0);

2780 
	}
}

2792 
	$¢d_pcm_İ’_çÎback
(
¢d_pcm_t
 **
pcmp
, 
¢d_cÚfig_t
 *
roÙ
,

2793 cÚ¡ *
Çme
, cÚ¡ *
Üig_Çme
,

2794 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

2796 
”r
;

2797 
	`as£¹
(
pcmp
 && 
Çme
 && 
roÙ
);

2798 
”r
 = 
	`¢d_pcm_İ’_noupd©e
(
pcmp
, 
roÙ
, 
Çme
, 
¡»am
, 
mode
, 0);

2799 ià(
”r
 >= 0) {

2800 
	`ä“
((*
pcmp
)->
Çme
);

2801 (*
pcmp
)->
Çme
 = 
Üig_Çme
 ? 
	`¡rdup
(Üig_Çmeè: 
NULL
;

2803  
”r
;

2804 
	}
}

2806 #iâdeà
DOC_HIDDEN


2807 
	$¢d_pcm_Ãw
(
¢d_pcm_t
 **
pcmp
, 
¢d_pcm_ty³_t
 
ty³
, cÚ¡ *
Çme
,

2808 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

2810 
¢d_pcm_t
 *
pcm
;

2811 #ifdeà
THREAD_SAFE_API


2812 
±h»ad_mu‹x©Œ_t
 
©Œ
;

2815 
pcm
 = 
	`ÿÎoc
(1, (*pcm));

2816 ià(!
pcm
)

2817  -
ENOMEM
;

2818 
pcm
->
ty³
 =ype;

2819 ià(
Çme
)

2820 
pcm
->
Çme
 = 
	`¡rdup
(name);

2821 
pcm
->
¡»am
 = stream;

2822 
pcm
->
mode
 = mode;

2823 
pcm
->
pŞl_fd_couÁ
 = 1;

2824 
pcm
->
pŞl_fd
 = -1;

2825 
pcm
->
İ_¬g
 =…cm;

2826 
pcm
->
ç¡_İ_¬g
 =…cm;

2827 
	`INIT_LIST_HEAD
(&
pcm
->
async_hªdËrs
);

2828 #ifdeà
THREAD_SAFE_API


2829 
	`±h»ad_mu‹x©Œ_š™
(&
©Œ
);

2830 #ifdeà
HAVE_PTHREAD_MUTEX_RECURSIVE


2831 
	`±h»ad_mu‹x©Œ_£‰y³
(&
©Œ
, 
PTHREAD_MUTEX_RECURSIVE
);

2833 
	`±h»ad_mu‹x_š™
(&
pcm
->
lock
, &
©Œ
);

2834 
	`±h»ad_mu‹x©Œ_de¡roy
(&
©Œ
);

2838 
pcm
->
Ãed_lock
 = 1;

2839 ià(
mode
 & 
SND_PCM_ASYNC
) {

2841 
pcm
->
lock_’abËd
 = 0;

2844 
do_lock_’abË
 = -1;

2847 ià(
do_lock_’abË
 == -1) {

2848 *
p
 = 
	`g‘’v
("LIBASOUND_THREAD_SAFE");

2849 
do_lock_’abË
 = !
p
 || *p != '0';

2851 
pcm
->
lock_’abËd
 = 
do_lock_’abË
;

2854 *
pcmp
 = 
pcm
;

2856 
	}
}

2858 
	$¢d_pcm_ä“
(
¢d_pcm_t
 *
pcm
)

2860 
	`as£¹
(
pcm
);

2861 
	`ä“
(
pcm
->
Çme
);

2862 
	`ä“
(
pcm
->
hw
.
lšk_d¡
);

2863 
	`ä“
(
pcm
->
­¶
.
lšk_d¡
);

2864 
	`¢d_dlobj_ÿche_put
(
pcm
->
İ’_func
);

2865 #ifdeà
THREAD_SAFE_API


2866 
	`±h»ad_mu‹x_de¡roy
(&
pcm
->
lock
);

2868 
	`ä“
(
pcm
);

2870 
	}
}

2872 
	$¢d_pcm_İ’_Çmed_¦ave
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

2873 
¢d_cÚfig_t
 *
roÙ
,

2874 
¢d_cÚfig_t
 *
cÚf
, 
¢d_pcm_¡»am_t
 
¡»am
,

2875 
mode
, 
¢d_cÚfig_t
 *
·»Á_cÚf
)

2877 cÚ¡ *
¡r
;

2878 
hİ
;

2880 ià((
hİ
 = 
	`¢d_cÚfig_check_hİ
(
·»Á_cÚf
)) < 0)

2881  
hİ
;

2882 ià(
	`¢d_cÚfig_g‘_¡ršg
(
cÚf
, &
¡r
) >= 0)

2883  
	`¢d_pcm_İ’_noupd©e
(
pcmp
, 
roÙ
, 
¡r
, 
¡»am
, 
mode
,

2884 
hİ
 + 1);

2885  
	`¢d_pcm_İ’_cÚf
(
pcmp
, 
Çme
, 
roÙ
, 
cÚf
, 
¡»am
, 
mode
);

2886 
	}
}

2903 
	$¢d_pcm_wa™
(
¢d_pcm_t
 *
pcm
, 
timeout
)

2905 
”r
;

2907 
	`__¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

2908 
”r
 = 
	`__¢d_pcm_wa™_š_lock
(
pcm
, 
timeout
);

2909 
	`__¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

2910  
”r
;

2911 
	}
}

2913 #iâdeà
DOC_HIDDEN


2915 
	$__¢d_pcm_wa™_š_lock
(
¢d_pcm_t
 *
pcm
, 
timeout
)

2917 
”r
;

2920 ià(
	`__¢d_pcm_¡©e
(
pcm
è!ğ
SND_PCM_STATE_DRAINING
 &&

2921 !
	`¢d_pcm_may_wa™_fÜ_ava_mš
(
pcm
, 
	`¢d_pcm_mm­_ava
(pcm))) {

2923 
”r
 = 
	`pcm_¡©e_to_”rÜ
(
	`__¢d_pcm_¡©e
(
pcm
));

2924  
”r
 < 0 ?ƒrr : 1;

2926  
	`¢d_pcm_wa™_nocheck
(
pcm
, 
timeout
);

2927 
	}
}

2929 
	$__¢d_pcm_wa™_io_timeout
(
¢d_pcm_t
 *
pcm
)

2931 
timeout
;

2934 
timeout
 = (
pcm
->
³riod_size
 * 1000ULLè/…cm->
¿‹
;

2936 ià(
timeout
 < 0)

2937 
timeout
 = 0;

2939 
timeout
 += 200;

2940  
timeout
;

2941 
	}
}

2943 
	$__¢d_pcm_wa™_d¿š_timeout
(
¢d_pcm_t
 *
pcm
)

2945 
timeout
;

2948 ià(
	`¢d_pcm_¡»am
(
pcm
è=ğ
SND_PCM_STREAM_CAPTURE
)

2951 
timeout
 = (
	`¢d_pcm_mm­_¶ayback_d–ay
(
pcm
è* 1000LLè/…cm->
¿‹
;

2953 ià(
timeout
 < 0)

2954 
timeout
 = 0;

2956 
timeout
 += 200;

2957  
timeout
;

2958 
	}
}

2967 
	$¢d_pcm_wa™_nocheck
(
¢d_pcm_t
 *
pcm
, 
timeout
)

2969 
pŞlfd
 *
pfd
;

2970 
»v’ts
 = 0;

2971 
Åfds
, 
”r
, 
”r_pŞl
;

2973 
Åfds
 = 
	`__¢d_pcm_pŞl_desütÜs_couÁ
(
pcm
);

2974 ià(
Åfds
 <= 0 ||‚pfds >= 16) {

2975 
	`SNDERR
("Inv®id…Şl_fd %d", 
Åfds
);

2976  -
EIO
;

2978 
pfd
 = 
	`®loÿ
((*pfdè* 
Åfds
);

2979 
”r
 = 
	`__¢d_pcm_pŞl_desütÜs
(
pcm
, 
pfd
, 
Åfds
);

2980 ià(
”r
 < 0)

2981  
”r
;

2982 ià(
”r
 !ğ
Åfds
) {

2983 
	`SNDMSG
("šv®id…ŞÈdesütÜ %d", 
”r
);

2984  -
EIO
;

2986 ià(
timeout
 =ğ
SND_PCM_WAIT_IO
)

2987 
timeout
 = 
	`__¢d_pcm_wa™_io_timeout
(
pcm
);

2988 ià(
timeout
 =ğ
SND_PCM_WAIT_DRAIN
)

2989 
timeout
 = 
	`__¢d_pcm_wa™_d¿š_timeout
(
pcm
);

2990 ià(
timeout
 < -1)

2991 
	`SNDMSG
("šv®id snd_pcm_wa™imeouˆ¬gum’ˆ%d", 
timeout
);

2993 
	`__¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

2994 
”r_pŞl
 = 
	`pŞl
(
pfd
, 
Åfds
, 
timeout
);

2995 
	`__¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

2996 ià(
”r_pŞl
 < 0) {

2997 ià(
”ºo
 =ğ
EINTR
 && !
	`PCMINABORT
(
pcm
è&& !Õcm->
mode
 & 
SND_PCM_EINTR
))

2999  -
”ºo
;

3001 ià(! 
”r_pŞl
)

3003 
”r
 = 
	`__¢d_pcm_pŞl_»v’ts
(
pcm
, 
pfd
, 
Åfds
, &
»v’ts
);

3004 ià(
”r
 < 0)

3005  
”r
;

3006 ià(
»v’ts
 & (
POLLERR
 | 
POLLNVAL
)) {

3008 
”r
 = 
	`pcm_¡©e_to_”rÜ
(
	`__¢d_pcm_¡©e
(
pcm
));

3009  
”r
 < 0 ?ƒ¼ : -
EIO
;

3011 } !(
»v’ts
 & (
POLLIN
 | 
POLLOUT
)));

3014 
¢d_pcm_säames_t
 
ava_upd©e
;

3015 
	`__¢d_pcm_hwsync
(
pcm
);

3016 
ava_upd©e
 = 
	`__¢d_pcm_ava_upd©e
(
pcm
);

3017 ià(
ava_upd©e
 < (
¢d_pcm_säames_t
)
pcm
->
ava_mš
) {

3018 
	`´štf
("*** snd_pcm_wait() FATAL ERROR!!!\n");

3019 
	`´štf
("ava_mš = %li,‡va_upd©ğ%li\n", 
pcm
->
ava_mš
, 
ava_upd©e
);

3023  
”r_pŞl
 > 0 ? 1 : 0;

3024 
	}
}

3050 
¢d_pcm_säames_t
 
	$¢d_pcm_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

3052 
¢d_pcm_säames_t
 
»suÉ
;

3054 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

3055 
»suÉ
 = 
	`__¢d_pcm_ava_upd©e
(
pcm
);

3056 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

3057  
»suÉ
;

3058 
	}
}

3074 
¢d_pcm_säames_t
 
	$¢d_pcm_ava
(
¢d_pcm_t
 *
pcm
)

3076 
”r
;

3077 
¢d_pcm_säames_t
 
»suÉ
;

3079 
	`as£¹
(
pcm
);

3080 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

3081 
	`SNDMSG
("PCM‚ot set up");

3082  -
EIO
;

3084 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

3085 
”r
 = 
	`__¢d_pcm_hwsync
(
pcm
);

3086 ià(
”r
 < 0)

3087 
»suÉ
 = 
”r
;

3089 
»suÉ
 = 
	`__¢d_pcm_ava_upd©e
(
pcm
);

3090 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

3091  
»suÉ
;

3092 
	}
}

3105 
	$¢d_pcm_ava_d–ay
(
¢d_pcm_t
 *
pcm
,

3106 
¢d_pcm_säames_t
 *
avap
,

3107 
¢d_pcm_säames_t
 *
d–ayp
)

3109 
¢d_pcm_säames_t
 
sf
;

3110 
”r
;

3112 
	`as£¹
(
pcm
 && 
avap
 && 
d–ayp
);

3113 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

3114 
	`SNDMSG
("PCM‚ot set up");

3115  -
EIO
;

3117 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

3118 
”r
 = 
	`__¢d_pcm_hwsync
(
pcm
);

3119 ià(
”r
 < 0)

3120 
uÆock
;

3121 
sf
 = 
	`__¢d_pcm_ava_upd©e
(
pcm
);

3122 ià(
sf
 < 0) {

3123 
”r
 = ()
sf
;

3124 
uÆock
;

3126 
”r
 = 
	`__¢d_pcm_d–ay
(
pcm
, 
d–ayp
);

3127 ià(
”r
 < 0)

3128 
uÆock
;

3129 *
avap
 = 
sf
;

3130 
”r
 = 0;

3131 
uÆock
:

3132 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

3133  
”r
;

3134 
	}
}

3144 
	$¢d_pcm_¬—_s’û
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
, 
¢d_pcm_uäames_t
 
d¡_off£t
,

3145 
§m¶es
, 
¢d_pcm_fÜm©_t
 
fÜm©
)

3148 *
d¡
;

3149 
d¡_¡•
;

3150 
width
;

3151 
ušt64_t
 
s’û
;

3152 ià(!
d¡_¬—
->
addr
)

3154 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

3155 
width
 = 
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
);

3156 
s’û
 = 
	`¢d_pcm_fÜm©_s’û_64
(
fÜm©
);

3161 ià(
d¡_¬—
->
¡•
 =ğ(è
width
 &&

3162 
width
 != 24 &&

3163 ((
šŒ_t
)
d¡
 & 7) == 0) {

3164 
dwÜds
 = 
§m¶es
 * 
width
 / 64;

3165 
ušt64_t
 *
d¡p
 = (ušt64_ˆ*)
d¡
;

3166 
§m¶es
 -ğ
dwÜds
 * 64 / 
width
;

3167 
dwÜds
-- > 0)

3168 *
d¡p
++ = 
s’û
;

3169 ià(
§m¶es
 == 0)

3171 
d¡
 = (*)
d¡p
;

3173 
d¡_¡•
 = 
d¡_¬—
->
¡•
 / 8;

3174 
width
) {

3176 
ušt8_t
 
s0
 = 
s’û
 & 0xf0;

3177 
ušt8_t
 
s1
 = 
s’û
 & 0x0f;

3178 
d¡b™
 = 
d¡_¬—
->
fœ¡
 % 8;

3179 
d¡b™_¡•
 = 
d¡_¬—
->
¡•
 % 8;

3180 
§m¶es
-- > 0) {

3181 ià(
d¡b™
) {

3182 *
d¡
 &= 0xf0;

3183 *
d¡
 |ğ
s1
;

3185 *
d¡
 &= 0x0f;

3186 *
d¡
 |ğ
s0
;

3188 
d¡
 +ğ
d¡_¡•
;

3189 
d¡b™
 +ğ
d¡b™_¡•
;

3190 ià(
d¡b™
 == 8) {

3191 
d¡
++;

3192 
d¡b™
 = 0;

3198 
ušt8_t
 
s
 = 
s’û
;

3199 
§m¶es
-- > 0) {

3200 *
d¡
 = 
s
;

3201 
d¡
 +ğ
d¡_¡•
;

3206 
ušt16_t
 
s
 = 
s’û
;

3207 
§m¶es
-- > 0) {

3208 *(
ušt16_t
*)
d¡
 = 
s
;

3209 
d¡
 +ğ
d¡_¡•
;

3214 
§m¶es
-- > 0) {

3215 #ifdeà
SNDRV_LITTLE_ENDIAN


3216 *(
d¡
 + 0èğ
s’û
 >> 0;

3217 *(
d¡
 + 1èğ
s’û
 >> 8;

3218 *(
d¡
 + 2èğ
s’û
 >> 16;

3220 *(
d¡
 + 2èğ
s’û
 >> 0;

3221 *(
d¡
 + 1èğ
s’û
 >> 8;

3222 *(
d¡
 + 0èğ
s’û
 >> 16;

3224 
d¡
 +ğ
d¡_¡•
;

3229 
ušt32_t
 
s
 = 
s’û
;

3230 
§m¶es
-- > 0) {

3231 *(
ušt32_t
*)
d¡
 = 
s
;

3232 
d¡
 +ğ
d¡_¡•
;

3237 
§m¶es
-- > 0) {

3238 *(
ušt64_t
*)
d¡
 = 
s’û
;

3239 
d¡
 +ğ
d¡_¡•
;

3244 
	`SNDMSG
("šv®id fÜm© width %d", 
width
);

3245  -
EINVAL
;

3248 
	}
}

3259 
	$¢d_pcm_¬—s_s’û
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
, 
¢d_pcm_uäames_t
 
d¡_off£t
,

3260 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
, 
¢d_pcm_fÜm©_t
 
fÜm©
)

3262 
width
 = 
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
);

3263 
chªÃls
 > 0) {

3264 *
addr
 = 
d¡_¬—s
->addr;

3265 
¡•
 = 
d¡_¬—s
->step;

3266 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
begš
 = 
d¡_¬—s
;

3267 
chªÃls1
 = 
chªÃls
;

3268 
chns
 = 0;

3269 
”r
;

3271 
chªÃls1
--;

3272 
chns
++;

3273 
d¡_¬—s
++;

3274 ià(
chªÃls1
 == 0 ||

3275 
d¡_¬—s
->
addr
 !=‡ddr ||

3276 
d¡_¬—s
->
¡•
 != step ||

3277 
d¡_¬—s
->
fœ¡
 !ğd¡_¬—s[-1].fœ¡ + 
width
)

3280 ià(
chns
 > 1 && chn * 
width
 =ğ
¡•
) {

3282 
¢d_pcm_chªÃl_¬—_t
 
d
;

3283 
d
.
addr
 = 
begš
->addr;

3284 
d
.
fœ¡
 = 
begš
->first;

3285 
d
.
¡•
 = 
width
;

3286 
”r
 = 
	`¢d_pcm_¬—_s’û
(&
d
, 
d¡_off£t
 * 
chns
, 
äames
 * chns, 
fÜm©
);

3287 
chªÃls
 -ğ
chns
;

3289 
”r
 = 
	`¢d_pcm_¬—_s’û
(
begš
, 
d¡_off£t
, 
äames
, 
fÜm©
);

3290 
d¡_¬—s
 = 
begš
 + 1;

3291 
chªÃls
--;

3293 ià(
”r
 < 0)

3294  
”r
;

3297 
	}
}

3310 
	$¢d_pcm_¬—_cİy
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
, 
¢d_pcm_uäames_t
 
d¡_off£t
,

3311 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
, 
¢d_pcm_uäames_t
 
¤c_off£t
,

3312 
§m¶es
, 
¢d_pcm_fÜm©_t
 
fÜm©
)

3315 cÚ¡ *
¤c
;

3316 *
d¡
;

3317 
width
;

3318 
¤c_¡•
, 
d¡_¡•
;

3319 ià(
d¡_¬—
 =ğ
¤c_¬—
 && 
d¡_off£t
 =ğ
¤c_off£t
)

3321 ià(!
¤c_¬—
->
addr
)

3322  
	`¢d_pcm_¬—_s’û
(
d¡_¬—
, 
d¡_off£t
, 
§m¶es
, 
fÜm©
);

3323 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

3324 ià(!
d¡_¬—
->
addr
)

3326 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

3327 
width
 = 
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
);

3328 ià(
¤c_¬—
->
¡•
 =ğ(è
width
 &&

3329 
d¡_¬—
->
¡•
 =ğ(è
width
) {

3330 
size_t
 
by‹s
 = 
§m¶es
 * 
width
 / 8;

3331 
§m¶es
 -ğ
by‹s
 * 8 / 
width
;

3332 
	`as£¹
(
¤c
 < 
d¡
 || srø>ğd¡ + 
by‹s
);

3333 
	`as£¹
(
d¡
 < 
¤c
 || d¡ >ğ¤ø+ 
by‹s
);

3334 
	`memıy
(
d¡
, 
¤c
, 
by‹s
);

3335 ià(
§m¶es
 == 0)

3338 
¤c_¡•
 = 
¤c_¬—
->
¡•
 / 8;

3339 
d¡_¡•
 = 
d¡_¬—
->
¡•
 / 8;

3340 
width
) {

3342 
¤cb™
 = 
¤c_¬—
->
fœ¡
 % 8;

3343 
¤cb™_¡•
 = 
¤c_¬—
->
¡•
 % 8;

3344 
d¡b™
 = 
d¡_¬—
->
fœ¡
 % 8;

3345 
d¡b™_¡•
 = 
d¡_¬—
->
¡•
 % 8;

3346 
§m¶es
-- > 0) {

3347 
¤cv®
;

3348 ià(
¤cb™
)

3349 
¤cv®
 = *
¤c
 & 0x0f;

3351 
¤cv®
 = *
¤c
 & 0xf0;

3352 ià(
d¡b™
)

3353 *
d¡
 &= 0xf0;

3355 *
d¡
 &= 0x0f;

3356 *
d¡
 |ğ
¤cv®
;

3357 
¤c
 +ğ
¤c_¡•
;

3358 
¤cb™
 +ğ
¤cb™_¡•
;

3359 ià(
¤cb™
 == 8) {

3360 
¤c
++;

3361 
¤cb™
 = 0;

3363 
d¡
 +ğ
d¡_¡•
;

3364 
d¡b™
 +ğ
d¡b™_¡•
;

3365 ià(
d¡b™
 == 8) {

3366 
d¡
++;

3367 
d¡b™
 = 0;

3373 
§m¶es
-- > 0) {

3374 *
d¡
 = *
¤c
;

3375 
¤c
 +ğ
¤c_¡•
;

3376 
d¡
 +ğ
d¡_¡•
;

3381 
§m¶es
-- > 0) {

3382 *(
ušt16_t
*)
d¡
 = *(cÚ¡ ušt16_t*)
¤c
;

3383 
¤c
 +ğ
¤c_¡•
;

3384 
d¡
 +ğ
d¡_¡•
;

3389 
§m¶es
-- > 0) {

3390 *(
d¡
 + 0èğ*(
¤c
 + 0);

3391 *(
d¡
 + 1èğ*(
¤c
 + 1);

3392 *(
d¡
 + 2èğ*(
¤c
 + 2);

3393 
¤c
 +ğ
¤c_¡•
;

3394 
d¡
 +ğ
d¡_¡•
;

3398 
§m¶es
-- > 0) {

3399 *(
ušt32_t
*)
d¡
 = *(cÚ¡ ušt32_t*)
¤c
;

3400 
¤c
 +ğ
¤c_¡•
;

3401 
d¡
 +ğ
d¡_¡•
;

3406 
§m¶es
-- > 0) {

3407 *(
ušt64_t
*)
d¡
 = *(cÚ¡ ušt64_t*)
¤c
;

3408 
¤c
 +ğ
¤c_¡•
;

3409 
d¡
 +ğ
d¡_¡•
;

3414 
	`SNDMSG
("šv®id fÜm© width %d", 
width
);

3415  -
EINVAL
;

3418 
	}
}

3431 
	$¢d_pcm_¬—s_cİy
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
, 
¢d_pcm_uäames_t
 
d¡_off£t
,

3432 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
, 
¢d_pcm_uäames_t
 
¤c_off£t
,

3433 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
, 
¢d_pcm_fÜm©_t
 
fÜm©
)

3435 
width
 = 
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
);

3436 
	`as£¹
(
d¡_¬—s
);

3437 
	`as£¹
(
¤c_¬—s
);

3438 ià(! 
chªÃls
) {

3439 
	`SNDMSG
("šv®id chªÃl %d", 
chªÃls
);

3440  -
EINVAL
;

3442 ià(! 
äames
) {

3443 
	`SNDMSG
("šv®id f¿me %ld", 
äames
);

3444  -
EINVAL
;

3446 
chªÃls
 > 0) {

3447 
¡•
 = 
¤c_¬—s
->step;

3448 *
¤c_addr
 = 
¤c_¬—s
->
addr
;

3449 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¡¬t
 = 
¤c_¬—s
;

3450 *
d¡_addr
 = 
d¡_¬—s
->
addr
;

3451 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¡¬t
 = 
d¡_¬—s
;

3452 
chªÃls1
 = 
chªÃls
;

3453 
chns
 = 0;

3454 
d¡_¬—s
->
¡•
 == step) {

3455 
chªÃls1
--;

3456 
chns
++;

3457 
¤c_¬—s
++;

3458 
d¡_¬—s
++;

3459 ià(
chªÃls1
 == 0 ||

3460 
¤c_¬—s
->
¡•
 != step ||

3461 
¤c_¬—s
->
addr
 !ğ
¤c_addr
 ||

3462 
d¡_¬—s
->
addr
 !ğ
d¡_addr
 ||

3463 
¤c_¬—s
->
fœ¡
 !ğ¤c_¬—s[-1].fœ¡ + 
width
 ||

3464 
d¡_¬—s
->
fœ¡
 !ğd¡_¬—s[-1].fœ¡ + 
width
)

3467 ià(
chns
 > 1 && chn * 
width
 =ğ
¡•
) {

3468 ià(
¤c_off£t
 !ğ
d¡_off£t
 ||

3469 
¤c_¡¬t
->
addr
 !ğ
d¡_¡¬t
->addr ||

3470 
¤c_¡¬t
->
fœ¡
 !ğ
d¡_¡¬t
->first) {

3472 
¢d_pcm_chªÃl_¬—_t
 
s
, 
d
;

3473 
s
.
addr
 = 
¤c_¡¬t
->addr;

3474 
s
.
fœ¡
 = 
¤c_¡¬t
->first;

3475 
s
.
¡•
 = 
width
;

3476 
d
.
addr
 = 
d¡_¡¬t
->addr;

3477 
d
.
fœ¡
 = 
d¡_¡¬t
->first;

3478 
d
.
¡•
 = 
width
;

3479 
	`¢d_pcm_¬—_cİy
(&
d
, 
d¡_off£t
 * 
chns
,

3480 &
s
, 
¤c_off£t
 * 
chns
,

3481 
äames
 * 
chns
, 
fÜm©
);

3483 
chªÃls
 -ğ
chns
;

3485 
	`¢d_pcm_¬—_cİy
(
d¡_¡¬t
, 
d¡_off£t
,

3486 
¤c_¡¬t
, 
¤c_off£t
,

3487 
äames
, 
fÜm©
);

3488 
¤c_¬—s
 = 
¤c_¡¬t
 + 1;

3489 
d¡_¬—s
 = 
d¡_¡¬t
 + 1;

3490 
chªÃls
--;

3494 
	}
}

3509 
	$¢d_pcm_¬—s_cİy_w¿p
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_chªÃls
,

3510 
¢d_pcm_uäames_t
 
d¡_off£t
,

3511 cÚ¡ 
¢d_pcm_uäames_t
 
d¡_size
,

3512 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_chªÃls
,

3513 
¢d_pcm_uäames_t
 
¤c_off£t
,

3514 cÚ¡ 
¢d_pcm_uäames_t
 
¤c_size
,

3515 cÚ¡ 
chªÃls
,

3516 
¢d_pcm_uäames_t
 
äames
,

3517 cÚ¡ 
¢d_pcm_fÜm©_t
 
fÜm©
)

3519 
äames
 > 0) {

3520 
”r
;

3521 
¢d_pcm_uäames_t
 
xãr
 = 
äames
;

3523 ià((
d¡_off£t
 + 
xãr
è> 
d¡_size
)

3524 
xãr
 = 
d¡_size
 - 
d¡_off£t
;

3526 ià((
¤c_off£t
 + 
xãr
è> 
¤c_size
)

3527 
xãr
 = 
¤c_size
 - 
¤c_off£t
;

3528 
”r
 = 
	`¢d_pcm_¬—s_cİy
(
d¡_chªÃls
, 
d¡_off£t
, 
¤c_chªÃls
,

3529 
¤c_off£t
, 
chªÃls
, 
xãr
, 
fÜm©
);

3530 ià(
”r
 < 0)

3531  
”r
;

3533 
d¡_off£t
 +ğ
xãr
;

3534 ià(
d¡_off£t
 >ğ
d¡_size
)

3535 
d¡_off£t
 = 0;

3536 
¤c_off£t
 +ğ
xãr
;

3537 ià(
¤c_off£t
 >ğ
¤c_size
)

3538 
¤c_off£t
 = 0;

3539 
äames
 -ğ
xãr
;

3543 
	}
}

3545 
	$dump_Úe_·¿m
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
k
, 
¢d_ouut_t
 *
out
)

3547 
	`¢d_ouut_´štf
(
out
, "%s: ", 
	`¢d_pcm_hw_·¿m_Çme
(
k
));

3548 
	`¢d_pcm_hw_·¿m_dump
(
·¿ms
, 
k
, 
out
);

3549 
	`¢d_ouut_putc
(
out
, '\n');

3550 
	}
}

3558 
	$¢d_pcm_hw_·¿ms_dump
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_ouut_t
 *
out
)

3560 
k
;

3561 
k
 = 
SND_PCM_HW_PARAM_FIRST_MASK
; k <ğ
SND_PCM_HW_PARAM_LAST_MASK
; k++)

3562 
	`dump_Úe_·¿m
(
·¿ms
, 
k
, 
out
);

3563 
k
 = 
SND_PCM_HW_PARAM_FIRST_INTERVAL
; k <ğ
SND_PCM_HW_PARAM_LAST_INTERVAL
; k++)

3564 
	`dump_Úe_·¿m
(
·¿ms
, 
k
, 
out
);

3566 
	}
}

3578 
	$¢d_pcm_hw_·¿ms_ÿn_mm­_§m¶e_»sŞutiÚ
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3580 
	`as£¹
(
·¿ms
);

3581 ià(
	`CHECK_SANITY
(
·¿ms
->
šfo
 == ~0U)) {

3582 
	`SNDMSG
("invalid PCM info field");

3585  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_MMAP_VALID
);

3586 
	}
}

3598 
	$¢d_pcm_hw_·¿ms_is_doubË
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3600 
	`as£¹
(
·¿ms
);

3601 ià(
	`CHECK_SANITY
(
·¿ms
->
šfo
 == ~0U)) {

3602 
	`SNDMSG
("invalid PCM info field");

3605  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_DOUBLE
);

3606 
	}
}

3618 
	$¢d_pcm_hw_·¿ms_is_b©ch
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3620 
	`as£¹
(
·¿ms
);

3621 ià(
	`CHECK_SANITY
(
·¿ms
->
šfo
 == ~0U)) {

3622 
	`SNDMSG
("invalid PCM info field");

3625  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_BATCH
);

3626 
	}
}

3638 
	$¢d_pcm_hw_·¿ms_is_block_Œªsãr
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3640 
	`as£¹
(
·¿ms
);

3641 ià(
	`CHECK_SANITY
(
·¿ms
->
šfo
 == ~0U)) {

3642 
	`SNDMSG
("invalid PCM info field");

3645  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_BLOCK_TRANSFER
);

3646 
	}
}

3658 
	$¢d_pcm_hw_·¿ms_is_mÚÙÚic
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3660 
	`as£¹
(
·¿ms
);

3661 ià(
	`CHECK_SANITY
(
·¿ms
->
šfo
 == ~0U)) {

3662 
	`SNDMSG
("invalid PCM info field");

3665  !!(
·¿ms
->
šfo
 & 
SND_PCM_INFO_MONOTONIC
);

3666 
	}
}

3678 
	$¢d_pcm_hw_·¿ms_ÿn_ov”¿nge
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3680 
	`as£¹
(
·¿ms
);

3681 ià(
	`CHECK_SANITY
(
·¿ms
->
šfo
 == ~0U)) {

3682 
	`SNDMSG
("invalid PCM info field");

3685  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_OVERRANGE
);

3686 
	}
}

3698 
	$¢d_pcm_hw_·¿ms_ÿn_·u£
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3700 
	`as£¹
(
·¿ms
);

3701 ià(
	`CHECK_SANITY
(
·¿ms
->
šfo
 == ~0U)) {

3702 
	`SNDMSG
("invalid PCM info field");

3705  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_PAUSE
);

3706 
	}
}

3718 
	$¢d_pcm_hw_·¿ms_ÿn_»sume
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3720 
	`as£¹
(
·¿ms
);

3721 ià(
	`CHECK_SANITY
(
·¿ms
->
šfo
 == ~0U)) {

3722 
	`SNDMSG
("invalid PCM info field");

3725  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_RESUME
);

3726 
	}
}

3738 
	$¢d_pcm_hw_·¿ms_is_h®f_du¶ex
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3740 
	`as£¹
(
·¿ms
);

3741 ià(
	`CHECK_SANITY
(
·¿ms
->
šfo
 == ~0U)) {

3742 
	`SNDMSG
("invalid PCM info field");

3745  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_HALF_DUPLEX
);

3746 
	}
}

3758 
	$¢d_pcm_hw_·¿ms_is_jošt_du¶ex
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3760 
	`as£¹
(
·¿ms
);

3761 ià(
	`CHECK_SANITY
(
·¿ms
->
šfo
 == ~0U)) {

3762 
	`SNDMSG
("invalid PCM info field");

3765  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_JOINT_DUPLEX
);

3766 
	}
}

3778 
	$¢d_pcm_hw_·¿ms_ÿn_sync_¡¬t
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3780 
	`as£¹
(
·¿ms
);

3781 ià(
	`CHECK_SANITY
(
·¿ms
->
šfo
 == ~0U)) {

3782 
	`SNDMSG
("invalid PCM info field");

3785  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_SYNC_START
);

3786 
	}
}

3794 
	$¢d_pcm_hw_·¿ms_ÿn_di§bË_³riod_wakeup
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3796 
	`as£¹
(
·¿ms
);

3797 ià(
	`CHECK_SANITY
(
·¿ms
->
šfo
 == ~0U)) {

3798 
	`SNDMSG
("invalid PCM info field");

3801  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_NO_PERIOD_WAKEUP
);

3802 
	}
}

3817 
	$¢d_pcm_hw_·¿ms_is_³rãù_d¿š
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3819 
	`as£¹
(
·¿ms
);

3820 ià(
	`CHECK_SANITY
(
·¿ms
->
šfo
 == ~0U)) {

3821 
	`SNDMSG
("invalid PCM info field");

3824  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_PERFECT_DRAIN
);

3825 
	}
}

3837 
	$¢d_pcm_hw_·¿ms_suµÜts_audio_w®lşock_ts
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3840  
	`¢d_pcm_hw_·¿ms_suµÜts_audio_ts_ty³
(
·¿ms
,

3841 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_COMPAT
);

3842 
	}
}

3855 
	$¢d_pcm_hw_·¿ms_suµÜts_audio_ts_ty³
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
ty³
)

3857 
	`as£¹
(
·¿ms
);

3858 ià(
	`CHECK_SANITY
(
·¿ms
->
šfo
 == ~0U)) {

3859 
	`SNDMSG
("invalid PCM info field");

3862 
ty³
) {

3863 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_COMPAT
:

3864  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_HAS_WALL_CLOCK
);

3865 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_DEFAULT
:

3867 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK
:

3868  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_HAS_LINK_ATIME
);

3869 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK_ABSOLUTE
:

3870  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_HAS_LINK_ABSOLUTE_ATIME
);

3871 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK_ESTIMATED
:

3872  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_HAS_LINK_ESTIMATED_ATIME
);

3873 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK_SYNCHRONIZED
:

3874  !!(
·¿ms
->
šfo
 & 
SNDRV_PCM_INFO_HAS_LINK_SYNCHRONIZED_ATIME
);

3878 
	}
}

3891 
	$¢d_pcm_hw_·¿ms_g‘_¿‹_numd’
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

3892 *
¿‹_num
, *
¿‹_d’
)

3894 
	`as£¹
(
·¿ms
);

3895 ià(
	`CHECK_SANITY
(
·¿ms
->
¿‹_d’
 == 0)) {

3896 
	`SNDMSG
("invalid„ate_den value");

3897  -
EINVAL
;

3899 *
¿‹_num
 = 
·¿ms
->rate_num;

3900 *
¿‹_d’
 = 
·¿ms
->rate_den;

3902 
	}
}

3922 
	$¢d_pcm_hw_·¿ms_g‘_sb™s
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3924 
	`as£¹
(
·¿ms
);

3925 ià(
	`CHECK_SANITY
(
·¿ms
->
msb™s
 == 0)) {

3926 
	`SNDMSG
("invalid msbits value");

3927  -
EINVAL
;

3929  
·¿ms
->
msb™s
;

3930 
	}
}

3941 
	$¢d_pcm_hw_·¿ms_g‘_fifo_size
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3943 
	`as£¹
(
·¿ms
);

3944 ià(
	`CHECK_SANITY
(
·¿ms
->
šfo
 == ~0U)) {

3945 
	`SNDMSG
("invalid PCM info field");

3946  -
EINVAL
;

3948  
·¿ms
->
fifo_size
;

3949 
	}
}

3964 
	$¢d_pcm_hw_·¿ms_ªy
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

3966 
	`_¢d_pcm_hw_·¿ms_ªy
(
·¿ms
);

3967  
	`¢d_pcm_hw_»fše
(
pcm
, 
·¿ms
);

3968 
	}
}

3974 
size_t
 
	$¢d_pcm_acûss_mask_sizeof
()

3976  (
¢d_pcm_acûss_mask_t
);

3977 
	}
}

3984 
	$¢d_pcm_acûss_mask_m®loc
(
¢d_pcm_acûss_mask_t
 **
±r
)

3986 
	`as£¹
(
±r
);

3987 *
±r
 = 
	`ÿÎoc
(1, (
¢d_pcm_acûss_mask_t
));

3988 ià(!*
±r
)

3989  -
ENOMEM
;

3991 
	}
}

3997 
	$¢d_pcm_acûss_mask_ä“
(
¢d_pcm_acûss_mask_t
 *
obj
)

3999 
	`ä“
(
obj
);

4000 
	}
}

4007 
	$¢d_pcm_acûss_mask_cİy
(
¢d_pcm_acûss_mask_t
 *
d¡
, cÚ¡ snd_pcm_acûss_mask_ˆ*
¤c
)

4009 
	`as£¹
(
d¡
 && 
¤c
);

4010 *
d¡
 = *
¤c
;

4011 
	}
}

4017 
	$¢d_pcm_acûss_mask_nÚe
(
¢d_pcm_acûss_mask_t
 *
mask
)

4019 
	`¢d_mask_nÚe
((
¢d_mask_t
 *è
mask
);

4020 
	}
}

4026 
	$¢d_pcm_acûss_mask_ªy
(
¢d_pcm_acûss_mask_t
 *
mask
)

4028 
	`¢d_mask_ªy
((
¢d_mask_t
 *è
mask
);

4029 
	}
}

4036 
	$¢d_pcm_acûss_mask_‹¡
(cÚ¡ 
¢d_pcm_acûss_mask_t
 *
mask
, 
¢d_pcm_acûss_t
 
v®
)

4038  
	`¢d_mask_‹¡
((cÚ¡ 
¢d_mask_t
 *è
mask
, (è
v®
);

4039 
	}
}

4047 
	$¢d_pcm_acûss_mask_em±y
(cÚ¡ 
¢d_pcm_acûss_mask_t
 *
mask
)

4049  
	`¢d_mask_em±y
((cÚ¡ 
¢d_mask_t
 *è
mask
);

4050 
	}
}

4057 
	$¢d_pcm_acûss_mask_£t
(
¢d_pcm_acûss_mask_t
 *
mask
, 
¢d_pcm_acûss_t
 
v®
)

4059 
	`¢d_mask_£t
((
¢d_mask_t
 *è
mask
, (è
v®
);

4060 
	}
}

4067 
	$¢d_pcm_acûss_mask_»£t
(
¢d_pcm_acûss_mask_t
 *
mask
, 
¢d_pcm_acûss_t
 
v®
)

4069 
	`¢d_mask_»£t
((
¢d_mask_t
 *è
mask
, (è
v®
);

4070 
	}
}

4076 
size_t
 
	$¢d_pcm_fÜm©_mask_sizeof
()

4078  (
¢d_pcm_fÜm©_mask_t
);

4079 
	}
}

4086 
	$¢d_pcm_fÜm©_mask_m®loc
(
¢d_pcm_fÜm©_mask_t
 **
±r
)

4088 
	`as£¹
(
±r
);

4089 *
±r
 = 
	`ÿÎoc
(1, (
¢d_pcm_fÜm©_mask_t
));

4090 ià(!*
±r
)

4091  -
ENOMEM
;

4093 
	}
}

4099 
	$¢d_pcm_fÜm©_mask_ä“
(
¢d_pcm_fÜm©_mask_t
 *
obj
)

4101 
	`ä“
(
obj
);

4102 
	}
}

4109 
	$¢d_pcm_fÜm©_mask_cİy
(
¢d_pcm_fÜm©_mask_t
 *
d¡
, cÚ¡ snd_pcm_fÜm©_mask_ˆ*
¤c
)

4111 
	`as£¹
(
d¡
 && 
¤c
);

4112 *
d¡
 = *
¤c
;

4113 
	}
}

4119 
	$¢d_pcm_fÜm©_mask_nÚe
(
¢d_pcm_fÜm©_mask_t
 *
mask
)

4121 
	`¢d_mask_nÚe
((
¢d_mask_t
 *è
mask
);

4122 
	}
}

4128 
	$¢d_pcm_fÜm©_mask_ªy
(
¢d_pcm_fÜm©_mask_t
 *
mask
)

4130 
	`¢d_mask_ªy
((
¢d_mask_t
 *è
mask
);

4131 
	}
}

4138 
	$¢d_pcm_fÜm©_mask_‹¡
(cÚ¡ 
¢d_pcm_fÜm©_mask_t
 *
mask
, 
¢d_pcm_fÜm©_t
 
v®
)

4140  
	`¢d_mask_‹¡
((cÚ¡ 
¢d_mask_t
 *è
mask
, (è
v®
);

4141 
	}
}

4149 
	$¢d_pcm_fÜm©_mask_em±y
(cÚ¡ 
¢d_pcm_fÜm©_mask_t
 *
mask
)

4151  
	`¢d_mask_em±y
((cÚ¡ 
¢d_mask_t
 *è
mask
);

4152 
	}
}

4159 
	$¢d_pcm_fÜm©_mask_£t
(
¢d_pcm_fÜm©_mask_t
 *
mask
, 
¢d_pcm_fÜm©_t
 
v®
)

4161 
	`¢d_mask_£t
((
¢d_mask_t
 *è
mask
, (è
v®
);

4162 
	}
}

4169 
	$¢d_pcm_fÜm©_mask_»£t
(
¢d_pcm_fÜm©_mask_t
 *
mask
, 
¢d_pcm_fÜm©_t
 
v®
)

4171 
	`¢d_mask_»£t
((
¢d_mask_t
 *è
mask
, (è
v®
);

4172 
	}
}

4179 
size_t
 
	$¢d_pcm_subfÜm©_mask_sizeof
()

4181  (
¢d_pcm_subfÜm©_mask_t
);

4182 
	}
}

4189 
	$¢d_pcm_subfÜm©_mask_m®loc
(
¢d_pcm_subfÜm©_mask_t
 **
±r
)

4191 
	`as£¹
(
±r
);

4192 *
±r
 = 
	`ÿÎoc
(1, (
¢d_pcm_subfÜm©_mask_t
));

4193 ià(!*
±r
)

4194  -
ENOMEM
;

4196 
	}
}

4202 
	$¢d_pcm_subfÜm©_mask_ä“
(
¢d_pcm_subfÜm©_mask_t
 *
obj
)

4204 
	`ä“
(
obj
);

4205 
	}
}

4212 
	$¢d_pcm_subfÜm©_mask_cİy
(
¢d_pcm_subfÜm©_mask_t
 *
d¡
, cÚ¡ snd_pcm_subfÜm©_mask_ˆ*
¤c
)

4214 
	`as£¹
(
d¡
 && 
¤c
);

4215 *
d¡
 = *
¤c
;

4216 
	}
}

4222 
	$¢d_pcm_subfÜm©_mask_nÚe
(
¢d_pcm_subfÜm©_mask_t
 *
mask
)

4224 
	`¢d_mask_nÚe
((
¢d_mask_t
 *è
mask
);

4225 
	}
}

4231 
	$¢d_pcm_subfÜm©_mask_ªy
(
¢d_pcm_subfÜm©_mask_t
 *
mask
)

4233 
	`¢d_mask_ªy
((
¢d_mask_t
 *è
mask
);

4234 
	}
}

4241 
	$¢d_pcm_subfÜm©_mask_‹¡
(cÚ¡ 
¢d_pcm_subfÜm©_mask_t
 *
mask
, 
¢d_pcm_subfÜm©_t
 
v®
)

4243  
	`¢d_mask_‹¡
((cÚ¡ 
¢d_mask_t
 *è
mask
, (è
v®
);

4244 
	}
}

4252 
	$¢d_pcm_subfÜm©_mask_em±y
(cÚ¡ 
¢d_pcm_subfÜm©_mask_t
 *
mask
)

4254  
	`¢d_mask_em±y
((cÚ¡ 
¢d_mask_t
 *è
mask
);

4255 
	}
}

4262 
	$¢d_pcm_subfÜm©_mask_£t
(
¢d_pcm_subfÜm©_mask_t
 *
mask
, 
¢d_pcm_subfÜm©_t
 
v®
)

4264 
	`¢d_mask_£t
((
¢d_mask_t
 *è
mask
, (è
v®
);

4265 
	}
}

4272 
	$¢d_pcm_subfÜm©_mask_»£t
(
¢d_pcm_subfÜm©_mask_t
 *
mask
, 
¢d_pcm_subfÜm©_t
 
v®
)

4274 
	`¢d_mask_»£t
((
¢d_mask_t
 *è
mask
, (è
v®
);

4275 
	}
}

4282 
size_t
 
	$¢d_pcm_hw_·¿ms_sizeof
()

4284  (
¢d_pcm_hw_·¿ms_t
);

4285 
	}
}

4292 
	$¢d_pcm_hw_·¿ms_m®loc
(
¢d_pcm_hw_·¿ms_t
 **
±r
)

4294 
	`as£¹
(
±r
);

4295 *
±r
 = 
	`ÿÎoc
(1, (
¢d_pcm_hw_·¿ms_t
));

4296 ià(!*
±r
)

4297  -
ENOMEM
;

4299 
	}
}

4305 
	$¢d_pcm_hw_·¿ms_ä“
(
¢d_pcm_hw_·¿ms_t
 *
obj
)

4307 
	`ä“
(
obj
);

4308 
	}
}

4315 
	$¢d_pcm_hw_·¿ms_cİy
(
¢d_pcm_hw_·¿ms_t
 *
d¡
, cÚ¡ snd_pcm_hw_·¿ms_ˆ*
¤c
)

4317 
	`as£¹
(
d¡
 && 
¤c
);

4318 *
d¡
 = *
¤c
;

4319 
	}
}

4328 #iâdeà
DOXYGEN


4329 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_acûss
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 *
acûss
)

4331 
	$¢d_pcm_hw_·¿ms_g‘_acûss
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 *
acûss
)

4334 
_v®
;

4335 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
, &
_v®
, 
NULL
);

4336 ià(
”r
 >= 0)

4337 *
acûss
 = 
_v®
;

4338  
”r
;

4339 
	}
}

4348 
	$¢d_pcm_hw_·¿ms_‹¡_acûss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 
acûss
)

4350  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_ACCESS
, 
acûss
, 0);

4351 
	}
}

4360 
	$¢d_pcm_hw_·¿ms_£t_acûss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 
acûss
)

4362  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_ACCESS
, 
acûss
, 0);

4363 
	}
}

4372 #iâdeà
DOXYGEN


4373 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_acûss_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 *
acûss
)

4375 
	$¢d_pcm_hw_·¿ms_£t_acûss_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 *
acûss
)

4378  
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
, 
acûss
, 
NULL
);

4379 
	}
}

4388 #iâdeà
DOXYGEN


4389 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_acûss_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 *
acûss
)

4391 
	$¢d_pcm_hw_·¿ms_£t_acûss_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 *
acûss
)

4394  
	`¢d_pcm_hw_·¿m_£t_Ï¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
, 
acûss
, 
NULL
);

4395 
	}
}

4404 
	$¢d_pcm_hw_·¿ms_£t_acûss_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_mask_t
 *
mask
)

4406  
	`¢d_pcm_hw_·¿m_£t_mask
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_ACCESS
, (
¢d_mask_t
 *è
mask
);

4407 
	}
}

4414 
	$¢d_pcm_hw_·¿ms_g‘_acûss_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_mask_t
 *
mask
)

4416 ià(
·¿ms
 =ğ
NULL
 || 
mask
 == NULL)

4417  -
EINVAL
;

4418 
	`¢d_pcm_acûss_mask_cİy
(
mask
, 
	`¢d_pcm_hw_·¿m_g‘_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
));

4420 
	}
}

4429 #iâdeà
DOXYGEN


4430 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 *
fÜm©
)

4432 
	$¢d_pcm_hw_·¿ms_g‘_fÜm©
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 *
fÜm©
)

4435  
	`¢d_pcm_hw_·¿m_g‘
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
, (*)
fÜm©
, 
NULL
);

4436 
	}
}

4445 
	$¢d_pcm_hw_·¿ms_‹¡_fÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 
fÜm©
)

4447  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_FORMAT
, 
fÜm©
, 0);

4448 
	}
}

4457 
	$¢d_pcm_hw_·¿ms_£t_fÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 
fÜm©
)

4459  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_FORMAT
, 
fÜm©
, 0);

4460 
	}
}

4469 #iâdeà
DOXYGEN


4470 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_fÜm©_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 *
fÜm©
)

4472 
	$¢d_pcm_hw_·¿ms_£t_fÜm©_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 *
fÜm©
)

4475  
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
, (*)
fÜm©
, 
NULL
);

4476 
	}
}

4485 #iâdeà
DOXYGEN


4486 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_fÜm©_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 *
fÜm©
)

4488 
	$¢d_pcm_hw_·¿ms_£t_fÜm©_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 *
fÜm©
)

4491  
	`¢d_pcm_hw_·¿m_£t_Ï¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
, (*)
fÜm©
, 
NULL
);

4492 
	}
}

4501 
	$¢d_pcm_hw_·¿ms_£t_fÜm©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_mask_t
 *
mask
)

4503  
	`¢d_pcm_hw_·¿m_£t_mask
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_FORMAT
, (
¢d_mask_t
 *è
mask
);

4504 
	}
}

4511 
	$¢d_pcm_hw_·¿ms_g‘_fÜm©_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_mask_t
 *
mask
)

4513 
	`¢d_pcm_fÜm©_mask_cİy
(
mask
, 
	`¢d_pcm_hw_·¿m_g‘_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
));

4514 
	}
}

4523 #iâdeà
DOXYGEN


4524 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_subfÜm©
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 *
subfÜm©
)

4526 
	$¢d_pcm_hw_·¿ms_g‘_subfÜm©
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 *
subfÜm©
)

4529  
	`¢d_pcm_hw_·¿m_g‘
(
·¿ms
, 
SND_PCM_HW_PARAM_SUBFORMAT
, (*)
subfÜm©
, 
NULL
);

4530 
	}
}

4539 
	$¢d_pcm_hw_·¿ms_‹¡_subfÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 
subfÜm©
)

4541  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_SUBFORMAT
, 
subfÜm©
, 0);

4542 
	}
}

4551 
	$¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 
subfÜm©
)

4553  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_SUBFORMAT
, 
subfÜm©
, 0);

4554 
	}
}

4563 #iâdeà
DOXYGEN


4564 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_subfÜm©_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 *
subfÜm©
)

4566 
	$¢d_pcm_hw_·¿ms_£t_subfÜm©_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 *
subfÜm©
)

4569  
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_SUBFORMAT
, (*)
subfÜm©
, 
NULL
);

4570 
	}
}

4579 #iâdeà
DOXYGEN


4580 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_subfÜm©_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 *
subfÜm©
)

4582 
	$¢d_pcm_hw_·¿ms_£t_subfÜm©_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 *
subfÜm©
)

4585  
	`¢d_pcm_hw_·¿m_£t_Ï¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_SUBFORMAT
, (*)
subfÜm©
, 
NULL
);

4586 
	}
}

4595 
	$¢d_pcm_hw_·¿ms_£t_subfÜm©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_mask_t
 *
mask
)

4597  
	`¢d_pcm_hw_·¿m_£t_mask
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_SUBFORMAT
, (
¢d_mask_t
 *è
mask
);

4598 
	}
}

4605 
	$¢d_pcm_hw_·¿ms_g‘_subfÜm©_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_mask_t
 *
mask
)

4607 
	`¢d_pcm_subfÜm©_mask_cİy
(
mask
, 
	`¢d_pcm_hw_·¿m_g‘_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_SUBFORMAT
));

4608 
	}
}

4617 #iâdeà
DOXYGEN


4618 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_chªÃls
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

4620 
	$¢d_pcm_hw_·¿ms_g‘_chªÃls
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

4623  
	`¢d_pcm_hw_·¿m_g‘
(
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
v®
, 
NULL
);

4624 
	}
}

4632 #iâdeà
DOXYGEN


4633 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_chªÃls_mš
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

4635 
	$¢d_pcm_hw_·¿ms_g‘_chªÃls_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

4638  
	`¢d_pcm_hw_·¿m_g‘_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
v®
, 
NULL
);

4639 
	}
}

4647 #iâdeà
DOXYGEN


4648 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_chªÃls_max
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

4650 
	$¢d_pcm_hw_·¿ms_g‘_chªÃls_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

4653  
	`¢d_pcm_hw_·¿m_g‘_max
(
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
v®
, 
NULL
);

4654 
	}
}

4663 
	$¢d_pcm_hw_·¿ms_‹¡_chªÃls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
)

4665  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_CHANNELS
, 
v®
, 0);

4666 
	}
}

4675 
	$¢d_pcm_hw_·¿ms_£t_chªÃls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
)

4677  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_CHANNELS
, 
v®
, 0);

4678 
	}
}

4687 
	$¢d_pcm_hw_·¿ms_£t_chªÃls_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

4689  
	`¢d_pcm_hw_·¿m_£t_mš
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_CHANNELS
, 
v®
, 
NULL
);

4690 
	}
}

4699 
	$¢d_pcm_hw_·¿ms_£t_chªÃls_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

4701  
	`¢d_pcm_hw_·¿m_£t_max
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_CHANNELS
, 
v®
, 
NULL
);

4702 
	}
}

4712 
	$¢d_pcm_hw_·¿ms_£t_chªÃls_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
max
)

4714  
	`¢d_pcm_hw_·¿m_£t_mšmax
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_CHANNELS
, 
mš
, 
NULL
, 
max
, NULL);

4715 
	}
}

4724 #iâdeà
DOXYGEN


4725 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_chªÃls_Ã¬
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

4727 
	$¢d_pcm_hw_·¿ms_£t_chªÃls_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

4730  
	`¢d_pcm_hw_·¿m_£t_Ã¬
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
v®
, 
NULL
);

4731 
	}
}

4740 #iâdeà
DOXYGEN


4741 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_chªÃls_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

4743 
	$¢d_pcm_hw_·¿ms_£t_chªÃls_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

4746  
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
v®
, 
NULL
);

4747 
	}
}

4756 #iâdeà
DOXYGEN


4757 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_chªÃls_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

4759 
	$¢d_pcm_hw_·¿ms_£t_chªÃls_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

4762  
	`¢d_pcm_hw_·¿m_£t_Ï¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
v®
, 
NULL
);

4763 
	}
}

4775 #iâdeà
DOXYGEN


4776 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_¿‹
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

4778 
	$¢d_pcm_hw_·¿ms_g‘_¿‹
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

4781  
	`¢d_pcm_hw_·¿m_g‘
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
, 
v®
, 
dœ
);

4782 
	}
}

4793 #iâdeà
DOXYGEN


4794 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_¿‹_mš
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

4796 
	$¢d_pcm_hw_·¿ms_g‘_¿‹_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

4799  
	`¢d_pcm_hw_·¿m_g‘_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
, 
v®
, 
dœ
);

4800 
	}
}

4811 #iâdeà
DOXYGEN


4812 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_¿‹_max
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

4814 
	$¢d_pcm_hw_·¿ms_g‘_¿‹_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

4817  
	`¢d_pcm_hw_·¿m_g‘_max
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
, 
v®
, 
dœ
);

4818 
	}
}

4830 
	$¢d_pcm_hw_·¿ms_‹¡_¿‹
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
)

4832  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_RATE
, 
v®
, 
dœ
);

4833 
	}
}

4845 
	$¢d_pcm_hw_·¿ms_£t_¿‹
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
)

4847  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_RATE
, 
v®
, 
dœ
);

4848 
	}
}

4860 
	$¢d_pcm_hw_·¿ms_£t_¿‹_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

4862  
	`¢d_pcm_hw_·¿m_£t_mš
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_RATE
, 
v®
, 
dœ
);

4863 
	}
}

4875 
	$¢d_pcm_hw_·¿ms_£t_¿‹_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

4877  
	`¢d_pcm_hw_·¿m_£t_max
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_RATE
, 
v®
, 
dœ
);

4878 
	}
}

4892 
	$¢d_pcm_hw_·¿ms_£t_¿‹_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
)

4894  
	`¢d_pcm_hw_·¿m_£t_mšmax
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_RATE
, 
mš
, 
mšdœ
, 
max
, 
maxdœ
);

4895 
	}
}

4907 #iâdeà
DOXYGEN


4908 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_¿‹_Ã¬
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

4910 
	$¢d_pcm_hw_·¿ms_£t_¿‹_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

4913  
	`¢d_pcm_hw_·¿m_£t_Ã¬
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_RATE
, 
v®
, 
dœ
);

4914 
	}
}

4926 #iâdeà
DOXYGEN


4927 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_¿‹_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

4929 
	$¢d_pcm_hw_·¿ms_£t_¿‹_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

4932  
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_RATE
, 
v®
, 
dœ
);

4933 
	}
}

4945 #iâdeà
DOXYGEN


4946 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_¿‹_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

4948 
	$¢d_pcm_hw_·¿ms_£t_¿‹_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

4951  
	`¢d_pcm_hw_·¿m_£t_Ï¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_RATE
, 
v®
, 
dœ
);

4952 
	}
}

4961 
	$¢d_pcm_hw_·¿ms_£t_¿‹_»§m¶e
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
)

4963 
	`as£¹
(
pcm
 && 
·¿ms
);

4964 ià(!
v®
)

4965 
·¿ms
->
æags
 |ğ
SND_PCM_HW_PARAMS_NORESAMPLE
;

4967 
·¿ms
->
æags
 &ğ~
SND_PCM_HW_PARAMS_NORESAMPLE
;

4968 
·¿ms
->
rmask
 = ~0;

4969  
	`¢d_pcm_hw_»fše
(
pcm
, 
·¿ms
);

4970 
	}
}

4979 
	$¢d_pcm_hw_·¿ms_g‘_¿‹_»§m¶e
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

4981 
	`as£¹
(
pcm
 && 
·¿ms
 && 
v®
);

4982 *
v®
 = 
·¿ms
->
æags
 & 
SND_PCM_HW_PARAMS_NORESAMPLE
 ? 0 : 1;

4984 
	}
}

4993 
	$¢d_pcm_hw_·¿ms_£t_expÜt_bufãr
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
)

4995 
	`as£¹
(
pcm
 && 
·¿ms
);

4996 ià(
v®
)

4997 
·¿ms
->
æags
 |ğ
SND_PCM_HW_PARAMS_EXPORT_BUFFER
;

4999 
·¿ms
->
æags
 &ğ~
SND_PCM_HW_PARAMS_EXPORT_BUFFER
;

5000 
·¿ms
->
rmask
 = ~0;

5001  
	`¢d_pcm_hw_»fše
(
pcm
, 
·¿ms
);

5002 
	}
}

5011 
	$¢d_pcm_hw_·¿ms_g‘_expÜt_bufãr
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

5013 
	`as£¹
(
pcm
 && 
·¿ms
 && 
v®
);

5014 *
v®
 = 
·¿ms
->
æags
 & 
SND_PCM_HW_PARAMS_EXPORT_BUFFER
 ? 1 : 0;

5016 
	}
}

5040 
	$¢d_pcm_hw_·¿ms_£t_³riod_wakeup
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
)

5042 
	`as£¹
(
pcm
 && 
·¿ms
);

5044 ià(!
v®
) {

5045 ià(!(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
))

5046  -
EINVAL
;

5047 
·¿ms
->
æags
 |ğ
SND_PCM_HW_PARAMS_NO_PERIOD_WAKEUP
;

5049 
·¿ms
->
æags
 &ğ~
SND_PCM_HW_PARAMS_NO_PERIOD_WAKEUP
;

5050 
·¿ms
->
rmask
 = ~0;

5052  
	`¢d_pcm_hw_»fše
(
pcm
, 
·¿ms
);

5053 
	}
}

5062 
	$¢d_pcm_hw_·¿ms_g‘_³riod_wakeup
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

5064 
	`as£¹
(
pcm
 && 
·¿ms
 && 
v®
);

5065 *
v®
 = 
·¿ms
->
æags
 & 
SND_PCM_HW_PARAMS_NO_PERIOD_WAKEUP
 ? 0 : 1;

5067 
	}
}

5081 
	$¢d_pcm_hw_·¿ms_£t_d¿š_s’û
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
)

5083 
	`as£¹
(
pcm
 && 
·¿ms
);

5084 ià(
v®
)

5085 
·¿ms
->
æags
 &ğ~
SND_PCM_HW_PARAMS_NO_DRAIN_SILENCE
;

5087 
·¿ms
->
æags
 |ğ
SND_PCM_HW_PARAMS_NO_DRAIN_SILENCE
;

5088 
·¿ms
->
rmask
 = ~0;

5089  
	`¢d_pcm_hw_»fše
(
pcm
, 
·¿ms
);

5090 
	}
}

5099 
	$¢d_pcm_hw_·¿ms_g‘_d¿š_s’û
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
)

5101 
	`as£¹
(
pcm
 && 
·¿ms
 && 
v®
);

5102 *
v®
 = 
·¿ms
->
æags
 & 
SND_PCM_HW_PARAMS_NO_DRAIN_SILENCE
 ? 0 : 1;

5104 
	}
}

5115 #iâdeà
DOXYGEN


5116 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_time
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5118 
	$¢d_pcm_hw_·¿ms_g‘_³riod_time
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5121  
	`¢d_pcm_hw_·¿m_g‘
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
v®
, 
dœ
);

5122 
	}
}

5133 #iâdeà
DOXYGEN


5134 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_time_mš
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5136 
	$¢d_pcm_hw_·¿ms_g‘_³riod_time_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5139  
	`¢d_pcm_hw_·¿m_g‘_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
v®
, 
dœ
);

5140 
	}
}

5151 #iâdeà
DOXYGEN


5152 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_time_max
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5154 
	$¢d_pcm_hw_·¿ms_g‘_³riod_time_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5157  
	`¢d_pcm_hw_·¿m_g‘_max
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
v®
, 
dœ
);

5158 
	}
}

5170 
	$¢d_pcm_hw_·¿ms_‹¡_³riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
)

5172  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
v®
, 
dœ
);

5173 
	}
}

5185 
	$¢d_pcm_hw_·¿ms_£t_³riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
)

5187  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
v®
, 
dœ
);

5188 
	}
}

5201 
	$¢d_pcm_hw_·¿ms_£t_³riod_time_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5203  
	`¢d_pcm_hw_·¿m_£t_mš
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
v®
, 
dœ
);

5204 
	}
}

5216 
	$¢d_pcm_hw_·¿ms_£t_³riod_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5218  
	`¢d_pcm_hw_·¿m_£t_max
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
v®
, 
dœ
);

5219 
	}
}

5233 
	$¢d_pcm_hw_·¿ms_£t_³riod_time_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
)

5235  
	`¢d_pcm_hw_·¿m_£t_mšmax
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
mš
, 
mšdœ
, 
max
, 
maxdœ
);

5236 
	}
}

5248 #iâdeà
DOXYGEN


5249 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_time_Ã¬
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5251 
	$¢d_pcm_hw_·¿ms_£t_³riod_time_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5254  
	`¢d_pcm_hw_·¿m_£t_Ã¬
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
v®
, 
dœ
);

5255 
	}
}

5267 #iâdeà
DOXYGEN


5268 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_time_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5270 
	$¢d_pcm_hw_·¿ms_£t_³riod_time_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5273  
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
v®
, 
dœ
);

5274 
	}
}

5284 #iâdeà
DOXYGEN


5285 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_time_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5287 
	$¢d_pcm_hw_·¿ms_£t_³riod_time_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5290  
	`¢d_pcm_hw_·¿m_£t_Ï¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
v®
, 
dœ
);

5291 
	}
}

5303 #iâdeà
DOXYGEN


5304 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_size
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
)

5306 
	$¢d_pcm_hw_·¿ms_g‘_³riod_size
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
)

5309 
_v®
;

5310 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_v®
, 
dœ
);

5311 ià(
”r
 >= 0)

5312 *
v®
 = 
_v®
;

5313  
”r
;

5314 
	}
}

5325 #iâdeà
DOXYGEN


5326 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_size_mš
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
)

5328 
	$¢d_pcm_hw_·¿ms_g‘_³riod_size_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
)

5331 
_v®
 = *
v®
;

5332 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_v®
, 
dœ
);

5333 ià(
”r
 >= 0)

5334 *
v®
 = 
_v®
;

5335  
”r
;

5336 
	}
}

5347 #iâdeà
DOXYGEN


5348 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_size_max
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
)

5350 
	$¢d_pcm_hw_·¿ms_g‘_³riod_size_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
)

5353 
_v®
 = *
v®
;

5354 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘_max
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_v®
, 
dœ
);

5355 ià(
”r
 >= 0)

5356 *
v®
 = 
_v®
;

5357  
”r
;

5358 
	}
}

5370 
	$¢d_pcm_hw_·¿ms_‹¡_³riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
, 
dœ
)

5372  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 
v®
, 
dœ
);

5373 
	}
}

5385 
	$¢d_pcm_hw_·¿ms_£t_³riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
, 
dœ
)

5387  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 
v®
, 
dœ
);

5388 
	}
}

5400 
	$¢d_pcm_hw_·¿ms_£t_³riod_size_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
)

5402 
_v®
 = *
v®
;

5403 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_mš
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_v®
, 
dœ
);

5404 ià(
”r
 >= 0)

5405 *
v®
 = 
_v®
;

5406  
”r
;

5407 
	}
}

5419 
	$¢d_pcm_hw_·¿ms_£t_³riod_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
)

5421 
_v®
 = *
v®
;

5422 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_max
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_v®
, 
dœ
);

5423 ià(
”r
 >= 0)

5424 *
v®
 = 
_v®
;

5425  
”r
;

5426 
	}
}

5440 
	$¢d_pcm_hw_·¿ms_£t_³riod_size_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
mš
, *
mšdœ
, snd_pcm_uäames_ˆ*
max
, *
maxdœ
)

5442 
_mš
 = *
mš
;

5443 
_max
 = *
max
;

5444 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_mšmax
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_mš
, 
mšdœ
, &
_max
, 
maxdœ
);

5445 *
mš
 = 
_mš
;

5446 *
max
 = 
_max
;

5447  
”r
;

5448 
	}
}

5460 #iâdeà
DOXYGEN


5461 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_size_Ã¬
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
)

5463 
	$¢d_pcm_hw_·¿ms_£t_³riod_size_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
)

5466 
_v®
 = *
v®
;

5467 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_Ã¬
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_v®
, 
dœ
);

5468 ià(
”r
 >= 0)

5469 *
v®
 = 
_v®
;

5470  
”r
;

5471 
	}
}

5483 #iâdeà
DOXYGEN


5484 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_size_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
)

5486 
	$¢d_pcm_hw_·¿ms_£t_³riod_size_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
)

5489 
_v®
;

5490 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_v®
, 
dœ
);

5491 ià(
”r
 >= 0)

5492 *
v®
 = 
_v®
;

5493  
”r
;

5494 
	}
}

5506 #iâdeà
DOXYGEN


5507 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_size_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
)

5509 
	$¢d_pcm_hw_·¿ms_£t_³riod_size_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
)

5512 
_v®
;

5513 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_Ï¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_v®
, 
dœ
);

5514 ià(
”r
 >= 0)

5515 *
v®
 = 
_v®
;

5516  
”r
;

5517 
	}
}

5525 
	$¢d_pcm_hw_·¿ms_£t_³riod_size_š‹g”
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

5527  
	`¢d_pcm_hw_·¿m_£t_š‹g”
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
);

5528 
	}
}

5540 #iâdeà
DOXYGEN


5541 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riods
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5543 
	$¢d_pcm_hw_·¿ms_g‘_³riods
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5546  
	`¢d_pcm_hw_·¿m_g‘
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIODS
, 
v®
, 
dœ
);

5547 
	}
}

5558 #iâdeà
DOXYGEN


5559 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riods_mš
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5561 
	$¢d_pcm_hw_·¿ms_g‘_³riods_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5564  
	`¢d_pcm_hw_·¿m_g‘_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIODS
, 
v®
, 
dœ
);

5565 
	}
}

5576 #iâdeà
DOXYGEN


5577 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riods_max
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5579 
	$¢d_pcm_hw_·¿ms_g‘_³riods_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5582  
	`¢d_pcm_hw_·¿m_g‘_max
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIODS
, 
v®
, 
dœ
);

5583 
	}
}

5595 
	$¢d_pcm_hw_·¿ms_‹¡_³riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
)

5597  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_PERIODS
, 
v®
, 
dœ
);

5598 
	}
}

5610 
	$¢d_pcm_hw_·¿ms_£t_³riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
)

5612  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIODS
, 
v®
, 
dœ
);

5613 
	}
}

5625 
	$¢d_pcm_hw_·¿ms_£t_³riods_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5627  
	`¢d_pcm_hw_·¿m_£t_mš
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIODS
, 
v®
, 
dœ
);

5628 
	}
}

5640 
	$¢d_pcm_hw_·¿ms_£t_³riods_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5642  
	`¢d_pcm_hw_·¿m_£t_max
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIODS
, 
v®
, 
dœ
);

5643 
	}
}

5657 
	$¢d_pcm_hw_·¿ms_£t_³riods_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
)

5659  
	`¢d_pcm_hw_·¿m_£t_mšmax
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIODS
, 
mš
, 
mšdœ
, 
max
, 
maxdœ
);

5660 
	}
}

5672 #iâdeà
DOXYGEN


5673 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riods_Ã¬
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5675 
	$¢d_pcm_hw_·¿ms_£t_³riods_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5678  
	`¢d_pcm_hw_·¿m_£t_Ã¬
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_PERIODS
, 
v®
, 
dœ
);

5679 
	}
}

5691 #iâdeà
DOXYGEN


5692 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riods_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5694 
	$¢d_pcm_hw_·¿ms_£t_³riods_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5697  
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_PERIODS
, 
v®
, 
dœ
);

5698 
	}
}

5710 #iâdeà
DOXYGEN


5711 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riods_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5713 
	$¢d_pcm_hw_·¿ms_£t_³riods_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5716  
	`¢d_pcm_hw_·¿m_£t_Ï¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_PERIODS
, 
v®
, 
dœ
);

5717 
	}
}

5725 
	$¢d_pcm_hw_·¿ms_£t_³riods_š‹g”
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

5727  
	`¢d_pcm_hw_·¿m_£t_š‹g”
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIODS
);

5728 
	}
}

5740 #iâdeà
DOXYGEN


5741 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5743 
	$¢d_pcm_hw_·¿ms_g‘_bufãr_time
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5746  
	`¢d_pcm_hw_·¿m_g‘
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
v®
, 
dœ
);

5747 
	}
}

5758 #iâdeà
DOXYGEN


5759 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time_mš
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5761 
	$¢d_pcm_hw_·¿ms_g‘_bufãr_time_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5764  
	`¢d_pcm_hw_·¿m_g‘_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
v®
, 
dœ
);

5765 
	}
}

5776 #iâdeà
DOXYGEN


5777 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time_max
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5779 
	$¢d_pcm_hw_·¿ms_g‘_bufãr_time_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5782  
	`¢d_pcm_hw_·¿m_g‘_max
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
v®
, 
dœ
);

5783 
	}
}

5795 
	$¢d_pcm_hw_·¿ms_‹¡_bufãr_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
)

5797  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
v®
, 
dœ
);

5798 
	}
}

5810 
	$¢d_pcm_hw_·¿ms_£t_bufãr_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
)

5812  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
v®
, 
dœ
);

5813 
	}
}

5825 
	$¢d_pcm_hw_·¿ms_£t_bufãr_time_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5827  
	`¢d_pcm_hw_·¿m_£t_mš
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
v®
, 
dœ
);

5828 
	}
}

5840 
	$¢d_pcm_hw_·¿ms_£t_bufãr_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5842  
	`¢d_pcm_hw_·¿m_£t_max
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
v®
, 
dœ
);

5843 
	}
}

5857 
	$¢d_pcm_hw_·¿ms_£t_bufãr_time_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
)

5859  
	`¢d_pcm_hw_·¿m_£t_mšmax
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
mš
, 
mšdœ
, 
max
, 
maxdœ
);

5860 
	}
}

5872 #iâdeà
DOXYGEN


5873 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ã¬
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5875 
	$¢d_pcm_hw_·¿ms_£t_bufãr_time_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5878  
	`¢d_pcm_hw_·¿m_£t_Ã¬
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
v®
, 
dœ
);

5879 
	}
}

5891 #iâdeà
DOXYGEN


5892 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5894 
	$¢d_pcm_hw_·¿ms_£t_bufãr_time_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5897  
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
v®
, 
dœ
);

5898 
	}
}

5910 #iâdeà
DOXYGEN


5911 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5913 
	$¢d_pcm_hw_·¿ms_£t_bufãr_time_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

5916  
	`¢d_pcm_hw_·¿m_£t_Ï¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
v®
, 
dœ
);

5917 
	}
}

5926 #iâdeà
DOXYGEN


5927 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

5929 
	$¢d_pcm_hw_·¿ms_g‘_bufãr_size
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

5932 
_v®
;

5933 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_v®
, 
NULL
);

5934 ià(
”r
 >= 0)

5935 *
v®
 = 
_v®
;

5936  
”r
;

5937 
	}
}

5945 #iâdeà
DOXYGEN


5946 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size_mš
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

5948 
	$¢d_pcm_hw_·¿ms_g‘_bufãr_size_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

5951 
_v®
;

5952 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_v®
, 
NULL
);

5953 ià(
”r
 >= 0)

5954 *
v®
 = 
_v®
;

5955  
”r
;

5956 
	}
}

5966 #iâdeà
DOXYGEN


5967 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size_max
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

5969 
	$¢d_pcm_hw_·¿ms_g‘_bufãr_size_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

5972 
_v®
;

5973 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘_max
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_v®
, 
NULL
);

5974 ià(
”r
 >= 0)

5975 *
v®
 = 
_v®
;

5976  
”r
;

5977 
	}
}

5988 
	$¢d_pcm_hw_·¿ms_‹¡_bufãr_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
)

5990  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, 
v®
, 0);

5991 
	}
}

6002 
	$¢d_pcm_hw_·¿ms_£t_bufãr_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
)

6004  
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, 
v®
, 0);

6005 
	}
}

6014 
	$¢d_pcm_hw_·¿ms_£t_bufãr_size_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6016 
_v®
 = *
v®
;

6017 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_mš
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_v®
, 
NULL
);

6018 ià(
”r
 >= 0)

6019 *
v®
 = 
_v®
;

6020  
”r
;

6021 
	}
}

6030 
	$¢d_pcm_hw_·¿ms_£t_bufãr_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6032 
_v®
 = *
v®
;

6033 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_max
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_v®
, 
NULL
);

6034 ià(
”r
 >= 0)

6035 *
v®
 = 
_v®
;

6036  
”r
;

6037 
	}
}

6047 
	$¢d_pcm_hw_·¿ms_£t_bufãr_size_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
mš
, snd_pcm_uäames_ˆ*
max
)

6049 
_mš
 = *
mš
;

6050 
_max
 = *
max
;

6051 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_mšmax
(
pcm
, 
·¿ms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_mš
, 
NULL
, &
_max
, NULL);

6052 *
mš
 = 
_mš
;

6053 *
max
 = 
_max
;

6054  
”r
;

6055 
	}
}

6064 #iâdeà
DOXYGEN


6065 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ã¬
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6067 
	$¢d_pcm_hw_·¿ms_£t_bufãr_size_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6070 
_v®
 = *
v®
;

6071 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_Ã¬
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_v®
, 
NULL
);

6072 ià(
”r
 >= 0)

6073 *
v®
 = 
_v®
;

6074  
”r
;

6075 
	}
}

6084 #iâdeà
DOXYGEN


6085 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6087 
	$¢d_pcm_hw_·¿ms_£t_bufãr_size_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6090 
_v®
;

6091 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_v®
, 
NULL
);

6092 ià(
”r
 >= 0)

6093 *
v®
 = 
_v®
;

6094  
”r
;

6095 
	}
}

6104 #iâdeà
DOXYGEN


6105 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6107 
	$¢d_pcm_hw_·¿ms_£t_bufãr_size_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6110 
_v®
;

6111 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_Ï¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_v®
, 
NULL
);

6112 ià(
”r
 >= 0)

6113 *
v®
 = 
_v®
;

6114  
”r
;

6115 
	}
}

6127 #iâdeà
DOXYGEN


6128 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_tick_time
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
 
ATTRIBUTE_UNUSED
, *
v®
, *
dœ
 ATTRIBUTE_UNUSED)

6130 
	$¢d_pcm_hw_·¿ms_g‘_tick_time
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

6133 *
v®
 = 0;

6135 
	}
}

6146 #iâdeà
DOXYGEN


6147 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_tick_time_mš
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
 
ATTRIBUTE_UNUSED
, *
v®
, *
dœ
 ATTRIBUTE_UNUSED)

6149 
	$¢d_pcm_hw_·¿ms_g‘_tick_time_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

6152 *
v®
 = 0;

6154 
	}
}

6165 #iâdeà
DOXYGEN


6166 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_tick_time_max
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
 
ATTRIBUTE_UNUSED
, *
v®
, *
dœ
 ATTRIBUTE_UNUSED)

6168 
	$¢d_pcm_hw_·¿ms_g‘_tick_time_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

6171 *
v®
 = 0;

6173 
	}
}

6185 
	$¢d_pcm_hw_·¿ms_‹¡_tick_time
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
 ATTRIBUTE_UNUSED, 
v®
, 
dœ
 ATTRIBUTE_UNUSED)

6187  
v®
 ? -
EINVAL
 : 0;

6188 
	}
}

6200 
	$¢d_pcm_hw_·¿ms_£t_tick_time
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
 ATTRIBUTE_UNUSED, 
v®
 ATTRIBUTE_UNUSED, 
dœ
 ATTRIBUTE_UNUSED)

6203 
	}
}

6215 
	$¢d_pcm_hw_·¿ms_£t_tick_time_mš
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
 ATTRIBUTE_UNUSED, *
v®
 ATTRIBUTE_UNUSED, *
dœ
 ATTRIBUTE_UNUSED)

6218 
	}
}

6230 
	$¢d_pcm_hw_·¿ms_£t_tick_time_max
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
 ATTRIBUTE_UNUSED, *
v®
 ATTRIBUTE_UNUSED, *
dœ
 ATTRIBUTE_UNUSED)

6233 
	}
}

6247 
	$¢d_pcm_hw_·¿ms_£t_tick_time_mšmax
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
 ATTRIBUTE_UNUSED, *
mš
 ATTRIBUTE_UNUSED, *
mšdœ
 ATTRIBUTE_UNUSED, *
max
 ATTRIBUTE_UNUSED, *
maxdœ
 ATTRIBUTE_UNUSED)

6250 
	}
}

6262 #iâdeà
DOXYGEN


6263 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_tick_time_Ã¬
)(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
 ATTRIBUTE_UNUSED, *
v®
 ATTRIBUTE_UNUSED, *
dœ
 ATTRIBUTE_UNUSED)

6265 
	$¢d_pcm_hw_·¿ms_£t_tick_time_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

6269 
	}
}

6281 #iâdeà
DOXYGEN


6282 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_tick_time_fœ¡
)(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
 ATTRIBUTE_UNUSED, *
v®
 ATTRIBUTE_UNUSED, *
dœ
 ATTRIBUTE_UNUSED)

6284 
	$¢d_pcm_hw_·¿ms_£t_tick_time_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

6288 
	}
}

6300 #iâdeà
DOXYGEN


6301 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_tick_time_Ï¡
)(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
 ATTRIBUTE_UNUSED, *
v®
 ATTRIBUTE_UNUSED, *
dœ
 ATTRIBUTE_UNUSED)

6303 
	$¢d_pcm_hw_·¿ms_£t_tick_time_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
)

6307 
	}
}

6315 
	$¢d_pcm_hw_·¿ms_g‘_mš_®ign
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6317 
fÜm©
, 
chªÃls
, 
fb
, 
mš_®ign
;

6318 
”r
;

6320 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
, &
fÜm©
, 
NULL
);

6321 ià(
”r
 < 0)

6322  
”r
;

6323 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘
(
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
, &
chªÃls
, 
NULL
);

6324 ià(
”r
 < 0)

6325  
”r
;

6327 
fb
 = 
	`¢d_pcm_fÜm©_physiÿl_width
((
¢d_pcm_fÜm©_t
)
fÜm©
è* 
chªÃls
;

6328 
mš_®ign
 = 1;

6329 
fb
 % 8) {

6330 
fb
 *= 2;

6331 
mš_®ign
 *= 2;

6333 ià(
v®
)

6334 *
v®
 = 
mš_®ign
;

6336 
	}
}

6338 #iâdeà
DOXYGEN


6339 
	$¢d_pcm_sw_·¿ms_cu¼’t_no_lock
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
)

6341 
·¿ms
->
´Ùo
 = 
SNDRV_PCM_VERSION
;

6342 
·¿ms
->
t¡amp_mode
 = 
pcm
->tstamp_mode;

6343 
·¿ms
->
t¡amp_ty³
 = 
pcm
->tstamp_type;

6344 
·¿ms
->
³riod_¡•
 = 
pcm
->period_step;

6345 
·¿ms
->
¦“p_mš
 = 0;

6346 
·¿ms
->
ava_mš
 = 
pcm
->avail_min;

6347 
	`sw_£t_³riod_ev’t
(
·¿ms
, 
pcm
->
³riod_ev’t
);

6348 
·¿ms
->
xãr_®ign
 = 1;

6349 
·¿ms
->
¡¬t_th»shŞd
 = 
pcm
->start_threshold;

6350 
·¿ms
->
¡İ_th»shŞd
 = 
pcm
->stop_threshold;

6351 
·¿ms
->
s’û_th»shŞd
 = 
pcm
->silence_threshold;

6352 
·¿ms
->
s’û_size
 = 
pcm
->silence_size;

6353 
·¿ms
->
bound¬y
 = 
pcm
->boundary;

6354 
	}
}

6365 
	$¢d_pcm_sw_·¿ms_cu¼’t
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
)

6367 
	`as£¹
(
pcm
 && 
·¿ms
);

6368 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

6369 
	`SNDMSG
("PCM‚ot set up");

6370  -
EIO
;

6372 
	`__¢d_pcm_lock
(
pcm
);

6373 
	`¢d_pcm_sw_·¿ms_cu¼’t_no_lock
(
pcm
, 
·¿ms
);

6374 
	`__¢d_pcm_uÆock
(
pcm
);

6376 
	}
}

6384 
	$¢d_pcm_sw_·¿ms_dump
(
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_ouut_t
 *
out
)

6386 
	`¢d_ouut_´štf
(
out
, "t¡amp_mode: %s\n", 
	`¢d_pcm_t¡amp_mode_Çme
(
·¿ms
->
t¡amp_mode
));

6387 
	`¢d_ouut_´štf
(
out
, "t¡amp_ty³: %s\n", 
	`¢d_pcm_t¡amp_ty³_Çme
(
·¿ms
->
t¡amp_ty³
));

6388 
	`¢d_ouut_´štf
(
out
, "³riod_¡•: %u\n", 
·¿ms
->
³riod_¡•
);

6389 
	`¢d_ouut_´štf
(
out
, "ava_mš: %lu\n", 
·¿ms
->
ava_mš
);

6390 
	`¢d_ouut_´štf
(
out
, "¡¬t_th»shŞd: %ld\n", 
·¿ms
->
¡¬t_th»shŞd
);

6391 
	`¢d_ouut_´štf
(
out
, "¡İ_th»shŞd: %ld\n", 
·¿ms
->
¡İ_th»shŞd
);

6392 
	`¢d_ouut_´štf
(
out
, "s’û_th»shŞd: %lu\n", 
·¿ms
->
s’û_th»shŞd
);

6393 
	`¢d_ouut_´štf
(
out
, "s’û_size: %lu\n", 
·¿ms
->
s’û_size
);

6394 
	`¢d_ouut_´štf
(
out
, "bound¬y: %lu\n", 
·¿ms
->
bound¬y
);

6396 
	}
}

6402 
size_t
 
	$¢d_pcm_sw_·¿ms_sizeof
()

6404  (
¢d_pcm_sw_·¿ms_t
);

6405 
	}
}

6412 
	$¢d_pcm_sw_·¿ms_m®loc
(
¢d_pcm_sw_·¿ms_t
 **
±r
)

6414 
	`as£¹
(
±r
);

6415 *
±r
 = 
	`ÿÎoc
(1, (
¢d_pcm_sw_·¿ms_t
));

6416 ià(!*
±r
)

6417  -
ENOMEM
;

6419 
	}
}

6425 
	$¢d_pcm_sw_·¿ms_ä“
(
¢d_pcm_sw_·¿ms_t
 *
obj
)

6427 
	`ä“
(
obj
);

6428 
	}
}

6435 
	$¢d_pcm_sw_·¿ms_cİy
(
¢d_pcm_sw_·¿ms_t
 *
d¡
, cÚ¡ snd_pcm_sw_·¿ms_ˆ*
¤c
)

6437 
	`as£¹
(
d¡
 && 
¤c
);

6438 *
d¡
 = *
¤c
;

6439 
	}
}

6447 
	$¢d_pcm_sw_·¿ms_g‘_bound¬y
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6449 
	`as£¹
(
·¿ms
);

6450 *
v®
 = 
·¿ms
->
bound¬y
;

6452 
	}
}

6461 
	$¢d_pcm_sw_·¿ms_£t_¡¬t_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_¡¬t_t
 
v®
)

6463 
	`as£¹
(
pcm
 && 
·¿ms
);

6464 
v®
) {

6465 
SND_PCM_START_DATA
:

6466 
·¿ms
->
¡¬t_th»shŞd
 = 1;

6468 
SND_PCM_START_EXPLICIT
:

6469 
·¿ms
->
¡¬t_th»shŞd
 = 
pcm
->
bound¬y
;

6472 
	`SNDMSG
("šv®id s¹ modv®u%d", 
v®
);

6473  -
EINVAL
;

6476 
	}
}

6478 #iâdeà
DOC_HIDDEN


6479 
lšk_w¬nšg
(
¢d_pcm_sw_·¿ms_£t_¡¬t_mode
, "Warning: start_mode is deprecated, considero use start_threshold");

6487 
¢d_pcm_¡¬t_t
 
	$¢d_pcm_sw_·¿ms_g‘_¡¬t_mode
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
)

6489 
	`as£¹
(
·¿ms
);

6491  
·¿ms
->
¡¬t_th»shŞd
 > 1024 * 1024 ? 
SND_PCM_START_EXPLICIT
 : 
SND_PCM_START_DATA
;

6492 
	}
}

6494 #iâdeà
DOC_HIDDEN


6495 
lšk_w¬nšg
(
¢d_pcm_sw_·¿ms_g‘_¡¬t_mode
, "Warning: start_mode is deprecated, considero use start_threshold");

6505 #iâdeà
DOXYGEN


6506 
	$¢d_pcm_sw_·¿ms_£t_xrun_mode
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_xrun_t
 
v®
)

6508 
	$¢d_pcm_sw_·¿ms_£t_xrun_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_xrun_t
 
v®
)

6511 
	`as£¹
(
pcm
 && 
·¿ms
);

6512 
v®
) {

6513 
SND_PCM_XRUN_STOP
:

6514 
·¿ms
->
¡İ_th»shŞd
 = 
pcm
->
bufãr_size
;

6516 
SND_PCM_XRUN_NONE
:

6517 
·¿ms
->
¡İ_th»shŞd
 = 
pcm
->
bound¬y
;

6520 
	`SNDMSG
("šv®id xruÀmodv®u%d", 
v®
);

6521  -
EINVAL
;

6524 
	}
}

6526 #iâdeà
DOC_HIDDEN


6527 
lšk_w¬nšg
(
¢d_pcm_sw_·¿ms_£t_xrun_mode
, "Warning: xrun_mode is deprecated, considero use stop_threshold");

6535 
¢d_pcm_xrun_t
 
	$¢d_pcm_sw_·¿ms_g‘_xrun_mode
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
)

6537 
	`as£¹
(
·¿ms
);

6539  
·¿ms
->
¡İ_th»shŞd
 > 1024 * 1024 ? 
SND_PCM_XRUN_NONE
 : 
SND_PCM_XRUN_STOP
;

6540 
	}
}

6542 #iâdeà
DOC_HIDDEN


6543 
lšk_w¬nšg
(
¢d_pcm_sw_·¿ms_g‘_xrun_mode
, "Warning: xrun_mode is deprecated, considero use stop_threshold");

6553 #iâdeà
DOXYGEN


6554 
	$¢d_pcm_sw_·¿ms_£t_t¡amp_mode
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_t¡amp_t
 
v®
)

6556 
	$¢d_pcm_sw_·¿ms_£t_t¡amp_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_t¡amp_t
 
v®
)

6559 
	`as£¹
(
pcm
 && 
·¿ms
);

6560 ià(
	`CHECK_SANITY
(
v®
 > 
SND_PCM_TSTAMP_LAST
)) {

6561 
	`SNDMSG
("šv®id¡amp_modv®u%d", 
v®
);

6562  -
EINVAL
;

6564 
·¿ms
->
t¡amp_mode
 = 
v®
;

6566 
	}
}

6574 #iâdeà
DOXYGEN


6575 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_·¿ms_g‘_t¡amp_mode
)(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_t¡amp_t
 *
v®
)

6577 
	$¢d_pcm_sw_·¿ms_g‘_t¡amp_mode
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_t¡amp_t
 *
v®
)

6580 
	`as£¹
(
·¿ms
 && 
v®
);

6581 *
v®
 = 
·¿ms
->
t¡amp_mode
;

6583 
	}
}

6592 
	$¢d_pcm_sw_·¿ms_£t_t¡amp_ty³
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_t¡amp_ty³_t
 
v®
)

6594 
	`as£¹
(
pcm
 && 
·¿ms
);

6595 ià(
	`CHECK_SANITY
(
v®
 > 
SND_PCM_TSTAMP_TYPE_LAST
)) {

6596 
	`SNDMSG
("šv®id¡amp_ty³ v®u%d", 
v®
);

6597  -
EINVAL
;

6599 
·¿ms
->
t¡amp_ty³
 = 
v®
;

6601 
	}
}

6609 
	$¢d_pcm_sw_·¿ms_g‘_t¡amp_ty³
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_t¡amp_ty³_t
 *
v®
)

6611 
	`as£¹
(
·¿ms
 && 
v®
);

6612 *
v®
 = 
·¿ms
->
t¡amp_ty³
;

6614 
	}
}

6623 #iâdeà
DOXYGEN


6624 
	$¢d_pcm_sw_·¿ms_£t_¦“p_mš
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
 ATTRIBUTE_UNUSED, 
v®
 ATTRIBUTE_UNUSED)

6626 
	$¢d_pcm_sw_·¿ms_£t_¦“p_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
v®
)

6630 
	}
}

6638 #iâdeà
DOXYGEN


6639 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_·¿ms_g‘_¦“p_mš
)(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
 
ATTRIBUTE_UNUSED
, *
v®
)

6641 
	$¢d_pcm_sw_·¿ms_g‘_¦“p_mš
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, *
v®
)

6644 *
v®
 = 0;

6646 
	}
}

6662 #iâdeà
DOXYGEN


6663 
EXPORT_SYMBOL
 
	$¢d_pcm_sw_·¿ms_£t_ava_mš
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
)

6665 
	$¢d_pcm_sw_·¿ms_£t_ava_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
)

6668 
	`as£¹
(
pcm
 && 
·¿ms
);

6673 ià(
v®
 < 
pcm
->
³riod_size
)

6674 
v®
 = 
pcm
->
³riod_size
;

6675 
·¿ms
->
ava_mš
 = 
v®
;

6677 
	}
}

6688 #iâdeà
DOXYGEN


6689 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_·¿ms_g‘_ava_mš
)(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6691 
	$¢d_pcm_sw_·¿ms_g‘_ava_mš
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6694 
	`as£¹
(
·¿ms
 && 
v®
);

6695 *
v®
 = 
·¿ms
->
ava_mš
;

6697 
	}
}

6708 
	$¢d_pcm_sw_·¿ms_£t_³riod_ev’t
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
v®
)

6710 
	`as£¹
(
pcm
 && 
·¿ms
);

6711 
	`sw_£t_³riod_ev’t
(
·¿ms
, 
v®
);

6713 
	}
}

6721 
	$¢d_pcm_sw_·¿ms_g‘_³riod_ev’t
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, *
v®
)

6723 
	`as£¹
(
·¿ms
 && 
v®
);

6724 *
v®
 = 
	`sw_g‘_³riod_ev’t
(
·¿ms
);

6726 
	}
}

6735 #iâdeà
DOXYGEN


6736 
EXPORT_SYMBOL
 
	$¢d_pcm_sw_·¿ms_£t_xãr_®ign
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
 ATTRIBUTE_UNUSED, 
¢d_pcm_uäames_t
 
v®
 ATTRIBUTE_UNUSED)

6738 
	$¢d_pcm_sw_·¿ms_£t_xãr_®ign
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
)

6742 
	}
}

6750 #iâdeà
DOXYGEN


6751 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_·¿ms_g‘_xãr_®ign
)(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_uäames_t
 *
v®
)

6753 
	$¢d_pcm_sw_·¿ms_g‘_xãr_®ign
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6756 *
v®
 = 1;

6758 
	}
}

6770 #iâdeà
DOXYGEN


6771 
EXPORT_SYMBOL
 
	$¢d_pcm_sw_·¿ms_£t_¡¬t_th»shŞd
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
)

6773 
	$¢d_pcm_sw_·¿ms_£t_¡¬t_th»shŞd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
)

6776 
	`as£¹
(
pcm
 && 
·¿ms
);

6777 
·¿ms
->
¡¬t_th»shŞd
 = 
v®
;

6779 
	}
}

6790 #iâdeà
DOXYGEN


6791 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_·¿ms_g‘_¡¬t_th»shŞd
)(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6793 
	$¢d_pcm_sw_·¿ms_g‘_¡¬t_th»shŞd
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6796 
	`as£¹
(
·¿ms
);

6797 *
v®
 = 
·¿ms
->
¡¬t_th»shŞd
;

6799 
	}
}

6814 #iâdeà
DOXYGEN


6815 
EXPORT_SYMBOL
 
	$¢d_pcm_sw_·¿ms_£t_¡İ_th»shŞd
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
)

6817 
	$¢d_pcm_sw_·¿ms_£t_¡İ_th»shŞd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
)

6820 
	`as£¹
(
pcm
 && 
·¿ms
);

6821 
·¿ms
->
¡İ_th»shŞd
 = 
v®
;

6823 
	}
}

6836 #iâdeà
DOXYGEN


6837 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_·¿ms_g‘_¡İ_th»shŞd
)(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6839 
	$¢d_pcm_sw_·¿ms_g‘_¡İ_th»shŞd
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6842 
	`as£¹
(
·¿ms
);

6843 *
v®
 = 
·¿ms
->
¡İ_th»shŞd
;

6845 
	}
}

6859 #iâdeà
DOXYGEN


6860 
EXPORT_SYMBOL
 
	$¢d_pcm_sw_·¿ms_£t_s’û_th»shŞd
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
)

6862 
	$¢d_pcm_sw_·¿ms_£t_s’û_th»shŞd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
)

6865 
	`as£¹
(
pcm
 && 
·¿ms
);

6866 ià(
	`CHECK_SANITY
(
v®
 >ğ
pcm
->
bufãr_size
)) {

6867 
	`SNDMSG
("invalid silent_threshold value %ld (buffer_size = %ld)",

6868 
v®
, 
pcm
->
bufãr_size
);

6869  -
EINVAL
;

6871 
·¿ms
->
s’û_th»shŞd
 = 
v®
;

6873 
	}
}

6885 #iâdeà
DOXYGEN


6886 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_·¿ms_g‘_s’û_th»shŞd
)(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6888 
	$¢d_pcm_sw_·¿ms_g‘_s’û_th»shŞd
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6891 
	`as£¹
(
·¿ms
 && 
v®
);

6892 *
v®
 = 
·¿ms
->
s’û_th»shŞd
;

6894 
	}
}

6917 #iâdeà
DOXYGEN


6918 
EXPORT_SYMBOL
 
	$¢d_pcm_sw_·¿ms_£t_s’û_size
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
)

6920 
	$¢d_pcm_sw_·¿ms_£t_s’û_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
)

6923 
	`as£¹
(
pcm
 && 
·¿ms
);

6924 ià(
	`CHECK_SANITY
(
v®
 < 
pcm
->
bound¬y
 && v® >…cm->
bufãr_size
)) {

6925 
	`SNDMSG
("invalid silence_size %ld (boundary %ld, buffer_size %ld)",

6926 
v®
, 
pcm
->
bound¬y
,…cm->
bufãr_size
);

6927  -
EINVAL
;

6929 
·¿ms
->
s’û_size
 = 
v®
;

6931 
	}
}

6943 #iâdeà
DOXYGEN


6944 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_·¿ms_g‘_s’û_size
)(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6946 
	$¢d_pcm_sw_·¿ms_g‘_s’û_size
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
)

6949 
	`as£¹
(
·¿ms
);

6950 *
v®
 = 
·¿ms
->
s’û_size
;

6952 
	}
}

6959 
size_t
 
	$¢d_pcm_¡©us_sizeof
()

6961  (
¢d_pcm_¡©us_t
);

6962 
	}
}

6969 
	$¢d_pcm_¡©us_m®loc
(
¢d_pcm_¡©us_t
 **
±r
)

6971 
	`as£¹
(
±r
);

6972 *
±r
 = 
	`ÿÎoc
(1, (
¢d_pcm_¡©us_t
));

6973 ià(!*
±r
)

6974  -
ENOMEM
;

6976 
	}
}

6982 
	$¢d_pcm_¡©us_ä“
(
¢d_pcm_¡©us_t
 *
obj
)

6984 
	`ä“
(
obj
);

6985 
	}
}

6992 
	$¢d_pcm_¡©us_cİy
(
¢d_pcm_¡©us_t
 *
d¡
, cÚ¡ snd_pcm_¡©us_ˆ*
¤c
)

6994 
	`as£¹
(
d¡
 && 
¤c
);

6995 *
d¡
 = *
¤c
;

6996 
	}
}

7003 
¢d_pcm_¡©e_t
 
	$¢d_pcm_¡©us_g‘_¡©e
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
)

7005 
	`as£¹
(
obj
);

7006  
obj
->
¡©e
;

7007 
	}
}

7018 
	$¢d_pcm_¡©us_g‘_Œigg”_t¡amp
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
, 
¢d_time¡amp_t
 *
±r
)

7020 
	`as£¹
(
obj
 && 
±r
);

7021 
±r
->
tv_£c
 = 
obj
->
Œigg”_t¡amp
.tv_sec;

7022 
±r
->
tv_u£c
 = 
obj
->
Œigg”_t¡amp
.
tv_n£c
 / 1000L;

7023 
	}
}

7034 #iâdeà
DOXYGEN


7035 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_¡©us_g‘_Œigg”_ht¡amp
)(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
, 
¢d_htime¡amp_t
 *
±r
)

7037 
	$¢d_pcm_¡©us_g‘_Œigg”_ht¡amp
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
, 
¢d_htime¡amp_t
 *
±r
)

7040 
	`as£¹
(
obj
 && 
±r
);

7041 *
±r
 = 
obj
->
Œigg”_t¡amp
;

7042 
	}
}

7043 
u£_deçuÉ_symbŞ_v”siÚ
(
__¢d_pcm_¡©us_g‘_Œigg”_ht¡amp
, 
¢d_pcm_¡©us_g‘_Œigg”_ht¡amp
, 
ALSA_0
.9.0
rc8
);

7050 
	$¢d_pcm_¡©us_g‘_t¡amp
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
, 
¢d_time¡amp_t
 *
±r
)

7052 
	`as£¹
(
obj
 && 
±r
);

7053 
±r
->
tv_£c
 = 
obj
->
t¡amp
.tv_sec;

7054 
±r
->
tv_u£c
 = 
obj
->
t¡amp
.
tv_n£c
 / 1000L;

7055 
	}
}

7062 #iâdeà
DOXYGEN


7063 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_¡©us_g‘_ht¡amp
)(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
, 
¢d_htime¡amp_t
 *
±r
)

7065 
	$¢d_pcm_¡©us_g‘_ht¡amp
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
, 
¢d_htime¡amp_t
 *
±r
)

7068 
	`as£¹
(
obj
 && 
±r
);

7069 *
±r
 = 
obj
->
t¡amp
;

7070 
	}
}

7071 
u£_deçuÉ_symbŞ_v”siÚ
(
__¢d_pcm_¡©us_g‘_ht¡amp
, 
¢d_pcm_¡©us_g‘_ht¡amp
, 
ALSA_0
.9.0
rc8
);

7078 
	$¢d_pcm_¡©us_g‘_audio_ht¡amp
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
, 
¢d_htime¡amp_t
 *
±r
)

7080 
	`as£¹
(
obj
 && 
±r
);

7081 *
±r
 = 
obj
->
audio_t¡amp
;

7082 
	}
}

7090 
	$¢d_pcm_¡©us_g‘_driv”_ht¡amp
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
, 
¢d_htime¡amp_t
 *
±r
)

7092 
	`as£¹
(
obj
 && 
±r
);

7093 *
±r
 = 
obj
->
driv”_t¡amp
;

7094 
	}
}

7101 
	$¢d_pcm_¡©us_g‘_audio_ht¡amp_»pÜt
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
,

7102 
¢d_pcm_audio_t¡amp_»pÜt_t
 *
audio_t¡amp_»pÜt
)

7104 
	`as£¹
(
obj
 && 
audio_t¡amp_»pÜt
);

7105 
	`¢d_pcm_uÅack_audio_t¡amp_»pÜt
(
obj
->
audio_t¡amp_d©a
,

7106 
obj
->
audio_t¡amp_accu¿cy
,

7107 
audio_t¡amp_»pÜt
);

7108 
	}
}

7115 
	$¢d_pcm_¡©us_£t_audio_ht¡amp_cÚfig
(
¢d_pcm_¡©us_t
 *
obj
,

7116 
¢d_pcm_audio_t¡amp_cÚfig_t
 *
audio_t¡amp_cÚfig
)

7118 
	`as£¹
(
obj
 && 
audio_t¡amp_cÚfig
);

7119 
	`¢d_pcm_·ck_audio_t¡amp_cÚfig
(&
obj
->
audio_t¡amp_d©a
, 
audio_t¡amp_cÚfig
);

7120 
	}
}

7132 
¢d_pcm_säames_t
 
	$¢d_pcm_¡©us_g‘_d–ay
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
)

7134 
	`as£¹
(
obj
);

7135  
obj
->
d–ay
;

7136 
	}
}

7142 
¢d_pcm_uäames_t
 
	$¢d_pcm_¡©us_g‘_ava
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
)

7144 
	`as£¹
(
obj
);

7145  
obj
->
ava
;

7146 
	}
}

7154 
¢d_pcm_uäames_t
 
	$¢d_pcm_¡©us_g‘_ava_max
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
)

7156 
	`as£¹
(
obj
);

7157  
obj
->
ava_max
;

7158 
	}
}

7164 
¢d_pcm_uäames_t
 
	$¢d_pcm_¡©us_g‘_ov”¿nge
(cÚ¡ 
¢d_pcm_¡©us_t
 *
obj
)

7166 
	`as£¹
(
obj
);

7167  
obj
->
ov”¿nge
;

7168 
	}
}

7174 
size_t
 
	$¢d_pcm_šfo_sizeof
()

7176  (
¢d_pcm_šfo_t
);

7177 
	}
}

7184 
	$¢d_pcm_šfo_m®loc
(
¢d_pcm_šfo_t
 **
±r
)

7186 
	`as£¹
(
±r
);

7187 *
±r
 = 
	`ÿÎoc
(1, (
¢d_pcm_šfo_t
));

7188 ià(!*
±r
)

7189  -
ENOMEM
;

7191 
	}
}

7197 
	$¢d_pcm_šfo_ä“
(
¢d_pcm_šfo_t
 *
obj
)

7199 
	`ä“
(
obj
);

7200 
	}
}

7207 
	$¢d_pcm_šfo_cİy
(
¢d_pcm_šfo_t
 *
d¡
, cÚ¡ snd_pcm_šfo_ˆ*
¤c
)

7209 
	`as£¹
(
d¡
 && 
¤c
);

7210 *
d¡
 = *
¤c
;

7211 
	}
}

7218 
	$¢d_pcm_šfo_g‘_deviû
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
)

7220 
	`as£¹
(
obj
);

7221  
obj
->
deviû
;

7222 
	}
}

7229 
	$¢d_pcm_šfo_g‘_subdeviû
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
)

7231 
	`as£¹
(
obj
);

7232  
obj
->
subdeviû
;

7233 
	}
}

7240 
¢d_pcm_¡»am_t
 
	$¢d_pcm_šfo_g‘_¡»am
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
)

7242 
	`as£¹
(
obj
);

7243  
obj
->
¡»am
;

7244 
	}
}

7251 
	$¢d_pcm_šfo_g‘_ÿrd
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
)

7253 
	`as£¹
(
obj
);

7254  
obj
->
ÿrd
;

7255 
	}
}

7262 cÚ¡ *
	$¢d_pcm_šfo_g‘_id
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
)

7264 
	`as£¹
(
obj
);

7265  (cÚ¡ *)
obj
->
id
;

7266 
	}
}

7273 cÚ¡ *
	$¢d_pcm_šfo_g‘_Çme
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
)

7275 
	`as£¹
(
obj
);

7276  (cÚ¡ *)
obj
->
Çme
;

7277 
	}
}

7284 cÚ¡ *
	$¢d_pcm_šfo_g‘_subdeviû_Çme
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
)

7286 
	`as£¹
(
obj
);

7287  (cÚ¡ *)
obj
->
subÇme
;

7288 
	}
}

7295 
¢d_pcm_şass_t
 
	$¢d_pcm_šfo_g‘_şass
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
)

7297 
	`as£¹
(
obj
);

7298  
obj
->
dev_şass
;

7299 
	}
}

7306 
¢d_pcm_subşass_t
 
	$¢d_pcm_šfo_g‘_subşass
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
)

7308 
	`as£¹
(
obj
);

7309  
obj
->
dev_subşass
;

7310 
	}
}

7317 
	$¢d_pcm_šfo_g‘_subdeviûs_couÁ
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
)

7319 
	`as£¹
(
obj
);

7320  
obj
->
subdeviûs_couÁ
;

7321 
	}
}

7328 
	$¢d_pcm_šfo_g‘_subdeviûs_ava
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
)

7330 
	`as£¹
(
obj
);

7331  
obj
->
subdeviûs_ava
;

7332 
	}
}

7339 
¢d_pcm_sync_id_t
 
	$¢d_pcm_šfo_g‘_sync
(cÚ¡ 
¢d_pcm_šfo_t
 *
obj
)

7341 
¢d_pcm_sync_id_t
 
»s
;

7342 
	`as£¹
(
obj
);

7343 
	`memıy
(&
»s
, &
obj
->
sync
, (res));

7344  
»s
;

7345 
	}
}

7352 
	$¢d_pcm_šfo_£t_deviû
(
¢d_pcm_šfo_t
 *
obj
, 
v®
)

7354 
	`as£¹
(
obj
);

7355 
obj
->
deviû
 = 
v®
;

7356 
	}
}

7363 
	$¢d_pcm_šfo_£t_subdeviû
(
¢d_pcm_šfo_t
 *
obj
, 
v®
)

7365 
	`as£¹
(
obj
);

7366 
obj
->
subdeviû
 = 
v®
;

7367 
	}
}

7374 
	$¢d_pcm_šfo_£t_¡»am
(
¢d_pcm_šfo_t
 *
obj
, 
¢d_pcm_¡»am_t
 
v®
)

7376 
	`as£¹
(
obj
);

7377 
obj
->
¡»am
 = 
v®
;

7378 
	}
}

7400 
	$¢d_pcm_mm­_begš
(
¢d_pcm_t
 *
pcm
,

7401 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 **
¬—s
,

7402 
¢d_pcm_uäames_t
 *
off£t
,

7403 
¢d_pcm_uäames_t
 *
äames
)

7405 
”r
;

7407 
”r
 = 
	`bad_pcm_¡©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

7408 ià(
”r
 < 0)

7409  
”r
;

7410 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

7411 
”r
 = 
	`__¢d_pcm_mm­_begš
(
pcm
, 
¬—s
, 
off£t
, 
äames
);

7412 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

7413  
”r
;

7414 
	}
}

7416 #iâdeà
DOC_HIDDEN


7417 
	$__¢d_pcm_mm­_begš_g’”ic
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 **
¬—s
,

7418 
¢d_pcm_uäames_t
 *
off£t
, snd_pcm_uäames_ˆ*
äames
)

7420 
¢d_pcm_uäames_t
 
cÚt
;

7421 
¢d_pcm_uäames_t
 
f
;

7422 
¢d_pcm_uäames_t
 
ava
;

7423 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
x¬—s
;

7425 
	`as£¹
(
pcm
 && 
¬—s
 && 
off£t
 && 
äames
);

7428 
x¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

7429 ià(
x¬—s
 =ğ
NULL
)

7430  -
EBADFD
;

7431 *
¬—s
 = 
x¬—s
;

7432 *
off£t
 = *
pcm
->
­¶
.
±r
 %…cm->
bufãr_size
;

7433 
ava
 = 
	`¢d_pcm_mm­_ava
(
pcm
);

7434 ià(
ava
 > 
pcm
->
bufãr_size
)

7435 
ava
 = 
pcm
->
bufãr_size
;

7436 
cÚt
 = 
pcm
->
bufãr_size
 - *
off£t
;

7437 
f
 = *
äames
;

7438 ià(
f
 > 
ava
)

7439 
f
 = 
ava
;

7440 ià(
f
 > 
cÚt
)

7441 
f
 = 
cÚt
;

7442 *
äames
 = 
f
;

7444 
	}
}

7447 
	$__¢d_pcm_mm­_begš
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 **
¬—s
,

7448 
¢d_pcm_uäames_t
 *
off£t
, snd_pcm_uäames_ˆ*
äames
)

7450 
	`as£¹
(
pcm
 && 
¬—s
 && 
off£t
 && 
äames
);

7452 ià(
pcm
->
ç¡_İs
->
mm­_begš
)

7453  
pcm
->
ç¡_İs
->
	`mm­_begš
Õcm->
ç¡_İ_¬g
, 
¬—s
, 
off£t
, 
äames
);

7455  
	`__¢d_pcm_mm­_begš_g’”ic
(
pcm
, 
¬—s
, 
off£t
, 
äames
);

7456 
	}
}

7513 
¢d_pcm_säames_t
 
	$¢d_pcm_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

7514 
¢d_pcm_uäames_t
 
off£t
,

7515 
¢d_pcm_uäames_t
 
äames
)

7517 
¢d_pcm_säames_t
 
»suÉ
;

7518 
”r
;

7520 
”r
 = 
	`bad_pcm_¡©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

7521 ià(
”r
 < 0)

7522  
”r
;

7523 
	`¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

7524 
»suÉ
 = 
	`__¢d_pcm_mm­_comm™
(
pcm
, 
off£t
, 
äames
);

7525 
	`¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

7526  
»suÉ
;

7527 
	}
}

7529 #iâdeà
DOC_HIDDEN


7531 
¢d_pcm_säames_t
 
	$__¢d_pcm_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

7532 
¢d_pcm_uäames_t
 
off£t
,

7533 
¢d_pcm_uäames_t
 
äames
)

7535 
	`as£¹
(
pcm
);

7536 ià(
	`CHECK_SANITY
(
off£t
 !ğ*
pcm
->
­¶
.
±r
 %…cm->
bufãr_size
)) {

7537 
	`SNDMSG
("commit offset (%ld) doesn't match with‡ppl_ptr (%ld) %% buf_size (%ld)",

7538 
off£t
, *
pcm
->
­¶
.
±r
,…cm->
bufãr_size
);

7539  -
EPIPE
;

7541 ià(
	`CHECK_SANITY
(
äames
 > 
	`¢d_pcm_mm­_ava
(
pcm
))) {

7542 
	`SNDMSG
("comm™ f¿me (%ldèov”æow (ava = %ld)", 
äames
,

7543 
	`¢d_pcm_mm­_ava
(
pcm
));

7544  -
EPIPE
;

7546 ià(
pcm
->
ç¡_İs
->
mm­_comm™
)

7547  
pcm
->
ç¡_İs
->
	`mm­_comm™
Õcm->
ç¡_İ_¬g
, 
off£t
, 
äames
);

7549  -
ENOSYS
;

7550 
	}
}

7552 
	$_¢d_pcm_pŞl_desütÜ
(
¢d_pcm_t
 *
pcm
)

7554 
	`as£¹
(
pcm
);

7555  
pcm
->
pŞl_fd
;

7556 
	}
}

7558 
	$¢d_pcm_¬—s_äom_buf
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

7559 *
buf
)

7561 
chªÃl
;

7562 
chªÃls
;

7564 
	`¢d_pcm_lock
(
pcm
);

7565 
chªÃls
 = 
pcm
->channels;

7566 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++chªÃl, ++
¬—s
) {

7567 
¬—s
->
addr
 = 
buf
;

7568 
¬—s
->
fœ¡
 = 
chªÃl
 * 
pcm
->
§m¶e_b™s
;

7569 
¬—s
->
¡•
 = 
pcm
->
äame_b™s
;

7571 
	`¢d_pcm_uÆock
(
pcm
);

7572 
	}
}

7574 
	$¢d_pcm_¬—s_äom_bufs
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

7575 **
bufs
)

7577 
chªÃl
;

7578 
chªÃls
;

7580 
	`¢d_pcm_lock
(
pcm
);

7581 
chªÃls
 = 
pcm
->channels;

7582 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++chªÃl, ++
¬—s
, ++
bufs
) {

7583 
¬—s
->
addr
 = *
bufs
;

7584 
¬—s
->
fœ¡
 = 0;

7585 
¬—s
->
¡•
 = 
pcm
->
§m¶e_b™s
;

7587 
	`¢d_pcm_uÆock
(
pcm
);

7588 
	}
}

7590 
¢d_pcm_säames_t
 
	$¢d_pcm_»ad_¬—s
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

7591 
¢d_pcm_uäames_t
 
off£t
, snd_pcm_uäames_ˆ
size
,

7592 
¢d_pcm_xãr_¬—s_func_t
 
func
)

7594 
¢d_pcm_uäames_t
 
xãr
 = 0;

7595 
¢d_pcm_säames_t
 
”r
 = 0;

7596 
¢d_pcm_¡©e_t
 
¡©e
;

7598 ià(
size
 == 0)

7601 
	`__¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

7602 
size
 > 0) {

7603 
¢d_pcm_uäames_t
 
äames
;

7604 
¢d_pcm_säames_t
 
ava
;

7605 
_agaš
:

7606 
¡©e
 = 
	`__¢d_pcm_¡©e
(
pcm
);

7607 
¡©e
) {

7608 
SND_PCM_STATE_PREPARED
:

7609 
”r
 = 
	`__¢d_pcm_¡¬t
(
pcm
);

7610 ià(
”r
 < 0)

7611 
_’d
;

7613 
SND_PCM_STATE_RUNNING
:

7614 
”r
 = 
	`__¢d_pcm_hwsync
(
pcm
);

7615 ià(
”r
 < 0)

7616 
_’d
;

7618 
SND_PCM_STATE_DRAINING
:

7619 
SND_PCM_STATE_PAUSED
:

7622 
”r
 = 
	`pcm_¡©e_to_”rÜ
(
¡©e
);

7623 ià(!
”r
)

7624 
”r
 = -
EBADFD
;

7625 
_’d
;

7627 
ava
 = 
	`__¢d_pcm_ava_upd©e
(
pcm
);

7628 ià(
ava
 < 0) {

7629 
”r
 = 
ava
;

7630 
_’d
;

7632 ià(
ava
 == 0) {

7633 ià(
¡©e
 =ğ
SND_PCM_STATE_DRAINING
)

7634 
_’d
;

7635 ià(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
) {

7636 
”r
 = -
EAGAIN
;

7637 
_’d
;

7640 
”r
 = 
	`__¢d_pcm_wa™_š_lock
(
pcm
, 
SND_PCM_WAIT_IO
);

7641 ià(
”r
 < 0)

7643 
_agaš
;

7646 
äames
 = 
size
;

7647 ià(
äames
 > (
¢d_pcm_uäames_t
è
ava
)

7648 
äames
 = 
ava
;

7649 ià(! 
äames
)

7651 
”r
 = 
	`func
(
pcm
, 
¬—s
, 
off£t
, 
äames
);

7652 ià(
”r
 < 0)

7654 
äames
 = 
”r
;

7655 
off£t
 +ğ
äames
;

7656 
size
 -ğ
äames
;

7657 
xãr
 +ğ
äames
;

7659 
_’d
:

7660 
	`__¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

7661  
xãr
 > 0 ? (
¢d_pcm_säames_t
èxã¸: 
	`¢d_pcm_check_”rÜ
(
pcm
, 
”r
);

7662 
	}
}

7664 
¢d_pcm_säames_t
 
	$¢d_pcm_wr™e_¬—s
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

7665 
¢d_pcm_uäames_t
 
off£t
, snd_pcm_uäames_ˆ
size
,

7666 
¢d_pcm_xãr_¬—s_func_t
 
func
)

7668 
¢d_pcm_uäames_t
 
xãr
 = 0;

7669 
¢d_pcm_säames_t
 
”r
 = 0;

7670 
¢d_pcm_¡©e_t
 
¡©e
;

7672 ià(
size
 == 0)

7675 
	`__¢d_pcm_lock
(
pcm
->
ç¡_İ_¬g
);

7676 
size
 > 0) {

7677 
¢d_pcm_uäames_t
 
äames
;

7678 
¢d_pcm_säames_t
 
ava
;

7679 
_agaš
:

7680 
¡©e
 = 
	`__¢d_pcm_¡©e
(
pcm
);

7681 
¡©e
) {

7682 
SND_PCM_STATE_PREPARED
:

7683 
SND_PCM_STATE_PAUSED
:

7685 
SND_PCM_STATE_RUNNING
:

7686 
”r
 = 
	`__¢d_pcm_hwsync
(
pcm
);

7687 ià(
”r
 < 0)

7688 
_’d
;

7691 
”r
 = 
	`pcm_¡©e_to_”rÜ
(
¡©e
);

7692 ià(!
”r
)

7693 
”r
 = -
EBADFD
;

7694 
_’d
;

7696 
ava
 = 
	`__¢d_pcm_ava_upd©e
(
pcm
);

7697 ià(
ava
 < 0) {

7698 
”r
 = 
ava
;

7699 
_’d
;

7701 ià(
¡©e
 =ğ
SND_PCM_STATE_RUNNING
 &&

7702 
size
 > (
¢d_pcm_uäames_t
)
ava
) {

7703 ià(
	`¢d_pcm_may_wa™_fÜ_ava_mš
(
pcm
, 
ava
)) {

7704 ià(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
) {

7705 
”r
 = -
EAGAIN
;

7706 
_’d
;

7709 
”r
 = 
	`¢d_pcm_wa™_nocheck
(
pcm
, 
SND_PCM_WAIT_IO
);

7710 ià(
”r
 < 0)

7712 
_agaš
;

7717 
ava
 = 
	`__¢d_pcm_ava_upd©e
(
pcm
);

7718 ià(
ava
 < 0) {

7719 
”r
 = 
ava
;

7720 
_’d
;

7723 
äames
 = 
size
;

7724 ià(
äames
 > (
¢d_pcm_uäames_t
è
ava
)

7725 
äames
 = 
ava
;

7726 ià(! 
äames
)

7728 
”r
 = 
	`func
(
pcm
, 
¬—s
, 
off£t
, 
äames
);

7729 ià(
”r
 < 0)

7731 
äames
 = 
”r
;

7732 ià(
¡©e
 =ğ
SND_PCM_STATE_PREPARED
) {

7733 
¢d_pcm_säames_t
 
hw_ava
 = 
pcm
->
bufãr_size
 - 
ava
;

7734 
hw_ava
 +ğ
äames
;

7736 
¡©e
 = 
	`__¢d_pcm_¡©e
(
pcm
);

7737 ià(
¡©e
 =ğ
SND_PCM_STATE_PREPARED
 &&

7738 
hw_ava
 >= 0 &&

7739 (
¢d_pcm_uäames_t
è
hw_ava
 >ğ
pcm
->
¡¬t_th»shŞd
) {

7740 
”r
 = 
	`__¢d_pcm_¡¬t
(
pcm
);

7741 ià(
”r
 < 0)

7742 
_’d
;

7745 
off£t
 +ğ
äames
;

7746 
size
 -ğ
äames
;

7747 
xãr
 +ğ
äames
;

7749 
_’d
:

7750 
	`__¢d_pcm_uÆock
(
pcm
->
ç¡_İ_¬g
);

7751  
xãr
 > 0 ? (
¢d_pcm_säames_t
èxã¸: 
	`¢d_pcm_check_”rÜ
(
pcm
, 
”r
);

7752 
	}
}

7754 
¢d_pcm_uäames_t
 
	$_¢d_pcm_mm­_hw_±r
(
¢d_pcm_t
 *
pcm
)

7756  *
pcm
->
hw
.
±r
;

7757 
	}
}

7759 
¢d_pcm_uäames_t
 
	$_¢d_pcm_bound¬y
(
¢d_pcm_t
 *
pcm
)

7761  
pcm
->
bound¬y
;

7762 
	}
}

7764 #iâdeà
DOC_HIDDEN


7765 
lšk_w¬nšg
(
_¢d_pcm_mm­_hw_±r
, "Warning: _snd_pcm_mmap_hw_ptr() is deprecated, considero‚ot usehis function");

7766 
lšk_w¬nšg
(
_¢d_pcm_bound¬y
, "Warning: _snd_pcm_boundary() is deprecated, considero use snd_pcm_sw_params_current()");

7769 cÚ¡ *cÚ¡ 
	gÇmes
[
SND_PCM_HW_PARAM_LAST_INTERVAL
 + 1] = {

7770 [
SND_PCM_HW_PARAM_FORMAT
] = "format",

7771 [
SND_PCM_HW_PARAM_CHANNELS
] = "channels",

7772 [
SND_PCM_HW_PARAM_RATE
] = "rate",

7773 [
SND_PCM_HW_PARAM_PERIOD_TIME
] = "period_time",

7774 [
SND_PCM_HW_PARAM_PERIOD_SIZE
] = "period_size",

7775 [
SND_PCM_HW_PARAM_BUFFER_TIME
] = "buffer_time",

7776 [
SND_PCM_HW_PARAM_BUFFER_SIZE
] = "buffer_size",

7777 [
SND_PCM_HW_PARAM_PERIODS
] = "periods"

7780 
	$¢d_pcm_¦ave_cÚf
(
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

7781 
¢d_cÚfig_t
 **
_pcm_cÚf
, 
couÁ
, ...)

7783 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

7784 cÚ¡ *
¡r
;

7786 
šdex
;

7787 
æags
;

7788 *
±r
;

7789 
´e£Á
;

7790 } 
f›lds
[
couÁ
];

7791 
k
;

7792 
¢d_cÚfig_t
 *
pcm_cÚf
 = 
NULL
;

7793 
”r
;

7794 
to_ä“
 = 0;

7795 
va_li¡
 
¬gs
;

7796 
	`as£¹
(
roÙ
);

7797 
	`as£¹
(
cÚf
);

7798 
	`as£¹
(
_pcm_cÚf
);

7799 ià(
	`¢d_cÚfig_g‘_¡ršg
(
cÚf
, &
¡r
) >= 0) {

7800 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "pcm_¦ave", 
¡r
, &
cÚf
);

7801 ià(
”r
 < 0) {

7802 
	`SNDERR
("Invalid slave definition");

7803  -
EINVAL
;

7805 
to_ä“
 = 1;

7807 ià(
	`¢d_cÚfig_g‘_ty³
(
cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

7808 
	`SNDERR
("Invalid slave definition");

7809 
”r
 = -
EINVAL
;

7810 
_”r
;

7812 
	`va_¡¬t
(
¬gs
, 
couÁ
);

7813 
k
 = 0; k < 
couÁ
; ++k) {

7814 
f›lds
[
k
].
šdex
 = 
	`va_¬g
(
¬gs
, );

7815 
f›lds
[
k
].
æags
 = 
	`va_¬g
(
¬gs
, );

7816 
f›lds
[
k
].
±r
 = 
	`va_¬g
(
¬gs
, *);

7817 
f›lds
[
k
].
´e£Á
 = 0;

7819 
	`va_’d
(
¬gs
);

7820 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

7821 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

7822 cÚ¡ *
id
;

7823 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

7825 ià(
	`¡rcmp
(
id
, "comment") == 0)

7827 ià(
	`¡rcmp
(
id
, "pcm") == 0) {

7828 ià(
pcm_cÚf
 !ğ
NULL
)

7829 
	`¢d_cÚfig_d–‘e
(
pcm_cÚf
);

7830 ià((
”r
 = 
	`¢d_cÚfig_cİy
(&
pcm_cÚf
, 
n
)) < 0)

7831 
_”r
;

7834 
k
 = 0; k < 
couÁ
; ++k) {

7835 
idx
 = 
f›lds
[
k
].
šdex
;

7836 
v
;

7837 
	`as£¹
(
idx
 < 
SND_PCM_HW_PARAM_LAST_INTERVAL
);

7838 
	`as£¹
(
Çmes
[
idx
]);

7839 ià(
	`¡rcmp
(
id
, 
Çmes
[
idx
]) != 0)

7841 
idx
) {

7842 
SND_PCM_HW_PARAM_FORMAT
:

7844 
¢d_pcm_fÜm©_t
 
f
;

7845 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
);

7846 ià(
”r
 < 0) {

7847 
_šv®id
:

7848 
	`SNDERR
("šv®idy³ fÜ %s", 
id
);

7849 
_”r
;

7851 ià((
f›lds
[
k
].
æags
 & 
SCONF_UNCHANGED
) &&

7852 
	`¡rÿ£cmp
(
¡r
, "unchanged") == 0) {

7853 *(
¢d_pcm_fÜm©_t
*)
f›lds
[
k
].
±r
 = (snd_pcm_format_t) -2;

7856 
f
 = 
	`¢d_pcm_fÜm©_v®ue
(
¡r
);

7857 ià(
f
 =ğ
SND_PCM_FORMAT_UNKNOWN
) {

7858 
	`SNDERR
("unknowÀfÜm© %s", 
¡r
);

7859 
”r
 = -
EINVAL
;

7860 
_”r
;

7862 *(
¢d_pcm_fÜm©_t
*)
f›lds
[
k
].
±r
 = 
f
;

7866 ià((
f›lds
[
k
].
æags
 & 
SCONF_UNCHANGED
)) {

7867 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
);

7868 ià(
”r
 >= 0 &&

7869 
	`¡rÿ£cmp
(
¡r
, "unchanged") == 0) {

7870 *(*)
f›lds
[
k
].
±r
 = -2;

7874 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v
);

7875 ià(
”r
 < 0)

7876 
_šv®id
;

7877 *(*)
f›lds
[
k
].
±r
 = 
v
;

7880 
f›lds
[
k
].
´e£Á
 = 1;

7883 ià(
k
 < 
couÁ
)

7885 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

7886 
”r
 = -
EINVAL
;

7887 
_”r
;

7889 ià(!
pcm_cÚf
) {

7890 
	`SNDERR
("missing field…cm");

7891 
”r
 = -
EINVAL
;

7892 
_”r
;

7894 
k
 = 0; k < 
couÁ
; ++k) {

7895 ià((
f›lds
[
k
].
æags
 & 
SCONF_MANDATORY
è&& !f›lds[k].
´e£Á
) {

7896 
	`SNDERR
("missšg f›ld %s", 
Çmes
[
f›lds
[
k
].
šdex
]);

7897 
”r
 = -
EINVAL
;

7898 
_”r
;

7901 *
_pcm_cÚf
 = 
pcm_cÚf
;

7902 
pcm_cÚf
 = 
NULL
;

7903 
”r
 = 0;

7904 
_”r
:

7905 ià(
pcm_cÚf
)

7906 
	`¢d_cÚfig_d–‘e
(
pcm_cÚf
);

7907 ià(
to_ä“
)

7908 
	`¢d_cÚfig_d–‘e
(
cÚf
);

7909  
”r
;

7910 
	}
}

7912 
	$¢d_pcm_£t_±r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_rb±r_t
 *
rb±r
,

7913 vŞ©
¢d_pcm_uäames_t
 *
hw_±r
, 
fd
, 
off_t
 
off£t
)

7915 
rb±r
->
ma¡”
 = 
NULL
;

7916 
rb±r
->
±r
 = 
hw_±r
;

7917 
rb±r
->
fd
 = fd;

7918 
rb±r
->
off£t
 = offset;

7919 ià(
rb±r
->
chªged
)

7920 
rb±r
->
	`chªged
(
pcm
, 
NULL
);

7921 
	}
}

7923 
	$¢d_pcm_£t_hw_±r
(
¢d_pcm_t
 *
pcm
, vŞ©
¢d_pcm_uäames_t
 *
hw_±r
, 
fd
, 
off_t
 
off£t
)

7925 
	`as£¹
(
pcm
);

7926 
	`as£¹
(
hw_±r
);

7927 
	`¢d_pcm_£t_±r
(
pcm
, &pcm->
hw
, 
hw_±r
, 
fd
, 
off£t
);

7928 
	}
}

7930 
	$¢d_pcm_£t_­¶_±r
(
¢d_pcm_t
 *
pcm
, vŞ©
¢d_pcm_uäames_t
 *
­¶_±r
, 
fd
, 
off_t
 
off£t
)

7932 
	`as£¹
(
pcm
);

7933 
	`as£¹
(
­¶_±r
);

7934 
	`¢d_pcm_£t_±r
(
pcm
, &pcm->
­¶
, 
­¶_±r
, 
fd
, 
off£t
);

7935 
	}
}

7937 
	$¢d_pcm_lšk_±r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_rb±r_t
 *
pcm_rb±r
,

7938 
¢d_pcm_t
 *
¦ave
, 
¢d_pcm_rb±r_t
 *
¦ave_rb±r
)

7940 
¢d_pcm_t
 **
a
;

7941 
idx
;

7943 
a
 = 
¦ave_rb±r
->
lšk_d¡
;

7944 
idx
 = 0; idx < 
¦ave_rb±r
->
lšk_d¡_couÁ
; idx++)

7945 ià(
a
[
idx
] =ğ
NULL
) {

7946 
a
[
idx
] = 
pcm
;

7947 
__found_ä“_¶aû
;

7949 
a
 = 
	`»®loc
×, (
¢d_pcm_t
 *è* (
¦ave_rb±r
->
lšk_d¡_couÁ
 + 1));

7950 ià(
a
 =ğ
NULL
) {

7951 
pcm_rb±r
->
±r
 = 
NULL
;

7952 
pcm_rb±r
->
fd
 = -1;

7953 
pcm_rb±r
->
off£t
 = 0UL;

7956 
a
[
¦ave_rb±r
->
lšk_d¡_couÁ
++] = 
pcm
;

7957 
__found_ä“_¶aû
:

7958 
pcm_rb±r
->
ma¡”
 = 
¦ave_rb±r
->ma¡” ? sÏve_rb±r->ma¡” : 
¦ave
;

7959 
pcm_rb±r
->
±r
 = 
¦ave_rb±r
->ptr;

7960 
pcm_rb±r
->
fd
 = 
¦ave_rb±r
->fd;

7961 
pcm_rb±r
->
off£t
 = 
¦ave_rb±r
->offset;

7962 
¦ave_rb±r
->
lšk_d¡
 = 
a
;

7963 ià(
pcm_rb±r
->
chªged
)

7964 
pcm_rb±r
->
	`chªged
(
pcm
, 
¦ave
);

7965 
	}
}

7967 
	$¢d_pcm_uÆšk_±r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_rb±r_t
 *
pcm_rb±r
,

7968 
¢d_pcm_t
 *
¦ave
, 
¢d_pcm_rb±r_t
 *
¦ave_rb±r
)

7970 
¢d_pcm_t
 **
a
;

7971 
idx
;

7973 
a
 = 
¦ave_rb±r
->
lšk_d¡
;

7974 
idx
 = 0; idx < 
¦ave_rb±r
->
lšk_d¡_couÁ
; idx++) {

7975 ià(
a
[
idx
] =ğ
pcm
) {

7976 
a
[
idx
] = 
NULL
;

7977 
__found
;

7983 
__found
:

7984 
pcm_rb±r
->
ma¡”
 = 
NULL
;

7985 
pcm_rb±r
->
±r
 = 
NULL
;

7986 
pcm_rb±r
->
fd
 = -1;

7987 
pcm_rb±r
->
off£t
 = 0UL;

7988 ià(
pcm_rb±r
->
chªged
)

7989 
pcm_rb±r
->
	`chªged
(
pcm
, 
¦ave
);

7990 
	}
}

7992 
	$¢d_pcm_lšk_hw_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ*
¦ave
)

7994 
	`as£¹
(
pcm
);

7995 
	`as£¹
(
¦ave
);

7996 
	`¢d_pcm_lšk_±r
(
pcm
, &pcm->
hw
, 
¦ave
, &slave->hw);

7997 
	}
}

7999 
	$¢d_pcm_lšk_­¶_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ*
¦ave
)

8001 
	`as£¹
(
pcm
);

8002 
	`as£¹
(
¦ave
);

8003 
	`¢d_pcm_lšk_±r
(
pcm
, &pcm->
­¶
, 
¦ave
, &slave->appl);

8004 
	}
}

8006 
	$¢d_pcm_uÆšk_hw_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ*
¦ave
)

8008 
	`as£¹
(
pcm
);

8009 
	`as£¹
(
¦ave
);

8010 
	`¢d_pcm_uÆšk_±r
(
pcm
, &pcm->
hw
, 
¦ave
, &slave->hw);

8011 
	}
}

8013 
	$¢d_pcm_uÆšk_­¶_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ*
¦ave
)

8015 
	`as£¹
(
pcm
);

8016 
	`as£¹
(
¦ave
);

8017 
	`¢d_pcm_uÆšk_±r
(
pcm
, &pcm->
­¶
, 
¦ave
, &slave->appl);

8018 
	}
}

8026 #iâdeà
DOC_HIDDEN


8028 #ifdeà
USE_VERSIONED_SYMBOLS


8030 
	#OBSOLETE1
(
Çme
, 
wh©
, 
Ãw
) \

8031 
	`deçuÉ_symbŞ_v”siÚ
(
__
##
Çme
,‚ame, 
Ãw
); \

8032 
	`symbŞ_v”siÚ
(
__Şd_
##
Çme
,‚ame, 
wh©
);

	)

8036 
	#OBSOLETE1
(
Çme
, 
wh©
, 
Ãw
) \

8037 
	`u£_deçuÉ_symbŞ_v”siÚ
(
__
##
Çme
,‚ame, 
Ãw
);

	)

8041 
	#__P_OLD_GET
(
pfx
, 
Çme
, 
v®_ty³
, 
»t_ty³
) \

8042 
EXPORT_SYMBOL
 
»t_ty³
 
pfx
##
	`Çme
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
) \

8044 
v®_ty³
 
v®
; \

8045 ià(
	`INTERNAL
(
Çme
)(
·¿ms
, &
v®
) < 0) \

8047  (
»t_ty³
)
v®
; \

8048 }

	)

8050 
	#__P_OLD_GET1
(
pfx
, 
Çme
, 
v®_ty³
, 
»t_ty³
) \

8051 
EXPORT_SYMBOL
 
»t_ty³
 
pfx
##
	`Çme
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
) \

8053 
v®_ty³
 
v®
; \

8054 ià(
	`INTERNAL
(
Çme
)(
·¿ms
, &
v®
, 
dœ
) < 0) \

8056  (
»t_ty³
)
v®
; \

8057 }

	)

8059 
	#__OLD_GET
(
Çme
, 
v®_ty³
, 
»t_ty³
è
	`__P_OLD_GET
(
__Şd_
,‚ame, v®_ty³,„‘_ty³)

	)

8060 
	#__OLD_GET1
(
Çme
, 
v®_ty³
, 
»t_ty³
è
	`__P_OLD_GET1
(
__Şd_
,‚ame, v®_ty³,„‘_ty³)

	)

8062 
__OLD_GET
(
¢d_pcm_hw_·¿ms_g‘_acûss
, 
¢d_pcm_acûss_t
, );

8063 
__OLD_GET
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
, 
¢d_pcm_fÜm©_t
, );

8064 
__OLD_GET
(
¢d_pcm_hw_·¿ms_g‘_subfÜm©
, 
¢d_pcm_subfÜm©_t
, );

8065 
__OLD_GET
(
¢d_pcm_hw_·¿ms_g‘_chªÃls
, , );

8066 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_¿‹
, , );

8067 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_³riod_time
, , );

8068 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_³riod_size
, 
¢d_pcm_uäames_t
, 
¢d_pcm_säames_t
);

8069 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_³riods
, , );

8070 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time
, , );

8071 
__OLD_GET
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size
, 
¢d_pcm_uäames_t
, 
¢d_pcm_säames_t
);

8072 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_tick_time
, , );

8074 
__OLD_GET
(
¢d_pcm_hw_·¿ms_g‘_chªÃls_mš
, , );

8075 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_¿‹_mš
, , );

8076 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_³riod_time_mš
, , );

8077 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_³riod_size_mš
, 
¢d_pcm_uäames_t
, snd_pcm_uframes_t);

8078 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_³riods_mš
, , );

8079 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time_mš
, , );

8080 
__OLD_GET
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size_mš
, 
¢d_pcm_uäames_t
, snd_pcm_uframes_t);

8081 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_tick_time_mš
, , );

8083 
__OLD_GET
(
¢d_pcm_hw_·¿ms_g‘_chªÃls_max
, , );

8084 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_¿‹_max
, , );

8085 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_³riod_time_max
, , );

8086 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_³riod_size_max
, 
¢d_pcm_uäames_t
, snd_pcm_uframes_t);

8087 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_³riods_max
, , );

8088 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time_max
, , );

8089 
__OLD_GET
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size_max
, 
¢d_pcm_uäames_t
, snd_pcm_uframes_t);

8090 
__OLD_GET1
(
¢d_pcm_hw_·¿ms_g‘_tick_time_max
, , );

8092 
	#__P_OLD_NEAR
(
pfx
, 
Çme
, 
»t_ty³
) \

8093 
EXPORT_SYMBOL
 
»t_ty³
 
pfx
##
	`Çme
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,„‘_ty³ 
v®
) \

8095 ià(
	`INTERNAL
(
Çme
)(
pcm
, 
·¿ms
, &
v®
) < 0) \

8097  (
»t_ty³
)
v®
; \

8098 }

	)

8100 
	#__P_OLD_NEAR1
(
pfx
, 
Çme
, 
»t_ty³
) \

8101 
EXPORT_SYMBOL
 
»t_ty³
 
pfx
##
	`Çme
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,„‘_ty³ 
v®
, *
dœ
) \

8103 ià(
	`INTERNAL
(
Çme
)(
pcm
, 
·¿ms
, &
v®
, 
dœ
) < 0) \

8105  (
»t_ty³
)
v®
; \

8106 }

	)

8108 
	#__OLD_NEAR
(
Çme
, 
»t_ty³
è
	`__P_OLD_NEAR
(
__Şd_
,‚ame,„‘_ty³)

	)

8109 
	#__OLD_NEAR1
(
Çme
, 
»t_ty³
è
	`__P_OLD_NEAR1
(
__Şd_
,‚ame,„‘_ty³)

	)

8111 
__OLD_NEAR
(
¢d_pcm_hw_·¿ms_£t_chªÃls_Ã¬
, );

8112 
__OLD_NEAR1
(
¢d_pcm_hw_·¿ms_£t_¿‹_Ã¬
, );

8113 
__OLD_NEAR1
(
¢d_pcm_hw_·¿ms_£t_³riod_time_Ã¬
, );

8114 
__OLD_NEAR1
(
¢d_pcm_hw_·¿ms_£t_³riod_size_Ã¬
, 
¢d_pcm_uäames_t
);

8115 
__OLD_NEAR1
(
¢d_pcm_hw_·¿ms_£t_³riods_Ã¬
, );

8116 
__OLD_NEAR1
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ã¬
, );

8117 
__OLD_NEAR
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ã¬
, 
¢d_pcm_uäames_t
);

8118 
__OLD_NEAR1
(
¢d_pcm_hw_·¿ms_£t_tick_time_Ã¬
, );

8120 
	#__P_OLD_SET_FL
(
pfx
, 
Çme
, 
»t_ty³
) \

8121 
EXPORT_SYMBOL
 
»t_ty³
 
pfx
##
	`Çme
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
) \

8123 
»t_ty³
 
v®
; \

8124 ià(
	`INTERNAL
(
Çme
)(
pcm
, 
·¿ms
, &
v®
) < 0) \

8126  (
»t_ty³
)
v®
; \

8127 }

	)

8129 
	#__P_OLD_SET_FL1
(
pfx
, 
Çme
, 
»t_ty³
) \

8130 
EXPORT_SYMBOL
 
»t_ty³
 
pfx
##
	`Çme
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
dœ
) \

8132 
»t_ty³
 
v®
; \

8133 ià(
	`INTERNAL
(
Çme
)(
pcm
, 
·¿ms
, &
v®
, 
dœ
) < 0) \

8135  (
»t_ty³
)
v®
; \

8136 }

	)

8138 
	#__OLD_SET_FL
(
Çme
, 
»t_ty³
è
	`__P_OLD_SET_FL
(
__Şd_
,‚ame,„‘_ty³)

	)

8139 
	#__OLD_SET_FL1
(
Çme
, 
»t_ty³
è
	`__P_OLD_SET_FL1
(
__Şd_
,‚ame,„‘_ty³)

	)

8141 
__OLD_SET_FL
(
¢d_pcm_hw_·¿ms_£t_acûss_fœ¡
, 
¢d_pcm_acûss_t
);

8142 
__OLD_SET_FL
(
¢d_pcm_hw_·¿ms_£t_fÜm©_fœ¡
, 
¢d_pcm_fÜm©_t
);

8143 
__OLD_SET_FL
(
¢d_pcm_hw_·¿ms_£t_subfÜm©_fœ¡
, 
¢d_pcm_subfÜm©_t
);

8144 
__OLD_SET_FL
(
¢d_pcm_hw_·¿ms_£t_chªÃls_fœ¡
, );

8145 
__OLD_SET_FL1
(
¢d_pcm_hw_·¿ms_£t_¿‹_fœ¡
, );

8146 
__OLD_SET_FL1
(
¢d_pcm_hw_·¿ms_£t_³riod_time_fœ¡
, );

8147 
__OLD_SET_FL1
(
¢d_pcm_hw_·¿ms_£t_³riod_size_fœ¡
, 
¢d_pcm_uäames_t
);

8148 
__OLD_SET_FL1
(
¢d_pcm_hw_·¿ms_£t_³riods_fœ¡
, );

8149 
__OLD_SET_FL1
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_fœ¡
, );

8150 
__OLD_SET_FL
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_fœ¡
, 
¢d_pcm_uäames_t
);

8151 
__OLD_SET_FL1
(
¢d_pcm_hw_·¿ms_£t_tick_time_fœ¡
, );

8153 
__OLD_SET_FL
(
¢d_pcm_hw_·¿ms_£t_acûss_Ï¡
, 
¢d_pcm_acûss_t
);

8154 
__OLD_SET_FL
(
¢d_pcm_hw_·¿ms_£t_fÜm©_Ï¡
, 
¢d_pcm_fÜm©_t
);

8155 
__OLD_SET_FL
(
¢d_pcm_hw_·¿ms_£t_subfÜm©_Ï¡
, 
¢d_pcm_subfÜm©_t
);

8156 
__OLD_SET_FL
(
¢d_pcm_hw_·¿ms_£t_chªÃls_Ï¡
, );

8157 
__OLD_SET_FL1
(
¢d_pcm_hw_·¿ms_£t_¿‹_Ï¡
, );

8158 
__OLD_SET_FL1
(
¢d_pcm_hw_·¿ms_£t_³riod_time_Ï¡
, );

8159 
__OLD_SET_FL1
(
¢d_pcm_hw_·¿ms_£t_³riod_size_Ï¡
, 
¢d_pcm_uäames_t
);

8160 
__OLD_SET_FL1
(
¢d_pcm_hw_·¿ms_£t_³riods_Ï¡
, );

8161 
__OLD_SET_FL1
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ï¡
, );

8162 
__OLD_SET_FL
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ï¡
, 
¢d_pcm_uäames_t
);

8163 
__OLD_SET_FL1
(
¢d_pcm_hw_·¿ms_£t_tick_time_Ï¡
, );

8165 
	#__P_OLD_GET_SW
(
pfx
, 
Çme
, 
»t_ty³
) \

8166 
EXPORT_SYMBOL
 
»t_ty³
 
pfx
##
	`Çme
(
¢d_pcm_sw_·¿ms_t
 *
·¿ms
) \

8168 
»t_ty³
 
v®
; \

8169 ià(
	`INTERNAL
(
Çme
)(
·¿ms
, &
v®
) < 0) \

8171  (
»t_ty³
)
v®
; \

8172 }

	)

8174 
	#__OLD_GET_SW
(
Çme
, 
»t_ty³
è
	`__P_OLD_GET_SW
(
__Şd_
,‚ame,„‘_ty³)

	)

8176 
__OLD_GET_SW
(
¢d_pcm_sw_·¿ms_g‘_t¡amp_mode
, 
¢d_pcm_t¡amp_t
);

8177 
__OLD_GET_SW
(
¢d_pcm_sw_·¿ms_g‘_¦“p_mš
, );

8178 
__OLD_GET_SW
(
¢d_pcm_sw_·¿ms_g‘_ava_mš
, 
¢d_pcm_uäames_t
);

8179 
__OLD_GET_SW
(
¢d_pcm_sw_·¿ms_g‘_xãr_®ign
, 
¢d_pcm_uäames_t
);

8180 
__OLD_GET_SW
(
¢d_pcm_sw_·¿ms_g‘_¡¬t_th»shŞd
, 
¢d_pcm_uäames_t
);

8181 
__OLD_GET_SW
(
¢d_pcm_sw_·¿ms_g‘_¡İ_th»shŞd
, 
¢d_pcm_uäames_t
);

8182 
__OLD_GET_SW
(
¢d_pcm_sw_·¿ms_g‘_s’û_th»shŞd
, 
¢d_pcm_uäames_t
);

8183 
__OLD_GET_SW
(
¢d_pcm_sw_·¿ms_g‘_s’û_size
, 
¢d_pcm_uäames_t
);

8185 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_acûss
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8186 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_acûss_fœ¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8187 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_acûss_Ï¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8189 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8190 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_fÜm©_fœ¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8191 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_fÜm©_Ï¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8193 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_subfÜm©
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8194 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_subfÜm©_fœ¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8195 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_subfÜm©_Ï¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8197 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_chªÃls
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8198 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_chªÃls_mš
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8199 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_chªÃls_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8200 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_chªÃls_Ã¬
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8201 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_chªÃls_fœ¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8202 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_chªÃls_Ï¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8204 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_¿‹
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8205 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_¿‹_mš
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8206 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_¿‹_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8207 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_¿‹_Ã¬
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8208 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_¿‹_fœ¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8209 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_¿‹_Ï¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8211 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_³riod_time
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8212 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_³riod_time_mš
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8213 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_³riod_time_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8214 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_³riod_time_Ã¬
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8215 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_³riod_time_fœ¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8216 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_³riod_time_Ï¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8218 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_³riod_size
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8219 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_³riod_size_mš
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8220 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_³riod_size_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8221 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_³riod_size_Ã¬
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8222 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_³riod_size_fœ¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8223 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_³riod_size_Ï¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8225 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_³riods
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8226 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_³riods_mš
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8227 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_³riods_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8228 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_³riods_Ã¬
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8229 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_³riods_fœ¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8230 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_³riods_Ï¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8232 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8233 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time_mš
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8234 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8235 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ã¬
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8236 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_fœ¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8237 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ï¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8239 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8240 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size_mš
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8241 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8242 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ã¬
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8243 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_fœ¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8244 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ï¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8246 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_tick_time
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8247 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_tick_time_mš
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8248 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_g‘_tick_time_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8249 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_tick_time_Ã¬
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8250 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_tick_time_fœ¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8251 
OBSOLETE1
(
¢d_pcm_hw_·¿ms_£t_tick_time_Ï¡
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8253 
OBSOLETE1
(
¢d_pcm_sw_·¿ms_g‘_t¡amp_mode
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8254 
OBSOLETE1
(
¢d_pcm_sw_·¿ms_g‘_¦“p_mš
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8255 
OBSOLETE1
(
¢d_pcm_sw_·¿ms_g‘_ava_mš
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8256 
OBSOLETE1
(
¢d_pcm_sw_·¿ms_g‘_xãr_®ign
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8257 
OBSOLETE1
(
¢d_pcm_sw_·¿ms_g‘_¡¬t_th»shŞd
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8258 
OBSOLETE1
(
¢d_pcm_sw_·¿ms_g‘_¡İ_th»shŞd
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8259 
OBSOLETE1
(
¢d_pcm_sw_·¿ms_g‘_s’û_th»shŞd
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8260 
OBSOLETE1
(
¢d_pcm_sw_·¿ms_g‘_s’û_size
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8264 
	$chm­_equ®
(cÚ¡ 
¢d_pcm_chm­_t
 *
a
, cÚ¡ snd_pcm_chm­_ˆ*
b
)

8266 ià(
a
->
chªÃls
 !ğ
b
->channels)

8268  !
	`memcmp
(
a
->
pos
, 
b
->pos,‡->
chªÃls
 * (a->pos[0]));

8269 
	}
}

8283 
¢d_pcm_chm­_qu”y_t
 **
	$¢d_pcm_qu”y_chm­s
(
¢d_pcm_t
 *
pcm
)

8285 ià(!
pcm
->
İs
->
qu”y_chm­s
)

8286  
NULL
;

8287  
pcm
->
İs
->
	`qu”y_chm­s
(pcm);

8288 
	}
}

8294 
	$¢d_pcm_ä“_chm­s
(
¢d_pcm_chm­_qu”y_t
 **
m­s
)

8296 
¢d_pcm_chm­_qu”y_t
 **
p
;

8297 ià(!
m­s
)

8299 
p
 = 
m­s
; *p;…++)

8300 
	`ä“
(*
p
);

8301 
	`ä“
(
m­s
);

8302 
	}
}

8311 
¢d_pcm_chm­_t
 *
	$¢d_pcm_g‘_chm­
(
¢d_pcm_t
 *
pcm
)

8313 ià(!
pcm
->
İs
->
g‘_chm­
)

8314  
NULL
;

8315  
pcm
->
İs
->
	`g‘_chm­
(pcm);

8316 
	}
}

8324 
	$¢d_pcm_£t_chm­
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chm­_t
 *
m­
)

8326 cÚ¡ 
¢d_pcm_chm­_t
 *
Şdm­
;

8327 
nochªge
;

8329 
Şdm­
 = 
	`¢d_pcm_g‘_chm­
(
pcm
);

8330 
nochªge
 = (
Şdm­
 && 
	`chm­_equ®
(Şdm­, 
m­
));

8331 
	`ä“
((*)
Şdm­
);

8332 ià(
nochªge
)

8335 ià(!
pcm
->
İs
->
£t_chm­
)

8336  -
ENXIO
;

8337  
pcm
->
İs
->
	`£t_chm­
Õcm, 
m­
);

8338 
	}
}

8342 #iâdeà
DOC_HIDDEN


8343 
	#_NAME
(
n
è[
SND_CHMAP_TYPE_
##n] = #n

	)

8344 cÚ¡ *
	gchm­_ty³_Çmes
[
SND_CHMAP_TYPE_LAST
 + 1] = {

8345 
_NAME
(
NONE
), _NAME(
FIXED
), _NAME(
VAR
), _NAME(
PAIRED
),

8347 #undeà
_NAME


8355 cÚ¡ *
	$¢d_pcm_chm­_ty³_Çme
(
¢d_pcm_chm­_ty³
 
v®
)

8357 ià(
v®
 <ğ
SND_CHMAP_TYPE_LAST
)

8358  
chm­_ty³_Çmes
[
v®
];

8360  
NULL
;

8361 
	}
}

8363 #iâdeà
DOC_HIDDEN


8364 
	#_NAME
(
n
è[
SND_CHMAP_
##n] = #n

	)

8365 cÚ¡ *
	gchm­_Çmes
[
SND_CHMAP_LAST
 + 1] = {

8366 
_NAME
(
UNKNOWN
), _NAME(
NA
), _NAME(
MONO
),

8367 
_NAME
(
FL
), _NAME(
FR
),

8368 
_NAME
(
RL
), _NAME(
RR
),

8369 
_NAME
(
FC
), _NAME(
LFE
),

8370 
_NAME
(
SL
), _NAME(
SR
),

8371 
_NAME
(
RC
), _NAME(
FLC
), _NAME(
FRC
), _NAME(
RLC
), _NAME(
RRC
),

8372 
_NAME
(
FLW
), _NAME(
FRW
),

8373 
_NAME
(
FLH
), _NAME(
FCH
), _NAME(
FRH
), _NAME(
TC
),

8374 
_NAME
(
TFL
), _NAME(
TFR
), _NAME(
TFC
),

8375 
_NAME
(
TRL
), _NAME(
TRR
), _NAME(
TRC
),

8376 
_NAME
(
TFLC
), _NAME(
TFRC
), _NAME(
TSL
), _NAME(
TSR
),

8377 
_NAME
(
LLFE
), _NAME(
RLFE
),

8378 
_NAME
(
BC
), _NAME(
BLC
), _NAME(
BRC
),

8380 #undeà
_NAME


8388 cÚ¡ *
	$¢d_pcm_chm­_Çme
(
¢d_pcm_chm­_pos™iÚ
 
v®
)

8390 ià(
v®
 <ğ
SND_CHMAP_LAST
)

8391  
chm­_Çmes
[
v®
];

8393  
NULL
;

8394 
	}
}

8396 cÚ¡ *
	gchm­_lÚg_Çmes
[
SND_CHMAP_LAST
 + 1] = {

8397 [
SND_CHMAP_UNKNOWN
] = "Unknown",

8398 [
SND_CHMAP_NA
] = "Unused",

8399 [
SND_CHMAP_MONO
] = "Mono",

8400 [
SND_CHMAP_FL
] = "Front Left",

8401 [
SND_CHMAP_FR
] = "Front Right",

8402 [
SND_CHMAP_RL
] = "Rear Left",

8403 [
SND_CHMAP_RR
] = "Rear Right",

8404 [
SND_CHMAP_FC
] = "Front Center",

8405 [
SND_CHMAP_LFE
] = "LFE",

8406 [
SND_CHMAP_SL
] = "Side Left",

8407 [
SND_CHMAP_SR
] = "Side Right",

8408 [
SND_CHMAP_RC
] = "Rear Center",

8409 [
SND_CHMAP_FLC
] = "Front Left Center",

8410 [
SND_CHMAP_FRC
] = "Front Right Center",

8411 [
SND_CHMAP_RLC
] = "Rear Left Center",

8412 [
SND_CHMAP_RRC
] = "Rear Right Center",

8413 [
SND_CHMAP_FLW
] = "Front Left Wide",

8414 [
SND_CHMAP_FRW
] = "Front Right Wide",

8415 [
SND_CHMAP_FLH
] = "Front Left High",

8416 [
SND_CHMAP_FCH
] = "Front Center High",

8417 [
SND_CHMAP_FRH
] = "Front Right High",

8418 [
SND_CHMAP_TC
] = "Top Center",

8419 [
SND_CHMAP_TFL
] = "Top Front Left",

8420 [
SND_CHMAP_TFR
] = "Top Front Right",

8421 [
SND_CHMAP_TFC
] = "Top Front Center",

8422 [
SND_CHMAP_TRL
] = "Top Rear Left",

8423 [
SND_CHMAP_TRR
] = "Top Rear Right",

8424 [
SND_CHMAP_TRC
] = "Top Rear Center",

8425 [
SND_CHMAP_TFLC
] = "Top Front Left Center",

8426 [
SND_CHMAP_TFRC
] = "Top Front Right Center",

8427 [
SND_CHMAP_TSL
] = "Top Side Left",

8428 [
SND_CHMAP_TSR
] = "Top Side Right",

8429 [
SND_CHMAP_LLFE
] = "Left LFE",

8430 [
SND_CHMAP_RLFE
] = "Right LFE",

8431 [
SND_CHMAP_BC
] = "Bottom Center",

8432 [
SND_CHMAP_BLC
] = "Bottom Left Center",

8433 [
SND_CHMAP_BRC
] = "Bottom Right Center",

8441 cÚ¡ *
	$¢d_pcm_chm­_lÚg_Çme
(
¢d_pcm_chm­_pos™iÚ
 
v®
)

8443 ià(
v®
 <ğ
SND_CHMAP_LAST
)

8444  
chm­_lÚg_Çmes
[
v®
];

8446  
NULL
;

8447 
	}
}

8456 
	$¢d_pcm_chm­_´št
(cÚ¡ 
¢d_pcm_chm­_t
 *
m­
, 
size_t
 
maxËn
, *
buf
)

8458 
i
, 
Ën
 = 0;

8460 
i
 = 0; i < 
m­
->
chªÃls
; i++) {

8461 
p
 = 
m­
->
pos
[
i
] & 
SND_CHMAP_POSITION_MASK
;

8462 ià(
i
 > 0) {

8463 
Ën
 +ğ
	`¢´štf
(
buf
 +†’, 
maxËn
 -†en, " ");

8464 ià(
Ën
 >ğ
maxËn
)

8465  -
ENOMEM
;

8467 ià(
m­
->
pos
[
i
] & 
SND_CHMAP_DRIVER_SPEC
)

8468 
Ën
 +ğ
	`¢´štf
(
buf
 +†’, 
maxËn
 -†’, "%d", 
p
);

8470 cÚ¡ *
Çme
 = 
chm­_Çmes
[
p
];

8471 ià(
Çme
)

8472 
Ën
 +ğ
	`¢´štf
(
buf
 +†’, 
maxËn
 -†en,

8473 "%s", 
Çme
);

8475 
Ën
 +ğ
	`¢´štf
(
buf
 +†’, 
maxËn
 -†en,

8476 "Ch%d", 
p
);

8478 ià(
Ën
 >ğ
maxËn
)

8479  -
ENOMEM
;

8480 ià(
m­
->
pos
[
i
] & 
SND_CHMAP_PHASE_INVERSE
) {

8481 
Ën
 +ğ
	`¢´štf
(
buf
 +†’, 
maxËn
 -†en, "[INV]");

8482 ià(
Ën
 >ğ
maxËn
)

8483  -
ENOMEM
;

8486  
Ën
;

8487 
	}
}

8489 
	$¡r_to_chm­
(cÚ¡ *
¡r
, 
Ën
)

8491 
v®
;

8492 
v
;

8493 *
p
;

8495 ià(
	`isdig™
(*
¡r
)) {

8496 
v
 = 
	`¡¹oul
(
¡r
, &
p
, 0);

8497 ià(
v
 =ğ
ULONG_MAX
)

8499 
v®
 = 
v
;

8500 
v®
 |ğ
SND_CHMAP_DRIVER_SPEC
;

8501 
¡r
 = 
p
;

8502 } ià(!
	`¡ºÿ£cmp
(
¡r
, "ch", 2)) {

8503 
v
 = 
	`¡¹oul
(
¡r
 + 2, &
p
, 0);

8504 ià(
v
 =ğ
ULONG_MAX
)

8506 
v®
 = 
v
;

8507 
¡r
 = 
p
;

8509 
v®
 = 0; v® <ğ
SND_CHMAP_LAST
; val++) {

8510 
¦’
;

8511 
	`as£¹
(
chm­_Çmes
[
v®
]);

8512 
¦’
 = 
	`¡¾’
(
chm­_Çmes
[
v®
]);

8513 ià(
¦’
 > 
Ën
)

8515 ià(!
	`¡ºÿ£cmp
(
¡r
, 
chm­_Çmes
[
v®
], 
¦’
) &&

8516 !
	`i§Íha
(
¡r
[
¦’
])) {

8517 
¡r
 +ğ
¦’
;

8521 ià(
v®
 > 
SND_CHMAP_LAST
)

8524 ià(
¡r
 && !
	`¡ºÿ£cmp
(str, "[INV]", 5))

8525 
v®
 |ğ
SND_CHMAP_PHASE_INVERSE
;

8526  
v®
;

8527 
	}
}

8534 
	$¢d_pcm_chm­_äom_¡ršg
(cÚ¡ *
¡r
)

8536  
	`¡r_to_chm­
(
¡r
, 
	`¡¾’
(str));

8537 
	}
}

8546 
¢d_pcm_chm­_t
 *
	$¢d_pcm_chm­_·r£_¡ršg
(cÚ¡ *
¡r
)

8548 
i
, 
ch
 = 0;

8549 
tmp_m­
[64];

8550 
¢d_pcm_chm­_t
 *
m­
;

8553 cÚ¡ *
p
;

8554 
Ën
, 
v®
;

8556 ià(
ch
 >ğ()((
tmp_m­
) / (tmp_map[0])))

8557  
NULL
;

8558 
p
 = 
¡r
; *°&& 
	`i§Êum
(*p);…++)

8560 
Ën
 = 
p
 - 
¡r
;

8561 ià(!
Ën
)

8562  
NULL
;

8563 
v®
 = 
	`¡r_to_chm­
(
¡r
, 
Ën
);

8564 ià(
v®
 < 0)

8565  
NULL
;

8566 
¡r
 +ğ
Ën
;

8567 ià(*
¡r
 == '[') {

8568 ià(!
	`¡ºcmp
(
¡r
, "[INV]", 5)) {

8569 
v®
 |ğ
SND_CHMAP_PHASE_INVERSE
;

8570 
¡r
 += 5;

8573 
tmp_m­
[
ch
] = 
v®
;

8574 
ch
++;

8575 ; *
¡r
 && !
	`i§Êum
(*str); str++)

8577 ià(!*
¡r
)

8580 
m­
 = 
	`m®loc
((*m­è+ 
ch
 * ());

8581 ià(!
m­
)

8582  
NULL
;

8583 
m­
->
chªÃls
 = 
ch
;

8584 
i
 = 0; i < 
ch
; i++)

8585 
m­
->
pos
[
i
] = 
tmp_m­
[i];

8586  
m­
;

8587 
	}
}

8590 
	$_cİy_to_fixed_qu”y_m­
(
¢d_pcm_chm­_qu”y_t
 **
d¡
,

8591 cÚ¡ 
¢d_pcm_chm­_t
 *
¤c
)

8593 *
d¡
 = 
	`m®loc
((
¤c
->
chªÃls
 + 2) * ());

8594 ià(!*
d¡
)

8595  -
ENOMEM
;

8596 (*
d¡
)->
ty³
 = 
SND_CHMAP_TYPE_FIXED
;

8597 
	`memıy
(&(*
d¡
)->
m­
, 
¤c
, (¤c->
chªÃls
 + 1) * ());

8599 
	}
}

8601 #iâdeà
DOC_HIDDEN


8603 
¢d_pcm_chm­_qu”y_t
 **

8604 
	$_¢d_pcm_make_sšgË_qu”y_chm­s
(cÚ¡ 
¢d_pcm_chm­_t
 *
¤c
)

8606 
¢d_pcm_chm­_qu”y_t
 **
m­s
;

8608 
m­s
 = 
	`ÿÎoc
(2, (*maps));

8609 ià(!
m­s
)

8610  
NULL
;

8611 ià(
	`_cİy_to_fixed_qu”y_m­
(
m­s
, 
¤c
)) {

8612 
	`ä“
(
m­s
);

8613  
NULL
;

8615  
m­s
;

8616 
	}
}

8619 
¢d_pcm_chm­_t
 *
	$_¢d_pcm_cİy_chm­
(cÚ¡ 
¢d_pcm_chm­_t
 *
¤c
)

8621 
¢d_pcm_chm­_t
 *
m­
;

8623 
m­
 = 
	`m®loc
((
¤c
->
chªÃls
 + 1) * ());

8624 ià(!
m­
)

8625  
NULL
;

8626 
	`memıy
(
m­
, 
¤c
, (¤c->
chªÃls
 + 1) * ());

8627  
m­
;

8628 
	}
}

8631 
¢d_pcm_chm­_qu”y_t
 **

8632 
	$_¢d_pcm_cİy_chm­_qu”y
(
¢d_pcm_chm­_qu”y_t
 * cÚ¡ *
¤c
)

8634 
¢d_pcm_chm­_qu”y_t
 * cÚ¡ *
p
;

8635 
¢d_pcm_chm­_qu”y_t
 **
m­s
;

8636 
i
, 
nums
;

8638 
nums
 = 0, 
p
 = 
¤c
; *p;…++)

8639 
nums
++;

8641 
m­s
 = 
	`ÿÎoc
(
nums
 + 1, (*maps));

8642 ià(!
m­s
)

8643  
NULL
;

8644 
i
 = 0; i < 
nums
; i++) {

8645 
m­s
[
i
] = 
	`m®loc
((
¤c
[i]->
m­
.
chªÃls
 + 2) * ());

8646 ià(!
m­s
[
i
]) {

8647 
	`¢d_pcm_ä“_chm­s
(
m­s
);

8648  
NULL
;

8650 
	`memıy
(
m­s
[
i
], 
¤c
[i], (¤c[i]->
m­
.
chªÃls
 + 2) * ());

8652  
m­s
;

8653 
	}
}

8656 
¢d_pcm_chm­_t
 *

8657 
	$_¢d_pcm_choo£_fixed_chm­
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chm­_qu”y_t
 * cÚ¡ *
m­s
)

8659 
¢d_pcm_chm­_qu”y_t
 * cÚ¡ *
p
;

8661 
p
 = 
m­s
; *p;…++) {

8662 ià((*
p
)->
m­
.
chªÃls
 =ğ
pcm
->channels)

8663  
	`_¢d_pcm_cİy_chm­
(&(*
p
)->
m­
);

8665  
NULL
;

8666 
	}
}

8671 
¢d_pcm_chm­_qu”y_t
 **

8672 
	$_¢d_pcm_·r£_cÚfig_chm­s
(
¢d_cÚfig_t
 *
cÚf
)

8674 
¢d_pcm_chm­_t
 *
chm­
;

8675 
¢d_pcm_chm­_qu”y_t
 **
m­s
;

8676 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

8677 cÚ¡ *
¡r
;

8678 
nums
, 
”r
;

8680 ià(
	`¢d_cÚfig_g‘_ty³
(
cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
)

8681  
NULL
;

8683 
nums
 = 0;

8684 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

8685 
nums
++;

8688 
m­s
 = 
	`ÿÎoc
(
nums
 + 1, (*maps));

8689 ià(!
m­s
)

8690  
NULL
;

8692 
nums
 = 0;

8693 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

8694 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

8695 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
);

8696 ià(
”r
 < 0)

8697 
”rÜ
;

8698 
chm­
 = 
	`¢d_pcm_chm­_·r£_¡ršg
(
¡r
);

8699 ià(!
chm­
)

8700 
”rÜ
;

8701 ià(
	`_cİy_to_fixed_qu”y_m­
(
m­s
 + 
nums
, 
chm­
)) {

8702 
	`ä“
(
chm­
);

8703 
”rÜ
;

8705 
	`ä“
(
chm­
);

8706 
nums
++;

8708  
m­s
;

8710 
”rÜ
:

8711 
	`¢d_pcm_ä“_chm­s
(
m­s
);

8712  
NULL
;

8713 
	}
}

8737 
	$¢d_pcm_»cov”
(
¢d_pcm_t
 *
pcm
, 
”r
, 
s’t
)

8739 ià(
”r
 > 0)

8740 
”r
 = -err;

8741 ià(
”r
 =ğ-
EINTR
)

8743 ià(
”r
 =ğ-
EPIPE
) {

8744 cÚ¡ *
s
;

8745 ià(
	`¢d_pcm_¡»am
(
pcm
è=ğ
SND_PCM_STREAM_PLAYBACK
)

8746 
s
 = "underrun";

8748 
s
 = "overrun";

8749 ià(!
s’t
)

8750 
	`SNDERR
("% occu¼ed", 
s
);

8751 
”r
 = 
	`¢d_pcm_´•¬e
(
pcm
);

8752 ià(
”r
 < 0) {

8753 
	`SNDERR
("ÿÂÙ„ecov”y from %s,…»·» faed: %s", 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8754  
”r
;

8758 ià(
”r
 =ğ-
ESTRPIPE
) {

8759 (
”r
 = 
	`¢d_pcm_»sume
(
pcm
)è=ğ-
EAGAIN
)

8761 
	`pŞl
(
NULL
, 0, 1000);

8762 ià(
”r
 < 0) {

8763 
”r
 = 
	`¢d_pcm_´•¬e
(
pcm
);

8764 ià(
”r
 < 0) {

8765 
	`SNDERR
("ÿÂÙ„ecov”y from su¥’d,…»·» faed: %s", 
	`¢d_¡»¼Ü
(
”r
));

8766  
”r
;

8771  
”r
;

8772 
	}
}

8785 
	$¢d_pcm_£t_·¿ms
(
¢d_pcm_t
 *
pcm
,

8786 
¢d_pcm_fÜm©_t
 
fÜm©
,

8787 
¢d_pcm_acûss_t
 
acûss
,

8788 
chªÃls
,

8789 
¿‹
,

8790 
soá_»§m¶e
,

8791 
Ï‹ncy
)

8793 
¢d_pcm_hw_·¿ms_t
 
·¿ms_§ved
, 
·¿ms
 = {0};

8794 
¢d_pcm_sw_·¿ms_t
 
sw·¿ms
 = {0};

8795 cÚ¡ *
s
 = 
	`¢d_pcm_¡»am_Çme
(
	`¢d_pcm_¡»am
(
pcm
));

8796 
¢d_pcm_uäames_t
 
bufãr_size
, 
³riod_size
;

8797 
¼©e
, 
³riod_time
;

8798 
”r
;

8800 
	`as£¹
(
pcm
);

8802 
”r
 = 
	`¢d_pcm_hw_·¿ms_ªy
(
pcm
, &
·¿ms
);

8803 ià(
”r
 < 0) {

8804 
	`SNDERR
("Broken configuration for %s:‚o configurations‡vailable",

8805 
s
);

8806  
”r
;

8809 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_¿‹_»§m¶e
(
pcm
, &
·¿ms
, 
soá_»§m¶e
);

8810 ià(
”r
 < 0) {

8811 
	`SNDERR
("Resampling setup failed for %s: %s",

8812 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8813  
”r
;

8816 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_acûss
(
pcm
, &
·¿ms
, 
acûss
);

8817 ià(
”r
 < 0) {

8818 
	`SNDERR
("Accessype‚ot‡vailable for %s: %s",

8819 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8820  
”r
;

8823 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_fÜm©
(
pcm
, &
·¿ms
, 
fÜm©
);

8824 ià(
”r
 < 0) {

8825 
	`SNDERR
("Sample format‚ot‡vailable for %s: %s",

8826 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8827  
”r
;

8830 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_chªÃls
(
pcm
, &
·¿ms
, 
chªÃls
);

8831 ià(
”r
 < 0) {

8832 
	`SNDERR
("Channels count (%i)‚ot‡vailable for %s: %s",

8833 
chªÃls
, 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8834  
”r
;

8837 
¼©e
 = 
¿‹
;

8838 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_¿‹_Ã¬
)(
pcm
, &
·¿ms
, &
¼©e
,

8840 ià(
”r
 < 0) {

8841 
	`SNDERR
("Rate %iHz‚ot‡vailable for…layback: %s",

8842 
¿‹
, 
	`¢d_¡»¼Ü
(
”r
));

8843  
”r
;

8845 ià(
¼©e
 !ğ
¿‹
) {

8846 
	`SNDERR
("Rate doesn't match (requested %iHz, get %iHz)",

8847 
¿‹
, 
¼©e
);

8848  -
EINVAL
;

8851 
·¿ms_§ved
 = 
·¿ms
;

8852 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ã¬
)(
pcm
, &
·¿ms
,

8853 &
Ï‹ncy
, 
NULL
);

8854 ià(
”r
 < 0) {

8856 
·¿ms
 = 
·¿ms_§ved
;

8858 
³riod_time
 = 
Ï‹ncy
 / 4;

8859 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_time_Ã¬
)(
pcm
,

8860 &
·¿ms
, &
³riod_time
, 
NULL
);

8861 ià(
”r
 < 0) {

8862 
	`SNDERR
("Unableo set…eriodime %i for %s: %s",

8863 
³riod_time
, 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8864  
”r
;

8866 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_size
)(&
·¿ms
,

8867 &
³riod_size
, 
NULL
);

8868 ià(
”r
 < 0) {

8869 
	`SNDERR
("Unableo get…eriod size for %s: %s",

8870 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8871  
”r
;

8873 
bufãr_size
 = 
³riod_size
 * 4;

8874 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ã¬
)(
pcm
,

8875 &
·¿ms
, &
bufãr_size
);

8876 ià(
”r
 < 0) {

8877 
	`SNDERR
("Unableo set buffer size %lu %s: %s",

8878 
bufãr_size
, 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8879  
”r
;

8881 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size
)(&
·¿ms
,

8882 &
bufãr_size
);

8883 ià(
”r
 < 0) {

8884 
	`SNDERR
("Unableo get buffer size for %s: %s",

8885 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8886  
”r
;

8890 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size
)(&
·¿ms
,

8891 &
bufãr_size
);

8892 ià(
”r
 < 0) {

8893 
	`SNDERR
("Unableo get buffer size for %s: %s",

8894 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8895  
”r
;

8897 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time
)(&
·¿ms
,

8898 &
Ï‹ncy
, 
NULL
);

8899 ià(
”r
 < 0) {

8900 
	`SNDERR
("Unableo get bufferime (latency) for %s: %s",

8901 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8902  
”r
;

8905 
³riod_time
 = 
Ï‹ncy
 / 4;

8906 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_time_Ã¬
)(
pcm
,

8907 &
·¿ms
, &
³riod_time
, 
NULL
);

8908 ià(
”r
 < 0) {

8909 
	`SNDERR
("Unableo set…eriodime %i for %s: %s",

8910 
³riod_time
, 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8911  
”r
;

8913 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_size
)(&
·¿ms
,

8914 &
³riod_size
, 
NULL
);

8915 ià(
”r
 < 0) {

8916 
	`SNDERR
("Unableo get…eriod size for %s: %s",

8917 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8918  
”r
;

8922 
”r
 = 
	`¢d_pcm_hw_·¿ms
(
pcm
, &
·¿ms
);

8923 ià(
”r
 < 0) {

8924 
	`SNDERR
("Unableo set hw…arams for %s: %s",

8925 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8926  
”r
;

8930 
”r
 = 
	`¢d_pcm_sw_·¿ms_cu¼’t
(
pcm
, &
sw·¿ms
);

8931 ià(
”r
 < 0) {

8932 
	`SNDERR
("Unableo determine current swparams for %s: %s",

8933 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8934  
”r
;

8940 
”r
 = 
	`¢d_pcm_sw_·¿ms_£t_¡¬t_th»shŞd
(
pcm
, &
sw·¿ms
,

8941 (
bufãr_size
 / 
³riod_size
) *…eriod_size);

8942 ià(
”r
 < 0) {

8943 
	`SNDERR
("Unableo set starthreshold mode for %s: %s",

8944 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8945  
”r
;

8951 
”r
 = 
	`¢d_pcm_sw_·¿ms_£t_ava_mš
(
pcm
, &
sw·¿ms
, 
³riod_size
);

8952 ià(
”r
 < 0) {

8953 
	`SNDERR
("Unableo set‡vail min for %s: %s",

8954 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8955  
”r
;

8958 
”r
 = 
	`¢d_pcm_sw_·¿ms
(
pcm
, &
sw·¿ms
);

8959 ià(
”r
 < 0) {

8960 
	`SNDERR
("Unableo set sw…arams for %s: %s",

8961 
s
, 
	`¢d_¡»¼Ü
(
”r
));

8962  
”r
;

8965 
	}
}

8974 
	$¢d_pcm_g‘_·¿ms
(
¢d_pcm_t
 *
pcm
,

8975 
¢d_pcm_uäames_t
 *
bufãr_size
,

8976 
¢d_pcm_uäames_t
 *
³riod_size
)

8978 
¢d_pcm_hw_·¿ms_t
 
·¿ms
 = {0};

8979 
”r
;

8981 
	`as£¹
(
pcm
);

8982 
”r
 = 
	`¢d_pcm_hw_·¿ms_cu¼’t
(
pcm
, &
·¿ms
);

8983 ià(
”r
 < 0)

8984  
”r
;

8985 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size
)(&
·¿ms
, 
bufãr_size
);

8986 ià(
”r
 < 0)

8987  
”r
;

8988  
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_size
)(&
·¿ms
, 
³riod_size
,

8989 
NULL
);

8990 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_adpcm.c

59 
	~"pcm_loÿl.h
"

60 
	~"pcm_¶ugš.h
"

61 
	~"¶ugš_İs.h
"

62 
	~"bsw­.h
"

64 #iâdeà
PIC


66 cÚ¡ *
	g_¢d_moduË_pcm_adpcm
 = "";

69 #iâdeà
DOC_HIDDEN


71 (*
	tadpcm_f
)(cÚ¡ 
	t¢d_pcm_chªÃl_¬—_t
 *
	td¡_¬—s
,

72 
	t¢d_pcm_uäames_t
 
	td¡_off£t
,

73 cÚ¡ 
	t¢d_pcm_chªÃl_¬—_t
 *
	t¤c_¬—s
,

74 
	t¢d_pcm_uäames_t
 
	t¤c_off£t
,

75 
	tchªÃls
, 
	t¢d_pcm_uäames_t
 
	täames
,

76 
	tg‘putidx
,

77 
	t¢d_pcm_adpcm_¡©e_t
 *
	t¡©es
);

81 
¢d_pcm_¶ugš_t
 
¶ug
;

82 
g‘put_idx
;

83 
adpcm_f
 
func
;

84 
¢d_pcm_fÜm©_t
 
sfÜm©
;

85 
¢d_pcm_adpcm_¡©e_t
 *
¡©es
;

86 } 
	t¢d_pcm_adpcm_t
;

91 cÚ¡ 
IndexAdju¡
[8] = { -1, -1, -1, -1, 2, 4, 6, 8 
	}
};

94 cÚ¡ 
	gS‹pSize
[89] = {

106 
	$adpcm_’cod”
(
¦
, 
¢d_pcm_adpcm_¡©e_t
 * 
¡©e
)

108 
diff
;

109 
´ed_diff
;

111 
sign
;

112 
¡•
;

113 
adju¡_idx
;

115 
i
;

118 
diff
 = 
¦
 - 
¡©e
->
´ed_v®
;

119 
sign
 = (
diff
 < 0) ? 0x8 : 0x0;

120 ià(
sign
) {

121 
diff
 = -diff;

134 
¡•
 = 
S‹pSize
[
¡©e
->
¡•_idx
];

137 
´ed_diff
 = 
¡•
 >> 3;

138 
adju¡_idx
 = 0, 
i
 = 0x4; i; i >>ğ1, 
¡•
 >>= 1) {

139 ià(
diff
 >ğ
¡•
) {

140 
adju¡_idx
 |ğ
i
;

141 
diff
 -ğ
¡•
;

142 
´ed_diff
 +ğ
¡•
;

147 
¡©e
->
´ed_v®
 +ğ
sign
 ? -
´ed_diff
 :…red_diff;

149 ià(
¡©e
->
´ed_v®
 > 32767) {

150 
¡©e
->
´ed_v®
 = 32767;

151 } ià(
¡©e
->
´ed_v®
 < -32768) {

152 
¡©e
->
´ed_v®
 = -32768;

156 
¡©e
->
¡•_idx
 +ğ
IndexAdju¡
[
adju¡_idx
];

158 ià(
¡©e
->
¡•_idx
 < 0) {

159 
¡©e
->
¡•_idx
 = 0;

160 } ià(
¡©e
->
¡•_idx
 > 88) {

161 
¡©e
->
¡•_idx
 = 88;

163  (
sign
 | 
adju¡_idx
);

164 
	}
}

167 
	$adpcm_decod”
(
code
, 
¢d_pcm_adpcm_¡©e_t
 * 
¡©e
)

169 
´ed_diff
;

170 
¡•
;

171 
sign
;

173 
i
;

176 
sign
 = 
code
 & 0x8;

177 
code
 &= 0x7;

184 
¡•
 = 
S‹pSize
[
¡©e
->
¡•_idx
];

187 
´ed_diff
 = 
¡•
 >> 3;

188 
i
 = 0x4; i; i >>ğ1, 
¡•
 >>= 1) {

189 ià(
code
 & 
i
) {

190 
´ed_diff
 +ğ
¡•
;

193 
¡©e
->
´ed_v®
 +ğ(
sign
è? -
´ed_diff
 :…red_diff;

196 ià(
¡©e
->
´ed_v®
 > 32767) {

197 
¡©e
->
´ed_v®
 = 32767;

198 } ià(
¡©e
->
´ed_v®
 < -32768) {

199 
¡©e
->
´ed_v®
 = -32768;

203 
¡©e
->
¡•_idx
 +ğ
IndexAdju¡
[
code
];

205 ià(
¡©e
->
¡•_idx
 < 0) {

206 
¡©e
->
¡•_idx
 = 0;

207 } ià(
¡©e
->
¡•_idx
 > 88) {

208 
¡©e
->
¡•_idx
 = 88;

210  (
¡©e
->
´ed_v®
);

211 
	}
}

213 #iâdeà
DOC_HIDDEN


215 
	$¢d_pcm_adpcm_decode
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

216 
¢d_pcm_uäames_t
 
d¡_off£t
,

217 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

218 
¢d_pcm_uäames_t
 
¤c_off£t
,

219 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

220 
putidx
,

221 
¢d_pcm_adpcm_¡©e_t
 *
¡©es
)

223 
	#PUT16_LABELS


	)

224 
	~"¶ugš_İs.h
"

225 #undeà
PUT16_LABELS


226 *
put
 = 
put16_Ïb–s
[
putidx
];

227 
chªÃl
;

228 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++chªÃl, ++
¡©es
) {

229 cÚ¡ *
¤c
;

230 
¤cb™
;

231 *
d¡
;

232 
¤c_¡•
, 
¤cb™_¡•
, 
d¡_¡•
;

233 
¢d_pcm_uäames_t
 
äames1
;

234 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

235 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

236 
¤cb™
 = 
¤c_¬—
->
fœ¡
 + src_¬—->
¡•
 * 
¤c_off£t
;

237 
¤c
 = (cÚ¡ *è
¤c_¬—
->
addr
 + 
¤cb™
 / 8;

238 
¤cb™
 %= 8;

239 
¤c_¡•
 = 
¤c_¬—
->
¡•
 / 8;

240 
¤cb™_¡•
 = 
¤c_¬—
->
¡•
 % 8;

241 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

242 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
);

243 
äames1
 = 
äames
;

244 
äames1
-- > 0) {

245 
št16_t
 
§m¶e
;

246 
v
;

247 ià(
¤cb™
)

248 
v
 = *
¤c
 & 0x0f;

250 
v
 = (*
¤c
 >> 4) & 0x0f;

251 
§m¶e
 = 
	`adpcm_decod”
(
v
, 
¡©es
);

252 *
put
;

253 
	#PUT16_END
 
aá”


	)

254 
	~"¶ugš_İs.h
"

255 #undeà
PUT16_END


256 
aá”
:

257 
¤c
 +ğ
¤c_¡•
;

258 
¤cb™
 +ğ
¤cb™_¡•
;

259 ià(
¤cb™
 == 8) {

260 
¤c
++;

261 
¤cb™
 = 0;

263 
d¡
 +ğ
d¡_¡•
;

266 
	}
}

268 
	$¢d_pcm_adpcm_’code
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

269 
¢d_pcm_uäames_t
 
d¡_off£t
,

270 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

271 
¢d_pcm_uäames_t
 
¤c_off£t
,

272 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

273 
g‘idx
,

274 
¢d_pcm_adpcm_¡©e_t
 *
¡©es
)

276 
	#GET16_LABELS


	)

277 
	~"¶ugš_İs.h
"

278 #undeà
GET16_LABELS


279 *
g‘
 = 
g‘16_Ïb–s
[
g‘idx
];

280 
chªÃl
;

281 
št16_t
 
§m¶e
 = 0;

282 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++chªÃl, ++
¡©es
) {

283 cÚ¡ *
¤c
;

284 *
d¡
;

285 
d¡b™
;

286 
¤c_¡•
, 
d¡_¡•
, 
d¡b™_¡•
;

287 
¢d_pcm_uäames_t
 
äames1
;

288 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

289 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

290 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

291 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
);

292 
d¡b™
 = 
d¡_¬—
->
fœ¡
 + d¡_¬—->
¡•
 * 
d¡_off£t
;

293 
d¡
 = (*è
d¡_¬—
->
addr
 + 
d¡b™
 / 8;

294 
d¡b™
 %= 8;

295 
d¡_¡•
 = 
d¡_¬—
->
¡•
 / 8;

296 
d¡b™_¡•
 = 
d¡_¬—
->
¡•
 % 8;

297 
äames1
 = 
äames
;

298 
äames1
-- > 0) {

299 
v
;

300 *
g‘
;

301 
	#GET16_END
 
aá”


	)

302 
	~"¶ugš_İs.h
"

303 #undeà
GET16_END


304 
aá”
:

305 
v
 = 
	`adpcm_’cod”
(
§m¶e
, 
¡©es
);

306 ià(
d¡b™
)

307 *
d¡
 = (*d¡ & 0xf0è| 
v
;

309 *
d¡
 = (*d¡ & 0x0fè| (
v
 << 4);

310 
¤c
 +ğ
¤c_¡•
;

311 
d¡
 +ğ
d¡_¡•
;

312 
d¡b™
 +ğ
d¡b™_¡•
;

313 ià(
d¡b™
 == 8) {

314 
d¡
++;

315 
d¡b™
 = 0;

319 
	}
}

323 
	$¢d_pcm_adpcm_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

325 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
´iv©e_d©a
;

326 
”r
;

327 
¢d_pcm_acûss_mask_t
 
acûss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

328 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

329 &
acûss_mask
);

330 ià(
”r
 < 0)

331  
”r
;

332 ià(
adpcm
->
sfÜm©
 =ğ
SND_PCM_FORMAT_IMA_ADPCM
) {

333 
¢d_pcm_fÜm©_mask_t
 
fÜm©_mask
 = { 
SND_PCM_FMTBIT_LINEAR
 };

334 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
,

335 &
fÜm©_mask
);

337 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
·¿ms
,

338 
SND_PCM_FORMAT_IMA_ADPCM
);

340 ià(
”r
 < 0)

341  
”r
;

342 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
·¿ms
,

343 
SND_PCM_SUBFORMAT_STD
);

344 ià(
”r
 < 0)

345  
”r
;

346 
·¿ms
->
šfo
 &ğ~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

348 
	}
}

350 
	$¢d_pcm_adpcm_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

352 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
´iv©e_d©a
;

353 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

354 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

355 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

356 &
§cûss_mask
);

357 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
¥¬ams
, 
adpcm
->
sfÜm©
);

358 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¥¬ams
, 
SND_PCM_SUBFORMAT_STD
);

360 
	}
}

362 
	$¢d_pcm_adpcm_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

363 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

365 
”r
;

366 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

367 
SND_PCM_HW_PARBIT_RATE
 |

368 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

369 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

370 
SND_PCM_HW_PARBIT_PERIODS
 |

371 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

372 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

373 
SND_PCM_HW_PARBIT_TICK_TIME
);

374 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

375 ià(
”r
 < 0)

376  
”r
;

378 
	}
}

380 
	$¢d_pcm_adpcm_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

381 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

383 
”r
;

384 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

385 
SND_PCM_HW_PARBIT_RATE
 |

386 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

387 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

388 
SND_PCM_HW_PARBIT_PERIODS
 |

389 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

390 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

391 
SND_PCM_HW_PARBIT_TICK_TIME
);

392 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

393 ià(
”r
 < 0)

394  
”r
;

396 
	}
}

398 
	$¢d_pcm_adpcm_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

400  
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

401 
¢d_pcm_adpcm_hw_»fše_ı»·»
,

402 
¢d_pcm_adpcm_hw_»fše_cchªge
,

403 
¢d_pcm_adpcm_hw_»fše_¥»·»
,

404 
¢d_pcm_adpcm_hw_»fše_schªge
,

405 
¢d_pcm_g’”ic_hw_»fše
);

406 
	}
}

408 
	$¢d_pcm_adpcm_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 * 
·¿ms
)

410 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
´iv©e_d©a
;

411 
¢d_pcm_fÜm©_t
 
fÜm©
;

412 
”r
 = 
	`¢d_pcm_hw_·¿ms_¦ave
(
pcm
, 
·¿ms
,

413 
¢d_pcm_adpcm_hw_»fše_cchªge
,

414 
¢d_pcm_adpcm_hw_»fše_¥»·»
,

415 
¢d_pcm_adpcm_hw_»fše_schªge
,

416 
¢d_pcm_g’”ic_hw_·¿ms
);

417 ià(
”r
 < 0)

418  
”r
;

420 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(
·¿ms
, &
fÜm©
);

421 ià(
”r
 < 0)

422  
”r
;

424 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

425 ià(
adpcm
->
sfÜm©
 =ğ
SND_PCM_FORMAT_IMA_ADPCM
) {

426 
adpcm
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_g‘_šdex
(
fÜm©
, 
SND_PCM_FORMAT_S16
);

427 
adpcm
->
func
 = 
¢d_pcm_adpcm_’code
;

429 
adpcm
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_put_šdex
(
SND_PCM_FORMAT_S16
,‡dpcm->
sfÜm©
);

430 
adpcm
->
func
 = 
¢d_pcm_adpcm_decode
;

433 ià(
adpcm
->
sfÜm©
 =ğ
SND_PCM_FORMAT_IMA_ADPCM
) {

434 
adpcm
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_put_šdex
(
SND_PCM_FORMAT_S16
, 
fÜm©
);

435 
adpcm
->
func
 = 
¢d_pcm_adpcm_decode
;

437 
adpcm
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_g‘_šdex
×dpcm->
sfÜm©
, 
SND_PCM_FORMAT_S16
);

438 
adpcm
->
func
 = 
¢d_pcm_adpcm_’code
;

441 
	`as£¹
(!
adpcm
->
¡©es
);

442 
adpcm
->
¡©es
 = 
	`m®loc
×dpcm->
¶ug
.
g’
.
¦ave
->
chªÃls
 * (*adpcm->states));

443 ià(
adpcm
->
¡©es
 =ğ
NULL
)

444  -
ENOMEM
;

446 
	}
}

448 
	$¢d_pcm_adpcm_hw_ä“
(
¢d_pcm_t
 *
pcm
)

450 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
´iv©e_d©a
;

451 
	`ä“
(
adpcm
->
¡©es
);

452 
adpcm
->
¡©es
 = 
NULL
;

453  
	`¢d_pcm_hw_ä“
(
adpcm
->
¶ug
.
g’
.
¦ave
);

454 
	}
}

456 
	$¢d_pcm_adpcm_š™
(
¢d_pcm_t
 *
pcm
)

458 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
´iv©e_d©a
;

459 
k
;

460 
k
 = 0; k < 
pcm
->
chªÃls
; ++k) {

461 
adpcm
->
¡©es
[
k
].
´ed_v®
 = 0;

462 
adpcm
->
¡©es
[
k
].
¡•_idx
 = 0;

465 
	}
}

467 
¢d_pcm_uäames_t


468 
	$¢d_pcm_adpcm_wr™e_¬—s
(
¢d_pcm_t
 *
pcm
,

469 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

470 
¢d_pcm_uäames_t
 
off£t
,

471 
¢d_pcm_uäames_t
 
size
,

472 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

473 
¢d_pcm_uäames_t
 
¦ave_off£t
,

474 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

476 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
´iv©e_d©a
;

477 ià(
size
 > *
¦ave_siz•
)

478 
size
 = *
¦ave_siz•
;

479 
adpcm
->
	`func
(
¦ave_¬—s
, 
¦ave_off£t
,

480 
¬—s
, 
off£t
,

481 
pcm
->
chªÃls
, 
size
,

482 
adpcm
->
g‘put_idx
,‡dpcm->
¡©es
);

483 *
¦ave_siz•
 = 
size
;

484  
size
;

485 
	}
}

487 
¢d_pcm_uäames_t


488 
	$¢d_pcm_adpcm_»ad_¬—s
(
¢d_pcm_t
 *
pcm
,

489 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

490 
¢d_pcm_uäames_t
 
off£t
,

491 
¢d_pcm_uäames_t
 
size
,

492 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

493 
¢d_pcm_uäames_t
 
¦ave_off£t
,

494 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

496 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
´iv©e_d©a
;

497 ià(
size
 > *
¦ave_siz•
)

498 
size
 = *
¦ave_siz•
;

499 
adpcm
->
	`func
(
¬—s
, 
off£t
,

500 
¦ave_¬—s
, 
¦ave_off£t
,

501 
pcm
->
chªÃls
, 
size
,

502 
adpcm
->
g‘put_idx
,‡dpcm->
¡©es
);

503 *
¦ave_siz•
 = 
size
;

504  
size
;

505 
	}
}

507 
	$¢d_pcm_adpcm_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

509 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
´iv©e_d©a
;

510 
	`¢d_ouut_´štf
(
out
, "Ima-ADPCM conversion PCM (%s)\n",

511 
	`¢d_pcm_fÜm©_Çme
(
adpcm
->
sfÜm©
));

512 ià(
pcm
->
£tup
) {

513 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

514 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

516 
	`¢d_ouut_´štf
(
out
, "Slave: ");

517 
	`¢d_pcm_dump
(
adpcm
->
¶ug
.
g’
.
¦ave
, 
out
);

518 
	}
}

520 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_adpcm_İs
 = {

521 .
şo£
 = 
¢d_pcm_g’”ic_şo£
,

522 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

523 .
	ghw_»fše
 = 
¢d_pcm_adpcm_hw_»fše
,

524 .
	ghw_·¿ms
 = 
¢d_pcm_adpcm_hw_·¿ms
,

525 .
	ghw_ä“
 = 
¢d_pcm_adpcm_hw_ä“
,

526 .
	gsw_·¿ms
 = 
¢d_pcm_g’”ic_sw_·¿ms
,

527 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

528 .
	gdump
 = 
¢d_pcm_adpcm_dump
,

529 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

530 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

531 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

532 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

533 .
	gqu”y_chm­s
 = 
¢d_pcm_g’”ic_qu”y_chm­s
,

534 .
	gg‘_chm­
 = 
¢d_pcm_g’”ic_g‘_chm­
,

535 .
	g£t_chm­
 = 
¢d_pcm_g’”ic_£t_chm­
,

550 
	$¢d_pcm_adpcm_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
, 
¢d_pcm_fÜm©_t
 
sfÜm©
, snd_pcm_ˆ*
¦ave
, 
şo£_¦ave
)

552 
¢d_pcm_t
 *
pcm
;

553 
¢d_pcm_adpcm_t
 *
adpcm
;

554 
”r
;

555 
	`as£¹
(
pcmp
 && 
¦ave
);

556 ià(
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1 &&

557 
sfÜm©
 !ğ
SND_PCM_FORMAT_IMA_ADPCM
)

558  -
EINVAL
;

559 
adpcm
 = 
	`ÿÎoc
(1, (
¢d_pcm_adpcm_t
));

560 ià(!
adpcm
) {

561  -
ENOMEM
;

563 
adpcm
->
sfÜm©
 = sformat;

564 
	`¢d_pcm_¶ugš_š™
(&
adpcm
->
¶ug
);

565 
adpcm
->
¶ug
.
»ad
 = 
¢d_pcm_adpcm_»ad_¬—s
;

566 
adpcm
->
¶ug
.
wr™e
 = 
¢d_pcm_adpcm_wr™e_¬—s
;

567 
adpcm
->
¶ug
.
š™
 = 
¢d_pcm_adpcm_š™
;

568 
adpcm
->
¶ug
.
g’
.
¦ave
 = slave;

569 
adpcm
->
¶ug
.
g’
.
şo£_¦ave
 = close_slave;

571 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_ADPCM
, 
Çme
, 
¦ave
->
¡»am
, sÏve->
mode
);

572 ià(
”r
 < 0) {

573 
	`ä“
(
adpcm
);

574  
”r
;

576 
pcm
->
İs
 = &
¢d_pcm_adpcm_İs
;

577 
pcm
->
ç¡_İs
 = &
¢d_pcm_¶ugš_ç¡_İs
;

578 
pcm
->
´iv©e_d©a
 = 
adpcm
;

579 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

580 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

581 
pcm
->
t¡amp_ty³
 = 
¦ave
->tstamp_type;

582 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
adpcm
->
¶ug
.
hw_±r
, -1, 0);

583 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
adpcm
->
¶ug
.
­¶_±r
, -1, 0);

584 *
pcmp
 = 
pcm
;

587 
	}
}

633 
	$_¢d_pcm_adpcm_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

634 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

635 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

637 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

638 
”r
;

639 
¢d_pcm_t
 *
¥cm
;

640 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

641 
¢d_pcm_fÜm©_t
 
sfÜm©
;

642 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

643 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

644 cÚ¡ *
id
;

645 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

647 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

649 ià(
	`¡rcmp
(
id
, "slave") == 0) {

650 
¦ave
 = 
n
;

653 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

654  -
EINVAL
;

656 ià(!
¦ave
) {

657 
	`SNDERR
("slave is‚ot defined");

658  -
EINVAL
;

660 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 1,

661 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_MANDATORY
, &
sfÜm©
);

662 ià(
”r
 < 0)

663  
”r
;

664 ià(
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1 &&

665 
sfÜm©
 !ğ
SND_PCM_FORMAT_IMA_ADPCM
) {

666 
	`¢d_cÚfig_d–‘e
(
scÚf
);

667 
	`SNDERR
("invalid slave format");

668  -
EINVAL
;

670 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

671 
	`¢d_cÚfig_d–‘e
(
scÚf
);

672 ià(
”r
 < 0)

673  
”r
;

674 
”r
 = 
	`¢d_pcm_adpcm_İ’
(
pcmp
, 
Çme
, 
sfÜm©
, 
¥cm
, 1);

675 ià(
”r
 < 0)

676 
	`¢d_pcm_şo£
(
¥cm
);

677  
”r
;

678 
	}
}

679 #iâdeà
DOC_HIDDEN


680 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_adpcm_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_alaw.c

29 
	~"pcm_loÿl.h
"

30 
	~"bsw­.h
"

31 
	~"pcm_¶ugš.h
"

33 
	~"¶ugš_İs.h
"

35 #iâdeà
PIC


37 cÚ¡ *
	g_¢d_moduË_pcm_®aw
 = "";

40 #iâdeà
DOC_HIDDEN


42 (*
	t®aw_f
)(cÚ¡ 
	t¢d_pcm_chªÃl_¬—_t
 *
	td¡_¬—s
,

43 
	t¢d_pcm_uäames_t
 
	td¡_off£t
,

44 cÚ¡ 
	t¢d_pcm_chªÃl_¬—_t
 *
	t¤c_¬—s
,

45 
	t¢d_pcm_uäames_t
 
	t¤c_off£t
,

46 
	tchªÃls
, 
	t¢d_pcm_uäames_t
 
	täames
,

47 
	tg‘putidx
);

51 
¢d_pcm_¶ugš_t
 
¶ug
;

52 
g‘put_idx
;

53 
®aw_f
 
func
;

54 
¢d_pcm_fÜm©_t
 
sfÜm©
;

55 } 
	t¢d_pcm_®aw_t
;

59 
šlše
 
	$v®_£g
(
v®
)

61 
r
 = 1;

62 
v®
 >>= 8;

63 ià(
v®
 & 0xf0) {

64 
v®
 >>= 4;

65 
r
 += 4;

67 ià(
v®
 & 0x0c) {

68 
v®
 >>= 2;

69 
r
 += 2;

71 ià(
v®
 & 0x02)

72 
r
 += 1;

73  
r
;

74 
	}
}

96 
	$s16_to_®aw
(
pcm_v®
)

98 
mask
;

99 
£g
;

100 
av®
;

102 ià(
pcm_v®
 >= 0) {

103 
mask
 = 0xD5;

105 
mask
 = 0x55;

106 
pcm_v®
 = -pcm_val;

107 ià(
pcm_v®
 > 0x7fff)

108 
pcm_v®
 = 0x7fff;

111 ià(
pcm_v®
 < 256)

112 
av®
 = 
pcm_v®
 >> 4;

115 
£g
 = 
	`v®_£g
(
pcm_v®
);

116 
av®
 = (
£g
 << 4è| ((
pcm_v®
 >> (seg + 3)) & 0x0f);

118  
av®
 ^ 
mask
;

119 
	}
}

125 
	$®aw_to_s16
(
a_v®
)

127 
t
;

128 
£g
;

130 
a_v®
 ^= 0x55;

131 
t
 = 
a_v®
 & 0x7f;

132 ià(
t
 < 16)

133 
t
 = (t << 4) + 8;

135 
£g
 = (
t
 >> 4) & 0x07;

136 
t
 = ((t & 0x0f) << 4) + 0x108;

137 
t
 <<ğ
£g
 -1;

139  ((
a_v®
 & 0x80è? 
t
 : -t);

140 
	}
}

142 #iâdeà
DOC_HIDDEN


144 
	$¢d_pcm_®aw_decode
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

145 
¢d_pcm_uäames_t
 
d¡_off£t
,

146 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

147 
¢d_pcm_uäames_t
 
¤c_off£t
,

148 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

149 
putidx
)

151 
	#PUT16_LABELS


	)

152 
	~"¶ugš_İs.h
"

153 #undeà
PUT16_LABELS


154 *
put
 = 
put16_Ïb–s
[
putidx
];

155 
chªÃl
;

156 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++channel) {

157 cÚ¡ *
¤c
;

158 *
d¡
;

159 
¤c_¡•
, 
d¡_¡•
;

160 
¢d_pcm_uäames_t
 
äames1
;

161 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

162 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

163 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

164 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

165 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
);

166 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
);

167 
äames1
 = 
äames
;

168 
äames1
-- > 0) {

169 
št16_t
 
§m¶e
 = 
	`®aw_to_s16
(*
¤c
);

170 *
put
;

171 
	#PUT16_END
 
aá”


	)

172 
	~"¶ugš_İs.h
"

173 #undeà
PUT16_END


174 
aá”
:

175 
¤c
 +ğ
¤c_¡•
;

176 
d¡
 +ğ
d¡_¡•
;

179 
	}
}

181 
	$¢d_pcm_®aw_’code
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

182 
¢d_pcm_uäames_t
 
d¡_off£t
,

183 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

184 
¢d_pcm_uäames_t
 
¤c_off£t
,

185 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

186 
g‘idx
)

188 
	#GET16_LABELS


	)

189 
	~"¶ugš_İs.h
"

190 #undeà
GET16_LABELS


191 *
g‘
 = 
g‘16_Ïb–s
[
g‘idx
];

192 
chªÃl
;

193 
št16_t
 
§m¶e
 = 0;

194 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++channel) {

195 cÚ¡ *
¤c
;

196 *
d¡
;

197 
¤c_¡•
, 
d¡_¡•
;

198 
¢d_pcm_uäames_t
 
äames1
;

199 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

200 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

201 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

202 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

203 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
);

204 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
);

205 
äames1
 = 
äames
;

206 
äames1
-- > 0) {

207 *
g‘
;

208 
	#GET16_END
 
aá”


	)

209 
	~"¶ugš_İs.h
"

210 #undeà
GET16_END


211 
aá”
:

212 *
d¡
 = 
	`s16_to_®aw
(
§m¶e
);

213 
¤c
 +ğ
¤c_¡•
;

214 
d¡
 +ğ
d¡_¡•
;

217 
	}
}

221 
	$¢d_pcm_®aw_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

223 
¢d_pcm_®aw_t
 *
®aw
 = 
pcm
->
´iv©e_d©a
;

224 
”r
;

225 
¢d_pcm_acûss_mask_t
 
acûss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

226 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

227 &
acûss_mask
);

228 ià(
”r
 < 0)

229  
”r
;

230 ià(
®aw
->
sfÜm©
 =ğ
SND_PCM_FORMAT_A_LAW
) {

231 
¢d_pcm_fÜm©_mask_t
 
fÜm©_mask
 = { 
SND_PCM_FMTBIT_LINEAR
 };

232 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
,

233 &
fÜm©_mask
);

235 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
·¿ms
,

236 
SND_PCM_FORMAT_A_LAW
);

238 ià(
”r
 < 0)

239  
”r
;

240 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
·¿ms
, 
SND_PCM_SUBFORMAT_STD
);

241 ià(
”r
 < 0)

242  
”r
;

243 
·¿ms
->
šfo
 &ğ~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

245 
	}
}

247 
	$¢d_pcm_®aw_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

249 
¢d_pcm_®aw_t
 *
®aw
 = 
pcm
->
´iv©e_d©a
;

250 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

251 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

252 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

253 &
§cûss_mask
);

254 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
¥¬ams
, 
®aw
->
sfÜm©
);

255 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¥¬ams
, 
SND_PCM_SUBFORMAT_STD
);

257 
	}
}

259 
	$¢d_pcm_®aw_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

260 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

262 
”r
;

263 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

264 
SND_PCM_HW_PARBIT_RATE
 |

265 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

266 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

267 
SND_PCM_HW_PARBIT_PERIODS
 |

268 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

269 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

270 
SND_PCM_HW_PARBIT_TICK_TIME
);

271 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

272 ià(
”r
 < 0)

273  
”r
;

275 
	}
}

277 
	$¢d_pcm_®aw_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

278 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

280 
”r
;

281 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

282 
SND_PCM_HW_PARBIT_RATE
 |

283 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

284 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

285 
SND_PCM_HW_PARBIT_PERIODS
 |

286 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

287 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

288 
SND_PCM_HW_PARBIT_TICK_TIME
);

289 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

290 ià(
”r
 < 0)

291  
”r
;

293 
	}
}

295 
	$¢d_pcm_®aw_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

297  
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

298 
¢d_pcm_®aw_hw_»fše_ı»·»
,

299 
¢d_pcm_®aw_hw_»fše_cchªge
,

300 
¢d_pcm_®aw_hw_»fše_¥»·»
,

301 
¢d_pcm_®aw_hw_»fše_schªge
,

302 
¢d_pcm_g’”ic_hw_»fše
);

303 
	}
}

305 
	$¢d_pcm_®aw_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 * 
·¿ms
)

307 
¢d_pcm_®aw_t
 *
®aw
 = 
pcm
->
´iv©e_d©a
;

308 
¢d_pcm_fÜm©_t
 
fÜm©
;

309 
”r
 = 
	`¢d_pcm_hw_·¿ms_¦ave
(
pcm
, 
·¿ms
,

310 
¢d_pcm_®aw_hw_»fše_cchªge
,

311 
¢d_pcm_®aw_hw_»fše_¥»·»
,

312 
¢d_pcm_®aw_hw_»fše_schªge
,

313 
¢d_pcm_g’”ic_hw_·¿ms
);

314 ià(
”r
 < 0)

315  
”r
;

317 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(
·¿ms
, &
fÜm©
);

318 ià(
”r
 < 0)

319  
”r
;

321 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

322 ià(
®aw
->
sfÜm©
 =ğ
SND_PCM_FORMAT_A_LAW
) {

323 
®aw
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_g‘_šdex
(
fÜm©
, 
SND_PCM_FORMAT_S16
);

324 
®aw
->
func
 = 
¢d_pcm_®aw_’code
;

326 
®aw
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_put_šdex
(
SND_PCM_FORMAT_S16
,‡Ïw->
sfÜm©
);

327 
®aw
->
func
 = 
¢d_pcm_®aw_decode
;

330 ià(
®aw
->
sfÜm©
 =ğ
SND_PCM_FORMAT_A_LAW
) {

331 
®aw
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_put_šdex
(
SND_PCM_FORMAT_S16
, 
fÜm©
);

332 
®aw
->
func
 = 
¢d_pcm_®aw_decode
;

334 
®aw
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_g‘_šdex
×Ïw->
sfÜm©
, 
SND_PCM_FORMAT_S16
);

335 
®aw
->
func
 = 
¢d_pcm_®aw_’code
;

339 
	}
}

341 
¢d_pcm_uäames_t


342 
	$¢d_pcm_®aw_wr™e_¬—s
(
¢d_pcm_t
 *
pcm
,

343 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

344 
¢d_pcm_uäames_t
 
off£t
,

345 
¢d_pcm_uäames_t
 
size
,

346 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

347 
¢d_pcm_uäames_t
 
¦ave_off£t
,

348 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

350 
¢d_pcm_®aw_t
 *
®aw
 = 
pcm
->
´iv©e_d©a
;

351 ià(
size
 > *
¦ave_siz•
)

352 
size
 = *
¦ave_siz•
;

353 
®aw
->
	`func
(
¦ave_¬—s
, 
¦ave_off£t
,

354 
¬—s
, 
off£t
,

355 
pcm
->
chªÃls
, 
size
,

356 
®aw
->
g‘put_idx
);

357 *
¦ave_siz•
 = 
size
;

358  
size
;

359 
	}
}

361 
¢d_pcm_uäames_t


362 
	$¢d_pcm_®aw_»ad_¬—s
(
¢d_pcm_t
 *
pcm
,

363 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

364 
¢d_pcm_uäames_t
 
off£t
,

365 
¢d_pcm_uäames_t
 
size
,

366 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

367 
¢d_pcm_uäames_t
 
¦ave_off£t
,

368 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

370 
¢d_pcm_®aw_t
 *
®aw
 = 
pcm
->
´iv©e_d©a
;

371 ià(
size
 > *
¦ave_siz•
)

372 
size
 = *
¦ave_siz•
;

373 
®aw
->
	`func
(
¬—s
, 
off£t
,

374 
¦ave_¬—s
, 
¦ave_off£t
,

375 
pcm
->
chªÃls
, 
size
,

376 
®aw
->
g‘put_idx
);

377 *
¦ave_siz•
 = 
size
;

378  
size
;

379 
	}
}

381 
	$¢d_pcm_®aw_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

383 
¢d_pcm_®aw_t
 *
®aw
 = 
pcm
->
´iv©e_d©a
;

384 
	`¢d_ouut_´štf
(
out
, "A-Law conversion PCM (%s)\n",

385 
	`¢d_pcm_fÜm©_Çme
(
®aw
->
sfÜm©
));

386 ià(
pcm
->
£tup
) {

387 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

388 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

390 
	`¢d_ouut_´štf
(
out
, "Slave: ");

391 
	`¢d_pcm_dump
(
®aw
->
¶ug
.
g’
.
¦ave
, 
out
);

392 
	}
}

394 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_®aw_İs
 = {

395 .
şo£
 = 
¢d_pcm_g’”ic_şo£
,

396 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

397 .
	ghw_»fše
 = 
¢d_pcm_®aw_hw_»fše
,

398 .
	ghw_·¿ms
 = 
¢d_pcm_®aw_hw_·¿ms
,

399 .
	ghw_ä“
 = 
¢d_pcm_g’”ic_hw_ä“
,

400 .
	gsw_·¿ms
 = 
¢d_pcm_g’”ic_sw_·¿ms
,

401 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

402 .
	gdump
 = 
¢d_pcm_®aw_dump
,

403 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

404 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

405 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

406 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

407 .
	gqu”y_chm­s
 = 
¢d_pcm_g’”ic_qu”y_chm­s
,

408 .
	gg‘_chm­
 = 
¢d_pcm_g’”ic_g‘_chm­
,

409 .
	g£t_chm­
 = 
¢d_pcm_g’”ic_£t_chm­
,

424 
	$¢d_pcm_®aw_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
, 
¢d_pcm_fÜm©_t
 
sfÜm©
, snd_pcm_ˆ*
¦ave
, 
şo£_¦ave
)

426 
¢d_pcm_t
 *
pcm
;

427 
¢d_pcm_®aw_t
 *
®aw
;

428 
”r
;

429 
	`as£¹
(
pcmp
 && 
¦ave
);

430 ià(
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1 &&

431 
sfÜm©
 !ğ
SND_PCM_FORMAT_A_LAW
)

432  -
EINVAL
;

433 
®aw
 = 
	`ÿÎoc
(1, (
¢d_pcm_®aw_t
));

434 ià(!
®aw
) {

435  -
ENOMEM
;

437 
	`¢d_pcm_¶ugš_š™
(&
®aw
->
¶ug
);

438 
®aw
->
sfÜm©
 = sformat;

439 
®aw
->
¶ug
.
»ad
 = 
¢d_pcm_®aw_»ad_¬—s
;

440 
®aw
->
¶ug
.
wr™e
 = 
¢d_pcm_®aw_wr™e_¬—s
;

441 
®aw
->
¶ug
.
undo_»ad
 = 
¢d_pcm_¶ugš_undo_»ad_g’”ic
;

442 
®aw
->
¶ug
.
undo_wr™e
 = 
¢d_pcm_¶ugš_undo_wr™e_g’”ic
;

443 
®aw
->
¶ug
.
g’
.
¦ave
 = slave;

444 
®aw
->
¶ug
.
g’
.
şo£_¦ave
 = close_slave;

446 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_ALAW
, 
Çme
, 
¦ave
->
¡»am
, sÏve->
mode
);

447 ià(
”r
 < 0) {

448 
	`ä“
(
®aw
);

449  
”r
;

451 
pcm
->
İs
 = &
¢d_pcm_®aw_İs
;

452 
pcm
->
ç¡_İs
 = &
¢d_pcm_¶ugš_ç¡_İs
;

453 
pcm
->
´iv©e_d©a
 = 
®aw
;

454 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

455 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

456 
pcm
->
t¡amp_ty³
 = 
¦ave
->tstamp_type;

457 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
®aw
->
¶ug
.
hw_±r
, -1, 0);

458 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
®aw
->
¶ug
.
­¶_±r
, -1, 0);

459 *
pcmp
 = 
pcm
;

462 
	}
}

508 
	$_¢d_pcm_®aw_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

509 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

510 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

512 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

513 
”r
;

514 
¢d_pcm_t
 *
¥cm
;

515 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

516 
¢d_pcm_fÜm©_t
 
sfÜm©
;

517 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

518 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

519 cÚ¡ *
id
;

520 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

522 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

524 ià(
	`¡rcmp
(
id
, "slave") == 0) {

525 
¦ave
 = 
n
;

528 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

529  -
EINVAL
;

531 ià(!
¦ave
) {

532 
	`SNDERR
("slave is‚ot defined");

533  -
EINVAL
;

535 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 1,

536 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_MANDATORY
, &
sfÜm©
);

537 ià(
”r
 < 0)

538  
”r
;

539 ià(
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1 &&

540 
sfÜm©
 !ğ
SND_PCM_FORMAT_A_LAW
) {

541 
	`¢d_cÚfig_d–‘e
(
scÚf
);

542 
	`SNDERR
("invalid slave format");

543  -
EINVAL
;

545 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

546 
	`¢d_cÚfig_d–‘e
(
scÚf
);

547 ià(
”r
 < 0)

548  
”r
;

549 
”r
 = 
	`¢d_pcm_®aw_İ’
(
pcmp
, 
Çme
, 
sfÜm©
, 
¥cm
, 1);

550 ià(
”r
 < 0)

551 
	`¢d_pcm_şo£
(
¥cm
);

552  
”r
;

553 
	}
}

554 #iâdeà
DOC_HIDDEN


555 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_®aw_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_asym.c

9 
	~"pcm_loÿl.h
"

11 #iâdeà
PIC


13 cÚ¡ *
	g_¢d_moduË_pcm_asym
 = "";

77 
	$_¢d_pcm_asym_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
 
ATTRIBUTE_UNUSED
,

78 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

79 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

81 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

82 
”r
;

83 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

84 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

85 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

86 cÚ¡ *
id
;

87 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

89 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

91 ià(
	`¡rcmp
(
id
, "playback") == 0) {

92 ià(
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

93 
¦ave
 = 
n
;

96 ià(
	`¡rcmp
(
id
, "capture") == 0) {

97 ià(
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
)

98 
¦ave
 = 
n
;

101 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

102  -
EINVAL
;

104 ià(! 
¦ave
) {

105 
	`SNDERR
("%s slave is‚ot defined",

106 
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
 ? "playback" : "capture");

107  -
EINVAL
;

109 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 0);

110 ià(
”r
 < 0)

111  
”r
;

112 
”r
 = 
	`¢d_pcm_İ’_Çmed_¦ave
(
pcmp
, 
Çme
, 
roÙ
, 
scÚf
, 
¡»am
,

113 
mode
, 
cÚf
);

114 
	`¢d_cÚfig_d–‘e
(
scÚf
);

115  
”r
;

116 
	}
}

117 #iâdeà
DOC_HIDDEN


118 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_asym_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_copy.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_¶ugš.h
"

31 
	~"bsw­.h
"

33 #iâdeà
PIC


35 cÚ¡ *
	g_¢d_moduË_pcm_cİy
 = "";

38 #iâdeà
DOC_HIDDEN


41 
¢d_pcm_¶ugš_t
 
	m¶ug
;

42 } 
	t¢d_pcm_cİy_t
;

45 
	$¢d_pcm_cİy_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

47 
”r
;

48 
¢d_pcm_acûss_mask_t
 
acûss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

49 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

50 &
acûss_mask
);

51 ià(
”r
 < 0)

52  
”r
;

53 
·¿ms
->
šfo
 &ğ~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

55 
	}
}

57 
	$¢d_pcm_cİy_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

59 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

60 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

61 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

62 &
§cûss_mask
);

64 
	}
}

66 
	$¢d_pcm_cİy_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

67 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

69 
”r
;

70 
lšks
 = ~
SND_PCM_HW_PARBIT_ACCESS
;

71 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

72 ià(
”r
 < 0)

73  
”r
;

75 
	}
}

77 
	$¢d_pcm_cİy_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

78 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

80 
”r
;

81 
lšks
 = ~
SND_PCM_HW_PARBIT_ACCESS
;

82 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

83 ià(
”r
 < 0)

84  
”r
;

86 
	}
}

88 
	$¢d_pcm_cİy_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

90  
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

91 
¢d_pcm_cİy_hw_»fše_ı»·»
,

92 
¢d_pcm_cİy_hw_»fše_cchªge
,

93 
¢d_pcm_cİy_hw_»fše_¥»·»
,

94 
¢d_pcm_cİy_hw_»fše_schªge
,

95 
¢d_pcm_g’”ic_hw_»fše
);

96 
	}
}

98 
	$¢d_pcm_cİy_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

100  
	`¢d_pcm_hw_·¿ms_¦ave
(
pcm
, 
·¿ms
,

101 
¢d_pcm_cİy_hw_»fše_cchªge
,

102 
¢d_pcm_cİy_hw_»fše_¥»·»
,

103 
¢d_pcm_cİy_hw_»fše_schªge
,

104 
¢d_pcm_g’”ic_hw_·¿ms
);

105 
	}
}

107 
¢d_pcm_uäames_t


108 
	$¢d_pcm_cİy_wr™e_¬—s
(
¢d_pcm_t
 *
pcm
,

109 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

110 
¢d_pcm_uäames_t
 
off£t
,

111 
¢d_pcm_uäames_t
 
size
,

112 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

113 
¢d_pcm_uäames_t
 
¦ave_off£t
,

114 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

116 ià(
size
 > *
¦ave_siz•
)

117 
size
 = *
¦ave_siz•
;

118 
	`¢d_pcm_¬—s_cİy
(
¦ave_¬—s
, 
¦ave_off£t
,

119 
¬—s
, 
off£t
,

120 
pcm
->
chªÃls
, 
size
,…cm->
fÜm©
);

121 *
¦ave_siz•
 = 
size
;

122  
size
;

123 
	}
}

125 
¢d_pcm_uäames_t


126 
	$¢d_pcm_cİy_»ad_¬—s
(
¢d_pcm_t
 *
pcm
,

127 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

128 
¢d_pcm_uäames_t
 
off£t
,

129 
¢d_pcm_uäames_t
 
size
,

130 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

131 
¢d_pcm_uäames_t
 
¦ave_off£t
,

132 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

134 ià(
size
 > *
¦ave_siz•
)

135 
size
 = *
¦ave_siz•
;

136 
	`¢d_pcm_¬—s_cİy
(
¬—s
, 
off£t
,

137 
¦ave_¬—s
, 
¦ave_off£t
,

138 
pcm
->
chªÃls
, 
size
,…cm->
fÜm©
);

139 *
¦ave_siz•
 = 
size
;

140  
size
;

141 
	}
}

143 
	$¢d_pcm_cİy_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

145 
¢d_pcm_cİy_t
 *
cİy
 = 
pcm
->
´iv©e_d©a
;

146 
	`¢d_ouut_´štf
(
out
, "Copy conversion PCM\n");

147 ià(
pcm
->
£tup
) {

148 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

149 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

151 
	`¢d_ouut_´štf
(
out
, "Slave: ");

152 
	`¢d_pcm_dump
(
cİy
->
¶ug
.
g’
.
¦ave
, 
out
);

153 
	}
}

155 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_cİy_İs
 = {

156 .
şo£
 = 
¢d_pcm_g’”ic_şo£
,

157 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

158 .
	ghw_»fše
 = 
¢d_pcm_cİy_hw_»fše
,

159 .
	ghw_·¿ms
 = 
¢d_pcm_cİy_hw_·¿ms
,

160 .
	ghw_ä“
 = 
¢d_pcm_g’”ic_hw_ä“
,

161 .
	gsw_·¿ms
 = 
¢d_pcm_g’”ic_sw_·¿ms
,

162 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

163 .
	gdump
 = 
¢d_pcm_cİy_dump
,

164 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

165 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

166 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

167 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

168 .
	gqu”y_chm­s
 = 
¢d_pcm_g’”ic_qu”y_chm­s
,

169 .
	gg‘_chm­
 = 
¢d_pcm_g’”ic_g‘_chm­
,

170 .
	g£t_chm­
 = 
¢d_pcm_g’”ic_£t_chm­
,

184 
	$¢d_pcm_cİy_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
, snd_pcm_ˆ*
¦ave
, 
şo£_¦ave
)

186 
¢d_pcm_t
 *
pcm
;

187 
¢d_pcm_cİy_t
 *
cİy
;

188 
”r
;

189 
	`as£¹
(
pcmp
 && 
¦ave
);

190 
cİy
 = 
	`ÿÎoc
(1, (
¢d_pcm_cİy_t
));

191 ià(!
cİy
) {

192  -
ENOMEM
;

194 
	`¢d_pcm_¶ugš_š™
(&
cİy
->
¶ug
);

195 
cİy
->
¶ug
.
»ad
 = 
¢d_pcm_cİy_»ad_¬—s
;

196 
cİy
->
¶ug
.
wr™e
 = 
¢d_pcm_cİy_wr™e_¬—s
;

197 
cİy
->
¶ug
.
undo_»ad
 = 
¢d_pcm_¶ugš_undo_»ad_g’”ic
;

198 
cİy
->
¶ug
.
undo_wr™e
 = 
¢d_pcm_¶ugš_undo_wr™e_g’”ic
;

199 
cİy
->
¶ug
.
g’
.
¦ave
 = slave;

200 
cİy
->
¶ug
.
g’
.
şo£_¦ave
 = close_slave;

202 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_COPY
, 
Çme
, 
¦ave
->
¡»am
, sÏve->
mode
);

203 ià(
”r
 < 0) {

204 
	`ä“
(
cİy
);

205  
”r
;

207 
pcm
->
İs
 = &
¢d_pcm_cİy_İs
;

208 
pcm
->
ç¡_İs
 = &
¢d_pcm_¶ugš_ç¡_İs
;

209 
pcm
->
´iv©e_d©a
 = 
cİy
;

210 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

211 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

212 
pcm
->
t¡amp_ty³
 = 
¦ave
->tstamp_type;

213 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
cİy
->
¶ug
.
hw_±r
, -1, 0);

214 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
cİy
->
¶ug
.
­¶_±r
, -1, 0);

215 *
pcmp
 = 
pcm
;

218 
	}
}

262 
	$_¢d_pcm_cİy_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

263 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

264 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

266 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

267 
”r
;

268 
¢d_pcm_t
 *
¥cm
;

269 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

270 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

271 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

272 cÚ¡ *
id
;

273 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

275 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

277 ià(
	`¡rcmp
(
id
, "slave") == 0) {

278 
¦ave
 = 
n
;

281 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

282  -
EINVAL
;

284 ià(!
¦ave
) {

285 
	`SNDERR
("slave is‚ot defined");

286  -
EINVAL
;

288 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 0);

289 ià(
”r
 < 0)

290  
”r
;

291 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

292 
	`¢d_cÚfig_d–‘e
(
scÚf
);

293 ià(
”r
 < 0)

294  
”r
;

295 
”r
 = 
	`¢d_pcm_cİy_İ’
(
pcmp
, 
Çme
, 
¥cm
, 1);

296 ià(
”r
 < 0)

297 
	`¢d_pcm_şo£
(
¥cm
);

298  
”r
;

299 
	}
}

300 #iâdeà
DOC_HIDDEN


301 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_cİy_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_direct.c

22 
	~"pcm_loÿl.h
"

23 
	~<¡dio.h
>

24 
	~<¡dlib.h
>

25 
	~<¡ddef.h
>

26 
	~<uni¡d.h
>

27 
	~<sigÇl.h
>

28 
	~<¡ršg.h
>

29 
	~<fú.h
>

30 
	~<ùy³.h
>

31 
	~<g½.h
>

32 
	~<sys/ioùl.h
>

33 
	~<sys/mmª.h
>

34 
	~<pŞl.h
>

35 
	~<sys/shm.h
>

36 
	~<sys/£m.h
>

37 
	~<sys/wa™.h
>

38 
	~<sys/sock‘.h
>

39 
	~<sys/¡©.h
>

40 
	~<sys/un.h
>

41 
	~<sys/mmª.h
>

42 
	~"pcm_dœeù.h
"

48 #ià!
defšed
(
__O³nBSD__
è&& !defšed(
__D¿gÚFly__
è&& !defšed(
__ANDROID__
)

49 
	u£mun
 {

50 
	mv®
;

51 
£mid_ds
 *
	mbuf
;

52 *
	m¬¿y
;

53 #ià
defšed
(
__lšux__
)

54 
£mšfo
 *
	m__buf
;

64 
	$¢d_pcm_dœeù_£m­hÜe_ü—‹_Ü_cÚÃù
(
¢d_pcm_dœeù_t
 *
dmix
)

66 
£mun
 
s
;

67 
£mid_ds
 
buf
;

68 
i
;

70 
dmix
->
£mid
 = 
	`£mg‘
(dmix->
c_key
, 
DIRECT_IPC_SEMS
,

71 
IPC_CREAT
 | 
dmix
->
c_³rm
);

72 ià(
dmix
->
£mid
 < 0)

73  -
”ºo
;

74 ià(
dmix
->
c_gid
 < 0)

76 
i
 = 0; i < 
DIRECT_IPC_SEMS
; i++) {

77 
s
.
buf
 = &buf;

78 ià(
	`£mùl
(
dmix
->
£mid
, 
i
, 
IPC_STAT
, 
s
) < 0) {

79 
”r
 = -
”ºo
;

80 
	`¢d_pcm_dœeù_£m­hÜe_disÿrd
(
dmix
);

81  
”r
;

83 
buf
.
£m_³rm
.
gid
 = 
dmix
->
c_gid
;

84 
s
.
buf
 = &buf;

85 
	`£mùl
(
dmix
->
£mid
, 
i
, 
IPC_SET
, 
s
);

88 
	}
}

90 
	$¢d_pcm_dœeù_magic
(
¢d_pcm_dœeù_t
 *
dmix
)

92 ià(!
dmix
->
dœeù_memÜy_acûss
)

93  0xa15ad300 + (
¢d_pcm_dœeù_sh¬e_t
);

95  0xb15ad300 + (
¢d_pcm_dœeù_sh¬e_t
);

96 
	}
}

102 
	$¢d_pcm_dœeù_shm_ü—‹_Ü_cÚÃù
(
¢d_pcm_dœeù_t
 *
dmix
)

104 
shmid_ds
 
buf
;

105 
tmpid
, 
”r
, 
fœ¡_š¡ªû
 = 0;

107 
»Œyg‘
:

108 
dmix
->
shmid
 = 
	`shmg‘
(dmix->
c_key
, (
¢d_pcm_dœeù_sh¬e_t
),

109 
dmix
->
c_³rm
);

110 ià(
dmix
->
shmid
 < 0 && 
”ºo
 =ğ
ENOENT
) {

111 ià((
dmix
->
shmid
 = 
	`shmg‘
(dmix->
c_key
, (
¢d_pcm_dœeù_sh¬e_t
),

112 
IPC_CREAT
 | 
IPC_EXCL
 | 
dmix
->
c_³rm
)) != -1)

113 
fœ¡_š¡ªû
 = 1;

114 ià(
”ºo
 =ğ
EEXIST
)

115 
»Œyg‘
;

117 
”r
 = -
”ºo
;

118 ià(
dmix
->
shmid
 < 0) {

119 ià(
”ºo
 =ğ
EINVAL
)

120 ià((
tmpid
 = 
	`shmg‘
(
dmix
->
c_key
, 0, dmix->
c_³rm
)) != -1)

121 ià(!
	`shmùl
(
tmpid
, 
IPC_STAT
, &
buf
))

122 ià(!
buf
.
shm_Ç‰ch
)

124 ià(!
	`shmùl
(
tmpid
, 
IPC_RMID
, 
NULL
))

125 
»Œyg‘
;

126  
”r
;

128 
dmix
->
shm±r
 = 
	`shm©
(dmix->
shmid
, 0, 0);

129 ià(
dmix
->
shm±r
 == (*) -1) {

130 
”r
 = -
”ºo
;

131 
	`¢d_pcm_dœeù_shm_disÿrd
(
dmix
);

132  
”r
;

134 
	`mlock
(
dmix
->
shm±r
, (
¢d_pcm_dœeù_sh¬e_t
));

135 ià(
	`shmùl
(
dmix
->
shmid
, 
IPC_STAT
, &
buf
) < 0) {

136 
”r
 = -
”ºo
;

137 
	`¢d_pcm_dœeù_shm_disÿrd
(
dmix
);

138  
”r
;

140 ià(
fœ¡_š¡ªû
) {

141 
	`mem£t
(
dmix
->
shm±r
, 0, (
¢d_pcm_dœeù_sh¬e_t
));

142 ià(
dmix
->
c_gid
 >= 0) {

143 
buf
.
shm_³rm
.
gid
 = 
dmix
->
c_gid
;

144 
	`shmùl
(
dmix
->
shmid
, 
IPC_SET
, &
buf
);

146 
dmix
->
shm±r
->
magic
 = 
	`¢d_pcm_dœeù_magic
(dmix);

149 ià(
dmix
->
shm±r
->
magic
 !ğ
	`¢d_pcm_dœeù_magic
(dmix)) {

150 
	`¢d_pcm_dœeù_shm_disÿrd
(
dmix
);

151  -
EINVAL
;

155 
	}
}

164 
	$_¢d_pcm_dœeù_shm_disÿrd
(
¢d_pcm_dœeù_t
 *
dmix
)

166 
shmid_ds
 
buf
;

167 
»t
 = 0;

169 ià(
dmix
->
shmid
 < 0)

170  -
EINVAL
;

171 ià(
dmix
->
shm±r
 !ğ(*è-1 && 
	`shmdt
(dmix->shmptr) < 0)

172  -
”ºo
;

173 
dmix
->
shm±r
 = (*) -1;

174 ià(
	`shmùl
(
dmix
->
shmid
, 
IPC_STAT
, &
buf
) < 0)

175  -
”ºo
;

176 ià(
buf
.
shm_Ç‰ch
 == 0) {

177 ià(
	`shmùl
(
dmix
->
shmid
, 
IPC_RMID
, 
NULL
) < 0)

178  -
”ºo
;

179 
»t
 = 1;

181 
dmix
->
shmid
 = -1;

182  
»t
;

183 
	}
}

186 
	$¢d_pcm_dœeù_shm_disÿrd
(
¢d_pcm_dœeù_t
 *
dmix
)

188  
	`_¢d_pcm_dœeù_shm_disÿrd
(
dmix
);

189 
	}
}

195 
	$g‘_tmp_Çme
(*
f’ame
, 
size_t
 
size
)

197 
timev®
 
tv
;

199 
	`g‘timeofday
(&
tv
, 
NULL
);

200 
	`¢´štf
(
f’ame
, 
size
, 
TMPDIR
 "/®§-dmix-%i-%li-%li", ()
	`g‘pid
(), ()
tv
.
tv_£c
, (év.
tv_u£c
);

201 
f’ame
[
size
-1] = '\0';

203 
	}
}

205 
	$make_loÿl_sock‘
(cÚ¡ *
f’ame
, 
£rv”
, 
mode_t
 
c_³rm
, 
c_gid
)

207 
size_t
 
l
 = 
	`¡¾’
(
f’ame
);

208 
size_t
 
size
 = 
	`off£tof
(
sockaddr_un
, 
sun_·th
è+ 
l
;

209 
sockaddr_un
 *
addr
 = 
	`®loÿ
(
size
);

210 
sock
;

212 
sock
 = 
	`sock‘
(
PF_LOCAL
, 
SOCK_STREAM
, 0);

213 ià(
sock
 < 0) {

214 
»suÉ
 = -
”ºo
;

215 
	`SYSERR
("socket failed");

216  
»suÉ
;

219 ià(
£rv”
)

220 
	`uÆšk
(
f’ame
);

221 
	`mem£t
(
addr
, 0, 
size
);

222 
addr
->
sun_çmy
 = 
AF_LOCAL
;

223 
	`memıy
(
addr
->
sun_·th
, 
f’ame
, 
l
);

225 ià(
£rv”
) {

226 ià(
	`bšd
(
sock
, (
sockaddr
 *è
addr
, 
size
) < 0) {

227 
»suÉ
 = -
”ºo
;

228 
	`SYSERR
("bšd faed: %s", 
f’ame
);

229 
	`şo£
(
sock
);

230  
»suÉ
;

232 ià(
	`chmod
(
f’ame
, 
c_³rm
) < 0) {

233 
»suÉ
 = -
”ºo
;

234 
	`SYSERR
("chmod faed: %s", 
f’ame
);

235 
	`şo£
(
sock
);

236 
	`uÆšk
(
f’ame
);

237  
»suÉ
;

239 ià(
	`chown
(
f’ame
, -1, 
c_gid
) < 0) {

241 
»suÉ
 = -
”ºo
;

242 
	`SYSERR
("chowÀçed: %s", 
f’ame
);

243 
	`şo£
(
sock
);

244 
	`uÆšk
(
f’ame
);

245  
»suÉ
;

250 ià(
	`cÚÃù
(
sock
, (
sockaddr
 *è
addr
, 
size
) < 0) {

251 
»suÉ
 = -
”ºo
;

252 
	`SYSERR
("cÚÃù faed: %s", 
f’ame
);

253 
	`şo£
(
sock
);

254  
»suÉ
;

257  
sock
;

258 
	}
}

261 
	#SERVER_JOB_DEBUG


	)

262 
	#£rv”_´štf
(
fmt
, 
¬gs
...è
	`´štf
(fmt, ##¬gs)

	)

264 #undeà
SERVER_JOB_DEBUG


265 
	#£rv”_´štf
(
fmt
, 
¬gs
...è

	)

268 
¢d_pcm_dœeù_t
 *
	g£rv”_job_dmix
;

270 
	$£rv”_ş—nup
(
¢d_pcm_dœeù_t
 *
dmix
)

272 
	`şo£
(
dmix
->
£rv”_fd
);

273 
	`şo£
(
dmix
->
hw_fd
);

274 ià(
dmix
->
£rv”_ä“
)

275 
dmix
->
	`£rv”_ä“
(dmix);

276 
	`uÆšk
(
dmix
->
shm±r
->
sock‘_Çme
);

277 
	`_¢d_pcm_dœeù_shm_disÿrd
(
dmix
);

278 
	`¢d_pcm_dœeù_£m­hÜe_disÿrd
(
dmix
);

279 
	}
}

281 
	$£rv”_job_sigÇl
(
sig
 
ATTRIBUTE_UNUSED
)

283 
	`¢d_pcm_dœeù_£m­hÜe_down
(
£rv”_job_dmix
, 
DIRECT_IPC_SEM_CLIENT
);

284 
	`£rv”_ş—nup
(
£rv”_job_dmix
);

285 
	`£rv”_´štf
("DIRECT SERVER EXIT - SIGNAL\n");

286 
	`_ex™
(
EXIT_SUCCESS
);

287 
	}
}

292 
	$_¢d_£nd_fd
(
sock
, *
d©a
, 
size_t
 
Ën
, 
fd
)

294 
»t
;

295 
size_t
 
cmsg_Ën
 = 
	`CMSG_LEN
(());

296 
cmsghdr
 *
cmsg
 = 
	`®loÿ
(
cmsg_Ën
);

297 *
fds
 = (*è
	`CMSG_DATA
(
cmsg
);

298 
msghdr
 msghdr;

299 
iovec
 
vec
;

301 
vec
.
iov_ba£
 = (*)&
d©a
;

302 
vec
.
iov_Ën
 = 
Ën
;

304 
cmsg
->
cmsg_Ën
 = cmsg_len;

305 
cmsg
->
cmsg_Ëv–
 = 
SOL_SOCKET
;

306 
cmsg
->
cmsg_ty³
 = 
SCM_RIGHTS
;

307 *
fds
 = 
fd
;

309 
msghdr
.
msg_Çme
 = 
NULL
;

310 
msghdr
.
msg_Çm–’
 = 0;

311 
msghdr
.
msg_iov
 = &
vec
;

312 
msghdr
.
msg_iovËn
 = 1;

313 
msghdr
.
msg_cÚŒŞ
 = 
cmsg
;

314 
msghdr
.
msg_cÚŒŞËn
 = 
cmsg_Ën
;

315 
msghdr
.
msg_æags
 = 0;

317 
»t
 = 
	`£ndmsg
(
sock
, &
msghdr
, 0 );

318 ià(
»t
 < 0)

319  -
”ºo
;

320  
»t
;

321 
	}
}

323 
	$£rv”_job
(
¢d_pcm_dœeù_t
 *
dmix
)

325 
»t
, 
sck
, 
i
;

326 
max
 = 128, 
cu¼’t
 = 0;

327 
pŞlfd
 
pfds
[
max
 + 1];

329 
£rv”_job_dmix
 = 
dmix
;

331 
	`sigÇl
(
SIGHUP
, 
£rv”_job_sigÇl
);

332 
	`sigÇl
(
SIGQUIT
, 
£rv”_job_sigÇl
);

333 
	`sigÇl
(
SIGTERM
, 
£rv”_job_sigÇl
);

334 
	`sigÇl
(
SIGKILL
, 
£rv”_job_sigÇl
);

336 
i
 = 
	`syscÚf
(
_SC_OPEN_MAX
);

337 #ifdeà
SERVER_JOB_DEBUG


338 --
i
 >= 3) {

340 --
i
 >= 0) {

342 ià(
i
 !ğ
dmix
->
£rv”_fd
 && i !ğdmix->
hw_fd
)

343 
	`şo£
(
i
);

347 
	`£tsid
();

349 
pfds
[0].
fd
 = 
dmix
->
£rv”_fd
;

350 
pfds
[0].
ev’ts
 = 
POLLIN
 | 
POLLERR
 | 
POLLHUP
;

352 
	`£rv”_´štf
("DIRECT SERVER STARTED\n");

354 
»t
 = 
	`pŞl
(
pfds
, 
cu¼’t
 + 1, 500);

355 
	`£rv”_´štf
("DIRECT SERVER:…ŞÈ»ˆğ%i,„ev’ts[0] = 0x%x,ƒ¼nØğ%i\n", 
»t
, 
pfds
[0].
»v’ts
, 
”ºo
);

356 ià(
»t
 < 0) {

357 ià(
”ºo
 =ğ
EINTR
)

362 ià(
»t
 =ğ0 || (
pfds
[0].
»v’ts
 & (
POLLERR
 | 
POLLHUP
))) {

363 
shmid_ds
 
buf
;

364 
	`¢d_pcm_dœeù_£m­hÜe_down
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

365 ià(
	`shmùl
(
dmix
->
shmid
, 
IPC_STAT
, &
buf
) < 0) {

366 
	`_¢d_pcm_dœeù_shm_disÿrd
(
dmix
);

367 
	`¢d_pcm_dœeù_£m­hÜe_up
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

370 
	`£rv”_´štf
("DIRECT SERVER:‚©tch = %i\n", ()
buf
.
shm_Ç‰ch
);

371 ià(
buf
.
shm_Ç‰ch
 == 1)

373 
	`¢d_pcm_dœeù_£m­hÜe_up
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

376 ià(
pfds
[0].
»v’ts
 & 
POLLIN
) {

377 
»t
--;

378 
sck
 = 
	`acû±
(
dmix
->
£rv”_fd
, 0, 0);

379 ià(
sck
 >= 0) {

380 
	`£rv”_´štf
("DIRECT SERVER:‚ew cÚÃùiÚ %i\n", 
sck
);

381 ià(
cu¼’t
 =ğ
max
) {

382 
	`şo£
(
sck
);

384 
buf
 = 'A';

385 
pfds
[
cu¼’t
+1].
fd
 = 
sck
;

386 
pfds
[
cu¼’t
+1].
ev’ts
 = 
POLLIN
 | 
POLLERR
 | 
POLLHUP
;

387 
	`_¢d_£nd_fd
(
sck
, &
buf
, 1, 
dmix
->
hw_fd
);

388 
	`£rv”_´štf
("DIRECT SERVER: fd sent ok\n");

389 
cu¼’t
++;

393 
i
 = 0; i < 
cu¼’t
 && 
»t
 > 0; i++) {

394 
pŞlfd
 *
pfd
 = &
pfds
[
i
+1];

395 
cmd
;

396 
	`£rv”_´štf
("ş›Á %˜»v’t ğ0x%x\n", 
pfd
->
fd
,…fd->
»v’ts
);

397 ià(
pfd
->
»v’ts
 & (
POLLERR
 | 
POLLHUP
)) {

398 
»t
--;

399 
	`şo£
(
pfd
->
fd
);

400 
pfd
->
fd
 = -1;

403 ià(!(
pfd
->
»v’ts
 & 
POLLIN
))

405 
»t
--;

406 ià(
	`»ad
(
pfd
->
fd
, &
cmd
, 1) == 1)

407 
cmd
 = 0 ;

409 
i
 = 0; i < 
cu¼’t
; i++) {

410 ià(
pfds
[
i
+1].
fd
 < 0) {

411 ià(
i
 + 1 !ğ
max
)

412 
	`memıy
(&
pfds
[
i
+1], &pfds[i+2], (
pŞlfd
è* (
max
 - i - 1));

413 
cu¼’t
--;

417 
	`£rv”_ş—nup
(
dmix
);

418 
	`£rv”_´štf
("DIRECT SERVER EXIT\n");

419 #ifdeà
SERVER_JOB_DEBUG


420 
	`şo£
(0); close(1); close(2);

422 
	`_ex™
(
EXIT_SUCCESS
);

423 
	}
}

425 
	$¢d_pcm_dœeù_£rv”_ü—‹
(
¢d_pcm_dœeù_t
 *
dmix
)

427 
»t
;

429 
dmix
->
£rv”_fd
 = -1;

431 
»t
 = 
	`g‘_tmp_Çme
(
dmix
->
shm±r
->
sock‘_Çme
, (dmix->shmptr->socket_name));

432 ià(
»t
 < 0)

433  
»t
;

435 
»t
 = 
	`make_loÿl_sock‘
(
dmix
->
shm±r
->
sock‘_Çme
, 1, dmix->
c_³rm
, dmix->
c_gid
);

436 ià(
»t
 < 0)

437  
»t
;

438 
dmix
->
£rv”_fd
 = 
»t
;

440 
»t
 = 
	`li¡’
(
dmix
->
£rv”_fd
, 4);

441 ià(
»t
 < 0) {

442 
	`şo£
(
dmix
->
£rv”_fd
);

443  
»t
;

446 
»t
 = 
	`fÜk
();

447 ià(
»t
 < 0) {

448 
	`şo£
(
dmix
->
£rv”_fd
);

449  
»t
;

450 } ià(
»t
 == 0) {

451 
»t
 = 
	`fÜk
();

452 ià(
»t
 == 0)

453 
	`£rv”_job
(
dmix
);

454 
	`_ex™
(
EXIT_SUCCESS
);

456 
	`wa™pid
(
»t
, 
NULL
, 0);

458 
dmix
->
£rv”_pid
 = 
»t
;

459 
dmix
->
£rv”
 = 1;

461 
	}
}

463 
	$¢d_pcm_dœeù_£rv”_disÿrd
(
¢d_pcm_dœeù_t
 *
dmix
)

465 ià(
dmix
->
£rv”
) {

468 
dmix
->
£rv”_pid
 = (
pid_t
)-1;

470 ià(
dmix
->
£rv”_fd
 > 0) {

471 
	`şo£
(
dmix
->
£rv”_fd
);

472 
dmix
->
£rv”_fd
 = -1;

474 
dmix
->
£rv”
 = 0;

476 
	}
}

482 
	$¢d_pcm_dœeù_ş›Á_cÚÃù
(
¢d_pcm_dœeù_t
 *
dmix
)

484 
»t
;

485 
buf
;

487 
»t
 = 
	`make_loÿl_sock‘
(
dmix
->
shm±r
->
sock‘_Çme
, 0, -1, -1);

488 ià(
»t
 < 0)

489  
»t
;

490 
dmix
->
comm_fd
 = 
»t
;

492 
»t
 = 
	`¢d_»ûive_fd
(
dmix
->
comm_fd
, &
buf
, 1, &dmix->
hw_fd
);

493 ià(
»t
 < 1 || 
buf
 != 'A') {

494 
	`şo£
(
dmix
->
comm_fd
);

495 
dmix
->
comm_fd
 = -1;

496  
»t
;

499 
dmix
->
ş›Á
 = 1;

501 
	}
}

503 
	$¢d_pcm_dœeù_ş›Á_disÿrd
(
¢d_pcm_dœeù_t
 *
dmix
)

505 ià(
dmix
->
ş›Á
) {

506 
	`şo£
(
dmix
->
comm_fd
);

507 
dmix
->
comm_fd
 = -1;

510 
	}
}

516 
	$¢d_pcm_dœeù_nÚblock
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
nÚblock
 ATTRIBUTE_UNUSED)

520 
	}
}

522 
	$¢d_pcm_dœeù_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
)

524 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

525  
	`¢d_tim”_async
(
dmix
->
tim”
, 
sig
, 
pid
);

526 
	}
}

529 
	$¢d_pcm_dœeù_ş—r_tim”_queue
(
¢d_pcm_dœeù_t
 *
dmix
)

531 
chªged
 = 0;

532 ià(
dmix
->
tim”_Ãed_pŞl
) {

533 
	`pŞl
(&
dmix
->
tim”_fd
, 1, 0) > 0) {

534 
chªged
++;

536 ià(
dmix
->
Œ—d
) {

537 
¢d_tim”_Œ—d_t
 
rbuf
[4];

538 
	`¢d_tim”_»ad
(
dmix
->
tim”
, 
rbuf
, (rbuf));

540 
¢d_tim”_»ad_t
 
rbuf
;

541 
	`¢d_tim”_»ad
(
dmix
->
tim”
, &
rbuf
, (rbuf));

545 ià(
dmix
->
Œ—d
) {

546 
¢d_tim”_Œ—d_t
 
rbuf
[4];

547 
Ën
;

548 (
Ën
 = 
	`¢d_tim”_»ad
(
dmix
->
tim”
, 
rbuf
,

549 (
rbuf
))) > 0

550 && (++
chªged
) &&

551 
Ën
 !ğ(
rbuf
[0]))

554 
¢d_tim”_»ad_t
 
rbuf
;

555 
	`¢d_tim”_»ad
(
dmix
->
tim”
, &
rbuf
, (rbuf)) > 0)

556 
chªged
++;

559  
chªged
;

560 
	}
}

562 
	$¢d_pcm_dœeù_tim”_¡İ
(
¢d_pcm_dœeù_t
 *
dmix
)

564 
	`¢d_tim”_¡İ
(
dmix
->
tim”
);

566 
	}
}

568 
	#RECOVERIES_FLAG_SUSPENDED
 (1U << 31)

	)

569 
	#RECOVERIES_MASK
 ((1U << 31è- 1)

	)

578 
	$¢d_pcm_dœeù_¦ave_»cov”
(
¢d_pcm_dœeù_t
 *
dœeù
)

580 
»cov”›s
;

581 
¡©e
;

582 
»t
;

583 
£m”r
;

585 
£m”r
 = 
	`¢d_pcm_dœeù_£m­hÜe_down
(
dœeù
,

586 
DIRECT_IPC_SEM_CLIENT
);

587 ià(
£m”r
 < 0) {

588 
	`SNDERR
("SEMDOWN FAILED w™hƒ¼ %d", 
£m”r
);

589  
£m”r
;

592 
¡©e
 = 
	`¢d_pcm_¡©e
(
dœeù
->
¥cm
);

593 ià(
¡©e
 !ğ
SND_PCM_STATE_XRUN
 && s‹ !ğ
SND_PCM_STATE_SUSPENDED
) {

595 
£m”r
 = 
	`¢d_pcm_dœeù_£m­hÜe_up
(
dœeù
,

596 
DIRECT_IPC_SEM_CLIENT
);

597 ià(
£m”r
 < 0) {

598 
	`SNDERR
("SEMUP FAILED w™hƒ¼ %d", 
£m”r
);

599  
£m”r
;

604 
»cov”›s
 = 
dœeù
->
shm±r
->
s
.recoveries;

605 
»cov”›s
 = (»cov”› + 1è& 
RECOVERIES_MASK
;

606 ià(
¡©e
 =ğ
SND_PCM_STATE_SUSPENDED
)

607 
»cov”›s
 |ğ
RECOVERIES_FLAG_SUSPENDED
;

608 
dœeù
->
shm±r
->
s
.
»cov”›s
 =„ecoveries;

614 ià(
¡©e
 =ğ
SND_PCM_STATE_SUSPENDED
 &&

615 (
dœeù
->
¥cm
->
šfo
 & 
SND_PCM_INFO_RESUME
)) {

616 
	`¢d_pcm_»sume
(
dœeù
->
¥cm
);

617 
	`¢d_pcm_drİ
(
dœeù
->
¥cm
);

618 
	`¢d_pcm_dœeù_tim”_¡İ
(
dœeù
);

619 
	`¢d_pcm_dœeù_ş—r_tim”_queue
(
dœeù
);

622 
»t
 = 
	`¢d_pcm_´•¬e
(
dœeù
->
¥cm
);

623 ià(
»t
 < 0) {

624 
	`SNDERR
("recover: unableo…repare slave");

625 
£m”r
 = 
	`¢d_pcm_dœeù_£m­hÜe_up
(
dœeù
,

626 
DIRECT_IPC_SEM_CLIENT
);

627 ià(
£m”r
 < 0) {

628 
	`SNDERR
("SEMUP FAILED w™hƒ¼ %d", 
£m”r
);

629  
£m”r
;

631  
»t
;

634 ià(
dœeù
->
ty³
 =ğ
SND_PCM_TYPE_DSHARE
) {

635 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
;

636 
d¡_¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
dœeù
->
¥cm
);

637 
	`¢d_pcm_¬—s_s’û
(
d¡_¬—s
, 0, 
dœeù
->
¥cm
->
chªÃls
,

638 
dœeù
->
¥cm
->
bufãr_size
,

639 
dœeù
->
¥cm
->
fÜm©
);

642 
»t
 = 
	`¢d_pcm_¡¬t
(
dœeù
->
¥cm
);

643 ià(
»t
 < 0) {

644 
	`SNDERR
("recover: unableo start slave");

645 
£m”r
 = 
	`¢d_pcm_dœeù_£m­hÜe_up
(
dœeù
,

646 
DIRECT_IPC_SEM_CLIENT
);

647 ià(
£m”r
 < 0) {

648 
	`SNDERR
("SEMUP FAILED w™hƒ¼ %d", 
£m”r
);

649  
£m”r
;

651  
»t
;

653 
£m”r
 = 
	`¢d_pcm_dœeù_£m­hÜe_up
(
dœeù
,

654 
DIRECT_IPC_SEM_CLIENT
);

655 ià(
£m”r
 < 0) {

656 
	`SNDERR
("SEMUP FAILED w™hƒ¼ %d", 
£m”r
);

657  
£m”r
;

660 
	}
}

666 
	$¢d_pcm_dœeù_check_xrun
(
¢d_pcm_dœeù_t
 *
dœeù
, 
¢d_pcm_t
 *
pcm
)

668 
”r
;

670 
	`¢d_pcm_¡©e
(
dœeù
->
¥cm
)) {

671 
SND_PCM_STATE_DISCONNECTED
:

672 
dœeù
->
¡©e
 = 
SNDRV_PCM_STATE_DISCONNECTED
;

673  -
ENODEV
;

674 
SND_PCM_STATE_XRUN
:

675 
SND_PCM_STATE_SUSPENDED
:

676 ià((
”r
 = 
	`¢d_pcm_dœeù_¦ave_»cov”
(
dœeù
)) < 0)

677  
”r
;

683 ià(
dœeù
->
¡©e
 =ğ
SND_PCM_STATE_XRUN
)

684  -
EPIPE
;

685 ià(
dœeù
->
¡©e
 =ğ
SND_PCM_STATE_SUSPENDED
)

686  -
ESTRPIPE
;

687 ià(
dœeù
->
shm±r
->
s
.
»cov”›s
 != direct->recoveries) {

691 
dœeù
->
»cov”›s
 = dœeù->
shm±r
->
s
.recoveries;

692 
pcm
->
ç¡_İs
->
	`drİ
Õcm->
ç¡_İ_¬g
);

694 
	`g‘time¡amp
(&
dœeù
->
Œigg”_t¡amp
, 
pcm
->
t¡amp_ty³
);

699 ià(
dœeù
->
»cov”›s
 & 
RECOVERIES_FLAG_SUSPENDED
) {

700 
dœeù
->
¡©e
 = 
SND_PCM_STATE_SUSPENDED
;

701  -
ESTRPIPE
;

703 
dœeù
->
¡©e
 = 
SND_PCM_STATE_XRUN
;

704  -
EPIPE
;

708 
	}
}

726 
	$¢d_pcm_dœeù_pŞl_desütÜs
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
,

727 
¥aû
)

729 ià(
pcm
->
pŞl_fd
 < 0) {

730 
	`SNDMSG
("poll_fd < 0");

731  -
EIO
;

733 ià(
¥aû
 >ğ1 && 
pfds
) {

734 
pfds
->
fd
 = 
pcm
->
pŞl_fd
;

735 
pfds
->
ev’ts
 = 
pcm
->
pŞl_ev’ts
 | 
POLLERR
 | 
POLLNVAL
;

742 
	`__¢d_pcm_¡©e
(
pcm
)) {

743 
SND_PCM_STATE_XRUN
:

744  -
EPIPE
;

749 
	}
}

751 
	$¢d_pcm_dœeù_pŞl_»v’ts
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

753 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

754 
ev’ts
;

755 
em±y
 = 0;

757 
	`as£¹
(
pfds
 && 
nfds
 =ğ1 && 
»v’ts
);

759 
tim”_chªged
:

760 
ev’ts
 = 
pfds
[0].
»v’ts
;

761 ià(
ev’ts
 & 
POLLIN
) {

762 
¢d_pcm_uäames_t
 
ava
;

763 
	`__¢d_pcm_ava_upd©e
(
pcm
);

764 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

765 
ev’ts
 |ğ
POLLOUT
;

766 
ev’ts
 &ğ~
POLLIN
;

767 
ava
 = 
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
);

769 
ava
 = 
	`¢d_pcm_mm­_ÿ±u»_ava
(
pcm
);

771 
em±y
 = 
ava
 < 
pcm
->
ava_mš
;

774 ià(
	`¢d_pcm_dœeù_check_xrun
(
dmix
, 
pcm
) < 0 ||

775 
	`¢d_pcm_¡©e
(
dmix
->
¥cm
è=ğ
SND_PCM_STATE_SETUP
) {

776 
ev’ts
 |ğ
POLLERR
;

778 ià(
em±y
) {

787 ià(
	`¢d_pcm_dœeù_ş—r_tim”_queue
(
dmix
))

788 
tim”_chªged
;

789 
ev’ts
 &ğ~(
POLLOUT
|
POLLIN
);

791 
	`__¢d_pcm_¡©e
(
pcm
)) {

792 
SND_PCM_STATE_XRUN
:

793 
SND_PCM_STATE_SUSPENDED
:

794 
SND_PCM_STATE_SETUP
:

795 
ev’ts
 |ğ
POLLERR
;

802 *
»v’ts
 = 
ev’ts
;

804 
	}
}

806 
	$¢d_pcm_dœeù_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_šfo_t
 * 
šfo
)

808 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

810 ià(
dmix
->
¥cm
 && !dmix->
shm±r
->
u£_£rv”
)

811  
	`¢d_pcm_šfo
(
dmix
->
¥cm
, 
šfo
);

813 
	`mem£t
(
šfo
, 0, (*info));

814 
šfo
->
¡»am
 = 
pcm
->stream;

815 
šfo
->
ÿrd
 = -1;

817 ià(
pcm
->
Çme
) {

818 
	`¢d_¡¾ıy
((*)
šfo
->
id
, 
pcm
->
Çme
, (info->id));

819 
	`¢d_¡¾ıy
((*)
šfo
->
Çme
, 
pcm
->name, (info->name));

820 
	`¢d_¡¾ıy
((*)
šfo
->
subÇme
, 
pcm
->
Çme
, (info->subname));

822 
šfo
->
subdeviûs_couÁ
 = 1;

824 
	}
}

826 
šlše
 
¢d_mask_t
 *
	$hw_·¿m_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

827 
¢d_pcm_hw_·¿m_t
 
v¬
)

829  &
·¿ms
->
masks
[
v¬
 - 
SND_PCM_HW_PARAM_FIRST_MASK
];

830 
	}
}

832 
šlše
 
¢d_š‹rv®_t
 *
	$hw_·¿m_š‹rv®
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

833 
¢d_pcm_hw_·¿m_t
 
v¬
)

835  &
·¿ms
->
š‹rv®s
[
v¬
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
];

836 
	}
}

838 
	$hw_·¿m_š‹rv®_»fše_Úe
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

839 
¢d_pcm_hw_·¿m_t
 
v¬
,

840 
¢d_š‹rv®_t
 *
¤c
)

842 
¢d_š‹rv®_t
 *
i
;

844 ià(!(
·¿ms
->
rmask
 & (1<<
v¬
)))

846 
i
 = 
	`hw_·¿m_š‹rv®
(
·¿ms
, 
v¬
);

847 ià(
	`¢d_š‹rv®_em±y
(
i
)) {

848 
	`SNDERR
("dsh¬š‹rv® %˜em±y?", ()
v¬
);

849  -
EINVAL
;

851 ià(
	`¢d_š‹rv®_»fše
(
i
, 
¤c
))

852 
·¿ms
->
cmask
 |ğ1<<
v¬
;

854 
	}
}

856 
	$hw_·¿m_š‹rv®_»fše_mšmax
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

857 
¢d_pcm_hw_·¿m_t
 
v¬
,

858 
imš
,

859 
imax
)

861 
¢d_š‹rv®_t
 
t
;

863 
	`mem£t
(&
t
, 0, (t));

864 
	`¢d_š‹rv®_£t_mšmax
(&
t
, 
imš
, 
imax
);

865 
t
.
š‹g”
 = 1;

866  
	`hw_·¿m_š‹rv®_»fše_Úe
(
·¿ms
, 
v¬
, &
t
);

867 
	}
}

870 
	$¢d_š‹rv®_¡•
(
¢d_š‹rv®
 *
i
, 
mš
,

871 
¡•
)

873 
n
;

874 
chªged
 = 0;

875 
n
 = (
i
->
mš
 - mšè% 
¡•
;

876 ià(
n
 !ğ0 || 
i
->
İ’mš
) {

877 
i
->
mš
 +ğ
¡•
 - 
n
;

878 
chªged
 = 1;

880 
n
 = (
i
->
max
 - 
mš
è% 
¡•
;

881 ià(
n
 !ğ0 || 
i
->
İ’max
) {

882 
i
->
max
 -ğ
n
;

883 
chªged
 = 1;

885 ià(
	`¢d_š‹rv®_checkem±y
(
i
)) {

886 
i
->
em±y
 = 1;

887  -
EINVAL
;

889  
chªged
;

890 
	}
}

892 #undeà
REFINE_DEBUG


894 
	$¢d_pcm_dœeù_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

896 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

897 cÚ¡ 
¢d_mask_t
 
acûss
 = { .
b™s
 = {

898 (1<<
SNDRV_PCM_ACCESS_MMAP_INTERLEAVED
) |

899 (1<<
SNDRV_PCM_ACCESS_MMAP_NONINTERLEAVED
) |

900 (1<<
SNDRV_PCM_ACCESS_RW_INTERLEAVED
) |

901 (1<<
SNDRV_PCM_ACCESS_RW_NONINTERLEAVED
),

903 
”r
;

905 #ifdeà
REFINE_DEBUG


906 
¢d_ouut_t
 *
log
;

907 
	`¢d_ouut_¡dio_©ch
(&
log
, 
¡d”r
, 0);

908 
	`¢d_ouut_puts
(
log
, "DMIX REFINE (begin):\n");

909 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
log
);

911 ià(
·¿ms
->
rmask
 & (1<<
SND_PCM_HW_PARAM_ACCESS
)) {

912 ià(
	`¢d_mask_em±y
(
	`hw_·¿m_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
))) {

913 
	`SNDERR
("dshare‡ccess maskƒmpty?");

914  -
EINVAL
;

916 ià(
	`¢d_mask_»fše
(
	`hw_·¿m_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
), &
acûss
))

917 
·¿ms
->
cmask
 |ğ1<<
SND_PCM_HW_PARAM_ACCESS
;

919 ià(
·¿ms
->
rmask
 & (1<<
SND_PCM_HW_PARAM_FORMAT
)) {

920 ià(
	`¢d_mask_em±y
(
	`hw_·¿m_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
))) {

921 
	`SNDERR
("dshare format maskƒmpty?");

922  -
EINVAL
;

924 ià(
	`¢d_mask_»fše_£t
(
	`hw_·¿m_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
),

925 
dsh¬e
->
shm±r
->
hw
.
fÜm©
))

926 
·¿ms
->
cmask
 |ğ1<<
SND_PCM_HW_PARAM_FORMAT
;

929 ià(
·¿ms
->
rmask
 & (1<<
SND_PCM_HW_PARAM_CHANNELS
)) {

930 ià(
	`¢d_š‹rv®_em±y
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
))) {

931 
	`SNDERR
("dshare channels maskƒmpty?");

932  -
EINVAL
;

934 
”r
 = 
	`¢d_š‹rv®_»fše_£t
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
), 
dsh¬e
->
chªÃls
);

935 ià(
”r
 < 0)

936  
”r
;

938 
”r
 = 
	`hw_·¿m_š‹rv®_»fše_Úe
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
,

939 &
dsh¬e
->
shm±r
->
hw
.
¿‹
);

940 ià(
”r
 < 0)

941  
”r
;

943 ià(
dsh¬e
->
max_³riods
 < 0) {

944 
”r
 = 
	`hw_·¿m_š‹rv®_»fše_Úe
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

945 &
dsh¬e
->
shm±r
->
hw
.
³riod_size
);

946 ià(
”r
 < 0)

947  
”r
;

948 
”r
 = 
	`hw_·¿m_š‹rv®_»fše_Úe
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
,

949 &
dsh¬e
->
shm±r
->
hw
.
³riod_time
);

950 ià(
”r
 < 0)

951  
”r
;

952 
”r
 = 
	`hw_·¿m_š‹rv®_»fše_Úe
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

953 &
dsh¬e
->
shm±r
->
hw
.
bufãr_size
);

954 ià(
”r
 < 0)

955  
”r
;

956 
”r
 = 
	`hw_·¿m_š‹rv®_»fše_Úe
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
,

957 &
dsh¬e
->
shm±r
->
hw
.
bufãr_time
);

958 ià(
”r
 < 0)

959  
”r
;

960 } ià(
·¿ms
->
rmask
 & ((1<<
SND_PCM_HW_PARAM_PERIODS
)|

961 (1<<
SND_PCM_HW_PARAM_BUFFER_BYTES
)|

962 (1<<
SND_PCM_HW_PARAM_BUFFER_SIZE
)|

963 (1<<
SND_PCM_HW_PARAM_BUFFER_TIME
)|

964 (1<<
SND_PCM_HW_PARAM_PERIOD_TIME
)|

965 (1<<
SND_PCM_HW_PARAM_PERIOD_SIZE
)|

966 (1<<
SND_PCM_HW_PARAM_PERIOD_BYTES
))) {

967 
¢d_š‹rv®_t
 
³riod_size
 = 
dsh¬e
->
shm±r
->
hw
.period_size;

968 
¢d_š‹rv®_t
 
³riod_time
 = 
dsh¬e
->
shm±r
->
hw
.period_time;

969 
chªged
;

970 
max_³riods
 = 
dsh¬e
->max_periods;

971 ià(
max_³riods
 < 2)

972 
max_³riods
 = 
dsh¬e
->
¦ave_bufãr_size
 / dsh¬e->
¦ave_³riod_size
;

975 
”r
 = 
	`hw_·¿m_š‹rv®_»fše_mšmax
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

976 2 * 
dsh¬e
->
¦ave_³riod_size
, dsh¬e->
¦ave_bufãr_size
);

977 ià(
”r
 < 0)

978  
”r
;

979 ià(
dsh¬e
->
v¬_³riodsize
) {

981 ià(
dsh¬e
->
shm±r
->
hw
.
bufãr_size
.
max
 / 2 > 
³riod_size
.max) {

982 
³riod_size
.
max
 = 
dsh¬e
->
shm±r
->
hw
.
bufãr_size
.max / 2;

983 
³riod_size
.
İ’max
 = 
dsh¬e
->
shm±r
->
hw
.
bufãr_size
.openmax;

985 ià(
dsh¬e
->
shm±r
->
hw
.
bufãr_time
.
max
 / 2 > 
³riod_time
.max) {

986 
³riod_time
.
max
 = 
dsh¬e
->
shm±r
->
hw
.
bufãr_time
.max / 2;

987 
³riod_time
.
İ’max
 = 
dsh¬e
->
shm±r
->
hw
.
bufãr_time
.openmax;

991 
”r
 = 
	`hw_·¿m_š‹rv®_»fše_Úe
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

992 &
³riod_size
);

993 ià(
”r
 < 0)

994  
”r
;

995 
”r
 = 
	`hw_·¿m_š‹rv®_»fše_Úe
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
,

996 &
³riod_time
);

997 ià(
”r
 < 0)

998  
”r
;

1000 
chªged
 = 0;

1001 
”r
 = 
	`hw_·¿m_š‹rv®_»fše_mšmax
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIODS
,

1002 2, 
max_³riods
);

1003 ià(
”r
 < 0)

1004  
”r
;

1005 
chªged
 |ğ
”r
;

1006 
”r
 = 
	`¢d_pcm_hw_»fše_soá
(
pcm
, 
·¿ms
);

1007 ià(
”r
 < 0)

1008  
”r
;

1009 
chªged
 |ğ
”r
;

1010 
”r
 = 
	`¢d_š‹rv®_¡•
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
),

1011 0, 
dsh¬e
->
¦ave_³riod_size
);

1012 ià(
”r
 < 0)

1013  
”r
;

1014 
chªged
 |ğ
”r
;

1015 ià(
”r
)

1016 
·¿ms
->
rmask
 |ğ(1 << 
SND_PCM_HW_PARAM_PERIOD_SIZE
);

1017 } 
chªged
);

1019 
dsh¬e
->
tim”_ticks
 = 
	`hw_·¿m_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
)->
max
 / dsh¬e->
¦ave_³riod_size
;

1020 
·¿ms
->
šfo
 = 
dsh¬e
->
shm±r
->
s
.info;

1021 #ifdeà
REFINE_DEBUG


1022 
	`¢d_ouut_puts
(
log
, "DMIX REFINE (end):\n");

1023 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
log
);

1024 
	`¢d_ouut_şo£
(
log
);

1027 
	}
}

1029 
	$¢d_pcm_dœeù_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 * 
·¿ms
)

1031 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

1033 
·¿ms
->
šfo
 = 
dmix
->
shm±r
->
s
.info;

1034 
·¿ms
->
¿‹_num
 = 
dmix
->
shm±r
->
s
.
¿‹
;

1035 
·¿ms
->
¿‹_d’
 = 1;

1036 
·¿ms
->
fifo_size
 = 0;

1037 
·¿ms
->
msb™s
 = 
dmix
->
shm±r
->
s
.msbits;

1039 
	}
}

1041 
	$¢d_pcm_dœeù_hw_ä“
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1045 
	}
}

1047 
	$¢d_pcm_dœeù_sw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
)

1049 ià(
·¿ms
->
t¡amp_ty³
 !ğ
pcm
->tstamp_type)

1050  -
EINVAL
;

1054 
	}
}

1056 
	$¢d_pcm_dœeù_chªÃl_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_šfo_t
 * 
šfo
)

1058  
	`¢d_pcm_chªÃl_šfo_shm
(
pcm
, 
šfo
, -1);

1059 
	}
}

1061 
	$¢d_pcm_dœeù_mm­
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1064 
	}
}

1066 
	$¢d_pcm_dœeù_munm­
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1069 
	}
}

1071 
¢d_pcm_chm­_qu”y_t
 **
	$¢d_pcm_dœeù_qu”y_chm­s
(
¢d_pcm_t
 *
pcm
)

1073 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

1074 
¢d_pcm_chm­_qu”y_t
 **
sm­s
, **
m­s
;

1075 
i
, 
j
;

1077 ià(
dmix
->
bšdšgs
 =ğ
NULL
)

1078  
	`¢d_pcm_qu”y_chm­s
(
dmix
->
¥cm
);

1080 
m­s
 = 
	`ÿÎoc
(2, (*maps));

1081 ià(!
m­s
)

1082  
NULL
;

1083 
m­s
[0] = 
	`ÿÎoc
(
dmix
->
chªÃls
 + 2, (*));

1084 ià(!
m­s
[0]) {

1085 
	`ä“
(
m­s
);

1086  
NULL
;

1088 
sm­s
 = 
	`¢d_pcm_qu”y_chm­s
(
dmix
->
¥cm
);

1089 ià(
sm­s
 =ğ
NULL
) {

1090 
	`¢d_pcm_ä“_chm­s
(
m­s
);

1091  
NULL
;

1093 
m­s
[0]->
ty³
 = 
SND_CHMAP_TYPE_FIXED
;

1094 
m­s
[0]->
m­
.
chªÃls
 = 
dmix
->channels;

1095 
i
 = 0; i < 
dmix
->
chªÃls
; i++) {

1096 
j
 = 
dmix
->
bšdšgs
[
i
];

1097 ià(
j
 =ğ
UINT_MAX
 || 
sm­s
[0]->
m­
.
chªÃls
 < j)

1099 
m­s
[0]->
m­
.
pos
[
i
] = 
sm­s
[0]->m­.pos[
j
];

1101  
m­s
;

1102 
	}
}

1104 
¢d_pcm_chm­_t
 *
	$¢d_pcm_dœeù_g‘_chm­
(
¢d_pcm_t
 *
pcm
)

1106 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

1107  
	`¢d_pcm_g‘_chm­
(
dmix
->
¥cm
);

1108 
	}
}

1110 
	$¢d_pcm_dœeù_£t_chm­
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chm­_t
 *
m­
)

1112 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

1113  
	`¢d_pcm_£t_chm­
(
dmix
->
¥cm
, 
m­
);

1114 
	}
}

1116 
	$¢d_pcm_dœeù_´•¬e
(
¢d_pcm_t
 *
pcm
)

1118 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

1119 
”r
;

1121 
	`¢d_pcm_¡©e
(
dmix
->
¥cm
)) {

1122 
SND_PCM_STATE_SETUP
:

1123 
SND_PCM_STATE_XRUN
:

1124 
SND_PCM_STATE_SUSPENDED
:

1125 
”r
 = 
	`¢d_pcm_´•¬e
(
dmix
->
¥cm
);

1126 ià(
”r
 < 0)

1127  
”r
;

1128 
	`¢d_pcm_¡¬t
(
dmix
->
¥cm
);

1130 
SND_PCM_STATE_OPEN
:

1131 
SND_PCM_STATE_DISCONNECTED
:

1132  -
EBADFD
;

1136 
	`¢d_pcm_dœeù_check_š‹¾—ve
(
dmix
, 
pcm
);

1137 
dmix
->
¡©e
 = 
SND_PCM_STATE_PREPARED
;

1138 
dmix
->
­¶_±r
 = dmix->
Ï¡_­¶_±r
 = 0;

1139 
dmix
->
hw_±r
 = 0;

1140  
	`¢d_pcm_dœeù_£t_tim”_·¿ms
(
dmix
);

1141 
	}
}

1143 
	$¢d_pcm_dœeù_»sume
(
¢d_pcm_t
 *
pcm
)

1145 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

1146 
”r
;

1148 
”r
 = 
	`¢d_pcm_dœeù_¦ave_»cov”
(
dmix
);

1149  
”r
 < 0 ?ƒ¼ : -
ENOSYS
;

1150 
	}
}

1152 
	#COPY_SLAVE
(
f›ld
è(
dmix
->
shm±r
->
s
.f›ld = 
¥cm
->f›ld)

	)

1155 
	$§ve_¦ave_£‰šg
(
¢d_pcm_dœeù_t
 *
dmix
, 
¢d_pcm_t
 *
¥cm
)

1157 
¥cm
->
šfo
 &ğ~
SND_PCM_INFO_PAUSE
;

1159 
	`COPY_SLAVE
(
acûss
);

1160 
	`COPY_SLAVE
(
fÜm©
);

1161 
	`COPY_SLAVE
(
subfÜm©
);

1162 
	`COPY_SLAVE
(
chªÃls
);

1163 
	`COPY_SLAVE
(
¿‹
);

1164 
	`COPY_SLAVE
(
³riod_size
);

1165 
	`COPY_SLAVE
(
³riod_time
);

1166 
	`COPY_SLAVE
(
³riods
);

1167 
	`COPY_SLAVE
(
t¡amp_mode
);

1168 
	`COPY_SLAVE
(
t¡amp_ty³
);

1169 
	`COPY_SLAVE
(
³riod_¡•
);

1170 
	`COPY_SLAVE
(
ava_mš
);

1171 
	`COPY_SLAVE
(
¡¬t_th»shŞd
);

1172 
	`COPY_SLAVE
(
¡İ_th»shŞd
);

1173 
	`COPY_SLAVE
(
s’û_th»shŞd
);

1174 
	`COPY_SLAVE
(
s’û_size
);

1175 
	`COPY_SLAVE
(
bound¬y
);

1176 
	`COPY_SLAVE
(
šfo
);

1177 
	`COPY_SLAVE
(
msb™s
);

1178 
	`COPY_SLAVE
(
¿‹_num
);

1179 
	`COPY_SLAVE
(
¿‹_d’
);

1180 
	`COPY_SLAVE
(
hw_æags
);

1181 
	`COPY_SLAVE
(
fifo_size
);

1182 
	`COPY_SLAVE
(
bufãr_size
);

1183 
	`COPY_SLAVE
(
bufãr_time
);

1184 
	`COPY_SLAVE
(
§m¶e_b™s
);

1185 
	`COPY_SLAVE
(
äame_b™s
);

1187 
dmix
->
shm±r
->
s
.
šfo
 &ğ~
SND_PCM_INFO_RESUME
;

1188 
	}
}

1190 #undeà
COPY_SLAVE


1197 
	$¢d_pcm_dœeù_š™Ÿlize_¦ave
(
¢d_pcm_dœeù_t
 *
dmix
, 
¢d_pcm_t
 *
¥cm
, 
¦ave_·¿ms
 *
·¿ms
)

1199 
¢d_pcm_hw_·¿ms_t
 
hw_·¿ms
 = {0};

1200 
¢d_pcm_sw_·¿ms_t
 
sw_·¿ms
 = {0};

1201 
»t
, 
bufãr_is_nÙ_š™Ÿlized
;

1202 
¢d_pcm_uäames_t
 
bound¬y
;

1203 
pŞlfd
 
fd
;

1204 
loİs
 = 10;

1206 
__agaš
:

1207 ià(
loİs
-- <= 0) {

1208 
	`SNDERR
("unableo find‡ valid configuration for slave");

1209  -
EINVAL
;

1211 
»t
 = 
	`¢d_pcm_hw_·¿ms_ªy
(
¥cm
, &
hw_·¿ms
);

1212 ià(
»t
 < 0) {

1213 
	`SNDERR
("snd_pcm_hw_params_any failed");

1214  
»t
;

1216 
»t
 = 
	`¢d_pcm_hw_·¿ms_£t_acûss
(
¥cm
, &
hw_·¿ms
,

1217 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

1218 ià(
»t
 < 0) {

1219 
»t
 = 
	`¢d_pcm_hw_·¿ms_£t_acûss
(
¥cm
, &
hw_·¿ms
,

1220 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

1221 ià(
»t
 < 0) {

1222 
	`SNDERR
("slave…lugin does‚ot support mmap interleaved or mmap‚oninterleaved‡ccess");

1223  
»t
;

1226 ià(
·¿ms
->
fÜm©
 =ğ
SND_PCM_FORMAT_UNKNOWN
)

1227 
»t
 = -
EINVAL
;

1229 
»t
 = 
	`¢d_pcm_hw_·¿ms_£t_fÜm©
(
¥cm
, &
hw_·¿ms
,

1230 
·¿ms
->
fÜm©
);

1231 ià(
»t
 < 0) {

1232 cÚ¡ 
¢d_pcm_fÜm©_t
 
dmix_fÜm©s
[] = {

1233 
SND_PCM_FORMAT_S32
,

1234 
SND_PCM_FORMAT_S32
 ^ 
SND_PCM_FORMAT_S32_LE
 ^

1235 
SND_PCM_FORMAT_S32_BE
,

1236 
SND_PCM_FORMAT_S16
,

1237 
SND_PCM_FORMAT_S16
 ^ 
SND_PCM_FORMAT_S16_LE
 ^

1238 
SND_PCM_FORMAT_S16_BE
,

1239 
SND_PCM_FORMAT_S24_LE
,

1240 
SND_PCM_FORMAT_S24_3LE
,

1241 
SND_PCM_FORMAT_U8
,

1243 
¢d_pcm_fÜm©_t
 
fÜm©
;

1244 
i
;

1246 
i
 = 0; i < 
	`ARRAY_SIZE
(
dmix_fÜm©s
); ++i) {

1247 
fÜm©
 = 
dmix_fÜm©s
[
i
];

1248 
»t
 = 
	`¢d_pcm_hw_·¿ms_£t_fÜm©
(
¥cm
, &
hw_·¿ms
,

1249 
fÜm©
);

1250 ià(
»t
 >= 0)

1253 ià(
»t
 < 0 && 
dmix
->
ty³
 !ğ
SND_PCM_TYPE_DMIX
) {

1255 
»t
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_fÜm©_fœ¡
)(
¥cm
,

1256 &
hw_·¿ms
, &
fÜm©
);

1258 ià(
»t
 < 0) {

1259 
	`SNDERR
("requested or‡uto-format is‚ot‡vailable");

1260  
»t
;

1262 
·¿ms
->
fÜm©
 = format;

1264 
»t
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_chªÃls_Ã¬
)(
¥cm
, &
hw_·¿ms
,

1265 (*)&
·¿ms
->
chªÃls
);

1266 ià(
»t
 < 0) {

1267 
	`SNDERR
("requested count of channels is‚ot‡vailable");

1268  
»t
;

1270 
»t
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_¿‹_Ã¬
)(
¥cm
, &
hw_·¿ms
,

1271 (*)&
·¿ms
->
¿‹
, 0);

1272 ià(
»t
 < 0) {

1273 
	`SNDERR
("requested„ate is‚ot‡vailable");

1274  
»t
;

1277 
bufãr_is_nÙ_š™Ÿlized
 = 0;

1278 ià(
·¿ms
->
bufãr_time
 > 0) {

1279 
»t
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ã¬
)(
¥cm
,

1280 &
hw_·¿ms
, (*)&
·¿ms
->
bufãr_time
, 0);

1281 ià(
»t
 < 0) {

1282 
	`SNDERR
("unableo set bufferime");

1283  
»t
;

1285 } ià(
·¿ms
->
bufãr_size
 > 0) {

1286 
»t
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ã¬
)(
¥cm
,

1287 &
hw_·¿ms
, (
¢d_pcm_uäames_t
 *)&
·¿ms
->
bufãr_size
);

1288 ià(
»t
 < 0) {

1289 
	`SNDERR
("unableo set buffer size");

1290  
»t
;

1293 
bufãr_is_nÙ_š™Ÿlized
 = 1;

1296 ià(
·¿ms
->
³riod_time
 > 0) {

1297 
»t
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_time_Ã¬
)(
¥cm
,

1298 &
hw_·¿ms
, (*)&
·¿ms
->
³riod_time
, 0);

1299 ià(
»t
 < 0) {

1300 
	`SNDERR
("unableo set…eriod_time");

1301  
»t
;

1303 } ià(
·¿ms
->
³riod_size
 > 0) {

1304 
»t
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_size_Ã¬
)(
¥cm
,

1305 &
hw_·¿ms
, (
¢d_pcm_uäames_t
 *)&
·¿ms
->
³riod_size
,

1307 ià(
»t
 < 0) {

1308 
	`SNDERR
("unableo set…eriod_size");

1309  
»t
;

1313 ià(
bufãr_is_nÙ_š™Ÿlized
 && 
·¿ms
->
³riods
 > 0) {

1314 
³riods
 = 
·¿ms
->periods;

1315 
»t
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riods_Ã¬
)(
¥cm
,

1316 &
hw_·¿ms
, &
·¿ms
->
³riods
, 0);

1317 ià(
»t
 < 0) {

1318 
	`SNDERR
("unableo set„equested…eriods");

1319  
»t
;

1321 ià(
·¿ms
->
³riods
 == 1) {

1322 
·¿ms
->
³riods
 =…eriods;

1323 ià(
·¿ms
->
³riod_time
 > 0) {

1324 
·¿ms
->
³riod_time
 /= 2;

1325 
__agaš
;

1326 } ià(
·¿ms
->
³riod_size
 > 0) {

1327 
·¿ms
->
³riod_size
 /= 2;

1328 
__agaš
;

1330 
	`SNDERR
("unableo use stream with…eriods == 1");

1331  
»t
;

1335 
»t
 = 
	`¢d_pcm_hw_·¿ms
(
¥cm
, &
hw_·¿ms
);

1336 ià(
»t
 < 0) {

1337 
	`SNDERR
("unableo install hw…arams");

1338  
»t
;

1342 
dmix
->
shm±r
->
hw
.
fÜm©
 =

1343 
	`¢d_mask_v®ue
(
	`hw_·¿m_mask
(&
hw_·¿ms
,

1344 
SND_PCM_HW_PARAM_FORMAT
));

1345 
dmix
->
shm±r
->
hw
.
¿‹
 =

1346 *
	`hw_·¿m_š‹rv®
(&
hw_·¿ms
, 
SND_PCM_HW_PARAM_RATE
);

1347 
dmix
->
shm±r
->
hw
.
bufãr_size
 =

1348 *
	`hw_·¿m_š‹rv®
(&
hw_·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
);

1349 
dmix
->
shm±r
->
hw
.
bufãr_time
 =

1350 *
	`hw_·¿m_š‹rv®
(&
hw_·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
);

1351 
dmix
->
shm±r
->
hw
.
³riod_size
 =

1352 *
	`hw_·¿m_š‹rv®
(&
hw_·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
);

1353 
dmix
->
shm±r
->
hw
.
³riod_time
 =

1354 *
	`hw_·¿m_š‹rv®
(&
hw_·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
);

1355 
dmix
->
shm±r
->
hw
.
³riods
 =

1356 *
	`hw_·¿m_š‹rv®
(&
hw_·¿ms
, 
SND_PCM_HW_PARAM_PERIODS
);

1359 
»t
 = 
	`¢d_pcm_sw_·¿ms_cu¼’t
(
¥cm
, &
sw_·¿ms
);

1360 ià(
»t
 < 0) {

1361 
	`SNDERR
("unableo get current sw_params");

1362  
»t
;

1365 
»t
 = 
	`¢d_pcm_sw_·¿ms_g‘_bound¬y
(&
sw_·¿ms
, &
bound¬y
);

1366 ià(
»t
 < 0) {

1367 
	`SNDERR
("unableo get boundary");

1368  
»t
;

1370 
»t
 = 
	`¢d_pcm_sw_·¿ms_£t_¡İ_th»shŞd
(
¥cm
, &
sw_·¿ms
, 
bound¬y
);

1371 ià(
»t
 < 0) {

1372 
	`SNDERR
("unableo set stophreshold");

1373  
»t
;

1380 
»t
 = 
	`¢d_pcm_sw_·¿ms_£t_t¡amp_mode
(
¥cm
, &
sw_·¿ms
,

1381 
SND_PCM_TSTAMP_ENABLE
);

1382 ià(
»t
 < 0) {

1383 
	`SNDERR
("unableostamp mode MMAP");

1384  
»t
;

1387 ià(
dmix
->
t¡amp_ty³
 != -1) {

1388 
»t
 = 
	`¢d_pcm_sw_·¿ms_£t_t¡amp_ty³
(
¥cm
, &
sw_·¿ms
,

1389 
dmix
->
t¡amp_ty³
);

1390 ià(
»t
 < 0) {

1391 
	`SNDERR
("unableo setstampype");

1392  
»t
;

1396 ià(
dmix
->
ty³
 !ğ
SND_PCM_TYPE_DMIX
 &&

1397 
dmix
->
ty³
 !ğ
SND_PCM_TYPE_DSHARE
)

1398 
__sk_s’cšg
;

1400 
»t
 = 
	`¢d_pcm_sw_·¿ms_£t_s’û_th»shŞd
(
¥cm
, &
sw_·¿ms
, 0);

1401 ià(
»t
 < 0) {

1402 
	`SNDERR
("unableo set silencehreshold");

1403  
»t
;

1405 
»t
 = 
	`¢d_pcm_sw_·¿ms_£t_s’û_size
(
¥cm
, &
sw_·¿ms
, 
bound¬y
);

1406 ià(
»t
 < 0) {

1407 
	`SNDERR
("unableo set silencehreshold (please upgradeo 0.9.0rc8+ driver)");

1408  
»t
;

1411 
__sk_s’cšg
:

1413 
»t
 = 
	`¢d_pcm_sw_·¿ms
(
¥cm
, &
sw_·¿ms
);

1414 ià(
»t
 < 0) {

1415 
	`SNDERR
("unableo install sw…arams (please upgradeo 0.9.0rc8+ driver)");

1416  
»t
;

1419 ià(
dmix
->
ty³
 =ğ
SND_PCM_TYPE_DSHARE
) {

1420 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
;

1421 
d¡_¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
¥cm
);

1422 
	`¢d_pcm_¬—s_s’û
(
d¡_¬—s
, 0, 
¥cm
->
chªÃls
,

1423 
¥cm
->
bufãr_size
, spcm->
fÜm©
);

1426 
»t
 = 
	`¢d_pcm_¡¬t
(
¥cm
);

1427 ià(
»t
 < 0) {

1428 
	`SNDERR
("unableo start PCM stream");

1429  
»t
;

1432 ià(
	`¢d_pcm_pŞl_desütÜs_couÁ
(
¥cm
) != 1) {

1433 
	`SNDERR
("unableo use hardware…cm with fd morehan one!!!");

1434  
»t
;

1436 
	`¢d_pcm_pŞl_desütÜs
(
¥cm
, &
fd
, 1);

1437 
dmix
->
hw_fd
 = 
fd
.fd;

1439 
	`§ve_¦ave_£‰šg
(
dmix
, 
¥cm
);

1448 
dmix
->
¦ave_bufãr_size
 = 
¥cm
->
bufãr_size
;

1449 
dmix
->
¦ave_³riod_size
 = 
¥cm
->
³riod_size
;

1450 
dmix
->
¦ave_bound¬y
 = 
¥cm
->
bound¬y
;

1452 
¥cm
->
dÚÙ_şo£
 = 1;

1455 
v”
 = 0;

1456 
	`ioùl
(
¥cm
->
pŞl_fd
, 
SNDRV_PCM_IOCTL_PVERSION
, &
v”
);

1457 ià(
v”
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 8))

1458 
dmix
->
shm±r
->
u£_£rv”
 = 1;

1462 
	}
}

1469 
	$¢d_pcm_dœeù_š™Ÿlize_pŞl_fd
(
¢d_pcm_dœeù_t
 *
dmix
)

1471 
»t
;

1472 
¢d_pcm_šfo_t
 
šfo
 = {0};

1473 
Çme
[128];

1474 
ÿ±u»
 = 
dmix
->
ty³
 =ğ
SND_PCM_TYPE_DSNOOP
 ? 1 : 0;

1476 
dmix
->
Œ—d
 = 1;

1477 
dmix
->
tim”_Ãed_pŞl
 = 0;

1478 
dmix
->
tim”_ticks
 = 1;

1479 
»t
 = 
	`¢d_pcm_šfo
(
dmix
->
¥cm
, &
šfo
);

1480 ià(
»t
 < 0) {

1481 
	`SNDERR
("unableo info for slave…cm");

1482  
»t
;

1484 
	`¥rštf
(
Çme
, "hw:CLASS=%i,SCLASS=0,CARD=%i,DEV=%i,SUBDEV=%i",

1485 ()
SND_TIMER_CLASS_PCM
,

1486 
	`¢d_pcm_šfo_g‘_ÿrd
(&
šfo
),

1487 
	`¢d_pcm_šfo_g‘_deviû
(&
šfo
),

1488 
	`¢d_pcm_šfo_g‘_subdeviû
(&
šfo
è* 2 + 
ÿ±u»
);

1489 
»t
 = 
	`¢d_tim”_İ’
(&
dmix
->
tim”
, 
Çme
,

1490 
SND_TIMER_OPEN_NONBLOCK
 | 
SND_TIMER_OPEN_TREAD
);

1491 ià(
»t
 < 0) {

1492 
dmix
->
Œ—d
 = 0;

1493 
»t
 = 
	`¢d_tim”_İ’
(&
dmix
->
tim”
, 
Çme
,

1494 
SND_TIMER_OPEN_NONBLOCK
);

1495 ià(
»t
 < 0) {

1496 
	`SNDERR
("uÇbËØİ’im” '%s'", 
Çme
);

1497  
»t
;

1501 ià(
	`¢d_tim”_pŞl_desütÜs_couÁ
(
dmix
->
tim”
) != 1) {

1502 
	`SNDERR
("uÇbËØu£im” '%s' w™h mÜthª oÃ fd!", 
Çme
);

1503  
»t
;

1505 
	`¢d_tim”_pŞl_desütÜs
(
dmix
->
tim”
, &dmix->
tim”_fd
, 1);

1506 
dmix
->
pŞl_fd
 = dmix->
tim”_fd
.
fd
;

1508 
dmix
->
tim”_ev’ts
 = (1<<
SND_TIMER_EVENT_MSUSPEND
) |

1509 (1<<
SND_TIMER_EVENT_MRESUME
) |

1510 (1<<
SND_TIMER_EVENT_MSTOP
) |

1511 (1<<
SND_TIMER_EVENT_STOP
);

1517 
v”
 = 0;

1518 
	`ioùl
(
dmix
->
pŞl_fd
, 
SNDRV_TIMER_IOCTL_PVERSION
, &
v”
);

1523 ià(
v”
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4))

1524 
dmix
->
tim”_Ãed_pŞl
 = 1;

1529 ià(
v”
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 5)) {

1530 
dmix
->
tim”_ev’ts
 &ğ~((1<<
SND_TIMER_EVENT_MSUSPEND
) |

1531 (1<<
SND_TIMER_EVENT_MRESUME
));

1532 
dmix
->
tim”_ev’ts
 |ğ(1<<
SND_TIMER_EVENT_MPAUSE
) |

1533 (1<<
SND_TIMER_EVENT_MCONTINUE
);

1537 ià(
v”
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 6))

1538 
dmix
->
tim”_ev’ts
 |ğ1<<
SND_TIMER_EVENT_START
;

1541 
	}
}

1543 
¢d_pcm_uäames_t
 
	$»ÿlc_bound¬y_size
(
bsize
, 
¢d_pcm_uäames_t
 
bufãr_size
)

1545 ià(
bsize
 > 
LONG_MAX
) {

1546 
bsize
 = 
bufãr_size
;

1547 
bsize
 * 2 <ğ
LONG_MAX
 - 
bufãr_size
)

1548 
bsize
 *= 2;

1550  (
¢d_pcm_uäames_t
)
bsize
;

1551 
	}
}

1553 
	#COPY_SLAVE
(
f›ld
è(
¥cm
->f›ld = 
dmix
->
shm±r
->
s
.f›ld)

	)

1556 
	$cİy_¦ave_£‰šg
(
¢d_pcm_dœeù_t
 *
dmix
, 
¢d_pcm_t
 *
¥cm
)

1558 
	`COPY_SLAVE
(
acûss
);

1559 
	`COPY_SLAVE
(
fÜm©
);

1560 
	`COPY_SLAVE
(
subfÜm©
);

1561 
	`COPY_SLAVE
(
chªÃls
);

1562 
	`COPY_SLAVE
(
¿‹
);

1563 
	`COPY_SLAVE
(
³riod_size
);

1564 
	`COPY_SLAVE
(
³riod_time
);

1565 
	`COPY_SLAVE
(
³riods
);

1566 
	`COPY_SLAVE
(
t¡amp_mode
);

1567 
	`COPY_SLAVE
(
t¡amp_ty³
);

1568 
	`COPY_SLAVE
(
³riod_¡•
);

1569 
	`COPY_SLAVE
(
ava_mš
);

1570 
	`COPY_SLAVE
(
¡¬t_th»shŞd
);

1571 
	`COPY_SLAVE
(
¡İ_th»shŞd
);

1572 
	`COPY_SLAVE
(
s’û_th»shŞd
);

1573 
	`COPY_SLAVE
(
s’û_size
);

1574 
	`COPY_SLAVE
(
bound¬y
);

1575 
	`COPY_SLAVE
(
šfo
);

1576 
	`COPY_SLAVE
(
msb™s
);

1577 
	`COPY_SLAVE
(
¿‹_num
);

1578 
	`COPY_SLAVE
(
¿‹_d’
);

1579 
	`COPY_SLAVE
(
hw_æags
);

1580 
	`COPY_SLAVE
(
fifo_size
);

1581 
	`COPY_SLAVE
(
bufãr_size
);

1582 
	`COPY_SLAVE
(
bufãr_time
);

1583 
	`COPY_SLAVE
(
§m¶e_b™s
);

1584 
	`COPY_SLAVE
(
äame_b™s
);

1586 
¥cm
->
šfo
 &ğ~
SND_PCM_INFO_PAUSE
;

1587 
¥cm
->
bound¬y
 = 
	`»ÿlc_bound¬y_size
(
dmix
->
shm±r
->
s
.bound¬y, spcm->
bufãr_size
);

1588 
	}
}

1590 #undeà
COPY_SLAVE


1596 
	$¢d_pcm_dœeù_İ’_£cÚd¬y_ş›Á
(
¢d_pcm_t
 **
¥cmp
, 
¢d_pcm_dœeù_t
 *
dmix
, cÚ¡ *
ş›Á_Çme
)

1598 
»t
;

1599 
¢d_pcm_t
 *
¥cm
;

1601 
»t
 = 
	`¢d_pcm_hw_İ’_fd
(
¥cmp
, 
ş›Á_Çme
, 
dmix
->
hw_fd
, 0);

1602 ià(
»t
 < 0) {

1603 
	`SNDERR
("unableo open hardware");

1604  
»t
;

1607 
¥cm
 = *
¥cmp
;

1608 
¥cm
->
dÚÙ_şo£
 = 1;

1609 
¥cm
->
£tup
 = 1;

1611 
	`cİy_¦ave_£‰šg
(
dmix
, 
¥cm
);

1614 
dmix
->
¦ave_bufãr_size
 = 
¥cm
->
bufãr_size
;

1615 
dmix
->
¦ave_³riod_size
 = dmix->
shm±r
->
s
.
³riod_size
;

1616 
dmix
->
¦ave_bound¬y
 = 
¥cm
->
bound¬y
;

1617 
dmix
->
»cov”›s
 = dmix->
shm±r
->
s
.recoveries;

1619 
»t
 = 
	`¢d_pcm_mm­
(
¥cm
);

1620 ià(
»t
 < 0) {

1621 
	`SNDERR
("unableo mmap channels");

1622  
»t
;

1625 
	}
}

1630 
	$¢d_pcm_dœeù_š™Ÿlize_£cÚd¬y_¦ave
(
¢d_pcm_dœeù_t
 *
dmix
,

1631 
¢d_pcm_t
 *
¥cm
,

1632 
¦ave_·¿ms
 *
·¿ms
 
ATTRIBUTE_UNUSED
)

1634 
»t
;

1636 
¥cm
->
dÚÙ_şo£
 = 1;

1637 
¥cm
->
£tup
 = 1;

1639 
	`cİy_¦ave_£‰šg
(
dmix
, 
¥cm
);

1642 
dmix
->
¦ave_bufãr_size
 = 
¥cm
->
bufãr_size
;

1643 
dmix
->
¦ave_³riod_size
 = dmix->
shm±r
->
s
.
³riod_size
;

1644 
dmix
->
¦ave_bound¬y
 = 
¥cm
->
bound¬y
;

1646 
»t
 = 
	`¢d_pcm_mm­
(
¥cm
);

1647 ià(
»t
 < 0) {

1648 
	`SNDERR
("unableo mmap channels");

1649  
»t
;

1652 
	}
}

1654 
	$¢d_pcm_dœeù_£t_tim”_·¿ms
(
¢d_pcm_dœeù_t
 *
dmix
)

1656 
¢d_tim”_·¿ms_t
 
·¿ms
 = {0};

1657 
f‹r
;

1658 
»t
;

1660 
	`¢d_tim”_·¿ms_£t_auto_¡¬t
(&
·¿ms
, 1);

1661 ià(
dmix
->
ty³
 !ğ
SND_PCM_TYPE_DSNOOP
)

1662 
	`¢d_tim”_·¿ms_£t_—¾y_ev’t
(&
·¿ms
, 1);

1663 
	`¢d_tim”_·¿ms_£t_ticks
(&
·¿ms
, 
dmix
->
tim”_ticks
);

1664 ià(
dmix
->
Œ—d
) {

1665 
f‹r
 = (1<<
SND_TIMER_EVENT_TICK
) |

1666 
dmix
->
tim”_ev’ts
;

1667 
	`INTERNAL
(
¢d_tim”_·¿ms_£t_f‹r
)(&
·¿ms
, 
f‹r
);

1669 
»t
 = 
	`¢d_tim”_·¿ms
(
dmix
->
tim”
, &
·¿ms
);

1670 ià(
»t
 < 0) {

1671 
	`SNDERR
("unableo setimer…arameters");

1672  
»t
;

1675 
	}
}

1680 
	$¢d_pcm_dœeù_check_š‹¾—ve
(
¢d_pcm_dœeù_t
 *
dmix
, 
¢d_pcm_t
 *
pcm
)

1682 
chn
, 
chªÃls
;

1683 
b™s
;

1684 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
;

1685 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
;

1687 
b™s
 = 
	`¢d_pcm_fÜm©_physiÿl_width
(
pcm
->
fÜm©
);

1688 ià((
b™s
 % 8) != 0)

1689 
__noš‹¾—ved
;

1690 
chªÃls
 = 
dmix
->channels;

1691 ià(
chªÃls
 !ğ
dmix
->
¥cm
->channels)

1692 
__noš‹¾—ved
;

1693 
d¡_¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
dmix
->
¥cm
);

1694 
¤c_¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

1695 
chn
 = 1; chÀ< 
chªÃls
; chn++) {

1696 ià(
d¡_¬—s
[
chn
-1].
addr
 != dst_areas[chn].addr)

1697 
__noš‹¾—ved
;

1698 ià(
¤c_¬—s
[
chn
-1].
addr
 != src_areas[chn].addr)

1699 
__noš‹¾—ved
;

1701 
chn
 = 0; chÀ< 
chªÃls
; chn++) {

1702 ià(
dmix
->
bšdšgs
 && dmix->bšdšgs[
chn
] != chn)

1703 
__noš‹¾—ved
;

1704 ià(
d¡_¬—s
[
chn
].
fœ¡
 !ğchÀ* 
b™s
 ||

1705 
d¡_¬—s
[
chn
].
¡•
 !ğ
chªÃls
 * 
b™s
)

1706 
__noš‹¾—ved
;

1707 ià(
¤c_¬—s
[
chn
].
fœ¡
 !ğchÀ* 
b™s
 ||

1708 
¤c_¬—s
[
chn
].
¡•
 !ğ
chªÃls
 * 
b™s
)

1709 
__noš‹¾—ved
;

1711  
dmix
->
š‹¾—ved
 = 1;

1712 
__noš‹¾—ved
:

1713  
dmix
->
š‹¾—ved
 = 0;

1714 
	}
}

1721 
	$¢d_pcm_dœeù_·r£_bšdšgs
(
¢d_pcm_dœeù_t
 *
dmix
,

1722 
¦ave_·¿ms
 *
·¿ms
,

1723 
¢d_cÚfig_t
 *
cfg
)

1725 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1726 
chn
, 
chn1
, 
couÁ
 = 0;

1727 *
bšdšgs
;

1728 
”r
;

1730 
dmix
->
chªÃls
 = 
UINT_MAX
;

1731 ià(
cfg
 =ğ
NULL
)

1733 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1734 
	`SNDERR
("invalidype for bindings");

1735  -
EINVAL
;

1737 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1738 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1739 cÚ¡ *
id
;

1740 
cchªÃl
;

1741 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1743 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
cchªÃl
);

1744 ià(
”r
 < 0 || 
cchªÃl
 < 0) {

1745 
	`SNDERR
("šv®id cl›Á chªÃÈš bšdšg: %s", 
id
);

1746  -
EINVAL
;

1748 ià(()
cchªÃl
 >ğ
couÁ
)

1749 
couÁ
 = 
cchªÃl
 + 1;

1751 ià(
couÁ
 == 0)

1753 ià(
couÁ
 > 1024) {

1754 
	`SNDERR
("client channel out of„ange");

1755  -
EINVAL
;

1757 
bšdšgs
 = 
	`m®loc
(
couÁ
 * ());

1758 ià(
bšdšgs
 =ğ
NULL
)

1759  -
ENOMEM
;

1760 
chn
 = 0; chÀ< 
couÁ
; chn++)

1761 
bšdšgs
[
chn
] = 
UINT_MAX
;

1762 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1763 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1764 cÚ¡ *
id
;

1765 
cchªÃl
, 
schªÃl
;

1766 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1768 
	`§ã_¡¹Ş
(
id
, &
cchªÃl
);

1769 ià(
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
schªÃl
) < 0) {

1770 
	`SNDERR
("uÇbËØg‘ sÏvchªÃÈ(should bš‹g”y³èš bšdšg: %s", 
id
);

1771 
	`ä“
(
bšdšgs
);

1772  -
EINVAL
;

1774 ià(
schªÃl
 < 0 || schªÃÈ>ğ
·¿ms
->
chªÃls
) {

1775 
	`SNDERR
("invalid slave channel‚umber %ld in bindingo %ld",

1776 
schªÃl
, 
cchªÃl
);

1777 
	`ä“
(
bšdšgs
);

1778  -
EINVAL
;

1780 
bšdšgs
[
cchªÃl
] = 
schªÃl
;

1782 ià(
dmix
->
ty³
 =ğ
SND_PCM_TYPE_DSNOOP
 ||

1783 ! 
dmix
->
bšdšgs
)

1784 
__sk_§me_d¡
;

1785 
chn
 = 0; chÀ< 
couÁ
; chn++) {

1786 
chn1
 = 0; chn1 < 
couÁ
; chn1++) {

1787 ià(
chn
 =ğ
chn1
)

1789 ià(
bšdšgs
[
chn
] =ğ
dmix
->bšdšgs[
chn1
]) {

1790 
	`SNDERR
("uÇbËØrou‹ chªÃl %d,%dØ§mde¡š©iÚ %d", 
chn
, 
chn1
, 
bšdšgs
[chn]);

1791 
	`ä“
(
bšdšgs
);

1792  -
EINVAL
;

1796 
__sk_§me_d¡
:

1797 
dmix
->
bšdšgs
 = bindings;

1798 
dmix
->
chªÃls
 = 
couÁ
;

1800 
	}
}

1806 
	$_¢d_pcm_dœeù_g‘_¦ave_c_off£t
(
¢d_cÚfig_t
 *
roÙ
,

1807 
¢d_cÚfig_t
 *
scÚf
,

1808 
dœeùiÚ
,

1809 
hİ
)

1811 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1812 
¢d_cÚfig_t
 *
pcm_cÚf
, *
pcm_cÚf2
;

1813 
”r
;

1814 
ÿrd
 = 0, 
deviû
 = 0, 
subdeviû
 = 0;

1815 cÚ¡ *
¡r
;

1817 ià(
	`¢d_cÚfig_g‘_¡ršg
(
scÚf
, &
¡r
) >= 0) {

1818 ià(
hİ
 > 
SND_CONF_MAX_HOPS
) {

1819 
	`SNDERR
("Too many definition†evels (looped?)");

1820  -
EINVAL
;

1822 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "pcm", 
¡r
, &
pcm_cÚf
);

1823 ià(
”r
 < 0) {

1824 
	`SNDERR
("UnknowÀ¦avPCM %s", 
¡r
);

1825  
”r
;

1827 
”r
 = 
	`_¢d_pcm_dœeù_g‘_¦ave_c_off£t
(
roÙ
, 
pcm_cÚf
,

1828 
dœeùiÚ
,

1829 
hİ
 + 1);

1830 
	`¢d_cÚfig_d–‘e
(
pcm_cÚf
);

1831  
”r
;

1836 
¢d_ouut_t
 *
out
;

1837 
	`¢d_ouut_¡dio_©ch
(&
out
, 
¡d”r
, 0);

1838 
	`¢d_cÚfig_§ve
(
scÚf
, 
out
);

1839 
	`¢d_ouut_şo£
(
out
);

1843 ià(
	`¢d_cÚfig_£¬ch
(
scÚf
, "¦ave", &
pcm_cÚf
) >= 0) {

1844 ià(
	`¢d_cÚfig_£¬ch
(
pcm_cÚf
, "pcm", &pcm_conf) >= 0) {

1845  
	`_¢d_pcm_dœeù_g‘_¦ave_c_off£t
(
roÙ
,

1846 
pcm_cÚf
,

1847 
dœeùiÚ
,

1848 
hİ
 + 1);

1850 ià(
	`¢d_cÚfig_g‘_¡ršg
(
pcm_cÚf
, &
¡r
) >= 0 &&

1851 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "pcm_slave",

1852 
¡r
, &
pcm_cÚf
) >= 0) {

1853 ià(
	`¢d_cÚfig_£¬ch
(
pcm_cÚf
, "pcm",

1854 &
pcm_cÚf2
) >= 0) {

1855 
”r
 =

1856 
	`_¢d_pcm_dœeù_g‘_¦ave_c_off£t
(

1857 
roÙ
, 
pcm_cÚf2
, 
dœeùiÚ
, 
hİ
 + 1);

1858 
	`¢d_cÚfig_d–‘e
(
pcm_cÚf
);

1859  
”r
;

1861 
	`¢d_cÚfig_d–‘e
(
pcm_cÚf
);

1866 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
scÚf
) {

1867 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1868 cÚ¡ *
id
, *
¡r
;

1869 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1871 ià(
	`¡rcmp
(
id
, "type") == 0) {

1872 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
);

1873 ià(
”r
 < 0) {

1874 
	`SNDERR
("Invalid value for PCMype definition");

1875  -
EINVAL
;

1877 ià(
	`¡rcmp
(
¡r
, "hw")) {

1878 
	`SNDERR
("Inv®idy³ '%s' fÜ sÏvPCM", 
¡r
);

1879  -
EINVAL
;

1883 ià(
	`¡rcmp
(
id
, "card") == 0) {

1884 
”r
 = 
	`¢d_cÚfig_g‘_ÿrd
(
n
);

1885 ià(
”r
 < 0)

1886  
”r
;

1887 
ÿrd
 = 
”r
;

1890 ià(
	`¡rcmp
(
id
, "device") == 0) {

1891 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
deviû
);

1892 ià(
”r
 < 0) {

1893 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1894  
”r
;

1898 ià(
	`¡rcmp
(
id
, "subdevice") == 0) {

1899 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
subdeviû
);

1900 ià(
”r
 < 0) {

1901 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1902  
”r
;

1907 ià(
deviû
 < 0)

1908 
deviû
 = 0;

1909 ià(
subdeviû
 < 0)

1910 
subdeviû
 = 0;

1911  (
dœeùiÚ
 << 1è+ (
deviû
 << 2è+ (
subdeviû
 << 8è+ (
ÿrd
 << 12);

1912 
	}
}

1914 
	$¢d_pcm_dœeù_g‘_¦ave_c_off£t
(
¢d_cÚfig_t
 *
roÙ
,

1915 
¢d_cÚfig_t
 *
scÚf
,

1916 
dœeùiÚ
)

1918  
	`_¢d_pcm_dœeù_g‘_¦ave_c_off£t
(
roÙ
, 
scÚf
, 
dœeùiÚ
, 0);

1919 
	}
}

1921 
	$¢d_pcm_dœeù_·r£_İ’_cÚf
(
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

1922 
¡»am
, 
¢d_pcm_dœeù_İ’_cÚf
 *
»c
)

1924 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1925 
c_key_add_uid
 = 0;

1926 
¢d_cÚfig_t
 *
n
;

1927 
”r
;

1929 
»c
->
¦ave
 = 
NULL
;

1930 
»c
->
bšdšgs
 = 
NULL
;

1931 
»c
->
c_key
 = 0;

1932 
»c
->
c_³rm
 = 0600;

1933 
»c
->
c_gid
 = -1;

1934 
»c
->
¦ow±r
 = 1;

1935 
»c
->
max_³riods
 = 0;

1936 
»c
->
v¬_³riodsize
 = 0;

1937 #ifdeà
LOCKLESS_DMIX_DEFAULT


1938 
»c
->
dœeù_memÜy_acûss
 = 1;

1940 
»c
->
dœeù_memÜy_acûss
 = 0;

1942 
»c
->
hw_±r_®ignm’t
 = 
SND_PCM_HW_PTR_ALIGNMENT_AUTO
;

1943 
»c
->
t¡amp_ty³
 = -1;

1946 ià(
	`¢d_cÚfig_£¬ch
(
roÙ
, "deçuÉs.pcm.dmix_max_³riods", &
n
) >= 0) {

1947 
v®
;

1948 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v®
);

1949 ià(
”r
 >= 0)

1950 
»c
->
max_³riods
 = 
v®
;

1953 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1954 cÚ¡ *
id
;

1955 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1956 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1958 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

1960 ià(
	`¡rcmp
(
id
, "ipc_key") == 0) {

1961 
key
;

1962 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
key
);

1963 ià(
”r
 < 0) {

1964 
	`SNDERR
("The field ipc_key must be‡n integerype");

1966  
”r
;

1968 
»c
->
c_key
 = 
key
;

1971 ià(
	`¡rcmp
(
id
, "ipc_perm") == 0) {

1972 
³rm
;

1973 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
³rm
);

1974 ià(
”r
 < 0) {

1975 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1976  
”r
;

1978 ià((
³rm
 & ~0777) != 0) {

1979 
	`SNDERR
("The field ipc_perm must be‡ valid file…ermission");

1980  -
EINVAL
;

1982 
»c
->
c_³rm
 = 
³rm
;

1985 ià(
	`¡rcmp
(
id
, "hw_ptr_alignment") == 0) {

1986 cÚ¡ *
¡r
;

1987 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
);

1988 ià(
”r
 < 0) {

1989 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1990  -
EINVAL
;

1992 ià(
	`¡rcmp
(
¡r
, "no") == 0 || strcmp(str, "off") == 0)

1993 
»c
->
hw_±r_®ignm’t
 = 
SND_PCM_HW_PTR_ALIGNMENT_NO
;

1994 ià(
	`¡rcmp
(
¡r
, "roundup") == 0)

1995 
»c
->
hw_±r_®ignm’t
 = 
SND_PCM_HW_PTR_ALIGNMENT_ROUNDUP
;

1996 ià(
	`¡rcmp
(
¡r
, "rounddown") == 0)

1997 
»c
->
hw_±r_®ignm’t
 = 
SND_PCM_HW_PTR_ALIGNMENT_ROUNDDOWN
;

1998 ià(
	`¡rcmp
(
¡r
, "auto") == 0)

1999 
»c
->
hw_±r_®ignm’t
 = 
SND_PCM_HW_PTR_ALIGNMENT_AUTO
;

2001 
	`SNDERR
("Thf›ld hw_±r_®ignm’ˆi šv®id : %s", 
¡r
);

2002  -
EINVAL
;

2007 ià(
	`¡rcmp
(
id
, "tstamp_type") == 0) {

2008 cÚ¡ *
¡r
;

2009 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
);

2010 ià(
”r
 < 0) {

2011 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

2012  -
EINVAL
;

2014 ià(
	`¡rcmp
(
¡r
, "default") == 0)

2015 
»c
->
t¡amp_ty³
 = -1;

2016 ià(
	`¡rcmp
(
¡r
, "gettimeofday") == 0)

2017 
»c
->
t¡amp_ty³
 = 
SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY
;

2018 ià(
	`¡rcmp
(
¡r
, "monotonic") == 0)

2019 
»c
->
t¡amp_ty³
 = 
SND_PCM_TSTAMP_TYPE_MONOTONIC
;

2020 ià(
	`¡rcmp
(
¡r
, "monotonic_raw") == 0)

2021 
»c
->
t¡amp_ty³
 = 
SND_PCM_TSTAMP_TYPE_MONOTONIC_RAW
;

2023 
	`SNDERR
("Thf›ld¡amp_ty³ i šv®id : %s", 
¡r
);

2024  -
EINVAL
;

2028 ià(
	`¡rcmp
(
id
, "ipc_gid") == 0) {

2029 *
group
;

2030 *
’dp
;

2031 
”r
 = 
	`¢d_cÚfig_g‘_ascii
(
n
, &
group
);

2032 ià(
”r
 < 0) {

2033 
	`SNDERR
("The field ipc_gid must be‡ valid group");

2034  
”r
;

2036 ià(! *
group
) {

2037 
»c
->
c_gid
 = -1;

2038 
	`ä“
(
group
);

2041 ià(
	`isdig™
(*
group
) == 0) {

2042 
ş’
 = 
	`syscÚf
(
_SC_GETGR_R_SIZE_MAX
);

2043 
size_t
 
Ën
 = (
ş’
 == -1) ? 1024 : (size_t)clen;

2044 
group
 
g½
, *
pg½
;

2045 *
bufãr
 = (*)
	`m®loc
(
Ën
);

2046 ià(
bufãr
 =ğ
NULL
)

2047  -
ENOMEM
;

2048 
¡
 = 
	`g‘gºam_r
(
group
, &
g½
, 
bufãr
, 
Ën
, &
pg½
);

2049 ià(
¡
 !ğ0 || !
pg½
) {

2050 
	`SNDERR
("Thf›ld ipc_gid mu¡ b¨v®id grou°(ü—‹ grou°%s)", 
group
);

2051 
	`ä“
(
bufãr
);

2052  -
EINVAL
;

2054 
»c
->
c_gid
 = 
pg½
->
gr_gid
;

2055 
	`ä“
(
bufãr
);

2057 
»c
->
c_gid
 = 
	`¡¹Ş
(
group
, &
’dp
, 10);

2059 
	`ä“
(
group
);

2062 ià(
	`¡rcmp
(
id
, "ipc_key_add_uid") == 0) {

2063 ià((
”r
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
)) < 0) {

2064 
	`SNDERR
("The field ipc_key_add_uid must be‡ booleanype");

2065  
”r
;

2067 
c_key_add_uid
 = 
”r
;

2070 ià(
	`¡rcmp
(
id
, "slave") == 0) {

2071 
»c
->
¦ave
 = 
n
;

2074 ià(
	`¡rcmp
(
id
, "bindings") == 0) {

2075 
»c
->
bšdšgs
 = 
n
;

2078 ià(
	`¡rcmp
(
id
, "slowptr") == 0) {

2079 
”r
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

2080 ià(
”r
 < 0)

2081  
”r
;

2082 
»c
->
¦ow±r
 = 
”r
;

2085 ià(
	`¡rcmp
(
id
, "max_periods") == 0) {

2086 
v®
;

2087 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v®
);

2088 ià(
”r
 < 0)

2089  
”r
;

2090 
»c
->
max_³riods
 = 
v®
;

2093 ià(
	`¡rcmp
(
id
, "var_periodsize") == 0) {

2094 
”r
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

2095 ià(
”r
 < 0)

2096  
”r
;

2097 
»c
->
v¬_³riodsize
 = 
”r
;

2100 ià(
	`¡rcmp
(
id
, "direct_memory_access") == 0) {

2101 
”r
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

2102 ià(
”r
 < 0)

2103  
”r
;

2104 
»c
->
dœeù_memÜy_acûss
 = 
”r
;

2107 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

2108  -
EINVAL
;

2110 ià(!
»c
->
¦ave
) {

2111 
	`SNDERR
("slave is‚ot defined");

2112  -
EINVAL
;

2114 ià(!
»c
->
c_key
) {

2115 
	`SNDERR
("Unique IPC key is‚ot defined");

2116  -
EINVAL
;

2118 ià(
c_key_add_uid
)

2119 
»c
->
c_key
 +ğ
	`g‘uid
();

2120 
”r
 = 
	`¢d_pcm_dœeù_g‘_¦ave_c_off£t
(
roÙ
, 
cÚf
, 
¡»am
);

2121 ià(
”r
 < 0)

2122  
”r
;

2123 
»c
->
c_key
 +ğ
”r
;

2126 
	}
}

2128 
	$¢d_pcm_dœeù_»£t_¦ave_±r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_dœeù_t
 *
dmix
,

2129 
¢d_pcm_uäames_t
 
hw_±r
)

2131 
dmix
->
¦ave_­¶_±r
 = dmix->
¦ave_hw_±r
 = 
hw_±r
;

2132 ià(
dmix
->
hw_±r_®ignm’t
 =ğ
SND_PCM_HW_PTR_ALIGNMENT_ROUNDUP
 ||

2133 (
dmix
->
hw_±r_®ignm’t
 =ğ
SND_PCM_HW_PTR_ALIGNMENT_AUTO
 &&

2134 
pcm
->
bufãr_size
 <ğpcm->
³riod_size
 * 2))

2135 
dmix
->
¦ave_­¶_±r
 =

2136 ((
dmix
->
¦ave_­¶_±r
 + dmix->
¦ave_³riod_size
 - 1) /

2137 
dmix
->
¦ave_³riod_size
) * dmix->slave_period_size;

2138 ià(
dmix
->
hw_±r_®ignm’t
 =ğ
SND_PCM_HW_PTR_ALIGNMENT_ROUNDDOWN
 ||

2139 (
dmix
->
hw_±r_®ignm’t
 =ğ
SND_PCM_HW_PTR_ALIGNMENT_AUTO
 &&

2140 ((
dmix
->
¦ave_³riod_size
 * 
SEC_TO_MS
è/ 
pcm
->
¿‹
è< 
LOW_LATENCY_PERIOD_TIME
))

2141 
dmix
->
¦ave_­¶_±r
 = dmix->
¦ave_hw_±r
 =

2142 ((
dmix
->
¦ave_hw_±r
 / dmix->
¦ave_³riod_size
) *

2143 
dmix
->
¦ave_³riod_size
);

2144 
	}
}

2146 
	$_¢d_pcm_dœeù_Ãw
(
¢d_pcm_t
 **
pcmp
, 
¢d_pcm_dœeù_t
 **
_dmix
, 
ty³
,

2147 cÚ¡ *
Çme
, 
¢d_pcm_dœeù_İ’_cÚf
 *
İts
,

2148 
¦ave_·¿ms
 *
·¿ms
, 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

2150 
¢d_pcm_dœeù_t
 *
dmix
;

2151 
ç_£m_loİ
 = 10;

2152 
»t
;

2154 
dmix
 = 
	`ÿÎoc
(1, (
¢d_pcm_dœeù_t
));

2155 ià(!
dmix
)

2156  -
ENOMEM
;

2158 
»t
 = 
	`¢d_pcm_dœeù_·r£_bšdšgs
(
dmix
, 
·¿ms
, 
İts
->
bšdšgs
);

2159 ià(
»t
 < 0) {

2160 
	`ä“
(
dmix
);

2161  
»t
;

2164 
dmix
->
c_key
 = 
İts
->ipc_key;

2165 
dmix
->
c_³rm
 = 
İts
->ipc_perm;

2166 
dmix
->
c_gid
 = 
İts
->ipc_gid;

2167 
dmix
->
t¡amp_ty³
 = 
İts
->tstamp_type;

2168 
dmix
->
£mid
 = -1;

2169 
dmix
->
shmid
 = -1;

2170 
dmix
->
shm±r
 = (*) -1;

2171 
dmix
->
ty³
 =ype;

2173 
»t
 = 
	`¢d_pcm_Ãw
(
pcmp
, 
ty³
, 
Çme
, 
¡»am
, 
mode
);

2174 ià(
»t
 < 0)

2175 
_”r_no£m
;

2178 
»t
 = 
	`¢d_pcm_dœeù_£m­hÜe_ü—‹_Ü_cÚÃù
(
dmix
);

2179 ià(
»t
 < 0) {

2180 
	`SNDERR
("unableo create IPC semaphore");

2181 
_”r_no£m_ä“
;

2183 
»t
 = 
	`¢d_pcm_dœeù_£m­hÜe_down
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

2184 ià(
»t
 < 0) {

2185 
	`¢d_pcm_dœeù_£m­hÜe_disÿrd
(
dmix
);

2186 ià(--
ç_£m_loİ
 <= 0)

2187 
_”r_no£m_ä“
;

2193 
»t
 = 
	`¢d_pcm_dœeù_shm_ü—‹_Ü_cÚÃù
(
dmix
);

2194 ià(
»t
 < 0) {

2195 
	`SNDERR
("unableo create IPC shm instance");

2196 
	`¢d_pcm_dœeù_£m­hÜe_up
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

2197 
_”r_no£m_ä“
;

2199 *
_dmix
 = 
dmix
;

2202  
»t
;

2203 
_”r_no£m_ä“
:

2204 
	`¢d_pcm_ä“
(*
pcmp
);

2205 *
pcmp
 = 
NULL
;

2206 
_”r_no£m
:

2207 
	`ä“
(
dmix
->
bšdšgs
);

2208 
	`ä“
(
dmix
);

2209  
»t
;

2210 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_direct.h

22 
	~"pcm_loÿl.h
"

23 
	~"../tim”/tim”_loÿl.h
"

25 
	#DIRECT_IPC_SEMS
 1

	)

26 
	#DIRECT_IPC_SEM_CLIENT
 0

	)

28 
	#SEC_TO_MS
 1000

	)

30 
	#LOW_LATENCY_PERIOD_TIME
 10

	)

33 (
	tmix_¬—s_t
)(
	tsize
,

34 vŞ©*
	td¡
, *
	t¤c
,

35 vŞ©sigÃd *
	tsum
, 
	tsize_t
 
	td¡_¡•
,

36 
	tsize_t
 
	t¤c_¡•
, size_ˆ
	tsum_¡•
);

38 (
	tmix_¬—s_16_t
)(
	tsize
,

39 vŞ©sigÃd *
	td¡
, sigÃd *
	t¤c
,

40 vŞ©sigÃd *
	tsum
, 
	tsize_t
 
	td¡_¡•
,

41 
	tsize_t
 
	t¤c_¡•
, size_ˆ
	tsum_¡•
);

43 (
	tmix_¬—s_32_t
)(
	tsize
,

44 vŞ©sigÃd *
	td¡
, sigÃd *
	t¤c
,

45 vŞ©sigÃd *
	tsum
, 
	tsize_t
 
	td¡_¡•
,

46 
	tsize_t
 
	t¤c_¡•
, size_ˆ
	tsum_¡•
);

48 (
	tmix_¬—s_24_t
)(
	tsize
,

49 vŞ©*
	td¡
, *
	t¤c
,

50 vŞ©sigÃd *
	tsum
, 
	tsize_t
 
	td¡_¡•
,

51 
	tsize_t
 
	t¤c_¡•
, size_ˆ
	tsum_¡•
);

53 (
	tmix_¬—s_u8_t
)(
	tsize
,

54 vŞ©*
	td¡
, *
	t¤c
,

55 vŞ©sigÃd *
	tsum
, 
	tsize_t
 
	td¡_¡•
,

56 
	tsize_t
 
	t¤c_¡•
, size_ˆ
	tsum_¡•
);

58 
	e¢d_pcm_dœeù_hw_±r_®ignm’t
 {

59 
SND_PCM_HW_PTR_ALIGNMENT_NO
 = 0,

60 
SND_PCM_HW_PTR_ALIGNMENT_ROUNDUP
 = 1,

61 
SND_PCM_HW_PTR_ALIGNMENT_ROUNDDOWN
 = 2,

62 
SND_PCM_HW_PTR_ALIGNMENT_AUTO
 = 3

63 } 
	t¢d_pcm_dœeù_hw_±r_®ignm’t_t
;

65 
	s¦ave_·¿ms
 {

66 
¢d_pcm_fÜm©_t
 
fÜm©
;

67 
¿‹
;

68 
chªÃls
;

69 
³riod_time
;

70 
bufãr_time
;

71 
¢d_pcm_säames_t
 
³riod_size
;

72 
¢d_pcm_säames_t
 
bufãr_size
;

73 
³riods
;

78 
magic
;

79 
sock‘_Çme
[256];

80 
¢d_pcm_ty³_t
 
ty³
;

81 
u£_£rv”
;

83 
fÜm©
;

84 
¢d_š‹rv®_t
 
¿‹
;

85 
¢d_š‹rv®_t
 
bufãr_size
;

86 
¢d_š‹rv®_t
 
bufãr_time
;

87 
¢d_š‹rv®_t
 
³riod_size
;

88 
¢d_š‹rv®_t
 
³riod_time
;

89 
¢d_š‹rv®_t
 
³riods
;

90 } 
hw
;

93 
¢d_pcm_acûss_t
 
acûss
;

94 
¢d_pcm_fÜm©_t
 
fÜm©
;

95 
¢d_pcm_subfÜm©_t
 
subfÜm©
;

96 
chªÃls
;

97 
¿‹
;

98 
³riod_size
;

99 
³riod_time
;

100 
¢d_š‹rv®_t
 
³riods
;

101 
¢d_pcm_t¡amp_t
 
t¡amp_mode
;

102 
¢d_pcm_t¡amp_ty³_t
 
t¡amp_ty³
;

103 
³riod_¡•
;

104 
¦“p_mš
;

105 
ava_mš
;

106 
¡¬t_th»shŞd
;

107 
¡İ_th»shŞd
;

108 
s’û_th»shŞd
;

109 
s’û_size
;

110 
»cov”›s
;

111 
bound¬y
;

112 
šfo
;

113 
msb™s
;

114 
¿‹_num
;

115 
¿‹_d’
;

116 
hw_æags
;

117 
fifo_size
;

118 
bufãr_size
;

119 
¢d_š‹rv®_t
 
bufãr_time
;

120 
§m¶e_b™s
;

121 
äame_b™s
;

122 } 
s
;

125 
chn_mask
;

126 } 
dsh¬e
;

127 } 
u
;

128 } 
	t¢d_pcm_dœeù_sh¬e_t
;

130 
¢d_pcm_dœeù
 
	t¢d_pcm_dœeù_t
;

132 
	s¢d_pcm_dœeù
 {

133 
¢d_pcm_ty³_t
 
ty³
;

134 
key_t
 
c_key
;

135 
mode_t
 
c_³rm
;

136 
c_gid
;

137 
£mid
;

138 
locked
[
DIRECT_IPC_SEMS
];

139 
shmid
;

140 
¢d_pcm_dœeù_sh¬e_t
 *
shm±r
;

141 
¢d_pcm_t
 *
¥cm
;

142 
¢d_pcm_uäames_t
 
­¶_±r
;

143 
¢d_pcm_uäames_t
 
Ï¡_­¶_±r
;

144 
¢d_pcm_uäames_t
 
hw_±r
;

145 
¢d_pcm_uäames_t
 
ava_max
;

146 
¢d_pcm_uäames_t
 
¦ave_­¶_±r
;

147 
¢d_pcm_uäames_t
 
¦ave_hw_±r
;

148 
¢d_pcm_uäames_t
 
¦ave_³riod_size
;

149 
¢d_pcm_uäames_t
 
¦ave_bufãr_size
;

150 
¢d_pcm_uäames_t
 
¦ave_bound¬y
;

151 (*
sync_±r
)(
¢d_pcm_t
 *
pcm
);

152 
¢d_pcm_¡©e_t
 
¡©e
;

153 
¢d_htime¡amp_t
 
Œigg”_t¡amp
;

154 
¢d_htime¡amp_t
 
upd©e_t¡amp
;

155 
£rv”
, 
ş›Á
;

156 
comm_fd
;

157 
hw_fd
;

158 
pŞlfd
 
tim”_fd
;

159 
pŞl_fd
;

160 
Œ—d
: 1;

161 
tim”_Ãed_pŞl
: 1;

162 
tim”_ev’ts
;

163 
tim”_ticks
;

164 
£rv”_fd
;

165 
pid_t
 
£rv”_pid
;

166 
¢d_tim”_t
 *
tim”
;

167 
š‹¾—ved
;

168 
¦ow±r
;

169 
max_³riods
;

170 
v¬_³riodsize
;

171 
chªÃls
;

172 *
bšdšgs
;

173 
»cov”›s
;

174 
dœeù_memÜy_acûss
;

175 
¢d_pcm_dœeù_hw_±r_®ignm’t_t
 
hw_±r_®ignm’t
;

176 
t¡amp_ty³
;

179 
shmid_sum
;

180 sigÃd *
sum_bufãr
;

181 
mix_¬—s_16_t
 *
mix_¬—s_16
;

182 
mix_¬—s_32_t
 *
mix_¬—s_32
;

183 
mix_¬—s_24_t
 *
mix_¬—s_24
;

184 
mix_¬—s_u8_t
 *
mix_¬—s_u8
;

185 
mix_¬—s_16_t
 *
»mix_¬—s_16
;

186 
mix_¬—s_32_t
 *
»mix_¬—s_32
;

187 
mix_¬—s_24_t
 *
»mix_¬—s_24
;

188 
mix_¬—s_u8_t
 *
»mix_¬—s_u8
;

189 
u£_£m
;

190 } 
dmix
;

192 
chn_mask
;

193 } 
dsh¬e
;

194 } 
u
;

195 (*
£rv”_ä“
)(
¢d_pcm_dœeù_t
 *
dœeù
);

199 
	#¢d_pcm_dœeù_£m­hÜe_ü—‹_Ü_cÚÃù
 \

200 
¢d1_pcm_dœeù_£m­hÜe_ü—‹_Ü_cÚÃù


	)

201 
	#¢d_pcm_dœeù_shm_ü—‹_Ü_cÚÃù
 \

202 
¢d1_pcm_dœeù_shm_ü—‹_Ü_cÚÃù


	)

203 
	#¢d_pcm_dœeù_shm_disÿrd
 \

204 
¢d1_pcm_dœeù_shm_disÿrd


	)

205 
	#¢d_pcm_dœeù_£rv”_ü—‹
 \

206 
¢d1_pcm_dœeù_£rv”_ü—‹


	)

207 
	#¢d_pcm_dœeù_£rv”_disÿrd
 \

208 
¢d1_pcm_dœeù_£rv”_disÿrd


	)

209 
	#¢d_pcm_dœeù_ş›Á_cÚÃù
 \

210 
¢d1_pcm_dœeù_ş›Á_cÚÃù


	)

211 
	#¢d_pcm_dœeù_ş›Á_disÿrd
 \

212 
¢d1_pcm_dœeù_ş›Á_disÿrd


	)

213 
	#¢d_pcm_dœeù_š™Ÿlize_¦ave
 \

214 
¢d1_pcm_dœeù_š™Ÿlize_¦ave


	)

215 
	#¢d_pcm_dœeù_š™Ÿlize_£cÚd¬y_¦ave
 \

216 
¢d1_pcm_dœeù_š™Ÿlize_£cÚd¬y_¦ave


	)

217 
	#¢d_pcm_dœeù_š™Ÿlize_pŞl_fd
 \

218 
¢d1_pcm_dœeù_š™Ÿlize_pŞl_fd


	)

219 
	#¢d_pcm_dœeù_check_š‹¾—ve
 \

220 
¢d1_pcm_dœeù_check_š‹¾—ve


	)

221 
	#¢d_pcm_dœeù_·r£_bšdšgs
 \

222 
¢d1_pcm_dœeù_·r£_bšdšgs


	)

223 
	#¢d_pcm_dœeù_nÚblock
 \

224 
¢d1_pcm_dœeù_nÚblock


	)

225 
	#¢d_pcm_dœeù_async
 \

226 
¢d1_pcm_dœeù_async


	)

227 
	#¢d_pcm_dœeù_pŞl_desütÜs
 \

228 
¢d1_pcm_dœeù_pŞl_desütÜs


	)

229 
	#¢d_pcm_dœeù_pŞl_»v’ts
 \

230 
¢d1_pcm_dœeù_pŞl_»v’ts


	)

231 
	#¢d_pcm_dœeù_šfo
 \

232 
¢d1_pcm_dœeù_šfo


	)

233 
	#¢d_pcm_dœeù_hw_»fše
 \

234 
¢d1_pcm_dœeù_hw_»fše


	)

235 
	#¢d_pcm_dœeù_hw_·¿ms
 \

236 
¢d1_pcm_dœeù_hw_·¿ms


	)

237 
	#¢d_pcm_dœeù_hw_ä“
 \

238 
¢d1_pcm_dœeù_hw_ä“


	)

239 
	#¢d_pcm_dœeù_sw_·¿ms
 \

240 
¢d1_pcm_dœeù_sw_·¿ms


	)

241 
	#¢d_pcm_dœeù_chªÃl_šfo
 \

242 
¢d1_pcm_dœeù_chªÃl_šfo


	)

243 
	#¢d_pcm_dœeù_mm­
 \

244 
¢d1_pcm_dœeù_mm­


	)

245 
	#¢d_pcm_dœeù_munm­
 \

246 
¢d1_pcm_dœeù_munm­


	)

247 
	#¢d_pcm_dœeù_´•¬e
 \

248 
¢d1_pcm_dœeù_´•¬e


	)

249 
	#¢d_pcm_dœeù_»sume
 \

250 
¢d1_pcm_dœeù_»sume


	)

251 
	#¢d_pcm_dœeù_tim”_¡İ
 \

252 
¢d1_pcm_dœeù_tim”_¡İ


	)

253 
	#¢d_pcm_dœeù_ş—r_tim”_queue
 \

254 
¢d1_pcm_dœeù_ş—r_tim”_queue


	)

255 
	#¢d_pcm_dœeù_£t_tim”_·¿ms
 \

256 
¢d1_pcm_dœeù_£t_tim”_·¿ms


	)

257 
	#¢d_pcm_dœeù_İ’_£cÚd¬y_ş›Á
 \

258 
¢d1_pcm_dœeù_İ’_£cÚd¬y_ş›Á


	)

259 
	#¢d_pcm_dœeù_·r£_İ’_cÚf
 \

260 
¢d1_pcm_dœeù_·r£_İ’_cÚf


	)

261 
	#¢d_pcm_dœeù_qu”y_chm­s
 \

262 
¢d1_pcm_dœeù_qu”y_chm­s


	)

263 
	#¢d_pcm_dœeù_g‘_chm­
 \

264 
¢d1_pcm_dœeù_g‘_chm­


	)

265 
	#¢d_pcm_dœeù_£t_chm­
 \

266 
¢d1_pcm_dœeù_£t_chm­


	)

267 
	#¢d_pcm_dœeù_»£t_¦ave_±r
 \

268 
¢d1_pcm_dœeù_»£t_¦ave_±r


	)

269 
	#¢d_pcm_dœeù_check_xrun
 \

270 
¢d1_pcm_dœeù_check_xrun


	)

271 
	#¢d_pcm_dœeù_¦ave_»cov”
 \

272 
¢d1_pcm_dœeù_¦ave_»cov”


	)

274 
	`¢d_pcm_dœeù_£m­hÜe_ü—‹_Ü_cÚÃù
(
¢d_pcm_dœeù_t
 *
dmix
);

276 
šlše
 
	$¢d_pcm_dœeù_£m­hÜe_disÿrd
(
¢d_pcm_dœeù_t
 *
dmix
)

278 ià(
dmix
->
£mid
 >= 0) {

279 ià(
	`£mùl
(
dmix
->
£mid
, 0, 
IPC_RMID
, 
NULL
) < 0)

280  -
”ºo
;

281 
dmix
->
£mid
 = -1;

284 
	}
}

286 
šlše
 
	$¢d_pcm_dœeù_£m­hÜe_down
(
¢d_pcm_dœeù_t
 *
dmix
, 
£m_num
)

288 
£mbuf
 
İ
[2] = { { 
£m_num
, 0, 0 }, { sem_num, 1, 
SEM_UNDO
 } };

289 
”r
 = 
	`£mİ
(
dmix
->
£mid
, 
İ
, 2);

290 ià(
”r
 == 0)

291 
dmix
->
locked
[
£m_num
]++;

292 ià(
”r
 == -1)

293 
”r
 = -
”ºo
;

294  
”r
;

295 
	}
}

297 
šlše
 
	$¢d_pcm_dœeù_£m­hÜe_up
(
¢d_pcm_dœeù_t
 *
dmix
, 
£m_num
)

299 
£mbuf
 
İ
 = { 
£m_num
, -1, 
SEM_UNDO
 | 
IPC_NOWAIT
 };

300 
”r
 = 
	`£mİ
(
dmix
->
£mid
, &
İ
, 1);

301 ià(
”r
 == 0)

302 
dmix
->
locked
[
£m_num
]--;

303 ià(
”r
 == -1)

304 
”r
 = -
”ºo
;

305  
”r
;

306 
	}
}

308 
šlše
 
	$¢d_pcm_dœeù_£m­hÜe_fš®
(
¢d_pcm_dœeù_t
 *
dmix
, 
£m_num
)

310 ià(
dmix
->
locked
[
£m_num
] != 1) {

311 
	`SNDMSG
("šv®id sem­hÜcouÁØfš®iz%d: %d", 
£m_num
, 
dmix
->
locked
[sem_num]);

312  -
EBUSY
;

314  
	`¢d_pcm_dœeù_£m­hÜe_up
(
dmix
, 
£m_num
);

315 
	}
}

317 
¢d_pcm_dœeù_shm_ü—‹_Ü_cÚÃù
(
¢d_pcm_dœeù_t
 *
dmix
);

318 
¢d_pcm_dœeù_shm_disÿrd
(
¢d_pcm_dœeù_t
 *
dmix
);

319 
¢d_pcm_dœeù_£rv”_ü—‹
(
¢d_pcm_dœeù_t
 *
dmix
);

320 
¢d_pcm_dœeù_£rv”_disÿrd
(
¢d_pcm_dœeù_t
 *
dmix
);

321 
¢d_pcm_dœeù_ş›Á_cÚÃù
(
¢d_pcm_dœeù_t
 *
dmix
);

322 
¢d_pcm_dœeù_ş›Á_disÿrd
(
¢d_pcm_dœeù_t
 *
dmix
);

323 
¢d_pcm_dœeù_š™Ÿlize_¦ave
(
¢d_pcm_dœeù_t
 *
dmix
, 
¢d_pcm_t
 *
¥cm
, 
¦ave_·¿ms
 *
·¿ms
);

324 
¢d_pcm_dœeù_š™Ÿlize_£cÚd¬y_¦ave
(
¢d_pcm_dœeù_t
 *
dmix
, 
¢d_pcm_t
 *
¥cm
, 
¦ave_·¿ms
 *
·¿ms
);

325 
¢d_pcm_dœeù_š™Ÿlize_pŞl_fd
(
¢d_pcm_dœeù_t
 *
dmix
);

326 
¢d_pcm_dœeù_check_š‹¾—ve
(
¢d_pcm_dœeù_t
 *
dmix
, 
¢d_pcm_t
 *
pcm
);

327 
¢d_pcm_dœeù_·r£_bšdšgs
(
¢d_pcm_dœeù_t
 *
dmix
,

328 
¦ave_·¿ms
 *
·¿ms
,

329 
¢d_cÚfig_t
 *
cfg
);

330 
¢d_pcm_dœeù_nÚblock
(
¢d_pcm_t
 *
pcm
, 
nÚblock
);

331 
¢d_pcm_dœeù_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
);

332 
¢d_pcm_dœeù_pŞl_desütÜs
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
,

333 
¥aû
);

334 
¢d_pcm_dœeù_pŞl_»v’ts
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
);

335 
¢d_pcm_dœeù_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_šfo_t
 * 
šfo
);

336 
¢d_pcm_dœeù_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

337 
¢d_pcm_dœeù_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 * 
·¿ms
);

338 
¢d_pcm_dœeù_hw_ä“
(
¢d_pcm_t
 *
pcm
);

339 
¢d_pcm_dœeù_sw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 * 
·¿ms
);

340 
¢d_pcm_dœeù_chªÃl_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_šfo_t
 * 
šfo
);

341 
¢d_pcm_dœeù_mm­
(
¢d_pcm_t
 *
pcm
);

342 
¢d_pcm_dœeù_munm­
(
¢d_pcm_t
 *
pcm
);

343 
¢d_pcm_dœeù_´•¬e
(
¢d_pcm_t
 *
pcm
);

344 
¢d_pcm_dœeù_»sume
(
¢d_pcm_t
 *
pcm
);

345 
¢d_pcm_dœeù_tim”_¡İ
(
¢d_pcm_dœeù_t
 *
dmix
);

346 
¢d_pcm_dœeù_ş—r_tim”_queue
(
¢d_pcm_dœeù_t
 *
dmix
);

347 
¢d_pcm_dœeù_£t_tim”_·¿ms
(
¢d_pcm_dœeù_t
 *
dmix
);

348 
¢d_pcm_dœeù_İ’_£cÚd¬y_ş›Á
(
¢d_pcm_t
 **
¥cmp
, 
¢d_pcm_dœeù_t
 *
dmix
, cÚ¡ *
ş›Á_Çme
);

350 
¢d_pcm_chm­_qu”y_t
 **
¢d_pcm_dœeù_qu”y_chm­s
(
¢d_pcm_t
 *
pcm
);

351 
¢d_pcm_chm­_t
 *
¢d_pcm_dœeù_g‘_chm­
(
¢d_pcm_t
 *
pcm
);

352 
¢d_pcm_dœeù_£t_chm­
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chm­_t
 *
m­
);

353 
¢d_pcm_dœeù_¦ave_»cov”
(
¢d_pcm_dœeù_t
 *
dœeù
);

354 
¢d_pcm_dœeù_check_xrun
(
¢d_pcm_dœeù_t
 *
dœeù
, 
¢d_pcm_t
 *
pcm
);

355 
¢d_tim”_async
(
¢d_tim”_t
 *
tim”
, 
sig
, 
pid_t
 
pid
);

356 
time¥ec
 
¢d_pcm_hw_ç¡_t¡amp
(
¢d_pcm_t
 *
pcm
);

357 
¢d_pcm_dœeù_»£t_¦ave_±r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_dœeù_t
 *
dmix
, 
¢d_pcm_uäames_t
 
hw_±r
);

359 
	s¢d_pcm_dœeù_İ’_cÚf
 {

360 
key_t
 
	mc_key
;

361 
mode_t
 
	mc_³rm
;

362 
	mc_gid
;

363 
	m¦ow±r
;

364 
	mmax_³riods
;

365 
	mv¬_³riodsize
;

366 
	mdœeù_memÜy_acûss
;

367 
¢d_pcm_dœeù_hw_±r_®ignm’t_t
 
	mhw_±r_®ignm’t
;

368 
	mt¡amp_ty³
;

369 
¢d_cÚfig_t
 *
	m¦ave
;

370 
¢d_cÚfig_t
 *
	mbšdšgs
;

373 
¢d_pcm_dœeù_·r£_İ’_cÚf
(
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
, 
¡»am
, 
¢d_pcm_dœeù_İ’_cÚf
 *
»c
);

375 
_¢d_pcm_dœeù_Ãw
(
¢d_pcm_t
 **
pcmp
, 
¢d_pcm_dœeù_t
 **
_dmix
, 
ty³
,

376 cÚ¡ *
Çme
, 
¢d_pcm_dœeù_İ’_cÚf
 *
İts
,

377 
¦ave_·¿ms
 *
·¿ms
, 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix.c

29 
	~"pcm_loÿl.h
"

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<¡ddef.h
>

33 
	~<uni¡d.h
>

34 
	~<sigÇl.h
>

35 
	~<¡ršg.h
>

36 
	~<fú.h
>

37 
	~<ùy³.h
>

38 
	~<g½.h
>

39 
	~<sys/ioùl.h
>

40 
	~<sys/mmª.h
>

41 
	~<sys/shm.h
>

42 
	~<sys/£m.h
>

43 
	~<sys/wa™.h
>

44 
	~<sys/sock‘.h
>

45 
	~<sys/un.h
>

46 
	~<sys/mmª.h
>

47 
	~"pcm_dœeù.h
"

49 #iâdeà
PIC


51 cÚ¡ *
	g_¢d_moduË_pcm_dmix
 = "";

54 #iâdeà
DOC_HIDDEN


56 
	#STATE_RUN_PENDING
 1024

	)

63 
shm_sum_disÿrd
(
¢d_pcm_dœeù_t
 *
dmix
);

68 
	$shm_sum_ü—‹_Ü_cÚÃù
(
¢d_pcm_dœeù_t
 *
dmix
)

70 
shmid_ds
 
buf
;

71 
tmpid
, 
”r
;

72 
size_t
 
size
;

74 
size
 = 
dmix
->
shm±r
->
s
.
chªÃls
 *

75 
dmix
->
shm±r
->
s
.
bufãr_size
 *

77 
»Œyshm
:

78 
dmix
->
u
.dmix.
shmid_sum
 = 
	`shmg‘
(dmix->
c_key
 + 1, 
size
,

79 
IPC_CREAT
 | 
dmix
->
c_³rm
);

80 
”r
 = -
”ºo
;

81 ià(
dmix
->
u
.dmix.
shmid_sum
 < 0) {

82 ià(
”ºo
 =ğ
EINVAL
)

83 ià((
tmpid
 = 
	`shmg‘
(
dmix
->
c_key
 + 1, 0, dmix->
c_³rm
)) != -1)

84 ià(!
	`shmùl
(
tmpid
, 
IPC_STAT
, &
buf
))

85 ià(!
buf
.
shm_Ç‰ch
)

87 ià(!
	`shmùl
(
tmpid
, 
IPC_RMID
, 
NULL
))

88 
»Œyshm
;

89  
”r
;

91 ià(
	`shmùl
(
dmix
->
u
.dmix.
shmid_sum
, 
IPC_STAT
, &
buf
) < 0) {

92 
”r
 = -
”ºo
;

93 
	`shm_sum_disÿrd
(
dmix
);

94  
”r
;

96 ià(
dmix
->
c_gid
 >= 0) {

97 
buf
.
shm_³rm
.
gid
 = 
dmix
->
c_gid
;

98 
	`shmùl
(
dmix
->
u
.dmix.
shmid_sum
, 
IPC_SET
, &
buf
);

100 
dmix
->
u
.dmix.
sum_bufãr
 = 
	`shm©
(dmix->u.dmix.
shmid_sum
, 0, 0);

101 ià(
dmix
->
u
.dmix.
sum_bufãr
 == (*) -1) {

102 
”r
 = -
”ºo
;

103 
	`shm_sum_disÿrd
(
dmix
);

104  
”r
;

106 
	`mlock
(
dmix
->
u
.dmix.
sum_bufãr
, 
size
);

108 
	}
}

110 
	$shm_sum_disÿrd
(
¢d_pcm_dœeù_t
 *
dmix
)

112 
shmid_ds
 
buf
;

113 
»t
 = 0;

115 ià(
dmix
->
u
.dmix.
shmid_sum
 < 0)

116  -
EINVAL
;

117 ià(
dmix
->
u
.dmix.
sum_bufãr
 !ğ(*è-1 && 
	`shmdt
(dmix->u.dmix.sum_buffer) < 0)

118  -
”ºo
;

119 
dmix
->
u
.dmix.
sum_bufãr
 = (*) -1;

120 ià(
	`shmùl
(
dmix
->
u
.dmix.
shmid_sum
, 
IPC_STAT
, &
buf
) < 0)

121  -
”ºo
;

122 ià(
buf
.
shm_Ç‰ch
 == 0) {

123 ià(
	`shmùl
(
dmix
->
u
.dmix.
shmid_sum
, 
IPC_RMID
, 
NULL
) < 0)

124  -
”ºo
;

125 
»t
 = 1;

127 
dmix
->
u
.dmix.
shmid_sum
 = -1;

128  
»t
;

129 
	}
}

131 
	$dmix_£rv”_ä“
(
¢d_pcm_dœeù_t
 *
dmix
)

134 
	`shm_sum_ü—‹_Ü_cÚÃù
(
dmix
);

135 
	`shm_sum_disÿrd
(
dmix
);

136 
	}
}

143 
	~"pcm_dmix_g’”ic.c
"

144 #ià
defšed
(
__i386__
)

145 
	~"pcm_dmix_i386.c
"

146 #–ià
defšed
(
__x86_64__
)

147 
	~"pcm_dmix_x86_64.c
"

149 #iâdeà
DOC_HIDDEN


150 
	#mix_£Ëù_ÿÎbacks
(
x
è
	`g’”ic_mix_£Ëù_ÿÎbacks
(x)

	)

151 
	#dmix_suµÜ‹d_fÜm©
 
g’”ic_dmix_suµÜ‹d_fÜm©


	)

155 
	$mix_¬—s
(
¢d_pcm_dœeù_t
 *
dmix
,

156 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

157 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

158 
¢d_pcm_uäames_t
 
¤c_ofs
,

159 
¢d_pcm_uäames_t
 
d¡_ofs
,

160 
¢d_pcm_uäames_t
 
size
)

162 
¤c_¡•
, 
d¡_¡•
;

163 
chn
, 
dchn
, 
chªÃls
, 
§m¶e_size
;

164 
mix_¬—s_t
 *
do_mix_¬—s
;

166 
chªÃls
 = 
dmix
->channels;

167 
dmix
->
shm±r
->
s
.
fÜm©
) {

168 
SND_PCM_FORMAT_S16_LE
:

169 
SND_PCM_FORMAT_S16_BE
:

170 
§m¶e_size
 = 2;

171 
do_mix_¬—s
 = (
mix_¬—s_t
 *)
dmix
->
u
.dmix.
mix_¬—s_16
;

173 
SND_PCM_FORMAT_S32_LE
:

174 
SND_PCM_FORMAT_S32_BE
:

175 
§m¶e_size
 = 4;

176 
do_mix_¬—s
 = (
mix_¬—s_t
 *)
dmix
->
u
.dmix.
mix_¬—s_32
;

178 
SND_PCM_FORMAT_S24_LE
:

179 
§m¶e_size
 = 4;

180 
do_mix_¬—s
 = (
mix_¬—s_t
 *)
dmix
->
u
.dmix.
mix_¬—s_24
;

182 
SND_PCM_FORMAT_S24_3LE
:

183 
§m¶e_size
 = 3;

184 
do_mix_¬—s
 = (
mix_¬—s_t
 *)
dmix
->
u
.dmix.
mix_¬—s_24
;

186 
SND_PCM_FORMAT_U8
:

187 
§m¶e_size
 = 1;

188 
do_mix_¬—s
 = (
mix_¬—s_t
 *)
dmix
->
u
.dmix.
mix_¬—s_u8
;

193 ià(
dmix
->
š‹¾—ved
) {

198 
	`do_mix_¬—s
(
size
 * 
chªÃls
,

199 (*)
d¡_¬—s
[0].
addr
 + 
§m¶e_size
 * 
d¡_ofs
 * 
chªÃls
,

200 (*)
¤c_¬—s
[0].
addr
 + 
§m¶e_size
 * 
¤c_ofs
 * 
chªÃls
,

201 
dmix
->
u
.dmix.
sum_bufãr
 + 
d¡_ofs
 * 
chªÃls
,

202 
§m¶e_size
,

203 
§m¶e_size
,

207 
chn
 = 0; chÀ< 
chªÃls
; chn++) {

208 
dchn
 = 
dmix
->
bšdšgs
 ? dmix->bšdšgs[
chn
] : chn;

209 ià(
dchn
 >ğ
dmix
->
shm±r
->
s
.
chªÃls
)

211 
¤c_¡•
 = 
¤c_¬—s
[
chn
].
¡•
 / 8;

212 
d¡_¡•
 = 
d¡_¬—s
[
dchn
].
¡•
 / 8;

213 
	`do_mix_¬—s
(
size
,

214 ((*)
d¡_¬—s
[
dchn
].
addr
 + d¡_¬—s[dchn].
fœ¡
 / 8è+ 
d¡_ofs
 * 
d¡_¡•
,

215 ((*)
¤c_¬—s
[
chn
].
addr
 + src_¬—s[chn].
fœ¡
 / 8è+ 
¤c_ofs
 * 
¤c_¡•
,

216 
dmix
->
u
.dmix.
sum_bufãr
 + dmix->
shm±r
->
s
.
chªÃls
 * 
d¡_ofs
 + 
dchn
,

217 
d¡_¡•
,

218 
¤c_¡•
,

219 
dmix
->
shm±r
->
s
.
chªÃls
 * (signed ));

221 
	}
}

223 
	$»mix_¬—s
(
¢d_pcm_dœeù_t
 *
dmix
,

224 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

225 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

226 
¢d_pcm_uäames_t
 
¤c_ofs
,

227 
¢d_pcm_uäames_t
 
d¡_ofs
,

228 
¢d_pcm_uäames_t
 
size
)

230 
¤c_¡•
, 
d¡_¡•
;

231 
chn
, 
dchn
, 
chªÃls
, 
§m¶e_size
;

232 
mix_¬—s_t
 *
do_»mix_¬—s
;

234 
chªÃls
 = 
dmix
->channels;

235 
dmix
->
shm±r
->
s
.
fÜm©
) {

236 
SND_PCM_FORMAT_S16_LE
:

237 
SND_PCM_FORMAT_S16_BE
:

238 
§m¶e_size
 = 2;

239 
do_»mix_¬—s
 = (
mix_¬—s_t
 *)
dmix
->
u
.dmix.
»mix_¬—s_16
;

241 
SND_PCM_FORMAT_S32_LE
:

242 
SND_PCM_FORMAT_S32_BE
:

243 
§m¶e_size
 = 4;

244 
do_»mix_¬—s
 = (
mix_¬—s_t
 *)
dmix
->
u
.dmix.
»mix_¬—s_32
;

246 
SND_PCM_FORMAT_S24_LE
:

247 
§m¶e_size
 = 4;

248 
do_»mix_¬—s
 = (
mix_¬—s_t
 *)
dmix
->
u
.dmix.
»mix_¬—s_24
;

250 
SND_PCM_FORMAT_S24_3LE
:

251 
§m¶e_size
 = 3;

252 
do_»mix_¬—s
 = (
mix_¬—s_t
 *)
dmix
->
u
.dmix.
»mix_¬—s_24
;

254 
SND_PCM_FORMAT_U8
:

255 
§m¶e_size
 = 1;

256 
do_»mix_¬—s
 = (
mix_¬—s_t
 *)
dmix
->
u
.dmix.
»mix_¬—s_u8
;

261 ià(
dmix
->
š‹¾—ved
) {

266 
	`do_»mix_¬—s
(
size
 * 
chªÃls
,

267 (*)
d¡_¬—s
[0].
addr
 + 
§m¶e_size
 * 
d¡_ofs
 * 
chªÃls
,

268 (*)
¤c_¬—s
[0].
addr
 + 
§m¶e_size
 * 
¤c_ofs
 * 
chªÃls
,

269 
dmix
->
u
.dmix.
sum_bufãr
 + 
d¡_ofs
 * 
chªÃls
,

270 
§m¶e_size
,

271 
§m¶e_size
,

275 
chn
 = 0; chÀ< 
chªÃls
; chn++) {

276 
dchn
 = 
dmix
->
bšdšgs
 ? dmix->bšdšgs[
chn
] : chn;

277 ià(
dchn
 >ğ
dmix
->
shm±r
->
s
.
chªÃls
)

279 
¤c_¡•
 = 
¤c_¬—s
[
chn
].
¡•
 / 8;

280 
d¡_¡•
 = 
d¡_¬—s
[
dchn
].
¡•
 / 8;

281 
	`do_»mix_¬—s
(
size
,

282 ((*)
d¡_¬—s
[
dchn
].
addr
 + d¡_¬—s[dchn].
fœ¡
 / 8è+ 
d¡_ofs
 * 
d¡_¡•
,

283 ((*)
¤c_¬—s
[
chn
].
addr
 + src_¬—s[chn].
fœ¡
 / 8è+ 
¤c_ofs
 * 
¤c_¡•
,

284 
dmix
->
u
.dmix.
sum_bufãr
 + dmix->
shm±r
->
s
.
chªÃls
 * 
d¡_ofs
 + 
dchn
,

285 
d¡_¡•
,

286 
¤c_¡•
,

287 
dmix
->
shm±r
->
s
.
chªÃls
 * (signed ));

289 
	}
}

295 #iâdeà
DOC_HIDDEN


296 
	$dmix_down_£m
(
¢d_pcm_dœeù_t
 *
dmix
)

298 ià(
dmix
->
u
.dmix.
u£_£m
)

299 
	`¢d_pcm_dœeù_£m­hÜe_down
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

300 
	}
}

302 
	$dmix_up_£m
(
¢d_pcm_dœeù_t
 *
dmix
)

304 ià(
dmix
->
u
.dmix.
u£_£m
)

305 
	`¢d_pcm_dœeù_£m­hÜe_up
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

306 
	}
}

312 
	$¢d_pcm_dmix_sync_¬—
(
¢d_pcm_t
 *
pcm
)

314 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

315 
¢d_pcm_uäames_t
 
¦ave_hw_±r
, 
¦ave_­¶_±r
, 
¦ave_size
;

316 
¢d_pcm_uäames_t
 
­¶_±r
, 
size
, 
Œªsãr
;

317 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
, *
d¡_¬—s
;

323 
size
 = 
	`pcm_äame_diff2
(
dmix
->
­¶_±r
, dmix->
Ï¡_­¶_±r
, 
pcm
->
bound¬y
);

324 ià(! 
size
)

329 
¦ave_size
 = 
	`pcm_äame_diff
(
dmix
->
¦ave_­¶_±r
, dmix->
¦ave_hw_±r
, dmix->
¦ave_bound¬y
);

330 ià(
¦ave_size
 > 
dmix
->
¦ave_bufãr_size
) {

331 
Œªsãr
 = 
dmix
->
¦ave_bufãr_size
 - 
¦ave_size
;

332 ià(
Œªsãr
 > 
size
)

333 
Œªsãr
 = 
size
;

334 
dmix
->
Ï¡_­¶_±r
 +ğ
Œªsãr
;

335 
dmix
->
Ï¡_­¶_±r
 %ğ
pcm
->
bound¬y
;

336 
dmix
->
¦ave_­¶_±r
 +ğ
Œªsãr
;

337 
dmix
->
¦ave_­¶_±r
 %ğdmix->
¦ave_bound¬y
;

338 
size
 = 
	`pcm_äame_diff2
(
dmix
->
­¶_±r
, dmix->
Ï¡_­¶_±r
, 
pcm
->
bound¬y
);

339 ià(! 
size
)

344 
¦ave_hw_±r
 = 
dmix
->slave_hw_ptr;

348 
¦ave_hw_±r
 -ğ¦ave_hw_±¸% 
dmix
->
¦ave_³riod_size
;

349 
¦ave_hw_±r
 +ğ
dmix
->
¦ave_bufãr_size
;

350 ià(
¦ave_hw_±r
 >ğ
dmix
->
¦ave_bound¬y
)

351 
¦ave_hw_±r
 -ğ
dmix
->
¦ave_bound¬y
;

352 
¦ave_size
 = 
	`pcm_äame_diff
(
¦ave_hw_±r
, 
dmix
->
¦ave_­¶_±r
, dmix->
¦ave_bound¬y
);

353 ià(
¦ave_size
 < 
size
)

354 
size
 = 
¦ave_size
;

355 ià(! 
size
)

359 
¤c_¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

360 
d¡_¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
dmix
->
¥cm
);

361 
­¶_±r
 = 
dmix
->
Ï¡_­¶_±r
 % 
pcm
->
bufãr_size
;

362 
dmix
->
Ï¡_­¶_±r
 +ğ
size
;

363 
dmix
->
Ï¡_­¶_±r
 %ğ
pcm
->
bound¬y
;

364 
¦ave_­¶_±r
 = 
dmix
->¦ave_­¶_±¸% dmix->
¦ave_bufãr_size
;

365 
dmix
->
¦ave_­¶_±r
 +ğ
size
;

366 
dmix
->
¦ave_­¶_±r
 %ğdmix->
¦ave_bound¬y
;

367 
	`dmix_down_£m
(
dmix
);

369 
Œªsãr
 = 
size
;

370 ià(
­¶_±r
 + 
Œªsãr
 > 
pcm
->
bufãr_size
)

371 
Œªsãr
 = 
pcm
->
bufãr_size
 - 
­¶_±r
;

372 ià(
¦ave_­¶_±r
 + 
Œªsãr
 > 
dmix
->
¦ave_bufãr_size
)

373 
Œªsãr
 = 
dmix
->
¦ave_bufãr_size
 - 
¦ave_­¶_±r
;

374 
	`mix_¬—s
(
dmix
, 
¤c_¬—s
, 
d¡_¬—s
, 
­¶_±r
, 
¦ave_­¶_±r
, 
Œªsãr
);

375 
size
 -ğ
Œªsãr
;

376 ià(! 
size
)

378 
¦ave_­¶_±r
 +ğ
Œªsãr
;

379 
¦ave_­¶_±r
 %ğ
dmix
->
¦ave_bufãr_size
;

380 
­¶_±r
 +ğ
Œªsãr
;

381 
­¶_±r
 %ğ
pcm
->
bufãr_size
;

383 
	`dmix_up_£m
(
dmix
);

384 
	}
}

389 
	$¢d_pcm_dmix_sync_±r0
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
¦ave_hw_±r
)

391 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

392 
¢d_pcm_uäames_t
 
Şd_¦ave_hw_±r
, 
ava
;

393 
¢d_pcm_säames_t
 
diff
;

395 
Şd_¦ave_hw_±r
 = 
dmix
->
¦ave_hw_±r
;

396 
dmix
->
¦ave_hw_±r
 = slave_hw_ptr;

397 
diff
 = 
	`pcm_äame_diff
(
¦ave_hw_±r
, 
Şd_¦ave_hw_±r
, 
dmix
->
¦ave_bound¬y
);

398 ià(
diff
 == 0)

400 ià(
dmix
->
¡©e
 !ğ
SND_PCM_STATE_RUNNING
 &&

401 
dmix
->
¡©e
 !ğ
SND_PCM_STATE_DRAINING
)

404 
dmix
->
hw_±r
 +ğ
diff
;

405 
dmix
->
hw_±r
 %ğ
pcm
->
bound¬y
;

406 ià(
pcm
->
¡İ_th»shŞd
 >ğpcm->
bound¬y
)

408 
ava
 = 
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
);

409 ià(
ava
 > 
dmix
->
ava_max
)

410 
dmix
->
ava_max
 = 
ava
;

411 ià(
ava
 >ğ
pcm
->
¡İ_th»shŞd
) {

412 
	`¢d_tim”_¡İ
(
dmix
->
tim”
);

413 
	`g‘time¡amp
(&
dmix
->
Œigg”_t¡amp
, 
pcm
->
t¡amp_ty³
);

414 ià(
dmix
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
) {

415 
dmix
->
¡©e
 = 
SND_PCM_STATE_XRUN
;

416  -
EPIPE
;

418 
dmix
->
¡©e
 = 
SND_PCM_STATE_SETUP
;

420 
	`¢d_pcm_dœeù_ş—r_tim”_queue
(
dmix
);

423 
	}
}

425 
	$¢d_pcm_dmix_sync_±r
(
¢d_pcm_t
 *
pcm
)

427 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

428 
¢d_pcm_uäames_t
 
¦ave_hw_±r
;

429 
”r
;

431 ià(
dmix
->
¦ow±r
)

432 
	`¢d_pcm_hwsync
(
dmix
->
¥cm
);

433 
¦ave_hw_±r
 = *
dmix
->
¥cm
->
hw
.
±r
;

434 
”r
 = 
	`¢d_pcm_dœeù_check_xrun
(
dmix
, 
pcm
);

435 ià(
”r
 < 0)

436  
”r
;

438  
	`¢d_pcm_dmix_sync_±r0
(
pcm
, 
¦ave_hw_±r
);

439 
	}
}

445 
¢d_pcm_¡©e_t
 
	$¢d_pcm_dmix_¡©e
(
¢d_pcm_t
 *
pcm
)

447 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

449 
	`¢d_pcm_dœeù_check_xrun
(
dmix
, 
pcm
);

450 ià(
dmix
->
¡©e
 =ğ
STATE_RUN_PENDING
)

451  
SNDRV_PCM_STATE_RUNNING
;

452  
dmix
->
¡©e
;

453 
	}
}

455 
	$¢d_pcm_dmix_¡©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©us_t
 * 
¡©us
)

457 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

459 
	`mem£t
(
¡©us
, 0, (*status));

460 
	`¢d_pcm_¡©us
(
dmix
->
¥cm
, 
¡©us
);

462 
dmix
->
¡©e
) {

463 
SNDRV_PCM_STATE_DRAINING
:

464 
SNDRV_PCM_STATE_RUNNING
:

465 
	`¢d_pcm_dmix_sync_±r0
(
pcm
, 
¡©us
->
hw_±r
);

466 
¡©us
->
d–ay
 = 
	`¢d_pcm_mm­_¶ayback_d–ay
(
pcm
);

472 
¡©us
->
¡©e
 = 
	`¢d_pcm_dmix_¡©e
(
pcm
);

473 
¡©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

474 
¡©us
->
­¶_±r
 = *
pcm
->
­¶
.
±r
;

475 
¡©us
->
Œigg”_t¡amp
 = 
dmix
->trigger_tstamp;

476 
¡©us
->
ava
 = 
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
);

477 
¡©us
->
ava_max
 = stus->
ava
 > 
dmix
->avail_max ? status->avail : dmix->avail_max;

478 
dmix
->
ava_max
 = 0;

480 
	}
}

482 
	$¢d_pcm_dmix_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
)

484 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

485 
”r
;

487 
dmix
->
¡©e
) {

488 
SNDRV_PCM_STATE_DRAINING
:

489 
SNDRV_PCM_STATE_RUNNING
:

490 
”r
 = 
	`¢d_pcm_dmix_sync_±r
(
pcm
);

491 ià(
”r
 < 0)

492  
”r
;

494 
SNDRV_PCM_STATE_PREPARED
:

495 
SNDRV_PCM_STATE_SUSPENDED
:

496 
STATE_RUN_PENDING
:

497 *
d–ayp
 = 
	`¢d_pcm_mm­_¶ayback_d–ay
(
pcm
);

499 
SNDRV_PCM_STATE_XRUN
:

500  -
EPIPE
;

501 
SNDRV_PCM_STATE_DISCONNECTED
:

502  -
ENODEV
;

504  -
EBADFD
;

506 
	}
}

508 
	$¢d_pcm_dmix_hwsync
(
¢d_pcm_t
 *
pcm
)

510 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

512 
dmix
->
¡©e
) {

513 
SNDRV_PCM_STATE_DRAINING
:

514 
SNDRV_PCM_STATE_RUNNING
:

516  
	`¢d_pcm_dmix_sync_±r
(
pcm
);

517 
SNDRV_PCM_STATE_PREPARED
:

518 
SNDRV_PCM_STATE_SUSPENDED
:

519 
STATE_RUN_PENDING
:

521 
SNDRV_PCM_STATE_XRUN
:

522  -
EPIPE
;

523 
SNDRV_PCM_STATE_DISCONNECTED
:

524  -
ENODEV
;

526  -
EBADFD
;

528 
	}
}

530 
	$¢d_pcm_dmix_»£t
(
¢d_pcm_t
 *
pcm
)

532 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

533 
dmix
->
hw_±r
 %ğ
pcm
->
³riod_size
;

534 
dmix
->
­¶_±r
 = dmix->
Ï¡_­¶_±r
 = dmix->
hw_±r
;

535 
	`¢d_pcm_dœeù_»£t_¦ave_±r
(
pcm
, 
dmix
, *dmix->
¥cm
->
hw
.
±r
);

537 
	}
}

539 
	$¢d_pcm_dmix_¡¬t_tim”
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_dœeù_t
 *
dmix
)

541 
”r
;

543 
	`¢d_pcm_hwsync
(
dmix
->
¥cm
);

544 
	`¢d_pcm_dœeù_»£t_¦ave_±r
(
pcm
, 
dmix
, *dmix->
¥cm
->
hw
.
±r
);

545 
”r
 = 
	`¢d_tim”_¡¬t
(
dmix
->
tim”
);

546 ià(
”r
 < 0)

547  
”r
;

548 
dmix
->
¡©e
 = 
SND_PCM_STATE_RUNNING
;

550 
	}
}

552 
	$¢d_pcm_dmix_¡¬t
(
¢d_pcm_t
 *
pcm
)

554 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

555 
¢d_pcm_säames_t
 
ava
;

556 
”r
;

558 ià(
dmix
->
¡©e
 !ğ
SND_PCM_STATE_PREPARED
)

559  -
EBADFD
;

560 
ava
 = 
	`¢d_pcm_mm­_¶ayback_hw_ava
(
pcm
);

561 ià(
ava
 == 0)

562 
dmix
->
¡©e
 = 
STATE_RUN_PENDING
;

563 ià(
ava
 < 0)

566 ià((
”r
 = 
	`¢d_pcm_dmix_¡¬t_tim”
(
pcm
, 
dmix
)) < 0)

567  
”r
;

568 
	`¢d_pcm_dmix_sync_¬—
(
pcm
);

570 
	`g‘time¡amp
(&
dmix
->
Œigg”_t¡amp
, 
pcm
->
t¡amp_ty³
);

572 
	}
}

574 
	$¢d_pcm_dmix_drİ
(
¢d_pcm_t
 *
pcm
)

576 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

577 ià(
dmix
->
¡©e
 =ğ
SND_PCM_STATE_OPEN
)

578  -
EBADFD
;

579 
dmix
->
¡©e
 = 
SND_PCM_STATE_SETUP
;

580 
	`¢d_pcm_dœeù_tim”_¡İ
(
dmix
);

582 
	}
}

585 
	$__¢d_pcm_dmix_d¿š
(
¢d_pcm_t
 *
pcm
)

587 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

588 
¢d_pcm_uäames_t
 
¡İ_th»shŞd
;

589 
”r
 = 0;

591 
	`¢d_pcm_¡©e
(
dmix
->
¥cm
)) {

592 
SND_PCM_STATE_SUSPENDED
:

593  -
ESTRPIPE
;

598 ià(
dmix
->
¡©e
 =ğ
SND_PCM_STATE_OPEN
)

599  -
EBADFD
;

600 ià(
dmix
->
¡©e
 =ğ
SND_PCM_STATE_PREPARED
) {

601 ià(
	`¢d_pcm_mm­_¶ayback_hw_ava
(
pcm
) > 0)

602 
	`¢d_pcm_dmix_¡¬t
(
pcm
);

604 
	`¢d_pcm_dmix_drİ
(
pcm
);

609 ià(
dmix
->
¡©e
 =ğ
SND_PCM_STATE_XRUN
) {

610 
	`¢d_pcm_dmix_drİ
(
pcm
);

614 
¡İ_th»shŞd
 = 
pcm
->stop_threshold;

615 ià(
pcm
->
¡İ_th»shŞd
 >…cm->
bufãr_size
)

616 
pcm
->
¡İ_th»shŞd
 =…cm->
bufãr_size
;

617 
dmix
->
¡©e
 = 
SND_PCM_STATE_DRAINING
;

619 
”r
 = 
	`¢d_pcm_dmix_sync_±r
(
pcm
);

620 ià(
”r
 < 0) {

621 
	`¢d_pcm_dmix_drİ
(
pcm
);

622 
dÚe
;

624 ià(
dmix
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
) {

625 
	`¢d_pcm_dmix_sync_¬—
(
pcm
);

626 ià((
pcm
->
mode
 & 
SND_PCM_NONBLOCK
) == 0) {

627 
	`¢d_pcm_wa™_nocheck
(
pcm
, 
SND_PCM_WAIT_DRAIN
);

628 
	`¢d_pcm_dœeù_ş—r_tim”_queue
(
dmix
);

631 
	`¢d_pcm_¡©e
(
dmix
->
¥cm
)) {

632 
SND_PCM_STATE_SUSPENDED
:

633 
”r
 = -
ESTRPIPE
;

634 
dÚe
;

639 ià(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
) {

640 ià(
dmix
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
) {

641 
”r
 = -
EAGAIN
;

642 
dÚe
;

645 } 
dmix
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
);

646 
dÚe
:

647 
pcm
->
¡İ_th»shŞd
 = stop_threshold;

648  
”r
;

649 
	}
}

651 
	$¢d_pcm_dmix_d¿š
(
¢d_pcm_t
 *
pcm
)

653 
”r
;

655 
	`¢d_pcm_lock
(
pcm
);

656 
”r
 = 
	`__¢d_pcm_dmix_d¿š
(
pcm
);

657 
	`¢d_pcm_uÆock
(
pcm
);

658  
”r
;

659 
	}
}

661 
	$¢d_pcm_dmix_·u£
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
’abË
 ATTRIBUTE_UNUSED)

663  -
EIO
;

664 
	}
}

666 
¢d_pcm_säames_t
 
	$¢d_pcm_dmix_»wšdabË
(
¢d_pcm_t
 *
pcm
)

668  
	`¢d_pcm_mm­_¶ayback_hw_»wšdabË
(
pcm
);

669 
	}
}

671 
¢d_pcm_säames_t
 
	$¢d_pcm_dmix_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

673 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

674 
¢d_pcm_uäames_t
 
¦ave_­¶_±r
, 
¦ave_size
;

675 
¢d_pcm_uäames_t
 
­¶_±r
, 
size
, 
Œªsãr
, 
»suÉ
, 
äames_to_»mix
;

676 
”r
;

677 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
, *
d¡_¬—s
;

679 ià(
dmix
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
 ||

680 
dmix
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
) {

681 
”r
 = 
	`¢d_pcm_dmix_hwsync
(
pcm
);

682 ià(
”r
 < 0)

683  
”r
;

693 
size
 = 
	`pcm_äame_diff
(
dmix
->
Ï¡_­¶_±r
, dmix->
­¶_±r
, 
pcm
->
bound¬y
);

694 ià(
äames
 < 
size
)

695 
size
 = 
äames
;

696 
	`¢d_pcm_mm­_­¶_backw¬d
(
pcm
, 
size
);

697 
äames
 -ğ
size
;

698 ià(!
äames
)

699  
size
;

700 
»suÉ
 = 
size
;

705 
size
 = 
	`pcm_äame_diff
(
dmix
->
­¶_±r
, dmix->
hw_±r
, 
pcm
->
bound¬y
);

706 ià(
size
 > 
äames
)

707 
size
 = 
äames
;

708 
¦ave_size
 = 
	`pcm_äame_diff
(
dmix
->
¦ave_­¶_±r
, dmix->
¦ave_hw_±r
, 
pcm
->
bound¬y
);

709 ià(
¦ave_size
 < 
size
)

710 
size
 = 
¦ave_size
;

715 
äames_to_»mix
 = 
size
;

718 
¤c_¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

719 
d¡_¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
dmix
->
¥cm
);

720 
dmix
->
Ï¡_­¶_±r
 -ğ
size
;

721 
dmix
->
Ï¡_­¶_±r
 %ğ
pcm
->
bound¬y
;

722 
­¶_±r
 = 
dmix
->
Ï¡_­¶_±r
 % 
pcm
->
bufãr_size
;

723 
dmix
->
¦ave_­¶_±r
 -ğ
size
;

724 
dmix
->
¦ave_­¶_±r
 %ğdmix->
¦ave_bound¬y
;

725 
¦ave_­¶_±r
 = 
dmix
->¦ave_­¶_±¸% dmix->
¦ave_bufãr_size
;

726 
	`dmix_down_£m
(
dmix
);

728 
Œªsãr
 = 
size
;

729 ià(
­¶_±r
 + 
Œªsãr
 > 
pcm
->
bufãr_size
)

730 
Œªsãr
 = 
pcm
->
bufãr_size
 - 
­¶_±r
;

731 ià(
¦ave_­¶_±r
 + 
Œªsãr
 > 
dmix
->
¦ave_bufãr_size
)

732 
Œªsãr
 = 
dmix
->
¦ave_bufãr_size
 - 
¦ave_­¶_±r
;

733 
	`»mix_¬—s
(
dmix
, 
¤c_¬—s
, 
d¡_¬—s
, 
­¶_±r
, 
¦ave_­¶_±r
, 
Œªsãr
);

734 
size
 -ğ
Œªsãr
;

735 ià(! 
size
)

737 
¦ave_­¶_±r
 +ğ
Œªsãr
;

738 
¦ave_­¶_±r
 %ğ
dmix
->
¦ave_bufãr_size
;

739 
­¶_±r
 +ğ
Œªsãr
;

740 
­¶_±r
 %ğ
pcm
->
bufãr_size
;

742 
	`dmix_up_£m
(
dmix
);

744 
	`¢d_pcm_mm­_­¶_backw¬d
(
pcm
, 
äames_to_»mix
);

745 
»suÉ
 +ğ
äames_to_»mix
;

750  
»suÉ
;

751 
	}
}

753 
¢d_pcm_säames_t
 
	$¢d_pcm_dmix_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
)

755  
	`¢d_pcm_mm­_ava
(
pcm
);

756 
	}
}

758 
¢d_pcm_säames_t
 
	$¢d_pcm_dmix_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

760 
¢d_pcm_säames_t
 
ava
;

762 
ava
 = 
	`¢d_pcm_dmix_fÜw¬dabË
(
pcm
);

763 ià(
äames
 > (
¢d_pcm_uäames_t
)
ava
)

764 
äames
 = 
ava
;

765 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
äames
);

766  
äames
;

767 
	}
}

769 
¢d_pcm_säames_t
 
	$¢d_pcm_dmix_»adi
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, *
bufãr
 ATTRIBUTE_UNUSED, 
¢d_pcm_uäames_t
 
size
 ATTRIBUTE_UNUSED)

771  -
ENODEV
;

772 
	}
}

774 
¢d_pcm_säames_t
 
	$¢d_pcm_dmix_»adn
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, **
bufs
 ATTRIBUTE_UNUSED, 
¢d_pcm_uäames_t
 
size
 ATTRIBUTE_UNUSED)

776  -
ENODEV
;

777 
	}
}

779 
	$¢d_pcm_dmix_şo£
(
¢d_pcm_t
 *
pcm
)

781 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

783 ià(
dmix
->
tim”
)

784 
	`¢d_tim”_şo£
(
dmix
->
tim”
);

785 
	`¢d_pcm_dœeù_£m­hÜe_down
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

786 
	`¢d_pcm_şo£
(
dmix
->
¥cm
);

787 ià(
dmix
->
£rv”
)

788 
	`¢d_pcm_dœeù_£rv”_disÿrd
(
dmix
);

789 ià(
dmix
->
ş›Á
)

790 
	`¢d_pcm_dœeù_ş›Á_disÿrd
(
dmix
);

791 
	`shm_sum_disÿrd
(
dmix
);

792 ià(
	`¢d_pcm_dœeù_shm_disÿrd
(
dmix
)) {

793 ià(
	`¢d_pcm_dœeù_£m­hÜe_disÿrd
(
dmix
))

794 
	`¢d_pcm_dœeù_£m­hÜe_fš®
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

796 
	`¢d_pcm_dœeù_£m­hÜe_fš®
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

797 
	`ä“
(
dmix
->
bšdšgs
);

798 
pcm
->
´iv©e_d©a
 = 
NULL
;

799 
	`ä“
(
dmix
);

801 
	}
}

803 
¢d_pcm_säames_t
 
	$¢d_pcm_dmix_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

804 
¢d_pcm_uäames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

805 
¢d_pcm_uäames_t
 
size
)

807 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

808 
”r
;

810 
”r
 = 
	`¢d_pcm_dœeù_check_xrun
(
dmix
, 
pcm
);

811 ià(
”r
 < 0)

812  
”r
;

813 ià(! 
size
)

815 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
size
);

816 ià(
dmix
->
¡©e
 =ğ
STATE_RUN_PENDING
) {

817 ià((
”r
 = 
	`¢d_pcm_dmix_¡¬t_tim”
(
pcm
, 
dmix
)) < 0)

818  
”r
;

819 } ià(
dmix
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
 ||

820 
dmix
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
) {

821 ià((
”r
 = 
	`¢d_pcm_dmix_sync_±r
(
pcm
)) < 0)

822  
”r
;

824 ià(
dmix
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
 ||

825 
dmix
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
) {

828 
	`¢d_pcm_dmix_sync_¬—
(
pcm
);

830 ià(
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
è<…cm->
ava_mš
)

831 
	`¢d_pcm_dœeù_ş—r_tim”_queue
(
dmix
);

833  
size
;

834 
	}
}

836 
¢d_pcm_säames_t
 
	$¢d_pcm_dmix_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

838 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

839 
”r
;

841 ià(
dmix
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
 ||

842 
dmix
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
) {

843 ià((
”r
 = 
	`¢d_pcm_dmix_sync_±r
(
pcm
)) < 0)

844  
”r
;

846 ià(
dmix
->
¡©e
 =ğ
SND_PCM_STATE_XRUN
)

847  -
EPIPE
;

849  
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
);

850 
	}
}

852 
	$¢d_pcm_dmix_htime¡amp
(
¢d_pcm_t
 *
pcm
,

853 
¢d_pcm_uäames_t
 *
ava
,

854 
¢d_htime¡amp_t
 *
t¡amp
)

856 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

857 
¢d_pcm_uäames_t
 
ava1
;

858 
ok
 = 0;

861 ià(
dmix
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
 ||

862 
dmix
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
)

863 
	`¢d_pcm_dmix_sync_±r
(
pcm
);

864 
ava1
 = 
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
);

865 ià(
ok
 && *
ava
 =ğ
ava1
)

867 *
ava
 = 
ava1
;

868 *
t¡amp
 = 
	`¢d_pcm_hw_ç¡_t¡amp
(
dmix
->
¥cm
);

869 
ok
 = 1;

872 
	}
}

874 
	$¢d_pcm_dmix_pŞl_»v’ts
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

876 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

877 ià(
dmix
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
)

878 
	`¢d_pcm_dmix_sync_¬—
(
pcm
);

879  
	`¢d_pcm_dœeù_pŞl_»v’ts
(
pcm
, 
pfds
, 
nfds
, 
»v’ts
);

880 
	}
}

883 
	$¢d_pcm_dmix_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

885 
¢d_pcm_dœeù_t
 *
dmix
 = 
pcm
->
´iv©e_d©a
;

887 
	`¢d_ouut_´štf
(
out
, "Direct Stream Mixing PCM\n");

888 ià(
pcm
->
£tup
) {

889 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

890 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

892 ià(
dmix
->
¥cm
)

893 
	`¢d_pcm_dump
(
dmix
->
¥cm
, 
out
);

894 
	}
}

896 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_dmix_İs
 = {

897 .
şo£
 = 
¢d_pcm_dmix_şo£
,

898 .
	gšfo
 = 
¢d_pcm_dœeù_šfo
,

899 .
	ghw_»fše
 = 
¢d_pcm_dœeù_hw_»fše
,

900 .
	ghw_·¿ms
 = 
¢d_pcm_dœeù_hw_·¿ms
,

901 .
	ghw_ä“
 = 
¢d_pcm_dœeù_hw_ä“
,

902 .
	gsw_·¿ms
 = 
¢d_pcm_dœeù_sw_·¿ms
,

903 .
	gchªÃl_šfo
 = 
¢d_pcm_dœeù_chªÃl_šfo
,

904 .
	gdump
 = 
¢d_pcm_dmix_dump
,

905 .
	gnÚblock
 = 
¢d_pcm_dœeù_nÚblock
,

906 .
	gasync
 = 
¢d_pcm_dœeù_async
,

907 .
	gmm­
 = 
¢d_pcm_dœeù_mm­
,

908 .
	gmunm­
 = 
¢d_pcm_dœeù_munm­
,

909 .
	gqu”y_chm­s
 = 
¢d_pcm_dœeù_qu”y_chm­s
,

910 .
	gg‘_chm­
 = 
¢d_pcm_dœeù_g‘_chm­
,

911 .
	g£t_chm­
 = 
¢d_pcm_dœeù_£t_chm­
,

914 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_dmix_ç¡_İs
 = {

915 .
¡©us
 = 
¢d_pcm_dmix_¡©us
,

916 .
	g¡©e
 = 
¢d_pcm_dmix_¡©e
,

917 .
	ghwsync
 = 
¢d_pcm_dmix_hwsync
,

918 .
	gd–ay
 = 
¢d_pcm_dmix_d–ay
,

919 .
	g´•¬e
 = 
¢d_pcm_dœeù_´•¬e
,

920 .
	g»£t
 = 
¢d_pcm_dmix_»£t
,

921 .
	g¡¬t
 = 
¢d_pcm_dmix_¡¬t
,

922 .
	gdrİ
 = 
¢d_pcm_dmix_drİ
,

923 .
	gd¿š
 = 
¢d_pcm_dmix_d¿š
,

924 .
	g·u£
 = 
¢d_pcm_dmix_·u£
,

925 .
	g»wšdabË
 = 
¢d_pcm_dmix_»wšdabË
,

926 .
	g»wšd
 = 
¢d_pcm_dmix_»wšd
,

927 .
	gfÜw¬dabË
 = 
¢d_pcm_dmix_fÜw¬dabË
,

928 .
	gfÜw¬d
 = 
¢d_pcm_dmix_fÜw¬d
,

929 .
	g»sume
 = 
¢d_pcm_dœeù_»sume
,

930 .
	glšk
 = 
NULL
,

931 .
	glšk_¦aves
 = 
NULL
,

932 .
	guÆšk
 = 
NULL
,

933 .
	gwr™ei
 = 
¢d_pcm_mm­_wr™ei
,

934 .
	gwr™’
 = 
¢d_pcm_mm­_wr™’
,

935 .
	g»adi
 = 
¢d_pcm_dmix_»adi
,

936 .
	g»adn
 = 
¢d_pcm_dmix_»adn
,

937 .
	gava_upd©e
 = 
¢d_pcm_dmix_ava_upd©e
,

938 .
	gmm­_comm™
 = 
¢d_pcm_dmix_mm­_comm™
,

939 .
	ghtime¡amp
 = 
¢d_pcm_dmix_htime¡amp
,

940 .
	gpŞl_desütÜs
 = 
¢d_pcm_dœeù_pŞl_desütÜs
,

941 .
	gpŞl_desütÜs_couÁ
 = 
NULL
,

942 .
	gpŞl_»v’ts
 = 
¢d_pcm_dmix_pŞl_»v’ts
,

960 
	$¢d_pcm_dmix_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

961 
¢d_pcm_dœeù_İ’_cÚf
 *
İts
,

962 
¦ave_·¿ms
 *
·¿ms
,

963 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
scÚf
,

964 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

966 
¢d_pcm_t
 *
pcm
, *
¥cm
 = 
NULL
;

967 
¢d_pcm_dœeù_t
 *
dmix
;

968 
»t
, 
fœ¡_š¡ªû
;

970 
	`as£¹
(
pcmp
);

972 ià(
¡»am
 !ğ
SND_PCM_STREAM_PLAYBACK
) {

973 
	`SNDERR
("The dmix…lugin supports only…layback stream");

974  -
EINVAL
;

977 
»t
 = 
	`_¢d_pcm_dœeù_Ãw
(&
pcm
, &
dmix
, 
SND_PCM_TYPE_DMIX
, 
Çme
, 
İts
, 
·¿ms
, 
¡»am
, 
mode
);

978 ià(
»t
 < 0)

979  
»t
;

980 
fœ¡_š¡ªû
 = 
»t
;

982 
pcm
->
İs
 = &
¢d_pcm_dmix_İs
;

983 
pcm
->
ç¡_İs
 = &
¢d_pcm_dmix_ç¡_İs
;

984 
pcm
->
´iv©e_d©a
 = 
dmix
;

985 
dmix
->
¡©e
 = 
SND_PCM_STATE_OPEN
;

986 
dmix
->
¦ow±r
 = 
İts
->slowptr;

987 
dmix
->
max_³riods
 = 
İts
->max_periods;

988 
dmix
->
v¬_³riodsize
 = 
İts
->var_periodsize;

989 
dmix
->
hw_±r_®ignm’t
 = 
İts
->hw_ptr_alignment;

990 
dmix
->
sync_±r
 = 
¢d_pcm_dmix_sync_±r
;

991 
dmix
->
dœeù_memÜy_acûss
 = 
İts
->direct_memory_access;

993 
»Œy
:

994 ià(
fœ¡_š¡ªû
) {

997 
»t
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
,

998 
mode
 | 
SND_PCM_NONBLOCK
, 
NULL
);

999 ià(
»t
 < 0) {

1000 
	`SNDERR
("unableo open slave");

1001 
_”r
;

1004 ià(
	`¢d_pcm_ty³
(
¥cm
è!ğ
SND_PCM_TYPE_HW
) {

1005 
	`SNDERR
("dmix…lugin can be only connectedo hw…lugin");

1006 
»t
 = -
EINVAL
;

1007 
_”r
;

1010 
»t
 = 
	`¢d_pcm_dœeù_š™Ÿlize_¦ave
(
dmix
, 
¥cm
, 
·¿ms
);

1011 ià(
»t
 < 0) {

1012 
	`SNDERR
("unableo initialize slave");

1013 
_”r
;

1016 
dmix
->
¥cm
 = spcm;

1018 ià(
dmix
->
shm±r
->
u£_£rv”
) {

1019 
dmix
->
£rv”_ä“
 = 
dmix_£rv”_ä“
;

1021 
»t
 = 
	`¢d_pcm_dœeù_£rv”_ü—‹
(
dmix
);

1022 ià(
»t
 < 0) {

1023 
	`SNDERR
("unableo create server");

1024 
_”r
;

1028 
dmix
->
shm±r
->
ty³
 = 
¥cm
->type;

1030 ià(
dmix
->
shm±r
->
u£_£rv”
) {

1032 
	`¢d_pcm_dœeù_£m­hÜe_up
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

1033 
»t
 = 
	`¢d_pcm_dœeù_ş›Á_cÚÃù
(
dmix
);

1034 ià(
»t
 < 0) {

1035 
	`SNDERR
("unableo connect client");

1036 
_”r_no£m
;

1039 
	`¢d_pcm_dœeù_£m­hÜe_down
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

1040 
»t
 = 
	`¢d_pcm_dœeù_İ’_£cÚd¬y_ş›Á
(&
¥cm
, 
dmix
, "dmix_client");

1041 ià(
»t
 < 0)

1042 
_”r
;

1045 
»t
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
,

1046 
mode
 | 
SND_PCM_NONBLOCK
 |

1047 
SND_PCM_APPEND
,

1048 
NULL
);

1049 ià(
»t
 < 0) {

1053 ià(
»t
 =ğ-
EBADFD
) {

1054 
fœ¡_š¡ªû
 = 1;

1055 
»Œy
;

1057 
	`SNDERR
("unableo open slave");

1058 
_”r
;

1060 ià(
	`¢d_pcm_ty³
(
¥cm
è!ğ
SND_PCM_TYPE_HW
) {

1061 
	`SNDERR
("dmix…lugin can be only connectedo hw…lugin");

1062 
»t
 = -
EINVAL
;

1063 
_”r
;

1066 
»t
 = 
	`¢d_pcm_dœeù_š™Ÿlize_£cÚd¬y_¦ave
(
dmix
, 
¥cm
, 
·¿ms
);

1067 ià(
»t
 < 0) {

1068 
	`SNDERR
("unableo initialize slave");

1069 
_”r
;

1073 
dmix
->
¥cm
 = spcm;

1076 
»t
 = 
	`shm_sum_ü—‹_Ü_cÚÃù
(
dmix
);

1077 ià(
»t
 < 0) {

1078 
	`SNDERR
("unableo initialize sum„ing buffer");

1079 
_”r
;

1082 
»t
 = 
	`¢d_pcm_dœeù_š™Ÿlize_pŞl_fd
(
dmix
);

1083 ià(
»t
 < 0) {

1084 
	`SNDERR
("unableo initialize…oll_fd");

1085 
_”r
;

1088 
	`mix_£Ëù_ÿÎbacks
(
dmix
);

1090 
pcm
->
pŞl_fd
 = 
dmix
->poll_fd;

1091 
pcm
->
pŞl_ev’ts
 = 
POLLIN
;

1092 
pcm
->
t¡amp_ty³
 = 
¥cm
->tstamp_type;

1093 
pcm
->
mm­_rw
 = 1;

1094 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
dmix
->
hw_±r
, -1, 0);

1095 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
dmix
->
­¶_±r
, -1, 0);

1097 ià(
dmix
->
chªÃls
 =ğ
UINT_MAX
)

1098 
dmix
->
chªÃls
 = dmix->
shm±r
->
s
.channels;

1100 
	`¢d_pcm_dœeù_£m­hÜe_up
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

1102 *
pcmp
 = 
pcm
;

1105 
_”r
:

1106 ià(
dmix
->
tim”
)

1107 
	`¢d_tim”_şo£
(
dmix
->
tim”
);

1108 ià(
dmix
->
£rv”
)

1109 
	`¢d_pcm_dœeù_£rv”_disÿrd
(
dmix
);

1110 ià(
dmix
->
ş›Á
)

1111 
	`¢d_pcm_dœeù_ş›Á_disÿrd
(
dmix
);

1112 ià(
¥cm
)

1113 
	`¢d_pcm_şo£
(
¥cm
);

1114 ià(
dmix
->
u
.dmix.
shmid_sum
 >= 0)

1115 
	`shm_sum_disÿrd
(
dmix
);

1116 ià((
dmix
->
shmid
 >ğ0è&& (
	`¢d_pcm_dœeù_shm_disÿrd
(dmix))) {

1117 ià(
	`¢d_pcm_dœeù_£m­hÜe_disÿrd
(
dmix
))

1118 
	`¢d_pcm_dœeù_£m­hÜe_fš®
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

1120 
	`¢d_pcm_dœeù_£m­hÜe_up
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

1121 
_”r_no£m
:

1122 
	`ä“
(
dmix
->
bšdšgs
);

1123 
	`ä“
(
dmix
);

1124 
	`¢d_pcm_ä“
(
pcm
);

1125  
»t
;

1126 
	}
}

1285 
	$_¢d_pcm_dmix_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1286 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

1287 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

1289 
¢d_cÚfig_t
 *
scÚf
;

1290 
¦ave_·¿ms
 
·¿ms
;

1291 
¢d_pcm_dœeù_İ’_cÚf
 
dİ’
;

1292 
bsize
, 
psize
;

1293 
”r
;

1295 
”r
 = 
	`¢d_pcm_dœeù_·r£_İ’_cÚf
(
roÙ
, 
cÚf
, 
¡»am
, &
dİ’
);

1296 ià(
”r
 < 0)

1297  
”r
;

1300 
·¿ms
.
fÜm©
 = 
SND_PCM_FORMAT_S16
;

1301 
·¿ms
.
¿‹
 = 48000;

1302 
·¿ms
.
chªÃls
 = 2;

1303 
·¿ms
.
³riod_time
 = -1;

1304 
·¿ms
.
bufãr_time
 = -1;

1305 
bsize
 = 
psize
 = -1;

1306 
·¿ms
.
³riods
 = 3;

1308 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
dİ’
.
¦ave
, &
scÚf
, 8,

1309 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_UNCHANGED
, &
·¿ms
.
fÜm©
,

1310 
SND_PCM_HW_PARAM_RATE
, 0, &
·¿ms
.
¿‹
,

1311 
SND_PCM_HW_PARAM_CHANNELS
, 0, &
·¿ms
.
chªÃls
,

1312 
SND_PCM_HW_PARAM_PERIOD_TIME
, 0, &
·¿ms
.
³riod_time
,

1313 
SND_PCM_HW_PARAM_BUFFER_TIME
, 0, &
·¿ms
.
bufãr_time
,

1314 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 0, &
psize
,

1315 
SND_PCM_HW_PARAM_BUFFER_SIZE
, 0, &
bsize
,

1316 
SND_PCM_HW_PARAM_PERIODS
, 0, &
·¿ms
.
³riods
);

1317 ià(
”r
 < 0)

1318  
”r
;

1321 ià(
psize
 =ğ-1 && 
·¿ms
.
³riod_time
 == -1)

1322 
·¿ms
.
³riod_time
 = 125000;

1324 ià(
·¿ms
.
fÜm©
 == -2)

1325 
·¿ms
.
fÜm©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1326 ià(!(
dmix_suµÜ‹d_fÜm©
 & (1ULL << 
·¿ms
.
fÜm©
))) {

1328 
	`SNDERR
("Unsupported format");

1329 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1330  -
EINVAL
;

1333 
·¿ms
.
³riod_size
 = 
psize
;

1334 
·¿ms
.
bufãr_size
 = 
bsize
;

1336 
”r
 = 
	`¢d_pcm_dmix_İ’
(
pcmp
, 
Çme
, &
dİ’
, &
·¿ms
,

1337 
roÙ
, 
scÚf
, 
¡»am
, 
mode
);

1338 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1339  
”r
;

1340 
	}
}

1341 #iâdeà
DOC_HIDDEN


1342 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_dmix_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_generic.c

3 
	#LOCK_PREFIX
 "lock ; "

	)

4 
	#ARCH_ADD
(
p
,
a
) \

5 
__asm__
 
	`__vŞ©e__
(
LOCK_PREFIX
 "addl %1,%0" \

6 :"=m" (*
p
) \

7 :"œ" (
a
), "m" (*
p
))

	)

8 
	s__xchg_dummy
 { 
	ma
[100]; };

9 
	#__xg
(
x
è((
__xchg_dummy
 *)(x))

	)

10 
šlše
 
	$__cmpxchg
(vŞ©*
±r
, 
Şd
,

11 
Ãw
, 
size
)

13 
´ev
;

14 
size
) {

16 
__asm__
 
	`__vŞ©e__
(
LOCK_PREFIX
 "cmpxchgb %b1,%2"

17 : "÷"(
´ev
)

18 : "q"(
Ãw
), "m"(*
	`__xg
(
±r
)), "0"(
Şd
)

20  
´ev
;

22 
__asm__
 
	`__vŞ©e__
(
LOCK_PREFIX
 "cmpxchgw %w1,%2"

23 : "÷"(
´ev
)

24 : "q"(
Ãw
), "m"(*
	`__xg
(
±r
)), "0"(
Şd
)

26  
´ev
;

28 
__asm__
 
	`__vŞ©e__
(
LOCK_PREFIX
 "cmpxchgl %1,%2"

29 : "÷"(
´ev
)

30 : "q"(
Ãw
), "m"(*
	`__xg
(
±r
)), "0"(
Şd
)

32  
´ev
;

34  
Şd
;

35 
	}
}

37 
	#ARCH_CMPXCHG
(
±r
,
o
,
n
)\

38 ((
	`__ty³of__
(*(
±r
)))
	`__cmpxchg
(ÕŒ),()(
o
),\

39 ()(
n
),(*(
±r
))))

	)

40 
	#IS_CONCURRENT
 1

	)

43 #iâdeà
ARCH_ADD


44 
	#ARCH_ADD
(
p
,
a
è(*Õè+ğ×))

	)

45 
	#ARCH_CMPXCHG
(
p
,
a
,
b
è(*Õ)è

	)

46 
	#IS_CONCURRENT
 0

	)

49 #ià
IS_CONCURRENT


50 
	$mix_¬—s_16
(
size
,

51 vŞ©sigÃd *
d¡
, sigÃd *
¤c
,

52 vŞ©sigÃd *
sum
, 
size_t
 
d¡_¡•
,

53 
size_t
 
¤c_¡•
, size_ˆ
sum_¡•
)

55 sigÃd 
§m¶e
, 
Şd_§m¶e
;

58 
§m¶e
 = *
¤c
;

59 
Şd_§m¶e
 = *
sum
;

60 ià(
	`ARCH_CMPXCHG
(
d¡
, 0, 1) == 0)

61 
§m¶e
 -ğ
Şd_§m¶e
;

62 
	`ARCH_ADD
(
sum
, 
§m¶e
);

64 
Şd_§m¶e
 = *
sum
;

65 ià(
Şd_§m¶e
 > 0x7fff)

66 
§m¶e
 = 0x7fff;

67 ià(
Şd_§m¶e
 < -0x8000)

68 
§m¶e
 = -0x8000;

70 
§m¶e
 = 
Şd_§m¶e
;

71 *
d¡
 = 
§m¶e
;

72 } 
IS_CONCURRENT
 && *
sum
 !ğ
Şd_§m¶e
);

73 ià(!--
size
)

75 
¤c
 = (sigÃd *è((*)¤ø+ 
¤c_¡•
);

76 
d¡
 = (sigÃd *è((*)d¡ + 
d¡_¡•
);

77 
sum
 = (sigÃd *è((*)sum + 
sum_¡•
);

79 
	}
}

81 
	$mix_¬—s_32
(
size
,

82 vŞ©sigÃd *
d¡
, sigÃd *
¤c
,

83 vŞ©sigÃd *
sum
, 
size_t
 
d¡_¡•
,

84 
size_t
 
¤c_¡•
, size_ˆ
sum_¡•
)

86 sigÃd 
§m¶e
, 
Şd_§m¶e
;

89 
§m¶e
 = *
¤c
 >> 8;

90 
Şd_§m¶e
 = *
sum
;

91 ià(
	`ARCH_CMPXCHG
(
d¡
, 0, 1) == 0)

92 
§m¶e
 -ğ
Şd_§m¶e
;

93 
	`ARCH_ADD
(
sum
, 
§m¶e
);

95 
Şd_§m¶e
 = *
sum
;

96 ià(
Şd_§m¶e
 > 0x7fffff)

97 
§m¶e
 = 0x7fffffff;

98 ià(
Şd_§m¶e
 < -0x800000)

99 
§m¶e
 = -0x80000000;

101 
§m¶e
 = 
Şd_§m¶e
 * 256;

102 *
d¡
 = 
§m¶e
;

103 } 
IS_CONCURRENT
 && *
sum
 !ğ
Şd_§m¶e
);

104 ià(!--
size
)

106 
¤c
 = (sigÃd *è((*)¤ø+ 
¤c_¡•
);

107 
d¡
 = (sigÃd *è((*)d¡ + 
d¡_¡•
);

108 
sum
 = (sigÃd *è((*)sum + 
sum_¡•
);

110 
	}
}

112 
	$mix_£Ëù_ÿÎbacks
(
¢d_pcm_dœeù_t
 *
dmix
)

114 
dmix
->
u
.dmix.
mix_¬—s_16
 = mix_areas_16;

115 
dmix
->
u
.dmix.
mix_¬—s_32
 = mix_areas_32;

116 
	}
}

121 
	#g’”ic_dmix_suµÜ‹d_fÜm©
 \

122 ((1ULL << 
SND_PCM_FORMAT_S16_LE
è| (1ULL << 
SND_PCM_FORMAT_S32_LE
) |\

123 (1ULL << 
SND_PCM_FORMAT_S16_BE
è| (1ULL << 
SND_PCM_FORMAT_S32_BE
) |\

124 (1ULL << 
SND_PCM_FORMAT_S24_LE
è| (1ULL << 
SND_PCM_FORMAT_S24_3LE
) | \

125 (1ULL << 
SND_PCM_FORMAT_U8
))

	)

127 
	~"bsw­.h
"

129 
	$g’”ic_mix_¬—s_16_Çtive
(
size
,

130 vŞ©sigÃd *
d¡
,

131 sigÃd *
¤c
,

132 vŞ©sigÃd *
sum
,

133 
size_t
 
d¡_¡•
,

134 
size_t
 
¤c_¡•
,

135 
size_t
 
sum_¡•
)

137 sigÃd 
§m¶e
;

140 
§m¶e
 = *
¤c
;

141 ià(! *
d¡
) {

142 *
sum
 = 
§m¶e
;

143 *
d¡
 = *
¤c
;

145 
§m¶e
 +ğ*
sum
;

146 *
sum
 = 
§m¶e
;

147 ià(
§m¶e
 > 0x7fff)

148 
§m¶e
 = 0x7fff;

149 ià(
§m¶e
 < -0x8000)

150 
§m¶e
 = -0x8000;

151 *
d¡
 = 
§m¶e
;

153 ià(!--
size
)

155 
¤c
 = (sigÃd *è((*)¤ø+ 
¤c_¡•
);

156 
d¡
 = (sigÃd *è((*)d¡ + 
d¡_¡•
);

157 
sum
 = (sigÃd *è((*)sum + 
sum_¡•
);

159 
	}
}

161 
	$g’”ic_»mix_¬—s_16_Çtive
(
size
,

162 vŞ©sigÃd *
d¡
,

163 sigÃd *
¤c
,

164 vŞ©sigÃd *
sum
,

165 
size_t
 
d¡_¡•
,

166 
size_t
 
¤c_¡•
,

167 
size_t
 
sum_¡•
)

169 sigÃd 
§m¶e
;

172 
§m¶e
 = *
¤c
;

173 ià(! *
d¡
) {

174 *
sum
 = -
§m¶e
;

175 *
d¡
 = -
§m¶e
;

177 *
sum
 = 
§m¶e
 = *sum - sample;

178 ià(
§m¶e
 > 0x7fff)

179 
§m¶e
 = 0x7fff;

180 ià(
§m¶e
 < -0x8000)

181 
§m¶e
 = -0x8000;

182 *
d¡
 = 
§m¶e
;

184 ià(!--
size
)

186 
¤c
 = (sigÃd *è((*)¤ø+ 
¤c_¡•
);

187 
d¡
 = (sigÃd *è((*)d¡ + 
d¡_¡•
);

188 
sum
 = (sigÃd *è((*)sum + 
sum_¡•
);

190 
	}
}

192 
	$g’”ic_mix_¬—s_32_Çtive
(
size
,

193 vŞ©sigÃd *
d¡
,

194 sigÃd *
¤c
,

195 vŞ©sigÃd *
sum
,

196 
size_t
 
d¡_¡•
,

197 
size_t
 
¤c_¡•
,

198 
size_t
 
sum_¡•
)

200 sigÃd 
§m¶e
;

203 
§m¶e
 = *
¤c
 >> 8;

204 ià(! *
d¡
) {

205 *
sum
 = 
§m¶e
;

206 *
d¡
 = *
¤c
;

208 
§m¶e
 +ğ*
sum
;

209 *
sum
 = 
§m¶e
;

210 ià(
§m¶e
 > 0x7fffff)

211 
§m¶e
 = 0x7fffffff;

212 ià(
§m¶e
 < -0x800000)

213 
§m¶e
 = -0x80000000;

215 
§m¶e
 *= 256;

216 *
d¡
 = 
§m¶e
;

218 ià(!--
size
)

220 
¤c
 = (sigÃd *è((*)¤ø+ 
¤c_¡•
);

221 
d¡
 = (sigÃd *è((*)d¡ + 
d¡_¡•
);

222 
sum
 = (sigÃd *è((*)sum + 
sum_¡•
);

224 
	}
}

226 
	$g’”ic_»mix_¬—s_32_Çtive
(
size
,

227 vŞ©sigÃd *
d¡
,

228 sigÃd *
¤c
,

229 vŞ©sigÃd *
sum
,

230 
size_t
 
d¡_¡•
,

231 
size_t
 
¤c_¡•
,

232 
size_t
 
sum_¡•
)

234 sigÃd 
§m¶e
;

237 
§m¶e
 = *
¤c
 >> 8;

238 ià(! *
d¡
) {

239 *
sum
 = -
§m¶e
;

240 *
d¡
 = -*
¤c
;

242 *
sum
 = 
§m¶e
 = *sum - sample;

243 ià(
§m¶e
 > 0x7fffff)

244 
§m¶e
 = 0x7fffffff;

245 ià(
§m¶e
 < -0x800000)

246 
§m¶e
 = -0x80000000;

248 
§m¶e
 *= 256;

249 *
d¡
 = 
§m¶e
;

251 ià(!--
size
)

253 
¤c
 = (sigÃd *è((*)¤ø+ 
¤c_¡•
);

254 
d¡
 = (sigÃd *è((*)d¡ + 
d¡_¡•
);

255 
sum
 = (sigÃd *è((*)sum + 
sum_¡•
);

257 
	}
}

259 
	$g’”ic_mix_¬—s_16_sw­
(
size
,

260 vŞ©sigÃd *
d¡
,

261 sigÃd *
¤c
,

262 vŞ©sigÃd *
sum
,

263 
size_t
 
d¡_¡•
,

264 
size_t
 
¤c_¡•
,

265 
size_t
 
sum_¡•
)

267 sigÃd 
§m¶e
;

270 
§m¶e
 = (sigÃd è
	`bsw­_16
(*
¤c
);

271 ià(! *
d¡
) {

272 *
sum
 = 
§m¶e
;

273 *
d¡
 = *
¤c
;

275 
§m¶e
 +ğ*
sum
;

276 *
sum
 = 
§m¶e
;

277 ià(
§m¶e
 > 0x7fff)

278 
§m¶e
 = 0x7fff;

279 ià(
§m¶e
 < -0x8000)

280 
§m¶e
 = -0x8000;

281 *
d¡
 = (sigÃd è
	`bsw­_16
((sigÃd è
§m¶e
);

283 ià(!--
size
)

285 
¤c
 = (sigÃd *è((*)¤ø+ 
¤c_¡•
);

286 
d¡
 = (sigÃd *è((*)d¡ + 
d¡_¡•
);

287 
sum
 = (sigÃd *è((*)sum + 
sum_¡•
);

289 
	}
}

291 
	$g’”ic_»mix_¬—s_16_sw­
(
size
,

292 vŞ©sigÃd *
d¡
,

293 sigÃd *
¤c
,

294 vŞ©sigÃd *
sum
,

295 
size_t
 
d¡_¡•
,

296 
size_t
 
¤c_¡•
,

297 
size_t
 
sum_¡•
)

299 sigÃd 
§m¶e
;

302 
§m¶e
 = (sigÃd è
	`bsw­_16
(*
¤c
);

303 ià(! *
d¡
) {

304 *
sum
 = -
§m¶e
;

305 *
d¡
 = (sigÃd è
	`bsw­_16
((sigÃd è-
§m¶e
);

307 *
sum
 = 
§m¶e
 = *sum - sample;

308 ià(
§m¶e
 > 0x7fff)

309 
§m¶e
 = 0x7fff;

310 ià(
§m¶e
 < -0x8000)

311 
§m¶e
 = -0x8000;

312 *
d¡
 = (sigÃd è
	`bsw­_16
((sigÃd è
§m¶e
);

314 ià(!--
size
)

316 
¤c
 = (sigÃd *è((*)¤ø+ 
¤c_¡•
);

317 
d¡
 = (sigÃd *è((*)d¡ + 
d¡_¡•
);

318 
sum
 = (sigÃd *è((*)sum + 
sum_¡•
);

320 
	}
}

322 
	$g’”ic_mix_¬—s_32_sw­
(
size
,

323 vŞ©sigÃd *
d¡
,

324 sigÃd *
¤c
,

325 vŞ©sigÃd *
sum
,

326 
size_t
 
d¡_¡•
,

327 
size_t
 
¤c_¡•
,

328 
size_t
 
sum_¡•
)

330 sigÃd 
§m¶e
;

333 
§m¶e
 = (sigÃd è
	`bsw­_32
(*
¤c
) >> 8;

334 ià(! *
d¡
) {

335 *
sum
 = 
§m¶e
;

336 *
d¡
 = *
¤c
;

338 
§m¶e
 +ğ*
sum
;

339 *
sum
 = 
§m¶e
;

340 ià(
§m¶e
 > 0x7fffff)

341 
§m¶e
 = 0x7fffffff;

342 ià(
§m¶e
 < -0x800000)

343 
§m¶e
 = -0x80000000;

345 
§m¶e
 *= 256;

346 *
d¡
 = 
	`bsw­_32
(
§m¶e
);

348 ià(!--
size
)

350 
¤c
 = (sigÃd *è((*)¤ø+ 
¤c_¡•
);

351 
d¡
 = (sigÃd *è((*)d¡ + 
d¡_¡•
);

352 
sum
 = (sigÃd *è((*)sum + 
sum_¡•
);

354 
	}
}

356 
	$g’”ic_»mix_¬—s_32_sw­
(
size
,

357 vŞ©sigÃd *
d¡
,

358 sigÃd *
¤c
,

359 vŞ©sigÃd *
sum
,

360 
size_t
 
d¡_¡•
,

361 
size_t
 
¤c_¡•
,

362 
size_t
 
sum_¡•
)

364 sigÃd 
§m¶e
;

367 
§m¶e
 = (sigÃd è
	`bsw­_32
(*
¤c
) >> 8;

368 ià(! *
d¡
) {

369 *
sum
 = -
§m¶e
;

370 *
d¡
 = 
	`bsw­_32
(-
§m¶e
);

372 *
sum
 = 
§m¶e
 = *sum - sample;

373 ià(
§m¶e
 > 0x7fffff)

374 
§m¶e
 = 0x7fffffff;

375 ià(
§m¶e
 < -0x800000)

376 
§m¶e
 = -0x80000000;

378 
§m¶e
 *= 256;

379 *
d¡
 = 
	`bsw­_32
(
§m¶e
);

381 ià(!--
size
)

383 
¤c
 = (sigÃd *è((*)¤ø+ 
¤c_¡•
);

384 
d¡
 = (sigÃd *è((*)d¡ + 
d¡_¡•
);

385 
sum
 = (sigÃd *è((*)sum + 
sum_¡•
);

387 
	}
}

390 
	$g’”ic_mix_¬—s_24
(
size
,

391 vŞ©*
d¡
,

392 *
¤c
,

393 vŞ©sigÃd *
sum
,

394 
size_t
 
d¡_¡•
,

395 
size_t
 
¤c_¡•
,

396 
size_t
 
sum_¡•
)

398 sigÃd 
§m¶e
;

401 
§m¶e
 = 
¤c
[0] | (src[1] << 8) | (((signed *)src)[2] << 16);

402 ià(!(
d¡
[0] | dst[1] | dst[2])) {

403 *
sum
 = 
§m¶e
;

405 
§m¶e
 +ğ*
sum
;

406 *
sum
 = 
§m¶e
;

407 ià(
§m¶e
 > 0x7fffff)

408 
§m¶e
 = 0x7fffff;

409 ià(
§m¶e
 < -0x800000)

410 
§m¶e
 = -0x800000;

412 
d¡
[0] = 
§m¶e
;

413 
d¡
[1] = 
§m¶e
 >> 8;

414 
d¡
[2] = 
§m¶e
 >> 16;

415 ià(!--
size
)

417 
d¡
 +ğ
d¡_¡•
;

418 
¤c
 +ğ
¤c_¡•
;

419 
sum
 = (sigÃd *è((*)sum + 
sum_¡•
);

421 
	}
}

423 
	$g’”ic_»mix_¬—s_24
(
size
,

424 vŞ©*
d¡
,

425 *
¤c
,

426 vŞ©sigÃd *
sum
,

427 
size_t
 
d¡_¡•
,

428 
size_t
 
¤c_¡•
,

429 
size_t
 
sum_¡•
)

431 sigÃd 
§m¶e
;

434 
§m¶e
 = 
¤c
[0] | (src[1] << 8) | (((signed *)src)[2] << 16);

435 ià(!(
d¡
[0] | dst[1] | dst[2])) {

436 
§m¶e
 = -sample;

437 *
sum
 = 
§m¶e
;

439 *
sum
 = 
§m¶e
 = *sum - sample;

440 ià(
§m¶e
 > 0x7fffff)

441 
§m¶e
 = 0x7fffff;

442 ià(
§m¶e
 < -0x800000)

443 
§m¶e
 = -0x800000;

445 
d¡
[0] = 
§m¶e
;

446 
d¡
[1] = 
§m¶e
 >> 8;

447 
d¡
[2] = 
§m¶e
 >> 16;

448 ià(!--
size
)

450 
d¡
 +ğ
d¡_¡•
;

451 
¤c
 +ğ
¤c_¡•
;

452 
sum
 = (sigÃd *è((*)sum + 
sum_¡•
);

454 
	}
}

456 
	$g’”ic_mix_¬—s_u8
(
size
,

457 vŞ©*
d¡
,

458 *
¤c
,

459 vŞ©sigÃd *
sum
,

460 
size_t
 
d¡_¡•
,

461 
size_t
 
¤c_¡•
,

462 
size_t
 
sum_¡•
)

465 
§m¶e
 = *
¤c
 - 0x80;

466 ià(*
d¡
 == 0x80) {

467 *
sum
 = 
§m¶e
;

469 
§m¶e
 +ğ*
sum
;

470 *
sum
 = 
§m¶e
;

471 ià(
§m¶e
 > 0x7f)

472 
§m¶e
 = 0x7f;

473 ià(
§m¶e
 < -0x80)

474 
§m¶e
 = -0x80;

476 *
d¡
 = 
§m¶e
 + 0x80;

477 ià(!--
size
)

479 
d¡
 +ğ
d¡_¡•
;

480 
¤c
 +ğ
¤c_¡•
;

481 
sum
 = (sigÃd *è((*)sum + 
sum_¡•
);

483 
	}
}

485 
	$g’”ic_»mix_¬—s_u8
(
size
,

486 vŞ©*
d¡
,

487 *
¤c
,

488 vŞ©sigÃd *
sum
,

489 
size_t
 
d¡_¡•
,

490 
size_t
 
¤c_¡•
,

491 
size_t
 
sum_¡•
)

494 
§m¶e
 = *
¤c
 - 0x80;

495 ià(*
d¡
 == 0x80) {

496 
§m¶e
 = -sample;

497 *
sum
 = 
§m¶e
;

499 *
sum
 = 
§m¶e
 = *sum - sample;

500 ià(
§m¶e
 > 0x7f)

501 
§m¶e
 = 0x7f;

502 ià(
§m¶e
 < -0x80)

503 
§m¶e
 = -0x80;

505 *
d¡
 = 
§m¶e
 + 0x80;

506 ià(!--
size
)

508 
d¡
 +ğ
d¡_¡•
;

509 
¤c
 +ğ
¤c_¡•
;

510 
sum
 = (sigÃd *è((*)sum + 
sum_¡•
);

512 
	}
}

515 
	$g’”ic_mix_£Ëù_ÿÎbacks
(
¢d_pcm_dœeù_t
 *
dmix
)

517 ià(
	`¢d_pcm_fÜm©_ıu_’dŸn
(
dmix
->
shm±r
->
s
.
fÜm©
)) {

518 
dmix
->
u
.dmix.
mix_¬—s_16
 = 
g’”ic_mix_¬—s_16_Çtive
;

519 
dmix
->
u
.dmix.
mix_¬—s_32
 = 
g’”ic_mix_¬—s_32_Çtive
;

520 
dmix
->
u
.dmix.
»mix_¬—s_16
 = 
g’”ic_»mix_¬—s_16_Çtive
;

521 
dmix
->
u
.dmix.
»mix_¬—s_32
 = 
g’”ic_»mix_¬—s_32_Çtive
;

523 
dmix
->
u
.dmix.
mix_¬—s_16
 = 
g’”ic_mix_¬—s_16_sw­
;

524 
dmix
->
u
.dmix.
mix_¬—s_32
 = 
g’”ic_mix_¬—s_32_sw­
;

525 
dmix
->
u
.dmix.
»mix_¬—s_16
 = 
g’”ic_»mix_¬—s_16_sw­
;

526 
dmix
->
u
.dmix.
»mix_¬—s_32
 = 
g’”ic_»mix_¬—s_32_sw­
;

528 
dmix
->
u
.dmix.
mix_¬—s_24
 = 
g’”ic_mix_¬—s_24
;

529 
dmix
->
u
.dmix.
mix_¬—s_u8
 = 
g’”ic_mix_¬—s_u8
;

530 
dmix
->
u
.dmix.
»mix_¬—s_24
 = 
g’”ic_»mix_¬—s_24
;

531 
dmix
->
u
.dmix.
»mix_¬—s_u8
 = 
g’”ic_»mix_¬—s_u8
;

532 
dmix
->
u
.dmix.
u£_£m
 = 1;

533 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_i386.c

5 
	#MIX_AREAS_16
 
mix_¬—s_16


	)

6 
	#MIX_AREAS_16_MMX
 
mix_¬—s_16_mmx


	)

7 
	#MIX_AREAS_32
 
mix_¬—s_32


	)

8 
	#MIX_AREAS_24
 
mix_¬—s_24


	)

9 
	#MIX_AREAS_24_CMOV
 
mix_¬—s_24_cmov


	)

10 
	#LOCK_PREFIX
 ""

	)

11 
	#XADD
 "addl"

	)

12 
	#XSUB
 "subl"

	)

13 
	~"pcm_dmix_i386.h
"

14 #undeà
MIX_AREAS_16


15 #undeà
MIX_AREAS_16_MMX


16 #undeà
MIX_AREAS_32


17 #undeà
MIX_AREAS_24


18 #undeà
MIX_AREAS_24_CMOV


19 #undeà
LOCK_PREFIX


20 #undeà
XADD


21 #undeà
XSUB


23 
	#MIX_AREAS_16
 
»mix_¬—s_16


	)

24 
	#MIX_AREAS_16_MMX
 
»mix_¬—s_16_mmx


	)

25 
	#MIX_AREAS_32
 
»mix_¬—s_32


	)

26 
	#MIX_AREAS_24
 
»mix_¬—s_24


	)

27 
	#MIX_AREAS_24_CMOV
 
»mix_¬—s_24_cmov


	)

28 
	#LOCK_PREFIX
 ""

	)

29 
	#XADD
 "subl"

	)

30 
	#XSUB
 "addl"

	)

31 
	~"pcm_dmix_i386.h
"

32 #undeà
MIX_AREAS_16


33 #undeà
MIX_AREAS_16_MMX


34 #undeà
MIX_AREAS_32


35 #undeà
MIX_AREAS_24


36 #undeà
MIX_AREAS_24_CMOV


37 #undeà
LOCK_PREFIX


38 #undeà
XADD


39 #undeà
XSUB


41 
	#MIX_AREAS_16
 
mix_¬—s_16_smp


	)

42 
	#MIX_AREAS_16_MMX
 
mix_¬—s_16_smp_mmx


	)

43 
	#MIX_AREAS_32
 
mix_¬—s_32_smp


	)

44 
	#MIX_AREAS_24
 
mix_¬—s_24_smp


	)

45 
	#MIX_AREAS_24_CMOV
 
mix_¬—s_24_smp_cmov


	)

46 
	#LOCK_PREFIX
 "lock ; "

	)

47 
	#XADD
 "addl"

	)

48 
	#XSUB
 "subl"

	)

49 
	~"pcm_dmix_i386.h
"

50 #undeà
MIX_AREAS_16


51 #undeà
MIX_AREAS_16_MMX


52 #undeà
MIX_AREAS_32


53 #undeà
MIX_AREAS_24


54 #undeà
MIX_AREAS_24_CMOV


55 #undeà
LOCK_PREFIX


56 #undeà
XADD


57 #undeà
XSUB


59 
	#MIX_AREAS_16
 
»mix_¬—s_16_smp


	)

60 
	#MIX_AREAS_16_MMX
 
»mix_¬—s_16_smp_mmx


	)

61 
	#MIX_AREAS_32
 
»mix_¬—s_32_smp


	)

62 
	#MIX_AREAS_24
 
»mix_¬—s_24_smp


	)

63 
	#MIX_AREAS_24_CMOV
 
»mix_¬—s_24_smp_cmov


	)

64 
	#LOCK_PREFIX
 "lock ; "

	)

65 
	#XADD
 "subl"

	)

66 
	#XSUB
 "addl"

	)

67 
	~"pcm_dmix_i386.h
"

68 #undeà
MIX_AREAS_16


69 #undeà
MIX_AREAS_16_MMX


70 #undeà
MIX_AREAS_32


71 #undeà
MIX_AREAS_24


72 #undeà
MIX_AREAS_24_CMOV


73 #undeà
LOCK_PREFIX


74 #undeà
XADD


75 #undeà
XSUB


77 
	#i386_dmix_suµÜ‹d_fÜm©
 \

78 ((1ULL << 
SND_PCM_FORMAT_S16_LE
) |\

79 (1ULL << 
SND_PCM_FORMAT_S32_LE
) |\

80 (1ULL << 
SND_PCM_FORMAT_S24_LE
) |\

81 (1ULL << 
SND_PCM_FORMAT_S24_3LE
))

	)

83 
	#dmix_suµÜ‹d_fÜm©
 \

84 (
i386_dmix_suµÜ‹d_fÜm©
 | 
g’”ic_dmix_suµÜ‹d_fÜm©
)

	)

86 
	$mix_£Ëù_ÿÎbacks
(
¢d_pcm_dœeù_t
 *
dmix
)

88 
smp
 = 0, 
mmx
 = 0, 
cmov
 = 0;

90 ià(!
dmix
->
dœeù_memÜy_acûss
) {

91 
	`g’”ic_mix_£Ëù_ÿÎbacks
(
dmix
);

95 ià(!((1ULL<< 
dmix
->
shm±r
->
s
.
fÜm©
è& 
i386_dmix_suµÜ‹d_fÜm©
)) {

96 
	`g’”ic_mix_£Ëù_ÿÎbacks
(
dmix
);

100 ià(!
smp
) {

101 
FILE
 *
š
;

102 
lše
[255];

105 
š
 = 
	`fİ’
("/proc/cpuinfo", "r");

106 ià(
š
) {

107 !
	`ãof
(
š
è&& (
	`fg‘s
(
lše
, Öše), inè!ğ
NULL
)) {

108 ià(!
	`¡ºcmp
(
lše
, "processor", 9))

109 
smp
++;

110 ià(!
	`¡ºcmp
(
lše
, "flags", 5)) {

111 ià(
	`¡r¡r
(
lše
, " mmx"))

112 
mmx
 = 1;

113 ià(
	`¡r¡r
(
lše
, " cmov"))

114 
cmov
 = 1;

117 
	`fşo£
(
š
);

121 ià(
mmx
) {

122 
dmix
->
u
.dmix.
mix_¬—s_16
 = 
smp
 > 1 ? 
mix_¬—s_16_smp_mmx
 : 
mix_¬—s_16_mmx
;

123 
dmix
->
u
.dmix.
»mix_¬—s_16
 = 
smp
 > 1 ? 
»mix_¬—s_16_smp_mmx
 : 
»mix_¬—s_16_mmx
;

125 
dmix
->
u
.dmix.
mix_¬—s_16
 = 
smp
 > 1 ? 
mix_¬—s_16_smp
 : mix_areas_16;

126 
dmix
->
u
.dmix.
»mix_¬—s_16
 = 
smp
 > 1 ? 
»mix_¬—s_16_smp
 :„emix_areas_16;

128 
dmix
->
u
.dmix.
mix_¬—s_32
 = 
smp
 > 1 ? 
mix_¬—s_32_smp
 : mix_areas_32;

129 
dmix
->
u
.dmix.
»mix_¬—s_32
 = 
smp
 > 1 ? 
»mix_¬—s_32_smp
 :„emix_areas_32;

130 ià(
cmov
) {

131 
dmix
->
u
.dmix.
mix_¬—s_24
 = 
smp
 > 1 ? 
mix_¬—s_24_smp_cmov
 : 
mix_¬—s_24_cmov
;

132 
dmix
->
u
.dmix.
»mix_¬—s_24
 = 
smp
 > 1 ? 
»mix_¬—s_24_smp_cmov
 : 
»mix_¬—s_24_cmov
;

134 
dmix
->
u
.dmix.
mix_¬—s_24
 = 
smp
 > 1 ? 
mix_¬—s_24_smp
: mix_areas_24;

135 
dmix
->
u
.dmix.
»mix_¬—s_24
 = 
smp
 > 1 ? 
»mix_¬—s_24_smp
:„emix_areas_24;

137 
dmix
->
u
.dmix.
u£_£m
 = 0;

138 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_i386.h

29 #ià
defšed
(
__GNUC__
è&& __GNUC__ < 5 && defšed(
__PIC__
)

30 
	#BOUNDED_EBX


	)

36 
	$MIX_AREAS_16
(
size
,

37 vŞ©sigÃd *
d¡
, sigÃd *
¤c
,

38 vŞ©sigÃd *
sum
, 
size_t
 
d¡_¡•
,

39 
size_t
 
¤c_¡•
, size_ˆ
sum_¡•
)

41 #ifdeà
BOUNDED_EBX


42 
Şd_ebx
;

52 
__asm__
 
	`__vŞ©e__
 (

54 #ifdeà
BOUNDED_EBX


89 "\t" 
LOCK_PREFIX
 "cmpxchgw %%cx, (%%edi)\n"

92 "\t" 
XSUB
 " %%edx, %%ecx\n"

94 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%ebx)\n"

149 #ifdeà
BOUNDED_EBX


152 : [
size
] "+&rm" (size)

153 #ifdeà
BOUNDED_EBX


154 , [
Şd_ebx
] "=m" (old_ebx)

156 : [
d¡
] "m" (d¡), [
¤c
] "m" (¤c), [
sum
] "m" (sum),

157 [
d¡_¡•
] "im" (d¡_¡•), [
¤c_¡•
] "im" (src_step),

158 [
sum_¡•
] "im" (sum_step)

160 #iâdeà
BOUNDED_EBX


164 
	}
}

169 
	$MIX_AREAS_16_MMX
(
size
,

170 vŞ©sigÃd *
d¡
, sigÃd *
¤c
,

171 vŞ©sigÃd *
sum
, 
size_t
 
d¡_¡•
,

172 
size_t
 
¤c_¡•
, size_ˆ
sum_¡•
)

174 #ifdeà
BOUNDED_EBX


175 
Şd_ebx
;

185 
__asm__
 
	`__vŞ©e__
 (

187 #ifdeà
BOUNDED_EBX


217 "\t" 
LOCK_PREFIX
 "cmpxchgw %%cx, (%%edi)\n"

220 "\t" 
XSUB
 " %%edx, %%ecx\n"

222 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%ebx)\n"

248 #ifdeà
BOUNDED_EBX


251 : [
size
] "+&rm" (size)

252 #ifdeà
BOUNDED_EBX


253 , [
Şd_ebx
] "=m" (old_ebx)

255 : [
d¡
] "m" (d¡), [
¤c
] "m" (¤c), [
sum
] "m" (sum),

256 [
d¡_¡•
] "im" (d¡_¡•), [
¤c_¡•
] "im" (src_step),

257 [
sum_¡•
] "im" (sum_step)

259 #iâdeà
BOUNDED_EBX


262 #ifdeà
HAVE_MMX


269 
	}
}

274 
	$MIX_AREAS_32
(
size
,

275 vŞ©sigÃd *
d¡
, sigÃd *
¤c
,

276 vŞ©sigÃd *
sum
, 
size_t
 
d¡_¡•
,

277 
size_t
 
¤c_¡•
, size_ˆ
sum_¡•
)

279 #ifdeà
BOUNDED_EBX


280 
Şd_ebx
;

290 
__asm__
 
	`__vŞ©e__
 (

292 #ifdeà
BOUNDED_EBX


319 "\t" 
LOCK_PREFIX
 "cmpxchgl %%ecx, (%%edi)\n"

324 "\t" 
XSUB
 " %%edx, %%ecx\n"

331 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%ebx)\n"

376 #ifdeà
BOUNDED_EBX


379 : [
size
] "+&rm" (size)

380 #ifdeà
BOUNDED_EBX


381 , [
Şd_ebx
] "=m" (old_ebx)

383 : [
d¡
] "m" (d¡), [
¤c
] "m" (¤c), [
sum
] "m" (sum),

384 [
d¡_¡•
] "im" (d¡_¡•), [
¤c_¡•
] "im" (src_step),

385 [
sum_¡•
] "im" (sum_step)

387 #iâdeà
BOUNDED_EBX


391 
	}
}

396 
	$MIX_AREAS_24
(
size
,

397 vŞ©*
d¡
, *
¤c
,

398 vŞ©sigÃd *
sum
, 
size_t
 
d¡_¡•
,

399 
size_t
 
¤c_¡•
, size_ˆ
sum_¡•
)

401 #ifdeà
BOUNDED_EBX


402 
Şd_ebx
;

412 
__asm__
 
	`__vŞ©e__
 (

414 #ifdeà
BOUNDED_EBX


443 "\t" 
LOCK_PREFIX
 "btsw $0, (%%edi)\n"

445 "\t" 
XSUB
 " %%edx, %%ecx\n"

447 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%ebx)\n"

491 #ifdeà
BOUNDED_EBX


494 : [
size
] "+&rm" (size)

495 #ifdeà
BOUNDED_EBX


496 , [
Şd_ebx
] "=m" (old_ebx)

498 : [
d¡
] "m" (d¡), [
¤c
] "m" (¤c), [
sum
] "m" (sum),

499 [
d¡_¡•
] "im" (d¡_¡•), [
¤c_¡•
] "im" (src_step),

500 [
sum_¡•
] "im" (sum_step)

502 #iâdeà
BOUNDED_EBX


506 
	}
}

511 
	$MIX_AREAS_24_CMOV
(
size
,

512 vŞ©*
d¡
, *
¤c
,

513 vŞ©sigÃd *
sum
, 
size_t
 
d¡_¡•
,

514 
size_t
 
¤c_¡•
, size_ˆ
sum_¡•
)

516 #ifdeà
BOUNDED_EBX


517 
Şd_ebx
;

527 
__asm__
 
	`__vŞ©e__
 (

529 #ifdeà
BOUNDED_EBX


556 "\t" 
LOCK_PREFIX
 "btsw $0, (%%edi)\n"

559 "\t" 
XSUB
 " %%edx, %%ecx\n"

561 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%ebx)\n"

599 #ifdeà
BOUNDED_EBX


602 : [
size
] "+&rm" (size)

603 #ifdeà
BOUNDED_EBX


604 , [
Şd_ebx
] "=m" (old_ebx)

606 : [
d¡
] "m" (d¡), [
¤c
] "m" (¤c), [
sum
] "m" (sum),

607 [
d¡_¡•
] "im" (d¡_¡•), [
¤c_¡•
] "im" (src_step),

608 [
sum_¡•
] "im" (sum_step)

610 #iâdeà
BOUNDED_EBX


614 
	}
}

616 #ifdeà
BOUNDED_EBX


617 #undeà
BOUNDED_EBX


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_x86_64.c

5 
	#MIX_AREAS_16
 
mix_¬—s_16


	)

6 
	#MIX_AREAS_32
 
mix_¬—s_32


	)

7 
	#MIX_AREAS_24
 
mix_¬—s_24


	)

8 
	#LOCK_PREFIX
 ""

	)

9 
	#XADD
 "addl"

	)

10 
	#XSUB
 "subl"

	)

11 
	~"pcm_dmix_x86_64.h
"

12 #undeà
MIX_AREAS_16


13 #undeà
MIX_AREAS_32


14 #undeà
MIX_AREAS_24


15 #undeà
LOCK_PREFIX


16 #undeà
XADD


17 #undeà
XSUB


19 
	#MIX_AREAS_16
 
»mix_¬—s_16


	)

20 
	#MIX_AREAS_32
 
»mix_¬—s_32


	)

21 
	#MIX_AREAS_24
 
»mix_¬—s_24


	)

22 
	#LOCK_PREFIX
 ""

	)

23 
	#XADD
 "subl"

	)

24 
	#XSUB
 "addl"

	)

25 
	~"pcm_dmix_x86_64.h
"

26 #undeà
MIX_AREAS_16


27 #undeà
MIX_AREAS_32


28 #undeà
MIX_AREAS_24


29 #undeà
LOCK_PREFIX


30 #undeà
XADD


31 #undeà
XSUB


33 
	#MIX_AREAS_16
 
mix_¬—s_16_smp


	)

34 
	#MIX_AREAS_32
 
mix_¬—s_32_smp


	)

35 
	#MIX_AREAS_24
 
mix_¬—s_24_smp


	)

36 
	#LOCK_PREFIX
 "lock ; "

	)

37 
	#XADD
 "addl"

	)

38 
	#XSUB
 "subl"

	)

39 
	~"pcm_dmix_x86_64.h
"

40 #undeà
MIX_AREAS_16


41 #undeà
MIX_AREAS_32


42 #undeà
MIX_AREAS_24


43 #undeà
LOCK_PREFIX


44 #undeà
XADD


45 #undeà
XSUB


47 
	#MIX_AREAS_16
 
»mix_¬—s_16_smp


	)

48 
	#MIX_AREAS_32
 
»mix_¬—s_32_smp


	)

49 
	#MIX_AREAS_24
 
»mix_¬—s_24_smp


	)

50 
	#LOCK_PREFIX
 "lock ; "

	)

51 
	#XADD
 "subl"

	)

52 
	#XSUB
 "addl"

	)

53 
	~"pcm_dmix_x86_64.h
"

54 #undeà
MIX_AREAS_16


55 #undeà
MIX_AREAS_32


56 #undeà
MIX_AREAS_24


57 #undeà
LOCK_PREFIX


58 #undeà
XADD


59 #undeà
XSUB


61 
	#x86_64_dmix_suµÜ‹d_fÜm©
 \

62 ((1ULL << 
SND_PCM_FORMAT_S16_LE
) |\

63 (1ULL << 
SND_PCM_FORMAT_S32_LE
) |\

64 (1ULL << 
SND_PCM_FORMAT_S24_3LE
))

	)

66 
	#dmix_suµÜ‹d_fÜm©
 \

67 (
x86_64_dmix_suµÜ‹d_fÜm©
 | 
g’”ic_dmix_suµÜ‹d_fÜm©
)

	)

69 
	$mix_£Ëù_ÿÎbacks
(
¢d_pcm_dœeù_t
 *
dmix
)

71 
smp
 = 0;

73 ià(!
dmix
->
dœeù_memÜy_acûss
) {

74 
	`g’”ic_mix_£Ëù_ÿÎbacks
(
dmix
);

78 ià(!((1ULL<< 
dmix
->
shm±r
->
s
.
fÜm©
è& 
x86_64_dmix_suµÜ‹d_fÜm©
)) {

79 
	`g’”ic_mix_£Ëù_ÿÎbacks
(
dmix
);

83 ià(!
smp
) {

84 
FILE
 *
š
;

85 
lše
[255];

88 
š
 = 
	`fİ’
("/proc/cpuinfo", "r");

89 ià(
š
) {

90 !
	`ãof
(
š
è&& (
	`fg‘s
(
lše
, Öše), inè!ğ
NULL
)) {

91 ià(!
	`¡ºcmp
(
lše
, "processor", 9))

92 
smp
++;

94 
	`fşo£
(
š
);

98 
dmix
->
u
.dmix.
mix_¬—s_16
 = 
smp
 > 1 ? 
mix_¬—s_16_smp
 : mix_areas_16;

99 
dmix
->
u
.dmix.
»mix_¬—s_16
 = 
smp
 > 1 ? 
»mix_¬—s_16_smp
 :„emix_areas_16;

100 
dmix
->
u
.dmix.
mix_¬—s_32
 = 
smp
 > 1 ? 
mix_¬—s_32_smp
 : mix_areas_32;

101 
dmix
->
u
.dmix.
»mix_¬—s_32
 = 
smp
 > 1 ? 
»mix_¬—s_32_smp
 :„emix_areas_32;

102 
dmix
->
u
.dmix.
mix_¬—s_24
 = 
smp
 > 1 ? 
mix_¬—s_24_smp
 : mix_areas_24;

103 
dmix
->
u
.dmix.
»mix_¬—s_24
 = 
smp
 > 1 ? 
»mix_¬—s_24_smp
 :„emix_areas_24;

104 
dmix
->
u
.dmix.
u£_£m
 = 0;

105 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_x86_64.h

30 #ià
defšed
(
__GNUC__
è&& __GNUC__ < 5 && defšed(
__PIC__
)

31 
	#BOUNDED_RBX


	)

37 
	$MIX_AREAS_16
(
size
,

38 vŞ©sigÃd *
d¡
, sigÃd *
¤c
,

39 vŞ©sigÃd *
sum
, 
size_t
 
d¡_¡•
,

40 
size_t
 
¤c_¡•
, size_ˆ
sum_¡•
)

42 #ifdeà
BOUNDED_RBX


43 
Şd_rbx
;

53 
__asm__
 
	`__vŞ©e__
 (

55 #ifdeà
BOUNDED_RBX


61 #iâdeà
_ILP32


91 "\t" 
LOCK_PREFIX
 "cmpxchgw %%cx, (%%rdi)\n"

94 "\t" 
XSUB
 " %%edx, %%ecx\n"

96 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%rbx)\n"

118 #iâdeà
_ILP32


133 #ifdeà
BOUNDED_RBX


136 : [
size
] "+&rm" (size)

137 #ifdeà
BOUNDED_RBX


138 , [
Şd_rbx
] "=m" (old_rbx)

140 : [
d¡
] "m" (d¡), [
¤c
] "m" (¤c), [
sum
] "m" (sum),

141 [
d¡_¡•
] "im" (d¡_¡•), [
¤c_¡•
] "im" (src_step),

142 [
sum_¡•
] "im" (sum_step)

144 #iâdeà
BOUNDED_RBX


147 #ifdeà
HAVE_MMX


154 
	}
}

159 
	$MIX_AREAS_32
(
size
,

160 vŞ©sigÃd *
d¡
, sigÃd *
¤c
,

161 vŞ©sigÃd *
sum
, 
size_t
 
d¡_¡•
,

162 
size_t
 
¤c_¡•
, size_ˆ
sum_¡•
)

164 #ifdeà
BOUNDED_RBX


165 
Şd_rbx
;

175 
__asm__
 
	`__vŞ©e__
 (

177 #ifdeà
BOUNDED_RBX


183 #iâdeà
_ILP32


213 "\t" 
LOCK_PREFIX
 "cmpxchgl %%ecx, (%%rdi)\n"

218 "\t" 
XSUB
 " %%edx, %%ecx\n"

225 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%rbx)\n"

262 #iâdeà
_ILP32


275 #ifdeà
BOUNDED_RBX


278 : [
size
] "+&rm" (size)

279 #ifdeà
BOUNDED_RBX


280 , [
Şd_rbx
] "=m" (old_rbx)

282 : [
d¡
] "m" (d¡), [
¤c
] "m" (¤c), [
sum
] "m" (sum),

283 [
d¡_¡•
] "im" (d¡_¡•), [
¤c_¡•
] "im" (src_step),

284 [
sum_¡•
] "im" (sum_step)

286 #iâdeà
BOUNDED_RBX


290 
	}
}

295 
	$MIX_AREAS_24
(
size
,

296 vŞ©*
d¡
, *
¤c
,

297 vŞ©sigÃd *
sum
, 
size_t
 
d¡_¡•
,

298 
size_t
 
¤c_¡•
, size_ˆ
sum_¡•
)

300 #ifdeà
BOUNDED_RBX


301 
Şd_rbx
;

311 
__asm__
 
	`__vŞ©e__
 (

313 #ifdeà
BOUNDED_RBX


319 #iâdeà
_ILP32


351 "\t" 
LOCK_PREFIX
 "btsw $0, (%%rdi)\n"

353 "\t" 
XSUB
 " %%edx, %%ecx\n"

355 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%rbx)\n"

386 #iâdeà
_ILP32


399 #ifdeà
BOUNDED_RBX


402 : [
size
] "+&rm" (size)

403 #ifdeà
BOUNDED_RBX


404 , [
Şd_rbx
] "=m" (old_rbx)

406 : [
d¡
] "m" (d¡), [
¤c
] "m" (¤c), [
sum
] "m" (sum),

407 [
d¡_¡•
] "im" (d¡_¡•), [
¤c_¡•
] "im" (src_step),

408 [
sum_¡•
] "im" (sum_step)

410 #iâdeà
BOUNDED_RBX


414 
	}
}

416 #ifdeà
BOUNDED_RBX


417 #undeà
BOUNDED_RBX


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dshare.c

29 
	~"pcm_loÿl.h
"

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<¡ddef.h
>

33 
	~<uni¡d.h
>

34 
	~<sigÇl.h
>

35 
	~<¡ršg.h
>

36 
	~<fú.h
>

37 
	~<ùy³.h
>

38 
	~<g½.h
>

39 
	~<sys/ioùl.h
>

40 
	~<sys/mmª.h
>

41 
	~<sys/shm.h
>

42 
	~<sys/£m.h
>

43 
	~<sys/wa™.h
>

44 
	~<sys/sock‘.h
>

45 
	~<sys/un.h
>

46 
	~<sys/mmª.h
>

47 
	~"pcm_dœeù.h
"

49 #iâdeà
PIC


51 cÚ¡ *
	g_¢d_moduË_pcm_dsh¬e
 = "";

54 #iâdeà
DOC_HIDDEN


56 
	#STATE_RUN_PENDING
 1024

	)

59 
	$do_s’û
(
¢d_pcm_t
 *
pcm
)

61 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

62 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
;

63 
chn
, 
dchn
, 
chªÃls
;

64 
¢d_pcm_fÜm©_t
 
fÜm©
;

66 
d¡_¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
dsh¬e
->
¥cm
);

67 
chªÃls
 = 
dsh¬e
->channels;

68 
fÜm©
 = 
dsh¬e
->
shm±r
->
s
.format;

69 
chn
 = 0; chÀ< 
chªÃls
; chn++) {

70 
dchn
 = 
dsh¬e
->
bšdšgs
 ? dsh¬e->bšdšgs[
chn
] : chn;

71 ià(
dchn
 !ğ
UINT_MAX
)

72 
	`¢d_pcm_¬—_s’û
(&
d¡_¬—s
[
dchn
], 0,

73 
dsh¬e
->
shm±r
->
s
.
bufãr_size
, 
fÜm©
);

75 
	}
}

77 
	$sh¬e_¬—s
(
¢d_pcm_dœeù_t
 *
dsh¬e
,

78 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

79 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

80 
¢d_pcm_uäames_t
 
¤c_ofs
,

81 
¢d_pcm_uäames_t
 
d¡_ofs
,

82 
¢d_pcm_uäames_t
 
size
)

84 
chn
, 
dchn
, 
chªÃls
;

85 
¢d_pcm_fÜm©_t
 
fÜm©
;

87 
chªÃls
 = 
dsh¬e
->channels;

88 
fÜm©
 = 
dsh¬e
->
shm±r
->
s
.format;

89 ià(
dsh¬e
->
š‹¾—ved
) {

90 
fby‹s
 = 
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
) / 8;

91 
	`memıy
(((*)
d¡_¬—s
[0].
addr
è+ (
d¡_ofs
 * 
chªÃls
 * 
fby‹s
),

92 ((*)
¤c_¬—s
[0].
addr
è+ (
¤c_ofs
 * 
chªÃls
 * 
fby‹s
),

93 
size
 * 
chªÃls
 * 
fby‹s
);

95 
chn
 = 0; chÀ< 
chªÃls
; chn++) {

96 
dchn
 = 
dsh¬e
->
bšdšgs
 ? dsh¬e->bšdšgs[
chn
] : chn;

97 ià(
dchn
 !ğ
UINT_MAX
)

98 
	`¢d_pcm_¬—_cİy
(&
d¡_¬—s
[
dchn
], 
d¡_ofs
,

99 &
¤c_¬—s
[
chn
], 
¤c_ofs
, 
size
, 
fÜm©
);

103 
	}
}

108 
	$¢d_pcm_dsh¬e_sync_¬—
(
¢d_pcm_t
 *
pcm
)

110 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

111 
¢d_pcm_uäames_t
 
¦ave_hw_±r
, 
¦ave_­¶_±r
, 
¦ave_size
;

112 
¢d_pcm_uäames_t
 
­¶_±r
, 
size
;

113 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
, *
d¡_¬—s
;

116 
size
 = 
	`pcm_äame_diff
(
dsh¬e
->
­¶_±r
, dsh¬e->
Ï¡_­¶_±r
, 
pcm
->
bound¬y
);

117 ià(! 
size
)

119 
¦ave_hw_±r
 = 
dsh¬e
->slave_hw_ptr;

123 
¦ave_hw_±r
 -ğ¦ave_hw_±¸% 
dsh¬e
->
¦ave_³riod_size
;

124 
¦ave_hw_±r
 +ğ
dsh¬e
->
¦ave_bufãr_size
;

125 ià(
¦ave_hw_±r
 >ğ
dsh¬e
->
¦ave_bound¬y
)

126 
¦ave_hw_±r
 -ğ
dsh¬e
->
¦ave_bound¬y
;

127 
¦ave_size
 = 
	`pcm_äame_diff
(
¦ave_hw_±r
, 
dsh¬e
->
¦ave_­¶_±r
, dsh¬e->
¦ave_bound¬y
);

128 ià(
¦ave_size
 < 
size
)

129 
size
 = 
¦ave_size
;

130 ià(! 
size
)

134 
¤c_¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

135 
d¡_¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
dsh¬e
->
¥cm
);

136 
­¶_±r
 = 
dsh¬e
->
Ï¡_­¶_±r
 % 
pcm
->
bufãr_size
;

137 
dsh¬e
->
Ï¡_­¶_±r
 +ğ
size
;

138 
dsh¬e
->
Ï¡_­¶_±r
 %ğ
pcm
->
bound¬y
;

139 
¦ave_­¶_±r
 = 
dsh¬e
->¦ave_­¶_±¸% dsh¬e->
¦ave_bufãr_size
;

140 
dsh¬e
->
¦ave_­¶_±r
 +ğ
size
;

141 
dsh¬e
->
¦ave_­¶_±r
 %ğdsh¬e->
¦ave_bound¬y
;

143 
¢d_pcm_uäames_t
 
Œªsãr
 = 
size
;

144 ià(
­¶_±r
 + 
Œªsãr
 > 
pcm
->
bufãr_size
)

145 
Œªsãr
 = 
pcm
->
bufãr_size
 - 
­¶_±r
;

146 ià(
¦ave_­¶_±r
 + 
Œªsãr
 > 
dsh¬e
->
¦ave_bufãr_size
)

147 
Œªsãr
 = 
dsh¬e
->
¦ave_bufãr_size
 - 
¦ave_­¶_±r
;

148 
	`sh¬e_¬—s
(
dsh¬e
, 
¤c_¬—s
, 
d¡_¬—s
, 
­¶_±r
, 
¦ave_­¶_±r
, 
Œªsãr
);

149 
size
 -ğ
Œªsãr
;

150 ià(! 
size
)

152 
¦ave_­¶_±r
 +ğ
Œªsãr
;

153 
¦ave_­¶_±r
 %ğ
dsh¬e
->
¦ave_bufãr_size
;

154 
­¶_±r
 +ğ
Œªsãr
;

155 
­¶_±r
 %ğ
pcm
->
bufãr_size
;

157 
	}
}

162 
	$¢d_pcm_dsh¬e_sync_±r0
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
¦ave_hw_±r
)

164 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

165 
¢d_pcm_uäames_t
 
Şd_¦ave_hw_±r
, 
ava
;

166 
¢d_pcm_säames_t
 
diff
;

168 
Şd_¦ave_hw_±r
 = 
dsh¬e
->
¦ave_hw_±r
;

169 
dsh¬e
->
¦ave_hw_±r
 = slave_hw_ptr;

170 
diff
 = 
	`pcm_äame_diff
(
¦ave_hw_±r
, 
Şd_¦ave_hw_±r
, 
dsh¬e
->
¦ave_bound¬y
);

171 ià(
diff
 == 0)

173 ià(
dsh¬e
->
¡©e
 !ğ
SND_PCM_STATE_RUNNING
 &&

174 
dsh¬e
->
¡©e
 !ğ
SND_PCM_STATE_DRAINING
)

177 
dsh¬e
->
hw_±r
 +ğ
diff
;

178 
dsh¬e
->
hw_±r
 %ğ
pcm
->
bound¬y
;

180 ià(
pcm
->
¡İ_th»shŞd
 >ğpcm->
bound¬y
)

182 
ava
 = 
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
);

183 ià(
ava
 > 
dsh¬e
->
ava_max
)

184 
dsh¬e
->
ava_max
 = 
ava
;

185 ià(
ava
 >ğ
pcm
->
¡İ_th»shŞd
) {

186 
	`¢d_tim”_¡İ
(
dsh¬e
->
tim”
);

187 
	`do_s’û
(
pcm
);

188 
	`g‘time¡amp
(&
dsh¬e
->
Œigg”_t¡amp
, 
pcm
->
t¡amp_ty³
);

189 ià(
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
) {

190 
dsh¬e
->
¡©e
 = 
SND_PCM_STATE_XRUN
;

191  -
EPIPE
;

193 
dsh¬e
->
¡©e
 = 
SND_PCM_STATE_SETUP
;

195 
	`¢d_pcm_dœeù_ş—r_tim”_queue
(
dsh¬e
);

198 
	}
}

200 
	$¢d_pcm_dsh¬e_sync_±r
(
¢d_pcm_t
 *
pcm
)

202 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

203 
¢d_pcm_uäames_t
 
¦ave_hw_±r
;

204 
”r
;

206 ià(
dsh¬e
->
¦ow±r
)

207 
	`¢d_pcm_hwsync
(
dsh¬e
->
¥cm
);

208 
¦ave_hw_±r
 = *
dsh¬e
->
¥cm
->
hw
.
±r
;

209 
”r
 = 
	`¢d_pcm_dœeù_check_xrun
(
dsh¬e
, 
pcm
);

210 ià(
”r
 < 0)

211  
”r
;

213  
	`¢d_pcm_dsh¬e_sync_±r0
(
pcm
, 
¦ave_hw_±r
);

214 
	}
}

220 
¢d_pcm_¡©e_t
 
¢d_pcm_dsh¬e_¡©e
(
¢d_pcm_t
 *
pcm
);

222 
	$¢d_pcm_dsh¬e_¡©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©us_t
 * 
¡©us
)

224 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

226 
	`mem£t
(
¡©us
, 0, (*status));

227 
	`¢d_pcm_¡©us
(
dsh¬e
->
¥cm
, 
¡©us
);

229 
dsh¬e
->
¡©e
) {

230 
SNDRV_PCM_STATE_DRAINING
:

231 
SNDRV_PCM_STATE_RUNNING
:

232 
	`¢d_pcm_dsh¬e_sync_±r0
(
pcm
, 
¡©us
->
hw_±r
);

233 
¡©us
->
d–ay
 = 
	`¢d_pcm_mm­_¶ayback_d–ay
(
pcm
);

238 
¡©us
->
¡©e
 = 
	`¢d_pcm_dsh¬e_¡©e
(
pcm
);

239 
¡©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

240 
¡©us
->
­¶_±r
 = *
pcm
->
­¶
.
±r
;

241 
¡©us
->
Œigg”_t¡amp
 = 
dsh¬e
->trigger_tstamp;

242 
¡©us
->
ava
 = 
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
);

243 
¡©us
->
ava_max
 = stus->
ava
 > 
dsh¬e
->avail_max ? status->avail : dshare->avail_max;

244 
dsh¬e
->
ava_max
 = 0;

246 
	}
}

248 
¢d_pcm_¡©e_t
 
	$¢d_pcm_dsh¬e_¡©e
(
¢d_pcm_t
 *
pcm
)

250 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

252 
	`¢d_pcm_dœeù_check_xrun
(
dsh¬e
, 
pcm
);

253 ià(
dsh¬e
->
¡©e
 =ğ
STATE_RUN_PENDING
)

254  
SNDRV_PCM_STATE_RUNNING
;

255  
dsh¬e
->
¡©e
;

256 
	}
}

258 
	$¢d_pcm_dsh¬e_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
)

260 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

261 
”r
;

263 
dsh¬e
->
¡©e
) {

264 
SNDRV_PCM_STATE_DRAINING
:

265 
SNDRV_PCM_STATE_RUNNING
:

266 
”r
 = 
	`¢d_pcm_dsh¬e_sync_±r
(
pcm
);

267 ià(
”r
 < 0)

268  
”r
;

270 
SNDRV_PCM_STATE_PREPARED
:

271 
SNDRV_PCM_STATE_SUSPENDED
:

272 
STATE_RUN_PENDING
:

273 *
d–ayp
 = 
	`¢d_pcm_mm­_¶ayback_d–ay
(
pcm
);

275 
SNDRV_PCM_STATE_XRUN
:

276  -
EPIPE
;

277 
SNDRV_PCM_STATE_DISCONNECTED
:

278  -
ENODEV
;

280  -
EBADFD
;

282 
	}
}

284 
	$¢d_pcm_dsh¬e_hwsync
(
¢d_pcm_t
 *
pcm
)

286 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

288 
dsh¬e
->
¡©e
) {

289 
SNDRV_PCM_STATE_DRAINING
:

290 
SNDRV_PCM_STATE_RUNNING
:

291  
	`¢d_pcm_dsh¬e_sync_±r
(
pcm
);

292 
SNDRV_PCM_STATE_PREPARED
:

293 
SNDRV_PCM_STATE_SUSPENDED
:

295 
SNDRV_PCM_STATE_XRUN
:

296  -
EPIPE
;

297 
SNDRV_PCM_STATE_DISCONNECTED
:

298  -
ENODEV
;

300  -
EBADFD
;

302 
	}
}

304 
	$¢d_pcm_dsh¬e_»£t
(
¢d_pcm_t
 *
pcm
)

306 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

307 
dsh¬e
->
hw_±r
 %ğ
pcm
->
³riod_size
;

308 
dsh¬e
->
­¶_±r
 = dsh¬e->
Ï¡_­¶_±r
 = dsh¬e->
hw_±r
;

309 
	`¢d_pcm_dœeù_»£t_¦ave_±r
(
pcm
, 
dsh¬e
, *dsh¬e->
¥cm
->
hw
.
±r
);

311 
	}
}

313 
	$¢d_pcm_dsh¬e_¡¬t_tim”
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_dœeù_t
 *
dsh¬e
)

315 
”r
;

317 
	`¢d_pcm_hwsync
(
dsh¬e
->
¥cm
);

318 
	`¢d_pcm_dœeù_»£t_¦ave_±r
(
pcm
, 
dsh¬e
, *dsh¬e->
¥cm
->
hw
.
±r
);

319 
”r
 = 
	`¢d_tim”_¡¬t
(
dsh¬e
->
tim”
);

320 ià(
”r
 < 0)

321  
”r
;

322 
dsh¬e
->
¡©e
 = 
SND_PCM_STATE_RUNNING
;

324 
	}
}

326 
	$¢d_pcm_dsh¬e_¡¬t
(
¢d_pcm_t
 *
pcm
)

328 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

329 
¢d_pcm_säames_t
 
ava
;

330 
”r
;

332 ià(
dsh¬e
->
¡©e
 !ğ
SND_PCM_STATE_PREPARED
)

333  -
EBADFD
;

334 
ava
 = 
	`¢d_pcm_mm­_¶ayback_hw_ava
(
pcm
);

335 ià(
ava
 == 0)

336 
dsh¬e
->
¡©e
 = 
STATE_RUN_PENDING
;

337 ià(
ava
 < 0)

340 
”r
 = 
	`¢d_pcm_dsh¬e_¡¬t_tim”
(
pcm
, 
dsh¬e
);

341 ià(
”r
 < 0)

342  
”r
;

343 
	`¢d_pcm_dsh¬e_sync_¬—
(
pcm
);

345 
	`g‘time¡amp
(&
dsh¬e
->
Œigg”_t¡amp
, 
pcm
->
t¡amp_ty³
);

347 
	}
}

349 
	$¢d_pcm_dsh¬e_drİ
(
¢d_pcm_t
 *
pcm
)

351 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

352 ià(
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_OPEN
)

353  -
EBADFD
;

354 
dsh¬e
->
¡©e
 = 
SND_PCM_STATE_SETUP
;

355 
	`¢d_pcm_dœeù_tim”_¡İ
(
dsh¬e
);

356 
	`do_s’û
(
pcm
);

358 
	}
}

361 
	$__¢d_pcm_dsh¬e_d¿š
(
¢d_pcm_t
 *
pcm
)

363 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

364 
¢d_pcm_uäames_t
 
¡İ_th»shŞd
;

365 
”r
;

367 
	`¢d_pcm_¡©e
(
dsh¬e
->
¥cm
)) {

368 
SND_PCM_STATE_SUSPENDED
:

369  -
ESTRPIPE
;

374 ià(
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_OPEN
)

375  -
EBADFD
;

376 ià(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
)

377  -
EAGAIN
;

378 ià(
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_PREPARED
) {

379 ià(
	`¢d_pcm_mm­_¶ayback_hw_ava
(
pcm
) > 0)

380 
	`¢d_pcm_dsh¬e_¡¬t
(
pcm
);

382 
	`¢d_pcm_dsh¬e_drİ
(
pcm
);

387 ià(
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_XRUN
) {

388 
	`¢d_pcm_dsh¬e_drİ
(
pcm
);

392 
¡İ_th»shŞd
 = 
pcm
->stop_threshold;

393 ià(
pcm
->
¡İ_th»shŞd
 >…cm->
bufãr_size
)

394 
pcm
->
¡İ_th»shŞd
 =…cm->
bufãr_size
;

395 
dsh¬e
->
¡©e
 = 
SND_PCM_STATE_DRAINING
;

397 
”r
 = 
	`¢d_pcm_dsh¬e_sync_±r
(
pcm
);

398 ià(
”r
 < 0) {

399 
	`¢d_pcm_dsh¬e_drİ
(
pcm
);

402 ià(
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
) {

403 
	`¢d_pcm_dsh¬e_sync_¬—
(
pcm
);

404 
	`¢d_pcm_wa™_nocheck
(
pcm
, 
SND_PCM_WAIT_DRAIN
);

405 
	`¢d_pcm_dœeù_ş—r_tim”_queue
(
dsh¬e
);

407 
	`¢d_pcm_¡©e
(
dsh¬e
->
¥cm
)) {

408 
SND_PCM_STATE_SUSPENDED
:

409  -
ESTRPIPE
;

414 } 
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
);

415 
pcm
->
¡İ_th»shŞd
 = stop_threshold;

417 
	}
}

419 
	$¢d_pcm_dsh¬e_d¿š
(
¢d_pcm_t
 *
pcm
)

421 
”r
;

423 
	`¢d_pcm_lock
(
pcm
);

424 
”r
 = 
	`__¢d_pcm_dsh¬e_d¿š
(
pcm
);

425 
	`¢d_pcm_uÆock
(
pcm
);

426  
”r
;

427 
	}
}

429 
	$¢d_pcm_dsh¬e_·u£
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
’abË
 ATTRIBUTE_UNUSED)

431  -
EIO
;

432 
	}
}

434 
¢d_pcm_säames_t
 
	$¢d_pcm_dsh¬e_»wšdabË
(
¢d_pcm_t
 *
pcm
)

436  
	`¢d_pcm_mm­_¶ayback_hw_»wšdabË
(
pcm
);

437 
	}
}

439 
¢d_pcm_säames_t
 
	$¢d_pcm_dsh¬e_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

441 
¢d_pcm_säames_t
 
ava
;

443 
ava
 = 
	`¢d_pcm_dsh¬e_»wšdabË
(
pcm
);

444 ià(
äames
 > (
¢d_pcm_uäames_t
)
ava
)

445 
äames
 = 
ava
;

446 
	`¢d_pcm_mm­_­¶_backw¬d
(
pcm
, 
äames
);

447  
äames
;

448 
	}
}

450 
¢d_pcm_säames_t
 
	$¢d_pcm_dsh¬e_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
)

452  
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
);

453 
	}
}

455 
¢d_pcm_säames_t
 
	$¢d_pcm_dsh¬e_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

457 
¢d_pcm_säames_t
 
ava
;

459 
ava
 = 
	`¢d_pcm_dsh¬e_fÜw¬dabË
(
pcm
);

460 ià(
äames
 > (
¢d_pcm_uäames_t
)
ava
)

461 
äames
 = 
ava
;

462 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
äames
);

463  
äames
;

464 
	}
}

466 
¢d_pcm_säames_t
 
	$¢d_pcm_dsh¬e_»adi
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, *
bufãr
 ATTRIBUTE_UNUSED, 
¢d_pcm_uäames_t
 
size
 ATTRIBUTE_UNUSED)

468  -
ENODEV
;

469 
	}
}

471 
¢d_pcm_säames_t
 
	$¢d_pcm_dsh¬e_»adn
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, **
bufs
 ATTRIBUTE_UNUSED, 
¢d_pcm_uäames_t
 
size
 ATTRIBUTE_UNUSED)

473  -
ENODEV
;

474 
	}
}

476 
	$¢d_pcm_dsh¬e_şo£
(
¢d_pcm_t
 *
pcm
)

478 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

480 ià(
dsh¬e
->
tim”
)

481 
	`¢d_tim”_şo£
(
dsh¬e
->
tim”
);

482 ià(
dsh¬e
->
bšdšgs
)

483 
	`do_s’û
(
pcm
);

484 
	`¢d_pcm_dœeù_£m­hÜe_down
(
dsh¬e
, 
DIRECT_IPC_SEM_CLIENT
);

485 
dsh¬e
->
shm±r
->
u
.dsh¬e.
chn_mask
 &= ~dshare->u.dshare.chn_mask;

486 
	`¢d_pcm_şo£
(
dsh¬e
->
¥cm
);

487 ià(
dsh¬e
->
£rv”
)

488 
	`¢d_pcm_dœeù_£rv”_disÿrd
(
dsh¬e
);

489 ià(
dsh¬e
->
ş›Á
)

490 
	`¢d_pcm_dœeù_ş›Á_disÿrd
(
dsh¬e
);

491 ià(
	`¢d_pcm_dœeù_shm_disÿrd
(
dsh¬e
)) {

492 ià(
	`¢d_pcm_dœeù_£m­hÜe_disÿrd
(
dsh¬e
))

493 
	`¢d_pcm_dœeù_£m­hÜe_fš®
(
dsh¬e
, 
DIRECT_IPC_SEM_CLIENT
);

495 
	`¢d_pcm_dœeù_£m­hÜe_fš®
(
dsh¬e
, 
DIRECT_IPC_SEM_CLIENT
);

496 
	`ä“
(
dsh¬e
->
bšdšgs
);

497 
pcm
->
´iv©e_d©a
 = 
NULL
;

498 
	`ä“
(
dsh¬e
);

500 
	}
}

502 
¢d_pcm_säames_t
 
	$¢d_pcm_dsh¬e_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

503 
¢d_pcm_uäames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

504 
¢d_pcm_uäames_t
 
size
)

506 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

507 
”r
;

509 
”r
 = 
	`¢d_pcm_dœeù_check_xrun
(
dsh¬e
, 
pcm
);

510 ià(
”r
 < 0)

511  
”r
;

512 ià(! 
size
)

514 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
size
);

515 ià(
dsh¬e
->
¡©e
 =ğ
STATE_RUN_PENDING
) {

516 
”r
 = 
	`¢d_pcm_dsh¬e_¡¬t_tim”
(
pcm
, 
dsh¬e
);

517 ià(
”r
 < 0)

518  
”r
;

519 } ià(
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
 ||

520 
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
) {

521 ià((
”r
 = 
	`¢d_pcm_dsh¬e_sync_±r
(
pcm
)) < 0)

522  
”r
;

524 ià(
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
 ||

525 
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
) {

528 
	`¢d_pcm_dsh¬e_sync_¬—
(
pcm
);

530 ià(
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
è<…cm->
ava_mš
)

531 
	`¢d_pcm_dœeù_ş—r_tim”_queue
(
dsh¬e
);

533  
size
;

534 
	}
}

536 
¢d_pcm_säames_t
 
	$¢d_pcm_dsh¬e_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

538 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

539 
”r
;

541 ià(
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
 ||

542 
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
) {

543 ià((
”r
 = 
	`¢d_pcm_dsh¬e_sync_±r
(
pcm
)) < 0)

544  
”r
;

546 ià(
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_XRUN
)

547  -
EPIPE
;

549  
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
);

550 
	}
}

552 
	$¢d_pcm_dsh¬e_htime¡amp
(
¢d_pcm_t
 *
pcm
,

553 
¢d_pcm_uäames_t
 *
ava
,

554 
¢d_htime¡amp_t
 *
t¡amp
)

556 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

557 
¢d_pcm_uäames_t
 
ava1
;

558 
ok
 = 0;

561 ià(
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
 ||

562 
dsh¬e
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
)

563 
	`¢d_pcm_dsh¬e_sync_±r
(
pcm
);

564 
ava1
 = 
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
);

565 ià(
ok
 && *
ava
 =ğ
ava1
)

567 *
ava
 = 
ava1
;

568 *
t¡amp
 = 
	`¢d_pcm_hw_ç¡_t¡amp
(
dsh¬e
->
¥cm
);

569 
ok
 = 1;

572 
	}
}

574 
	$¢d_pcm_dsh¬e_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

576 
¢d_pcm_dœeù_t
 *
dsh¬e
 = 
pcm
->
´iv©e_d©a
;

578 
	`¢d_ouut_´štf
(
out
, "Direct Share PCM\n");

579 ià(
pcm
->
£tup
) {

580 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

581 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

583 ià(
dsh¬e
->
¥cm
)

584 
	`¢d_pcm_dump
(
dsh¬e
->
¥cm
, 
out
);

585 
	}
}

587 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_dsh¬e_dummy_İs
 = {

588 .
şo£
 = 
¢d_pcm_dsh¬e_şo£
,

591 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_dsh¬e_ç¡_dummy_İs
;

593 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_dsh¬e_İs
 = {

594 .
şo£
 = 
¢d_pcm_dsh¬e_şo£
,

595 .
	gšfo
 = 
¢d_pcm_dœeù_šfo
,

596 .
	ghw_»fše
 = 
¢d_pcm_dœeù_hw_»fše
,

597 .
	ghw_·¿ms
 = 
¢d_pcm_dœeù_hw_·¿ms
,

598 .
	ghw_ä“
 = 
¢d_pcm_dœeù_hw_ä“
,

599 .
	gsw_·¿ms
 = 
¢d_pcm_dœeù_sw_·¿ms
,

600 .
	gchªÃl_šfo
 = 
¢d_pcm_dœeù_chªÃl_šfo
,

601 .
	gdump
 = 
¢d_pcm_dsh¬e_dump
,

602 .
	gnÚblock
 = 
¢d_pcm_dœeù_nÚblock
,

603 .
	gasync
 = 
¢d_pcm_dœeù_async
,

604 .
	gmm­
 = 
¢d_pcm_dœeù_mm­
,

605 .
	gmunm­
 = 
¢d_pcm_dœeù_munm­
,

606 .
	gg‘_chm­
 = 
¢d_pcm_dœeù_g‘_chm­
,

607 .
	g£t_chm­
 = 
¢d_pcm_dœeù_£t_chm­
,

610 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_dsh¬e_ç¡_İs
 = {

611 .
¡©us
 = 
¢d_pcm_dsh¬e_¡©us
,

612 .
	g¡©e
 = 
¢d_pcm_dsh¬e_¡©e
,

613 .
	ghwsync
 = 
¢d_pcm_dsh¬e_hwsync
,

614 .
	gd–ay
 = 
¢d_pcm_dsh¬e_d–ay
,

615 .
	g´•¬e
 = 
¢d_pcm_dœeù_´•¬e
,

616 .
	g»£t
 = 
¢d_pcm_dsh¬e_»£t
,

617 .
	g¡¬t
 = 
¢d_pcm_dsh¬e_¡¬t
,

618 .
	gdrİ
 = 
¢d_pcm_dsh¬e_drİ
,

619 .
	gd¿š
 = 
¢d_pcm_dsh¬e_d¿š
,

620 .
	g·u£
 = 
¢d_pcm_dsh¬e_·u£
,

621 .
	g»wšdabË
 = 
¢d_pcm_dsh¬e_»wšdabË
,

622 .
	g»wšd
 = 
¢d_pcm_dsh¬e_»wšd
,

623 .
	gfÜw¬dabË
 = 
¢d_pcm_dsh¬e_fÜw¬dabË
,

624 .
	gfÜw¬d
 = 
¢d_pcm_dsh¬e_fÜw¬d
,

625 .
	g»sume
 = 
¢d_pcm_dœeù_»sume
,

626 .
	glšk
 = 
NULL
,

627 .
	glšk_¦aves
 = 
NULL
,

628 .
	guÆšk
 = 
NULL
,

629 .
	gwr™ei
 = 
¢d_pcm_mm­_wr™ei
,

630 .
	gwr™’
 = 
¢d_pcm_mm­_wr™’
,

631 .
	g»adi
 = 
¢d_pcm_dsh¬e_»adi
,

632 .
	g»adn
 = 
¢d_pcm_dsh¬e_»adn
,

633 .
	gava_upd©e
 = 
¢d_pcm_dsh¬e_ava_upd©e
,

634 .
	gmm­_comm™
 = 
¢d_pcm_dsh¬e_mm­_comm™
,

635 .
	ghtime¡amp
 = 
¢d_pcm_dsh¬e_htime¡amp
,

636 .
	gpŞl_desütÜs
 = 
¢d_pcm_dœeù_pŞl_desütÜs
,

637 .
	gpŞl_desütÜs_couÁ
 = 
NULL
,

638 .
	gpŞl_»v’ts
 = 
¢d_pcm_dœeù_pŞl_»v’ts
,

656 
	$¢d_pcm_dsh¬e_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

657 
¢d_pcm_dœeù_İ’_cÚf
 *
İts
,

658 
¦ave_·¿ms
 *
·¿ms
,

659 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
scÚf
,

660 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

662 
¢d_pcm_t
 *
pcm
, *
¥cm
 = 
NULL
;

663 
¢d_pcm_dœeù_t
 *
dsh¬e
;

664 
»t
, 
fœ¡_š¡ªû
;

665 
chn
;

667 
	`as£¹
(
pcmp
);

669 ià(
¡»am
 !ğ
SND_PCM_STREAM_PLAYBACK
) {

670 
	`SNDERR
("The dshare…lugin supports only…layback stream");

671  -
EINVAL
;

674 
»t
 = 
	`_¢d_pcm_dœeù_Ãw
(&
pcm
, &
dsh¬e
, 
SND_PCM_TYPE_DSHARE
, 
Çme
, 
İts
, 
·¿ms
, 
¡»am
, 
mode
);

675 ià(
»t
 < 0)

676  
»t
;

677 
fœ¡_š¡ªû
 = 
»t
;

679 ià(!
dsh¬e
->
bšdšgs
) {

680 
pcm
->
İs
 = &
¢d_pcm_dsh¬e_dummy_İs
;

681 
pcm
->
ç¡_İs
 = &
¢d_pcm_dsh¬e_ç¡_dummy_İs
;

683 
pcm
->
İs
 = &
¢d_pcm_dsh¬e_İs
;

684 
pcm
->
ç¡_İs
 = &
¢d_pcm_dsh¬e_ç¡_İs
;

686 
pcm
->
´iv©e_d©a
 = 
dsh¬e
;

687 
dsh¬e
->
¡©e
 = 
SND_PCM_STATE_OPEN
;

688 
dsh¬e
->
¦ow±r
 = 
İts
->slowptr;

689 
dsh¬e
->
max_³riods
 = 
İts
->max_periods;

690 
dsh¬e
->
v¬_³riodsize
 = 
İts
->var_periodsize;

691 
dsh¬e
->
hw_±r_®ignm’t
 = 
İts
->hw_ptr_alignment;

692 
dsh¬e
->
sync_±r
 = 
¢d_pcm_dsh¬e_sync_±r
;

694 
»Œy
:

695 ià(
fœ¡_š¡ªû
) {

698 
»t
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
,

699 
mode
 | 
SND_PCM_NONBLOCK
, 
NULL
);

700 ià(
»t
 < 0) {

701 
	`SNDERR
("unableo open slave");

702 
_”r
;

705 ià(
	`¢d_pcm_ty³
(
¥cm
è!ğ
SND_PCM_TYPE_HW
) {

706 
	`SNDERR
("dshare…lugin can be only connectedo hw…lugin");

707 
_”r
;

710 
»t
 = 
	`¢d_pcm_dœeù_š™Ÿlize_¦ave
(
dsh¬e
, 
¥cm
, 
·¿ms
);

711 ià(
»t
 < 0) {

712 
	`SNDERR
("unableo initialize slave");

713 
_”r
;

716 
dsh¬e
->
¥cm
 = spcm;

718 ià(
dsh¬e
->
shm±r
->
u£_£rv”
) {

719 
»t
 = 
	`¢d_pcm_dœeù_£rv”_ü—‹
(
dsh¬e
);

720 ià(
»t
 < 0) {

721 
	`SNDERR
("unableo create server");

722 
_”r
;

726 
dsh¬e
->
shm±r
->
ty³
 = 
¥cm
->type;

728 ià(
dsh¬e
->
shm±r
->
u£_£rv”
) {

730 
	`¢d_pcm_dœeù_£m­hÜe_up
(
dsh¬e
, 
DIRECT_IPC_SEM_CLIENT
);

731 
»t
 = 
	`¢d_pcm_dœeù_ş›Á_cÚÃù
(
dsh¬e
);

732 ià(
»t
 < 0) {

733 
	`SNDERR
("unableo connect client");

734 
_”r_no£m
;

737 
	`¢d_pcm_dœeù_£m­hÜe_down
(
dsh¬e
, 
DIRECT_IPC_SEM_CLIENT
);

738 
»t
 = 
	`¢d_pcm_dœeù_İ’_£cÚd¬y_ş›Á
(&
¥cm
, 
dsh¬e
, "dshare_client");

739 ià(
»t
 < 0)

740 
_”r
;

744 
»t
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
,

745 
mode
 | 
SND_PCM_NONBLOCK
 |

746 
SND_PCM_APPEND
,

747 
NULL
);

748 ià(
»t
 < 0) {

752 ià(
»t
 =ğ-
EBADFD
) {

753 
fœ¡_š¡ªû
 = 1;

754 
»Œy
;

756 
	`SNDERR
("unableo open slave");

757 
_”r
;

759 ià(
	`¢d_pcm_ty³
(
¥cm
è!ğ
SND_PCM_TYPE_HW
) {

760 
	`SNDERR
("dshare…lugin can be only connectedo hw…lugin");

761 
»t
 = -
EINVAL
;

762 
_”r
;

765 
»t
 = 
	`¢d_pcm_dœeù_š™Ÿlize_£cÚd¬y_¦ave
(
dsh¬e
, 
¥cm
, 
·¿ms
);

766 ià(
»t
 < 0) {

767 
	`SNDERR
("unableo initialize slave");

768 
_”r
;

772 
dsh¬e
->
¥cm
 = spcm;

775 
chn
 = 0; 
dsh¬e
->
bšdšgs
 && (chÀ< dsh¬e->
chªÃls
); chn++) {

776 
dchn
 = 
dsh¬e
->
bšdšgs
 ? dsh¬e->bšdšgs[
chn
] : chn;

777 ià(
dchn
 !ğ
UINT_MAX
)

778 
dsh¬e
->
u
.dsh¬e.
chn_mask
 |ğ(1ULL << 
dchn
);

780 ià(
dsh¬e
->
shm±r
->
u
.dsh¬e.
chn_mask
 & dshare->u.dshare.chn_mask) {

781 
	`SNDERR
("destination channel specified in bindings is‡lready used");

782 
dsh¬e
->
u
.dsh¬e.
chn_mask
 = 0;

783 
»t
 = -
EINVAL
;

784 
_”r
;

786 
dsh¬e
->
shm±r
->
u
.dsh¬e.
chn_mask
 |= dshare->u.dshare.chn_mask;

788 
»t
 = 
	`¢d_pcm_dœeù_š™Ÿlize_pŞl_fd
(
dsh¬e
);

789 ià(
»t
 < 0) {

790 
	`SNDERR
("unableo initialize…oll_fd");

791 
_”r
;

794 
pcm
->
pŞl_fd
 = 
dsh¬e
->poll_fd;

795 
pcm
->
pŞl_ev’ts
 = 
POLLIN
;

796 
pcm
->
t¡amp_ty³
 = 
¥cm
->tstamp_type;

797 
pcm
->
mm­_rw
 = 1;

798 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
dsh¬e
->
hw_±r
, -1, 0);

799 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
dsh¬e
->
­¶_±r
, -1, 0);

801 
	`¢d_pcm_dœeù_£m­hÜe_up
(
dsh¬e
, 
DIRECT_IPC_SEM_CLIENT
);

803 *
pcmp
 = 
pcm
;

806 
_”r
:

807 ià(
dsh¬e
->
shm±r
 != (*) -1)

808 
dsh¬e
->
shm±r
->
u
.dsh¬e.
chn_mask
 &= ~dshare->u.dshare.chn_mask;

809 ià(
dsh¬e
->
tim”
)

810 
	`¢d_tim”_şo£
(
dsh¬e
->
tim”
);

811 ià(
dsh¬e
->
£rv”
)

812 
	`¢d_pcm_dœeù_£rv”_disÿrd
(
dsh¬e
);

813 ià(
dsh¬e
->
ş›Á
)

814 
	`¢d_pcm_dœeù_ş›Á_disÿrd
(
dsh¬e
);

815 ià(
¥cm
)

816 
	`¢d_pcm_şo£
(
¥cm
);

817 ià((
dsh¬e
->
shmid
 >ğ0è&& (
	`¢d_pcm_dœeù_shm_disÿrd
(dshare))) {

818 ià(
	`¢d_pcm_dœeù_£m­hÜe_disÿrd
(
dsh¬e
))

819 
	`¢d_pcm_dœeù_£m­hÜe_fš®
(
dsh¬e
, 
DIRECT_IPC_SEM_CLIENT
);

821 
	`¢d_pcm_dœeù_£m­hÜe_up
(
dsh¬e
, 
DIRECT_IPC_SEM_CLIENT
);

822 
_”r_no£m
:

823 
	`ä“
(
dsh¬e
->
bšdšgs
);

824 
	`ä“
(
dsh¬e
);

825 
	`¢d_pcm_ä“
(
pcm
);

826  
»t
;

827 
	}
}

921 
	$_¢d_pcm_dsh¬e_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

922 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

923 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

925 
¢d_cÚfig_t
 *
scÚf
;

926 
¦ave_·¿ms
 
·¿ms
;

927 
¢d_pcm_dœeù_İ’_cÚf
 
dİ’
;

928 
bsize
, 
psize
;

929 
”r
;

931 
”r
 = 
	`¢d_pcm_dœeù_·r£_İ’_cÚf
(
roÙ
, 
cÚf
, 
¡»am
, &
dİ’
);

932 ià(
”r
 < 0)

933  
”r
;

936 
·¿ms
.
fÜm©
 = 
SND_PCM_FORMAT_S16
;

937 
·¿ms
.
¿‹
 = 48000;

938 
·¿ms
.
chªÃls
 = 2;

939 
·¿ms
.
³riod_time
 = -1;

940 
·¿ms
.
bufãr_time
 = -1;

941 
bsize
 = 
psize
 = -1;

942 
·¿ms
.
³riods
 = 3;

943 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
dİ’
.
¦ave
, &
scÚf
, 8,

944 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_UNCHANGED
, &
·¿ms
.
fÜm©
,

945 
SND_PCM_HW_PARAM_RATE
, 0, &
·¿ms
.
¿‹
,

946 
SND_PCM_HW_PARAM_CHANNELS
, 0, &
·¿ms
.
chªÃls
,

947 
SND_PCM_HW_PARAM_PERIOD_TIME
, 0, &
·¿ms
.
³riod_time
,

948 
SND_PCM_HW_PARAM_BUFFER_TIME
, 0, &
·¿ms
.
bufãr_time
,

949 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 0, &
psize
,

950 
SND_PCM_HW_PARAM_BUFFER_SIZE
, 0, &
bsize
,

951 
SND_PCM_HW_PARAM_PERIODS
, 0, &
·¿ms
.
³riods
);

952 ià(
”r
 < 0)

953  
”r
;

956 ià(
psize
 =ğ-1 && 
·¿ms
.
³riod_time
 == -1)

957 
·¿ms
.
³riod_time
 = 125000;

959 ià(
·¿ms
.
fÜm©
 == -2)

960 
·¿ms
.
fÜm©
 = 
SND_PCM_FORMAT_UNKNOWN
;

962 
·¿ms
.
³riod_size
 = 
psize
;

963 
·¿ms
.
bufãr_size
 = 
bsize
;

965 
”r
 = 
	`¢d_pcm_dsh¬e_İ’
(
pcmp
, 
Çme
, &
dİ’
, &
·¿ms
,

966 
roÙ
, 
scÚf
, 
¡»am
, 
mode
);

967 
	`¢d_cÚfig_d–‘e
(
scÚf
);

968  
”r
;

969 
	}
}

970 #iâdeà
DOC_HIDDEN


971 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_dsh¬e_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dsnoop.c

29 
	~"pcm_loÿl.h
"

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<¡ddef.h
>

33 
	~<uni¡d.h
>

34 
	~<sigÇl.h
>

35 
	~<¡ršg.h
>

36 
	~<fú.h
>

37 
	~<ùy³.h
>

38 
	~<g½.h
>

39 
	~<sys/ioùl.h
>

40 
	~<sys/mmª.h
>

41 
	~<sys/shm.h
>

42 
	~<sys/£m.h
>

43 
	~<sys/wa™.h
>

44 
	~<sys/sock‘.h
>

45 
	~<sys/un.h
>

46 
	~<sys/mmª.h
>

47 
	~"pcm_dœeù.h
"

49 #iâdeà
PIC


51 cÚ¡ *
	g_¢d_moduË_pcm_d¢oİ
 = "";

58 
	$¢oİ_time¡amp
(
¢d_pcm_t
 *
pcm
)

60 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

61 
¢d_pcm_uäames_t
 
±r1
 = -2LL , 
±r2
;

65 
±r2
 = *
d¢oİ
->
¥cm
->
hw
.
±r
;

66 ià(
±r1
 =ğ
±r2
)

68 
±r1
 = 
±r2
;

69 
d¢oİ
->
upd©e_t¡amp
 = 
	`¢d_pcm_hw_ç¡_t¡amp
(d¢oİ->
¥cm
);

71 
d¢oİ
->
¦ave_hw_±r
 = 
±r1
;

73 
	}
}

75 
	$¢oİ_¬—s
(
¢d_pcm_dœeù_t
 *
d¢oİ
,

76 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

77 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

78 
¢d_pcm_uäames_t
 
¤c_ofs
,

79 
¢d_pcm_uäames_t
 
d¡_ofs
,

80 
¢d_pcm_uäames_t
 
size
)

82 
chn
, 
schn
, 
chªÃls
;

83 
¢d_pcm_fÜm©_t
 
fÜm©
;

85 
chªÃls
 = 
d¢oİ
->channels;

86 
fÜm©
 = 
d¢oİ
->
shm±r
->
s
.format;

87 ià(
d¢oİ
->
š‹¾—ved
) {

88 
fby‹s
 = 
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
) / 8;

89 
	`memıy
(((*)
d¡_¬—s
[0].
addr
è+ (
d¡_ofs
 * 
chªÃls
 * 
fby‹s
),

90 ((*)
¤c_¬—s
[0].
addr
è+ (
¤c_ofs
 * 
chªÃls
 * 
fby‹s
),

91 
size
 * 
chªÃls
 * 
fby‹s
);

93 
chn
 = 0; chÀ< 
chªÃls
; chn++) {

94 
schn
 = 
d¢oİ
->
bšdšgs
 ? d¢oİ->bšdšgs[
chn
] : chn;

95 
	`¢d_pcm_¬—_cİy
(&
d¡_¬—s
[
chn
], 
d¡_ofs
, &
¤c_¬—s
[
schn
], 
¤c_ofs
, 
size
, 
fÜm©
);

98 
	}
}

103 
	$¢d_pcm_d¢oİ_sync_¬—
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
¦ave_hw_±r
, snd_pcm_uäames_ˆ
size
)

105 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

106 
¢d_pcm_uäames_t
 
hw_±r
 = 
d¢oİ
->hw_ptr;

107 
¢d_pcm_uäames_t
 
Œªsãr
;

108 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
, *
d¡_¬—s
;

111 
d¡_¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

112 
¤c_¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
d¢oİ
->
¥cm
);

113 
hw_±r
 %ğ
pcm
->
bufãr_size
;

114 
¦ave_hw_±r
 %ğ
d¢oİ
->
¦ave_bufãr_size
;

115 
size
 > 0) {

116 
Œªsãr
 = 
hw_±r
 + 
size
 > 
pcm
->
bufãr_size
 ?…cm->buffer_size - hw_ptr : size;

117 
Œªsãr
 = 
¦ave_hw_±r
 +¿nsã¸> 
d¢oİ
->
¦ave_bufãr_size
 ?

118 
d¢oİ
->
¦ave_bufãr_size
 - 
¦ave_hw_±r
 : 
Œªsãr
;

119 
size
 -ğ
Œªsãr
;

120 
	`¢oİ_¬—s
(
d¢oİ
, 
¤c_¬—s
, 
d¡_¬—s
, 
¦ave_hw_±r
, 
hw_±r
, 
Œªsãr
);

121 
¦ave_hw_±r
 +ğ
Œªsãr
;

122 
¦ave_hw_±r
 %ğ
d¢oİ
->
¦ave_bufãr_size
;

123 
hw_±r
 +ğ
Œªsãr
;

124 
hw_±r
 %ğ
pcm
->
bufãr_size
;

126 
	}
}

131 
	$¢d_pcm_d¢oİ_sync_±r
(
¢d_pcm_t
 *
pcm
)

133 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

134 
¢d_pcm_uäames_t
 
¦ave_hw_±r
, 
Şd_¦ave_hw_±r
, 
ava
;

135 
¢d_pcm_säames_t
 
diff
;

136 
”r
;

138 ià(
d¢oİ
->
¦ow±r
)

139 
	`¢d_pcm_hwsync
(
d¢oİ
->
¥cm
);

140 
Şd_¦ave_hw_±r
 = 
d¢oİ
->
¦ave_hw_±r
;

141 
	`¢oİ_time¡amp
(
pcm
);

142 
¦ave_hw_±r
 = 
d¢oİ
->slave_hw_ptr;

143 
”r
 = 
	`¢d_pcm_dœeù_check_xrun
(
d¢oİ
, 
pcm
);

144 ià(
”r
 < 0)

145  
”r
;

146 
diff
 = 
	`pcm_äame_diff
(
¦ave_hw_±r
, 
Şd_¦ave_hw_±r
, 
d¢oİ
->
¦ave_bound¬y
);

147 ià(
diff
 == 0)

149 
	`¢d_pcm_d¢oİ_sync_¬—
(
pcm
, 
Şd_¦ave_hw_±r
, 
diff
);

150 
d¢oİ
->
hw_±r
 +ğ
diff
;

151 
d¢oİ
->
hw_±r
 %ğ
pcm
->
bound¬y
;

153 ià(
pcm
->
¡İ_th»shŞd
 >ğpcm->
bound¬y
)

155 ià((
ava
 = 
	`¢d_pcm_mm­_ÿ±u»_ava
(
pcm
)è>ğpcm->
¡İ_th»shŞd
) {

156 
	`g‘time¡amp
(&
d¢oİ
->
Œigg”_t¡amp
, 
pcm
->
t¡amp_ty³
);

157 
d¢oİ
->
¡©e
 = 
SND_PCM_STATE_XRUN
;

158 
d¢oİ
->
ava_max
 = 
ava
;

159  -
EPIPE
;

161 ià(
ava
 > 
d¢oİ
->
ava_max
)

162 
d¢oİ
->
ava_max
 = 
ava
;

164 
	}
}

170 
	$¢d_pcm_d¢oİ_¡©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©us_t
 * 
¡©us
)

172 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

173 
¢d_pcm_¡©e_t
 
¡©e
;

175 
d¢oİ
->
¡©e
) {

176 
SNDRV_PCM_STATE_DRAINING
:

177 
SNDRV_PCM_STATE_RUNNING
:

178 
	`¢d_pcm_d¢oİ_sync_±r
(
pcm
);

183 
	`mem£t
(
¡©us
, 0, (*status));

184 
	`¢d_pcm_¡©us
(
d¢oİ
->
¥cm
, 
¡©us
);

185 
¡©e
 = 
	`¢d_pcm_¡©e
(
d¢oİ
->
¥cm
);

186 
¡©us
->
¡©e
 = s‹ =ğ
SND_PCM_STATE_RUNNING
 ? 
d¢oİ
->state : state;

187 
¡©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

188 
¡©us
->
­¶_±r
 = *
pcm
->
­¶
.
±r
;

189 
¡©us
->
Œigg”_t¡amp
 = 
d¢oİ
->trigger_tstamp;

190 
¡©us
->
ava
 = 
	`¢d_pcm_mm­_ÿ±u»_ava
(
pcm
);

191 
¡©us
->
ava_max
 = stus->
ava
 > 
d¢oİ
->avail_max ? status->avail : dsnoop->avail_max;

192 
d¢oİ
->
ava_max
 = 0;

193 
¡©us
->
d–ay
 = 
	`¢d_pcm_mm­_ÿ±u»_d–ay
(
pcm
);

195 
	}
}

197 
¢d_pcm_¡©e_t
 
	$¢d_pcm_d¢oİ_¡©e
(
¢d_pcm_t
 *
pcm
)

199 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

201 
	`¢d_pcm_dœeù_check_xrun
(
d¢oİ
, 
pcm
);

202  
d¢oİ
->
¡©e
;

203 
	}
}

205 
	$¢d_pcm_d¢oİ_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
)

207 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

208 
”r
;

210 
d¢oİ
->
¡©e
) {

211 
SNDRV_PCM_STATE_DRAINING
:

212 
SNDRV_PCM_STATE_RUNNING
:

213 
”r
 = 
	`¢d_pcm_d¢oİ_sync_±r
(
pcm
);

214 ià(
”r
 < 0)

215  
”r
;

217 
SNDRV_PCM_STATE_PREPARED
:

218 
SNDRV_PCM_STATE_SUSPENDED
:

219 *
d–ayp
 = 
	`¢d_pcm_mm­_ÿ±u»_d–ay
(
pcm
);

221 
SNDRV_PCM_STATE_XRUN
:

222  -
EPIPE
;

223 
SNDRV_PCM_STATE_DISCONNECTED
:

224  -
ENODEV
;

226  -
EBADFD
;

228 
	}
}

230 
	$¢d_pcm_d¢oİ_hwsync
(
¢d_pcm_t
 *
pcm
)

232 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

234 
d¢oİ
->
¡©e
) {

235 
SNDRV_PCM_STATE_DRAINING
:

236 
SNDRV_PCM_STATE_RUNNING
:

237  
	`¢d_pcm_d¢oİ_sync_±r
(
pcm
);

238 
SNDRV_PCM_STATE_PREPARED
:

239 
SNDRV_PCM_STATE_SUSPENDED
:

241 
SNDRV_PCM_STATE_XRUN
:

242  -
EPIPE
;

243 
SNDRV_PCM_STATE_DISCONNECTED
:

244  -
ENODEV
;

246  -
EBADFD
;

248 
	}
}

250 
	$¢d_pcm_d¢oİ_»£t
(
¢d_pcm_t
 *
pcm
)

252 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

253 
d¢oİ
->
hw_±r
 %ğ
pcm
->
³riod_size
;

254 
d¢oİ
->
­¶_±r
 = d¢oİ->
hw_±r
;

255 
	`¢d_pcm_dœeù_»£t_¦ave_±r
(
pcm
, 
d¢oİ
, d¢oİ->
¦ave_hw_±r
);

257 
	}
}

259 
	$¢d_pcm_d¢oİ_¡¬t
(
¢d_pcm_t
 *
pcm
)

261 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

262 
”r
;

264 ià(
d¢oİ
->
¡©e
 !ğ
SND_PCM_STATE_PREPARED
)

265  -
EBADFD
;

266 
	`¢d_pcm_hwsync
(
d¢oİ
->
¥cm
);

267 
	`¢oİ_time¡amp
(
pcm
);

268 
	`¢d_pcm_dœeù_»£t_¦ave_±r
(
pcm
, 
d¢oİ
, d¢oİ->
¦ave_hw_±r
);

269 
”r
 = 
	`¢d_tim”_¡¬t
(
d¢oİ
->
tim”
);

270 ià(
”r
 < 0)

271  
”r
;

272 
d¢oİ
->
¡©e
 = 
SND_PCM_STATE_RUNNING
;

273 
d¢oİ
->
Œigg”_t¡amp
 = d¢oİ->
upd©e_t¡amp
;

275 
	}
}

277 
	$¢d_pcm_d¢oİ_drİ
(
¢d_pcm_t
 *
pcm
)

279 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

280 ià(
d¢oİ
->
¡©e
 =ğ
SND_PCM_STATE_OPEN
)

281  -
EBADFD
;

282 
d¢oİ
->
¡©e
 = 
SND_PCM_STATE_SETUP
;

283 
	`¢d_tim”_¡İ
(
d¢oİ
->
tim”
);

285 
	}
}

288 
	$__¢d_pcm_d¢oİ_d¿š
(
¢d_pcm_t
 *
pcm
)

290 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

291 
¢d_pcm_uäames_t
 
¡İ_th»shŞd
;

292 
”r
;

294 ià(
d¢oİ
->
¡©e
 =ğ
SND_PCM_STATE_OPEN
)

295  -
EBADFD
;

296 
¡İ_th»shŞd
 = 
pcm
->stop_threshold;

297 ià(
pcm
->
¡İ_th»shŞd
 >…cm->
bufãr_size
)

298 
pcm
->
¡İ_th»shŞd
 =…cm->
bufãr_size
;

299 
d¢oİ
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
) {

300 
”r
 = 
	`¢d_pcm_d¢oİ_sync_±r
(
pcm
);

301 ià(
”r
 < 0)

303 ià(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
)

304  -
EAGAIN
;

305 
	`__¢d_pcm_wa™_š_lock
(
pcm
, 
SND_PCM_WAIT_DRAIN
);

307 
pcm
->
¡İ_th»shŞd
 = stop_threshold;

308  
	`¢d_pcm_d¢oİ_drİ
(
pcm
);

309 
	}
}

311 
	$¢d_pcm_d¢oİ_d¿š
(
¢d_pcm_t
 *
pcm
)

313 
”r
;

315 
	`¢d_pcm_lock
(
pcm
);

316 
”r
 = 
	`__¢d_pcm_d¢oİ_d¿š
(
pcm
);

317 
	`¢d_pcm_uÆock
(
pcm
);

318  
”r
;

319 
	}
}

321 
	$¢d_pcm_d¢oİ_·u£
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
’abË
 ATTRIBUTE_UNUSED)

323  -
EIO
;

324 
	}
}

326 
¢d_pcm_säames_t
 
	$¢d_pcm_d¢oİ_»wšdabË
(
¢d_pcm_t
 *
pcm
)

328  
	`¢d_pcm_mm­_ÿ±u»_hw_»wšdabË
(
pcm
);

329 
	}
}

331 
¢d_pcm_säames_t
 
	$¢d_pcm_d¢oİ_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

333 
¢d_pcm_säames_t
 
ava
;

335 
ava
 = 
	`¢d_pcm_d¢oİ_»wšdabË
(
pcm
);

336 ià(
äames
 > (
¢d_pcm_uäames_t
)
ava
)

337 
äames
 = 
ava
;

338 
	`¢d_pcm_mm­_­¶_backw¬d
(
pcm
, 
äames
);

339  
äames
;

340 
	}
}

342 
¢d_pcm_säames_t
 
	$¢d_pcm_d¢oİ_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
)

344  
	`¢d_pcm_mm­_ÿ±u»_ava
(
pcm
);

345 
	}
}

347 
¢d_pcm_säames_t
 
	$¢d_pcm_d¢oİ_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

349 
¢d_pcm_säames_t
 
ava
;

351 
ava
 = 
	`¢d_pcm_d¢oİ_fÜw¬dabË
(
pcm
);

352 ià(
äames
 > (
¢d_pcm_uäames_t
)
ava
)

353 
äames
 = 
ava
;

354 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
äames
);

355  
äames
;

356 
	}
}

358 
¢d_pcm_säames_t
 
	$¢d_pcm_d¢oİ_wr™ei
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, cÚ¡ *
bufãr
 ATTRIBUTE_UNUSED, 
¢d_pcm_uäames_t
 
size
 ATTRIBUTE_UNUSED)

360  -
ENODEV
;

361 
	}
}

363 
¢d_pcm_säames_t
 
	$¢d_pcm_d¢oİ_wr™’
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, **
bufs
 ATTRIBUTE_UNUSED, 
¢d_pcm_uäames_t
 
size
 ATTRIBUTE_UNUSED)

365  -
ENODEV
;

366 
	}
}

368 
	$¢d_pcm_d¢oİ_şo£
(
¢d_pcm_t
 *
pcm
)

370 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

372 ià(
d¢oİ
->
tim”
)

373 
	`¢d_tim”_şo£
(
d¢oİ
->
tim”
);

374 
	`¢d_pcm_dœeù_£m­hÜe_down
(
d¢oİ
, 
DIRECT_IPC_SEM_CLIENT
);

375 
	`¢d_pcm_şo£
(
d¢oİ
->
¥cm
);

376 ià(
d¢oİ
->
£rv”
)

377 
	`¢d_pcm_dœeù_£rv”_disÿrd
(
d¢oİ
);

378 ià(
d¢oİ
->
ş›Á
)

379 
	`¢d_pcm_dœeù_ş›Á_disÿrd
(
d¢oİ
);

380 ià(
	`¢d_pcm_dœeù_shm_disÿrd
(
d¢oİ
)) {

381 ià(
	`¢d_pcm_dœeù_£m­hÜe_disÿrd
(
d¢oİ
))

382 
	`¢d_pcm_dœeù_£m­hÜe_fš®
(
d¢oİ
, 
DIRECT_IPC_SEM_CLIENT
);

384 
	`¢d_pcm_dœeù_£m­hÜe_fš®
(
d¢oİ
, 
DIRECT_IPC_SEM_CLIENT
);

385 
	`ä“
(
d¢oİ
->
bšdšgs
);

386 
pcm
->
´iv©e_d©a
 = 
NULL
;

387 
	`ä“
(
d¢oİ
);

389 
	}
}

391 
¢d_pcm_säames_t
 
	$¢d_pcm_d¢oİ_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

392 
¢d_pcm_uäames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

393 
¢d_pcm_uäames_t
 
size
)

395 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

396 
”r
;

398 
”r
 = 
	`¢d_pcm_dœeù_check_xrun
(
d¢oİ
, 
pcm
);

399 ià(
”r
 < 0)

400  
”r
;

401 ià(
d¢oİ
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
) {

402 
”r
 = 
	`¢d_pcm_d¢oİ_sync_±r
(
pcm
);

403 ià(
”r
 < 0)

404  
”r
;

406 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
size
);

408 ià(
	`¢d_pcm_mm­_ÿ±u»_ava
(
pcm
è<…cm->
ava_mš
)

409 
	`¢d_pcm_dœeù_ş—r_tim”_queue
(
d¢oİ
);

410  
size
;

411 
	}
}

413 
¢d_pcm_säames_t
 
	$¢d_pcm_d¢oİ_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

415 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

416 
”r
;

418 ià(
d¢oİ
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
) {

419 
”r
 = 
	`¢d_pcm_d¢oİ_sync_±r
(
pcm
);

420 ià(
”r
 < 0)

421  
”r
;

423 ià(
d¢oİ
->
¡©e
 =ğ
SND_PCM_STATE_XRUN
)

424  -
EPIPE
;

426  
	`¢d_pcm_mm­_ÿ±u»_ava
(
pcm
);

427 
	}
}

429 
	$¢d_pcm_d¢oİ_htime¡amp
(
¢d_pcm_t
 *
pcm
,

430 
¢d_pcm_uäames_t
 *
ava
,

431 
¢d_htime¡amp_t
 *
t¡amp
)

433 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

434 
¢d_pcm_uäames_t
 
ava1
;

435 
ok
 = 0;

438 ià(
d¢oİ
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
 ||

439 
d¢oİ
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
)

440 
	`¢d_pcm_d¢oİ_sync_±r
(
pcm
);

441 
ava1
 = 
	`¢d_pcm_mm­_ÿ±u»_ava
(
pcm
);

442 ià(
ok
 && *
ava
 =ğ
ava1
)

444 *
ava
 = 
ava1
;

445 *
t¡amp
 = 
	`¢d_pcm_hw_ç¡_t¡amp
(
d¢oİ
->
¥cm
);

446 
ok
 = 1;

449 
	}
}

451 
	$¢d_pcm_d¢oİ_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

453 
¢d_pcm_dœeù_t
 *
d¢oİ
 = 
pcm
->
´iv©e_d©a
;

455 
	`¢d_ouut_´štf
(
out
, "Direct Snoop PCM\n");

456 ià(
pcm
->
£tup
) {

457 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

458 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

460 ià(
d¢oİ
->
¥cm
)

461 
	`¢d_pcm_dump
(
d¢oİ
->
¥cm
, 
out
);

462 
	}
}

464 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_d¢oİ_İs
 = {

465 .
şo£
 = 
¢d_pcm_d¢oİ_şo£
,

466 .
	gšfo
 = 
¢d_pcm_dœeù_šfo
,

467 .
	ghw_»fše
 = 
¢d_pcm_dœeù_hw_»fše
,

468 .
	ghw_·¿ms
 = 
¢d_pcm_dœeù_hw_·¿ms
,

469 .
	ghw_ä“
 = 
¢d_pcm_dœeù_hw_ä“
,

470 .
	gsw_·¿ms
 = 
¢d_pcm_dœeù_sw_·¿ms
,

471 .
	gchªÃl_šfo
 = 
¢d_pcm_dœeù_chªÃl_šfo
,

472 .
	gdump
 = 
¢d_pcm_d¢oİ_dump
,

473 .
	gnÚblock
 = 
¢d_pcm_dœeù_nÚblock
,

474 .
	gasync
 = 
¢d_pcm_dœeù_async
,

475 .
	gmm­
 = 
¢d_pcm_dœeù_mm­
,

476 .
	gmunm­
 = 
¢d_pcm_dœeù_munm­
,

477 .
	gqu”y_chm­s
 = 
¢d_pcm_dœeù_qu”y_chm­s
,

478 .
	gg‘_chm­
 = 
¢d_pcm_dœeù_g‘_chm­
,

479 .
	g£t_chm­
 = 
¢d_pcm_dœeù_£t_chm­
,

482 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_d¢oİ_ç¡_İs
 = {

483 .
¡©us
 = 
¢d_pcm_d¢oİ_¡©us
,

484 .
	g¡©e
 = 
¢d_pcm_d¢oİ_¡©e
,

485 .
	ghwsync
 = 
¢d_pcm_d¢oİ_hwsync
,

486 .
	gd–ay
 = 
¢d_pcm_d¢oİ_d–ay
,

487 .
	g´•¬e
 = 
¢d_pcm_dœeù_´•¬e
,

488 .
	g»£t
 = 
¢d_pcm_d¢oİ_»£t
,

489 .
	g¡¬t
 = 
¢d_pcm_d¢oİ_¡¬t
,

490 .
	gdrİ
 = 
¢d_pcm_d¢oİ_drİ
,

491 .
	gd¿š
 = 
¢d_pcm_d¢oİ_d¿š
,

492 .
	g·u£
 = 
¢d_pcm_d¢oİ_·u£
,

493 .
	g»wšdabË
 = 
¢d_pcm_d¢oİ_»wšdabË
,

494 .
	g»wšd
 = 
¢d_pcm_d¢oİ_»wšd
,

495 .
	gfÜw¬dabË
 = 
¢d_pcm_d¢oİ_fÜw¬dabË
,

496 .
	gfÜw¬d
 = 
¢d_pcm_d¢oİ_fÜw¬d
,

497 .
	g»sume
 = 
¢d_pcm_dœeù_»sume
,

498 .
	glšk
 = 
NULL
,

499 .
	glšk_¦aves
 = 
NULL
,

500 .
	guÆšk
 = 
NULL
,

501 .
	gwr™ei
 = 
¢d_pcm_d¢oİ_wr™ei
,

502 .
	gwr™’
 = 
¢d_pcm_d¢oİ_wr™’
,

503 .
	g»adi
 = 
¢d_pcm_mm­_»adi
,

504 .
	g»adn
 = 
¢d_pcm_mm­_»adn
,

505 .
	gava_upd©e
 = 
¢d_pcm_d¢oİ_ava_upd©e
,

506 .
	gmm­_comm™
 = 
¢d_pcm_d¢oİ_mm­_comm™
,

507 .
	ghtime¡amp
 = 
¢d_pcm_d¢oİ_htime¡amp
,

508 .
	gpŞl_desütÜs
 = 
¢d_pcm_dœeù_pŞl_desütÜs
,

509 .
	gpŞl_desütÜs_couÁ
 = 
NULL
,

510 .
	gpŞl_»v’ts
 = 
¢d_pcm_dœeù_pŞl_»v’ts
,

528 
	$¢d_pcm_d¢oİ_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

529 
¢d_pcm_dœeù_İ’_cÚf
 *
İts
,

530 
¦ave_·¿ms
 *
·¿ms
,

531 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
scÚf
,

532 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

534 
¢d_pcm_t
 *
pcm
, *
¥cm
 = 
NULL
;

535 
¢d_pcm_dœeù_t
 *
d¢oİ
;

536 
»t
, 
fœ¡_š¡ªû
;

538 
	`as£¹
(
pcmp
);

540 ià(
¡»am
 !ğ
SND_PCM_STREAM_CAPTURE
) {

541 
	`SNDERR
("The dsnoop…lugin supports only capture stream");

542  -
EINVAL
;

545 
»t
 = 
	`_¢d_pcm_dœeù_Ãw
(&
pcm
, &
d¢oİ
, 
SND_PCM_TYPE_DSNOOP
, 
Çme
, 
İts
, 
·¿ms
, 
¡»am
, 
mode
);

546 ià(
»t
 < 0)

547  
»t
;

548 
fœ¡_š¡ªû
 = 
»t
;

550 
pcm
->
İs
 = &
¢d_pcm_d¢oİ_İs
;

551 
pcm
->
ç¡_İs
 = &
¢d_pcm_d¢oİ_ç¡_İs
;

552 
pcm
->
´iv©e_d©a
 = 
d¢oİ
;

553 
d¢oİ
->
¡©e
 = 
SND_PCM_STATE_OPEN
;

554 
d¢oİ
->
¦ow±r
 = 
İts
->slowptr;

555 
d¢oİ
->
max_³riods
 = 
İts
->max_periods;

556 
d¢oİ
->
v¬_³riodsize
 = 
İts
->var_periodsize;

557 
d¢oİ
->
sync_±r
 = 
¢d_pcm_d¢oİ_sync_±r
;

558 
d¢oİ
->
hw_±r_®ignm’t
 = 
İts
->hw_ptr_alignment;

560 
»Œy
:

561 ià(
fœ¡_š¡ªû
) {

564 
»t
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
,

565 
mode
 | 
SND_PCM_NONBLOCK
, 
NULL
);

566 ià(
»t
 < 0) {

567 
	`SNDERR
("unableo open slave");

568 
_”r
;

571 ià(
	`¢d_pcm_ty³
(
¥cm
è!ğ
SND_PCM_TYPE_HW
) {

572 
	`SNDERR
("dsnoop…lugin can be only connectedo hw…lugin");

573 
_”r
;

576 
»t
 = 
	`¢d_pcm_dœeù_š™Ÿlize_¦ave
(
d¢oİ
, 
¥cm
, 
·¿ms
);

577 ià(
»t
 < 0) {

578 
	`SNDERR
("unableo initialize slave");

579 
_”r
;

582 
d¢oİ
->
¥cm
 = spcm;

584 ià(
d¢oİ
->
shm±r
->
u£_£rv”
) {

585 
»t
 = 
	`¢d_pcm_dœeù_£rv”_ü—‹
(
d¢oİ
);

586 ià(
»t
 < 0) {

587 
	`SNDERR
("unableo create server");

588 
_”r
;

592 
d¢oİ
->
shm±r
->
ty³
 = 
¥cm
->type;

594 ià(
d¢oİ
->
shm±r
->
u£_£rv”
) {

596 
	`¢d_pcm_dœeù_£m­hÜe_up
(
d¢oİ
, 
DIRECT_IPC_SEM_CLIENT
);

597 
»t
 = 
	`¢d_pcm_dœeù_ş›Á_cÚÃù
(
d¢oİ
);

598 ià(
»t
 < 0) {

599 
	`SNDERR
("unableo connect client");

600 
_”r_no£m
;

603 
	`¢d_pcm_dœeù_£m­hÜe_down
(
d¢oİ
, 
DIRECT_IPC_SEM_CLIENT
);

605 
»t
 = 
	`¢d_pcm_dœeù_İ’_£cÚd¬y_ş›Á
(&
¥cm
, 
d¢oİ
, "dsnoop_client");

606 ià(
»t
 < 0)

607 
_”r
;

610 
»t
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
,

611 
mode
 | 
SND_PCM_NONBLOCK
 |

612 
SND_PCM_APPEND
,

613 
NULL
);

614 ià(
»t
 < 0) {

618 ià(
»t
 =ğ-
EBADFD
) {

619 
fœ¡_š¡ªû
 = 1;

620 
»Œy
;

622 
	`SNDERR
("unableo open slave");

623 
_”r
;

625 ià(
	`¢d_pcm_ty³
(
¥cm
è!ğ
SND_PCM_TYPE_HW
) {

626 
	`SNDERR
("dsnoop…lugin can be only connectedo hw…lugin");

627 
»t
 = -
EINVAL
;

628 
_”r
;

631 
»t
 = 
	`¢d_pcm_dœeù_š™Ÿlize_£cÚd¬y_¦ave
(
d¢oİ
, 
¥cm
, 
·¿ms
);

632 ià(
»t
 < 0) {

633 
	`SNDERR
("unableo initialize slave");

634 
_”r
;

638 
d¢oİ
->
¥cm
 = spcm;

641 
»t
 = 
	`¢d_pcm_dœeù_š™Ÿlize_pŞl_fd
(
d¢oİ
);

642 ià(
»t
 < 0) {

643 
	`SNDERR
("unableo initialize…oll_fd");

644 
_”r
;

647 
pcm
->
pŞl_fd
 = 
d¢oİ
->poll_fd;

648 
pcm
->
pŞl_ev’ts
 = 
POLLIN
;

649 
pcm
->
t¡amp_ty³
 = 
¥cm
->tstamp_type;

650 
pcm
->
mm­_rw
 = 1;

651 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
d¢oİ
->
hw_±r
, -1, 0);

652 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
d¢oİ
->
­¶_±r
, -1, 0);

654 ià(
d¢oİ
->
chªÃls
 =ğ
UINT_MAX
)

655 
d¢oİ
->
chªÃls
 = d¢oİ->
shm±r
->
s
.channels;

657 
	`¢d_pcm_dœeù_£m­hÜe_up
(
d¢oİ
, 
DIRECT_IPC_SEM_CLIENT
);

659 *
pcmp
 = 
pcm
;

662 
_”r
:

663 ià(
d¢oİ
->
tim”
)

664 
	`¢d_tim”_şo£
(
d¢oİ
->
tim”
);

665 ià(
d¢oİ
->
£rv”
)

666 
	`¢d_pcm_dœeù_£rv”_disÿrd
(
d¢oİ
);

667 ià(
d¢oİ
->
ş›Á
)

668 
	`¢d_pcm_dœeù_ş›Á_disÿrd
(
d¢oİ
);

669 ià(
¥cm
)

670 
	`¢d_pcm_şo£
(
¥cm
);

671 ià((
d¢oİ
->
shmid
 >ğ0è&& (
	`¢d_pcm_dœeù_shm_disÿrd
(dsnoop))) {

672 ià(
	`¢d_pcm_dœeù_£m­hÜe_disÿrd
(
d¢oİ
))

673 
	`¢d_pcm_dœeù_£m­hÜe_fš®
(
d¢oİ
, 
DIRECT_IPC_SEM_CLIENT
);

675 
	`¢d_pcm_dœeù_£m­hÜe_up
(
d¢oİ
, 
DIRECT_IPC_SEM_CLIENT
);

677 
_”r_no£m
:

678 
	`ä“
(
d¢oİ
->
bšdšgs
);

679 
	`ä“
(
d¢oİ
);

680 
	`¢d_pcm_ä“
(
pcm
);

681  
»t
;

682 
	}
}

773 
	$_¢d_pcm_d¢oİ_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

774 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

775 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

777 
¢d_cÚfig_t
 *
scÚf
;

778 
¦ave_·¿ms
 
·¿ms
;

779 
¢d_pcm_dœeù_İ’_cÚf
 
dİ’
;

780 
bsize
, 
psize
;

781 
”r
;

783 
”r
 = 
	`¢d_pcm_dœeù_·r£_İ’_cÚf
(
roÙ
, 
cÚf
, 
¡»am
, &
dİ’
);

784 ià(
”r
 < 0)

785  
”r
;

788 
·¿ms
.
fÜm©
 = 
SND_PCM_FORMAT_S16
;

789 
·¿ms
.
¿‹
 = 48000;

790 
·¿ms
.
chªÃls
 = 2;

791 
·¿ms
.
³riod_time
 = -1;

792 
·¿ms
.
bufãr_time
 = -1;

793 
bsize
 = 
psize
 = -1;

794 
·¿ms
.
³riods
 = 3;

795 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
dİ’
.
¦ave
, &
scÚf
, 8,

796 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_UNCHANGED
, &
·¿ms
.
fÜm©
,

797 
SND_PCM_HW_PARAM_RATE
, 0, &
·¿ms
.
¿‹
,

798 
SND_PCM_HW_PARAM_CHANNELS
, 0, &
·¿ms
.
chªÃls
,

799 
SND_PCM_HW_PARAM_PERIOD_TIME
, 0, &
·¿ms
.
³riod_time
,

800 
SND_PCM_HW_PARAM_BUFFER_TIME
, 0, &
·¿ms
.
bufãr_time
,

801 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 0, &
psize
,

802 
SND_PCM_HW_PARAM_BUFFER_SIZE
, 0, &
bsize
,

803 
SND_PCM_HW_PARAM_PERIODS
, 0, &
·¿ms
.
³riods
);

804 ià(
”r
 < 0)

805  
”r
;

808 ià(
psize
 =ğ-1 && 
·¿ms
.
³riod_time
 == -1)

809 
·¿ms
.
³riod_time
 = 125000;

811 ià(
·¿ms
.
fÜm©
 == -2)

812 
·¿ms
.
fÜm©
 = 
SND_PCM_FORMAT_UNKNOWN
;

814 
·¿ms
.
³riod_size
 = 
psize
;

815 
·¿ms
.
bufãr_size
 = 
bsize
;

817 
”r
 = 
	`¢d_pcm_d¢oİ_İ’
(
pcmp
, 
Çme
, &
dİ’
, &
·¿ms
,

818 
roÙ
, 
scÚf
, 
¡»am
, 
mode
);

819 
	`¢d_cÚfig_d–‘e
(
scÚf
);

820  
”r
;

821 
	}
}

822 #iâdeà
DOC_HIDDEN


823 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_d¢oİ_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_empty.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_¶ugš.h
"

32 #iâdeà
PIC


34 cÚ¡ *
	g_¢d_moduË_pcm_em±y
 = "";

79 
	$_¢d_pcm_em±y_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
 
ATTRIBUTE_UNUSED
,

80 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

81 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

83 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

84 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

85 
”r
;

87 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

88 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

89 cÚ¡ *
id
;

90 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

92 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

94 ià(
	`¡rcmp
(
id
, "slave") == 0) {

95 
¦ave
 = 
n
;

98 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

99  -
EINVAL
;

101 ià(!
¦ave
) {

102 
	`SNDERR
("slave is‚ot defined");

103  -
EINVAL
;

105 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 0);

106 ià(
”r
 < 0)

107  
”r
;

108 
”r
 = 
	`¢d_pcm_İ’_Çmed_¦ave
(
pcmp
, 
Çme
, 
roÙ
, 
scÚf
, 
¡»am
,

109 
mode
, 
cÚf
);

110 
	`¢d_cÚfig_d–‘e
(
scÚf
);

111  
”r
;

112 
	}
}

113 #iâdeà
DOC_HIDDEN


114 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_em±y_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_ext_parm.h

2 
	s¢d_ext_·rm
 {

3 
	mmš
, 
	mmax
;

4 
	mnum_li¡
;

5 *
	mli¡
;

6 
	maùive
: 1;

7 
	mš‹g”
: 1;

8 
	mk“p_lšk
: 1;

11 
šlše
 
¢d_mask_t
 *
	$hw_·¿m_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

12 
¢d_pcm_hw_·¿m_t
 
v¬
)

14  &
·¿ms
->
masks
[
v¬
 - 
SND_PCM_HW_PARAM_FIRST_MASK
];

15 
	}
}

17 
šlše
 
¢d_š‹rv®_t
 *
	$hw_·¿m_š‹rv®
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

18 
¢d_pcm_hw_·¿m_t
 
v¬
)

20  &
·¿ms
->
š‹rv®s
[
v¬
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
];

21 
	}
}

24 
	#¢d_ext_·rm_£t_mšmax
 \

25 
¢d1_ext_·rm_£t_mšmax


	)

26 
	#¢d_ext_·rm_£t_li¡
 \

27 
¢d1_ext_·rm_£t_li¡


	)

28 
	#¢d_ext_·rm_ş—r
 \

29 
¢d1_ext_·rm_ş—r


	)

30 
	#¢d_š‹rv®_li¡
 \

31 
¢d1_š‹rv®_li¡


	)

32 
	#¢d_ext_·rm_š‹rv®_»fše
 \

33 
¢d1_ext_·rm_š‹rv®_»fše


	)

34 
	#¢d_ext_·rm_mask_»fše
 \

35 
¢d1_ext_·rm_mask_»fše


	)

37 
¢d_ext_·rm_£t_mšmax
(
¢d_ext_·rm
 *
·rm
, 
mš
, 
max
);

38 
¢d_ext_·rm_£t_li¡
(
¢d_ext_·rm
 *
·rm
, 
num_li¡
, cÚ¡ *
li¡
);

39 
¢d_ext_·rm_ş—r
(
¢d_ext_·rm
 *
·rm
);

40 
¢d_š‹rv®_li¡
(
¢d_š‹rv®_t
 *
iv®
, 
num_li¡
, *
li¡
);

41 
¢d_ext_·rm_š‹rv®_»fše
(
¢d_š‹rv®_t
 *
iv®
, 
¢d_ext_·rm
 *
·rm
, 
ty³
);

42 
¢d_ext_·rm_mask_»fše
(
¢d_mask_t
 *
mask
, 
¢d_ext_·rm
 *
·rm
, 
ty³
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_extplug.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_¶ugš.h
"

31 
	~"pcm_exlug.h
"

32 
	~"pcm_ext_·rm.h
"

34 #iâdeà
PIC


36 cÚ¡ *
	g_¢d_moduË_pcm_exlug
 = "";

39 #iâdeà
DOC_HIDDEN


41 
	s¢d_pcm_exlug_´iv
 {

42 
¢d_pcm_¶ugš_t
 
	m¶ug
;

43 
¢d_pcm_exlug_t
 *
	md©a
;

44 
¢d_ext_·rm
 
	m·¿ms
[
SND_PCM_EXTPLUG_HW_PARAMS
];

45 
¢d_ext_·rm
 
	m¥¬ams
[
SND_PCM_EXTPLUG_HW_PARAMS
];

46 } 
	texlug_´iv_t
;

48 cÚ¡ 
	ghw_·¿ms_ty³
[
SND_PCM_EXTPLUG_HW_PARAMS
] = {

49 [
SND_PCM_EXTPLUG_HW_FORMAT
] = 
SND_PCM_HW_PARAM_FORMAT
,

50 [
SND_PCM_EXTPLUG_HW_CHANNELS
] = 
SND_PCM_HW_PARAM_CHANNELS


53 
	#is_mask_ty³
(
i
è(
hw_·¿ms_ty³
[i] < 
SND_PCM_HW_PARAM_FIRST_INTERVAL
)

	)

55 cÚ¡ 
	gexş_·rb™s
[
SND_PCM_EXTPLUG_HW_PARAMS
] = {

56 [
SND_PCM_EXTPLUG_HW_FORMAT
] = (
SND_PCM_HW_PARBIT_FORMAT
|

57 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

58 
SND_PCM_HW_PARBIT_SAMPLE_BITS
),

59 [
SND_PCM_EXTPLUG_HW_CHANNELS
] = (
SND_PCM_HW_PARBIT_CHANNELS
|

60 
SND_PCM_HW_PARBIT_FRAME_BITS
),

66 
	$¢d_ext_·rm_£t_mšmax
(
¢d_ext_·rm
 *
·rm
, 
mš
, 
max
)

68 
·rm
->
num_li¡
 = 0;

69 
	`ä“
(
·rm
->
li¡
);

70 
·rm
->
li¡
 = 
NULL
;

71 
·rm
->
mš
 = min;

72 
·rm
->
max
 = max;

73 
·rm
->
aùive
 = 1;

75 
	}
}

80 
	$v®_com·r
(cÚ¡ *
­
, cÚ¡ *
bp
)

82  *(cÚ¡ *)
­
 - *(cÚ¡ *)
bp
;

83 
	}
}

85 
	$¢d_ext_·rm_£t_li¡
(
¢d_ext_·rm
 *
·rm
, 
num_li¡
, cÚ¡ *
li¡
)

87 *
Ãw_li¡
;

89 
Ãw_li¡
 = 
	`m®loc
((*Ãw_li¡è* 
num_li¡
);

90 ià(
Ãw_li¡
 =ğ
NULL
)

91  -
ENOMEM
;

92 
	`memıy
(
Ãw_li¡
, 
li¡
, (*Ãw_li¡è* 
num_li¡
);

93 
	`qsÜt
(
Ãw_li¡
, 
num_li¡
, (*Ãw_li¡), 
v®_com·r
);

95 
	`ä“
(
·rm
->
li¡
);

96 
·rm
->
num_li¡
 =‚um_list;

97 
·rm
->
li¡
 = 
Ãw_li¡
;

98 
·rm
->
aùive
 = 1;

100 
	}
}

102 
	$¢d_ext_·rm_ş—r
(
¢d_ext_·rm
 *
·rm
)

104 
	`ä“
(
·rm
->
li¡
);

105 
	`mem£t
(
·rm
, 0, (*parm));

106 
	}
}

111 
	$¢d_š‹rv®_li¡
(
¢d_š‹rv®_t
 *
iv®
, 
num_li¡
, *
li¡
)

113 
imš
, 
imax
;

114 
chªged
 = 0;

116 ià(
	`¢d_š‹rv®_em±y
(
iv®
))

117  -
ENOENT
;

118 
imš
 = 0; imš < 
num_li¡
; imin++) {

119 ià(
iv®
->
mš
 =ğ
li¡
[
imš
] && ! iv®->
İ’mš
)

121 ià(
iv®
->
mš
 <ğ
li¡
[
imš
]) {

122 
iv®
->
mš
 = 
li¡
[
imš
];

123 
iv®
->
İ’mš
 = 0;

124 
chªged
 = 1;

128 ià(
imš
 >ğ
num_li¡
)

129  -
EINVAL
;

130 
imax
 = 
num_li¡
 - 1; imax >ğ
imš
; imax--) {

131 ià(
iv®
->
max
 =ğ
li¡
[
imax
] && ! iv®->
İ’max
)

133 ià(
iv®
->
max
 >ğ
li¡
[
imax
]) {

134 
iv®
->
max
 = 
li¡
[
imax
];

135 
iv®
->
İ’max
 = 0;

136 
chªged
 = 1;

140 ià(
imax
 < 
imš
)

141  -
EINVAL
;

142  
chªged
;

143 
	}
}

148 
	$¢d_ext_·rm_š‹rv®_»fše
(
¢d_š‹rv®_t
 *
iv®
, 
¢d_ext_·rm
 *
·rm
, 
ty³
)

150 
·rm
 +ğ
ty³
;

151 ià(! 
·rm
->
aùive
)

153 
iv®
->
š‹g”
 |ğ
·rm
->integer;

154 ià(
·rm
->
num_li¡
) {

155  
	`¢d_š‹rv®_li¡
(
iv®
, 
·rm
->
num_li¡
,…¬m->
li¡
);

156 } ià(
·rm
->
mš
 ||…¬m->
max
) {

157 
¢d_š‹rv®_t
 
t
;

158 
	`mem£t
(&
t
, 0, (t));

159 
	`¢d_š‹rv®_£t_mšmax
(&
t
, 
·rm
->
mš
,…¬m->
max
);

160 
t
.
š‹g”
 = 
iv®
->integer;

161  
	`¢d_š‹rv®_»fše
(
iv®
, &
t
);

164 
	}
}

169 
	$¢d_ext_·rm_mask_»fše
(
¢d_mask_t
 *
mask
, 
¢d_ext_·rm
 *
·rm
, 
ty³
)

171 
¢d_mask_t
 
b™s
;

172 
i
;

174 
·rm
 +ğ
ty³
;

175 ià(!
·rm
->
aùive
)

177 
	`mem£t
(&
b™s
, 0, (bits));

178 
i
 = 0; i < 
·rm
->
num_li¡
; i++)

179 
b™s
.b™s[
·rm
->
li¡
[
i
] / 32] |= 1U << (parm->list[i] % 32);

180  
	`¢d_mask_»fše
(
mask
, &
b™s
);

181 
	}
}

187 
	$exlug_hw_»fše
(
¢d_pcm_hw_·¿ms_t
 *
hw_·¿ms
,

188 
¢d_ext_·rm
 *
·rm
)

190 
i
, 
”r
, 
chªge
 = 0;

191 
i
 = 0; i < 
SND_PCM_EXTPLUG_HW_PARAMS
; i++) {

192 
ty³
 = 
hw_·¿ms_ty³
[
i
];

193 ià(
	`is_mask_ty³
(
i
))

194 
”r
 = 
	`¢d_ext_·rm_mask_»fše
(
	`hw_·¿m_mask
(
hw_·¿ms
, 
ty³
),

195 
·rm
, 
i
);

197 
”r
 = 
	`¢d_ext_·rm_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
hw_·¿ms
, 
ty³
),

198 
·rm
, 
i
);

199 ià(
”r
 < 0)

200  
”r
;

201 
chªge
 |ğ
”r
;

203  
chªge
;

204 
	}
}

206 
	$¢d_pcm_exlug_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
,

207 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

209 
exlug_´iv_t
 *
ext
 = 
pcm
->
´iv©e_d©a
;

210 
”r
;

211 
¢d_pcm_acûss_mask_t
 
acûss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

212 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

213 &
acûss_mask
);

214 ià(
”r
 < 0)

215  
”r
;

216 
”r
 = 
	`exlug_hw_»fše
(
·¿ms
, 
ext
->params);

217 ià(
”r
 < 0)

218  
”r
;

219 
·¿ms
->
šfo
 &ğ~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

221 
	}
}

223 
	$¢d_pcm_exlug_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
,

224 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

226 
exlug_´iv_t
 *
ext
 = 
pcm
->
´iv©e_d©a
;

227 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

228 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

229 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

230 &
§cûss_mask
);

231 
	`exlug_hw_»fše
(
¥¬ams
, 
ext
->sparams);

233 
	}
}

235 
	$g‘_lšks
(
¢d_ext_·rm
 *
·¿ms
)

237 
i
;

238 
lšks
 = (
SND_PCM_HW_PARBIT_FORMAT
 |

239 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

240 
SND_PCM_HW_PARBIT_SAMPLE_BITS
 |

241 
SND_PCM_HW_PARBIT_CHANNELS
 |

242 
SND_PCM_HW_PARBIT_FRAME_BITS
 |

243 
SND_PCM_HW_PARBIT_RATE
 |

244 
SND_PCM_HW_PARBIT_PERIODS
 |

245 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

246 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

247 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

248 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

249 
SND_PCM_HW_PARBIT_TICK_TIME
);

251 
i
 = 0; i < 
SND_PCM_EXTPLUG_HW_PARAMS
; i++) {

252 ià(
·¿ms
[
i
].
aùive
 && !·¿ms[i].
k“p_lšk
)

253 
lšks
 &ğ~
exş_·rb™s
[
i
];

255  
lšks
;

256 
	}
}

258 
	$¢d_pcm_exlug_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
,

259 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

260 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

262 
exlug_´iv_t
 *
ext
 = 
pcm
->
´iv©e_d©a
;

263 
lšks
 = 
	`g‘_lšks
(
ext
->
¥¬ams
);

265  
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

266 
	}
}

268 
	$¢d_pcm_exlug_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
,

269 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

270 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

272 
exlug_´iv_t
 *
ext
 = 
pcm
->
´iv©e_d©a
;

273 
lšks
 = 
	`g‘_lšks
(
ext
->
·¿ms
);

275  
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

276 
	}
}

278 
	$¢d_pcm_exlug_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

280 
”r
 = 
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

281 
¢d_pcm_exlug_hw_»fše_ı»·»
,

282 
¢d_pcm_exlug_hw_»fše_cchªge
,

283 
¢d_pcm_exlug_hw_»fše_¥»·»
,

284 
¢d_pcm_exlug_hw_»fše_schªge
,

285 
¢d_pcm_g’”ic_hw_»fše
);

286  
”r
;

287 
	}
}

292 
	$¢d_pcm_exlug_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

295 
exlug_´iv_t
 *
ext
 = 
pcm
->
´iv©e_d©a
;

296 
¢d_pcm_t
 *
¦ave
 = 
ext
->
¶ug
.
g’
.slave;

297 
”r
 = 
	`¢d_pcm_hw_·¿ms_¦ave
(
pcm
, 
·¿ms
,

298 
¢d_pcm_exlug_hw_»fše_cchªge
,

299 
¢d_pcm_exlug_hw_»fše_¥»·»
,

300 
¢d_pcm_exlug_hw_»fše_schªge
,

301 
¢d_pcm_g’”ic_hw_·¿ms
);

302 ià(
”r
 < 0)

303  
”r
;

304 
ext
->
d©a
->
¦ave_fÜm©
 = 
¦ave
->
fÜm©
;

305 
ext
->
d©a
->
¦ave_subfÜm©
 = 
¦ave
->
subfÜm©
;

306 
ext
->
d©a
->
¦ave_chªÃls
 = 
¦ave
->
chªÃls
;

307 
ext
->
d©a
->
¿‹
 = 
¦ave
->rate;

308 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(
·¿ms
, &
ext
->
d©a
->
fÜm©
);

309 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_subfÜm©
)(
·¿ms
, &
ext
->
d©a
->
subfÜm©
);

310 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_chªÃls
)(
·¿ms
, &
ext
->
d©a
->
chªÃls
);

312 ià(
ext
->
d©a
->
ÿÎback
->
hw_·¿ms
) {

313 
”r
 = 
ext
->
d©a
->
ÿÎback
->
	`hw_·¿ms
Óxt->d©a, 
·¿ms
);

314 ià(
”r
 < 0)

315  
”r
;

318 
	}
}

323 
	$¢d_pcm_exlug_hw_ä“
(
¢d_pcm_t
 *
pcm
)

325 
exlug_´iv_t
 *
ext
 = 
pcm
->
´iv©e_d©a
;

327 
	`¢d_pcm_hw_ä“
(
ext
->
¶ug
.
g’
.
¦ave
);

328 ià(
ext
->
d©a
->
ÿÎback
->
hw_ä“
)

329  
ext
->
d©a
->
ÿÎback
->
	`hw_ä“
(ext->data);

331 
	}
}

336 
¢d_pcm_uäames_t


337 
	$¢d_pcm_exlug_wr™e_¬—s
(
¢d_pcm_t
 *
pcm
,

338 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

339 
¢d_pcm_uäames_t
 
off£t
,

340 
¢d_pcm_uäames_t
 
size
,

341 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

342 
¢d_pcm_uäames_t
 
¦ave_off£t
,

343 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

345 
exlug_´iv_t
 *
ext
 = 
pcm
->
´iv©e_d©a
;

347 ià(
size
 > *
¦ave_siz•
)

348 
size
 = *
¦ave_siz•
;

349 
size
 = 
ext
->
d©a
->
ÿÎback
->
	`Œªsãr
Óxt->d©a, 
¦ave_¬—s
, 
¦ave_off£t
,

350 
¬—s
, 
off£t
, 
size
);

351 *
¦ave_siz•
 = 
size
;

352  
size
;

353 
	}
}

358 
¢d_pcm_uäames_t


359 
	$¢d_pcm_exlug_»ad_¬—s
(
¢d_pcm_t
 *
pcm
,

360 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

361 
¢d_pcm_uäames_t
 
off£t
,

362 
¢d_pcm_uäames_t
 
size
,

363 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

364 
¢d_pcm_uäames_t
 
¦ave_off£t
,

365 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

367 
exlug_´iv_t
 *
ext
 = 
pcm
->
´iv©e_d©a
;

369 ià(
size
 > *
¦ave_siz•
)

370 
size
 = *
¦ave_siz•
;

371 
size
 = 
ext
->
d©a
->
ÿÎback
->
	`Œªsãr
Óxt->d©a, 
¬—s
, 
off£t
,

372 
¦ave_¬—s
, 
¦ave_off£t
, 
size
);

373 *
¦ave_siz•
 = 
size
;

374  
size
;

375 
	}
}

380 
	$¢d_pcm_exlug_š™
(
¢d_pcm_t
 *
pcm
)

382 
exlug_´iv_t
 *
ext
 = 
pcm
->
´iv©e_d©a
;

383  
ext
->
d©a
->
ÿÎback
->
	`š™
(ext->data);

384 
	}
}

389 
	$¢d_pcm_exlug_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

391 
exlug_´iv_t
 *
ext
 = 
pcm
->
´iv©e_d©a
;

393 ià(
ext
->
d©a
->
ÿÎback
->
dump
)

394 
ext
->
d©a
->
ÿÎback
->
	`dump
Óxt->d©a, 
out
);

396 ià(
ext
->
d©a
->
Çme
)

397 
	`¢d_ouut_´štf
(
out
, "%s\n", 
ext
->
d©a
->
Çme
);

399 
	`¢d_ouut_´štf
(
out
, "External PCM Plugin\n");

400 ià(
pcm
->
£tup
) {

401 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

402 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

405 
	`¢d_ouut_´štf
(
out
, "Slave: ");

406 
	`¢d_pcm_dump
(
ext
->
¶ug
.
g’
.
¦ave
, 
out
);

407 
	}
}

409 
	$ş—r_ext_·¿ms
(
exlug_´iv_t
 *
ext
)

411 
i
;

412 
i
 = 0; i < 
SND_PCM_EXTPLUG_HW_PARAMS
; i++) {

413 
	`¢d_ext_·rm_ş—r
(&
ext
->
·¿ms
[
i
]);

414 
	`¢d_ext_·rm_ş—r
(&
ext
->
¥¬ams
[
i
]);

416 
	}
}

418 
	$¢d_pcm_exlug_şo£
(
¢d_pcm_t
 *
pcm
)

420 
exlug_´iv_t
 *
ext
 = 
pcm
->
´iv©e_d©a
;

422 
	`¢d_pcm_şo£
(
ext
->
¶ug
.
g’
.
¦ave
);

423 
	`ş—r_ext_·¿ms
(
ext
);

424 ià(
ext
->
d©a
->
ÿÎback
->
şo£
)

425 
ext
->
d©a
->
ÿÎback
->
	`şo£
(ext->data);

426 
	`ä“
(
ext
);

428 
	}
}

430 
¢d_pcm_chm­_qu”y_t
 **
	$¢d_pcm_exlug_qu”y_chm­s
(
¢d_pcm_t
 *
pcm
)

432 
exlug_´iv_t
 *
ext
 = 
pcm
->
´iv©e_d©a
;

434 ià(
ext
->
d©a
->
v”siÚ
 >= 0x010002 &&

435 
ext
->
d©a
->
ÿÎback
->
qu”y_chm­s
)

436  
ext
->
d©a
->
ÿÎback
->
	`qu”y_chm­s
(ext->data);

437  
	`¢d_pcm_g’”ic_qu”y_chm­s
(
pcm
);

438 
	}
}

440 
¢d_pcm_chm­_t
 *
	$¢d_pcm_exlug_g‘_chm­
(
¢d_pcm_t
 *
pcm
)

442 
exlug_´iv_t
 *
ext
 = 
pcm
->
´iv©e_d©a
;

444 ià(
ext
->
d©a
->
v”siÚ
 >= 0x010002 &&

445 
ext
->
d©a
->
ÿÎback
->
g‘_chm­
)

446  
ext
->
d©a
->
ÿÎback
->
	`g‘_chm­
(ext->data);

447  
	`¢d_pcm_g’”ic_g‘_chm­
(
pcm
);

448 
	}
}

450 
	$¢d_pcm_exlug_£t_chm­
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chm­_t
 *
m­
)

452 
exlug_´iv_t
 *
ext
 = 
pcm
->
´iv©e_d©a
;

454 ià(
ext
->
d©a
->
v”siÚ
 >= 0x010002 &&

455 
ext
->
d©a
->
ÿÎback
->
£t_chm­
)

456  
ext
->
d©a
->
ÿÎback
->
	`£t_chm­
Óxt->d©a, 
m­
);

457  
	`¢d_pcm_g’”ic_£t_chm­
(
pcm
, 
m­
);

458 
	}
}

460 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_exlug_İs
 = {

461 .
şo£
 = 
¢d_pcm_exlug_şo£
,

462 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

463 .
	ghw_»fše
 = 
¢d_pcm_exlug_hw_»fše
,

464 .
	ghw_·¿ms
 = 
¢d_pcm_exlug_hw_·¿ms
,

465 .
	ghw_ä“
 = 
¢d_pcm_exlug_hw_ä“
,

466 .
	gsw_·¿ms
 = 
¢d_pcm_g’”ic_sw_·¿ms
,

467 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

468 .
	gdump
 = 
¢d_pcm_exlug_dump
,

469 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

470 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

471 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

472 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

473 .
	gqu”y_chm­s
 = 
¢d_pcm_exlug_qu”y_chm­s
,

474 .
	gg‘_chm­
 = 
¢d_pcm_exlug_g‘_chm­
,

475 .
	g£t_chm­
 = 
¢d_pcm_exlug_£t_chm­
,

676 
	$¢d_pcm_exlug_ü—‹
(
¢d_pcm_exlug_t
 *
exlug
, cÚ¡ *
Çme
,

677 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
¦ave_cÚf
,

678 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

680 
exlug_´iv_t
 *
ext
;

681 
”r
;

682 
¢d_pcm_t
 *
¥cm
, *
pcm
;

683 
¢d_cÚfig_t
 *
scÚf
;

685 
	`as£¹
(
roÙ
);

686 
	`as£¹
(
exlug
 &&ƒxlug->
ÿÎback
);

687 
	`as£¹
(
exlug
->
ÿÎback
->
Œªsãr
);

688 
	`as£¹
(
¦ave_cÚf
);

691 ià(
exlug
->
v”siÚ
 < 0x010000 ||

692 
exlug
->
v”siÚ
 > 
SND_PCM_EXTPLUG_VERSION
) {

693 
	`SNDERR
("extplug: Plugin version mismatch: 0x%x",

694 
exlug
->
v”siÚ
);

695  -
ENXIO
;

698 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave_cÚf
, &
scÚf
, 0);

699 ià(
”r
 < 0)

700  
”r
;

701 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
NULL
);

702 
	`¢d_cÚfig_d–‘e
(
scÚf
);

703 ià(
”r
 < 0)

704  
”r
;

706 
ext
 = 
	`ÿÎoc
(1, (*ext));

707 ià(! 
ext
)

708  -
ENOMEM
;

710 
ext
->
d©a
 = 
exlug
;

711 
exlug
->
¡»am
 = stream;

713 
	`¢d_pcm_¶ugš_š™
(&
ext
->
¶ug
);

714 
ext
->
¶ug
.
»ad
 = 
¢d_pcm_exlug_»ad_¬—s
;

715 
ext
->
¶ug
.
wr™e
 = 
¢d_pcm_exlug_wr™e_¬—s
;

716 
ext
->
¶ug
.
undo_»ad
 = 
¢d_pcm_¶ugš_undo_»ad_g’”ic
;

717 
ext
->
¶ug
.
undo_wr™e
 = 
¢d_pcm_¶ugš_undo_wr™e_g’”ic
;

718 
ext
->
¶ug
.
g’
.
¦ave
 = 
¥cm
;

719 
ext
->
¶ug
.
g’
.
şo£_¦ave
 = 1;

720 ià(
exlug
->
v”siÚ
 >ğ0x010001 &&ƒxlug->
ÿÎback
->
š™
)

721 
ext
->
¶ug
.
š™
 = 
¢d_pcm_exlug_š™
;

723 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_EXTPLUG
, 
Çme
, 
¡»am
, 
mode
);

724 ià(
”r
 < 0) {

725 
	`ä“
(
ext
);

726  
”r
;

729 
exlug
->
pcm
 =…cm;

730 
pcm
->
İs
 = &
¢d_pcm_exlug_İs
;

731 
pcm
->
ç¡_İs
 = &
¢d_pcm_¶ugš_ç¡_İs
;

732 
pcm
->
´iv©e_d©a
 = 
ext
;

733 
pcm
->
pŞl_fd
 = 
¥cm
->poll_fd;

734 
pcm
->
pŞl_ev’ts
 = 
¥cm
->poll_events;

735 
pcm
->
t¡amp_ty³
 = 
¥cm
->tstamp_type;

736 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
ext
->
¶ug
.
hw_±r
, -1, 0);

737 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
ext
->
¶ug
.
­¶_±r
, -1, 0);

740 
	}
}

750 
	$¢d_pcm_exlug_d–‘e
(
¢d_pcm_exlug_t
 *
exlug
)

752  
	`¢d_pcm_şo£
(
exlug
->
pcm
);

753 
	}
}

762 
	$¢d_pcm_exlug_·¿ms_»£t
(
¢d_pcm_exlug_t
 *
exlug
)

764 
exlug_´iv_t
 *
ext
 = 
exlug
->
pcm
->
´iv©e_d©a
;

765 
	`ş—r_ext_·¿ms
(
ext
);

766 
	}
}

780 
	$¢d_pcm_exlug_£t_¦ave_·¿m_li¡
(
¢d_pcm_exlug_t
 *
exlug
, 
ty³
, 
num_li¡
, cÚ¡ *
li¡
)

782 
exlug_´iv_t
 *
ext
 = 
exlug
->
pcm
->
´iv©e_d©a
;

783 ià(
ty³
 < 0 ||y³ >ğ
SND_PCM_EXTPLUG_HW_PARAMS
) {

784 
	`SNDERR
("EXTPLUG: inv®id…¬am‘”y³ %d", 
ty³
);

785  -
EINVAL
;

787  
	`¢d_ext_·rm_£t_li¡
(&
ext
->
¥¬ams
[
ty³
], 
num_li¡
, 
li¡
);

788 
	}
}

802 
	$¢d_pcm_exlug_£t_¦ave_·¿m_mšmax
(
¢d_pcm_exlug_t
 *
exlug
, 
ty³
, 
mš
, 
max
)

804 
exlug_´iv_t
 *
ext
 = 
exlug
->
pcm
->
´iv©e_d©a
;

805 ià(
ty³
 < 0 ||y³ >ğ
SND_PCM_EXTPLUG_HW_PARAMS
) {

806 
	`SNDERR
("EXTPLUG: inv®id…¬am‘”y³ %d", 
ty³
);

807  -
EINVAL
;

809 ià(
	`is_mask_ty³
(
ty³
)) {

810 
	`SNDERR
("EXTPLUG: inv®id…¬am‘”y³ %d", 
ty³
);

811  -
EINVAL
;

813  
	`¢d_ext_·rm_£t_mšmax
(&
ext
->
¥¬ams
[
ty³
], 
mš
, 
max
);

814 
	}
}

828 
	$¢d_pcm_exlug_£t_·¿m_li¡
(
¢d_pcm_exlug_t
 *
exlug
, 
ty³
, 
num_li¡
, cÚ¡ *
li¡
)

830 
exlug_´iv_t
 *
ext
 = 
exlug
->
pcm
->
´iv©e_d©a
;

831 ià(
ty³
 < 0 ||y³ >ğ
SND_PCM_EXTPLUG_HW_PARAMS
) {

832 
	`SNDERR
("EXTPLUG: inv®id…¬am‘”y³ %d", 
ty³
);

833  -
EINVAL
;

835  
	`¢d_ext_·rm_£t_li¡
(&
ext
->
·¿ms
[
ty³
], 
num_li¡
, 
li¡
);

836 
	}
}

850 
	$¢d_pcm_exlug_£t_·¿m_mšmax
(
¢d_pcm_exlug_t
 *
exlug
, 
ty³
, 
mš
, 
max
)

852 
exlug_´iv_t
 *
ext
 = 
exlug
->
pcm
->
´iv©e_d©a
;

853 ià(
ty³
 < 0 ||y³ >ğ
SND_PCM_EXTPLUG_HW_PARAMS
) {

854 
	`SNDERR
("EXTPLUG: inv®id…¬am‘”y³ %d", 
ty³
);

855  -
EINVAL
;

857 ià(
	`is_mask_ty³
(
ty³
)) {

858 
	`SNDERR
("EXTPLUG: inv®id…¬am‘”y³ %d", 
ty³
);

859  -
EINVAL
;

861  
	`¢d_ext_·rm_£t_mšmax
(&
ext
->
·¿ms
[
ty³
], 
mš
, 
max
);

862 
	}
}

874 
	$¢d_pcm_exlug_£t_·¿m_lšk
(
¢d_pcm_exlug_t
 *
exlug
, 
ty³
,

875 
k“p_lšk
)

877 
exlug_´iv_t
 *
ext
 = 
exlug
->
pcm
->
´iv©e_d©a
;

879 ià(
ty³
 < 0 ||y³ >ğ
SND_PCM_EXTPLUG_HW_PARAMS
) {

880 
	`SNDERR
("EXTPLUG: inv®id…¬am‘”y³ %d", 
ty³
);

881  -
EINVAL
;

883 
ext
->
·¿ms
[
ty³
].
k“p_lšk
 = keep_link ? 1 : 0;

884 
ext
->
¥¬ams
[
ty³
].
k“p_lšk
 = keep_link ? 1 : 0;

886 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_file.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_¶ugš.h
"

31 
	~"bsw­.h
"

32 
	~<ùy³.h
>

33 
	~<¡ršg.h
>

35 #iâdeà
PIC


37 cÚ¡ *
	g_¢d_moduË_pcm_fe
 = "";

40 #iâdeà
DOC_HIDDEN


43 
	#LEADING_KEY
 '%'

	)

44 
	#RATE_KEY
 'r'

	)

45 
	#CHANNELS_KEY
 'c'

	)

46 
	#BWIDTH_KEY
 'b'

	)

47 
	#FORMAT_KEY
 'f'

	)

50 
	#VALUE_MAXLEN
 64

	)

52 
	e_¢d_pcm_fe_fÜm©
 {

53 
	mSND_PCM_FILE_FORMAT_RAW
,

54 
	mSND_PCM_FILE_FORMAT_WAV


55 } 
	t¢d_pcm_fe_fÜm©_t
;

58 
	swav_fmt
 {

59 
	mfmt
;

60 
	mchª
;

61 
	m¿‹
;

62 
	mbps
;

63 
	mbwidth
;

64 
	mb™s
;

68 
¢d_pcm_g’”ic_t
 
	mg’
;

69 *
	mâame
;

70 *
	mfš®_âame
;

71 
	mŒunc
;

72 
	m³rm
;

73 
	mfd
;

74 
FILE
 *
	mpe
;

75 *
	miâame
;

76 
	mifd
;

77 
	mfÜm©
;

78 
¢d_pcm_uäames_t
 
	m­¶_±r
;

79 
¢d_pcm_uäames_t
 
	mfe_±r_by‹s
;

80 
¢d_pcm_uäames_t
 
	mwbuf_size
;

81 
¢d_pcm_uäames_t
 
	mrbuf_size
;

82 
size_t
 
	mwbuf_size_by‹s
;

83 
size_t
 
	mwbuf_u£d_by‹s
;

84 *
	mwbuf
;

85 
size_t
 
	mrbuf_size_by‹s
;

86 
size_t
 
	mrbuf_u£d_by‹s
;

87 *
	mrbuf
;

88 
¢d_pcm_chªÃl_¬—_t
 *
	mwbuf_¬—s
;

89 
size_t
 
	mbufãr_by‹s
;

90 
wav_fmt
 
	mwav_h—d”
;

91 
size_t
 
	mf–’
;

92 
	mifmm­_ov”wr™‹n
;

93 } 
	t¢d_pcm_fe_t
;

95 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


96 
	#TO_LE32
(
x
è(x)

	)

97 
	#TO_LE16
(
x
è(x)

	)

99 
	#TO_LE32
(
x
è
	`bsw­_32
(x)

	)

100 
	#TO_LE16
(
x
è
	`bsw­_16
(x)

	)

103 
ssize_t
 
	$§ã_wr™e
(
fd
, cÚ¡ *
buf
, 
size_t
 
Ën
)

106 
ssize_t
 
r
 = 
	`wr™e
(
fd
, 
buf
, 
Ën
);

107 ià(
r
 < 0) {

108 ià(
”ºo
 =ğ
EINTR
)

110 ià(
”ºo
 =ğ
EPIPE
)

111  -
EIO
;

112  -
”ºo
;

114  
r
;

116 
	}
}

118 
	$¢d_pcm_fe_­³nd_v®ue
(**
¡ršg_p
, **
šdex_ch_p
,

119 *
Ën_p
, cÚ¡ *
v®ue
)

121 *
¡ršg
, *
šdex_ch
;

122 
šdex
, 
Ën
, 
v®ue_Ën
;

124 
Ën
 = *(
Ën_p
);

125 
¡ršg
 = *(
¡ršg_p
);

126 
šdex_ch
 = *(
šdex_ch_p
);

128 
v®ue_Ën
 = 
	`¡¾’
(
v®ue
);

130 
šdex
 = 
šdex_ch
 - 
¡ršg
;

131 
Ën
 +ğ
v®ue_Ën
;

132 
¡ršg
 = 
	`»®loc
(¡ršg, 
Ën
 + 1);

133 ià(!
¡ršg
)

134  -
ENOMEM
;

135 
šdex_ch
 = 
¡ršg
 + 
šdex
;

137 
	`¡rıy
(
šdex_ch
, 
v®ue
);

138 
šdex_ch
 +ğ
v®ue_Ën
;

140 *(
Ën_p
èğ
Ën
;

141 *(
¡ršg_p
èğ
¡ršg
;

142 *(
šdex_ch_p
èğ
šdex_ch
;

144 
	}
}

146 
	$¢d_pcm_fe_»¶aû_âame
(
¢d_pcm_fe_t
 *
fe
, **
Ãw_âame_p
)

148 
v®ue
[
VALUE_MAXLEN
];

149 *
âame
 = 
fe
->fname;

150 *
Ãw_âame
 = 
NULL
;

151 *
Şd_Ï¡_ch
, *
Şd_šdex_ch
, *
Ãw_šdex_ch
;

152 
Şd_Ën
, 
Ãw_Ën
, 
”r
;

154 
¢d_pcm_t
 *
pcm
 = 
fe
->
g’
.
¦ave
;

157 
Şd_Ën
 = 
Ãw_Ën
 = 
	`¡¾’
(
âame
);

158 
Şd_Ï¡_ch
 = 
âame
 + 
Şd_Ën
 - 1;

159 
Ãw_âame
 = 
	`m®loc
(
Ãw_Ën
 + 1);

160 ià(!
Ãw_âame
)

161  -
ENOMEM
;

163 
Şd_šdex_ch
 = 
âame
;

164 
Ãw_šdex_ch
 = 
Ãw_âame
;

166 
Şd_šdex_ch
 <ğ
Şd_Ï¡_ch
) {

167 ià(*(
Şd_šdex_ch
è=ğ
LEADING_KEY
 &&

168 
Şd_šdex_ch
 !ğ
Şd_Ï¡_ch
) {

171 *(++
Şd_šdex_ch
)) {

172 
RATE_KEY
:

173 
	`¢´štf
(
v®ue
, (value), "%d",

174 
pcm
->
¿‹
);

175 
”r
 = 
	`¢d_pcm_fe_­³nd_v®ue
(&
Ãw_âame
,

176 &
Ãw_šdex_ch
, &
Ãw_Ën
, 
v®ue
);

177 ià(
”r
 < 0)

178  
”r
;

181 
CHANNELS_KEY
:

182 
	`¢´štf
(
v®ue
, (value), "%d",

183 
pcm
->
chªÃls
);

184 
”r
 = 
	`¢d_pcm_fe_­³nd_v®ue
(&
Ãw_âame
,

185 &
Ãw_šdex_ch
, &
Ãw_Ën
, 
v®ue
);

186 ià(
”r
 < 0)

187  
”r
;

190 
BWIDTH_KEY
:

191 
	`¢´štf
(
v®ue
, (value), "%d",

192 
pcm
->
äame_b™s
/pcm->
chªÃls
);

193 
”r
 = 
	`¢d_pcm_fe_­³nd_v®ue
(&
Ãw_âame
,

194 &
Ãw_šdex_ch
, &
Ãw_Ën
, 
v®ue
);

195 ià(
”r
 < 0)

196  
”r
;

199 
FORMAT_KEY
:

200 
”r
 = 
	`¢d_pcm_fe_­³nd_v®ue
(&
Ãw_âame
,

201 &
Ãw_šdex_ch
, &
Ãw_Ën
,

202 
	`¢d_pcm_fÜm©_Çme
(
pcm
->
fÜm©
));

203 ià(
”r
 < 0)

204  
”r
;

209 *(
Ãw_šdex_ch
++èğ*(
Şd_šdex_ch
);

212 
Şd_šdex_ch
++;

215 *(
Ãw_šdex_ch
++èğ*(
Şd_šdex_ch
++);

219 *(
Ãw_šdex_ch
) = '\0';

220 *(
Ãw_âame_p
èğ
Ãw_âame
;

223 
	}
}

225 
	$¢d_pcm_fe_İ’_ouut_fe
(
¢d_pcm_fe_t
 *
fe
)

227 
”r
, 
fd
;

230 
”r
 = 
	`¢d_pcm_fe_»¶aû_âame
(
fe
, &(fe->
fš®_âame
));

231 ià(
”r
 < 0)

232  
”r
;

236 ià(
fe
->
fš®_âame
[0] == '|') {

238 
FILE
 *
pe
;

240 
pe
 = 
	`pİ’
(
fe
->
fš®_âame
 + 1, "w");

241 ià(!
pe
) {

242 
	`SYSERR
("running %s for writing failed",

243 
fe
->
fš®_âame
);

244  -
”ºo
;

246 
fd
 = 
	`f’o
(
pe
);

247 
fe
->
pe
 =…ipe;

249 
fe
->
pe
 = 
NULL
;

250 ià(
fe
->
Œunc
)

251 
fd
 = 
	`İ’
(
fe
->
fš®_âame
, 
O_WRONLY
|
O_CREAT
|
O_TRUNC
,

252 
fe
->
³rm
);

254 
fd
 = 
	`İ’
(
fe
->
fš®_âame
, 
O_WRONLY
|
O_CREAT
|
O_EXCL
,

255 
fe
->
³rm
);

256 ià(
fd
 < 0) {

257 *
tmpâame
 = 
NULL
;

258 
idx
, 
Ën
;

259 
Ën
 = 
	`¡¾’
(
fe
->
fš®_âame
) + 6;

260 
tmpâame
 = 
	`m®loc
(
Ën
);

261 ià(!
tmpâame
)

262  -
ENOMEM
;

263 
idx
 = 1; idx < 10000; idx++) {

264 
	`¢´štf
(
tmpâame
, 
Ën
,

265 "%s.%04d", 
fe
->
fš®_âame
,

266 
idx
);

267 
fd
 = 
	`İ’
(
tmpâame
,

268 
O_WRONLY
|
O_CREAT
|
O_EXCL
,

269 
fe
->
³rm
);

270 ià(
fd
 >= 0) {

271 
	`ä“
(
fe
->
fš®_âame
);

272 
fe
->
fš®_âame
 = 
tmpâame
;

276 ià(
fd
 < 0) {

277 
	`SYSERR
("open %s for writing failed",

278 
fe
->
fš®_âame
);

279 
	`ä“
(
tmpâame
);

280  -
”ºo
;

285 
fe
->
fd
 = fd;

287 
	}
}

290 
	$¢d_pcm_fe_¬—s_»ad_šfe
(
¢d_pcm_t
 *
pcm
,

291 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

292 
¢d_pcm_uäames_t
 
off£t
,

293 
¢d_pcm_uäames_t
 
äames
)

295 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

296 
¢d_pcm_chªÃl_¬—_t
 
¬—s_if
[
pcm
->
chªÃls
];

297 
ssize_t
 
by‹s
;

299 ià(
fe
->
ifd
 < 0)

300  -
EBADF
;

302 ià(
fe
->
rbuf
 =ğ
NULL
)

303  -
ENOMEM
;

305 ià(
fe
->
rbuf_size
 < 
äames
) {

306 
	`SYSERR
("requested more frameshan…cm buffer");

307  -
ENOMEM
;

310 
by‹s
 = 
	`¢d_pcm_äames_to_by‹s
(
pcm
, 
äames
);

311 ià(
by‹s
 < 0)

312  
by‹s
;

313 
by‹s
 = 
	`»ad
(
fe
->
ifd
, fe->
rbuf
, bytes);

314 ià(
by‹s
 < 0) {

315 
	`SYSERR
("»ad from fçed,ƒ¼Ü: %d", 
by‹s
);

316  
by‹s
;

319 
	`¢d_pcm_¬—s_äom_buf
(
pcm
, 
¬—s_if
, 
fe
->
rbuf
);

320 
	`¢d_pcm_¬—s_cİy
(
¬—s
, 
off£t
, 
¬—s_if
, 0, 
pcm
->
chªÃls
, 
	`¢d_pcm_by‹s_to_äames
Õcm, 
by‹s
),…cm->
fÜm©
);

322  
by‹s
;

323 
	}
}

325 
	$£tup_wav_h—d”
(
¢d_pcm_t
 *
pcm
, 
wav_fmt
 *
fmt
)

327 
fmt
->fmˆğ
	`TO_LE16
(0x01);

328 
fmt
->
chª
 = 
	`TO_LE16
(
pcm
->
chªÃls
);

329 
fmt
->
¿‹
 = 
	`TO_LE32
(
pcm
->rate);

330 
fmt
->
bwidth
 = 
pcm
->
äame_b™s
 / 8;

331 
fmt
->
bps
 = fmt->
bwidth
 * 
pcm
->
¿‹
;

332 
fmt
->
b™s
 = 
	`¢d_pcm_fÜm©_width
(
pcm
->
fÜm©
);

333 
fmt
->
bps
 = 
	`TO_LE32
(fmt->bps);

334 
fmt
->
bwidth
 = 
	`TO_LE16
(fmt->bwidth);

335 
fmt
->
b™s
 = 
	`TO_LE16
(fmt->bits);

336 
	}
}

338 
	$wr™e_wav_h—d”
(
¢d_pcm_t
 *
pcm
)

340 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

341 
ssize_t
 
»s
;

343 cÚ¡ 
h—d”
[] = {

350 cÚ¡ 
h—d”2
[] = {

355 
	`£tup_wav_h—d”
(
pcm
, &
fe
->
wav_h—d”
);

357 
»s
 = 
	`§ã_wr™e
(
fe
->
fd
, 
h—d”
, (header));

358 ià(
»s
 !ğ(
h—d”
))

359 
wr™e_”rÜ
;

361 
»s
 = 
	`§ã_wr™e
(
fe
->
fd
, &fe->
wav_h—d”
, (file->wav_header));

362 ià(
»s
 !ğ(
fe
->
wav_h—d”
))

363 
wr™e_”rÜ
;

365 
»s
 = 
	`§ã_wr™e
(
fe
->
fd
, 
h—d”2
, (header2));

366 ià(
»s
 !ğ(
h—d”2
))

367 
wr™e_”rÜ
;

371 
wr™e_”rÜ
:

378 ià(
»s
 < 0)

379 
	`SYSERR
("% wr™h—d” faed, fd©¨may bcÜru±", 
fe
->
âame
);

381 
	`SNDERR
("% wr™h—d” incom¶‘e, fd©¨may bcÜru±", 
fe
->
âame
);

383 
	`mem£t
(&
fe
->
wav_h—d”
, 0, (
wav_fmt
));

385  -
EIO
;

386 
	}
}

389 
	$fixup_wav_h—d”
(
¢d_pcm_t
 *
pcm
)

391 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

392 
Ën
, 
»t
;

395 ià(
	`l£ek
(
fe
->
fd
, 4, 
SEEK_SET
) == 4) {

396 
Ën
 = (
fe
->
f–’
 + 0x24) > 0x7fffffff ?

397 0x7ffffffà: ()(
fe
->
f–’
 + 0x24);

398 
Ën
 = 
	`TO_LE32
(len);

399 
»t
 = 
	`§ã_wr™e
(
fe
->
fd
, &
Ën
, 4);

400 ià(
»t
 < 0)

404 ià(
	`l£ek
(
fe
->
fd
, 0x28, 
SEEK_SET
) == 0x28) {

405 
Ën
 = 
fe
->
f–’
 > 0x7fffffff ?

406 0x7ffffffà: ()
fe
->
f–’
;

407 
Ën
 = 
	`TO_LE32
(len);

408 
»t
 = 
	`§ã_wr™e
(
fe
->
fd
, &
Ën
, 4);

409 ià(
»t
 < 0)

412 
	}
}

418 
	$¢d_pcm_fe_wr™e_by‹s
(
¢d_pcm_t
 *
pcm
, 
size_t
 
by‹s
)

420 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

421 
¢d_pcm_säames_t
 
”r
 = 0;

422 
	`as£¹
(
by‹s
 <ğ
fe
->
wbuf_u£d_by‹s
);

424 ià(
fe
->
fÜm©
 =ğ
SND_PCM_FILE_FORMAT_WAV
 &&

425 !
fe
->
wav_h—d”
.
fmt
) {

426 
”r
 = 
	`wr™e_wav_h—d”
(
pcm
);

427 ià(
”r
 < 0) {

428 
fe
->
wbuf_u£d_by‹s
 = 0;

429 
fe
->
fe_±r_by‹s
 = 0;

430  
”r
;

434 
by‹s
 > 0) {

435 
size_t
 
n
 = 
by‹s
;

436 
size_t
 
cÚt
 = 
fe
->
wbuf_size_by‹s
 - fe->
fe_±r_by‹s
;

437 ià(
n
 > 
cÚt
)

438 
n
 = 
cÚt
;

439 
”r
 = 
	`§ã_wr™e
(
fe
->
fd
, fe->
wbuf
 + fe->
fe_±r_by‹s
, 
n
);

440 ià(
”r
 < 0) {

441 
fe
->
wbuf_u£d_by‹s
 = 0;

442 
fe
->
fe_±r_by‹s
 = 0;

443 
	`SYSERR
("% wr™çed, fd©¨may bcÜru±", 
fe
->
âame
);

444  
”r
;

446 
by‹s
 -ğ
”r
;

447 
fe
->
wbuf_u£d_by‹s
 -ğ
”r
;

448 
fe
->
fe_±r_by‹s
 +ğ
”r
;

449 ià(
fe
->
fe_±r_by‹s
 =ğfe->
wbuf_size_by‹s
)

450 
fe
->
fe_±r_by‹s
 = 0;

451 
fe
->
f–’
 +ğ
”r
;

452 ià((
¢d_pcm_uäames_t
)
”r
 !ğ
n
)

456 
	}
}

458 
	$¢d_pcm_fe_add_äames
(
¢d_pcm_t
 *
pcm
,

459 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

460 
¢d_pcm_uäames_t
 
off£t
,

461 
¢d_pcm_uäames_t
 
äames
)

463 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

464 
äames
 > 0) {

465 
”r
 = 0;

466 
¢d_pcm_uäames_t
 
n
 = 
äames
;

467 
¢d_pcm_uäames_t
 
cÚt
 = 
fe
->
wbuf_size
 - fe->
­¶_±r
;

468 
¢d_pcm_uäames_t
 
ava
 = 
fe
->
wbuf_size
 - 
	`¢d_pcm_by‹s_to_äames
(
pcm
, fe->
wbuf_u£d_by‹s
);

469 ià(
n
 > 
cÚt
)

470 
n
 = 
cÚt
;

471 ià(
n
 > 
ava
)

472 
n
 = 
ava
;

473 
	`¢d_pcm_¬—s_cİy
(
fe
->
wbuf_¬—s
, fe->
­¶_±r
,

474 
¬—s
, 
off£t
,

475 
pcm
->
chªÃls
, 
n
,…cm->
fÜm©
);

476 
äames
 -ğ
n
;

477 
off£t
 +ğ
n
;

478 
fe
->
­¶_±r
 +ğ
n
;

479 ià(
fe
->
­¶_±r
 =ğfe->
wbuf_size
)

480 
fe
->
­¶_±r
 = 0;

481 
fe
->
wbuf_u£d_by‹s
 +ğ
	`¢d_pcm_äames_to_by‹s
(
pcm
, 
n
);

482 ià(
fe
->
wbuf_u£d_by‹s
 > fe->
bufãr_by‹s
) {

483 
”r
 = 
	`¢d_pcm_fe_wr™e_by‹s
(
pcm
, 
fe
->
wbuf_u£d_by‹s
 - fe->
bufãr_by‹s
);

484 ià(
”r
 < 0)

485  
”r
;

487 
	`as£¹
(
fe
->
wbuf_u£d_by‹s
 < fe->
wbuf_size_by‹s
);

490 
	}
}

492 
	$¢d_pcm_fe_şo£
(
¢d_pcm_t
 *
pcm
)

494 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

495 ià(
fe
->
âame
) {

496 ià(
fe
->
wav_h—d”
.
fmt
)

497 
	`fixup_wav_h—d”
(
pcm
);

498 
	`ä“
((*)
fe
->
âame
);

499 ià(
fe
->
pe
) {

500 
	`pşo£
(
fe
->
pe
);

501 } ià(
fe
->
fd
 >= 0) {

502 
	`şo£
(
fe
->
fd
);

505 ià(
fe
->
iâame
) {

506 
	`ä“
((*)
fe
->
iâame
);

507 
	`şo£
(
fe
->
ifd
);

509  
	`¢d_pcm_g’”ic_şo£
(
pcm
);

510 
	}
}

512 
	$¢d_pcm_fe_»£t
(
¢d_pcm_t
 *
pcm
)

514 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

515 
”r
 = 
	`¢d_pcm_»£t
(
fe
->
g’
.
¦ave
);

516 ià(
”r
 >= 0) {

518 
	`¢d_pcm_fe_wr™e_by‹s
(
pcm
, 
fe
->
wbuf_u£d_by‹s
);

519 
	`as£¹
(
fe
->
wbuf_u£d_by‹s
 == 0);

521  
”r
;

522 
	}
}

524 
	$¢d_pcm_fe_drİ
(
¢d_pcm_t
 *
pcm
)

526 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

527 
”r
 = 
	`¢d_pcm_drİ
(
fe
->
g’
.
¦ave
);

528 ià(
”r
 >= 0) {

530 
	`¢d_pcm_fe_wr™e_by‹s
(
pcm
, 
fe
->
wbuf_u£d_by‹s
);

531 
	`as£¹
(
fe
->
wbuf_u£d_by‹s
 == 0);

533  
”r
;

534 
	}
}

537 
	$¢d_pcm_fe_d¿š
(
¢d_pcm_t
 *
pcm
)

539 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

540 
”r
 = 
	`¢d_pcm_d¿š
(
fe
->
g’
.
¦ave
);

541 ià(
”r
 >= 0) {

542 
	`__¢d_pcm_lock
(
pcm
);

543 
	`¢d_pcm_fe_wr™e_by‹s
(
pcm
, 
fe
->
wbuf_u£d_by‹s
);

544 
	`as£¹
(
fe
->
wbuf_u£d_by‹s
 == 0);

545 
	`__¢d_pcm_uÆock
(
pcm
);

547  
”r
;

548 
	}
}

550 
¢d_pcm_säames_t
 
	$¢d_pcm_fe_»wšdabË
(
¢d_pcm_t
 *
pcm
)

552 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

553 
¢d_pcm_säames_t
 
»s
 = 
	`¢d_pcm_»wšdabË
(
fe
->
g’
.
¦ave
);

554 
¢d_pcm_säames_t
 
n
 = 
	`¢d_pcm_by‹s_to_äames
(
pcm
, 
fe
->
wbuf_u£d_by‹s
);

555 ià(
»s
 > 
n
)

556 
»s
 = 
n
;

557  
»s
;

558 
	}
}

560 
¢d_pcm_säames_t
 
	$¢d_pcm_fe_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

562 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

563 
¢d_pcm_säames_t
 
”r
;

564 
¢d_pcm_uäames_t
 
n
;

566 
n
 = 
	`¢d_pcm_äames_to_by‹s
(
pcm
, 
äames
);

567 ià(
n
 > 
fe
->
wbuf_u£d_by‹s
)

568 
äames
 = 
	`¢d_pcm_by‹s_to_äames
(
pcm
, 
fe
->
wbuf_u£d_by‹s
);

569 
”r
 = 
	`¢d_pcm_»wšd
(
fe
->
g’
.
¦ave
, 
äames
);

570 ià(
”r
 > 0) {

571 
fe
->
­¶_±r
 = (fe->­¶_±¸- 
”r
 + fe->
wbuf_size
) % file->wbuf_size;

572 
n
 = 
	`¢d_pcm_äames_to_by‹s
(
pcm
, 
”r
);

573 
fe
->
wbuf_u£d_by‹s
 -ğ
n
;

575  
”r
;

576 
	}
}

578 
¢d_pcm_säames_t
 
	$¢d_pcm_fe_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
)

580 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

581 
¢d_pcm_säames_t
 
»s
 = 
	`¢d_pcm_fÜw¬dabË
(
fe
->
g’
.
¦ave
);

582 
¢d_pcm_säames_t
 
n
 = 
	`¢d_pcm_by‹s_to_äames
(
pcm
, 
fe
->
wbuf_size_by‹s
 - fe->
wbuf_u£d_by‹s
);

583 ià(
»s
 > 
n
)

584 
»s
 = 
n
;

585  
»s
;

586 
	}
}

588 
¢d_pcm_säames_t
 
	$¢d_pcm_fe_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

590 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

591 
¢d_pcm_säames_t
 
”r
;

592 
¢d_pcm_uäames_t
 
n
;

594 
n
 = 
	`¢d_pcm_äames_to_by‹s
(
pcm
, 
äames
);

595 ià(
fe
->
wbuf_u£d_by‹s
 + 
n
 > fe->
wbuf_size_by‹s
)

596 
äames
 = 
	`¢d_pcm_by‹s_to_äames
(
pcm
, 
fe
->
wbuf_size_by‹s
 - fe->
wbuf_u£d_by‹s
);

597 
”r
 = 
	`INTERNAL
(
¢d_pcm_fÜw¬d
)(
fe
->
g’
.
¦ave
, 
äames
);

598 ià(
”r
 > 0) {

599 
fe
->
­¶_±r
 = (fe->­¶_±¸+ 
”r
è% fe->
wbuf_size
;

600 
n
 = 
	`¢d_pcm_äames_to_by‹s
(
pcm
, 
”r
);

601 
fe
->
wbuf_u£d_by‹s
 +ğ
n
;

603  
”r
;

604 
	}
}

607 
¢d_pcm_säames_t
 
	$¢d_pcm_fe_wr™ei
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

609 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

610 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

611 
¢d_pcm_säames_t
 
n
 = 
	`_¢d_pcm_wr™ei
(
fe
->
g’
.
¦ave
, 
bufãr
, 
size
);

612 ià(
n
 > 0) {

613 
	`¢d_pcm_¬—s_äom_buf
(
pcm
, 
¬—s
, (*è
bufãr
);

614 
	`__¢d_pcm_lock
(
pcm
);

615 ià(
	`¢d_pcm_fe_add_äames
(
pcm
, 
¬—s
, 0, 
n
) < 0) {

616 
	`__¢d_pcm_uÆock
(
pcm
);

617  -
EIO
;

619 
	`__¢d_pcm_uÆock
(
pcm
);

621  
n
;

622 
	}
}

625 
¢d_pcm_säames_t
 
	$¢d_pcm_fe_wr™’
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

627 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

628 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

629 
¢d_pcm_säames_t
 
n
 = 
	`_¢d_pcm_wr™’
(
fe
->
g’
.
¦ave
, 
bufs
, 
size
);

630 ià(
n
 > 0) {

631 
	`¢d_pcm_¬—s_äom_bufs
(
pcm
, 
¬—s
, 
bufs
);

632 
	`__¢d_pcm_lock
(
pcm
);

633 ià(
	`¢d_pcm_fe_add_äames
(
pcm
, 
¬—s
, 0, 
n
) < 0) {

634 
	`__¢d_pcm_uÆock
(
pcm
);

635  -
EIO
;

637 
	`__¢d_pcm_uÆock
(
pcm
);

639  
n
;

640 
	}
}

643 
¢d_pcm_säames_t
 
	$¢d_pcm_fe_»adi
(
¢d_pcm_t
 *
pcm
, *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

645 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

646 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

647 
¢d_pcm_säames_t
 
äames
;

649 
äames
 = 
	`_¢d_pcm_»adi
(
fe
->
g’
.
¦ave
, 
bufãr
, 
size
);

650 ià(
äames
 <= 0)

651  
äames
;

653 
	`¢d_pcm_¬—s_äom_buf
(
pcm
, 
¬—s
, 
bufãr
);

654 
	`¢d_pcm_fe_¬—s_»ad_šfe
(
pcm
, 
¬—s
, 0, 
äames
);

655 
	`__¢d_pcm_lock
(
pcm
);

656 ià(
	`¢d_pcm_fe_add_äames
(
pcm
, 
¬—s
, 0, 
äames
) < 0) {

657 
	`__¢d_pcm_uÆock
(
pcm
);

658  -
EIO
;

661 
	`__¢d_pcm_uÆock
(
pcm
);

663  
äames
;

664 
	}
}

667 
¢d_pcm_säames_t
 
	$¢d_pcm_fe_»adn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

669 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

670 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

671 
¢d_pcm_säames_t
 
äames
;

673 
äames
 = 
	`_¢d_pcm_»adn
(
fe
->
g’
.
¦ave
, 
bufs
, 
size
);

674 ià(
äames
 <= 0)

675  
äames
;

677 
	`¢d_pcm_¬—s_äom_bufs
(
pcm
, 
¬—s
, 
bufs
);

678 
	`¢d_pcm_fe_¬—s_»ad_šfe
(
pcm
, 
¬—s
, 0, 
äames
);

679 
	`__¢d_pcm_lock
(
pcm
);

680 ià(
	`¢d_pcm_fe_add_äames
(
pcm
, 
¬—s
, 0, 
äames
) < 0) {

681 
	`__¢d_pcm_uÆock
(
pcm
);

682  -
EIO
;

685 
	`__¢d_pcm_uÆock
(
pcm
);

687  
äames
;

688 
	}
}

690 
¢d_pcm_säames_t
 
	$¢d_pcm_fe_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

691 
¢d_pcm_uäames_t
 
off£t
,

692 
¢d_pcm_uäames_t
 
size
)

694 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

695 
¢d_pcm_uäames_t
 
ofs
;

696 
¢d_pcm_uäames_t
 
siz
 = 
size
;

697 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
;

698 
¢d_pcm_säames_t
 
»suÉ
;

700 
fe
->
ifmm­_ov”wr™‹n
 = 0;

702 
»suÉ
 = 
	`¢d_pcm_mm­_begš
(
fe
->
g’
.
¦ave
, &
¬—s
, &
ofs
, &
siz
);

703 ià(
»suÉ
 >= 0) {

704 
	`as£¹
(
ofs
 =ğ
off£t
 && 
siz
 =ğ
size
);

705 
»suÉ
 = 
	`¢d_pcm_mm­_comm™
(
fe
->
g’
.
¦ave
, 
ofs
, 
siz
);

706 ià(
»suÉ
 > 0) {

707 ià(
	`¢d_pcm_fe_add_äames
(
pcm
, 
¬—s
, 
ofs
, 
»suÉ
) < 0)

708  -
EIO
;

711  
»suÉ
;

712 
	}
}

714 
	$¢d_pcm_fe_mm­_begš
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 **
¬—s
,

715 
¢d_pcm_uäames_t
 *
off£t
, snd_pcm_uäames_ˆ*
äames
)

717 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

718 
»suÉ
;

720 
»suÉ
 = 
	`¢d_pcm_mm­_begš
(
fe
->
g’
.
¦ave
, 
¬—s
, 
off£t
, 
äames
);

721 ià(
»suÉ
 < 0)

722  
»suÉ
;

724 ià(
pcm
->
¡»am
 !ğ
SND_PCM_STREAM_CAPTURE
)

725  
»suÉ
;

728 ià(
fe
->
ifmm­_ov”wr™‹n
)

729  
»suÉ
;

730 
fe
->
ifmm­_ov”wr™‹n
 = 1;

732 
	`¢d_pcm_fe_¬—s_»ad_šfe
(
pcm
, *
¬—s
, *
off£t
, *
äames
);

734  
»suÉ
;

735 
	}
}

737 
	$¢d_pcm_fe_hw_ä“
(
¢d_pcm_t
 *
pcm
)

739 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

740 
	`ä“
(
fe
->
wbuf
);

741 
	`ä“
(
fe
->
wbuf_¬—s
);

742 
	`ä“
(
fe
->
fš®_âame
);

743 
	`ä“
(
fe
->
rbuf
);

744 
fe
->
wbuf
 = 
NULL
;

745 
fe
->
wbuf_¬—s
 = 
NULL
;

746 
fe
->
fš®_âame
 = 
NULL
;

747 
fe
->
rbuf
 = 
NULL
;

748  
	`¢d_pcm_hw_ä“
(
fe
->
g’
.
¦ave
);

749 
	}
}

751 
	$¢d_pcm_fe_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 * 
·¿ms
)

753 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

754 
chªÃl
;

755 
¢d_pcm_t
 *
¦ave
 = 
fe
->
g’
.slave;

756 
”r
 = 
	`_¢d_pcm_hw_·¿ms_š‹º®
(
¦ave
, 
·¿ms
);

757 ià(
”r
 < 0)

758  
”r
;

759 
fe
->
bufãr_by‹s
 = 
	`¢d_pcm_äames_to_by‹s
(
¦ave
, sÏve->
bufãr_size
);

760 
fe
->
wbuf_size
 = 
¦ave
->
bufãr_size
 * 2;

761 
fe
->
wbuf_size_by‹s
 = 
	`¢d_pcm_äames_to_by‹s
(
¦ave
, fe->
wbuf_size
);

762 
fe
->
wbuf_u£d_by‹s
 = 0;

763 
fe
->
ifmm­_ov”wr™‹n
 = 0;

764 
	`as£¹
(!
fe
->
wbuf
);

765 
fe
->
wbuf
 = 
	`m®loc
(fe->
wbuf_size_by‹s
);

766 ià(
fe
->
wbuf
 =ğ
NULL
) {

767 
	`¢d_pcm_fe_hw_ä“
(
pcm
);

768  -
ENOMEM
;

770 
fe
->
wbuf_¬—s
 = 
	`m®loc
((*fe->wbuf_¬—sè* 
¦ave
->
chªÃls
);

771 ià(
fe
->
wbuf_¬—s
 =ğ
NULL
) {

772 
	`¢d_pcm_fe_hw_ä“
(
pcm
);

773  -
ENOMEM
;

775 
	`as£¹
(!
fe
->
rbuf
);

776 
fe
->
rbuf_size
 = 
¦ave
->
bufãr_size
;

777 
fe
->
rbuf_size_by‹s
 = 
	`¢d_pcm_äames_to_by‹s
(
¦ave
, fe->
rbuf_size
);

778 
fe
->
rbuf_u£d_by‹s
 = 0;

779 
fe
->
rbuf
 = 
	`m®loc
(fe->
rbuf_size_by‹s
);

780 ià(
fe
->
rbuf
 =ğ
NULL
) {

781 
	`¢d_pcm_fe_hw_ä“
(
pcm
);

782  -
ENOMEM
;

784 
fe
->
­¶_±r
 = fe->
fe_±r_by‹s
 = 0;

785 
chªÃl
 = 0; chªÃÈ< 
¦ave
->
chªÃls
; ++channel) {

786 
¢d_pcm_chªÃl_¬—_t
 *
a
 = &
fe
->
wbuf_¬—s
[
chªÃl
];

787 
a
->
addr
 = 
fe
->
wbuf
;

788 
a
->
fœ¡
 = 
¦ave
->
§m¶e_b™s
 * 
chªÃl
;

789 
a
->
¡•
 = 
¦ave
->
äame_b™s
;

791 ià(
fe
->
fd
 < 0) {

792 
”r
 = 
	`¢d_pcm_fe_İ’_ouut_fe
(
fe
);

793 ià(
”r
 < 0) {

794 
	`SYSERR
("çed o³nšg ouuˆf%s", 
fe
->
âame
);

795  
”r
;

800 
	`¢d_pcm_uÆšk_hw_±r
(
pcm
, 
fe
->
g’
.
¦ave
);

801 
	`¢d_pcm_uÆšk_­¶_±r
(
pcm
, 
fe
->
g’
.
¦ave
);

803 
	`¢d_pcm_lšk_hw_±r
(
pcm
, 
fe
->
g’
.
¦ave
);

804 
	`¢d_pcm_lšk_­¶_±r
(
pcm
, 
fe
->
g’
.
¦ave
);

807 
	}
}

809 
	$¢d_pcm_fe_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

811 
¢d_pcm_fe_t
 *
fe
 = 
pcm
->
´iv©e_d©a
;

812 ià(
fe
->
âame
)

813 
	`¢d_ouut_´štf
(
out
, "FPCM (fe=%s)\n", 
fe
->
âame
);

815 
	`¢d_ouut_´štf
(
out
, "FPCM (fd=%d)\n", 
fe
->
fd
);

816 ià(
fe
->
fš®_âame
)

817 
	`¢d_ouut_´štf
(
out
, "Final file PCM (file=%s)\n",

818 
fe
->
fš®_âame
);

820 ià(
pcm
->
£tup
) {

821 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

822 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

824 
	`¢d_ouut_´štf
(
out
, "Slave: ");

825 
	`¢d_pcm_dump
(
fe
->
g’
.
¦ave
, 
out
);

826 
	}
}

828 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_fe_İs
 = {

829 .
şo£
 = 
¢d_pcm_fe_şo£
,

830 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

831 .
	ghw_»fše
 = 
¢d_pcm_g’”ic_hw_»fše
,

832 .
	ghw_·¿ms
 = 
¢d_pcm_fe_hw_·¿ms
,

833 .
	ghw_ä“
 = 
¢d_pcm_fe_hw_ä“
,

834 .
	gsw_·¿ms
 = 
¢d_pcm_g’”ic_sw_·¿ms
,

835 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

836 .
	gdump
 = 
¢d_pcm_fe_dump
,

837 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

838 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

839 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

840 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

841 .
	gqu”y_chm­s
 = 
¢d_pcm_g’”ic_qu”y_chm­s
,

842 .
	gg‘_chm­
 = 
¢d_pcm_g’”ic_g‘_chm­
,

843 .
	g£t_chm­
 = 
¢d_pcm_g’”ic_£t_chm­
,

846 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_fe_ç¡_İs
 = {

847 .
¡©us
 = 
¢d_pcm_g’”ic_¡©us
,

848 .
	g¡©e
 = 
¢d_pcm_g’”ic_¡©e
,

849 .
	ghwsync
 = 
¢d_pcm_g’”ic_hwsync
,

850 .
	gd–ay
 = 
¢d_pcm_g’”ic_d–ay
,

851 .
	g´•¬e
 = 
¢d_pcm_g’”ic_´•¬e
,

852 .
	g»£t
 = 
¢d_pcm_fe_»£t
,

853 .
	g¡¬t
 = 
¢d_pcm_g’”ic_¡¬t
,

854 .
	gdrİ
 = 
¢d_pcm_fe_drİ
,

855 .
	gd¿š
 = 
¢d_pcm_fe_d¿š
,

856 .
	g·u£
 = 
¢d_pcm_g’”ic_·u£
,

857 .
	g»wšdabË
 = 
¢d_pcm_fe_»wšdabË
,

858 .
	g»wšd
 = 
¢d_pcm_fe_»wšd
,

859 .
	gfÜw¬dabË
 = 
¢d_pcm_fe_fÜw¬dabË
,

860 .
	gfÜw¬d
 = 
¢d_pcm_fe_fÜw¬d
,

861 .
	g»sume
 = 
¢d_pcm_g’”ic_»sume
,

862 .
	glšk
 = 
¢d_pcm_g’”ic_lšk
,

863 .
	glšk_¦aves
 = 
¢d_pcm_g’”ic_lšk_¦aves
,

864 .
	guÆšk
 = 
¢d_pcm_g’”ic_uÆšk
,

865 .
	gwr™ei
 = 
¢d_pcm_fe_wr™ei
,

866 .
	gwr™’
 = 
¢d_pcm_fe_wr™’
,

867 .
	g»adi
 = 
¢d_pcm_fe_»adi
,

868 .
	g»adn
 = 
¢d_pcm_fe_»adn
,

869 .
	gava_upd©e
 = 
¢d_pcm_g’”ic_ava_upd©e
,

870 .
	gmm­_comm™
 = 
¢d_pcm_fe_mm­_comm™
,

871 .
	gpŞl_desütÜs_couÁ
 = 
¢d_pcm_g’”ic_pŞl_desütÜs_couÁ
,

872 .
	gpŞl_desütÜs
 = 
¢d_pcm_g’”ic_pŞl_desütÜs
,

873 .
	gpŞl_»v’ts
 = 
¢d_pcm_g’”ic_pŞl_»v’ts
,

874 .
	ghtime¡amp
 = 
¢d_pcm_g’”ic_htime¡amp
,

875 .
	gmm­_begš
 = 
¢d_pcm_fe_mm­_begš
,

898 
	$¢d_pcm_fe_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

899 cÚ¡ *
âame
, 
fd
, cÚ¡ *
iâame
, 
ifd
,

900 
Œunc
,

901 cÚ¡ *
fmt
, 
³rm
, 
¢d_pcm_t
 *
¦ave
, 
şo£_¦ave
,

902 
¢d_pcm_¡»am_t
 
¡»am
)

904 
¢d_pcm_t
 *
pcm
;

905 
¢d_pcm_fe_t
 *
fe
;

906 
¢d_pcm_fe_fÜm©_t
 
fÜm©
;

907 
time¥ec
imespec;

908 
”r
;

910 
	`as£¹
(
pcmp
);

911 ià(
fmt
 =ğ
NULL
 ||

912 
	`¡rcmp
(
fmt
, "raw") == 0)

913 
fÜm©
 = 
SND_PCM_FILE_FORMAT_RAW
;

914 ià(!
	`¡rcmp
(
fmt
, "wav"))

915 
fÜm©
 = 
SND_PCM_FILE_FORMAT_WAV
;

917 
	`SNDERR
("ffÜm© % i unknown", 
fmt
);

918  -
EINVAL
;

920 
fe
 = 
	`ÿÎoc
(1, (
¢d_pcm_fe_t
));

921 ià(!
fe
) {

922  -
ENOMEM
;

927 ià(
âame
)

928 
fe
->
âame
 = 
	`¡rdup
(fname);

929 
fe
->
Œunc
 =runc;

930 
fe
->
³rm
 =…erm;

932 ià(
iâame
 && (
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
)) {

933 
ifd
 = 
	`İ’
(
iâame
, 
O_RDONLY
);

934 ià(
ifd
 < 0) {

935 
	`SYSERR
("İ’ % fÜ„—dšg faed", 
iâame
);

936 
	`ä“
(
fe
->
âame
);

937 
	`ä“
(
fe
);

938  -
”ºo
;

940 
fe
->
iâame
 = 
	`¡rdup
(ifname);

942 
fe
->
fd
 = fd;

943 
fe
->
ifd
 = ifd;

944 
fe
->
fÜm©
 = format;

945 
fe
->
g’
.
¦ave
 = slave;

946 
fe
->
g’
.
şo£_¦ave
 = close_slave;

948 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_FILE
, 
Çme
, 
¦ave
->
¡»am
, sÏve->
mode
);

949 ià(
”r
 < 0) {

950 
	`ä“
(
fe
->
âame
);

951 
	`ä“
(
fe
->
iâame
);

952 
	`ä“
(
fe
);

953  
”r
;

955 
pcm
->
İs
 = &
¢d_pcm_fe_İs
;

956 
pcm
->
ç¡_İs
 = &
¢d_pcm_fe_ç¡_İs
;

957 
pcm
->
´iv©e_d©a
 = 
fe
;

958 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

959 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

960 
pcm
->
mm­_shadow
 = 1;

961 
pcm
->
t¡amp_ty³
 = 
SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY
;

962 #ià
	`defšed
(
HAVE_CLOCK_GETTIME
è&& defšed(
CLOCK_MONOTONIC
)

963 ià(
	`şock_g‘time
(
CLOCK_MONOTONIC
, &
time¥ec
) == 0)

964 
pcm
->
t¡amp_ty³
 = 
SND_PCM_TSTAMP_TYPE_MONOTONIC
;

966 
pcm
->
¡»am
 = stream;

967 
	`¢d_pcm_lšk_hw_±r
(
pcm
, 
¦ave
);

968 
	`¢d_pcm_lšk_­¶_±r
(
pcm
, 
¦ave
);

969 *
pcmp
 = 
pcm
;

971 
	}
}

1034 
	$_¢d_pcm_fe_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1035 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

1036 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

1038 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1039 
”r
;

1040 
¢d_pcm_t
 *
¥cm
;

1041 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

1042 cÚ¡ *
âame
 = 
NULL
, *
iâame
 = NULL;

1043 cÚ¡ *
fÜm©
 = 
NULL
;

1044 
fd
 = -1, 
ifd
 = -1, 
Œunc
 = 1;

1045 
³rm
 = 0600;

1046 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1047 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1048 cÚ¡ *
id
;

1049 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1051 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

1053 ià(
	`¡rcmp
(
id
, "slave") == 0) {

1054 
¦ave
 = 
n
;

1057 ià(
	`¡rcmp
(
id
, "format") == 0) {

1058 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
fÜm©
);

1059 ià(
”r
 < 0) {

1060 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1061  -
EINVAL
;

1065 ià(
	`¡rcmp
(
id
, "file") == 0) {

1066 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
âame
);

1067 ià(
”r
 < 0) {

1068 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
fd
);

1069 ià(
”r
 < 0) {

1070 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1071  -
EINVAL
;

1076 ià(
	`¡rcmp
(
id
, "infile") == 0) {

1077 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
iâame
);

1078 ià(
”r
 < 0) {

1079 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
ifd
);

1080 ià(
”r
 < 0) {

1081 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1082  -
EINVAL
;

1087 ià(
	`¡rcmp
(
id
, "perm") == 0) {

1088 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
³rm
);

1089 ià(
”r
 < 0) {

1090 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1091  
”r
;

1093 ià((
³rm
 & ~0777) != 0) {

1094 
	`SNDERR
("The field…erm must be‡ valid file…ermission");

1095  -
EINVAL
;

1099 ià(
	`¡rcmp
(
id
, "truncate") == 0) {

1100 
”r
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

1101 ià(
”r
 < 0)

1102  -
EINVAL
;

1103 
Œunc
 = 
”r
;

1106 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

1107  -
EINVAL
;

1109 ià(!
fÜm©
) {

1110 
¢d_cÚfig_t
 *
n
;

1112 ià(
	`¢d_cÚfig_£¬ch
(
roÙ
, "deçuÉs.pcm.fe_fÜm©", &
n
) >= 0) {

1113 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
fÜm©
);

1114 ià(
”r
 < 0) {

1115 
	`SNDERR
("Invalid file format");

1116  -
EINVAL
;

1120 ià(!
¦ave
) {

1121 
	`SNDERR
("slave is‚ot defined");

1122  -
EINVAL
;

1124 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 0);

1125 ià(
”r
 < 0)

1126  
”r
;

1127 ià((!
âame
 || 
	`¡¾’
(âameè=ğ0è&& 
fd
 < 0) {

1128 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1129 
	`SNDERR
("file is‚ot defined");

1130  -
EINVAL
;

1132 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

1133 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1134 ià(
”r
 < 0)

1135  
”r
;

1136 
”r
 = 
	`¢d_pcm_fe_İ’
(
pcmp
, 
Çme
, 
âame
, 
fd
, 
iâame
, 
ifd
,

1137 
Œunc
, 
fÜm©
, 
³rm
, 
¥cm
, 1, 
¡»am
);

1138 ià(
”r
 < 0)

1139 
	`¢d_pcm_şo£
(
¥cm
);

1140  
”r
;

1141 
	}
}

1142 #iâdeà
DOC_HIDDEN


1143 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_fe_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_generic.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_g’”ic.h
"

31 
	~<sys/ioùl.h
>

32 
	~<lim™s.h
>

34 #iâdeà
DOC_HIDDEN


36 
	$¢d_pcm_g’”ic_şo£
(
¢d_pcm_t
 *
pcm
)

38 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

39 
”r
 = 0;

40 ià(
g’”ic
->
şo£_¦ave
)

41 
”r
 = 
	`¢d_pcm_şo£
(
g’”ic
->
¦ave
);

42 
	`ä“
(
g’”ic
);

43  
”r
;

44 
	}
}

46 
	$¢d_pcm_g’”ic_nÚblock
(
¢d_pcm_t
 *
pcm
, 
nÚblock
)

48 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

49  
	`¢d_pcm_nÚblock
(
g’”ic
->
¦ave
, 
nÚblock
);

50 
	}
}

52 
	$¢d_pcm_g’”ic_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
)

54 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

55  
	`¢d_pcm_async
(
g’”ic
->
¦ave
, 
sig
, 
pid
);

56 
	}
}

58 
	$¢d_pcm_g’”ic_pŞl_desütÜs_couÁ
(
¢d_pcm_t
 *
pcm
)

60 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

61  
	`¢d_pcm_pŞl_desütÜs_couÁ
(
g’”ic
->
¦ave
);

62 
	}
}

64 
	$¢d_pcm_g’”ic_pŞl_desütÜs
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
¥aû
)

66 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

67  
	`¢d_pcm_pŞl_desütÜs
(
g’”ic
->
¦ave
, 
pfds
, 
¥aû
);

68 
	}
}

70 
	$¢d_pcm_g’”ic_pŞl_»v’ts
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

72 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

73  
	`¢d_pcm_pŞl_desütÜs_»v’ts
(
g’”ic
->
¦ave
, 
pfds
, 
nfds
, 
»v’ts
);

74 
	}
}

76 
	$¢d_pcm_g’”ic_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_šfo_t
 * 
šfo
)

78 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

79  
	`¢d_pcm_šfo
(
g’”ic
->
¦ave
, 
šfo
);

80 
	}
}

82 
	$¢d_pcm_g’”ic_hw_ä“
(
¢d_pcm_t
 *
pcm
)

84 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

85  
	`¢d_pcm_hw_ä“
(
g’”ic
->
¦ave
);

86 
	}
}

88 
	$¢d_pcm_g’”ic_sw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
)

90 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

91  
	`¢d_pcm_sw_·¿ms
(
g’”ic
->
¦ave
, 
·¿ms
);

92 
	}
}

94 
	$¢d_pcm_g’”ic_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

96 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

97  
	`¢d_pcm_hw_»fše
(
g’”ic
->
¦ave
, 
·¿ms
);

98 
	}
}

100 
	$¢d_pcm_g’”ic_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

102 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

103  
	`_¢d_pcm_hw_·¿ms_š‹º®
(
g’”ic
->
¦ave
, 
·¿ms
);

104 
	}
}

106 
	$¢d_pcm_g’”ic_´•¬e
(
¢d_pcm_t
 *
pcm
)

108 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

109  
	`¢d_pcm_´•¬e
(
g’”ic
->
¦ave
);

110 
	}
}

112 
	$¢d_pcm_g’”ic_chªÃl_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_šfo_t
 *
šfo
)

114 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

115 ià(
pcm
->
mm­_shadow
) {

120  
	`¢d_pcm_chªÃl_šfo
(
g’”ic
->
¦ave
, 
šfo
);

123  
	`¢d_pcm_chªÃl_šfo_shm
(
pcm
, 
šfo
, -1);

125 
	}
}

127 
	$¢d_pcm_g’”ic_¡©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©us_t
 * 
¡©us
)

129 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

130  
	`¢d_pcm_¡©us
(
g’”ic
->
¦ave
, 
¡©us
);

131 
	}
}

133 
¢d_pcm_¡©e_t
 
	$¢d_pcm_g’”ic_¡©e
(
¢d_pcm_t
 *
pcm
)

135 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

136  
	`¢d_pcm_¡©e
(
g’”ic
->
¦ave
);

137 
	}
}

139 
	$¢d_pcm_g’”ic_hwsync
(
¢d_pcm_t
 *
pcm
)

141 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

142  
	`¢d_pcm_hwsync
(
g’”ic
->
¦ave
);

143 
	}
}

145 
	$¢d_pcm_g’”ic_»£t
(
¢d_pcm_t
 *
pcm
)

147 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

148  
	`¢d_pcm_»£t
(
g’”ic
->
¦ave
);

149 
	}
}

151 
	$¢d_pcm_g’”ic_¡¬t
(
¢d_pcm_t
 *
pcm
)

153 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

154  
	`¢d_pcm_¡¬t
(
g’”ic
->
¦ave
);

155 
	}
}

157 
	$¢d_pcm_g’”ic_drİ
(
¢d_pcm_t
 *
pcm
)

159 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

160  
	`¢d_pcm_drİ
(
g’”ic
->
¦ave
);

161 
	}
}

163 
	$¢d_pcm_g’”ic_d¿š
(
¢d_pcm_t
 *
pcm
)

165 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

166  
	`¢d_pcm_d¿š
(
g’”ic
->
¦ave
);

167 
	}
}

169 
	$¢d_pcm_g’”ic_·u£
(
¢d_pcm_t
 *
pcm
, 
’abË
)

171 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

172  
	`¢d_pcm_·u£
(
g’”ic
->
¦ave
, 
’abË
);

173 
	}
}

175 
	$¢d_pcm_g’”ic_»sume
(
¢d_pcm_t
 *
pcm
)

177 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

178  
	`¢d_pcm_»sume
(
g’”ic
->
¦ave
);

179 
	}
}

181 
	$¢d_pcm_g’”ic_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
)

183 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

184  
	`¢d_pcm_d–ay
(
g’”ic
->
¦ave
, 
d–ayp
);

185 
	}
}

187 
¢d_pcm_säames_t
 
	$¢d_pcm_g’”ic_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
)

189 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

190  
	`¢d_pcm_fÜw¬dabË
(
g’”ic
->
¦ave
);

191 
	}
}

193 
¢d_pcm_säames_t
 
	$¢d_pcm_g’”ic_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

195 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

196  
	`INTERNAL
(
¢d_pcm_fÜw¬d
)(
g’”ic
->
¦ave
, 
äames
);

197 
	}
}

199 
¢d_pcm_säames_t
 
	$¢d_pcm_g’”ic_»wšdabË
(
¢d_pcm_t
 *
pcm
)

201 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

202  
	`¢d_pcm_»wšdabË
(
g’”ic
->
¦ave
);

203 
	}
}

205 
¢d_pcm_säames_t
 
	$¢d_pcm_g’”ic_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

207 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

208  
	`¢d_pcm_»wšd
(
g’”ic
->
¦ave
, 
äames
);

209 
	}
}

211 
	$¢d_pcm_g’”ic_lšk
(
¢d_pcm_t
 *
pcm1
, snd_pcm_ˆ*
pcm2
)

213 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm1
->
´iv©e_d©a
;

214 ià(
g’”ic
->
¦ave
->
ç¡_İs
->
lšk
)

215  
g’”ic
->
¦ave
->
ç¡_İs
->
	`lšk
(g’”ic->¦ave->
ç¡_İ_¬g
, 
pcm2
);

216  -
ENOSYS
;

217 
	}
}

219 
	$¢d_pcm_g’”ic_lšk_¦aves
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ*
ma¡”
)

221 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

222 ià(
g’”ic
->
¦ave
->
ç¡_İs
->
lšk_¦aves
)

223  
g’”ic
->
¦ave
->
ç¡_İs
->
	`lšk_¦aves
(g’”ic->¦ave->
ç¡_İ_¬g
, 
ma¡”
);

224  -
ENOSYS
;

225 
	}
}

227 
	$¢d_pcm_g’”ic_uÆšk
(
¢d_pcm_t
 *
pcm
)

229 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

230 ià(
g’”ic
->
¦ave
->
ç¡_İs
->
uÆšk
)

231  
g’”ic
->
¦ave
->
ç¡_İs
->
	`uÆšk
(g’”ic->¦ave->
ç¡_İ_¬g
);

232  -
ENOSYS
;

233 
	}
}

235 
¢d_pcm_säames_t
 
	$¢d_pcm_g’”ic_wr™ei
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

237 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

238  
	`_¢d_pcm_wr™ei
(
g’”ic
->
¦ave
, 
bufãr
, 
size
);

239 
	}
}

241 
¢d_pcm_säames_t
 
	$¢d_pcm_g’”ic_wr™’
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

243 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

244  
	`_¢d_pcm_wr™’
(
g’”ic
->
¦ave
, 
bufs
, 
size
);

245 
	}
}

247 
¢d_pcm_säames_t
 
	$¢d_pcm_g’”ic_»adi
(
¢d_pcm_t
 *
pcm
, *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

249 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

250  
	`_¢d_pcm_»adi
(
g’”ic
->
¦ave
, 
bufãr
, 
size
);

251 
	}
}

253 
¢d_pcm_säames_t
 
	$¢d_pcm_g’”ic_»adn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

255 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

256  
	`_¢d_pcm_»adn
(
g’”ic
->
¦ave
, 
bufs
, 
size
);

257 
	}
}

259 
¢d_pcm_säames_t
 
	$¢d_pcm_g’”ic_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

260 
¢d_pcm_uäames_t
 
off£t
,

261 
¢d_pcm_uäames_t
 
size
)

263 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

264  
	`¢d_pcm_mm­_comm™
(
g’”ic
->
¦ave
, 
off£t
, 
size
);

265 
	}
}

267 
¢d_pcm_säames_t
 
	$¢d_pcm_g’”ic_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

269 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

270  
	`¢d_pcm_ava_upd©e
(
g’”ic
->
¦ave
);

271 
	}
}

273 
	$¢d_pcm_g’”ic_htime¡amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 *
ava
,

274 
¢d_htime¡amp_t
 *
t¡amp
)

276 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

277  
	`¢d_pcm_htime¡amp
(
g’”ic
->
¦ave
, 
ava
, 
t¡amp
);

278 
	}
}

283 
	$¢d_pcm_g’”ic_»®_htime¡amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 *
ava
,

284 
¢d_htime¡amp_t
 *
t¡amp
)

286 
¢d_pcm_säames_t
 
ava1
;

287 
ok
 = 0;

290 
ava1
 = 
	`__¢d_pcm_ava_upd©e
(
pcm
);

291 ià(
ava1
 < 0)

292  
ava1
;

293 ià(
ok
 && (
¢d_pcm_uäames_t
)
ava1
 =ğ*
ava
)

295 *
ava
 = 
ava1
;

296 
	`g‘time¡amp
(
t¡amp
, 
pcm
->
t¡amp_ty³
);

297 
ok
 = 1;

300 
	}
}

302 
	$¢d_pcm_g’”ic_mm­
(
¢d_pcm_t
 *
pcm
)

304 ià(
pcm
->
mm­_shadow
) {

306 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

307 
pcm
->
mm­_chªÃls
 = 
g’”ic
->
¦ave
->mmap_channels;

308 
pcm
->
ruÂšg_¬—s
 = 
g’”ic
->
¦ave
->running_areas;

309 
pcm
->
¡İ³d_¬—s
 = 
g’”ic
->
¦ave
->stopped_areas;

312 
	}
}

314 
	$¢d_pcm_g’”ic_munm­
(
¢d_pcm_t
 *
pcm
)

316 ià(
pcm
->
mm­_shadow
) {

318 
pcm
->
mm­_chªÃls
 = 
NULL
;

319 
pcm
->
ruÂšg_¬—s
 = 
NULL
;

320 
pcm
->
¡İ³d_¬—s
 = 
NULL
;

323 
	}
}

325 
¢d_pcm_chm­_qu”y_t
 **
	$¢d_pcm_g’”ic_qu”y_chm­s
(
¢d_pcm_t
 *
pcm
)

327 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

328  
	`¢d_pcm_qu”y_chm­s
(
g’”ic
->
¦ave
);

329 
	}
}

331 
¢d_pcm_chm­_t
 *
	$¢d_pcm_g’”ic_g‘_chm­
(
¢d_pcm_t
 *
pcm
)

333 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

334  
	`¢d_pcm_g‘_chm­
(
g’”ic
->
¦ave
);

335 
	}
}

337 
	$¢d_pcm_g’”ic_£t_chm­
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chm­_t
 *
m­
)

339 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

340  
	`¢d_pcm_£t_chm­
(
g’”ic
->
¦ave
, 
m­
);

341 
	}
}

343 
	$¢d_pcm_g’”ic_may_wa™_fÜ_ava_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
ava
 
ATTRIBUTE_UNUSED
)

345 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

346  
	`¢d_pcm_may_wa™_fÜ_ava_mš
(
g’”ic
->
¦ave
, 
	`¢d_pcm_mm­_ava
(generic->slave));

347 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_generic.h

23 
¢d_pcm_t
 *
	m¦ave
;

24 
	mşo£_¦ave
;

25 } 
	t¢d_pcm_g’”ic_t
;

28 
	#¢d_pcm_g’”ic_şo£
 \

29 
¢d1_pcm_g’”ic_şo£


	)

30 
	#¢d_pcm_g’”ic_nÚblock
 \

31 
¢d1_pcm_g’”ic_nÚblock


	)

32 
	#¢d_pcm_g’”ic_async
 \

33 
¢d1_pcm_g’”ic_async


	)

34 
	#¢d_pcm_g’”ic_pŞl_desütÜs_couÁ
 \

35 
¢d1_pcm_g’”ic_pŞl_desütÜs_couÁ


	)

36 
	#¢d_pcm_g’”ic_pŞl_desütÜs
 \

37 
¢d1_pcm_g’”ic_pŞl_desütÜs


	)

38 
	#¢d_pcm_g’”ic_pŞl_»v’ts
 \

39 
¢d1_pcm_g’”ic_pŞl_»v’ts


	)

40 
	#¢d_pcm_g’”ic_šfo
 \

41 
¢d1_pcm_g’”ic_šfo


	)

42 
	#¢d_pcm_g’”ic_hw_ä“
 \

43 
¢d1_pcm_g’”ic_hw_ä“


	)

44 
	#¢d_pcm_g’”ic_sw_·¿ms
 \

45 
¢d1_pcm_g’”ic_sw_·¿ms


	)

46 
	#¢d_pcm_g’”ic_hw_»fše
 \

47 
¢d1_pcm_g’”ic_hw_»fše


	)

48 
	#¢d_pcm_g’”ic_hw_·¿ms
 \

49 
¢d1_pcm_g’”ic_hw_·¿ms


	)

50 
	#¢d_pcm_g’”ic_chªÃl_šfo
 \

51 
¢d1_pcm_g’”ic_chªÃl_šfo


	)

52 
	#¢d_pcm_g’”ic_chªÃl_šfo_no_bufãr
 \

53 
¢d1_pcm_g’”ic_chªÃl_šfo_no_bufãr


	)

54 
	#¢d_pcm_g’”ic_¡©us
 \

55 
¢d1_pcm_g’”ic_¡©us


	)

56 
	#¢d_pcm_g’”ic_¡©e
 \

57 
¢d1_pcm_g’”ic_¡©e


	)

58 
	#¢d_pcm_g’”ic_´•¬e
 \

59 
¢d1_pcm_g’”ic_´•¬e


	)

60 
	#¢d_pcm_g’”ic_hwsync
 \

61 
¢d1_pcm_g’”ic_hwsync


	)

62 
	#¢d_pcm_g’”ic_»£t
 \

63 
¢d1_pcm_g’”ic_»£t


	)

64 
	#¢d_pcm_g’”ic_¡¬t
 \

65 
¢d1_pcm_g’”ic_¡¬t


	)

66 
	#¢d_pcm_g’”ic_drİ
 \

67 
¢d1_pcm_g’”ic_drİ


	)

68 
	#¢d_pcm_g’”ic_d¿š
 \

69 
¢d1_pcm_g’”ic_d¿š


	)

70 
	#¢d_pcm_g’”ic_·u£
 \

71 
¢d1_pcm_g’”ic_·u£


	)

72 
	#¢d_pcm_g’”ic_»sume
 \

73 
¢d1_pcm_g’”ic_»sume


	)

74 
	#¢d_pcm_g’”ic_d–ay
 \

75 
¢d1_pcm_g’”ic_d–ay


	)

76 
	#¢d_pcm_g’”ic_fÜw¬dabË
 \

77 
¢d1_pcm_g’”ic_fÜw¬dabË


	)

78 
	#¢d_pcm_g’”ic_fÜw¬d
 \

79 
¢d1_pcm_g’”ic_fÜw¬d


	)

80 
	#¢d_pcm_g’”ic_»wšdabË
 \

81 
¢d1_pcm_g’”ic_»wšdabË


	)

82 
	#¢d_pcm_g’”ic_»wšd
 \

83 
¢d1_pcm_g’”ic_»wšd


	)

84 
	#¢d_pcm_g’”ic_lšk
 \

85 
¢d1_pcm_g’”ic_lšk


	)

86 
	#¢d_pcm_g’”ic_lšk_¦aves
 \

87 
¢d1_pcm_g’”ic_lšk_¦aves


	)

88 
	#¢d_pcm_g’”ic_uÆšk
 \

89 
¢d1_pcm_g’”ic_uÆšk


	)

90 
	#¢d_pcm_g’”ic_wr™ei
 \

91 
¢d1_pcm_g’”ic_wr™ei


	)

92 
	#¢d_pcm_g’”ic_wr™’
 \

93 
¢d1_pcm_g’”ic_wr™’


	)

94 
	#¢d_pcm_g’”ic_»adi
 \

95 
¢d1_pcm_g’”ic_»adi


	)

96 
	#¢d_pcm_g’”ic_»adn
 \

97 
¢d1_pcm_g’”ic_»adn


	)

98 
	#¢d_pcm_g’”ic_mm­_comm™
 \

99 
¢d1_pcm_g’”ic_mm­_comm™


	)

100 
	#¢d_pcm_g’”ic_ava_upd©e
 \

101 
¢d1_pcm_g’”ic_ava_upd©e


	)

102 
	#¢d_pcm_g’”ic_mm­
 \

103 
¢d1_pcm_g’”ic_mm­


	)

104 
	#¢d_pcm_g’”ic_munm­
 \

105 
¢d1_pcm_g’”ic_munm­


	)

106 
	#¢d_pcm_g’”ic_qu”y_chm­s
 \

107 
¢d1_pcm_g’”ic_qu”y_chm­s


	)

108 
	#¢d_pcm_g’”ic_g‘_chm­
 \

109 
¢d1_pcm_g’”ic_g‘_chm­


	)

110 
	#¢d_pcm_g’”ic_£t_chm­
 \

111 
¢d1_pcm_g’”ic_£t_chm­


	)

112 
	#¢d_pcm_g’”ic_may_wa™_fÜ_ava_mš
 \

113 
¢d1_pcm_g’”ic_may_wa™_fÜ_ava_mš


	)

115 
¢d_pcm_g’”ic_şo£
(
¢d_pcm_t
 *
pcm
);

116 
¢d_pcm_g’”ic_nÚblock
(
¢d_pcm_t
 *
pcm
, 
nÚblock
);

117 
¢d_pcm_g’”ic_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
);

118 
¢d_pcm_g’”ic_pŞl_desütÜs_couÁ
(
¢d_pcm_t
 *
pcm
);

119 
¢d_pcm_g’”ic_pŞl_desütÜs
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
¥aû
);

120 
¢d_pcm_g’”ic_pŞl_»v’ts
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
);

121 
¢d_pcm_g’”ic_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_šfo_t
 * 
šfo
);

122 
¢d_pcm_g’”ic_hw_ä“
(
¢d_pcm_t
 *
pcm
);

123 
¢d_pcm_g’”ic_sw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
);

124 
¢d_pcm_g’”ic_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

125 
¢d_pcm_g’”ic_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

126 
¢d_pcm_g’”ic_chªÃl_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_šfo_t
 * 
šfo
);

127 
¢d_pcm_g’”ic_chªÃl_šfo_no_bufãr
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_šfo_t
 * 
šfo
);

128 
¢d_pcm_g’”ic_¡©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©us_t
 * 
¡©us
);

129 
¢d_pcm_¡©e_t
 
¢d_pcm_g’”ic_¡©e
(
¢d_pcm_t
 *
pcm
);

130 
¢d_pcm_g’”ic_´•¬e
(
¢d_pcm_t
 *
pcm
);

131 
¢d_pcm_g’”ic_hwsync
(
¢d_pcm_t
 *
pcm
);

132 
¢d_pcm_g’”ic_»£t
(
¢d_pcm_t
 *
pcm
);

133 
¢d_pcm_g’”ic_¡¬t
(
¢d_pcm_t
 *
pcm
);

134 
¢d_pcm_g’”ic_drİ
(
¢d_pcm_t
 *
pcm
);

135 
¢d_pcm_g’”ic_d¿š
(
¢d_pcm_t
 *
pcm
);

136 
¢d_pcm_g’”ic_·u£
(
¢d_pcm_t
 *
pcm
, 
’abË
);

137 
¢d_pcm_g’”ic_»sume
(
¢d_pcm_t
 *
pcm
);

138 
¢d_pcm_g’”ic_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
);

139 
¢d_pcm_säames_t
 
¢d_pcm_g’”ic_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
);

140 
¢d_pcm_säames_t
 
¢d_pcm_g’”ic_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
);

141 
¢d_pcm_säames_t
 
¢d_pcm_g’”ic_»wšdabË
(
¢d_pcm_t
 *
pcm
);

142 
¢d_pcm_säames_t
 
¢d_pcm_g’”ic_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
);

143 
¢d_pcm_g’”ic_lšk
(
¢d_pcm_t
 *
pcm1
, snd_pcm_ˆ*
pcm2
);

144 
¢d_pcm_g’”ic_lšk_¦aves
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ*
ma¡”
);

145 
¢d_pcm_g’”ic_uÆšk
(
¢d_pcm_t
 *
pcm
);

146 
¢d_pcm_säames_t
 
¢d_pcm_g’”ic_wr™ei
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
bufãr
, 
¢d_pcm_uäames_t
 
size
);

147 
¢d_pcm_säames_t
 
¢d_pcm_g’”ic_wr™’
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
);

148 
¢d_pcm_säames_t
 
¢d_pcm_g’”ic_»adi
(
¢d_pcm_t
 *
pcm
, *
bufãr
, 
¢d_pcm_uäames_t
 
size
);

149 
¢d_pcm_säames_t
 
¢d_pcm_g’”ic_»adn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
);

150 
¢d_pcm_säames_t
 
¢d_pcm_g’”ic_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

151 
¢d_pcm_uäames_t
 
off£t
,

152 
¢d_pcm_uäames_t
 
size
);

153 
¢d_pcm_säames_t
 
¢d_pcm_g’”ic_ava_upd©e
(
¢d_pcm_t
 *
pcm
);

154 
¢d_pcm_g’”ic_htime¡amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 *
ava
,

155 
¢d_htime¡amp_t
 *
time¡amp
);

156 
¢d_pcm_g’”ic_»®_htime¡amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 *
ava
,

157 
¢d_htime¡amp_t
 *
t¡amp
);

158 
¢d_pcm_g’”ic_mm­
(
¢d_pcm_t
 *
pcm
);

159 
¢d_pcm_g’”ic_munm­
(
¢d_pcm_t
 *
pcm
);

160 
¢d_pcm_chm­_qu”y_t
 **
¢d_pcm_g’”ic_qu”y_chm­s
(
¢d_pcm_t
 *
pcm
);

161 
¢d_pcm_chm­_t
 *
¢d_pcm_g’”ic_g‘_chm­
(
¢d_pcm_t
 *
pcm
);

162 
¢d_pcm_g’”ic_£t_chm­
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chm­_t
 *
m­
);

163 
¢d_pcm_g’”ic_may_wa™_fÜ_ava_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
ava
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_hooks.c

30 
	~"pcm_loÿl.h
"

31 
	~"pcm_g’”ic.h
"

33 #iâdeà
PIC


35 cÚ¡ *
	g_¢d_moduË_pcm_hooks
 = "";

38 #iâdeà
DOC_HIDDEN


39 
	s_¢d_pcm_hook
 {

40 
¢d_pcm_t
 *
	mpcm
;

41 
¢d_pcm_hook_func_t
 
	mfunc
;

42 *
	m´iv©e_d©a
;

43 
li¡_h—d
 
	mli¡
;

46 
	s¢d_pcm_hook_dÎi¡
 {

47 *
	mdlobj
;

48 
li¡_h—d
 
	mli¡
;

52 
¢d_pcm_g’”ic_t
 
	mg’
;

53 
li¡_h—d
 
	mhooks
[
SND_PCM_HOOK_TYPE_LAST
 + 1];

54 
li¡_h—d
 
	mdÎi¡
;

55 } 
	t¢d_pcm_hooks_t
;

58 
	$hook_add_dlobj
(
¢d_pcm_t
 *
pcm
, *
dlobj
)

60 
¢d_pcm_hooks_t
 *
h
 = 
pcm
->
´iv©e_d©a
;

61 
¢d_pcm_hook_dÎi¡
 *
dl
;

63 
dl
 = 
	`m®loc
((*dl));

64 ià(!
dl
)

65  -
ENOMEM
;

67 
dl
->
dlobj
 = dlobj;

68 
	`li¡_add_
(&
dl
->
li¡
, &
h
->
dÎi¡
);

70 
	}
}

72 
	$hook_»move_dlobj
(
¢d_pcm_hook_dÎi¡
 *
dl
)

74 
	`li¡_d–
(&
dl
->
li¡
);

75 
	`¢d_dlşo£
(
dl
->
dlobj
);

76 
	`ä“
(
dl
);

77 
	}
}

79 
	$¢d_pcm_hooks_şo£
(
¢d_pcm_t
 *
pcm
)

81 
¢d_pcm_hooks_t
 *
h
 = 
pcm
->
´iv©e_d©a
;

82 
li¡_h—d
 *
pos
, *
Ãxt
;

83 
k
;

84 
»s
 = 0, 
”r
;

86 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Ãxt
, &
h
->
hooks
[
SND_PCM_HOOK_TYPE_CLOSE
]) {

87 
¢d_pcm_hook_t
 *
hook
 = 
	`li¡_’Œy
(
pos
, snd_pcm_hook_t, 
li¡
);

88 
”r
 = 
hook
->
	`func
(hook);

89 ià(
”r
 < 0)

90 
»s
 = 
”r
;

92 
k
 = 0; k <ğ
SND_PCM_HOOK_TYPE_LAST
; ++k) {

93 
li¡_h—d
 *
hooks
 = &
h
->hooks[
k
];

94 !
	`li¡_em±y
(
hooks
)) {

95 
¢d_pcm_hook_t
 *
hook
;

96 
pos
 = 
hooks
->
Ãxt
;

97 
hook
 = 
	`li¡_’Œy
(
pos
, 
¢d_pcm_hook_t
, 
li¡
);

98 
	`¢d_pcm_hook_»move
(
hook
);

101 !
	`li¡_em±y
(&
h
->
dÎi¡
)) {

102 
pos
 = 
h
->
dÎi¡
.
Ãxt
;

103 
	`hook_»move_dlobj
(
	`li¡_’Œy
(
pos
, 
¢d_pcm_hook_dÎi¡
, 
li¡
));

105 
”r
 = 
	`¢d_pcm_g’”ic_şo£
(
pcm
);

106 ià(
”r
 < 0)

107 
»s
 = 
”r
;

108  
»s
;

109 
	}
}

111 
	$¢d_pcm_hooks_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

113 
¢d_pcm_hooks_t
 *
h
 = 
pcm
->
´iv©e_d©a
;

114 
li¡_h—d
 *
pos
, *
Ãxt
;

115 
”r
 = 
	`¢d_pcm_g’”ic_hw_·¿ms
(
pcm
, 
·¿ms
);

116 ià(
”r
 < 0)

117  
”r
;

118 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Ãxt
, &
h
->
hooks
[
SND_PCM_HOOK_TYPE_HW_PARAMS
]) {

119 
¢d_pcm_hook_t
 *
hook
 = 
	`li¡_’Œy
(
pos
, snd_pcm_hook_t, 
li¡
);

120 
”r
 = 
hook
->
	`func
(hook);

121 ià(
”r
 < 0)

122  
”r
;

125 
	}
}

127 
	$¢d_pcm_hooks_hw_ä“
(
¢d_pcm_t
 *
pcm
)

129 
¢d_pcm_hooks_t
 *
h
 = 
pcm
->
´iv©e_d©a
;

130 
li¡_h—d
 *
pos
, *
Ãxt
;

131 
”r
 = 
	`¢d_pcm_g’”ic_hw_ä“
(
pcm
);

132 ià(
”r
 < 0)

133  
”r
;

134 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Ãxt
, &
h
->
hooks
[
SND_PCM_HOOK_TYPE_HW_FREE
]) {

135 
¢d_pcm_hook_t
 *
hook
 = 
	`li¡_’Œy
(
pos
, snd_pcm_hook_t, 
li¡
);

136 
”r
 = 
hook
->
	`func
(hook);

137 ià(
”r
 < 0)

138  
”r
;

141 
	}
}

143 
	$¢d_pcm_hooks_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

145 
¢d_pcm_hooks_t
 *
h
 = 
pcm
->
´iv©e_d©a
;

146 
	`¢d_ouut_´štf
(
out
, "Hooks PCM\n");

147 ià(
pcm
->
£tup
) {

148 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

149 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

151 
	`¢d_ouut_´štf
(
out
, "Slave: ");

152 
	`¢d_pcm_dump
(
h
->
g’
.
¦ave
, 
out
);

153 
	}
}

155 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_hooks_İs
 = {

156 .
şo£
 = 
¢d_pcm_hooks_şo£
,

157 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

158 .
	ghw_»fše
 = 
¢d_pcm_g’”ic_hw_»fše
,

159 .
	ghw_·¿ms
 = 
¢d_pcm_hooks_hw_·¿ms
,

160 .
	ghw_ä“
 = 
¢d_pcm_hooks_hw_ä“
,

161 .
	gsw_·¿ms
 = 
¢d_pcm_g’”ic_sw_·¿ms
,

162 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

163 .
	gdump
 = 
¢d_pcm_hooks_dump
,

164 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

165 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

166 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

167 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

168 .
	gqu”y_chm­s
 = 
¢d_pcm_g’”ic_qu”y_chm­s
,

169 .
	gg‘_chm­
 = 
¢d_pcm_g’”ic_g‘_chm­
,

170 .
	g£t_chm­
 = 
¢d_pcm_g’”ic_£t_chm­
,

173 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_hooks_ç¡_İs
 = {

174 .
¡©us
 = 
¢d_pcm_g’”ic_¡©us
,

175 .
	g¡©e
 = 
¢d_pcm_g’”ic_¡©e
,

176 .
	ghwsync
 = 
¢d_pcm_g’”ic_hwsync
,

177 .
	gd–ay
 = 
¢d_pcm_g’”ic_d–ay
,

178 .
	g´•¬e
 = 
¢d_pcm_g’”ic_´•¬e
,

179 .
	g»£t
 = 
¢d_pcm_g’”ic_»£t
,

180 .
	g¡¬t
 = 
¢d_pcm_g’”ic_¡¬t
,

181 .
	gdrİ
 = 
¢d_pcm_g’”ic_drİ
,

182 .
	gd¿š
 = 
¢d_pcm_g’”ic_d¿š
,

183 .
	g·u£
 = 
¢d_pcm_g’”ic_·u£
,

184 .
	g»wšdabË
 = 
¢d_pcm_g’”ic_»wšdabË
,

185 .
	g»wšd
 = 
¢d_pcm_g’”ic_»wšd
,

186 .
	gfÜw¬dabË
 = 
¢d_pcm_g’”ic_fÜw¬dabË
,

187 .
	gfÜw¬d
 = 
¢d_pcm_g’”ic_fÜw¬d
,

188 .
	g»sume
 = 
¢d_pcm_g’”ic_»sume
,

189 .
	glšk
 = 
¢d_pcm_g’”ic_lšk
,

190 .
	glšk_¦aves
 = 
¢d_pcm_g’”ic_lšk_¦aves
,

191 .
	guÆšk
 = 
¢d_pcm_g’”ic_uÆšk
,

192 .
	gwr™ei
 = 
¢d_pcm_g’”ic_wr™ei
,

193 .
	gwr™’
 = 
¢d_pcm_g’”ic_wr™’
,

194 .
	g»adi
 = 
¢d_pcm_g’”ic_»adi
,

195 .
	g»adn
 = 
¢d_pcm_g’”ic_»adn
,

196 .
	gava_upd©e
 = 
¢d_pcm_g’”ic_ava_upd©e
,

197 .
	gmm­_comm™
 = 
¢d_pcm_g’”ic_mm­_comm™
,

198 .
	ghtime¡amp
 = 
¢d_pcm_g’”ic_htime¡amp
,

199 .
	gpŞl_desütÜs_couÁ
 = 
¢d_pcm_g’”ic_pŞl_desütÜs_couÁ
,

200 .
	gpŞl_desütÜs
 = 
¢d_pcm_g’”ic_pŞl_desütÜs
,

201 .
	gpŞl_»v’ts
 = 
¢d_pcm_g’”ic_pŞl_»v’ts
,

202 .
	gmay_wa™_fÜ_ava_mš
 = 
¢d_pcm_g’”ic_may_wa™_fÜ_ava_mš
,

216 
	$¢d_pcm_hooks_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
, snd_pcm_ˆ*
¦ave
, 
şo£_¦ave
)

218 
¢d_pcm_t
 *
pcm
;

219 
¢d_pcm_hooks_t
 *
h
;

220 
k
;

221 
”r
;

222 
	`as£¹
(
pcmp
 && 
¦ave
);

223 
h
 = 
	`ÿÎoc
(1, (
¢d_pcm_hooks_t
));

224 ià(!
h
)

225  -
ENOMEM
;

226 
h
->
g’
.
¦ave
 = slave;

227 
h
->
g’
.
şo£_¦ave
 = close_slave;

228 
k
 = 0; k <ğ
SND_PCM_HOOK_TYPE_LAST
; ++k) {

229 
	`INIT_LIST_HEAD
(&
h
->
hooks
[
k
]);

231 
	`INIT_LIST_HEAD
(&
h
->
dÎi¡
);

232 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_HOOKS
, 
Çme
, 
¦ave
->
¡»am
, sÏve->
mode
);

233 ià(
”r
 < 0) {

234 
	`ä“
(
h
);

235  
”r
;

237 
pcm
->
İs
 = &
¢d_pcm_hooks_İs
;

238 
pcm
->
ç¡_İs
 = &
¢d_pcm_hooks_ç¡_İs
;

239 
pcm
->
´iv©e_d©a
 = 
h
;

240 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

241 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

242 
pcm
->
mm­_shadow
 = 1;

243 
pcm
->
t¡amp_ty³
 = 
¦ave
->tstamp_type;

244 
	`¢d_pcm_lšk_hw_±r
(
pcm
, 
¦ave
);

245 
	`¢d_pcm_lšk_­¶_±r
(
pcm
, 
¦ave
);

246 *
pcmp
 = 
pcm
;

249 
	}
}

341 
	$¢d_pcm_hook_add_cÚf
(
¢d_pcm_t
 *
pcm
, 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
)

343 
”r
;

344 
buf
[256], 
”rbuf
[256];

345 cÚ¡ *
¡r
, *
id
;

346 cÚ¡ *
lib
 = 
NULL
, *
š¡®l
 = NULL;

347 
¢d_cÚfig_t
 *
ty³
 = 
NULL
, *
¬gs
 = NULL;

348 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

349 (*
š¡®l_func
)(
¢d_pcm_t
 *
pcm
, 
¢d_cÚfig_t
 *
¬gs
èğ
NULL
;

350 *
h
 = 
NULL
;

352 ià(
	`¢d_cÚfig_g‘_ty³
(
cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

353 
	`SNDERR
("Invalid hook definition");

354  -
EINVAL
;

356 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

357 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

358 cÚ¡ *
id
;

359 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

361 ià(
	`¡rcmp
(
id
, "comment") == 0)

363 ià(
	`¡rcmp
(
id
, "type") == 0) {

364 
ty³
 = 
n
;

367 ià(
	`¡rcmp
(
id
, "hook_args") == 0) {

368 
¬gs
 = 
n
;

371 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

372  -
EINVAL
;

374 ià(!
ty³
) {

375 
	`SNDERR
("type is‚ot defined");

376  -
EINVAL
;

378 
”r
 = 
	`¢d_cÚfig_g‘_id
(
ty³
, &
id
);

379 ià(
”r
 < 0) {

380 
	`SNDERR
("unableo get id");

381  
”r
;

383 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
ty³
, &
¡r
);

384 ià(
”r
 < 0) {

385 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

386  
”r
;

388 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "pcm_hook_ty³", 
¡r
, &
ty³
);

389 ià(
”r
 >= 0) {

390 ià(
	`¢d_cÚfig_g‘_ty³
(
ty³
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

391 
	`SNDERR
("Inv®idy³ fÜ PCMy³ % defš™iÚ", 
¡r
);

392 
”r
 = -
EINVAL
;

393 
_”r
;

395 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
ty³
) {

396 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

397 cÚ¡ *
id
;

398 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

400 ià(
	`¡rcmp
(
id
, "comment") == 0)

402 ià(
	`¡rcmp
(
id
, "lib") == 0) {

403 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
lib
);

404 ià(
”r
 < 0) {

405 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

406 
_”r
;

410 ià(
	`¡rcmp
(
id
, "install") == 0) {

411 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
š¡®l
);

412 ià(
”r
 < 0) {

413 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

414 
_”r
;

418 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

419 
”r
 = -
EINVAL
;

420 
_”r
;

423 ià(!
š¡®l
) {

424 
š¡®l
 = 
buf
;

425 
	`¢´štf
(
buf
, (buf), "_¢d_pcm_hook_%s_š¡®l", 
¡r
);

427 
h
 = 
	`INTERNAL
(
¢d_dlİ’
)(
lib
, 
RTLD_NOW
, 
”rbuf
, (errbuf));

428 
š¡®l_func
 = 
h
 ? 
	`¢d_dlsym
(h, 
š¡®l
, 
	`SND_DLSYM_VERSION
(
SND_PCM_DLSYM_VERSION
)è: 
NULL
;

429 
”r
 = 0;

430 ià(!
h
) {

431 
	`SNDERR
("Cannot open shared†ibrary %s (%s)",

432 
lib
 ?†ib : "[butš]", 
”rbuf
);

433 
”r
 = -
ENOENT
;

434 } ià(!
š¡®l_func
) {

435 
	`SNDERR
("symbŞ % i nÙ defšed insid%s", 
š¡®l
,

436 
lib
 ?†ib : "[builtin]");

437 
	`¢d_dlşo£
(
h
);

438 
”r
 = -
ENXIO
;

440 
_”r
:

441 ià(
ty³
)

442 
	`¢d_cÚfig_d–‘e
(
ty³
);

443 ià(
”r
 < 0)

444  
”r
;

446 ià(
¬gs
 && 
	`¢d_cÚfig_g‘_¡ršg
×rgs, &
¡r
) >= 0) {

447 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "hook_¬gs", 
¡r
, &
¬gs
);

448 ià(
”r
 < 0)

449 
	`SNDERR
("unknowÀhook_¬g %s", 
¡r
);

451 
”r
 = 
	`š¡®l_func
(
pcm
, 
¬gs
);

452 
	`¢d_cÚfig_d–‘e
(
¬gs
);

454 
”r
 = 
	`š¡®l_func
(
pcm
, 
¬gs
);

456 ià(
”r
 >= 0)

457 
”r
 = 
	`hook_add_dlobj
(
pcm
, 
h
);

459 ià(
”r
 < 0) {

460 if(
h
)

461 
	`¢d_dlşo£
(
h
);

462  
”r
;

465 
	}
}

480 
	$_¢d_pcm_hooks_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

481 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

482 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

484 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

485 
”r
;

486 
¢d_pcm_t
 *
½cm
 = 
NULL
, *
¥cm
;

487 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

488 
¢d_cÚfig_t
 *
hooks
 = 
NULL
;

489 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

490 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

491 cÚ¡ *
id
;

492 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

494 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

496 ià(
	`¡rcmp
(
id
, "slave") == 0) {

497 
¦ave
 = 
n
;

500 ià(
	`¡rcmp
(
id
, "hooks") == 0) {

501 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

502 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

503  -
EINVAL
;

505 
hooks
 = 
n
;

508 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

509  -
EINVAL
;

511 ià(!
¦ave
) {

512 
	`SNDERR
("slave is‚ot defined");

513  -
EINVAL
;

515 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 0);

516 ià(
”r
 < 0)

517  
”r
;

518 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

519 
	`¢d_cÚfig_d–‘e
(
scÚf
);

520 ià(
”r
 < 0)

521  
”r
;

522 
”r
 = 
	`¢d_pcm_hooks_İ’
(&
½cm
, 
Çme
, 
¥cm
, 1);

523 ià(
”r
 < 0) {

524 
	`¢d_pcm_şo£
(
¥cm
);

525  
”r
;

527 ià(!
hooks
)

528 
_dÚe
;

529 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
hooks
) {

530 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

531 cÚ¡ *
¡r
;

532 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
) >= 0) {

533 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "pcm_hook", 
¡r
, &
n
);

534 ià(
”r
 < 0) {

535 
	`SNDERR
("unknowÀpcm_hook %s", 
¡r
);

537 
”r
 = 
	`¢d_pcm_hook_add_cÚf
(
½cm
, 
roÙ
, 
n
);

538 
	`¢d_cÚfig_d–‘e
(
n
);

541 
”r
 = 
	`¢d_pcm_hook_add_cÚf
(
½cm
, 
roÙ
, 
n
);

542 ià(
”r
 < 0) {

543 
	`¢d_pcm_şo£
(
½cm
);

544  
”r
;

547 
_dÚe
:

548 *
pcmp
 = 
½cm
;

550 
	}
}

551 #iâdeà
DOC_HIDDEN


552 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_hooks_İ’
, 
SND_PCM_DLSYM_VERSION
);

560 
¢d_pcm_t
 *
	$¢d_pcm_hook_g‘_pcm
(
¢d_pcm_hook_t
 *
hook
)

562 
	`as£¹
(
hook
);

563  
hook
->
pcm
;

564 
	}
}

571 *
	$¢d_pcm_hook_g‘_´iv©e
(
¢d_pcm_hook_t
 *
hook
)

573 
	`as£¹
(
hook
);

574  
hook
->
´iv©e_d©a
;

575 
	}
}

582 
	$¢d_pcm_hook_£t_´iv©e
(
¢d_pcm_hook_t
 *
hook
, *
´iv©e_d©a
)

584 
	`as£¹
(
hook
);

585 
hook
->
´iv©e_d©a
 =…rivate_data;

586 
	}
}

600 
	$¢d_pcm_hook_add
(
¢d_pcm_hook_t
 **
hookp
, 
¢d_pcm_t
 *
pcm
,

601 
¢d_pcm_hook_ty³_t
 
ty³
,

602 
¢d_pcm_hook_func_t
 
func
, *
´iv©e_d©a
)

604 
¢d_pcm_hook_t
 *
h
;

605 
¢d_pcm_hooks_t
 *
hooks
;

606 
	`as£¹
(
hookp
 && 
func
);

607 
	`as£¹
(
	`¢d_pcm_ty³
(
pcm
è=ğ
SND_PCM_TYPE_HOOKS
);

608 
h
 = 
	`ÿÎoc
(1, (*h));

609 ià(!
h
)

610  -
ENOMEM
;

611 
h
->
pcm
 =…cm;

612 
h
->
func
 = func;

613 
h
->
´iv©e_d©a
 =…rivate_data;

614 
hooks
 = 
pcm
->
´iv©e_d©a
;

615 
	`li¡_add_
(&
h
->
li¡
, &
hooks
->hooks[
ty³
]);

616 *
hookp
 = 
h
;

618 
	}
}

628 
	$¢d_pcm_hook_»move
(
¢d_pcm_hook_t
 *
hook
)

630 
	`as£¹
(
hook
);

631 
	`li¡_d–
(&
hook
->
li¡
);

632 
	`ä“
(
hook
);

634 
	}
}

640 
	$¢d_pcm_hook_ùl_–ems_hw_·¿ms
(
¢d_pcm_hook_t
 *
hook
)

642 
¢d_sùl_t
 *
h
 = 
	`¢d_pcm_hook_g‘_´iv©e
(
hook
);

643  
	`¢d_sùl_š¡®l
(
h
);

644 
	}
}

646 
	$¢d_pcm_hook_ùl_–ems_hw_ä“
(
¢d_pcm_hook_t
 *
hook
)

648 
¢d_sùl_t
 *
h
 = 
	`¢d_pcm_hook_g‘_´iv©e
(
hook
);

649  
	`¢d_sùl_»move
(
h
);

650 
	}
}

652 
	$¢d_pcm_hook_ùl_–ems_şo£
(
¢d_pcm_hook_t
 *
hook
)

654 
¢d_sùl_t
 *
h
 = 
	`¢d_pcm_hook_g‘_´iv©e
(
hook
);

655 
”r
 = 
	`¢d_sùl_ä“
(
h
);

656 
	`¢d_pcm_hook_£t_´iv©e
(
hook
, 
NULL
);

657  
”r
;

658 
	}
}

666 
	$_¢d_pcm_hook_ùl_–ems_š¡®l
(
¢d_pcm_t
 *
pcm
, 
¢d_cÚfig_t
 *
cÚf
)

668 
”r
;

669 
ÿrd
;

670 
¢d_pcm_šfo_t
 
šfo
 = {0};

671 
ùl_Çme
[16];

672 
¢d_ùl_t
 *
ùl
;

673 
¢d_sùl_t
 *
sùl
 = 
NULL
;

674 
¢d_cÚfig_t
 *
pcm_cÚf
 = 
NULL
;

675 
¢d_pcm_hook_t
 *
h_hw_·¿ms
 = 
NULL
, *
h_hw_ä“
 = NULL, *
h_şo£
 = NULL;

676 
	`as£¹
(
cÚf
);

677 
	`as£¹
(
	`¢d_cÚfig_g‘_ty³
(
cÚf
è=ğ
SND_CONFIG_TYPE_COMPOUND
);

679 
”r
 = 
	`¢d_pcm_šfo
(
pcm
, &
šfo
);

680 ià(
”r
 < 0)

681  
”r
;

682 
ÿrd
 = 
	`¢d_pcm_šfo_g‘_ÿrd
(&
šfo
);

683 ià(
ÿrd
 < 0) {

684 
	`SNDERR
("No card forhis PCM");

685  -
EINVAL
;

687 
	`¥rštf
(
ùl_Çme
, "hw:%d", 
ÿrd
);

688 
”r
 = 
	`¢d_ùl_İ’
(&
ùl
, 
ùl_Çme
, 0);

689 ià(
”r
 < 0) {

690 
	`SNDERR
("CªnÙ o³ÀCTL %s", 
ùl_Çme
);

691  
”r
;

693 
”r
 = 
	`¢d_cÚfig_imake_poš‹r
(&
pcm_cÚf
, "pcm_hªdË", 
pcm
);

694 ià(
”r
 < 0)

695 
_”r
;

696 
”r
 = 
	`¢d_sùl_bud
(&
sùl
, 
ùl
, 
cÚf
, 
pcm_cÚf
, 0);

697 ià(
”r
 < 0)

698 
_”r
;

699 
”r
 = 
	`¢d_pcm_hook_add
(&
h_hw_·¿ms
, 
pcm
, 
SND_PCM_HOOK_TYPE_HW_PARAMS
,

700 
¢d_pcm_hook_ùl_–ems_hw_·¿ms
, 
sùl
);

701 ià(
”r
 < 0)

702 
_”r
;

703 
”r
 = 
	`¢d_pcm_hook_add
(&
h_hw_ä“
, 
pcm
, 
SND_PCM_HOOK_TYPE_HW_FREE
,

704 
¢d_pcm_hook_ùl_–ems_hw_ä“
, 
sùl
);

705 ià(
”r
 < 0)

706 
_”r
;

707 
”r
 = 
	`¢d_pcm_hook_add
(&
h_şo£
, 
pcm
, 
SND_PCM_HOOK_TYPE_CLOSE
,

708 
¢d_pcm_hook_ùl_–ems_şo£
, 
sùl
);

709 ià(
”r
 < 0)

710 
_”r
;

711 
	`¢d_cÚfig_d–‘e
(
pcm_cÚf
);

713 
_”r
:

714 ià(
h_hw_·¿ms
)

715 
	`¢d_pcm_hook_»move
(
h_hw_·¿ms
);

716 ià(
h_hw_ä“
)

717 
	`¢d_pcm_hook_»move
(
h_hw_ä“
);

718 ià(
h_şo£
)

719 
	`¢d_pcm_hook_»move
(
h_şo£
);

720 ià(
sùl
)

721 
	`¢d_sùl_ä“
(
sùl
);

722 ià(
pcm_cÚf
)

723 
	`¢d_cÚfig_d–‘e
(
pcm_cÚf
);

724  
”r
;

725 
	}
}

726 #iâdeà
DOC_HIDDEN


727 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_hook_ùl_–ems_š¡®l
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_hw.c

30 
	~"pcm_loÿl.h
"

31 
	~"../cÚŒŞ/cÚŒŞ_loÿl.h
"

32 
	~"../tim”/tim”_loÿl.h
"

33 
	~<¡dio.h
>

34 
	~<¡dlib.h
>

35 
	~<¡ddef.h
>

36 
	~<uni¡d.h
>

37 
	~<¡dboŞ.h
>

38 
	~<sigÇl.h
>

39 
	~<¡ršg.h
>

40 
	~<fú.h
>

41 
	~<sys/ioùl.h
>

42 
	~<sys/mmª.h
>

47 #iâdeà
PIC


49 cÚ¡ *
	g_¢d_moduË_pcm_hw
 = "";

52 #iâdeà
DOC_HIDDEN


54 #iâdeà
F_SETSIG


55 
	#F_SETSIG
 10

	)

62 
	s¢drv_pcm_hw_·¿ms_Şd
 {

63 
	mæags
;

64 
	mmasks
[
SNDRV_PCM_HW_PARAM_SUBFORMAT
 -

65 
SNDRV_PCM_HW_PARAM_ACCESS
 + 1];

66 
¢d_š‹rv®
 
	mš‹rv®s
[
SNDRV_PCM_HW_PARAM_TICK_TIME
 -

67 
SNDRV_PCM_HW_PARAM_SAMPLE_BITS
 + 1];

68 
	mrmask
;

69 
	mcmask
;

70 
	mšfo
;

71 
	mmsb™s
;

72 
	m¿‹_num
;

73 
	m¿‹_d’
;

74 
¢drv_pcm_uäames_t
 
	mfifo_size
;

75 
	m»£rved
[64];

78 
	#SND_PCM_IOCTL_HW_REFINE_OLD
 
	`_IOWR
('A', 0x10, 
¢drv_pcm_hw_·¿ms_Şd
)

	)

79 
	#SND_PCM_IOCTL_HW_PARAMS_OLD
 
	`_IOWR
('A', 0x11, 
¢drv_pcm_hw_·¿ms_Şd
)

	)

81 
u£_Şd_hw_·¿ms_ioùl
(
fd
, 
cmd
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

82 
¢d_pcm_säames_t
 
¢d_pcm_hw_ava_upd©e
(
¢d_pcm_t
 *
pcm
);

83 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_hw_ç¡_İs
;

84 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_hw_ç¡_İs_tim”
;

91 
	mv”siÚ
;

92 
	mfd
;

93 
	mÿrd
, 
	mdeviû
, 
	msubdeviû
;

95 vŞ©
¢d_pcm_mm­_¡©us
 * 
	mmm­_¡©us
;

96 
¢d_pcm_mm­_cÚŒŞ
 *
	mmm­_cÚŒŞ
;

97 
boŞ
 
	mmm­_¡©us_çÎbacked
;

98 
boŞ
 
	mmm­_cÚŒŞ_çÎbacked
;

99 
¢d_pcm_sync_±r
 *
	msync_±r
;

101 
boŞ
 
	m´•¬e_»£t_sw_·¿ms
;

102 
boŞ
 
	m³rãù_d¿š
;

104 
	m³riod_ev’t
;

105 
¢d_tim”_t
 *
	m³riod_tim”
;

106 
pŞlfd
 
	m³riod_tim”_pfd
;

107 
	m³riod_tim”_Ãed_pŞl
;

109 
¢d_pcm_fÜm©_t
 
	mfÜm©
;

111 
	mmš
;

112 
	mmax
;

113 } 
	m¿‹s
;

114 
	mchªÃls
;

115 
	md¿š_s’û
;

117 
	mchm­_ÿps
;

118 
¢d_pcm_chm­_qu”y_t
 **
	mchm­_ov”ride
;

119 } 
	t¢d_pcm_hw_t
;

121 
	#SNDRV_FILE_PCM_STREAM_PLAYBACK
 
ALSA_DEVICE_DIRECTORY
 "pcmC%iD%"

	)

122 
	#SNDRV_FILE_PCM_STREAM_CAPTURE
 
ALSA_DEVICE_DIRECTORY
 "pcmC%iD%ic"

	)

123 
	#SNDRV_PCM_VERSION_MAX
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 9)

	)

126 
	#FAST_PCM_STATE
(
hw
) \

127 ((
¢d_pcm_¡©e_t
è(
hw
)->
mm­_¡©us
->
¡©e
)

	)

128 
	#FAST_PCM_TSTAMP
(
hw
) \

129 ((
hw
)->
mm­_¡©us
->
t¡amp
)

	)

131 
time¥ec
 
	$¢d_pcm_hw_ç¡_t¡amp
(
¢d_pcm_t
 *
pcm
)

133 
time¥ec
 
»s
;

134 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

135 
»s
 = 
	`FAST_PCM_TSTAMP
(
hw
);

136 ià(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 5è> 
hw
->
v”siÚ
)

137 
»s
.
tv_n£c
 *= 1000L;

138  
»s
;

139 
	}
}

142 
	$sync_±r1
(
¢d_pcm_hw_t
 *
hw
, 
æags
)

144 
”r
;

145 
hw
->
sync_±r
->
æags
 = flags;

146 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_SYNC_PTR
, hw->
sync_±r
) < 0) {

147 
”r
 = -
”ºo
;

148 
	`SYSMSG
("SNDRV_PCM_IOCTL_SYNC_PTR faed (%i)", 
”r
);

149  
”r
;

152 
	}
}

154 
	$issue_ava_mš
(
¢d_pcm_hw_t
 *
hw
)

156 ià(!
hw
->
mm­_cÚŒŞ_çÎbacked
)

160  
	`sync_±r1
(
hw
, 
SNDRV_PCM_SYNC_PTR_APPL
);

161 
	}
}

163 
	$issue_­¶±r
(
¢d_pcm_hw_t
 *
hw
)

165 ià(!
hw
->
mm­_cÚŒŞ_çÎbacked
)

169  
	`sync_±r1
(
hw
, 
SNDRV_PCM_SYNC_PTR_AVAIL_MIN
);

170 
	}
}

172 
	$»que¡_hwsync
(
¢d_pcm_hw_t
 *
hw
)

174 ià(!
hw
->
mm­_¡©us_çÎbacked
)

181  
	`sync_±r1
(
hw
,

182 
SNDRV_PCM_SYNC_PTR_HWSYNC
 |

183 
SNDRV_PCM_SYNC_PTR_APPL
 |

184 
SNDRV_PCM_SYNC_PTR_AVAIL_MIN
);

185 
	}
}

187 
	$qu”y_¡©us_ªd_cÚŒŞ_d©a
(
¢d_pcm_hw_t
 *
hw
)

189 ià(!
hw
->
mm­_cÚŒŞ_çÎbacked
)

196  
	`sync_±r1
(
hw
,

197 
SNDRV_PCM_SYNC_PTR_APPL
 |

198 
SNDRV_PCM_SYNC_PTR_AVAIL_MIN
);

199 
	}
}

201 
	$qu”y_¡©us_d©a
(
¢d_pcm_hw_t
 *
hw
)

203 ià(!
hw
->
mm­_¡©us_çÎbacked
)

210  
	`sync_±r1
(
hw
,

211 
SNDRV_PCM_SYNC_PTR_APPL
 |

212 
SNDRV_PCM_SYNC_PTR_AVAIL_MIN
);

213 
	}
}

215 
	$¢d_pcm_hw_ş—r_tim”_queue
(
¢d_pcm_hw_t
 *
hw
)

217 ià(
hw
->
³riod_tim”_Ãed_pŞl
) {

218 
	`pŞl
(&
hw
->
³riod_tim”_pfd
, 1, 0) > 0) {

219 
¢d_tim”_Œ—d_t
 
rbuf
[4];

220 
	`¢d_tim”_»ad
(
hw
->
³riod_tim”
, 
rbuf
, (rbuf));

223 
¢d_tim”_Œ—d_t
 
rbuf
[4];

224 
	`¢d_tim”_»ad
(
hw
->
³riod_tim”
, 
rbuf
, (rbuf));

227 
	}
}

229 
	$¢d_pcm_hw_pŞl_desütÜs_couÁ
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

232 
	}
}

234 
	$¢d_pcm_hw_pŞl_desütÜs
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
¥aû
)

236 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

238 ià(
¥aû
 < 2)

239  -
ENOMEM
;

240 
pfds
[0].
fd
 = 
hw
->fd;

241 
pfds
[0].
ev’ts
 = 
pcm
->
pŞl_ev’ts
 | 
POLLERR
 | 
POLLNVAL
;

242 
pfds
[1].
fd
 = 
hw
->
³riod_tim”_pfd
.fd;

243 
pfds
[1].
ev’ts
 = 
POLLIN
 | 
POLLERR
 | 
POLLNVAL
;

245 
	}
}

247 
	$¢d_pcm_hw_pŞl_»v’ts
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

249 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

250 
ev’ts
;

252 ià(
nfds
 !ğ2 || 
pfds
[0].
fd
 !ğ
hw
->fd ||…fds[1].fd !ğhw->
³riod_tim”_pfd
.fd)

253  -
EINVAL
;

254 
ev’ts
 = 
pfds
[0].
»v’ts
;

255 ià(
pfds
[1].
»v’ts
 & 
POLLIN
) {

256 
	`¢d_pcm_hw_ş—r_tim”_queue
(
hw
);

257 
ev’ts
 |ğ
pcm
->
pŞl_ev’ts
 & ~(
POLLERR
|
POLLNVAL
);

259 *
»v’ts
 = 
ev’ts
;

261 
	}
}

263 
	$¢d_pcm_hw_nÚblock
(
¢d_pcm_t
 *
pcm
, 
nÚblock
)

265 
æags
;

266 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

267 
fd
 = 
hw
->fd, 
”r
;

269 ià((
æags
 = 
	`fú
(
fd
, 
F_GETFL
)) < 0) {

270 
”r
 = -
”ºo
;

271 
	`SYSMSG
("F_GETFL faed (%i)", 
”r
);

272  
”r
;

274 ià(
nÚblock
)

275 
æags
 |ğ
O_NONBLOCK
;

277 
æags
 &ğ~
O_NONBLOCK
;

278 ià(
	`fú
(
fd
, 
F_SETFL
, 
æags
) < 0) {

279 
”r
 = -
”ºo
;

280 
	`SYSMSG
("F_SETFL fÜ O_NONBLOCK faed (%i)", 
”r
);

281  
”r
;

284 
	}
}

286 
	$¢d_pcm_hw_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
)

288 
æags
;

289 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

290 
fd
 = 
hw
->fd, 
”r
;

292 ià((
æags
 = 
	`fú
(
fd
, 
F_GETFL
)) < 0) {

293 
”r
 = -
”ºo
;

294 
	`SYSMSG
("F_GETFL faed (%i)", 
”r
);

295  
”r
;

297 ià(
sig
 >= 0)

298 
æags
 |ğ
O_ASYNC
;

300 
æags
 &ğ~
O_ASYNC
;

301 ià(
	`fú
(
fd
, 
F_SETFL
, 
æags
) < 0) {

302 
”r
 = -
”ºo
;

303 
	`SYSMSG
("F_SETFL fÜ O_ASYNC faed (%i)", 
”r
);

304  
”r
;

306 ià(
sig
 < 0)

308 ià(
	`fú
(
fd
, 
F_SETSIG
, ()
sig
) < 0) {

309 
”r
 = -
”ºo
;

310 
	`SYSMSG
("F_SETSIG faed (%i)", 
”r
);

311  
”r
;

313 ià(
	`fú
(
fd
, 
F_SETOWN
, ()
pid
) < 0) {

314 
”r
 = -
”ºo
;

315 
	`SYSMSG
("F_SETOWN faed (%i)", 
”r
);

316  
”r
;

319 
	}
}

321 
	$¢d_pcm_hw_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_šfo_t
 * 
šfo
)

323 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

324 
fd
 = 
hw
->fd, 
”r
;

325 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_INFO
, 
šfo
) < 0) {

326 
”r
 = -
”ºo
;

327 
	`SYSMSG
("SNDRV_PCM_IOCTL_INFO faed (%i)", 
”r
);

328  
”r
;

331 ià(
	`__¢d_pcm_šfo_–d_fixup_check
(
šfo
))

332  
	`__¢d_pcm_šfo_–d_fixup
(
šfo
);

334 
	}
}

336 
šlše
 
	$hw_»fše_ÿÎ
(
¢d_pcm_hw_t
 *
pcm_hw
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

339 ià(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 2è<ğ
pcm_hw
->
v”siÚ
)

340  
	`ioùl
(
pcm_hw
->
fd
, 
SNDRV_PCM_IOCTL_HW_REFINE
, 
·¿ms
);

341  
	`u£_Şd_hw_·¿ms_ioùl
(
pcm_hw
->
fd
, 
SND_PCM_IOCTL_HW_REFINE_OLD
, 
·¿ms
);

342 
	}
}

344 
	$¢d_pcm_hw_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

346 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

347 
”r
;

349 ià(
hw
->
fÜm©
 !ğ
SND_PCM_FORMAT_UNKNOWN
) {

350 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
·¿ms
, 
hw
->
fÜm©
);

351 ià(
”r
 < 0)

352  
”r
;

354 ià(
hw
->
chªÃls
 > 0) {

355 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t
(
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
,

356 
hw
->
chªÃls
, 0);

357 ià(
”r
 < 0)

358  
”r
;

360 ià(
hw
->
¿‹s
.
mš
 > 0) {

361 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mšmax
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
,

362 
hw
->
¿‹s
.
mš
, 0, hw->¿‹s.
max
 + 1, -1);

363 ià(
”r
 < 0)

364  
”r
;

367 ià(
	`hw_»fše_ÿÎ
(
hw
, 
·¿ms
) < 0) {

368 
”r
 = -
”ºo
;

370  
”r
;

373 ià(
·¿ms
->
šfo
 != ~0U) {

374 
·¿ms
->
šfo
 &= ~0xf0000000;

375 ià(
pcm
->
t¡amp_ty³
 !ğ
SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY
)

376 
·¿ms
->
šfo
 |ğ
SND_PCM_INFO_MONOTONIC
;

380 
	}
}

382 
	#hw_·¿m_mask
(
·¿ms
,
v¬
) \

383 &((
·¿ms
)->
masks
[(
v¬
è- 
SND_PCM_HW_PARAM_FIRST_MASK
])

	)

385 
	$hw_·¿ms_ÿÎ
(
¢d_pcm_hw_t
 *
pcm_hw
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

387 
”r
;

390 ià(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 2è<ğ
pcm_hw
->
v”siÚ
)

391 
”r
 = 
	`ioùl
(
pcm_hw
->
fd
, 
SNDRV_PCM_IOCTL_HW_PARAMS
, 
·¿ms
);

393 
”r
 = 
	`u£_Şd_hw_·¿ms_ioùl
(
pcm_hw
->
fd
, 
SND_PCM_IOCTL_HW_PARAMS_OLD
, 
·¿ms
);

394 ià(
”r
 >ğ0 && 
pcm_hw
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 17è&& 
·¿ms
->
msb™s
 > 0) {

395 
¢d_mask_t
 *
m
 = 
	`hw_·¿m_mask
(
·¿ms
, 
SNDRV_PCM_HW_PARAM_FORMAT
);

396 ià(
	`¢d_mask_sšgË
(
m
)) {

397 
¢d_pcm_fÜm©_t
 
fÜm©
 = 
	`¢d_mask_mš
(
m
);

398 
width
 = 
	`¢d_pcm_fÜm©_width
(
fÜm©
);

399 ià(
width
 > 0 && 
·¿ms
->
msb™s
 > ()width)

400 
·¿ms
->
msb™s
 = 
width
;

403  
”r
;

404 
	}
}

406 
	$¢d_pcm_hw_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 * 
·¿ms
)

408 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

409 
”r
;

410 ià(
	`hw_·¿ms_ÿÎ
(
hw
, 
·¿ms
) < 0) {

411 
”r
 = -
”ºo
;

412 
	`SYSMSG
("SNDRV_PCM_IOCTL_HW_PARAMS faed (%i)", 
”r
);

413  
”r
;

415 
·¿ms
->
šfo
 &= ~0xf0000000;

416 ià(
pcm
->
t¡amp_ty³
 !ğ
SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY
)

417 
·¿ms
->
šfo
 |ğ
SND_PCM_INFO_MONOTONIC
;

418 
hw
->
³rãù_d¿š
 = !!(
·¿ms
->
šfo
 & 
SND_PCM_INFO_PERFECT_DRAIN
) ||

419 !!(
·¿ms
->
æags
 & 
SND_PCM_HW_PARAMS_NO_DRAIN_SILENCE
);

420  
	`qu”y_¡©us_d©a
(
hw
);

421 
	}
}

423 
	$¢d_pcm_hw_şo£_tim”
(
¢d_pcm_hw_t
 *
hw
)

425 ià(
hw
->
³riod_tim”
) {

426 
	`¢d_tim”_şo£
(
hw
->
³riod_tim”
);

427 
hw
->
³riod_tim”
 = 
NULL
;

429 
	}
}

431 
	$¢d_pcm_hw_chªge_tim”
(
¢d_pcm_t
 *
pcm
, 
’abË
)

433 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

434 
¢d_tim”_·¿ms_t
 
·¿ms
 = {0};

435 
su¥’d
, 
»sume
;

436 
”r
;

438 ià(
’abË
) {

439 
”r
 = 
	`¢d_tim”_hw_İ’
(&
hw
->
³riod_tim”
,

441 
SND_TIMER_CLASS_PCM
, 
SND_TIMER_SCLASS_NONE
,

442 
hw
->
ÿrd
, hw->
deviû
,

443 (
hw
->
subdeviû
 << 1è| (
pcm
->
¡»am
 & 1),

444 
SND_TIMER_OPEN_NONBLOCK
 | 
SND_TIMER_OPEN_TREAD
);

445 ià(
”r
 < 0) {

446 
”r
 = 
	`¢d_tim”_hw_İ’
(&
hw
->
³riod_tim”
,

448 
SND_TIMER_CLASS_PCM
, 
SND_TIMER_SCLASS_NONE
,

449 
hw
->
ÿrd
, hw->
deviû
,

450 (
hw
->
subdeviû
 << 1è| (
pcm
->
¡»am
 & 1),

451 
SND_TIMER_OPEN_NONBLOCK
);

452  
”r
;

454 ià(
	`¢d_tim”_pŞl_desütÜs_couÁ
(
hw
->
³riod_tim”
) != 1) {

455 
	`¢d_pcm_hw_şo£_tim”
(
hw
);

456  -
EINVAL
;

458 
hw
->
³riod_tim”_pfd
.
ev’ts
 = 
POLLIN
;

459 
hw
->
³riod_tim”_pfd
.
»v’ts
 = 0;

460 
	`¢d_tim”_pŞl_desütÜs
(
hw
->
³riod_tim”
,

461 &
hw
->
³riod_tim”_pfd
, 1);

462 
hw
->
³riod_tim”_Ãed_pŞl
 = 0;

463 
su¥’d
 = 1<<
SND_TIMER_EVENT_MSUSPEND
;

464 
»sume
 = 1<<
SND_TIMER_EVENT_MRESUME
;

469 
v”
 = 0;

470 
	`ioùl
(
hw
->
³riod_tim”_pfd
.
fd
,

471 
SNDRV_TIMER_IOCTL_PVERSION
, &
v”
);

477 ià(
v”
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4))

478 
hw
->
³riod_tim”_Ãed_pŞl
 = 1;

483 ià(
v”
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 5)) {

484 
su¥’d
 = 1<<
SND_TIMER_EVENT_MPAUSE
;

485 
»sume
 = 1<<
SND_TIMER_EVENT_MCONTINUE
;

488 
	`¢d_tim”_·¿ms_£t_auto_¡¬t
(&
·¿ms
, 1);

489 
	`¢d_tim”_·¿ms_£t_ticks
(&
·¿ms
, 1);

490 
	`INTERNAL
(
¢d_tim”_·¿ms_£t_f‹r
)(&
·¿ms
, (1<<
SND_TIMER_EVENT_TICK
) |

491 
su¥’d
 | 
»sume
);

492 
”r
 = 
	`¢d_tim”_·¿ms
(
hw
->
³riod_tim”
, &
·¿ms
);

493 ià(
”r
 < 0) {

494 
	`¢d_pcm_hw_şo£_tim”
(
hw
);

495  
”r
;

497 
”r
 = 
	`¢d_tim”_¡¬t
(
hw
->
³riod_tim”
);

498 ià(
”r
 < 0) {

499 
	`¢d_pcm_hw_şo£_tim”
(
hw
);

500  
”r
;

502 
pcm
->
ç¡_İs
 = &
¢d_pcm_hw_ç¡_İs_tim”
;

504 
	`¢d_pcm_hw_şo£_tim”
(
hw
);

505 
pcm
->
ç¡_İs
 = &
¢d_pcm_hw_ç¡_İs
;

506 
hw
->
³riod_ev’t
 = 0;

509 
	}
}

511 
	$¢d_pcm_hw_hw_ä“
(
¢d_pcm_t
 *
pcm
)

513 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

514 
fd
 = 
hw
->fd, 
”r
;

515 
	`¢d_pcm_hw_chªge_tim”
(
pcm
, 0);

516 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_HW_FREE
) < 0) {

517 
”r
 = -
”ºo
;

518 
	`SYSMSG
("SNDRV_PCM_IOCTL_HW_FREE faed (%i)", 
”r
);

519  
”r
;

522 
	}
}

524 
	$¢d_pcm_hw_sw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 * 
·¿ms
)

526 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

527 
fd
 = 
hw
->fd, 
”r
 = 0;

528 
Şd_³riod_ev’t
 = 
	`sw_g‘_³riod_ev’t
(
·¿ms
);

529 
	`sw_£t_³riod_ev’t
(
·¿ms
, 0);

530 ià((
¢d_pcm_t¡amp_t
è
·¿ms
->
t¡amp_mode
 =ğ
pcm
->tstamp_mode &&

531 (
¢d_pcm_t¡amp_ty³_t
è
·¿ms
->
t¡amp_ty³
 =ğ
pcm
->tstamp_type &&

532 
·¿ms
->
³riod_¡•
 =ğ
pcm
->period_step &&

533 
·¿ms
->
¡¬t_th»shŞd
 =ğ
pcm
->start_threshold &&

534 
·¿ms
->
¡İ_th»shŞd
 =ğ
pcm
->stop_threshold &&

535 
·¿ms
->
s’û_th»shŞd
 =ğ
pcm
->silence_threshold &&

536 
·¿ms
->
s’û_size
 =ğ
pcm
->silence_size &&

537 
Şd_³riod_ev’t
 =ğ
hw
->
³riod_ev’t
) {

538 
hw
->
mm­_cÚŒŞ
->
ava_mš
 = 
·¿ms
->avail_min;

539 
”r
 = 
	`issue_ava_mš
(
hw
);

540 
out
;

542 ià(
·¿ms
->
t¡amp_ty³
 =ğ
SND_PCM_TSTAMP_TYPE_MONOTONIC_RAW
 &&

543 
hw
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 12)) {

544 
	`SYSMSG
("Kernel doesn't support SND_PCM_TSTAMP_TYPE_MONOTONIC_RAW");

545 
”r
 = -
EINVAL
;

546 
out
;

548 ià(
·¿ms
->
t¡amp_ty³
 =ğ
SND_PCM_TSTAMP_TYPE_MONOTONIC
 &&

549 
hw
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 5)) {

550 
	`SYSMSG
("Kernel doesn't support SND_PCM_TSTAMP_TYPE_MONOTONIC");

551 
”r
 = -
EINVAL
;

552 
out
;

554 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_SW_PARAMS
, 
·¿ms
) < 0) {

555 
”r
 = -
”ºo
;

556 
	`SYSMSG
("SNDRV_PCM_IOCTL_SW_PARAMS faed (%i)", 
”r
);

557 
out
;

559 
hw
->
´•¬e_»£t_sw_·¿ms
 = 
çl£
;

560 ià((
¢d_pcm_t¡amp_ty³_t
è
·¿ms
->
t¡amp_ty³
 !ğ
pcm
->tstamp_type) {

561 ià(
hw
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 12)) {

562 
Ú
 = (
¢d_pcm_t¡amp_ty³_t
è
·¿ms
->
t¡amp_ty³
 ==

563 
SND_PCM_TSTAMP_TYPE_MONOTONIC
;

564 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_TSTAMP
, &
Ú
) < 0) {

565 
”r
 = -
”ºo
;

566 
	`SNDMSG
("TSTAMP failed");

567 
out
;

570 
pcm
->
t¡amp_ty³
 = 
·¿ms
->tstamp_type;

572 
hw
->
mm­_cÚŒŞ
->
ava_mš
 = 
·¿ms
->avail_min;

573 ià(
hw
->
³riod_ev’t
 !ğ
Şd_³riod_ev’t
) {

574 
”r
 = 
	`¢d_pcm_hw_chªge_tim”
(
pcm
, 
Şd_³riod_ev’t
);

575 ià(
”r
 < 0)

576 
out
;

577 
hw
->
³riod_ev’t
 = 
Şd_³riod_ev’t
;

579 
out
:

580 
	`sw_£t_³riod_ev’t
(
·¿ms
, 
Şd_³riod_ev’t
);

581  
”r
;

582 
	}
}

584 
	$¢d_pcm_hw_chªÃl_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_šfo_t
 * 
šfo
)

586 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

587 
¢d_pcm_chªÃl_šfo
 
i
;

588 
fd
 = 
hw
->fd, 
”r
;

589 
i
.
chªÃl
 = 
šfo
->channel;

590 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_CHANNEL_INFO
, &
i
) < 0) {

591 
”r
 = -
”ºo
;

592 
	`SYSMSG
("SNDRV_PCM_IOCTL_CHANNEL_INFO faed (%i)", 
”r
);

593  
”r
;

595 
šfo
->
chªÃl
 = 
i
.channel;

596 
šfo
->
addr
 = 0;

597 
šfo
->
fœ¡
 = 
i
.first;

598 
šfo
->
¡•
 = 
i
.step;

599 
šfo
->
ty³
 = 
SND_PCM_AREA_MMAP
;

600 
šfo
->
u
.
mm­
.
fd
 = fd;

601 
šfo
->
u
.
mm­
.
off£t
 = 
i
.offset;

603 
	}
}

605 
	$¢d_pcm_hw_¡©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©us_t
 * 
¡©us
)

607 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

608 
fd
 = 
hw
->fd, 
”r
;

609 ià(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 13è> 
hw
->
v”siÚ
) {

610 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_STATUS
, 
¡©us
) < 0) {

611 
”r
 = -
”ºo
;

612 
	`SYSMSG
("SNDRV_PCM_IOCTL_STATUS faed (%i)", 
”r
);

613  
”r
;

616 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_STATUS_EXT
, 
¡©us
) < 0) {

617 
”r
 = -
”ºo
;

618 
	`SYSMSG
("SNDRV_PCM_IOCTL_STATUS_EXT faed (%i)", 
”r
);

619  
”r
;

622 ià(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 5è> 
hw
->
v”siÚ
) {

623 
¡©us
->
t¡amp
.
tv_n£c
 *= 1000L;

624 
¡©us
->
Œigg”_t¡amp
.
tv_n£c
 *= 1000L;

627 
	}
}

629 
¢d_pcm_¡©e_t
 
	$¢d_pcm_hw_¡©e
(
¢d_pcm_t
 *
pcm
)

631 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

634 ià(
	`qu”y_¡©us_d©a
(
hw
è=ğ-
ENODEV
)

635  
SND_PCM_STATE_DISCONNECTED
;

636  (
¢d_pcm_¡©e_t
è
hw
->
mm­_¡©us
->
¡©e
;

637 
	}
}

639 
	$¢d_pcm_hw_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
)

641 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

642 
fd
 = 
hw
->fd, 
”r
;

643 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_DELAY
, 
d–ayp
) < 0) {

644 
”r
 = -
”ºo
;

645 
	`SYSMSG
("SNDRV_PCM_IOCTL_DELAY faed (%i)", 
”r
);

646  
”r
;

649 
	}
}

651 
	$¢d_pcm_hw_hwsync
(
¢d_pcm_t
 *
pcm
)

653 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

654 
fd
 = 
hw
->fd, 
”r
;

655 ià(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 3è<ğ
hw
->
v”siÚ
) {

656 ià(
hw
->
mm­_¡©us_çÎbacked
) {

657 
”r
 = 
	`»que¡_hwsync
(
hw
);

658 ià(
”r
 < 0)

659  
”r
;

661 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_HWSYNC
) < 0) {

662 
”r
 = -
”ºo
;

663 
	`SYSMSG
("SNDRV_PCM_IOCTL_HWSYNC faed (%i)", 
”r
);

664  
”r
;

668 
¢d_pcm_säames_t
 
d–ay
;

669 
”r
 = 
	`¢d_pcm_hw_d–ay
(
pcm
, &
d–ay
);

670 ià(
”r
 < 0) {

671 
	`FAST_PCM_STATE
(
hw
)) {

672 
SND_PCM_STATE_PREPARED
:

673 
SND_PCM_STATE_SUSPENDED
:

676  
”r
;

681 
	}
}

683 
	$¢d_pcm_hw_´•¬e
(
¢d_pcm_t
 *
pcm
)

685 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

686 
¢d_pcm_sw_·¿ms_t
 
sw_·¿ms
;

687 
fd
 = 
hw
->fd, 
”r
;

689 ià(
hw
->
´•¬e_»£t_sw_·¿ms
) {

690 
	`¢d_pcm_sw_·¿ms_cu¼’t_no_lock
(
pcm
, &
sw_·¿ms
);

691 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_SW_PARAMS
, &
sw_·¿ms
) < 0) {

692 
”r
 = -
”ºo
;

693 
	`SYSMSG
("SNDRV_PCM_IOCTL_SW_PARAMS faed (%i)", 
”r
);

694  
”r
;

696 
hw
->
´•¬e_»£t_sw_·¿ms
 = 
çl£
;

698 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_PREPARE
) < 0) {

699 
”r
 = -
”ºo
;

700 
	`SYSMSG
("SNDRV_PCM_IOCTL_PREPARE faed (%i)", 
”r
);

701  
”r
;

703  
	`qu”y_¡©us_ªd_cÚŒŞ_d©a
(
hw
);

704 
	}
}

706 
	$¢d_pcm_hw_»£t
(
¢d_pcm_t
 *
pcm
)

708 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

709 
fd
 = 
hw
->fd, 
”r
;

710 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_RESET
) < 0) {

711 
”r
 = -
”ºo
;

712 
	`SYSMSG
("SNDRV_PCM_IOCTL_RESET faed (%i)", 
”r
);

713  
”r
;

715  
	`qu”y_¡©us_ªd_cÚŒŞ_d©a
(
hw
);

716 
	}
}

718 
	$¢d_pcm_hw_¡¬t
(
¢d_pcm_t
 *
pcm
)

720 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

721 
”r
;

723 
	`as£¹
(
pcm
->
¡»am
 !ğ
SND_PCM_STREAM_PLAYBACK
 ||

724 
	`¢d_pcm_mm­_¶ayback_hw_ava
(
pcm
) > 0);

726 
	`issue_­¶±r
(
hw
);

727 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_START
) < 0) {

728 
”r
 = -
”ºo
;

729 
	`SYSMSG
("SNDRV_PCM_IOCTL_START faed (%i)", 
”r
);

731 ià(
”r
 =ğ-
EBADFD
)

732 
	`SNDERR
("PCM s‹ = %s", 
	`¢d_pcm_¡©e_Çme
(
	`¢d_pcm_hw_¡©e
(
pcm
)));

734  
”r
;

737 
	}
}

739 
	$¢d_pcm_hw_drİ
(
¢d_pcm_t
 *
pcm
)

741 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

742 
”r
;

743 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_DROP
) < 0) {

744 
”r
 = -
”ºo
;

745 
	`SYSMSG
("SNDRV_PCM_IOCTL_DROP faed (%i)", 
”r
);

746  
”r
;

750 
	}
}

752 
	$¢d_pcm_hw_d¿š
(
¢d_pcm_t
 *
pcm
)

754 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

755 
¢d_pcm_sw_·¿ms_t
 
sw_·¿ms
;

756 
¢d_pcm_uäames_t
 
s’û_size
;

757 
”r
;

759 ià(
pcm
->
¡»am
 !ğ
SND_PCM_STREAM_PLAYBACK
)

760 
__sk_s’û
;

762 ià(
pcm
->
³riod_size
 == 0)

763 
__sk_s’û
;

764 ià(
hw
->
d¿š_s’û
 =ğ0 || hw->
³rãù_d¿š
)

765 
__sk_s’û
;

766 
	`¢d_pcm_sw_·¿ms_cu¼’t_no_lock
(
pcm
, &
sw_·¿ms
);

767 ià(
hw
->
d¿š_s’û
 > 0) {

768 
s’û_size
 = (
pcm
->
¿‹
 * 
hw
->
d¿š_s’û
) / 1000;

769 
__mªu®_s’û
;

772 ià((
pcm
->
bound¬y
 %…cm->
³riod_size
) == 0) {

773 
s’û_size
 = 
pcm
->
³riod_size
 - (*pcm->
­¶
.
±r
 %…cm->period_size);

774 ià(
s’û_size
 =ğ
pcm
->
³riod_size
)

775 
s’û_size
 = 0;

781 
s’û_size
 = 
pcm
->
³riod_size
;

783 
s’û_size
 +ğ
pcm
->
¿‹
 / 10;

784 
__mªu®_s’û
:

785 ià(
sw_·¿ms
.
s’û_size
 < silence_size) {

789 
sw_·¿ms
.
s’û_th»shŞd
 = 
pcm
->
bufãr_size
;

790 ià(
s’û_size
 > 
pcm
->
bufãr_size
)

791 
s’û_size
 = 
pcm
->
bufãr_size
;

792 
sw_·¿ms
.
s’û_size
 = silence_size;

793 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_SW_PARAMS
, &
sw_·¿ms
) < 0) {

794 
”r
 = -
”ºo
;

795 
	`SYSMSG
("SNDRV_PCM_IOCTL_SW_PARAMS faed (%i)", 
”r
);

796  
”r
;

798 
hw
->
´•¬e_»£t_sw_·¿ms
 = 
Œue
;

800 
__sk_s’û
:

801 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_DRAIN
) < 0) {

802 
”r
 = -
”ºo
;

803 
	`SYSMSG
("SNDRV_PCM_IOCTL_DRAIN faed (%i)", 
”r
);

804  
”r
;

807 
	}
}

809 
	$¢d_pcm_hw_·u£
(
¢d_pcm_t
 *
pcm
, 
’abË
)

811 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

812 
”r
;

813 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_PAUSE
, 
’abË
) < 0) {

814 
”r
 = -
”ºo
;

815 
	`SYSMSG
("SNDRV_PCM_IOCTL_PAUSE faed (%i)", 
”r
);

816  
”r
;

819 
	}
}

821 
¢d_pcm_säames_t
 
	$¢d_pcm_hw_»wšdabË
(
¢d_pcm_t
 *
pcm
)

823  
	`¢d_pcm_mm­_hw_»wšdabË
(
pcm
);

824 
	}
}

826 
¢d_pcm_säames_t
 
	$¢d_pcm_hw_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

828 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

829 
”r
;

830 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_REWIND
, &
äames
) < 0) {

831 
”r
 = -
”ºo
;

832 
	`SYSMSG
("SNDRV_PCM_IOCTL_REWIND faed (%i)", 
”r
);

833  
”r
;

835 
”r
 = 
	`qu”y_¡©us_ªd_cÚŒŞ_d©a
(
hw
);

836 ià(
”r
 < 0)

837  
”r
;

838  
äames
;

839 
	}
}

841 
¢d_pcm_säames_t
 
	$¢d_pcm_hw_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
)

843  
	`¢d_pcm_mm­_ava
(
pcm
);

844 
	}
}

846 
¢d_pcm_säames_t
 
	$¢d_pcm_hw_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

848 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

849 
”r
;

850 ià(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4è<ğ
hw
->
v”siÚ
) {

851 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_FORWARD
, &
äames
) < 0) {

852 
”r
 = -
”ºo
;

853 
	`SYSMSG
("SNDRV_PCM_IOCTL_FORWARD faed (%i)", 
”r
);

854  
”r
;

856 
”r
 = 
	`qu”y_¡©us_ªd_cÚŒŞ_d©a
(
hw
);

857 ià(
”r
 < 0)

858  
”r
;

859  
äames
;

861 
¢d_pcm_säames_t
 
ava
;

863 
	`FAST_PCM_STATE
(
hw
)) {

864 
SNDRV_PCM_STATE_RUNNING
:

865 
SNDRV_PCM_STATE_DRAINING
:

866 
SNDRV_PCM_STATE_PAUSED
:

867 
SNDRV_PCM_STATE_PREPARED
:

869 
SNDRV_PCM_STATE_XRUN
:

870  -
EPIPE
;

872  -
EBADFD
;

874 
ava
 = 
	`¢d_pcm_mm­_ava
(
pcm
);

875 ià(
ava
 < 0)

877 ià(
äames
 > (
¢d_pcm_uäames_t
)
ava
)

878 
äames
 = 
ava
;

879 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
äames
);

880  
äames
;

882 
	}
}

884 
	$¢d_pcm_hw_»sume
(
¢d_pcm_t
 *
pcm
)

886 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

887 
fd
 = 
hw
->fd, 
”r
;

888 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_RESUME
) < 0) {

889 
”r
 = -
”ºo
;

890 
	`SYSMSG
("SNDRV_PCM_IOCTL_RESUME faed (%i)", 
”r
);

891  
”r
;

894 
	}
}

896 
	$hw_lšk
(
¢d_pcm_t
 *
pcm1
, snd_pcm_ˆ*
pcm2
)

898 
¢d_pcm_hw_t
 *
hw1
 = 
pcm1
->
´iv©e_d©a
;

899 
¢d_pcm_hw_t
 *
hw2
 = 
pcm2
->
´iv©e_d©a
;

900 ià(
	`ioùl
(
hw1
->
fd
, 
SNDRV_PCM_IOCTL_LINK
, 
hw2
->fd) < 0) {

901 
	`SYSMSG
("SNDRV_PCM_IOCTL_LINK faed (%i)", -
”ºo
);

902  -
”ºo
;

905 
	}
}

907 
	$¢d_pcm_hw_lšk_¦aves
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ*
ma¡”
)

909 ià(
ma¡”
->
ty³
 !ğ
SND_PCM_TYPE_HW
) {

910 
	`SYSMSG
("Inv®idy³ fÜ SNDRV_PCM_IOCTL_LINK (%i)", 
ma¡”
->
ty³
);

911  -
EINVAL
;

913  
	`hw_lšk
(
ma¡”
, 
pcm
);

914 
	}
}

916 
	$¢d_pcm_hw_lšk
(
¢d_pcm_t
 *
pcm1
, snd_pcm_ˆ*
pcm2
)

918 ià(
pcm2
->
ty³
 !ğ
SND_PCM_TYPE_HW
) {

919 ià(
pcm2
->
ç¡_İs
->
lšk_¦aves
)

920  
pcm2
->
ç¡_İs
->
	`lšk_¦aves
Õcm2->
ç¡_İ_¬g
, 
pcm1
);

921  -
ENOSYS
;

923  
	`hw_lšk
(
pcm1
, 
pcm2
);

924 
	}
}

926 
	$¢d_pcm_hw_uÆšk
(
¢d_pcm_t
 *
pcm
)

928 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

930 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_UNLINK
) < 0) {

931 
	`SYSMSG
("SNDRV_PCM_IOCTL_UNLINK faed (%i)", -
”ºo
);

932  -
”ºo
;

935 
	}
}

937 
¢d_pcm_säames_t
 
	$¢d_pcm_hw_wr™ei
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

939 
”r
;

940 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

941 
fd
 = 
hw
->fd;

942 
¢d_xãri
 
xãri
;

943 
xãri
.
buf
 = (*è
bufãr
;

944 
xãri
.
äames
 = 
size
;

945 
xãri
.
»suÉ
 = 0;

946 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_WRITEI_FRAMES
, &
xãri
) < 0)

947 
”r
 = -
”ºo
;

949 
”r
 = 
	`qu”y_¡©us_ªd_cÚŒŞ_d©a
(
hw
);

950 #ifdeà
DEBUG_RW


951 
	`årštf
(
¡d”r
, "hw_wr™ei: f¿me ğ%li, xãri.»suÉ = %li,ƒ¼ = %i\n", 
size
, 
xãri
.
»suÉ
, 
”r
);

953 ià(
”r
 < 0)

954  
	`¢d_pcm_check_”rÜ
(
pcm
, 
”r
);

955  
xãri
.
»suÉ
;

956 
	}
}

958 
¢d_pcm_säames_t
 
	$¢d_pcm_hw_wr™’
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

960 
”r
;

961 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

962 
fd
 = 
hw
->fd;

963 
¢d_xãº
 
xãº
;

964 
	`mem£t
(&
xãº
, 0, (xfern));

965 
xãº
.
bufs
 = bufs;

966 
xãº
.
äames
 = 
size
;

967 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_WRITEN_FRAMES
, &
xãº
) < 0)

968 
”r
 = -
”ºo
;

970 
”r
 = 
	`qu”y_¡©us_ªd_cÚŒŞ_d©a
(
hw
);

971 #ifdeà
DEBUG_RW


972 
	`årštf
(
¡d”r
, "hw_wr™’: f¿me ğ%li,„esuÉ = %li,ƒ¼ = %i\n", 
size
, 
xãº
.
»suÉ
, 
”r
);

974 ià(
”r
 < 0)

975  
	`¢d_pcm_check_”rÜ
(
pcm
, 
”r
);

976  
xãº
.
»suÉ
;

977 
	}
}

979 
¢d_pcm_säames_t
 
	$¢d_pcm_hw_»adi
(
¢d_pcm_t
 *
pcm
, *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

981 
”r
;

982 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

983 
fd
 = 
hw
->fd;

984 
¢d_xãri
 
xãri
;

985 
xãri
.
buf
 = 
bufãr
;

986 
xãri
.
äames
 = 
size
;

987 
xãri
.
»suÉ
 = 0;

988 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_READI_FRAMES
, &
xãri
) < 0)

989 
”r
 = -
”ºo
;

991 
”r
 = 
	`qu”y_¡©us_ªd_cÚŒŞ_d©a
(
hw
);

992 #ifdeà
DEBUG_RW


993 
	`årštf
(
¡d”r
, "hw_»adi: f¿me ğ%li,„esuÉ = %li,ƒ¼ = %i\n", 
size
, 
xãri
.
»suÉ
, 
”r
);

995 ià(
”r
 < 0)

996  
	`¢d_pcm_check_”rÜ
(
pcm
, 
”r
);

997  
xãri
.
»suÉ
;

998 
	}
}

1000 
¢d_pcm_säames_t
 
	$¢d_pcm_hw_»adn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

1002 
”r
;

1003 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

1004 
fd
 = 
hw
->fd;

1005 
¢d_xãº
 
xãº
;

1006 
	`mem£t
(&
xãº
, 0, (xfern));

1007 
xãº
.
bufs
 = bufs;

1008 
xãº
.
äames
 = 
size
;

1009 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_READN_FRAMES
, &
xãº
) < 0)

1010 
”r
 = -
”ºo
;

1012 
”r
 = 
	`qu”y_¡©us_ªd_cÚŒŞ_d©a
(
hw
);

1013 #ifdeà
DEBUG_RW


1014 
	`årštf
(
¡d”r
, "hw_»adn: f¿me ğ%li,„esuÉ = %li,ƒ¼ = %i\n", 
size
, 
xãº
.
»suÉ
, 
”r
);

1016 ià(
”r
 < 0)

1017  
	`¢d_pcm_check_”rÜ
(
pcm
, 
”r
);

1018  
xãº
.
»suÉ
;

1019 
	}
}

1021 
boŞ
 
	$m­_¡©us_d©a
(
¢d_pcm_hw_t
 *
hw
, 
¢d_pcm_sync_±r
 *
sync_±r
,

1022 
boŞ
 
fÜû_çÎback
)

1024 
¢d_pcm_mm­_¡©us
 *
mm­_¡©us
;

1025 
boŞ
 
çÎbacked
;

1027 
mm­_¡©us
 = 
MAP_FAILED
;

1028 ià(!
fÜû_çÎback
) {

1029 
mm­_¡©us
 = 
	`mm­
(
NULL
, 
	`·ge_®ign
((*mmap_status)),

1030 
PROT_READ
, 
MAP_FILE
|
MAP_SHARED
,

1031 
hw
->
fd
, 
SNDRV_PCM_MMAP_OFFSET_STATUS
);

1034 ià(
mm­_¡©us
 =ğ
MAP_FAILED
 || mm­_¡©u =ğ
NULL
) {

1035 
mm­_¡©us
 = &
sync_±r
->
s
.
¡©us
;

1036 
çÎbacked
 = 
Œue
;

1038 
çÎbacked
 = 
çl£
;

1041 
hw
->
mm­_¡©us
 = mmap_status;

1043  
çÎbacked
;

1044 
	}
}

1046 
boŞ
 
	$m­_cÚŒŞ_d©a
(
¢d_pcm_hw_t
 *
hw
,

1047 
¢d_pcm_sync_±r
 *
sync_±r
,

1048 
boŞ
 
fÜû_çÎback
)

1050 
¢d_pcm_mm­_cÚŒŞ
 *
mm­_cÚŒŞ
;

1051 
boŞ
 
çÎbacked
;

1053 
mm­_cÚŒŞ
 = 
MAP_FAILED
;

1054 ià(!
fÜû_çÎback
) {

1055 
mm­_cÚŒŞ
 = 
	`mm­
(
NULL
, 
	`·ge_®ign
((*mmap_control)),

1056 
PROT_READ
|
PROT_WRITE
, 
MAP_FILE
|
MAP_SHARED
,

1057 
hw
->
fd
, 
SNDRV_PCM_MMAP_OFFSET_CONTROL
);

1060 ià(
mm­_cÚŒŞ
 =ğ
MAP_FAILED
 || mm­_cÚŒŞ =ğ
NULL
) {

1061 
mm­_cÚŒŞ
 = &
sync_±r
->
c
.
cÚŒŞ
;

1062 
çÎbacked
 = 
Œue
;

1064 
çÎbacked
 = 
çl£
;

1067 
hw
->
mm­_cÚŒŞ
 = mmap_control;

1069  
çÎbacked
;

1070 
	}
}

1072 
	$m­_¡©us_ªd_cÚŒŞ_d©a
(
¢d_pcm_t
 *
pcm
, 
boŞ
 
fÜû_çÎback
)

1074 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

1075 
¢d_pcm_sync_±r
 *
sync_±r
;

1076 
”r
;

1079 
sync_±r
 = 
	`m®loc
((*sync_ptr));

1080 ià(
sync_±r
 =ğ
NULL
)

1081  -
ENOMEM
;

1082 
	`mem£t
(
sync_±r
, 0, (*sync_ptr));

1084 
hw
->
mm­_¡©us_çÎbacked
 =

1085 
	`m­_¡©us_d©a
(
hw
, 
sync_±r
, 
fÜû_çÎback
);

1086 
hw
->
mm­_cÚŒŞ_çÎbacked
 =

1087 
	`m­_cÚŒŞ_d©a
(
hw
, 
sync_±r
, 
fÜû_çÎback
);

1090 ià(
hw
->
mm­_¡©us_çÎbacked
 || hw->
mm­_cÚŒŞ_çÎbacked
) {

1091 
hw
->
sync_±r
 = sync_ptr;

1093 
	`ä“
(
sync_±r
);

1094 
hw
->
sync_±r
 = 
NULL
;

1100 ià(!(
pcm
->
mode
 & 
SND_PCM_APPEND
)) {

1102 
hw
->
mm­_cÚŒŞ
->
­¶_±r
 = 0;

1103 
hw
->
mm­_cÚŒŞ
->
ava_mš
 = 1;

1105 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
hw
->
mm­_¡©us
->
hw_±r
, hw->
fd
,

1106 
SNDRV_PCM_MMAP_OFFSET_STATUS
 +

1107 
	`off£tof
(
¢d_pcm_mm­_¡©us
, 
hw_±r
));

1108 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
hw
->
mm­_cÚŒŞ
->
­¶_±r
, hw->
fd
,

1109 
SNDRV_PCM_MMAP_OFFSET_CONTROL
);

1110 ià(
hw
->
mm­_cÚŒŞ_çÎbacked
) {

1111 
æags
 = 0;

1115 ià(
pcm
->
mode
 & 
SND_PCM_APPEND
)

1116 
æags
 = 
SNDRV_PCM_SYNC_PTR_APPL
 |

1117 
SNDRV_PCM_SYNC_PTR_AVAIL_MIN
;

1118 
”r
 = 
	`sync_±r1
(
hw
, 
æags
);

1119 ià(
”r
 < 0)

1120  
”r
;

1124 
	}
}

1126 
	$unm­_¡©us_d©a
(
¢d_pcm_hw_t
 *
hw
)

1128 ià(!
hw
->
mm­_¡©us_çÎbacked
) {

1129 ià(
	`munm­
((*)
hw
->
mm­_¡©us
,

1130 
	`·ge_®ign
((*
hw
->
mm­_¡©us
))) < 0)

1131 
	`SYSMSG
("¡©u munm­ faed (%u)", 
”ºo
);

1133 
	}
}

1135 
	$unm­_cÚŒŞ_d©a
(
¢d_pcm_hw_t
 *
hw
)

1137 ià(!
hw
->
mm­_cÚŒŞ_çÎbacked
) {

1138 ià(
	`munm­
((*)
hw
->
mm­_cÚŒŞ
,

1139 
	`·ge_®ign
((*
hw
->
mm­_cÚŒŞ
))) < 0)

1140 
	`SYSMSG
("cÚŒŞ munm­ faed (%u)", 
”ºo
);

1142 
	}
}

1144 
	$unm­_¡©us_ªd_cÚŒŞ_d©a
(
¢d_pcm_hw_t
 *
hw
)

1146 
	`unm­_¡©us_d©a
(
hw
);

1147 
	`unm­_cÚŒŞ_d©a
(
hw
);

1149 ià(
hw
->
mm­_¡©us_çÎbacked
 || hw->
mm­_cÚŒŞ_çÎbacked
)

1150 
	`ä“
(
hw
->
sync_±r
);

1152 
hw
->
mm­_¡©us
 = 
NULL
;

1153 
hw
->
mm­_cÚŒŞ
 = 
NULL
;

1154 
hw
->
mm­_¡©us_çÎbacked
 = 
çl£
;

1155 
hw
->
mm­_cÚŒŞ_çÎbacked
 = 
çl£
;

1156 
hw
->
sync_±r
 = 
NULL
;

1157 
	}
}

1159 
	$¢d_pcm_hw_mm­
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1162 
	}
}

1164 
	$¢d_pcm_hw_munm­
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1167 
	}
}

1169 
	$¢d_pcm_hw_şo£
(
¢d_pcm_t
 *
pcm
)

1171 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

1172 
”r
 = 0;

1173 ià(
	`şo£
(
hw
->
fd
)) {

1174 
”r
 = -
”ºo
;

1175 
	`SYSMSG
("şo£ faed (%i)", 
”r
);

1178 
	`unm­_¡©us_ªd_cÚŒŞ_d©a
(
hw
);

1180 
	`ä“
(
hw
);

1181  
”r
;

1182 
	}
}

1184 
¢d_pcm_säames_t
 
	$¢d_pcm_hw_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

1185 
¢d_pcm_uäames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

1186 
¢d_pcm_uäames_t
 
size
)

1188 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

1190 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
size
);

1191 
	`issue_­¶±r
(
hw
);

1192 #ifdeà
DEBUG_MMAP


1193 
	`årštf
(
¡d”r
, "­¶_fÜw¬d: hw_±¸ğ%li,‡µl_±¸ğ%li, sizğ%li\n", *
pcm
->
hw
.
±r
, *pcm->
­¶
.±r, 
size
);

1195  
size
;

1196 
	}
}

1198 
¢d_pcm_säames_t
 
	$¢d_pcm_hw_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

1200 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

1201 
¢d_pcm_uäames_t
 
ava
;

1203 
	`qu”y_¡©us_d©a
(
hw
);

1204 
ava
 = 
	`¢d_pcm_mm­_ava
(
pcm
);

1205 
	`FAST_PCM_STATE
(
hw
)) {

1206 
SNDRV_PCM_STATE_RUNNING
:

1207 ià(
ava
 >ğ
pcm
->
¡İ_th»shŞd
) {

1209 ià(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 1è<ğ
hw
->
v”siÚ
) {

1210 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_XRUN
) < 0)

1211  -
”ºo
;

1214  -
EPIPE
;

1217 
SNDRV_PCM_STATE_XRUN
:

1218  -
EPIPE
;

1222  
ava
;

1223 
	}
}

1225 
	$¢d_pcm_hw_htime¡amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 *
ava
,

1226 
¢d_htime¡amp_t
 *
t¡amp
)

1228 
¢d_pcm_säames_t
 
ava1
;

1229 
ok
 = 0;

1233 
ava1
 = 
	`¢d_pcm_hw_ava_upd©e
(
pcm
);

1234 ià(
ava1
 < 0)

1235  
ava1
;

1236 ià(
ok
 && (
¢d_pcm_uäames_t
)
ava1
 =ğ*
ava
)

1238 *
ava
 = 
ava1
;

1239 *
t¡amp
 = 
	`¢d_pcm_hw_ç¡_t¡amp
(
pcm
);

1240 
ok
 = 1;

1243 
	}
}

1245 
	$__fl_chm­_ùl_id
(
¢d_ùl_–em_id_t
 *
id
, 
dev
, 
subdev
,

1246 
¡»am
)

1248 
	`¢d_ùl_–em_id_£t_š‹rçû
(
id
, 
SND_CTL_ELEM_IFACE_PCM
);

1249 ià(
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

1250 
	`¢d_ùl_–em_id_£t_Çme
(
id
, "Playback Channel Map");

1252 
	`¢d_ùl_–em_id_£t_Çme
(
id
, "Capture Channel Map");

1253 
	`¢d_ùl_–em_id_£t_deviû
(
id
, 
dev
);

1254 
	`¢d_ùl_–em_id_£t_šdex
(
id
, 
subdev
);

1255 
	}
}

1257 
	$fl_chm­_ùl_id
(
¢d_pcm_t
 *
pcm
, 
¢d_ùl_–em_id_t
 *
id
)

1259 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

1260 
	`__fl_chm­_ùl_id
(
id
, 
hw
->
deviû
, hw->
subdeviû
, 
pcm
->
¡»am
);

1261 
	}
}

1263 
	$is_chm­_ty³
(
ty³
)

1265  (
ty³
 >ğ
SND_CTL_TLVT_CHMAP_FIXED
 &&

1266 
ty³
 <ğ
SND_CTL_TLVT_CHMAP_PAIRED
);

1267 
	}
}

1285 
¢d_pcm_chm­_qu”y_t
 **

1286 
	$¢d_pcm_qu”y_chm­s_äom_hw
(
ÿrd
, 
dev
, 
subdev
,

1287 
¢d_pcm_¡»am_t
 
¡»am
)

1289 
¢d_ùl_t
 *
ùl
;

1290 
¢d_ùl_–em_id_t
 
id
 = {0};

1291 
v
[2048], *
¡¬t
;

1292 
ty³
;

1293 
¢d_pcm_chm­_qu”y_t
 **
m­
;

1294 
i
, 
»t
, 
nums
;

1296 
»t
 = 
	`¢d_ùl_hw_İ’
(&
ùl
, 
NULL
, 
ÿrd
, 0);

1297 ià(
»t
 < 0) {

1298 
	`SYSMSG
("Cannot openhe‡ssociated CTL");

1299  
NULL
;

1302 
	`__fl_chm­_ùl_id
(&
id
, 
dev
, 
subdev
, 
¡»am
);

1303 
»t
 = 
	`¢d_ùl_–em_v_»ad
(
ùl
, &
id
, 
v
, (tlv));

1304 
	`¢d_ùl_şo£
(
ùl
);

1305 ià(
»t
 < 0) {

1306 
	`SYSMSG
("Cannot„ead Channel Map TLV");

1307  
NULL
;

1311 
i
 = 0; i < 32; i++)

1312 
	`årštf
(
¡d”r
, "%02x: %08x\n", 
i
, 
v
[i]);

1317 
ty³
 = 
v
[
SNDRV_CTL_TLVO_TYPE
];

1318 ià(
ty³
 !ğ
SND_CTL_TLVT_CONTAINER
) {

1319 ià(!
	`is_chm­_ty³
(
ty³
)) {

1320 
	`SYSMSG
("Inv®id TLVy³ %d", 
ty³
);

1321  
NULL
;

1323 
¡¬t
 = 
v
;

1324 
nums
 = 1;

1326 *
p
;

1327 
size
;

1328 
¡¬t
 = 
v
 + 2;

1329 
size
 = 
v
[
SNDRV_CTL_TLVO_LEN
];

1330 
nums
 = 0;

1331 
p
 = 
¡¬t
; 
size
 > 0; ) {

1332 ià(!
	`is_chm­_ty³
(
p
[0])) {

1333 
	`SYSMSG
("Inv®id TLVy³ %d", 
p
[0]);

1334  
NULL
;

1336 
nums
++;

1337 
size
 -ğ
p
[1] + 8;

1338 
p
 +=…[1] / 4 + 2;

1341 
m­
 = 
	`ÿÎoc
(
nums
 + 1, (*));

1342 ià(!
m­
)

1343  
NULL
;

1344 
i
 = 0; i < 
nums
; i++) {

1345 
m­
[
i
] = 
	`m®loc
(
¡¬t
[1] + 8);

1346 ià(!
m­
[
i
]) {

1347 
	`¢d_pcm_ä“_chm­s
(
m­
);

1348  
NULL
;

1350 
m­
[
i
]->
ty³
 = 
¡¬t
[0] - 0x100;

1351 
m­
[
i
]->m­.
chªÃls
 = 
¡¬t
[1] / 4;

1352 
	`memıy
(
m­
[
i
]->m­.
pos
, 
¡¬t
 + 2, start[1]);

1353 
¡¬t
 += start[1] / 4 + 2;

1355  
m­
;

1356 
	}
}

1358 ’um { 
	mCHMAP_CTL_QUERY
, 
	mCHMAP_CTL_GET
, 
	mCHMAP_CTL_SET
 };

1360 
	$chm­_ÿps
(
¢d_pcm_hw_t
 *
hw
, 
ty³
)

1362 ià(
hw
->
chm­_ÿps
 & (1 << 
ty³
))

1364 ià(
hw
->
chm­_ÿps
 & (1 << (
ty³
 + 8)))

1367 
	}
}

1369 
	$chm­_ÿps_£t_ok
(
¢d_pcm_hw_t
 *
hw
, 
ty³
)

1371 
hw
->
chm­_ÿps
 |ğ(1 << 
ty³
);

1372 
	}
}

1374 
	$chm­_ÿps_£t_”rÜ
(
¢d_pcm_hw_t
 *
hw
, 
ty³
)

1376 
hw
->
chm­_ÿps
 |ğ(1 << (
ty³
 + 8));

1377 
	}
}

1379 
¢d_pcm_chm­_qu”y_t
 **
	$¢d_pcm_hw_qu”y_chm­s
(
¢d_pcm_t
 *
pcm
)

1381 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

1382 
¢d_pcm_chm­_qu”y_t
 **
m­
;

1384 ià(
hw
->
chm­_ov”ride
)

1385  
	`_¢d_pcm_cİy_chm­_qu”y
(
hw
->
chm­_ov”ride
);

1387 ià(!
	`chm­_ÿps
(
hw
, 
CHMAP_CTL_QUERY
))

1388  
NULL
;

1390 
m­
 = 
	`¢d_pcm_qu”y_chm­s_äom_hw
(
hw
->
ÿrd
, hw->
deviû
,

1391 
hw
->
subdeviû
, 
pcm
->
¡»am
);

1392 ià(
m­
)

1393 
	`chm­_ÿps_£t_ok
(
hw
, 
CHMAP_CTL_QUERY
);

1395 
	`chm­_ÿps_£t_”rÜ
(
hw
, 
CHMAP_CTL_QUERY
);

1396  
m­
;

1397 
	}
}

1399 
¢d_pcm_chm­_t
 *
	$¢d_pcm_hw_g‘_chm­
(
¢d_pcm_t
 *
pcm
)

1401 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

1402 
¢d_pcm_chm­_t
 *
m­
;

1403 
¢d_ùl_t
 *
ùl
;

1404 
¢d_ùl_–em_id_t
 
id
 = {0};

1405 
¢d_ùl_–em_v®ue_t
 
v®
 = {0};

1406 
i
;

1407 
»t
;

1409 ià(
hw
->
chm­_ov”ride
)

1410  
	`_¢d_pcm_choo£_fixed_chm­
(
pcm
, 
hw
->
chm­_ov”ride
);

1412 ià(!
	`chm­_ÿps
(
hw
, 
CHMAP_CTL_GET
))

1413  
NULL
;

1415 
	`FAST_PCM_STATE
(
hw
)) {

1416 
SNDRV_PCM_STATE_PREPARED
:

1417 
SNDRV_PCM_STATE_RUNNING
:

1418 
SNDRV_PCM_STATE_XRUN
:

1419 
SNDRV_PCM_STATE_DRAINING
:

1420 
SNDRV_PCM_STATE_PAUSED
:

1421 
SNDRV_PCM_STATE_SUSPENDED
:

1424 
	`SYSMSG
("Invalid PCM state for chmap_get: %s",

1425 
	`¢d_pcm_¡©e_Çme
(
	`FAST_PCM_STATE
(
hw
)));

1426  
NULL
;

1428 
m­
 = 
	`m®loc
(
pcm
->
chªÃls
 * (m­->
pos
[0]) + (*map));

1429 ià(!
m­
)

1430  
NULL
;

1431 
m­
->
chªÃls
 = 
pcm
->channels;

1432 
»t
 = 
	`¢d_ùl_hw_İ’
(&
ùl
, 
NULL
, 
hw
->
ÿrd
, 0);

1433 ià(
»t
 < 0) {

1434 
	`ä“
(
m­
);

1435 
	`SYSMSG
("Cannot openhe‡ssociated CTL");

1436 
	`chm­_ÿps_£t_”rÜ
(
hw
, 
CHMAP_CTL_GET
);

1437  
NULL
;

1439 
	`fl_chm­_ùl_id
(
pcm
, &
id
);

1440 
	`¢d_ùl_–em_v®ue_£t_id
(&
v®
, &
id
);

1441 
»t
 = 
	`¢d_ùl_–em_»ad
(
ùl
, &
v®
);

1442 
	`¢d_ùl_şo£
(
ùl
);

1443 ià(
»t
 < 0) {

1444 
	`ä“
(
m­
);

1445 
	`SYSMSG
("Cannot„ead Channel Map ctl");

1446 
	`chm­_ÿps_£t_”rÜ
(
hw
, 
CHMAP_CTL_GET
);

1447  
NULL
;

1449 
i
 = 0; i < 
pcm
->
chªÃls
; i++)

1450 
m­
->
pos
[
i
] = 
	`¢d_ùl_–em_v®ue_g‘_š‹g”
(&
v®
, i);

1451 
	`chm­_ÿps_£t_ok
(
hw
, 
CHMAP_CTL_GET
);

1452  
m­
;

1453 
	}
}

1455 
	$¢d_pcm_hw_£t_chm­
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chm­_t
 *
m­
)

1457 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

1458 
¢d_ùl_t
 *
ùl
;

1459 
¢d_ùl_–em_id_t
 
id
 = {0};

1460 
¢d_ùl_–em_v®ue_t
 
v®
 = {0};

1461 
i
;

1462 
»t
;

1464 ià(
hw
->
chm­_ov”ride
)

1465  -
ENXIO
;

1467 ià(!
	`chm­_ÿps
(
hw
, 
CHMAP_CTL_SET
))

1468  -
ENXIO
;

1470 ià(
m­
->
chªÃls
 > 128) {

1471 
	`SYSMSG
("Inv®id‚umb” oàchªÃl %d", 
m­
->
chªÃls
);

1472  -
EINVAL
;

1474 ià(
	`FAST_PCM_STATE
(
hw
è!ğ
SNDRV_PCM_STATE_PREPARED
) {

1475 
	`SYSMSG
("Invalid PCM state for chmap_set: %s",

1476 
	`¢d_pcm_¡©e_Çme
(
	`FAST_PCM_STATE
(
hw
)));

1477  -
EBADFD
;

1479 
»t
 = 
	`¢d_ùl_hw_İ’
(&
ùl
, 
NULL
, 
hw
->
ÿrd
, 0);

1480 ià(
»t
 < 0) {

1481 
	`SYSMSG
("Cannot openhe‡ssociated CTL");

1482 
	`chm­_ÿps_£t_”rÜ
(
hw
, 
CHMAP_CTL_SET
);

1483  
»t
;

1486 
	`fl_chm­_ùl_id
(
pcm
, &
id
);

1487 
	`¢d_ùl_–em_v®ue_£t_id
(&
v®
, &
id
);

1488 
i
 = 0; i < 
m­
->
chªÃls
; i++)

1489 
	`¢d_ùl_–em_v®ue_£t_š‹g”
(&
v®
, 
i
, 
m­
->
pos
[i]);

1490 
»t
 = 
	`¢d_ùl_–em_wr™e
(
ùl
, &
v®
);

1491 
	`¢d_ùl_şo£
(
ùl
);

1492 ià(
»t
 >= 0)

1493 
	`chm­_ÿps_£t_ok
(
hw
, 
CHMAP_CTL_SET
);

1494 ià(
»t
 =ğ-
ENOENT
 ||„‘ =ğ-
EPERM
 ||„‘ =ğ-
ENXIO
) {

1495 
	`chm­_ÿps_£t_”rÜ
(
hw
, 
CHMAP_CTL_SET
);

1496 
»t
 = -
ENXIO
;

1498 ià(
»t
 < 0)

1499 
	`SYSMSG
("Cannot write Channel Map ctl");

1500  
»t
;

1501 
	}
}

1503 
	$¢d_pcm_hw_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

1505 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
´iv©e_d©a
;

1506 *
Çme
;

1507 
”r
 = 
	`¢d_ÿrd_g‘_Çme
(
hw
->
ÿrd
, &
Çme
);

1508 ià(
”r
 < 0) {

1509 
	`SNDERR
("cannot get card‚ame");

1512 
	`¢d_ouut_´štf
(
out
, "Hardware PCM card %d '%s' device %d subdevice %d\n",

1513 
hw
->
ÿrd
, 
Çme
, hw->
deviû
, hw->
subdeviû
);

1514 
	`ä“
(
Çme
);

1515 ià(
pcm
->
£tup
) {

1516 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

1517 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

1518 
	`¢d_ouut_´štf
(
out
, "‡µl_±¸ : %li\n", 
hw
->
mm­_cÚŒŞ
->
­¶_±r
);

1519 
	`¢d_ouut_´štf
(
out
, " hw_±¸ : %li\n", 
hw
->
mm­_¡©us
->
hw_±r
);

1521 
	}
}

1523 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_hw_İs
 = {

1524 .
şo£
 = 
¢d_pcm_hw_şo£
,

1525 .
	gšfo
 = 
¢d_pcm_hw_šfo
,

1526 .
	ghw_»fše
 = 
¢d_pcm_hw_hw_»fše
,

1527 .
	ghw_·¿ms
 = 
¢d_pcm_hw_hw_·¿ms
,

1528 .
	ghw_ä“
 = 
¢d_pcm_hw_hw_ä“
,

1529 .
	gsw_·¿ms
 = 
¢d_pcm_hw_sw_·¿ms
,

1530 .
	gchªÃl_šfo
 = 
¢d_pcm_hw_chªÃl_šfo
,

1531 .
	gdump
 = 
¢d_pcm_hw_dump
,

1532 .
	gnÚblock
 = 
¢d_pcm_hw_nÚblock
,

1533 .
	gasync
 = 
¢d_pcm_hw_async
,

1534 .
	gmm­
 = 
¢d_pcm_hw_mm­
,

1535 .
	gmunm­
 = 
¢d_pcm_hw_munm­
,

1536 .
	gqu”y_chm­s
 = 
¢d_pcm_hw_qu”y_chm­s
,

1537 .
	gg‘_chm­
 = 
¢d_pcm_hw_g‘_chm­
,

1538 .
	g£t_chm­
 = 
¢d_pcm_hw_£t_chm­
,

1541 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_hw_ç¡_İs
 = {

1542 .
¡©us
 = 
¢d_pcm_hw_¡©us
,

1543 .
	g¡©e
 = 
¢d_pcm_hw_¡©e
,

1544 .
	ghwsync
 = 
¢d_pcm_hw_hwsync
,

1545 .
	gd–ay
 = 
¢d_pcm_hw_d–ay
,

1546 .
	g´•¬e
 = 
¢d_pcm_hw_´•¬e
,

1547 .
	g»£t
 = 
¢d_pcm_hw_»£t
,

1548 .
	g¡¬t
 = 
¢d_pcm_hw_¡¬t
,

1549 .
	gdrİ
 = 
¢d_pcm_hw_drİ
,

1550 .
	gd¿š
 = 
¢d_pcm_hw_d¿š
,

1551 .
	g·u£
 = 
¢d_pcm_hw_·u£
,

1552 .
	g»wšdabË
 = 
¢d_pcm_hw_»wšdabË
,

1553 .
	g»wšd
 = 
¢d_pcm_hw_»wšd
,

1554 .
	gfÜw¬dabË
 = 
¢d_pcm_hw_fÜw¬dabË
,

1555 .
	gfÜw¬d
 = 
¢d_pcm_hw_fÜw¬d
,

1556 .
	g»sume
 = 
¢d_pcm_hw_»sume
,

1557 .
	glšk
 = 
¢d_pcm_hw_lšk
,

1558 .
	glšk_¦aves
 = 
¢d_pcm_hw_lšk_¦aves
,

1559 .
	guÆšk
 = 
¢d_pcm_hw_uÆšk
,

1560 .
	gwr™ei
 = 
¢d_pcm_hw_wr™ei
,

1561 .
	gwr™’
 = 
¢d_pcm_hw_wr™’
,

1562 .
	g»adi
 = 
¢d_pcm_hw_»adi
,

1563 .
	g»adn
 = 
¢d_pcm_hw_»adn
,

1564 .
	gava_upd©e
 = 
¢d_pcm_hw_ava_upd©e
,

1565 .
	gmm­_comm™
 = 
¢d_pcm_hw_mm­_comm™
,

1566 .
	ghtime¡amp
 = 
¢d_pcm_hw_htime¡amp
,

1567 .
	gpŞl_desütÜs
 = 
NULL
,

1568 .
	gpŞl_desütÜs_couÁ
 = 
NULL
,

1569 .
	gpŞl_»v’ts
 = 
NULL
,

1572 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_hw_ç¡_İs_tim”
 = {

1573 .
¡©us
 = 
¢d_pcm_hw_¡©us
,

1574 .
	g¡©e
 = 
¢d_pcm_hw_¡©e
,

1575 .
	ghwsync
 = 
¢d_pcm_hw_hwsync
,

1576 .
	gd–ay
 = 
¢d_pcm_hw_d–ay
,

1577 .
	g´•¬e
 = 
¢d_pcm_hw_´•¬e
,

1578 .
	g»£t
 = 
¢d_pcm_hw_»£t
,

1579 .
	g¡¬t
 = 
¢d_pcm_hw_¡¬t
,

1580 .
	gdrİ
 = 
¢d_pcm_hw_drİ
,

1581 .
	gd¿š
 = 
¢d_pcm_hw_d¿š
,

1582 .
	g·u£
 = 
¢d_pcm_hw_·u£
,

1583 .
	g»wšdabË
 = 
¢d_pcm_hw_»wšdabË
,

1584 .
	g»wšd
 = 
¢d_pcm_hw_»wšd
,

1585 .
	gfÜw¬dabË
 = 
¢d_pcm_hw_fÜw¬dabË
,

1586 .
	gfÜw¬d
 = 
¢d_pcm_hw_fÜw¬d
,

1587 .
	g»sume
 = 
¢d_pcm_hw_»sume
,

1588 .
	glšk
 = 
¢d_pcm_hw_lšk
,

1589 .
	glšk_¦aves
 = 
¢d_pcm_hw_lšk_¦aves
,

1590 .
	guÆšk
 = 
¢d_pcm_hw_uÆšk
,

1591 .
	gwr™ei
 = 
¢d_pcm_hw_wr™ei
,

1592 .
	gwr™’
 = 
¢d_pcm_hw_wr™’
,

1593 .
	g»adi
 = 
¢d_pcm_hw_»adi
,

1594 .
	g»adn
 = 
¢d_pcm_hw_»adn
,

1595 .
	gava_upd©e
 = 
¢d_pcm_hw_ava_upd©e
,

1596 .
	gmm­_comm™
 = 
¢d_pcm_hw_mm­_comm™
,

1597 .
	ghtime¡amp
 = 
¢d_pcm_hw_htime¡amp
,

1598 .
	gpŞl_desütÜs
 = 
¢d_pcm_hw_pŞl_desütÜs
,

1599 .
	gpŞl_desütÜs_couÁ
 = 
¢d_pcm_hw_pŞl_desütÜs_couÁ
,

1600 .
	gpŞl_»v’ts
 = 
¢d_pcm_hw_pŞl_»v’ts
,

1614 
	$¢d_pcm_hw_İ’_fd
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
, 
fd
,

1615 
sync_±r_ioùl
)

1617 
v”
, 
mode
;

1618 
¢d_pcm_t¡amp_ty³_t
 
t¡amp_ty³
 = 
SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY
;

1619 
fmode
;

1620 
¢d_pcm_t
 *
pcm
 = 
NULL
;

1621 
¢d_pcm_hw_t
 *
hw
 = 
NULL
;

1622 
¢d_pcm_šfo_t
 
šfo
;

1623 
»t
;

1625 
	`as£¹
(
pcmp
);

1627 
	`mem£t
(&
šfo
, 0, (info));

1628 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_INFO
, &
šfo
) < 0) {

1629 
»t
 = -
”ºo
;

1630 
	`SYSMSG
("SNDRV_PCM_IOCTL_INFO faed (%i)", 
»t
);

1631 
	`şo£
(
fd
);

1632  
»t
;

1636 ià((
fmode
 = 
	`fú
(
fd
, 
F_GETFL
)) < 0) {

1637 
»t
 = -
”ºo
;

1638 
	`şo£
(
fd
);

1639  
»t
;

1641 
mode
 = 0;

1642 ià(
fmode
 & 
O_NONBLOCK
)

1643 
mode
 |ğ
SND_PCM_NONBLOCK
;

1644 ià(
fmode
 & 
O_ASYNC
)

1645 
mode
 |ğ
SND_PCM_ASYNC
;

1646 ià(
fmode
 & 
O_APPEND
)

1647 
mode
 |ğ
SND_PCM_APPEND
;

1649 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_PVERSION
, &
v”
) < 0) {

1650 
»t
 = -
”ºo
;

1651 
	`SYSMSG
("SNDRV_PCM_IOCTL_PVERSION faed (%i)", 
»t
);

1652 
	`şo£
(
fd
);

1653  
»t
;

1655 ià(
	`SNDRV_PROTOCOL_INCOMPATIBLE
(
v”
, 
SNDRV_PCM_VERSION_MAX
))

1656  -
SND_ERROR_INCOMPATIBLE_VERSION
;

1658 ià(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 14è<ğ
v”
) {

1660 
u£r_v”
 = 
SNDRV_PCM_VERSION
;

1661 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_USER_PVERSION
, &
u£r_v”
) < 0) {

1662 
»t
 = -
”ºo
;

1663 
	`SNDMSG
("USER_PVERSION failed");

1664  
»t
;

1668 #ià
	`defšed
(
HAVE_CLOCK_GETTIME
è&& defšed(
CLOCK_MONOTONIC
)

1669 ià(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 9è<ğ
v”
) {

1670 
time¥ec
imespec;

1671 ià(
	`şock_g‘time
(
CLOCK_MONOTONIC
, &
time¥ec
) == 0) {

1672 
Ú
 = 
SNDRV_PCM_TSTAMP_TYPE_MONOTONIC
;

1673 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_TTSTAMP
, &
Ú
) < 0) {

1674 
»t
 = -
”ºo
;

1675 
	`SNDMSG
("TTSTAMP failed");

1676  
»t
;

1678 
t¡amp_ty³
 = 
SND_PCM_TSTAMP_TYPE_MONOTONIC
;

1682 ià(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 5è<ğ
v”
) {

1683 
Ú
 = 1;

1684 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_TSTAMP
, &
Ú
) < 0) {

1685 
»t
 = -
”ºo
;

1686 
	`SNDMSG
("TSTAMP failed");

1687  
»t
;

1691 
hw
 = 
	`ÿÎoc
(1, (
¢d_pcm_hw_t
));

1692 ià(!
hw
) {

1693 
	`şo£
(
fd
);

1694  -
ENOMEM
;

1697 
hw
->
v”siÚ
 = 
v”
;

1698 
hw
->
ÿrd
 = 
šfo
.card;

1699 
hw
->
deviû
 = 
šfo
.device;

1700 
hw
->
subdeviû
 = 
šfo
.subdevice;

1701 
hw
->
fd
 = fd;

1703 
hw
->
fÜm©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1704 
hw
->
¿‹s
.
mš
 = hw->¿‹s.
max
 = 0;

1705 
hw
->
chªÃls
 = 0;

1707 
»t
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_HW
, 
Çme
, 
šfo
.
¡»am
, 
mode
);

1708 ià(
»t
 < 0) {

1709 
	`ä“
(
hw
);

1710 
	`şo£
(
fd
);

1711  
»t
;

1714 
pcm
->
İs
 = &
¢d_pcm_hw_İs
;

1715 
pcm
->
ç¡_İs
 = &
¢d_pcm_hw_ç¡_İs
;

1716 
pcm
->
´iv©e_d©a
 = 
hw
;

1717 
pcm
->
pŞl_fd
 = 
fd
;

1718 
pcm
->
pŞl_ev’ts
 = 
šfo
.
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
 ? 
POLLOUT
 : 
POLLIN
;

1719 
pcm
->
t¡amp_ty³
 =stamp_type;

1720 #ifdeà
THREAD_SAFE_API


1721 
pcm
->
Ãed_lock
 = 0;

1723 
pcm
->
own_¡©e_check
 = 1;

1725 
»t
 = 
	`m­_¡©us_ªd_cÚŒŞ_d©a
(
pcm
, !!
sync_±r_ioùl
);

1726 ià(
»t
 < 0) {

1727 
	`¢d_pcm_şo£
(
pcm
);

1728  
»t
;

1731 *
pcmp
 = 
pcm
;

1733 
	}
}

1751 
	$¢d_pcm_hw_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1752 
ÿrd
, 
deviû
, 
subdeviû
,

1753 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
,

1754 
mm­_emuÏtiÚ
 
ATTRIBUTE_UNUSED
,

1755 
sync_±r_ioùl
)

1757 
f’ame
[(
SNDRV_FILE_PCM_STREAM_PLAYBACK
) + 20];

1758 cÚ¡ *
fefmt
;

1759 
»t
 = 0, 
fd
 = -1;

1760 
©‹m±
 = 0;

1761 
¢d_pcm_šfo_t
 
šfo
;

1762 
fmode
;

1763 
¢d_ùl_t
 *
ùl
;

1765 
	`as£¹
(
pcmp
);

1767 ià((
»t
 = 
	`¢d_ùl_hw_İ’
(&
ùl
, 
NULL
, 
ÿrd
, 0)) < 0)

1768  
»t
;

1770 
¡»am
) {

1771 
SND_PCM_STREAM_PLAYBACK
:

1772 
fefmt
 = 
SNDRV_FILE_PCM_STREAM_PLAYBACK
;

1774 
SND_PCM_STREAM_CAPTURE
:

1775 
fefmt
 = 
SNDRV_FILE_PCM_STREAM_CAPTURE
;

1778 
	`SNDERR
("šv®id sŒ—m %d", 
¡»am
);

1779  -
EINVAL
;

1781 
	`¥rštf
(
f’ame
, 
fefmt
, 
ÿrd
, 
deviû
);

1783 
__agaš
:

1784 ià(
©‹m±
++ > 3) {

1785 
»t
 = -
EBUSY
;

1786 
_”r
;

1788 
»t
 = 
	`¢d_ùl_pcm_´eãr_subdeviû
(
ùl
, 
subdeviû
);

1789 ià(
»t
 < 0)

1790 
_”r
;

1791 
fmode
 = 
O_RDWR
;

1792 ià(
mode
 & 
SND_PCM_NONBLOCK
)

1793 
fmode
 |ğ
O_NONBLOCK
;

1794 ià(
mode
 & 
SND_PCM_ASYNC
)

1795 
fmode
 |ğ
O_ASYNC
;

1796 ià(
mode
 & 
SND_PCM_APPEND
)

1797 
fmode
 |ğ
O_APPEND
;

1798 
fd
 = 
	`¢d_İ’_deviû
(
f’ame
, 
fmode
);

1799 ià(
fd
 < 0) {

1800 
»t
 = -
”ºo
;

1801 
	`SYSMSG
("İ’ '%s' faed (%i)", 
f’ame
, 
»t
);

1802 
_”r
;

1804 ià(
subdeviû
 >= 0) {

1805 
	`mem£t
(&
šfo
, 0, (info));

1806 ià(
	`ioùl
(
fd
, 
SNDRV_PCM_IOCTL_INFO
, &
šfo
) < 0) {

1807 
»t
 = -
”ºo
;

1808 
	`SYSMSG
("SNDRV_PCM_IOCTL_INFO faed (%i)", 
»t
);

1809 
_”r
;

1811 ià(
šfo
.
subdeviû
 != () subdevice) {

1812 
	`şo£
(
fd
);

1813 
fd
 = -1;

1814 
__agaš
;

1817 
	`¢d_ùl_şo£
(
ùl
);

1818  
	`¢d_pcm_hw_İ’_fd
(
pcmp
, 
Çme
, 
fd
, 
sync_±r_ioùl
);

1819 
_”r
:

1820 ià(
fd
 >= 0)

1821 
	`şo£
(
fd
);

1822 
	`¢d_ùl_şo£
(
ùl
);

1823  
»t
;

1824 
	}
}

1878 
	$_¢d_pcm_hw_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1879 
¢d_cÚfig_t
 *
roÙ
 
ATTRIBUTE_UNUSED
, snd_cÚfig_ˆ*
cÚf
,

1880 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

1882 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1883 
ÿrd
 = -1, 
deviû
 = 0, 
subdeviû
 = -1;

1884 cÚ¡ *
¡r
;

1885 
”r
, 
sync_±r_ioùl
 = 0;

1886 
mš_¿‹
 = 0, 
max_¿‹
 = 0, 
chªÃls
 = 0, 
d¿š_s’û
 = -1;

1887 
¢d_pcm_fÜm©_t
 
fÜm©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1888 
¢d_cÚfig_t
 *
n
;

1889 
nÚblock
 = 1;

1890 
¢d_pcm_chm­_qu”y_t
 **
chm­
 = 
NULL
;

1891 
¢d_pcm_hw_t
 *
hw
;

1894 ià(
	`¢d_cÚfig_£¬ch
(
roÙ
, "deçuÉs.pcm.nÚblock", &
n
) >= 0) {

1895 
”r
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

1896 ià(
”r
 >= 0)

1897 
nÚblock
 = 
”r
;

1899 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1900 cÚ¡ *
id
;

1901 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1902 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1904 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

1906 ià(
	`¡rcmp
(
id
, "card") == 0) {

1907 
”r
 = 
	`¢d_cÚfig_g‘_ÿrd
(
n
);

1908 ià(
”r
 < 0)

1909 
ç
;

1910 
ÿrd
 = 
”r
;

1913 ià(
	`¡rcmp
(
id
, "device") == 0) {

1914 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
deviû
);

1915 ià(
”r
 < 0) {

1916 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1917 
ç
;

1921 ià(
	`¡rcmp
(
id
, "subdevice") == 0) {

1922 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
subdeviû
);

1923 ià(
”r
 < 0) {

1924 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1925 
ç
;

1929 ià(
	`¡rcmp
(
id
, "sync_ptr_ioctl") == 0) {

1930 
”r
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

1931 ià(
”r
 < 0)

1933 
sync_±r_ioùl
 = 
”r
;

1936 ià(
	`¡rcmp
(
id
, "nonblock") == 0) {

1937 
”r
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

1938 ià(
”r
 < 0)

1940 
nÚblock
 = 
”r
;

1943 ià(
	`¡rcmp
(
id
, "rate") == 0) {

1944 
v®
;

1945 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è=ğ
SND_CONFIG_TYPE_COMPOUND
 &&

1946 
	`¢d_cÚfig_is_¬¿y
(
n
)) {

1947 
¢d_cÚfig_t
 *
m
;

1948 
”r
 = 
	`¢d_cÚfig_£¬ch
(
n
, "0", &
m
);

1949 ià(
”r
 < 0) {

1950 
	`SNDERR
("arrayƒxpected for„ate compound");

1951 
ç
;

1953 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
m
, &
v®
);

1954 ià(
”r
 < 0) {

1955 
	`SNDERR
("Invalidype for„ate.0");

1956 
ç
;

1958 
mš_¿‹
 = 
max_¿‹
 = 
v®
;

1959 
”r
 = 
	`¢d_cÚfig_£¬ch
(
n
, "1", &
m
);

1960 ià(
”r
 >= 0) {

1961 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
m
, &
v®
);

1962 ià(
”r
 < 0) {

1963 
	`SNDERR
("Invalidype for„ate.0");

1964 
ç
;

1966 
max_¿‹
 = 
v®
;

1969 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v®
);

1970 ià(
”r
 < 0) {

1971 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1972 
ç
;

1974 
mš_¿‹
 = 
max_¿‹
 = 
v®
;

1978 ià(
	`¡rcmp
(
id
, "min_rate") == 0) {

1979 
v®
;

1980 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v®
);

1981 ià(
”r
 < 0) {

1982 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1983 
ç
;

1985 
mš_¿‹
 = 
v®
;

1988 ià(
	`¡rcmp
(
id
, "max_rate") == 0) {

1989 
v®
;

1990 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v®
);

1991 ià(
”r
 < 0) {

1992 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1993 
ç
;

1995 
max_¿‹
 = 
v®
;

1998 ià(
	`¡rcmp
(
id
, "format") == 0) {

1999 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
);

2000 ià(
”r
 < 0) {

2001 
	`SNDERR
("šv®idy³ fÜ %s", 
id
);

2002 
ç
;

2004 
fÜm©
 = 
	`¢d_pcm_fÜm©_v®ue
(
¡r
);

2007 ià(
	`¡rcmp
(
id
, "channels") == 0) {

2008 
v®
;

2009 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v®
);

2010 ià(
”r
 < 0) {

2011 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

2012 
ç
;

2014 
chªÃls
 = 
v®
;

2017 ià(
	`¡rcmp
(
id
, "chmap") == 0) {

2018 
	`¢d_pcm_ä“_chm­s
(
chm­
);

2019 
chm­
 = 
	`_¢d_pcm_·r£_cÚfig_chm­s
(
n
);

2020 ià(!
chm­
) {

2021 
	`SNDERR
("Inv®id chªÃÈm­ fÜ %s", 
id
);

2022 
”r
 = -
EINVAL
;

2023 
ç
;

2027 ià(
	`¡rcmp
(
id
, "drain_silence") == 0) {

2028 
v®
;

2029 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v®
);

2030 ià(
”r
 < 0) {

2031 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

2032 
ç
;

2034 
d¿š_s’û
 = 
v®
;

2037 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

2038 
”r
 = -
EINVAL
;

2039 
ç
;

2041 ià(
ÿrd
 < 0) {

2042 
	`SNDERR
("card is‚ot defined");

2043 
”r
 = -
EINVAL
;

2044 
ç
;

2046 ià((
mš_¿‹
 < 0è|| (
max_¿‹
 < min_rate)) {

2047 
	`SNDERR
("min_rate - max_rate configuration invalid");

2048 
”r
 = -
EINVAL
;

2049 
ç
;

2051 
”r
 = 
	`¢d_pcm_hw_İ’
(
pcmp
, 
Çme
, 
ÿrd
, 
deviû
, 
subdeviû
, 
¡»am
,

2052 
mode
 | (
nÚblock
 ? 
SND_PCM_NONBLOCK
 : 0),

2053 0, 
sync_±r_ioùl
);

2054 ià(
”r
 < 0)

2055 
ç
;

2056 ià(
nÚblock
 && ! (
mode
 & 
SND_PCM_NONBLOCK
)) {

2058 
	`¢d_pcm_hw_nÚblock
(*
pcmp
, 0);

2059 (*
pcmp
)->
mode
 = mode;

2063 (*
pcmp
)->
mode
 |ğmod& (
SND_PCM_NO_AUTO_RESAMPLE
|

2064 
SND_PCM_NO_AUTO_CHANNELS
|

2065 
SND_PCM_NO_AUTO_FORMAT
|

2066 
SND_PCM_NO_SOFTVOL
);

2068 
hw
 = (*
pcmp
)->
´iv©e_d©a
;

2069 ià(
fÜm©
 !ğ
SND_PCM_FORMAT_UNKNOWN
)

2070 
hw
->
fÜm©
 = format;

2071 ià(
chªÃls
 > 0)

2072 
hw
->
chªÃls
 = channels;

2073 ià(
mš_¿‹
 > 0) {

2074 
hw
->
¿‹s
.
mš
 = 
mš_¿‹
;

2075 
hw
->
¿‹s
.
max
 = 
max_¿‹
;

2077 ià(
chm­
)

2078 
hw
->
chm­_ov”ride
 = 
chm­
;

2079 
hw
->
d¿š_s’û
 = drain_silence;

2083 
ç
:

2084 
	`¢d_pcm_ä“_chm­s
(
chm­
);

2085  
”r
;

2086 
	}
}

2088 #iâdeà
DOC_HIDDEN


2089 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_hw_İ’
, 
SND_PCM_DLSYM_VERSION
);

2096 #iâdeà
DOC_HIDDEN


2097 
	#__OLD_TO_NEW_MASK
(
x
è((x&7)|((x&0x07fffff8)<<5))

	)

2098 
	#__NEW_TO_OLD_MASK
(
x
è((x&7)|((x&0xffffff00)>>5))

	)

2101 
	$¢d_pcm_hw_cÚv”t_äom_Şd_·¿ms
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

2102 
¢drv_pcm_hw_·¿ms_Şd
 *
İ¬ams
)

2104 
i
;

2106 
	`mem£t
(
·¿ms
, 0, (*params));

2107 
·¿ms
->
æags
 = 
İ¬ams
->flags;

2108 
i
 = 0; i < (
İ¬ams
->
masks
) / (); i++)

2109 
·¿ms
->
masks
[
i
].
b™s
[0] = 
İ¬ams
->masks[i];

2110 
	`memıy
(
·¿ms
->
š‹rv®s
, 
İ¬ams
->intervals, (oparams->intervals));

2111 
·¿ms
->
rmask
 = 
	`__OLD_TO_NEW_MASK
(
İ¬ams
->rmask);

2112 
·¿ms
->
cmask
 = 
	`__OLD_TO_NEW_MASK
(
İ¬ams
->cmask);

2113 
·¿ms
->
šfo
 = 
İ¬ams
->info;

2114 
·¿ms
->
msb™s
 = 
İ¬ams
->msbits;

2115 
·¿ms
->
¿‹_num
 = 
İ¬ams
->rate_num;

2116 
·¿ms
->
¿‹_d’
 = 
İ¬ams
->rate_den;

2117 
·¿ms
->
fifo_size
 = 
İ¬ams
->fifo_size;

2118 
	}
}

2120 
	$¢d_pcm_hw_cÚv”t_to_Şd_·¿ms
(
¢drv_pcm_hw_·¿ms_Şd
 *
İ¬ams
,

2121 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

2122 *
cmask
)

2124 
i
, 
j
;

2126 
	`mem£t
(
İ¬ams
, 0, (*oparams));

2127 
İ¬ams
->
æags
 = 
·¿ms
->flags;

2128 
i
 = 0; i < (
İ¬ams
->
masks
) / (); i++) {

2129 
İ¬ams
->
masks
[
i
] = 
·¿ms
->masks[i].
b™s
[0];

2130 
j
 = 1; j < (
·¿ms
->
masks
[
i
].
b™s
) / (); j++)

2131 ià(
·¿ms
->
masks
[
i
].
b™s
[
j
]) {

2132 *
cmask
 |ğ1 << 
i
;

2136 
	`memıy
(
İ¬ams
->
š‹rv®s
, 
·¿ms
->intervals, (oparams->intervals));

2137 
İ¬ams
->
rmask
 = 
	`__NEW_TO_OLD_MASK
(
·¿ms
->rmask);

2138 
İ¬ams
->
cmask
 = 
	`__NEW_TO_OLD_MASK
(
·¿ms
->cmask);

2139 
İ¬ams
->
šfo
 = 
·¿ms
->info;

2140 
İ¬ams
->
msb™s
 = 
·¿ms
->msbits;

2141 
İ¬ams
->
¿‹_num
 = 
·¿ms
->rate_num;

2142 
İ¬ams
->
¿‹_d’
 = 
·¿ms
->rate_den;

2143 
İ¬ams
->
fifo_size
 = 
·¿ms
->fifo_size;

2144 
	}
}

2146 
	$u£_Şd_hw_·¿ms_ioùl
(
fd
, 
cmd
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

2148 
¢drv_pcm_hw_·¿ms_Şd
 
İ¬ams
;

2149 
cmask
 = 0;

2150 
»s
;

2152 
	`¢d_pcm_hw_cÚv”t_to_Şd_·¿ms
(&
İ¬ams
, 
·¿ms
, &
cmask
);

2153 
»s
 = 
	`ioùl
(
fd
, 
cmd
, &
İ¬ams
);

2154 
	`¢d_pcm_hw_cÚv”t_äom_Şd_·¿ms
(
·¿ms
, &
İ¬ams
);

2155 
·¿ms
->
cmask
 |= cmask;

2156  
»s
;

2157 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_iec958.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_¶ugš.h
"

31 
	~"¶ugš_İs.h
"

32 
	~"bsw­.h
"

34 #iâdeà
PIC


36 cÚ¡ *
	g_¢d_moduË_pcm_›c958
 = "";

42 #iâdeà
DOC_HIDDEN


44 
¢d_pcm_›c958
 
	t¢d_pcm_›c958_t
;

46 (*
	t›c958_f
)(
	t¢d_pcm_›c958_t
 *
	t›c
,

47 cÚ¡ 
	t¢d_pcm_chªÃl_¬—_t
 *
	td¡_¬—s
,

48 
	t¢d_pcm_uäames_t
 
	td¡_off£t
,

49 cÚ¡ 
	t¢d_pcm_chªÃl_¬—_t
 *
	t¤c_¬—s
,

50 
	t¢d_pcm_uäames_t
 
	t¤c_off£t
,

51 
	tchªÃls
, 
	t¢d_pcm_uäames_t
 
	täames
);

53 
	s¢d_pcm_›c958
 {

55 
¢d_pcm_¶ugš_t
 
¶ug
;

56 
g‘put_idx
;

57 
›c958_f
 
func
;

58 
¢d_pcm_fÜm©_t
 
sfÜm©
;

59 
¢d_pcm_fÜm©_t
 
fÜm©
;

60 
couÁ”
;

61 
¡©us
[24];

62 
by‹sw­
;

63 
´—mbË
[3];

64 
¢d_pcm_ç¡_İs_t
 
fİs
;

65 
hdmi_mode
;

68 ’um { 
PREAMBLE_Z
, 
PREAMBLE_X
, 
PREAMBLE_Y
 };

77 
	$›c958_·r™y
(
d©a
)

79 
·r™y
;

80 
b™
;

82 
d©a
 >>= 4;

83 
·r™y
 = 0;

84 
b™
 = 4; bit <= 30; bit++) {

85 ià(
d©a
 & 1)

86 
·r™y
++;

87 
d©a
 >>= 1;

89  (
·r™y
 & 1);

90 
	}
}

105 
šlše
 
ušt32_t
 
	$›c958_subäame
(
¢d_pcm_›c958_t
 *
›c
, 
ušt32_t
 
d©a
, 
chªÃl
)

107 
by‹
 = 
›c
->
couÁ”
 >> 3;

108 
mask
 = 1 << (
›c
->
couÁ”
 - (
by‹
 << 3));

111 
d©a
 >>= 4;

112 
d©a
 &= ~0xf;

115 ià(
›c
->
¡©us
[
by‹
] & 
mask
)

116 
d©a
 |= 0x40000000;

118 ià(
	`›c958_·r™y
(
d©a
))

119 
d©a
 |= 0x80000000;

122 ià(
chªÃl
)

123 
d©a
 |ğ
›c
->
´—mbË
[
PREAMBLE_Y
];

124 ià(! 
›c
->
couÁ”
)

125 
d©a
 |ğ
›c
->
´—mbË
[
PREAMBLE_Z
];

127 
d©a
 |ğ
›c
->
´—mbË
[
PREAMBLE_X
];

129 ià(
›c
->
by‹sw­
)

130 
d©a
 = 
	`bsw­_32
(data);

132  
d©a
;

133 
	}
}

135 
šlše
 
št32_t
 
	$›c958_to_s32
(
¢d_pcm_›c958_t
 *
›c
, 
ušt32_t
 
d©a
)

137 ià(
›c
->
by‹sw­
)

138 
d©a
 = 
	`bsw­_32
(data);

139 
d©a
 &= ~0xf;

140 
d©a
 <<= 4;

141  (
št32_t
)
d©a
;

142 
	}
}

144 #iâdeà
DOC_HIDDEN


145 
	$¢d_pcm_›c958_decode
(
¢d_pcm_›c958_t
 *
›c
,

146 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

147 
¢d_pcm_uäames_t
 
d¡_off£t
,

148 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

149 
¢d_pcm_uäames_t
 
¤c_off£t
,

150 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
)

152 
	#PUT32_LABELS


	)

153 
	~"¶ugš_İs.h
"

154 #undeà
PUT32_LABELS


155 *
put
 = 
put32_Ïb–s
[
›c
->
g‘put_idx
];

156 
chªÃl
;

157 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++channel) {

158 cÚ¡ 
ušt32_t
 *
¤c
;

159 *
d¡
;

160 
¤c_¡•
, 
d¡_¡•
;

161 
¢d_pcm_uäames_t
 
äames1
;

162 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

163 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

164 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

165 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

166 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
è/ (
ušt32_t
);

167 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
);

168 
äames1
 = 
äames
;

169 
äames1
-- > 0) {

170 
št32_t
 
§m¶e
 = 
	`›c958_to_s32
(
›c
, *
¤c
);

171 *
put
;

172 
	#PUT32_END
 
aá”


	)

173 
	~"¶ugš_İs.h
"

174 #undeà
PUT32_END


175 
aá”
:

176 
¤c
 +ğ
¤c_¡•
;

177 
d¡
 +ğ
d¡_¡•
;

180 
	}
}

182 
	$¢d_pcm_›c958_’code
(
¢d_pcm_›c958_t
 *
›c
,

183 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

184 
¢d_pcm_uäames_t
 
d¡_off£t
,

185 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

186 
¢d_pcm_uäames_t
 
¤c_off£t
,

187 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
)

189 
	#GET32_LABELS


	)

190 
	~"¶ugš_İs.h
"

191 #undeà
GET32_LABELS


192 *
g‘
 = 
g‘32_Ïb–s
[
›c
->
g‘put_idx
];

193 
chªÃl
;

194 
št32_t
 
§m¶e
 = 0;

195 
couÁ”
 = 
›c
->counter;

196 
sšgË_¡»am
 = 
›c
->
hdmi_mode
 &&

197 (
›c
->
¡©us
[0] & 
IEC958_AES0_NONAUDIO
) &&

198 (
chªÃls
 == 8);

199 
couÁ”_¡•
 = 
sšgË_¡»am
 ? ((
chªÃls
 + 1) >> 1) : 1;

200 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++channel) {

201 cÚ¡ *
¤c
;

202 
ušt32_t
 *
d¡
;

203 
¤c_¡•
, 
d¡_¡•
;

204 
¢d_pcm_uäames_t
 
äames1
;

205 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

206 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

207 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

208 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

209 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
);

210 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
è/ (
ušt32_t
);

211 
äames1
 = 
äames
;

213 ià(
sšgË_¡»am
)

214 
›c
->
couÁ”
 = (couÁ” + (
chªÃl
 >> 1)) % 192;

216 
›c
->
couÁ”
 = counter;

218 
äames1
-- > 0) {

219 *
g‘
;

220 
	#GET32_END
 
aá”


	)

221 
	~"¶ugš_İs.h
"

222 #undeà
GET32_END


223 
aá”
:

224 
§m¶e
 = 
	`›c958_subäame
(
›c
, sam¶e, 
chªÃl
);

226 *
d¡
 = 
§m¶e
;

227 
¤c
 +ğ
¤c_¡•
;

228 
d¡
 +ğ
d¡_¡•
;

229 
›c
->
couÁ”
 +ğ
couÁ”_¡•
;

230 
›c
->
couÁ”
 %= 192;

232 ià(
sšgË_¡»am
)

233 
›c
->
couÁ”
 = (couÁ” + 
äames
 * 
couÁ”_¡•
) % 192;

235 
	}
}

238 
	$¢d_pcm_›c958_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

240 
¢d_pcm_›c958_t
 *
›c
 = 
pcm
->
´iv©e_d©a
;

241 
”r
;

242 
¢d_pcm_acûss_mask_t
 
acûss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

243 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

244 &
acûss_mask
);

245 ià(
”r
 < 0)

246  
”r
;

247 ià(
›c
->
sfÜm©
 =ğ
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
 ||

248 
›c
->
sfÜm©
 =ğ
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
) {

249 
¢d_pcm_fÜm©_mask_t
 
fÜm©_mask
 = { 
SND_PCM_FMTBIT_LINEAR
 };

250 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
,

251 &
fÜm©_mask
);

253 
¢d_pcm_fÜm©_mask_t
 
fÜm©_mask
 = {

254 { (1U << 
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
) |

255 (1U << 
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
) }

257 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
,

258 &
fÜm©_mask
);

260 ià(
”r
 < 0)

261  
”r
;

262 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
·¿ms
, 
SND_PCM_SUBFORMAT_STD
);

263 ià(
”r
 < 0)

264  
”r
;

265 
·¿ms
->
šfo
 &ğ~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

267 
	}
}

269 
	$¢d_pcm_›c958_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

271 
¢d_pcm_›c958_t
 *
›c
 = 
pcm
->
´iv©e_d©a
;

272 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

273 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

274 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

275 &
§cûss_mask
);

276 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
¥¬ams
, 
›c
->
sfÜm©
);

277 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¥¬ams
, 
SND_PCM_SUBFORMAT_STD
);

279 
	}
}

281 
	$¢d_pcm_›c958_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

282 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

284 
”r
;

285 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

286 
SND_PCM_HW_PARBIT_RATE
 |

287 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

288 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

289 
SND_PCM_HW_PARBIT_PERIODS
 |

290 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

291 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

292 
SND_PCM_HW_PARBIT_TICK_TIME
);

293 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

294 ià(
”r
 < 0)

295  
”r
;

297 
	}
}

299 
	$¢d_pcm_›c958_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

300 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

302 
”r
;

303 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

304 
SND_PCM_HW_PARBIT_RATE
 |

305 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

306 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

307 
SND_PCM_HW_PARBIT_PERIODS
 |

308 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

309 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

310 
SND_PCM_HW_PARBIT_TICK_TIME
);

311 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

312 ià(
”r
 < 0)

313  
”r
;

315 
	}
}

317 
	$¢d_pcm_›c958_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

319  
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

320 
¢d_pcm_›c958_hw_»fše_ı»·»
,

321 
¢d_pcm_›c958_hw_»fše_cchªge
,

322 
¢d_pcm_›c958_hw_»fše_¥»·»
,

323 
¢d_pcm_›c958_hw_»fše_schªge
,

324 
¢d_pcm_g’”ic_hw_»fše
);

325 
	}
}

327 
	$¢d_pcm_›c958_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 * 
·¿ms
)

329 
¢d_pcm_›c958_t
 *
›c
 = 
pcm
->
´iv©e_d©a
;

330 
¢d_pcm_fÜm©_t
 
fÜm©
;

331 
”r
 = 
	`¢d_pcm_hw_·¿ms_¦ave
(
pcm
, 
·¿ms
,

332 
¢d_pcm_›c958_hw_»fše_cchªge
,

333 
¢d_pcm_›c958_hw_»fše_¥»·»
,

334 
¢d_pcm_›c958_hw_»fše_schªge
,

335 
¢d_pcm_g’”ic_hw_·¿ms
);

336 ià(
”r
 < 0)

337  
”r
;

339 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(
·¿ms
, &
fÜm©
);

340 ià(
”r
 < 0)

341  
”r
;

343 
›c
->
fÜm©
 = format;

344 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

345 ià(
›c
->
sfÜm©
 =ğ
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
 ||

346 
›c
->
sfÜm©
 =ğ
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
) {

347 
›c
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_g‘_šdex
(
fÜm©
, 
SND_PCM_FORMAT_S32
);

348 
›c
->
func
 = 
¢d_pcm_›c958_’code
;

349 
›c
->
by‹sw­
 = iec->
sfÜm©
 !ğ
SND_PCM_FORMAT_IEC958_SUBFRAME
;

351 
›c
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_put_šdex
(
SND_PCM_FORMAT_S32
, iec->
sfÜm©
);

352 
›c
->
func
 = 
¢d_pcm_›c958_decode
;

353 
›c
->
by‹sw­
 = 
fÜm©
 !ğ
SND_PCM_FORMAT_IEC958_SUBFRAME
;

356 ià(
›c
->
sfÜm©
 =ğ
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
 ||

357 
›c
->
sfÜm©
 =ğ
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
) {

358 
›c
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_put_šdex
(
SND_PCM_FORMAT_S32
, 
fÜm©
);

359 
›c
->
func
 = 
¢d_pcm_›c958_decode
;

360 
›c
->
by‹sw­
 = iec->
sfÜm©
 !ğ
SND_PCM_FORMAT_IEC958_SUBFRAME
;

362 
›c
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_g‘_šdex
(›c->
sfÜm©
, 
SND_PCM_FORMAT_S32
);

363 
›c
->
func
 = 
¢d_pcm_›c958_’code
;

364 
›c
->
by‹sw­
 = 
fÜm©
 !ğ
SND_PCM_FORMAT_IEC958_SUBFRAME
;

368 ià((
›c
->
¡©us
[0] & 
IEC958_AES0_PROFESSIONAL
) == 0) {

369 ià((
›c
->
¡©us
[3] & 
IEC958_AES3_CON_FS
è=ğ
IEC958_AES3_CON_FS_NOTID
) {

370 
¿‹
 = 0;

371 
fs
;

373 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_¿‹
)(
·¿ms
, &
¿‹
, 0);

374 ià(
”r
 < 0)

375 
¿‹
 = 0;

377 
¿‹
) {

379 
fs
 = 
IEC958_AES3_CON_FS_22050
;

382 
fs
 = 
IEC958_AES3_CON_FS_24000
;

385 
fs
 = 
IEC958_AES3_CON_FS_32000
;

388 
fs
 = 
IEC958_AES3_CON_FS_44100
;

391 
fs
 = 
IEC958_AES3_CON_FS_48000
;

394 
fs
 = 
IEC958_AES3_CON_FS_88200
;

397 
fs
 = 
IEC958_AES3_CON_FS_96000
;

400 
fs
 = 
IEC958_AES3_CON_FS_176400
;

403 
fs
 = 
IEC958_AES3_CON_FS_192000
;

406 
fs
 = 
IEC958_AES3_CON_FS_768000
;

409 
fs
 = 
IEC958_AES3_CON_FS_NOTID
;

413 
›c
->
¡©us
[3] &ğ~
IEC958_AES3_CON_FS
;

414 
›c
->
¡©us
[3] |ğ
fs
;

417 ià((
›c
->
¡©us
[4] & 
IEC958_AES4_CON_WORDLEN
è=ğ
IEC958_AES4_CON_WORDLEN_NOTID
) {

418 
ws
;

419 
	`¢d_pcm_fÜm©_width
(
fÜm©
)) {

421 
ws
 = 
IEC958_AES4_CON_WORDLEN_20_16
;

424 
ws
 = 
IEC958_AES4_CON_WORDLEN_22_18
;

427 
ws
 = 
IEC958_AES4_CON_WORDLEN_20_16
 | 
IEC958_AES4_CON_MAX_WORDLEN_24
;

431 
ws
 = 
IEC958_AES4_CON_WORDLEN_24_20
 | 
IEC958_AES4_CON_MAX_WORDLEN_24
;

434 
ws
 = 
IEC958_AES4_CON_WORDLEN_NOTID
;

437 
›c
->
¡©us
[4] &ğ~(
IEC958_AES4_CON_MAX_WORDLEN_24
 | 
IEC958_AES4_CON_WORDLEN
);

438 
›c
->
¡©us
[4] |ğ
ws
;

442 
	}
}

444 
¢d_pcm_uäames_t


445 
	$¢d_pcm_›c958_wr™e_¬—s
(
¢d_pcm_t
 *
pcm
,

446 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

447 
¢d_pcm_uäames_t
 
off£t
,

448 
¢d_pcm_uäames_t
 
size
,

449 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

450 
¢d_pcm_uäames_t
 
¦ave_off£t
,

451 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

453 
¢d_pcm_›c958_t
 *
›c
 = 
pcm
->
´iv©e_d©a
;

454 ià(
size
 > *
¦ave_siz•
)

455 
size
 = *
¦ave_siz•
;

456 
›c
->
	`func
(›c, 
¦ave_¬—s
, 
¦ave_off£t
,

457 
¬—s
, 
off£t
,

458 
pcm
->
chªÃls
, 
size
);

459 *
¦ave_siz•
 = 
size
;

460  
size
;

461 
	}
}

463 
¢d_pcm_uäames_t


464 
	$¢d_pcm_›c958_»ad_¬—s
(
¢d_pcm_t
 *
pcm
,

465 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

466 
¢d_pcm_uäames_t
 
off£t
,

467 
¢d_pcm_uäames_t
 
size
,

468 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

469 
¢d_pcm_uäames_t
 
¦ave_off£t
,

470 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

472 
¢d_pcm_›c958_t
 *
›c
 = 
pcm
->
´iv©e_d©a
;

473 ià(
size
 > *
¦ave_siz•
)

474 
size
 = *
¦ave_siz•
;

475 
›c
->
	`func
(›c, 
¬—s
, 
off£t
,

476 
¦ave_¬—s
, 
¦ave_off£t
,

477 
pcm
->
chªÃls
, 
size
);

478 *
¦ave_siz•
 = 
size
;

479  
size
;

480 
	}
}

482 
	$¢d_pcm_›c958_š™
(
¢d_pcm_t
 *
pcm
)

484 
¢d_pcm_›c958_t
 *
›c
 = 
pcm
->
´iv©e_d©a
;

485 
›c
->
couÁ”
 = 0;

487 
	}
}

489 
	$¢d_pcm_›c958_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

491 
¢d_pcm_›c958_t
 *
›c
 = 
pcm
->
´iv©e_d©a
;

492 
	`¢d_ouut_´štf
(
out
, "IEC958 subframe conversion PCM (%s)\n",

493 
	`¢d_pcm_fÜm©_Çme
(
›c
->
sfÜm©
));

494 ià(
pcm
->
£tup
) {

495 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

496 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

498 
	`¢d_ouut_´štf
(
out
, "Slave: ");

499 
	`¢d_pcm_dump
(
›c
->
¶ug
.
g’
.
¦ave
, 
out
);

500 
	}
}

502 
¢d_pcm_säames_t
 
	$¢d_pcm_›c958_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

504 
couÁ”_deüem’t
;

505 
¢d_pcm_›c958_t
 *
›c
 = 
pcm
->
´iv©e_d©a
;

506 
¢d_pcm_säames_t
 
»suÉ
 = 
	`¢d_pcm_¶ugš_»wšd
(
pcm
, 
äames
);

507 ià(
»suÉ
 <= 0)

508  
»suÉ
;

510 
couÁ”_deüem’t
 = 
»suÉ
 % 192;

511 
›c
->
couÁ”
 +ğ192 - 
couÁ”_deüem’t
;

512 
›c
->
couÁ”
 %= 192;

513  
»suÉ
;

514 
	}
}

516 
¢d_pcm_säames_t
 
	$¢d_pcm_›c958_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

519 
couÁ”_šüem’t
;

520 
¢d_pcm_›c958_t
 *
›c
 = 
pcm
->
´iv©e_d©a
;

521 
¢d_pcm_säames_t
 
»suÉ
 = 
	`¢d_pcm_¶ugš_»wšd
(
pcm
, 
äames
);

522 ià(
»suÉ
 <= 0)

523  
»suÉ
;

525 
couÁ”_šüem’t
 = 
»suÉ
 % 192;

526 
›c
->
couÁ”
 +ğ
couÁ”_šüem’t
;

527 
›c
->
couÁ”
 %= 192;

528  
»suÉ
;

529 
	}
}

531 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_›c958_İs
 = {

532 .
şo£
 = 
¢d_pcm_g’”ic_şo£
,

533 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

534 .
	ghw_»fše
 = 
¢d_pcm_›c958_hw_»fše
,

535 .
	ghw_·¿ms
 = 
¢d_pcm_›c958_hw_·¿ms
,

536 .
	ghw_ä“
 = 
¢d_pcm_g’”ic_hw_ä“
,

537 .
	gsw_·¿ms
 = 
¢d_pcm_g’”ic_sw_·¿ms
,

538 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

539 .
	gdump
 = 
¢d_pcm_›c958_dump
,

540 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

541 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

542 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

543 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

544 .
	gqu”y_chm­s
 = 
¢d_pcm_g’”ic_qu”y_chm­s
,

545 .
	gg‘_chm­
 = 
¢d_pcm_g’”ic_g‘_chm­
,

546 .
	g£t_chm­
 = 
¢d_pcm_g’”ic_£t_chm­
,

564 
	$¢d_pcm_›c958_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
, 
¢d_pcm_fÜm©_t
 
sfÜm©
,

565 
¢d_pcm_t
 *
¦ave
, 
şo£_¦ave
,

566 cÚ¡ *
¡©us_b™s
,

567 cÚ¡ *
´—mbË_v®s
,

568 
hdmi_mode
)

570 
¢d_pcm_t
 *
pcm
;

571 
¢d_pcm_›c958_t
 *
›c
;

572 
”r
;

573 cÚ¡ 
deçuÉ_¡©us_b™s
[] = {

574 
IEC958_AES0_CON_EMPHASIS_NONE
,

575 
IEC958_AES1_CON_ORIGINAL
 | 
IEC958_AES1_CON_PCM_CODER
,

577 
IEC958_AES3_CON_FS_NOTID
,

578 
IEC958_AES4_CON_WORDLEN_NOTID


581 
	`as£¹
(
pcmp
 && 
¦ave
);

582 ià(
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1 &&

583 
sfÜm©
 !ğ
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
 &&

584 
sfÜm©
 !ğ
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
)

585  -
EINVAL
;

586 
›c
 = 
	`ÿÎoc
(1, (
¢d_pcm_›c958_t
));

587 ià(!
›c
) {

588  -
ENOMEM
;

590 
	`¢d_pcm_¶ugš_š™
(&
›c
->
¶ug
);

591 
›c
->
sfÜm©
 = sformat;

592 
›c
->
¶ug
.
»ad
 = 
¢d_pcm_›c958_»ad_¬—s
;

593 
›c
->
¶ug
.
wr™e
 = 
¢d_pcm_›c958_wr™e_¬—s
;

594 
›c
->
¶ug
.
š™
 = 
¢d_pcm_›c958_š™
;

595 
›c
->
¶ug
.
undo_»ad
 = 
¢d_pcm_¶ugš_undo_»ad_g’”ic
;

596 
›c
->
¶ug
.
undo_wr™e
 = 
¢d_pcm_¶ugš_undo_wr™e_g’”ic
;

597 
›c
->
¶ug
.
g’
.
¦ave
 = slave;

598 
›c
->
¶ug
.
g’
.
şo£_¦ave
 = close_slave;

600 ià(
¡©us_b™s
)

601 
	`memıy
(
›c
->
¡©us
, 
¡©us_b™s
, (iec->status));

603 
	`memıy
(
›c
->
¡©us
, 
deçuÉ_¡©us_b™s
, (default_status_bits));

605 
	`memıy
(
›c
->
´—mbË
, 
´—mbË_v®s
, 3);

607 
›c
->
hdmi_mode
 = hdmi_mode;

609 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_IEC958
, 
Çme
, 
¦ave
->
¡»am
, sÏve->
mode
);

610 ià(
”r
 < 0) {

611 
	`ä“
(
›c
);

612  
”r
;

614 
pcm
->
İs
 = &
¢d_pcm_›c958_İs
;

616 
›c
->
fİs
 = 
¢d_pcm_¶ugš_ç¡_İs
;

617 
›c
->
fİs
.
»wšd
 = 
¢d_pcm_›c958_»wšd
;

618 
›c
->
fİs
.
fÜw¬d
 = 
¢d_pcm_›c958_fÜw¬d
;

619 
pcm
->
ç¡_İs
 = &
›c
->
fİs
;

621 
pcm
->
´iv©e_d©a
 = 
›c
;

622 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

623 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

624 
pcm
->
t¡amp_ty³
 = 
¦ave
->tstamp_type;

625 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
›c
->
¶ug
.
hw_±r
, -1, 0);

626 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
›c
->
¶ug
.
­¶_±r
, -1, 0);

627 *
pcmp
 = 
pcm
;

630 
	}
}

686 
	$_¢d_pcm_›c958_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

687 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

688 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

690 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

691 
”r
;

692 
¢d_pcm_t
 *
¥cm
;

693 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

694 
¢d_cÚfig_t
 *
¡©us
 = 
NULL
, *
´—mbË
 = NULL;

695 
¢d_pcm_fÜm©_t
 
sfÜm©
;

696 
¡©us_b™s
[24];

697 
´—mbË_v®s
[3] = {

700 
hdmi_mode
 = 0;

702 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

703 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

704 cÚ¡ *
id
;

705 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

707 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

709 ià(
	`¡rcmp
(
id
, "slave") == 0) {

710 
¦ave
 = 
n
;

713 ià(
	`¡rcmp
(
id
, "status") == 0) {

714 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

715 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

716  -
EINVAL
;

718 
¡©us
 = 
n
;

721 ià(
	`¡rcmp
(
id
, "preamble") == 0) {

722 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

723 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

724  -
EINVAL
;

726 
´—mbË
 = 
n
;

729 ià(
	`¡rcmp
(
id
, "hdmi_mode") == 0) {

730 
”r
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

731 ià(
”r
 < 0)

733 
hdmi_mode
 = 
”r
;

736 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

737  -
EINVAL
;

739 
	`mem£t
(
¡©us_b™s
, 0, (status_bits));

740 ià(
¡©us
) {

741 
¢d_cÚfig_™”©Ü_t
 
i
, 
šext
;

742 
by‹s
 = 0;

743 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
šext
, 
¡©us
) {

744 
v®
;

745 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

746 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_INTEGER
) {

747 
	`SNDERR
("invalid IEC958 status bits");

748  -
EINVAL
;

750 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v®
);

751 ià(
”r
 < 0) {

752 
	`SNDERR
("invalid IEC958 status bits");

753  
”r
;

755 
¡©us_b™s
[
by‹s
] = 
v®
;

756 
by‹s
++;

757 ià(
by‹s
 >ğ()(
¡©us_b™s
))

762 ià(
´—mbË
) {

763 
¢d_cÚfig_™”©Ü_t
 
i
, 
šext
;

764 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
šext
, 
´—mbË
) {

765 
v®
;

766 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

767 cÚ¡ *
id
;

768 
idx
;

769 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

771 ià(
	`¡rcmp
(
id
, "b") == 0 || strcmp(id, "z") == 0)

772 
idx
 = 
PREAMBLE_Z
;

773 ià(
	`¡rcmp
(
id
, "m") == 0 || strcmp(id, "x") == 0)

774 
idx
 = 
PREAMBLE_X
;

775 ià(
	`¡rcmp
(
id
, "w") == 0 || strcmp(id, "y") == 0)

776 
idx
 = 
PREAMBLE_Y
;

778 
	`SNDERR
("šv®id IEC958…»ambËy³ %s", 
id
);

779  -
EINVAL
;

781 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v®
);

782 ià(
”r
 < 0) {

783 
	`SNDERR
("invalid IEC958…reamble value");

784  
”r
;

786 
´—mbË_v®s
[
idx
] = 
v®
;

789 ià(!
¦ave
) {

790 
	`SNDERR
("slave is‚ot defined");

791  -
EINVAL
;

793 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 1,

794 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_MANDATORY
, &
sfÜm©
);

795 ià(
”r
 < 0)

796  
”r
;

797 ià(
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1 &&

798 
sfÜm©
 !ğ
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
 &&

799 
sfÜm©
 !ğ
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
) {

800 
	`¢d_cÚfig_d–‘e
(
scÚf
);

801 
	`SNDERR
("invalid slave format");

802  -
EINVAL
;

804 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

805 
	`¢d_cÚfig_d–‘e
(
scÚf
);

806 ià(
”r
 < 0)

807  
”r
;

808 
”r
 = 
	`¢d_pcm_›c958_İ’
(
pcmp
, 
Çme
, 
sfÜm©
, 
¥cm
, 1,

809 
¡©us
 ? 
¡©us_b™s
 : 
NULL
,

810 
´—mbË_v®s
, 
hdmi_mode
);

811 ià(
”r
 < 0)

812 
	`¢d_pcm_şo£
(
¥cm
);

813  
”r
;

814 
	}
}

815 #iâdeà
DOC_HIDDEN


816 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_›c958_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_ioplug.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_iİlug.h
"

31 
	~"pcm_ext_·rm.h
"

32 
	~"pcm_g’”ic.h
"

34 #iâdeà
PIC


36 cÚ¡ *
	g_¢d_moduË_pcm_iİlug
 = "";

39 #iâdeà
DOC_HIDDEN


42 
	s¢d_pcm_iİlug_´iv
 {

43 
¢d_pcm_iİlug_t
 *
	md©a
;

44 
¢d_ext_·rm
 
	m·¿ms
[
SND_PCM_IOPLUG_HW_PARAMS
];

45 
¢d_pcm_uäames_t
 
	mÏ¡_hw
;

46 
¢d_pcm_uäames_t
 
	mava_max
;

47 
¢d_htime¡amp_t
 
	mŒigg”_t¡amp
;

48 } 
	tiİlug_´iv_t
;

50 
¢d_pcm_iİlug_drİ
(
¢d_pcm_t
 *
pcm
);

51 
¢d_pcm_iİlug_pŞl_desütÜs_couÁ
(
¢d_pcm_t
 *
pcm
);

52 
¢d_pcm_iİlug_pŞl_desütÜs
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
¥aû
);

53 
¢d_pcm_iİlug_pŞl_»v’ts
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
);

57 
	$¢d_pcm_iİlug_hw_±r_upd©e
(
¢d_pcm_t
 *
pcm
)

59 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

60 
¢d_pcm_säames_t
 
hw
;

62 
hw
 = 
io
->
d©a
->
ÿÎback
->
	`poš‹r
(io->data);

63 ià(
hw
 >= 0) {

64 
¢d_pcm_uäames_t
 
d–
;

65 
¢d_pcm_uäames_t
 
ava
;

67 ià((
¢d_pcm_uäames_t
)
hw
 >ğ
io
->
Ï¡_hw
)

68 
d–
 = 
hw
 - 
io
->
Ï¡_hw
;

70 cÚ¡ 
¢d_pcm_uäames_t
 
w¿p_pošt
 =

71 (
io
->
d©a
->
æags
 & 
SND_PCM_IOPLUG_FLAG_BOUNDARY_WA
) ?

72 
pcm
->
bound¬y
 :…cm->
bufãr_size
;

73 
d–
 = 
w¿p_pošt
 + 
hw
 - 
io
->
Ï¡_hw
;

75 
	`¢d_pcm_mm­_hw_fÜw¬d
(
io
->
d©a
->
pcm
, 
d–
);

77 ià(
io
->
d©a
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
) {

78 
ava
 = 
	`¢d_pcm_mm­_ava
(
pcm
);

79 ià(
ava
 >ğ
pcm
->
bufãr_size
)

80 
	`¢d_pcm_iİlug_drİ
(
pcm
);

82 
io
->
Ï¡_hw
 = (
¢d_pcm_uäames_t
)
hw
;

84 ià(
io
->
d©a
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
)

85 
	`¢d_pcm_iİlug_drİ
(
pcm
);

87 
io
->
d©a
->
¡©e
 = 
SNDRV_PCM_STATE_XRUN
;

89 
	}
}

91 
	$¢d_pcm_iİlug_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_šfo_t
 *
šfo
)

93 
	`mem£t
(
šfo
, 0, (*info));

94 
šfo
->
¡»am
 = 
pcm
->stream;

95 
šfo
->
ÿrd
 = -1;

96 ià(
pcm
->
Çme
) {

97 
	`¢d_¡¾ıy
((*)
šfo
->
id
, 
pcm
->
Çme
, (info->id));

98 
	`¢d_¡¾ıy
((*)
šfo
->
Çme
, 
pcm
->name, (info->name));

99 
	`¢d_¡¾ıy
((*)
šfo
->
subÇme
, 
pcm
->
Çme
, (info->subname));

101 
šfo
->
subdeviûs_couÁ
 = 1;

103 
	}
}

105 
	$¢d_pcm_iİlug_chªÃl_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_šfo_t
 *
šfo
)

107  
	`¢d_pcm_chªÃl_šfo_shm
(
pcm
, 
šfo
, -1);

108 
	}
}

110 
	$¢d_pcm_iİlug_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
)

112 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

114 ià(
io
->
d©a
->
v”siÚ
 >= 0x010001 &&

115 
io
->
d©a
->
ÿÎback
->
d–ay
)

116  
io
->
d©a
->
ÿÎback
->
	`d–ay
(io->d©a, 
d–ayp
);

118 
	`¢d_pcm_iİlug_hw_±r_upd©e
(
pcm
);

119 *
d–ayp
 = 
	`¢d_pcm_mm­_d–ay
(
pcm
);

122 
	}
}

124 
	$¢d_pcm_iİlug_¡©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©us_t
 * 
¡©us
)

126 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

127 
¢d_pcm_säames_t
 
sd
;

129 
	`mem£t
(
¡©us
, 0, (*status));

130 
	`¢d_pcm_iİlug_hw_±r_upd©e
(
pcm
);

131 
¡©us
->
¡©e
 = 
io
->
d©a
->state;

132 
¡©us
->
Œigg”_t¡amp
 = 
io
->trigger_tstamp;

133 
	`g‘time¡amp
(&
¡©us
->
t¡amp
, 
pcm
->
t¡amp_ty³
);

134 
¡©us
->
ava
 = 
	`¢d_pcm_mm­_ava
(
pcm
);

135 
¡©us
->
ava_max
 = 
io
->avail_max;

136 
¡©us
->
­¶_±r
 = *
pcm
->
­¶
.
±r
;

137 
¡©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

138 ià(
	`¢d_pcm_iİlug_d–ay
(
pcm
, &
sd
) < 0)

139 
sd
 = 
	`¢d_pcm_mm­_d–ay
(
pcm
);

140 
¡©us
->
d–ay
 = 
sd
;

142 
	}
}

144 
¢d_pcm_¡©e_t
 
	$¢d_pcm_iİlug_¡©e
(
¢d_pcm_t
 *
pcm
)

146 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

147  
io
->
d©a
->
¡©e
;

148 
	}
}

150 
	$¢d_pcm_iİlug_hwsync
(
¢d_pcm_t
 *
pcm
)

152 
	`¢d_pcm_iİlug_hw_±r_upd©e
(
pcm
);

154 
	}
}

156 
	$¢d_pcm_iİlug_»£t
(
¢d_pcm_t
 *
pcm
)

158 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

160 
io
->
d©a
->
­¶_±r
 = 0;

161 
io
->
d©a
->
hw_±r
 = 0;

162 
io
->
Ï¡_hw
 = 0;

163 
io
->
ava_max
 = 0;

165 
	}
}

167 
	$¢d_pcm_iİlug_´•¬e
(
¢d_pcm_t
 *
pcm
)

169 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

170 
”r
 = 0;

172 
	`¢d_pcm_iİlug_»£t
(
pcm
);

173 ià(
io
->
d©a
->
ÿÎback
->
´•¬e
) {

174 
	`¢d_pcm_uÆock
(
pcm
);

175 
”r
 = 
io
->
d©a
->
ÿÎback
->
	`´•¬e
(io->data);

176 
	`¢d_pcm_lock
(
pcm
);

178 ià(
”r
 < 0)

179  
”r
;

181 
io
->
d©a
->
¡©e
 = 
SND_PCM_STATE_PREPARED
;

182  
”r
;

183 
	}
}

185 cÚ¡ 
	ghw_·¿ms_ty³
[
SND_PCM_IOPLUG_HW_PARAMS
] = {

186 [
SND_PCM_IOPLUG_HW_ACCESS
] = 
SND_PCM_HW_PARAM_ACCESS
,

187 [
SND_PCM_IOPLUG_HW_FORMAT
] = 
SND_PCM_HW_PARAM_FORMAT
,

188 [
SND_PCM_IOPLUG_HW_CHANNELS
] = 
SND_PCM_HW_PARAM_CHANNELS
,

189 [
SND_PCM_IOPLUG_HW_RATE
] = 
SND_PCM_HW_PARAM_RATE
,

190 [
SND_PCM_IOPLUG_HW_PERIOD_BYTES
] = 
SND_PCM_HW_PARAM_PERIOD_BYTES
,

191 [
SND_PCM_IOPLUG_HW_BUFFER_BYTES
] = 
SND_PCM_HW_PARAM_BUFFER_BYTES
,

192 [
SND_PCM_IOPLUG_HW_PERIODS
] = 
SND_PCM_HW_PARAM_PERIODS
,

196 
	$ruË_mul
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
x
, 
a
, 
b
)

198 
¢d_š‹rv®_t
 
t
;

200 
	`¢d_š‹rv®_mul
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
a
),

201 
	`hw_·¿m_š‹rv®
(
·¿ms
, 
b
), &
t
);

202  
	`¢d_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
x
), &
t
);

203 
	}
}

206 
	$ruË_div
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
x
, 
a
, 
b
)

208 
¢d_š‹rv®_t
 
t
;

210 
	`¢d_š‹rv®_div
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
a
),

211 
	`hw_·¿m_š‹rv®
(
·¿ms
, 
b
), &
t
);

212  
	`¢d_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
x
), &
t
);

213 
	}
}

216 
	$ruË_muldivk
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
x
, 
a
, 
b
, 
k
)

218 
¢d_š‹rv®_t
 
t
;

220 
	`¢d_š‹rv®_muldivk
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
a
),

221 
	`hw_·¿m_š‹rv®
(
·¿ms
, 
b
), 
k
, &
t
);

222  
	`¢d_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
x
), &
t
);

223 
	}
}

226 
	$ruË_mulkdiv
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
x
, 
a
, 
k
, 
b
)

228 
¢d_š‹rv®_t
 
t
;

230 
	`¢d_š‹rv®_mulkdiv
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
a
), 
k
,

231 
	`hw_·¿m_š‹rv®
(
·¿ms
, 
b
), &
t
);

232  
	`¢d_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
x
), &
t
);

233 
	}
}

236 
	$dump_·rm
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

238 
¢d_ouut_t
 *
log
;

239 
	`¢d_ouut_¡dio_©ch
(&
log
, 
¡d”r
, 0);

240 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
log
);

241 
	`¢d_ouut_şo£
(
log
);

242 
	}
}

246 
	$»fše_time_ªd_size
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

247 
time
, 
size
, 
by‹s
)

249 
”r
, 
chªge1
 = 0;

252 
”r
 = 
	`ruË_muldivk
(
·¿ms
, 
size
, 
time
,

253 
SND_PCM_HW_PARAM_RATE
, 1000000);

254 ià(
”r
 < 0)

255  
”r
;

256 
chªge1
 |ğ
”r
;

259 
”r
 = 
	`ruË_muldivk
(
·¿ms
, 
by‹s
, 
size
,

260 
SND_PCM_HW_PARAM_FRAME_BITS
, 8);

261 ià(
”r
 < 0)

262  
”r
;

263 
chªge1
 |ğ
”r
;

264  
chªge1
;

265 
	}
}

268 
	$»fše_back_time_ªd_size
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

269 
time
, 
size
, 
by‹s
)

271 
”r
;

274 
”r
 = 
	`ruË_mulkdiv
(
·¿ms
, 
size
, 
by‹s
, 8, 
SND_PCM_HW_PARAM_FRAME_BITS
);

275 ià(
”r
 < 0)

276  
”r
;

278 
”r
 = 
	`ruË_mulkdiv
(
·¿ms
, 
time
, 
size
, 1000000, 
SND_PCM_HW_PARAM_RATE
);

279 ià(
”r
 < 0)

280  
”r
;

282 
	}
}

285 
	$¢d_pcm_iİlug_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

287 
chªge
 = 0, 
chªge1
, 
chªge2
, 
”r
;

288 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

289 
¢d_ext_·rm
 *
p
;

290 
i
;

293 
i
 = 
SND_PCM_IOPLUG_HW_ACCESS
; i <ğ
SND_PCM_IOPLUG_HW_FORMAT
; i++) {

294 
”r
 = 
	`¢d_ext_·rm_mask_»fše
(
	`hw_·¿m_mask
(
·¿ms
, 
hw_·¿ms_ty³
[
i
]),

295 
io
->
·¿ms
, 
i
);

296 ià(
”r
 < 0)

297  
”r
;

298 
chªge
 |ğ
”r
;

301 ; 
i
 <ğ
SND_PCM_IOPLUG_HW_RATE
; i++) {

302 
”r
 = 
	`¢d_ext_·rm_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
hw_·¿ms_ty³
[
i
]),

303 
io
->
·¿ms
, 
i
);

304 ià(
”r
 < 0)

305  
”r
;

306 
chªge
 |ğ
”r
;

309 ià(
·¿ms
->
rmask
 & ((1 << 
SND_PCM_HW_PARAM_ACCESS
) |

310 (1 << 
SND_PCM_HW_PARAM_FORMAT
) |

311 (1 << 
SND_PCM_HW_PARAM_SUBFORMAT
) |

312 (1 << 
SND_PCM_HW_PARAM_CHANNELS
) |

313 (1 << 
SND_PCM_HW_PARAM_RATE
))) {

314 
”r
 = 
	`¢d_pcm_hw_»fše_soá
(
pcm
, 
·¿ms
);

315 ià(
”r
 < 0)

316  
”r
;

317 
chªge
 |ğ
”r
;

320 
chªge1
 = 
	`»fše_time_ªd_size
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
,

321 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

322 
SND_PCM_HW_PARAM_PERIOD_BYTES
);

323 ià(
chªge1
 < 0)

324  
chªge1
;

325 
”r
 = 
	`¢d_ext_·rm_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_BYTES
),

326 
io
->
·¿ms
, 
SND_PCM_IOPLUG_HW_PERIOD_BYTES
);

327 ià(
”r
 < 0)

328  
”r
;

329 
chªge1
 |ğ
”r
;

330 ià(
chªge1
) {

331 
chªge
 |ğ
chªge1
;

332 
”r
 = 
	`»fše_back_time_ªd_size
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
,

333 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

334 
SND_PCM_HW_PARAM_PERIOD_BYTES
);

335 ià(
”r
 < 0)

336  
”r
;

339 
chªge1
 = 
	`»fše_time_ªd_size
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
,

340 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

341 
SND_PCM_HW_PARAM_BUFFER_BYTES
);

342 ià(
chªge1
 < 0)

343  
chªge1
;

344 
chªge
 |ğ
chªge1
;

347 
chªge2
 = 0;

348 
”r
 = 
	`¢d_ext_·rm_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_BYTES
),

349 
io
->
·¿ms
, 
SND_PCM_IOPLUG_HW_BUFFER_BYTES
);

350 ià(
”r
 < 0)

351  
”r
;

352 
chªge2
 |ğ
”r
;

354 
”r
 = 
	`ruË_div
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIODS
,

355 
SND_PCM_HW_PARAM_BUFFER_BYTES
,

356 
SND_PCM_HW_PARAM_PERIOD_BYTES
);

357 ià(
”r
 < 0)

358  
”r
;

359 
chªge2
 |ğ
”r
;

360 
”r
 = 
	`¢d_ext_·rm_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIODS
),

361 
io
->
·¿ms
, 
SND_PCM_IOPLUG_HW_PERIODS
);

362 ià(
”r
 < 0)

363  
”r
;

364 
chªge2
 |ğ
”r
;

366 
”r
 = 
	`ruË_mul
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_BYTES
,

367 
SND_PCM_HW_PARAM_PERIOD_BYTES
,

368 
SND_PCM_HW_PARAM_PERIODS
);

369 ià(
”r
 < 0)

370  
”r
;

371 
chªge2
 |ğ
”r
;

372 
chªge1
 |ğ
chªge2
;

373 } 
chªge2
);

374 
chªge
 |ğ
chªge1
;

376 ià(
chªge1
) {

377 
”r
 = 
	`»fše_back_time_ªd_size
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
,

378 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

379 
SND_PCM_HW_PARAM_BUFFER_BYTES
);

380 ià(
”r
 < 0)

381  
”r
;

385 
”r
 = 
	`ruË_div
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_BYTES
,

386 
SND_PCM_HW_PARAM_BUFFER_BYTES
,

387 
SND_PCM_HW_PARAM_PERIODS
);

388 ià(
”r
 < 0)

389  
”r
;

390 ià(
”r
) {

392 
chªge
 |ğ
”r
;

393 
”r
 = 
	`¢d_ext_·rm_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_BYTES
),

394 
io
->
·¿ms
, 
SND_PCM_IOPLUG_HW_PERIOD_BYTES
);

395 ià(
”r
 < 0)

396  
”r
;

397 
”r
 = 
	`»fše_back_time_ªd_size
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
,

398 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

399 
SND_PCM_HW_PARAM_PERIOD_BYTES
);

400 ià(
”r
 < 0)

401  
”r
;

404 
·¿ms
->
šfo
 = 
SND_PCM_INFO_BLOCK_TRANSFER
;

405 
p
 = &
io
->
·¿ms
[
SND_PCM_IOPLUG_HW_ACCESS
];

406 ià(
p
->
aùive
) {

407 
i
 = 0; i < 
p
->
num_li¡
; i++)

408 
p
->
li¡
[
i
]) {

409 
SND_PCM_ACCESS_MMAP_INTERLEAVED
:

410 
SND_PCM_ACCESS_RW_INTERLEAVED
:

411 
·¿ms
->
šfo
 |ğ
SND_PCM_INFO_INTERLEAVED
;

413 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
:

414 
SND_PCM_ACCESS_RW_NONINTERLEAVED
:

415 
·¿ms
->
šfo
 |ğ
SND_PCM_INFO_NONINTERLEAVED
;

419 ià(
io
->
d©a
->
ÿÎback
->
·u£
)

420 
·¿ms
->
šfo
 |ğ
SND_PCM_INFO_PAUSE
;

421 ià(
io
->
d©a
->
ÿÎback
->
»sume
)

422 
·¿ms
->
šfo
 |ğ
SND_PCM_INFO_RESUME
;

425 
	`årštf
(
¡d”r
, "XXX\n");

426 
	`dump_·rm
(
·¿ms
);

428  
chªge
;

429 
	}
}

431 
	$¢d_pcm_iİlug_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

433 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

434 
”r
;

436 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_acûss
)(
·¿ms
, &
io
->
d©a
->
acûss
);

437 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(
·¿ms
, &
io
->
d©a
->
fÜm©
);

438 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_chªÃls
)(
·¿ms
, &
io
->
d©a
->
chªÃls
);

439 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_¿‹
)(
·¿ms
, &
io
->
d©a
->
¿‹
, 0);

440 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_size
)(
·¿ms
, &
io
->
d©a
->
³riod_size
, 0);

441 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size
)(
·¿ms
, &
io
->
d©a
->
bufãr_size
);

442 ià(
io
->
d©a
->
ÿÎback
->
hw_·¿ms
) {

443 
”r
 = 
io
->
d©a
->
ÿÎback
->
	`hw_·¿ms
(io->d©a, 
·¿ms
);

444 ià(
”r
 < 0)

445  
”r
;

446 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_acûss
)(
·¿ms
, &
io
->
d©a
->
acûss
);

447 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(
·¿ms
, &
io
->
d©a
->
fÜm©
);

448 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_chªÃls
)(
·¿ms
, &
io
->
d©a
->
chªÃls
);

449 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_¿‹
)(
·¿ms
, &
io
->
d©a
->
¿‹
, 0);

450 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_size
)(
·¿ms
, &
io
->
d©a
->
³riod_size
, 0);

451 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size
)(
·¿ms
, &
io
->
d©a
->
bufãr_size
);

454 
	}
}

456 
	$¢d_pcm_iİlug_hw_ä“
(
¢d_pcm_t
 *
pcm
)

458 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

460 ià(
io
->
d©a
->
ÿÎback
->
hw_ä“
)

461  
io
->
d©a
->
ÿÎback
->
	`hw_ä“
(io->data);

463 
	}
}

465 
	$¢d_pcm_iİlug_sw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
)

467 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

468 
”r
;

470 ià(!
io
->
d©a
->
ÿÎback
->
sw_·¿ms
)

473 
	`¢d_pcm_uÆock
(
pcm
);

474 
”r
 = 
io
->
d©a
->
ÿÎback
->
	`sw_·¿ms
(io->d©a, 
·¿ms
);

475 
	`¢d_pcm_lock
(
pcm
);

477  
”r
;

478 
	}
}

481 
	$¢d_pcm_iİlug_¡¬t
(
¢d_pcm_t
 *
pcm
)

483 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

484 
”r
;

486 ià(
io
->
d©a
->
¡©e
 !ğ
SND_PCM_STATE_PREPARED
)

487  -
EBADFD
;

489 
”r
 = 
io
->
d©a
->
ÿÎback
->
	`¡¬t
(io->data);

490 ià(
”r
 < 0)

491  
”r
;

493 
	`g‘time¡amp
(&
io
->
Œigg”_t¡amp
, 
pcm
->
t¡amp_ty³
);

494 
io
->
d©a
->
¡©e
 = 
SND_PCM_STATE_RUNNING
;

497 
	}
}

499 
	$¢d_pcm_iİlug_drİ
(
¢d_pcm_t
 *
pcm
)

501 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

503 ià(
io
->
d©a
->
¡©e
 =ğ
SND_PCM_STATE_OPEN
)

504  -
EBADFD
;

506 
io
->
d©a
->
ÿÎback
->
	`¡İ
(io->data);

508 
	`g‘time¡amp
(&
io
->
Œigg”_t¡amp
, 
pcm
->
t¡amp_ty³
);

509 
io
->
d©a
->
¡©e
 = 
SND_PCM_STATE_SETUP
;

512 
	}
}

514 
	$iİlug_d¿š_vŸ_pŞl
(
¢d_pcm_t
 *
pcm
)

516 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

518 
io
->
d©a
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
) {

519 
	`¢d_pcm_iİlug_hw_±r_upd©e
(
pcm
);

520 ià(
io
->
d©a
->
¡©e
 !ğ
SND_PCM_STATE_DRAINING
)

523 ià(
io
->
d©a
->
nÚblock
)

524  -
EAGAIN
;

525 ià(
	`¢d_pcm_wa™_nocheck
(
pcm
, 
SND_PCM_WAIT_DRAIN
) < 0)

530 
	}
}

533 
	$¢d_pcm_iİlug_d¿š
(
¢d_pcm_t
 *
pcm
)

535 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

536 
”r
 = 0;

538 
	`¢d_pcm_lock
(
pcm
);

539 
io
->
d©a
->
¡©e
) {

540 
SND_PCM_STATE_OPEN
:

541 
SND_PCM_STATE_DISCONNECTED
:

542 
SND_PCM_STATE_SUSPENDED
:

543 
	`¢d_pcm_uÆock
(
pcm
);

544  -
EBADFD
;

545 
SND_PCM_STATE_PREPARED
:

546 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

547 ià(!
io
->
d©a
->
ÿÎback
->
d¿š
) {

548 
”r
 = 
	`¢d_pcm_iİlug_¡¬t
(
pcm
);

549 ià(
”r
 < 0)

550 
uÆock
;

552 
io
->
d©a
->
¡©e
 = 
SND_PCM_STATE_DRAINING
;

555 
SND_PCM_STATE_RUNNING
:

556 
io
->
d©a
->
¡©e
 = 
SND_PCM_STATE_DRAINING
;

562 ià(
io
->
d©a
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
) {

563 ià(
io
->
d©a
->
ÿÎback
->
d¿š
) {

564 
	`¢d_pcm_uÆock
(
pcm
);

565 
”r
 = 
io
->
d©a
->
ÿÎback
->
	`d¿š
(io->data);

566 
	`¢d_pcm_lock
(
pcm
);

568 
”r
 = 
	`iİlug_d¿š_vŸ_pŞl
(
pcm
);

572 
uÆock
:

573 ià(!
”r
 && 
io
->
d©a
->
¡©e
 !ğ
SND_PCM_STATE_SETUP
)

574 
	`¢d_pcm_iİlug_drİ
(
pcm
);

575 
	`¢d_pcm_uÆock
(
pcm
);

576  
”r
;

577 
	}
}

579 
	$¢d_pcm_iİlug_·u£
(
¢d_pcm_t
 *
pcm
, 
’abË
)

581 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

582 cÚ¡ 
¢d_pcm_¡©e_t
 
¡©es
[2] = {

583 
SND_PCM_STATE_RUNNING
, 
SND_PCM_STATE_PAUSED


585 
´ev
, 
”r
;

587 
´ev
 = !
’abË
;

588 
’abË
 = !
´ev
;

589 ià(
io
->
d©a
->
¡©e
 !ğ
¡©es
[
´ev
])

590  -
EBADFD
;

591 ià(
io
->
d©a
->
ÿÎback
->
·u£
) {

592 
”r
 = 
io
->
d©a
->
ÿÎback
->
	`·u£
(io->d©a, 
’abË
);

593 ià(
”r
 < 0)

594  
”r
;

596 
io
->
d©a
->
¡©e
 = 
¡©es
[
’abË
];

598 
	}
}

600 
¢d_pcm_säames_t
 
	$¢d_pcm_iİlug_»wšdabË
(
¢d_pcm_t
 *
pcm
)

602  
	`¢d_pcm_mm­_hw_»wšdabË
(
pcm
);

603 
	}
}

605 
¢d_pcm_säames_t
 
	$¢d_pcm_iİlug_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

607 
	`¢d_pcm_mm­_­¶_backw¬d
(
pcm
, 
äames
);

608  
äames
;

609 
	}
}

611 
¢d_pcm_säames_t
 
	$¢d_pcm_iİlug_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
)

613  
	`¢d_pcm_mm­_ava
(
pcm
);

614 
	}
}

616 
¢d_pcm_säames_t
 
	$¢d_pcm_iİlug_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

618 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
äames
);

619  
äames
;

620 
	}
}

623 
	$¢d_pcm_iİlug_»sume
(
¢d_pcm_t
 *
pcm
)

625 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

627 ià(
io
->
d©a
->
ÿÎback
->
»sume
)

628 
io
->
d©a
->
ÿÎback
->
	`»sume
(io->data);

630 
	}
}

633 
¢d_pcm_säames_t
 
	$iİlug_´iv_Œªsãr_¬—s
(
¢d_pcm_t
 *
pcm
,

634 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

635 
¢d_pcm_uäames_t
 
off£t
,

636 
¢d_pcm_uäames_t
 
size
)

638 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

639 
¢d_pcm_säames_t
 
»suÉ
;

641 ià(! 
size
)

643 ià(
io
->
d©a
->
ÿÎback
->
Œªsãr
)

644 
»suÉ
 = 
io
->
d©a
->
ÿÎback
->
	`Œªsãr
(io->d©a, 
¬—s
, 
off£t
, 
size
);

646 
»suÉ
 = 
size
;

647 ià(
»suÉ
 > 0)

648 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
»suÉ
);

649  
»suÉ
;

650 
	}
}

652 
¢d_pcm_säames_t
 
	$¢d_pcm_iİlug_wr™ei
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

654 ià(
pcm
->
mm­_rw
)

655  
	`¢d_pcm_mm­_wr™ei
(
pcm
, 
bufãr
, 
size
);

657 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

658 
	`¢d_pcm_¬—s_äom_buf
(
pcm
, 
¬—s
, (*)
bufãr
);

659  
	`¢d_pcm_wr™e_¬—s
(
pcm
, 
¬—s
, 0, 
size
,

660 
iİlug_´iv_Œªsãr_¬—s
);

662 
	}
}

664 
¢d_pcm_säames_t
 
	$¢d_pcm_iİlug_wr™’
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

666 ià(
pcm
->
mm­_rw
)

667  
	`¢d_pcm_mm­_wr™’
(
pcm
, 
bufs
, 
size
);

669 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

670 
	`¢d_pcm_¬—s_äom_bufs
(
pcm
, 
¬—s
, 
bufs
);

671  
	`¢d_pcm_wr™e_¬—s
(
pcm
, 
¬—s
, 0, 
size
,

672 
iİlug_´iv_Œªsãr_¬—s
);

674 
	}
}

676 
¢d_pcm_säames_t
 
	$¢d_pcm_iİlug_»adi
(
¢d_pcm_t
 *
pcm
, *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

678 ià(
pcm
->
mm­_rw
)

679  
	`¢d_pcm_mm­_»adi
(
pcm
, 
bufãr
, 
size
);

681 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

682 
	`¢d_pcm_¬—s_äom_buf
(
pcm
, 
¬—s
, 
bufãr
);

683  
	`¢d_pcm_»ad_¬—s
(
pcm
, 
¬—s
, 0, 
size
,

684 
iİlug_´iv_Œªsãr_¬—s
);

686 
	}
}

688 
¢d_pcm_säames_t
 
	$¢d_pcm_iİlug_»adn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

690 ià(
pcm
->
mm­_rw
)

691  
	`¢d_pcm_mm­_»adn
(
pcm
, 
bufs
, 
size
);

693 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

694 
	`¢d_pcm_¬—s_äom_bufs
(
pcm
, 
¬—s
, 
bufs
);

695  
	`¢d_pcm_»ad_¬—s
(
pcm
, 
¬—s
, 0, 
size
,

696 
iİlug_´iv_Œªsãr_¬—s
);

698 
	}
}

700 
	$¢d_pcm_iİlug_mm­_begš_ÿ±u»
(
¢d_pcm_t
 *
pcm
,

701 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 **
¬—s
,

702 
¢d_pcm_uäames_t
 *
off£t
,

703 
¢d_pcm_uäames_t
 *
äames
)

705 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

706 
”r
;

708 
”r
 = 
	`__¢d_pcm_mm­_begš_g’”ic
(
pcm
, 
¬—s
, 
off£t
, 
äames
);

709 ià(
”r
 < 0)

710  
”r
;

712 ià(
io
->
d©a
->
ÿÎback
->
Œªsãr
 &&

713 
pcm
->
acûss
 !ğ
SND_PCM_ACCESS_RW_INTERLEAVED
 &&

714 
pcm
->
acûss
 !ğ
SND_PCM_ACCESS_RW_NONINTERLEAVED
) {

715 
¢d_pcm_säames_t
 
»suÉ
;

716 
»suÉ
 = 
io
->
d©a
->
ÿÎback
->
	`Œªsãr
(io->d©a, *
¬—s
, *
off£t
, *
äames
);

717 ià(
»suÉ
 < 0)

718  
»suÉ
;

721  
”r
;

722 
	}
}

724 
	$¢d_pcm_iİlug_mm­_begš
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 **
¬—s
,

725 
¢d_pcm_uäames_t
 *
off£t
, snd_pcm_uäames_ˆ*
äames
)

727 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

728  
	`__¢d_pcm_mm­_begš_g’”ic
(
pcm
, 
¬—s
, 
off£t
, 
äames
);

729  
	`¢d_pcm_iİlug_mm­_begš_ÿ±u»
(
pcm
, 
¬—s
, 
off£t
, 
äames
);

730 
	}
}

732 
¢d_pcm_säames_t
 
	$¢d_pcm_iİlug_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

733 
¢d_pcm_uäames_t
 
off£t
,

734 
¢d_pcm_uäames_t
 
size
)

736 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
 &&

737 
pcm
->
acûss
 !ğ
SND_PCM_ACCESS_RW_INTERLEAVED
 &&

738 
pcm
->
acûss
 !ğ
SND_PCM_ACCESS_RW_NONINTERLEAVED
) {

739 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
;

740 
¢d_pcm_uäames_t
 
ofs
, 
äames
 = 
size
;

742 
	`__¢d_pcm_mm­_begš_g’”ic
(
pcm
, &
¬—s
, &
ofs
, &
äames
);

743 ià(
ofs
 !ğ
off£t
)

744  -
EIO
;

745  
	`iİlug_´iv_Œªsãr_¬—s
(
pcm
, 
¬—s
, 
off£t
, 
äames
);

748 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
size
);

749  
size
;

750 
	}
}

752 
¢d_pcm_säames_t
 
	$¢d_pcm_iİlug_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

754 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

755 
¢d_pcm_uäames_t
 
ava
;

757 
	`¢d_pcm_iİlug_hw_±r_upd©e
(
pcm
);

758 ià(
io
->
d©a
->
¡©e
 =ğ
SND_PCM_STATE_XRUN
)

759  -
EPIPE
;

761 
ava
 = 
	`¢d_pcm_mm­_ava
(
pcm
);

762 ià(
ava
 > 
io
->
ava_max
)

763 
io
->
ava_max
 = 
ava
;

764  (
¢d_pcm_säames_t
)
ava
;

765 
	}
}

767 
	$¢d_pcm_iİlug_nÚblock
(
¢d_pcm_t
 *
pcm
, 
nÚblock
)

769 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

771 
io
->
d©a
->
nÚblock
 =‚onblock;

773 
	}
}

775 
	$¢d_pcm_iİlug_pŞl_desütÜs_couÁ
(
¢d_pcm_t
 *
pcm
)

777 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

778 
”r
 = 1;

780 ià(
io
->
d©a
->
ÿÎback
->
pŞl_desütÜs_couÁ
) {

781 
	`¢d_pcm_uÆock
(
pcm
);

782 
”r
 = 
io
->
d©a
->
ÿÎback
->
	`pŞl_desütÜs_couÁ
(io->data);

783 
	`¢d_pcm_lock
(
pcm
);

785  
”r
;

786 
	}
}

788 
	$¢d_pcm_iİlug_pŞl_desütÜs
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
¥aû
)

790 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

791 
”r
;

793 ià(
io
->
d©a
->
ÿÎback
->
pŞl_desütÜs
) {

794 
	`¢d_pcm_uÆock
(
pcm
);

795 
”r
 = 
io
->
d©a
->
ÿÎback
->
	`pŞl_desütÜs
(io->d©a, 
pfds
, 
¥aû
);

796 
	`¢d_pcm_lock
(
pcm
);

797  
”r
;

799 ià(
pcm
->
pŞl_fd
 < 0)

800  -
EIO
;

801 ià(
¥aû
 >ğ1 && 
pfds
) {

802 
pfds
->
fd
 = 
pcm
->
pŞl_fd
;

803 
pfds
->
ev’ts
 = 
pcm
->
pŞl_ev’ts
 | 
POLLERR
 | 
POLLNVAL
;

808 
	}
}

810 
	$¢d_pcm_iİlug_pŞl_»v’ts
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

812 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

813 
”r
;

815 ià(
io
->
d©a
->
ÿÎback
->
pŞl_»v’ts
) {

816 
	`¢d_pcm_uÆock
(
pcm
);

817 
”r
 = 
io
->
d©a
->
ÿÎback
->
	`pŞl_»v’ts
(io->d©a, 
pfds
, 
nfds
, 
»v’ts
);

818 
	`¢d_pcm_lock
(
pcm
);

820 *
»v’ts
 = 
pfds
->revents;

821 
”r
 = 0;

823  
”r
;

824 
	}
}

826 
	$¢d_pcm_iİlug_mm­
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

829 
	}
}

831 
	$¢d_pcm_iİlug_async
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

832 
sig
 
ATTRIBUTE_UNUSED
,

833 
pid_t
 
pid
 
ATTRIBUTE_UNUSED
)

835  -
ENOSYS
;

836 
	}
}

838 
	$¢d_pcm_iİlug_munm­
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

841 
	}
}

843 
¢d_pcm_chm­_qu”y_t
 **
	$¢d_pcm_iİlug_qu”y_chm­s
(
¢d_pcm_t
 *
pcm
)

845 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

847 ià(
io
->
d©a
->
v”siÚ
 >= 0x010002 &&

848 
io
->
d©a
->
ÿÎback
->
qu”y_chm­s
)

849  
io
->
d©a
->
ÿÎback
->
	`qu”y_chm­s
(io->data);

850  
NULL
;

851 
	}
}

853 
¢d_pcm_chm­_t
 *
	$¢d_pcm_iİlug_g‘_chm­
(
¢d_pcm_t
 *
pcm
)

855 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

857 ià(
io
->
d©a
->
v”siÚ
 >= 0x010002 &&

858 
io
->
d©a
->
ÿÎback
->
g‘_chm­
)

859  
io
->
d©a
->
ÿÎback
->
	`g‘_chm­
(io->data);

860  
NULL
;

861 
	}
}

863 
	$¢d_pcm_iİlug_£t_chm­
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chm­_t
 *
m­
)

865 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

867 ià(
io
->
d©a
->
v”siÚ
 >= 0x010002 &&

868 
io
->
d©a
->
ÿÎback
->
£t_chm­
)

869  
io
->
d©a
->
ÿÎback
->
	`£t_chm­
(io->d©a, 
m­
);

870  -
ENXIO
;

871 
	}
}

873 
	$¢d_pcm_iİlug_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

875 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

877 ià(
io
->
d©a
->
ÿÎback
->
dump
)

878 
io
->
d©a
->
ÿÎback
->
	`dump
(io->d©a, 
out
);

880 ià(
io
->
d©a
->
Çme
)

881 
	`¢d_ouut_´štf
(
out
, "%s\n", 
io
->
d©a
->
Çme
);

883 
	`¢d_ouut_´štf
(
out
, "IO-PCM Plugin\n");

884 ià(
pcm
->
£tup
) {

885 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

886 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

889 
	}
}

891 
	$ş—r_io_·¿ms
(
iİlug_´iv_t
 *
io
)

893 
i
;

894 
i
 = 0; i < 
SND_PCM_IOPLUG_HW_PARAMS
; i++)

895 
	`¢d_ext_·rm_ş—r
(&
io
->
·¿ms
[
i
]);

896 
	}
}

898 
	$¢d_pcm_iİlug_şo£
(
¢d_pcm_t
 *
pcm
)

900 
iİlug_´iv_t
 *
io
 = 
pcm
->
´iv©e_d©a
;

902 
	`ş—r_io_·¿ms
(
io
);

903 ià(
io
->
d©a
->
ÿÎback
->
şo£
)

904 
io
->
d©a
->
ÿÎback
->
	`şo£
(io->data);

905 
	`ä“
(
io
);

908 
	}
}

910 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_iİlug_İs
 = {

911 .
şo£
 = 
¢d_pcm_iİlug_şo£
,

912 .
	gnÚblock
 = 
¢d_pcm_iİlug_nÚblock
,

913 .
	gasync
 = 
¢d_pcm_iİlug_async
,

914 .
	gšfo
 = 
¢d_pcm_iİlug_šfo
,

915 .
	ghw_»fše
 = 
¢d_pcm_iİlug_hw_»fše
,

916 .
	ghw_·¿ms
 = 
¢d_pcm_iİlug_hw_·¿ms
,

917 .
	ghw_ä“
 = 
¢d_pcm_iİlug_hw_ä“
,

918 .
	gsw_·¿ms
 = 
¢d_pcm_iİlug_sw_·¿ms
,

919 .
	gchªÃl_šfo
 = 
¢d_pcm_iİlug_chªÃl_šfo
,

920 .
	gdump
 = 
¢d_pcm_iİlug_dump
,

921 .
	gmm­
 = 
¢d_pcm_iİlug_mm­
,

922 .
	gmunm­
 = 
¢d_pcm_iİlug_munm­
,

923 .
	gqu”y_chm­s
 = 
¢d_pcm_iİlug_qu”y_chm­s
,

924 .
	gg‘_chm­
 = 
¢d_pcm_iİlug_g‘_chm­
,

925 .
	g£t_chm­
 = 
¢d_pcm_iİlug_£t_chm­
,

928 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_iİlug_ç¡_İs
 = {

929 .
¡©us
 = 
¢d_pcm_iİlug_¡©us
,

930 .
	g´•¬e
 = 
¢d_pcm_iİlug_´•¬e
,

931 .
	g»£t
 = 
¢d_pcm_iİlug_»£t
,

932 .
	g¡¬t
 = 
¢d_pcm_iİlug_¡¬t
,

933 .
	gdrİ
 = 
¢d_pcm_iİlug_drİ
,

934 .
	gd¿š
 = 
¢d_pcm_iİlug_d¿š
,

935 .
	g·u£
 = 
¢d_pcm_iİlug_·u£
,

936 .
	g¡©e
 = 
¢d_pcm_iİlug_¡©e
,

937 .
	ghwsync
 = 
¢d_pcm_iİlug_hwsync
,

938 .
	gd–ay
 = 
¢d_pcm_iİlug_d–ay
,

939 .
	g»sume
 = 
¢d_pcm_iİlug_»sume
,

940 .
	glšk
 = 
NULL
,

941 .
	glšk_¦aves
 = 
NULL
,

942 .
	guÆšk
 = 
NULL
,

943 .
	g»wšdabË
 = 
¢d_pcm_iİlug_»wšdabË
,

944 .
	g»wšd
 = 
¢d_pcm_iİlug_»wšd
,

945 .
	gfÜw¬dabË
 = 
¢d_pcm_iİlug_fÜw¬dabË
,

946 .
	gfÜw¬d
 = 
¢d_pcm_iİlug_fÜw¬d
,

947 .
	gwr™ei
 = 
¢d_pcm_iİlug_wr™ei
,

948 .
	gwr™’
 = 
¢d_pcm_iİlug_wr™’
,

949 .
	g»adi
 = 
¢d_pcm_iİlug_»adi
,

950 .
	g»adn
 = 
¢d_pcm_iİlug_»adn
,

951 .
	gava_upd©e
 = 
¢d_pcm_iİlug_ava_upd©e
,

952 .
	gmm­_comm™
 = 
¢d_pcm_iİlug_mm­_comm™
,

953 .
	ghtime¡amp
 = 
¢d_pcm_g’”ic_»®_htime¡amp
,

954 .
	gpŞl_desütÜs_couÁ
 = 
¢d_pcm_iİlug_pŞl_desütÜs_couÁ
,

955 .
	gpŞl_desütÜs
 = 
¢d_pcm_iİlug_pŞl_desütÜs
,

956 .
	gpŞl_»v’ts
 = 
¢d_pcm_iİlug_pŞl_»v’ts
,

957 .
	gmm­_begš
 = 
¢d_pcm_iİlug_mm­_begš
,

1074 
	$¢d_pcm_iİlug_ü—‹
(
¢d_pcm_iİlug_t
 *
iİlug
, cÚ¡ *
Çme
,

1075 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

1077 
iİlug_´iv_t
 *
io
;

1078 
”r
;

1079 
¢d_pcm_t
 *
pcm
;

1081 
	`as£¹
(
iİlug
 && iİlug->
ÿÎback
);

1082 
	`as£¹
(
iİlug
->
ÿÎback
->
¡¬t
 &&

1083 
iİlug
->
ÿÎback
->
¡İ
 &&

1084 
iİlug
->
ÿÎback
->
poš‹r
);

1087 ià(
iİlug
->
v”siÚ
 < 0x010000 ||

1088 
iİlug
->
v”siÚ
 > 
SND_PCM_IOPLUG_VERSION
) {

1089 
	`SNDERR
("ioplug: Plugin version mismatch: 0x%x",

1090 
iİlug
->
v”siÚ
);

1091  -
ENXIO
;

1094 
io
 = 
	`ÿÎoc
(1, (*io));

1095 ià(! 
io
)

1096  -
ENOMEM
;

1098 
io
->
d©a
 = 
iİlug
;

1099 
iİlug
->
¡©e
 = 
SND_PCM_STATE_OPEN
;

1100 
iİlug
->
¡»am
 = stream;

1102 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_IOPLUG
, 
Çme
, 
¡»am
, 
mode
);

1103 ià(
”r
 < 0) {

1104 
	`ä“
(
io
);

1105  
”r
;

1108 
iİlug
->
pcm
 =…cm;

1109 
pcm
->
İs
 = &
¢d_pcm_iİlug_İs
;

1110 
pcm
->
ç¡_İs
 = &
¢d_pcm_iİlug_ç¡_İs
;

1111 
pcm
->
´iv©e_d©a
 = 
io
;

1113 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
iİlug
->
hw_±r
, -1, 0);

1114 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
iİlug
->
­¶_±r
, -1, 0);

1116 
	`¢d_pcm_iİlug_»š™_¡©us
(
iİlug
);

1119 
	}
}

1126 
	$¢d_pcm_iİlug_d–‘e
(
¢d_pcm_iİlug_t
 *
iİlug
)

1128  
	`¢d_pcm_şo£
(
iİlug
->
pcm
);

1129 
	}
}

1138 
	$¢d_pcm_iİlug_·¿ms_»£t
(
¢d_pcm_iİlug_t
 *
iİlug
)

1140 
iİlug_´iv_t
 *
io
 = 
iİlug
->
pcm
->
´iv©e_d©a
;

1141 
	`ş—r_io_·¿ms
(
io
);

1142 
	}
}

1155 
	$¢d_pcm_iİlug_£t_·¿m_li¡
(
¢d_pcm_iİlug_t
 *
iİlug
, 
ty³
, 
num_li¡
, cÚ¡ *
li¡
)

1157 
iİlug_´iv_t
 *
io
 = 
iİlug
->
pcm
->
´iv©e_d©a
;

1158 ià(
ty³
 < 0 ||y³ >ğ
SND_PCM_IOPLUG_HW_PARAMS
) {

1159 
	`SNDERR
("IOPLUG: inv®id…¬am‘”y³ %d", 
ty³
);

1160  -
EINVAL
;

1162 ià(
ty³
 =ğ
SND_PCM_IOPLUG_HW_PERIODS
)

1163 
io
->
·¿ms
[
ty³
].
š‹g”
 = 1;

1164  
	`¢d_ext_·rm_£t_li¡
(&
io
->
·¿ms
[
ty³
], 
num_li¡
, 
li¡
);

1165 
	}
}

1179 
	$¢d_pcm_iİlug_£t_·¿m_mšmax
(
¢d_pcm_iİlug_t
 *
iİlug
, 
ty³
, 
mš
, 
max
)

1181 
iİlug_´iv_t
 *
io
 = 
iİlug
->
pcm
->
´iv©e_d©a
;

1182 ià(
ty³
 < 0 ||y³ >ğ
SND_PCM_IOPLUG_HW_PARAMS
) {

1183 
	`SNDERR
("IOPLUG: inv®id…¬am‘”y³ %d", 
ty³
);

1184  -
EINVAL
;

1186 ià(
ty³
 =ğ
SND_PCM_IOPLUG_HW_ACCESS
 ||y³ =ğ
SND_PCM_IOPLUG_HW_FORMAT
) {

1187 
	`SNDERR
("IOPLUG: inv®id…¬am‘”y³ %d", 
ty³
);

1188  -
EINVAL
;

1190 ià(
ty³
 =ğ
SND_PCM_IOPLUG_HW_PERIODS
)

1191 
io
->
·¿ms
[
ty³
].
š‹g”
 = 1;

1192  
	`¢d_ext_·rm_£t_mšmax
(&
io
->
·¿ms
[
ty³
], 
mš
, 
max
);

1193 
	}
}

1204 
	$¢d_pcm_iİlug_»š™_¡©us
(
¢d_pcm_iİlug_t
 *
iİlug
)

1206 
iİlug
->
pcm
->
pŞl_fd
 = ioplug->poll_fd;

1207 
iİlug
->
pcm
->
pŞl_ev’ts
 = ioplug->poll_events;

1208 ià(
iİlug
->
æags
 & 
SND_PCM_IOPLUG_FLAG_MONOTONIC
)

1209 
iİlug
->
pcm
->
t¡amp_ty³
 = 
SND_PCM_TSTAMP_TYPE_MONOTONIC
;

1211 
iİlug
->
pcm
->
t¡amp_ty³
 = 
SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY
;

1212 
iİlug
->
pcm
->
mm­_rw
 = ioplug->mmap_rw;

1214 
	}
}

1224 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
	$¢d_pcm_iİlug_mm­_¬—s
(
¢d_pcm_iİlug_t
 *
iİlug
)

1226 ià(
iİlug
->
mm­_rw
)

1227  
	`¢d_pcm_mm­_¬—s
(
iİlug
->
pcm
);

1228  
NULL
;

1229 
	}
}

1241 
	$¢d_pcm_iİlug_£t_¡©e
(
¢d_pcm_iİlug_t
 *
iİlug
, 
¢d_pcm_¡©e_t
 
¡©e
)

1243 
iİlug
->
¡©e
 = state;

1245 
	}
}

1255 
¢d_pcm_uäames_t
 
	$¢d_pcm_iİlug_ava
(cÚ¡ 
¢d_pcm_iİlug_t
 * cÚ¡ 
iİlug
,

1256 cÚ¡ 
¢d_pcm_uäames_t
 
hw_±r
,

1257 cÚ¡ 
¢d_pcm_uäames_t
 
­¶_±r
)

1259  
	`__¢d_pcm_ava
(
iİlug
->
pcm
, 
hw_±r
, 
­¶_±r
);

1260 
	}
}

1270 
¢d_pcm_uäames_t
 
	$¢d_pcm_iİlug_hw_ava
(cÚ¡ 
¢d_pcm_iİlug_t
 * cÚ¡ 
iİlug
,

1271 cÚ¡ 
¢d_pcm_uäames_t
 
hw_±r
,

1272 cÚ¡ 
¢d_pcm_uäames_t
 
­¶_±r
)

1277 cÚ¡ 
¢d_pcm_uäames_t
 
u£r_ava
 = 
	`¢d_pcm_iİlug_ava
(
iİlug
,

1278 
hw_±r
,

1279 
­¶_±r
);

1281 ià(
u£r_ava
 > 
iİlug
->
pcm
->
bufãr_size
) {

1286  
iİlug
->
pcm
->
bufãr_size
 - 
u£r_ava
;

1287 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_ladspa.c

35 
	~"pcm_loÿl.h
"

36 
	~"pcm_¶ugš.h
"

37 
	~<dœ’t.h
>

38 
	~<loÿË.h
>

39 
	~<m©h.h
>

41 
	~"Ïd¥a.h
"

43 #iâdeà
PIC


45 cÚ¡ *
	g_¢d_moduË_pcm_Ïd¥a
 = "";

48 #iâdeà
DOC_HIDDEN


50 
	#NO_ASSIGN
 0xffffffff

	)

52 
	e_¢d_pcm_Ïd¥a_pŞicy
 {

53 
	mSND_PCM_LADSPA_POLICY_NONE
,

54 
	mSND_PCM_LADSPA_POLICY_DUPLICATE


55 } 
	t¢d_pcm_Ïd¥a_pŞicy_t
;

59 
¢d_pcm_¶ugš_t
 
	m¶ug
;

61 
li¡_h—d
 
	mµlugšs
;

62 
li¡_h—d
 
	mılugšs
;

63 
	mchªÃls
;

64 
	m®loÿ‹d
;

65 
LADSPA_D©a
 *
	mz”o
[2];

66 } 
	t¢d_pcm_Ïd¥a_t
;

69 
	msize
;

70 *
	m¬¿y
;

71 } 
	t¢d_pcm_Ïd¥a_¬¿y_t
;

74 
¢d_pcm_Ïd¥a_¬¿y_t
 
	mchªÃls
;

75 
¢d_pcm_Ïd¥a_¬¿y_t
 
	mpÜts
;

76 
LADSPA_D©a
 **
	mm_d©a
;

77 
LADSPA_D©a
 **
	md©a
;

78 } 
	t¢d_pcm_Ïd¥a_•s_t
;

80 
	s¢d_pcm_Ïd¥a_š¡ªû
 {

81 
li¡_h—d
 
	mli¡
;

82 cÚ¡ 
LADSPA_DesütÜ
 *
	mdesc
;

83 
LADSPA_HªdË
 *
	mhªdË
;

84 
	md•th
;

85 
¢d_pcm_Ïd¥a_•s_t
 
	mšput
;

86 
¢d_pcm_Ïd¥a_•s_t
 
	mouut
;

87 
¢d_pcm_Ïd¥a_š¡ªû
 *
	m´ev
;

88 
¢d_pcm_Ïd¥a_š¡ªû
 *
	mÃxt
;

89 } 
	t¢d_pcm_Ïd¥a_š¡ªû_t
;

92 
LADSPA_PÜtDesütÜ
 
	mpdesc
;

93 
	mpÜt_bšdšgs_size
;

94 *
	mpÜt_bšdšgs
;

95 
	mcÚŒŞs_size
;

96 *
	mcÚŒŞs_š™Ÿlized
;

97 
LADSPA_D©a
 *
	mcÚŒŞs
;

98 } 
	t¢d_pcm_Ïd¥a_¶ugš_io_t
;

101 
li¡_h—d
 
	mli¡
;

102 
¢d_pcm_Ïd¥a_pŞicy_t
 
	mpŞicy
;

103 *
	mf’ame
;

104 *
	mdl_hªdË
;

105 cÚ¡ 
LADSPA_DesütÜ
 *
	mdesc
;

106 
¢d_pcm_Ïd¥a_¶ugš_io_t
 
	mšput
;

107 
¢d_pcm_Ïd¥a_¶ugš_io_t
 
	mouut
;

108 
li¡_h—d
 
	mš¡ªûs
;

109 } 
	t¢d_pcm_Ïd¥a_¶ugš_t
;

113 
	$¢d_pcm_Ïd¥a_couÁ_pÜts
(
¢d_pcm_Ïd¥a_¶ugš_t
 *
Ílug
,

114 
LADSPA_PÜtDesütÜ
 
pdesc
)

116 
»s
 = 0, 
idx
;

117 
idx
 = 0; idx < 
Ílug
->
desc
->
PÜtCouÁ
; idx++) {

118 ià((
Ílug
->
desc
->
PÜtDesütÜs
[
idx
] & 
pdesc
) ==…desc)

119 
»s
++;

121  
»s
;

122 
	}
}

124 
	$¢d_pcm_Ïd¥a_fšd_pÜt
(*
»s
,

125 
¢d_pcm_Ïd¥a_¶ugš_t
 *
Ílug
,

126 
LADSPA_PÜtDesütÜ
 
pdesc
,

127 
pÜt_idx
)

129 
idx
;

131 
idx
 = 0; idx < 
Ílug
->
desc
->
PÜtCouÁ
; idx++)

132 ià((
Ílug
->
desc
->
PÜtDesütÜs
[
idx
] & 
pdesc
) ==…desc) {

133 ià(
pÜt_idx
 == 0) {

134 *
»s
 = 
idx
;

137 
pÜt_idx
--;

139  -
EINVAL
;

140 
	}
}

142 
	$¢d_pcm_Ïd¥a_fšd_¥Üt
(*
»s
,

143 
¢d_pcm_Ïd¥a_¶ugš_t
 *
Ílug
,

144 
LADSPA_PÜtDesütÜ
 
pdesc
,

145 cÚ¡ *
pÜt_Çme
)

147 
idx
;

149 
idx
 = 0; idx < 
Ílug
->
desc
->
PÜtCouÁ
; idx++)

150 ià((
Ílug
->
desc
->
PÜtDesütÜs
[
idx
] & 
pdesc
) ==…desc &&

151 !
	`¡rcmp
(
Ílug
->
desc
->
PÜtNames
[
idx
], 
pÜt_Çme
)) {

152 *
»s
 = 
idx
;

155  -
EINVAL
;

156 
	}
}

158 
	$¢d_pcm_Ïd¥a_fšd_pÜt_idx
(*
»s
,

159 
¢d_pcm_Ïd¥a_¶ugš_t
 *
Ílug
,

160 
LADSPA_PÜtDesütÜ
 
pdesc
,

161 
pÜt
)

163 
idx
;

164 
r
 = 0;

166 ià(
pÜt
 >ğ
Ílug
->
desc
->
PÜtCouÁ
)

167  -
EINVAL
;

168 
idx
 = 0; idx < 
pÜt
; idx++)

169 ià((
Ílug
->
desc
->
PÜtDesütÜs
[
idx
] & 
pdesc
) ==…desc)

170 
r
++;

171 *
»s
 = 
r
;

173 
	}
}

175 
	$¢d_pcm_Ïd¥a_ä“_io
(
¢d_pcm_Ïd¥a_¶ugš_io_t
 *
io
)

177 
	`ä“
(
io
->
cÚŒŞs
);

178 
	`ä“
(
io
->
cÚŒŞs_š™Ÿlized
);

179 
	}
}

181 
	$¢d_pcm_Ïd¥a_ä“_¶ugšs
(
li¡_h—d
 *
¶ugšs
)

183 !
	`li¡_em±y
(
¶ugšs
)) {

184 
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
 = 
	`li¡_’Œy
(
¶ugšs
->
Ãxt
, snd_pcm_Ïd¥a_¶ugš_t, 
li¡
);

185 
	`¢d_pcm_Ïd¥a_ä“_io
(&
¶ugš
->
šput
);

186 
	`¢d_pcm_Ïd¥a_ä“_io
(&
¶ugš
->
ouut
);

187 ià(
¶ugš
->
dl_hªdË
)

188 
	`dlşo£
(
¶ugš
->
dl_hªdË
);

189 
	`ä“
(
¶ugš
->
f’ame
);

190 
	`li¡_d–
(&
¶ugš
->
li¡
);

191 
	`ä“
(
¶ugš
);

193 
	}
}

195 
	$¢d_pcm_Ïd¥a_ä“
(
¢d_pcm_Ïd¥a_t
 *
Ïd¥a
)

197 
idx
;

199 
	`¢d_pcm_Ïd¥a_ä“_¶ugšs
(&
Ïd¥a
->
µlugšs
);

200 
	`¢d_pcm_Ïd¥a_ä“_¶ugšs
(&
Ïd¥a
->
ılugšs
);

201 
idx
 = 0; idx < 2; idx++) {

202 
	`ä“
(
Ïd¥a
->
z”o
[
idx
]);

203 
Ïd¥a
->
z”o
[
idx
] = 
NULL
;

205 
Ïd¥a
->
®loÿ‹d
 = 0;

206 
	}
}

208 
	$¢d_pcm_Ïd¥a_şo£
(
¢d_pcm_t
 *
pcm
)

210 
¢d_pcm_Ïd¥a_t
 *
Ïd¥a
 = 
pcm
->
´iv©e_d©a
;

212 
	`¢d_pcm_Ïd¥a_ä“
(
Ïd¥a
);

213  
	`¢d_pcm_g’”ic_şo£
(
pcm
);

214 
	}
}

216 
	$¢d_pcm_Ïd¥a_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

218 
¢d_pcm_Ïd¥a_t
 *
Ïd¥a
 = 
pcm
->
´iv©e_d©a
;

219 
”r
;

220 
¢d_pcm_acûss_mask_t
 
acûss_mask
 = { 
SND_PCM_ACCBIT_SHMN
 };

221 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

222 &
acûss_mask
);

223 ià(
”r
 < 0)

224  
”r
;

225 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
·¿ms
, 
SND_PCM_FORMAT_FLOAT
);

226 ià(
”r
 < 0)

227  
”r
;

228 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
·¿ms
, 
SND_PCM_SUBFORMAT_STD
);

229 ià(
”r
 < 0)

230  
”r
;

231 ià(
Ïd¥a
->
chªÃls
 > 0 && 
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

232 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t
(
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
Ïd¥a
->
chªÃls
, 0);

233 ià(
”r
 < 0)

234  
”r
;

236 
·¿ms
->
šfo
 &ğ~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

238 
	}
}

240 
	$¢d_pcm_Ïd¥a_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

242 
¢d_pcm_Ïd¥a_t
 *
Ïd¥a
 = 
pcm
->
´iv©e_d©a
;

243 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAPN
 };

244 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

245 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

246 &
§cûss_mask
);

247 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
¥¬ams
, 
SND_PCM_FORMAT_FLOAT
);

248 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¥¬ams
, 
SND_PCM_SUBFORMAT_STD
);

249 ià(
Ïd¥a
->
chªÃls
 > 0 && 
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
)

250 
	`_¢d_pcm_hw_·¿m_£t
(
¥¬ams
, 
SND_PCM_HW_PARAM_CHANNELS
, 
Ïd¥a
->
chªÃls
, 0);

252 
	}
}

254 
	$¢d_pcm_Ïd¥a_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

255 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

257 
”r
;

258 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

259 
SND_PCM_HW_PARBIT_RATE
 |

260 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

261 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

262 
SND_PCM_HW_PARBIT_PERIODS
 |

263 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

264 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

265 
SND_PCM_HW_PARBIT_TICK_TIME
);

266 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

267 ià(
”r
 < 0)

268  
”r
;

270 
	}
}

272 
	$¢d_pcm_Ïd¥a_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

273 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

275 
”r
;

276 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

277 
SND_PCM_HW_PARBIT_RATE
 |

278 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

279 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

280 
SND_PCM_HW_PARBIT_PERIODS
 |

281 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

282 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

283 
SND_PCM_HW_PARBIT_TICK_TIME
);

284 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

285 ià(
”r
 < 0)

286  
”r
;

288 
	}
}

290 
	$¢d_pcm_Ïd¥a_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

292  
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

293 
¢d_pcm_Ïd¥a_hw_»fše_ı»·»
,

294 
¢d_pcm_Ïd¥a_hw_»fše_cchªge
,

295 
¢d_pcm_Ïd¥a_hw_»fše_¥»·»
,

296 
¢d_pcm_Ïd¥a_hw_»fše_schªge
,

297 
¢d_pcm_g’”ic_hw_»fše
);

298 
	}
}

300 
	$¢d_pcm_Ïd¥a_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 * 
·¿ms
)

303 
”r
 = 
	`¢d_pcm_hw_·¿ms_¦ave
(
pcm
, 
·¿ms
,

304 
¢d_pcm_Ïd¥a_hw_»fše_cchªge
,

305 
¢d_pcm_Ïd¥a_hw_»fše_¥»·»
,

306 
¢d_pcm_Ïd¥a_hw_»fše_schªge
,

307 
¢d_pcm_g’”ic_hw_·¿ms
);

308 ià(
”r
 < 0)

309  
”r
;

311 
	}
}

313 
	$¢d_pcm_Ïd¥a_ä“_•s
(
¢d_pcm_Ïd¥a_•s_t
 *
•s
)

315 
	`ä“
(
•s
->
chªÃls
.
¬¿y
);

316 
	`ä“
(
•s
->
pÜts
.
¬¿y
);

317 
	}
}

319 
	$¢d_pcm_Ïd¥a_ä“_š¡ªûs
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_Ïd¥a_t
 *
Ïd¥a
, 
ş—nup
)

321 
li¡_h—d
 *
li¡
, *
pos
, *
pos1
, *
Ãxt1
;

322 
idx
;

324 
li¡
 = 
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
 ? &
Ïd¥a
->
µlugšs
 : &Ïd¥a->
ılugšs
;

325 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

326 
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
 = 
	`li¡_’Œy
(
pos
, snd_pcm_Ïd¥a_¶ugš_t, 
li¡
);

327 
	`li¡_fÜ_—ch_§ã
(
pos1
, 
Ãxt1
, &
¶ugš
->
š¡ªûs
) {

328 
¢d_pcm_Ïd¥a_š¡ªû_t
 *
š¡ªû
 = 
	`li¡_’Œy
(
pos1
, snd_pcm_Ïd¥a_š¡ªû_t, 
li¡
);

329 ià(
¶ugš
->
desc
->
d—ùiv©e
)

330 
¶ugš
->
desc
->
	`d—ùiv©e
(
š¡ªû
->
hªdË
);

331 ià(
ş—nup
) {

332 ià(
¶ugš
->
desc
->
ş—nup
)

333 
¶ugš
->
desc
->
	`ş—nup
(
š¡ªû
->
hªdË
);

334 ià(
š¡ªû
->
šput
.
m_d©a
) {

335 
idx
 = 0; idx < 
š¡ªû
->
šput
.
chªÃls
.
size
; idx++)

336 
	`ä“
(
š¡ªû
->
šput
.
m_d©a
[
idx
]);

337 
	`ä“
(
š¡ªû
->
šput
.
m_d©a
);

339 ià(
š¡ªû
->
ouut
.
m_d©a
) {

340 
idx
 = 0; idx < 
š¡ªû
->
ouut
.
chªÃls
.
size
; idx++)

341 
	`ä“
(
š¡ªû
->
ouut
.
m_d©a
[
idx
]);

342 
	`ä“
(
š¡ªû
->
ouut
.
m_d©a
);

344 
	`ä“
(
š¡ªû
->
šput
.
d©a
);

345 
	`ä“
(
š¡ªû
->
ouut
.
d©a
);

346 
	`li¡_d–
(&(
š¡ªû
->
li¡
));

347 
	`¢d_pcm_Ïd¥a_ä“_•s
(&
š¡ªû
->
šput
);

348 
	`¢d_pcm_Ïd¥a_ä“_•s
(&
š¡ªû
->
ouut
);

349 
	`ä“
(
š¡ªû
);

351 ià(
¶ugš
->
desc
->
aùiv©e
)

352 
¶ugš
->
desc
->
	`aùiv©e
(
š¡ªû
->
hªdË
);

355 ià(
ş—nup
) {

356 
	`as£¹
(
	`li¡_em±y
(&
¶ugš
->
š¡ªûs
));

359 
	}
}

361 
	$¢d_pcm_Ïd¥a_add_to_ÿ¼ay
(
¢d_pcm_Ïd¥a_¬¿y_t
 *
¬¿y
,

362 
idx
,

363 
v®
)

365 *
Ç¼ay
;

366 
idx1
;

368 ià(
idx
 >ğ
¬¿y
->
size
) {

369 
Ç¼ay
 = 
	`»®loc
(
¬¿y
->¬¿y, (è* (
idx
 + 1));

370 ià(
Ç¼ay
 =ğ
NULL
)

371  -
ENOMEM
;

372 
idx1
 = 
¬¿y
->
size
; idx1 < 
idx
; idx1++)

373 
Ç¼ay
[
idx1
] = 
NO_ASSIGN
;

374 
¬¿y
->¬¿y = 
Ç¼ay
;

375 
¬¿y
->
size
 = 
idx
 + 1;

376 
¬¿y
->¬¿y[
idx
] = 
v®
;

379 ià(
¬¿y
->¬¿y[
idx
] =ğ
NO_ASSIGN
)

380 
¬¿y
->¬¿y[
idx
] = 
v®
;

382  -
EINVAL
;

384 
	}
}

386 
	$¢d_pcm_Ïd¥a_add_to_¬¿y
(
¢d_pcm_Ïd¥a_¬¿y_t
 *
¬¿y
,

387 
idx
,

388 
v®
)

390 *
Ç¼ay
;

391 
idx1
;

393 ià(
idx
 >ğ
¬¿y
->
size
) {

394 
Ç¼ay
 = 
	`»®loc
(
¬¿y
->¬¿y, (è* (
idx
 + 1));

395 ià(
Ç¼ay
 =ğ
NULL
)

396  -
ENOMEM
;

397 
idx1
 = 
¬¿y
->
size
; idx1 < 
idx
; idx1++)

398 
Ç¼ay
[
idx1
] = 
NO_ASSIGN
;

399 
¬¿y
->¬¿y = 
Ç¼ay
;

400 
¬¿y
->
size
 = 
idx
 + 1;

402 
¬¿y
->¬¿y[
idx
] = 
v®
;

404 
	}
}

406 
	$¢d_pcm_Ïd¥a_cÚÃù_¶ugš1
(
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
,

407 
¢d_pcm_Ïd¥a_¶ugš_io_t
 *
io
,

408 
¢d_pcm_Ïd¥a_•s_t
 *
•s
)

410 
pÜt
, 
chªÃls
, 
idx
, 
idx1
;

411 
”r
;

413 
	`as£¹
(
¶ugš
->
pŞicy
 =ğ
SND_PCM_LADSPA_POLICY_NONE
);

414 
chªÃls
 = 
io
->
pÜt_bšdšgs_size
 > 0 ?

415 
io
->
pÜt_bšdšgs_size
 :

416 
	`¢d_pcm_Ïd¥a_couÁ_pÜts
(
¶ugš
, 
io
->
pdesc
 | 
LADSPA_PORT_AUDIO
);

417 
idx
 = 
idx1
 = 0; idx < 
chªÃls
; idx++) {

418 ià(
io
->
pÜt_bšdšgs_size
 > 0)

419 
pÜt
 = 
io
->
pÜt_bšdšgs
[
idx
];

421 
”r
 = 
	`¢d_pcm_Ïd¥a_fšd_pÜt
(&
pÜt
, 
¶ugš
, 
io
->
pdesc
 | 
LADSPA_PORT_AUDIO
, 
idx
);

422 ià(
”r
 < 0) {

423 
	`SNDERR
("uÇbËØfšd‡udiØ% pÜˆ%u…lugš '%s'", 
io
->
pdesc
 & 
LADSPA_PORT_INPUT
 ? "šput" : "ouut", 
idx
, 
¶ugš
->
desc
->
Name
);

424  
”r
;

427 ià(
pÜt
 =ğ
NO_ASSIGN
)

429 
”r
 = 
	`¢d_pcm_Ïd¥a_add_to_ÿ¼ay
(&
•s
->
chªÃls
, 
idx1
, 
idx
);

430 ià(
”r
 < 0) {

431 
	`SNDERR
("uÇbËØadd chªÃÈ%u fÜ‡udiØ% ¶ugš '%s'", 
idx
, 
io
->
pdesc
 & 
LADSPA_PORT_INPUT
 ? "šput" : "ouut", 
¶ugš
->
desc
->
Name
);

432  
”r
;

434 
”r
 = 
	`¢d_pcm_Ïd¥a_add_to_¬¿y
(&
•s
->
pÜts
, 
idx1
, 
pÜt
);

435 ià(
”r
 < 0) {

436 
	`SNDERR
("uÇbËØadd…Üˆ%u fÜ‡udiØ% ¶ugš '%s'", 
pÜt
, 
io
->
pdesc
 & 
LADSPA_PORT_INPUT
 ? "šput" : "ouut", 
¶ugš
->
desc
->
Name
);

437  
”r
;

439 
idx1
++;

442 
	}
}

444 
	$¢d_pcm_Ïd¥a_cÚÃù_¶ugš
(
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
,

445 
¢d_pcm_Ïd¥a_š¡ªû_t
 *
š¡ªû
)

447 
”r
;

449 
”r
 = 
	`¢d_pcm_Ïd¥a_cÚÃù_¶ugš1
(
¶ugš
, &¶ugš->
šput
, &
š¡ªû
->input);

450 ià(
”r
 < 0)

451  
”r
;

452 
”r
 = 
	`¢d_pcm_Ïd¥a_cÚÃù_¶ugš1
(
¶ugš
, &¶ugš->
ouut
, &
š¡ªû
->output);

453 ià(
”r
 < 0)

454  
”r
;

456 
	}
}

458 
	$¢d_pcm_Ïd¥a_cÚÃù_¶ugš_du¶iÿ‹1
(
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
,

459 
¢d_pcm_Ïd¥a_¶ugš_io_t
 *
io
,

460 
¢d_pcm_Ïd¥a_•s_t
 *
•s
,

461 
idx
)

463 
pÜt
;

464 
”r
;

466 
	`as£¹
(
¶ugš
->
pŞicy
 =ğ
SND_PCM_LADSPA_POLICY_DUPLICATE
);

467 ià(
io
->
pÜt_bšdšgs_size
 > 0) {

468 
pÜt
 = 
io
->
pÜt_bšdšgs
[0];

470 
”r
 = 
	`¢d_pcm_Ïd¥a_fšd_pÜt
(&
pÜt
, 
¶ugš
, 
io
->
pdesc
 | 
LADSPA_PORT_AUDIO
, 0);

471 ià(
”r
 < 0) {

472 
	`SNDERR
("uÇbËØfšd‡udiØ% pÜˆ%u…lugš '%s'", 
io
->
pdesc
 & 
LADSPA_PORT_INPUT
 ? "šput" : "ouut", ()0, 
¶ugš
->
desc
->
Name
);

473  
”r
;

476 
”r
 = 
	`¢d_pcm_Ïd¥a_add_to_ÿ¼ay
(&
•s
->
chªÃls
, 0, 
idx
);

477 ià(
”r
 < 0) {

478 
	`SNDERR
("uÇbËØadd chªÃÈ%u fÜ‡udiØ% ¶ugš '%s'", 
idx
, 
io
->
pdesc
 & 
LADSPA_PORT_INPUT
 ? "šput" : "ouut", 
¶ugš
->
desc
->
Name
);

479  
”r
;

481 
”r
 = 
	`¢d_pcm_Ïd¥a_add_to_¬¿y
(&
•s
->
pÜts
, 0, 
pÜt
);

482 ià(
”r
 < 0) {

483 
	`SNDERR
("uÇbËØadd…Üˆ%u fÜ‡udiØ% ¶ugš '%s'", 
pÜt
, 
io
->
pdesc
 & 
LADSPA_PORT_INPUT
 ? "šput" : "ouut", 
¶ugš
->
desc
->
Name
);

484  
”r
;

487 
	}
}

489 
	$¢d_pcm_Ïd¥a_cÚÃù_¶ugš_du¶iÿ‹
(
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
,

490 
¢d_pcm_Ïd¥a_¶ugš_io_t
 *
š_io
,

491 
¢d_pcm_Ïd¥a_¶ugš_io_t
 *
out_io
,

492 
¢d_pcm_Ïd¥a_š¡ªû_t
 *
š¡ªû
,

493 
idx
)

495 
”r
;

497 
”r
 = 
	`¢d_pcm_Ïd¥a_cÚÃù_¶ugš_du¶iÿ‹1
(
¶ugš
, 
š_io
, &
š¡ªû
->
šput
, 
idx
);

498 ià(
”r
 < 0)

499  
”r
;

500 
”r
 = 
	`¢d_pcm_Ïd¥a_cÚÃù_¶ugš_du¶iÿ‹1
(
¶ugš
, 
out_io
, &
š¡ªû
->
ouut
, 
idx
);

501 ià(
”r
 < 0)

502  
”r
;

504 
	}
}

506 
	$¢d_pcm_Ïd¥a_g‘_deçuÉ_cv®ue
(cÚ¡ 
LADSPA_DesütÜ
 * 
desc
, 
pÜt
, 
LADSPA_D©a
 *
v®
)

508 
LADSPA_PÜtRªgeHštDesütÜ
 
hdesc
;

510 
hdesc
 = 
desc
->
PÜtRªgeHšts
[
pÜt
].
HštDesütÜ
;

511 
hdesc
 & 
LADSPA_HINT_DEFAULT_MASK
) {

512 
LADSPA_HINT_DEFAULT_MINIMUM
:

513 *
v®
 = 
desc
->
PÜtRªgeHšts
[
pÜt
].
Low”Bound
;

515 
LADSPA_HINT_DEFAULT_LOW
:

516 ià(
	`LADSPA_IS_HINT_LOGARITHMIC
(
hdesc
)) {

517 *
v®
 = 
	`exp
(
	`log
(
desc
->
PÜtRªgeHšts
[
pÜt
].
Low”Bound
)

519 + 
	`log
(
desc
->
PÜtRªgeHšts
[
pÜt
].
Uµ”Bound
)

522 *
v®
 = (
desc
->
PÜtRªgeHšts
[
pÜt
].
Low”Bound
 * 0.75) +

523 (
desc
->
PÜtRªgeHšts
[
pÜt
].
Uµ”Bound
 * 0.25);

526 
LADSPA_HINT_DEFAULT_MIDDLE
:

527 ià(
	`LADSPA_IS_HINT_LOGARITHMIC
(
hdesc
)) {

528 *
v®
 = 
	`sq¹
(
desc
->
PÜtRªgeHšts
[
pÜt
].
Low”Bound
 *

529 
desc
->
PÜtRªgeHšts
[
pÜt
].
Uµ”Bound
);

531 *
v®
 = 0.5 *

532 (
desc
->
PÜtRªgeHšts
[
pÜt
].
Low”Bound
 +

533 
desc
->
PÜtRªgeHšts
[
pÜt
].
Uµ”Bound
);

536 
LADSPA_HINT_DEFAULT_HIGH
:

537 ià(
	`LADSPA_IS_HINT_LOGARITHMIC
(
hdesc
)) {

538 *
v®
 = 
	`exp
(
	`log
(
desc
->
PÜtRªgeHšts
[
pÜt
].
Low”Bound
)

540 + 
	`log
(
desc
->
PÜtRªgeHšts
[
pÜt
].
Uµ”Bound
)

543 *
v®
 = (
desc
->
PÜtRªgeHšts
[
pÜt
].
Low”Bound
 * 0.25) +

544 (
desc
->
PÜtRªgeHšts
[
pÜt
].
Uµ”Bound
 * 0.75);

547 
LADSPA_HINT_DEFAULT_MAXIMUM
:

548 *
v®
 = 
desc
->
PÜtRªgeHšts
[
pÜt
].
Uµ”Bound
;

550 
LADSPA_HINT_DEFAULT_0
:

551 *
v®
 = 0;

553 
LADSPA_HINT_DEFAULT_1
:

554 *
v®
 = 1;

556 
LADSPA_HINT_DEFAULT_100
:

557 *
v®
 = 100;

559 
LADSPA_HINT_DEFAULT_440
:

560 *
v®
 = 440;

563 *
v®
 = 0;

566 
	}
}

568 
	$¢d_pcm_Ïd¥a_cÚÃù_cÚŒŞs
(
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
,

569 
¢d_pcm_Ïd¥a_¶ugš_io_t
 *
io
,

570 
¢d_pcm_Ïd¥a_š¡ªû_t
 *
š¡ªû
)

572 
idx
, 
midx
;

574 
idx
 = 
midx
 = 0; idx < 
¶ugš
->
desc
->
PÜtCouÁ
; idx++)

575 ià((
¶ugš
->
desc
->
PÜtDesütÜs
[
idx
] & (
io
->
pdesc
 | 
LADSPA_PORT_CONTROL
)) == (io->pdesc | LADSPA_PORT_CONTROL)) {

576 ià(
io
->
cÚŒŞs_size
 > 
midx
) {

577 ià(!
io
->
cÚŒŞs_š™Ÿlized
[
midx
])

578 
	`¢d_pcm_Ïd¥a_g‘_deçuÉ_cv®ue
(
¶ugš
->
desc
, 
idx
, &
io
->
cÚŒŞs
[
midx
]);

579 
¶ugš
->
desc
->
	`cÚÃù_pÜt
(
š¡ªû
->
hªdË
, 
idx
, &
io
->
cÚŒŞs
[
midx
]);

581  -
EINVAL
;

583 
midx
++;

586 
	}
}

588 
	$¢d_pcm_Ïd¥a_check_cÚÃù
(
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
,

589 
¢d_pcm_Ïd¥a_¶ugš_io_t
 *
io
,

590 
¢d_pcm_Ïd¥a_•s_t
 *
•s
,

591 
d•th
)

593 
idx
, 
midx
;

594 
”r
 = 0;

596 
idx
 = 
midx
 = 0; idx < 
¶ugš
->
desc
->
PÜtCouÁ
; idx++)

597 ià((
¶ugš
->
desc
->
PÜtDesütÜs
[
idx
] & (
io
->
pdesc
 | 
LADSPA_PORT_AUDIO
)) == (io->pdesc | LADSPA_PORT_AUDIO)) {

598 ià(
•s
->
chªÃls
.
¬¿y
[
midx
] =ğ
NO_ASSIGN
) {

599 
	`SNDERR
("% pÜˆfÜ…lugš % d•th %u i nÙ cÚÃùed", 
io
->
pdesc
 & 
LADSPA_PORT_INPUT
 ? "šput" : "ouut", 
¶ugš
->
desc
->
Name
, 
d•th
);

600 
”r
++;

602 
midx
++;

604 ià(
”r
 > 0) {

605 
	`SNDERR
("%˜cÚÃùiÚƒ¼Ü tÙ®", 
”r
);

606  -
EINVAL
;

609 
	}
}

611 
	$¢d_pcm_Ïd¥a_®loÿ‹_š¡ªûs
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_Ïd¥a_t
 *
Ïd¥a
)

613 
li¡_h—d
 *
li¡
, *
pos
;

614 
d•th
, 
idx
, 
couÁ
;

615 
š_chªÃls
;

616 
š_pÜts
, 
out_pÜts
;

617 
¢d_pcm_Ïd¥a_š¡ªû_t
 *
š¡ªû
 = 
NULL
;

618 
”r
;

620 
li¡
 = 
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
 ? &
Ïd¥a
->
µlugšs
 : &Ïd¥a->
ılugšs
;

621 
š_chªÃls
 = 
Ïd¥a
->
chªÃls
 > 0 ?†adspa->channels :

622 (
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
 ?…cm->
chªÃls
 : 
Ïd¥a
->
¶ug
.
g’
.
¦ave
->channels);

623 
d•th
 = 0;

624 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

625 
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
 = 
	`li¡_’Œy
(
pos
, snd_pcm_Ïd¥a_¶ugš_t, 
li¡
);

626 
š_pÜts
 = 
	`¢d_pcm_Ïd¥a_couÁ_pÜts
(
¶ugš
, 
LADSPA_PORT_INPUT
 | 
LADSPA_PORT_AUDIO
);

627 
out_pÜts
 = 
	`¢d_pcm_Ïd¥a_couÁ_pÜts
(
¶ugš
, 
LADSPA_PORT_OUTPUT
 | 
LADSPA_PORT_AUDIO
);

628 
couÁ
 = 1;

629 ià(
¶ugš
->
pŞicy
 =ğ
SND_PCM_LADSPA_POLICY_DUPLICATE
) {

630 ià(
š_pÜts
 =ğ1 && 
out_pÜts
 == 1)

631 
couÁ
 = 
š_chªÃls
;

633 
¶ugš
->
pŞicy
 = 
SND_PCM_LADSPA_POLICY_NONE
;

635 
idx
 = 0; idx < 
couÁ
; idx++) {

636 
š¡ªû
 = (
¢d_pcm_Ïd¥a_š¡ªû_t
 *)
	`ÿÎoc
(1, (snd_pcm_ladspa_instance_t));

637 ià(
š¡ªû
 =ğ
NULL
)

638  -
ENOMEM
;

639 
š¡ªû
->
desc
 = 
¶ugš
->desc;

640 
š¡ªû
->
hªdË
 = 
¶ugš
->
desc
->
	`š¡ªtŸ‹
Õlugš->desc, 
pcm
->
¿‹
);

641 
š¡ªû
->
d•th
 = depth;

642 ià(
š¡ªû
->
hªdË
 =ğ
NULL
) {

643 
	`SNDERR
("UÇbËØü—‹ in¡ªû oàLADSPA…lugš '%s'", 
¶ugš
->
desc
->
Name
);

644 
	`ä“
(
š¡ªû
);

645  -
EINVAL
;

647 
	`li¡_add_
(&
š¡ªû
->
li¡
, &
¶ugš
->
š¡ªûs
);

648 ià(
¶ugš
->
pŞicy
 =ğ
SND_PCM_LADSPA_POLICY_DUPLICATE
) {

649 
”r
 = 
	`¢d_pcm_Ïd¥a_cÚÃù_¶ugš_du¶iÿ‹
(
¶ugš
, &¶ugš->
šput
, &¶ugš->
ouut
, 
š¡ªû
, 
idx
);

650 ià(
”r
 < 0) {

651 
	`SNDERR
("UÇbËØcÚÃù du¶iÿ‹…Üˆoà¶ugš '%s' chªÃÈ%u d•th %u", 
¶ugš
->
desc
->
Name
, 
idx
, 
š¡ªû
->
d•th
);

652  
”r
;

655 
”r
 = 
	`¢d_pcm_Ïd¥a_cÚÃù_¶ugš
(
¶ugš
, 
š¡ªû
);

656 ià(
”r
 < 0) {

657 
	`SNDERR
("UÇbËØcÚÃù…lugš '%s' d•th %u", 
¶ugš
->
desc
->
Name
, 
d•th
);

658  
”r
;

661 
”r
 = 
	`¢d_pcm_Ïd¥a_cÚÃù_cÚŒŞs
(
¶ugš
, &¶ugš->
šput
, 
š¡ªû
);

662 
	`as£¹
(
”r
 >= 0);

663 
”r
 = 
	`¢d_pcm_Ïd¥a_cÚÃù_cÚŒŞs
(
¶ugš
, &¶ugš->
ouut
, 
š¡ªû
);

664 
	`as£¹
(
”r
 >= 0);

665 ià(
¶ugš
->
desc
->
aùiv©e
)

666 
¶ugš
->
desc
->
	`aùiv©e
(
š¡ªû
->
hªdË
);

668 
”r
 = 
	`¢d_pcm_Ïd¥a_check_cÚÃù
(
¶ugš
, &¶ugš->
šput
, &
š¡ªû
->šput, 
d•th
);

669 ià(
”r
 < 0)

670  
”r
;

671 
”r
 = 
	`¢d_pcm_Ïd¥a_check_cÚÃù
(
¶ugš
, &¶ugš->
ouut
, &
š¡ªû
->ouut, 
d•th
);

672 ià(
”r
 < 0)

673  
”r
;

674 
d•th
++;

677 
	}
}

679 
LADSPA_D©a
 *
	$¢d_pcm_Ïd¥a_®loÿ‹_z”o
(
¢d_pcm_Ïd¥a_t
 *
Ïd¥a
, 
idx
)

681 ià(
Ïd¥a
->
z”o
[
idx
] =ğ
NULL
)

682 
Ïd¥a
->
z”o
[
idx
] = 
	`ÿÎoc
Öad¥a->
®loÿ‹d
, (
LADSPA_D©a
));

683  
Ïd¥a
->
z”o
[
idx
];

684 
	}
}

686 
	$¢d_pcm_Ïd¥a_®loÿ‹_memÜy
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_Ïd¥a_t
 *
Ïd¥a
)

688 
li¡_h—d
 *
li¡
, *
pos
, *
pos1
;

689 
¢d_pcm_Ïd¥a_š¡ªû_t
 *
š¡ªû
;

690 
chªÃls
 = 16, 
nchªÃls
;

691 
ichªÃls
, 
ochªÃls
;

692 **
pchªÃls
, **
ÅchªÃls
;

693 
idx
, 
chn
;

695 
Ïd¥a
->
®loÿ‹d
 = 2048;

696 ià(
pcm
->
bufãr_size
 > 
Ïd¥a
->
®loÿ‹d
)

697 
Ïd¥a
->
®loÿ‹d
 = 
pcm
->
bufãr_size
;

698 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

699 
ichªÃls
 = 
pcm
->
chªÃls
;

700 
ochªÃls
 = 
Ïd¥a
->
¶ug
.
g’
.
¦ave
->
chªÃls
;

702 
ichªÃls
 = 
Ïd¥a
->
¶ug
.
g’
.
¦ave
->
chªÃls
;

703 
ochªÃls
 = 
pcm
->
chªÃls
;

705 
pchªÃls
 = 
	`ÿÎoc
(1, (*è* 
chªÃls
);

706 ià(
pchªÃls
 =ğ
NULL
)

707  -
ENOMEM
;

708 
li¡
 = 
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
 ? &
Ïd¥a
->
µlugšs
 : &Ïd¥a->
ılugšs
;

709 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

710 
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
 = 
	`li¡_’Œy
(
pos
, snd_pcm_Ïd¥a_¶ugš_t, 
li¡
);

711 
	`li¡_fÜ_—ch
(
pos1
, &
¶ugš
->
š¡ªûs
) {

712 
š¡ªû
 = 
	`li¡_’Œy
(
pos1
, 
¢d_pcm_Ïd¥a_š¡ªû_t
, 
li¡
);

713 
nchªÃls
 = 
chªÃls
;

714 
idx
 = 0; idx < 
š¡ªû
->
šput
.
chªÃls
.
size
; idx++) {

715 
chn
 = 
š¡ªû
->
šput
.
chªÃls
.
¬¿y
[
idx
];

716 
	`as£¹
(
š¡ªû
->
šput
.
pÜts
.
¬¿y
[
idx
] !ğ
NO_ASSIGN
);

717 ià(
chn
 >ğ
nchªÃls
)

718 
nchªÃls
 = 
chn
 + 1;

720 
idx
 = 0; idx < 
š¡ªû
->
ouut
.
chªÃls
.
size
; idx++) {

721 
chn
 = 
š¡ªû
->
ouut
.
chªÃls
.
¬¿y
[
idx
];

722 
	`as£¹
(
š¡ªû
->
ouut
.
pÜts
.
¬¿y
[
idx
] !ğ
NO_ASSIGN
);

723 ià(
chn
 >ğ
nchªÃls
)

724 
nchªÃls
 = 
chn
 + 1;

726 ià(
nchªÃls
 !ğ
chªÃls
) {

727 
ÅchªÃls
 = 
	`»®loc
(
pchªÃls
, 
nchªÃls
 * (*));

728 ià(
ÅchªÃls
 =ğ
NULL
) {

729 
	`ä“
(
pchªÃls
);

730  -
ENOMEM
;

732 
idx
 = 
chªÃls
; idx < 
nchªÃls
; idx++)

733 
ÅchªÃls
[
idx
] = 
NULL
;

734 
pchªÃls
 = 
ÅchªÃls
;

736 
	`as£¹
(
š¡ªû
->
šput
.
d©a
 =ğ
NULL
);

737 
	`as£¹
(
š¡ªû
->
šput
.
m_d©a
 =ğ
NULL
);

738 
	`as£¹
(
š¡ªû
->
ouut
.
d©a
 =ğ
NULL
);

739 
	`as£¹
(
š¡ªû
->
ouut
.
m_d©a
 =ğ
NULL
);

740 
š¡ªû
->
šput
.
d©a
 = 
	`ÿÎoc
(š¡ªû->šput.
chªÃls
.
size
, (*));

741 
š¡ªû
->
šput
.
m_d©a
 = 
	`ÿÎoc
(š¡ªû->šput.
chªÃls
.
size
, (*));

742 
š¡ªû
->
ouut
.
d©a
 = 
	`ÿÎoc
(š¡ªû->ouut.
chªÃls
.
size
, (*));

743 
š¡ªû
->
ouut
.
m_d©a
 = 
	`ÿÎoc
(š¡ªû->ouut.
chªÃls
.
size
, (*));

744 ià(
š¡ªû
->
šput
.
d©a
 =ğ
NULL
 ||

745 
š¡ªû
->
šput
.
m_d©a
 =ğ
NULL
 ||

746 
š¡ªû
->
ouut
.
d©a
 =ğ
NULL
 ||

747 
š¡ªû
->
ouut
.
m_d©a
 =ğ
NULL
) {

748 
	`ä“
(
pchªÃls
);

749  -
ENOMEM
;

751 
idx
 = 0; idx < 
š¡ªû
->
šput
.
chªÃls
.
size
; idx++) {

752 
chn
 = 
š¡ªû
->
šput
.
chªÃls
.
¬¿y
[
idx
];

753 ià(
pchªÃls
[
chn
] =ğ
NULL
 && chÀ< 
ichªÃls
) {

754 
š¡ªû
->
šput
.
d©a
[
idx
] = 
NULL
;

757 
š¡ªû
->
šput
.
d©a
[
idx
] = 
pchªÃls
[
chn
];

758 ià(
š¡ªû
->
šput
.
d©a
[
idx
] =ğ
NULL
) {

759 
š¡ªû
->
šput
.
d©a
[
idx
] = 
	`¢d_pcm_Ïd¥a_®loÿ‹_z”o
(
Ïd¥a
, 0);

760 ià(
š¡ªû
->
šput
.
d©a
[
idx
] =ğ
NULL
) {

761 
	`ä“
(
pchªÃls
);

762  -
ENOMEM
;

766 
idx
 = 0; idx < 
š¡ªû
->
ouut
.
chªÃls
.
size
; idx++) {

767 
chn
 = 
š¡ªû
->
ouut
.
chªÃls
.
¬¿y
[
idx
];

770 
š¡ªû
->
ouut
.
d©a
[
idx
] = 
	`m®loc
((
LADSPA_D©a
è* 
Ïd¥a
->
®loÿ‹d
);

771 ià(
š¡ªû
->
ouut
.
d©a
[
idx
] =ğ
NULL
) {

772 
	`ä“
(
pchªÃls
);

773  -
ENOMEM
;

775 
pchªÃls
[
chn
] = 
š¡ªû
->
ouut
.
m_d©a
[
idx
] = in¡ªû->ouut.
d©a
[idx];

783 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

784 
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
 = 
	`li¡_’Œy
(
pos
, snd_pcm_Ïd¥a_¶ugš_t, 
li¡
);

785 
	`li¡_fÜ_—ch
(
pos1
, &
¶ugš
->
š¡ªûs
) {

786 
š¡ªû
 = 
	`li¡_’Œy
(
pos1
, 
¢d_pcm_Ïd¥a_š¡ªû_t
, 
li¡
);

787 
idx
 = 0; idx < 
š¡ªû
->
ouut
.
chªÃls
.
size
; idx++) {

788 
chn
 = 
š¡ªû
->
ouut
.
chªÃls
.
¬¿y
[
idx
];

789 ià(
š¡ªû
->
ouut
.
d©a
[
idx
] =ğ
pchªÃls
[
chn
]) {

790 
	`ä“
(
š¡ªû
->
ouut
.
m_d©a
[
idx
]);

791 
š¡ªû
->
ouut
.
m_d©a
[
idx
] = 
NULL
;

792 ià(
chn
 < 
ochªÃls
) {

793 
š¡ªû
->
ouut
.
d©a
[
idx
] = 
NULL
;

795 
š¡ªû
->
ouut
.
d©a
[
idx
] = 
	`¢d_pcm_Ïd¥a_®loÿ‹_z”o
(
Ïd¥a
, 1);

796 ià(
š¡ªû
->
ouut
.
d©a
[
idx
] =ğ
NULL
) {

797 
	`ä“
(
pchªÃls
);

798  -
ENOMEM
;

806 
	`´štf
("z”o[0] = %p\n", 
Ïd¥a
->
z”o
[0]);

807 
	`´štf
("z”o[1] = %p\n", 
Ïd¥a
->
z”o
[1]);

808 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

809 
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
 = 
	`li¡_’Œy
(
pos
, snd_pcm_Ïd¥a_¶ugš_t, 
li¡
);

810 
	`li¡_fÜ_—ch
(
pos1
, &
¶ugš
->
š¡ªûs
) {

811 
š¡ªû
 = 
	`li¡_’Œy
(
pos1
, 
¢d_pcm_Ïd¥a_š¡ªû_t
, 
li¡
);

812 
idx
 = 0; idx < 
š¡ªû
->
šput
.
chªÃls
.
size
; idx++)

813 
	`´štf
("%i:®loc-šput%i: d©¨ğ%p, m_d©¨ğ%p\n", 
š¡ªû
->
d•th
, 
idx
, in¡ªû->
šput
.
d©a
[idx], in¡ªû->šput.
m_d©a
[idx]);

814 
idx
 = 0; idx < 
š¡ªû
->
ouut
.
chªÃls
.
size
; idx++)

815 
	`´štf
("%i:®loc-ouut%i: d©¨ğ%p, m_d©¨ğ%p\n", 
š¡ªû
->
d•th
, 
idx
, in¡ªû->
ouut
.
d©a
[idx], in¡ªû->ouut.
m_d©a
[idx]);

819 
	`ä“
(
pchªÃls
);

821 
	}
}

823 
	$¢d_pcm_Ïd¥a_š™
(
¢d_pcm_t
 *
pcm
)

825 
¢d_pcm_Ïd¥a_t
 *
Ïd¥a
 = 
pcm
->
´iv©e_d©a
;

826 
”r
;

828 
	`¢d_pcm_Ïd¥a_ä“_š¡ªûs
(
pcm
, 
Ïd¥a
, 1);

829 
”r
 = 
	`¢d_pcm_Ïd¥a_®loÿ‹_š¡ªûs
(
pcm
, 
Ïd¥a
);

830 ià(
”r
 < 0) {

831 
	`¢d_pcm_Ïd¥a_ä“_š¡ªûs
(
pcm
, 
Ïd¥a
, 1);

832  
”r
;

834 
”r
 = 
	`¢d_pcm_Ïd¥a_®loÿ‹_memÜy
(
pcm
, 
Ïd¥a
);

835 ià(
”r
 < 0) {

836 
	`¢d_pcm_Ïd¥a_ä“_š¡ªûs
(
pcm
, 
Ïd¥a
, 1);

837  
”r
;

840 
	}
}

842 
	$¢d_pcm_Ïd¥a_hw_ä“
(
¢d_pcm_t
 *
pcm
)

844 
¢d_pcm_Ïd¥a_t
 *
Ïd¥a
 = 
pcm
->
´iv©e_d©a
;

846 
	`¢d_pcm_Ïd¥a_ä“_š¡ªûs
(
pcm
, 
Ïd¥a
, 1);

847  
	`¢d_pcm_g’”ic_hw_ä“
(
pcm
);

848 
	}
}

850 
¢d_pcm_uäames_t


851 
	$¢d_pcm_Ïd¥a_wr™e_¬—s
(
¢d_pcm_t
 *
pcm
,

852 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

853 
¢d_pcm_uäames_t
 
off£t
,

854 
¢d_pcm_uäames_t
 
size
,

855 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

856 
¢d_pcm_uäames_t
 
¦ave_off£t
,

857 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

859 
¢d_pcm_Ïd¥a_t
 *
Ïd¥a
 = 
pcm
->
´iv©e_d©a
;

860 
¢d_pcm_Ïd¥a_š¡ªû_t
 *
š¡ªû
;

861 
li¡_h—d
 *
pos
, *
pos1
;

862 
LADSPA_D©a
 *
d©a
;

863 
idx
, 
chn
, 
size1
, 
size2
;

865 ià(
size
 > *
¦ave_siz•
)

866 
size
 = *
¦ave_siz•
;

867 
size2
 = 
size
;

869 
	`¢d_pcm_¬—s_cİy
(
¦ave_¬—s
, 
¦ave_off£t
,

870 
¬—s
, 
off£t
,

871 
pcm
->
chªÃls
, 
size
,…cm->
fÜm©
);

873 
size
 > 0) {

874 
size1
 = 
size
;

875 ià(
size1
 > 
Ïd¥a
->
®loÿ‹d
)

876 
size1
 = 
Ïd¥a
->
®loÿ‹d
;

877 
	`li¡_fÜ_—ch
(
pos
, &
Ïd¥a
->
µlugšs
) {

878 
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
 = 
	`li¡_’Œy
(
pos
, snd_pcm_Ïd¥a_¶ugš_t, 
li¡
);

879 
	`li¡_fÜ_—ch
(
pos1
, &
¶ugš
->
š¡ªûs
) {

880 
š¡ªû
 = 
	`li¡_’Œy
(
pos1
, 
¢d_pcm_Ïd¥a_š¡ªû_t
, 
li¡
);

881 
idx
 = 0; idx < 
š¡ªû
->
šput
.
chªÃls
.
size
; idx++) {

882 
chn
 = 
š¡ªû
->
šput
.
chªÃls
.
¬¿y
[
idx
];

883 
d©a
 = 
š¡ªû
->
šput
.d©a[
idx
];

884 ià(
d©a
 =ğ
NULL
) {

885 
d©a
 = (
LADSPA_D©a
 *)((*)
¬—s
[
chn
].
addr
 + (¬—s[chn].
fœ¡
 / 8));

886 
d©a
 +ğ
off£t
;

888 
š¡ªû
->
desc
->
	`cÚÃù_pÜt
(š¡ªû->
hªdË
, in¡ªû->
šput
.
pÜts
.
¬¿y
[
idx
], 
d©a
);

890 
idx
 = 0; idx < 
š¡ªû
->
ouut
.
chªÃls
.
size
; idx++) {

891 
chn
 = 
š¡ªû
->
ouut
.
chªÃls
.
¬¿y
[
idx
];

892 
d©a
 = 
š¡ªû
->
ouut
.d©a[
idx
];

893 ià(
d©a
 =ğ
NULL
) {

894 
d©a
 = (
LADSPA_D©a
 *)((*)
¦ave_¬—s
[
chn
].
addr
 + (
¬—s
[chn].
fœ¡
 / 8));

895 
d©a
 +ğ
¦ave_off£t
;

897 
š¡ªû
->
desc
->
	`cÚÃù_pÜt
(š¡ªû->
hªdË
, in¡ªû->
ouut
.
pÜts
.
¬¿y
[
idx
], 
d©a
);

899 
š¡ªû
->
desc
->
	`run
(š¡ªû->
hªdË
, 
size1
);

902 
off£t
 +ğ
size1
;

903 
¦ave_off£t
 +ğ
size1
;

904 
size
 -ğ
size1
;

907 *
¦ave_siz•
 = 
size2
;

908  
size2
;

909 
	}
}

911 
¢d_pcm_uäames_t


912 
	$¢d_pcm_Ïd¥a_»ad_¬—s
(
¢d_pcm_t
 *
pcm
,

913 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

914 
¢d_pcm_uäames_t
 
off£t
,

915 
¢d_pcm_uäames_t
 
size
,

916 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

917 
¢d_pcm_uäames_t
 
¦ave_off£t
,

918 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

920 
¢d_pcm_Ïd¥a_t
 *
Ïd¥a
 = 
pcm
->
´iv©e_d©a
;

921 
¢d_pcm_Ïd¥a_š¡ªû_t
 *
š¡ªû
;

922 
li¡_h—d
 *
pos
, *
pos1
;

923 
LADSPA_D©a
 *
d©a
;

924 
idx
, 
chn
, 
size1
, 
size2
;;

926 ià(
size
 > *
¦ave_siz•
)

927 
size
 = *
¦ave_siz•
;

928 
size2
 = 
size
;

930 
	`¢d_pcm_¬—s_cİy
(
¬—s
, 
off£t
,

931 
¦ave_¬—s
, 
¦ave_off£t
,

932 
pcm
->
chªÃls
, 
size
,…cm->
fÜm©
);

934 
size
 > 0) {

935 
size1
 = 
size
;

936 ià(
size1
 > 
Ïd¥a
->
®loÿ‹d
)

937 
size1
 = 
Ïd¥a
->
®loÿ‹d
;

938 
	`li¡_fÜ_—ch
(
pos
, &
Ïd¥a
->
ılugšs
) {

939 
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
 = 
	`li¡_’Œy
(
pos
, snd_pcm_Ïd¥a_¶ugš_t, 
li¡
);

940 
	`li¡_fÜ_—ch
(
pos1
, &
¶ugš
->
š¡ªûs
) {

941 
š¡ªû
 = 
	`li¡_’Œy
(
pos1
, 
¢d_pcm_Ïd¥a_š¡ªû_t
, 
li¡
);

942 
idx
 = 0; idx < 
š¡ªû
->
šput
.
chªÃls
.
size
; idx++) {

943 
chn
 = 
š¡ªû
->
šput
.
chªÃls
.
¬¿y
[
idx
];

944 
d©a
 = 
š¡ªû
->
šput
.d©a[
idx
];

945 ià(
d©a
 =ğ
NULL
) {

946 
d©a
 = (
LADSPA_D©a
 *)((*)
¦ave_¬—s
[
chn
].
addr
 + (
¬—s
[chn].
fœ¡
 / 8));

947 
d©a
 +ğ
¦ave_off£t
;

949 
š¡ªû
->
desc
->
	`cÚÃù_pÜt
(š¡ªû->
hªdË
, in¡ªû->
šput
.
pÜts
.
¬¿y
[
idx
], 
d©a
);

951 
idx
 = 0; idx < 
š¡ªû
->
ouut
.
chªÃls
.
size
; idx++) {

952 
chn
 = 
š¡ªû
->
ouut
.
chªÃls
.
¬¿y
[
idx
];

953 
d©a
 = 
š¡ªû
->
ouut
.d©a[
idx
];

954 ià(
d©a
 =ğ
NULL
) {

955 
d©a
 = (
LADSPA_D©a
 *)((*)
¬—s
[
chn
].
addr
 + (¬—s[chn].
fœ¡
 / 8));

956 
d©a
 +ğ
off£t
;

958 
š¡ªû
->
desc
->
	`cÚÃù_pÜt
(š¡ªû->
hªdË
, in¡ªû->
ouut
.
pÜts
.
¬¿y
[
idx
], 
d©a
);

960 
š¡ªû
->
desc
->
	`run
(š¡ªû->
hªdË
, 
size1
);

963 
off£t
 +ğ
size1
;

964 
¦ave_off£t
 +ğ
size1
;

965 
size
 -ğ
size1
;

968 *
¦ave_siz•
 = 
size2
;

969  
size2
;

970 
	}
}

972 
	$¢d_pcm_Ïd¥a_dump_dœeùiÚ
(
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
,

973 
¢d_pcm_Ïd¥a_¶ugš_io_t
 *
io
,

974 
¢d_ouut_t
 *
out
)

976 
idx
, 
midx
;

978 ià(
io
->
pÜt_bšdšgs_size
 == 0)

979 
__cÚŒŞ
;

980 
	`¢d_ouut_´štf
(
out
, " AudiØ% pÜˆbšdšgs:\n", 
io
->
pdesc
 =ğ
LADSPA_PORT_INPUT
 ? "input" : "output");

981 
idx
 = 0; idx < 
io
->
pÜt_bšdšgs_size
; idx++) {

982 ià(
io
->
pÜt_bšdšgs
[
idx
] =ğ
NO_ASSIGN
)

983 
	`¢d_ouut_´štf
(
out
, " %˜-> NONE\n", 
idx
);

985 
	`¢d_ouut_´štf
(
out
, " %˜-> %i\n", 
idx
, 
io
->
pÜt_bšdšgs
[idx]);

987 
__cÚŒŞ
:

988 ià(
io
->
cÚŒŞs_size
 == 0)

990 
	`¢d_ouut_´štf
(
out
, " CÚŒŞ % pÜˆš™ŸÈv®ues:\n", 
io
->
pdesc
 =ğ
LADSPA_PORT_INPUT
 ? "input" : "output");

991 
idx
 = 
midx
 = 0; idx < 
¶ugš
->
desc
->
PÜtCouÁ
; idx++) {

992 ià((
¶ugš
->
desc
->
PÜtDesütÜs
[
idx
] & (
io
->
pdesc
 | 
LADSPA_PORT_CONTROL
)) == (io->pdesc | LADSPA_PORT_CONTROL)) {

993 
	`¢d_ouut_´štf
(
out
, " %˜\"%s\" = %.8f\n", 
idx
, 
¶ugš
->
desc
->
PÜtNames
[idx], 
io
->
cÚŒŞs
[
midx
]);

994 
midx
++;

997 
	}
}

999 
	$¢d_pcm_Ïd¥a_dump_¬¿y
(
¢d_ouut_t
 *
out
,

1000 
¢d_pcm_Ïd¥a_¬¿y_t
 *
¬¿y
,

1001 
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
)

1003 
size
 = 
¬¿y
->size;

1004 
v®
, 
idx
 = 0;

1006 
size
-- > 0) {

1007 ià(
idx
 > 0) {

1008 
	`¢d_ouut_putc
(
out
, ',');

1009 
	`¢d_ouut_putc
(
out
, ' ');

1011 
v®
 = 
¬¿y
->¬¿y[
idx
++];

1012 ià(
v®
 =ğ
NO_ASSIGN
)

1013 
	`¢d_ouut_putc
(
out
, '-');

1015 
	`¢d_ouut_´štf
(
out
, "%u", 
v®
);

1016 ià(
¶ugš
 && 
v®
 !ğ
NO_ASSIGN
)

1017 
	`¢d_ouut_´štf
(
out
, " \"%s\"", 
¶ugš
->
desc
->
PÜtNames
[
v®
]);

1019 
	}
}

1021 
	$¢d_pcm_Ïd¥a_¶ugšs_dump
(
li¡_h—d
 *
li¡
, 
¢d_ouut_t
 *
out
)

1023 
li¡_h—d
 *
pos
, *
pos2
;

1025 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

1026 
¢d_pcm_Ïd¥a_¶ugš_t
 *
¶ugš
 = 
	`li¡_’Œy
(
pos
, snd_pcm_Ïd¥a_¶ugš_t, 
li¡
);

1027 
	`¢d_ouut_´štf
(
out
, " PŞicy: %s\n", 
¶ugš
->
pŞicy
 =ğ
SND_PCM_LADSPA_POLICY_NONE
 ? "none" : "duplicate");

1028 
	`¢d_ouut_´štf
(
out
, " F’ame: %s\n", 
¶ugš
->
f’ame
);

1029 
	`¢d_ouut_´štf
(
out
, " Plugš Name: %s\n", 
¶ugš
->
desc
->
Name
);

1030 
	`¢d_ouut_´štf
(
out
, " Plugš Lab–: %s\n", 
¶ugš
->
desc
->
Lab–
);

1031 
	`¢d_ouut_´štf
(
out
, " Plugš UniquID: %lu\n", 
¶ugš
->
desc
->
UniqueID
);

1032 
	`¢d_ouut_´štf
(
out
, " Instances:\n");

1033 
	`li¡_fÜ_—ch
(
pos2
, &
¶ugš
->
š¡ªûs
) {

1034 
¢d_pcm_Ïd¥a_š¡ªû_t
 *
š
 = (¢d_pcm_Ïd¥a_š¡ªû_ˆ*è
pos2
;

1035 
	`¢d_ouut_´štf
(
out
, " D•th: %i\n", 
š
->
d•th
);

1036 
	`¢d_ouut_´štf
(
out
, " InChannels: ");

1037 
	`¢d_pcm_Ïd¥a_dump_¬¿y
(
out
, &
š
->
šput
.
chªÃls
, 
NULL
);

1038 
	`¢d_ouut_´štf
(
out
, "\n InPorts: ");

1039 
	`¢d_pcm_Ïd¥a_dump_¬¿y
(
out
, &
š
->
šput
.
pÜts
, 
¶ugš
);

1040 
	`¢d_ouut_´štf
(
out
, "\n OutChannels: ");

1041 
	`¢d_pcm_Ïd¥a_dump_¬¿y
(
out
, &
š
->
ouut
.
chªÃls
, 
NULL
);

1042 
	`¢d_ouut_´štf
(
out
, "\n OutPorts: ");

1043 
	`¢d_pcm_Ïd¥a_dump_¬¿y
(
out
, &
š
->
ouut
.
pÜts
, 
¶ugš
);

1044 
	`¢d_ouut_´štf
(
out
, "\n");

1046 
	`¢d_pcm_Ïd¥a_dump_dœeùiÚ
(
¶ugš
, &¶ugš->
šput
, 
out
);

1047 
	`¢d_pcm_Ïd¥a_dump_dœeùiÚ
(
¶ugš
, &¶ugš->
ouut
, 
out
);

1049 
	}
}

1051 
	$¢d_pcm_Ïd¥a_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

1053 
¢d_pcm_Ïd¥a_t
 *
Ïd¥a
 = 
pcm
->
´iv©e_d©a
;

1055 
	`¢d_ouut_´štf
(
out
, "LADSPA PCM\n");

1056 
	`¢d_ouut_´štf
(
out
, " Playback:\n");

1057 
	`¢d_pcm_Ïd¥a_¶ugšs_dump
(&
Ïd¥a
->
µlugšs
, 
out
);

1058 
	`¢d_ouut_´štf
(
out
, " Capture:\n");

1059 
	`¢d_pcm_Ïd¥a_¶ugšs_dump
(&
Ïd¥a
->
ılugšs
, 
out
);

1060 ià(
pcm
->
£tup
) {

1061 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

1062 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

1064 
	`¢d_ouut_´štf
(
out
, "Slave: ");

1065 
	`¢d_pcm_dump
(
Ïd¥a
->
¶ug
.
g’
.
¦ave
, 
out
);

1066 
	}
}

1068 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_Ïd¥a_İs
 = {

1069 .
şo£
 = 
¢d_pcm_Ïd¥a_şo£
,

1070 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

1071 .
	ghw_»fše
 = 
¢d_pcm_Ïd¥a_hw_»fše
,

1072 .
	ghw_·¿ms
 = 
¢d_pcm_Ïd¥a_hw_·¿ms
,

1073 .
	ghw_ä“
 = 
¢d_pcm_Ïd¥a_hw_ä“
,

1074 .
	gsw_·¿ms
 = 
¢d_pcm_g’”ic_sw_·¿ms
,

1075 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

1076 .
	gdump
 = 
¢d_pcm_Ïd¥a_dump
,

1077 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

1078 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

1079 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

1080 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

1081 .
	gqu”y_chm­s
 = 
¢d_pcm_g’”ic_qu”y_chm­s
,

1082 .
	gg‘_chm­
 = 
¢d_pcm_g’”ic_g‘_chm­
,

1083 .
	g£t_chm­
 = 
¢d_pcm_g’”ic_£t_chm­
,

1086 
	$¢d_pcm_Ïd¥a_check_fe
(
¢d_pcm_Ïd¥a_¶ugš_t
 * cÚ¡ 
¶ugš
,

1087 cÚ¡ *
f’ame
,

1088 cÚ¡ *
Ïb–
,

1089 cÚ¡ 
Ïd¥a_id
)

1091 *
hªdË
;

1093 
	`as£¹
(
f’ame
);

1094 
hªdË
 = 
	`dlİ’
(
f’ame
, 
RTLD_LAZY
);

1095 ià(
hªdË
) {

1096 
LADSPA_DesütÜ_FunùiÚ
 
fú
 = (LADSPA_DesütÜ_FunùiÚ)
	`dlsym
(
hªdË
, "ladspa_descriptor");

1097 ià(
fú
) {

1098 
idx
;

1099 cÚ¡ 
LADSPA_DesütÜ
 *
d
;

1100 
idx
 = 0; (
d
 = 
	`fú
(idx)è!ğ
NULL
; idx++) {

1105 ià(
	`¡rcmp
(
Ïb–
, 
d
->
Lab–
))

1108 *
Ïb–loÿË
;

1109 
lcÚv
 *
lc
;

1110 ià(
Ïb–
 !ğ
NULL
) {

1111 
lc
 = 
	`loÿËcÚv
 ();

1112 
Ïb–loÿË
 = 
	`m®loc
 (
	`¡¾’
 (
Ïb–
) + 1);

1113 ià(
Ïb–loÿË
 =ğ
NULL
) {

1114 
	`dlşo£
(
hªdË
);

1115  -
ENOMEM
;

1117 
	`¡rıy
 (
Ïb–loÿË
, 
Ïb–
);

1118 ià(
	`¡¼chr
(
Ïb–loÿË
, '.'))

1119 *
	`¡¼chr
 (
Ïb–loÿË
, '.'èğ*
lc
->
decim®_pošt
;

1120 ià(
	`¡rcmp
(
Ïb–
, 
d
->
Lab–
è&& sŒcmp(
Ïb–loÿË
, d->Label)) {

1121 
	`ä“
(
Ïb–loÿË
);

1124 
	`ä“
 (
Ïb–loÿË
);

1127 ià(
Ïd¥a_id
 > 0 && 
d
->
UniqueID
 !=†adspa_id)

1129 
¶ugš
->
f’ame
 = 
	`¡rdup
(filename);

1130 ià(
¶ugš
->
f’ame
 =ğ
NULL
) {

1131 
	`dlşo£
(
hªdË
);

1132  -
ENOMEM
;

1134 
¶ugš
->
dl_hªdË
 = 
hªdË
;

1135 
¶ugš
->
desc
 = 
d
;

1139 
	`dlşo£
(
hªdË
);

1141  -
ENOENT
;

1142 
	}
}

1144 
	$¢d_pcm_Ïd¥a_check_dœ
(
¢d_pcm_Ïd¥a_¶ugš_t
 * cÚ¡ 
¶ugš
,

1145 cÚ¡ *
·th
,

1146 cÚ¡ *
Ïb–
,

1147 cÚ¡ 
Ïd¥a_id
)

1149 
DIR
 *
dœ
;

1150 
dœ’t64
 * 
dœ’t
;

1151 
Ën
 = 
	`¡¾’
(
·th
), 
”r
;

1152 
Ãed_¦ash
;

1153 *
f’ame
;

1155 ià(
Ën
 < 1)

1157 
Ãed_¦ash
 = 
·th
[
Ën
 - 1] != '/';

1159 
dœ
 = 
	`İ’dœ
(
·th
);

1160 ià(!
dœ
)

1161  -
ENOENT
;

1164 
dœ’t
 = 
	`»addœ64
(
dœ
);

1165 ià(!
dœ’t
) {

1166 
	`şo£dœ
(
dœ
);

1170 
f’ame
 = 
	`m®loc
(
Ën
 + 
	`¡¾’
(
dœ’t
->
d_Çme
è+ 1 + 
Ãed_¦ash
);

1171 ià(
f’ame
 =ğ
NULL
) {

1172 
	`şo£dœ
(
dœ
);

1173  -
ENOMEM
;

1175 
	`¡rıy
(
f’ame
, 
·th
);

1176 ià(
Ãed_¦ash
)

1177 
	`¡rÿt
(
f’ame
, "/");

1178 
	`¡rÿt
(
f’ame
, 
dœ’t
->
d_Çme
);

1179 
”r
 = 
	`¢d_pcm_Ïd¥a_check_fe
(
¶ugš
, 
f’ame
, 
Ïb–
, 
Ïd¥a_id
);

1180 
	`ä“
(
f’ame
);

1181 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

1182 
	`şo£dœ
(
dœ
);

1183  
”r
;

1185 ià(
”r
 > 0) {

1186 
	`şo£dœ
(
dœ
);

1192 
	}
}

1194 
	$¢d_pcm_Ïd¥a_look_fÜ_¶ugš
(
¢d_pcm_Ïd¥a_¶ugš_t
 * cÚ¡ 
¶ugš
,

1195 cÚ¡ *
·th
,

1196 cÚ¡ *
Ïb–
,

1197 cÚ¡ 
Ïd¥a_id
)

1199 cÚ¡ *
c
;

1200 
size_t
 
l
;

1201 
”r
;

1203 
c
 = 
·th
; (
l
 = 
	`¡rc¥n
(c, ": ")) > 0; ) {

1204 
Çme
[
l
 + 1];

1205 *
fuÎ·th
;

1206 
	`memıy
(
Çme
, 
c
, 
l
);

1207 
Çme
[
l
] = 0;

1208 
”r
 = 
	`¢d_u£r_fe
(
Çme
, &
fuÎ·th
);

1209 ià(
”r
 < 0)

1210  
”r
;

1211 
”r
 = 
	`¢d_pcm_Ïd¥a_check_dœ
(
¶ugš
, 
fuÎ·th
, 
Ïb–
, 
Ïd¥a_id
);

1212 
	`ä“
(
fuÎ·th
);

1213 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
)

1214  
”r
;

1215 ià(
”r
 > 0)

1217 
c
 +ğ
l
;

1218 ià(!*
c
)

1220 
c
++;

1222  -
ENOENT
;

1223 
	}
}

1225 
	$¢d_pcm_Ïd¥a_add_deçuÉ_cÚŒŞs
(
¢d_pcm_Ïd¥a_¶ugš_t
 *
Ílug
,

1226 
¢d_pcm_Ïd¥a_¶ugš_io_t
 *
io
)

1228 
couÁ
 = 0;

1229 
LADSPA_D©a
 *
¬¿y
;

1230 *
š™Ÿlized
;

1231 
idx
;

1233 
idx
 = 0; idx < 
Ílug
->
desc
->
PÜtCouÁ
; idx++)

1234 ià((
Ílug
->
desc
->
PÜtDesütÜs
[
idx
] & (
io
->
pdesc
 | 
LADSPA_PORT_CONTROL
)) == (io->pdesc | LADSPA_PORT_CONTROL))

1235 
couÁ
++;

1236 
¬¿y
 = (
LADSPA_D©a
 *)
	`ÿÎoc
(
couÁ
, (LADSPA_Data));

1237 ià(!
¬¿y
)

1238  -
ENOMEM
;

1239 
š™Ÿlized
 = (*)
	`ÿÎoc
(
couÁ
, ());

1240 ià(!
š™Ÿlized
) {

1241 
	`ä“
(
¬¿y
);

1242  -
ENOMEM
;

1244 
io
->
cÚŒŞs_size
 = 
couÁ
;

1245 
io
->
cÚŒŞs_š™Ÿlized
 = 
š™Ÿlized
;

1246 
io
->
cÚŒŞs
 = 
¬¿y
;

1249 
	}
}

1251 
	$¢d_pcm_Ïd¥a_·r£_cÚŒŞs
(
¢d_pcm_Ïd¥a_¶ugš_t
 *
Ílug
,

1252 
¢d_pcm_Ïd¥a_¶ugš_io_t
 *
io
,

1253 
¢d_cÚfig_t
 *
cÚŒŞs
)

1255 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1256 
”r
;

1258 ià(
	`¢d_cÚfig_g‘_ty³
(
cÚŒŞs
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1259 
	`SNDERR
("controls definition must be‡ compound");

1260  -
EINVAL
;

1263 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚŒŞs
) {

1264 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1265 cÚ¡ *
id
;

1266 
lv®
;

1267 
pÜt
, 
uv®
;

1268 
dv®
;

1269 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1271 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
lv®
);

1272 ià(
”r
 >= 0) {

1273 
”r
 = 
	`¢d_pcm_Ïd¥a_fšd_pÜt
(&
pÜt
, 
Ílug
, 
io
->
pdesc
 | 
LADSPA_PORT_CONTROL
, 
lv®
);

1275 
”r
 = 
	`¢d_pcm_Ïd¥a_fšd_¥Üt
(&
pÜt
, 
Ílug
, 
io
->
pdesc
 | 
LADSPA_PORT_CONTROL
, 
id
);

1277 ià(
”r
 < 0) {

1278 
	`SNDERR
("UÇbËØfšd‡ÀcÚŒŞ…Üˆ(%s)", 
id
);

1279  
”r
;

1281 ià(
	`¢d_cÚfig_g‘_œ—l
(
n
, &
dv®
) < 0) {

1282 
	`SNDERR
("CÚŒŞ…Üˆ% ha nÙ‡ÀæßˆÜ iÁeg” v®ue", 
id
);

1283  
”r
;

1285 
”r
 = 
	`¢d_pcm_Ïd¥a_fšd_pÜt_idx
(&
uv®
, 
Ílug
, 
io
->
pdesc
 | 
LADSPA_PORT_CONTROL
, 
pÜt
);

1286 ià(
”r
 < 0) {

1287 
	`SNDERR
("internalƒrror");

1288  
”r
;

1290 
io
->
cÚŒŞs_š™Ÿlized
[
uv®
] = 1;

1291 
io
->
cÚŒŞs
[
uv®
] = (
LADSPA_D©a
)
dv®
;

1295 
	}
}

1297 
	$¢d_pcm_Ïd¥a_·r£_bšdšgs
(
¢d_pcm_Ïd¥a_¶ugš_t
 *
Ílug
,

1298 
¢d_pcm_Ïd¥a_¶ugš_io_t
 *
io
,

1299 
¢d_cÚfig_t
 *
bšdšgs
)

1301 
couÁ
 = 0;

1302 *
¬¿y
;

1303 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1304 
”r
;

1306 ià(
	`¢d_cÚfig_g‘_ty³
(
bšdšgs
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1307 
	`SNDERR
("bindings definition must be‡ compound");

1308  -
EINVAL
;

1310 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
bšdšgs
) {

1311 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1312 cÚ¡ *
id
;

1313 
chªÃl
;

1314 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1316 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
chªÃl
);

1317 ià(
”r
 < 0 || 
chªÃl
 < 0) {

1318 
	`SNDERR
("Inv®id chªÃÈnumb”: %s", 
id
);

1319  -
EINVAL
;

1321 ià(
Ílug
->
pŞicy
 =ğ
SND_PCM_LADSPA_POLICY_DUPLICATE
 && 
chªÃl
 > 0) {

1322 
	`SNDERR
("Wrong channel specification for duplicate…olicy");

1323  -
EINVAL
;

1325 ià(
couÁ
 < ()(
chªÃl
 + 1))

1326 
couÁ
 = ()(
chªÃl
 + 1);

1328 ià(
couÁ
 > 0) {

1329 
¬¿y
 = (*)
	`m®loc
(
couÁ
 * ());

1330 ià(! 
¬¿y
)

1331  -
ENOMEM
;

1332 
	`mem£t
(
¬¿y
, 0xff, 
couÁ
 * ());

1333 
io
->
pÜt_bšdšgs_size
 = 
couÁ
;

1334 
io
->
pÜt_bšdšgs
 = 
¬¿y
;

1335 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
bšdšgs
) {

1336 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1337 cÚ¡ *
id
, *
¥Üt
;

1338 
chªÃl
, 
pÜt
;

1339 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1341 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
chªÃl
);

1342 ià(
”r
 < 0 || 
chªÃl
 < 0) {

1343 
	`as£¹
(0);

1344  -
EINVAL
;

1346 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
pÜt
);

1347 ià(
”r
 >= 0) {

1348 
”r
 = 
	`¢d_pcm_Ïd¥a_fšd_pÜt
(&
¬¿y
[
chªÃl
], 
Ílug
, 
io
->
pdesc
 | 
LADSPA_PORT_AUDIO
, 
pÜt
);

1349 ià(
”r
 < 0) {

1350 
	`SNDERR
("UÇbËØfšd‡ÀaudiØpÜˆ(%lièfÜ chªÃÈ%s", 
pÜt
, 
id
);

1351  
”r
;

1355 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¥Üt
);

1356 ià(
”r
 < 0) {

1357 
	`SNDERR
("Inv®id LADSPA…Üˆf›ldy³ fÜ %s", 
id
);

1358  -
EINVAL
;

1360 
”r
 = 
	`¢d_pcm_Ïd¥a_fšd_¥Üt
(&
¬¿y
[
chªÃl
], 
Ílug
, 
io
->
pdesc
 | 
LADSPA_PORT_AUDIO
, 
¥Üt
);

1361 ià(
”r
 < 0) {

1362 
	`SNDERR
("UÇbËØfšd‡ÀaudiØpÜˆ(%sèfÜ chªÃÈ%s", 
¥Üt
, 
id
);

1363  
”r
;

1369 
	}
}

1371 
	$¢d_pcm_Ïd¥a_·r£_iocÚfig
(
¢d_pcm_Ïd¥a_¶ugš_t
 *
Ílug
,

1372 
¢d_pcm_Ïd¥a_¶ugš_io_t
 *
io
,

1373 
¢d_cÚfig_t
 *
cÚf
)

1375 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1376 
¢d_cÚfig_t
 *
bšdšgs
 = 
NULL
, *
cÚŒŞs
 = NULL;

1377 
”r
;

1380 
”r
 = 
	`¢d_pcm_Ïd¥a_add_deçuÉ_cÚŒŞs
(
Ílug
, 
io
);

1381 ià(
”r
 < 0) {

1382 
	`SNDERR
("error‡dding default controls");

1383  
”r
;

1386 ià(
cÚf
 =ğ
NULL
) {

1390 ià(
	`¢d_cÚfig_g‘_ty³
(
cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1391 
	`SNDERR
("input or output definition must be‡ compound");

1392  -
EINVAL
;

1394 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1395 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1396 cÚ¡ *
id
;

1397 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1399 ià(
	`¡rcmp
(
id
, "bindings") == 0) {

1400 
bšdšgs
 = 
n
;

1403 ià(
	`¡rcmp
(
id
, "controls") == 0) {

1404 
cÚŒŞs
 = 
n
;

1410 ià(
cÚŒŞs
 && !(
io
->
pdesc
 & 
LADSPA_PORT_OUTPUT
)) {

1411 
”r
 = 
	`¢d_pcm_Ïd¥a_·r£_cÚŒŞs
(
Ílug
, 
io
, 
cÚŒŞs
);

1412 ià(
”r
 < 0)

1413  
”r
;

1416 ià(
bšdšgs
) {

1417 
”r
 = 
	`¢d_pcm_Ïd¥a_·r£_bšdšgs
(
Ílug
, 
io
, 
bšdšgs
);

1418 ià(
”r
 < 0)

1419  
”r
;

1424 
	}
}

1426 
	$¢d_pcm_Ïd¥a_add_¶ugš
(
li¡_h—d
 *
li¡
,

1427 cÚ¡ *
·th
,

1428 
¢d_cÚfig_t
 *
¶ugš
,

1429 
»v”£
)

1431 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1432 cÚ¡ *
Ïb–
 = 
NULL
, *
f’ame
 = NULL;

1433 
Ïd¥a_id
 = 0;

1434 
”r
;

1435 
¢d_pcm_Ïd¥a_¶ugš_t
 *
Ílug
;

1436 
¢d_pcm_Ïd¥a_pŞicy_t
 
pŞicy
 = 
SND_PCM_LADSPA_POLICY_DUPLICATE
;

1437 
¢d_cÚfig_t
 *
šput
 = 
NULL
, *
ouut
 = NULL;

1439 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
¶ugš
) {

1440 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1441 cÚ¡ *
id
;

1442 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1444 ià(
	`¡rcmp
(
id
, "label") == 0) {

1445 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
Ïb–
);

1446 ià(
”r
 < 0)

1447  
”r
;

1450 ià(
	`¡rcmp
(
id
, "id") == 0) {

1451 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
Ïd¥a_id
);

1452 ià(
”r
 < 0)

1453  
”r
;

1456 ià(
	`¡rcmp
(
id
, "filename") == 0) {

1457 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
f’ame
);

1458 ià(
”r
 < 0)

1459  
”r
;

1462 ià(
	`¡rcmp
(
id
, "input") == 0) {

1463 
šput
 = 
n
;

1466 ià(
	`¡rcmp
(
id
, "output") == 0) {

1467 
ouut
 = 
n
;

1470 ià(
	`¡rcmp
(
id
, "policy") == 0) {

1471 cÚ¡ *
¡r
;

1472 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
);

1473 ià(
”r
 < 0) {

1474 
	`SNDERR
("policy field must be‡ string");

1475  
”r
;

1477 ià(
	`¡rcmp
(
¡r
, "none") == 0)

1478 
pŞicy
 = 
SND_PCM_LADSPA_POLICY_NONE
;

1479 ià(
	`¡rcmp
(
¡r
, "duplicate") == 0)

1480 
pŞicy
 = 
SND_PCM_LADSPA_POLICY_DUPLICATE
;

1482 
	`SNDERR
("unknown…olicy definition");

1483  -
EINVAL
;

1488 ià(
Ïb–
 =ğ
NULL
 && 
Ïd¥a_id
 <= 0) {

1489 
	`SNDERR
("no…lugin†abel or id");

1490  -
EINVAL
;

1492 
Ílug
 = (
¢d_pcm_Ïd¥a_¶ugš_t
 *)
	`ÿÎoc
(1, (snd_pcm_ladspa_plugin_t));

1493 ià(
Ílug
 =ğ
NULL
)

1494  -
ENOMEM
;

1495 
Ílug
->
pŞicy
 =…olicy;

1496 
Ílug
->
šput
.
pdesc
 = 
LADSPA_PORT_INPUT
;

1497 
Ílug
->
ouut
.
pdesc
 = 
LADSPA_PORT_OUTPUT
;

1498 
	`INIT_LIST_HEAD
(&
Ílug
->
š¡ªûs
);

1499 ià(
f’ame
) {

1500 
”r
 = 
	`¢d_pcm_Ïd¥a_check_fe
(
Ílug
, 
f’ame
, 
Ïb–
, 
Ïd¥a_id
);

1501 ià(
”r
 < 0) {

1502 
	`SNDERR
("UÇbËØlßd…lugš '%s' ID %li, f’am'%s'", 
Ïb–
, 
Ïd¥a_id
, 
f’ame
);

1503 
	`ä“
(
Ílug
);

1504  
”r
;

1507 
”r
 = 
	`¢d_pcm_Ïd¥a_look_fÜ_¶ugš
(
Ílug
, 
·th
, 
Ïb–
, 
Ïd¥a_id
);

1508 ià(
”r
 < 0) {

1509 
	`SNDERR
("UÇbËØfšd o¸lßd…lugš '%s' ID %li,…©h '%s'", 
Ïb–
, 
Ïd¥a_id
, 
·th
);

1510 
	`ä“
(
Ílug
);

1511  
”r
;

1514 ià(!
»v”£
) {

1515 
	`li¡_add_
(&
Ílug
->
li¡
,†ist);

1517 
	`li¡_add
(&
Ílug
->
li¡
,†ist);

1519 
”r
 = 
	`¢d_pcm_Ïd¥a_·r£_iocÚfig
(
Ílug
, &Ílug->
šput
, input);

1520 ià(
”r
 < 0)

1521  
”r
;

1522 
”r
 = 
	`¢d_pcm_Ïd¥a_·r£_iocÚfig
(
Ílug
, &Ílug->
ouut
, output);

1523 ià(
”r
 < 0)

1524  
”r
;

1526 
	}
}

1528 
	$¢d_pcm_Ïd¥a_bud_¶ugšs
(
li¡_h—d
 *
li¡
,

1529 cÚ¡ *
·th
,

1530 
¢d_cÚfig_t
 *
¶ugšs
,

1531 
»v”£
)

1533 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1534 
idx
 = 0, 
h™
, 
”r
;

1536 ià(
¶ugšs
 =ğ
NULL
)

1538 ià(
	`¢d_cÚfig_g‘_ty³
(
¶ugšs
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1539 
	`SNDERR
("plugins must be defined inside‡ compound");

1540  -
EINVAL
;

1543 
h™
 = 0;

1544 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
¶ugšs
) {

1545 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1546 cÚ¡ *
id
;

1547 
i
;

1548 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1550 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
i
);

1551 ià(
”r
 < 0) {

1552 
	`SNDERR
("id oàf›ld % i nÙ‡Àš‹g”", 
id
);

1553  
”r
;

1555 ià(
i
 =ğ
idx
) {

1556 
idx
++;

1557 
”r
 = 
	`¢d_pcm_Ïd¥a_add_¶ugš
(
li¡
, 
·th
, 
n
, 
»v”£
);

1558 ià(
”r
 < 0)

1559  
”r
;

1560 
h™
 = 1;

1563 } 
h™
);

1564 ià(
	`li¡_em±y
(
li¡
)) {

1565 
	`SNDERR
("empty…lugin†ist is‚ot‡ccepted");

1566  -
EINVAL
;

1569 
	}
}

1586 
	$¢d_pcm_Ïd¥a_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1587 cÚ¡ *
Ïd¥a_·th
,

1588 
chªÃls
,

1589 
¢d_cÚfig_t
 *
Ïd¥a_µlugšs
,

1590 
¢d_cÚfig_t
 *
Ïd¥a_ılugšs
,

1591 
¢d_pcm_t
 *
¦ave
, 
şo£_¦ave
)

1593 
¢d_pcm_t
 *
pcm
;

1594 
¢d_pcm_Ïd¥a_t
 *
Ïd¥a
;

1595 
”r
, 
»v”£
 = 0;

1597 
	`as£¹
(
pcmp
 && (
Ïd¥a_µlugšs
 || 
Ïd¥a_ılugšs
è&& 
¦ave
);

1599 ià(!
Ïd¥a_·th
 && !Öad¥a_·th = 
	`g‘’v
("LADSPA_PATH")))

1600  -
ENOENT
;

1601 
Ïd¥a
 = 
	`ÿÎoc
(1, (
¢d_pcm_Ïd¥a_t
));

1602 ià(!
Ïd¥a
)

1603  -
ENOMEM
;

1604 
	`¢d_pcm_¶ugš_š™
(&
Ïd¥a
->
¶ug
);

1605 
Ïd¥a
->
¶ug
.
š™
 = 
¢d_pcm_Ïd¥a_š™
;

1606 
Ïd¥a
->
¶ug
.
»ad
 = 
¢d_pcm_Ïd¥a_»ad_¬—s
;

1607 
Ïd¥a
->
¶ug
.
wr™e
 = 
¢d_pcm_Ïd¥a_wr™e_¬—s
;

1608 
Ïd¥a
->
¶ug
.
undo_»ad
 = 
¢d_pcm_¶ugš_undo_»ad_g’”ic
;

1609 
Ïd¥a
->
¶ug
.
undo_wr™e
 = 
¢d_pcm_¶ugš_undo_wr™e_g’”ic
;

1610 
Ïd¥a
->
¶ug
.
g’
.
¦ave
 = slave;

1611 
Ïd¥a
->
¶ug
.
g’
.
şo£_¦ave
 = close_slave;

1613 
	`INIT_LIST_HEAD
(&
Ïd¥a
->
µlugšs
);

1614 
	`INIT_LIST_HEAD
(&
Ïd¥a
->
ılugšs
);

1615 
Ïd¥a
->
chªÃls
 = channels;

1617 ià(
¦ave
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

1618 
”r
 = 
	`¢d_pcm_Ïd¥a_bud_¶ugšs
(&
Ïd¥a
->
µlugšs
, 
Ïd¥a_·th
, 
Ïd¥a_µlugšs
, 
»v”£
);

1619 ià(
”r
 < 0) {

1620 
	`¢d_pcm_Ïd¥a_ä“
(
Ïd¥a
);

1621  
”r
;

1624 ià(
¦ave
->
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
) {

1625 ià(
Ïd¥a_ılugšs
 =ğ
Ïd¥a_µlugšs
)

1626 
»v”£
 = 1;

1627 
”r
 = 
	`¢d_pcm_Ïd¥a_bud_¶ugšs
(&
Ïd¥a
->
ılugšs
, 
Ïd¥a_·th
, 
Ïd¥a_ılugšs
, 
»v”£
);

1628 ià(
”r
 < 0) {

1629 
	`¢d_pcm_Ïd¥a_ä“
(
Ïd¥a
);

1630  
”r
;

1634 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_LADSPA
, 
Çme
, 
¦ave
->
¡»am
, sÏve->
mode
);

1635 ià(
”r
 < 0) {

1636 
	`¢d_pcm_Ïd¥a_ä“
(
Ïd¥a
);

1637  
”r
;

1639 
pcm
->
İs
 = &
¢d_pcm_Ïd¥a_İs
;

1640 
pcm
->
ç¡_İs
 = &
¢d_pcm_¶ugš_ç¡_İs
;

1641 
pcm
->
´iv©e_d©a
 = 
Ïd¥a
;

1642 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

1643 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

1644 
pcm
->
t¡amp_ty³
 = 
¦ave
->tstamp_type;

1645 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
Ïd¥a
->
¶ug
.
hw_±r
, -1, 0);

1646 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
Ïd¥a
->
¶ug
.
­¶_±r
, -1, 0);

1647 *
pcmp
 = 
pcm
;

1650 
	}
}

1733 
	$_¢d_pcm_Ïd¥a_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1734 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

1735 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

1737 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1738 
”r
;

1739 
¢d_pcm_t
 *
¥cm
;

1740 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

1741 cÚ¡ *
·th
 = 
NULL
;

1742 
chªÃls
 = 0;

1743 
¢d_cÚfig_t
 *
¶ugšs
 = 
NULL
, *
µlugšs
 = NULL, *
ılugšs
 = NULL;

1744 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1745 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1746 cÚ¡ *
id
;

1747 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1749 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

1751 ià(
	`¡rcmp
(
id
, "slave") == 0) {

1752 
¦ave
 = 
n
;

1755 ià(
	`¡rcmp
(
id
, "path") == 0) {

1756 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
·th
);

1759 ià(
	`¡rcmp
(
id
, "channels") == 0) {

1760 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
chªÃls
);

1761 ià(
chªÃls
 > 1024)

1762 
chªÃls
 = 1024;

1763 ià(
chªÃls
 < 0)

1764 
chªÃls
 = 0;

1767 ià(
	`¡rcmp
(
id
, "plugins") == 0) {

1768 
¶ugšs
 = 
n
;

1771 ià(
	`¡rcmp
(
id
, "playback_plugins") == 0) {

1772 
µlugšs
 = 
n
;

1775 ià(
	`¡rcmp
(
id
, "capture_plugins") == 0) {

1776 
ılugšs
 = 
n
;

1779 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

1780  -
EINVAL
;

1782 ià(!
¦ave
) {

1783 
	`SNDERR
("slave is‚ot defined");

1784  -
EINVAL
;

1786 ià(
¶ugšs
) {

1787 ià(
µlugšs
 || 
ılugšs
) {

1788 
	`SNDERR
("'plugins' definition cannot be combined with 'playback_plugins' or 'capture_plugins'");

1789  -
EINVAL
;

1791 
µlugšs
 = 
¶ugšs
;

1792 
ılugšs
 = 
¶ugšs
;

1794 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 0);

1795 ià(
”r
 < 0)

1796  
”r
;

1797 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

1798 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1799 ià(
”r
 < 0)

1800  
”r
;

1801 
”r
 = 
	`¢d_pcm_Ïd¥a_İ’
(
pcmp
, 
Çme
, 
·th
, 
chªÃls
, 
µlugšs
, 
ılugšs
, 
¥cm
, 1);

1802 ià(
”r
 < 0)

1803 
	`¢d_pcm_şo£
(
¥cm
);

1804  
”r
;

1805 
	}
}

1806 #iâdeà
DOC_HIDDEN


1807 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_Ïd¥a_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_lfloat.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_¶ugš.h
"

31 
	~"¶ugš_İs.h
"

32 
	~"bsw­.h
"

34 #iâdeà
DOC_HIDDEN


36 
	tæßt_t
;

37 
	tdoubË_t
;

39 #ià
__GNUC__
 < 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 <= 91)

40 
	#BUGGY_GCC


	)

43 #iâdeà
PIC


45 cÚ¡ *
	g_¢d_moduË_pcm_læßt
 = "";

50 
¢d_pcm_¶ugš_t
 
	m¶ug
;

51 
	mšt32_idx
;

52 
	mæßt32_idx
;

53 
¢d_pcm_fÜm©_t
 
	msfÜm©
;

54 (*
	mfunc
)(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
	md¡_¬—s
, 
¢d_pcm_uäames_t
 
	md¡_off£t
,

55 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
	m¤c_¬—s
, 
¢d_pcm_uäames_t
 
	m¤c_off£t
,

56 
	mchªÃls
, 
¢d_pcm_uäames_t
 
	mäames
,

57 
	mg‘32idx
, 
	mput32æßtidx
);

58 } 
	t¢d_pcm_læßt_t
;

60 
	$¢d_pcm_læßt_g‘_s32_šdex
(
¢d_pcm_fÜm©_t
 
fÜm©
)

62 
width
, 
’dŸn
;

64 
fÜm©
) {

65 
SND_PCM_FORMAT_FLOAT_LE
:

66 
SND_PCM_FORMAT_FLOAT_BE
:

67 
width
 = 32;

69 
SND_PCM_FORMAT_FLOAT64_LE
:

70 
SND_PCM_FORMAT_FLOAT64_BE
:

71 
width
 = 64;

74  -
EINVAL
;

76 #ifdeà
SND_LITTLE_ENDIAN


77 
’dŸn
 = 
	`¢d_pcm_fÜm©_big_’dŸn
(
fÜm©
);

79 
’dŸn
 = 
	`¢d_pcm_fÜm©_l™e_’dŸn
(
fÜm©
);

81  ((
width
 / 32)-1è* 2 + 
’dŸn
;

82 
	}
}

84 
	$¢d_pcm_læßt_put_s32_šdex
(
¢d_pcm_fÜm©_t
 
fÜm©
)

86  
	`¢d_pcm_læßt_g‘_s32_šdex
(
fÜm©
);

87 
	}
}

91 #iâdeà
BUGGY_GCC


93 #iâdeà
DOC_HIDDEN


95 
	$¢d_pcm_læßt_cÚv”t_š‹g”_æßt
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
, 
¢d_pcm_uäames_t
 
d¡_off£t
,

96 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
, 
¢d_pcm_uäames_t
 
¤c_off£t
,

97 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

98 
g‘32idx
, 
put32æßtidx
)

100 
	#GET32_LABELS


	)

101 
	#PUT32F_LABELS


	)

102 
	~"¶ugš_İs.h
"

103 #undeà
PUT32F_LABELS


104 #undeà
GET32_LABELS


105 *
g‘32
 = 
g‘32_Ïb–s
[
g‘32idx
];

106 *
put32æßt
 = 
put32æßt_Ïb–s
[
put32æßtidx
];

107 
chªÃl
;

108 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++channel) {

109 cÚ¡ *
¤c
;

110 *
d¡
;

111 
¤c_¡•
, 
d¡_¡•
;

112 
¢d_pcm_uäames_t
 
äames1
;

113 
št32_t
 
§m¶e
 = 0;

114 
¢d_tmp_æßt_t
 
tmp_æßt
;

115 
¢d_tmp_doubË_t
 
tmp_doubË
;

116 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

117 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

118 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

119 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

120 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
);

121 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
);

122 
äames1
 = 
äames
;

123 
äames1
-- > 0) {

124 *
g‘32
;

125 
	#GET32_END
 
§m¶e_lßded


	)

126 
	~"¶ugš_İs.h
"

127 #undeà
GET32_END


128 
§m¶e_lßded
:

129 *
put32æßt
;

130 
	#PUT32F_END
 
§m¶e_put


	)

131 
	~"¶ugš_İs.h
"

132 #undeà
PUT32F_END


133 
§m¶e_put
:

134 
¤c
 +ğ
¤c_¡•
;

135 
d¡
 +ğ
d¡_¡•
;

138 
	}
}

140 
	$¢d_pcm_læßt_cÚv”t_æßt_š‹g”
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
, 
¢d_pcm_uäames_t
 
d¡_off£t
,

141 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
, 
¢d_pcm_uäames_t
 
¤c_off£t
,

142 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

143 
put32idx
, 
g‘32æßtidx
)

145 
	#PUT32_LABELS


	)

146 
	#GET32F_LABELS


	)

147 
	~"¶ugš_İs.h
"

148 #undeà
GET32F_LABELS


149 #undeà
PUT32_LABELS


150 *
put32
 = 
put32_Ïb–s
[
put32idx
];

151 *
g‘32æßt
 = 
g‘32æßt_Ïb–s
[
g‘32æßtidx
];

152 
chªÃl
;

153 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++channel) {

154 cÚ¡ *
¤c
;

155 *
d¡
;

156 
¤c_¡•
, 
d¡_¡•
;

157 
¢d_pcm_uäames_t
 
äames1
;

158 
št32_t
 
§m¶e
 = 0;

159 
¢d_tmp_æßt_t
 
tmp_æßt
;

160 
¢d_tmp_doubË_t
 
tmp_doubË
;

161 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

162 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

163 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

164 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

165 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
);

166 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
);

167 
äames1
 = 
äames
;

168 
äames1
-- > 0) {

169 *
g‘32æßt
;

170 
	#GET32F_END
 
§m¶e_lßded


	)

171 
	~"¶ugš_İs.h
"

172 #undeà
GET32F_END


173 
§m¶e_lßded
:

174 *
put32
;

175 
	#PUT32_END
 
§m¶e_put


	)

176 
	~"¶ugš_İs.h
"

177 #undeà
PUT32_END


178 
§m¶e_put
:

179 
¤c
 +ğ
¤c_¡•
;

180 
d¡
 +ğ
d¡_¡•
;

183 
	}
}

187 
	$¢d_pcm_læßt_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

189 
¢d_pcm_læßt_t
 *
læßt
 = 
pcm
->
´iv©e_d©a
;

190 
”r
;

191 
¢d_pcm_acûss_mask_t
 
acûss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

192 
¢d_pcm_fÜm©_mask_t
 
lfÜm©_mask
 = { 
SND_PCM_FMTBIT_LINEAR
 };

193 
¢d_pcm_fÜm©_mask_t
 
ffÜm©_mask
 = { 
SND_PCM_FMTBIT_FLOAT
 };

194 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

195 &
acûss_mask
);

196 ià(
”r
 < 0)

197  
”r
;

198 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
,

199 
	`¢d_pcm_fÜm©_lš—r
(
læßt
->
sfÜm©
) ?

200 &
ffÜm©_mask
 : &
lfÜm©_mask
);

201 ià(
”r
 < 0)

202  
”r
;

203 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
·¿ms
, 
SND_PCM_SUBFORMAT_STD
);

204 ià(
”r
 < 0)

205  
”r
;

206 
·¿ms
->
šfo
 &ğ~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

208 
	}
}

210 
	$¢d_pcm_læßt_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

212 
¢d_pcm_læßt_t
 *
læßt
 = 
pcm
->
´iv©e_d©a
;

213 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

214 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

215 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

216 &
§cûss_mask
);

217 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
¥¬ams
, 
læßt
->
sfÜm©
);

218 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¥¬ams
, 
SND_PCM_SUBFORMAT_STD
);

220 
	}
}

222 
	$¢d_pcm_læßt_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

223 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

225 
”r
;

226 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

227 
SND_PCM_HW_PARBIT_RATE
 |

228 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

229 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

230 
SND_PCM_HW_PARBIT_PERIODS
 |

231 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

232 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

233 
SND_PCM_HW_PARBIT_TICK_TIME
);

234 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

235 ià(
”r
 < 0)

236  
”r
;

238 
	}
}

240 
	$¢d_pcm_læßt_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

241 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

243 
”r
;

244 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

245 
SND_PCM_HW_PARBIT_RATE
 |

246 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

247 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

248 
SND_PCM_HW_PARBIT_PERIODS
 |

249 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

250 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

251 
SND_PCM_HW_PARBIT_TICK_TIME
);

252 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

253 ià(
”r
 < 0)

254  
”r
;

256 
	}
}

258 
	$¢d_pcm_læßt_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

260  
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

261 
¢d_pcm_læßt_hw_»fše_ı»·»
,

262 
¢d_pcm_læßt_hw_»fše_cchªge
,

263 
¢d_pcm_læßt_hw_»fše_¥»·»
,

264 
¢d_pcm_læßt_hw_»fše_schªge
,

265 
¢d_pcm_g’”ic_hw_»fše
);

266 
	}
}

268 
	$¢d_pcm_læßt_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

270 
¢d_pcm_læßt_t
 *
læßt
 = 
pcm
->
´iv©e_d©a
;

271 
¢d_pcm_t
 *
¦ave
 = 
læßt
->
¶ug
.
g’
.slave;

272 
¢d_pcm_fÜm©_t
 
¤c_fÜm©
, 
d¡_fÜm©
;

273 
”r
 = 
	`¢d_pcm_hw_·¿ms_¦ave
(
pcm
, 
·¿ms
,

274 
¢d_pcm_læßt_hw_»fše_cchªge
,

275 
¢d_pcm_læßt_hw_»fše_¥»·»
,

276 
¢d_pcm_læßt_hw_»fše_schªge
,

277 
¢d_pcm_g’”ic_hw_·¿ms
);

278 ià(
”r
 < 0)

279  
”r
;

280 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

281 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(
·¿ms
, &
¤c_fÜm©
);

282 
d¡_fÜm©
 = 
¦ave
->
fÜm©
;

284 
¤c_fÜm©
 = 
¦ave
->
fÜm©
;

285 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(
·¿ms
, &
d¡_fÜm©
);

287 ià(
	`¢d_pcm_fÜm©_lš—r
(
¤c_fÜm©
)) {

288 
læßt
->
št32_idx
 = 
	`¢d_pcm_lš—r_g‘_šdex
(
¤c_fÜm©
, 
SND_PCM_FORMAT_S32
);

289 
læßt
->
æßt32_idx
 = 
	`¢d_pcm_læßt_put_s32_šdex
(
d¡_fÜm©
);

290 
læßt
->
func
 = 
¢d_pcm_læßt_cÚv”t_š‹g”_æßt
;

292 
læßt
->
št32_idx
 = 
	`¢d_pcm_lš—r_put_šdex
(
SND_PCM_FORMAT_S32
, 
d¡_fÜm©
);

293 
læßt
->
æßt32_idx
 = 
	`¢d_pcm_læßt_g‘_s32_šdex
(
¤c_fÜm©
);

294 
læßt
->
func
 = 
¢d_pcm_læßt_cÚv”t_æßt_š‹g”
;

297 
	}
}

299 
¢d_pcm_uäames_t


300 
	$¢d_pcm_læßt_wr™e_¬—s
(
¢d_pcm_t
 *
pcm
,

301 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

302 
¢d_pcm_uäames_t
 
off£t
,

303 
¢d_pcm_uäames_t
 
size
,

304 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

305 
¢d_pcm_uäames_t
 
¦ave_off£t
,

306 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

308 
¢d_pcm_læßt_t
 *
læßt
 = 
pcm
->
´iv©e_d©a
;

309 ià(
size
 > *
¦ave_siz•
)

310 
size
 = *
¦ave_siz•
;

311 
læßt
->
	`func
(
¦ave_¬—s
, 
¦ave_off£t
,

312 
¬—s
, 
off£t
,

313 
pcm
->
chªÃls
, 
size
,

314 
læßt
->
št32_idx
,†æßt->
æßt32_idx
);

315 *
¦ave_siz•
 = 
size
;

316  
size
;

317 
	}
}

319 
¢d_pcm_uäames_t


320 
	$¢d_pcm_læßt_»ad_¬—s
(
¢d_pcm_t
 *
pcm
,

321 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

322 
¢d_pcm_uäames_t
 
off£t
,

323 
¢d_pcm_uäames_t
 
size
,

324 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

325 
¢d_pcm_uäames_t
 
¦ave_off£t
,

326 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

328 
¢d_pcm_læßt_t
 *
læßt
 = 
pcm
->
´iv©e_d©a
;

329 ià(
size
 > *
¦ave_siz•
)

330 
size
 = *
¦ave_siz•
;

331 
læßt
->
	`func
(
¬—s
, 
off£t
,

332 
¦ave_¬—s
, 
¦ave_off£t
,

333 
pcm
->
chªÃls
, 
size
,

334 
læßt
->
št32_idx
,†æßt->
æßt32_idx
);

335 *
¦ave_siz•
 = 
size
;

336  
size
;

337 
	}
}

339 
	$¢d_pcm_læßt_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

341 
¢d_pcm_læßt_t
 *
læßt
 = 
pcm
->
´iv©e_d©a
;

342 
	`¢d_ouut_´štf
(
out
, "Linear Integer <-> Linear Float conversion PCM (%s)\n",

343 
	`¢d_pcm_fÜm©_Çme
(
læßt
->
sfÜm©
));

344 ià(
pcm
->
£tup
) {

345 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

346 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

348 
	`¢d_ouut_´štf
(
out
, "Slave: ");

349 
	`¢d_pcm_dump
(
læßt
->
¶ug
.
g’
.
¦ave
, 
out
);

350 
	}
}

352 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_læßt_İs
 = {

353 .
şo£
 = 
¢d_pcm_g’”ic_şo£
,

354 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

355 .
	ghw_»fše
 = 
¢d_pcm_læßt_hw_»fše
,

356 .
	ghw_·¿ms
 = 
¢d_pcm_læßt_hw_·¿ms
,

357 .
	ghw_ä“
 = 
¢d_pcm_g’”ic_hw_ä“
,

358 .
	gsw_·¿ms
 = 
¢d_pcm_g’”ic_sw_·¿ms
,

359 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

360 .
	gdump
 = 
¢d_pcm_læßt_dump
,

361 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

362 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

363 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

364 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

365 .
	gqu”y_chm­s
 = 
¢d_pcm_g’”ic_qu”y_chm­s
,

366 .
	gg‘_chm­
 = 
¢d_pcm_g’”ic_g‘_chm­
,

367 .
	g£t_chm­
 = 
¢d_pcm_g’”ic_£t_chm­
,

382 
	$¢d_pcm_læßt_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
, 
¢d_pcm_fÜm©_t
 
sfÜm©
, snd_pcm_ˆ*
¦ave
, 
şo£_¦ave
)

384 
¢d_pcm_t
 *
pcm
;

385 
¢d_pcm_læßt_t
 *
læßt
;

386 
”r
;

387 
	`as£¹
(
pcmp
 && 
¦ave
);

388 ià(
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1 &&

389 
	`¢d_pcm_fÜm©_æßt
(
sfÜm©
) != 1)

390  -
EINVAL
;

391 
læßt
 = 
	`ÿÎoc
(1, (
¢d_pcm_læßt_t
));

392 ià(!
læßt
) {

393  -
ENOMEM
;

395 
	`¢d_pcm_¶ugš_š™
(&
læßt
->
¶ug
);

396 
læßt
->
sfÜm©
 = sformat;

397 
læßt
->
¶ug
.
»ad
 = 
¢d_pcm_læßt_»ad_¬—s
;

398 
læßt
->
¶ug
.
wr™e
 = 
¢d_pcm_læßt_wr™e_¬—s
;

399 
læßt
->
¶ug
.
undo_»ad
 = 
¢d_pcm_¶ugš_undo_»ad_g’”ic
;

400 
læßt
->
¶ug
.
undo_wr™e
 = 
¢d_pcm_¶ugš_undo_wr™e_g’”ic
;

401 
læßt
->
¶ug
.
g’
.
¦ave
 = slave;

402 
læßt
->
¶ug
.
g’
.
şo£_¦ave
 = close_slave;

404 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_LINEAR_FLOAT
, 
Çme
, 
¦ave
->
¡»am
, sÏve->
mode
);

405 ià(
”r
 < 0) {

406 
	`ä“
(
læßt
);

407  
”r
;

409 
pcm
->
İs
 = &
¢d_pcm_læßt_İs
;

410 
pcm
->
ç¡_İs
 = &
¢d_pcm_¶ugš_ç¡_İs
;

411 
pcm
->
´iv©e_d©a
 = 
læßt
;

412 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

413 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

414 
pcm
->
t¡amp_ty³
 = 
¦ave
->tstamp_type;

415 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
læßt
->
¶ug
.
hw_±r
, -1, 0);

416 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
læßt
->
¶ug
.
­¶_±r
, -1, 0);

417 *
pcmp
 = 
pcm
;

420 
	}
}

466 
	$_¢d_pcm_læßt_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

467 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

468 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

470 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

471 
”r
;

472 
¢d_pcm_t
 *
¥cm
;

473 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

474 
¢d_pcm_fÜm©_t
 
sfÜm©
;

475 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

476 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

477 cÚ¡ *
id
;

478 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

480 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

482 ià(
	`¡rcmp
(
id
, "slave") == 0) {

483 
¦ave
 = 
n
;

486 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

487  -
EINVAL
;

489 ià(!
¦ave
) {

490 
	`SNDERR
("slave is‚ot defined");

491  -
EINVAL
;

493 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 1,

494 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_MANDATORY
, &
sfÜm©
);

495 ià(
”r
 < 0)

496  
”r
;

497 ià(
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1 &&

498 
	`¢d_pcm_fÜm©_æßt
(
sfÜm©
) != 1) {

499 
	`¢d_cÚfig_d–‘e
(
scÚf
);

500 
	`SNDERR
("slave format is‚ot†inear integer or†inear float");

501  -
EINVAL
;

503 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

504 
	`¢d_cÚfig_d–‘e
(
scÚf
);

505 ià(
”r
 < 0)

506  
”r
;

507 
”r
 = 
	`¢d_pcm_læßt_İ’
(
pcmp
, 
Çme
, 
sfÜm©
, 
¥cm
, 1);

508 ià(
”r
 < 0)

509 
	`¢d_pcm_şo£
(
¥cm
);

510  
”r
;

511 
	}
}

512 #iâdeà
DOC_HIDDEN


513 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_læßt_İ’
, 
SND_PCM_DLSYM_VERSION
);

518 
	$¢d_pcm_læßt_İ’
(
¢d_pcm_t
 **
pcmp
 
ATTRIBUTE_UNUSED
,

519 cÚ¡ *
Çme
 
ATTRIBUTE_UNUSED
,

520 
¢d_pcm_fÜm©_t
 
sfÜm©
 
ATTRIBUTE_UNUSED
,

521 
¢d_pcm_t
 *
¦ave
 
ATTRIBUTE_UNUSED
,

522 
şo£_¦ave
 
ATTRIBUTE_UNUSED
)

524 
	`SNDERR
("please, upgrade your GCCo use†float…lugin");

525  -
EINVAL
;

526 
	}
}

528 
	$_¢d_pcm_læßt_İ’
(
¢d_pcm_t
 **
pcmp
 
ATTRIBUTE_UNUSED
,

529 cÚ¡ *
Çme
 
ATTRIBUTE_UNUSED
,

530 
¢d_cÚfig_t
 *
roÙ
 
ATTRIBUTE_UNUSED
,

531 
¢d_cÚfig_t
 *
cÚf
 
ATTRIBUTE_UNUSED
,

532 
¢d_pcm_¡»am_t
 
¡»am
 
ATTRIBUTE_UNUSED
,

533 
mode
 
ATTRIBUTE_UNUSED
)

535 
	`SNDERR
("please, upgrade your GCCo use†float…lugin");

536  -
EINVAL
;

537 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_linear.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_¶ugš.h
"

31 
	~"¶ugš_İs.h
"

32 
	~"bsw­.h
"

34 #iâdeà
PIC


36 cÚ¡ *
	g_¢d_moduË_pcm_lš—r
 = "";

39 #iâdeà
DOC_HIDDEN


42 
¢d_pcm_¶ugš_t
 
	m¶ug
;

43 
	mu£_g‘put
;

44 
	mcÚv_idx
;

45 
	mg‘_idx
, 
	mput_idx
;

46 
¢d_pcm_fÜm©_t
 
	msfÜm©
;

47 } 
	t¢d_pcm_lš—r_t
;

50 #iâdeà
DOC_HIDDEN


52 
	$¢d_pcm_lš—r_cÚv”t_šdex
(
¢d_pcm_fÜm©_t
 
¤c_fÜm©
,

53 
¢d_pcm_fÜm©_t
 
d¡_fÜm©
)

55 
¤c_’dŸn
, 
d¡_’dŸn
, 
sign
, 
¤c_width
, 
d¡_width
;

57 
sign
 = (
	`¢d_pcm_fÜm©_sigÃd
(
¤c_fÜm©
) !=

58 
	`¢d_pcm_fÜm©_sigÃd
(
d¡_fÜm©
));

59 #ifdeà
SND_LITTLE_ENDIAN


60 
¤c_’dŸn
 = 
	`¢d_pcm_fÜm©_big_’dŸn
(
¤c_fÜm©
);

61 
d¡_’dŸn
 = 
	`¢d_pcm_fÜm©_big_’dŸn
(
d¡_fÜm©
);

63 
¤c_’dŸn
 = 
	`¢d_pcm_fÜm©_l™e_’dŸn
(
¤c_fÜm©
);

64 
d¡_’dŸn
 = 
	`¢d_pcm_fÜm©_l™e_’dŸn
(
d¡_fÜm©
);

67 ià(
¤c_’dŸn
 < 0)

68 
¤c_’dŸn
 = 0;

69 ià(
d¡_’dŸn
 < 0)

70 
d¡_’dŸn
 = 0;

72 
¤c_width
 = 
	`¢d_pcm_fÜm©_width
(
¤c_fÜm©
) / 8 - 1;

73 
d¡_width
 = 
	`¢d_pcm_fÜm©_width
(
d¡_fÜm©
) / 8 - 1;

75  
¤c_width
 * 32 + 
¤c_’dŸn
 * 16 + 
sign
 * 8 + 
d¡_width
 * 2 + 
d¡_’dŸn
;

76 
	}
}

78 
	$¢d_pcm_lš—r_g‘_šdex
(
¢d_pcm_fÜm©_t
 
¤c_fÜm©
, snd_pcm_fÜm©_ˆ
d¡_fÜm©
)

80 
sign
, 
width
, 
pwidth
, 
’dŸn
;

81 
sign
 = (
	`¢d_pcm_fÜm©_sigÃd
(
¤c_fÜm©
) !=

82 
	`¢d_pcm_fÜm©_sigÃd
(
d¡_fÜm©
));

83 #ifdeà
SND_LITTLE_ENDIAN


84 
’dŸn
 = 
	`¢d_pcm_fÜm©_big_’dŸn
(
¤c_fÜm©
);

86 
’dŸn
 = 
	`¢d_pcm_fÜm©_l™e_’dŸn
(
¤c_fÜm©
);

88 ià(
’dŸn
 < 0)

89 
’dŸn
 = 0;

90 
pwidth
 = 
	`¢d_pcm_fÜm©_physiÿl_width
(
¤c_fÜm©
);

91 
width
 = 
	`¢d_pcm_fÜm©_width
(
¤c_fÜm©
);

92 ià(
pwidth
 == 24) {

93 
width
) {

95 
width
 = 0; ;

97 
width
 = 1; ;

100 
width
 = 2; ;

102  
width
 * 4 + 
’dŸn
 * 2 + 
sign
 + 20;

104 ià(
width
 == 20)

105 
width
 = 40;

107 
width
 = width / 8 - 1;

108  
width
 * 4 + 
’dŸn
 * 2 + 
sign
;

110 
	}
}

112 
	$¢d_pcm_lš—r_put_šdex
(
¢d_pcm_fÜm©_t
 
¤c_fÜm©
, snd_pcm_fÜm©_ˆ
d¡_fÜm©
)

114 
sign
, 
width
, 
pwidth
, 
’dŸn
;

115 
sign
 = (
	`¢d_pcm_fÜm©_sigÃd
(
¤c_fÜm©
) !=

116 
	`¢d_pcm_fÜm©_sigÃd
(
d¡_fÜm©
));

117 #ifdeà
SND_LITTLE_ENDIAN


118 
’dŸn
 = 
	`¢d_pcm_fÜm©_big_’dŸn
(
d¡_fÜm©
);

120 
’dŸn
 = 
	`¢d_pcm_fÜm©_l™e_’dŸn
(
d¡_fÜm©
);

122 ià(
’dŸn
 < 0)

123 
’dŸn
 = 0;

124 
pwidth
 = 
	`¢d_pcm_fÜm©_physiÿl_width
(
d¡_fÜm©
);

125 
width
 = 
	`¢d_pcm_fÜm©_width
(
d¡_fÜm©
);

126 ià(
pwidth
 == 24) {

127 
width
) {

129 
width
 = 0; ;

131 
width
 = 1; ;

134 
width
 = 2; ;

136  
width
 * 4 + 
’dŸn
 * 2 + 
sign
 + 20;

138 ià(
width
 == 20)

139 
width
 = 40;

141 
width
 = width / 8 - 1;

142  
width
 * 4 + 
’dŸn
 * 2 + 
sign
;

144 
	}
}

146 
	$¢d_pcm_lš—r_cÚv”t
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
, 
¢d_pcm_uäames_t
 
d¡_off£t
,

147 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
, 
¢d_pcm_uäames_t
 
¤c_off£t
,

148 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

149 
cÚvidx
)

151 
	#CONV_LABELS


	)

152 
	~"¶ugš_İs.h
"

153 #undeà
CONV_LABELS


154 *
cÚv
 = 
cÚv_Ïb–s
[
cÚvidx
];

155 
chªÃl
;

156 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++channel) {

157 cÚ¡ *
¤c
;

158 *
d¡
;

159 
¤c_¡•
, 
d¡_¡•
;

160 
¢d_pcm_uäames_t
 
äames1
;

161 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

162 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

163 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

164 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

165 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
);

166 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
);

167 
äames1
 = 
äames
;

168 
äames1
-- > 0) {

169 *
cÚv
;

170 
	#CONV_END
 
aá”


	)

171 
	~"¶ugš_İs.h
"

172 #undeà
CONV_END


173 
aá”
:

174 
¤c
 +ğ
¤c_¡•
;

175 
d¡
 +ğ
d¡_¡•
;

178 
	}
}

180 
	$¢d_pcm_lš—r_g‘put
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
, 
¢d_pcm_uäames_t
 
d¡_off£t
,

181 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
, 
¢d_pcm_uäames_t
 
¤c_off£t
,

182 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

183 
g‘_idx
, 
put_idx
)

185 
	#CONV24_LABELS


	)

186 
	~"¶ugš_İs.h
"

187 #undeà
CONV24_LABELS


188 *
g‘
 = 
g‘32_Ïb–s
[
g‘_idx
];

189 *
put
 = 
put32_Ïb–s
[
put_idx
];

190 
chªÃl
;

191 
ušt32_t
 
§m¶e
 = 0;

192 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++channel) {

193 cÚ¡ *
¤c
;

194 *
d¡
;

195 
¤c_¡•
, 
d¡_¡•
;

196 
¢d_pcm_uäames_t
 
äames1
;

197 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

198 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

199 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

200 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

201 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
);

202 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
);

203 
äames1
 = 
äames
;

204 
äames1
-- > 0) {

205 *
g‘
;

206 
	#CONV24_END
 
aá”


	)

207 
	~"¶ugš_İs.h
"

208 #undeà
CONV24_END


209 
aá”
:

210 
¤c
 +ğ
¤c_¡•
;

211 
d¡
 +ğ
d¡_¡•
;

214 
	}
}

218 
	$¢d_pcm_lš—r_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

220 
”r
;

221 
¢d_pcm_acûss_mask_t
 
acûss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

222 
¢d_pcm_fÜm©_mask_t
 
fÜm©_mask
 = { 
SND_PCM_FMTBIT_LINEAR
 };

223 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

224 &
acûss_mask
);

225 ià(
”r
 < 0)

226  
”r
;

227 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
,

228 &
fÜm©_mask
);

229 ià(
”r
 < 0)

230  
”r
;

231 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
·¿ms
, 
SND_PCM_SUBFORMAT_STD
);

232 ià(
”r
 < 0)

233  
”r
;

234 
·¿ms
->
šfo
 &ğ~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

236 
	}
}

238 
	$¢d_pcm_lš—r_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

240 
¢d_pcm_lš—r_t
 *
lš—r
 = 
pcm
->
´iv©e_d©a
;

241 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

242 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

243 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

244 &
§cûss_mask
);

245 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
¥¬ams
, 
lš—r
->
sfÜm©
);

246 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¥¬ams
, 
SND_PCM_SUBFORMAT_STD
);

248 
	}
}

250 
	$¢d_pcm_lš—r_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

251 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

253 
”r
;

254 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

255 
SND_PCM_HW_PARBIT_RATE
 |

256 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

257 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

258 
SND_PCM_HW_PARBIT_PERIODS
 |

259 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

260 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

261 
SND_PCM_HW_PARBIT_TICK_TIME
);

262 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

263 ià(
”r
 < 0)

264  
”r
;

266 
	}
}

268 
	$¢d_pcm_lš—r_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

269 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

271 
”r
;

272 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

273 
SND_PCM_HW_PARBIT_RATE
 |

274 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

275 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

276 
SND_PCM_HW_PARBIT_PERIODS
 |

277 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

278 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

279 
SND_PCM_HW_PARBIT_TICK_TIME
);

280 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

281 ià(
”r
 < 0)

282  
”r
;

284 
	}
}

286 
	$¢d_pcm_lš—r_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

288  
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

289 
¢d_pcm_lš—r_hw_»fše_ı»·»
,

290 
¢d_pcm_lš—r_hw_»fše_cchªge
,

291 
¢d_pcm_lš—r_hw_»fše_¥»·»
,

292 
¢d_pcm_lš—r_hw_»fše_schªge
,

293 
¢d_pcm_g’”ic_hw_»fše
);

294 
	}
}

296 
	$¢d_pcm_lš—r_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

298 
¢d_pcm_lš—r_t
 *
lš—r
 = 
pcm
->
´iv©e_d©a
;

299 
¢d_pcm_fÜm©_t
 
fÜm©
;

300 
”r
 = 
	`¢d_pcm_hw_·¿ms_¦ave
(
pcm
, 
·¿ms
,

301 
¢d_pcm_lš—r_hw_»fše_cchªge
,

302 
¢d_pcm_lš—r_hw_»fše_¥»·»
,

303 
¢d_pcm_lš—r_hw_»fše_schªge
,

304 
¢d_pcm_g’”ic_hw_·¿ms
);

305 ià(
”r
 < 0)

306  
”r
;

307 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(
·¿ms
, &
fÜm©
);

308 ià(
”r
 < 0)

309  
”r
;

310 
lš—r
->
u£_g‘put
 = (
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
) == 24 ||

311 
	`¢d_pcm_fÜm©_physiÿl_width
(
lš—r
->
sfÜm©
) == 24 ||

312 
	`¢d_pcm_fÜm©_width
(
fÜm©
) == 20 ||

313 
	`¢d_pcm_fÜm©_width
(
lš—r
->
sfÜm©
) == 20);

314 ià(
lš—r
->
u£_g‘put
) {

315 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

316 
lš—r
->
g‘_idx
 = 
	`¢d_pcm_lš—r_g‘_šdex
(
fÜm©
, 
SND_PCM_FORMAT_S32
);

317 
lš—r
->
put_idx
 = 
	`¢d_pcm_lš—r_put_šdex
(
SND_PCM_FORMAT_S32
,†š—r->
sfÜm©
);

319 
lš—r
->
g‘_idx
 = 
	`¢d_pcm_lš—r_g‘_šdex
Öš—r->
sfÜm©
, 
SND_PCM_FORMAT_S32
);

320 
lš—r
->
put_idx
 = 
	`¢d_pcm_lš—r_put_šdex
(
SND_PCM_FORMAT_S32
, 
fÜm©
);

323 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

324 
lš—r
->
cÚv_idx
 = 
	`¢d_pcm_lš—r_cÚv”t_šdex
(
fÜm©
,

325 
lš—r
->
sfÜm©
);

327 
lš—r
->
cÚv_idx
 = 
	`¢d_pcm_lš—r_cÚv”t_šdex
Öš—r->
sfÜm©
,

328 
fÜm©
);

331 
	}
}

333 
¢d_pcm_uäames_t


334 
	$¢d_pcm_lš—r_wr™e_¬—s
(
¢d_pcm_t
 *
pcm
,

335 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

336 
¢d_pcm_uäames_t
 
off£t
,

337 
¢d_pcm_uäames_t
 
size
,

338 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

339 
¢d_pcm_uäames_t
 
¦ave_off£t
,

340 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

342 
¢d_pcm_lš—r_t
 *
lš—r
 = 
pcm
->
´iv©e_d©a
;

343 ià(
size
 > *
¦ave_siz•
)

344 
size
 = *
¦ave_siz•
;

345 ià(
lš—r
->
u£_g‘put
)

346 
	`¢d_pcm_lš—r_g‘put
(
¦ave_¬—s
, 
¦ave_off£t
,

347 
¬—s
, 
off£t
,

348 
pcm
->
chªÃls
, 
size
,

349 
lš—r
->
g‘_idx
,†š—r->
put_idx
);

351 
	`¢d_pcm_lš—r_cÚv”t
(
¦ave_¬—s
, 
¦ave_off£t
,

352 
¬—s
, 
off£t
,

353 
pcm
->
chªÃls
, 
size
, 
lš—r
->
cÚv_idx
);

354 *
¦ave_siz•
 = 
size
;

355  
size
;

356 
	}
}

358 
¢d_pcm_uäames_t


359 
	$¢d_pcm_lš—r_»ad_¬—s
(
¢d_pcm_t
 *
pcm
,

360 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

361 
¢d_pcm_uäames_t
 
off£t
,

362 
¢d_pcm_uäames_t
 
size
,

363 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

364 
¢d_pcm_uäames_t
 
¦ave_off£t
,

365 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

367 
¢d_pcm_lš—r_t
 *
lš—r
 = 
pcm
->
´iv©e_d©a
;

368 ià(
size
 > *
¦ave_siz•
)

369 
size
 = *
¦ave_siz•
;

370 ià(
lš—r
->
u£_g‘put
)

371 
	`¢d_pcm_lš—r_g‘put
(
¬—s
, 
off£t
,

372 
¦ave_¬—s
, 
¦ave_off£t
,

373 
pcm
->
chªÃls
, 
size
,

374 
lš—r
->
g‘_idx
,†š—r->
put_idx
);

376 
	`¢d_pcm_lš—r_cÚv”t
(
¬—s
, 
off£t
,

377 
¦ave_¬—s
, 
¦ave_off£t
,

378 
pcm
->
chªÃls
, 
size
, 
lš—r
->
cÚv_idx
);

379 *
¦ave_siz•
 = 
size
;

380  
size
;

381 
	}
}

383 
	$¢d_pcm_lš—r_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

385 
¢d_pcm_lš—r_t
 *
lš—r
 = 
pcm
->
´iv©e_d©a
;

386 
	`¢d_ouut_´štf
(
out
, "Linear conversion PCM (%s)\n",

387 
	`¢d_pcm_fÜm©_Çme
(
lš—r
->
sfÜm©
));

388 ià(
pcm
->
£tup
) {

389 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

390 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

392 
	`¢d_ouut_´štf
(
out
, "Slave: ");

393 
	`¢d_pcm_dump
(
lš—r
->
¶ug
.
g’
.
¦ave
, 
out
);

394 
	}
}

396 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_lš—r_İs
 = {

397 .
şo£
 = 
¢d_pcm_g’”ic_şo£
,

398 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

399 .
	ghw_»fše
 = 
¢d_pcm_lš—r_hw_»fše
,

400 .
	ghw_·¿ms
 = 
¢d_pcm_lš—r_hw_·¿ms
,

401 .
	ghw_ä“
 = 
¢d_pcm_g’”ic_hw_ä“
,

402 .
	gsw_·¿ms
 = 
¢d_pcm_g’”ic_sw_·¿ms
,

403 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

404 .
	gdump
 = 
¢d_pcm_lš—r_dump
,

405 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

406 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

407 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

408 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

409 .
	gqu”y_chm­s
 = 
¢d_pcm_g’”ic_qu”y_chm­s
,

410 .
	gg‘_chm­
 = 
¢d_pcm_g’”ic_g‘_chm­
,

411 .
	g£t_chm­
 = 
¢d_pcm_g’”ic_£t_chm­
,

427 
	$¢d_pcm_lš—r_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
, 
¢d_pcm_fÜm©_t
 
sfÜm©
, snd_pcm_ˆ*
¦ave
, 
şo£_¦ave
)

429 
¢d_pcm_t
 *
pcm
;

430 
¢d_pcm_lš—r_t
 *
lš—r
;

431 
”r
;

432 
	`as£¹
(
pcmp
 && 
¦ave
);

433 ià(
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1)

434  -
EINVAL
;

435 
lš—r
 = 
	`ÿÎoc
(1, (
¢d_pcm_lš—r_t
));

436 ià(!
lš—r
) {

437  -
ENOMEM
;

439 
	`¢d_pcm_¶ugš_š™
(&
lš—r
->
¶ug
);

440 
lš—r
->
sfÜm©
 = sformat;

441 
lš—r
->
¶ug
.
»ad
 = 
¢d_pcm_lš—r_»ad_¬—s
;

442 
lš—r
->
¶ug
.
wr™e
 = 
¢d_pcm_lš—r_wr™e_¬—s
;

443 
lš—r
->
¶ug
.
undo_»ad
 = 
¢d_pcm_¶ugš_undo_»ad_g’”ic
;

444 
lš—r
->
¶ug
.
undo_wr™e
 = 
¢d_pcm_¶ugš_undo_wr™e_g’”ic
;

445 
lš—r
->
¶ug
.
g’
.
¦ave
 = slave;

446 
lš—r
->
¶ug
.
g’
.
şo£_¦ave
 = close_slave;

448 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_LINEAR
, 
Çme
, 
¦ave
->
¡»am
, sÏve->
mode
);

449 ià(
”r
 < 0) {

450 
	`ä“
(
lš—r
);

451  
”r
;

453 
pcm
->
İs
 = &
¢d_pcm_lš—r_İs
;

454 
pcm
->
ç¡_İs
 = &
¢d_pcm_¶ugš_ç¡_İs
;

455 
pcm
->
´iv©e_d©a
 = 
lš—r
;

456 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

457 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

458 
pcm
->
t¡amp_ty³
 = 
¦ave
->tstamp_type;

459 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
lš—r
->
¶ug
.
hw_±r
, -1, 0);

460 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
lš—r
->
¶ug
.
­¶_±r
, -1, 0);

461 *
pcmp
 = 
pcm
;

464 
	}
}

509 
	$_¢d_pcm_lš—r_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

510 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

511 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

513 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

514 
”r
;

515 
¢d_pcm_t
 *
¥cm
;

516 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

517 
¢d_pcm_fÜm©_t
 
sfÜm©
;

518 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

519 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

520 cÚ¡ *
id
;

521 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

523 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

525 ià(
	`¡rcmp
(
id
, "slave") == 0) {

526 
¦ave
 = 
n
;

529 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

530  -
EINVAL
;

532 ià(!
¦ave
) {

533 
	`SNDERR
("slave is‚ot defined");

534  -
EINVAL
;

536 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 1,

537 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_MANDATORY
, &
sfÜm©
);

538 ià(
”r
 < 0)

539  
”r
;

540 ià(
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1) {

541 
	`¢d_cÚfig_d–‘e
(
scÚf
);

542 
	`SNDERR
("slave format is‚ot†inear");

543  -
EINVAL
;

545 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

546 
	`¢d_cÚfig_d–‘e
(
scÚf
);

547 ià(
”r
 < 0)

548  
”r
;

549 
”r
 = 
	`¢d_pcm_lš—r_İ’
(
pcmp
, 
Çme
, 
sfÜm©
, 
¥cm
, 1);

550 ià(
”r
 < 0)

551 
	`¢d_pcm_şo£
(
¥cm
);

552  
”r
;

553 
	}
}

554 #iâdeà
DOC_HIDDEN


555 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_lš—r_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_local.h

23 #iâdeà
__PCM_LOCAL_H


24 
	#__PCM_LOCAL_H


	)

26 
	~"cÚfig.h
"

28 
	~<¡dio.h
>

29 
	~<¡dlib.h
>

30 
	~<lim™s.h
>

31 
	~<sys/uio.h
>

32 
	~<time.h
>

33 
	~<sys/time.h
>

35 
	#_¢d_mask
 
¢drv_mask


	)

36 
	#_¢d_pcm_acûss_mask
 
_¢d_mask


	)

37 
	#_¢d_pcm_fÜm©_mask
 
_¢d_mask


	)

38 
	#_¢d_pcm_subfÜm©_mask
 
_¢d_mask


	)

40 
	~"loÿl.h
"

42 #ifdeà
THREAD_SAFE_API


43 
	#__USE_UNIX98
 1

	)

44 
	~<±h»ad.h
>

47 
	#SND_INTERVAL_INLINE


	)

48 
	~"š‹rv®.h
"

50 
	#SND_MASK_INLINE


	)

51 
	~"mask.h
"

53 
	#SND_PCM_HW_PARAM_ACCESS
 
SNDRV_PCM_HW_PARAM_ACCESS


	)

54 
	#SND_PCM_HW_PARAM_FORMAT
 
SNDRV_PCM_HW_PARAM_FORMAT


	)

55 
	#SND_PCM_HW_PARAM_SUBFORMAT
 
SNDRV_PCM_HW_PARAM_SUBFORMAT


	)

56 
	#SND_PCM_HW_PARAM_SAMPLE_BITS
 
SNDRV_PCM_HW_PARAM_SAMPLE_BITS


	)

57 
	#SND_PCM_HW_PARAM_FRAME_BITS
 
SNDRV_PCM_HW_PARAM_FRAME_BITS


	)

58 
	#SND_PCM_HW_PARAM_CHANNELS
 
SNDRV_PCM_HW_PARAM_CHANNELS


	)

59 
	#SND_PCM_HW_PARAM_RATE
 
SNDRV_PCM_HW_PARAM_RATE


	)

60 
	#SND_PCM_HW_PARAM_PERIOD_TIME
 
SNDRV_PCM_HW_PARAM_PERIOD_TIME


	)

61 
	#SND_PCM_HW_PARAM_PERIOD_SIZE
 
SNDRV_PCM_HW_PARAM_PERIOD_SIZE


	)

62 
	#SND_PCM_HW_PARAM_PERIOD_BYTES
 
SNDRV_PCM_HW_PARAM_PERIOD_BYTES


	)

63 
	#SND_PCM_HW_PARAM_PERIODS
 
SNDRV_PCM_HW_PARAM_PERIODS


	)

64 
	#SND_PCM_HW_PARAM_BUFFER_TIME
 
SNDRV_PCM_HW_PARAM_BUFFER_TIME


	)

65 
	#SND_PCM_HW_PARAM_BUFFER_SIZE
 
SNDRV_PCM_HW_PARAM_BUFFER_SIZE


	)

66 
	#SND_PCM_HW_PARAM_BUFFER_BYTES
 
SNDRV_PCM_HW_PARAM_BUFFER_BYTES


	)

67 
	#SND_PCM_HW_PARAM_TICK_TIME
 
SNDRV_PCM_HW_PARAM_TICK_TIME


	)

68 
	#SND_PCM_HW_PARAM_LAST_MASK
 
SNDRV_PCM_HW_PARAM_LAST_MASK


	)

69 
	#SND_PCM_HW_PARAM_FIRST_MASK
 
SNDRV_PCM_HW_PARAM_FIRST_MASK


	)

70 
	#SND_PCM_HW_PARAM_LAST_INTERVAL
 
SNDRV_PCM_HW_PARAM_LAST_INTERVAL


	)

71 
	#SND_PCM_HW_PARAM_FIRST_INTERVAL
 
SNDRV_PCM_HW_PARAM_FIRST_INTERVAL


	)

74 
	#SND_PCM_INFO_MMAP
 
SNDRV_PCM_INFO_MMAP


	)

76 
	#SND_PCM_INFO_MMAP_VALID
 
SNDRV_PCM_INFO_MMAP_VALID


	)

78 
	#SND_PCM_INFO_DOUBLE
 
SNDRV_PCM_INFO_DOUBLE


	)

80 
	#SND_PCM_INFO_BATCH
 
SNDRV_PCM_INFO_BATCH


	)

82 
	#SND_PCM_INFO_PERFECT_DRAIN
 
SNDRV_PCM_INFO_PERFECT_DRAIN


	)

84 
	#SND_PCM_INFO_INTERLEAVED
 
SNDRV_PCM_INFO_INTERLEAVED


	)

86 
	#SND_PCM_INFO_NONINTERLEAVED
 
SNDRV_PCM_INFO_NONINTERLEAVED


	)

88 
	#SND_PCM_INFO_COMPLEX
 
SNDRV_PCM_INFO_COMPLEX


	)

90 
	#SND_PCM_INFO_BLOCK_TRANSFER
 
SNDRV_PCM_INFO_BLOCK_TRANSFER


	)

92 
	#SND_PCM_INFO_OVERRANGE
 
SNDRV_PCM_INFO_OVERRANGE


	)

94 
	#SND_PCM_INFO_RESUME
 
SNDRV_PCM_INFO_RESUME


	)

96 
	#SND_PCM_INFO_PAUSE
 
SNDRV_PCM_INFO_PAUSE


	)

98 
	#SND_PCM_INFO_HALF_DUPLEX
 
SNDRV_PCM_INFO_HALF_DUPLEX


	)

100 
	#SND_PCM_INFO_JOINT_DUPLEX
 
SNDRV_PCM_INFO_JOINT_DUPLEX


	)

102 
	#SND_PCM_INFO_SYNC_START
 
SNDRV_PCM_INFO_SYNC_START


	)

104 
	#SND_PCM_INFO_NO_PERIOD_WAKEUP
 
SNDRV_PCM_INFO_NO_PERIOD_WAKEUP


	)

106 
	#SND_PCM_HW_PARAMS_NORESAMPLE
 
SNDRV_PCM_HW_PARAMS_NORESAMPLE


	)

107 
	#SND_PCM_HW_PARAMS_EXPORT_BUFFER
 
SNDRV_PCM_HW_PARAMS_EXPORT_BUFFER


	)

108 
	#SND_PCM_HW_PARAMS_NO_PERIOD_WAKEUP
 
SNDRV_PCM_HW_PARAMS_NO_PERIOD_WAKEUP


	)

109 
	#SND_PCM_HW_PARAMS_NO_DRAIN_SILENCE
 
SNDRV_PCM_HW_PARAMS_NO_DRAIN_SILENCE


	)

111 
	#SND_PCM_INFO_MONOTONIC
 0x80000000

	)

113 
	s_¢d_pcm_rb±r
 {

114 
¢d_pcm_t
 *
	mma¡”
;

115 vŞ©
¢d_pcm_uäames_t
 *
	m±r
;

116 
	mfd
;

117 
off_t
 
	moff£t
;

118 
	mlšk_d¡_couÁ
;

119 
¢d_pcm_t
 **
	mlšk_d¡
;

120 *
	m´iv©e_d©a
;

121 (*
	mchªged
)(
¢d_pcm_t
 *
	mpcm
, snd_pcm_ˆ*
	m¤c
);

122 } 
	t¢d_pcm_rb±r_t
;

124 
	s_¢d_pcm_chªÃl_šfo
 {

125 
	mchªÃl
;

126 *
	maddr
;

127 
	mfœ¡
;

128 
	m¡•
;

129 ’um { 
	mSND_PCM_AREA_SHM
, 
	mSND_PCM_AREA_MMAP
, 
	mSND_PCM_AREA_LOCAL
 } 
	mty³
;

132 
¢d_shm_¬—
 *
	m¬—
;

133 
	mshmid
;

134 } 
	mshm
;

136 
	mfd
;

137 
off_t
 
	moff£t
;

138 } 
	mmm­
;

139 } 
	mu
;

140 
	m»£rved
[64];

141 } 
	t¢d_pcm_chªÃl_šfo_t
;

144 (*
	mşo£
)(
¢d_pcm_t
 *
	mpcm
);

145 (*
	mnÚblock
)(
¢d_pcm_t
 *
	mpcm
, nonblock);

146 (*
	masync
)(
¢d_pcm_t
 *
	mpcm
, 
	msig
, 
pid_t
 
	mpid
);

147 (*
	mšfo
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_šfo_t
 *info);

148 (*
	mhw_»fše
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_hw_·¿ms_t
 *
	m·¿ms
);

149 (*
	mhw_·¿ms
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_hw_·¿ms_t
 *
	m·¿ms
);

150 (*
	mhw_ä“
)(
¢d_pcm_t
 *
	mpcm
);

151 (*
	msw_·¿ms
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_sw_·¿ms_t
 *
	m·¿ms
);

152 (*
	mchªÃl_šfo
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_chªÃl_šfo_t
 *
	mšfo
);

153 (*
	mdump
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_ouut_t
 *
	mout
);

154 (*
	mmm­
)(
¢d_pcm_t
 *
	mpcm
);

155 (*
	mmunm­
)(
¢d_pcm_t
 *
	mpcm
);

156 
	m¢d_pcm_chm­_qu”y_t
 **(*
	mqu”y_chm­s
)(
¢d_pcm_t
 *
	mpcm
);

157 
	m¢d_pcm_chm­_t
 *(*
	mg‘_chm­
)(
¢d_pcm_t
 *
	mpcm
);

158 (*
	m£t_chm­
)(
¢d_pcm_t
 *
	mpcm
, cÚ¡ 
¢d_pcm_chm­_t
 *
	mm­
);

159 } 
	t¢d_pcm_İs_t
;

162 (*
	m¡©us
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_¡©us_t
 *status);

163 (*
	m´•¬e
)(
¢d_pcm_t
 *
	mpcm
);

164 (*
	m»£t
)(
¢d_pcm_t
 *
	mpcm
);

165 (*
	m¡¬t
)(
¢d_pcm_t
 *
	mpcm
);

166 (*
	mdrİ
)(
¢d_pcm_t
 *
	mpcm
);

167 (*
	md¿š
)(
¢d_pcm_t
 *
	mpcm
);

168 (*
	m·u£
)(
¢d_pcm_t
 *
	mpcm
, 
	m’abË
);

169 
¢d_pcm_¡©e_t
 (*
¡©e
)(
¢d_pcm_t
 *
	mpcm
);

170 (*
	mhwsync
)(
¢d_pcm_t
 *
	mpcm
);

171 (*
	md–ay
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_säames_t
 *
	md–ayp
);

172 (*
	m»sume
)(
¢d_pcm_t
 *
	mpcm
);

173 (*
	mlšk
)(
¢d_pcm_t
 *
	mpcm1
, snd_pcm_ˆ*
	mpcm2
);

174 (*
	mlšk_¦aves
)(
¢d_pcm_t
 *
	mpcm
, snd_pcm_ˆ*
	mma¡”
);

175 (*
	muÆšk
)(
¢d_pcm_t
 *
	mpcm
);

176 
¢d_pcm_säames_t
 (*
»wšdabË
)(
¢d_pcm_t
 *
	mpcm
);

177 
¢d_pcm_säames_t
 (*
»wšd
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_uäames_t
 
	mäames
);

178 
¢d_pcm_säames_t
 (*
fÜw¬dabË
)(
¢d_pcm_t
 *
	mpcm
);

179 
¢d_pcm_säames_t
 (*
fÜw¬d
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_uäames_t
 
	mäames
);

180 
¢d_pcm_säames_t
 (*
wr™ei
)(
¢d_pcm_t
 *
	mpcm
, cÚ¡ *
	mbufãr
, 
¢d_pcm_uäames_t
 
	msize
);

181 
¢d_pcm_säames_t
 (*
wr™’
)(
¢d_pcm_t
 *
	mpcm
, **
	mbufs
, 
¢d_pcm_uäames_t
 
	msize
);

182 
¢d_pcm_säames_t
 (*
»adi
)(
¢d_pcm_t
 *
	mpcm
, *
	mbufãr
, 
¢d_pcm_uäames_t
 
	msize
);

183 
¢d_pcm_säames_t
 (*
»adn
)(
¢d_pcm_t
 *
	mpcm
, **
	mbufs
, 
¢d_pcm_uäames_t
 
	msize
);

184 
¢d_pcm_säames_t
 (*
ava_upd©e
)(
¢d_pcm_t
 *
	mpcm
);

185 
¢d_pcm_säames_t
 (*
mm­_comm™
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_uäames_t
 
	moff£t
, snd_pcm_uäames_ˆ
	msize
);

186 (*
	mhtime¡amp
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_uäames_t
 *
	mava
, 
¢d_htime¡amp_t
 *
	mt¡amp
);

187 (*
	mpŞl_desütÜs_couÁ
)(
¢d_pcm_t
 *
	mpcm
);

188 (*
	mpŞl_desütÜs
)(
¢d_pcm_t
 *
	mpcm
, 
pŞlfd
 *
	mpfds
, 
	m¥aû
);

189 (*
	mpŞl_»v’ts
)(
¢d_pcm_t
 *
	mpcm
, 
pŞlfd
 *
	mpfds
, 
	mnfds
, *
	m»v’ts
);

190 (*
	mmay_wa™_fÜ_ava_mš
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_uäames_t
 
	mava
);

191 (*
	mmm­_begš
)(
¢d_pcm_t
 *
	mpcm
, cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 **
	m¬—s
, 
¢d_pcm_uäames_t
 *
	moff£t
, snd_pcm_uäames_ˆ*
	mäames
);

192 } 
	t¢d_pcm_ç¡_İs_t
;

194 
	s_¢d_pcm
 {

195 *
	mİ’_func
;

196 *
	mÇme
;

197 
¢d_pcm_ty³_t
 
	mty³
;

198 
¢d_pcm_¡»am_t
 
	m¡»am
;

199 
	mmode
;

200 
	mmš³riodtime
;

201 
	mpŞl_fd_couÁ
;

202 
	mpŞl_fd
;

203 
	mpŞl_ev’ts
;

204 
	m£tup
: 1,

205 
	mcom·t
: 1;

206 
¢d_pcm_acûss_t
 
	macûss
;

207 
¢d_pcm_fÜm©_t
 
	mfÜm©
;

208 
¢d_pcm_subfÜm©_t
 
	msubfÜm©
;

209 
	mchªÃls
;

210 
	m¿‹
;

211 
¢d_pcm_uäames_t
 
	m³riod_size
;

212 
	m³riod_time
;

213 
¢d_š‹rv®_t
 
	m³riods
;

214 
¢d_pcm_t¡amp_t
 
	mt¡amp_mode
;

215 
¢d_pcm_t¡amp_ty³_t
 
	mt¡amp_ty³
;

216 
	m³riod_¡•
;

217 
¢d_pcm_uäames_t
 
	mava_mš
;

218 
	m³riod_ev’t
;

219 
¢d_pcm_uäames_t
 
	m¡¬t_th»shŞd
;

220 
¢d_pcm_uäames_t
 
	m¡İ_th»shŞd
;

221 
¢d_pcm_uäames_t
 
	ms’û_th»shŞd
;

223 
¢d_pcm_uäames_t
 
	ms’û_size
;

224 
¢d_pcm_uäames_t
 
	mbound¬y
;

225 
	mšfo
;

226 
	mmsb™s
;

227 
	m¿‹_num
;

228 
	m¿‹_d’
;

229 
	mhw_æags
;

230 
¢d_pcm_uäames_t
 
	mfifo_size
;

231 
¢d_pcm_uäames_t
 
	mbufãr_size
;

232 
¢d_š‹rv®_t
 
	mbufãr_time
;

233 
	m§m¶e_b™s
;

234 
	mäame_b™s
;

235 
¢d_pcm_rb±r_t
 
	m­¶
;

236 
¢d_pcm_rb±r_t
 
	mhw
;

237 
¢d_pcm_uäames_t
 
	mmš_®ign
;

238 
	mmm­_rw
: 1;

239 
	mmm­_shadow
: 1;

242 
	mdÚÙ_şo£
: 1;

243 
	mown_¡©e_check
:1;

244 
¢d_pcm_chªÃl_šfo_t
 *
	mmm­_chªÃls
;

245 
¢d_pcm_chªÃl_¬—_t
 *
	mruÂšg_¬—s
;

246 
¢d_pcm_chªÃl_¬—_t
 *
	m¡İ³d_¬—s
;

247 cÚ¡ 
¢d_pcm_İs_t
 *
	mİs
;

248 cÚ¡ 
¢d_pcm_ç¡_İs_t
 *
	mç¡_İs
;

249 
¢d_pcm_t
 *
	mİ_¬g
;

250 
¢d_pcm_t
 *
	mç¡_İ_¬g
;

251 *
	m´iv©e_d©a
;

252 
li¡_h—d
 
	masync_hªdËrs
;

253 #ifdeà
THREAD_SAFE_API


254 
	mÃed_lock
;

257 
	mlock_’abËd
;

260 
±h»ad_mu‹x_t
 
	mlock
;

275 
	#¢d_pcm_Ãw
 \

276 
¢d1_pcm_Ãw


	)

277 
	#¢d_pcm_ä“
 \

278 
¢d1_pcm_ä“


	)

279 
	#¢d_pcm_¬—s_äom_buf
 \

280 
¢d1_pcm_¬—s_äom_buf


	)

281 
	#¢d_pcm_¬—s_äom_bufs
 \

282 
¢d1_pcm_¬—s_äom_bufs


	)

283 
	#¢d_pcm_İ’_Çmed_¦ave
 \

284 
¢d1_pcm_İ’_Çmed_¦ave


	)

285 
	#¢d_pcm_hw_İ’_fd
 \

286 
¢d1_pcm_hw_İ’_fd


	)

287 
	#¢d_pcm_wa™_nocheck
 \

288 
¢d1_pcm_wa™_nocheck


	)

289 
	#¢d_pcm_¿‹_g‘_deçuÉ_cÚv”‹r
 \

290 
¢d1_pcm_¿‹_g‘_deçuÉ_cÚv”‹r


	)

291 
	#¢d_pcm_£t_hw_±r
 \

292 
¢d1_pcm_£t_hw_±r


	)

293 
	#¢d_pcm_£t_­¶_±r
 \

294 
¢d1_pcm_£t_­¶_±r


	)

295 
	#¢d_pcm_lšk_hw_±r
 \

296 
¢d1_pcm_lšk_hw_±r


	)

297 
	#¢d_pcm_lšk_­¶_±r
 \

298 
¢d1_pcm_lšk_­¶_±r


	)

299 
	#¢d_pcm_uÆšk_hw_±r
 \

300 
¢d1_pcm_uÆšk_hw_±r


	)

301 
	#¢d_pcm_uÆšk_­¶_±r
 \

302 
¢d1_pcm_uÆšk_­¶_±r


	)

303 
	#¢d_pcm_mm­_­¶_±r
 \

304 
¢d1_pcm_mm­_­¶_±r


	)

305 
	#¢d_pcm_mm­_­¶_backw¬d
 \

306 
¢d1_pcm_mm­_­¶_backw¬d


	)

307 
	#¢d_pcm_mm­_­¶_fÜw¬d
 \

308 
¢d1_pcm_mm­_­¶_fÜw¬d


	)

309 
	#¢d_pcm_mm­_hw_backw¬d
 \

310 
¢d1_pcm_mm­_hw_backw¬d


	)

311 
	#¢d_pcm_mm­_hw_fÜw¬d
 \

312 
¢d1_pcm_mm­_hw_fÜw¬d


	)

313 
	#¢d_pcm_»ad_¬—s
 \

314 
¢d1_pcm_»ad_¬—s


	)

315 
	#¢d_pcm_wr™e_¬—s
 \

316 
¢d1_pcm_wr™e_¬—s


	)

317 
	#¢d_pcm_»ad_mm­
 \

318 
¢d1_pcm_»ad_mm­


	)

319 
	#¢d_pcm_wr™e_mm­
 \

320 
¢d1_pcm_wr™e_mm­


	)

321 
	#¢d_pcm_chªÃl_šfo_shm
 \

322 
¢d1_pcm_chªÃl_šfo_shm


	)

323 
	#¢d_pcm_hw_»fše_soá
 \

324 
¢d1_pcm_hw_»fše_soá


	)

325 
	#¢d_pcm_hw_»fše_¦ave
 \

326 
¢d1_pcm_hw_»fše_¦ave


	)

327 
	#¢d_pcm_hw_·¿ms_¦ave
 \

328 
¢d1_pcm_hw_·¿ms_¦ave


	)

329 
	#¢d_pcm_hw_·¿m_»fše_Ã¬
 \

330 
¢d1_pcm_hw_·¿m_»fše_Ã¬


	)

331 
	#¢d_pcm_hw_·¿m_»fše_muÉË
 \

332 
¢d1_pcm_hw_·¿m_»fše_muÉË


	)

333 
	#¢d_pcm_hw_·¿m_em±y
 \

334 
¢d1_pcm_hw_·¿m_em±y


	)

335 
	#¢d_pcm_hw_·¿m_®ways_eq
 \

336 
¢d1_pcm_hw_·¿m_®ways_eq


	)

337 
	#¢d_pcm_hw_·¿m_Ãv”_eq
 \

338 
¢d1_pcm_hw_·¿m_Ãv”_eq


	)

339 
	#¢d_pcm_hw_·¿m_g‘_mask
 \

340 
¢d1_pcm_hw_·¿m_g‘_mask


	)

341 
	#¢d_pcm_hw_·¿m_g‘_š‹rv®
 \

342 
¢d1_pcm_hw_·¿m_g‘_š‹rv®


	)

343 
	#¢d_pcm_hw_·¿m_ªy
 \

344 
¢d1_pcm_hw_·¿m_ªy


	)

345 
	#¢d_pcm_hw_·¿m_£t_š‹g”
 \

346 
¢d1_pcm_hw_·¿m_£t_š‹g”


	)

347 
	#¢d_pcm_hw_·¿m_£t_fœ¡
 \

348 
¢d1_pcm_hw_·¿m_£t_fœ¡


	)

349 
	#¢d_pcm_hw_·¿m_£t_Ï¡
 \

350 
¢d1_pcm_hw_·¿m_£t_Ï¡


	)

351 
	#¢d_pcm_hw_·¿m_£t_Ã¬
 \

352 
¢d1_pcm_hw_·¿m_£t_Ã¬


	)

353 
	#¢d_pcm_hw_·¿m_£t_mš
 \

354 
¢d1_pcm_hw_·¿m_£t_mš


	)

355 
	#¢d_pcm_hw_·¿m_£t_max
 \

356 
¢d1_pcm_hw_·¿m_£t_max


	)

357 
	#¢d_pcm_hw_·¿m_£t_mšmax
 \

358 
¢d1_pcm_hw_·¿m_£t_mšmax


	)

359 
	#¢d_pcm_hw_·¿m_£t
 \

360 
¢d1_pcm_hw_·¿m_£t


	)

361 
	#¢d_pcm_hw_·¿m_£t_mask
 \

362 
¢d1_pcm_hw_·¿m_£t_mask


	)

363 
	#¢d_pcm_hw_·¿m_g‘
 \

364 
¢d1_pcm_hw_·¿m_g‘


	)

365 
	#¢d_pcm_hw_·¿m_g‘_mš
 \

366 
¢d1_pcm_hw_·¿m_g‘_mš


	)

367 
	#¢d_pcm_hw_·¿m_g‘_max
 \

368 
¢d1_pcm_hw_·¿m_g‘_max


	)

369 
	#¢d_pcm_hw_·¿m_Çme
 \

370 
¢d1_pcm_hw_·¿m_Çme


	)

371 
	#¢d_pcm_sw_·¿ms_cu¼’t_no_lock
 \

372 
¢d1_pcm_sw_·¿ms_cu¼’t_no_lock


	)

374 
¢d_pcm_Ãw
(
¢d_pcm_t
 **
pcmp
, 
¢d_pcm_ty³_t
 
ty³
, cÚ¡ *
Çme
,

375 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
);

376 
¢d_pcm_ä“
(
¢d_pcm_t
 *
pcm
);

378 
¢d_pcm_¬—s_äom_buf
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
, *
buf
);

379 
¢d_pcm_¬—s_äom_bufs
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
, **
bufs
);

381 
¢d_pcm_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
);

382 
¢d_pcm_mm­
(
¢d_pcm_t
 *
pcm
);

383 
¢d_pcm_munm­
(
¢d_pcm_t
 *
pcm
);

384 
¢d_pcm_mm­_»ady
(
¢d_pcm_t
 *
pcm
);

385 
¢d_pcm_£t_hw_±r
(
¢d_pcm_t
 *
pcm
, vŞ©
¢d_pcm_uäames_t
 *
hw_±r
, 
fd
, 
off_t
 
off£t
);

386 
¢d_pcm_£t_­¶_±r
(
¢d_pcm_t
 *
pcm
, vŞ©
¢d_pcm_uäames_t
 *
­¶_±r
, 
fd
, 
off_t
 
off£t
);

387 
¢d_pcm_lšk_hw_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ*
¦ave
);

388 
¢d_pcm_lšk_­¶_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ*
¦ave
);

389 
¢d_pcm_uÆšk_hw_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ*
¦ave
);

390 
¢d_pcm_uÆšk_­¶_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ*
¦ave
);

391 
¢d_pcm_säames_t
 
¢d_pcm_mm­_­¶_±r
(
¢d_pcm_t
 *
pcm
, 
off_t
 
off£t
);

392 
¢d_pcm_mm­_­¶_backw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
);

393 
¢d_pcm_mm­_­¶_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
);

394 
¢d_pcm_mm­_hw_backw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
);

395 
¢d_pcm_mm­_hw_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
);

397 
¢d_pcm_sw_·¿ms_cu¼’t_no_lock
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
);

399 
¢d_pcm_säames_t
 
¢d_pcm_mm­_wr™ei
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
bufãr
, 
¢d_pcm_uäames_t
 
size
);

400 
¢d_pcm_säames_t
 
¢d_pcm_mm­_»adi
(
¢d_pcm_t
 *
pcm
, *
bufãr
, 
¢d_pcm_uäames_t
 
size
);

401 
¢d_pcm_säames_t
 
¢d_pcm_mm­_wr™’
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
);

402 
¢d_pcm_säames_t
 
¢d_pcm_mm­_»adn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
);

404 
	$¢d_pcm_säames_t
 (*
	t¢d_pcm_xãr_¬—s_func_t
)(
	t¢d_pcm_t
 *
	tpcm
,

405 cÚ¡ 
	t¢d_pcm_chªÃl_¬—_t
 *
	t¬—s
,

406 
	t¢d_pcm_uäames_t
 
	toff£t
,

407 
	t¢d_pcm_uäames_t
 
	tsize
);

409 
¢d_pcm_säames_t
 
	`¢d_pcm_»ad_¬—s
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

410 
¢d_pcm_uäames_t
 
off£t
, snd_pcm_uäames_ˆ
size
,

411 
¢d_pcm_xãr_¬—s_func_t
 
func
);

412 
¢d_pcm_säames_t
 
	`¢d_pcm_wr™e_¬—s
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

413 
¢d_pcm_uäames_t
 
off£t
, snd_pcm_uäames_ˆ
size
,

414 
¢d_pcm_xãr_¬—s_func_t
 
func
);

415 
¢d_pcm_säames_t
 
	`¢d_pcm_»ad_mm­
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
off£t
,

416 
¢d_pcm_uäames_t
 
size
);

417 
¢d_pcm_säames_t
 
	`¢d_pcm_wr™e_mm­
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
off£t
,

418 
¢d_pcm_uäames_t
 
size
);

419 
šlše
 
	$¢d_pcm_chªÃl_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_šfo_t
 *
šfo
)

421 ià(!
pcm
->
İs
->
chªÃl_šfo
)

422  -
ENOSYS
;

423  
pcm
->
İs
->
	`chªÃl_šfo
Õcm, 
šfo
);

424 
	}
}

425 
¢d_pcm_chªÃl_šfo_shm
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_šfo_t
 *
šfo
, 
shmid
);

426 
_¢d_pcm_pŞl_desütÜ
(
¢d_pcm_t
 *
pcm
);

427 
	#_¢d_pcm_lšk_desütÜ
 
_¢d_pcm_pŞl_desütÜ


	)

428 
	#_¢d_pcm_async_desütÜ
 
_¢d_pcm_pŞl_desütÜ


	)

431 
__¢d_pcm_mm­_begš_g’”ic
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 **
¬—s
,

432 
¢d_pcm_uäames_t
 *
off£t
, snd_pcm_uäames_ˆ*
äames
);

433 
__¢d_pcm_mm­_begš
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 **
¬—s
,

434 
¢d_pcm_uäames_t
 *
off£t
, snd_pcm_uäames_ˆ*
äames
);

435 
¢d_pcm_säames_t
 
__¢d_pcm_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

436 
¢d_pcm_uäames_t
 
off£t
,

437 
¢d_pcm_uäames_t
 
äames
);

438 
__¢d_pcm_wa™_š_lock
(
¢d_pcm_t
 *
pcm
, 
timeout
);

440 
šlše
 
¢d_pcm_säames_t
 
	$__¢d_pcm_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

442 ià(!
pcm
->
ç¡_İs
->
ava_upd©e
)

443  -
ENOSYS
;

444  
pcm
->
ç¡_İs
->
	`ava_upd©e
Õcm->
ç¡_İ_¬g
);

445 
	}
}

447 
šlše
 
	$__¢d_pcm_¡¬t
(
¢d_pcm_t
 *
pcm
)

449 ià(!
pcm
->
ç¡_İs
->
¡¬t
)

450  -
ENOSYS
;

451  
pcm
->
ç¡_İs
->
	`¡¬t
Õcm->
ç¡_İ_¬g
);

452 
	}
}

454 
šlše
 
¢d_pcm_¡©e_t
 
	$__¢d_pcm_¡©e
(
¢d_pcm_t
 *
pcm
)

456 ià(!
pcm
->
ç¡_İs
->
¡©e
)

457  
SND_PCM_STATE_OPEN
;

458  
pcm
->
ç¡_İs
->
	`¡©e
Õcm->
ç¡_İ_¬g
);

459 
	}
}

461 
šlše
 
	$__¢d_pcm_hwsync
(
¢d_pcm_t
 *
pcm
)

463 ià(!
pcm
->
ç¡_İs
->
hwsync
)

464  -
ENOSYS
;

465  
pcm
->
ç¡_İs
->
	`hwsync
Õcm->
ç¡_İ_¬g
);

466 
	}
}

468 
šlše
 
	$__¢d_pcm_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
)

470 ià(!
pcm
->
ç¡_İs
->
d–ay
)

471  -
ENOSYS
;

472  
pcm
->
ç¡_İs
->
	`d–ay
Õcm->
ç¡_İ_¬g
, 
d–ayp
);

473 
	}
}

476 
šlše
 
	$¢d_pcm_check_”rÜ
(
¢d_pcm_t
 *
pcm
, 
”r
)

478 ià(
”r
 =ğ-
EINTR
) {

479 
	`__¢d_pcm_¡©e
(
pcm
)) {

480 
SND_PCM_STATE_XRUN
:

481  -
EPIPE
;

482 
SND_PCM_STATE_SUSPENDED
:

483  -
ESTRPIPE
;

484 
SND_PCM_STATE_DISCONNECTED
:

485  -
ENODEV
;

490  
”r
;

491 
	}
}

500 
šlše
 
¢d_pcm_uäames_t
 
	$__¢d_pcm_¶ayback_ava
(
¢d_pcm_t
 *
pcm
,

501 cÚ¡ 
¢d_pcm_uäames_t
 
hw_±r
,

502 cÚ¡ 
¢d_pcm_uäames_t
 
­¶_±r
)

504 
¢d_pcm_säames_t
 
ava
;

505 
ava
 = 
hw_±r
 + 
pcm
->
bufãr_size
 - 
­¶_±r
;

506 ià(
ava
 < 0)

507 
ava
 +ğ
pcm
->
bound¬y
;

508 ià((
¢d_pcm_uäames_t
è
ava
 >ğ
pcm
->
bound¬y
)

509 
ava
 -ğ
pcm
->
bound¬y
;

510  
ava
;

511 
	}
}

513 
šlše
 
¢d_pcm_uäames_t
 
	$¢d_pcm_mm­_¶ayback_ava
(
¢d_pcm_t
 *
pcm
)

515  
	`__¢d_pcm_¶ayback_ava
(
pcm
, *pcm->
hw
.
±r
, *pcm->
­¶
.ptr);

516 
	}
}

525 
šlše
 
¢d_pcm_uäames_t
 
	$__¢d_pcm_ÿ±u»_ava
(
¢d_pcm_t
 *
pcm
,

526 cÚ¡ 
¢d_pcm_uäames_t
 
hw_±r
,

527 cÚ¡ 
¢d_pcm_uäames_t
 
­¶_±r
)

529 
¢d_pcm_säames_t
 
ava
;

530 
ava
 = 
hw_±r
 - 
­¶_±r
;

531 ià(
ava
 < 0)

532 
ava
 +ğ
pcm
->
bound¬y
;

533  
ava
;

534 
	}
}

536 
šlše
 
¢d_pcm_uäames_t
 
	$¢d_pcm_mm­_ÿ±u»_ava
(
¢d_pcm_t
 *
pcm
)

538  
	`__¢d_pcm_ÿ±u»_ava
(
pcm
, *pcm->
hw
.
±r
, *pcm->
­¶
.ptr);

539 
	}
}

541 
šlše
 
¢d_pcm_uäames_t
 
	$__¢d_pcm_ava
(
¢d_pcm_t
 *
pcm
,

542 cÚ¡ 
¢d_pcm_uäames_t
 
hw_±r
,

543 cÚ¡ 
¢d_pcm_uäames_t
 
­¶_±r
)

545 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

546  
	`__¢d_pcm_¶ayback_ava
(
pcm
, 
hw_±r
, 
­¶_±r
);

548  
	`__¢d_pcm_ÿ±u»_ava
(
pcm
, 
hw_±r
, 
­¶_±r
);

549 
	}
}

551 
šlše
 
¢d_pcm_uäames_t
 
	$¢d_pcm_mm­_ava
(
¢d_pcm_t
 *
pcm
)

553  
	`__¢d_pcm_ava
(
pcm
, *pcm->
hw
.
±r
, *pcm->
­¶
.ptr);

554 
	}
}

561 
šlše
 
¢d_pcm_säames_t
 
	$¢d_pcm_mm­_¶ayback_hw_ava
(
¢d_pcm_t
 *
pcm
)

563  
pcm
->
bufãr_size
 - 
	`¢d_pcm_mm­_¶ayback_ava
(pcm);

564 
	}
}

571 
šlše
 
¢d_pcm_säames_t
 
	$¢d_pcm_mm­_ÿ±u»_hw_ava
(
¢d_pcm_t
 *
pcm
)

573  
pcm
->
bufãr_size
 - 
	`¢d_pcm_mm­_ÿ±u»_ava
(pcm);

574 
	}
}

576 
šlše
 
¢d_pcm_säames_t
 
	$¢d_pcm_mm­_hw_ava
(
¢d_pcm_t
 *
pcm
)

578  
pcm
->
bufãr_size
 - 
	`¢d_pcm_mm­_ava
(pcm);

579 
	}
}

581 
šlše
 
¢d_pcm_säames_t
 
	$¢d_pcm_mm­_¶ayback_hw_»wšdabË
(
¢d_pcm_t
 *
pcm
)

583 
¢d_pcm_säames_t
 
»t
 = 
	`¢d_pcm_mm­_¶ayback_hw_ava
(
pcm
);

584  (
»t
 >= 0) ?„et : 0;

585 
	}
}

587 
šlše
 
¢d_pcm_säames_t
 
	$¢d_pcm_mm­_ÿ±u»_hw_»wšdabË
(
¢d_pcm_t
 *
pcm
)

589 
¢d_pcm_säames_t
 
»t
 = 
	`¢d_pcm_mm­_ÿ±u»_hw_ava
(
pcm
);

590  (
»t
 >= 0) ?„et : 0;

591 
	}
}

593 
šlše
 
¢d_pcm_uäames_t
 
	$¢d_pcm_mm­_hw_»wšdabË
(
¢d_pcm_t
 *
pcm
)

595 
¢d_pcm_säames_t
 
»t
 = 
	`¢d_pcm_mm­_hw_ava
(
pcm
);

596  (
»t
 >= 0) ?„et : 0;

597 
	}
}

599 
šlše
 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
	$¢d_pcm_mm­_¬—s
(
¢d_pcm_t
 *
pcm
)

601 ià(
pcm
->
¡İ³d_¬—s
 &&

602 
	`__¢d_pcm_¡©e
(
pcm
è!ğ
SND_PCM_STATE_RUNNING
)

603  
pcm
->
¡İ³d_¬—s
;

604  
pcm
->
ruÂšg_¬—s
;

605 
	}
}

607 
šlše
 
¢d_pcm_uäames_t
 
	$¢d_pcm_mm­_off£t
(
¢d_pcm_t
 *
pcm
)

609 
	`as£¹
(
pcm
);

610  *
pcm
->
­¶
.
±r
 %…cm->
bufãr_size
;

611 
	}
}

613 
šlše
 
¢d_pcm_uäames_t
 
	$¢d_pcm_mm­_hw_off£t
(
¢d_pcm_t
 *
pcm
)

615 
	`as£¹
(
pcm
);

616  *
pcm
->
hw
.
±r
 %…cm->
bufãr_size
;

617 
	}
}

622 
šlše
 
¢d_pcm_uäames_t
 
	$¢d_pcm_mm­_¶ayback_d–ay
(
¢d_pcm_t
 *
pcm
)

624  
	`¢d_pcm_mm­_¶ayback_hw_ava
(
pcm
);

625 
	}
}

630 
šlše
 
¢d_pcm_uäames_t
 
	$¢d_pcm_mm­_ÿ±u»_d–ay
(
¢d_pcm_t
 *
pcm
)

632  
	`¢d_pcm_mm­_ÿ±u»_ava
(
pcm
);

633 
	}
}

635 
šlše
 
¢d_pcm_säames_t
 
	$¢d_pcm_mm­_d–ay
(
¢d_pcm_t
 *
pcm
)

637 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

638  
	`¢d_pcm_mm­_¶ayback_d–ay
(
pcm
);

640  
	`¢d_pcm_mm­_ÿ±u»_d–ay
(
pcm
);

641 
	}
}

643 
šlše
 
¢d_pcm_säames_t
 
	$_¢d_pcm_wr™ei
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

646 ià(!
pcm
->
ç¡_İs
->
wr™ei
)

647  -
ENOSYS
;

648  
pcm
->
ç¡_İs
->
	`wr™ei
Õcm->
ç¡_İ_¬g
, 
bufãr
, 
size
);

649 
	}
}

651 
šlše
 
¢d_pcm_säames_t
 
	$_¢d_pcm_wr™’
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

654 ià(!
pcm
->
ç¡_İs
->
wr™’
)

655  -
ENOSYS
;

656  
pcm
->
ç¡_İs
->
	`wr™’
Õcm->
ç¡_İ_¬g
, 
bufs
, 
size
);

657 
	}
}

659 
šlše
 
¢d_pcm_säames_t
 
	$_¢d_pcm_»adi
(
¢d_pcm_t
 *
pcm
, *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

662 ià(!
pcm
->
ç¡_İs
->
»adi
)

663  -
ENOSYS
;

664  
pcm
->
ç¡_İs
->
	`»adi
Õcm->
ç¡_İ_¬g
, 
bufãr
, 
size
);

665 
	}
}

667 
šlše
 
¢d_pcm_säames_t
 
	$_¢d_pcm_»adn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

670 ià(!
pcm
->
ç¡_İs
->
»adn
)

671  -
ENOSYS
;

672  
pcm
->
ç¡_İs
->
	`»adn
Õcm->
ç¡_İ_¬g
, 
bufs
, 
size
);

673 
	}
}

675 
šlše
 
	$muldiv
(
a
, 
b
, 
c
, *
r
)

677 
št64_t
 
n
 = (št64_t)
a
 * 
b
;

678 
št64_t
 
v
 = 
n
 / 
c
;

679 ià(
v
 > 
INT_MAX
) {

680 *
r
 = 0;

681  
INT_MAX
;

683 ià(
v
 < 
INT_MIN
) {

684 *
r
 = 0;

685  
INT_MIN
;

687 *
r
 = 
n
 % 
c
;

688  
v
;

689 
	}
}

691 
šlše
 
	$muldiv_down
(
a
, 
b
, 
c
)

693 
št64_t
 
v
 = (št64_t)
a
 * 
b
 / 
c
;

694 ià(
v
 > 
INT_MAX
) {

695  
INT_MAX
;

697 ià(
v
 < 
INT_MIN
) {

698  
INT_MIN
;

700  
v
;

701 
	}
}

703 
šlše
 
	$muldiv_Ã¬
(
a
, 
b
, 
c
)

705 
r
;

706 
n
 = 
	`muldiv
(
a
, 
b
, 
c
, &
r
);

707 ià(
r
 >ğ(
c
 + 1) / 2)

708 
n
++;

709  
n
;

710 
	}
}

712 
¢d_pcm_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

713 
_¢d_pcm_hw_·¿ms_š‹º®
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

714 #undeà
_¢d_pcm_hw_·¿ms


715 
¢d_pcm_hw_»fše_soá
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

716 
¢d_pcm_hw_»fše_¦ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

717 (*
ı»·»
)(
¢d_pcm_t
 *
pcm
,

718 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
),

719 (*
cchªge
)(
¢d_pcm_t
 *
pcm
,

720 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

721 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
),

722 (*
¥»·»
)(
¢d_pcm_t
 *
pcm
,

723 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
),

724 (*
schªge
)(
¢d_pcm_t
 *
pcm
,

725 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

726 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
),

727 (*
¤efše
)(
¢d_pcm_t
 *
pcm
,

728 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
));

729 
	`¢d_pcm_hw_·¿ms_¦ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

730 (*
cchªge
)(
¢d_pcm_t
 *
pcm
,

731 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

732 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
),

733 (*
¥»·»
)(
¢d_pcm_t
 *
pcm
,

734 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
),

735 (*
schªge
)(
¢d_pcm_t
 *
pcm
,

736 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

737 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
),

738 (*
¥¬ams
)(
¢d_pcm_t
 *
pcm
,

739 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
));

742 
	`_¢d_pcm_hw_·¿ms_ªy
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

743 
	`_¢d_pcm_hw_·¿m_£t_em±y
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

744 
¢d_pcm_hw_·¿m_t
 
v¬
);

745 
	`_¢d_pcm_hw_·¿m_£t_š‹rv®
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

746 
¢d_pcm_hw_·¿m_t
 
v¬
,

747 cÚ¡ 
¢d_š‹rv®_t
 *
v®
);

748 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

749 
¢d_pcm_hw_·¿m_t
 
v¬
, cÚ¡ 
¢d_mask_t
 *
mask
);

750 
	`_¢d_pcm_hw_·¿m_fœ¡
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

751 
¢d_pcm_hw_·¿m_t
 
v¬
);

752 
	`_¢d_pcm_hw_·¿m_Ï¡
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

753 
¢d_pcm_hw_·¿m_t
 
v¬
);

754 
	`_¢d_pcm_hw_·¿m_£t
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

755 
¢d_pcm_hw_·¿m_t
 
v¬
, 
v®
, 
dœ
);

756 
šlše
 
	$_¢d_pcm_hw_·¿ms_£t_fÜm©
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

757 
¢d_pcm_fÜm©_t
 
v®
)

759  
	`_¢d_pcm_hw_·¿m_£t
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
,

760 (è
v®
, 0);

761 
	}
}

763 
šlše
 
	$_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

764 
¢d_pcm_subfÜm©_t
 
v®
)

766  
	`_¢d_pcm_hw_·¿m_£t
(
·¿ms
, 
SND_PCM_HW_PARAM_SUBFORMAT
,

767 (è
v®
, 0);

768 
	}
}

770 
_¢d_pcm_hw_·¿m_£t_mš
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

771 
¢d_pcm_hw_·¿m_t
 
v¬
, 
v®
, 
dœ
);

772 
_¢d_pcm_hw_·¿m_£t_max
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

773 
¢d_pcm_hw_·¿m_t
 
v¬
, 
v®
, 
dœ
);

774 
_¢d_pcm_hw_·¿m_£t_mšmax
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

775 
¢d_pcm_hw_·¿m_t
 
v¬
,

776 
mš
, 
mšdœ
,

777 
max
, 
maxdœ
);

778 
_¢d_pcm_hw_·¿m_»fše
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

779 
¢d_pcm_hw_·¿m_t
 
v¬
,

780 cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
¤c
);

781 
_¢d_pcm_hw_·¿ms_»fše
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

782 
v¬s
,

783 cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
¤c
);

784 
¢d_pcm_hw_·¿m_»fše_Ã¬
(
¢d_pcm_t
 *
pcm
,

785 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

786 
¢d_pcm_hw_·¿m_t
 
v¬
,

787 cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
¤c
);

788 
¢d_pcm_hw_·¿m_»fše_muÉË
(
¢d_pcm_t
 *
pcm
,

789 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

790 
¢d_pcm_hw_·¿m_t
 
v¬
,

791 cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
¤c
);

792 
¢d_pcm_hw_·¿m_em±y
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

793 
¢d_pcm_hw_·¿m_t
 
v¬
);

794 
¢d_pcm_hw_·¿m_®ways_eq
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

795 
¢d_pcm_hw_·¿m_t
 
v¬
,

796 cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms1
);

797 
¢d_pcm_hw_·¿m_Ãv”_eq
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

798 
¢d_pcm_hw_·¿m_t
 
v¬
,

799 cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms1
);

800 cÚ¡ 
¢d_mask_t
 *
¢d_pcm_hw_·¿m_g‘_mask
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

801 
¢d_pcm_hw_·¿m_t
 
v¬
);

802 cÚ¡ 
¢d_š‹rv®_t
 *
¢d_pcm_hw_·¿m_g‘_š‹rv®
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

803 
¢d_pcm_hw_·¿m_t
 
v¬
);

805 
¢d_pcm_hw_·¿m_ªy
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

806 
¢d_pcm_hw_·¿m_t
 
v¬
);

807 
¢d_pcm_hw_·¿m_£t_š‹g”
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

808 
¢d_£t_mode_t
 
mode
,

809 
¢d_pcm_hw_·¿m_t
 
v¬
);

810 
¢d_pcm_hw_·¿m_£t_fœ¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

811 
¢d_pcm_hw_·¿m_t
 
v¬
, *
rv®
, *
dœ
);

812 
¢d_pcm_hw_·¿m_£t_Ï¡
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

813 
¢d_pcm_hw_·¿m_t
 
v¬
, *
rv®
, *
dœ
);

814 
¢d_pcm_hw_·¿m_£t_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

815 
¢d_pcm_hw_·¿m_t
 
v¬
, *
v®
, *
dœ
);

816 
¢d_pcm_hw_·¿m_£t_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

817 
¢d_£t_mode_t
 
mode
,

818 
¢d_pcm_hw_·¿m_t
 
v¬
,

819 *
v®
, *
dœ
);

820 
¢d_pcm_hw_·¿m_£t_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

821 
¢d_£t_mode_t
 
mode
,

822 
¢d_pcm_hw_·¿m_t
 
v¬
, *
v®
, *
dœ
);

823 
¢d_pcm_hw_·¿m_£t_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

824 
¢d_£t_mode_t
 
mode
,

825 
¢d_pcm_hw_·¿m_t
 
v¬
,

826 *
mš
, *
mšdœ
,

827 *
max
, *
maxdœ
);

828 
¢d_pcm_hw_·¿m_£t
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

829 
¢d_£t_mode_t
 
mode
,

830 
¢d_pcm_hw_·¿m_t
 
v¬
, 
v®
, 
dœ
);

831 
¢d_pcm_hw_·¿m_£t_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

832 
¢d_£t_mode_t
 
mode
,

833 
¢d_pcm_hw_·¿m_t
 
v¬
, cÚ¡ 
¢d_mask_t
 *
mask
);

834 
¢d_pcm_hw_·¿m_g‘
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_hw_·¿m_t
 
v¬
,

835 *
v®
, *
dœ
);

836 
¢d_pcm_hw_·¿m_g‘_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

837 
¢d_pcm_hw_·¿m_t
 
v¬
,

838 *
v®
, *
dœ
);

839 
¢d_pcm_hw_·¿m_g‘_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

840 
¢d_pcm_hw_·¿m_t
 
v¬
,

841 *
v®
, *
dœ
);

843 #ifdeà
INTERNAL


844 
¢d_pcm_säames_t
 
	$INTERNAL
(
¢d_pcm_fÜw¬d
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
);

846 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_acûss
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 *
acûss
);

847 
	`¢d_pcm_hw_·¿ms_‹¡_acûss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 
acûss
);

848 
	`¢d_pcm_hw_·¿ms_£t_acûss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 
acûss
);

849 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_acûss_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 *
acûss
);

850 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_acûss_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_t
 *
acûss
);

851 
	`¢d_pcm_hw_·¿ms_£t_acûss_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_mask_t
 *
mask
);

852 
	`¢d_pcm_hw_·¿ms_g‘_acûss_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_acûss_mask_t
 *
mask
);

854 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 *
v®
);

855 
	`¢d_pcm_hw_·¿ms_‹¡_fÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 
v®
);

856 
	`¢d_pcm_hw_·¿ms_£t_fÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 
v®
);

857 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_fÜm©_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 *
fÜm©
);

858 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_fÜm©_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_t
 *
fÜm©
);

859 
	`¢d_pcm_hw_·¿ms_£t_fÜm©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_mask_t
 *
mask
);

860 
	`¢d_pcm_hw_·¿ms_g‘_fÜm©_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_fÜm©_mask_t
 *
mask
);

862 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_subfÜm©
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 *
subfÜm©
);

863 
	`¢d_pcm_hw_·¿ms_‹¡_subfÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 
subfÜm©
);

864 
	`¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 
subfÜm©
);

865 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_subfÜm©_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 *
subfÜm©
);

866 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_subfÜm©_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_t
 *
subfÜm©
);

867 
	`¢d_pcm_hw_·¿ms_£t_subfÜm©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_mask_t
 *
mask
);

868 
	`¢d_pcm_hw_·¿ms_g‘_subfÜm©_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_subfÜm©_mask_t
 *
mask
);

870 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_chªÃls
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

871 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_chªÃls_mš
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

872 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_chªÃls_max
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

873 
	`¢d_pcm_hw_·¿ms_‹¡_chªÃls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
);

874 
	`¢d_pcm_hw_·¿ms_£t_chªÃls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
);

875 
	`¢d_pcm_hw_·¿ms_£t_chªÃls_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

876 
	`¢d_pcm_hw_·¿ms_£t_chªÃls_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

877 
	`¢d_pcm_hw_·¿ms_£t_chªÃls_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
max
);

878 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_chªÃls_Ã¬
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

879 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_chªÃls_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

880 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_chªÃls_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
);

882 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_¿‹
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

883 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_¿‹_mš
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

884 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_¿‹_max
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

885 
	`¢d_pcm_hw_·¿ms_‹¡_¿‹
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

886 
	`¢d_pcm_hw_·¿ms_£t_¿‹
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

887 
	`¢d_pcm_hw_·¿ms_£t_¿‹_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

888 
	`¢d_pcm_hw_·¿ms_£t_¿‹_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

889 
	`¢d_pcm_hw_·¿ms_£t_¿‹_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
);

890 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_¿‹_Ã¬
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

891 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_¿‹_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

892 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_¿‹_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

894 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_time
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

895 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_time_mš
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

896 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_time_max
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

897 
	`¢d_pcm_hw_·¿ms_‹¡_³riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

898 
	`¢d_pcm_hw_·¿ms_£t_³riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

899 
	`¢d_pcm_hw_·¿ms_£t_³riod_time_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

900 
	`¢d_pcm_hw_·¿ms_£t_³riod_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

901 
	`¢d_pcm_hw_·¿ms_£t_³riod_time_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
);

902 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_time_Ã¬
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

903 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_time_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

904 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_time_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

906 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_size
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
äames
, *
dœ
);

907 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_size_mš
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
äames
, *
dœ
);

908 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_size_max
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
äames
, *
dœ
);

909 
	`¢d_pcm_hw_·¿ms_‹¡_³riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
, 
dœ
);

910 
	`¢d_pcm_hw_·¿ms_£t_³riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
, 
dœ
);

911 
	`¢d_pcm_hw_·¿ms_£t_³riod_size_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
);

912 
	`¢d_pcm_hw_·¿ms_£t_³riod_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
);

913 
	`¢d_pcm_hw_·¿ms_£t_³riod_size_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
mš
, *
mšdœ
, snd_pcm_uäames_ˆ*
max
, *
maxdœ
);

914 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_size_Ã¬
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
);

915 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_size_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
);

916 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riod_size_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
, *
dœ
);

917 
	`¢d_pcm_hw_·¿ms_£t_³riod_size_š‹g”
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

919 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riods
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

920 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riods_mš
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

921 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riods_max
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

922 
	`¢d_pcm_hw_·¿ms_‹¡_³riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

923 
	`¢d_pcm_hw_·¿ms_£t_³riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

924 
	`¢d_pcm_hw_·¿ms_£t_³riods_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

925 
	`¢d_pcm_hw_·¿ms_£t_³riods_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

926 
	`¢d_pcm_hw_·¿ms_£t_³riods_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
);

927 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riods_Ã¬
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

928 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riods_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

929 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riods_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

930 
	`¢d_pcm_hw_·¿ms_£t_³riods_š‹g”
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
);

932 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

933 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time_mš
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

934 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_time_max
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

935 
	`¢d_pcm_hw_·¿ms_‹¡_bufãr_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

936 
	`¢d_pcm_hw_·¿ms_£t_bufãr_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
v®
, 
dœ
);

937 
	`¢d_pcm_hw_·¿ms_£t_bufãr_time_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

938 
	`¢d_pcm_hw_·¿ms_£t_bufãr_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

939 
	`¢d_pcm_hw_·¿ms_£t_bufãr_time_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
mš
, *
mšdœ
, *
max
, *
maxdœ
);

940 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ã¬
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

941 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

942 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, *
v®
, *
dœ
);

944 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

945 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size_mš
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

946 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size_max
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

947 
	`¢d_pcm_hw_·¿ms_‹¡_bufãr_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

948 
	`¢d_pcm_hw_·¿ms_£t_bufãr_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

949 
	`¢d_pcm_hw_·¿ms_£t_bufãr_size_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

950 
	`¢d_pcm_hw_·¿ms_£t_bufãr_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

951 
	`¢d_pcm_hw_·¿ms_£t_bufãr_size_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
mš
, snd_pcm_uäames_ˆ*
max
);

952 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ã¬
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

953 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_fœ¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

954 
	$INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_size_Ï¡
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

956 
	`¢d_pcm_sw_·¿ms_£t_t¡amp_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_t¡amp_t
 
v®
);

957 
	$INTERNAL
(
¢d_pcm_sw_·¿ms_g‘_t¡amp_mode
)(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_t¡amp_t
 *
v®
);

958 
	`¢d_pcm_sw_·¿ms_£t_t¡amp_ty³
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_t¡amp_ty³_t
 
v®
);

959 
	`¢d_pcm_sw_·¿ms_g‘_t¡amp_ty³
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_t¡amp_ty³_t
 *
v®
);

960 
	`¢d_pcm_sw_·¿ms_£t_ava_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

961 
	$INTERNAL
(
¢d_pcm_sw_·¿ms_g‘_ava_mš
)(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

962 
	`¢d_pcm_sw_·¿ms_£t_¡¬t_th»shŞd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

963 
	$INTERNAL
(
¢d_pcm_sw_·¿ms_g‘_¡¬t_th»shŞd
)(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿msm
, 
¢d_pcm_uäames_t
 *
v®
);

964 
	`¢d_pcm_sw_·¿ms_£t_¡İ_th»shŞd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

965 
	$INTERNAL
(
¢d_pcm_sw_·¿ms_g‘_¡İ_th»shŞd
)(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

966 
	`¢d_pcm_sw_·¿ms_£t_s’û_th»shŞd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

967 
	$INTERNAL
(
¢d_pcm_sw_·¿ms_g‘_s’û_th»shŞd
)(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

968 
	`¢d_pcm_sw_·¿ms_£t_s’û_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 
v®
);

969 
	$INTERNAL
(
¢d_pcm_sw_·¿ms_g‘_s’û_size
)(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_uäames_t
 *
v®
);

972 cÚ¡ *
	`¢d_pcm_hw_·¿m_Çme
(
¢d_pcm_hw_·¿m_t
 
·¿m
);

973 
	`¢d_pcm_hw_·¿m_dump
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

974 
¢d_pcm_hw_·¿m_t
 
v¬
, 
¢d_ouut_t
 *
out
);

976 
	`¢d_pcm_hw_¡¿‹gy_sim¶e_Ã¬
(
¢d_pcm_hw_¡¿‹gy_t
 *
¡¿‹gy
, 
Üd”
,

977 
¢d_pcm_hw_·¿m_t
 
v¬
,

978 
be¡
,

979 
mul
);

980 
	`¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs
(
¢d_pcm_hw_¡¿‹gy_t
 *
¡¿‹gy
, 
Üd”
,

981 
¢d_pcm_hw_·¿m_t
 
v¬
,

982 
couÁ
,

983 
¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_li¡_t
 *
choiûs
);

986 
	#SCONF_MANDATORY
 1

	)

987 
	#SCONF_UNCHANGED
 2

	)

989 
	`¢d_pcm_¦ave_cÚf
(
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

990 
¢d_cÚfig_t
 **
pcm_cÚf
, 
couÁ
, ...);

992 
	#SND_PCM_APPEND
 (1<<8)

	)

994 
	`¢d_pcm_İ’_Çmed_¦ave
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

995 
¢d_cÚfig_t
 *
roÙ
,

996 
¢d_cÚfig_t
 *
cÚf
, 
¢d_pcm_¡»am_t
 
¡»am
,

997 
mode
, 
¢d_cÚfig_t
 *
·»Á_cÚf
);

998 
šlše
 

999 
	$¢d_pcm_İ’_¦ave
(
¢d_pcm_t
 **
pcmp
, 
¢d_cÚfig_t
 *
roÙ
,

1000 
¢d_cÚfig_t
 *
cÚf
, 
¢d_pcm_¡»am_t
 
¡»am
,

1001 
mode
, 
¢d_cÚfig_t
 *
·»Á_cÚf
)

1003  
	`¢d_pcm_İ’_Çmed_¦ave
(
pcmp
, 
NULL
, 
roÙ
, 
cÚf
, 
¡»am
,

1004 
mode
, 
·»Á_cÚf
);

1005 
	}
}

1007 
	#¢d_pcm_cÚf_g’”ic_id
(
id
è
	`_¢d_cÚf_g’”ic_id
(id)

	)

1009 
¢d_pcm_hw_İ’_fd
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
, 
fd
,

1010 
sync_±r_ioùl
);

1011 
__¢d_pcm_mm­_emul_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1012 
¢d_pcm_t
 *
¦ave
, 
şo£_¦ave
);

1014 
¢d_pcm_wa™_nocheck
(
¢d_pcm_t
 *
pcm
, 
timeout
);

1016 cÚ¡ 
¢d_cÚfig_t
 *
¢d_pcm_¿‹_g‘_deçuÉ_cÚv”‹r
(¢d_cÚfig_ˆ*
roÙ
);

1018 
	#SND_PCM_HW_PARBIT_ACCESS
 (1U << 
SND_PCM_HW_PARAM_ACCESS
)

	)

1019 
	#SND_PCM_HW_PARBIT_FORMAT
 (1U << 
SND_PCM_HW_PARAM_FORMAT
)

	)

1020 
	#SND_PCM_HW_PARBIT_SUBFORMAT
 (1U << 
SND_PCM_HW_PARAM_SUBFORMAT
)

	)

1021 
	#SND_PCM_HW_PARBIT_CHANNELS
 (1U << 
SND_PCM_HW_PARAM_CHANNELS
)

	)

1022 
	#SND_PCM_HW_PARBIT_RATE
 (1U << 
SND_PCM_HW_PARAM_RATE
)

	)

1023 
	#SND_PCM_HW_PARBIT_PERIOD_TIME
 (1U << 
SND_PCM_HW_PARAM_PERIOD_TIME
)

	)

1024 
	#SND_PCM_HW_PARBIT_PERIOD_SIZE
 (1U << 
SND_PCM_HW_PARAM_PERIOD_SIZE
)

	)

1025 
	#SND_PCM_HW_PARBIT_PERIODS
 (1U << 
SND_PCM_HW_PARAM_PERIODS
)

	)

1026 
	#SND_PCM_HW_PARBIT_BUFFER_TIME
 (1U << 
SND_PCM_HW_PARAM_BUFFER_TIME
)

	)

1027 
	#SND_PCM_HW_PARBIT_BUFFER_SIZE
 (1U << 
SND_PCM_HW_PARAM_BUFFER_SIZE
)

	)

1028 
	#SND_PCM_HW_PARBIT_SAMPLE_BITS
 (1U << 
SND_PCM_HW_PARAM_SAMPLE_BITS
)

	)

1029 
	#SND_PCM_HW_PARBIT_FRAME_BITS
 (1U << 
SND_PCM_HW_PARAM_FRAME_BITS
)

	)

1030 
	#SND_PCM_HW_PARBIT_PERIOD_BYTES
 (1U << 
SND_PCM_HW_PARAM_PERIOD_BYTES
)

	)

1031 
	#SND_PCM_HW_PARBIT_BUFFER_BYTES
 (1U << 
SND_PCM_HW_PARAM_BUFFER_BYTES
)

	)

1032 
	#SND_PCM_HW_PARBIT_TICK_TIME
 (1U << 
SND_PCM_HW_PARAM_TICK_TIME
)

	)

1035 
	#SND_PCM_ACCBIT_MMAP
 { ((1U << 
SND_PCM_ACCESS_MMAP_INTERLEAVED
) | \

1036 (1U << 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
) | \

1037 (1U << 
SND_PCM_ACCESS_MMAP_COMPLEX
)è}

	)

1038 
	#SND_PCM_ACCBIT_MMAPI
 { (1U << 
SND_PCM_ACCESS_MMAP_INTERLEAVED
è}

	)

1039 
	#SND_PCM_ACCBIT_MMAPN
 { (1U << 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
è}

	)

1040 
	#SND_PCM_ACCBIT_MMAPC
 { (1U << 
SND_PCM_ACCESS_MMAP_COMPLEX
è}

	)

1042 
	#SND_PCM_ACCBIT_SHM
 { ((1U << 
SND_PCM_ACCESS_MMAP_INTERLEAVED
) | \

1043 (1U << 
SND_PCM_ACCESS_RW_INTERLEAVED
) | \

1044 (1U << 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
) | \

1045 (1U << 
SND_PCM_ACCESS_RW_NONINTERLEAVED
)è}

	)

1046 
	#SND_PCM_ACCBIT_SHMI
 { ((1U << 
SND_PCM_ACCESS_MMAP_INTERLEAVED
) | \

1047 (1U << 
SND_PCM_ACCESS_RW_INTERLEAVED
)è}

	)

1048 
	#SND_PCM_ACCBIT_SHMN
 { ((1U << 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
) | \

1049 (1U << 
SND_PCM_ACCESS_RW_NONINTERLEAVED
)è}

	)

1051 
	#SND_PCM_FMTBIT_LINEAR
 \

1052 { ((1U << 
SND_PCM_FORMAT_S8
) | \

1053 (1U << 
SND_PCM_FORMAT_U8
) | \

1054 (1U << 
SND_PCM_FORMAT_S16_LE
) | \

1055 (1U << 
SND_PCM_FORMAT_S16_BE
) | \

1056 (1U << 
SND_PCM_FORMAT_U16_LE
) | \

1057 (1U << 
SND_PCM_FORMAT_U16_BE
) | \

1058 (1U << 
SND_PCM_FORMAT_S20_LE
) | \

1059 (1U << 
SND_PCM_FORMAT_S20_BE
) | \

1060 (1U << 
SND_PCM_FORMAT_U20_LE
) | \

1061 (1U << 
SND_PCM_FORMAT_U20_BE
) | \

1062 (1U << 
SND_PCM_FORMAT_S24_LE
) | \

1063 (1U << 
SND_PCM_FORMAT_S24_BE
) | \

1064 (1U << 
SND_PCM_FORMAT_U24_LE
) | \

1065 (1U << 
SND_PCM_FORMAT_U24_BE
) | \

1066 (1U << 
SND_PCM_FORMAT_S32_LE
) | \

1067 (1U << 
SND_PCM_FORMAT_S32_BE
) | \

1068 (1U << 
SND_PCM_FORMAT_U32_LE
) | \

1069 (1U << 
SND_PCM_FORMAT_U32_BE
)), \

1070 ((1U << (
SND_PCM_FORMAT_S24_3LE
 - 32)) | \

1071 (1U << (
SND_PCM_FORMAT_U24_3LE
 - 32)) | \

1072 (1U << (
SND_PCM_FORMAT_S24_3BE
 - 32)) | \

1073 (1U << (
SND_PCM_FORMAT_U24_3BE
 - 32)) | \

1074 (1U << (
SND_PCM_FORMAT_S20_3LE
 - 32)) | \

1075 (1U << (
SND_PCM_FORMAT_U20_3LE
 - 32)) | \

1076 (1U << (
SND_PCM_FORMAT_S20_3BE
 - 32)) | \

1077 (1U << (
SND_PCM_FORMAT_U20_3BE
 - 32)) | \

1078 (1U << (
SND_PCM_FORMAT_S18_3LE
 - 32)) | \

1079 (1U << (
SND_PCM_FORMAT_U18_3LE
 - 32)) | \

1080 (1U << (
SND_PCM_FORMAT_S18_3BE
 - 32)) | \

1081 (1U << (
SND_PCM_FORMAT_U18_3BE
 - 32))è}

	)

1084 
	#SND_PCM_FMTBIT_FLOAT
 \

1085 { ((1U << 
SND_PCM_FORMAT_FLOAT_LE
) | \

1086 (1U << 
SND_PCM_FORMAT_FLOAT_BE
) | \

1087 (1U << 
SND_PCM_FORMAT_FLOAT64_LE
) | \

1088 (1U << 
SND_PCM_FORMAT_FLOAT64_BE
)è}

	)

1091 
	u¢d_tmp_æßt
 {

1092 
	mf
;

1093 
št32_t
 
	mi
;

1094 } 
	t¢d_tmp_æßt_t
;

1096 
	u¢d_tmp_doubË
 {

1097 
	md
;

1098 
št64_t
 
	ml
;

1099 } 
	t¢d_tmp_doubË_t
;

1102 #ifdeà
HAVE_CLOCK_GETTIME


1103 
šlše
 
	$g‘time¡amp
(
¢d_htime¡amp_t
 *
t¡amp
,

1104 
¢d_pcm_t¡amp_ty³_t
 
t¡amp_ty³
)

1106 
şockid_t
 
id
;

1108 
t¡amp_ty³
) {

1109 #ifdeà
CLOCK_MONOTONIC_RAW


1110 
SND_PCM_TSTAMP_TYPE_MONOTONIC_RAW
:

1111 
id
 = 
CLOCK_MONOTONIC_RAW
;

1114 #ifdeà
CLOCK_MONOTONIC


1115 
SND_PCM_TSTAMP_TYPE_MONOTONIC
:

1116 
id
 = 
CLOCK_MONOTONIC
;

1120 
id
 = 
CLOCK_REALTIME
;

1123 
	`şock_g‘time
(
id
, 
t¡amp
);

1124 
	}
}

1126 
šlše
 
	$g‘time¡amp
(
¢d_htime¡amp_t
 *
t¡amp
,

1127 
¢d_pcm_t¡amp_ty³_t
 
t¡amp_ty³
)

1129 
timev®
 
tv
;

1131 
	`g‘timeofday
(&
tv
, 0);

1132 
t¡amp
->
tv_£c
 = 
tv
.tv_sec;

1133 
t¡amp
->
tv_n£c
 = 
tv
.
tv_u£c
 * 1000L;

1134 
	}
}

1137 
¢d_pcm_chm­_qu”y_t
 **

1138 
_¢d_pcm_make_sšgË_qu”y_chm­s
(cÚ¡ 
¢d_pcm_chm­_t
 *
¤c
);

1139 
¢d_pcm_chm­_t
 *
_¢d_pcm_cİy_chm­
(cÚ¡ snd_pcm_chm­_ˆ*
¤c
);

1140 
¢d_pcm_chm­_qu”y_t
 **

1141 
_¢d_pcm_cİy_chm­_qu”y
(
¢d_pcm_chm­_qu”y_t
 * cÚ¡ *
¤c
);

1142 
¢d_pcm_chm­_qu”y_t
 **

1143 
_¢d_pcm_·r£_cÚfig_chm­s
(
¢d_cÚfig_t
 *
cÚf
);

1144 
¢d_pcm_chm­_t
 *

1145 
_¢d_pcm_choo£_fixed_chm­
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chm­_qu”y_t
 * cÚ¡ *
m­s
);

1148 
šlše
 
	$¢d_pcm_may_wa™_fÜ_ava_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
ava
)

1150 ià(
ava
 >ğ
pcm
->
ava_mš
)

1152 ià(
pcm
->
ç¡_İs
->
may_wa™_fÜ_ava_mš
)

1153  
pcm
->
ç¡_İs
->
	`may_wa™_fÜ_ava_mš
Õcm->
ç¡_İ_¬g
, 
ava
);

1155 
	}
}

1158 
šlše
 
	$sw_g‘_³riod_ev’t
(cÚ¡ 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
)

1160  
·¿ms
->
»£rved
[(params->reserved) / (params->reserved[0])- 1];

1161 
	}
}

1163 
šlše
 
	$sw_£t_³riod_ev’t
(
¢d_pcm_sw_·¿ms_t
 *
·¿ms
, 
v®
)

1165 
·¿ms
->
»£rved
[Õ¬ams->»£rvedè/ Õ¬ams->»£rved[0]è- 1] = 
v®
;

1166 
	}
}

1168 
	#PCMINABORT
(
pcm
è((Õcm)->
mode
 & 
SND_PCM_ABORT
è!ğ0)

	)

1170 
šlše
 
¢d_pcm_säames_t
 
	$pcm_äame_diff
(
¢d_pcm_uäames_t
 
±r1
,

1171 
¢d_pcm_uäames_t
 
±r2
,

1172 
¢d_pcm_uäames_t
 
bound¬y
)

1174 ià(
±r1
 < 
±r2
)

1175  
±r1
 + (
bound¬y
 - 
±r2
);

1177  
±r1
 - 
±r2
;

1178 
	}
}

1180 
šlše
 
¢d_pcm_säames_t
 
	$pcm_äame_diff2
(
¢d_pcm_uäames_t
 
±r1
,

1181 
¢d_pcm_uäames_t
 
±r2
,

1182 
¢d_pcm_uäames_t
 
bound¬y
)

1184 
¢d_pcm_säames_t
 
r
 = 
±r1
 - 
±r2
;

1185 ià(
r
 >ğ(
¢d_pcm_säames_t
)
bound¬y
 / 2)

1186  
bound¬y
 - 
r
;

1187  
r
;

1188 
	}
}

1190 #ifdeà
THREAD_SAFE_API


1203 
šlše
 
	$__¢d_pcm_lock
(
¢d_pcm_t
 *
pcm
)

1205 ià(
pcm
->
lock_’abËd
)

1206 
	`±h»ad_mu‹x_lock
(&
pcm
->
lock
);

1207 
	}
}

1208 
šlše
 
	$__¢d_pcm_uÆock
(
¢d_pcm_t
 *
pcm
)

1210 ià(
pcm
->
lock_’abËd
)

1211 
	`±h»ad_mu‹x_uÆock
(&
pcm
->
lock
);

1212 
	}
}

1213 
šlše
 
	$¢d_pcm_lock
(
¢d_pcm_t
 *
pcm
)

1215 ià(
pcm
->
lock_’abËd
 &&…cm->
Ãed_lock
)

1216 
	`±h»ad_mu‹x_lock
(&
pcm
->
lock
);

1217 
	}
}

1218 
šlše
 
	$¢d_pcm_uÆock
(
¢d_pcm_t
 *
pcm
)

1220 ià(
pcm
->
lock_’abËd
 &&…cm->
Ãed_lock
)

1221 
	`±h»ad_mu‹x_uÆock
(&
pcm
->
lock
);

1222 
	}
}

1224 
	#__¢d_pcm_lock
(
pcm
èdØ{} 0)

	)

1225 
	#__¢d_pcm_uÆock
(
pcm
èdØ{} 0)

	)

1226 
	#¢d_pcm_lock
(
pcm
èdØ{} 0)

	)

1227 
	#¢d_pcm_uÆock
(
pcm
èdØ{} 0)

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_meter.c

30 
	~"pcm_loÿl.h
"

31 
	~"pcm_¶ugš.h
"

32 
	~"bsw­.h
"

33 
	~<time.h
>

34 
	~<±h»ad.h
>

35 
	~<dlfú.h
>

37 #iâdeà
DOC_HIDDEN


38 
	#©omic_»ad
(
±r
è
	`__©omic_lßd_n
ÕŒ, 
__ATOMIC_SEQ_CST
 )

	)

39 
	#©omic_add
(
±r
, 
n
è
	`__©omic_add_ãtch
ÕŒ,‚, 
__ATOMIC_SEQ_CST
)

	)

40 
	#©omic_dec
(
±r
è
	`__©omic_sub_ãtch
ÕŒ, 1, 
__ATOMIC_SEQ_CST
)

	)

43 #iâdeà
PIC


45 cÚ¡ *
	g_¢d_moduË_pcm_m‘”
 = "";

48 #iâdeà
DOC_HIDDEN


49 
	#FREQUENCY
 50

	)

51 
	s_¢d_pcm_scİe
 {

52 
	m’abËd
;

53 *
	mÇme
;

54 cÚ¡ 
¢d_pcm_scİe_İs_t
 *
	mİs
;

55 *
	m´iv©e_d©a
;

56 
li¡_h—d
 
	mli¡
;

59 
	s_¢d_pcm_m‘”
 {

60 
¢d_pcm_g’”ic_t
 
	mg’
;

61 
¢d_pcm_uäames_t
 
	m½Œ
;

62 
¢d_pcm_uäames_t
 
	mbuf_size
;

63 
¢d_pcm_chªÃl_¬—_t
 *
	mbuf_¬—s
;

64 
¢d_pcm_uäames_t
 
	mnow
;

65 *
	mbuf
;

66 
li¡_h—d
 
	mscİes
;

67 
	mşo£d
;

68 
	mruÂšg
;

69 
	m»£t
;

70 
±h»ad_t
 
	mth»ad
;

71 
±h»ad_mu‹x_t
 
	mupd©e_mu‹x
;

72 
±h»ad_mu‹x_t
 
	mruÂšg_mu‹x
;

73 
±h»ad_cÚd_t
 
	mruÂšg_cÚd
;

74 
time¥ec
 
	md–ay
;

75 *
	mdl_hªdË
;

76 } 
	t¢d_pcm_m‘”_t
;

78 
	$¢d_pcm_m‘”_add_äames
(
¢d_pcm_t
 *
pcm
,

79 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

80 
¢d_pcm_uäames_t
 
±r
,

81 
¢d_pcm_uäames_t
 
äames
)

83 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

84 ià(
äames
 > 
pcm
->
bufãr_size
)

85 
äames
 = 
pcm
->
bufãr_size
;

86 
äames
 > 0) {

87 
¢d_pcm_uäames_t
 
n
 = 
äames
;

88 
¢d_pcm_uäames_t
 
d¡_off£t
 = 
±r
 % 
m‘”
->
buf_size
;

89 
¢d_pcm_uäames_t
 
¤c_off£t
 = 
±r
 % 
pcm
->
bufãr_size
;

90 
¢d_pcm_uäames_t
 
d¡_cÚt
 = 
m‘”
->
buf_size
 - 
d¡_off£t
;

91 
¢d_pcm_uäames_t
 
¤c_cÚt
 = 
pcm
->
bufãr_size
 - 
¤c_off£t
;

92 ià(
n
 > 
d¡_cÚt
)

93 
n
 = 
d¡_cÚt
;

94 ià(
n
 > 
¤c_cÚt
)

95 
n
 = 
¤c_cÚt
;

96 
	`¢d_pcm_¬—s_cİy
(
m‘”
->
buf_¬—s
, 
d¡_off£t
,

97 
¬—s
, 
¤c_off£t
,

98 
pcm
->
chªÃls
, 
n
,…cm->
fÜm©
);

99 
äames
 -ğ
n
;

100 
±r
 +ğ
n
;

101 ià(
±r
 =ğ
pcm
->
bound¬y
)

102 
±r
 = 0;

104 
	}
}

106 
	$¢d_pcm_m‘”_upd©e_maš
(
¢d_pcm_t
 *
pcm
)

108 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

109 
¢d_pcm_säames_t
 
äames
;

110 
¢d_pcm_uäames_t
 
½Œ
, 
Şd_½Œ
;

111 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
;

112 
locked
;

113 
locked
 = (
	`±h»ad_mu‹x_Œylock
(&
m‘”
->
upd©e_mu‹x
) >= 0);

114 
¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

115 
½Œ
 = *
pcm
->
hw
.
±r
;

116 
Şd_½Œ
 = 
m‘”
->
½Œ
;

117 
m‘”
->
½Œ
 =„ptr;

118 
äames
 = 
½Œ
 - 
Şd_½Œ
;

119 ià(
äames
 < 0)

120 
äames
 +ğ
pcm
->
bound¬y
;

121 ià(
äames
 > 0) {

122 
	`as£¹
((
¢d_pcm_uäames_t
è
äames
 <ğ
pcm
->
bufãr_size
);

123 
	`¢d_pcm_m‘”_add_äames
(
pcm
, 
¬—s
, 
Şd_½Œ
,

124 (
¢d_pcm_uäames_t
è
äames
);

126 ià(
locked
)

127 
	`±h»ad_mu‹x_uÆock
(&
m‘”
->
upd©e_mu‹x
);

128 
	}
}

130 
	$¢d_pcm_m‘”_upd©e_scİe
(
¢d_pcm_t
 *
pcm
)

132 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

133 
¢d_pcm_säames_t
 
äames
;

134 
¢d_pcm_uäames_t
 
½Œ
, 
Şd_½Œ
;

135 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
;

136 
»£t
 = 0;

138 
	`±h»ad_mu‹x_lock
(&
m‘”
->
upd©e_mu‹x
);

139 
¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

140 
_agaš
:

141 
½Œ
 = *
pcm
->
hw
.
±r
;

142 
Şd_½Œ
 = 
m‘”
->
½Œ
;

143 ià(
	`©omic_»ad
(&
m‘”
->
»£t
)) {

144 
»£t
 = 1;

145 
	`©omic_dec
(&
m‘”
->
»£t
);

146 
_agaš
;

148 
m‘”
->
½Œ
 =„ptr;

149 
äames
 = 
½Œ
 - 
Şd_½Œ
;

150 ià(
äames
 < 0)

151 
äames
 +ğ
pcm
->
bound¬y
;

152 ià(
äames
 > 0) {

153 
	`as£¹
((
¢d_pcm_uäames_t
è
äames
 <ğ
pcm
->
bufãr_size
);

154 
	`¢d_pcm_m‘”_add_äames
(
pcm
, 
¬—s
, 
Şd_½Œ
,

155 (
¢d_pcm_uäames_t
è
äames
);

157 
	`±h»ad_mu‹x_uÆock
(&
m‘”
->
upd©e_mu‹x
);

158  
»£t
;

159 
	}
}

161 
	$¢d_pcm_scİe_»move
(
¢d_pcm_scİe_t
 *
scİe
)

163 
	`ä“
(
scİe
->
Çme
);

164 
scİe
->
İs
->
	`şo£
(scope);

165 
	`li¡_d–
(&
scİe
->
li¡
);

166 
	`ä“
(
scİe
);

168 
	}
}

170 
	$¢d_pcm_scİe_’abË
(
¢d_pcm_scİe_t
 *
scİe
)

172 
”r
;

173 
	`as£¹
(!
scİe
->
’abËd
);

174 
”r
 = 
scİe
->
İs
->
	`’abË
(scope);

175 
scİe
->
’abËd
 = (
”r
 >= 0);

176  
”r
;

177 
	}
}

179 
	$¢d_pcm_scİe_di§bË
(
¢d_pcm_scİe_t
 *
scİe
)

181 
	`as£¹
(
scİe
->
’abËd
);

182 
scİe
->
İs
->
	`di§bË
(scope);

183 
scİe
->
’abËd
 = 0;

185 
	}
}

187 *
	$¢d_pcm_m‘”_th»ad
(*
d©a
)

189 
¢d_pcm_t
 *
pcm
 = 
d©a
;

190 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

191 
¢d_pcm_t
 *
¥cm
 = 
m‘”
->
g’
.
¦ave
;

192 
li¡_h—d
 *
pos
;

193 
¢d_pcm_scİe_t
 *
scİe
;

194 
»£t
;

195 
	`li¡_fÜ_—ch
(
pos
, &
m‘”
->
scİes
) {

196 
scİe
 = 
	`li¡_’Œy
(
pos
, 
¢d_pcm_scİe_t
, 
li¡
);

197 
	`¢d_pcm_scİe_’abË
(
scİe
);

199 !
m‘”
->
şo£d
) {

200 
¢d_pcm_säames_t
 
now
;

201 
¢d_pcm_¡©us_t
 
¡©us
;

202 
”r
;

203 
	`±h»ad_mu‹x_lock
(&
m‘”
->
ruÂšg_mu‹x
);

204 
”r
 = 
	`¢d_pcm_¡©us
(
¥cm
, &
¡©us
);

205 
	`as£¹
(
”r
 >= 0);

206 ià(
¡©us
.
¡©e
 !ğ
SND_PCM_STATE_RUNNING
 &&

207 (
¡©us
.
¡©e
 !ğ
SND_PCM_STATE_DRAINING
 ||

208 
¥cm
->
¡»am
 !ğ
SND_PCM_STREAM_PLAYBACK
)) {

209 ià(
m‘”
->
ruÂšg
) {

210 
	`li¡_fÜ_—ch
(
pos
, &
m‘”
->
scİes
) {

211 
scİe
 = 
	`li¡_’Œy
(
pos
, 
¢d_pcm_scİe_t
, 
li¡
);

212 
scİe
->
İs
->
	`¡İ
(scope);

214 
m‘”
->
ruÂšg
 = 0;

216 
	`±h»ad_cÚd_wa™
(&
m‘”
->
ruÂšg_cÚd
,

217 &
m‘”
->
ruÂšg_mu‹x
);

218 
	`±h»ad_mu‹x_uÆock
(&
m‘”
->
ruÂšg_mu‹x
);

221 
	`±h»ad_mu‹x_uÆock
(&
m‘”
->
ruÂšg_mu‹x
);

222 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

223 
now
 = 
¡©us
.
­¶_±r
 - stus.
d–ay
;

224 ià(
now
 < 0)

225 
now
 +ğ
pcm
->
bound¬y
;

227 
now
 = 
¡©us
.
­¶_±r
 + stus.
d–ay
;

228 ià((
¢d_pcm_uäames_t
è
now
 >ğ
pcm
->
bound¬y
)

229 
now
 -ğ
pcm
->
bound¬y
;

231 
m‘”
->
now
 =‚ow;

232 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
)

233 
»£t
 = 
	`¢d_pcm_m‘”_upd©e_scİe
(
pcm
);

235 
»£t
 = 0;

236 
	`©omic_»ad
(&
m‘”
->
»£t
)) {

237 
»£t
 = 1;

238 
	`©omic_dec
(&
m‘”
->
»£t
);

241 ià(
»£t
) {

242 
	`li¡_fÜ_—ch
(
pos
, &
m‘”
->
scİes
) {

243 
scİe
 = 
	`li¡_’Œy
(
pos
, 
¢d_pcm_scİe_t
, 
li¡
);

244 ià(
scİe
->
’abËd
)

245 
scİe
->
İs
->
	`»£t
(scope);

249 ià(!
m‘”
->
ruÂšg
) {

250 
	`li¡_fÜ_—ch
(
pos
, &
m‘”
->
scİes
) {

251 
scİe
 = 
	`li¡_’Œy
(
pos
, 
¢d_pcm_scİe_t
, 
li¡
);

252 ià(
scİe
->
’abËd
)

253 
scİe
->
İs
->
	`¡¬t
(scope);

255 
m‘”
->
ruÂšg
 = 1;

257 
	`li¡_fÜ_—ch
(
pos
, &
m‘”
->
scİes
) {

258 
scİe
 = 
	`li¡_’Œy
(
pos
, 
¢d_pcm_scİe_t
, 
li¡
);

259 ià(
scİe
->
’abËd
)

260 
scİe
->
İs
->
	`upd©e
(scope);

262 
	`Çno¦“p
(&
m‘”
->
d–ay
, 
NULL
);

264 
	`li¡_fÜ_—ch
(
pos
, &
m‘”
->
scİes
) {

265 
scİe
 = 
	`li¡_’Œy
(
pos
, 
¢d_pcm_scİe_t
, 
li¡
);

266 ià(
scİe
->
’abËd
)

267 
	`¢d_pcm_scİe_di§bË
(
scİe
);

269  
NULL
;

270 
	}
}

272 
	$¢d_pcm_m‘”_şo£
(
¢d_pcm_t
 *
pcm
)

274 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

275 
li¡_h—d
 *
pos
, *
Åos
;

276 
”r
 = 0;

277 
	`±h»ad_mu‹x_de¡roy
(&
m‘”
->
upd©e_mu‹x
);

278 
	`±h»ad_mu‹x_de¡roy
(&
m‘”
->
ruÂšg_mu‹x
);

279 
	`±h»ad_cÚd_de¡roy
(&
m‘”
->
ruÂšg_cÚd
);

280 ià(
m‘”
->
g’
.
şo£_¦ave
)

281 
”r
 = 
	`¢d_pcm_şo£
(
m‘”
->
g’
.
¦ave
);

282 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, &
m‘”
->
scİes
) {

283 
¢d_pcm_scİe_t
 *
scİe
;

284 
scİe
 = 
	`li¡_’Œy
(
pos
, 
¢d_pcm_scİe_t
, 
li¡
);

285 
	`¢d_pcm_scİe_»move
(
scİe
);

287 ià(
m‘”
->
dl_hªdË
)

288 
	`¢d_dlşo£
(
m‘”
->
dl_hªdË
);

289 
	`ä“
(
m‘”
);

290  
”r
;

291 
	}
}

293 
	$¢d_pcm_m‘”_´•¬e
(
¢d_pcm_t
 *
pcm
)

295 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

296 
”r
;

297 
	`©omic_add
(&
m‘”
->
»£t
, 1);

298 
”r
 = 
	`¢d_pcm_´•¬e
(
m‘”
->
g’
.
¦ave
);

299 ià(
”r
 >= 0) {

300 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

301 
m‘”
->
½Œ
 = *
pcm
->
­¶
.
±r
;

303 
m‘”
->
½Œ
 = *
pcm
->
hw
.
±r
;

305  
”r
;

306 
	}
}

308 
	$¢d_pcm_m‘”_»£t
(
¢d_pcm_t
 *
pcm
)

310 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

311 
”r
 = 
	`¢d_pcm_»£t
(
m‘”
->
g’
.
¦ave
);

312 ià(
”r
 >= 0) {

313 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

314 
m‘”
->
½Œ
 = *
pcm
->
­¶
.
±r
;

316  
”r
;

317 
	}
}

319 
	$¢d_pcm_m‘”_¡¬t
(
¢d_pcm_t
 *
pcm
)

321 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

322 
”r
;

323 
	`±h»ad_mu‹x_lock
(&
m‘”
->
ruÂšg_mu‹x
);

324 
”r
 = 
	`¢d_pcm_¡¬t
(
m‘”
->
g’
.
¦ave
);

325 ià(
”r
 >= 0)

326 
	`±h»ad_cÚd_sigÇl
(&
m‘”
->
ruÂšg_cÚd
);

327 
	`±h»ad_mu‹x_uÆock
(&
m‘”
->
ruÂšg_mu‹x
);

328  
”r
;

329 
	}
}

331 
¢d_pcm_säames_t
 
	$¢d_pcm_m‘”_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

333 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

334 
¢d_pcm_säames_t
 
”r
 = 
	`¢d_pcm_»wšd
(
m‘”
->
g’
.
¦ave
, 
äames
);

335 ià(
”r
 > 0 && 
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

336 
m‘”
->
½Œ
 = *
pcm
->
­¶
.
±r
;

337  
”r
;

338 
	}
}

340 
¢d_pcm_säames_t
 
	$¢d_pcm_m‘”_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

342 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

343 
¢d_pcm_säames_t
 
”r
 = 
	`INTERNAL
(
¢d_pcm_fÜw¬d
)(
m‘”
->
g’
.
¦ave
, 
äames
);

344 ià(
”r
 > 0 && 
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

345 
m‘”
->
½Œ
 = *
pcm
->
­¶
.
±r
;

346  
”r
;

347 
	}
}

349 
¢d_pcm_säames_t
 
	$¢d_pcm_m‘”_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

350 
¢d_pcm_uäames_t
 
off£t
,

351 
¢d_pcm_uäames_t
 
size
)

353 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

354 
¢d_pcm_uäames_t
 
Şd_½Œ
 = *
pcm
->
­¶
.
±r
;

355 
¢d_pcm_säames_t
 
»suÉ
 = 
	`¢d_pcm_mm­_comm™
(
m‘”
->
g’
.
¦ave
, 
off£t
, 
size
);

356 ià(
»suÉ
 <= 0)

357  
»suÉ
;

358 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

359 
	`¢d_pcm_m‘”_add_äames
(
pcm
, 
	`¢d_pcm_mm­_¬—s
Õcm), 
Şd_½Œ
, 
»suÉ
);

360 
m‘”
->
½Œ
 = *
pcm
->
­¶
.
±r
;

362  
»suÉ
;

363 
	}
}

365 
¢d_pcm_säames_t
 
	$¢d_pcm_m‘”_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

367 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

368 
¢d_pcm_säames_t
 
»suÉ
 = 
	`¢d_pcm_ava_upd©e
(
m‘”
->
g’
.
¦ave
);

369 ià(
»suÉ
 <= 0)

370  
»suÉ
;

371 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
)

372 
	`¢d_pcm_m‘”_upd©e_maš
(
pcm
);

373  
»suÉ
;

374 
	}
}

376 
	$¢d_pcm_m‘”_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

378 
”r
;

379 
¢d_pcm_acûss_mask_t
 
acûss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

380 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

381 &
acûss_mask
);

382 ià(
”r
 < 0)

383  
”r
;

384 
·¿ms
->
šfo
 &ğ~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

386 
	}
}

388 
	$¢d_pcm_m‘”_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

390 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

391 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

392 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

393 &
§cûss_mask
);

395 
	}
}

397 
	$¢d_pcm_m‘”_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

398 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

400 
”r
;

401 
lšks
 = ~
SND_PCM_HW_PARBIT_ACCESS
;

402 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

403 ià(
”r
 < 0)

404  
”r
;

406 
	}
}

408 
	$¢d_pcm_m‘”_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

409 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

411 
”r
;

412 
lšks
 = ~
SND_PCM_HW_PARBIT_ACCESS
;

413 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

414 ià(
”r
 < 0)

415  
”r
;

417 
	}
}

419 
	$¢d_pcm_m‘”_hw_»fše_¦ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

421 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

422  
	`¢d_pcm_hw_»fše
(
m‘”
->
g’
.
¦ave
, 
·¿ms
);

423 
	}
}

425 
	$¢d_pcm_m‘”_hw_·¿ms_¦ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

427 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

428  
	`_¢d_pcm_hw_·¿ms_š‹º®
(
m‘”
->
g’
.
¦ave
, 
·¿ms
);

429 
	}
}

431 
	$¢d_pcm_m‘”_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

433  
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

434 
¢d_pcm_m‘”_hw_»fše_ı»·»
,

435 
¢d_pcm_m‘”_hw_»fše_cchªge
,

436 
¢d_pcm_m‘”_hw_»fše_¥»·»
,

437 
¢d_pcm_m‘”_hw_»fše_schªge
,

438 
¢d_pcm_m‘”_hw_»fše_¦ave
);

439 
	}
}

441 
	$¢d_pcm_m‘”_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 * 
·¿ms
)

443 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

444 
chªÃl
;

445 
¢d_pcm_t
 *
¦ave
 = 
m‘”
->
g’
.slave;

446 
size_t
 
buf_size_by‹s
;

447 
”r
;

448 
”r
 = 
	`¢d_pcm_hw_·¿ms_¦ave
(
pcm
, 
·¿ms
,

449 
¢d_pcm_m‘”_hw_»fše_cchªge
,

450 
¢d_pcm_m‘”_hw_»fše_¥»·»
,

451 
¢d_pcm_m‘”_hw_»fše_schªge
,

452 
¢d_pcm_m‘”_hw_·¿ms_¦ave
);

453 ià(
”r
 < 0)

454  
”r
;

456 
m‘”
->
buf_size
 = 
¦ave
->
bufãr_size
;

457 
m‘”
->
buf_size
 < 
¦ave
->
¿‹
)

458 
m‘”
->
buf_size
 *= 2;

459 
buf_size_by‹s
 = 
	`¢d_pcm_äames_to_by‹s
(
¦ave
, 
m‘”
->
buf_size
);

460 
	`as£¹
(!
m‘”
->
buf
);

461 
m‘”
->
buf
 = 
	`m®loc
(
buf_size_by‹s
);

462 ià(!
m‘”
->
buf
)

463  -
ENOMEM
;

464 
m‘”
->
buf_¬—s
 = 
	`m®loc
((*m‘”->buf_¬—sè* 
¦ave
->
chªÃls
);

465 ià(!
m‘”
->
buf_¬—s
) {

466 
	`ä“
(
m‘”
->
buf
);

467  -
ENOMEM
;

469 
chªÃl
 = 0; chªÃÈ< 
¦ave
->
chªÃls
; ++channel) {

470 
¢d_pcm_chªÃl_¬—_t
 *
a
 = &
m‘”
->
buf_¬—s
[
chªÃl
];

471 
a
->
addr
 = 
m‘”
->
buf
 + 
buf_size_by‹s
 / 
¦ave
->
chªÃls
 * 
chªÃl
;

472 
a
->
fœ¡
 = 0;

473 
a
->
¡•
 = 
¦ave
->
§m¶e_b™s
;

475 
m‘”
->
şo£d
 = 0;

476 
”r
 = 
	`±h»ad_ü—‹
(&
m‘”
->
th»ad
, 
NULL
, 
¢d_pcm_m‘”_th»ad
, 
pcm
);

477 
	`as£¹
(
”r
 == 0);

479 
	}
}

481 
	$¢d_pcm_m‘”_hw_ä“
(
¢d_pcm_t
 *
pcm
)

483 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

484 
”r
;

485 
m‘”
->
şo£d
 = 1;

486 
	`±h»ad_mu‹x_lock
(&
m‘”
->
ruÂšg_mu‹x
);

487 
	`±h»ad_cÚd_sigÇl
(&
m‘”
->
ruÂšg_cÚd
);

488 
	`±h»ad_mu‹x_uÆock
(&
m‘”
->
ruÂšg_mu‹x
);

489 
”r
 = 
	`±h»ad_još
(
m‘”
->
th»ad
, 0);

490 
	`as£¹
(
”r
 == 0);

491 
	`ä“
(
m‘”
->
buf
);

492 
	`ä“
(
m‘”
->
buf_¬—s
);

493 
m‘”
->
buf
 = 
NULL
;

494 
m‘”
->
buf_¬—s
 = 
NULL
;

495  
	`¢d_pcm_hw_ä“
(
m‘”
->
g’
.
¦ave
);

496 
	}
}

498 
	$¢d_pcm_m‘”_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

500 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

501 
	`¢d_ouut_´štf
(
out
, "Meter PCM\n");

502 ià(
pcm
->
£tup
) {

503 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

504 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

506 
	`¢d_ouut_´štf
(
out
, "Slave: ");

507 
	`¢d_pcm_dump
(
m‘”
->
g’
.
¦ave
, 
out
);

508 
	}
}

510 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_m‘”_İs
 = {

511 .
şo£
 = 
¢d_pcm_m‘”_şo£
,

512 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

513 .
	ghw_»fše
 = 
¢d_pcm_m‘”_hw_»fše
,

514 .
	ghw_·¿ms
 = 
¢d_pcm_m‘”_hw_·¿ms
,

515 .
	ghw_ä“
 = 
¢d_pcm_m‘”_hw_ä“
,

516 .
	gsw_·¿ms
 = 
¢d_pcm_g’”ic_sw_·¿ms
,

517 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

518 .
	gdump
 = 
¢d_pcm_m‘”_dump
,

519 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

520 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

521 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

522 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

523 .
	gqu”y_chm­s
 = 
¢d_pcm_g’”ic_qu”y_chm­s
,

524 .
	gg‘_chm­
 = 
¢d_pcm_g’”ic_g‘_chm­
,

525 .
	g£t_chm­
 = 
¢d_pcm_g’”ic_£t_chm­
,

528 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_m‘”_ç¡_İs
 = {

529 .
¡©us
 = 
¢d_pcm_g’”ic_¡©us
,

530 .
	g¡©e
 = 
¢d_pcm_g’”ic_¡©e
,

531 .
	ghwsync
 = 
¢d_pcm_g’”ic_hwsync
,

532 .
	gd–ay
 = 
¢d_pcm_g’”ic_d–ay
,

533 .
	g´•¬e
 = 
¢d_pcm_m‘”_´•¬e
,

534 .
	g»£t
 = 
¢d_pcm_m‘”_»£t
,

535 .
	g¡¬t
 = 
¢d_pcm_m‘”_¡¬t
,

536 .
	gdrİ
 = 
¢d_pcm_g’”ic_drİ
,

537 .
	gd¿š
 = 
¢d_pcm_g’”ic_d¿š
,

538 .
	g·u£
 = 
¢d_pcm_g’”ic_·u£
,

539 .
	g»wšdabË
 = 
¢d_pcm_g’”ic_»wšdabË
,

540 .
	g»wšd
 = 
¢d_pcm_m‘”_»wšd
,

541 .
	gfÜw¬dabË
 = 
¢d_pcm_g’”ic_fÜw¬dabË
,

542 .
	gfÜw¬d
 = 
¢d_pcm_m‘”_fÜw¬d
,

543 .
	g»sume
 = 
¢d_pcm_g’”ic_»sume
,

544 .
	gwr™ei
 = 
¢d_pcm_mm­_wr™ei
,

545 .
	gwr™’
 = 
¢d_pcm_mm­_wr™’
,

546 .
	g»adi
 = 
¢d_pcm_mm­_»adi
,

547 .
	g»adn
 = 
¢d_pcm_mm­_»adn
,

548 .
	gava_upd©e
 = 
¢d_pcm_m‘”_ava_upd©e
,

549 .
	gmm­_comm™
 = 
¢d_pcm_m‘”_mm­_comm™
,

550 .
	ghtime¡amp
 = 
¢d_pcm_g’”ic_htime¡amp
,

551 .
	gpŞl_desütÜs_couÁ
 = 
¢d_pcm_g’”ic_pŞl_desütÜs_couÁ
,

552 .
	gpŞl_desütÜs
 = 
¢d_pcm_g’”ic_pŞl_desütÜs
,

553 .
	gpŞl_»v’ts
 = 
¢d_pcm_g’”ic_pŞl_»v’ts
,

554 .
	gmay_wa™_fÜ_ava_mš
 = 
¢d_pcm_g’”ic_may_wa™_fÜ_ava_mš
,

569 
	$¢d_pcm_m‘”_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
, 
äequ’cy
,

570 
¢d_pcm_t
 *
¦ave
, 
şo£_¦ave
)

572 
¢d_pcm_t
 *
pcm
;

573 
¢d_pcm_m‘”_t
 *
m‘”
;

574 
”r
;

575 
	`as£¹
(
pcmp
);

576 
m‘”
 = 
	`ÿÎoc
(1, (
¢d_pcm_m‘”_t
));

577 ià(!
m‘”
)

578  -
ENOMEM
;

579 
m‘”
->
g’
.
¦ave
 = slave;

580 
m‘”
->
g’
.
şo£_¦ave
 = close_slave;

581 
m‘”
->
d–ay
.
tv_£c
 = 0;

582 
m‘”
->
d–ay
.
tv_n£c
 = 1000000000 / 
äequ’cy
;

583 
	`INIT_LIST_HEAD
(&
m‘”
->
scİes
);

585 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_METER
, 
Çme
, 
¦ave
->
¡»am
, sÏve->
mode
);

586 ià(
”r
 < 0) {

587 
	`ä“
(
m‘”
);

588  
”r
;

590 
pcm
->
mm­_rw
 = 1;

591 
pcm
->
mm­_shadow
 = 1;

592 
pcm
->
İs
 = &
¢d_pcm_m‘”_İs
;

593 
pcm
->
ç¡_İs
 = &
¢d_pcm_m‘”_ç¡_İs
;

594 
pcm
->
´iv©e_d©a
 = 
m‘”
;

595 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

596 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

597 
pcm
->
t¡amp_ty³
 = 
¦ave
->tstamp_type;

598 
	`¢d_pcm_lšk_hw_±r
(
pcm
, 
¦ave
);

599 
	`¢d_pcm_lšk_­¶_±r
(
pcm
, 
¦ave
);

600 *
pcmp
 = 
pcm
;

602 
	`±h»ad_mu‹x_š™
(&
m‘”
->
upd©e_mu‹x
, 
NULL
);

603 
	`±h»ad_mu‹x_š™
(&
m‘”
->
ruÂšg_mu‹x
, 
NULL
);

604 
	`±h»ad_cÚd_š™
(&
m‘”
->
ruÂšg_cÚd
, 
NULL
);

606 
	}
}

609 
	$¢d_pcm_m‘”_add_scİe_cÚf
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
Çme
,

610 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
)

612 
buf
[256], 
”rbuf
[256];

613 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

614 cÚ¡ *
id
;

615 cÚ¡ *
lib
 = 
NULL
, *
İ’_Çme
 = NULL, *
¡r
 = NULL;

616 
¢d_cÚfig_t
 *
c
, *
ty³_cÚf
 = 
NULL
;

617 (*
İ’_func
)(
¢d_pcm_t
 *, const *,

618 
¢d_cÚfig_t
 *, snd_cÚfig_ˆ*èğ
NULL
;

619 
¢d_pcm_m‘”_t
 *
m‘”
 = 
pcm
->
´iv©e_d©a
;

620 *
h
 = 
NULL
;

621 
”r
;

623 ià(
	`¢d_cÚfig_g‘_ty³
(
cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

624 
	`SNDERR
("Inv®idy³ fÜ scİ%s", 
¡r
);

625 
”r
 = -
EINVAL
;

626 
_”r
;

628 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cÚf
, "ty³", &
c
);

629 ià(
”r
 < 0) {

630 
	`SNDERR
("type is‚ot defined");

631 
_”r
;

633 
”r
 = 
	`¢d_cÚfig_g‘_id
(
c
, &
id
);

634 ià(
”r
 < 0) {

635 
	`SNDERR
("unableo get id");

636 
_”r
;

638 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
c
, &
¡r
);

639 ià(
”r
 < 0) {

640 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

641 
_”r
;

643 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "pcm_scİe_ty³", 
¡r
, &
ty³_cÚf
);

644 ià(
”r
 >= 0) {

645 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
ty³_cÚf
) {

646 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

647 cÚ¡ *
id
;

648 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

650 ià(
	`¡rcmp
(
id
, "comment") == 0)

652 ià(
	`¡rcmp
(
id
, "lib") == 0) {

653 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
lib
);

654 ià(
”r
 < 0) {

655 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

656 
_”r
;

660 ià(
	`¡rcmp
(
id
, "open") == 0) {

661 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
İ’_Çme
);

662 ià(
”r
 < 0) {

663 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

664 
_”r
;

668 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

669 
”r
 = -
EINVAL
;

670 
_”r
;

673 ià(!
İ’_Çme
) {

674 
İ’_Çme
 = 
buf
;

675 
	`¢´štf
(
buf
, (buf), "_¢d_pcm_scİe_%s_İ’", 
¡r
);

677 
h
 = 
	`INTERNAL
(
¢d_dlİ’
)(
lib
, 
RTLD_NOW
, 
”rbuf
, (errbuf));

678 
İ’_func
 = 
h
 ? 
	`dlsym
(h, 
İ’_Çme
è: 
NULL
;

679 
”r
 = 0;

680 ià(!
h
) {

681 
	`SNDERR
("CªnÙ o³Àsh¬ed†ib¿ry % (%s)", 
lib
, 
”rbuf
);

682 
”r
 = -
ENOENT
;

683 } ià(!
İ’_func
) {

684 
	`SNDERR
("symbŞ % i nÙ defšed insid%s", 
İ’_Çme
, 
lib
);

685 
	`¢d_dlşo£
(
h
);

686 
”r
 = -
ENXIO
;

688 
_”r
:

689 ià(
ty³_cÚf
)

690 
	`¢d_cÚfig_d–‘e
(
ty³_cÚf
);

691 ià(! 
”r
) {

692 
”r
 = 
	`İ’_func
(
pcm
, 
Çme
, 
roÙ
, 
cÚf
);

693 ià(
”r
 < 0)

694 
	`¢d_dlşo£
(
h
);

696 
m‘”
->
dl_hªdË
 = 
h
;

698  
”r
;

699 
	}
}

758 
	$_¢d_pcm_m‘”_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

759 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

760 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

762 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

763 
”r
;

764 
¢d_pcm_t
 *
¥cm
;

765 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

766 
äequ’cy
 = -1;

767 
¢d_cÚfig_t
 *
scİes
 = 
NULL
;

768 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

769 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

770 cÚ¡ *
id
;

771 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

773 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

775 ià(
	`¡rcmp
(
id
, "slave") == 0) {

776 
¦ave
 = 
n
;

779 ià(
	`¡rcmp
(
id
, "frequency") == 0) {

780 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
äequ’cy
);

781 ià(
”r
 < 0) {

782 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

783  -
EINVAL
;

787 ià(
	`¡rcmp
(
id
, "scopes") == 0) {

788 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

789 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

790  -
EINVAL
;

792 
scİes
 = 
n
;

795 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

796  -
EINVAL
;

798 ià(!
¦ave
) {

799 
	`SNDERR
("slave is‚ot defined");

800  -
EINVAL
;

802 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 0);

803 ià(
”r
 < 0)

804  
”r
;

805 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

806 
	`¢d_cÚfig_d–‘e
(
scÚf
);

807 ià(
”r
 < 0)

808  
”r
;

809 
”r
 = 
	`¢d_pcm_m‘”_İ’
(
pcmp
, 
Çme
, 
äequ’cy
 > 0 ? (èäequ’cy : 
FREQUENCY
, 
¥cm
, 1);

810 ià(
”r
 < 0) {

811 
	`¢d_pcm_şo£
(
¥cm
);

812  
”r
;

814 ià(!
scİes
)

816 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
scİes
) {

817 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

818 cÚ¡ *
id
, *
¡r
;

819 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

821 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
) >= 0) {

822 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "pcm_scİe", 
¡r
, &
n
);

823 ià(
”r
 < 0) {

824 
	`SNDERR
("unknowÀpcm_scİ%s", 
¡r
);

826 
”r
 = 
	`¢d_pcm_m‘”_add_scİe_cÚf
(*
pcmp
, 
id
, 
roÙ
, 
n
);

827 
	`¢d_cÚfig_d–‘e
(
n
);

830 
”r
 = 
	`¢d_pcm_m‘”_add_scİe_cÚf
(*
pcmp
, 
id
, 
roÙ
, 
n
);

831 ià(
”r
 < 0) {

832 
	`¢d_pcm_şo£
(*
pcmp
);

833  
”r
;

837 
	}
}

838 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_m‘”_İ’
, 
SND_PCM_DLSYM_VERSION
);

848 
	$¢d_pcm_m‘”_add_scİe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_scİe_t
 *
scİe
)

850 
¢d_pcm_m‘”_t
 *
m‘”
;

851 
	`as£¹
(
pcm
->
ty³
 =ğ
SND_PCM_TYPE_METER
);

852 
m‘”
 = 
pcm
->
´iv©e_d©a
;

853 
	`li¡_add_
(&
scİe
->
li¡
, &
m‘”
->
scİes
);

855 
	}
}

863 
¢d_pcm_scİe_t
 *
	$¢d_pcm_m‘”_£¬ch_scİe
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
Çme
)

865 
¢d_pcm_m‘”_t
 *
m‘”
;

866 
li¡_h—d
 *
pos
;

867 
	`as£¹
(
pcm
->
ty³
 =ğ
SND_PCM_TYPE_METER
);

868 
m‘”
 = 
pcm
->
´iv©e_d©a
;

869 
	`li¡_fÜ_—ch
(
pos
, &
m‘”
->
scİes
) {

870 
¢d_pcm_scİe_t
 *
scİe
;

871 
scİe
 = 
	`li¡_’Œy
(
pos
, 
¢d_pcm_scİe_t
, 
li¡
);

872 ià(
scİe
->
Çme
 && 
	`¡rcmp
(scope->name,‚ame) == 0)

873  
scİe
;

875  
NULL
;

876 
	}
}

883 
¢d_pcm_uäames_t
 
	$¢d_pcm_m‘”_g‘_bufsize
(
¢d_pcm_t
 *
pcm
)

885 
¢d_pcm_m‘”_t
 *
m‘”
;

886 
	`as£¹
(
pcm
->
ty³
 =ğ
SND_PCM_TYPE_METER
);

887 
m‘”
 = 
pcm
->
´iv©e_d©a
;

888 
	`as£¹
(
m‘”
->
g’
.
¦ave
->
£tup
);

889  
m‘”
->
buf_size
;

890 
	}
}

897 
	$¢d_pcm_m‘”_g‘_chªÃls
(
¢d_pcm_t
 *
pcm
)

899 
¢d_pcm_m‘”_t
 *
m‘”
;

900 
	`as£¹
(
pcm
->
ty³
 =ğ
SND_PCM_TYPE_METER
);

901 
m‘”
 = 
pcm
->
´iv©e_d©a
;

902 
	`as£¹
(
m‘”
->
g’
.
¦ave
->
£tup
);

903  
m‘”
->
g’
.
¦ave
->
chªÃls
;

904 
	}
}

911 
	$¢d_pcm_m‘”_g‘_¿‹
(
¢d_pcm_t
 *
pcm
)

913 
¢d_pcm_m‘”_t
 *
m‘”
;

914 
	`as£¹
(
pcm
->
ty³
 =ğ
SND_PCM_TYPE_METER
);

915 
m‘”
 = 
pcm
->
´iv©e_d©a
;

916 
	`as£¹
(
m‘”
->
g’
.
¦ave
->
£tup
);

917  
m‘”
->
g’
.
¦ave
->
¿‹
;

918 
	}
}

925 
¢d_pcm_uäames_t
 
	$¢d_pcm_m‘”_g‘_now
(
¢d_pcm_t
 *
pcm
)

927 
¢d_pcm_m‘”_t
 *
m‘”
;

928 
	`as£¹
(
pcm
->
ty³
 =ğ
SND_PCM_TYPE_METER
);

929 
m‘”
 = 
pcm
->
´iv©e_d©a
;

930 
	`as£¹
(
m‘”
->
g’
.
¦ave
->
£tup
);

931  
m‘”
->
now
;

932 
	}
}

939 
¢d_pcm_uäames_t
 
	$¢d_pcm_m‘”_g‘_bound¬y
(
¢d_pcm_t
 *
pcm
)

941 
¢d_pcm_m‘”_t
 *
m‘”
;

942 
	`as£¹
(
pcm
->
ty³
 =ğ
SND_PCM_TYPE_METER
);

943 
m‘”
 = 
pcm
->
´iv©e_d©a
;

944 
	`as£¹
(
m‘”
->
g’
.
¦ave
->
£tup
);

945  
m‘”
->
g’
.
¦ave
->
bound¬y
;

946 
	}
}

953 
	$¢d_pcm_scİe_£t_Çme
(
¢d_pcm_scİe_t
 *
scİe
, cÚ¡ *
v®
)

955 
scİe
->
Çme
 = 
	`¡rdup
(
v®
);

956 
	}
}

963 cÚ¡ *
	$¢d_pcm_scİe_g‘_Çme
(
¢d_pcm_scİe_t
 *
scİe
)

965  
scİe
->
Çme
;

966 
	}
}

973 
	$¢d_pcm_scİe_£t_İs
(
¢d_pcm_scİe_t
 *
scİe
, cÚ¡ 
¢d_pcm_scİe_İs_t
 *
v®
)

975 
scİe
->
İs
 = 
v®
;

976 
	}
}

983 *
	$¢d_pcm_scİe_g‘_ÿÎback_´iv©e
(
¢d_pcm_scİe_t
 *
scİe
)

985  
scİe
->
´iv©e_d©a
;

986 
	}
}

993 
	$¢d_pcm_scİe_£t_ÿÎback_´iv©e
(
¢d_pcm_scİe_t
 *
scİe
, *
v®
)

995 
scİe
->
´iv©e_d©a
 = 
v®
;

996 
	}
}

998 #iâdeà
DOC_HIDDEN


999 
	s_¢d_pcm_scİe_s16
 {

1000 
¢d_pcm_t
 *
	mpcm
;

1001 
¢d_pcm_adpcm_¡©e_t
 *
	madpcm_¡©es
;

1002 
	mšdex
;

1003 
¢d_pcm_uäames_t
 
	mŞd
;

1004 
št16_t
 *
	mbuf
;

1005 
¢d_pcm_chªÃl_¬—_t
 *
	mbuf_¬—s
;

1006 } 
	t¢d_pcm_scİe_s16_t
;

1008 
	$s16_’abË
(
¢d_pcm_scİe_t
 *
scİe
)

1010 
¢d_pcm_scİe_s16_t
 *
s16
 = 
scİe
->
´iv©e_d©a
;

1011 
¢d_pcm_m‘”_t
 *
m‘”
 = 
s16
->
pcm
->
´iv©e_d©a
;

1012 
¢d_pcm_t
 *
¥cm
 = 
m‘”
->
g’
.
¦ave
;

1013 
¢d_pcm_chªÃl_¬—_t
 *
a
;

1014 
c
;

1015 
idx
;

1016 ià(
¥cm
->
fÜm©
 =ğ
SND_PCM_FORMAT_S16
 &&

1017 
¥cm
->
acûss
 =ğ
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
) {

1018 
s16
->
buf
 = (
št16_t
 *è
m‘”
->buf;

1019  -
EINVAL
;

1021 
¥cm
->
fÜm©
) {

1022 
SND_PCM_FORMAT_A_LAW
:

1023 
SND_PCM_FORMAT_MU_LAW
:

1024 
SND_PCM_FORMAT_IMA_ADPCM
:

1025 
idx
 = 
	`¢d_pcm_lš—r_put_šdex
(
SND_PCM_FORMAT_S16
, SND_PCM_FORMAT_S16);

1027 
SND_PCM_FORMAT_S8
:

1028 
SND_PCM_FORMAT_S16_LE
:

1029 
SND_PCM_FORMAT_S16_BE
:

1030 
SND_PCM_FORMAT_S24_LE
:

1031 
SND_PCM_FORMAT_S24_BE
:

1032 
SND_PCM_FORMAT_S32_LE
:

1033 
SND_PCM_FORMAT_S32_BE
:

1034 
SND_PCM_FORMAT_U8
:

1035 
SND_PCM_FORMAT_U16_LE
:

1036 
SND_PCM_FORMAT_U16_BE
:

1037 
SND_PCM_FORMAT_U24_LE
:

1038 
SND_PCM_FORMAT_U24_BE
:

1039 
SND_PCM_FORMAT_U32_LE
:

1040 
SND_PCM_FORMAT_U32_BE
:

1041 
idx
 = 
	`¢d_pcm_lš—r_cÚv”t_šdex
(
¥cm
->
fÜm©
, 
SND_PCM_FORMAT_S16
);

1044  -
EINVAL
;

1046 
s16
->
šdex
 = 
idx
;

1047 ià(
¥cm
->
fÜm©
 =ğ
SND_PCM_FORMAT_IMA_ADPCM
) {

1048 
s16
->
adpcm_¡©es
 = 
	`ÿÎoc
(
¥cm
->
chªÃls
, (*s16->adpcm_states));

1049 ià(!
s16
->
adpcm_¡©es
)

1050  -
ENOMEM
;

1052 
s16
->
buf
 = 
	`m®loc
(
m‘”
->
buf_size
 * 2 * 
¥cm
->
chªÃls
);

1053 ià(!
s16
->
buf
) {

1054 
	`ä“
(
s16
->
adpcm_¡©es
);

1055  -
ENOMEM
;

1057 
a
 = 
	`ÿÎoc
(
¥cm
->
chªÃls
, (*a));

1058 ià(!
a
) {

1059 
	`ä“
(
s16
->
buf
);

1060 
	`ä“
(
s16
->
adpcm_¡©es
);

1061  -
ENOMEM
;

1063 
s16
->
buf_¬—s
 = 
a
;

1064 
c
 = 0; c < 
¥cm
->
chªÃls
; c++, 
a
++) {

1065 
a
->
addr
 = 
s16
->
buf
 + 
c
 * 
m‘”
->
buf_size
;

1066 
a
->
fœ¡
 = 0;

1067 
a
->
¡•
 = 16;

1070 
	}
}

1072 
	$s16_di§bË
(
¢d_pcm_scİe_t
 *
scİe
)

1074 
¢d_pcm_scİe_s16_t
 *
s16
 = 
scİe
->
´iv©e_d©a
;

1075 
	`ä“
(
s16
->
adpcm_¡©es
);

1076 
s16
->
adpcm_¡©es
 = 
NULL
;

1077 
	`ä“
(
s16
->
buf
);

1078 
s16
->
buf
 = 
NULL
;

1079 
	`ä“
(
s16
->
buf_¬—s
);

1080 
s16
->
buf_¬—s
 = 0;

1081 
	}
}

1083 
	$s16_şo£
(
¢d_pcm_scİe_t
 *
scİe
)

1085 
¢d_pcm_scİe_s16_t
 *
s16
 = 
scİe
->
´iv©e_d©a
;

1086 
	`ä“
(
s16
);

1087 
	}
}

1089 
	$s16_¡¬t
(
¢d_pcm_scİe_t
 *
scİe
 
ATTRIBUTE_UNUSED
)

1091 
	}
}

1093 
	$s16_¡İ
(
¢d_pcm_scİe_t
 *
scİe
 
ATTRIBUTE_UNUSED
)

1095 
	}
}

1097 
	$s16_upd©e
(
¢d_pcm_scİe_t
 *
scİe
)

1099 
¢d_pcm_scİe_s16_t
 *
s16
 = 
scİe
->
´iv©e_d©a
;

1100 
¢d_pcm_m‘”_t
 *
m‘”
 = 
s16
->
pcm
->
´iv©e_d©a
;

1101 
¢d_pcm_t
 *
¥cm
 = 
m‘”
->
g’
.
¦ave
;

1102 
¢d_pcm_säames_t
 
size
;

1103 
¢d_pcm_uäames_t
 
off£t
;

1104 
size
 = 
m‘”
->
now
 - 
s16
->
Şd
;

1105 ià(
size
 < 0)

1106 
size
 +ğ
¥cm
->
bound¬y
;

1107 ià(
size
 > (
¢d_pcm_säames_t
)
s16
->
pcm
->
bufãr_size
)

1108 
size
 = 
s16
->
pcm
->
bufãr_size
;

1109 
off£t
 = 
s16
->
Şd
 % 
m‘”
->
buf_size
;

1110 
size
 > 0) {

1111 
¢d_pcm_uäames_t
 
äames
 = 
size
;

1112 
¢d_pcm_uäames_t
 
cÚt
 = 
m‘”
->
buf_size
 - 
off£t
;

1113 ià(
äames
 > 
cÚt
)

1114 
äames
 = 
cÚt
;

1115 
¥cm
->
fÜm©
) {

1116 
SND_PCM_FORMAT_A_LAW
:

1117 
	`¢d_pcm_®aw_decode
(
s16
->
buf_¬—s
, 
off£t
,

1118 
m‘”
->
buf_¬—s
, 
off£t
,

1119 
¥cm
->
chªÃls
, 
äames
,

1120 
s16
->
šdex
);

1122 
SND_PCM_FORMAT_MU_LAW
:

1123 
	`¢d_pcm_muÏw_decode
(
s16
->
buf_¬—s
, 
off£t
,

1124 
m‘”
->
buf_¬—s
, 
off£t
,

1125 
¥cm
->
chªÃls
, 
äames
,

1126 
s16
->
šdex
);

1128 
SND_PCM_FORMAT_IMA_ADPCM
:

1129 
	`¢d_pcm_adpcm_decode
(
s16
->
buf_¬—s
, 
off£t
,

1130 
m‘”
->
buf_¬—s
, 
off£t
,

1131 
¥cm
->
chªÃls
, 
äames
,

1132 
s16
->
šdex
,

1133 
s16
->
adpcm_¡©es
);

1136 
	`¢d_pcm_lš—r_cÚv”t
(
s16
->
buf_¬—s
, 
off£t
,

1137 
m‘”
->
buf_¬—s
, 
off£t
,

1138 
¥cm
->
chªÃls
, 
äames
,

1139 
s16
->
šdex
);

1142 ià(
äames
 =ğ
cÚt
)

1143 
off£t
 = 0;

1145 
off£t
 +ğ
äames
;

1146 
size
 -ğ
äames
;

1148 
s16
->
Şd
 = 
m‘”
->
now
;

1149 
	}
}

1151 
	$s16_»£t
(
¢d_pcm_scİe_t
 *
scİe
)

1153 
¢d_pcm_scİe_s16_t
 *
s16
 = 
scİe
->
´iv©e_d©a
;

1154 
¢d_pcm_m‘”_t
 *
m‘”
 = 
s16
->
pcm
->
´iv©e_d©a
;

1155 
s16
->
Şd
 = 
m‘”
->
now
;

1156 
	}
}

1158 cÚ¡ 
¢d_pcm_scİe_İs_t
 
	gs16_İs
 = {

1159 .
’abË
 = 
s16_’abË
,

1160 .
	gdi§bË
 = 
s16_di§bË
,

1161 .
	gşo£
 = 
s16_şo£
,

1162 .
	g¡¬t
 = 
s16_¡¬t
,

1163 .
	g¡İ
 = 
s16_¡İ
,

1164 .
	gupd©e
 = 
s16_upd©e
,

1165 .
	g»£t
 = 
s16_»£t
,

1181 
	$¢d_pcm_scİe_s16_İ’
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
Çme
,

1182 
¢d_pcm_scİe_t
 **
scİ•
)

1184 
¢d_pcm_m‘”_t
 *
m‘”
;

1185 
¢d_pcm_scİe_t
 *
scİe
;

1186 
¢d_pcm_scİe_s16_t
 *
s16
;

1187 
	`as£¹
(
pcm
->
ty³
 =ğ
SND_PCM_TYPE_METER
);

1188 
m‘”
 = 
pcm
->
´iv©e_d©a
;

1189 
scİe
 = 
	`ÿÎoc
(1, (*scope));

1190 ià(!
scİe
)

1191  -
ENOMEM
;

1192 
s16
 = 
	`ÿÎoc
(1, (*s16));

1193 ià(!
s16
) {

1194 
	`ä“
(
scİe
);

1195  -
ENOMEM
;

1197 ià(
Çme
)

1198 
scİe
->
Çme
 = 
	`¡rdup
(name);

1199 
s16
->
pcm
 =…cm;

1200 
scİe
->
İs
 = &
s16_İs
;

1201 
scİe
->
´iv©e_d©a
 = 
s16
;

1202 
	`li¡_add_
(&
scİe
->
li¡
, &
m‘”
->
scİes
);

1203 *
scİ•
 = 
scİe
;

1205 
	}
}

1213 
št16_t
 *
	$¢d_pcm_scİe_s16_g‘_chªÃl_bufãr
(
¢d_pcm_scİe_t
 *
scİe
,

1214 
chªÃl
)

1216 
¢d_pcm_scİe_s16_t
 *
s16
;

1217 
¢d_pcm_m‘”_t
 *
m‘”
;

1218 
	`as£¹
(
scİe
->
İs
 =ğ&
s16_İs
);

1219 
s16
 = 
scİe
->
´iv©e_d©a
;

1220 
m‘”
 = 
s16
->
pcm
->
´iv©e_d©a
;

1221 
	`as£¹
(
m‘”
->
g’
.
¦ave
->
£tup
);

1222 
	`as£¹
(
s16
->
buf_¬—s
);

1223 
	`as£¹
(
chªÃl
 < 
m‘”
->
g’
.
¦ave
->
chªÃls
);

1224  
s16
->
buf_¬—s
[
chªÃl
].
addr
;

1225 
	}
}

1232 
	$¢d_pcm_scİe_m®loc
(
¢d_pcm_scİe_t
 **
±r
)

1234 
	`as£¹
(
±r
);

1235 *
±r
 = 
	`ÿÎoc
(1, (
¢d_pcm_scİe_t
));

1236 ià(!*
±r
)

1237  -
ENOMEM
;

1239 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_misc.c

22 
	~"pcm_loÿl.h
"

23 
	~"bsw­.h
"

24 
	~<¡dio.h
>

25 
	~<¡dlib.h
>

26 
	~<uni¡d.h
>

27 
	~<¡ršg.h
>

35 
	$¢d_pcm_fÜm©_sigÃd
(
¢d_pcm_fÜm©_t
 
fÜm©
)

37 
fÜm©
) {

38 
SNDRV_PCM_FORMAT_S8
:

39 
SNDRV_PCM_FORMAT_S16_LE
:

40 
SNDRV_PCM_FORMAT_S16_BE
:

41 
SNDRV_PCM_FORMAT_S20_LE
:

42 
SNDRV_PCM_FORMAT_S20_BE
:

43 
SNDRV_PCM_FORMAT_S24_LE
:

44 
SNDRV_PCM_FORMAT_S24_BE
:

45 
SNDRV_PCM_FORMAT_S32_LE
:

46 
SNDRV_PCM_FORMAT_S32_BE
:

47 
SNDRV_PCM_FORMAT_S24_3LE
:

48 
SNDRV_PCM_FORMAT_S24_3BE
:

49 
SNDRV_PCM_FORMAT_S20_3LE
:

50 
SNDRV_PCM_FORMAT_S20_3BE
:

51 
SNDRV_PCM_FORMAT_S18_3LE
:

52 
SNDRV_PCM_FORMAT_S18_3BE
:

54 
SNDRV_PCM_FORMAT_U8
:

55 
SNDRV_PCM_FORMAT_U16_LE
:

56 
SNDRV_PCM_FORMAT_U16_BE
:

57 
SNDRV_PCM_FORMAT_U20_LE
:

58 
SNDRV_PCM_FORMAT_U20_BE
:

59 
SNDRV_PCM_FORMAT_U24_LE
:

60 
SNDRV_PCM_FORMAT_U24_BE
:

61 
SNDRV_PCM_FORMAT_U32_LE
:

62 
SNDRV_PCM_FORMAT_U32_BE
:

63 
SNDRV_PCM_FORMAT_U24_3LE
:

64 
SNDRV_PCM_FORMAT_U24_3BE
:

65 
SNDRV_PCM_FORMAT_U20_3LE
:

66 
SNDRV_PCM_FORMAT_U20_3BE
:

67 
SNDRV_PCM_FORMAT_U18_3LE
:

68 
SNDRV_PCM_FORMAT_U18_3BE
:

69 
SNDRV_PCM_FORMAT_DSD_U8
:

70 
SNDRV_PCM_FORMAT_DSD_U16_LE
:

71 
SNDRV_PCM_FORMAT_DSD_U32_LE
:

72 
SNDRV_PCM_FORMAT_DSD_U16_BE
:

73 
SNDRV_PCM_FORMAT_DSD_U32_BE
:

76  -
EINVAL
;

78 
	}
}

85 
	$¢d_pcm_fÜm©_unsigÃd
(
¢d_pcm_fÜm©_t
 
fÜm©
)

87 
v®
;

89 
v®
 = 
	`¢d_pcm_fÜm©_sigÃd
(
fÜm©
);

90 ià(
v®
 < 0)

91  
v®
;

92  !
v®
;

93 
	}
}

100 
	$¢d_pcm_fÜm©_lš—r
(
¢d_pcm_fÜm©_t
 
fÜm©
)

102  
	`¢d_pcm_fÜm©_sigÃd
(
fÜm©
) >= 0;

103 
	}
}

110 
	$¢d_pcm_fÜm©_æßt
(
¢d_pcm_fÜm©_t
 
fÜm©
)

112 
fÜm©
) {

113 
SNDRV_PCM_FORMAT_FLOAT_LE
:

114 
SNDRV_PCM_FORMAT_FLOAT_BE
:

115 
SNDRV_PCM_FORMAT_FLOAT64_LE
:

116 
SNDRV_PCM_FORMAT_FLOAT64_BE
:

121 
	}
}

128 
	$¢d_pcm_fÜm©_l™e_’dŸn
(
¢d_pcm_fÜm©_t
 
fÜm©
)

130 
fÜm©
) {

131 
SNDRV_PCM_FORMAT_S16_LE
:

132 
SNDRV_PCM_FORMAT_U16_LE
:

133 
SNDRV_PCM_FORMAT_S20_LE
:

134 
SNDRV_PCM_FORMAT_U20_LE
:

135 
SNDRV_PCM_FORMAT_S24_LE
:

136 
SNDRV_PCM_FORMAT_U24_LE
:

137 
SNDRV_PCM_FORMAT_S32_LE
:

138 
SNDRV_PCM_FORMAT_U32_LE
:

139 
SNDRV_PCM_FORMAT_FLOAT_LE
:

140 
SNDRV_PCM_FORMAT_FLOAT64_LE
:

141 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_LE
:

142 
SNDRV_PCM_FORMAT_S24_3LE
:

143 
SNDRV_PCM_FORMAT_S20_3LE
:

144 
SNDRV_PCM_FORMAT_S18_3LE
:

145 
SNDRV_PCM_FORMAT_U24_3LE
:

146 
SNDRV_PCM_FORMAT_U20_3LE
:

147 
SNDRV_PCM_FORMAT_U18_3LE
:

148 
SNDRV_PCM_FORMAT_DSD_U16_LE
:

149 
SNDRV_PCM_FORMAT_DSD_U32_LE
:

151 
SNDRV_PCM_FORMAT_S16_BE
:

152 
SNDRV_PCM_FORMAT_U16_BE
:

153 
SNDRV_PCM_FORMAT_S20_BE
:

154 
SNDRV_PCM_FORMAT_U20_BE
:

155 
SNDRV_PCM_FORMAT_S24_BE
:

156 
SNDRV_PCM_FORMAT_U24_BE
:

157 
SNDRV_PCM_FORMAT_S32_BE
:

158 
SNDRV_PCM_FORMAT_U32_BE
:

159 
SNDRV_PCM_FORMAT_FLOAT_BE
:

160 
SNDRV_PCM_FORMAT_FLOAT64_BE
:

161 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_BE
:

162 
SNDRV_PCM_FORMAT_S24_3BE
:

163 
SNDRV_PCM_FORMAT_S20_3BE
:

164 
SNDRV_PCM_FORMAT_S18_3BE
:

165 
SNDRV_PCM_FORMAT_U24_3BE
:

166 
SNDRV_PCM_FORMAT_U20_3BE
:

167 
SNDRV_PCM_FORMAT_U18_3BE
:

168 
SNDRV_PCM_FORMAT_DSD_U16_BE
:

169 
SNDRV_PCM_FORMAT_DSD_U32_BE
:

172  -
EINVAL
;

174 
	}
}

181 
	$¢d_pcm_fÜm©_big_’dŸn
(
¢d_pcm_fÜm©_t
 
fÜm©
)

183 
v®
;

185 
v®
 = 
	`¢d_pcm_fÜm©_l™e_’dŸn
(
fÜm©
);

186 ià(
v®
 < 0)

187  
v®
;

188  !
v®
;

189 
	}
}

196 
	$¢d_pcm_fÜm©_ıu_’dŸn
(
¢d_pcm_fÜm©_t
 
fÜm©
)

198 #ifdeà
SNDRV_LITTLE_ENDIAN


199  
	`¢d_pcm_fÜm©_l™e_’dŸn
(
fÜm©
);

201  
	`¢d_pcm_fÜm©_big_’dŸn
(
fÜm©
);

203 
	}
}

210 
	$¢d_pcm_fÜm©_width
(
¢d_pcm_fÜm©_t
 
fÜm©
)

212 
fÜm©
) {

213 
SNDRV_PCM_FORMAT_S8
:

214 
SNDRV_PCM_FORMAT_U8
:

215 
SNDRV_PCM_FORMAT_DSD_U8
:

217 
SNDRV_PCM_FORMAT_S16_LE
:

218 
SNDRV_PCM_FORMAT_S16_BE
:

219 
SNDRV_PCM_FORMAT_U16_LE
:

220 
SNDRV_PCM_FORMAT_U16_BE
:

221 
SNDRV_PCM_FORMAT_DSD_U16_LE
:

222 
SNDRV_PCM_FORMAT_DSD_U16_BE
:

224 
SNDRV_PCM_FORMAT_S18_3LE
:

225 
SNDRV_PCM_FORMAT_S18_3BE
:

226 
SNDRV_PCM_FORMAT_U18_3LE
:

227 
SNDRV_PCM_FORMAT_U18_3BE
:

229 
SNDRV_PCM_FORMAT_S20_LE
:

230 
SNDRV_PCM_FORMAT_S20_BE
:

231 
SNDRV_PCM_FORMAT_U20_LE
:

232 
SNDRV_PCM_FORMAT_U20_BE
:

233 
SNDRV_PCM_FORMAT_S20_3LE
:

234 
SNDRV_PCM_FORMAT_S20_3BE
:

235 
SNDRV_PCM_FORMAT_U20_3LE
:

236 
SNDRV_PCM_FORMAT_U20_3BE
:

238 
SNDRV_PCM_FORMAT_S24_LE
:

239 
SNDRV_PCM_FORMAT_S24_BE
:

240 
SNDRV_PCM_FORMAT_U24_LE
:

241 
SNDRV_PCM_FORMAT_U24_BE
:

242 
SNDRV_PCM_FORMAT_S24_3LE
:

243 
SNDRV_PCM_FORMAT_S24_3BE
:

244 
SNDRV_PCM_FORMAT_U24_3LE
:

245 
SNDRV_PCM_FORMAT_U24_3BE
:

247 
SNDRV_PCM_FORMAT_S32_LE
:

248 
SNDRV_PCM_FORMAT_S32_BE
:

249 
SNDRV_PCM_FORMAT_U32_LE
:

250 
SNDRV_PCM_FORMAT_U32_BE
:

251 
SNDRV_PCM_FORMAT_FLOAT_LE
:

252 
SNDRV_PCM_FORMAT_FLOAT_BE
:

253 
SNDRV_PCM_FORMAT_DSD_U32_LE
:

254 
SNDRV_PCM_FORMAT_DSD_U32_BE
:

256 
SNDRV_PCM_FORMAT_FLOAT64_LE
:

257 
SNDRV_PCM_FORMAT_FLOAT64_BE
:

259 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_LE
:

260 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_BE
:

262 
SNDRV_PCM_FORMAT_MU_LAW
:

263 
SNDRV_PCM_FORMAT_A_LAW
:

265 
SNDRV_PCM_FORMAT_IMA_ADPCM
:

268  -
EINVAL
;

270 
	}
}

277 
	$¢d_pcm_fÜm©_physiÿl_width
(
¢d_pcm_fÜm©_t
 
fÜm©
)

279 
fÜm©
) {

280 
SNDRV_PCM_FORMAT_S8
:

281 
SNDRV_PCM_FORMAT_U8
:

282 
SNDRV_PCM_FORMAT_DSD_U8
:

284 
SNDRV_PCM_FORMAT_S16_LE
:

285 
SNDRV_PCM_FORMAT_S16_BE
:

286 
SNDRV_PCM_FORMAT_U16_LE
:

287 
SNDRV_PCM_FORMAT_U16_BE
:

288 
SNDRV_PCM_FORMAT_DSD_U16_LE
:

289 
SNDRV_PCM_FORMAT_DSD_U16_BE
:

291 
SNDRV_PCM_FORMAT_S18_3LE
:

292 
SNDRV_PCM_FORMAT_S18_3BE
:

293 
SNDRV_PCM_FORMAT_U18_3LE
:

294 
SNDRV_PCM_FORMAT_U18_3BE
:

295 
SNDRV_PCM_FORMAT_S20_3LE
:

296 
SNDRV_PCM_FORMAT_S20_3BE
:

297 
SNDRV_PCM_FORMAT_U20_3LE
:

298 
SNDRV_PCM_FORMAT_U20_3BE
:

299 
SNDRV_PCM_FORMAT_S24_3LE
:

300 
SNDRV_PCM_FORMAT_S24_3BE
:

301 
SNDRV_PCM_FORMAT_U24_3LE
:

302 
SNDRV_PCM_FORMAT_U24_3BE
:

304 
SNDRV_PCM_FORMAT_S20_LE
:

305 
SNDRV_PCM_FORMAT_S20_BE
:

306 
SNDRV_PCM_FORMAT_U20_LE
:

307 
SNDRV_PCM_FORMAT_U20_BE
:

308 
SNDRV_PCM_FORMAT_S24_LE
:

309 
SNDRV_PCM_FORMAT_S24_BE
:

310 
SNDRV_PCM_FORMAT_U24_LE
:

311 
SNDRV_PCM_FORMAT_U24_BE
:

312 
SNDRV_PCM_FORMAT_S32_LE
:

313 
SNDRV_PCM_FORMAT_S32_BE
:

314 
SNDRV_PCM_FORMAT_U32_LE
:

315 
SNDRV_PCM_FORMAT_U32_BE
:

316 
SNDRV_PCM_FORMAT_FLOAT_LE
:

317 
SNDRV_PCM_FORMAT_FLOAT_BE
:

318 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_LE
:

319 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_BE
:

320 
SNDRV_PCM_FORMAT_DSD_U32_LE
:

321 
SNDRV_PCM_FORMAT_DSD_U32_BE
:

323 
SNDRV_PCM_FORMAT_FLOAT64_LE
:

324 
SNDRV_PCM_FORMAT_FLOAT64_BE
:

326 
SNDRV_PCM_FORMAT_MU_LAW
:

327 
SNDRV_PCM_FORMAT_A_LAW
:

329 
SNDRV_PCM_FORMAT_IMA_ADPCM
:

332  -
EINVAL
;

334 
	}
}

342 
ssize_t
 
	$¢d_pcm_fÜm©_size
(
¢d_pcm_fÜm©_t
 
fÜm©
, 
size_t
 
§m¶es
)

344 
fÜm©
) {

345 
SNDRV_PCM_FORMAT_S8
:

346 
SNDRV_PCM_FORMAT_U8
:

347 
SNDRV_PCM_FORMAT_DSD_U8
:

348  
§m¶es
;

349 
SNDRV_PCM_FORMAT_S16_LE
:

350 
SNDRV_PCM_FORMAT_S16_BE
:

351 
SNDRV_PCM_FORMAT_U16_LE
:

352 
SNDRV_PCM_FORMAT_U16_BE
:

353 
SNDRV_PCM_FORMAT_DSD_U16_LE
:

354 
SNDRV_PCM_FORMAT_DSD_U16_BE
:

355  
§m¶es
 * 2;

356 
SNDRV_PCM_FORMAT_S18_3LE
:

357 
SNDRV_PCM_FORMAT_S18_3BE
:

358 
SNDRV_PCM_FORMAT_U18_3LE
:

359 
SNDRV_PCM_FORMAT_U18_3BE
:

360 
SNDRV_PCM_FORMAT_S20_3LE
:

361 
SNDRV_PCM_FORMAT_S20_3BE
:

362 
SNDRV_PCM_FORMAT_U20_3LE
:

363 
SNDRV_PCM_FORMAT_U20_3BE
:

364 
SNDRV_PCM_FORMAT_S24_3LE
:

365 
SNDRV_PCM_FORMAT_S24_3BE
:

366 
SNDRV_PCM_FORMAT_U24_3LE
:

367 
SNDRV_PCM_FORMAT_U24_3BE
:

368  
§m¶es
 * 3;

369 
SNDRV_PCM_FORMAT_S20_LE
:

370 
SNDRV_PCM_FORMAT_S20_BE
:

371 
SNDRV_PCM_FORMAT_U20_LE
:

372 
SNDRV_PCM_FORMAT_U20_BE
:

373 
SNDRV_PCM_FORMAT_S24_LE
:

374 
SNDRV_PCM_FORMAT_S24_BE
:

375 
SNDRV_PCM_FORMAT_U24_LE
:

376 
SNDRV_PCM_FORMAT_U24_BE
:

377 
SNDRV_PCM_FORMAT_S32_LE
:

378 
SNDRV_PCM_FORMAT_S32_BE
:

379 
SNDRV_PCM_FORMAT_U32_LE
:

380 
SNDRV_PCM_FORMAT_U32_BE
:

381 
SNDRV_PCM_FORMAT_FLOAT_LE
:

382 
SNDRV_PCM_FORMAT_FLOAT_BE
:

383 
SNDRV_PCM_FORMAT_DSD_U32_LE
:

384 
SNDRV_PCM_FORMAT_DSD_U32_BE
:

385  
§m¶es
 * 4;

386 
SNDRV_PCM_FORMAT_FLOAT64_LE
:

387 
SNDRV_PCM_FORMAT_FLOAT64_BE
:

388  
§m¶es
 * 8;

389 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_LE
:

390 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_BE
:

391  
§m¶es
 * 4;

392 
SNDRV_PCM_FORMAT_MU_LAW
:

393 
SNDRV_PCM_FORMAT_A_LAW
:

394  
§m¶es
;

395 
SNDRV_PCM_FORMAT_IMA_ADPCM
:

396 ià(
§m¶es
 & 1)

397  -
EINVAL
;

398  
§m¶es
 / 2;

400 
	`as£¹
(0);

401  -
EINVAL
;

403 
	}
}

410 
ušt64_t
 
	$¢d_pcm_fÜm©_s’û_64
(
¢d_pcm_fÜm©_t
 
fÜm©
)

412 
fÜm©
) {

413 
SNDRV_PCM_FORMAT_S8
:

414 
SNDRV_PCM_FORMAT_S16_LE
:

415 
SNDRV_PCM_FORMAT_S16_BE
:

416 
SNDRV_PCM_FORMAT_S20_LE
:

417 
SNDRV_PCM_FORMAT_S20_BE
:

418 
SNDRV_PCM_FORMAT_S24_LE
:

419 
SNDRV_PCM_FORMAT_S24_BE
:

420 
SNDRV_PCM_FORMAT_S32_LE
:

421 
SNDRV_PCM_FORMAT_S32_BE
:

422 
SNDRV_PCM_FORMAT_S24_3LE
:

423 
SNDRV_PCM_FORMAT_S24_3BE
:

424 
SNDRV_PCM_FORMAT_S20_3LE
:

425 
SNDRV_PCM_FORMAT_S20_3BE
:

426 
SNDRV_PCM_FORMAT_S18_3LE
:

427 
SNDRV_PCM_FORMAT_S18_3BE
:

429 
SNDRV_PCM_FORMAT_U8
:

431 
SNDRV_PCM_FORMAT_DSD_U8
:

432 
SNDRV_PCM_FORMAT_DSD_U16_LE
:

433 
SNDRV_PCM_FORMAT_DSD_U32_LE
:

434 
SNDRV_PCM_FORMAT_DSD_U16_BE
:

435 
SNDRV_PCM_FORMAT_DSD_U32_BE
:

437 #ifdeà
SNDRV_LITTLE_ENDIAN


438 
SNDRV_PCM_FORMAT_U16_LE
:

440 
SNDRV_PCM_FORMAT_U20_LE
:

442 
SNDRV_PCM_FORMAT_U24_LE
:

444 
SNDRV_PCM_FORMAT_U32_LE
:

446 
SNDRV_PCM_FORMAT_U16_BE
:

448 
SNDRV_PCM_FORMAT_U20_BE
:

450 
SNDRV_PCM_FORMAT_U24_BE
:

452 
SNDRV_PCM_FORMAT_U32_BE
:

454 
SNDRV_PCM_FORMAT_U24_3LE
:

456 
SNDRV_PCM_FORMAT_U24_3BE
:

458 
SNDRV_PCM_FORMAT_U20_3LE
:

460 
SNDRV_PCM_FORMAT_U20_3BE
:

462 
SNDRV_PCM_FORMAT_U18_3LE
:

464 
SNDRV_PCM_FORMAT_U18_3BE
:

467 
SNDRV_PCM_FORMAT_U16_LE
:

469 
SNDRV_PCM_FORMAT_U20_LE
:

471 
SNDRV_PCM_FORMAT_U24_LE
:

473 
SNDRV_PCM_FORMAT_U32_LE
:

475 
SNDRV_PCM_FORMAT_U16_BE
:

477 
SNDRV_PCM_FORMAT_U20_BE
:

479 
SNDRV_PCM_FORMAT_U24_BE
:

481 
SNDRV_PCM_FORMAT_U32_BE
:

483 
SNDRV_PCM_FORMAT_U24_3LE
:

485 
SNDRV_PCM_FORMAT_U24_3BE
:

487 
SNDRV_PCM_FORMAT_U20_3LE
:

489 
SNDRV_PCM_FORMAT_U20_3BE
:

491 
SNDRV_PCM_FORMAT_U18_3LE
:

493 
SNDRV_PCM_FORMAT_U18_3BE
:

496 
SNDRV_PCM_FORMAT_FLOAT_LE
:

499 
f
[2];

500 
ušt64_t
 
i
;

501 } 
u
;

502 
u
.
f
[0] = u.f[1] = 0.0;

503 #ifdeà
SNDRV_LITTLE_ENDIAN


504  
u
.
i
;

506  
	`bsw­_64
(
u
.
i
);

509 
SNDRV_PCM_FORMAT_FLOAT64_LE
:

512 
f
;

513 
ušt64_t
 
i
;

514 } 
u
;

515 
u
.
f
 = 0.0;

516 #ifdeà
SNDRV_LITTLE_ENDIAN


517  
u
.
i
;

519  
	`bsw­_64
(
u
.
i
);

522 
SNDRV_PCM_FORMAT_FLOAT_BE
:

525 
f
[2];

526 
ušt64_t
 
i
;

527 } 
u
;

528 
u
.
f
[0] = u.f[1] = 0.0;

529 #ifdeà
SNDRV_LITTLE_ENDIAN


530  
	`bsw­_64
(
u
.
i
);

532  
u
.
i
;

535 
SNDRV_PCM_FORMAT_FLOAT64_BE
:

538 
f
;

539 
ušt64_t
 
i
;

540 } 
u
;

541 
u
.
f
 = 0.0;

542 #ifdeà
SNDRV_LITTLE_ENDIAN


543  
	`bsw­_64
(
u
.
i
);

545  
u
.
i
;

548 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_LE
:

549 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_BE
:

551 
SNDRV_PCM_FORMAT_MU_LAW
:

553 
SNDRV_PCM_FORMAT_A_LAW
:

555 
SNDRV_PCM_FORMAT_IMA_ADPCM
:

556 
SNDRV_PCM_FORMAT_MPEG
:

557 
SNDRV_PCM_FORMAT_GSM
:

558 
SNDRV_PCM_FORMAT_SPECIAL
:

561 
	`as£¹
(0);

565 
	}
}

572 
ušt32_t
 
	$¢d_pcm_fÜm©_s’û_32
(
¢d_pcm_fÜm©_t
 
fÜm©
)

574 
	`as£¹
(
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
) <= 32);

575  (
ušt32_t
)
	`¢d_pcm_fÜm©_s’û_64
(
fÜm©
);

576 
	}
}

583 
ušt16_t
 
	$¢d_pcm_fÜm©_s’û_16
(
¢d_pcm_fÜm©_t
 
fÜm©
)

585 
	`as£¹
(
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
) <= 16);

586  (
ušt16_t
)
	`¢d_pcm_fÜm©_s’û_64
(
fÜm©
);

587 
	}
}

594 
ušt8_t
 
	$¢d_pcm_fÜm©_s’û
(
¢d_pcm_fÜm©_t
 
fÜm©
)

596 
	`as£¹
(
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
) <= 8);

597  (
ušt8_t
)
	`¢d_pcm_fÜm©_s’û_64
(
fÜm©
);

598 
	}
}

607 
	$¢d_pcm_fÜm©_£t_s’û
(
¢d_pcm_fÜm©_t
 
fÜm©
, *
d©a
, 
§m¶es
)

609 ià(
§m¶es
 == 0)

611 
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
)) {

613 
ušt8_t
 
s’û
 = 
	`¢d_pcm_fÜm©_s’û_64
(
fÜm©
);

614 
§m¶es1
;

615 ià(
§m¶es
 % 2 != 0)

616  -
EINVAL
;

617 
§m¶es1
 = 
§m¶es
 / 2;

618 
	`mem£t
(
d©a
, 
s’û
, 
§m¶es1
);

622 
ušt8_t
 
s’û
 = 
	`¢d_pcm_fÜm©_s’û_64
(
fÜm©
);

623 
	`mem£t
(
d©a
, 
s’û
, 
§m¶es
);

627 
ušt16_t
 
s’û
 = 
	`¢d_pcm_fÜm©_s’û_64
(
fÜm©
);

628 
ušt16_t
 *
pd©a
 = (ušt16_ˆ*)
d©a
;

629 ià(! 
s’û
)

630 
	`mem£t
(
d©a
, 0, 
§m¶es
 * 2);

632 
§m¶es
-- > 0)

633 *
pd©a
++ = 
s’û
;

638 
ušt32_t
 
s’û
 = 
	`¢d_pcm_fÜm©_s’û_64
(
fÜm©
);

639 
ušt8_t
 *
pd©a
 = (ušt8_ˆ*)
d©a
;

640 ià(! 
s’û
)

641 
	`mem£t
(
d©a
, 0, 
§m¶es
 * 3);

643 
§m¶es
-- > 0) {

644 #ifdeà
SNDRV_LITTLE_ENDIAN


645 *
pd©a
++ = 
s’û
 >> 0;

646 *
pd©a
++ = 
s’û
 >> 8;

647 *
pd©a
++ = 
s’û
 >> 16;

649 *
pd©a
++ = 
s’û
 >> 16;

650 *
pd©a
++ = 
s’û
 >> 8;

651 *
pd©a
++ = 
s’û
 >> 0;

658 
ušt32_t
 
s’û
 = 
	`¢d_pcm_fÜm©_s’û_64
(
fÜm©
);

659 
ušt32_t
 *
pd©a
 = (ušt32_ˆ*)
d©a
;

660 ià(! 
s’û
)

661 
	`mem£t
(
d©a
, 0, 
§m¶es
 * 4);

663 
§m¶es
-- > 0)

664 *
pd©a
++ = 
s’û
;

669 
ušt64_t
 
s’û
 = 
	`¢d_pcm_fÜm©_s’û_64
(
fÜm©
);

670 
ušt64_t
 *
pd©a
 = (ušt64_ˆ*)
d©a
;

671 ià(! 
s’û
)

672 
	`mem£t
(
d©a
, 0, 
§m¶es
 * 8);

674 
§m¶es
-- > 0)

675 *
pd©a
++ = 
s’û
;

680 
	`as£¹
(0);

681  -
EINVAL
;

684 
	}
}

686 cÚ¡ 
	glš—r_fÜm©s
[5][2][2] = {

687 { { 
SNDRV_PCM_FORMAT_S8
, SNDRV_PCM_FORMAT_S8 },

688 { 
SNDRV_PCM_FORMAT_U8
, SNDRV_PCM_FORMAT_U8 } },

689 { { 
SNDRV_PCM_FORMAT_S16_LE
, 
SNDRV_PCM_FORMAT_S16_BE
 },

690 { 
SNDRV_PCM_FORMAT_U16_LE
, 
SNDRV_PCM_FORMAT_U16_BE
 } },

691 { { 
SNDRV_PCM_FORMAT_S20_LE
, 
SNDRV_PCM_FORMAT_S20_BE
 },

692 { 
SNDRV_PCM_FORMAT_U20_LE
, 
SNDRV_PCM_FORMAT_U20_BE
 } },

693 { { 
SNDRV_PCM_FORMAT_S24_LE
, 
SNDRV_PCM_FORMAT_S24_BE
 },

694 { 
SNDRV_PCM_FORMAT_U24_LE
, 
SNDRV_PCM_FORMAT_U24_BE
 } },

695 { { 
SNDRV_PCM_FORMAT_S32_LE
, 
SNDRV_PCM_FORMAT_S32_BE
 },

696 { 
SNDRV_PCM_FORMAT_U32_LE
, 
SNDRV_PCM_FORMAT_U32_BE
 } }

699 cÚ¡ 
	glš—r24_fÜm©s
[3][2][2] = {

700 { { 
SNDRV_PCM_FORMAT_S24_3LE
, 
SNDRV_PCM_FORMAT_S24_3BE
 },

701 { 
SNDRV_PCM_FORMAT_U24_3LE
, 
SNDRV_PCM_FORMAT_U24_3BE
 } },

702 { { 
SNDRV_PCM_FORMAT_S20_3LE
, 
SNDRV_PCM_FORMAT_S20_3BE
 },

703 { 
SNDRV_PCM_FORMAT_U20_3LE
, 
SNDRV_PCM_FORMAT_U20_3BE
 } },

704 { { 
SNDRV_PCM_FORMAT_S18_3LE
, 
SNDRV_PCM_FORMAT_S18_3BE
 },

705 { 
SNDRV_PCM_FORMAT_U18_3LE
, 
SNDRV_PCM_FORMAT_U18_3BE
 } },

716 
¢d_pcm_fÜm©_t
 
	$¢d_pcm_bud_lš—r_fÜm©
(
width
, 
pwidth
, 
unsignd
, 
big_’dŸn
)

718 ià(
pwidth
 == 24) {

719 
width
) {

721 
width
 = 0;

724 
width
 = 1;

727 
width
 = 2;

730  
SND_PCM_FORMAT_UNKNOWN
;

732  
lš—r24_fÜm©s
[
width
][!!
unsignd
][!!
big_’dŸn
];

734 
width
) {

736 
width
 = 0;

739 
width
 = 1;

742 
width
 = 2;

745 
width
 = 3;

748 
width
 = 4;

751  
SND_PCM_FORMAT_UNKNOWN
;

753  
lš—r_fÜm©s
[
width
][!!
unsignd
][!!
big_’dŸn
];

755 
	}
}

773 
	$¢d_pcm_·r£_cÚŒŞ_id
(
¢d_cÚfig_t
 *
cÚf
, 
¢d_ùl_–em_id_t
 *
ùl_id
, *
ÿrdp
,

774 *
cchªÃl¥
, *
hwùÍ
)

776 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

777 
içû
 = 
SND_CTL_ELEM_IFACE_MIXER
;

778 cÚ¡ *
Çme
 = 
NULL
;

779 
šdex
 = 0;

780 
deviû
 = -1;

781 
subdeviû
 = -1;

782 
”r
;

784 
	`as£¹
(
ùl_id
 && 
ÿrdp
);

786 *
ÿrdp
 = -1;

787 ià(
cchªÃl¥
)

788 *
cchªÃl¥
 = 2;

789 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

790 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

791 cÚ¡ *
id
;

792 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

794 ià(
	`¡rcmp
(
id
, "comment") == 0)

796 ià(
	`¡rcmp
(
id
, "card") == 0) {

797 
”r
 = 
	`¢d_cÚfig_g‘_ÿrd
(
n
);

798 ià(
”r
 < 0)

799 
_”r
;

800 *
ÿrdp
 = 
”r
;

803 ià(
	`¡rcmp
(
id
, "iface") == 0 || strcmp(id, "interface") == 0) {

804 cÚ¡ *
±r
;

805 ià((
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
±r
)) < 0) {

806 
	`SNDERR
("f›ld % i nÙ‡ sŒšg", 
id
);

807 
_”r
;

809 ià((
”r
 = 
	`¢d_cÚfig_g‘_ùl_içû_ascii
(
±r
)) < 0) {

810 
	`SNDERR
("Inv®id v®ufÜ '%s'", 
id
);

811 
_”r
;

813 
içû
 = 
”r
;

816 ià(
	`¡rcmp
(
id
, "name") == 0) {

817 ià((
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
Çme
)) < 0) {

818 
	`SNDERR
("f›ld % i nÙ‡ sŒšg", 
id
);

819 
_”r
;

823 ià(
	`¡rcmp
(
id
, "index") == 0) {

824 ià((
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
šdex
)) < 0) {

825 
	`SNDERR
("f›ld % i nÙ‡Àš‹g”", 
id
);

826 
_”r
;

830 ià(
	`¡rcmp
(
id
, "device") == 0) {

831 ià((
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
deviû
)) < 0) {

832 
	`SNDERR
("f›ld % i nÙ‡Àš‹g”", 
id
);

833 
_”r
;

837 ià(
	`¡rcmp
(
id
, "subdevice") == 0) {

838 ià((
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
subdeviû
)) < 0) {

839 
	`SNDERR
("f›ld % i nÙ‡Àš‹g”", 
id
);

840 
_”r
;

844 ià(
cchªÃl¥
 && 
	`¡rcmp
(
id
, "count") == 0) {

845 
v
;

846 ià((
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v
)) < 0) {

847 
	`SNDERR
("f›ld % i nÙ‡Àš‹g”", 
id
);

848 
_”r
;

850 ià(
v
 < 1 || v > 2) {

851 
	`SNDERR
("Inv®id couÁ %ld", 
v
);

852 
_”r
;

854 *
cchªÃl¥
 = 
v
;

857 ià(
hwùÍ
 && 
	`¡rcmp
(
id
, "hwctl") == 0) {

858 ià((
”r
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
)) < 0) {

859 
	`SNDERR
("Thf›ld % mu¡ b¨boŞ—Àty³", 
id
);

860  
”r
;

862 *
hwùÍ
 = 
”r
;

865 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

866  -
EINVAL
;

868 ià(
Çme
 =ğ
NULL
) {

869 
	`SNDERR
("Missing control‚ame");

870 
”r
 = -
EINVAL
;

871 
_”r
;

873 ià(
deviû
 < 0)

874 
deviû
 = 0;

875 ià(
subdeviû
 < 0)

876 
subdeviû
 = 0;

878 
	`¢d_ùl_–em_id_£t_š‹rçû
(
ùl_id
, 
içû
);

879 
	`¢d_ùl_–em_id_£t_Çme
(
ùl_id
, 
Çme
);

880 
	`¢d_ùl_–em_id_£t_šdex
(
ùl_id
, 
šdex
);

881 
	`¢d_ùl_–em_id_£t_deviû
(
ùl_id
, 
deviû
);

882 
	`¢d_ùl_–em_id_£t_subdeviû
(
ùl_id
, 
subdeviû
);

886 
_”r
:

887  
”r
;

888 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_mmap.c

21 
	~"pcm_loÿl.h
"

22 
	~<¡dio.h
>

23 #ià
HAVE_MALLOC_H


24 
	~<m®loc.h
>

26 
	~<¡ršg.h
>

27 
	~<pŞl.h
>

28 
	~<sys/mmª.h
>

29 #ifdeà
HAVE_SYS_SHM_H


30 
	~<sys/shm.h
>

33 
	$¢d_pcm_mm­_­¶_backw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

35 
¢d_pcm_säames_t
 
­¶_±r
 = *
pcm
->
­¶
.
±r
;

36 
­¶_±r
 -ğ
äames
;

37 ià(
­¶_±r
 < 0)

38 
­¶_±r
 +ğ
pcm
->
bound¬y
;

39 *
pcm
->
­¶
.
±r
 = 
­¶_±r
;

40 
	}
}

42 
	$¢d_pcm_mm­_­¶_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

44 
¢d_pcm_uäames_t
 
­¶_±r
 = *
pcm
->
­¶
.
±r
;

45 
­¶_±r
 +ğ
äames
;

46 ià(
­¶_±r
 >ğ
pcm
->
bound¬y
)

47 
­¶_±r
 -ğ
pcm
->
bound¬y
;

48 *
pcm
->
­¶
.
±r
 = 
­¶_±r
;

49 
	}
}

51 
	$¢d_pcm_mm­_hw_backw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

53 
¢d_pcm_säames_t
 
hw_±r
 = *
pcm
->
hw
.
±r
;

54 
hw_±r
 -ğ
äames
;

55 ià(
hw_±r
 < 0)

56 
hw_±r
 +ğ
pcm
->
bound¬y
;

57 *
pcm
->
hw
.
±r
 = 
hw_±r
;

58 
	}
}

60 
	$¢d_pcm_mm­_hw_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

62 
¢d_pcm_uäames_t
 
hw_±r
 = *
pcm
->
hw
.
±r
;

63 
hw_±r
 +ğ
äames
;

64 ià(
hw_±r
 >ğ
pcm
->
bound¬y
)

65 
hw_±r
 -ğ
pcm
->
bound¬y
;

66 *
pcm
->
hw
.
±r
 = 
hw_±r
;

67 
	}
}

69 
¢d_pcm_säames_t
 
	$¢d_pcm_mm­_wr™e_¬—s
(
¢d_pcm_t
 *
pcm
,

70 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

71 
¢d_pcm_uäames_t
 
off£t
,

72 
¢d_pcm_uäames_t
 
size
)

74 
¢d_pcm_uäames_t
 
xãr
 = 0;

76 ià(
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
è< 
size
) {

77 
	`SNDMSG
("toØshÜˆava %ldØsiz%ld", 
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
), 
size
);

78  -
EPIPE
;

80 
size
 > 0) {

81 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
pcm_¬—s
;

82 
¢d_pcm_uäames_t
 
pcm_off£t
;

83 
¢d_pcm_uäames_t
 
äames
 = 
size
;

84 
¢d_pcm_säames_t
 
»suÉ
;

86 
	`__¢d_pcm_mm­_begš
(
pcm
, &
pcm_¬—s
, &
pcm_off£t
, &
äames
);

87 
	`¢d_pcm_¬—s_cİy
(
pcm_¬—s
, 
pcm_off£t
,

88 
¬—s
, 
off£t
,

89 
pcm
->
chªÃls
,

90 
äames
, 
pcm
->
fÜm©
);

91 
»suÉ
 = 
	`__¢d_pcm_mm­_comm™
(
pcm
, 
pcm_off£t
, 
äames
);

92 ià(
»suÉ
 < 0)

93  
xãr
 > 0 ? (
¢d_pcm_säames_t
)xã¸: 
»suÉ
;

94 
off£t
 +ğ
»suÉ
;

95 
xãr
 +ğ
»suÉ
;

96 
size
 -ğ
»suÉ
;

98  (
¢d_pcm_säames_t
)
xãr
;

99 
	}
}

101 
¢d_pcm_säames_t
 
	$¢d_pcm_mm­_»ad_¬—s
(
¢d_pcm_t
 *
pcm
,

102 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

103 
¢d_pcm_uäames_t
 
off£t
,

104 
¢d_pcm_uäames_t
 
size
)

106 
¢d_pcm_uäames_t
 
xãr
 = 0;

108 ià(
	`¢d_pcm_mm­_ÿ±u»_ava
(
pcm
è< 
size
) {

109 
	`SNDMSG
("toØshÜˆava %ldØsiz%ld", 
	`¢d_pcm_mm­_ÿ±u»_ava
(
pcm
), 
size
);

110  -
EPIPE
;

112 
size
 > 0) {

113 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
pcm_¬—s
;

114 
¢d_pcm_uäames_t
 
pcm_off£t
;

115 
¢d_pcm_uäames_t
 
äames
 = 
size
;

116 
¢d_pcm_säames_t
 
»suÉ
;

118 
	`__¢d_pcm_mm­_begš
(
pcm
, &
pcm_¬—s
, &
pcm_off£t
, &
äames
);

119 
	`¢d_pcm_¬—s_cİy
(
¬—s
, 
off£t
,

120 
pcm_¬—s
, 
pcm_off£t
,

121 
pcm
->
chªÃls
,

122 
äames
, 
pcm
->
fÜm©
);

123 
»suÉ
 = 
	`__¢d_pcm_mm­_comm™
(
pcm
, 
pcm_off£t
, 
äames
);

124 ià(
»suÉ
 < 0)

125  
xãr
 > 0 ? (
¢d_pcm_säames_t
)xã¸: 
»suÉ
;

126 
off£t
 +ğ
»suÉ
;

127 
xãr
 +ğ
»suÉ
;

128 
size
 -ğ
»suÉ
;

130  (
¢d_pcm_säames_t
)
xãr
;

131 
	}
}

150 
¢d_pcm_säames_t
 
	$¢d_pcm_mm­_wr™ei
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

152 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

153 
	`¢d_pcm_¬—s_äom_buf
(
pcm
, 
¬—s
, (*)
bufãr
);

154  
	`¢d_pcm_wr™e_¬—s
(
pcm
, 
¬—s
, 0, 
size
,

155 
¢d_pcm_mm­_wr™e_¬—s
);

156 
	}
}

175 
¢d_pcm_säames_t
 
	$¢d_pcm_mm­_wr™’
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

177 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

178 
	`¢d_pcm_¬—s_äom_bufs
(
pcm
, 
¬—s
, 
bufs
);

179  
	`¢d_pcm_wr™e_¬—s
(
pcm
, 
¬—s
, 0, 
size
,

180 
¢d_pcm_mm­_wr™e_¬—s
);

181 
	}
}

200 
¢d_pcm_säames_t
 
	$¢d_pcm_mm­_»adi
(
¢d_pcm_t
 *
pcm
, *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

202 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

203 
	`¢d_pcm_¬—s_äom_buf
(
pcm
, 
¬—s
, 
bufãr
);

204  
	`¢d_pcm_»ad_¬—s
(
pcm
, 
¬—s
, 0, 
size
,

205 
¢d_pcm_mm­_»ad_¬—s
);

206 
	}
}

225 
¢d_pcm_säames_t
 
	$¢d_pcm_mm­_»adn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

227 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

228 
	`¢d_pcm_¬—s_äom_bufs
(
pcm
, 
¬—s
, 
bufs
);

229  
	`¢d_pcm_»ad_¬—s
(
pcm
, 
¬—s
, 0, 
size
,

230 
¢d_pcm_mm­_»ad_¬—s
);

231 
	}
}

233 
	$¢d_pcm_chªÃl_šfo_shm
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_šfo_t
 *
šfo
, 
shmid
)

235 
pcm
->
acûss
) {

236 
SND_PCM_ACCESS_MMAP_INTERLEAVED
:

237 
SND_PCM_ACCESS_RW_INTERLEAVED
:

238 
šfo
->
fœ¡
 = info->
chªÃl
 * 
pcm
->
§m¶e_b™s
;

239 
šfo
->
¡•
 = 
pcm
->
äame_b™s
;

241 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
:

242 
SND_PCM_ACCESS_RW_NONINTERLEAVED
:

243 
šfo
->
fœ¡
 = 0;

244 
šfo
->
¡•
 = 
pcm
->
§m¶e_b™s
;

247 
	`SNDMSG
("šv®id‡cûs ty³ %d", 
pcm
->
acûss
);

248  -
EINVAL
;

250 
šfo
->
addr
 = 0;

251 ià(
pcm
->
hw_æags
 & 
SND_PCM_HW_PARAMS_EXPORT_BUFFER
) {

252 
šfo
->
ty³
 = 
SND_PCM_AREA_SHM
;

253 
šfo
->
u
.
shm
.
shmid
 = shmid;

254 
šfo
->
u
.
shm
.
¬—
 = 
NULL
;

256 
šfo
->
ty³
 = 
SND_PCM_AREA_LOCAL
;

258 
	}
}

260 
	$¢d_pcm_mm­
(
¢d_pcm_t
 *
pcm
)

262 
”r
;

263 
c
;

264 
	`as£¹
(
pcm
);

265 ià(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

266 
	`SNDMSG
("PCM‚ot set up");

267  -
EIO
;

269 ià(
	`CHECK_SANITY
(
pcm
->
mm­_chªÃls
 ||…cm->
ruÂšg_¬—s
)) {

270 
	`SNDMSG
("Already mmapped");

271  -
EBUSY
;

273 ià(
pcm
->
İs
->
mm­
)

274 
”r
 = 
pcm
->
İs
->
	`mm­
(pcm);

276 
”r
 = -
ENOSYS
;

277 ià(
”r
 < 0)

278  
”r
;

279 ià(
pcm
->
mm­_shadow
)

281 
pcm
->
mm­_chªÃls
 = 
	`ÿÎoc
Õcm->
chªÃls
, (pcm->mmap_channels[0]));

282 ià(!
pcm
->
mm­_chªÃls
)

283  -
ENOMEM
;

284 
pcm
->
ruÂšg_¬—s
 = 
	`ÿÎoc
Õcm->
chªÃls
, (pcm->running_areas[0]));

285 ià(!
pcm
->
ruÂšg_¬—s
) {

286 
	`ä“
(
pcm
->
mm­_chªÃls
);

287 
pcm
->
mm­_chªÃls
 = 
NULL
;

288  -
ENOMEM
;

290 
c
 = 0; c < 
pcm
->
chªÃls
; ++c) {

291 
¢d_pcm_chªÃl_šfo_t
 *
i
 = &
pcm
->
mm­_chªÃls
[
c
];

292 
i
->
chªÃl
 = 
c
;

293 
”r
 = 
	`¢d_pcm_chªÃl_šfo
(
pcm
, 
i
);

294 ià(
”r
 < 0) {

295 
	`ä“
(
pcm
->
mm­_chªÃls
);

296 
	`ä“
(
pcm
->
ruÂšg_¬—s
);

297 
pcm
->
mm­_chªÃls
 = 
NULL
;

298 
pcm
->
ruÂšg_¬—s
 = 
NULL
;

299  
”r
;

302 
c
 = 0; c < 
pcm
->
chªÃls
; ++c) {

303 
¢d_pcm_chªÃl_šfo_t
 *
i
 = &
pcm
->
mm­_chªÃls
[
c
];

304 
¢d_pcm_chªÃl_¬—_t
 *
a
 = &
pcm
->
ruÂšg_¬—s
[
c
];

305 *
±r
;

306 
size_t
 
size
;

307 
c1
;

308 ià(
i
->
addr
) {

309 
a
->
addr
 = 
i
->addr;

310 
a
->
fœ¡
 = 
i
->first;

311 
a
->
¡•
 = 
i
->step;

314 
size
 = 
i
->
fœ¡
 + i->
¡•
 * (
pcm
->
bufãr_size
 - 1è+…cm->
§m¶e_b™s
;

315 
c1
 = 
c
 + 1; c1 < 
pcm
->
chªÃls
; ++c1) {

316 
¢d_pcm_chªÃl_šfo_t
 *
i1
 = &
pcm
->
mm­_chªÃls
[
c1
];

317 
size_t
 
s
;

318 ià(
i1
->
ty³
 !ğ
i
->type)

320 
i1
->
ty³
) {

321 
SND_PCM_AREA_MMAP
:

322 ià(
i1
->
u
.
mm­
.
fd
 !ğ
i
->u.mmap.fd ||

323 
i1
->
u
.
mm­
.
off£t
 !ğ
i
->u.mmap.offset)

326 
SND_PCM_AREA_SHM
:

327 ià(
i1
->
u
.
shm
.
shmid
 !ğ
i
->u.shm.shmid)

330 
SND_PCM_AREA_LOCAL
:

333 
	`as£¹
(0);

335 
s
 = 
i1
->
fœ¡
 + i1->
¡•
 * (
pcm
->
bufãr_size
 - 1è+…cm->
§m¶e_b™s
;

336 ià(
s
 > 
size
)

337 
size
 = 
s
;

339 
size
 = (size + 7) / 8;

340 
size
 = 
	`·ge_®ign
(size);

341 
i
->
ty³
) {

342 
SND_PCM_AREA_MMAP
:

343 
±r
 = 
	`mm­
(
NULL
, 
size
, 
PROT_READ
|
PROT_WRITE
, 
MAP_FILE
|
MAP_SHARED
, 
i
->
u
.
mm­
.
fd
, i->u.mm­.
off£t
);

344 ià(
±r
 =ğ
MAP_FAILED
) {

345 
	`SYSERR
("mmap failed");

346  -
”ºo
;

348 
i
->
addr
 = 
±r
;

350 
SND_PCM_AREA_SHM
:

351 #ifdeà
HAVE_SYS_SHM_H


352 ià(
i
->
u
.
shm
.
shmid
 < 0) {

353 
id
;

355 
id
 = 
	`shmg‘
(
IPC_PRIVATE
, 
size
, 0666);

356 ià(
id
 < 0) {

357 
	`SYSERR
("shmget failed");

358  -
”ºo
;

360 
i
->
u
.
shm
.
shmid
 = 
id
;

361 
±r
 = 
	`shm©
(
i
->
u
.
shm
.
shmid
, 0, 0);

362 ià(
±r
 == (*) -1) {

363 
	`SYSERR
("shmat failed");

364  -
”ºo
;

367 ià(
	`shmùl
(
id
, 
IPC_RMID
, 
NULL
) < 0){

368 
	`SYSERR
("shmctl mark„emove failed");

369  -
”ºo
;

371 
i
->
u
.
shm
.
¬—
 = 
	`¢d_shm_¬—_ü—‹
(
id
, 
±r
);

372 ià(
i
->
u
.
shm
.
¬—
 =ğ
NULL
) {

373 
	`SYSERR
("snd_shm_area_create failed");

374  -
ENOMEM
;

376 ià(
pcm
->
acûss
 =ğ
SND_PCM_ACCESS_MMAP_INTERLEAVED
 ||

377 
pcm
->
acûss
 =ğ
SND_PCM_ACCESS_RW_INTERLEAVED
) {

378 
c1
;

379 
c1
 = 
c
 + 1; c1 < 
pcm
->
chªÃls
; c1++) {

380 
¢d_pcm_chªÃl_šfo_t
 *
i1
 = &
pcm
->
mm­_chªÃls
[
c1
];

381 ià(
i1
->
u
.
shm
.
shmid
 < 0) {

382 
i1
->
u
.
shm
.
shmid
 = 
id
;

383 
i1
->
u
.
shm
.
¬—
 = 
	`¢d_shm_¬—_sh¬e
(
i
->u.shm.area);

388 
±r
 = 
	`shm©
(
i
->
u
.
shm
.
shmid
, 0, 0);

389 ià(
±r
 == (*) -1) {

390 
	`SYSERR
("shmat failed");

391  -
”ºo
;

394 
i
->
addr
 = 
±r
;

397 
	`SYSERR
("shm support‚ot‡vailable");

398  -
ENOSYS
;

400 
SND_PCM_AREA_LOCAL
:

401 
±r
 = 
	`m®loc
(
size
);

402 ià(
±r
 =ğ
NULL
) {

403 
	`SYSERR
("malloc failed");

404  -
”ºo
;

406 
i
->
addr
 = 
±r
;

409 
	`as£¹
(0);

411 
c1
 = 
c
 + 1; c1 < 
pcm
->
chªÃls
; ++c1) {

412 
¢d_pcm_chªÃl_šfo_t
 *
i1
 = &
pcm
->
mm­_chªÃls
[
c1
];

413 ià(
i1
->
ty³
 !ğ
i
->type)

415 
i1
->
ty³
) {

416 
SND_PCM_AREA_MMAP
:

417 ià(
i1
->
u
.
mm­
.
fd
 !ğ
i
->u.mmap.fd ||

418 
i1
->
u
.
mm­
.
off£t
 !ğ
i
->u.mmap.offset)

421 
SND_PCM_AREA_SHM
:

422 ià(
i1
->
u
.
shm
.
shmid
 !ğ
i
->u.shm.shmid)

425 
SND_PCM_AREA_LOCAL
:

426 ià(
pcm
->
acûss
 !ğ
SND_PCM_ACCESS_MMAP_INTERLEAVED
 &&

427 
pcm
->
acûss
 !ğ
SND_PCM_ACCESS_RW_INTERLEAVED
)

431 
	`as£¹
(0);

433 
i1
->
addr
 = 
i
->addr;

435 
a
->
addr
 = 
i
->addr;

436 
a
->
fœ¡
 = 
i
->first;

437 
a
->
¡•
 = 
i
->step;

440 
	}
}

442 
	$¢d_pcm_munm­
(
¢d_pcm_t
 *
pcm
)

444 
”r
;

445 
c
;

446 
	`as£¹
(
pcm
);

447 ià(
	`CHECK_SANITY
(! 
pcm
->
mm­_chªÃls
)) {

448 
	`SNDMSG
("Not mmapped");

449  -
ENXIO
;

451 ià(
pcm
->
mm­_shadow
) {

452 ià(
pcm
->
İs
->
munm­
)

453  
pcm
->
İs
->
	`munm­
(pcm);

455  -
ENOSYS
;

457 
c
 = 0; c < 
pcm
->
chªÃls
; ++c) {

458 
¢d_pcm_chªÃl_šfo_t
 *
i
 = &
pcm
->
mm­_chªÃls
[
c
];

459 
c1
;

460 
size_t
 
size
 = 
i
->
fœ¡
 + i->
¡•
 * (
pcm
->
bufãr_size
 - 1è+…cm->
§m¶e_b™s
;

461 ià(!
i
->
addr
)

463 
c1
 = 
c
 + 1; c1 < 
pcm
->
chªÃls
; ++c1) {

464 
¢d_pcm_chªÃl_šfo_t
 *
i1
 = &
pcm
->
mm­_chªÃls
[
c1
];

465 
size_t
 
s
;

466 ià(
i1
->
addr
 !ğ
i
->addr)

468 
i1
->
addr
 = 
NULL
;

469 
s
 = 
i1
->
fœ¡
 + i1->
¡•
 * (
pcm
->
bufãr_size
 - 1è+…cm->
§m¶e_b™s
;

470 ià(
s
 > 
size
)

471 
size
 = 
s
;

473 
size
 = (size + 7) / 8;

474 
size
 = 
	`·ge_®ign
(size);

475 
i
->
ty³
) {

476 
SND_PCM_AREA_MMAP
:

477 
”r
 = 
	`munm­
(
i
->
addr
, 
size
);

478 ià(
”r
 < 0) {

479 
	`SYSERR
("mmap failed");

480  -
”ºo
;

482 
”ºo
 = 0;

484 
SND_PCM_AREA_SHM
:

485 #ifdeà
HAVE_SYS_SHM_H


486 ià(
i
->
u
.
shm
.
¬—
) {

487 
	`¢d_shm_¬—_de¡roy
(
i
->
u
.
shm
.
¬—
);

488 
i
->
u
.
shm
.
¬—
 = 
NULL
;

489 ià(
pcm
->
acûss
 =ğ
SND_PCM_ACCESS_MMAP_INTERLEAVED
 ||

490 
pcm
->
acûss
 =ğ
SND_PCM_ACCESS_RW_INTERLEAVED
) {

491 
c1
;

492 
c1
 = 
c
 + 1; c1 < 
pcm
->
chªÃls
; c1++) {

493 
¢d_pcm_chªÃl_šfo_t
 *
i1
 = &
pcm
->
mm­_chªÃls
[
c1
];

494 ià(
i1
->
u
.
shm
.
¬—
) {

495 
	`¢d_shm_¬—_de¡roy
(
i1
->
u
.
shm
.
¬—
);

496 
i1
->
u
.
shm
.
¬—
 = 
NULL
;

503 
	`SYSERR
("shm support‚ot‡vailable");

504  -
ENOSYS
;

506 
SND_PCM_AREA_LOCAL
:

507 
	`ä“
(
i
->
addr
);

510 
	`as£¹
(0);

512 
i
->
addr
 = 
NULL
;

514 ià(
pcm
->
İs
->
munm­
)

515 
”r
 = 
pcm
->
İs
->
	`munm­
(pcm);

517 
”r
 = -
ENOSYS
;

518 ià(
”r
 < 0)

519  
”r
;

520 
	`ä“
(
pcm
->
mm­_chªÃls
);

521 
	`ä“
(
pcm
->
ruÂšg_¬—s
);

522 
pcm
->
mm­_chªÃls
 = 
NULL
;

523 
pcm
->
ruÂšg_¬—s
 = 
NULL
;

525 
	}
}

528 
¢d_pcm_säames_t
 
	$¢d_pcm_wr™e_mm­
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
off£t
,

529 
¢d_pcm_uäames_t
 
size
)

531 
¢d_pcm_uäames_t
 
xãr
 = 0;

532 
¢d_pcm_säames_t
 
”r
 = 0;

533 ià(! 
size
)

535 
xãr
 < 
size
) {

536 
¢d_pcm_uäames_t
 
äames
 = 
size
 - 
xãr
;

537 
¢d_pcm_uäames_t
 
cÚt
 = 
pcm
->
bufãr_size
 - 
off£t
;

538 ià(
cÚt
 < 
äames
)

539 
äames
 = 
cÚt
;

540 
pcm
->
acûss
) {

541 
SND_PCM_ACCESS_MMAP_INTERLEAVED
:

543 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
a
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

544 cÚ¡ *
buf
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
a
, 
off£t
);

545 
	`¢d_pcm_uÆock
(
pcm
);

546 
”r
 = 
	`_¢d_pcm_wr™ei
(
pcm
, 
buf
, 
äames
);

547 
	`¢d_pcm_lock
(
pcm
);

548 ià(
”r
 >= 0)

549 
äames
 = 
”r
;

552 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
:

554 
chªÃls
 = 
pcm
->channels;

555 
c
;

556 *
bufs
[
chªÃls
];

557 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

558 
c
 = 0; c < 
chªÃls
; ++c) {

559 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
a
 = &
¬—s
[
c
];

560 
bufs
[
c
] = 
	`¢d_pcm_chªÃl_¬—_addr
(
a
, 
off£t
);

562 
	`¢d_pcm_uÆock
(
pcm
);

563 
”r
 = 
	`_¢d_pcm_wr™’
(
pcm
, 
bufs
, 
äames
);

564 
	`¢d_pcm_lock
(
pcm
);

565 ià(
”r
 >= 0)

566 
äames
 = 
”r
;

570 
	`SNDMSG
("šv®id‡cûs ty³ %d", 
pcm
->
acûss
);

571  -
EINVAL
;

573 ià(
”r
 < 0)

575 
xãr
 +ğ
äames
;

576 
off£t
 = (off£ˆ+ 
äames
è% 
pcm
->
bufãr_size
;

578 ià(
xãr
 > 0)

579  
xãr
;

580  
”r
;

581 
	}
}

584 
¢d_pcm_säames_t
 
	$¢d_pcm_»ad_mm­
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
off£t
,

585 
¢d_pcm_uäames_t
 
size
)

587 
¢d_pcm_uäames_t
 
xãr
 = 0;

588 
¢d_pcm_säames_t
 
”r
 = 0;

589 ià(! 
size
)

591 
xãr
 < 
size
) {

592 
¢d_pcm_uäames_t
 
äames
 = 
size
 - 
xãr
;

593 
¢d_pcm_uäames_t
 
cÚt
 = 
pcm
->
bufãr_size
 - 
off£t
;

594 ià(
cÚt
 < 
äames
)

595 
äames
 = 
cÚt
;

596 
pcm
->
acûss
) {

597 
SND_PCM_ACCESS_MMAP_INTERLEAVED
:

599 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
a
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

600 *
buf
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
a
, 
off£t
);

601 
	`¢d_pcm_uÆock
(
pcm
);

602 
”r
 = 
	`_¢d_pcm_»adi
(
pcm
, 
buf
, 
äames
);

603 
	`¢d_pcm_lock
(
pcm
);

604 ià(
”r
 >= 0)

605 
äames
 = 
”r
;

608 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
:

610 
¢d_pcm_uäames_t
 
chªÃls
 = 
pcm
->channels;

611 
c
;

612 *
bufs
[
chªÃls
];

613 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

614 
c
 = 0; c < 
chªÃls
; ++c) {

615 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
a
 = &
¬—s
[
c
];

616 
bufs
[
c
] = 
	`¢d_pcm_chªÃl_¬—_addr
(
a
, 
off£t
);

618 
	`¢d_pcm_uÆock
(
pcm
);

619 
”r
 = 
	`_¢d_pcm_»adn
(
pcm
->
ç¡_İ_¬g
, 
bufs
, 
äames
);

620 
	`¢d_pcm_lock
(
pcm
);

621 ià(
”r
 >= 0)

622 
äames
 = 
”r
;

626 
	`SNDMSG
("šv®id‡cûs ty³ %d", 
pcm
->
acûss
);

627  -
EINVAL
;

629 ià(
”r
 < 0)

631 
xãr
 +ğ
äames
;

632 
off£t
 = (off£ˆ+ 
äames
è% 
pcm
->
bufãr_size
;

634 ià(
xãr
 > 0)

635  
xãr
;

636  
”r
;

637 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_mmap_emul.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_g’”ic.h
"

32 #iâdeà
PIC


34 cÚ¡ *
	g_¢d_moduË_pcm_mm­_emul
 = "";

37 #iâdeà
DOC_HIDDEN


43 
¢d_pcm_g’”ic_t
 
	mg’
;

44 
	mmm­_emul
 :1;

45 
¢d_pcm_uäames_t
 
	mhw_±r
;

46 
¢d_pcm_uäames_t
 
	m­¶_±r
;

47 
¢d_pcm_uäames_t
 
	m¡¬t_th»shŞd
;

48 } 
	tmm­_emul_t
;

55 
	$¢d_pcm_mm­_emul_hw_»fše
(
¢d_pcm_t
 *
pcm
,

56 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

58 
mm­_emul_t
 *
m­
 = 
pcm
->
´iv©e_d©a
;

59 
”r
 = 0;

60 
¢d_pcm_acûss_mask_t
 
Şdmask
 =

61 *
	`¢d_pcm_hw_·¿m_g‘_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
);

62 
¢d_pcm_acûss_mask_t
 
mask
;

63 cÚ¡ 
¢d_mask_t
 *
pmask
;

65 
	`¢d_mask_nÚe
(&
mask
);

66 
”r
 = 
	`¢d_pcm_hw_»fše
(
m­
->
g’
.
¦ave
, 
·¿ms
);

67 ià(
”r
 < 0) {

68 
¢d_pcm_hw_·¿ms_t
 
Ãw
 = *
·¿ms
;

71 ià(
	`¢d_pcm_acûss_mask_‹¡
(&
Şdmask
,

72 
SND_PCM_ACCESS_MMAP_INTERLEAVED
) &&

73 !
	`¢d_pcm_acûss_mask_‹¡
(&
Şdmask
,

74 
SND_PCM_ACCESS_RW_INTERLEAVED
))

75 
	`¢d_pcm_acûss_mask_£t
(&
mask
,

76 
SND_PCM_ACCESS_RW_INTERLEAVED
);

77 ià(
	`¢d_pcm_acûss_mask_‹¡
(&
Şdmask
,

78 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
) &&

79 !
	`¢d_pcm_acûss_mask_‹¡
(&
Şdmask
,

80 
SND_PCM_ACCESS_RW_NONINTERLEAVED
))

81 
	`¢d_pcm_acûss_mask_£t
(&
mask
,

82 
SND_PCM_ACCESS_RW_NONINTERLEAVED
);

83 ià(
	`¢d_pcm_acûss_mask_em±y
(&
mask
))

84  
”r
;

85 
pmask
 = 
	`¢d_pcm_hw_·¿m_g‘_mask
(&
Ãw
,

86 
SND_PCM_HW_PARAM_ACCESS
);

87 *(
¢d_mask_t
 *)
pmask
 = 
mask
;

88 
”r
 = 
	`¢d_pcm_hw_»fše
(
m­
->
g’
.
¦ave
, &
Ãw
);

89 ià(
”r
 < 0)

90  
”r
;

91 *
·¿ms
 = 
Ãw
;

94 
pmask
 = 
	`¢d_pcm_hw_·¿m_g‘_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
);

95 ià(
	`¢d_pcm_acûss_mask_‹¡
(
pmask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
) ||

96 
	`¢d_pcm_acûss_mask_‹¡
(
pmask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
) ||

97 
	`¢d_pcm_acûss_mask_‹¡
(
pmask
, 
SND_PCM_ACCESS_MMAP_COMPLEX
))

99 ià(
	`¢d_pcm_acûss_mask_‹¡
(&
mask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
)) {

100 ià(
	`¢d_pcm_acûss_mask_‹¡
(
pmask
,

101 
SND_PCM_ACCESS_RW_INTERLEAVED
))

102 
	`¢d_pcm_acûss_mask_£t
((
¢d_pcm_acûss_mask_t
 *)
pmask
,

103 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

104 
	`¢d_pcm_acûss_mask_»£t
((
¢d_pcm_acûss_mask_t
 *)
pmask
,

105 
SND_PCM_ACCESS_RW_INTERLEAVED
);

106 
·¿ms
->
cmask
 |ğ1<<
SND_PCM_HW_PARAM_ACCESS
;

108 ià(
	`¢d_pcm_acûss_mask_‹¡
(&
mask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
)) {

109 ià(
	`¢d_pcm_acûss_mask_‹¡
(
pmask
,

110 
SND_PCM_ACCESS_RW_NONINTERLEAVED
))

111 
	`¢d_pcm_acûss_mask_£t
((
¢d_pcm_acûss_mask_t
 *)
pmask
,

112 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

113 
	`¢d_pcm_acûss_mask_»£t
((
¢d_pcm_acûss_mask_t
 *)
pmask
,

114 
SND_PCM_ACCESS_RW_NONINTERLEAVED
);

115 
·¿ms
->
cmask
 |ğ1<<
SND_PCM_HW_PARAM_ACCESS
;

117 ià(
	`¢d_pcm_acûss_mask_‹¡
(&
Şdmask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
)) {

118 ià(
	`¢d_pcm_acûss_mask_‹¡
(&
Şdmask
,

119 
SND_PCM_ACCESS_RW_INTERLEAVED
)) {

120 ià(
	`¢d_pcm_acûss_mask_‹¡
(
pmask
,

121 
SND_PCM_ACCESS_RW_INTERLEAVED
)) {

122 
	`¢d_pcm_acûss_mask_£t
((
¢d_pcm_acûss_mask_t
 *)
pmask
,

123 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

124 
·¿ms
->
cmask
 |ğ1<<
SND_PCM_HW_PARAM_ACCESS
;

128 ià(
	`¢d_pcm_acûss_mask_‹¡
(&
Şdmask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
)) {

129 ià(
	`¢d_pcm_acûss_mask_‹¡
(&
Şdmask
,

130 
SND_PCM_ACCESS_RW_NONINTERLEAVED
)) {

131 ià(
	`¢d_pcm_acûss_mask_‹¡
(
pmask
,

132 
SND_PCM_ACCESS_RW_NONINTERLEAVED
)) {

133 
	`¢d_pcm_acûss_mask_£t
((
¢d_pcm_acûss_mask_t
 *)
pmask
,

134 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

135 
·¿ms
->
cmask
 |ğ1<<
SND_PCM_HW_PARAM_ACCESS
;

140 
	}
}

153 
	$¢d_pcm_mm­_emul_hw_·¿ms
(
¢d_pcm_t
 *
pcm
,

154 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

156 
mm­_emul_t
 *
m­
 = 
pcm
->
´iv©e_d©a
;

157 
¢d_pcm_hw_·¿ms_t
 
Şd
 = *
·¿ms
;

158 
¢d_pcm_acûss_t
 
acûss
;

159 
¢d_pcm_acûss_mask_t
 
Şdmask
;

160 
¢d_pcm_acûss_mask_t
 *
pmask
;

161 
”r
;

163 
”r
 = 
	`_¢d_pcm_hw_·¿ms_š‹º®
(
m­
->
g’
.
¦ave
, 
·¿ms
);

164 ià(
”r
 >= 0) {

165 
m­
->
mm­_emul
 = 0;

166  
”r
;

169 *
·¿ms
 = 
Şd
;

170 
pmask
 = (
¢d_pcm_acûss_mask_t
 *)
	`¢d_pcm_hw_·¿m_g‘_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
);

171 
Şdmask
 = *
pmask
;

172 ià(
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_acûss
)(
·¿ms
, &
acûss
) < 0)

173 
_”r
;

174 
acûss
) {

175 
SND_PCM_ACCESS_MMAP_INTERLEAVED
:

176 
	`¢d_pcm_acûss_mask_»£t
(
pmask
,

177 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

178 
	`¢d_pcm_acûss_mask_£t
(
pmask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
);

180 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
:

181 
	`¢d_pcm_acûss_mask_»£t
(
pmask
,

182 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

183 
	`¢d_pcm_acûss_mask_£t
(
pmask
,

184 
SND_PCM_ACCESS_RW_NONINTERLEAVED
);

187 
_”r
;

189 
”r
 = 
	`_¢d_pcm_hw_·¿ms_š‹º®
(
m­
->
g’
.
¦ave
, 
·¿ms
);

190 ià(
”r
 < 0)

191 
_”r
;

194 *
pmask
 = 
Şdmask
;

197 
m­
->
mm­_emul
 = 1;

198 
m­
->
­¶_±r
 = 0;

199 
m­
->
hw_±r
 = 0;

200 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
m­
->
hw_±r
, -1, 0);

201 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
m­
->
­¶_±r
, -1, 0);

204 
_”r
:

205 
”r
 = -
”ºo
;

206  
”r
;

207 
	}
}

209 
	$¢d_pcm_mm­_emul_sw_·¿ms
(
¢d_pcm_t
 *
pcm
,

210 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
)

212 
mm­_emul_t
 *
m­
 = 
pcm
->
´iv©e_d©a
;

213 
”r
;

215 ià(!
m­
->
mm­_emul
)

216  
	`¢d_pcm_g’”ic_sw_·¿ms
(
pcm
, 
·¿ms
);

218 
m­
->
¡¬t_th»shŞd
 = 
·¿ms
->start_threshold;

221 
·¿ms
->
¡¬t_th»shŞd
 = 
pcm
->
bound¬y
;

222 
”r
 = 
	`¢d_pcm_g’”ic_sw_·¿ms
(
pcm
, 
·¿ms
);

223 ià(
”r
 < 0)

224  
”r
;

226 
·¿ms
->
¡¬t_th»shŞd
 = 
m­
->start_threshold;

227  
”r
;

228 
	}
}

230 
	$¢d_pcm_mm­_emul_´•¬e
(
¢d_pcm_t
 *
pcm
)

232 
mm­_emul_t
 *
m­
 = 
pcm
->
´iv©e_d©a
;

233 
”r
;

235 
”r
 = 
	`¢d_pcm_g’”ic_´•¬e
(
pcm
);

236 ià(
”r
 < 0)

237  
”r
;

238 
m­
->
hw_±r
 = m­->
­¶_±r
 = 0;

239  
”r
;

240 
	}
}

242 
	$¢d_pcm_mm­_emul_»£t
(
¢d_pcm_t
 *
pcm
)

244 
mm­_emul_t
 *
m­
 = 
pcm
->
´iv©e_d©a
;

245 
”r
;

247 
”r
 = 
	`¢d_pcm_g’”ic_»£t
(
pcm
);

248 ià(
”r
 < 0)

249  
”r
;

250 
m­
->
hw_±r
 = m­->
­¶_±r
 = 0;

251  
”r
;

252 
	}
}

254 
¢d_pcm_säames_t


255 
	$¢d_pcm_mm­_emul_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

257 
äames
 = 
	`¢d_pcm_g’”ic_»wšd
(
pcm
, frames);

258 ià(
äames
 > 0)

259 
	`¢d_pcm_mm­_­¶_backw¬d
(
pcm
, 
äames
);

260  
äames
;

261 
	}
}

263 
¢d_pcm_säames_t


264 
	$¢d_pcm_mm­_emul_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

266 
äames
 = 
	`¢d_pcm_g’”ic_fÜw¬d
(
pcm
, frames);

267 ià(
äames
 > 0)

268 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
äames
);

269  
äames
;

270 
	}
}

273 
¢d_pcm_säames_t


274 
	$sync_¦ave_wr™e
(
¢d_pcm_t
 *
pcm
)

276 
mm­_emul_t
 *
m­
 = 
pcm
->
´iv©e_d©a
;

277 
¢d_pcm_t
 *
¦ave
 = 
m­
->
g’
.slave;

278 
¢d_pcm_uäames_t
 
off£t
;

279 
¢d_pcm_säames_t
 
size
;

282 
pcm
->
¡¬t_th»shŞd
 =…cm->
bound¬y
;

284 
size
 = 
m­
->
­¶_±r
 - *
¦ave
->
­¶
.
±r
;

285 ià(
size
 < 0)

286 
size
 +ğ
pcm
->
bound¬y
;

287 ià(
size
) {

288 
off£t
 = *
¦ave
->
­¶
.
±r
 % 
pcm
->
bufãr_size
;

289 
size
 = 
	`¢d_pcm_wr™e_mm­
(
pcm
, 
off£t
, size);

291 
pcm
->
¡¬t_th»shŞd
 = 
m­
->start_threshold;

292  
size
;

293 
	}
}

296 
¢d_pcm_säames_t


297 
	$sync_¦ave_»ad
(
¢d_pcm_t
 *
pcm
)

299 
mm­_emul_t
 *
m­
 = 
pcm
->
´iv©e_d©a
;

300 
¢d_pcm_t
 *
¦ave
 = 
m­
->
g’
.slave;

301 
¢d_pcm_uäames_t
 
off£t
;

302 
¢d_pcm_säames_t
 
size
;

304 
size
 = *
¦ave
->
hw
.
±r
 - 
m­
->
hw_±r
;

305 ià(
size
 < 0)

306 
size
 +ğ
pcm
->
bound¬y
;

307 ià(!
size
)

309 
off£t
 = 
m­
->
hw_±r
 % 
pcm
->
bufãr_size
;

310 
size
 = 
	`¢d_pcm_»ad_mm­
(
pcm
, 
off£t
, size);

311 ià(
size
 > 0)

312 
	`¢d_pcm_mm­_hw_fÜw¬d
(
pcm
, 
size
);

314 
	}
}

316 
¢d_pcm_säames_t


317 
	$¢d_pcm_mm­_emul_mm­_comm™
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
off£t
,

318 
¢d_pcm_uäames_t
 
size
)

320 
mm­_emul_t
 *
m­
 = 
pcm
->
´iv©e_d©a
;

321 
¢d_pcm_t
 *
¦ave
 = 
m­
->
g’
.slave;

323 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
size
);

324 ià(!
m­
->
mm­_emul
)

325  
	`¢d_pcm_mm­_comm™
(
¦ave
, 
off£t
, 
size
);

326 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

327 
	`sync_¦ave_wr™e
(
pcm
);

328  
size
;

329 
	}
}

331 
¢d_pcm_säames_t
 
	$¢d_pcm_mm­_emul_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

333 
mm­_emul_t
 *
m­
 = 
pcm
->
´iv©e_d©a
;

334 
¢d_pcm_t
 *
¦ave
 = 
m­
->
g’
.slave;

336 ià(!
m­
->
mm­_emul
 || 
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

337 
m­
->
hw_±r
 = *
¦ave
->
hw
.
±r
;

339 
	`sync_¦ave_»ad
(
pcm
);

340  
	`¢d_pcm_mm­_ava
(
pcm
);

341 
	}
}

343 
	$¢d_pcm_mm­_emul_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

345 
mm­_emul_t
 *
m­
 = 
pcm
->
´iv©e_d©a
;

347 
	`¢d_ouut_´štf
(
out
, "Mmapƒmulation PCM\n");

348 ià(
pcm
->
£tup
) {

349 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

350 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

352 
	`¢d_ouut_´štf
(
out
, "Slave: ");

353 
	`¢d_pcm_dump
(
m­
->
g’
.
¦ave
, 
out
);

354 
	}
}

356 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_mm­_emul_İs
 = {

357 .
şo£
 = 
¢d_pcm_g’”ic_şo£
,

358 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

359 .
	ghw_»fše
 = 
¢d_pcm_mm­_emul_hw_»fše
,

360 .
	ghw_·¿ms
 = 
¢d_pcm_mm­_emul_hw_·¿ms
,

361 .
	ghw_ä“
 = 
¢d_pcm_g’”ic_hw_ä“
,

362 .
	gsw_·¿ms
 = 
¢d_pcm_mm­_emul_sw_·¿ms
,

363 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

364 .
	gdump
 = 
¢d_pcm_mm­_emul_dump
,

365 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

366 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

367 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

368 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

369 .
	gqu”y_chm­s
 = 
¢d_pcm_g’”ic_qu”y_chm­s
,

370 .
	gg‘_chm­
 = 
¢d_pcm_g’”ic_g‘_chm­
,

371 .
	g£t_chm­
 = 
¢d_pcm_g’”ic_£t_chm­
,

374 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_mm­_emul_ç¡_İs
 = {

375 .
¡©us
 = 
¢d_pcm_g’”ic_¡©us
,

376 .
	g¡©e
 = 
¢d_pcm_g’”ic_¡©e
,

377 .
	ghwsync
 = 
¢d_pcm_g’”ic_hwsync
,

378 .
	gd–ay
 = 
¢d_pcm_g’”ic_d–ay
,

379 .
	g´•¬e
 = 
¢d_pcm_mm­_emul_´•¬e
,

380 .
	g»£t
 = 
¢d_pcm_mm­_emul_»£t
,

381 .
	g¡¬t
 = 
¢d_pcm_g’”ic_¡¬t
,

382 .
	gdrİ
 = 
¢d_pcm_g’”ic_drİ
,

383 .
	gd¿š
 = 
¢d_pcm_g’”ic_d¿š
,

384 .
	g·u£
 = 
¢d_pcm_g’”ic_·u£
,

385 .
	g»wšdabË
 = 
¢d_pcm_g’”ic_»wšdabË
,

386 .
	g»wšd
 = 
¢d_pcm_mm­_emul_»wšd
,

387 .
	gfÜw¬dabË
 = 
¢d_pcm_g’”ic_fÜw¬dabË
,

388 .
	gfÜw¬d
 = 
¢d_pcm_mm­_emul_fÜw¬d
,

389 .
	g»sume
 = 
¢d_pcm_g’”ic_»sume
,

390 .
	glšk
 = 
¢d_pcm_g’”ic_lšk
,

391 .
	glšk_¦aves
 = 
¢d_pcm_g’”ic_lšk_¦aves
,

392 .
	guÆšk
 = 
¢d_pcm_g’”ic_uÆšk
,

393 .
	gwr™ei
 = 
¢d_pcm_g’”ic_wr™ei
,

394 .
	gwr™’
 = 
¢d_pcm_g’”ic_wr™’
,

395 .
	g»adi
 = 
¢d_pcm_g’”ic_»adi
,

396 .
	g»adn
 = 
¢d_pcm_g’”ic_»adn
,

397 .
	gava_upd©e
 = 
¢d_pcm_mm­_emul_ava_upd©e
,

398 .
	gmm­_comm™
 = 
¢d_pcm_mm­_emul_mm­_comm™
,

399 .
	ghtime¡amp
 = 
¢d_pcm_g’”ic_htime¡amp
,

400 .
	gpŞl_desütÜs
 = 
¢d_pcm_g’”ic_pŞl_desütÜs
,

401 .
	gpŞl_desütÜs_couÁ
 = 
¢d_pcm_g’”ic_pŞl_desütÜs_couÁ
,

402 .
	gpŞl_»v’ts
 = 
¢d_pcm_g’”ic_pŞl_»v’ts
,

403 .
	gmay_wa™_fÜ_ava_mš
 = 
¢d_pcm_g’”ic_may_wa™_fÜ_ava_mš
,

406 #iâdeà
DOC_HIDDEN


407 
	$__¢d_pcm_mm­_emul_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

408 
¢d_pcm_t
 *
¦ave
, 
şo£_¦ave
)

410 
¢d_pcm_t
 *
pcm
;

411 
mm­_emul_t
 *
m­
;

412 
”r
;

414 
m­
 = 
	`ÿÎoc
(1, (*map));

415 ià(!
m­
)

416  -
ENOMEM
;

417 
m­
->
g’
.
¦ave
 = slave;

418 
m­
->
g’
.
şo£_¦ave
 = close_slave;

420 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_MMAP_EMUL
, 
Çme
,

421 
¦ave
->
¡»am
, sÏve->
mode
);

422 ià(
”r
 < 0) {

423 
	`ä“
(
m­
);

424  
”r
;

426 
pcm
->
İs
 = &
¢d_pcm_mm­_emul_İs
;

427 
pcm
->
ç¡_İs
 = &
¢d_pcm_mm­_emul_ç¡_İs
;

428 
pcm
->
´iv©e_d©a
 = 
m­
;

429 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

430 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

431 
pcm
->
t¡amp_ty³
 = 
¦ave
->tstamp_type;

432 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
m­
->
hw_±r
, -1, 0);

433 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
m­
->
­¶_±r
, -1, 0);

434 *
pcmp
 = 
pcm
;

437 
	}
}

471 
	$_¢d_pcm_mm­_emul_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

472 
¢d_cÚfig_t
 *
roÙ
 
ATTRIBUTE_UNUSED
,

473 
¢d_cÚfig_t
 *
cÚf
,

474 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

476 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

477 
”r
;

478 
¢d_pcm_t
 *
¥cm
;

479 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

481 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

482 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

483 cÚ¡ *
id
;

484 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

486 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

488 ià(
	`¡rcmp
(
id
, "slave") == 0) {

489 
¦ave
 = 
n
;

492 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

493  -
EINVAL
;

495 ià(!
¦ave
) {

496 
	`SNDERR
("slave is‚ot defined");

497  -
EINVAL
;

499 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 0);

500 ià(
”r
 < 0)

501  
”r
;

502 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

503 
	`¢d_cÚfig_d–‘e
(
scÚf
);

504 ià(
”r
 < 0)

505  
”r
;

506 
”r
 = 
	`__¢d_pcm_mm­_emul_İ’
(
pcmp
, 
Çme
, 
¥cm
, 1);

507 ià(
”r
 < 0)

508 
	`¢d_pcm_şo£
(
¥cm
);

509  
”r
;

510 
	}
}

512 #iâdeà
DOC_HIDDEN


513 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_mm­_emul_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_mulaw.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_¶ugš.h
"

31 
	~"¶ugš_İs.h
"

32 
	~"bsw­.h
"

34 #iâdeà
PIC


36 cÚ¡ *
	g_¢d_moduË_pcm_muÏw
 = "";

39 #iâdeà
DOC_HIDDEN


41 (*
	tmuÏw_f
)(cÚ¡ 
	t¢d_pcm_chªÃl_¬—_t
 *
	t¤c_¬—s
,

42 
	t¢d_pcm_uäames_t
 
	t¤c_off£t
,

43 cÚ¡ 
	t¢d_pcm_chªÃl_¬—_t
 *
	td¡_¬—s
,

44 
	t¢d_pcm_uäames_t
 
	td¡_off£t
,

45 
	tchªÃls
, 
	t¢d_pcm_uäames_t
 
	täames
,

46 
	tg‘putidx
);

50 
¢d_pcm_¶ugš_t
 
¶ug
;

51 
g‘put_idx
;

52 
muÏw_f
 
func
;

53 
¢d_pcm_fÜm©_t
 
sfÜm©
;

54 } 
	t¢d_pcm_muÏw_t
;

58 
šlše
 
	$v®_£g
(
v®
)

60 
r
 = 0;

61 
v®
 >>= 7;

62 ià(
v®
 & 0xf0) {

63 
v®
 >>= 4;

64 
r
 += 4;

66 ià(
v®
 & 0x0c) {

67 
v®
 >>= 2;

68 
r
 += 2;

70 ià(
v®
 & 0x02)

71 
r
 += 1;

72  
r
;

73 
	}
}

105 
	$s16_to_uÏw
(
pcm_v®
)

107 
mask
;

108 
£g
;

109 
uv®
;

111 ià(
pcm_v®
 < 0) {

112 
pcm_v®
 = 0x84 -…cm_val;

113 
mask
 = 0x7f;

115 
pcm_v®
 += 0x84;

116 
mask
 = 0xff;

118 ià(
pcm_v®
 > 0x7fff)

119 
pcm_v®
 = 0x7fff;

122 
£g
 = 
	`v®_£g
(
pcm_v®
);

128 
uv®
 = (
£g
 << 4è| ((
pcm_v®
 >> (seg + 3)) & 0x0f);

129  
uv®
 ^ 
mask
;

130 
	}
}

141 
	$uÏw_to_s16
(
u_v®
)

143 
t
;

146 
u_v®
 = ~u_val;

152 
t
 = ((
u_v®
 & 0x0f) << 3) + 0x84;

153 
t
 <<ğ(
u_v®
 & 0x70) >> 4;

155  ((
u_v®
 & 0x80è? (0x84 - 
t
) : (t - 0x84));

156 
	}
}

158 #iâdeà
DOC_HIDDEN


160 
	$¢d_pcm_muÏw_decode
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

161 
¢d_pcm_uäames_t
 
d¡_off£t
,

162 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

163 
¢d_pcm_uäames_t
 
¤c_off£t
,

164 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

165 
putidx
)

167 
	#PUT16_LABELS


	)

168 
	~"¶ugš_İs.h
"

169 #undeà
PUT16_LABELS


170 *
put
 = 
put16_Ïb–s
[
putidx
];

171 
chªÃl
;

172 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++channel) {

173 cÚ¡ *
¤c
;

174 *
d¡
;

175 
¤c_¡•
, 
d¡_¡•
;

176 
¢d_pcm_uäames_t
 
äames1
;

177 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

178 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

179 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

180 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

181 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
);

182 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
);

183 
äames1
 = 
äames
;

184 
äames1
-- > 0) {

185 
št16_t
 
§m¶e
 = 
	`uÏw_to_s16
(*
¤c
);

186 *
put
;

187 
	#PUT16_END
 
aá”


	)

188 
	~"¶ugš_İs.h
"

189 #undeà
PUT16_END


190 
aá”
:

191 
¤c
 +ğ
¤c_¡•
;

192 
d¡
 +ğ
d¡_¡•
;

195 
	}
}

197 
	$¢d_pcm_muÏw_’code
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

198 
¢d_pcm_uäames_t
 
d¡_off£t
,

199 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

200 
¢d_pcm_uäames_t
 
¤c_off£t
,

201 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

202 
g‘idx
)

204 
	#GET16_LABELS


	)

205 
	~"¶ugš_İs.h
"

206 #undeà
GET16_LABELS


207 *
g‘
 = 
g‘16_Ïb–s
[
g‘idx
];

208 
chªÃl
;

209 
št16_t
 
§m¶e
 = 0;

210 
chªÃl
 = 0; chªÃÈ< 
chªÃls
; ++channel) {

211 cÚ¡ *
¤c
;

212 *
d¡
;

213 
¤c_¡•
, 
d¡_¡•
;

214 
¢d_pcm_uäames_t
 
äames1
;

215 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

216 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

217 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

218 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

219 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
);

220 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
);

221 
äames1
 = 
äames
;

222 
äames1
-- > 0) {

223 *
g‘
;

224 
	#GET16_END
 
aá”


	)

225 
	~"¶ugš_İs.h
"

226 #undeà
GET16_END


227 
aá”
:

228 *
d¡
 = 
	`s16_to_uÏw
(
§m¶e
);

229 
¤c
 +ğ
¤c_¡•
;

230 
d¡
 +ğ
d¡_¡•
;

233 
	}
}

237 
	$¢d_pcm_muÏw_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

239 
¢d_pcm_muÏw_t
 *
muÏw
 = 
pcm
->
´iv©e_d©a
;

240 
”r
;

241 
¢d_pcm_acûss_mask_t
 
acûss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

242 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

243 &
acûss_mask
);

244 ià(
”r
 < 0)

245  
”r
;

246 ià(
muÏw
->
sfÜm©
 =ğ
SND_PCM_FORMAT_MU_LAW
) {

247 
¢d_pcm_fÜm©_mask_t
 
fÜm©_mask
ğ{ 
SND_PCM_FMTBIT_LINEAR
 };

248 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
,

249 &
fÜm©_mask
);

251 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
·¿ms
,

252 
SND_PCM_FORMAT_MU_LAW
);

254 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
·¿ms
, 
SND_PCM_SUBFORMAT_STD
);

255 ià(
”r
 < 0)

256  
”r
;

257 
·¿ms
->
šfo
 &ğ~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

259 
	}
}

261 
	$¢d_pcm_muÏw_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

263 
¢d_pcm_muÏw_t
 *
muÏw
 = 
pcm
->
´iv©e_d©a
;

264 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

265 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

266 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

267 &
§cûss_mask
);

268 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
¥¬ams
, 
muÏw
->
sfÜm©
);

269 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¥¬ams
, 
SND_PCM_SUBFORMAT_STD
);

271 
	}
}

273 
	$¢d_pcm_muÏw_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

274 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

276 
”r
;

277 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

278 
SND_PCM_HW_PARBIT_RATE
 |

279 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

280 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

281 
SND_PCM_HW_PARBIT_PERIODS
 |

282 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

283 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

284 
SND_PCM_HW_PARBIT_TICK_TIME
);

285 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

286 ià(
”r
 < 0)

287  
”r
;

289 
	}
}

291 
	$¢d_pcm_muÏw_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

292 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

294 
”r
;

295 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

296 
SND_PCM_HW_PARBIT_RATE
 |

297 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

298 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

299 
SND_PCM_HW_PARBIT_PERIODS
 |

300 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

301 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

302 
SND_PCM_HW_PARBIT_TICK_TIME
);

303 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

304 ià(
”r
 < 0)

305  
”r
;

307 
	}
}

309 
	$¢d_pcm_muÏw_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

311  
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

312 
¢d_pcm_muÏw_hw_»fše_ı»·»
,

313 
¢d_pcm_muÏw_hw_»fše_cchªge
,

314 
¢d_pcm_muÏw_hw_»fše_¥»·»
,

315 
¢d_pcm_muÏw_hw_»fše_schªge
,

316 
¢d_pcm_g’”ic_hw_»fše
);

317 
	}
}

319 
	$¢d_pcm_muÏw_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 * 
·¿ms
)

321 
¢d_pcm_muÏw_t
 *
muÏw
 = 
pcm
->
´iv©e_d©a
;

322 
¢d_pcm_fÜm©_t
 
fÜm©
;

323 
”r
 = 
	`¢d_pcm_hw_·¿ms_¦ave
(
pcm
, 
·¿ms
,

324 
¢d_pcm_muÏw_hw_»fše_cchªge
,

325 
¢d_pcm_muÏw_hw_»fše_¥»·»
,

326 
¢d_pcm_muÏw_hw_»fše_schªge
,

327 
¢d_pcm_g’”ic_hw_·¿ms
);

328 ià(
”r
 < 0)

329  
”r
;

331 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(
·¿ms
, &
fÜm©
);

332 ià(
”r
 < 0)

333  
”r
;

335 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

336 ià(
muÏw
->
sfÜm©
 =ğ
SND_PCM_FORMAT_MU_LAW
) {

337 
muÏw
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_g‘_šdex
(
fÜm©
, 
SND_PCM_FORMAT_S16
);

338 
muÏw
->
func
 = 
¢d_pcm_muÏw_’code
;

340 
muÏw
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_put_šdex
(
SND_PCM_FORMAT_S16
, muÏw->
sfÜm©
);

341 
muÏw
->
func
 = 
¢d_pcm_muÏw_decode
;

344 ià(
muÏw
->
sfÜm©
 =ğ
SND_PCM_FORMAT_MU_LAW
) {

345 
muÏw
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_put_šdex
(
SND_PCM_FORMAT_S16
, 
fÜm©
);

346 
muÏw
->
func
 = 
¢d_pcm_muÏw_decode
;

348 
muÏw
->
g‘put_idx
 = 
	`¢d_pcm_lš—r_g‘_šdex
(muÏw->
sfÜm©
, 
SND_PCM_FORMAT_S16
);

349 
muÏw
->
func
 = 
¢d_pcm_muÏw_’code
;

353 
	}
}

355 
¢d_pcm_uäames_t


356 
	$¢d_pcm_muÏw_wr™e_¬—s
(
¢d_pcm_t
 *
pcm
,

357 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

358 
¢d_pcm_uäames_t
 
off£t
,

359 
¢d_pcm_uäames_t
 
size
,

360 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

361 
¢d_pcm_uäames_t
 
¦ave_off£t
,

362 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

364 
¢d_pcm_muÏw_t
 *
muÏw
 = 
pcm
->
´iv©e_d©a
;

365 ià(
size
 > *
¦ave_siz•
)

366 
size
 = *
¦ave_siz•
;

367 
muÏw
->
	`func
(
¦ave_¬—s
, 
¦ave_off£t
,

368 
¬—s
, 
off£t
,

369 
pcm
->
chªÃls
, 
size
,

370 
muÏw
->
g‘put_idx
);

371 *
¦ave_siz•
 = 
size
;

372  
size
;

373 
	}
}

375 
¢d_pcm_uäames_t


376 
	$¢d_pcm_muÏw_»ad_¬—s
(
¢d_pcm_t
 *
pcm
,

377 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

378 
¢d_pcm_uäames_t
 
off£t
,

379 
¢d_pcm_uäames_t
 
size
,

380 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

381 
¢d_pcm_uäames_t
 
¦ave_off£t
,

382 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

384 
¢d_pcm_muÏw_t
 *
muÏw
 = 
pcm
->
´iv©e_d©a
;

385 ià(
size
 > *
¦ave_siz•
)

386 
size
 = *
¦ave_siz•
;

387 
muÏw
->
	`func
(
¬—s
, 
off£t
,

388 
¦ave_¬—s
, 
¦ave_off£t
,

389 
pcm
->
chªÃls
, 
size
,

390 
muÏw
->
g‘put_idx
);

391 *
¦ave_siz•
 = 
size
;

392  
size
;

393 
	}
}

395 
	$¢d_pcm_muÏw_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

397 
¢d_pcm_muÏw_t
 *
muÏw
 = 
pcm
->
´iv©e_d©a
;

398 
	`¢d_ouut_´štf
(
out
, "Mu-Law conversion PCM (%s)\n",

399 
	`¢d_pcm_fÜm©_Çme
(
muÏw
->
sfÜm©
));

400 ià(
pcm
->
£tup
) {

401 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

402 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

404 
	`¢d_ouut_´štf
(
out
, "Slave: ");

405 
	`¢d_pcm_dump
(
muÏw
->
¶ug
.
g’
.
¦ave
, 
out
);

406 
	}
}

408 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_muÏw_İs
 = {

409 .
şo£
 = 
¢d_pcm_g’”ic_şo£
,

410 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

411 .
	ghw_»fše
 = 
¢d_pcm_muÏw_hw_»fše
,

412 .
	ghw_·¿ms
 = 
¢d_pcm_muÏw_hw_·¿ms
,

413 .
	ghw_ä“
 = 
¢d_pcm_g’”ic_hw_ä“
,

414 .
	gsw_·¿ms
 = 
¢d_pcm_g’”ic_sw_·¿ms
,

415 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

416 .
	gdump
 = 
¢d_pcm_muÏw_dump
,

417 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

418 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

419 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

420 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

421 .
	gg‘_chm­
 = 
¢d_pcm_g’”ic_g‘_chm­
,

422 .
	g£t_chm­
 = 
¢d_pcm_g’”ic_£t_chm­
,

437 
	$¢d_pcm_muÏw_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
, 
¢d_pcm_fÜm©_t
 
sfÜm©
, snd_pcm_ˆ*
¦ave
, 
şo£_¦ave
)

439 
¢d_pcm_t
 *
pcm
;

440 
¢d_pcm_muÏw_t
 *
muÏw
;

441 
”r
;

442 
	`as£¹
(
pcmp
 && 
¦ave
);

443 ià(
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1 &&

444 
sfÜm©
 !ğ
SND_PCM_FORMAT_MU_LAW
)

445  -
EINVAL
;

446 
muÏw
 = 
	`ÿÎoc
(1, (
¢d_pcm_muÏw_t
));

447 ià(!
muÏw
) {

448  -
ENOMEM
;

450 
	`¢d_pcm_¶ugš_š™
(&
muÏw
->
¶ug
);

451 
muÏw
->
sfÜm©
 = sformat;

452 
muÏw
->
¶ug
.
»ad
 = 
¢d_pcm_muÏw_»ad_¬—s
;

453 
muÏw
->
¶ug
.
wr™e
 = 
¢d_pcm_muÏw_wr™e_¬—s
;

454 
muÏw
->
¶ug
.
undo_»ad
 = 
¢d_pcm_¶ugš_undo_»ad_g’”ic
;

455 
muÏw
->
¶ug
.
undo_wr™e
 = 
¢d_pcm_¶ugš_undo_wr™e_g’”ic
;

456 
muÏw
->
¶ug
.
g’
.
¦ave
 = slave;

457 
muÏw
->
¶ug
.
g’
.
şo£_¦ave
 = close_slave;

459 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_MULAW
, 
Çme
, 
¦ave
->
¡»am
, sÏve->
mode
);

460 ià(
”r
 < 0) {

461 
	`ä“
(
muÏw
);

462  
”r
;

464 
pcm
->
İs
 = &
¢d_pcm_muÏw_İs
;

465 
pcm
->
ç¡_İs
 = &
¢d_pcm_¶ugš_ç¡_İs
;

466 
pcm
->
´iv©e_d©a
 = 
muÏw
;

467 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

468 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

469 
pcm
->
t¡amp_ty³
 = 
¦ave
->tstamp_type;

470 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
muÏw
->
¶ug
.
hw_±r
, -1, 0);

471 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
muÏw
->
¶ug
.
­¶_±r
, -1, 0);

472 *
pcmp
 = 
pcm
;

475 
	}
}

521 
	$_¢d_pcm_muÏw_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

522 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

523 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

525 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

526 
”r
;

527 
¢d_pcm_t
 *
¥cm
;

528 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

529 
¢d_pcm_fÜm©_t
 
sfÜm©
;

530 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

531 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

532 cÚ¡ *
id
;

533 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

535 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

537 ià(
	`¡rcmp
(
id
, "slave") == 0) {

538 
¦ave
 = 
n
;

541 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

542  -
EINVAL
;

544 ià(!
¦ave
) {

545 
	`SNDERR
("slave is‚ot defined");

546  -
EINVAL
;

548 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 1,

549 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_MANDATORY
, &
sfÜm©
);

550 ià(
”r
 < 0)

551  
”r
;

552 ià(
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1 &&

553 
sfÜm©
 !ğ
SND_PCM_FORMAT_MU_LAW
) {

554 
	`¢d_cÚfig_d–‘e
(
scÚf
);

555 
	`SNDERR
("invalid slave format");

556  -
EINVAL
;

558 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

559 
	`¢d_cÚfig_d–‘e
(
scÚf
);

560 ià(
”r
 < 0)

561  
”r
;

562 
”r
 = 
	`¢d_pcm_muÏw_İ’
(
pcmp
, 
Çme
, 
sfÜm©
, 
¥cm
, 1);

563 ià(
”r
 < 0)

564 
	`¢d_pcm_şo£
(
¥cm
);

565  
”r
;

566 
	}
}

567 #iâdeà
DOC_HIDDEN


568 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_muÏw_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_multi.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_g’”ic.h
"

31 
	~<¡dio.h
>

32 
	~<¡dlib.h
>

33 
	~<uni¡d.h
>

34 
	~<¡ršg.h
>

35 
	~<m©h.h
>

37 #iâdeà
PIC


39 cÚ¡ *
	g_¢d_moduË_pcm_muÉi
 = "";

42 #iâdeà
DOC_HIDDEN


45 
¢d_pcm_t
 *
	mpcm
;

46 
	mchªÃls_couÁ
;

47 
	mşo£_¦ave
;

48 
¢d_pcm_t
 *
	mlšked
;

49 } 
	t¢d_pcm_muÉi_¦ave_t
;

52 
	m¦ave_idx
;

53 
	m¦ave_chªÃl
;

54 } 
	t¢d_pcm_muÉi_chªÃl_t
;

57 
¢d_pcm_uäames_t
 
	m­¶_±r
, 
	mhw_±r
;

58 
	m¦aves_couÁ
;

59 
	mma¡”_¦ave
;

60 
¢d_pcm_muÉi_¦ave_t
 *
	m¦aves
;

61 
	mchªÃls_couÁ
;

62 
¢d_pcm_muÉi_chªÃl_t
 *
	mchªÃls
;

63 } 
	t¢d_pcm_muÉi_t
;

67 
	$¢d_pcm_muÉi_şo£
(
¢d_pcm_t
 *
pcm
)

69 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

70 
i
;

71 
»t
 = 0;

72 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

73 
¢d_pcm_muÉi_¦ave_t
 *
¦ave
 = &
muÉi
->
¦aves
[
i
];

74 ià(
¦ave
->
şo£_¦ave
) {

75 
”r
 = 
	`¢d_pcm_şo£
(
¦ave
->
pcm
);

76 ià(
”r
 < 0)

77 
»t
 = 
”r
;

80 
	`ä“
(
muÉi
->
¦aves
);

81 
	`ä“
(
muÉi
->
chªÃls
);

82 
	`ä“
(
muÉi
);

83  
»t
;

84 
	}
}

86 
	$¢d_pcm_muÉi_nÚblock
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
nÚblock
 ATTRIBUTE_UNUSED)

89 
	}
}

91 
	$¢d_pcm_muÉi_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
)

93 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

94 
¢d_pcm_t
 *
¦ave_0
 = 
muÉi
->
¦aves
[muÉi->
ma¡”_¦ave
].
pcm
;

95  
	`¢d_pcm_async
(
¦ave_0
, 
sig
, 
pid
);

96 
	}
}

98 
	$¢d_pcm_muÉi_pŞl_desütÜs_couÁ
(
¢d_pcm_t
 *
pcm
)

100 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

101 
¢d_pcm_t
 *
¦ave_0
 = 
muÉi
->
¦aves
[muÉi->
ma¡”_¦ave
].
pcm
;

102  
	`¢d_pcm_pŞl_desütÜs_couÁ
(
¦ave_0
);

103 
	}
}

105 
	$¢d_pcm_muÉi_pŞl_desütÜs
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
¥aû
)

107 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

108 
¢d_pcm_t
 *
¦ave
;

109 
¢d_pcm_t
 *
¦ave_0
 = 
muÉi
->
¦aves
[muÉi->
ma¡”_¦ave
].
pcm
;

110 
”r
;

111 
i
;

113 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

114 
¦ave
 = 
muÉi
->
¦aves
[
i
].
pcm
;

115 ià(
¦ave
 =ğ
¦ave_0
)

117 
”r
 = 
	`¢d_pcm_pŞl_desütÜs
(
¦ave
, 
pfds
, 
¥aû
);

118 ià(
”r
 < 0)

119  
”r
;

122  
	`¢d_pcm_pŞl_desütÜs
(
¦ave_0
, 
pfds
, 
¥aû
);

123 
	}
}

125 
	$¢d_pcm_muÉi_pŞl_»v’ts
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

127 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

128 
¢d_pcm_t
 *
¦ave_0
 = 
muÉi
->
¦aves
[muÉi->
ma¡”_¦ave
].
pcm
;

129  
	`¢d_pcm_pŞl_desütÜs_»v’ts
(
¦ave_0
, 
pfds
, 
nfds
, 
»v’ts
);

130 
	}
}

132 
	$¢d_pcm_muÉi_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_šfo_t
 *
šfo
)

134 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

135 
”r
, 
n
;

136 
	`as£¹
(
šfo
->
subdeviû
 < 
muÉi
->
¦aves_couÁ
);

137 
n
 = 
šfo
->
subdeviû
;

138 
šfo
->
subdeviû
 = 0;

139 
”r
 = 
	`¢d_pcm_šfo
(
muÉi
->
¦aves
[
n
].
pcm
, 
šfo
);

140 ià(
”r
 < 0)

141  
”r
;

142 
šfo
->
subdeviûs_couÁ
 = 
muÉi
->
¦aves_couÁ
;

144 
	}
}

146 
	$¢d_pcm_muÉi_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

148 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

149 
¢d_pcm_acûss_mask_t
 
acûss_mask
;

150 
”r
;

151 
	`¢d_pcm_acûss_mask_ªy
(&
acûss_mask
);

152 
	`¢d_pcm_acûss_mask_»£t
(&
acûss_mask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

153 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

154 &
acûss_mask
);

155 ià(
”r
 < 0)

156  
”r
;

157 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t
(
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
,

158 
muÉi
->
chªÃls_couÁ
, 0);

159 ià(
”r
 < 0)

160  
”r
;

161 
·¿ms
->
šfo
 = ~0U;

163 
	}
}

165 
	$¢d_pcm_muÉi_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
, 
¦ave_idx
,

166 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

168 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

169 
¢d_pcm_muÉi_¦ave_t
 *
¦ave
 = &
muÉi
->
¦aves
[
¦ave_idx
];

170 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

171 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

172 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

173 &
§cûss_mask
);

174 
	`_¢d_pcm_hw_·¿m_£t
(
¥¬ams
, 
SND_PCM_HW_PARAM_CHANNELS
,

175 
¦ave
->
chªÃls_couÁ
, 0);

177 
	}
}

179 
	$¢d_pcm_muÉi_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

180 
¦ave_idx
 
ATTRIBUTE_UNUSED
,

181 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

182 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

184 
”r
;

185 
lšks
 = (
SND_PCM_HW_PARBIT_FORMAT
 |

186 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

187 
SND_PCM_HW_PARBIT_RATE
 |

188 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

189 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

190 
SND_PCM_HW_PARBIT_PERIODS
 |

191 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

192 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

193 
SND_PCM_HW_PARBIT_TICK_TIME
);

194 cÚ¡ 
¢d_pcm_acûss_mask_t
 *
acûss_mask
 = 
	`¢d_pcm_hw_·¿m_g‘_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
);

195 ià(!
	`¢d_pcm_acûss_mask_‹¡
(
acûss_mask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
) &&

196 !
	`¢d_pcm_acûss_mask_‹¡
(
acûss_mask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
) &&

197 !
	`¢d_pcm_acûss_mask_‹¡
(
acûss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
)) {

198 
¢d_pcm_acûss_mask_t
 
§cûss_mask
;

199 
	`¢d_pcm_acûss_mask_ªy
(&
§cûss_mask
);

200 
	`¢d_pcm_acûss_mask_»£t
(&
§cûss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

201 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

202 &
§cûss_mask
);

203 ià(
”r
 < 0)

204  
”r
;

206 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

207 ià(
”r
 < 0)

208  
”r
;

210 
	}
}

212 
	$¢d_pcm_muÉi_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

213 
¦ave_idx
 
ATTRIBUTE_UNUSED
,

214 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

215 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

217 
”r
;

218 
lšks
 = (
SND_PCM_HW_PARBIT_FORMAT
 |

219 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

220 
SND_PCM_HW_PARBIT_RATE
 |

221 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

222 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

223 
SND_PCM_HW_PARBIT_PERIODS
 |

224 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

225 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

226 
SND_PCM_HW_PARBIT_TICK_TIME
);

227 
¢d_pcm_acûss_mask_t
 
acûss_mask
;

228 cÚ¡ 
¢d_pcm_acûss_mask_t
 *
§cûss_mask
 = 
	`¢d_pcm_hw_·¿m_g‘_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
);

229 
	`¢d_pcm_acûss_mask_ªy
(&
acûss_mask
);

230 
	`¢d_pcm_acûss_mask_»£t
(&
acûss_mask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

231 ià(!
	`¢d_pcm_acûss_mask_‹¡
(
§cûss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
))

232 
	`¢d_pcm_acûss_mask_»£t
(&
acûss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

233 ià(!
	`¢d_pcm_acûss_mask_‹¡
(
§cûss_mask
, 
SND_PCM_ACCESS_MMAP_COMPLEX
) &&

234 !
	`¢d_pcm_acûss_mask_‹¡
(
§cûss_mask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
))

235 
	`¢d_pcm_acûss_mask_»£t
(&
acûss_mask
, 
SND_PCM_ACCESS_MMAP_COMPLEX
);

236 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

237 &
acûss_mask
);

238 ià(
”r
 < 0)

239  
”r
;

240 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

241 ià(
”r
 < 0)

242  
”r
;

243 
·¿ms
->
šfo
 &ğ
¥¬ams
->info;

245 
	}
}

247 
	$¢d_pcm_muÉi_hw_»fše_¦ave
(
¢d_pcm_t
 *
pcm
,

248 
¦ave_idx
,

249 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

251 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

252 
¢d_pcm_t
 *
¦ave
 = 
muÉi
->
¦aves
[
¦ave_idx
].
pcm
;

253  
	`¢d_pcm_hw_»fše
(
¦ave
, 
¥¬ams
);

254 
	}
}

256 
	$¢d_pcm_muÉi_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

258 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

259 
k
;

260 
¢d_pcm_hw_·¿ms_t
 
¥¬ams
[
muÉi
->
¦aves_couÁ
];

261 
”r
;

262 
cmask
, 
chªged
;

263 
”r
 = 
	`¢d_pcm_muÉi_hw_»fše_ı»·»
(
pcm
, 
·¿ms
);

264 ià(
”r
 < 0)

265  
”r
;

266 
k
 = 0; k < 
muÉi
->
¦aves_couÁ
; ++k) {

267 
”r
 = 
	`¢d_pcm_muÉi_hw_»fše_¥»·»
(
pcm
, 
k
, &
¥¬ams
[k]);

268 ià(
”r
 < 0) {

269 
	`SNDERR
("SÏvPCM #%d‚Ù u§bË", 
k
);

270  
”r
;

274 
cmask
 = 
·¿ms
->cmask;

275 
·¿ms
->
cmask
 = 0;

276 
k
 = 0; k < 
muÉi
->
¦aves_couÁ
; ++k) {

277 
”r
 = 
	`¢d_pcm_muÉi_hw_»fše_schªge
(
pcm
, 
k
, 
·¿ms
, &
¥¬ams
[k]);

278 ià(
”r
 >= 0)

279 
”r
 = 
	`¢d_pcm_muÉi_hw_»fše_¦ave
(
pcm
, 
k
, &
¥¬ams
[k]);

280 ià(
”r
 < 0) {

281 
	`¢d_pcm_muÉi_hw_»fše_cchªge
(
pcm
, 
k
, 
·¿ms
, &
¥¬ams
[k]);

282  
”r
;

284 
”r
 = 
	`¢d_pcm_muÉi_hw_»fše_cchªge
(
pcm
, 
k
, 
·¿ms
, &
¥¬ams
[k]);

285 ià(
”r
 < 0)

286  
”r
;

288 
”r
 = 
	`¢d_pcm_hw_»fše_soá
(
pcm
, 
·¿ms
);

289 
chªged
 = 
·¿ms
->
cmask
;

290 
·¿ms
->
cmask
 |= cmask;

291 ià(
”r
 < 0)

292  
”r
;

293 } 
chªged
);

295 
	}
}

297 
	$¢d_pcm_muÉi_hw_·¿ms_¦ave
(
¢d_pcm_t
 *
pcm
,

298 
¦ave_idx
,

299 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

301 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

302 
¢d_pcm_t
 *
¦ave
 = 
muÉi
->
¦aves
[
¦ave_idx
].
pcm
;

303 
”r
 = 
	`¢d_pcm_hw_·¿ms
(
¦ave
, 
¥¬ams
);

304 ià(
”r
 < 0)

305  
”r
;

306 
”r
 = 
	`¢d_pcm_¬—s_s’û
(
¦ave
->
ruÂšg_¬—s
, 0, sÏve->
chªÃls
, sÏve->
bufãr_size
, sÏve->
fÜm©
);

307 ià(
”r
 < 0)

308  
”r
;

309 ià(
¦ave
->
¡İ³d_¬—s
) {

310 
”r
 = 
	`¢d_pcm_¬—s_s’û
(
¦ave
->
¡İ³d_¬—s
, 0, sÏve->
chªÃls
, sÏve->
bufãr_size
, sÏve->
fÜm©
);

311 ià(
”r
 < 0)

312  
”r
;

315 
	}
}

321 
	$»£t_lšks
(
¢d_pcm_muÉi_t
 *
muÉi
)

323 
i
;

325 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

326 ià(
muÉi
->
¦aves
[
i
].
lšked
)

327 
	`¢d_pcm_uÆšk
(
muÉi
->
¦aves
[
i
].
lšked
);

328 
muÉi
->
¦aves
[0].
lšked
 = 
NULL
;

329 ià(! 
i
)

331 ià(
	`¢d_pcm_lšk
(
muÉi
->
¦aves
[0].
pcm
, muÉi->¦aves[
i
].pcm) >= 0)

332 
muÉi
->
¦aves
[
i
].
lšked
 = muÉi->¦aves[0].
pcm
;

334 
	}
}

336 
	$¢d_pcm_muÉi_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

338 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

339 
i
;

340 
¢d_pcm_hw_·¿ms_t
 
¥¬ams
[
muÉi
->
¦aves_couÁ
];

341 
”r
;

342 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

343 
”r
 = 
	`¢d_pcm_muÉi_hw_»fše_¥»·»
(
pcm
, 
i
, &
¥¬ams
[i]);

344 
	`as£¹
(
”r
 >= 0);

345 
”r
 = 
	`¢d_pcm_muÉi_hw_»fše_schªge
(
pcm
, 
i
, 
·¿ms
, &
¥¬ams
[i]);

346 
	`as£¹
(
”r
 >= 0);

347 
”r
 = 
	`¢d_pcm_muÉi_hw_·¿ms_¦ave
(
pcm
, 
i
, &
¥¬ams
[i]);

348 ià(
”r
 < 0) {

349 
	`¢d_pcm_muÉi_hw_»fše_cchªge
(
pcm
, 
i
, 
·¿ms
, &
¥¬ams
[i]);

350  
”r
;

353 
	`»£t_lšks
(
muÉi
);

355 
	}
}

357 
	$¢d_pcm_muÉi_hw_ä“
(
¢d_pcm_t
 *
pcm
)

359 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

360 
i
;

361 
”r
 = 0;

362 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

363 
¢d_pcm_t
 *
¦ave
 = 
muÉi
->
¦aves
[
i
].
pcm
;

364 
e
 = 
	`¢d_pcm_hw_ä“
(
¦ave
);

365 ià(
e
 < 0)

366 
”r
 = 
e
;

367 ià(!
muÉi
->
¦aves
[
i
].
lšked
)

369 
e
 = 
	`¢d_pcm_uÆšk
(
¦ave
);

370 ià(
e
 < 0)

371 
”r
 = 
e
;

372 
muÉi
->
¦aves
[
i
].
lšked
 = 
NULL
;

374  
”r
;

375 
	}
}

377 
	$¢d_pcm_muÉi_sw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
)

379 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

380 
i
;

381 
”r
;

382 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

383 
¢d_pcm_t
 *
¦ave
 = 
muÉi
->
¦aves
[
i
].
pcm
;

384 
”r
 = 
	`¢d_pcm_sw_·¿ms
(
¦ave
, 
·¿ms
);

385 ià(
”r
 < 0)

386  
”r
;

389 
	}
}

391 
¢d_pcm_säames_t
 
¢d_pcm_muÉi_ava_upd©e
(
¢d_pcm_t
 *
pcm
);

392 
	$¢d_pcm_muÉi_¡©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©us_t
 *
¡©us
)

394 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

395 
¢d_pcm_t
 *
¦ave
 = 
muÉi
->
¦aves
[muÉi->
ma¡”_¦ave
].
pcm
;

397 
”r
 = 
	`¢d_pcm_¡©us
(
¦ave
, 
¡©us
);

398 ià(
”r
 < 0)

399  
”r
;

400 
¢d_pcm_säames_t
 
ava
 = 
	`¢d_pcm_muÉi_ava_upd©e
(
pcm
);

401 ià(
ava
 < 0)

402  
ava
;

403 
¡©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

404 
¡©us
->
ava
 =‡vail;

406 
	}
}

408 
¢d_pcm_¡©e_t
 
	$¢d_pcm_muÉi_¡©e
(
¢d_pcm_t
 *
pcm
)

410 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

411 
¢d_pcm_t
 *
¦ave
 = 
muÉi
->
¦aves
[muÉi->
ma¡”_¦ave
].
pcm
;

412  
	`¢d_pcm_¡©e
(
¦ave
);

413 
	}
}

415 
	$¢d_pcm_muÉi_hw±r_upd©e
(
¢d_pcm_t
 *
pcm
)

417 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

418 
¢d_pcm_uäames_t
 
hw_±r
 = 0, 
¦ave_hw_±r
, 
ava
, 
Ï¡_ava
;

419 
i
;

421 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

422 
Ï¡_ava
 = 0;

423 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

424 
¦ave_hw_±r
 = *
muÉi
->
¦aves
[
i
].
pcm
->
hw
.
±r
;

425 
ava
 = 
	`__¢d_pcm_¶ayback_ava
(
pcm
, 
muÉi
->
hw_±r
, 
¦ave_hw_±r
);

426 ià(
ava
 > 
Ï¡_ava
) {

427 
hw_±r
 = 
¦ave_hw_±r
;

428 
Ï¡_ava
 = 
ava
;

432 
Ï¡_ava
 = 
LONG_MAX
;

433 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

434 
¦ave_hw_±r
 = *
muÉi
->
¦aves
[
i
].
pcm
->
hw
.
±r
;

435 
ava
 = 
	`__¢d_pcm_ÿ±u»_ava
(
pcm
, 
muÉi
->
hw_±r
, 
¦ave_hw_±r
);

436 ià(
ava
 < 
Ï¡_ava
) {

437 
hw_±r
 = 
¦ave_hw_±r
;

438 
Ï¡_ava
 = 
ava
;

442 
muÉi
->
hw_±r
 = hw_ptr;

443 
	}
}

445 
	$¢d_pcm_muÉi_hwsync
(
¢d_pcm_t
 *
pcm
)

447 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

448 
i
;

449 
”r
;

450 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

451 
”r
 = 
	`¢d_pcm_hwsync
(
muÉi
->
¦aves
[
i
].
pcm
);

452 ià(
”r
 < 0)

453  
”r
;

455 
	`¢d_pcm_muÉi_hw±r_upd©e
(
pcm
);

457 
	}
}

459 
	$¢d_pcm_muÉi_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
)

461 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

462 
¢d_pcm_säames_t
 
d
, 
dr
 = 0;

463 
i
;

464 
”r
;

465 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

466 
”r
 = 
	`¢d_pcm_d–ay
(
muÉi
->
¦aves
[
i
].
pcm
, &
d
);

467 ià(
”r
 < 0)

468  
”r
;

469 ià(
dr
 < 
d
)

470 
dr
 = 
d
;

472 *
d–ayp
 = 
dr
;

474 
	}
}

476 
¢d_pcm_säames_t
 
	$¢d_pcm_muÉi_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

478 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

479 
¢d_pcm_säames_t
 
»t
 = 
LONG_MAX
;

480 
i
;

481 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

482 
¢d_pcm_säames_t
 
ava
;

483 
ava
 = 
	`¢d_pcm_ava_upd©e
(
muÉi
->
¦aves
[
i
].
pcm
);

484 ià(
ava
 < 0)

485  
ava
;

486 ià(
»t
 > 
ava
)

487 
»t
 = 
ava
;

489 
	`¢d_pcm_muÉi_hw±r_upd©e
(
pcm
);

490  
»t
;

491 
	}
}

493 
	$¢d_pcm_muÉi_htime¡amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 *
ava
,

494 
¢d_htime¡amp_t
 *
t¡amp
)

496 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

497 
¢d_pcm_t
 *
¦ave
 = 
muÉi
->
¦aves
[muÉi->
ma¡”_¦ave
].
pcm
;

498  
	`¢d_pcm_htime¡amp
(
¦ave
, 
ava
, 
t¡amp
);

499 
	}
}

501 
	$¢d_pcm_muÉi_´•¬e
(
¢d_pcm_t
 *
pcm
)

503 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

504 
»suÉ
 = 0, 
”r
;

505 
i
;

506 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

510 
”r
 = 
	`¢d_pcm_´•¬e
(
muÉi
->
¦aves
[
i
].
pcm
);

511 ià(
”r
 < 0)

512 
»suÉ
 = 
”r
;

514 
muÉi
->
hw_±r
 = muÉi->
­¶_±r
 = 0;

515  
»suÉ
;

516 
	}
}

518 
	$¢d_pcm_muÉi_»£t
(
¢d_pcm_t
 *
pcm
)

520 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

521 
»suÉ
 = 0, 
”r
;

522 
i
;

523 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

525 
”r
 = 
	`¢d_pcm_»£t
(
muÉi
->
¦aves
[
i
].
pcm
);

526 ià(
”r
 < 0)

527 
»suÉ
 = 
”r
;

529 
muÉi
->
hw_±r
 = muÉi->
­¶_±r
 = 0;

530  
»suÉ
;

531 
	}
}

537 
	$¢d_pcm_muÉi_¡¬t
(
¢d_pcm_t
 *
pcm
)

539 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

540 
”r
 = 0;

541 
i
;

542 ià(
muÉi
->
¦aves
[0].
lšked
)

543  
	`¢d_pcm_¡¬t
(
muÉi
->
¦aves
[0].
lšked
);

544 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

545 ià(
muÉi
->
¦aves
[
i
].
lšked
)

547 
”r
 = 
	`¢d_pcm_¡¬t
(
muÉi
->
¦aves
[
i
].
pcm
);

548 ià(
”r
 < 0)

549  
”r
;

551  
”r
;

552 
	}
}

554 
	$¢d_pcm_muÉi_drİ
(
¢d_pcm_t
 *
pcm
)

556 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

557 
”r
 = 0;

558 
i
;

559 ià(
muÉi
->
¦aves
[0].
lšked
)

560  
	`¢d_pcm_drİ
(
muÉi
->
¦aves
[0].
lšked
);

561 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

562 ià(
muÉi
->
¦aves
[
i
].
lšked
)

564 
”r
 = 
	`¢d_pcm_drİ
(
muÉi
->
¦aves
[
i
].
pcm
);

565 ià(
”r
 < 0)

566  
”r
;

568  
”r
;

569 
	}
}

571 
	$¢d_pcm_muÉi_d¿š
(
¢d_pcm_t
 *
pcm
)

573 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

574 
”r
 = 0;

575 
i
;

576 ià(
muÉi
->
¦aves
[0].
lšked
)

577  
	`¢d_pcm_d¿š
(
muÉi
->
¦aves
[0].
lšked
);

578 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

579 ià(
muÉi
->
¦aves
[
i
].
lšked
)

581 
”r
 = 
	`¢d_pcm_d¿š
(
muÉi
->
¦aves
[
i
].
pcm
);

582 ià(
”r
 < 0)

583  
”r
;

585  
”r
;

586 
	}
}

588 
	$¢d_pcm_muÉi_·u£
(
¢d_pcm_t
 *
pcm
, 
’abË
)

590 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

591 
”r
 = 0;

592 
i
;

593 ià(
muÉi
->
¦aves
[0].
lšked
)

594  
	`¢d_pcm_·u£
(
muÉi
->
¦aves
[0].
lšked
, 
’abË
);

595 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

596 ià(
muÉi
->
¦aves
[
i
].
lšked
)

598 
”r
 = 
	`¢d_pcm_·u£
(
muÉi
->
¦aves
[
i
].
pcm
, 
’abË
);

599 ià(
”r
 < 0)

600  
”r
;

602  
”r
;

603 
	}
}

605 
	$¢d_pcm_muÉi_chªÃl_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_šfo_t
 *
šfo
)

607 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

608 
chªÃl
 = 
šfo
->channel;

609 
¢d_pcm_muÉi_chªÃl_t
 *
c
 = &
muÉi
->
chªÃls
[
chªÃl
];

610 
”r
;

611 ià(
c
->
¦ave_idx
 < 0)

612  -
ENXIO
;

613 
šfo
->
chªÃl
 = 
c
->
¦ave_chªÃl
;

614 
”r
 = 
	`¢d_pcm_chªÃl_šfo
(
muÉi
->
¦aves
[
c
->
¦ave_idx
].
pcm
, 
šfo
);

615 
šfo
->
chªÃl
 = channel;

616  
”r
;

617 
	}
}

619 
¢d_pcm_säames_t
 
	$¢d_pcm_muÉi_»wšdabË
(
¢d_pcm_t
 *
pcm
)

621 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

622 
i
;

623 
¢d_pcm_säames_t
 
äames
 = 
LONG_MAX
;

625 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

626 
¢d_pcm_säames_t
 
f
 = 
	`¢d_pcm_»wšdabË
(
muÉi
->
¦aves
[
i
].
pcm
);

627 ià(
f
 <= 0)

628  
f
;

629 ià(
f
 < 
äames
)

630 
äames
 = 
f
;

633  
äames
;

635 
	}
}

637 
¢d_pcm_säames_t
 
	$¢d_pcm_muÉi_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
)

639 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

640 
i
;

641 
¢d_pcm_säames_t
 
äames
 = 
LONG_MAX
;

643 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

644 
¢d_pcm_säames_t
 
f
 = 
	`¢d_pcm_fÜw¬dabË
(
muÉi
->
¦aves
[
i
].
pcm
);

645 ià(
f
 <= 0)

646  
f
;

647 ià(
f
 < 
äames
)

648 
äames
 = 
f
;

651  
äames
;

653 
	}
}

655 
¢d_pcm_säames_t
 
	$¢d_pcm_muÉi_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

657 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

658 
i
;

659 
¢d_pcm_uäames_t
 
pos
[
muÉi
->
¦aves_couÁ
];

660 
	`mem£t
(
pos
, 0, (pos));

661 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

662 
¢d_pcm_t
 *
¦ave_i
 = 
muÉi
->
¦aves
[
i
].
pcm
;

663 
¢d_pcm_säames_t
 
f
 = 
	`¢d_pcm_»wšd
(
¦ave_i
, 
äames
);

664 ià(
f
 < 0)

665  
f
;

666 
pos
[
i
] = 
f
;

667 
äames
 = 
f
;

670 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

671 
¢d_pcm_t
 *
¦ave_i
 = 
muÉi
->
¦aves
[
i
].
pcm
;

672 
¢d_pcm_uäames_t
 
f
 = 
pos
[
i
] - 
äames
;

673 
¢d_pcm_säames_t
 
»suÉ
;

674 ià(
f
 > 0) {

675 
»suÉ
 = 
	`INTERNAL
(
¢d_pcm_fÜw¬d
)(
¦ave_i
, 
f
);

676 ià(
»suÉ
 < 0)

677  
»suÉ
;

678 ià((
¢d_pcm_uäames_t
)
»suÉ
 !ğ
f
)

679  -
EIO
;

682 
	`¢d_pcm_mm­_­¶_backw¬d
(
pcm
, 
äames
);

683  
äames
;

684 
	}
}

686 
¢d_pcm_säames_t
 
	$¢d_pcm_muÉi_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

688 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

689 
i
;

690 
¢d_pcm_uäames_t
 
pos
[
muÉi
->
¦aves_couÁ
];

691 
	`mem£t
(
pos
, 0, (pos));

692 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

693 
¢d_pcm_t
 *
¦ave_i
 = 
muÉi
->
¦aves
[
i
].
pcm
;

694 
¢d_pcm_säames_t
 
f
 = 
	`INTERNAL
(
¢d_pcm_fÜw¬d
)(
¦ave_i
, 
äames
);

695 ià(
f
 < 0)

696  
f
;

697 
pos
[
i
] = 
f
;

698 
äames
 = 
f
;

701 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

702 
¢d_pcm_t
 *
¦ave_i
 = 
muÉi
->
¦aves
[
i
].
pcm
;

703 
¢d_pcm_uäames_t
 
f
 = 
pos
[
i
] - 
äames
;

704 
¢d_pcm_säames_t
 
»suÉ
;

705 ià(
f
 > 0) {

706 
»suÉ
 = 
	`¢d_pcm_»wšd
(
¦ave_i
, 
f
);

707 ià(
»suÉ
 < 0)

708  
»suÉ
;

709 ià((
¢d_pcm_uäames_t
)
»suÉ
 !ğ
f
)

710  -
EIO
;

713 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
äames
);

714  
äames
;

715 
	}
}

717 
	$¢d_pcm_muÉi_»sume
(
¢d_pcm_t
 *
pcm
)

719 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

720 
”r
 = 0;

721 
i
;

722 ià(
muÉi
->
¦aves
[0].
lšked
)

723  
	`¢d_pcm_»sume
(
muÉi
->
¦aves
[0].
lšked
);

724 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

725 ià(
muÉi
->
¦aves
[
i
].
lšked
)

727 
”r
 = 
	`¢d_pcm_»sume
(
muÉi
->
¦aves
[
i
].
pcm
);

728 ià(
”r
 < 0)

729  
”r
;

731  
”r
;

732 
	}
}

737 
	$¢d_pcm_muÉi_lšk_¦aves
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ*
ma¡”
)

739 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

740 
i
;

741 
”r
;

743 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

744 
	`¢d_pcm_uÆšk
(
muÉi
->
¦aves
[
i
].
pcm
);

745 
muÉi
->
¦aves
[
i
].
lšked
 = 
NULL
;

746 
”r
 = 
	`¢d_pcm_lšk
(
ma¡”
, 
muÉi
->
¦aves
[
i
].
pcm
);

747 ià(
”r
 < 0) {

748 
	`»£t_lšks
(
muÉi
);

749  
”r
;

751 
muÉi
->
¦aves
[
i
].
lšked
 = 
ma¡”
;

754 
	}
}

759 
	$¢d_pcm_muÉi_lšk
(
¢d_pcm_t
 *
pcm1
, snd_pcm_ˆ*
pcm2
)

761 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm1
->
´iv©e_d©a
;

762 
¢d_pcm_t
 *
maš_pcm
 = 
muÉi
->
¦aves
[0].
pcm
;

763 ià(
maš_pcm
->
ç¡_İs
->
lšk
)

764  
maš_pcm
->
ç¡_İs
->
	`lšk
(maš_pcm->
ç¡_İ_¬g
, 
pcm2
);

765  -
ENOSYS
;

766 
	}
}

768 
	$¢d_pcm_muÉi_uÆšk
(
¢d_pcm_t
 *
pcm
)

770 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

771 
i
;

773 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

774 ià(
muÉi
->
¦aves
[
i
].
lšked
)

775 
	`¢d_pcm_uÆšk
(
muÉi
->
¦aves
[
i
].
lšked
);

776 
muÉi
->
¦aves
[0].
lšked
 = 
NULL
;

779 
	}
}

781 
¢d_pcm_säames_t
 
	$¢d_pcm_muÉi_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

782 
¢d_pcm_uäames_t
 
off£t
,

783 
¢d_pcm_uäames_t
 
size
)

785 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

786 
¢d_pcm_t
 *
¦ave
;

787 
i
;

788 
¢d_pcm_säames_t
 
»suÉ
;

790 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

791 
¦ave
 = 
muÉi
->
¦aves
[
i
].
pcm
;

792 
»suÉ
 = 
	`¢d_pcm_mm­_comm™
(
¦ave
, 
off£t
, 
size
);

793 ià(
»suÉ
 < 0)

794  
»suÉ
;

795 ià((
¢d_pcm_uäames_t
)
»suÉ
 !ğ
size
)

796  -
EIO
;

798 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
size
);

799  
size
;

800 
	}
}

802 
	$¢d_pcm_muÉi_munm­
(
¢d_pcm_t
 *
pcm
)

804 
	`ä“
(
pcm
->
mm­_chªÃls
);

805 
	`ä“
(
pcm
->
ruÂšg_¬—s
);

806 
pcm
->
mm­_chªÃls
 = 
NULL
;

807 
pcm
->
ruÂšg_¬—s
 = 
NULL
;

809 
	}
}

811 
	$¢d_pcm_muÉi_mm­
(
¢d_pcm_t
 *
pcm
)

813 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

814 
c
;

816 
pcm
->
mm­_chªÃls
 = 
	`ÿÎoc
Õcm->
chªÃls
,

817 (
pcm
->
mm­_chªÃls
[0]));

818 
pcm
->
ruÂšg_¬—s
 = 
	`ÿÎoc
Õcm->
chªÃls
,

819 (
pcm
->
ruÂšg_¬—s
[0]));

820 ià(!
pcm
->
mm­_chªÃls
 || !pcm->
ruÂšg_¬—s
) {

821 
	`¢d_pcm_muÉi_munm­
(
pcm
);

822  -
ENOMEM
;

826 
c
 = 0; c < 
pcm
->
chªÃls
; c++) {

827 
¢d_pcm_muÉi_chªÃl_t
 *
chª
 = &
muÉi
->
chªÃls
[
c
];

828 
¢d_pcm_t
 *
¦ave
;

829 ià(
chª
->
¦ave_idx
 < 0) {

830 
	`¢d_pcm_muÉi_munm­
(
pcm
);

831  -
ENXIO
;

833 
¦ave
 = 
muÉi
->
¦aves
[
chª
->
¦ave_idx
].
pcm
;

834 
pcm
->
mm­_chªÃls
[
c
] =

835 
¦ave
->
mm­_chªÃls
[
chª
->
¦ave_chªÃl
];

836 
pcm
->
mm­_chªÃls
[
c
].
chªÃl
 = c;

837 
pcm
->
ruÂšg_¬—s
[
c
] =

838 
¦ave
->
ruÂšg_¬—s
[
chª
->
¦ave_chªÃl
];

841 
	}
}

843 
	$¢d_pcm_muÉi_may_wa™_fÜ_ava_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
ava
)

845 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

846 
i
;

847 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; ++i) {

848 ià(
	`¢d_pcm_may_wa™_fÜ_ava_mš
(
muÉi
->
¦aves
[
i
].
pcm
, 
ava
))

852 
	}
}

854 
¢d_pcm_chm­_qu”y_t
 **
	$¢d_pcm_muÉi_qu”y_chm­s
(
¢d_pcm_t
 *
pcm
)

856 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

857 
¢d_pcm_chm­_qu”y_t
 **
¦ave_m­s
[
muÉi
->
¦aves_couÁ
];

858 
¢d_pcm_chm­_qu”y_t
 **
m­s
;

859 
i
;

860 
”r
 = -
ENOMEM
;

862 
	`mem£t
(
¦ave_m­s
, 0, (slave_maps));

863 
m­s
 = 
	`ÿÎoc
(2, (*maps));

864 ià(!
m­s
)

865  
NULL
;

866 
m­s
[0] = 
	`ÿÎoc
(
muÉi
->
chªÃls_couÁ
 + 2, (*));

867 ià(!
m­s
[0])

868 
”rÜ
;

869 
m­s
[0]->
ty³
 = 
SND_CHMAP_TYPE_FIXED
;

870 
m­s
[0]->
m­
.
chªÃls
 = 
muÉi
->
chªÃls_couÁ
;

872 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; i++) {

873 
¦ave_m­s
[
i
] = 
	`¢d_pcm_qu”y_chm­s
(
muÉi
->
¦aves
[i].
pcm
);

874 ià(!
¦ave_m­s
[
i
])

875 
”rÜ
;

878 
i
 = 0; i < 
muÉi
->
chªÃls_couÁ
; i++) {

879 
¢d_pcm_muÉi_chªÃl_t
 *
bšd
 = &
muÉi
->
chªÃls
[
i
];

880 
¦ave_chªÃls
 =

881 
muÉi
->
¦aves
[
bšd
->
¦ave_idx
].
chªÃls_couÁ
;

882 
¢d_pcm_chm­_qu”y_t
 **
p
;

884 
p
 = 
¦ave_m­s
[
bšd
->
¦ave_idx
]; *p;…++) {

885 ià((*
p
)->
m­
.
chªÃls
 =ğ
¦ave_chªÃls
) {

886 
m­s
[0]->
m­
.
pos
[
i
] =

887 (*
p
)->
m­
.
pos
[
bšd
->
¦ave_chªÃl
];

892 
”r
 = 0;

894 
”rÜ
:

895 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; i++) {

896 ià(
¦ave_m­s
[
i
])

897 
	`¢d_pcm_ä“_chm­s
(
¦ave_m­s
[
i
]);

900 ià(
”r
) {

901 
	`¢d_pcm_ä“_chm­s
(
m­s
);

902  
NULL
;

905  
m­s
;

906 
	}
}

908 
¢d_pcm_chm­_t
 *
	$¢d_pcm_muÉi_g‘_chm­
(
¢d_pcm_t
 *
pcm
)

910 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

911 
¢d_pcm_chm­_t
 *
m­
;

912 
¢d_pcm_chm­_t
 *
¦ave_m­s
[
muÉi
->
¦aves_couÁ
];

913 
i
;

914 
”r
 = -
ENOMEM
;

916 
	`mem£t
(
¦ave_m­s
, 0, (slave_maps));

917 
m­
 = 
	`ÿÎoc
(
muÉi
->
chªÃls_couÁ
 + 1, ());

918 ià(!
m­
)

919  
NULL
;

921 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; i++) {

922 
¦ave_m­s
[
i
] = 
	`¢d_pcm_g‘_chm­
(
muÉi
->
¦aves
[i].
pcm
);

923 ià(!
¦ave_m­s
[
i
])

924 
”rÜ
;

927 
m­
->
chªÃls
 = 
muÉi
->
chªÃls_couÁ
;

928 
i
 = 0; i < 
muÉi
->
chªÃls_couÁ
; i++) {

929 
¢d_pcm_muÉi_chªÃl_t
 *
bšd
 = &
muÉi
->
chªÃls
[
i
];

930 
m­
->
pos
[
i
] = 
¦ave_m­s
[
bšd
->
¦ave_idx
]->pos[bšd->
¦ave_chªÃl
];

932 
”r
 = 0;

934 
”rÜ
:

935 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; i++)

936 
	`ä“
(
¦ave_m­s
[
i
]);

938 ià(
”r
) {

939 
	`ä“
(
m­
);

940  
NULL
;

943  
m­
;

944 
	}
}

946 
	$¢d_pcm_muÉi_£t_chm­
(
¢d_pcm_t
 *
pcm
, cÚ¡ 
¢d_pcm_chm­_t
 *
m­
)

948 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

949 
¢d_pcm_chm­_t
 *
¦ave_m­s
[
muÉi
->
¦aves_couÁ
];

950 
i
;

951 
”r
 = 0;

953 ià(
m­
->
chªÃls
 !ğ
muÉi
->
chªÃls_couÁ
)

954  -
EINVAL
;

956 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; i++) {

957 
¦ave_m­s
[
i
] = 
	`ÿÎoc
(
muÉi
->
¦aves
[i].
chªÃls_couÁ
 + 1,

959 ià(!
¦ave_m­s
[
i
]) {

960 
i
++; i < 
muÉi
->
¦aves_couÁ
; i++)

961 
¦ave_m­s
[
i
] = 
NULL
;

962 
”r
 = -
ENOMEM
;

963 
”rÜ
;

967 
i
 = 0; i < 
muÉi
->
chªÃls_couÁ
; i++) {

968 
¢d_pcm_muÉi_chªÃl_t
 *
bšd
 = &
muÉi
->
chªÃls
[
i
];

969 
¦ave_m­s
[
bšd
->
¦ave_idx
]->
pos
[bšd->
¦ave_chªÃl
] =

970 
m­
->
pos
[
i
];

973 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; i++) {

974 
”r
 = 
	`¢d_pcm_£t_chm­
(
muÉi
->
¦aves
[
i
].
pcm
, 
¦ave_m­s
[i]);

975 ià(
”r
 < 0)

976 
”rÜ
;

979 
”rÜ
:

980 
i
 = 0; i < 
muÉi
->
¦aves_couÁ
; i++)

981 
	`ä“
(
¦ave_m­s
[
i
]);

983  
”r
;

984 
	}
}

986 
	$¢d_pcm_muÉi_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

988 
¢d_pcm_muÉi_t
 *
muÉi
 = 
pcm
->
´iv©e_d©a
;

989 
k
;

990 
	`¢d_ouut_´štf
(
out
, "Multi PCM\n");

991 
	`¢d_ouut_´štf
(
out
, " Channel bindings:\n");

992 
k
 = 0; k < 
muÉi
->
chªÃls_couÁ
; ++k) {

993 
¢d_pcm_muÉi_chªÃl_t
 *
c
 = &
muÉi
->
chªÃls
[
k
];

994 ià(
c
->
¦ave_idx
 < 0)

996 
	`¢d_ouut_´štf
(
out
, " %d: slave %d, channel %d\n",

997 
k
, 
c
->
¦ave_idx
, c->
¦ave_chªÃl
);

999 ià(
pcm
->
£tup
) {

1000 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

1001 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

1003 
k
 = 0; k < 
muÉi
->
¦aves_couÁ
; ++k) {

1004 
	`¢d_ouut_´štf
(
out
, "SÏv#%d: ", 
k
);

1005 
	`¢d_pcm_dump
(
muÉi
->
¦aves
[
k
].
pcm
, 
out
);

1007 
	}
}

1009 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_muÉi_İs
 = {

1010 .
şo£
 = 
¢d_pcm_muÉi_şo£
,

1011 .
	gšfo
 = 
¢d_pcm_muÉi_šfo
,

1012 .
	ghw_»fše
 = 
¢d_pcm_muÉi_hw_»fše
,

1013 .
	ghw_·¿ms
 = 
¢d_pcm_muÉi_hw_·¿ms
,

1014 .
	ghw_ä“
 = 
¢d_pcm_muÉi_hw_ä“
,

1015 .
	gsw_·¿ms
 = 
¢d_pcm_muÉi_sw_·¿ms
,

1016 .
	gchªÃl_šfo
 = 
¢d_pcm_muÉi_chªÃl_šfo
,

1017 .
	gdump
 = 
¢d_pcm_muÉi_dump
,

1018 .
	gnÚblock
 = 
¢d_pcm_muÉi_nÚblock
,

1019 .
	gasync
 = 
¢d_pcm_muÉi_async
,

1020 .
	gmm­
 = 
¢d_pcm_muÉi_mm­
,

1021 .
	gmunm­
 = 
¢d_pcm_muÉi_munm­
,

1022 .
	gqu”y_chm­s
 = 
¢d_pcm_muÉi_qu”y_chm­s
,

1023 .
	gg‘_chm­
 = 
¢d_pcm_muÉi_g‘_chm­
,

1024 .
	g£t_chm­
 = 
¢d_pcm_muÉi_£t_chm­
,

1027 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_muÉi_ç¡_İs
 = {

1028 .
¡©us
 = 
¢d_pcm_muÉi_¡©us
,

1029 .
	g¡©e
 = 
¢d_pcm_muÉi_¡©e
,

1030 .
	ghwsync
 = 
¢d_pcm_muÉi_hwsync
,

1031 .
	gd–ay
 = 
¢d_pcm_muÉi_d–ay
,

1032 .
	g´•¬e
 = 
¢d_pcm_muÉi_´•¬e
,

1033 .
	g»£t
 = 
¢d_pcm_muÉi_»£t
,

1034 .
	g¡¬t
 = 
¢d_pcm_muÉi_¡¬t
,

1035 .
	gdrİ
 = 
¢d_pcm_muÉi_drİ
,

1036 .
	gd¿š
 = 
¢d_pcm_muÉi_d¿š
,

1037 .
	g·u£
 = 
¢d_pcm_muÉi_·u£
,

1038 .
	gwr™ei
 = 
¢d_pcm_mm­_wr™ei
,

1039 .
	gwr™’
 = 
¢d_pcm_mm­_wr™’
,

1040 .
	g»adi
 = 
¢d_pcm_mm­_»adi
,

1041 .
	g»adn
 = 
¢d_pcm_mm­_»adn
,

1042 .
	g»wšdabË
 = 
¢d_pcm_muÉi_»wšdabË
,

1043 .
	g»wšd
 = 
¢d_pcm_muÉi_»wšd
,

1044 .
	gfÜw¬dabË
 = 
¢d_pcm_muÉi_fÜw¬dabË
,

1045 .
	gfÜw¬d
 = 
¢d_pcm_muÉi_fÜw¬d
,

1046 .
	g»sume
 = 
¢d_pcm_muÉi_»sume
,

1047 .
	glšk
 = 
¢d_pcm_muÉi_lšk
,

1048 .
	glšk_¦aves
 = 
¢d_pcm_muÉi_lšk_¦aves
,

1049 .
	guÆšk
 = 
¢d_pcm_muÉi_uÆšk
,

1050 .
	gava_upd©e
 = 
¢d_pcm_muÉi_ava_upd©e
,

1051 .
	gmm­_comm™
 = 
¢d_pcm_muÉi_mm­_comm™
,

1052 .
	ghtime¡amp
 = 
¢d_pcm_muÉi_htime¡amp
,

1053 .
	gpŞl_desütÜs_couÁ
 = 
¢d_pcm_muÉi_pŞl_desütÜs_couÁ
,

1054 .
	gpŞl_desütÜs
 = 
¢d_pcm_muÉi_pŞl_desütÜs
,

1055 .
	gpŞl_»v’ts
 = 
¢d_pcm_muÉi_pŞl_»v’ts
,

1056 .
	gmay_wa™_fÜ_ava_mš
 = 
¢d_pcm_muÉi_may_wa™_fÜ_ava_mš
,

1076 
	$¢d_pcm_muÉi_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1077 
¦aves_couÁ
, 
ma¡”_¦ave
,

1078 
¢d_pcm_t
 **
¦aves_pcm
, *
schªÃls_couÁ
,

1079 
chªÃls_couÁ
,

1080 *
sidxs
, *
schªÃls
,

1081 
şo£_¦aves
)

1083 
¢d_pcm_t
 *
pcm
;

1084 
¢d_pcm_muÉi_t
 *
muÉi
;

1085 
i
;

1086 
¢d_pcm_¡»am_t
 
¡»am
;

1087 
”r
;

1089 
	`as£¹
(
pcmp
);

1090 
	`as£¹
(
¦aves_couÁ
 > 0 && 
¦aves_pcm
 && 
schªÃls_couÁ
);

1091 
	`as£¹
(
chªÃls_couÁ
 > 0 && 
sidxs
 && 
schªÃls
);

1092 
	`as£¹
(
ma¡”_¦ave
 < 
¦aves_couÁ
);

1094 
muÉi
 = 
	`ÿÎoc
(1, (
¢d_pcm_muÉi_t
));

1095 ià(!
muÉi
) {

1096  -
ENOMEM
;

1099 
¡»am
 = 
¦aves_pcm
[0]->stream;

1101 
muÉi
->
¦aves_couÁ
 = slaves_count;

1102 
muÉi
->
ma¡”_¦ave
 = master_slave;

1103 
muÉi
->
¦aves
 = 
	`ÿÎoc
(
¦aves_couÁ
, (*multi->slaves));

1104 ià(!
muÉi
->
¦aves
) {

1105 
	`ä“
(
muÉi
);

1106  -
ENOMEM
;

1108 
muÉi
->
chªÃls_couÁ
 = channels_count;

1109 
muÉi
->
chªÃls
 = 
	`ÿÎoc
(
chªÃls_couÁ
, (*multi->channels));

1110 ià(!
muÉi
->
chªÃls
) {

1111 
	`ä“
(
muÉi
->
¦aves
);

1112 
	`ä“
(
muÉi
);

1113  -
ENOMEM
;

1115 
i
 = 0; i < 
¦aves_couÁ
; ++i) {

1116 
¢d_pcm_muÉi_¦ave_t
 *
¦ave
 = &
muÉi
->
¦aves
[
i
];

1117 
	`as£¹
(
¦aves_pcm
[
i
]->
¡»am
 == stream);

1118 
¦ave
->
pcm
 = 
¦aves_pcm
[
i
];

1119 
¦ave
->
chªÃls_couÁ
 = 
schªÃls_couÁ
[
i
];

1120 
¦ave
->
şo£_¦ave
 = 
şo£_¦aves
;

1122 
i
 = 0; i < 
chªÃls_couÁ
; ++i) {

1123 
¢d_pcm_muÉi_chªÃl_t
 *
bšd
 = &
muÉi
->
chªÃls
[
i
];

1124 
	`as£¹
(
sidxs
[
i
] < ()
¦aves_couÁ
);

1125 
	`as£¹
(
schªÃls
[
i
] < 
schªÃls_couÁ
[
sidxs
[i]]);

1126 
bšd
->
¦ave_idx
 = 
sidxs
[
i
];

1127 
bšd
->
¦ave_chªÃl
 = 
schªÃls
[
i
];

1128 ià(
sidxs
[
i
] < 0)

1131 
muÉi
->
chªÃls_couÁ
 = channels_count;

1133 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_MULTI
, 
Çme
, 
¡»am
,

1134 
muÉi
->
¦aves
[0].
pcm
->
mode
);

1135 ià(
”r
 < 0) {

1136 
	`ä“
(
muÉi
->
¦aves
);

1137 
	`ä“
(
muÉi
->
chªÃls
);

1138 
	`ä“
(
muÉi
);

1139  
”r
;

1141 
pcm
->
mm­_rw
 = 1;

1142 
pcm
->
mm­_shadow
 = 1;

1143 
pcm
->
İs
 = &
¢d_pcm_muÉi_İs
;

1144 
pcm
->
ç¡_İs
 = &
¢d_pcm_muÉi_ç¡_İs
;

1145 
pcm
->
´iv©e_d©a
 = 
muÉi
;

1146 
pcm
->
pŞl_fd
 = 
muÉi
->
¦aves
[
ma¡”_¦ave
].pcm->poll_fd;

1147 
pcm
->
pŞl_ev’ts
 = 
muÉi
->
¦aves
[
ma¡”_¦ave
].pcm->poll_events;

1148 
pcm
->
t¡amp_ty³
 = 
muÉi
->
¦aves
[
ma¡”_¦ave
].pcm->tstamp_type;

1149 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
muÉi
->
hw_±r
, -1, 0);

1150 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
muÉi
->
­¶_±r
, -1, 0);

1151 *
pcmp
 = 
pcm
;

1153 
	}
}

1243 
	$_¢d_pcm_muÉi_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1244 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

1245 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

1247 
¢d_cÚfig_™”©Ü_t
 
i
, 
šext
, 
j
, 
jÃxt
;

1248 
¢d_cÚfig_t
 *
¦aves
 = 
NULL
;

1249 
¢d_cÚfig_t
 *
bšdšgs
 = 
NULL
;

1250 
”r
;

1251 
idx
;

1252 cÚ¡ **
¦aves_id
 = 
NULL
;

1253 
¢d_cÚfig_t
 **
¦aves_cÚf
 = 
NULL
;

1254 
¢d_pcm_t
 **
¦aves_pcm
 = 
NULL
;

1255 *
¦aves_chªÃls
 = 
NULL
;

1256 *
chªÃls_sidx
 = 
NULL
;

1257 *
chªÃls_schªÃl
 = 
NULL
;

1258 
¦aves_couÁ
 = 0;

1259 
ma¡”_¦ave
 = 0;

1260 
chªÃls_couÁ
 = 0;

1261 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
šext
, 
cÚf
) {

1262 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1263 cÚ¡ *
id
;

1264 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1266 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

1268 ià(
	`¡rcmp
(
id
, "slaves") == 0) {

1269 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1270 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1271  -
EINVAL
;

1273 
¦aves
 = 
n
;

1276 ià(
	`¡rcmp
(
id
, "bindings") == 0) {

1277 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1278 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1279  -
EINVAL
;

1281 
bšdšgs
 = 
n
;

1284 ià(
	`¡rcmp
(
id
, "master") == 0) {

1285 ià(
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
ma¡”_¦ave
) < 0) {

1286 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1287  -
EINVAL
;

1291 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

1292  -
EINVAL
;

1294 ià(!
¦aves
) {

1295 
	`SNDERR
("slaves is‚ot defined");

1296  -
EINVAL
;

1298 ià(!
bšdšgs
) {

1299 
	`SNDERR
("bindings is‚ot defined");

1300  -
EINVAL
;

1302 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
šext
, 
¦aves
) {

1303 ++
¦aves_couÁ
;

1305 ià(
ma¡”_¦ave
 < 0 || ma¡”_¦av>ğ()
¦aves_couÁ
) {

1306 
	`SNDERR
("Ma¡” sÏvi ouˆoà¿ng(0-%u)", 
¦aves_couÁ
-1);

1307  -
EINVAL
;

1309 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
šext
, 
bšdšgs
) {

1310 
cchªÃl
;

1311 
¢d_cÚfig_t
 *
m
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1312 cÚ¡ *
id
;

1313 ià(
	`¢d_cÚfig_g‘_id
(
m
, &
id
) < 0)

1315 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
cchªÃl
);

1316 ià(
”r
 < 0 || 
cchªÃl
 < 0) {

1317 
	`SNDERR
("Inv®id chªÃÈnumb”: %s", 
id
);

1318  -
EINVAL
;

1320 ià(()
cchªÃl
 >ğ
chªÃls_couÁ
)

1321 
chªÃls_couÁ
 = 
cchªÃl
 + 1;

1323 ià(
chªÃls_couÁ
 == 0) {

1324 
	`SNDERR
("No channels defined");

1325  -
EINVAL
;

1327 
¦aves_id
 = 
	`ÿÎoc
(
¦aves_couÁ
, (*slaves_id));

1328 
¦aves_cÚf
 = 
	`ÿÎoc
(
¦aves_couÁ
, (*slaves_conf));

1329 
¦aves_pcm
 = 
	`ÿÎoc
(
¦aves_couÁ
, (*slaves_pcm));

1330 
¦aves_chªÃls
 = 
	`ÿÎoc
(
¦aves_couÁ
, (*slaves_channels));

1331 
chªÃls_sidx
 = 
	`ÿÎoc
(
chªÃls_couÁ
, (*channels_sidx));

1332 
chªÃls_schªÃl
 = 
	`ÿÎoc
(
chªÃls_couÁ
, (*channels_schannel));

1333 ià(!
¦aves_id
 || !
¦aves_cÚf
 || !
¦aves_pcm
 || !
¦aves_chªÃls
 ||

1334 !
chªÃls_sidx
 || !
chªÃls_schªÃl
) {

1335 
”r
 = -
ENOMEM
;

1336 
_ä“
;

1338 
idx
 = 0; idx < 
chªÃls_couÁ
; ++idx)

1339 
chªÃls_sidx
[
idx
] = -1;

1340 
idx
 = 0;

1341 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
šext
, 
¦aves
) {

1342 
¢d_cÚfig_t
 *
m
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1343 cÚ¡ *
id
;

1344 
chªÃls
;

1345 ià(
	`¢d_cÚfig_g‘_id
(
m
, &
id
) < 0)

1347 
¦aves_id
[
idx
] = 
id
;

1348 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
m
, &
¦aves_cÚf
[
idx
], 1,

1349 
SND_PCM_HW_PARAM_CHANNELS
, 
SCONF_MANDATORY
, &
chªÃls
);

1350 ià(
”r
 < 0)

1351 
_ä“
;

1352 
¦aves_chªÃls
[
idx
] = 
chªÃls
;

1353 ++
idx
;

1356 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
šext
, 
bšdšgs
) {

1357 
¢d_cÚfig_t
 *
m
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1358 
cchªÃl
 = -1;

1359 
schªÃl
 = -1;

1360 
¦ave
 = -1;

1361 
v®
;

1362 cÚ¡ *
¡r
;

1363 cÚ¡ *
id
;

1364 ià(
	`¢d_cÚfig_g‘_id
(
m
, &
id
) < 0)

1366 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
cchªÃl
);

1367 ià(
”r
 < 0 || 
cchªÃl
 < 0) {

1368 
	`SNDERR
("Inv®id chªÃÈnumb”: %s", 
id
);

1369 
”r
 = -
EINVAL
;

1370 
_ä“
;

1372 
	`¢d_cÚfig_fÜ_—ch
(
j
, 
jÃxt
, 
m
) {

1373 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
j
);

1374 cÚ¡ *
id
;

1375 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1377 ià(
	`¡rcmp
(
id
, "comment") == 0)

1379 ià(
	`¡rcmp
(
id
, "slave") == 0) {

1380 
buf
[32];

1381 
k
;

1382 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
);

1383 ià(
”r
 < 0) {

1384 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v®
);

1385 ià(
”r
 < 0) {

1386 
	`SNDERR
("Inv®id v®ufÜ %s", 
id
);

1387 
_ä“
;

1389 
	`¥rštf
(
buf
, "%ld", 
v®
);

1390 
¡r
 = 
buf
;

1392 
k
 = 0; k < 
¦aves_couÁ
; ++k) {

1393 ià(
	`¡rcmp
(
¦aves_id
[
k
], 
¡r
) == 0)

1394 
¦ave
 = 
k
;

1398 ià(
	`¡rcmp
(
id
, "channel") == 0) {

1399 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
schªÃl
);

1400 ià(
”r
 < 0) {

1401 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1402 
_ä“
;

1406 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

1407 
”r
 = -
EINVAL
;

1408 
_ä“
;

1410 ià(
¦ave
 < 0 || ()¦av>ğ
¦aves_couÁ
) {

1411 
	`SNDERR
("Inv®id o¸missšg sidx fÜ chªÃÈ%s", 
id
);

1412 
”r
 = -
EINVAL
;

1413 
_ä“
;

1415 ià(
schªÃl
 < 0 ||

1416 (è
schªÃl
 >ğ
¦aves_chªÃls
[
¦ave
]) {

1417 
	`SNDERR
("Inv®id o¸missšg schªÃÈfÜ chªÃÈ%s", 
id
);

1418 
”r
 = -
EINVAL
;

1419 
_ä“
;

1421 
chªÃls_sidx
[
cchªÃl
] = 
¦ave
;

1422 
chªÃls_schªÃl
[
cchªÃl
] = 
schªÃl
;

1425 
idx
 = 0; idx < 
¦aves_couÁ
; ++idx) {

1426 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¦aves_pcm
[
idx
], 
roÙ
,

1427 
¦aves_cÚf
[
idx
], 
¡»am
, 
mode
,

1428 
cÚf
);

1429 ià(
”r
 < 0)

1430 
_ä“
;

1431 
	`¢d_cÚfig_d–‘e
(
¦aves_cÚf
[
idx
]);

1432 
¦aves_cÚf
[
idx
] = 
NULL
;

1434 
”r
 = 
	`¢d_pcm_muÉi_İ’
(
pcmp
, 
Çme
, 
¦aves_couÁ
, 
ma¡”_¦ave
,

1435 
¦aves_pcm
, 
¦aves_chªÃls
,

1436 
chªÃls_couÁ
,

1437 
chªÃls_sidx
, 
chªÃls_schªÃl
,

1439 
_ä“
:

1440 ià(
”r
 < 0) {

1441 
idx
 = 0; idx < 
¦aves_couÁ
; ++idx) {

1442 ià(
¦aves_pcm
[
idx
])

1443 
	`¢d_pcm_şo£
(
¦aves_pcm
[
idx
]);

1446 ià(
¦aves_cÚf
) {

1447 
idx
 = 0; idx < 
¦aves_couÁ
; ++idx) {

1448 ià(
¦aves_cÚf
[
idx
])

1449 
	`¢d_cÚfig_d–‘e
(
¦aves_cÚf
[
idx
]);

1451 
	`ä“
(
¦aves_cÚf
);

1453 
	`ä“
(
¦aves_pcm
);

1454 
	`ä“
(
¦aves_chªÃls
);

1455 
	`ä“
(
chªÃls_sidx
);

1456 
	`ä“
(
chªÃls_schªÃl
);

1457 
	`ä“
(
¦aves_id
);

1458  
”r
;

1459 
	}
}

1460 #iâdeà
DOC_HIDDEN


1461 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_muÉi_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_null.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_¶ugš.h
"

31 
	~"bsw­.h
"

32 
	~<lim™s.h
>

34 #iâdeà
PIC


36 cÚ¡ *
	g_¢d_moduË_pcm_nuÎ
 = "";

39 #iâdeà
DOC_HIDDEN


41 
¢d_htime¡amp_t
 
	mŒigg”_t¡amp
;

42 
¢d_pcm_¡©e_t
 
	m¡©e
;

43 
¢d_pcm_uäames_t
 
	m­¶_±r
;

44 
¢d_pcm_uäames_t
 
	mhw_±r
;

45 
	mpŞl_fd
;

46 
¢d_pcm_chm­_qu”y_t
 **
	mchm­
;

47 } 
	t¢d_pcm_nuÎ_t
;

50 
	$¢d_pcm_nuÎ_şo£
(
¢d_pcm_t
 *
pcm
)

52 
¢d_pcm_nuÎ_t
 *
nuÎ
 = 
pcm
->
´iv©e_d©a
;

53 
	`şo£
(
nuÎ
->
pŞl_fd
);

54 
	`ä“
(
nuÎ
);

56 
	}
}

58 
	$¢d_pcm_nuÎ_nÚblock
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
nÚblock
 ATTRIBUTE_UNUSED)

61 
	}
}

63 
	$¢d_pcm_nuÎ_async
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
sig
 ATTRIBUTE_UNUSED, 
pid_t
 
pid
 ATTRIBUTE_UNUSED)

65  -
ENOSYS
;

66 
	}
}

68 
	$¢d_pcm_nuÎ_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_šfo_t
 * 
šfo
)

70 
	`mem£t
(
šfo
, 0, (*info));

71 
šfo
->
¡»am
 = 
pcm
->stream;

72 
šfo
->
ÿrd
 = -1;

73 ià(
pcm
->
Çme
) {

74 
	`¢d_¡¾ıy
((*)
šfo
->
id
, 
pcm
->
Çme
, (info->id));

75 
	`¢d_¡¾ıy
((*)
šfo
->
Çme
, 
pcm
->name, (info->name));

76 
	`¢d_¡¾ıy
((*)
šfo
->
subÇme
, 
pcm
->
Çme
, (info->subname));

78 
šfo
->
subdeviûs_couÁ
 = 1;

80 
	}
}

82 
¢d_pcm_säames_t
 
	$¢d_pcm_nuÎ_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

84 
¢d_pcm_nuÎ_t
 *
nuÎ
 = 
pcm
->
´iv©e_d©a
;

85 ià(
nuÎ
->
¡©e
 =ğ
SND_PCM_STATE_PREPARED
) {

88  
	`¢d_pcm_mm­_ava
(
pcm
);

90  
pcm
->
bufãr_size
;

91 
	}
}

93 
	$¢d_pcm_nuÎ_¡©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©us_t
 * 
¡©us
)

95 
¢d_pcm_nuÎ_t
 *
nuÎ
 = 
pcm
->
´iv©e_d©a
;

96 
	`mem£t
(
¡©us
, 0, (*status));

97 
¡©us
->
¡©e
 = 
nuÎ
->state;

98 
¡©us
->
Œigg”_t¡amp
 = 
nuÎ
->trigger_tstamp;

99 
¡©us
->
­¶_±r
 = *
pcm
->
­¶
.
±r
;

100 
¡©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

101 
	`g‘time¡amp
(&
¡©us
->
t¡amp
, 
pcm
->
t¡amp_ty³
);

102 
¡©us
->
ava
 = 
	`¢d_pcm_nuÎ_ava_upd©e
(
pcm
);

103 
¡©us
->
ava_max
 = 
pcm
->
bufãr_size
;

105 
	}
}

107 
¢d_pcm_¡©e_t
 
	$¢d_pcm_nuÎ_¡©e
(
¢d_pcm_t
 *
pcm
)

109 
¢d_pcm_nuÎ_t
 *
nuÎ
 = 
pcm
->
´iv©e_d©a
;

110  
nuÎ
->
¡©e
;

111 
	}
}

113 
	$¢d_pcm_nuÎ_hwsync
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

116 
	}
}

118 
	$¢d_pcm_nuÎ_d–ay
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_säames_t
 *
d–ayp
)

120 *
d–ayp
 = 0;

122 
	}
}

124 
	$¢d_pcm_nuÎ_»£t
(
¢d_pcm_t
 *
pcm
)

126 *
pcm
->
­¶
.
±r
 = 0;

127 *
pcm
->
hw
.
±r
 = 0;

129 
	}
}

131 
	$¢d_pcm_nuÎ_´•¬e
(
¢d_pcm_t
 *
pcm
)

133 
¢d_pcm_nuÎ_t
 *
nuÎ
 = 
pcm
->
´iv©e_d©a
;

134 
nuÎ
->
¡©e
 = 
SND_PCM_STATE_PREPARED
;

135  
	`¢d_pcm_nuÎ_»£t
(
pcm
);

136 
	}
}

138 
	$¢d_pcm_nuÎ_¡¬t
(
¢d_pcm_t
 *
pcm
)

140 
¢d_pcm_nuÎ_t
 *
nuÎ
 = 
pcm
->
´iv©e_d©a
;

141 
	`as£¹
(
nuÎ
->
¡©e
 =ğ
SND_PCM_STATE_PREPARED
);

142 
nuÎ
->
¡©e
 = 
SND_PCM_STATE_RUNNING
;

143 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
)

144 *
pcm
->
hw
.
±r
 = *pcm->
­¶
.±¸+…cm->
bufãr_size
;

146 *
pcm
->
hw
.
±r
 = *pcm->
­¶
.ptr;

148 
	}
}

150 
	$¢d_pcm_nuÎ_drİ
(
¢d_pcm_t
 *
pcm
)

152 
¢d_pcm_nuÎ_t
 *
nuÎ
 = 
pcm
->
´iv©e_d©a
;

153 
	`as£¹
(
nuÎ
->
¡©e
 !ğ
SND_PCM_STATE_OPEN
);

154 
nuÎ
->
¡©e
 = 
SND_PCM_STATE_SETUP
;

156 
	}
}

158 
	$¢d_pcm_nuÎ_d¿š
(
¢d_pcm_t
 *
pcm
)

160 
¢d_pcm_nuÎ_t
 *
nuÎ
 = 
pcm
->
´iv©e_d©a
;

161 
	`as£¹
(
nuÎ
->
¡©e
 !ğ
SND_PCM_STATE_OPEN
);

162 
nuÎ
->
¡©e
 = 
SND_PCM_STATE_SETUP
;

164 
	}
}

166 
	$¢d_pcm_nuÎ_·u£
(
¢d_pcm_t
 *
pcm
, 
’abË
)

168 
¢d_pcm_nuÎ_t
 *
nuÎ
 = 
pcm
->
´iv©e_d©a
;

169 ià(
’abË
) {

170 ià(
nuÎ
->
¡©e
 !ğ
SND_PCM_STATE_RUNNING
)

171  -
EBADFD
;

172 
nuÎ
->
¡©e
 = 
SND_PCM_STATE_PAUSED
;

174 ià(
nuÎ
->
¡©e
 !ğ
SND_PCM_STATE_PAUSED
)

175  -
EBADFD
;

176 
nuÎ
->
¡©e
 = 
SND_PCM_STATE_RUNNING
;

179 
	}
}

181 
¢d_pcm_säames_t
 
	$¢d_pcm_nuÎ_»wšdabË
(
¢d_pcm_t
 *
pcm
)

183  
pcm
->
bufãr_size
;

184 
	}
}

186 
¢d_pcm_säames_t
 
	$¢d_pcm_nuÎ_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

189 
	}
}

192 
¢d_pcm_säames_t
 
	$¢d_pcm_nuÎ_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

194 
¢d_pcm_nuÎ_t
 *
nuÎ
 = 
pcm
->
´iv©e_d©a
;

195 
nuÎ
->
¡©e
) {

196 
SND_PCM_STATE_RUNNING
:

197 
	`¢d_pcm_mm­_hw_backw¬d
(
pcm
, 
äames
);

199 
SND_PCM_STATE_PREPARED
:

200 
	`¢d_pcm_mm­_­¶_backw¬d
(
pcm
, 
äames
);

201  
äames
;

203  -
EBADFD
;

205 
	}
}

207 
¢d_pcm_säames_t
 
	$¢d_pcm_nuÎ_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

209 
¢d_pcm_nuÎ_t
 *
nuÎ
 = 
pcm
->
´iv©e_d©a
;

210 
nuÎ
->
¡©e
) {

211 
SND_PCM_STATE_RUNNING
:

212 
	`¢d_pcm_mm­_hw_fÜw¬d
(
pcm
, 
äames
);

214 
SND_PCM_STATE_PREPARED
:

215 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
äames
);

216  
äames
;

218  -
EBADFD
;

220 
	}
}

222 
	$¢d_pcm_nuÎ_»sume
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

225 
	}
}

227 
¢d_pcm_säames_t
 
	$¢d_pcm_nuÎ_xãr_¬—s
(
¢d_pcm_t
 *
pcm
,

228 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
 
ATTRIBUTE_UNUSED
,

229 
¢d_pcm_uäames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

230 
¢d_pcm_uäames_t
 
size
)

232 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
size
);

233 
	`¢d_pcm_mm­_hw_fÜw¬d
(
pcm
, 
size
);

234  
size
;

235 
	}
}

237 
¢d_pcm_säames_t
 
	$¢d_pcm_nuÎ_wr™ei
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
bufãr
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_uäames_t
 
size
)

239  
	`¢d_pcm_wr™e_¬—s
(
pcm
, 
NULL
, 0, 
size
, 
¢d_pcm_nuÎ_xãr_¬—s
);

240 
	}
}

242 
¢d_pcm_säames_t
 
	$¢d_pcm_nuÎ_wr™’
(
¢d_pcm_t
 *
pcm
, **
bufs
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_uäames_t
 
size
)

244  
	`¢d_pcm_wr™e_¬—s
(
pcm
, 
NULL
, 0, 
size
, 
¢d_pcm_nuÎ_xãr_¬—s
);

245 
	}
}

247 
¢d_pcm_säames_t
 
	$¢d_pcm_nuÎ_»adi
(
¢d_pcm_t
 *
pcm
, *
bufãr
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_uäames_t
 
size
)

249  
	`¢d_pcm_»ad_¬—s
(
pcm
, 
NULL
, 0, 
size
, 
¢d_pcm_nuÎ_xãr_¬—s
);

250 
	}
}

252 
¢d_pcm_säames_t
 
	$¢d_pcm_nuÎ_»adn
(
¢d_pcm_t
 *
pcm
, **
bufs
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_uäames_t
 
size
)

254  
	`¢d_pcm_»ad_¬—s
(
pcm
, 
NULL
, 0, 
size
, 
¢d_pcm_nuÎ_xãr_¬—s
);

255 
	}
}

257 
¢d_pcm_säames_t
 
	$¢d_pcm_nuÎ_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

258 
¢d_pcm_uäames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

259 
¢d_pcm_uäames_t
 
size
)

261  
	`¢d_pcm_nuÎ_fÜw¬d
(
pcm
, 
size
);

262 
	}
}

264 
	$¢d_pcm_nuÎ_hw_»fše
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

266 
”r
;

271 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 1,

273 ià(
”r
 < 0)

274  
”r
;

276 
”r
 = 
	`¢d_pcm_hw_»fše_soá
(
pcm
, 
·¿ms
);

277 
·¿ms
->
šfo
 = 
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
 |

278 
SND_PCM_INFO_RESUME
 | 
SND_PCM_INFO_PAUSE
;

279 
·¿ms
->
fifo_size
 = 0;

280  
”r
;

281 
	}
}

283 
	$¢d_pcm_nuÎ_hw_·¿ms
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 * 
·¿ms
 ATTRIBUTE_UNUSED)

286 
	}
}

288 
	$¢d_pcm_nuÎ_hw_ä“
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

291 
	}
}

293 
	$¢d_pcm_nuÎ_sw_·¿ms
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_·¿ms_t
 * 
·¿ms
 ATTRIBUTE_UNUSED)

296 
	}
}

298 
¢d_pcm_chm­_qu”y_t
 **
	$¢d_pcm_nuÎ_qu”y_chm­s
(
¢d_pcm_t
 *
pcm
)

300 
¢d_pcm_nuÎ_t
 *
nuÎ
 = 
pcm
->
´iv©e_d©a
;

302 ià(
nuÎ
->
chm­
)

303  
	`_¢d_pcm_cİy_chm­_qu”y
(
nuÎ
->
chm­
);

304  
NULL
;

305 
	}
}

307 
¢d_pcm_chm­_t
 *
	$¢d_pcm_nuÎ_g‘_chm­
(
¢d_pcm_t
 *
pcm
)

309 
¢d_pcm_nuÎ_t
 *
nuÎ
 = 
pcm
->
´iv©e_d©a
;

311 ià(
nuÎ
->
chm­
)

312  
	`_¢d_pcm_choo£_fixed_chm­
(
pcm
, 
nuÎ
->
chm­
);

313  
NULL
;

314 
	}
}

316 
	$¢d_pcm_nuÎ_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

318 
	`¢d_ouut_´štf
(
out
, "Null PCM\n");

319 ià(
pcm
->
£tup
) {

320 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

321 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

323 
	}
}

325 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_nuÎ_İs
 = {

326 .
şo£
 = 
¢d_pcm_nuÎ_şo£
,

327 .
	gšfo
 = 
¢d_pcm_nuÎ_šfo
,

328 .
	ghw_»fše
 = 
¢d_pcm_nuÎ_hw_»fše
,

329 .
	ghw_·¿ms
 = 
¢d_pcm_nuÎ_hw_·¿ms
,

330 .
	ghw_ä“
 = 
¢d_pcm_nuÎ_hw_ä“
,

331 .
	gsw_·¿ms
 = 
¢d_pcm_nuÎ_sw_·¿ms
,

332 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

333 .
	gdump
 = 
¢d_pcm_nuÎ_dump
,

334 .
	gnÚblock
 = 
¢d_pcm_nuÎ_nÚblock
,

335 .
	gasync
 = 
¢d_pcm_nuÎ_async
,

336 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

337 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

338 .
	gqu”y_chm­s
 = 
¢d_pcm_nuÎ_qu”y_chm­s
,

339 .
	gg‘_chm­
 = 
¢d_pcm_nuÎ_g‘_chm­
,

340 .
	g£t_chm­
 = 
NULL
,

343 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_nuÎ_ç¡_İs
 = {

344 .
¡©us
 = 
¢d_pcm_nuÎ_¡©us
,

345 .
	g¡©e
 = 
¢d_pcm_nuÎ_¡©e
,

346 .
	ghwsync
 = 
¢d_pcm_nuÎ_hwsync
,

347 .
	gd–ay
 = 
¢d_pcm_nuÎ_d–ay
,

348 .
	g´•¬e
 = 
¢d_pcm_nuÎ_´•¬e
,

349 .
	g»£t
 = 
¢d_pcm_nuÎ_»£t
,

350 .
	g¡¬t
 = 
¢d_pcm_nuÎ_¡¬t
,

351 .
	gdrİ
 = 
¢d_pcm_nuÎ_drİ
,

352 .
	gd¿š
 = 
¢d_pcm_nuÎ_d¿š
,

353 .
	g·u£
 = 
¢d_pcm_nuÎ_·u£
,

354 .
	g»wšdabË
 = 
¢d_pcm_nuÎ_»wšdabË
,

355 .
	g»wšd
 = 
¢d_pcm_nuÎ_»wšd
,

356 .
	gfÜw¬dabË
 = 
¢d_pcm_nuÎ_fÜw¬dabË
,

357 .
	gfÜw¬d
 = 
¢d_pcm_nuÎ_fÜw¬d
,

358 .
	g»sume
 = 
¢d_pcm_nuÎ_»sume
,

359 .
	gwr™ei
 = 
¢d_pcm_nuÎ_wr™ei
,

360 .
	gwr™’
 = 
¢d_pcm_nuÎ_wr™’
,

361 .
	g»adi
 = 
¢d_pcm_nuÎ_»adi
,

362 .
	g»adn
 = 
¢d_pcm_nuÎ_»adn
,

363 .
	gava_upd©e
 = 
¢d_pcm_nuÎ_ava_upd©e
,

364 .
	gmm­_comm™
 = 
¢d_pcm_nuÎ_mm­_comm™
,

365 .
	ghtime¡amp
 = 
¢d_pcm_g’”ic_»®_htime¡amp
,

379 
	$¢d_pcm_nuÎ_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
, 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

381 
¢d_pcm_t
 *
pcm
;

382 
¢d_pcm_nuÎ_t
 *
nuÎ
;

383 
fd
;

384 
”r
;

385 
	`as£¹
(
pcmp
);

386 ià(
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

387 
fd
 = 
	`İ’
("/dev/nuÎ", 
O_WRONLY
);

388 ià(
fd
 < 0) {

389 
	`SYSERR
("Cannot open /dev/null");

390  -
”ºo
;

393 
fd
 = 
	`İ’
("/dev/fuÎ", 
O_RDONLY
);

394 ià(
fd
 < 0) {

395 
	`SYSERR
("Cannot open /dev/full");

396  -
”ºo
;

399 
nuÎ
 = 
	`ÿÎoc
(1, (
¢d_pcm_nuÎ_t
));

400 ià(!
nuÎ
) {

401 
	`şo£
(
fd
);

402  -
ENOMEM
;

404 
nuÎ
->
pŞl_fd
 = 
fd
;

405 
nuÎ
->
¡©e
 = 
SND_PCM_STATE_OPEN
;

407 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_NULL
, 
Çme
, 
¡»am
, 
mode
);

408 ià(
”r
 < 0) {

409 
	`şo£
(
fd
);

410 
	`ä“
(
nuÎ
);

411  
”r
;

413 
pcm
->
İs
 = &
¢d_pcm_nuÎ_İs
;

414 
pcm
->
ç¡_İs
 = &
¢d_pcm_nuÎ_ç¡_İs
;

415 
pcm
->
´iv©e_d©a
 = 
nuÎ
;

416 
pcm
->
pŞl_fd
 = 
fd
;

417 
pcm
->
pŞl_ev’ts
 = 
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
 ? 
POLLOUT
 : 
POLLIN
;

418 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
nuÎ
->
hw_±r
, -1, 0);

419 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
nuÎ
->
­¶_±r
, -1, 0);

420 *
pcmp
 = 
pcm
;

423 
	}
}

464 
	$_¢d_pcm_nuÎ_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

465 
¢d_cÚfig_t
 *
roÙ
 
ATTRIBUTE_UNUSED
, snd_cÚfig_ˆ*
cÚf
,

466 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

468 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

469 
¢d_pcm_nuÎ_t
 *
nuÎ
;

470 
¢d_pcm_chm­_qu”y_t
 **
chm­
 = 
NULL
;

471 
”r
;

473 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

474 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

475 cÚ¡ *
id
;

476 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

478 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

480 ià(
	`¡rcmp
(
id
, "chmap") == 0) {

481 
	`¢d_pcm_ä“_chm­s
(
chm­
);

482 
chm­
 = 
	`_¢d_pcm_·r£_cÚfig_chm­s
(
n
);

483 ià(!
chm­
) {

484 
	`SNDERR
("Inv®id chªÃÈm­ fÜ %s", 
id
);

485  -
EINVAL
;

489 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

490 
	`¢d_pcm_ä“_chm­s
(
chm­
);

491  -
EINVAL
;

493 
”r
 = 
	`¢d_pcm_nuÎ_İ’
(
pcmp
, 
Çme
, 
¡»am
, 
mode
);

494 ià(
”r
 < 0) {

495 
	`¢d_pcm_ä“_chm­s
(
chm­
);

496  
”r
;

499 
nuÎ
 = (*
pcmp
)->
´iv©e_d©a
;

500 
nuÎ
->
chm­
 = chmap;

502 
	}
}

503 #iâdeà
DOC_HIDDEN


504 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_nuÎ_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_params.c

22 
	~"pcm_loÿl.h
"

24 #iâdeà
NDEBUG


28 
	$dump_hw_·¿ms
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, cÚ¡ *
ty³
,

29 
¢d_pcm_hw_·¿m_t
 
v¬
, 
v®
, 
”r
)

31 cÚ¡ *
v”bo£
 = 
	`g‘’v
("LIBASOUND_DEBUG");

32 
¢d_ouut_t
 *
out
;

34 ià(! 
v”bo£
 || ! *v”bo£ || 
	`©oi
(verbose) < 1)

36 ià(
	`¢d_ouut_¡dio_©ch
(&
out
, 
¡d”r
, 0) < 0)

38 
	`årštf
(
¡d”r
, "ALSA ERROR hw_params: %s (%s)\n",

39 
ty³
, 
	`¢d_pcm_hw_·¿m_Çme
(
v¬
));

40 
	`årštf
(
¡d”r
, " value = ");

41 
v¬
) {

42 
SND_PCM_HW_PARAM_ACCESS
:

43 
	`årštf
(
¡d”r
, "%s", 
	`¢d_pcm_acûss_Çme
(
v®
));

45 
SND_PCM_HW_PARAM_FORMAT
:

46 
	`årštf
(
¡d”r
, "%s", 
	`¢d_pcm_fÜm©_Çme
(
v®
));

48 
SND_PCM_HW_PARAM_SUBFORMAT
:

49 
	`årštf
(
¡d”r
, "%s", 
	`¢d_pcm_subfÜm©_Çme
(
v®
));

52 
	`årštf
(
¡d”r
, "%u", 
v®
);

54 
	`årštf
(
¡d”r
, " : %s\n", 
	`¢d_¡»¼Ü
(
”r
));

55 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
out
);

56 
	`¢d_ouut_şo£
(
out
);

57 
	}
}

59 
šlše
 
	$dump_hw_·¿ms
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, cÚ¡ *
ty³
,

60 
¢d_pcm_hw_·¿m_t
 
v¬
, 
v®
, 
”r
)

62 
	}
}

65 
šlše
 
	$hw_is_mask
(
¢d_pcm_hw_·¿m_t
 
v¬
)

67 #ià
SND_PCM_HW_PARAM_FIRST_MASK
 == 0

68  
v¬
 <ğ
SND_PCM_HW_PARAM_LAST_MASK
;

70  
v¬
 >ğ
SND_PCM_HW_PARAM_FIRST_MASK
 &&

71 
v¬
 <ğ
SND_PCM_HW_PARAM_LAST_MASK
;

73 
	}
}

75 
šlše
 
	$hw_is_š‹rv®
(
¢d_pcm_hw_·¿m_t
 
v¬
)

77  
v¬
 >ğ
SND_PCM_HW_PARAM_FIRST_INTERVAL
 &&

78 
v¬
 <ğ
SND_PCM_HW_PARAM_LAST_INTERVAL
;

79 
	}
}

81 
	#hw_·¿m_mask
(
·¿ms
,
v¬
) \

82 &((
·¿ms
)->
masks
[(
v¬
è- 
SND_PCM_HW_PARAM_FIRST_MASK
])

	)

84 
	#hw_·¿m_š‹rv®
(
·¿ms
,
v¬
) \

85 &((
·¿ms
)->
š‹rv®s
[(
v¬
è- 
SND_PCM_HW_PARAM_FIRST_INTERVAL
])

	)

87 
	#hw_·¿m_mask_c
 
hw_·¿m_mask


	)

88 
	#hw_·¿m_š‹rv®_c
 
hw_·¿m_š‹rv®


	)

90 
	$_¢d_pcm_hw_·¿m_ªy
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_hw_·¿m_t
 
v¬
)

92 ià(
	`hw_is_mask
(
v¬
)) {

93 
	`¢d_mask_ªy
(
	`hw_·¿m_mask
(
·¿ms
, 
v¬
));

94 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

95 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

98 ià(
	`hw_is_š‹rv®
(
v¬
)) {

99 
	`¢d_š‹rv®_ªy
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
v¬
));

100 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

101 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

104 
	`as£¹
(0);

105 
	}
}

107 
	$¢d_pcm_hw_·¿m_ªy
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

108 
¢d_pcm_hw_·¿m_t
 
v¬
)

110 
	`_¢d_pcm_hw_·¿m_ªy
(
·¿ms
, 
v¬
);

111  
	`¢d_pcm_hw_»fše
(
pcm
, 
·¿ms
);

112 
	}
}

114 
	$_¢d_pcm_hw_·¿ms_ªy
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

116 
k
;

117 
	`mem£t
(
·¿ms
, 0, (*params));

118 
k
 = 
SND_PCM_HW_PARAM_FIRST_MASK
; k <ğ
SND_PCM_HW_PARAM_LAST_MASK
; k++)

119 
	`_¢d_pcm_hw_·¿m_ªy
(
·¿ms
, 
k
);

120 
k
 = 
SND_PCM_HW_PARAM_FIRST_INTERVAL
; k <ğ
SND_PCM_HW_PARAM_LAST_INTERVAL
; k++)

121 
	`_¢d_pcm_hw_·¿m_ªy
(
·¿ms
, 
k
);

122 
·¿ms
->
rmask
 = ~0U;

123 
·¿ms
->
cmask
 = 0;

124 
·¿ms
->
šfo
 = ~0U;

125 
	}
}

130 
	$¢d_pcm_hw_·¿m_g‘
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_hw_·¿m_t
 
v¬
,

131 *
v®
, *
dœ
)

133 ià(
	`hw_is_mask
(
v¬
)) {

134 cÚ¡ 
¢d_mask_t
 *
mask
 = 
	`hw_·¿m_mask_c
(
·¿ms
, 
v¬
);

135 ià(
	`¢d_mask_em±y
(
mask
è|| !
	`¢d_mask_sšgË
(mask))

136  -
EINVAL
;

137 ià(
dœ
)

138 *
dœ
 = 0;

139 ià(
v®
)

140 *
v®
 = 
	`¢d_mask_v®ue
(
mask
);

142 } ià(
	`hw_is_š‹rv®
(
v¬
)) {

143 cÚ¡ 
¢d_š‹rv®_t
 *
i
 = 
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
v¬
);

144 ià(
	`¢d_š‹rv®_em±y
(
i
è|| !
	`¢d_š‹rv®_sšgË
(i))

145  -
EINVAL
;

146 ià(
dœ
)

147 *
dœ
 = 
i
->
İ’mš
;

148 ià(
v®
)

149 *
v®
 = 
	`¢d_š‹rv®_v®ue
(
i
);

152 
	`as£¹
(0);

153  -
EINVAL
;

154 
	}
}

157 
	$¢d_pcm_hw_·¿m_g‘_mš
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_hw_·¿m_t
 
v¬
,

158 *
v®
, *
dœ
)

160 ià(
	`hw_is_mask
(
v¬
)) {

161 cÚ¡ 
¢d_mask_t
 *
m
 = 
	`hw_·¿m_mask_c
(
·¿ms
, 
v¬
);

162 
	`as£¹
(!
	`¢d_mask_em±y
(
m
));

163 ià(
dœ
)

164 *
dœ
 = 0;

165 ià(
v®
)

166 *
v®
 = 
	`¢d_mask_mš
(
m
);

168 } ià(
	`hw_is_š‹rv®
(
v¬
)) {

169 cÚ¡ 
¢d_š‹rv®_t
 *
i
 = 
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
v¬
);

170 
	`as£¹
(!
	`¢d_š‹rv®_em±y
(
i
));

171 ià(
dœ
)

172 *
dœ
 = 
i
->
İ’mš
;

173 ià(
v®
)

174 *
v®
 = 
	`¢d_š‹rv®_mš
(
i
);

177 
	`as£¹
(0);

179 
	}
}

182 
	$¢d_pcm_hw_·¿m_g‘_max
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_hw_·¿m_t
 
v¬
,

183 *
v®
, *
dœ
)

185 ià(
	`hw_is_mask
(
v¬
)) {

186 cÚ¡ 
¢d_mask_t
 *
m
 = 
	`hw_·¿m_mask_c
(
·¿ms
, 
v¬
);

187 
	`as£¹
(!
	`¢d_mask_em±y
(
m
));

188 ià(
dœ
)

189 *
dœ
 = 0;

190 ià(
v®
)

191 *
v®
 = 
	`¢d_mask_max
(
m
);

193 } ià(
	`hw_is_š‹rv®
(
v¬
)) {

194 cÚ¡ 
¢d_š‹rv®_t
 *
i
 = 
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
v¬
);

195 
	`as£¹
(!
	`¢d_š‹rv®_em±y
(
i
));

196 ià(
dœ
)

197 *
dœ
 = - (è
i
->
İ’max
;

198 ià(
v®
)

199 *
v®
 = 
	`¢d_š‹rv®_max
(
i
);

202 
	`as£¹
(0);

204 
	}
}

209 cÚ¡ 
¢d_mask_t
 *
	$¢d_pcm_hw_·¿m_g‘_mask
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

210 
¢d_pcm_hw_·¿m_t
 
v¬
)

212 
	`as£¹
(
	`hw_is_mask
(
v¬
));

213  
	`hw_·¿m_mask_c
(
·¿ms
, 
v¬
);

214 
	}
}

219 cÚ¡ 
¢d_š‹rv®_t
 *
	$¢d_pcm_hw_·¿m_g‘_š‹rv®
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

220 
¢d_pcm_hw_·¿m_t
 
v¬
)

222 
	`as£¹
(
	`hw_is_š‹rv®
(
v¬
));

223  
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
v¬
);

224 
	}
}

228 
	$_¢d_pcm_hw_·¿m_£t_š‹rv®
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

229 
¢d_pcm_hw_·¿m_t
 
v¬
,

230 cÚ¡ 
¢d_š‹rv®_t
 *
v®
)

232 
chªged
;

233 
	`as£¹
(
	`hw_is_š‹rv®
(
v¬
));

234 
chªged
 = 
	`¢d_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
v¬
), 
v®
);

235 ià(
chªged
) {

236 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

237 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

239  
chªged
;

240 
	}
}

242 
	$_¢d_pcm_hw_·¿m_£t_em±y
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

243 
¢d_pcm_hw_·¿m_t
 
v¬
)

245 ià(
	`hw_is_mask
(
v¬
)) {

246 
	`¢d_mask_nÚe
(
	`hw_·¿m_mask
(
·¿ms
, 
v¬
));

247 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

248 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

249 } ià(
	`hw_is_š‹rv®
(
v¬
)) {

250 
	`¢d_š‹rv®_nÚe
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
v¬
));

251 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

252 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

254 
	`as£¹
(0);

256 
	}
}

258 
	$_¢d_pcm_hw_·¿m_£t_š‹g”
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

259 
¢d_pcm_hw_·¿m_t
 
v¬
)

261 
chªged
;

262 
	`as£¹
(
	`hw_is_š‹rv®
(
v¬
));

263 
chªged
 = 
	`¢d_š‹rv®_£tš‹g”
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
v¬
));

264 ià(
chªged
) {

265 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

266 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

268  
chªged
;

269 
	}
}

275 
	$¢d_pcm_hw_·¿m_£t_š‹g”
(
¢d_pcm_t
 *
pcm
,

276 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

277 
¢d_£t_mode_t
 
mode
,

278 
¢d_pcm_hw_·¿m_t
 
v¬
)

280 
¢d_pcm_hw_·¿ms_t
 
§ve
;

281 
”r
;

282 
mode
) {

283 
SND_CHANGE
:

285 
SND_TRY
:

286 
§ve
 = *
·¿ms
;

288 
SND_TEST
:

289 
§ve
 = *
·¿ms
;

290 
·¿ms
 = &
§ve
;

293 
	`as£¹
(0);

294  -
EINVAL
;

296 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_š‹g”
(
·¿ms
, 
v¬
);

297 ià(
”r
 < 0)

298 
_ç
;

299 ià(
·¿ms
->
rmask
) {

300 
”r
 = 
	`¢d_pcm_hw_»fše
(
pcm
, 
·¿ms
);

301 ià(
”r
 < 0)

302 
_ç
;

305 
_ç
:

306 ià(
mode
 =ğ
SND_TRY
)

307 *
·¿ms
 = 
§ve
;

308  
”r
;

309 
	}
}

311 
	$_¢d_pcm_hw_·¿m_£t_fœ¡
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

312 
¢d_pcm_hw_·¿m_t
 
v¬
)

314 
chªged
;

315 ià(
	`hw_is_mask
(
v¬
))

316 
chªged
 = 
	`¢d_mask_»fše_fœ¡
(
	`hw_·¿m_mask
(
·¿ms
, 
v¬
));

317 ià(
	`hw_is_š‹rv®
(
v¬
))

318 
chªged
 = 
	`¢d_š‹rv®_»fše_fœ¡
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
v¬
));

320 
	`as£¹
(0);

321  -
EINVAL
;

323 ià(
chªged
 > 0) {

324 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

325 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

327  
chªged
;

328 
	}
}

335 
	$¢d_pcm_hw_·¿m_£t_fœ¡
(
¢d_pcm_t
 *
pcm
,

336 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

337 
¢d_pcm_hw_·¿m_t
 
v¬
,

338 *
rv®
, *
dœ
)

340 
”r
;

342 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_fœ¡
(
·¿ms
, 
v¬
);

343 ià(
”r
 < 0)

344  
”r
;

345 ià(
·¿ms
->
rmask
) {

346 
”r
 = 
	`¢d_pcm_hw_»fše
(
pcm
, 
·¿ms
);

347 ià(
”r
 < 0)

348  
”r
;

350  
	`¢d_pcm_hw_·¿m_g‘
(
·¿ms
, 
v¬
, 
rv®
, 
dœ
);

351 
	}
}

353 
	$_¢d_pcm_hw_·¿m_£t_Ï¡
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

354 
¢d_pcm_hw_·¿m_t
 
v¬
)

356 
chªged
;

357 ià(
	`hw_is_mask
(
v¬
))

358 
chªged
 = 
	`¢d_mask_»fše_Ï¡
(
	`hw_·¿m_mask
(
·¿ms
, 
v¬
));

359 ià(
	`hw_is_š‹rv®
(
v¬
))

360 
chªged
 = 
	`¢d_š‹rv®_»fše_Ï¡
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
v¬
));

362 
	`as£¹
(0);

363  -
EINVAL
;

365 ià(
chªged
 > 0) {

366 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

367 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

369  
chªged
;

370 
	}
}

377 
	$¢d_pcm_hw_·¿m_£t_Ï¡
(
¢d_pcm_t
 *
pcm
,

378 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

379 
¢d_pcm_hw_·¿m_t
 
v¬
,

380 *
rv®
, *
dœ
)

382 
”r
;

384 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_Ï¡
(
·¿ms
, 
v¬
);

385 ià(
”r
 < 0)

386  
”r
;

387 ià(
·¿ms
->
rmask
) {

388 
”r
 = 
	`¢d_pcm_hw_»fše
(
pcm
, 
·¿ms
);

389 ià(
”r
 < 0)

390  
”r
;

392  
	`¢d_pcm_hw_·¿m_g‘
(
·¿ms
, 
v¬
, 
rv®
, 
dœ
);

393 
	}
}

395 
	$_¢d_pcm_hw_·¿m_£t_mš
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

396 
¢d_pcm_hw_·¿m_t
 
v¬
, 
v®
, 
dœ
)

398 
chªged
;

399 
İ’mš
 = 0;

400 ià(
dœ
) {

401 ià(
dœ
 > 0) {

402 
İ’mš
 = 1;

403 } ià(
dœ
 < 0) {

404 ià(
v®
 > 0) {

405 
İ’mš
 = 1;

406 
v®
--;

410 ià(
	`hw_is_mask
(
v¬
))

411 
chªged
 = 
	`¢d_mask_»fše_mš
(
	`hw_·¿m_mask
(
·¿ms
, 
v¬
), 
v®
 + !!
İ’mš
);

412 ià(
	`hw_is_š‹rv®
(
v¬
))

413 
chªged
 = 
	`¢d_š‹rv®_»fše_mš
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
v¬
), 
v®
, 
İ’mš
);

415 
	`as£¹
(0);

416  -
EINVAL
;

418 ià(
chªged
) {

419 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

420 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

422  
chªged
;

423 
	}
}

429 
	$¢d_pcm_hw_·¿m_£t_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

430 
¢d_£t_mode_t
 
mode
,

431 
¢d_pcm_hw_·¿m_t
 
v¬
, *
v®
, *
dœ
)

433 
¢d_pcm_hw_·¿ms_t
 
§ve
;

434 
”r
;

435 
mode
) {

436 
SND_CHANGE
:

438 
SND_TRY
:

439 
§ve
 = *
·¿ms
;

441 
SND_TEST
:

442 
§ve
 = *
·¿ms
;

443 
·¿ms
 = &
§ve
;

446 
	`as£¹
(0);

447  -
EINVAL
;

449 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mš
(
·¿ms
, 
v¬
, *
v®
, 
dœ
 ? *dir : 0);

450 ià(
”r
 < 0)

451 
_ç
;

452 ià((
mode
 !ğ
SND_TEST
 || 
	`hw_is_š‹rv®
(
v¬
)è&& 
·¿ms
->
rmask
) {

453 
”r
 = 
	`¢d_pcm_hw_»fše
(
pcm
, 
·¿ms
);

454 ià(
”r
 < 0)

455 
_ç
;

456 ià(
	`¢d_pcm_hw_·¿m_em±y
(
·¿ms
, 
v¬
)) {

457 
”r
 = -
ENOENT
;

458 
_ç
;

461  
	`¢d_pcm_hw_·¿m_g‘_mš
(
·¿ms
, 
v¬
, 
v®
, 
dœ
);

462 
_ç
:

463 ià(
mode
 =ğ
SND_TRY
)

464 *
·¿ms
 = 
§ve
;

465 ià(
”r
 < 0 && 
mode
 =ğ
SND_TRY
)

466 
	`dump_hw_·¿ms
(
·¿ms
, "£t_mš", 
v¬
, *
v®
, 
”r
);

467  
”r
;

468 
	}
}

470 
	$_¢d_pcm_hw_·¿m_£t_max
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

471 
¢d_pcm_hw_·¿m_t
 
v¬
, 
v®
, 
dœ
)

473 
chªged
;

474 
İ’max
 = 0;

475 ià(
dœ
) {

476 ià(
dœ
 < 0) {

477 
İ’max
 = 1;

478 } ià(
dœ
 > 0) {

479 
İ’max
 = 1;

480 
v®
++;

483 ià(
	`hw_is_mask
(
v¬
)) {

484 ià(
v®
 =ğ0 && 
İ’max
) {

485 
	`¢d_mask_nÚe
(
	`hw_·¿m_mask
(
·¿ms
, 
v¬
));

486 
chªged
 = -
EINVAL
;

488 
chªged
 = 
	`¢d_mask_»fše_max
(
	`hw_·¿m_mask
(
·¿ms
, 
v¬
), 
v®
 - !!
İ’max
);

489 } ià(
	`hw_is_š‹rv®
(
v¬
))

490 
chªged
 = 
	`¢d_š‹rv®_»fše_max
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
v¬
), 
v®
, 
İ’max
);

492 
	`as£¹
(0);

493  -
EINVAL
;

495 ià(
chªged
) {

496 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

497 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

499  
chªged
;

500 
	}
}

506 
	$¢d_pcm_hw_·¿m_£t_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

507 
¢d_£t_mode_t
 
mode
,

508 
¢d_pcm_hw_·¿m_t
 
v¬
, *
v®
, *
dœ
)

510 
¢d_pcm_hw_·¿ms_t
 
§ve
;

511 
”r
;

512 
mode
) {

513 
SND_CHANGE
:

515 
SND_TRY
:

516 
§ve
 = *
·¿ms
;

518 
SND_TEST
:

519 
§ve
 = *
·¿ms
;

520 
·¿ms
 = &
§ve
;

523 
	`as£¹
(0);

524  -
EINVAL
;

526 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_max
(
·¿ms
, 
v¬
, *
v®
, 
dœ
 ? *dir : 0);

527 ià(
”r
 < 0)

528 
_ç
;

529 ià((
mode
 !ğ
SND_TEST
 || 
	`hw_is_š‹rv®
(
v¬
)è&& 
·¿ms
->
rmask
) {

530 
”r
 = 
	`¢d_pcm_hw_»fše
(
pcm
, 
·¿ms
);

531 ià(
”r
 < 0)

532 
_ç
;

533 ià(
	`¢d_pcm_hw_·¿m_em±y
(
·¿ms
, 
v¬
)) {

534 
”r
 = -
ENOENT
;

535 
_ç
;

538  
	`¢d_pcm_hw_·¿m_g‘_max
(
·¿ms
, 
v¬
, 
v®
, 
dœ
);

539 
_ç
:

540 ià(
mode
 =ğ
SND_TRY
)

541 *
·¿ms
 = 
§ve
;

542 ià(
”r
 < 0 && 
mode
 =ğ
SND_TRY
)

543 
	`dump_hw_·¿ms
(
·¿ms
, "£t_max", 
v¬
, *
v®
, 
”r
);

544  
”r
;

545 
	}
}

547 
	$_¢d_pcm_hw_·¿m_£t_mšmax
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

548 
¢d_pcm_hw_·¿m_t
 
v¬
,

549 
mš
, 
mšdœ
,

550 
max
, 
maxdœ
)

552 
chªged
, 
c1
, 
c2
;

553 
İ’mš
 = 0, 
İ’max
 = 0;

554 ià(
mšdœ
) {

555 ià(
mšdœ
 > 0) {

556 
İ’mš
 = 1;

557 } ià(
mšdœ
 < 0) {

558 ià(
mš
 > 0) {

559 
İ’mš
 = 1;

560 
mš
--;

564 ià(
maxdœ
) {

565 ià(
maxdœ
 < 0) {

566 
İ’max
 = 1;

567 } ià(
maxdœ
 > 0) {

568 
İ’max
 = 1;

569 
max
++;

572 ià(
	`hw_is_mask
(
v¬
)) {

573 
¢d_mask_t
 *
mask
 = 
	`hw_·¿m_mask
(
·¿ms
, 
v¬
);

574 ià(
max
 =ğ0 && 
İ’max
) {

575 
	`¢d_mask_nÚe
(
mask
);

576 
chªged
 = -
EINVAL
;

578 
c1
 = 
	`¢d_mask_»fše_mš
(
mask
, 
mš
 + !!
İ’mš
);

579 ià(
c1
 < 0)

580 
chªged
 = 
c1
;

582 
c2
 = 
	`¢d_mask_»fše_max
(
mask
, 
max
 - !!
İ’max
);

583 ià(
c2
 < 0)

584 
chªged
 = 
c2
;

586 
chªged
 = (
c1
 || 
c2
);

590 ià(
	`hw_is_š‹rv®
(
v¬
)) {

591 
¢d_š‹rv®_t
 *
i
 = 
	`hw_·¿m_š‹rv®
(
·¿ms
, 
v¬
);

592 
c1
 = 
	`¢d_š‹rv®_»fše_mš
(
i
, 
mš
, 
İ’mš
);

593 ià(
c1
 < 0)

594 
chªged
 = 
c1
;

596 
c2
 = 
	`¢d_š‹rv®_»fše_max
(
i
, 
max
, 
İ’max
);

597 ià(
c2
 < 0)

598 
chªged
 = 
c2
;

600 
chªged
 = (
c1
 || 
c2
);

603 
	`as£¹
(0);

604  -
EINVAL
;

606 ià(
chªged
) {

607 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

608 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

610  
chªged
;

611 
	}
}

617 
	$¢d_pcm_hw_·¿m_£t_mšmax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

618 
¢d_£t_mode_t
 
mode
,

619 
¢d_pcm_hw_·¿m_t
 
v¬
,

620 *
mš
, *
mšdœ
,

621 *
max
, *
maxdœ
)

623 
¢d_pcm_hw_·¿ms_t
 
§ve
;

624 
”r
;

625 
mode
) {

626 
SND_CHANGE
:

628 
SND_TRY
:

629 
§ve
 = *
·¿ms
;

631 
SND_TEST
:

632 
§ve
 = *
·¿ms
;

633 
·¿ms
 = &
§ve
;

636 
	`as£¹
(0);

637  -
EINVAL
;

639 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mšmax
(
·¿ms
, 
v¬
,

640 *
mš
, 
mšdœ
 ? *mindir : 0,

641 *
max
, 
maxdœ
 ? *maxdir : 0);

642 ià(
”r
 < 0)

643 
_ç
;

644 ià((
mode
 !ğ
SND_TEST
 || 
	`hw_is_š‹rv®
(
v¬
)è&& 
·¿ms
->
rmask
) {

645 
”r
 = 
	`¢d_pcm_hw_»fše
(
pcm
, 
·¿ms
);

646 ià(
”r
 < 0)

647 
_ç
;

649 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘_mš
(
·¿ms
, 
v¬
, 
mš
, 
mšdœ
);

650 ià(
”r
 < 0)

651  
”r
;

652  
	`¢d_pcm_hw_·¿m_g‘_max
(
·¿ms
, 
v¬
, 
max
, 
maxdœ
);

653 
_ç
:

654 ià(
mode
 =ğ
SND_TRY
)

655 *
·¿ms
 = 
§ve
;

656 ià(
”r
 < 0)

657 
	`dump_hw_·¿ms
(
·¿ms
, "£t_mšmax", 
v¬
, *
mš
, 
”r
);

658  
”r
;

659 
	}
}

661 
	$_¢d_pcm_hw_·¿m_£t
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

662 
¢d_pcm_hw_·¿m_t
 
v¬
, 
v®
, 
dœ
)

664 
chªged
;

665 ià(
	`hw_is_mask
(
v¬
)) {

666 
¢d_mask_t
 *
m
 = 
	`hw_·¿m_mask
(
·¿ms
, 
v¬
);

667 ià(
v®
 =ğ0 && 
dœ
 < 0) {

668 
chªged
 = -
EINVAL
;

669 
	`¢d_mask_nÚe
(
m
);

671 ià(
dœ
 > 0)

672 
v®
++;

673 ià(
dœ
 < 0)

674 
v®
--;

675 
chªged
 = 
	`¢d_mask_»fše_£t
(
	`hw_·¿m_mask
(
·¿ms
, 
v¬
), 
v®
);

677 } ià(
	`hw_is_š‹rv®
(
v¬
)) {

678 
¢d_š‹rv®_t
 *
i
 = 
	`hw_·¿m_š‹rv®
(
·¿ms
, 
v¬
);

679 ià(
v®
 =ğ0 && 
dœ
 < 0) {

680 
chªged
 = -
EINVAL
;

681 
	`¢d_š‹rv®_nÚe
(
i
);

682 } ià(
dœ
 == 0)

683 
chªged
 = 
	`¢d_š‹rv®_»fše_£t
(
i
, 
v®
);

685 
¢d_š‹rv®_t
 
t
;

686 
t
.
İ’mš
 = 1;

687 
t
.
İ’max
 = 1;

688 
t
.
em±y
 = 0;

689 
t
.
š‹g”
 = 0;

690 ià(
dœ
 < 0) {

691 
t
.
mš
 = 
v®
 - 1;

692 
t
.
max
 = 
v®
;

694 
t
.
mš
 = 
v®
;

695 
t
.
max
 = 
v®
+1;

697 
chªged
 = 
	`¢d_š‹rv®_»fše
(
i
, &
t
);

700 
	`as£¹
(0);

701  -
EINVAL
;

703 ià(
chªged
) {

704 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

705 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

707  
chªged
;

708 
	}
}

714 
	$¢d_pcm_hw_·¿m_£t
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

715 
¢d_£t_mode_t
 
mode
,

716 
¢d_pcm_hw_·¿m_t
 
v¬
, 
v®
, 
dœ
)

718 
¢d_pcm_hw_·¿ms_t
 
§ve
;

719 
”r
;

720 
mode
) {

721 
SND_CHANGE
:

723 
SND_TRY
:

724 
§ve
 = *
·¿ms
;

726 
SND_TEST
:

727 
§ve
 = *
·¿ms
;

728 
·¿ms
 = &
§ve
;

731 
	`as£¹
(0);

732  -
EINVAL
;

734 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t
(
·¿ms
, 
v¬
, 
v®
, 
dœ
);

735 ià(
”r
 < 0)

736 
_ç
;

737 ià((
mode
 !ğ
SND_TEST
 || 
	`hw_is_š‹rv®
(
v¬
)è&& 
·¿ms
->
rmask
) {

738 
”r
 = 
	`¢d_pcm_hw_»fše
(
pcm
, 
·¿ms
);

739 ià(
”r
 < 0)

740 
_ç
;

743 
_ç
:

744 ià(
mode
 =ğ
SND_TRY
)

745 *
·¿ms
 = 
§ve
;

746 ià(
”r
 < 0 && 
mode
 =ğ
SND_TRY
)

747 
	`dump_hw_·¿ms
(
·¿ms
, "£t", 
v¬
, 
v®
, 
”r
);

748  
”r
;

749 
	}
}

751 
	$_¢d_pcm_hw_·¿m_£t_mask
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

752 
¢d_pcm_hw_·¿m_t
 
v¬
, cÚ¡ 
¢d_mask_t
 *
v®
)

754 
chªged
;

755 
	`as£¹
(
	`hw_is_mask
(
v¬
));

756 
chªged
 = 
	`¢d_mask_»fše
(
	`hw_·¿m_mask
(
·¿ms
, 
v¬
), 
v®
);

757 ià(
chªged
) {

758 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

759 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

761  
chªged
;

762 
	}
}

771 
	$¢d_pcm_hw_·¿m_£t_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

772 
¢d_£t_mode_t
 
mode
,

773 
¢d_pcm_hw_·¿m_t
 
v¬
, cÚ¡ 
¢d_mask_t
 *
v®
)

775 
¢d_pcm_hw_·¿ms_t
 
§ve
;

776 
”r
;

777 
mode
) {

778 
SND_CHANGE
:

780 
SND_TRY
:

781 
§ve
 = *
·¿ms
;

783 
SND_TEST
:

784 
§ve
 = *
·¿ms
;

785 
·¿ms
 = &
§ve
;

788 
	`as£¹
(0);

789  -
EINVAL
;

791 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
v¬
, 
v®
);

792 ià(
”r
 < 0)

793 
_ç
;

794 ià(
mode
 !ğ
SND_TEST
 && 
·¿ms
->
rmask
) {

795 
”r
 = 
	`¢d_pcm_hw_»fše
(
pcm
, 
·¿ms
);

796 ià(
”r
 < 0)

797 
_ç
;

800 
_ç
:

801 ià(
mode
 =ğ
SND_TRY
)

802 *
·¿ms
 = 
§ve
;

803  
”r
;

804 
	}
}

812 
	$¢d_pcm_hw_·¿m_£t_Ã¬
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

813 
¢d_pcm_hw_·¿m_t
 
v¬
,

814 *
v®
, *
dœ
)

816 
¢d_pcm_hw_·¿ms_t
 
§ve
;

817 
”r
;

818 
be¡
 = *
v®
, 
§ved_mš
;

819 
Ï¡
 = 0;

820 
mš
, 
max
;

821 
mšdœ
, 
maxdœ
;

822 
v®dœ
 = 
dœ
 ? *dir : 0;

823 
¢d_š‹rv®_t
 *
i
;

825 ià(
be¡
 > 
INT_MAX
)

826 
be¡
 = 
INT_MAX
;

827 
mš
 = 
max
 = 
be¡
;

828 
mšdœ
 = 
maxdœ
 = 
v®dœ
;

829 ià(
maxdœ
 > 0)

830 
maxdœ
 = 0;

831 ià(
maxdœ
 == 0)

832 
maxdœ
 = -1;

834 
maxdœ
 = 1;

835 
max
--;

837 
§ve
 = *
·¿ms
;

838 
§ved_mš
 = 
mš
;

839 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_mš
(
pcm
, 
·¿ms
, 
SND_CHANGE
, 
v¬
, &
mš
, &
mšdœ
);

841 
i
 = 
	`hw_·¿m_š‹rv®
(
·¿ms
, 
v¬
);

842 ià(!
	`¢d_š‹rv®_em±y
(
i
è&& 
	`¢d_š‹rv®_sšgË
(i)) {

843 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘_mš
(
·¿ms
, 
v¬
, 
v®
, 
dœ
);

844 ià(
”r
 < 0)

845 
	`dump_hw_·¿ms
(
·¿ms
, "£t_Ã¬", 
v¬
, *
v®
, 
”r
);

846  
”r
;

849 ià(
”r
 >= 0) {

850 
¢d_pcm_hw_·¿ms_t
 
·¿ms1
;

851 ià(
mš
 =ğ
§ved_mš
 && 
mšdœ
 =ğ
v®dœ
)

852 
_’d
;

853 
·¿ms1
 = 
§ve
;

854 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_max
(
pcm
, &
·¿ms1
, 
SND_CHANGE
, 
v¬
, &
max
, &
maxdœ
);

855 ià(
”r
 < 0)

856 
_’d
;

857 ià(
	`bound¬y_Ã¬”
(
max
, 
maxdœ
, 
be¡
, 
v®dœ
, 
mš
, 
mšdœ
)) {

858 *
·¿ms
 = 
·¿ms1
;

859 
Ï¡
 = 1;

862 *
·¿ms
 = 
§ve
;

863 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_max
(
pcm
, 
·¿ms
, 
SND_CHANGE
, 
v¬
, &
max
, &
maxdœ
);

864 ià(
”r
 < 0) {

865 
	`dump_hw_·¿ms
(
·¿ms
, "£t_Ã¬", 
v¬
, *
v®
, 
”r
);

866  
”r
;

868 
Ï¡
 = 1;

870 
_’d
:

871 ià(
Ï¡
)

872 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_Ï¡
(
pcm
, 
·¿ms
, 
v¬
, 
v®
, 
dœ
);

874 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
v¬
, 
v®
, 
dœ
);

875 ià(
”r
 < 0)

876 
	`dump_hw_·¿ms
(
·¿ms
, "£t_Ã¬", 
v¬
, *
v®
, 
”r
);

877  
”r
;

878 
	}
}

889 
	$¢d_pcm_hw_·¿m_£t_Ãxt
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

890 
¢d_pcm_hw_·¿m_t
 
v¬
,

891 
be¡
, 
be¡dœ
,

892 
v®
, *
dœ
)

894 
¢d_pcm_hw_·¿ms_t
 
§ve
;

895 
v
, 
”r
;

896 
Ï¡
 = 0;

897 
mš
, 
max
;

898 
mšdœ
, 
maxdœ
;

899 
diff
, 
diffdœ
;

900 
v®dœ
 = 
dœ
 ? *dir : 0;

902 ià(
be¡
 > 
INT_MAX
)

903 
be¡
 = 
INT_MAX
;

904 
	`bound¬y_sub
(
v®
, 
v®dœ
, 
be¡
, 
be¡dœ
, &
diff
, &
diffdœ
);

905 ià(
diff
 < 0 || (difà=ğ0 && 
diffdœ
 < 0)) {

906 
mš
 = 
be¡
 - 
diff
;

907 
mšdœ
 = 
be¡dœ
 - 
diffdœ
;

908 
max
 = 
v®
;

909 
maxdœ
 = 
be¡dœ
 - 1;

911 
mš
 = 
v®
;

912 
mšdœ
 = 
be¡dœ
 + 1;

913 
max
 = 
be¡
 + 
diff
;

914 
maxdœ
 = 
be¡dœ
 + 
diffdœ
 + 1;

916 
mš
 +ğ
mšdœ
 / 2;

917 
mšdœ
 %= 2;

918 
max
 +ğ
maxdœ
 / 2;

919 
maxdœ
 %= 2;

920 
§ve
 = *
·¿ms
;

921 ià(
mš
 >= 0 &&

922 (
”r
 = 
	`¢d_pcm_hw_·¿m_£t_mš
(
pcm
, 
·¿ms
, 
SND_CHANGE
, 
v¬
, &
mš
, &
mšdœ
)) >= 0) {

923 
¢d_pcm_hw_·¿ms_t
 
·¿ms1
;

924 ià(
max
 < 0)

925 
_’d
;

926 
·¿ms1
 = 
§ve
;

927 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_max
(
pcm
, &
·¿ms1
, 
SND_CHANGE
, 
v¬
, &
max
, &
maxdœ
);

928 ià(
”r
 < 0)

929 
_’d
;

930 ià(
	`bound¬y_Ã¬”
(
max
, 
maxdœ
, 
be¡
, 
be¡dœ
, 
mš
, 
mšdœ
)) {

931 *
·¿ms
 = 
·¿ms1
;

932 
Ï¡
 = 1;

935 ià(
max
 < 0)

936  -
EINVAL
;

937 *
·¿ms
 = 
§ve
;

938 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_max
(
pcm
, 
·¿ms
, 
SND_CHANGE
, 
v¬
, &
max
, &
maxdœ
);

939 ià(
”r
 < 0)

940  
max
;

941 
Ï¡
 = 1;

943 
_’d
:

944 ià(
Ï¡
)

945 
v
 = 
	`¢d_pcm_hw_·¿m_£t_Ï¡
(
pcm
, 
·¿ms
, 
v¬
, 
dœ
);

947 
v
 = 
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
v¬
, 
dœ
);

948 
	`as£¹
(
v
 >= 0);

949  
v
;

950 
	}
}

953 
	$¢d_pcm_hw_·¿m_£t_Ã¬_mšmax
(
¢d_pcm_t
 *
pcm
,

954 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

955 
¢d_pcm_hw_·¿m_t
 
v¬
,

956 
mš
, *
mšdœ
,

957 
max
, *
maxdœ
)

959 
¢d_pcm_hw_·¿ms_t
 
tmp
;

960 
”r
;

961 ià(!
	`bound¬y_É
(
mš
, *
mšdœ
, 
max
, *
maxdœ
))

962  
	`¢d_pcm_hw_·¿m_£t_Ã¬
(
pcm
, 
·¿ms
, 
v¬
, &
mš
, 
mšdœ
);

963 
tmp
 = *
·¿ms
;

964 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_Ã¬
(
pcm
, &
tmp
, 
v¬
, &
mš
, 
mšdœ
);

965 ià(
”r
 < 0)

966  
”r
;

967 ià(
	`bound¬y_É
(
mš
, *
mšdœ
, 
max
, *
maxdœ
)) {

968 
tmp
 = *
·¿ms
;

969 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_Ã¬
(
pcm
, &
tmp
, 
v¬
, &
max
, 
maxdœ
);

971 
max
 = 
mš
;

972 *
maxdœ
 = *
mšdœ
;

974 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_mšmax
(
pcm
, 
·¿ms
, 
SND_CHANGE
, 
v¬
, &
mš
, 
mšdœ
,

975 &
max
, 
maxdœ
);

976 ià(
”r
 < 0)

977  
”r
;

979 
	}
}

981 
	$¢d_pcm_hw_·¿m_»fše_Ã¬
(
¢d_pcm_t
 *
pcm
,

982 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

983 
¢d_pcm_hw_·¿m_t
 
v¬
,

984 cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
¤c
)

986 
mš
, 
max
;

987 
mšdœ
, 
maxdœ
, 
”r
;

989 ià((
”r
 = 
	`¢d_pcm_hw_·¿m_g‘_mš
(
¤c
, 
v¬
, &
mš
, &
mšdœ
)) < 0)

990  
”r
;

991 ià((
”r
 = 
	`¢d_pcm_hw_·¿m_g‘_max
(
¤c
, 
v¬
, &
max
, &
maxdœ
)) < 0)

992  
”r
;

993 ià((
”r
 = 
	`¢d_pcm_hw_·¿m_£t_Ã¬_mšmax
(
pcm
, 
·¿ms
, 
v¬
,

994 
mš
, &
mšdœ
, 
max
, &
maxdœ
)) < 0)

995  
”r
;

997 
	}
}

999 
	$¢d_pcm_hw_·¿m_»fše_muÉË
(
¢d_pcm_t
 *
pcm
,

1000 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1001 
¢d_pcm_hw_·¿m_t
 
v¬
,

1002 cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
¤c
)

1004 cÚ¡ 
¢d_š‹rv®_t
 *
™
 = 
	`hw_·¿m_š‹rv®_c
(
¤c
, 
v¬
);

1005 cÚ¡ 
¢d_š‹rv®_t
 *
¡
 = 
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
v¬
);

1006 ià(
	`¢d_š‹rv®_sšgË
(
™
)) {

1007 
be¡
 = 
	`¢d_š‹rv®_mš
(
™
), 
cur
, 
´ev
;

1008 
cur
 = 
be¡
;

1010 ià(
¡
->
max
 < 
cur
 || (¡->max =ğcu¸&& st->
İ’max
))

1012 ià(
™
->
mš
 <ğ
cur
 && ! (™->mš =ğcu¸&& 
¡
->
İ’mš
)) {

1013 ià(! 
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TRY
, 
v¬
, 
cur
, 0))

1016 
´ev
 = 
cur
;

1017 
cur
 +ğ
be¡
;

1018 ià(
cur
 <ğ
´ev
)

1022  
	`¢d_pcm_hw_·¿m_»fše_Ã¬
(
pcm
, 
·¿ms
, 
v¬
, 
¤c
);

1023 
	}
}

1027 
	$¢d_pcm_hw_·¿m_em±y
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1028 
¢d_pcm_hw_·¿m_t
 
v¬
)

1030 ià(
	`hw_is_mask
(
v¬
))

1031  
	`¢d_mask_em±y
(
	`hw_·¿m_mask_c
(
·¿ms
, 
v¬
));

1032 ià(
	`hw_is_š‹rv®
(
v¬
))

1033  
	`¢d_š‹rv®_em±y
(
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
v¬
));

1034 
	`as£¹
(0);

1035  -
EINVAL
;

1036 
	}
}

1038 
	$¢d_pcm_hw_·¿m_®ways_eq
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1039 
¢d_pcm_hw_·¿m_t
 
v¬
,

1040 cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms1
)

1042 ià(
	`hw_is_mask
(
v¬
))

1043  
	`¢d_mask_®ways_eq
(
	`hw_·¿m_mask_c
(
·¿ms
, 
v¬
),

1044 
	`hw_·¿m_mask_c
(
·¿ms1
, 
v¬
));

1045 ià(
	`hw_is_š‹rv®
(
v¬
))

1046  
	`¢d_š‹rv®_®ways_eq
(
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
v¬
),

1047 
	`hw_·¿m_š‹rv®_c
(
·¿ms1
, 
v¬
));

1048 
	`as£¹
(0);

1049  -
EINVAL
;

1050 
	}
}

1052 
	$¢d_pcm_hw_·¿m_Ãv”_eq
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1053 
¢d_pcm_hw_·¿m_t
 
v¬
,

1054 cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms1
)

1056 ià(
	`hw_is_mask
(
v¬
))

1057  
	`¢d_mask_Ãv”_eq
(
	`hw_·¿m_mask_c
(
·¿ms
, 
v¬
),

1058 
	`hw_·¿m_mask_c
(
·¿ms1
, 
v¬
));

1059 ià(
	`hw_is_š‹rv®
(
v¬
))

1060  
	`¢d_š‹rv®_Ãv”_eq
(
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
v¬
),

1061 
	`hw_·¿m_š‹rv®_c
(
·¿ms1
, 
v¬
));

1062 
	`as£¹
(0);

1063  -
EINVAL
;

1064 
	}
}

1067 
	#CHOOSE_DEBUG


	)

1081 
	$¢d_pcm_hw_·¿ms_choo£
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

1083 
”r
;

1084 #ifdeà
CHOOSE_DEBUG


1085 
¢d_ouut_t
 *
log
;

1086 
	`¢d_ouut_¡dio_©ch
(&
log
, 
¡d”r
, 0);

1087 
	`¢d_ouut_´štf
(
log
, "CHOOSE called:\n");

1088 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
log
);

1091 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
, 
NULL
, 0);

1092 ià(
”r
 < 0)

1093  
”r
;

1094 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
, 
NULL
, 0);

1095 ià(
”r
 < 0)

1096  
”r
;

1097 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_SUBFORMAT
, 
NULL
, 0);

1098 ià(
”r
 < 0)

1099  
”r
;

1100 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
NULL
, 0);

1101 ià(
”r
 < 0)

1102  
”r
;

1103 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_RATE
, 
NULL
, 0);

1104 ià(
”r
 < 0)

1105  
”r
;

1106 ià(
pcm
->
mš³riodtime
 > 0) {

1107 
mš
, 
max
;

1108 
dœ
 = 1;

1109 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, &
mš
, &
dœ
);

1110 ià(
”r
 >= 0)

1111 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘_max
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, &
max
, &
dœ
);

1112 ià(
”r
 >ğ0 && ()
mš
 < 
pcm
->
mš³riodtime
 &&

1113 ()
max
 > 
pcm
->
mš³riodtime
) {

1114 
mš
 = 
pcm
->
mš³riodtime
; 
dœ
 = 1;

1115 
	`¢d_pcm_hw_·¿m_£t_mš
(
pcm
, 
·¿ms
, 
SND_CHANGE
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, &
mš
, &
dœ
);

1118 ià(
pcm
->
com·t
) {

1120 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
NULL
, 0);

1121 ià(
”r
 < 0)

1122  
”r
;

1123 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 
NULL
, 0);

1124 ià(
”r
 < 0)

1125  
”r
;

1126 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_Ï¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, 
NULL
, 0);

1127 ià(
”r
 < 0)

1128  
”r
;

1131 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_Ï¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, 
NULL
, 0);

1132 ià(
”r
 < 0)

1133  
”r
;

1134 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 
NULL
, 0);

1135 ià(
”r
 < 0)

1136  
”r
;

1137 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
NULL
, 0);

1138 ià(
”r
 < 0)

1139  
”r
;

1141 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_fœ¡
(
pcm
, 
·¿ms
, 
SND_PCM_HW_PARAM_TICK_TIME
, 
NULL
, 0);

1142 ià(
”r
 < 0)

1143  
”r
;

1144 #ifdeà
CHOOSE_DEBUG


1145 
	`¢d_ouut_´štf
(
log
, "choose done\n");

1146 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
log
);

1147 
	`¢d_ouut_şo£
(
log
);

1150 
	}
}

1153 
	$¢d_pcm_hw_·¿m_couÁ
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1154 
¢d_pcm_hw_·¿m_t
 
v¬
)

1156 ià(
	`hw_is_mask
(
v¬
)) {

1157 cÚ¡ 
¢d_mask_t
 *
mask
 = 
	`hw_·¿m_mask_c
(
·¿ms
, 
v¬
);

1158  
	`¢d_mask_couÁ
(
mask
);

1160 ià(
	`hw_is_š‹rv®
(
v¬
)) {

1161 cÚ¡ 
¢d_š‹rv®_t
 *
i
 = 
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
v¬
);

1162  
	`¢d_š‹rv®_max
(
i
è- 
	`¢d_š‹rv®_mš
(i) + 1;

1164 
	`as£¹
(0);

1166 
	}
}

1169 
	$_¢d_pcm_hw_·¿m_»fše
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1170 
¢d_pcm_hw_·¿m_t
 
v¬
,

1171 cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
¤c
)

1173 
chªged
 = 0;

1174 ià(
	`hw_is_mask
(
v¬
)) {

1175 
¢d_mask_t
 *
d
 = 
	`hw_·¿m_mask
(
·¿ms
, 
v¬
);

1176 cÚ¡ 
¢d_mask_t
 *
s
 = 
	`hw_·¿m_mask_c
(
¤c
, 
v¬
);

1177 
chªged
 = 
	`¢d_mask_»fše
(
d
, 
s
);

1178 } ià(
	`hw_is_š‹rv®
(
v¬
)) {

1179 
¢d_š‹rv®_t
 *
d
 = 
	`hw_·¿m_š‹rv®
(
·¿ms
, 
v¬
);

1180 cÚ¡ 
¢d_š‹rv®_t
 *
s
 = 
	`hw_·¿m_š‹rv®_c
(
¤c
, 
v¬
);

1181 
chªged
 = 
	`¢d_š‹rv®_»fše
(
d
, 
s
);

1184 ià(
chªged
) {

1185 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

1186 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

1188  
chªged
;

1189 
	}
}

1192 
	$_¢d_pcm_hw_·¿m_cİy
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
, 
¢d_pcm_hw_·¿m_t
 
v¬
,

1193 cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
¤c
)

1195 ià(
	`hw_is_mask
(
v¬
)) {

1196 
¢d_mask_t
 *
d
 = 
	`hw_·¿m_mask
(
·¿ms
, 
v¬
);

1197 cÚ¡ 
¢d_mask_t
 *
s
 = 
	`hw_·¿m_mask_c
(
¤c
, 
v¬
);

1198 
	`¢d_mask_cİy
(
d
, 
s
);

1199 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

1200 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

1203 ià(
	`hw_is_š‹rv®
(
v¬
)) {

1204 
¢d_š‹rv®_t
 *
d
 = 
	`hw_·¿m_š‹rv®
(
·¿ms
, 
v¬
);

1205 cÚ¡ 
¢d_š‹rv®_t
 *
s
 = 
	`hw_·¿m_š‹rv®_c
(
¤c
, 
v¬
);

1206 
	`¢d_š‹rv®_cİy
(
d
, 
s
);

1207 
·¿ms
->
cmask
 |ğ1 << 
v¬
;

1208 
·¿ms
->
rmask
 |ğ1 << 
v¬
;

1211 
	`as£¹
(0);

1212 
	}
}

1215 
	$¢d_pcm_hw_·¿m_dump
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1216 
¢d_pcm_hw_·¿m_t
 
v¬
, 
¢d_ouut_t
 *
out
)

1218 ià(
	`hw_is_mask
(
v¬
)) {

1219 cÚ¡ 
¢d_mask_t
 *
mask
 = 
	`hw_·¿m_mask_c
(
·¿ms
, 
v¬
);

1220 ià(
	`¢d_mask_em±y
(
mask
))

1221 
	`¢d_ouut_puts
(
out
, " NONE");

1222 ià(
	`¢d_mask_fuÎ
(
mask
))

1223 
	`¢d_ouut_puts
(
out
, " ALL");

1225 
k
;

1226 
k
 = 0; k <ğ
SND_MASK_MAX
; ++k) {

1227 ià(
	`¢d_mask_‹¡
(
mask
, 
k
)) {

1228 cÚ¡ *
s
;

1229 
v¬
) {

1230 
SND_PCM_HW_PARAM_ACCESS
:

1231 
s
 = 
	`¢d_pcm_acûss_Çme
(
k
);

1233 
SND_PCM_HW_PARAM_FORMAT
:

1234 
s
 = 
	`¢d_pcm_fÜm©_Çme
(
k
);

1236 
SND_PCM_HW_PARAM_SUBFORMAT
:

1237 
s
 = 
	`¢d_pcm_subfÜm©_Çme
(
k
);

1240 
	`as£¹
(0);

1241 
s
 = 
NULL
;

1243 ià(
s
) {

1244 
	`¢d_ouut_putc
(
out
, ' ');

1245 
	`¢d_ouut_puts
(
out
, 
s
);

1252 ià(
	`hw_is_š‹rv®
(
v¬
)) {

1253 
	`¢d_š‹rv®_´št
(
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
v¬
), 
out
);

1256 
	`as£¹
(0);

1257 
	}
}

1259 
	#HW_PARAM
(
v
è[
SND_PCM_HW_PARAM_
##v] = #v

	)

1261 cÚ¡ *cÚ¡ 
	g¢d_pcm_hw_·¿m_Çmes
[] = {

1262 
HW_PARAM
(
ACCESS
),

1263 
HW_PARAM
(
FORMAT
),

1264 
HW_PARAM
(
SUBFORMAT
),

1265 
HW_PARAM
(
SAMPLE_BITS
),

1266 
HW_PARAM
(
FRAME_BITS
),

1267 
HW_PARAM
(
CHANNELS
),

1268 
HW_PARAM
(
RATE
),

1269 
HW_PARAM
(
PERIOD_TIME
),

1270 
HW_PARAM
(
PERIOD_SIZE
),

1271 
HW_PARAM
(
PERIOD_BYTES
),

1272 
HW_PARAM
(
PERIODS
),

1273 
HW_PARAM
(
BUFFER_TIME
),

1274 
HW_PARAM
(
BUFFER_SIZE
),

1275 
HW_PARAM
(
BUFFER_BYTES
),

1276 
HW_PARAM
(
TICK_TIME
),

1279 cÚ¡ *
	$¢d_pcm_hw_·¿m_Çme
(
¢d_pcm_hw_·¿m_t
 
·¿m
)

1281 
	`as£¹
(
·¿m
 <ğ
SND_PCM_HW_PARAM_LAST_INTERVAL
);

1282  
¢d_pcm_hw_·¿m_Çmes
[
·¿m
];

1283 
	}
}

1288 
	s_¢d_pcm_hw_¡¿‹gy
 {

1289 
	mbadÃss_mš
, 
	mbadÃss_max
;

1290 (*
	mchoo£_·¿m
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
	m·¿ms
,

1291 
¢d_pcm_t
 *
	mpcm
,

1292 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_t
 *
	m¡¿‹gy
);

1293 (*
	mÃxt_v®ue
)(
¢d_pcm_hw_·¿ms_t
 *
	m·¿ms
,

1294 
	m·¿m
,

1295 
	mv®ue
, *
	mdœ
,

1296 
¢d_pcm_t
 *
	mpcm
,

1297 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_t
 *
	m¡¿‹gy
);

1298 (*
	mmš_badÃss
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
	m·¿ms
,

1299 
	mmax_badÃss
,

1300 
¢d_pcm_t
 *
	mpcm
,

1301 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_t
 *
	m¡¿‹gy
);

1302 *
	m´iv©e_d©a
;

1303 (*
	mä“
)(
¢d_pcm_hw_¡¿‹gy_t
 *
	m¡¿‹gy
);

1307 
_¢d_pcm_hw_¡¿‹gy_sim¶e
 
	t¢d_pcm_hw_¡¿‹gy_sim¶e_t
;

1309 
	s_¢d_pcm_hw_¡¿‹gy_sim¶e
 {

1310 
	mv®id
;

1311 
	mÜd”
;

1312 (*
	mÃxt_v®ue
)(
¢d_pcm_hw_·¿ms_t
 *
	m·¿ms
,

1313 
	m·¿m
,

1314 
	mv®ue
, *
	mdœ
,

1315 
¢d_pcm_t
 *
	mpcm
,

1316 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
	m·r
);

1317 (*
	mmš_badÃss
)(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
	m·¿ms
,

1318 
	m·¿m
,

1319 
¢d_pcm_t
 *
	mpcm
,

1320 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
	m·r
);

1321 *
	m´iv©e_d©a
;

1322 (*
	mä“
)(
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
	m¡¿‹gy
);

1325 
	s_¢d_pcm_hw_¡¿‹gy_sim¶e_Ã¬
 {

1326 
	mbe¡
;

1327 
	mmul
;

1328 } 
	t¢d_pcm_hw_¡¿‹gy_sim¶e_Ã¬_t
;

1330 
	s_¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs
 {

1331 
	mcouÁ
;

1333 
¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_li¡_t
 *
	mchoiûs
;

1334 } 
	t¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_t
;

1336 
	$¢d_pcm_hw_·¿ms_¡¿‹gy
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1337 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_t
 *
¡¿‹gy
,

1338 
badÃss_mš
,

1339 
badÃss_max
)

1341 
¢d_pcm_hw_·¿ms_t
 
be¡_·¿ms
;

1342 
v¬
;

1343 
v®ue
, 
dœ
;

1344 
be¡_badÃss
;

1345 
badÃss
 = 
¡¿‹gy
->
	`mš_badÃss
(
·¿ms
, 
badÃss_max
, 
pcm
, strategy);

1346 
¢d_pcm_hw_·¿ms_t
 
·¿ms1
;

1348 
	`´štf
("\nBadÃss: %d\n", 
badÃss
);

1349 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
¡dout
);

1351 ià(
badÃss
 < 0)

1352  
badÃss
;

1353 ià(()
badÃss
 > 
badÃss_mš
)

1354 
badÃss_mš
 = badness_min;

1355 
v¬
 = 
¡¿‹gy
->
	`choo£_·¿m
(
·¿ms
, 
pcm
, strategy);

1356 ià(
v¬
 < 0)

1357  
badÃss
;

1358 
be¡_badÃss
 = 
UINT_MAX
;

1359 
v®ue
 = -1;

1361 
·¿ms1
 = *
·¿ms
;

1362 
v®ue
 = 
¡¿‹gy
->
	`Ãxt_v®ue
(&
·¿ms1
, 
v¬
, v®ue, &
dœ
, 
pcm
, strategy);

1363 ià(
v®ue
 < 0)

1365 
badÃss
 = 
	`¢d_pcm_hw_·¿ms_¡¿‹gy
(
pcm
, &
·¿ms1
, 
¡¿‹gy
, 
badÃss_mš
, 
badÃss_max
);

1366 ià(
badÃss
 >= 0) {

1367 ià((è
badÃss
 <ğ
badÃss_mš
) {

1368 *
·¿ms
 = 
·¿ms1
;

1369  
badÃss
;

1371 
be¡_badÃss
 = 
badÃss
;

1372 
be¡_·¿ms
 = 
·¿ms1
;

1373 
badÃss_max
 = 
badÃss
 - 1;

1376 ià(
be¡_badÃss
 =ğ
UINT_MAX
) {

1377  -
EINVAL
;

1379 *
·¿ms
 = 
be¡_·¿ms
;

1380  
be¡_badÃss
;

1381 
	}
}

1383 
	$¢d_pcm_hw_¡¿‹gy_sim¶e_ä“
(
¢d_pcm_hw_¡¿‹gy_t
 *
¡¿‹gy
)

1385 
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
·rs
 = 
¡¿‹gy
->
´iv©e_d©a
;

1386 
k
;

1387 
k
 = 0; k <ğ
SND_PCM_HW_PARAM_LAST_INTERVAL
; ++k) {

1388 ià(
·rs
[
k
].
v®id
 &&…¬s[k].
ä“
)

1389 
·rs
[
k
].
	`ä“
(&pars[k]);

1391 
	`ä“
(
·rs
);

1392 
	}
}

1394 
	$¢d_pcm_hw_¡¿‹gy_sim¶e_choo£_·¿m
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1395 
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

1396 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_t
 *
¡¿‹gy
)

1398 
¢d_pcm_hw_·¿m_t
 
v¬
;

1399 
be¡_v¬
 = -1;

1400 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
·rs
 = 
¡¿‹gy
->
´iv©e_d©a
;

1401 
mš_choiûs
 = 
UINT_MAX
;

1402 
mš_Üd”
 = 
UINT_MAX
;

1403 
v¬
 = 0; v¬ <ğ
SND_PCM_HW_PARAM_LAST_INTERVAL
; ++var) {

1404 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
p
 = &
·rs
[
v¬
];

1405 
choiûs
;

1406 ià(!
p
->
v®id
)

1408 
choiûs
 = 
	`¢d_pcm_hw_·¿m_couÁ
(
·¿ms
, 
v¬
);

1409 ià(
choiûs
 == 1)

1411 
	`as£¹
(
choiûs
 != 0);

1412 ià(
p
->
Üd”
 < 
mš_Üd”
 ||

1413 (
p
->
Üd”
 =ğ
mš_Üd”
 &&

1414 
choiûs
 < 
mš_choiûs
)) {

1415 
mš_Üd”
 = 
p
->
Üd”
;

1416 
mš_choiûs
 = 
choiûs
;

1417 
be¡_v¬
 = 
v¬
;

1420  
be¡_v¬
;

1421 
	}
}

1423 
	$¢d_pcm_hw_¡¿‹gy_sim¶e_Ãxt_v®ue
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1424 
¢d_pcm_hw_·¿m_t
 
v¬
,

1425 
v®ue
, *
dœ
,

1426 
¢d_pcm_t
 *
pcm
,

1427 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_t
 *
¡¿‹gy
)

1429 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
·rs
 = 
¡¿‹gy
->
´iv©e_d©a
;

1430 
	`as£¹
(
·rs
[
v¬
].
v®id
);

1431  
·rs
[
v¬
].
	`Ãxt_v®ue
(
·¿ms
, v¬, 
v®ue
, 
dœ
, 
pcm
, &pars[var]);

1432 
	}
}

1435 
	$¢d_pcm_hw_¡¿‹gy_sim¶e_mš_badÃss
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1436 
max_badÃss
,

1437 
¢d_pcm_t
 *
pcm
,

1438 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_t
 *
¡¿‹gy
)

1440 
¢d_pcm_hw_·¿m_t
 
v¬
;

1441 
badÃss
 = 0;

1442 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
·rs
 = 
¡¿‹gy
->
´iv©e_d©a
;

1443 
v¬
 = 0; v¬ <ğ
SND_PCM_HW_PARAM_LAST_INTERVAL
; ++var) {

1444 
b
;

1445 ià(!
·rs
[
v¬
].
v®id
)

1447 
b
 = 
·rs
[
v¬
].
	`mš_badÃss
(
·¿ms
, v¬, 
pcm
, &pars[var]);

1448 ià(
b
 > 
max_badÃss
 || max_badÃs - b < 
badÃss
)

1449  -
E2BIG
;

1450 
badÃss
 +ğ
b
;

1452  
badÃss
;

1453 
	}
}

1456 
	$¢d_pcm_hw_¡¿‹gy_sim¶e_Ã¬_ä“
(
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
·r
)

1458 
¢d_pcm_hw_¡¿‹gy_sim¶e_Ã¬_t
 *
p
 = 
·r
->
´iv©e_d©a
;

1459 
	`ä“
(
p
);

1460 
	}
}

1462 
	$¢d_pcm_hw_¡¿‹gy_sim¶e_Ã¬_mš_badÃss
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1463 
¢d_pcm_hw_·¿m_t
 
v¬
,

1464 
¢d_pcm_t
 *
pcm
,

1465 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
·r
)

1467 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_sim¶e_Ã¬_t
 *
p
 = 
·r
->
´iv©e_d©a
;

1468 
¢d_pcm_hw_·¿ms_t
 
·¿ms1
 = *
·¿ms
;

1469 
v®ue
 = 
	`¢d_pcm_hw_·¿m_£t_Ã¬
(
pcm
, &
·¿ms1
, 
v¬
, 
p
->
be¡
, 0);

1470 
diff
;

1471 
	`as£¹
(
v®ue
 >= 0);

1472 
diff
 = 
p
->
be¡
 - 
v®ue
;

1473 ià(
diff
 < 0)

1474 
diff
 = -diff;

1475  
diff
 * 
p
->
mul
;

1476 
	}
}

1478 
	$¢d_pcm_hw_¡¿‹gy_sim¶e_Ã¬_Ãxt_v®ue
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1479 
¢d_pcm_hw_·¿m_t
 
v¬
,

1480 
v®ue
, *
dœ
,

1481 
¢d_pcm_t
 *
pcm
,

1482 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
·r
)

1484 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_sim¶e_Ã¬_t
 *
p
 = 
·r
->
´iv©e_d©a
;

1485 ià(
v®ue
 < 0) {

1486 *
dœ
 = 0;

1487  
	`¢d_pcm_hw_·¿m_£t_Ã¬
(
pcm
, 
·¿ms
, 
v¬
, 
p
->
be¡
, 
dœ
);

1489  
	`¢d_pcm_hw_·¿m_£t_Ãxt
(
pcm
, 
·¿ms
, 
v¬
, 
p
->
be¡
, 0, 
v®ue
, 
dœ
);

1490 
	}
}

1492 
	$¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_ä“
(
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
·r
)

1494 
¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_t
 *
p
 = 
·r
->
´iv©e_d©a
;

1496 
	`ä“
(
p
);

1497 
	}
}

1499 
	$¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_mš_badÃss
(cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1500 
¢d_pcm_hw_·¿m_t
 
v¬
,

1501 
¢d_pcm_t
 *
pcm
,

1502 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
·r
)

1504 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_t
 *
p
 = 
·r
->
´iv©e_d©a
;

1505 
k
;

1506 
k
 = 0; k < 
p
->
couÁ
; ++k) {

1507 ià(
	`¢d_pcm_hw_·¿m_£t
(
pcm
, (
¢d_pcm_hw_·¿ms_t
 *è
·¿ms
, 
SND_TEST
, 
v¬
, 
p
->
choiûs
[
k
].
v®ue
, 0))

1508  
p
->
choiûs
[
k
].
badÃss
;

1510 
	`as£¹
(0);

1511  
UINT_MAX
;

1512 
	}
}

1514 
	$¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_Ãxt_v®ue
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1515 
¢d_pcm_hw_·¿m_t
 
v¬
,

1516 
v®ue
, *
dœ
,

1517 
¢d_pcm_t
 *
pcm
,

1518 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
·r
)

1520 cÚ¡ 
¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_t
 *
p
 = 
·r
->
´iv©e_d©a
;

1521 
k
 = 0;

1522 ià(
v®ue
 >= 0) {

1523 ; 
k
 < 
p
->
couÁ
; ++k) {

1524 ià(
p
->
choiûs
[
k
].
v®ue
 == () value) {

1525 
k
++;

1530 ; 
k
 < 
p
->
couÁ
; ++k) {

1531 
v
 = 
p
->
choiûs
[
k
].
v®ue
;

1532 
”r
 = 
	`¢d_pcm_hw_·¿m_£t
(
pcm
, 
·¿ms
, 
SND_TRY
, 
v¬
, 
v
, 0);

1533 ià(
”r
 < 0)

1535 *
dœ
 = 0;

1536  
v
;

1539 
	}
}

1541 
	$¢d_pcm_hw_¡¿‹gy_ä“
(
¢d_pcm_hw_¡¿‹gy_t
 *
¡¿‹gy
)

1543 ià(
¡¿‹gy
->
ä“
)

1544 
¡¿‹gy
->
	`ä“
(strategy);

1545 
	`ä“
(
¡¿‹gy
);

1546 
	}
}

1548 
	$¢d_pcm_hw_¡¿‹gy_sim¶e
(
¢d_pcm_hw_¡¿‹gy_t
 **
¡¿‹gyp
,

1549 
badÃss_mš
,

1550 
badÃss_max
)

1552 
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
d©a
;

1553 
¢d_pcm_hw_¡¿‹gy_t
 *
s
;

1554 
	`as£¹
(
¡¿‹gyp
);

1555 
d©a
 = 
	`ÿÎoc
(
SND_PCM_HW_PARAM_LAST_INTERVAL
 + 1, (*data));

1556 ià(!
d©a
)

1557  -
ENOMEM
;

1558 
s
 = 
	`ÿÎoc
(1, (*s));

1559 ià(!
s
) {

1560 
	`ä“
(
d©a
);

1561  -
ENOMEM
;

1563 
s
->
choo£_·¿m
 = 
¢d_pcm_hw_¡¿‹gy_sim¶e_choo£_·¿m
;

1564 
s
->
Ãxt_v®ue
 = 
¢d_pcm_hw_¡¿‹gy_sim¶e_Ãxt_v®ue
;

1565 
s
->
mš_badÃss
 = 
¢d_pcm_hw_¡¿‹gy_sim¶e_mš_badÃss
;

1566 
s
->
badÃss_mš
 = badness_min;

1567 
s
->
badÃss_max
 = badness_max;

1568 
s
->
´iv©e_d©a
 = 
d©a
;

1569 
s
->
ä“
 = 
¢d_pcm_hw_¡¿‹gy_sim¶e_ä“
;

1570 *
¡¿‹gyp
 = 
s
;

1572 
	}
}

1574 
	$¢d_pcm_hw_¡¿‹gy_sim¶e_Ã¬
(
¢d_pcm_hw_¡¿‹gy_t
 *
¡¿‹gy
,

1575 
Üd”
,

1576 
¢d_pcm_hw_·¿m_t
 
v¬
,

1577 
be¡
,

1578 
mul
)

1580 
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
s
 = 
¡¿‹gy
->
´iv©e_d©a
;

1581 
¢d_pcm_hw_¡¿‹gy_sim¶e_Ã¬_t
 *
d©a
;

1582 
	`as£¹
(
¡¿‹gy
);

1583 
	`as£¹
(
v¬
 <ğ
SND_PCM_HW_PARAM_LAST_INTERVAL
);

1584 
	`as£¹
(!
s
->
v®id
);

1585 
d©a
 = 
	`ÿÎoc
(1, (*data));

1586 ià(!
d©a
)

1587  -
ENOMEM
;

1588 
d©a
->
be¡
 = best;

1589 
d©a
->
mul
 = mul;

1590 
s
 +ğ
v¬
;

1591 
s
->
Üd”
 = order;

1592 
s
->
v®id
 = 1;

1593 
s
->
Ãxt_v®ue
 = 
¢d_pcm_hw_¡¿‹gy_sim¶e_Ã¬_Ãxt_v®ue
;

1594 
s
->
mš_badÃss
 = 
¢d_pcm_hw_¡¿‹gy_sim¶e_Ã¬_mš_badÃss
;

1595 
s
->
´iv©e_d©a
 = 
d©a
;

1596 
s
->
ä“
 = 
¢d_pcm_hw_¡¿‹gy_sim¶e_Ã¬_ä“
;

1598 
	}
}

1600 
	$¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs
(
¢d_pcm_hw_¡¿‹gy_t
 *
¡¿‹gy
,

1601 
Üd”
,

1602 
¢d_pcm_hw_·¿m_t
 
v¬
,

1603 
couÁ
,

1604 
¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_li¡_t
 *
choiûs
)

1606 
¢d_pcm_hw_¡¿‹gy_sim¶e_t
 *
s
 = 
¡¿‹gy
->
´iv©e_d©a
;

1607 
¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_t
 *
d©a
;

1608 
	`as£¹
(
¡¿‹gy
);

1609 
	`as£¹
(
v¬
 <ğ
SND_PCM_HW_PARAM_LAST_INTERVAL
);

1610 
	`as£¹
(!
s
->
v®id
);

1611 
d©a
 = 
	`ÿÎoc
(1, (*data));

1612 ià(!
d©a
)

1613  -
ENOMEM
;

1614 
d©a
->
couÁ
 = count;

1615 
d©a
->
choiûs
 = choices;

1616 
s
 +ğ
v¬
;

1617 
s
->
v®id
 = 1;

1618 
s
->
Üd”
 = order;

1619 
s
->
Ãxt_v®ue
 = 
¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_Ãxt_v®ue
;

1620 
s
->
mš_badÃss
 = 
¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_mš_badÃss
;

1621 
s
->
´iv©e_d©a
 = 
d©a
;

1622 
s
->
ä“
 = 
¢d_pcm_hw_¡¿‹gy_sim¶e_choiûs_ä“
;

1624 
	}
}

1626 
	$¢d_pcm_hw_·¿ms_Œy_ex¶aš_çu»1
(
¢d_pcm_t
 *
pcm
,

1627 
¢d_pcm_hw_·¿ms_t
 *
ç
,

1628 
¢d_pcm_hw_·¿ms_t
 *
sucûss
,

1629 
d•th
,

1630 
¢d_ouut_t
 *
out
)

1632 
¢d_pcm_hw_·¿m_t
 
v¬
;

1633 
¢d_pcm_hw_·¿ms_t
 
i
;

1634 ià(
d•th
 < 1)

1635  -
ENOENT
;

1636 
v¬
 = 0; v¬ <ğ
SND_PCM_HW_PARAM_LAST_INTERVAL
; var++) {

1637 
”r
;

1638 
i
 = *
sucûss
;

1639 
	`_¢d_pcm_hw_·¿m_cİy
(&
i
, 
v¬
, 
ç
);

1640 
”r
 = 
	`¢d_pcm_hw_»fše
(
pcm
, &
i
);

1641 ià(
”r
 == 0 &&

1642 
	`¢d_pcm_hw_·¿ms_Œy_ex¶aš_çu»1
(
pcm
, 
ç
, &
i
, 
d•th
 - 1, 
out
) < 0)

1644 
	`¢d_ouut_´štf
(
out
, "%s: ", 
	`¢d_pcm_hw_·¿m_Çme
(
v¬
));

1645 
	`¢d_pcm_hw_·¿m_dump
(
ç
, 
v¬
, 
out
);

1646 
	`¢d_ouut_putc
(
out
, '\n');

1649  -
ENOENT
;

1650 
	}
}

1652 
	$¢d_pcm_hw_·¿ms_Œy_ex¶aš_çu»
(
¢d_pcm_t
 *
pcm
,

1653 
¢d_pcm_hw_·¿ms_t
 *
ç
,

1654 
¢d_pcm_hw_·¿ms_t
 *
sucûss
,

1655 
d•th
,

1656 
¢d_ouut_t
 *
out
)

1658 
¢d_pcm_hw_·¿ms_t
 
i
, 
ªy
;

1659 
”r
;

1660 
¢d_pcm_hw_·¿m_t
 
v¬
;

1661 
dÚe
 = 0;

1662 
	`as£¹
(
pcm
 && 
ç
);

1663 
v¬
 = 0; v¬ <ğ
SND_PCM_HW_PARAM_LAST_INTERVAL
; var++) {

1664 ià(!
	`¢d_pcm_hw_·¿m_em±y
(
ç
, 
v¬
))

1666 
	`¢d_ouut_´štf
(
out
, "% i em±y\n", 
	`¢d_pcm_hw_·¿m_Çme
(
v¬
));

1667 
dÚe
 = 1;

1669 ià(
dÚe
)

1671 
i
 = *
ç
;

1672 
”r
 = 
	`¢d_pcm_hw_»fše
(
pcm
, &
i
);

1673 ià(
”r
 == 0) {

1674 
	`¢d_ouut_´štf
(
out
, "Configuration is virtually correct\n");

1677 ià(!
sucûss
) {

1678 
	`¢d_pcm_hw_·¿ms_ªy
(
pcm
, &
ªy
);

1679 
sucûss
 = &
ªy
;

1681  
	`¢d_pcm_hw_·¿ms_Œy_ex¶aš_çu»1
(
pcm
, 
ç
, 
sucûss
, 
d•th
, 
out
);

1682 
	}
}

1686 
_¢d_pcm_hw_ruË
 
	t¢d_pcm_hw_ruË_t
;

1688 (*
	t¢d_pcm_hw_ruË_func_t
)(
	t¢d_pcm_hw_·¿ms_t
 *
	t·¿ms
,

1689 cÚ¡ 
	t¢d_pcm_hw_ruË_t
 *
	truË
);

1691 
	s_¢d_pcm_hw_ruË
 {

1692 
v¬
;

1693 
¢d_pcm_hw_ruË_func_t
 
func
;

1694 
d•s
[4];

1695 *
´iv©e_d©a
;

1698 
	$¢d_pcm_hw_ruË_mul
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1699 cÚ¡ 
¢d_pcm_hw_ruË_t
 *
ruË
)

1701 
¢d_š‹rv®_t
 
t
;

1702 
	`¢d_š‹rv®_mul
(
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
ruË
->
d•s
[0]),

1703 
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
ruË
->
d•s
[1]), &
t
);

1704  
	`¢d_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
ruË
->
v¬
), &
t
);

1705 
	}
}

1707 
	$¢d_pcm_hw_ruË_div
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1708 cÚ¡ 
¢d_pcm_hw_ruË_t
 *
ruË
)

1710 
¢d_š‹rv®_t
 
t
;

1711 
	`¢d_š‹rv®_div
(
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
ruË
->
d•s
[0]),

1712 
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
ruË
->
d•s
[1]), &
t
);

1713  
	`¢d_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
ruË
->
v¬
), &
t
);

1714 
	}
}

1716 
	$¢d_pcm_hw_ruË_muldivk
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1717 cÚ¡ 
¢d_pcm_hw_ruË_t
 *
ruË
)

1719 
¢d_š‹rv®_t
 
t
;

1720 
	`¢d_š‹rv®_muldivk
(
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
ruË
->
d•s
[0]),

1721 
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
ruË
->
d•s
[1]),

1722 (è
ruË
->
´iv©e_d©a
, &
t
);

1723  
	`¢d_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
ruË
->
v¬
), &
t
);

1724 
	}
}

1726 
	$¢d_pcm_hw_ruË_mulkdiv
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1727 cÚ¡ 
¢d_pcm_hw_ruË_t
 *
ruË
)

1729 
¢d_š‹rv®_t
 
t
;

1730 
	`¢d_š‹rv®_mulkdiv
(
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
ruË
->
d•s
[0]),

1731 (è
ruË
->
´iv©e_d©a
,

1732 
	`hw_·¿m_š‹rv®_c
(
·¿ms
, 
ruË
->
d•s
[1]), &
t
);

1733  
	`¢d_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
ruË
->
v¬
), &
t
);

1734 
	}
}

1736 
	$¢d_pcm_hw_ruË_fÜm©
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1737 cÚ¡ 
¢d_pcm_hw_ruË_t
 *
ruË
)

1739 
chªged
 = 0;

1740 
¢d_pcm_fÜm©_t
 
k
;

1741 
¢d_mask_t
 *
mask
 = 
	`hw_·¿m_mask
(
·¿ms
, 
ruË
->
v¬
);

1742 
¢d_š‹rv®_t
 *
i
 = 
	`hw_·¿m_š‹rv®
(
·¿ms
, 
ruË
->
d•s
[0]);

1743 
k
 = 0; k <ğ
SND_PCM_FORMAT_LAST
; k++) {

1744 
b™s
;

1745 ià(!
	`¢d_pcm_fÜm©_mask_‹¡
(
mask
, 
k
))

1747 
b™s
 = 
	`¢d_pcm_fÜm©_physiÿl_width
(
k
);

1748 ià(
b™s
 < 0)

1750 ià(!
	`¢d_š‹rv®_‹¡
(
i
, (è
b™s
)) {

1751 
	`¢d_pcm_fÜm©_mask_»£t
(
mask
, 
k
);

1752 ià(
	`¢d_mask_em±y
(
mask
))

1753  -
EINVAL
;

1754 
chªged
 = 1;

1757  
chªged
;

1758 
	}
}

1761 
	$¢d_pcm_hw_ruË_§m¶e_b™s
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

1762 cÚ¡ 
¢d_pcm_hw_ruË_t
 *
ruË
)

1764 
mš
, 
max
;

1765 
¢d_pcm_fÜm©_t
 
k
;

1766 
¢d_š‹rv®_t
 *
i
 = 
	`hw_·¿m_š‹rv®
(
·¿ms
, 
ruË
->
v¬
);

1767 
¢d_mask_t
 *
mask
 = 
	`hw_·¿m_mask
(
·¿ms
, 
ruË
->
d•s
[0]);

1768 
c
, 
chªged
 = 0;

1769 
mš
 = 
UINT_MAX
;

1770 
max
 = 0;

1771 
k
 = 0; k <ğ
SND_PCM_FORMAT_LAST
; k++) {

1772 
b™s
;

1773 ià(!
	`¢d_pcm_fÜm©_mask_‹¡
(
mask
, 
k
))

1775 
b™s
 = 
	`¢d_pcm_fÜm©_physiÿl_width
(
k
);

1776 ià(
b™s
 < 0)

1778 ià(
mš
 > ()
b™s
)

1779 
mš
 = 
b™s
;

1780 ià(
max
 < ()
b™s
)

1781 
max
 = 
b™s
;

1783 
c
 = 
	`¢d_š‹rv®_»fše_mš
(
i
, 
mš
, 0);

1784 ià(
c
 < 0)

1785  
c
;

1786 ià(
c
)

1787 
chªged
 = 1;

1788 
c
 = 
	`¢d_š‹rv®_»fše_max
(
i
, 
max
, 0);

1789 ià(
c
 < 0)

1790  
c
;

1791 ià(
c
)

1792 
chªged
 = 1;

1793  
chªged
;

1794 
	}
}

1796 cÚ¡ 
¢d_pcm_hw_ruË_t
 
	g»fše_ruËs
[] = {

1798 .
v¬
 = 
SND_PCM_HW_PARAM_FORMAT
,

1799 .
	gfunc
 = 
¢d_pcm_hw_ruË_fÜm©
,

1800 .
	gd•s
 = { 
SND_PCM_HW_PARAM_SAMPLE_BITS
, -1 },

1801 .
	g´iv©e_d©a
 = 0,

1804 .
	gv¬
 = 
SND_PCM_HW_PARAM_SAMPLE_BITS
,

1805 .
	gfunc
 = 
¢d_pcm_hw_ruË_§m¶e_b™s
,

1806 .
	gd•s
 = { 
SND_PCM_HW_PARAM_FORMAT
,

1807 
SND_PCM_HW_PARAM_SAMPLE_BITS
, -1 },

1808 .
	g´iv©e_d©a
 = 0,

1811 .
	gv¬
 = 
SND_PCM_HW_PARAM_SAMPLE_BITS
,

1812 .
	gfunc
 = 
¢d_pcm_hw_ruË_div
,

1813 .
	gd•s
 = { 
SND_PCM_HW_PARAM_FRAME_BITS
,

1814 
SND_PCM_HW_PARAM_CHANNELS
, -1 },

1815 .
	g´iv©e_d©a
 = 0,

1818 .
	gv¬
 = 
SND_PCM_HW_PARAM_FRAME_BITS
,

1819 .
	gfunc
 = 
¢d_pcm_hw_ruË_mul
,

1820 .
	gd•s
 = { 
SND_PCM_HW_PARAM_SAMPLE_BITS
,

1821 
SND_PCM_HW_PARAM_CHANNELS
, -1 },

1822 .
	g´iv©e_d©a
 = 0,

1825 .
	gv¬
 = 
SND_PCM_HW_PARAM_FRAME_BITS
,

1826 .
	gfunc
 = 
¢d_pcm_hw_ruË_mulkdiv
,

1827 .
	gd•s
 = { 
SND_PCM_HW_PARAM_PERIOD_BYTES
,

1828 
SND_PCM_HW_PARAM_PERIOD_SIZE
, -1 },

1829 .
	g´iv©e_d©a
 = (*) 8,

1832 .
	gv¬
 = 
SND_PCM_HW_PARAM_FRAME_BITS
,

1833 .
	gfunc
 = 
¢d_pcm_hw_ruË_mulkdiv
,

1834 .
	gd•s
 = { 
SND_PCM_HW_PARAM_BUFFER_BYTES
,

1835 
SND_PCM_HW_PARAM_BUFFER_SIZE
, -1 },

1836 .
	g´iv©e_d©a
 = (*) 8,

1839 .
	gv¬
 = 
SND_PCM_HW_PARAM_CHANNELS
,

1840 .
	gfunc
 = 
¢d_pcm_hw_ruË_div
,

1841 .
	gd•s
 = { 
SND_PCM_HW_PARAM_FRAME_BITS
,

1842 
SND_PCM_HW_PARAM_SAMPLE_BITS
, -1 },

1843 .
	g´iv©e_d©a
 = 0,

1846 .
	gv¬
 = 
SND_PCM_HW_PARAM_RATE
,

1847 .
	gfunc
 = 
¢d_pcm_hw_ruË_mulkdiv
,

1848 .
	gd•s
 = { 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

1849 
SND_PCM_HW_PARAM_PERIOD_TIME
, -1 },

1850 .
	g´iv©e_d©a
 = (*) 1000000,

1853 .
	gv¬
 = 
SND_PCM_HW_PARAM_RATE
,

1854 .
	gfunc
 = 
¢d_pcm_hw_ruË_mulkdiv
,

1855 .
	gd•s
 = { 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1856 
SND_PCM_HW_PARAM_BUFFER_TIME
, -1 },

1857 .
	g´iv©e_d©a
 = (*) 1000000,

1860 .
	gv¬
 = 
SND_PCM_HW_PARAM_PERIODS
,

1861 .
	gfunc
 = 
¢d_pcm_hw_ruË_div
,

1862 .
	gd•s
 = { 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1863 
SND_PCM_HW_PARAM_PERIOD_SIZE
, -1 },

1864 .
	g´iv©e_d©a
 = 0,

1867 .
	gv¬
 = 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

1868 .
	gfunc
 = 
¢d_pcm_hw_ruË_div
,

1869 .
	gd•s
 = { 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1870 
SND_PCM_HW_PARAM_PERIODS
, -1 },

1871 .
	g´iv©e_d©a
 = 0,

1874 .
	gv¬
 = 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

1875 .
	gfunc
 = 
¢d_pcm_hw_ruË_mulkdiv
,

1876 .
	gd•s
 = { 
SND_PCM_HW_PARAM_PERIOD_BYTES
,

1877 
SND_PCM_HW_PARAM_FRAME_BITS
, -1 },

1878 .
	g´iv©e_d©a
 = (*) 8,

1881 .
	gv¬
 = 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

1882 .
	gfunc
 = 
¢d_pcm_hw_ruË_muldivk
,

1883 .
	gd•s
 = { 
SND_PCM_HW_PARAM_PERIOD_TIME
,

1884 
SND_PCM_HW_PARAM_RATE
, -1 },

1885 .
	g´iv©e_d©a
 = (*) 1000000,

1888 .
	gv¬
 = 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1889 .
	gfunc
 = 
¢d_pcm_hw_ruË_mul
,

1890 .
	gd•s
 = { 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

1891 
SND_PCM_HW_PARAM_PERIODS
, -1 },

1892 .
	g´iv©e_d©a
 = 0,

1895 .
	gv¬
 = 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1896 .
	gfunc
 = 
¢d_pcm_hw_ruË_mulkdiv
,

1897 .
	gd•s
 = { 
SND_PCM_HW_PARAM_BUFFER_BYTES
,

1898 
SND_PCM_HW_PARAM_FRAME_BITS
, -1 },

1899 .
	g´iv©e_d©a
 = (*) 8,

1902 .
	gv¬
 = 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1903 .
	gfunc
 = 
¢d_pcm_hw_ruË_muldivk
,

1904 .
	gd•s
 = { 
SND_PCM_HW_PARAM_BUFFER_TIME
,

1905 
SND_PCM_HW_PARAM_RATE
, -1 },

1906 .
	g´iv©e_d©a
 = (*) 1000000,

1909 .
	gv¬
 = 
SND_PCM_HW_PARAM_PERIOD_BYTES
,

1910 .
	gfunc
 = 
¢d_pcm_hw_ruË_muldivk
,

1911 .
	gd•s
 = { 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

1912 
SND_PCM_HW_PARAM_FRAME_BITS
, -1 },

1913 .
	g´iv©e_d©a
 = (*) 8,

1916 .
	gv¬
 = 
SND_PCM_HW_PARAM_BUFFER_BYTES
,

1917 .
	gfunc
 = 
¢d_pcm_hw_ruË_muldivk
,

1918 .
	gd•s
 = { 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1919 
SND_PCM_HW_PARAM_FRAME_BITS
, -1 },

1920 .
	g´iv©e_d©a
 = (*) 8,

1923 .
	gv¬
 = 
SND_PCM_HW_PARAM_PERIOD_TIME
,

1924 .
	gfunc
 = 
¢d_pcm_hw_ruË_mulkdiv
,

1925 .
	gd•s
 = { 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

1926 
SND_PCM_HW_PARAM_RATE
, -1 },

1927 .
	g´iv©e_d©a
 = (*) 1000000,

1930 .
	gv¬
 = 
SND_PCM_HW_PARAM_BUFFER_TIME
,

1931 .
	gfunc
 = 
¢d_pcm_hw_ruË_mulkdiv
,

1932 .
	gd•s
 = { 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1933 
SND_PCM_HW_PARAM_RATE
, -1 },

1934 .
	g´iv©e_d©a
 = (*) 1000000,

1938 
	#RULES
 ((
»fše_ruËs
è/ Ôefše_ruËs[0]))

	)

1939 
	#PCM_BIT
(
x
) \

1940 (1U << ((
x
è< 32 ? (xè: ((xè- 32)))

	)

1942 cÚ¡ 
¢d_mask_t
 
	g»fše_masks
[
SND_PCM_HW_PARAM_LAST_MASK
 - 
SND_PCM_HW_PARAM_FIRST_MASK
 + 1] = {

1943 [
SND_PCM_HW_PARAM_ACCESS
 - 
SND_PCM_HW_PARAM_FIRST_MASK
] = {

1944 .
b™s
 = {

1945 
PCM_BIT
(
SNDRV_PCM_ACCESS_MMAP_INTERLEAVED
) |

1946 
PCM_BIT
(
SNDRV_PCM_ACCESS_MMAP_NONINTERLEAVED
) |

1947 
PCM_BIT
(
SNDRV_PCM_ACCESS_MMAP_COMPLEX
) |

1948 
PCM_BIT
(
SNDRV_PCM_ACCESS_RW_INTERLEAVED
) |

1949 
PCM_BIT
(
SNDRV_PCM_ACCESS_RW_NONINTERLEAVED
)

1952 [
SND_PCM_HW_PARAM_FORMAT
 - 
SND_PCM_HW_PARAM_FIRST_MASK
] = {

1953 .
b™s
 = {

1955 
PCM_BIT
(
SNDRV_PCM_FORMAT_S8
) |

1956 
PCM_BIT
(
SNDRV_PCM_FORMAT_U8
) |

1957 
PCM_BIT
(
SNDRV_PCM_FORMAT_S16_LE
) |

1958 
PCM_BIT
(
SNDRV_PCM_FORMAT_S16_BE
) |

1959 
PCM_BIT
(
SNDRV_PCM_FORMAT_U16_LE
) |

1960 
PCM_BIT
(
SNDRV_PCM_FORMAT_U16_BE
) |

1961 
PCM_BIT
(
SNDRV_PCM_FORMAT_S24_LE
) |

1962 
PCM_BIT
(
SNDRV_PCM_FORMAT_S24_BE
) |

1963 
PCM_BIT
(
SNDRV_PCM_FORMAT_U24_LE
) |

1964 
PCM_BIT
(
SNDRV_PCM_FORMAT_U24_BE
) |

1965 
PCM_BIT
(
SNDRV_PCM_FORMAT_S32_LE
) |

1966 
PCM_BIT
(
SNDRV_PCM_FORMAT_S32_BE
) |

1967 
PCM_BIT
(
SNDRV_PCM_FORMAT_U32_LE
) |

1968 
PCM_BIT
(
SNDRV_PCM_FORMAT_U32_BE
) |

1969 
PCM_BIT
(
SNDRV_PCM_FORMAT_FLOAT_LE
) |

1970 
PCM_BIT
(
SNDRV_PCM_FORMAT_FLOAT_BE
) |

1971 
PCM_BIT
(
SNDRV_PCM_FORMAT_FLOAT64_LE
) |

1972 
PCM_BIT
(
SNDRV_PCM_FORMAT_FLOAT64_BE
) |

1973 
PCM_BIT
(
SNDRV_PCM_FORMAT_IEC958_SUBFRAME
) |

1974 
PCM_BIT
(
SNDRV_PCM_FORMAT_IEC958_SUBFRAME
) |

1975 
PCM_BIT
(
SNDRV_PCM_FORMAT_MU_LAW
) |

1976 
PCM_BIT
(
SNDRV_PCM_FORMAT_A_LAW
) |

1977 
PCM_BIT
(
SNDRV_PCM_FORMAT_IMA_ADPCM
) |

1978 
PCM_BIT
(
SNDRV_PCM_FORMAT_MPEG
) |

1979 
PCM_BIT
(
SNDRV_PCM_FORMAT_GSM
) |

1980 
PCM_BIT
(
SNDRV_PCM_FORMAT_S20_LE
) |

1981 
PCM_BIT
(
SNDRV_PCM_FORMAT_S20_BE
) |

1982 
PCM_BIT
(
SNDRV_PCM_FORMAT_U20_LE
) |

1983 
PCM_BIT
(
SNDRV_PCM_FORMAT_U20_BE
) |

1984 
PCM_BIT
(
SNDRV_PCM_FORMAT_SPECIAL
),

1986 
PCM_BIT
(
SNDRV_PCM_FORMAT_S24_3LE
) |

1987 
PCM_BIT
(
SNDRV_PCM_FORMAT_S24_3BE
) |

1988 
PCM_BIT
(
SNDRV_PCM_FORMAT_U24_3LE
) |

1989 
PCM_BIT
(
SNDRV_PCM_FORMAT_U24_3BE
) |

1990 
PCM_BIT
(
SNDRV_PCM_FORMAT_S20_3LE
) |

1991 
PCM_BIT
(
SNDRV_PCM_FORMAT_S20_3BE
) |

1992 
PCM_BIT
(
SNDRV_PCM_FORMAT_U20_3LE
) |

1993 
PCM_BIT
(
SNDRV_PCM_FORMAT_U20_3BE
) |

1994 
PCM_BIT
(
SNDRV_PCM_FORMAT_S18_3LE
) |

1995 
PCM_BIT
(
SNDRV_PCM_FORMAT_S18_3BE
) |

1996 
PCM_BIT
(
SNDRV_PCM_FORMAT_U18_3LE
) |

1997 
PCM_BIT
(
SNDRV_PCM_FORMAT_U18_3BE
) |

1998 
PCM_BIT
(
SNDRV_PCM_FORMAT_G723_24
) |

1999 
PCM_BIT
(
SNDRV_PCM_FORMAT_G723_24
) |

2000 
PCM_BIT
(
SNDRV_PCM_FORMAT_G723_40
) |

2001 
PCM_BIT
(
SNDRV_PCM_FORMAT_G723_40
) |

2002 
PCM_BIT
(
SNDRV_PCM_FORMAT_DSD_U8
) |

2003 
PCM_BIT
(
SNDRV_PCM_FORMAT_DSD_U16_LE
) |

2004 
PCM_BIT
(
SNDRV_PCM_FORMAT_DSD_U32_LE
) |

2005 
PCM_BIT
(
SNDRV_PCM_FORMAT_DSD_U16_BE
) |

2006 
PCM_BIT
(
SNDRV_PCM_FORMAT_DSD_U32_BE
)

2009 [
SND_PCM_HW_PARAM_SUBFORMAT
 - 
SND_PCM_HW_PARAM_FIRST_MASK
] = {

2010 .
b™s
 = {

2011 
PCM_BIT
(
SNDRV_PCM_SUBFORMAT_STD
) |

2012 
PCM_BIT
(
SNDRV_PCM_SUBFORMAT_MSBITS_MAX
) |

2013 
PCM_BIT
(
SNDRV_PCM_SUBFORMAT_MSBITS_20
) |

2014 
PCM_BIT
(
SNDRV_PCM_SUBFORMAT_MSBITS_24
),

2019 cÚ¡ 
¢d_š‹rv®_t
 
	g»fše_š‹rv®s
[
SND_PCM_HW_PARAM_LAST_INTERVAL
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
 + 1] = {

2020 [
SND_PCM_HW_PARAM_SAMPLE_BITS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2021 .
mš
 = 1, .
	gmax
 = 
UINT_MAX
,

2022 .
	gİ’mš
 = 0, .
	gİ’max
 = 0, .
	gš‹g”
 = 1, .
	gem±y
 = 0,

2024 [
SND_PCM_HW_PARAM_FRAME_BITS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2025 .
mš
 = 1, .
	gmax
 = 
UINT_MAX
,

2026 .
	gİ’mš
 = 0, .
	gİ’max
 = 0, .
	gš‹g”
 = 1, .
	gem±y
 = 0,

2028 [
SND_PCM_HW_PARAM_CHANNELS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2029 .
mš
 = 1, .
	gmax
 = 
UINT_MAX
,

2030 .
	gİ’mš
 = 0, .
	gİ’max
 = 0, .
	gš‹g”
 = 1, .
	gem±y
 = 0,

2032 [
SND_PCM_HW_PARAM_RATE
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2033 .
mš
 = 1, .
	gmax
 = 
UINT_MAX
,

2034 .
	gİ’mš
 = 0, .
	gİ’max
 = 0, .
	gš‹g”
 = 0, .
	gem±y
 = 0,

2036 [
SND_PCM_HW_PARAM_PERIOD_TIME
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2037 .
mš
 = 0, .
	gmax
 = 
UINT_MAX
,

2038 .
	gİ’mš
 = 0, .
	gİ’max
 = 0, .
	gš‹g”
 = 0, .
	gem±y
 = 0,

2040 [
SND_PCM_HW_PARAM_PERIOD_SIZE
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2041 .
mš
 = 0, .
	gmax
 = 
UINT_MAX
,

2042 .
	gİ’mš
 = 0, .
	gİ’max
 = 0, .
	gš‹g”
 = 0, .
	gem±y
 = 0,

2044 [
SND_PCM_HW_PARAM_PERIOD_BYTES
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2045 .
mš
 = 0, .
	gmax
 = 
UINT_MAX
,

2046 .
	gİ’mš
 = 0, .
	gİ’max
 = 0, .
	gš‹g”
 = 0, .
	gem±y
 = 0,

2048 [
SND_PCM_HW_PARAM_PERIODS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2049 .
mš
 = 0, .
	gmax
 = 
UINT_MAX
,

2050 .
	gİ’mš
 = 0, .
	gİ’max
 = 0, .
	gš‹g”
 = 0, .
	gem±y
 = 0,

2052 [
SND_PCM_HW_PARAM_BUFFER_TIME
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2053 .
mš
 = 1, .
	gmax
 = 
UINT_MAX
,

2054 .
	gİ’mš
 = 0, .
	gİ’max
 = 0, .
	gš‹g”
 = 0, .
	gem±y
 = 0,

2056 [
SND_PCM_HW_PARAM_BUFFER_SIZE
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2057 .
mš
 = 1, .
	gmax
 = 
UINT_MAX
,

2058 .
	gİ’mš
 = 0, .
	gİ’max
 = 0, .
	gš‹g”
 = 1, .
	gem±y
 = 0,

2060 [
SND_PCM_HW_PARAM_BUFFER_BYTES
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2061 .
mš
 = 1, .
	gmax
 = 
UINT_MAX
,

2062 .
	gİ’mš
 = 0, .
	gİ’max
 = 0, .
	gš‹g”
 = 1, .
	gem±y
 = 0,

2064 [
SND_PCM_HW_PARAM_TICK_TIME
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2065 .
mš
 = 0, .
	gmax
 = 
UINT_MAX
,

2066 .
	gİ’mš
 = 0, .
	gİ’max
 = 0, .
	gš‹g”
 = 0, .
	gem±y
 = 0,

2071 
	#RULES_DEBUG


	)

2074 
	$¢d_pcm_hw_»fše_soá
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

2076 
k
;

2077 
¢d_š‹rv®_t
 *
i
;

2078 
¢d_mask_t
 *
m
;

2079 
r¡amps
[
RULES
];

2080 
v¡amps
[
SND_PCM_HW_PARAM_LAST_INTERVAL
 + 1];

2081 
¡amp
 = 2;

2082 
chªged
, 
agaš
;

2083 #ifdeà
RULES_DEBUG


2084 
¢d_ouut_t
 *
log
;

2085 
	`¢d_ouut_¡dio_©ch
(&
log
, 
¡d”r
, 0);

2086 
	`¢d_ouut_´štf
(
log
, "»fše_soá '%s' (begš)\n", 
pcm
->
Çme
);

2087 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
log
);

2090 
k
 = 
SND_PCM_HW_PARAM_FIRST_MASK
; k <ğ
SND_PCM_HW_PARAM_LAST_MASK
; k++) {

2091 ià(!(
·¿ms
->
rmask
 & (1 << 
k
)))

2093 
chªged
 = 
	`¢d_mask_»fše
(
	`hw_·¿m_mask
(
·¿ms
, 
k
),

2094 &
»fše_masks
[
k
 - 
SND_PCM_HW_PARAM_FIRST_MASK
]);

2095 ià(
chªged
)

2096 
·¿ms
->
cmask
 |ğ1 << 
k
;

2097 ià(
chªged
 < 0)

2098 
_”r
;

2101 
k
 = 
SND_PCM_HW_PARAM_FIRST_INTERVAL
; k <ğ
SND_PCM_HW_PARAM_LAST_INTERVAL
; k++) {

2102 ià(!(
·¿ms
->
rmask
 & (1 << 
k
)))

2104 
chªged
 = 
	`¢d_š‹rv®_»fše
(
	`hw_·¿m_š‹rv®
(
·¿ms
, 
k
),

2105 &
»fše_š‹rv®s
[
k
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
]);

2106 ià(
chªged
)

2107 
·¿ms
->
cmask
 |ğ1 << 
k
;

2108 ià(
chªged
 < 0)

2109 
_”r
;

2112 
k
 = 0; k < 
RULES
; k++)

2113 
r¡amps
[
k
] = 0;

2114 
k
 = 0; k <ğ
SND_PCM_HW_PARAM_LAST_INTERVAL
; k++)

2115 
v¡amps
[
k
] = (
·¿ms
->
rmask
 & (1 << k)) ? 1 : 0;

2117 
agaš
 = 0;

2118 
k
 = 0; k < 
RULES
; k++) {

2119 cÚ¡ 
¢d_pcm_hw_ruË_t
 *
r
 = &
»fše_ruËs
[
k
];

2120 
d
;

2121 
do™
 = 0;

2122 
d
 = 0; 
r
->
d•s
[d] >= 0; d++) {

2123 ià(
v¡amps
[
r
->
d•s
[
d
]] > 
r¡amps
[
k
]) {

2124 
do™
 = 1;

2128 ià(!
do™
)

2130 #ifdeà
RULES_DEBUG


2131 
	`¢d_ouut_´štf
(
log
, "RuË %d (%p): ", 
k
, 
r
->
func
);

2132 ià(
r
->
v¬
 >= 0) {

2133 
	`¢d_ouut_´štf
(
log
, "%s=", 
	`¢d_pcm_hw_·¿m_Çme
(
r
->
v¬
));

2134 
	`¢d_pcm_hw_·¿m_dump
(
·¿ms
, 
r
->
v¬
, 
log
);

2135 
	`¢d_ouut_puts
(
log
, " -> ");

2138 
chªged
 = 
r
->
	`func
(
·¿ms
,„);

2139 #ifdeà
RULES_DEBUG


2140 ià(
r
->
v¬
 >= 0)

2141 
	`¢d_pcm_hw_·¿m_dump
(
·¿ms
, 
r
->
v¬
, 
log
);

2142 
d
 = 0; 
r
->
d•s
[d] >= 0; d++) {

2143 
	`¢d_ouut_´štf
(
log
, " %s=", 
	`¢d_pcm_hw_·¿m_Çme
(
r
->
d•s
[
d
]));

2144 
	`¢d_pcm_hw_·¿m_dump
(
·¿ms
, 
r
->
d•s
[
d
], 
log
);

2146 
	`¢d_ouut_putc
(
log
, '\n');

2148 
r¡amps
[
k
] = 
¡amp
;

2149 ià(
chªged
 && 
r
->
v¬
 >= 0) {

2150 
·¿ms
->
cmask
 |ğ1 << 
r
->
v¬
;

2151 
v¡amps
[
r
->
v¬
] = 
¡amp
;

2152 
agaš
 = 1;

2154 ià(
chªged
 < 0)

2155 
_”r
;

2156 
¡amp
++;

2158 } 
agaš
);

2159 ià(!
·¿ms
->
msb™s
) {

2160 
i
 = 
	`hw_·¿m_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_SAMPLE_BITS
);

2161 ià(
	`¢d_š‹rv®_sšgË
(
i
))

2162 
·¿ms
->
msb™s
 = 
	`¢d_š‹rv®_v®ue
(
i
);

2163 
m
 = 
	`hw_·¿m_mask_c
(
·¿ms
, 
SNDRV_PCM_HW_PARAM_FORMAT
);

2164 ià(
	`¢d_mask_sšgË
(
m
)) {

2165 
¢d_pcm_fÜm©_t
 
fÜm©
 = 
	`¢d_mask_mš
(
m
);

2166 
·¿ms
->
msb™s
 = 
	`¢d_pcm_fÜm©_width
(
fÜm©
);

2170 ià(!
·¿ms
->
¿‹_d’
) {

2171 
i
 = 
	`hw_·¿m_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
);

2172 ià(
	`¢d_š‹rv®_sšgË
(
i
)) {

2173 
·¿ms
->
¿‹_num
 = 
	`¢d_š‹rv®_v®ue
(
i
);

2174 
·¿ms
->
¿‹_d’
 = 1;

2177 
·¿ms
->
rmask
 = 0;

2179 
_”r
:

2180 #ifdeà
RULES_DEBUG


2181 
	`¢d_ouut_´štf
(
log
, "»fše_soá '%s' (’d-%i)\n", 
pcm
->
Çme
, 
chªged
);

2182 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
log
);

2183 
	`¢d_ouut_şo£
(
log
);

2185  
chªged
;

2186 
	}
}

2188 
	$_¢d_pcm_hw_·¿ms_»fše
(
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

2189 
v¬s
,

2190 cÚ¡ 
¢d_pcm_hw_·¿ms_t
 *
¤c
)

2192 
chªged
, 
”r
 = 0;

2193 
k
;

2194 
k
 = 0; k <ğ
SND_PCM_HW_PARAM_LAST_INTERVAL
; ++k) {

2195 ià(!(
v¬s
 & (1 << 
k
)))

2197 
chªged
 = 
	`_¢d_pcm_hw_·¿m_»fše
(
·¿ms
, 
k
, 
¤c
);

2198 ià(
chªged
 < 0)

2199 
”r
 = 
chªged
;

2201 
·¿ms
->
šfo
 &ğ
¤c
->info;

2202 
·¿ms
->
æags
 = 
¤c
->flags;

2203  
”r
;

2204 
	}
}

2206 
¢d_pcm_hw_»fše_¦ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

2207 (*
ı»·»
)(
¢d_pcm_t
 *
pcm
,

2208 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
),

2209 (*
cchªge
)(
¢d_pcm_t
 *
pcm
,

2210 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

2211 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
),

2212 (*
¥»·»
)(
¢d_pcm_t
 *
pcm
,

2213 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
),

2214 (*
schªge
)(
¢d_pcm_t
 *
pcm
,

2215 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

2216 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
),

2217 (*
¤efše
)(
¢d_pcm_t
 *
pcm
,

2218 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
))

2221 #ifdeà
RULES_DEBUG


2222 
¢d_ouut_t
 *
log
;

2224 
¢d_pcm_hw_·¿ms_t
 
¥¬ams
;

2225 
”r
;

2226 
cmask
, 
chªged
;

2227 #ifdeà
RULES_DEBUG


2228 
	`¢d_ouut_¡dio_©ch
(&
log
, 
¡d”r
, 0);

2230 
”r
 = 
	`ı»·»
(
pcm
, 
·¿ms
);

2231 ià(
”r
 < 0)

2232  
”r
;

2233 
”r
 = 
	`¥»·»
(
pcm
, &
¥¬ams
);

2234 ià(
”r
 < 0) {

2235 
	`SNDERR
("Slave PCM‚ot usable");

2236  
”r
;

2238 #ifdeà
RULES_DEBUG


2239 
	`¢d_ouut_´štf
(
log
, "hw_»fše_¦av-ƒÁ” '%s'\n", 
pcm
->
Çme
);

2242 
cmask
 = 
·¿ms
->cmask;

2243 
·¿ms
->
cmask
 = 0;

2244 #ifdeà
RULES_DEBUG


2245 
	`¢d_ouut_´štf
(
log
, "schªg'%s' (ş›Á)\n", 
pcm
->
Çme
);

2246 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
log
);

2247 
	`¢d_ouut_´štf
(
log
, "schªg'%s' (¦ave)\n", 
pcm
->
Çme
);

2248 
	`¢d_pcm_hw_·¿ms_dump
(&
¥¬ams
, 
log
);

2250 
”r
 = 
	`schªge
(
pcm
, 
·¿ms
, &
¥¬ams
);

2251 ià(
”r
 >= 0) {

2252 #ifdeà
RULES_DEBUG


2253 
	`¢d_ouut_´štf
(
log
, "¤efš'%s' (ş›Á)\n", 
pcm
->
Çme
);

2254 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
log
);

2255 
	`¢d_ouut_´štf
(
log
, "¤efš'%s' (¦ave)\n", 
pcm
->
Çme
);

2256 
	`¢d_pcm_hw_·¿ms_dump
(&
¥¬ams
, 
log
);

2258 
”r
 = 
	`¤efše
(
pcm
, &
¥¬ams
);

2259 ià(
”r
 < 0) {

2260 #ifdeà
RULES_DEBUG


2261 
	`¢d_ouut_´štf
(
log
, "¤efš'%s',ƒ¼ < 0 (%iè(ş›Á)\n", 
pcm
->
Çme
, 
”r
);

2262 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
log
);

2263 
	`¢d_ouut_´štf
(
log
, "¤efš'%s',ƒ¼ < 0 (%iè(¦ave)\n", 
pcm
->
Çme
, 
”r
);

2264 
	`¢d_pcm_hw_·¿ms_dump
(&
¥¬ams
, 
log
);

2266 
	`cchªge
(
pcm
, 
·¿ms
, &
¥¬ams
);

2267  
”r
;

2270 #ifdeà
RULES_DEBUG


2271 
	`¢d_ouut_´štf
(
log
, "schªg'%s',ƒ¼ < 0 (%iè(ş›Á)\n", 
pcm
->
Çme
, 
”r
);

2272 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
log
);

2273 
	`¢d_ouut_´štf
(
log
, "schªg'%s',ƒ¼ < 0 (%iè(¦ave)\n", 
pcm
->
Çme
, 
”r
);

2274 
	`¢d_pcm_hw_·¿ms_dump
(&
¥¬ams
, 
log
);

2276 
	`cchªge
(
pcm
, 
·¿ms
, &
¥¬ams
);

2277  
”r
;

2279 #ifdeà
RULES_DEBUG


2280 
	`¢d_ouut_´štf
(
log
, "cchªg'%s'\n", 
pcm
->
Çme
);

2282 
”r
 = 
	`cchªge
(
pcm
, 
·¿ms
, &
¥¬ams
);

2283 ià(
”r
 < 0)

2284  
”r
;

2285 #ifdeà
RULES_DEBUG


2286 
	`¢d_ouut_´štf
(
log
, "»fše_soá '%s'\n", 
pcm
->
Çme
);

2288 
”r
 = 
	`¢d_pcm_hw_»fše_soá
(
pcm
, 
·¿ms
);

2289 
chªged
 = 
·¿ms
->
cmask
;

2290 
·¿ms
->
cmask
 |= cmask;

2291 ià(
”r
 < 0)

2292  
”r
;

2293 #ifdeà
RULES_DEBUG


2294 
	`¢d_ouut_´štf
(
log
, "»fše_soá ok '%s'\n", 
pcm
->
Çme
);

2296 } 
chªged
);

2297 #ifdeà
RULES_DEBUG


2298 
	`¢d_ouut_´štf
(
log
, "»fše_¦av-†—v'%s'\n", 
pcm
->
Çme
);

2299 
	`¢d_ouut_şo£
(
log
);

2302 
	}
}

2304 
¢d_pcm_hw_·¿ms_¦ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

2305 (*
cchªge
)(
¢d_pcm_t
 *
pcm
,

2306 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

2307 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
),

2308 (*
¥»·»
)(
¢d_pcm_t
 *
pcm
,

2309 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
),

2310 (*
schªge
)(
¢d_pcm_t
 *
pcm
,

2311 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

2312 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
),

2313 (*
¥¬ams
)(
¢d_pcm_t
 *
pcm
,

2314 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
))

2317 
¢d_pcm_hw_·¿ms_t
 
¦ave_·¿ms
;

2318 
”r
;

2319 
”r
 = 
	`¥»·»
(
pcm
, &
¦ave_·¿ms
);

2320 ià(
”r
 < 0)

2321  
”r
;

2322 
”r
 = 
	`schªge
(
pcm
, 
·¿ms
, &
¦ave_·¿ms
);

2323 ià(
”r
 < 0)

2324  
”r
;

2325 
”r
 = 
	`¥¬ams
(
pcm
, &
¦ave_·¿ms
);

2326 ià(
”r
 < 0)

2327 
	`cchªge
(
pcm
, 
·¿ms
, &
¦ave_·¿ms
);

2328  
”r
;

2329 
	}
}

2331 
	$¢d_pcm_sw_·¿ms_deçuÉ
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
)

2333 
	`as£¹
(
pcm
 && 
·¿ms
);

2334 
	`as£¹
(
pcm
->
£tup
);

2335 
·¿ms
->
´Ùo
 = 
SNDRV_PCM_VERSION
;

2336 
·¿ms
->
t¡amp_mode
 = 
SND_PCM_TSTAMP_NONE
;

2337 
·¿ms
->
t¡amp_ty³
 = 
pcm
->tstamp_type;

2338 
·¿ms
->
³riod_¡•
 = 1;

2339 
·¿ms
->
¦“p_mš
 = 0;

2340 
·¿ms
->
ava_mš
 = 
pcm
->
³riod_size
;

2341 
·¿ms
->
xãr_®ign
 = 1;

2342 
·¿ms
->
¡¬t_th»shŞd
 = 1;

2343 
·¿ms
->
¡İ_th»shŞd
 = 
pcm
->
bufãr_size
;

2344 
·¿ms
->
s’û_th»shŞd
 = 0;

2345 
·¿ms
->
s’û_size
 = 0;

2346 
·¿ms
->
bound¬y
 = 
pcm
->
bufãr_size
;

2348 ià(
·¿ms
->
bound¬y
 == 0)

2349  -
EINVAL
;

2350 
·¿ms
->
bound¬y
 * 2 <ğ
LONG_MAX
 - 
pcm
->
bufãr_size
)

2351 
·¿ms
->
bound¬y
 *= 2;

2353 
	}
}

2356 
	#REFINE_DEBUG


	)

2359 
	$¢d_pcm_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

2361 
»s
;

2362 #ifdeà
REFINE_DEBUG


2363 
¢d_ouut_t
 *
log
;

2364 
	`¢d_ouut_¡dio_©ch
(&
log
, 
¡d”r
, 0);

2366 
	`as£¹
(
pcm
 && 
·¿ms
);

2367 #ifdeà
REFINE_DEBUG


2368 
	`¢d_ouut_´štf
(
log
, "REFINE called:\n");

2369 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
log
);

2371 ià(
pcm
->
İs
->
hw_»fše
)

2372 
»s
 = 
pcm
->
İs
->
	`hw_»fše
Õcm->
İ_¬g
, 
·¿ms
);

2374 
»s
 = -
ENOSYS
;

2375 #ifdeà
REFINE_DEBUG


2376 
	`¢d_ouut_´štf
(
log
, "»fšdÚ-„esuÉ = %i\n", 
»s
);

2377 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
log
);

2378 
	`¢d_ouut_şo£
(
log
);

2380  
»s
;

2381 
	}
}

2395 
	$_¢d_pcm_hw_·¿ms_š‹º®
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

2397 
”r
;

2398 
¢d_pcm_sw_·¿ms_t
 
sw
;

2399 
fb
, 
mš_®ign
;

2400 
”r
 = 
	`¢d_pcm_hw_»fše
(
pcm
, 
·¿ms
);

2401 ià(
”r
 < 0)

2402  
”r
;

2403 
	`¢d_pcm_hw_·¿ms_choo£
(
pcm
, 
·¿ms
);

2404 ià(
pcm
->
£tup
) {

2405 
”r
 = 
	`¢d_pcm_hw_ä“
(
pcm
);

2406 ià(
”r
 < 0)

2407  
”r
;

2409 ià(
pcm
->
İs
->
hw_·¿ms
)

2410 
”r
 = 
pcm
->
İs
->
	`hw_·¿ms
Õcm->
İ_¬g
, 
·¿ms
);

2412 
”r
 = -
ENOSYS
;

2413 ià(
”r
 < 0)

2414  
”r
;

2416 
pcm
->
£tup
 = 1;

2417 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_acûss
)(
·¿ms
, &
pcm
->
acûss
);

2418 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(
·¿ms
, &
pcm
->
fÜm©
);

2419 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_subfÜm©
)(
·¿ms
, &
pcm
->
subfÜm©
);

2420 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_chªÃls
)(
·¿ms
, &
pcm
->
chªÃls
);

2421 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_¿‹
)(
·¿ms
, &
pcm
->
¿‹
, 0);

2422 
	`¢d_š‹rv®_cİy
(&
pcm
->
³riods
, &
·¿ms
->
š‹rv®s
[
SND_PCM_HW_PARAM_PERIODS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
]);

2423 
	`¢d_š‹rv®_cİy
(&
pcm
->
bufãr_time
, &
·¿ms
->
š‹rv®s
[
SND_PCM_HW_PARAM_BUFFER_TIME
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
]);

2424 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_time
)(
·¿ms
, &
pcm
->
³riod_time
, 0);

2425 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_size
)(
·¿ms
, &
pcm
->
³riod_size
, 0);

2426 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size
)(
·¿ms
, &
pcm
->
bufãr_size
);

2427 
pcm
->
§m¶e_b™s
 = 
	`¢d_pcm_fÜm©_physiÿl_width
Õcm->
fÜm©
);

2428 
pcm
->
äame_b™s
 =…cm->
§m¶e_b™s
 *…cm->
chªÃls
;

2429 
fb
 = 
pcm
->
äame_b™s
;

2430 
mš_®ign
 = 1;

2431 
fb
 % 8) {

2432 
fb
 *= 2;

2433 
mš_®ign
 *= 2;

2435 
pcm
->
mš_®ign
 = min_align;

2437 
pcm
->
hw_æags
 = 
·¿ms
->
æags
;

2438 
pcm
->
šfo
 = 
·¿ms
->info;

2439 
pcm
->
msb™s
 = 
·¿ms
->msbits;

2440 
pcm
->
¿‹_num
 = 
·¿ms
->rate_num;

2441 
pcm
->
¿‹_d’
 = 
·¿ms
->rate_den;

2442 
pcm
->
fifo_size
 = 
·¿ms
->fifo_size;

2445 
	`mem£t
(&
sw
, 0, (sw));

2446 
”r
 = 
	`¢d_pcm_sw_·¿ms_deçuÉ
(
pcm
, &
sw
);

2447 ià(
”r
 < 0)

2448  
”r
;

2449 
”r
 = 
	`¢d_pcm_sw_·¿ms
(
pcm
, &
sw
);

2450 ià(
”r
 < 0)

2451  
”r
;

2453 ià(
pcm
->
mm­_rw
 ||

2454 
pcm
->
acûss
 =ğ
SND_PCM_ACCESS_MMAP_INTERLEAVED
 ||

2455 
pcm
->
acûss
 =ğ
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
 ||

2456 
pcm
->
acûss
 =ğ
SND_PCM_ACCESS_MMAP_COMPLEX
) {

2457 
”r
 = 
	`¢d_pcm_mm­
(
pcm
);

2459 ià(
”r
 < 0)

2460  
”r
;

2462 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_plug.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_¶ugš.h
"

32 #iâdeà
PIC


34 cÚ¡ *
	g_¢d_moduË_pcm_¶ug
 = "";

37 #iâdeà
DOC_HIDDEN


39 
	e¢d_pcm_¶ug_rou‹_pŞicy
 {

40 
	mPLUG_ROUTE_POLICY_NONE
,

41 
	mPLUG_ROUTE_POLICY_DEFAULT
,

42 
	mPLUG_ROUTE_POLICY_COPY
,

43 
	mPLUG_ROUTE_POLICY_AVERAGE
,

44 
	mPLUG_ROUTE_POLICY_DUP
,

48 
¢d_pcm_g’”ic_t
 
	mg’
;

49 
¢d_pcm_t
 *
	m»q_¦ave
;

50 
¢d_pcm_fÜm©_t
 
	msfÜm©
;

51 
	mschªÃls
;

52 
	m¤©e
;

53 
¢d_cÚfig_t
 *
	m¿‹_cÚv”‹r
;

54 
¢d_pcm_¶ug_rou‹_pŞicy
 
	mrou‹_pŞicy
;

55 
¢d_pcm_rou‹_‰abË_’Œy_t
 *
	m‰abË
;

56 
	m‰abË_ok
;

57 
	m‰_ssize
, 
	m‰_cu£d
, 
	m‰_su£d
;

58 } 
	t¢d_pcm_¶ug_t
;

62 
	$¢d_pcm_¶ug_şo£
(
¢d_pcm_t
 *
pcm
)

64 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

65 
”r
, 
»suÉ
 = 0;

66 
	`ä“
(
¶ug
->
‰abË
);

67 ià(
¶ug
->
¿‹_cÚv”‹r
) {

68 
	`¢d_cÚfig_d–‘e
(
¶ug
->
¿‹_cÚv”‹r
);

69 
¶ug
->
¿‹_cÚv”‹r
 = 
NULL
;

71 
	`as£¹
(
¶ug
->
g’
.
¦ave
 =ğ¶ug->
»q_¦ave
);

72 ià(
¶ug
->
g’
.
şo£_¦ave
) {

73 
	`¢d_pcm_uÆšk_hw_±r
(
pcm
, 
¶ug
->
»q_¦ave
);

74 
	`¢d_pcm_uÆšk_­¶_±r
(
pcm
, 
¶ug
->
»q_¦ave
);

75 
”r
 = 
	`¢d_pcm_şo£
(
¶ug
->
»q_¦ave
);

76 ià(
”r
 < 0)

77 
»suÉ
 = 
”r
;

79 
	`ä“
(
¶ug
);

80  
»suÉ
;

81 
	}
}

83 
	$¢d_pcm_¶ug_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_šfo_t
 *
šfo
)

85 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

86 
¢d_pcm_t
 *
¦ave
 = 
¶ug
->
»q_¦ave
;

87 
”r
;

89 ià((
”r
 = 
	`¢d_pcm_šfo
(
¦ave
, 
šfo
)) < 0)

90  
”r
;

92 
	}
}

94 cÚ¡ 
¢d_pcm_fÜm©_t
 
	glš—r_´eã¼ed_fÜm©s
[] = {

95 #ifdeà
SND_LITTLE_ENDIAN


96 
SND_PCM_FORMAT_S16_LE
,

97 
SND_PCM_FORMAT_U16_LE
,

98 
SND_PCM_FORMAT_S16_BE
,

99 
SND_PCM_FORMAT_U16_BE
,

101 
SND_PCM_FORMAT_S16_BE
,

102 
SND_PCM_FORMAT_U16_BE
,

103 
SND_PCM_FORMAT_S16_LE
,

104 
SND_PCM_FORMAT_U16_LE
,

106 #ifdeà
SND_LITTLE_ENDIAN


107 
SND_PCM_FORMAT_S32_LE
,

108 
SND_PCM_FORMAT_U32_LE
,

109 
SND_PCM_FORMAT_S32_BE
,

110 
SND_PCM_FORMAT_U32_BE
,

112 
SND_PCM_FORMAT_S32_BE
,

113 
SND_PCM_FORMAT_U32_BE
,

114 
SND_PCM_FORMAT_S32_LE
,

115 
SND_PCM_FORMAT_U32_LE
,

117 
SND_PCM_FORMAT_S8
,

118 
SND_PCM_FORMAT_U8
,

119 #ifdeà
SND_LITTLE_ENDIAN


120 
SND_PCM_FORMAT_FLOAT_LE
,

121 
SND_PCM_FORMAT_FLOAT64_LE
,

122 
SND_PCM_FORMAT_FLOAT_BE
,

123 
SND_PCM_FORMAT_FLOAT64_BE
,

125 
SND_PCM_FORMAT_FLOAT_BE
,

126 
SND_PCM_FORMAT_FLOAT64_BE
,

127 
SND_PCM_FORMAT_FLOAT_LE
,

128 
SND_PCM_FORMAT_FLOAT64_LE
,

130 #ifdeà
SND_LITTLE_ENDIAN


131 
SND_PCM_FORMAT_S24_LE
,

132 
SND_PCM_FORMAT_U24_LE
,

133 
SND_PCM_FORMAT_S24_BE
,

134 
SND_PCM_FORMAT_U24_BE
,

136 
SND_PCM_FORMAT_S24_BE
,

137 
SND_PCM_FORMAT_U24_BE
,

138 
SND_PCM_FORMAT_S24_LE
,

139 
SND_PCM_FORMAT_U24_LE
,

141 #ifdeà
SND_LITTLE_ENDIAN


142 
SND_PCM_FORMAT_S20_LE
,

143 
SND_PCM_FORMAT_U20_LE
,

144 
SND_PCM_FORMAT_S20_BE
,

145 
SND_PCM_FORMAT_U20_BE
,

147 
SND_PCM_FORMAT_S20_BE
,

148 
SND_PCM_FORMAT_U20_BE
,

149 
SND_PCM_FORMAT_S20_LE
,

150 
SND_PCM_FORMAT_U20_LE
,

152 #ifdeà
SND_LITTLE_ENDIAN


153 
SND_PCM_FORMAT_S24_3LE
,

154 
SND_PCM_FORMAT_U24_3LE
,

155 
SND_PCM_FORMAT_S24_3BE
,

156 
SND_PCM_FORMAT_U24_3BE
,

158 
SND_PCM_FORMAT_S24_3BE
,

159 
SND_PCM_FORMAT_U24_3BE
,

160 
SND_PCM_FORMAT_S24_3LE
,

161 
SND_PCM_FORMAT_U24_3LE
,

163 #ifdeà
SND_LITTLE_ENDIAN


164 
SND_PCM_FORMAT_S20_3LE
,

165 
SND_PCM_FORMAT_U20_3LE
,

166 
SND_PCM_FORMAT_S20_3BE
,

167 
SND_PCM_FORMAT_U20_3BE
,

169 
SND_PCM_FORMAT_S20_3BE
,

170 
SND_PCM_FORMAT_U20_3BE
,

171 
SND_PCM_FORMAT_S20_3LE
,

172 
SND_PCM_FORMAT_U20_3LE
,

174 #ifdeà
SND_LITTLE_ENDIAN


175 
SND_PCM_FORMAT_S18_3LE
,

176 
SND_PCM_FORMAT_U18_3LE
,

177 
SND_PCM_FORMAT_S18_3BE
,

178 
SND_PCM_FORMAT_U18_3BE
,

180 
SND_PCM_FORMAT_S18_3BE
,

181 
SND_PCM_FORMAT_U18_3BE
,

182 
SND_PCM_FORMAT_S18_3LE
,

183 
SND_PCM_FORMAT_U18_3LE
,

187 #ià
defšed
(
BUILD_PCM_PLUGIN_MULAW
) || \

188 
defšed
(
BUILD_PCM_PLUGIN_ALAW
) || \

189 
defšed
(
BUILD_PCM_PLUGIN_ADPCM
) || \

190 
	$defšed
(
BUILD_PCM_PLUGIN_IEC958
)

191 
	#BUILD_PCM_NONLINEAR


	)

194 #ifdeà
BUILD_PCM_NONLINEAR


195 cÚ¡ 
¢d_pcm_fÜm©_t
 
nÚlš—r_´eã¼ed_fÜm©s
[] = {

196 #ifdeà
BUILD_PCM_PLUGIN_MULAW


197 
SND_PCM_FORMAT_MU_LAW
,

199 #ifdeà
BUILD_PCM_PLUGIN_ALAW


200 
SND_PCM_FORMAT_A_LAW
,

202 #ifdeà
BUILD_PCM_PLUGIN_ADPCM


203 
SND_PCM_FORMAT_IMA_ADPCM
,

205 #ifdeà
BUILD_PCM_PLUGIN_IEC958


206 
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
,

207 
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
,

209 
	}
};

212 #ifdeà
BUILD_PCM_PLUGIN_LFLOAT


213 cÚ¡ 
¢d_pcm_fÜm©_t
 
	gæßt_´eã¼ed_fÜm©s
[] = {

214 #ifdeà
SND_LITTLE_ENDIAN


215 
SND_PCM_FORMAT_FLOAT_LE
,

216 
SND_PCM_FORMAT_FLOAT64_LE
,

217 
SND_PCM_FORMAT_FLOAT_BE
,

218 
SND_PCM_FORMAT_FLOAT64_BE
,

220 
SND_PCM_FORMAT_FLOAT_BE
,

221 
SND_PCM_FORMAT_FLOAT64_BE
,

222 
SND_PCM_FORMAT_FLOAT_LE
,

223 
SND_PCM_FORMAT_FLOAT64_LE
,

228 cÚ¡ 
	glš—r_fÜm©_widths
[32] = {

235 
	$check_lš—r_fÜm©
(cÚ¡ 
¢d_pcm_fÜm©_mask_t
 *
fÜm©_mask
, 
wid
, 
sgn
, 
ed
)

237 
e
, 
s
;

238 ià(! 
lš—r_fÜm©_widths
[
wid
 - 1])

239  
SND_PCM_FORMAT_UNKNOWN
;

240 
e
 = 0;ƒ < 2;ƒ++) {

241 
s
 = 0; s < 2; s++) {

242 
pw
 = ((
wid
 + 7) / 8) * 8;

243 ; 
pw
 <= 32;…w += 8) {

244 
¢d_pcm_fÜm©_t
 
f
;

245 
f
 = 
	`¢d_pcm_bud_lš—r_fÜm©
(
wid
, 
pw
, 
sgn
, 
ed
);

246 ià(
f
 !ğ
SND_PCM_FORMAT_UNKNOWN
 &&

247 
	`¢d_pcm_fÜm©_mask_‹¡
(
fÜm©_mask
, 
f
))

248  
f
;

250 
sgn
 = !sgn;

252 
ed
 = !ed;

254  
SND_PCM_FORMAT_UNKNOWN
;

255 
	}
}

257 
¢d_pcm_fÜm©_t
 
	$¢d_pcm_¶ug_¦ave_fÜm©
(
¢d_pcm_fÜm©_t
 
fÜm©
, cÚ¡ 
¢d_pcm_fÜm©_mask_t
 *
fÜm©_mask
)

259 
w
, 
w1
, 
u
, 
e
;

260 
¢d_pcm_fÜm©_t
 
f
;

261 
¢d_pcm_fÜm©_mask_t
 
lš
 = { 
SND_PCM_FMTBIT_LINEAR
 };

262 
¢d_pcm_fÜm©_mask_t
 
æ
 = {

263 #ifdeà
BUILD_PCM_PLUGIN_LFLOAT


264 
SND_PCM_FMTBIT_FLOAT


269 ià(
	`¢d_pcm_fÜm©_mask_‹¡
(
fÜm©_mask
, 
fÜm©
))

270  
fÜm©
;

271 ià(!
	`¢d_pcm_fÜm©_mask_‹¡
(&
lš
, 
fÜm©
) &&

272 !
	`¢d_pcm_fÜm©_mask_‹¡
(&
æ
, 
fÜm©
)) {

273 
i
;

274 
fÜm©
) {

275 #ifdeà
BUILD_PCM_PLUGIN_MULAW


276 
SND_PCM_FORMAT_MU_LAW
:

278 #ifdeà
BUILD_PCM_PLUGIN_ALAW


279 
SND_PCM_FORMAT_A_LAW
:

281 #ifdeà
BUILD_PCM_PLUGIN_ADPCM


282 
SND_PCM_FORMAT_IMA_ADPCM
:

284 
i
 = 0; i < (
lš—r_´eã¼ed_fÜm©s
) / (linear_preferred_formats[0]); ++i) {

285 
¢d_pcm_fÜm©_t
 
f
 = 
lš—r_´eã¼ed_fÜm©s
[
i
];

286 ià(
	`¢d_pcm_fÜm©_mask_‹¡
(
fÜm©_mask
, 
f
))

287  
f
;

291  
SND_PCM_FORMAT_UNKNOWN
;

295 
	`¢d_mask_š‹r£ù
(&
lš
, 
fÜm©_mask
);

296 
	`¢d_mask_š‹r£ù
(&
æ
, 
fÜm©_mask
);

297 ià(
	`¢d_mask_em±y
(&
lš
è&& snd_mask_em±y(&
æ
)) {

298 #ifdeà
BUILD_PCM_NONLINEAR


299 
i
;

300 
i
 = 0; i < (
nÚlš—r_´eã¼ed_fÜm©s
) / (nonlinear_preferred_formats[0]); ++i) {

301 
¢d_pcm_fÜm©_t
 
f
 = 
nÚlš—r_´eã¼ed_fÜm©s
[
i
];

302 ià(
	`¢d_pcm_fÜm©_mask_‹¡
(
fÜm©_mask
, 
f
))

303  
f
;

306  
SND_PCM_FORMAT_UNKNOWN
;

308 #ifdeà
BUILD_PCM_PLUGIN_LFLOAT


309 ià(
	`¢d_pcm_fÜm©_æßt
(
fÜm©
)) {

310 ià(
	`¢d_pcm_fÜm©_mask_‹¡
(&
æ
, 
fÜm©
)) {

311 
i
;

312 
i
 = 0; i < (
æßt_´eã¼ed_fÜm©s
) / (float_preferred_formats[0]); ++i) {

313 
¢d_pcm_fÜm©_t
 
f
 = 
æßt_´eã¼ed_fÜm©s
[
i
];

314 ià(
	`¢d_pcm_fÜm©_mask_‹¡
(
fÜm©_mask
, 
f
))

315  
f
;

318 
w
 = 32;

319 
u
 = 0;

320 
e
 = 
	`¢d_pcm_fÜm©_big_’dŸn
(
fÜm©
);

323 ià(
	`¢d_mask_em±y
(&
lš
)) {

324 #ifdeà
BUILD_PCM_PLUGIN_LFLOAT


325 
i
;

326 
i
 = 0; i < (
æßt_´eã¼ed_fÜm©s
) / (float_preferred_formats[0]); ++i) {

327 
¢d_pcm_fÜm©_t
 
f
 = 
æßt_´eã¼ed_fÜm©s
[
i
];

328 ià(
	`¢d_pcm_fÜm©_mask_‹¡
(
fÜm©_mask
, 
f
))

329  
f
;

332  
SND_PCM_FORMAT_UNKNOWN
;

334 
w
 = 
	`¢d_pcm_fÜm©_width
(
fÜm©
);

335 
u
 = 
	`¢d_pcm_fÜm©_unsigÃd
(
fÜm©
);

336 
e
 = 
	`¢d_pcm_fÜm©_big_’dŸn
(
fÜm©
);

338 
w1
 = 
w
; w1 <= 32; w1++) {

339 
f
 = 
	`check_lš—r_fÜm©
(
fÜm©_mask
, 
w1
, 
u
, 
e
);

340 ià(
f
 !ğ
SND_PCM_FORMAT_UNKNOWN
)

341  
f
;

343 
w1
 = 
w
 - 1; w1 > 0; w1--) {

344 
f
 = 
	`check_lš—r_fÜm©
(
fÜm©_mask
, 
w1
, 
u
, 
e
);

345 ià(
f
 !ğ
SND_PCM_FORMAT_UNKNOWN
)

346  
f
;

348  
SND_PCM_FORMAT_UNKNOWN
;

349 
	}
}

351 
	$¢d_pcm_¶ug_ş—r
(
¢d_pcm_t
 *
pcm
)

353 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

354 
¢d_pcm_t
 *
¦ave
 = 
¶ug
->
»q_¦ave
;

356 ià(
¶ug
->
g’
.
¦ave
 != slave) {

357 
	`¢d_pcm_uÆšk_hw_±r
(
pcm
, 
¶ug
->
g’
.
¦ave
);

358 
	`¢d_pcm_uÆšk_­¶_±r
(
pcm
, 
¶ug
->
g’
.
¦ave
);

359 
	`¢d_pcm_şo£
(
¶ug
->
g’
.
¦ave
);

360 
¶ug
->
g’
.
¦ave
 = slave;

361 
pcm
->
ç¡_İs
 = 
¦ave
->fast_ops;

362 
pcm
->
ç¡_İ_¬g
 = 
¦ave
->fast_op_arg;

364 
	}
}

366 #iâdeà
DOC_HIDDEN


368 
¢d_pcm_acûss_t
 
	macûss
;

369 
¢d_pcm_fÜm©_t
 
	mfÜm©
;

370 
	mchªÃls
;

371 
	m¿‹
;

372 } 
	t¢d_pcm_¶ug_·¿ms_t
;

375 #ifdeà
BUILD_PCM_PLUGIN_RATE


376 
	$¢d_pcm_¶ug_chªge_¿‹
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ**
Ãw
, 
¢d_pcm_¶ug_·¿ms_t
 *
şt
, snd_pcm_¶ug_·¿ms_ˆ*
¦v
)

378 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

379 
”r
;

380 ià(
şt
->
¿‹
 =ğ
¦v
->rate)

382 
	`as£¹
(
	`¢d_pcm_fÜm©_lš—r
(
¦v
->
fÜm©
));

383 
”r
 = 
	`¢d_pcm_¿‹_İ’
(
Ãw
, 
NULL
, 
¦v
->
fÜm©
, slv->
¿‹
, 
¶ug
->
¿‹_cÚv”‹r
,

384 
¶ug
->
g’
.
¦ave
,…lug->g’.¦av!ğ¶ug->
»q_¦ave
);

385 ià(
”r
 < 0)

386  
”r
;

387 
¦v
->
acûss
 = 
şt
->access;

388 
¦v
->
¿‹
 = 
şt
->rate;

389 ià(
	`¢d_pcm_fÜm©_lš—r
(
şt
->
fÜm©
))

390 
¦v
->
fÜm©
 = 
şt
->format;

392 
	}
}

395 #ifdeà
BUILD_PCM_PLUGIN_ROUTE


396 
	$¢d_pcm_¶ug_chªge_chªÃls
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ**
Ãw
, 
¢d_pcm_¶ug_·¿ms_t
 *
şt
, snd_pcm_¶ug_·¿ms_ˆ*
¦v
)

398 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

399 
‰_ssize
, 
‰_cu£d
, 
‰_su£d
;

400 
¢d_pcm_rou‹_‰abË_’Œy_t
 *
‰abË
;

401 
”r
;

402 ià(
şt
->
chªÃls
 =ğ
¦v
->channels &&

403 (!
¶ug
->
‰abË
 ||…lug->
‰abË_ok
))

405 ià(
şt
->
¿‹
 !ğ
¦v
->rate &&

406 
şt
->
chªÃls
 > 
¦v
->channels)

408 
	`as£¹
(
	`¢d_pcm_fÜm©_lš—r
(
¦v
->
fÜm©
));

409 
‰_ssize
 = 
¦v
->
chªÃls
;

410 
‰_cu£d
 = 
şt
->
chªÃls
;

411 
‰_su£d
 = 
¦v
->
chªÃls
;

412 
‰abË
 = 
	`®loÿ
(
‰_cu£d
 * 
‰_su£d
 * (*ttable));

413 ià(
¶ug
->
‰abË
) {

414 
c
 = 0, 
s
 = 0;

415 
c
 = 0; c < 
‰_cu£d
; c++) {

416 
s
 = 0; s < 
‰_su£d
; s++) {

417 
¢d_pcm_rou‹_‰abË_’Œy_t
 
v
;

418 ià(
c
 >ğ
¶ug
->
‰_cu£d
)

419 
v
 = 0;

420 ià(
s
 >ğ
¶ug
->
‰_su£d
)

421 
v
 = 0;

423 
v
 = 
¶ug
->
‰abË
[
c
 *…lug->
‰_ssize
 + 
s
];

424 
‰abË
[
c
 * 
‰_ssize
 + 
s
] = 
v
;

427 
¶ug
->
‰abË_ok
 = 1;

429 
k
;

430 
c
 = 0, 
s
 = 0;

431 
¢d_pcm_¶ug_rou‹_pŞicy
 
½Şicy
 = 
¶ug
->
rou‹_pŞicy
;

432 
n
;

433 
k
 = 0; k < 
‰_cu£d
 * 
‰_su£d
; ++k)

434 
‰abË
[
k
] = 0;

435 ià(
½Şicy
 =ğ
PLUG_ROUTE_POLICY_DEFAULT
) {

436 
½Şicy
 = 
PLUG_ROUTE_POLICY_COPY
;

438 ià(
şt
->
chªÃls
 =ğ1 || 
¦v
->channels == 1)

439 
½Şicy
 = 
PLUG_ROUTE_POLICY_AVERAGE
;

441 
½Şicy
) {

442 
PLUG_ROUTE_POLICY_AVERAGE
:

443 
PLUG_ROUTE_POLICY_DUP
:

444 ià(
şt
->
chªÃls
 > 
¦v
->channels) {

445 
n
 = 
şt
->
chªÃls
;

447 
n
 = 
¦v
->
chªÃls
;

449 
n
-- > 0) {

450 
¢d_pcm_rou‹_‰abË_’Œy_t
 
v
 = 
SND_PCM_PLUGIN_ROUTE_FULL
;

451 ià(
½Şicy
 =ğ
PLUG_ROUTE_POLICY_AVERAGE
) {

452 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
 &&

453 
şt
->
chªÃls
 > 
¦v
->channels) {

454 
¤cs
 = 
şt
->
chªÃls
 / 
¦v
->channels;

455 ià(
s
 < 
şt
->
chªÃls
 % 
¦v
->channels)

456 
¤cs
++;

457 
v
 /ğ
¤cs
;

458 } ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
 &&

459 
¦v
->
chªÃls
 > 
şt
->channels) {

460 
¤cs
 = 
¦v
->
chªÃls
 / 
şt
->channels;

461 ià(
s
 < 
¦v
->
chªÃls
 % 
şt
->channels)

462 
¤cs
++;

463 
v
 /ğ
¤cs
;

466 
‰abË
[
c
 * 
‰_ssize
 + 
s
] = 
v
;

467 ià(++
c
 =ğ
şt
->
chªÃls
)

468 
c
 = 0;

469 ià(++
s
 =ğ
¦v
->
chªÃls
)

470 
s
 = 0;

473 
PLUG_ROUTE_POLICY_COPY
:

474 ià(
şt
->
chªÃls
 < 
¦v
->channels) {

475 
n
 = 
şt
->
chªÃls
;

477 
n
 = 
¦v
->
chªÃls
;

479 
c
 = 0; ()ø< 
n
; c++)

480 
‰abË
[
c
 * 
‰_ssize
 + c] = 
SND_PCM_PLUGIN_ROUTE_FULL
;

483 
	`SNDERR
("Invalid„oute…olicy");

487 
”r
 = 
	`¢d_pcm_rou‹_İ’
(
Ãw
, 
NULL
, 
¦v
->
fÜm©
, (è¦v->
chªÃls
, 
‰abË
, 
‰_ssize
, 
‰_cu£d
, 
‰_su£d
, 
¶ug
->
g’
.
¦ave
,…lug->g’.¦av!ğ¶ug->
»q_¦ave
);

488 ià(
”r
 < 0)

489  
”r
;

490 
¦v
->
chªÃls
 = 
şt
->channels;

491 
¦v
->
acûss
 = 
şt
->access;

492 ià(
	`¢d_pcm_fÜm©_lš—r
(
şt
->
fÜm©
))

493 
¦v
->
fÜm©
 = 
şt
->format;

495 
	}
}

498 #ifdeà
BUILD_PCM_PLUGIN_IEC958


499 
	$›c958_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

500 
¢d_pcm_fÜm©_t
 
sfÜm©
, 
¢d_pcm_t
 *
¦ave
,

501 
şo£_¦ave
)

503 
´—mbË_v®s
[3] = {

506  
	`¢d_pcm_›c958_İ’
(
pcmp
, 
Çme
, 
sfÜm©
, 
¦ave
, 
şo£_¦ave
, 
NULL
, 
´—mbË_v®s
, 0);

507 
	}
}

510 
	$¢d_pcm_¶ug_chªge_fÜm©
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ**
Ãw
, 
¢d_pcm_¶ug_·¿ms_t
 *
şt
, snd_pcm_¶ug_·¿ms_ˆ*
¦v
)

512 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

513 
”r
;

514 
¢d_pcm_fÜm©_t
 
cfmt
;

515 (*
f
)(
¢d_pcm_t
 **
_pcm
, cÚ¡ *
Çme
, 
¢d_pcm_fÜm©_t
 
sfÜm©
, snd_pcm_ˆ*
¦ave
, 
şo£_¦ave
);

518 ià(
şt
->
fÜm©
 =ğ
¦v
->format &&

519 
şt
->
¿‹
 =ğ
¦v
->rate &&

520 
şt
->
chªÃls
 =ğ
¦v
->channels &&

521 (!
¶ug
->
‰abË
 ||…lug->
‰abË_ok
))

524 ià(
	`¢d_pcm_fÜm©_lš—r
(
¦v
->
fÜm©
)) {

526 ià(
şt
->
¿‹
 !ğ
¦v
->rate ||

527 
şt
->
chªÃls
 !ğ
¦v
->channels ||

528 (
¶ug
->
‰abË
 && !¶ug->
‰abË_ok
))

530 
cfmt
 = 
şt
->
fÜm©
;

531 
şt
->
fÜm©
) {

532 #ifdeà
BUILD_PCM_PLUGIN_MULAW


533 
SND_PCM_FORMAT_MU_LAW
:

534 
f
 = 
¢d_pcm_muÏw_İ’
;

537 #ifdeà
BUILD_PCM_PLUGIN_ALAW


538 
SND_PCM_FORMAT_A_LAW
:

539 
f
 = 
¢d_pcm_®aw_İ’
;

542 #ifdeà
BUILD_PCM_PLUGIN_ADPCM


543 
SND_PCM_FORMAT_IMA_ADPCM
:

544 
f
 = 
¢d_pcm_adpcm_İ’
;

547 #ifdeà
BUILD_PCM_PLUGIN_IEC958


548 
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
:

549 
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
:

550 
f
 = 
›c958_İ’
;

554 #ifdeà
BUILD_PCM_PLUGIN_LFLOAT


555 ià(
	`¢d_pcm_fÜm©_æßt
(
şt
->
fÜm©
))

556 
f
 = 
¢d_pcm_læßt_İ’
;

560 
f
 = 
¢d_pcm_lš—r_İ’
;

563 #ifdeà
BUILD_PCM_PLUGIN_LFLOAT


564 } ià(
	`¢d_pcm_fÜm©_æßt
(
¦v
->
fÜm©
)) {

565 ià(
	`¢d_pcm_fÜm©_lš—r
(
şt
->
fÜm©
)) {

566 
cfmt
 = 
şt
->
fÜm©
;

567 
f
 = 
¢d_pcm_læßt_İ’
;

568 } ià(
şt
->
¿‹
 !ğ
¦v
->¿‹ || cÉ->
chªÃls
 != slv->channels ||

569 (
¶ug
->
‰abË
 && !¶ug->
‰abË_ok
)) {

570 
cfmt
 = 
SND_PCM_FORMAT_S16
;

571 
f
 = 
¢d_pcm_læßt_İ’
;

573  -
EINVAL
;

575 #ifdeà
BUILD_PCM_NONLINEAR


577 
¦v
->
fÜm©
) {

578 #ifdeà
BUILD_PCM_PLUGIN_MULAW


579 
SND_PCM_FORMAT_MU_LAW
:

580 
f
 = 
¢d_pcm_muÏw_İ’
;

583 #ifdeà
BUILD_PCM_PLUGIN_ALAW


584 
SND_PCM_FORMAT_A_LAW
:

585 
f
 = 
¢d_pcm_®aw_İ’
;

588 #ifdeà
BUILD_PCM_PLUGIN_ADPCM


589 
SND_PCM_FORMAT_IMA_ADPCM
:

590 
f
 = 
¢d_pcm_adpcm_İ’
;

593 #ifdeà
BUILD_PCM_PLUGIN_IEC958


594 
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
:

595 
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
:

596 
f
 = 
›c958_İ’
;

600  -
EINVAL
;

602 ià(
	`¢d_pcm_fÜm©_lš—r
(
şt
->
fÜm©
))

603 
cfmt
 = 
şt
->
fÜm©
;

605 
cfmt
 = 
SND_PCM_FORMAT_S16
;

608 
”r
 = 
	`f
(
Ãw
, 
NULL
, 
¦v
->
fÜm©
, 
¶ug
->
g’
.
¦ave
,…lug->g’.¦av!ğ¶ug->
»q_¦ave
);

609 ià(
”r
 < 0)

610  
”r
;

611 
¦v
->
fÜm©
 = 
cfmt
;

612 
¦v
->
acûss
 = 
şt
->access;

614 
	}
}

616 
	$¢d_pcm_¶ug_chªge_acûss
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ**
Ãw
, 
¢d_pcm_¶ug_·¿ms_t
 *
şt
, snd_pcm_¶ug_·¿ms_ˆ*
¦v
)

618 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

619 
”r
;

620 ià(
şt
->
acûss
 =ğ
¦v
->access)

622 
”r
 = 
	`¢d_pcm_cİy_İ’
(
Ãw
, 
NULL
, 
¶ug
->
g’
.
¦ave
,…lug->g’.¦av!ğ¶ug->
»q_¦ave
);

623 ià(
”r
 < 0)

624  
”r
;

625 
¦v
->
acûss
 = 
şt
->access;

627 
	}
}

629 #ifdeà
BUILD_PCM_PLUGIN_MMAP_EMUL


630 
	$¢d_pcm_¶ug_chªge_mm­
(
¢d_pcm_t
 *
pcm
, snd_pcm_ˆ**
Ãw
,

631 
¢d_pcm_¶ug_·¿ms_t
 *
şt
,

632 
¢d_pcm_¶ug_·¿ms_t
 *
¦v
)

634 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

635 
”r
;

637 ià(
şt
->
acûss
 =ğ
¦v
->access)

640 
¦v
->
acûss
) {

641 
SND_PCM_ACCESS_MMAP_INTERLEAVED
:

642 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
:

643 
SND_PCM_ACCESS_MMAP_COMPLEX
:

649 
”r
 = 
	`__¢d_pcm_mm­_emul_İ’
(
Ãw
, 
NULL
, 
¶ug
->
g’
.
¦ave
,

650 
¶ug
->
g’
.
¦ave
 !ğ¶ug->
»q_¦ave
);

651 ià(
”r
 < 0)

652  
”r
;

653 
¦v
->
acûss
) {

654 
SND_PCM_ACCESS_RW_INTERLEAVED
:

655 
¦v
->
acûss
 = 
SND_PCM_ACCESS_MMAP_INTERLEAVED
;

657 
SND_PCM_ACCESS_RW_NONINTERLEAVED
:

658 
¦v
->
acûss
 = 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
;

664 
	}
}

667 
	$¢d_pcm_¶ug_š£¹_¶ugšs
(
¢d_pcm_t
 *
pcm
,

668 
¢d_pcm_¶ug_·¿ms_t
 *
ş›Á
,

669 
¢d_pcm_¶ug_·¿ms_t
 *
¦ave
)

671 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

672 (*cÚ¡ 
funcs
[])(
¢d_pcm_t
 *
_pcm
, snd_pcm_ˆ**
Ãw
, 
¢d_pcm_¶ug_·¿ms_t
 *
s
, snd_pcm_¶ug_·¿ms_ˆ*
d
) = {

673 #ifdeà
BUILD_PCM_PLUGIN_MMAP_EMUL


674 
¢d_pcm_¶ug_chªge_mm­
,

676 
¢d_pcm_¶ug_chªge_fÜm©
,

677 #ifdeà
BUILD_PCM_PLUGIN_ROUTE


678 
¢d_pcm_¶ug_chªge_chªÃls
,

680 #ifdeà
BUILD_PCM_PLUGIN_RATE


681 
¢d_pcm_¶ug_chªge_¿‹
,

683 #ifdeà
BUILD_PCM_PLUGIN_ROUTE


684 
¢d_pcm_¶ug_chªge_chªÃls
,

686 
¢d_pcm_¶ug_chªge_fÜm©
,

687 
¢d_pcm_¶ug_chªge_acûss


689 
¢d_pcm_¶ug_·¿ms_t
 
p
 = *
¦ave
;

690 
k
 = 0;

691 
¶ug
->
‰abË_ok
 = 0;

692 
ş›Á
->
fÜm©
 !ğ
p
.format ||

693 
ş›Á
->
chªÃls
 !ğ
p
.channels ||

694 
ş›Á
->
¿‹
 !ğ
p
.rate ||

695 
ş›Á
->
acûss
 !ğ
p
.access ||

696 (
¶ug
->
‰abË
 && !¶ug->
‰abË_ok
)) {

697 
¢d_pcm_t
 *
Ãw
;

698 
”r
;

699 ià(
k
 >ğ(
funcs
)/(*funcs)) {

700 
	`¢d_pcm_¶ug_ş—r
(
pcm
);

701  -
EINVAL
;

703 
”r
 = 
funcs
[
k
](
pcm
, &
Ãw
, 
ş›Á
, &
p
);

704 ià(
”r
 < 0) {

705 
	`¢d_pcm_¶ug_ş—r
(
pcm
);

706  
”r
;

708 ià(
”r
) {

709 
¶ug
->
g’
.
¦ave
 = 
Ãw
;

711 
k
++;

714 
	}
}

716 
	$¢d_pcm_¶ug_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

718 
¿‹_mš
, 
chªÃls_max
;

719 
”r
;

722 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
, &
¿‹_mš
, 
NULL
);

723 ià(
”r
 < 0)

724  
”r
;

725 ià(
¿‹_mš
 < 4000) {

726 
	`_¢d_pcm_hw_·¿m_£t_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
, 4000, 0);

727 ià(
	`¢d_pcm_hw_·¿m_em±y
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
))

728  -
EINVAL
;

731 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘_max
(
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
, &
chªÃls_max
, 
NULL
);

732 ià(
”r
 < 0)

733  
”r
;

734 ià(
chªÃls_max
 > 10000) {

735 
	`_¢d_pcm_hw_·¿m_£t_max
(
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
, 10000, 0);

736 ià(
	`¢d_pcm_hw_·¿m_em±y
(
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
))

737  -
EINVAL
;

740 
	}
}

742 
	$¢d_pcm_¶ug_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

744 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

745 
”r
;

747 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

748 ià(
¶ug
->
sfÜm©
 >= 0) {

749 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
¥¬ams
, 
¶ug
->
sfÜm©
);

750 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¥¬ams
, 
SND_PCM_SUBFORMAT_STD
);

752 ià(
¶ug
->
schªÃls
 > 0)

753 
	`_¢d_pcm_hw_·¿m_£t
(
¥¬ams
, 
SND_PCM_HW_PARAM_CHANNELS
,

754 
¶ug
->
schªÃls
, 0);

755 ià(
¶ug
->
¤©e
 > 0)

756 
	`_¢d_pcm_hw_·¿m_£t_mšmax
(
¥¬ams
, 
SND_PCM_HW_PARAM_RATE
,

757 
¶ug
->
¤©e
, 0,…lug->srate + 1, -1);

759 
”r
 = 
	`¢d_pcm_hw_»fše
(
¶ug
->
»q_¦ave
, 
¥¬ams
);

760 ià(
”r
 < 0)

761  
”r
;

763 
	}
}

765 
	$check_acûss_chªge
(
¢d_pcm_hw_·¿ms_t
 *
ı¬ams
,

766 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

768 
¢d_pcm_acûss_mask_t
 *
smask
;

769 #ifdeà
BUILD_PCM_PLUGIN_MMAP_EMUL


770 cÚ¡ 
¢d_pcm_acûss_mask_t
 *
cmask
;

771 
¢d_pcm_acûss_mask_t
 
mask
;

774 
smask
 = (
¢d_pcm_acûss_mask_t
 *)

775 
	`¢d_pcm_hw_·¿m_g‘_mask
(
¥¬ams
,

776 
SND_PCM_HW_PARAM_ACCESS
);

777 ià(
	`¢d_pcm_acûss_mask_‹¡
(
smask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
) ||

778 
	`¢d_pcm_acûss_mask_‹¡
(
smask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
) ||

779 
	`¢d_pcm_acûss_mask_‹¡
(
smask
, 
SND_PCM_ACCESS_MMAP_COMPLEX
))

781 #ifdeà
BUILD_PCM_PLUGIN_MMAP_EMUL


784 ià(!
	`¢d_pcm_acûss_mask_‹¡
(
smask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
) &&

785 !
	`¢d_pcm_acûss_mask_‹¡
(
smask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
))

786  -
EINVAL
;

788 
cmask
 = (cÚ¡ 
¢d_pcm_acûss_mask_t
 *)

789 
	`¢d_pcm_hw_·¿m_g‘_mask
(
ı¬ams
,

790 
SND_PCM_HW_PARAM_ACCESS
);

791 
	`¢d_mask_nÚe
(&
mask
);

792 ià(
	`¢d_pcm_acûss_mask_‹¡
(
cmask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
) ||

793 
	`¢d_pcm_acûss_mask_‹¡
(
cmask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
)) {

794 ià(
	`¢d_pcm_acûss_mask_‹¡
(
smask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
))

795 
	`¢d_pcm_acûss_mask_£t
(&
mask
,

796 
SND_PCM_ACCESS_RW_INTERLEAVED
);

798 ià(
	`¢d_pcm_acûss_mask_‹¡
(
cmask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
) ||

799 
	`¢d_pcm_acûss_mask_‹¡
(
cmask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
)) {

800 ià(
	`¢d_pcm_acûss_mask_‹¡
(
smask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
))

801 
	`¢d_pcm_acûss_mask_£t
(&
mask
,

802 
SND_PCM_ACCESS_RW_NONINTERLEAVED
);

804 ià(!
	`¢d_mask_em±y
(&
mask
))

805 *
smask
 = 
mask
;

808  -
EINVAL
;

810 
	}
}

812 
	$¢d_pcm_¶ug_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

813 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

815 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

816 
¢d_pcm_t
 *
¦ave
 = 
¶ug
->
»q_¦ave
;

817 
lšks
 = (
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

818 
SND_PCM_HW_PARBIT_TICK_TIME
);

819 cÚ¡ 
¢d_pcm_fÜm©_mask_t
 *
fÜm©_mask
, *
sfÜm©_mask
;

820 
¢d_pcm_fÜm©_mask_t
 
sfmt_mask
;

821 
”r
;

822 
¢d_pcm_fÜm©_t
 
fÜm©
;

823 
¢d_š‹rv®_t
 
t
, 
bufãr_size
;

824 cÚ¡ 
¢d_š‹rv®_t
 *
¤©e
, *
ü©e
;

826 ià(
¶ug
->
¤©e
 == -2 ||

827 (
pcm
->
mode
 & 
SND_PCM_NO_AUTO_RESAMPLE
) ||

828 (
·¿ms
->
æags
 & 
SND_PCM_HW_PARAMS_NORESAMPLE
))

829 
lšks
 |ğ
SND_PCM_HW_PARBIT_RATE
;

831 
”r
 = 
	`¢d_pcm_hw_·¿m_»fše_muÉË
(
¦ave
, 
¥¬ams
, 
SND_PCM_HW_PARAM_RATE
, 
·¿ms
);

832 ià(
”r
 < 0)

833  
”r
;

836 ià(
¶ug
->
schªÃls
 =ğ-2 || (
pcm
->
mode
 & 
SND_PCM_NO_AUTO_CHANNELS
))

837 
lšks
 |ğ
SND_PCM_HW_PARBIT_CHANNELS
;

839 
”r
 = 
	`¢d_pcm_hw_·¿m_»fše_Ã¬
(
¦ave
, 
¥¬ams
, 
SND_PCM_HW_PARAM_CHANNELS
, 
·¿ms
);

840 ià(
”r
 < 0)

841  
”r
;

843 ià(
¶ug
->
sfÜm©
 =ğ-2 || (
pcm
->
mode
 & 
SND_PCM_NO_AUTO_FORMAT
))

844 
lšks
 |ğ
SND_PCM_HW_PARBIT_FORMAT
;

846 
fÜm©_mask
 = 
	`¢d_pcm_hw_·¿m_g‘_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
);

847 
sfÜm©_mask
 = 
	`¢d_pcm_hw_·¿m_g‘_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_FORMAT
);

848 
	`¢d_mask_nÚe
(&
sfmt_mask
);

849 
fÜm©
 = 0; fÜm© <ğ
SND_PCM_FORMAT_LAST
; format++) {

850 
¢d_pcm_fÜm©_t
 
f
;

851 ià(!
	`¢d_pcm_fÜm©_mask_‹¡
(
fÜm©_mask
, 
fÜm©
))

853 ià(
	`¢d_pcm_fÜm©_mask_‹¡
(
sfÜm©_mask
, 
fÜm©
))

854 
f
 = 
fÜm©
;

856 
f
 = 
	`¢d_pcm_¶ug_¦ave_fÜm©
(
fÜm©
, 
sfÜm©_mask
);

857 ià(
f
 =ğ
SND_PCM_FORMAT_UNKNOWN
)

860 
	`¢d_pcm_fÜm©_mask_£t
(&
sfmt_mask
, 
f
);

863 ià(
	`¢d_pcm_fÜm©_mask_em±y
(&
sfmt_mask
)) {

864 
	`SNDERR
("UÇbËØfšd‡Àu§bË sÏvfÜm© fÜ '%s'", 
pcm
->
Çme
);

865 
fÜm©
 = 0; fÜm© <ğ
SND_PCM_FORMAT_LAST
; format++) {

866 ià(!
	`¢d_pcm_fÜm©_mask_‹¡
(
fÜm©_mask
, 
fÜm©
))

868 
	`SNDERR
("FÜm©: %s", 
	`¢d_pcm_fÜm©_Çme
(
fÜm©
));

870 
fÜm©
 = 0; fÜm© <ğ
SND_PCM_FORMAT_LAST
; format++) {

871 ià(!
	`¢d_pcm_fÜm©_mask_‹¡
(
sfÜm©_mask
, 
fÜm©
))

873 
	`SNDERR
("SÏvfÜm©: %s", 
	`¢d_pcm_fÜm©_Çme
(
fÜm©
));

875  -
EINVAL
;

877 
”r
 = 
	`¢d_pcm_hw_·¿m_£t_mask
(
¦ave
, 
¥¬ams
, 
SND_CHANGE
,

878 
SND_PCM_HW_PARAM_FORMAT
, &
sfmt_mask
);

879 ià(
”r
 < 0)

880  -
EINVAL
;

883 ià(
	`¢d_pcm_hw_·¿m_Ãv”_eq
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
, 
¥¬ams
)) {

884 
”r
 = 
	`check_acûss_chªge
(
·¿ms
, 
¥¬ams
);

885 ià(
”r
 < 0) {

886 
	`SNDERR
("Unableo find‡n usable‡ccess for '%s'",

887 
pcm
->
Çme
);

888  
”r
;

892 ià((
lšks
 & 
SND_PCM_HW_PARBIT_RATE
) ||

893 
	`¢d_pcm_hw_·¿m_®ways_eq
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
, 
¥¬ams
))

894 
lšks
 |ğ(
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

895 
SND_PCM_HW_PARBIT_BUFFER_SIZE
);

897 
	`¢d_š‹rv®_cİy
(&
bufãr_size
, 
	`¢d_pcm_hw_·¿m_g‘_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
));

898 
	`¢d_š‹rv®_unæoÜ
(&
bufãr_size
);

899 
ü©e
 = 
	`¢d_pcm_hw_·¿m_g‘_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
);

900 
¤©e
 = 
	`¢d_pcm_hw_·¿m_g‘_š‹rv®
(
¥¬ams
, 
SND_PCM_HW_PARAM_RATE
);

901 
	`¢d_š‹rv®_muldiv
(&
bufãr_size
, 
¤©e
, 
ü©e
, &
t
);

902 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_š‹rv®
(
¥¬ams
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
t
);

903 ià(
”r
 < 0)

904  
”r
;

906 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

907 ià(
”r
 < 0)

908  
”r
;

910 
	}
}

912 
	$¢d_pcm_¶ug_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

913 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

914 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

916 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

917 
lšks
 = (
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

918 
SND_PCM_HW_PARBIT_TICK_TIME
);

919 cÚ¡ 
¢d_pcm_fÜm©_mask_t
 *
fÜm©_mask
, *
sfÜm©_mask
;

920 
¢d_pcm_fÜm©_mask_t
 
fmt_mask
;

921 
”r
;

922 
¢d_pcm_fÜm©_t
 
fÜm©
;

923 
¢d_š‹rv®_t
 
t
;

924 cÚ¡ 
¢d_š‹rv®_t
 *
sbufãr_size
;

925 cÚ¡ 
¢d_š‹rv®_t
 *
¤©e
, *
ü©e
;

927 ià(
¶ug
->
schªÃls
 =ğ-2 || (
pcm
->
mode
 & 
SND_PCM_NO_AUTO_CHANNELS
))

928 
lšks
 |ğ
SND_PCM_HW_PARBIT_CHANNELS
;

930 ià(
¶ug
->
sfÜm©
 =ğ-2 || (
pcm
->
mode
 & 
SND_PCM_NO_AUTO_FORMAT
))

931 
lšks
 |ğ
SND_PCM_HW_PARBIT_FORMAT
;

933 
fÜm©_mask
 = 
	`¢d_pcm_hw_·¿m_g‘_mask
(
·¿ms
,

934 
SND_PCM_HW_PARAM_FORMAT
);

935 
sfÜm©_mask
 = 
	`¢d_pcm_hw_·¿m_g‘_mask
(
¥¬ams
,

936 
SND_PCM_HW_PARAM_FORMAT
);

937 
	`¢d_mask_nÚe
(&
fmt_mask
);

938 
fÜm©
 = 0; fÜm© <ğ
SND_PCM_FORMAT_LAST
; format++) {

939 
¢d_pcm_fÜm©_t
 
f
;

940 ià(!
	`¢d_pcm_fÜm©_mask_‹¡
(
fÜm©_mask
, 
fÜm©
))

942 ià(
	`¢d_pcm_fÜm©_mask_‹¡
(
sfÜm©_mask
, 
fÜm©
))

943 
f
 = 
fÜm©
;

945 
f
 = 
	`¢d_pcm_¶ug_¦ave_fÜm©
(
fÜm©
, 
sfÜm©_mask
);

946 ià(
f
 =ğ
SND_PCM_FORMAT_UNKNOWN
)

949 
	`¢d_pcm_fÜm©_mask_£t
(&
fmt_mask
, 
fÜm©
);

952 ià(
	`¢d_pcm_fÜm©_mask_em±y
(&
fmt_mask
)) {

953 
	`SNDERR
("Unableo find‡n usable client format");

954 
fÜm©
 = 0; fÜm© <ğ
SND_PCM_FORMAT_LAST
; format++) {

955 ià(!
	`¢d_pcm_fÜm©_mask_‹¡
(
fÜm©_mask
, 
fÜm©
))

957 
	`SNDERR
("FÜm©: %s", 
	`¢d_pcm_fÜm©_Çme
(
fÜm©
));

959 
fÜm©
 = 0; fÜm© <ğ
SND_PCM_FORMAT_LAST
; format++) {

960 ià(!
	`¢d_pcm_fÜm©_mask_‹¡
(
sfÜm©_mask
, 
fÜm©
))

962 
	`SNDERR
("SÏvfÜm©: %s", 
	`¢d_pcm_fÜm©_Çme
(
fÜm©
));

964  -
EINVAL
;

967 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
,

968 
SND_PCM_HW_PARAM_FORMAT
, &
fmt_mask
);

969 ià(
”r
 < 0)

970  
”r
;

973 ià(
¶ug
->
¤©e
 == -2 ||

974 (
pcm
->
mode
 & 
SND_PCM_NO_AUTO_RESAMPLE
) ||

975 (
·¿ms
->
æags
 & 
SND_PCM_HW_PARAMS_NORESAMPLE
))

976 
lšks
 |ğ
SND_PCM_HW_PARBIT_RATE
;

978 
¿‹_mš
, 
¤©e_mš
;

979 
¿‹_mšdœ
, 
¤©e_mšdœ
;

982 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
, &
¿‹_mš
, &
¿‹_mšdœ
);

983 ià(
”r
 < 0)

984  
”r
;

985 
”r
 = 
	`¢d_pcm_hw_·¿m_g‘_mš
(
¥¬ams
, 
SND_PCM_HW_PARAM_RATE
, &
¤©e_mš
, &
¤©e_mšdœ
);

986 ià(
”r
 < 0)

987  
”r
;

988 ià(
¿‹_mš
 =ğ
¤©e_mš
 && 
¤©e_mšdœ
 > 
¿‹_mšdœ
) {

989 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
, 
¤©e_mš
, 
¤©e_mšdœ
);

990 ià(
”r
 < 0)

991  
”r
;

994 ià((
lšks
 & 
SND_PCM_HW_PARBIT_RATE
) ||

995 
	`¢d_pcm_hw_·¿m_®ways_eq
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
, 
¥¬ams
))

996 
lšks
 |ğ(
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

997 
SND_PCM_HW_PARBIT_BUFFER_SIZE
);

999 
sbufãr_size
 = 
	`¢d_pcm_hw_·¿m_g‘_š‹rv®
(
¥¬ams
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
);

1000 
ü©e
 = 
	`¢d_pcm_hw_·¿m_g‘_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
);

1001 
¤©e
 = 
	`¢d_pcm_hw_·¿m_g‘_š‹rv®
(
¥¬ams
, 
SND_PCM_HW_PARAM_RATE
);

1002 
	`¢d_š‹rv®_muldiv
(
sbufãr_size
, 
ü©e
, 
¤©e
, &
t
);

1003 
	`¢d_š‹rv®_æoÜ
(&
t
);

1004 ià(
	`¢d_š‹rv®_em±y
(&
t
))

1005  -
EINVAL
;

1006 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
t
);

1007 ià(
”r
 < 0)

1008  
”r
;

1010 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

1011 ià(
”r
 < 0)

1012  
”r
;

1014 
·¿ms
->
šfo
 &ğ~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

1016 
	}
}

1018 
	$¢d_pcm_¶ug_hw_»fše_¦ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

1020 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

1021  
	`¢d_pcm_hw_»fše
(
¶ug
->
»q_¦ave
, 
·¿ms
);

1022 
	}
}

1024 
	$¢d_pcm_¶ug_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

1026  
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

1027 
¢d_pcm_¶ug_hw_»fše_ı»·»
,

1028 
¢d_pcm_¶ug_hw_»fše_cchªge
,

1029 
¢d_pcm_¶ug_hw_»fše_¥»·»
,

1030 
¢d_pcm_¶ug_hw_»fše_schªge
,

1031 
¢d_pcm_¶ug_hw_»fše_¦ave
);

1032 
	}
}

1034 
	$¢d_pcm_¶ug_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

1036 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

1037 
¢d_pcm_t
 *
¦ave
 = 
¶ug
->
»q_¦ave
;

1038 
¢d_pcm_¶ug_·¿ms_t
 
şt_·¿ms
, 
¦v_·¿ms
;

1039 
¢d_pcm_hw_·¿ms_t
 
¥¬ams
;

1040 
”r
;

1042 
”r
 = 
	`¢d_pcm_¶ug_hw_»fše_¥»·»
(
pcm
, &
¥¬ams
);

1043 ià(
”r
 < 0)

1044  
”r
;

1045 
”r
 = 
	`¢d_pcm_¶ug_hw_»fše_schªge
(
pcm
, 
·¿ms
, &
¥¬ams
);

1046 ià(
”r
 < 0)

1047  
”r
;

1048 
”r
 = 
	`¢d_pcm_hw_»fše_soá
(
¦ave
, &
¥¬ams
);

1049 ià(
”r
 < 0)

1050  
”r
;

1052 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_acûss
)(
·¿ms
, &
şt_·¿ms
.
acûss
);

1053 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(
·¿ms
, &
şt_·¿ms
.
fÜm©
);

1054 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_chªÃls
)(
·¿ms
, &
şt_·¿ms
.
chªÃls
);

1055 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_¿‹
)(
·¿ms
, &
şt_·¿ms
.
¿‹
, 0);

1057 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(&
¥¬ams
, &
¦v_·¿ms
.
fÜm©
);

1058 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_chªÃls
)(&
¥¬ams
, &
¦v_·¿ms
.
chªÃls
);

1059 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_¿‹
)(&
¥¬ams
, &
¦v_·¿ms
.
¿‹
, 0);

1060 
	`¢d_pcm_¶ug_ş—r
(
pcm
);

1061 ià(!(
şt_·¿ms
.
fÜm©
 =ğ
¦v_·¿ms
.format &&

1062 
şt_·¿ms
.
chªÃls
 =ğ
¦v_·¿ms
.channels &&

1063 
şt_·¿ms
.
¿‹
 =ğ
¦v_·¿ms
.rate &&

1064 !
¶ug
->
‰abË
 &&

1065 
	`¢d_pcm_hw_·¿ms_‹¡_acûss
(
¦ave
, &
¥¬ams
,

1066 
şt_·¿ms
.
acûss
) >= 0)) {

1067 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_acûss_fœ¡
)(
¦ave
, &
¥¬ams
, &
¦v_·¿ms
.
acûss
);

1068 
”r
 = 
	`¢d_pcm_¶ug_š£¹_¶ugšs
(
pcm
, &
şt_·¿ms
, &
¦v_·¿ms
);

1069 ià(
”r
 < 0)

1070  
”r
;

1072 
¦ave
 = 
¶ug
->
g’
.slave;

1073 
”r
 = 
	`_¢d_pcm_hw_·¿ms_š‹º®
(
¦ave
, 
·¿ms
);

1074 ià(
”r
 < 0) {

1075 
	`¢d_pcm_¶ug_ş—r
(
pcm
);

1076  
”r
;

1078 
	`¢d_pcm_uÆšk_hw_±r
(
pcm
, 
¶ug
->
»q_¦ave
);

1079 
	`¢d_pcm_uÆšk_­¶_±r
(
pcm
, 
¶ug
->
»q_¦ave
);

1081 
pcm
->
ç¡_İs
 = 
¦ave
->fast_ops;

1082 
pcm
->
ç¡_İ_¬g
 = 
¦ave
->fast_op_arg;

1083 
	`¢d_pcm_lšk_hw_±r
(
pcm
, 
¦ave
);

1084 
	`¢d_pcm_lšk_­¶_±r
(
pcm
, 
¦ave
);

1086 
	}
}

1088 
	$¢d_pcm_¶ug_hw_ä“
(
¢d_pcm_t
 *
pcm
)

1090 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

1091 
¢d_pcm_t
 *
¦ave
 = 
¶ug
->
g’
.slave;

1092 
”r
 = 
	`¢d_pcm_hw_ä“
(
¦ave
);

1093 
	`¢d_pcm_¶ug_ş—r
(
pcm
);

1094  
”r
;

1095 
	}
}

1097 
	$¢d_pcm_¶ug_sw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 * 
·¿ms
)

1099 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

1100 
¢d_pcm_t
 *
¦ave
 = 
¶ug
->
g’
.slave;

1101 
”r
 = 
	`¢d_pcm_sw_·¿ms
(
¦ave
, 
·¿ms
);

1102 ià(
”r
 >= 0) {

1103 
pcm
->
ç¡_İs
 = 
¦ave
->fast_ops;

1104 
pcm
->
ç¡_İ_¬g
 = 
¦ave
->fast_op_arg;

1106  
”r
;

1107 
	}
}

1109 
	$¢d_pcm_¶ug_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

1111 
¢d_pcm_¶ug_t
 *
¶ug
 = 
pcm
->
´iv©e_d©a
;

1112 
	`¢d_ouut_´štf
(
out
, "Plug PCM: ");

1113 
	`¢d_pcm_dump
(
¶ug
->
g’
.
¦ave
, 
out
);

1114 
	}
}

1116 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_¶ug_İs
 = {

1117 .
şo£
 = 
¢d_pcm_¶ug_şo£
,

1118 .
	gšfo
 = 
¢d_pcm_¶ug_šfo
,

1119 .
	ghw_»fše
 = 
¢d_pcm_¶ug_hw_»fše
,

1120 .
	ghw_·¿ms
 = 
¢d_pcm_¶ug_hw_·¿ms
,

1121 .
	ghw_ä“
 = 
¢d_pcm_¶ug_hw_ä“
,

1122 .
	gsw_·¿ms
 = 
¢d_pcm_¶ug_sw_·¿ms
,

1123 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

1124 .
	gdump
 = 
¢d_pcm_¶ug_dump
,

1125 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

1126 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

1127 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

1128 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

1129 .
	gqu”y_chm­s
 = 
¢d_pcm_g’”ic_qu”y_chm­s
,

1130 .
	gg‘_chm­
 = 
¢d_pcm_g’”ic_g‘_chm­
,

1131 .
	g£t_chm­
 = 
¢d_pcm_g’”ic_£t_chm­
,

1146 
	$¢d_pcm_¶ug_İ’
(
¢d_pcm_t
 **
pcmp
,

1147 cÚ¡ *
Çme
,

1148 
¢d_pcm_fÜm©_t
 
sfÜm©
, 
schªÃls
, 
¤©e
,

1149 cÚ¡ 
¢d_cÚfig_t
 *
¿‹_cÚv”‹r
,

1150 
¢d_pcm_¶ug_rou‹_pŞicy
 
rou‹_pŞicy
,

1151 
¢d_pcm_rou‹_‰abË_’Œy_t
 *
‰abË
,

1152 
‰_ssize
,

1153 
‰_cu£d
, 
‰_su£d
,

1154 
¢d_pcm_t
 *
¦ave
, 
şo£_¦ave
)

1156 
¢d_pcm_t
 *
pcm
;

1157 
¢d_pcm_¶ug_t
 *
¶ug
;

1158 
”r
;

1159 
	`as£¹
(
pcmp
 && 
¦ave
);

1161 
¶ug
 = 
	`ÿÎoc
(1, (
¢d_pcm_¶ug_t
));

1162 ià(!
¶ug
)

1163  -
ENOMEM
;

1164 
¶ug
->
sfÜm©
 = sformat;

1165 
¶ug
->
schªÃls
 = schannels;

1166 
¶ug
->
¤©e
 = srate;

1167 
¶ug
->
g’
.
¦ave
 =…lug->
»q_¦ave
 = slave;

1168 
¶ug
->
g’
.
şo£_¦ave
 = close_slave;

1169 
¶ug
->
rou‹_pŞicy
 =„oute_policy;

1170 
¶ug
->
‰abË
 =table;

1171 
¶ug
->
‰_ssize
 =t_ssize;

1172 
¶ug
->
‰_cu£d
 =t_cused;

1173 
¶ug
->
‰_su£d
 =t_sused;

1175 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_PLUG
, 
Çme
, 
¦ave
->
¡»am
, sÏve->
mode
);

1176 ià(
”r
 < 0) {

1177 
	`ä“
(
¶ug
);

1178  
”r
;

1180 
pcm
->
İs
 = &
¢d_pcm_¶ug_İs
;

1181 
pcm
->
ç¡_İs
 = 
¦ave
->fast_ops;

1182 
pcm
->
ç¡_İ_¬g
 = 
¦ave
->fast_op_arg;

1183 ià(
¿‹_cÚv”‹r
) {

1184 
”r
 = 
	`¢d_cÚfig_cİy
(&
¶ug
->
¿‹_cÚv”‹r
,

1185 (
¢d_cÚfig_t
 *)
¿‹_cÚv”‹r
);

1186 ià(
”r
 < 0) {

1187 
	`¢d_pcm_ä“
(
pcm
);

1188 
	`ä“
(
¶ug
);

1189  
”r
;

1192 
pcm
->
´iv©e_d©a
 = 
¶ug
;

1193 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

1194 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

1195 
pcm
->
mm­_shadow
 = 1;

1196 
pcm
->
t¡amp_ty³
 = 
¦ave
->tstamp_type;

1197 
	`¢d_pcm_lšk_hw_±r
(
pcm
, 
¦ave
);

1198 
	`¢d_pcm_lšk_­¶_±r
(
pcm
, 
¦ave
);

1199 *
pcmp
 = 
pcm
;

1202 
	}
}

1264 
	$_¢d_pcm_¶ug_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1265 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

1266 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

1268 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1269 
”r
;

1270 
¢d_pcm_t
 *
¥cm
;

1271 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

1272 
¢d_cÚfig_t
 *
‰
 = 
NULL
;

1273 
¢d_pcm_¶ug_rou‹_pŞicy
 
rou‹_pŞicy
 = 
PLUG_ROUTE_POLICY_DEFAULT
;

1274 
¢d_pcm_rou‹_‰abË_’Œy_t
 *
‰abË
 = 
NULL
;

1275 
csize
, 
ssize
;

1276 
cu£d
, 
su£d
;

1277 
¢d_pcm_fÜm©_t
 
sfÜm©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1278 
schªÃls
 = -1, 
¤©e
 = -1;

1279 cÚ¡ 
¢d_cÚfig_t
 *
¿‹_cÚv”‹r
 = 
NULL
;

1281 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1282 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1283 cÚ¡ *
id
;

1284 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1286 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

1288 ià(
	`¡rcmp
(
id
, "slave") == 0) {

1289 
¦ave
 = 
n
;

1292 #ifdeà
BUILD_PCM_PLUGIN_ROUTE


1293 ià(
	`¡rcmp
(
id
, "ttable") == 0) {

1294 
rou‹_pŞicy
 = 
PLUG_ROUTE_POLICY_NONE
;

1295 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1296 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1297  -
EINVAL
;

1299 
‰
 = 
n
;

1302 ià(
	`¡rcmp
(
id
, "route_policy") == 0) {

1303 cÚ¡ *
¡r
;

1304 ià((
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
)) < 0) {

1305 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1306  -
EINVAL
;

1308 ià(
‰
 !ğ
NULL
)

1309 
	`SNDERR
("Table is defined,„oute…olicy is ignored");

1310 ià(!
	`¡rcmp
(
¡r
, "default"))

1311 
rou‹_pŞicy
 = 
PLUG_ROUTE_POLICY_DEFAULT
;

1312 ià(!
	`¡rcmp
(
¡r
, "average"))

1313 
rou‹_pŞicy
 = 
PLUG_ROUTE_POLICY_AVERAGE
;

1314 ià(!
	`¡rcmp
(
¡r
, "copy"))

1315 
rou‹_pŞicy
 = 
PLUG_ROUTE_POLICY_COPY
;

1316 ià(!
	`¡rcmp
(
¡r
, "duplicate"))

1317 
rou‹_pŞicy
 = 
PLUG_ROUTE_POLICY_DUP
;

1321 #ifdeà
BUILD_PCM_PLUGIN_RATE


1322 ià(
	`¡rcmp
(
id
, "rate_converter") == 0) {

1323 
¿‹_cÚv”‹r
 = 
n
;

1327 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

1328  -
EINVAL
;

1330 ià(!
¦ave
) {

1331 
	`SNDERR
("slave is‚ot defined");

1332  -
EINVAL
;

1334 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 3,

1335 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_UNCHANGED
, &
sfÜm©
,

1336 
SND_PCM_HW_PARAM_CHANNELS
, 
SCONF_UNCHANGED
, &
schªÃls
,

1337 
SND_PCM_HW_PARAM_RATE
, 
SCONF_UNCHANGED
, &
¤©e
);

1338 ià(
”r
 < 0)

1339  
”r
;

1340 #ifdeà
BUILD_PCM_PLUGIN_ROUTE


1341 ià(
‰
) {

1342 
”r
 = 
	`¢d_pcm_rou‹_d‘”mše_‰abË
(
‰
, &
csize
, &
ssize
);

1343 ià(
”r
 < 0) {

1344 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1345  
”r
;

1347 
‰abË
 = 
	`m®loc
(
csize
 * 
ssize
 * (*ttable));

1348 ià(
‰abË
 =ğ
NULL
) {

1349 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1350  
”r
;

1352 
”r
 = 
	`¢d_pcm_rou‹_lßd_‰abË
(
‰
, 
‰abË
, 
csize
, 
ssize
, &
cu£d
, &
su£d
, -1);

1353 ià(
”r
 < 0) {

1354 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1355  
”r
;

1360 #ifdeà
BUILD_PCM_PLUGIN_RATE


1361 ià(! 
¿‹_cÚv”‹r
)

1362 
¿‹_cÚv”‹r
 = 
	`¢d_pcm_¿‹_g‘_deçuÉ_cÚv”‹r
(
roÙ
);

1365 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

1366 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1367 ià(
”r
 < 0)

1368  
”r
;

1369 
”r
 = 
	`¢d_pcm_¶ug_İ’
(
pcmp
, 
Çme
, 
sfÜm©
, 
schªÃls
, 
¤©e
, 
¿‹_cÚv”‹r
,

1370 
rou‹_pŞicy
, 
‰abË
, 
ssize
, 
cu£d
, 
su£d
, 
¥cm
, 1);

1371 ià(
”r
 < 0)

1372 
	`¢d_pcm_şo£
(
¥cm
);

1373  
”r
;

1374 
	}
}

1375 #iâdeà
DOC_HIDDEN


1376 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_¶ug_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_plugin.c

85 
	~"pcm_loÿl.h
"

86 
	~"pcm_¶ugš.h
"

87 
	~<lim™s.h
>

89 #iâdeà
DOC_HIDDEN


91 
¢d_pcm_säames_t


92 
	$¢d_pcm_¶ugš_undo_»ad
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

93 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
»s_¬—s
 
ATTRIBUTE_UNUSED
,

94 
¢d_pcm_uäames_t
 
»s_off£t
 
ATTRIBUTE_UNUSED
,

95 
¢d_pcm_uäames_t
 
»s_size
 
ATTRIBUTE_UNUSED
,

96 
¢d_pcm_uäames_t
 
¦ave_undo_size
 
ATTRIBUTE_UNUSED
)

98  -
EIO
;

99 
	}
}

101 
¢d_pcm_säames_t


102 
	$¢d_pcm_¶ugš_undo_wr™e
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

103 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
»s_¬—s
 
ATTRIBUTE_UNUSED
,

104 
¢d_pcm_uäames_t
 
»s_off£t
 
ATTRIBUTE_UNUSED
,

105 
¢d_pcm_uäames_t
 
»s_size
 
ATTRIBUTE_UNUSED
,

106 
¢d_pcm_uäames_t
 
¦ave_undo_size
 
ATTRIBUTE_UNUSED
)

108  -
EIO
;

109 
	}
}

111 
¢d_pcm_säames_t


112 
	$¢d_pcm_¶ugš_undo_»ad_g’”ic
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

113 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
»s_¬—s
 
ATTRIBUTE_UNUSED
,

114 
¢d_pcm_uäames_t
 
»s_off£t
 
ATTRIBUTE_UNUSED
,

115 
¢d_pcm_uäames_t
 
»s_size
 
ATTRIBUTE_UNUSED
,

116 
¢d_pcm_uäames_t
 
¦ave_undo_size
)

118  
¦ave_undo_size
;

119 
	}
}

121 
¢d_pcm_säames_t


122 
	$¢d_pcm_¶ugš_undo_wr™e_g’”ic
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

123 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
»s_¬—s
 
ATTRIBUTE_UNUSED
,

124 
¢d_pcm_uäames_t
 
»s_off£t
 
ATTRIBUTE_UNUSED
,

125 
¢d_pcm_uäames_t
 
»s_size
 
ATTRIBUTE_UNUSED
,

126 
¢d_pcm_uäames_t
 
¦ave_undo_size
)

128  
¦ave_undo_size
;

129 
	}
}

131 
	$¢d_pcm_¶ugš_š™
(
¢d_pcm_¶ugš_t
 *
¶ugš
)

133 
	`mem£t
(
¶ugš
, 0, (
¢d_pcm_¶ugš_t
));

134 
¶ugš
->
undo_»ad
 = 
¢d_pcm_¶ugš_undo_»ad
;

135 
¶ugš
->
undo_wr™e
 = 
¢d_pcm_¶ugš_undo_wr™e
;

136 
	}
}

138 
	$¢d_pcm_¶ugš_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
)

140 
¢d_pcm_¶ugš_t
 *
¶ugš
 = 
pcm
->
´iv©e_d©a
;

141 
¢d_pcm_säames_t
 
sd
;

142 
”r
 = 
	`¢d_pcm_d–ay
(
¶ugš
->
g’
.
¦ave
, &
sd
);

143 ià(
”r
 < 0)

144  
”r
;

145 *
d–ayp
 = 
sd
;

147 
	}
}

149 
	$¢d_pcm_¶ugš_ÿÎ_š™_cb
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¶ugš_t
 *
¶ugš
)

151 
¢d_pcm_t
 *
¦ave
 = 
¶ugš
->
g’
.slave;

152 
”r
;

154 
	`as£¹
(
pcm
->
bound¬y
 =ğ
¦ave
->boundary);

155 *
pcm
->
hw
.
±r
 = *
¦ave
->hw.ptr;

156 *
pcm
->
­¶
.
±r
 = *
¦ave
->appl.ptr;

157 ià(
¶ugš
->
š™
) {

158 
”r
 = 
¶ugš
->
	`š™
(
pcm
);

159 ià(
”r
 < 0)

160  
”r
;

163 
	}
}

165 
	$¢d_pcm_¶ugš_´•¬e
(
¢d_pcm_t
 *
pcm
)

167 
¢d_pcm_¶ugš_t
 *
¶ugš
 = 
pcm
->
´iv©e_d©a
;

168 
”r
;

169 
”r
 = 
	`¢d_pcm_´•¬e
(
¶ugš
->
g’
.
¦ave
);

170 ià(
”r
 < 0)

171  
”r
;

172  
	`¢d_pcm_¶ugš_ÿÎ_š™_cb
(
pcm
, 
¶ugš
);

173 
	}
}

175 
	$¢d_pcm_¶ugš_»£t
(
¢d_pcm_t
 *
pcm
)

177 
¢d_pcm_¶ugš_t
 *
¶ugš
 = 
pcm
->
´iv©e_d©a
;

178 
”r
;

179 
”r
 = 
	`¢d_pcm_»£t
(
¶ugš
->
g’
.
¦ave
);

180 ià(
”r
 < 0)

181  
”r
;

182  
	`¢d_pcm_¶ugš_ÿÎ_š™_cb
(
pcm
, 
¶ugš
);

183 
	}
}

185 
¢d_pcm_säames_t
 
	$¢d_pcm_¶ugš_»wšdabË
(
¢d_pcm_t
 *
pcm
)

187  
	`¢d_pcm_mm­_hw_»wšdabË
(
pcm
);

188 
	}
}

190 
¢d_pcm_säames_t
 
	$¢d_pcm_¶ugš_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

192 
¢d_pcm_¶ugš_t
 *
¶ugš
 = 
pcm
->
´iv©e_d©a
;

193 
¢d_pcm_säames_t
 
n
 = 
	`¢d_pcm_¶ugš_»wšdabË
(
pcm
);

194 
¢d_pcm_säames_t
 
säames
;

196 ià((
¢d_pcm_uäames_t
)
n
 < 
äames
)

197 
äames
 = 
n
;

198 ià(
äames
 == 0)

201 
säames
 = 
äames
;

202 
säames
 = 
	`¢d_pcm_»wšd
(
¶ugš
->
g’
.
¦ave
, sframes);

203 ià(
säames
 < 0)

204  
säames
;

205 
	`¢d_pcm_mm­_­¶_backw¬d
(
pcm
, (
¢d_pcm_uäames_t
è
säames
);

206  (
¢d_pcm_säames_t
è
säames
;

207 
	}
}

209 
¢d_pcm_säames_t
 
	$¢d_pcm_¶ugš_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
)

211  
	`¢d_pcm_mm­_ava
(
pcm
);

212 
	}
}

214 
¢d_pcm_säames_t
 
	$¢d_pcm_¶ugš_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

216 
¢d_pcm_¶ugš_t
 *
¶ugš
 = 
pcm
->
´iv©e_d©a
;

217 
¢d_pcm_säames_t
 
n
 = 
	`¢d_pcm_¶ugš_fÜw¬dabË
(
pcm
);

218 
¢d_pcm_säames_t
 
säames
;

220 ià((
¢d_pcm_uäames_t
)
n
 < 
äames
)

221 
äames
 = 
n
;

222 ià(
äames
 == 0)

225 
säames
 = 
äames
;

226 
säames
 = 
	`INTERNAL
(
¢d_pcm_fÜw¬d
)(
¶ugš
->
g’
.
¦ave
, sframes);

227 ià(
säames
 < 0)

228  
säames
;

229 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, (
¢d_pcm_uäames_t
è
äames
);

230  (
¢d_pcm_säames_t
è
äames
;

231 
	}
}

233 
¢d_pcm_säames_t
 
	$¢d_pcm_¶ugš_wr™e_¬—s
(
¢d_pcm_t
 *
pcm
,

234 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

235 
¢d_pcm_uäames_t
 
off£t
,

236 
¢d_pcm_uäames_t
 
size
)

238 
¢d_pcm_¶ugš_t
 *
¶ugš
 = 
pcm
->
´iv©e_d©a
;

239 
¢d_pcm_t
 *
¦ave
 = 
¶ugš
->
g’
.slave;

240 
¢d_pcm_uäames_t
 
xãr
 = 0;

241 
¢d_pcm_säames_t
 
»suÉ
;

242 
”r
;

244 
size
 > 0) {

245 
¢d_pcm_uäames_t
 
äames
 = 
size
;

246 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
;

247 
¢d_pcm_uäames_t
 
¦ave_off£t
;

248 
¢d_pcm_uäames_t
 
¦ave_äames
 = 
ULONG_MAX
;

250 
»suÉ
 = 
	`¢d_pcm_mm­_begš
(
¦ave
, &
¦ave_¬—s
, &
¦ave_off£t
, &
¦ave_äames
);

251 ià(
»suÉ
 < 0) {

252 
”r
 = 
»suÉ
;

253 
”rÜ
;

255 ià(
¦ave_äames
 == 0)

257 
äames
 = 
¶ugš
->
	`wr™e
(
pcm
, 
¬—s
, 
off£t
, frames,

258 
¦ave_¬—s
, 
¦ave_off£t
, &
¦ave_äames
);

259 ià(
	`CHECK_SANITY
(
¦ave_äames
 > 
	`¢d_pcm_mm­_¶ayback_ava
(
¦ave
))) {

260 
	`SNDMSG
("wr™ov”æow %ld > %ld", 
¦ave_äames
,

261 
	`¢d_pcm_mm­_¶ayback_ava
(
¦ave
));

262 
”r
 = -
EPIPE
;

263 
”rÜ
;

265 
»suÉ
 = 
	`¢d_pcm_mm­_comm™
(
¦ave
, 
¦ave_off£t
, 
¦ave_äames
);

266 ià(
»suÉ
 > 0 && (
¢d_pcm_uäames_t
ìesuÉ !ğ
¦ave_äames
) {

267 
¢d_pcm_säames_t
 
»s
;

268 
»s
 = 
¶ugš
->
	`undo_wr™e
(
pcm
, 
¦ave_¬—s
, 
¦ave_off£t
 + 
»suÉ
, 
¦ave_äames
, slave_frames -„esult);

269 ià(
»s
 < 0) {

270 
”r
 = 
»s
;

271 
”rÜ
;

273 
äames
 -ğ
»s
;

275 ià(
»suÉ
 <= 0) {

276 
”r
 = 
»suÉ
;

277 
”rÜ
;

279 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
äames
);

280 
off£t
 +ğ
äames
;

281 
xãr
 +ğ
äames
;

282 
size
 -ğ
äames
;

284  (
¢d_pcm_säames_t
)
xãr
;

286 
”rÜ
:

287  
xãr
 > 0 ? (
¢d_pcm_säames_t
)xã¸: 
”r
;

288 
	}
}

290 
¢d_pcm_säames_t
 
	$¢d_pcm_¶ugš_»ad_¬—s
(
¢d_pcm_t
 *
pcm
,

291 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

292 
¢d_pcm_uäames_t
 
off£t
,

293 
¢d_pcm_uäames_t
 
size
)

295 
¢d_pcm_¶ugš_t
 *
¶ugš
 = 
pcm
->
´iv©e_d©a
;

296 
¢d_pcm_t
 *
¦ave
 = 
¶ugš
->
g’
.slave;

297 
¢d_pcm_uäames_t
 
xãr
 = 0;

298 
¢d_pcm_säames_t
 
»suÉ
;

299 
”r
;

301 
size
 > 0) {

302 
¢d_pcm_uäames_t
 
äames
 = 
size
;

303 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
;

304 
¢d_pcm_uäames_t
 
¦ave_off£t
;

305 
¢d_pcm_uäames_t
 
¦ave_äames
 = 
ULONG_MAX
;

307 
»suÉ
 = 
	`¢d_pcm_mm­_begš
(
¦ave
, &
¦ave_¬—s
, &
¦ave_off£t
, &
¦ave_äames
);

308 ià(
»suÉ
 < 0) {

309 
”r
 = 
»suÉ
;

310 
”rÜ
;

312 ià(
¦ave_äames
 == 0)

314 
äames
 = (
¶ugš
->
»ad
)(
pcm
, 
¬—s
, 
off£t
, frames,

315 
¦ave_¬—s
, 
¦ave_off£t
, &
¦ave_äames
);

316 ià(
	`CHECK_SANITY
(
¦ave_äames
 > 
	`¢d_pcm_mm­_ÿ±u»_ava
(
¦ave
))) {

317 
	`SNDMSG
("»ad ov”æow %ld > %ld", 
¦ave_äames
,

318 
	`¢d_pcm_mm­_¶ayback_ava
(
¦ave
));

319 
”r
 = -
EPIPE
;

320 
”rÜ
;

322 
»suÉ
 = 
	`¢d_pcm_mm­_comm™
(
¦ave
, 
¦ave_off£t
, 
¦ave_äames
);

323 ià(
»suÉ
 > 0 && (
¢d_pcm_uäames_t
ìesuÉ !ğ
¦ave_äames
) {

324 
¢d_pcm_säames_t
 
»s
;

326 
»s
 = 
¶ugš
->
	`undo_»ad
(
¦ave
, 
¬—s
, 
off£t
, 
äames
, 
¦ave_äames
 - 
»suÉ
);

327 ià(
»s
 < 0) {

328 
”r
 = 
»s
;

329 
”rÜ
;

331 
äames
 -ğ
»s
;

333 ià(
»suÉ
 <= 0) {

334 
”r
 = 
»suÉ
;

335 
”rÜ
;

337 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
äames
);

338 
off£t
 +ğ
äames
;

339 
xãr
 +ğ
äames
;

340 
size
 -ğ
äames
;

342  (
¢d_pcm_säames_t
)
xãr
;

344 
”rÜ
:

345  
xãr
 > 0 ? (
¢d_pcm_säames_t
)xã¸: 
”r
;

346 
	}
}

349 
¢d_pcm_säames_t


350 
	$¢d_pcm_¶ugš_wr™ei
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

352 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

353 
	`¢d_pcm_¬—s_äom_buf
(
pcm
, 
¬—s
, (*)
bufãr
);

354  
	`¢d_pcm_wr™e_¬—s
(
pcm
, 
¬—s
, 0, 
size
,

355 
¢d_pcm_¶ugš_wr™e_¬—s
);

356 
	}
}

358 
¢d_pcm_säames_t


359 
	$¢d_pcm_¶ugš_wr™’
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

361 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

362 
	`¢d_pcm_¬—s_äom_bufs
(
pcm
, 
¬—s
, 
bufs
);

363  
	`¢d_pcm_wr™e_¬—s
(
pcm
, 
¬—s
, 0, 
size
,

364 
¢d_pcm_¶ugš_wr™e_¬—s
);

365 
	}
}

367 
¢d_pcm_säames_t


368 
	$¢d_pcm_¶ugš_»adi
(
¢d_pcm_t
 *
pcm
, *
bufãr
, 
¢d_pcm_uäames_t
 
size
)

370 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

371 
	`¢d_pcm_¬—s_äom_buf
(
pcm
, 
¬—s
, 
bufãr
);

372  
	`¢d_pcm_»ad_¬—s
(
pcm
, 
¬—s
, 0, 
size
,

373 
¢d_pcm_¶ugš_»ad_¬—s
);

374 
	}
}

376 
¢d_pcm_säames_t


377 
	$¢d_pcm_¶ugš_»adn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_uäames_t
 
size
)

379 
¢d_pcm_chªÃl_¬—_t
 
¬—s
[
pcm
->
chªÃls
];

380 
	`¢d_pcm_¬—s_äom_bufs
(
pcm
, 
¬—s
, 
bufs
);

381  
	`¢d_pcm_»ad_¬—s
(
pcm
, 
¬—s
, 0, 
size
,

382 
¢d_pcm_¶ugš_»ad_¬—s
);

383 
	}
}

385 
¢d_pcm_säames_t


386 
	$¢d_pcm_¶ugš_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

387 
¢d_pcm_uäames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

388 
¢d_pcm_uäames_t
 
size
)

390 
¢d_pcm_¶ugš_t
 *
¶ugš
 = 
pcm
->
´iv©e_d©a
;

391 
¢d_pcm_t
 *
¦ave
 = 
¶ugš
->
g’
.slave;

392 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
;

393 
¢d_pcm_uäames_t
 
­¶_off£t
;

394 
¢d_pcm_säames_t
 
¦ave_size
;

395 
¢d_pcm_säames_t
 
xãr
;

396 
”r
;

398 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
) {

399 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
size
);

400  
size
;

402 
¦ave_size
 = 
	`¢d_pcm_ava_upd©e
(
¦ave
);

403 ià(
¦ave_size
 < 0)

404  
¦ave_size
;

405 
¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

406 
­¶_off£t
 = 
	`¢d_pcm_mm­_off£t
(
pcm
);

407 
xãr
 = 0;

408 
size
 > 0 && 
¦ave_size
 > 0) {

409 
¢d_pcm_uäames_t
 
äames
 = 
size
;

410 
¢d_pcm_uäames_t
 
cÚt
 = 
pcm
->
bufãr_size
 - 
­¶_off£t
;

411 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
;

412 
¢d_pcm_uäames_t
 
¦ave_off£t
;

413 
¢d_pcm_uäames_t
 
¦ave_äames
 = 
ULONG_MAX
;

414 
¢d_pcm_säames_t
 
»suÉ
;

416 
»suÉ
 = 
	`¢d_pcm_mm­_begš
(
¦ave
, &
¦ave_¬—s
, &
¦ave_off£t
, &
¦ave_äames
);

417 ià(
»suÉ
 < 0) {

418 
”r
 = 
»suÉ
;

419 
”rÜ
;

421 ià(
äames
 > 
cÚt
)

422 
äames
 = 
cÚt
;

423 
äames
 = 
¶ugš
->
	`wr™e
(
pcm
, 
¬—s
, 
­¶_off£t
, frames,

424 
¦ave_¬—s
, 
¦ave_off£t
, &
¦ave_äames
);

425 
»suÉ
 = 
	`¢d_pcm_mm­_comm™
(
¦ave
, 
¦ave_off£t
, 
¦ave_äames
);

426 ià(
»suÉ
 > 0 && (
¢d_pcm_uäames_t
ìesuÉ !ğ
¦ave_äames
) {

427 
¢d_pcm_säames_t
 
»s
;

429 
»s
 = 
¶ugš
->
	`undo_wr™e
(
pcm
, 
¦ave_¬—s
, 
¦ave_off£t
 + 
»suÉ
, 
¦ave_äames
, slave_frames -„esult);

430 ià(
»s
 < 0) {

431 
”r
 = 
»s
;

432 
”rÜ
;

434 
äames
 -ğ
»s
;

436 ià(
»suÉ
 <= 0) {

437 
”r
 = 
»suÉ
;

438 
”rÜ
;

440 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
äames
);

441 ià(
äames
 =ğ
cÚt
)

442 
­¶_off£t
 = 0;

444 
­¶_off£t
 +ğ
»suÉ
;

445 
size
 -ğ
äames
;

446 
¦ave_size
 -ğ
äames
;

447 
xãr
 +ğ
äames
;

449 ià(
	`CHECK_SANITY
(
size
)) {

450 
	`SNDMSG
("shÜˆcomm™: %ld", 
size
);

451  -
EPIPE
;

453  
xãr
;

455 
”rÜ
:

456  
xãr
 > 0 ? xã¸: 
”r
;

457 
	}
}

459 
¢d_pcm_säames_t


460 
	$¢d_pcm_¶ugš_sync_hw_±r_ÿ±u»
(
¢d_pcm_t
 *
pcm
,

461 
¢d_pcm_säames_t
 
¦ave_size
)

463 
¢d_pcm_¶ugš_t
 *
¶ugš
 = 
pcm
->
´iv©e_d©a
;

464 
¢d_pcm_t
 *
¦ave
 = 
¶ugš
->
g’
.slave;

465 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
;

466 
¢d_pcm_uäames_t
 
xãr
, 
hw_off£t
, 
size
;

467 
”r
;

469 
xãr
 = 
	`¢d_pcm_mm­_ÿ±u»_ava
(
pcm
);

470 
size
 = 
pcm
->
bufãr_size
 - 
xãr
;

471 
¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

472 
hw_off£t
 = 
	`¢d_pcm_mm­_hw_off£t
(
pcm
);

473 
size
 > 0 && 
¦ave_size
 > 0) {

474 
¢d_pcm_uäames_t
 
äames
 = 
size
;

475 
¢d_pcm_uäames_t
 
cÚt
 = 
pcm
->
bufãr_size
 - 
hw_off£t
;

476 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
;

477 
¢d_pcm_uäames_t
 
¦ave_off£t
;

478 
¢d_pcm_uäames_t
 
¦ave_äames
 = 
ULONG_MAX
;

479 
¢d_pcm_säames_t
 
»suÉ
;

487 
¦ave_size
 = 
	`¢d_pcm_ava_upd©e
(
¦ave
);

488 
»suÉ
 = 
	`¢d_pcm_mm­_begš
(
¦ave
, &
¦ave_¬—s
, &
¦ave_off£t
, &
¦ave_äames
);

489 ià(
»suÉ
 < 0) {

490 
”r
 = 
»suÉ
;

491 
”rÜ
;

493 ià(
äames
 > 
cÚt
)

494 
äames
 = 
cÚt
;

495 
äames
 = (
¶ugš
->
»ad
)(
pcm
, 
¬—s
, 
hw_off£t
, frames,

496 
¦ave_¬—s
, 
¦ave_off£t
, &
¦ave_äames
);

497 
»suÉ
 = 
	`¢d_pcm_mm­_comm™
(
¦ave
, 
¦ave_off£t
, 
¦ave_äames
);

498 ià(
»suÉ
 > 0 && (
¢d_pcm_uäames_t
ìesuÉ !ğ
¦ave_äames
) {

499 
¢d_pcm_säames_t
 
»s
;

500 
»s
 = 
¶ugš
->
	`undo_»ad
(
¦ave
, 
¬—s
, 
hw_off£t
, 
äames
, 
¦ave_äames
 - 
»suÉ
);

501 ià(
»s
 < 0) {

502 
”r
 = 
»s
;

503 
”rÜ
;

505 
äames
 -ğ
»s
;

507 ià(
»suÉ
 <= 0) {

508 
”r
 = 
»suÉ
;

509 
”rÜ
;

511 
	`¢d_pcm_mm­_hw_fÜw¬d
(
pcm
, 
äames
);

512 ià(
äames
 =ğ
cÚt
)

513 
hw_off£t
 = 0;

515 
hw_off£t
 +ğ
äames
;

516 
size
 -ğ
äames
;

517 
¦ave_size
 -ğ
¦ave_äames
;

518 
xãr
 +ğ
äames
;

520  (
¢d_pcm_säames_t
)
xãr
;

521 
”rÜ
:

522  
xãr
 > 0 ? (
¢d_pcm_säames_t
)xã¸: 
”r
;

523 
	}
}

525 
¢d_pcm_säames_t
 
	$¢d_pcm_¶ugš_sync_hw_±r
(
¢d_pcm_t
 *
pcm
,

526 
¢d_pcm_uäames_t
 
¦ave_hw_±r
,

527 
¢d_pcm_säames_t
 
¦ave_size
)

529 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
 &&

530 
pcm
->
acûss
 !ğ
SND_PCM_ACCESS_RW_INTERLEAVED
 &&

531 
pcm
->
acûss
 !ğ
SND_PCM_ACCESS_RW_NONINTERLEAVED
)

532  
	`¢d_pcm_¶ugš_sync_hw_±r_ÿ±u»
(
pcm
, 
¦ave_size
);

533 *
pcm
->
hw
.
±r
 = 
¦ave_hw_±r
;

534  
¦ave_size
;

535 
	}
}

537 
¢d_pcm_säames_t
 
	$¢d_pcm_¶ugš_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

539 
¢d_pcm_¶ugš_t
 *
¶ugš
 = 
pcm
->
´iv©e_d©a
;

540 
¢d_pcm_t
 *
¦ave
 = 
¶ugš
->
g’
.slave;

541 
¢d_pcm_säames_t
 
¦ave_size
;

543 
¦ave_size
 = 
	`¢d_pcm_ava_upd©e
(
¦ave
);

544  
	`¢d_pcm_¶ugš_sync_hw_±r
(
pcm
, *
¦ave
->
hw
.
±r
, 
¦ave_size
);

545 
	}
}

547 
	$¢d_pcm_¶ugš_¡©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©us_t
 * 
¡©us
)

549 
¢d_pcm_¶ugš_t
 *
¶ugš
 = 
pcm
->
´iv©e_d©a
;

550 
¢d_pcm_säames_t
 
”r
, 
diff
;

552 
”r
 = 
	`¢d_pcm_¡©us
(
¶ugš
->
g’
.
¦ave
, 
¡©us
);

553 ià(
”r
 < 0)

554  
”r
;

555 
	`¢d_pcm_¶ugš_sync_hw_±r
(
pcm
, 
¡©us
->
hw_±r
, stus->
ava
);

566 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
) {

567 
diff
 = 
	`pcm_äame_diff
(
¡©us
->
­¶_±r
, *
pcm
->
­¶
.
±r
,…cm->
bound¬y
);

568 
¡©us
->
­¶_±r
 = *
pcm
->
­¶
.
±r
;

569 
¡©us
->
ava
 +ğ
diff
;

570 
¡©us
->
d–ay
 +ğ
diff
;

572 
	`as£¹
(
¡©us
->
­¶_±r
 =ğ*
pcm
->
­¶
.
±r
);

575 
	}
}

577 
¢d_pcm_¶ugš_may_wa™_fÜ_ava_mš_cÚv
(

578 
¢d_pcm_t
 *
pcm
,

579 
¢d_pcm_uäames_t
 
ava
,

580 
	$¢d_pcm_uäames_t
 (*
cÚv
)(
¢d_pcm_t
 *, 
¢d_pcm_uäames_t
))

582 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
 &&

583 
pcm
->
acûss
 !ğ
SND_PCM_ACCESS_RW_INTERLEAVED
 &&

584 
pcm
->
acûss
 !ğ
SND_PCM_ACCESS_RW_NONINTERLEAVED
) {

600 
¢d_pcm_g’”ic_t
 *
g’”ic
 = 
pcm
->
´iv©e_d©a
;

605 
¢d_pcm_t
 *
¦ave
 = 
g’”ic
->slave;

606 
¢d_pcm_uäames_t
 
Ãeded_¦ave_ava_mš
;

607 
¢d_pcm_säames_t
 
avaabË
;

612 
avaabË
 = 
	`¢d_pcm_ava_upd©e
(
pcm
);

613 ià(
avaabË
 < 0)

616 ià((
¢d_pcm_uäames_t
)
avaabË
 >ğ
pcm
->
ava_mš
)

622 
Ãeded_¦ave_ava_mš
 = 
pcm
->
ava_mš
 - 
avaabË
;

628 ià(
cÚv
)

629 
Ãeded_¦ave_ava_mš
 = 
	`cÚv
(
pcm
,‚eeded_slave_avail_min);

631 ià(
¦ave
->
ava_mš
 !ğ
Ãeded_¦ave_ava_mš
) {

632 
¢d_pcm_sw_·¿ms_t
 *
sw·¿ms
;

633 
	`¢d_pcm_sw_·¿ms_®loÿ
(&
sw·¿ms
);

638 
	`¢d_pcm_sw_·¿ms_cu¼’t
(
¦ave
, 
sw·¿ms
);

645 
sw·¿ms
->
ava_mš
 = 
Ãeded_¦ave_ava_mš
;

646 
	`¢d_pcm_sw_·¿ms
(
¦ave
, 
sw·¿ms
);

648 
ava
 = 
avaabË
;

650  
	`¢d_pcm_g’”ic_may_wa™_fÜ_ava_mš
(
pcm
, 
ava
);

651 
	}
}

653 
	$¢d_pcm_¶ugš_may_wa™_fÜ_ava_mš
(
¢d_pcm_t
 *
pcm
,

654 
¢d_pcm_uäames_t
 
ava
)

656  
	`¢d_pcm_¶ugš_may_wa™_fÜ_ava_mš_cÚv
(
pcm
, 
ava
, 
NULL
);

657 
	}
}

659 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_¶ugš_ç¡_İs
 = {

660 .
¡©us
 = 
¢d_pcm_¶ugš_¡©us
,

661 .
	g¡©e
 = 
¢d_pcm_g’”ic_¡©e
,

662 .
	ghwsync
 = 
¢d_pcm_g’”ic_hwsync
,

663 .
	gd–ay
 = 
¢d_pcm_¶ugš_d–ay
,

664 .
	g´•¬e
 = 
¢d_pcm_¶ugš_´•¬e
,

665 .
	g»£t
 = 
¢d_pcm_¶ugš_»£t
,

666 .
	g¡¬t
 = 
¢d_pcm_g’”ic_¡¬t
,

667 .
	gdrİ
 = 
¢d_pcm_g’”ic_drİ
,

668 .
	gd¿š
 = 
¢d_pcm_g’”ic_d¿š
,

669 .
	g·u£
 = 
¢d_pcm_g’”ic_·u£
,

670 .
	g»wšdabË
 = 
¢d_pcm_¶ugš_»wšdabË
,

671 .
	g»wšd
 = 
¢d_pcm_¶ugš_»wšd
,

672 .
	gfÜw¬dabË
 = 
¢d_pcm_¶ugš_fÜw¬dabË
,

673 .
	gfÜw¬d
 = 
¢d_pcm_¶ugš_fÜw¬d
,

674 .
	g»sume
 = 
¢d_pcm_g’”ic_»sume
,

675 .
	glšk
 = 
¢d_pcm_g’”ic_lšk
,

676 .
	glšk_¦aves
 = 
¢d_pcm_g’”ic_lšk_¦aves
,

677 .
	guÆšk
 = 
¢d_pcm_g’”ic_uÆšk
,

678 .
	gwr™ei
 = 
¢d_pcm_¶ugš_wr™ei
,

679 .
	gwr™’
 = 
¢d_pcm_¶ugš_wr™’
,

680 .
	g»adi
 = 
¢d_pcm_¶ugš_»adi
,

681 .
	g»adn
 = 
¢d_pcm_¶ugš_»adn
,

682 .
	gava_upd©e
 = 
¢d_pcm_¶ugš_ava_upd©e
,

683 .
	gmm­_comm™
 = 
¢d_pcm_¶ugš_mm­_comm™
,

684 .
	ghtime¡amp
 = 
¢d_pcm_g’”ic_htime¡amp
,

685 .
	gpŞl_desütÜs_couÁ
 = 
¢d_pcm_g’”ic_pŞl_desütÜs_couÁ
,

686 .
	gpŞl_desütÜs
 = 
¢d_pcm_g’”ic_pŞl_desütÜs
,

687 .
	gpŞl_»v’ts
 = 
¢d_pcm_g’”ic_pŞl_»v’ts
,

688 .
	gmay_wa™_fÜ_ava_mš
 = 
¢d_pcm_¶ugš_may_wa™_fÜ_ava_mš
,

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_plugin.h

22 
	~"pcm_g’”ic.h
"

24 
	$¢d_pcm_uäames_t
 (*
	t¢d_pcm_¦ave_xãr_¬—s_func_t
)

25 (
	t¢d_pcm_t
 *
	tpcm
,

26 cÚ¡ 
	t¢d_pcm_chªÃl_¬—_t
 *
	t¬—s
,

27 
	t¢d_pcm_uäames_t
 
	toff£t
,

28 
	t¢d_pcm_uäames_t
 
	tsize
,

29 cÚ¡ 
	t¢d_pcm_chªÃl_¬—_t
 *
	t¦ave_¬—s
,

30 
	t¢d_pcm_uäames_t
 
	t¦ave_off£t
,

31 
	t¢d_pcm_uäames_t
 *
	t¦ave_siz•
);

33 
	$¢d_pcm_säames_t
 (*
	t¢d_pcm_¦ave_xãr_¬—s_undo_func_t
)

34 (
	t¢d_pcm_t
 *
	tpcm
,

35 cÚ¡ 
	t¢d_pcm_chªÃl_¬—_t
 *
	t»s_¬—s
,

36 
	t¢d_pcm_uäames_t
 
	t»s_off£t
,

37 
	t¢d_pcm_uäames_t
 
	t»s_size
,

38 
	t¢d_pcm_uäames_t
 
	t¦ave_undo_size
);

41 
¢d_pcm_g’”ic_t
 
g’
;

42 
¢d_pcm_¦ave_xãr_¬—s_func_t
 
»ad
;

43 
¢d_pcm_¦ave_xãr_¬—s_func_t
 
wr™e
;

44 
¢d_pcm_¦ave_xãr_¬—s_undo_func_t
 
undo_»ad
;

45 
¢d_pcm_¦ave_xãr_¬—s_undo_func_t
 
undo_wr™e
;

46 (*
š™
)(
¢d_pcm_t
 *
pcm
);

47 
¢d_pcm_uäames_t
 
­¶_±r
, 
hw_±r
;

48 } 
	t¢d_pcm_¶ugš_t
;

51 
	#¢d_pcm_¶ugš_š™
 \

52 
¢d1_pcm_¶ugš_š™


	)

53 
	#¢d_pcm_¶ugš_may_wa™_fÜ_ava_mš_cÚv
 \

54 
¢d1_pcm_¶ugš_may_wa™_fÜ_ava_mš_cÚv


	)

55 
	#¢d_pcm_¶ugš_may_wa™_fÜ_ava_mš
 \

56 
¢d1_pcm_¶ugš_may_wa™_fÜ_ava_mš


	)

57 
	#¢d_pcm_¶ugš_ç¡_İs
 \

58 
¢d1_pcm_¶ugš_ç¡_İs


	)

59 
	#¢d_pcm_¶ugš_undo_»ad_g’”ic
 \

60 
¢d1_pcm_¶ugš_undo_»ad_g’”ic


	)

61 
	#¢d_pcm_¶ugš_undo_wr™e_g’”ic
 \

62 
¢d1_pcm_¶ugš_undo_wr™e_g’”ic


	)

63 
	#¢d_pcm_¶ugš_»wšd
 \

64 
¢d1_pcm_¶ugš_»wšd


	)

65 
	#¢d_pcm_¶ugš_fÜw¬d
 \

66 
¢d1_pcm_¶ugš_fÜw¬d


	)

68 
	`¢d_pcm_¶ugš_š™
(
¢d_pcm_¶ugš_t
 *
¶ugš
);

69 
¢d_pcm_säames_t
 
	`¢d_pcm_¶ugš_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
);

70 
¢d_pcm_säames_t
 
	`¢d_pcm_¶ugš_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
);

71 
	`¢d_pcm_¶ugš_may_wa™_fÜ_ava_mš_cÚv
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
ava
,

72 
	$¢d_pcm_uäames_t
 (*
cÚv
)(
¢d_pcm_t
 *, 
¢d_pcm_uäames_t
));

73 
	`¢d_pcm_¶ugš_may_wa™_fÜ_ava_mš
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
ava
);

75 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
¢d_pcm_¶ugš_ç¡_İs
;

77 
¢d_pcm_säames_t
 
¢d_pcm_¶ugš_undo_»ad_g’”ic


78 (
¢d_pcm_t
 *
pcm
,

79 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
»s_¬—s
,

80 
¢d_pcm_uäames_t
 
»s_off£t
,

81 
¢d_pcm_uäames_t
 
»s_size
,

82 
¢d_pcm_uäames_t
 
¦ave_undo_size
);

84 
¢d_pcm_säames_t
 
¢d_pcm_¶ugš_undo_wr™e_g’”ic


85 (
¢d_pcm_t
 *
pcm
,

86 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
»s_¬—s
,

87 
¢d_pcm_uäames_t
 
»s_off£t
,

88 
¢d_pcm_uäames_t
 
»s_size
,

89 
¢d_pcm_uäames_t
 
¦ave_undo_size
);

92 
	#¢d_pcm_lš—r_g‘_šdex
 
¢d1_pcm_lš—r_g‘_šdex


	)

93 
	#¢d_pcm_lš—r_put_šdex
 
¢d1_pcm_lš—r_put_šdex


	)

94 
	#¢d_pcm_lš—r_cÚv”t_šdex
 
¢d1_pcm_lš—r_cÚv”t_šdex


	)

95 
	#¢d_pcm_lš—r_cÚv”t
 
¢d1_pcm_lš—r_cÚv”t


	)

96 
	#¢d_pcm_lš—r_g‘put
 
¢d1_pcm_lš—r_g‘put


	)

97 
	#¢d_pcm_®aw_decode
 
¢d1_pcm_®aw_decode


	)

98 
	#¢d_pcm_®aw_’code
 
¢d1_pcm_®aw_’code


	)

99 
	#¢d_pcm_muÏw_decode
 
¢d1_pcm_muÏw_decode


	)

100 
	#¢d_pcm_muÏw_’code
 
¢d1_pcm_muÏw_’code


	)

101 
	#¢d_pcm_adpcm_decode
 
¢d1_pcm_adpcm_decode


	)

102 
	#¢d_pcm_adpcm_’code
 
¢d1_pcm_adpcm_’code


	)

104 
	`¢d_pcm_lš—r_g‘_šdex
(
¢d_pcm_fÜm©_t
 
¤c_fÜm©
, snd_pcm_fÜm©_ˆ
d¡_fÜm©
);

105 
	`¢d_pcm_lš—r_put_šdex
(
¢d_pcm_fÜm©_t
 
¤c_fÜm©
, snd_pcm_fÜm©_ˆ
d¡_fÜm©
);

106 
	`¢d_pcm_lš—r_cÚv”t_šdex
(
¢d_pcm_fÜm©_t
 
¤c_fÜm©
, snd_pcm_fÜm©_ˆ
d¡_fÜm©
);

108 
	`¢d_pcm_lš—r_cÚv”t
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
, 
¢d_pcm_uäames_t
 
d¡_off£t
,

109 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
, 
¢d_pcm_uäames_t
 
¤c_off£t
,

110 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

111 
cÚvidx
);

112 
	`¢d_pcm_lš—r_g‘put
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
, 
¢d_pcm_uäames_t
 
d¡_off£t
,

113 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
, 
¢d_pcm_uäames_t
 
¤c_off£t
,

114 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

115 
g‘_idx
, 
put_idx
);

116 
	`¢d_pcm_®aw_decode
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

117 
¢d_pcm_uäames_t
 
d¡_off£t
,

118 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

119 
¢d_pcm_uäames_t
 
¤c_off£t
,

120 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

121 
putidx
);

122 
	`¢d_pcm_®aw_’code
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

123 
¢d_pcm_uäames_t
 
d¡_off£t
,

124 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

125 
¢d_pcm_uäames_t
 
¤c_off£t
,

126 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

127 
g‘idx
);

128 
	`¢d_pcm_muÏw_decode
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

129 
¢d_pcm_uäames_t
 
d¡_off£t
,

130 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

131 
¢d_pcm_uäames_t
 
¤c_off£t
,

132 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

133 
putidx
);

134 
	`¢d_pcm_muÏw_’code
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

135 
¢d_pcm_uäames_t
 
d¡_off£t
,

136 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

137 
¢d_pcm_uäames_t
 
¤c_off£t
,

138 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

139 
g‘idx
);

141 
	s_¢d_pcm_adpcm_¡©e
 {

142 
´ed_v®
;

143 
¡•_idx
;

144 } 
	t¢d_pcm_adpcm_¡©e_t
;

146 
	`¢d_pcm_adpcm_decode
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

147 
¢d_pcm_uäames_t
 
d¡_off£t
,

148 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

149 
¢d_pcm_uäames_t
 
¤c_off£t
,

150 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

151 
putidx
,

152 
¢d_pcm_adpcm_¡©e_t
 *
¡©es
);

153 
	`¢d_pcm_adpcm_’code
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

154 
¢d_pcm_uäames_t
 
d¡_off£t
,

155 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

156 
¢d_pcm_uäames_t
 
¤c_off£t
,

157 
chªÃls
, 
¢d_pcm_uäames_t
 
äames
,

158 
g‘idx
,

159 
¢d_pcm_adpcm_¡©e_t
 *
¡©es
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_rate.c

30 
	~"pcm_loÿl.h
"

31 
	~"pcm_¶ugš.h
"

32 
	~"pcm_¿‹.h
"

33 
	~"¶ugš_İs.h
"

34 
	~"bsw­.h
"

35 
	~<š‰y³s.h
>

38 
	#DEBUG_REFINE


	)

41 #iâdeà
PIC


43 cÚ¡ *
	g_¢d_moduË_pcm_¿‹
 = "";

46 #iâdeà
DOC_HIDDEN


48 
_¢d_pcm_¿‹
 
	t¢d_pcm_¿‹_t
;

50 
	s_¢d_pcm_¿‹
 {

51 
¢d_pcm_g’”ic_t
 
	mg’
;

52 
¢d_pcm_uäames_t
 
	m­¶_±r
, 
	mhw_±r
, 
	mÏ¡_¦ave_hw_±r
;

53 
¢d_pcm_uäames_t
 
	mÏ¡_comm™_±r
;

54 
¢d_pcm_uäames_t
 
	mÜig_ava_mš
;

55 
¢d_pcm_sw_·¿ms_t
 
	msw_·¿ms
;

56 
¢d_pcm_fÜm©_t
 
	msfÜm©
;

57 
	m¤©e
;

58 
¢d_pcm_chªÃl_¬—_t
 *
	m·»as
;

59 
¢d_pcm_chªÃl_¬—_t
 *
	m§»as
;

60 
¢d_pcm_¿‹_šfo_t
 
	mšfo
;

61 *
	mİ’_func
;

62 *
	mobj
;

63 
¢d_pcm_¿‹_İs_t
 
	mİs
;

64 
	m¤c_cÚv_idx
;

65 
	md¡_cÚv_idx
;

66 
¢d_pcm_chªÃl_¬—_t
 *
	m¤c_buf
;

67 
¢d_pcm_chªÃl_¬—_t
 *
	md¡_buf
;

68 
	m¡¬t_³ndšg
;

69 
¢d_htime¡amp_t
 
	mŒigg”_t¡amp
;

70 
	m¶ugš_v”siÚ
;

71 
	m¿‹_mš
, 
	m¿‹_max
;

72 
¢d_pcm_fÜm©_t
 
	mÜig_š_fÜm©
;

73 
¢d_pcm_fÜm©_t
 
	mÜig_out_fÜm©
;

74 
ušt64_t
 
	mš_fÜm©s
;

75 
ušt64_t
 
	mout_fÜm©s
;

76 
	mfÜm©_æags
;

79 
	#SND_PCM_RATE_PLUGIN_VERSION_OLD
 0x010001

	)

83 
¢d_pcm_chªÃl_¬—_t
 *

84 
	$¿‹_®loc_tmp_buf
(
¢d_pcm_fÜm©_t
 
fÜm©
,

85 
chªÃls
, 
äames
)

87 
¢d_pcm_chªÃl_¬—_t
 *
­
;

88 
width
 = 
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
);

89 
i
;

91 
­
 = 
	`m®loc
((*­è* 
chªÃls
);

92 ià(!
­
)

93  
NULL
;

94 
­
->
addr
 = 
	`m®loc
(
äames
 * 
chªÃls
 * 
width
 / 8);

95 ià(!
­
->
addr
) {

96 
	`ä“
(
­
);

97  
NULL
;

101 
i
 = 0; i < 
chªÃls
; i++) {

102 
­
[
i
].
addr
 =‡p[0].add¸+ (˜* 
width
) / 8;

103 
­
[
i
].
fœ¡
 = 0;

104 
­
[
i
].
¡•
 = 
width
 * 
chªÃls
;

107  
­
;

108 
	}
}

110 
	$¿‹_ä“_tmp_buf
(
¢d_pcm_chªÃl_¬—_t
 **
±r
)

112 
¢d_pcm_chªÃl_¬—_t
 *
c
 = *
±r
;

114 ià(
c
) {

115 
	`ä“
(
c
->
addr
);

116 
	`ä“
(
c
);

117 *
±r
 = 
NULL
;

119 
	}
}

121 
	$¢d_pcm_¿‹_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

123 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

124 
”r
;

125 
¢d_pcm_acûss_mask_t
 
acûss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

126 
¢d_pcm_fÜm©_mask_t
 
fÜm©_mask
 = { 
SND_PCM_FMTBIT_LINEAR
 };

127 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

128 &
acûss_mask
);

129 ià(
”r
 < 0)

130  
”r
;

131 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
,

132 &
fÜm©_mask
);

133 ià(
”r
 < 0)

134  
”r
;

135 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
·¿ms
, 
SND_PCM_SUBFORMAT_STD
);

136 ià(
”r
 < 0)

137  
”r
;

138 ià(
¿‹
->
¿‹_mš
) {

139 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
,

140 
¿‹
->
¿‹_mš
, 0);

141 ià(
”r
 < 0)

142  
”r
;

144 ià(
¿‹
->
¿‹_max
) {

145 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_max
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
,

146 
¿‹
->
¿‹_max
, 0);

147 ià(
”r
 < 0)

148  
”r
;

150 
·¿ms
->
šfo
 &ğ~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

152 
	}
}

154 
	$¢d_pcm_¿‹_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

156 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

157 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

158 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

159 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

160 &
§cûss_mask
);

161 ià(
¿‹
->
sfÜm©
 !ğ
SND_PCM_FORMAT_UNKNOWN
) {

162 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
¥¬ams
, 
¿‹
->
sfÜm©
);

163 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¥¬ams
, 
SND_PCM_SUBFORMAT_STD
);

165 
	`_¢d_pcm_hw_·¿m_£t_mšmax
(
¥¬ams
, 
SND_PCM_HW_PARAM_RATE
,

166 
¿‹
->
¤©e
, 0,„ate->srate + 1, -1);

168 
	}
}

170 
	$¢d_pcm_¿‹_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

171 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

173 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

174 
¢d_š‹rv®_t
 
t
, 
bufãr_size
;

175 cÚ¡ 
¢d_š‹rv®_t
 *
¤©e
, *
ü©e
;

176 
”r
;

177 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

178 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

179 
SND_PCM_HW_PARBIT_TICK_TIME
);

180 ià(
¿‹
->
sfÜm©
 =ğ
SND_PCM_FORMAT_UNKNOWN
)

181 
lšks
 |ğ(
SND_PCM_HW_PARBIT_FORMAT
 |

182 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

183 
SND_PCM_HW_PARBIT_SAMPLE_BITS
 |

184 
SND_PCM_HW_PARBIT_FRAME_BITS
);

185 
	`¢d_š‹rv®_cİy
(&
bufãr_size
, 
	`¢d_pcm_hw_·¿m_g‘_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
));

186 
	`¢d_š‹rv®_unæoÜ
(&
bufãr_size
);

187 
ü©e
 = 
	`¢d_pcm_hw_·¿m_g‘_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
);

188 
¤©e
 = 
	`¢d_pcm_hw_·¿m_g‘_š‹rv®
(
¥¬ams
, 
SND_PCM_HW_PARAM_RATE
);

189 
	`¢d_š‹rv®_muldiv
(&
bufãr_size
, 
¤©e
, 
ü©e
, &
t
);

190 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_š‹rv®
(
¥¬ams
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
t
);

191 ià(
”r
 < 0)

192  
”r
;

193 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

194 ià(
”r
 < 0)

195  
”r
;

197 
	}
}

199 
	$¢d_pcm_¿‹_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

200 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

202 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

203 
¢d_š‹rv®_t
 
t
;

204 #ifdeà
DEBUG_REFINE


205 
¢d_ouut_t
 *
out
;

207 cÚ¡ 
¢d_š‹rv®_t
 *
sbufãr_size
, *
bufãr_size
;

208 cÚ¡ 
¢d_š‹rv®_t
 *
¤©e
, *
ü©e
;

209 
”r
;

210 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

211 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

212 
SND_PCM_HW_PARBIT_TICK_TIME
);

213 ià(
¿‹
->
sfÜm©
 =ğ
SND_PCM_FORMAT_UNKNOWN
)

214 
lšks
 |ğ(
SND_PCM_HW_PARBIT_FORMAT
 |

215 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

216 
SND_PCM_HW_PARBIT_SAMPLE_BITS
 |

217 
SND_PCM_HW_PARBIT_FRAME_BITS
);

218 
sbufãr_size
 = 
	`¢d_pcm_hw_·¿m_g‘_š‹rv®
(
¥¬ams
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
);

219 
ü©e
 = 
	`¢d_pcm_hw_·¿m_g‘_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
);

220 
¤©e
 = 
	`¢d_pcm_hw_·¿m_g‘_š‹rv®
(
¥¬ams
, 
SND_PCM_HW_PARAM_RATE
);

221 
	`¢d_š‹rv®_muldiv
(
sbufãr_size
, 
ü©e
, 
¤©e
, &
t
);

222 
	`¢d_š‹rv®_æoÜ
(&
t
);

223 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
t
);

224 ià(
”r
 < 0)

225  
”r
;

226 
bufãr_size
 = 
	`¢d_pcm_hw_·¿m_g‘_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
);

233 ià(
	`¢d_š‹rv®_sšgË
(
bufãr_size
è&& bufãr_size->
š‹g”
) {

234 
¢d_š‹rv®_t
 *
³riod_size
;

235 
³riod_size
 = (
¢d_š‹rv®_t
 *)
	`¢d_pcm_hw_·¿m_g‘_š‹rv®
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
);

236 ià(!
	`¢d_š‹rv®_checkem±y
(
³riod_size
) &&

237 
³riod_size
->
İ’mš
 &&…”iod_size->
İ’max
 &&

238 
³riod_size
->
mš
 + 1 =ğ³riod_size->
max
) {

239 ià(
³riod_size
->
mš
 > 0 && (
bufãr_size
->min /…eriod_size->min) *…eriod_size->min == buffer_size->min) {

240 
	`¢d_š‹rv®_£t_v®ue
(
³riod_size
,…”iod_size->
mš
);

241 } ià((
bufãr_size
->
max
 / 
³riod_size
->max) *…eriod_size->max == buffer_size->max) {

242 
	`¢d_š‹rv®_£t_v®ue
(
³riod_size
,…”iod_size->
max
);

246 #ifdeà
DEBUG_REFINE


247 
	`¢d_ouut_¡dio_©ch
(&
out
, 
¡d”r
, 0);

248 
	`¢d_ouut_´štf
(
out
, "REFINE (params):\n");

249 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
out
);

250 
	`¢d_ouut_´štf
(
out
, "REFINE (slave…arams):\n");

251 
	`¢d_pcm_hw_·¿ms_dump
(
¥¬ams
, 
out
);

252 
	`¢d_ouut_şo£
(
out
);

254 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

255 #ifdeà
DEBUG_REFINE


256 
	`¢d_ouut_¡dio_©ch
(&
out
, 
¡d”r
, 0);

257 
	`¢d_ouut_´štf
(
out
, "********************\n");

258 
	`¢d_ouut_´štf
(
out
, "REFINE (·¿msè(%i):\n", 
”r
);

259 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
out
);

260 
	`¢d_ouut_´štf
(
out
, "REFINE (slave…arams):\n");

261 
	`¢d_pcm_hw_·¿ms_dump
(
¥¬ams
, 
out
);

262 
	`¢d_ouut_şo£
(
out
);

264 ià(
”r
 < 0)

265  
”r
;

267 
	}
}

269 
	$¢d_pcm_¿‹_hw_»fše
(
¢d_pcm_t
 *
pcm
,

270 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

272  
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

273 
¢d_pcm_¿‹_hw_»fše_ı»·»
,

274 
¢d_pcm_¿‹_hw_»fše_cchªge
,

275 
¢d_pcm_¿‹_hw_»fše_¥»·»
,

276 
¢d_pcm_¿‹_hw_»fše_schªge
,

277 
¢d_pcm_g’”ic_hw_»fše
);

278 
	}
}

281 
	$g‘_be¡_fÜm©
(
ušt64_t
 
mask
, 
¢d_pcm_fÜm©_t
 
Üig
)

283 
pwidth
 = 
	`¢d_pcm_fÜm©_physiÿl_width
(
Üig
);

284 
width
 = 
	`¢d_pcm_fÜm©_width
(
Üig
);

285 
signd
 = 
	`¢d_pcm_fÜm©_sigÃd
(
Üig
);

286 
be¡_scÜe
 = -1;

287 
m©ch
 = -1;

288 
f
, 
scÜe
;

290 
f
 = 0; f <ğ
SND_PCM_FORMAT_LAST
; f++) {

291 ià(!(
mask
 & (1ULL << 
f
)))

293 
scÜe
 = 0;

294 ià(
	`¢d_pcm_fÜm©_lš—r
(
f
)) {

295 ià(
	`¢d_pcm_fÜm©_physiÿl_width
(
f
è=ğ
pwidth
)

296 
scÜe
++;

297 ià(
	`¢d_pcm_fÜm©_physiÿl_width
(
f
è>ğ
pwidth
)

298 
scÜe
++;

299 ià(
	`¢d_pcm_fÜm©_width
(
f
è=ğ
width
)

300 
scÜe
++;

301 ià(
	`¢d_pcm_fÜm©_sigÃd
(
f
è=ğ
signd
)

302 
scÜe
++;

304 ià(
scÜe
 > 
be¡_scÜe
) {

305 
m©ch
 = 
f
;

306 
be¡_scÜe
 = 
scÜe
;

310  
m©ch
;

311 
	}
}

314 
	$choo£_´eã¼ed_fÜm©
(
¢d_pcm_¿‹_t
 *
¿‹
)

316 
ušt64_t
 
š_mask
 = 
¿‹
->
š_fÜm©s
;

317 
ušt64_t
 
out_mask
 = 
¿‹
->
out_fÜm©s
;

318 
š
, 
out
;

320 ià(!
š_mask
 || !
out_mask
)

323 ià(
¿‹
->
Üig_š_fÜm©
 =ğ¿‹->
Üig_out_fÜm©
)

324 ià(
š_mask
 & 
out_mask
 & (1ULL << 
¿‹
->
Üig_š_fÜm©
))

327 
»³©
:

328 
š
 = 
	`g‘_be¡_fÜm©
(
š_mask
, 
¿‹
->
Üig_š_fÜm©
);

329 
out
 = 
	`g‘_be¡_fÜm©
(
out_mask
, 
¿‹
->
Üig_out_fÜm©
);

330 ià(
š
 < 0 || 
out
 < 0)

331  -
ENOENT
;

333 ià((
¿‹
->
fÜm©_æags
 & 
SND_PCM_RATE_FLAG_SYNC_FORMATS
) &&

334 
š
 !ğ
out
) {

335 ià(
out_mask
 & (1ULL << 
š
))

336 
out
 = 
š
;

337 ià(
š_mask
 & (1ULL << 
out
))

338 
š
 = 
out
;

340 
š_mask
 &ğ~(1ULL << 
š
);

341 
out_mask
 &ğ~(1ULL << 
out
);

342 
»³©
;

346 
¿‹
->
šfo
.
š
.
fÜm©
 = in;

347 
¿‹
->
šfo
.
out
.
fÜm©
 = out;

349 
	}
}

351 
	$¢d_pcm_¿‹_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 * 
·¿ms
)

353 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

354 
¢d_pcm_t
 *
¦ave
 = 
¿‹
->
g’
.slave;

355 
¢d_pcm_¿‹_side_šfo_t
 *
sšfo
, *
cšfo
;

356 
chªÃls
, 
acc
;

357 
Ãed_¤c_buf
, 
Ãed_d¡_buf
;

358 
”r
 = 
	`¢d_pcm_hw_·¿ms_¦ave
(
pcm
, 
·¿ms
,

359 
¢d_pcm_¿‹_hw_»fše_cchªge
,

360 
¢d_pcm_¿‹_hw_»fše_¥»·»
,

361 
¢d_pcm_¿‹_hw_»fše_schªge
,

362 
¢d_pcm_g’”ic_hw_·¿ms
);

363 ià(
”r
 < 0)

364  
”r
;

366 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

367 
cšfo
 = &
¿‹
->
šfo
.
š
;

368 
sšfo
 = &
¿‹
->
šfo
.
out
;

370 
sšfo
 = &
¿‹
->
šfo
.
š
;

371 
cšfo
 = &
¿‹
->
šfo
.
out
;

373 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(
·¿ms
, &
cšfo
->
fÜm©
);

374 ià(
”r
 < 0)

375  
”r
;

376 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_¿‹
)(
·¿ms
, &
cšfo
->
¿‹
, 0);

377 ià(
”r
 < 0)

378  
”r
;

379 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_size
)(
·¿ms
, &
cšfo
->
³riod_size
, 0);

380 ià(
”r
 < 0)

381  
”r
;

382 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_bufãr_size
)(
·¿ms
, &
cšfo
->
bufãr_size
);

383 ià(
”r
 < 0)

384  
”r
;

385 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_chªÃls
)(
·¿ms
, &
chªÃls
);

386 ià(
”r
 < 0)

387  
”r
;

388 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_acûss
)(
·¿ms
, &
acc
);

389 ià(
”r
 < 0)

390  
”r
;

392 
¿‹
->
šfo
.
chªÃls
 = channels;

393 
sšfo
->
fÜm©
 = 
¦ave
->format;

394 
sšfo
->
¿‹
 = 
¦ave
->rate;

395 
sšfo
->
bufãr_size
 = 
¦ave
->buffer_size;

396 
sšfo
->
³riod_size
 = 
¦ave
->period_size;

398 ià(
	`CHECK_SANITY
(
¿‹
->
·»as
)) {

399 
	`SNDMSG
("rate…lugin‡lready in use");

400  -
EBUSY
;

403 
¿‹
->
·»as
 = 
	`¿‹_®loc_tmp_buf
(
cšfo
->
fÜm©
, 
chªÃls
,

404 
cšfo
->
³riod_size
);

405 
¿‹
->
§»as
 = 
	`¿‹_®loc_tmp_buf
(
sšfo
->
fÜm©
, 
chªÃls
,

406 
sšfo
->
³riod_size
);

407 ià(!
¿‹
->
·»as
 || !¿‹->
§»as
) {

408 
”r
 = -
ENOMEM
;

409 
”rÜ_·»as
;

412 
¿‹
->
Üig_š_fÜm©
 =„©e->
šfo
.
š
.
fÜm©
;

413 
¿‹
->
Üig_out_fÜm©
 =„©e->
šfo
.
out
.
fÜm©
;

414 ià(
	`choo£_´eã¼ed_fÜm©
(
¿‹
) < 0) {

415 
	`SNDERR
("No matching format in„ate…lugin");

416 
”r
 = -
EINVAL
;

417 
”rÜ_·»as
;

420 
”r
 = 
¿‹
->
İs
.
	`š™
Ô©e->
obj
, &¿‹->
šfo
);

421 ià(
”r
 < 0)

422 
”rÜ_š™
;

424 
	`¿‹_ä“_tmp_buf
(&
¿‹
->
¤c_buf
);

425 
	`¿‹_ä“_tmp_buf
(&
¿‹
->
d¡_buf
);

427 
Ãed_¤c_buf
 = 
Ãed_d¡_buf
 = 0;

429 ià((
¿‹
->
fÜm©_æags
 & 
SND_PCM_RATE_FLAG_INTERLEAVED
) &&

430 !(
acc
 =ğ
SND_PCM_ACCESS_MMAP_INTERLEAVED
 ||

431 
acc
 =ğ
SND_PCM_ACCESS_RW_INTERLEAVED
)) {

432 
Ãed_¤c_buf
 = 
Ãed_d¡_buf
 = 1;

434 ià(
¿‹
->
Üig_š_fÜm©
 !ğ¿‹->
šfo
.
š
.
fÜm©
)

435 
Ãed_¤c_buf
 = 1;

436 ià(
¿‹
->
Üig_out_fÜm©
 !ğ¿‹->
šfo
.
out
.
fÜm©
)

437 
Ãed_d¡_buf
 = 1;

440 ià(
Ãed_¤c_buf
) {

441 
¿‹
->
¤c_cÚv_idx
 =

442 
	`¢d_pcm_lš—r_cÚv”t_šdex
(
¿‹
->
Üig_š_fÜm©
,

443 
¿‹
->
šfo
.
š
.
fÜm©
);

444 
¿‹
->
¤c_buf
 = 
	`¿‹_®loc_tmp_buf
Ô©e->
šfo
.
š
.
fÜm©
,

445 
chªÃls
, 
¿‹
->
šfo
.
š
.
³riod_size
);

446 ià(!
¿‹
->
¤c_buf
) {

447 
”r
 = -
ENOMEM
;

448 
”rÜ
;

452 ià(
Ãed_d¡_buf
) {

453 
¿‹
->
d¡_cÚv_idx
 =

454 
	`¢d_pcm_lš—r_cÚv”t_šdex
(
¿‹
->
šfo
.
out
.
fÜm©
,

455 
¿‹
->
Üig_out_fÜm©
);

456 
¿‹
->
d¡_buf
 = 
	`¿‹_®loc_tmp_buf
Ô©e->
šfo
.
out
.
fÜm©
,

457 
chªÃls
, 
¿‹
->
šfo
.
out
.
³riod_size
);

458 ià(!
¿‹
->
d¡_buf
) {

459 
”r
 = -
ENOMEM
;

460 
”rÜ
;

466 
”rÜ
:

467 
	`¿‹_ä“_tmp_buf
(&
¿‹
->
¤c_buf
);

468 
	`¿‹_ä“_tmp_buf
(&
¿‹
->
d¡_buf
);

469 
”rÜ_š™
:

470 ià(
¿‹
->
İs
.
ä“
)

471 
¿‹
->
İs
.
	`ä“
Ô©e->
obj
);

472 
”rÜ_·»as
:

473 
	`¿‹_ä“_tmp_buf
(&
¿‹
->
·»as
);

474 
	`¿‹_ä“_tmp_buf
(&
¿‹
->
§»as
);

475  
”r
;

476 
	}
}

478 
	$¢d_pcm_¿‹_hw_ä“
(
¢d_pcm_t
 *
pcm
)

480 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

482 
	`¿‹_ä“_tmp_buf
(&
¿‹
->
·»as
);

483 
	`¿‹_ä“_tmp_buf
(&
¿‹
->
§»as
);

484 ià(
¿‹
->
İs
.
ä“
)

485 
¿‹
->
İs
.
	`ä“
Ô©e->
obj
);

486 
	`¿‹_ä“_tmp_buf
(&
¿‹
->
¤c_buf
);

487 
	`¿‹_ä“_tmp_buf
(&
¿‹
->
d¡_buf
);

488  
	`¢d_pcm_hw_ä“
(
¿‹
->
g’
.
¦ave
);

489 
	}
}

491 
	$»ÿlc
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 *
v®
)

493 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

494 
¢d_pcm_t
 *
¦ave
 = 
¿‹
->
g’
.slave;

495 
div
;

497 ià(*
v®
 =ğ
pcm
->
bufãr_size
) {

498 *
v®
 = 
¦ave
->
bufãr_size
;

500 
div
 = *
v®
 / 
pcm
->
³riod_size
;

501 ià(
div
 * 
pcm
->
³riod_size
 =ğ*
v®
)

502 *
v®
 = 
div
 * 
¦ave
->
³riod_size
;

504 *
v®
 = 
	`muldiv_Ã¬
(*v®, 
¦ave
->
³riod_size
, 
pcm
->period_size);

506 
	}
}

508 
	$¢d_pcm_¿‹_sw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 * 
·¿ms
)

510 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

511 
¢d_pcm_t
 *
¦ave
 = 
¿‹
->
g’
.slave;

512 
¢d_pcm_sw_·¿ms_t
 *
¥¬ams
;

513 
¢d_pcm_uäames_t
 
bound¬y1
, 
bound¬y2
, 
sbound¬y
;

514 
”r
;

516 
¥¬ams
 = &
¿‹
->
sw_·¿ms
;

517 
”r
 = 
	`¢d_pcm_sw_·¿ms_cu¼’t
(
¦ave
, 
¥¬ams
);

518 ià(
”r
 < 0)

519  
”r
;

520 
sbound¬y
 = 
¥¬ams
->
bound¬y
;

521 *
¥¬ams
 = *
·¿ms
;

522 
bound¬y1
 = 
pcm
->
bufãr_size
;

523 
bound¬y2
 = 
¦ave
->
bufãr_size
;

524 
bound¬y1
 * 2 <ğ
LONG_MAX
 - 
pcm
->
bufãr_size
 &&

525 
bound¬y2
 * 2 <ğ
LONG_MAX
 - 
¦ave
->
bufãr_size
) {

526 
bound¬y1
 *= 2;

527 
bound¬y2
 *= 2;

529 
·¿ms
->
bound¬y
 = 
bound¬y1
;

530 
¥¬ams
->
bound¬y
 = 
sbound¬y
;

532 ià(
¿‹
->
İs
.
adju¡_p™ch
)

533 
¿‹
->
İs
.
	`adju¡_p™ch
Ô©e->
obj
, &¿‹->
šfo
);

535 
	`»ÿlc
(
pcm
, &
¥¬ams
->
ava_mš
);

536 
¿‹
->
Üig_ava_mš
 = 
¥¬ams
->
ava_mš
;

537 
	`»ÿlc
(
pcm
, &
¥¬ams
->
¡¬t_th»shŞd
);

538 ià(
¥¬ams
->
ava_mš
 < 1) sparams->avail_min = 1;

539 ià(
¥¬ams
->
¡¬t_th»shŞd
 <ğ
¦ave
->
bufãr_size
) {

540 ià(
¥¬ams
->
¡¬t_th»shŞd
 > (
¦ave
->
bufãr_size
 / s·¿ms->
ava_mš
) * sparams->avail_min)

541 
¥¬ams
->
¡¬t_th»shŞd
 = (
¦ave
->
bufãr_size
 / s·¿ms->
ava_mš
) * sparams->avail_min;

543 ià(
¥¬ams
->
¡İ_th»shŞd
 >ğ
·¿ms
->
bound¬y
) {

544 
¥¬ams
->
¡İ_th»shŞd
 = s·¿ms->
bound¬y
;

546 
	`»ÿlc
(
pcm
, &
¥¬ams
->
¡İ_th»shŞd
);

548 
	`»ÿlc
(
pcm
, &
¥¬ams
->
s’û_th»shŞd
);

549 ià(
¥¬ams
->
s’û_size
 >ğ
·¿ms
->
bound¬y
) {

550 
¥¬ams
->
s’û_size
 = s·¿ms->
bound¬y
;

552 
	`»ÿlc
(
pcm
, &
¥¬ams
->
s’û_size
);

554  
	`¢d_pcm_sw_·¿ms
(
¦ave
, 
¥¬ams
);

555 
	}
}

557 
	$¢d_pcm_¿‹_š™
(
¢d_pcm_t
 *
pcm
)

559 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

561 ià(
¿‹
->
İs
.
»£t
)

562 
¿‹
->
İs
.
	`»£t
Ô©e->
obj
);

563 
¿‹
->
Ï¡_comm™_±r
 = 0;

564 
¿‹
->
¡¬t_³ndšg
 = 0;

566 
	}
}

568 
	$do_cÚv”t
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

569 
¢d_pcm_uäames_t
 
d¡_off£t
, 
d¡_äames
,

570 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

571 
¢d_pcm_uäames_t
 
¤c_off£t
, 
¤c_äames
,

572 
chªÃls
,

573 
¢d_pcm_¿‹_t
 *
¿‹
)

575 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
out_¬—s
;

576 
¢d_pcm_uäames_t
 
out_off£t
;

578 ià(
¿‹
->
d¡_buf
) {

579 
out_¬—s
 = 
¿‹
->
d¡_buf
;

580 
out_off£t
 = 0;

582 
out_¬—s
 = 
d¡_¬—s
;

583 
out_off£t
 = 
d¡_off£t
;

586 ià(
¿‹
->
¤c_buf
) {

587 
	`¢d_pcm_lš—r_cÚv”t
(
¿‹
->
¤c_buf
, 0,

588 
¤c_¬—s
, 
¤c_off£t
,

589 
chªÃls
, 
¤c_äames
,

590 
¿‹
->
¤c_cÚv_idx
);

591 
¤c_¬—s
 = 
¿‹
->
¤c_buf
;

592 
¤c_off£t
 = 0;

595 ià(
¿‹
->
İs
.
cÚv”t
)

596 
¿‹
->
İs
.
	`cÚv”t
Ô©e->
obj
, 
out_¬—s
, 
out_off£t
, 
d¡_äames
,

597 
¤c_¬—s
, 
¤c_off£t
, 
¤c_äames
);

599 
¿‹
->
İs
.
	`cÚv”t_s16
Ô©e->
obj
,

600 
	`¢d_pcm_chªÃl_¬—_addr
(
out_¬—s
, 
out_off£t
),

601 
d¡_äames
,

602 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—s
, 
¤c_off£t
),

603 
¤c_äames
);

604 ià(
¿‹
->
d¡_buf
)

605 
	`¢d_pcm_lš—r_cÚv”t
(
d¡_¬—s
, 
d¡_off£t
,

606 
¿‹
->
d¡_buf
, 0,

607 
chªÃls
, 
d¡_äames
,

608 
¿‹
->
d¡_cÚv_idx
);

609 
	}
}

611 
šlše
 

612 
	$¢d_pcm_¿‹_wr™e_¬—s1
(
¢d_pcm_t
 *
pcm
,

613 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

614 
¢d_pcm_uäames_t
 
off£t
,

615 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

616 
¢d_pcm_uäames_t
 
¦ave_off£t
)

618 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

619 
	`do_cÚv”t
(
¦ave_¬—s
, 
¦ave_off£t
, 
¿‹
->
g’
.
¦ave
->
³riod_size
,

620 
¬—s
, 
off£t
, 
pcm
->
³riod_size
,

621 
pcm
->
chªÃls
, 
¿‹
);

622 
	}
}

624 
šlše
 

625 
	$¢d_pcm_¿‹_»ad_¬—s1
(
¢d_pcm_t
 *
pcm
,

626 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

627 
¢d_pcm_uäames_t
 
off£t
,

628 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

629 
¢d_pcm_uäames_t
 
¦ave_off£t
)

631 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

632 
	`do_cÚv”t
(
¬—s
, 
off£t
, 
pcm
->
³riod_size
,

633 
¦ave_¬—s
, 
¦ave_off£t
, 
¿‹
->
g’
.
¦ave
->
³riod_size
,

634 
pcm
->
chªÃls
, 
¿‹
);

635 
	}
}

637 
šlše
 
	$¢d_pcm_¿‹_sync_hw±r0
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
¦ave_hw_±r
)

639 
¢d_pcm_¿‹_t
 *
¿‹
;

640 
¢d_pcm_säames_t
 
¦ave_hw_±r_diff
;

641 
¢d_pcm_säames_t
 
Ï¡_¦ave_hw_±r_äac
;

643 ià(
pcm
->
¡»am
 !ğ
SND_PCM_STREAM_PLAYBACK
)

646 
¿‹
 = 
pcm
->
´iv©e_d©a
;

647 
¦ave_hw_±r_diff
 = 
	`pcm_äame_diff
(
¦ave_hw_±r
, 
¿‹
->
Ï¡_¦ave_hw_±r
,„©e->
g’
.
¦ave
->
bound¬y
);

648 ià(
¦ave_hw_±r_diff
 == 0)

650 
Ï¡_¦ave_hw_±r_äac
 = 
¿‹
->
Ï¡_¦ave_hw_±r
 %„©e->
g’
.
¦ave
->
³riod_size
;

660 
¿‹
->
hw_±r
 += (

661 (((
Ï¡_¦ave_hw_±r_äac
 + 
¦ave_hw_±r_diff
è/ 
¿‹
->
g’
.
¦ave
->
³riod_size
è* 
pcm
->period_size) -

662 
¿‹
->
İs
.
	`šput_äames
Ô©e->
obj
, 
Ï¡_¦ave_hw_±r_äac
) +

663 
¿‹
->
İs
.
	`šput_äames
Ô©e->
obj
, (
Ï¡_¦ave_hw_±r_äac
 + 
¦ave_hw_±r_diff
è%„©e->
g’
.
¦ave
->
³riod_size
));

664 
¿‹
->
Ï¡_¦ave_hw_±r
 = 
¦ave_hw_±r
;

666 
¿‹
->
hw_±r
 %ğ
pcm
->
bound¬y
;

667 
	}
}

669 
šlše
 
	$¢d_pcm_¿‹_sync_hw±r
(
¢d_pcm_t
 *
pcm
)

671 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

672 
	`¢d_pcm_¿‹_sync_hw±r0
(
pcm
, *
¿‹
->
g’
.
¦ave
->
hw
.
±r
);

673 
	}
}

675 
	$¢d_pcm_¿‹_hwsync
(
¢d_pcm_t
 *
pcm
)

677 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

678 
”r
 = 
	`¢d_pcm_hwsync
(
¿‹
->
g’
.
¦ave
);

679 ià(
”r
 < 0)

680  
”r
;

681 
	`¢d_pcm_¿‹_sync_hw±r
(
pcm
);

683 
	}
}

685 
¢d_pcm_uäames_t
 
	$¢d_pcm_¿‹_¶ayback_š‹º®_d–ay
(
¢d_pcm_t
 *
pcm
)

687 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

689  
	`pcm_äame_diff
(
¿‹
->
­¶_±r
,„©e->
Ï¡_comm™_±r
, 
pcm
->
bound¬y
);

690 
	}
}

692 
	$¢d_pcm_¿‹_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
)

694 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

695 
¢d_pcm_säames_t
 
¦ave_d–ay
;

696 
”r
;

698 
	`¢d_pcm_¿‹_hwsync
(
pcm
);

700 
”r
 = 
	`¢d_pcm_d–ay
(
¿‹
->
g’
.
¦ave
, &
¦ave_d–ay
);

701 ià(
”r
 < 0) {

702  
”r
;

705 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

706 *
d–ayp
 = 
¿‹
->
İs
.
	`šput_äames
Ô©e->
obj
, 
¦ave_d–ay
)

707 + 
	`¢d_pcm_¿‹_¶ayback_š‹º®_d–ay
(
pcm
);

709 *
d–ayp
 = 
¿‹
->
İs
.
	`ouut_äames
Ô©e->
obj
, 
¦ave_d–ay
)

710 + 
	`¢d_pcm_mm­_ÿ±u»_d–ay
(
pcm
);

713 
	}
}

715 
	$¢d_pcm_¿‹_´•¬e
(
¢d_pcm_t
 *
pcm
)

717 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

718 
”r
;

720 
”r
 = 
	`¢d_pcm_´•¬e
(
¿‹
->
g’
.
¦ave
);

721 ià(
”r
 < 0)

722  
”r
;

723 *
pcm
->
hw
.
±r
 = 0;

724 *
pcm
->
­¶
.
±r
 = 0;

725 
¿‹
->
Ï¡_¦ave_hw_±r
 = 0;

726 
”r
 = 
	`¢d_pcm_¿‹_š™
(
pcm
);

727 ià(
”r
 < 0)

728  
”r
;

730 
	}
}

732 
	$¢d_pcm_¿‹_»£t
(
¢d_pcm_t
 *
pcm
)

734 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

735 
”r
;

736 
”r
 = 
	`¢d_pcm_»£t
(
¿‹
->
g’
.
¦ave
);

737 ià(
”r
 < 0)

738  
”r
;

739 *
pcm
->
hw
.
±r
 = 0;

740 *
pcm
->
­¶
.
±r
 = 0;

741 
¿‹
->
Ï¡_¦ave_hw_±r
 = 0;

742 
”r
 = 
	`¢d_pcm_¿‹_š™
(
pcm
);

743 ià(
”r
 < 0)

744  
”r
;

746 
	}
}

748 
¢d_pcm_säames_t
 
	$¢d_pcm_¿‹_»wšdabË
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

751 
	}
}

753 
¢d_pcm_säames_t
 
	$¢d_pcm_¿‹_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

756 
	}
}

758 
¢d_pcm_säames_t
 
	$¢d_pcm_¿‹_»wšd
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

759 
¢d_pcm_uäames_t
 
äames
 
ATTRIBUTE_UNUSED
)

762 
	}
}

764 
¢d_pcm_säames_t
 
	$¢d_pcm_¿‹_fÜw¬d
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

765 
¢d_pcm_uäames_t
 
äames
 
ATTRIBUTE_UNUSED
)

768 
	}
}

770 
	$¢d_pcm_¿‹_comm™_¬—
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¿‹_t
 *
¿‹
,

771 
¢d_pcm_uäames_t
 
­¶_off£t
,

772 
¢d_pcm_uäames_t
 
size
 
ATTRIBUTE_UNUSED
,

773 
¢d_pcm_uäames_t
 
¦ave_size
)

775 
¢d_pcm_uäames_t
 
cÚt
 = 
pcm
->
bufãr_size
 - 
­¶_off£t
;

776 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
;

777 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
;

778 
¢d_pcm_uäames_t
 
¦ave_off£t
, 
xãr
;

779 
¢d_pcm_uäames_t
 
¦ave_äames
 = 
ULONG_MAX
;

780 
¢d_pcm_säames_t
 
»suÉ
;

782 
¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

787 ià(
cÚt
 >ğ
pcm
->
³riod_size
) {

788 
»suÉ
 = 
	`¢d_pcm_mm­_begš
(
¿‹
->
g’
.
¦ave
, &
¦ave_¬—s
, &
¦ave_off£t
, &
¦ave_äames
);

789 ià(
»suÉ
 < 0)

790  
»suÉ
;

795 ià(
¦ave_äames
 < 
¿‹
->
g’
.
¦ave
->
³riod_size
) {

796 
	`¢d_pcm_¿‹_wr™e_¬—s1
(
pcm
, 
¬—s
, 
­¶_off£t
, 
¿‹
->
§»as
, 0);

797 
__·¹Ÿl
;

799 
	`¢d_pcm_¿‹_wr™e_¬—s1
(
pcm
, 
¬—s
, 
­¶_off£t
,

800 
¦ave_¬—s
, 
¦ave_off£t
);

802 
»suÉ
 = 
	`¢d_pcm_mm­_comm™
(
¿‹
->
g’
.
¦ave
, 
¦ave_off£t
, 
¦ave_size
);

803 ià(
»suÉ
 < (
¢d_pcm_säames_t
)
¦ave_size
) {

804 ià(
»suÉ
 < 0)

805  
»suÉ
;

806 
»suÉ
 = 
	`¢d_pcm_»wšd
(
¿‹
->
g’
.
¦ave
,„esult);

807 ià(
»suÉ
 < 0)

808  
»suÉ
;

812 
	`¢d_pcm_¬—s_cİy
(
¿‹
->
·»as
, 0,

813 
¬—s
, 
­¶_off£t
,

814 
pcm
->
chªÃls
, 
cÚt
,

815 
pcm
->
fÜm©
);

816 
	`¢d_pcm_¬—s_cİy
(
¿‹
->
·»as
, 
cÚt
,

817 
¬—s
, 0,

818 
pcm
->
chªÃls
,…cm->
³riod_size
 - 
cÚt
,

819 
pcm
->
fÜm©
);

821 
	`¢d_pcm_¿‹_wr™e_¬—s1
(
pcm
, 
¿‹
->
·»as
, 0,„©e->
§»as
, 0);

824 
»suÉ
 = 
	`¢d_pcm_mm­_begš
(
¿‹
->
g’
.
¦ave
, &
¦ave_¬—s
, &
¦ave_off£t
, &
¦ave_äames
);

825 ià(
»suÉ
 < 0)

826  
»suÉ
;

827 
__·¹Ÿl
:

828 
cÚt
 = 
¦ave_äames
;

829 ià(
cÚt
 > 
¦ave_size
)

830 
cÚt
 = 
¦ave_size
;

831 
	`¢d_pcm_¬—s_cİy
(
¦ave_¬—s
, 
¦ave_off£t
,

832 
¿‹
->
§»as
, 0,

833 
pcm
->
chªÃls
, 
cÚt
,

834 
¿‹
->
g’
.
¦ave
->
fÜm©
);

835 
»suÉ
 = 
	`¢d_pcm_mm­_comm™
(
¿‹
->
g’
.
¦ave
, 
¦ave_off£t
, 
cÚt
);

836 ià(
»suÉ
 < (
¢d_pcm_säames_t
)
cÚt
) {

837 ià(
»suÉ
 < 0)

838  
»suÉ
;

839 
»suÉ
 = 
	`¢d_pcm_»wšd
(
¿‹
->
g’
.
¦ave
,„esult);

840 ià(
»suÉ
 < 0)

841  
»suÉ
;

844 
xãr
 = 
cÚt
;

846 ià(
xãr
 =ğ
¦ave_size
)

847 
comm™_dÚe
;

850 
cÚt
 = 
¦ave_size
 - cont;

851 
¦ave_äames
 = 
cÚt
;

852 
»suÉ
 = 
	`¢d_pcm_mm­_begš
(
¿‹
->
g’
.
¦ave
, &
¦ave_¬—s
, &
¦ave_off£t
, &
¦ave_äames
);

853 ià(
»suÉ
 < 0)

854  
»suÉ
;

856 ià(
¦ave_off£t
) {

857 
	`SNDERR
("nÚ-z”Ø¦ave_off£ˆ%ld", 
¦ave_off£t
);

858  -
EIO
;

861 
	`¢d_pcm_¬—s_cİy
(
¦ave_¬—s
, 
¦ave_off£t
,

862 
¿‹
->
§»as
, 
xãr
,

863 
pcm
->
chªÃls
, 
cÚt
,

864 
¿‹
->
g’
.
¦ave
->
fÜm©
);

865 
»suÉ
 = 
	`¢d_pcm_mm­_comm™
(
¿‹
->
g’
.
¦ave
, 
¦ave_off£t
, 
cÚt
);

866 ià(
»suÉ
 < (
¢d_pcm_säames_t
)
cÚt
) {

867 ià(
»suÉ
 < 0)

868  
»suÉ
;

869 
»suÉ
 = 
	`¢d_pcm_»wšd
(
¿‹
->
g’
.
¦ave
,„esuÉ + 
xãr
);

870 ià(
»suÉ
 < 0)

871  
»suÉ
;

876 
comm™_dÚe
:

877 ià(
¿‹
->
¡¬t_³ndšg
) {

879 
	`¢d_pcm_¡¬t
(
¿‹
->
g’
.
¦ave
);

880 
¿‹
->
¡¬t_³ndšg
 = 0;

883 
	}
}

885 
	$¢d_pcm_¿‹_comm™_Ãxt_³riod
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
­¶_off£t
)

887 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

889  
	`¢d_pcm_¿‹_comm™_¬—
(
pcm
, 
¿‹
, 
­¶_off£t
,…cm->
³riod_size
,

890 
¿‹
->
g’
.
¦ave
->
³riod_size
);

891 
	}
}

893 
	$¢d_pcm_¿‹_g¿b_Ãxt_³riod
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
hw_off£t
)

895 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

896 
¢d_pcm_uäames_t
 
cÚt
 = 
pcm
->
bufãr_size
 - 
hw_off£t
;

897 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
;

898 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
;

899 
¢d_pcm_uäames_t
 
¦ave_off£t
, 
xãr
;

900 
¢d_pcm_uäames_t
 
¦ave_äames
 = 
ULONG_MAX
;

901 
¢d_pcm_säames_t
 
»suÉ
;

903 
¬—s
 = 
	`¢d_pcm_mm­_¬—s
(
pcm
);

904 ià(
cÚt
 >ğ
pcm
->
³riod_size
) {

905 
»suÉ
 = 
	`¢d_pcm_mm­_begš
(
¿‹
->
g’
.
¦ave
, &
¦ave_¬—s
, &
¦ave_off£t
, &
¦ave_äames
);

906 ià(
»suÉ
 < 0)

907  
»suÉ
;

908 ià(
¦ave_äames
 < 
¿‹
->
g’
.
¦ave
->
³riod_size
)

909 
__·¹Ÿl
;

910 
	`¢d_pcm_¿‹_»ad_¬—s1
(
pcm
, 
¬—s
, 
hw_off£t
,

911 
¦ave_¬—s
, 
¦ave_off£t
);

912 
»suÉ
 = 
	`¢d_pcm_mm­_comm™
(
¿‹
->
g’
.
¦ave
, 
¦ave_off£t
,„©e->g’.¦ave->
³riod_size
);

913 ià(
»suÉ
 < (
¢d_pcm_säames_t
)
¿‹
->
g’
.
¦ave
->
³riod_size
) {

914 ià(
»suÉ
 < 0)

915  
»suÉ
;

916 
»suÉ
 = 
	`¢d_pcm_»wšd
(
¿‹
->
g’
.
¦ave
,„esult);

917 ià(
»suÉ
 < 0)

918  
»suÉ
;

923 
»suÉ
 = 
	`¢d_pcm_mm­_begš
(
¿‹
->
g’
.
¦ave
, &
¦ave_¬—s
, &
¦ave_off£t
, &
¦ave_äames
);

924 ià(
»suÉ
 < 0)

925  
»suÉ
;

926 
__·¹Ÿl
:

927 
cÚt
 = 
¦ave_äames
;

928 ià(
cÚt
 > 
¿‹
->
g’
.
¦ave
->
³riod_size
)

929 
cÚt
 = 
¿‹
->
g’
.
¦ave
->
³riod_size
;

930 
	`¢d_pcm_¬—s_cİy
(
¿‹
->
§»as
, 0,

931 
¦ave_¬—s
, 
¦ave_off£t
,

932 
pcm
->
chªÃls
, 
cÚt
,

933 
¿‹
->
g’
.
¦ave
->
fÜm©
);

934 
»suÉ
 = 
	`¢d_pcm_mm­_comm™
(
¿‹
->
g’
.
¦ave
, 
¦ave_off£t
, 
cÚt
);

935 ià(
»suÉ
 < (
¢d_pcm_säames_t
)
cÚt
) {

936 ià(
»suÉ
 < 0)

937  
»suÉ
;

938 
»suÉ
 = 
	`¢d_pcm_»wšd
(
¿‹
->
g’
.
¦ave
,„esult);

939 ià(
»suÉ
 < 0)

940  
»suÉ
;

943 
xãr
 = 
cÚt
;

945 ià(
xãr
 =ğ
¿‹
->
g’
.
¦ave
->
³riod_size
)

946 
__Œªsãr
;

949 
cÚt
 = 
¿‹
->
g’
.
¦ave
->
³riod_size
 - cont;

950 
¦ave_äames
 = 
cÚt
;

951 
»suÉ
 = 
	`¢d_pcm_mm­_begš
(
¿‹
->
g’
.
¦ave
, &
¦ave_¬—s
, &
¦ave_off£t
, &
¦ave_äames
);

952 ià(
»suÉ
 < 0)

953  
»suÉ
;

955 ià(
¦ave_off£t
) {

956 
	`SNDERR
("nÚ-z”Ø¦ave_off£ˆ%ld", 
¦ave_off£t
);

957  -
EIO
;

960 
	`¢d_pcm_¬—s_cİy
(
¿‹
->
§»as
, 
xãr
,

961 
¦ave_¬—s
, 
¦ave_off£t
,

962 
pcm
->
chªÃls
, 
cÚt
,

963 
¿‹
->
g’
.
¦ave
->
fÜm©
);

964 
»suÉ
 = 
	`¢d_pcm_mm­_comm™
(
¿‹
->
g’
.
¦ave
, 
¦ave_off£t
, 
cÚt
);

965 ià(
»suÉ
 < (
¢d_pcm_säames_t
)
cÚt
) {

966 ià(
»suÉ
 < 0)

967  
»suÉ
;

968 
»suÉ
 = 
	`¢d_pcm_»wšd
(
¿‹
->
g’
.
¦ave
,„esuÉ + 
xãr
);

969 ià(
»suÉ
 < 0)

970  
»suÉ
;

974 
__Œªsãr
:

975 
cÚt
 = 
pcm
->
bufãr_size
 - 
hw_off£t
;

976 ià(
cÚt
 >ğ
pcm
->
³riod_size
) {

977 
	`¢d_pcm_¿‹_»ad_¬—s1
(
pcm
, 
¬—s
, 
hw_off£t
,

978 
¿‹
->
§»as
, 0);

980 
	`¢d_pcm_¿‹_»ad_¬—s1
(
pcm
,

981 
¿‹
->
·»as
, 0,

982 
¿‹
->
§»as
, 0);

983 
	`¢d_pcm_¬—s_cİy
(
¬—s
, 
hw_off£t
,

984 
¿‹
->
·»as
, 0,

985 
pcm
->
chªÃls
, 
cÚt
,

986 
pcm
->
fÜm©
);

987 
	`¢d_pcm_¬—s_cİy
(
¬—s
, 0,

988 
¿‹
->
·»as
, 
cÚt
,

989 
pcm
->
chªÃls
,…cm->
³riod_size
 - 
cÚt
,

990 
pcm
->
fÜm©
);

994 
	}
}

996 
	$¢d_pcm_¿‹_sync_¶ayback_¬—
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
­¶_±r
)

998 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

999 
¢d_pcm_t
 *
¦ave
 = 
¿‹
->
g’
.slave;

1000 
¢d_pcm_uäames_t
 
xãr
;

1001 
¢d_pcm_säames_t
 
¦ave_size
;

1002 
”r
;

1004 
¦ave_size
 = 
	`¢d_pcm_ava_upd©e
(
¦ave
);

1005 ià(
¦ave_size
 < 0)

1006  
¦ave_size
;

1008 
xãr
 = 
	`pcm_äame_diff
(
­¶_±r
, 
¿‹
->
Ï¡_comm™_±r
, 
pcm
->
bound¬y
);

1009 
xãr
 >ğ
pcm
->
³riod_size
 &&

1010 (
¢d_pcm_uäames_t
)
¦ave_size
 >ğ
¿‹
->
g’
.
¦ave
->
³riod_size
) {

1011 
”r
 = 
	`¢d_pcm_¿‹_comm™_Ãxt_³riod
(
pcm
, 
¿‹
->
Ï¡_comm™_±r
 %…cm->
bufãr_size
);

1012 ià(
”r
 == 0)

1014 ià(
”r
 < 0)

1015  
”r
;

1016 
xãr
 -ğ
pcm
->
³riod_size
;

1017 
¦ave_size
 -ğ
¿‹
->
g’
.
¦ave
->
³riod_size
;

1018 
¿‹
->
Ï¡_comm™_±r
 +ğ
pcm
->
³riod_size
;

1019 ià(
¿‹
->
Ï¡_comm™_±r
 >ğ
pcm
->
bound¬y
)

1020 
¿‹
->
Ï¡_comm™_±r
 -ğ
pcm
->
bound¬y
;

1023 
	}
}

1025 
¢d_pcm_säames_t
 
	$¢d_pcm_¿‹_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

1026 
¢d_pcm_uäames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

1027 
¢d_pcm_uäames_t
 
size
)

1029 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

1030 
”r
;

1032 ià(
size
 == 0)

1034 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

1035 
”r
 = 
	`¢d_pcm_¿‹_sync_¶ayback_¬—
(
pcm
, 
¿‹
->
­¶_±r
 + 
size
);

1036 ià(
”r
 < 0)

1037  
”r
;

1039 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
size
);

1040  
size
;

1041 
	}
}

1043 
¢d_pcm_säames_t
 
	$¢d_pcm_¿‹_ava_upd©e_ÿ±u»
(
¢d_pcm_t
 *
pcm
,

1044 
¢d_pcm_säames_t
 
¦ave_size
)

1046 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

1047 
¢d_pcm_t
 *
¦ave
 = 
¿‹
->
g’
.slave;

1048 
¢d_pcm_uäames_t
 
xãr
, 
hw_off£t
, 
size
;

1050 
xãr
 = 
	`¢d_pcm_mm­_ÿ±u»_ava
(
pcm
);

1051 
size
 = 
pcm
->
bufãr_size
 - 
xãr
;

1052 
hw_off£t
 = 
	`¢d_pcm_mm­_hw_off£t
(
pcm
);

1053 
size
 >ğ
pcm
->
³riod_size
 &&

1054 (
¢d_pcm_uäames_t
)
¦ave_size
 >ğ
¦ave
->
³riod_size
) {

1055 
”r
 = 
	`¢d_pcm_¿‹_g¿b_Ãxt_³riod
(
pcm
, 
hw_off£t
);

1056 ià(
”r
 < 0)

1057  
”r
;

1058 ià(
”r
 == 0)

1059  (
¢d_pcm_säames_t
)
xãr
;

1060 
xãr
 +ğ
pcm
->
³riod_size
;

1061 
size
 -ğ
pcm
->
³riod_size
;

1062 
¦ave_size
 -ğ
¦ave
->
³riod_size
;

1063 
hw_off£t
 +ğ
pcm
->
³riod_size
;

1064 
hw_off£t
 %ğ
pcm
->
bufãr_size
;

1065 
	`¢d_pcm_mm­_hw_fÜw¬d
(
pcm
,…cm->
³riod_size
);

1067  (
¢d_pcm_säames_t
)
xãr
;

1068 
	}
}

1070 
¢d_pcm_säames_t
 
	$¢d_pcm_¿‹_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

1072 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

1073 
¢d_pcm_säames_t
 
¦ave_size
;

1075 
¦ave_size
 = 
	`¢d_pcm_ava_upd©e
(
¿‹
->
g’
.
¦ave
);

1076 ià(
¦ave_size
 < 0)

1077  
¦ave_size
;

1079 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
)

1080  
	`¢d_pcm_¿‹_ava_upd©e_ÿ±u»
(
pcm
, 
¦ave_size
);

1082 
	`¢d_pcm_¿‹_sync_hw±r
(
pcm
);

1083 
	`¢d_pcm_¿‹_sync_¶ayback_¬—
(
pcm
, 
¿‹
->
­¶_±r
);

1084  
	`¢d_pcm_mm­_ava
(
pcm
);

1085 
	}
}

1087 
	$¢d_pcm_¿‹_htime¡amp
(
¢d_pcm_t
 *
pcm
,

1088 
¢d_pcm_uäames_t
 *
ava
,

1089 
¢d_htime¡amp_t
 *
t¡amp
)

1091 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

1092 
¢d_pcm_säames_t
 
ava1
;

1093 
¢d_pcm_uäames_t
 
tmp
;

1094 
ok
 = 0, 
”r
;

1098 
ava1
 = 
	`¢d_pcm_ava_upd©e
(
pcm
);

1099 ià(
ava1
 < 0)

1100  
ava1
;

1101 ià(
ok
 && (
¢d_pcm_uäames_t
)
ava1
 =ğ*
ava
)

1103 *
ava
 = 
ava1
;

1105 
”r
 = 
	`¢d_pcm_htime¡amp
(
¿‹
->
g’
.
¦ave
, &
tmp
, 
t¡amp
);

1106 ià(
”r
 < 0)

1107  
”r
;

1108 
ok
 = 1;

1111 
	}
}

1113 
	$¢d_pcm_¿‹_pŞl_»v’ts
(
¢d_pcm_t
 *
pcm
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

1115 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

1116 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

1118 
	`¢d_pcm_¿‹_hwsync
(
pcm
);

1119 
	`¢d_pcm_¿‹_sync_¶ayback_¬—
(
pcm
, 
¿‹
->
­¶_±r
);

1121  
	`¢d_pcm_pŞl_desütÜs_»v’ts
(
¿‹
->
g’
.
¦ave
, 
pfds
, 
nfds
, 
»v’ts
);

1122 
	}
}

1125 
	$¢d_pcm_¿‹_d¿š
(
¢d_pcm_t
 *
pcm
)

1127 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

1129 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

1131 
¢d_pcm_uäames_t
 
size
, 
ofs
, 
§ved_ava_mš
;

1132 
¢d_pcm_sw_·¿ms_t
 
sw_·¿ms
;

1133 
comm™_”r
 = 0;

1135 
	`__¢d_pcm_lock
(
pcm
);

1137 
sw_·¿ms
 = 
¿‹
->sw_params;

1138 
§ved_ava_mš
 = 
sw_·¿ms
.
ava_mš
;

1139 
sw_·¿ms
.
ava_mš
 = 1;

1140 
	`¢d_pcm_sw_·¿ms
(
¿‹
->
g’
.
¦ave
, &
sw_·¿ms
);

1142 
size
 = 
	`pcm_äame_diff
(
¿‹
->
­¶_±r
,„©e->
Ï¡_comm™_±r
, 
pcm
->
bound¬y
);

1143 
ofs
 = 
¿‹
->
Ï¡_comm™_±r
 % 
pcm
->
bufãr_size
;

1144 
size
 > 0) {

1145 
¢d_pcm_uäames_t
 
psize
, 
¥size
;

1146 
”r
;

1148 
”r
 = 
	`__¢d_pcm_wa™_š_lock
(
¿‹
->
g’
.
¦ave
, 
SND_PCM_WAIT_DRAIN
);

1149 ià(
”r
 < 0)

1151 ià(
size
 > 
pcm
->
³riod_size
) {

1152 
psize
 = 
pcm
->
³riod_size
;

1153 
¥size
 = 
¿‹
->
g’
.
¦ave
->
³riod_size
;

1155 
psize
 = 
size
;

1156 
¥size
 = 
¿‹
->
İs
.
	`ouut_äames
Ô©e->
obj
, 
size
);

1157 ià(! 
¥size
)

1160 
comm™_”r
 = 
	`¢d_pcm_¿‹_comm™_¬—
(
pcm
, 
¿‹
, 
ofs
,

1161 
psize
, 
¥size
);

1162 ià(
comm™_”r
 == 1) {

1163 
¿‹
->
Ï¡_comm™_±r
 +ğ
psize
;

1164 ià(
¿‹
->
Ï¡_comm™_±r
 >ğ
pcm
->
bound¬y
)

1165 
¿‹
->
Ï¡_comm™_±r
 -ğ
pcm
->
bound¬y
;

1166 } ià(
comm™_”r
 == 0) {

1167 ià(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
) {

1168 
comm™_”r
 = -
EAGAIN
;

1175 
ofs
 = (of + 
psize
è% 
pcm
->
bufãr_size
;

1176 
size
 -ğ
psize
;

1178 
sw_·¿ms
.
ava_mš
 = 
§ved_ava_mš
;

1179 
	`¢d_pcm_sw_·¿ms
(
¿‹
->
g’
.
¦ave
, &
sw_·¿ms
);

1180 
	`__¢d_pcm_uÆock
(
pcm
);

1181 ià(
comm™_”r
 < 0)

1182  
comm™_”r
;

1184  
	`¢d_pcm_d¿š
(
¿‹
->
g’
.
¦ave
);

1185 
	}
}

1187 
¢d_pcm_¡©e_t
 
	$¢d_pcm_¿‹_¡©e
(
¢d_pcm_t
 *
pcm
)

1189 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

1190 ià(
¿‹
->
¡¬t_³ndšg
)

1191  
SND_PCM_STATE_RUNNING
;

1192  
	`¢d_pcm_¡©e
(
¿‹
->
g’
.
¦ave
);

1193 
	}
}

1196 
	$¢d_pcm_¿‹_¡¬t
(
¢d_pcm_t
 *
pcm
)

1198 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

1199 
¢d_pcm_säames_t
 
ava
;

1201 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
)

1202  
	`¢d_pcm_¡¬t
(
¿‹
->
g’
.
¦ave
);

1204 ià(
	`¢d_pcm_¡©e
(
¿‹
->
g’
.
¦ave
è!ğ
SND_PCM_STATE_PREPARED
)

1205  -
EBADFD
;

1207 
	`g‘time¡amp
(&
¿‹
->
Œigg”_t¡amp
, 
pcm
->
t¡amp_ty³
);

1209 
ava
 = 
	`¢d_pcm_mm­_¶ayback_hw_ava
(
¿‹
->
g’
.
¦ave
);

1210 ià(
ava
 < 0)

1211  -
EBADFD
;

1213 ià(
ava
 == 0) {

1215 
¿‹
->
¡¬t_³ndšg
 = 1;

1218 
¿‹
->
¡¬t_³ndšg
 = 0;

1219  
	`¢d_pcm_¡¬t
(
¿‹
->
g’
.
¦ave
);

1220 
	}
}

1222 
	$¢d_pcm_¿‹_¡©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©us_t
 * 
¡©us
)

1224 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

1225 
¢d_pcm_säames_t
 
”r
;

1227 
”r
 = 
	`¢d_pcm_¡©us
(
¿‹
->
g’
.
¦ave
, 
¡©us
);

1228 ià(
”r
 < 0)

1229  
”r
;

1230 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

1231 ià(
¿‹
->
¡¬t_³ndšg
)

1232 
¡©us
->
¡©e
 = 
SND_PCM_STATE_RUNNING
;

1233 
¡©us
->
Œigg”_t¡amp
 = 
¿‹
->trigger_tstamp;

1235 
	`¢d_pcm_¿‹_sync_hw±r0
(
pcm
, 
¡©us
->
hw_±r
);

1236 
¡©us
->
­¶_±r
 = *
pcm
->
­¶
.
±r
;

1237 
¡©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

1238 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

1239 
¡©us
->
d–ay
 = 
¿‹
->
İs
.
	`šput_äames
Ô©e->
obj
, status->delay)

1240 + 
	`¢d_pcm_¿‹_¶ayback_š‹º®_d–ay
(
pcm
);

1241 
¡©us
->
ava
 = 
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
);

1242 
¡©us
->
ava_max
 = 
¿‹
->
İs
.
	`šput_äames
Ô©e->
obj
, status->avail_max);

1244 
¡©us
->
d–ay
 = 
¿‹
->
İs
.
	`ouut_äames
Ô©e->
obj
, status->delay)

1245 + 
	`¢d_pcm_mm­_ÿ±u»_d–ay
(
pcm
);

1246 
¡©us
->
ava
 = 
	`¢d_pcm_mm­_ÿ±u»_ava
(
pcm
);

1247 
¡©us
->
ava_max
 = 
¿‹
->
İs
.
	`ouut_äames
Ô©e->
obj
, status->avail_max);

1250 
	}
}

1252 
	$¢d_pcm_¿‹_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

1254 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

1255 ià(
¿‹
->
sfÜm©
 =ğ
SND_PCM_FORMAT_UNKNOWN
)

1256 
	`¢d_ouut_´štf
(
out
, "Rate conversion PCM (%d)\n",

1257 
¿‹
->
¤©e
);

1259 
	`¢d_ouut_´štf
(
out
, "Rate conversion PCM (%d, sformat=%s)\n",

1260 
¿‹
->
¤©e
,

1261 
	`¢d_pcm_fÜm©_Çme
(
¿‹
->
sfÜm©
));

1262 ià(
¿‹
->
İs
.
dump
)

1263 
¿‹
->
İs
.
	`dump
Ô©e->
obj
, 
out
);

1264 
	`¢d_ouut_´štf
(
out
, "PrÙocŞ v”siÚ: %x\n", 
¿‹
->
¶ugš_v”siÚ
);

1265 ià(
pcm
->
£tup
) {

1266 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

1267 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

1269 
	`¢d_ouut_´štf
(
out
, "Slave: ");

1270 
	`¢d_pcm_dump
(
¿‹
->
g’
.
¦ave
, 
out
);

1271 
	}
}

1273 
	$¢d_pcm_¿‹_şo£
(
¢d_pcm_t
 *
pcm
)

1275 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

1277 ià(
¿‹
->
İs
.
şo£
)

1278 
¿‹
->
İs
.
	`şo£
Ô©e->
obj
);

1279 ià(
¿‹
->
İ’_func
)

1280 
	`¢d_dlobj_ÿche_put
(
¿‹
->
İ’_func
);

1281  
	`¢d_pcm_g’”ic_şo£
(
pcm
);

1282 
	}
}

1290 
¢d_pcm_uäames_t
 
	$¢d_pcm_¿‹_¦ave_äames
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

1292 
¢d_pcm_uäames_t
 
säames
;

1293 
¢d_pcm_¿‹_t
 *
¿‹
 = 
pcm
->
´iv©e_d©a
;

1295 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

1296 
säames
 = 
¿‹
->
İs
.
	`ouut_äames
Ô©e->
obj
, 
äames
);

1298 
säames
 = 
¿‹
->
İs
.
	`šput_äames
Ô©e->
obj
, 
äames
);

1300  
säames
;

1301 
	}
}

1303 
	$¢d_pcm_¿‹_may_wa™_fÜ_ava_mš
(
¢d_pcm_t
 *
pcm
,

1304 
¢d_pcm_uäames_t
 
ava
)

1306  
	`¢d_pcm_¶ugš_may_wa™_fÜ_ava_mš_cÚv
(
pcm
, 
ava
,

1307 
¢d_pcm_¿‹_¦ave_äames
);

1308 
	}
}

1310 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_¿‹_ç¡_İs
 = {

1311 .
¡©us
 = 
¢d_pcm_¿‹_¡©us
,

1312 .
	g¡©e
 = 
¢d_pcm_¿‹_¡©e
,

1313 .
	ghwsync
 = 
¢d_pcm_¿‹_hwsync
,

1314 .
	gd–ay
 = 
¢d_pcm_¿‹_d–ay
,

1315 .
	g´•¬e
 = 
¢d_pcm_¿‹_´•¬e
,

1316 .
	g»£t
 = 
¢d_pcm_¿‹_»£t
,

1317 .
	g¡¬t
 = 
¢d_pcm_¿‹_¡¬t
,

1318 .
	gdrİ
 = 
¢d_pcm_g’”ic_drİ
,

1319 .
	gd¿š
 = 
¢d_pcm_¿‹_d¿š
,

1320 .
	g·u£
 = 
¢d_pcm_g’”ic_·u£
,

1321 .
	g»wšdabË
 = 
¢d_pcm_¿‹_»wšdabË
,

1322 .
	g»wšd
 = 
¢d_pcm_¿‹_»wšd
,

1323 .
	gfÜw¬dabË
 = 
¢d_pcm_¿‹_fÜw¬dabË
,

1324 .
	gfÜw¬d
 = 
¢d_pcm_¿‹_fÜw¬d
,

1325 .
	g»sume
 = 
¢d_pcm_g’”ic_»sume
,

1326 .
	gwr™ei
 = 
¢d_pcm_mm­_wr™ei
,

1327 .
	gwr™’
 = 
¢d_pcm_mm­_wr™’
,

1328 .
	g»adi
 = 
¢d_pcm_mm­_»adi
,

1329 .
	g»adn
 = 
¢d_pcm_mm­_»adn
,

1330 .
	gava_upd©e
 = 
¢d_pcm_¿‹_ava_upd©e
,

1331 .
	gmm­_comm™
 = 
¢d_pcm_¿‹_mm­_comm™
,

1332 .
	ghtime¡amp
 = 
¢d_pcm_¿‹_htime¡amp
,

1333 .
	gpŞl_desütÜs_couÁ
 = 
¢d_pcm_g’”ic_pŞl_desütÜs_couÁ
,

1334 .
	gpŞl_desütÜs
 = 
¢d_pcm_g’”ic_pŞl_desütÜs
,

1335 .
	gpŞl_»v’ts
 = 
¢d_pcm_¿‹_pŞl_»v’ts
,

1336 .
	gmay_wa™_fÜ_ava_mš
 = 
¢d_pcm_¿‹_may_wa™_fÜ_ava_mš
,

1339 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_¿‹_İs
 = {

1340 .
şo£
 = 
¢d_pcm_¿‹_şo£
,

1341 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

1342 .
	ghw_»fše
 = 
¢d_pcm_¿‹_hw_»fše
,

1343 .
	ghw_·¿ms
 = 
¢d_pcm_¿‹_hw_·¿ms
,

1344 .
	ghw_ä“
 = 
¢d_pcm_¿‹_hw_ä“
,

1345 .
	gsw_·¿ms
 = 
¢d_pcm_¿‹_sw_·¿ms
,

1346 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

1347 .
	gdump
 = 
¢d_pcm_¿‹_dump
,

1348 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

1349 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

1350 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

1351 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

1352 .
	gqu”y_chm­s
 = 
¢d_pcm_g’”ic_qu”y_chm­s
,

1353 .
	gg‘_chm­
 = 
¢d_pcm_g’”ic_g‘_chm­
,

1354 .
	g£t_chm­
 = 
¢d_pcm_g’”ic_£t_chm­
,

1362 cÚ¡ 
¢d_cÚfig_t
 *
	$¢d_pcm_¿‹_g‘_deçuÉ_cÚv”‹r
(
¢d_cÚfig_t
 *
roÙ
)

1364 
¢d_cÚfig_t
 *
n
;

1366 ià(
	`¢d_cÚfig_£¬ch
(
roÙ
, "deçuÉs.pcm.¿‹_cÚv”‹r", &
n
) >= 0)

1367  
n
;

1368  
NULL
;

1369 
	}
}

1371 
	$¿‹_š™Ÿl_£tup
(
¢d_pcm_¿‹_t
 *
¿‹
)

1373 ià(
¿‹
->
¶ugš_v”siÚ
 =ğ
SND_PCM_RATE_PLUGIN_VERSION
)

1374 
¿‹
->
¶ugš_v”siÚ
 =„©e->
İs
.
v”siÚ
;

1376 ià(
¿‹
->
¶ugš_v”siÚ
 >= 0x010002 &&

1377 
¿‹
->
İs
.
g‘_suµÜ‹d_¿‹s
)

1378 
¿‹
->
İs
.
	`g‘_suµÜ‹d_¿‹s
Ô©e->
obj
,

1379 &
¿‹
->
¿‹_mš
,

1380 &
¿‹
->
¿‹_max
);

1382 ià(
¿‹
->
¶ugš_v”siÚ
 >= 0x010003 &&

1383 
¿‹
->
İs
.
g‘_suµÜ‹d_fÜm©s
) {

1384 
¿‹
->
İs
.
	`g‘_suµÜ‹d_fÜm©s
Ô©e->
obj
,

1385 &
¿‹
->
š_fÜm©s
,

1386 &
¿‹
->
out_fÜm©s
,

1387 &
¿‹
->
fÜm©_æags
);

1388 } ià(!
¿‹
->
İs
.
cÚv”t
 &&„©e->İs.
cÚv”t_s16
) {

1389 
¿‹
->
š_fÜm©s
 =„©e->
out_fÜm©s
 =

1390 1ULL << 
SND_PCM_FORMAT_S16
;

1391 
¿‹
->
fÜm©_æags
 = 
SND_PCM_RATE_FLAG_INTERLEAVED
;

1393 
	}
}

1395 #ifdeà
PIC


1396 
	$is_butš_¶ugš
(cÚ¡ *
ty³
)

1398  
	`¡rcmp
(
ty³
, "linear") == 0;

1399 
	}
}

1401 cÚ¡ *cÚ¡ 
	gdeçuÉ_¿‹_¶ugšs
[] = {

1402 "¥“x¿‹", "lš—r", 
NULL


1405 
	$¿‹_İ’_func
(
¢d_pcm_¿‹_t
 *
¿‹
, cÚ¡ *
ty³
, cÚ¡ 
¢d_cÚfig_t
 *
cÚv”‹r_cÚf
, 
v”bo£
)

1407 
İ’_Çme
[64], 
İ’_cÚf_Çme
[64], 
lib_Çme
[64], *
lib
 = 
NULL
;

1408 
¢d_pcm_¿‹_İ’_func_t
 
İ’_func
;

1409 
¢d_pcm_¿‹_İ’_cÚf_func_t
 
İ’_cÚf_func
;

1410 
”r
;

1412 
	`¢´štf
(
İ’_Çme
, (İ’_Çme), "_¢d_pcm_¿‹_%s_İ’", 
ty³
);

1413 
	`¢´štf
(
İ’_cÚf_Çme
, (İ’_cÚf_Çme), "_¢d_pcm_¿‹_%s_İ’_cÚf", 
ty³
);

1414 ià(!
	`is_butš_¶ugš
(
ty³
)) {

1415 
	`¢´štf
(
lib_Çme
, (lib_name),

1416 "libasound_moduË_¿‹_%s.so", 
ty³
);

1417 
lib
 = 
lib_Çme
;

1420 
İ’_cÚf_func
 = 
	`¢d_dlobj_ÿche_g‘
(
lib
, 
İ’_cÚf_Çme
, 
NULL
, 
v”bo£
 && 
cÚv”‹r_cÚf
 != NULL);

1421 ià(
İ’_cÚf_func
) {

1422 
”r
 = 
	`İ’_cÚf_func
(
SND_PCM_RATE_PLUGIN_VERSION
,

1423 &
¿‹
->
obj
, &¿‹->
İs
, 
cÚv”‹r_cÚf
);

1424 ià(!
”r
) {

1425 
¿‹
->
İ’_func
 = 
İ’_cÚf_func
;

1428 
	`¢d_dlobj_ÿche_put
(
İ’_cÚf_func
);

1429  
”r
;

1433 
İ’_func
 = 
	`¢d_dlobj_ÿche_g‘
(
lib
, 
İ’_Çme
, 
NULL
, 
v”bo£
);

1434 ià(!
İ’_func
)

1435  -
ENOENT
;

1437 
¿‹
->
İ’_func
 = open_func;

1439 
”r
 = 
	`İ’_func
(
SND_PCM_RATE_PLUGIN_VERSION
, &
¿‹
->
obj
, &¿‹->
İs
);

1440 ià(!
”r
)

1444 
¿‹
->
¶ugš_v”siÚ
 = 
SND_PCM_RATE_PLUGIN_VERSION_OLD
;

1445 
”r
 = 
	`İ’_func
(
SND_PCM_RATE_PLUGIN_VERSION_OLD
,

1446 &
¿‹
->
obj
, &¿‹->
İs
);

1447 ià(!
”r
)

1450 
	`¢d_dlobj_ÿche_put
(
İ’_func
);

1451 
¿‹
->
İ’_func
 = 
NULL
;

1452  
”r
;

1453 
	}
}

1461 
	$is_¡ršg_¬¿y
(cÚ¡ 
¢d_cÚfig_t
 *
cÚf
)

1463 
¢d_cÚfig_™”©Ü_t
 
i
;

1465 ià(
	`¢d_cÚfig_g‘_ty³
(
cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
)

1468 
i
 = 
	`¢d_cÚfig_™”©Ü_fœ¡
(
cÚf
);

1469 ià(
i
 && i !ğ
	`¢d_cÚfig_™”©Ü_’d
(
cÚf
)) {

1470 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1471 cÚ¡ *
id
;

1472 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1474 ià(
id
 && 
	`¡rcmp
(id, "0") != 0)

1479 
	}
}

1495 
	$¢d_pcm_¿‹_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1496 
¢d_pcm_fÜm©_t
 
sfÜm©
, 
¤©e
,

1497 cÚ¡ 
¢d_cÚfig_t
 *
cÚv”‹r
,

1498 
¢d_pcm_t
 *
¦ave
, 
şo£_¦ave
)

1500 
¢d_pcm_t
 *
pcm
;

1501 
¢d_pcm_¿‹_t
 *
¿‹
;

1502 cÚ¡ *
ty³
 = 
NULL
;

1503 
”r
;

1504 #iâdeà
PIC


1505 
¢d_pcm_¿‹_İ’_func_t
 
İ’_func
;

1506 
	`SND_PCM_RATE_PLUGIN_ENTRY
(
lš—r
è(
v”siÚ
, **
objp
, 
¢d_pcm_¿‹_İs_t
 *
İs
);

1509 
	`as£¹
(
pcmp
 && 
¦ave
);

1510 ià(
sfÜm©
 !ğ
SND_PCM_FORMAT_UNKNOWN
 &&

1511 
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1)

1512  -
EINVAL
;

1513 
¿‹
 = 
	`ÿÎoc
(1, (
¢d_pcm_¿‹_t
));

1514 ià(!
¿‹
) {

1515  -
ENOMEM
;

1517 
¿‹
->
g’
.
¦ave
 = slave;

1518 
¿‹
->
g’
.
şo£_¦ave
 = close_slave;

1519 
¿‹
->
¤©e
 = srate;

1520 
¿‹
->
sfÜm©
 = sformat;

1522 
¿‹
->
¿‹_mš
 = 
SND_PCM_PLUGIN_RATE_MIN
;

1523 
¿‹
->
¿‹_max
 = 
SND_PCM_PLUGIN_RATE_MAX
;

1524 
¿‹
->
¶ugš_v”siÚ
 = 
SND_PCM_RATE_PLUGIN_VERSION
;

1526 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_RATE
, 
Çme
, 
¦ave
->
¡»am
, sÏve->
mode
);

1527 ià(
”r
 < 0) {

1528 
	`ä“
(
¿‹
);

1529  
”r
;

1532 #ifdeà
PIC


1533 
”r
 = -
ENOENT
;

1534 ià(!
cÚv”‹r
) {

1535 cÚ¡ *cÚ¡ *
ty³s
;

1536 
ty³s
 = 
deçuÉ_¿‹_¶ugšs
; *types;ypes++) {

1537 
”r
 = 
	`¿‹_İ’_func
(
¿‹
, *
ty³s
, 
NULL
, 0);

1538 ià(!
”r
) {

1539 
ty³
 = *
ty³s
;

1543 } ià(!
	`¢d_cÚfig_g‘_¡ršg
(
cÚv”‹r
, &
ty³
))

1544 
”r
 = 
	`¿‹_İ’_func
(
¿‹
, 
ty³
, 
NULL
, 1);

1545 ià(
	`is_¡ršg_¬¿y
(
cÚv”‹r
)) {

1546 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1547 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚv”‹r
) {

1548 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1549 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
ty³
) < 0)

1551 
”r
 = 
	`¿‹_İ’_func
(
¿‹
, 
ty³
, 
NULL
, 0);

1552 ià(!
”r
)

1555 } ià(
	`¢d_cÚfig_g‘_ty³
(
cÚv”‹r
è=ğ
SND_CONFIG_TYPE_COMPOUND
) {

1556 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1557 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚv”‹r
) {

1558 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1559 cÚ¡ *
id
;

1560 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1562 ià(
	`¡rcmp
(
id
, "name") != 0)

1564 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
ty³
);

1567 ià(!
ty³
) {

1568 
	`SNDERR
("No‚ame given for„ate converter");

1569 
	`¢d_pcm_ä“
(
pcm
);

1570 
	`ä“
(
¿‹
);

1571  -
EINVAL
;

1573 
”r
 = 
	`¿‹_İ’_func
(
¿‹
, 
ty³
, 
cÚv”‹r
, 1);

1575 
	`SNDERR
("Invalidype for„ate converter");

1576 
	`¢d_pcm_ä“
(
pcm
);

1577 
	`ä“
(
¿‹
);

1578  -
EINVAL
;

1580 ià(
”r
 < 0) {

1581 
	`SNDERR
("Cannot find„ate converter");

1582 
	`¢d_pcm_ä“
(
pcm
);

1583 
	`ä“
(
¿‹
);

1584  -
ENOENT
;

1587 
ty³
 = "linear";

1588 
İ’_func
 = 
	`SND_PCM_RATE_PLUGIN_ENTRY
(
lš—r
);

1589 
”r
 = 
	`İ’_func
(
SND_PCM_RATE_PLUGIN_VERSION
, &
¿‹
->
obj
, &¿‹->
İs
);

1590 ià(
”r
 < 0) {

1591 
	`¢d_pcm_ä“
(
pcm
);

1592 
	`ä“
(
¿‹
);

1593  
”r
;

1597 ià(! 
¿‹
->
İs
.
š™
 || ! (¿‹->İs.
cÚv”t
 ||„©e->İs.
cÚv”t_s16
) ||

1598 ! 
¿‹
->
İs
.
šput_äames
 || !„©e->İs.
ouut_äames
) {

1599 
	`SNDERR
("IÅrİ”„©¶ugš % š™Ÿliz©iÚ", 
ty³
);

1600 
	`¢d_pcm_ä“
(
pcm
);

1601 
	`ä“
(
¿‹
);

1602  
”r
;

1605 
	`¿‹_š™Ÿl_£tup
(
¿‹
);

1607 
pcm
->
İs
 = &
¢d_pcm_¿‹_İs
;

1608 
pcm
->
ç¡_İs
 = &
¢d_pcm_¿‹_ç¡_İs
;

1609 
pcm
->
´iv©e_d©a
 = 
¿‹
;

1610 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

1611 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

1612 
pcm
->
mm­_rw
 = 1;

1613 
pcm
->
t¡amp_ty³
 = 
¦ave
->tstamp_type;

1614 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
¿‹
->
hw_±r
, -1, 0);

1615 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
¿‹
->
­¶_±r
, -1, 0);

1616 *
pcmp
 = 
pcm
;

1619 
	}
}

1674 
	$_¢d_pcm_¿‹_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1675 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

1676 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

1678 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1679 
”r
;

1680 
¢d_pcm_t
 *
¥cm
;

1681 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

1682 
¢d_pcm_fÜm©_t
 
sfÜm©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1683 
¤©e
 = -1;

1684 cÚ¡ 
¢d_cÚfig_t
 *
cÚv”‹r
 = 
NULL
;

1686 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1687 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1688 cÚ¡ *
id
;

1689 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1691 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

1693 ià(
	`¡rcmp
(
id
, "slave") == 0) {

1694 
¦ave
 = 
n
;

1697 ià(
	`¡rcmp
(
id
, "converter") == 0) {

1698 
cÚv”‹r
 = 
n
;

1701 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

1702  -
EINVAL
;

1704 ià(!
¦ave
) {

1705 
	`SNDERR
("slave is‚ot defined");

1706  -
EINVAL
;

1709 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 2,

1710 
SND_PCM_HW_PARAM_FORMAT
, 0, &
sfÜm©
,

1711 
SND_PCM_HW_PARAM_RATE
, 
SCONF_MANDATORY
, &
¤©e
);

1712 ià(
”r
 < 0)

1713  
”r
;

1714 ià(
sfÜm©
 !ğ
SND_PCM_FORMAT_UNKNOWN
 &&

1715 
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1) {

1716 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1717 
	`SNDERR
("slave format is‚ot†inear");

1718  -
EINVAL
;

1720 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

1721 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1722 ià(
”r
 < 0)

1723  
”r
;

1724 
”r
 = 
	`¢d_pcm_¿‹_İ’
(
pcmp
, 
Çme
, 
sfÜm©
, (è
¤©e
,

1725 
cÚv”‹r
, 
¥cm
, 1);

1726 ià(
”r
 < 0)

1727 
	`¢d_pcm_şo£
(
¥cm
);

1728  
”r
;

1729 
	}
}

1730 #iâdeà
DOC_HIDDEN


1731 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_¿‹_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_rate_linear.c

23 
	~"pcm_loÿl.h
"

24 
	~"pcm_¶ugš.h
"

25 
	~"pcm_¿‹.h
"

26 
	~"¶ugš_İs.h
"

27 
	~"bsw­.h
"

28 
	~<š‰y³s.h
>

32 
	#LINEAR_DIV_SHIFT
 19

	)

33 
	#LINEAR_DIV
 (1<<
LINEAR_DIV_SHIFT
)

	)

35 
	s¿‹_lš—r
 {

36 
	mg‘_idx
;

37 
	mput_idx
;

38 
	mp™ch
;

39 
	mp™ch_shiá
;

40 
	mchªÃls
;

41 
št16_t
 *
	mŞd_§m¶e
;

42 (*
	mfunc
)(
¿‹_lš—r
 *
	m¿‹
,

43 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
	md¡_¬—s
,

44 
¢d_pcm_uäames_t
 
	md¡_off£t
, 
	md¡_äames
,

45 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
	m¤c_¬—s
,

46 
¢d_pcm_uäames_t
 
	m¤c_off£t
, 
	m¤c_äames
);

49 
¢d_pcm_uäames_t
 
	$šput_äames
(*
obj
, 
¢d_pcm_uäames_t
 
äames
)

51 
¿‹_lš—r
 *
¿‹
 = 
obj
;

52 ià(
äames
 == 0)

55  
	`muldiv_Ã¬
(
äames
, 
LINEAR_DIV
, 
¿‹
->
p™ch
);

56 
	}
}

58 
¢d_pcm_uäames_t
 
	$ouut_äames
(*
obj
, 
¢d_pcm_uäames_t
 
äames
)

60 
¿‹_lš—r
 *
¿‹
 = 
obj
;

61 ià(
äames
 == 0)

64  
	`muldiv_Ã¬
(
äames
, 
¿‹
->
p™ch
, 
LINEAR_DIV
);

65 
	}
}

67 
	$lš—r_ex·nd
(
¿‹_lš—r
 *
¿‹
,

68 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

69 
¢d_pcm_uäames_t
 
d¡_off£t
, 
d¡_äames
,

70 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

71 
¢d_pcm_uäames_t
 
¤c_off£t
, 
¤c_äames
)

73 
	#GET16_LABELS


	)

74 
	#PUT16_LABELS


	)

75 
	~"¶ugš_İs.h
"

76 #undeà
GET16_LABELS


77 #undeà
PUT16_LABELS


78 *
g‘
 = 
g‘16_Ïb–s
[
¿‹
->
g‘_idx
];

79 *
put
 = 
put16_Ïb–s
[
¿‹
->
put_idx
];

80 
g‘_th»shŞd
 = 
¿‹
->
p™ch
;

81 
chªÃl
;

82 
¤c_äames1
;

83 
d¡_äames1
;

84 
št16_t
 
§m¶e
 = 0;

85 
pos
;

87 
chªÃl
 = 0; chªÃÈ< 
¿‹
->
chªÃls
; ++channel) {

88 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

89 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

90 cÚ¡ *
¤c
;

91 *
d¡
;

92 
¤c_¡•
, 
d¡_¡•
;

93 
št16_t
 
Şd_§m¶e
 = 0;

94 
št16_t
 
Ãw_§m¶e
;

95 
Şd_weight
, 
Ãw_weight
;

96 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

97 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

98 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
);

99 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
);

100 
¤c_äames1
 = 0;

101 
d¡_äames1
 = 0;

102 
Ãw_§m¶e
 = 
¿‹
->
Şd_§m¶e
[
chªÃl
];

103 
pos
 = 
g‘_th»shŞd
;

104 
d¡_äames1
 < 
d¡_äames
) {

105 ià(
pos
 >ğ
g‘_th»shŞd
) {

106 
pos
 -ğ
g‘_th»shŞd
;

107 
Şd_§m¶e
 = 
Ãw_§m¶e
;

108 ià(
¤c_äames1
 < 
¤c_äames
) {

109 *
g‘
;

110 
	#GET16_END
 
aá”_g‘


	)

111 
	~"¶ugš_İs.h
"

112 #undeà
GET16_END


113 
aá”_g‘
:

114 
Ãw_§m¶e
 = 
§m¶e
;

117 
Ãw_weight
 = (
pos
 << (16 - 
¿‹
->
p™ch_shiá
)è/ (
g‘_th»shŞd
 >>„ate->pitch_shift);

118 
Şd_weight
 = 0x10000 - 
Ãw_weight
;

119 
§m¶e
 = (
Şd_§m¶e
 * 
Şd_weight
 + 
Ãw_§m¶e
 * 
Ãw_weight
) >> 16;

120 *
put
;

121 
	#PUT16_END
 
aá”_put


	)

122 
	~"¶ugš_İs.h
"

123 #undeà
PUT16_END


124 
aá”_put
:

125 
d¡
 +ğ
d¡_¡•
;

126 
d¡_äames1
++;

127 
pos
 +ğ
LINEAR_DIV
;

128 ià(
pos
 >ğ
g‘_th»shŞd
) {

129 
¤c
 +ğ
¤c_¡•
;

130 
¤c_äames1
++;

133 
¿‹
->
Şd_§m¶e
[
chªÃl
] = 
Ãw_§m¶e
;

135 
	}
}

138 
	$lš—r_ex·nd_s16
(
¿‹_lš—r
 *
¿‹
,

139 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

140 
¢d_pcm_uäames_t
 
d¡_off£t
, 
d¡_äames
,

141 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

142 
¢d_pcm_uäames_t
 
¤c_off£t
, 
¤c_äames
)

144 
chªÃl
;

145 
¤c_äames1
;

146 
d¡_äames1
;

147 
g‘_th»shŞd
 = 
¿‹
->
p™ch
;

148 
pos
;

150 
chªÃl
 = 0; chªÃÈ< 
¿‹
->
chªÃls
; ++channel) {

151 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

152 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

153 cÚ¡ 
št16_t
 *
¤c
;

154 
št16_t
 *
d¡
;

155 
¤c_¡•
, 
d¡_¡•
;

156 
št16_t
 
Şd_§m¶e
 = 0;

157 
št16_t
 
Ãw_§m¶e
;

158 
Şd_weight
, 
Ãw_weight
;

159 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

160 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

161 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
) >> 1;

162 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
) >> 1;

163 
¤c_äames1
 = 0;

164 
d¡_äames1
 = 0;

165 
Ãw_§m¶e
 = 
¿‹
->
Şd_§m¶e
[
chªÃl
];

166 
pos
 = 
g‘_th»shŞd
;

167 
d¡_äames1
 < 
d¡_äames
) {

168 ià(
pos
 >ğ
g‘_th»shŞd
) {

169 
pos
 -ğ
g‘_th»shŞd
;

170 
Şd_§m¶e
 = 
Ãw_§m¶e
;

171 ià(
¤c_äames1
 < 
¤c_äames
)

172 
Ãw_§m¶e
 = *
¤c
;

174 
Ãw_weight
 = (
pos
 << (16 - 
¿‹
->
p™ch_shiá
)è/ (
g‘_th»shŞd
 >>„ate->pitch_shift);

175 
Şd_weight
 = 0x10000 - 
Ãw_weight
;

176 *
d¡
 = (
Şd_§m¶e
 * 
Şd_weight
 + 
Ãw_§m¶e
 * 
Ãw_weight
) >> 16;

177 
d¡
 +ğ
d¡_¡•
;

178 
d¡_äames1
++;

179 
pos
 +ğ
LINEAR_DIV
;

180 ià(
pos
 >ğ
g‘_th»shŞd
) {

181 
¤c
 +ğ
¤c_¡•
;

182 
¤c_äames1
++;

185 
¿‹
->
Şd_§m¶e
[
chªÃl
] = 
Ãw_§m¶e
;

187 
	}
}

189 
	$lš—r_shršk
(
¿‹_lš—r
 *
¿‹
,

190 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

191 
¢d_pcm_uäames_t
 
d¡_off£t
, 
d¡_äames
,

192 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

193 
¢d_pcm_uäames_t
 
¤c_off£t
, 
¤c_äames
)

195 
	#GET16_LABELS


	)

196 
	#PUT16_LABELS


	)

197 
	~"¶ugš_İs.h
"

198 #undeà
GET16_LABELS


199 #undeà
PUT16_LABELS


200 *
g‘
 = 
g‘16_Ïb–s
[
¿‹
->
g‘_idx
];

201 *
put
 = 
put16_Ïb–s
[
¿‹
->
put_idx
];

202 
g‘_šüem’t
 = 
¿‹
->
p™ch
;

203 
chªÃl
;

204 
¤c_äames1
;

205 
d¡_äames1
;

206 
št16_t
 
§m¶e
 = 0;

207 
pos
;

209 
chªÃl
 = 0; chªÃÈ< 
¿‹
->
chªÃls
; ++channel) {

210 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

211 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

212 cÚ¡ *
¤c
;

213 *
d¡
;

214 
¤c_¡•
, 
d¡_¡•
;

215 
št16_t
 
Şd_§m¶e
 = 0;

216 
št16_t
 
Ãw_§m¶e
 = 0;

217 
Şd_weight
, 
Ãw_weight
;

218 
pos
 = 
LINEAR_DIV
 - 
g‘_šüem’t
;

219 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

220 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

221 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
);

222 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
);

223 
¤c_äames1
 = 0;

224 
d¡_äames1
 = 0;

225 
¤c_äames1
 < 
¤c_äames
) {

227 *
g‘
;

228 
	#GET16_END
 
aá”_g‘


	)

229 
	~"¶ugš_İs.h
"

230 #undeà
GET16_END


231 
aá”_g‘
:

232 
Ãw_§m¶e
 = 
§m¶e
;

233 
¤c
 +ğ
¤c_¡•
;

234 
¤c_äames1
++;

235 
pos
 +ğ
g‘_šüem’t
;

236 ià(
pos
 >ğ
LINEAR_DIV
) {

237 
pos
 -ğ
LINEAR_DIV
;

238 
Şd_weight
 = (
pos
 << (32 - 
LINEAR_DIV_SHIFT
)è/ (
g‘_šüem’t
 >> (LINEAR_DIV_SHIFT - 16));

239 
Ãw_weight
 = 0x10000 - 
Şd_weight
;

240 
§m¶e
 = (
Şd_§m¶e
 * 
Şd_weight
 + 
Ãw_§m¶e
 * 
Ãw_weight
) >> 16;

241 *
put
;

242 
	#PUT16_END
 
aá”_put


	)

243 
	~"¶ugš_İs.h
"

244 #undeà
PUT16_END


245 
aá”_put
:

246 
d¡
 +ğ
d¡_¡•
;

247 
d¡_äames1
++;

248 ià(
	`CHECK_SANITY
(
d¡_äames1
 > 
d¡_äames
)) {

249 
	`SNDERR
("dst_frames overflow");

253 
Şd_§m¶e
 = 
Ãw_§m¶e
;

256 
	}
}

259 
	$lš—r_shršk_s16
(
¿‹_lš—r
 *
¿‹
,

260 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

261 
¢d_pcm_uäames_t
 
d¡_off£t
, 
d¡_äames
,

262 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

263 
¢d_pcm_uäames_t
 
¤c_off£t
, 
¤c_äames
)

265 
g‘_šüem’t
 = 
¿‹
->
p™ch
;

266 
chªÃl
;

267 
¤c_äames1
;

268 
d¡_äames1
;

269 
pos
 = 0;

271 
chªÃl
 = 0; chªÃÈ< 
¿‹
->
chªÃls
; ++channel) {

272 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

273 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
 = &
d¡_¬—s
[
chªÃl
];

274 cÚ¡ 
št16_t
 *
¤c
;

275 
št16_t
 *
d¡
;

276 
¤c_¡•
, 
d¡_¡•
;

277 
št16_t
 
Şd_§m¶e
 = 0;

278 
št16_t
 
Ãw_§m¶e
 = 0;

279 
Şd_weight
, 
Ãw_weight
;

280 
pos
 = 
LINEAR_DIV
 - 
g‘_šüem’t
;

281 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

282 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

283 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
) >> 1;

284 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
) >> 1 ;

285 
¤c_äames1
 = 0;

286 
d¡_äames1
 = 0;

287 
¤c_äames1
 < 
¤c_äames
) {

289 
Ãw_§m¶e
 = *
¤c
;

290 
¤c
 +ğ
¤c_¡•
;

291 
¤c_äames1
++;

292 
pos
 +ğ
g‘_šüem’t
;

293 ià(
pos
 >ğ
LINEAR_DIV
) {

294 
pos
 -ğ
LINEAR_DIV
;

295 
Şd_weight
 = (
pos
 << (32 - 
LINEAR_DIV_SHIFT
)è/ (
g‘_šüem’t
 >> (LINEAR_DIV_SHIFT - 16));

296 
Ãw_weight
 = 0x10000 - 
Şd_weight
;

297 *
d¡
 = (
Şd_§m¶e
 * 
Şd_weight
 + 
Ãw_§m¶e
 * 
Ãw_weight
) >> 16;

298 
d¡
 +ğ
d¡_¡•
;

299 
d¡_äames1
++;

300 ià(
	`CHECK_SANITY
(
d¡_äames1
 > 
d¡_äames
)) {

301 
	`SNDERR
("dst_frames overflow");

305 
Şd_§m¶e
 = 
Ãw_§m¶e
;

308 
	}
}

310 
	$lš—r_cÚv”t
(*
obj
,

311 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

312 
¢d_pcm_uäames_t
 
d¡_off£t
, 
d¡_äames
,

313 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

314 
¢d_pcm_uäames_t
 
¤c_off£t
, 
¤c_äames
)

316 
¿‹_lš—r
 *
¿‹
 = 
obj
;

317 
¿‹
->
	`func
Ô©e, 
d¡_¬—s
, 
d¡_off£t
, 
d¡_äames
,

318 
¤c_¬—s
, 
¤c_off£t
, 
¤c_äames
);

319 
	}
}

321 
	$lš—r_ä“
(*
obj
)

323 
¿‹_lš—r
 *
¿‹
 = 
obj
;

325 
	`ä“
(
¿‹
->
Şd_§m¶e
);

326 
¿‹
->
Şd_§m¶e
 = 
NULL
;

327 
	}
}

329 
	$lš—r_š™
(*
obj
, 
¢d_pcm_¿‹_šfo_t
 *
šfo
)

331 
¿‹_lš—r
 *
¿‹
 = 
obj
;

333 
¿‹
->
g‘_idx
 = 
	`¢d_pcm_lš—r_g‘_šdex
(
šfo
->
š
.
fÜm©
, 
SND_PCM_FORMAT_S16
);

334 
¿‹
->
put_idx
 = 
	`¢d_pcm_lš—r_put_šdex
(
SND_PCM_FORMAT_S16
, 
šfo
->
out
.
fÜm©
);

335 ià(
šfo
->
š
.
¿‹
 < info->
out
.rate) {

336 ià(
šfo
->
š
.
fÜm©
 =ğšfo->
out
.fÜm© && info->š.fÜm© =ğ
SND_PCM_FORMAT_S16
)

337 
¿‹
->
func
 = 
lš—r_ex·nd_s16
;

339 
¿‹
->
func
 = 
lš—r_ex·nd
;

342 ià(
šfo
->
š
.
fÜm©
 =ğšfo->
out
.fÜm© && info->š.fÜm© =ğ
SND_PCM_FORMAT_S16
)

343 
¿‹
->
func
 = 
lš—r_shršk_s16
;

345 
¿‹
->
func
 = 
lš—r_shršk
;

348 
¿‹
->
p™ch
 = (((
ušt64_t
)
šfo
->
out
.¿‹ * 
LINEAR_DIV
) +

349 (
šfo
->
š
.
¿‹
 / 2)) / info->in.rate;

350 
¿‹
->
chªÃls
 = 
šfo
->channels;

352 
	`ä“
(
¿‹
->
Şd_§m¶e
);

353 
¿‹
->
Şd_§m¶e
 = 
	`m®loc
((*¿‹->Şd_§m¶eè*„©e->
chªÃls
);

354 ià(! 
¿‹
->
Şd_§m¶e
)

355  -
ENOMEM
;

358 
	}
}

360 
	$lš—r_adju¡_p™ch
(*
obj
, 
¢d_pcm_¿‹_šfo_t
 *
šfo
)

362 
¿‹_lš—r
 *
¿‹
 = 
obj
;

363 
¢d_pcm_uäames_t
 
cäames
;

365 
¿‹
->
p™ch
 = (((
ušt64_t
)
šfo
->
out
.
³riod_size
 * 
LINEAR_DIV
) +

366 (
šfo
->
š
.
³riod_size
/2) ) / info->in.period_size;

368 
cäames
 = 
	`šput_äames
(
¿‹
, 
šfo
->
out
.
³riod_size
);

369 
cäames
 !ğ
šfo
->
š
.
³riod_size
) {

370 
¢d_pcm_uäames_t
 
cäames_Ãw
;

371 ià(
cäames
 > 
šfo
->
š
.
³riod_size
)

372 
¿‹
->
p™ch
++;

374 
¿‹
->
p™ch
--;

375 
cäames_Ãw
 = 
	`šput_äames
(
¿‹
, 
šfo
->
out
.
³riod_size
);

376 ià((
cäames
 > 
šfo
->
š
.
³riod_size
 && 
cäames_Ãw
 < info->in.period_size) ||

377 (
cäames
 < 
šfo
->
š
.
³riod_size
 && 
cäames_Ãw
 > info->in.period_size)) {

378 
	`SNDERR
("invalid…cm…eriod_size %ld -> %ld",

379 
šfo
->
š
.
³riod_size
, info->
out
.period_size);

380  -
EIO
;

382 
cäames
 = 
cäames_Ãw
;

384 ià(
¿‹
->
p™ch
 >ğ
LINEAR_DIV
) {

386 
¿‹
->
p™ch_shiá
 = 0;

387 (
¿‹
->
p™ch
 >>„©e->
p™ch_shiá
) >= (1 << 16))

388 
¿‹
->
p™ch_shiá
++;

391 
	}
}

393 
	$lš—r_»£t
(*
obj
)

395 
¿‹_lš—r
 *
¿‹
 = 
obj
;

398 ià(
¿‹
->
Şd_§m¶e
)

399 
	`mem£t
(
¿‹
->
Şd_§m¶e
, 0, (*¿‹->Şd_§m¶eè*„©e->
chªÃls
);

400 
	}
}

402 
	$lš—r_şo£
(*
obj
)

404 
	`ä“
(
obj
);

405 
	}
}

407 
	$g‘_suµÜ‹d_¿‹s
(
ATTRIBUTE_UNUSED
 *
¿‹
,

408 *
¿‹_mš
, *
¿‹_max
)

410 *
¿‹_mš
 = 
SND_PCM_PLUGIN_RATE_MIN
;

411 *
¿‹_max
 = 
SND_PCM_PLUGIN_RATE_MAX
;

413 
	}
}

415 
	$lš—r_dump
(
ATTRIBUTE_UNUSED
 *
¿‹
, 
¢d_ouut_t
 *
out
)

417 
	`¢d_ouut_´štf
(
out
, "Converter:†inear-interpolation\n");

418 
	}
}

420 cÚ¡ 
¢d_pcm_¿‹_İs_t
 
	glš—r_İs
 = {

421 .
şo£
 = 
lš—r_şo£
,

422 .
	gš™
 = 
lš—r_š™
,

423 .
	gä“
 = 
lš—r_ä“
,

424 .
	g»£t
 = 
lš—r_»£t
,

425 .
	gadju¡_p™ch
 = 
lš—r_adju¡_p™ch
,

426 .
	gcÚv”t
 = 
lš—r_cÚv”t
,

427 .
	gšput_äames
 = 
šput_äames
,

428 .
	gouut_äames
 = 
ouut_äames
,

429 .
	gv”siÚ
 = 
SND_PCM_RATE_PLUGIN_VERSION
,

430 .
	gg‘_suµÜ‹d_¿‹s
 = 
g‘_suµÜ‹d_¿‹s
,

431 .
	gdump
 = 
lš—r_dump
,

434 
	$SND_PCM_RATE_PLUGIN_ENTRY
(
lš—r
è(
ATTRIBUTE_UNUSED
 
v”siÚ
,

435 **
objp
, 
¢d_pcm_¿‹_İs_t
 *
İs
)

437 
¿‹_lš—r
 *
¿‹
;

439 
¿‹
 = 
	`ÿÎoc
(1, (*rate));

440 ià(! 
¿‹
)

441  -
ENOMEM
;

443 *
objp
 = 
¿‹
;

444 *
İs
 = 
lš—r_İs
;

446 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_route.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_¶ugš.h
"

31 
	~"¶ugš_İs.h
"

32 
	~"bsw­.h
"

33 
	~<m©h.h
>

35 #iâdeà
PIC


37 cÚ¡ *
	g_¢d_moduË_pcm_rou‹
 = "";

40 #iâdeà
DOC_HIDDEN


43 #ià
SND_PCM_PLUGIN_ROUTE_RESOLUTION
 & (SND_PCM_PLUGIN_ROUTE_RESOLUTION - 1) != 0

44 
	#div
(
a
è¨/ğ
SND_PCM_PLUGIN_ROUTE_RESOLUTION


	)

45 #–ià
SND_PCM_PLUGIN_ROUTE_RESOLUTION
 == 16

46 
	#div
(
a
è¨>>ğ4

	)

52 
	mchªÃl
;

53 
	mas_št
;

54 #ià
SND_PCM_PLUGIN_ROUTE_FLOAT


55 
	mas_æßt
;

57 } 
	t¢d_pcm_rou‹_‰abË_¤c_t
;

59 
¢d_pcm_rou‹_‰abË_d¡
 
	t¢d_pcm_rou‹_‰abË_d¡_t
;

62 ’um {
	mUINT64
, 
	mFLOAT
} 
	msum_idx
;

63 
	mg‘_idx
;

64 
	mput_idx
;

65 
	mcÚv_idx
;

66 
	mu£_g‘put
;

67 
	m¤c_size
;

68 
¢d_pcm_fÜm©_t
 
	md¡_sfmt
;

69 
	mn¤cs
;

70 
	mnd¡s
;

71 
¢d_pcm_rou‹_‰abË_d¡_t
 *
	md¡s
;

72 } 
	t¢d_pcm_rou‹_·¿ms_t
;

75 (*
	trou‹_f
)(cÚ¡ 
	t¢d_pcm_chªÃl_¬—_t
 *
	td¡_¬—
,

76 
	t¢d_pcm_uäames_t
 
	td¡_off£t
,

77 cÚ¡ 
	t¢d_pcm_chªÃl_¬—_t
 *
	t¤c_¬—s
,

78 
	t¢d_pcm_uäames_t
 
	t¤c_off£t
,

79 
	t¤c_chªÃls
,

80 
	t¢d_pcm_uäames_t
 
	täames
,

81 cÚ¡ 
	t¢d_pcm_rou‹_‰abË_d¡_t
 *
	t‰abË
,

82 cÚ¡ 
	t¢d_pcm_rou‹_·¿ms_t
 *
	t·¿ms
);

84 
	s¢d_pcm_rou‹_‰abË_d¡
 {

85 
©t
;

86 
n¤cs
;

87 
¢d_pcm_rou‹_‰abË_¤c_t
* 
¤cs
;

88 
rou‹_f
 
func
;

92 
št32_t
 
as_sšt32
;

93 
št64_t
 
as_sšt64
;

94 #ià
SND_PCM_PLUGIN_ROUTE_FLOAT


95 
as_æßt
;

97 } 
	tsum_t
;

101 
¢d_pcm_¶ugš_t
 
¶ug
;

102 
¢d_pcm_fÜm©_t
 
sfÜm©
;

103 
schªÃls
;

104 
¢d_pcm_rou‹_·¿ms_t
 
·¿ms
;

105 
¢d_pcm_chm­_t
 *
chm­
;

106 
¢d_pcm_chm­_qu”y_t
 **
chm­_ov”ride
;

107 } 
	t¢d_pcm_rou‹_t
;

111 
	$¢d_pcm_rou‹_cÚv”t1_z”o
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
,

112 
¢d_pcm_uäames_t
 
d¡_off£t
,

113 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
 
ATTRIBUTE_UNUSED
,

114 
¢d_pcm_uäames_t
 
¤c_off£t
 
ATTRIBUTE_UNUSED
,

115 
¤c_chªÃls
 
ATTRIBUTE_UNUSED
,

116 
¢d_pcm_uäames_t
 
äames
,

117 cÚ¡ 
¢d_pcm_rou‹_‰abË_d¡_t
* 
‰abË
 
ATTRIBUTE_UNUSED
,

118 cÚ¡ 
¢d_pcm_rou‹_·¿ms_t
 *
·¿ms
)

120 
	`¢d_pcm_¬—_s’û
(
d¡_¬—
, 
d¡_off£t
, 
äames
, 
·¿ms
->
d¡_sfmt
);

121 
	}
}

123 #iâdeà
DOC_HIDDEN


125 
	$¢d_pcm_rou‹_cÚv”t1_Úe
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
,

126 
¢d_pcm_uäames_t
 
d¡_off£t
,

127 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

128 
¢d_pcm_uäames_t
 
¤c_off£t
,

129 
¤c_chªÃls
,

130 
¢d_pcm_uäames_t
 
äames
,

131 cÚ¡ 
¢d_pcm_rou‹_‰abË_d¡_t
* 
‰abË
,

132 cÚ¡ 
¢d_pcm_rou‹_·¿ms_t
 *
·¿ms
)

134 
	#CONV_LABELS


	)

135 
	~"¶ugš_İs.h
"

136 #undeà
CONV_LABELS


137 *
cÚv
;

138 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = 0;

139 
¤cidx
;

140 cÚ¡ *
¤c
;

141 *
d¡
;

142 
¤c_¡•
, 
d¡_¡•
;

143 
¤cidx
 = 0; srcidx < 
‰abË
->
n¤cs
 && srcidx < 
¤c_chªÃls
; ++srcidx) {

144 
chªÃl
 = 
‰abË
->
¤cs
[
¤cidx
].channel;

145 ià(
chªÃl
 >ğ
¤c_chªÃls
)

147 
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

148 ià(
¤c_¬—
->
addr
 !ğ
NULL
)

151 ià(
¤cidx
 =ğ
‰abË
->
n¤cs
 || srcidx =ğ
¤c_chªÃls
) {

152 
	`¢d_pcm_rou‹_cÚv”t1_z”o
(
d¡_¬—
, 
d¡_off£t
,

153 
¤c_¬—s
, 
¤c_off£t
,

154 
¤c_chªÃls
,

155 
äames
, 
‰abË
, 
·¿ms
);

159 
cÚv
 = 
cÚv_Ïb–s
[
·¿ms
->
cÚv_idx
];

160 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

161 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

162 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
);

163 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
);

164 
äames
-- > 0) {

165 *
cÚv
;

166 
	#CONV_END
 
aá”


	)

167 
	~"¶ugš_İs.h
"

168 #undeà
CONV_END


169 
aá”
:

170 
¤c
 +ğ
¤c_¡•
;

171 
d¡
 +ğ
d¡_¡•
;

173 
	}
}

175 
	$¢d_pcm_rou‹_cÚv”t1_Úe_g‘put
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
,

176 
¢d_pcm_uäames_t
 
d¡_off£t
,

177 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

178 
¢d_pcm_uäames_t
 
¤c_off£t
,

179 
¤c_chªÃls
,

180 
¢d_pcm_uäames_t
 
äames
,

181 cÚ¡ 
¢d_pcm_rou‹_‰abË_d¡_t
* 
‰abË
,

182 cÚ¡ 
¢d_pcm_rou‹_·¿ms_t
 *
·¿ms
)

184 
	#CONV24_LABELS


	)

185 
	~"¶ugš_İs.h
"

186 #undeà
CONV24_LABELS


187 *
g‘
, *
put
;

188 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
 = 0;

189 
¤cidx
;

190 cÚ¡ *
¤c
;

191 *
d¡
;

192 
¤c_¡•
, 
d¡_¡•
;

193 
ušt32_t
 
§m¶e
 = 0;

194 
¤cidx
 = 0; srcidx < 
‰abË
->
n¤cs
 && srcidx < 
¤c_chªÃls
; ++srcidx) {

195 
chªÃl
 = 
‰abË
->
¤cs
[
¤cidx
].channel;

196 ià(
chªÃl
 >ğ
¤c_chªÃls
)

198 
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

199 ià(
¤c_¬—
->
addr
 !ğ
NULL
)

202 ià(
¤cidx
 =ğ
‰abË
->
n¤cs
 || srcidx =ğ
¤c_chªÃls
) {

203 
	`¢d_pcm_rou‹_cÚv”t1_z”o
(
d¡_¬—
, 
d¡_off£t
,

204 
¤c_¬—s
, 
¤c_off£t
,

205 
¤c_chªÃls
,

206 
äames
, 
‰abË
, 
·¿ms
);

210 
g‘
 = 
g‘32_Ïb–s
[
·¿ms
->
g‘_idx
];

211 
put
 = 
put32_Ïb–s
[
·¿ms
->
put_idx
];

212 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

213 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

214 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
);

215 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
);

216 
äames
-- > 0) {

217 *
g‘
;

218 
	#CONV24_END
 
aá”


	)

219 
	~"¶ugš_İs.h
"

220 #undeà
CONV24_END


221 
aá”
:

222 
¤c
 +ğ
¤c_¡•
;

223 
d¡
 +ğ
d¡_¡•
;

225 
	}
}

227 
	$¢d_pcm_rou‹_cÚv”t1_mªy
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
,

228 
¢d_pcm_uäames_t
 
d¡_off£t
,

229 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

230 
¢d_pcm_uäames_t
 
¤c_off£t
,

231 
¤c_chªÃls
,

232 
¢d_pcm_uäames_t
 
äames
,

233 cÚ¡ 
¢d_pcm_rou‹_‰abË_d¡_t
* 
‰abË
,

234 cÚ¡ 
¢d_pcm_rou‹_·¿ms_t
 *
·¿ms
)

236 
	#GET32_LABELS


	)

237 
	#PUT32_LABELS


	)

238 
	~"¶ugš_İs.h
"

239 #undeà
GET32_LABELS


240 #undeà
PUT32_LABELS


241 *cÚ¡ 
z”o_Ïb–s
[2] = {

242 &&
z”o_št64
,

243 #ià
SND_PCM_PLUGIN_ROUTE_FLOAT


244 &&
z”o_æßt


248 *cÚ¡ 
add_Ïb–s
[2 * 2] = {

249 &&
add_št64_nß‰
, &&
add_št64_©t
,

250 #ià
SND_PCM_PLUGIN_ROUTE_FLOAT


251 &&
add_æßt_nß‰
, &&
add_æßt_©t


255 *cÚ¡ 
nÜm_Ïb–s
[2 * 2] = {

256 &&
nÜm_št64_nß‰
,

257 &&
nÜm_št64_©t
,

258 #ià
SND_PCM_PLUGIN_ROUTE_FLOAT


259 &&
nÜm_æßt
,

260 &&
nÜm_æßt
,

263 *
z”o
, *
g‘32
, *
add
, *
nÜm
, *
put32
;

264 
n¤cs
 = 
‰abË
->nsrcs;

265 *
d¡
;

266 
d¡_¡•
;

267 cÚ¡ *
¤cs
[
n¤cs
];

268 
¤c_¡•s
[
n¤cs
];

269 
¢d_pcm_rou‹_‰abË_¤c_t
 
¤c_‰
[
n¤cs
];

270 
št32_t
 
§m¶e
 = 0;

271 
¤cidx
, 
¤cidx1
 = 0;

272 
¤cidx
 = 0; srcidx < 
n¤cs
 && ()¤cidx < 
¤c_chªÃls
; ++srcidx) {

273 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—
;

274 
chªÃl
 = 
‰abË
->
¤cs
[
¤cidx
].channel;

275 ià(
chªÃl
 >ğ
¤c_chªÃls
)

277 
¤c_¬—
 = &
¤c_¬—s
[
chªÃl
];

278 
¤cs
[
¤cidx1
] = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
);

279 
¤c_¡•s
[
¤cidx1
] = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
);

280 
¤c_‰
[
¤cidx1
] = 
‰abË
->
¤cs
[
¤cidx
];

281 
¤cidx1
++;

283 
n¤cs
 = 
¤cidx1
;

284 ià(
n¤cs
 == 0) {

285 
	`¢d_pcm_rou‹_cÚv”t1_z”o
(
d¡_¬—
, 
d¡_off£t
,

286 
¤c_¬—s
, 
¤c_off£t
,

287 
¤c_chªÃls
,

288 
äames
, 
‰abË
, 
·¿ms
);

290 } ià(
n¤cs
 =ğ1 && 
¤c_‰
[0].
as_št
 =ğ
SND_PCM_PLUGIN_ROUTE_RESOLUTION
) {

291 ià(
·¿ms
->
u£_g‘put
)

292 
	`¢d_pcm_rou‹_cÚv”t1_Úe_g‘put
(
d¡_¬—
, 
d¡_off£t
,

293 
¤c_¬—s
, 
¤c_off£t
,

294 
¤c_chªÃls
,

295 
äames
, 
‰abË
, 
·¿ms
);

297 
	`¢d_pcm_rou‹_cÚv”t1_Úe
(
d¡_¬—
, 
d¡_off£t
,

298 
¤c_¬—s
, 
¤c_off£t
,

299 
¤c_chªÃls
,

300 
äames
, 
‰abË
, 
·¿ms
);

304 
z”o
 = 
z”o_Ïb–s
[
·¿ms
->
sum_idx
];

305 
g‘32
 = 
g‘32_Ïb–s
[
·¿ms
->
g‘_idx
];

306 
add
 = 
add_Ïb–s
[
·¿ms
->
sum_idx
 * 2 + 
‰abË
->
©t
];

307 
nÜm
 = 
nÜm_Ïb–s
[
·¿ms
->
sum_idx
 * 2 + 
‰abË
->
©t
];

308 
put32
 = 
put32_Ïb–s
[
·¿ms
->
put_idx
];

309 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
);

310 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
);

312 
äames
-- > 0) {

313 
¢d_pcm_rou‹_‰abË_¤c_t
 *
‰p
 = 
¤c_‰
;

314 
sum_t
 
sum
;

317 *
z”o
;

318 
z”o_št64
:

319 
sum
.
as_sšt64
 = 0;

320 
z”o_’d
;

321 #ià
SND_PCM_PLUGIN_ROUTE_FLOAT


322 
z”o_æßt
:

323 
sum
.
as_æßt
 = 0.0;

324 
z”o_’d
;

326 
z”o_’d
:

327 
¤cidx
 = 0; srcidx < 
n¤cs
; ++srcidx) {

328 cÚ¡ *
¤c
 = 
¤cs
[
¤cidx
];

331 *
g‘32
;

332 
	#GET32_END
 
aá”_g‘


	)

333 
	~"¶ugš_İs.h
"

334 #undeà
GET32_END


335 
aá”_g‘
:

338 *
add
;

339 
add_št64_©t
:

340 
sum
.
as_sšt64
 +ğ(
št64_t
è
§m¶e
 * 
‰p
->
as_št
;

341 
aá”_sum
;

342 
add_št64_nß‰
:

343 ià(
‰p
->
as_št
)

344 
sum
.
as_sšt64
 +ğ
§m¶e
;

345 
aá”_sum
;

346 #ià
SND_PCM_PLUGIN_ROUTE_FLOAT


347 
add_æßt_©t
:

348 
sum
.
as_æßt
 +ğ
§m¶e
 * 
‰p
->as_float;

349 
aá”_sum
;

350 
add_æßt_nß‰
:

351 ià(
‰p
->
as_št
)

352 
sum
.
as_æßt
 +ğ
§m¶e
;

353 
aá”_sum
;

355 
aá”_sum
:

356 
¤cs
[
¤cidx
] +ğ
¤c_¡•s
[srcidx];

357 
‰p
++;

361 *
nÜm
;

362 
nÜm_št64_©t
:

363 
	`div
(
sum
.
as_sšt64
);

365 
nÜm_št64_nß‰
:

366 ià(
sum
.
as_sšt64
 > (
št64_t
)0x7fffffff)

367 
§m¶e
 = 0x7fffffff;

368 ià(
sum
.
as_sšt64
 < -(
št64_t
)0x80000000)

369 
§m¶e
 = 0x80000000;

371 
§m¶e
 = 
sum
.
as_sšt64
;

372 
aá”_nÜm
;

374 #ià
SND_PCM_PLUGIN_ROUTE_FLOAT


375 
nÜm_æßt
:

376 
sum
.
as_æßt
 = 
	`ršt
(sum.as_float);

377 ià(
sum
.
as_æßt
 > (
št64_t
)0x7fffffff)

378 
§m¶e
 = 0x7fffffff;

379 ià(
sum
.
as_æßt
 < -(
št64_t
)0x80000000)

380 
§m¶e
 = 0x80000000;

382 
§m¶e
 = 
sum
.
as_æßt
;

383 
aá”_nÜm
;

385 
aá”_nÜm
:

388 *
put32
;

389 
	#PUT32_END
 
aá”_put32


	)

390 
	~"¶ugš_İs.h
"

391 #undeà
PUT32_END


392 
aá”_put32
:

394 
d¡
 +ğ
d¡_¡•
;

396 
	}
}

400 
	$¢d_pcm_rou‹_cÚv”t
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

401 
¢d_pcm_uäames_t
 
d¡_off£t
,

402 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

403 
¢d_pcm_uäames_t
 
¤c_off£t
,

404 
¤c_chªÃls
,

405 
d¡_chªÃls
,

406 
¢d_pcm_uäames_t
 
äames
,

407 
¢d_pcm_rou‹_·¿ms_t
 *
·¿ms
)

409 
d¡_chªÃl
;

410 
¢d_pcm_rou‹_‰abË_d¡_t
 *
d¡p
;

411 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
;

413 
d¡p
 = 
·¿ms
->
d¡s
;

414 
d¡_¬—
 = 
d¡_¬—s
;

415 
d¡_chªÃl
 = 0; d¡_chªÃÈ< 
d¡_chªÃls
; ++dst_channel) {

416 ià(
d¡_chªÃl
 >ğ
·¿ms
->
nd¡s
)

417 
	`¢d_pcm_rou‹_cÚv”t1_z”o
(
d¡_¬—
, 
d¡_off£t
,

418 
¤c_¬—s
, 
¤c_off£t
,

419 
¤c_chªÃls
,

420 
äames
, 
d¡p
, 
·¿ms
);

422 
d¡p
->
	`func
(
d¡_¬—
, 
d¡_off£t
,

423 
¤c_¬—s
, 
¤c_off£t
,

424 
¤c_chªÃls
,

425 
äames
, 
d¡p
, 
·¿ms
);

426 
d¡p
++;

427 
d¡_¬—
++;

429 
	}
}

431 
	$¢d_pcm_rou‹_şo£
(
¢d_pcm_t
 *
pcm
)

433 
¢d_pcm_rou‹_t
 *
rou‹
 = 
pcm
->
´iv©e_d©a
;

434 
¢d_pcm_rou‹_·¿ms_t
 *
·¿ms
 = &
rou‹
->params;

435 
d¡_chªÃl
;

437 ià(
·¿ms
->
d¡s
) {

438 
d¡_chªÃl
 = 0; d¡_chªÃÈ< 
·¿ms
->
nd¡s
; ++dst_channel) {

439 
	`ä“
(
·¿ms
->
d¡s
[
d¡_chªÃl
].
¤cs
);

441 
	`ä“
(
·¿ms
->
d¡s
);

443 
	`ä“
(
rou‹
->
chm­
);

444 
	`¢d_pcm_ä“_chm­s
(
rou‹
->
chm­_ov”ride
);

445  
	`¢d_pcm_g’”ic_şo£
(
pcm
);

446 
	}
}

448 
	$¢d_pcm_rou‹_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

450 
”r
;

451 
¢d_pcm_acûss_mask_t
 
acûss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

452 
¢d_pcm_fÜm©_mask_t
 
fÜm©_mask
 = { 
SND_PCM_FMTBIT_LINEAR
 };

453 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

454 &
acûss_mask
);

455 ià(
”r
 < 0)

456  
”r
;

457 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
,

458 &
fÜm©_mask
);

459 ià(
”r
 < 0)

460  
”r
;

461 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
·¿ms
, 
SND_PCM_SUBFORMAT_STD
);

462 ià(
”r
 < 0)

463  
”r
;

464 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
, 1, 0);

465 ià(
”r
 < 0)

466  
”r
;

467 
·¿ms
->
šfo
 &ğ~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

469 
	}
}

471 
	$¢d_pcm_rou‹_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

473 
¢d_pcm_rou‹_t
 *
rou‹
 = 
pcm
->
´iv©e_d©a
;

474 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

475 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

476 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

477 &
§cûss_mask
);

478 ià(
rou‹
->
sfÜm©
 !ğ
SND_PCM_FORMAT_UNKNOWN
) {

479 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
¥¬ams
, 
rou‹
->
sfÜm©
);

480 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¥¬ams
, 
SND_PCM_SUBFORMAT_STD
);

482 ià(
rou‹
->
schªÃls
 >= 0) {

483 
	`_¢d_pcm_hw_·¿m_£t
(
¥¬ams
, 
SND_PCM_HW_PARAM_CHANNELS
,

484 (è
rou‹
->
schªÃls
, 0);

487 
	}
}

489 
	$¢d_pcm_rou‹_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

490 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

492 
¢d_pcm_rou‹_t
 *
rou‹
 = 
pcm
->
´iv©e_d©a
;

493 
”r
;

494 
lšks
 = (
SND_PCM_HW_PARBIT_RATE
 |

495 
SND_PCM_HW_PARBIT_PERIODS
 |

496 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

497 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

498 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

499 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

500 
SND_PCM_HW_PARBIT_TICK_TIME
);

501 ià(
rou‹
->
sfÜm©
 =ğ
SND_PCM_FORMAT_UNKNOWN
)

502 
lšks
 |ğ(
SND_PCM_HW_PARBIT_FORMAT
 |

503 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

504 
SND_PCM_HW_PARBIT_SAMPLE_BITS
);

505 ià(
rou‹
->
schªÃls
 < 0)

506 
lšks
 |ğ
SND_PCM_HW_PARBIT_CHANNELS
;

507 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

508 ià(
”r
 < 0)

509  
”r
;

511 
	}
}

513 
	$¢d_pcm_rou‹_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

514 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

516 
¢d_pcm_rou‹_t
 *
rou‹
 = 
pcm
->
´iv©e_d©a
;

517 
”r
;

518 
lšks
 = (
SND_PCM_HW_PARBIT_RATE
 |

519 
SND_PCM_HW_PARBIT_PERIODS
 |

520 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

521 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

522 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

523 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

524 
SND_PCM_HW_PARBIT_TICK_TIME
);

525 ià(
rou‹
->
sfÜm©
 =ğ
SND_PCM_FORMAT_UNKNOWN
)

526 
lšks
 |ğ(
SND_PCM_HW_PARBIT_FORMAT
 |

527 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

528 
SND_PCM_HW_PARBIT_SAMPLE_BITS
);

529 ià(
rou‹
->
schªÃls
 < 0)

530 
lšks
 |ğ
SND_PCM_HW_PARBIT_CHANNELS
;

531 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

532 ià(
”r
 < 0)

533  
”r
;

535 
	}
}

537 
	$¢d_pcm_rou‹_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

539  
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

540 
¢d_pcm_rou‹_hw_»fše_ı»·»
,

541 
¢d_pcm_rou‹_hw_»fše_cchªge
,

542 
¢d_pcm_rou‹_hw_»fše_¥»·»
,

543 
¢d_pcm_rou‹_hw_»fše_schªge
,

544 
¢d_pcm_g’”ic_hw_»fše
);

545 
	}
}

547 
	$¢d_pcm_rou‹_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 * 
·¿ms
)

549 
¢d_pcm_rou‹_t
 *
rou‹
 = 
pcm
->
´iv©e_d©a
;

550 
¢d_pcm_t
 *
¦ave
 = 
rou‹
->
¶ug
.
g’
.slave;

551 
¢d_pcm_fÜm©_t
 
¤c_fÜm©
, 
d¡_fÜm©
;

552 
”r
 = 
	`¢d_pcm_hw_·¿ms_¦ave
(
pcm
, 
·¿ms
,

553 
¢d_pcm_rou‹_hw_»fše_cchªge
,

554 
¢d_pcm_rou‹_hw_»fše_¥»·»
,

555 
¢d_pcm_rou‹_hw_»fše_schªge
,

556 
¢d_pcm_g’”ic_hw_·¿ms
);

557 ià(
”r
 < 0)

558  
”r
;

560 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

561 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(
·¿ms
, &
¤c_fÜm©
);

562 
d¡_fÜm©
 = 
¦ave
->
fÜm©
;

564 
¤c_fÜm©
 = 
¦ave
->
fÜm©
;

565 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_fÜm©
)(
·¿ms
, &
d¡_fÜm©
);

567 ià(
”r
 < 0)

568  
”r
;

570 
rou‹
->
·¿ms
.
u£_g‘put
 =

571 (
	`¢d_pcm_fÜm©_physiÿl_width
(
¤c_fÜm©
) + 7) / 8 == 3 ||

572 (
	`¢d_pcm_fÜm©_physiÿl_width
(
d¡_fÜm©
) + 7) / 8 == 3 ||

573 
	`¢d_pcm_fÜm©_width
(
¤c_fÜm©
) == 20 ||

574 
	`¢d_pcm_fÜm©_width
(
d¡_fÜm©
) == 20;

575 
rou‹
->
·¿ms
.
g‘_idx
 = 
	`¢d_pcm_lš—r_g‘_šdex
(
¤c_fÜm©
, 
SND_PCM_FORMAT_S32
);

576 
rou‹
->
·¿ms
.
put_idx
 = 
	`¢d_pcm_lš—r_put_šdex
(
SND_PCM_FORMAT_S32
, 
d¡_fÜm©
);

577 
rou‹
->
·¿ms
.
cÚv_idx
 = 
	`¢d_pcm_lš—r_cÚv”t_šdex
(
¤c_fÜm©
, 
d¡_fÜm©
);

578 
rou‹
->
·¿ms
.
¤c_size
 = 
	`¢d_pcm_fÜm©_width
(
¤c_fÜm©
) / 8;

579 
rou‹
->
·¿ms
.
d¡_sfmt
 = 
d¡_fÜm©
;

580 #ià
SND_PCM_PLUGIN_ROUTE_FLOAT


581 
rou‹
->
·¿ms
.
sum_idx
 = 
FLOAT
;

583 
rou‹
->
·¿ms
.
sum_idx
 = 
UINT64
;

586 
	}
}

588 
¢d_pcm_uäames_t


589 
	$¢d_pcm_rou‹_wr™e_¬—s
(
¢d_pcm_t
 *
pcm
,

590 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

591 
¢d_pcm_uäames_t
 
off£t
,

592 
¢d_pcm_uäames_t
 
size
,

593 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

594 
¢d_pcm_uäames_t
 
¦ave_off£t
,

595 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

597 
¢d_pcm_rou‹_t
 *
rou‹
 = 
pcm
->
´iv©e_d©a
;

598 
¢d_pcm_t
 *
¦ave
 = 
rou‹
->
¶ug
.
g’
.slave;

599 ià(
size
 > *
¦ave_siz•
)

600 
size
 = *
¦ave_siz•
;

601 
	`¢d_pcm_rou‹_cÚv”t
(
¦ave_¬—s
, 
¦ave_off£t
,

602 
¬—s
, 
off£t
,

603 
pcm
->
chªÃls
,

604 
¦ave
->
chªÃls
,

605 
size
, &
rou‹
->
·¿ms
);

606 *
¦ave_siz•
 = 
size
;

607  
size
;

608 
	}
}

610 
¢d_pcm_uäames_t


611 
	$¢d_pcm_rou‹_»ad_¬—s
(
¢d_pcm_t
 *
pcm
,

612 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

613 
¢d_pcm_uäames_t
 
off£t
,

614 
¢d_pcm_uäames_t
 
size
,

615 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

616 
¢d_pcm_uäames_t
 
¦ave_off£t
,

617 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

619 
¢d_pcm_rou‹_t
 *
rou‹
 = 
pcm
->
´iv©e_d©a
;

620 
¢d_pcm_t
 *
¦ave
 = 
rou‹
->
¶ug
.
g’
.slave;

621 ià(
size
 > *
¦ave_siz•
)

622 
size
 = *
¦ave_siz•
;

623 
	`¢d_pcm_rou‹_cÚv”t
(
¬—s
, 
off£t
,

624 
¦ave_¬—s
, 
¦ave_off£t
,

625 
¦ave
->
chªÃls
,

626 
pcm
->
chªÃls
,

627 
size
, &
rou‹
->
·¿ms
);

628 *
¦ave_siz•
 = 
size
;

629  
size
;

630 
	}
}

632 
¢d_pcm_chm­_t
 *
	$¢d_pcm_rou‹_g‘_chm­
(
¢d_pcm_t
 *
pcm
)

634 
¢d_pcm_rou‹_t
 *
rou‹
 = 
pcm
->
´iv©e_d©a
;

635 
¢d_pcm_chm­_t
 *
m­
, *
¦ave_m­
;

636 
¤c
, 
d¡
, 
n¤cs
;

638 ià(
rou‹
->
chm­_ov”ride
)

639  
	`_¢d_pcm_choo£_fixed_chm­
(
pcm
, 
rou‹
->
chm­_ov”ride
);

641 
¦ave_m­
 = 
	`¢d_pcm_g’”ic_g‘_chm­
(
pcm
);

642 ià(!
¦ave_m­
)

643  
NULL
;

644 
n¤cs
 = 
rou‹
->
·¿ms
.nsrcs;

645 
m­
 = 
	`ÿÎoc
(4, 
n¤cs
 + 1);

646 ià(!
m­
) {

647 
	`ä“
(
¦ave_m­
);

648  
NULL
;

650 
m­
->
chªÃls
 = 
n¤cs
;

651 
¤c
 = 0; srø< 
n¤cs
; src++)

652 
m­
->
pos
[
¤c
] = 
SND_CHMAP_NA
;

653 
d¡
 = 0; d¡ < 
rou‹
->
·¿ms
.
nd¡s
; dst++) {

654 
¢d_pcm_rou‹_‰abË_d¡_t
 *
d
 = &
rou‹
->
·¿ms
.
d¡s
[
d¡
];

655 
¤c
 = 0; srø< 
d
->
n¤cs
; src++) {

656 
c
 = 
d
->
¤cs
[
¤c
].
chªÃl
;

657 ià(
c
 < 
n¤cs
 && 
m­
->
pos
[c] =ğ
SND_CHMAP_NA
)

658 
m­
->
pos
[
c
] = 
¦ave_m­
->pos[
d¡
];

661 
	`ä“
(
¦ave_m­
);

662  
m­
;

663 
	}
}

665 
¢d_pcm_chm­_qu”y_t
 **
	$¢d_pcm_rou‹_qu”y_chm­s
(
¢d_pcm_t
 *
pcm
)

667 
¢d_pcm_rou‹_t
 *
rou‹
 = 
pcm
->
´iv©e_d©a
;

668 
¢d_pcm_chm­_qu”y_t
 **
m­s
;

669 
¢d_pcm_chm­_t
 *
m­
;

671 ià(
rou‹
->
chm­_ov”ride
)

672  
	`_¢d_pcm_cİy_chm­_qu”y
(
rou‹
->
chm­_ov”ride
);

674 
m­
 = 
	`¢d_pcm_rou‹_g‘_chm­
(
pcm
);

675 ià(!
m­
)

676  
NULL
;

677 
m­s
 = 
	`_¢d_pcm_make_sšgË_qu”y_chm­s
(
m­
);

678 
	`ä“
(
m­
);

679  
m­s
;

680 
	}
}

682 
	$¢d_pcm_rou‹_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

684 
¢d_pcm_rou‹_t
 *
rou‹
 = 
pcm
->
´iv©e_d©a
;

685 
d¡
;

686 ià(
rou‹
->
sfÜm©
 =ğ
SND_PCM_FORMAT_UNKNOWN
)

687 
	`¢d_ouut_´štf
(
out
, "Route conversion PCM\n");

689 
	`¢d_ouut_´štf
(
out
, "Route conversion PCM (sformat=%s)\n",

690 
	`¢d_pcm_fÜm©_Çme
(
rou‹
->
sfÜm©
));

691 
	`¢d_ouut_puts
(
out
, " Transformationable:\n");

692 
d¡
 = 0; d¡ < 
rou‹
->
·¿ms
.
nd¡s
; dst++) {

693 
¢d_pcm_rou‹_‰abË_d¡_t
 *
d
 = &
rou‹
->
·¿ms
.
d¡s
[
d¡
];

694 
¤c
;

695 
	`¢d_ouut_´štf
(
out
, " %d <- ", 
d¡
);

696 ià(
d
->
n¤cs
 == 0) {

697 
	`¢d_ouut_´štf
(
out
, "none\n");

700 
¤c
 = 0;

702 
¢d_pcm_rou‹_‰abË_¤c_t
 *
s
 = &
d
->
¤cs
[
¤c
];

703 ià(
d
->
©t
)

704 #ià
SND_PCM_PLUGIN_ROUTE_FLOAT


705 
	`¢d_ouut_´štf
(
out
, "%d*%g", 
s
->
chªÃl
, s->
as_æßt
);

707 
	`¢d_ouut_´štf
(
out
, "%d*%g", 
s
->
chªÃl
, ()s->
as_št
 / ()
SND_PCM_PLUGIN_ROUTE_RESOLUTION
);

710 
	`¢d_ouut_´štf
(
out
, "%d", 
s
->
chªÃl
);

711 
¤c
++;

712 ià(
¤c
 =ğ
d
->
n¤cs
)

714 
	`¢d_ouut_puts
(
out
, " + ");

716 
	`¢d_ouut_putc
(
out
, '\n');

718 ià(
pcm
->
£tup
) {

719 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

720 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

722 
	`¢d_ouut_´štf
(
out
, "Slave: ");

723 
	`¢d_pcm_dump
(
rou‹
->
¶ug
.
g’
.
¦ave
, 
out
);

724 
	}
}

737 
	$¡¹ochªÃl
(cÚ¡ *
id
, 
¢d_pcm_chm­_t
 *
chm­
,

738 *
chªÃl
, 
chªÃl_size
)

740 
ch
;

741 ià(
	`§ã_¡¹Ş
(
id
, 
chªÃl
) >= 0)

744 
ch
 = (è
	`¢d_pcm_chm­_äom_¡ršg
(
id
);

745 ià(
ch
 == -1)

746  -
EINVAL
;

748 ià(
chm­
) {

749 
i
, 
r
 = 0;

752 
i
 = 
chm­
->
chªÃls
 - 1; i >= 0; i--) {

753 ià((è
chm­
->
pos
[
i
] !ğ
ch
)

755 ià(
r
 >ğ
chªÃl_size
)

757 
chªÃl
[
r
++] = 
i
;

759  
r
;

763 *
chªÃl
 = 
ch
 - 
SND_CHMAP_FL
;

766 
	}
}

768 #iâdeà
DOC_HIDDEN


769 
	#MAX_CHMAP_CHANNELS
 256

	)

772 
	$d‘”mše_chm­
(
¢d_cÚfig_t
 *
‰
, 
¢d_pcm_chm­_t
 **
‰_chm­
)

774 
¢d_cÚfig_™”©Ü_t
 
i
, 
šext
;

775 
¢d_pcm_chm­_t
 *
chm­
;

777 
	`as£¹
(
‰
 && 
‰_chm­
);

778 
chm­
 = 
	`m®loc
((
¢d_pcm_chm­_t
) +

779 
MAX_CHMAP_CHANNELS
 * ());

781 
chm­
->
chªÃls
 = 0;

782 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
šext
, 
‰
) {

783 cÚ¡ *
id
;

784 
¢d_cÚfig_™”©Ü_t
 
j
, 
jÃxt
;

785 
¢d_cÚfig_t
 *
š
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

787 ià(
	`¢d_cÚfig_g‘_id
(
š
, &
id
) < 0)

789 ià(
	`¢d_cÚfig_g‘_ty³
(
š
è!ğ
SND_CONFIG_TYPE_COMPOUND
)

790 
”r
;

791 
	`¢d_cÚfig_fÜ_—ch
(
j
, 
jÃxt
, 
š
) {

792 
ch
, 
k
, 
found
;

793 
schªÃl
;

794 
¢d_cÚfig_t
 *
jnode
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
j
);

795 ià(
	`¢d_cÚfig_g‘_id
(
jnode
, &
id
) < 0)

797 ià(
	`§ã_¡¹Ş
(
id
, &
schªÃl
) >= 0)

799 
ch
 = (è
	`¢d_pcm_chm­_äom_¡ršg
(
id
);

800 ià(
ch
 == -1)

801 
”r
;

803 
found
 = 0;

804 
k
 = 0; k < (è
chm­
->
chªÃls
; k++)

805 ià(
ch
 =ğ(è
chm­
->
pos
[
k
]) {

806 
found
 = 1;

809 ià(
found
)

812 ià(
chm­
->
chªÃls
 >ğ
MAX_CHMAP_CHANNELS
) {

813 
	`SNDERR
("Too many channels intable chmap");

814 
”r
;

816 
chm­
->
pos
[chm­->
chªÃls
++] = 
ch
;

820 ià(
chm­
->
chªÃls
 == 0) {

821 
	`ä“
(
chm­
);

822 
chm­
 = 
NULL
;

824 *
‰_chm­
 = 
chm­
;

827 
”r
:

828 *
‰_chm­
 = 
NULL
;

829 
	`ä“
(
chm­
);

830  -
EINVAL
;

831 
	}
}

833 
	$fšd_m©chšg_chm­
(
¢d_pcm_chm­_qu”y_t
 **
chm­s
,

834 
¢d_pcm_chm­_t
 *
‰_chm­
,

835 
¢d_pcm_chm­_t
 **
found_chm­
, *
schªÃls
)

837 
i
;

839 *
found_chm­
 = 
NULL
;

841 ià(
chm­s
 =ğ
NULL
)

844 
i
 = 0; 
chm­s
[i]; i++) {

845 
j
, 
k
;

846 
m©ch
 = 1;

847 
¢d_pcm_chm­_t
 *
c
 = &
chm­s
[
i
]->
m­
;

848 ià(*
schªÃls
 >ğ0 && (è
c
->
chªÃls
 != *schannels)

851 
j
 = 0; j < 
‰_chm­
->
chªÃls
; j++) {

852 
found
 = 0;

853 
ch
 = 
‰_chm­
->
pos
[
j
];

854 
k
 = 0; k < 
c
->
chªÃls
; k++)

855 ià(
c
->
pos
[
k
] =ğ
ch
) {

856 
found
 = 1;

859 ià(!
found
) {

860 
m©ch
 = 0;

865 ià(
m©ch
) {

866 
size
 = (
¢d_pcm_chm­_t
è+ 
c
->
chªÃls
 * ();

867 *
found_chm­
 = 
	`m®loc
(
size
);

868 ià(!*
found_chm­
) {

869  -
ENOMEM
;

871 
	`memıy
(*
found_chm­
, 
c
, 
size
);

872 *
schªÃls
 = 
c
->
chªÃls
;

877 ià(*
found_chm­
 =ğ
NULL
) {

878 
	`SNDERR
("Found‚o matching channel map");

879  -
EINVAL
;

882 
	}
}

884 
	$rou‹_chm­_š™
(
¢d_pcm_t
 *
pcm
)

886 
£t_m­
 = 0;

887 
¢d_pcm_chm­_t
 *
cu¼’t
;

888 
¢d_pcm_rou‹_t
 *
rou‹
 = 
pcm
->
´iv©e_d©a
;

889 ià(!
rou‹
->
chm­
)

891 ià(
	`__¢d_pcm_¡©e
(
pcm
è!ğ
SND_PCM_STATE_PREPARED
)

896 
cu¼’t
 = 
	`¢d_pcm_g‘_chm­
(
rou‹
->
¶ug
.
g’
.
¦ave
);

897 ià(!
cu¼’t
)

898  -
ENOSYS
;

899 ià(
cu¼’t
->
chªÃls
 !ğ
rou‹
->
chm­
->channels)

900 
£t_m­
 = 1;

902 
£t_m­
 = 
	`memcmp
(
cu¼’t
->
pos
, 
rou‹
->
chm­
->pos,

903 
cu¼’t
->
chªÃls
);

904 
	`ä“
(
cu¼’t
);

905 ià(!
£t_m­
)

908  
	`¢d_pcm_£t_chm­
(
rou‹
->
¶ug
.
g’
.
¦ave
,„ou‹->
chm­
);

909 
	}
}

912 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_rou‹_İs
 = {

913 .
şo£
 = 
¢d_pcm_rou‹_şo£
,

914 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

915 .
	ghw_»fše
 = 
¢d_pcm_rou‹_hw_»fše
,

916 .
	ghw_·¿ms
 = 
¢d_pcm_rou‹_hw_·¿ms
,

917 .
	ghw_ä“
 = 
¢d_pcm_g’”ic_hw_ä“
,

918 .
	gsw_·¿ms
 = 
¢d_pcm_g’”ic_sw_·¿ms
,

919 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

920 .
	gdump
 = 
¢d_pcm_rou‹_dump
,

921 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

922 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

923 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

924 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

925 .
	gqu”y_chm­s
 = 
¢d_pcm_rou‹_qu”y_chm­s
,

926 .
	gg‘_chm­
 = 
¢d_pcm_rou‹_g‘_chm­
,

927 .
	g£t_chm­
 = 
NULL
,

930 
	$rou‹_lßd_‰abË
(
¢d_pcm_rou‹_·¿ms_t
 *
·¿ms
, 
¢d_pcm_¡»am_t
 
¡»am
,

931 
‰_ssize
,

932 
¢d_pcm_rou‹_‰abË_’Œy_t
 *
‰abË
,

933 
‰_cu£d
, 
‰_su£d
)

935 
¤c_chªÃl
, 
d¡_chªÃl
;

936 
¢d_pcm_rou‹_‰abË_d¡_t
 *
d±r
;

937 
su£d
, 
du£d
, 
smul
, 
dmul
;

938 ià(
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

939 
su£d
 = 
‰_cu£d
;

940 
du£d
 = 
‰_su£d
;

941 
smul
 = 
‰_ssize
;

942 
dmul
 = 1;

944 
su£d
 = 
‰_su£d
;

945 
du£d
 = 
‰_cu£d
;

946 
smul
 = 1;

947 
dmul
 = 
‰_ssize
;

949 
·¿ms
->
nd¡s
 = 
du£d
;

950 
·¿ms
->
n¤cs
 = 
su£d
;

951 
d±r
 = 
	`ÿÎoc
(
du£d
, (*
·¿ms
->
d¡s
));

952 ià(!
d±r
)

953  -
ENOMEM
;

954 
·¿ms
->
d¡s
 = 
d±r
;

955 
d¡_chªÃl
 = 0; d¡_chªÃÈ< 
du£d
; ++dst_channel) {

956 
¢d_pcm_rou‹_‰abË_’Œy_t
 
t
 = 0;

957 
©t
 = 0;

958 
n¤cs
 = 0;

959 
¢d_pcm_rou‹_‰abË_¤c_t
 
¤cs
[
su£d
];

960 
¤c_chªÃl
 = 0; src_chªÃÈ< 
su£d
; ++src_channel) {

961 
¢d_pcm_rou‹_‰abË_’Œy_t
 
v
;

962 
v
 = 
‰abË
[
¤c_chªÃl
 * 
smul
 + 
d¡_chªÃl
 * 
dmul
];

963 ià(
v
 != 0) {

964 
¤cs
[
n¤cs
].
chªÃl
 = 
¤c_chªÃl
;

965 #ià
SND_PCM_PLUGIN_ROUTE_FLOAT


967 
¤cs
[
n¤cs
].
as_št
 = (
v
 =ğ
SND_PCM_PLUGIN_ROUTE_FULL
 ? 
SND_PCM_PLUGIN_ROUTE_RESOLUTION
 : 0);

968 
¤cs
[
n¤cs
].
as_æßt
 = 
v
;

970 
	`as£¹
(
v
 >ğ0 && v <ğ
SND_PCM_PLUGIN_ROUTE_FULL
);

971 
¤cs
[
n¤cs
].
as_št
 = 
v
;

973 ià(
v
 !ğ
SND_PCM_PLUGIN_ROUTE_FULL
)

974 
©t
 = 1;

975 
t
 +ğ
v
;

976 
n¤cs
++;

980 
	`as£¹
(
t
 <ğ
SND_PCM_PLUGIN_ROUTE_FULL
);

982 
d±r
->
©t
 =‡tt;

983 
d±r
->
n¤cs
 =‚srcs;

984 ià(
n¤cs
 == 0)

985 
d±r
->
func
 = 
¢d_pcm_rou‹_cÚv”t1_z”o
;

987 
d±r
->
func
 = 
¢d_pcm_rou‹_cÚv”t1_mªy
;

988 ià(
n¤cs
 > 0) {

989 
d±r
->
¤cs
 = 
	`ÿÎoc
((è
n¤cs
, (*srcs));

990 ià(!
d±r
->
¤cs
)

991  -
ENOMEM
;

992 
	`memıy
(
d±r
->
¤cs
, srcs, (*¤csè* 
n¤cs
);

994 
d±r
->
¤cs
 = 0;

995 
d±r
++;

998 
	}
}

1017 
	$¢d_pcm_rou‹_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1018 
¢d_pcm_fÜm©_t
 
sfÜm©
, 
schªÃls
,

1019 
¢d_pcm_rou‹_‰abË_’Œy_t
 *
‰abË
,

1020 
‰_ssize
,

1021 
‰_cu£d
, 
‰_su£d
,

1022 
¢d_pcm_t
 *
¦ave
, 
şo£_¦ave
)

1024 
¢d_pcm_t
 *
pcm
;

1025 
¢d_pcm_rou‹_t
 *
rou‹
;

1026 
”r
;

1027 
	`as£¹
(
pcmp
 && 
¦ave
 && 
‰abË
);

1028 ià(
sfÜm©
 !ğ
SND_PCM_FORMAT_UNKNOWN
 &&

1029 
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1)

1030  -
EINVAL
;

1031 
rou‹
 = 
	`ÿÎoc
(1, (
¢d_pcm_rou‹_t
));

1032 ià(!
rou‹
) {

1033  -
ENOMEM
;

1035 
	`¢d_pcm_¶ugš_š™
(&
rou‹
->
¶ug
);

1036 
rou‹
->
sfÜm©
 = sformat;

1037 
rou‹
->
schªÃls
 = schannels;

1038 
rou‹
->
¶ug
.
»ad
 = 
¢d_pcm_rou‹_»ad_¬—s
;

1039 
rou‹
->
¶ug
.
wr™e
 = 
¢d_pcm_rou‹_wr™e_¬—s
;

1040 
rou‹
->
¶ug
.
undo_»ad
 = 
¢d_pcm_¶ugš_undo_»ad_g’”ic
;

1041 
rou‹
->
¶ug
.
undo_wr™e
 = 
¢d_pcm_¶ugš_undo_wr™e_g’”ic
;

1042 
rou‹
->
¶ug
.
g’
.
¦ave
 = slave;

1043 
rou‹
->
¶ug
.
g’
.
şo£_¦ave
 = close_slave;

1044 
rou‹
->
¶ug
.
š™
 = 
rou‹_chm­_š™
;

1046 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_ROUTE
, 
Çme
, 
¦ave
->
¡»am
, sÏve->
mode
);

1047 ià(
”r
 < 0) {

1048 
	`ä“
(
rou‹
);

1049  
”r
;

1051 
pcm
->
İs
 = &
¢d_pcm_rou‹_İs
;

1052 
pcm
->
ç¡_İs
 = &
¢d_pcm_¶ugš_ç¡_İs
;

1053 
pcm
->
´iv©e_d©a
 = 
rou‹
;

1054 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

1055 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

1056 
pcm
->
t¡amp_ty³
 = 
¦ave
->tstamp_type;

1057 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
rou‹
->
¶ug
.
hw_±r
, -1, 0);

1058 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
rou‹
->
¶ug
.
­¶_±r
, -1, 0);

1059 
”r
 = 
	`rou‹_lßd_‰abË
(&
rou‹
->
·¿ms
, 
pcm
->
¡»am
, 
‰_ssize
, 
‰abË
, 
‰_cu£d
, 
‰_su£d
);

1060 ià(
”r
 < 0) {

1061 
	`¢d_pcm_şo£
(
pcm
);

1062  
”r
;

1064 *
pcmp
 = 
pcm
;

1067 
	}
}

1069 
	$_¢d_pcm_rou‹_d‘”mše_‰abË
(
¢d_cÚfig_t
 *
‰
,

1070 *
‰_csize
,

1071 *
‰_ssize
,

1072 
¢d_pcm_chm­_t
 *
chm­
)

1074 
¢d_cÚfig_™”©Ü_t
 
i
, 
šext
;

1075 
csize
 = 0, 
ssize
 = 0;

1076 
”r
;

1078 
	`as£¹
(
‰
 && 
‰_csize
 && 
‰_ssize
);

1079 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
šext
, 
‰
) {

1080 
¢d_cÚfig_t
 *
š
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1081 
¢d_cÚfig_™”©Ü_t
 
j
, 
jÃxt
;

1082 
cchªÃl
;

1083 cÚ¡ *
id
;

1084 ià(
	`¢d_cÚfig_g‘_id
(
š
, &
id
) < 0)

1086 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
cchªÃl
);

1087 ià(
”r
 < 0) {

1088 
	`SNDERR
("Inv®id cl›Á chªÃl: %s", 
id
);

1089  -
EINVAL
;

1091 ià(
cchªÃl
 + 1 > 
csize
)

1092 
csize
 = 
cchªÃl
 + 1;

1093 ià(
	`¢d_cÚfig_g‘_ty³
(
š
è!ğ
SND_CONFIG_TYPE_COMPOUND
)

1094  -
EINVAL
;

1095 
	`¢d_cÚfig_fÜ_—ch
(
j
, 
jÃxt
, 
š
) {

1096 
¢d_cÚfig_t
 *
jnode
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
j
);

1097 
schªÃl
;

1098 cÚ¡ *
id
;

1099 ià(
	`¢d_cÚfig_g‘_id
(
jnode
, &
id
) < 0)

1101 
”r
 = 
	`¡¹ochªÃl
(
id
, 
chm­
, &
schªÃl
, 1);

1102 ià(
”r
 < 0) {

1103 
	`SNDERR
("Inv®id sÏvchªÃl: %s", 
id
);

1104  -
EINVAL
;

1106 ià(
schªÃl
 + 1 > 
ssize
)

1107 
ssize
 = 
schªÃl
 + 1;

1110 ià(
csize
 =ğ0 || 
ssize
 == 0) {

1111 
	`SNDERR
("Invalid‚ulltable configuration");

1112  -
EINVAL
;

1114 *
‰_csize
 = 
csize
;

1115 *
‰_ssize
 = 
ssize
;

1117 
	}
}

1126 
	$¢d_pcm_rou‹_d‘”mše_‰abË
(
¢d_cÚfig_t
 *
‰
,

1127 *
‰_csize
,

1128 *
‰_ssize
)

1130  
	`_¢d_pcm_rou‹_d‘”mše_‰abË
(
‰
, 
‰_csize
, 
‰_ssize
, 
NULL
);

1131 
	}
}

1144 
	$_¢d_pcm_rou‹_lßd_‰abË
(
¢d_cÚfig_t
 *
‰
, 
¢d_pcm_rou‹_‰abË_’Œy_t
 *
‰abË
,

1145 
‰_csize
, 
‰_ssize
,

1146 *
‰_cu£d
, *
‰_su£d
,

1147 
schªÃls
, 
¢d_pcm_chm­_t
 *
chm­
)

1149 
cu£d
 = -1;

1150 
su£d
 = -1;

1151 
¢d_cÚfig_™”©Ü_t
 
i
, 
šext
;

1152 
k
;

1153 
”r
;

1155 *
scha
 = 
	`®loÿ
(
‰_ssize
 * ());

1156 ià(
scha
 =ğ
NULL
)

1157  -
ENOMEM
;

1159 
k
 = 0; k < 
‰_csize
 * 
‰_ssize
; ++k)

1160 
‰abË
[
k
] = 0.0;

1161 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
šext
, 
‰
) {

1162 
¢d_cÚfig_t
 *
š
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1163 
¢d_cÚfig_™”©Ü_t
 
j
, 
jÃxt
;

1164 
cchªÃl
;

1165 cÚ¡ *
id
;

1166 ià(
	`¢d_cÚfig_g‘_id
(
š
, &
id
) < 0)

1168 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
cchªÃl
);

1169 ià(
”r
 < 0 ||

1170 
cchªÃl
 < 0 || (ècchªÃÈ> 
‰_csize
) {

1171 
	`SNDERR
("Inv®id cl›Á chªÃl: %s", 
id
);

1172  -
EINVAL
;

1174 ià(
	`¢d_cÚfig_g‘_ty³
(
š
è!ğ
SND_CONFIG_TYPE_COMPOUND
)

1175  -
EINVAL
;

1176 
	`¢d_cÚfig_fÜ_—ch
(
j
, 
jÃxt
, 
š
) {

1177 
¢d_cÚfig_t
 *
jnode
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
j
);

1178 
v®ue
;

1179 
ss
;

1180 cÚ¡ *
id
;

1181 ià(
	`¢d_cÚfig_g‘_id
(
jnode
, &
id
) < 0)

1184 
ss
 = 
	`¡¹ochªÃl
(
id
, 
chm­
, 
scha
, 
‰_ssize
);

1185 ià(
ss
 < 0) {

1186 
	`SNDERR
("Inv®id sÏvchªÃl: %s", 
id
);

1187  -
EINVAL
;

1190 
”r
 = 
	`¢d_cÚfig_g‘_œ—l
(
jnode
, &
v®ue
);

1191 ià(
”r
 < 0) {

1192 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1193  -
EINVAL
;

1196 
k
 = 0; (èk < 
ss
; k++) {

1197 
schªÃl
 = 
scha
[
k
];

1198 ià(
schªÃl
 < 0 || (èschªÃÈ> 
‰_ssize
 ||

1199 (
schªÃls
 > 0 && 
schªÃl
 >= schannels)) {

1200 
	`SNDERR
("Inv®id sÏvchªÃl: %s", 
id
);

1201  -
EINVAL
;

1203 
‰abË
[
cchªÃl
 * 
‰_ssize
 + 
schªÃl
] = 
v®ue
;

1204 ià(
schªÃl
 > 
su£d
)

1205 
su£d
 = 
schªÃl
;

1208 ià(
cchªÃl
 > 
cu£d
)

1209 
cu£d
 = 
cchªÃl
;

1211 *
‰_su£d
 = 
su£d
 + 1;

1212 *
‰_cu£d
 = 
cu£d
 + 1;

1214 
	}
}

1227 
	$¢d_pcm_rou‹_lßd_‰abË
(
¢d_cÚfig_t
 *
‰
, 
¢d_pcm_rou‹_‰abË_’Œy_t
 *
‰abË
,

1228 
‰_csize
, 
‰_ssize
,

1229 *
‰_cu£d
, *
‰_su£d
,

1230 
schªÃls
)

1232  
	`_¢d_pcm_rou‹_lßd_‰abË
(
‰
, 
‰abË
, 
‰_csize
, 
‰_ssize
,

1233 
‰_cu£d
, 
‰_su£d
, 
schªÃls
, 
NULL
);

1234 
	}
}

1289 
	$_¢d_pcm_rou‹_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1290 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

1291 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

1293 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1294 
”r
;

1295 
¢d_pcm_t
 *
¥cm
;

1296 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

1297 
¢d_pcm_chm­_t
 *
‰_chm­
 = 
NULL
, *
chm­
 = NULL;

1298 
¢d_pcm_fÜm©_t
 
sfÜm©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1299 
schªÃls
 = -1;

1300 
¢d_cÚfig_t
 *
‰
 = 
NULL
;

1301 
¢d_pcm_rou‹_‰abË_’Œy_t
 *
‰abË
 = 
NULL
;

1302 
csize
, 
ssize
;

1303 
cu£d
, 
su£d
;

1304 
¢d_pcm_chm­_qu”y_t
 **
chm­s
 = 
NULL
;

1305 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1306 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1307 cÚ¡ *
id
;

1308 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1310 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

1312 ià(
	`¡rcmp
(
id
, "slave") == 0) {

1313 
¦ave
 = 
n
;

1316 ià(
	`¡rcmp
(
id
, "ttable") == 0) {

1317 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1318 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1319 
	`¢d_pcm_ä“_chm­s
(
chm­s
);

1320  -
EINVAL
;

1322 
‰
 = 
n
;

1325 ià(
	`¡rcmp
(
id
, "chmap") == 0) {

1326 
chm­s
 = 
	`_¢d_pcm_·r£_cÚfig_chm­s
(
n
);

1327 ià(!
chm­s
) {

1328 
	`SNDERR
("Inv®id chªÃÈm­ fÜ %s", 
id
);

1329  -
EINVAL
;

1333 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

1334  -
EINVAL
;

1336 ià(!
¦ave
) {

1337 
	`SNDERR
("slave is‚ot defined");

1338 
	`¢d_pcm_ä“_chm­s
(
chm­s
);

1339  -
EINVAL
;

1341 ià(!
‰
) {

1342 
	`SNDERR
("ttable is‚ot defined");

1343 
	`¢d_pcm_ä“_chm­s
(
chm­s
);

1344  -
EINVAL
;

1346 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 2,

1347 
SND_PCM_HW_PARAM_FORMAT
, 0, &
sfÜm©
,

1348 
SND_PCM_HW_PARAM_CHANNELS
, 0, &
schªÃls
);

1349 ià(
”r
 < 0) {

1350 
	`¢d_pcm_ä“_chm­s
(
chm­s
);

1351  
”r
;

1353 ià(
sfÜm©
 !ğ
SND_PCM_FORMAT_UNKNOWN
 &&

1354 
	`¢d_pcm_fÜm©_lš—r
(
sfÜm©
) != 1) {

1355 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1356 
	`SNDERR
("slave format is‚ot†inear");

1357 
	`¢d_pcm_ä“_chm­s
(
chm­s
);

1358  -
EINVAL
;

1361 
”r
 = 
	`d‘”mše_chm­
(
‰
, &
‰_chm­
);

1362 ià(
”r
 < 0) {

1363 
	`ä“
(
‰abË
);

1364  
”r
;

1367 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

1368 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1369 ià(
”r
 < 0) {

1370 
	`ä“
(
‰_chm­
);

1371 
	`ä“
(
‰abË
);

1372 
	`¢d_pcm_ä“_chm­s
(
chm­s
);

1373  
”r
;

1376 ià(
‰_chm­
) {

1377 ià(!
chm­s
)

1378 
chm­s
 = 
	`¢d_pcm_qu”y_chm­s
(
¥cm
);

1379 ià(
chm­s
)

1380 
”r
 = 
	`fšd_m©chšg_chm­
(
chm­s
, 
‰_chm­
, &
chm­
,

1381 &
schªÃls
);

1382 
	`ä“
(
‰_chm­
);

1383 ià(
chm­s
 && 
”r
 < 0) {

1384 
	`¢d_pcm_ä“_chm­s
(
chm­s
);

1385 
	`¢d_pcm_şo£
(
¥cm
);

1386  
”r
;

1390 
”r
 = 
	`_¢d_pcm_rou‹_d‘”mše_‰abË
(
‰
, &
csize
, &
ssize
, 
chm­
);

1391 ià(
”r
 < 0) {

1392 
	`ä“
(
chm­
);

1393 
	`¢d_pcm_ä“_chm­s
(
chm­s
);

1394 
	`¢d_pcm_şo£
(
¥cm
);

1395  
”r
;

1397 
‰abË
 = 
	`m®loc
(
csize
 * 
ssize
 * (
¢d_pcm_rou‹_‰abË_’Œy_t
));

1398 ià(
‰abË
 =ğ
NULL
) {

1399 
	`ä“
(
chm­
);

1400 
	`¢d_pcm_ä“_chm­s
(
chm­s
);

1401 
	`¢d_pcm_şo£
(
¥cm
);

1402  -
ENOMEM
;

1404 
”r
 = 
	`_¢d_pcm_rou‹_lßd_‰abË
(
‰
, 
‰abË
, 
csize
, 
ssize
,

1405 &
cu£d
, &
su£d
, 
schªÃls
, 
chm­
);

1406 ià(
”r
 < 0) {

1407 
	`ä“
(
chm­
);

1408 
	`ä“
(
‰abË
);

1409 
	`¢d_pcm_ä“_chm­s
(
chm­s
);

1410 
	`¢d_pcm_şo£
(
¥cm
);

1411  
”r
;

1414 
”r
 = 
	`¢d_pcm_rou‹_İ’
(
pcmp
, 
Çme
, 
sfÜm©
, 
schªÃls
,

1415 
‰abË
, 
ssize
,

1416 
cu£d
, 
su£d
,

1417 
¥cm
, 1);

1418 
	`ä“
(
‰abË
);

1419 ià(
”r
 < 0) {

1420 
	`ä“
(
chm­
);

1421 
	`¢d_pcm_ä“_chm­s
(
chm­s
);

1422 
	`¢d_pcm_şo£
(
¥cm
);

1424 
¢d_pcm_rou‹_t
 *
rou‹
 = (*
pcmp
)->
´iv©e_d©a
;

1426 
rou‹
->
chm­
 = chmap;

1427 
rou‹
->
chm­_ov”ride
 = 
chm­s
;

1430  
”r
;

1431 
	}
}

1432 #iâdeà
DOC_HIDDEN


1433 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_rou‹_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_share.c

29 
	~"pcm_loÿl.h
"

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<lim™s.h
>

33 
	~<uni¡d.h
>

34 
	~<¡ršg.h
>

35 
	~<sigÇl.h
>

36 
	~<m©h.h
>

37 
	~<sys/sock‘.h
>

38 
	~<pŞl.h
>

39 
	~<±h»ad.h
>

41 #iâdeà
PIC


43 cÚ¡ *
	g_¢d_moduË_pcm_sh¬e
 = "";

46 #iâdeà
DOC_HIDDEN


48 
LIST_HEAD
(
¢d_pcm_sh¬e_¦aves
);

49 
±h»ad_mu‹x_t
 
	g¢d_pcm_sh¬e_¦aves_mu‹x
 = 
PTHREAD_MUTEX_INITIALIZER
;

51 #ifdeà
MUTEX_DEBUG


52 
	#Pth»ad_mu‹x_lock
(
mu‹x
) \

53 *
¢d_pcm_sh¬e_¦aves_mu‹x_hŞd”
;

	)

55 
	g”r
 = 
±h»ad_mu‹x_Œylock
(
mu‹x
); \

56 ià(
	g”r
 < 0) { \

57 
årštf
(
¡d”r
, "lock " #mu‹x " i busy (%s): wa™šg iÀ" 
__func__
 "\n", *(
mu‹x
##
_hŞd”
)); \

58 
±h»ad_mu‹x_lock
(
mu‹x
); \

59 
årštf
(
¡d”r
, "... got\n"); \

61 *(
	gmu‹x
##
	g_hŞd”
èğ
__func__
; \

64 
	#Pth»ad_mu‹x_uÆock
(
mu‹x
) \

66 *(
mu‹x
##
_hŞd”
) = 0; \

67 
	`±h»ad_mu‹x_uÆock
(
mu‹x
); \

68 
	}
} 0)

	)

70 
	#Pth»ad_mu‹x_lock
(
mu‹x
è
	`±h»ad_mu‹x_lock
(mu‹x)

	)

71 
	#Pth»ad_mu‹x_uÆock
(
mu‹x
è
	`±h»ad_mu‹x_uÆock
(mu‹x)

	)

75 
li¡_h—d
 
	mş›Ás
;

76 
li¡_h—d
 
	mli¡
;

77 
¢d_pcm_t
 *
	mpcm
;

78 
¢d_pcm_fÜm©_t
 
	mfÜm©
;

79 
	m¿‹
;

80 
	mchªÃls
;

81 
¢d_pcm_säames_t
 
	m³riod_time
;

82 
¢d_pcm_säames_t
 
	mbufãr_time
;

83 
	mİ’_couÁ
;

84 
	m£tup_couÁ
;

85 
	m´•¬ed_couÁ
;

86 
	mruÂšg_couÁ
;

87 
¢d_pcm_uäames_t
 
	m§ãty_th»shŞd
;

88 
¢d_pcm_uäames_t
 
	ms’û_äames
;

89 
¢d_pcm_sw_·¿ms_t
 
	msw_·¿ms
;

90 
¢d_pcm_uäames_t
 
	mhw_±r
;

91 
	mpŞl
[2];

92 
	mpŞlšg
;

93 
±h»ad_t
 
	mth»ad
;

94 
±h»ad_mu‹x_t
 
	mmu‹x
;

95 #ifdeà
MUTEX_DEBUG


96 *
	mmu‹x_hŞd”
;

98 
±h»ad_cÚd_t
 
	mpŞl_cÚd
;

99 } 
	t¢d_pcm_sh¬e_¦ave_t
;

102 
li¡_h—d
 
	mli¡
;

103 
¢d_pcm_t
 *
	mpcm
;

104 
¢d_pcm_sh¬e_¦ave_t
 *
	m¦ave
;

105 
	mchªÃls
;

106 *
	m¦ave_chªÃls
;

107 
	md¿š_s’ûd
;

108 
¢d_htime¡amp_t
 
	mŒigg”_t¡amp
;

109 
¢d_pcm_¡©e_t
 
	m¡©e
;

110 
¢d_pcm_uäames_t
 
	mhw_±r
;

111 
¢d_pcm_uäames_t
 
	m­¶_±r
;

112 
	m»ady
;

113 
	mş›Á_sock‘
;

114 
	m¦ave_sock‘
;

115 } 
	t¢d_pcm_sh¬e_t
;

119 
_¢d_pcm_sh¬e_¡İ
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©e_t
 
¡©e
);

121 
¢d_pcm_uäames_t
 
	$¢d_pcm_sh¬e_¦ave_ava
(
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
)

123 
¢d_pcm_säames_t
 
ava
;

124 
¢d_pcm_t
 *
pcm
 = 
¦ave
->pcm;

125 
ava
 = 
¦ave
->
hw_±r
 - *
pcm
->
­¶
.
±r
;

126 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

127 
ava
 +ğ
pcm
->
bufãr_size
;

128 ià(
ava
 < 0)

129 
ava
 +ğ
pcm
->
bound¬y
;

130 ià((
¢d_pcm_uäames_t
è
ava
 >ğ
pcm
->
bound¬y
)

131 
ava
 -ğ
pcm
->
bound¬y
;

132  
ava
;

133 
	}
}

137 
¢d_pcm_uäames_t
 
	$_¢d_pcm_sh¬e_¦ave_fÜw¬d
(
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
)

139 
li¡_h—d
 *
i
;

140 
¢d_pcm_uäames_t
 
bufãr_size
;

141 
¢d_pcm_säames_t
 
äames
, 
§ãty_äames
;

142 
¢d_pcm_säames_t
 
mš_äames
, 
max_äames
;

143 
¢d_pcm_uäames_t
 
ava
, 
¦ave_ava
;

144 
¢d_pcm_uäames_t
 
¦ave_hw_ava
;

145 
¦ave_ava
 = 
	`¢d_pcm_sh¬e_¦ave_ava
(
¦ave
);

146 
bufãr_size
 = 
¦ave
->
pcm
->buffer_size;

147 
mš_äames
 = 
¦ave_ava
;

148 
max_äames
 = 0;

149 
	`li¡_fÜ_—ch
(
i
, &
¦ave
->
ş›Ás
) {

150 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
	`li¡_’Œy
(
i
, snd_pcm_sh¬e_t, 
li¡
);

151 
¢d_pcm_t
 *
pcm
 = 
sh¬e
->pcm;

152 
sh¬e
->
¡©e
) {

153 
SND_PCM_STATE_RUNNING
:

155 
SND_PCM_STATE_DRAINING
:

156 ià(
pcm
->
¡»am
 !ğ
SND_PCM_STREAM_PLAYBACK
)

162 
ava
 = 
	`¢d_pcm_mm­_ava
(
pcm
);

163 
äames
 = 
¦ave_ava
 - 
ava
;

164 ià(
äames
 > 
max_äames
)

165 
max_äames
 = 
äames
;

166 ià(
sh¬e
->
¡©e
 !ğ
SND_PCM_STATE_RUNNING
)

168 ià(
äames
 < 
mš_äames
)

169 
mš_äames
 = 
äames
;

171 ià(
max_äames
 == 0)

173 
äames
 = 
mš_äames
;

175 
¦ave_hw_ava
 = 
bufãr_size
 - 
¦ave_ava
;

176 
§ãty_äames
 = 
¦ave
->
§ãty_th»shŞd
 - 
¦ave_hw_ava
;

177 ià(
§ãty_äames
 > 0 &&

178 
äames
 < 
§ãty_äames
) {

180 ià(
max_äames
 < 
§ãty_äames
)

181 
äames
 = 
max_äames
;

183 
äames
 = 
§ãty_äames
;

185 ià(
äames
 < 0)

187  
äames
;

188 
	}
}

197 
¢d_pcm_uäames_t
 
	$_¢d_pcm_sh¬e_missšg
(
¢d_pcm_t
 *
pcm
)

199 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

200 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

201 
¢d_pcm_t
 *
¥cm
 = 
¦ave
->
pcm
;

202 
¢d_pcm_uäames_t
 
bufãr_size
 = 
¥cm
->buffer_size;

203 
»ady
 = 1, 
ruÂšg
 = 0;

204 
¢d_pcm_uäames_t
 
ava
 = 0, 
¦ave_ava
;

205 
¢d_pcm_säames_t
 
hw_ava
;

206 
¢d_pcm_uäames_t
 
missšg
 = 
INT_MAX
;

207 
¢d_pcm_säames_t
 
»ady_missšg
;

208 
ssize_t
 
s
;

210 
sh¬e
->
¡©e
) {

211 
SND_PCM_STATE_RUNNING
:

213 
SND_PCM_STATE_DRAINING
:

214 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

218  
INT_MAX
;

220 
sh¬e
->
hw_±r
 = 
¦ave
->hw_ptr;

221 
ava
 = 
	`¢d_pcm_mm­_ava
(
pcm
);

222 ià(
ava
 >ğ
pcm
->
¡İ_th»shŞd
) {

223 
	`_¢d_pcm_sh¬e_¡İ
(
pcm
, 
sh¬e
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
 ? 
SND_PCM_STATE_SETUP
 : 
SND_PCM_STATE_XRUN
);

224 
upd©e_pŞl
;

226 
hw_ava
 = 
bufãr_size
 - 
ava
;

227 
¦ave_ava
 = 
	`¢d_pcm_sh¬e_¦ave_ava
(
¦ave
);

228 ià(
ava
 < 
¦ave_ava
) {

230 
¢d_pcm_säames_t
 
¦ave_hw_ava
 = 
bufãr_size
 - 
¦ave_ava
;

231 
¢d_pcm_säames_t
 
§ãty_missšg
 = 
¦ave_hw_ava
 - 
¦ave
->
§ãty_th»shŞd
;

232 ià(
§ãty_missšg
 < 0) {

233 
¢d_pcm_säames_t
 
”r
;

234 
¢d_pcm_säames_t
 
äames
 = 
¦ave_ava
 - 
ava
;

235 ià(-
§ãty_missšg
 <ğ
äames
) {

236 
äames
 = -
§ãty_missšg
;

237 
missšg
 = 1;

239 
”r
 = 
	`¢d_pcm_mm­_comm™
(
¥cm
, 
	`¢d_pcm_mm­_off£t
(¥cm), 
äames
);

240 ià(
”r
 < 0) {

241 
	`SYSMSG
("snd_pcm_mmap_commitƒrror");

242  
INT_MAX
;

244 ià(
”r
 !ğ
äames
)

245 
	`SYSMSG
("comm™„‘uº %ld fÜ siz%ld", 
”r
, 
äames
);

246 
¦ave_ava
 -ğ
”r
;

248 ià(
§ãty_missšg
 == 0)

249 
missšg
 = 1;

251 
missšg
 = 
§ãty_missšg
;

254 
sh¬e
->
¡©e
) {

255 
SND_PCM_STATE_DRAINING
:

256 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

257 ià(
hw_ava
 <= 0) {

258 
	`_¢d_pcm_sh¬e_¡İ
(
pcm
, 
SND_PCM_STATE_SETUP
);

261 ià((
¢d_pcm_uäames_t
)
hw_ava
 < 
missšg
)

262 
missšg
 = 
hw_ava
;

263 
ruÂšg
 = 1;

264 
»ady
 = 0;

267 
SND_PCM_STATE_RUNNING
:

268 ià(
ava
 >ğ
pcm
->
¡İ_th»shŞd
) {

269 
	`_¢d_pcm_sh¬e_¡İ
(
pcm
, 
SND_PCM_STATE_XRUN
);

272 
¢d_pcm_uäames_t
 
xrun_missšg
 = 
pcm
->
¡İ_th»shŞd
 - 
ava
;

273 ià(
missšg
 > 
xrun_missšg
)

274 
missšg
 = 
xrun_missšg
;

276 
»ady_missšg
 = 
pcm
->
ava_mš
 - 
ava
;

277 ià(
»ady_missšg
 > 0) {

278 
»ady
 = 0;

279 ià(
missšg
 > (
¢d_pcm_uäames_t
)
»ady_missšg
)

280 
missšg
 = 
»ady_missšg
;

282 
ruÂšg
 = 1;

285 
	`SNDERR
("šv®id sh¬ed PCM s‹ %d", 
sh¬e
->
¡©e
);

286  
INT_MAX
;

289 
upd©e_pŞl
:

290 ià(
»ady
 !ğ
sh¬e
->ready) {

291 
buf
[1];

293 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

294 ià(
»ady
)

295 
s
 = 
	`»ad
(
sh¬e
->
¦ave_sock‘
, 
buf
, 1);

297 
s
 = 
	`wr™e
(
sh¬e
->
ş›Á_sock‘
, 
buf
, 1);

299 ià(
»ady
)

300 
s
 = 
	`wr™e
(
sh¬e
->
¦ave_sock‘
, 
buf
, 1);

302 
s
 = 
	`»ad
(
sh¬e
->
ş›Á_sock‘
, 
buf
, 1);

304 ià(
s
 < 0) {

305 ià(
”ºo
 =ğ
EINTR
)

307  
INT_MAX
;

311 
sh¬e
->
»ady
 =„eady;

313 ià(!
ruÂšg
)

314  
INT_MAX
;

315 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
 &&

316 
sh¬e
->
¡©e
 =ğ
SND_PCM_STATE_DRAINING
 &&

317 !
sh¬e
->
d¿š_s’ûd
) {

319 ià(
ava
 >ğ
¦ave
->
s’û_äames
) {

320 
¢d_pcm_uäames_t
 
off£t
 = 
sh¬e
->
­¶_±r
 % 
bufãr_size
;

321 
¢d_pcm_uäames_t
 
xãr
 = 0;

322 
¢d_pcm_uäames_t
 
size
 = 
¦ave
->
s’û_äames
;

323 
xãr
 < 
size
) {

324 
¢d_pcm_uäames_t
 
äames
 = 
size
 - 
xãr
;

325 
¢d_pcm_uäames_t
 
cÚt
 = 
bufãr_size
 - 
off£t
;

326 ià(
cÚt
 < 
äames
)

327 
äames
 = 
cÚt
;

328 
	`¢d_pcm_¬—s_s’û
(
pcm
->
ruÂšg_¬—s
, 
off£t
,…cm->
chªÃls
, 
äames
,…cm->
fÜm©
);

329 
off£t
 +ğ
äames
;

330 ià(
off£t
 >ğ
bufãr_size
)

331 
off£t
 = 0;

332 
xãr
 +ğ
äames
;

334 
sh¬e
->
d¿š_s’ûd
 = 1;

336 
¢d_pcm_uäames_t
 
s’û_missšg
;

337 
s’û_missšg
 = 
¦ave
->
s’û_äames
 - 
ava
;

338 ià(
s’û_missšg
 < 
missšg
)

339 
missšg
 = 
s’û_missšg
;

343  
missšg
;

344 
	}
}

346 
¢d_pcm_uäames_t
 
	$_¢d_pcm_sh¬e_¦ave_missšg
(
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
)

348 
¢d_pcm_uäames_t
 
missšg
 = 
INT_MAX
;

349 
li¡_h—d
 *
i
;

350  
	`¢d_pcm_ava_upd©e
(
¦ave
->
pcm
);

351 
¦ave
->
hw_±r
 = *¦ave->
pcm
->
hw
.
±r
;

352 
	`li¡_fÜ_—ch
(
i
, &
¦ave
->
ş›Ás
) {

353 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
	`li¡_’Œy
(
i
, snd_pcm_sh¬e_t, 
li¡
);

354 
¢d_pcm_t
 *
pcm
 = 
sh¬e
->pcm;

355 
¢d_pcm_uäames_t
 
m
 = 
	`_¢d_pcm_sh¬e_missšg
(
pcm
);

356 ià(
m
 < 
missšg
)

357 
missšg
 = 
m
;

359  
missšg
;

360 
	}
}

362 *
	$¢d_pcm_sh¬e_th»ad
(*
d©a
)

364 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
d©a
;

365 
¢d_pcm_t
 *
¥cm
 = 
¦ave
->
pcm
;

366 
pŞlfd
 
pfd
[2];

367 
”r
;

369 
pfd
[0].
fd
 = 
¦ave
->
pŞl
[0];

370 
pfd
[0].
ev’ts
 = 
POLLIN
;

371 
”r
 = 
	`¢d_pcm_pŞl_desütÜs
(
¥cm
, &
pfd
[1], 1);

372 ià(
”r
 != 1) {

373 
	`SNDERR
("šv®id…ŞÈdesütÜ %d", 
”r
);

374  
NULL
;

376 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

377 
”r
 = 
	`pe
(
¦ave
->
pŞl
);

378 ià(
”r
 < 0) {

379 
	`SYSERR
("can't create‡…ipe");

380 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

381  
NULL
;

383 
¦ave
->
İ’_couÁ
 > 0) {

384 
¢d_pcm_uäames_t
 
missšg
;

386 
missšg
 = 
	`_¢d_pcm_sh¬e_¦ave_missšg
(
¦ave
);

388 ià(
missšg
 < 
INT_MAX
) {

389 
¢d_pcm_uäames_t
 
hw_±r
;

390 
¢d_pcm_säames_t
 
ava_mš
;

391 
hw_±r
 = 
¦ave
->hw_±¸+ 
missšg
;

392 
hw_±r
 +ğ
¥cm
->
³riod_size
 - 1;

393 ià(
hw_±r
 >ğ
¥cm
->
bound¬y
)

394 
hw_±r
 -ğ
¥cm
->
bound¬y
;

395 
hw_±r
 -ğhw_±¸% 
¥cm
->
³riod_size
;

396 
ava_mš
 = 
hw_±r
 - *
¥cm
->
­¶
.
±r
;

397 ià(
¥cm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

398 
ava_mš
 +ğ
¥cm
->
bufãr_size
;

399 ià(
ava_mš
 < 0)

400 
ava_mš
 +ğ
¥cm
->
bound¬y
;

402 ià((
¢d_pcm_uäames_t
)
ava_mš
 !ğ
¥cm
->avail_min) {

403 
	`¢d_pcm_sw_·¿ms_£t_ava_mš
(
¥cm
, &
¦ave
->
sw_·¿ms
, 
ava_mš
);

404 
”r
 = 
	`¢d_pcm_sw_·¿ms
(
¥cm
, &
¦ave
->
sw_·¿ms
);

405 ià(
”r
 < 0) {

406 
	`SYSERR
("snd_pcm_sw_paramsƒrror");

407 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

408  
NULL
;

411 
¦ave
->
pŞlšg
 = 1;

412 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

413 
”r
 = 
	`pŞl
(
pfd
, 2, -1);

414 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

415 ià(
pfd
[0].
»v’ts
 & 
POLLIN
) {

416 
buf
[1];

417 
	`»ad
(
pfd
[0].
fd
, 
buf
, 1);

420 
¦ave
->
pŞlšg
 = 0;

421 
	`±h»ad_cÚd_wa™
(&
¦ave
->
pŞl_cÚd
, &¦ave->
mu‹x
);

424 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

425  
NULL
;

426 
	}
}

428 
	$_¢d_pcm_sh¬e_upd©e
(
¢d_pcm_t
 *
pcm
)

430 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

431 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

432 
¢d_pcm_t
 *
¥cm
 = 
¦ave
->
pcm
;

433 
¢d_pcm_uäames_t
 
missšg
;

434  
	`¢d_pcm_ava_upd©e
(
¥cm
);

435 
¦ave
->
hw_±r
 = *¦ave->
pcm
->
hw
.
±r
;

436 
missšg
 = 
	`_¢d_pcm_sh¬e_missšg
(
pcm
);

438 ià(!
¦ave
->
pŞlšg
) {

439 
	`±h»ad_cÚd_sigÇl
(&
¦ave
->
pŞl_cÚd
);

442 ià(
missšg
 < 
INT_MAX
) {

443 
¢d_pcm_uäames_t
 
hw_±r
;

444 
¢d_pcm_säames_t
 
ava_mš
;

445 
hw_±r
 = 
¦ave
->hw_±¸+ 
missšg
;

446 
hw_±r
 +ğ
¥cm
->
³riod_size
 - 1;

447 ià(
hw_±r
 >ğ
¥cm
->
bound¬y
)

448 
hw_±r
 -ğ
¥cm
->
bound¬y
;

449 
hw_±r
 -ğhw_±¸% 
¥cm
->
³riod_size
;

450 
ava_mš
 = 
hw_±r
 - *
¥cm
->
­¶
.
±r
;

451 ià(
¥cm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

452 
ava_mš
 +ğ
¥cm
->
bufãr_size
;

453 ià(
ava_mš
 < 0)

454 
ava_mš
 +ğ
¥cm
->
bound¬y
;

455 ià((
¢d_pcm_uäames_t
)
ava_mš
 < 
¥cm
->avail_min) {

456 
”r
;

457 
	`¢d_pcm_sw_·¿ms_£t_ava_mš
(
¥cm
, &
¦ave
->
sw_·¿ms
, 
ava_mš
);

458 
”r
 = 
	`¢d_pcm_sw_·¿ms
(
¥cm
, &
¦ave
->
sw_·¿ms
);

459 ià(
”r
 < 0) {

460 
	`SYSERR
("snd_pcm_sw_paramsƒrror");

465 
	}
}

467 
	$¢d_pcm_sh¬e_nÚblock
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
nÚblock
 ATTRIBUTE_UNUSED)

470 
	}
}

472 
	$¢d_pcm_sh¬e_async
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
sig
 ATTRIBUTE_UNUSED, 
pid_t
 
pid
 ATTRIBUTE_UNUSED)

474  -
ENOSYS
;

475 
	}
}

477 
	$¢d_pcm_sh¬e_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_šfo_t
 *
šfo
)

479 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

480  
	`¢d_pcm_šfo
(
sh¬e
->
¦ave
->
pcm
, 
šfo
);

481 
	}
}

483 
	$¢d_pcm_sh¬e_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

485 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

486 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

487 
¢d_pcm_acûss_mask_t
 
acûss_mask
;

488 
”r
;

489 
	`¢d_pcm_acûss_mask_ªy
(&
acûss_mask
);

490 
	`¢d_pcm_acûss_mask_»£t
(&
acûss_mask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

491 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

492 &
acûss_mask
);

493 ià(
”r
 < 0)

494  
”r
;

495 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t
(
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
,

496 
sh¬e
->
chªÃls
, 0);

497 ià(
”r
 < 0)

498  
”r
;

499 ià(
¦ave
->
fÜm©
 !ğ
SND_PCM_FORMAT_UNKNOWN
) {

500 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
·¿ms
, 
¦ave
->
fÜm©
);

501 ià(
”r
 < 0)

502  
”r
;

505 ià(
¦ave
->
¿‹
 >= 0) {

506 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
,

507 
¦ave
->
¿‹
, 0);

508 ià(
”r
 < 0)

509  
”r
;

511 ià(
¦ave
->
³riod_time
 >= 0) {

512 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
,

513 
¦ave
->
³riod_time
, 0);

514 ià(
”r
 < 0)

515  
”r
;

517 ià(
¦ave
->
bufãr_time
 >= 0) {

518 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
,

519 
¦ave
->
bufãr_time
, 0);

520 ià(
”r
 < 0)

521  
”r
;

523 
·¿ms
->
šfo
 |ğ
SND_PCM_INFO_DOUBLE
;

525 
	}
}

527 
	$¢d_pcm_sh¬e_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

529 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

530 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

531 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

532 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

533 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

534 &
§cûss_mask
);

535 
	`_¢d_pcm_hw_·¿m_£t
(
¥¬ams
, 
SND_PCM_HW_PARAM_CHANNELS
,

536 
¦ave
->
chªÃls
, 0);

538 
	}
}

540 
	$¢d_pcm_sh¬e_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

541 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

543 
”r
;

544 
lšks
 = (
SND_PCM_HW_PARBIT_FORMAT
 |

545 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

546 
SND_PCM_HW_PARBIT_RATE
 |

547 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

548 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

549 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

550 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

551 
SND_PCM_HW_PARBIT_PERIODS
);

552 cÚ¡ 
¢d_pcm_acûss_mask_t
 *
acûss_mask
 = 
	`¢d_pcm_hw_·¿m_g‘_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
);

553 ià(!
	`¢d_pcm_acûss_mask_‹¡
(
acûss_mask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
) &&

554 !
	`¢d_pcm_acûss_mask_‹¡
(
acûss_mask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
) &&

555 !
	`¢d_pcm_acûss_mask_‹¡
(
acûss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
)) {

556 
¢d_pcm_acûss_mask_t
 
§cûss_mask
;

557 
	`¢d_pcm_acûss_mask_ªy
(&
§cûss_mask
);

558 
	`¢d_pcm_acûss_mask_»£t
(&
§cûss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

559 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

560 &
§cûss_mask
);

561 ià(
”r
 < 0)

562  
”r
;

564 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

565 ià(
”r
 < 0)

566  
”r
;

568 
	}
}

570 
	$¢d_pcm_sh¬e_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

571 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

573 
”r
;

574 
lšks
 = (
SND_PCM_HW_PARBIT_FORMAT
 |

575 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

576 
SND_PCM_HW_PARBIT_RATE
 |

577 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

578 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

579 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

580 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

581 
SND_PCM_HW_PARBIT_PERIODS
);

582 
¢d_pcm_acûss_mask_t
 
acûss_mask
;

583 cÚ¡ 
¢d_pcm_acûss_mask_t
 *
§cûss_mask
 = 
	`¢d_pcm_hw_·¿m_g‘_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
);

584 
	`¢d_pcm_acûss_mask_ªy
(&
acûss_mask
);

585 
	`¢d_pcm_acûss_mask_»£t
(&
acûss_mask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

586 ià(!
	`¢d_pcm_acûss_mask_‹¡
(
§cûss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
))

587 
	`¢d_pcm_acûss_mask_»£t
(&
acûss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

588 ià(!
	`¢d_pcm_acûss_mask_‹¡
(
§cûss_mask
, 
SND_PCM_ACCESS_MMAP_COMPLEX
) &&

589 !
	`¢d_pcm_acûss_mask_‹¡
(
§cûss_mask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
))

590 
	`¢d_pcm_acûss_mask_»£t
(&
acûss_mask
, 
SND_PCM_ACCESS_MMAP_COMPLEX
);

591 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

592 &
acûss_mask
);

593 ià(
”r
 < 0)

594  
”r
;

595 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

596 ià(
”r
 < 0)

597  
”r
;

599 
	}
}

601 
	$¢d_pcm_sh¬e_hw_»fše_¦ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

603 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

604  
	`¢d_pcm_hw_»fše
(
sh¬e
->
¦ave
->
pcm
, 
·¿ms
);

605 
	}
}

607 
	$¢d_pcm_sh¬e_hw_·¿ms_¦ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

609 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

610  
	`_¢d_pcm_hw_·¿ms_š‹º®
(
sh¬e
->
¦ave
->
pcm
, 
·¿ms
);

611 
	}
}

613 
	$¢d_pcm_sh¬e_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

615  
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

616 
¢d_pcm_sh¬e_hw_»fše_ı»·»
,

617 
¢d_pcm_sh¬e_hw_»fše_cchªge
,

618 
¢d_pcm_sh¬e_hw_»fše_¥»·»
,

619 
¢d_pcm_sh¬e_hw_»fše_schªge
,

620 
¢d_pcm_sh¬e_hw_»fše_¦ave
);

621 
	}
}

623 
	$¢d_pcm_sh¬e_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

625 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

626 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

627 
¢d_pcm_t
 *
¥cm
 = 
¦ave
->
pcm
;

628 
”r
 = 0;

629 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

630 ià(
¦ave
->
£tup_couÁ
) {

631 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
·¿ms
, 
¥cm
->
fÜm©
);

632 ià(
”r
 < 0)

633 
_”r
;

634 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
·¿ms
, 
¥cm
->
subfÜm©
);

635 ià(
”r
 < 0)

636 
_”r
;

637 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mšmax
(
·¿ms
, 
SND_PCM_HW_PARAM_RATE
,

638 
¥cm
->
¿‹
, 0,

639 
¥cm
->
¿‹
, 1);

640 ià(
”r
 < 0)

641 
_”r
;

642 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mšmax
(
·¿ms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
,

643 
¥cm
->
³riod_time
, 0,

644 
¥cm
->
³riod_time
, 1);

645 ià(
”r
 < 0)

646 
_”r
;

647 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t
(
·¿ms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

648 
¥cm
->
bufãr_size
, 0);

649 
_”r
:

650 ià(
”r
 < 0) {

651 
	`SNDERR
("slave is‡lready„unning with incompatible setup");

652 
”r
 = -
EBUSY
;

653 
_’d
;

656 
”r
 = 
	`¢d_pcm_hw_·¿ms_¦ave
(
pcm
, 
·¿ms
,

657 
¢d_pcm_sh¬e_hw_»fše_cchªge
,

658 
¢d_pcm_sh¬e_hw_»fše_¥»·»
,

659 
¢d_pcm_sh¬e_hw_»fše_schªge
,

660 
¢d_pcm_sh¬e_hw_·¿ms_¦ave
);

661 ià(
”r
 < 0)

662 
_’d
;

663 
	`¢d_pcm_sw_·¿ms_cu¼’t
(
¦ave
->
pcm
, &¦ave->
sw_·¿ms
);

665 
¦ave
->
§ãty_th»shŞd
 = sÏve->
pcm
->
¿‹
 * 30 / 1000;

666 
¦ave
->
§ãty_th»shŞd
 +ğ¦ave->
pcm
->
³riod_size
 - 1;

667 
¦ave
->
§ãty_th»shŞd
 -ğ¦ave->§ãty_th»shŞd % sÏve->
pcm
->
³riod_size
;

668 
¦ave
->
s’û_äames
 = sÏve->
§ãty_th»shŞd
;

669 ià(
¦ave
->
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

670 
	`¢d_pcm_¬—s_s’û
(
¦ave
->
pcm
->
ruÂšg_¬—s
, 0, sÏve->pcm->
chªÃls
, sÏve->pcm->
bufãr_size
, sÏve->pcm->
fÜm©
);

672 
sh¬e
->
¡©e
 = 
SND_PCM_STATE_SETUP
;

673 
¦ave
->
£tup_couÁ
++;

674 
_’d
:

675 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

676  
”r
;

677 
	}
}

679 
	$¢d_pcm_sh¬e_hw_ä“
(
¢d_pcm_t
 *
pcm
)

681 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

682 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

683 
”r
 = 0;

684 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

685 
¦ave
->
£tup_couÁ
--;

686 ià(
¦ave
->
£tup_couÁ
 == 0)

687 
”r
 = 
	`¢d_pcm_hw_ä“
(
¦ave
->
pcm
);

688 
sh¬e
->
¡©e
 = 
SND_PCM_STATE_OPEN
;

689 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

690  
”r
;

691 
	}
}

693 
	$¢d_pcm_sh¬e_sw_·¿ms
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_·¿ms_t
 *
·¿ms
 ATTRIBUTE_UNUSED)

696 
	}
}

698 
	$¢d_pcm_sh¬e_¡©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©us_t
 *
¡©us
)

700 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

701 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

702 
”r
 = 0;

703 
¢d_pcm_säames_t
 
sd
 = 0, 
d
 = 0;

704 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

705 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

706 
¡©us
->
ava
 = 
	`¢d_pcm_mm­_¶ayback_ava
(
pcm
);

707 ià(
sh¬e
->
¡©e
 !ğ
SND_PCM_STATE_RUNNING
 &&

708 
sh¬e
->
¡©e
 !ğ
SND_PCM_STATE_DRAINING
)

709 
_nÙruÂšg
;

710 
d
 = 
pcm
->
bufãr_size
 - 
¡©us
->
ava
;

712 
¡©us
->
ava
 = 
	`¢d_pcm_mm­_ÿ±u»_ava
(
pcm
);

713 ià(
sh¬e
->
¡©e
 !ğ
SND_PCM_STATE_RUNNING
)

714 
_nÙruÂšg
;

715 
d
 = 
¡©us
->
ava
;

717 
”r
 = 
	`¢d_pcm_d–ay
(
¦ave
->
pcm
, &
sd
);

718 ià(
”r
 < 0)

719 
_’d
;

720 
_nÙruÂšg
:

721 
¡©us
->
d–ay
 = 
sd
 + 
d
;

722 
¡©us
->
¡©e
 = 
sh¬e
->state;

723 
¡©us
->
­¶_±r
 = *
pcm
->
­¶
.
±r
;

724 
¡©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

725 
¡©us
->
Œigg”_t¡amp
 = 
sh¬e
->trigger_tstamp;

726 
_’d
:

727 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

728  
”r
;

729 
	}
}

731 
¢d_pcm_¡©e_t
 
	$¢d_pcm_sh¬e_¡©e
(
¢d_pcm_t
 *
pcm
)

733 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

734  
sh¬e
->
¡©e
;

735 
	}
}

737 
	$_¢d_pcm_sh¬e_hwsync
(
¢d_pcm_t
 *
pcm
)

739 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

740 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

741 
sh¬e
->
¡©e
) {

742 
SND_PCM_STATE_XRUN
:

743  -
EPIPE
;

747  
	`¢d_pcm_hwsync
(
¦ave
->
pcm
);

748 
	}
}

750 
	$¢d_pcm_sh¬e_hwsync
(
¢d_pcm_t
 *
pcm
)

752 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

753 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

754 
”r
;

755 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

756 
”r
 = 
	`_¢d_pcm_sh¬e_hwsync
(
pcm
);

757 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

758  
”r
;

759 
	}
}

761 
	$_¢d_pcm_sh¬e_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
)

763 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

764 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

765 
sh¬e
->
¡©e
) {

766 
SND_PCM_STATE_XRUN
:

767  -
EPIPE
;

768 
SND_PCM_STATE_RUNNING
:

770 
SND_PCM_STATE_DRAINING
:

771 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

775  -
EBADFD
;

777  
	`¢d_pcm_d–ay
(
¦ave
->
pcm
, 
d–ayp
);

778 
	}
}

780 
	$¢d_pcm_sh¬e_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
)

782 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

783 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

784 
”r
;

785 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

786 
”r
 = 
	`_¢d_pcm_sh¬e_d–ay
(
pcm
, 
d–ayp
);

787 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

788  
”r
;

789 
	}
}

791 
¢d_pcm_säames_t
 
	$¢d_pcm_sh¬e_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

793 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

794 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

795 
¢d_pcm_säames_t
 
ava
;

796 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

797 ià(
sh¬e
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
) {

798 
ava
 = 
	`¢d_pcm_ava_upd©e
(
¦ave
->
pcm
);

799 ià(
ava
 < 0) {

800 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

801  
ava
;

803 
sh¬e
->
hw_±r
 = *
¦ave
->
pcm
->
hw
.
±r
;

805 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

806 
ava
 = 
	`¢d_pcm_mm­_ava
(
pcm
);

807 ià((
¢d_pcm_uäames_t
)
ava
 > 
pcm
->
bufãr_size
)

808  -
EPIPE
;

809  
ava
;

810 
	}
}

812 
	$¢d_pcm_sh¬e_htime¡amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 *
ava
,

813 
¢d_htime¡amp_t
 *
t¡amp
)

815 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

816 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

817 
”r
;

818 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

819 
”r
 = 
	`¢d_pcm_htime¡amp
(
¦ave
->
pcm
, 
ava
, 
t¡amp
);

820 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

821  
”r
;

822 
	}
}

825 
¢d_pcm_säames_t
 
	$_¢d_pcm_sh¬e_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

826 
¢d_pcm_uäames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

827 
¢d_pcm_uäames_t
 
size
)

829 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

830 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

831 
¢d_pcm_t
 *
¥cm
 = 
¦ave
->
pcm
;

832 
¢d_pcm_säames_t
 
»t
;

833 
¢d_pcm_säames_t
 
äames
;

834 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
 &&

835 
sh¬e
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
) {

836 
äames
 = *
¥cm
->
­¶
.
±r
 - 
sh¬e
->
­¶_±r
;

837 ià(
äames
 > (
¢d_pcm_säames_t
)
pcm
->
bufãr_size
)

838 
äames
 -ğ
pcm
->
bound¬y
;

839 ià(
äames
 < -(
¢d_pcm_säames_t
)
pcm
->
bufãr_size
)

840 
äames
 +ğ
pcm
->
bound¬y
;

841 ià(
äames
 > 0) {

843 
»t
 = 
	`¢d_pcm_»wšd
(
¥cm
, 
äames
);

844 ià(
»t
 < 0)

845  
»t
;

848 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
size
);

849 ià(
sh¬e
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
) {

850 
äames
 = 
	`_¢d_pcm_sh¬e_¦ave_fÜw¬d
(
¦ave
);

851 ià(
äames
 > 0) {

852 
¢d_pcm_säames_t
 
”r
;

853 
”r
 = 
	`¢d_pcm_mm­_comm™
(
¥cm
, 
	`¢d_pcm_mm­_off£t
(¥cm), 
äames
);

854 ià(
”r
 < 0) {

855 
	`SYSMSG
("snd_pcm_mmap_commitƒrror");

856  
”r
;

858 ià(
”r
 !ğ
äames
) {

859 
	`SYSMSG
("comm™„‘uº %ld fÜ siz%ld", 
”r
, 
äames
);

860  
”r
;

863 
	`_¢d_pcm_sh¬e_upd©e
(
pcm
);

865  
size
;

866 
	}
}

868 
¢d_pcm_säames_t
 
	$¢d_pcm_sh¬e_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

869 
¢d_pcm_uäames_t
 
off£t
,

870 
¢d_pcm_uäames_t
 
size
)

872 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

873 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

874 
¢d_pcm_säames_t
 
»t
;

875 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

876 
»t
 = 
	`_¢d_pcm_sh¬e_mm­_comm™
(
pcm
, 
off£t
, 
size
);

877 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

878  
»t
;

879 
	}
}

881 
	$¢d_pcm_sh¬e_´•¬e
(
¢d_pcm_t
 *
pcm
)

883 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

884 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

885 
”r
 = 0;

886 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

887 
sh¬e
->
¡©e
) {

888 
SND_PCM_STATE_OPEN
:

889 
”r
 = -
EBADFD
;

890 
_’d
;

891 
SND_PCM_STATE_RUNNING
:

892 
”r
 = -
EBUSY
;

893 
_’d
;

894 
SND_PCM_STATE_PREPARED
:

895 
”r
 = 0;

896 
_’d
;

900 ià(
¦ave
->
´•¬ed_couÁ
 == 0) {

901 
”r
 = 
	`¢d_pcm_´•¬e
(
¦ave
->
pcm
);

902 ià(
”r
 < 0)

903 
_’d
;

905 
¦ave
->
´•¬ed_couÁ
++;

906 
sh¬e
->
hw_±r
 = 0;

907 
sh¬e
->
­¶_±r
 = 0;

908 
sh¬e
->
¡©e
 = 
SND_PCM_STATE_PREPARED
;

909 
_’d
:

910 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

911  
”r
;

912 
	}
}

914 
	$¢d_pcm_sh¬e_»£t
(
¢d_pcm_t
 *
pcm
)

916 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

917 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

918 
”r
 = 0;

920 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

921 
	`¢d_pcm_¬—s_s’û
(
pcm
->
ruÂšg_¬—s
, 0,…cm->
chªÃls
,…cm->
bufãr_size
,…cm->
fÜm©
);

922 
sh¬e
->
hw_±r
 = *
¦ave
->
pcm
->
hw
.
±r
;

923 
sh¬e
->
­¶_±r
 = sh¬e->
hw_±r
;

924 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

925  
”r
;

926 
	}
}

928 
	$¢d_pcm_sh¬e_¡¬t
(
¢d_pcm_t
 *
pcm
)

930 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

931 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

932 
¢d_pcm_t
 *
¥cm
 = 
¦ave
->
pcm
;

933 
”r
 = 0;

934 ià(
sh¬e
->
¡©e
 !ğ
SND_PCM_STATE_PREPARED
)

935  -
EBADFD
;

936 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

937 
sh¬e
->
¡©e
 = 
SND_PCM_STATE_RUNNING
;

938 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

939 
¢d_pcm_uäames_t
 
hw_ava
 = 
	`¢d_pcm_mm­_¶ayback_hw_ava
(
pcm
);

940 
¢d_pcm_uäames_t
 
xãr
 = 0;

941 ià(
hw_ava
 == 0) {

942 
”r
 = -
EPIPE
;

943 
_’d
;

945 ià(
¦ave
->
ruÂšg_couÁ
) {

946 
¢d_pcm_säames_t
 
sd
;

947 
”r
 = 
	`¢d_pcm_d–ay
(
¥cm
, &
sd
);

948 ià(
”r
 < 0)

949 
_’d
;

950 
”r
 = 
	`¢d_pcm_»wšd
(
¥cm
, 
sd
);

951 ià(
”r
 < 0)

952 
_’d
;

954 
	`as£¹
(
sh¬e
->
hw_±r
 == 0);

955 
sh¬e
->
hw_±r
 = *
¥cm
->
hw
.
±r
;

956 
sh¬e
->
­¶_±r
 = *
¥cm
->
­¶
.
±r
;

957 
xãr
 < 
hw_ava
) {

958 
¢d_pcm_uäames_t
 
äames
 = 
hw_ava
 - 
xãr
;

959 
¢d_pcm_uäames_t
 
off£t
 = 
	`¢d_pcm_mm­_off£t
(
pcm
);

960 
¢d_pcm_uäames_t
 
cÚt
 = 
pcm
->
bufãr_size
 - 
off£t
;

961 ià(
cÚt
 < 
äames
)

962 
äames
 = 
cÚt
;

963 ià(
pcm
->
¡İ³d_¬—s
 !ğ
NULL
)

964 
	`¢d_pcm_¬—s_cİy
(
pcm
->
ruÂšg_¬—s
, 
off£t
,

965 
pcm
->
¡İ³d_¬—s
, 
xãr
,

966 
pcm
->
chªÃls
, 
äames
,

967 
pcm
->
fÜm©
);

968 
xãr
 +ğ
äames
;

970 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
hw_ava
);

971 ià(
¦ave
->
ruÂšg_couÁ
 == 0) {

972 
¢d_pcm_säames_t
 
»s
;

973 
»s
 = 
	`¢d_pcm_mm­_comm™
(
¥cm
, 
	`¢d_pcm_mm­_off£t
(¥cm), 
hw_ava
);

974 ià(
»s
 < 0) {

975 
”r
 = 
»s
;

976 
_’d
;

978 
	`as£¹
((
¢d_pcm_uäames_t
)
»s
 =ğ
hw_ava
);

981 ià(
¦ave
->
ruÂšg_couÁ
 == 0) {

982 
”r
 = 
	`¢d_pcm_¡¬t
(
¥cm
);

983 ià(
”r
 < 0)

984 
_’d
;

986 
¦ave
->
ruÂšg_couÁ
++;

987 
	`_¢d_pcm_sh¬e_upd©e
(
pcm
);

988 
	`g‘time¡amp
(&
sh¬e
->
Œigg”_t¡amp
, 
pcm
->
t¡amp_ty³
);

989 
_’d
:

990 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

991  
”r
;

992 
	}
}

994 
	$¢d_pcm_sh¬e_·u£
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
’abË
 ATTRIBUTE_UNUSED)

996  -
ENOSYS
;

997 
	}
}

999 
	$¢d_pcm_sh¬e_»sume
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1001  -
ENXIO
;

1002 
	}
}

1004 
	$¢d_pcm_sh¬e_chªÃl_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_šfo_t
 *
šfo
)

1006 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

1007 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

1008 
chªÃl
 = 
šfo
->channel;

1009 
c
 = 
sh¬e
->
¦ave_chªÃls
[
chªÃl
];

1010 
”r
;

1011 
šfo
->
chªÃl
 = 
c
;

1012 
”r
 = 
	`¢d_pcm_chªÃl_šfo
(
¦ave
->
pcm
, 
šfo
);

1013 
šfo
->
chªÃl
 = channel;

1014  
”r
;

1015 
	}
}

1017 
¢d_pcm_säames_t
 
	$_¢d_pcm_sh¬e_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

1019 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

1020 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

1021 
¢d_pcm_säames_t
 
n
;

1022 
sh¬e
->
¡©e
) {

1023 
SND_PCM_STATE_RUNNING
:

1025 
SND_PCM_STATE_PREPARED
:

1026 ià(
pcm
->
¡»am
 !ğ
SND_PCM_STREAM_PLAYBACK
)

1027  -
EBADFD
;

1029 
SND_PCM_STATE_DRAINING
:

1030 ià(
pcm
->
¡»am
 !ğ
SND_PCM_STREAM_CAPTURE
)

1031  -
EBADFD
;

1033 
SND_PCM_STATE_XRUN
:

1034  -
EPIPE
;

1036  -
EBADFD
;

1038 
n
 = 
	`¢d_pcm_mm­_hw_ava
(
pcm
);

1039 
	`as£¹
(
n
 >= 0);

1040 ià((
¢d_pcm_uäames_t
)
n
 > 
äames
)

1041 
äames
 = 
n
;

1042 ià(
sh¬e
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
 && 
äames
 > 0) {

1043 
¢d_pcm_säames_t
 
»t
 = 
	`¢d_pcm_»wšd
(
¦ave
->
pcm
, 
äames
);

1044 ià(
»t
 < 0)

1045  
»t
;

1046 
äames
 = 
»t
;

1048 
	`¢d_pcm_mm­_­¶_backw¬d
(
pcm
, 
äames
);

1049 
	`_¢d_pcm_sh¬e_upd©e
(
pcm
);

1050  
n
;

1051 
	}
}

1053 
¢d_pcm_säames_t
 
	$¢d_pcm_sh¬e_»wšdabË
(
¢d_pcm_t
 *
pcm
)

1055 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

1056 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

1057 
¢d_pcm_säames_t
 
»t
;

1058 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

1059 
»t
 = 
	`¢d_pcm_»wšdabË
(
¦ave
->
pcm
);

1060 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

1061  
»t
;

1062 
	}
}

1064 
¢d_pcm_säames_t
 
	$¢d_pcm_sh¬e_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

1066 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

1067 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

1068 
¢d_pcm_säames_t
 
»t
;

1069 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

1070 
»t
 = 
	`_¢d_pcm_sh¬e_»wšd
(
pcm
, 
äames
);

1071 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

1072  
»t
;

1073 
	}
}

1075 
¢d_pcm_säames_t
 
	$_¢d_pcm_sh¬e_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

1077 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

1078 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

1079 
¢d_pcm_säames_t
 
n
;

1080 
sh¬e
->
¡©e
) {

1081 
SND_PCM_STATE_RUNNING
:

1083 
SND_PCM_STATE_PREPARED
:

1084 ià(
pcm
->
¡»am
 !ğ
SND_PCM_STREAM_PLAYBACK
)

1085  -
EBADFD
;

1087 
SND_PCM_STATE_DRAINING
:

1088 ià(
pcm
->
¡»am
 !ğ
SND_PCM_STREAM_CAPTURE
)

1089  -
EBADFD
;

1091 
SND_PCM_STATE_XRUN
:

1092  -
EPIPE
;

1094  -
EBADFD
;

1096 
n
 = 
	`¢d_pcm_mm­_ava
(
pcm
);

1097 ià((
¢d_pcm_uäames_t
)
n
 > 
äames
)

1098 
äames
 = 
n
;

1099 ià(
sh¬e
->
¡©e
 =ğ
SND_PCM_STATE_RUNNING
 && 
äames
 > 0) {

1100 
¢d_pcm_säames_t
 
»t
 = 
	`INTERNAL
(
¢d_pcm_fÜw¬d
)(
¦ave
->
pcm
, 
äames
);

1101 ià(
»t
 < 0)

1102  
»t
;

1103 
äames
 = 
»t
;

1105 
	`¢d_pcm_mm­_­¶_fÜw¬d
(
pcm
, 
äames
);

1106 
	`_¢d_pcm_sh¬e_upd©e
(
pcm
);

1107  
n
;

1108 
	}
}

1110 
¢d_pcm_säames_t
 
	$¢d_pcm_sh¬e_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
)

1112 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

1113 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

1114 
¢d_pcm_säames_t
 
»t
;

1115 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

1116 
»t
 = 
	`¢d_pcm_fÜw¬dabË
(
¦ave
->
pcm
);

1117 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

1118  
»t
;

1119 
	}
}

1121 
¢d_pcm_säames_t
 
	$¢d_pcm_sh¬e_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

1123 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

1124 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

1125 
¢d_pcm_säames_t
 
»t
;

1126 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

1127 
»t
 = 
	`_¢d_pcm_sh¬e_fÜw¬d
(
pcm
, 
äames
);

1128 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

1129  
»t
;

1130 
	}
}

1133 
	$_¢d_pcm_sh¬e_¡İ
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©e_t
 
¡©e
)

1135 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

1136 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

1138 ià(!
pcm
->
mm­_chªÃls
) {

1143 
	`g‘time¡amp
(&
sh¬e
->
Œigg”_t¡amp
, 
pcm
->
t¡amp_ty³
);

1144 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
) {

1145 
	`¢d_pcm_¬—s_cİy
(
pcm
->
¡İ³d_¬—s
, 0,

1146 
pcm
->
ruÂšg_¬—s
, 0,

1147 
pcm
->
chªÃls
,…cm->
bufãr_size
,

1148 
pcm
->
fÜm©
);

1149 } ià(
¦ave
->
ruÂšg_couÁ
 > 1) {

1150 
”r
;

1151 
¢d_pcm_säames_t
 
d–ay
;

1152 
	`¢d_pcm_¬—s_s’û
(
pcm
->
ruÂšg_¬—s
, 0,…cm->
chªÃls
,

1153 
pcm
->
bufãr_size
,…cm->
fÜm©
);

1154 
”r
 = 
	`¢d_pcm_d–ay
(
¦ave
->
pcm
, &
d–ay
);

1155 ià(
”r
 >ğ0 && 
d–ay
 > 0)

1156 
	`¢d_pcm_»wšd
(
¦ave
->
pcm
, 
d–ay
);

1157 
sh¬e
->
d¿š_s’ûd
 = 0;

1159 
sh¬e
->
¡©e
 = state;

1160 
¦ave
->
´•¬ed_couÁ
--;

1161 
¦ave
->
ruÂšg_couÁ
--;

1162 ià(
¦ave
->
ruÂšg_couÁ
 == 0) {

1163 
”r
 = 
	`¢d_pcm_drİ
(
¦ave
->
pcm
);

1164 
	`as£¹
(
”r
 >= 0);

1166 
	}
}

1168 
	$¢d_pcm_sh¬e_d¿š
(
¢d_pcm_t
 *
pcm
)

1170 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

1171 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

1172 
”r
 = 0;

1173 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

1174 
sh¬e
->
¡©e
) {

1175 
SND_PCM_STATE_OPEN
:

1176 
”r
 = -
EBADFD
;

1177 
_’d
;

1178 
SND_PCM_STATE_PREPARED
:

1179 
sh¬e
->
¡©e
 = 
SND_PCM_STATE_SETUP
;

1180 
_’d
;

1181 
SND_PCM_STATE_SETUP
:

1182 
_’d
;

1186 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

1187 
sh¬e
->
¡©e
) {

1188 
SND_PCM_STATE_XRUN
:

1189 
sh¬e
->
¡©e
 = 
SND_PCM_STATE_SETUP
;

1190 
_’d
;

1191 
SND_PCM_STATE_DRAINING
:

1192 
SND_PCM_STATE_RUNNING
:

1193 
sh¬e
->
¡©e
 = 
SND_PCM_STATE_DRAINING
;

1194 
	`_¢d_pcm_sh¬e_upd©e
(
pcm
);

1195 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

1196 ià(!(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
))

1197 
	`¢d_pcm_wa™
(
pcm
, 
SND_PCM_WAIT_DRAIN
);

1200 
	`as£¹
(0);

1204 
sh¬e
->
¡©e
) {

1205 
SND_PCM_STATE_RUNNING
:

1206 
	`_¢d_pcm_sh¬e_¡İ
(
pcm
, 
SND_PCM_STATE_DRAINING
);

1207 
	`_¢d_pcm_sh¬e_upd©e
(
pcm
);

1209 
SND_PCM_STATE_XRUN
:

1210 
SND_PCM_STATE_DRAINING
:

1211 ià(
	`¢d_pcm_mm­_ÿ±u»_ava
(
pcm
) <= 0)

1212 
sh¬e
->
¡©e
 = 
SND_PCM_STATE_SETUP
;

1214 
sh¬e
->
¡©e
 = 
SND_PCM_STATE_DRAINING
;

1217 
	`as£¹
(0);

1221 
_’d
:

1222 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

1223  
”r
;

1224 
	}
}

1226 
	$¢d_pcm_sh¬e_drİ
(
¢d_pcm_t
 *
pcm
)

1228 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

1229 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

1230 
”r
 = 0;

1231 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

1232 
sh¬e
->
¡©e
) {

1233 
SND_PCM_STATE_OPEN
:

1234 
”r
 = -
EBADFD
;

1235 
_’d
;

1236 
SND_PCM_STATE_SETUP
:

1238 
SND_PCM_STATE_DRAINING
:

1239 ià(
pcm
->
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
) {

1240 
sh¬e
->
¡©e
 = 
SND_PCM_STATE_SETUP
;

1244 
SND_PCM_STATE_RUNNING
:

1245 
	`_¢d_pcm_sh¬e_¡İ
(
pcm
, 
SND_PCM_STATE_SETUP
);

1246 
	`_¢d_pcm_sh¬e_upd©e
(
pcm
);

1248 
SND_PCM_STATE_PREPARED
:

1249 
SND_PCM_STATE_XRUN
:

1250 
sh¬e
->
¡©e
 = 
SND_PCM_STATE_SETUP
;

1253 
	`as£¹
(0);

1257 
sh¬e
->
­¶_±r
 = sh¬e->
hw_±r
 = 0;

1258 
_’d
:

1259 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

1260  
”r
;

1261 
	}
}

1263 
	$¢d_pcm_sh¬e_şo£
(
¢d_pcm_t
 *
pcm
)

1265 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

1266 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

1267 
”r
 = 0;

1269 
	`Pth»ad_mu‹x_lock
(&
¢d_pcm_sh¬e_¦aves_mu‹x
);

1270 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

1271 
¦ave
->
İ’_couÁ
--;

1272 ià(
¦ave
->
İ’_couÁ
 == 0) {

1273 
	`±h»ad_cÚd_sigÇl
(&
¦ave
->
pŞl_cÚd
);

1274 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

1275 
”r
 = 
	`±h»ad_još
(
¦ave
->
th»ad
, 0);

1276 
	`as£¹
(
”r
 == 0);

1277 
”r
 = 
	`¢d_pcm_şo£
(
¦ave
->
pcm
);

1278 
	`±h»ad_mu‹x_de¡roy
(&
¦ave
->
mu‹x
);

1279 
	`±h»ad_cÚd_de¡roy
(&
¦ave
->
pŞl_cÚd
);

1280 
	`li¡_d–
(&
¦ave
->
li¡
);

1281 
	`ä“
(
¦ave
);

1282 
	`li¡_d–
(&
sh¬e
->
li¡
);

1284 
	`li¡_d–
(&
sh¬e
->
li¡
);

1285 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

1287 
	`Pth»ad_mu‹x_uÆock
(&
¢d_pcm_sh¬e_¦aves_mu‹x
);

1288 
	`şo£
(
sh¬e
->
ş›Á_sock‘
);

1289 
	`şo£
(
sh¬e
->
¦ave_sock‘
);

1290 
	`ä“
(
sh¬e
->
¦ave_chªÃls
);

1291 
	`ä“
(
sh¬e
);

1292  
”r
;

1293 
	}
}

1295 
	$¢d_pcm_sh¬e_mm­
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1298 
	}
}

1300 
	$¢d_pcm_sh¬e_munm­
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1303 
	}
}

1305 
	$¢d_pcm_sh¬e_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

1307 
¢d_pcm_sh¬e_t
 *
sh¬e
 = 
pcm
->
´iv©e_d©a
;

1308 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
sh¬e
->slave;

1309 
k
;

1310 
	`¢d_ouut_´štf
(
out
, "Share PCM\n");

1311 
	`¢d_ouut_´štf
(
out
, " Channel bindings:\n");

1312 
k
 = 0; k < 
sh¬e
->
chªÃls
; ++k)

1313 
	`¢d_ouut_´štf
(
out
, " %d: %d\n", 
k
, 
sh¬e
->
¦ave_chªÃls
[k]);

1314 ià(
pcm
->
£tup
) {

1315 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

1316 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

1318 
	`¢d_ouut_´štf
(
out
, "Slave: ");

1319 
	`¢d_pcm_dump
(
¦ave
->
pcm
, 
out
);

1320 
	}
}

1322 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_sh¬e_İs
 = {

1323 .
şo£
 = 
¢d_pcm_sh¬e_şo£
,

1324 .
	gšfo
 = 
¢d_pcm_sh¬e_šfo
,

1325 .
	ghw_»fše
 = 
¢d_pcm_sh¬e_hw_»fše
,

1326 .
	ghw_·¿ms
 = 
¢d_pcm_sh¬e_hw_·¿ms
,

1327 .
	ghw_ä“
 = 
¢d_pcm_sh¬e_hw_ä“
,

1328 .
	gsw_·¿ms
 = 
¢d_pcm_sh¬e_sw_·¿ms
,

1329 .
	gchªÃl_šfo
 = 
¢d_pcm_sh¬e_chªÃl_šfo
,

1330 .
	gdump
 = 
¢d_pcm_sh¬e_dump
,

1331 .
	gnÚblock
 = 
¢d_pcm_sh¬e_nÚblock
,

1332 .
	gasync
 = 
¢d_pcm_sh¬e_async
,

1333 .
	gmm­
 = 
¢d_pcm_sh¬e_mm­
,

1334 .
	gmunm­
 = 
¢d_pcm_sh¬e_munm­
,

1337 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_sh¬e_ç¡_İs
 = {

1338 .
¡©us
 = 
¢d_pcm_sh¬e_¡©us
,

1339 .
	g¡©e
 = 
¢d_pcm_sh¬e_¡©e
,

1340 .
	ghwsync
 = 
¢d_pcm_sh¬e_hwsync
,

1341 .
	gd–ay
 = 
¢d_pcm_sh¬e_d–ay
,

1342 .
	g´•¬e
 = 
¢d_pcm_sh¬e_´•¬e
,

1343 .
	g»£t
 = 
¢d_pcm_sh¬e_»£t
,

1344 .
	g¡¬t
 = 
¢d_pcm_sh¬e_¡¬t
,

1345 .
	gdrİ
 = 
¢d_pcm_sh¬e_drİ
,

1346 .
	gd¿š
 = 
¢d_pcm_sh¬e_d¿š
,

1347 .
	g·u£
 = 
¢d_pcm_sh¬e_·u£
,

1348 .
	gwr™ei
 = 
¢d_pcm_mm­_wr™ei
,

1349 .
	gwr™’
 = 
¢d_pcm_mm­_wr™’
,

1350 .
	g»adi
 = 
¢d_pcm_mm­_»adi
,

1351 .
	g»adn
 = 
¢d_pcm_mm­_»adn
,

1352 .
	g»wšdabË
 = 
¢d_pcm_sh¬e_»wšdabË
,

1353 .
	g»wšd
 = 
¢d_pcm_sh¬e_»wšd
,

1354 .
	gfÜw¬dabË
 = 
¢d_pcm_sh¬e_fÜw¬dabË
,

1355 .
	gfÜw¬d
 = 
¢d_pcm_sh¬e_fÜw¬d
,

1356 .
	g»sume
 = 
¢d_pcm_sh¬e_»sume
,

1357 .
	gava_upd©e
 = 
¢d_pcm_sh¬e_ava_upd©e
,

1358 .
	ghtime¡amp
 = 
¢d_pcm_sh¬e_htime¡amp
,

1359 .
	gmm­_comm™
 = 
¢d_pcm_sh¬e_mm­_comm™
,

1381 
	$¢d_pcm_sh¬e_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
, cÚ¡ *
¢ame
,

1382 
¢d_pcm_fÜm©_t
 
sfÜm©
, 
¤©e
,

1383 
schªÃls
,

1384 
¥”iod_time
, 
sbufãr_time
,

1385 
chªÃls
, *
chªÃls_m­
,

1386 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

1388 
¢d_pcm_t
 *
pcm
;

1389 
¢d_pcm_sh¬e_t
 *
sh¬e
;

1390 
”r
;

1391 
li¡_h—d
 *
i
;

1392 
¦ave_m­
[32] = { 0 };

1393 
k
;

1394 
¢d_pcm_sh¬e_¦ave_t
 *
¦ave
 = 
NULL
;

1395 
sd
[2];

1397 
	`as£¹
(
pcmp
);

1398 
	`as£¹
(
chªÃls
 > 0 && 
¢ame
 && 
chªÃls_m­
);

1400 
k
 = 0; k < 
chªÃls
; ++k) {

1401 ià(
chªÃls_m­
[
k
] >ğ(
¦ave_m­
) / (slave_map[0])) {

1402 
	`SNDERR
("Inv®id sÏvchªÃÈ(%dèš bšdšg", 
chªÃls_m­
[
k
]);

1403  -
EINVAL
;

1405 ià(
¦ave_m­
[
chªÃls_m­
[
k
]]) {

1406 
	`SNDERR
("R•—‹d sÏvchªÃÈ(%dèš bšdšg", 
chªÃls_m­
[
k
]);

1407  -
EINVAL
;

1409 
¦ave_m­
[
chªÃls_m­
[
k
]] = 1;

1410 
	`as£¹
(()
chªÃls_m­
[
k
] < 
schªÃls
);

1413 
sh¬e
 = 
	`ÿÎoc
(1, (
¢d_pcm_sh¬e_t
));

1414 ià(!
sh¬e
)

1415  -
ENOMEM
;

1417 
sh¬e
->
chªÃls
 = channels;

1418 
sh¬e
->
¦ave_chªÃls
 = 
	`ÿÎoc
(
chªÃls
, (*share->slave_channels));

1419 ià(!
sh¬e
->
¦ave_chªÃls
) {

1420 
	`ä“
(
sh¬e
);

1421  -
ENOMEM
;

1423 
	`memıy
(
sh¬e
->
¦ave_chªÃls
, 
chªÃls_m­
, 
chªÃls
 * (*share->slave_channels));

1425 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_SHARE
, 
Çme
, 
¡»am
, 
mode
);

1426 ià(
”r
 < 0) {

1427 
	`ä“
(
sh¬e
->
¦ave_chªÃls
);

1428 
	`ä“
(
sh¬e
);

1429  
”r
;

1431 
”r
 = 
	`sock‘·œ
(
AF_LOCAL
, 
SOCK_STREAM
, 0, 
sd
);

1432 ià(
”r
 < 0) {

1433 
	`¢d_pcm_ä“
(
pcm
);

1434 
	`ä“
(
sh¬e
->
¦ave_chªÃls
);

1435 
	`ä“
(
sh¬e
);

1436  -
”ºo
;

1439 ià(
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
) {

1440 
bufsize
 = 1;

1441 
”r
 = 
	`£tsockİt
(
sd
[0], 
SOL_SOCKET
, 
SO_SNDBUF
, &
bufsize
, (bufsize));

1442 ià(
”r
 >= 0) {

1443 
pŞlfd
 
pfd
;

1444 
pfd
.
fd
 = 
sd
[0];

1445 
pfd
.
ev’ts
 = 
POLLOUT
;

1446 (
”r
 = 
	`pŞl
(&
pfd
, 1, 0)) == 1) {

1447 
buf
[1];

1448 
”r
 = 
	`wr™e
(
sd
[0], 
buf
, 1);

1449 
	`as£¹
(
”r
 != 0);

1450 ià(
”r
 != 1)

1455 ià(
”r
 < 0) {

1456 
”r
 = -
”ºo
;

1457 
	`şo£
(
sd
[0]);

1458 
	`şo£
(
sd
[1]);

1459 
	`¢d_pcm_ä“
(
pcm
);

1460 
	`ä“
(
sh¬e
->
¦ave_chªÃls
);

1461 
	`ä“
(
sh¬e
);

1462  
”r
;

1465 
	`Pth»ad_mu‹x_lock
(&
¢d_pcm_sh¬e_¦aves_mu‹x
);

1466 
	`li¡_fÜ_—ch
(
i
, &
¢d_pcm_sh¬e_¦aves
) {

1467 
¢d_pcm_sh¬e_¦ave_t
 *
s
 = 
	`li¡_’Œy
(
i
, snd_pcm_sh¬e_¦ave_t, 
li¡
);

1468 ià(
s
->
pcm
->
Çme
 && 
	`¡rcmp
(s->pcm->Çme, 
¢ame
) == 0) {

1469 
¦ave
 = 
s
;

1473 ià(!
¦ave
) {

1474 
¢d_pcm_t
 *
¥cm
;

1475 
”r
 = 
	`¢d_pcm_İ’
(&
¥cm
, 
¢ame
, 
¡»am
, 
mode
);

1476 ià(
”r
 < 0) {

1477 
	`Pth»ad_mu‹x_uÆock
(&
¢d_pcm_sh¬e_¦aves_mu‹x
);

1478 
	`şo£
(
sd
[0]);

1479 
	`şo£
(
sd
[1]);

1480 
	`¢d_pcm_ä“
(
pcm
);

1481 
	`ä“
(
sh¬e
->
¦ave_chªÃls
);

1482 
	`ä“
(
sh¬e
);

1483  
”r
;

1487 
¦ave
 = 
	`ÿÎoc
(1, (
¢d_pcm_sh¬e_¦ave_t
) * 8);

1488 ià(!
¦ave
) {

1489 
	`Pth»ad_mu‹x_uÆock
(&
¢d_pcm_sh¬e_¦aves_mu‹x
);

1490 
	`¢d_pcm_şo£
(
¥cm
);

1491 
	`şo£
(
sd
[0]);

1492 
	`şo£
(
sd
[1]);

1493 
	`¢d_pcm_ä“
(
pcm
);

1494 
	`ä“
(
sh¬e
->
¦ave_chªÃls
);

1495 
	`ä“
(
sh¬e
);

1496  
”r
;

1498 
	`INIT_LIST_HEAD
(&
¦ave
->
ş›Ás
);

1499 
¦ave
->
pcm
 = 
¥cm
;

1500 
¦ave
->
chªÃls
 = 
schªÃls
;

1501 
¦ave
->
fÜm©
 = 
sfÜm©
;

1502 
¦ave
->
¿‹
 = 
¤©e
;

1503 
¦ave
->
³riod_time
 = 
¥”iod_time
;

1504 
¦ave
->
bufãr_time
 = 
sbufãr_time
;

1505 
	`±h»ad_mu‹x_š™
(&
¦ave
->
mu‹x
, 
NULL
);

1506 
	`±h»ad_cÚd_š™
(&
¦ave
->
pŞl_cÚd
, 
NULL
);

1507 
	`li¡_add_
(&
¦ave
->
li¡
, &
¢d_pcm_sh¬e_¦aves
);

1508 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

1509 
”r
 = 
	`±h»ad_ü—‹
(&
¦ave
->
th»ad
, 
NULL
, 
¢d_pcm_sh¬e_th»ad
, slave);

1510 
	`as£¹
(
”r
 == 0);

1511 
	`Pth»ad_mu‹x_uÆock
(&
¢d_pcm_sh¬e_¦aves_mu‹x
);

1513 
	`Pth»ad_mu‹x_lock
(&
¦ave
->
mu‹x
);

1514 
	`Pth»ad_mu‹x_uÆock
(&
¢d_pcm_sh¬e_¦aves_mu‹x
);

1515 
	`li¡_fÜ_—ch
(
i
, &
¦ave
->
ş›Ás
) {

1516 
¢d_pcm_sh¬e_t
 *
sh
 = 
	`li¡_’Œy
(
i
, snd_pcm_sh¬e_t, 
li¡
);

1517 
k
 = 0; k < 
sh
->
chªÃls
; ++k) {

1518 ià(
¦ave_m­
[
sh
->
¦ave_chªÃls
[
k
]]) {

1519 
	`SNDERR
("SÏvchªÃÈ%d i ®»ady iÀu£", 
sh
->
¦ave_chªÃls
[
k
]);

1520 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

1521 
	`şo£
(
sd
[0]);

1522 
	`şo£
(
sd
[1]);

1523 
	`¢d_pcm_ä“
(
pcm
);

1524 
	`ä“
(
sh¬e
->
¦ave_chªÃls
);

1525 
	`ä“
(
sh¬e
);

1526  -
EBUSY
;

1532 
sh¬e
->
¦ave
 = slave;

1533 
sh¬e
->
pcm
 =…cm;

1534 
sh¬e
->
ş›Á_sock‘
 = 
sd
[0];

1535 
sh¬e
->
¦ave_sock‘
 = 
sd
[1];

1537 
pcm
->
mm­_rw
 = 1;

1538 
pcm
->
İs
 = &
¢d_pcm_sh¬e_İs
;

1539 
pcm
->
ç¡_İs
 = &
¢d_pcm_sh¬e_ç¡_İs
;

1540 
pcm
->
´iv©e_d©a
 = 
sh¬e
;

1541 
pcm
->
pŞl_fd
 = 
sh¬e
->
ş›Á_sock‘
;

1542 
pcm
->
pŞl_ev’ts
 = 
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
 ? 
POLLOUT
 : 
POLLIN
;

1543 
pcm
->
t¡amp_ty³
 = 
¦ave
->pcm->tstamp_type;

1544 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
sh¬e
->
hw_±r
, -1, 0);

1545 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
sh¬e
->
­¶_±r
, -1, 0);

1547 
¦ave
->
İ’_couÁ
++;

1548 
	`li¡_add_
(&
sh¬e
->
li¡
, &
¦ave
->
ş›Ás
);

1550 
	`Pth»ad_mu‹x_uÆock
(&
¦ave
->
mu‹x
);

1552 *
pcmp
 = 
pcm
;

1554 
	}
}

1611 
	$_¢d_pcm_sh¬e_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1612 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

1613 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

1615 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1616 cÚ¡ *
¢ame
 = 
NULL
;

1617 
¢d_cÚfig_t
 *
bšdšgs
 = 
NULL
;

1618 
”r
;

1619 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

1620 *
chªÃls_m­
 = 
NULL
;

1621 
chªÃls
 = 0;

1622 
¢d_pcm_fÜm©_t
 
sfÜm©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1623 
schªÃls
 = -1;

1624 
¤©e
 = -1;

1625 
¥”iod_time
ğ-1, 
sbufãr_time
 = -1;

1626 
schªÃl_max
 = 0;

1628 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1629 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1630 cÚ¡ *
id
;

1631 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1633 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

1635 ià(
	`¡rcmp
(
id
, "slave") == 0) {

1636 
¦ave
 = 
n
;

1639 ià(
	`¡rcmp
(
id
, "bindings") == 0) {

1640 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1641 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

1642  -
EINVAL
;

1644 
bšdšgs
 = 
n
;

1647 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

1648  -
EINVAL
;

1650 ià(!
¦ave
) {

1651 
	`SNDERR
("slave is‚ot defined");

1652  -
EINVAL
;

1654 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 5,

1655 
SND_PCM_HW_PARAM_FORMAT
, 0, &
sfÜm©
,

1656 
SND_PCM_HW_PARAM_CHANNELS
, 0, &
schªÃls
,

1657 
SND_PCM_HW_PARAM_RATE
, 0, &
¤©e
,

1658 
SND_PCM_HW_PARAM_PERIOD_TIME
, 0, &
¥”iod_time
,

1659 
SND_PCM_HW_PARAM_BUFFER_TIME
, 0, &
sbufãr_time
);

1660 ià(
”r
 < 0)

1661  
”r
;

1664 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
scÚf
, &
¢ame
);

1665 
¢ame
 = 
”r
 >ğ0 && sÇm? 
	`¡rdup
(¢ameè: 
NULL
;

1666 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1667 ià(
¢ame
 =ğ
NULL
) {

1668 
	`SNDERR
("slave.pcm is‚ot‡ string");

1669  
”r
;

1672 ià(!
bšdšgs
) {

1673 
	`SNDERR
("bindings is‚ot defined");

1674 
”r
 = -
EINVAL
;

1675 
_ä“
;

1677 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
bšdšgs
) {

1678 
cchªÃl
 = -1;

1679 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1680 cÚ¡ *
id
;

1681 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1683 
”r
 = 
	`§ã_¡¹Ş
(
id
, &
cchªÃl
);

1684 ià(
”r
 < 0 || 
cchªÃl
 < 0) {

1685 
	`SNDERR
("Inv®id cl›Á chªÃÈš bšdšg: %s", 
id
);

1686 
”r
 = -
EINVAL
;

1687 
_ä“
;

1689 ià(()
cchªÃl
 >ğ
chªÃls
)

1690 
chªÃls
 = 
cchªÃl
 + 1;

1692 ià(
chªÃls
 == 0) {

1693 
	`SNDERR
("No bindings defined");

1694 
”r
 = -
EINVAL
;

1695 
_ä“
;

1697 
chªÃls_m­
 = 
	`ÿÎoc
(
chªÃls
, (*channels_map));

1698 ià(! 
chªÃls_m­
) {

1699 
”r
 = -
ENOMEM
;

1700 
_ä“
;

1703 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
bšdšgs
) {

1704 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1705 cÚ¡ *
id
;

1706 
cchªÃl
;

1707 
schªÃl
 = -1;

1708 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1710 
cchªÃl
 = 
	`©oi
(
id
);

1711 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
schªÃl
);

1712 ià(
”r
 < 0) {

1713 
_ä“
;

1715 
	`as£¹
(
schªÃl
 >= 0);

1716 
	`as£¹
(
schªÃls
 <ğ0 || 
schªÃl
 < schannels);

1717 
chªÃls_m­
[
cchªÃl
] = 
schªÃl
;

1718 ià(()
schªÃl
 > 
schªÃl_max
)

1719 
schªÃl_max
 = 
schªÃl
;

1721 ià(
schªÃls
 <= 0)

1722 
schªÃls
 = 
schªÃl_max
 + 1;

1723 
”r
 = 
	`¢d_pcm_sh¬e_İ’
(
pcmp
, 
Çme
, 
¢ame
, 
sfÜm©
, 
¤©e
,

1724 (è
schªÃls
,

1725 
¥”iod_time
, 
sbufãr_time
,

1726 
chªÃls
, 
chªÃls_m­
, 
¡»am
, 
mode
);

1727 
_ä“
:

1728 
	`ä“
(
chªÃls_m­
);

1729 
	`ä“
((*)
¢ame
);

1730  
”r
;

1731 
	}
}

1732 #iâdeà
DOC_HIDDEN


1733 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_sh¬e_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_shm.c

29 
	~"pcm_loÿl.h
"

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<¡ddef.h
>

33 
	~<lim™s.h
>

34 
	~<uni¡d.h
>

35 
	~<¡ršg.h
>

36 
	~<fú.h
>

37 
	~<sys/ioùl.h
>

38 
	~<sys/shm.h
>

39 
	~<sys/sock‘.h
>

40 
	~<pŞl.h
>

41 
	~<sys/un.h
>

42 
	~<sys/mmª.h
>

43 
	~<Ãtš‘/š.h
>

44 
	~<¬·/š‘.h
>

45 
	~<Ãt/if.h
>

46 
	~<Ãtdb.h
>

47 
	~"a£rv”.h
"

49 #iâdeà
PIC


51 cÚ¡ *
	g_¢d_moduË_pcm_shm
 = "";

54 #iâdeà
DOC_HIDDEN


56 
	msock‘
;

57 vŞ©
¢d_pcm_shm_ù¾_t
 *
	mù¾
;

58 } 
	t¢d_pcm_shm_t
;

61 
	$¢d_pcm_shm_aùiÚ_fd0
(
¢d_pcm_t
 *
pcm
, *
fd
)

63 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

64 
”r
;

65 
buf
[1] = "";

66 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

68 
”r
 = 
	`wr™e
(
shm
->
sock‘
, 
buf
, 1);

69 ià(
”r
 != 1)

70  -
EBADFD
;

71 
”r
 = 
	`¢d_»ûive_fd
(
shm
->
sock‘
, 
buf
, 1, 
fd
);

72 ià(
”r
 != 1)

73  -
EBADFD
;

74 ià(
ù¾
->
cmd
) {

75 
	`SNDERR
("Server has‚ot donehe cmd");

76  -
EBADFD
;

78  
ù¾
->
»suÉ
;

79 
	}
}

81 
	$¢d_pcm_shm_Ãw_rb±r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_shm_t
 *
shm
,

82 
¢d_pcm_rb±r_t
 *
rb±r
, vŞ©
¢d_pcm_shm_rb±r_t
 *
shm_rb±r
)

84 ià(!
shm_rb±r
->
u£_mm­
) {

85 ià(&
pcm
->
hw
 =ğ
rb±r
)

86 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
shm_rb±r
->
±r
, -1, 0);

88 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
shm_rb±r
->
±r
, -1, 0);

90 *
±r
;

91 
size_t
 
mm­_size
, 
mm­_off£t
, 
off£t
;

92 
fd
;

93 
»suÉ
;

95 
shm
->
ù¾
->
cmd
 = &
pcm
->
hw
 =ğ
rb±r
 ? 
SND_PCM_IOCTL_HW_PTR_FD
 : 
SND_PCM_IOCTL_APPL_PTR_FD
;

96 
»suÉ
 = 
	`¢d_pcm_shm_aùiÚ_fd0
(
pcm
, &
fd
);

97 ià(
»suÉ
 < 0)

98  
»suÉ
;

99 
mm­_size
 = 
	`·ge_±r
(
shm_rb±r
->
off£t
, (
¢d_pcm_uäames_t
), &off£t, &
mm­_off£t
);

100 
±r
 = 
	`mm­
(
NULL
, 
mm­_size
, 
PROT_READ
|
PROT_WRITE
, 
MAP_FILE
|
MAP_SHARED
, 
fd
, 
mm­_off£t
);

101 ià(
±r
 =ğ
MAP_FAILED
 ||…Œ =ğ
NULL
) {

102 
	`SYSERR
("shm„bptr mmap failed");

103  -
”ºo
;

105 ià(&
pcm
->
hw
 =ğ
rb±r
)

106 
	`¢d_pcm_£t_hw_±r
(
pcm
, (
¢d_pcm_uäames_t
 *)((*)
±r
 + 
off£t
), 
fd
, 
shm_rb±r
->offset);

108 
	`¢d_pcm_£t_­¶_±r
(
pcm
, (
¢d_pcm_uäames_t
 *)((*)
±r
 + 
off£t
), 
fd
, 
shm_rb±r
->offset);

111 
	}
}

113 
	$¢d_pcm_shm_aùiÚ
(
¢d_pcm_t
 *
pcm
)

115 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

116 
”r
, 
»suÉ
;

117 
buf
[1] = "";

118 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

120 ià(
ù¾
->
hw
.
chªged
 || cŒl->
­¶
.changed)

121  -
EBADFD
;

122 
”r
 = 
	`wr™e
(
shm
->
sock‘
, 
buf
, 1);

123 ià(
”r
 != 1)

124  -
EBADFD
;

125 
”r
 = 
	`»ad
(
shm
->
sock‘
, 
buf
, 1);

126 ià(
”r
 != 1)

127  -
EBADFD
;

128 ià(
ù¾
->
cmd
) {

129 
	`SNDERR
("Server has‚ot donehe cmd");

130  -
EBADFD
;

132 
»suÉ
 = 
ù¾
->result;

133 ià(
ù¾
->
hw
.
chªged
) {

134 
”r
 = 
	`¢d_pcm_shm_Ãw_rb±r
(
pcm
, 
shm
, &pcm->
hw
, &
ù¾
->hw);

135 ià(
”r
 < 0)

136  
”r
;

137 
ù¾
->
hw
.
chªged
 = 0;

139 ià(
ù¾
->
­¶
.
chªged
) {

140 
”r
 = 
	`¢d_pcm_shm_Ãw_rb±r
(
pcm
, 
shm
, &pcm->
­¶
, &
ù¾
->appl);

141 ià(
”r
 < 0)

142  
”r
;

143 
ù¾
->
­¶
.
chªged
 = 0;

145  
»suÉ
;

146 
	}
}

148 
	$¢d_pcm_shm_aùiÚ_fd
(
¢d_pcm_t
 *
pcm
, *
fd
)

150 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

151 
”r
;

152 
buf
[1] = "";

153 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

155 ià(
ù¾
->
hw
.
chªged
 || cŒl->
­¶
.changed)

156  -
EBADFD
;

157 
”r
 = 
	`wr™e
(
shm
->
sock‘
, 
buf
, 1);

158 ià(
”r
 != 1)

159  -
EBADFD
;

160 
”r
 = 
	`¢d_»ûive_fd
(
shm
->
sock‘
, 
buf
, 1, 
fd
);

161 ià(
”r
 != 1)

162  -
EBADFD
;

163 ià(
ù¾
->
cmd
) {

164 
	`SNDERR
("Server has‚ot donehe cmd");

165  -
EBADFD
;

167 ià(
ù¾
->
hw
.
chªged
) {

168 
”r
 = 
	`¢d_pcm_shm_Ãw_rb±r
(
pcm
, 
shm
, &pcm->
hw
, &
ù¾
->hw);

169 ià(
”r
 < 0)

170  
”r
;

171 
ù¾
->
hw
.
chªged
 = 0;

173 ià(
ù¾
->
­¶
.
chªged
) {

174 
”r
 = 
	`¢d_pcm_shm_Ãw_rb±r
(
pcm
, 
shm
, &pcm->
­¶
, &
ù¾
->appl);

175 ià(
”r
 < 0)

176  
”r
;

177 
ù¾
->
­¶
.
chªged
 = 0;

179  
ù¾
->
»suÉ
;

180 
	}
}

182 
	$¢d_pcm_shm_nÚblock
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
nÚblock
 ATTRIBUTE_UNUSED)

185 
	}
}

187 
	$¢d_pcm_shm_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
)

189 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

190 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

191 
ù¾
->
cmd
 = 
SND_PCM_IOCTL_ASYNC
;

192 
ù¾
->
u
.
async
.
sig
 = sig;

193 
ù¾
->
u
.
async
.
pid
 =…id;

194  
	`¢d_pcm_shm_aùiÚ
(
pcm
);

195 
	}
}

197 
	$¢d_pcm_shm_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_šfo_t
 * 
šfo
)

199 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

200 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

201 
”r
;

203 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_INFO
;

204 
”r
 = 
	`¢d_pcm_shm_aùiÚ
(
pcm
);

205 ià(
”r
 < 0)

206  
”r
;

207 *
šfo
 = 
ù¾
->
u
.info;

208  
”r
;

209 
	}
}

211 
	$¢d_pcm_shm_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
 ATTRIBUTE_UNUSED)

214 
	}
}

216 
	$¢d_pcm_shm_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

218 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

219 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

220 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

221 &
§cûss_mask
);

223 
	}
}

225 
	$¢d_pcm_shm_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

226 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

228 
”r
;

229 
lšks
 = ~
SND_PCM_HW_PARBIT_ACCESS
;

230 cÚ¡ 
¢d_pcm_acûss_mask_t
 *
acûss_mask
 = 
	`¢d_pcm_hw_·¿m_g‘_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
);

231 ià(!
	`¢d_pcm_acûss_mask_‹¡
(
acûss_mask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
) &&

232 !
	`¢d_pcm_acûss_mask_‹¡
(
acûss_mask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
)) {

233 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

234 
acûss_mask
);

235 ià(
”r
 < 0)

236  
”r
;

238 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

239 ià(
”r
 < 0)

240  
”r
;

242 
	}
}

244 
	$¢d_pcm_shm_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

245 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

247 
”r
;

248 
lšks
 = ~
SND_PCM_HW_PARBIT_ACCESS
;

249 
¢d_pcm_acûss_mask_t
 
acûss_mask
;

250 
	`¢d_mask_cİy
(&
acûss_mask
, 
	`¢d_pcm_hw_·¿m_g‘_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
));

251 
	`¢d_pcm_acûss_mask_£t
(&
acûss_mask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
);

252 
	`¢d_pcm_acûss_mask_£t
(&
acûss_mask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
);

253 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

254 &
acûss_mask
);

255 ià(
”r
 < 0)

256  
”r
;

257 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

258 ià(
”r
 < 0)

259  
”r
;

261 
	}
}

263 
	$¢d_pcm_shm_hw_»fše_¦ave
(
¢d_pcm_t
 *
pcm
,

264 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

266 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

267 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

268 
”r
;

269 
ù¾
->
u
.
hw_»fše
 = *
·¿ms
;

270 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_HW_REFINE
;

271 
”r
 = 
	`¢d_pcm_shm_aùiÚ
(
pcm
);

272 *
·¿ms
 = 
ù¾
->
u
.
hw_»fše
;

273  
”r
;

274 
	}
}

276 
	$¢d_pcm_shm_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

278  
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

279 
¢d_pcm_shm_hw_»fše_ı»·»
,

280 
¢d_pcm_shm_hw_»fše_cchªge
,

281 
¢d_pcm_shm_hw_»fše_¥»·»
,

282 
¢d_pcm_shm_hw_»fše_schªge
,

283 
¢d_pcm_shm_hw_»fše_¦ave
);

284 
	}
}

286 
	$¢d_pcm_shm_hw_·¿ms_¦ave
(
¢d_pcm_t
 *
pcm
,

287 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

289 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

290 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

291 
”r
;

292 
·¿ms
->
æags
 |ğ
SND_PCM_HW_PARAMS_EXPORT_BUFFER
;

293 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_HW_PARAMS
;

294 
ù¾
->
u
.
hw_·¿ms
 = *
·¿ms
;

295 
”r
 = 
	`¢d_pcm_shm_aùiÚ
(
pcm
);

296 *
·¿ms
 = 
ù¾
->
u
.
hw_·¿ms
;

297  
”r
;

298 
	}
}

300 
	$¢d_pcm_shm_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 * 
·¿ms
)

302  
	`¢d_pcm_hw_·¿ms_¦ave
(
pcm
, 
·¿ms
,

303 
¢d_pcm_shm_hw_»fše_cchªge
,

304 
¢d_pcm_shm_hw_»fše_¥»·»
,

305 
¢d_pcm_shm_hw_»fše_schªge
,

306 
¢d_pcm_shm_hw_·¿ms_¦ave
);

307 
	}
}

309 
	$¢d_pcm_shm_hw_ä“
(
¢d_pcm_t
 *
pcm
)

311 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

312 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

313 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_HW_FREE
;

314  
	`¢d_pcm_shm_aùiÚ
(
pcm
);

315 
	}
}

317 
	$¢d_pcm_shm_sw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_·¿ms_t
 * 
·¿ms
)

319 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

320 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

321 
”r
;

322 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_SW_PARAMS
;

323 
ù¾
->
u
.
sw_·¿ms
 = *
·¿ms
;

324 
”r
 = 
	`¢d_pcm_shm_aùiÚ
(
pcm
);

325 *
·¿ms
 = 
ù¾
->
u
.
sw_·¿ms
;

326 ià(
”r
 < 0)

327  
”r
;

328  
”r
;

329 
	}
}

331 
	$¢d_pcm_shm_mm­
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

334 
	}
}

336 
	$¢d_pcm_shm_munm­
(
¢d_pcm_t
 *
pcm
)

338 
c
;

339 
c
 = 0; c < 
pcm
->
chªÃls
; ++c) {

340 
¢d_pcm_chªÃl_šfo_t
 *
i
 = &
pcm
->
mm­_chªÃls
[
c
];

341 
c1
;

342 
”r
;

343 ià(
i
->
ty³
 !ğ
SND_PCM_AREA_MMAP
)

345 ià(
i
->
u
.
mm­
.
fd
 < 0)

347 
c1
 = 
c
 + 1; c1 < 
pcm
->
chªÃls
; ++c1) {

348 
¢d_pcm_chªÃl_šfo_t
 *
i1
 = &
pcm
->
mm­_chªÃls
[
c1
];

349 ià(
i1
->
ty³
 !ğ
SND_PCM_AREA_MMAP
)

351 ià(
i1
->
u
.
mm­
.
fd
 !ğ
i
->u.mmap.fd)

353 
i1
->
u
.
mm­
.
fd
 = -1;

355 
”r
 = 
	`şo£
(
i
->
u
.
mm­
.
fd
);

356 ià(
”r
 < 0) {

357 
	`SYSERR
("close failed");

358  -
”ºo
;

362 
	}
}

364 
	$¢d_pcm_shm_chªÃl_šfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chªÃl_šfo_t
 * 
šfo
)

366 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

367 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

368 
”r
;

369 
fd
;

370 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_CHANNEL_INFO
;

371 
ù¾
->
u
.
chªÃl_šfo
 = *
šfo
;

372 
”r
 = 
	`¢d_pcm_shm_aùiÚ_fd
(
pcm
, &
fd
);

373 ià(
”r
 < 0)

374  
”r
;

375 *
šfo
 = 
ù¾
->
u
.
chªÃl_šfo
;

376 
šfo
->
addr
 = 0;

377 
šfo
->
ty³
) {

378 
SND_PCM_AREA_MMAP
:

379 
šfo
->
u
.
mm­
.
fd
 = fd;

381 
SND_PCM_AREA_SHM
:

384 
	`as£¹
(0);

387  
”r
;

388 
	}
}

390 
	$¢d_pcm_shm_¡©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_¡©us_t
 * 
¡©us
)

392 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

393 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

394 
”r
;

395 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_STATUS
;

397 
”r
 = 
	`¢d_pcm_shm_aùiÚ
(
pcm
);

398 ià(
”r
 < 0)

399  
”r
;

400 *
¡©us
 = 
ù¾
->
u
.status;

401  
”r
;

402 
	}
}

404 
¢d_pcm_¡©e_t
 
	$¢d_pcm_shm_¡©e
(
¢d_pcm_t
 *
pcm
)

406 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

407 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

408 
ù¾
->
cmd
 = 
SND_PCM_IOCTL_STATE
;

409  
	`¢d_pcm_shm_aùiÚ
(
pcm
);

410 
	}
}

412 
	$¢d_pcm_shm_hwsync
(
¢d_pcm_t
 *
pcm
)

414 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

415 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

416 
ù¾
->
cmd
 = 
SND_PCM_IOCTL_HWSYNC
;

417  
	`¢d_pcm_shm_aùiÚ
(
pcm
);

418 
	}
}

420 
	$¢d_pcm_shm_d–ay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_säames_t
 *
d–ayp
)

422 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

423 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

424 
”r
;

425 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_DELAY
;

426 
”r
 = 
	`¢d_pcm_shm_aùiÚ
(
pcm
);

427 ià(
”r
 < 0)

428  
”r
;

429 *
d–ayp
 = 
ù¾
->
u
.
d–ay
.
äames
;

430  
”r
;

431 
	}
}

433 
¢d_pcm_säames_t
 
	$¢d_pcm_shm_ava_upd©e
(
¢d_pcm_t
 *
pcm
)

435 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

436 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

437 
”r
;

438 
ù¾
->
cmd
 = 
SND_PCM_IOCTL_AVAIL_UPDATE
;

439 
”r
 = 
	`¢d_pcm_shm_aùiÚ
(
pcm
);

440 ià(
”r
 < 0)

441  
”r
;

442  
”r
;

443 
	}
}

445 
	$¢d_pcm_shm_htime¡amp
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

446 
¢d_pcm_uäames_t
 *
ava
 
ATTRIBUTE_UNUSED
,

447 
¢d_htime¡amp_t
 *
t¡amp
 
ATTRIBUTE_UNUSED
)

449  -
EIO
;

450 
	}
}

452 
	$¢d_pcm_shm_´•¬e
(
¢d_pcm_t
 *
pcm
)

454 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

455 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

456 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_PREPARE
;

457  
	`¢d_pcm_shm_aùiÚ
(
pcm
);

458 
	}
}

460 
	$¢d_pcm_shm_»£t
(
¢d_pcm_t
 *
pcm
)

462 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

463 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

464 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_RESET
;

465  
	`¢d_pcm_shm_aùiÚ
(
pcm
);

466 
	}
}

468 
	$¢d_pcm_shm_¡¬t
(
¢d_pcm_t
 *
pcm
)

470 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

471 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

472 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_START
;

473  
	`¢d_pcm_shm_aùiÚ
(
pcm
);

474 
	}
}

476 
	$¢d_pcm_shm_drİ
(
¢d_pcm_t
 *
pcm
)

478 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

479 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

480 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_DROP
;

481  
	`¢d_pcm_shm_aùiÚ
(
pcm
);

482 
	}
}

484 
	$¢d_pcm_shm_d¿š
(
¢d_pcm_t
 *
pcm
)

486 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

487 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

488 
”r
;

490 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_DRAIN
;

491 
”r
 = 
	`¢d_pcm_shm_aùiÚ
(
pcm
);

492 ià(
”r
 !ğ-
EAGAIN
)

494 
	`u¦“p
(10000);

496 ià(
”r
 < 0)

497  
”r
;

498 ià(!(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
))

499 
	`¢d_pcm_wa™
(
pcm
, 
SND_PCM_WAIT_DRAIN
);

500  
”r
;

501 
	}
}

503 
	$¢d_pcm_shm_·u£
(
¢d_pcm_t
 *
pcm
, 
’abË
)

505 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

506 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

507 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_PAUSE
;

508 
ù¾
->
u
.
·u£
.
’abË
 =ƒnable;

509  
	`¢d_pcm_shm_aùiÚ
(
pcm
);

510 
	}
}

512 
¢d_pcm_säames_t
 
	$¢d_pcm_shm_»wšdabË
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

515 
	}
}

517 
¢d_pcm_säames_t
 
	$¢d_pcm_shm_»wšd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

519 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

520 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

521 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_REWIND
;

522 
ù¾
->
u
.
»wšd
.
äames
 = frames;

523  
	`¢d_pcm_shm_aùiÚ
(
pcm
);

524 
	}
}

526 
¢d_pcm_säames_t
 
	$¢d_pcm_shm_fÜw¬dabË
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

529 
	}
}

531 
¢d_pcm_säames_t
 
	$¢d_pcm_shm_fÜw¬d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_uäames_t
 
äames
)

533 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

534 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

535 
ù¾
->
cmd
 = 
SND_PCM_IOCTL_FORWARD
;

536 
ù¾
->
u
.
fÜw¬d
.
äames
 = frames;

537  
	`¢d_pcm_shm_aùiÚ
(
pcm
);

538 
	}
}

540 
	$¢d_pcm_shm_»sume
(
¢d_pcm_t
 *
pcm
)

542 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

543 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

544 
ù¾
->
cmd
 = 
SNDRV_PCM_IOCTL_RESUME
;

545  
	`¢d_pcm_shm_aùiÚ
(
pcm
);

546 
	}
}

548 
¢d_pcm_säames_t
 
	$¢d_pcm_shm_mm­_comm™
(
¢d_pcm_t
 *
pcm
,

549 
¢d_pcm_uäames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

550 
¢d_pcm_uäames_t
 
size
)

552 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

553 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

554 
ù¾
->
cmd
 = 
SND_PCM_IOCTL_MMAP_COMMIT
;

555 
ù¾
->
u
.
mm­_comm™
.
off£t
 = offset;

556 
ù¾
->
u
.
mm­_comm™
.
äames
 = 
size
;

557  
	`¢d_pcm_shm_aùiÚ
(
pcm
);

558 
	}
}

560 
	$¢d_pcm_shm_pŞl_desütÜ
(
¢d_pcm_t
 *
pcm
)

562 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

563 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

564 
fd
, 
”r
;

565 
ù¾
->
cmd
 = 
SND_PCM_IOCTL_POLL_DESCRIPTOR
;

566 
”r
 = 
	`¢d_pcm_shm_aùiÚ_fd
(
pcm
, &
fd
);

567 ià(
”r
 < 0)

568  
”r
;

569  
fd
;

570 
	}
}

572 
	$¢d_pcm_shm_şo£
(
¢d_pcm_t
 *
pcm
)

574 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
´iv©e_d©a
;

575 vŞ©
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
shm
->ctrl;

576 
»suÉ
;

577 
ù¾
->
cmd
 = 
SND_PCM_IOCTL_CLOSE
;

578 
»suÉ
 = 
	`¢d_pcm_shm_aùiÚ
(
pcm
);

579 
	`shmdt
((*)
ù¾
);

580 
	`şo£
(
shm
->
sock‘
);

581 
	`şo£
(
pcm
->
pŞl_fd
);

582 
	`ä“
(
shm
);

583  
»suÉ
;

584 
	}
}

586 
	$¢d_pcm_shm_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

588 
	`¢d_ouut_´štf
(
out
, "Shm PCM\n");

589 ià(
pcm
->
£tup
) {

590 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

591 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

593 
	}
}

595 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_shm_İs
 = {

596 .
şo£
 = 
¢d_pcm_shm_şo£
,

597 .
	gšfo
 = 
¢d_pcm_shm_šfo
,

598 .
	ghw_»fše
 = 
¢d_pcm_shm_hw_»fše
,

599 .
	ghw_·¿ms
 = 
¢d_pcm_shm_hw_·¿ms
,

600 .
	ghw_ä“
 = 
¢d_pcm_shm_hw_ä“
,

601 .
	gsw_·¿ms
 = 
¢d_pcm_shm_sw_·¿ms
,

602 .
	gchªÃl_šfo
 = 
¢d_pcm_shm_chªÃl_šfo
,

603 .
	gdump
 = 
¢d_pcm_shm_dump
,

604 .
	gnÚblock
 = 
¢d_pcm_shm_nÚblock
,

605 .
	gasync
 = 
¢d_pcm_shm_async
,

606 .
	gmm­
 = 
¢d_pcm_shm_mm­
,

607 .
	gmunm­
 = 
¢d_pcm_shm_munm­
,

610 cÚ¡ 
¢d_pcm_ç¡_İs_t
 
	g¢d_pcm_shm_ç¡_İs
 = {

611 .
¡©us
 = 
¢d_pcm_shm_¡©us
,

612 .
	g¡©e
 = 
¢d_pcm_shm_¡©e
,

613 .
	ghwsync
 = 
¢d_pcm_shm_hwsync
,

614 .
	gd–ay
 = 
¢d_pcm_shm_d–ay
,

615 .
	g´•¬e
 = 
¢d_pcm_shm_´•¬e
,

616 .
	g»£t
 = 
¢d_pcm_shm_»£t
,

617 .
	g¡¬t
 = 
¢d_pcm_shm_¡¬t
,

618 .
	gdrİ
 = 
¢d_pcm_shm_drİ
,

619 .
	gd¿š
 = 
¢d_pcm_shm_d¿š
,

620 .
	g·u£
 = 
¢d_pcm_shm_·u£
,

621 .
	g»wšdabË
 = 
¢d_pcm_shm_»wšdabË
,

622 .
	g»wšd
 = 
¢d_pcm_shm_»wšd
,

623 .
	gfÜw¬dabË
 = 
¢d_pcm_shm_fÜw¬dabË
,

624 .
	gfÜw¬d
 = 
¢d_pcm_shm_fÜw¬d
,

625 .
	g»sume
 = 
¢d_pcm_shm_»sume
,

626 .
	gwr™ei
 = 
¢d_pcm_mm­_wr™ei
,

627 .
	gwr™’
 = 
¢d_pcm_mm­_wr™’
,

628 .
	g»adi
 = 
¢d_pcm_mm­_»adi
,

629 .
	g»adn
 = 
¢d_pcm_mm­_»adn
,

630 .
	gava_upd©e
 = 
¢d_pcm_shm_ava_upd©e
,

631 .
	gmm­_comm™
 = 
¢d_pcm_shm_mm­_comm™
,

632 .
	ghtime¡amp
 = 
¢d_pcm_shm_htime¡amp
,

635 
	$make_loÿl_sock‘
(cÚ¡ *
f’ame
)

637 
size_t
 
l
 = 
	`¡¾’
(
f’ame
);

638 
size_t
 
size
 = 
	`off£tof
(
sockaddr_un
, 
sun_·th
è+ 
l
;

639 
sockaddr_un
 *
addr
 = 
	`®loÿ
(
size
);

640 
sock
;

642 
sock
 = 
	`sock‘
(
PF_LOCAL
, 
SOCK_STREAM
, 0);

643 ià(
sock
 < 0) {

644 
	`SYSERR
("socket failed");

645  -
”ºo
;

648 
addr
->
sun_çmy
 = 
AF_LOCAL
;

649 
	`memıy
(
addr
->
sun_·th
, 
f’ame
, 
l
);

651 ià(
	`cÚÃù
(
sock
, (
sockaddr
 *è
addr
, 
size
) < 0) {

652 
	`SYSERR
("connect failed");

653  -
”ºo
;

655  
sock
;

656 
	}
}

671 
	$¢d_pcm_shm_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

672 cÚ¡ *
sockÇme
, cÚ¡ *
¢ame
,

673 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

675 
¢d_pcm_t
 *
pcm
;

676 
¢d_pcm_shm_t
 *
shm
 = 
NULL
;

677 
¢d_ş›Á_İ’_»que¡_t
 *
»q
;

678 
¢d_ş›Á_İ’_ªsw”_t
 
ªs
;

679 
size_t
 
¢am–’
, 
»qËn
;

680 
”r
;

681 
»suÉ
;

682 
¢d_pcm_shm_ù¾_t
 *
ù¾
 = 
NULL
;

683 
sock
 = -1;

684 
¢am–’
 = 
	`¡¾’
(
¢ame
);

685 ià(
¢am–’
 > 255)

686  -
EINVAL
;

688 
»suÉ
 = 
	`make_loÿl_sock‘
(
sockÇme
);

689 ià(
»suÉ
 < 0) {

690 
	`SNDERR
("£rv” fÜ sock‘ % i nÙ„uÂšg", 
sockÇme
);

691 
_”r
;

693 
sock
 = 
»suÉ
;

695 
»qËn
 = (*
»q
è+ 
¢am–’
;

696 
»q
 = 
	`®loÿ
(
»qËn
);

697 
	`memıy
(
»q
->
Çme
, 
¢ame
, 
¢am–’
);

698 
»q
->
dev_ty³
 = 
SND_DEV_TYPE_PCM
;

699 
»q
->
Œª¥Üt_ty³
 = 
SND_TRANSPORT_TYPE_SHM
;

700 
»q
->
¡»am
 = stream;

701 
»q
->
mode
 = mode;

702 
»q
->
Çm–’
 = 
¢am–’
;

703 
”r
 = 
	`wr™e
(
sock
, 
»q
, 
»qËn
);

704 ià(
”r
 < 0) {

705 
	`SYSERR
("writeƒrror");

706 
»suÉ
 = -
”ºo
;

707 
_”r
;

709 ià((
size_t
è
”r
 !ğ
»qËn
) {

710 
	`SNDERR
("write sizeƒrror");

711 
»suÉ
 = -
EINVAL
;

712 
_”r
;

714 
”r
 = 
	`»ad
(
sock
, &
ªs
, (ans));

715 ià(
”r
 < 0) {

716 
	`SYSERR
("readƒrror");

717 
»suÉ
 = -
”ºo
;

718 
_”r
;

720 ià(
”r
 !ğ(
ªs
)) {

721 
	`SNDERR
("read sizeƒrror");

722 
»suÉ
 = -
EINVAL
;

723 
_”r
;

725 
»suÉ
 = 
ªs
.result;

726 ià(
»suÉ
 < 0)

727 
_”r
;

729 
ù¾
 = 
	`shm©
(
ªs
.
cook›
, 0, 0);

730 ià(!
ù¾
) {

731 
	`SYSERR
("shmatƒrror");

732 
»suÉ
 = -
”ºo
;

733 
_”r
;

736 
shm
 = 
	`ÿÎoc
(1, (
¢d_pcm_shm_t
));

737 ià(!
shm
) {

738 
»suÉ
 = -
ENOMEM
;

739 
_”r
;

742 
shm
->
sock‘
 = 
sock
;

743 
shm
->
ù¾
 = ctrl;

745 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_SHM
, 
Çme
, 
¡»am
, 
mode
);

746 ià(
”r
 < 0) {

747 
»suÉ
 = 
”r
;

748 
_”r
;

750 
pcm
->
mm­_rw
 = 1;

751 
pcm
->
İs
 = &
¢d_pcm_shm_İs
;

752 
pcm
->
ç¡_İs
 = &
¢d_pcm_shm_ç¡_İs
;

753 
pcm
->
´iv©e_d©a
 = 
shm
;

754 
”r
 = 
	`¢d_pcm_shm_pŞl_desütÜ
(
pcm
);

755 ià(
”r
 < 0) {

756 
	`¢d_pcm_şo£
(
pcm
);

757  
”r
;

759 
pcm
->
pŞl_fd
 = 
”r
;

760 
pcm
->
pŞl_ev’ts
 = 
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
 ? 
POLLOUT
 : 
POLLIN
;

761 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
ù¾
->
hw
.
±r
, -1, 0);

762 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
ù¾
->
­¶
.
±r
, -1, 0);

763 *
pcmp
 = 
pcm
;

766 
_”r
:

767 
	`şo£
(
sock
);

768 ià(
ù¾
)

769 
	`shmdt
(
ù¾
);

770 
	`ä“
(
shm
);

771  
»suÉ
;

772 
	}
}

811 
	$_¢d_pcm_shm_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

812 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

813 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

815 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

816 cÚ¡ *
£rv”
 = 
NULL
;

817 cÚ¡ *
pcm_Çme
 = 
NULL
;

818 
¢d_cÚfig_t
 *
scÚfig
;

819 cÚ¡ *
sockÇme
 = 
NULL
;

820 
pÜt
 = -1;

821 
”r
;

823 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

824 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

825 cÚ¡ *
id
;

826 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

828 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

830 ià(
	`¡rcmp
(
id
, "server") == 0) {

831 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
£rv”
);

832 ià(
”r
 < 0) {

833 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

834  -
EINVAL
;

838 ià(
	`¡rcmp
(
id
, "pcm") == 0) {

839 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
pcm_Çme
);

840 ià(
”r
 < 0) {

841 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

842  -
EINVAL
;

846 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

847  -
EINVAL
;

849 ià(!
pcm_Çme
) {

850 
	`SNDERR
("pcm is‚ot defined");

851  -
EINVAL
;

853 ià(!
£rv”
) {

854 
	`SNDERR
("server is‚ot defined");

855  -
EINVAL
;

857 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "£rv”", 
£rv”
, &
scÚfig
);

858 ià(
”r
 < 0) {

859 
	`SNDERR
("UnknowÀ£rv” %s", 
£rv”
);

860  -
EINVAL
;

862 ià(
	`¢d_cÚfig_g‘_ty³
(
scÚfig
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

863 
	`SNDERR
("Inv®idy³ fÜ s”v” % defš™iÚ", 
£rv”
);

864 
_”r
;

866 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
scÚfig
) {

867 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

868 cÚ¡ *
id
;

869 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

871 ià(
	`¡rcmp
(
id
, "comment") == 0)

873 ià(
	`¡rcmp
(
id
, "host") == 0)

875 ià(
	`¡rcmp
(
id
, "socket") == 0) {

876 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
sockÇme
);

877 ià(
”r
 < 0) {

878 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

879 
_”r
;

883 ià(
	`¡rcmp
(
id
, "port") == 0) {

884 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
pÜt
);

885 ià(
”r
 < 0) {

886 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

887 
_”r
;

891 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

892 
_”r
:

893 
”r
 = -
EINVAL
;

894 
__”rÜ
;

897 ià(!
sockÇme
) {

898 
	`SNDERR
("socket is‚ot defined");

899 
_”r
;

901 
”r
 = 
	`¢d_pcm_shm_İ’
(
pcmp
, 
Çme
, 
sockÇme
, 
pcm_Çme
, 
¡»am
, 
mode
);

902 
__”rÜ
:

903 
	`¢d_cÚfig_d–‘e
(
scÚfig
);

904  
”r
;

905 
	}
}

906 #iâdeà
DOC_HIDDEN


907 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_shm_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_simple.c

26 
	~"pcm_loÿl.h
"

28 
	$£t_bufãr_time
(
¢d_¥cm_Ï‹ncy_t
 
Ï‹ncy
,

29 *
bufãr_time
)

31 
Ï‹ncy
) {

32 
SND_SPCM_LATENCY_STANDARD
:

33 *
bufãr_time
 = 350000;

35 
SND_SPCM_LATENCY_MEDIUM
:

36 *
bufãr_time
 = 25000;

38 
SND_SPCM_LATENCY_REALTIME
:

39 *
bufãr_time
 = 2500;

42  -
EINVAL
;

45 
	}
}

47 
	$£t_hw_·¿ms
(
¢d_pcm_t
 *
pcm
,

48 
¢d_pcm_hw_·¿ms_t
 *
hw_·¿ms
,

49 *
¿‹
,

50 
chªÃls
,

51 
¢d_pcm_fÜm©_t
 
fÜm©
,

52 
¢d_pcm_subfÜm©_t
 
subfÜm©
,

53 *
bufãr_time
,

54 *
³riod_time
,

55 
¢d_pcm_acûss_t
 
acûss
)

57 
”r
;

62 
”r
 = 
	`¢d_pcm_hw_·¿ms_ªy
(
pcm
, 
hw_·¿ms
);

63 ià(
”r
 < 0)

64  
”r
;

65 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_acûss
(
pcm
, 
hw_·¿ms
, 
acûss
);

66 ià(
”r
 < 0)

67  
”r
;

68 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_fÜm©
(
pcm
, 
hw_·¿ms
, 
fÜm©
);

69 ià(
”r
 < 0)

70  
”r
;

71 ià(
subfÜm©
 !ğ
SND_PCM_SUBFORMAT_STD
) {

72 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_subfÜm©
(
pcm
, 
hw_·¿ms
, 
subfÜm©
);

73 ià(
”r
 < 0)

74  
”r
;

76 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_chªÃls
(
pcm
, 
hw_·¿ms
, 
chªÃls
);

77 ià(
”r
 < 0)

78  
”r
;

79 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_¿‹_Ã¬
)(
pcm
, 
hw_·¿ms
, 
¿‹
, 0);

80 ià(
”r
 < 0)

81  
”r
;

82 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_bufãr_time_Ã¬
)(
pcm
, 
hw_·¿ms
, 
bufãr_time
, 
NULL
);

83 ià(
”r
 < 0)

84  
”r
;

85 ià(
³riod_time
 =ğ
NULL
 || *period_time == 0) {

86 
³riods
 = 3;

87 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_£t_³riods_Ã¬
)(
pcm
, 
hw_·¿ms
, &
³riods
, 
NULL
);

88 ià(
”r
 < 0)

89  
”r
;

90 ià(
³riods
 == 1)

91  -
EINVAL
;

92 ià(
³riod_time
) {

93 
”r
 = 
	`INTERNAL
(
¢d_pcm_hw_·¿ms_g‘_³riod_time
)(
hw_·¿ms
, 
³riod_time
, 
NULL
);

94 ià(
”r
 < 0)

95  
”r
;

98 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_³riod_time
(
pcm
, 
hw_·¿ms
, *
³riod_time
, 0);

99 ià(
”r
 < 0)

100  
”r
;

101 ià(*
bufãr_time
 =ğ*
³riod_time
)

102  -
EINVAL
;

104 
”r
 = 
	`¢d_pcm_hw_·¿ms
(
pcm
, 
hw_·¿ms
);

105 ià(
”r
 < 0)

106  
”r
;

108 
	}
}

110 
	$£t_sw_·¿ms
(
¢d_pcm_t
 *
pcm
,

111 
¢d_pcm_sw_·¿ms_t
 *
sw_·¿ms
,

112 
¢d_¥cm_xrun_ty³_t
 
xrun_ty³
)

114 
”r
;

116 
”r
 = 
	`¢d_pcm_sw_·¿ms_cu¼’t
(
pcm
, 
sw_·¿ms
);

117 ià(
”r
 < 0)

118  
”r
;

119 
”r
 = 
	`¢d_pcm_sw_·¿ms_£t_¡¬t_th»shŞd
(
pcm
, 
sw_·¿ms
, (pcm->
bufãr_size
 /…cm->
³riod_size
) *…cm->period_size);

120 ià(
”r
 < 0)

121  
”r
;

122 
”r
 = 
	`¢d_pcm_sw_·¿ms_£t_ava_mš
(
pcm
, 
sw_·¿ms
,…cm->
³riod_size
);

123 ià(
”r
 < 0)

124  
”r
;

125 
xrun_ty³
) {

126 
SND_SPCM_XRUN_STOP
:

127 
”r
 = 
	`¢d_pcm_sw_·¿ms_£t_¡İ_th»shŞd
(
pcm
, 
sw_·¿ms
,…cm->
bufãr_size
);

129 
SND_SPCM_XRUN_IGNORE
:

130 
”r
 = 
	`¢d_pcm_sw_·¿ms_£t_¡İ_th»shŞd
(
pcm
, 
sw_·¿ms
,…cm->
bound¬y
);

133  -
EINVAL
;

135 ià(
”r
 < 0)

136  
”r
;

137 
”r
 = 
	`¢d_pcm_sw_·¿ms
(
pcm
, 
sw_·¿ms
);

138 ià(
”r
 < 0)

139  
”r
;

141 
	}
}

157 
	$¢d_¥cm_š™
(
¢d_pcm_t
 *
pcm
,

158 
¿‹
,

159 
chªÃls
,

160 
¢d_pcm_fÜm©_t
 
fÜm©
,

161 
¢d_pcm_subfÜm©_t
 
subfÜm©
,

162 
¢d_¥cm_Ï‹ncy_t
 
Ï‹ncy
,

163 
¢d_pcm_acûss_t
 
acûss
,

164 
¢d_¥cm_xrun_ty³_t
 
xrun_ty³
)

166 
”r
;

167 
¢d_pcm_hw_·¿ms_t
 
hw_·¿ms
 = {0};

168 
¢d_pcm_sw_·¿ms_t
 
sw_·¿ms
 = {0};

169 
¼©e
;

170 
bufãr_time
;

172 
	`as£¹
(
pcm
);

173 
	`as£¹
(
¿‹
 >= 5000 &&„ate <= 786000);

174 
	`as£¹
(
chªÃls
 >= 1 && channels <= 512);

176 
¼©e
 = 
¿‹
;

177 
”r
 = 
	`£t_bufãr_time
(
Ï‹ncy
, &
bufãr_time
);

178 ià(
”r
 < 0)

179  
”r
;

180 
”r
 = 
	`£t_hw_·¿ms
(
pcm
, &
hw_·¿ms
,

181 &
¼©e
, 
chªÃls
, 
fÜm©
, 
subfÜm©
,

182 &
bufãr_time
, 
NULL
, 
acûss
);

183 ià(
”r
 < 0)

184  
”r
;

186 
”r
 = 
	`£t_sw_·¿ms
(
pcm
, &
sw_·¿ms
, 
xrun_ty³
);

187 ià(
”r
 < 0)

188  
”r
;

191 
	}
}

209 
	$¢d_¥cm_š™_du¶ex
(
¢d_pcm_t
 *
¶ayback_pcm
,

210 
¢d_pcm_t
 *
ÿ±u»_pcm
,

211 
¿‹
,

212 
chªÃls
,

213 
¢d_pcm_fÜm©_t
 
fÜm©
,

214 
¢d_pcm_subfÜm©_t
 
subfÜm©
,

215 
¢d_¥cm_Ï‹ncy_t
 
Ï‹ncy
,

216 
¢d_pcm_acûss_t
 
acûss
,

217 
¢d_¥cm_xrun_ty³_t
 
xrun_ty³
,

218 
¢d_¥cm_du¶ex_ty³_t
 
du¶ex_ty³
)

220 
”r
, 
i
;

221 
¢d_pcm_hw_·¿ms_t
 
hw_·¿ms
 = {0};

222 
¢d_pcm_sw_·¿ms_t
 
sw_·¿ms
 = {0};

223 
¼©e
;

224 
xbufãr_time
, 
bufãr_time
[2];

225 
³riod_time
[2];

226 
¢d_pcm_t
 *
pcms
[2];

228 
	`as£¹
(
¶ayback_pcm
);

229 
	`as£¹
(
ÿ±u»_pcm
);

230 
	`as£¹
(
¿‹
 >= 5000 &&„ate <= 768000);

231 
	`as£¹
(
chªÃls
 >= 1 && channels <= 512);

233 
pcms
[0] = 
¶ayback_pcm
;

234 
pcms
[1] = 
ÿ±u»_pcm
;

239 
”r
 = 
	`£t_bufãr_time
(
Ï‹ncy
, &
xbufãr_time
);

240 ià(
”r
 < 0)

241  
”r
;

243 
i
 = 0; i < 2; i++) {

244 
bufãr_time
[
i
] = 
xbufãr_time
;

245 
³riod_time
[
i
] = i > 0 ?…eriod_time[0] : 0;

246 
¼©e
 = 
¿‹
;

247 
”r
 = 
	`£t_hw_·¿ms
(
pcms
[
i
], &
hw_·¿ms
,

248 &
¼©e
, 
chªÃls
, 
fÜm©
, 
subfÜm©
,

249 &
bufãr_time
[
i
], &
³riod_time
[i], 
acûss
);

250 ià(
”r
 < 0)

251  
”r
;

253 ià(
bufãr_time
[0] == buffer_time[1] &&

254 
³riod_time
[0] ==…eriod_time[1])

255 
__sw_·¿ms
;

256 ià(
du¶ex_ty³
 =ğ
SND_SPCM_DUPLEX_LIBERAL
)

257 
__sw_·¿ms
;

259  -
EINVAL
;

264 
__sw_·¿ms
:

265 
i
 = 0; i < 2; i++) {

266 
”r
 = 
	`£t_sw_·¿ms
(
pcms
[
i
], &
sw_·¿ms
, 
xrun_ty³
);

267 ià(
”r
 < 0)

268  
”r
;

272 
	}
}

284 
	$¢d_¥cm_š™_g‘_·¿ms
(
¢d_pcm_t
 *
pcm
,

285 *
¿‹
,

286 
¢d_pcm_uäames_t
 *
bufãr_size
,

287 
¢d_pcm_uäames_t
 *
³riod_size
)

289 
	`as£¹
(
pcm
);

290 ià(!
pcm
->
£tup
)

291  -
EBADFD
;

292 ià(
¿‹
)

293 *
¿‹
 = 
pcm
->rate;

294 ià(
bufãr_size
)

295 *
bufãr_size
 = 
pcm
->buffer_size;

296 ià(
³riod_size
)

297 *
³riod_size
 = 
pcm
->period_size;

299 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_softvol.c

29 
	~"pcm_loÿl.h
"

30 
	~"pcm_¶ugš.h
"

31 
	~"bsw­.h
"

32 
	~<m©h.h
>

33 
	~<sound/v.h
>

35 #iâdeà
PIC


37 cÚ¡ *
	g_¢d_moduË_pcm_soávŞ
 = "";

40 #iâdeà
DOC_HIDDEN


44 
¢d_pcm_¶ugš_t
 
	m¶ug
;

45 
¢d_pcm_fÜm©_t
 
	msfÜm©
;

46 
	mcchªÃls
;

47 
¢d_ùl_t
 *
	mùl
;

48 
¢d_ùl_–em_v®ue_t
 
	m–em
;

49 
	mcur_vŞ
[2];

50 
	mmax_v®
;

51 
	mz”o_dB_v®
;

52 
	mmš_dB
;

53 
	mmax_dB
;

54 *
	mdB_v®ue
;

55 } 
	t¢d_pcm_soávŞ_t
;

57 
	#VOL_SCALE_SHIFT
 16

	)

58 
	#VOL_SCALE_MASK
 ((1 << 
VOL_SCALE_SHIFT
è- 1)

	)

60 
	#PRESET_RESOLUTION
 256

	)

61 
	#PRESET_MIN_DB
 -51.0

	)

62 
	#ZERO_DB
 0.0

	)

67 
	#MAX_DB_UPPER_LIMIT
 90

	)

69 cÚ¡ 
	g´e£t_dB_v®ue
[
PRESET_RESOLUTION
] = {

106 
	mi
;

107 
	ms
[2];

108 } 
	tv®_t
;

109 
šlše
 
	$MULTI_DIV_32x16
(
a
, 
b
)

111 
v®_t
 
v
, 
x
, 
y
;

112 
v
.
i
 = 
a
;

113 
y
.
i
 = 0;

114 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


115 
x
.
i
 = ()
v
.
s
[0];

116 
x
.
i
 *ğ()
b
;

117 
y
.
s
[0] = 
x
.s[1];

118 
y
.
i
 +ğ()
v
.
s
[1] * 
b
;

120 
x
.
i
 = ()
v
.
s
[1] * 
b
;

121 
y
.
s
[1] = 
x
.s[0];

122 
y
.
i
 +ğ()
v
.
s
[0] * 
b
;

124  
y
.
i
;

125 
	}
}

127 
šlše
 
	$MULTI_DIV_št
(
a
, 
b
, 
sw­
)

129 
gaš
 = (
b
 >> 
VOL_SCALE_SHIFT
);

130 
äaùiÚ
;

131 
a
 = 
sw­
 ? ()
	`bsw­_32
(a) :‡;

132 
äaùiÚ
 = 
	`MULTI_DIV_32x16
(
a
, 
b
 & 
VOL_SCALE_MASK
);

133 ià(
gaš
) {

134 
amp
 = ()
a
 * 
gaš
 + 
äaùiÚ
;

135 ià(
amp
 > ()0x7fffffff)

136 
amp
 = ()0x7fffffff;

137 ià(
amp
 < ()0x80000000)

138 
amp
 = ()0x80000000;

139  
sw­
 ? ()
	`bsw­_32
(()
amp
) : ()amp;

141  
sw­
 ? ()
	`bsw­_32
(
äaùiÚ
) : fraction;

142 
	}
}

145 
šlše
 
	$MULTI_DIV_24
(
a
, 
b
)

147 
gaš
 = 
b
 >> 
VOL_SCALE_SHIFT
;

148 
äaùiÚ
;

149 
äaùiÚ
 = 
	`MULTI_DIV_32x16
(
a
, 
b
 & 
VOL_SCALE_MASK
);

150 ià(
gaš
) {

151 
amp
 = ()
a
 * 
gaš
 + 
äaùiÚ
;

152 ià(
amp
 > ()0x7fffff)

153 
amp
 = ()0x7fffff;

154 ià(
amp
 < ()0x800000)

155 
amp
 = ()0x800000;

156  ()
amp
;

158  
äaùiÚ
;

159 
	}
}

161 
šlše
 
	$MULTI_DIV_shÜt
(
a
, 
b
, 
sw­
)

163 
gaš
 = 
b
 >> 
VOL_SCALE_SHIFT
;

164 
äaùiÚ
;

165 
a
 = 
sw­
 ? ()
	`bsw­_16
(a) :‡;

166 
äaùiÚ
 = ()(
a
 * (
b
 & 
VOL_SCALE_MASK
)è>> 
VOL_SCALE_SHIFT
;

167 ià(
gaš
) {

168 
amp
 = 
a
 * 
gaš
 + 
äaùiÚ
;

169 ià(
	`abs
(
amp
) > 0x7fff)

170 
amp
 = (
a
<0) ? ()0x8000 : ()0x7fff;

171  
sw­
 ? ()
	`bsw­_16
(()
amp
) : ()amp;

173  
sw­
 ? ()
	`bsw­_16
(()
äaùiÚ
) : ()fraction;

174 
	}
}

184 #iâdeà
DOC_HIDDEN


185 
	#CONVERT_AREA
(
TYPE
, 
sw­
) do { \

186 
ch
, 
ä
; \

187 
TYPE
 *
¤c
, *
d¡
; \

188 
ch
 = 0; ch < 
chªÃls
; ch++) { \

189 
¤c_¬—
 = &
¤c_¬—s
[
ch
]; \

190 
d¡_¬—
 = &
d¡_¬—s
[
ch
]; \

191 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
); \

192 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
); \

193 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
è/ (
TYPE
); \

194 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
è/ (
TYPE
); \

195 
GET_VOL_SCALE
; \

196 
ä
 = 
äames
; \

197 ià(! 
vŞ_sÿË
) { \

198 
ä
--) { \

199 *
d¡
 = 0; \

200 
d¡
 +ğ
d¡_¡•
; \

202 } ià(
vŞ_sÿË
 == 0xffff) { \

203 
ä
--) { \

204 *
d¡
 = *
¤c
; \

205 
¤c
 +ğ
¤c_¡•
; \

206 
d¡
 +ğ
d¡_¡•
; \

209 
ä
--) { \

210 *
d¡
 = (
TYPE
è
MULTI_DIV_
##
	`TYPE
(*
¤c
, 
vŞ_sÿË
, 
sw­
); \

211 
¤c
 +ğ
¤c_¡•
; \

212 
d¡
 +ğ
d¡_¡•
; \

216 } 0)

	)

218 
	#CONVERT_AREA_S24_3LE
() do { \

219 
ch
, 
ä
; \

220 *
¤c
, *
d¡
; \

221 
tmp
; \

222 
ch
 = 0; ch < 
chªÃls
; ch++) { \

223 
¤c_¬—
 = &
¤c_¬—s
[
ch
]; \

224 
d¡_¬—
 = &
d¡_¬—s
[
ch
]; \

225 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
); \

226 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
); \

227 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
); \

228 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
); \

229 
GET_VOL_SCALE
; \

230 
ä
 = 
äames
; \

231 ià(! 
vŞ_sÿË
) { \

232 
ä
--) { \

233 
d¡
[0] = dst[1] = dst[2] = 0; \

234 
d¡
 +ğ
d¡_¡•
; \

236 } ià(
vŞ_sÿË
 == 0xffff) { \

237 
ä
--) { \

238 
d¡
[0] = 
¤c
[0]; \

239 
d¡
[1] = 
¤c
[1]; \

240 
d¡
[2] = 
¤c
[2]; \

241 
¤c
 +ğ
d¡_¡•
; \

242 
d¡
 +ğ
¤c_¡•
; \

245 
ä
--) { \

246 
tmp
 = 
¤c
[0] | \

247 (
¤c
[1] << 8) | \

248 (((sigÃd *è
¤c
)[2] << 16); \

249 
tmp
 = 
	`MULTI_DIV_24
Ñmp, 
vŞ_sÿË
); \

250 
d¡
[0] = 
tmp
; \

251 
d¡
[1] = 
tmp
 >> 8; \

252 
d¡
[2] = 
tmp
 >> 16; \

253 
¤c
 +ğ
d¡_¡•
; \

254 
d¡
 +ğ
¤c_¡•
; \

258 } 0)

	)

260 
	#CONVERT_AREA_S24_LE
() do { \

261 
ch
, 
ä
; \

262 *
¤c
, *
d¡
; \

263 
tmp
; \

264 
ch
 = 0; ch < 
chªÃls
; ch++) { \

265 
¤c_¬—
 = &
¤c_¬—s
[
ch
]; \

266 
d¡_¬—
 = &
d¡_¬—s
[
ch
]; \

267 
¤c
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
¤c_¬—
, 
¤c_off£t
); \

268 
d¡
 = 
	`¢d_pcm_chªÃl_¬—_addr
(
d¡_¬—
, 
d¡_off£t
); \

269 
¤c_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
¤c_¬—
) \

271 
d¡_¡•
 = 
	`¢d_pcm_chªÃl_¬—_¡•
(
d¡_¬—
) \

273 
GET_VOL_SCALE
; \

274 
ä
 = 
äames
; \

275 ià(! 
vŞ_sÿË
) { \

276 
ä
--) { \

277 *
d¡
 = 0; \

278 
d¡
 +ğ
d¡_¡•
; \

280 } ià(
vŞ_sÿË
 == 0xffff) { \

281 
ä
--) { \

282 *
d¡
 = *
¤c
; \

283 
¤c
 +ğ
d¡_¡•
; \

284 
d¡
 +ğ
¤c_¡•
; \

287 
ä
--) { \

288 
tmp
 = *
¤c
 << 8; \

289 
tmp
 = (signed )mp >> 8; \

290 *
d¡
 = 
	`MULTI_DIV_24
(
tmp
, 
vŞ_sÿË
); \

291 
¤c
 +ğ
d¡_¡•
; \

292 
d¡
 +ğ
¤c_¡•
; \

296 } 0)

	)

298 
	#GET_VOL_SCALE
 \

299 
ch
) { \

302 
vŞ_sÿË
 = (
chªÃls
 =ğ
ch
 + 1è? 
vŞ_c
 : 
vŞ
[0]; \

306 
vŞ_sÿË
 = 
vŞ_c
; \

309 
vŞ_sÿË
 = 
vŞ
[
ch
 & 1]; \

311 }

	)

316 
	$soávŞ_cÚv”t_¡”eo_vŞ
(
¢d_pcm_soávŞ_t
 *
svŞ
,

317 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

318 
¢d_pcm_uäames_t
 
d¡_off£t
,

319 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

320 
¢d_pcm_uäames_t
 
¤c_off£t
,

321 
chªÃls
,

322 
¢d_pcm_uäames_t
 
äames
)

324 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
, *
¤c_¬—
;

325 
¤c_¡•
, 
d¡_¡•
;

326 
vŞ_sÿË
, 
vŞ
[2], 
vŞ_c
;

328 ià(
svŞ
->
cur_vŞ
[0] == 0 && svol->cur_vol[1] == 0) {

329 
	`¢d_pcm_¬—s_s’û
(
d¡_¬—s
, 
d¡_off£t
, 
chªÃls
, 
äames
,

330 
svŞ
->
sfÜm©
);

332 } ià(
svŞ
->
z”o_dB_v®
 && svŞ->
cur_vŞ
[0] == svol->zero_dB_val &&

333 
svŞ
->
cur_vŞ
[1] =ğsvŞ->
z”o_dB_v®
) {

334 
	`¢d_pcm_¬—s_cİy
(
d¡_¬—s
, 
d¡_off£t
, 
¤c_¬—s
, 
¤c_off£t
,

335 
chªÃls
, 
äames
, 
svŞ
->
sfÜm©
);

339 ià(
svŞ
->
max_v®
 == 1) {

340 
vŞ
[0] = 
svŞ
->
cur_vŞ
[0] ? 0xffff : 0;

341 
vŞ
[1] = 
svŞ
->
cur_vŞ
[1] ? 0xffff : 0;

342 
vŞ_c
 = 
vŞ
[0] | vol[1];

344 
vŞ
[0] = 
svŞ
->
dB_v®ue
[svŞ->
cur_vŞ
[0]];

345 
vŞ
[1] = 
svŞ
->
dB_v®ue
[svŞ->
cur_vŞ
[1]];

346 
vŞ_c
 = 
svŞ
->
dB_v®ue
[(svŞ->
cur_vŞ
[0] + svol->cur_vol[1]) / 2];

348 
svŞ
->
sfÜm©
) {

349 
SND_PCM_FORMAT_S16_LE
:

350 
SND_PCM_FORMAT_S16_BE
:

352 
	`CONVERT_AREA
(,

353 !
	`¢d_pcm_fÜm©_ıu_’dŸn
(
svŞ
->
sfÜm©
));

355 
SND_PCM_FORMAT_S32_LE
:

356 
SND_PCM_FORMAT_S32_BE
:

358 
	`CONVERT_AREA
(,

359 !
	`¢d_pcm_fÜm©_ıu_’dŸn
(
svŞ
->
sfÜm©
));

361 
SND_PCM_FORMAT_S24_LE
:

363 
	`CONVERT_AREA_S24_LE
();

365 
SND_PCM_FORMAT_S24_3LE
:

366 
	`CONVERT_AREA_S24_3LE
();

371 
	}
}

373 #undeà
GET_VOL_SCALE


374 
	#GET_VOL_SCALE


	)

377 
	$soávŞ_cÚv”t_mÚo_vŞ
(
¢d_pcm_soávŞ_t
 *
svŞ
,

378 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—s
,

379 
¢d_pcm_uäames_t
 
d¡_off£t
,

380 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¤c_¬—s
,

381 
¢d_pcm_uäames_t
 
¤c_off£t
,

382 
chªÃls
,

383 
¢d_pcm_uäames_t
 
äames
)

385 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
d¡_¬—
, *
¤c_¬—
;

386 
¤c_¡•
, 
d¡_¡•
;

387 
vŞ_sÿË
;

389 ià(
svŞ
->
cur_vŞ
[0] == 0) {

390 
	`¢d_pcm_¬—s_s’û
(
d¡_¬—s
, 
d¡_off£t
, 
chªÃls
, 
äames
,

391 
svŞ
->
sfÜm©
);

393 } ià(
svŞ
->
z”o_dB_v®
 && svŞ->
cur_vŞ
[0] == svol->zero_dB_val) {

394 
	`¢d_pcm_¬—s_cİy
(
d¡_¬—s
, 
d¡_off£t
, 
¤c_¬—s
, 
¤c_off£t
,

395 
chªÃls
, 
äames
, 
svŞ
->
sfÜm©
);

399 ià(
svŞ
->
max_v®
 == 1)

400 
vŞ_sÿË
 = 
svŞ
->
cur_vŞ
[0] ? 0xffff : 0;

402 
vŞ_sÿË
 = 
svŞ
->
dB_v®ue
[svŞ->
cur_vŞ
[0]];

403 
svŞ
->
sfÜm©
) {

404 
SND_PCM_FORMAT_S16_LE
:

405 
SND_PCM_FORMAT_S16_BE
:

407 
	`CONVERT_AREA
(,

408 !
	`¢d_pcm_fÜm©_ıu_’dŸn
(
svŞ
->
sfÜm©
));

410 
SND_PCM_FORMAT_S32_LE
:

411 
SND_PCM_FORMAT_S32_BE
:

413 
	`CONVERT_AREA
(,

414 !
	`¢d_pcm_fÜm©_ıu_’dŸn
(
svŞ
->
sfÜm©
));

416 
SND_PCM_FORMAT_S24_LE
:

418 
	`CONVERT_AREA_S24_LE
();

420 
SND_PCM_FORMAT_S24_3LE
:

421 
	`CONVERT_AREA_S24_3LE
();

426 
	}
}

433 
	$g‘_cu¼’t_vŞume
(
¢d_pcm_soávŞ_t
 *
svŞ
)

435 
v®
;

436 
i
;

438 ià(
	`¢d_ùl_–em_»ad
(
svŞ
->
ùl
, &svŞ->
–em
) < 0)

440 
i
 = 0; i < 
svŞ
->
cchªÃls
; i++) {

441 
v®
 = 
svŞ
->
–em
.
v®ue
.
š‹g”
.v®ue[
i
];

442 ià(
v®
 > 
svŞ
->
max_v®
)

443 
v®
 = 
svŞ
->
max_v®
;

444 
svŞ
->
cur_vŞ
[
i
] = 
v®
;

446 
	}
}

448 
	$soávŞ_ä“
(
¢d_pcm_soávŞ_t
 *
svŞ
)

450 ià(
svŞ
->
¶ug
.
g’
.
şo£_¦ave
)

451 
	`¢d_pcm_şo£
(
svŞ
->
¶ug
.
g’
.
¦ave
);

452 ià(
svŞ
->
ùl
)

453 
	`¢d_ùl_şo£
(
svŞ
->
ùl
);

454 ià(
svŞ
->
dB_v®ue
 && svŞ->dB_v®u!ğ
´e£t_dB_v®ue
)

455 
	`ä“
(
svŞ
->
dB_v®ue
);

456 
	`ä“
(
svŞ
);

457 
	}
}

459 
	$¢d_pcm_soávŞ_şo£
(
¢d_pcm_t
 *
pcm
)

461 
¢d_pcm_soávŞ_t
 *
svŞ
 = 
pcm
->
´iv©e_d©a
;

462 
	`soávŞ_ä“
(
svŞ
);

464 
	}
}

466 
	$¢d_pcm_soávŞ_hw_»fše_ı»·»
(
¢d_pcm_t
 *
pcm
,

467 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

469 
”r
;

470 
¢d_pcm_soávŞ_t
 *
svŞ
 = 
pcm
->
´iv©e_d©a
;

471 
¢d_pcm_acûss_mask_t
 
acûss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

472 
¢d_pcm_fÜm©_mask_t
 
fÜm©_mask
 = {

474 (1ULL << 
SND_PCM_FORMAT_S16_LE
) |

475 (1ULL << 
SND_PCM_FORMAT_S16_BE
) |

476 (1ULL << 
SND_PCM_FORMAT_S24_LE
) |

477 (1ULL << 
SND_PCM_FORMAT_S32_LE
) |

478 (1ULL << 
SND_PCM_FORMAT_S32_BE
),

479 (1ULL << (
SND_PCM_FORMAT_S24_3LE
 - 32))

482 ià(
svŞ
->
sfÜm©
 !ğ
SND_PCM_FORMAT_UNKNOWN
) {

483 
	`¢d_pcm_fÜm©_mask_nÚe
(&
fÜm©_mask
);

484 
	`¢d_pcm_fÜm©_mask_£t
(&
fÜm©_mask
, 
svŞ
->
sfÜm©
);

486 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_ACCESS
,

487 &
acûss_mask
);

488 ià(
”r
 < 0)

489  
”r
;

490 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mask
(
·¿ms
, 
SND_PCM_HW_PARAM_FORMAT
,

491 &
fÜm©_mask
);

492 ià(
”r
 < 0)

493  
”r
;

494 
”r
 = 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
·¿ms
, 
SND_PCM_SUBFORMAT_STD
);

495 ià(
”r
 < 0)

496  
”r
;

497 
”r
 = 
	`_¢d_pcm_hw_·¿m_£t_mš
(
·¿ms
, 
SND_PCM_HW_PARAM_CHANNELS
, 1, 0);

498 ià(
”r
 < 0)

499  
”r
;

500 
·¿ms
->
šfo
 &ğ~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

502 
	}
}

504 
	$¢d_pcm_soávŞ_hw_»fše_¥»·»
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

506 
¢d_pcm_soávŞ_t
 *
svŞ
 = 
pcm
->
´iv©e_d©a
;

507 
¢d_pcm_acûss_mask_t
 
§cûss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

508 
	`_¢d_pcm_hw_·¿ms_ªy
(
¥¬ams
);

509 
	`_¢d_pcm_hw_·¿m_£t_mask
(
¥¬ams
, 
SND_PCM_HW_PARAM_ACCESS
,

510 &
§cûss_mask
);

511 ià(
svŞ
->
sfÜm©
 !ğ
SND_PCM_FORMAT_UNKNOWN
) {

512 
	`_¢d_pcm_hw_·¿ms_£t_fÜm©
(
¥¬ams
, 
svŞ
->
sfÜm©
);

513 
	`_¢d_pcm_hw_·¿ms_£t_subfÜm©
(
¥¬ams
, 
SND_PCM_SUBFORMAT_STD
);

516 
	}
}

521 
	$check_acûss_mask
(
¢d_pcm_hw_·¿ms_t
 *
¤c
,

522 
¢d_pcm_hw_·¿ms_t
 *
d¡
)

524 cÚ¡ 
¢d_pcm_acûss_mask_t
 *
mask
;

525 
¢d_pcm_acûss_mask_t
 
smask
;

527 
mask
 = 
	`¢d_pcm_hw_·¿m_g‘_mask
(
¤c
, 
SND_PCM_HW_PARAM_ACCESS
);

528 
	`¢d_mask_nÚe
(&
smask
);

529 ià(
	`¢d_pcm_acûss_mask_‹¡
(
mask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
) ||

530 
	`¢d_pcm_acûss_mask_‹¡
(
mask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
)) {

531 
	`¢d_pcm_acûss_mask_£t
(&
smask
,

532 
SND_PCM_ACCESS_RW_INTERLEAVED
);

533 
	`¢d_pcm_acûss_mask_£t
(&
smask
,

534 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

536 ià(
	`¢d_pcm_acûss_mask_‹¡
(
mask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
) ||

537 
	`¢d_pcm_acûss_mask_‹¡
(
mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
)) {

538 
	`¢d_pcm_acûss_mask_£t
(&
smask
,

539 
SND_PCM_ACCESS_RW_NONINTERLEAVED
);

540 
	`¢d_pcm_acûss_mask_£t
(&
smask
,

541 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

543 ià(
	`¢d_pcm_acûss_mask_‹¡
(
mask
, 
SND_PCM_ACCESS_MMAP_COMPLEX
))

544 
	`¢d_pcm_acûss_mask_£t
(&
smask
,

545 
SND_PCM_ACCESS_MMAP_COMPLEX
);

547  
	`_¢d_pcm_hw_·¿m_£t_mask
(
d¡
, 
SND_PCM_HW_PARAM_ACCESS
, &
smask
);

548 
	}
}

550 
	$¢d_pcm_soávŞ_hw_»fše_schªge
(
¢d_pcm_t
 *
pcm
,

551 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

552 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

554 
¢d_pcm_soávŞ_t
 *
svŞ
 = 
pcm
->
´iv©e_d©a
;

555 
”r
;

556 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

557 
SND_PCM_HW_PARBIT_RATE
 |

558 
SND_PCM_HW_PARBIT_PERIODS
 |

559 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

560 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

561 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

562 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

563 
SND_PCM_HW_PARBIT_TICK_TIME
);

564 ià(
svŞ
->
sfÜm©
 =ğ
SND_PCM_FORMAT_UNKNOWN
)

565 
lšks
 |ğ(
SND_PCM_HW_PARBIT_FORMAT
 |

566 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

567 
SND_PCM_HW_PARBIT_SAMPLE_BITS
);

568 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
¥¬ams
, 
lšks
, 
·¿ms
);

569 ià(
”r
 < 0)

570  
”r
;

572 
”r
 = 
	`check_acûss_mask
(
·¿ms
, 
¥¬ams
);

573 ià(
”r
 < 0)

574  
”r
;

577 
	}
}

579 
	$¢d_pcm_soávŞ_hw_»fše_cchªge
(
¢d_pcm_t
 *
pcm
,

580 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

581 
¢d_pcm_hw_·¿ms_t
 *
¥¬ams
)

583 
¢d_pcm_soávŞ_t
 *
svŞ
 = 
pcm
->
´iv©e_d©a
;

584 
”r
;

585 
lšks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

586 
SND_PCM_HW_PARBIT_RATE
 |

587 
SND_PCM_HW_PARBIT_PERIODS
 |

588 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

589 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

590 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

591 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

592 
SND_PCM_HW_PARBIT_TICK_TIME
);

593 ià(
svŞ
->
sfÜm©
 =ğ
SND_PCM_FORMAT_UNKNOWN
)

594 
lšks
 |ğ(
SND_PCM_HW_PARBIT_FORMAT
 |

595 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

596 
SND_PCM_HW_PARBIT_SAMPLE_BITS
);

597 
”r
 = 
	`_¢d_pcm_hw_·¿ms_»fše
(
·¿ms
, 
lšks
, 
¥¬ams
);

598 ià(
”r
 < 0)

599  
”r
;

601 
”r
 = 
	`check_acûss_mask
(
¥¬ams
, 
·¿ms
);

602 ià(
”r
 < 0)

603  
”r
;

606 
	}
}

608 
	$¢d_pcm_soávŞ_hw_»fše
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
)

610  
	`¢d_pcm_hw_»fše_¦ave
(
pcm
, 
·¿ms
,

611 
¢d_pcm_soávŞ_hw_»fše_ı»·»
,

612 
¢d_pcm_soávŞ_hw_»fše_cchªge
,

613 
¢d_pcm_soávŞ_hw_»fše_¥»·»
,

614 
¢d_pcm_soávŞ_hw_»fše_schªge
,

615 
¢d_pcm_g’”ic_hw_»fše
);

616 
	}
}

618 
	$¢d_pcm_soávŞ_hw_·¿ms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_·¿ms_t
 * 
·¿ms
)

620 
¢d_pcm_soávŞ_t
 *
svŞ
 = 
pcm
->
´iv©e_d©a
;

621 
¢d_pcm_t
 *
¦ave
 = 
svŞ
->
¶ug
.
g’
.slave;

622 
”r
 = 
	`¢d_pcm_hw_·¿ms_¦ave
(
pcm
, 
·¿ms
,

623 
¢d_pcm_soávŞ_hw_»fše_cchªge
,

624 
¢d_pcm_soávŞ_hw_»fše_¥»·»
,

625 
¢d_pcm_soávŞ_hw_»fše_schªge
,

626 
¢d_pcm_g’”ic_hw_·¿ms
);

627 ià(
”r
 < 0)

628  
”r
;

629 ià(
¦ave
->
fÜm©
 !ğ
SND_PCM_FORMAT_S16_LE
 &&

630 
¦ave
->
fÜm©
 !ğ
SND_PCM_FORMAT_S16_BE
 &&

631 
¦ave
->
fÜm©
 !ğ
SND_PCM_FORMAT_S24_3LE
 &&

632 
¦ave
->
fÜm©
 !ğ
SND_PCM_FORMAT_S24_LE
 &&

633 
¦ave
->
fÜm©
 !ğ
SND_PCM_FORMAT_S32_LE
 &&

634 
¦ave
->
fÜm©
 !ğ
SND_PCM_FORMAT_S32_BE
) {

635 
	`SNDERR
("softvol supports only S16_LE, S16_BE, S24_LE, S24_3LE, "

637  -
EINVAL
;

639 
svŞ
->
sfÜm©
 = 
¦ave
->
fÜm©
;

641 
	}
}

643 
¢d_pcm_uäames_t


644 
	$¢d_pcm_soávŞ_wr™e_¬—s
(
¢d_pcm_t
 *
pcm
,

645 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

646 
¢d_pcm_uäames_t
 
off£t
,

647 
¢d_pcm_uäames_t
 
size
,

648 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

649 
¢d_pcm_uäames_t
 
¦ave_off£t
,

650 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

652 
¢d_pcm_soávŞ_t
 *
svŞ
 = 
pcm
->
´iv©e_d©a
;

653 ià(
size
 > *
¦ave_siz•
)

654 
size
 = *
¦ave_siz•
;

655 
	`g‘_cu¼’t_vŞume
(
svŞ
);

656 ià(
svŞ
->
cchªÃls
 == 1)

657 
	`soávŞ_cÚv”t_mÚo_vŞ
(
svŞ
, 
¦ave_¬—s
, 
¦ave_off£t
,

658 
¬—s
, 
off£t
, 
pcm
->
chªÃls
, 
size
);

660 
	`soávŞ_cÚv”t_¡”eo_vŞ
(
svŞ
, 
¦ave_¬—s
, 
¦ave_off£t
,

661 
¬—s
, 
off£t
, 
pcm
->
chªÃls
, 
size
);

662 *
¦ave_siz•
 = 
size
;

663  
size
;

664 
	}
}

666 
¢d_pcm_uäames_t


667 
	$¢d_pcm_soávŞ_»ad_¬—s
(
¢d_pcm_t
 *
pcm
,

668 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

669 
¢d_pcm_uäames_t
 
off£t
,

670 
¢d_pcm_uäames_t
 
size
,

671 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¦ave_¬—s
,

672 
¢d_pcm_uäames_t
 
¦ave_off£t
,

673 
¢d_pcm_uäames_t
 *
¦ave_siz•
)

675 
¢d_pcm_soávŞ_t
 *
svŞ
 = 
pcm
->
´iv©e_d©a
;

676 ià(
size
 > *
¦ave_siz•
)

677 
size
 = *
¦ave_siz•
;

678 
	`g‘_cu¼’t_vŞume
(
svŞ
);

679 ià(
svŞ
->
cchªÃls
 == 1)

680 
	`soávŞ_cÚv”t_mÚo_vŞ
(
svŞ
, 
¬—s
, 
off£t
, 
¦ave_¬—s
,

681 
¦ave_off£t
, 
pcm
->
chªÃls
, 
size
);

683 
	`soávŞ_cÚv”t_¡”eo_vŞ
(
svŞ
, 
¬—s
, 
off£t
, 
¦ave_¬—s
,

684 
¦ave_off£t
, 
pcm
->
chªÃls
, 
size
);

685 *
¦ave_siz•
 = 
size
;

686  
size
;

687 
	}
}

689 
	$¢d_pcm_soávŞ_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouut_t
 *
out
)

691 
¢d_pcm_soávŞ_t
 *
svŞ
 = 
pcm
->
´iv©e_d©a
;

692 
	`¢d_ouut_´štf
(
out
, "Soft volume PCM\n");

693 
	`¢d_ouut_´štf
(
out
, "CÚŒŞ: %s\n", 
svŞ
->
–em
.
id
.
Çme
);

694 ià(
svŞ
->
max_v®
 == 1)

695 
	`¢d_ouut_´štf
(
out
, "boolean\n");

697 
	`¢d_ouut_´štf
(
out
, "mš_dB: %g\n", 
svŞ
->
mš_dB
);

698 
	`¢d_ouut_´štf
(
out
, "max_dB: %g\n", 
svŞ
->
max_dB
);

699 
	`¢d_ouut_´štf
(
out
, "»sŞutiÚ: %d\n", 
svŞ
->
max_v®
 + 1);

701 ià(
pcm
->
£tup
) {

702 
	`¢d_ouut_´štf
(
out
, "Its setup is:\n");

703 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

705 
	`¢d_ouut_´štf
(
out
, "Slave: ");

706 
	`¢d_pcm_dump
(
svŞ
->
¶ug
.
g’
.
¦ave
, 
out
);

707 
	}
}

709 
	$add_v_šfo
(
¢d_pcm_soávŞ_t
 *
svŞ
, 
¢d_ùl_–em_šfo_t
 *
cšfo
,

710 *
Şd_v
, 
size_t
 
Şd_v_size
)

712 
v
[4];

713 
v
[
SNDRV_CTL_TLVO_TYPE
] = 
SND_CTL_TLVT_DB_SCALE
;

714 
v
[
SNDRV_CTL_TLVO_LEN
] = 2 * ();

715 
v
[
SNDRV_CTL_TLVO_DB_SCALE_MIN
] = ()(
svŞ
->
mš_dB
 * 100);

716 
v
[
SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
] =

717 ()((
svŞ
->
max_dB
 - svŞ->
mš_dB
è* 100 / svŞ->
max_v®
);

718 ià((
v
è<ğ
Şd_v_size
 && 
	`memcmp
Ñlv, 
Şd_v
, (tlv)) == 0)

720  
	`¢d_ùl_–em_v_wr™e
(
svŞ
->
ùl
, &
cšfo
->
id
, 
v
);

721 
	}
}

723 
	$add_u£r_ùl
(
¢d_pcm_soávŞ_t
 *
svŞ
, 
¢d_ùl_–em_šfo_t
 *
cšfo
,

724 
couÁ
)

726 
”r
;

727 
i
;

728 
def_v®
;

730 ià(
svŞ
->
max_v®
 == 1) {

731 
	`¢d_ùl_–em_šfo_£t_»ad_wr™e
(
cšfo
, 1, 1);

732 
”r
 = 
	`¢d_ùl_add_boŞ—n_–em_£t
(
svŞ
->
ùl
, 
cšfo
, 1, 
couÁ
);

734 
”r
 = 
	`¢d_ùl_add_š‹g”_–em_£t
(
svŞ
->
ùl
, 
cšfo
, 1, 
couÁ
,

735 0, 
svŞ
->
max_v®
, 0);

737 ià(
”r
 < 0)

738  
”r
;

739 ià(
svŞ
->
max_v®
 == 1)

740 
def_v®
 = 1;

742 
	`add_v_šfo
(
svŞ
, 
cšfo
, 
NULL
, 0);

745 
def_v®
 = 
svŞ
->
z”o_dB_v®
 ? svŞ->z”o_dB_v® : svŞ->
max_v®
;

747 
i
 = 0; i < 
couÁ
; i++)

748 
svŞ
->
–em
.
v®ue
.
š‹g”
.v®ue[
i
] = 
def_v®
;

749  
	`¢d_ùl_–em_wr™e
(
svŞ
->
ùl
, &svŞ->
–em
);

750 
	}
}

758 
	$soávŞ_lßd_cÚŒŞ
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_soávŞ_t
 *
svŞ
,

759 
ùl_ÿrd
, 
¢d_ùl_–em_id_t
 *
ùl_id
,

760 
cchªÃls
, 
mš_dB
, 
max_dB
,

761 
»sŞutiÚ
)

763 
tmp_Çme
[32];

764 
¢d_pcm_šfo_t
 
šfo
 = {0};

765 
¢d_ùl_–em_šfo_t
 
cšfo
 = {0};

766 
”r
;

767 
i
;

769 ià(
ùl_ÿrd
 < 0) {

770 
”r
 = 
	`¢d_pcm_šfo
(
pcm
, &
šfo
);

771 ià(
”r
 < 0)

772  
”r
;

773 
ùl_ÿrd
 = 
	`¢d_pcm_šfo_g‘_ÿrd
(&
šfo
);

774 ià(
ùl_ÿrd
 < 0) {

775 
	`SNDERR
("No card defined for softvol control");

776  -
EINVAL
;

779 
	`¥rštf
(
tmp_Çme
, "hw:%d", 
ùl_ÿrd
);

780 
”r
 = 
	`¢d_ùl_İ’
(&
svŞ
->
ùl
, 
tmp_Çme
, 0);

781 ià(
”r
 < 0) {

782 
	`SNDERR
("CªnÙ o³ÀCTL %s", 
tmp_Çme
);

783  
”r
;

786 
svŞ
->
–em
.
id
 = *
ùl_id
;

787 
svŞ
->
max_v®
 = 
»sŞutiÚ
 - 1;

788 
svŞ
->
mš_dB
 = min_dB;

789 
svŞ
->
max_dB
 = max_dB;

790 ià(
svŞ
->
max_v®
 =ğ1 || svŞ->
max_dB
 =ğ
ZERO_DB
)

791 
svŞ
->
z”o_dB_v®
 = svŞ->
max_v®
;

792 ià(
svŞ
->
max_dB
 < 0)

793 
svŞ
->
z”o_dB_v®
 = 0;

795 
svŞ
->
z”o_dB_v®
 = (
mš_dB
 / (mš_dB - 
max_dB
)) *

796 
svŞ
->
max_v®
;

798 
	`¢d_ùl_–em_šfo_£t_id
(&
cšfo
, 
ùl_id
);

799 ià((
”r
 = 
	`¢d_ùl_–em_šfo
(
svŞ
->
ùl
, &
cšfo
)) < 0) {

800 ià(
”r
 !ğ-
ENOENT
) {

801 
	`SNDERR
("CªnÙ g‘ infØfÜ CTL %s", 
tmp_Çme
);

802  
”r
;

804 
”r
 = 
	`add_u£r_ùl
(
svŞ
, &
cšfo
, 
cchªÃls
);

805 ià(
”r
 < 0) {

806 
	`SNDERR
("Cannot‡dd‡ control");

807  
”r
;

810 ià(! (
cšfo
.
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_USER
)) {

814 } ià((
cšfo
.
ty³
 !ğ
SND_CTL_ELEM_TYPE_INTEGER
 &&

815 
cšfo
.
ty³
 !ğ
SND_CTL_ELEM_TYPE_BOOLEAN
) ||

816 
cšfo
.
couÁ
 !ğ()
cchªÃls
 ||

817 
cšfo
.
v®ue
.
š‹g”
.
mš
 != 0 ||

818 
cšfo
.
v®ue
.
š‹g”
.
max
 !ğ
svŞ
->
max_v®
 ||

819 (
svŞ
->
max_v®
 > 1 &&

820 (
cšfo
.
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_READ
) == 0) ||

821 (
svŞ
->
max_v®
 < 2 &&

822 (
cšfo
.
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_READ
) != 0)) {

823 
”r
 = 
	`¢d_ùl_–em_»move
(
svŞ
->
ùl
, &
cšfo
.
id
);

824 ià(
”r
 < 0) {

825 
	`SNDERR
("CÚŒŞ % mism©ch", 
tmp_Çme
);

826  
”r
;

829 
	`¢d_ùl_–em_šfo_ş—r
(&
cšfo
);

830 
	`¢d_ùl_–em_šfo_£t_id
(&
cšfo
, 
ùl_id
);

831 ià((
”r
 = 
	`add_u£r_ùl
(
svŞ
, &
cšfo
, 
cchªÃls
)) < 0) {

832 
	`SNDERR
("Cannot‡dd‡ control");

833  
”r
;

835 } ià(
svŞ
->
max_v®
 > 1) {

837 
v
[4];

838 
”r
 = 
	`¢d_ùl_–em_v_»ad
(
svŞ
->
ùl
, &
cšfo
.
id
, 
v
,

839 (
v
));

840 
	`add_v_šfo
(
svŞ
, &
cšfo
, 
v
, 
”r
 < 0 ? 0 : (tlv));

844 ià(
svŞ
->
max_v®
 == 1)

848 ià(
mš_dB
 =ğ
PRESET_MIN_DB
 && 
max_dB
 =ğ
ZERO_DB
 &&

849 
»sŞutiÚ
 =ğ
PRESET_RESOLUTION
)

850 
svŞ
->
dB_v®ue
 = (*)
´e£t_dB_v®ue
;

852 #iâdeà
HAVE_SOFT_FLOAT


853 
svŞ
->
dB_v®ue
 = 
	`ÿÎoc
(
»sŞutiÚ
, ());

854 ià(! 
svŞ
->
dB_v®ue
) {

855 
	`SNDERR
("cannot‡llocate dBable");

856  -
ENOMEM
;

858 
svŞ
->
mš_dB
 = min_dB;

859 
svŞ
->
max_dB
 = max_dB;

860 
i
 = 0; i <ğ
svŞ
->
max_v®
; i++) {

861 
db
 = 
svŞ
->
mš_dB
 +

862 (
i
 * (
svŞ
->
max_dB
 - svŞ->
mš_dB
)) /

863 
svŞ
->
max_v®
;

864 
v
 = (
	`pow
(10.0, 
db
 / 20.0) *

865 ()(1 << 
VOL_SCALE_SHIFT
));

866 
svŞ
->
dB_v®ue
[
i
] = ()
v
;

868 ià(
svŞ
->
z”o_dB_v®
)

869 
svŞ
->
dB_v®ue
[svŞ->
z”o_dB_v®
] = 65535;

871 
	`SNDERR
("Cannot handlehe given dB„ange‡nd„esolution");

872  -
EINVAL
;

876 
	}
}

878 cÚ¡ 
¢d_pcm_İs_t
 
	g¢d_pcm_soávŞ_İs
 = {

879 .
şo£
 = 
¢d_pcm_soávŞ_şo£
,

880 .
	gšfo
 = 
¢d_pcm_g’”ic_šfo
,

881 .
	ghw_»fše
 = 
¢d_pcm_soávŞ_hw_»fše
,

882 .
	ghw_·¿ms
 = 
¢d_pcm_soávŞ_hw_·¿ms
,

883 .
	ghw_ä“
 = 
¢d_pcm_g’”ic_hw_ä“
,

884 .
	gsw_·¿ms
 = 
¢d_pcm_g’”ic_sw_·¿ms
,

885 .
	gchªÃl_šfo
 = 
¢d_pcm_g’”ic_chªÃl_šfo
,

886 .
	gdump
 = 
¢d_pcm_soávŞ_dump
,

887 .
	gnÚblock
 = 
¢d_pcm_g’”ic_nÚblock
,

888 .
	gasync
 = 
¢d_pcm_g’”ic_async
,

889 .
	gmm­
 = 
¢d_pcm_g’”ic_mm­
,

890 .
	gmunm­
 = 
¢d_pcm_g’”ic_munm­
,

891 .
	gqu”y_chm­s
 = 
¢d_pcm_g’”ic_qu”y_chm­s
,

892 .
	gg‘_chm­
 = 
¢d_pcm_g’”ic_g‘_chm­
,

893 .
	g£t_chm­
 = 
¢d_pcm_g’”ic_£t_chm­
,

914 
	$¢d_pcm_soávŞ_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

915 
¢d_pcm_fÜm©_t
 
sfÜm©
,

916 
ùl_ÿrd
, 
¢d_ùl_–em_id_t
 *
ùl_id
,

917 
cchªÃls
,

918 
mš_dB
, 
max_dB
, 
»sŞutiÚ
,

919 
¢d_pcm_t
 *
¦ave
, 
şo£_¦ave
)

921 
¢d_pcm_t
 *
pcm
;

922 
¢d_pcm_soávŞ_t
 *
svŞ
;

923 
”r
;

924 
	`as£¹
(
pcmp
 && 
¦ave
);

925 ià(
sfÜm©
 !ğ
SND_PCM_FORMAT_UNKNOWN
 &&

926 
sfÜm©
 !ğ
SND_PCM_FORMAT_S16_LE
 &&

927 
sfÜm©
 !ğ
SND_PCM_FORMAT_S16_BE
 &&

928 
sfÜm©
 !ğ
SND_PCM_FORMAT_S24_3LE
 &&

929 
sfÜm©
 !ğ
SND_PCM_FORMAT_S24_LE
 &&

930 
sfÜm©
 !ğ
SND_PCM_FORMAT_S32_LE
 &&

931 
sfÜm©
 !ğ
SND_PCM_FORMAT_S32_BE
)

932  -
EINVAL
;

933 
svŞ
 = 
	`ÿÎoc
(1, (*svol));

934 ià(! 
svŞ
)

935  -
ENOMEM
;

936 
”r
 = 
	`soávŞ_lßd_cÚŒŞ
(
¦ave
, 
svŞ
, 
ùl_ÿrd
, 
ùl_id
, 
cchªÃls
,

937 
mš_dB
, 
max_dB
, 
»sŞutiÚ
);

938 ià(
”r
 < 0) {

939 
	`soávŞ_ä“
(
svŞ
);

940  
”r
;

942 ià(
”r
 > 0) {

943 
	`soávŞ_ä“
(
svŞ
);

944 *
pcmp
 = 
¦ave
;

945 ià(!
¦ave
->
Çme
 &&‚ame)

946 
¦ave
->
Çme
 = 
	`¡rdup
(name);

951 
	`¢d_pcm_¶ugš_š™
(&
svŞ
->
¶ug
);

952 
svŞ
->
sfÜm©
 = sformat;

953 
svŞ
->
cchªÃls
 = cchannels;

954 
svŞ
->
¶ug
.
»ad
 = 
¢d_pcm_soávŞ_»ad_¬—s
;

955 
svŞ
->
¶ug
.
wr™e
 = 
¢d_pcm_soávŞ_wr™e_¬—s
;

956 
svŞ
->
¶ug
.
undo_»ad
 = 
¢d_pcm_¶ugš_undo_»ad_g’”ic
;

957 
svŞ
->
¶ug
.
undo_wr™e
 = 
¢d_pcm_¶ugš_undo_wr™e_g’”ic
;

958 
svŞ
->
¶ug
.
g’
.
¦ave
 = slave;

959 
svŞ
->
¶ug
.
g’
.
şo£_¦ave
 = close_slave;

961 
”r
 = 
	`¢d_pcm_Ãw
(&
pcm
, 
SND_PCM_TYPE_SOFTVOL
, 
Çme
, 
¦ave
->
¡»am
, sÏve->
mode
);

962 ià(
”r
 < 0) {

963 
	`soávŞ_ä“
(
svŞ
);

964  
”r
;

966 
pcm
->
İs
 = &
¢d_pcm_soávŞ_İs
;

967 
pcm
->
ç¡_İs
 = &
¢d_pcm_¶ugš_ç¡_İs
;

968 
pcm
->
´iv©e_d©a
 = 
svŞ
;

969 
pcm
->
pŞl_fd
 = 
¦ave
->poll_fd;

970 
pcm
->
pŞl_ev’ts
 = 
¦ave
->poll_events;

976 
pcm
->
mm­_shadow
 = 1;

977 
pcm
->
t¡amp_ty³
 = 
¦ave
->tstamp_type;

978 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
svŞ
->
¶ug
.
hw_±r
, -1, 0);

979 
	`¢d_pcm_£t_­¶_±r
(
pcm
, &
svŞ
->
¶ug
.
­¶_±r
, -1, 0);

980 *
pcmp
 = 
pcm
;

983 
	}
}

985 
	$_¢d_pcm_·r£_cÚŒŞ_id
(
¢d_cÚfig_t
 *
cÚf
, 
¢d_ùl_–em_id_t
 *
ùl_id
,

986 *
ÿrdp
, *
cchªÃls
)

988 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

989 
içû
 = 
SND_CTL_ELEM_IFACE_MIXER
;

990 cÚ¡ *
Çme
 = 
NULL
;

991 
šdex
 = 0;

992 
deviû
 = -1;

993 
subdeviû
 = -1;

994 
”r
;

996 
	`as£¹
(
ùl_id
 && 
ÿrdp
 && 
cchªÃls
);

998 *
ÿrdp
 = -1;

999 *
cchªÃls
 = 2;

1000 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1001 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1002 cÚ¡ *
id
;

1003 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1005 ià(
	`¡rcmp
(
id
, "comment") == 0)

1007 ià(
	`¡rcmp
(
id
, "card") == 0) {

1008 
”r
 = 
	`¢d_cÚfig_g‘_ÿrd
(
n
);

1009 ià(
”r
 < 0)

1010 
_”r
;

1011 *
ÿrdp
 = 
”r
;

1014 ià(
	`¡rcmp
(
id
, "iface") == 0 || strcmp(id, "interface") == 0) {

1015 
”r
 = 
	`¢d_cÚfig_g‘_ùl_içû
(
n
);

1016 ià(
”r
 < 0)

1017 
_”r
;

1018 
içû
 = 
”r
;

1021 ià(
	`¡rcmp
(
id
, "name") == 0) {

1022 ià((
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
Çme
)) < 0) {

1023 
	`SNDERR
("f›ld % i nÙ‡ sŒšg", 
id
);

1024 
_”r
;

1028 ià(
	`¡rcmp
(
id
, "index") == 0) {

1029 ià((
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
šdex
)) < 0) {

1030 
	`SNDERR
("f›ld % i nÙ‡Àš‹g”", 
id
);

1031 
_”r
;

1035 ià(
	`¡rcmp
(
id
, "device") == 0) {

1036 ià((
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
deviû
)) < 0) {

1037 
	`SNDERR
("f›ld % i nÙ‡Àš‹g”", 
id
);

1038 
_”r
;

1042 ià(
	`¡rcmp
(
id
, "subdevice") == 0) {

1043 ià((
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
subdeviû
)) < 0) {

1044 
	`SNDERR
("f›ld % i nÙ‡Àš‹g”", 
id
);

1045 
_”r
;

1049 ià(
	`¡rcmp
(
id
, "count") == 0) {

1050 
v
;

1051 ià((
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v
)) < 0) {

1052 
	`SNDERR
("f›ld % i nÙ‡Àš‹g”", 
id
);

1053 
_”r
;

1055 ià(
v
 < 1 || v > 2) {

1056 
	`SNDERR
("Inv®id couÁ %ld", 
v
);

1057 
_”r
;

1059 *
cchªÃls
 = 
v
;

1062 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

1063  -
EINVAL
;

1065 ià(
Çme
 =ğ
NULL
) {

1066 
	`SNDERR
("Missing control‚ame");

1067 
”r
 = -
EINVAL
;

1068 
_”r
;

1070 ià(
deviû
 < 0)

1071 
deviû
 = 0;

1072 ià(
subdeviû
 < 0)

1073 
subdeviû
 = 0;

1075 
	`¢d_ùl_–em_id_£t_š‹rçû
(
ùl_id
, 
içû
);

1076 
	`¢d_ùl_–em_id_£t_Çme
(
ùl_id
, 
Çme
);

1077 
	`¢d_ùl_–em_id_£t_šdex
(
ùl_id
, 
šdex
);

1078 
	`¢d_ùl_–em_id_£t_deviû
(
ùl_id
, 
deviû
);

1079 
	`¢d_ùl_–em_id_£t_subdeviû
(
ùl_id
, 
subdeviû
);

1083 
_”r
:

1084  
”r
;

1085 
	}
}

1150 
	$_¢d_pcm_soávŞ_İ’
(
¢d_pcm_t
 **
pcmp
, cÚ¡ *
Çme
,

1151 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
,

1152 
¢d_pcm_¡»am_t
 
¡»am
, 
mode
)

1154 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1155 
”r
;

1156 
¢d_pcm_t
 *
¥cm
;

1157 
¢d_cÚfig_t
 *
¦ave
 = 
NULL
, *
scÚf
;

1158 
¢d_cÚfig_t
 *
cÚŒŞ
 = 
NULL
;

1159 
¢d_pcm_fÜm©_t
 
sfÜm©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1160 
¢d_ùl_–em_id_t
 
ùl_id
 = {0};

1161 
»sŞutiÚ
 = 
PRESET_RESOLUTION
;

1162 
mš_dB
 = 
PRESET_MIN_DB
;

1163 
max_dB
 = 
ZERO_DB
;

1164 
ÿrd
 = -1, 
cchªÃls
 = 2;

1166 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

1167 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1168 cÚ¡ *
id
;

1169 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1171 ià(
	`¢d_pcm_cÚf_g’”ic_id
(
id
))

1173 ià(
	`¡rcmp
(
id
, "slave") == 0) {

1174 
¦ave
 = 
n
;

1177 ià(
	`¡rcmp
(
id
, "control") == 0) {

1178 
cÚŒŞ
 = 
n
;

1181 ià(
	`¡rcmp
(
id
, "resolution") == 0) {

1182 
v
;

1183 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
v
);

1184 ià(
”r
 < 0) {

1185 
	`SNDERR
("Invalid„esolution value");

1186  
”r
;

1188 
»sŞutiÚ
 = 
v
;

1191 ià(
	`¡rcmp
(
id
, "min_dB") == 0) {

1192 
”r
 = 
	`¢d_cÚfig_g‘_œ—l
(
n
, &
mš_dB
);

1193 ià(
”r
 < 0) {

1194 
	`SNDERR
("Invalid min_dB value");

1195  
”r
;

1199 ià(
	`¡rcmp
(
id
, "max_dB") == 0) {

1200 
”r
 = 
	`¢d_cÚfig_g‘_œ—l
(
n
, &
max_dB
);

1201 ià(
”r
 < 0) {

1202 
	`SNDERR
("Invalid max_dB value");

1203  
”r
;

1207 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

1208  -
EINVAL
;

1210 ià(!
¦ave
) {

1211 
	`SNDERR
("slave is‚ot defined");

1212  -
EINVAL
;

1214 ià(!
cÚŒŞ
) {

1215 
	`SNDERR
("control is‚ot defined");

1216  -
EINVAL
;

1218 ià(
mš_dB
 >= 0) {

1219 
	`SNDERR
("min_dB must be‡‚egative value");

1220  -
EINVAL
;

1222 ià(
max_dB
 <ğ
mš_dB
 || max_dB > 
MAX_DB_UPPER_LIMIT
) {

1223 
	`SNDERR
("max_dB must be†argerhan min_dB‡nd†esshan %d dB",

1224 
MAX_DB_UPPER_LIMIT
);

1225  -
EINVAL
;

1227 ià(
»sŞutiÚ
 <= 1 ||„esolution > 1024) {

1228 
	`SNDERR
("Inv®id„esŞutiÚ v®u%d", 
»sŞutiÚ
);

1229  -
EINVAL
;

1231 ià(
mode
 & 
SND_PCM_NO_SOFTVOL
) {

1232 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 0);

1233 ià(
”r
 < 0)

1234  
”r
;

1235 
”r
 = 
	`¢d_pcm_İ’_Çmed_¦ave
(
pcmp
, 
Çme
, 
roÙ
, 
scÚf
, 
¡»am
,

1236 
mode
, 
cÚf
);

1237 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1239 
”r
 = 
	`¢d_pcm_¦ave_cÚf
(
roÙ
, 
¦ave
, &
scÚf
, 1,

1240 
SND_PCM_HW_PARAM_FORMAT
, 0, &
sfÜm©
);

1241 ià(
”r
 < 0)

1242  
”r
;

1243 ià(
sfÜm©
 !ğ
SND_PCM_FORMAT_UNKNOWN
 &&

1244 
sfÜm©
 !ğ
SND_PCM_FORMAT_S16_LE
 &&

1245 
sfÜm©
 !ğ
SND_PCM_FORMAT_S16_BE
 &&

1246 
sfÜm©
 !ğ
SND_PCM_FORMAT_S24_3LE
 &&

1247 
sfÜm©
 !ğ
SND_PCM_FORMAT_S24_LE
 &&

1248 
sfÜm©
 !ğ
SND_PCM_FORMAT_S32_LE
 &&

1249 
sfÜm©
 !ğ
SND_PCM_FORMAT_S32_BE
) {

1250 
	`SNDERR
("only S16_LE, S16_BE, S24_LE, S24_3LE, S32_LE or S32_BE format is supported");

1251 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1252  -
EINVAL
;

1254 
”r
 = 
	`¢d_pcm_İ’_¦ave
(&
¥cm
, 
roÙ
, 
scÚf
, 
¡»am
, 
mode
, 
cÚf
);

1255 
	`¢d_cÚfig_d–‘e
(
scÚf
);

1256 ià(
”r
 < 0)

1257  
”r
;

1258 
”r
 = 
	`_¢d_pcm_·r£_cÚŒŞ_id
(
cÚŒŞ
, &
ùl_id
, &
ÿrd
, &
cchªÃls
);

1259 ià(
”r
 < 0) {

1260 
	`¢d_pcm_şo£
(
¥cm
);

1261  
”r
;

1263 
”r
 = 
	`¢d_pcm_soávŞ_İ’
(
pcmp
, 
Çme
, 
sfÜm©
, 
ÿrd
, &
ùl_id
,

1264 
cchªÃls
, 
mš_dB
, 
max_dB
,

1265 
»sŞutiÚ
, 
¥cm
, 1);

1266 ià(
”r
 < 0)

1267 
	`¢d_pcm_şo£
(
¥cm
);

1269  
”r
;

1270 
	}
}

1271 #iâdeà
DOC_HIDDEN


1272 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_soávŞ_İ’
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_symbols.c

21 #iâdeà
PIC


23 
	~"cÚfig.h
"

25 cÚ¡ *
_¢d_moduË_pcm_adpcm
;

26 cÚ¡ *
_¢d_moduË_pcm_®aw
;

27 cÚ¡ *
_¢d_moduË_pcm_cİy
;

28 cÚ¡ *
_¢d_moduË_pcm_fe
;

29 cÚ¡ *
_¢d_moduË_pcm_hooks
;

30 cÚ¡ *
_¢d_moduË_pcm_hw
;

31 cÚ¡ *
_¢d_moduË_pcm_lš—r
;

32 cÚ¡ *
_¢d_moduË_pcm_m‘”
;

33 cÚ¡ *
_¢d_moduË_pcm_muÏw
;

34 cÚ¡ *
_¢d_moduË_pcm_muÉi
;

35 cÚ¡ *
_¢d_moduË_pcm_nuÎ
;

36 cÚ¡ *
_¢d_moduË_pcm_em±y
;

37 cÚ¡ *
_¢d_moduË_pcm_¶ug
;

38 cÚ¡ *
_¢d_moduË_pcm_¿‹
;

39 cÚ¡ *
_¢d_moduË_pcm_rou‹
;

40 cÚ¡ *
_¢d_moduË_pcm_sh¬e
;

41 cÚ¡ *
_¢d_moduË_pcm_shm
;

42 cÚ¡ *
_¢d_moduË_pcm_læßt
;

43 cÚ¡ *
_¢d_moduË_pcm_Ïd¥a
;

44 cÚ¡ *
_¢d_moduË_pcm_dmix
;

45 cÚ¡ *
_¢d_moduË_pcm_d¢oİ
;

46 cÚ¡ *
_¢d_moduË_pcm_dsh¬e
;

47 cÚ¡ *
_¢d_moduË_pcm_asym
;

48 cÚ¡ *
_¢d_moduË_pcm_›c958
;

49 cÚ¡ *
_¢d_moduË_pcm_soávŞ
;

50 cÚ¡ *
_¢d_moduË_pcm_exlug
;

51 cÚ¡ *
_¢d_moduË_pcm_iİlug
;

52 cÚ¡ *
_¢d_moduË_pcm_mm­_emul
;

54 cÚ¡ **
	g¢d_pcm_İ’_objeùs
[] = {

55 &
_¢d_moduË_pcm_hw
,

56 
	~"pcm_symbŞs_li¡.c
"

59 *
	$¢d_pcm_İ’_symbŞs
()

61  
¢d_pcm_İ’_objeùs
;

62 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/plugin_ops.h

22 #iâdeà
SX_INLINES


23 
	#SX_INLINES


	)

24 
šlše
 
ušt32_t
 
	$sx20
(
ušt32_t
 
x
)

26 if(
x
&0x00080000)

27  
x
|0xFFF00000;

28  
x
&0x000FFFFF;

29 
	}
}

30 
šlše
 
ušt32_t
 
	$sx24
(
ušt32_t
 
x
)

32 if(
x
&0x00800000)

33  
x
|0xFF000000;

34  
x
&0x00FFFFFF;

35 
	}
}

36 
šlše
 
ušt32_t
 
	$sx24s
(
ušt32_t
 
x
)

38 if(
x
&0x00008000)

39  
x
|0x000000FF;

40  
x
&0xFFFFFF00;

41 
	}
}

44 
	#as_u8
(
±r
è(*(
ušt8_t
*)ÕŒ))

	)

45 
	#as_u16
(
±r
è(*(
ušt16_t
*)ÕŒ))

	)

46 
	#as_u32
(
±r
è(*(
ušt32_t
*)ÕŒ))

	)

47 
	#as_u64
(
±r
è(*(
ušt64_t
*)ÕŒ))

	)

48 
	#as_s8
(
±r
è(*(
št8_t
*)ÕŒ))

	)

49 
	#as_s16
(
±r
è(*(
št16_t
*)ÕŒ))

	)

50 
	#as_s32
(
±r
è(*(
št32_t
*)ÕŒ))

	)

51 
	#as_s64
(
±r
è(*(
št64_t
*)ÕŒ))

	)

52 
	#as_æßt
(
±r
è(*(
æßt_t
*)ÕŒ))

	)

53 
	#as_doubË
(
±r
è(*(
doubË_t
*)ÕŒ))

	)

55 
	#as_u8c
(
±r
è(*(cÚ¡ 
ušt8_t
*)ÕŒ))

	)

56 
	#as_u16c
(
±r
è(*(cÚ¡ 
ušt16_t
*)ÕŒ))

	)

57 
	#as_u32c
(
±r
è(*(cÚ¡ 
ušt32_t
*)ÕŒ))

	)

58 
	#as_u64c
(
±r
è(*(cÚ¡ 
ušt64_t
*)ÕŒ))

	)

59 
	#as_s8c
(
±r
è(*(cÚ¡ 
št8_t
*)ÕŒ))

	)

60 
	#as_s16c
(
±r
è(*(cÚ¡ 
št16_t
*)ÕŒ))

	)

61 
	#as_s32c
(
±r
è(*(cÚ¡ 
št32_t
*)ÕŒ))

	)

62 
	#as_s64c
(
±r
è(*(cÚ¡ 
št64_t
*)ÕŒ))

	)

63 
	#as_æßtc
(
±r
è(*(cÚ¡ 
æßt_t
*)ÕŒ))

	)

64 
	#as_doubËc
(
±r
è(*(cÚ¡ 
doubË_t
*)ÕŒ))

	)

66 
	#_g‘_ŒË_Ë
(
±r
è(*(
ušt8_t
*)ÕŒè| (
ušt32_t
)*((ušt8_t*)ÕŒè+ 1è<< 8 | (ušt32_t)*((ušt8_t*)ÕŒè+ 2è<< 16)

	)

67 
	#_g‘_ŒË_be
(
±r
è((
ušt32_t
)*(
ušt8_t
*)ÕŒè<< 16 | (ušt32_t)*((ušt8_t*)ÕŒè+ 1è<< 8 | *((ušt8_t*)ÕŒè+ 2))

	)

68 
	#_put_ŒË_Ë
(
±r
,
v®
) do { \

69 
ušt8_t
 *
_tmp
 = (ušt8_ˆ*)(
±r
); \

70 
ušt32_t
 
_v®
 = (
v®
); \

71 
_tmp
[0] = 
_v®
; \

72 
_tmp
[1] = 
_v®
 >> 8; \

73 
_tmp
[2] = 
_v®
 >> 16; \

74 } 0)

	)

75 
	#_put_ŒË_be
(
±r
,
v®
) do { \

76 
ušt8_t
 *
_tmp
 = (ušt8_ˆ*)(
±r
); \

77 
ušt32_t
 
_v®
 = (
v®
); \

78 
_tmp
[0] = 
_v®
 >> 16; \

79 
_tmp
[1] = 
_v®
 >> 8; \

80 
_tmp
[2] = 
_v®
; \

81 } 0)

	)

83 #ifdeà
SNDRV_LITTLE_ENDIAN


84 
	#_g‘_ŒË
(
±r
è
	`_g‘_ŒË_Ë
ÕŒ)

	)

85 
	#_g‘_ŒË_s
(
±r
è
	`_g‘_ŒË_be
ÕŒ)

	)

86 
	#_put_ŒË
(
±r
,
v®
è
	`_put_ŒË_Ë
ÕŒ,v®)

	)

87 
	#_put_ŒË_s
(
±r
,
v®
è
	`_put_ŒË_be
ÕŒ,v®)

	)

89 
	#_g‘_ŒË
(
±r
è
	`_g‘_ŒË_be
ÕŒ)

	)

90 
	#_g‘_ŒË_s
(
±r
è
	`_g‘_ŒË_Ë
ÕŒ)

	)

91 
	#_put_ŒË
(
±r
,
v®
è
	`_put_ŒË_be
ÕŒ,v®)

	)

92 
	#_put_ŒË_s
(
±r
,
v®
è
	`_put_ŒË_Ë
ÕŒ,v®)

	)

95 #ifdeà
CONV_LABELS


97 *cÚ¡ 
	gcÚv_Ïb–s
[4 * 2 * 2 * 4 * 2] = {

98 &&
cÚv_xxx1_xxx1
,

99 &&
cÚv_xxx1_xxx1
,

100 &&
cÚv_xxx1_xx10
,

101 &&
cÚv_xxx1_xx01
,

102 &&
cÚv_xxx1_x100
,

103 &&
cÚv_xxx1_001x
,

104 &&
cÚv_xxx1_1000
,

105 &&
cÚv_xxx1_0001
,

106 &&
cÚv_xxx1_xxx9
,

107 &&
cÚv_xxx1_xxx9
,

108 &&
cÚv_xxx1_xx90
,

109 &&
cÚv_xxx1_xx09
,

110 &&
cÚv_xxx1_x900
,

111 &&
cÚv_xxx1_009x
,

112 &&
cÚv_xxx1_9000
,

113 &&
cÚv_xxx1_0009
,

114 &&
cÚv_xxx1_xxx1
,

115 &&
cÚv_xxx1_xxx1
,

116 &&
cÚv_xxx1_xx10
,

117 &&
cÚv_xxx1_xx01
,

118 &&
cÚv_xxx1_x100
,

119 &&
cÚv_xxx1_001x
,

120 &&
cÚv_xxx1_1000
,

121 &&
cÚv_xxx1_0001
,

122 &&
cÚv_xxx1_xxx9
,

123 &&
cÚv_xxx1_xxx9
,

124 &&
cÚv_xxx1_xx90
,

125 &&
cÚv_xxx1_xx09
,

126 &&
cÚv_xxx1_x900
,

127 &&
cÚv_xxx1_009x
,

128 &&
cÚv_xxx1_9000
,

129 &&
cÚv_xxx1_0009
,

130 &&
cÚv_xx12_xxx1
,

131 &&
cÚv_xx12_xxx1
,

132 &&
cÚv_xx12_xx12
,

133 &&
cÚv_xx12_xx21
,

134 &&
cÚv_xx12_x120
,

135 &&
cÚv_xx12_021x
,

136 &&
cÚv_xx12_1200
,

137 &&
cÚv_xx12_0021
,

138 &&
cÚv_xx12_xxx9
,

139 &&
cÚv_xx12_xxx9
,

140 &&
cÚv_xx12_xx92
,

141 &&
cÚv_xx12_xx29
,

142 &&
cÚv_xx12_x920
,

143 &&
cÚv_xx12_029x
,

144 &&
cÚv_xx12_9200
,

145 &&
cÚv_xx12_0029
,

146 &&
cÚv_xx12_xxx2
,

147 &&
cÚv_xx12_xxx2
,

148 &&
cÚv_xx12_xx21
,

149 &&
cÚv_xx12_xx12
,

150 &&
cÚv_xx12_x210
,

151 &&
cÚv_xx12_012x
,

152 &&
cÚv_xx12_2100
,

153 &&
cÚv_xx12_0012
,

154 &&
cÚv_xx12_xxxA
,

155 &&
cÚv_xx12_xxxA
,

156 &&
cÚv_xx12_xxA1
,

157 &&
cÚv_xx12_xx1A
,

158 &&
cÚv_xx12_xA10
,

159 &&
cÚv_xx12_01Ax
,

160 &&
cÚv_xx12_A100
,

161 &&
cÚv_xx12_001A
,

162 &&
cÚv_x123_xxx1
,

163 &&
cÚv_x123_xxx1
,

164 &&
cÚv_x123_xx12
,

165 &&
cÚv_x123_xx21
,

166 &&
cÚv_x123_x123
,

167 &&
cÚv_x123_321x
,

168 &&
cÚv_x123_1230
,

169 &&
cÚv_x123_0321
,

170 &&
cÚv_x123_xxx9
,

171 &&
cÚv_x123_xxx9
,

172 &&
cÚv_x123_xx92
,

173 &&
cÚv_x123_xx29
,

174 &&
cÚv_x123_x923
,

175 &&
cÚv_x123_329x
,

176 &&
cÚv_x123_9230
,

177 &&
cÚv_x123_0329
,

178 &&
cÚv_123x_xxx3
,

179 &&
cÚv_123x_xxx3
,

180 &&
cÚv_123x_xx32
,

181 &&
cÚv_123x_xx23
,

182 &&
cÚv_123x_x321
,

183 &&
cÚv_123x_123x
,

184 &&
cÚv_123x_3210
,

185 &&
cÚv_123x_0123
,

186 &&
cÚv_123x_xxxB
,

187 &&
cÚv_123x_xxxB
,

188 &&
cÚv_123x_xxB2
,

189 &&
cÚv_123x_xx2B
,

190 &&
cÚv_123x_xB21
,

191 &&
cÚv_123x_12Bx
,

192 &&
cÚv_123x_B210
,

193 &&
cÚv_123x_012B
,

194 &&
cÚv_1234_xxx1
,

195 &&
cÚv_1234_xxx1
,

196 &&
cÚv_1234_xx12
,

197 &&
cÚv_1234_xx21
,

198 &&
cÚv_1234_x123
,

199 &&
cÚv_1234_321x
,

200 &&
cÚv_1234_1234
,

201 &&
cÚv_1234_4321
,

202 &&
cÚv_1234_xxx9
,

203 &&
cÚv_1234_xxx9
,

204 &&
cÚv_1234_xx92
,

205 &&
cÚv_1234_xx29
,

206 &&
cÚv_1234_x923
,

207 &&
cÚv_1234_329x
,

208 &&
cÚv_1234_9234
,

209 &&
cÚv_1234_4329
,

210 &&
cÚv_1234_xxx4
,

211 &&
cÚv_1234_xxx4
,

212 &&
cÚv_1234_xx43
,

213 &&
cÚv_1234_xx34
,

214 &&
cÚv_1234_x432
,

215 &&
cÚv_1234_234x
,

216 &&
cÚv_1234_4321
,

217 &&
cÚv_1234_1234
,

218 &&
cÚv_1234_xxxC
,

219 &&
cÚv_1234_xxxC
,

220 &&
cÚv_1234_xxC3
,

221 &&
cÚv_1234_xx3C
,

222 &&
cÚv_1234_xC32
,

223 &&
cÚv_1234_23Cx
,

224 &&
cÚv_1234_C321
,

225 &&
cÚv_1234_123C
,

229 #ifdeà
CONV_END


231 
cÚv_xxx1_xxx1
: 
	`as_u8
(
d¡
èğ
	`as_u8c
(
¤c
); 
CONV_END
;

232 
cÚv_xxx1_xx10
: 
	`as_u16
(
d¡
èğ(
ušt16_t
)
	`as_u8c
(
¤c
è<< 8; 
CONV_END
;

233 
cÚv_xxx1_xx01
: 
	`as_u16
(
d¡
èğ(
ušt16_t
)
	`as_u8c
(
¤c
); 
CONV_END
;

234 
cÚv_xxx1_x100
: 
	`as_u32
(
d¡
èğ
	`sx24
((
ušt32_t
)
	`as_u8c
(
¤c
è<< 16); 
CONV_END
;

235 
cÚv_xxx1_001x
: 
	`as_u32
(
d¡
èğ
	`sx24s
((
ušt32_t
)
	`as_u8c
(
¤c
è<< 8); 
CONV_END
;

236 
cÚv_xxx1_1000
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)
	`as_u8c
(
¤c
è<< 24; 
CONV_END
;

237 
cÚv_xxx1_0001
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)
	`as_u8c
(
¤c
); 
CONV_END
;

238 
cÚv_xxx1_xxx9
: 
	`as_u8
(
d¡
èğ
	`as_u8c
(
¤c
è^ 0x80; 
CONV_END
;

239 
cÚv_xxx1_xx90
: 
	`as_u16
(
d¡
èğ(
ušt16_t
)(
	`as_u8c
(
¤c
è^ 0x80è<< 8; 
CONV_END
;

240 
cÚv_xxx1_xx09
: 
	`as_u16
(
d¡
èğ(
ušt16_t
)(
	`as_u8c
(
¤c
è^ 0x80); 
CONV_END
;

241 
cÚv_xxx1_x900
: 
	`as_u32
(
d¡
èğ
	`sx24
((
ušt32_t
)(
	`as_u8c
(
¤c
è^ 0x80è<< 16); 
CONV_END
;

242 
cÚv_xxx1_009x
: 
	`as_u32
(
d¡
èğ
	`sx24s
((
ušt32_t
)(
	`as_u8c
(
¤c
è^ 0x80è<< 8); 
CONV_END
;

243 
cÚv_xxx1_9000
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)(
	`as_u8c
(
¤c
è^ 0x80è<< 24; 
CONV_END
;

244 
cÚv_xxx1_0009
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)(
	`as_u8c
(
¤c
è^ 0x80); 
CONV_END
;

245 
cÚv_xx12_xxx1
: 
	`as_u8
(
d¡
èğ
	`as_u16c
(
¤c
è>> 8; 
CONV_END
;

246 
cÚv_xx12_xx12
: 
	`as_u16
(
d¡
èğ
	`as_u16c
(
¤c
); 
CONV_END
;

247 
cÚv_xx12_xx21
: 
	`as_u16
(
d¡
èğ
	`bsw­_16
(
	`as_u16c
(
¤c
)); 
CONV_END
;

248 
cÚv_xx12_x120
: 
	`as_u32
(
d¡
èğ
	`sx24
((
ušt32_t
)
	`as_u16c
(
¤c
è<< 8); 
CONV_END
;

249 
cÚv_xx12_021x
: 
	`as_u32
(
d¡
èğ
	`sx24s
((
ušt32_t
)
	`bsw­_16
(
	`as_u16c
(
¤c
)è<< 8); 
CONV_END
;

250 
cÚv_xx12_1200
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)
	`as_u16c
(
¤c
è<< 16; 
CONV_END
;

251 
cÚv_xx12_0021
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)
	`bsw­_16
(
	`as_u16c
(
¤c
)); 
CONV_END
;

252 
cÚv_xx12_xxx9
: 
	`as_u8
(
d¡
èğ(
	`as_u16c
(
¤c
è>> 8è^ 0x80; 
CONV_END
;

253 
cÚv_xx12_xx92
: 
	`as_u16
(
d¡
èğ
	`as_u16c
(
¤c
è^ 0x8000; 
CONV_END
;

254 
cÚv_xx12_xx29
: 
	`as_u16
(
d¡
èğ
	`bsw­_16
(
	`as_u16c
(
¤c
)è^ 0x80; 
CONV_END
;

255 
cÚv_xx12_x920
: 
	`as_u32
(
d¡
èğ
	`sx24
((
ušt32_t
)(
	`as_u16c
(
¤c
è^ 0x8000è<< 8); 
CONV_END
;

256 
cÚv_xx12_029x
: 
	`as_u32
(
d¡
èğ
	`sx24s
((
ušt32_t
)(
	`bsw­_16
(
	`as_u16c
(
¤c
)è^ 0x80è<< 8); 
CONV_END
;

257 
cÚv_xx12_9200
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)(
	`as_u16c
(
¤c
è^ 0x8000è<< 16; 
CONV_END
;

258 
cÚv_xx12_0029
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)(
	`bsw­_16
(
	`as_u16c
(
¤c
)è^ 0x80); 
CONV_END
;

259 
cÚv_xx12_xxx2
: 
	`as_u8
(
d¡
èğ
	`as_u16c
(
¤c
è& 0xff; 
CONV_END
;

260 
cÚv_xx12_x210
: 
	`as_u32
(
d¡
èğ
	`sx24
((
ušt32_t
)
	`bsw­_16
(
	`as_u16c
(
¤c
)è<< 8); 
CONV_END
;

261 
cÚv_xx12_012x
: 
	`as_u32
(
d¡
èğ
	`sx24s
((
ušt32_t
)
	`as_u16c
(
¤c
è<< 8); 
CONV_END
;

262 
cÚv_xx12_2100
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)
	`bsw­_16
(
	`as_u16c
(
¤c
)è<< 16; 
CONV_END
;

263 
cÚv_xx12_0012
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)
	`as_u16c
(
¤c
); 
CONV_END
;

264 
cÚv_xx12_xxxA
: 
	`as_u8
(
d¡
èğ(
	`as_u16c
(
¤c
è^ 0x80è& 0xff; 
CONV_END
;

265 
cÚv_xx12_xxA1
: 
	`as_u16
(
d¡
èğ
	`bsw­_16
(
	`as_u16c
(
¤c
è^ 0x80); 
CONV_END
;

266 
cÚv_xx12_xx1A
: 
	`as_u16
(
d¡
èğ
	`as_u16c
(
¤c
è^ 0x80; 
CONV_END
;

267 
cÚv_xx12_xA10
: 
	`as_u32
(
d¡
èğ
	`sx24
((
ušt32_t
)
	`bsw­_16
(
	`as_u16c
(
¤c
è^ 0x80è<< 8); 
CONV_END
;

268 
cÚv_xx12_01Ax
: 
	`as_u32
(
d¡
èğ
	`sx24s
((
ušt32_t
)(
	`as_u16c
(
¤c
è^ 0x80è<< 8); 
CONV_END
;

269 
cÚv_xx12_A100
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)
	`bsw­_16
(
	`as_u16c
(
¤c
è^ 0x80è<< 16; 
CONV_END
;

270 
cÚv_xx12_001A
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)(
	`as_u16c
(
¤c
è^ 0x80); 
CONV_END
;

271 
cÚv_x123_xxx1
: 
	`as_u8
(
d¡
èğ
	`as_u32c
(
¤c
è>> 16; 
CONV_END
;

272 
cÚv_x123_xx12
: 
	`as_u16
(
d¡
èğ
	`as_u32c
(
¤c
è>> 8; 
CONV_END
;

273 
cÚv_x123_xx21
: 
	`as_u16
(
d¡
èğ
	`bsw­_16
(
	`as_u32c
(
¤c
è>> 8); 
CONV_END
;

274 
cÚv_x123_x123
: 
	`as_u32
(
d¡
èğ
	`sx24
(
	`as_u32c
(
¤c
)); 
CONV_END
;

275 
cÚv_x123_321x
: 
	`as_u32
(
d¡
èğ
	`sx24s
(
	`bsw­_32
(
	`as_u32c
(
¤c
))); 
CONV_END
;

276 
cÚv_x123_1230
: 
	`as_u32
(
d¡
èğ
	`as_u32c
(
¤c
è<< 8; 
CONV_END
;

277 
cÚv_x123_0321
: 
	`as_u32
(
d¡
èğ
	`bsw­_32
(
	`as_u32c
(
¤c
)è>> 8; 
CONV_END
;

278 
cÚv_x123_xxx9
: 
	`as_u8
(
d¡
èğ(
	`as_u32c
(
¤c
è>> 16è^ 0x80; 
CONV_END
;

279 
cÚv_x123_xx92
: 
	`as_u16
(
d¡
èğ(
	`as_u32c
(
¤c
è>> 8è^ 0x8000; 
CONV_END
;

280 
cÚv_x123_xx29
: 
	`as_u16
(
d¡
èğ
	`bsw­_16
(
	`as_u32c
(
¤c
è>> 8è^ 0x80; 
CONV_END
;

281 
cÚv_x123_x923
: 
	`as_u32
(
d¡
èğ
	`sx24
(
	`as_u32c
(
¤c
è^ 0x800000); 
CONV_END
;

282 
cÚv_x123_329x
: 
	`as_u32
(
d¡
èğ
	`sx24s
(
	`bsw­_32
(
	`as_u32c
(
¤c
)è^ 0x8000); 
CONV_END
;

283 
cÚv_x123_9230
: 
	`as_u32
(
d¡
èğ(
	`as_u32c
(
¤c
è^ 0x800000è<< 8; 
CONV_END
;

284 
cÚv_x123_0329
: 
	`as_u32
(
d¡
èğ(
	`bsw­_32
(
	`as_u32c
(
¤c
)è>> 8è^ 0x80; 
CONV_END
;

285 
cÚv_123x_xxx3
: 
	`as_u8
(
d¡
èğ(
	`as_u32c
(
¤c
è>> 8è& 0xff; 
CONV_END
;

286 
cÚv_123x_xx32
: 
	`as_u16
(
d¡
èğ
	`bsw­_16
(
	`as_u32c
(
¤c
è>> 8); 
CONV_END
;

287 
cÚv_123x_xx23
: 
	`as_u16
(
d¡
èğ(
	`as_u32c
(
¤c
è>> 8è& 0xffff; 
CONV_END
;

288 
cÚv_123x_x321
: 
	`as_u32
(
d¡
èğ
	`sx24
(
	`bsw­_32
(
	`as_u32c
(
¤c
))); 
CONV_END
;

289 
cÚv_123x_123x
: 
	`as_u32
(
d¡
èğ
	`sx24s
(
	`as_u32c
(
¤c
)); 
CONV_END
;

290 
cÚv_123x_3210
: 
	`as_u32
(
d¡
èğ
	`bsw­_32
(
	`as_u32c
(
¤c
)è<< 8; 
CONV_END
;

291 
cÚv_123x_0123
: 
	`as_u32
(
d¡
èğ
	`as_u32c
(
¤c
è>> 8; 
CONV_END
;

292 
cÚv_123x_xxxB
: 
	`as_u8
(
d¡
èğ((
	`as_u32c
(
¤c
è>> 8è& 0xffè^ 0x80; 
CONV_END
;

293 
cÚv_123x_xxB2
: 
	`as_u16
(
d¡
èğ
	`bsw­_16
((
	`as_u32c
(
¤c
è>> 8è^ 0x80); 
CONV_END
;

294 
cÚv_123x_xx2B
: 
	`as_u16
(
d¡
èğ((
	`as_u32c
(
¤c
è>> 8è& 0xffffè^ 0x80; 
CONV_END
;

295 
cÚv_123x_xB21
: 
	`as_u32
(
d¡
èğ
	`sx24
(
	`bsw­_32
(
	`as_u32c
(
¤c
)è^ 0x800000); 
CONV_END
;

296 
cÚv_123x_12Bx
: 
	`as_u32
(
d¡
èğ
	`sx24s
(
	`as_u32c
(
¤c
è^ 0x8000); 
CONV_END
;

297 
cÚv_123x_B210
: 
	`as_u32
(
d¡
èğ
	`bsw­_32
(
	`as_u32c
(
¤c
è^ 0x8000è<< 8; 
CONV_END
;

298 
cÚv_123x_012B
: 
	`as_u32
(
d¡
èğ(
	`as_u32c
(
¤c
è>> 8è^ 0x80; 
CONV_END
;

299 
cÚv_1234_xxx1
: 
	`as_u8
(
d¡
èğ
	`as_u32c
(
¤c
è>> 24; 
CONV_END
;

300 
cÚv_1234_xx12
: 
	`as_u16
(
d¡
èğ
	`as_u32c
(
¤c
è>> 16; 
CONV_END
;

301 
cÚv_1234_xx21
: 
	`as_u16
(
d¡
èğ
	`bsw­_16
(
	`as_u32c
(
¤c
è>> 16); 
CONV_END
;

302 
cÚv_1234_x123
: 
	`as_u32
(
d¡
èğ
	`sx24
(
	`as_u32c
(
¤c
è>> 8); 
CONV_END
;

303 
cÚv_1234_321x
: 
	`as_u32
(
d¡
èğ
	`sx24s
(
	`bsw­_32
(
	`as_u32c
(
¤c
)è<< 8); 
CONV_END
;

304 
cÚv_1234_1234
: 
	`as_u32
(
d¡
èğ
	`as_u32c
(
¤c
); 
CONV_END
;

305 
cÚv_1234_4321
: 
	`as_u32
(
d¡
èğ
	`bsw­_32
(
	`as_u32c
(
¤c
)); 
CONV_END
;

306 
cÚv_1234_xxx9
: 
	`as_u8
(
d¡
èğ(
	`as_u32c
(
¤c
è>> 24è^ 0x80; 
CONV_END
;

307 
cÚv_1234_xx92
: 
	`as_u16
(
d¡
èğ(
	`as_u32c
(
¤c
è>> 16è^ 0x8000; 
CONV_END
;

308 
cÚv_1234_xx29
: 
	`as_u16
(
d¡
èğ
	`bsw­_16
(
	`as_u32c
(
¤c
è>> 16è^ 0x80; 
CONV_END
;

309 
cÚv_1234_x923
: 
	`as_u32
(
d¡
èğ
	`sx24
((
	`as_u32c
(
¤c
è>> 8è^ 0x800000); 
CONV_END
;

310 
cÚv_1234_329x
: 
	`as_u32
(
d¡
èğ
	`sx24s
((
	`bsw­_32
(
	`as_u32c
(
¤c
)è^ 0x80è<< 8); 
CONV_END
;

311 
cÚv_1234_9234
: 
	`as_u32
(
d¡
èğ
	`as_u32c
(
¤c
è^ 0x80000000; 
CONV_END
;

312 
cÚv_1234_4329
: 
	`as_u32
(
d¡
èğ
	`bsw­_32
(
	`as_u32c
(
¤c
)è^ 0x80; 
CONV_END
;

313 
cÚv_1234_xxx4
: 
	`as_u8
(
d¡
èğ
	`as_u32c
(
¤c
è& 0xff; 
CONV_END
;

314 
cÚv_1234_xx43
: 
	`as_u16
(
d¡
èğ
	`bsw­_16
(
	`as_u32c
(
¤c
)); 
CONV_END
;

315 
cÚv_1234_xx34
: 
	`as_u16
(
d¡
èğ
	`as_u32c
(
¤c
è& 0xffff; 
CONV_END
;

316 
cÚv_1234_x432
: 
	`as_u32
(
d¡
èğ
	`sx24
(
	`bsw­_32
(
	`as_u32c
(
¤c
)è>> 8); 
CONV_END
;

317 
cÚv_1234_234x
: 
	`as_u32
(
d¡
èğ
	`sx24s
(
	`as_u32c
(
¤c
è<< 8); 
CONV_END
;

318 
cÚv_1234_xxxC
: 
	`as_u8
(
d¡
èğ(
	`as_u32c
(
¤c
è& 0xffè^ 0x80; 
CONV_END
;

319 
cÚv_1234_xxC3
: 
	`as_u16
(
d¡
èğ
	`bsw­_16
(
	`as_u32c
(
¤c
è^ 0x80); 
CONV_END
;

320 
cÚv_1234_xx3C
: 
	`as_u16
(
d¡
èğ(
	`as_u32c
(
¤c
è& 0xffffè^ 0x80; 
CONV_END
;

321 
cÚv_1234_xC32
: 
	`as_u32
(
d¡
èğ
	`sx24
((
	`bsw­_32
(
	`as_u32c
(
¤c
)è>> 8è^ 0x800000); 
CONV_END
;

322 
cÚv_1234_23Cx
: 
	`as_u32
(
d¡
èğ
	`sx24s
((
	`as_u32c
(
¤c
è^ 0x80è<< 8); 
CONV_END
;

323 
cÚv_1234_C321
: 
	`as_u32
(
d¡
èğ
	`bsw­_32
(
	`as_u32c
(
¤c
è^ 0x80); 
CONV_END
;

324 
cÚv_1234_123C
: 
	`as_u32
(
d¡
èğ
	`as_u32c
(
¤c
è^ 0x80; 
CONV_END
;

325 
	}
}

328 #ifdeà
GET16_LABELS


330 *cÚ¡ 
	gg‘16_Ïb–s
[5 * 2 * 2 + 4 * 3] = {

331 &&
g‘16_1_10
,

332 &&
g‘16_1_90
,

333 &&
g‘16_1_10
,

334 &&
g‘16_1_90
,

335 &&
g‘16_12_12
,

336 &&
g‘16_12_92
,

337 &&
g‘16_12_21
,

338 &&
g‘16_12_A1
,

340 &&
g‘16_0123_12
,

341 &&
g‘16_0123_92
,

342 &&
g‘16_1230_32
,

343 &&
g‘16_1230_B2
,

344 &&
g‘16_1234_12
,

345 &&
g‘16_1234_92
,

346 &&
g‘16_1234_43
,

347 &&
g‘16_1234_C3
,

348 &&
g‘16_0123_12_20
,

349 &&
g‘16_0123_92_20
,

350 &&
g‘16_1230_32_20
,

351 &&
g‘16_1230_B2_20
,

353 &&
g‘16_123_12
,

354 &&
g‘16_123_92
,

355 &&
g‘16_123_32
,

356 &&
g‘16_123_B2
,

357 &&
g‘16_123_12_20
,

358 &&
g‘16_123_92_20
,

359 &&
g‘16_123_32_20
,

360 &&
g‘16_123_B2_20
,

361 &&
g‘16_123_12_18
,

362 &&
g‘16_123_92_18
,

363 &&
g‘16_123_32_18
,

364 &&
g‘16_123_B2_18
,

368 #ifdeà
GET16_END


370 
g‘16_1_10
: 
§m¶e
 = (
ušt16_t
)
	`as_u8c
(
¤c
è<< 8; 
GET16_END
;

371 
g‘16_1_90
: 
§m¶e
 = (
ušt16_t
)(
	`as_u8c
(
¤c
è^ 0x80è<< 8; 
GET16_END
;

372 
g‘16_12_12
: 
§m¶e
 = 
	`as_u16c
(
¤c
); 
GET16_END
;

373 
g‘16_12_92
: 
§m¶e
 = 
	`as_u16c
(
¤c
è^ 0x8000; 
GET16_END
;

374 
g‘16_12_21
: 
§m¶e
 = 
	`bsw­_16
(
	`as_u16c
(
¤c
)); 
GET16_END
;

375 
g‘16_12_A1
: 
§m¶e
 = 
	`bsw­_16
(
	`as_u16c
(
¤c
è^ 0x80); 
GET16_END
;

376 
g‘16_0123_12
: 
§m¶e
 = 
	`as_u32c
(
¤c
è>> 8; 
GET16_END
;

377 
g‘16_0123_92
: 
§m¶e
 = (
	`as_u32c
(
¤c
è>> 8è^ 0x8000; 
GET16_END
;

378 
g‘16_1230_32
: 
§m¶e
 = 
	`bsw­_16
(
	`as_u32c
(
¤c
è>> 8); 
GET16_END
;

379 
g‘16_1230_B2
: 
§m¶e
 = 
	`bsw­_16
((
	`as_u32c
(
¤c
è>> 8è^ 0x80); 
GET16_END
;

380 
g‘16_1234_12
: 
§m¶e
 = 
	`as_u32c
(
¤c
è>> 16; 
GET16_END
;

381 
g‘16_1234_92
: 
§m¶e
 = (
	`as_u32c
(
¤c
è>> 16è^ 0x8000; 
GET16_END
;

382 
g‘16_1234_43
: 
§m¶e
 = 
	`bsw­_16
(
	`as_u32c
(
¤c
)); 
GET16_END
;

383 
g‘16_1234_C3
: 
§m¶e
 = 
	`bsw­_16
(
	`as_u32c
(
¤c
è^ 0x80); 
GET16_END
;

384 
g‘16_0123_12_20
: 
§m¶e
 = 
	`as_u32c
(
¤c
è>> 4; 
GET16_END
;

385 
g‘16_0123_92_20
: 
§m¶e
 = (
	`as_u32c
(
¤c
è>> 4è^ 0x8000; 
GET16_END
;

386 
g‘16_1230_32_20
: 
§m¶e
 = 
	`bsw­_32
(
	`as_u32c
(
¤c
)è>> 4; 
GET16_END
;

387 
g‘16_1230_B2_20
: 
§m¶e
 = (
	`bsw­_32
(
	`as_u32c
(
¤c
)è>> 4è^ 0x8000; 
GET16_END
;

388 
g‘16_123_12
: 
§m¶e
 = 
	`_g‘_ŒË
(
¤c
è>> 8; 
GET16_END
;

389 
g‘16_123_92
: 
§m¶e
 = (
	`_g‘_ŒË
(
¤c
è>> 8è^ 0x8000; 
GET16_END
;

390 
g‘16_123_32
: 
§m¶e
 = 
	`_g‘_ŒË_s
(
¤c
è>> 8; 
GET16_END
;

391 
g‘16_123_B2
: 
§m¶e
 = (
	`_g‘_ŒË_s
(
¤c
è>> 8è^ 0x8000; 
GET16_END
;

392 
g‘16_123_12_20
: 
§m¶e
 = 
	`_g‘_ŒË
(
¤c
è>> 4; 
GET16_END
;

393 
g‘16_123_92_20
: 
§m¶e
 = (
	`_g‘_ŒË
(
¤c
è>> 4è^ 0x8000; 
GET16_END
;

394 
g‘16_123_32_20
: 
§m¶e
 = 
	`_g‘_ŒË_s
(
¤c
è>> 4; 
GET16_END
;

395 
g‘16_123_B2_20
: 
§m¶e
 = (
	`_g‘_ŒË_s
(
¤c
è>> 4è^ 0x8000; 
GET16_END
;

396 
g‘16_123_12_18
: 
§m¶e
 = 
	`_g‘_ŒË
(
¤c
è>> 2; 
GET16_END
;

397 
g‘16_123_92_18
: 
§m¶e
 = (
	`_g‘_ŒË
(
¤c
è>> 2è^ 0x8000; 
GET16_END
;

398 
g‘16_123_32_18
: 
§m¶e
 = 
	`_g‘_ŒË_s
(
¤c
è>> 2; 
GET16_END
;

399 
g‘16_123_B2_18
: 
§m¶e
 = (
	`_g‘_ŒË_s
(
¤c
è>> 2è^ 0x8000; 
GET16_END
;

400 
	}
}

403 #ifdeà
PUT16_LABELS


405 *cÚ¡ 
	gput16_Ïb–s
[5 * 2 * 2 + 4 * 3] = {

406 &&
put16_12_1
,

407 &&
put16_12_9
,

408 &&
put16_12_1
,

409 &&
put16_12_9
,

410 &&
put16_12_12
,

411 &&
put16_12_92
,

412 &&
put16_12_21
,

413 &&
put16_12_29
,

415 &&
put16_12_0120
,

416 &&
put16_12_0920
,

417 &&
put16_12_0210
,

418 &&
put16_12_0290
,

419 &&
put16_12_1200
,

420 &&
put16_12_9200
,

421 &&
put16_12_0021
,

422 &&
put16_12_0029
,

423 &&
put16_12_0120_20
,

424 &&
put16_12_0920_20
,

425 &&
put16_12_0210_20
,

426 &&
put16_12_0290_20
,

428 &&
put16_12_120
,

429 &&
put16_12_920
,

430 &&
put16_12_021
,

431 &&
put16_12_029
,

432 &&
put16_12_120_20
,

433 &&
put16_12_920_20
,

434 &&
put16_12_021_20
,

435 &&
put16_12_029_20
,

436 &&
put16_12_120_18
,

437 &&
put16_12_920_18
,

438 &&
put16_12_021_18
,

439 &&
put16_12_029_18
,

443 #ifdeà
PUT16_END


445 
put16_12_1
: 
	`as_u8
(
d¡
èğ
§m¶e
 >> 8; 
PUT16_END
;

446 
put16_12_9
: 
	`as_u8
(
d¡
èğ(
§m¶e
 >> 8è^ 0x80; 
PUT16_END
;

447 
put16_12_12
: 
	`as_u16
(
d¡
èğ
§m¶e
; 
PUT16_END
;

448 
put16_12_92
: 
	`as_u16
(
d¡
èğ
§m¶e
 ^ 0x8000; 
PUT16_END
;

449 
put16_12_21
: 
	`as_u16
(
d¡
èğ
	`bsw­_16
(
§m¶e
); 
PUT16_END
;

450 
put16_12_29
: 
	`as_u16
(
d¡
èğ
	`bsw­_16
(
§m¶e
è^ 0x80; 
PUT16_END
;

451 
put16_12_0120
: 
	`as_u32
(
d¡
èğ
	`sx24
((
ušt32_t
)
§m¶e
 << 8); 
PUT16_END
;

452 
put16_12_0920
: 
	`as_u32
(
d¡
èğ
	`sx24
((
ušt32_t
)(
§m¶e
 ^ 0x8000è<< 8); 
PUT16_END
;

453 
put16_12_0210
: 
	`as_u32
(
d¡
èğ
	`sx24s
((
ušt32_t
)
	`bsw­_16
(
§m¶e
è<< 8); 
PUT16_END
;

454 
put16_12_0290
: 
	`as_u32
(
d¡
èğ
	`sx24s
((
ušt32_t
)(
	`bsw­_16
(
§m¶e
è^ 0x80è<< 8); 
PUT16_END
;

455 
put16_12_1200
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)
§m¶e
 << 16; 
PUT16_END
;

456 
put16_12_9200
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)(
§m¶e
 ^ 0x8000è<< 16; 
PUT16_END
;

457 
put16_12_0021
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)
	`bsw­_16
(
§m¶e
); 
PUT16_END
;

458 
put16_12_0029
: 
	`as_u32
(
d¡
èğ(
ušt32_t
)
	`bsw­_16
(
§m¶e
è^ 0x80; 
PUT16_END
;

459 
put16_12_0120_20
: 
	`as_u32
(
d¡
èğ
	`sx20
((
ušt32_t
)
§m¶e
 << 4); 
PUT16_END
;

460 
put16_12_0920_20
: 
	`as_u32
(
d¡
èğ
	`sx20
((
ušt32_t
)(
§m¶e
 ^ 0x8000è<< 4); 
PUT16_END
;

461 
put16_12_0210_20
: 
	`as_u32
(
d¡
èğ
	`bsw­_32
(
	`sx20
((
ušt32_t
)
§m¶e
 << 4)); 
PUT16_END
;

462 
put16_12_0290_20
: 
	`as_u32
(
d¡
èğ
	`bsw­_32
(
	`sx20
((
ušt32_t
)(
§m¶e
 ^ 0x8000è<< 4)); 
PUT16_END
;

463 
put16_12_120
: 
	`_put_ŒË
(
d¡
, (
ušt32_t
)
§m¶e
 << 8); 
PUT16_END
;

464 
put16_12_920
: 
	`_put_ŒË
(
d¡
, (
ušt32_t
)(
§m¶e
 ^ 0x8000è<< 8); 
PUT16_END
;

465 
put16_12_021
: 
	`_put_ŒË_s
(
d¡
, (
ušt32_t
)
§m¶e
 << 8); 
PUT16_END
;

466 
put16_12_029
: 
	`_put_ŒË_s
(
d¡
, (
ušt32_t
)(
§m¶e
 ^ 0x8000è<< 8); 
PUT16_END
;

467 
put16_12_120_20
: 
	`_put_ŒË
(
d¡
, (
ušt32_t
)
§m¶e
 << 4); 
PUT16_END
;

468 
put16_12_920_20
: 
	`_put_ŒË
(
d¡
, (
ušt32_t
)(
§m¶e
 ^ 0x8000è<< 4); 
PUT16_END
;

469 
put16_12_021_20
: 
	`_put_ŒË_s
(
d¡
, (
ušt32_t
)
§m¶e
 << 4); 
PUT16_END
;

470 
put16_12_029_20
: 
	`_put_ŒË_s
(
d¡
, (
ušt32_t
)(
§m¶e
 ^ 0x8000è<< 4); 
PUT16_END
;

471 
put16_12_120_18
: 
	`_put_ŒË
(
d¡
, (
ušt32_t
)
§m¶e
 << 2); 
PUT16_END
;

472 
put16_12_920_18
: 
	`_put_ŒË
(
d¡
, (
ušt32_t
)(
§m¶e
 ^ 0x8000è<< 2); 
PUT16_END
;

473 
put16_12_021_18
: 
	`_put_ŒË_s
(
d¡
, (
ušt32_t
)
§m¶e
 << 2); 
PUT16_END
;

474 
put16_12_029_18
: 
	`_put_ŒË_s
(
d¡
, (
ušt32_t
)(
§m¶e
 ^ 0x8000è<< 2); 
PUT16_END
;

475 
	}
}

478 #ifdeà
CONV24_LABELS


479 
	#GET32_LABELS


	)

480 
	#PUT32_LABELS


	)

483 #ifdeà
GET32_LABELS


485 *cÚ¡ 
	gg‘32_Ïb–s
[5 * 2 * 2 + 4 * 3] = {

486 &&
g‘32_1_1000
,

487 &&
g‘32_1_9000
,

488 &&
g‘32_1_1000
,

489 &&
g‘32_1_9000
,

490 &&
g‘32_12_1200
,

491 &&
g‘32_12_9200
,

492 &&
g‘32_12_2100
,

493 &&
g‘32_12_A100
,

495 &&
g‘32_0123_1230
,

496 &&
g‘32_0123_9230
,

497 &&
g‘32_1230_3210
,

498 &&
g‘32_1230_B210
,

499 &&
g‘32_1234_1234
,

500 &&
g‘32_1234_9234
,

501 &&
g‘32_1234_4321
,

502 &&
g‘32_1234_C321
,

503 &&
g‘32_0123_1230_20
,

504 &&
g‘32_0123_9230_20
,

505 &&
g‘32_1230_3210_20
,

506 &&
g‘32_1230_B210_20
,

508 &&
g‘32_123_1230
,

509 &&
g‘32_123_9230
,

510 &&
g‘32_123_3210
,

511 &&
g‘32_123_B210
,

512 &&
g‘32_123_1230_20
,

513 &&
g‘32_123_9230_20
,

514 &&
g‘32_123_3210_20
,

515 &&
g‘32_123_B210_20
,

516 &&
g‘32_123_1230_18
,

517 &&
g‘32_123_9230_18
,

518 &&
g‘32_123_3210_18
,

519 &&
g‘32_123_B210_18
,

523 #ifdeà
CONV24_END


524 
	#GET32_END
 
__cÚv24_g‘


	)

527 #ifdeà
GET32_END


529 
g‘32_1_1000
: 
§m¶e
 = (
ušt32_t
)
	`as_u8c
(
¤c
è<< 24; 
GET32_END
;

530 
g‘32_1_9000
: 
§m¶e
 = (
ušt32_t
)(
	`as_u8c
(
¤c
è^ 0x80è<< 24; 
GET32_END
;

531 
g‘32_12_1200
: 
§m¶e
 = (
ušt32_t
)
	`as_u16c
(
¤c
è<< 16; 
GET32_END
;

532 
g‘32_12_9200
: 
§m¶e
 = (
ušt32_t
)(
	`as_u16c
(
¤c
è^ 0x8000è<< 16; 
GET32_END
;

533 
g‘32_12_2100
: 
§m¶e
 = (
ušt32_t
)
	`bsw­_16
(
	`as_u16c
(
¤c
)è<< 16; 
GET32_END
;

534 
g‘32_12_A100
: 
§m¶e
 = (
ušt32_t
)
	`bsw­_16
(
	`as_u16c
(
¤c
è^ 0x80è<< 16; 
GET32_END
;

535 
g‘32_0123_1230
: 
§m¶e
 = 
	`as_u32c
(
¤c
è<< 8; 
GET32_END
;

536 
g‘32_0123_9230
: 
§m¶e
 = (
	`as_u32c
(
¤c
è<< 8è^ 0x80000000; 
GET32_END
;

537 
g‘32_1230_3210
: 
§m¶e
 = 
	`bsw­_32
(
	`as_u32c
(
¤c
è>> 8); 
GET32_END
;

538 
g‘32_1230_B210
: 
§m¶e
 = 
	`bsw­_32
((
	`as_u32c
(
¤c
è>> 8è^ 0x80); 
GET32_END
;

539 
g‘32_1234_1234
: 
§m¶e
 = 
	`as_u32c
(
¤c
); 
GET32_END
;

540 
g‘32_1234_9234
: 
§m¶e
 = 
	`as_u32c
(
¤c
è^ 0x80000000; 
GET32_END
;

541 
g‘32_1234_4321
: 
§m¶e
 = 
	`bsw­_32
(
	`as_u32c
(
¤c
)); 
GET32_END
;

542 
g‘32_1234_C321
: 
§m¶e
 = 
	`bsw­_32
(
	`as_u32c
(
¤c
è^ 0x80); 
GET32_END
;

543 
g‘32_0123_1230_20
: 
§m¶e
 = 
	`as_u32c
(
¤c
è<< 12; 
GET32_END
;

544 
g‘32_0123_9230_20
: 
§m¶e
 = (
	`as_u32c
(
¤c
è<< 12è^ 0x80000000; 
GET32_END
;

545 
g‘32_1230_3210_20
: 
§m¶e
 = 
	`bsw­_32
(
	`as_u32c
(
¤c
)è<< 12; 
GET32_END
;

546 
g‘32_1230_B210_20
: 
§m¶e
 = (
	`bsw­_32
(
	`as_u32c
(
¤c
)è<< 12è^ 0x80000000; 
GET32_END
;

547 
g‘32_123_1230
: 
§m¶e
 = 
	`_g‘_ŒË
(
¤c
è<< 8; 
GET32_END
;

548 
g‘32_123_9230
: 
§m¶e
 = (
	`_g‘_ŒË
(
¤c
è<< 8è^ 0x80000000; 
GET32_END
;

549 
g‘32_123_3210
: 
§m¶e
 = 
	`_g‘_ŒË_s
(
¤c
è<< 8; 
GET32_END
;

550 
g‘32_123_B210
: 
§m¶e
 = (
	`_g‘_ŒË_s
(
¤c
è<< 8è^ 0x80000000; 
GET32_END
;

551 
g‘32_123_1230_20
: 
§m¶e
 = 
	`_g‘_ŒË
(
¤c
è<< 12; 
GET32_END
;

552 
g‘32_123_9230_20
: 
§m¶e
 = (
	`_g‘_ŒË
(
¤c
è<< 12è^ 0x80000000; 
GET32_END
;

553 
g‘32_123_3210_20
: 
§m¶e
 = 
	`_g‘_ŒË_s
(
¤c
è<< 12; 
GET32_END
;

554 
g‘32_123_B210_20
: 
§m¶e
 = (
	`_g‘_ŒË_s
(
¤c
è<< 12è^ 0x80000000; 
GET32_END
;

555 
g‘32_123_1230_18
: 
§m¶e
 = 
	`_g‘_ŒË
(
¤c
è<< 14; 
GET32_END
;

556 
g‘32_123_9230_18
: 
§m¶e
 = (
	`_g‘_ŒË
(
¤c
è<< 14è^ 0x80000000; 
GET32_END
;

557 
g‘32_123_3210_18
: 
§m¶e
 = 
	`_g‘_ŒË_s
(
¤c
è<< 14; 
GET32_END
;

558 
g‘32_123_B210_18
: 
§m¶e
 = (
	`_g‘_ŒË_s
(
¤c
è<< 14è^ 0x80000000; 
GET32_END
;

559 
	}
}

562 #ifdeà
CONV24_END


563 
	g__cÚv24_g‘
: *
put
;

564 
	#PUT32_END
 
CONV24_END


	)

567 #ifdeà
PUT32_LABELS


569 *cÚ¡ 
	gput32_Ïb–s
[5 * 2 * 2 + 4 * 3] = {

570 &&
put32_1234_1
,

571 &&
put32_1234_9
,

572 &&
put32_1234_1
,

573 &&
put32_1234_9
,

574 &&
put32_1234_12
,

575 &&
put32_1234_92
,

576 &&
put32_1234_21
,

577 &&
put32_1234_29
,

579 &&
put32_1234_0123
,

580 &&
put32_1234_0923
,

581 &&
put32_1234_3210
,

582 &&
put32_1234_3290
,

583 &&
put32_1234_1234
,

584 &&
put32_1234_9234
,

585 &&
put32_1234_4321
,

586 &&
put32_1234_4329
,

587 &&
put32_1234_0123_20
,

588 &&
put32_1234_0923_20
,

589 &&
put32_1234_3210_20
,

590 &&
put32_1234_3290_20
,

592 &&
put32_1234_123
,

593 &&
put32_1234_923
,

594 &&
put32_1234_321
,

595 &&
put32_1234_329
,

596 &&
put32_1234_123_20
,

597 &&
put32_1234_923_20
,

598 &&
put32_1234_321_20
,

599 &&
put32_1234_329_20
,

600 &&
put32_1234_123_18
,

601 &&
put32_1234_923_18
,

602 &&
put32_1234_321_18
,

603 &&
put32_1234_329_18
,

607 #ifdeà
CONV24_LABELS


608 #undeà
GET32_LABELS


609 #undeà
PUT32_LABELS


612 #ifdeà
PUT32_END


614 
put32_1234_1
: 
	`as_u8
(
d¡
èğ
§m¶e
 >> 24; 
PUT32_END
;

615 
put32_1234_9
: 
	`as_u8
(
d¡
èğ(
§m¶e
 >> 24è^ 0x80; 
PUT32_END
;

616 
put32_1234_12
: 
	`as_u16
(
d¡
èğ
§m¶e
 >> 16; 
PUT32_END
;

617 
put32_1234_92
: 
	`as_u16
(
d¡
èğ(
§m¶e
 >> 16è^ 0x8000; 
PUT32_END
;

618 
put32_1234_21
: 
	`as_u16
(
d¡
èğ
	`bsw­_16
(
§m¶e
 >> 16); 
PUT32_END
;

619 
put32_1234_29
: 
	`as_u16
(
d¡
èğ
	`bsw­_16
(
§m¶e
 >> 16è^ 0x80; 
PUT32_END
;

620 
put32_1234_0123
: 
	`as_u32
(
d¡
èğ
	`sx24
(
§m¶e
 >> 8); 
PUT32_END
;

621 
put32_1234_0923
: 
	`as_u32
(
d¡
èğ
	`sx24
((
§m¶e
 >> 8è^ 0x800000); 
PUT32_END
;

622 
put32_1234_3210
: 
	`as_u32
(
d¡
èğ
	`sx24s
(
	`bsw­_32
(
§m¶e
è<< 8); 
PUT32_END
;

623 
put32_1234_3290
: 
	`as_u32
(
d¡
èğ
	`sx24s
((
	`bsw­_32
(
§m¶e
è^ 0x80è<< 8); 
PUT32_END
;

624 
put32_1234_1234
: 
	`as_u32
(
d¡
èğ
§m¶e
; 
PUT32_END
;

625 
put32_1234_9234
: 
	`as_u32
(
d¡
èğ
§m¶e
 ^ 0x80000000; 
PUT32_END
;

626 
put32_1234_4321
: 
	`as_u32
(
d¡
èğ
	`bsw­_32
(
§m¶e
); 
PUT32_END
;

627 
put32_1234_4329
: 
	`as_u32
(
d¡
èğ
	`bsw­_32
(
§m¶e
è^ 0x80; 
PUT32_END
;

628 
put32_1234_0123_20
: 
	`as_u32
(
d¡
èğ
	`sx20
(
§m¶e
 >> 12); 
PUT32_END
;

629 
put32_1234_0923_20
: 
	`as_u32
(
d¡
èğ
	`sx20
((
§m¶e
 ^ 0x80000000è>> 12); 
PUT32_END
;

630 
put32_1234_3210_20
: 
	`as_u32
(
d¡
èğ
	`bsw­_32
(
	`sx20
(
§m¶e
 >> 12)); 
PUT32_END
;

631 
put32_1234_3290_20
: 
	`as_u32
(
d¡
èğ
	`bsw­_32
(
	`sx20
((
§m¶e
 ^ 0x80000000è>> 12)); 
PUT32_END
;

632 
put32_1234_123
: 
	`_put_ŒË
(
d¡
, 
§m¶e
 >> 8); 
PUT32_END
;

633 
put32_1234_923
: 
	`_put_ŒË
(
d¡
, (
§m¶e
 ^ 0x80000000è>> 8); 
PUT32_END
;

634 
put32_1234_321
: 
	`_put_ŒË_s
(
d¡
, 
§m¶e
 >> 8); 
PUT32_END
;

635 
put32_1234_329
: 
	`_put_ŒË_s
(
d¡
, (
§m¶e
 ^ 0x80000000è>> 8); 
PUT32_END
;

636 
put32_1234_123_20
: 
	`_put_ŒË
(
d¡
, 
§m¶e
 >> 12); 
PUT32_END
;

637 
put32_1234_923_20
: 
	`_put_ŒË
(
d¡
, (
§m¶e
 ^ 0x80000000è>> 12); 
PUT32_END
;

638 
put32_1234_321_20
: 
	`_put_ŒË_s
(
d¡
, 
§m¶e
 >> 12); 
PUT32_END
;

639 
put32_1234_329_20
: 
	`_put_ŒË_s
(
d¡
, (
§m¶e
 ^ 0x80000000è>> 12); 
PUT32_END
;

640 
put32_1234_123_18
: 
	`_put_ŒË
(
d¡
, 
§m¶e
 >> 14); 
PUT32_END
;

641 
put32_1234_923_18
: 
	`_put_ŒË
(
d¡
, (
§m¶e
 ^ 0x80000000è>> 14); 
PUT32_END
;

642 
put32_1234_321_18
: 
	`_put_ŒË_s
(
d¡
, 
§m¶e
 >> 14); 
PUT32_END
;

643 
put32_1234_329_18
: 
	`_put_ŒË_s
(
d¡
, (
§m¶e
 ^ 0x80000000è>> 14); 
PUT32_END
;

644 
	}
}

647 #ifdeà
CONV24_END


648 #undeà
GET32_END


649 #undeà
PUT32_END


652 #ifdeà
PUT32F_LABELS


654 *cÚ¡ 
	gput32æßt_Ïb–s
[2 * 2] = {

655 &&
put32f_1234_1234F
,

656 &&
put32f_1234_4321F
,

657 &&
put32f_1234_1234D
,

658 &&
put32f_1234_4321D
,

662 #ifdeà
PUT32F_END


663 
	gput32f_1234_1234F
: 
as_æßt
(
d¡
èğ(
æßt_t
)((
št32_t
)
§m¶e
è/ (æßt_t)0x80000000UL; 
	gPUT32F_END
;

664 
	gput32f_1234_4321F
: 
tmp_æßt
.
f
 = (
æßt_t
)((
št32_t
)
§m¶e
) / (float_t)0x80000000UL;

665 
as_u32
(
d¡
èğ
bsw­_32
(
tmp_æßt
.
i
); 
	gPUT32F_END
;

666 
	gput32f_1234_1234D
: 
as_doubË
(
d¡
èğ(
doubË_t
)((
št32_t
)
§m¶e
è/ (doubË_t)0x80000000UL; 
	gPUT32F_END
;

667 
	gput32f_1234_4321D
: 
tmp_doubË
.
d
 = (
doubË_t
)((
št32_t
)
§m¶e
) / (double_t)0x80000000UL;

668 
as_u64
(
d¡
èğ
bsw­_64
(
tmp_doubË
.
l
); 
	gPUT32F_END
;

671 #ifdeà
GET32F_LABELS


673 *cÚ¡ 
	gg‘32æßt_Ïb–s
[2 * 2] = {

674 &&
g‘32f_1234F_1234
,

675 &&
g‘32f_4321F_1234
,

676 &&
g‘32f_1234D_1234
,

677 &&
g‘32f_4321D_1234
,

681 #ifdeà
GET32F_END


682 
	gg‘32f_1234F_1234
: 
tmp_æßt
.
f
 = 
as_æßtc
(
¤c
);

683 ià(
	gtmp_æßt
.
	gf
 >= 1.0)

684 
§m¶e
 = 0x7fffffff;

685 ià(
	gtmp_æßt
.
	gf
 <= -1.0)

686 
§m¶e
 = 0x80000000;

688 
	g§m¶e
 = (
št32_t
)(
tmp_æßt
.
f
 * (
æßt_t
)0x80000000UL);

689 
	gGET32F_END
;

690 
	gg‘32f_4321F_1234
: 
tmp_æßt
.
i
 = 
bsw­_32
(
as_u32c
(
¤c
));

691 ià(
	gtmp_æßt
.
	gf
 >= 1.0)

692 
§m¶e
 = 0x7fffffff;

693 ià(
	gtmp_æßt
.
	gf
 <= -1.0)

694 
§m¶e
 = 0x80000000;

696 
	g§m¶e
 = (
št32_t
)(
tmp_æßt
.
f
 * (
æßt_t
)0x80000000UL);

697 
	gGET32F_END
;

698 
	gg‘32f_1234D_1234
: 
tmp_doubË
.
d
 = 
as_doubËc
(
¤c
);

699 ià(
	gtmp_doubË
.
	gd
 >= 1.0)

700 
§m¶e
 = 0x7fffffff;

701 ià(
	gtmp_doubË
.
	gd
 <= -1.0)

702 
§m¶e
 = 0x80000000;

704 
	g§m¶e
 = (
št32_t
)(
tmp_doubË
.
d
 * (
doubË_t
)0x80000000UL);

705 
	gGET32F_END
;

706 
	gg‘32f_4321D_1234
: 
tmp_doubË
.
l
 = 
bsw­_64
(
as_u64c
(
¤c
));

707 ià(
	gtmp_doubË
.
	gd
 >= 1.0)

708 
§m¶e
 = 0x7fffffff;

709 ià(
	gtmp_doubË
.
	gd
 <= -1.0)

710 
§m¶e
 = 0x80000000;

712 
	g§m¶e
 = (
št32_t
)(
tmp_doubË
.
d
 * (
doubË_t
)0x80000000UL);

713 
	gGET32F_END
;

716 #undeà
as_u8


717 #undeà
as_u16


718 #undeà
as_u32


719 #undeà
as_s8


720 #undeà
as_s16


721 #undeà
as_s32


722 #undeà
as_æßt


723 #undeà
as_doubË


725 #undeà
as_u8c


726 #undeà
as_u16c


727 #undeà
as_u32c


728 #undeà
as_s8c


729 #undeà
as_s16c


730 #undeà
as_s32c


731 #undeà
as_æßtc


732 #undeà
as_doubËc


734 #undeà
_g‘_ŒË


735 #undeà
_g‘_ŒË_s


736 #undeà
_g‘_ŒË_Ë


737 #undeà
_g‘_ŒË_be


738 #undeà
_put_ŒË


739 #undeà
_put_ŒË_s


740 #undeà
_put_ŒË_Ë


741 #undeà
_put_ŒË_be


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/scopes/level.c

21 
	~<cur£s.h
>

22 
	~<”ºo.h
>

23 
	~<®§/asoundlib.h
>

25 
	#BAR_WIDTH
 70

	)

27 
	#DECAY_MS
 400

	)

29 
	#PEAK_MS
 800

	)

31 
	s_¢d_pcm_scİe_Ëv–_chªÃl
 {

32 
št16_t
 
	mËv–
;

33 
št16_t
 
	m³ak
;

34 
	m³ak_age
;

35 } 
	t¢d_pcm_scİe_Ëv–_chªÃl_t
;

37 
	s_¢d_pcm_scİe_Ëv–
 {

38 
¢d_pcm_t
 *
	mpcm
;

39 
¢d_pcm_scİe_t
 *
	ms16
;

40 
¢d_pcm_scİe_Ëv–_chªÃl_t
 *
	mchªÃls
;

41 
¢d_pcm_uäames_t
 
	mŞd
;

42 
	mtİ
;

43 
WINDOW
 *
	mwš
;

44 
	mb¬_width
;

45 
	mdeÿy_ms
;

46 
	m³ak_ms
;

47 } 
	t¢d_pcm_scİe_Ëv–_t
;

49 
	$Ëv–_’abË
(
¢d_pcm_scİe_t
 *
scİe
)

51 
¢d_pcm_scİe_Ëv–_t
 *
Ëv–
 = 
	`¢d_pcm_scİe_g‘_ÿÎback_´iv©e
(
scİe
);

52 
y
, 
x
;

53 
Ëv–
->
chªÃls
 = 
	`ÿÎoc
(
	`¢d_pcm_m‘”_g‘_chªÃls
Öev–->
pcm
), (*level->channels));

54 ià(!
Ëv–
->
chªÃls
) {

55 
	`ä“
(
Ëv–
);

56  -
ENOMEM
;

58 
	`¢d_pcm_scİe_£t_ÿÎback_´iv©e
(
scİe
, 
Ëv–
);

59 
Ëv–
->
wš
 = 
	`š™sü
();

60 
	`wšsd–Ê
(
Ëv–
->
wš
, 
	`¢d_pcm_m‘”_g‘_chªÃls
Öev–->
pcm
));

61 
	`g‘yx
(
Ëv–
->
wš
, 
y
, 
x
);

62 
Ëv–
->
tİ
 = 
y
;

64 
	}
}

66 
	$Ëv–_di§bË
(
¢d_pcm_scİe_t
 *
scİe
)

68 
¢d_pcm_scİe_Ëv–_t
 *
Ëv–
 = 
	`¢d_pcm_scİe_g‘_ÿÎback_´iv©e
(
scİe
);

69 
	`’dwš
();

70 
	`ä“
(
Ëv–
->
chªÃls
);

71 
	}
}

73 
	$Ëv–_şo£
(
¢d_pcm_scİe_t
 *
scİe
)

75 
¢d_pcm_scİe_Ëv–_t
 *
Ëv–
 = 
	`¢d_pcm_scİe_g‘_ÿÎback_´iv©e
(
scİe
);

76 
	`ä“
(
Ëv–
);

77 
	}
}

79 
	$Ëv–_¡¬t
(
¢d_pcm_scİe_t
 *
scİe
 
ATTRIBUTE_UNUSED
)

81 
	}
}

83 
	$Ëv–_¡İ
(
¢d_pcm_scİe_t
 *
scİe
)

85 
¢d_pcm_scİe_Ëv–_t
 *
Ëv–
 = 
	`¢d_pcm_scİe_g‘_ÿÎback_´iv©e
(
scİe
);

86 
c
;

87 
c
 = 0; c < 
	`¢d_pcm_m‘”_g‘_chªÃls
(
Ëv–
->
pcm
); c++) {

88 
	`move
(
Ëv–
->
tİ
 + 
c
, 0);

89 
	`ş¹ÛŞ
();

91 
	`move
(
Ëv–
->
tİ
, 0);

92 
	`»äesh
();

93 
	}
}

95 
	$Ëv–_upd©e
(
¢d_pcm_scİe_t
 *
scİe
)

97 
¢d_pcm_scİe_Ëv–_t
 *
Ëv–
 = 
	`¢d_pcm_scİe_g‘_ÿÎback_´iv©e
(
scİe
);

98 
¢d_pcm_t
 *
pcm
 = 
Ëv–
->pcm;

99 
¢d_pcm_säames_t
 
size
;

100 
¢d_pcm_uäames_t
 
size1
, 
size2
;

101 
¢d_pcm_uäames_t
 
off£t
, 
cÚt
;

102 
c
, 
chªÃls
;

103 
ms
;

104 
b¬
[256] = { [0 ... 255] = '#' };

105 
max_deÿy
;

106 
size
 = 
	`¢d_pcm_m‘”_g‘_now
(
pcm
è- 
Ëv–
->
Şd
;

107 ià(
size
 < 0)

108 
size
 +ğ
	`¢d_pcm_m‘”_g‘_bound¬y
(
pcm
);

109 
off£t
 = 
Ëv–
->
Şd
 % 
	`¢d_pcm_m‘”_g‘_bufsize
(
pcm
);

110 
cÚt
 = 
	`¢d_pcm_m‘”_g‘_bufsize
(
pcm
è- 
off£t
;

111 
size1
 = 
size
;

112 ià(
size1
 > 
cÚt
)

113 
size1
 = 
cÚt
;

114 
size2
 = 
size
 - 
size1
;

115 
ms
 = 
size
 * 1000 / 
	`¢d_pcm_m‘”_g‘_¿‹
(
pcm
);

116 
max_deÿy
 = 32768 * 
ms
 / 
Ëv–
->
deÿy_ms
;

117 
chªÃls
 = 
	`¢d_pcm_m‘”_g‘_chªÃls
(
pcm
);

118 
c
 = 0; c < 
chªÃls
; c++) {

119 
št16_t
 *
±r
;

120 
s
, 
Ëv
 = 0;

121 
¢d_pcm_uäames_t
 
n
;

122 
¢d_pcm_scİe_Ëv–_chªÃl_t
 *
l
;

123 
Ëv_pos
, 
³ak_pos
;

124 
l
 = &
Ëv–
->
chªÃls
[
c
];

125 
±r
 = 
	`¢d_pcm_scİe_s16_g‘_chªÃl_bufãr
(
Ëv–
->
s16
, 
c
è+ 
off£t
;

126 
n
 = 
size1
;‚ > 0;‚--) {

127 
s
 = *
±r
;

128 ià(
s
 < 0)

129 
s
 = -s;

130 ià(
s
 > 
Ëv
)

131 
Ëv
 = 
s
;

132 
±r
++;

134 
±r
 = 
	`¢d_pcm_scİe_s16_g‘_chªÃl_bufãr
(
Ëv–
->
s16
, 
c
);

135 
n
 = 
size2
;‚ > 0;‚--) {

136 
s
 = *
±r
;

137 ià(
s
 < 0)

138 
s
 = -s;

139 ià(
s
 > 
Ëv
)

140 
Ëv
 = 
s
;

141 
±r
++;

143 
l
->
Ëv–
 = 
Ëv
;

144 
l
->
³ak_age
 +ğ
ms
;

145 ià(
l
->
³ak_age
 >ğ
Ëv–
->
³ak_ms
 ||

146 
Ëv
 >ğ
l
->
³ak
) {

147 
l
->
³ak
 = 
Ëv
;

148 
l
->
³ak_age
 = 0;

150 ià(
Ëv
 < 
l
->
Ëv–
 - 
max_deÿy
)

151 
Ëv
 = 
l
->
Ëv–
 - 
max_deÿy
;

152 
	`move
(
Ëv–
->
tİ
 + 
c
, 0);

153 
Ëv_pos
 = 
Ëv
 * 
Ëv–
->
b¬_width
 / 32768;

154 
³ak_pos
 = 
l
->
³ak
 * 
Ëv–
->
b¬_width
 / 32768;

155 
	`addn¡r
(
b¬
, 
Ëv_pos
);

156 
	`ş¹ÛŞ
();

157 
	`mvaddch
(
Ëv–
->
tİ
 + 
c
, 
³ak_pos
 - 1, '#');

159 
	`move
(
Ëv–
->
tİ
, 0);

160 
	`»äesh
();

161 
Ëv–
->
Şd
 = 
	`¢d_pcm_m‘”_g‘_now
(
pcm
);

162 
	}
}

164 
	$Ëv–_»£t
(
¢d_pcm_scİe_t
 *
scİe
)

166 
¢d_pcm_scİe_Ëv–_t
 *
Ëv–
 = 
	`¢d_pcm_scİe_g‘_ÿÎback_´iv©e
(
scİe
);

167 
¢d_pcm_t
 *
pcm
 = 
Ëv–
->pcm;

168 
	`mem£t
(
Ëv–
->
chªÃls
, 0, 
	`¢d_pcm_m‘”_g‘_chªÃls
(
pcm
) * (*level->channels));

169 
Ëv–
->
Şd
 = 
	`¢d_pcm_m‘”_g‘_now
(
pcm
);

170 
	}
}

172 
¢d_pcm_scİe_İs_t
 
	gËv–_İs
 = {

173 .
’abË
 = 
Ëv–_’abË
,

174 .
	gdi§bË
 = 
Ëv–_di§bË
,

175 .
	gşo£
 = 
Ëv–_şo£
,

176 .
	g¡¬t
 = 
Ëv–_¡¬t
,

177 .
	g¡İ
 = 
Ëv–_¡İ
,

178 .
	gupd©e
 = 
Ëv–_upd©e
,

179 .
	g»£t
 = 
Ëv–_»£t
,

182 
	$¢d_pcm_scİe_Ëv–_İ’
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
Çme
,

183 
b¬_width
, 
deÿy_ms
,

184 
³ak_ms
,

185 
¢d_pcm_scİe_t
 **
scİ•
)

187 
¢d_pcm_scİe_t
 *
scİe
, *
s16
;

188 
¢d_pcm_scİe_Ëv–_t
 *
Ëv–
;

189 
”r
 = 
	`¢d_pcm_scİe_m®loc
(&
scİe
);

190 ià(
”r
 < 0)

191  
”r
;

192 
Ëv–
 = 
	`ÿÎoc
(1, (*level));

193 ià(!
Ëv–
) {

194 
	`ä“
(
scİe
);

195  -
ENOMEM
;

197 
Ëv–
->
pcm
 =…cm;

198 
Ëv–
->
b¬_width
 = bar_width;

199 
Ëv–
->
deÿy_ms
 = decay_ms;

200 
Ëv–
->
³ak_ms
 =…eak_ms;

201 
s16
 = 
	`¢d_pcm_m‘”_£¬ch_scİe
(
pcm
, "s16");

202 ià(!
s16
) {

203 
”r
 = 
	`¢d_pcm_scİe_s16_İ’
(
pcm
, "s16", &
s16
);

204 ià(
”r
 < 0) {

205 
	`ä“
(
scİe
);

206 
	`ä“
(
Ëv–
);

207  
”r
;

210 
Ëv–
->
s16
 = s16;

211 
	`¢d_pcm_scİe_£t_İs
(
scİe
, &
Ëv–_İs
);

212 
	`¢d_pcm_scİe_£t_ÿÎback_´iv©e
(
scİe
, 
Ëv–
);

213 ià(
Çme
)

214 
	`¢d_pcm_scİe_£t_Çme
(
scİe
, 
	`¡rdup
(
Çme
));

215 
	`¢d_pcm_m‘”_add_scİe
(
pcm
, 
scİe
);

216 *
scİ•
 = 
scİe
;

218 
	}
}

220 
	$_¢d_pcm_scİe_Ëv–_İ’
(
¢d_pcm_t
 *
pcm
, cÚ¡ *
Çme
,

221 
¢d_cÚfig_t
 *
roÙ
, snd_cÚfig_ˆ*
cÚf
)

223 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

224 
¢d_pcm_scİe_t
 *
scİe
;

225 
b¬_width
 = -1, 
deÿy_ms
 = -1, 
³ak_ms
 = -1;

226 
”r
;

227 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

228 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

229 cÚ¡ *
id
;

230 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

232 ià(
	`¡rcmp
(
id
, "comment") == 0)

234 ià(
	`¡rcmp
(
id
, "type") == 0)

236 ià(
	`¡rcmp
(
id
, "bar_width") == 0) {

237 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
b¬_width
);

238 ià(
”r
 < 0) {

239 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

240  -
EINVAL
;

244 ià(
	`¡rcmp
(
id
, "decay_ms") == 0) {

245 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
deÿy_ms
);

246 ià(
”r
 < 0) {

247 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

248  -
EINVAL
;

252 ià(
	`¡rcmp
(
id
, "peak_ms") == 0) {

253 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
³ak_ms
);

254 ià(
”r
 < 0) {

255 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

256  -
EINVAL
;

260 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

261  -
EINVAL
;

263 ià(
b¬_width
 < 0)

264 
b¬_width
 = 
BAR_WIDTH
;

265 ià(
deÿy_ms
 < 0)

266 
deÿy_ms
 = 
DECAY_MS
;

267 ià(
³ak_ms
 < 0)

268 
³ak_ms
 = 
PEAK_MS
;

269  
	`¢d_pcm_scİe_Ëv–_İ’
(
pcm
, 
Çme
, 
b¬_width
, 
deÿy_ms
, 
³ak_ms
,

270 &
scİe
);

271 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi.c

147 
	~"¿wmidi_loÿl.h
"

148 
	~<¡dio.h
>

149 
	~<¡dlib.h
>

150 
	~<¡d¬g.h
>

151 
	~<uni¡d.h
>

152 
	~<¡ršg.h
>

160 
	$¢d_¿wmidi_·¿ms_deçuÉ
(
¢d_¿wmidi_t
 *
¿wmidi
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
)

162 
	`as£¹
(
¿wmidi
);

163 
	`as£¹
(
·¿ms
);

164 
·¿ms
->
bufãr_size
 = 
	`·ge_size
();

165 
·¿ms
->
ava_mš
 = 1;

166 
·¿ms
->
no_aùive_£nsšg
 = 1;

167 
·¿ms
->
mode
 = 0;

168 
	`mem£t
(
·¿ms
->
»£rved
, 0, (params->reserved));

170 
	}
}

172 
	$¢d_¿wmidi_İ’_cÚf
(
¢d_¿wmidi_t
 **
špu
, snd_¿wmidi_ˆ**
ouu
,

173 cÚ¡ *
Çme
, 
¢d_cÚfig_t
 *
¿wmidi_roÙ
,

174 
¢d_cÚfig_t
 *
¿wmidi_cÚf
, 
mode
)

176 cÚ¡ *
¡r
;

177 
buf
[256];

178 
”r
;

179 
¢d_cÚfig_t
 *
cÚf
, *
ty³_cÚf
 = 
NULL
;

180 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

181 
¢d_¿wmidi_·¿ms_t
 
·¿ms
;

182 cÚ¡ *
id
;

183 cÚ¡ *
lib
 = 
NULL
, *
İ’_Çme
 = NULL;

184 (*
İ’_func
)(
¢d_¿wmidi_t
 **, snd_rawmidi_t **,

185 cÚ¡ *, 
¢d_cÚfig_t
 *, snd_cÚfig_ˆ*, èğ
NULL
;

186 #iâdeà
PIC


187 *
	`¢d_¿wmidi_İ’_symbŞs
();

189 ià(
	`¢d_cÚfig_g‘_ty³
(
¿wmidi_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

190 ià(
Çme
)

191 
	`SNDERR
("Inv®idy³ fÜ RAWMIDI % defš™iÚ", 
Çme
);

193 
	`SNDERR
("Invalidype for RAWMIDI definition");

194  -
EINVAL
;

196 
”r
 = 
	`¢d_cÚfig_£¬ch
(
¿wmidi_cÚf
, "ty³", &
cÚf
);

197 ià(
”r
 < 0) {

198 
	`SNDERR
("type is‚ot defined");

199  
”r
;

201 
”r
 = 
	`¢d_cÚfig_g‘_id
(
cÚf
, &
id
);

202 ià(
”r
 < 0) {

203 
	`SNDERR
("unableo get id");

204  
”r
;

206 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
cÚf
, &
¡r
);

207 ià(
”r
 < 0) {

208 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

209  
”r
;

211 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
¿wmidi_roÙ
, "¿wmidi_ty³", 
¡r
, &
ty³_cÚf
);

212 ià(
”r
 >= 0) {

213 ià(
	`¢d_cÚfig_g‘_ty³
(
ty³_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

214 
	`SNDERR
("Inv®idy³ fÜ RAWMIDIy³ % defš™iÚ", 
¡r
);

215 
”r
 = -
EINVAL
;

216 
_”r
;

218 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
ty³_cÚf
) {

219 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

220 cÚ¡ *
id
;

221 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

223 ià(
	`¡rcmp
(
id
, "comment") == 0)

225 ià(
	`¡rcmp
(
id
, "lib") == 0) {

226 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
lib
);

227 ià(
”r
 < 0) {

228 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

229 
_”r
;

233 ià(
	`¡rcmp
(
id
, "open") == 0) {

234 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
İ’_Çme
);

235 ià(
”r
 < 0) {

236 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

237 
_”r
;

241 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

242 
”r
 = -
EINVAL
;

243 
_”r
;

246 ià(!
İ’_Çme
) {

247 
İ’_Çme
 = 
buf
;

248 
	`¢´štf
(
buf
, (buf), "_¢d_¿wmidi_%s_İ’", 
¡r
);

250 #iâdeà
PIC


251 
	`¢d_¿wmidi_İ’_symbŞs
();

253 
İ’_func
 = 
	`¢d_dlobj_ÿche_g‘2
(
lib
, 
İ’_Çme
,

254 
	`SND_DLSYM_VERSION
(
SND_RAWMIDI_DLSYM_VERSION
), 1);

255 ià(!
İ’_func
) {

256 
”r
 = -
ENXIO
;

257 
_”r
;

259 ià(
ty³_cÚf
)

260 
	`¢d_cÚfig_d–‘e
(
ty³_cÚf
);

261 
”r
 = 
	`İ’_func
(
špu
, 
ouu
, 
Çme
, 
¿wmidi_roÙ
, 
¿wmidi_cÚf
, 
mode
);

262 ià(
”r
 < 0)

263 
_”r
;

264 ià(
špu
) {

265 (*
špu
)->
İ’_func
 = open_func;

266 
	`¢d_¿wmidi_·¿ms_deçuÉ
(*
špu
, &
·¿ms
);

267 
”r
 = 
	`¢d_¿wmidi_·¿ms
(*
špu
, &
·¿ms
);

268 
	`as£¹
(
”r
 >= 0);

270 ià(
ouu
) {

271 (*
ouu
)->
İ’_func
 = open_func;

272 
	`¢d_¿wmidi_·¿ms_deçuÉ
(*
ouu
, &
·¿ms
);

273 
”r
 = 
	`¢d_¿wmidi_·¿ms
(*
ouu
, &
·¿ms
);

274 
	`as£¹
(
”r
 >= 0);

278 
_”r
:

279 ià(
İ’_func
)

280 
	`¢d_dlobj_ÿche_put
(
İ’_func
);

281 ià(
ty³_cÚf
)

282 
	`¢d_cÚfig_d–‘e
(
ty³_cÚf
);

283  
”r
;

284 
	}
}

286 
	$¢d_¿wmidi_İ’_noupd©e
(
¢d_¿wmidi_t
 **
špu
, snd_¿wmidi_ˆ**
ouu
,

287 
¢d_cÚfig_t
 *
roÙ
, cÚ¡ *
Çme
, 
mode
)

289 
”r
;

290 
¢d_cÚfig_t
 *
¿wmidi_cÚf
;

291 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "¿wmidi", 
Çme
, &
¿wmidi_cÚf
);

292 ià(
”r
 < 0) {

293 
	`SNDERR
("UnknowÀRawMid˜%s", 
Çme
);

294  
”r
;

296 
”r
 = 
	`¢d_¿wmidi_İ’_cÚf
(
špu
, 
ouu
, 
Çme
, 
roÙ
, 
¿wmidi_cÚf
, 
mode
);

297 
	`¢d_cÚfig_d–‘e
(
¿wmidi_cÚf
);

298  
”r
;

299 
	}
}

312 
	$¢d_¿wmidi_İ’
(
¢d_¿wmidi_t
 **
špu
, snd_¿wmidi_ˆ**
ouu
,

313 cÚ¡ *
Çme
, 
mode
)

315 
¢d_cÚfig_t
 *
tİ
;

316 
”r
;

318 
	`as£¹
((
špu
 || 
ouu
è&& 
Çme
);

319 ià(
	`_¢d_is_ucm_deviû
(
Çme
)) {

320 
Çme
 = 
	`uc_mgr_®ibcfg_by_deviû
(&
tİ
,‚ame);

321 ià(
Çme
 =ğ
NULL
)

322  -
ENODEV
;

324 
”r
 = 
	`¢d_cÚfig_upd©e_»f
(&
tİ
);

325 ià(
”r
 < 0)

326  
”r
;

328 
”r
 = 
	`¢d_¿wmidi_İ’_noupd©e
(
špu
, 
ouu
, 
tİ
, 
Çme
, 
mode
);

329 
	`¢d_cÚfig_uÄef
(
tİ
);

330  
”r
;

331 
	}
}

345 
	$¢d_¿wmidi_İ’_lcÚf
(
¢d_¿wmidi_t
 **
špu
, snd_¿wmidi_ˆ**
ouu
,

346 cÚ¡ *
Çme
, 
mode
, 
¢d_cÚfig_t
 *
lcÚf
)

348 
	`as£¹
((
špu
 || 
ouu
è&& 
Çme
 && 
lcÚf
);

349  
	`¢d_¿wmidi_İ’_noupd©e
(
špu
, 
ouu
, 
lcÚf
, 
Çme
, 
mode
);

350 
	}
}

360 
	$¢d_¿wmidi_şo£
(
¢d_¿wmidi_t
 *
¿wmidi
)

362 
”r
;

363 
	`as£¹
(
¿wmidi
);

364 
”r
 = 
¿wmidi
->
İs
->
	`şo£
(rawmidi);

365 
	`ä“
(
¿wmidi
->
Çme
);

366 ià(
¿wmidi
->
İ’_func
)

367 
	`¢d_dlobj_ÿche_put
(
¿wmidi
->
İ’_func
);

368 
	`ä“
(
¿wmidi
);

369  
”r
;

370 
	}
}

380 cÚ¡ *
	$¢d_¿wmidi_Çme
(
¢d_¿wmidi_t
 *
¿wmidi
)

382 
	`as£¹
(
¿wmidi
);

383  
¿wmidi
->
Çme
;

384 
	}
}

393 
¢d_¿wmidi_ty³_t
 
	$¢d_¿wmidi_ty³
(
¢d_¿wmidi_t
 *
¿wmidi
)

395 
	`as£¹
(
¿wmidi
);

396  
¿wmidi
->
ty³
;

397 
	}
}

406 
¢d_¿wmidi_¡»am_t
 
	$¢d_¿wmidi_¡»am
(
¢d_¿wmidi_t
 *
¿wmidi
)

408 
	`as£¹
(
¿wmidi
);

409  
¿wmidi
->
¡»am
;

410 
	}
}

417 
	$¢d_¿wmidi_pŞl_desütÜs_couÁ
(
¢d_¿wmidi_t
 *
¿wmidi
)

419 
	`as£¹
(
¿wmidi
);

421 
	}
}

430 
	$¢d_¿wmidi_pŞl_desütÜs
(
¢d_¿wmidi_t
 *
¿wmidi
, 
pŞlfd
 *
pfds
, 
¥aû
)

432 
	`as£¹
(
¿wmidi
);

433 ià(
¥aû
 >= 1) {

434 
pfds
->
fd
 = 
¿wmidi
->
pŞl_fd
;

435 
pfds
->
ev’ts
 = 
¿wmidi
->
¡»am
 =ğ
SND_RAWMIDI_STREAM_OUTPUT
 ? (
POLLOUT
|
POLLERR
|
POLLNVAL
è: (
POLLIN
|POLLERR|POLLNVAL);

439 
	}
}

449 
	$¢d_¿wmidi_pŞl_desütÜs_»v’ts
(
¢d_¿wmidi_t
 *
¿wmidi
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

451 
	`as£¹
(
¿wmidi
 && 
pfds
 && 
»v’ts
);

452 ià(
nfds
 == 1) {

453 *
»v’ts
 = 
pfds
->revents;

456  -
EINVAL
;

457 
	}
}

468 
	$¢d_¿wmidi_nÚblock
(
¢d_¿wmidi_t
 *
¿wmidi
, 
nÚblock
)

470 
”r
;

471 
	`as£¹
(
¿wmidi
);

472 
	`as£¹
(!(
¿wmidi
->
mode
 & 
SND_RAWMIDI_APPEND
));

473 ià((
”r
 = 
¿wmidi
->
İs
->
	`nÚblock
Ôawmidi, 
nÚblock
)) < 0)

474  
”r
;

475 ià(
nÚblock
)

476 
¿wmidi
->
mode
 |ğ
SND_RAWMIDI_NONBLOCK
;

478 
¿wmidi
->
mode
 &ğ~
SND_RAWMIDI_NONBLOCK
;

480 
	}
}

486 
size_t
 
	$¢d_¿wmidi_šfo_sizeof
()

488  (
¢d_¿wmidi_šfo_t
);

489 
	}
}

499 
	$¢d_¿wmidi_šfo_m®loc
(
¢d_¿wmidi_šfo_t
 **
šfo
)

501 
	`as£¹
(
šfo
);

502 *
šfo
 = 
	`ÿÎoc
(1, (
¢d_¿wmidi_šfo_t
));

503 ià(!*
šfo
)

504  -
ENOMEM
;

506 
	}
}

515 
	$¢d_¿wmidi_šfo_ä“
(
¢d_¿wmidi_šfo_t
 *
šfo
)

517 
	`as£¹
(
šfo
);

518 
	`ä“
(
šfo
);

519 
	}
}

526 
	$¢d_¿wmidi_šfo_cİy
(
¢d_¿wmidi_šfo_t
 *
d¡
, cÚ¡ snd_¿wmidi_šfo_ˆ*
¤c
)

528 
	`as£¹
(
d¡
 && 
¤c
);

529 *
d¡
 = *
¤c
;

530 
	}
}

537 
	$¢d_¿wmidi_šfo_g‘_deviû
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
šfo
)

539 
	`as£¹
(
šfo
);

540  
šfo
->
deviû
;

541 
	}
}

548 
	$¢d_¿wmidi_šfo_g‘_subdeviû
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
šfo
)

550 
	`as£¹
(
šfo
);

551  
šfo
->
subdeviû
;

552 
	}
}

559 
¢d_¿wmidi_¡»am_t
 
	$¢d_¿wmidi_šfo_g‘_¡»am
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
šfo
)

561 
	`as£¹
(
šfo
);

562  
šfo
->
¡»am
;

563 
	}
}

570 
	$¢d_¿wmidi_šfo_g‘_ÿrd
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
šfo
)

572 
	`as£¹
(
šfo
);

573  
šfo
->
ÿrd
;

574 
	}
}

581 
	$¢d_¿wmidi_šfo_g‘_æags
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
šfo
)

583 
	`as£¹
(
šfo
);

584  
šfo
->
æags
;

585 
	}
}

592 cÚ¡ *
	$¢d_¿wmidi_šfo_g‘_id
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
šfo
)

594 
	`as£¹
(
šfo
);

595  (cÚ¡ *)
šfo
->
id
;

596 
	}
}

603 cÚ¡ *
	$¢d_¿wmidi_šfo_g‘_Çme
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
šfo
)

605 
	`as£¹
(
šfo
);

606  (cÚ¡ *)
šfo
->
Çme
;

607 
	}
}

614 cÚ¡ *
	$¢d_¿wmidi_šfo_g‘_subdeviû_Çme
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
šfo
)

616 
	`as£¹
(
šfo
);

617  (cÚ¡ *)
šfo
->
subÇme
;

618 
	}
}

625 
	$¢d_¿wmidi_šfo_g‘_subdeviûs_couÁ
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
šfo
)

627 
	`as£¹
(
šfo
);

628  
šfo
->
subdeviûs_couÁ
;

629 
	}
}

636 
	$¢d_¿wmidi_šfo_g‘_subdeviûs_ava
(cÚ¡ 
¢d_¿wmidi_šfo_t
 *
šfo
)

638 
	`as£¹
(
šfo
);

639  
šfo
->
subdeviûs_ava
;

640 
	}
}

647 
	$¢d_¿wmidi_šfo_£t_deviû
(
¢d_¿wmidi_šfo_t
 *
šfo
, 
v®
)

649 
	`as£¹
(
šfo
);

650 
šfo
->
deviû
 = 
v®
;

651 
	}
}

658 
	$¢d_¿wmidi_šfo_£t_subdeviû
(
¢d_¿wmidi_šfo_t
 *
šfo
, 
v®
)

660 
	`as£¹
(
šfo
);

661 
šfo
->
subdeviû
 = 
v®
;

662 
	}
}

669 
	$¢d_¿wmidi_šfo_£t_¡»am
(
¢d_¿wmidi_šfo_t
 *
šfo
, 
¢d_¿wmidi_¡»am_t
 
v®
)

671 
	`as£¹
(
šfo
);

672 
šfo
->
¡»am
 = 
v®
;

673 
	}
}

681 
	$¢d_¿wmidi_šfo
(
¢d_¿wmidi_t
 *
¿wmidi
, 
¢d_¿wmidi_šfo_t
 * 
šfo
)

683 
	`as£¹
(
¿wmidi
);

684 
	`as£¹
(
šfo
);

685  
¿wmidi
->
İs
->
	`šfo
Ôawmidi, 
šfo
);

686 
	}
}

692 
size_t
 
	$¢d_¿wmidi_·¿ms_sizeof
()

694  (
¢d_¿wmidi_·¿ms_t
);

695 
	}
}

705 
	$¢d_¿wmidi_·¿ms_m®loc
(
¢d_¿wmidi_·¿ms_t
 **
·¿ms
)

707 
	`as£¹
(
·¿ms
);

708 *
·¿ms
 = 
	`ÿÎoc
(1, (
¢d_¿wmidi_·¿ms_t
));

709 ià(!*
·¿ms
)

710  -
ENOMEM
;

712 
	}
}

721 
	$¢d_¿wmidi_·¿ms_ä“
(
¢d_¿wmidi_·¿ms_t
 *
·¿ms
)

723 
	`as£¹
(
·¿ms
);

724 
	`ä“
(
·¿ms
);

725 
	}
}

732 
	$¢d_¿wmidi_·¿ms_cİy
(
¢d_¿wmidi_·¿ms_t
 *
d¡
, cÚ¡ snd_¿wmidi_·¿ms_ˆ*
¤c
)

734 
	`as£¹
(
d¡
 && 
¤c
);

735 *
d¡
 = *
¤c
;

736 
	}
}

745 #iâdeà
DOXYGEN


746 
	$¢d_¿wmidi_·¿ms_£t_bufãr_size
(
¢d_¿wmidi_t
 *
¿wmidi
 
ATTRIBUTE_UNUSED
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
, 
size_t
 
v®
)

748 
	$¢d_¿wmidi_·¿ms_£t_bufãr_size
(
¢d_¿wmidi_t
 *
¿wmidi
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
, 
size_t
 
v®
)

751 
	`as£¹
(
¿wmidi
 && 
·¿ms
);

752 
	`as£¹
(
v®
 > 
·¿ms
->
ava_mš
);

753 
·¿ms
->
bufãr_size
 = 
v®
;

755 
	}
}

762 
size_t
 
	$¢d_¿wmidi_·¿ms_g‘_bufãr_size
(cÚ¡ 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
)

764 
	`as£¹
(
·¿ms
);

765  
·¿ms
->
bufãr_size
;

766 
	}
}

774 #iâdeà
DOXYGEN


775 
	$¢d_¿wmidi_·¿ms_£t_ava_mš
(
¢d_¿wmidi_t
 *
¿wmidi
 
ATTRIBUTE_UNUSED
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
, 
size_t
 
v®
)

777 
	$¢d_¿wmidi_·¿ms_£t_ava_mš
(
¢d_¿wmidi_t
 *
¿wmidi
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
, 
size_t
 
v®
)

780 
	`as£¹
(
¿wmidi
 && 
·¿ms
);

781 
	`as£¹
(
v®
 < 
·¿ms
->
bufãr_size
);

782 
·¿ms
->
ava_mš
 = 
v®
;

784 
	}
}

791 
size_t
 
	$¢d_¿wmidi_·¿ms_g‘_ava_mš
(cÚ¡ 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
)

793 
	`as£¹
(
·¿ms
);

794  
·¿ms
->
ava_mš
;

795 
	}
}

804 #iâdeà
DOXYGEN


805 
	$¢d_¿wmidi_·¿ms_£t_no_aùive_£nsšg
(
¢d_¿wmidi_t
 *
¿wmidi
 
ATTRIBUTE_UNUSED
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
, 
v®
)

807 
	$¢d_¿wmidi_·¿ms_£t_no_aùive_£nsšg
(
¢d_¿wmidi_t
 *
¿wmidi
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
, 
v®
)

810 
	`as£¹
(
¿wmidi
 && 
·¿ms
);

811 
·¿ms
->
no_aùive_£nsšg
 = 
v®
;

813 
	}
}

820 
	$¢d_¿wmidi_·¿ms_g‘_no_aùive_£nsšg
(cÚ¡ 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
)

822 
	`as£¹
(
·¿ms
);

823  
·¿ms
->
no_aùive_£nsšg
;

824 
	}
}

838 
	$¢d_¿wmidi_·¿ms_£t_»ad_mode
(cÚ¡ 
¢d_¿wmidi_t
 *
¿wmidi
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
, 
¢d_¿wmidi_»ad_mode_t
 
v®
)

840 
äamšg
;

841 
	`as£¹
(
¿wmidi
 && 
·¿ms
);

843 
v®
) {

844 
SND_RAWMIDI_READ_STANDARD
:

845 
äamšg
 = 
SNDRV_RAWMIDI_MODE_FRAMING_NONE
;

847 
SND_RAWMIDI_READ_TSTAMP
:

848 ià(
¿wmidi
->
İs
->
Œ—d
 =ğ
NULL
)

849  -
ENOTSUP
;

850 
äamšg
 = 
SNDRV_RAWMIDI_MODE_FRAMING_TSTAMP
;

853  -
EINVAL
;

856 ià(
äamšg
 !ğ
SNDRV_RAWMIDI_MODE_FRAMING_NONE
 &&

857 (
¿wmidi
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 2è||„awmidi->
¡»am
 !ğ
SND_RAWMIDI_STREAM_INPUT
))

858  -
ENOTSUP
;

859 
·¿ms
->
mode
 = (·¿ms->mod& ~
SNDRV_RAWMIDI_MODE_FRAMING_MASK
è| 
äamšg
;

861 
	}
}

868 
¢d_¿wmidi_»ad_mode_t
 
	$¢d_¿wmidi_·¿ms_g‘_»ad_mode
(cÚ¡ 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
)

870 
äamšg
;

872 
	`as£¹
(
·¿ms
);

873 
äamšg
 = 
·¿ms
->
mode
 & 
SNDRV_RAWMIDI_MODE_FRAMING_MASK
;

874 ià(
äamšg
 =ğ
SNDRV_RAWMIDI_MODE_FRAMING_TSTAMP
)

875  
SND_RAWMIDI_READ_TSTAMP
;

876  
SND_RAWMIDI_READ_STANDARD
;

877 
	}
}

891 
	$¢d_¿wmidi_·¿ms_£t_şock_ty³
(cÚ¡ 
¢d_¿wmidi_t
 *
¿wmidi
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
, 
¢d_¿wmidi_şock_t
 
v®
)

893 
	`as£¹
(
¿wmidi
 && 
·¿ms
);

894 ià(
v®
 > 
SNDRV_RAWMIDI_MODE_CLOCK_MASK
 >> 
SNDRV_RAWMIDI_MODE_CLOCK_SHIFT
)

895  -
EINVAL
;

896 ià(
v®
 !ğ
SNDRV_RAWMIDI_MODE_CLOCK_NONE
 &&

897 (
¿wmidi
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 2è||„awmidi->
¡»am
 !ğ
SND_RAWMIDI_STREAM_INPUT
))

898  -
ENOTSUP
;

899 
·¿ms
->
mode
 = (·¿ms->mod& ~
SNDRV_RAWMIDI_MODE_CLOCK_MASK
è+ (
v®
 << 
SNDRV_RAWMIDI_MODE_CLOCK_SHIFT
);

901 
	}
}

908 
¢d_¿wmidi_şock_t
 
	$¢d_¿wmidi_·¿ms_g‘_şock_ty³
(cÚ¡ 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
)

910 
	`as£¹
(
·¿ms
);

911  (
·¿ms
->
mode
 & 
SNDRV_RAWMIDI_MODE_CLOCK_MASK
è>> 
SNDRV_RAWMIDI_MODE_CLOCK_SHIFT
;

912 
	}
}

921 
	$¢d_¿wmidi_·¿ms
(
¢d_¿wmidi_t
 *
¿wmidi
, 
¢d_¿wmidi_·¿ms_t
 * 
·¿ms
)

923 
”r
;

924 
	`as£¹
(
¿wmidi
);

925 
	`as£¹
(
·¿ms
);

926 
”r
 = 
¿wmidi
->
İs
->
	`·¿ms
Ôawmidi, 
·¿ms
);

927 ià(
”r
 < 0)

928  
”r
;

929 
¿wmidi
->
bufãr_size
 = 
·¿ms
->buffer_size;

930 
¿wmidi
->
ava_mš
 = 
·¿ms
->avail_min;

931 
¿wmidi
->
no_aùive_£nsšg
 = 
·¿ms
->no_active_sensing;

932 
¿wmidi
->
·¿ms_mode
 =„awmidi->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 2è? 0 : 
·¿ms
->
mode
;

934 
	}
}

942 
	$¢d_¿wmidi_·¿ms_cu¼’t
(
¢d_¿wmidi_t
 *
¿wmidi
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
)

944 
	`as£¹
(
¿wmidi
);

945 
	`as£¹
(
·¿ms
);

946 
·¿ms
->
bufãr_size
 = 
¿wmidi
->buffer_size;

947 
·¿ms
->
ava_mš
 = 
¿wmidi
->avail_min;

948 
·¿ms
->
no_aùive_£nsšg
 = 
¿wmidi
->no_active_sensing;

949 
·¿ms
->
mode
 = 
¿wmidi
->
·¿ms_mode
;

951 
	}
}

957 
size_t
 
	$¢d_¿wmidi_¡©us_sizeof
()

959  (
¢d_¿wmidi_¡©us_t
);

960 
	}
}

970 
	$¢d_¿wmidi_¡©us_m®loc
(
¢d_¿wmidi_¡©us_t
 **
±r
)

972 
	`as£¹
(
±r
);

973 *
±r
 = 
	`ÿÎoc
(1, (
¢d_¿wmidi_¡©us_t
));

974 ià(!*
±r
)

975  -
ENOMEM
;

977 
	}
}

986 
	$¢d_¿wmidi_¡©us_ä“
(
¢d_¿wmidi_¡©us_t
 *
¡©us
)

988 
	`as£¹
(
¡©us
);

989 
	`ä“
(
¡©us
);

990 
	}
}

997 
	$¢d_¿wmidi_¡©us_cİy
(
¢d_¿wmidi_¡©us_t
 *
d¡
, cÚ¡ snd_¿wmidi_¡©us_ˆ*
¤c
)

999 
	`as£¹
(
d¡
 && 
¤c
);

1000 *
d¡
 = *
¤c
;

1001 
	}
}

1008 
	$¢d_¿wmidi_¡©us_g‘_t¡amp
(cÚ¡ 
¢d_¿wmidi_¡©us_t
 *
¡©us
, 
¢d_htime¡amp_t
 *
t¡amp
)

1010 
	`as£¹
(
¡©us
 && 
t¡amp
);

1011 *
t¡amp
 = 
¡©us
->tstamp;

1012 
	}
}

1019 
size_t
 
	$¢d_¿wmidi_¡©us_g‘_ava
(cÚ¡ 
¢d_¿wmidi_¡©us_t
 *
¡©us
)

1021 
	`as£¹
(
¡©us
);

1022  
¡©us
->
ava
;

1023 
	}
}

1030 
size_t
 
	$¢d_¿wmidi_¡©us_g‘_xruns
(cÚ¡ 
¢d_¿wmidi_¡©us_t
 *
¡©us
)

1032 
	`as£¹
(
¡©us
);

1033  
¡©us
->
xruns
;

1034 
	}
}

1042 
	$¢d_¿wmidi_¡©us
(
¢d_¿wmidi_t
 *
¿wmidi
, 
¢d_¿wmidi_¡©us_t
 * 
¡©us
)

1044 
	`as£¹
(
¿wmidi
);

1045 
	`as£¹
(
¡©us
);

1046  
¿wmidi
->
İs
->
	`¡©us
Ôawmidi, 
¡©us
);

1047 
	}
}

1054 
	$¢d_¿wmidi_drİ
(
¢d_¿wmidi_t
 *
¿wmidi
)

1056 
	`as£¹
(
¿wmidi
);

1057  
¿wmidi
->
İs
->
	`drİ
(rawmidi);

1058 
	}
}

1068 
	$¢d_¿wmidi_d¿š
(
¢d_¿wmidi_t
 *
¿wmidi
)

1070 
	`as£¹
(
¿wmidi
);

1071  
¿wmidi
->
İs
->
	`d¿š
(rawmidi);

1072 
	}
}

1080 
ssize_t
 
	$¢d_¿wmidi_wr™e
(
¢d_¿wmidi_t
 *
¿wmidi
, cÚ¡ *
bufãr
, 
size_t
 
size
)

1082 
	`as£¹
(
¿wmidi
);

1083 
	`as£¹
(
¿wmidi
->
¡»am
 =ğ
SND_RAWMIDI_STREAM_OUTPUT
);

1084 
	`as£¹
(
bufãr
 || 
size
 == 0);

1085  
¿wmidi
->
İs
->
	`wr™e
Ôawmidi, 
bufãr
, 
size
);

1086 
	}
}

1095 
ssize_t
 
	$¢d_¿wmidi_»ad
(
¢d_¿wmidi_t
 *
¿wmidi
, *
bufãr
, 
size_t
 
size
)

1097 
	`as£¹
(
¿wmidi
);

1098 
	`as£¹
(
¿wmidi
->
¡»am
 =ğ
SND_RAWMIDI_STREAM_INPUT
);

1099 ià((
¿wmidi
->
·¿ms_mode
 & 
SNDRV_RAWMIDI_MODE_FRAMING_MASK
è=ğ
SNDRV_RAWMIDI_MODE_FRAMING_TSTAMP
)

1100 
size
 &ğ~((
¢d_¿wmidi_äamšg_t¡amp
) - 1);

1101 
	`as£¹
(
bufãr
 || 
size
 == 0);

1102  (
¿wmidi
->
İs
->
»ad
)Ôawmidi, 
bufãr
, 
size
);

1103 
	}
}

1113 
ssize_t
 
	$¢d_¿wmidi_Œ—d
(
¢d_¿wmidi_t
 *
¿wmidi
, 
time¥ec
 *
t¡amp
, *
bufãr
, 
size_t
 
size
)

1115 
	`as£¹
(
¿wmidi
);

1116 
	`as£¹
(
¿wmidi
->
¡»am
 =ğ
SND_RAWMIDI_STREAM_INPUT
);

1117 
	`as£¹
(
bufãr
 || 
size
 == 0);

1118 ià((
¿wmidi
->
·¿ms_mode
 & 
SNDRV_RAWMIDI_MODE_FRAMING_MASK
è!ğ
SNDRV_RAWMIDI_MODE_FRAMING_TSTAMP
)

1119  -
EINVAL
;

1120 ià(
¿wmidi
->
İs
->
Œ—d
 =ğ
NULL
)

1121  -
ENOTSUP
;

1122  (
¿wmidi
->
İs
->
Œ—d
)Ôawmidi, 
t¡amp
, 
bufãr
, 
size
);

1123 
	}
}

1125 #iâdeà
DOXYGEN


1129 
	$_¢d_¿wmidi_ump_’dpošt_šfo
(
¢d_¿wmidi_t
 *
rmidi
, *
šfo
)

1131 ià(!
rmidi
->
İs
->
ump_’dpošt_šfo
)

1132  -
ENXIO
;

1133  
rmidi
->
İs
->
	`ump_’dpošt_šfo
Ômidi, 
šfo
);

1134 
	}
}

1136 
	$_¢d_¿wmidi_ump_block_šfo
(
¢d_¿wmidi_t
 *
rmidi
, *
šfo
)

1138 ià(!
rmidi
->
İs
->
ump_block_šfo
)

1139  -
ENXIO
;

1140  
rmidi
->
İs
->
	`ump_block_šfo
Ômidi, 
šfo
);

1141 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_hw.c

23 
	~"cÚfig.h
"

24 
	~<¡dio.h
>

25 
	~<¡dlib.h
>

26 
	~<uni¡d.h
>

27 
	~<¡ršg.h
>

28 
	~<fú.h
>

29 
	~<sys/ioùl.h
>

30 
	~"../cÚŒŞ/cÚŒŞ_loÿl.h
"

31 
	~"¿wmidi_loÿl.h
"

33 #iâdeà
PIC


35 cÚ¡ *
	g_¢d_moduË_¿wmidi_hw
 = "";

38 
	#SNDRV_FILE_RAWMIDI
 
ALSA_DEVICE_DIRECTORY
 "midiC%iD%i"

	)

39 
	#SNDRV_FILE_UMP_RAWMIDI
 
ALSA_DEVICE_DIRECTORY
 "umpC%iD%i"

	)

40 
	#SNDRV_RAWMIDI_VERSION_MAX
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 0)

	)

42 #iâdeà
DOC_HIDDEN


44 
	mİ’
;

45 
	mfd
;

46 
	mÿrd
, 
	mdeviû
, 
	msubdeviû
;

47 *
	mbuf
;

48 
size_t
 
	mbuf_size
;

49 
size_t
 
	mbuf_fl
;

50 
size_t
 
	mbuf_pos
;

51 
size_t
 
	mbuf_åos
;

52 } 
	t¢d_¿wmidi_hw_t
;

55 
	$buf_»£t
(
¢d_¿wmidi_hw_t
 *
hw
)

57 
hw
->
buf_fl
 = 0;

58 
hw
->
buf_pos
 = 0;

59 
hw
->
buf_åos
 = 0;

60 
	}
}

62 
	$¢d_¿wmidi_hw_şo£
(
¢d_¿wmidi_t
 *
rmidi
)

64 
¢d_¿wmidi_hw_t
 *
hw
 = 
rmidi
->
´iv©e_d©a
;

65 
”r
 = 0;

67 
hw
->
İ’
--;

68 ià(
hw
->
İ’
)

70 ià(
	`şo£
(
hw
->
fd
)) {

71 
”r
 = -
”ºo
;

72 
	`SYSMSG
("close failed");

74 
	`ä“
(
hw
->
buf
);

75 
	`ä“
(
hw
);

76  
”r
;

77 
	}
}

79 
	$¢d_¿wmidi_hw_nÚblock
(
¢d_¿wmidi_t
 *
rmidi
, 
nÚblock
)

81 
¢d_¿wmidi_hw_t
 *
hw
 = 
rmidi
->
´iv©e_d©a
;

82 
æags
;

84 ià((
æags
 = 
	`fú
(
hw
->
fd
, 
F_GETFL
)) < 0) {

85 
	`SYSMSG
("F_GETFL failed");

86  -
”ºo
;

88 ià(
nÚblock
)

89 
æags
 |ğ
O_NONBLOCK
;

91 
æags
 &ğ~
O_NONBLOCK
;

92 ià(
	`fú
(
hw
->
fd
, 
F_SETFL
, 
æags
) < 0) {

93 
	`SYSMSG
("F_SETFL for O_NONBLOCK failed");

94  -
”ºo
;

97 
	}
}

99 
	$¢d_¿wmidi_hw_šfo
(
¢d_¿wmidi_t
 *
rmidi
, 
¢d_¿wmidi_šfo_t
 * 
šfo
)

101 
¢d_¿wmidi_hw_t
 *
hw
 = 
rmidi
->
´iv©e_d©a
;

102 
šfo
->
¡»am
 = 
rmidi
->stream;

103 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_RAWMIDI_IOCTL_INFO
, 
šfo
) < 0) {

104 
	`SYSMSG
("SNDRV_RAWMIDI_IOCTL_INFO failed");

105  -
”ºo
;

108 
	}
}

110 
	$¢d_¿wmidi_hw_·¿ms
(
¢d_¿wmidi_t
 *
rmidi
, 
¢d_¿wmidi_·¿ms_t
 * 
·¿ms
)

112 
¢d_¿wmidi_hw_t
 *
hw
 = 
rmidi
->
´iv©e_d©a
;

113 
t¡amp
;

114 
·¿ms
->
¡»am
 = 
rmidi
->stream;

115 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_RAWMIDI_IOCTL_PARAMS
, 
·¿ms
) < 0) {

116 
	`SYSMSG
("SNDRV_RAWMIDI_IOCTL_PARAMS failed");

117  -
”ºo
;

119 
	`buf_»£t
(
hw
);

120 
t¡amp
 = (
·¿ms
->
mode
 & 
SNDRV_RAWMIDI_MODE_FRAMING_MASK
è=ğ
SNDRV_RAWMIDI_MODE_FRAMING_TSTAMP
;

121 ià(
hw
->
buf
 && !
t¡amp
) {

122 
	`ä“
(
hw
->
buf
);

123 
hw
->
buf
 = 
NULL
;

124 
hw
->
buf_size
 = 0;

125 } ià(
t¡amp
) {

126 
size_t
 
®loc_size
;

127 *
buf
;

129 
®loc_size
 = 
	`·ge_size
();

130 ià(
·¿ms
->
bufãr_size
 > 
®loc_size
)

131 
®loc_size
 = 
·¿ms
->
bufãr_size
;

132 ià(
®loc_size
 !ğ
hw
->
buf_size
) {

133 
buf
 = 
	`»®loc
(
hw
->buf, 
®loc_size
);

134 ià(
buf
 =ğ
NULL
)

135  -
ENOMEM
;

136 
hw
->
buf
 = buf;

137 
hw
->
buf_size
 = 
®loc_size
;

141 
	}
}

143 
	$¢d_¿wmidi_hw_¡©us
(
¢d_¿wmidi_t
 *
rmidi
, 
¢d_¿wmidi_¡©us_t
 * 
¡©us
)

145 
¢d_¿wmidi_hw_t
 *
hw
 = 
rmidi
->
´iv©e_d©a
;

146 
¡©us
->
¡»am
 = 
rmidi
->stream;

147 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_RAWMIDI_IOCTL_STATUS
, 
¡©us
) < 0) {

148 
	`SYSMSG
("SNDRV_RAWMIDI_IOCTL_STATUS failed");

149  -
”ºo
;

152 
	}
}

154 
	$¢d_¿wmidi_hw_drİ
(
¢d_¿wmidi_t
 *
rmidi
)

156 
¢d_¿wmidi_hw_t
 *
hw
 = 
rmidi
->
´iv©e_d©a
;

157 
¡r
 = 
rmidi
->
¡»am
;

158 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_RAWMIDI_IOCTL_DROP
, &
¡r
) < 0) {

159 
	`SYSMSG
("SNDRV_RAWMIDI_IOCTL_DROP failed");

160  -
”ºo
;

162 
	`buf_»£t
(
hw
);

164 
	}
}

166 
	$¢d_¿wmidi_hw_d¿š
(
¢d_¿wmidi_t
 *
rmidi
)

168 
¢d_¿wmidi_hw_t
 *
hw
 = 
rmidi
->
´iv©e_d©a
;

169 
¡r
 = 
rmidi
->
¡»am
;

170 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_RAWMIDI_IOCTL_DRAIN
, &
¡r
) < 0) {

171 
	`SYSMSG
("SNDRV_RAWMIDI_IOCTL_DRAIN failed");

172  -
”ºo
;

175 
	}
}

177 
ssize_t
 
	$¢d_¿wmidi_hw_wr™e
(
¢d_¿wmidi_t
 *
rmidi
, cÚ¡ *
bufãr
, 
size_t
 
size
)

179 
¢d_¿wmidi_hw_t
 *
hw
 = 
rmidi
->
´iv©e_d©a
;

180 
ssize_t
 
»suÉ
;

181 
»suÉ
 = 
	`wr™e
(
hw
->
fd
, 
bufãr
, 
size
);

182 ià(
»suÉ
 < 0)

183  -
”ºo
;

184  
»suÉ
;

185 
	}
}

187 
ssize_t
 
	$¢d_¿wmidi_hw_»ad
(
¢d_¿wmidi_t
 *
rmidi
, *
bufãr
, 
size_t
 
size
)

189 
¢d_¿wmidi_hw_t
 *
hw
 = 
rmidi
->
´iv©e_d©a
;

190 
ssize_t
 
»suÉ
;

191 
»suÉ
 = 
	`»ad
(
hw
->
fd
, 
bufãr
, 
size
);

192 ià(
»suÉ
 < 0)

193  -
”ºo
;

194  
»suÉ
;

195 
	}
}

197 
ssize_t
 
	$»ad_äom_ts_buf
(
¢d_¿wmidi_hw_t
 *
hw
, 
time¥ec
 *
t¡amp
,

198 *
bufãr
, 
size_t
 
size
)

200 
¢d_¿wmidi_äamšg_t¡amp
 *
f
;

201 
size_t
 
æ’
;

202 
ssize_t
 
»suÉ
 = 0;

204 
f
 = (
¢d_¿wmidi_äamšg_t¡amp
 *)(
hw
->
buf
 + hw->
buf_pos
);

205 
hw
->
buf_fl
 >ğ(*
f
)) {

206 ià(
f
->
äame_ty³
 == 0) {

207 
t¡amp
->
tv_£c
 = 
f
->tv_sec;

208 
t¡amp
->
tv_n£c
 = 
f
->tv_nsec;

211 
hw
->
buf_pos
 +ğ(*
f
);

212 
hw
->
buf_fl
 -ğ(*
f
);

213 
f
++;

215 
size
 > 0 && 
hw
->
buf_fl
 >ğ(*
f
)) {

217 ià(
f
->
äame_ty³
 != 0)

218 
__Ãxt
;

219 ià(
f
->
Ëngth
 =ğ0 || f->Ëngth > 
SNDRV_RAWMIDI_FRAMING_DATA_LENGTH
)

220  -
EINVAL
;

221 ià(
t¡amp
->
tv_£c
 !ğ(
time_t
)
f
->tv_sec ||

222 
t¡amp
->
tv_n£c
 !ğ
f
->tv_nsec)

224 
æ’
 = 
f
->
Ëngth
 - 
hw
->
buf_åos
;

225 ià(
size
 < 
æ’
) {

227 
	`memıy
(
bufãr
, 
f
->
d©a
 + 
hw
->
buf_åos
, 
size
);

228 
hw
->
buf_åos
 +ğ
size
;

229 
»suÉ
 +ğ
size
;

232 
	`memıy
(
bufãr
, 
f
->
d©a
 + 
hw
->
buf_åos
, 
æ’
);

233 
hw
->
buf_åos
 = 0;

234 
bufãr
 +ğ
æ’
;

235 
size
 -ğ
æ’
;

236 
»suÉ
 +ğ
æ’
;

237 
__Ãxt
:

238 
hw
->
buf_pos
 +ğ(*
f
);

239 
hw
->
buf_fl
 -ğ(*
f
);

240 
f
++;

242  
»suÉ
;

243 
	}
}

245 
ssize_t
 
	$¢d_¿wmidi_hw_Œ—d
(
¢d_¿wmidi_t
 *
rmidi
, 
time¥ec
 *
t¡amp
,

246 *
bufãr
, 
size_t
 
size
)

248 
¢d_¿wmidi_hw_t
 *
hw
 = 
rmidi
->
´iv©e_d©a
;

249 
ssize_t
 
»suÉ
 = 0, 
»t
;

252 
t¡amp
->
tv_£c
 =¡amp->
tv_n£c
 = 0;

255 ià(
hw
->
buf_fl
 > 0) {

256 
»suÉ
 = 
	`»ad_äom_ts_buf
(
hw
, 
t¡amp
, 
bufãr
, 
size
);

257 ià(
»suÉ
 < 0 || 
size
 =ğ(
size_t
)result ||

258 
hw
->
buf_fl
 >ğ(
¢d_¿wmidi_äamšg_t¡amp
))

259  
»suÉ
;

260 
bufãr
 +ğ
»suÉ
;

261 
size
 -ğ
»suÉ
;

264 
	`buf_»£t
(
hw
);

265 
»t
 = 
	`»ad
(
hw
->
fd
, hw->
buf
, hw->
buf_size
);

266 ià(
»t
 < 0)

267  
»suÉ
 > 0 ?„esuÉ : -
”ºo
;

268 ià(
»t
 < (
ssize_t
)(
¢d_¿wmidi_äamšg_t¡amp
))

269  
»suÉ
;

270 
hw
->
buf_fl
 = 
»t
;

271 
»t
 = 
	`»ad_äom_ts_buf
(
hw
, 
t¡amp
, 
bufãr
, 
size
);

272 ià(
»t
 < 0 && 
»suÉ
 > 0)

273  
»suÉ
;

274  
»t
 + 
»suÉ
;

275 
	}
}

277 
	$¢d_¿wmidi_hw_ump_’dpošt_šfo
(
¢d_¿wmidi_t
 *
rmidi
, *
buf
)

279 
¢d_¿wmidi_hw_t
 *
hw
 = 
rmidi
->
´iv©e_d©a
;

281 ià(
rmidi
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 3))

282  -
ENXIO
;

283 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_UMP_IOCTL_ENDPOINT_INFO
, 
buf
) < 0)

284  -
”ºo
;

286 
	}
}

288 
	$¢d_¿wmidi_hw_ump_block_šfo
(
¢d_¿wmidi_t
 *
rmidi
, *
buf
)

290 
¢d_¿wmidi_hw_t
 *
hw
 = 
rmidi
->
´iv©e_d©a
;

292 ià(
rmidi
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 3))

293  -
ENXIO
;

294 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_UMP_IOCTL_BLOCK_INFO
, 
buf
) < 0)

295  -
”ºo
;

297 
	}
}

299 cÚ¡ 
¢d_¿wmidi_İs_t
 
	g¢d_¿wmidi_hw_İs
 = {

300 .
şo£
 = 
¢d_¿wmidi_hw_şo£
,

301 .
	gnÚblock
 = 
¢d_¿wmidi_hw_nÚblock
,

302 .
	gšfo
 = 
¢d_¿wmidi_hw_šfo
,

303 .
	g·¿ms
 = 
¢d_¿wmidi_hw_·¿ms
,

304 .
	g¡©us
 = 
¢d_¿wmidi_hw_¡©us
,

305 .
	gdrİ
 = 
¢d_¿wmidi_hw_drİ
,

306 .
	gd¿š
 = 
¢d_¿wmidi_hw_d¿š
,

307 .
	gwr™e
 = 
¢d_¿wmidi_hw_wr™e
,

308 .
	g»ad
 = 
¢d_¿wmidi_hw_»ad
,

309 .
	gŒ—d
 = 
¢d_¿wmidi_hw_Œ—d
,

310 .
	gump_’dpošt_šfo
 = 
¢d_¿wmidi_hw_ump_’dpošt_šfo
,

311 .
	gump_block_šfo
 = 
¢d_¿wmidi_hw_ump_block_šfo
,

315 
	$¢d_¿wmidi_hw_İ’
(
¢d_¿wmidi_t
 **
špu
, snd_¿wmidi_ˆ**
ouu
,

316 cÚ¡ *
Çme
, 
ÿrd
, 
deviû
, 
subdeviû
,

317 
mode
)

319 
fd
, 
v”
, 
»t
;

320 
©‹m±
 = 0;

321 
f’ame
[(
SNDRV_FILE_RAWMIDI
) + 20];

322 
¢d_ùl_t
 *
ùl
;

323 
¢d_¿wmidi_t
 *
rmidi
;

324 
¢d_¿wmidi_hw_t
 *
hw
 = 
NULL
;

325 
¢d_¿wmidi_šfo_t
 
šfo
;

326 
is_ump
;

327 
fmode
;

329 
is_ump
 = !!(
mode
 & 
_SND_RAWMIDI_OPEN_UMP
);

330 
mode
 &ğ~
_SND_RAWMIDI_OPEN_UMP
;

332 ià(
špu
)

333 *
špu
 = 
NULL
;

334 ià(
ouu
)

335 *
ouu
 = 
NULL
;

336 ià(!
špu
 && !
ouu
)

337  -
EINVAL
;

339 ià((
»t
 = 
	`¢d_ùl_hw_İ’
(&
ùl
, 
NULL
, 
ÿrd
, 0)) < 0)

340  
»t
;

341 ià(
is_ump
)

342 
	`¥rštf
(
f’ame
, 
SNDRV_FILE_UMP_RAWMIDI
, 
ÿrd
, 
deviû
);

344 
	`¥rštf
(
f’ame
, 
SNDRV_FILE_RAWMIDI
, 
ÿrd
, 
deviû
);

346 
__agaš
:

347 ià(
©‹m±
++ > 3) {

348 
	`¢d_ùl_şo£
(
ùl
);

349  -
EBUSY
;

351 
»t
 = 
	`¢d_ùl_¿wmidi_´eãr_subdeviû
(
ùl
, 
subdeviû
);

352 ià(
»t
 < 0) {

353 
	`¢d_ùl_şo£
(
ùl
);

354  
»t
;

357 ià(!
špu
)

358 
fmode
 = 
O_WRONLY
;

359 ià(!
ouu
)

360 
fmode
 = 
O_RDONLY
;

362 
fmode
 = 
O_RDWR
;

364 ià(
mode
 & 
SND_RAWMIDI_APPEND
) {

365 
	`as£¹
(
ouu
);

366 
fmode
 |ğ
O_APPEND
;

369 ià(
mode
 & 
SND_RAWMIDI_NONBLOCK
) {

370 
fmode
 |ğ
O_NONBLOCK
;

373 ià(
mode
 & 
SND_RAWMIDI_SYNC
) {

374 
fmode
 |ğ
O_SYNC
;

377 
	`as£¹
(!(
mode
 & ~(
SND_RAWMIDI_APPEND
|
SND_RAWMIDI_NONBLOCK
|
SND_RAWMIDI_SYNC
)));

379 
fd
 = 
	`¢d_İ’_deviû
(
f’ame
, 
fmode
);

380 ià(
fd
 < 0) {

381 
	`¢d_ÿrd_lßd
(
ÿrd
);

382 
fd
 = 
	`¢d_İ’_deviû
(
f’ame
, 
fmode
);

383 ià(
fd
 < 0) {

384 
	`¢d_ùl_şo£
(
ùl
);

385 
	`SYSMSG
("İ’ % çed", 
f’ame
);

386  -
”ºo
;

389 ià(
	`ioùl
(
fd
, 
SNDRV_RAWMIDI_IOCTL_PVERSION
, &
v”
) < 0) {

390 
»t
 = -
”ºo
;

391 
	`SYSMSG
("SNDRV_RAWMIDI_IOCTL_PVERSION failed");

392 
	`şo£
(
fd
);

393 
	`¢d_ùl_şo£
(
ùl
);

394  
»t
;

396 ià(
	`SNDRV_PROTOCOL_INCOMPATIBLE
(
v”
, 
SNDRV_RAWMIDI_VERSION_MAX
)) {

397 
	`şo£
(
fd
);

398 
	`¢d_ùl_şo£
(
ùl
);

399  -
SND_ERROR_INCOMPATIBLE_VERSION
;

401 ià(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 2è<ğ
v”
) {

403 
u£r_v”
 = 
SNDRV_RAWMIDI_VERSION
;

404 
	`ioùl
(
fd
, 
SNDRV_RAWMIDI_IOCTL_USER_PVERSION
, &
u£r_v”
);

406 ià(
subdeviû
 >= 0) {

407 
	`mem£t
(&
šfo
, 0, (info));

408 
šfo
.
¡»am
 = 
ouu
 ? 
SNDRV_RAWMIDI_STREAM_OUTPUT
 : 
SNDRV_RAWMIDI_STREAM_INPUT
;

409 ià(
	`ioùl
(
fd
, 
SNDRV_RAWMIDI_IOCTL_INFO
, &
šfo
) < 0) {

410 
	`SYSMSG
("SNDRV_RAWMIDI_IOCTL_INFO failed");

411 
»t
 = -
”ºo
;

412 
	`şo£
(
fd
);

413 
	`¢d_ùl_şo£
(
ùl
);

414  
»t
;

416 ià(
šfo
.
subdeviû
 != () subdevice) {

417 
	`şo£
(
fd
);

418 
__agaš
;

421 
	`¢d_ùl_şo£
(
ùl
);

423 
hw
 = 
	`ÿÎoc
(1, (
¢d_¿wmidi_hw_t
));

424 ià(
hw
 =ğ
NULL
)

425 
_nomem
;

426 
hw
->
ÿrd
 = card;

427 
hw
->
deviû
 = device;

428 
hw
->
subdeviû
 = subdevice;

429 
hw
->
fd
 = fd;

431 ià(
špu
) {

432 
rmidi
 = 
	`ÿÎoc
(1, (
¢d_¿wmidi_t
));

433 ià(
rmidi
 =ğ
NULL
)

434 
_nomem
;

435 ià(
Çme
)

436 
rmidi
->
Çme
 = 
	`¡rdup
(name);

437 
rmidi
->
ty³
 = 
SND_RAWMIDI_TYPE_HW
;

438 
rmidi
->
¡»am
 = 
SND_RAWMIDI_STREAM_INPUT
;

439 
rmidi
->
mode
 = mode;

440 
rmidi
->
pŞl_fd
 = 
fd
;

441 
rmidi
->
İs
 = &
¢d_¿wmidi_hw_İs
;

442 
rmidi
->
´iv©e_d©a
 = 
hw
;

443 
rmidi
->
v”siÚ
 = 
v”
;

444 
hw
->
İ’
++;

445 *
špu
 = 
rmidi
;

447 ià(
ouu
) {

448 
rmidi
 = 
	`ÿÎoc
(1, (
¢d_¿wmidi_t
));

449 ià(
rmidi
 =ğ
NULL
)

450 
_nomem
;

451 ià(
Çme
)

452 
rmidi
->
Çme
 = 
	`¡rdup
(name);

453 
rmidi
->
ty³
 = 
SND_RAWMIDI_TYPE_HW
;

454 
rmidi
->
¡»am
 = 
SND_RAWMIDI_STREAM_OUTPUT
;

455 
rmidi
->
mode
 = mode;

456 
rmidi
->
pŞl_fd
 = 
fd
;

457 
rmidi
->
İs
 = &
¢d_¿wmidi_hw_İs
;

458 
rmidi
->
´iv©e_d©a
 = 
hw
;

459 
rmidi
->
v”siÚ
 = 
v”
;

460 
hw
->
İ’
++;

461 *
ouu
 = 
rmidi
;

465 
_nomem
:

466 
	`şo£
(
fd
);

467 
	`ä“
(
hw
);

468 ià(
špu
)

469 
	`ä“
(*
špu
);

470 ià(
ouu
)

471 
	`ä“
(*
ouu
);

472  -
ENOMEM
;

473 
	}
}

475 
	$_¢d_¿wmidi_hw_İ’
(
¢d_¿wmidi_t
 **
špu
, snd_¿wmidi_ˆ**
ouu
,

476 *
Çme
, 
¢d_cÚfig_t
 *
roÙ
 
ATTRIBUTE_UNUSED
,

477 
¢d_cÚfig_t
 *
cÚf
, 
mode
)

479 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

480 
ÿrd
 = -1, 
deviû
 = 0, 
subdeviû
 = -1;

481 
”r
;

482 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

483 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

484 cÚ¡ *
id
;

485 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

487 ià(
	`¢d_¿wmidi_cÚf_g’”ic_id
(
id
))

489 ià(
	`¡rcmp
(
id
, "card") == 0) {

490 
”r
 = 
	`¢d_cÚfig_g‘_ÿrd
(
n
);

491 ià(
”r
 < 0)

492  
”r
;

493 
ÿrd
 = 
”r
;

496 ià(
	`¡rcmp
(
id
, "device") == 0) {

497 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
deviû
);

498 ià(
”r
 < 0)

499  
”r
;

502 ià(
	`¡rcmp
(
id
, "subdevice") == 0) {

503 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
subdeviû
);

504 ià(
”r
 < 0)

505  
”r
;

508  -
EINVAL
;

510 ià(
ÿrd
 < 0)

511  -
EINVAL
;

512  
	`¢d_¿wmidi_hw_İ’
(
špu
, 
ouu
, 
Çme
, 
ÿrd
, 
deviû
, 
subdeviû
, 
mode
);

513 
	}
}

514 
SND_DLSYM_BUILD_VERSION
(
_¢d_¿wmidi_hw_İ’
, 
SND_RAWMIDI_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_local.h

22 
	~"loÿl.h
"

23 
	~<¡dio.h
>

24 
	~<¡dlib.h
>

25 
	~<lim™s.h
>

28 (*
	mşo£
)(
¢d_¿wmidi_t
 *
	m¿wmidi
);

29 (*
	mnÚblock
)(
¢d_¿wmidi_t
 *
	m¿wmidi
, nonblock);

30 (*
	mšfo
)(
¢d_¿wmidi_t
 *
	m¿wmidi
, 
¢d_¿wmidi_šfo_t
 *info);

31 (*
	m·¿ms
)(
¢d_¿wmidi_t
 *
	m¿wmidi
, 
¢d_¿wmidi_·¿ms_t
 *params);

32 (*
	m¡©us
)(
¢d_¿wmidi_t
 *
	m¿wmidi
, 
¢d_¿wmidi_¡©us_t
 *status);

33 (*
	mdrİ
)(
¢d_¿wmidi_t
 *
	m¿wmidi
);

34 (*
	md¿š
)(
¢d_¿wmidi_t
 *
	m¿wmidi
);

35 
ssize_t
 (*
wr™e
)(
¢d_¿wmidi_t
 *
	m¿wmidi
, cÚ¡ *
	mbufãr
, 
size_t
 
	msize
);

36 
ssize_t
 (*
»ad
)(
¢d_¿wmidi_t
 *
	m¿wmidi
, *
	mbufãr
, 
size_t
 
	msize
);

37 
ssize_t
 (*
Œ—d
)(
¢d_¿wmidi_t
 *
	m¿wmidi
, 
time¥ec
 *
	mt¡amp
, *
	mbufãr
, 
size_t
 
	msize
);

38 (*
	mump_’dpošt_šfo
)(
¢d_¿wmidi_t
 *
	mrmidi
, *
	mbuf
);

39 (*
	mump_block_šfo
)(
¢d_¿wmidi_t
 *
	mrmidi
, *
	mbuf
);

40 } 
	t¢d_¿wmidi_İs_t
;

42 
	s_¢d_¿wmidi
 {

43 *
	mİ’_func
;

44 *
	mÇme
;

45 
¢d_¿wmidi_ty³_t
 
	mty³
;

46 
¢d_¿wmidi_¡»am_t
 
	m¡»am
;

47 
	mmode
;

48 
	mv”siÚ
;

49 
	mpŞl_fd
;

50 cÚ¡ 
¢d_¿wmidi_İs_t
 *
	mİs
;

51 *
	m´iv©e_d©a
;

52 
size_t
 
	mbufãr_size
;

53 
size_t
 
	mava_mš
;

54 
	mno_aùive_£nsšg
: 1;

55 
	m·¿ms_mode
;

58 
¢d_¿wmidi_hw_İ’
(
¢d_¿wmidi_t
 **
šput
, snd_¿wmidi_ˆ**
ouut
,

59 cÚ¡ *
Çme
, 
ÿrd
, 
deviû
, 
subdeviû
,

60 
mode
);

62 
¢d_¿wmidi_vœtu®_İ’
(
¢d_¿wmidi_t
 **
špu
, snd_¿wmidi_ˆ**
ouu
,

63 cÚ¡ *
Çme
, 
¢d_£q_t
 *
£q_hªdË
, 
pÜt
,

64 
m”ge
, 
mode
);

66 
	#¢d_¿wmidi_cÚf_g’”ic_id
(
id
è
	`_¢d_cÚf_g’”ic_id
(id)

	)

68 
_¢d_¿wmidi_ump_’dpošt_šfo
(
¢d_¿wmidi_t
 *
rmidi
, *
šfo
);

69 
_¢d_¿wmidi_ump_block_šfo
(
¢d_¿wmidi_t
 *
rmidi
, *
šfo
);

71 
	#_SND_RAWMIDI_OPEN_UMP
 (1U << 16è

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_symbols.c

21 #iâdeà
PIC


23 cÚ¡ *
_¢d_moduË_¿wmidi_hw
;

24 #ifdeà
BUILD_SEQ


25 cÚ¡ *
_¢d_moduË_¿wmidi_vœt
;

28 cÚ¡ **
	g¢d_¿wmidi_İ’_objeùs
[] = {

29 &
_¢d_moduË_¿wmidi_hw
,

30 #ifdeà
BUILD_SEQ


31 &
_¢d_moduË_¿wmidi_vœt


35 *
	$¢d_¿wmidi_İ’_symbŞs
()

37  
¢d_¿wmidi_İ’_objeùs
;

38 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_virt.c

22 
	~"¿wmidi_loÿl.h
"

23 
	~<uni¡d.h
>

24 
	~<¡ršg.h
>

25 
	~<fú.h
>

26 
	~<sys/ioùl.h
>

27 
	~"£q.h
"

28 
	~"£q_midi_ev’t.h
"

30 #iâdeà
PIC


32 cÚ¡ *
	g_¢d_moduË_¿wmidi_vœt
 = "";

36 #iâdeà
DOC_HIDDEN


38 
	mİ’
;

40 
¢d_£q_t
 *
	mhªdË
;

41 
	mpÜt
;

43 
¢d_midi_ev’t_t
 *
	mmidi_ev’t
;

45 
¢d_£q_ev’t_t
 *
	mš_ev’t
;

46 
	mš_buf_size
;

47 
	mš_buf_ofs
;

48 *
	mš_buf_±r
;

49 
	mš_tmp_buf
[16];

51 
¢d_£q_ev’t_t
 
	mout_ev’t
;

52 
	m³ndšg
;

53 } 
	t¢d_¿wmidi_vœtu®_t
;

55 
_¢d_£q_İ’_lcÚf
(
¢d_£q_t
 **
£qp
, cÚ¡ *
Çme
,

56 
¡»ams
, 
mode
, 
¢d_cÚfig_t
 *
lcÚf
,

57 
¢d_cÚfig_t
 *
·»Á_cÚf
);

60 
	$¢d_¿wmidi_vœtu®_şo£
(
¢d_¿wmidi_t
 *
rmidi
)

62 
¢d_¿wmidi_vœtu®_t
 *
vœt
 = 
rmidi
->
´iv©e_d©a
;

63 
vœt
->
İ’
--;

64 ià(
vœt
->
İ’
)

66 
	`¢d_£q_şo£
(
vœt
->
hªdË
);

67 ià(
vœt
->
midi_ev’t
)

68 
	`¢d_midi_ev’t_ä“
(
vœt
->
midi_ev’t
);

69 
	`ä“
(
vœt
);

71 
	}
}

73 
	$¢d_¿wmidi_vœtu®_nÚblock
(
¢d_¿wmidi_t
 *
rmidi
, 
nÚblock
)

75 
¢d_¿wmidi_vœtu®_t
 *
vœt
 = 
rmidi
->
´iv©e_d©a
;

77  
	`¢d_£q_nÚblock
(
vœt
->
hªdË
, 
nÚblock
);

78 
	}
}

80 
	$¢d_¿wmidi_vœtu®_šfo
(
¢d_¿wmidi_t
 *
rmidi
, 
¢d_¿wmidi_šfo_t
 * 
šfo
)

84 
šfo
->
¡»am
 = 
rmidi
->stream;

86 
šfo
->
ÿrd
 = 0;

87 
šfo
->
deviû
 = 0;

88 
šfo
->
subdeviû
 = 0;

89 
šfo
->
æags
 = 0;

90 
	`¡rıy
((*)
šfo
->
id
, "Virtual");

91 
	`¡rıy
((*)
šfo
->
Çme
, "Virtual RawMIDI");

92 
	`¡rıy
((*)
šfo
->
subÇme
, "Virtual RawMIDI");

93 
šfo
->
subdeviûs_couÁ
 = 1;

94 
šfo
->
subdeviûs_ava
 = 0;

96 
	}
}

98 
	$¢d_¿wmidi_vœtu®_šput_·¿ms
(
¢d_¿wmidi_vœtu®_t
 *
vœt
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
)

100 
”r
;

103 ià(
·¿ms
->
bufãr_size
 < (
¢d_£q_ev’t_t
) ||

104 
·¿ms
->
bufãr_size
 > 1024L * 1024L) {

105  -
EINVAL
;

107 ià(
·¿ms
->
bufãr_size
 !ğ
	`¢d_£q_g‘_šput_bufãr_size
(
vœt
->
hªdË
)) {

108 
”r
 = 
	`¢d_£q_£t_šput_bufãr_size
(
vœt
->
hªdË
, 
·¿ms
->
bufãr_size
);

109 ià(
”r
 < 0)

110  
”r
;

111 
·¿ms
->
bufãr_size
 = 
	`¢d_£q_g‘_šput_bufãr_size
(
vœt
->
hªdË
);

115 
	}
}

118 
	$¢d_¿wmidi_vœtu®_ouut_·¿ms
(
¢d_¿wmidi_vœtu®_t
 *
vœt
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
)

120 
”r
;

123 ià(
·¿ms
->
bufãr_size
 < (
¢d_£q_ev’t_t
) ||

124 
·¿ms
->
bufãr_size
 > 1024L * 1024L) {

125  -
EINVAL
;

127 ià(
·¿ms
->
bufãr_size
 !ğ
	`¢d_£q_g‘_ouut_bufãr_size
(
vœt
->
hªdË
)) {

128 
”r
 = 
	`¢d_£q_£t_ouut_bufãr_size
(
vœt
->
hªdË
, 
·¿ms
->
bufãr_size
);

129 ià(
”r
 < 0)

130  
”r
;

131 
·¿ms
->
bufãr_size
 = 
	`¢d_£q_g‘_ouut_bufãr_size
(
vœt
->
hªdË
);

134 
	}
}

137 
	$¢d_¿wmidi_vœtu®_·¿ms
(
¢d_¿wmidi_t
 *
rmidi
, 
¢d_¿wmidi_·¿ms_t
 * 
·¿ms
)

139 
¢d_¿wmidi_vœtu®_t
 *
vœt
 = 
rmidi
->
´iv©e_d©a
;

140 
·¿ms
->
¡»am
 = 
rmidi
->stream;

142 ià(
rmidi
->
¡»am
 =ğ
SND_RAWMIDI_STREAM_INPUT
)

143  
	`¢d_¿wmidi_vœtu®_šput_·¿ms
(
vœt
, 
·¿ms
);

145  
	`¢d_¿wmidi_vœtu®_ouut_·¿ms
(
vœt
, 
·¿ms
);

146 
	}
}

148 
	$¢d_¿wmidi_vœtu®_¡©us
(
¢d_¿wmidi_t
 *
rmidi
, 
¢d_¿wmidi_¡©us_t
 * 
¡©us
)

151 
	`mem£t
(
¡©us
, 0, (*status));

152 
¡©us
->
¡»am
 = 
rmidi
->stream;

154 
	}
}

156 
	$¢d_¿wmidi_vœtu®_drİ
(
¢d_¿wmidi_t
 *
rmidi
)

158 
¢d_¿wmidi_vœtu®_t
 *
vœt
 = 
rmidi
->
´iv©e_d©a
;

159 ià(
rmidi
->
¡»am
 =ğ
SND_RAWMIDI_STREAM_OUTPUT
) {

160 
	`¢d_£q_drİ_ouut
(
vœt
->
hªdË
);

161 
	`¢d_midi_ev’t_»£t_’code
(
vœt
->
midi_ev’t
);

162 
vœt
->
³ndšg
 = 0;

164 
	`¢d_£q_drİ_šput
(
vœt
->
hªdË
);

165 
	`¢d_midi_ev’t_»£t_decode
(
vœt
->
midi_ev’t
);

166 
vœt
->
š_buf_ofs
 = 0;

169 
	}
}

171 
	$¢d_¿wmidi_vœtu®_d¿š
(
¢d_¿wmidi_t
 *
rmidi
)

173 
¢d_¿wmidi_vœtu®_t
 *
vœt
 = 
rmidi
->
´iv©e_d©a
;

174 
”r
;

176 ià(
rmidi
->
¡»am
 =ğ
SND_RAWMIDI_STREAM_OUTPUT
) {

177 ià(
vœt
->
³ndšg
) {

178 
”r
 = 
	`¢d_£q_ev’t_ouut
(
vœt
->
hªdË
, &vœt->
out_ev’t
);

179 ià(
”r
 < 0)

180  
”r
;

181 
vœt
->
³ndšg
 = 0;

183 
	`¢d_£q_d¿š_ouut
(
vœt
->
hªdË
);

184 
	`¢d_£q_sync_ouut_queue
(
vœt
->
hªdË
);

186  
	`¢d_¿wmidi_vœtu®_drİ
(
rmidi
);

187 
	}
}

189 
ssize_t
 
	$¢d_¿wmidi_vœtu®_wr™e
(
¢d_¿wmidi_t
 *
rmidi
, cÚ¡ *
bufãr
, 
size_t
 
size
)

191 
¢d_¿wmidi_vœtu®_t
 *
vœt
 = 
rmidi
->
´iv©e_d©a
;

192 
ssize_t
 
»suÉ
 = 0;

193 
ssize_t
 
size1
;

194 
”r
;

196 ià(
vœt
->
³ndšg
) {

197 
”r
 = 
	`¢d_£q_ev’t_ouut
(
vœt
->
hªdË
, &vœt->
out_ev’t
);

198 ià(
”r
 < 0) {

199 ià(
”r
 !ğ-
EAGAIN
)

203 
vœt
->
³ndšg
 = 0;

204  
”r
;

206 
vœt
->
³ndšg
 = 0;

209 
size
 > 0) {

210 
size1
 = 
	`¢d_midi_ev’t_’code
(
vœt
->
midi_ev’t
, 
bufãr
, 
size
, &vœt->
out_ev’t
);

211 ià(
size1
 <= 0)

213 
size
 -ğ
size1
;

214 
»suÉ
 +ğ
size1
;

215 
bufãr
 +ğ
size1
;

216 ià(
vœt
->
out_ev’t
.
ty³
 =ğ
SND_SEQ_EVENT_NONE
)

218 
	`¢d_£q_ev_£t_subs
(&
vœt
->
out_ev’t
);

219 
	`¢d_£q_ev_£t_sourû
(&
vœt
->
out_ev’t
, vœt->
pÜt
);

220 
	`¢d_£q_ev_£t_dœeù
(&
vœt
->
out_ev’t
);

221 
”r
 = 
	`¢d_£q_ev’t_ouut
(
vœt
->
hªdË
, &vœt->
out_ev’t
);

222 ià(
”r
 < 0) {

223 
vœt
->
³ndšg
 = 1;

224  
»suÉ
 > 0 ?„esuÉ : 
”r
;

228 ià(
»suÉ
 > 0)

229 
	`¢d_£q_d¿š_ouut
(
vœt
->
hªdË
);

231  
»suÉ
;

232 
	}
}

234 
ssize_t
 
	$¢d_¿wmidi_vœtu®_»ad
(
¢d_¿wmidi_t
 *
rmidi
, *
bufãr
, 
size_t
 
size
)

236 
¢d_¿wmidi_vœtu®_t
 *
vœt
 = 
rmidi
->
´iv©e_d©a
;

237 
ssize_t
 
»suÉ
 = 0;

238 
size1
, 
”r
;

240 
size
 > 0) {

241 ià(! 
vœt
->
š_buf_ofs
) {

242 
”r
 = 
	`¢d_£q_ev’t_šput_³ndšg
(
vœt
->
hªdË
, 1);

243 ià(
”r
 <ğ0 && 
»suÉ
 > 0)

244  
»suÉ
;

245 
”r
 = 
	`¢d_£q_ev’t_šput
(
vœt
->
hªdË
, &vœt->
š_ev’t
);

246 ià(
”r
 < 0)

247  
»suÉ
 > 0 ?„esuÉ : 
”r
;

249 ià(
vœt
->
š_ev’t
->
ty³
 =ğ
SND_SEQ_EVENT_SYSEX
) {

250 
vœt
->
š_buf_±r
 = vœt->
š_ev’t
->
d©a
.
ext
.
±r
;

251 
vœt
->
š_buf_size
 = vœt->
š_ev’t
->
d©a
.
ext
.
Ën
;

253 
vœt
->
š_buf_±r
 = vœt->
š_tmp_buf
;

254 
vœt
->
š_buf_size
 = 
	`¢d_midi_ev’t_decode
(vœt->
midi_ev’t
,

255 (*)
vœt
->
š_tmp_buf
,

256 (
vœt
->
š_tmp_buf
),

257 
vœt
->
š_ev’t
);

259 ià(
vœt
->
š_buf_size
 <= 0)

262 
size1
 = 
vœt
->
š_buf_size
 - vœt->
š_buf_ofs
;

263 ià((
size_t
)
size1
 > 
size
) {

264 
	`memıy
(
bufãr
, 
vœt
->
š_buf_±r
 + vœt->
š_buf_ofs
, 
size
);

265 
vœt
->
š_buf_ofs
 +ğ
size
;

266 
»suÉ
 +ğ
size
;

269 
	`memıy
(
bufãr
, 
vœt
->
š_buf_±r
 + vœt->
š_buf_ofs
, 
size1
);

270 
size
 -ğ
size1
;

271 
»suÉ
 +ğ
size1
;

272 
bufãr
 +ğ
size1
;

273 
vœt
->
š_buf_ofs
 = 0;

276  
»suÉ
;

277 
	}
}

279 cÚ¡ 
¢d_¿wmidi_İs_t
 
	g¢d_¿wmidi_vœtu®_İs
 = {

280 .
şo£
 = 
¢d_¿wmidi_vœtu®_şo£
,

281 .
	gnÚblock
 = 
¢d_¿wmidi_vœtu®_nÚblock
,

282 .
	gšfo
 = 
¢d_¿wmidi_vœtu®_šfo
,

283 .
	g·¿ms
 = 
¢d_¿wmidi_vœtu®_·¿ms
,

284 .
	g¡©us
 = 
¢d_¿wmidi_vœtu®_¡©us
,

285 .
	gdrİ
 = 
¢d_¿wmidi_vœtu®_drİ
,

286 .
	gd¿š
 = 
¢d_¿wmidi_vœtu®_d¿š
,

287 .
	gwr™e
 = 
¢d_¿wmidi_vœtu®_wr™e
,

288 .
	g»ad
 = 
¢d_¿wmidi_vœtu®_»ad
,

311 
	$¢d_¿wmidi_vœtu®_İ’
(
¢d_¿wmidi_t
 **
špu
, snd_¿wmidi_ˆ**
ouu
,

312 cÚ¡ *
Çme
, 
¢d_£q_t
 *
£q_hªdË
, 
pÜt
,

313 
m”ge
, 
mode
)

315 
”r
;

316 
¢d_¿wmidi_t
 *
rmidi
 = 
NULL
;

317 
¢d_¿wmidi_vœtu®_t
 *
vœt
 = 
NULL
;

318 
pŞlfd
 
pfd
;

320 ià(
špu
)

321 *
špu
 = 0;

322 ià(
ouu
)

323 *
ouu
 = 0;

325 
vœt
 = 
	`ÿÎoc
(1, (*virt));

326 ià(
vœt
 =ğ
NULL
) {

327 
”r
 = -
ENOMEM
;

328 
_”r
;

330 
vœt
->
hªdË
 = 
£q_hªdË
;

331 
vœt
->
pÜt
 =…ort;

332 
”r
 = 
	`¢d_midi_ev’t_Ãw
(256, &
vœt
->
midi_ev’t
);

333 ià(
”r
 < 0)

334 
_”r
;

335 
	`¢d_midi_ev’t_š™
(
vœt
->
midi_ev’t
);

336 
	`¢d_midi_ev’t_no_¡©us
(
vœt
->
midi_ev’t
, !
m”ge
);

338 ià(
špu
) {

339 
rmidi
 = 
	`ÿÎoc
(1, (*rmidi));

340 ià(
rmidi
 =ğ
NULL
) {

341 
”r
 = -
ENOMEM
;

342 
_”r
;

344 ià(
Çme
)

345 
rmidi
->
Çme
 = 
	`¡rdup
(name);

346 
rmidi
->
ty³
 = 
SND_RAWMIDI_TYPE_VIRTUAL
;

347 
rmidi
->
¡»am
 = 
SND_RAWMIDI_STREAM_INPUT
;

348 
rmidi
->
mode
 = mode;

349 
”r
 = 
	`¢d_£q_pŞl_desütÜs
(
£q_hªdË
, &
pfd
, 1, 
POLLIN
);

350 ià(
”r
 < 0)

351 
_”r
;

352 
rmidi
->
pŞl_fd
 = 
pfd
.
fd
;

353 
rmidi
->
İs
 = &
¢d_¿wmidi_vœtu®_İs
;

354 
rmidi
->
´iv©e_d©a
 = 
vœt
;

355 
vœt
->
İ’
++;

356 *
špu
 = 
rmidi
;

358 ià(
ouu
) {

359 
rmidi
 = 
	`ÿÎoc
(1, (*rmidi));

360 ià(
rmidi
 =ğ
NULL
) {

361 
”r
 = -
ENOMEM
;

362 
_”r
;

364 ià(
Çme
)

365 
rmidi
->
Çme
 = 
	`¡rdup
(name);

366 
rmidi
->
ty³
 = 
SND_RAWMIDI_TYPE_VIRTUAL
;

367 
rmidi
->
¡»am
 = 
SND_RAWMIDI_STREAM_OUTPUT
;

368 
rmidi
->
mode
 = mode;

369 
”r
 = 
	`¢d_£q_pŞl_desütÜs
(
£q_hªdË
, &
pfd
, 1, 
POLLOUT
);

370 ià(
”r
 < 0)

371 
_”r
;

372 
rmidi
->
pŞl_fd
 = 
pfd
.
fd
;

373 
rmidi
->
İs
 = &
¢d_¿wmidi_vœtu®_İs
;

374 
rmidi
->
´iv©e_d©a
 = 
vœt
;

375 
vœt
->
İ’
++;

376 *
ouu
 = 
rmidi
;

381 
_”r
:

382 ià(
£q_hªdË
)

383 
	`¢d_£q_şo£
(
£q_hªdË
);

384 ià(
vœt
) {

385 ià(
vœt
->
midi_ev’t
)

386 
	`¢d_midi_ev’t_ä“
(
vœt
->
midi_ev’t
);

387 
	`ä“
(
vœt
);

389 ià(
špu
)

390 
	`ä“
(*
špu
);

391 ià(
ouu
)

392 
	`ä“
(*
ouu
);

393 
	`ä“
(
rmidi
);

394  
”r
;

395 
	}
}

397 
	$_¢d_¿wmidi_vœtu®_İ’
(
¢d_¿wmidi_t
 **
špu
, snd_¿wmidi_ˆ**
ouu
,

398 *
Çme
, 
¢d_cÚfig_t
 *
roÙ
 
ATTRIBUTE_UNUSED
,

399 
¢d_cÚfig_t
 *
cÚf
, 
mode
)

401 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

402 cÚ¡ *
¦ave_¡r
 = 
NULL
;

403 
”r
;

404 
¡»ams
, 
£q_mode
;

405 
m”ge
 = 1;

406 
pÜt
;

407 
ÿps
;

408 
¢d_£q_t
 *
£q_hªdË
;

410 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

411 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

412 cÚ¡ *
id
;

413 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

415 ià(
	`¢d_¿wmidi_cÚf_g’”ic_id
(
id
))

417 ià(
	`¡rcmp
(
id
, "slave") == 0) {

418 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¦ave_¡r
);

419 ià(
”r
 < 0)

420  
”r
;

423 ià(
	`¡rcmp
(
id
, "merge") == 0) {

424 
m”ge
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

427  -
EINVAL
;

430 
¡»ams
 = 0;

431 ià(
špu
)

432 
¡»ams
 |ğ
SND_SEQ_OPEN_INPUT
;

433 ià(
ouu
)

434 
¡»ams
 |ğ
SND_SEQ_OPEN_OUTPUT
;

435 ià(! 
¡»ams
)

436  -
EINVAL
;

438 
£q_mode
 = 0;

439 ià(
mode
 & 
SND_RAWMIDI_NONBLOCK
)

440 
£q_mode
 |ğ
SND_SEQ_NONBLOCK
;

442 ià(! 
¦ave_¡r
)

443 
¦ave_¡r
 = "default";

444 
”r
 = 
	`_¢d_£q_İ’_lcÚf
(&
£q_hªdË
, 
¦ave_¡r
, 
¡»ams
, 
£q_mode
,

445 
roÙ
, 
cÚf
);

446 ià(
”r
 < 0)

447  
”r
;

449 
ÿps
 = 0;

450 ià(
špu
)

451 
ÿps
 |ğ
SND_SEQ_PORT_CAP_WRITE
 | 
SND_SEQ_PORT_CAP_SYNC_WRITE
 | 
SND_SEQ_PORT_CAP_SUBS_WRITE
;

452 ià(
ouu
)

453 
ÿps
 |ğ
SND_SEQ_PORT_CAP_READ
 | 
SND_SEQ_PORT_CAP_SYNC_READ
 | 
SND_SEQ_PORT_CAP_SUBS_READ
;

454 ià(
špu
 && 
ouu
)

455 
ÿps
 |ğ
SNDRV_SEQ_PORT_CAP_DUPLEX
;

457 
pÜt
 = 
	`¢d_£q_ü—‹_sim¶e_pÜt
(
£q_hªdË
, "Virtual RawMIDI",

458 
ÿps
, 
SNDRV_SEQ_PORT_TYPE_MIDI_GENERIC
);

459 ià(
pÜt
 < 0) {

460 
	`¢d_£q_şo£
(
£q_hªdË
);

461  
pÜt
;

464  
	`¢d_¿wmidi_vœtu®_İ’
(
špu
, 
ouu
, 
Çme
, 
£q_hªdË
, 
pÜt
,

465 
m”ge
, 
mode
);

466 
	}
}

468 #iâdeà
DOC_HIDDEN


469 
SND_DLSYM_BUILD_VERSION
(
_¢d_¿wmidi_vœtu®_İ’
, 
SND_RAWMIDI_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/ump.c

7 
	~"¿wmidi_loÿl.h
"

8 
	~"ump_loÿl.h
"

10 
	$g‘_¿wmidi_æags
(
¢d_ump_t
 *
ump
)

12 
¢d_¿wmidi_šfo_t
 
šfo
;

13 
”r
;

15 
”r
 = 
	`¢d_¿wmidi_šfo
(
ump
->
¿wmidi
, &
šfo
);

16 ià(
”r
 < 0)

17  
”r
;

18 ià(!(
šfo
.
æags
 & 
SNDRV_RAWMIDI_INFO_UMP
))

19  -
EINVAL
;

20 
ump
->
æags
 = 
šfo
.flags;

22 
	}
}

35 
	$¢d_ump_İ’
(
¢d_ump_t
 **
špu
, snd_ump_ˆ**
ouu
, cÚ¡ *
Çme
,

36 
mode
)

38 
¢d_ump_t
 *
šput
 = 
NULL
, *
ouut
 = NULL;

39 
”r
;

41 ià(
špu
)

42 *
špu
 = 
NULL
;

43 ià(
ouu
)

44 *
ouu
 = 
NULL
;

45 ià(!
špu
 && !
ouu
)

46  -
EINVAL
;

48 
”r
 = -
ENOMEM
;

49 ià(
špu
) {

50 
šput
 = 
	`ÿÎoc
(1, (*input));

51 ià(!
šput
)

52 
”rÜ
;

53 
šput
->
is_šput
 = 1;

55 ià(
ouu
) {

56 
ouut
 = 
	`ÿÎoc
(1, (*output));

57 ià(!
ouut
)

58 
”rÜ
;

61 
”r
 = 
	`¢d_¿wmidi_İ’
(
šput
 ? &šput->
¿wmidi
 : 
NULL
,

62 
ouut
 ? &ouut->
¿wmidi
 : 
NULL
,

63 
Çme
, 
mode
 | 
_SND_RAWMIDI_OPEN_UMP
);

64 ià(
”r
 < 0)

65 
”rÜ
;

67 ià(
šput
) {

68 
”r
 = 
	`g‘_¿wmidi_æags
(
šput
);

69 ià(
”r
 < 0)

70 
”rÜ
;

72 ià(
ouut
) {

73 
”r
 = 
	`g‘_¿wmidi_æags
(
ouut
);

74 ià(
”r
 < 0)

75 
”rÜ
;

78 ià(
špu
)

79 *
špu
 = 
šput
;

80 ià(
ouu
)

81 *
ouu
 = 
ouut
;

85 
”rÜ
:

86 ià(
šput
) {

87 ià(
šput
->
¿wmidi
)

88 
	`¢d_¿wmidi_şo£
(
šput
->
¿wmidi
);

89 
	`ä“
(
šput
);

91 ià(
ouut
) {

92 ià(
ouut
->
¿wmidi
)

93 
	`¢d_¿wmidi_şo£
(
ouut
->
¿wmidi
);

94 
	`ä“
(
ouut
);

96  
”r
;

97 
	}
}

107 
	$¢d_ump_şo£
(
¢d_ump_t
 *
ump
)

109 
”r
;

111 
”r
 = 
	`¢d_¿wmidi_şo£
(
ump
->
¿wmidi
);

112 
	`ä“
(
ump
);

113  
”r
;

114 
	}
}

123 
¢d_¿wmidi_t
 *
	$¢d_ump_¿wmidi
(
¢d_ump_t
 *
ump
)

125  
ump
->
¿wmidi
;

126 
	}
}

136 cÚ¡ *
	$¢d_ump_Çme
(
¢d_ump_t
 *
ump
)

138  
	`¢d_¿wmidi_Çme
(
ump
->
¿wmidi
);

139 
	}
}

146 
	$¢d_ump_pŞl_desütÜs_couÁ
(
¢d_ump_t
 *
ump
)

148  
	`¢d_¿wmidi_pŞl_desütÜs_couÁ
(
ump
->
¿wmidi
);

149 
	}
}

158 
	$¢d_ump_pŞl_desütÜs
(
¢d_ump_t
 *
ump
, 
pŞlfd
 *
pfds
,

159 
¥aû
)

161  
	`¢d_¿wmidi_pŞl_desütÜs
(
ump
->
¿wmidi
, 
pfds
, 
¥aû
);

162 
	}
}

172 
	$¢d_ump_pŞl_desütÜs_»v’ts
(
¢d_ump_t
 *
ump
, 
pŞlfd
 *
pfds
,

173 
nfds
, *
»v’ts
)

175  
	`¢d_¿wmidi_pŞl_desütÜs_»v’ts
(
ump
->
¿wmidi
, 
pfds
, 
nfds
,

176 
»v’ts
);

177 
	}
}

188 
	$¢d_ump_nÚblock
(
¢d_ump_t
 *
ump
, 
nÚblock
)

190  
	`¢d_¿wmidi_nÚblock
(
ump
->
¿wmidi
, 
nÚblock
);

191 
	}
}

199 
	$¢d_ump_¿wmidi_šfo
(
¢d_ump_t
 *
ump
, 
¢d_¿wmidi_šfo_t
 *
šfo
)

201  
	`¢d_¿wmidi_šfo
(
ump
->
¿wmidi
, 
šfo
);

202 
	}
}

210 
	$¢d_ump_¿wmidi_·¿ms
(
¢d_ump_t
 *
ump
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
)

212  
	`¢d_¿wmidi_·¿ms
(
ump
->
¿wmidi
, 
·¿ms
);

213 
	}
}

221 
	$¢d_ump_¿wmidi_·¿ms_cu¼’t
(
¢d_ump_t
 *
ump
, 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
)

223  
	`¢d_¿wmidi_·¿ms_cu¼’t
(
ump
->
¿wmidi
, 
·¿ms
);

224 
	}
}

232 
	$¢d_ump_¿wmidi_¡©us
(
¢d_ump_t
 *
ump
, 
¢d_¿wmidi_¡©us_t
 *
¡©us
)

234  
	`¢d_¿wmidi_¡©us
(
ump
->
¿wmidi
, 
¡©us
);

235 
	}
}

242 
	$¢d_ump_drİ
(
¢d_ump_t
 *
ump
)

244  
	`¢d_¿wmidi_drİ
(
ump
->
¿wmidi
);

245 
	}
}

255 
	$¢d_ump_d¿š
(
¢d_ump_t
 *
ump
)

257  
	`¢d_¿wmidi_d¿š
(
ump
->
¿wmidi
);

258 
	}
}

266 
ssize_t
 
	$¢d_ump_wr™e
(
¢d_ump_t
 *
ump
, cÚ¡ *
bufãr
, 
size_t
 
size
)

268 ià(
ump
->
is_šput
)

269  -
EINVAL
;

270  
	`¢d_¿wmidi_wr™e
(
ump
->
¿wmidi
, 
bufãr
, 
size
);

271 
	}
}

280 
ssize_t
 
	$¢d_ump_»ad
(
¢d_ump_t
 *
ump
, *
bufãr
, 
size_t
 
size
)

282 ià(!
ump
->
is_šput
)

283  -
EINVAL
;

284  
	`¢d_¿wmidi_»ad
(
ump
->
¿wmidi
, 
bufãr
, 
size
);

285 
	}
}

295 
ssize_t
 
	$¢d_ump_Œ—d
(
¢d_ump_t
 *
ump
, 
time¥ec
 *
t¡amp
, *
bufãr
,

296 
size_t
 
size
)

298 ià(!
ump
->
is_šput
)

299  -
EINVAL
;

300  
	`¢d_¿wmidi_Œ—d
(
ump
->
¿wmidi
, 
t¡amp
, 
bufãr
, 
size
);

301 
	}
}

307 
size_t
 
	$¢d_ump_’dpošt_šfo_sizeof
()

309  (
¢d_ump_’dpošt_šfo_t
);

310 
	}
}

320 
	$¢d_ump_’dpošt_šfo_m®loc
(
¢d_ump_’dpošt_šfo_t
 **
šfo
)

322 *
šfo
 = 
	`ÿÎoc
(1, (
¢d_ump_’dpošt_šfo_t
));

323 ià(!*
šfo
)

324  -
ENOMEM
;

326 
	}
}

335 
	$¢d_ump_’dpošt_šfo_ä“
(
¢d_ump_’dpošt_šfo_t
 *
šfo
)

337 
	`ä“
(
šfo
);

338 
	}
}

345 
	$¢d_ump_’dpošt_šfo_cİy
(
¢d_ump_’dpošt_šfo_t
 *
d¡
,

346 cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
¤c
)

348 *
d¡
 = *
¤c
;

349 
	}
}

356 
	$¢d_ump_’dpošt_šfo_g‘_ÿrd
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

358  
šfo
->
ÿrd
;

359 
	}
}

366 
	$¢d_ump_’dpošt_šfo_g‘_deviû
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

368  
šfo
->
deviû
;

369 
	}
}

376 
	$¢d_ump_’dpošt_šfo_g‘_æags
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

378  
šfo
->
æags
;

379 
	}
}

386 
	$¢d_ump_’dpošt_šfo_g‘_´ÙocŞ_ÿps
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

388  
šfo
->
´ÙocŞ_ÿps
;

389 
	}
}

396 
	$¢d_ump_’dpošt_šfo_g‘_´ÙocŞ
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

398  
šfo
->
´ÙocŞ
;

399 
	}
}

406 
	$¢d_ump_’dpošt_šfo_g‘_num_blocks
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

408  
šfo
->
num_blocks
;

409 
	}
}

416 
	$¢d_ump_’dpošt_šfo_g‘_v”siÚ
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

418  
šfo
->
v”siÚ
;

419 
	}
}

426 
	$¢d_ump_’dpošt_šfo_g‘_mªuçùu»r_id
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

428  
šfo
->
mªuçùu»r_id
;

429 
	}
}

436 
	$¢d_ump_’dpošt_šfo_g‘_çmy_id
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

438  
šfo
->
çmy_id
;

439 
	}
}

446 
	$¢d_ump_’dpošt_šfo_g‘_mod–_id
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

448  
šfo
->
mod–_id
;

449 
	}
}

456 cÚ¡ *
	$¢d_ump_’dpošt_šfo_g‘_sw_»visiÚ
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

458  
šfo
->
sw_»visiÚ
;

459 
	}
}

466 cÚ¡ *
	$¢d_ump_’dpošt_šfo_g‘_Çme
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

468  (cÚ¡ *)
šfo
->
Çme
;

469 
	}
}

476 cÚ¡ *
	$¢d_ump_’dpošt_šfo_g‘_´oduù_id
(cÚ¡ 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

478  (cÚ¡ *)
šfo
->
´oduù_id
;

479 
	}
}

487 
	$¢d_ump_’dpošt_šfo
(
¢d_ump_t
 *
ump
, 
¢d_ump_’dpošt_šfo_t
 *
šfo
)

489  
	`_¢d_¿wmidi_ump_’dpošt_šfo
(
ump
->
¿wmidi
, 
šfo
);

490 
	}
}

496 
size_t
 
	$¢d_ump_block_šfo_sizeof
()

498  (
¢d_ump_block_šfo_t
);

499 
	}
}

509 
	$¢d_ump_block_šfo_m®loc
(
¢d_ump_block_šfo_t
 **
šfo
)

511 *
šfo
 = 
	`ÿÎoc
(1, (
¢d_ump_block_šfo_t
));

512 ià(!*
šfo
)

513  -
ENOMEM
;

515 
	}
}

524 
	$¢d_ump_block_šfo_ä“
(
¢d_ump_block_šfo_t
 *
šfo
)

526 
	`ä“
(
šfo
);

527 
	}
}

534 
	$¢d_ump_block_šfo_cİy
(
¢d_ump_block_šfo_t
 *
d¡
,

535 cÚ¡ 
¢d_ump_block_šfo_t
 *
¤c
)

537 *
d¡
 = *
¤c
;

538 
	}
}

545 
	$¢d_ump_block_šfo_g‘_ÿrd
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
)

547  
šfo
->
ÿrd
;

548 
	}
}

555 
	$¢d_ump_block_šfo_g‘_deviû
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
)

557  
šfo
->
deviû
;

558 
	}
}

565 
	$¢d_ump_block_šfo_g‘_block_id
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
)

567  
šfo
->
block_id
;

568 
	}
}

575 
	$¢d_ump_block_šfo_£t_block_id
(
¢d_ump_block_šfo_t
 *
šfo
,

576 
id
)

578 
šfo
->
block_id
 = 
id
;

579 
	}
}

586 
	$¢d_ump_block_šfo_g‘_aùive
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
)

588  
šfo
->
aùive
;

589 
	}
}

596 
	$¢d_ump_block_šfo_g‘_æags
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
)

598  
šfo
->
æags
;

599 
	}
}

606 
	$¢d_ump_block_šfo_g‘_dœeùiÚ
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
)

608  
šfo
->
dœeùiÚ
;

609 
	}
}

616 
	$¢d_ump_block_šfo_g‘_fœ¡_group
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
)

618  
šfo
->
fœ¡_group
;

619 
	}
}

626 
	$¢d_ump_block_šfo_g‘_num_groups
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
)

628  
šfo
->
num_groups
;

629 
	}
}

636 
	$¢d_ump_block_šfo_g‘_midi_ci_v”siÚ
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
)

638  
šfo
->
midi_ci_v”siÚ
;

639 
	}
}

646 
	$¢d_ump_block_šfo_g‘_sy£x8_¡»ams
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
)

648  
šfo
->
sy£x8_¡»ams
;

649 
	}
}

656 
	$¢d_ump_block_šfo_g‘_ui_hšt
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
)

658  
šfo
->
ui_hšt
;

659 
	}
}

666 cÚ¡ *
	$¢d_ump_block_šfo_g‘_Çme
(cÚ¡ 
¢d_ump_block_šfo_t
 *
šfo
)

668  (cÚ¡ *)
šfo
->
Çme
;

669 
	}
}

680 
	$¢d_ump_block_šfo
(
¢d_ump_t
 *
ump
, 
¢d_ump_block_šfo_t
 *
šfo
)

682  
	`_¢d_¿wmidi_ump_block_šfo
(
ump
->
¿wmidi
, 
šfo
);

683 
	}
}

688 
	$ex·nd_sy£x_d©a
(cÚ¡ 
ušt32_t
 *
d©a
, 
ušt8_t
 *
buf
,

689 
size_t
 
maxËn
, 
by‹s
, 
off£t
)

691 
size
 = 0;

693 ; 
by‹s
; by‹s--, 
size
++) {

694 ià(!
maxËn
)

696 
buf
[
size
] = (*
d©a
 >> 
off£t
) & 0x7f;

697 ià(!
off£t
) {

698 
off£t
 = 24;

699 
d©a
++;

701 
off£t
 -= 8;

705  
size
;

706 
	}
}

708 
	$ex·nd_sy£x7
(cÚ¡ 
ušt32_t
 *
ump
, 
ušt8_t
 *
buf
, 
size_t
 
maxËn
,

709 
size_t
 *
fËd
)

711 
¡©us
;

712 
by‹s
;

714 *
fËd
 = 0;

715 ià(!
maxËn
)

718 
¡©us
 = 
	`¢d_ump_sy£x_msg_¡©us
(
ump
);

719 
by‹s
 = 
	`¢d_ump_sy£x_msg_Ëngth
(
ump
);

720 ià(
by‹s
 > 6)

723 *
fËd
 = 
	`ex·nd_sy£x_d©a
(
ump
, 
buf
, 
maxËn
, 
by‹s
, 8);

724  (
¡©us
 =ğ
SND_UMP_SYSEX_STATUS_SINGLE
 ||

725 
¡©us
 =ğ
SND_UMP_SYSEX_STATUS_END
);

726 
	}
}

728 
	$ex·nd_sy£x8
(cÚ¡ 
ušt32_t
 *
ump
, 
ušt8_t
 *
buf
, 
size_t
 
maxËn
,

729 
size_t
 *
fËd
)

731 
¡©us
;

732 
by‹s
;

734 *
fËd
 = 0;

735 ià(!
maxËn
)

738 
¡©us
 = 
	`¢d_ump_sy£x_msg_¡©us
(
ump
);

739 ià(
¡©us
 > 
SND_UMP_SYSEX_STATUS_END
)

741 
by‹s
 = 
	`¢d_ump_sy£x_msg_Ëngth
(
ump
);

742 ià(!
by‹s
 || bytes > 14)

745 *
fËd
 = 
	`ex·nd_sy£x_d©a
(
ump
, 
buf
, 
maxËn
, 
by‹s
 - 1, 0);

746  (
¡©us
 =ğ
SND_UMP_SYSEX_STATUS_SINGLE
 ||

747 
¡©us
 =ğ
SND_UMP_SYSEX_STATUS_END
);

748 
	}
}

758 
	$¢d_ump_msg_sy£x_ex·nd
(cÚ¡ 
ušt32_t
 *
ump
, 
ušt8_t
 *
buf
, 
size_t
 
maxËn
,

759 
size_t
 *
fËd
)

761 
	`¢d_ump_msg_ty³
(
ump
)) {

762 
SND_UMP_MSG_TYPE_DATA
:

763  
	`ex·nd_sy£x7
(
ump
, 
buf
, 
maxËn
, 
fËd
);

764 
SND_UMP_MSG_TYPE_EXTENDED_DATA
:

765  
	`ex·nd_sy£x8
(
ump
, 
buf
, 
maxËn
, 
fËd
);

767  -
EINVAL
;

769 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/ump_local.h

2 
	~"¿wmidi.h
"

3 
	~"ump.h
"

4 
	~"ump_msg.h
"

6 #iâdeà
DOC_HIDDEN


7 
	s_¢d_ump
 {

8 
¢d_¿wmidi_t
 *
	m¿wmidi
;

9 
	mæags
;

10 
	mis_šput
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq.c

780 
	~"£q_loÿl.h
"

781 
	~<pŞl.h
>

800 cÚ¡ *
	$¢d_£q_Çme
(
¢d_£q_t
 *
£q
)

802 
	`as£¹
(
£q
);

803  
£q
->
Çme
;

804 
	}
}

815 
¢d_£q_ty³_t
 
	$¢d_£q_ty³
(
¢d_£q_t
 *
£q
)

817 
	`as£¹
(
£q
);

818  
£q
->
ty³
;

819 
	}
}

821 
	$¢d_£q_İ’_cÚf
(
¢d_£q_t
 **
£qp
, cÚ¡ *
Çme
,

822 
¢d_cÚfig_t
 *
£q_roÙ
, snd_cÚfig_ˆ*
£q_cÚf
,

823 
¡»ams
, 
mode
)

825 cÚ¡ *
¡r
;

826 
buf
[256], 
”rbuf
[256];

827 
”r
;

828 
¢d_cÚfig_t
 *
cÚf
, *
ty³_cÚf
 = 
NULL
;

829 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

830 cÚ¡ *
id
;

831 cÚ¡ *
lib
 = 
NULL
, *
İ’_Çme
 = NULL;

832 (*
İ’_func
)(
¢d_£q_t
 **, const *,

833 
¢d_cÚfig_t
 *, snd_config_t *,

834 , èğ
NULL
;

835 #iâdeà
PIC


836 *
	`¢d_£q_İ’_symbŞs
();

838 *
h
 = 
NULL
;

839 ià(
	`¢d_cÚfig_g‘_ty³
(
£q_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

840 ià(
Çme
)

841 
	`SNDERR
("Inv®idy³ fÜ SEQ % defš™iÚ", 
Çme
);

843 
	`SNDERR
("Invalidype for SEQ definition");

844  -
EINVAL
;

846 
”r
 = 
	`¢d_cÚfig_£¬ch
(
£q_cÚf
, "ty³", &
cÚf
);

847 ià(
”r
 < 0) {

848 
	`SNDERR
("type is‚ot defined");

849  
”r
;

851 
”r
 = 
	`¢d_cÚfig_g‘_id
(
cÚf
, &
id
);

852 ià(
”r
 < 0) {

853 
	`SNDERR
("unableo get id");

854  
”r
;

856 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
cÚf
, &
¡r
);

857 ià(
”r
 < 0) {

858 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

859  
”r
;

861 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
£q_roÙ
, "£q_ty³", 
¡r
, &
ty³_cÚf
);

862 ià(
”r
 >= 0) {

863 ià(
	`¢d_cÚfig_g‘_ty³
(
ty³_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

864 
	`SNDERR
("Inv®idy³ fÜ SEQy³ % defš™iÚ", 
¡r
);

865 
_”r
;

867 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
ty³_cÚf
) {

868 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

869 cÚ¡ *
id
;

870 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

872 ià(
	`¡rcmp
(
id
, "comment") == 0)

874 ià(
	`¡rcmp
(
id
, "lib") == 0) {

875 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
lib
);

876 ià(
”r
 < 0) {

877 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

878 
_”r
;

882 ià(
	`¡rcmp
(
id
, "open") == 0) {

883 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
İ’_Çme
);

884 ià(
”r
 < 0) {

885 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

886 
_”r
;

890 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

891 
”r
 = -
EINVAL
;

892 
_”r
;

895 ià(!
İ’_Çme
) {

896 
İ’_Çme
 = 
buf
;

897 
	`¢´štf
(
buf
, (buf), "_¢d_£q_%s_İ’", 
¡r
);

899 #iâdeà
PIC


900 
	`¢d_£q_İ’_symbŞs
();

902 
h
 = 
	`INTERNAL
(
¢d_dlİ’
)(
lib
, 
RTLD_NOW
, 
”rbuf
, (errbuf));

903 ià(
h
)

904 
İ’_func
 = 
	`¢d_dlsym
(
h
, 
İ’_Çme
, 
	`SND_DLSYM_VERSION
(
SND_SEQ_DLSYM_VERSION
));

905 
”r
 = 0;

906 ià(!
h
) {

907 
	`SNDERR
("CªnÙ o³Àsh¬ed†ib¿ry % (%s)", 
lib
, 
”rbuf
);

908 
”r
 = -
ENOENT
;

909 } ià(!
İ’_func
) {

910 
	`SNDERR
("symbŞ % i nÙ defšed insid%s", 
İ’_Çme
, 
lib
);

911 
	`¢d_dlşo£
(
h
);

912 
”r
 = -
ENXIO
;

914 
_”r
:

915 ià(
ty³_cÚf
)

916 
	`¢d_cÚfig_d–‘e
(
ty³_cÚf
);

917 ià(! 
”r
) {

918 
”r
 = 
	`İ’_func
(
£qp
, 
Çme
, 
£q_roÙ
, 
£q_cÚf
, 
¡»ams
, 
mode
);

919 ià(
”r
 < 0)

920 
	`¢d_dlşo£
(
h
);

922 (*
£qp
)->
dl_hªdË
 = 
h
;

924  
”r
;

925 
	}
}

927 
	$¢d_£q_İ’_noupd©e
(
¢d_£q_t
 **
£qp
, 
¢d_cÚfig_t
 *
roÙ
,

928 cÚ¡ *
Çme
, 
¡»ams
, 
mode
,

929 
hİ
)

931 
”r
;

932 
¢d_cÚfig_t
 *
£q_cÚf
;

933 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "£q", 
Çme
, &
£q_cÚf
);

934 ià(
”r
 < 0) {

935 
	`SNDERR
("UnknowÀSEQ %s", 
Çme
);

936  
”r
;

938 
	`¢d_cÚfig_£t_hİ
(
£q_cÚf
, 
hİ
);

939 
”r
 = 
	`¢d_£q_İ’_cÚf
(
£qp
, 
Çme
, 
roÙ
, 
£q_cÚf
, 
¡»ams
, 
mode
);

940 
	`¢d_cÚfig_d–‘e
(
£q_cÚf
);

941  
”r
;

942 
	}
}

974 
	$¢d_£q_İ’
(
¢d_£q_t
 **
£qp
, cÚ¡ *
Çme
,

975 
¡»ams
, 
mode
)

977 
¢d_cÚfig_t
 *
tİ
;

978 
”r
;

980 
	`as£¹
(
£qp
 && 
Çme
);

981 ià(
	`_¢d_is_ucm_deviû
(
Çme
)) {

982 
Çme
 = 
	`uc_mgr_®ibcfg_by_deviû
(&
tİ
,‚ame);

983 ià(
Çme
 =ğ
NULL
)

984  -
ENODEV
;

986 
”r
 = 
	`¢d_cÚfig_upd©e_»f
(&
tİ
);

987 ià(
”r
 < 0)

988  
”r
;

990 
”r
 = 
	`¢d_£q_İ’_noupd©e
(
£qp
, 
tİ
, 
Çme
, 
¡»ams
, 
mode
, 0);

991 
	`¢d_cÚfig_uÄef
(
tİ
);

992  
”r
;

993 
	}
}

1010 
	$¢d_£q_İ’_lcÚf
(
¢d_£q_t
 **
£qp
, cÚ¡ *
Çme
,

1011 
¡»ams
, 
mode
, 
¢d_cÚfig_t
 *
lcÚf
)

1013 
	`as£¹
(
£qp
 && 
Çme
 && 
lcÚf
);

1014  
	`¢d_£q_İ’_noupd©e
(
£qp
, 
lcÚf
, 
Çme
, 
¡»ams
, 
mode
, 0);

1015 
	}
}

1017 #iâdeà
DOC_HIDDEN


1018 
	$_¢d_£q_İ’_lcÚf
(
¢d_£q_t
 **
£qp
, cÚ¡ *
Çme
,

1019 
¡»ams
, 
mode
, 
¢d_cÚfig_t
 *
lcÚf
,

1020 
¢d_cÚfig_t
 *
·»Á_cÚf
)

1022 
hİ
;

1023 
	`as£¹
(
£qp
 && 
Çme
 && 
lcÚf
);

1024 ià((
hİ
 = 
	`¢d_cÚfig_check_hİ
(
·»Á_cÚf
)) < 0)

1025  
hİ
;

1026  
	`¢d_£q_İ’_noupd©e
(
£qp
, 
lcÚf
, 
Çme
, 
¡»ams
, 
mode
, 
hİ
 + 1);

1027 
	}
}

1043 
	$¢d_£q_şo£
(
¢d_£q_t
 *
£q
)

1045 
”r
;

1046 
	`as£¹
(
£q
);

1047 
”r
 = 
£q
->
İs
->
	`şo£
(seq);

1048 ià(
£q
->
dl_hªdË
)

1049 
	`¢d_dlşo£
(
£q
->
dl_hªdË
);

1050 
	`ä“
(
£q
->
obuf
);

1051 
	`ä“
(
£q
->
ibuf
);

1052 
	`ä“
(
£q
->
tmpbuf
);

1053 
	`ä“
(
£q
->
Çme
);

1054 
	`ä“
(
£q
);

1055  
”r
;

1056 
	}
}

1070 
	$¢d_£q_pŞl_desütÜs_couÁ
(
¢d_£q_t
 *
£q
, 
ev’ts
)

1072 
»suÉ
 = 0;

1073 
	`as£¹
(
£q
);

1074 ià(
ev’ts
 & 
POLLIN
) {

1075 
	`as£¹
(
£q
->
¡»ams
 & 
SND_SEQ_OPEN_INPUT
);

1076 
»suÉ
++;

1078 ià(
ev’ts
 & 
POLLOUT
) {

1079 
	`as£¹
(
£q
->
¡»ams
 & 
SND_SEQ_OPEN_OUTPUT
);

1080 
»suÉ
++;

1082  
»suÉ
 ? 1 : 0;

1083 
	}
}

1103 
	$¢d_£q_pŞl_desütÜs
(
¢d_£q_t
 *
£q
, 
pŞlfd
 *
pfds
, 
¥aû
, 
ev’ts
)

1105 
»v’ts
 = 0;

1107 
	`as£¹
(
£q
);

1108 ià((
ev’ts
 & 
POLLIN
è&& 
¥aû
 >= 1) {

1109 
	`as£¹
(
£q
->
¡»ams
 & 
SND_SEQ_OPEN_INPUT
);

1110 
»v’ts
 |ğ
POLLIN
|
POLLERR
|
POLLNVAL
;

1112 ià((
ev’ts
 & 
POLLOUT
è&& 
¥aû
 >= 1) {

1113 
	`as£¹
(
£q
->
¡»ams
 & 
SND_SEQ_OPEN_OUTPUT
);

1114 
»v’ts
 |ğ
POLLOUT
|
POLLERR
|
POLLNVAL
;

1116 ià(!
»v’ts
)

1118 
pfds
->
fd
 = 
£q
->
pŞl_fd
;

1119 
pfds
->
ev’ts
 = 
»v’ts
;

1121 
	}
}

1133 
	$¢d_£q_pŞl_desütÜs_»v’ts
(
¢d_£q_t
 *
£q
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

1135 
	`as£¹
(
£q
 && 
pfds
 && 
»v’ts
);

1136 ià(
nfds
 == 1) {

1137 *
»v’ts
 = 
pfds
->revents;

1140  -
EINVAL
;

1141 
	}
}

1156 
	$¢d_£q_nÚblock
(
¢d_£q_t
 *
£q
, 
nÚblock
)

1158 
”r
;

1159 
	`as£¹
(
£q
);

1160 
”r
 = 
£q
->
İs
->
	`nÚblock
(£q, 
nÚblock
);

1161 ià(
”r
 < 0)

1162  
”r
;

1163 ià(
nÚblock
)

1164 
£q
->
mode
 |ğ
SND_SEQ_NONBLOCK
;

1166 
£q
->
mode
 &ğ~
SND_SEQ_NONBLOCK
;

1168 
	}
}

1182 
	$¢d_£q_ş›Á_id
(
¢d_£q_t
 *
£q
)

1184 
	`as£¹
(
£q
);

1185  
£q
->
ş›Á
;

1186 
	}
}

1199 
size_t
 
	$¢d_£q_g‘_ouut_bufãr_size
(
¢d_£q_t
 *
£q
)

1201 
	`as£¹
(
£q
);

1202 ià(!
£q
->
obuf
)

1204  
£q
->
obufsize
;

1205 
	}
}

1207 
šlše
 
size_t
 
	$g‘_·ck‘_size
(
¢d_£q_t
 *
£q
)

1209  
£q
->
·ck‘_size
 ? seq->·ck‘_siz: (
¢d_£q_ev’t_t
);

1210 
	}
}

1222 
size_t
 
	$¢d_£q_g‘_šput_bufãr_size
(
¢d_£q_t
 *
£q
)

1224 
	`as£¹
(
£q
);

1225 ià(!
£q
->
ibuf
)

1227  
£q
->
ibufsize
 * 
	`g‘_·ck‘_size
(seq);

1228 
	}
}

1240 
	$¢d_£q_£t_ouut_bufãr_size
(
¢d_£q_t
 *
£q
, 
size_t
 
size
)

1242 
	`as£¹
(
£q
 && seq->
obuf
);

1243 
	`as£¹
(
size
 >ğ(
¢d_£q_ev’t_t
));

1244 
	`¢d_£q_drİ_ouut
(
£q
);

1245 ià(
size
 !ğ
£q
->
obufsize
) {

1246 *
Ãwbuf
;

1247 
Ãwbuf
 = 
	`ÿÎoc
(1, 
size
);

1248 ià(
Ãwbuf
 =ğ
NULL
)

1249  -
ENOMEM
;

1250 
	`ä“
(
£q
->
obuf
);

1251 
£q
->
obuf
 = 
Ãwbuf
;

1252 
£q
->
obufsize
 = 
size
;

1255 
	}
}

1267 
	$¢d_£q_£t_šput_bufãr_size
(
¢d_£q_t
 *
£q
, 
size_t
 
size
)

1269 
size_t
 
·ck‘_size
;

1271 
	`as£¹
(
£q
 && seq->
ibuf
);

1272 
·ck‘_size
 = 
	`g‘_·ck‘_size
(
£q
);

1273 
	`as£¹
(
size
 >ğ
·ck‘_size
);

1274 
	`¢d_£q_drİ_šput
(
£q
);

1275 
size
 = (siz+ 
·ck‘_size
 - 1) /…acket_size;

1276 ià(
size
 !ğ
£q
->
ibufsize
) {

1277 *
Ãwbuf
;

1279 
Ãwbuf
 = 
	`ÿÎoc
((
¢d_£q_ump_ev’t_t
), 
size
);

1280 ià(
Ãwbuf
 =ğ
NULL
)

1281  -
ENOMEM
;

1282 
	`ä“
(
£q
->
ibuf
);

1283 
£q
->
ibuf
 = 
Ãwbuf
;

1284 
£q
->
ibufsize
 = 
size
;

1287 
	}
}

1294 
size_t
 
	$¢d_£q_sy¡em_šfo_sizeof
()

1296  (
¢d_£q_sy¡em_šfo_t
);

1297 
	}
}

1304 
	$¢d_£q_sy¡em_šfo_m®loc
(
¢d_£q_sy¡em_šfo_t
 **
±r
)

1306 
	`as£¹
(
±r
);

1307 *
±r
 = 
	`ÿÎoc
(1, (
¢d_£q_sy¡em_šfo_t
));

1308 ià(!*
±r
)

1309  -
ENOMEM
;

1311 
	}
}

1317 
	$¢d_£q_sy¡em_šfo_ä“
(
¢d_£q_sy¡em_šfo_t
 *
obj
)

1319 
	`ä“
(
obj
);

1320 
	}
}

1327 
	$¢d_£q_sy¡em_šfo_cİy
(
¢d_£q_sy¡em_šfo_t
 *
d¡
, cÚ¡ snd_£q_sy¡em_šfo_ˆ*
¤c
)

1329 
	`as£¹
(
d¡
 && 
¤c
);

1330 *
d¡
 = *
¤c
;

1331 
	}
}

1341 
	$¢d_£q_sy¡em_šfo_g‘_queues
(cÚ¡ 
¢d_£q_sy¡em_šfo_t
 *
šfo
)

1343 
	`as£¹
(
šfo
);

1344  
šfo
->
queues
;

1345 
	}
}

1354 
	$¢d_£q_sy¡em_šfo_g‘_ş›Ás
(cÚ¡ 
¢d_£q_sy¡em_šfo_t
 *
šfo
)

1356 
	`as£¹
(
šfo
);

1357  
šfo
->
ş›Ás
;

1358 
	}
}

1367 
	$¢d_£q_sy¡em_šfo_g‘_pÜts
(cÚ¡ 
¢d_£q_sy¡em_šfo_t
 *
šfo
)

1369 
	`as£¹
(
šfo
);

1370  
šfo
->
pÜts
;

1371 
	}
}

1380 
	$¢d_£q_sy¡em_šfo_g‘_chªÃls
(cÚ¡ 
¢d_£q_sy¡em_šfo_t
 *
šfo
)

1382 
	`as£¹
(
šfo
);

1383  
šfo
->
chªÃls
;

1384 
	}
}

1393 
	$¢d_£q_sy¡em_šfo_g‘_cur_ş›Ás
(cÚ¡ 
¢d_£q_sy¡em_šfo_t
 *
šfo
)

1395 
	`as£¹
(
šfo
);

1396  
šfo
->
cur_ş›Ás
;

1397 
	}
}

1406 
	$¢d_£q_sy¡em_šfo_g‘_cur_queues
(cÚ¡ 
¢d_£q_sy¡em_šfo_t
 *
šfo
)

1408 
	`as£¹
(
šfo
);

1409  
šfo
->
cur_queues
;

1410 
	}
}

1422 
	$¢d_£q_sy¡em_šfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_sy¡em_šfo_t
 * 
šfo
)

1424 
	`as£¹
(
£q
 && 
šfo
);

1425  
£q
->
İs
->
	`sy¡em_šfo
(£q, 
šfo
);

1426 
	}
}

1435 
size_t
 
	$¢d_£q_ş›Á_šfo_sizeof
()

1437  (
¢d_£q_ş›Á_šfo_t
);

1438 
	}
}

1445 
	$¢d_£q_ş›Á_šfo_m®loc
(
¢d_£q_ş›Á_šfo_t
 **
±r
)

1447 
	`as£¹
(
±r
);

1448 *
±r
 = 
	`ÿÎoc
(1, (
¢d_£q_ş›Á_šfo_t
));

1449 ià(!*
±r
)

1450  -
ENOMEM
;

1452 
	}
}

1458 
	$¢d_£q_ş›Á_šfo_ä“
(
¢d_£q_ş›Á_šfo_t
 *
obj
)

1460 
	`ä“
(
obj
);

1461 
	}
}

1468 
	$¢d_£q_ş›Á_šfo_cİy
(
¢d_£q_ş›Á_šfo_t
 *
d¡
, cÚ¡ snd_£q_ş›Á_šfo_ˆ*
¤c
)

1470 
	`as£¹
(
d¡
 && 
¤c
);

1471 *
d¡
 = *
¤c
;

1472 
	}
}

1482 
	$¢d_£q_ş›Á_šfo_g‘_ş›Á
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1484 
	`as£¹
(
šfo
);

1485  
šfo
->
ş›Á
;

1486 
	}
}

1498 
¢d_£q_ş›Á_ty³_t
 
	$¢d_£q_ş›Á_šfo_g‘_ty³
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1500 
	`as£¹
(
šfo
);

1501  
šfo
->
ty³
;

1502 
	}
}

1511 cÚ¡ *
	$¢d_£q_ş›Á_šfo_g‘_Çme
(
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1513 
	`as£¹
(
šfo
);

1514  
šfo
->
Çme
;

1515 
	}
}

1524 
	$¢d_£q_ş›Á_šfo_g‘_brßdÿ¡_f‹r
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1526 
	`as£¹
(
šfo
);

1527  (
šfo
->
f‹r
 & 
SNDRV_SEQ_FILTER_BROADCAST
) ? 1 : 0;

1528 
	}
}

1537 
	$¢d_£q_ş›Á_šfo_g‘_”rÜ_bounû
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1539 
	`as£¹
(
šfo
);

1540  (
šfo
->
f‹r
 & 
SNDRV_SEQ_FILTER_BOUNCE
) ? 1 : 0;

1541 
	}
}

1568 
	$¢d_£q_ş›Á_šfo_g‘_ÿrd
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1570 
	`as£¹
(
šfo
);

1571  
šfo
->
ÿrd
;

1572 
	}
}

1603 
	$¢d_£q_ş›Á_šfo_g‘_pid
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1605 
	`as£¹
(
šfo
);

1606  
šfo
->
pid
;

1607 
	}
}

1622 cÚ¡ *
	$¢d_£q_ş›Á_šfo_g‘_ev’t_f‹r
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1624 
	`as£¹
(
šfo
);

1625 ià(
šfo
->
f‹r
 & 
SNDRV_SEQ_FILTER_USE_EVENT
)

1626  
šfo
->
ev’t_f‹r
;

1628  
NULL
;

1629 
	}
}

1644 
	$¢d_£q_ş›Á_šfo_ev’t_f‹r_ş—r
(
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1646 
	`as£¹
(
šfo
);

1647 
šfo
->
f‹r
 &ğ~
SNDRV_SEQ_FILTER_USE_EVENT
;

1648 
	`mem£t
(
šfo
->
ev’t_f‹r
, 0, (info->event_filter));

1649 
	}
}

1665 
	$¢d_£q_ş›Á_šfo_ev’t_f‹r_add
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, 
ev’t_ty³
)

1667 
	`as£¹
(
šfo
);

1668 
šfo
->
f‹r
 |ğ
SNDRV_SEQ_FILTER_USE_EVENT
;

1669 
	`¢d_£q_£t_b™
(
ev’t_ty³
, 
šfo
->
ev’t_f‹r
);

1670 
	}
}

1686 
	$¢d_£q_ş›Á_šfo_ev’t_f‹r_d–
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, 
ev’t_ty³
)

1688 
	`as£¹
(
šfo
);

1689 
	`¢d_£q_un£t_b™
(
ev’t_ty³
, 
šfo
->
ev’t_f‹r
);

1690 
	}
}

1706 
	$¢d_£q_ş›Á_šfo_ev’t_f‹r_check
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, 
ev’t_ty³
)

1708 
	`as£¹
(
šfo
);

1709  
	`¢d_£q_g‘_b™
(
ev’t_ty³
, 
šfo
->
ev’t_f‹r
);

1710 
	}
}

1719 
	$¢d_£q_ş›Á_šfo_g‘_num_pÜts
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1721 
	`as£¹
(
šfo
);

1722  
šfo
->
num_pÜts
;

1723 
	}
}

1732 
	$¢d_£q_ş›Á_šfo_g‘_ev’t_lo¡
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1734 
	`as£¹
(
šfo
);

1735  
šfo
->
ev’t_lo¡
;

1736 
	}
}

1745 
	$¢d_£q_ş›Á_šfo_g‘_midi_v”siÚ
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1747 
	`as£¹
(
šfo
);

1748  
šfo
->
midi_v”siÚ
;

1749 
	}
}

1759 
	$¢d_£q_ş›Á_šfo_g‘_ump_group_’abËd
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
,

1760 
group
)

1762 
	`as£¹
(
šfo
);

1763  !(
šfo
->
group_f‹r
 & (1U << 
group
));

1764 
	}
}

1766 #iâdeà
DOC_HIDDEN


1767 
	#UMP_GROUPLESS_FILTER
 (1U << 0)

	)

1777 
	$¢d_£q_ş›Á_šfo_g‘_ump_grou¶ess_’abËd
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1779 
	`as£¹
(
šfo
);

1780  !(
šfo
->
group_f‹r
 & 
UMP_GROUPLESS_FILTER
);

1781 
	}
}

1790 
	$¢d_£q_ş›Á_šfo_g‘_ump_cÚv”siÚ
(cÚ¡ 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1792 
	`as£¹
(
šfo
);

1793  
šfo
->
midi_v”siÚ
;

1794 
	}
}

1803 
	$¢d_£q_ş›Á_šfo_£t_ş›Á
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, 
ş›Á
)

1805 
	`as£¹
(
šfo
);

1806 
šfo
->
ş›Á
 = client;

1807 
	}
}

1817 
	$¢d_£q_ş›Á_šfo_£t_Çme
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, cÚ¡ *
Çme
)

1819 
	`as£¹
(
šfo
 && 
Çme
);

1820 
	`¢d_¡¾ıy
(
šfo
->
Çme
,‚ame, (info->name));

1821 
	}
}

1830 
	$¢d_£q_ş›Á_šfo_£t_brßdÿ¡_f‹r
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, 
v®
)

1832 
	`as£¹
(
šfo
);

1833 ià(
v®
)

1834 
šfo
->
f‹r
 |ğ
SNDRV_SEQ_FILTER_BROADCAST
;

1836 
šfo
->
f‹r
 &ğ~
SNDRV_SEQ_FILTER_BROADCAST
;

1837 
	}
}

1846 
	$¢d_£q_ş›Á_šfo_£t_midi_v”siÚ
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, 
midi_v”siÚ
)

1848 
	`as£¹
(
šfo
);

1849 
šfo
->
midi_v”siÚ
 = midi_version;

1850 
	}
}

1860 
	$¢d_£q_ş›Á_šfo_£t_ump_group_’abËd
(
¢d_£q_ş›Á_šfo_t
 *
šfo
,

1861 
group
, 
’abË
)

1863 
	`as£¹
(
šfo
);

1864 ià(
’abË
)

1865 
šfo
->
group_f‹r
 &ğ~(1U << 
group
);

1867 
šfo
->
group_f‹r
 |ğ(1U << 
group
);

1868 
	}
}

1877 
	$¢d_£q_ş›Á_šfo_£t_ump_grou¶ess_’abËd
(
¢d_£q_ş›Á_šfo_t
 *
šfo
,

1878 
’abË
)

1880 
	`as£¹
(
šfo
);

1881 ià(
’abË
)

1882 
šfo
->
group_f‹r
 &ğ~
UMP_GROUPLESS_FILTER
;

1884 
šfo
->
group_f‹r
 |ğ
UMP_GROUPLESS_FILTER
;

1885 
	}
}

1894 
	$¢d_£q_ş›Á_šfo_£t_ump_cÚv”siÚ
(
¢d_£q_ş›Á_šfo_t
 *
šfo
,

1895 
’abË
)

1897 
	`as£¹
(
šfo
);

1898 ià(
’abË
)

1899 
šfo
->
f‹r
 &ğ~
SNDRV_SEQ_FILTER_NO_CONVERT
;

1901 
šfo
->
f‹r
 |ğ
SNDRV_SEQ_FILTER_NO_CONVERT
;

1902 
	}
}

1911 
	$¢d_£q_ş›Á_šfo_£t_”rÜ_bounû
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, 
v®
)

1913 
	`as£¹
(
šfo
);

1914 ià(
v®
)

1915 
šfo
->
f‹r
 |ğ
SNDRV_SEQ_FILTER_BOUNCE
;

1917 
šfo
->
f‹r
 &ğ~
SNDRV_SEQ_FILTER_BOUNCE
;

1918 
	}
}

1933 
	$¢d_£q_ş›Á_šfo_£t_ev’t_f‹r
(
¢d_£q_ş›Á_šfo_t
 *
šfo
, *
f‹r
)

1935 
	`as£¹
(
šfo
);

1936 ià(! 
f‹r
)

1937 
šfo
->
f‹r
 &ğ~
SNDRV_SEQ_FILTER_USE_EVENT
;

1939 
šfo
->
f‹r
 |ğ
SNDRV_SEQ_FILTER_USE_EVENT
;

1940 
	`memıy
(
šfo
->
ev’t_f‹r
, 
f‹r
, (info->event_filter));

1942 
	}
}

1958 
	$¢d_£q_g‘_ªy_ş›Á_šfo
(
¢d_£q_t
 *
£q
, 
ş›Á
, 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1960 
	`as£¹
(
£q
 && 
šfo
 && 
ş›Á
 >= 0);

1961 
	`mem£t
(
šfo
, 0, (
¢d_£q_ş›Á_šfo_t
));

1962 
šfo
->
ş›Á
 = client;

1963  
£q
->
İs
->
	`g‘_ş›Á_šfo
(£q, 
šfo
);

1964 
	}
}

1978 
	$¢d_£q_g‘_ş›Á_šfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1980  
	`¢d_£q_g‘_ªy_ş›Á_šfo
(
£q
, seq->
ş›Á
, 
šfo
);

1981 
	}
}

1994 
	$¢d_£q_£t_ş›Á_šfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

1996 
	`as£¹
(
£q
 && 
šfo
);

1997 
šfo
->
ş›Á
 = 
£q
->client;

1998 
šfo
->
ty³
 = 
USER_CLIENT
;

1999  
£q
->
İs
->
	`£t_ş›Á_šfo
(£q, 
šfo
);

2000 
	}
}

2016 
	$¢d_£q_qu”y_Ãxt_ş›Á
(
¢d_£q_t
 *
£q
, 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

2018 
	`as£¹
(
£q
 && 
šfo
);

2019  
£q
->
İs
->
	`qu”y_Ãxt_ş›Á
(£q, 
šfo
);

2020 
	}
}

2029 
	$¢d_£q_g‘_ump_’dpošt_šfo
(
¢d_£q_t
 *
£q
, 
ş›Á
, *
šfo
)

2031 
	`as£¹
(
£q
 && 
šfo
);

2032  
£q
->
İs
->
	`g‘_ump_šfo
(£q, 
ş›Á
,

2033 
SNDRV_SEQ_CLIENT_UMP_INFO_ENDPOINT
,

2034 
šfo
);

2035 
	}
}

2045 
	$¢d_£q_g‘_ump_block_šfo
(
¢d_£q_t
 *
£q
, 
ş›Á
, 
blk
, *
šfo
)

2047 
	`as£¹
(
£q
 && 
šfo
);

2048  
£q
->
İs
->
	`g‘_ump_šfo
(£q, 
ş›Á
,

2049 
SNDRV_SEQ_CLIENT_UMP_INFO_BLOCK
 + 
blk
,

2050 
šfo
);

2051 
	}
}

2059 
	$¢d_£q_£t_ump_’dpošt_šfo
(
¢d_£q_t
 *
£q
, cÚ¡ *
šfo
)

2061 
	`as£¹
(
£q
 && 
šfo
);

2062  
£q
->
İs
->
	`£t_ump_šfo
(seq,

2063 
SNDRV_SEQ_CLIENT_UMP_INFO_ENDPOINT
,

2064 
šfo
);

2065 
	}
}

2074 
	$¢d_£q_£t_ump_block_šfo
(
¢d_£q_t
 *
£q
, 
blk
, cÚ¡ *
šfo
)

2076 
	`as£¹
(
£q
 && 
šfo
);

2077  
£q
->
İs
->
	`£t_ump_šfo
(seq,

2078 
SNDRV_SEQ_CLIENT_UMP_INFO_BLOCK
 + 
blk
,

2079 
šfo
);

2080 
	}
}

2093 
size_t
 
	$¢d_£q_pÜt_šfo_sizeof
()

2095  (
¢d_£q_pÜt_šfo_t
);

2096 
	}
}

2103 
	$¢d_£q_pÜt_šfo_m®loc
(
¢d_£q_pÜt_šfo_t
 **
±r
)

2105 
	`as£¹
(
±r
);

2106 *
±r
 = 
	`ÿÎoc
(1, (
¢d_£q_pÜt_šfo_t
));

2107 ià(!*
±r
)

2108  -
ENOMEM
;

2110 
	}
}

2116 
	$¢d_£q_pÜt_šfo_ä“
(
¢d_£q_pÜt_šfo_t
 *
obj
)

2118 
	`ä“
(
obj
);

2119 
	}
}

2126 
	$¢d_£q_pÜt_šfo_cİy
(
¢d_£q_pÜt_šfo_t
 *
d¡
, cÚ¡ snd_£q_pÜt_šfo_ˆ*
¤c
)

2128 
	`as£¹
(
d¡
 && 
¤c
);

2129 *
d¡
 = *
¤c
;

2130 
	}
}

2140 
	$¢d_£q_pÜt_šfo_g‘_ş›Á
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2142 
	`as£¹
(
šfo
);

2143  
šfo
->
addr
.
ş›Á
;

2144 
	}
}

2153 
	$¢d_£q_pÜt_šfo_g‘_pÜt
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2155 
	`as£¹
(
šfo
);

2156  
šfo
->
addr
.
pÜt
;

2157 
	}
}

2166 cÚ¡ 
¢d_£q_addr_t
 *
	$¢d_£q_pÜt_šfo_g‘_addr
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2168 
	`as£¹
(
šfo
);

2169  (cÚ¡ 
¢d_£q_addr_t
 *è&
šfo
->
addr
;

2170 
	}
}

2179 cÚ¡ *
	$¢d_£q_pÜt_šfo_g‘_Çme
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2181 
	`as£¹
(
šfo
);

2182  
šfo
->
Çme
;

2183 
	}
}

2192 
	$¢d_£q_pÜt_šfo_g‘_ÿ·b™y
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2194 
	`as£¹
(
šfo
);

2195  
šfo
->
ÿ·b™y
;

2196 
	}
}

2205 
	$¢d_£q_pÜt_šfo_g‘_ty³
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2207 
	`as£¹
(
šfo
);

2208  
šfo
->
ty³
;

2209 
	}
}

2218 
	$¢d_£q_pÜt_šfo_g‘_»ad_u£
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2220 
	`as£¹
(
šfo
);

2221  
šfo
->
»ad_u£
;

2222 
	}
}

2231 
	$¢d_£q_pÜt_šfo_g‘_wr™e_u£
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2233 
	`as£¹
(
šfo
);

2234  
šfo
->
wr™e_u£
;

2235 
	}
}

2244 
	$¢d_£q_pÜt_šfo_g‘_midi_chªÃls
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2246 
	`as£¹
(
šfo
);

2247  
šfo
->
midi_chªÃls
;

2248 
	}
}

2257 
	$¢d_£q_pÜt_šfo_g‘_midi_voiûs
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2259 
	`as£¹
(
šfo
);

2260  
šfo
->
midi_voiûs
;

2261 
	}
}

2270 
	$¢d_£q_pÜt_šfo_g‘_syÁh_voiûs
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2272 
	`as£¹
(
šfo
);

2273  
šfo
->
syÁh_voiûs
;

2274 
	}
}

2283 
	$¢d_£q_pÜt_šfo_g‘_pÜt_¥ecif›d
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2285 
	`as£¹
(
šfo
);

2286  (
šfo
->
æags
 & 
SNDRV_SEQ_PORT_FLG_GIVEN_PORT
) ? 1 : 0;

2287 
	}
}

2296 
	$¢d_£q_pÜt_šfo_g‘_time¡ampšg
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2298 
	`as£¹
(
šfo
);

2299  (
šfo
->
æags
 & 
SNDRV_SEQ_PORT_FLG_TIMESTAMP
) ? 1 : 0;

2300 
	}
}

2309 
	$¢d_£q_pÜt_šfo_g‘_time¡amp_»®
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2311 
	`as£¹
(
šfo
);

2312  (
šfo
->
æags
 & 
SNDRV_SEQ_PORT_FLG_TIME_REAL
) ? 1 : 0;

2313 
	}
}

2322 
	$¢d_£q_pÜt_šfo_g‘_time¡amp_queue
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2324 
	`as£¹
(
šfo
);

2325  
šfo
->
time_queue
;

2326 
	}
}

2335 
	$¢d_£q_pÜt_šfo_g‘_dœeùiÚ
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2337 
	`as£¹
(
šfo
);

2338  
šfo
->
dœeùiÚ
;

2339 
	}
}

2348 
	$¢d_£q_pÜt_šfo_g‘_ump_group
(cÚ¡ 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2350 
	`as£¹
(
šfo
);

2351  
šfo
->
ump_group
;

2352 
	}
}

2361 
	$¢d_£q_pÜt_šfo_£t_ş›Á
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
ş›Á
)

2363 
	`as£¹
(
šfo
);

2364 
šfo
->
addr
.
ş›Á
 = client;

2365 
	}
}

2374 
	$¢d_£q_pÜt_šfo_£t_pÜt
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
pÜt
)

2376 
	`as£¹
(
šfo
);

2377 
šfo
->
addr
.
pÜt
 =…ort;

2378 
	}
}

2387 
	$¢d_£q_pÜt_šfo_£t_addr
(
¢d_£q_pÜt_šfo_t
 *
šfo
, cÚ¡ 
¢d_£q_addr_t
 *
addr
)

2389 
	`as£¹
(
šfo
);

2390 
šfo
->
addr
 = *(cÚ¡ 
¢drv_£q_addr
 *)addr;

2391 
	}
}

2400 
	$¢d_£q_pÜt_šfo_£t_Çme
(
¢d_£q_pÜt_šfo_t
 *
šfo
, cÚ¡ *
Çme
)

2402 
	`as£¹
(
šfo
 && 
Çme
);

2403 
	`¢d_¡¾ıy
(
šfo
->
Çme
,‚ame, (info->name));

2404 
	}
}

2413 
	$¢d_£q_pÜt_šfo_£t_ÿ·b™y
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
ÿ·b™y
)

2415 
	`as£¹
(
šfo
);

2416 
šfo
->
ÿ·b™y
 = capability;

2417 
	}
}

2426 
	$¢d_£q_pÜt_šfo_£t_ty³
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
ty³
)

2428 
	`as£¹
(
šfo
);

2429 
šfo
->
ty³
 =ype;

2430 
	}
}

2439 
	$¢d_£q_pÜt_šfo_£t_midi_chªÃls
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
chªÃls
)

2441 
	`as£¹
(
šfo
);

2442 
šfo
->
midi_chªÃls
 = 
chªÃls
;

2443 
	}
}

2452 
	$¢d_£q_pÜt_šfo_£t_midi_voiûs
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
voiûs
)

2454 
	`as£¹
(
šfo
);

2455 
šfo
->
midi_voiûs
 = 
voiûs
;

2456 
	}
}

2465 
	$¢d_£q_pÜt_šfo_£t_syÁh_voiûs
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
voiûs
)

2467 
	`as£¹
(
šfo
);

2468 
šfo
->
syÁh_voiûs
 = 
voiûs
;

2469 
	}
}

2478 
	$¢d_£q_pÜt_šfo_£t_pÜt_¥ecif›d
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
v®
)

2480 
	`as£¹
(
šfo
);

2481 ià(
v®
)

2482 
šfo
->
æags
 |ğ
SNDRV_SEQ_PORT_FLG_GIVEN_PORT
;

2484 
šfo
->
æags
 &ğ~
SNDRV_SEQ_PORT_FLG_GIVEN_PORT
;

2485 
	}
}

2494 
	$¢d_£q_pÜt_šfo_£t_time¡ampšg
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
’abË
)

2496 
	`as£¹
(
šfo
);

2497 ià(
’abË
)

2498 
šfo
->
æags
 |ğ
SNDRV_SEQ_PORT_FLG_TIMESTAMP
;

2500 
šfo
->
æags
 &ğ~
SNDRV_SEQ_PORT_FLG_TIMESTAMP
;

2501 
	}
}

2510 
	$¢d_£q_pÜt_šfo_£t_time¡amp_»®
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
’abË
)

2512 
	`as£¹
(
šfo
);

2513 ià(
’abË
)

2514 
šfo
->
æags
 |ğ
SNDRV_SEQ_PORT_FLG_TIME_REAL
;

2516 
šfo
->
æags
 &ğ~
SNDRV_SEQ_PORT_FLG_TIME_REAL
;

2517 
	}
}

2526 
	$¢d_£q_pÜt_šfo_£t_time¡amp_queue
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
queue
)

2528 
	`as£¹
(
šfo
);

2529 
šfo
->
time_queue
 = 
queue
;

2530 
	}
}

2539 
	$¢d_£q_pÜt_šfo_£t_dœeùiÚ
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
dœeùiÚ
)

2541 
	`as£¹
(
šfo
);

2542 
šfo
->
dœeùiÚ
 = direction;

2543 
	}
}

2552 
	$¢d_£q_pÜt_šfo_£t_ump_group
(
¢d_£q_pÜt_šfo_t
 *
šfo
, 
ump_group
)

2554 
	`as£¹
(
šfo
);

2555 
šfo
->
ump_group
 = ump_group;

2556 
	}
}

2603 
	$¢d_£q_ü—‹_pÜt
(
¢d_£q_t
 *
£q
, 
¢d_£q_pÜt_šfo_t
 * 
pÜt
)

2605 
	`as£¹
(
£q
 && 
pÜt
);

2606 
pÜt
->
addr
.
ş›Á
 = 
£q
->client;

2607  
£q
->
İs
->
	`ü—‹_pÜt
(£q, 
pÜt
);

2608 
	}
}

2620 
	$¢d_£q_d–‘e_pÜt
(
¢d_£q_t
 *
£q
, 
pÜt
)

2622 
¢d_£q_pÜt_šfo_t
 
pšfo
;

2623 
	`as£¹
(
£q
);

2624 
	`mem£t
(&
pšfo
, 0, (pinfo));

2625 
pšfo
.
addr
.
ş›Á
 = 
£q
->client;

2626 
pšfo
.
addr
.
pÜt
 =…ort;

2627  
£q
->
İs
->
	`d–‘e_pÜt
(£q, &
pšfo
);

2628 
	}
}

2640 
	$¢d_£q_g‘_ªy_pÜt_šfo
(
¢d_£q_t
 *
£q
, 
ş›Á
, 
pÜt
, 
¢d_£q_pÜt_šfo_t
 * 
šfo
)

2642 
	`as£¹
(
£q
 && 
šfo
 && 
ş›Á
 >ğ0 && 
pÜt
 >= 0);

2643 
	`mem£t
(
šfo
, 0, (
¢d_£q_pÜt_šfo_t
));

2644 
šfo
->
addr
.
ş›Á
 = client;

2645 
šfo
->
addr
.
pÜt
 =…ort;

2646  
£q
->
İs
->
	`g‘_pÜt_šfo
(£q, 
šfo
);

2647 
	}
}

2659 
	$¢d_£q_g‘_pÜt_šfo
(
¢d_£q_t
 *
£q
, 
pÜt
, 
¢d_£q_pÜt_šfo_t
 * 
šfo
)

2661  
	`¢d_£q_g‘_ªy_pÜt_šfo
(
£q
, seq->
ş›Á
, 
pÜt
, 
šfo
);

2662 
	}
}

2673 
	$¢d_£q_£t_pÜt_šfo
(
¢d_£q_t
 *
£q
, 
pÜt
, 
¢d_£q_pÜt_šfo_t
 * 
šfo
)

2675 
	`as£¹
(
£q
 && 
šfo
 && 
pÜt
 >= 0);

2676 
šfo
->
addr
.
ş›Á
 = 
£q
->client;

2677 
šfo
->
addr
.
pÜt
 =…ort;

2678  
£q
->
İs
->
	`£t_pÜt_šfo
(£q, 
šfo
);

2679 
	}
}

2698 
	$¢d_£q_qu”y_Ãxt_pÜt
(
¢d_£q_t
 *
£q
, 
¢d_£q_pÜt_šfo_t
 *
šfo
)

2700 
	`as£¹
(
£q
 && 
šfo
);

2701  
£q
->
İs
->
	`qu”y_Ãxt_pÜt
(£q, 
šfo
);

2702 
	}
}

2716 
size_t
 
	$¢d_£q_pÜt_subsüibe_sizeof
()

2718  (
¢d_£q_pÜt_subsüibe_t
);

2719 
	}
}

2726 
	$¢d_£q_pÜt_subsüibe_m®loc
(
¢d_£q_pÜt_subsüibe_t
 **
±r
)

2728 
	`as£¹
(
±r
);

2729 *
±r
 = 
	`ÿÎoc
(1, (
¢d_£q_pÜt_subsüibe_t
));

2730 ià(!*
±r
)

2731  -
ENOMEM
;

2733 
	}
}

2739 
	$¢d_£q_pÜt_subsüibe_ä“
(
¢d_£q_pÜt_subsüibe_t
 *
obj
)

2741 
	`ä“
(
obj
);

2742 
	}
}

2749 
	$¢d_£q_pÜt_subsüibe_cİy
(
¢d_£q_pÜt_subsüibe_t
 *
d¡
, cÚ¡ snd_£q_pÜt_subsüibe_ˆ*
¤c
)

2751 
	`as£¹
(
d¡
 && 
¤c
);

2752 *
d¡
 = *
¤c
;

2753 
	}
}

2762 cÚ¡ 
¢d_£q_addr_t
 *
	$¢d_£q_pÜt_subsüibe_g‘_£nd”
(cÚ¡ 
¢d_£q_pÜt_subsüibe_t
 *
šfo
)

2764 
	`as£¹
(
šfo
);

2765  (cÚ¡ 
¢d_£q_addr_t
 *)&
šfo
->
£nd”
;

2766 
	}
}

2774 cÚ¡ 
¢d_£q_addr_t
 *
	$¢d_£q_pÜt_subsüibe_g‘_de¡
(cÚ¡ 
¢d_£q_pÜt_subsüibe_t
 *
šfo
)

2776 
	`as£¹
(
šfo
);

2777  (cÚ¡ 
¢d_£q_addr_t
 *)&
šfo
->
de¡
;

2778 
	}
}

2787 
	$¢d_£q_pÜt_subsüibe_g‘_queue
(cÚ¡ 
¢d_£q_pÜt_subsüibe_t
 *
šfo
)

2789 
	`as£¹
(
šfo
);

2790  
šfo
->
queue
;

2791 
	}
}

2800 
	$¢d_£q_pÜt_subsüibe_g‘_exşusive
(cÚ¡ 
¢d_£q_pÜt_subsüibe_t
 *
šfo
)

2802 
	`as£¹
(
šfo
);

2803  (
šfo
->
æags
 & 
SNDRV_SEQ_PORT_SUBS_EXCLUSIVE
) ? 1 : 0;

2804 
	}
}

2813 
	$¢d_£q_pÜt_subsüibe_g‘_time_upd©e
(cÚ¡ 
¢d_£q_pÜt_subsüibe_t
 *
šfo
)

2815 
	`as£¹
(
šfo
);

2816  (
šfo
->
æags
 & 
SNDRV_SEQ_PORT_SUBS_TIMESTAMP
) ? 1 : 0;

2817 
	}
}

2826 
	$¢d_£q_pÜt_subsüibe_g‘_time_»®
(cÚ¡ 
¢d_£q_pÜt_subsüibe_t
 *
šfo
)

2828 
	`as£¹
(
šfo
);

2829  (
šfo
->
æags
 & 
SNDRV_SEQ_PORT_SUBS_TIME_REAL
) ? 1 : 0;

2830 
	}
}

2839 
	$¢d_£q_pÜt_subsüibe_£t_£nd”
(
¢d_£q_pÜt_subsüibe_t
 *
šfo
, cÚ¡ 
¢d_£q_addr_t
 *
addr
)

2841 
	`as£¹
(
šfo
);

2842 
	`memıy
(&
šfo
->
£nd”
, 
addr
, (*addr));

2843 
	}
}

2852 
	$¢d_£q_pÜt_subsüibe_£t_de¡
(
¢d_£q_pÜt_subsüibe_t
 *
šfo
, cÚ¡ 
¢d_£q_addr_t
 *
addr
)

2854 
	`as£¹
(
šfo
);

2855 
	`memıy
(&
šfo
->
de¡
, 
addr
, (*addr));

2856 
	}
}

2865 
	$¢d_£q_pÜt_subsüibe_£t_queue
(
¢d_£q_pÜt_subsüibe_t
 *
šfo
, 
q
)

2867 
	`as£¹
(
šfo
);

2868 
šfo
->
queue
 = 
q
;

2869 
	}
}

2878 
	$¢d_£q_pÜt_subsüibe_£t_exşusive
(
¢d_£q_pÜt_subsüibe_t
 *
šfo
, 
v®
)

2880 
	`as£¹
(
šfo
);

2881 ià(
v®
)

2882 
šfo
->
æags
 |ğ
SNDRV_SEQ_PORT_SUBS_EXCLUSIVE
;

2884 
šfo
->
æags
 &ğ~
SNDRV_SEQ_PORT_SUBS_EXCLUSIVE
;

2885 
	}
}

2894 
	$¢d_£q_pÜt_subsüibe_£t_time_upd©e
(
¢d_£q_pÜt_subsüibe_t
 *
šfo
, 
v®
)

2896 
	`as£¹
(
šfo
);

2897 ià(
v®
)

2898 
šfo
->
æags
 |ğ
SNDRV_SEQ_PORT_SUBS_TIMESTAMP
;

2900 
šfo
->
æags
 &ğ~
SNDRV_SEQ_PORT_SUBS_TIMESTAMP
;

2901 
	}
}

2910 
	$¢d_£q_pÜt_subsüibe_£t_time_»®
(
¢d_£q_pÜt_subsüibe_t
 *
šfo
, 
v®
)

2912 
	`as£¹
(
šfo
);

2913 ià(
v®
)

2914 
šfo
->
æags
 |ğ
SNDRV_SEQ_PORT_SUBS_TIME_REAL
;

2916 
šfo
->
æags
 &ğ~
SNDRV_SEQ_PORT_SUBS_TIME_REAL
;

2917 
	}
}

2928 
	$¢d_£q_g‘_pÜt_subsütiÚ
(
¢d_£q_t
 *
£q
, 
¢d_£q_pÜt_subsüibe_t
 * 
sub
)

2930 
	`as£¹
(
£q
 && 
sub
);

2931  
£q
->
İs
->
	`g‘_pÜt_subsütiÚ
(£q, 
sub
);

2932 
	}
}

2946 
	$¢d_£q_subsüibe_pÜt
(
¢d_£q_t
 *
£q
, 
¢d_£q_pÜt_subsüibe_t
 * 
sub
)

2948 
	`as£¹
(
£q
 && 
sub
);

2949  
£q
->
İs
->
	`subsüibe_pÜt
(£q, 
sub
);

2950 
	}
}

2963 
	$¢d_£q_unsubsüibe_pÜt
(
¢d_£q_t
 *
£q
, 
¢d_£q_pÜt_subsüibe_t
 * 
sub
)

2965 
	`as£¹
(
£q
 && 
sub
);

2966  
£q
->
İs
->
	`unsubsüibe_pÜt
(£q, 
sub
);

2967 
	}
}

2974 
size_t
 
	$¢d_£q_qu”y_subsüibe_sizeof
()

2976  (
¢d_£q_qu”y_subsüibe_t
);

2977 
	}
}

2984 
	$¢d_£q_qu”y_subsüibe_m®loc
(
¢d_£q_qu”y_subsüibe_t
 **
±r
)

2986 
	`as£¹
(
±r
);

2987 *
±r
 = 
	`ÿÎoc
(1, (
¢d_£q_qu”y_subsüibe_t
));

2988 ià(!*
±r
)

2989  -
ENOMEM
;

2991 
	}
}

2997 
	$¢d_£q_qu”y_subsüibe_ä“
(
¢d_£q_qu”y_subsüibe_t
 *
obj
)

2999 
	`ä“
(
obj
);

3000 
	}
}

3007 
	$¢d_£q_qu”y_subsüibe_cİy
(
¢d_£q_qu”y_subsüibe_t
 *
d¡
, cÚ¡ snd_£q_qu”y_subsüibe_ˆ*
¤c
)

3009 
	`as£¹
(
d¡
 && 
¤c
);

3010 *
d¡
 = *
¤c
;

3011 
	}
}

3021 
	$¢d_£q_qu”y_subsüibe_g‘_ş›Á
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
)

3023 
	`as£¹
(
šfo
);

3024  
šfo
->
roÙ
.
ş›Á
;

3025 
	}
}

3034 
	$¢d_£q_qu”y_subsüibe_g‘_pÜt
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
)

3036 
	`as£¹
(
šfo
);

3037  
šfo
->
roÙ
.
pÜt
;

3038 
	}
}

3047 cÚ¡ 
¢d_£q_addr_t
 *
	$¢d_£q_qu”y_subsüibe_g‘_roÙ
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
)

3049 
	`as£¹
(
šfo
);

3050  (cÚ¡ 
¢d_£q_addr_t
 *)&
šfo
->
roÙ
;

3051 
	}
}

3060 
¢d_£q_qu”y_subs_ty³_t
 
	$¢d_£q_qu”y_subsüibe_g‘_ty³
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
)

3062 
	`as£¹
(
šfo
);

3063  
šfo
->
ty³
;

3064 
	}
}

3073 
	$¢d_£q_qu”y_subsüibe_g‘_šdex
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
)

3075 
	`as£¹
(
šfo
);

3076  
šfo
->
šdex
;

3077 
	}
}

3086 
	$¢d_£q_qu”y_subsüibe_g‘_num_subs
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
)

3088 
	`as£¹
(
šfo
);

3089  
šfo
->
num_subs
;

3090 
	}
}

3099 cÚ¡ 
¢d_£q_addr_t
 *
	$¢d_£q_qu”y_subsüibe_g‘_addr
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
)

3101 
	`as£¹
(
šfo
);

3102  (cÚ¡ 
¢d_£q_addr_t
 *)&
šfo
->
addr
;

3103 
	}
}

3112 
	$¢d_£q_qu”y_subsüibe_g‘_queue
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
)

3114 
	`as£¹
(
šfo
);

3115  
šfo
->
queue
;

3116 
	}
}

3125 
	$¢d_£q_qu”y_subsüibe_g‘_exşusive
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
)

3127 
	`as£¹
(
šfo
);

3128  (
šfo
->
æags
 & 
SNDRV_SEQ_PORT_SUBS_EXCLUSIVE
) ? 1 : 0;

3129 
	}
}

3138 
	$¢d_£q_qu”y_subsüibe_g‘_time_upd©e
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
)

3140 
	`as£¹
(
šfo
);

3141  (
šfo
->
æags
 & 
SNDRV_SEQ_PORT_SUBS_TIMESTAMP
) ? 1 : 0;

3142 
	}
}

3151 
	$¢d_£q_qu”y_subsüibe_g‘_time_»®
(cÚ¡ 
¢d_£q_qu”y_subsüibe_t
 *
šfo
)

3153 
	`as£¹
(
šfo
);

3154  (
šfo
->
æags
 & 
SNDRV_SEQ_PORT_SUBS_TIMESTAMP
) ? 1 : 0;

3155 
	}
}

3164 
	$¢d_£q_qu”y_subsüibe_£t_ş›Á
(
¢d_£q_qu”y_subsüibe_t
 *
šfo
, 
ş›Á
)

3166 
	`as£¹
(
šfo
);

3167 
šfo
->
roÙ
.
ş›Á
 = client;

3168 
	}
}

3177 
	$¢d_£q_qu”y_subsüibe_£t_pÜt
(
¢d_£q_qu”y_subsüibe_t
 *
šfo
, 
pÜt
)

3179 
	`as£¹
(
šfo
);

3180 
šfo
->
roÙ
.
pÜt
 =…ort;

3181 
	}
}

3190 
	$¢d_£q_qu”y_subsüibe_£t_roÙ
(
¢d_£q_qu”y_subsüibe_t
 *
šfo
, cÚ¡ 
¢d_£q_addr_t
 *
addr
)

3192 
	`as£¹
(
šfo
);

3193 
šfo
->
roÙ
 = *(cÚ¡ 
¢d_£q_addr
 *)
addr
;

3194 
	}
}

3203 
	$¢d_£q_qu”y_subsüibe_£t_ty³
(
¢d_£q_qu”y_subsüibe_t
 *
šfo
, 
¢d_£q_qu”y_subs_ty³_t
 
ty³
)

3205 
	`as£¹
(
šfo
);

3206 
šfo
->
ty³
 =ype;

3207 
	}
}

3216 
	$¢d_£q_qu”y_subsüibe_£t_šdex
(
¢d_£q_qu”y_subsüibe_t
 *
šfo
, 
šdex
)

3218 
	`as£¹
(
šfo
);

3219 
šfo
->
šdex
 = index;

3220 
	}
}

3242 
	$¢d_£q_qu”y_pÜt_subsüib”s
(
¢d_£q_t
 *
£q
, 
¢d_£q_qu”y_subsüibe_t
 * 
subs
)

3244 
	`as£¹
(
£q
 && 
subs
);

3245  
£q
->
İs
->
	`qu”y_pÜt_subsüib”s
(£q, 
subs
);

3246 
	}
}

3258 
size_t
 
	$¢d_£q_queue_šfo_sizeof
()

3260  (
¢d_£q_queue_šfo_t
);

3261 
	}
}

3268 
	$¢d_£q_queue_šfo_m®loc
(
¢d_£q_queue_šfo_t
 **
±r
)

3270 
	`as£¹
(
±r
);

3271 *
±r
 = 
	`ÿÎoc
(1, (
¢d_£q_queue_šfo_t
));

3272 ià(!*
±r
)

3273  -
ENOMEM
;

3275 
	}
}

3281 
	$¢d_£q_queue_šfo_ä“
(
¢d_£q_queue_šfo_t
 *
obj
)

3283 
	`ä“
(
obj
);

3284 
	}
}

3291 
	$¢d_£q_queue_šfo_cİy
(
¢d_£q_queue_šfo_t
 *
d¡
, cÚ¡ snd_£q_queue_šfo_ˆ*
¤c
)

3293 
	`as£¹
(
d¡
 && 
¤c
);

3294 *
d¡
 = *
¤c
;

3295 
	}
}

3305 
	$¢d_£q_queue_šfo_g‘_queue
(cÚ¡ 
¢d_£q_queue_šfo_t
 *
šfo
)

3307 
	`as£¹
(
šfo
);

3308  
šfo
->
queue
;

3309 
	}
}

3318 cÚ¡ *
	$¢d_£q_queue_šfo_g‘_Çme
(cÚ¡ 
¢d_£q_queue_šfo_t
 *
šfo
)

3320 
	`as£¹
(
šfo
);

3321  
šfo
->
Çme
;

3322 
	}
}

3331 
	$¢d_£q_queue_šfo_g‘_owÃr
(cÚ¡ 
¢d_£q_queue_šfo_t
 *
šfo
)

3333 
	`as£¹
(
šfo
);

3334  
šfo
->
owÃr
;

3335 
	}
}

3344 
	$¢d_£q_queue_šfo_g‘_locked
(cÚ¡ 
¢d_£q_queue_šfo_t
 *
šfo
)

3346 
	`as£¹
(
šfo
);

3347  
šfo
->
locked
;

3348 
	}
}

3357 
	$¢d_£q_queue_šfo_g‘_æags
(cÚ¡ 
¢d_£q_queue_šfo_t
 *
šfo
)

3359 
	`as£¹
(
šfo
);

3360  
šfo
->
æags
;

3361 
	}
}

3370 
	$¢d_£q_queue_šfo_£t_Çme
(
¢d_£q_queue_šfo_t
 *
šfo
, cÚ¡ *
Çme
)

3372 
	`as£¹
(
šfo
 && 
Çme
);

3373 
	`¢d_¡¾ıy
(
šfo
->
Çme
,‚ame, (info->name));

3374 
	}
}

3383 
	$¢d_£q_queue_šfo_£t_owÃr
(
¢d_£q_queue_šfo_t
 *
šfo
, 
owÃr
)

3385 
	`as£¹
(
šfo
);

3386 
šfo
->
owÃr
 = owner;

3387 
	}
}

3396 
	$¢d_£q_queue_šfo_£t_locked
(
¢d_£q_queue_šfo_t
 *
šfo
, 
locked
)

3398 
	`as£¹
(
šfo
);

3399 
šfo
->
locked
 =†ocked;

3400 
	}
}

3409 
	$¢d_£q_queue_šfo_£t_æags
(
¢d_£q_queue_šfo_t
 *
šfo
, 
æags
)

3411 
	`as£¹
(
šfo
);

3412 
šfo
->
æags
 = flags;

3413 
	}
}

3424 
	$¢d_£q_ü—‹_queue
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_šfo_t
 *
šfo
)

3426 
”r
;

3427 
	`as£¹
(
£q
 && 
šfo
);

3428 
šfo
->
owÃr
 = 
£q
->
ş›Á
;

3429 
”r
 = 
£q
->
İs
->
	`ü—‹_queue
(£q, 
šfo
);

3430 ià(
”r
 < 0)

3431  
”r
;

3432  
šfo
->
queue
;

3433 
	}
}

3443 
	$¢d_£q_®loc_Çmed_queue
(
¢d_£q_t
 *
£q
, cÚ¡ *
Çme
)

3445 
¢d_£q_queue_šfo_t
 
šfo
;

3446 
	`mem£t
(&
šfo
, 0, (info));

3447 
šfo
.
locked
 = 1;

3448 ià(
Çme
)

3449 
	`¢d_¡¾ıy
(
šfo
.
Çme
,‚ame, (info.name));

3450  
	`¢d_£q_ü—‹_queue
(
£q
, &
šfo
);

3451 
	}
}

3461 
	$¢d_£q_®loc_queue
(
¢d_£q_t
 *
£q
)

3463  
	`¢d_£q_®loc_Çmed_queue
(
£q
, 
NULL
);

3464 
	}
}

3474 
	$¢d_£q_ä“_queue
(
¢d_£q_t
 *
£q
, 
q
)

3476 
¢d_£q_queue_šfo_t
 
šfo
;

3477 
	`as£¹
(
£q
);

3478 
	`mem£t
(&
šfo
, 0, (info));

3479 
šfo
.
queue
 = 
q
;

3480  
£q
->
İs
->
	`d–‘e_queue
(£q, &
šfo
);

3481 
	}
}

3492 
	$¢d_£q_g‘_queue_šfo
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_šfo_t
 *
šfo
)

3494 
	`as£¹
(
£q
 && 
šfo
);

3495 
šfo
->
queue
 = 
q
;

3496  
£q
->
İs
->
	`g‘_queue_šfo
(£q, 
šfo
);

3497 
	}
}

3508 
	$¢d_£q_£t_queue_šfo
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_šfo_t
 *
šfo
)

3510 
	`as£¹
(
£q
 && 
šfo
);

3511 
šfo
->
queue
 = 
q
;

3512  
£q
->
İs
->
	`£t_queue_šfo
(£q, 
šfo
);

3513 
	}
}

3525 
	$¢d_£q_qu”y_Çmed_queue
(
¢d_£q_t
 *
£q
, cÚ¡ *
Çme
)

3527 
”r
;

3528 
¢d_£q_queue_šfo_t
 
šfo
;

3529 
	`as£¹
(
£q
 && 
Çme
);

3530 
	`¢d_¡¾ıy
(
šfo
.
Çme
,‚ame, (info.name));

3531 
”r
 = 
£q
->
İs
->
	`g‘_Çmed_queue
(£q, &
šfo
);

3532 ià(
”r
 < 0)

3533  
”r
;

3534  
šfo
.
queue
;

3535 
	}
}

3546 
	$¢d_£q_g‘_queue_u§ge
(
¢d_£q_t
 *
£q
, 
q
)

3548 
¢d_£q_queue_ş›Á
 
šfo
;

3549 
”r
;

3550 
	`as£¹
(
£q
);

3551 
	`mem£t
(&
šfo
, 0, (info));

3552 
šfo
.
queue
 = 
q
;

3553 
šfo
.
ş›Á
 = 
£q
->client;

3554 ià((
”r
 = 
£q
->
İs
->
	`g‘_queue_ş›Á
(£q, &
šfo
)) < 0)

3555  
”r
;

3556  
šfo
.
u£d
;

3557 
	}
}

3568 
	$¢d_£q_£t_queue_u§ge
(
¢d_£q_t
 *
£q
, 
q
, 
u£d
)

3570 
¢d_£q_queue_ş›Á
 
šfo
;

3571 
	`as£¹
(
£q
);

3572 
	`mem£t
(&
šfo
, 0, (info));

3573 
šfo
.
queue
 = 
q
;

3574 
šfo
.
ş›Á
 = 
£q
->client;

3575 
šfo
.
u£d
 = used ? 1 : 0;

3576  
£q
->
İs
->
	`£t_queue_ş›Á
(£q, &
šfo
);

3577 
	}
}

3584 
size_t
 
	$¢d_£q_queue_¡©us_sizeof
()

3586  (
¢d_£q_queue_¡©us_t
);

3587 
	}
}

3594 
	$¢d_£q_queue_¡©us_m®loc
(
¢d_£q_queue_¡©us_t
 **
±r
)

3596 
	`as£¹
(
±r
);

3597 *
±r
 = 
	`ÿÎoc
(1, (
¢d_£q_queue_¡©us_t
));

3598 ià(!*
±r
)

3599  -
ENOMEM
;

3601 
	}
}

3607 
	$¢d_£q_queue_¡©us_ä“
(
¢d_£q_queue_¡©us_t
 *
obj
)

3609 
	`ä“
(
obj
);

3610 
	}
}

3617 
	$¢d_£q_queue_¡©us_cİy
(
¢d_£q_queue_¡©us_t
 *
d¡
, cÚ¡ snd_£q_queue_¡©us_ˆ*
¤c
)

3619 
	`as£¹
(
d¡
 && 
¤c
);

3620 *
d¡
 = *
¤c
;

3621 
	}
}

3631 
	$¢d_£q_queue_¡©us_g‘_queue
(cÚ¡ 
¢d_£q_queue_¡©us_t
 *
šfo
)

3633 
	`as£¹
(
šfo
);

3634  
šfo
->
queue
;

3635 
	}
}

3644 
	$¢d_£q_queue_¡©us_g‘_ev’ts
(cÚ¡ 
¢d_£q_queue_¡©us_t
 *
šfo
)

3646 
	`as£¹
(
šfo
);

3647  
šfo
->
ev’ts
;

3648 
	}
}

3657 
¢d_£q_tick_time_t
 
	$¢d_£q_queue_¡©us_g‘_tick_time
(cÚ¡ 
¢d_£q_queue_¡©us_t
 *
šfo
)

3659 
	`as£¹
(
šfo
);

3660  
šfo
->
tick
;

3661 
	}
}

3669 cÚ¡ 
¢d_£q_»®_time_t
 *
	$¢d_£q_queue_¡©us_g‘_»®_time
(cÚ¡ 
¢d_£q_queue_¡©us_t
 *
šfo
)

3671 
	`as£¹
(
šfo
);

3672  (cÚ¡ 
¢d_£q_»®_time_t
 *)&
šfo
->
time
;

3673 
	}
}

3682 
	$¢d_£q_queue_¡©us_g‘_¡©us
(cÚ¡ 
¢d_£q_queue_¡©us_t
 *
šfo
)

3684 
	`as£¹
(
šfo
);

3685  
šfo
->
ruÂšg
;

3686 
	}
}

3698 
	$¢d_£q_g‘_queue_¡©us
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_¡©us_t
 * 
¡©us
)

3700 
	`as£¹
(
£q
 && 
¡©us
);

3701 
	`mem£t
(
¡©us
, 0, (
¢d_£q_queue_¡©us_t
));

3702 
¡©us
->
queue
 = 
q
;

3703  
£q
->
İs
->
	`g‘_queue_¡©us
(£q, 
¡©us
);

3704 
	}
}

3711 
size_t
 
	$¢d_£q_queue_‹mpo_sizeof
()

3713  (
¢d_£q_queue_‹mpo_t
);

3714 
	}
}

3721 
	$¢d_£q_queue_‹mpo_m®loc
(
¢d_£q_queue_‹mpo_t
 **
±r
)

3723 
	`as£¹
(
±r
);

3724 *
±r
 = 
	`ÿÎoc
(1, (
¢d_£q_queue_‹mpo_t
));

3725 ià(!*
±r
)

3726  -
ENOMEM
;

3728 
	}
}

3734 
	$¢d_£q_queue_‹mpo_ä“
(
¢d_£q_queue_‹mpo_t
 *
obj
)

3736 
	`ä“
(
obj
);

3737 
	}
}

3744 
	$¢d_£q_queue_‹mpo_cİy
(
¢d_£q_queue_‹mpo_t
 *
d¡
, cÚ¡ snd_£q_queue_‹mpo_ˆ*
¤c
)

3746 
	`as£¹
(
d¡
 && 
¤c
);

3747 *
d¡
 = *
¤c
;

3748 
	}
}

3758 
	$¢d_£q_queue_‹mpo_g‘_queue
(cÚ¡ 
¢d_£q_queue_‹mpo_t
 *
šfo
)

3760 
	`as£¹
(
šfo
);

3761  
šfo
->
queue
;

3762 
	}
}

3771 
	$¢d_£q_queue_‹mpo_g‘_‹mpo
(cÚ¡ 
¢d_£q_queue_‹mpo_t
 *
šfo
)

3773 
	`as£¹
(
šfo
);

3774  
šfo
->
‹mpo
;

3775 
	}
}

3784 
	$¢d_£q_queue_‹mpo_g‘_µq
(cÚ¡ 
¢d_£q_queue_‹mpo_t
 *
šfo
)

3786 
	`as£¹
(
šfo
);

3787  
šfo
->
µq
;

3788 
	}
}

3797 
	$¢d_£q_queue_‹mpo_g‘_skew
(cÚ¡ 
¢d_£q_queue_‹mpo_t
 *
šfo
)

3799 
	`as£¹
(
šfo
);

3800  
šfo
->
skew_v®ue
;

3801 
	}
}

3810 
	$¢d_£q_queue_‹mpo_g‘_skew_ba£
(cÚ¡ 
¢d_£q_queue_‹mpo_t
 *
šfo
)

3812 
	`as£¹
(
šfo
);

3813  
šfo
->
skew_ba£
;

3814 
	}
}

3823 
	$¢d_£q_queue_‹mpo_£t_‹mpo
(
¢d_£q_queue_‹mpo_t
 *
šfo
, 
‹mpo
)

3825 
	`as£¹
(
šfo
);

3826 
šfo
->
‹mpo
 =empo;

3827 
	}
}

3836 
	$¢d_£q_queue_‹mpo_£t_µq
(
¢d_£q_queue_‹mpo_t
 *
šfo
, 
µq
)

3838 
	`as£¹
(
šfo
);

3839 
šfo
->
µq
 =…pq;

3840 
	}
}

3852 
	$¢d_£q_queue_‹mpo_£t_skew
(
¢d_£q_queue_‹mpo_t
 *
šfo
, 
skew
)

3854 
	`as£¹
(
šfo
);

3855 
šfo
->
skew_v®ue
 = 
skew
;

3856 
	}
}

3865 
	$¢d_£q_queue_‹mpo_£t_skew_ba£
(
¢d_£q_queue_‹mpo_t
 *
šfo
, 
ba£
)

3867 
	`as£¹
(
šfo
);

3868 
šfo
->
skew_ba£
 = 
ba£
;

3869 
	}
}

3880 
	$¢d_£q_g‘_queue_‹mpo
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_‹mpo_t
 * 
‹mpo
)

3882 
	`as£¹
(
£q
 && 
‹mpo
);

3883 
	`mem£t
(
‹mpo
, 0, (
¢d_£q_queue_‹mpo_t
));

3884 
‹mpo
->
queue
 = 
q
;

3885  
£q
->
İs
->
	`g‘_queue_‹mpo
(£q, 
‹mpo
);

3886 
	}
}

3897 
	$¢d_£q_£t_queue_‹mpo
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_‹mpo_t
 * 
‹mpo
)

3899 
	`as£¹
(
£q
 && 
‹mpo
);

3900 
‹mpo
->
queue
 = 
q
;

3901  
£q
->
İs
->
	`£t_queue_‹mpo
(£q, 
‹mpo
);

3902 
	}
}

3911 
size_t
 
	$¢d_£q_queue_tim”_sizeof
()

3913  (
¢d_£q_queue_tim”_t
);

3914 
	}
}

3921 
	$¢d_£q_queue_tim”_m®loc
(
¢d_£q_queue_tim”_t
 **
±r
)

3923 
	`as£¹
(
±r
);

3924 *
±r
 = 
	`ÿÎoc
(1, (
¢d_£q_queue_tim”_t
));

3925 ià(!*
±r
)

3926  -
ENOMEM
;

3928 
	}
}

3934 
	$¢d_£q_queue_tim”_ä“
(
¢d_£q_queue_tim”_t
 *
obj
)

3936 
	`ä“
(
obj
);

3937 
	}
}

3944 
	$¢d_£q_queue_tim”_cİy
(
¢d_£q_queue_tim”_t
 *
d¡
, cÚ¡ snd_£q_queue_tim”_ˆ*
¤c
)

3946 
	`as£¹
(
d¡
 && 
¤c
);

3947 *
d¡
 = *
¤c
;

3948 
	}
}

3958 
	$¢d_£q_queue_tim”_g‘_queue
(cÚ¡ 
¢d_£q_queue_tim”_t
 *
šfo
)

3960 
	`as£¹
(
šfo
);

3961  
šfo
->
queue
;

3962 
	}
}

3971 
¢d_£q_queue_tim”_ty³_t
 
	$¢d_£q_queue_tim”_g‘_ty³
(cÚ¡ 
¢d_£q_queue_tim”_t
 *
šfo
)

3973 
	`as£¹
(
šfo
);

3974  (
¢d_£q_queue_tim”_ty³_t
)
šfo
->
ty³
;

3975 
	}
}

3984 cÚ¡ 
¢d_tim”_id_t
 *
	$¢d_£q_queue_tim”_g‘_id
(cÚ¡ 
¢d_£q_queue_tim”_t
 *
šfo
)

3986 
	`as£¹
(
šfo
);

3987  &
šfo
->
u
.
®§
.
id
;

3988 
	}
}

3997 
	$¢d_£q_queue_tim”_g‘_»sŞutiÚ
(cÚ¡ 
¢d_£q_queue_tim”_t
 *
šfo
)

3999 
	`as£¹
(
šfo
);

4000  
šfo
->
u
.
®§
.
»sŞutiÚ
;

4001 
	}
}

4010 
	$¢d_£q_queue_tim”_£t_ty³
(
¢d_£q_queue_tim”_t
 *
šfo
, 
¢d_£q_queue_tim”_ty³_t
 
ty³
)

4012 
	`as£¹
(
šfo
);

4013 
šfo
->
ty³
 = ()type;

4014 
	}
}

4023 
	$¢d_£q_queue_tim”_£t_id
(
¢d_£q_queue_tim”_t
 *
šfo
, cÚ¡ 
¢d_tim”_id_t
 *
id
)

4025 
	`as£¹
(
šfo
 && 
id
);

4026 
šfo
->
u
.
®§
.
id
 = *id;

4027 
	}
}

4036 
	$¢d_£q_queue_tim”_£t_»sŞutiÚ
(
¢d_£q_queue_tim”_t
 *
šfo
, 
»sŞutiÚ
)

4038 
	`as£¹
(
šfo
);

4039 
šfo
->
u
.
®§
.
»sŞutiÚ
 =„esolution;

4040 
	}
}

4052 
	$¢d_£q_g‘_queue_tim”
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_tim”_t
 * 
tim”
)

4054 
	`as£¹
(
£q
 && 
tim”
);

4055 
	`mem£t
(
tim”
, 0, (
¢d_£q_queue_tim”_t
));

4056 
tim”
->
queue
 = 
q
;

4057  
£q
->
İs
->
	`g‘_queue_tim”
(£q, 
tim”
);

4058 
	}
}

4069 
	$¢d_£q_£t_queue_tim”
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_tim”_t
 * 
tim”
)

4071 
	`as£¹
(
£q
 && 
tim”
);

4072 
tim”
->
queue
 = 
q
;

4073  
£q
->
İs
->
	`£t_queue_tim”
(£q, 
tim”
);

4074 
	}
}

4078 #iâdeà
DOC_HIDDEN


4087 
¢d_£q_ev’t_t
 *
	$¢d_£q_ü—‹_ev’t
()

4089  (
¢d_£q_ev’t_t
 *è
	`ÿÎoc
(1, (snd_seq_event_t));

4090 
	}
}

4101 #iâdeà
DOXYGEN


4102 
	$¢d_£q_ä“_ev’t
(
¢d_£q_ev’t_t
 *
ev
 
ATTRIBUTE_UNUSED
)

4104 
	$¢d_£q_ä“_ev’t
(
¢d_£q_ev’t_t
 *
ev
)

4108 
	}
}

4115 
ssize_t
 
	$¢d_£q_ev’t_Ëngth
(
¢d_£q_ev’t_t
 *
ev
)

4117 
ssize_t
 
Ën
 = (
¢d_£q_ev’t_t
);

4118 
	`as£¹
(
ev
);

4119 ià(
	`¢d_£q_ev_is_ump
(
ev
))

4120 
Ën
 = (
¢d_£q_ump_ev’t_t
);

4121 ià(
	`¢d_£q_ev_is_v¬ŸbË
(
ev
))

4122 
Ën
 +ğ
ev
->
d©a
.
ext
.len;

4123  
Ën
;

4124 
	}
}

4150 
	$¢d_£q_ev’t_ouut
(
¢d_£q_t
 *
£q
, 
¢d_£q_ev’t_t
 *
ev
)

4152 
»suÉ
;

4154 
»suÉ
 = 
	`¢d_£q_ev’t_ouut_bufãr
(
£q
, 
ev
);

4155 ià(
»suÉ
 =ğ-
EAGAIN
) {

4156 
»suÉ
 = 
	`¢d_£q_d¿š_ouut
(
£q
);

4157 ià(
»suÉ
 < 0)

4158  
»suÉ
;

4159  
	`¢d_£q_ev’t_ouut_bufãr
(
£q
, 
ev
);

4161  
»suÉ
;

4162 
	}
}

4165 
	$ş—r_ump_fÜ_Ëgacy_­ps
(
¢d_£q_t
 *
£q
, 
¢d_£q_ev’t_t
 *
ev
)

4167 ià(!
£q
->
midi_v”siÚ
 && 
	`¢d_£q_ev_is_ump
(
ev
))

4168 
ev
->
æags
 &ğ~
SNDRV_SEQ_EVENT_UMP
;

4169 
	}
}

4184 
	$¢d_£q_ev’t_ouut_bufãr
(
¢d_£q_t
 *
£q
, 
¢d_£q_ev’t_t
 *
ev
)

4186 
Ën
;

4187 
	`as£¹
(
£q
 && 
ev
);

4188 
	`ş—r_ump_fÜ_Ëgacy_­ps
(
£q
, 
ev
);

4189 
Ën
 = 
	`¢d_£q_ev’t_Ëngth
(
ev
);

4190 ià(
Ën
 < 0)

4191  -
EINVAL
;

4192 ià((
size_t
è
Ën
 >ğ
£q
->
obufsize
)

4193  -
EINVAL
;

4194 ià((
£q
->
obufsize
 - seq->
obufu£d
è< (
size_t
è
Ën
)

4195  -
EAGAIN
;

4196 ià(
	`¢d_£q_ev_is_ump
(
ev
)) {

4197 
	`memıy
(
£q
->
obuf
 + seq->
obufu£d
, 
ev
, (
¢d_£q_ump_ev’t_t
));

4199 
	`memıy
(
£q
->
obuf
 + seq->
obufu£d
, 
ev
, (
¢d_£q_ev’t_t
));

4200 ià(
	`¢d_£q_ev_is_v¬ŸbË
(
ev
))

4201 
	`memıy
(
£q
->
obuf
 + seq->
obufu£d
 + (
¢d_£q_ev’t_t
),

4202 
ev
->
d©a
.
ext
.
±r
,ƒv->d©a.ext.
Ën
);

4204 
£q
->
obufu£d
 +ğ
Ën
;

4205  
£q
->
obufu£d
;

4206 
	}
}

4211 
	$®loc_tmpbuf
(
¢d_£q_t
 *
£q
, 
size_t
 
Ën
)

4213 
size_t
 
size
 = ((
Ën
 + (
¢d_£q_ev’t_t
) - 1) / (snd_seq_event_t));

4214 ià(
£q
->
tmpbuf
 =ğ
NULL
) {

4215 ià(
size
 > 
DEFAULT_TMPBUF_SIZE
)

4216 
£q
->
tmpbufsize
 = 
size
;

4218 
£q
->
tmpbufsize
 = 
DEFAULT_TMPBUF_SIZE
;

4219 
£q
->
tmpbuf
 = 
	`m®loc
(£q->
tmpbufsize
 * (
¢d_£q_ev’t_t
));

4220 ià(
£q
->
tmpbuf
 =ğ
NULL
)

4221  -
ENOMEM
;

4222 } ià(
Ën
 > 
£q
->
tmpbufsize
) {

4223 
£q
->
tmpbuf
 = 
	`»®loc
(£q->tmpbuf, 
size
 * (
¢d_£q_ev’t_t
));

4224 ià(
£q
->
tmpbuf
 =ğ
NULL
)

4225  -
ENOMEM
;

4226 
£q
->
tmpbufsize
 = 
size
;

4229 
	}
}

4244 
	$¢d_£q_ev’t_ouut_dœeù
(
¢d_£q_t
 *
£q
, 
¢d_£q_ev’t_t
 *
ev
)

4246 
ssize_t
 
Ën
;

4247 *
buf
;

4249 
	`ş—r_ump_fÜ_Ëgacy_­ps
(
£q
, 
ev
);

4250 
Ën
 = 
	`¢d_£q_ev’t_Ëngth
(
ev
);

4251 ià(
Ën
 < 0)

4252  
Ën
;

4253 ià(
	`¢d_£q_ev_is_ump
(
ev
è|| !
	`¢d_£q_ev_is_v¬ŸbË
(ev)) {

4254 
buf
 = 
ev
;

4256 ià(
	`®loc_tmpbuf
(
£q
, (
size_t
)
Ën
) < 0)

4257  -
ENOMEM
;

4258 *
£q
->
tmpbuf
 = *
ev
;

4259 
	`memıy
(
£q
->
tmpbuf
 + 1, 
ev
->
d©a
.
ext
.
±r
,ƒv->d©a.ext.
Ën
);

4260 
buf
 = 
£q
->
tmpbuf
;

4262  
£q
->
İs
->
	`wr™e
(£q, 
buf
, (
size_t
è
Ën
);

4263 
	}
}

4272 
	$¢d_£q_ev’t_ouut_³ndšg
(
¢d_£q_t
 *
£q
)

4274 
	`as£¹
(
£q
);

4275  
£q
->
obufu£d
;

4276 
	}
}

4293 
	$¢d_£q_d¿š_ouut
(
¢d_£q_t
 *
£q
)

4295 
ssize_t
 
»suÉ
, 
´oûs£d
 = 0;

4296 
	`as£¹
(
£q
);

4297 
£q
->
obufu£d
 > 0) {

4298 
»suÉ
 = 
£q
->
İs
->
	`wr™e
(£q, seq->
obuf
, seq->
obufu£d
);

4299 ià(
»suÉ
 < 0) {

4300 ià(
»suÉ
 =ğ-
EAGAIN
 && 
´oûs£d
)

4301  
£q
->
obufu£d
;

4302  
»suÉ
;

4304 ià((
size_t
)
»suÉ
 < 
£q
->
obufu£d
)

4305 
	`memmove
(
£q
->
obuf
, seq->obuà+ 
»suÉ
, seq->
obufu£d
 -„esult);

4306 
£q
->
obufu£d
 -ğ
»suÉ
;

4309 
	}
}

4322 
	$¢d_£q_exŒaù_ouut
(
¢d_£q_t
 *
£q
, 
¢d_£q_ev’t_t
 **
ev_»s
)

4324 
size_t
 
Ën
, 
Ş’
;

4325 
	`as£¹
(
£q
);

4326 ià(
ev_»s
)

4327 *
ev_»s
 = 
NULL
;

4328 ià((
Ş’
 = 
£q
->
obufu£d
è< (
¢d_£q_ev’t_t
))

4329  -
ENOENT
;

4330 
Ën
 = 
	`¢d_£q_ev’t_Ëngth
((
¢d_£q_ev’t_t
 *)
£q
->
obuf
);

4331 ià(
Ş’
 < 
Ën
)

4332  -
ENOENT
;

4333 ià(
ev_»s
) {

4335 ià(
	`®loc_tmpbuf
(
£q
, 
Ën
) < 0)

4336  -
ENOMEM
;

4337 
	`memıy
(
£q
->
tmpbuf
, seq->
obuf
, 
Ën
);

4338 *
ev_»s
 = (
¢d_£q_ev’t_t
 *)
£q
->
tmpbuf
;

4340 
£q
->
obufu£d
 = 
Ş’
 - 
Ën
;

4341 
	`memmove
(
£q
->
obuf
, seq->obuà+ 
Ën
, seq->
obufu£d
);

4343 
	}
}

4354 
ssize_t
 
	$¢d_£q_ev’t_»ad_bufãr
(
¢d_£q_t
 *
£q
)

4356 
size_t
 
·ck‘_size
 = 
	`g‘_·ck‘_size
(
£q
);

4357 
ssize_t
 
Ën
;

4359 
Ën
 = (
£q
->
İs
->
»ad
)(£q, seq->
ibuf
, seq->
ibufsize
 * 
·ck‘_size
);

4360 ià(
Ën
 < 0)

4361  
Ën
;

4362 
£q
->
ibuæ’
 = 
Ën
 / 
·ck‘_size
;

4363 
£q
->
ibuåŒ
 = 0;

4364  
£q
->
ibuæ’
;

4365 
	}
}

4367 
	$¢d_£q_ev’t_»Œ›ve_bufãr
(
¢d_£q_t
 *
£q
, 
¢d_£q_ev’t_t
 **
»
)

4369 
size_t
 
·ck‘_size
 = 
	`g‘_·ck‘_size
(
£q
);

4370 
size_t
 
nûÎs
;

4371 
¢d_£q_ev’t_t
 *
ev
;

4373 *
»
 = 
ev
 = (
¢d_£q_ev’t_t
 *)(
£q
->
ibuf
 + seq->
ibuåŒ
 * 
·ck‘_size
);

4374 
	`ş—r_ump_fÜ_Ëgacy_­ps
(
£q
, 
ev
);

4375 
£q
->
ibuåŒ
++;

4376 
£q
->
ibuæ’
--;

4377 ià(! 
	`¢d_£q_ev_is_v¬ŸbË
(
ev
))

4379 
nûÎs
 = (
ev
->
d©a
.
ext
.
Ën
 + 
·ck‘_size
 - 1) /…acket_size;

4380 ià(
£q
->
ibuæ’
 < 
nûÎs
) {

4381 
£q
->
ibuæ’
 = 0;

4382 *
»
 = 
NULL
;

4383  -
EINVAL
;

4385 
ev
->
d©a
.
ext
.
±r
 = (*ëv + 
·ck‘_size
;

4386 
£q
->
ibuæ’
 -ğ
nûÎs
;

4387 
£q
->
ibuåŒ
 +ğ
nûÎs
;

4389 
	}
}

4421 
	$¢d_£q_ev’t_šput
(
¢d_£q_t
 *
£q
, 
¢d_£q_ev’t_t
 **
ev
)

4423 
”r
;

4424 
	`as£¹
(
£q
);

4425 *
ev
 = 
NULL
;

4426 ià(
£q
->
ibuæ’
 <= 0) {

4427 ià((
”r
 = 
	`¢d_£q_ev’t_»ad_bufãr
(
£q
)) < 0)

4428  
”r
;

4431  
	`¢d_£q_ev’t_»Œ›ve_bufãr
(
£q
, 
ev
);

4432 
	}
}

4437 
	$¢d_£q_ev’t_šput_ãed
(
¢d_£q_t
 *
£q
, 
timeout
)

4439 
pŞlfd
 
pfd
;

4440 
”r
;

4441 
pfd
.
fd
 = 
£q
->
pŞl_fd
;

4442 
pfd
.
ev’ts
 = 
POLLIN
;

4443 
”r
 = 
	`pŞl
(&
pfd
, 1, 
timeout
);

4444 ià(
”r
 < 0) {

4445 
	`SYSERR
("poll");

4446  -
”ºo
;

4448 ià(
pfd
.
»v’ts
 & 
POLLIN
)

4449  
	`¢d_£q_ev’t_»ad_bufãr
(
£q
);

4450  
£q
->
ibuæ’
;

4451 
	}
}

4468 
	$¢d_£q_ev’t_šput_³ndšg
(
¢d_£q_t
 *
£q
, 
ãtch_£qu’ûr
)

4470 ià(
£q
->
ibuæ’
 =ğ0 && 
ãtch_£qu’ûr
) {

4471  
	`¢d_£q_ev’t_šput_ãed
(
£q
, 0);

4473  
£q
->
ibuæ’
;

4474 
	}
}

4500 
	$¢d_£q_ump_ev’t_ouut
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_ev’t_t
 *
ev
)

4502 ià(!
£q
->
midi_v”siÚ
)

4503  -
EBADFD
;

4504  
	`¢d_£q_ev’t_ouut
(
£q
, (
¢d_£q_ev’t_t
 *)
ev
);

4505 
	}
}

4517 
	$¢d_£q_ump_ev’t_ouut_bufãr
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_ev’t_t
 *
ev
)

4519 ià(!
£q
->
midi_v”siÚ
)

4520  -
EBADFD
;

4521  
	`¢d_£q_ev’t_ouut_bufãr
(
£q
, (
¢d_£q_ev’t_t
 *)
ev
);

4522 
	}
}

4534 
	$¢d_£q_ump_exŒaù_ouut
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_ev’t_t
 **
ev_»s
)

4536 ià(!
£q
->
midi_v”siÚ
)

4537  -
EBADFD
;

4538  
	`¢d_£q_exŒaù_ouut
(
£q
, (
¢d_£q_ev’t_t
 **)
ev_»s
);

4539 
	}
}

4551 
	$¢d_£q_ump_ev’t_ouut_dœeù
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_ev’t_t
 *
ev
)

4553 ià(!
£q
->
midi_v”siÚ
)

4554  -
EBADFD
;

4555  
	`¢d_£q_ev’t_ouut_dœeù
(
£q
, (
¢d_£q_ev’t_t
 *)
ev
);

4556 
	}
}

4574 
	$¢d_£q_ump_ev’t_šput
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_ev’t_t
 **
ev
)

4576 ià(!
£q
->
midi_v”siÚ
)

4577  -
EBADFD
;

4578  
	`¢d_£q_ev’t_šput
(
£q
, (
¢d_£q_ev’t_t
 **)
ev
);

4579 
	}
}

4597 
	$¢d_£q_drİ_ouut_bufãr
(
¢d_£q_t
 *
£q
)

4599 
	`as£¹
(
£q
);

4600 
£q
->
obufu£d
 = 0;

4602 
	}
}

4610 
	$¢d_£q_drİ_šput_bufãr
(
¢d_£q_t
 *
£q
)

4612 
	`as£¹
(
£q
);

4613 
£q
->
ibuåŒ
 = 0;

4614 
£q
->
ibuæ’
 = 0;

4616 
	}
}

4627 
	$¢d_£q_drİ_ouut
(
¢d_£q_t
 *
£q
)

4629 
¢d_£q_»move_ev’ts_t
 
rmšfo
;

4630 
	`as£¹
(
£q
);

4632 
	`mem£t
(&
rmšfo
, 0, (rminfo));

4633 
rmšfo
.
»move_mode
 = 
SNDRV_SEQ_REMOVE_OUTPUT
;

4635  
	`¢d_£q_»move_ev’ts
(
£q
, &
rmšfo
);

4636 
	}
}

4644 
	$¢d_£q_drİ_šput
(
¢d_£q_t
 *
£q
)

4646 
¢d_£q_»move_ev’ts_t
 
rmšfo
;

4647 
	`as£¹
(
£q
);

4649 
	`mem£t
(&
rmšfo
, 0, (rminfo));

4650 
rmšfo
.
»move_mode
 = 
SNDRV_SEQ_REMOVE_INPUT
;

4652  
	`¢d_£q_»move_ev’ts
(
£q
, &
rmšfo
);

4653 
	}
}

4660 
size_t
 
	$¢d_£q_»move_ev’ts_sizeof
()

4662  (
¢d_£q_»move_ev’ts_t
);

4663 
	}
}

4670 
	$¢d_£q_»move_ev’ts_m®loc
(
¢d_£q_»move_ev’ts_t
 **
±r
)

4672 
	`as£¹
(
±r
);

4673 *
±r
 = 
	`ÿÎoc
(1, (
¢d_£q_»move_ev’ts_t
));

4674 ià(!*
±r
)

4675  -
ENOMEM
;

4677 
	}
}

4683 
	$¢d_£q_»move_ev’ts_ä“
(
¢d_£q_»move_ev’ts_t
 *
obj
)

4685 
	`ä“
(
obj
);

4686 
	}
}

4693 
	$¢d_£q_»move_ev’ts_cİy
(
¢d_£q_»move_ev’ts_t
 *
d¡
, cÚ¡ snd_£q_»move_ev’ts_ˆ*
¤c
)

4695 
	`as£¹
(
d¡
 && 
¤c
);

4696 *
d¡
 = *
¤c
;

4697 
	}
}

4707 
	$¢d_£q_»move_ev’ts_g‘_cÚd™iÚ
(cÚ¡ 
¢d_£q_»move_ev’ts_t
 *
šfo
)

4709 
	`as£¹
(
šfo
);

4710  
šfo
->
»move_mode
;

4711 
	}
}

4720 
	$¢d_£q_»move_ev’ts_g‘_queue
(cÚ¡ 
¢d_£q_»move_ev’ts_t
 *
šfo
)

4722 
	`as£¹
(
šfo
);

4723  
šfo
->
queue
;

4724 
	}
}

4733 cÚ¡ 
¢d_£q_time¡amp_t
 *
	$¢d_£q_»move_ev’ts_g‘_time
(cÚ¡ 
¢d_£q_»move_ev’ts_t
 *
šfo
)

4735 
	`as£¹
(
šfo
);

4736  (cÚ¡ 
¢d_£q_time¡amp_t
 *)&
šfo
->
time
;

4737 
	}
}

4746 cÚ¡ 
¢d_£q_addr_t
 *
	$¢d_£q_»move_ev’ts_g‘_de¡
(cÚ¡ 
¢d_£q_»move_ev’ts_t
 *
šfo
)

4748 
	`as£¹
(
šfo
);

4749  (cÚ¡ 
¢d_£q_addr_t
 *)&
šfo
->
de¡
;

4750 
	}
}

4759 
	$¢d_£q_»move_ev’ts_g‘_chªÃl
(cÚ¡ 
¢d_£q_»move_ev’ts_t
 *
šfo
)

4761 
	`as£¹
(
šfo
);

4762  
šfo
->
chªÃl
;

4763 
	}
}

4772 
	$¢d_£q_»move_ev’ts_g‘_ev’t_ty³
(cÚ¡ 
¢d_£q_»move_ev’ts_t
 *
šfo
)

4774 
	`as£¹
(
šfo
);

4775  
šfo
->
ty³
;

4776 
	}
}

4785 
	$¢d_£q_»move_ev’ts_g‘_g
(cÚ¡ 
¢d_£q_»move_ev’ts_t
 *
šfo
)

4787 
	`as£¹
(
šfo
);

4788  
šfo
->
g
;

4789 
	}
}

4798 
	$¢d_£q_»move_ev’ts_£t_cÚd™iÚ
(
¢d_£q_»move_ev’ts_t
 *
šfo
, 
æags
)

4800 
	`as£¹
(
šfo
);

4801 
šfo
->
»move_mode
 = 
æags
;

4802 
	}
}

4811 
	$¢d_£q_»move_ev’ts_£t_queue
(
¢d_£q_»move_ev’ts_t
 *
šfo
, 
queue
)

4813 
	`as£¹
(
šfo
);

4814 
šfo
->
queue
 = queue;

4815 
	}
}

4824 
	$¢d_£q_»move_ev’ts_£t_time
(
¢d_£q_»move_ev’ts_t
 *
šfo
, cÚ¡ 
¢d_£q_time¡amp_t
 *
time
)

4826 
	`as£¹
(
šfo
);

4827 
šfo
->
time
 = *(cÚ¡ 
¢drv_£q_time¡amp
 *)time;

4828 
	}
}

4837 
	$¢d_£q_»move_ev’ts_£t_de¡
(
¢d_£q_»move_ev’ts_t
 *
šfo
, cÚ¡ 
¢d_£q_addr_t
 *
addr
)

4839 
	`as£¹
(
šfo
);

4840 
šfo
->
de¡
 = *(cÚ¡ 
¢drv_£q_addr
 *)
addr
;

4841 
	}
}

4850 
	$¢d_£q_»move_ev’ts_£t_chªÃl
(
¢d_£q_»move_ev’ts_t
 *
šfo
, 
chªÃl
)

4852 
	`as£¹
(
šfo
);

4853 
šfo
->
chªÃl
 = channel;

4854 
	}
}

4863 
	$¢d_£q_»move_ev’ts_£t_ev’t_ty³
(
¢d_£q_»move_ev’ts_t
 *
šfo
, 
ty³
)

4865 
	`as£¹
(
šfo
);

4866 
šfo
->
ty³
 =ype;

4867 
	}
}

4876 
	$¢d_£q_»move_ev’ts_£t_g
(
¢d_£q_»move_ev’ts_t
 *
šfo
, 
g
)

4878 
	`as£¹
(
šfo
);

4879 
šfo
->
g
 =ag;

4880 
	}
}

4885 
šlše
 
	$¢d_£q_com·»_tick_time
(
¢d_£q_tick_time_t
 *
a
, snd_£q_tick_time_ˆ*
b
)

4888  (*
a
 >ğ*
b
);

4889 
	}
}

4891 
šlše
 
	$¢d_£q_com·»_»®_time
(
¢d_£q_»®_time_t
 *
a
, snd_£q_»®_time_ˆ*
b
)

4894 ià(
a
->
tv_£c
 > 
b
->tv_sec)

4896 ià((
a
->
tv_£c
 =ğ
b
->tv_£cè&& (a->
tv_n£c
 >= b->tv_nsec))

4899 
	}
}

4902 
	$»move_m©ch
(
¢d_£q_»move_ev’ts_t
 *
šfo
, 
¢d_£q_ev’t_t
 *
ev
)

4904 
»s
;

4906 ià(
šfo
->
»move_mode
 & 
SNDRV_SEQ_REMOVE_DEST
) {

4907 ià(
ev
->
de¡
.
ş›Á
 !ğ
šfo
->dest.client ||

4908 
ev
->
de¡
.
pÜt
 !ğ
šfo
->dest.port)

4911 ià(
šfo
->
»move_mode
 & 
SNDRV_SEQ_REMOVE_DEST_CHANNEL
) {

4912 ià(! 
	`¢d_£q_ev_is_chªÃl_ty³
(
ev
))

4915 ià(
ev
->
d©a
.
nÙe
.
chªÃl
 !ğ
šfo
->channel)

4918 ià(
šfo
->
»move_mode
 & 
SNDRV_SEQ_REMOVE_TIME_AFTER
) {

4919 ià(
šfo
->
»move_mode
 & 
SNDRV_SEQ_REMOVE_TIME_TICK
)

4920 
»s
 = 
	`¢d_£q_com·»_tick_time
(&
ev
->
time
.
tick
, &
šfo
->time.tick);

4922 
»s
 = 
	`¢d_£q_com·»_»®_time
(&
ev
->
time
.time, (
¢d_£q_»®_time_t
 *)&
šfo
->time.time);

4923 ià(!
»s
)

4926 ià(
šfo
->
»move_mode
 & 
SNDRV_SEQ_REMOVE_TIME_BEFORE
) {

4927 ià(
šfo
->
»move_mode
 & 
SNDRV_SEQ_REMOVE_TIME_TICK
)

4928 
»s
 = 
	`¢d_£q_com·»_tick_time
(&
ev
->
time
.
tick
, &
šfo
->time.tick);

4930 
»s
 = 
	`¢d_£q_com·»_»®_time
(&
ev
->
time
.time, (
¢d_£q_»®_time_t
 *)&
šfo
->time.time);

4931 ià(
»s
)

4934 ià(
šfo
->
»move_mode
 & 
SNDRV_SEQ_REMOVE_EVENT_TYPE
) {

4935 ià(
ev
->
ty³
 !ğ
šfo
->type)

4938 ià(
šfo
->
»move_mode
 & 
SNDRV_SEQ_REMOVE_IGNORE_OFF
) {

4940 
ev
->
ty³
) {

4941 
SND_SEQ_EVENT_NOTEOFF
:

4948 ià(
šfo
->
»move_mode
 & 
SNDRV_SEQ_REMOVE_TAG_MATCH
) {

4949 ià(
šfo
->
g
 !ğ
ev
->tag)

4954 
	}
}

4967 
	$¢d_£q_»move_ev’ts
(
¢d_£q_t
 *
£q
, 
¢d_£q_»move_ev’ts_t
 *
rmp
)

4969 ià(
rmp
->
»move_mode
 & 
SNDRV_SEQ_REMOVE_INPUT
) {

4974 
	`¢d_£q_drİ_šput_bufãr
(
£q
);

4977 ià(
rmp
->
»move_mode
 & 
SNDRV_SEQ_REMOVE_OUTPUT
) {

4982 ià(! (
rmp
->
»move_mode
 & ~(
SNDRV_SEQ_REMOVE_INPUT
|
SNDRV_SEQ_REMOVE_OUTPUT
))) {

4984 
	`¢d_£q_drİ_ouut_bufãr
(
£q
);

4986 *
•
;

4987 
size_t
 
Ën
;

4988 
¢d_£q_ev’t_t
 *
ev
;

4990 
•
 = 
£q
->
obuf
;

4991 
•
 - 
£q
->
obuf
 < (
ssize_t
)£q->
obufu£d
) {

4993 
ev
 = (
¢d_£q_ev’t_t
 *)
•
;

4994 
Ën
 = 
	`¢d_£q_ev’t_Ëngth
(
ev
);

4996 ià(
	`»move_m©ch
(
rmp
, 
ev
)) {

4998 
£q
->
obufu£d
 -ğ
Ën
;

4999 
	`memmove
(
•
,ƒ°+ 
Ën
, 
£q
->
obufu£d
 - (• - seq->
obuf
));

5001 
•
 +ğ
Ën
;

5007  
£q
->
İs
->
	`»move_ev’ts
(£q, 
rmp
);

5008 
	}
}

5020 
size_t
 
	$¢d_£q_ş›Á_poŞ_sizeof
()

5022  (
¢d_£q_ş›Á_poŞ_t
);

5023 
	}
}

5030 
	$¢d_£q_ş›Á_poŞ_m®loc
(
¢d_£q_ş›Á_poŞ_t
 **
±r
)

5032 
	`as£¹
(
±r
);

5033 *
±r
 = 
	`ÿÎoc
(1, (
¢d_£q_ş›Á_poŞ_t
));

5034 ià(!*
±r
)

5035  -
ENOMEM
;

5037 
	}
}

5043 
	$¢d_£q_ş›Á_poŞ_ä“
(
¢d_£q_ş›Á_poŞ_t
 *
obj
)

5045 
	`ä“
(
obj
);

5046 
	}
}

5053 
	$¢d_£q_ş›Á_poŞ_cİy
(
¢d_£q_ş›Á_poŞ_t
 *
d¡
, cÚ¡ snd_£q_ş›Á_poŞ_ˆ*
¤c
)

5055 
	`as£¹
(
d¡
 && 
¤c
);

5056 *
d¡
 = *
¤c
;

5057 
	}
}

5065 
	$¢d_£q_ş›Á_poŞ_g‘_ş›Á
(cÚ¡ 
¢d_£q_ş›Á_poŞ_t
 *
šfo
)

5067 
	`as£¹
(
šfo
);

5068  
šfo
->
ş›Á
;

5069 
	}
}

5076 
size_t
 
	$¢d_£q_ş›Á_poŞ_g‘_ouut_poŞ
(cÚ¡ 
¢d_£q_ş›Á_poŞ_t
 *
šfo
)

5078 
	`as£¹
(
šfo
);

5079  
šfo
->
ouut_poŞ
;

5080 
	}
}

5087 
size_t
 
	$¢d_£q_ş›Á_poŞ_g‘_šput_poŞ
(cÚ¡ 
¢d_£q_ş›Á_poŞ_t
 *
šfo
)

5089 
	`as£¹
(
šfo
);

5090  
šfo
->
šput_poŞ
;

5091 
	}
}

5098 
size_t
 
	$¢d_£q_ş›Á_poŞ_g‘_ouut_room
(cÚ¡ 
¢d_£q_ş›Á_poŞ_t
 *
šfo
)

5100 
	`as£¹
(
šfo
);

5101  
šfo
->
ouut_room
;

5102 
	}
}

5109 
size_t
 
	$¢d_£q_ş›Á_poŞ_g‘_ouut_ä“
(cÚ¡ 
¢d_£q_ş›Á_poŞ_t
 *
šfo
)

5111 
	`as£¹
(
šfo
);

5112  
šfo
->
ouut_ä“
;

5113 
	}
}

5120 
size_t
 
	$¢d_£q_ş›Á_poŞ_g‘_šput_ä“
(cÚ¡ 
¢d_£q_ş›Á_poŞ_t
 *
šfo
)

5122 
	`as£¹
(
šfo
);

5123  
šfo
->
šput_ä“
;

5124 
	}
}

5131 
	$¢d_£q_ş›Á_poŞ_£t_ouut_poŞ
(
¢d_£q_ş›Á_poŞ_t
 *
šfo
, 
size_t
 
size
)

5133 
	`as£¹
(
šfo
);

5134 
šfo
->
ouut_poŞ
 = 
size
;

5135 
	}
}

5142 
	$¢d_£q_ş›Á_poŞ_£t_šput_poŞ
(
¢d_£q_ş›Á_poŞ_t
 *
šfo
, 
size_t
 
size
)

5144 
	`as£¹
(
šfo
);

5145 
šfo
->
šput_poŞ
 = 
size
;

5146 
	}
}

5153 
	$¢d_£q_ş›Á_poŞ_£t_ouut_room
(
¢d_£q_ş›Á_poŞ_t
 *
šfo
, 
size_t
 
size
)

5155 
	`as£¹
(
šfo
);

5156 
šfo
->
ouut_room
 = 
size
;

5157 
	}
}

5165 
	$¢d_£q_g‘_ş›Á_poŞ
(
¢d_£q_t
 *
£q
, 
¢d_£q_ş›Á_poŞ_t
 *
šfo
)

5167 
	`as£¹
(
£q
 && 
šfo
);

5168 
šfo
->
ş›Á
 = 
£q
->client;

5169  
£q
->
İs
->
	`g‘_ş›Á_poŞ
(£q, 
šfo
);

5170 
	}
}

5180 
	$¢d_£q_£t_ş›Á_poŞ
(
¢d_£q_t
 *
£q
, 
¢d_£q_ş›Á_poŞ_t
 *
šfo
)

5182 
	`as£¹
(
£q
 && 
šfo
);

5183 
šfo
->
ş›Á
 = 
£q
->client;

5184  
£q
->
İs
->
	`£t_ş›Á_poŞ
(£q, 
šfo
);

5185 
	}
}

5196 
	$¢d_£q_£t_b™
(
Ä
, *
¬¿y
)

5198 ((*)
¬¿y
)[
Ä
 >> 5] |= 1UL << (nr & 31);

5199 
	}
}

5204 
	$¢d_£q_un£t_b™
(
Ä
, *
¬¿y
)

5206 ((*)
¬¿y
)[
Ä
 >> 5] &= ~(1UL << (nr & 31));

5207 
	}
}

5212 
	$¢d_£q_chªge_b™
(
Ä
, *
¬¿y
)

5214 
»suÉ
;

5216 
»suÉ
 = ((((*)
¬¿y
)[
Ä
 >> 5]) & (1UL << (nr & 31))) ? 1 : 0;

5217 ((*)
¬¿y
)[
Ä
 >> 5] ^= 1UL << (nr & 31);

5218  
»suÉ
;

5219 
	}
}

5224 
	$¢d_£q_g‘_b™
(
Ä
, *
¬¿y
)

5226  ((((*)
¬¿y
)[
Ä
 >> 5]) & (1UL << (nr & 31))) ? 1 : 0;

5227 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_event.c

8 
	~"loÿl.h
"

10 #iâdeà
DOC_HIDDEN


11 
	#FIXED_EV
(
x
è(
	`_SND_SEQ_TYPE
(
SND_SEQ_EVFLG_FIXED
è| _SND_SEQ_TYPE(x))

	)

15 cÚ¡ 
	g¢d_£q_ev’t_ty³s
[256] = {

16 [
SND_SEQ_EVENT_SYSTEM
 ... 
SND_SEQ_EVENT_RESULT
]

17 ğ
FIXED_EV
(
SND_SEQ_EVFLG_RESULT
),

18 [
SND_SEQ_EVENT_NOTE
]

19 ğ
FIXED_EV
(
SND_SEQ_EVFLG_NOTE
è| 
_SND_SEQ_TYPE_OPT
(
SND_SEQ_EVFLG_NOTE_TWOARG
),

20 [
SND_SEQ_EVENT_NOTEON
 ... 
SND_SEQ_EVENT_KEYPRESS
]

21 ğ
FIXED_EV
(
SND_SEQ_EVFLG_NOTE
),

22 [
SND_SEQ_EVENT_CONTROLLER
 ... 
SND_SEQ_EVENT_REGPARAM
]

23 ğ
FIXED_EV
(
SND_SEQ_EVFLG_CONTROL
),

24 [
SND_SEQ_EVENT_START
 ... 
SND_SEQ_EVENT_STOP
]

25 ğ
FIXED_EV
(
SND_SEQ_EVFLG_QUEUE
),

26 [
SND_SEQ_EVENT_SETPOS_TICK
]

27 ğ
FIXED_EV
(
SND_SEQ_EVFLG_QUEUE
è| 
_SND_SEQ_TYPE_OPT
(
SND_SEQ_EVFLG_QUEUE_TICK
),

28 [
SND_SEQ_EVENT_SETPOS_TIME
]

29 ğ
FIXED_EV
(
SND_SEQ_EVFLG_QUEUE
è| 
_SND_SEQ_TYPE_OPT
(
SND_SEQ_EVFLG_QUEUE_TIME
),

30 [
SND_SEQ_EVENT_TEMPO
 ... 
SND_SEQ_EVENT_SYNC_POS
]

31 ğ
FIXED_EV
(
SND_SEQ_EVFLG_QUEUE
è| 
_SND_SEQ_TYPE_OPT
(
SND_SEQ_EVFLG_QUEUE_VALUE
),

32 [
SND_SEQ_EVENT_TUNE_REQUEST
 ... 
SND_SEQ_EVENT_SENSING
]

33 ğ
FIXED_EV
(
SND_SEQ_EVFLG_NONE
),

34 [
SND_SEQ_EVENT_ECHO
 ... 
SND_SEQ_EVENT_OSS
]

35 ğ
FIXED_EV
(
SND_SEQ_EVFLG_RAW
è| FIXED_EV(
SND_SEQ_EVFLG_SYSTEM
),

36 [
SND_SEQ_EVENT_CLIENT_START
 ... 
SND_SEQ_EVENT_PORT_CHANGE
]

37 ğ
FIXED_EV
(
SND_SEQ_EVFLG_MESSAGE
),

38 [
SND_SEQ_EVENT_PORT_SUBSCRIBED
 ... 
SND_SEQ_EVENT_PORT_UNSUBSCRIBED
]

39 ğ
FIXED_EV
(
SND_SEQ_EVFLG_CONNECTION
),

40 [
SND_SEQ_EVENT_USR0
 ... 
SND_SEQ_EVENT_USR9
]

41 ğ
FIXED_EV
(
SND_SEQ_EVFLG_RAW
è| FIXED_EV(
SND_SEQ_EVFLG_USERS
),

42 [
SND_SEQ_EVENT_SYSEX
 ... 
SND_SEQ_EVENT_BOUNCE
]

43 ğ
_SND_SEQ_TYPE
(
SND_SEQ_EVFLG_VARIABLE
),

44 [
SND_SEQ_EVENT_USR_VAR0
 ... 
SND_SEQ_EVENT_USR_VAR4
]

45 ğ
_SND_SEQ_TYPE
(
SND_SEQ_EVFLG_VARIABLE
è| _SND_SEQ_TYPE(
SND_SEQ_EVFLG_USERS
),

46 [
SND_SEQ_EVENT_NONE
]

47 ğ
FIXED_EV
(
SND_SEQ_EVFLG_NONE
),

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_hw.c

23 
	~"£q_loÿl.h
"

24 
	~<fú.h
>

25 
	~<sys/ioùl.h
>

27 #iâdeà
PIC


29 cÚ¡ *
	g_¢d_moduË_£q_hw
 = "";

32 #iâdeà
DOC_HIDDEN


33 
	#SNDRV_FILE_SEQ
 
ALSA_DEVICE_DIRECTORY
 "£q"

	)

34 
	#SNDRV_FILE_ALOADSEQ
 
ALOAD_DEVICE_DIRECTORY
 "®ßdSEQ"

	)

37 
	mfd
;

38 
	mv”siÚ
;

39 } 
	t¢d_£q_hw_t
;

42 
	$¢d_£q_hw_şo£
(
¢d_£q_t
 *
£q
)

44 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

45 
”r
 = 0;

47 ià(
	`şo£
(
hw
->
fd
)) {

48 
”r
 = -
”ºo
;

49 
	`SYSERR
("close failed\n");

51 
	`ä“
(
hw
);

52  
”r
;

53 
	}
}

55 
	$¢d_£q_hw_nÚblock
(
¢d_£q_t
 *
£q
, 
nÚblock
)

57 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

58 
æags
;

60 ià((
æags
 = 
	`fú
(
hw
->
fd
, 
F_GETFL
)) < 0) {

61 
	`SYSERR
("F_GETFL failed");

62  -
”ºo
;

64 ià(
nÚblock
)

65 
æags
 |ğ
O_NONBLOCK
;

67 
æags
 &ğ~
O_NONBLOCK
;

68 ià(
	`fú
(
hw
->
fd
, 
F_SETFL
, 
æags
) < 0) {

69 
	`SYSERR
("F_SETFL for O_NONBLOCK failed");

70  -
”ºo
;

73 
	}
}

75 
	$¢d_£q_hw_ş›Á_id
(
¢d_£q_t
 *
£q
)

77 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

78 
ş›Á
;

79 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_CLIENT_ID
, &
ş›Á
) < 0) {

80 
	`SYSERR
("SNDRV_SEQ_IOCTL_CLIENT_ID failed");

81  -
”ºo
;

83  
ş›Á
;

84 
	}
}

86 
	$¢d_£q_hw_sy¡em_šfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_sy¡em_šfo_t
 * 
šfo
)

88 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

89 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SYSTEM_INFO
, 
šfo
) < 0) {

90 
	`SYSERR
("SNDRV_SEQ_IOCTL_SYSTEM_INFO failed");

91  -
”ºo
;

94 
	}
}

96 
	$upd©e_midi_v”siÚ
(
¢d_£q_t
 *
£q
, 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

98 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

100 ià(
	`SNDRV_PROTOCOL_VERSION
(1, 0, 3è<ğ
hw
->
v”siÚ
 &&

101 
£q
->
midi_v”siÚ
 !ğ()
šfo
->midi_version) {

102 
£q
->
midi_v”siÚ
 = 
šfo
->midi_version;

103 ià(
šfo
->
midi_v”siÚ
 > 0)

104 
£q
->
·ck‘_size
 = (
¢d_£q_ump_ev’t_t
);

106 
£q
->
·ck‘_size
 = (
¢d_£q_ev’t_t
);

108 
	}
}

110 
	$¢d_£q_hw_g‘_ş›Á_šfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_ş›Á_šfo_t
 * 
šfo
)

112 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

113 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_CLIENT_INFO
, 
šfo
) < 0) {

115  -
”ºo
;

117 ià(
hw
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 2)) {

118 
šfo
->
ÿrd
 = -1;

119 
šfo
->
pid
 = -1;

122 
	}
}

124 
	$¢d_£q_hw_£t_ş›Á_šfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_ş›Á_šfo_t
 * 
šfo
)

126 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

128 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_CLIENT_INFO
, 
šfo
) < 0) {

130  -
”ºo
;

132 
	`upd©e_midi_v”siÚ
(
£q
, 
šfo
);

134 
	}
}

136 
	$¢d_£q_hw_g‘_ump_šfo
(
¢d_£q_t
 *
£q
, 
ş›Á
, 
ty³
, *
šfo
)

138 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

139 
¢d_£q_ş›Á_ump_šfo
 
buf
;

140 
size_t
 
size
;

142 ià(
ty³
 < 0 ||y³ >ğ
SNDRV_SEQ_CLIENT_UMP_INFO_BLOCK
 + 32)

143  -
EINVAL
;

144 ià(
hw
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 3))

145  -
ENOTTY
;

146 ià(
ty³
 =ğ
SNDRV_SEQ_CLIENT_UMP_INFO_ENDPOINT
)

147 
size
 = (
¢d_ump_’dpošt_šfo
);

149 
size
 = (
¢d_ump_block_šfo
);

150 
buf
.
ş›Á
 = client;

151 
buf
.
ty³
 =ype;

152 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_CLIENT_UMP_INFO
, &
buf
) < 0)

153  -
”ºo
;

154 
	`memıy
(
šfo
, 
buf
.šfo, 
size
);

156 
	}
}

158 
	$¢d_£q_hw_£t_ump_šfo
(
¢d_£q_t
 *
£q
, 
ty³
, cÚ¡ *
šfo
)

160 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

161 
¢d_£q_ş›Á_ump_šfo
 
buf
;

162 
size_t
 
size
;

164 ià(
ty³
 < 0 ||y³ >ğ
SNDRV_SEQ_CLIENT_UMP_INFO_BLOCK
 + 32)

165  -
EINVAL
;

166 ià(
hw
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 3))

167  -
ENOTTY
;

168 ià(
ty³
 =ğ
SNDRV_SEQ_CLIENT_UMP_INFO_ENDPOINT
)

169 
size
 = (
¢d_ump_’dpošt_šfo
);

171 
size
 = (
¢d_ump_block_šfo
);

172 
buf
.
ş›Á
 = 
£q
->client;

173 
buf
.
ty³
 =ype;

174 
	`memıy
(
buf
.
šfo
, info, 
size
);

175 *(*)
buf
.
šfo
 = -1;

176 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_CLIENT_UMP_INFO
, &
buf
) < 0)

177  -
”ºo
;

179 
	}
}

181 
	$¢d_£q_hw_ü—‹_pÜt
(
¢d_£q_t
 *
£q
, 
¢d_£q_pÜt_šfo_t
 * 
pÜt
)

183 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

184 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_CREATE_PORT
, 
pÜt
) < 0) {

186  -
”ºo
;

189 
	}
}

191 
	$¢d_£q_hw_d–‘e_pÜt
(
¢d_£q_t
 *
£q
, 
¢d_£q_pÜt_šfo_t
 * 
pÜt
)

193 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

194 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_DELETE_PORT
, 
pÜt
) < 0) {

196  -
”ºo
;

199 
	}
}

201 
	$¢d_£q_hw_g‘_pÜt_šfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_pÜt_šfo_t
 * 
šfo
)

203 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

204 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_PORT_INFO
, 
šfo
) < 0) {

206  -
”ºo
;

209 
	}
}

211 
	$¢d_£q_hw_£t_pÜt_šfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_pÜt_šfo_t
 * 
šfo
)

213 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

214 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_PORT_INFO
, 
šfo
) < 0) {

216  -
”ºo
;

219 
	}
}

221 
	$¢d_£q_hw_g‘_pÜt_subsütiÚ
(
¢d_£q_t
 *
£q
, 
¢d_£q_pÜt_subsüibe_t
 * 
sub
)

223 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

224 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_SUBSCRIPTION
, 
sub
) < 0) {

226  -
”ºo
;

229 
	}
}

231 
	$¢d_£q_hw_subsüibe_pÜt
(
¢d_£q_t
 *
£q
, 
¢d_£q_pÜt_subsüibe_t
 * 
sub
)

233 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

234 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SUBSCRIBE_PORT
, 
sub
) < 0) {

236  -
”ºo
;

239 
	}
}

241 
	$¢d_£q_hw_unsubsüibe_pÜt
(
¢d_£q_t
 *
£q
, 
¢d_£q_pÜt_subsüibe_t
 * 
sub
)

243 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

244 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_UNSUBSCRIBE_PORT
, 
sub
) < 0) {

246  -
”ºo
;

249 
	}
}

251 
	$¢d_£q_hw_qu”y_pÜt_subsüib”s
(
¢d_£q_t
 *
£q
, 
¢d_£q_qu”y_subsüibe_t
 * 
subs
)

253 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

254 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_QUERY_SUBS
, 
subs
) < 0) {

256  -
”ºo
;

259 
	}
}

261 
	$¢d_£q_hw_g‘_queue_¡©us
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_¡©us_t
 * 
¡©us
)

263 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

264 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_QUEUE_STATUS
, 
¡©us
) < 0) {

266  -
”ºo
;

269 
	}
}

271 
	$¢d_£q_hw_g‘_queue_‹mpo
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_‹mpo_t
 * 
‹mpo
)

273 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

274 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_QUEUE_TEMPO
, 
‹mpo
) < 0) {

276  -
”ºo
;

279 
	}
}

281 
	$¢d_£q_hw_£t_queue_‹mpo
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_‹mpo_t
 * 
‹mpo
)

283 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

284 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_QUEUE_TEMPO
, 
‹mpo
) < 0) {

286  -
”ºo
;

289 
	}
}

291 
	$¢d_£q_hw_g‘_queue_tim”
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_tim”_t
 * 
tim”
)

293 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

294 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_QUEUE_TIMER
, 
tim”
) < 0) {

296  -
”ºo
;

299 
	}
}

301 
	$¢d_£q_hw_£t_queue_tim”
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_tim”_t
 * 
tim”
)

303 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

304 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_QUEUE_TIMER
, 
tim”
) < 0) {

306  -
”ºo
;

309 
	}
}

311 
	$¢d_£q_hw_g‘_queue_ş›Á
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_ş›Á_t
 * 
šfo
)

313 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

314 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_QUEUE_CLIENT
, 
šfo
) < 0) {

316  -
”ºo
;

319 
	}
}

321 
	$¢d_£q_hw_£t_queue_ş›Á
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_ş›Á_t
 * 
šfo
)

323 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

324 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_QUEUE_CLIENT
, 
šfo
) < 0) {

326  -
”ºo
;

329 
	}
}

331 
	$¢d_£q_hw_ü—‹_queue
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_šfo_t
 *
šfo
)

333 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

334 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_CREATE_QUEUE
, 
šfo
) < 0) {

336  -
”ºo
;

339 
	}
}

341 
	$¢d_£q_hw_d–‘e_queue
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_šfo_t
 *
šfo
)

343 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

344 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_DELETE_QUEUE
, 
šfo
) < 0) {

346  -
”ºo
;

349 
	}
}

351 
	$¢d_£q_hw_g‘_queue_šfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_šfo_t
 *
šfo
)

353 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

354 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_QUEUE_INFO
, 
šfo
) < 0) {

356  -
”ºo
;

359 
	}
}

361 
	$¢d_£q_hw_£t_queue_šfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_šfo_t
 *
šfo
)

363 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

364 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_QUEUE_INFO
, 
šfo
) < 0) {

366  -
”ºo
;

369 
	}
}

371 
	$¢d_£q_hw_g‘_Çmed_queue
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_šfo_t
 *
šfo
)

373 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

374 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_NAMED_QUEUE
, 
šfo
) < 0) {

376  -
”ºo
;

379 
	}
}

381 
ssize_t
 
	$¢d_£q_hw_wr™e
(
¢d_£q_t
 *
£q
, *
buf
, 
size_t
 
Ën
)

383 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

384 
ssize_t
 
»suÉ
 = 
	`wr™e
(
hw
->
fd
, 
buf
, 
Ën
);

385 ià(
»suÉ
 < 0)

386  -
”ºo
;

387  
»suÉ
;

388 
	}
}

390 
ssize_t
 
	$¢d_£q_hw_»ad
(
¢d_£q_t
 *
£q
, *
buf
, 
size_t
 
Ën
)

392 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

393 
ssize_t
 
»suÉ
 = 
	`»ad
(
hw
->
fd
, 
buf
, 
Ën
);

394 ià(
»suÉ
 < 0)

395  -
”ºo
;

396  
»suÉ
;

397 
	}
}

399 
	$¢d_£q_hw_»move_ev’ts
(
¢d_£q_t
 *
£q
, 
¢d_£q_»move_ev’ts_t
 *
rmp
)

401 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

402 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_REMOVE_EVENTS
, 
rmp
) < 0) {

404  -
”ºo
;

407 
	}
}

409 
	$¢d_£q_hw_g‘_ş›Á_poŞ
(
¢d_£q_t
 *
£q
, 
¢d_£q_ş›Á_poŞ_t
 *
šfo
)

411 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

412 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_CLIENT_POOL
, 
šfo
) < 0) {

414  -
”ºo
;

417 
	}
}

419 
	$¢d_£q_hw_£t_ş›Á_poŞ
(
¢d_£q_t
 *
£q
, 
¢d_£q_ş›Á_poŞ_t
 *
šfo
)

421 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

422 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_CLIENT_POOL
, 
šfo
) < 0) {

424  -
”ºo
;

427 
	}
}

429 
	$¢d_£q_hw_qu”y_Ãxt_ş›Á
(
¢d_£q_t
 *
£q
, 
¢d_£q_ş›Á_šfo_t
 *
šfo
)

431 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

432 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_QUERY_NEXT_CLIENT
, 
šfo
) < 0) {

434  -
”ºo
;

436 ià(
hw
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 2)) {

437 
šfo
->
ÿrd
 = -1;

438 
šfo
->
pid
 = -1;

441 
	}
}

443 
	$¢d_£q_hw_qu”y_Ãxt_pÜt
(
¢d_£q_t
 *
£q
, 
¢d_£q_pÜt_šfo_t
 *
šfo
)

445 
¢d_£q_hw_t
 *
hw
 = 
£q
->
´iv©e_d©a
;

446 ià(
	`ioùl
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_QUERY_NEXT_PORT
, 
šfo
) < 0) {

448  -
”ºo
;

451 
	}
}

453 cÚ¡ 
¢d_£q_İs_t
 
	g¢d_£q_hw_İs
 = {

454 .
şo£
 = 
¢d_£q_hw_şo£
,

455 .
	gnÚblock
 = 
¢d_£q_hw_nÚblock
,

456 .
	gsy¡em_šfo
 = 
¢d_£q_hw_sy¡em_šfo
,

457 .
	gg‘_ş›Á_šfo
 = 
¢d_£q_hw_g‘_ş›Á_šfo
,

458 .
	g£t_ş›Á_šfo
 = 
¢d_£q_hw_£t_ş›Á_šfo
,

459 .
	gg‘_ump_šfo
 = 
¢d_£q_hw_g‘_ump_šfo
,

460 .
	g£t_ump_šfo
 = 
¢d_£q_hw_£t_ump_šfo
,

461 .
	gü—‹_pÜt
 = 
¢d_£q_hw_ü—‹_pÜt
,

462 .
	gd–‘e_pÜt
 = 
¢d_£q_hw_d–‘e_pÜt
,

463 .
	gg‘_pÜt_šfo
 = 
¢d_£q_hw_g‘_pÜt_šfo
,

464 .
	g£t_pÜt_šfo
 = 
¢d_£q_hw_£t_pÜt_šfo
,

465 .
	gg‘_pÜt_subsütiÚ
 = 
¢d_£q_hw_g‘_pÜt_subsütiÚ
,

466 .
	gsubsüibe_pÜt
 = 
¢d_£q_hw_subsüibe_pÜt
,

467 .
	gunsubsüibe_pÜt
 = 
¢d_£q_hw_unsubsüibe_pÜt
,

468 .
	gqu”y_pÜt_subsüib”s
 = 
¢d_£q_hw_qu”y_pÜt_subsüib”s
,

469 .
	gg‘_queue_¡©us
 = 
¢d_£q_hw_g‘_queue_¡©us
,

470 .
	gg‘_queue_‹mpo
 = 
¢d_£q_hw_g‘_queue_‹mpo
,

471 .
	g£t_queue_‹mpo
 = 
¢d_£q_hw_£t_queue_‹mpo
,

472 .
	gg‘_queue_tim”
 = 
¢d_£q_hw_g‘_queue_tim”
,

473 .
	g£t_queue_tim”
 = 
¢d_£q_hw_£t_queue_tim”
,

474 .
	gg‘_queue_ş›Á
 = 
¢d_£q_hw_g‘_queue_ş›Á
,

475 .
	g£t_queue_ş›Á
 = 
¢d_£q_hw_£t_queue_ş›Á
,

476 .
	gü—‹_queue
 = 
¢d_£q_hw_ü—‹_queue
,

477 .
	gd–‘e_queue
 = 
¢d_£q_hw_d–‘e_queue
,

478 .
	gg‘_queue_šfo
 = 
¢d_£q_hw_g‘_queue_šfo
,

479 .
	g£t_queue_šfo
 = 
¢d_£q_hw_£t_queue_šfo
,

480 .
	gg‘_Çmed_queue
 = 
¢d_£q_hw_g‘_Çmed_queue
,

481 .
	gwr™e
 = 
¢d_£q_hw_wr™e
,

482 .
	g»ad
 = 
¢d_£q_hw_»ad
,

483 .
	g»move_ev’ts
 = 
¢d_£q_hw_»move_ev’ts
,

484 .
	gg‘_ş›Á_poŞ
 = 
¢d_£q_hw_g‘_ş›Á_poŞ
,

485 .
	g£t_ş›Á_poŞ
 = 
¢d_£q_hw_£t_ş›Á_poŞ
,

486 .
	gqu”y_Ãxt_ş›Á
 = 
¢d_£q_hw_qu”y_Ãxt_ş›Á
,

487 .
	gqu”y_Ãxt_pÜt
 = 
¢d_£q_hw_qu”y_Ãxt_pÜt
,

490 
	$¢d_£q_hw_İ’
(
¢d_£q_t
 **
hªdË
, cÚ¡ *
Çme
, 
¡»ams
, 
mode
)

492 
fd
, 
v”
, 
ş›Á
, 
fmode
, 
»t
;

493 cÚ¡ *
f’ame
;

494 
¢d_£q_t
 *
£q
;

495 
¢d_£q_hw_t
 *
hw
;

497 *
hªdË
 = 
NULL
;

499 
¡»ams
) {

500 
SND_SEQ_OPEN_OUTPUT
:

501 
fmode
 = 
O_WRONLY
;

503 
SND_SEQ_OPEN_INPUT
:

504 
fmode
 = 
O_RDONLY
;

506 
SND_SEQ_OPEN_DUPLEX
:

507 
fmode
 = 
O_RDWR
;

510 
	`as£¹
(0);

511  -
EINVAL
;

514 ià(
mode
 & 
SND_SEQ_NONBLOCK
)

515 
fmode
 |ğ
O_NONBLOCK
;

517 
f’ame
 = 
SNDRV_FILE_SEQ
;

518 
fd
 = 
	`¢d_İ’_deviû
(
f’ame
, 
fmode
);

519 #ifdeà
SUPPORT_ALOAD


520 ià(
fd
 < 0) {

521 
fd
 = 
	`¢d_İ’_deviû
(
SNDRV_FILE_ALOADSEQ
, 
fmode
);

522 ià(
fd
 >= 0)

523 
	`şo£
(
fd
);

524 
fd
 = 
	`¢d_İ’_deviû
(
f’ame
, 
fmode
);

527 ià(
fd
 < 0) {

528 
	`SYSERR
("İ’ % çed", 
f’ame
);

529  -
”ºo
;

531 ià(
	`ioùl
(
fd
, 
SNDRV_SEQ_IOCTL_PVERSION
, &
v”
) < 0) {

532 
	`SYSERR
("SNDRV_SEQ_IOCTL_PVERSION failed");

533 
»t
 = -
”ºo
;

534 
	`şo£
(
fd
);

535  
»t
;

537 ià(
	`SNDRV_PROTOCOL_INCOMPATIBLE
(
v”
, 
SNDRV_SEQ_VERSION
)) {

538 
	`şo£
(
fd
);

539  -
SND_ERROR_INCOMPATIBLE_VERSION
;

541 ià(
	`SNDRV_PROTOCOL_VERSION
(1, 0, 3è<ğ
v”
) {

543 
u£r_v”
 = 
SNDRV_SEQ_VERSION
;

544 
	`ioùl
(
fd
, 
SNDRV_SEQ_IOCTL_USER_PVERSION
, &
u£r_v”
);

546 
hw
 = 
	`ÿÎoc
(1, (
¢d_£q_hw_t
));

547 ià(
hw
 =ğ
NULL
) {

548 
	`şo£
(
fd
);

549  -
ENOMEM
;

552 
£q
 = 
	`ÿÎoc
(1, (
¢d_£q_t
));

553 ià(
£q
 =ğ
NULL
) {

554 
	`ä“
(
hw
);

555 
	`şo£
(
fd
);

556  -
ENOMEM
;

558 
hw
->
fd
 = fd;

559 
hw
->
v”siÚ
 = 
v”
;

560 ià(
¡»ams
 & 
SND_SEQ_OPEN_OUTPUT
) {

561 
£q
->
obuf
 = (*è
	`m®loc
(£q->
obufsize
 = 
SND_SEQ_OBUF_SIZE
);

562 ià(!
£q
->
obuf
) {

563 
	`ä“
(
hw
);

564 
	`ä“
(
£q
);

565 
	`şo£
(
fd
);

566  -
ENOMEM
;

569 ià(
¡»ams
 & 
SND_SEQ_OPEN_INPUT
) {

570 
£q
->
ibuf
 = (*è
	`ÿÎoc
((
¢d_£q_ump_ev’t_t
), seq->
ibufsize
 = 
SND_SEQ_IBUF_SIZE
);

571 ià(!
£q
->
ibuf
) {

572 
	`ä“
(
£q
->
obuf
);

573 
	`ä“
(
hw
);

574 
	`ä“
(
£q
);

575 
	`şo£
(
fd
);

576  -
ENOMEM
;

579 ià(
Çme
)

580 
£q
->
Çme
 = 
	`¡rdup
(name);

581 
£q
->
ty³
 = 
SND_SEQ_TYPE_HW
;

582 
£q
->
¡»ams
 = streams;

583 
£q
->
mode
 = mode;

584 
£q
->
tmpbuf
 = 
NULL
;

585 
£q
->
tmpbufsize
 = 0;

586 
£q
->
pŞl_fd
 = 
fd
;

587 
£q
->
İs
 = &
¢d_£q_hw_İs
;

588 
£q
->
´iv©e_d©a
 = 
hw
;

589 
£q
->
·ck‘_size
 = (
¢d_£q_ev’t_t
);

590 
ş›Á
 = 
	`¢d_£q_hw_ş›Á_id
(
£q
);

591 ià(
ş›Á
 < 0) {

592 
	`¢d_£q_şo£
(
£q
);

593  
ş›Á
;

595 
£q
->
ş›Á
 = client;

597 #ifdeà
SNDRV_SEQ_IOCTL_RUNNING_MODE


599 
¢d_£q_ruÂšg_šfo
 
run_mode
;

601 
	`mem£t
(&
run_mode
, 0, (run_mode));

602 
run_mode
.
ş›Á
 = client;

603 #ifdeà
SNDRV_BIG_ENDIAN


604 
run_mode
.
big_’dŸn
 = 1;

606 
run_mode
.
big_’dŸn
 = 0;

608 
run_mode
.
ıu_mode
 = ();

609 
	`ioùl
(
fd
, 
SNDRV_SEQ_IOCTL_RUNNING_MODE
, &
run_mode
);

613 *
hªdË
 = 
£q
;

615 
	}
}

617 
	$_¢d_£q_hw_İ’
(
¢d_£q_t
 **
hªdËp
, *
Çme
,

618 
¢d_cÚfig_t
 *
roÙ
 
ATTRIBUTE_UNUSED
, snd_cÚfig_ˆ*
cÚf
,

619 
¡»ams
, 
mode
)

621 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

622 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

623 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

624 cÚ¡ *
id
;

625 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

627 ià(
	`_¢d_cÚf_g’”ic_id
(
id
))

629  -
EINVAL
;

631  
	`¢d_£q_hw_İ’
(
hªdËp
, 
Çme
, 
¡»ams
, 
mode
);

632 
	}
}

633 
SND_DLSYM_BUILD_VERSION
(
_¢d_£q_hw_İ’
, 
SND_SEQ_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_local.h

23 #iâdeà
__SEQ_LOCAL_H


24 
	#__SEQ_LOCAL_H


	)

26 
	~"loÿl.h
"

27 
	~<¡dio.h
>

28 
	~<¡dlib.h
>

29 
	~<lim™s.h
>

31 
	#SND_SEQ_OBUF_SIZE
 (16*1024è

	)

32 
	#SND_SEQ_IBUF_SIZE
 500

	)

33 
	#DEFAULT_TMPBUF_SIZE
 20

	)

35 
¢d_£q_queue_ş›Á
 
	t¢d_£q_queue_ş›Á_t
;

39 (*
	mşo£
)(
¢d_£q_t
 *
	m£q
);

40 (*
	mnÚblock
)(
¢d_£q_t
 *
	m£q
, nonblock);

41 (*
	msy¡em_šfo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_sy¡em_šfo_t
 * 
	mšfo
);

42 (*
	mg‘_ş›Á_šfo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_ş›Á_šfo_t
 * 
	mšfo
);

43 (*
	m£t_ş›Á_šfo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_ş›Á_šfo_t
 * 
	mšfo
);

44 (*
	mg‘_ump_šfo
)(
¢d_£q_t
 *
	m£q
, 
	mş›Á
, 
	mty³
, *
	mšfo
);

45 (*
	m£t_ump_šfo
)(
¢d_£q_t
 *
	m£q
, 
	mty³
, cÚ¡ *
	mšfo
);

46 (*
	mü—‹_pÜt
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_pÜt_šfo_t
 * 
	mpÜt
);

47 (*
	md–‘e_pÜt
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_pÜt_šfo_t
 * 
	mpÜt
);

48 (*
	mg‘_pÜt_šfo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_pÜt_šfo_t
 * 
	mšfo
);

49 (*
	m£t_pÜt_šfo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_pÜt_šfo_t
 * 
	mšfo
);

50 (*
	mg‘_pÜt_subsütiÚ
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_pÜt_subsüibe_t
 * 
	msub
);

51 (*
	msubsüibe_pÜt
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_pÜt_subsüibe_t
 * 
	msub
);

52 (*
	munsubsüibe_pÜt
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_pÜt_subsüibe_t
 * 
	msub
);

53 (*
	mqu”y_pÜt_subsüib”s
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_qu”y_subsüibe_t
 * 
	msubs
);

54 (*
	mg‘_queue_¡©us
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_¡©us_t
 * 
	m¡©us
);

55 (*
	mg‘_queue_‹mpo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_‹mpo_t
 * 
	m‹mpo
);

56 (*
	m£t_queue_‹mpo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_‹mpo_t
 * 
	m‹mpo
);

57 (*
	mg‘_queue_tim”
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_tim”_t
 * 
	mtim”
);

58 (*
	m£t_queue_tim”
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_tim”_t
 * 
	mtim”
);

59 (*
	mg‘_queue_ş›Á
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_ş›Á_t
 * 
	mş›Á
);

60 (*
	m£t_queue_ş›Á
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_ş›Á_t
 * 
	mş›Á
);

61 (*
	mü—‹_queue
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_šfo_t
 *
	mšfo
);

62 (*
	md–‘e_queue
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_šfo_t
 *
	mšfo
);

63 (*
	mg‘_queue_šfo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_šfo_t
 *
	mšfo
);

64 (*
	m£t_queue_šfo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_šfo_t
 *
	mšfo
);

65 (*
	mg‘_Çmed_queue
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_šfo_t
 *
	mšfo
);

66 
ssize_t
 (*
wr™e
)(
¢d_£q_t
 *
	m£q
, *
	mbuf
, 
size_t
 
	mËn
);

67 
ssize_t
 (*
»ad
)(
¢d_£q_t
 *
	m£q
, *
	mbuf
, 
size_t
 
	mËn
);

68 (*
	m»move_ev’ts
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_»move_ev’ts_t
 *
	mrmp
);

69 (*
	mg‘_ş›Á_poŞ
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_ş›Á_poŞ_t
 *
	mšfo
);

70 (*
	m£t_ş›Á_poŞ
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_ş›Á_poŞ_t
 *
	mšfo
);

71 (*
	mqu”y_Ãxt_ş›Á
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_ş›Á_šfo_t
 *
	mšfo
);

72 (*
	mqu”y_Ãxt_pÜt
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_pÜt_šfo_t
 *
	mšfo
);

73 } 
	t¢d_£q_İs_t
;

75 
	s_¢d_£q
 {

76 *
	mÇme
;

77 
¢d_£q_ty³_t
 
	mty³
;

78 
	m¡»ams
;

79 
	mmode
;

80 
	mpŞl_fd
;

81 *
	mdl_hªdË
;

82 cÚ¡ 
¢d_£q_İs_t
 *
	mİs
;

83 *
	m´iv©e_d©a
;

84 
	mş›Á
;

86 *
	mobuf
;

87 
size_t
 
	mobufsize
;

88 
size_t
 
	mobufu£d
;

89 *
	mibuf
;

90 
size_t
 
	mibuåŒ
;

91 
size_t
 
	mibuæ’
;

92 
size_t
 
	mibufsize
;

93 
¢d_£q_ev’t_t
 *
	mtmpbuf
;

94 
size_t
 
	mtmpbufsize
;

95 
size_t
 
	m·ck‘_size
;

96 
	mmidi_v”siÚ
;

99 
¢d_£q_hw_İ’
(
¢d_£q_t
 **
hªdË
, cÚ¡ *
Çme
, 
¡»ams
, 
mode
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_midi_event.c

31 
	~"loÿl.h
"

32 #ià
HAVE_MALLOC_H


33 
	~<m®loc.h
>

36 #iâdeà
DOC_HIDDEN


39 
	s¢d_midi_ev’t
 {

40 
ssize_t
 
	mqËn
;

41 
size_t
 
	m»ad
;

42 
	mty³
;

43 
	mÏ¡cmd
;

44 
	mno¡©
;

45 
size_t
 
	mbufsize
;

46 *
	mbuf
;

52 
	#ST_INVALID
 7

	)

53 
	#ST_SPECIAL
 8

	)

54 
	#ST_SYSEX
 
ST_SPECIAL


	)

59 (*
	tev’t_’code_t
)(
	t¢d_midi_ev’t_t
 *
	tdev
, 
	t¢d_£q_ev’t_t
 *
	tev
);

60 (*
	tev’t_decode_t
)(cÚ¡ 
	t¢d_£q_ev’t_t
 *
	tev
, *
	tbuf
);

67 
	`nÙe_ev’t
(
¢d_midi_ev’t_t
 *
dev
, 
¢d_£q_ev’t_t
 *
ev
);

68 
	`Úe_·¿m_ù¾_ev’t
(
¢d_midi_ev’t_t
 *
dev
, 
¢d_£q_ev’t_t
 *
ev
);

69 
	`p™chb’d_ù¾_ev’t
(
¢d_midi_ev’t_t
 *
dev
, 
¢d_£q_ev’t_t
 *
ev
);

70 
	`two_·¿m_ù¾_ev’t
(
¢d_midi_ev’t_t
 *
dev
, 
¢d_£q_ev’t_t
 *
ev
);

71 
	`Úe_·¿m_ev’t
(
¢d_midi_ev’t_t
 *
dev
, 
¢d_£q_ev’t_t
 *
ev
);

72 
	`sÚgpos_ev’t
(
¢d_midi_ev’t_t
 *
dev
, 
¢d_£q_ev’t_t
 *
ev
);

73 
	`nÙe_decode
(cÚ¡ 
¢d_£q_ev’t_t
 *
ev
, *
buf
);

74 
	`Úe_·¿m_decode
(cÚ¡ 
¢d_£q_ev’t_t
 *
ev
, *
buf
);

75 
	`p™chb’d_decode
(cÚ¡ 
¢d_£q_ev’t_t
 *
ev
, *
buf
);

76 
	`two_·¿m_decode
(cÚ¡ 
¢d_£q_ev’t_t
 *
ev
, *
buf
);

77 
	`sÚgpos_decode
(cÚ¡ 
¢d_£q_ev’t_t
 *
ev
, *
buf
);

82 #iâdeà
DOC_HIDDEN


83 cÚ¡ 
	s¡©us_ev’t_li¡_t
 {

84 
ev’t
;

85 
qËn
;

86 
ev’t_’code_t
 
’code
;

87 
ev’t_decode_t
 
decode
;

88 } 
¡©us_ev’t
[] = {

90 {
SND_SEQ_EVENT_NOTEOFF
, 2, 
nÙe_ev’t
, 
nÙe_decode
},

91 {
SND_SEQ_EVENT_NOTEON
, 2, 
nÙe_ev’t
, 
nÙe_decode
},

92 {
SND_SEQ_EVENT_KEYPRESS
, 2, 
nÙe_ev’t
, 
nÙe_decode
},

93 {
SND_SEQ_EVENT_CONTROLLER
, 2, 
two_·¿m_ù¾_ev’t
, 
two_·¿m_decode
},

94 {
SND_SEQ_EVENT_PGMCHANGE
, 1, 
Úe_·¿m_ù¾_ev’t
, 
Úe_·¿m_decode
},

95 {
SND_SEQ_EVENT_CHANPRESS
, 1, 
Úe_·¿m_ù¾_ev’t
, 
Úe_·¿m_decode
},

96 {
SND_SEQ_EVENT_PITCHBEND
, 2, 
p™chb’d_ù¾_ev’t
, 
p™chb’d_decode
},

98 {
SND_SEQ_EVENT_NONE
, -1, 
NULL
, NULL},

100 {
SND_SEQ_EVENT_SYSEX
, 1, 
NULL
, NULL},

101 {
SND_SEQ_EVENT_QFRAME
, 1, 
Úe_·¿m_ev’t
, 
Úe_·¿m_decode
},

102 {
SND_SEQ_EVENT_SONGPOS
, 2, 
sÚgpos_ev’t
, 
sÚgpos_decode
},

103 {
SND_SEQ_EVENT_SONGSEL
, 1, 
Úe_·¿m_ev’t
, 
Úe_·¿m_decode
},

104 {
SND_SEQ_EVENT_NONE
, -1, 
NULL
, NULL},

105 {
SND_SEQ_EVENT_NONE
, -1, 
NULL
, NULL},

106 {
SND_SEQ_EVENT_TUNE_REQUEST
, 0, 
NULL
, NULL},

107 {
SND_SEQ_EVENT_NONE
, -1, 
NULL
, NULL},

108 {
SND_SEQ_EVENT_CLOCK
, 0, 
NULL
, NULL},

109 {
SND_SEQ_EVENT_NONE
, -1, 
NULL
, NULL},

110 {
SND_SEQ_EVENT_START
, 0, 
NULL
, NULL},

111 {
SND_SEQ_EVENT_CONTINUE
, 0, 
NULL
, NULL},

112 {
SND_SEQ_EVENT_STOP
, 0, 
NULL
, NULL},

113 {
SND_SEQ_EVENT_NONE
, -1, 
NULL
, NULL},

114 {
SND_SEQ_EVENT_SENSING
, 0, 
NULL
, NULL},

115 {
SND_SEQ_EVENT_RESET
, 0, 
NULL
, NULL},

116 
	}
};

118 
exŒa_decode_ù¾14
(
¢d_midi_ev’t_t
 *
dev
, *
buf
, 
Ën
, cÚ¡ 
¢d_£q_ev’t_t
 *
ev
);

119 
exŒa_decode_x½n
(
¢d_midi_ev’t_t
 *
dev
, *
buf
, 
couÁ
, cÚ¡ 
¢d_£q_ev’t_t
 *
ev
);

121 cÚ¡ 
	sexŒa_ev’t_li¡_t
 {

122 
	mev’t
;

123 (*
	mdecode
)(
¢d_midi_ev’t_t
 *
	mdev
, *
	mbuf
, 
	mËn
, cÚ¡ 
¢d_£q_ev’t_t
 *
	mev
);

124 } 
	gexŒa_ev’t
[] = {

125 {
SND_SEQ_EVENT_CONTROL14
, 
exŒa_decode_ù¾14
},

126 {
SND_SEQ_EVENT_NONREGPARAM
, 
exŒa_decode_x½n
},

127 {
SND_SEQ_EVENT_REGPARAM
, 
exŒa_decode_x½n
},

130 
	#numb”of
(
¬y
è(×ry)/×ry[0]))

	)

152 
	$¢d_midi_ev’t_Ãw
(
size_t
 
bufsize
, 
¢d_midi_ev’t_t
 **
rdev
)

154 
¢d_midi_ev’t_t
 *
dev
;

156 *
rdev
 = 
NULL
;

157 
dev
 = (
¢d_midi_ev’t_t
 *)
	`ÿÎoc
(1, (snd_midi_event_t));

158 ià(
dev
 =ğ
NULL
)

159  -
ENOMEM
;

160 ià(
bufsize
 > 0) {

161 
dev
->
buf
 = 
	`m®loc
(
bufsize
);

162 ià(
dev
->
buf
 =ğ
NULL
) {

163 
	`ä“
(
dev
);

164  -
ENOMEM
;

167 
dev
->
bufsize
 = bufsize;

168 
dev
->
Ï¡cmd
 = 0xff;

169 
dev
->
ty³
 = 
ST_INVALID
;

170 *
rdev
 = 
dev
;

172 
	}
}

183 
	$¢d_midi_ev’t_ä“
(
¢d_midi_ev’t_t
 *
dev
)

185 ià(
dev
 !ğ
NULL
) {

186 
	`ä“
(
dev
->
buf
);

187 
	`ä“
(
dev
);

189 
	}
}

202 
	$¢d_midi_ev’t_no_¡©us
(
¢d_midi_ev’t_t
 *
dev
, 
Ú
)

204 
dev
->
no¡©
 = 
Ú
 ? 1 : 0;

205 
	}
}

210 
šlše
 
	$»£t_’code
(
¢d_midi_ev’t_t
 *
dev
)

212 
dev
->
»ad
 = 0;

213 
dev
->
qËn
 = 0;

214 
dev
->
ty³
 = 
ST_INVALID
;

215 
	}
}

228 
	$¢d_midi_ev’t_»£t_’code
(
¢d_midi_ev’t_t
 *
dev
)

230 
	`»£t_’code
(
dev
);

231 
	}
}

244 
	$¢d_midi_ev’t_»£t_decode
(
¢d_midi_ev’t_t
 *
dev
)

246 
dev
->
Ï¡cmd
 = 0xff;

247 
	}
}

259 
	$¢d_midi_ev’t_š™
(
¢d_midi_ev’t_t
 *
dev
)

261 
	`¢d_midi_ev’t_»£t_’code
(
dev
);

262 
	`¢d_midi_ev’t_»£t_decode
(
dev
);

263 
	}
}

282 
	$¢d_midi_ev’t_»size_bufãr
(
¢d_midi_ev’t_t
 *
dev
, 
size_t
 
bufsize
)

284 *
Ãw_buf
, *
Şd_buf
;

286 ià(
bufsize
 =ğ
dev
->bufsize)

288 
Ãw_buf
 = 
	`m®loc
(
bufsize
);

289 ià(
Ãw_buf
 =ğ
NULL
)

290  -
ENOMEM
;

291 
Şd_buf
 = 
dev
->
buf
;

292 
dev
->
buf
 = 
Ãw_buf
;

293 
dev
->
bufsize
 = bufsize;

294 
	`»£t_’code
(
dev
);

295 
	`ä“
(
Şd_buf
);

297 
	}
}

362 
	$¢d_midi_ev’t_’code
(
¢d_midi_ev’t_t
 *
dev
, cÚ¡ *
buf
, 
couÁ
, 
¢d_£q_ev’t_t
 *
ev
)

364 
»suÉ
 = 0;

365 
rc
;

367 
ev
->
ty³
 = 
SND_SEQ_EVENT_NONE
;

369 
couÁ
-- > 0) {

370 
rc
 = 
	`¢d_midi_ev’t_’code_by‹
(
dev
, *
buf
++, 
ev
);

371 
»suÉ
++;

372 ià(
rc
 < 0)

373  
rc
;

374 ià(
rc
 > 0)

375  
»suÉ
;

378  
»suÉ
;

379 
	}
}

400 
	$¢d_midi_ev’t_’code_by‹
(
¢d_midi_ev’t_t
 *
dev
, 
c
, 
¢d_£q_ev’t_t
 *
ev
)

402 
rc
 = 0;

404 
c
 &= 0xff;

406 ià(
c
 >ğ
MIDI_CMD_COMMON_CLOCK
) {

408 
ev
->
ty³
 = 
¡©us_ev’t
[
ST_SPECIAL
 + 
c
 - 0xf0].
ev’t
;

409 
ev
->
æags
 &ğ~
SND_SEQ_EVENT_LENGTH_MASK
;

410 
ev
->
æags
 |ğ
SND_SEQ_EVENT_LENGTH_FIXED
;

411  
ev
->
ty³
 !ğ
SND_SEQ_EVENT_NONE
;

414 ià((
c
 & 0x80) &&

415 (
c
 !ğ
MIDI_CMD_COMMON_SYSEX_END
 || 
dev
->
ty³
 !ğ
ST_SYSEX
)) {

417 
dev
->
buf
[0] = 
c
;

418 ià((
c
 & 0xf0) == 0xf0)

419 
dev
->
ty³
 = (
c
 & 0x0fè+ 
ST_SPECIAL
;

421 
dev
->
ty³
 = (
c
 >> 4) & 0x07;

422 
dev
->
»ad
 = 1;

423 
dev
->
qËn
 = 
¡©us_ev’t
[dev->
ty³
].qlen;

425 ià(
dev
->
qËn
 > 0) {

427 
dev
->
buf
[dev->
»ad
++] = 
c
;

428 ià(
dev
->
ty³
 !ğ
ST_SYSEX
)

429 
dev
->
qËn
--;

432 
dev
->
buf
[1] = 
c
;

433 
dev
->
qËn
 = 
¡©us_ev’t
[dev->
ty³
].qlen - 1;

434 
dev
->
»ad
 = 2;

437 ià(
dev
->
qËn
 == 0) {

438 
ev
->
ty³
 = 
¡©us_ev’t
[
dev
->ty³].
ev’t
;

439 
ev
->
æags
 &ğ~
SND_SEQ_EVENT_LENGTH_MASK
;

440 
ev
->
æags
 |ğ
SND_SEQ_EVENT_LENGTH_FIXED
;

441 ià(
¡©us_ev’t
[
dev
->
ty³
].
’code
)

442 
¡©us_ev’t
[
dev
->
ty³
].
	`’code
(dev, 
ev
);

443 ià(
dev
->
ty³
 >ğ
ST_SPECIAL
)

444 
dev
->
ty³
 = 
ST_INVALID
;

445 
rc
 = 1;

446 } ià(
dev
->
ty³
 =ğ
ST_SYSEX
) {

447 ià(
c
 =ğ
MIDI_CMD_COMMON_SYSEX_END
 ||

448 
dev
->
»ad
 >ğdev->
bufsize
) {

449 
ev
->
æags
 &ğ~
SND_SEQ_EVENT_LENGTH_MASK
;

450 
ev
->
æags
 |ğ
SND_SEQ_EVENT_LENGTH_VARIABLE
;

451 
ev
->
ty³
 = 
SND_SEQ_EVENT_SYSEX
;

452 
ev
->
d©a
.
ext
.
Ën
 = 
dev
->
»ad
;

453 
ev
->
d©a
.
ext
.
±r
 = 
dev
->
buf
;

454 ià(
c
 !ğ
MIDI_CMD_COMMON_SYSEX_END
)

455 
dev
->
»ad
 = 0;

457 
	`»£t_’code
(
dev
);

458 
rc
 = 1;

462  
rc
;

463 
	}
}

466 
	$nÙe_ev’t
(
¢d_midi_ev’t_t
 *
dev
, 
¢d_£q_ev’t_t
 *
ev
)

468 
ev
->
d©a
.
nÙe
.
chªÃl
 = 
dev
->
buf
[0] & 0x0f;

469 
ev
->
d©a
.
nÙe
.nÙğ
dev
->
buf
[1];

470 
ev
->
d©a
.
nÙe
.
v–oc™y
 = 
dev
->
buf
[2];

471 
	}
}

474 
	$Úe_·¿m_ù¾_ev’t
(
¢d_midi_ev’t_t
 *
dev
, 
¢d_£q_ev’t_t
 *
ev
)

476 
ev
->
d©a
.
cÚŒŞ
.
chªÃl
 = 
dev
->
buf
[0] & 0x0f;

477 
ev
->
d©a
.
cÚŒŞ
.
v®ue
 = 
dev
->
buf
[1];

478 
	}
}

481 
	$p™chb’d_ù¾_ev’t
(
¢d_midi_ev’t_t
 *
dev
, 
¢d_£q_ev’t_t
 *
ev
)

483 
ev
->
d©a
.
cÚŒŞ
.
chªÃl
 = 
dev
->
buf
[0] & 0x0f;

484 
ev
->
d©a
.
cÚŒŞ
.
v®ue
 = ()
dev
->
buf
[2] * 128 + ()dev->buf[1] - 8192;

485 
	}
}

488 
	$two_·¿m_ù¾_ev’t
(
¢d_midi_ev’t_t
 *
dev
, 
¢d_£q_ev’t_t
 *
ev
)

490 
ev
->
d©a
.
cÚŒŞ
.
chªÃl
 = 
dev
->
buf
[0] & 0x0f;

491 
ev
->
d©a
.
cÚŒŞ
.
·¿m
 = 
dev
->
buf
[1];

492 
ev
->
d©a
.
cÚŒŞ
.
v®ue
 = 
dev
->
buf
[2];

493 
	}
}

496 
	$Úe_·¿m_ev’t
(
¢d_midi_ev’t_t
 *
dev
, 
¢d_£q_ev’t_t
 *
ev
)

498 
ev
->
d©a
.
cÚŒŞ
.
v®ue
 = 
dev
->
buf
[1];

499 
	}
}

502 
	$sÚgpos_ev’t
(
¢d_midi_ev’t_t
 *
dev
, 
¢d_£q_ev’t_t
 *
ev
)

504 
ev
->
d©a
.
cÚŒŞ
.
v®ue
 = ()
dev
->
buf
[2] * 128 + ()dev->buf[1];

505 
	}
}

559 
	$¢d_midi_ev’t_decode
(
¢d_midi_ev’t_t
 *
dev
, *
buf
, 
couÁ
, cÚ¡ 
¢d_£q_ev’t_t
 *
ev
)

561 
cmd
;

562 
qËn
;

563 
ty³
;

565 ià(
ev
->
ty³
 =ğ
SND_SEQ_EVENT_NONE
)

566  -
ENOENT
;

568 
ty³
 = 0;y³ < 
	`numb”of
(
¡©us_ev’t
);ype++) {

569 ià(
ev
->
ty³
 =ğ
¡©us_ev’t
[ty³].
ev’t
)

570 
__found
;

572 
ty³
 = 0;y³ < 
	`numb”of
(
exŒa_ev’t
);ype++) {

573 ià(
ev
->
ty³
 =ğ
exŒa_ev’t
[ty³].
ev’t
)

574  
exŒa_ev’t
[
ty³
].
	`decode
(
dev
, 
buf
, 
couÁ
, 
ev
);

576  -
ENOENT
;

578 
__found
:

579 ià(
ty³
 >ğ
ST_SPECIAL
)

580 
cmd
 = 0xf0 + (
ty³
 - 
ST_SPECIAL
);

583 
cmd
 = 0x80 | (
ty³
 << 4è| (
ev
->
d©a
.
nÙe
.
chªÃl
 & 0x0f);

586 ià(
cmd
 =ğ
MIDI_CMD_COMMON_SYSEX
) {

587 
	`¢d_midi_ev’t_»£t_decode
(
dev
);

588 
qËn
 = 
ev
->
d©a
.
ext
.
Ën
;

589 ià(
couÁ
 < 
qËn
)

590  -
ENOMEM
;

591 
ev
->
æags
 & 
SND_SEQ_EVENT_LENGTH_MASK
) {

592 
SND_SEQ_EVENT_LENGTH_FIXED
:

593  -
EINVAL
;

595 
	`memıy
(
buf
, 
ev
->
d©a
.
ext
.
±r
, 
qËn
);

596  
qËn
;

598 
xbuf
[4];

600 ià((
cmd
 & 0xf0è=ğ0xf0 || 
dev
->
Ï¡cmd
 !ğcmd || dev->
no¡©
) {

601 
dev
->
Ï¡cmd
 = 
cmd
;

602 
xbuf
[0] = 
cmd
;

603 ià(
¡©us_ev’t
[
ty³
].
decode
)

604 
¡©us_ev’t
[
ty³
].
	`decode
(
ev
, 
xbuf
 + 1);

605 
qËn
 = 
¡©us_ev’t
[
ty³
].qlen + 1;

607 ià(
¡©us_ev’t
[
ty³
].
decode
)

608 
¡©us_ev’t
[
ty³
].
	`decode
(
ev
, 
xbuf
 + 0);

609 
qËn
 = 
¡©us_ev’t
[
ty³
].qlen;

611 ià(
qËn
 <= 0)

613 ià(
couÁ
 < 
qËn
)

614  -
ENOMEM
;

615 
	`memıy
(
buf
, 
xbuf
, 
qËn
);

616  
qËn
;

618 
	}
}

622 
	$nÙe_decode
(cÚ¡ 
¢d_£q_ev’t_t
 *
ev
, *
buf
)

624 
buf
[0] = 
ev
->
d©a
.
nÙe
.note & 0x7f;

625 
buf
[1] = 
ev
->
d©a
.
nÙe
.
v–oc™y
 & 0x7f;

626 
	}
}

629 
	$Úe_·¿m_decode
(cÚ¡ 
¢d_£q_ev’t_t
 *
ev
, *
buf
)

631 
buf
[0] = 
ev
->
d©a
.
cÚŒŞ
.
v®ue
 & 0x7f;

632 
	}
}

635 
	$p™chb’d_decode
(cÚ¡ 
¢d_£q_ev’t_t
 *
ev
, *
buf
)

637 
v®ue
 = 
ev
->
d©a
.
cÚŒŞ
.value + 8192;

638 
buf
[0] = 
v®ue
 & 0x7f;

639 
buf
[1] = (
v®ue
 >> 7) & 0x7f;

640 
	}
}

643 
	$two_·¿m_decode
(cÚ¡ 
¢d_£q_ev’t_t
 *
ev
, *
buf
)

645 
buf
[0] = 
ev
->
d©a
.
cÚŒŞ
.
·¿m
 & 0x7f;

646 
buf
[1] = 
ev
->
d©a
.
cÚŒŞ
.
v®ue
 & 0x7f;

647 
	}
}

650 
	$sÚgpos_decode
(cÚ¡ 
¢d_£q_ev’t_t
 *
ev
, *
buf
)

652 
buf
[0] = 
ev
->
d©a
.
cÚŒŞ
.
v®ue
 & 0x7f;

653 
buf
[1] = (
ev
->
d©a
.
cÚŒŞ
.
v®ue
 >> 7) & 0x7f;

654 
	}
}

657 
	$exŒa_decode_ù¾14
(
¢d_midi_ev’t_t
 *
dev
, *
buf
, 
couÁ
, cÚ¡ 
¢d_£q_ev’t_t
 *
ev
)

659 
cmd
;

660 
idx
 = 0;

662 
cmd
 = 
MIDI_CMD_CONTROL
|(
ev
->
d©a
.
cÚŒŞ
.
chªÃl
 & 0x0f);

663 ià(
ev
->
d©a
.
cÚŒŞ
.
·¿m
 < 32) {

664 ià(
couÁ
 < 4)

665  -
ENOMEM
;

666 ià(
dev
->
no¡©
 && 
couÁ
 < 6)

667  -
ENOMEM
;

668 ià(
cmd
 !ğ
dev
->
Ï¡cmd
 || dev->
no¡©
) {

669 ià(
couÁ
 < 5)

670  -
ENOMEM
;

671 
buf
[
idx
++] = 
dev
->
Ï¡cmd
 = 
cmd
;

673 
buf
[
idx
++] = 
ev
->
d©a
.
cÚŒŞ
.
·¿m
;

674 
buf
[
idx
++] = (
ev
->
d©a
.
cÚŒŞ
.
v®ue
 >> 7) & 0x7f;

675 ià(
dev
->
no¡©
)

676 
buf
[
idx
++] = 
cmd
;

677 
buf
[
idx
++] = 
ev
->
d©a
.
cÚŒŞ
.
·¿m
 + 32;

678 
buf
[
idx
++] = 
ev
->
d©a
.
cÚŒŞ
.
v®ue
 & 0x7f;

680 ià(
couÁ
 < 2)

681  -
ENOMEM
;

682 ià(
cmd
 !ğ
dev
->
Ï¡cmd
 || dev->
no¡©
) {

683 ià(
couÁ
 < 3)

684  -
ENOMEM
;

685 
buf
[
idx
++] = 
dev
->
Ï¡cmd
 = 
cmd
;

687 
buf
[
idx
++] = 
ev
->
d©a
.
cÚŒŞ
.
·¿m
 & 0x7f;

688 
buf
[
idx
++] = 
ev
->
d©a
.
cÚŒŞ
.
v®ue
 & 0x7f;

690  
idx
;

691 
	}
}

694 
	$exŒa_decode_x½n
(
¢d_midi_ev’t_t
 *
dev
, *
buf
, 
couÁ
, cÚ¡ 
¢d_£q_ev’t_t
 *
ev
)

696 
cmd
;

697 cÚ¡ *
cby‹s
;

698 cÚ¡ 
cby‹s_Ä²
[4] = { 
MIDI_CTL_NONREG_PARM_NUM_MSB
,

699 
MIDI_CTL_NONREG_PARM_NUM_LSB
,

700 
MIDI_CTL_MSB_DATA_ENTRY
,

701 
MIDI_CTL_LSB_DATA_ENTRY
 };

702 cÚ¡ 
cby‹s_½n
[4] = { 
MIDI_CTL_REGIST_PARM_NUM_MSB
,

703 
MIDI_CTL_REGIST_PARM_NUM_LSB
,

704 
MIDI_CTL_MSB_DATA_ENTRY
,

705 
MIDI_CTL_LSB_DATA_ENTRY
 };

706 
by‹s
[4];

707 
idx
 = 0, 
i
;

709 ià(
couÁ
 < 8)

710  -
ENOMEM
;

711 ià(
dev
->
no¡©
 && 
couÁ
 < 12)

712  -
ENOMEM
;

713 
cmd
 = 
MIDI_CMD_CONTROL
|(
ev
->
d©a
.
cÚŒŞ
.
chªÃl
 & 0x0f);

714 
by‹s
[0] = (
ev
->
d©a
.
cÚŒŞ
.
·¿m
 & 0x3f80) >> 7;

715 
by‹s
[1] = 
ev
->
d©a
.
cÚŒŞ
.
·¿m
 & 0x007f;

716 
by‹s
[2] = (
ev
->
d©a
.
cÚŒŞ
.
v®ue
 & 0x3f80) >> 7;

717 
by‹s
[3] = 
ev
->
d©a
.
cÚŒŞ
.
v®ue
 & 0x007f;

718 ià(
cmd
 !ğ
dev
->
Ï¡cmd
 && !dev->
no¡©
) {

719 ià(
couÁ
 < 9)

720  -
ENOMEM
;

721 
buf
[
idx
++] = 
dev
->
Ï¡cmd
 = 
cmd
;

723 
cby‹s
 = 
ev
->
ty³
 =ğ
SND_SEQ_EVENT_NONREGPARAM
 ? 
cby‹s_Ä²
 : 
cby‹s_½n
;

724 
i
 = 0; i < 4; i++) {

725 ià(
dev
->
no¡©
)

726 
buf
[
idx
++] = 
dev
->
Ï¡cmd
 = 
cmd
;

727 
buf
[
idx
++] = 
cby‹s
[
i
];

728 
buf
[
idx
++] = 
by‹s
[
i
];

730  
idx
;

731 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_old.c

5 #iâdeà
DOXYGEN


7 
	~"loÿl.h
"

9 
size_t
 
	$¢d_š¡r_h—d”_sizeof
()

12 
	}
}

14 
	$¢d_š¡r_h—d”_m®loc
(**
±r
 
ATTRIBUTE_UNUSED
,

15 
size_t
 
Ën
 
ATTRIBUTE_UNUSED
)

17  -
ENOMEM
;

18 
	}
}

20 
	$¢d_š¡r_h—d”_ä“
(*
obj
 
ATTRIBUTE_UNUSED
)

22 
	}
}

24 
	$¢d_š¡r_h—d”_cİy
(*
d¡
 
ATTRIBUTE_UNUSED
,

25 cÚ¡ *
¤c
 
ATTRIBUTE_UNUSED
)

27 
	}
}

29 cÚ¡ *
	$¢d_š¡r_h—d”_g‘_id
(cÚ¡ *
šfo
 
ATTRIBUTE_UNUSED
)

31  
NULL
;

32 
	}
}

34 
	$¢d_š¡r_h—d”_g‘_şu¡”
(cÚ¡ *
šfo
 
ATTRIBUTE_UNUSED
)

37 
	}
}

39 
	$¢d_š¡r_h—d”_g‘_cmd
(cÚ¡ *
šfo
 
ATTRIBUTE_UNUSED
)

42 
	}
}

44 
size_t
 
	$¢d_š¡r_h—d”_g‘_Ën
(cÚ¡ *
šfo
 
ATTRIBUTE_UNUSED
)

47 
	}
}

49 cÚ¡ *
	$¢d_š¡r_h—d”_g‘_Çme
(cÚ¡ *
šfo
 
ATTRIBUTE_UNUSED
)

51  
NULL
;

52 
	}
}

54 
	$¢d_š¡r_h—d”_g‘_ty³
(cÚ¡ *
šfo
 
ATTRIBUTE_UNUSED
)

57 
	}
}

59 cÚ¡ *
	$¢d_š¡r_h—d”_g‘_fÜm©
(cÚ¡ *
šfo
 
ATTRIBUTE_UNUSED
)

61  
NULL
;

62 
	}
}

64 cÚ¡ *
	$¢d_š¡r_h—d”_g‘_®Ÿs
(cÚ¡ *
šfo
 
ATTRIBUTE_UNUSED
)

66  
NULL
;

67 
	}
}

69 *
	$¢d_š¡r_h—d”_g‘_d©a
(cÚ¡ *
šfo
 
ATTRIBUTE_UNUSED
)

71  
NULL
;

72 
	}
}

74 
	$¢d_š¡r_h—d”_g‘_fŞlow_®Ÿs
(cÚ¡ *
šfo
 
ATTRIBUTE_UNUSED
)

77 
	}
}

79 
	$¢d_š¡r_h—d”_£t_id
(*
šfo
 
ATTRIBUTE_UNUSED
,

80 cÚ¡ *
id
 
ATTRIBUTE_UNUSED
)

82 
	}
}

84 
	$¢d_š¡r_h—d”_£t_şu¡”
(*
šfo
 
ATTRIBUTE_UNUSED
,

85 
şu¡”
 
ATTRIBUTE_UNUSED
)

87 
	}
}

89 
	$¢d_š¡r_h—d”_£t_cmd
(*
šfo
 
ATTRIBUTE_UNUSED
,

90 
cmd
 
ATTRIBUTE_UNUSED
)

92 
	}
}

94 
	$¢d_š¡r_h—d”_£t_Ën
(*
šfo
 
ATTRIBUTE_UNUSED
,

95 
size_t
 
Ën
 
ATTRIBUTE_UNUSED
)

97 
	}
}

99 
	$¢d_š¡r_h—d”_£t_Çme
(*
šfo
 
ATTRIBUTE_UNUSED
,

100 cÚ¡ *
Çme
 
ATTRIBUTE_UNUSED
)

102 
	}
}

104 
	$¢d_š¡r_h—d”_£t_ty³
(*
šfo
 
ATTRIBUTE_UNUSED
,

105 
ty³
 
ATTRIBUTE_UNUSED
)

107 
	}
}

109 
	$¢d_š¡r_h—d”_£t_fÜm©
(*
šfo
 
ATTRIBUTE_UNUSED
,

110 cÚ¡ *
fÜm©
 
ATTRIBUTE_UNUSED
)

112 
	}
}

114 
	$¢d_š¡r_h—d”_£t_®Ÿs
(*
šfo
 
ATTRIBUTE_UNUSED
,

115 cÚ¡ *
š¡r
 
ATTRIBUTE_UNUSED
)

117 
	}
}

119 
	$¢d_š¡r_h—d”_£t_fŞlow_®Ÿs
(*
šfo
 
ATTRIBUTE_UNUSED
,

120 
v®
 
ATTRIBUTE_UNUSED
)

122 
	}
}

124 
	$¢d_š¡r_fm_ä“
(*
fm
 
ATTRIBUTE_UNUSED
)

127 
	}
}

129 
	$¢d_š¡r_fm_cÚv”t_to_¡»am
(*
fm
 
ATTRIBUTE_UNUSED
,

130 cÚ¡ *
Çme
 
ATTRIBUTE_UNUSED
,

131 **
__d©a
 
ATTRIBUTE_UNUSED
,

132 
size_t
 *
__size
 
ATTRIBUTE_UNUSED
)

134  -
ENXIO
;

135 
	}
}

137 
	$¢d_š¡r_fm_cÚv”t_äom_¡»am
(*
__d©a
 
ATTRIBUTE_UNUSED
,

138 
size_t
 
size
 
ATTRIBUTE_UNUSED
,

139 **
sim¶e
 
ATTRIBUTE_UNUSED
)

141  -
ENXIO
;

142 
	}
}

145 
	$¢d_š¡r_iwffff_İ’
(**
hªdË
 
ATTRIBUTE_UNUSED
,

146 cÚ¡ *
Çme_fff
 
ATTRIBUTE_UNUSED
,

147 cÚ¡ *
Çme_d©
 
ATTRIBUTE_UNUSED
)

149  -
ENXIO
;

150 
	}
}

152 
	$¢d_š¡r_iwffff_İ’_rom
(**
hªdË
 
ATTRIBUTE_UNUSED
,

153 
ÿrd
 
ATTRIBUTE_UNUSED
,

154 
bªk
 
ATTRIBUTE_UNUSED
,

155 
fe
 
ATTRIBUTE_UNUSED
)

157  -
ENXIO
;

158 
	}
}

160 
	$¢d_š¡r_iwffff_İ’_rom_fe
(**
hªdË
 
ATTRIBUTE_UNUSED
,

161 cÚ¡ *
Çme
 
ATTRIBUTE_UNUSED
,

162 
bªk
 
ATTRIBUTE_UNUSED
,

163 
fe
 
ATTRIBUTE_UNUSED
)

165  -
ENXIO
;

166 
	}
}

168 
	$¢d_š¡r_iwffff_şo£
(*
hªdË
 
ATTRIBUTE_UNUSED
)

171 
	}
}

173 
	$¢d_š¡r_iwffff_ä“
(*
__š¡r
 
ATTRIBUTE_UNUSED
)

176 
	}
}

178 
	$¢d_š¡r_iwffff_lßd
(*
iwf
 
ATTRIBUTE_UNUSED
,

179 
bªk
 
ATTRIBUTE_UNUSED
,

180 
´g
 
ATTRIBUTE_UNUSED
,

181 **
__iwffff
 
ATTRIBUTE_UNUSED
)

183  -
ENXIO
;

184 
	}
}

186 
	$¢d_š¡r_iwffff_cÚv”t_to_¡»am
(*
iwffff
 
ATTRIBUTE_UNUSED
,

187 cÚ¡ *
Çme
 
ATTRIBUTE_UNUSED
,

188 **
__d©a
 
ATTRIBUTE_UNUSED
,

189 
size_t
 *
__size
 
ATTRIBUTE_UNUSED
)

191  -
ENXIO
;

192 
	}
}

194 
	$¢d_š¡r_iwffff_cÚv”t_äom_¡»am
(*
d©a
 
ATTRIBUTE_UNUSED
,

195 
size_t
 
size
 
ATTRIBUTE_UNUSED
,

196 **
iwffff
 
ATTRIBUTE_UNUSED
)

198  -
ENXIO
;

199 
	}
}

202 
	$¢d_š¡r_sim¶e_ä“
(*
sim¶e
 
ATTRIBUTE_UNUSED
)

205 
	}
}

207 
	$¢d_š¡r_sim¶e_cÚv”t_to_¡»am
(*
sim¶e
 
ATTRIBUTE_UNUSED
,

208 cÚ¡ *
Çme
 
ATTRIBUTE_UNUSED
,

209 **
__d©a
 
ATTRIBUTE_UNUSED
,

210 
size_t
 *
__size
 
ATTRIBUTE_UNUSED
)

212  -
ENXIO
;

213 
	}
}

215 
	$¢d_š¡r_sim¶e_cÚv”t_äom_¡»am
(*
__d©a
 
ATTRIBUTE_UNUSED
,

216 
size_t
 
size
 
ATTRIBUTE_UNUSED
,

217 **
sim¶e
 
ATTRIBUTE_UNUSED
)

219  -
ENXIO
;

220 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_symbols.c

21 #iâdeà
PIC


23 cÚ¡ *
_¢d_moduË_£q_hw
;

25 cÚ¡ **
	g¢d_£q_İ’_objeùs
[] = {

26 &
_¢d_moduË_£q_hw


29 *
	$¢d_£q_İ’_symbŞs
()

31  
¢d_£q_İ’_objeùs
;

32 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seqmid.c

23 
	~"£q_loÿl.h
"

24 
	~<uni¡d.h
>

25 
	~<¡ršg.h
>

26 
	~<fú.h
>

27 
	~<ùy³.h
>

28 
	~<sys/ioùl.h
>

46 
	$¢d_£q_cÚŒŞ_queue
(
¢d_£q_t
 *
£q
, 
q
, 
ty³
, 
v®ue
, 
¢d_£q_ev’t_t
 *
ev
)

48 
¢d_£q_ev’t_t
 
tm³v
;

49 ià(
ev
 =ğ
NULL
) {

50 
	`¢d_£q_ev_ş—r
(&
tm³v
);

51 
ev
 = &
tm³v
;

52 
	`¢d_£q_ev_£t_dœeù
(
ev
);

54 
	`¢d_£q_ev_£t_queue_cÚŒŞ
(
ev
, 
ty³
, 
q
, 
v®ue
);

55  
	`¢d_£q_ev’t_ouut
(
£q
, 
ev
);

56 
	}
}

71 
	$¢d_£q_ü—‹_sim¶e_pÜt
(
¢d_£q_t
 *
£q
, cÚ¡ *
Çme
,

72 
ÿps
, 
ty³
)

74 
¢d_£q_pÜt_šfo_t
 
pšfo
;

75 
»suÉ
;

77 
	`mem£t
(&
pšfo
, 0, (pinfo));

78 ià(
Çme
)

79 
	`¡ºıy
(
pšfo
.
Çme
,‚ame, (pinfo.name) - 1);

80 
pšfo
.
ÿ·b™y
 = 
ÿps
;

81 
pšfo
.
ty³
 =ype;

82 
pšfo
.
midi_chªÃls
 = 16;

83 
pšfo
.
midi_voiûs
 = 64;

84 
pšfo
.
syÁh_voiûs
 = 0;

86 
»suÉ
 = 
	`¢d_£q_ü—‹_pÜt
(
£q
, &
pšfo
);

87 ià(
»suÉ
 < 0)

88  
»suÉ
;

90  
pšfo
.
addr
.
pÜt
;

91 
	}
}

101 
	$¢d_£q_d–‘e_sim¶e_pÜt
(
¢d_£q_t
 *
£q
, 
pÜt
)

103  
	`¢d_£q_d–‘e_pÜt
(
£q
, 
pÜt
);

104 
	}
}

119 
	$¢d_£q_cÚÃù_äom
(
¢d_£q_t
 *
£q
, 
mypÜt
, 
¤c_ş›Á
, 
¤c_pÜt
)

121 
¢d_£q_pÜt_subsüibe_t
 
subs
;

123 
	`mem£t
(&
subs
, 0, (subs));

124 
subs
.
£nd”
.
ş›Á
 = 
¤c_ş›Á
;

125 
subs
.
£nd”
.
pÜt
 = 
¤c_pÜt
;

127 
subs
.
de¡
.
ş›Á
 = 
	`¢d_£q_ş›Á_id
(
£q
);

128 
subs
.
de¡
.
pÜt
 = 
mypÜt
;

130  
	`¢d_£q_subsüibe_pÜt
(
£q
, &
subs
);

131 
	}
}

146 
	$¢d_£q_cÚÃù_to
(
¢d_£q_t
 *
£q
, 
mypÜt
, 
de¡_ş›Á
, 
de¡_pÜt
)

148 
¢d_£q_pÜt_subsüibe_t
 
subs
;

150 
	`mem£t
(&
subs
, 0, (subs));

152 
subs
.
£nd”
.
ş›Á
 = 
	`¢d_£q_ş›Á_id
(
£q
);

153 
subs
.
£nd”
.
pÜt
 = 
mypÜt
;

154 
subs
.
de¡
.
ş›Á
 = 
de¡_ş›Á
;

155 
subs
.
de¡
.
pÜt
 = 
de¡_pÜt
;

157  
	`¢d_£q_subsüibe_pÜt
(
£q
, &
subs
);

158 
	}
}

173 
	$¢d_£q_discÚÃù_äom
(
¢d_£q_t
 *
£q
, 
mypÜt
, 
¤c_ş›Á
, 
¤c_pÜt
)

175 
¢d_£q_pÜt_subsüibe_t
 
subs
;

177 
	`mem£t
(&
subs
, 0, (subs));

178 
subs
.
£nd”
.
ş›Á
 = 
¤c_ş›Á
;

179 
subs
.
£nd”
.
pÜt
 = 
¤c_pÜt
;

181 
subs
.
de¡
.
ş›Á
 = 
	`¢d_£q_ş›Á_id
(
£q
);

182 
subs
.
de¡
.
pÜt
 = 
mypÜt
;

184  
	`¢d_£q_unsubsüibe_pÜt
(
£q
, &
subs
);

185 
	}
}

200 
	$¢d_£q_discÚÃù_to
(
¢d_£q_t
 *
£q
, 
mypÜt
, 
de¡_ş›Á
, 
de¡_pÜt
)

202 
¢d_£q_pÜt_subsüibe_t
 
subs
;

204 
	`mem£t
(&
subs
, 0, (subs));

206 
subs
.
£nd”
.
ş›Á
 = 
	`¢d_£q_ş›Á_id
(
£q
);

207 
subs
.
£nd”
.
pÜt
 = 
mypÜt
;

208 
subs
.
de¡
.
ş›Á
 = 
de¡_ş›Á
;

209 
subs
.
de¡
.
pÜt
 = 
de¡_pÜt
;

211  
	`¢d_£q_unsubsüibe_pÜt
(
£q
, &
subs
);

212 
	}
}

226 
	$¢d_£q_£t_ş›Á_Çme
(
¢d_£q_t
 *
£q
, cÚ¡ *
Çme
)

228 
¢d_£q_ş›Á_šfo_t
 
šfo
;

229 
”r
;

231 ià((
”r
 = 
	`¢d_£q_g‘_ş›Á_šfo
(
£q
, &
šfo
)) < 0)

232  
”r
;

233 
	`¡ºıy
(
šfo
.
Çme
,‚ame, (info.name) - 1);

234  
	`¢d_£q_£t_ş›Á_šfo
(
£q
, &
šfo
);

235 
	}
}

245 
	$¢d_£q_£t_ş›Á_ev’t_f‹r
(
¢d_£q_t
 *
£q
, 
ev’t_ty³
)

247 
¢d_£q_ş›Á_šfo_t
 
šfo
;

248 
”r
;

250 ià((
”r
 = 
	`¢d_£q_g‘_ş›Á_šfo
(
£q
, &
šfo
)) < 0)

251  
”r
;

252 
	`¢d_£q_ş›Á_šfo_ev’t_f‹r_add
(&
šfo
, 
ev’t_ty³
);

253  
	`¢d_£q_£t_ş›Á_šfo
(
£q
, &
šfo
);

254 
	}
}

264 
	$¢d_£q_£t_ş›Á_midi_v”siÚ
(
¢d_£q_t
 *
£q
, 
midi_v”siÚ
)

266 
¢d_£q_ş›Á_šfo_t
 
šfo
;

267 
”r
;

269 ià((
”r
 = 
	`¢d_£q_g‘_ş›Á_šfo
(
£q
, &
šfo
)) < 0)

270  
”r
;

271 
	`¢d_£q_ş›Á_šfo_£t_midi_v”siÚ
(&
šfo
, 
midi_v”siÚ
);

272  
	`¢d_£q_£t_ş›Á_šfo
(
£q
, &
šfo
);

273 
	}
}

283 
	$¢d_£q_£t_ş›Á_ump_cÚv”siÚ
(
¢d_£q_t
 *
£q
, 
’abË
)

285 
¢d_£q_ş›Á_šfo_t
 
šfo
;

286 
”r
;

288 ià((
”r
 = 
	`¢d_£q_g‘_ş›Á_šfo
(
£q
, &
šfo
)) < 0)

289  
”r
;

290 
	`¢d_£q_ş›Á_šfo_£t_ump_cÚv”siÚ
(&
šfo
, 
’abË
);

291  
	`¢d_£q_£t_ş›Á_šfo
(
£q
, &
šfo
);

292 
	}
}

302 
	$¢d_£q_£t_ş›Á_poŞ_ouut
(
¢d_£q_t
 *
£q
, 
size_t
 
size
)

304 
¢d_£q_ş›Á_poŞ_t
 
šfo
;

305 
”r
;

307 ià((
”r
 = 
	`¢d_£q_g‘_ş›Á_poŞ
(
£q
, &
šfo
)) < 0)

308  
”r
;

309 
šfo
.
ouut_poŞ
 = 
size
;

310  
	`¢d_£q_£t_ş›Á_poŞ
(
£q
, &
šfo
);

311 
	}
}

321 
	$¢d_£q_£t_ş›Á_poŞ_ouut_room
(
¢d_£q_t
 *
£q
, 
size_t
 
size
)

323 
¢d_£q_ş›Á_poŞ_t
 
šfo
;

324 
”r
;

326 ià((
”r
 = 
	`¢d_£q_g‘_ş›Á_poŞ
(
£q
, &
šfo
)) < 0)

327  
”r
;

328 
šfo
.
ouut_room
 = 
size
;

329  
	`¢d_£q_£t_ş›Á_poŞ
(
£q
, &
šfo
);

330 
	}
}

340 
	$¢d_£q_£t_ş›Á_poŞ_šput
(
¢d_£q_t
 *
£q
, 
size_t
 
size
)

342 
¢d_£q_ş›Á_poŞ_t
 
šfo
;

343 
”r
;

345 ià((
”r
 = 
	`¢d_£q_g‘_ş›Á_poŞ
(
£q
, &
šfo
)) < 0)

346  
”r
;

347 
šfo
.
šput_poŞ
 = 
size
;

348  
	`¢d_£q_£t_ş›Á_poŞ
(
£q
, &
šfo
);

349 
	}
}

358 
	$¢d_£q_»£t_poŞ_ouut
(
¢d_£q_t
 *
£q
)

360  
	`¢d_£q_drİ_ouut
(
£q
);

361 
	}
}

370 
	$¢d_£q_»£t_poŞ_šput
(
¢d_£q_t
 *
£q
)

372  
	`¢d_£q_drİ_šput
(
£q
);

373 
	}
}

384 
	$¢d_£q_sync_ouut_queue
(
¢d_£q_t
 *
£q
)

386 
”r
;

387 
¢d_£q_ş›Á_poŞ_t
 
šfo
;

388 
§ved_room
;

389 
pŞlfd
 
pfd
;

391 
	`as£¹
(
£q
);

393 ià((
”r
 = 
	`¢d_£q_g‘_ş›Á_poŞ
(
£q
, &
šfo
)) < 0)

394  
”r
;

395 
§ved_room
 = 
šfo
.
ouut_room
;

396 
šfo
.
ouut_room
 = info.
ouut_poŞ
;

397 ià((
”r
 = 
	`¢d_£q_£t_ş›Á_poŞ
(
£q
, &
šfo
)) < 0)

398  
”r
;

400 
pfd
.
fd
 = 
£q
->
pŞl_fd
;

401 
pfd
.
ev’ts
 = 
POLLOUT
;

402 
”r
 = 
	`pŞl
(&
pfd
, 1, -1);

404 
šfo
.
ouut_room
 = 
§ved_room
;

405 
	`¢d_£q_£t_ş›Á_poŞ
(
£q
, &
šfo
);

406  
”r
;

407 
	}
}

425 
	$¢d_£q_·r£_add»ss
(
¢d_£q_t
 *
£q
, 
¢d_£q_addr_t
 *
addr
, cÚ¡ *
¬g
)

427 *
p
, *
buf
;

428 cÚ¡ *
s
;

429 
c
;

430 
ş›Á
, 
pÜt
 = 0;

431 
Ën
;

433 
	`as£¹
(
addr
 && 
¬g
);

435 
c
 = *
¬g
;

436 ià(
c
 == '"' || c == '\'') {

437 
s
 = ++
¬g
;

438 *
s
 && * !ğ
c
) s++;

439 
Ën
 = 
s
 - 
¬g
;

440 ià(*
s
)

441 
s
++;

442 ià(*
s
) {

443 ià(*
s
 != '.' && *s != ':')

444  -
EINVAL
;

445 ià((
pÜt
 = 
	`©oi
(
s
 + 1)) < 0)

446  -
EINVAL
;

449 ià((
p
 = 
	`¡½brk
(
¬g
, ":.")è!ğ
NULL
) {

450 ià((
pÜt
 = 
	`©oi
(
p
 + 1)) < 0)

451  -
EINVAL
;

452 
Ën
 = ()(
p
 - 
¬g
);

454 
Ën
 = 
	`¡¾’
(
¬g
);

457 ià(
Ën
 == 0)

458  -
EINVAL
;

459 
buf
 = 
	`®loÿ
(
Ën
 + 1);

460 
	`¡ºıy
(
buf
, 
¬g
, 
Ën
);

461 
buf
[
Ën
] = '\0';

462 
addr
->
pÜt
 =…ort;

463 ià(
	`§ã_¡¹Ş
(
buf
, &
ş›Á
) == 0) {

464 
addr
->
ş›Á
 = client;

467 
¢d_£q_ş›Á_šfo_t
 
cšfo
;

469 ià(! 
£q
)

470  -
EINVAL
;

471 ià(
Ën
 <= 0)

472  -
EINVAL
;

473 
ş›Á
 = -1;

474 
cšfo
.
ş›Á
 = -1;

475 
	`¢d_£q_qu”y_Ãxt_ş›Á
(
£q
, &
cšfo
) >= 0) {

476 ià(!
	`¡ºcmp
(
¬g
, 
cšfo
.
Çme
, 
Ën
)) {

477 ià(
	`¡¾’
(
cšfo
.
Çme
è=ğ(
size_t
)
Ën
) {

479 
addr
->
ş›Á
 = 
cšfo
.client;

482 ià(
ş›Á
 < 0)

483 
ş›Á
 = 
cšfo
.client;

486 ià(
ş›Á
 >= 0) {

488 
addr
->
ş›Á
 = client;

491  -
ENOENT
;

494 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/shmarea.c

31 
	~"cÚfig.h
"

34 #ifdeà
HAVE_SYS_SHM_H


36 
	~<¡dio.h
>

37 
	~<¡dlib.h
>

38 #ià
HAVE_MALLOC_H


39 
	~<m®loc.h
>

41 
	~<¡ršg.h
>

42 
	~<”ºo.h
>

43 
	~<pŞl.h
>

44 
	~<sys/mmª.h
>

45 
	~<sys/shm.h
>

46 
	~"li¡.h
"

48 #iâdeà
DOC_HIDDEN


49 
	s¢d_shm_¬—
 {

50 
li¡_h—d
 
	mli¡
;

51 
	mshmid
;

52 *
	m±r
;

53 
	msh¬e
;

57 
LIST_HEAD
(
shm_¬—s
);

68 
¢d_shm_¬—
 *
	$¢d_shm_¬—_ü—‹
(
shmid
, *
±r
)

70 
¢d_shm_¬—
 *
¬—
 = 
	`m®loc
((*area));

71 ià(
¬—
) {

72 
¬—
->
shmid
 = shmid;

73 
¬—
->
±r
 =…tr;

74 
¬—
->
sh¬e
 = 1;

75 
	`li¡_add_
(&
¬—
->
li¡
, &
shm_¬—s
);

77  
¬—
;

78 
	}
}

87 
¢d_shm_¬—
 *
	$¢d_shm_¬—_sh¬e
(
¢d_shm_¬—
 *
¬—
)

89 ià(
¬—
 =ğ
NULL
)

90  
NULL
;

91 
¬—
->
sh¬e
++;

92  
¬—
;

93 
	}
}

103 
	$¢d_shm_¬—_de¡roy
(
¢d_shm_¬—
 *
¬—
)

105 ià(
¬—
 =ğ
NULL
)

106  -
ENOENT
;

107 ià(--
¬—
->
sh¬e
)

109 
	`li¡_d–
(&
¬—
->
li¡
);

110 
	`shmdt
(
¬—
->
±r
);

111 
	`ä“
(
¬—
);

113 
	}
}

115 #iâdeà
DOC_HIDDEN


116 
	$¢d_shm_¬—_de¡ruùÜ
(è
	`__©Œibu‹__
 ((
de¡ruùÜ
));

118 
	$¢d_shm_¬—_de¡ruùÜ
()

120 
li¡_h—d
 *
pos
;

121 
¢d_shm_¬—
 *
¬—
;

123 
	`li¡_fÜ_—ch
(
pos
, &
shm_¬—s
) {

124 
¬—
 = 
	`li¡_’Œy
(
pos
, 
¢d_shm_¬—
, 
li¡
);

125 
	`shmdt
(
¬—
->
±r
);

127 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/socket.c

28 
	~"loÿl.h
"

29 
	~<¡dio.h
>

30 
	~<¡dlib.h
>

31 
	~<¡ddef.h
>

32 
	~<uni¡d.h
>

33 
	~<¡ršg.h
>

34 
	~<sys/sock‘.h
>

35 
	~<sys/uio.h
>

36 
	~<sys/un.h
>

37 
	~<Ãtš‘/š.h
>

38 
	~<sys/ioùl.h
>

39 
	~<Ãt/if.h
>

40 
	~<Ãtdb.h
>

42 #iâdeà
DOC_HIDDEN


43 
	$¢d_£nd_fd
(
sock
, *
d©a
, 
size_t
 
Ën
, 
fd
)

45 
»t
;

46 
size_t
 
cmsg_Ën
 = 
	`CMSG_LEN
(());

47 
cmsghdr
 *
cmsg
 = 
	`®loÿ
(
cmsg_Ën
);

48 *
fds
 = (*è
	`CMSG_DATA
(
cmsg
);

49 
msghdr
 msghdr;

50 
iovec
 
vec
;

52 
vec
.
iov_ba£
 = (*)&
d©a
;

53 
vec
.
iov_Ën
 = 
Ën
;

55 
cmsg
->
cmsg_Ën
 = cmsg_len;

56 
cmsg
->
cmsg_Ëv–
 = 
SOL_SOCKET
;

57 
cmsg
->
cmsg_ty³
 = 
SCM_RIGHTS
;

58 *
fds
 = 
fd
;

60 
msghdr
.
msg_Çme
 = 
NULL
;

61 
msghdr
.
msg_Çm–’
 = 0;

62 
msghdr
.
msg_iov
 = &
vec
;

63 
msghdr
.
msg_iovËn
 = 1;

64 
msghdr
.
msg_cÚŒŞ
 = 
cmsg
;

65 
msghdr
.
msg_cÚŒŞËn
 = 
cmsg_Ën
;

66 
msghdr
.
msg_æags
 = 0;

68 
»t
 = 
	`£ndmsg
(
sock
, &
msghdr
, 0 );

69 ià(
»t
 < 0) {

70 
	`SYSERR
("sendmsg failed");

71  -
”ºo
;

73  
»t
;

74 
	}
}

76 
	$¢d_»ûive_fd
(
sock
, *
d©a
, 
size_t
 
Ën
, *
fd
)

78 
»t
;

79 
size_t
 
cmsg_Ën
 = 
	`CMSG_LEN
(());

80 
cmsghdr
 *
cmsg
 = 
	`®loÿ
(
cmsg_Ën
);

81 *
fds
 = (*è
	`CMSG_DATA
(
cmsg
);

82 
msghdr
 msghdr;

83 
iovec
 
vec
;

85 
vec
.
iov_ba£
 = (*)&
d©a
;

86 
vec
.
iov_Ën
 = 
Ën
;

88 
cmsg
->
cmsg_Ën
 = cmsg_len;

89 
cmsg
->
cmsg_Ëv–
 = 
SOL_SOCKET
;

90 
cmsg
->
cmsg_ty³
 = 
SCM_RIGHTS
;

91 *
fds
 = -1;

93 
msghdr
.
msg_Çme
 = 
NULL
;

94 
msghdr
.
msg_Çm–’
 = 0;

95 
msghdr
.
msg_iov
 = &
vec
;

96 
msghdr
.
msg_iovËn
 = 1;

97 
msghdr
.
msg_cÚŒŞ
 = 
cmsg
;

98 
msghdr
.
msg_cÚŒŞËn
 = 
cmsg_Ën
;

99 
msghdr
.
msg_æags
 = 0;

101 
»t
 = 
	`»cvmsg
(
sock
, &
msghdr
, 0);

102 ià(
»t
 < 0) {

103 
	`SYSERR
("recvmsg failed");

104  -
”ºo
;

106 *
fd
 = *
fds
;

107  
»t
;

108 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer.c

70 
	~"tim”_loÿl.h
"

72 
	~<sigÇl.h
>

74 
	$¢d_tim”_İ’_cÚf
(
¢d_tim”_t
 **
tim”
,

75 cÚ¡ *
Çme
, 
¢d_cÚfig_t
 *
tim”_roÙ
,

76 
¢d_cÚfig_t
 *
tim”_cÚf
, 
mode
)

78 cÚ¡ *
¡r
;

79 
buf
[256], 
”rbuf
[256];

80 
”r
;

81 
¢d_cÚfig_t
 *
cÚf
, *
ty³_cÚf
 = 
NULL
;

82 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

83 cÚ¡ *
id
;

84 cÚ¡ *
lib
 = 
NULL
, *
İ’_Çme
 = NULL;

85 (*
İ’_func
)(
¢d_tim”_t
 **, cÚ¡ *, 
¢d_cÚfig_t
 *, snd_cÚfig_ˆ*, èğ
NULL
;

86 #iâdeà
PIC


87 *
	`¢d_tim”_İ’_symbŞs
();

89 *
h
 = 
NULL
;

90 ià(
	`¢d_cÚfig_g‘_ty³
(
tim”_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

91 ià(
Çme
)

92 
	`SNDERR
("Inv®idy³ fÜ TIMER % defš™iÚ", 
Çme
);

94 
	`SNDERR
("Invalidype for TIMER definition");

95  -
EINVAL
;

97 
”r
 = 
	`¢d_cÚfig_£¬ch
(
tim”_cÚf
, "ty³", &
cÚf
);

98 ià(
”r
 < 0) {

99 
	`SNDERR
("type is‚ot defined");

100  
”r
;

102 
”r
 = 
	`¢d_cÚfig_g‘_id
(
cÚf
, &
id
);

103 ià(
”r
 < 0) {

104 
	`SNDERR
("unableo get id");

105  
”r
;

107 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
cÚf
, &
¡r
);

108 ià(
”r
 < 0) {

109 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

110  
”r
;

112 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
tim”_roÙ
, "tim”_ty³", 
¡r
, &
ty³_cÚf
);

113 ià(
”r
 >= 0) {

114 ià(
	`¢d_cÚfig_g‘_ty³
(
ty³_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

115 
	`SNDERR
("Inv®idy³ fÜ TIMERy³ % defš™iÚ", 
¡r
);

116 
_”r
;

118 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
ty³_cÚf
) {

119 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

120 cÚ¡ *
id
;

121 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

123 ià(
	`¡rcmp
(
id
, "comment") == 0)

125 ià(
	`¡rcmp
(
id
, "lib") == 0) {

126 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
lib
);

127 ià(
”r
 < 0) {

128 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

129 
_”r
;

133 ià(
	`¡rcmp
(
id
, "open") == 0) {

134 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
İ’_Çme
);

135 ià(
”r
 < 0) {

136 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

137 
_”r
;

141 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

142 
”r
 = -
EINVAL
;

143 
_”r
;

146 ià(!
İ’_Çme
) {

147 
İ’_Çme
 = 
buf
;

148 
	`¢´štf
(
buf
, (buf), "_¢d_tim”_%s_İ’", 
¡r
);

150 #iâdeà
PIC


151 
	`¢d_tim”_İ’_symbŞs
();

153 
h
 = 
	`INTERNAL
(
¢d_dlİ’
)(
lib
, 
RTLD_NOW
, 
”rbuf
, (errbuf));

154 ià(
h
)

155 
İ’_func
 = 
	`¢d_dlsym
(
h
, 
İ’_Çme
, 
	`SND_DLSYM_VERSION
(
SND_TIMER_DLSYM_VERSION
));

156 
”r
 = 0;

157 ià(!
h
) {

158 
	`SNDERR
("CªnÙ o³Àsh¬ed†ib¿ry % (%s)", 
lib
, 
”rbuf
);

159 
”r
 = -
ENOENT
;

160 } ià(!
İ’_func
) {

161 
	`SNDERR
("symbŞ % i nÙ defšed insid%s", 
İ’_Çme
, 
lib
);

162 
	`¢d_dlşo£
(
h
);

163 
”r
 = -
ENXIO
;

165 
_”r
:

166 ià(
ty³_cÚf
)

167 
	`¢d_cÚfig_d–‘e
(
ty³_cÚf
);

168 ià(! 
”r
) {

169 
”r
 = 
	`İ’_func
(
tim”
, 
Çme
, 
tim”_roÙ
, 
tim”_cÚf
, 
mode
);

170 ià(
”r
 < 0)

171 
	`¢d_dlşo£
(
h
);

173 (*
tim”
)->
dl_hªdË
 = 
h
;

175  
”r
;

176 
	}
}

178 
	$¢d_tim”_İ’_noupd©e
(
¢d_tim”_t
 **
tim”
, 
¢d_cÚfig_t
 *
roÙ
, cÚ¡ *
Çme
, 
mode
)

180 
”r
;

181 
¢d_cÚfig_t
 *
tim”_cÚf
;

182 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "tim”", 
Çme
, &
tim”_cÚf
);

183 ià(
”r
 < 0) {

184 
	`SNDERR
("UnknowÀtim” %s", 
Çme
);

185  
”r
;

187 
”r
 = 
	`¢d_tim”_İ’_cÚf
(
tim”
, 
Çme
, 
roÙ
, 
tim”_cÚf
, 
mode
);

188 
	`¢d_cÚfig_d–‘e
(
tim”_cÚf
);

189  
”r
;

190 
	}
}

202 
	$¢d_tim”_İ’
(
¢d_tim”_t
 **
tim”
, cÚ¡ *
Çme
, 
mode
)

204 
¢d_cÚfig_t
 *
tİ
;

205 
”r
;

207 
	`as£¹
(
tim”
 && 
Çme
);

208 ià(
	`_¢d_is_ucm_deviû
(
Çme
)) {

209 
Çme
 = 
	`uc_mgr_®ibcfg_by_deviû
(&
tİ
,‚ame);

210 ià(
Çme
 =ğ
NULL
)

211  -
ENODEV
;

213 
”r
 = 
	`¢d_cÚfig_upd©e_»f
(&
tİ
);

214 ià(
”r
 < 0)

215  
”r
;

217 
”r
 = 
	`¢d_tim”_İ’_noupd©e
(
tim”
, 
tİ
, 
Çme
, 
mode
);

218 
	`¢d_cÚfig_uÄef
(
tİ
);

219  
”r
;

220 
	}
}

233 
	$¢d_tim”_İ’_lcÚf
(
¢d_tim”_t
 **
tim”
, cÚ¡ *
Çme
,

234 
mode
, 
¢d_cÚfig_t
 *
lcÚf
)

236 
	`as£¹
(
tim”
 && 
Çme
 && 
lcÚf
);

237  
	`¢d_tim”_İ’_noupd©e
(
tim”
, 
lcÚf
, 
Çme
, 
mode
);

238 
	}
}

248 
	$¢d_tim”_şo£
(
¢d_tim”_t
 *
tim”
)

250 
”r
;

251 
	`as£¹
(
tim”
);

252 !
	`li¡_em±y
(&
tim”
->
async_hªdËrs
)) {

253 
¢d_async_hªdËr_t
 *
h
 = 
	`li¡_’Œy
(
tim”
->
async_hªdËrs
.
Ãxt
, snd_async_hªdËr_t, 
hli¡
);

254 
	`¢d_async_d–_hªdËr
(
h
);

256 
”r
 = 
tim”
->
İs
->
	`şo£
(timer);

257 ià(
tim”
->
dl_hªdË
)

258 
	`¢d_dlşo£
(
tim”
->
dl_hªdË
);

259 
	`ä“
(
tim”
->
Çme
);

260 
	`ä“
(
tim”
);

261  
”r
;

262 
	}
}

272 cÚ¡ *
	$¢d_tim”_Çme
(
¢d_tim”_t
 *
tim”
)

274 
	`as£¹
(
tim”
);

275  
tim”
->
Çme
;

276 
	}
}

285 
¢d_tim”_ty³_t
 
	$¢d_tim”_ty³
(
¢d_tim”_t
 *
tim”
)

287 
	`as£¹
(
tim”
);

288  
tim”
->
ty³
;

289 
	}
}

301 
	$¢d_async_add_tim”_hªdËr
(
¢d_async_hªdËr_t
 **
hªdËr
, 
¢d_tim”_t
 *
tim”
,

302 
¢d_async_ÿÎback_t
 
ÿÎback
, *
´iv©e_d©a
)

304 
”r
;

305 
was_em±y
;

306 
¢d_async_hªdËr_t
 *
h
;

307 
”r
 = 
	`¢d_async_add_hªdËr
(&
h
, 
tim”
->
pŞl_fd
,

308 
ÿÎback
, 
´iv©e_d©a
);

309 ià(
”r
 < 0)

310  
”r
;

311 
h
->
ty³
 = 
SND_ASYNC_HANDLER_TIMER
;

312 
h
->
u
.
tim”
 =imer;

313 
was_em±y
 = 
	`li¡_em±y
(&
tim”
->
async_hªdËrs
);

314 
	`li¡_add_
(&
h
->
hli¡
, &
tim”
->
async_hªdËrs
);

315 ià(
was_em±y
) {

316 
”r
 = 
	`¢d_tim”_async
(
tim”
, 
	`¢d_async_hªdËr_g‘_signo
(
h
), 
	`g‘pid
());

317 ià(
”r
 < 0) {

318 
	`¢d_async_d–_hªdËr
(
h
);

319  
”r
;

322 *
hªdËr
 = 
h
;

324 
	}
}

331 
¢d_tim”_t
 *
	$¢d_async_hªdËr_g‘_tim”
(
¢d_async_hªdËr_t
 *
hªdËr
)

333 ià(
hªdËr
->
ty³
 !ğ
SND_ASYNC_HANDLER_TIMER
) {

334 
	`SNDMSG
("šv®id hªdË¸ty³ %d", 
hªdËr
->
ty³
);

335  
NULL
;

337  
hªdËr
->
u
.
tim”
;

338 
	}
}

345 
	$¢d_tim”_pŞl_desütÜs_couÁ
(
¢d_tim”_t
 *
tim”
)

347 
	`as£¹
(
tim”
);

349 
	}
}

358 
	$¢d_tim”_pŞl_desütÜs
(
¢d_tim”_t
 *
tim”
, 
pŞlfd
 *
pfds
, 
¥aû
)

360 
	`as£¹
(
tim”
);

361 ià(
¥aû
 >= 1) {

362 
pfds
->
fd
 = 
tim”
->
pŞl_fd
;

363 
tim”
->
mode
 & 
O_ACCMODE
) {

364 
O_WRONLY
:

365 
pfds
->
ev’ts
 = 
POLLOUT
|
POLLERR
|
POLLNVAL
;

367 
O_RDONLY
:

368 
pfds
->
ev’ts
 = 
POLLIN
|
POLLERR
|
POLLNVAL
;

370 
O_RDWR
:

371 
pfds
->
ev’ts
 = 
POLLOUT
|
POLLIN
|
POLLERR
|
POLLNVAL
;

374  -
EIO
;

379 
	}
}

389 
	$¢d_tim”_pŞl_desütÜs_»v’ts
(
¢d_tim”_t
 *
tim”
, 
pŞlfd
 *
pfds
, 
nfds
, *
»v’ts
)

391 
	`as£¹
(
tim”
 && 
pfds
 && 
»v’ts
);

392 ià(
nfds
 == 1) {

393 *
»v’ts
 = 
pfds
->revents;

396  -
EINVAL
;

397 
	}
}

405 
	$¢d_tim”_nÚblock
(
¢d_tim”_t
 *
tim”
, 
nÚblock
)

407 
”r
;

408 
	`as£¹
(
tim”
);

409 ià((
”r
 = 
tim”
->
İs
->
	`nÚblock
Ñim”, 
nÚblock
)) < 0)

410  
”r
;

411 ià(
nÚblock
)

412 
tim”
->
mode
 |ğ
SND_TIMER_OPEN_NONBLOCK
;

414 
tim”
->
mode
 &ğ~
SND_TIMER_OPEN_NONBLOCK
;

416 
	}
}

418 #iâdeà
DOC_HIDDEN


428 
	$¢d_tim”_async
(
¢d_tim”_t
 *
tim”
, 
sig
, 
pid_t
 
pid
)

430 
	`as£¹
(
tim”
);

431 ià(
sig
 == 0)

432 
sig
 = 
SIGIO
;

433 ià(
pid
 == 0)

434 
pid
 = 
	`g‘pid
();

435  
tim”
->
İs
->
	`async
Ñim”, 
sig
, 
pid
);

436 
	}
}

443 
size_t
 
	$¢d_tim”_šfo_sizeof
()

445  (
¢d_tim”_šfo_t
);

446 
	}
}

456 
	$¢d_tim”_šfo_m®loc
(
¢d_tim”_šfo_t
 **
šfo
)

458 
	`as£¹
(
šfo
);

459 *
šfo
 = 
	`ÿÎoc
(1, (
¢d_tim”_šfo_t
));

460 ià(!*
šfo
)

461  -
ENOMEM
;

463 
	}
}

472 
	$¢d_tim”_šfo_ä“
(
¢d_tim”_šfo_t
 *
šfo
)

474 
	`as£¹
(
šfo
);

475 
	`ä“
(
šfo
);

476 
	}
}

483 
	$¢d_tim”_šfo_cİy
(
¢d_tim”_šfo_t
 *
d¡
, cÚ¡ snd_tim”_šfo_ˆ*
¤c
)

485 
	`as£¹
(
d¡
 && 
¤c
);

486 *
d¡
 = *
¤c
;

487 
	}
}

494 
	$¢d_tim”_šfo_is_¦ave
(
¢d_tim”_šfo_t
 * 
šfo
)

496 
	`as£¹
(
šfo
);

497  
šfo
->
æags
 & 
SNDRV_TIMER_FLG_SLAVE
 ? 1 : 0;

498 
	}
}

505 
	$¢d_tim”_šfo_g‘_ÿrd
(
¢d_tim”_šfo_t
 * 
šfo
)

507 
	`as£¹
(
šfo
);

508  
šfo
->
ÿrd
;

509 
	}
}

516 cÚ¡ *
	$¢d_tim”_šfo_g‘_id
(
¢d_tim”_šfo_t
 * 
šfo
)

518 
	`as£¹
(
šfo
);

519  (cÚ¡ *)
šfo
->
id
;

520 
	}
}

527 cÚ¡ *
	$¢d_tim”_šfo_g‘_Çme
(
¢d_tim”_šfo_t
 * 
šfo
)

529 
	`as£¹
(
šfo
);

530  (cÚ¡ *)
šfo
->
Çme
;

531 
	}
}

539 
	$¢d_tim”_šfo_g‘_»sŞutiÚ
(
¢d_tim”_šfo_t
 * 
šfo
)

541 
	`as£¹
(
šfo
);

542  
šfo
->
»sŞutiÚ
;

543 
	}
}

551 
	$¢d_tim”_šfo
(
¢d_tim”_t
 *
tim”
, 
¢d_tim”_šfo_t
 * 
šfo
)

553 
	`as£¹
(
tim”
);

554 
	`as£¹
(
šfo
);

555  
tim”
->
İs
->
	`šfo
Ñim”, 
šfo
);

556 
	}
}

562 
size_t
 
	$¢d_tim”_·¿ms_sizeof
()

564  (
¢d_tim”_·¿ms_t
);

565 
	}
}

575 
	$¢d_tim”_·¿ms_m®loc
(
¢d_tim”_·¿ms_t
 **
·¿ms
)

577 
	`as£¹
(
·¿ms
);

578 *
·¿ms
 = 
	`ÿÎoc
(1, (
¢d_tim”_·¿ms_t
));

579 ià(!*
·¿ms
)

580  -
ENOMEM
;

582 
	}
}

591 
	$¢d_tim”_·¿ms_ä“
(
¢d_tim”_·¿ms_t
 *
·¿ms
)

593 
	`as£¹
(
·¿ms
);

594 
	`ä“
(
·¿ms
);

595 
	}
}

602 
	$¢d_tim”_·¿ms_cİy
(
¢d_tim”_·¿ms_t
 *
d¡
, cÚ¡ snd_tim”_·¿ms_ˆ*
¤c
)

604 
	`as£¹
(
d¡
 && 
¤c
);

605 *
d¡
 = *
¤c
;

606 
	}
}

613 
	$¢d_tim”_·¿ms_£t_auto_¡¬t
(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
auto_¡¬t
)

615 
	`as£¹
(
·¿ms
);

616 ià(
auto_¡¬t
)

617 
·¿ms
->
æags
 |ğ
SNDRV_TIMER_PSFLG_AUTO
;

619 
·¿ms
->
æags
 &ğ~
SNDRV_TIMER_PSFLG_AUTO
;

621 
	}
}

628 
	$¢d_tim”_·¿ms_g‘_auto_¡¬t
(
¢d_tim”_·¿ms_t
 * 
·¿ms
)

630 
	`as£¹
(
·¿ms
);

631  
·¿ms
->
æags
 & 
SNDRV_TIMER_PSFLG_AUTO
 ? 1 : 0;

632 
	}
}

639 #iâdeà
DOXYGEN


640 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_tim”_·¿ms_£t_exşusive
)(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
exşusive
)

642 
	$¢d_tim”_·¿ms_£t_exşusive
(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
exşusive
)

645 
	`as£¹
(
·¿ms
);

646 ià(
exşusive
)

647 
·¿ms
->
æags
 |ğ
SNDRV_TIMER_PSFLG_EXCLUSIVE
;

649 
·¿ms
->
æags
 &ğ~
SNDRV_TIMER_PSFLG_EXCLUSIVE
;

651 
	}
}

652 
u£_deçuÉ_symbŞ_v”siÚ
(
__¢d_tim”_·¿ms_£t_exşusive
, 
¢d_tim”_·¿ms_£t_exşusive
, 
ALSA_0
.9.0);

659 #iâdeà
DOXYGEN


660 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_tim”_·¿ms_g‘_exşusive
)(
¢d_tim”_·¿ms_t
 * 
·¿ms
)

662 
	$¢d_tim”_·¿ms_g‘_exşusive
(
¢d_tim”_·¿ms_t
 * 
·¿ms
)

665 
	`as£¹
(
·¿ms
);

666  
·¿ms
->
æags
 & 
SNDRV_TIMER_PSFLG_EXCLUSIVE
 ? 1 : 0;

667 
	}
}

668 
u£_deçuÉ_symbŞ_v”siÚ
(
__¢d_tim”_·¿ms_g‘_exşusive
, 
¢d_tim”_·¿ms_g‘_exşusive
, 
ALSA_0
.9.0);

675 
	$¢d_tim”_·¿ms_£t_—¾y_ev’t
(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
—¾y_ev’t
)

677 
	`as£¹
(
·¿ms
);

678 ià(
—¾y_ev’t
)

679 
·¿ms
->
æags
 |ğ
SNDRV_TIMER_PSFLG_EARLY_EVENT
;

681 
·¿ms
->
æags
 &ğ~
SNDRV_TIMER_PSFLG_EARLY_EVENT
;

683 
	}
}

690 
	$¢d_tim”_·¿ms_g‘_—¾y_ev’t
(
¢d_tim”_·¿ms_t
 * 
·¿ms
)

692 
	`as£¹
(
·¿ms
);

693  
·¿ms
->
æags
 & 
SNDRV_TIMER_PSFLG_EARLY_EVENT
 ? 1 : 0;

694 
	}
}

701 
	$¢d_tim”_·¿ms_£t_ticks
(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
ticks
)

703 
	`as£¹
(
·¿ms
);

704 
·¿ms
->
ticks
 =icks;

705 
	}
}

712 
	$¢d_tim”_·¿ms_g‘_ticks
(
¢d_tim”_·¿ms_t
 * 
·¿ms
)

714 
	`as£¹
(
·¿ms
);

715  
·¿ms
->
ticks
;

716 
	}
}

723 
	$¢d_tim”_·¿ms_£t_queue_size
(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
queue_size
)

725 
	`as£¹
(
·¿ms
);

726 
·¿ms
->
queue_size
 = queue_size;

727 
	}
}

734 
	$¢d_tim”_·¿ms_g‘_queue_size
(
¢d_tim”_·¿ms_t
 * 
·¿ms
)

736 
	`as£¹
(
·¿ms
);

737  
·¿ms
->
queue_size
;

738 
	}
}

745 #iâdeà
DOXYGEN


746 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_tim”_·¿ms_£t_f‹r
)(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
f‹r
)

748 
	$¢d_tim”_·¿ms_£t_f‹r
(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
f‹r
)

751 
	`as£¹
(
·¿ms
);

752 
·¿ms
->
f‹r
 = filter;

753 
	}
}

754 
u£_deçuÉ_symbŞ_v”siÚ
(
__¢d_tim”_·¿ms_£t_f‹r
, 
¢d_tim”_·¿ms_£t_f‹r
, 
ALSA_0
.9.0);

761 #iâdeà
DOXYGEN


762 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_tim”_·¿ms_g‘_f‹r
)(
¢d_tim”_·¿ms_t
 * 
·¿ms
)

764 
	$¢d_tim”_·¿ms_g‘_f‹r
(
¢d_tim”_·¿ms_t
 * 
·¿ms
)

767 
	`as£¹
(
·¿ms
);

768  
·¿ms
->
f‹r
;

769 
	}
}

770 
u£_deçuÉ_symbŞ_v”siÚ
(
__¢d_tim”_·¿ms_g‘_f‹r
, 
¢d_tim”_·¿ms_g‘_f‹r
, 
ALSA_0
.9.0);

778 
	$¢d_tim”_·¿ms
(
¢d_tim”_t
 *
tim”
, 
¢d_tim”_·¿ms_t
 * 
·¿ms
)

780 
	`as£¹
(
tim”
);

781 
	`as£¹
(
·¿ms
);

782  
tim”
->
İs
->
	`·¿ms
Ñim”, 
·¿ms
);

783 
	}
}

789 
size_t
 
	$¢d_tim”_¡©us_sizeof
()

791  (
¢d_tim”_¡©us_t
);

792 
	}
}

802 
	$¢d_tim”_¡©us_m®loc
(
¢d_tim”_¡©us_t
 **
¡©us
)

804 
	`as£¹
(
¡©us
);

805 *
¡©us
 = 
	`ÿÎoc
(1, (
¢d_tim”_¡©us_t
));

806 ià(!*
¡©us
)

807  -
ENOMEM
;

809 
	}
}

818 
	$¢d_tim”_¡©us_ä“
(
¢d_tim”_¡©us_t
 *
¡©us
)

820 
	`as£¹
(
¡©us
);

821 
	`ä“
(
¡©us
);

822 
	}
}

829 
	$¢d_tim”_¡©us_cİy
(
¢d_tim”_¡©us_t
 *
d¡
, cÚ¡ snd_tim”_¡©us_ˆ*
¤c
)

831 
	`as£¹
(
d¡
 && 
¤c
);

832 *
d¡
 = *
¤c
;

833 
	}
}

842 
¢d_htime¡amp_t
 
	$¢d_tim”_¡©us_g‘_time¡amp
(
¢d_tim”_¡©us_t
 * 
¡©us
)

844 
	`as£¹
(
¡©us
);

845  
¡©us
->
t¡amp
;

846 
	}
}

853 
	$¢d_tim”_¡©us_g‘_»sŞutiÚ
(
¢d_tim”_¡©us_t
 * 
¡©us
)

855 
	`as£¹
(
¡©us
);

856  
¡©us
->
»sŞutiÚ
;

857 
	}
}

864 
	$¢d_tim”_¡©us_g‘_lo¡
(
¢d_tim”_¡©us_t
 * 
¡©us
)

866 
	`as£¹
(
¡©us
);

867  
¡©us
->
lo¡
;

868 
	}
}

875 
	$¢d_tim”_¡©us_g‘_ov”run
(
¢d_tim”_¡©us_t
 * 
¡©us
)

877 
	`as£¹
(
¡©us
);

878  
¡©us
->
ov”run
;

879 
	}
}

886 
	$¢d_tim”_¡©us_g‘_queue
(
¢d_tim”_¡©us_t
 * 
¡©us
)

888 
	`as£¹
(
¡©us
);

889  
¡©us
->
queue
;

890 
	}
}

898 
	$¢d_tim”_¡©us
(
¢d_tim”_t
 *
tim”
, 
¢d_tim”_¡©us_t
 * 
¡©us
)

900 
	`as£¹
(
tim”
);

901 
	`as£¹
(
¡©us
);

902  
tim”
->
İs
->
	`¡©us
Ñim”, 
¡©us
);

903 
	}
}

910 
	$¢d_tim”_¡¬t
(
¢d_tim”_t
 *
tim”
)

912 
	`as£¹
(
tim”
);

913  
tim”
->
İs
->
	`¹_¡¬t
(timer);

914 
	}
}

921 
	$¢d_tim”_¡İ
(
¢d_tim”_t
 *
tim”
)

923 
	`as£¹
(
tim”
);

924  
tim”
->
İs
->
	`¹_¡İ
(timer);

925 
	}
}

932 
	$¢d_tim”_cÚtšue
(
¢d_tim”_t
 *
tim”
)

934 
	`as£¹
(
tim”
);

935  
tim”
->
İs
->
	`¹_cÚtšue
(timer);

936 
	}
}

944 
ssize_t
 
	$¢d_tim”_»ad
(
¢d_tim”_t
 *
tim”
, *
bufãr
, 
size_t
 
size
)

946 
	`as£¹
(
tim”
);

947 
	`as£¹
(((
tim”
->
mode
 & 
O_ACCMODE
è=ğ
O_RDONLY
è|| (Ñim”->mod& O_ACCMODEè=ğ
O_RDWR
));

948 
	`as£¹
(
bufãr
 || 
size
 == 0);

949  (
tim”
->
İs
->
»ad
)Ñim”, 
bufãr
, 
size
);

950 
	}
}

957 
	$¢d_tim”_šfo_g‘_ticks
(
¢d_tim”_šfo_t
 * 
šfo
)

959 
	`as£¹
(
šfo
);

961 
	}
}

962 #iâdeà
DOC_HIDDEN


963 
lšk_w¬nšg
(
¢d_tim”_šfo_g‘_ticks
, "Warning: snd_timer_info_get_ticks is deprecated");

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_hw.c

22 
	~"tim”_loÿl.h
"

24 #iâdeà
PIC


26 cÚ¡ *
	g_¢d_moduË_tim”_hw
 = "";

29 
	#SNDRV_FILE_TIMER
 
ALSA_DEVICE_DIRECTORY
 "tim”"

	)

30 
	#SNDRV_TIMER_VERSION_MAX
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 5)

	)

32 
	#SNDRV_TIMER_IOCTL_STATUS_OLD
 
	`_IOW
('T', 0x14, 
¢d_tim”_¡©us
)

	)

35 
	mSNDRV_TIMER_IOCTL_START_OLD
 = 
_IO
('T', 0x20),

36 
	mSNDRV_TIMER_IOCTL_STOP_OLD
 = 
_IO
('T', 0x21),

37 
	mSNDRV_TIMER_IOCTL_CONTINUE_OLD
 = 
_IO
('T', 0x22),

38 
	mSNDRV_TIMER_IOCTL_PAUSE_OLD
 = 
_IO
('T', 0x23),

41 
	$¢d_tim”_hw_şo£
(
¢d_tim”_t
 *
hªdË
)

43 
¢d_tim”_t
 *
tmr
 = 
hªdË
;

44 
»s
;

46 ià(!
tmr
)

47  -
EINVAL
;

48 
»s
 = 
	`şo£
(
tmr
->
pŞl_fd
è< 0 ? -
”ºo
 : 0;

49  
»s
;

50 
	}
}

52 
	$¢d_tim”_hw_nÚblock
(
¢d_tim”_t
 *
tim”
, 
nÚblock
)

54 
æags
;

55 
	`as£¹
(
tim”
);

56 ià((
æags
 = 
	`fú
(
tim”
->
pŞl_fd
, 
F_GETFL
)) < 0)

57  -
”ºo
;

58 ià(
nÚblock
)

59 
æags
 |ğ
O_NONBLOCK
;

61 
æags
 &ğ~
O_NONBLOCK
;

62 ià(
	`fú
(
tim”
->
pŞl_fd
, 
F_SETFL
, 
æags
) < 0)

63  -
”ºo
;

65 
	}
}

67 
	$¢d_tim”_hw_async
(
¢d_tim”_t
 *
tim”
, 
sig
, 
pid_t
 
pid
)

69 
æags
;

70 
fd
;

72 
	`as£¹
(
tim”
);

73 
fd
 = 
tim”
->
pŞl_fd
;

74 ià((
æags
 = 
	`fú
(
fd
, 
F_GETFL
)) < 0) {

75 
	`SYSERR
("F_GETFL failed");

76  -
”ºo
;

78 ià(
sig
 >= 0)

79 
æags
 |ğ
O_ASYNC
;

81 
æags
 &ğ~
O_ASYNC
;

82 ià(
	`fú
(
fd
, 
F_SETFL
, 
æags
) < 0) {

83 
	`SYSERR
("F_SETFL for O_ASYNC failed");

84  -
”ºo
;

86 ià(
sig
 < 0)

88 #ifdeà
F_SETSIG


89 ià(
	`fú
(
fd
, 
F_SETSIG
, ()
sig
) < 0) {

90 
	`SYSERR
("F_SETSIG failed");

91  -
”ºo
;

94 ià(
	`fú
(
fd
, 
F_SETOWN
, ()
pid
) < 0) {

95 
	`SYSERR
("F_SETOWN failed");

96  -
”ºo
;

99 
	}
}

101 
	$¢d_tim”_hw_šfo
(
¢d_tim”_t
 *
hªdË
, 
¢d_tim”_šfo_t
 * 
šfo
)

103 
¢d_tim”_t
 *
tmr
;

105 
tmr
 = 
hªdË
;

106 ià(!
tmr
 || !
šfo
)

107  -
EINVAL
;

108 ià(
	`ioùl
(
tmr
->
pŞl_fd
, 
SNDRV_TIMER_IOCTL_INFO
, 
šfo
) < 0)

109  -
”ºo
;

111 
	}
}

113 
	$¢d_tim”_hw_·¿ms
(
¢d_tim”_t
 *
hªdË
, 
¢d_tim”_·¿ms_t
 * 
·¿ms
)

115 
¢d_tim”_t
 *
tmr
;

117 
tmr
 = 
hªdË
;

118 ià(!
tmr
 || !
·¿ms
)

119  -
EINVAL
;

120 ià(
	`ioùl
(
tmr
->
pŞl_fd
, 
SNDRV_TIMER_IOCTL_PARAMS
, 
·¿ms
) < 0)

121  -
”ºo
;

123 
	}
}

125 
	$¢d_tim”_hw_¡©us
(
¢d_tim”_t
 *
hªdË
, 
¢d_tim”_¡©us_t
 * 
¡©us
)

127 
¢d_tim”_t
 *
tmr
;

128 
cmd
;

130 
tmr
 = 
hªdË
;

131 ià(!
tmr
 || !
¡©us
)

132  -
EINVAL
;

133 ià(
tmr
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 1))

134 
cmd
 = 
SNDRV_TIMER_IOCTL_STATUS_OLD
;

136 
cmd
 = 
SNDRV_TIMER_IOCTL_STATUS
;

137 ià(
	`ioùl
(
tmr
->
pŞl_fd
, 
cmd
, 
¡©us
) < 0)

138  -
”ºo
;

140 
	}
}

142 
	$¢d_tim”_hw_¡¬t
(
¢d_tim”_t
 *
hªdË
)

144 
¢d_tim”_t
 *
tmr
;

145 
cmd
;

147 
tmr
 = 
hªdË
;

148 ià(!
tmr
)

149  -
EINVAL
;

150 ià(
tmr
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4))

151 
cmd
 = 
SNDRV_TIMER_IOCTL_START_OLD
;

153 
cmd
 = 
SNDRV_TIMER_IOCTL_START
;

154 ià(
	`ioùl
(
tmr
->
pŞl_fd
, 
cmd
) < 0)

155  -
”ºo
;

157 
	}
}

159 
	$¢d_tim”_hw_¡İ
(
¢d_tim”_t
 *
hªdË
)

161 
¢d_tim”_t
 *
tmr
;

162 
cmd
;

164 
tmr
 = 
hªdË
;

165 ià(!
tmr
)

166  -
EINVAL
;

167 ià(
tmr
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4))

168 
cmd
 = 
SNDRV_TIMER_IOCTL_STOP_OLD
;

170 
cmd
 = 
SNDRV_TIMER_IOCTL_STOP
;

171 ià(
	`ioùl
(
tmr
->
pŞl_fd
, 
cmd
) < 0)

172  -
”ºo
;

174 
	}
}

176 
	$¢d_tim”_hw_cÚtšue
(
¢d_tim”_t
 *
hªdË
)

178 
¢d_tim”_t
 *
tmr
;

179 
cmd
;

181 
tmr
 = 
hªdË
;

182 ià(!
tmr
)

183  -
EINVAL
;

184 ià(
tmr
->
v”siÚ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4))

185 
cmd
 = 
SNDRV_TIMER_IOCTL_CONTINUE_OLD
;

187 
cmd
 = 
SNDRV_TIMER_IOCTL_CONTINUE
;

188 ià(
	`ioùl
(
tmr
->
pŞl_fd
, 
cmd
) < 0)

189  -
”ºo
;

191 
	}
}

193 
ssize_t
 
	$¢d_tim”_hw_»ad
(
¢d_tim”_t
 *
hªdË
, *
bufãr
, 
size_t
 
size
)

195 
¢d_tim”_t
 *
tmr
;

196 
ssize_t
 
»suÉ
;

198 
tmr
 = 
hªdË
;

199 ià(!
tmr
 || (!
bufãr
 && 
size
 > 0))

200  -
EINVAL
;

201 
»suÉ
 = 
	`»ad
(
tmr
->
pŞl_fd
, 
bufãr
, 
size
);

202 ià(
»suÉ
 < 0)

203  -
”ºo
;

204  
»suÉ
;

205 
	}
}

207 cÚ¡ 
¢d_tim”_İs_t
 
	g¢d_tim”_hw_İs
 = {

208 .
şo£
 = 
¢d_tim”_hw_şo£
,

209 .
	gnÚblock
 = 
¢d_tim”_hw_nÚblock
,

210 .
	gasync
 = 
¢d_tim”_hw_async
,

211 .
	gšfo
 = 
¢d_tim”_hw_šfo
,

212 .
	g·¿ms
 = 
¢d_tim”_hw_·¿ms
,

213 .
	g¡©us
 = 
¢d_tim”_hw_¡©us
,

214 .
	g¹_¡¬t
 = 
¢d_tim”_hw_¡¬t
,

215 .
	g¹_¡İ
 = 
¢d_tim”_hw_¡İ
,

216 .
	g¹_cÚtšue
 = 
¢d_tim”_hw_cÚtšue
,

217 .
	g»ad
 = 
¢d_tim”_hw_»ad
,

220 
	$¢d_tim”_hw_İ’
(
¢d_tim”_t
 **
hªdË
, cÚ¡ *
Çme
, 
dev_şass
, 
dev_sşass
, 
ÿrd
, 
deviû
, 
subdeviû
, 
mode
)

222 
fd
, 
v”
, 
tmode
, 
»t
;

223 
¢d_tim”_t
 *
tmr
;

224 
¢d_tim”_£Ëù
 
£l
;

226 *
hªdË
 = 
NULL
;

228 
tmode
 = 
O_RDONLY
;

229 ià(
mode
 & 
SND_TIMER_OPEN_NONBLOCK
)

230 
tmode
 |ğ
O_NONBLOCK
;

231 
fd
 = 
	`¢d_İ’_deviû
(
SNDRV_FILE_TIMER
, 
tmode
);

232 ià(
fd
 < 0)

233  -
”ºo
;

234 ià(
	`ioùl
(
fd
, 
SNDRV_TIMER_IOCTL_PVERSION
, &
v”
) < 0) {

235 
»t
 = -
”ºo
;

236 
	`şo£
(
fd
);

237  
»t
;

239 ià(
	`SNDRV_PROTOCOL_INCOMPATIBLE
(
v”
, 
SNDRV_TIMER_VERSION_MAX
)) {

240 
	`şo£
(
fd
);

241  -
SND_ERROR_INCOMPATIBLE_VERSION
;

243 ià(
mode
 & 
SND_TIMER_OPEN_TREAD
) {

244 
¬g
 = 1;

245 ià(
v”
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 3)) {

246 
»t
 = -
ENOTTY
;

247 
__no_Œ—d
;

249 ià(
	`ioùl
(
fd
, 
SNDRV_TIMER_IOCTL_TREAD
, &
¬g
) < 0) {

250 
»t
 = -
”ºo
;

251 
__no_Œ—d
:

252 
	`şo£
(
fd
);

253 
	`SNDMSG
("extended„ead is‚ot supported (SNDRV_TIMER_IOCTL_TREAD)");

254  
»t
;

257 
	`mem£t
(&
£l
, 0, (sel));

258 
£l
.
id
.
dev_şass
 = dev_class;

259 
£l
.
id
.
dev_sşass
 = dev_sclass;

260 
£l
.
id
.
ÿrd
 = card;

261 
£l
.
id
.
deviû
 = device;

262 
£l
.
id
.
subdeviû
 = subdevice;

263 ià(
	`ioùl
(
fd
, 
SNDRV_TIMER_IOCTL_SELECT
, &
£l
) < 0) {

264 
»t
 = -
”ºo
;

265 
	`şo£
(
fd
);

266  
»t
;

268 
tmr
 = (
¢d_tim”_t
 *è
	`ÿÎoc
(1, (snd_timer_t));

269 ià(
tmr
 =ğ
NULL
) {

270 
	`şo£
(
fd
);

271  -
ENOMEM
;

273 
tmr
->
ty³
 = 
SND_TIMER_TYPE_HW
;

274 
tmr
->
v”siÚ
 = 
v”
;

275 
tmr
->
mode
 = 
tmode
;

276 
tmr
->
Çme
 = 
	`¡rdup
(name);

277 
tmr
->
pŞl_fd
 = 
fd
;

278 
tmr
->
İs
 = &
¢d_tim”_hw_İs
;

279 
	`INIT_LIST_HEAD
(&
tmr
->
async_hªdËrs
);

280 *
hªdË
 = 
tmr
;

282 
	}
}

284 
	$_¢d_tim”_hw_İ’
(
¢d_tim”_t
 **
tim”
, *
Çme
,

285 
¢d_cÚfig_t
 *
roÙ
 
ATTRIBUTE_UNUSED
,

286 
¢d_cÚfig_t
 *
cÚf
, 
mode
)

288 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

289 
dev_şass
 = 
SND_TIMER_CLASS_GLOBAL
, 
dev_sşass
 = 
SND_TIMER_SCLASS_NONE
;

290 
ÿrd
 = 0, 
deviû
 = 0, 
subdeviû
 = 0;

291 
”r
;

292 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

293 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

294 cÚ¡ *
id
;

295 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

297 ià(
	`_¢d_cÚf_g’”ic_id
(
id
))

299 ià(
	`¡rcmp
(
id
, "class") == 0) {

300 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
dev_şass
);

301 ià(
”r
 < 0)

302  
”r
;

305 ià(
	`¡rcmp
(
id
, "sclass") == 0) {

306 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
dev_sşass
);

307 ià(
”r
 < 0)

308  
”r
;

311 ià(
	`¡rcmp
(
id
, "card") == 0) {

312 
”r
 = 
	`¢d_cÚfig_g‘_ÿrd
(
n
);

313 ià(
”r
 < 0)

314  
”r
;

315 
ÿrd
 = 
”r
;

318 ià(
	`¡rcmp
(
id
, "device") == 0) {

319 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
deviû
);

320 ià(
”r
 < 0)

321  
”r
;

324 ià(
	`¡rcmp
(
id
, "subdevice") == 0) {

325 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
subdeviû
);

326 ià(
”r
 < 0)

327  
”r
;

330 
	`SNDERR
("UÃx³ùed f›ld %s", 
id
);

331  -
EINVAL
;

333  
	`¢d_tim”_hw_İ’
(
tim”
, 
Çme
, 
dev_şass
, 
dev_sşass
, 
ÿrd
, 
deviû
, 
subdeviû
, 
mode
);

334 
	}
}

335 
SND_DLSYM_BUILD_VERSION
(
_¢d_tim”_hw_İ’
, 
SND_TIMER_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_local.h

22 
	~"loÿl.h
"

23 
	~<lim™s.h
>

24 
	~<sys/ioùl.h
>

26 #iâdeà
DOC_HIDDEN


28 (*
	mşo£
)(
¢d_tim”_t
 *
	mtim”
);

29 (*
	mnÚblock
)(
¢d_tim”_t
 *
	mtim”
, nonblock);

30 (*
	masync
)(
¢d_tim”_t
 *
	mtim”
, 
	msig
, 
pid_t
 
	mpid
);

31 (*
	mšfo
)(
¢d_tim”_t
 *
	mtim”
, 
¢d_tim”_šfo_t
 *info);

32 (*
	m·¿ms
)(
¢d_tim”_t
 *
	mtim”
, 
¢d_tim”_·¿ms_t
 *params);

33 (*
	m¡©us
)(
¢d_tim”_t
 *
	mtim”
, 
¢d_tim”_¡©us_t
 *status);

34 (*
	m¹_¡¬t
)(
¢d_tim”_t
 *
	mtim”
);

35 (*
	m¹_¡İ
)(
¢d_tim”_t
 *
	mtim”
);

36 (*
	m¹_cÚtšue
)(
¢d_tim”_t
 *
	mtim”
);

37 
ssize_t
 (*
»ad
)(
¢d_tim”_t
 *
	mtim”
, *
	mbufãr
, 
size_t
 
	msize
);

38 } 
	t¢d_tim”_İs_t
;

40 
	s_¢d_tim”
 {

41 
	mv”siÚ
;

42 *
	mdl_hªdË
;

43 *
	mÇme
;

44 
¢d_tim”_ty³_t
 
	mty³
;

45 
	mmode
;

46 
	mpŞl_fd
;

47 cÚ¡ 
¢d_tim”_İs_t
 *
	mİs
;

48 *
	m´iv©e_d©a
;

49 
li¡_h—d
 
	masync_hªdËrs
;

53 (*
	mşo£
)(
¢d_tim”_qu”y_t
 *
	mtim”
);

54 (*
	mÃxt_deviû
)(
¢d_tim”_qu”y_t
 *
	mtim”
, 
¢d_tim”_id_t
 *
	mtid
);

55 (*
	mšfo
)(
¢d_tim”_qu”y_t
 *
	mtim”
, 
¢d_tim”_gšfo_t
 *info);

56 (*
	m·¿ms
)(
¢d_tim”_qu”y_t
 *
	mtim”
, 
¢d_tim”_g·¿ms_t
 *
	mšfo
);

57 (*
	m¡©us
)(
¢d_tim”_qu”y_t
 *
	mtim”
, 
¢d_tim”_g¡©us_t
 *
	mšfo
);

58 } 
	t¢d_tim”_qu”y_İs_t
;

60 
	s_¢d_tim”_qu”y
 {

61 *
	mdl_hªdË
;

62 *
	mÇme
;

63 
¢d_tim”_ty³_t
 
	mty³
;

64 
	mmode
;

65 
	mpŞl_fd
;

66 cÚ¡ 
¢d_tim”_qu”y_İs_t
 *
	mİs
;

67 *
	m´iv©e_d©a
;

71 
¢d_tim”_hw_İ’
(
¢d_tim”_t
 **
hªdË
, cÚ¡ *
Çme
, 
dev_şass
, 
dev_sşass
, 
ÿrd
, 
deviû
, 
subdeviû
, 
mode
);

73 
¢d_tim”_qu”y_hw_İ’
(
¢d_tim”_qu”y_t
 **
hªdË
, cÚ¡ *
Çme
, 
mode
);

75 
¢d_tim”_async
(
¢d_tim”_t
 *
tim”
, 
sig
, 
pid_t
 
pid
);

77 #ifdeà
INTERNAL


78 
	$INTERNAL
(
¢d_tim”_·¿ms_£t_exşusive
)(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
exşusive
);

79 
	$INTERNAL
(
¢d_tim”_·¿ms_g‘_exşusive
)(
¢d_tim”_·¿ms_t
 * 
·¿ms
);

80 
	$INTERNAL
(
¢d_tim”_·¿ms_£t_f‹r
)(
¢d_tim”_·¿ms_t
 * 
·¿ms
, 
f‹r
);

81 
	$INTERNAL
(
¢d_tim”_·¿ms_g‘_f‹r
)(
¢d_tim”_·¿ms_t
 * 
·¿ms
);

82 
	$INTERNAL
(
¢d_tim”_qu”y_šfo
)(
¢d_tim”_qu”y_t
 *
tim”
, 
¢d_tim”_gšfo_t
 *
šfo
);

83 
	$INTERNAL
(
¢d_tim”_qu”y_·¿ms
)(
¢d_tim”_qu”y_t
 *
tim”
, 
¢d_tim”_g·¿ms_t
 *
·¿ms
);

84 
	$INTERNAL
(
¢d_tim”_qu”y_¡©us
)(
¢d_tim”_qu”y_t
 *
tim”
, 
¢d_tim”_g¡©us_t
 *
¡©us
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_query.c

29 
	~"tim”_loÿl.h
"

31 
	$¢d_tim”_qu”y_İ’_cÚf
(
¢d_tim”_qu”y_t
 **
tim”
,

32 cÚ¡ *
Çme
, 
¢d_cÚfig_t
 *
tim”_roÙ
,

33 
¢d_cÚfig_t
 *
tim”_cÚf
, 
mode
)

35 cÚ¡ *
¡r
;

36 
buf
[256], 
”rbuf
[256];

37 
”r
;

38 
¢d_cÚfig_t
 *
cÚf
, *
ty³_cÚf
 = 
NULL
;

39 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

40 cÚ¡ *
id
;

41 cÚ¡ *
lib
 = 
NULL
, *
İ’_Çme
 = NULL;

42 (*
İ’_func
)(
¢d_tim”_qu”y_t
 **, cÚ¡ *, 
¢d_cÚfig_t
 *, snd_cÚfig_ˆ*, èğ
NULL
;

43 #iâdeà
PIC


44 *
	`¢d_tim”_qu”y_İ’_symbŞs
();

46 *
h
 = 
NULL
;

47 ià(
	`¢d_cÚfig_g‘_ty³
(
tim”_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

48 ià(
Çme
)

49 
	`SNDERR
("Inv®idy³ fÜ TIMER % defš™iÚ", 
Çme
);

51 
	`SNDERR
("Invalidype for TIMER definition");

52  -
EINVAL
;

54 
”r
 = 
	`¢d_cÚfig_£¬ch
(
tim”_cÚf
, "ty³", &
cÚf
);

55 ià(
”r
 < 0) {

56 
	`SNDERR
("type is‚ot defined");

57  
”r
;

59 
”r
 = 
	`¢d_cÚfig_g‘_id
(
cÚf
, &
id
);

60 ià(
”r
 < 0) {

61 
	`SNDERR
("unableo get id");

62  
”r
;

64 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
cÚf
, &
¡r
);

65 ià(
”r
 < 0) {

66 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

67  
”r
;

69 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
tim”_roÙ
, "tim”_qu”y_ty³", 
¡r
, &
ty³_cÚf
);

70 ià(
”r
 >= 0) {

71 ià(
	`¢d_cÚfig_g‘_ty³
(
ty³_cÚf
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

72 
	`SNDERR
("Inv®idy³ fÜ TIMERy³ % defš™iÚ", 
¡r
);

73 
”r
 = -
EINVAL
;

74 
_”r
;

76 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
ty³_cÚf
) {

77 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

78 cÚ¡ *
id
;

79 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

81 ià(
	`¡rcmp
(
id
, "comment") == 0)

83 ià(
	`¡rcmp
(
id
, "lib") == 0) {

84 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
lib
);

85 ià(
”r
 < 0) {

86 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

87 
_”r
;

91 ià(
	`¡rcmp
(
id
, "open") == 0) {

92 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
İ’_Çme
);

93 ià(
”r
 < 0) {

94 
	`SNDERR
("Inv®idy³ fÜ %s", 
id
);

95 
_”r
;

99 
	`SNDERR
("UnknowÀf›ld %s", 
id
);

100 
”r
 = -
EINVAL
;

101 
_”r
;

104 ià(!
İ’_Çme
) {

105 
İ’_Çme
 = 
buf
;

106 
	`¢´štf
(
buf
, (buf), "_¢d_tim”_qu”y_%s_İ’", 
¡r
);

108 #iâdeà
PIC


109 
	`¢d_tim”_qu”y_İ’_symbŞs
();

111 
h
 = 
	`INTERNAL
(
¢d_dlİ’
)(
lib
, 
RTLD_NOW
, 
”rbuf
, (errbuf));

112 ià(
h
)

113 
İ’_func
 = 
	`¢d_dlsym
(
h
, 
İ’_Çme
, 
	`SND_DLSYM_VERSION
(
SND_TIMER_QUERY_DLSYM_VERSION
));

114 
”r
 = 0;

115 ià(!
h
) {

116 
	`SNDERR
("CªnÙ o³Àsh¬ed†ib¿ry % (%s)", 
lib
, 
”rbuf
);

117 
”r
 = -
ENOENT
;

118 } ià(!
İ’_func
) {

119 
	`SNDERR
("symbŞ % i nÙ defšed insid%s", 
İ’_Çme
, 
lib
);

120 
	`¢d_dlşo£
(
h
);

121 
”r
 = -
ENXIO
;

123 
_”r
:

124 ià(
ty³_cÚf
)

125 
	`¢d_cÚfig_d–‘e
(
ty³_cÚf
);

126 ià(! 
”r
) {

127 
”r
 = 
	`İ’_func
(
tim”
, 
Çme
, 
tim”_roÙ
, 
tim”_cÚf
, 
mode
);

128 ià(
”r
 < 0)

129 
	`¢d_dlşo£
(
h
);

131 (*
tim”
)->
dl_hªdË
 = 
h
;

133  
”r
;

134 
	}
}

136 
	$¢d_tim”_qu”y_İ’_noupd©e
(
¢d_tim”_qu”y_t
 **
tim”
, 
¢d_cÚfig_t
 *
roÙ
, cÚ¡ *
Çme
, 
mode
)

138 
”r
;

139 
¢d_cÚfig_t
 *
tim”_cÚf
;

140 
”r
 = 
	`¢d_cÚfig_£¬ch_defš™iÚ
(
roÙ
, "tim”_qu”y", 
Çme
, &
tim”_cÚf
);

141 ià(
”r
 < 0) {

142 
	`SNDERR
("UnknowÀtim” %s", 
Çme
);

143  
”r
;

145 
”r
 = 
	`¢d_tim”_qu”y_İ’_cÚf
(
tim”
, 
Çme
, 
roÙ
, 
tim”_cÚf
, 
mode
);

146 
	`¢d_cÚfig_d–‘e
(
tim”_cÚf
);

147  
”r
;

148 
	}
}

160 
	$¢d_tim”_qu”y_İ’
(
¢d_tim”_qu”y_t
 **
tim”
, cÚ¡ *
Çme
, 
mode
)

162 
¢d_cÚfig_t
 *
tİ
;

163 
”r
;

165 
	`as£¹
(
tim”
 && 
Çme
);

166 
”r
 = 
	`¢d_cÚfig_upd©e_»f
(&
tİ
);

167 ià(
”r
 < 0)

168  
”r
;

169 
”r
 = 
	`¢d_tim”_qu”y_İ’_noupd©e
(
tim”
, 
tİ
, 
Çme
, 
mode
);

170 
	`¢d_cÚfig_uÄef
(
tİ
);

171  
”r
;

172 
	}
}

185 
	$¢d_tim”_qu”y_İ’_lcÚf
(
¢d_tim”_qu”y_t
 **
tim”
, cÚ¡ *
Çme
,

186 
mode
, 
¢d_cÚfig_t
 *
lcÚf
)

188 
	`as£¹
(
tim”
 && 
Çme
 && 
lcÚf
);

189  
	`¢d_tim”_qu”y_İ’_noupd©e
(
tim”
, 
lcÚf
, 
Çme
, 
mode
);

190 
	}
}

200 
	$¢d_tim”_qu”y_şo£
(
¢d_tim”_qu”y_t
 *
tim”
)

202 
”r
;

203 
	`as£¹
(
tim”
);

204 
”r
 = 
tim”
->
İs
->
	`şo£
(timer);

205 ià(
tim”
->
dl_hªdË
)

206 
	`¢d_dlşo£
(
tim”
->
dl_hªdË
);

207 
	`ä“
(
tim”
->
Çme
);

208 
	`ä“
(
tim”
);

209  
”r
;

210 
	}
}

221 
	$¢d_tim”_qu”y_Ãxt_deviû
(
¢d_tim”_qu”y_t
 *
tim”
, 
¢d_tim”_id_t
 *
tid
)

223 
	`as£¹
(
tim”
);

224 
	`as£¹
(
tid
);

225  
tim”
->
İs
->
	`Ãxt_deviû
Ñim”, 
tid
);

226 
	}
}

232 
size_t
 
	$¢d_tim”_gšfo_sizeof
()

234  (
¢d_tim”_gšfo_t
);

235 
	}
}

245 
	$¢d_tim”_gšfo_m®loc
(
¢d_tim”_gšfo_t
 **
šfo
)

247 
	`as£¹
(
šfo
);

248 *
šfo
 = 
	`ÿÎoc
(1, (
¢d_tim”_gšfo_t
));

249 ià(!*
šfo
)

250  -
ENOMEM
;

252 
	}
}

261 
	$¢d_tim”_gšfo_ä“
(
¢d_tim”_gšfo_t
 *
šfo
)

263 
	`as£¹
(
šfo
);

264 
	`ä“
(
šfo
);

265 
	}
}

272 
	$¢d_tim”_gšfo_cİy
(
¢d_tim”_gšfo_t
 *
d¡
, cÚ¡ snd_tim”_gšfo_ˆ*
¤c
)

274 
	`as£¹
(
d¡
 && 
¤c
);

275 *
d¡
 = *
¤c
;

276 
	}
}

284 
	$¢d_tim”_gšfo_£t_tid
(
¢d_tim”_gšfo_t
 *
obj
, 
¢d_tim”_id_t
 *
tid
)

286 
obj
->
tid
 = *((
¢d_tim”_id_t
 *)tid);

288 
	}
}

295 
¢d_tim”_id_t
 *
	$¢d_tim”_gšfo_g‘_tid
(
¢d_tim”_gšfo_t
 *
obj
)

297  (
¢d_tim”_id_t
 *)&
obj
->
tid
;

298 
	}
}

305 
	$¢d_tim”_gšfo_g‘_æags
(
¢d_tim”_gšfo_t
 *
obj
)

307  
obj
->
æags
;

308 
	}
}

315 
	$¢d_tim”_gšfo_g‘_ÿrd
(
¢d_tim”_gšfo_t
 *
obj
)

317  
obj
->
ÿrd
;

318 
	}
}

325 *
	$¢d_tim”_gšfo_g‘_id
(
¢d_tim”_gšfo_t
 *
obj
)

327  (*)
obj
->
id
;

328 
	}
}

335 *
	$¢d_tim”_gšfo_g‘_Çme
(
¢d_tim”_gšfo_t
 *
obj
)

337  (*)
obj
->
Çme
;

338 
	}
}

345 
	$¢d_tim”_gšfo_g‘_»sŞutiÚ
(
¢d_tim”_gšfo_t
 *
obj
)

347  
obj
->
»sŞutiÚ
;

348 
	}
}

355 
	$¢d_tim”_gšfo_g‘_»sŞutiÚ_mš
(
¢d_tim”_gšfo_t
 *
obj
)

357  
obj
->
»sŞutiÚ_mš
;

358 
	}
}

365 
	$¢d_tim”_gšfo_g‘_»sŞutiÚ_max
(
¢d_tim”_gšfo_t
 *
obj
)

367  
obj
->
»sŞutiÚ_max
;

368 
	}
}

375 
	$¢d_tim”_gšfo_g‘_ş›Ás
(
¢d_tim”_gšfo_t
 *
obj
)

377  
obj
->
ş›Ás
;

378 
	}
}

386 #iâdeà
DOXYGEN


387 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_tim”_qu”y_šfo
)(
¢d_tim”_qu”y_t
 *
tim”
, 
¢d_tim”_gšfo_t
 *
šfo
)

389 
	$¢d_tim”_qu”y_šfo
(
¢d_tim”_qu”y_t
 *
tim”
, 
¢d_tim”_gšfo_t
 *
šfo
)

392 
	`as£¹
(
tim”
);

393 
	`as£¹
(
šfo
);

394  
tim”
->
İs
->
	`šfo
Ñim”, 
šfo
);

395 
	}
}

396 
u£_deçuÉ_symbŞ_v”siÚ
(
__¢d_tim”_qu”y_šfo
, 
¢d_tim”_qu”y_šfo
, 
ALSA_0
.9.0);

404 #iâdeà
DOXYGEN


405 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_tim”_qu”y_·¿ms
)(
¢d_tim”_qu”y_t
 *
tim”
, 
¢d_tim”_g·¿ms_t
 *
·¿ms
)

407 
	$¢d_tim”_qu”y_·¿ms
(
¢d_tim”_qu”y_t
 *
tim”
, 
¢d_tim”_g·¿ms_t
 *
·¿ms
)

410 
	`as£¹
(
tim”
);

411 
	`as£¹
(
·¿ms
);

412  
tim”
->
İs
->
	`·¿ms
Ñim”, 
·¿ms
);

413 
	}
}

414 
u£_deçuÉ_symbŞ_v”siÚ
(
__¢d_tim”_qu”y_·¿ms
, 
¢d_tim”_qu”y_·¿ms
, 
ALSA_0
.9.0);

422 #iâdeà
DOXYGEN


423 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_tim”_qu”y_¡©us
)(
¢d_tim”_qu”y_t
 *
tim”
, 
¢d_tim”_g¡©us_t
 *
¡©us
)

425 
	$¢d_tim”_qu”y_¡©us
(
¢d_tim”_qu”y_t
 *
tim”
, 
¢d_tim”_g¡©us_t
 *
¡©us
)

428 
	`as£¹
(
tim”
);

429 
	`as£¹
(
¡©us
);

430  
tim”
->
İs
->
	`¡©us
Ñim”, 
¡©us
);

431 
	}
}

432 
u£_deçuÉ_symbŞ_v”siÚ
(
__¢d_tim”_qu”y_¡©us
, 
¢d_tim”_qu”y_¡©us
, 
ALSA_0
.9.0);

438 
size_t
 
	$¢d_tim”_id_sizeof
()

440  (
¢d_tim”_id_t
);

441 
	}
}

451 
	$¢d_tim”_id_m®loc
(
¢d_tim”_id_t
 **
šfo
)

453 
	`as£¹
(
šfo
);

454 *
šfo
 = 
	`ÿÎoc
(1, (
¢d_tim”_id_t
));

455 ià(!*
šfo
)

456  -
ENOMEM
;

458 
	}
}

467 
	$¢d_tim”_id_ä“
(
¢d_tim”_id_t
 *
šfo
)

469 
	`as£¹
(
šfo
);

470 
	`ä“
(
šfo
);

471 
	}
}

478 
	$¢d_tim”_id_cİy
(
¢d_tim”_id_t
 *
d¡
, cÚ¡ snd_tim”_id_ˆ*
¤c
)

480 
	`as£¹
(
d¡
 && 
¤c
);

481 *
d¡
 = *
¤c
;

482 
	}
}

489 
	$¢d_tim”_id_£t_şass
(
¢d_tim”_id_t
 * 
tid
, 
dev_şass
)

491 
	`as£¹
(
tid
);

492 
tid
->
dev_şass
 = dev_class;

493 
	}
}

500 
	$¢d_tim”_id_g‘_şass
(
¢d_tim”_id_t
 * 
tid
)

502 
	`as£¹
(
tid
);

503  
tid
->
dev_şass
;

504 
	}
}

511 
	$¢d_tim”_id_£t_sşass
(
¢d_tim”_id_t
 * 
tid
, 
dev_sşass
)

513 
	`as£¹
(
tid
);

514 
tid
->
dev_sşass
 = dev_sclass;

515 
	}
}

522 
	$¢d_tim”_id_g‘_sşass
(
¢d_tim”_id_t
 * 
tid
)

524 
	`as£¹
(
tid
);

525  
tid
->
dev_sşass
;

526 
	}
}

533 
	$¢d_tim”_id_£t_ÿrd
(
¢d_tim”_id_t
 * 
tid
, 
ÿrd
)

535 
	`as£¹
(
tid
);

536 
tid
->
ÿrd
 = card;

537 
	}
}

544 
	$¢d_tim”_id_g‘_ÿrd
(
¢d_tim”_id_t
 * 
tid
)

546 
	`as£¹
(
tid
);

547  
tid
->
ÿrd
;

548 
	}
}

555 
	$¢d_tim”_id_£t_deviû
(
¢d_tim”_id_t
 * 
tid
, 
deviû
)

557 
	`as£¹
(
tid
);

558 
tid
->
deviû
 = device;

559 
	}
}

566 
	$¢d_tim”_id_g‘_deviû
(
¢d_tim”_id_t
 * 
tid
)

568 
	`as£¹
(
tid
);

569  
tid
->
deviû
;

570 
	}
}

577 
	$¢d_tim”_id_£t_subdeviû
(
¢d_tim”_id_t
 * 
tid
, 
subdeviû
)

579 
	`as£¹
(
tid
);

580 
tid
->
subdeviû
 = subdevice;

581 
	}
}

588 
	$¢d_tim”_id_g‘_subdeviû
(
¢d_tim”_id_t
 * 
tid
)

590 
	`as£¹
(
tid
);

591  
tid
->
subdeviû
;

592 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_query_hw.c

22 
	~"tim”_loÿl.h
"

24 #iâdeà
PIC


26 cÚ¡ *
	g_¢d_moduË_tim”_qu”y_hw
 = "";

29 
	#SNDRV_FILE_TIMER
 
ALSA_DEVICE_DIRECTORY
 "tim”"

	)

30 
	#SNDRV_TIMER_VERSION_MAX
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 0)

	)

32 
	$¢d_tim”_qu”y_hw_şo£
(
¢d_tim”_qu”y_t
 *
hªdË
)

34 
»s
;

36 ià(!
hªdË
)

37  -
EINVAL
;

38 
»s
 = 
	`şo£
(
hªdË
->
pŞl_fd
è< 0 ? -
”ºo
 : 0;

39  
»s
;

40 
	}
}

42 
	$¢d_tim”_qu”y_hw_Ãxt_deviû
(
¢d_tim”_qu”y_t
 *
hªdË
, 
¢d_tim”_id_t
 * 
tid
)

44 ià(!
hªdË
 || !
tid
)

45  -
EINVAL
;

46 ià(
	`ioùl
(
hªdË
->
pŞl_fd
, 
SNDRV_TIMER_IOCTL_NEXT_DEVICE
, 
tid
) < 0)

47  -
”ºo
;

49 
	}
}

51 
	$¢d_tim”_qu”y_hw_šfo
(
¢d_tim”_qu”y_t
 *
hªdË
, 
¢d_tim”_gšfo_t
 *
šfo
)

53 ià(!
hªdË
 || !
šfo
)

54  -
EINVAL
;

55 ià(
	`ioùl
(
hªdË
->
pŞl_fd
, 
SNDRV_TIMER_IOCTL_GINFO
, 
šfo
) < 0)

56  -
”ºo
;

58 
	}
}

60 
	$¢d_tim”_qu”y_hw_·¿ms
(
¢d_tim”_qu”y_t
 *
hªdË
, 
¢d_tim”_g·¿ms_t
 *
·¿ms
)

62 ià(!
hªdË
 || !
·¿ms
)

63  -
EINVAL
;

64 ià(
	`ioùl
(
hªdË
->
pŞl_fd
, 
SNDRV_TIMER_IOCTL_GPARAMS
, 
·¿ms
) < 0)

65  -
”ºo
;

67 
	}
}

69 
	$¢d_tim”_qu”y_hw_¡©us
(
¢d_tim”_qu”y_t
 *
hªdË
, 
¢d_tim”_g¡©us_t
 *
¡©us
)

71 ià(!
hªdË
 || !
¡©us
)

72  -
EINVAL
;

73 ià(
	`ioùl
(
hªdË
->
pŞl_fd
, 
SNDRV_TIMER_IOCTL_GSTATUS
, 
¡©us
) < 0)

74  -
”ºo
;

76 
	}
}

78 cÚ¡ 
¢d_tim”_qu”y_İs_t
 
	g¢d_tim”_qu”y_hw_İs
 = {

79 .
şo£
 = 
¢d_tim”_qu”y_hw_şo£
,

80 .
	gÃxt_deviû
 = 
¢d_tim”_qu”y_hw_Ãxt_deviû
,

81 .
	gšfo
 = 
¢d_tim”_qu”y_hw_šfo
,

82 .
	g·¿ms
 = 
¢d_tim”_qu”y_hw_·¿ms
,

83 .
	g¡©us
 = 
¢d_tim”_qu”y_hw_¡©us


86 
	$¢d_tim”_qu”y_hw_İ’
(
¢d_tim”_qu”y_t
 **
hªdË
, cÚ¡ *
Çme
, 
mode
)

88 
fd
, 
v”
, 
tmode
;

89 
¢d_tim”_qu”y_t
 *
tmr
;

91 *
hªdË
 = 
NULL
;

93 
tmode
 = 
O_RDONLY
;

94 ià(
mode
 & 
SND_TIMER_OPEN_NONBLOCK
)

95 
tmode
 |ğ
O_NONBLOCK
;

96 
fd
 = 
	`¢d_İ’_deviû
(
SNDRV_FILE_TIMER
, 
tmode
);

97 ià(
fd
 < 0)

98  -
”ºo
;

99 ià(
	`ioùl
(
fd
, 
SNDRV_TIMER_IOCTL_PVERSION
, &
v”
) < 0) {

100 
	`şo£
(
fd
);

101  -
”ºo
;

103 ià(
	`SNDRV_PROTOCOL_INCOMPATIBLE
(
v”
, 
SNDRV_TIMER_VERSION_MAX
)) {

104 
	`şo£
(
fd
);

105  -
SND_ERROR_INCOMPATIBLE_VERSION
;

107 
tmr
 = (
¢d_tim”_qu”y_t
 *è
	`ÿÎoc
(1, (snd_timer_query_t));

108 ià(
tmr
 =ğ
NULL
) {

109 
	`şo£
(
fd
);

110  -
ENOMEM
;

112 
tmr
->
ty³
 = 
SND_TIMER_TYPE_HW
;

113 
tmr
->
mode
 = 
tmode
;

114 
tmr
->
Çme
 = 
	`¡rdup
(name);

115 
tmr
->
pŞl_fd
 = 
fd
;

116 
tmr
->
İs
 = &
¢d_tim”_qu”y_hw_İs
;

117 *
hªdË
 = 
tmr
;

119 
	}
}

121 
	$_¢d_tim”_qu”y_hw_İ’
(
¢d_tim”_qu”y_t
 **
tim”
, *
Çme
,

122 
¢d_cÚfig_t
 *
roÙ
 
ATTRIBUTE_UNUSED
,

123 
¢d_cÚfig_t
 *
cÚf
, 
mode
)

125 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

126 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚf
) {

127 
¢d_cÚfig_t
 *
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

128 cÚ¡ *
id
;

129 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

131 ià(
	`_¢d_cÚf_g’”ic_id
(
id
))

133 
	`SNDERR
("UÃx³ùed f›ld %s", 
id
);

134  -
EINVAL
;

136  
	`¢d_tim”_qu”y_hw_İ’
(
tim”
, 
Çme
, 
mode
);

137 
	}
}

138 
SND_DLSYM_BUILD_VERSION
(
_¢d_tim”_qu”y_hw_İ’
, 
SND_TIMER_QUERY_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_symbols.c

21 #iâdeà
PIC


23 cÚ¡ *
_¢d_moduË_tim”_hw
;

25 cÚ¡ **
	g¢d_tim”_İ’_objeùs
[] = {

26 &
_¢d_moduË_tim”_hw


29 *
	$¢d_tim”_İ’_symbŞs
()

31  (*)
¢d_tim”_İ’_objeùs
[0];

32 
	}
}

35 cÚ¡ *
_¢d_moduË_tim”_qu”y_hw
;

37 cÚ¡ **
	g¢d_tim”_qu”y_İ’_objeùs
[] = {

38 &
_¢d_moduË_tim”_qu”y_hw


41 *
	$¢d_tim”_qu”y_İ’_symbŞs
()

43  
¢d_tim”_qu”y_İ’_objeùs
;

44 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/builder.c

20 
	~"lg_loÿl.h
"

23 
ssize_t
 
	$twr™e
(
¢d_lg_t
 *
lg
, *
d©a
, 
size_t
 
d©a_size
)

25 ià(
lg
->
bš_pos
 + 
d©a_size
 >¶g->
bš_size
)

26  -
EIO
;

27 
	`memıy
(
lg
->
bš
 +¶g->
bš_pos
, 
d©a
, 
d©a_size
);

28 
lg
->
bš_pos
 +ğ
d©a_size
;

29  
d©a_size
;

30 
	}
}

33 
ssize_t
 
	$wr™e_block_h—d”
(
¢d_lg_t
 *
lg
, 
ty³
,

34 
v’dÜ_ty³
,

35 
v”siÚ
, 
šdex
,

36 
size_t
 
·ylßd_size
, 
couÁ
)

38 
¢d_soc_lg_hdr
 
hdr
;

40 
	`mem£t
(&
hdr
, 0, (hdr));

41 
hdr
.
magic
 = 
SND_SOC_TPLG_MAGIC
;

42 
hdr
.
abi
 = 
SND_SOC_TPLG_ABI_VERSION
;

43 
hdr
.
ty³
 =ype;

44 
hdr
.
v’dÜ_ty³
 = vendor_type;

45 
hdr
.
v”siÚ
 = version;

46 
hdr
.
·ylßd_size
 =…ayload_size;

47 
hdr
.
šdex
 = index;

48 
hdr
.
size
 = (hdr);

49 
hdr
.
couÁ
 = count;

52 ià(
lg
->
bš_pos
 !ğlg->
Ãxt_hdr_pos
) {

53 
	`SNDERR
("New header is‡t offset 0x%zx but file"

55 
lg
->
Ãxt_hdr_pos
,¶g->
bš_pos
,

56 
lg
->
bš_pos
 >¶g->
Ãxt_hdr_pos
 ? "ahead" : "behind",

57 
lg
->
bš_pos
 -¶g->
Ãxt_hdr_pos
);

58  -
EINVAL
;

61 
	`lg_log
(
lg
, 'B',¶g->
bš_pos
,

63 "v”siÚ %d", 
šdex
, 
ty³
, 
couÁ
,

64 ()
·ylßd_size
, ()payload_size,

65 
v’dÜ_ty³
, 
v”siÚ
);

67 
lg
->
Ãxt_hdr_pos
 +ğ
hdr
.
·ylßd_size
 + (hdr);

69  
	`twr™e
(
lg
, &
hdr
, (hdr));

70 
	}
}

72 
	$wr™e_–em_block
(
¢d_lg_t
 *
lg
,

73 
li¡_h—d
 *
ba£
, 
size_t
 
size
,

74 
lg_ty³
, cÚ¡ *
obj_Çme
)

76 
li¡_h—d
 *
pos
, *
sub_pos
, *
sub_ba£
;

77 
lg_–em
 *
–em
, *
–em_Ãxt
;

78 
size_t
 
tÙ®_size
 = 0, 
couÁ
 = 0, 
block_size
 = 0;

79 
ssize_t
 
»t
, 
wsize
;

81 
sub_ba£
 = 
ba£
;

82 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

84 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

86 ià(
–em
->
compound_–em
)

89 
–em_Ãxt
 = 
	`li¡_’Œy
(
pos
->
Ãxt
, 
lg_–em
, 
li¡
);

90 
block_size
 +ğ
–em
->
size
;

91 
couÁ
++;

93 ià((
pos
->
Ãxt
 =ğ
ba£
è|| (
–em_Ãxt
->
šdex
 !ğ
–em
->index)) {

95 
»t
 = 
	`wr™e_block_h—d”
(
lg
, 
lg_ty³
, 
–em
->
v’dÜ_ty³
,

96 
lg
->
v”siÚ
, 
–em
->
šdex
, 
block_size
, 
couÁ
);

97 ià(
»t
 < 0) {

98 
	`SNDERR
("failedo write %s block %d",

99 
obj_Çme
, 
»t
);

100  
»t
;

104 
	`li¡_fÜ_—ch
(
sub_pos
, 
sub_ba£
) {

105 
–em
 = 
	`li¡_’Œy
(
sub_pos
, 
lg_–em
, 
li¡
);

107 ià(
–em
->
compound_–em
)

110 ià(
–em
->
ty³
 !ğ
SND_TPLG_TYPE_DAPM_GRAPH
)

111 
	`lg_log
(
lg
, 'B',¶g->
bš_pos
,

113 
obj_Çme
, 
–em
->
id
,ƒËm->
size
);

115 
	`lg_log
(
lg
, 'B',¶g->
bš_pos
,

117 
obj_Çme
, 
–em
->
rou‹
->
sourû
,

118 
–em
->
rou‹
->
cÚŒŞ
,

119 
–em
->
rou‹
->
sšk
,ƒËm->
size
);

121 
wsize
 = 
	`twr™e
(
lg
, 
–em
->
obj
,ƒËm->
size
);

122 ià(
wsize
 < 0)

123  
size
;

125 
tÙ®_size
 +ğ
wsize
;

127 ià(
sub_pos
 =ğ
pos
)

132 
sub_ba£
 = 
pos
;

133 
couÁ
 = 0;

134 
block_size
 = 0;

139 ià(
tÙ®_size
 !ğ
size
) {

140 
	`SNDERR
("size mismatch. Expected %zu wrote %zu",

141 
size
, 
tÙ®_size
);

142  -
EIO
;

146 
	}
}

148 
size_t
 
	$ÿlc_mªiã¡_size
(
¢d_lg_t
 *
lg
)

150  (
¢d_soc_lg_hdr
) +

151 (
lg
->
mªiã¡
) +

152 
lg
->
mªiã¡
.
´iv
.
size
;

153 
	}
}

155 
size_t
 
	$ÿlc_»®_size
(
li¡_h—d
 *
ba£
)

157 
li¡_h—d
 *
pos
;

158 
lg_–em
 *
–em
, *
–em_Ãxt
;

159 
size_t
 
size
 = 0;

161 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

163 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

166 ià(
–em
->
compound_–em
)

169 ià(
–em
->
size
 <= 0)

172 
size
 +ğ
–em
->size;

174 
–em_Ãxt
 = 
	`li¡_’Œy
(
pos
->
Ãxt
, 
lg_–em
, 
li¡
);

176 ià((
pos
->
Ãxt
 =ğ
ba£
è|| (
–em_Ãxt
->
šdex
 !ğ
–em
->index))

177 
size
 +ğ(
¢d_soc_lg_hdr
);

180  
size
;

181 
	}
}

183 
size_t
 
	$ÿlc_block_size
(
li¡_h—d
 *
ba£
)

185 
li¡_h—d
 *
pos
;

186 
lg_–em
 *
–em
;

187 
size_t
 
size
 = 0;

189 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

191 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

194 ià(
–em
->
compound_–em
)

197 
size
 +ğ
–em
->size;

200  
size
;

201 
	}
}

204 
ssize_t
 
	$wr™e_mªiã¡_d©a
(
¢d_lg_t
 *
lg
)

206 
ssize_t
 
»t
;

209 
»t
 = 
	`wr™e_block_h—d”
(
lg
, 
SND_SOC_TPLG_TYPE_MANIFEST
, 0,

210 
lg
->
v”siÚ
, 0,

211 (
lg
->
mªiã¡
è+¶g->mªiã¡.
´iv
.
size
, 1);

212 ià(
»t
 < 0) {

213 
	`SNDERR
("failedo write manifest block");

214  
»t
;

217 
	`lg_log
(
lg
, 'B',¶g->
bš_pos
, "manifest: write %d bytes",

218 (
lg
->
mªiã¡
));

219 
»t
 = 
	`twr™e
(
lg
, &lg->
mªiã¡
, (tplg->manifest));

220 ià(
»t
 >= 0) {

221 
	`lg_log
(
lg
, 'B',¶g->
bš_pos
,

223 
lg
->
mªiã¡
.
´iv
.
size
);

224 
»t
 = 
	`twr™e
(
lg
,¶g->
mªiã¡_pd©a
,¶g->
mªiã¡
.
´iv
.
size
);

226  
»t
;

227 
	}
}

229 
	$lg_wr™e_d©a
(
¢d_lg_t
 *
lg
)

231 
lg_bË
 *
Œ
;

232 
li¡_h—d
 *
li¡
;

233 
ssize_t
 
»t
;

234 
size_t
 
tÙ®_size
, 
size
;

235 
šdex
;

238 
tÙ®_size
 = 
	`ÿlc_mªiã¡_size
(
lg
);

239 
šdex
 = 0; index < 
lg_bË_™ems
; index++) {

240 
Œ
 = &
lg_bË
[
šdex
];

241 ià(!
Œ
->
bud
)

243 
li¡
 = (
li¡_h—d
 *)((*)
lg
 + 
Œ
->
loff
);

244 
size
 = 
	`ÿlc_»®_size
(
li¡
);

245 
tÙ®_size
 +ğ
size
;

249 
	`ä“
(
lg
->
bš
);

250 
lg
->
bš
 = 
	`m®loc
(
tÙ®_size
);

251 
lg
->
bš_pos
 = 0;

252 
lg
->
bš_size
 = 
tÙ®_size
;

253 ià(
lg
->
bš
 =ğ
NULL
) {

254 
lg
->
bš_size
 = 0;

255  -
ENOMEM
;

259 
»t
 = 
	`wr™e_mªiã¡_d©a
(
lg
);

260 ià(
»t
 < 0) {

261 
	`SNDERR
("çedØwr™mªiã¡ %d", 
»t
);

262  
»t
;

266 
šdex
 = 0; index < 
lg_bË_™ems
; index++) {

267 
Œ
 = &
lg_bË
[
šdex
];

268 ià(!
Œ
->
bud
)

270 
li¡
 = (
li¡_h—d
 *)((*)
lg
 + 
Œ
->
loff
);

272 
size
 = 
	`ÿlc_block_size
(
li¡
);

273 ià(
size
 == 0)

275 
	`lg_log
(
lg
, 'B',¶g->
bš_pos
,

277 
Œ
->
Çme
,±r->
ty³
,

278 
Œ
->
tsoc
, 
size
, size);

279 
»t
 = 
	`wr™e_–em_block
(
lg
, 
li¡
, 
size
,

280 
Œ
->
tsoc
,±r->
Çme
);

281 ià(
»t
 < 0) {

282 
	`SNDERR
("failedo write %sƒlements: %s",

283 
Œ
->
Çme
, 
	`¢d_¡»¼Ü
(-
»t
));

284  
»t
;

288 
	`lg_log
(
lg
, 'B',¶g->
bš_pos
, "total size is 0x%zx/%zd",

289 
lg
->
bš_pos
,plg->bin_pos);

291 ià(
tÙ®_size
 !ğ
lg
->
bš_pos
) {

292 
	`SNDERR
("total size mismatch (%zd != %zd)",

293 
tÙ®_size
, 
lg
->
bš_pos
);

294  -
EINVAL
;

298 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/channel.c

20 
	~"lg_loÿl.h
"

23 cÚ¡ 
m­_–em
 
	gchªÃl_m­
[] = {

24 {"mÚo", 
SNDRV_CHMAP_MONO
},

25 {"æ", 
SNDRV_CHMAP_FL
},

26 {"ä", 
SNDRV_CHMAP_FR
},

27 {"¾", 
SNDRV_CHMAP_RL
},

28 {"¼", 
SNDRV_CHMAP_RR
},

29 {"fc", 
SNDRV_CHMAP_FC
},

30 {"lã", 
SNDRV_CHMAP_LFE
},

31 {"¦", 
SNDRV_CHMAP_SL
},

32 {"¤", 
SNDRV_CHMAP_SR
},

33 {"rc", 
SNDRV_CHMAP_RC
},

34 {"æc", 
SNDRV_CHMAP_FLC
},

35 {"äc", 
SNDRV_CHMAP_FRC
},

36 {"¾c", 
SNDRV_CHMAP_RLC
},

37 {"¼c", 
SNDRV_CHMAP_RRC
},

38 {"æw", 
SNDRV_CHMAP_FLW
},

39 {"äw", 
SNDRV_CHMAP_FRW
},

40 {"æh", 
SNDRV_CHMAP_FLH
},

41 {"fch", 
SNDRV_CHMAP_FCH
},

42 {"äh", 
SNDRV_CHMAP_FRH
},

43 {"tc", 
SNDRV_CHMAP_TC
},

44 {"tæ", 
SNDRV_CHMAP_TFL
},

45 {"tä", 
SNDRV_CHMAP_TFR
},

46 {"tfc", 
SNDRV_CHMAP_TFC
},

47 {"Œl", 
SNDRV_CHMAP_TRL
},

48 {"Œr", 
SNDRV_CHMAP_TRR
},

49 {"Œc", 
SNDRV_CHMAP_TRC
},

50 {"tæc", 
SNDRV_CHMAP_TFLC
},

51 {"täc", 
SNDRV_CHMAP_TFRC
},

52 {"t¦", 
SNDRV_CHMAP_TSL
},

53 {"t¤", 
SNDRV_CHMAP_TSR
},

54 {"Îã", 
SNDRV_CHMAP_LLFE
},

55 {"¾ã", 
SNDRV_CHMAP_RLFE
},

56 {"bc", 
SNDRV_CHMAP_BC
},

57 {"blc", 
SNDRV_CHMAP_BLC
},

58 {"brc", 
SNDRV_CHMAP_BRC
},

62 
	$lookup_chªÃl
(cÚ¡ *
c
)

64 
i
;

66 
i
 = 0; i < 
	`ARRAY_SIZE
(
chªÃl_m­
); i++) {

67 ià(
	`¡rÿ£cmp
(
chªÃl_m­
[
i
].
Çme
, 
c
) == 0) {

68  
chªÃl_m­
[
i
].
id
;

72  -
EINVAL
;

73 
	}
}

75 cÚ¡ *
	$lg_chªÃl_Çme
(
ty³
)

77 
i
;

79 
i
 = 0; i < 
	`ARRAY_SIZE
(
chªÃl_m­
); i++) {

80 ià(
chªÃl_m­
[
i
].
id
 =ğ
ty³
)

81  
chªÃl_m­
[
i
].
Çme
;

84  
NULL
;

85 
	}
}

88 
	$lg_·r£_chªÃl
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

89 *
´iv©e
)

91 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

92 
¢d_cÚfig_t
 *
n
;

93 
¢d_soc_lg_chªÃl
 *
chªÃl
 = 
´iv©e
;

94 cÚ¡ *
id
;

95 
chªÃl_id
, 
v®ue
;

97 ià(
lg
->
chªÃl_idx
 >ğ
SND_SOC_TPLG_MAX_CHAN
)

98  -
EINVAL
;

100 
chªÃl
 +ğ
lg
->
chªÃl_idx
;

101 
	`¢d_cÚfig_g‘_id
(
cfg
, &
id
);

102 
	`lg_dbg
("\tChªÃÈ% © index %d", 
id
, 
lg
->
chªÃl_idx
);

104 
chªÃl_id
 = 
	`lookup_chªÃl
(
id
);

105 ià(
chªÃl_id
 < 0) {

106 
	`SNDERR
("šv®id chªÃÈ%s", 
id
);

107  -
EINVAL
;

110 
chªÃl
->
id
 = 
chªÃl_id
;

111 
chªÃl
->
size
 = (*channel);

112 
	`lg_dbg
("\tChª % ğ%d", 
id
, 
chªÃl
->id);

114 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

116 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

119 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

123 ià(
	`lg_g‘_š‹g”
(
n
, &
v®ue
, 0) < 0)

126 ià(
	`¡rcmp
(
id
, "reg") == 0)

127 
chªÃl
->
»g
 = 
v®ue
;

128 ià(
	`¡rcmp
(
id
, "shift") == 0)

129 
chªÃl
->
shiá
 = 
v®ue
;

131 
	`lg_dbg
("\t\t% ğ%d", 
id
, 
v®ue
);

134 
lg
->
chªÃl_idx
++;

136 
	}
}

138 
	$lg_§ve_chªÃls
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

139 
¢d_soc_lg_chªÃl
 *
chªÃl
,

140 
couÁ
, 
lg_buf
 *
d¡
,

141 cÚ¡ *
pfx
)

143 
¢d_soc_lg_chªÃl
 *
c
;

144 cÚ¡ *
s
;

145 
šdex
;

146 
”r
;

148 ià(
couÁ
 == 0)

150 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "channel {\n");

151 
šdex
 = 0; 
”r
 >ğ0 && index < 
couÁ
; index++) {

152 
c
 = 
chªÃl
 + 
šdex
;

153 
s
 = 
	`lg_chªÃl_Çme
(
c
->
id
);

154 ià(
s
 =ğ
NULL
)

155 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t%u", 
c
->
id
);

157 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t%s", 
s
);

158 ià(
”r
 >= 0)

159 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, " {\n");

160 ià(
”r
 >= 0)

161 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t\Œeg %d\n", 
c
->
»g
);

162 ià(
”r
 >ğ0 && 
c
->
shiá
 > 0)

163 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t\tshiá %u\n", 
c
->
shiá
);

164 ià(
”r
 >= 0)

165 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t}\n");

167 ià(
”r
 >= 0)

168 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

169  
”r
;

170 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/ctl.c

20 
	~"lg_loÿl.h
"

22 #iâdeà
DOC_HIDDEN


23 
	#ENUM_VAL_SIZE
 (
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
 >> 2)

	)

25 
	sùl_acûss_–em
 {

26 cÚ¡ *
	mÇme
;

27 
	mv®ue
;

33 cÚ¡ 
ùl_acûss_–em
 
	gùl_acûss
[] = {

34 {"»ad_wr™e", 
SNDRV_CTL_ELEM_ACCESS_READWRITE
},

35 {"v_»ad_wr™e", 
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
},

36 {"»ad", 
SNDRV_CTL_ELEM_ACCESS_READ
},

37 {"wr™e", 
SNDRV_CTL_ELEM_ACCESS_WRITE
},

38 {"vŞ©e", 
SNDRV_CTL_ELEM_ACCESS_VOLATILE
},

39 {"v_»ad", 
SNDRV_CTL_ELEM_ACCESS_TLV_READ
},

40 {"v_wr™e", 
SNDRV_CTL_ELEM_ACCESS_TLV_WRITE
},

41 {"v_commªd", 
SNDRV_CTL_ELEM_ACCESS_TLV_COMMAND
},

42 {"šaùive", 
SNDRV_CTL_ELEM_ACCESS_INACTIVE
},

43 {"lock", 
SNDRV_CTL_ELEM_ACCESS_LOCK
},

44 {"owÃr", 
SNDRV_CTL_ELEM_ACCESS_OWNER
},

45 {"v_ÿÎback", 
SNDRV_CTL_ELEM_ACCESS_TLV_CALLBACK
},

49 
	$·r£_acûss_v®ues
(
¢d_cÚfig_t
 *
cfg
,

50 
¢d_soc_lg_ùl_hdr
 *
hdr
)

52 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

53 
¢d_cÚfig_t
 *
n
;

54 cÚ¡ *
v®ue
 = 
NULL
;

55 
j
;

57 
	`lg_dbg
(" Access:");

59 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

60 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

63 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®ue
) < 0)

67 
j
 = 0; j < 
	`ARRAY_SIZE
(
ùl_acûss
); j++) {

68 ià(
	`¡rcmp
(
v®ue
, 
ùl_acûss
[
j
].
Çme
) == 0) {

69 
hdr
->
acûss
 |ğ
ùl_acûss
[
j
].
v®ue
;

70 
	`lg_dbg
("\t%s", 
v®ue
);

77 
	}
}

80 
	$·r£_acûss
(
¢d_cÚfig_t
 *
cfg
,

81 
¢d_soc_lg_ùl_hdr
 *
hdr
)

83 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

84 
¢d_cÚfig_t
 *
n
;

85 cÚ¡ *
id
;

86 
”r
 = 0;

88 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

90 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

91 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

94 ià(
	`¡rcmp
(
id
, "access") == 0) {

95 
”r
 = 
	`·r£_acûss_v®ues
(
n
, 
hdr
);

96 ià(
”r
 < 0) {

97 
	`SNDERR
("failedo…arse‡ccess");

98  
”r
;

104  
”r
;

105 
	}
}

108 
	$lg_§ve_acûss
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

109 
¢d_soc_lg_ùl_hdr
 *
hdr
,

110 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

112 cÚ¡ *
Ï¡
;

113 
j
, 
couÁ
, 
acûss
, 
cv®
;

114 
”r
;

116 ià(
hdr
->
acûss
 == 0)

119 
acûss
 = 
hdr
->access;

120 
j
 = 0, 
couÁ
 = 0, 
Ï¡
 = 
NULL
; j < 
	`ARRAY_SIZE
(
ùl_acûss
); j++) {

121 
cv®
 = 
ùl_acûss
[
j
].
v®ue
;

122 ià((
acûss
 & 
cv®
) == cval) {

123 
acûss
 &ğ~
cv®
;

124 
Ï¡
 = 
ùl_acûss
[
j
].
Çme
;

125 
couÁ
++;

128 ià(
couÁ
 == 1)

129  
	`lg_§ve_´štf
(
d¡
, 
pfx
, "acûss.0 %s\n", 
Ï¡
);

130 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "access [\n");

131 ià(
”r
 < 0)

132  
”r
;

133 
acûss
 = 
hdr
->access;

134 
j
 = 0; j < 
	`ARRAY_SIZE
(
ùl_acûss
); j++) {

135 
cv®
 = 
ùl_acûss
[
j
].
v®ue
;

136 ià((
acûss
 & 
cv®
) == cval) {

137 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t%s\n",

138 
ùl_acûss
[
j
].
Çme
);

139 ià(
”r
 < 0)

140  
”r
;

141 
acûss
 &ğ~
cv®
;

144  
	`lg_§ve_´štf
(
d¡
, 
pfx
, "]\n");

145 
	}
}

148 
	$cİy_v
(
lg_–em
 *
–em
, lg_–em *
»f
)

150 
¢d_soc_lg_mix”_cÚŒŞ
 *
mix”_ù¾
 = 
–em
->mixer_ctrl;

151 
¢d_soc_lg_ùl_v
 *
v
 = 
»f
->tlv;

153 
	`lg_dbg
("TLV '%s' u£d by '%s", 
»f
->
id
, 
–em
->id);

156 
mix”_ù¾
->
hdr
.
v
 = *tlv;

158 
	}
}

161 
	$lg_bud_mix”_cÚŒŞ
(
¢d_lg_t
 *
lg
,

162 
lg_–em
 *
–em
)

164 
lg_»f
 *
»f
;

165 
li¡_h—d
 *
ba£
, *
pos
;

166 
”r
 = 0;

168 
ba£
 = &
–em
->
»f_li¡
;

171 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

173 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

174 ià(
»f
->
–em
)

177 ià(
»f
->
ty³
 =ğ
SND_TPLG_TYPE_TLV
) {

178 
»f
->
–em
 = 
	`lg_–em_lookup
(&
lg
->
v_li¡
,

179 
»f
->
id
, 
SND_TPLG_TYPE_TLV
, 
–em
->
šdex
);

180 ià(
»f
->
–em
)

181 
”r
 = 
	`cİy_v
(
–em
, 
»f
->elem);

183 } ià(
»f
->
ty³
 =ğ
SND_TPLG_TYPE_DATA
) {

184 
”r
 = 
	`lg_cİy_d©a
(
lg
, 
–em
, 
»f
);

185 ià(
”r
 < 0)

186  
”r
;

189 ià(!
»f
->
–em
) {

190 
	`SNDERR
("cannot find '%s'„eferenced by"

191 " cÚŒŞ '%s'", 
»f
->
id
, 
–em
->id);

192  -
EINVAL
;

193 } ià(
”r
 < 0)

194  
”r
;

198 
	}
}

200 
	$cİy_’um_‹xts
(
lg_–em
 *
’um_–em
,

201 
lg_–em
 *
»f_–em
)

203 
¢d_soc_lg_’um_cÚŒŞ
 *
ec
 = 
’um_–em
->
’um_ù¾
;

204 
lg_‹xts
 *
‹xts
 = 
»f_–em
->texts;

206 
	`memıy
(
ec
->
‹xts
,exts->
™ems
,

207 
SND_SOC_TPLG_NUM_TEXTS
 * 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

208 
ec
->
™ems
 +ğ
‹xts
->
num_™ems
;

209 
	}
}

212 
	$lg_bud_’um_cÚŒŞ
(
¢d_lg_t
 *
lg
,

213 
lg_–em
 *
–em
)

215 
lg_»f
 *
»f
;

216 
li¡_h—d
 *
ba£
, *
pos
;

217 
”r
;

219 
ba£
 = &
–em
->
»f_li¡
;

221 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

223 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

224 ià(
»f
->
–em
)

227 ià(
»f
->
ty³
 =ğ
SND_TPLG_TYPE_TEXT
) {

228 
»f
->
–em
 = 
	`lg_–em_lookup
(&
lg
->
‹xt_li¡
,

229 
»f
->
id
, 
SND_TPLG_TYPE_TEXT
, 
–em
->
šdex
);

230 ià(
»f
->
–em
)

231 
	`cİy_’um_‹xts
(
–em
, 
»f
->elem);

233 } ià(
»f
->
ty³
 =ğ
SND_TPLG_TYPE_DATA
) {

234 
”r
 = 
	`lg_cİy_d©a
(
lg
, 
–em
, 
»f
);

235 ià(
”r
 < 0)

236  
”r
;

238 ià(!
»f
->
–em
) {

239 
	`SNDERR
("cannot find '%s'„eferenced by"

240 " cÚŒŞ '%s'", 
»f
->
id
, 
–em
->id);

241  -
EINVAL
;

246 
	}
}

249 
	$lg_bud_by‹s_cÚŒŞ
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
)

251 
lg_»f
 *
»f
;

252 
li¡_h—d
 *
ba£
, *
pos
;

253 
”r
;

255 
ba£
 = &
–em
->
»f_li¡
;

257 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

259 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

260 ià(
»f
->
–em
)

263 ià(
»f
->
ty³
 =ğ
SND_TPLG_TYPE_DATA
) {

264 
”r
 = 
	`lg_cİy_d©a
(
lg
, 
–em
, 
»f
);

265 ià(
”r
 < 0)

266  
”r
;

271 
	}
}

273 
	$lg_bud_cÚŒŞs
(
¢d_lg_t
 *
lg
)

275 
li¡_h—d
 *
ba£
, *
pos
;

276 
lg_–em
 *
–em
;

277 
”r
 = 0;

279 
ba£
 = &
lg
->
mix”_li¡
;

280 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

282 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

283 
”r
 = 
	`lg_bud_mix”_cÚŒŞ
(
lg
, 
–em
);

284 ià(
”r
 < 0)

285  
”r
;

288 
lg
->
mªiã¡
.
cÚŒŞ_–ems
++;

291 
ba£
 = &
lg
->
’um_li¡
;

292 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

294 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

295 
”r
 = 
	`lg_bud_’um_cÚŒŞ
(
lg
, 
–em
);

296 ià(
”r
 < 0)

297  
”r
;

300 
lg
->
mªiã¡
.
cÚŒŞ_–ems
++;

303 
ba£
 = &
lg
->
by‹s_ext_li¡
;

304 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

306 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

307 
”r
 = 
	`lg_bud_by‹s_cÚŒŞ
(
lg
, 
–em
);

308 ià(
”r
 < 0)

309  
”r
;

312 
lg
->
mªiã¡
.
cÚŒŞ_–ems
++;

316 
	}
}

324 
	$lg_·r£_v_dbsÿË
(
¢d_cÚfig_t
 *
cfg
, 
lg_–em
 *
–em
)

326 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

327 
¢d_cÚfig_t
 *
n
;

328 
¢d_soc_lg_ùl_v
 *
lg_v
 = 
–em
->
v
;

329 
¢d_soc_lg_v_dbsÿË
 *
sÿË
;

330 cÚ¡ *
id
 = 
NULL
;

331 
v®
;

333 
	`lg_dbg
(" sÿË: %s", 
–em
->
id
);

335 
lg_v
->
size
 = (
¢d_soc_lg_ùl_v
);

336 
lg_v
->
ty³
 = 
SNDRV_CTL_TLVT_DB_SCALE
;

337 
sÿË
 = &
lg_v
->scale;

339 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

341 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

344 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

345  -
EINVAL
;

348 ià(
	`lg_g‘_š‹g”
(
n
, &
v®
, 0))

351 
	`lg_dbg
("\t% ğ%i", 
id
, 
v®
);

354 ià(
	`¡rcmp
(
id
, "min") == 0)

355 
sÿË
->
mš
 = 
v®
;

356 ià(
	`¡rcmp
(
id
, "step") == 0)

357 
sÿË
->
¡•
 = 
v®
;

358 ià(
	`¡rcmp
(
id
, "mute") == 0)

359 
sÿË
->
mu‹
 = 
v®
;

361 
	`SNDERR
("unknowÀid '%s'", 
id
);

365 
	}
}

368 
	$lg_·r£_v
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

369 *
´iv©e
 
ATTRIBUTE_UNUSED
)

371 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

372 
¢d_cÚfig_t
 *
n
;

373 cÚ¡ *
id
;

374 
”r
 = 0;

375 
lg_–em
 *
–em
;

377 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_TLV
);

378 ià(!
–em
)

379  -
ENOMEM
;

381 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

383 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

384 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

387 ià(
	`¡rcmp
(
id
, "scale") == 0) {

388 
”r
 = 
	`lg_·r£_v_dbsÿË
(
n
, 
–em
);

389 ià(
”r
 < 0) {

390 
	`SNDERR
("failedo DBScale");

391  
”r
;

397  
”r
;

398 
	}
}

401 
	$lg_§ve_v
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

402 
lg_–em
 *
–em
,

403 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

405 
¢d_soc_lg_ùl_v
 *
v
 = 
–em
->tlv;

406 
¢d_soc_lg_v_dbsÿË
 *
sÿË
;

407 
”r
;

409 ià(
v
->
ty³
 !ğ
SNDRV_CTL_TLVT_DB_SCALE
) {

410 
	`SNDERR
("unknown TLVype");

411  -
EINVAL
;

414 
sÿË
 = &
v
->scale;

415 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s' {\n", 
–em
->
id
);

416 ià(
”r
 >= 0)

417 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tscale {\n");

418 ià(
”r
 >ğ0 && 
sÿË
->
mš
)

419 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t\tmš %i\n", 
sÿË
->
mš
);

420 ià(
”r
 >ğ0 && 
sÿË
->
¡•
 > 0)

421 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t\t¡• %i\n", 
sÿË
->
¡•
);

422 ià(
”r
 >ğ0 && 
sÿË
->
mu‹
 > 0)

423 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t\tmu‹ %i\n", 
sÿË
->
mu‹
);

424 ià(
”r
 >= 0)

425 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t}\n");

426 ià(
”r
 >= 0)

427 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

428  
”r
;

429 
	}
}

432 
	$lg_·r£_cÚŒŞ_by‹s
(
¢d_lg_t
 *
lg
,

433 
¢d_cÚfig_t
 *
cfg
,

434 *
´iv©e
 
ATTRIBUTE_UNUSED
)

436 
¢d_soc_lg_by‹s_cÚŒŞ
 *
be
;

437 
lg_–em
 *
–em
;

438 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

439 
¢d_cÚfig_t
 *
n
;

440 cÚ¡ *
id
, *
v®
 = 
NULL
;

441 
”r
, 
iv®
;

442 
boŞ
 
acûss_£t
 = 
çl£
, 
v_£t
 = false;

444 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_BYTES
);

445 ià(!
–em
)

446  -
ENOMEM
;

448 
be
 = 
–em
->
by‹s_ext
;

449 
be
->
size
 = 
–em
->size;

450 
	`¢d_¡¾ıy
(
be
->
hdr
.
Çme
, 
–em
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

451 
be
->
hdr
.
ty³
 = 
SND_SOC_TPLG_TYPE_BYTES
;

453 
	`lg_dbg
(" CÚŒŞ By‹s: %s", 
–em
->
id
);

455 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

456 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

457 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

461 ià(
	`¡rcmp
(
id
, "comment") == 0)

463 ià(
id
[0] == '#')

466 ià(
	`¡rcmp
(
id
, "base") == 0) {

467 ià(
	`lg_g‘_š‹g”
(
n
, &
iv®
, 0))

468  -
EINVAL
;

470 
be
->
ba£
 = 
iv®
;

471 
	`lg_dbg
("\t%s: %d", 
id
, 
be
->
ba£
);

475 ià(
	`¡rcmp
(
id
, "num_regs") == 0) {

476 ià(
	`lg_g‘_š‹g”
(
n
, &
iv®
, 0))

477  -
EINVAL
;

479 
be
->
num_»gs
 = 
iv®
;

480 
	`lg_dbg
("\t%s: %d", 
id
, 
be
->
num_»gs
);

484 ià(
	`¡rcmp
(
id
, "max") == 0) {

485 ià(
	`lg_g‘_š‹g”
(
n
, &
iv®
, 0))

486  -
EINVAL
;

488 
be
->
max
 = 
iv®
;

489 
	`lg_dbg
("\t%s: %d", 
id
, 
be
->
max
);

493 ià(
	`¡rcmp
(
id
, "mask") == 0) {

494 ià(
	`lg_g‘_š‹g”
(
n
, &
iv®
, 16))

495  -
EINVAL
;

497 
be
->
mask
 = 
iv®
;

498 
	`lg_dbg
("\t%s: %d", 
id
, 
be
->
mask
);

502 ià(
	`¡rcmp
(
id
, "data") == 0) {

503 
”r
 = 
	`lg_·r£_»fs
(
n
, 
–em
, 
SND_TPLG_TYPE_DATA
);

504 ià(
”r
 < 0)

505  
”r
;

509 ià(
	`¡rcmp
(
id
, "tlv") == 0) {

510 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®
) < 0)

511  -
EINVAL
;

513 
”r
 = 
	`lg_»f_add
(
–em
, 
SND_TPLG_TYPE_TLV
, 
v®
);

514 ià(
”r
 < 0)

515  
”r
;

517 
v_£t
 = 
Œue
;

518 
	`lg_dbg
("\t%s: %s", 
id
, 
v®
);

522 ià(
	`¡rcmp
(
id
, "ops") == 0) {

523 
”r
 = 
	`lg_·r£_compound
(
lg
, 
n
, 
lg_·r£_İs
,

524 &
be
->
hdr
);

525 ià(
”r
 < 0)

526  
”r
;

530 ià(
	`¡rcmp
(
id
, "extops") == 0) {

531 
”r
 = 
	`lg_·r£_compound
(
lg
, 
n
, 
lg_·r£_ext_İs
,

532 
be
);

533 ià(
”r
 < 0)

534  
”r
;

538 ià(
	`¡rcmp
(
id
, "access") == 0) {

539 
”r
 = 
	`·r£_acûss
(
cfg
, &
be
->
hdr
);

540 ià(
”r
 < 0)

541  
”r
;

542 
acûss_£t
 = 
Œue
;

548 ià(!
acûss_£t
) {

550 
be
->
hdr
.
acûss
 = 
SNDRV_CTL_ELEM_ACCESS_READWRITE
;

551 ià(
v_£t
)

552 
be
->
hdr
.
acûss
 |ğ
SNDRV_CTL_ELEM_ACCESS_TLV_READ
;

556 
	}
}

559 
	$lg_§ve_cÚŒŞ_by‹s
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

560 
lg_–em
 *
–em
,

561 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

563 
¢d_soc_lg_by‹s_cÚŒŞ
 *
be
 = 
–em
->
by‹s_ext
;

564 
pfx2
[16];

565 
”r
;

567 ià(!
be
)

570 
	`¢´štf
(
pfx2
, Õfx2), "%s\t", 
pfx
 ?: "");

571 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s' {\n", 
–em
->
id
);

572 ià(
”r
 < 0)

573  
”r
;

574 ià(
”r
 >ğ0 && 
–em
->
šdex
 > 0)

575 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tšdex %u\n", 
–em
->
šdex
);

576 ià(
”r
 >ğ0 && 
be
->
ba£
 > 0)

577 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tba£ %u\n", 
be
->
ba£
);

578 ià(
”r
 >ğ0 && 
be
->
num_»gs
 > 0)

579 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\Šum_»g %u\n", 
be
->
num_»gs
);

580 ià(
”r
 >ğ0 && 
be
->
max
 > 0)

581 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tmax %u\n", 
be
->
max
);

582 ià(
”r
 >ğ0 && 
be
->
mask
 > 0)

583 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tmask %u\n", 
be
->
mask
);

584 ià(
”r
 >= 0)

585 
”r
 = 
	`lg_§ve_İs
(
lg
, &
be
->
hdr
, 
d¡
, 
pfx2
);

586 ià(
”r
 >= 0)

587 
”r
 = 
	`lg_§ve_ext_İs
(
lg
, 
be
, 
d¡
, 
pfx2
);

588 ià(
”r
 >= 0)

589 
”r
 = 
	`lg_§ve_acûss
(
lg
, &
be
->
hdr
, 
d¡
, 
pfx2
);

590 ià(
”r
 >= 0)

591 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_TLV
,

592 "v", 
d¡
, 
pfx2
);

593 ià(
”r
 >= 0)

594 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_DATA
,

595 "d©a", 
d¡
, 
pfx2
);

596 ià(
”r
 >= 0)

597 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

598  
”r
;

599 
	}
}

602 
	$lg_·r£_cÚŒŞ_’um
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

603 *
´iv©e
 
ATTRIBUTE_UNUSED
)

605 
¢d_soc_lg_’um_cÚŒŞ
 *
ec
;

606 
lg_–em
 *
–em
;

607 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

608 
¢d_cÚfig_t
 *
n
;

609 cÚ¡ *
id
, *
v®
 = 
NULL
;

610 
”r
, 
j
;

611 
boŞ
 
acûss_£t
 = 
çl£
;

613 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_ENUM
);

614 ià(!
–em
)

615  -
ENOMEM
;

617 
ec
 = 
–em
->
’um_ù¾
;

618 
	`¢d_¡¾ıy
(
ec
->
hdr
.
Çme
, 
–em
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

619 
ec
->
hdr
.
ty³
 = 
SND_SOC_TPLG_TYPE_ENUM
;

620 
ec
->
size
 = 
–em
->size;

621 
lg
->
chªÃl_idx
 = 0;

624 
j
 = 0; j < 
SND_SOC_TPLG_MAX_CHAN
; j++) {

625 
ec
->
chªÃl
[
j
].
»g
 = -1;

628 
	`lg_dbg
(" CÚŒŞ Enum: %s", 
–em
->
id
);

630 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

632 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

633 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

637 ià(
	`¡rcmp
(
id
, "comment") == 0)

639 ià(
id
[0] == '#')

642 ià(
	`¡rcmp
(
id
, "texts") == 0) {

643 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®
) < 0)

644  -
EINVAL
;

646 
	`lg_»f_add
(
–em
, 
SND_TPLG_TYPE_TEXT
, 
v®
);

647 
	`lg_dbg
("\t%s: %s", 
id
, 
v®
);

651 ià(
	`¡rcmp
(
id
, "channel") == 0) {

652 ià(
ec
->
num_chªÃls
 >ğ
SND_SOC_TPLG_MAX_CHAN
) {

653 
	`SNDERR
("toØmªy chªÃl %s", 
–em
->
id
);

654  -
EINVAL
;

657 
”r
 = 
	`lg_·r£_compound
(
lg
, 
n
, 
lg_·r£_chªÃl
,

658 
ec
->
chªÃl
);

659 ià(
”r
 < 0)

660  
”r
;

662 
ec
->
num_chªÃls
 = 
lg
->
chªÃl_idx
;

666 ià(
	`¡rcmp
(
id
, "ops") == 0) {

667 
”r
 = 
	`lg_·r£_compound
(
lg
, 
n
, 
lg_·r£_İs
,

668 &
ec
->
hdr
);

669 ià(
”r
 < 0)

670  
”r
;

674 ià(
	`¡rcmp
(
id
, "data") == 0) {

675 
”r
 = 
	`lg_·r£_»fs
(
n
, 
–em
, 
SND_TPLG_TYPE_DATA
);

676 ià(
”r
 < 0)

677  
”r
;

681 ià(
	`¡rcmp
(
id
, "access") == 0) {

682 
”r
 = 
	`·r£_acûss
(
cfg
, &
ec
->
hdr
);

683 ià(
”r
 < 0)

684  
”r
;

685 
acûss_£t
 = 
Œue
;

691 ià(!
acûss_£t
) {

692 
ec
->
hdr
.
acûss
 = 
SNDRV_CTL_ELEM_ACCESS_READWRITE
;

696 
	}
}

699 
	$lg_§ve_cÚŒŞ_’um
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

700 
lg_–em
 *
–em
,

701 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

703 
¢d_soc_lg_’um_cÚŒŞ
 *
ec
 = 
–em
->
’um_ù¾
;

704 
pfx2
[16];

705 
”r
;

707 ià(!
ec
)

710 
	`¢´štf
(
pfx2
, Õfx2), "%s\t", 
pfx
 ?: "");

711 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s' {\n", 
–em
->
id
);

712 ià(
”r
 < 0)

713  
”r
;

714 ià(
”r
 >ğ0 && 
–em
->
šdex
 > 0)

715 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tšdex %u\n", 
–em
->
šdex
);

716 ià(
”r
 >= 0)

717 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_TEXT
,

718 "‹xts", 
d¡
, 
pfx2
);

719 ià(
”r
 >= 0)

720 
”r
 = 
	`lg_§ve_chªÃls
(
lg
, 
ec
->
chªÃl
,ƒc->
num_chªÃls
,

721 
d¡
, 
pfx2
);

722 ià(
”r
 >= 0)

723 
”r
 = 
	`lg_§ve_İs
(
lg
, &
ec
->
hdr
, 
d¡
, 
pfx2
);

724 ià(
”r
 >= 0)

725 
”r
 = 
	`lg_§ve_acûss
(
lg
, &
ec
->
hdr
, 
d¡
, 
pfx2
);

726 ià(
”r
 >= 0)

727 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_DATA
,

728 "d©a", 
d¡
, 
pfx2
);

729 ià(
”r
 >= 0)

730 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

731  
”r
;

732 
	}
}

738 
	$lg_·r£_cÚŒŞ_mix”
(
¢d_lg_t
 *
lg
,

739 
¢d_cÚfig_t
 *
cfg
,

740 *
´iv©e
 
ATTRIBUTE_UNUSED
)

742 
¢d_soc_lg_mix”_cÚŒŞ
 *
mc
;

743 
lg_–em
 *
–em
;

744 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

745 
¢d_cÚfig_t
 *
n
;

746 cÚ¡ *
id
, *
v®
 = 
NULL
;

747 
”r
, 
j
, 
iv®
;

748 
boŞ
 
acûss_£t
 = 
çl£
, 
v_£t
 = false;

750 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_MIXER
);

751 ià(!
–em
)

752  -
ENOMEM
;

755 
mc
 = 
–em
->
mix”_ù¾
;

756 
	`¢d_¡¾ıy
(
mc
->
hdr
.
Çme
, 
–em
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

757 
mc
->
hdr
.
ty³
 = 
SND_SOC_TPLG_TYPE_MIXER
;

758 
mc
->
size
 = 
–em
->size;

759 
lg
->
chªÃl_idx
 = 0;

762 
j
 = 0; j < 
SND_SOC_TPLG_MAX_CHAN
; j++)

763 
mc
->
chªÃl
[
j
].
»g
 = -1;

765 
	`lg_dbg
(" CÚŒŞ Mix”: %s", 
–em
->
id
);

768 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

769 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

770 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

774 ià(
	`¡rcmp
(
id
, "comment") == 0)

776 ià(
id
[0] == '#')

779 ià(
	`¡rcmp
(
id
, "channel") == 0) {

780 ià(
mc
->
num_chªÃls
 >ğ
SND_SOC_TPLG_MAX_CHAN
) {

781 
	`SNDERR
("toØmªy chªÃl %s", 
–em
->
id
);

782  -
EINVAL
;

785 
”r
 = 
	`lg_·r£_compound
(
lg
, 
n
, 
lg_·r£_chªÃl
,

786 
mc
->
chªÃl
);

787 ià(
”r
 < 0)

788  
”r
;

790 
mc
->
num_chªÃls
 = 
lg
->
chªÃl_idx
;

794 ià(
	`¡rcmp
(
id
, "max") == 0) {

795 ià(
	`lg_g‘_š‹g”
(
n
, &
iv®
, 0))

796  -
EINVAL
;

798 
mc
->
max
 = 
iv®
;

799 
	`lg_dbg
("\t%s: %d", 
id
, 
mc
->
max
);

803 ià(
	`¡rcmp
(
id
, "invert") == 0) {

804 
iv®
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

805 ià(
iv®
 < 0)

806  -
EINVAL
;

807 
mc
->
šv”t
 = 
iv®
;

809 
	`lg_dbg
("\t%s: %d", 
id
, 
mc
->
šv”t
);

813 ià(
	`¡rcmp
(
id
, "ops") == 0) {

814 
”r
 = 
	`lg_·r£_compound
(
lg
, 
n
, 
lg_·r£_İs
,

815 &
mc
->
hdr
);

816 ià(
”r
 < 0)

817  
”r
;

821 ià(
	`¡rcmp
(
id
, "tlv") == 0) {

822 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®
) < 0)

823  -
EINVAL
;

825 
”r
 = 
	`lg_»f_add
(
–em
, 
SND_TPLG_TYPE_TLV
, 
v®
);

826 ià(
”r
 < 0)

827  
”r
;

829 
v_£t
 = 
Œue
;

830 
	`lg_dbg
("\t%s: %s", 
id
, 
v®
);

834 ià(
	`¡rcmp
(
id
, "data") == 0) {

835 
”r
 = 
	`lg_·r£_»fs
(
n
, 
–em
, 
SND_TPLG_TYPE_DATA
);

836 ià(
”r
 < 0)

837  
”r
;

841 ià(
	`¡rcmp
(
id
, "access") == 0) {

842 
”r
 = 
	`·r£_acûss
(
cfg
, &
mc
->
hdr
);

843 ià(
”r
 < 0)

844  
”r
;

845 
acûss_£t
 = 
Œue
;

851 ià(!
acûss_£t
) {

853 
mc
->
hdr
.
acûss
 = 
SNDRV_CTL_ELEM_ACCESS_READWRITE
;

854 ià(
v_£t
)

855 
mc
->
hdr
.
acûss
 |ğ
SNDRV_CTL_ELEM_ACCESS_TLV_READ
;

859 
	}
}

861 
	$lg_§ve_cÚŒŞ_mix”
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

862 
lg_–em
 *
–em
,

863 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

865 
¢d_soc_lg_mix”_cÚŒŞ
 *
mc
 = 
–em
->
mix”_ù¾
;

866 
pfx2
[16];

867 
”r
;

869 ià(!
mc
)

871 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s' {\n", 
–em
->
id
);

872 ià(
”r
 < 0)

873  
”r
;

874 
	`¢´štf
(
pfx2
, Õfx2), "%s\t", 
pfx
 ?: "");

875 ià(
”r
 >ğ0 && 
–em
->
šdex
 > 0)

876 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tšdex %u\n", 
–em
->
šdex
);

877 ià(
”r
 >= 0)

878 
”r
 = 
	`lg_§ve_chªÃls
(
lg
, 
mc
->
chªÃl
, mc->
num_chªÃls
,

879 
d¡
, 
pfx2
);

880 ià(
”r
 >ğ0 && 
mc
->
max
 > 0)

881 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tmax %u\n", 
mc
->
max
);

882 ià(
”r
 >ğ0 && 
mc
->
šv”t
 > 0)

883 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tinvert 1\n");

884 ià(
”r
 >ğ0 && 
mc
->
šv”t
 > 0)

885 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tinvert 1\n");

886 ià(
”r
 >= 0)

887 
”r
 = 
	`lg_§ve_İs
(
lg
, &
mc
->
hdr
, 
d¡
, 
pfx2
);

888 ià(
”r
 >= 0)

889 
”r
 = 
	`lg_§ve_acûss
(
lg
, &
mc
->
hdr
, 
d¡
, 
pfx2
);

890 ià(
”r
 >= 0)

891 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_TLV
,

892 "v", 
d¡
, 
pfx2
);

893 ià(
”r
 >= 0)

894 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_DATA
,

895 "d©a", 
d¡
, 
pfx2
);

896 ià(
”r
 >= 0)

897 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

898  
”r
;

899 
	}
}

901 
	$š™_ùl_hdr
(
¢d_lg_t
 *
lg
,

902 
lg_–em
 *
·»Á
,

903 
¢d_soc_lg_ùl_hdr
 *
hdr
,

904 
¢d_lg_ùl_‹m¶©e
 *
t
)

906 
lg_–em
 *
–em
;

907 
”r
;

909 
hdr
->
size
 = (
¢d_soc_lg_ùl_hdr
);

910 
hdr
->
ty³
 = 
t
->type;

912 
	`¢d_¡¾ıy
(
hdr
->
Çme
, 
t
->Çme, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

915 ià(
t
->
acûss
 == 0)

916 
t
->
acûss
 = 
SNDRV_CTL_ELEM_ACCESS_READWRITE
;

917 
t
->
acûss
 &ğ(
SNDRV_CTL_ELEM_ACCESS_READWRITE
 |

918 
SNDRV_CTL_ELEM_ACCESS_VOLATILE
 |

919 
SNDRV_CTL_ELEM_ACCESS_INACTIVE
 |

920 
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
 |

921 
SNDRV_CTL_ELEM_ACCESS_TLV_COMMAND
 |

922 
SNDRV_CTL_ELEM_ACCESS_TLV_CALLBACK
);

924 
hdr
->
acûss
 = 
t
->access;

925 
hdr
->
İs
.
g‘
 = 
t
->ops.get;

926 
hdr
->
İs
.
put
 = 
t
->ops.put;

927 
hdr
->
İs
.
šfo
 = 
t
->ops.info;

930 ià(
hdr
->
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE


931 && !(
hdr
->
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_CALLBACK
)) {

933 
¢d_lg_v_‹m¶©e
 *
vt
 = 
t
->
v
;

934 
¢d_soc_lg_ùl_v
 *
v
;

935 
¢d_lg_v_dbsÿË_‹m¶©e
 *
sÿËt
;

936 
¢d_soc_lg_v_dbsÿË
 *
sÿË
;

938 ià(!
vt
) {

939 
	`SNDERR
("missing TLV data");

940  -
EINVAL
;

943 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
, 
·»Á
->
id
,

944 
SND_TPLG_TYPE_TLV
);

945 ià(!
–em
)

946  -
ENOMEM
;

948 
v
 = 
–em
->tlv;

950 
”r
 = 
	`lg_»f_add
(
·»Á
, 
SND_TPLG_TYPE_TLV
,…¬’t->
id
);

951 ià(
”r
 < 0)

952  
”r
;

954 
v
->
size
 = (
¢d_soc_lg_ùl_v
);

955 
v
->
ty³
 = 
vt
->type;

957 
vt
->
ty³
) {

958 
SNDRV_CTL_TLVT_DB_SCALE
:

959 
sÿËt
 = 
	`cÚš”_of
(
vt
,

960 
¢d_lg_v_dbsÿË_‹m¶©e
, 
hdr
);

961 
sÿË
 = &
v
->scale;

962 
sÿË
->
mš
 = 
sÿËt
->min;

963 
sÿË
->
¡•
 = 
sÿËt
->step;

964 
sÿË
->
mu‹
 = 
sÿËt
->mute;

969 
	`SNDERR
("unsuµÜ‹d TLVy³ %d", 
v
->
ty³
);

975 
	}
}

977 
	$lg_add_mix”
(
¢d_lg_t
 *
lg
, 
¢d_lg_mix”_‹m¶©e
 *
mix”
,

978 
lg_–em
 **
e
)

980 
¢d_soc_lg_mix”_cÚŒŞ
 *
mc
;

981 
¢d_soc_lg_´iv©e
 *
´iv
;

982 
lg_–em
 *
–em
;

983 
»t
, 
i
, 
num_chªÃls
;

985 
	`lg_dbg
(" CÚŒŞ Mix”: %s", 
mix”
->
hdr
.
Çme
);

987 ià(
mix”
->
hdr
.
ty³
 !ğ
SND_SOC_TPLG_TYPE_MIXER
) {

988 
	`SNDERR
("šv®id mix”y³ %d", 
mix”
->
hdr
.
ty³
);

989  -
EINVAL
;

992 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
, 
mix”
->
hdr
.
Çme
,

993 
SND_TPLG_TYPE_MIXER
);

994 ià(!
–em
)

995  -
ENOMEM
;

998 
mc
 = 
–em
->
mix”_ù¾
;

999 
mc
->
size
 = 
–em
->size;

1000 
»t
 = 
	`š™_ùl_hdr
(
lg
, 
–em
, &
mc
->
hdr
, &
mix”
->hdr);

1001 ià(
»t
 < 0) {

1002 
	`lg_–em_ä“
(
–em
);

1003  
»t
;

1006 
mc
->
mš
 = 
mix”
->min;

1007 
mc
->
max
 = 
mix”
->max;

1008 
mc
->
¶©fÜm_max
 = 
mix”
->platform_max;

1009 
mc
->
šv”t
 = 
mix”
->invert;

1012 
i
 = 0; i < 
SND_SOC_TPLG_MAX_CHAN
; i++)

1013 
mc
->
chªÃl
[
i
].
»g
 = -1;

1015 
num_chªÃls
 = 
mix”
->
m­
 ? mixer->map->num_channels : 0;

1016 
mc
->
num_chªÃls
 =‚um_channels;

1018 
i
 = 0; i < 
num_chªÃls
; i++) {

1019 
¢d_lg_chªÃl_–em
 *
chªÃl
 = &
mix”
->
m­
->chªÃl[
i
];

1021 
mc
->
chªÃl
[
i
].
size
 = (mc->channel[0]);

1022 
mc
->
chªÃl
[
i
].
»g
 = channel->reg;

1023 
mc
->
chªÃl
[
i
].
shiá
 = channel->shift;

1024 
mc
->
chªÃl
[
i
].
id
 = channel->id;

1028 
´iv
 = 
mix”
->priv;

1029 ià(
´iv
 &&…riv->
size
 > 0) {

1030 
»t
 = 
	`lg_add_d©a
(
lg
, 
–em
, 
´iv
,

1031 (*
´iv
è+…riv->
size
);

1032 ià(
»t
 < 0)

1033  
»t
;

1036 ià(
e
)

1037 *
e
 = 
–em
;

1039 
	}
}

1041 
	$lg_add_’um
(
¢d_lg_t
 *
lg
, 
¢d_lg_’um_‹m¶©e
 *
’um_ùl
,

1042 
lg_–em
 **
e
)

1044 
¢d_soc_lg_’um_cÚŒŞ
 *
ec
;

1045 
¢d_soc_lg_´iv©e
 *
´iv
;

1046 
lg_–em
 *
–em
;

1047 
»t
, 
i
, 
num_™ems
, 
num_chªÃls
;

1049 
	`lg_dbg
(" CÚŒŞ Enum: %s", 
’um_ùl
->
hdr
.
Çme
);

1051 ià(
’um_ùl
->
hdr
.
ty³
 !ğ
SND_SOC_TPLG_TYPE_ENUM
) {

1052 
	`SNDERR
("šv®idƒnumy³ %d", 
’um_ùl
->
hdr
.
ty³
);

1053  -
EINVAL
;

1056 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
, 
’um_ùl
->
hdr
.
Çme
,

1057 
SND_TPLG_TYPE_ENUM
);

1058 ià(!
–em
)

1059  -
ENOMEM
;

1061 
ec
 = 
–em
->
’um_ù¾
;

1062 
ec
->
size
 = 
–em
->size;

1063 
»t
 = 
	`š™_ùl_hdr
(
lg
, 
–em
, &
ec
->
hdr
, &
’um_ùl
->hdr);

1064 ià(
»t
 < 0) {

1065 
	`lg_–em_ä“
(
–em
);

1066  
»t
;

1069 
num_™ems
 = 
’um_ùl
->
™ems
 < 
SND_SOC_TPLG_NUM_TEXTS
 ?

1070 
’um_ùl
->
™ems
 : 
SND_SOC_TPLG_NUM_TEXTS
;

1071 
ec
->
™ems
 = 
num_™ems
;

1072 
ec
->
mask
 = 
’um_ùl
->mask;

1073 
ec
->
couÁ
 = 
’um_ùl
->
™ems
;

1076 
i
 = 0; i < 
SND_SOC_TPLG_MAX_CHAN
; i++)

1077 
ec
->
chªÃl
[
i
].
»g
 = -1;

1079 
num_chªÃls
 = 
’um_ùl
->
m­
 ?ƒnum_ctl->map->num_channels : 0;

1080 
ec
->
num_chªÃls
 =‚um_channels;

1082 
i
 = 0; i < 
num_chªÃls
; i++) {

1083 
¢d_lg_chªÃl_–em
 *
chªÃl
 = &
’um_ùl
->
m­
->chªÃl[
i
];

1085 
ec
->
chªÃl
[
i
].
size
 = (ec->channel[0]);

1086 
ec
->
chªÃl
[
i
].
»g
 = channel->reg;

1087 
ec
->
chªÃl
[
i
].
shiá
 = channel->shift;

1088 
ec
->
chªÃl
[
i
].
id
 = channel->id;

1091 ià(
’um_ùl
->
‹xts
 !ğ
NULL
) {

1092 
lg_–em
 *
‹xts
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
,

1093 
’um_ùl
->
hdr
.
Çme
, 
SND_TPLG_TYPE_TEXT
);

1095 
‹xts
->‹xts->
num_™ems
 =‚um_items;

1096 
i
 = 0; i < 
num_™ems
; i++) {

1097 ià(!
’um_ùl
->
‹xts
[
i
])

1099 
	`¢d_¡¾ıy
(
ec
->
‹xts
[
i
], 
’um_ùl
->texts[i],

1100 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1101 
	`¢d_¡¾ıy
(
‹xts
->‹xts->
™ems
[
i
], 
’um_ùl
->texts[i],

1102 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1104 
	`lg_»f_add
(
–em
, 
SND_TPLG_TYPE_TEXT
, 
’um_ùl
->
hdr
.
Çme
);

1107 ià(
’um_ùl
->
v®ues
 !ğ
NULL
) {

1108 
i
 = 0; i < 
num_™ems
; i++) {

1109 ià(
’um_ùl
->
v®ues
[
i
] =ğ
NULL
)

1112 
	`memıy
(&
ec
->
v®ues
[
i
 * (è* 
ENUM_VAL_SIZE
],

1113 
’um_ùl
->
v®ues
[
i
],

1114 (è* 
ENUM_VAL_SIZE
);

1119 
´iv
 = 
’um_ùl
->priv;

1120 ià(
´iv
 &&…riv->
size
 > 0) {

1121 
»t
 = 
	`lg_add_d©a
(
lg
, 
–em
, 
´iv
,

1122 (*
´iv
è+…riv->
size
);

1123 ià(
»t
 < 0)

1124  
»t
;

1127 ià(
e
)

1128 *
e
 = 
–em
;

1130 
	}
}

1132 
	$lg_add_by‹s
(
¢d_lg_t
 *
lg
, 
¢d_lg_by‹s_‹m¶©e
 *
by‹s_ùl
,

1133 
lg_–em
 **
e
)

1135 
¢d_soc_lg_by‹s_cÚŒŞ
 *
be
;

1136 
¢d_soc_lg_´iv©e
 *
´iv
;

1137 
lg_–em
 *
–em
;

1138 
»t
;

1140 
	`lg_dbg
(" CÚŒŞ By‹s: %s", 
by‹s_ùl
->
hdr
.
Çme
);

1142 ià(
by‹s_ùl
->
hdr
.
ty³
 !ğ
SND_SOC_TPLG_TYPE_BYTES
) {

1143 
	`SNDERR
("šv®id by‹ ty³ %d", 
by‹s_ùl
->
hdr
.
ty³
);

1144  -
EINVAL
;

1147 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
, 
by‹s_ùl
->
hdr
.
Çme
,

1148 
SND_TPLG_TYPE_BYTES
);

1149 ià(!
–em
)

1150  -
ENOMEM
;

1152 
be
 = 
–em
->
by‹s_ext
;

1153 
be
->
size
 = 
–em
->size;

1154 
»t
 = 
	`š™_ùl_hdr
(
lg
, 
–em
, &
be
->
hdr
, &
by‹s_ùl
->hdr);

1155 ià(
»t
 < 0) {

1156 
	`lg_–em_ä“
(
–em
);

1157  
»t
;

1160 
be
->
max
 = 
by‹s_ùl
->max;

1161 
be
->
mask
 = 
by‹s_ùl
->mask;

1162 
be
->
ba£
 = 
by‹s_ùl
->base;

1163 
be
->
num_»gs
 = 
by‹s_ùl
->num_regs;

1164 
be
->
ext_İs
.
put
 = 
by‹s_ùl
->ext_ops.put;

1165 
be
->
ext_İs
.
g‘
 = 
by‹s_ùl
->ext_ops.get;

1168 
´iv
 = 
by‹s_ùl
->priv;

1169 ià(
´iv
 &&…riv->
size
 > 0) {

1170 
»t
 = 
	`lg_add_d©a
(
lg
, 
–em
, 
´iv
,

1171 (*
´iv
è+…riv->
size
);

1172 ià(
»t
 < 0)

1173  
»t
;

1177 ià(
be
->
hdr
.
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_CALLBACK
) {

1178 ià((
be
->
hdr
.
acûss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
)

1179 !ğ
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
) {

1180 
	`SNDERR
("Invalid TLV bytes control‡ccess 0x%x",

1181 
be
->
hdr
.
acûss
);

1182 
	`lg_–em_ä“
(
–em
);

1183  -
EINVAL
;

1186 ià(!
be
->
max
) {

1187 
	`lg_–em_ä“
(
–em
);

1188  -
EINVAL
;

1192 ià(
e
)

1193 *
e
 = 
–em
;

1195 
	}
}

1197 
	$lg_add_mix”_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
)

1199  
	`lg_add_mix”
(
lg
, 
t
->
mix”
, 
NULL
);

1200 
	}
}

1202 
	$lg_add_’um_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
)

1204  
	`lg_add_’um
(
lg
, 
t
->
’um_ùl
, 
NULL
);

1205 
	}
}

1207 
	$lg_add_by‹s_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
)

1209  
	`lg_add_by‹s
(
lg
, 
t
->
by‹s_ùl
, 
NULL
);

1210 
	}
}

1212 
	$lg_decode_cÚŒŞ_mix”1
(
¢d_lg_t
 *
lg
,

1213 
li¡_h—d
 *
h—p
,

1214 
¢d_lg_mix”_‹m¶©e
 *
mt
,

1215 
size_t
 
pos
,

1216 *
bš
, 
size_t
 
size
)

1218 
¢d_soc_lg_mix”_cÚŒŞ
 *
mc
 = 
bš
;

1219 
¢d_lg_chªÃl_m­_‹m¶©e
 *
m­
;

1220 
¢d_lg_v_dbsÿË_‹m¶©e
 *
db
;

1221 
i
;

1223 ià(
size
 < (*
mc
)) {

1224 
	`SNDERR
("mix”: sm®Èsiz%d", 
size
);

1225  -
EINVAL
;

1228 
	`lg_log
(
lg
, 'D', 
pos
, "mixer: size %d TLV size %d…rivate size %d",

1229 
mc
->
size
, mc->
hdr
.
v
.size, mc->
´iv
.size);

1230 ià(
size
 !ğ
mc
->siz+ mc->
´iv
.size) {

1231 
	`SNDERR
("mix”: uÃx³ùedƒËm’ˆsiz%d", 
size
);

1232  -
EINVAL
;

1235 
	`mem£t
(
mt
, 0, (*mt));

1236 
mt
->
hdr
.
ty³
 = 
mc
->hdr.type;

1237 
mt
->
hdr
.
Çme
 = 
mc
->hdr.name;

1238 
mt
->
hdr
.
acûss
 = 
mc
->hdr.access;

1239 
mt
->
hdr
.
İs
.
g‘
 = 
mc
->hdr.ops.get;

1240 
mt
->
hdr
.
İs
.
put
 = 
mc
->hdr.ops.put;

1241 
mt
->
hdr
.
İs
.
šfo
 = 
mc
->hdr.ops.info;

1242 
mt
->
mš
 = 
mc
->min;

1243 
mt
->
max
 = 
mc
->max;

1244 
mt
->
¶©fÜm_max
 = 
mc
->platform_max;

1245 
	`lg_log
(
lg
, 'D', 
pos
, "mixer:‚ame '%s'‡ccess 0x%x",

1246 
mt
->
hdr
.
Çme
, mt->hdr.
acûss
);

1247 ià(
mc
->
num_chªÃls
 > 0) {

1248 
m­
 = 
	`lg_ÿÎoc
(
h—p
, (*map));

1249 
m­
->
num_chªÃls
 = 
mc
->num_channels;

1250 
i
 = 0; i < 
m­
->
num_chªÃls
; i++) {

1251 
m­
->
chªÃl
[
i
].
»g
 = 
mc
->channel[i].reg;

1252 
m­
->
chªÃl
[
i
].
shiá
 = 
mc
->channel[i].shift;

1253 
m­
->
chªÃl
[
i
].
id
 = 
mc
->channel[i].id;

1255 
mt
->
m­
 = map;

1257 ià(
mc
->
hdr
.
v
.
size
 == 0) {

1259 } ià(
mc
->
hdr
.
v
.
size
 =ğ(
¢d_soc_lg_ùl_v
)) {

1260 ià(
mc
->
hdr
.
v
.
ty³
 !ğ
SNDRV_CTL_TLVT_DB_SCALE
) {

1261 
	`SNDERR
("mixer: unknown TLVype %d",

1262 
mc
->
hdr
.
v
.
ty³
);

1263  -
EINVAL
;

1265 
db
 = 
	`lg_ÿÎoc
(
h—p
, (*db));

1266 ià(
db
 =ğ
NULL
)

1267  -
ENOMEM
;

1268 
mt
->
hdr
.
v_sÿË
 = 
db
;

1269 
db
->
hdr
.
ty³
 = 
mc
->hdr.
v
.type;

1270 
db
->
mš
 = 
mc
->
hdr
.
v
.
sÿË
.min;

1271 
db
->
¡•
 = 
mc
->
hdr
.
v
.
sÿË
.step;

1272 
db
->
mu‹
 = 
mc
->
hdr
.
v
.
sÿË
.mute;

1273 
	`lg_log
(
lg
, 'D', 
pos
, "mixer: dB scale TLV: min %d step %d mute %d",

1274 
db
->
mš
, db->
¡•
, db->
mu‹
);

1276 
	`SNDERR
("mix”: wrÚg TLV siz%d", 
mc
->
hdr
.
v
.
size
);

1277  -
EINVAL
;

1280 
mt
->
´iv
 = &
mc
->priv;

1281 
	`lg_log
(
lg
, 'D', 
pos
 + 
	`off£tof
(
¢d_soc_lg_mix”_cÚŒŞ
, 
´iv
),

1284 
	}
}

1286 
	$lg_decode_cÚŒŞ_mix”
(
¢d_lg_t
 *
lg
,

1287 
size_t
 
pos
,

1288 
¢d_soc_lg_hdr
 *
hdr
,

1289 *
bš
, 
size_t
 
size
)

1291 
li¡_h—d
 
h—p
;

1292 
¢d_lg_obj_‹m¶©e_t
 
t
;

1293 
¢d_lg_mix”_‹m¶©e
 
mt
;

1294 
¢d_soc_lg_mix”_cÚŒŞ
 *
mc
;

1295 
size_t
 
size2
;

1296 
”r
;

1298 
”r
 = 
	`lg_decode_‹m¶©e
(
lg
, 
pos
, 
hdr
, &
t
);

1299 ià(
”r
 < 0)

1300  
”r
;

1302 
Ãxt
:

1303 ià(
size
 < (*
mc
)) {

1304 
	`SNDERR
("mix”: sm®Èsiz%d", 
size
);

1305  -
EINVAL
;

1307 
	`INIT_LIST_HEAD
(&
h—p
);

1308 
mc
 = 
bš
;

1309 
size2
 = 
mc
->
size
 + mc->
´iv
.size;

1310 ià(
size2
 > 
size
) {

1311 
	`SNDERR
("mixer: wrongƒlement size (%d,…riv %d)",

1312 
mc
->
size
, mc->
´iv
.size);

1313  -
EINVAL
;

1316 
”r
 = 
	`lg_decode_cÚŒŞ_mix”1
(
lg
, &
h—p
, &
mt
, 
pos
, 
bš
, 
size2
);

1317 ià(
”r
 >= 0) {

1318 
t
.
mix”
 = &
mt
;

1319 
”r
 = 
	`¢d_lg_add_objeù
(
lg
, &
t
);

1321 
	`lg_ä“
(&
h—p
);

1322 ià(
”r
 < 0)

1323  
”r
;

1325 
bš
 +ğ
size2
;

1326 
size
 -ğ
size2
;

1327 
pos
 +ğ
size2
;

1329 ià(
size
 > 0)

1330 
Ãxt
;

1333 
	}
}

1335 
	$lg_decode_cÚŒŞ_’um1
(
¢d_lg_t
 *
lg
,

1336 
li¡_h—d
 *
h—p
,

1337 
¢d_lg_’um_‹m¶©e
 *
‘
,

1338 
size_t
 
pos
,

1339 
¢d_soc_lg_’um_cÚŒŞ
 *
ec
)

1341 
i
;

1343 ià(
ec
->
num_chªÃls
 > 
SND_TPLG_MAX_CHAN
 ||

1344 
ec
->
num_chªÃls
 > 
SND_SOC_TPLG_MAX_CHAN
) {

1345 
	`SNDERR
("’um: uÃx³ùed chªÃÈcouÁ %d", 
ec
->
num_chªÃls
);

1346  -
EINVAL
;

1348 ià(
ec
->
™ems
 > 
SND_SOC_TPLG_NUM_TEXTS
) {

1349 
	`SNDERR
("’um: uÃx³ùedext couÁ %d", 
ec
->
™ems
);

1350  -
EINVAL
;

1353 
	`mem£t
(
‘
, 0, (*et));

1354 
‘
->
hdr
.
ty³
 = 
ec
->hdr.type;

1355 
‘
->
hdr
.
Çme
 = 
ec
->hdr.name;

1356 
‘
->
hdr
.
acûss
 = 
ec
->hdr.access;

1357 
‘
->
hdr
.
İs
.
g‘
 = 
ec
->hdr.ops.get;

1358 
‘
->
hdr
.
İs
.
put
 = 
ec
->hdr.ops.put;

1359 
‘
->
hdr
.
İs
.
šfo
 = 
ec
->hdr.ops.info;

1360 
‘
->
mask
 = 
ec
->mask;

1362 ià(
ec
->
™ems
 > 0) {

1363 
‘
->
™ems
 = 
ec
->items;

1364 
‘
->
‹xts
 = 
	`lg_ÿÎoc
(
h—p
, (*è* 
ec
->
™ems
);

1365 ià(!
‘
->
‹xts
)

1366  -
ENOMEM
;

1367 
i
 = 0; ()˜< 
ec
->
™ems
; i++)

1368 
‘
->
‹xts
[
i
] = 
ec
->texts[i];

1371 
‘
->
m­
 = 
	`lg_ÿÎoc
(
h—p
, (
¢d_lg_chªÃl_m­_‹m¶©e
));

1372 ià(!
‘
->
m­
)

1373  -
ENOMEM
;

1374 
‘
->
m­
->
num_chªÃls
 = 
ec
->num_channels;

1375 
i
 = 0; i < 
‘
->
m­
->
num_chªÃls
; i++) {

1376 
¢d_lg_chªÃl_–em
 *
chªÃl
 = &
‘
->
m­
->chªÃl[
i
];

1378 
	`lg_log
(
lg
, 'D', 
pos
 + ((*)&
ec
->
chªÃl
[
i
] - (*)ec),

1379 "’um: chªÃÈsiz%d", 
ec
->
chªÃl
[
i
].
size
);

1380 
chªÃl
->
»g
 = 
ec
->chªÃl[
i
].reg;

1381 
chªÃl
->
shiá
 = 
ec
->chªÃl[
i
].shift;

1382 
chªÃl
->
id
 = 
ec
->chªÃl[
i
].id;

1385 
‘
->
´iv
 = &
ec
->priv;

1387 
	}
}

1389 
	$lg_decode_cÚŒŞ_’um
(
¢d_lg_t
 *
lg
,

1390 
size_t
 
pos
,

1391 
¢d_soc_lg_hdr
 *
hdr
,

1392 *
bš
, 
size_t
 
size
)

1394 
li¡_h—d
 
h—p
;

1395 
¢d_lg_obj_‹m¶©e_t
 
t
;

1396 
¢d_lg_’um_‹m¶©e
 
‘
;

1397 
¢d_soc_lg_’um_cÚŒŞ
 *
ec
;

1398 
size_t
 
size2
;

1399 
”r
;

1401 
”r
 = 
	`lg_decode_‹m¶©e
(
lg
, 
pos
, 
hdr
, &
t
);

1402 ià(
”r
 < 0)

1403  
”r
;

1405 
Ãxt
:

1406 ià(
size
 < (*
ec
)) {

1407 
	`SNDERR
("’um: sm®Èsiz%d", 
size
);

1408  -
EINVAL
;

1410 
	`INIT_LIST_HEAD
(&
h—p
);

1411 
ec
 = 
bš
;

1412 
size2
 = 
ec
->
size
 +ƒc->
´iv
.size;

1413 ià(
size2
 > 
size
) {

1414 
	`SNDERR
("enum: wrongƒlement size (%d,…riv %d)",

1415 
ec
->
size
,ƒc->
´iv
.size);

1416  -
EINVAL
;

1419 
	`lg_log
(
lg
, 'D', 
pos
, "enum: size %d…rivate size %d",

1420 
ec
->
size
,ƒc->
´iv
.size);

1422 
”r
 = 
	`lg_decode_cÚŒŞ_’um1
(
lg
, &
h—p
, &
‘
, 
pos
, 
ec
);

1423 ià(
”r
 >= 0) {

1424 
t
.
’um_ùl
 = &
‘
;

1425 
”r
 = 
	`¢d_lg_add_objeù
(
lg
, &
t
);

1427 
	`lg_ä“
(&
h—p
);

1428 ià(
”r
 < 0)

1429  
”r
;

1431 
bš
 +ğ
size2
;

1432 
size
 -ğ
size2
;

1433 
pos
 +ğ
size2
;

1435 ià(
size
 > 0)

1436 
Ãxt
;

1439 
	}
}

1441 
	$lg_decode_cÚŒŞ_by‹s1
(
¢d_lg_t
 *
lg
,

1442 
¢d_lg_by‹s_‹m¶©e
 *
bt
,

1443 
size_t
 
pos
,

1444 *
bš
, 
size_t
 
size
)

1446 
¢d_soc_lg_by‹s_cÚŒŞ
 *
bc
 = 
bš
;

1448 ià(
size
 < (*
bc
)) {

1449 
	`SNDERR
("by‹s: sm®Èsiz%d", 
size
);

1450  -
EINVAL
;

1453 
	`lg_log
(
lg
, 'D', 
pos
, "control bytes: size %d…rivate size %d",

1454 
bc
->
size
, bc->
´iv
.size);

1455 ià(
size
 !ğ
bc
->siz+ bc->
´iv
.size) {

1456 
	`SNDERR
("by‹s: uÃx³ùedƒËm’ˆsiz%d", 
size
);

1457  -
EINVAL
;

1460 
	`mem£t
(
bt
, 0, (*bt));

1461 
bt
->
hdr
.
ty³
 = 
bc
->hdr.type;

1462 
bt
->
hdr
.
Çme
 = 
bc
->hdr.name;

1463 
bt
->
hdr
.
acûss
 = 
bc
->hdr.access;

1464 
bt
->
hdr
.
İs
.
g‘
 = 
bc
->hdr.ops.get;

1465 
bt
->
hdr
.
İs
.
put
 = 
bc
->hdr.ops.put;

1466 
bt
->
hdr
.
İs
.
šfo
 = 
bc
->hdr.ops.info;

1467 
bt
->
max
 = 
bc
->max;

1468 
bt
->
mask
 = 
bc
->mask;

1469 
bt
->
ba£
 = 
bc
->base;

1470 
bt
->
num_»gs
 = 
bc
->num_regs;

1471 
bt
->
ext_İs
.
g‘
 = 
bc
->ext_ops.get;

1472 
bt
->
ext_İs
.
put
 = 
bc
->ext_ops.put;

1473 
bt
->
ext_İs
.
šfo
 = 
bc
->ext_ops.info;

1474 
	`lg_log
(
lg
, 'D', 
pos
, "control bytes:‚ame '%s'‡ccess 0x%x",

1475 
bt
->
hdr
.
Çme
, bt->hdr.
acûss
);

1477 
bt
->
´iv
 = &
bc
->priv;

1479 
	}
}

1481 
	$lg_decode_cÚŒŞ_by‹s
(
¢d_lg_t
 *
lg
,

1482 
size_t
 
pos
,

1483 
¢d_soc_lg_hdr
 *
hdr
,

1484 *
bš
, 
size_t
 
size
)

1486 
¢d_lg_obj_‹m¶©e_t
 
t
;

1487 
¢d_lg_by‹s_‹m¶©e
 
bt
;

1488 
¢d_soc_lg_by‹s_cÚŒŞ
 *
bc
;

1489 
size_t
 
size2
;

1490 
”r
;

1492 
”r
 = 
	`lg_decode_‹m¶©e
(
lg
, 
pos
, 
hdr
, &
t
);

1493 ià(
”r
 < 0)

1494  
”r
;

1496 
Ãxt
:

1497 ià(
size
 < (*
bc
)) {

1498 
	`SNDERR
("by‹s: sm®Èsiz%d", 
size
);

1499  -
EINVAL
;

1501 
bc
 = 
bš
;

1502 
size2
 = 
bc
->
size
 + bc->
´iv
.size;

1503 ià(
size2
 > 
size
) {

1504 
	`SNDERR
("bytes: wrongƒlement size (%d,…riv %d)",

1505 
bc
->
size
, bc->
´iv
.size);

1506  -
EINVAL
;

1509 
”r
 = 
	`lg_decode_cÚŒŞ_by‹s1
(
lg
, &
bt
, 
pos
, 
bš
, 
size
);

1510 ià(
”r
 < 0)

1511  
”r
;

1513 
t
.
by‹s_ùl
 = &
bt
;

1514 
”r
 = 
	`¢d_lg_add_objeù
(
lg
, &
t
);

1515 ià(
”r
 < 0)

1516  
”r
;

1518 
bš
 +ğ
size2
;

1519 
size
 -ğ
size2
;

1520 
pos
 +ğ
size2
;

1522 ià(
size
 > 0)

1523 
Ãxt
;

1526 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/dapm.c

20 
	~"lg_loÿl.h
"

23 cÚ¡ 
m­_–em
 
	gwidg‘_m­
[] = {

24 {"šput", 
SND_SOC_TPLG_DAPM_INPUT
},

25 {"ouut", 
SND_SOC_TPLG_DAPM_OUTPUT
},

26 {"mux", 
SND_SOC_TPLG_DAPM_MUX
},

27 {"mix”", 
SND_SOC_TPLG_DAPM_MIXER
},

28 {"pga", 
SND_SOC_TPLG_DAPM_PGA
},

29 {"out_drv", 
SND_SOC_TPLG_DAPM_OUT_DRV
},

30 {"adc", 
SND_SOC_TPLG_DAPM_ADC
},

31 {"dac", 
SND_SOC_TPLG_DAPM_DAC
},

32 {"sw™ch", 
SND_SOC_TPLG_DAPM_SWITCH
},

33 {"´e", 
SND_SOC_TPLG_DAPM_PRE
},

34 {"po¡", 
SND_SOC_TPLG_DAPM_POST
},

35 {"aif_š", 
SND_SOC_TPLG_DAPM_AIF_IN
},

36 {"aif_out", 
SND_SOC_TPLG_DAPM_AIF_OUT
},

37 {"dai_š", 
SND_SOC_TPLG_DAPM_DAI_IN
},

38 {"dai_out", 
SND_SOC_TPLG_DAPM_DAI_OUT
},

39 {"dai_lšk", 
SND_SOC_TPLG_DAPM_DAI_LINK
},

40 {"bufãr", 
SND_SOC_TPLG_DAPM_BUFFER
},

41 {"scheduËr", 
SND_SOC_TPLG_DAPM_SCHEDULER
},

42 {"efãù", 
SND_SOC_TPLG_DAPM_EFFECT
},

43 {"sigg’", 
SND_SOC_TPLG_DAPM_SIGGEN
},

44 {"¤c", 
SND_SOC_TPLG_DAPM_SRC
},

45 {"a¤c", 
SND_SOC_TPLG_DAPM_ASRC
},

46 {"’cod”", 
SND_SOC_TPLG_DAPM_ENCODER
},

47 {"decod”", 
SND_SOC_TPLG_DAPM_DECODER
},

50 
	$lookup_widg‘
(cÚ¡ *
w
)

52 
i
;

54 
i
 = 0; i < 
	`ARRAY_SIZE
(
widg‘_m­
); i++) {

55 ià(
	`¡rcmp
(
widg‘_m­
[
i
].
Çme
, 
w
) == 0)

56  
widg‘_m­
[
i
].
id
;

59  -
EINVAL
;

60 
	}
}

62 cÚ¡ *
	$g‘_widg‘_Çme
(
ty³
)

64 
i
;

66 
i
 = 0; i < 
	`ARRAY_SIZE
(
widg‘_m­
); i++) {

67 ià(()
widg‘_m­
[
i
].
id
 =ğ
ty³
)

68  
widg‘_m­
[
i
].
Çme
;

71  
NULL
;

72 
	}
}

75 
	$cİy_d­m_cÚŒŞ
(
lg_–em
 *
–em
, lg_–em *
»f
)

77 
¢d_soc_lg_d­m_widg‘
 *
widg‘
 = 
–em
->widget;

79 
	`lg_dbg
("CÚŒŞ '%s' u£d by '%s'", 
»f
->
id
, 
–em
->id);

80 
	`lg_dbg
("\tparent size: %d + %d -> %d,…riv size -> %d",

81 
–em
->
size
, 
»f
->size,ƒlem->size +„ef->size,

82 
widg‘
->
´iv
.
size
);

84 
widg‘
 = 
	`»®loc
(widg‘, 
–em
->
size
 + 
»f
->size);

85 ià(!
widg‘
)

86  -
ENOMEM
;

88 
–em
->
widg‘
 = widget;

91 
	`memıy
((*)
widg‘
 + 
–em
->
size
, 
»f
->
obj
,„ef->size);

92 
–em
->
size
 +ğ
»f
->size;

94 
widg‘
->
num_kcÚŒŞs
++;

95 
»f
->
compound_–em
 = 1;

97 
	}
}

100 
	$lg_bud_widg‘
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
)

102 
lg_»f
 *
»f
;

103 
li¡_h—d
 *
ba£
, *
pos
;

104 
”r
 = 0;

106 
ba£
 = &
–em
->
»f_li¡
;

111 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

112 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

114 ià(
»f
->
ty³
 !ğ
SND_TPLG_TYPE_DATA
)

117 
”r
 = 
	`lg_cİy_d©a
(
lg
, 
–em
, 
»f
);

118 ià(
”r
 < 0)

119  
”r
;

123 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

125 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

127 
»f
->
ty³
) {

128 
SND_TPLG_TYPE_MIXER
:

129 ià(!
»f
->
–em
)

130 
»f
->
–em
 = 
	`lg_–em_lookup
(&
lg
->
mix”_li¡
,

131 
»f
->
id
, 
SND_TPLG_TYPE_MIXER
, 
–em
->
šdex
);

132 ià(
»f
->
–em
)

133 
”r
 = 
	`cİy_d­m_cÚŒŞ
(
–em
, 
»f
->elem);

136 
SND_TPLG_TYPE_ENUM
:

137 ià(!
»f
->
–em
)

138 
»f
->
–em
 = 
	`lg_–em_lookup
(&
lg
->
’um_li¡
,

139 
»f
->
id
, 
SND_TPLG_TYPE_ENUM
, 
–em
->
šdex
);

140 ià(
»f
->
–em
)

141 
”r
 = 
	`cİy_d­m_cÚŒŞ
(
–em
, 
»f
->elem);

144 
SND_TPLG_TYPE_BYTES
:

145 ià(!
»f
->
–em
)

146 
»f
->
–em
 = 
	`lg_–em_lookup
(&
lg
->
by‹s_ext_li¡
,

147 
»f
->
id
, 
SND_TPLG_TYPE_BYTES
, 
–em
->
šdex
);

148 ià(
»f
->
–em
)

149 
”r
 = 
	`cİy_d­m_cÚŒŞ
(
–em
, 
»f
->elem);

156 ià(!
»f
->
–em
) {

157 
	`SNDERR
("cannot find '%s'„eferenced by widget '%s'",

158 
»f
->
id
, 
–em
->id);

159  -
EINVAL
;

162 ià(
”r
 < 0)

163  
”r
;

167 
	}
}

169 
	$lg_bud_widg‘s
(
¢d_lg_t
 *
lg
)

172 
li¡_h—d
 *
ba£
, *
pos
;

173 
lg_–em
 *
–em
;

174 
”r
;

176 
ba£
 = &
lg
->
widg‘_li¡
;

177 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

179 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

180 ià(!
–em
->
widg‘
 ||ƒËm->
ty³
 !ğ
SND_TPLG_TYPE_DAPM_WIDGET
) {

181 
	`SNDERR
("šv®id widg‘ '%s'", 
–em
->
id
);

182  -
EINVAL
;

185 
”r
 = 
	`lg_bud_widg‘
(
lg
, 
–em
);

186 ià(
”r
 < 0)

187  
”r
;

190 
lg
->
mªiã¡
.
widg‘_–ems
++;

194 
	}
}

196 
	$lg_bud_rou‹s
(
¢d_lg_t
 *
lg
)

198 
li¡_h—d
 *
ba£
, *
pos
;

199 
lg_–em
 *
–em
;

200 
¢d_soc_lg_d­m_g¿ph_–em
 *
rou‹
;

202 
ba£
 = &
lg
->
rou‹_li¡
;

204 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

205 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

207 ià(!
–em
->
rou‹
 ||ƒËm->
ty³
 !ğ
SND_TPLG_TYPE_DAPM_GRAPH
) {

208 
	`SNDERR
("šv®id„ou‹ '%s'", 
–em
->
id
);

209  -
EINVAL
;

212 
rou‹
 = 
–em
->route;

213 
	`lg_dbg
("Check„oute: sink '%s', control '%s', source '%s'",

214 
rou‹
->
sšk
,„ou‹->
cÚŒŞ
,„ou‹->
sourû
);

217 ià(
	`¡¾’
(
rou‹
->
sšk
) <= 0) {

218 
	`SNDERR
("no sink");

219  -
EINVAL
;

222 ià(!
	`lg_–em_lookup
(&
lg
->
widg‘_li¡
, 
rou‹
->
sšk
,

223 
SND_TPLG_TYPE_DAPM_WIDGET
, 
SND_TPLG_INDEX_ALL
)) {

224 
	`SNDERR
("undefšed sšk widg‘/¡»am '%s'", 
rou‹
->
sšk
);

228 ià(
	`¡¾’
(
rou‹
->
cÚŒŞ
)) {

229 ià(!
	`lg_–em_lookup
(&
lg
->
mix”_li¡
, 
rou‹
->
cÚŒŞ
,

230 
SND_TPLG_TYPE_MIXER
, 
–em
->
šdex
) &&

231 !
	`lg_–em_lookup
(&
lg
->
’um_li¡
, 
rou‹
->
cÚŒŞ
,

232 
SND_TPLG_TYPE_ENUM
, 
–em
->
šdex
)) {

233 
	`SNDERR
("undefined mixer/enum control '%s'",

234 
rou‹
->
cÚŒŞ
);

239 ià(
	`¡¾’
(
rou‹
->
sourû
) <= 0) {

240 
	`SNDERR
("no source");

241  -
EINVAL
;

244 ià(!
	`lg_–em_lookup
(&
lg
->
widg‘_li¡
, 
rou‹
->
sourû
,

245 
SND_TPLG_TYPE_DAPM_WIDGET
, 
SND_TPLG_INDEX_ALL
)) {

246 
	`SNDERR
("undefined source widget/stream '%s'",

247 
rou‹
->
sourû
);

251 
lg
->
mªiã¡
.
g¿ph_–ems
++;

255 
	}
}

257 
lg_–em
 *
	$lg_–em_Ãw_rou‹
(
¢d_lg_t
 *
lg
, 
šdex
)

259 
lg_–em
 *
–em
;

260 
¢d_soc_lg_d­m_g¿ph_–em
 *
lše
;

262 
–em
 = 
	`lg_–em_Ãw
();

263 ià(!
–em
)

264  
NULL
;

266 
–em
->
šdex
 = index;

267 ià(
lg
->
d­m_sÜt
)

268 
	`lg_–em_š£¹
(
–em
, &
lg
->
rou‹_li¡
);

270 
	`li¡_add_
(&
–em
->
li¡
, &
lg
->
rou‹_li¡
);

271 
	`¡rıy
(
–em
->
id
, "line");

272 
–em
->
ty³
 = 
SND_TPLG_TYPE_DAPM_GRAPH
;

273 
–em
->
size
 = (*
lše
);

275 
lše
 = 
	`ÿÎoc
(1, (*line));

276 ià(!
lše
) {

277 
	`lg_–em_ä“
(
–em
);

278  
NULL
;

280 
–em
->
rou‹
 = 
lše
;

282  
–em
;

283 
	}
}

285 
	#LINE_SIZE
 1024

	)

288 
	$lg_·r£_lše
(cÚ¡ *
‹xt
,

289 
¢d_soc_lg_d­m_g¿ph_–em
 *
lše
)

291 
buf
[
LINE_SIZE
];

292 
Ën
, 
i
;

293 cÚ¡ *
sourû
 = 
NULL
, *
sšk
 = NULL, *
cÚŒŞ
 = NULL;

295 
	`¢d_¡¾ıy
(
buf
, 
‹xt
, 
LINE_SIZE
);

297 
Ën
 = 
	`¡¾’
(
buf
);

298 ià(
Ën
 <= 2) {

299 
	`SNDERR
("šv®id„ou‹ \"%s\"", 
buf
);

300  -
EINVAL
;

304 
i
 = 1; i < 
Ën
; i++) {

305 ià(
buf
[
i
] == ',')

306 
£cÚd
;

308 
	`SNDERR
("šv®id„ou‹ \"%s\"", 
buf
);

309  -
EINVAL
;

311 
£cÚd
:

313 
sšk
 = 
buf
;

314 
cÚŒŞ
 = &
buf
[
i
 + 2];

315 
buf
[
i
] = 0;

317 ; 
i
 < 
Ën
; i++) {

318 ià(
buf
[
i
] == ',')

319 
dÚe
;

322 
	`SNDERR
("šv®id„ou‹ \"%s\"", 
buf
);

323  -
EINVAL
;

325 
dÚe
:

326 
buf
[
i
] = 0;

327 
sourû
 = &
buf
[
i
 + 2];

329 
	`¡rıy
(
lše
->
sourû
, source);

330 
	`¡rıy
(
lše
->
cÚŒŞ
, control);

331 
	`¡rıy
(
lše
->
sšk
, sink);

333 
	}
}

336 
	$lg_·r£_rou‹s
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, 
šdex
)

338 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

339 
¢d_cÚfig_t
 *
n
;

340 
lg_–em
 *
–em
;

341 
¢d_soc_lg_d­m_g¿ph_–em
 *
lše
;

342 
”r
;

344 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

345 cÚ¡ *
v®
;

347 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

348 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®
) < 0)

351 
–em
 = 
	`lg_–em_Ãw_rou‹
(
lg
, 
šdex
);

352 ià(!
–em
)

353  -
ENOMEM
;

354 
lše
 = 
–em
->
rou‹
;

356 
”r
 = 
	`lg_·r£_lše
(
v®
, 
lše
);

357 ià(
”r
 < 0)

358  
”r
;

360 
	`lg_dbg
("route: sink '%s', control '%s', source '%s'",

361 
lše
->
sšk
,†še->
cÚŒŞ
,†še->
sourû
);

365 
	}
}

367 
	$lg_·r£_d­m_g¿ph
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

368 *
´iv©e
 
ATTRIBUTE_UNUSED
)

370 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

371 
¢d_cÚfig_t
 *
n
;

372 
”r
;

373 cÚ¡ *
g¿ph_id
;

374 
šdex
 = -1;

376 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

377 
	`SNDERR
("compound isƒxpected for dapm graph definition");

378  -
EINVAL
;

381 
	`¢d_cÚfig_g‘_id
(
cfg
, &
g¿ph_id
);

383 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

384 cÚ¡ *
id
;

386 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

387 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0) {

391 ià(
	`¡rcmp
(
id
, "index") == 0) {

392 ià(
	`lg_g‘_š‹g”
(
n
, &
šdex
, 0))

393  -
EINVAL
;

394 ià(
šdex
 < 0)

395  -
EINVAL
;

398 ià(
	`¡rcmp
(
id
, "lines") == 0) {

399 ià(
šdex
 < 0) {

400 
	`SNDERR
("failedo…arse dapm graph %s, missing index",

401 
g¿ph_id
);

402  -
EINVAL
;

404 
”r
 = 
	`lg_·r£_rou‹s
(
lg
, 
n
, 
šdex
);

405 ià(
”r
 < 0) {

406 
	`SNDERR
("failedo…arse dapm graph %s",

407 
g¿ph_id
);

408  
”r
;

415 
	}
}

418 
	$lg_§ve_d­m_g¿ph
(
¢d_lg_t
 *
lg
, 
šdex
,

419 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

421 
¢d_soc_lg_d­m_g¿ph_–em
 *
rou‹
;

422 
li¡_h—d
 *
pos
;

423 
lg_–em
 *
–em
;

424 
”r
, 
fœ¡
, 
Şd_šdex
;

425 
block
, 
couÁ
;

426 cÚ¡ *
fmt
;

428 
Şd_šdex
 = -1;

429 
block
 = 0;

430 
couÁ
 = 0;

431 
	`li¡_fÜ_—ch
(
pos
, &
lg
->
rou‹_li¡
) {

432 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

433 ià(!
–em
->
rou‹
 ||ƒËm->
ty³
 !ğ
SND_TPLG_TYPE_DAPM_GRAPH
)

435 ià(
šdex
 >ğ0 && 
–em
->index != index)

437 ià(
Şd_šdex
 !ğ
–em
->
šdex
) {

438 
block
++;

439 
Şd_šdex
 = 
–em
->
šdex
;

441 
couÁ
++;

443 ià(
couÁ
 == 0)

445 ià(
block
 < 10) {

446 
fmt
 = "\tset%u {\n";

447 } ià(
block
 < 100) {

448 
fmt
 = "\tset%02u {\n";

449 } ià(
block
 < 1000) {

450 
fmt
 = "\tset%03u {\n";

452  -
EINVAL
;

454 
Şd_šdex
 = -1;

455 
block
 = -1;

456 
fœ¡
 = 1;

457 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "SectionGraph {\n");

458 
	`li¡_fÜ_—ch
(
pos
, &
lg
->
rou‹_li¡
) {

459 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

460 ià(!
–em
->
rou‹
 ||ƒËm->
ty³
 !ğ
SND_TPLG_TYPE_DAPM_GRAPH
)

462 ià(
šdex
 >ğ0 && 
–em
->index != index)

464 ià(
Şd_šdex
 !ğ
–em
->
šdex
) {

465 ià(
Şd_šdex
 >= 0) {

466 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t\t]\n");

467 ià(
”r
 < 0)

468  
”r
;

469 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t}\n");

470 ià(
”r
 < 0)

471  
”r
;

473 
Şd_šdex
 = 
–em
->
šdex
;

474 
block
++;

475 
fœ¡
 = 1;

476 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, 
fmt
, 
block
);

477 ià(
”r
 >= 0)

478 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t\tindex %u\n",

479 
–em
->
šdex
);

480 ià(
”r
 < 0)

481  
”r
;

483 ià(
fœ¡
) {

484 
fœ¡
 = 0;

485 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t\tlines [\n");

486 ià(
”r
 < 0)

487  
”r
;

489 
rou‹
 = 
–em
->route;

490 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t\t\t'%s, %s, %s'\n",

491 
rou‹
->
sšk
,„ou‹->
cÚŒŞ
,

492 
rou‹
->
sourû
);

493 ià(
”r
 < 0)

494  
”r
;

497 ià(!
fœ¡
) {

498 ià(
”r
 >= 0)

499 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t\t]\n");

500 ià(
”r
 >= 0)

501 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t}\n");

504 ià(
”r
 >= 0)

505 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

506  
”r
;

507 
	}
}

510 
	$lg_·r£_d­m_widg‘
(
¢d_lg_t
 *
lg
,

511 
¢d_cÚfig_t
 *
cfg
, *
´iv©e
 
ATTRIBUTE_UNUSED
)

513 
¢d_soc_lg_d­m_widg‘
 *
widg‘
;

514 
lg_–em
 *
–em
;

515 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

516 
¢d_cÚfig_t
 *
n
;

517 cÚ¡ *
id
, *
v®
 = 
NULL
;

518 
widg‘_ty³
, 
”r
, 
iv®
;

520 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_DAPM_WIDGET
);

521 ià(!
–em
)

522  -
ENOMEM
;

524 
	`lg_dbg
(" Widg‘: %s", 
–em
->
id
);

526 
widg‘
 = 
–em
->widget;

527 
	`¢d_¡¾ıy
(
widg‘
->
Çme
, 
–em
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

528 
widg‘
->
size
 = 
–em
->size;

530 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

532 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

533 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

537 ià(
	`¡rcmp
(
id
, "comment") == 0)

539 ià(
id
[0] == '#')

542 ià(
	`¡rcmp
(
id
, "type") == 0) {

543 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®
) < 0)

544  -
EINVAL
;

546 
widg‘_ty³
 = 
	`lookup_widg‘
(
v®
);

547 ià(
widg‘_ty³
 < 0){

548 
	`SNDERR
("widget '%s': Unsupported widgetype %s",

549 
–em
->
id
, 
v®
);

550  -
EINVAL
;

553 
widg‘
->
id
 = 
widg‘_ty³
;

554 
	`lg_dbg
("\t%s: %s", 
id
, 
v®
);

558 ià(
	`¡rcmp
(
id
, "stream_name") == 0) {

559 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®
) < 0)

560  -
EINVAL
;

562 
	`¢d_¡¾ıy
(
widg‘
->
¢ame
, 
v®
,

563 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

564 
	`lg_dbg
("\t%s: %s", 
id
, 
v®
);

568 ià(
	`¡rcmp
(
id
, "no_pm") == 0) {

569 
iv®
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

570 ià(
iv®
 < 0)

571  -
EINVAL
;

573 
widg‘
->
»g
 = 
iv®
 ? -1 : 0;

575 
	`lg_dbg
("\t%s: %s", 
id
, 
v®
);

579 ià(
	`¡rcmp
(
id
, "shift") == 0) {

580 ià(
	`lg_g‘_š‹g”
(
n
, &
iv®
, 0))

581  -
EINVAL
;

583 
widg‘
->
shiá
 = 
iv®
;

584 
	`lg_dbg
("\t%s: %d", 
id
, 
widg‘
->
shiá
);

588 ià(
	`¡rcmp
(
id
, "reg") == 0) {

589 ià(
	`lg_g‘_š‹g”
(
n
, &
iv®
, 0))

590  -
EINVAL
;

592 
widg‘
->
»g
 = 
iv®
;

593 
	`lg_dbg
("\t%s: %d", 
id
, 
widg‘
->
»g
);

597 ià(
	`¡rcmp
(
id
, "invert") == 0) {

598 
iv®
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

599 ià(
iv®
 < 0)

600  -
EINVAL
;

602 
widg‘
->
šv”t
 = 
iv®
;

603 
	`lg_dbg
("\t%s: %d", 
id
, 
widg‘
->
šv”t
);

607 ià(
	`¡rcmp
(
id
, "ignore_suspend") == 0) {

608 
iv®
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

609 ià(
iv®
 < 0)

610  -
EINVAL
;

612 
widg‘
->
ignÜe_su¥’d
 = 
iv®
;

614 
	`lg_dbg
("\t%s: %s", 
id
, 
v®
);

618 ià(
	`¡rcmp
(
id
, "subseq") == 0) {

619 ià(
	`lg_g‘_š‹g”
(
n
, &
iv®
, 0))

620  -
EINVAL
;

622 
widg‘
->
sub£q
 = 
iv®
;

623 
	`lg_dbg
("\t%s: %d", 
id
, 
widg‘
->
sub£q
);

627 ià(
	`¡rcmp
(
id
, "event_type") == 0) {

628 ià(
	`lg_g‘_š‹g”
(
n
, &
iv®
, 0))

629  -
EINVAL
;

631 
widg‘
->
ev’t_ty³
 = 
iv®
;

632 
	`lg_dbg
("\t%s: %d", 
id
, 
widg‘
->
ev’t_ty³
);

636 ià(
	`¡rcmp
(
id
, "event_flags") == 0) {

637 ià(
	`lg_g‘_š‹g”
(
n
, &
iv®
, 0))

638  -
EINVAL
;

640 
widg‘
->
ev’t_æags
 = 
iv®
;

641 
	`lg_dbg
("\t%s: %d", 
id
, 
widg‘
->
ev’t_æags
);

645 ià(
	`¡rcmp
(
id
, "enum") == 0) {

646 
”r
 = 
	`lg_·r£_»fs
(
n
, 
–em
, 
SND_TPLG_TYPE_ENUM
);

647 ià(
”r
 < 0)

648  
”r
;

653 ià(
	`¡rcmp
(
id
, "mixer") == 0) {

654 
”r
 = 
	`lg_·r£_»fs
(
n
, 
–em
, 
SND_TPLG_TYPE_MIXER
);

655 ià(
”r
 < 0)

656  
”r
;

661 ià(
	`¡rcmp
(
id
, "bytes") == 0) {

662 
”r
 = 
	`lg_·r£_»fs
(
n
, 
–em
, 
SND_TPLG_TYPE_BYTES
);

663 ià(
”r
 < 0)

664  
”r
;

669 ià(
	`¡rcmp
(
id
, "data") == 0) {

670 
”r
 = 
	`lg_·r£_»fs
(
n
, 
–em
, 
SND_TPLG_TYPE_DATA
);

671 ià(
”r
 < 0)

672  
”r
;

678 
	}
}

681 
	$lg_§ve_d­m_widg‘
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

682 
lg_–em
 *
–em
,

683 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

685 
¢d_soc_lg_d­m_widg‘
 *
widg‘
 = 
–em
->widget;

686 cÚ¡ *
s
;

687 
pfx2
[16];

688 
”r
;

690 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s' {\n", 
–em
->
id
);

691 ià(
”r
 >ğ0 && 
–em
->
šdex
)

692 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tindex %u\n",

693 
–em
->
šdex
);

694 ià(
”r
 >= 0) {

695 
s
 = 
	`g‘_widg‘_Çme
(
widg‘
->
id
);

696 ià(
s
)

697 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\‰y³ %s\n", 
s
);

699 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\ttype %u\n",

700 
widg‘
->
id
);

702 ià(
”r
 >ğ0 && 
widg‘
->
¢ame
[0])

703 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tstream_name '%s'\n",

704 
widg‘
->
¢ame
);

705 ià(
”r
 >ğ0 && 
widg‘
->
»g
)

706 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tno_pm 1\n");

707 ià(
”r
 >ğ0 && 
widg‘
->
shiá
)

708 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tshift %u\n",

709 
widg‘
->
shiá
);

710 ià(
”r
 >ğ0 && 
widg‘
->
šv”t
)

711 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tinvert %u\n",

712 
widg‘
->
šv”t
);

713 ià(
”r
 >ğ0 && 
widg‘
->
ignÜe_su¥’d
)

714 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tignore_suspend %u\n",

715 
widg‘
->
ignÜe_su¥’d
);

716 ià(
”r
 >ğ0 && 
widg‘
->
sub£q
)

717 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tsubseq %u\n",

718 
widg‘
->
sub£q
);

719 ià(
”r
 >ğ0 && 
widg‘
->
ev’t_ty³
)

720 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tevent_type %u\n",

721 
widg‘
->
ev’t_ty³
);

722 ià(
”r
 >ğ0 && 
widg‘
->
ev’t_æags
)

723 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tevent_flags %u\n",

724 
widg‘
->
ev’t_æags
);

725 
	`¢´štf
(
pfx2
, Õfx2), "%s\t", 
pfx
 ?: "");

726 ià(
”r
 >= 0)

727 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_ENUM
,

728 "’um", 
d¡
, 
pfx2
);

729 ià(
”r
 >= 0)

730 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_MIXER
,

731 "mix”", 
d¡
, 
pfx2
);

732 ià(
”r
 >= 0)

733 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_BYTES
,

734 "by‹s", 
d¡
, 
pfx2
);

735 ià(
”r
 >= 0)

736 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_DATA
,

737 "d©a", 
d¡
, 
pfx2
);

738 ià(
”r
 >= 0)

739 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

740  
”r
;

741 
	}
}

743 
	$lg_add_rou‹
(
¢d_lg_t
 *
lg
, 
¢d_lg_g¿ph_–em
 *
t
, 
šdex
)

745 
lg_–em
 *
–em
;

746 
¢d_soc_lg_d­m_g¿ph_–em
 *
lše
;

748 ià(!
t
->
¤c
 || !t->
sšk
)

749  -
EINVAL
;

751 
–em
 = 
	`lg_–em_Ãw_rou‹
(
lg
, 
šdex
);

752 ià(!
–em
)

753  -
ENOMEM
;

755 
lše
 = 
–em
->
rou‹
;

756 
	`¢d_¡¾ıy
(
lše
->
sourû
, 
t
->
¤c
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

757 ià(
t
->
ùl
)

758 
	`¢d_¡¾ıy
(
lše
->
cÚŒŞ
, 
t
->
ùl
,

759 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

760 
	`¢d_¡¾ıy
(
lše
->
sšk
, 
t
->sšk, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

763 
	}
}

765 
	$lg_add_g¿ph_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
)

767 
¢d_lg_g¿ph_‹m¶©e
 *
gt
 = 
t
->
g¿ph
;

768 
i
, 
»t
;

770 
i
 = 0; i < 
gt
->
couÁ
; i++) {

771 
»t
 = 
	`lg_add_rou‹
(
lg
, 
gt
->
–em
 + 
i
, 
t
->
šdex
);

772 ià(
»t
 < 0)

773  
»t
;

777 
	}
}

779 
	$lg_add_widg‘_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
)

781 
¢d_lg_widg‘_‹m¶©e
 *
wt
 = 
t
->
widg‘
;

782 
¢d_soc_lg_d­m_widg‘
 *
w
;

783 
lg_–em
 *
–em
;

784 
i
, 
»t
 = 0;

786 
	`lg_dbg
("Widg‘: %s", 
wt
->
Çme
);

788 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
, 
wt
->
Çme
,

789 
SND_TPLG_TYPE_DAPM_WIDGET
);

790 ià(!
–em
)

791  -
ENOMEM
;

794 
w
 = 
–em
->
widg‘
;

795 
w
->
size
 = 
–em
->size;

797 
w
->
id
 = 
wt
->id;

798 
	`¢d_¡¾ıy
(
w
->
Çme
, 
wt
->Çme, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

799 ià(
wt
->
¢ame
)

800 
	`¢d_¡¾ıy
(
w
->
¢ame
, 
wt
->¢ame, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

801 
w
->
»g
 = 
wt
->reg;

802 
w
->
shiá
 = 
wt
->shift;

803 
w
->
mask
 = 
wt
->mask;

804 
w
->
sub£q
 = 
wt
->subseq;

805 
w
->
šv”t
 = 
wt
->invert;

806 
w
->
ignÜe_su¥’d
 = 
wt
->ignore_suspend;

807 
w
->
ev’t_æags
 = 
wt
->event_flags;

808 
w
->
ev’t_ty³
 = 
wt
->event_type;

811 ià(
wt
->
´iv
 !ğ
NULL
 && wt->´iv->
size
 > 0) {

812 
»t
 = 
	`lg_add_d©a
(
lg
, 
–em
, 
wt
->
´iv
,

813 (*
wt
->
´iv
è+ wt->´iv->
size
);

814 ià(
»t
 < 0) {

815 
	`lg_–em_ä“
(
–em
);

816  
»t
;

821 
i
 = 0 ; i < 
wt
->
num_ùls
; i++) {

822 
¢d_lg_ùl_‹m¶©e
 *
ù
 = 
wt
->
ùl
[
i
];

823 
lg_–em
 *
–em_ùl
;

824 
¢d_lg_mix”_‹m¶©e
 *
mt
;

825 
¢d_lg_by‹s_‹m¶©e
 *
bt
;

826 
¢d_lg_’um_‹m¶©e
 *
‘
;

828 ià(!
ù
) {

829 
	`lg_–em_ä“
(
–em
);

830  -
EINVAL
;

833 
ù
->
ty³
) {

834 
SND_SOC_TPLG_TYPE_MIXER
:

835 
mt
 = 
	`cÚš”_of
(
ù
, 
¢d_lg_mix”_‹m¶©e
, 
hdr
);

836 
»t
 = 
	`lg_add_mix”
(
lg
, 
mt
, &
–em_ùl
);

839 
SND_SOC_TPLG_TYPE_BYTES
:

840 
bt
 = 
	`cÚš”_of
(
ù
, 
¢d_lg_by‹s_‹m¶©e
, 
hdr
);

841 
»t
 = 
	`lg_add_by‹s
(
lg
, 
bt
, &
–em_ùl
);

844 
SND_SOC_TPLG_TYPE_ENUM
:

845 
‘
 = 
	`cÚš”_of
(
ù
, 
¢d_lg_’um_‹m¶©e
, 
hdr
);

846 
»t
 = 
	`lg_add_’um
(
lg
, 
‘
, &
–em_ùl
);

850 
	`SNDERR
("widget %s: invalidype %d for ctl %d",

851 
wt
->
Çme
, 
ù
->
ty³
, 
i
);

852 
»t
 = -
EINVAL
;

856 ià(
»t
 < 0) {

857 
	`lg_–em_ä“
(
–em
);

858  
»t
;

861 
»t
 = 
	`lg_»f_add_–em
(
–em
, 
–em_ùl
);

862 ià(
»t
 < 0) {

863 
	`lg_–em_ä“
(
–em
);

864  
»t
;

869 
	}
}

872 
	$lg_decode_d­m_widg‘
(
¢d_lg_t
 *
lg
,

873 
size_t
 
pos
,

874 
¢d_soc_lg_hdr
 *
hdr
,

875 *
bš
, 
size_t
 
size
)

877 
li¡_h—d
 
h—p
;

878 
¢d_soc_lg_d­m_widg‘
 *
w
;

879 
¢d_lg_obj_‹m¶©e_t
 
t
;

880 
¢d_lg_widg‘_‹m¶©e
 *
wt
;

881 
¢d_lg_mix”_‹m¶©e
 *
mt
;

882 
¢d_lg_’um_‹m¶©e
 *
‘
;

883 
¢d_lg_by‹s_‹m¶©e
 *
bt
;

884 
¢d_soc_lg_ùl_hdr
 *
chdr
;

885 
¢d_soc_lg_mix”_cÚŒŞ
 *
mc
;

886 
¢d_soc_lg_’um_cÚŒŞ
 *
ec
;

887 
¢d_soc_lg_by‹s_cÚŒŞ
 *
bc
;

888 
size_t
 
size2
;

889 
šdex
;

890 
”r
;

892 
”r
 = 
	`lg_decode_‹m¶©e
(
lg
, 
pos
, 
hdr
, &
t
);

893 ià(
”r
 < 0)

894  
”r
;

896 
Ãxt
:

897 
	`INIT_LIST_HEAD
(&
h—p
);

898 
w
 = 
bš
;

900 ià(
size
 < (*
w
)) {

901 
	`SNDERR
("d­m widg‘: sm®Èsiz%d", 
size
);

902  -
EINVAL
;

904 ià((*
w
è!ğw->
size
) {

905 
	`SNDERR
("dapm widget: unknownƒlement size %d (expected %zd)",

906 
w
->
size
, (*w));

907  -
EINVAL
;

909 ià(
w
->
num_kcÚŒŞs
 > 16) {

910 
	`SNDERR
("dapm widget:oo many kcontrols %d",

911 
w
->
num_kcÚŒŞs
);

912  -
EINVAL
;

915 
	`lg_log
(
lg
, 'D', 
pos
, "dapm widget: size %d…rivate size %d kcontrols %d",

916 
w
->
size
, w->
´iv
.size, w->
num_kcÚŒŞs
);

918 
wt
 = 
	`lg_ÿÎoc
(&
h—p
, (*wtè+ (*è* 
w
->
num_kcÚŒŞs
);

919 ià(
wt
 =ğ
NULL
)

920  -
ENOMEM
;

921 
wt
->
id
 = 
w
->id;

922 
wt
->
Çme
 = 
w
->name;

923 
wt
->
¢ame
 = 
w
->sname;

924 
wt
->
»g
 = 
w
->reg;

925 
wt
->
shiá
 = 
w
->shift;

926 
wt
->
mask
 = 
w
->mask;

927 
wt
->
sub£q
 = 
w
->subseq;

928 
wt
->
šv”t
 = 
w
->invert;

929 
wt
->
ignÜe_su¥’d
 = 
w
->ignore_suspend;

930 
wt
->
ev’t_æags
 = 
w
->event_flags;

931 
wt
->
ev’t_ty³
 = 
w
->event_type;

933 
	`lg_log
(
lg
, 'D', 
pos
, "dapm widget:‚ame '%s' sname '%s'",

934 
wt
->
Çme
, wt->
¢ame
);

936 ià((*
w
è+ w->
´iv
.
size
 > size) {

937 
	`SNDERR
("dapm widget: wrong…rivate data size %d",

938 
w
->
´iv
.
size
);

939  -
EINVAL
;

942 
	`lg_log
(
lg
, 'D', 
pos
 + 
	`off£tof
(
¢d_soc_lg_d­m_widg‘
, 
´iv
),

945 
wt
->
´iv
 = &
w
->priv;

946 
bš
 +ğ(*
w
è+ w->
´iv
.
size
;

947 
size
 -ğ(*
w
è+ w->
´iv
.size;

948 
pos
 +ğ(*
w
è+ w->
´iv
.
size
;

950 
šdex
 = 0; index < 
w
->
num_kcÚŒŞs
; index++) {

951 
chdr
 = 
bš
;

952 
chdr
->
ty³
) {

953 
SND_SOC_TPLG_TYPE_MIXER
:

954 
mt
 = 
	`lg_ÿÎoc
(&
h—p
, (*mt));

955 ià(
mt
 =ğ
NULL
) {

956 
”r
 = -
ENOMEM
;

957 
»tv®
;

959 
wt
->
ùl
[
šdex
] = (*)
mt
;

960 
wt
->
num_ùls
++;

961 
mc
 = 
bš
;

962 
size2
 = 
mc
->
size
 + mc->
´iv
.size;

963 
	`lg_log
(
lg
, 'D', 
pos
, "kcÚŒŞ mix” siz%zd", 
size2
);

964 ià(
size2
 > 
size
) {

965 
	`SNDERR
("dapm widget: small mixer size %d",

966 
size2
);

967 
”r
 = -
EINVAL
;

968 
»tv®
;

970 
”r
 = 
	`lg_decode_cÚŒŞ_mix”1
(
lg
, &
h—p
, 
mt
, 
pos
,

971 
bš
, 
size2
);

973 
SND_SOC_TPLG_TYPE_ENUM
:

974 
‘
 = 
	`lg_ÿÎoc
(&
h—p
, (*
mt
));

975 ià(
‘
 =ğ
NULL
) {

976 
”r
 = -
ENOMEM
;

977 
»tv®
;

979 
wt
->
ùl
[
šdex
] = (*)
‘
;

980 
wt
->
num_ùls
++;

981 
ec
 = 
bš
;

982 
size2
 = 
ec
->
size
 +ƒc->
´iv
.size;

983 
	`lg_log
(
lg
, 'D', 
pos
, "kcÚŒŞƒnum siz%zd", 
size2
);

984 ià(
size2
 > 
size
) {

985 
	`SNDERR
("dapm widget: smallƒnum size %d",

986 
size2
);

987 
”r
 = -
EINVAL
;

988 
»tv®
;

990 
”r
 = 
	`lg_decode_cÚŒŞ_’um1
(
lg
, &
h—p
, 
‘
, 
pos
, 
ec
);

992 
SND_SOC_TPLG_TYPE_BYTES
:

993 
bt
 = 
	`lg_ÿÎoc
(&
h—p
, (*bt));

994 ià(
bt
 =ğ
NULL
) {

995 
”r
 = -
ENOMEM
;

996 
»tv®
;

998 
wt
->
ùl
[
šdex
] = (*)
bt
;

999 
wt
->
num_ùls
++;

1000 
bc
 = 
bš
;

1001 
size2
 = 
bc
->
size
 + bc->
´iv
.size;

1002 
	`lg_log
(
lg
, 'D', 
pos
, "kcÚŒŞ by‹ siz%zd", 
size2
);

1003 ià(
size2
 > 
size
) {

1004 
	`SNDERR
("dapm widget: small bytes size %d",

1005 
size2
);

1006 
”r
 = -
EINVAL
;

1007 
»tv®
;

1009 
”r
 = 
	`lg_decode_cÚŒŞ_by‹s1
(
lg
, 
bt
, 
pos
,

1010 
bš
, 
size2
);

1013 
	`SNDERR
("dapm widget: wrong controlype %d",

1014 
chdr
->
ty³
);

1015 
”r
 = -
EINVAL
;

1016 
»tv®
;

1018 ià(
”r
 < 0)

1019 
»tv®
;

1020 
bš
 +ğ
size2
;

1021 
size
 -ğ
size2
;

1022 
pos
 +ğ
size2
;

1025 
t
.
widg‘
 = 
wt
;

1026 
”r
 = 
	`¢d_lg_add_objeù
(
lg
, &
t
);

1027 
	`lg_ä“
(&
h—p
);

1028 ià(
”r
 < 0)

1029  
”r
;

1030 ià(
size
 > 0)

1031 
Ãxt
;

1034 
»tv®
:

1035 
	`lg_ä“
(&
h—p
);

1036  
”r
;

1037 
	}
}

1040 
	$lg_decode_d­m_g¿ph
(
¢d_lg_t
 *
lg
,

1041 
size_t
 
pos
,

1042 
¢d_soc_lg_hdr
 *
hdr
,

1043 *
bš
, 
size_t
 
size
)

1045 
¢d_soc_lg_d­m_g¿ph_–em
 *
g
;

1046 
¢d_lg_obj_‹m¶©e_t
 
t
;

1047 
¢d_lg_g¿ph_‹m¶©e
 *
gt
;

1048 
¢d_lg_g¿ph_–em
 *
ge
;

1049 
size_t
 
asize
;

1050 
”r
;

1052 
”r
 = 
	`lg_decode_‹m¶©e
(
lg
, 
pos
, 
hdr
, &
t
);

1053 ià(
”r
 < 0)

1054  
”r
;

1056 
asize
 = (*
gt
è+ (
size
 / (*
g
)è* (*
ge
);

1057 
gt
 = 
	`®loÿ
(
asize
);

1058 
	`mem£t
(
gt
, 0, 
asize
);

1059 
ge
 = 
gt
->
–em
; 
size
 > 0; ge++) {

1060 
g
 = 
bš
;

1061 ià(
size
 < (*
g
)) {

1062 
	`SNDERR
("d­m g¿ph: sm®Èsiz%d", 
size
);

1063  -
EINVAL
;

1065 
ge
->
¤c
 = 
g
->
sourû
;

1066 
ge
->
ùl
 = 
g
->
cÚŒŞ
;

1067 
ge
->
sšk
 = 
g
->sink;

1068 
gt
->
couÁ
++;

1069 
	`lg_log
(
lg
, 'D', 
pos
, "dapm graph: src='%s' ctl='%s' sink='%s'",

1070 
ge
->
¤c
, ge->
ùl
, ge->
sšk
);

1071 
bš
 +ğ(*
g
);

1072 
size
 -ğ(*
g
);

1073 
pos
 +ğ(*
g
);

1076 
t
.
g¿ph
 = 
gt
;

1077  
	`¢d_lg_add_objeù
(
lg
, &
t
);

1078 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/data.c

20 
	~"lg_loÿl.h
"

21 
	~<ùy³.h
>

23 
	#UUID_FORMAT
 "\
%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:\
%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x"

	)

28 
¢d_soc_lg_´iv©e
 *
	$g‘_´iv_d©a
(
lg_–em
 *
–em
)

30 
¢d_soc_lg_´iv©e
 *
´iv
 = 
NULL
;

32 
–em
->
ty³
) {

33 
SND_TPLG_TYPE_MANIFEST
:

34 
´iv
 = &
–em
->
mªiã¡
->priv;

37 
SND_TPLG_TYPE_MIXER
:

38 
´iv
 = &
–em
->
mix”_ù¾
->priv;

41 
SND_TPLG_TYPE_ENUM
:

42 
´iv
 = &
–em
->
’um_ù¾
->priv;

45 
SND_TPLG_TYPE_BYTES
:

46 
´iv
 = &
–em
->
by‹s_ext
->priv;

49 
SND_TPLG_TYPE_DAPM_WIDGET
:

50 
´iv
 = &
–em
->
widg‘
->priv;

53 
SND_TPLG_TYPE_DAI
:

54 
´iv
 = &
–em
->
dai
->priv;

56 
SND_TPLG_TYPE_BE
:

57 
´iv
 = &
–em
->
lšk
->priv;

59 
SND_TPLG_TYPE_PCM
:

60 
´iv
 = &
–em
->
pcm
->priv;

63 
	`SNDERR
("'%s':‚o support for…rivate data forype %d",

64 
–em
->
id
,ƒËm->
ty³
);

67  
´iv
;

68 
	}
}

73 
	$lg_·r£_»fs
(
¢d_cÚfig_t
 *
cfg
, 
lg_–em
 *
–em
,

74 
ty³
)

76 
¢d_cÚfig_ty³_t
 
cfg_ty³
;

77 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

78 
¢d_cÚfig_t
 *
n
;

79 cÚ¡ *
v®
 = 
NULL
;

80 
”r
, 
couÁ
;

82 
cfg_ty³
 = 
	`¢d_cÚfig_g‘_ty³
(
cfg
);

85 ià(
cfg_ty³
 =ğ
SND_CONFIG_TYPE_STRING
) {

86 ià(
	`¢d_cÚfig_g‘_¡ršg
(
cfg
, &
v®
) < 0)

87  -
EINVAL
;

89 
	`lg_dbg
("\Œeàd©a: %s", 
v®
);

90 
”r
 = 
	`lg_»f_add
(
–em
, 
ty³
, 
v®
);

91 ià(
”r
 < 0)

92  
”r
;

96 ià(
cfg_ty³
 !ğ
SND_CONFIG_TYPE_COMPOUND
) {

97 
	`SNDERR
("compoundy³ƒx³ùed fÜ %s", 
–em
->
id
);

98  -
EINVAL
;

102 
couÁ
 = 0;

103 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

104 cÚ¡ *
v®
;

106 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

107 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®
) < 0)

110 
	`lg_dbg
("\Œeàd©a: %s", 
v®
);

111 
”r
 = 
	`lg_»f_add
(
–em
, 
ty³
, 
v®
);

112 ià(
”r
 < 0)

113  
”r
;

114 
couÁ
++;

117  
couÁ
;

118 
	}
}

121 
	$lg_§ve_»fs
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

122 
lg_–em
 *
–em
, 
ty³
,

123 cÚ¡ *
id
, 
lg_buf
 *
d¡
,

124 cÚ¡ *
pfx
)

126 
lg_»f
 *
»f
, *
Ï¡
;

127 
li¡_h—d
 *
pos
;

128 
”r
, 
couÁ
;

130 
couÁ
 = 0;

131 
Ï¡
 = 
NULL
;

132 
	`li¡_fÜ_—ch
(
pos
, &
–em
->
»f_li¡
) {

133 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

134 ià(
»f
->
ty³
 ==ype) {

135 
Ï¡
 = 
»f
;

136 
couÁ
++;

140 ià(
couÁ
 == 0)

143 ià(
couÁ
 == 1)

144  
	`lg_§ve_´štf
(
d¡
, 
pfx
, "% '%s'\n", 
id
, 
Ï¡
->id);

146 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "% [\n", 
id
);

147 ià(
”r
 < 0)

148  
”r
;

149 
	`li¡_fÜ_—ch
(
pos
, &
–em
->
»f_li¡
) {

150 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

151 ià(
»f
->
ty³
 ==ype) {

152 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t'%s'\n", 
»f
->
id
);

153 ià(
”r
 < 0)

154  
”r
;

158  
	`lg_§ve_´štf
(
d¡
, 
pfx
, "]\n");

159 
	}
}

162 
	$lg_·r£_d©a_fe
(
¢d_cÚfig_t
 *
cfg
, 
lg_–em
 *
–em
)

164 
¢d_soc_lg_´iv©e
 *
´iv
 = 
NULL
;

165 cÚ¡ *
v®ue
 = 
NULL
;

166 
f’ame
[
PATH_MAX
];

167 *
’v
 = 
	`g‘’v
(
ALSA_CONFIG_TPLG_VAR
);

168 
FILE
 *
å
;

169 
size_t
 
size
, 
by‹s_»ad
;

170 
»t
 = 0;

172 
	`lg_dbg
("d©¨D©aFe: %s", 
–em
->
id
);

174 ià(
	`¢d_cÚfig_g‘_¡ršg
(
cfg
, &
v®ue
) < 0)

175  -
EINVAL
;

178 ià(
’v
)

179 
	`¢´štf
(
f’ame
, (f’ame), "%s/%s", 
’v
, 
v®ue
);

181 
	`¢´štf
(
f’ame
, (filename), "%s/topology/%s",

182 
	`¢d_cÚfig_tİdœ
(), 
v®ue
);

184 
å
 = 
	`fİ’
(
f’ame
, "r");

185 ià(
å
 =ğ
NULL
) {

186 
	`SNDERR
("šv®id d©¨f·th '%s'", 
f’ame
);

187  -
”ºo
;

190 
	`f£ek
(
å
, 0L, 
SEEK_END
);

191 
size
 = 
	`á–l
(
å
);

192 
	`f£ek
(
å
, 0L, 
SEEK_SET
);

193 ià(
size
 <= 0) {

194 
	`SNDERR
("šv®id d©¨fsiz%zu", 
size
);

195 
»t
 = -
EINVAL
;

196 
”r
;

198 ià(
size
 > 
TPLG_MAX_PRIV_SIZE
) {

199 
	`SNDERR
("d©¨ftoØbig %zu", 
size
);

200 
»t
 = -
EINVAL
;

201 
”r
;

204 
´iv
 = 
	`ÿÎoc
(1, (*´ivè+ 
size
);

205 ià(!
´iv
) {

206 
»t
 = -
ENOMEM
;

207 
”r
;

210 
by‹s_»ad
 = 
	`ä—d
(&
´iv
->
d©a
, 1, 
size
, 
å
);

211 ià(
by‹s_»ad
 !ğ
size
) {

212 
»t
 = -
”ºo
;

213 
”r
;

216 
–em
->
d©a
 = 
´iv
;

217 
´iv
->
size
 = size;

218 
–em
->
size
 = (*
´iv
) + size;

220 ià(
	`fşo£
(
å
è=ğ
EOF
) {

221 
	`SNDERR
("Cannot close data file.");

222  -
”ºo
;

226 
”r
:

227 
	`fşo£
(
å
);

228 ià(
´iv
)

229 
	`ä“
(
´iv
);

230  
»t
;

231 
	}
}

233 
	$dump_´iv_d©a
(
lg_–em
 *
–em
 
ATTRIBUTE_UNUSED
)

235 #ifdeà
TPLG_DEBUG


236 
¢d_soc_lg_´iv©e
 *
´iv
 = 
–em
->
d©a
;

237 *
p
 = (*)
´iv
->
d©a
;

238 
buf
[128], 
buf2
[8];

239 
i
;

241 
	`lg_dbg
("ƒlem size = %d,…riv data size = %d",

242 
–em
->
size
, 
´iv
->size);

244 
buf
[0] = '\0';

245 
i
 = 0; i < 
´iv
->
size
; i++) {

246 ià(
i
 > 0 && (i % 16) == 0) {

247 
	`lg_dbg
("%s", 
buf
);

248 
buf
[0] = '\0';

251 
	`¢´štf
(
buf2
, (buf2), " %02x", *
p
++);

252 
	`¡rÿt
(
buf
, 
buf2
);

255 ià(
buf
[0])

256 
	`lg_dbg
("%s", 
buf
);

258 
	}
}

260 
šlše
 
	$check_nibbË
(
c
)

262  (
c
 >= '0' && c <= '9') ||

263 (
c
 >= 'a' && c <= 'f') ||

264 (
c
 >= 'A' && c <= 'F');

265 
	}
}

268 
	$g‘_hex_num
(cÚ¡ *
¡r
)

270 
d–ims
, 
v®ues
, 
Ën
 = 
	`¡¾’
(
¡r
);

271 cÚ¡ *
s
, *
’d
 = 
¡r
 + 
Ën
;

274 
s
 = 
¡r
;

275 
d–ims
 = 
v®ues
 = 0;

276 
s
 < 
’d
) {

278 ià(
	`is¥aû
(*
s
)) {

279 
s
++;

283 ià(*
s
 == ':') {

284 
d–ims
++;

285 
s
++;

289 ià(
s
 + 1 <ğ
’d
) {

290 ià(
	`check_nibbË
(
s
[0]) && check_nibble(s[1])) {

291 
v®ues
++;

293 
fÜm©2
;

295 
s
++;

297 
s
++;

299 
’d
;

301 
fÜm©2
:

303 
s
 = 
¡r
;

304 
d–ims
 = 
v®ues
 = 0;

305 
s
 < 
’d
) {

308 ià(
	`is¥aû
(*
s
)) {

309 
s
++;

314 ià(*
s
 == ',') {

315 
d–ims
++;

316 
s
++;

321 ià(*
s
 =ğ'0' && s + 2 <ğ
’d
) {

322 ià(
s
[1] =ğ'x' && 
	`check_nibbË
(s[2])) {

323 ià(
	`check_nibbË
(
s
[3]))

324 
s
++;

325 
v®ues
++;

326 
s
 += 2;

330 
s
++;

333 
’d
:

335 ià(
v®ues
 - 1 !ğ
d–ims
)

336  -
EINVAL
;

338  
v®ues
;

339 
	}
}

342 
	$g‘_uuid
(cÚ¡ *
¡r
, *
uuid_Ë
)

344 
v®
;

345 *
tmp
, *
s
 = 
NULL
;

346 
v®ues
 = 0, 
»t
 = 0;

348 
tmp
 = 
	`¡rdup
(
¡r
);

349 ià(
tmp
 =ğ
NULL
)

350  -
ENOMEM
;

352 ià(
	`¡rchr
(
tmp
, ':'è=ğ
NULL
)

353 
d©a2
;

355 
s
 = 
	`¡¹ok
(
tmp
, ":");

356 
s
 !ğ
NULL
) {

357 
”ºo
 = 0;

358 
v®
 = 
	`¡¹oul
(
s
, 
NULL
, 16);

359 ià((
”ºo
 =ğ
ERANGE
 && 
v®
 =ğ
ULONG_MAX
)

360 || (
”ºo
 !ğ0 && 
v®
 == 0)

361 || (
v®
 > 
UCHAR_MAX
)) {

362 
	`SNDERR
("invalid value for uuid");

363 
»t
 = -
EINVAL
;

364 
out
;

367 *(
uuid_Ë
 + 
v®ues
èğ()
v®
;

369 
v®ues
++;

370 ià(
v®ues
 >= 16)

373 
s
 = 
	`¡¹ok
(
NULL
, ":");

375 
out
;

377 
d©a2
:

378 
s
 = 
	`¡¹ok
(
tmp
, ",");

380 
s
 !ğ
NULL
) {

381 
”ºo
 = 0;

382 
v®
 = 
	`¡¹oul
(
s
, 
NULL
, 0);

383 ià((
”ºo
 =ğ
ERANGE
 && 
v®
 =ğ
ULONG_MAX
)

384 || (
”ºo
 !ğ0 && 
v®
 == 0)

385 || (
v®
 > 
UCHAR_MAX
)) {

386 
	`SNDERR
("invalid value for uuid");

387 
»t
 = -
EINVAL
;

388 
out
;

391 *(
uuid_Ë
 + 
v®ues
èğ()
v®
;

393 
v®ues
++;

394 ià(
v®ues
 >= 16)

397 
s
 = 
	`¡¹ok
(
NULL
, ",");

400 ià(
v®ues
 < 16) {

401 
	`SNDERR
("lesshan 16 integers for uuid");

402 
»t
 = -
EINVAL
;

405 
out
:

406 
	`ä“
(
tmp
);

407  
»t
;

408 
	}
}

410 
	$wr™e_hex
(*
buf
, *
¡r
, 
width
)

412 
v®
;

413 *
p
 = &
v®
;

415 
”ºo
 = 0;

416 ià(
	`§ã_¡¹Ş_ba£
(
¡r
, &
v®
, 16) < 0)

417  -
EINVAL
;

419 
width
) {

421 *(*)
buf
 = *(*)
p
;

424 *(*)
buf
 = *(*)
p
;

427 *(*)
buf
 = *(*)
p
;

430  -
EINVAL
;

434 
	}
}

436 
	$cİy_d©a_hex
(*
d©a
, 
off
, cÚ¡ *
¡r
, 
width
)

438 *
tmp
, *
s
 = 
NULL
, *
p
 = 
d©a
;

439 
»t
;

441 
tmp
 = 
	`¡rdup
(
¡r
);

442 ià(
tmp
 =ğ
NULL
)

443  -
ENOMEM
;

445 
p
 +ğ
off
;

446 
s
 = 
	`¡¹ok
(
tmp
, ",:");

448 
s
 !ğ
NULL
) {

449 
»t
 = 
	`wr™e_hex
(
p
, 
s
, 
width
);

450 ià(
»t
 < 0) {

451 
	`ä“
(
tmp
);

452  
»t
;

455 
s
 = 
	`¡¹ok
(
NULL
, ",:");

456 
p
 +ğ
width
;

459 
	`ä“
(
tmp
);

461 
	}
}

463 
	$lg_·r£_d©a_hex
(
¢d_cÚfig_t
 *
cfg
, 
lg_–em
 *
–em
,

464 
width
)

466 
¢d_soc_lg_´iv©e
 *
´iv
;

467 cÚ¡ *
v®ue
 = 
NULL
;

468 
size
, 
esize
, 
off
, 
num
;

469 
»t
;

471 
	`lg_dbg
(" d©a: %s", 
–em
->
id
);

473 ià(
	`¢d_cÚfig_g‘_¡ršg
(
cfg
, &
v®ue
) < 0)

474  -
EINVAL
;

476 
num
 = 
	`g‘_hex_num
(
v®ue
);

477 ià(
num
 <= 0) {

478 
	`SNDERR
("m®fÜmed hex v¬ŸbË†i¡ %s", 
v®ue
);

479  -
EINVAL
;

482 
size
 = 
num
 * 
width
;

483 
´iv
 = 
–em
->
d©a
;

485 ià(
size
 > 
TPLG_MAX_PRIV_SIZE
) {

486 
	`SNDERR
("d©¨toØbig %d", 
size
);

487  -
EINVAL
;

490 ià(
´iv
 !ğ
NULL
) {

491 
off
 = 
´iv
->
size
;

492 
esize
 = 
–em
->
size
 + size;

493 
´iv
 = 
	`»®loc
Õriv, 
esize
);

495 
off
 = 0;

496 
esize
 = (*
´iv
è+ 
size
;

497 
´iv
 = 
	`ÿÎoc
(1, 
esize
);

500 ià(!
´iv
)

501  -
ENOMEM
;

503 
–em
->
d©a
 = 
´iv
;

504 
´iv
->
size
 += size;

505 
–em
->
size
 = 
esize
;

507 
»t
 = 
	`cİy_d©a_hex
(
´iv
->
d©a
, 
off
, 
v®ue
, 
width
);

509 
	`dump_´iv_d©a
(
–em
);

510  
»t
;

511 
	}
}

514 
	$g‘_tok’_v®ue
(cÚ¡ *
tok’_id
,

515 
lg_v’dÜ_tok’s
 *
tok’s
)

517 
i
;

519 
i
 = 0; i < 
tok’s
->
num_tok’s
; i++) {

520 ià(
	`¡rcmp
(
tok’_id
, 
tok’s
->
tok’
[
i
].
id
) == 0)

521  
tok’s
->
tok’
[
i
].
v®ue
;

524 
	`SNDERR
("ÿÂÙ fšdok’ id '%s'", 
tok’_id
);

526 
	}
}

529 
lg_–em
 *
	$g‘_tok’s
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
)

531 
lg_»f
 *
»f
;

532 
li¡_h—d
 *
ba£
, *
pos
;

534 
ba£
 = &
–em
->
»f_li¡
;

535 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

537 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

539 ià(
»f
->
ty³
 !ğ
SND_TPLG_TYPE_TOKEN
)

542 ià(!
»f
->
–em
) {

543 
»f
->
–em
 = 
	`lg_–em_lookup
(&
lg
->
tok’_li¡
,

544 
»f
->
id
, 
SND_TPLG_TYPE_TOKEN
, 
–em
->
šdex
);

547  
»f
->
–em
;

550  
NULL
;

551 
	}
}

554 
boŞ
 
	$has_tu¶es
(
lg_–em
 *
–em
)

556 
lg_»f
 *
»f
;

557 
li¡_h—d
 *
ba£
, *
pos
;

559 
ba£
 = &
–em
->
»f_li¡
;

560 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

562 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

563 ià(
»f
->
ty³
 =ğ
SND_TPLG_TYPE_TUPLE
)

564  
Œue
;

567  
çl£
;

568 
	}
}

571 
	$lg_g‘_tu¶e_size
(
ty³
)

573 
ty³
) {

575 
SND_SOC_TPLG_TUPLE_TYPE_UUID
:

576  (
¢d_soc_lg_v’dÜ_uuid_–em
);

578 
SND_SOC_TPLG_TUPLE_TYPE_STRING
:

579  (
¢d_soc_lg_v’dÜ_¡ršg_–em
);

582  (
¢d_soc_lg_v’dÜ_v®ue_–em
);

584 
	}
}

587 
	$cİy_tu¶es
(
lg_–em
 *
–em
,

588 
lg_v’dÜ_tu¶es
 *
tu¶es
,

589 
lg_v’dÜ_tok’s
 *
tok’s
)

591 
¢d_soc_lg_´iv©e
 *
´iv
 = 
–em
->
d©a
, *
´iv2
;

592 
lg_tu¶e_£t
 *
tu¶e_£t
;

593 
lg_tu¶e
 *
tu¶e
;

594 
¢d_soc_lg_v’dÜ_¬¿y
 *
¬¿y
;

595 
¢d_soc_lg_v’dÜ_uuid_–em
 *
uuid
;

596 
¢d_soc_lg_v’dÜ_¡ršg_–em
 *
¡ršg
;

597 
¢d_soc_lg_v’dÜ_v®ue_–em
 *
v®ue
;

598 
£t_size
, 
size
, 
off
;

599 
i
, 
j
;

600 
tok’_v®
;

602 
size
 = 
´iv
 ?…riv->size : 0;

605 
i
 = 0; i < 
tu¶es
->
num_£ts
 ; i++) {

606 
tu¶e_£t
 = 
tu¶es
->
£t
[
i
];

607 
£t_size
 = (
¢d_soc_lg_v’dÜ_¬¿y
)

608 + 
	`lg_g‘_tu¶e_size
(
tu¶e_£t
->
ty³
)

609 * 
tu¶e_£t
->
num_tu¶es
;

610 
size
 +ğ
£t_size
;

611 ià(
size
 > 
TPLG_MAX_PRIV_SIZE
) {

612 
	`SNDERR
("d©¨toØbig %d", 
size
);

613  -
EINVAL
;

616 ià(
´iv
 !ğ
NULL
) {

617 
´iv2
 = 
	`»®loc
(
´iv
, (*´ivè+ 
size
);

618 ià(
´iv2
 =ğ
NULL
) {

619 
	`ä“
(
´iv
);

620 
´iv
 = 
NULL
;

622 
´iv
 = 
´iv2
;

625 
´iv
 = 
	`ÿÎoc
(1, (*´ivè+ 
size
);

627 ià(!
´iv
)

628  -
ENOMEM
;

630 
off
 = 
´iv
->
size
;

631 
´iv
->
size
 = size;

632 
–em
->
d©a
 = 
´iv
;

634 
¬¿y
 = (
¢d_soc_lg_v’dÜ_¬¿y
 *)(
´iv
->
d©a
 + 
off
);

635 
	`mem£t
(
¬¿y
, 0, 
£t_size
);

636 
¬¿y
->
size
 = 
£t_size
;

637 
¬¿y
->
ty³
 = 
tu¶e_£t
->type;

638 
¬¿y
->
num_–ems
 = 
tu¶e_£t
->
num_tu¶es
;

641 
j
 = 0; j < 
tu¶e_£t
->
num_tu¶es
; j++) {

642 
tu¶e
 = &
tu¶e_£t
->tu¶e[
j
];

643 
tok’_v®
 = 
	`g‘_tok’_v®ue
(
tu¶e
->
tok’
, 
tok’s
);

644 ià(
tok’_v®
 < 0)

645  -
EINVAL
;

647 
tu¶e_£t
->
ty³
) {

648 
SND_SOC_TPLG_TUPLE_TYPE_UUID
:

649 
uuid
 = &
¬¿y
->uuid[
j
];

650 
uuid
->
tok’
 = 
tok’_v®
;

651 
	`memıy
(
uuid
->uuid, 
tu¶e
->uuid, 16);

654 
SND_SOC_TPLG_TUPLE_TYPE_STRING
:

655 
¡ršg
 = &
¬¿y
->¡ršg[
j
];

656 
¡ršg
->
tok’
 = 
tok’_v®
;

657 
	`¢d_¡¾ıy
(
¡ršg
->¡ršg, 
tu¶e
->string,

658 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

662 
v®ue
 = &
¬¿y
->v®ue[
j
];

663 
v®ue
->
tok’
 = 
tok’_v®
;

664 
v®ue
->v®uğ
tu¶e
->value;

671 
	}
}

674 
	$bud_tu¶es
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
)

676 
lg_»f
 *
»f
;

677 
li¡_h—d
 *
ba£
, *
pos
;

678 
lg_–em
 *
tu¶es
, *
tok’s
;

679 
”r
;

681 
ba£
 = &
–em
->
»f_li¡
;

682 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

684 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

686 ià(
»f
->
ty³
 !ğ
SND_TPLG_TYPE_TUPLE
)

689 
	`lg_dbg
("tu¶e '%s' u£d by d©¨'%s'", 
»f
->
id
, 
–em
->id);

691 ià(!
»f
->
–em
)

692 
»f
->
–em
 = 
	`lg_–em_lookup
(&
lg
->
tu¶e_li¡
,

693 
»f
->
id
, 
SND_TPLG_TYPE_TUPLE
, 
–em
->
šdex
);

694 
tu¶es
 = 
»f
->
–em
;

695 ià(!
tu¶es
) {

696 
	`SNDERR
("ÿÂÙ fšdu¶e %s", 
»f
->
id
);

697  -
EINVAL
;

700 
tok’s
 = 
	`g‘_tok’s
(
lg
, 
tu¶es
);

701 ià(!
tok’s
) {

702 
	`SNDERR
("ÿÂÙ fšdok’ fÜ %s", 
»f
->
id
);

703  -
EINVAL
;

707 
”r
 = 
	`cİy_tu¶es
(
–em
, 
tu¶es
->tu¶es, 
tok’s
->tokens);

708 ià(
”r
 < 0)

709  
”r
;

713 
	}
}

715 #iâdeà
DOC_HIDDEN


716 
	stu¶e_ty³
 {

717 
	mty³
;

718 cÚ¡ *
	mÇme
;

719 
	msize
;

723 
tu¶e_ty³
 
	gtu¶e_ty³s
[] = {

725 .
ty³
 = 
SND_SOC_TPLG_TUPLE_TYPE_UUID
,

726 .
	gÇme
 = "uuid",

727 .
	gsize
 = 4,

730 .
	gty³
 = 
SND_SOC_TPLG_TUPLE_TYPE_STRING
,

731 .
	gÇme
 = "string",

732 .
	gsize
 = 6,

735 .
	gty³
 = 
SND_SOC_TPLG_TUPLE_TYPE_BOOL
,

736 .
	gÇme
 = "bool",

737 .
	gsize
 = 4,

740 .
	gty³
 = 
SND_SOC_TPLG_TUPLE_TYPE_BYTE
,

741 .
	gÇme
 = "byte",

742 .
	gsize
 = 4,

745 .
	gty³
 = 
SND_SOC_TPLG_TUPLE_TYPE_SHORT
,

746 .
	gÇme
 = "short",

747 .
	gsize
 = 5,

750 .
	gty³
 = 
SND_SOC_TPLG_TUPLE_TYPE_WORD
,

751 .
	gÇme
 = "word",

752 .
	gsize
 = 4

756 
	$g‘_tu¶e_ty³
(cÚ¡ *
Çme
)

758 
tu¶e_ty³
 *
t
;

759 
i
;

762 (*
Çme
 >= '0' && *name <= '9') || *name == '_')

763 
Çme
++;

764 
i
 = 0; i < 
	`ARRAY_SIZE
(
tu¶e_ty³s
); i++) {

765 
t
 = &
tu¶e_ty³s
[
i
];

766 ià(
	`¡ºÿ£cmp
(
t
->
Çme
,‚ame,->
size
) == 0)

767  
t
->
ty³
;

769  -
EINVAL
;

770 
	}
}

772 cÚ¡ *
	$g‘_tu¶e_ty³_Çme
(
ty³
)

774 
i
;

776 
i
 = 0; i < 
	`ARRAY_SIZE
(
tu¶e_ty³s
); i++)

777 ià(
tu¶e_ty³s
[
i
].
ty³
 ==ype)

778  
tu¶e_ty³s
[
i
].
Çme
;

779  
NULL
;

780 
	}
}

782 
	$·r£_tu¶e_£t
(
¢d_cÚfig_t
 *
cfg
,

783 
lg_tu¶e_£t
 **
s
)

785 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

786 
¢d_cÚfig_t
 *
n
;

787 cÚ¡ *
id
, *
v®ue
;

788 
lg_tu¶e_£t
 *
£t
;

789 
num_tu¶es
 = 0;

790 
lg_tu¶e
 *
tu¶e
;

791 
tu¶e_v®
;

792 
ty³
, 
iv®
;

794 
	`¢d_cÚfig_g‘_id
(
cfg
, &
id
);

796 
ty³
 = 
	`g‘_tu¶e_ty³
(
id
);

797 ià(
ty³
 < 0) {

798 
	`SNDERR
("šv®idu¶ty³ '%s'", 
id
);

799  
ty³
;

802 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
)

803 
num_tu¶es
++;

804 ià(!
num_tu¶es
)

807 
	`lg_dbg
("\ˆ%d % tu¶es:", 
num_tu¶es
, 
id
);

808 
£t
 = 
	`ÿÎoc
(1, (*£tè+ 
num_tu¶es
 * (
lg_tu¶e
));

809 ià(!
£t
)

810  -
ENOMEM
;

812 
£t
->
ty³
 =ype;

814 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

816 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

819 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

822 
tu¶e
 = &
£t
->tu¶e[£t->
num_tu¶es
];

823 
	`¢d_¡¾ıy
(
tu¶e
->
tok’
, 
id
,

824 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

826 
ty³
) {

827 
SND_SOC_TPLG_TUPLE_TYPE_UUID
:

828 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®ue
) < 0)

830 ià(
	`g‘_uuid
(
v®ue
, 
tu¶e
->
uuid
) < 0)

831 
”r
;

834 
SND_SOC_TPLG_TUPLE_TYPE_STRING
:

835 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®ue
) < 0)

837 
	`¢d_¡¾ıy
(
tu¶e
->
¡ršg
, 
v®ue
,

838 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

839 
	`lg_dbg
("\t\t% ğ%s", 
tu¶e
->
tok’
,u¶e->
¡ršg
);

842 
SND_SOC_TPLG_TUPLE_TYPE_BOOL
:

843 
iv®
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

844 ià(
iv®
 < 0)

846 
tu¶e
->
v®ue
 = 
iv®
;

847 
	`lg_dbg
("\t\t% ğ%d", 
tu¶e
->
tok’
,u¶e->
v®ue
);

850 
SND_SOC_TPLG_TUPLE_TYPE_BYTE
:

851 
SND_SOC_TPLG_TUPLE_TYPE_SHORT
:

852 
SND_SOC_TPLG_TUPLE_TYPE_WORD
:

853 
iv®
 = 
	`lg_g‘_unsigÃd
(
n
, &
tu¶e_v®
, 0);

854 ià(
iv®
 < 0) {

855 
	`SNDERR
("tu¶%s: %s", 
id
, 
	`¢d_¡»¼Ü
(
iv®
));

856 
”r
;

861 (
ty³
 =ğ
SND_SOC_TPLG_TUPLE_TYPE_SHORT


862 && 
tu¶e_v®
 > 
USHRT_MAX
) ||

863 (
ty³
 =ğ
SND_SOC_TPLG_TUPLE_TYPE_BYTE


864 && 
tu¶e_v®
 > 
UCHAR_MAX
)) {

865 
	`SNDERR
("tu¶%s: inv®id v®ue", 
id
);

866 
”r
;

869 
tu¶e
->
v®ue
 = 
tu¶e_v®
;

870 
	`lg_dbg
("\t\t% ğ0x%x", 
tu¶e
->
tok’
,u¶e->
v®ue
);

877 
£t
->
num_tu¶es
++;

880 *
s
 = 
£t
;

883 
”r
:

884 
	`ä“
(
£t
);

885  -
EINVAL
;

886 
	}
}

889 
	$lg_§ve_tu¶e_£t
(
lg_v’dÜ_tu¶es
 *
tu¶es
,

890 
£t_šdex
,

891 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

893 
lg_tu¶e_£t
 *
£t
;

894 
lg_tu¶e
 *
tu¶e
;

895 cÚ¡ *
s
, *
fmt
;

896 
buf
[32];

897 
i
;

898 
”r
;

900 
£t
 = 
tu¶es
->£t[
£t_šdex
];

901 ià(
£t
->
num_tu¶es
 == 0)

903 
s
 = 
	`g‘_tu¶e_ty³_Çme
(
£t
->
ty³
);

904 ià(
s
 =ğ
NULL
)

905  -
EINVAL
;

906 ià(
tu¶es
->
num_£ts
 < 10)

907 
fmt
 = "%u_";

908 ià(
tu¶es
->
num_£ts
 < 100)

909 
fmt
 = "%02u_";

910 ià(
tu¶es
->
num_£ts
 < 1000)

911 
fmt
 = "%03u_";

913  -
EINVAL
;

914 ià(
£t
->
num_tu¶es
 > 1) {

915 
	`¢´štf
(
buf
, (buf), "tu¶es.%s%% {\n", 
fmt
);

916 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, 
buf
, 
£t_šdex
, 
s
);

917 ià(
”r
 < 0)

918  
”r
;

920 
i
 = 0; i < 
£t
->
num_tu¶es
; i++) {

921 
tu¶e
 = &
£t
->tu¶e[
i
];

922 ià(
£t
->
num_tu¶es
 == 1) {

923 
	`¢´štf
(
buf
, (buf), "tu¶es.%s%%s.'%%s' ", 
fmt
);

924 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, 
buf
,

925 
£t_šdex
, 
s
, 
tu¶e
->
tok’
);

927 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t'%s' ",

928 
tu¶e
->
tok’
);

930 ià(
”r
 < 0)

931  
”r
;

932 
£t
->
ty³
) {

933 
SND_SOC_TPLG_TUPLE_TYPE_UUID
:

934 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'" 
UUID_FORMAT
 "'\n",

935 
tu¶e
->
uuid
[0],uple->uuid[1],

936 
tu¶e
->
uuid
[2],uple->uuid[3],

937 
tu¶e
->
uuid
[4],uple->uuid[5],

938 
tu¶e
->
uuid
[6],uple->uuid[7],

939 
tu¶e
->
uuid
[8],uple->uuid[9],

940 
tu¶e
->
uuid
[10],uple->uuid[11],

941 
tu¶e
->
uuid
[12],uple->uuid[13],

942 
tu¶e
->
uuid
[14],uple->uuid[15]);

944 
SND_SOC_TPLG_TUPLE_TYPE_STRING
:

945 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s'\n",

946 
tu¶e
->
¡ršg
);

948 
SND_SOC_TPLG_TUPLE_TYPE_BOOL
:

949 
SND_SOC_TPLG_TUPLE_TYPE_BYTE
:

950 
SND_SOC_TPLG_TUPLE_TYPE_SHORT
:

951 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "%u\n", 
tu¶e
->
v®ue
);

953 
SND_SOC_TPLG_TUPLE_TYPE_WORD
:

954 
	`lg_niû_v®ue_fÜm©
(
buf
, (buf), 
tu¶e
->
v®ue
);

955 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "%s\n", 
buf
);

958  -
EINVAL
;

960 ià(
”r
 < 0)

961  
”r
;

963 ià(
£t
->
num_tu¶es
 > 1)

964  
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

966 
	}
}

968 
	$·r£_tu¶e_£ts
(
¢d_cÚfig_t
 *
cfg
,

969 
lg_v’dÜ_tu¶es
 *
tu¶es
)

971 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

972 
¢d_cÚfig_t
 *
n
;

973 cÚ¡ *
id
;

974 
num_tu¶e_£ts
 = 0;

975 
”r
;

977 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

978 ià(
	`¢d_cÚfig_g‘_id
(
cfg
, &
id
) >= 0)

979 
	`SNDERR
("compoundy³ƒx³ùed fÜ %s", 
id
);

980  -
EINVAL
;

983 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

984 
num_tu¶e_£ts
++;

987 ià(!
num_tu¶e_£ts
)

990 
tu¶es
->
£t
 = 
	`ÿÎoc
(1, 
num_tu¶e_£ts
 * (*));

991 ià(!
tu¶es
->
£t
)

992  -
ENOMEM
;

994 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

995 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

996 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

997 
	`SNDERR
("compoundypeƒxpected for %s, is %d",

998 
id
, 
	`¢d_cÚfig_g‘_ty³
(
n
));

999  -
EINVAL
;

1002 
”r
 = 
	`·r£_tu¶e_£t
(
n
, &
tu¶es
->
£t
[tu¶es->
num_£ts
]);

1003 ià(
”r
 < 0)

1004  
”r
;

1007 ià(
tu¶es
->
£t
[tu¶es->
num_£ts
])

1008 
tu¶es
->
num_£ts
++;

1012 
	}
}

1015 
	$lg_§ve_tu¶e_£ts
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

1016 
lg_–em
 *
–em
,

1017 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

1019 
lg_v’dÜ_tu¶es
 *
tu¶es
 = 
–em
->tuples;

1020 
i
;

1021 
”r
 = 0;

1023 
i
 = 0; i < 
tu¶es
->
num_£ts
; i++) {

1024 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "");

1025 ià(
”r
 < 0)

1027 
”r
 = 
	`lg_§ve_tu¶e_£t
(
tu¶es
, 
i
, 
d¡
, 
pfx
);

1028 ià(
”r
 < 0)

1031  
”r
;

1032 
	}
}

1036 
	$lg_·r£_tok’s
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

1037 *
´iv©e
 
ATTRIBUTE_UNUSED
)

1039 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1040 
¢d_cÚfig_t
 *
n
;

1041 cÚ¡ *
id
;

1042 
lg_–em
 *
–em
;

1043 
lg_v’dÜ_tok’s
 *
tok’s
;

1044 
num_tok’s
 = 0, 
v®ue
;

1046 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_TOKEN
);

1047 ià(!
–em
)

1048  -
ENOMEM
;

1050 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1051 
num_tok’s
++;

1054 ià(!
num_tok’s
)

1057 
	`lg_dbg
(" V’dÜok’s: %s, %dok’s", 
–em
->
id
, 
num_tok’s
);

1059 
tok’s
 = 
	`ÿÎoc
(1, (*tokens)

1060 + 
num_tok’s
 * (
lg_tok’
));

1061 ià(!
tok’s
)

1062  -
ENOMEM
;

1063 
–em
->
tok’s
 =okens;

1065 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1067 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1068 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1071 ià(
	`lg_g‘_š‹g”
(
n
, &
v®ue
, 0))

1074 
	`¢d_¡¾ıy
(
tok’s
->
tok’
[tok’s->
num_tok’s
].
id
, id,

1075 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1076 
tok’s
->
tok’
[tok’s->
num_tok’s
].
v®ue
 = value;

1077 
	`lg_dbg
("\t\ˆ% : %d", 
tok’s
->
tok’
[tok’s->
num_tok’s
].
id
,

1078 
tok’s
->
tok’
[tok’s->
num_tok’s
].
v®ue
);

1079 
tok’s
->
num_tok’s
++;

1083 
	}
}

1086 
	$lg_§ve_tok’s
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

1087 
lg_–em
 *
–em
,

1088 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

1090 
lg_v’dÜ_tok’s
 *
tok’s
 = 
–em
->tokens;

1091 
i
;

1092 
”r
;

1094 ià(!
tok’s
 ||ok’s->
num_tok’s
 == 0)

1097 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s' {\n", 
–em
->
id
);

1098 ià(
”r
 < 0)

1099  
”r
;

1100 
i
 = 0; 
”r
 >ğ0 && i < 
tok’s
->
num_tok’s
; i++)

1101 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t'%s' %u\n",

1102 
tok’s
->
tok’
[
i
].
id
,

1103 
tok’s
->
tok’
[
i
].
v®ue
);

1104 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

1105 ià(
”r
 < 0)

1106  
”r
;

1108 
	}
}

1112 
	$lg_·r£_tu¶es
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

1113 *
´iv©e
 
ATTRIBUTE_UNUSED
)

1115 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1116 
¢d_cÚfig_t
 *
n
;

1117 cÚ¡ *
id
, *
v®ue
;

1118 
lg_–em
 *
–em
;

1119 
lg_v’dÜ_tu¶es
 *
tu¶es
;

1120 
”r
;

1122 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_TUPLE
);

1123 ià(!
–em
)

1124  -
ENOMEM
;

1126 
	`lg_dbg
(" V’dÜ Tu¶es: %s", 
–em
->
id
);

1128 
tu¶es
 = 
	`ÿÎoc
(1, (*tuples));

1129 ià(!
tu¶es
)

1130  -
ENOMEM
;

1131 
–em
->
tu¶es
 =uples;

1133 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1135 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1136 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1139 ià(
	`¡rcmp
(
id
, "tokens") == 0) {

1140 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®ue
) < 0)

1141  -
EINVAL
;

1142 
	`lg_»f_add
(
–em
, 
SND_TPLG_TYPE_TOKEN
, 
v®ue
);

1143 
	`lg_dbg
("\ˆ»ã¸tØv’dÜok’s: %s", 
v®ue
);

1146 ià(
	`¡rcmp
(
id
, "tuples") == 0) {

1147 
”r
 = 
	`·r£_tu¶e_£ts
(
n
, 
tu¶es
);

1148 ià(
”r
 < 0)

1149  
”r
;

1154 
	}
}

1157 
	$lg_§ve_tu¶es
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

1158 
lg_–em
 *
–em
,

1159 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

1161 
pfx2
[16];

1162 
”r
;

1164 ià(!
–em
->
tu¶es
)

1167 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s' {\n", 
–em
->
id
);

1168 
	`¢´štf
(
pfx2
, Õfx2), "%s\t", 
pfx
 ?: "");

1169 ià(
”r
 >= 0)

1170 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_TOKEN
,

1171 "tok’s", 
d¡
, 
pfx2
);

1172 ià(
”r
 >= 0)

1173 
”r
 = 
	`lg_§ve_tu¶e_£ts
(
lg
, 
–em
, 
d¡
, 
pfx2
);

1174 ià(
”r
 >= 0)

1175 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

1177 
	}
}

1180 
	$lg_ä“_tu¶es
(*
obj
)

1182 
lg_v’dÜ_tu¶es
 *
tu¶es
 = (lg_v’dÜ_tu¶e *)
obj
;

1183 
i
;

1185 ià(!
tu¶es
 || !tu¶es->
£t
)

1188 
i
 = 0; i < 
tu¶es
->
num_£ts
; i++)

1189 
	`ä“
(
tu¶es
->
£t
[
i
]);

1191 
	`ä“
(
tu¶es
->
£t
);

1192 
	}
}

1196 
	$lg_·r£_mªiã¡_d©a
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

1197 *
´iv©e
 
ATTRIBUTE_UNUSED
)

1199 
¢d_soc_lg_mªiã¡
 *
mªiã¡
;

1200 
lg_–em
 *
–em
;

1201 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1202 
¢d_cÚfig_t
 *
n
;

1203 cÚ¡ *
id
;

1204 
”r
;

1206 ià(!
	`li¡_em±y
(&
lg
->
mªiã¡_li¡
)) {

1207 
	`SNDERR
("already has manifest data");

1208  -
EINVAL
;

1211 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_MANIFEST
);

1212 ià(!
–em
)

1213  -
ENOMEM
;

1215 
mªiã¡
 = 
–em
->manifest;

1216 
mªiã¡
->
size
 = 
–em
->size;

1218 
	`lg_dbg
(" Mªiã¡: %s", 
–em
->
id
);

1220 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1221 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1222 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1226 ià(
	`¡rcmp
(
id
, "comment") == 0)

1228 ià(
id
[0] == '#')

1232 ià(
	`¡rcmp
(
id
, "data") == 0) {

1233 
”r
 = 
	`lg_·r£_»fs
(
n
, 
–em
, 
SND_TPLG_TYPE_DATA
);

1234 ià(
”r
 < 0)

1235  
”r
;

1241 
	}
}

1244 
	$lg_§ve_mªiã¡_d©a
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

1245 
lg_–em
 *
–em
, 
lg_buf
 *
d¡
,

1246 cÚ¡ *
pfx
)

1248 
li¡_h—d
 *
pos
;

1249 
lg_»f
 *
»f
;

1250 
”r
, 
šdex
, 
couÁ
;

1253 
couÁ
 = 0;

1254 
	`li¡_fÜ_—ch
(
pos
, &
–em
->
»f_li¡
) {

1255 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

1256 ià(
»f
->
ty³
 !ğ
SND_TPLG_TYPE_DATA
)

1258 
couÁ
++;

1260 ià(
couÁ
 == 0)

1261  
	`lg_§ve_´štf
(
d¡
, 
NULL
,

1262 "'%s'.comm’ˆ'em±y'\n", 
–em
->
id
);

1263 ià(
couÁ
 > 1) {

1264 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s'.d©¨[\n", 
–em
->
id
);

1265 ià(
”r
 < 0)

1266  
”r
;

1268 
šdex
 = 0;

1269 
	`li¡_fÜ_—ch
(
pos
, &
–em
->
»f_li¡
) {

1270 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

1271 ià(
»f
->
ty³
 !ğ
SND_TPLG_TYPE_DATA
)

1273 ià(
couÁ
 == 1) {

1274 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s'.data.%u '%s'\n",

1275 
–em
->
id
, 
šdex
, 
»f
->id);

1277 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t'%s'\n", 
»f
->
id
);

1279 ià(
”r
 < 0)

1280  
”r
;

1281 
šdex
++;

1283 ià(
couÁ
 > 1) {

1284 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "]\n");

1285 ià(
”r
 < 0)

1286  
”r
;

1289 
	}
}

1292 
	$lg_bud_mªiã¡_d©a
(
¢d_lg_t
 *
lg
)

1294 
li¡_h—d
 *
ba£
, *
pos
;

1295 
lg_–em
 *
–em
 = 
NULL
;

1296 
lg_»f
 *
»f
;

1297 
¢d_soc_lg_mªiã¡
 *
mªiã¡
;

1298 
”r
 = 0;

1300 
ba£
 = &
lg
->
mªiã¡_li¡
;

1301 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

1303 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

1307 ià(!
–em
)

1310 
ba£
 = &
–em
->
»f_li¡
;

1313 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

1315 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

1316 ià(
»f
->
–em
)

1319 ià(
»f
->
ty³
 =ğ
SND_TPLG_TYPE_DATA
) {

1320 
”r
 = 
	`lg_cİy_d©a
(
lg
, 
–em
, 
»f
);

1321 ià(
”r
 < 0)

1322  
”r
;

1326 
mªiã¡
 = 
–em
->manifest;

1327 ià(!
mªiã¡
->
´iv
.
size
)

1330 
lg
->
mªiã¡_pd©a
 = 
	`m®loc
(
mªiã¡
->
´iv
.
size
);

1331 ià(!
lg
->
mªiã¡_pd©a
)

1332  -
ENOMEM
;

1334 
lg
->
mªiã¡
.
´iv
.
size
 = manifest->priv.size;

1335 
	`memıy
(
lg
->
mªiã¡_pd©a
, 
mªiã¡
->
´iv
.
d©a
, mªiã¡->´iv.
size
);

1337 
	}
}

1344 
	$lg_·r£_d©a
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

1345 *
´iv©e
 
ATTRIBUTE_UNUSED
)

1347 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1348 
¢d_cÚfig_t
 *
n
;

1349 cÚ¡ *
id
;

1350 
”r
 = 0, 
iv®
;

1351 
lg_–em
 *
–em
;

1353 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_DATA
);

1354 ià(!
–em
)

1355  -
ENOMEM
;

1357 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1359 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1360 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0) {

1364 ià(
	`¡rcmp
(
id
, "file") == 0) {

1365 
”r
 = 
	`lg_·r£_d©a_fe
(
n
, 
–em
);

1366 ià(
”r
 < 0) {

1367 
	`SNDERR
("failedo…arse data file");

1368  
”r
;

1373 ià(
	`¡rcmp
(
id
, "bytes") == 0) {

1374 
”r
 = 
	`lg_·r£_d©a_hex
(
n
, 
–em
, 1);

1375 ià(
”r
 < 0) {

1376 
	`SNDERR
("failedo…arse data bytes");

1377  
”r
;

1382 ià(
	`¡rcmp
(
id
, "shorts") == 0) {

1383 
”r
 = 
	`lg_·r£_d©a_hex
(
n
, 
–em
, 2);

1384 ià(
”r
 < 0) {

1385 
	`SNDERR
("failedo…arse data shorts");

1386  
”r
;

1391 ià(
	`¡rcmp
(
id
, "words") == 0) {

1392 
”r
 = 
	`lg_·r£_d©a_hex
(
n
, 
–em
, 4);

1393 ià(
”r
 < 0) {

1394 
	`SNDERR
("failedo…arse data words");

1395  
”r
;

1400 ià(
	`¡rcmp
(
id
, "tuples") == 0) {

1401 
”r
 = 
	`lg_·r£_»fs
(
n
, 
–em
, 
SND_TPLG_TYPE_TUPLE
);

1402 ià(
”r
 < 0)

1403  
”r
;

1407 ià(
	`¡rcmp
(
id
, "type") == 0) {

1408 ià(
	`lg_g‘_š‹g”
(
n
, &
iv®
, 0))

1409  -
EINVAL
;

1411 
–em
->
v’dÜ_ty³
 = 
iv®
;

1412 
	`lg_dbg
("\t%s: %d", 
id
, 
–em
->
šdex
);

1417  
”r
;

1418 
	}
}

1421 
	$lg_§ve_d©a
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

1422 
lg_–em
 *
–em
,

1423 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

1425 
¢d_soc_lg_´iv©e
 *
´iv
 = 
–em
->
d©a
;

1426 
li¡_h—d
 *
pos
;

1427 
lg_»f
 *
»f
;

1428 
pfx2
[16];

1429 
i
, 
couÁ
;

1430 
”r
;

1432 
couÁ
 = 0;

1433 ià(
´iv
 &&…riv->
size
 > 0)

1434 
couÁ
++;

1435 
	`li¡_fÜ_—ch
(
pos
, &
–em
->
»f_li¡
) {

1436 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

1437 ià(
»f
->
ty³
 =ğ
SND_TPLG_TYPE_TUPLE
)

1438 
couÁ
++;

1440 ià(
–em
->
v’dÜ_ty³
 > 0)

1441 
couÁ
++;

1443 ià(
couÁ
 > 1) {

1444 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s' {\n", 
–em
->
id
);

1445 ià(
”r
 >= 0)

1446 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "");

1448 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s'.", 
–em
->
id
);

1450 ià(
”r
 >ğ0 && 
´iv
 &&…riv->
size
 > 0) {

1451 ià(
couÁ
 > 1) {

1452 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "");

1453 ià(
”r
 < 0)

1454  
”r
;

1456 ià(
´iv
->
size
 > 8) {

1457 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "bytes\n");

1458 ià(
”r
 >= 0)

1459 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t'");

1461 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "bytes '");

1463 ià(
”r
 < 0)

1464  
”r
;

1465 
i
 = 0; i < 
´iv
->
size
; i++) {

1466 ià(
i
 > 0 && (i % 8) == 0) {

1467 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, ":\n");

1468 ià(
”r
 < 0)

1469  
”r
;

1470 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t ");

1471 ià(
”r
 < 0)

1472  
”r
;

1474 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "%s%02x",

1475 (
i
 % 8) == 0 ? "" : ":",

1476 ()
´iv
->
d©a
[
i
]);

1477 ià(
”r
 < 0)

1478  
”r
;

1480 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'\n");

1482 
	`¢´štf
(
pfx2
, Õfx2), "%s\t", 
pfx
 ?: "");

1483 ià(
”r
 >= 0)

1484 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_TUPLE
,

1485 "tu¶es", 
d¡
,

1486 
couÁ
 > 1 ? 
pfx2
 : 
NULL
);

1487 ià(
”r
 >ğ0 && 
–em
->
v’dÜ_ty³
 > 0)

1488 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "type %u",

1489 
–em
->
v’dÜ_ty³
);

1490 ià(
”r
 >ğ0 && 
couÁ
 > 1)

1491 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

1492  
”r
;

1493 
	}
}

1500 
	$lg_cİy_d©a
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

1501 
lg_»f
 *
»f
)

1503 
lg_–em
 *
»f_–em
;

1504 
¢d_soc_lg_´iv©e
 *
´iv
, *
Şd_´iv
;

1505 
´iv_d©a_size
, 
Şd_´iv_d©a_size
;

1506 *
obj
;

1508 
»f_–em
 = 
	`lg_–em_lookup
(&
lg
->
pd©a_li¡
,

1509 
»f
->
id
, 
SND_TPLG_TYPE_DATA
, 
–em
->
šdex
);

1510 ià(!
»f_–em
) {

1511 
	`SNDERR
("cannot find data '%s'„eferenced by"

1512 "ƒËm’ˆ'%s'", 
»f
->
id
, 
–em
->id);

1513  -
EINVAL
;

1516 
	`lg_dbg
("D©¨'%s' u£d by '%s'", 
»f
->
id
, 
–em
->id);

1518 ià(!
»f_–em
->
d©a
 || !»f_–em->d©a->
size
) {

1519 
»f
->
–em
 = 
»f_–em
;

1523 
Şd_´iv
 = 
	`g‘_´iv_d©a
(
–em
);

1524 ià(!
Şd_´iv
)

1525  -
EINVAL
;

1526 
Şd_´iv_d©a_size
 = 
Şd_´iv
->
size
;

1528 
´iv_d©a_size
 = 
»f_–em
->
d©a
->
size
;

1529 
obj
 = 
	`»®loc
(
–em
->obj,

1530 
–em
->
size
 + 
´iv_d©a_size
);

1531 ià(!
obj
)

1532  -
ENOMEM
;

1533 
–em
->
obj
 = obj;

1535 
´iv
 = 
	`g‘_´iv_d©a
(
–em
);

1536 ià(!
´iv
)

1537  -
EINVAL
;

1540 
–em
->
size
 +ğ
´iv_d©a_size
;

1541 
´iv
->
size
 = 
´iv_d©a_size
 + 
Şd_´iv_d©a_size
;

1542 
»f_–em
->
compound_–em
 = 1;

1543 
	`memıy
(
´iv
->
d©a
 + 
Şd_´iv_d©a_size
,

1544 
»f_–em
->
d©a
->d©a, 
´iv_d©a_size
);

1546 
»f
->
–em
 = 
»f_–em
;

1548 
	}
}

1551 
	$lg_bud_d©a
(
¢d_lg_t
 *
lg
)

1553 
li¡_h—d
 *
ba£
, *
pos
;

1554 
lg_–em
 *
–em
;

1555 
”r
 = 0;

1557 
ba£
 = &
lg
->
pd©a_li¡
;

1558 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

1560 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

1561 ià(
	`has_tu¶es
(
–em
)) {

1562 
”r
 = 
	`bud_tu¶es
(
lg
, 
–em
);

1563 ià(
”r
 < 0)

1564  
”r
;

1569 
	}
}

1572 
	$lg_decode_mªiã¡_d©a
(
¢d_lg_t
 *
lg
,

1573 
size_t
 
pos
,

1574 
¢d_soc_lg_hdr
 *
hdr
,

1575 *
bš
, 
size_t
 
size
)

1577 
¢d_soc_lg_mªiã¡
 *
m
 = 
bš
;

1578 
lg_–em
 *
–em
;

1579 
size_t
 
off
;

1581 ià(
hdr
->
šdex
 != 0) {

1582 
	`SNDERR
("mªiã¡ - wrÚg index %d", 
hdr
->
šdex
);

1583  -
EINVAL
;

1586 ià((*
m
è> 
size
) {

1587 
	`SNDERR
("manifest - wrong size %zd (minimal %zd)",

1588 
size
, (*
m
));

1589  -
EINVAL
;

1592 ià(
m
->
size
 != (*m)) {

1593 
	`SNDERR
("mªiã¡ - wrÚg sruùu» siz%d", 
m
->
size
);

1594  -
EINVAL
;

1597 
off
 = 
	`off£tof
(
¢d_soc_lg_mªiã¡
, 
´iv
);

1598 ià(
off
 + 
m
->
´iv
.
size
 > size) {

1599 
	`SNDERR
("mªiã¡ - wrÚg…riv©siz%d", 
m
->
´iv
.
size
);

1600  -
EINVAL
;

1603 
lg
->
mªiã¡
 = *
m
;

1605 
bš
 +ğ
off
;

1606 
size
 -ğ
off
;

1607 
pos
 +ğ
off
;

1609 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
, "manifest",

1610 
SND_TPLG_TYPE_MANIFEST
);

1611 ià(!
–em
)

1612  -
ENOMEM
;

1614 
	`lg_log
(
lg
, 'D', 
pos
, "mªiã¡:…riv©siz%zd", 
size
);

1615  
	`lg_add_d©a
(
lg
, 
–em
, 
bš
, 
size
);

1616 
	}
}

1618 
	$lg_add_tok’
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
·»Á
,

1619 
tok’
,

1620 
¡r_»f
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
])

1622 
lg_–em
 *
–em
;

1623 
lg_tok’
 *
t
;

1624 
lg_v’dÜ_tok’s
 *
tok’s
;

1625 
i
;

1626 
size_t
 
size
;

1628 
–em
 = 
	`lg_–em_lookup
(&
lg
->
tok’_li¡
, 
·»Á
->
id
,

1629 
SND_TPLG_TYPE_TOKEN
, 
·»Á
->
šdex
);

1630 ià(
–em
 =ğ
NULL
) {

1631 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
, 
·»Á
->
id
,

1632 
SND_TPLG_TYPE_TOKEN
);

1633 ià(!
–em
)

1634  -
ENOMEM
;

1637 
tok’s
 = 
–em
->tokens;

1638 ià(
tok’s
) {

1639 
i
 = 0; i < 
tok’s
->
num_tok’s
; i++) {

1640 
t
 = &
tok’s
->
tok’
[
i
];

1641 ià(
t
->
v®ue
 =ğ
tok’
)

1642 
found
;

1644 
size
 = (*
tok’s
) +

1645 (
tok’s
->
num_tok’s
 + 1è* (
lg_tok’
);

1646 
tok’s
 = 
	`»®loc
Ñok’s, 
size
);

1648 
size
 = (*
tok’s
è+ 1 * (
lg_tok’
);

1649 
tok’s
 = 
	`ÿÎoc
(1, 
size
);

1652 ià(!
tok’s
)

1653  -
ENOMEM
;

1655 
	`mem£t
(&
tok’s
->
tok’
[tok’s->
num_tok’s
], 0, (
lg_tok’
));

1656 
–em
->
tok’s
 =okens;

1657 
t
 = &
tok’s
->
tok’
[tok’s->
num_tok’s
];

1658 
tok’s
->
num_tok’s
++;

1659 
	`¢´štf
(
t
->
id
, Ñ->id), "tok’%u", 
tok’
);

1660 
t
->
v®ue
 = 
tok’
;

1661 
found
:

1662 
	`¢d_¡¾ıy
(
¡r_»f
, 
t
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1664 
	}
}

1666 
	$lg_v”ify_tu¶e_£t
(
¢d_lg_t
 *
lg
, 
size_t
 
pos
,

1667 cÚ¡ *
bš
, 
size_t
 
size
)

1669 cÚ¡ 
¢d_soc_lg_v’dÜ_¬¿y
 *
va
;

1670 
j
;

1672 
va
 = 
bš
;

1673 ià(
size
 < (*
va
) || size < va->size) {

1674 
	`lg_log
(
lg
, 'A', 
pos
, "tu¶£ˆv”ify: wrÚg siz%zd", 
size
);

1675  -
EINVAL
;

1678 
va
->
ty³
) {

1679 
SND_SOC_TPLG_TUPLE_TYPE_UUID
:

1680 
SND_SOC_TPLG_TUPLE_TYPE_STRING
:

1681 
SND_SOC_TPLG_TUPLE_TYPE_BOOL
:

1682 
SND_SOC_TPLG_TUPLE_TYPE_BYTE
:

1683 
SND_SOC_TPLG_TUPLE_TYPE_WORD
:

1684 
SND_SOC_TPLG_TUPLE_TYPE_SHORT
:

1687 
	`lg_log
(
lg
, 'A', 
pos
, "tu¶£ˆv”ify: unknowÀ¬¿yy³ %d", 
va
->
ty³
);

1688  -
EINVAL
;

1691 
j
 = 
	`lg_g‘_tu¶e_size
(
va
->
ty³
è* va->
num_–ems
;

1692 ià(
j
 + (*
va
è!ğva->
size
) {

1693 
	`lg_log
(
lg
, 'A', 
pos
, "tuple set verify: wrong vendor‡rray size %d "

1695 
va
->
size
, 
j
 + (*va), va->
ty³
, va->
num_–ems
);

1696  -
EINVAL
;

1699 ià(
va
->
num_–ems
 > 4096) {

1700 
	`lg_log
(
lg
, 'A', 
pos
, "tu¶£ˆv”ify:u¶e ov”æow %d", 
va
->
num_–ems
);

1701  -
EINVAL
;

1705 
	}
}

1707 
	$lg_decode_tu¶e_£t
(
¢d_lg_t
 *
lg
,

1708 
size_t
 
pos
,

1709 
lg_–em
 *
·»Á
,

1710 
lg_tu¶e_£t
 **
_£t
,

1711 cÚ¡ *
bš
, 
size_t
 
size
)

1713 cÚ¡ 
¢d_soc_lg_v’dÜ_¬¿y
 *
va
;

1714 
lg_tu¶e_£t
 *
£t
;

1715 
lg_tu¶e
 *
tu¶e
;

1716 
j
;

1717 
”r
;

1719 
va
 = 
bš
;

1720 ià(
size
 < (*
va
) || size < va->size) {

1721 
	`SNDERR
("tu¶es: wrÚg siz%zd", 
size
);

1722  -
EINVAL
;

1725 
va
->
ty³
) {

1726 
SND_SOC_TPLG_TUPLE_TYPE_UUID
:

1727 
SND_SOC_TPLG_TUPLE_TYPE_STRING
:

1728 
SND_SOC_TPLG_TUPLE_TYPE_BOOL
:

1729 
SND_SOC_TPLG_TUPLE_TYPE_BYTE
:

1730 
SND_SOC_TPLG_TUPLE_TYPE_WORD
:

1731 
SND_SOC_TPLG_TUPLE_TYPE_SHORT
:

1734 
	`SNDERR
("tu¶es: unknowÀ¬¿yy³ %d", 
va
->
ty³
);

1735  -
EINVAL
;

1738 
j
 = 
	`lg_g‘_tu¶e_size
(
va
->
ty³
è* va->
num_–ems
;

1739 ià(
j
 + (*
va
è!ğva->
size
) {

1740 
	`SNDERR
("tuples: wrong vendor‡rray size %d "

1742 
va
->
size
, 
j
 + (*va), va->
ty³
, va->
num_–ems
);

1743  -
EINVAL
;

1746 ià(
va
->
num_–ems
 > 4096) {

1747 
	`SNDERR
("tu¶es:u¶e ov”æow %d", 
va
->
num_–ems
);

1748  -
EINVAL
;

1751 
£t
 = 
	`ÿÎoc
(1, (*£tè+ 
va
->
num_–ems
 * (
lg_tu¶e
));

1752 ià(!
£t
)

1753  -
ENOMEM
;

1755 
£t
->
ty³
 = 
va
->type;

1756 
£t
->
num_tu¶es
 = 
va
->
num_–ems
;

1758 
	`lg_log
(
lg
, 'A', 
pos
, "tu¶£t:y³ %d (%sètu¶e %d siz%d", 
£t
->
ty³
,

1759 
	`g‘_tu¶e_ty³_Çme
(
£t
->
ty³
), s‘->
num_tu¶es
, 
va
->
size
);

1760 
j
 = 0; j < 
£t
->
num_tu¶es
; j++) {

1761 
tu¶e
 = &
£t
->tu¶e[
j
];

1762 
va
->
ty³
) {

1763 
SND_SOC_TPLG_TUPLE_TYPE_UUID
:

1764 
”r
 = 
	`lg_add_tok’
(
lg
, 
·»Á
, 
va
->
uuid
[
j
].
tok’
,

1765 
tu¶e
->
tok’
);

1766 ià(
”r
 < 0)

1767 
»tv®
;

1768 
	`memıy
(
tu¶e
->
uuid
, 
va
->uuid[
j
].uuid,

1769 (
va
->
uuid
[
j
].uuid));

1771 
SND_SOC_TPLG_TUPLE_TYPE_STRING
:

1772 
”r
 = 
	`lg_add_tok’
(
lg
, 
·»Á
, 
va
->
¡ršg
[
j
].
tok’
,

1773 
tu¶e
->
tok’
);

1774 ià(
”r
 < 0)

1775 
»tv®
;

1776 
	`¢d_¡¾ıy
(
tu¶e
->
¡ršg
, 
va
->¡ršg[
j
].string,

1777 (
tu¶e
->
¡ršg
));

1779 
SND_SOC_TPLG_TUPLE_TYPE_BOOL
:

1780 
SND_SOC_TPLG_TUPLE_TYPE_BYTE
:

1781 
SND_SOC_TPLG_TUPLE_TYPE_WORD
:

1782 
SND_SOC_TPLG_TUPLE_TYPE_SHORT
:

1783 
”r
 = 
	`lg_add_tok’
(
lg
, 
·»Á
, 
va
->
v®ue
[
j
].
tok’
,

1784 
tu¶e
->
tok’
);

1785 ià(
”r
 < 0)

1786 
»tv®
;

1787 
tu¶e
->
v®ue
 = 
va
->v®ue[
j
].value;

1792 *
_£t
 = 
£t
;

1795 
»tv®
:

1796 
	`ä“
(
£t
);

1797  
”r
;

1798 
	}
}

1801 
	$lg_v”ify_tu¶es
(
¢d_lg_t
 *
lg
, 
size_t
 
pos
,

1802 cÚ¡ *
bš
, 
size_t
 
size
)

1804 cÚ¡ 
¢d_soc_lg_v’dÜ_¬¿y
 *
va
;

1805 
”r
;

1807 ià(
size
 < (*
va
)) {

1808 
	`lg_log
(
lg
, 'A', 
pos
, "tu¶es: sm®Èsiz%zd", 
size
);

1809  -
EINVAL
;

1812 
Ãxt
:

1813 
va
 = 
bš
;

1814 ià(
size
 < (*
va
)) {

1815 
	`lg_log
(
lg
, 'A', 
pos
, "tu¶es: uÃx³ùed v’dÜ‡¼y siz%zd", 
size
);

1816  -
EINVAL
;

1819 
”r
 = 
	`lg_v”ify_tu¶e_£t
(
lg
, 
pos
, 
va
, va->
size
);

1820 ià(
”r
 < 0)

1821  
”r
;

1823 
bš
 +ğ
va
->
size
;

1824 
size
 -ğ
va
->size;

1825 
pos
 +ğ
va
->
size
;

1826 ià(
size
 > 0)

1827 
Ãxt
;

1830 
	}
}

1833 
	$lg_decode_tu¶es
(
¢d_lg_t
 *
lg
,

1834 
size_t
 
pos
,

1835 
lg_–em
 *
·»Á
,

1836 
lg_v’dÜ_tu¶es
 *
tu¶es
,

1837 cÚ¡ *
bš
, 
size_t
 
size
)

1839 cÚ¡ 
¢d_soc_lg_v’dÜ_¬¿y
 *
va
;

1840 
lg_tu¶e_£t
 *
£t
;

1841 
”r
;

1843 ià(
size
 < (*
va
)) {

1844 
	`SNDERR
("tu¶es: sm®Èsiz%zd", 
size
);

1845  -
EINVAL
;

1848 
Ãxt
:

1849 
va
 = 
bš
;

1850 ià(
size
 < (*
va
)) {

1851 
	`SNDERR
("tu¶es: uÃx³ùed v’dÜ‡¼y siz%zd", 
size
);

1852  -
EINVAL
;

1855 ià(
tu¶es
->
num_£ts
 >ğtu¶es->
®loc_£ts
) {

1856 
	`SNDERR
("tu¶es: index ov”æow (%d)", 
tu¶es
->
num_£ts
);

1857  -
EINVAL
;

1860 
”r
 = 
	`lg_decode_tu¶e_£t
(
lg
, 
pos
, 
·»Á
, &
£t
, 
va
, va->
size
);

1861 ià(
”r
 < 0)

1862  
”r
;

1863 
tu¶es
->
£t
[tu¶es->
num_£ts
++] = set;

1865 
bš
 +ğ
va
->
size
;

1866 
size
 -ğ
va
->size;

1867 
pos
 +ğ
va
->
size
;

1868 ià(
size
 > 0)

1869 
Ãxt
;

1872 
	}
}

1875 
	$lg_add_d©a
(
¢d_lg_t
 *
lg
,

1876 
lg_–em
 *
·»Á
,

1877 cÚ¡ *
bš
, 
size_t
 
size
)

1879 cÚ¡ 
¢d_soc_lg_´iv©e
 *

;

1880 cÚ¡ 
¢d_soc_lg_v’dÜ_¬¿y
 *
va
;

1881 
lg_–em
 *
–em
 = 
NULL
, *
–em2
 = NULL;

1882 
lg_v’dÜ_tu¶es
 *
tu¶es
 = 
NULL
;

1883 
id
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

1884 
suffix
[16];

1885 
size_t
 
pos
 = 0, 
off
;

1886 
”r
, 
num_tu¶es
 = 0, 
block
 = 0;

1888 ià(
size
 == 0)

1891 
off
 = 
	`off£tof
(
¢d_soc_lg_´iv©e
, 
¬¿y
);

1893 
Ãxt
:

1894 

 = 
bš
;

1895 ià(
off
 + 
size
 < 

->size) {

1896 
	`SNDERR
("d©a: uÃx³ùedƒËm’ˆsiz%zd", 
size
);

1897  -
EINVAL
;

1900 ià(
	`lg_v”ify_tu¶es
(
lg
, 
pos
, 

->
¬¿y
,p->
size
) < 0) {

1901 ià(
tu¶es
) {

1902 
”r
 = 
	`lg_»f_add
(
–em
, 
SND_TPLG_TYPE_TOKEN
, 
·»Á
->
id
);

1903 ià(
”r
 < 0)

1904  
”r
;

1905 
”r
 = 
	`lg_»f_add
(
–em2
, 
SND_TPLG_TYPE_TUPLE
, 
id
);

1906 ià(
”r
 < 0)

1907  
”r
;

1908 
”r
 = 
	`lg_»f_add
(
·»Á
, 
SND_TPLG_TYPE_DATA
, 
id
);

1909 ià(
”r
 < 0)

1910  
”r
;

1911 
tu¶es
 = 
NULL
;

1913 
	`lg_log
(
lg
, 'A', 
pos
, "add by‹s: siz%d", 

->
size
);

1914 
	`¢´štf
(
suffix
, (suffix), "d©a%u", 
block
++);

1915 
”r
 = 
	`lg_add_d©a_by‹s
(
lg
, 
·»Á
, 
suffix
, 

->
¬¿y
,p->
size
);

1917 ià(!
tu¶es
) {

1918 
	`¢´štf
(
id
, (id), "%.30s:tu¶e%d", 
·»Á
->id, (
block
++) & 0xffff);

1919 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
, 
id
, 
SND_TPLG_TYPE_TUPLE
);

1920 ià(!
–em
)

1921  -
ENOMEM
;

1923 
–em2
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
, 
id
, 
SND_TPLG_TYPE_DATA
);

1924 ià(!
–em2
)

1925  -
ENOMEM
;

1927 
tu¶es
 = 
	`ÿÎoc
(1, (*tuples));

1928 ià(!
tu¶es
)

1929  -
ENOMEM
;

1930 
–em
->
tu¶es
 =uples;

1932 
tu¶es
->
®loc_£ts
 = (
size
 / (*
va
)) + 1;

1933 
tu¶es
->
£t
 = 
	`ÿÎoc
(1,u¶es->
®loc_£ts
 * (*));

1934 ià(!
tu¶es
->
£t
) {

1935 
tu¶es
->
®loc_£ts
 = 0;

1936  -
ENOMEM
;

1939 
	`lg_log
(
lg
, 'A', 
pos
, "decodtu¶es: siz%d", 

->
size
);

1940 
”r
 = 
	`lg_decode_tu¶es
(
lg
, 
pos
, 
·»Á
, 
tu¶es
, 

->
¬¿y
,p->
size
);

1941 
num_tu¶es
++;

1943 ià(
”r
 < 0)

1944  
”r
;

1946 
bš
 +ğ
off
 + 

->
size
;

1947 
size
 -ğ
off
 + 

->size;

1948 
pos
 +ğ
off
 + 

->
size
;

1949 ià(
size
 > 0)

1950 
Ãxt
;

1952 ià(
tu¶es
 && 
–em
 && 
–em2
) {

1953 
”r
 = 
	`lg_»f_add
(
–em
, 
SND_TPLG_TYPE_TOKEN
, 
·»Á
->
id
);

1954 ià(
”r
 < 0)

1955  
”r
;

1956 
”r
 = 
	`lg_»f_add
(
–em2
, 
SND_TPLG_TYPE_TUPLE
, 
id
);

1957 ià(
”r
 < 0)

1958  
”r
;

1959 
”r
 = 
	`lg_»f_add
(
·»Á
, 
SND_TPLG_TYPE_DATA
, 
id
);

1960 ià(
”r
 < 0)

1961  
”r
;

1965 
	}
}

1968 
	$lg_add_d©a_by‹s
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
·»Á
,

1969 cÚ¡ *
suffix
, cÚ¡ *
bš
, 
size_t
 
size
)

1971 
¢d_soc_lg_´iv©e
 *
´iv
;

1972 
lg_–em
 *
–em
;

1973 
id
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

1975 ià(
suffix
)

1976 
	`¢´štf
(
id
, (id), "%.30s:%.12s", 
·»Á
->id, 
suffix
);

1978 
	`¢d_¡¾ıy
(
id
, 
·»Á
->id, (id));

1979 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
, 
id
, 
SND_TPLG_TYPE_DATA
);

1980 ià(!
–em
)

1981  -
ENOMEM
;

1983 
´iv
 = 
	`m®loc
((*´ivè+ 
size
);

1984 ià(!
´iv
)

1985  -
ENOMEM
;

1986 
	`memıy
(
´iv
->
d©a
, 
bš
, 
size
);

1987 
´iv
->
size
 = size;

1988 
–em
->
d©a
 = 
´iv
;

1990  
	`lg_»f_add
(
·»Á
, 
SND_TPLG_TYPE_DATA
, 
id
);

1991 
	}
}

1994 
	$lg_decode_d©a
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

1995 
size_t
 
pos
 
ATTRIBUTE_UNUSED
,

1996 
¢d_soc_lg_hdr
 *
hdr
 
ATTRIBUTE_UNUSED
,

1997 *
bš
 
ATTRIBUTE_UNUSED
,

1998 
size_t
 
size
 
ATTRIBUTE_UNUSED
)

2000 
	`SNDERR
("dataype‚otƒxpected");

2001  -
EINVAL
;

2002 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/decoder.c

18 
	~"lg_loÿl.h
"

20 
	$lg_decode_‹m¶©e
(
¢d_lg_t
 *
lg
,

21 
size_t
 
pos
,

22 
¢d_soc_lg_hdr
 *
hdr
,

23 
¢d_lg_obj_‹m¶©e_t
 *
t
)

25 
ty³
;

27 
ty³
 = 
	`lg_g‘_ty³
(
hdr
->type);

28 
	`lg_log
(
lg
, 'D', 
pos
, "template:‡socype %d†ibraryype %d",

29 
hdr
->
ty³
,ype);

30 ià(
ty³
 < 0)

31  
ty³
;

33 
	`mem£t
(
t
, 0, (*t));

34 
t
->
ty³
 =ype;

35 
t
->
šdex
 = 
hdr
->index;

36 
t
->
v”siÚ
 = 
hdr
->version;

37 
t
->
v’dÜ_ty³
 = 
hdr
->vendor_type;

38 
	`lg_log
(
lg
, 'D', 
pos
, "template: index %d version %d vendor_type %d",

39 
hdr
->
šdex
, hdr->
v”siÚ
, hdr->
v’dÜ_ty³
);

41 
	}
}

43 
	$¢d_lg_decode
(
¢d_lg_t
 *
lg
, *
bš
, 
size_t
 
size
, 
dæags
)

45 
¢d_soc_lg_hdr
 *
hdr
;

46 
lg_bË
 *
Œ
;

47 
size_t
 
pos
;

48 *
b
 = 
bš
;

49 
šdex
;

50 
”r
;

52 ià(
dæags
 != 0)

53  -
EINVAL
;

54 ià(
lg
 =ğ
NULL
 || 
bš
 == NULL)

55  -
EINVAL
;

57 
pos
 = 
b
 - 
bš
;

58 ià(
size
 =ğ
pos
) {

59 
	`lg_log
(
lg
, 'D', 
pos
, "block: sucûs ÑÙ® %zd)", 
size
);

62 ià(
size
 - 
pos
 < (*
hdr
)) {

63 
	`lg_log
(
lg
, 'D', 
pos
, "block: small size");

64 
	`SNDERR
("incomplete header datao decode");

65  -
EINVAL
;

67 
hdr
 = 
b
;

68 ià(
hdr
->
magic
 !ğ
SND_SOC_TPLG_MAGIC
) {

69 
	`SNDERR
("bad block magiø%08x", 
hdr
->
magic
);

70  -
EINVAL
;

73 
	`lg_log
(
lg
, 'D', 
pos
, "block:‡bi %d size %d…ayload size %d",

74 
hdr
->
abi
, hdr->
size
, hdr->
·ylßd_size
);

75 ià(
hdr
->
abi
 !ğ
SND_SOC_TPLG_ABI_VERSION
) {

76 
	`SNDERR
("unsuµÜ‹d ABI v”siÚ %d", 
hdr
->
abi
);

77  -
EINVAL
;

79 ià(
hdr
->
size
 != (*hdr)) {

80 
	`SNDERR
("header size mismatch");

81  -
EINVAL
;

84 ià(
size
 - 
pos
 < 
hdr
->siz+ hdr->
·ylßd_size
) {

85 
	`SNDERR
("incomplete…ayload datao decode");

86  -
EINVAL
;

89 ià(
hdr
->
·ylßd_size
 < 8) {

90 
	`SNDERR
("wrÚg…aylßd siz%d", 
hdr
->
·ylßd_size
);

91  -
EINVAL
;

95 ià(
b
 =ğ
bš
) {

96 ià(
hdr
->
ty³
 !ğ
SND_SOC_TPLG_TYPE_MANIFEST
) {

97 
	`SNDERR
("fœ¡ block mu¡ bmªiã¡ (v®u%d)", 
hdr
->
ty³
);

98  -
EINVAL
;

100 
”r
 = 
	`¢d_lg_£t_v”siÚ
(
lg
, 
hdr
->
v”siÚ
);

101 ià(
”r
 < 0)

102  
”r
;

105 
pos
 +ğ
hdr
->
size
;

106 
šdex
 = 0; index < 
lg_bË_™ems
; index++) {

107 
Œ
 = &
lg_bË
[
šdex
];

108 ià(
Œ
->
tsoc
 =ğ()
hdr
->
ty³
)

111 ià(
šdex
 >ğ
lg_bË_™ems
 || 
Œ
->
decod
 =ğ
NULL
) {

112 
	`SNDERR
("unknowÀblocky³ %d", 
hdr
->
ty³
);

113  -
EINVAL
;

115 
	`lg_log
(
lg
, 'D', 
pos
, "block:y³ %d - %s", 
hdr
->
ty³
, 
Œ
->
Çme
);

116 
”r
 = 
Œ
->
	`decod
(
lg
, 
pos
, 
hdr
, 
b
 + hdr->
size
, hdr->
·ylßd_size
);

117 ià(
”r
 < 0)

118  
”r
;

119 
b
 +ğ
hdr
->
size
 + hdr->
·ylßd_size
;

121 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/elem.c

20 
	~"lg_loÿl.h
"

22 
lg_bË
 
	glg_bË
[] = {

24 .
Çme
 = "manifest",

25 .
	gid
 = "SectionManifest",

26 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
mªiã¡_li¡
),

27 .
	gty³
 = 
SND_TPLG_TYPE_MANIFEST
,

28 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_MANIFEST
,

29 .
	gsize
 = (
¢d_soc_lg_mªiã¡
),

30 .
	g’ew
 = 1,

31 .
	g·r£
 = 
lg_·r£_mªiã¡_d©a
,

32 .
	g§ve
 = 
lg_§ve_mªiã¡_d©a
,

33 .
	gdecod
 = 
lg_decode_mªiã¡_d©a
,

36 .
	gÇme
 = "control mixer",

37 .
	gid
 = "SectionControlMixer",

38 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
mix”_li¡
),

39 .
	gty³
 = 
SND_TPLG_TYPE_MIXER
,

40 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_MIXER
,

41 .
	gsize
 = (
¢d_soc_lg_mix”_cÚŒŞ
),

42 .
	gbud
 = 1,

43 .
	g’ew
 = 1,

44 .
	g·r£
 = 
lg_·r£_cÚŒŞ_mix”
,

45 .
	g§ve
 = 
lg_§ve_cÚŒŞ_mix”
,

46 .
	gdecod
 = 
lg_decode_cÚŒŞ_mix”
,

49 .
	gÇme
 = "controlƒnum",

50 .
	gid
 = "SectionControlEnum",

51 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
’um_li¡
),

52 .
	gty³
 = 
SND_TPLG_TYPE_ENUM
,

53 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_ENUM
,

54 .
	gsize
 = (
¢d_soc_lg_’um_cÚŒŞ
),

55 .
	gbud
 = 1,

56 .
	g’ew
 = 1,

57 .
	g·r£
 = 
lg_·r£_cÚŒŞ_’um
,

58 .
	g§ve
 = 
lg_§ve_cÚŒŞ_’um
,

59 .
	gdecod
 = 
lg_decode_cÚŒŞ_’um
,

62 .
	gÇme
 = "controlƒxtended (bytes)",

63 .
	gid
 = "SectionControlBytes",

64 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
by‹s_ext_li¡
),

65 .
	gty³
 = 
SND_TPLG_TYPE_BYTES
,

66 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_BYTES
,

67 .
	gsize
 = (
¢d_soc_lg_by‹s_cÚŒŞ
),

68 .
	gbud
 = 1,

69 .
	g’ew
 = 1,

70 .
	g·r£
 = 
lg_·r£_cÚŒŞ_by‹s
,

71 .
	g§ve
 = 
lg_§ve_cÚŒŞ_by‹s
,

72 .
	gdecod
 = 
lg_decode_cÚŒŞ_by‹s
,

75 .
	gÇme
 = "dapm widget",

76 .
	gid
 = "SectionWidget",

77 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
widg‘_li¡
),

78 .
	gty³
 = 
SND_TPLG_TYPE_DAPM_WIDGET
,

79 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_DAPM_WIDGET
,

80 .
	gsize
 = (
¢d_soc_lg_d­m_widg‘
),

81 .
	gbud
 = 1,

82 .
	g’ew
 = 1,

83 .
	g·r£
 = 
lg_·r£_d­m_widg‘
,

84 .
	g§ve
 = 
lg_§ve_d­m_widg‘
,

85 .
	gdecod
 = 
lg_decode_d­m_widg‘
,

88 .
	gÇme
 = "pcm",

89 .
	gid
 = "SectionPCM",

90 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
pcm_li¡
),

91 .
	gty³
 = 
SND_TPLG_TYPE_PCM
,

92 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_PCM
,

93 .
	gsize
 = (
¢d_soc_lg_pcm
),

94 .
	gbud
 = 1,

95 .
	g’ew
 = 1,

96 .
	g·r£
 = 
lg_·r£_pcm
,

97 .
	g§ve
 = 
lg_§ve_pcm
,

98 .
	gdecod
 = 
lg_decode_pcm
,

101 .
	gÇme
 = "physical dai",

102 .
	gid
 = "SectionDAI",

103 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
dai_li¡
),

104 .
	gty³
 = 
SND_TPLG_TYPE_DAI
,

105 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_DAI
,

106 .
	gsize
 = (
¢d_soc_lg_dai
),

107 .
	gbud
 = 1,

108 .
	g’ew
 = 1,

109 .
	g·r£
 = 
lg_·r£_dai
,

110 .
	g§ve
 = 
lg_§ve_dai
,

111 .
	gdecod
 = 
lg_decode_dai
,

114 .
	gÇme
 = "be",

115 .
	gid
 = "SectionBE",

116 .
	gid2
 = "SectionLink",

117 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
be_li¡
),

118 .
	gty³
 = 
SND_TPLG_TYPE_BE
,

119 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_BACKEND_LINK
,

120 .
	gsize
 = (
¢d_soc_lg_lšk_cÚfig
),

121 .
	gbud
 = 1,

122 .
	g’ew
 = 1,

123 .
	g·r£
 = 
lg_·r£_lšk
,

124 .
	g§ve
 = 
lg_§ve_lšk
,

125 .
	gdecod
 = 
lg_decode_lšk
,

128 .
	gÇme
 = "cc",

129 .
	gid
 = "SectionCC",

130 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
cc_li¡
),

131 .
	gty³
 = 
SND_TPLG_TYPE_CC
,

132 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_CODEC_LINK
,

133 .
	gsize
 = (
¢d_soc_lg_lšk_cÚfig
),

134 .
	gbud
 = 1,

135 .
	g’ew
 = 1,

136 .
	g·r£
 = 
lg_·r£_cc
,

137 .
	g§ve
 = 
lg_§ve_cc
,

138 .
	gdecod
 = 
lg_decode_cc
,

141 .
	gÇme
 = "route (dapm graph)",

142 .
	gid
 = "SectionGraph",

143 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
rou‹_li¡
),

144 .
	gty³
 = 
SND_TPLG_TYPE_DAPM_GRAPH
,

145 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_DAPM_GRAPH
,

146 .
	gbud
 = 1,

147 .
	g·r£
 = 
lg_·r£_d­m_g¿ph
,

148 .
	gg§ve
 = 
lg_§ve_d­m_g¿ph
,

149 .
	gdecod
 = 
lg_decode_d­m_g¿ph
,

152 .
	gÇme
 = "private data",

153 .
	gid
 = "SectionData",

154 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
pd©a_li¡
),

155 .
	gty³
 = 
SND_TPLG_TYPE_DATA
,

156 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_PDATA
,

157 .
	gbud
 = 1,

158 .
	g’ew
 = 1,

159 .
	g·r£
 = 
lg_·r£_d©a
,

160 .
	g§ve
 = 
lg_§ve_d©a
,

161 .
	gdecod
 = 
lg_decode_d©a
,

164 .
	gÇme
 = "text",

165 .
	gid
 = "SectionText",

166 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
‹xt_li¡
),

167 .
	gty³
 = 
SND_TPLG_TYPE_TEXT
,

168 .
	gsize
 = (
lg_‹xts
),

169 .
	g’ew
 = 1,

170 .
	g·r£
 = 
lg_·r£_‹xt
,

171 .
	g§ve
 = 
lg_§ve_‹xt
,

174 .
	gÇme
 = "tlv",

175 .
	gid
 = "SectionTLV",

176 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
v_li¡
),

177 .
	gty³
 = 
SND_TPLG_TYPE_TLV
,

178 .
	gsize
 = (
¢d_soc_lg_ùl_v
),

179 .
	g’ew
 = 1,

180 .
	g·r£
 = 
lg_·r£_v
,

181 .
	g§ve
 = 
lg_§ve_v
,

184 .
	gÇme
 = "stream config",

185 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
pcm_cÚfig_li¡
),

186 .
	gty³
 = 
SND_TPLG_TYPE_STREAM_CONFIG
,

187 .
	gsize
 = (
¢d_soc_lg_¡»am
),

188 .
	g’ew
 = 1,

191 .
	gÇme
 = "stream capabilities",

192 .
	gid
 = "SectionPCMCapabilities",

193 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
pcm_ÿps_li¡
),

194 .
	gty³
 = 
SND_TPLG_TYPE_STREAM_CAPS
,

195 .
	gsize
 = (
¢d_soc_lg_¡»am_ÿps
),

196 .
	g’ew
 = 1,

197 .
	g·r£
 = 
lg_·r£_¡»am_ÿps
,

198 .
	g§ve
 = 
lg_§ve_¡»am_ÿps
,

201 .
	gÇme
 = "token",

202 .
	gid
 = "SectionVendorTokens",

203 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
tok’_li¡
),

204 .
	gty³
 = 
SND_TPLG_TYPE_TOKEN
,

205 .
	g’ew
 = 1,

206 .
	g·r£
 = 
lg_·r£_tok’s
,

207 .
	g§ve
 = 
lg_§ve_tok’s
,

210 .
	gÇme
 = "tuple",

211 .
	gid
 = "SectionVendorTuples",

212 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
tu¶e_li¡
),

213 .
	gty³
 = 
SND_TPLG_TYPE_TUPLE
,

214 .
	gä“
 = 
lg_ä“_tu¶es
,

215 .
	g’ew
 = 1,

216 .
	g·r£
 = 
lg_·r£_tu¶es
,

217 .
	g§ve
 = 
lg_§ve_tu¶es
,

220 .
	gÇme
 = "hw config",

221 .
	gid
 = "SectionHWConfig",

222 .
	gloff
 = 
off£tof
(
¢d_lg_t
, 
hw_cfg_li¡
),

223 .
	gty³
 = 
SND_TPLG_TYPE_HW_CONFIG
,

224 .
	gsize
 = (
¢d_soc_lg_hw_cÚfig
),

225 .
	g’ew
 = 1,

226 .
	g·r£
 = 
lg_·r£_hw_cÚfig
,

227 .
	g§ve
 = 
lg_§ve_hw_cÚfig
,

231 
	glg_bË_™ems
 = 
ARRAY_SIZE
(
lg_bË
);

233 
	$lg_g‘_ty³
(
asoc_ty³
)

235 
šdex
;

237 
šdex
 = 0; index < 
lg_bË_™ems
; index++)

238 ià(
lg_bË
[
šdex
].
tsoc
 =ğ
asoc_ty³
)

239  
lg_bË
[
šdex
].
ty³
;

240 
	`SNDERR
("uknowÀasoøty³ %d", 
asoc_ty³
);

241  -
EINVAL
;

242 
	}
}

244 
	$lg_»f_add
(
lg_–em
 *
–em
, 
ty³
, cÚ¡ * 
id
)

246 
lg_»f
 *
»f
;

248 
»f
 = 
	`ÿÎoc
(1, (*ref));

249 ià(!
»f
)

250  -
ENOMEM
;

252 
	`¡ºıy
(
»f
->
id
, id, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

253 
»f
->
id
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
 - 1] = 0;

254 
»f
->
ty³
 =ype;

256 
	`li¡_add_
(&
»f
->
li¡
, &
–em
->
»f_li¡
);

258 
	}
}

261 
	$lg_»f_add_–em
(
lg_–em
 *
–em
, lg_–em *
–em_»f
)

263 
lg_»f
 *
»f
;

265 
»f
 = 
	`ÿÎoc
(1, (*ref));

266 ià(!
»f
)

267  -
ENOMEM
;

269 
»f
->
ty³
 = 
–em_»f
->type;

270 
»f
->
–em
 = 
–em_»f
;

271 
	`¢d_¡¾ıy
(
»f
->
id
, 
–em_»f
->id, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

273 
	`li¡_add_
(&
»f
->
li¡
, &
–em
->
»f_li¡
);

275 
	}
}

277 
	$lg_»f_ä“_li¡
(
li¡_h—d
 *
ba£
)

279 
li¡_h—d
 *
pos
, *
Åos
;

280 
lg_»f
 *
»f
;

282 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, 
ba£
) {

283 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

284 
	`li¡_d–
(&
»f
->
li¡
);

285 
	`ä“
(
»f
);

287 
	}
}

289 
lg_–em
 *
	$lg_–em_Ãw
()

291 
lg_–em
 *
–em
;

293 
–em
 = 
	`ÿÎoc
(1, (*elem));

294 ià(!
–em
)

295  
NULL
;

297 
	`INIT_LIST_HEAD
(&
–em
->
»f_li¡
);

298  
–em
;

299 
	}
}

301 
	$lg_–em_ä“
(
lg_–em
 *
–em
)

303 
	`li¡_d–
(&
–em
->
li¡
);

305 
	`lg_»f_ä“_li¡
(&
–em
->
»f_li¡
);

310 ià(
–em
->
obj
) {

311 ià(
–em
->
ä“
)

312 
–em
->
	`ä“
ÓËm->
obj
);

314 
	`ä“
(
–em
->
obj
);

317 
	`ä“
(
–em
);

318 
	}
}

320 
	$lg_–em_ä“_li¡
(
li¡_h—d
 *
ba£
)

322 
li¡_h—d
 *
pos
, *
Åos
;

323 
lg_–em
 *
–em
;

325 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, 
ba£
) {

326 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

327 
	`lg_–em_ä“
(
–em
);

329 
	}
}

331 
lg_–em
 *
	$lg_–em_lookup
(
li¡_h—d
 *
ba£
, cÚ¡ * 
id
,

332 
ty³
, 
šdex
)

334 
li¡_h—d
 *
pos
;

335 
lg_–em
 *
–em
;

337 ià(!
ba£
 || !
id
)

338  
NULL
;

340 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

342 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

344 ià(!
	`¡rcmp
(
–em
->
id
, idè&&ƒËm->
ty³
 ==ype)

345  
–em
;

348 ià((
šdex
 !ğ
SND_TPLG_INDEX_ALL
)

349 && (
–em
->
šdex
 > index))

353  
NULL
;

354 
	}
}

357 
lg_–em
 *
	$lg_–em_ty³_lookup
(
¢d_lg_t
 *
lg
,

358 
¢d_lg_ty³
 
ty³
)

360 
lg_bË
 *
Œ
;

361 
li¡_h—d
 *
pos
, *
li¡
;

362 
lg_–em
 *
–em
;

363 
šdex
;

365 
šdex
 = 0; index < 
lg_bË_™ems
; index++) {

366 
Œ
 = &
lg_bË
[
šdex
];

367 ià(!
Œ
->
’ew
)

369 ià(()
ty³
 !ğ
Œ
->type)

373 ià(
šdex
 >ğ
lg_bË_™ems
)

374  
NULL
;

376 
li¡
 = (
li¡_h—d
 *)((*)
lg
 + 
Œ
->
loff
);

379 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

380 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

381  
–em
;

383  
NULL
;

384 
	}
}

387 
	$lg_–em_š£¹
(
lg_–em
 *
–em_p
, 
li¡_h—d
 *
li¡
)

389 
li¡_h—d
 *
pos
, *
p
 = &(
–em_p
->
li¡
);

390 
lg_–em
 *
–em
;

392 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

393 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

394 ià(
–em_p
->
šdex
 < 
–em
->index)

398 
	`li¡_š£¹
(
p
, 
pos
->
´ev
,…os);

399 
	}
}

402 
lg_–em
* 
	$lg_–em_Ãw_commÚ
(
¢d_lg_t
 *
lg
,

403 
¢d_cÚfig_t
 *
cfg
,

404 cÚ¡ *
Çme
,

405 
¢d_lg_ty³
 
ty³
)

407 
lg_bË
 *
Œ
;

408 
lg_–em
 *
–em
;

409 
li¡_h—d
 *
li¡
;

410 cÚ¡ *
id
;

411 
obj_size
 = 0;

412 
šdex
;

413 *
obj
;

414 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

415 
¢d_cÚfig_t
 *
n
;

417 ià(!
cfg
 && !
Çme
)

418  
NULL
;

420 
–em
 = 
	`lg_–em_Ãw
();

421 ià(!
–em
)

422  
NULL
;

425 ià(
cfg
) {

426 
	`¢d_cÚfig_g‘_id
(
cfg
, &
id
);

427 
	`¢d_¡¾ıy
(
–em
->
id
, id, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

428 
–em
->
id
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
 - 1] = 0;

431 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

432 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

433 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
))

435 ià(
	`¡rcmp
(
id
, "index") == 0) {

436 ià(
	`lg_g‘_š‹g”
(
n
, &
–em
->
šdex
, 0)) {

437 
	`ä“
(
–em
);

438  
NULL
;

440 ià(
–em
->
šdex
 < 0) {

441 
	`ä“
(
–em
);

442  
NULL
;

446 } ià(
Çme
 !ğ
NULL
)

447 
	`¢d_¡¾ıy
(
–em
->
id
, 
Çme
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

449 
šdex
 = 0; index < 
lg_bË_™ems
; index++) {

450 
Œ
 = &
lg_bË
[
šdex
];

451 ià(!
Œ
->
’ew
)

453 ià(()
ty³
 !ğ
Œ
->type)

457 ià(
šdex
 >ğ
lg_bË_™ems
) {

458 
	`ä“
(
–em
);

459  
NULL
;

462 
li¡
 = (
li¡_h—d
 *)((*)
lg
 + 
Œ
->
loff
);

463 
	`lg_–em_š£¹
(
–em
, 
li¡
);

464 
obj_size
 = 
Œ
->
size
;

465 
–em
->
ä“
 = 
Œ
->free;

466 
–em
->
bË
 = 
Œ
;

469 ià(
obj_size
 > 0) {

470 
obj
 = 
	`ÿÎoc
(1, 
obj_size
);

471 ià(
obj
 =ğ
NULL
) {

472 
	`ä“
(
–em
);

473  
NULL
;

476 
–em
->
obj
 = obj;

477 
–em
->
size
 = 
obj_size
;

480 
–em
->
ty³
 =ype;

481  
–em
;

482 
	}
}

484 #iâdeà
DOC_HIDDEN


485 
	slg_®loc
 {

486 
li¡_h—d
 
	mli¡
;

487 *
	md©a
[0];

491 *
	$lg_ÿÎoc
(
li¡_h—d
 *
h—p
, 
size_t
 
size
)

493 
lg_®loc
 *
a
;

495 
a
 = 
	`ÿÎoc
(1, (*aè+ 
size
);

496 ià(
a
 =ğ
NULL
)

497  
NULL
;

498 
	`li¡_add_
(&
a
->
li¡
, 
h—p
);

499  
a
->
d©a
;

500 
	}
}

502 
	$lg_ä“
(
li¡_h—d
 *
h—p
)

504 
li¡_h—d
 *
pos
, *
Åos
;

505 
lg_®loc
 *
a
;

507 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, 
h—p
) {

508 
a
 = 
	`li¡_’Œy
(
pos
, 
lg_®loc
, 
li¡
);

509 
	`li¡_d–
(&
a
->
li¡
);

510 
	`ä“
(
a
);

512 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/log.c

18 
	~"lg_loÿl.h
"

21 
	$lg_log_
(
¢d_lg_t
 *
lg
, 
ty³
, 
size_t
 
pos
, cÚ¡ *
fmt
, ...)

23 
va_li¡
 
va
;

25 ià(!
lg
->
v”bo£
)

28 
	`va_¡¬t
(
va
, 
fmt
);

29 
	`årštf
(
¡dout
, "%c0x%6.6zx/%6.6zd - ", 
ty³
, 
pos
,…os);

30 
	`vårštf
(
¡dout
, 
fmt
, 
va
);

31 
	`va_’d
(
va
);

32 
	`putc
('\n', 
¡dout
);

33 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/ops.c

20 
	~"lg_loÿl.h
"

23 cÚ¡ 
m­_–em
 
	gcÚŒŞ_m­
[] = {

24 {"vŞsw", 
SND_SOC_TPLG_CTL_VOLSW
},

25 {"vŞsw_sx", 
SND_SOC_TPLG_CTL_VOLSW_SX
},

26 {"vŞsw_xr_sx", 
SND_SOC_TPLG_CTL_VOLSW_XR_SX
},

27 {"’um", 
SND_SOC_TPLG_CTL_ENUM
},

28 {"by‹s", 
SND_SOC_TPLG_CTL_BYTES
},

29 {"’um_v®ue", 
SND_SOC_TPLG_CTL_ENUM_VALUE
},

30 {"¿nge", 
SND_SOC_TPLG_CTL_RANGE
},

31 {"¡robe", 
SND_SOC_TPLG_CTL_STROBE
},

34 
	$lookup_İs
(cÚ¡ *
c
)

36 
i
;

37 
»t
;

39 
i
 = 0; i < ()
	`ARRAY_SIZE
(
cÚŒŞ_m­
); i++) {

40 ià(
	`¡rcmp
(
cÚŒŞ_m­
[
i
].
Çme
, 
c
) == 0)

41  
cÚŒŞ_m­
[
i
].
id
;

45 
i
 = 
	`§ã_¡¹Ş
(
c
, &
»t
);

46 ià(
i
 < 0) {

47 
	`SNDERR
("wrÚg kcÚŒŞ op v®u¡ršg '%s'", 
c
);

48  
i
;

51  
»t
;

52 
	}
}

54 cÚ¡ *
	$lg_İs_Çme
(
ty³
)

56 
i
;

58 
i
 = 0; i < 
	`ARRAY_SIZE
(
cÚŒŞ_m­
); i++) {

59 ià(
cÚŒŞ_m­
[
i
].
id
 =ğ
ty³
)

60  
cÚŒŞ_m­
[
i
].
Çme
;

63  
NULL
;

64 
	}
}

69 
	$lg_·r£_İs
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
, 
¢d_cÚfig_t
 *
cfg
,

70 *
´iv©e
)

72 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

73 
¢d_cÚfig_t
 *
n
;

74 
¢d_soc_lg_ùl_hdr
 *
hdr
 = 
´iv©e
;

75 cÚ¡ *
id
, *
v®ue
;

76 
iv®
;

78 
	`lg_dbg
("\tOps");

79 
hdr
->
size
 = (*hdr);

81 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

83 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

86 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

90 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è=ğ
SND_CONFIG_TYPE_STRING
) {

91 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®ue
) < 0)

93 
iv®
 = 
	`lookup_İs
(
v®ue
);

95 ià(
	`lg_g‘_š‹g”
(
n
, &
iv®
, 0))

99 ià(
	`¡rcmp
(
id
, "info") == 0)

100 
hdr
->
İs
.
šfo
 = 
iv®
;

101 ià(
	`¡rcmp
(
id
, "put") == 0)

102 
hdr
->
İs
.
put
 = 
iv®
;

103 ià(
	`¡rcmp
(
id
, "get") == 0)

104 
hdr
->
İs
.
g‘
 = 
iv®
;

106 
	`lg_dbg
("\t\t% ğ%d", 
id
, 
iv®
);

110 
	}
}

113 
	$lg_§ve_İs
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

114 
¢d_soc_lg_ùl_hdr
 *
hdr
,

115 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

117 cÚ¡ *
s
;

118 
”r
;

120 ià(
hdr
->
İs
.
šfo
 + hdr->İs.
g‘
 + hdr->İs.
put
 == 0)

122 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "ops.0 {\n");

123 ià(
”r
 >ğ0 && 
hdr
->
İs
.
šfo
 > 0) {

124 
s
 = 
	`lg_İs_Çme
(
hdr
->
İs
.
šfo
);

125 ià(
s
 =ğ
NULL
)

126 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tinfo %u\n",

127 
hdr
->
İs
.
šfo
);

129 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tšfØ%s\n", 
s
);

131 ià(
”r
 >ğ0 && 
hdr
->
İs
.
g‘
 > 0) {

132 
s
 = 
	`lg_İs_Çme
(
hdr
->
İs
.
g‘
);

133 ià(
s
 =ğ
NULL
)

134 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tget %u\n",

135 
hdr
->
İs
.
g‘
);

137 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tg‘ %s\n", 
s
);

139 ià(
”r
 >ğ0 && 
hdr
->
İs
.
put
 > 0) {

140 
s
 = 
	`lg_İs_Çme
(
hdr
->
İs
.
put
);

141 ià(
s
 =ğ
NULL
)

142 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tput %u\n",

143 
hdr
->
İs
.
put
);

145 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\uˆ%s\n", 
s
);

147 ià(
”r
 >= 0)

148 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

149  
”r
;

150 
	}
}

155 
	$lg_·r£_ext_İs
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

156 
¢d_cÚfig_t
 *
cfg
, *
´iv©e
)

158 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

159 
¢d_cÚfig_t
 *
n
;

160 
¢d_soc_lg_by‹s_cÚŒŞ
 *
be
 = 
´iv©e
;

161 cÚ¡ *
id
, *
v®ue
;

162 
iv®
;

164 
	`lg_dbg
("\tExt Ops");

166 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

168 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

171 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

175 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è=ğ
SND_CONFIG_TYPE_STRING
) {

176 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®ue
) < 0)

178 
iv®
 = 
	`lookup_İs
(
v®ue
);

180 ià(
	`lg_g‘_š‹g”
(
n
, &
iv®
, 0))

184 ià(
	`¡rcmp
(
id
, "info") == 0)

185 
be
->
ext_İs
.
šfo
 = 
iv®
;

186 ià(
	`¡rcmp
(
id
, "put") == 0)

187 
be
->
ext_İs
.
put
 = 
iv®
;

188 ià(
	`¡rcmp
(
id
, "get") == 0)

189 
be
->
ext_İs
.
g‘
 = 
iv®
;

191 
	`lg_dbg
("\t\t% ğ%s", 
id
, 
v®ue
);

195 
	}
}

198 
	$lg_§ve_ext_İs
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

199 
¢d_soc_lg_by‹s_cÚŒŞ
 *
be
,

200 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

202 cÚ¡ *
s
;

203 
”r
;

205 ià(
be
->
ext_İs
.
šfo
 + be->ext_İs.
g‘
 + be->ext_İs.
put
 == 0)

207 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "extops.0 {\n");

208 ià(
”r
 >ğ0 && 
be
->
ext_İs
.
šfo
 > 0) {

209 
s
 = 
	`lg_İs_Çme
(
be
->
ext_İs
.
šfo
);

210 ià(
s
 =ğ
NULL
)

211 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tinfo %u\n",

212 
be
->
ext_İs
.
šfo
);

214 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tšfØ%s\n", 
s
);

216 ià(
”r
 >ğ0 && 
be
->
ext_İs
.
g‘
 > 0) {

217 
s
 = 
	`lg_İs_Çme
(
be
->
ext_İs
.
g‘
);

218 ià(
s
 =ğ
NULL
)

219 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tget %u\n",

220 
be
->
ext_İs
.
g‘
);

222 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tg‘ %s\n", 
s
);

224 ià(
”r
 >ğ0 && 
be
->
ext_İs
.
put
 > 0) {

225 
s
 = 
	`lg_İs_Çme
(
be
->
ext_İs
.
put
);

226 ià(
s
 =ğ
NULL
)

227 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tput %u\n",

228 
be
->
ext_İs
.
put
);

230 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\uˆ%s\n", 
s
);

232 ià(
”r
 >= 0)

233 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

234  
”r
;

235 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/parser.c

20 
	~"lg_loÿl.h
"

21 
	~<sys/¡©.h
>

26 
	$lg_g‘_š‹g”
(
¢d_cÚfig_t
 *
n
, *
v®
, 
ba£
)

28 cÚ¡ *
¡r
;

29 
lv®
;

30 
”r
;

32 
	`¢d_cÚfig_g‘_ty³
(
n
)) {

33 
SND_CONFIG_TYPE_INTEGER
:

34 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
lv®
);

35 ià(
”r
 < 0)

36  
”r
;

37 
__»tv®
;

38 
SND_CONFIG_TYPE_STRING
:

39 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
);

40 ià(
”r
 < 0)

41  
”r
;

42 
”r
 = 
	`§ã_¡¹Ş_ba£
(
¡r
, &
lv®
, 
ba£
);

43 ià(
”r
 < 0)

44  
”r
;

45 
__»tv®
;

47  -
EINVAL
;

49 
__»tv®
:

50 ià(
lv®
 < 
INT_MIN
 ||†v® > 
INT_MAX
)

51  -
ERANGE
;

52 *
v®
 = 
lv®
;

54 
	}
}

59 
	$lg_g‘_unsigÃd
(
¢d_cÚfig_t
 *
n
, *
v®
, 
ba£
)

61 cÚ¡ *
¡r
;

62 
lv®
;

63 
Îv®
;

64 
uv®
;

65 
”r
;

67 
	`¢d_cÚfig_g‘_ty³
(
n
)) {

68 
SND_CONFIG_TYPE_INTEGER
:

69 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
lv®
);

70 ià(
”r
 < 0)

71  
”r
;

72 ià(
lv®
 < 0 &&†v® >ğ
INT_MIN
)

73 
lv®
 = 
UINT_MAX
 +†val + 1;

74 ià(
lv®
 < 0 ||†v® > 
UINT_MAX
)

75  -
ERANGE
;

76 *
v®
 = 
lv®
;

77  
”r
;

78 
SND_CONFIG_TYPE_INTEGER64
:

79 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”64
(
n
, &
Îv®
);

80 ià(
”r
 < 0)

81  
”r
;

82 ià(
Îv®
 < 0 &&†lv® >ğ
INT_MIN
)

83 
Îv®
 = 
UINT_MAX
 +†lval + 1;

84 ià(
Îv®
 < 0 ||†lv® > 
UINT_MAX
)

85  -
ERANGE
;

86 *
v®
 = 
Îv®
;

87  
”r
;

88 
SND_CONFIG_TYPE_STRING
:

89 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
);

90 ià(
”r
 < 0)

91  
”r
;

92 
”ºo
 = 0;

93 
uv®
 = 
	`¡¹oul
(
¡r
, 
NULL
, 
ba£
);

94 ià(
”ºo
 =ğ
ERANGE
 && 
uv®
 =ğ
ULONG_MAX
)

95  -
ERANGE
;

96 ià(
”ºo
 && 
uv®
 == 0)

97  -
EINVAL
;

98 ià(
uv®
 > 
UINT_MAX
)

99  -
ERANGE
;

100 *
v®
 = 
uv®
;

103  -
EINVAL
;

105 
	}
}

110 
lg_·r£_compound
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

111 (*
fú
)(
¢d_lg_t
 *, 
¢d_cÚfig_t
 *, *),

112 *
´iv©e
)

114 cÚ¡ *
id
;

115 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

116 
¢d_cÚfig_t
 *
n
;

117 
”r
 = -
EINVAL
;

119 ià(
	`¢d_cÚfig_g‘_id
(
cfg
, &
id
) < 0)

120  -
EINVAL
;

122 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

123 
	`SNDERR
("compoundy³ƒx³ùed fÜ %s", 
id
);

124  -
EINVAL
;

128 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

129 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

131 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

132 
	`SNDERR
("compoundypeƒxpected for %s, is %d",

133 
id
, 
	`¢d_cÚfig_g‘_ty³
(
cfg
));

134  -
EINVAL
;

137 
”r
 = 
	`fú
(
lg
, 
n
, 
´iv©e
);

138 ià(
”r
 < 0)

139  
”r
;

142  
”r
;

143 
	}
}

145 
	$lg_·r£_cÚfig
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
)

147 (*
·r£r
)(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

148 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

149 
¢d_cÚfig_t
 *
n
;

150 cÚ¡ *
id
;

151 
lg_bË
 *
p
;

152 
idx
;

153 
”r
;

155 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

156 
	`SNDERR
("compoundypeƒxpected‡top†evel");

157  -
EINVAL
;

161 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

163 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

164 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

167 
·r£r
 = 
NULL
;

168 
idx
 = 0; idx < 
lg_bË_™ems
; idx++) {

169 
p
 = &
lg_bË
[
idx
];

170 ià(
p
->
id
 && 
	`¡rcmp
(id,…->id) == 0) {

171 
·r£r
 = 
p
->
·r£
;

174 ià(
p
->
id2
 && 
	`¡rcmp
(
id
,…->id2) == 0) {

175 
·r£r
 = 
p
->
·r£
;

180 ià(
·r£r
 =ğ
NULL
) {

181 
	`SNDERR
("unknowÀ£ùiÚ %s", 
id
);

185 
”r
 = 
	`lg_·r£_compound
(
lg
, 
n
, 
·r£r
, 
NULL
);

186 ià(
”r
 < 0)

187  
”r
;

190 
	}
}

192 
	$lg_lßd_cÚfig
(
¢d_lg_t
 *
lg
, 
¢d_šput_t
 *
š
)

194 
¢d_cÚfig_t
 *
tİ
;

195 
»t
;

197 
»t
 = 
	`¢d_cÚfig_tİ
(&
tİ
);

198 ià(
»t
 < 0)

199  
»t
;

201 
»t
 = 
	`¢d_cÚfig_lßd
(
tİ
, 
š
);

202 ià(
»t
 < 0) {

203 
	`SNDERR
("could‚ot†oad configuration");

204 
	`¢d_cÚfig_d–‘e
(
tİ
);

205  
»t
;

208 
»t
 = 
	`lg_·r£_cÚfig
(
lg
, 
tİ
);

209 
	`¢d_cÚfig_d–‘e
(
tİ
);

210 ià(
»t
 < 0) {

211 
	`SNDERR
("failedo…arseopology");

212  
»t
;

216 
	}
}

218 
	$lg_bud_š‹g
(
¢d_lg_t
 *
lg
)

220 
”r
;

222 
”r
 = 
	`lg_bud_d©a
(
lg
);

223 ià(
”r
 < 0)

224  
”r
;

226 
”r
 = 
	`lg_bud_mªiã¡_d©a
(
lg
);

227 ià(
”r
 < 0)

228  
”r
;

230 
”r
 = 
	`lg_bud_cÚŒŞs
(
lg
);

231 ià(
”r
 < 0)

232  
”r
;

234 
”r
 = 
	`lg_bud_widg‘s
(
lg
);

235 ià(
”r
 < 0)

236  
”r
;

238 
”r
 = 
	`lg_bud_pcms
(
lg
, 
SND_TPLG_TYPE_PCM
);

239 ià(
”r
 < 0)

240  
”r
;

242 
”r
 = 
	`lg_bud_dais
(
lg
, 
SND_TPLG_TYPE_DAI
);

243 ià(
”r
 < 0)

244  
”r
;

246 
”r
 = 
	`lg_bud_lšks
(
lg
, 
SND_TPLG_TYPE_BE
);

247 ià(
”r
 < 0)

248  
”r
;

250 
”r
 = 
	`lg_bud_lšks
(
lg
, 
SND_TPLG_TYPE_CC
);

251 ià(
”r
 < 0)

252  
”r
;

254 
”r
 = 
	`lg_bud_rou‹s
(
lg
);

255 ià(
”r
 < 0)

256  
”r
;

258  
”r
;

259 
	}
}

261 
	$¢d_lg_lßd
(
¢d_lg_t
 *
lg
, cÚ¡ *
buf
, 
size_t
 
size
)

263 
¢d_šput_t
 *
š
;

264 
”r
;

266 
”r
 = 
	`¢d_šput_bufãr_İ’
(&
š
, 
buf
, 
size
);

267 ià(
”r
 < 0) {

268 
	`SNDERR
("could‚ot create input buffer");

269  
”r
;

272 
”r
 = 
	`lg_lßd_cÚfig
(
lg
, 
š
);

273 
	`¢d_šput_şo£
(
š
);

274  
”r
;

275 
	}
}

277 
	$lg_bud
(
¢d_lg_t
 *
lg
)

279 
”r
;

281 
”r
 = 
	`lg_bud_š‹g
(
lg
);

282 ià(
”r
 < 0) {

283 
	`SNDERR
("failedo checkopology integrity");

284  
”r
;

287 
”r
 = 
	`lg_wr™e_d©a
(
lg
);

288 ià(
”r
 < 0) {

289 
	`SNDERR
("çedØwr™d©¨%d", 
”r
);

290  
”r
;

293 
	}
}

295 
	$¢d_lg_bud_fe
(
¢d_lg_t
 *
lg
,

296 cÚ¡ *
šfe
,

297 cÚ¡ *
outfe
)

299 
FILE
 *
å
;

300 
¢d_šput_t
 *
š
;

301 
”r
;

303 
å
 = 
	`fİ’
(
šfe
, "r");

304 ià(
å
 =ğ
NULL
) {

305 
	`SNDERR
("could‚Ù o³ÀcÚfigu¿tiÚ f%s", 
šfe
);

306  -
”ºo
;

309 
”r
 = 
	`¢d_šput_¡dio_©ch
(&
š
, 
å
, 1);

310 ià(
”r
 < 0) {

311 
	`fşo£
(
å
);

312 
	`SNDERR
("could‚Ù‡‰ach stdiØ%s", 
šfe
);

313  
”r
;

316 
”r
 = 
	`lg_lßd_cÚfig
(
lg
, 
š
);

317 
	`¢d_šput_şo£
(
š
);

318 ià(
”r
 < 0)

319  
”r
;

321  
	`¢d_lg_bud
(
lg
, 
outfe
);

322 
	}
}

324 
	$¢d_lg_add_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
)

326 
t
->
ty³
) {

327 
SND_TPLG_TYPE_MIXER
:

328  
	`lg_add_mix”_objeù
(
lg
, 
t
);

329 
SND_TPLG_TYPE_ENUM
:

330  
	`lg_add_’um_objeù
(
lg
, 
t
);

331 
SND_TPLG_TYPE_BYTES
:

332  
	`lg_add_by‹s_objeù
(
lg
, 
t
);

333 
SND_TPLG_TYPE_DAPM_WIDGET
:

334  
	`lg_add_widg‘_objeù
(
lg
, 
t
);

335 
SND_TPLG_TYPE_DAPM_GRAPH
:

336  
	`lg_add_g¿ph_objeù
(
lg
, 
t
);

337 
SND_TPLG_TYPE_PCM
:

338  
	`lg_add_pcm_objeù
(
lg
, 
t
);

339 
SND_TPLG_TYPE_DAI
:

340  
	`lg_add_dai_objeù
(
lg
, 
t
);

341 
SND_TPLG_TYPE_LINK
:

342 
SND_TPLG_TYPE_BE
:

343 
SND_TPLG_TYPE_CC
:

344  
	`lg_add_lšk_objeù
(
lg
, 
t
);

346 
	`SNDERR
("šv®id objeùy³ %d", 
t
->
ty³
);

347  -
EINVAL
;

349 
	}
}

351 
	$¢d_lg_bud
(
¢d_lg_t
 *
lg
, cÚ¡ *
outfe
)

353 
fd
, 
”r
;

354 
ssize_t
 
r
;

356 
”r
 = 
	`lg_bud
(
lg
);

357 ià(
”r
 < 0)

358  
”r
;

360 
fd
 = 
	`İ’
(
outfe
, 
O_RDWR
 | 
O_CREAT
 | 
O_TRUNC
, 
S_IRUSR
 | 
S_IWUSR
);

361 ià(
fd
 < 0) {

362 
	`SNDERR
("çedØİ’ % ”¸%d", 
outfe
, -
”ºo
);

363  -
”ºo
;

365 
r
 = 
	`wr™e
(
fd
, 
lg
->
bš
,¶g->
bš_size
);

366 
	`şo£
(
fd
);

367 ià(
r
 < 0) {

368 
”r
 = -
”ºo
;

369 
	`SNDERR
("wr™”rÜ: %s", 
	`¡»¼Ü
(
”ºo
));

370  
”r
;

372 ià((
size_t
)
r
 !ğ
lg
->
bš_size
) {

373 
	`SNDERR
("·¹ŸÈwr™(%zd !ğ%zd)", 
r
, 
lg
->
bš_size
);

374  -
EIO
;

377 
	}
}

379 
	$¢d_lg_bud_bš
(
¢d_lg_t
 *
lg
,

380 **
bš
, 
size_t
 *
size
)

382 
”r
;

384 
”r
 = 
	`lg_bud
(
lg
);

385 ià(
”r
 < 0)

386  
”r
;

388 *
bš
 = 
lg
->bin;

389 *
size
 = 
lg
->
bš_size
;

390 
lg
->
bš
 = 
NULL
;

391 
lg
->
bš_size
 =¶g->
bš_pos
 = 0;

393 
	}
}

395 
	$¢d_lg_£t_mªiã¡_d©a
(
¢d_lg_t
 *
lg
, cÚ¡ *
d©a
, 
Ën
)

397 
lg_–em
 *
–em
;

399 
–em
 = 
	`lg_–em_ty³_lookup
(
lg
, 
SND_TPLG_TYPE_MANIFEST
);

400 ià(
–em
 =ğ
NULL
) {

401 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
, "manifest",

402 
SND_TPLG_TYPE_MANIFEST
);

403 ià(!
–em
)

404  -
ENOMEM
;

405 
lg
->
mªiã¡
.
size
 = 
–em
->size;

408 ià(
Ën
 <= 0)

411  
	`lg_add_d©a_by‹s
(
lg
, 
–em
, 
NULL
, 
d©a
, 
Ën
);

412 
	}
}

414 
	$¢d_lg_£t_v”siÚ
(
¢d_lg_t
 *
lg
, 
v”siÚ
)

416 
lg
->
v”siÚ
 = version;

419 
	}
}

421 
	$¢d_lg_v”bo£
(
¢d_lg_t
 *
lg
, 
v”bo£
)

423 
lg
->
v”bo£
 = verbose;

424 
	}
}

426 
boŞ
 
	$is_l™e_’dŸn
()

428 #ià
__BYTE_ORDER__
 =ğ
__ORDER_LITTLE_ENDIAN__
 && 
__SIZEOF_INT__
 == 4

429  
Œue
;

431  
çl£
;

432 
	}
}

434 
¢d_lg_t
 *
	$¢d_lg_ü—‹
(
æags
)

436 
¢d_lg_t
 *
lg
;

438 ià(!
	`is_l™e_’dŸn
()) {

439 
	`SNDERR
("cannot support big-endian machines");

440  
NULL
;

443 
lg
 = 
	`ÿÎoc
(1, (
¢d_lg_t
));

444 ià(!
lg
)

445  
NULL
;

447 
lg
->
v”bo£
 = !!(
æags
 & 
SND_TPLG_CREATE_VERBOSE
);

448 
lg
->
d­m_sÜt
 = (
æags
 & 
SND_TPLG_CREATE_DAPM_NOSORT
) == 0;

450 
lg
->
mªiã¡
.
size
 = (
¢d_soc_lg_mªiã¡
);

452 
	`INIT_LIST_HEAD
(&
lg
->
v_li¡
);

453 
	`INIT_LIST_HEAD
(&
lg
->
widg‘_li¡
);

454 
	`INIT_LIST_HEAD
(&
lg
->
pcm_li¡
);

455 
	`INIT_LIST_HEAD
(&
lg
->
dai_li¡
);

456 
	`INIT_LIST_HEAD
(&
lg
->
be_li¡
);

457 
	`INIT_LIST_HEAD
(&
lg
->
cc_li¡
);

458 
	`INIT_LIST_HEAD
(&
lg
->
rou‹_li¡
);

459 
	`INIT_LIST_HEAD
(&
lg
->
pd©a_li¡
);

460 
	`INIT_LIST_HEAD
(&
lg
->
mªiã¡_li¡
);

461 
	`INIT_LIST_HEAD
(&
lg
->
‹xt_li¡
);

462 
	`INIT_LIST_HEAD
(&
lg
->
pcm_cÚfig_li¡
);

463 
	`INIT_LIST_HEAD
(&
lg
->
pcm_ÿps_li¡
);

464 
	`INIT_LIST_HEAD
(&
lg
->
mix”_li¡
);

465 
	`INIT_LIST_HEAD
(&
lg
->
’um_li¡
);

466 
	`INIT_LIST_HEAD
(&
lg
->
by‹s_ext_li¡
);

467 
	`INIT_LIST_HEAD
(&
lg
->
tok’_li¡
);

468 
	`INIT_LIST_HEAD
(&
lg
->
tu¶e_li¡
);

469 
	`INIT_LIST_HEAD
(&
lg
->
hw_cfg_li¡
);

471  
lg
;

472 
	}
}

474 
¢d_lg_t
 *
	$¢d_lg_Ãw
()

476  
	`¢d_lg_ü—‹
(0);

477 
	}
}

479 
	$¢d_lg_ä“
(
¢d_lg_t
 *
lg
)

481 
	`ä“
(
lg
->
bš
);

482 
	`ä“
(
lg
->
mªiã¡_pd©a
);

484 
	`lg_–em_ä“_li¡
(&
lg
->
v_li¡
);

485 
	`lg_–em_ä“_li¡
(&
lg
->
widg‘_li¡
);

486 
	`lg_–em_ä“_li¡
(&
lg
->
pcm_li¡
);

487 
	`lg_–em_ä“_li¡
(&
lg
->
dai_li¡
);

488 
	`lg_–em_ä“_li¡
(&
lg
->
be_li¡
);

489 
	`lg_–em_ä“_li¡
(&
lg
->
cc_li¡
);

490 
	`lg_–em_ä“_li¡
(&
lg
->
rou‹_li¡
);

491 
	`lg_–em_ä“_li¡
(&
lg
->
pd©a_li¡
);

492 
	`lg_–em_ä“_li¡
(&
lg
->
mªiã¡_li¡
);

493 
	`lg_–em_ä“_li¡
(&
lg
->
‹xt_li¡
);

494 
	`lg_–em_ä“_li¡
(&
lg
->
pcm_cÚfig_li¡
);

495 
	`lg_–em_ä“_li¡
(&
lg
->
pcm_ÿps_li¡
);

496 
	`lg_–em_ä“_li¡
(&
lg
->
mix”_li¡
);

497 
	`lg_–em_ä“_li¡
(&
lg
->
’um_li¡
);

498 
	`lg_–em_ä“_li¡
(&
lg
->
by‹s_ext_li¡
);

499 
	`lg_–em_ä“_li¡
(&
lg
->
tok’_li¡
);

500 
	`lg_–em_ä“_li¡
(&
lg
->
tu¶e_li¡
);

501 
	`lg_–em_ä“_li¡
(&
lg
->
hw_cfg_li¡
);

503 
	`ä“
(
lg
);

504 
	}
}

506 cÚ¡ *
	$¢d_lg_v”siÚ
()

508  
SND_LIB_VERSION_STR
;

509 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/pcm.c

20 
	~"lg_loÿl.h
"

22 
	#RATE
(
v
è[
SND_PCM_RATE_
##v] = #v

	)

24 cÚ¡ *cÚ¡ 
	g¢d_pcm_¿‹_Çmes
[] = {

25 
RATE
(5512),

26 
RATE
(8000),

27 
RATE
(11025),

28 
RATE
(16000),

29 
RATE
(22050),

30 
RATE
(32000),

31 
RATE
(44100),

32 
RATE
(48000),

33 
RATE
(64000),

34 
RATE
(88200),

35 
RATE
(96000),

36 
RATE
(176400),

37 
RATE
(192000),

38 
RATE
(
CONTINUOUS
),

39 
RATE
(
KNOT
),

42 
lg_–em
 *
	$lookup_pcm_dai_¡»am
(
li¡_h—d
 *
ba£
, cÚ¡ * 
id
)

44 
li¡_h—d
 *
pos
;

45 
lg_–em
 *
–em
;

46 
¢d_soc_lg_pcm
 *
pcm
;

48 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

50 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

51 ià(
–em
->
ty³
 !ğ
SND_TPLG_TYPE_PCM
)

52  
NULL
;

54 
pcm
 = 
–em
->pcm;

56 ià(
pcm
 && !
	`¡rcmp
Õcm->
dai_Çme
, 
id
))

57  
–em
;

60  
NULL
;

61 
	}
}

64 
	$cİy_¡»am_ÿps
(cÚ¡ *
id
 
ATTRIBUTE_UNUSED
,

65 
¢d_soc_lg_¡»am_ÿps
 *
ÿps
,

66 
lg_–em
 *
»f_–em
)

68 
¢d_soc_lg_¡»am_ÿps
 *
»f_ÿps
 = 
»f_–em
->
¡»am_ÿps
;

70 
	`lg_dbg
("Copy…cm caps (%ld bytes) from '%s'o '%s'",

71 (*
ÿps
), 
»f_–em
->
id
, id);

73 *
ÿps
 = *
»f_ÿps
;

74 
	}
}

77 
	$lg_bud_¡»am_ÿps
(
¢d_lg_t
 *
lg
,

78 cÚ¡ *
id
, 
šdex
,

79 
¢d_soc_lg_¡»am_ÿps
 *
ÿps
)

81 
lg_–em
 *
»f_–em
 = 
NULL
;

82 
i
;

84 
i
 = 0; i < 2; i++) {

85 
»f_–em
 = 
	`lg_–em_lookup
(&
lg
->
pcm_ÿps_li¡
,

86 
ÿps
[
i
].
Çme
, 
SND_TPLG_TYPE_STREAM_CAPS
, 
šdex
);

88 ià(
»f_–em
 !ğ
NULL
)

89 
	`cİy_¡»am_ÿps
(
id
, &
ÿps
[
i
], 
»f_–em
);

93 
	}
}

96 
	$bud_pcm
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
)

98 
lg_»f
 *
»f
;

99 
li¡_h—d
 *
ba£
, *
pos
;

100 
”r
;

102 
”r
 = 
	`lg_bud_¡»am_ÿps
(
lg
, 
–em
->
id
,ƒËm->
šdex
,

103 
–em
->
pcm
->
ÿps
);

104 ià(
”r
 < 0)

105  
”r
;

108 
ba£
 = &
–em
->
»f_li¡
;

109 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

111 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

112 ià(
»f
->
ty³
 =ğ
SND_TPLG_TYPE_DATA
) {

113 
”r
 = 
	`lg_cİy_d©a
(
lg
, 
–em
, 
»f
);

114 ià(
”r
 < 0)

115  
”r
;

117 ià(!
»f
->
–em
) {

118 
	`SNDERR
("cannot find '%s'„eferenced by"

119 " PCM '%s'", 
»f
->
id
, 
–em
->id);

120  -
EINVAL
;

125 
	}
}

128 
	$lg_bud_pcms
(
¢d_lg_t
 *
lg
, 
ty³
)

130 
li¡_h—d
 *
ba£
, *
pos
;

131 
lg_–em
 *
–em
;

132 
”r
 = 0;

134 
ba£
 = &
lg
->
pcm_li¡
;

135 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

137 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

138 ià(
–em
->
ty³
 !=ype) {

139 
	`SNDERR
("šv®idƒËm '%s'", 
–em
->
id
);

140  -
EINVAL
;

143 
”r
 = 
	`bud_pcm
(
lg
, 
–em
);

144 ià(
”r
 < 0)

145  
”r
;

148 
lg
->
mªiã¡
.
pcm_–ems
++;

152 
	}
}

155 
	$lg_bud_dai
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
)

157 
lg_»f
 *
»f
;

158 
li¡_h—d
 *
ba£
, *
pos
;

159 
”r
 = 0;

162 
”r
 = 
	`lg_bud_¡»am_ÿps
(
lg
, 
–em
->
id
,ƒËm->
šdex
,

163 
–em
->
dai
->
ÿps
);

164 ià(
”r
 < 0)

165  
”r
;

168 
ba£
 = &
–em
->
»f_li¡
;

169 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

171 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

173 ià(
»f
->
ty³
 =ğ
SND_TPLG_TYPE_DATA
) {

174 
”r
 = 
	`lg_cİy_d©a
(
lg
, 
–em
, 
»f
);

175 ià(
”r
 < 0)

176  
”r
;

181 
lg
->
mªiã¡
.
dai_–ems
++;

184 
	}
}

187 
	$lg_bud_dais
(
¢d_lg_t
 *
lg
, 
ty³
)

189 
li¡_h—d
 *
ba£
, *
pos
;

190 
lg_–em
 *
–em
;

191 
”r
 = 0;

193 
ba£
 = &
lg
->
dai_li¡
;

194 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

196 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

197 ià(
–em
->
ty³
 !=ype) {

198 
	`SNDERR
("šv®idƒËm '%s'", 
–em
->
id
);

199  -
EINVAL
;

202 
”r
 = 
	`lg_bud_dai
(
lg
, 
–em
);

203 ià(
”r
 < 0)

204  
”r
;

208 
	}
}

210 
	$lg_bud_¡»am_cfg
(
¢d_lg_t
 *
lg
,

211 
¢d_soc_lg_¡»am
 *
¡»am
,

212 
num_¡»ams
, 
šdex
)

214 
¢d_soc_lg_¡»am
 *
¡rm
;

215 
lg_–em
 *
»f_–em
;

216 
i
;

218 
i
 = 0; i < 
num_¡»ams
; i++) {

219 
¡rm
 = 
¡»am
 + 
i
;

220 
»f_–em
 = 
	`lg_–em_lookup
(&
lg
->
pcm_cÚfig_li¡
,

221 
¡rm
->
Çme
, 
SND_TPLG_TYPE_STREAM_CONFIG
, 
šdex
);

223 ià(
»f_–em
 &&„ef_–em->
¡»am_cfg
)

224 *
¡rm
 = *
»f_–em
->
¡»am_cfg
;

228 
	}
}

230 
	$bud_lšk
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
)

232 
¢d_soc_lg_lšk_cÚfig
 *
lšk
 = 
–em
->link;

233 
lg_»f
 *
»f
;

234 
li¡_h—d
 *
ba£
, *
pos
;

235 
num_hw_cÚfigs
 = 0, 
”r
 = 0;

237 
”r
 = 
	`lg_bud_¡»am_cfg
(
lg
, 
lšk
->
¡»am
,

238 
lšk
->
num_¡»ams
, 
–em
->
šdex
);

239 ià(
”r
 < 0)

240  
”r
;

243 
ba£
 = &
–em
->
»f_li¡
;

244 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

246 
»f
 = 
	`li¡_’Œy
(
pos
, 
lg_»f
, 
li¡
);

248 
»f
->
ty³
) {

249 
SND_TPLG_TYPE_HW_CONFIG
:

250 
»f
->
–em
 = 
	`lg_–em_lookup
(&
lg
->
hw_cfg_li¡
,

251 
»f
->
id
, 
SND_TPLG_TYPE_HW_CONFIG
, 
–em
->
šdex
);

252 ià(!
»f
->
–em
) {

253 
	`SNDERR
("cannot find HW config '%s'"

255 
»f
->
id
, 
–em
->id);

256  -
EINVAL
;

259 
	`memıy
(&
lšk
->
hw_cÚfig
[
num_hw_cÚfigs
],

260 
»f
->
–em
->
hw_cfg
,

261 (
¢d_soc_lg_hw_cÚfig
));

262 
num_hw_cÚfigs
++;

265 
SND_TPLG_TYPE_DATA
:

266 
”r
 = 
	`lg_cİy_d©a
(
lg
, 
–em
, 
»f
);

267 ià(
”r
 < 0)

268  
”r
;

269 
lšk
 = 
–em
->link;

278 
lg
->
mªiã¡
.
dai_lšk_–ems
++;

281 
	}
}

284 
	$lg_bud_lšks
(
¢d_lg_t
 *
lg
, 
ty³
)

286 
li¡_h—d
 *
ba£
, *
pos
;

287 
lg_–em
 *
–em
;

288 
”r
 = 0;

290 
ty³
) {

291 
SND_TPLG_TYPE_LINK
:

292 
SND_TPLG_TYPE_BE
:

293 
ba£
 = &
lg
->
be_li¡
;

295 
SND_TPLG_TYPE_CC
:

296 
ba£
 = &
lg
->
cc_li¡
;

299  -
EINVAL
;

302 
	`li¡_fÜ_—ch
(
pos
, 
ba£
) {

304 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

305 
”r
 = 
	`bud_lšk
(
lg
, 
–em
);

306 ià(
”r
 < 0)

307  
”r
;

311 
	}
}

313 
	$¥l™_fÜm©
(
¢d_soc_lg_¡»am_ÿps
 *
ÿps
, *
¡r
)

315 *
s
 = 
NULL
;

316 
¢d_pcm_fÜm©_t
 
fÜm©
;

317 
i
 = 0;

319 
s
 = 
	`¡¹ok
(
¡r
, ",");

320 (
s
 !ğ
NULL
è&& (
i
 < 
SND_SOC_TPLG_MAX_FORMATS
)) {

321 
fÜm©
 = 
	`¢d_pcm_fÜm©_v®ue
(
s
);

322 ià(
fÜm©
 =ğ
SND_PCM_FORMAT_UNKNOWN
) {

323 
	`SNDERR
("unsuµÜ‹d sŒ—m fÜm© %s", 
s
);

324  -
EINVAL
;

327 
ÿps
->
fÜm©s
 |ğ1uÎ << 
fÜm©
;

328 
s
 = 
	`¡¹ok
(
NULL
, ", ");

329 
i
++;

333 
	}
}

335 
	$g‘_¿‹_v®ue
(cÚ¡ * 
Çme
)

337 
¿‹
;

338 
¿‹
 = 0;„©<ğ
SND_PCM_RATE_LAST
;„ate++) {

339 ià(
¢d_pcm_¿‹_Çmes
[
¿‹
] &&

340 
	`¡rÿ£cmp
(
Çme
, 
¢d_pcm_¿‹_Çmes
[
¿‹
]) == 0) {

341  
¿‹
;

345  
SND_PCM_RATE_UNKNOWN
;

346 
	}
}

348 cÚ¡ *
	$g‘_¿‹_Çme
(
¿‹
)

350 ià(
¿‹
 >ğ0 &&„©<ğ
SND_PCM_RATE_LAST
)

351  
¢d_pcm_¿‹_Çmes
[
¿‹
];

352  
NULL
;

353 
	}
}

355 
	$¥l™_¿‹
(
¢d_soc_lg_¡»am_ÿps
 *
ÿps
, *
¡r
)

357 *
s
 = 
NULL
;

358 
¢d_pcm_¿‹s_t
 
¿‹
;

359 
i
 = 0;

361 
s
 = 
	`¡¹ok
(
¡r
, ",");

362 
s
) {

363 
¿‹
 = 
	`g‘_¿‹_v®ue
(
s
);

365 ià(
¿‹
 =ğ
SND_PCM_RATE_UNKNOWN
) {

366 
	`SNDERR
("unsuµÜ‹d sŒ—m„©%s", 
s
);

367  -
EINVAL
;

370 
ÿps
->
¿‹s
 |ğ1 << 
¿‹
;

371 
s
 = 
	`¡¹ok
(
NULL
, ", ");

372 
i
++;

376 
	}
}

378 
	$·r£_unsigÃd
(
¢d_cÚfig_t
 *
n
, *
d¡
)

380 
iv®
;

382 ià(
	`lg_g‘_š‹g”
(
n
, &
iv®
, 0) < 0)

383  -
EINVAL
;

385 
	`uÇligÃd_put32
(
d¡
, 
iv®
);

386 #ià
TPLG_DEBUG


388 cÚ¡ *
id
;

389 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) >= 0)

390 
	`lg_dbg
("\t\t%s: %d", 
id
, 
iv®
);

394 
	}
}

397 
	$lg_·r£_¡»am_ÿps
(
¢d_lg_t
 *
lg
,

398 
¢d_cÚfig_t
 *
cfg
,

399 *
´iv©e
 
ATTRIBUTE_UNUSED
)

401 
¢d_soc_lg_¡»am_ÿps
 *
sc
;

402 
lg_–em
 *
–em
;

403 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

404 
¢d_cÚfig_t
 *
n
;

405 cÚ¡ *
id
, *
v®
;

406 *
s
;

407 
”r
;

409 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_STREAM_CAPS
);

410 ià(!
–em
)

411  -
ENOMEM
;

413 
sc
 = 
–em
->
¡»am_ÿps
;

414 
sc
->
size
 = 
–em
->size;

415 
	`¢d_¡¾ıy
(
sc
->
Çme
, 
–em
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

417 
	`lg_dbg
(" PCM C­ab™›s: %s", 
–em
->
id
);

419 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

420 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

421 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

425 ià(
	`¡rcmp
(
id
, "comment") == 0)

427 ià(
id
[0] == '#')

430 ià(
	`¡rcmp
(
id
, "formats") == 0) {

431 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®
) < 0)

432  -
EINVAL
;

434 
s
 = 
	`¡rdup
(
v®
);

435 ià(
s
 =ğ
NULL
)

436  -
ENOMEM
;

438 
”r
 = 
	`¥l™_fÜm©
(
sc
, 
s
);

439 
	`ä“
(
s
);

441 ià(
”r
 < 0)

442  
”r
;

444 
	`lg_dbg
("\t\t%s: %s", 
id
, 
v®
);

448 ià(
	`¡rcmp
(
id
, "rates") == 0) {

449 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®
) < 0)

450  -
EINVAL
;

452 
s
 = 
	`¡rdup
(
v®
);

453 ià(!
s
)

454  -
ENOMEM
;

456 
”r
 = 
	`¥l™_¿‹
(
sc
, 
s
);

457 
	`ä“
(
s
);

459 ià(
”r
 < 0)

460  
”r
;

462 
	`lg_dbg
("\t\t%s: %s", 
id
, 
v®
);

466 ià(
	`¡rcmp
(
id
, "rate_min") == 0) {

467 ià(
	`·r£_unsigÃd
(
n
, &
sc
->
¿‹_mš
))

468  -
EINVAL
;

472 ià(
	`¡rcmp
(
id
, "rate_max") == 0) {

473 ià(
	`·r£_unsigÃd
(
n
, &
sc
->
¿‹_max
))

474  -
EINVAL
;

478 ià(
	`¡rcmp
(
id
, "channels_min") == 0) {

479 ià(
	`·r£_unsigÃd
(
n
, &
sc
->
chªÃls_mš
))

480  -
EINVAL
;

484 ià(
	`¡rcmp
(
id
, "channels_max") == 0) {

485 ià(
	`·r£_unsigÃd
(
n
, &
sc
->
chªÃls_max
))

486  -
EINVAL
;

490 ià(
	`¡rcmp
(
id
, "periods_min") == 0) {

491 ià(
	`·r£_unsigÃd
(
n
, &
sc
->
³riods_mš
))

492  -
EINVAL
;

496 ià(
	`¡rcmp
(
id
, "periods_max") == 0) {

497 ià(
	`·r£_unsigÃd
(
n
, &
sc
->
³riods_max
))

498  -
EINVAL
;

502 ià(
	`¡rcmp
(
id
, "period_size_min") == 0) {

503 ià(
	`·r£_unsigÃd
(
n
, &
sc
->
³riod_size_mš
))

504  -
EINVAL
;

508 ià(
	`¡rcmp
(
id
, "period_size_max") == 0) {

509 ià(
	`·r£_unsigÃd
(
n
, &
sc
->
³riod_size_max
))

510  -
EINVAL
;

514 ià(
	`¡rcmp
(
id
, "buffer_size_min") == 0) {

515 ià(
	`·r£_unsigÃd
(
n
, &
sc
->
bufãr_size_mš
))

516  -
EINVAL
;

520 ià(
	`¡rcmp
(
id
, "buffer_size_max") == 0) {

521 ià(
	`·r£_unsigÃd
(
n
, &
sc
->
bufãr_size_max
))

522  -
EINVAL
;

526 ià(
	`¡rcmp
(
id
, "sig_bits") == 0) {

527 ià(
	`·r£_unsigÃd
(
n
, &
sc
->
sig_b™s
))

528  -
EINVAL
;

535 
	}
}

538 
	$lg_§ve_¡»am_ÿps
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

539 
lg_–em
 *
–em
,

540 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

542 
¢d_soc_lg_¡»am_ÿps
 *
sc
 = 
–em
->
¡»am_ÿps
;

543 cÚ¡ *
s
;

544 
i
;

545 
”r
, 
fœ¡
;

547 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s' {\n", 
–em
->
id
);

548 ià(
”r
 >ğ0 && 
sc
->
fÜm©s
) {

549 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tformats '");

550 
fœ¡
 = 1;

551 
i
 = 0; 
”r
 >ğ0 && i <ğ
SND_PCM_FORMAT_LAST
; i++) {

552 ià(
sc
->
fÜm©s
 & (1ULL << 
i
)) {

553 
s
 = 
	`¢d_pcm_fÜm©_Çme
(
i
);

554 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "%s%s",

555 !
fœ¡
 ? ", " : "", 
s
);

556 
fœ¡
 = 0;

559 ià(
”r
 >= 0)

560 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'\n");

562 ià(
”r
 >ğ0 && 
sc
->
¿‹s
) {

563 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\trates '");

564 
fœ¡
 = 1;

565 
i
 = 0; 
”r
 >ğ0 && i <ğ
SND_PCM_RATE_LAST
; i++) {

566 ià(
sc
->
¿‹s
 & (1ULL << 
i
)) {

567 
s
 = 
	`g‘_¿‹_Çme
(
i
);

568 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "%s%s",

569 !
fœ¡
 ? ", " : "", 
s
);

570 
fœ¡
 = 0;

573 ià(
”r
 >= 0)

574 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'\n");

576 ià(
”r
 >ğ0 && 
sc
->
¿‹_mš
)

577 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\trate_min %u\n",

578 
sc
->
¿‹_mš
);

579 ià(
”r
 >ğ0 && 
sc
->
¿‹_max
)

580 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\trate_max %u\n",

581 
sc
->
¿‹_max
);

582 ià(
”r
 >ğ0 && 
sc
->
chªÃls_mš
)

583 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tchannels_min %u\n",

584 
sc
->
chªÃls_mš
);

585 ià(
”r
 >ğ0 && 
sc
->
chªÃls_max
)

586 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tchannels_max %u\n",

587 
sc
->
chªÃls_max
);

588 ià(
”r
 >ğ0 && 
sc
->
³riods_mš
)

589 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tperiods_min %u\n",

590 
sc
->
³riods_mš
);

591 ià(
”r
 >ğ0 && 
sc
->
³riods_max
)

592 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tperiods_max %u\n",

593 
sc
->
³riods_max
);

594 ià(
”r
 >ğ0 && 
sc
->
³riod_size_mš
)

595 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tperiod_size_min %u\n",

596 
sc
->
³riod_size_mš
);

597 ià(
”r
 >ğ0 && 
sc
->
³riod_size_max
)

598 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tperiod_size_max %u\n",

599 
sc
->
³riod_size_max
);

600 ià(
”r
 >ğ0 && 
sc
->
bufãr_size_mš
)

601 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tbuffer_size_min %u\n",

602 
sc
->
bufãr_size_mš
);

603 ià(
”r
 >ğ0 && 
sc
->
bufãr_size_max
)

604 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tbuffer_size_max %u\n",

605 
sc
->
bufãr_size_max
);

606 ià(
”r
 >ğ0 && 
sc
->
sig_b™s
)

607 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tsig_bits %u\n",

608 
sc
->
sig_b™s
);

609 ià(
”r
 >= 0)

610 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

611  
”r
;

612 
	}
}

615 
	$lg_·r£_¡»ams
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

616 
¢d_cÚfig_t
 *
cfg
, *
´iv©e
)

618 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

619 
¢d_cÚfig_t
 *
n
;

620 
lg_–em
 *
–em
 = 
´iv©e
;

621 
¢d_soc_lg_pcm
 *
pcm
;

622 
¢d_soc_lg_dai
 *
dai
;

623 *
¶ayback
, *
ÿ±u»
;

624 
¢d_soc_lg_¡»am_ÿps
 *
ÿps
;

625 cÚ¡ *
id
, *
v®ue
;

626 
¡»am
;

628 
	`¢d_cÚfig_g‘_id
(
cfg
, &
id
);

630 
	`lg_dbg
("\t%s:", 
id
);

632 
–em
->
ty³
) {

633 
SND_TPLG_TYPE_PCM
:

634 
pcm
 = 
–em
->pcm;

635 
¶ayback
 = &
pcm
->playback;

636 
ÿ±u»
 = &
pcm
->capture;

637 
ÿps
 = 
pcm
->caps;

640 
SND_TPLG_TYPE_DAI
:

641 
dai
 = 
–em
->dai;

642 
¶ayback
 = &
dai
->playback;

643 
ÿ±u»
 = &
dai
->capture;

644 
ÿps
 = 
dai
->caps;

648  -
EINVAL
;

651 ià(
	`¡rcmp
(
id
, "playback") == 0) {

652 
¡»am
 = 
SND_SOC_TPLG_STREAM_PLAYBACK
;

653 
	`uÇligÃd_put32
(
¶ayback
, 1);

654 } ià(
	`¡rcmp
(
id
, "capture") == 0) {

655 
¡»am
 = 
SND_SOC_TPLG_STREAM_CAPTURE
;

656 
	`uÇligÃd_put32
(
ÿ±u»
, 1);

658  -
EINVAL
;

660 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

662 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

665 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

668 ià(
	`¡rcmp
(
id
, "capabilities") == 0) {

669 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®ue
) < 0)

674 
	`¢d_¡¾ıy
(
ÿps
[
¡»am
].
Çme
, 
v®ue
,

675 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

677 
	`lg_dbg
("\t\t%s\n\t\t\t%s", 
id
, 
v®ue
);

683 
	}
}

686 
	$lg_§ve_¡»ams
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

687 
lg_–em
 *
–em
,

688 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

690 cÚ¡ *
¡»am_ids
[2] = {

694 
¡»am_ty³s
[2] = {

695 
SND_SOC_TPLG_STREAM_PLAYBACK
,

696 
SND_SOC_TPLG_STREAM_CAPTURE


698 
¢d_soc_lg_¡»am_ÿps
 *
ÿps
;

699 
¡»ams
[2], 
¡»am
;

700 cÚ¡ *
s
;

701 
”r
;

703 
–em
->
ty³
) {

704 
SND_TPLG_TYPE_PCM
:

705 
¡»ams
[0] = 
–em
->
pcm
->
¶ayback
;

706 
¡»ams
[1] = 
–em
->
pcm
->
ÿ±u»
;

707 
ÿps
 = 
–em
->
pcm
->caps;

709 
SND_TPLG_TYPE_DAI
:

710 
¡»ams
[0] = 
–em
->
dai
->
¶ayback
;

711 
¡»ams
[1] = 
–em
->
dai
->
ÿ±u»
;

712 
ÿps
 = 
–em
->
dai
->caps;

715  -
EINVAL
;

718 
¡»am
 = 0; stream < 2; stream++) {

719 ià(
¡»ams
[
¡»am
] == 0)

721 ià(!
ÿps
)

723 
s
 = 
ÿps
[
¡»am_ty³s
[
¡»am
]].
Çme
;

724 ià(
s
[0] == '\0')

726 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "pcm.% {\n", 
¡»am_ids
[
¡»am
]);

727 ià(
”r
 < 0)

728  
”r
;

729 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tÿ·b™› '%s'\n", 
s
);

730 ià(
”r
 < 0)

731  
”r
;

732 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

733 ià(
”r
 < 0)

734  
”r
;

738 
	}
}

741 
	$lg_·r£_ã_dai
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

742 
¢d_cÚfig_t
 *
cfg
, *
´iv©e
)

744 
lg_–em
 *
–em
 = 
´iv©e
;

745 
¢d_soc_lg_pcm
 *
pcm
 = 
–em
->pcm;

746 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

747 
¢d_cÚfig_t
 *
n
;

748 cÚ¡ *
id
;

749 
dai_id
;

751 
	`¢d_cÚfig_g‘_id
(
cfg
, &
id
);

752 
	`lg_dbg
("\t\tFE DAI %s:", 
id
);

753 
	`¢d_¡¾ıy
(
pcm
->
dai_Çme
, 
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

755 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

757 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

760 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

763 ià(
	`¡rcmp
(
id
, "id") == 0) {

764 ià(
	`lg_g‘_unsigÃd
(
n
, &
dai_id
, 0)) {

765 
	`SNDERR
("invalid fe dai ID");

766  -
EINVAL
;

769 
	`uÇligÃd_put32
(&
pcm
->
dai_id
, dai_id);

770 
	`lg_dbg
("\t\t\tšdex: %d", 
dai_id
);

775 
	}
}

778 
	$lg_§ve_ã_dai
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

779 
lg_–em
 *
–em
,

780 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

782 
¢d_soc_lg_pcm
 *
pcm
 = 
–em
->pcm;

783 
”r
 = 0;

785 ià(
	`¡¾’
(
pcm
->
dai_Çme
))

786 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "dai.'%s'.id %u\n", 
pcm
->
dai_Çme
,…cm->
dai_id
);

787 ià(
pcm
->
dai_id
 > 0)

788 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "dai.0.id %u\n", 
pcm
->
dai_id
);

789  
”r
;

790 
	}
}

793 
	$·r£_æag
(
¢d_cÚfig_t
 *
n
, 
mask_š
,

794 *
mask
, *
æags
)

796 
»t
;

798 
»t
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

799 ià(
»t
 < 0)

800  
»t
;

802 
	`uÇligÃd_put32
(
mask
, 
	`uÇligÃd_g‘32
(maskè| 
mask_š
);

803 ià(
»t
)

804 
	`uÇligÃd_put32
(
æags
, 
	`uÇligÃd_g‘32
(æagsè| 
mask_š
);

806 
	`uÇligÃd_put32
(
æags
, 
	`uÇligÃd_g‘32
(æagsè& (~
mask_š
));

809 
	}
}

811 
	$§ve_æags
(
æags
, 
mask
,

812 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

814 
æag_masks
[4] = {

815 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_RATES
,

816 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_CHANNELS
,

817 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_SAMPLEBITS
,

818 
SND_SOC_TPLG_LNK_FLGBIT_VOICE_WAKEUP
,

820 cÚ¡ *
æag_ids
[4] = {

826 
i
;

827 
”r
 = 0;

829 
i
 = 0; 
”r
 >ğ0 && i < 
	`ARRAY_SIZE
(
æag_masks
); i++) {

830 ià(
mask
 & 
æag_masks
[
i
]) {

831 
v
 = (
æags
 & 
æag_masks
[
i
]) ? 1 : 0;

832 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "%s %u\n",

833 
æag_ids
[
i
], 
v
);

836  
”r
;

837 
	}
}

840 
	$lg_·r£_pcm
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

841 *
´iv©e
 
ATTRIBUTE_UNUSED
)

843 
¢d_soc_lg_pcm
 *
pcm
;

844 
lg_–em
 *
–em
;

845 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

846 
¢d_cÚfig_t
 *
n
;

847 cÚ¡ *
id
;

848 
”r
, 
iv®
;

850 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_PCM
);

851 ià(!
–em
)

852  -
ENOMEM
;

854 
pcm
 = 
–em
->pcm;

855 
pcm
->
size
 = 
–em
->size;

856 
	`¢d_¡¾ıy
(
pcm
->
pcm_Çme
, 
–em
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

858 
	`lg_dbg
(" PCM: %s", 
–em
->
id
);

860 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

862 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

863 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

867 ià(
	`¡rcmp
(
id
, "comment") == 0)

869 ià(
id
[0] == '#')

872 ià(
	`¡rcmp
(
id
, "id") == 0) {

873 ià(
	`·r£_unsigÃd
(
n
, &
pcm
->
pcm_id
))

874  -
EINVAL
;

878 ià(
	`¡rcmp
(
id
, "pcm") == 0) {

879 
”r
 = 
	`lg_·r£_compound
(
lg
, 
n
,

880 
lg_·r£_¡»ams
, 
–em
);

881 ià(
”r
 < 0)

882  
”r
;

886 ià(
	`¡rcmp
(
id
, "compress") == 0) {

887 
iv®
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

888 ià(
iv®
 < 0)

889  -
EINVAL
;

891 
pcm
->
com´ess
 = 
iv®
;

893 
	`lg_dbg
("\t%s: %d", 
id
, 
iv®
);

897 ià(
	`¡rcmp
(
id
, "dai") == 0) {

898 
”r
 = 
	`lg_·r£_compound
(
lg
, 
n
,

899 
lg_·r£_ã_dai
, 
–em
);

900 ià(
”r
 < 0)

901  
”r
;

906 ià(
	`¡rcmp
(
id
, "symmetric_rates") == 0) {

907 
”r
 = 
	`·r£_æag
(
n
,

908 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_RATES
,

909 &
pcm
->
æag_mask
, &pcm->
æags
);

910 ià(
”r
 < 0)

911  
”r
;

915 ià(
	`¡rcmp
(
id
, "symmetric_channels") == 0) {

916 
”r
 = 
	`·r£_æag
(
n
,

917 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_CHANNELS
,

918 &
pcm
->
æag_mask
, &pcm->
æags
);

919 ià(
”r
 < 0)

920  
”r
;

924 ià(
	`¡rcmp
(
id
, "symmetric_sample_bits") == 0) {

925 
”r
 = 
	`·r£_æag
(
n
,

926 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_SAMPLEBITS
,

927 &
pcm
->
æag_mask
, &pcm->
æags
);

928 ià(
”r
 < 0)

929  
”r
;

933 ià(
	`¡rcmp
(
id
, "ignore_suspend") == 0) {

934 
”r
 = 
	`·r£_æag
(
n
,

935 
SND_SOC_TPLG_LNK_FLGBIT_VOICE_WAKEUP
,

936 &
pcm
->
æag_mask
, &pcm->
æags
);

937 ià(
”r
 < 0)

938  
”r
;

943 ià(
	`¡rcmp
(
id
, "data") == 0) {

944 
”r
 = 
	`lg_·r£_»fs
(
n
, 
–em
, 
SND_TPLG_TYPE_DATA
);

945 ià(
”r
 < 0)

946  
”r
;

952 
	}
}

955 
	$lg_§ve_pcm
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

956 
lg_–em
 *
–em
,

957 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

959 
¢d_soc_lg_pcm
 *
pcm
 = 
–em
->pcm;

960 
pfx2
[16];

961 
”r
;

963 
	`¢´štf
(
pfx2
, Õfx2), "%s\t", 
pfx
 ?: "");

964 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s' {\n", 
–em
->
id
);

965 ià(
”r
 >ğ0 && 
–em
->
šdex
)

966 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tindex %u\n",

967 
–em
->
šdex
);

968 ià(
”r
 >ğ0 && 
pcm
->
pcm_id
)

969 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tid %u\n",

970 
pcm
->
pcm_id
);

971 ià(
”r
 >ğ0 && 
pcm
->
com´ess
)

972 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tcompress 1\n");

973 
	`¢´štf
(
pfx2
, Õfx2), "%s\t", 
pfx
 ?: "");

974 ià(
”r
 >= 0)

975 
”r
 = 
	`lg_§ve_ã_dai
(
lg
, 
–em
, 
d¡
, 
pfx2
);

976 ià(
”r
 >= 0)

977 
”r
 = 
	`lg_§ve_¡»ams
(
lg
, 
–em
, 
d¡
, 
pfx2
);

978 ià(
”r
 >= 0)

979 
”r
 = 
	`§ve_æags
(
pcm
->
æags
,…cm->
æag_mask
, 
d¡
, 
pfx
);

980 ià(
”r
 >= 0)

981 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_DATA
,

982 "d©a", 
d¡
, 
pfx2
);

983 ià(
”r
 >= 0)

984 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

985  
”r
;

986 
	}
}

989 
	$lg_·r£_dai
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

990 *
´iv©e
 
ATTRIBUTE_UNUSED
)

992 
¢d_soc_lg_dai
 *
dai
;

993 
lg_–em
 *
–em
;

994 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

995 
¢d_cÚfig_t
 *
n
;

996 cÚ¡ *
id
;

997 
”r
;

999 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_DAI
);

1000 ià(!
–em
)

1001  -
ENOMEM
;

1003 
dai
 = 
–em
->dai;

1004 
dai
->
size
 = 
–em
->size;

1005 
	`¢d_¡¾ıy
(
dai
->
dai_Çme
, 
–em
->
id
,

1006 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1008 
	`lg_dbg
(" DAI: %s", 
–em
->
id
);

1010 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1012 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1013 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1017 ià(
	`¡rcmp
(
id
, "comment") == 0)

1019 ià(
id
[0] == '#')

1022 ià(
	`¡rcmp
(
id
, "id") == 0) {

1023 ià(
	`·r£_unsigÃd
(
n
, &
dai
->
dai_id
))

1024  -
EINVAL
;

1028 ià(
	`¡rcmp
(
id
, "playback") == 0) {

1029 ià(
	`·r£_unsigÃd
(
n
, &
dai
->
¶ayback
))

1030  -
EINVAL
;

1035 ià(
	`¡rcmp
(
id
, "capture") == 0) {

1036 ià(
	`·r£_unsigÃd
(
n
, &
dai
->
ÿ±u»
))

1037  -
EINVAL
;

1043 ià(
	`¡rcmp
(
id
, "pcm") == 0) {

1044 
”r
 = 
	`lg_·r£_compound
(
lg
, 
n
,

1045 
lg_·r£_¡»ams
, 
–em
);

1046 ià(
”r
 < 0)

1047  
”r
;

1052 ià(
	`¡rcmp
(
id
, "symmetric_rates") == 0) {

1053 
”r
 = 
	`·r£_æag
(
n
,

1054 
SND_SOC_TPLG_DAI_FLGBIT_SYMMETRIC_RATES
,

1055 &
dai
->
æag_mask
, &dai->
æags
);

1056 ià(
”r
 < 0)

1057  
”r
;

1061 ià(
	`¡rcmp
(
id
, "symmetric_channels") == 0) {

1062 
”r
 = 
	`·r£_æag
(
n
,

1063 
SND_SOC_TPLG_DAI_FLGBIT_SYMMETRIC_CHANNELS
,

1064 &
dai
->
æag_mask
, &dai->
æags
);

1065 ià(
”r
 < 0)

1066  
”r
;

1070 ià(
	`¡rcmp
(
id
, "symmetric_sample_bits") == 0) {

1071 
”r
 = 
	`·r£_æag
(
n
,

1072 
SND_SOC_TPLG_DAI_FLGBIT_SYMMETRIC_SAMPLEBITS
,

1073 &
dai
->
æag_mask
, &dai->
æags
);

1074 ià(
”r
 < 0)

1075  
”r
;

1079 ià(
	`¡rcmp
(
id
, "ignore_suspend") == 0) {

1080 
”r
 = 
	`·r£_æag
(
n
,

1081 
SND_SOC_TPLG_LNK_FLGBIT_VOICE_WAKEUP
,

1082 &
dai
->
æag_mask
, &dai->
æags
);

1083 ià(
”r
 < 0)

1084  
”r
;

1089 ià(
	`¡rcmp
(
id
, "data") == 0) {

1090 
”r
 = 
	`lg_·r£_»fs
(
n
, 
–em
, 
SND_TPLG_TYPE_DATA
);

1091 ià(
”r
 < 0)

1092  
”r
;

1098 
	}
}

1101 
	$lg_§ve_dai
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

1102 
lg_–em
 *
–em
,

1103 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

1105 
¢d_soc_lg_dai
 *
dai
 = 
–em
->dai;

1106 
pfx2
[16];

1107 
”r
;

1109 ià(!
dai
)

1111 
	`¢´štf
(
pfx2
, Õfx2), "%s\t", 
pfx
 ?: "");

1112 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s' {\n", 
–em
->
id
);

1113 ià(
”r
 >ğ0 && 
–em
->
šdex
)

1114 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tindex %u\n",

1115 
–em
->
šdex
);

1116 ià(
”r
 >ğ0 && 
dai
->
dai_id
)

1117 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tid %u\n",

1118 
dai
->
dai_id
);

1119 ià(
”r
 >ğ0 && 
dai
->
¶ayback
)

1120 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tplayback %u\n",

1121 
dai
->
¶ayback
);

1122 ià(
”r
 >ğ0 && 
dai
->
ÿ±u»
)

1123 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tcapture %u\n",

1124 
dai
->
ÿ±u»
);

1125 ià(
”r
 >= 0)

1126 
”r
 = 
	`lg_§ve_¡»ams
(
lg
, 
–em
, 
d¡
, 
pfx2
);

1127 ià(
”r
 >= 0)

1128 
”r
 = 
	`§ve_æags
(
dai
->
æags
, dai->
æag_mask
, 
d¡
, 
pfx
);

1129 ià(
”r
 >= 0)

1130 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_DATA
,

1131 "d©a", 
d¡
, 
pfx2
);

1132 ià(
”r
 >= 0)

1133 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

1134  
”r
;

1135 
	}
}

1138 
	$·r£_hw_cÚfig_»fs
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

1139 
¢d_cÚfig_t
 *
cfg
,

1140 
lg_–em
 *
–em
)

1142 
¢d_soc_lg_lšk_cÚfig
 *
lšk
 = 
–em
->link;

1143 
”r
;

1145 
”r
 = 
	`lg_·r£_»fs
(
cfg
, 
–em
, 
SND_TPLG_TYPE_HW_CONFIG
);

1146 ià(
”r
 < 0)

1147  
”r
;

1148 
lšk
->
num_hw_cÚfigs
 = 
”r
;

1150 
	}
}

1153 
	$lg_·r£_lšk
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

1154 *
´iv©e
 
ATTRIBUTE_UNUSED
)

1156 
¢d_soc_lg_lšk_cÚfig
 *
lšk
;

1157 
lg_–em
 *
–em
;

1158 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1159 
¢d_cÚfig_t
 *
n
;

1160 cÚ¡ *
id
, *
v®
 = 
NULL
;

1161 
”r
;

1163 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_BE
);

1164 ià(!
–em
)

1165  -
ENOMEM
;

1167 
lšk
 = 
–em
->link;

1168 
lšk
->
size
 = 
–em
->size;

1169 
	`¢d_¡¾ıy
(
lšk
->
Çme
, 
–em
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1171 
	`lg_dbg
(" Lšk: %s", 
–em
->
id
);

1173 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1175 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1176 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1180 ià(
	`¡rcmp
(
id
, "comment") == 0)

1182 ià(
id
[0] == '#')

1185 ià(
	`¡rcmp
(
id
, "id") == 0) {

1186 ià(
	`·r£_unsigÃd
(
n
, &
lšk
->
id
))

1187  -
EINVAL
;

1191 ià(
	`¡rcmp
(
id
, "stream_name") == 0) {

1192 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®
) < 0)

1193  -
EINVAL
;

1195 
	`¢d_¡¾ıy
(
lšk
->
¡»am_Çme
, 
v®
,

1196 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1197 
	`lg_dbg
("\t%s: %s", 
id
, 
v®
);

1201 ià(
	`¡rcmp
(
id
, "hw_configs") == 0) {

1202 
”r
 = 
	`·r£_hw_cÚfig_»fs
(
lg
, 
n
, 
–em
);

1203 ià(
”r
 < 0)

1204  
”r
;

1208 ià(
	`¡rcmp
(
id
, "default_hw_conf_id") == 0) {

1209 ià(
	`·r£_unsigÃd
(
n
, &
lšk
->
deçuÉ_hw_cÚfig_id
))

1210  -
EINVAL
;

1215 ià(
	`¡rcmp
(
id
, "symmetric_rates") == 0) {

1216 
”r
 = 
	`·r£_æag
(
n
,

1217 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_RATES
,

1218 &
lšk
->
æag_mask
, &lšk->
æags
);

1219 ià(
”r
 < 0)

1220  
”r
;

1224 ià(
	`¡rcmp
(
id
, "symmetric_channels") == 0) {

1225 
”r
 = 
	`·r£_æag
(
n
,

1226 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_CHANNELS
,

1227 &
lšk
->
æag_mask
, &lšk->
æags
);

1228 ià(
”r
 < 0)

1229  
”r
;

1233 ià(
	`¡rcmp
(
id
, "symmetric_sample_bits") == 0) {

1234 
”r
 = 
	`·r£_æag
(
n
,

1235 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_SAMPLEBITS
,

1236 &
lšk
->
æag_mask
, &lšk->
æags
);

1237 ià(
”r
 < 0)

1238  
”r
;

1242 ià(
	`¡rcmp
(
id
, "ignore_suspend") == 0) {

1243 
”r
 = 
	`·r£_æag
(
n
,

1244 
SND_SOC_TPLG_LNK_FLGBIT_VOICE_WAKEUP
,

1245 &
lšk
->
æag_mask
, &lšk->
æags
);

1246 ià(
”r
 < 0)

1247  
”r
;

1252 ià(
	`¡rcmp
(
id
, "data") == 0) {

1253 
”r
 = 
	`lg_·r£_»fs
(
n
, 
–em
, 
SND_TPLG_TYPE_DATA
);

1254 ià(
”r
 < 0)

1255  
”r
;

1261 
	}
}

1264 
	$lg_§ve_lšk
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

1265 
lg_–em
 *
–em
,

1266 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

1268 
¢d_soc_lg_lšk_cÚfig
 *
lšk
 = 
–em
->link;

1269 
pfx2
[16];

1270 
”r
;

1272 ià(!
lšk
)

1274 
	`¢´štf
(
pfx2
, Õfx2), "%s\t", 
pfx
 ?: "");

1275 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s' {\n", 
–em
->
id
);

1276 ià(
”r
 >ğ0 && 
–em
->
šdex
)

1277 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tindex %u\n",

1278 
–em
->
šdex
);

1279 ià(
”r
 >ğ0 && 
lšk
->
id
)

1280 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tid %u\n",

1281 
lšk
->
id
);

1282 ià(
”r
 >ğ0 && 
lšk
->
¡»am_Çme
[0])

1283 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tstream_name '%s'\n",

1284 
lšk
->
¡»am_Çme
);

1285 ià(
”r
 >ğ0 && 
lšk
->
deçuÉ_hw_cÚfig_id
)

1286 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tdefault_hw_conf_id %u\n",

1287 
lšk
->
deçuÉ_hw_cÚfig_id
);

1288 ià(
”r
 >= 0)

1289 
”r
 = 
	`§ve_æags
(
lšk
->
æags
,†šk->
æag_mask
, 
d¡
, 
pfx
);

1290 ià(
”r
 >= 0)

1291 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_HW_CONFIG
,

1292 "hw_cÚfigs", 
d¡
, 
pfx2
);

1293 ià(
”r
 >= 0)

1294 
”r
 = 
	`lg_§ve_»fs
(
lg
, 
–em
, 
SND_TPLG_TYPE_DATA
,

1295 "d©a", 
d¡
, 
pfx2
);

1296 ià(
”r
 >= 0)

1297 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

1298  
”r
;

1299 
	}
}

1302 
	$lg_·r£_cc
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

1303 *
´iv©e
 
ATTRIBUTE_UNUSED
)

1305 
¢d_soc_lg_lšk_cÚfig
 *
lšk
;

1306 
lg_–em
 *
–em
;

1307 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1308 
¢d_cÚfig_t
 *
n
;

1309 cÚ¡ *
id
;

1311 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_CC
);

1312 ià(!
–em
)

1313  -
ENOMEM
;

1315 
lšk
 = 
–em
->link;

1316 
lšk
->
size
 = 
–em
->size;

1318 
	`lg_dbg
(" CC: %s", 
–em
->
id
);

1320 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1322 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1323 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1327 ià(
	`¡rcmp
(
id
, "comment") == 0)

1329 ià(
id
[0] == '#')

1332 ià(
	`¡rcmp
(
id
, "id") == 0) {

1333 ià(
	`·r£_unsigÃd
(
n
, &
lšk
->
id
))

1334  -
EINVAL
;

1341 
	}
}

1344 
	$lg_§ve_cc
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

1345 
lg_–em
 *
–em
,

1346 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

1348 
¢d_soc_lg_lšk_cÚfig
 *
lšk
 = 
–em
->link;

1349 
pfx2
[16];

1350 
”r
;

1352 ià(!
lšk
)

1354 
	`¢´štf
(
pfx2
, Õfx2), "%s\t", 
pfx
 ?: "");

1355 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s' {\n", 
–em
->
id
);

1356 ià(
”r
 >ğ0 && 
–em
->
šdex
)

1357 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tindex %u\n",

1358 
–em
->
šdex
);

1359 ià(
”r
 >ğ0 && 
lšk
->
id
)

1360 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tid %u\n",

1361 
lšk
->
id
);

1362 ià(
”r
 >= 0)

1363 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

1364  
”r
;

1365 
	}
}

1367 #iâdeà
DOC_HIDDEN


1368 
	saudio_hw_fÜm©
 {

1369 
	mty³
;

1370 cÚ¡ *
	mÇme
;

1374 
audio_hw_fÜm©
 
	gaudio_hw_fÜm©s
[] = {

1376 .
ty³
 = 
SND_SOC_DAI_FORMAT_I2S
,

1377 .
	gÇme
 = "I2S",

1380 .
	gty³
 = 
SND_SOC_DAI_FORMAT_RIGHT_J
,

1381 .
	gÇme
 = "RIGHT_J",

1384 .
	gty³
 = 
SND_SOC_DAI_FORMAT_LEFT_J
,

1385 .
	gÇme
 = "LEFT_J",

1388 .
	gty³
 = 
SND_SOC_DAI_FORMAT_DSP_A
,

1389 .
	gÇme
 = "DSP_A",

1392 .
	gty³
 = 
SND_SOC_DAI_FORMAT_DSP_B
,

1393 .
	gÇme
 = "DSP_B",

1396 .
	gty³
 = 
SND_SOC_DAI_FORMAT_AC97
,

1397 .
	gÇme
 = "AC97",

1400 .
	gty³
 = 
SND_SOC_DAI_FORMAT_PDM
,

1401 .
	gÇme
 = "PDM",

1405 
	$g‘_audio_hw_fÜm©
(cÚ¡ *
v®
)

1407 
i
;

1409 ià(
v®
[0] == '\0')

1410  -
EINVAL
;

1412 
i
 = 0; i < 
	`ARRAY_SIZE
(
audio_hw_fÜm©s
); i++)

1413 ià(
	`¡rÿ£cmp
(
audio_hw_fÜm©s
[
i
].
Çme
, 
v®
) == 0)

1414  
audio_hw_fÜm©s
[
i
].
ty³
;

1416 
	`SNDERR
("šv®id‡udiØHW fÜm© %s", 
v®
);

1417  -
EINVAL
;

1418 
	}
}

1420 cÚ¡ *
	$g‘_audio_hw_fÜm©_Çme
(
ty³
)

1422 
i
;

1424 
i
 = 0; i < 
	`ARRAY_SIZE
(
audio_hw_fÜm©s
); i++)

1425 ià(
audio_hw_fÜm©s
[
i
].
ty³
 ==ype)

1426  
audio_hw_fÜm©s
[
i
].
Çme
;

1427  
NULL
;

1428 
	}
}

1430 
	$lg_·r£_hw_cÚfig
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

1431 *
´iv©e
 
ATTRIBUTE_UNUSED
)

1434 
¢d_soc_lg_hw_cÚfig
 *
hw_cfg
;

1435 
lg_–em
 *
–em
;

1436 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1437 
¢d_cÚfig_t
 *
n
;

1438 cÚ¡ *
id
, *
v®
 = 
NULL
;

1439 
»t
, 
iv®
;

1440 
boŞ
 
´ovid”_Ëgacy
;

1442 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_HW_CONFIG
);

1443 ià(!
–em
)

1444  -
ENOMEM
;

1446 
hw_cfg
 = 
–em
->hw_cfg;

1447 
hw_cfg
->
size
 = 
–em
->size;

1449 
	`lg_dbg
(" Lšk HW cÚfig: %s", 
–em
->
id
);

1451 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1453 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1454 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1458 ià(
	`¡rcmp
(
id
, "comment") == 0)

1460 ià(
id
[0] == '#')

1463 ià(
	`¡rcmp
(
id
, "id") == 0) {

1464 ià(
	`·r£_unsigÃd
(
n
, &
hw_cfg
->
id
))

1465  -
EINVAL
;

1469 ià(
	`¡rcmp
(
id
, "format") == 0 ||

1470 
	`¡rcmp
(
id
, "fmt") == 0) {

1471 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®
) < 0)

1472  -
EINVAL
;

1474 
»t
 = 
	`g‘_audio_hw_fÜm©
(
v®
);

1475 ià(
»t
 < 0)

1476  
»t
;

1477 
hw_cfg
->
fmt
 = 
»t
;

1481 
´ovid”_Ëgacy
 = 
çl£
;

1482 ià(
	`¡rcmp
(
id
, "bclk_master") == 0) {

1483 
	`SNDERR
("d•»ÿ‹d o±iÚ %s,…Ëa£ u£ 'bşk'", 
id
);

1484 
´ovid”_Ëgacy
 = 
Œue
;

1487 ià(
´ovid”_Ëgacy
 ||

1488 
	`¡rcmp
(
id
, "bclk") == 0) {

1490 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®
) < 0)

1491  -
EINVAL
;

1493 ià(!
	`¡rcmp
(
v®
, "master")) {

1497 
	`SNDERR
("d•»ÿ‹d bşk v®u'%s'", 
v®
);

1499 
hw_cfg
->
bşk_´ovid”
 = 
SND_SOC_TPLG_BCLK_CC
;

1500 } ià(!
	`¡rcmp
(
v®
, "codec_slave")) {

1501 
	`SNDERR
("d•»ÿ‹d bşk v®u'%s', u£ 'codec_cÚsum”'", 
v®
);

1503 
hw_cfg
->
bşk_´ovid”
 = 
SND_SOC_TPLG_BCLK_CC
;

1504 } ià(!
	`¡rcmp
(
v®
, "codec_consumer")) {

1505 
hw_cfg
->
bşk_´ovid”
 = 
SND_SOC_TPLG_BCLK_CC
;

1506 } ià(!
	`¡rcmp
(
v®
, "codec_master")) {

1507 
	`SNDERR
("d•»ÿ‹d bşk v®u'%s', u£ 'codec_´ovid”", 
v®
);

1509 
hw_cfg
->
bşk_´ovid”
 = 
SND_SOC_TPLG_BCLK_CP
;

1510 } ià(!
	`¡rcmp
(
v®
, "codec_provider")) {

1511 
hw_cfg
->
bşk_´ovid”
 = 
SND_SOC_TPLG_BCLK_CP
;

1516 ià(
	`¡rcmp
(
id
, "bclk_freq") == 0 ||

1517 
	`¡rcmp
(
id
, "bclk_rate") == 0) {

1518 ià(
	`·r£_unsigÃd
(
n
, &
hw_cfg
->
bşk_¿‹
))

1519  -
EINVAL
;

1523 ià(
	`¡rcmp
(
id
, "bclk_invert") == 0 ||

1524 
	`¡rcmp
(
id
, "invert_bclk") == 0) {

1525 
iv®
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

1526 ià(
iv®
 < 0)

1527  -
EINVAL
;

1529 
hw_cfg
->
šv”t_bşk
 = 
iv®
;

1533 
´ovid”_Ëgacy
 = 
çl£
;

1534 ià(
	`¡rcmp
(
id
, "fsync_master") == 0) {

1535 
	`SNDERR
("d•»ÿ‹d o±iÚ %s,…Ëa£ u£ 'fsync'", 
id
);

1536 
´ovid”_Ëgacy
 = 
Œue
;

1539 ià(
´ovid”_Ëgacy
 ||

1540 
	`¡rcmp
(
id
, "fsync") == 0) {

1542 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®
) < 0)

1543  -
EINVAL
;

1545 ià(!
	`¡rcmp
(
v®
, "master")) {

1549 
	`SNDERR
("d•»ÿ‹d fsynøv®u'%s'", 
v®
);

1551 
hw_cfg
->
fsync_´ovid”
 = 
SND_SOC_TPLG_FSYNC_CC
;

1552 } ià(!
	`¡rcmp
(
v®
, "codec_slave")) {

1553 
	`SNDERR
("d•»ÿ‹d fsynøv®u'%s', u£ 'codec_cÚsum”'", 
v®
);

1555 
hw_cfg
->
fsync_´ovid”
 = 
SND_SOC_TPLG_FSYNC_CC
;

1556 } ià(!
	`¡rcmp
(
v®
, "codec_consumer")) {

1557 
hw_cfg
->
fsync_´ovid”
 = 
SND_SOC_TPLG_FSYNC_CC
;

1558 } ià(!
	`¡rcmp
(
v®
, "codec_master")) {

1559 
	`SNDERR
("d•»ÿ‹d fsynøv®u'%s', u£ 'codec_´ovid”'", 
v®
);

1561 
hw_cfg
->
fsync_´ovid”
 = 
SND_SOC_TPLG_FSYNC_CP
;

1562 } ià(!
	`¡rcmp
(
v®
, "codec_provider")) {

1563 
hw_cfg
->
fsync_´ovid”
 = 
SND_SOC_TPLG_FSYNC_CP
;

1568 ià(
	`¡rcmp
(
id
, "fsync_invert") == 0 ||

1569 
	`¡rcmp
(
id
, "invert_fsync") == 0) {

1570 
iv®
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

1571 ià(
iv®
 < 0)

1572  -
EINVAL
;

1574 
hw_cfg
->
šv”t_fsync
 = 
iv®
;

1578 ià(
	`¡rcmp
(
id
, "fsync_freq") == 0 ||

1579 
	`¡rcmp
(
id
, "fsync_rate") == 0) {

1580 ià(
	`·r£_unsigÃd
(
n
, &
hw_cfg
->
fsync_¿‹
))

1581  -
EINVAL
;

1585 ià(
	`¡rcmp
(
id
, "mclk_freq") == 0 ||

1586 
	`¡rcmp
(
id
, "mclk_rate") == 0) {

1587 ià(
	`·r£_unsigÃd
(
n
, &
hw_cfg
->
mşk_¿‹
))

1588  -
EINVAL
;

1592 ià(
	`¡rcmp
(
id
, "mclk") == 0 ||

1593 
	`¡rcmp
(
id
, "mclk_direction") == 0) {

1594 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®
) < 0)

1595  -
EINVAL
;

1597 ià(!
	`¡rcmp
(
v®
, "master")) {

1601 
	`SNDERR
("d•»ÿ‹d mşk v®u'%s'", 
v®
);

1603 
hw_cfg
->
mşk_dœeùiÚ
 = 
SND_SOC_TPLG_MCLK_CI
;

1604 } ià(!
	`¡rcmp
(
v®
, "codec_mclk_in")) {

1605 
hw_cfg
->
mşk_dœeùiÚ
 = 
SND_SOC_TPLG_MCLK_CI
;

1606 } ià(!
	`¡rcmp
(
v®
, "codec_mclk_out")) {

1607 
hw_cfg
->
mşk_dœeùiÚ
 = 
SND_SOC_TPLG_MCLK_CO
;

1612 ià(
	`¡rcmp
(
id
, "pm_gate_clocks") == 0 ||

1613 
	`¡rcmp
(
id
, "clock_gated") == 0) {

1614 
iv®
 = 
	`¢d_cÚfig_g‘_boŞ
(
n
);

1615 ià(
iv®
 < 0)

1616  -
EINVAL
;

1618 ià(
iv®
)

1619 
hw_cfg
->
şock_g©ed
 =

1620 
SND_SOC_TPLG_DAI_CLK_GATE_GATED
;

1622 
hw_cfg
->
şock_g©ed
 =

1623 
SND_SOC_TPLG_DAI_CLK_GATE_CONT
;

1627 ià(
	`¡rcmp
(
id
, "tdm_slots") == 0) {

1628 ià(
	`·r£_unsigÃd
(
n
, &
hw_cfg
->
tdm_¦Ùs
))

1629  -
EINVAL
;

1633 ià(
	`¡rcmp
(
id
, "tdm_slot_width") == 0) {

1634 ià(
	`·r£_unsigÃd
(
n
, &
hw_cfg
->
tdm_¦Ù_width
))

1635  -
EINVAL
;

1639 ià(
	`¡rcmp
(
id
, "tx_slots") == 0) {

1640 ià(
	`·r£_unsigÃd
(
n
, &
hw_cfg
->
tx_¦Ùs
))

1641  -
EINVAL
;

1645 ià(
	`¡rcmp
(
id
, "rx_slots") == 0) {

1646 ià(
	`·r£_unsigÃd
(
n
, &
hw_cfg
->
rx_¦Ùs
))

1647  -
EINVAL
;

1651 ià(
	`¡rcmp
(
id
, "tx_channels") == 0) {

1652 ià(
	`·r£_unsigÃd
(
n
, &
hw_cfg
->
tx_chªÃls
))

1653  -
EINVAL
;

1657 ià(
	`¡rcmp
(
id
, "rx_channels") == 0) {

1658 ià(
	`·r£_unsigÃd
(
n
, &
hw_cfg
->
rx_chªÃls
))

1659  -
EINVAL
;

1666 
	}
}

1669 
	$lg_§ve_hw_cÚfig
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

1670 
lg_–em
 *
–em
,

1671 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

1673 
¢d_soc_lg_hw_cÚfig
 *
hc
 = 
–em
->
hw_cfg
;

1674 
”r
;

1676 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s' {\n", 
–em
->
id
);

1677 ià(
”r
 >ğ0 && 
hc
->
id
)

1678 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tid %u\n",

1679 
hc
->
id
);

1680 ià(
”r
 >ğ0 && 
hc
->
fmt
)

1681 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tformat '%s'\n",

1682 
	`g‘_audio_hw_fÜm©_Çme
(
hc
->
fmt
));

1683 ià(
”r
 >ğ0 && 
hc
->
bşk_´ovid”
)

1684 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tbclk '%s'\n",

1685 
hc
->
bşk_´ovid”
 =ğ
SND_SOC_TPLG_BCLK_CC
 ?

1687 ià(
”r
 >ğ0 && 
hc
->
bşk_¿‹
)

1688 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tbclk_freq %u\n",

1689 
hc
->
bşk_¿‹
);

1690 ià(
”r
 >ğ0 && 
hc
->
šv”t_bşk
)

1691 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tbclk_invert 1\n");

1692 ià(
”r
 >ğ0 && 
hc
->
fsync_´ovid”
)

1693 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tfsync_provider '%s'\n",

1694 
hc
->
fsync_´ovid”
 =ğ
SND_SOC_TPLG_FSYNC_CC
 ?

1696 ià(
”r
 >ğ0 && 
hc
->
fsync_¿‹
)

1697 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tfsync_freq %u\n",

1698 
hc
->
fsync_¿‹
);

1699 ià(
”r
 >ğ0 && 
hc
->
šv”t_fsync
)

1700 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tfsync_invert 1\n");

1701 ià(
”r
 >ğ0 && 
hc
->
mşk_¿‹
)

1702 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tmclk_freq %u\n",

1703 
hc
->
mşk_¿‹
);

1704 ià(
”r
 >ğ0 && 
hc
->
mşk_dœeùiÚ
)

1705 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tmclk '%s'\n",

1706 
hc
->
mşk_dœeùiÚ
 =ğ
SND_SOC_TPLG_MCLK_CI
 ?

1708 ià(
”r
 >ğ0 && 
hc
->
şock_g©ed
)

1709 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\tpm_gate_clocks 1\n");

1710 ià(
”r
 >ğ0 && 
hc
->
tdm_¦Ùs
)

1711 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\ttdm_slots %u\n",

1712 
hc
->
tdm_¦Ùs
);

1713 ià(
”r
 >ğ0 && 
hc
->
tdm_¦Ù_width
)

1714 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\ttdm_slot_width %u\n",

1715 
hc
->
tdm_¦Ù_width
);

1716 ià(
”r
 >ğ0 && 
hc
->
tx_¦Ùs
)

1717 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\ttx_slots %u\n",

1718 
hc
->
tx_¦Ùs
);

1719 ià(
”r
 >ğ0 && 
hc
->
rx_¦Ùs
)

1720 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\trx_slots %u\n",

1721 
hc
->
rx_¦Ùs
);

1722 ià(
”r
 >ğ0 && 
hc
->
tx_chªÃls
)

1723 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\ttx_channels %u\n",

1724 
hc
->
tx_chªÃls
);

1725 ià(
”r
 >ğ0 && 
hc
->
rx_chªÃls
)

1726 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\trx_channels %u\n",

1727 
hc
->
rx_chªÃls
);

1728 ià(
”r
 >= 0)

1729 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "}\n");

1730  
”r
;

1731 
	}
}

1734 
	$lg_add_¡»am_objeù
(
¢d_soc_lg_¡»am
 *
¡rm
,

1735 
¢d_lg_¡»am_‹m¶©e
 *
¡rm_l
)

1737 
	`¢d_¡¾ıy
(
¡rm
->
Çme
, 
¡rm_l
->name,

1738 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1739 
¡rm
->
fÜm©
 = 
¡rm_l
->format;

1740 
¡rm
->
¿‹
 = 
¡rm_l
->rate;

1741 
¡rm
->
³riod_by‹s
 = 
¡rm_l
->period_bytes;

1742 
¡rm
->
bufãr_by‹s
 = 
¡rm_l
->buffer_bytes;

1743 
¡rm
->
chªÃls
 = 
¡rm_l
->channels;

1744 
	}
}

1746 
	$lg_add_¡»am_ÿps
(
¢d_lg_t
 *
lg
,

1747 
¢d_lg_¡»am_ÿps_‹m¶©e
 *
ÿps_l
)

1749 
¢d_soc_lg_¡»am_ÿps
 *
ÿps
;

1750 
lg_–em
 *
–em
;

1752 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
, 
ÿps_l
->
Çme
,

1753 
SND_TPLG_TYPE_STREAM_CAPS
);

1754 ià(!
–em
)

1755  -
ENOMEM
;

1757 
ÿps
 = 
–em
->
¡»am_ÿps
;

1759 
	`¢d_¡¾ıy
(
ÿps
->
Çme
, 
ÿps_l
->Çme, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1761 
ÿps
->
fÜm©s
 = 
ÿps_l
->formats;

1762 
ÿps
->
¿‹s
 = 
ÿps_l
->rates;

1763 
ÿps
->
¿‹_mš
 = 
ÿps_l
->rate_min;

1764 
ÿps
->
¿‹_max
 = 
ÿps_l
->rate_max;

1765 
ÿps
->
chªÃls_mš
 = 
ÿps_l
->channels_min;

1766 
ÿps
->
chªÃls_max
 = 
ÿps_l
->channels_max;

1767 
ÿps
->
³riods_mš
 = 
ÿps_l
->periods_min;

1768 
ÿps
->
³riods_max
 = 
ÿps_l
->periods_max;

1769 
ÿps
->
³riod_size_mš
 = 
ÿps_l
->period_size_min;

1770 
ÿps
->
³riod_size_max
 = 
ÿps_l
->period_size_max;

1771 
ÿps
->
bufãr_size_mš
 = 
ÿps_l
->buffer_size_min;

1772 
ÿps
->
bufãr_size_max
 = 
ÿps_l
->buffer_size_max;

1773 
ÿps
->
sig_b™s
 = 
ÿps_l
->sig_bits;

1775 
	}
}

1778 
	$lg_add_pcm_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
)

1780 
¢d_lg_pcm_‹m¶©e
 *
pcm_l
 = 
t
->
pcm
;

1781 
¢d_soc_lg_´iv©e
 *
´iv
;

1782 
¢d_soc_lg_pcm
 *
pcm
;

1783 
lg_–em
 *
–em
;

1784 
»t
, 
i
;

1786 
	`lg_dbg
("PCM: %s, DAI %s", 
pcm_l
->
pcm_Çme
,…cm_l->
dai_Çme
);

1788 ià(
pcm_l
->
num_¡»ams
 > 
SND_SOC_TPLG_STREAM_CONFIG_MAX
)

1789  -
EINVAL
;

1791 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
, 
pcm_l
->
pcm_Çme
,

1792 
SND_TPLG_TYPE_PCM
);

1793 ià(!
–em
)

1794  -
ENOMEM
;

1796 
pcm
 = 
–em
->pcm;

1797 
pcm
->
size
 = 
–em
->size;

1799 
	`¢d_¡¾ıy
(
pcm
->
pcm_Çme
, 
pcm_l
->pcm_name,

1800 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1801 
	`¢d_¡¾ıy
(
pcm
->
dai_Çme
, 
pcm_l
->dai_name,

1802 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1803 
pcm
->
pcm_id
 = 
pcm_l
->pcm_id;

1804 
pcm
->
dai_id
 = 
pcm_l
->dai_id;

1805 
pcm
->
¶ayback
 = 
pcm_l
->playback;

1806 
pcm
->
ÿ±u»
 = 
pcm_l
->capture;

1807 
pcm
->
com´ess
 = 
pcm_l
->compress;

1809 
i
 = 0; i < 2; i++) {

1810 ià(!
pcm_l
->
ÿps
[
i
] || !pcm_l->ÿps[i]->
Çme
)

1812 
»t
 = 
	`lg_add_¡»am_ÿps
(
lg
, 
pcm_l
->
ÿps
[
i
]);

1813 ià(
»t
 < 0)

1814  
»t
;

1815 
	`¢d_¡¾ıy
(
pcm
->
ÿps
[
i
].
Çme
, 
pcm_l
->caps[i]->name,

1816 (
pcm
->
ÿps
[
i
].
Çme
));

1819 
pcm
->
æag_mask
 = 
pcm_l
->flag_mask;

1820 
pcm
->
æags
 = 
pcm_l
->flags;

1822 
pcm
->
num_¡»ams
 = 
pcm_l
->num_streams;

1823 
i
 = 0; i < 
pcm_l
->
num_¡»ams
; i++)

1824 
	`lg_add_¡»am_objeù
(&
pcm
->
¡»am
[
i
], &
pcm_l
->stream[i]);

1827 
´iv
 = 
pcm_l
->priv;

1828 ià(
´iv
 &&…riv->
size
 > 0) {

1829 
»t
 = 
	`lg_add_d©a
(
lg
, 
–em
, 
´iv
,

1830 (*
´iv
è+…riv->
size
);

1831 ià(
»t
 < 0)

1832  
»t
;

1836 
	}
}

1839 
	$£t_lšk_hw_cÚfig
(
¢d_soc_lg_hw_cÚfig
 *
cfg
,

1840 
¢d_lg_hw_cÚfig_‹m¶©e
 *
l
)

1842 
i
;

1844 
cfg
->
size
 = (*cfg);

1845 
cfg
->
id
 = 
l
->id;

1847 
cfg
->
fmt
 = 
l
->fmt;

1848 
cfg
->
şock_g©ed
 = 
l
->clock_gated;

1849 
cfg
->
šv”t_bşk
 = 
l
->invert_bclk;

1850 
cfg
->
šv”t_fsync
 = 
l
->invert_fsync;

1851 
cfg
->
bşk_´ovid”
 = 
l
->bclk_provider;

1852 
cfg
->
fsync_´ovid”
 = 
l
->fsync_provider;

1853 
cfg
->
mşk_dœeùiÚ
 = 
l
->mclk_direction;

1854 
cfg
->
»£rved
 = 
l
->reserved;

1855 
cfg
->
mşk_¿‹
 = 
l
->mclk_rate;

1856 
cfg
->
bşk_¿‹
 = 
l
->bclk_rate;

1857 
cfg
->
fsync_¿‹
 = 
l
->fsync_rate;

1859 
cfg
->
tdm_¦Ùs
 = 
l
->tdm_slots;

1860 
cfg
->
tdm_¦Ù_width
 = 
l
->tdm_slot_width;

1861 
cfg
->
tx_¦Ùs
 = 
l
->tx_slots;

1862 
cfg
->
rx_¦Ùs
 = 
l
->rx_slots;

1864 ià(
cfg
->
tx_chªÃls
 > 
SND_SOC_TPLG_MAX_CHAN


1865 || 
cfg
->
rx_chªÃls
 > 
SND_SOC_TPLG_MAX_CHAN
)

1866  -
EINVAL
;

1868 
cfg
->
tx_chªÃls
 = 
l
->tx_channels;

1869 
i
 = 0; i < 
cfg
->
tx_chªÃls
; i++)

1870 
cfg
->
tx_chªm­
[
i
] = 
l
->tx_chanmap[i];

1872 
cfg
->
rx_chªÃls
 = 
l
->rx_channels;

1873 
i
 = 0; i < 
cfg
->
rx_chªÃls
; i++)

1874 
cfg
->
rx_chªm­
[
i
] = 
l
->rx_chanmap[i];

1877 
	}
}

1880 
	$lg_add_lšk_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
)

1882 
¢d_lg_lšk_‹m¶©e
 *
lšk_l
 = 
t
->
lšk
;

1883 
¢d_soc_lg_lšk_cÚfig
 *
lšk
;

1884 
¢d_soc_lg_´iv©e
 *
´iv
;

1885 
lg_–em
 *
–em
;

1886 
i
;

1887 
»t
;

1889 ià(
t
->
ty³
 !ğ
SND_TPLG_TYPE_LINK
 &&->ty³ !ğ
SND_TPLG_TYPE_BE


1890 && 
t
->
ty³
 !ğ
SND_TPLG_TYPE_CC
)

1891  -
EINVAL
;

1893 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
, 
lšk_l
->
Çme
, 
t
->
ty³
);

1894 ià(!
–em
)

1895  -
ENOMEM
;

1897 
	`lg_dbg
("Lšk: %s", 
lšk_l
->
Çme
);

1899 
lšk
 = 
–em
->link;

1900 
lšk
->
size
 = 
–em
->size;

1903 
lšk
->
id
 = 
lšk_l
->id;

1904 
	`¢d_¡¾ıy
(
lšk
->
Çme
, 
lšk_l
->name,

1905 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1906 
	`¢d_¡¾ıy
(
lšk
->
¡»am_Çme
, 
lšk_l
->stream_name,

1907 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1910 ià(
lšk_l
->
num_¡»ams
 > 
SND_SOC_TPLG_STREAM_CONFIG_MAX
)

1911  -
EINVAL
;

1912 
lšk
->
num_¡»ams
 = 
lšk_l
->num_streams;

1913 
i
 = 0; i < 
lšk
->
num_¡»ams
; i++)

1914 
	`lg_add_¡»am_objeù
(&
lšk
->
¡»am
[
i
], &
lšk_l
->stream[i]);

1917 ià(
lšk_l
->
num_hw_cÚfigs
 > 
SND_SOC_TPLG_HW_CONFIG_MAX
)

1918  -
EINVAL
;

1919 
lšk
->
num_hw_cÚfigs
 = 
lšk_l
->num_hw_configs;

1920 
lšk
->
deçuÉ_hw_cÚfig_id
 = 
lšk_l
->default_hw_config_id;

1921 
i
 = 0; i < 
lšk
->
num_hw_cÚfigs
; i++)

1922 
	`£t_lšk_hw_cÚfig
(&
lšk
->
hw_cÚfig
[
i
], &
lšk_l
->hw_config[i]);

1925 
lšk
->
æag_mask
 = 
lšk_l
->flag_mask;

1926 
lšk
->
æags
 = 
lšk_l
->flags;

1929 
´iv
 = 
lšk_l
->priv;

1930 ià(
´iv
 &&…riv->
size
 > 0) {

1931 
»t
 = 
	`lg_add_d©a
(
lg
, 
–em
, 
´iv
,

1932 (*
´iv
è+…riv->
size
);

1933 ià(
»t
 < 0)

1934  
»t
;

1938 
	}
}

1940 
	$lg_add_dai_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
)

1942 
¢d_lg_dai_‹m¶©e
 *
dai_l
 = 
t
->
dai
;

1943 
¢d_soc_lg_dai
 *
dai
;

1944 
¢d_soc_lg_´iv©e
 *
´iv
;

1945 
lg_–em
 *
–em
;

1946 
»t
, 
i
;

1948 
	`lg_dbg
("DAI %s", 
dai_l
->
dai_Çme
);

1950 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
NULL
, 
dai_l
->
dai_Çme
,

1951 
SND_TPLG_TYPE_DAI
);

1952 ià(!
–em
)

1953  -
ENOMEM
;

1955 
dai
 = 
–em
->dai;

1956 
dai
->
size
 = 
–em
->size;

1958 
	`¢d_¡¾ıy
(
dai
->
dai_Çme
, 
dai_l
->dai_name,

1959 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1960 
dai
->
dai_id
 = 
dai_l
->dai_id;

1963 
dai
->
¶ayback
 = 
dai_l
->playback;

1964 
dai
->
ÿ±u»
 = 
dai_l
->capture;

1966 
i
 = 0; i < 2; i++) {

1967 ià(!
dai_l
->
ÿps
[
i
] || !dai_l->ÿps[i]->
Çme
)

1969 
»t
 = 
	`lg_add_¡»am_ÿps
(
lg
, 
dai_l
->
ÿps
[
i
]);

1970 ià(
»t
 < 0)

1971  
»t
;

1972 
	`¢d_¡¾ıy
(
dai
->
ÿps
[
i
].
Çme
, 
dai_l
->caps[i]->name,

1973 (
dai
->
ÿps
[
i
].
Çme
));

1977 
dai
->
æag_mask
 = 
dai_l
->flag_mask;

1978 
dai
->
æags
 = 
dai_l
->flags;

1981 
´iv
 = 
dai_l
->priv;

1982 ià(
´iv
 &&…riv->
size
 > 0) {

1983 
»t
 = 
	`lg_add_d©a
(
lg
, 
–em
, 
´iv
,

1984 (*
´iv
è+…riv->
size
);

1985 ià(
»t
 < 0)

1986  
»t
;

1990 
	}
}

1993 
	$lg_decode_pcm
(
¢d_lg_t
 *
lg
,

1994 
size_t
 
pos
,

1995 
¢d_soc_lg_hdr
 *
hdr
,

1996 *
bš
, 
size_t
 
size
)

1998 
¢d_soc_lg_pcm
 *
pcm
;

1999 
¢d_lg_obj_‹m¶©e_t
 
t
;

2000 
¢d_lg_pcm_‹m¶©e
 *
±
;

2001 
¢d_lg_¡»am_ÿps_‹m¶©e
 
ÿps
[2], *
ÿp
;

2002 
¢d_lg_¡»am_‹m¶©e
 *
¡»am
;

2003 
i
;

2004 
size_t
 
asize
;

2005 
”r
;

2007 
”r
 = 
	`lg_decode_‹m¶©e
(
lg
, 
pos
, 
hdr
, &
t
);

2008 ià(
”r
 < 0)

2009  
”r
;

2011 
asize
 = (*
±
è+ 
SND_SOC_TPLG_STREAM_CONFIG_MAX
 * (*
¡»am
);

2012 
±
 = 
	`®loÿ
(
asize
);

2014 
Ãxt
:

2015 
	`mem£t
(
±
, 0, 
asize
);

2016 
pcm
 = 
bš
;

2018 ià(
size
 < (*
pcm
)) {

2019 
	`SNDERR
("pcm: sm®Èsiz%d", 
size
);

2020  -
EINVAL
;

2022 ià((*
pcm
è!ğpcm->
size
) {

2023 
	`SNDERR
("pcm: unknownƒlement size %d (expected %zd)",

2024 
pcm
->
size
, (*pcm));

2025  -
EINVAL
;

2027 ià(
pcm
->
num_¡»ams
 > 
SND_SOC_TPLG_STREAM_CONFIG_MAX
) {

2028 
	`SNDERR
("pcm: wrÚg‚umb” oà¡»am %d", 
pcm
->
num_¡»ams
);

2029  -
EINVAL
;

2031 ià((*
pcm
è+…cm->
´iv
.
size
 > size) {

2032 
	`SNDERR
("pcm: wrÚg…riv©d©¨siz%d", 
pcm
->
´iv
.
size
);

2033  -
EINVAL
;

2036 
	`lg_log
(
lg
, 'D', 
pos
, "pcm: size %d…rivate size %d streams %d",

2037 
pcm
->
size
,…cm->
´iv
.size,…cm->
num_¡»ams
);

2039 
±
->
pcm_Çme
 = 
pcm
->pcm_name;

2040 
	`lg_log
(
lg
, 'D', 
pos
, "pcm:…cm_Çm'%s'", 
±
->
pcm_Çme
);

2041 
±
->
dai_Çme
 = 
pcm
->dai_name;

2042 
	`lg_log
(
lg
, 'D', 
pos
, "pcm: dai_Çm'%s'", 
±
->
dai_Çme
);

2043 
±
->
pcm_id
 = 
pcm
->pcm_id;

2044 
±
->
dai_id
 = 
pcm
->dai_id;

2045 
	`lg_log
(
lg
, 'D', 
pos
, "pcm:…cm_id %d dai_id %d", 
±
->
pcm_id
,…t->
dai_id
);

2046 
±
->
¶ayback
 = 
pcm
->playback;

2047 
±
->
ÿ±u»
 = 
pcm
->capture;

2048 
±
->
com´ess
 = 
pcm
->compress;

2049 
	`lg_log
(
lg
, 'D', 
pos
, "pcm:…layback %d capture %d compress %d",

2050 
±
->
¶ayback
,…t->
ÿ±u»
,…t->
com´ess
);

2051 
±
->
num_¡»ams
 = 
pcm
->num_streams;

2052 
±
->
æag_mask
 = 
pcm
->flag_mask;

2053 
±
->
æags
 = 
pcm
->flags;

2054 
i
 = 0; i < 
pcm
->
num_¡»ams
; i++) {

2055 
¡»am
 = &
±
->¡»am[
i
];

2056 ià(
pcm
->
¡»am
[
i
].
size
 != (pcm->stream[0])) {

2057 
	`SNDERR
("pcm: unknown stream structure size %d",

2058 
pcm
->
¡»am
[
i
].
size
);

2059  -
EINVAL
;

2061 
¡»am
->
Çme
 = 
pcm
->¡»am[
i
].name;

2062 
	`lg_log
(
lg
, 'D', 
pos
 + 
	`off£tof
(
¢d_soc_lg_pcm
, 
¡»am
[
i
]),

2063 "¡»am %d: '%s'", 
i
, 
¡»am
->
Çme
);

2064 
¡»am
->
fÜm©
 = 
pcm
->¡»am[
i
].format;

2065 
¡»am
->
¿‹
 = 
pcm
->¡»am[
i
].rate;

2066 
¡»am
->
³riod_by‹s
 = 
pcm
->¡»am[
i
].period_bytes;

2067 
¡»am
->
bufãr_by‹s
 = 
pcm
->¡»am[
i
].buffer_bytes;

2068 
¡»am
->
chªÃls
 = 
pcm
->¡»am[
i
].channels;

2070 
i
 = 0; i < 2; i++) {

2071 ià(
i
 =ğ0 && !
pcm
->
¶ayback
)

2073 ià(
i
 =ğ1 && !
pcm
->
ÿ±u»
)

2075 
ÿp
 = &
ÿps
[
i
];

2076 
±
->
ÿps
[
i
] = 
ÿp
;

2077 ià(
pcm
->
ÿps
[
i
].
size
 != (pcm->caps[0])) {

2078 
	`SNDERR
("pcm: unknown caps structure size %d",

2079 
pcm
->
ÿps
[
i
].
size
);

2080  -
EINVAL
;

2082 
ÿp
->
Çme
 = 
pcm
->
ÿps
[
i
].name;

2083 
	`lg_log
(
lg
, 'D', 
pos
 + 
	`off£tof
(
¢d_soc_lg_pcm
, 
ÿps
[
i
]),

2084 "ÿp %d: '%s'", 
i
, 
ÿp
->
Çme
);

2085 
ÿp
->
fÜm©s
 = 
pcm
->
ÿps
[
i
].formats;

2086 
ÿp
->
¿‹s
 = 
pcm
->
ÿps
[
i
].rates;

2087 
ÿp
->
¿‹_mš
 = 
pcm
->
ÿps
[
i
].rate_min;

2088 
ÿp
->
¿‹_max
 = 
pcm
->
ÿps
[
i
].rate_max;

2089 
ÿp
->
chªÃls_mš
 = 
pcm
->
ÿps
[
i
].channels_min;

2090 
ÿp
->
chªÃls_max
 = 
pcm
->
ÿps
[
i
].channels_max;

2091 
ÿp
->
³riods_mš
 = 
pcm
->
ÿps
[
i
].periods_min;

2092 
ÿp
->
³riods_max
 = 
pcm
->
ÿps
[
i
].periods_max;

2093 
ÿp
->
³riod_size_mš
 = 
pcm
->
ÿps
[
i
].period_size_min;

2094 
ÿp
->
³riod_size_max
 = 
pcm
->
ÿps
[
i
].period_size_max;

2095 
ÿp
->
bufãr_size_mš
 = 
pcm
->
ÿps
[
i
].buffer_size_min;

2096 
ÿp
->
bufãr_size_max
 = 
pcm
->
ÿps
[
i
].buffer_size_max;

2097 
ÿp
->
sig_b™s
 = 
pcm
->
ÿps
[
i
].sig_bits;

2100 
	`lg_log
(
lg
, 'D', 
pos
 + 
	`off£tof
(
¢d_soc_lg_pcm
, 
´iv
),

2102 
±
->
´iv
 = &
pcm
->priv;

2104 
bš
 +ğ(*
pcm
è+…cm->
´iv
.
size
;

2105 
size
 -ğ(*
pcm
è+…cm->
´iv
.size;

2106 
pos
 +ğ(*
pcm
è+…cm->
´iv
.
size
;

2108 
t
.
pcm
 = 
±
;

2109 
”r
 = 
	`¢d_lg_add_objeù
(
lg
, &
t
);

2110 ià(
”r
 < 0)

2111  
”r
;

2113 ià(
size
 > 0)

2114 
Ãxt
;

2117 
	}
}

2120 
	$lg_decode_dai
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

2121 
size_t
 
pos
 
ATTRIBUTE_UNUSED
,

2122 
¢d_soc_lg_hdr
 *
hdr
 
ATTRIBUTE_UNUSED
,

2123 *
bš
 
ATTRIBUTE_UNUSED
,

2124 
size_t
 
size
 
ATTRIBUTE_UNUSED
)

2126 
	`SNDERR
("not implemented");

2127  -
ENXIO
;

2128 
	}
}

2131 
	$lg_decode_cc
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

2132 
size_t
 
pos
 
ATTRIBUTE_UNUSED
,

2133 
¢d_soc_lg_hdr
 *
hdr
 
ATTRIBUTE_UNUSED
,

2134 *
bš
 
ATTRIBUTE_UNUSED
,

2135 
size_t
 
size
 
ATTRIBUTE_UNUSED
)

2137 
	`SNDERR
("not implemented");

2138  -
ENXIO
;

2139 
	}
}

2142 
	$lg_decode_lšk
(
¢d_lg_t
 *
lg
,

2143 
size_t
 
pos
,

2144 
¢d_soc_lg_hdr
 *
hdr
,

2145 *
bš
, 
size_t
 
size
)

2147 
¢d_soc_lg_lšk_cÚfig
 *
lšk
;

2148 
¢d_lg_obj_‹m¶©e_t
 
t
;

2149 
¢d_lg_lšk_‹m¶©e
 
É
;

2150 
¢d_lg_¡»am_‹m¶©e
 
¡»ams
[
SND_SOC_TPLG_STREAM_CONFIG_MAX
];

2151 
¢d_lg_¡»am_‹m¶©e
 *
¡»am
;

2152 
¢d_lg_hw_cÚfig_‹m¶©e
 
hws
[
SND_SOC_TPLG_HW_CONFIG_MAX
];

2153 
¢d_lg_hw_cÚfig_‹m¶©e
 *
hw
;

2154 
i
, 
j
;

2155 
”r
;

2157 
”r
 = 
	`lg_decode_‹m¶©e
(
lg
, 
pos
, 
hdr
, &
t
);

2158 ià(
”r
 < 0)

2159  
”r
;

2161 
Ãxt
:

2162 
	`mem£t
(&
É
, 0, (lt));

2163 
	`mem£t
(
¡»ams
, 0, (streams));

2164 
	`mem£t
(
hws
, 0, (hws));

2165 
lšk
 = 
bš
;

2167 ià(
size
 < (*
lšk
)) {

2168 
	`SNDERR
("lšk: sm®Èsiz%d", 
size
);

2169  -
EINVAL
;

2171 ià((*
lšk
è!ğlšk->
size
) {

2172 
	`SNDERR
("link: unknownƒlement size %d (expected %zd)",

2173 
lšk
->
size
, (*link));

2174  -
EINVAL
;

2176 ià(
lšk
->
num_¡»ams
 > 
SND_SOC_TPLG_STREAM_CONFIG_MAX
) {

2177 
	`SNDERR
("lšk: wrÚg‚umb” oà¡»am %d", 
lšk
->
num_¡»ams
);

2178  -
EINVAL
;

2180 ià(
lšk
->
num_hw_cÚfigs
 > 
SND_SOC_TPLG_HW_CONFIG_MAX
) {

2181 
	`SNDERR
("lšk: wrÚg‚umb” oà¡»am %d", 
lšk
->
num_¡»ams
);

2182  -
EINVAL
;

2184 ià((*
lšk
è+†šk->
´iv
.
size
 > size) {

2185 
	`SNDERR
("lšk: wrÚg…riv©d©¨siz%d", 
lšk
->
´iv
.
size
);

2186  -
EINVAL
;

2189 
	`lg_log
(
lg
, 'D', 
pos
, "link: size %d…rivate size %d streams %d "

2191 
lšk
->
size
,†šk->
´iv
.size,†šk->
num_¡»ams
,

2192 
lšk
->
num_hw_cÚfigs
);

2194 
É
.
id
 = 
lšk
->id;

2195 
É
.
Çme
 = 
lšk
->name;

2196 
	`lg_log
(
lg
, 'D', 
pos
, "lšk:‚am'%s'", 
É
.
Çme
);

2197 
É
.
¡»am_Çme
 = 
lšk
->stream_name;

2198 
	`lg_log
(
lg
, 'D', 
pos
, "lšk: sŒ—m_Çm'%s'", 
É
.
¡»am_Çme
);

2199 
É
.
num_¡»ams
 = 
lšk
->num_streams;

2200 
É
.
num_hw_cÚfigs
 = 
lšk
->num_hw_configs;

2201 
É
.
deçuÉ_hw_cÚfig_id
 = 
lšk
->default_hw_config_id;

2202 
É
.
æag_mask
 = 
lšk
->flag_mask;

2203 
É
.
æags
 = 
lšk
->flags;

2204 
i
 = 0; i < 
lšk
->
num_¡»ams
; i++) {

2205 
¡»am
 = &
¡»ams
[
i
];

2206 ià(
lšk
->
¡»am
[
i
].
size
 != (link->stream[0])) {

2207 
	`SNDERR
("link: unknown stream structure size %d",

2208 
lšk
->
¡»am
[
i
].
size
);

2209  -
EINVAL
;

2211 
¡»am
->
Çme
 = 
lšk
->¡»am[
i
].name;

2212 
	`lg_log
(
lg
, 'D',

2213 
pos
 + 
	`off£tof
(
¢d_soc_lg_lšk_cÚfig
, 
¡»am
[
i
]),

2214 "¡»am %d: '%s'", 
i
, 
¡»am
->
Çme
);

2215 
¡»am
->
fÜm©
 = 
lšk
->¡»am[
i
].format;

2216 
¡»am
->
¿‹
 = 
lšk
->¡»am[
i
].rate;

2217 
¡»am
->
³riod_by‹s
 = 
lšk
->¡»am[
i
].period_bytes;

2218 
¡»am
->
bufãr_by‹s
 = 
lšk
->¡»am[
i
].buffer_bytes;

2219 
¡»am
->
chªÃls
 = 
lšk
->¡»am[
i
].channels;

2221 
É
.
¡»am
 = 
¡»ams
;

2222 
i
 = 0; i < 
lšk
->
num_hw_cÚfigs
; i++) {

2223 
hw
 = &
hws
[
i
];

2224 ià(
lšk
->
hw_cÚfig
[
i
].
size
 != (link->hw_config[0])) {

2225 
	`SNDERR
("link: unknown hw_config structure size %d",

2226 
lšk
->
hw_cÚfig
[
i
].
size
);

2227  -
EINVAL
;

2229 
hw
->
id
 = 
lšk
->
hw_cÚfig
[
i
].id;

2230 
hw
->
fmt
 = 
lšk
->
hw_cÚfig
[
i
].fmt;

2231 
hw
->
şock_g©ed
 = 
lšk
->
hw_cÚfig
[
i
].clock_gated;

2232 
hw
->
šv”t_bşk
 = 
lšk
->
hw_cÚfig
[
i
].invert_bclk;

2233 
hw
->
šv”t_fsync
 = 
lšk
->
hw_cÚfig
[
i
].invert_fsync;

2234 
hw
->
bşk_´ovid”
 = 
lšk
->
hw_cÚfig
[
i
].bclk_provider;

2235 
hw
->
fsync_´ovid”
 = 
lšk
->
hw_cÚfig
[
i
].fsync_provider;

2236 
hw
->
mşk_dœeùiÚ
 = 
lšk
->
hw_cÚfig
[
i
].mclk_direction;

2237 
hw
->
mşk_¿‹
 = 
lšk
->
hw_cÚfig
[
i
].mclk_rate;

2238 
hw
->
bşk_¿‹
 = 
lšk
->
hw_cÚfig
[
i
].bclk_rate;

2239 
hw
->
fsync_¿‹
 = 
lšk
->
hw_cÚfig
[
i
].fsync_rate;

2240 
hw
->
tdm_¦Ùs
 = 
lšk
->
hw_cÚfig
[
i
].tdm_slots;

2241 
hw
->
tdm_¦Ù_width
 = 
lšk
->
hw_cÚfig
[
i
].tdm_slot_width;

2242 
hw
->
tx_¦Ùs
 = 
lšk
->
hw_cÚfig
[
i
].tx_slots;

2243 
hw
->
rx_¦Ùs
 = 
lšk
->
hw_cÚfig
[
i
].rx_slots;

2244 
hw
->
tx_chªÃls
 = 
lšk
->
hw_cÚfig
[
i
].tx_channels;

2245 ià(
hw
->
tx_chªÃls
 > 
SND_SOC_TPLG_MAX_CHAN
) {

2246 
	`SNDERR
("lšk: wrÚgx chªÃl %d", 
hw
->
tx_chªÃls
);

2247  -
EINVAL
;

2249 
j
 = 0; j < 
hw
->
tx_chªÃls
; j++)

2250 
hw
->
tx_chªm­
[
j
] = 
lšk
->
hw_cÚfig
[
i
].tx_chanmap[j];

2251 
hw
->
rx_chªÃls
 = 
lšk
->
hw_cÚfig
[
i
].rx_channels;

2252 ià(
hw
->
rx_chªÃls
 > 
SND_SOC_TPLG_MAX_CHAN
) {

2253 
	`SNDERR
("lšk: wrÚg„x chªÃl %d", 
hw
->
tx_chªÃls
);

2254  -
EINVAL
;

2256 
j
 = 0; j < 
hw
->
rx_chªÃls
; j++)

2257 
hw
->
rx_chªm­
[
j
] = 
lšk
->
hw_cÚfig
[
i
].rx_chanmap[j];

2259 
É
.
hw_cÚfig
 = 
hws
;

2261 
	`lg_log
(
lg
, 'D', 
pos
 + 
	`off£tof
(
¢d_soc_lg_pcm
, 
´iv
),

2263 
É
.
´iv
 = &
lšk
->priv;

2265 
bš
 +ğ(*
lšk
è+†šk->
´iv
.
size
;

2266 
size
 -ğ(*
lšk
è+†šk->
´iv
.size;

2267 
pos
 +ğ(*
lšk
è+†šk->
´iv
.
size
;

2269 
t
.
lšk
 = &
É
;

2270 
”r
 = 
	`¢d_lg_add_objeù
(
lg
, &
t
);

2271 ià(
”r
 < 0)

2272  
”r
;

2274 ià(
size
 > 0)

2275 
Ãxt
;

2278 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/save.c

18 
	~"lg_loÿl.h
"

20 
	#SAVE_ALLOC_SHIFT
 (13è

	)

21 
	#PRINT_ALLOC_SHIFT
 (10è

	)

22 
	#PRINT_BUF_SIZE_MAX
 (1024 * 1024)

	)

23 
	#NEXT_CHUNK
(
v®
, 
shiá
è((((v®è>> (shiá)è+ 1è<< (shiá))

	)

25 
	$lg_buf_š™
(
lg_buf
 *
buf
)

27 
buf
->
d¡
 = 
NULL
;

28 
buf
->
d¡_Ën
 = 0;

29 
buf
->
´štf_buf
 = 
NULL
;

30 
buf
->
´štf_buf_size
 = 0;

31 
	}
}

33 
	$lg_buf_ä“
(
lg_buf
 *
buf
)

35 
	`ä“
(
buf
->
d¡
);

36 
	`ä“
(
buf
->
´štf_buf
);

37 
	}
}

39 *
	$lg_buf_d‘ach
(
lg_buf
 *
buf
)

41 *
»t
 = 
buf
->
d¡
;

42 
	`ä“
(
buf
->
´štf_buf
);

43  
»t
;

44 
	}
}

46 
	$lg_§ve_´štf
(
lg_buf
 *
d¡
, cÚ¡ *
pfx
, cÚ¡ *
fmt
, ...)

48 
va_li¡
 
va
;

49 *
s
;

50 
size_t
 
n
, 
l
, 
t
, 
¶
;

51 
»t
 = 0;

53 ià(
pfx
 =ğ
NULL
)

54 
pfx
 = "";

56 
	`va_¡¬t
(
va
, 
fmt
);

57 
n
 = 
	`v¢´štf
(
d¡
->
´štf_buf
, d¡->
´štf_buf_size
, 
fmt
, 
va
);

58 
	`va_’d
(
va
);

60 ià(
n
 >ğ
PRINT_BUF_SIZE_MAX
) {

61 
»t
 = -
EOVERFLOW
;

62 
’d
;

65 ià(
n
 >ğ
d¡
->
´štf_buf_size
) {

66 
t
 = 
	`NEXT_CHUNK
(
n
 + 1, 
PRINT_ALLOC_SHIFT
);

67 
s
 = 
	`»®loc
(
d¡
->
´štf_buf
, 
t
);

68 ià(!
s
) {

69 
»t
 = -
ENOMEM
;

70 
’d
;

72 
d¡
->
´štf_buf
 = 
s
;

73 
d¡
->
´štf_buf_size
 = 
t
;

74 
	`va_¡¬t
(
va
, 
fmt
);

75 
n
 = 
	`v¢´štf
(
d¡
->
´štf_buf
,‚ + 1, 
fmt
, 
va
);

76 
	`va_’d
(
va
);

79 
¶
 = 
	`¡¾’
(
pfx
);

80 
l
 = 
d¡
->
d¡_Ën
;

81 
t
 = 
l
 + 
¶
 + 
n
 + 1;

83 ià(
d¡
->d¡ =ğ
NULL
 ||

84 (
l
 >> 
SAVE_ALLOC_SHIFT
è!ğ(
t
 >> SAVE_ALLOC_SHIFT)) {

85 
s
 = 
	`»®loc
(
d¡
->d¡, 
	`NEXT_CHUNK
(
t
, 
SAVE_ALLOC_SHIFT
));

86 ià(
s
 =ğ
NULL
) {

87 
»t
 = -
ENOMEM
;

88 
’d
;

91 
s
 = 
d¡
->dst;

94 ià(
¶
 > 0)

95 
	`¡rıy
(
s
 + 
l
, 
pfx
);

96 
	`¡rıy
(
s
 + 
l
 + 
¶
, 
d¡
->
´štf_buf
);

97 
d¡
->d¡ = 
s
;

98 
d¡
->
d¡_Ën
 = 
t
 - 1;

99 
’d
:

100  
»t
;

101 
	}
}

103 
	$lg_niû_v®ue_fÜm©
(*
d¡
, 
size_t
 
d¡_size
, 
v®ue
)

105 ià((
v®ue
 % 1000) != 0) {

106 ià(
v®ue
 > 0xfffffff0)

107  
	`¢´štf
(
d¡
, 
d¡_size
, "%d", ()
v®ue
);

108 ià(
v®ue
 >= 0xffff0000)

109  
	`¢´štf
(
d¡
, 
d¡_size
, "0x%x", 
v®ue
);

111  
	`¢´štf
(
d¡
, 
d¡_size
, "%u", 
v®ue
);

112 
	}
}

114 
	$lg_µršt_š‹g”
(
¢d_cÚfig_t
 *
n
, **
»t
)

116 
lv®
;

117 
”r
, 
ty³
;

118 
buf
[16];

120 
ty³
 = 
	`¢d_cÚfig_g‘_ty³
(
n
);

121 ià(
ty³
 =ğ
SND_CONFIG_TYPE_INTEGER
) {

122 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
lv®
);

123 ià(
”r
 < 0)

124  
”r
;

125 ià(
lv®
 < 
INT_MIN
 ||†v® > 
UINT_MAX
)

126  
	`¢d_cÚfig_g‘_ascii
(
n
, 
»t
);

127 } ià(
ty³
 =ğ
SND_CONFIG_TYPE_INTEGER64
) {

128 
Îv®
;

129 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”64
(
n
, &
Îv®
);

130 ià(
”r
 < 0)

131  
”r
;

132 ià(
Îv®
 < 
INT_MIN
 ||†lv® > 
UINT_MAX
)

133  
	`¢d_cÚfig_g‘_ascii
(
n
, 
»t
);

134 
lv®
 = 
Îv®
;

136 
lv®
 = 0;

138 
”r
 = 
	`lg_niû_v®ue_fÜm©
(
buf
, (buf), ()
lv®
);

139 ià(
”r
 < 0)

140  
”r
;

141 *
»t
 = 
	`¡rdup
(
buf
);

142 ià(*
»t
 =ğ
NULL
)

143  -
ENOMEM
;

145 
	}
}

147 
	$_com·r
(cÚ¡ *
a
, cÚ¡ *
b
)

149 cÚ¡ 
¢d_cÚfig_t
 *
c1
 = *(¢d_cÚfig_ˆ**)
a
;

150 cÚ¡ 
¢d_cÚfig_t
 *
c2
 = *(¢d_cÚfig_ˆ**)
b
;

151 cÚ¡ *
id1
, *
id2
;

152 ià(
	`¢d_cÚfig_g‘_id
(
c1
, &
id1
))  0;

153 ià(
	`¢d_cÚfig_g‘_id
(
c2
, &
id2
))  0;

154  
	`¡rcmp
(
id1
, 
id2
);

155 
	}
}

157 
¢d_cÚfig_t
 *
	$sÜt_cÚfig
(cÚ¡ *
id
, 
¢d_cÚfig_t
 *
¤c
)

159 
¢d_cÚfig_t
 *
d¡
, **
a
;

160 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

161 
šdex
, 
¬¿y
, 
couÁ
;

163 ià(
	`¢d_cÚfig_g‘_ty³
(
¤c
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

164 ià(
	`¢d_cÚfig_cİy
(&
d¡
, 
¤c
) >= 0)

165  
d¡
;

166  
NULL
;

168 
couÁ
 = 0;

169 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
¤c
)

170 
couÁ
++;

171 
a
 = 
	`m®loc
((
d¡
è* 
couÁ
);

172 ià(
a
 =ğ
NULL
)

173  
NULL
;

174 
¬¿y
 = 
	`¢d_cÚfig_is_¬¿y
(
¤c
);

175 
šdex
 = 0;

176 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
¤c
) {

177 
¢d_cÚfig_t
 *
s
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

178 
a
[
šdex
++] = 
s
;

180 ià(
¬¿y
 <= 0)

181 
	`qsÜt
(
a
, 
couÁ
, ×[0]), 
_com·r
);

182 ià(
	`¢d_cÚfig_make_compound
(&
d¡
, 
id
, 
couÁ
 == 1))

183 
Ë¼
;

184 
šdex
 = 0; index < 
couÁ
; index++) {

185 
¢d_cÚfig_t
 *
s
 = 
a
[
šdex
];

186 cÚ¡ *
id2
;

187 ià(
	`¢d_cÚfig_g‘_id
(
s
, &
id2
)) {

188 
	`¢d_cÚfig_d–‘e
(
d¡
);

189 
Ë¼
;

191 
s
 = 
	`sÜt_cÚfig
(
id2
, s);

192 ià(
s
 =ğ
NULL
 || 
	`¢d_cÚfig_add
(
d¡
, s)) {

193 ià(
s
)

194 
	`¢d_cÚfig_d–‘e
(
s
);

195 
	`¢d_cÚfig_d–‘e
(
d¡
);

196 
Ë¼
;

199 
	`ä“
(
a
);

200  
d¡
;

201 
Ë¼
:

202 
	`ä“
(
a
);

203  
NULL
;

204 
	}
}

206 
	$lg_check_quÙed
(cÚ¡ *
p
)

208  ; *
p
 != '\0';…++) {

209 *
p
) {

221 ià(*
p
 <= 31 || *p >= 127)

227 
	}
}

229 
	$lg_§ve_quÙed
(
lg_buf
 *
d¡
, cÚ¡ *
¡r
)

231 cÚ¡ 
nibbË
[16] = "0123456789abcdef";

232 *
p
, *
d
, *
t
;

233 
c
;

235 
d
 = 
t
 = 
	`®loÿ
(
	`¡¾’
(
¡r
) * 5 + 1 + 1);

236 
p
 = (*)
¡r
; *p != '\0';…++) {

237 
c
 = *
p
;

238 
c
) {

240 *
t
++ = '\\';

241 *
t
++ = 'n';

244 *
t
++ = '\\';

245 *
t
++ = 't';

248 *
t
++ = '\\';

249 *
t
++ = 'v';

252 *
t
++ = '\\';

253 *
t
++ = 'b';

256 *
t
++ = '\\';

257 *
t
++ = 'r';

260 *
t
++ = '\\';

261 *
t
++ = 'f';

264 *
t
++ = '\\';

265 *
t
++ = 
c
;

268 ià(
c
 >= 32 && c <= 126) {

269 *
t
++ = 
c
;

271 *
t
++ = '\\';

272 *
t
++ = 'x';

273 *
t
++ = 
nibbË
[(
c
 >> 4) & 0x0f];

274 *
t
++ = 
nibbË
[(
c
 >> 0) & 0x0f];

279 *
t
 = '\0';

280  
	`lg_§ve_´štf
(
d¡
, 
NULL
, "'%s'", 
d
);

281 
	}
}

283 
	$lg_§ve_¡ršg
(
lg_buf
 *
d¡
, cÚ¡ *
¡r
, 
id
)

285 cÚ¡ *
p
 = (cÚ¡ *)
¡r
;

287 ià(!
p
 || !*p)

288  
	`lg_§ve_´štf
(
d¡
, 
NULL
, "''");

290 ià(!
id
 && ((*
p
 >= '0' && *p <= '9') || *p == '-'))

291  
	`lg_§ve_quÙed
(
d¡
, 
¡r
);

293 ià(
	`lg_check_quÙed
(
p
))

294  
	`lg_§ve_quÙed
(
d¡
, 
¡r
);

296  
	`lg_§ve_´štf
(
d¡
, 
NULL
, "%s", 
¡r
);

297 
	}
}

299 
	$§ve_cÚfig
(
lg_buf
 *
d¡
, 
Ëv–
, cÚ¡ *
d–im
, 
¢d_cÚfig_t
 *
¤c
)

301 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

302 
¢d_cÚfig_t
 *
s
;

303 cÚ¡ *
id
;

304 *
pfx
;

305 
couÁ
;

306 
ty³
, 
”r
, 
quÙed
, 
¬¿y
;

308 ià(
d–im
 =ğ
NULL
)

309 
d–im
 = "";

311 
ty³
 = 
	`¢d_cÚfig_g‘_ty³
(
¤c
);

312 ià(
ty³
 !ğ
SND_CONFIG_TYPE_COMPOUND
) {

313 *
v®
;

314 ià(
ty³
 =ğ
SND_CONFIG_TYPE_INTEGER
 ||

315 
ty³
 =ğ
SND_CONFIG_TYPE_INTEGER64
) {

316 
”r
 = 
	`lg_µršt_š‹g”
(
¤c
, &
v®
);

318 
”r
 = 
	`¢d_cÚfig_g‘_ascii
(
¤c
, &
v®
);

320 ià(
”r
 < 0)

321  
”r
;

322 ià(
ty³
 =ğ
SND_CONFIG_TYPE_STRING
) {

324 
id
 = 
	`¡rchr
(
v®
, '\n');

325 ià(
id
) {

326 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "\n");

327 ià(
”r
 < 0)

328 
»tv®
;

329 
id
++; *id == '\t'; id++) {

330 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "\t");

331 ià(
”r
 < 0)

332 
»tv®
;

334 
d–im
 = "";

336 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "%s'%s'\n", 
d–im
, 
v®
);

338 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "%s%s\n", 
d–im
, 
v®
);

340 
»tv®
:

341 
	`ä“
(
v®
);

342  
”r
;

345 
couÁ
 = 0;

346 
quÙed
 = 0;

347 
¬¿y
 = 
	`¢d_cÚfig_is_¬¿y
(
¤c
);

348 
s
 = 
NULL
;

349 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
¤c
) {

350 
s
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

351 
”r
 = 
	`¢d_cÚfig_g‘_id
(
s
, &
id
);

352 ià(
”r
 < 0)

353  
”r
;

354 ià(!
quÙed
 && 
	`lg_check_quÙed
((*)
id
))

355 
quÙed
 = 1;

356 
couÁ
++;

358 ià(
couÁ
 == 0)

361 ià(
couÁ
 == 1) {

362 
”r
 = 
	`¢d_cÚfig_g‘_id
(
s
, &
id
);

363 ià(
”r
 >ğ0 && 
Ëv–
 > 0)

364 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, ".");

365 ià(
”r
 >= 0)

366 
”r
 = 
	`lg_§ve_¡ršg
(
d¡
, 
id
, 1);

367 ià(
”r
 >= 0)

368 
”r
 = 
	`§ve_cÚfig
(
d¡
, 
Ëv–
, " ", 
s
);

369  
”r
;

372 
pfx
 = 
	`®loÿ
(
Ëv–
 + 1);

373 
	`mem£t
(
pfx
, '\t', 
Ëv–
);

374 
pfx
[
Ëv–
] = '\0';

376 ià(
Ëv–
 > 0) {

377 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
NULL
, "%s%s\n", 
d–im
,

378 
¬¿y
 > 0 ? "[" : "{");

379 ià(
”r
 < 0)

380  
”r
;

383 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
¤c
) {

384 
s
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

385 cÚ¡ *
id
;

386 
”r
 = 
	`¢d_cÚfig_g‘_id
(
s
, &
id
);

387 ià(
”r
 < 0)

388  
”r
;

389 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "");

390 ià(
”r
 < 0)

391  
”r
;

392 ià(
¬¿y
 <= 0) {

393 
d–im
 = " ";

394 ià(
quÙed
) {

395 
”r
 = 
	`lg_§ve_quÙed
(
d¡
, 
id
);

397 
”r
 = 
	`lg_§ve_¡ršg
(
d¡
, 
id
, 1);

399 ià(
”r
 < 0)

400  
”r
;

402 
d–im
 = "";

404 
”r
 = 
	`§ve_cÚfig
(
d¡
, 
Ëv–
 + 1, 
d–im
, 
s
);

405 ià(
”r
 < 0)

406  
”r
;

409 ià(
Ëv–
 > 0) {

410 
pfx
[
Ëv–
 - 1] = '\0';

411 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "%s\n",

412 
¬¿y
 > 0 ? "]" : "}");

413 ià(
”r
 < 0)

414  
”r
;

418 
	}
}

420 
	$lg_§ve
(
¢d_lg_t
 *
lg
, 
lg_buf
 *
d¡
,

421 
gšdex
, cÚ¡ *
´efix
)

423 
lg_bË
 *
Œ
;

424 
lg_–em
 *
–em
;

425 
li¡_h—d
 *
li¡
, *
pos
;

426 
pfx2
[16];

427 
šdex
;

428 
”r
, 
couÁ
;

430 
	`¢´štf
(
pfx2
, Õfx2), "%s\t", 
´efix
 ?: "");

433 
šdex
 = 0; index < 
lg_bË_™ems
; index++) {

434 
Œ
 = &
lg_bË
[
šdex
];

435 
li¡
 = (
li¡_h—d
 *)((*)
lg
 + 
Œ
->
loff
);

438 
couÁ
 = 0;

439 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

440 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

441 ià(
gšdex
 >ğ0 && 
–em
->
šdex
 != gindex)

443 ià(
Œ
->
§ve
 =ğ
NULL
 &&±r->
g§ve
 == NULL) {

444 
	`SNDERR
("unableo create %s block (no callback)",

445 
Œ
->
id
);

446 
”r
 = -
ENXIO
;

447 
_”r
;

449 ià(
Œ
->
§ve
)

450 
couÁ
++;

453 ià(
couÁ
 == 0)

456 ià(
couÁ
 > 1) {

457 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
´efix
, "%s {\n",

458 
–em
->
bË
 ?

459 
–em
->
bË
->
id
 : "_NOID_");

461 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
´efix
, "%s.",

462 
–em
->
bË
 ?

463 
–em
->
bË
->
id
 : "_NOID_");

466 ià(
”r
 < 0)

467 
_”r
;

469 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

470 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

471 ià(
gšdex
 >ğ0 && 
–em
->
šdex
 != gindex)

473 ià(
couÁ
 > 1) {

474 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx2
, "");

475 ià(
”r
 < 0)

476 
_”r
;

478 
”r
 = 
Œ
->
	`§ve
(
lg
, 
–em
, 
d¡
, 
couÁ
 > 1 ? 
pfx2
 : 
´efix
);

479 ià(
”r
 < 0) {

480 
	`SNDERR
("failedo save %sƒlements: %s",

481 
Œ
->
id
, 
	`¢d_¡»¼Ü
(-
”r
));

482 
_”r
;

485 ià(
couÁ
 > 1) {

486 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
´efix
, "}\n");

487 ià(
”r
 < 0)

488 
_”r
;

493 
šdex
 = 0; index < 
lg_bË_™ems
; index++) {

494 
Œ
 = &
lg_bË
[
šdex
];

495 ià(
Œ
->
g§ve
) {

496 
”r
 = 
Œ
->
	`g§ve
(
lg
, 
gšdex
, 
d¡
, 
´efix
);

497 ià(
”r
 < 0)

498 
_”r
;

504 
_”r
:

505  
”r
;

506 
	}
}

508 
	$lg_šdex_com·r
(cÚ¡ *
a
, cÚ¡ *
b
)

510 cÚ¡ *
a1
 = 
a
, *
b1
 = 
b
;

511  *
a1
 - *
b1
;

512 
	}
}

514 
	$lg_šdex_groups
(
¢d_lg_t
 *
lg
, **
šdexes
)

516 
lg_bË
 *
Œ
;

517 
lg_–em
 *
–em
;

518 
li¡_h—d
 *
li¡
, *
pos
;

519 
šdex
, 
j
, 
couÁ
, 
size
;

520 *
a
, *
b
;

522 
couÁ
 = 0;

523 
size
 = 16;

524 
a
 = 
	`m®loc
(
size
 * (a[0]));

526 
šdex
 = 0; index < 
lg_bË_™ems
; index++) {

527 
Œ
 = &
lg_bË
[
šdex
];

528 
li¡
 = (
li¡_h—d
 *)((*)
lg
 + 
Œ
->
loff
);

529 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

530 
–em
 = 
	`li¡_’Œy
(
pos
, 
lg_–em
, 
li¡
);

531 
j
 = 0; j < 
couÁ
; j++) {

532 ià(
a
[
j
] =ğ
–em
->
šdex
)

535 ià(
j
 < 
couÁ
)

537 ià(
couÁ
 + 1 >ğ
size
) {

538 
size
 += 8;

539 
b
 = 
	`»®loc
(
a
, 
size
 * (a[0]));

540 ià(
b
 =ğ
NULL
) {

541 
	`ä“
(
a
);

542  -
ENOMEM
;

544 
a
 = 
b
;

546 
a
[
couÁ
++] = 
–em
->
šdex
;

549 
a
[
couÁ
] = -1;

551 
	`qsÜt
(
a
, 
couÁ
, ×[0]), 
lg_šdex_com·r
);

553 *
šdexes
 = 
a
;

555 
	}
}

557 
	$¢d_lg_§ve
(
¢d_lg_t
 *
lg
, **
d¡
, 
æags
)

559 
lg_buf
 
buf
, 
buf2
;

560 
¢d_šput_t
 *
š
;

561 
¢d_cÚfig_t
 *
tİ
, *
tİ2
;

562 *
šdexes
, *
a
;

563 
”r
;

565 
	`as£¹
(
lg
);

566 
	`as£¹
(
d¡
);

567 *
d¡
 = 
NULL
;

569 
	`lg_buf_š™
(&
buf
);

571 ià(
æags
 & 
SND_TPLG_SAVE_GROUPS
) {

572 
”r
 = 
	`lg_šdex_groups
(
lg
, &
šdexes
);

573 ià(
”r
 < 0)

574  
”r
;

575 
a
 = 
šdexes
; 
”r
 >= 0 && *a >= 0;‡++) {

576 
”r
 = 
	`lg_§ve_´štf
(&
buf
, 
NULL
,

578 *
a
);

579 ià(
”r
 >= 0)

580 
”r
 = 
	`lg_§ve
(
lg
, &
buf
, *
a
, "\t");

581 ià(
”r
 >= 0)

582 
”r
 = 
	`lg_§ve_´štf
(&
buf
, 
NULL
, "}\n");

584 
	`ä“
(
šdexes
);

586 
”r
 = 
	`lg_§ve
(
lg
, &
buf
, -1, 
NULL
);

589 ià(
”r
 < 0)

590 
_”r
;

592 ià(
buf
.
d¡
 =ğ
NULL
) {

593 
”r
 = -
EINVAL
;

594 
_”r
;

597 ià(
æags
 & 
SND_TPLG_SAVE_NOCHECK
) {

598 *
d¡
 = 
	`lg_buf_d‘ach
(&
buf
);

603 
”r
 = 
	`¢d_šput_bufãr_İ’
(&
š
, 
buf
.
d¡
, 
	`¡¾’
(buf.dst));

604 ià(
”r
 < 0) {

605 
	`SNDERR
("could‚ot create input buffer");

606 
_”r
;

609 
”r
 = 
	`¢d_cÚfig_tİ
(&
tİ
);

610 ià(
”r
 < 0) {

611 
	`¢d_šput_şo£
(
š
);

612 
_”r
;

615 
”r
 = 
	`¢d_cÚfig_lßd
(
tİ
, 
š
);

616 
	`¢d_šput_şo£
(
š
);

617 ià(
”r
 < 0) {

618 
	`SNDERR
("could‚ot†oad configuration");

619 
	`¢d_cÚfig_d–‘e
(
tİ
);

620 
_”r
;

623 ià(
æags
 & 
SND_TPLG_SAVE_SORT
) {

624 
tİ2
 = 
	`sÜt_cÚfig
(
NULL
, 
tİ
);

625 ià(
tİ2
 =ğ
NULL
) {

626 
	`SNDERR
("could‚ot sort configuration");

627 
	`¢d_cÚfig_d–‘e
(
tİ
);

628 
”r
 = -
EINVAL
;

629 
_”r
;

631 
	`¢d_cÚfig_d–‘e
(
tİ
);

632 
tİ
 = 
tİ2
;

635 
	`lg_buf_š™
(&
buf2
);

636 
”r
 = 
	`§ve_cÚfig
(&
buf2
, 0, 
NULL
, 
tİ
);

637 
	`¢d_cÚfig_d–‘e
(
tİ
);

638 ià(
”r
 < 0) {

639 
	`SNDERR
("could‚ot save configuration");

640 
_”r
;

643 
	`lg_buf_ä“
(&
buf
);

644 *
d¡
 = 
	`lg_buf_d‘ach
(&
buf2
);

647 
_”r
:

648 
	`lg_buf_ä“
(&
buf
);

649 *
d¡
 = 
NULL
;

650  
”r
;

651 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/text.c

21 
	~"lg_loÿl.h
"

23 
	#TEXT_SIZE_MAX
 \

24 (
SND_SOC_TPLG_NUM_TEXTS
 * 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
)

	)

26 
	$·r£_‹xt_v®ues
(
¢d_cÚfig_t
 *
cfg
, 
lg_–em
 *
–em
)

28 
lg_‹xts
 *
‹xts
 = 
–em
->texts;

29 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

30 
¢d_cÚfig_t
 *
n
;

31 cÚ¡ *
v®ue
 = 
NULL
;

32 
j
 = 0;

34 
	`lg_dbg
(" TexˆV®ues: %s", 
–em
->
id
);

36 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

37 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

39 ià(
j
 =ğ
SND_SOC_TPLG_NUM_TEXTS
) {

40 
	`lg_dbg
("‹xˆ¡ršg‚umb”ƒxûed %d", 
j
);

41  -
ENOMEM
;

45 ià(
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
v®ue
) < 0)

48 
	`¢d_¡¾ıy
(&
‹xts
->
™ems
[
j
][0], 
v®ue
,

49 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

50 
	`lg_dbg
("\t%s", &
‹xts
->
™ems
[
j
][0]);

52 
j
++;

55 
‹xts
->
num_™ems
 = 
j
;

57 
	}
}

60 
	$lg_·r£_‹xt
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

61 *
´iv©e
 
ATTRIBUTE_UNUSED
)

63 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

64 
¢d_cÚfig_t
 *
n
;

65 cÚ¡ *
id
;

66 
”r
 = 0;

67 
lg_–em
 *
–em
;

69 
–em
 = 
	`lg_–em_Ãw_commÚ
(
lg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_TEXT
);

70 ià(!
–em
)

71  -
ENOMEM
;

73 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

75 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

76 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

79 ià(
	`¡rcmp
(
id
, "values") == 0) {

80 
”r
 = 
	`·r£_‹xt_v®ues
(
n
, 
–em
);

81 ià(
”r
 < 0) {

82 
	`SNDERR
("error: failedo…arseext values");

83  
”r
;

89  
”r
;

90 
	}
}

93 
	$lg_§ve_‹xt
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

94 
lg_–em
 *
–em
,

95 
lg_buf
 *
d¡
, cÚ¡ *
pfx
)

97 
lg_‹xts
 *
‹xts
 = 
–em
->texts;

98 
i
;

99 
”r
;

101 ià(!
‹xts
 ||exts->
num_™ems
 == 0)

103 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "'%s'.v®ue [\n", 
–em
->
id
);

104 
i
 = 0; 
”r
 >ğ0 && i < 
‹xts
->
num_™ems
; i++)

105 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "\t'%s'\n", 
‹xts
->
™ems
[
i
]);

106 ià(
”r
 >= 0)

107 
”r
 = 
	`lg_§ve_´štf
(
d¡
, 
pfx
, "]\n");

108  
”r
;

109 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/tplg_local.h

13 
	~"loÿl.h
"

15 
	~<lim™s.h
>

16 
	~<¡dšt.h
>

17 
	~<¡dboŞ.h
>

19 
	~"li¡.h
"

20 
	~"bsw­.h
"

21 
	~"tİŞogy.h
"

23 
	~<sound/ty³_com·t.h
>

24 
	~<sound/asound.h
>

25 
	~<sound/asoc.h
>

26 
	~<sound/v.h
>

28 #ifdeà
TPLG_DEBUG


29 
	#lg_dbg
 
SNDERR


	)

31 
	#lg_dbg
(
fmt
, 
¬g
...èdØ{ } 0)

	)

34 
	#TPLG_MAX_PRIV_SIZE
 (1024 * 128)

	)

37 
	#ALSA_CONFIG_TPLG_VAR
 "ALSA_CONFIG_TPLG"

	)

39 
	glg_»f
;

40 
	glg_–em
;

41 
	glg_bË
;

43 
	e_¢d_pcm_¿‹s
 {

44 
	mSND_PCM_RATE_UNKNOWN
 = -1,

45 
	mSND_PCM_RATE_5512
 = 0,

46 
	mSND_PCM_RATE_8000
,

47 
	mSND_PCM_RATE_11025
,

48 
	mSND_PCM_RATE_16000
,

49 
	mSND_PCM_RATE_22050
,

50 
	mSND_PCM_RATE_32000
,

51 
	mSND_PCM_RATE_44100
,

52 
	mSND_PCM_RATE_48000
,

53 
	mSND_PCM_RATE_64000
,

54 
	mSND_PCM_RATE_88200
,

55 
	mSND_PCM_RATE_96000
,

56 
	mSND_PCM_RATE_176400
,

57 
	mSND_PCM_RATE_192000
,

58 
	mSND_PCM_RATE_CONTINUOUS
 = 30,

59 
	mSND_PCM_RATE_KNOT
 = 31,

60 
	mSND_PCM_RATE_LAST
 = 
SND_PCM_RATE_KNOT
,

61 } 
	t¢d_pcm_¿‹s_t
;

63 
	s¢d_lg
 {

65 *
	mbš
;

66 
size_t
 
	mbš_pos
;

67 
size_t
 
	mbš_size
;

69 
	mv”bo£
;

70 
	md­m_sÜt
: 1;

71 
	mv”siÚ
;

74 
size_t
 
	mÃxt_hdr_pos
;

75 
	mšdex
;

76 
	mchªÃl_idx
;

79 
¢d_soc_lg_mªiã¡
 
	mmªiã¡
;

80 *
	mmªiã¡_pd©a
;

83 
li¡_h—d
 
	mv_li¡
;

84 
li¡_h—d
 
	mwidg‘_li¡
;

85 
li¡_h—d
 
	mpcm_li¡
;

86 
li¡_h—d
 
	mdai_li¡
;

87 
li¡_h—d
 
	mbe_li¡
;

88 
li¡_h—d
 
	mcc_li¡
;

89 
li¡_h—d
 
	mrou‹_li¡
;

90 
li¡_h—d
 
	m‹xt_li¡
;

91 
li¡_h—d
 
	mpd©a_li¡
;

92 
li¡_h—d
 
	mtok’_li¡
;

93 
li¡_h—d
 
	mtu¶e_li¡
;

94 
li¡_h—d
 
	mmªiã¡_li¡
;

95 
li¡_h—d
 
	mpcm_cÚfig_li¡
;

96 
li¡_h—d
 
	mpcm_ÿps_li¡
;

97 
li¡_h—d
 
	mhw_cfg_li¡
;

100 
li¡_h—d
 
	mmix”_li¡
;

101 
li¡_h—d
 
	m’um_li¡
;

102 
li¡_h—d
 
	mby‹s_ext_li¡
;

106 
	slg_»f
 {

107 
	mty³
;

108 
lg_–em
 *
	m–em
;

109 
	mid
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

110 
li¡_h—d
 
	mli¡
;

113 
	slg_‹xts
 {

114 
	mnum_™ems
;

115 
	m™ems
[
SND_SOC_TPLG_NUM_TEXTS
][
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

119 
	slg_tok’
 {

120 
	mid
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

121 
	mv®ue
;

124 
	slg_v’dÜ_tok’s
 {

125 
	mnum_tok’s
;

126 
lg_tok’
 
	mtok’
[0];

130 
	slg_tu¶e
 {

131 
	mtok’
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

133 
	m¡ršg
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

134 
	muuid
[16];

135 
	mv®ue
;

139 
	slg_tu¶e_£t
 {

140 
	mty³
;

141 
	mnum_tu¶es
;

142 
lg_tu¶e
 
	mtu¶e
[0];

145 
	slg_v’dÜ_tu¶es
 {

146 
	mnum_£ts
;

147 
	m®loc_£ts
;

148 
lg_tu¶e_£t
 **
	m£t
;

152 
	slg_–em
 {

154 
lg_bË
 *
	mbË
;

156 
	mid
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

158 
	mšdex
;

159 
¢d_lg_ty³
 
	mty³
;

161 
	msize
;

162 
	mcompound_–em
;

163 
	mv’dÜ_ty³
;

167 *
	mobj
;

168 
¢d_soc_lg_mix”_cÚŒŞ
 *
	mmix”_ù¾
;

169 
¢d_soc_lg_’um_cÚŒŞ
 *
	m’um_ù¾
;

170 
¢d_soc_lg_by‹s_cÚŒŞ
 *
	mby‹s_ext
;

171 
¢d_soc_lg_d­m_widg‘
 *
	mwidg‘
;

172 
¢d_soc_lg_pcm
 *
	mpcm
;

173 
¢d_soc_lg_dai
 *
	mdai
;

174 
¢d_soc_lg_lšk_cÚfig
 *
	mlšk
;

175 
¢d_soc_lg_d­m_g¿ph_–em
 *
	mrou‹
;

176 
¢d_soc_lg_¡»am
 *
	m¡»am_cfg
;

177 
¢d_soc_lg_¡»am_ÿps
 *
	m¡»am_ÿps
;

178 
¢d_soc_lg_hw_cÚfig
 *
	mhw_cfg
;

181 
¢d_soc_lg_ùl_v
 *
	mv
;

182 
lg_‹xts
 *
	m‹xts
;

183 
¢d_soc_lg_´iv©e
 *
	md©a
;

184 
lg_v’dÜ_tok’s
 *
	mtok’s
;

185 
lg_v’dÜ_tu¶es
 *
	mtu¶es
;

186 
¢d_soc_lg_mªiã¡
 *
	mmªiã¡
;

194 
li¡_h—d
 
	m»f_li¡
;

195 
li¡_h—d
 
	mli¡
;

197 (*
	mä“
)(*
	mobj
);

200 
	sm­_–em
 {

201 cÚ¡ *
	mÇme
;

202 
	mid
;

206 
	slg_buf
 {

207 *
	md¡
;

208 
size_t
 
	md¡_Ën
;

209 *
	m´štf_buf
;

210 
size_t
 
	m´štf_buf_size
;

214 
	slg_bË
 {

215 cÚ¡ *
	mÇme
;

216 cÚ¡ *
	mid
;

217 cÚ¡ *
	mid2
;

218 
off_t
 
	mloff
;

219 
size_t
 
	msize
;

220 
	mty³
;

221 
	mtsoc
;

222 
	mbud
: 1;

223 
	m’ew
: 1;

224 (*
	mä“
)(*);

225 (*
	m·r£
)(
¢d_lg_t
 *
	mlg
, 
¢d_cÚfig_t
 *
	mcfg
, *
	m´iv
);

226 (*
	m§ve
)(
¢d_lg_t
 *
	mlg
, 
lg_–em
 *
	m–em
,

227 
lg_buf
 *
	md¡
, cÚ¡ *
	m´efix
);

228 (*
	mg§ve
)(
¢d_lg_t
 *
	mlg
, 
	mšdex
,

229 
lg_buf
 *
	md¡
, cÚ¡ *
	m´efix
);

230 (*
	mdecod
)(
¢d_lg_t
 *
	mlg
, 
size_t
 
	mpos
,

231 
¢d_soc_lg_hdr
 *
	mhdr
,

232 *
	mbš
, 
size_t
 
	msize
);

235 
lg_bË
plg_table[];

236 
lg_bË_™ems
;

238 #ià
__SIZEOF_INT__
 == 4

239 
šlše
 
	$uÇligÃd_g‘32
(*
¤c
)

241 
»t
;

242 
	`memıy
(&
»t
, 
¤c
, (ret));

243 #ià
__BYTE_ORDER__
 =ğ
__ORDER_BIG_ENDIAN__


244 
»t
 = 
	`bsw­_32
(ret);

246  
»t
;

247 
	}
}

248 
šlše
 
	$uÇligÃd_put32
(*
d¡
, 
v®
)

250 #ià
__BYTE_ORDER__
 =ğ
__ORDER_BIG_ENDIAN__


251 
v®
 = 
	`bsw­_32
(val);

253 
	`memıy
(
d¡
, &
v®
, (val));

254 
	}
}

257 
	#lg_log
(
lg
, 
ty³
, 
pos
, 
fmt
, 
¬gs
...) do { \

258 ià((
lg
)->
v”bo£
) \

259 
	`lg_log_
((
lg
), (
ty³
), (
pos
), (
fmt
), ##
¬gs
); \

260 } 0)

	)

262 
lg_log_
(
¢d_lg_t
 *
lg
, 
ty³
, 
size_t
 
pos
, cÚ¡ *
fmt
, ...);

264 *
lg_ÿÎoc
(
li¡_h—d
 *
h—p
, 
size_t
 
size
);

265 
lg_ä“
(
li¡_h—d
 *
h—p
);

267 
lg_g‘_ty³
(
asoc_ty³
);

269 
lg_·r£_compound
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
,

270 (*
fú
)(
¢d_lg_t
 *, 
¢d_cÚfig_t
 *, *),

271 *
´iv©e
);

273 
	`lg_wr™e_d©a
(
¢d_lg_t
 *
lg
);

275 
	`lg_·r£_v
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

276 
	`lg_·r£_‹xt
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

277 
	`lg_·r£_d©a
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

278 
	`lg_·r£_tok’s
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

279 
	`lg_·r£_tu¶es
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

280 
	`lg_·r£_mªiã¡_d©a
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

281 
	`lg_·r£_cÚŒŞ_by‹s
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

282 
	`lg_·r£_cÚŒŞ_’um
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

283 
	`lg_·r£_cÚŒŞ_mix”
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

284 
	`lg_·r£_d­m_g¿ph
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

285 
	`lg_·r£_d­m_widg‘
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

286 
	`lg_·r£_¡»am_ÿps
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

287 
	`lg_·r£_pcm
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

288 
	`lg_·r£_dai
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

289 
	`lg_·r£_lšk
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

290 
	`lg_·r£_cc
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

291 
	`lg_·r£_hw_cÚfig
(
¢d_lg_t
 *
lg
, 
¢d_cÚfig_t
 *
cfg
, *
´iv
);

293 
	`lg_g‘_tu¶e_size
(
ty³
);

294 
	`lg_ä“_tu¶es
(*
obj
);

296 
	`lg_bud_d©a
(
¢d_lg_t
 *
lg
);

297 
	`lg_bud_mªiã¡_d©a
(
¢d_lg_t
 *
lg
);

298 
	`lg_bud_cÚŒŞs
(
¢d_lg_t
 *
lg
);

299 
	`lg_bud_widg‘s
(
¢d_lg_t
 *
lg
);

300 
	`lg_bud_rou‹s
(
¢d_lg_t
 *
lg
);

301 
	`lg_bud_pcm_dai
(
¢d_lg_t
 *
lg
, 
ty³
);

303 
	`lg_cİy_d©a
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

304 
lg_»f
 *
»f
);

306 
	`lg_·r£_»fs
(
¢d_cÚfig_t
 *
cfg
, 
lg_–em
 *
–em
,

307 
ty³
);

309 
	`lg_»f_add
(
lg_–em
 *
–em
, 
ty³
, cÚ¡ * 
id
);

310 
	`lg_»f_add_–em
(
lg_–em
 *
–em
, lg_–em *
–em_»f
);

312 
lg_–em
 *
	`lg_–em_Ãw
();

313 
	`lg_–em_ä“
(
lg_–em
 *
–em
);

314 
	`lg_–em_ä“_li¡
(
li¡_h—d
 *
ba£
);

315 
	`lg_–em_š£¹
(
lg_–em
 *
–em_p
, 
li¡_h—d
 *
li¡
);

316 
lg_–em
 *
	`lg_–em_lookup
(
li¡_h—d
 *
ba£
,

317 cÚ¡ * 
id
,

318 
ty³
,

319 
šdex
);

320 
lg_–em
 *
	`lg_–em_ty³_lookup
(
¢d_lg_t
 *
lg
,

321 
¢d_lg_ty³
 
ty³
);

322 
lg_–em
* 
	`lg_–em_Ãw_commÚ
(
¢d_lg_t
 *
lg
,

323 
¢d_cÚfig_t
 *
cfg
, cÚ¡ *
Çme
, 
¢d_lg_ty³
 
ty³
);

325 
	`lg_g‘_š‹g”
(
¢d_cÚfig_t
 *
n
, *
v®
, 
ba£
);

326 
	`lg_g‘_unsigÃd
(
¢d_cÚfig_t
 *
n
, *
v®
, 
ba£
);

328 cÚ¡ *
	`lg_chªÃl_Çme
(
ty³
);

329 
	`lg_·r£_chªÃl
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

330 
¢d_cÚfig_t
 *
cfg
, *
´iv©e
);

332 cÚ¡ *
	`lg_İs_Çme
(
ty³
);

333 
	`lg_·r£_İs
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

334 
¢d_cÚfig_t
 *
cfg
, *
´iv©e
);

335 
	`lg_·r£_ext_İs
(
¢d_lg_t
 *
lg
 
ATTRIBUTE_UNUSED
,

336 
¢d_cÚfig_t
 *
cfg
, *
´iv©e
);

338 
lg_–em
 *
	`lookup_pcm_dai_¡»am
(
li¡_h—d
 *
ba£
,

339 cÚ¡ * 
id
);

341 
	`lg_add_d©a
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
·»Á
,

342 cÚ¡ *
bš
, 
size_t
 
size
);

343 
	`lg_add_d©a_by‹s
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
·»Á
,

344 cÚ¡ *
suffix
, cÚ¡ *
bš
, 
size_t
 
size
);

345 
	`lg_add_mix”_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
);

346 
	`lg_add_’um_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
);

347 
	`lg_add_by‹s_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
);

348 
	`lg_add_widg‘_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
);

349 
	`lg_add_g¿ph_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
);

351 
	`lg_add_mix”
(
¢d_lg_t
 *
lg
, 
¢d_lg_mix”_‹m¶©e
 *
mix”
,

352 
lg_–em
 **
e
);

353 
	`lg_add_’um
(
¢d_lg_t
 *
lg
, 
¢d_lg_’um_‹m¶©e
 *
’um_ùl
,

354 
lg_–em
 **
e
);

355 
	`lg_add_by‹s
(
¢d_lg_t
 *
lg
, 
¢d_lg_by‹s_‹m¶©e
 *
by‹s_ùl
,

356 
lg_–em
 **
e
);

358 
	`lg_bud_pcms
(
¢d_lg_t
 *
lg
, 
ty³
);

359 
	`lg_bud_dais
(
¢d_lg_t
 *
lg
, 
ty³
);

360 
	`lg_bud_lšks
(
¢d_lg_t
 *
lg
, 
ty³
);

361 
	`lg_add_lšk_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
);

362 
	`lg_add_pcm_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
);

363 
	`lg_add_dai_objeù
(
¢d_lg_t
 *
lg
, 
¢d_lg_obj_‹m¶©e_t
 *
t
);

365 
	`lg_niû_v®ue_fÜm©
(*
d¡
, 
size_t
 
d¡_size
, 
v®ue
);

367 
	`lg_§ve_´štf
(
lg_buf
 *
d¡
, cÚ¡ *
´efix
, cÚ¡ *
fmt
, ...);

368 
	`lg_§ve_»fs
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
, 
ty³
,

369 cÚ¡ *
id
, 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

370 
	`lg_§ve_chªÃls
(
¢d_lg_t
 *
lg
, 
¢d_soc_lg_chªÃl
 *
chªÃl
,

371 
chªÃl_couÁ
, 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

372 
	`lg_§ve_İs
(
¢d_lg_t
 *
lg
, 
¢d_soc_lg_ùl_hdr
 *
hdr
,

373 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

374 
	`lg_§ve_ext_İs
(
¢d_lg_t
 *
lg
, 
¢d_soc_lg_by‹s_cÚŒŞ
 *
be
,

375 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

376 
	`lg_§ve_mªiã¡_d©a
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

377 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

378 
	`lg_§ve_cÚŒŞ_mix”
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

379 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

380 
	`lg_§ve_cÚŒŞ_’um
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

381 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

382 
	`lg_§ve_cÚŒŞ_by‹s
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

383 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

384 
	`lg_§ve_v
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

385 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

386 
	`lg_§ve_d©a
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

387 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

388 
	`lg_§ve_‹xt
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

389 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

390 
	`lg_§ve_tok’s
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

391 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

392 
	`lg_§ve_tu¶es
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

393 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

394 
	`lg_§ve_d­m_g¿ph
(
¢d_lg_t
 *
lg
, 
šdex
,

395 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

396 
	`lg_§ve_d­m_widg‘
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

397 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

398 
	`lg_§ve_lšk
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

399 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

400 
	`lg_§ve_cc
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

401 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

402 
	`lg_§ve_pcm
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

403 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

404 
	`lg_§ve_hw_cÚfig
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

405 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

406 
	`lg_§ve_¡»am_ÿps
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

407 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

408 
	`lg_§ve_dai
(
¢d_lg_t
 *
lg
, 
lg_–em
 *
–em
,

409 
lg_buf
 *
d¡
, cÚ¡ *
pfx
);

411 
	`lg_decode_‹m¶©e
(
¢d_lg_t
 *
lg
,

412 
size_t
 
pos
,

413 
¢d_soc_lg_hdr
 *
hdr
,

414 
¢d_lg_obj_‹m¶©e_t
 *
t
);

415 
	`lg_decode_mªiã¡_d©a
(
¢d_lg_t
 *
lg
, 
size_t
 
pos
,

416 
¢d_soc_lg_hdr
 *
hdr
,

417 *
bš
, 
size_t
 
size
);

418 
	`lg_decode_cÚŒŞ_mix”1
(
¢d_lg_t
 *
lg
,

419 
li¡_h—d
 *
h—p
,

420 
¢d_lg_mix”_‹m¶©e
 *
mt
,

421 
size_t
 
pos
,

422 *
bš
, 
size_t
 
size
);

423 
	`lg_decode_cÚŒŞ_mix”
(
¢d_lg_t
 *
lg
, 
size_t
 
pos
,

424 
¢d_soc_lg_hdr
 *
hdr
,

425 *
bš
, 
size_t
 
size
);

426 
	`lg_decode_cÚŒŞ_’um1
(
¢d_lg_t
 *
lg
,

427 
li¡_h—d
 *
h—p
,

428 
¢d_lg_’um_‹m¶©e
 *
‘
,

429 
size_t
 
pos
,

430 
¢d_soc_lg_’um_cÚŒŞ
 *
ec
);

431 
	`lg_decode_cÚŒŞ_’um
(
¢d_lg_t
 *
lg
, 
size_t
 
pos
,

432 
¢d_soc_lg_hdr
 *
hdr
,

433 *
bš
, 
size_t
 
size
);

434 
	`lg_decode_cÚŒŞ_by‹s1
(
¢d_lg_t
 *
lg
,

435 
¢d_lg_by‹s_‹m¶©e
 *
bt
,

436 
size_t
 
pos
,

437 *
bš
, 
size_t
 
size
);

438 
	`lg_decode_cÚŒŞ_by‹s
(
¢d_lg_t
 *
lg
, 
size_t
 
pos
,

439 
¢d_soc_lg_hdr
 *
hdr
,

440 *
bš
, 
size_t
 
size
);

441 
	`lg_decode_d©a
(
¢d_lg_t
 *
lg
, 
size_t
 
pos
,

442 
¢d_soc_lg_hdr
 *
hdr
,

443 *
bš
, 
size_t
 
size
);

444 
	`lg_decode_d­m_g¿ph
(
¢d_lg_t
 *
lg
, 
size_t
 
pos
,

445 
¢d_soc_lg_hdr
 *
hdr
,

446 *
bš
, 
size_t
 
size
);

447 
	`lg_decode_d­m_widg‘
(
¢d_lg_t
 *
lg
, 
size_t
 
pos
,

448 
¢d_soc_lg_hdr
 *
hdr
,

449 *
bš
, 
size_t
 
size
);

450 
	`lg_decode_lšk
(
¢d_lg_t
 *
lg
, 
size_t
 
pos
,

451 
¢d_soc_lg_hdr
 *
hdr
,

452 *
bš
, 
size_t
 
size
);

453 
	`lg_decode_cc
(
¢d_lg_t
 *
lg
, 
size_t
 
pos
,

454 
¢d_soc_lg_hdr
 *
hdr
,

455 *
bš
, 
size_t
 
size
);

456 
	`lg_decode_pcm
(
¢d_lg_t
 *
lg
, 
size_t
 
pos
,

457 
¢d_soc_lg_hdr
 *
hdr
,

458 *
bš
, 
size_t
 
size
);

459 
	`lg_decode_dai
(
¢d_lg_t
 *
lg
, 
size_t
 
pos
,

460 
¢d_soc_lg_hdr
 *
hdr
,

461 *
bš
, 
size_t
 
size
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/main.c

33 
	~"ucm_loÿl.h
"

34 
	~"../cÚŒŞ/cÚŒŞ_loÿl.h
"

35 
	~<¡dboŞ.h
>

36 
	~<ùy³.h
>

37 
	~<¡d¬g.h
>

38 
	~<±h»ad.h
>

39 
	~<sys/¡©.h
>

40 
	~<sys/wa™.h
>

41 
	~<lim™s.h
>

47 
g‘_v®ue
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

48 cÚ¡ *
id’tif›r
,

49 **
v®ue
,

50 cÚ¡ *
mod_dev_Çme
,

51 cÚ¡ *
v”b_Çme
,

52 
exaù
);

53 
g‘_v®ue1
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, **
v®ue
,

54 
li¡_h—d
 *
v®ue_li¡
, cÚ¡ *
id’tif›r
);

55 
g‘_v®ue3
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

56 **
v®ue
,

57 cÚ¡ *
id’tif›r
,

58 
li¡_h—d
 *
v®ue_li¡1
,

59 
li¡_h—d
 *
v®ue_li¡2
,

60 
li¡_h—d
 *
v®ue_li¡3
);

62 
execu‹_£qu’û
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

63 
u£_ÿ£_v”b
 *
v”b
,

64 
li¡_h—d
 *
£q
,

65 
li¡_h—d
 *
v®ue_li¡1
,

66 
li¡_h—d
 *
v®ue_li¡2
,

67 
li¡_h—d
 *
v®ue_li¡3
);

69 
execu‹_compÚ’t_£q
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

70 
compÚ’t_£qu’û
 *
cm±_£q
,

71 
li¡_h—d
 *
v®ue_li¡1
,

72 
li¡_h—d
 *
v®ue_li¡2
,

73 
li¡_h—d
 *
v®ue_li¡3
,

74 *
cdev
);

76 
šlše
 
u£_ÿ£_deviû
 *

77 
fšd_deviû
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
u£_ÿ£_v”b
 *
v”b
,

78 cÚ¡ *
deviû_Çme
, 
check_suµÜ‹d
);

80 
	$check_id’tif›r
(cÚ¡ *
id’tif›r
, cÚ¡ *
´efix
)

82 
Ën
;

84 
Ën
 = 
	`¡¾’
(
´efix
);

85 ià(
	`¡ºcmp
(
id’tif›r
, 
´efix
, 
Ën
) != 0)

88 ià(
id’tif›r
[
Ën
] == 0 || identifier[len] == '/')

92 
	}
}

94 
	$li¡_couÁ
(
li¡_h—d
 *
li¡
)

96 
li¡_h—d
 *
pos
;

97 
couÁ
 = 0;

99 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

100 
couÁ
 += 1;

102  
couÁ
;

103 
	}
}

105 
	$®loc_¡r_li¡
(
li¡_h—d
 *
li¡
, 
muÉ
, **
»suÉ
[])

107 **
»s
;

108 
út
;

110 
út
 = 
	`li¡_couÁ
(
li¡
è* 
muÉ
;

111 ià(
út
 == 0) {

112 *
»suÉ
 = 
NULL
;

113  
út
;

115 
»s
 = 
	`ÿÎoc
(
muÉ
, 
út
 * (*));

116 ià(
»s
 =ğ
NULL
)

117  -
ENOMEM
;

118 *
»suÉ
 = 
»s
;

119  
út
;

120 
	}
}

128 *
	$¢d_u£_ÿ£_id’tif›r
(cÚ¡ *
fmt
, ...)

130 *
¡r
, *
»s
;

131 
size
 = 
	`¡¾’
(
fmt
) + 512;

132 
va_li¡
 
¬gs
;

134 
¡r
 = 
	`m®loc
(
size
);

135 ià(
¡r
 =ğ
NULL
)

136  
NULL
;

137 
	`va_¡¬t
(
¬gs
, 
fmt
);

138 
	`v¢´štf
(
¡r
, 
size
, 
fmt
, 
¬gs
);

139 
	`va_’d
(
¬gs
);

140 
¡r
[
size
-1] = '\0';

141 
»s
 = 
	`»®loc
(
¡r
, 
	`¡¾’
(str) + 1);

142 ià(
»s
)

143  
»s
;

144  
¡r
;

145 
	}
}

153 
	$¢d_u£_ÿ£_ä“_li¡
(cÚ¡ *
li¡
[], 
™ems
)

155 
i
;

156 ià(
li¡
 =ğ
NULL
)

158 
i
 = 0; i < 
™ems
; i++)

159 
	`ä“
((*)
li¡
[
i
]);

160 
	`ä“
(
li¡
);

162 
	}
}

164 
	$»ad_v_fe
(**
»s
,

165 cÚ¡ *
f•©h
)

167 
”r
 = 0;

168 
fd
;

169 
¡©64
 
¡
;

170 
size_t
 
sz
;

171 
ssize_t
 
sz_»ad
;

172 
¢d_ùl_v
 *
v
;

174 
fd
 = 
	`İ’
(
f•©h
, 
O_RDONLY
);

175 ià(
fd
 < 0) {

176 
”r
 = -
”ºo
;

177  
”r
;

179 ià(
	`f¡©64
(
fd
, &
¡
) == -1) {

180 
”r
 = -
”ºo
;

181 
__ç
;

183 
sz
 = 
¡
.
¡_size
;

184 ià(
sz
 > 16 * 1024 * 1024 || sz < 8 || sz % 4) {

185 
	`uc_”rÜ
("File size should be†esshan 16 MB "

187 
”r
 = -
EINVAL
;

188 
__ç
;

190 *
»s
 = 
	`m®loc
(
sz
);

191 ià(
»s
 =ğ
NULL
) {

192 
”r
 = -
ENOMEM
;

193 
__ç
;

195 
sz_»ad
 = 
	`»ad
(
fd
, *
»s
, 
sz
);

196 ià(
sz_»ad
 < 0 || (
size_t
)sz_»ad !ğ
sz
) {

197 
”r
 = -
EIO
;

198 
	`ä“
(*
»s
);

199 *
»s
 = 
NULL
;

202 
v
 = (
¢d_ùl_v
 *)(*
»s
);

203 ià(
v
->
Ëngth
 + 2 * (è!ğ
sz
) {

204 
	`uc_”rÜ
("Inv®idlv size: %d", 
v
->
Ëngth
);

205 
”r
 = -
EINVAL
;

206 
	`ä“
(*
»s
);

207 *
»s
 = 
NULL
;

210 
__ç
:

211 
	`şo£
(
fd
);

212  
”r
;

213 
	}
}

215 
	$bš¬y_fe_·r£
(
¢d_ùl_–em_v®ue_t
 *
d¡
,

216 
¢d_ùl_–em_šfo_t
 *
šfo
,

217 cÚ¡ *
f•©h
)

219 
”r
 = 0;

220 
fd
;

221 
¡©64
 
¡
;

222 
size_t
 
sz
;

223 
ssize_t
 
sz_»ad
;

224 *
»s
;

225 
¢d_ùl_–em_ty³_t
 
ty³
;

226 
idx
, 
couÁ
;

228 
ty³
 = 
	`¢d_ùl_–em_šfo_g‘_ty³
(
šfo
);

229 ià(
ty³
 !ğ
SND_CTL_ELEM_TYPE_BYTES
) {

230 
	`uc_”rÜ
("only support byteype!");

231 
”r
 = -
EINVAL
;

232  
”r
;

234 
fd
 = 
	`İ’
(
f•©h
, 
O_RDONLY
);

235 ià(
fd
 < 0) {

236 
”r
 = -
”ºo
;

237  
”r
;

239 ià(
	`¡©64
(
f•©h
, &
¡
) == -1) {

240 
”r
 = -
”ºo
;

241 
__ç
;

243 
sz
 = 
¡
.
¡_size
;

244 
couÁ
 = 
	`¢d_ùl_–em_šfo_g‘_couÁ
(
šfo
);

245 ià(
sz
 !ğ
couÁ
 || sz > (
d¡
->
v®ue
.
by‹s
)) {

246 
	`uc_”rÜ
("šv®id…¬am‘” siz%d!", 
sz
);

247 
”r
 = -
EINVAL
;

248 
__ç
;

250 
»s
 = 
	`m®loc
(
sz
);

251 ià(
»s
 =ğ
NULL
) {

252 
”r
 = -
ENOMEM
;

253 
__ç
;

255 
sz_»ad
 = 
	`»ad
(
fd
, 
»s
, 
sz
);

256 ià(
sz_»ad
 < 0 || (
size_t
)sz_»ad !ğ
sz
) {

257 
”r
 = -
”ºo
;

258 
__ç_»ad
;

260 
idx
 = 0; idx < 
sz
; idx++)

261 
	`¢d_ùl_–em_v®ue_£t_by‹
(
d¡
, 
idx
, *(
»s
 + idx));

262 
__ç_»ad
:

263 
	`ä“
(
»s
);

264 
__ç
:

265 
	`şo£
(
fd
);

266  
”r
;

267 
	}
}

269 cÚ¡ *
	$·r£_ty³
(cÚ¡ *
p
, cÚ¡ *
´efix
, 
size_t
 
Ën
,

270 
¢d_ùl_–em_šfo_t
 *
šfo
)

272 ià(
	`¡ºÿ£cmp
(
p
, 
´efix
, 
Ën
))

273  
p
;

274 
p
 +ğ
Ën
;

275 ià(
šfo
->
ty³
 !ğ
SND_CTL_ELEM_TYPE_NONE
)

276  
NULL
;

277 ià(
	`¡ºÿ£cmp
(
p
, "bool", ("bool") - 1) == 0)

278 
šfo
->
ty³
 = 
SND_CTL_ELEM_TYPE_BOOLEAN
;

279 ià(
	`¡ºÿ£cmp
(
p
, "integer64", ("integer64") - 1) == 0)

280 
šfo
->
ty³
 = 
SND_CTL_ELEM_TYPE_INTEGER64
;

281 ià(
	`¡ºÿ£cmp
(
p
, "int64", ("int64") - 1) == 0)

282 
šfo
->
ty³
 = 
SND_CTL_ELEM_TYPE_INTEGER64
;

283 ià(
	`¡ºÿ£cmp
(
p
, "int", ("int") - 1) == 0)

284 
šfo
->
ty³
 = 
SND_CTL_ELEM_TYPE_INTEGER
;

285 ià(
	`¡ºÿ£cmp
(
p
, "enum", ("enum") - 1) == 0)

286 
šfo
->
ty³
 = 
SND_CTL_ELEM_TYPE_ENUMERATED
;

287 ià(
	`¡ºÿ£cmp
(
p
, "bytes", ("bytes") - 1) == 0)

288 
šfo
->
ty³
 = 
SND_CTL_ELEM_TYPE_BYTES
;

290  
NULL
;

291 
	`i§Íha
(*
p
))

292 
p
++;

293  
p
;

294 
	}
}

296 cÚ¡ *
	$·r£_ušt
(cÚ¡ *
p
, cÚ¡ *
´efix
, 
size_t
 
Ën
,

297 
mš
, 
max
, *
rv®
)

299 
v
;

300 *
’d
;

302 ià(
	`¡ºÿ£cmp
(
p
, 
´efix
, 
Ën
))

303  
p
;

304 
p
 +ğ
Ën
;

305 
v
 = 
	`¡¹Ş
(
p
, &
’d
, 0);

306 ià(*
’d
 != '\0' && *end != ' ' && *end != ',') {

307 
	`uc_”rÜ
("uÇbËØ·r£ '%s'", 
´efix
);

308  
NULL
;

310 ià(()
v
 < 
mš
 || ()v > 
max
) {

311 
	`uc_”rÜ
("v®u'%s' ouˆoà¿ng%u-%u %(%ld)", 
mš
, 
max
, 
v
);

312  
NULL
;

314 *
rv®
 = 
v
;

315  
’d
;

316 
	}
}

318 cÚ¡ *
	$·r£_Ïb–s
(cÚ¡ *
p
, cÚ¡ *
´efix
, 
size_t
 
Ën
,

319 
¢d_ùl_–em_šfo_t
 *
šfo
)

321 cÚ¡ *
s
;

322 *
buf
, *
bp
;

323 
size_t
 
l
;

324 
c
;

326 ià(
šfo
->
ty³
 !ğ
SND_CTL_ELEM_TYPE_ENUMERATED
)

327  
NULL
;

328 ià(
	`¡ºÿ£cmp
(
p
, 
´efix
, 
Ën
))

329  
p
;

330 
p
 +ğ
Ën
;

331 
s
 = 
p
;

332 
c
 = *
s
;

333 
l
 = 0;

334 ià(
c
 == '\'' || c == '\"') {

335 
s
++;

336 *
s
 && * !ğ
c
) {

337 
s
++, 
l
++;

339 ià(*
s
 =ğ
c
)

340 
s
++;

342 *
s
 && *s != ',')

343 
l
++;

345 ià(
l
 == 0)

346  
NULL
;

347 
buf
 = 
	`m®loc
(
l
 + 1);

348 ià(
buf
 =ğ
NULL
)

349  
NULL
;

350 
	`memıy
(
buf
, 
p
 + ((
c
 =ğ'\'' || c =ğ'\"'è? 1 : 0), 
l
);

351 
buf
[
l
] = '\0';

352 
šfo
->
v®ue
.
’um”©ed
.
™ems
 = 1;

353 
bp
 = 
buf
; *bp; bp++) {

354 ià(*
bp
 == ';') {

355 ià(
bp
 =ğ
buf
 || bp[1] == ';') {

356 
	`ä“
(
buf
);

357  
NULL
;

359 
šfo
->
v®ue
.
’um”©ed
.
™ems
++;

360 *
bp
 = '\0';

363 
šfo
->
v®ue
.
’um”©ed
.
Çmes_±r
 = (
ušŒ_t
)
buf
;

364 
šfo
->
v®ue
.
’um”©ed
.
Çmes_Ëngth
 = 
l
 + 1;

365  
s
;

366 
	}
}

368 
	$·r£_c£t_Ãw_šfo
(
¢d_ùl_–em_šfo_t
 *
šfo
, cÚ¡ *
s
, cÚ¡ **
pos
)

370 cÚ¡ *
p
 = 
s
, *
İ
;

372 
šfo
->
couÁ
 = 1;

373 *
s
) {

374 
İ
 = 
p
;

375 
p
 = 
	`·r£_ty³
Õ, "ty³=", ("ty³="è- 1, 
šfo
);

376 ià(
p
 !ğ
İ
)

377 
Ãxt
;

378 
p
 = 
	`·r£_ušt
Õ, "–em’ts=", ("–em’ts="è- 1, 1, 128, (*)&
šfo
->
owÃr
);

379 ià(
p
 !ğ
İ
)

380 
Ãxt
;

381 
p
 = 
	`·r£_ušt
Õ, "couÁ=", ("couÁ="è- 1, 1, 128, &
šfo
->
couÁ
);

382 ià(
p
 !ğ
İ
)

383 
Ãxt
;

384 
p
 = 
	`·r£_Ïb–s
Õ, "Ïb–s=", ("Ïb–s="è- 1, 
šfo
);

385 
Ãxt
:

386 ià(
p
 =ğ
NULL
)

387 
”
;

388 ià(*
p
 == ',')

389 
p
++;

390 ià(
	`is¥aû
(*
p
))

392 ià(
İ
 =ğ
p
)

393 
”
;

395 *
pos
 = 
p
;

397 
”
:

398 
	`uc_”rÜ
("unknowÀsyÁax '%s'", 
p
);

399  -
EINVAL
;

400 
	}
}

402 
	$execu‹_c£t
(
¢d_ùl_t
 *
ùl
, cÚ¡ *
c£t
, 
ty³
)

404 cÚ¡ *
pos
;

405 
”r
;

406 
¢d_ùl_–em_id_t
 *
id
;

407 
¢d_ùl_–em_v®ue_t
 *
v®ue
;

408 
¢d_ùl_–em_šfo_t
 *
šfo
, *
šfo2
 = 
NULL
;

409 *
»s
 = 
NULL
;

411 
	`¢d_ùl_–em_id_m®loc
(&
id
);

412 
	`¢d_ùl_–em_v®ue_m®loc
(&
v®ue
);

413 
	`¢d_ùl_–em_šfo_m®loc
(&
šfo
);

415 
”r
 = 
	`__¢d_ùl_ascii_–em_id_·r£
(
id
, 
c£t
, &
pos
);

416 ià(
”r
 < 0)

417 
__ç
;

418 *
pos
 && 
	`is¥aû
(*pos))

419 
pos
++;

420 ià(
ty³
 =ğ
SEQUENCE_ELEMENT_TYPE_CSET_NEW
) {

421 
	`¢d_ùl_–em_šfo_m®loc
(&
šfo2
);

422 
	`¢d_ùl_–em_šfo_£t_id
(
šfo2
, 
id
);

423 
”r
 = 
	`·r£_c£t_Ãw_šfo
(
šfo2
, 
pos
, &pos);

424 ià(
”r
 < 0 || !*
pos
) {

425 
	`uc_”rÜ
("undefšed o¸wrÚg id cÚfig fÜ c£t-Ãw", 
c£t
);

426 
”r
 = -
EINVAL
;

427 
__ç
;

429 *
pos
 && 
	`is¥aû
(*pos))

430 
pos
++;

432 ià(!*
pos
) {

433 ià(
ty³
 !ğ
SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
) {

434 
	`uc_”rÜ
("undefšed v®ufÜ c£ˆ>%s<", 
c£t
);

435 
”r
 = -
EINVAL
;

436 
__ç
;

438 } ià(
ty³
 =ğ
SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
) {

439 
	`uc_”rÜ
("exŒ¨v®ufÜ c-»mov>%s<", 
c£t
);

440 
”r
 = -
EINVAL
;

441 
__ç
;

444 
	`¢d_ùl_–em_šfo_£t_id
(
šfo
, 
id
);

445 
”r
 = 
	`¢d_ùl_–em_šfo
(
ùl
, 
šfo
);

446 ià(
ty³
 =ğ
SEQUENCE_ELEMENT_TYPE_CSET_NEW
 ||

447 
ty³
 =ğ
SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
) {

448 ià(
”r
 >= 0) {

449 
”r
 = 
	`¢d_ùl_–em_»move
(
ùl
, 
id
);

450 ià(
”r
 < 0) {

451 
	`uc_”rÜ
("unableo„emove control");

452 
”r
 = -
EINVAL
;

453 
__ç
;

456 ià(
ty³
 =ğ
SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
)

457 
__ok
;

458 
”r
 = 
	`__¢d_ùl_add_–em_£t
(
ùl
, 
šfo2
, info2->
owÃr
, info2->
couÁ
);

459 ià(
”r
 < 0) {

460 
	`uc_”rÜ
("unableo create‚ew control");

461 
__ç
;

464 
	`¢d_ùl_–em_šfo_g‘_id
(
šfo2
, 
id
);

465 
	`¢d_ùl_–em_šfo_£t_id
(
šfo
, 
id
);

466 } ià(
”r
 < 0)

467 
__ç
;

468 ià(
ty³
 =ğ
SEQUENCE_ELEMENT_TYPE_CSET_TLV
) {

469 ià(!
	`¢d_ùl_–em_šfo_is_v_wr™abË
(
šfo
)) {

470 
”r
 = -
EINVAL
;

471 
__ç
;

473 
”r
 = 
	`»ad_v_fe
(&
»s
, 
pos
);

474 ià(
”r
 < 0)

475 
__ç
;

476 
”r
 = 
	`¢d_ùl_–em_v_wr™e
(
ùl
, 
id
, 
»s
);

477 ià(
”r
 < 0)

478 
__ç
;

480 
	`¢d_ùl_–em_v®ue_£t_id
(
v®ue
, 
id
);

481 
”r
 = 
	`¢d_ùl_–em_»ad
(
ùl
, 
v®ue
);

482 ià(
”r
 < 0)

483 
__ç
;

484 ià(
ty³
 =ğ
SEQUENCE_ELEMENT_TYPE_CSET_BIN_FILE
)

485 
”r
 = 
	`bš¬y_fe_·r£
(
v®ue
, 
šfo
, 
pos
);

487 
”r
 = 
	`¢d_ùl_ascii_v®ue_·r£
(
ùl
, 
v®ue
, 
šfo
, 
pos
);

488 ià(
”r
 < 0)

489 
__ç
;

490 
”r
 = 
	`¢d_ùl_–em_wr™e
(
ùl
, 
v®ue
);

491 ià(
”r
 < 0)

492 
__ç
;

493 ià(
ty³
 =ğ
SEQUENCE_ELEMENT_TYPE_CSET_NEW
) {

494 
idx
;

495 
idx
 = 1; idx < ()
šfo2
->
owÃr
; idx++) {

496 
v®ue
->
id
.
numid
 += 1;

497 
”r
 = 
	`¢d_ùl_–em_wr™e
(
ùl
, 
v®ue
);

498 ià(
”r
 < 0)

499 
__ç
;

503 
__ok
:

504 
”r
 = 0;

505 
__ç
:

506 
	`ä“
(
id
);

507 
	`ä“
(
v®ue
);

508 ià(
šfo2
) {

509 ià(
šfo2
->
ty³
 =ğ
SND_CTL_ELEM_TYPE_ENUMERATED
)

510 
	`ä“
((*)(
size_t
)
šfo2
->
v®ue
.
’um”©ed
.
Çmes_±r
);

511 
	`ä“
(
šfo2
);

513 
	`ä“
(
šfo
);

514 
	`ä“
(
»s
);

516  
”r
;

517 
	}
}

519 
	$execu‹_sysw
(cÚ¡ *
sysw
)

521 
·th
[
PATH_MAX
];

522 cÚ¡ *
e
;

523 *
s
, *
v®ue
;

524 
ssize_t
 
wËn
;

525 
size_t
 
Ën
;

526 
fd
, 
my”ºo
;

527 
boŞ
 
ignÜe_”rÜ
 = 
çl£
;

529 ià(
sysw
 =ğ
NULL
 || *sysw == '\0')

532 ià(
sysw
[0] == '-') {

533 
ignÜe_”rÜ
 = 
Œue
;

534 
sysw
++;

537 ià(
sysw
[0] == ':')

538  -
EINVAL
;

540 
s
 = 
	`¡rdup
(
sysw
[0] != '/' ? sysw : sysw + 1);

541 ià(
s
 =ğ
NULL
)

542  -
ENOMEM
;

544 
v®ue
 = 
	`¡rchr
(
s
, ':');

545 ià(!
v®ue
) {

546 
	`ä“
(
s
);

547  -
EINVAL
;

549 *
v®ue
 = '\0';

550 
v®ue
++;

551 
Ën
 = 
	`¡¾’
(
v®ue
);

552 ià(
Ën
 < 1) {

553 
	`ä“
(
s
);

554  -
EINVAL
;

557 
e
 = 
	`uc_mgr_sysfs_roÙ
();

558 ià(
e
 =ğ
NULL
) {

559 
	`ä“
(
s
);

560  -
EINVAL
;

562 
	`¢´štf
(
·th
, Õ©h), "%s/%s", 
e
, 
s
);

564 
fd
 = 
	`İ’
(
·th
, 
O_WRONLY
|
O_CLOEXEC
);

565 ià(
fd
 < 0) {

566 
	`ä“
(
s
);

567 ià(
ignÜe_”rÜ
)

569 
	`uc_”rÜ
("uÇbËØİ’ '%s' fÜ wr™e", 
·th
);

570  -
EINVAL
;

572 
wËn
 = 
	`wr™e
(
fd
, 
v®ue
, 
Ën
);

573 
my”ºo
 = 
”ºo
;

574 
	`şo£
(
fd
);

576 ià(
ignÜe_”rÜ
)

577 
__’d
;

579 ià(
wËn
 !ğ(
ssize_t
)
Ën
) {

580 
	`uc_”rÜ
("uÇbËØwr™'%s'Ø'%s': %s", 
v®ue
, 
·th
, 
	`¡»¼Ü
(
my”ºo
));

581 
	`ä“
(
s
);

582  -
EINVAL
;

585 
__’d
:

586 
	`ä“
(
s
);

588 
	}
}

590 
_¢d_cÚfig_§ve_node_v®ue
(
¢d_cÚfig_t
 *
n
, 
¢d_ouut_t
 *
out
, 
Ëv–
);

592 
	$execu‹_cfg§ve
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
f’ame
)

594 
¢d_cÚfig_t
 *
cÚfig
 = 
uc_mgr
->
loÿl_cÚfig
;

595 *
fe
, *
roÙ
;

596 
¢d_ouut_t
 *
out
;

597 
boŞ
 
w™h_roÙ
 = 
çl£
;

598 
”r
 = 0;

600 
fe
 = 
	`¡rdup
(
f’ame
);

601 ià(!
fe
)

602  -
ENOMEM
;

603 
roÙ
 = 
	`¡rchr
(
fe
, ':');

604 ià(
cÚfig
 && 
roÙ
) {

605 *
roÙ
++ = '\0';

606 ià(*
roÙ
 == '+') {

607 
w™h_roÙ
 = 
Œue
;

608 
roÙ
++;

610 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cÚfig
, 
roÙ
, &config);

611 ià(
”r
 < 0) {

612 
	`uc_”rÜ
("UÇbËØfšd subŒ“ '%s'", 
roÙ
);

613 
_”r
;

617 
”r
 = 
	`¢d_ouut_¡dio_İ’
(&
out
, 
fe
, "w+");

618 ià(
”r
 < 0) {

619 
	`uc_”rÜ
("uÇbËØİ’ f'%s': %s", 
fe
, 
	`¢d_¡»¼Ü
(
”r
));

620 
_”r
;

622 ià(!
cÚfig
 || 
	`¢d_cÚfig_is_em±y
(config)) {

623 
	`¢d_ouut_şo£
(
out
);

624 
_”r
;

626 ià(
w™h_roÙ
) {

627 
	`¢d_ouut_´štf
(
out
, "% ", 
roÙ
);

628 
”r
 = 
	`_¢d_cÚfig_§ve_node_v®ue
(
cÚfig
, 
out
, 0);

630 
”r
 = 
	`¢d_cÚfig_§ve
(
cÚfig
, 
out
);

632 
	`¢d_ouut_şo£
(
out
);

633 ià(
”r
 < 0) {

634 
	`uc_”rÜ
("uÇbËØ§vcÚfigu¿tiÚ: %s", 
	`¢d_¡»¼Ü
(
”r
));

635 
_”r
;

637 
_”r
:

638 
	`ä“
(
fe
);

639  
”r
;

640 
	}
}

642 
	$»wr™e_deviû_v®ue
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
Çme
, **
v®ue
)

644 *
sv®
;

645 
size_t
 
l
;

646 cÚ¡ **
s
, *
_´efix
[] = {

653 
NULL


656 ià(!
	`uc_mgr_has_loÿl_cÚfig
(
uc_mgr
))

658 
s
 = 
_´efix
; * && *
v®ue
; s++) {

659 ià(
	`¡rcmp
(*
s
, 
Çme
) != 0)

661 
l
 = 
	`¡¾’
(*
v®ue
) + 9 + 1;

662 
sv®
 = 
	`m®loc
(
l
);

663 ià(
sv®
 =ğ
NULL
) {

664 
	`ä“
(*
v®ue
);

665 *
v®ue
 = 
NULL
;

666  -
ENOMEM
;

668 
	`¢´štf
(
sv®
, 
l
, "_ucm%04X.%s", 
uc_mgr
->
ucm_ÿrd_numb”
, *
v®ue
);

669 
	`ä“
(*
v®ue
);

670 *
v®ue
 = 
sv®
;

674 
	}
}

676 
	$run_deviû_£qu’û
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
u£_ÿ£_v”b
 *
v”b
,

677 cÚ¡ *
Çme
, 
boŞ
 
’abË
)

679 
u£_ÿ£_deviû
 *
deviû
;

681 ià(
v”b
 =ğ
NULL
) {

682 
	`uc_”rÜ
("error:ƒnadev2 / disdev2 must beƒxecuted insidehe verb context");

683  -
ENOENT
;

686 
deviû
 = 
	`fšd_deviû
(
uc_mgr
, 
v”b
, 
Çme
, 0);

687 ià(
deviû
 =ğ
NULL
) {

688 
	`uc_”rÜ
("”rÜ: uÇbËØfšd deviû '%s'\n", 
Çme
);

689  -
ENOENT
;

692  
	`execu‹_£qu’û
(
uc_mgr
, 
v”b
,

693 
’abË
 ? &
deviû
->
’abË_li¡
 : &deviû->
di§bË_li¡
,

694 &
deviû
->
v®ue_li¡
,

695 &
v”b
->
v®ue_li¡
,

696 &
uc_mgr
->
v®ue_li¡
);

697 
	}
}

699 
	$run_deviû_®l_£qu’û
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
u£_ÿ£_v”b
 *
v”b
)

701 
u£_ÿ£_deviû
 *
deviû
;

702 
li¡_h—d
 *
pos
;

703 
”r
;

705 ià(
v”b
 =ğ
NULL
) {

706 
	`uc_”rÜ
("error: disdevall must beƒxecuted insidehe verb context");

707  -
ENOENT
;

710 
	`li¡_fÜ_—ch
(
pos
, &
v”b
->
deviû_li¡
) {

711 
deviû
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_deviû
, 
li¡
);

713 
”r
 = 
	`execu‹_£qu’û
(
uc_mgr
, 
v”b
,

714 &
deviû
->
di§bË_li¡
,

715 &
deviû
->
v®ue_li¡
,

716 &
v”b
->
v®ue_li¡
,

717 &
uc_mgr
->
v®ue_li¡
);

718 ià(
”r
 < 0)

719  
”r
;

722 
	}
}

730 
	$execu‹_£qu’û
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

731 
u£_ÿ£_v”b
 *
v”b
,

732 
li¡_h—d
 *
£q
,

733 
li¡_h—d
 *
v®ue_li¡1
,

734 
li¡_h—d
 *
v®ue_li¡2
,

735 
li¡_h—d
 *
v®ue_li¡3
)

737 
li¡_h—d
 *
pos
;

738 
£qu’û_–em’t
 *
s
;

739 *
cdev
 = 
NULL
;

740 
¢d_ùl_t
 *
ùl
 = 
NULL
;

741 
ùl_li¡
 *ctl_list;

742 
boŞ
 
ignÜe_”rÜ
;

743 
”r
 = 0;

745 ià(
uc_mgr
->
£qu’û_hİs
 > 100) {

746 
	`uc_”rÜ
("error:oo many inner sequences!");

747  -
EINVAL
;

749 
uc_mgr
->
£qu’û_hİs
++;

750 
	`li¡_fÜ_—ch
(
pos
, 
£q
) {

751 
s
 = 
	`li¡_’Œy
(
pos
, 
£qu’û_–em’t
, 
li¡
);

752 
s
->
ty³
) {

753 
SEQUENCE_ELEMENT_TYPE_CDEV
:

754 
cdev
 = 
	`¡rdup
(
s
->
d©a
.cdev);

755 ià(
cdev
 =ğ
NULL
)

756 
__ç_nomem
;

757 ià(
	`»wr™e_deviû_v®ue
(
uc_mgr
, "PÏybackCTL", &
cdev
))

758 
__ç_nomem
;

760 
SEQUENCE_ELEMENT_TYPE_CSET
:

761 
SEQUENCE_ELEMENT_TYPE_CSET_BIN_FILE
:

762 
SEQUENCE_ELEMENT_TYPE_CSET_TLV
:

763 
SEQUENCE_ELEMENT_TYPE_CSET_NEW
:

764 
SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
:

765 ià(
cdev
 =ğ
NULL
 && 
uc_mgr
->
š_compÚ’t_domaš
) {

769 ià(
uc_mgr
->
cdev
 =ğ
NULL
) {

770 
	`uc_”rÜ
("cdev is‚ot defined!");

771  
”r
;

774 
cdev
 = 
	`¡ºdup
(
uc_mgr
->cdev, 
PATH_MAX
);

775 ià(!
cdev
)

776  -
ENOMEM
;

777 } ià(
cdev
 =ğ
NULL
) {

778 *
¶ayback_ùl
 = 
NULL
;

779 *
ÿ±u»_ùl
 = 
NULL
;

781 
”r
 = 
	`g‘_v®ue3
(
uc_mgr
, &
¶ayback_ùl
, "PlaybackCTL",

782 
v®ue_li¡1
,

783 
v®ue_li¡2
,

784 
v®ue_li¡3
);

785 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

786 
	`uc_”rÜ
("cdev is‚ot defined!");

787  
”r
;

789 
”r
 = 
	`g‘_v®ue3
(
uc_mgr
, &
ÿ±u»_ùl
, "CaptureCTL",

790 
v®ue_li¡1
,

791 
v®ue_li¡2
,

792 
v®ue_li¡3
);

793 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

794 
	`ä“
(
¶ayback_ùl
);

795 
	`uc_”rÜ
("cdev is‚ot defined!");

796  
”r
;

798 ià(
¶ayback_ùl
 =ğ
NULL
 &&

799 
ÿ±u»_ùl
 =ğ
NULL
) {

800 
	`uc_”rÜ
("cdev is‚ot defined!");

801  -
EINVAL
;

803 ià(
¶ayback_ùl
 !ğ
NULL
 &&

804 
ÿ±u»_ùl
 !ğ
NULL
 &&

805 
	`¡rcmp
(
¶ayback_ùl
, 
ÿ±u»_ùl
) != 0) {

806 
	`ä“
(
¶ayback_ùl
);

807 
	`ä“
(
ÿ±u»_ùl
);

808 
	`uc_”rÜ
("cdev is‚otƒqual for…layback‡nd capture!");

809  -
EINVAL
;

811 ià(
¶ayback_ùl
 !ğ
NULL
) {

812 
cdev
 = 
¶ayback_ùl
;

813 
	`ä“
(
ÿ±u»_ùl
);

815 
cdev
 = 
ÿ±u»_ùl
;

818 ià(
ùl
 =ğ
NULL
) {

819 
”r
 = 
	`uc_mgr_İ’_ùl
(
uc_mgr
, &
ùl_li¡
, 
cdev
, 1);

820 ià(
”r
 < 0) {

821 
	`uc_”rÜ
("uÇbËØİ’ c deviû '%s'", 
cdev
);

822 
__ç
;

824 
ùl
 = 
ùl_li¡
->ctl;

826 
”r
 = 
	`execu‹_c£t
(
ùl
, 
s
->
d©a
.
c£t
, s->
ty³
);

827 ià(
”r
 < 0) {

828 
	`uc_”rÜ
("uÇbËØexecu‹ c£ˆ'%s'", 
s
->
d©a
.
c£t
);

829 
__ç
;

832 
SEQUENCE_ELEMENT_TYPE_SYSSET
:

833 
”r
 = 
	`execu‹_sysw
(
s
->
d©a
.
sysw
);

834 ià(
”r
 < 0)

835 
__ç
;

837 
SEQUENCE_ELEMENT_TYPE_SLEEP
:

838 
	`u¦“p
(
s
->
d©a
.
¦“p
);

840 
SEQUENCE_ELEMENT_TYPE_EXEC
:

841 ià(
s
->
d©a
.
exec
 =ğ
NULL
)

843 
ignÜe_”rÜ
 = 
s
->
d©a
.
exec
[0] == '-';

844 
”r
 = 
	`uc_mgr_exec
(
s
->
d©a
.
exec
 + (
ignÜe_”rÜ
 ? 1 : 0));

845 ià(
ignÜe_”rÜ
 =ğ
çl£
 && 
”r
 != 0) {

846 
	`uc_”rÜ
("exeø'%s' faed (ex™ cod%d)", 
s
->
d©a
.
exec
, 
”r
);

847 
__ç
;

850 
SEQUENCE_ELEMENT_TYPE_SHELL
:

851 ià(
s
->
d©a
.
exec
 =ğ
NULL
)

853 
ignÜe_”rÜ
 = 
s
->
d©a
.
exec
[0] == '-';

854 
sh–l_»Œy
:

855 
”r
 = 
	`sy¡em
(
s
->
d©a
.
exec
 + (
ignÜe_”rÜ
 ? 1 : 0));

856 ià(
	`WIFSIGNALED
(
”r
)) {

857 
”r
 = -
EINTR
;

858 } ià(
	`WIFEXITED
(
”r
)) {

859 ià(
ignÜe_”rÜ
 =ğ
çl£
 && 
	`WEXITSTATUS
(
”r
) != 0) {

860 
	`uc_”rÜ
("commªd '%s' faed (ex™ cod%d)", 
s
->
d©a
.
exec
, 
	`WEXITSTATUS
(
”r
));

861 
”r
 = -
EINVAL
;

862 
__ç
;

864 } ià(
”r
 < 0) {

865 ià(
”ºo
 =ğ
EAGAIN
)

866 
sh–l_»Œy
;

867 
”r
 = -
”ºo
;

868 
__ç
;

871 
SEQUENCE_ELEMENT_TYPE_CMPT_SEQ
:

875 
”r
 = 
	`execu‹_compÚ’t_£q
(
uc_mgr
,

876 &
s
->
d©a
.
cm±_£q
,

877 
v®ue_li¡1
,

878 
v®ue_li¡2
,

879 
v®ue_li¡3
,

880 
cdev
);

881 ià(
”r
 < 0)

882 
__ç
;

884 
SEQUENCE_ELEMENT_TYPE_CFGSAVE
:

885 
”r
 = 
	`execu‹_cfg§ve
(
uc_mgr
, 
s
->
d©a
.
cfg§ve
);

886 ià(
”r
 < 0)

887 
__ç
;

889 
SEQUENCE_ELEMENT_TYPE_DEV_ENABLE_SEQ
:

890 
SEQUENCE_ELEMENT_TYPE_DEV_DISABLE_SEQ
:

891 
”r
 = 
	`run_deviû_£qu’û
(
uc_mgr
, 
v”b
, 
s
->
d©a
.
deviû
,

892 
s
->
ty³
 =ğ
SEQUENCE_ELEMENT_TYPE_DEV_ENABLE_SEQ
);

893 ià(
”r
 < 0)

894 
__ç
;

896 
SEQUENCE_ELEMENT_TYPE_DEV_DISABLE_ALL
:

897 
”r
 = 
	`run_deviû_®l_£qu’û
(
uc_mgr
, 
v”b
);

898 ià(
”r
 < 0)

899 
__ç
;

902 
	`uc_”rÜ
("unknowÀ£qu’û commªd %i", 
s
->
ty³
);

906 
	`ä“
(
cdev
);

907 
uc_mgr
->
£qu’û_hİs
--;

909 
__ç_nomem
:

910 
”r
 = -
ENOMEM
;

911 
__ç
:

912 
	`ä“
(
cdev
);

913 
uc_mgr
->
£qu’û_hİs
--;

914  
”r
;

916 
	}
}

927 
	$execu‹_compÚ’t_£q
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

928 
compÚ’t_£qu’û
 *
cm±_£q
,

929 
li¡_h—d
 *
v®ue_li¡1
 
ATTRIBUTE_UNUSED
,

930 
li¡_h—d
 *
v®ue_li¡2
 
ATTRIBUTE_UNUSED
,

931 
li¡_h—d
 *
v®ue_li¡3
 
ATTRIBUTE_UNUSED
,

932 *
cdev
)

934 
u£_ÿ£_deviû
 *
deviû
 = 
cm±_£q
->device;

935 
li¡_h—d
 *
£q
;

936 
”r
;

939 
uc_mgr
->
š_compÚ’t_domaš
 = 1;

940 
uc_mgr
->
cdev
 = cdev;

943 ià(
cm±_£q
->
’abË
)

944 
£q
 = &
deviû
->
’abË_li¡
;

946 
£q
 = &
deviû
->
di§bË_li¡
;

949 
”r
 = 
	`execu‹_£qu’û
(
uc_mgr
, uc_mgr->
aùive_v”b
, 
£q
,

950 &
deviû
->
v®ue_li¡
,

951 &
uc_mgr
->
aùive_v”b
->
v®ue_li¡
,

952 &
uc_mgr
->
v®ue_li¡
);

955 
uc_mgr
->
š_compÚ’t_domaš
 = 0;

956 
uc_mgr
->
cdev
 = 
NULL
;

958  
”r
;

959 
	}
}

961 
	$add_auto_v®ue
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
key
, *
v®ue
)

963 *
s
;

964 
”r
;

966 
”r
 = 
	`g‘_v®ue1
(
uc_mgr
, &
v®ue
, &uc_mgr->
v®ue_li¡
, 
key
);

967 ià(
”r
 =ğ-
ENOENT
) {

968 
s
 = 
	`¡rdup
(
v®ue
);

969 ià(
s
 =ğ
NULL
)

970  -
ENOMEM
;

971  
	`uc_mgr_add_v®ue
(&
uc_mgr
->
v®ue_li¡
, 
key
, 
s
);

972 } ià(
”r
 < 0) {

973  
”r
;

975 
	`ä“
(
v®ue
);

977 
	}
}

979 
	$add_auto_v®ues
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

981 
ùl_li¡
 *ctl_list;

982 cÚ¡ *
id
;

983 
buf
[40];

984 
”r
;

986 
ùl_li¡
 = 
	`uc_mgr_g‘_ma¡”_ùl
(
uc_mgr
);

987 ià(
ùl_li¡
) {

988 
id
 = 
	`¢d_ùl_ÿrd_šfo_g‘_id
(
ùl_li¡
->
ùl_šfo
);

989 
	`¢´štf
(
buf
, (buf), "hw:%s", 
id
);

990 
”r
 = 
	`add_auto_v®ue
(
uc_mgr
, "PÏybackCTL", 
buf
);

991 ià(
”r
 < 0)

992  
”r
;

993 
”r
 = 
	`add_auto_v®ue
(
uc_mgr
, "C­tu»CTL", 
buf
);

994 ià(
”r
 < 0)

995  
”r
;

998 
	}
}

1006 
	$£t_deçuÉs
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
boŞ
 
fÜû
)

1008 
”r
;

1010 ià(!
fÜû
 && 
uc_mgr
->
deçuÉ_li¡_execu‹d
)

1012 
”r
 = 
	`execu‹_£qu’û
(
uc_mgr
, 
NULL
, &uc_mgr->
deçuÉ_li¡
,

1013 &
uc_mgr
->
v®ue_li¡
, 
NULL
, NULL);

1014 ià(
”r
 < 0) {

1015 
	`uc_”rÜ
("Unableoƒxecute default sequence");

1016  
”r
;

1018 
uc_mgr
->
deçuÉ_li¡_execu‹d
 = 1;

1020 
	}
}

1027 
	$impÜt_ma¡”_cÚfig
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

1029 
”r
;

1031 
”r
 = 
	`uc_mgr_impÜt_ma¡”_cÚfig
(
uc_mgr
);

1032 ià(
”r
 < 0)

1033  
”r
;

1034  
	`add_auto_v®ues
(
uc_mgr
);

1035 
	}
}

1042 
	$check_em±y_cÚfigu¿tiÚ
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

1044 
”r
;

1045 *
v®ue
;

1047 
”r
 = 
	`g‘_v®ue
(
uc_mgr
, "Lšked", &
v®ue
, 
NULL
, NULL, 1);

1048 ià(
”r
 >= 0) {

1049 
”r
 = 
	`¡rÿ£cmp
(
v®ue
, "true") == 0 ||

1050 
	`¡rcmp
(
v®ue
, "1") == 0;

1051 
	`ä“
(
v®ue
);

1052 ià(
”r
)

1055 ià(!
	`li¡_em±y
(&
uc_mgr
->
v”b_li¡
))

1057 ià(!
	`li¡_em±y
(&
uc_mgr
->
fixedboÙ_li¡
))

1059 ià(!
	`li¡_em±y
(&
uc_mgr
->
boÙ_li¡
))

1061  -
ENXIO
;

1062 
	}
}

1072 *
	$fšd0
(
li¡_h—d
 *
li¡
,

1073 
off£t
,

1074 
soff£t
,

1075 cÚ¡ *
m©ch
)

1077 
li¡_h—d
 *
pos
;

1078 *
±r
, *
¡r
;

1080 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

1081 
±r
 = 
	`li¡_’Œy_off£t
(
pos
, , 
off£t
);

1082 
¡r
 = *((**)(
±r
 + 
soff£t
));

1083 ià(
	`¡rcmp
(
¡r
, 
m©ch
) == 0)

1084  
±r
;

1086  
NULL
;

1087 
	}
}

1089 
	#fšd
(
li¡
, 
ty³
, 
memb”
, 
v®ue
, 
m©ch
) \

1090 
	`fšd0
(
li¡
, ()(&((
ty³
 *)0)->
memb”
), \

1091 ()(&((
ty³
 *)0)->
v®ue
), 
m©ch
)

	)

1101 
	$g‘_li¡0
(
li¡_h—d
 *
li¡
,

1102 cÚ¡ **
»suÉ
[],

1103 
off£t
,

1104 
s1off£t
)

1106 **
»s
;

1107 
út
;

1108 
li¡_h—d
 *
pos
;

1109 *
±r
, *
¡r1
;

1111 
út
 = 
	`®loc_¡r_li¡
(
li¡
, 1, &
»s
);

1112 ià(
út
 <= 0) {

1113 *
»suÉ
 = 
NULL
;

1114  
út
;

1116 *
»suÉ
 = (cÚ¡ **)
»s
;

1117 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

1118 
±r
 = 
	`li¡_’Œy_off£t
(
pos
, , 
off£t
);

1119 
¡r1
 = *((**)(
±r
 + 
s1off£t
));

1120 ià(
¡r1
 !ğ
NULL
) {

1121 *
»s
 = 
	`¡rdup
(
¡r1
);

1122 ià(*
»s
 =ğ
NULL
)

1123 
__ç
;

1125 *
»s
 = 
NULL
;

1127 
»s
++;

1129  
út
;

1130 
__ç
:

1131 
	`¢d_u£_ÿ£_ä“_li¡
(*
»suÉ
, 
út
);

1132  -
ENOMEM
;

1133 
	}
}

1135 
	#g‘_li¡
(
li¡
, 
»suÉ
, 
ty³
, 
memb”
, 
s1
) \

1136 
	`g‘_li¡0
(
li¡
, 
»suÉ
, \

1137 ()(&((
ty³
 *)0)->
memb”
), \

1138 ()(&((
ty³
 *)0)->
s1
))

	)

1149 
	$g‘_li¡20
(
li¡_h—d
 *
li¡
,

1150 cÚ¡ **
»suÉ
[],

1151 
off£t
,

1152 
s1off£t
,

1153 
s2off£t
)

1155 **
»s
;

1156 
út
;

1157 
li¡_h—d
 *
pos
;

1158 *
±r
, *
¡r1
, *
¡r2
;

1160 
út
 = 
	`®loc_¡r_li¡
(
li¡
, 2, &
»s
);

1161 ià(
út
 <= 0) {

1162 *
»suÉ
 = 
NULL
;

1163  
út
;

1165 *
»suÉ
 = (cÚ¡ **)
»s
;

1166 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

1167 
±r
 = 
	`li¡_’Œy_off£t
(
pos
, , 
off£t
);

1168 
¡r1
 = *((**)(
±r
 + 
s1off£t
));

1169 ià(
¡r1
 !ğ
NULL
) {

1170 *
»s
 = 
	`¡rdup
(
¡r1
);

1171 ià(*
»s
 =ğ
NULL
)

1172 
__ç
;

1174 *
»s
 = 
NULL
;

1176 
»s
++;

1177 
¡r2
 = *((**)(
±r
 + 
s2off£t
));

1178 ià(
¡r2
 !ğ
NULL
) {

1179 *
»s
 = 
	`¡rdup
(
¡r2
);

1180 ià(*
»s
 =ğ
NULL
)

1181 
__ç
;

1183 *
»s
 = 
NULL
;

1185 
»s
++;

1187  
út
;

1188 
__ç
:

1189 
	`¢d_u£_ÿ£_ä“_li¡
(*
»suÉ
, 
út
);

1190  -
ENOMEM
;

1191 
	}
}

1193 
	#g‘_li¡2
(
li¡
, 
»suÉ
, 
ty³
, 
memb”
, 
s1
, 
s2
) \

1194 
	`g‘_li¡20
(
li¡
, 
»suÉ
, \

1195 ()(&((
ty³
 *)0)->
memb”
), \

1196 ()(&((
ty³
 *)0)->
s1
), \

1197 ()(&((
ty³
 *)0)->
s2
))

	)

1205 
šlše
 
u£_ÿ£_v”b
 *
	$fšd_v”b
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1206 cÚ¡ *
v”b_Çme
)

1208  
	`fšd
(&
uc_mgr
->
v”b_li¡
,

1209 
u£_ÿ£_v”b
, 
li¡
, 
Çme
,

1210 
v”b_Çme
);

1211 
	}
}

1213 
	$is_devli¡_suµÜ‹d
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1214 
dev_li¡
 *dev_list)

1216 
dev_li¡_node
 *
deviû
;

1217 
u£_ÿ£_deviû
 *
adev
;

1218 
li¡_h—d
 *
pos
, *
pos1
;

1219 
found_»t
;

1221 
dev_li¡
->
ty³
) {

1222 
DEVLIST_NONE
:

1225 
DEVLIST_SUPPORTED
:

1226 
found_»t
 = 1;

1228 
DEVLIST_CONFLICTING
:

1229 
found_»t
 = 0;

1233 
	`li¡_fÜ_—ch
(
pos
, &
dev_li¡
->
li¡
) {

1234 
deviû
 = 
	`li¡_’Œy
(
pos
, 
dev_li¡_node
, 
li¡
);

1236 
	`li¡_fÜ_—ch
(
pos1
, &
uc_mgr
->
aùive_deviûs
) {

1237 
adev
 = 
	`li¡_’Œy
(
pos1
, 
u£_ÿ£_deviû
,

1238 
aùive_li¡
);

1239 ià(!
	`¡rcmp
(
deviû
->
Çme
, 
adev
->name))

1240  
found_»t
;

1243  1 - 
found_»t
;

1244 
	}
}

1246 
šlše
 
	$is_modif›r_suµÜ‹d
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1247 
u£_ÿ£_modif›r
 *
modif›r
)

1249  
	`is_devli¡_suµÜ‹d
(
uc_mgr
, &
modif›r
->
dev_li¡
);

1250 
	}
}

1252 
šlše
 
	$is_deviû_suµÜ‹d
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1253 
u£_ÿ£_deviû
 *
deviû
)

1255  
	`is_devli¡_suµÜ‹d
(
uc_mgr
, &
deviû
->
dev_li¡
);

1256 
	}
}

1264 
šlše
 
u£_ÿ£_deviû
 *

1265 
	$fšd_deviû
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
u£_ÿ£_v”b
 *
v”b
,

1266 cÚ¡ *
deviû_Çme
, 
check_suµÜ‹d
)

1268 
u£_ÿ£_deviû
 *
deviû
;

1269 
li¡_h—d
 *
pos
;

1271 
	`li¡_fÜ_—ch
(
pos
, &
v”b
->
deviû_li¡
) {

1272 
deviû
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_deviû
, 
li¡
);

1274 ià(
	`¡rcmp
(
deviû_Çme
, 
deviû
->
Çme
))

1277 ià(
check_suµÜ‹d
 &&

1278 !
	`is_deviû_suµÜ‹d
(
uc_mgr
, 
deviû
))

1281  
deviû
;

1283  
NULL
;

1284 
	}
}

1292 
u£_ÿ£_modif›r
 *

1293 
	$fšd_modif›r
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
u£_ÿ£_v”b
 *
v”b
,

1294 cÚ¡ *
modif›r_Çme
, 
check_suµÜ‹d
)

1296 
u£_ÿ£_modif›r
 *
modif›r
;

1297 
li¡_h—d
 *
pos
;

1299 
	`li¡_fÜ_—ch
(
pos
, &
v”b
->
modif›r_li¡
) {

1300 
modif›r
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_modif›r
, 
li¡
);

1302 ià(
	`¡rcmp
(
modif›r
->
Çme
, 
modif›r_Çme
))

1305 ià(
check_suµÜ‹d
 &&

1306 !
	`is_modif›r_suµÜ‹d
(
uc_mgr
, 
modif›r
))

1309  
modif›r
;

1311  
NULL
;

1312 
	}
}

1314 
	$deviû_¡©us
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1315 cÚ¡ *
deviû_Çme
)

1317 
u£_ÿ£_deviû
 *
dev
;

1318 
li¡_h—d
 *
pos
;

1320 
	`li¡_fÜ_—ch
(
pos
, &
uc_mgr
->
aùive_deviûs
) {

1321 
dev
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_deviû
, 
aùive_li¡
);

1322 ià(
	`¡rcmp
(
dev
->
Çme
, 
deviû_Çme
) == 0)

1326 
	}
}

1328 
	$modif›r_¡©us
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1329 cÚ¡ *
modif›r_Çme
)

1331 
u£_ÿ£_modif›r
 *
mod
;

1332 
li¡_h—d
 *
pos
;

1334 
	`li¡_fÜ_—ch
(
pos
, &
uc_mgr
->
aùive_modif›rs
) {

1335 
mod
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_modif›r
, 
aùive_li¡
);

1336 ià(
	`¡rcmp
(
mod
->
Çme
, 
modif›r_Çme
) == 0)

1340 
	}
}

1349 
	$£t_v”b
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1350 
u£_ÿ£_v”b
 *
v”b
,

1351 
’abË
)

1353 
li¡_h—d
 *
£q
;

1354 
”r
;

1356 ià(
’abË
) {

1357 
”r
 = 
	`£t_deçuÉs
(
uc_mgr
, 
çl£
);

1358 ià(
”r
 < 0)

1359  
”r
;

1360 
£q
 = &
v”b
->
’abË_li¡
;

1362 
£q
 = &
v”b
->
di§bË_li¡
;

1364 
”r
 = 
	`execu‹_£qu’û
(
uc_mgr
, 
v”b
, 
£q
,

1365 &
v”b
->
v®ue_li¡
,

1366 &
uc_mgr
->
v®ue_li¡
,

1367 
NULL
);

1368 ià(
’abË
 && 
”r
 >= 0)

1369 
uc_mgr
->
aùive_v”b
 = 
v”b
;

1370  
”r
;

1371 
	}
}

1380 
	$£t_modif›r
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1381 
u£_ÿ£_modif›r
 *
modif›r
,

1382 
’abË
)

1384 
li¡_h—d
 *
£q
;

1385 
”r
;

1387 ià(
	`modif›r_¡©us
(
uc_mgr
, 
modif›r
->
Çme
è=ğ
’abË
)

1390 ià(
’abË
) {

1391 
£q
 = &
modif›r
->
’abË_li¡
;

1393 
£q
 = &
modif›r
->
di§bË_li¡
;

1395 
”r
 = 
	`execu‹_£qu’û
(
uc_mgr
, uc_mgr->
aùive_v”b
, 
£q
,

1396 &
modif›r
->
v®ue_li¡
,

1397 &
uc_mgr
->
aùive_v”b
->
v®ue_li¡
,

1398 &
uc_mgr
->
v®ue_li¡
);

1399 ià(
’abË
 && 
”r
 >= 0) {

1400 
	`li¡_add_
(&
modif›r
->
aùive_li¡
, &
uc_mgr
->
aùive_modif›rs
);

1401 } ià(!
’abË
) {

1402 
	`li¡_d–
(&
modif›r
->
aùive_li¡
);

1404  
”r
;

1405 
	}
}

1414 
	$£t_deviû
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1415 
u£_ÿ£_deviû
 *
deviû
,

1416 
’abË
)

1418 
li¡_h—d
 *
£q
;

1419 
”r
;

1421 ià(
	`deviû_¡©us
(
uc_mgr
, 
deviû
->
Çme
è=ğ
’abË
)

1424 ià(
’abË
) {

1425 
£q
 = &
deviû
->
’abË_li¡
;

1427 
£q
 = &
deviû
->
di§bË_li¡
;

1429 
”r
 = 
	`execu‹_£qu’û
(
uc_mgr
, uc_mgr->
aùive_v”b
, 
£q
,

1430 &
deviû
->
v®ue_li¡
,

1431 &
uc_mgr
->
aùive_v”b
->
v®ue_li¡
,

1432 &
uc_mgr
->
v®ue_li¡
);

1433 ià(
’abË
 && 
”r
 >= 0) {

1434 
	`li¡_add_
(&
deviû
->
aùive_li¡
, &
uc_mgr
->
aùive_deviûs
);

1435 } ià(!
’abË
) {

1436 
	`li¡_d–
(&
deviû
->
aùive_li¡
);

1438  
”r
;

1439 
	}
}

1446 
	$do_»£t
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

1448 
”r
;

1450 
”r
 = 
	`£t_deçuÉs
(
uc_mgr
, 
Œue
);

1451 
	`INIT_LIST_HEAD
(&
uc_mgr
->
aùive_modif›rs
);

1452 
	`INIT_LIST_HEAD
(&
uc_mgr
->
aùive_deviûs
);

1453 
uc_mgr
->
aùive_v”b
 = 
NULL
;

1454  
”r
;

1455 
	}
}

1463 cÚ¡ *
	$·r£_İ’_v¬ŸbËs
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
Çme
)

1465 cÚ¡ *
’d
, *
id
;

1466 *
¬gs
, *
v¬
;

1467 
¢d_cÚfig_t
 *
cfg
, *
n
;

1468 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1469 
vÇme
[128];

1470 
size_t
 
l
;

1471 
”r
;

1473 
’d
 = 
	`¡r¡r
(
Çme
, ">>>");

1474 ià(
’d
 =ğ
NULL
)

1475  
Çme
;

1476 
l
 = 
’d
 - 
Çme
 - 3;

1477 
¬gs
 = 
	`®loÿ
(
l
 + 1);

1478 
	`¡ºıy
(
¬gs
, 
Çme
 + 3, 
l
);

1479 
¬gs
[
l
] = '\0';

1481 
”r
 = 
	`¢d_cÚfig_lßd_¡ršg
(&
cfg
, 
¬gs
, 0);

1482 ià(
”r
 < 0) {

1483 
	`uc_”rÜ
("”rÜ: o³À¬gum’t ¬nÙ v®id (%s)", 
¬gs
);

1484 
sk
;

1488 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1489 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1490 
”r
 = 
	`¢d_cÚfig_g‘_id
(
n
, &
id
);

1491 ià(
”r
 < 0)

1492 
sk
;

1493 
”r
 = 
	`¢d_cÚfig_g‘_ascii
(
n
, &
v¬
);

1494 ià(
”r
 < 0)

1495 
sk
;

1496 
	`¢´štf
(
vÇme
, (vÇme), "@%s", 
id
);

1497 
”r
 = 
	`uc_mgr_£t_v¬ŸbË
(
uc_mgr
, 
vÇme
, 
v¬
);

1498 
	`ä“
(
v¬
);

1499 ià(
”r
 < 0)

1500 
sk
;

1503 
sk
:

1504 
	`¢d_cÚfig_d–‘e
(
cfg
);

1505  
’d
 + 3;

1506 
	}
}

1508 
	$¢d_u£_ÿ£_mgr_İ’
(
¢d_u£_ÿ£_mgr_t
 **
uc_mgr
,

1509 cÚ¡ *
ÿrd_Çme
)

1511 
¢d_u£_ÿ£_mgr_t
 *
mgr
;

1512 
”r
;

1515 
mgr
 = 
	`ÿÎoc
(1, (
¢d_u£_ÿ£_mgr_t
));

1516 ià(
mgr
 =ğ
NULL
)

1517  -
ENOMEM
;

1518 
	`INIT_LIST_HEAD
(&
mgr
->
v”b_li¡
);

1519 
	`INIT_LIST_HEAD
(&
mgr
->
fixedboÙ_li¡
);

1520 
	`INIT_LIST_HEAD
(&
mgr
->
boÙ_li¡
);

1521 
	`INIT_LIST_HEAD
(&
mgr
->
deçuÉ_li¡
);

1522 
	`INIT_LIST_HEAD
(&
mgr
->
v®ue_li¡
);

1523 
	`INIT_LIST_HEAD
(&
mgr
->
aùive_modif›rs
);

1524 
	`INIT_LIST_HEAD
(&
mgr
->
aùive_deviûs
);

1525 
	`INIT_LIST_HEAD
(&
mgr
->
ùl_li¡
);

1526 
	`INIT_LIST_HEAD
(&
mgr
->
v¬ŸbË_li¡
);

1527 
	`±h»ad_mu‹x_š™
(&
mgr
->
mu‹x
, 
NULL
);

1529 ià(
ÿrd_Çme
 && *card_name == '-') {

1530 
ÿrd_Çme
++;

1531 
mgr
->
suµ»ss_nodev_”rÜs
 = 1;

1534 ià(
ÿrd_Çme
 && card_name[0] == '<' && card_name[1] == '<' && card_name[2] == '<')

1535 
ÿrd_Çme
 = 
	`·r£_İ’_v¬ŸbËs
(
mgr
, card_name);

1537 
”r
 = 
	`uc_mgr_ÿrd_İ’
(
mgr
);

1538 ià(
”r
 < 0) {

1539 
	`uc_mgr_ä“
(
mgr
);

1540  
”r
;

1543 
mgr
->
ÿrd_Çme
 = 
	`¡rdup
(card_name);

1544 ià(
mgr
->
ÿrd_Çme
 =ğ
NULL
) {

1545 
”r
 = -
ENOMEM
;

1546 
_”r
;

1550 
”r
 = 
	`impÜt_ma¡”_cÚfig
(
mgr
);

1551 ià(
”r
 < 0) {

1552 ià(
”r
 =ğ-
ENXIO
 && 
mgr
->
suµ»ss_nodev_”rÜs
)

1553 
_”r
;

1554 
	`uc_”rÜ
("error: failedo import %s use case configuration %d",

1555 
ÿrd_Çme
, 
”r
);

1556 
_”r
;

1559 
”r
 = 
	`check_em±y_cÚfigu¿tiÚ
(
mgr
);

1560 ià(
”r
 < 0) {

1561 
	`uc_”rÜ
("”rÜ: faedØimpÜˆ% Óm±y cÚfigu¿tiÚ)", 
ÿrd_Çme
);

1562 
_”r
;

1565 *
uc_mgr
 = 
mgr
;

1568 
_”r
:

1569 
	`uc_mgr_ÿrd_şo£
(
mgr
);

1570 
	`uc_mgr_ä“
(
mgr
);

1571  
”r
;

1572 
	}
}

1574 
	$¢d_u£_ÿ£_mgr_»lßd
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

1576 
”r
;

1578 
	`±h»ad_mu‹x_lock
(&
uc_mgr
->
mu‹x
);

1580 
	`do_»£t
(
uc_mgr
);

1582 
	`uc_mgr_ä“_v”b
(
uc_mgr
);

1584 
uc_mgr
->
deçuÉ_li¡_execu‹d
 = 0;

1587 
”r
 = 
	`impÜt_ma¡”_cÚfig
(
uc_mgr
);

1588 ià(
”r
 < 0) {

1589 
	`uc_”rÜ
("error: failedo„eload use cases");

1590 
	`±h»ad_mu‹x_uÆock
(&
uc_mgr
->
mu‹x
);

1591  -
EINVAL
;

1594 
	`±h»ad_mu‹x_uÆock
(&
uc_mgr
->
mu‹x
);

1595  
”r
;

1596 
	}
}

1598 
	$¢d_u£_ÿ£_mgr_şo£
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

1600 
	`uc_mgr_ÿrd_şo£
(
uc_mgr
);

1601 
	`uc_mgr_ä“
(
uc_mgr
);

1604 
	}
}

1609 
	$dismªe_u£_ÿ£
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

1611 
li¡_h—d
 *
pos
, *
Åos
;

1612 
u£_ÿ£_modif›r
 *
modif›r
;

1613 
u£_ÿ£_deviû
 *
deviû
;

1614 
”r
;

1616 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, &
uc_mgr
->
aùive_modif›rs
) {

1617 
modif›r
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_modif›r
,

1618 
aùive_li¡
);

1619 
”r
 = 
	`£t_modif›r
(
uc_mgr
, 
modif›r
, 0);

1620 ià(
”r
 < 0)

1621 
	`uc_”rÜ
("UÇbËØdi§bË modif›¸%s", 
modif›r
->
Çme
);

1623 
	`INIT_LIST_HEAD
(&
uc_mgr
->
aùive_modif›rs
);

1625 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, &
uc_mgr
->
aùive_deviûs
) {

1626 
deviû
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_deviû
,

1627 
aùive_li¡
);

1628 
”r
 = 
	`£t_deviû
(
uc_mgr
, 
deviû
, 0);

1629 ià(
”r
 < 0)

1630 
	`uc_”rÜ
("UÇbËØdi§bË deviû %s", 
deviû
->
Çme
);

1632 
	`INIT_LIST_HEAD
(&
uc_mgr
->
aùive_deviûs
);

1634 
”r
 = 
	`£t_v”b
(
uc_mgr
, uc_mgr->
aùive_v”b
, 0);

1635 ià(
”r
 < 0) {

1636 
	`uc_”rÜ
("UÇbËØdi§bË v”b %s", 
uc_mgr
->
aùive_v”b
->
Çme
);

1637  
”r
;

1639 
uc_mgr
->
aùive_v”b
 = 
NULL
;

1641 
”r
 = 
	`£t_deçuÉs
(
uc_mgr
, 
Œue
);

1643  
”r
;

1644 
	}
}

1646 
	$¢d_u£_ÿ£_mgr_»£t
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

1648 
”r
;

1650 
	`±h»ad_mu‹x_lock
(&
uc_mgr
->
mu‹x
);

1651 
”r
 = 
	`do_»£t
(
uc_mgr
);

1652 
	`±h»ad_mu‹x_uÆock
(&
uc_mgr
->
mu‹x
);

1653  
”r
;

1654 
	}
}

1661 
	$g‘_v”b_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ **
li¡
[])

1663  
	`g‘_li¡2
(&
uc_mgr
->
v”b_li¡
, 
li¡
,

1664 
u£_ÿ£_v”b
, 
li¡
,

1665 
Çme
, 
comm’t
);

1666 
	}
}

1674 
	$g‘_deviû_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ **
li¡
[],

1675 *
v”bÇme
)

1677 
u£_ÿ£_v”b
 *
v”b
;

1679 ià(
v”bÇme
) {

1680 
v”b
 = 
	`fšd_v”b
(
uc_mgr
, 
v”bÇme
);

1682 
v”b
 = 
uc_mgr
->
aùive_v”b
;

1684 ià(
v”b
 =ğ
NULL
)

1685  -
ENOENT
;

1686  
	`g‘_li¡2
(&
v”b
->
deviû_li¡
, 
li¡
,

1687 
u£_ÿ£_deviû
, 
li¡
,

1688 
Çme
, 
comm’t
);

1689 
	}
}

1697 
	$g‘_modif›r_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ **
li¡
[],

1698 *
v”bÇme
)

1700 
u£_ÿ£_v”b
 *
v”b
;

1701 ià(
v”bÇme
) {

1702 
v”b
 = 
	`fšd_v”b
(
uc_mgr
, 
v”bÇme
);

1704 
v”b
 = 
uc_mgr
->
aùive_v”b
;

1706 ià(
v”b
 =ğ
NULL
)

1707  -
ENOENT
;

1708  
	`g‘_li¡2
(&
v”b
->
modif›r_li¡
, 
li¡
,

1709 
u£_ÿ£_modif›r
, 
li¡
,

1710 
Çme
, 
comm’t
);

1711 
	}
}

1720 
	$g‘_supcÚ_deviû_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1721 cÚ¡ **
li¡
[], *
Çme
,

1722 
dev_li¡_ty³
 
ty³
)

1724 *
¡r
;

1725 
u£_ÿ£_v”b
 *
v”b
;

1726 
u£_ÿ£_modif›r
 *
modif›r
;

1727 
u£_ÿ£_deviû
 *
deviû
;

1729 ià(!
Çme
)

1730  -
ENOENT
;

1732 
¡r
 = 
	`¡rchr
(
Çme
, '/');

1733 ià(
¡r
) {

1734 *
¡r
 = '\0';

1735 
v”b
 = 
	`fšd_v”b
(
uc_mgr
, 
¡r
 + 1);

1738 
v”b
 = 
uc_mgr
->
aùive_v”b
;

1740 ià(!
v”b
)

1741  -
ENOENT
;

1743 
modif›r
 = 
	`fšd_modif›r
(
uc_mgr
, 
v”b
, 
Çme
, 0);

1744 ià(
modif›r
) {

1745 ià(
modif›r
->
dev_li¡
.
ty³
 !=ype) {

1746 *
li¡
 = 
NULL
;

1749  
	`g‘_li¡
(&
modif›r
->
dev_li¡
.
li¡
,†ist,

1750 
dev_li¡_node
, 
li¡
,

1751 
Çme
);

1754 
deviû
 = 
	`fšd_deviû
(
uc_mgr
, 
v”b
, 
Çme
, 0);

1755 ià(
deviû
) {

1756 ià(
deviû
->
dev_li¡
.
ty³
 !=ype) {

1757 *
li¡
 = 
NULL
;

1760  
	`g‘_li¡
(&
deviû
->
dev_li¡
.
li¡
,†ist,

1761 
dev_li¡_node
, 
li¡
,

1762 
Çme
);

1765  -
ENOENT
;

1766 
	}
}

1774 
	$g‘_suµÜ‹d_deviû_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1775 cÚ¡ **
li¡
[], *
Çme
)

1777  
	`g‘_supcÚ_deviû_li¡
(
uc_mgr
, 
li¡
, 
Çme
, 
DEVLIST_SUPPORTED
);

1778 
	}
}

1786 
	$g‘_cÚæiùšg_deviû_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1787 cÚ¡ **
li¡
[], *
Çme
)

1789  
	`g‘_supcÚ_deviû_li¡
(
uc_mgr
, 
li¡
, 
Çme
, 
DEVLIST_CONFLICTING
);

1790 
	}
}

1792 #iâdeà
DOC_HIDDEN


1793 
	smyv®ue
 {

1794 
li¡_h—d
 
	mli¡
;

1795 cÚ¡ *
	m‹xt
;

1805 
	$myv®ue_to_¡r_li¡
(
li¡_h—d
 *
li¡
, ***
»s
)

1807 
li¡_h—d
 *
pos
;

1808 
myv®ue
 *
v®ue
;

1809 **
p
;

1810 
út
;

1812 
út
 = 
	`®loc_¡r_li¡
(
li¡
, 1, 
»s
);

1813 ià(
út
 < 0)

1814  
út
;

1815 
p
 = *
»s
;

1816 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

1817 
v®ue
 = 
	`li¡_’Œy
(
pos
, 
myv®ue
, 
li¡
);

1818 *
p
 = 
	`¡rdup
(
v®ue
->
‹xt
);

1819 ià(*
p
 =ğ
NULL
) {

1820 
	`¢d_u£_ÿ£_ä“_li¡
((cÚ¡ **)
p
, 
út
);

1821  -
ENOMEM
;

1823 
p
++;

1825  
út
;

1826 
	}
}

1832 
	$myv®ue_li¡_ä“
(
li¡_h—d
 *
li¡
)

1834 
li¡_h—d
 *
pos
, *
Åos
;

1835 
myv®ue
 *
v®ue
;

1837 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, 
li¡
) {

1838 
v®ue
 = 
	`li¡_’Œy
(
pos
, 
myv®ue
, 
li¡
);

1839 
	`li¡_d–
(&
v®ue
->
li¡
);

1840 
	`ä“
(
v®ue
);

1842 
	}
}

1850 
	$m”ge_v®ue
(
li¡_h—d
 *
li¡
, cÚ¡ *
‹xt
)

1852 
li¡_h—d
 *
pos
;

1853 
myv®ue
 *
v®ue
;

1855 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

1856 
v®ue
 = 
	`li¡_’Œy
(
pos
, 
myv®ue
, 
li¡
);

1857 ià(
	`¡rcmp
(
v®ue
->
‹xt
,ext) == 0)

1860 
v®ue
 = 
	`m®loc
((*value));

1861 ià(
v®ue
 =ğ
NULL
)

1862  -
ENOMEM
;

1863 
v®ue
->
‹xt
 =ext;

1864 
	`li¡_add_
(&
v®ue
->
li¡
,†ist);

1866 
	}
}

1874 
	$add_id’tif›rs
(
li¡_h—d
 *
li¡
,

1875 
li¡_h—d
 *
sourû
)

1877 
ucm_v®ue
 *
v
;

1878 
li¡_h—d
 *
pos
;

1879 
”r
;

1881 
	`li¡_fÜ_—ch
(
pos
, 
sourû
) {

1882 
v
 = 
	`li¡_’Œy
(
pos
, 
ucm_v®ue
, 
li¡
);

1883 
”r
 = 
	`m”ge_v®ue
(
li¡
, 
v
->
Çme
);

1884 ià(
”r
 < 0)

1885  
”r
;

1888 
	}
}

1896 
	$add_v®ues
(
li¡_h—d
 *
li¡
,

1897 cÚ¡ *
id’tif›r
,

1898 
li¡_h—d
 *
sourû
)

1900 
ucm_v®ue
 *
v
;

1901 
li¡_h—d
 *
pos
;

1902 
”r
;

1904 
	`li¡_fÜ_—ch
(
pos
, 
sourû
) {

1905 
v
 = 
	`li¡_’Œy
(
pos
, 
ucm_v®ue
, 
li¡
);

1906 ià(
	`check_id’tif›r
(
id’tif›r
, 
v
->
Çme
)) {

1907 
”r
 = 
	`m”ge_v®ue
(
li¡
, 
v
->
d©a
);

1908 ià(
”r
 < 0)

1909  
”r
;

1913 
	}
}

1918 
	$id’tif›r_cmp
(cÚ¡ *
_a
, cÚ¡ *
_b
)

1920 cÚ¡ * cÚ¡ *
a
 = 
_a
;

1921 cÚ¡ * cÚ¡ *
b
 = 
_b
;

1922  
	`¡rcmp
(*
a
, *
b
);

1923 
	}
}

1931 
	$g‘_id’tif›rs_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1932 cÚ¡ **
li¡
[], *
Çme
)

1934 
u£_ÿ£_v”b
 *
v”b
;

1935 
u£_ÿ£_modif›r
 *
modif›r
;

1936 
u£_ÿ£_deviû
 *
deviû
;

1937 
li¡_h—d
 
myli¡
;

1938 
li¡_h—d
 *
v®ue_li¡
;

1939 *
¡r
, **
»s
;

1940 
”r
;

1942 ià(!
Çme
)

1943  -
ENOENT
;

1945 
¡r
 = 
	`¡rchr
(
Çme
, '/');

1946 ià(
¡r
) {

1947 *
¡r
 = '\0';

1948 
v”b
 = 
	`fšd_v”b
(
uc_mgr
, 
¡r
 + 1);

1951 
v”b
 = 
uc_mgr
->
aùive_v”b
;

1953 ià(!
v”b
)

1954  -
ENOENT
;

1956 
v®ue_li¡
 = 
NULL
;

1957 
modif›r
 = 
	`fšd_modif›r
(
uc_mgr
, 
v”b
, 
Çme
, 0);

1958 ià(
modif›r
) {

1959 
v®ue_li¡
 = &
modif›r
->value_list;

1961 
deviû
 = 
	`fšd_deviû
(
uc_mgr
, 
v”b
, 
Çme
, 0);

1962 ià(
deviû
)

1963 
v®ue_li¡
 = &
deviû
->value_list;

1965 ià(
v®ue_li¡
 =ğ
NULL
)

1966  -
ENOENT
;

1968 
	`INIT_LIST_HEAD
(&
myli¡
);

1969 
”r
 = 
	`add_id’tif›rs
(&
myli¡
, &
uc_mgr
->
v®ue_li¡
);

1970 ià(
”r
 < 0)

1971 
__ç
;

1972 
”r
 = 
	`add_id’tif›rs
(&
myli¡
, &
v”b
->
v®ue_li¡
);

1973 ià(
”r
 < 0)

1974 
__ç
;

1975 
”r
 = 
	`add_id’tif›rs
(&
myli¡
, 
v®ue_li¡
);

1976 ià(
”r
 < 0)

1977 
__ç
;

1978 
”r
 = 
	`myv®ue_to_¡r_li¡
(&
myli¡
, &
»s
);

1979 ià(
”r
 > 0)

1980 *
li¡
 = (cÚ¡ **)
»s
;

1981 ià(
”r
 == 0)

1982 *
li¡
 = 
NULL
;

1983 
__ç
:

1984 
	`myv®ue_li¡_ä“
(&
myli¡
);

1985 ià(
”r
 <= 0)

1986  
”r
;

1987 
	`qsÜt
(*
li¡
, 
”r
, (*), 
id’tif›r_cmp
);

1988  
”r
;

1989 
	}
}

1997 
	$g‘_v®ue_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1998 cÚ¡ *
id’tif›r
,

1999 cÚ¡ **
li¡
[],

2000 *
v”bÇme
)

2002 
li¡_h—d
 
myli¡
, *
pos
;

2003 
u£_ÿ£_v”b
 *
v”b
;

2004 
u£_ÿ£_deviû
 *
dev
;

2005 
u£_ÿ£_modif›r
 *
mod
;

2006 **
»s
;

2007 
”r
;

2009 ià(
v”bÇme
) {

2010 
v”b
 = 
	`fšd_v”b
(
uc_mgr
, 
v”bÇme
);

2012 
v”b
 = 
uc_mgr
->
aùive_v”b
;

2014 ià(
v”b
 =ğ
NULL
)

2015  -
ENOENT
;

2016 
	`INIT_LIST_HEAD
(&
myli¡
);

2017 
”r
 = 
	`add_v®ues
(&
myli¡
, 
id’tif›r
, &
uc_mgr
->
v®ue_li¡
);

2018 ià(
”r
 < 0)

2019 
__ç
;

2020 
”r
 = 
	`add_v®ues
(&
myli¡
, 
id’tif›r
, &
v”b
->
v®ue_li¡
);

2021 ià(
”r
 < 0)

2022 
__ç
;

2023 
	`li¡_fÜ_—ch
(
pos
, &
v”b
->
deviû_li¡
) {

2024 
dev
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_deviû
, 
li¡
);

2025 
”r
 = 
	`add_v®ues
(&
myli¡
, 
id’tif›r
, &
dev
->
v®ue_li¡
);

2026 ià(
”r
 < 0)

2027 
__ç
;

2029 
	`li¡_fÜ_—ch
(
pos
, &
v”b
->
modif›r_li¡
) {

2030 
mod
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_modif›r
, 
li¡
);

2031 
”r
 = 
	`add_v®ues
(&
myli¡
, 
id’tif›r
, &
mod
->
v®ue_li¡
);

2032 ià(
”r
 < 0)

2033 
__ç
;

2035 
”r
 = 
	`myv®ue_to_¡r_li¡
(&
myli¡
, &
»s
);

2036 ià(
”r
 > 0)

2037 *
li¡
 = (cÚ¡ **)
»s
;

2038 ià(
”r
 == 0)

2039 *
li¡
 = 
NULL
;

2040 
__ç
:

2041 
	`myv®ue_li¡_ä“
(&
myli¡
);

2042  
”r
;

2043 
	}
}

2051 
	$g‘_’abËd_deviû_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2052 cÚ¡ **
li¡
[])

2054 ià(
uc_mgr
->
aùive_v”b
 =ğ
NULL
)

2055  -
EINVAL
;

2056  
	`g‘_li¡
(&
uc_mgr
->
aùive_deviûs
, 
li¡
,

2057 
u£_ÿ£_deviû
, 
aùive_li¡
,

2058 
Çme
);

2059 
	}
}

2067 
	$g‘_’abËd_modif›r_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2068 cÚ¡ **
li¡
[])

2070 ià(
uc_mgr
->
aùive_v”b
 =ğ
NULL
)

2071  -
EINVAL
;

2072  
	`g‘_li¡
(&
uc_mgr
->
aùive_modif›rs
, 
li¡
,

2073 
u£_ÿ£_modif›r
, 
aùive_li¡
,

2074 
Çme
);

2075 
	}
}

2077 
	$¢d_u£_ÿ£_g‘_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2078 cÚ¡ *
id’tif›r
,

2079 cÚ¡ **
li¡
[])

2081 *
¡r
, *
¡r1
;

2082 
”r
;

2084 ià(
uc_mgr
 =ğ
NULL
 || 
id’tif›r
 == NULL)

2085  
	`uc_mgr_sÿn_ma¡”_cÚfigs
(
li¡
);

2086 
	`±h»ad_mu‹x_lock
(&
uc_mgr
->
mu‹x
);

2087 ià(
	`¡rcmp
(
id’tif›r
, "_verbs") == 0)

2088 
”r
 = 
	`g‘_v”b_li¡
(
uc_mgr
, 
li¡
);

2089 ià(
	`¡rcmp
(
id’tif›r
, "_enadevs") == 0)

2090 
”r
 = 
	`g‘_’abËd_deviû_li¡
(
uc_mgr
, 
li¡
);

2091 ià(
	`¡rcmp
(
id’tif›r
, "_enamods") == 0)

2092 
”r
 = 
	`g‘_’abËd_modif›r_li¡
(
uc_mgr
, 
li¡
);

2094 
¡r1
 = 
	`¡rchr
(
id’tif›r
, '/');

2095 ià(
¡r1
) {

2096 
¡r
 = 
	`¡rdup
(
¡r1
 + 1);

2097 ià(
¡r
 =ğ
NULL
) {

2098 
”r
 = -
ENOMEM
;

2099 
__’d
;

2102 
¡r
 = 
NULL
;

2104 ià(
	`check_id’tif›r
(
id’tif›r
, "_devices"))

2105 
”r
 = 
	`g‘_deviû_li¡
(
uc_mgr
, 
li¡
, 
¡r
);

2106 ià(
	`check_id’tif›r
(
id’tif›r
, "_modifiers"))

2107 
”r
 = 
	`g‘_modif›r_li¡
(
uc_mgr
, 
li¡
, 
¡r
);

2108 ià(
	`check_id’tif›r
(
id’tif›r
, "_identifiers"))

2109 
”r
 = 
	`g‘_id’tif›rs_li¡
(
uc_mgr
, 
li¡
, 
¡r
);

2110 ià(
	`check_id’tif›r
(
id’tif›r
, "_supporteddevs"))

2111 
”r
 = 
	`g‘_suµÜ‹d_deviû_li¡
(
uc_mgr
, 
li¡
, 
¡r
);

2112 ià(
	`check_id’tif›r
(
id’tif›r
, "_conflictingdevs"))

2113 
”r
 = 
	`g‘_cÚæiùšg_deviû_li¡
(
uc_mgr
, 
li¡
, 
¡r
);

2114 ià(
id’tif›r
[0] == '_')

2115 
”r
 = -
ENOENT
;

2117 
”r
 = 
	`g‘_v®ue_li¡
(
uc_mgr
, 
id’tif›r
, 
li¡
, 
¡r
);

2118 ià(
¡r
)

2119 
	`ä“
(
¡r
);

2121 
__’d
:

2122 
	`±h»ad_mu‹x_uÆock
(&
uc_mgr
->
mu‹x
);

2123  
”r
;

2124 
	}
}

2126 
	$g‘_v®ue1
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, **
v®ue
,

2127 
li¡_h—d
 *
v®ue_li¡
, cÚ¡ *
id’tif›r
)

2129 
ucm_v®ue
 *
v®
;

2130 
li¡_h—d
 *
pos
;

2131 
”r
;

2133 ià(!
v®ue_li¡
)

2134  -
ENOENT
;

2136 
	`li¡_fÜ_—ch
(
pos
, 
v®ue_li¡
) {

2137 
v®
 = 
	`li¡_’Œy
(
pos
, 
ucm_v®ue
, 
li¡
);

2138 ià(
	`check_id’tif›r
(
id’tif›r
, 
v®
->
Çme
)) {

2139 ià(
uc_mgr
->
cÚf_fÜm©
 < 2) {

2140 *
v®ue
 = 
	`¡rdup
(
v®
->
d©a
);

2141 ià(*
v®ue
 =ğ
NULL
)

2142  -
ENOMEM
;

2145 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, 
v®ue
, 
v®
->
d©a
);

2146 ià(
”r
 < 0)

2147  
”r
;

2148  
	`»wr™e_deviû_v®ue
(
uc_mgr
, 
v®
->
Çme
, 
v®ue
);

2151  -
ENOENT
;

2152 
	}
}

2154 
	$g‘_v®ue3
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2155 **
v®ue
,

2156 cÚ¡ *
id’tif›r
,

2157 
li¡_h—d
 *
v®ue_li¡1
,

2158 
li¡_h—d
 *
v®ue_li¡2
,

2159 
li¡_h—d
 *
v®ue_li¡3
)

2161 
”r
;

2163 
”r
 = 
	`g‘_v®ue1
(
uc_mgr
, 
v®ue
, 
v®ue_li¡1
, 
id’tif›r
);

2164 ià(
”r
 >ğ0 ||ƒ¼ !ğ-
ENOENT
)

2165  
”r
;

2166 
”r
 = 
	`g‘_v®ue1
(
uc_mgr
, 
v®ue
, 
v®ue_li¡2
, 
id’tif›r
);

2167 ià(
”r
 >ğ0 ||ƒ¼ !ğ-
ENOENT
)

2168  
”r
;

2169 
”r
 = 
	`g‘_v®ue1
(
uc_mgr
, 
v®ue
, 
v®ue_li¡3
, 
id’tif›r
);

2170 ià(
”r
 >ğ0 ||ƒ¼ !ğ-
ENOENT
)

2171  
”r
;

2172  -
ENOENT
;

2173 
	}
}

2183 
	$g‘_v®ue
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2184 cÚ¡ *
id’tif›r
,

2185 **
v®ue
,

2186 cÚ¡ *
mod_dev_Çme
,

2187 cÚ¡ *
v”b_Çme
,

2188 
exaù
)

2190 
u£_ÿ£_v”b
 *
v”b
;

2191 
u£_ÿ£_modif›r
 *
mod
;

2192 
u£_ÿ£_deviû
 *
dev
;

2193 
”r
;

2195 ià(
mod_dev_Çme
 || 
v”b_Çme
 || !
exaù
) {

2196 ià(
v”b_Çme
 && 
	`¡¾’
(verb_name)) {

2197 
v”b
 = 
	`fšd_v”b
(
uc_mgr
, 
v”b_Çme
);

2199 
v”b
 = 
uc_mgr
->
aùive_v”b
;

2201 ià(
v”b
) {

2202 ià(
mod_dev_Çme
) {

2203 
mod
 = 
	`fšd_modif›r
(
uc_mgr
, 
v”b
,

2204 
mod_dev_Çme
, 0);

2205 ià(
mod
) {

2206 
”r
 = 
	`g‘_v®ue1
(
uc_mgr
, 
v®ue
,

2207 &
mod
->
v®ue_li¡
,

2208 
id’tif›r
);

2209 ià(
”r
 >ğ0 ||ƒ¼ !ğ-
ENOENT
)

2210  
”r
;

2213 
dev
 = 
	`fšd_deviû
(
uc_mgr
, 
v”b
,

2214 
mod_dev_Çme
, 0);

2215 ià(
dev
) {

2216 
”r
 = 
	`g‘_v®ue1
(
uc_mgr
, 
v®ue
,

2217 &
dev
->
v®ue_li¡
,

2218 
id’tif›r
);

2219 ià(
”r
 >ğ0 ||ƒ¼ !ğ-
ENOENT
)

2220  
”r
;

2223 ià(
exaù
)

2224  -
ENOENT
;

2227 
”r
 = 
	`g‘_v®ue1
(
uc_mgr
, 
v®ue
, &
v”b
->
v®ue_li¡
, 
id’tif›r
);

2228 ià(
”r
 >ğ0 ||ƒ¼ !ğ-
ENOENT
)

2229  
”r
;

2232 ià(
exaù
)

2233  -
ENOENT
;

2236 
”r
 = 
	`g‘_v®ue1
(
uc_mgr
, 
v®ue
, &uc_mgr->
v®ue_li¡
, 
id’tif›r
);

2237 ià(
”r
 >ğ0 ||ƒ¼ !ğ-
ENOENT
)

2238  
”r
;

2240  -
ENOENT
;

2241 
	}
}

2249 
	$g‘_®ibcfg
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, **
¡r
)

2251 
¢d_ouut_t
 *
out
;

2252 
size_t
 
size
;

2253 
”r
;

2255 
”r
 = 
	`¢d_ouut_bufãr_İ’
(&
out
);

2256 ià(
”r
 < 0)

2257  
”r
;

2258 
”r
 = 
	`¢d_cÚfig_§ve
(
uc_mgr
->
loÿl_cÚfig
, 
out
);

2259 ià(
”r
 >= 0) {

2260 
size
 = 
	`¢d_ouut_bufãr_¡—l
(
out
, 
¡r
);

2261 ià(*
¡r
)

2262 (*
¡r
)[
size
] = '\0';

2264 
	`¢d_ouut_şo£
(
out
);

2266 
	}
}

2274 
	$g‘_®ib´ef
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, **
¡r
)

2276 cÚ¡ 
size_t
 
l
 = 10;

2277 *
s
;

2279 
s
 = 
	`m®loc
(
l
);

2280 ià(
s
 =ğ
NULL
)

2281  -
ENOMEM
;

2282 
	`¢´štf
(
s
, 
l
, "_ucm%04X.", 
uc_mgr
->
ucm_ÿrd_numb”
);

2283 *
¡r
 = 
s
;

2285 
	}
}

2287 
	$¢d_u£_ÿ£_g‘
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2288 cÚ¡ *
id’tif›r
,

2289 cÚ¡ **
v®ue
)

2291 cÚ¡ *
¦ash1
, *
¦ash2
, *
mod_dev_aá”
;

2292 cÚ¡ *
id’t
, *
mod_dev
, *
v”b
;

2293 
exaù
 = 0;

2294 
”r
;

2296 
	`±h»ad_mu‹x_lock
(&
uc_mgr
->
mu‹x
);

2297 ià(
id’tif›r
 =ğ
NULL
) {

2298 *
v®ue
 = 
	`¡rdup
(
uc_mgr
->
ÿrd_Çme
);

2299 ià(*
v®ue
 =ğ
NULL
) {

2300 
”r
 = -
ENOMEM
;

2301 
__’d
;

2303 
”r
 = 0;

2304 } ià(
	`¡rcmp
(
id’tif›r
, "_verb") == 0) {

2305 ià(
uc_mgr
->
aùive_v”b
 =ğ
NULL
) {

2306 
”r
 = -
ENOENT
;

2307 
__’d
;

2309 *
v®ue
 = 
	`¡rdup
(
uc_mgr
->
aùive_v”b
->
Çme
);

2310 ià(*
v®ue
 =ğ
NULL
) {

2311 
”r
 = -
ENOMEM
;

2312 
__’d
;

2314 
”r
 = 0;

2315 } ià(
	`¡rcmp
(
id’tif›r
, "_file") == 0) {

2317 ià((
uc_mgr
->
ÿrd_Çme
 =ğ
NULL
) ||

2318 (
uc_mgr
->
cÚf_fe_Çme
 =ğ
NULL
) ||

2319 (
uc_mgr
->
cÚf_fe_Çme
[0] == '\0')) {

2320 
”r
 = -
ENOENT
;

2321 
__’d
;

2323 *
v®ue
 = 
	`¡rdup
(
uc_mgr
->
cÚf_fe_Çme
);

2324 ià(*
v®ue
 =ğ
NULL
) {

2325 
”r
 = -
ENOMEM
;

2326 
__’d
;

2328 
”r
 = 0;

2330 } ià(
	`¡rcmp
(
id’tif›r
, "_alibcfg") == 0) {

2331 
”r
 = 
	`g‘_®ibcfg
(
uc_mgr
, (**)
v®ue
);

2332 } ià(
	`¡rcmp
(
id’tif›r
, "_alibpref") == 0) {

2333 
”r
 = 
	`g‘_®ib´ef
(
uc_mgr
, (**)
v®ue
);

2334 } ià(
id’tif›r
[0] == '_') {

2335 
”r
 = -
ENOENT
;

2337 ià(
id’tif›r
[0] == '=') {

2338 
exaù
 = 1;

2339 
id’tif›r
++;

2342 
¦ash1
 = 
	`¡rchr
(
id’tif›r
, '/');

2343 ià(
¦ash1
) {

2344 
id’t
 = 
	`¡ºdup
(
id’tif›r
, 
¦ash1
 - identifier);

2346 
¦ash2
 = 
	`¡rchr
(
¦ash1
 + 1, '/');

2347 ià(
¦ash2
) {

2348 
mod_dev_aá”
 = 
¦ash2
;

2349 
v”b
 = 
¦ash2
 + 1;

2352 
mod_dev_aá”
 = 
¦ash1
 + 
	`¡¾’
(slash1);

2353 
v”b
 = 
NULL
;

2356 ià(
mod_dev_aá”
 =ğ
¦ash1
 + 1)

2357 
mod_dev
 = 
NULL
;

2359 
mod_dev
 = 
	`¡ºdup
(
¦ash1
 + 1,

2360 
mod_dev_aá”
 - (
¦ash1
 + 1));

2363 
id’t
 = 
id’tif›r
;

2364 
mod_dev
 = 
NULL
;

2365 
v”b
 = 
NULL
;

2368 
”r
 = 
	`g‘_v®ue
(
uc_mgr
, 
id’t
, (**)
v®ue
, 
mod_dev
, 
v”b
,

2369 
exaù
);

2370 ià(
id’t
 !ğ
id’tif›r
)

2371 
	`ä“
((*)
id’t
);

2372 ià(
mod_dev
)

2373 
	`ä“
((*)
mod_dev
);

2375 
__’d
:

2376 
	`±h»ad_mu‹x_uÆock
(&
uc_mgr
->
mu‹x
);

2377  
”r
;

2378 
	}
}

2383 
	#g‘i
(
uc_mgr
, 
¡©us
, 
ifšd
, 
¡r
, 
v®ue
) ({ \

2384 
v®
 = -
EINVAL
; \

2385 ià(
¡r
) { \

2386 
v®
 = (
¡©us
)((
uc_mgr
), (
¡r
)); \

2387 ià(
v®
 >= 0) { \

2388 ià((
ifšd
)((
uc_mgr
), (uc_mgr)->
aùive_v”b
, (
¡r
), 0)) { \

2389 *(
v®ue
èğ
v®
; \

2390 
v®
 = 0; \

2392 
v®
 = -
ENOENT
; \

2396 ; 
v®
; \

2397 })

	)

2399 
	$¢d_u£_ÿ£_g‘i
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2400 cÚ¡ *
id’tif›r
,

2401 *
v®ue
)

2403 *
¡r
, *
¡r1
;

2404 
”r
;

2406 
	`±h»ad_mu‹x_lock
(&
uc_mgr
->
mu‹x
);

2410 
¡r1
 = 
	`¡rchr
(
id’tif›r
, '/');

2411 ià(
¡r1
) {

2412 
¡r
 = 
	`¡rdup
(
¡r1
 + 1);

2413 ià(
¡r
 =ğ
NULL
) {

2414 
”r
 = -
ENOMEM
;

2415 
__’d
;

2418 
¡r
 = 
NULL
;

2420 ià(
	`check_id’tif›r
(
id’tif›r
, "_devstatus")) {

2421 
”r
 = 
	`g‘i
(
uc_mgr
, 
deviû_¡©us
, 
fšd_deviû
, 
¡r
, 
v®ue
);

2422 } ià(
	`check_id’tif›r
(
id’tif›r
, "_modstatus")) {

2423 
”r
 = 
	`g‘i
(
uc_mgr
, 
modif›r_¡©us
, 
fšd_modif›r
, 
¡r
, 
v®ue
);

2429 } ià(
id’tif›r
[0] == '_') {

2430 
”r
 = -
ENOENT
;

2433 
”r
 = -
ENOENT
;

2434 ià(
¡r
)

2435 
	`ä“
(
¡r
);

2437 
__’d
:

2438 
	`±h»ad_mu‹x_uÆock
(&
uc_mgr
->
mu‹x
);

2439  
”r
;

2440 
	}
}

2442 
	$£t_fixedboÙ_u£r
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2443 cÚ¡ *
v®ue
)

2445 
”r
;

2447 ià(
v®ue
 !ğ
NULL
 && *value) {

2448 
	`uc_”rÜ
("”rÜ: wrÚg v®ufÜ _fboÙ (%s)", 
v®ue
);

2449  -
EINVAL
;

2451 ià(
	`li¡_em±y
(&
uc_mgr
->
fixedboÙ_li¡
))

2452  -
ENOENT
;

2453 
”r
 = 
	`execu‹_£qu’û
(
uc_mgr
, 
NULL
, &uc_mgr->
fixedboÙ_li¡
,

2454 &
uc_mgr
->
v®ue_li¡
, 
NULL
, NULL);

2455 ià(
”r
 < 0) {

2456 
	`uc_”rÜ
("Unableoƒxecute force boot sequence");

2457  
”r
;

2459  
”r
;

2460 
	}
}

2462 
	$£t_boÙ_u£r
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2463 cÚ¡ *
v®ue
)

2465 
”r
;

2467 ià(
v®ue
 !ğ
NULL
 && *value) {

2468 
	`uc_”rÜ
("”rÜ: wrÚg v®ufÜ _boÙ (%s)", 
v®ue
);

2469  -
EINVAL
;

2471 ià(
	`li¡_em±y
(&
uc_mgr
->
boÙ_li¡
))

2472  -
ENOENT
;

2473 
”r
 = 
	`execu‹_£qu’û
(
uc_mgr
, 
NULL
, &uc_mgr->
boÙ_li¡
,

2474 &
uc_mgr
->
v®ue_li¡
, 
NULL
, NULL);

2475 ià(
”r
 < 0) {

2476 
	`uc_”rÜ
("Unableoƒxecute boot sequence");

2477  
”r
;

2479  
”r
;

2480 
	}
}

2482 
	$£t_deçuÉs_u£r
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2483 cÚ¡ *
v®ue
)

2485 ià(
v®ue
 !ğ
NULL
 && *value) {

2486 
	`uc_”rÜ
("”rÜ: wrÚg v®ufÜ _deçuÉ (%s)", 
v®ue
);

2487  -
EINVAL
;

2489  
	`£t_deçuÉs
(
uc_mgr
, 
çl£
);

2490 
	}
}

2492 
	$hªdË_Œªs™iÚ_v”b
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2493 
u£_ÿ£_v”b
 *
Ãw_v”b
)

2495 
li¡_h—d
 *
pos
;

2496 
Œªs™iÚ_£qu’û
 *
Œªs
;

2497 
”r
;

2499 
	`li¡_fÜ_—ch
(
pos
, &
uc_mgr
->
aùive_v”b
->
Œªs™iÚ_li¡
) {

2500 
Œªs
 = 
	`li¡_’Œy
(
pos
, 
Œªs™iÚ_£qu’û
, 
li¡
);

2501 ià(
	`¡rcmp
(
Œªs
->
Çme
, 
Ãw_v”b
->name) == 0) {

2502 
”r
 = 
	`execu‹_£qu’û
(
uc_mgr
, uc_mgr->
aùive_v”b
,

2503 &
Œªs
->
Œªs™iÚ_li¡
,

2504 &
uc_mgr
->
aùive_v”b
->
v®ue_li¡
,

2505 &
uc_mgr
->
v®ue_li¡
,

2506 
NULL
);

2507 ià(
”r
 >= 0)

2509  
”r
;

2513 
	}
}

2515 
	$£t_v”b_u£r
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2516 cÚ¡ *
v”b_Çme
)

2518 
u£_ÿ£_v”b
 *
v”b
;

2519 
”r
 = 0;

2521 ià(
uc_mgr
->
aùive_v”b
 &&

2522 
	`¡rcmp
(
uc_mgr
->
aùive_v”b
->
Çme
, 
v”b_Çme
) == 0)

2524 ià(
	`¡rcmp
(
v”b_Çme
, 
SND_USE_CASE_VERB_INACTIVE
) != 0) {

2525 
v”b
 = 
	`fšd_v”b
(
uc_mgr
, 
v”b_Çme
);

2526 ià(
v”b
 =ğ
NULL
)

2527  -
ENOENT
;

2529 
v”b
 = 
NULL
;

2531 ià(
uc_mgr
->
aùive_v”b
) {

2532 
”r
 = 
	`hªdË_Œªs™iÚ_v”b
(
uc_mgr
, 
v”b
);

2533 ià(
”r
 == 0) {

2534 
”r
 = 
	`dismªe_u£_ÿ£
(
uc_mgr
);

2535 ià(
”r
 < 0)

2536  
”r
;

2537 } ià(
”r
 == 1) {

2538 
uc_mgr
->
aùive_v”b
 = 
v”b
;

2539 
v”b
 = 
NULL
;

2541 
v”b
 = 
NULL
;

2544 ià(
v”b
) {

2545 
”r
 = 
	`£t_v”b
(
uc_mgr
, 
v”b
, 1);

2546 ià(
”r
 < 0)

2547 
	`uc_”rÜ
("error: failedo initialize‚ew use case: %s",

2548 
v”b_Çme
);

2550  
”r
;

2551 
	}
}

2554 
	$£t_deviû_u£r
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2555 cÚ¡ *
deviû_Çme
,

2556 
’abË
)

2558 
u£_ÿ£_deviû
 *
deviû
;

2560 ià(
uc_mgr
->
aùive_v”b
 =ğ
NULL
)

2561  -
ENOENT
;

2562 
deviû
 = 
	`fšd_deviû
(
uc_mgr
, uc_mgr->
aùive_v”b
, 
deviû_Çme
, 1);

2563 ià(
deviû
 =ğ
NULL
)

2564  -
ENOENT
;

2565  
	`£t_deviû
(
uc_mgr
, 
deviû
, 
’abË
);

2566 
	}
}

2568 
	$£t_modif›r_u£r
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2569 cÚ¡ *
modif›r_Çme
,

2570 
’abË
)

2572 
u£_ÿ£_modif›r
 *
modif›r
;

2574 ià(
uc_mgr
->
aùive_v”b
 =ğ
NULL
)

2575  -
ENOENT
;

2577 
modif›r
 = 
	`fšd_modif›r
(
uc_mgr
, uc_mgr->
aùive_v”b
, 
modif›r_Çme
, 1);

2578 ià(
modif›r
 =ğ
NULL
)

2579  -
ENOENT
;

2580  
	`£t_modif›r
(
uc_mgr
, 
modif›r
, 
’abË
);

2581 
	}
}

2583 
	$sw™ch_deviû
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2584 cÚ¡ *
Şd_deviû
,

2585 cÚ¡ *
Ãw_deviû
)

2587 
u£_ÿ£_deviû
 *
xŞd
, *
xÃw
;

2588 
Œªs™iÚ_£qu’û
 *
Œªs
;

2589 
li¡_h—d
 *
pos
;

2590 
”r
, 
£q_found
 = 0;

2592 ià(
uc_mgr
->
aùive_v”b
 =ğ
NULL
)

2593  -
ENOENT
;

2594 ià(
	`deviû_¡©us
(
uc_mgr
, 
Şd_deviû
) == 0) {

2595 
	`uc_”rÜ
("”rÜ: deviû % nÙƒÇbËd", 
Şd_deviû
);

2596  -
EINVAL
;

2598 ià(
	`deviû_¡©us
(
uc_mgr
, 
Ãw_deviû
) != 0) {

2599 
	`uc_”rÜ
("”rÜ: deviû % ®»adyƒÇbËd", 
Ãw_deviû
);

2600  -
EINVAL
;

2602 
xŞd
 = 
	`fšd_deviû
(
uc_mgr
, uc_mgr->
aùive_v”b
, 
Şd_deviû
, 1);

2603 ià(
xŞd
 =ğ
NULL
)

2604  -
ENOENT
;

2605 
	`li¡_d–
(&
xŞd
->
aùive_li¡
);

2606 
xÃw
 = 
	`fšd_deviû
(
uc_mgr
, uc_mgr->
aùive_v”b
, 
Ãw_deviû
, 1);

2607 
	`li¡_add_
(&
xŞd
->
aùive_li¡
, &
uc_mgr
->
aùive_deviûs
);

2608 ià(
xÃw
 =ğ
NULL
)

2609  -
ENOENT
;

2610 
”r
 = 0;

2611 
	`li¡_fÜ_—ch
(
pos
, &
xŞd
->
Œªs™iÚ_li¡
) {

2612 
Œªs
 = 
	`li¡_’Œy
(
pos
, 
Œªs™iÚ_£qu’û
, 
li¡
);

2613 ià(
	`¡rcmp
(
Œªs
->
Çme
, 
Ãw_deviû
) == 0) {

2614 
”r
 = 
	`execu‹_£qu’û
(
uc_mgr
, uc_mgr->
aùive_v”b
,

2615 &
Œªs
->
Œªs™iÚ_li¡
,

2616 &
xŞd
->
v®ue_li¡
,

2617 &
uc_mgr
->
aùive_v”b
->
v®ue_li¡
,

2618 &
uc_mgr
->
v®ue_li¡
);

2619 ià(
”r
 >= 0) {

2620 
	`li¡_d–
(&
xŞd
->
aùive_li¡
);

2621 
	`li¡_add_
(&
xÃw
->
aùive_li¡
, &
uc_mgr
->
aùive_deviûs
);

2623 
£q_found
 = 1;

2627 ià(!
£q_found
) {

2628 
”r
 = 
	`£t_deviû
(
uc_mgr
, 
xŞd
, 0);

2629 ià(
”r
 < 0)

2630  
”r
;

2631 
”r
 = 
	`£t_deviû
(
uc_mgr
, 
xÃw
, 1);

2632 ià(
”r
 < 0)

2633  
”r
;

2635  
”r
;

2636 
	}
}

2638 
	$sw™ch_modif›r
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2639 cÚ¡ *
Şd_modif›r
,

2640 cÚ¡ *
Ãw_modif›r
)

2642 
u£_ÿ£_modif›r
 *
xŞd
, *
xÃw
;

2643 
Œªs™iÚ_£qu’û
 *
Œªs
;

2644 
li¡_h—d
 *
pos
;

2645 
”r
, 
£q_found
 = 0;

2647 ià(
uc_mgr
->
aùive_v”b
 =ğ
NULL
)

2648  -
ENOENT
;

2649 ià(
	`modif›r_¡©us
(
uc_mgr
, 
Şd_modif›r
) == 0) {

2650 
	`uc_”rÜ
("”rÜ: modif›¸% nÙƒÇbËd", 
Şd_modif›r
);

2651  -
EINVAL
;

2653 ià(
	`modif›r_¡©us
(
uc_mgr
, 
Ãw_modif›r
) != 0) {

2654 
	`uc_”rÜ
("”rÜ: modif›¸% ®»adyƒÇbËd", 
Ãw_modif›r
);

2655  -
EINVAL
;

2657 
xŞd
 = 
	`fšd_modif›r
(
uc_mgr
, uc_mgr->
aùive_v”b
, 
Şd_modif›r
, 1);

2658 ià(
xŞd
 =ğ
NULL
)

2659  -
ENOENT
;

2660 
xÃw
 = 
	`fšd_modif›r
(
uc_mgr
, uc_mgr->
aùive_v”b
, 
Ãw_modif›r
, 1);

2661 ià(
xÃw
 =ğ
NULL
)

2662  -
ENOENT
;

2663 
”r
 = 0;

2664 
	`li¡_fÜ_—ch
(
pos
, &
xŞd
->
Œªs™iÚ_li¡
) {

2665 
Œªs
 = 
	`li¡_’Œy
(
pos
, 
Œªs™iÚ_£qu’û
, 
li¡
);

2666 ià(
	`¡rcmp
(
Œªs
->
Çme
, 
Ãw_modif›r
) == 0) {

2667 
”r
 = 
	`execu‹_£qu’û
(
uc_mgr
, uc_mgr->
aùive_v”b
,

2668 &
Œªs
->
Œªs™iÚ_li¡
,

2669 &
xŞd
->
v®ue_li¡
,

2670 &
uc_mgr
->
aùive_v”b
->
v®ue_li¡
,

2671 &
uc_mgr
->
v®ue_li¡
);

2672 ià(
”r
 >= 0) {

2673 
	`li¡_d–
(&
xŞd
->
aùive_li¡
);

2674 
	`li¡_add_
(&
xÃw
->
aùive_li¡
, &
uc_mgr
->
aùive_modif›rs
);

2676 
£q_found
 = 1;

2680 ià(!
£q_found
) {

2681 
”r
 = 
	`£t_modif›r
(
uc_mgr
, 
xŞd
, 0);

2682 ià(
”r
 < 0)

2683  
”r
;

2684 
”r
 = 
	`£t_modif›r
(
uc_mgr
, 
xÃw
, 1);

2685 ià(
”r
 < 0)

2686  
”r
;

2688  
”r
;

2689 
	}
}

2691 
	$¢d_u£_ÿ£_£t
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2692 cÚ¡ *
id’tif›r
,

2693 cÚ¡ *
v®ue
)

2695 *
¡r
, *
¡r1
;

2696 
”r
 = 0;

2698 
	`±h»ad_mu‹x_lock
(&
uc_mgr
->
mu‹x
);

2699 ià(
	`¡rcmp
(
id’tif›r
, "_fboot") == 0)

2700 
”r
 = 
	`£t_fixedboÙ_u£r
(
uc_mgr
, 
v®ue
);

2701 ià(
	`¡rcmp
(
id’tif›r
, "_boot") == 0)

2702 
”r
 = 
	`£t_boÙ_u£r
(
uc_mgr
, 
v®ue
);

2703 ià(
	`¡rcmp
(
id’tif›r
, "_defaults") == 0)

2704 
”r
 = 
	`£t_deçuÉs_u£r
(
uc_mgr
, 
v®ue
);

2705 ià(
	`¡rcmp
(
id’tif›r
, "_verb") == 0)

2706 
”r
 = 
	`£t_v”b_u£r
(
uc_mgr
, 
v®ue
);

2707 ià(
	`¡rcmp
(
id’tif›r
, "_enadev") == 0)

2708 
”r
 = 
	`£t_deviû_u£r
(
uc_mgr
, 
v®ue
, 1);

2709 ià(
	`¡rcmp
(
id’tif›r
, "_disdev") == 0)

2710 
”r
 = 
	`£t_deviû_u£r
(
uc_mgr
, 
v®ue
, 0);

2711 ià(
	`¡rcmp
(
id’tif›r
, "_enamod") == 0)

2712 
”r
 = 
	`£t_modif›r_u£r
(
uc_mgr
, 
v®ue
, 1);

2713 ià(
	`¡rcmp
(
id’tif›r
, "_dismod") == 0)

2714 
”r
 = 
	`£t_modif›r_u£r
(
uc_mgr
, 
v®ue
, 0);

2716 
¡r1
 = 
	`¡rchr
(
id’tif›r
, '/');

2717 ià(
¡r1
) {

2718 
¡r
 = 
	`¡rdup
(
¡r1
 + 1);

2719 ià(
¡r
 =ğ
NULL
) {

2720 
”r
 = -
ENOMEM
;

2721 
__’d
;

2724 
”r
 = -
EINVAL
;

2725 
__’d
;

2727 ià(
	`check_id’tif›r
(
id’tif›r
, "_swdev"))

2728 
”r
 = 
	`sw™ch_deviû
(
uc_mgr
, 
¡r
, 
v®ue
);

2729 ià(
	`check_id’tif›r
(
id’tif›r
, "_swmod"))

2730 
”r
 = 
	`sw™ch_modif›r
(
uc_mgr
, 
¡r
, 
v®ue
);

2732 
”r
 = -
EINVAL
;

2733 ià(
¡r
)

2734 
	`ä“
(
¡r
);

2736 
__’d
:

2737 
	`±h»ad_mu‹x_uÆock
(&
uc_mgr
->
mu‹x
);

2738  
”r
;

2739 
	}
}

2748 
	$¢d_u£_ÿ£_·r£_ùl_–em_id
(
¢d_ùl_–em_id_t
 *
d¡
,

2749 cÚ¡ *
ucm_id
,

2750 cÚ¡ *
v®ue
)

2752 
¢d_ùl_–em_içû_t
 
içû
;

2753 
jack_cÚŒŞ
;

2755 
jack_cÚŒŞ
 = 
	`¡rcmp
(
ucm_id
, "JackControl") == 0;

2756 ià(!
jack_cÚŒŞ
 &&

2757 
	`¡rcmp
(
ucm_id
, "PlaybackVolume") &&

2758 
	`¡rcmp
(
ucm_id
, "PlaybackSwitch") &&

2759 
	`¡rcmp
(
ucm_id
, "CaptureVolume") &&

2760 
	`¡rcmp
(
ucm_id
, "CaptureSwitch"))

2761  -
EINVAL
;

2762 
	`¢d_ùl_–em_id_ş—r
(
d¡
);

2763 ià(
	`¡rÿ£¡r
(
v®ue
, "name="))

2764  
	`__¢d_ùl_ascii_–em_id_·r£
(
d¡
, 
v®ue
, 
NULL
);

2765 
içû
 = 
SND_CTL_ELEM_IFACE_MIXER
;

2766 ià(
jack_cÚŒŞ
)

2767 
içû
 = 
SND_CTL_ELEM_IFACE_CARD
;

2768 
	`¢d_ùl_–em_id_£t_š‹rçû
(
d¡
, 
içû
);

2769 
	`¢d_ùl_–em_id_£t_Çme
(
d¡
, 
v®ue
);

2771 
	}
}

2780 
	$¢d_u£_ÿ£_·r£_£Ëm_id
(
¢d_mix”_£Ëm_id_t
 *
d¡
,

2781 cÚ¡ *
ucm_id
,

2782 cÚ¡ *
v®ue
)

2784 #ifdeà
BUILD_MIXER


2785 ià(
	`¡rcmp
(
ucm_id
, "PlaybackMixerId") == 0 ||

2786 
	`¡rcmp
(
ucm_id
, "CaptureMixerId") == 0)

2787  
	`¢d_mix”_£Ëm_id_·r£
(
d¡
, 
v®ue
);

2789  -
EINVAL
;

2790 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/parser.c

33 
	~"ucm_loÿl.h
"

34 
	~<sys/¡©.h
>

35 
	~<¡dboŞ.h
>

36 
	~<dœ’t.h
>

37 
	~<lim™s.h
>

39 
f’ame_f‹r
(cÚ¡ 
dœ’t64
 *
dœ’t
);

41 
·r£_£qu’û
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

42 
li¡_h—d
 *
ba£
,

43 
¢d_cÚfig_t
 *
cfg
);

48 
	$ucm_f’ame
(*
â
, 
size_t
 
â_Ën
, 
v”siÚ
,

49 cÚ¡ *
dœ
, cÚ¡ *
fe
)

51 cÚ¡ *
’v
 = 
	`g‘’v
(
v”siÚ
 > 1 ? 
ALSA_CONFIG_UCM2_VAR
 : 
ALSA_CONFIG_UCM_VAR
);

53 ià(
fe
[0] == '/')

54 
fe
++;

55 ià(
’v
 =ğ
NULL
)

56 
	`¢´štf
(
â
, 
â_Ën
, "%s/%s/%s%s%s",

57 
	`¢d_cÚfig_tİdœ
(), 
v”siÚ
 > 1 ? "ucm2" : "ucm",

58 
dœ
 ?: "", dœ ? "/" : "", 
fe
);

60 
	`¢´štf
(
â
, 
â_Ën
, "%s/%s%s%s",

61 
’v
, 
dœ
 ?: "", dœ ? "/" : "", 
fe
);

62 
	}
}

67 
	$uc_mgr_cÚfig_lßd_fe
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

68 cÚ¡ *
fe
, 
¢d_cÚfig_t
 **
cfg
)

70 
f’ame
[
PATH_MAX
];

71 
”r
;

73 
	`ucm_f’ame
(
f’ame
, (f’ame), 
uc_mgr
->
cÚf_fÜm©
,

74 
fe
[0] =ğ'/' ? 
NULL
 : 
uc_mgr
->
cÚf_dœ_Çme
,

75 
fe
);

76 
”r
 = 
	`uc_mgr_cÚfig_lßd
(
uc_mgr
->
cÚf_fÜm©
, 
f’ame
, 
cfg
);

77 ià(
”r
 < 0) {

78 
	`uc_”rÜ
("”rÜ: faedØİ’ f%s: %d", 
f’ame
, 
”r
);

79  
”r
;

82 
	}
}

87 *
	$»¶aû_¡ršg
(**
d¡
, cÚ¡ *
v®ue
)

89 
	`ä“
(*
d¡
);

90 *
d¡
 = 
v®ue
 ? 
	`¡rdup
(v®ueè: 
NULL
;

91  *
d¡
;

92 
	}
}

97 
	$·r£_¡ršg
(
¢d_cÚfig_t
 *
n
, **
»s
)

99 
”r
;

101 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, (cÚ¡ **)
»s
);

102 ià(
”r
 < 0)

103  
”r
;

104 *
»s
 = 
	`¡rdup
(*res);

105 ià(*
»s
 =ğ
NULL
)

106  -
ENOMEM
;

108 
	}
}

113 
	$·r£_¡ršg_sub¡™u‹
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

114 
¢d_cÚfig_t
 *
n
, **
»s
)

116 cÚ¡ *
¡r
;

117 *
s
;

118 
”r
;

120 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
¡r
);

121 ià(
”r
 < 0)

122  
”r
;

123 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s
, 
¡r
);

124 ià(
”r
 >= 0)

125 *
»s
 = 
s
;

126  
”r
;

127 
	}
}

132 
	$·r£_¡ršg_sub¡™u‹3
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

133 
¢d_cÚfig_t
 *
n
, **
»s
)

135 ià(
uc_mgr
->
cÚf_fÜm©
 < 3)

136  
	`·r£_¡ršg
(
n
, 
»s
);

137  
	`·r£_¡ršg_sub¡™u‹
(
uc_mgr
, 
n
, 
»s
);

138 
	}
}

143 
	$·r£_š‹g”_sub¡™u‹
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

144 
¢d_cÚfig_t
 *
n
, *
»s
)

146 *
s1
, *
s2
;

147 
”r
;

149 
”r
 = 
	`¢d_cÚfig_g‘_ascii
(
n
, &
s1
);

150 ià(
”r
 < 0)

151  
”r
;

152 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s2
, 
s1
);

153 ià(
”r
 >= 0)

154 
”r
 = 
	`§ã_¡¹Ş
(
s2
, 
»s
);

155 
	`ä“
(
s2
);

156 
	`ä“
(
s1
);

157  
”r
;

158 
	}
}

163 
	$·r£_š‹g”_sub¡™u‹3
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

164 
¢d_cÚfig_t
 *
n
, *
»s
)

166 *
s1
, *
s2
;

167 
”r
;

169 
”r
 = 
	`¢d_cÚfig_g‘_ascii
(
n
, &
s1
);

170 ià(
”r
 < 0)

171  
”r
;

172 ià(
uc_mgr
->
cÚf_fÜm©
 < 3)

173 
s2
 = 
s1
;

175 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s2
, 
s1
);

176 ià(
”r
 >= 0)

177 
”r
 = 
	`§ã_¡¹Ş
(
s2
, 
»s
);

178 ià(
s1
 !ğ
s2
)

179 
	`ä“
(
s2
);

180 
	`ä“
(
s1
);

181  
”r
;

182 
	}
}

187 
	$·r£_is_Çme_§ã
(cÚ¡ *
Çme
)

189 ià(
	`¡rchr
(
Çme
, '.')) {

190 
	`uc_”rÜ
("ch¬ '.'‚Ù‡Îowed iÀ'%s'", 
Çme
);

194 
	}
}

196 
	$g‘_¡ršg3
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
s1
, **
s
)

198 ià(
uc_mgr
->
cÚf_fÜm©
 < 3) {

199 *
s
 = 
	`¡rdup
(
s1
);

200 ià(*
s
 =ğ
NULL
)

201  -
ENOMEM
;

204  
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, 
s
, 
s1
);

205 
	}
}

207 
	$·r£_g‘_§ã_Çme
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
n
,

208 cÚ¡ *
®t
, **
Çme
)

210 cÚ¡ *
id
;

211 
”r
;

213 ià(
®t
) {

214 
id
 = 
®t
;

216 
”r
 = 
	`¢d_cÚfig_g‘_id
(
n
, &
id
);

217 ià(
”r
 < 0)

218  
”r
;

220 
”r
 = 
	`g‘_¡ršg3
(
uc_mgr
, 
id
, 
Çme
);

221 ià(
”r
 < 0)

222  
”r
;

223 ià(!
	`·r£_is_Çme_§ã
(*
Çme
)) {

224 
	`ä“
(*
Çme
);

225  -
EINVAL
;

228 
	}
}

233 
	$”rÜ_node
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
cfg
)

235 
”r
;

236 *
s
;

238 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
cfg
, &
s
);

239 ià(
”r
 < 0) {

240 
	`uc_”rÜ
("error: failedo get Error string");

241  
”r
;

243 ià(!
uc_mgr
->
suµ»ss_nodev_”rÜs
)

244 
	`uc_”rÜ
("%s", 
s
);

245 
	`ä“
(
s
);

246  -
ENXIO
;

247 
	}
}

252 
	$·r£_syÁax_f›ld
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

253 
¢d_cÚfig_t
 *
cfg
, cÚ¡ *
f’ame
)

255 
¢d_cÚfig_t
 *
n
;

256 
l
;

257 
”r
;

259 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cfg
, "SyÁax", &
n
);

260 ià(
”r
 < 0) {

261 
	`uc_”rÜ
("SyÁax f›ld‚Ù found iÀ%s", 
f’ame
);

262  -
EINVAL
;

264 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
n
, &
l
);

265 ià(
”r
 < 0) {

266 
	`uc_”rÜ
("SyÁax f›ld i šv®id iÀ%s", 
f’ame
);

267  
”r
;

269 ià(
l
 < 2 ||† > 
SYNTAX_VERSION_MAX
) {

270 
	`uc_”rÜ
("Incom·tibË syÁax %ld iÀ%s", 
l
, 
f’ame
);

271  -
EINVAL
;

274 
	`¢d_cÚfig_d–‘e
(
n
);

275 
uc_mgr
->
cÚf_fÜm©
 = 
l
;

276  
l
;

277 
	}
}

282 
	$ev®u©e_»gex
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

283 
¢d_cÚfig_t
 *
cfg
)

285 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

286 
¢d_cÚfig_t
 *
d
, *
n
;

287 cÚ¡ *
id
;

288 
”r
;

290 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cfg
, "DefšeRegex", &
d
);

291 ià(
”r
 =ğ-
ENOENT
)

293 ià(
”r
 < 0)

294  
”r
;

296 ià(
	`¢d_cÚfig_g‘_ty³
(
d
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

297 
	`uc_”rÜ
("compoundypeƒxpected for DefineRegex");

298  -
EINVAL
;

301 ià(
uc_mgr
->
cÚf_fÜm©
 < 3) {

302 
	`uc_”rÜ
("DefineRegex is supported in v3+ syntax");

303  -
EINVAL
;

306 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
d
) {

307 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

308 
”r
 = 
	`¢d_cÚfig_g‘_id
(
n
, &
id
);

309 ià(
”r
 < 0)

310  
”r
;

311 ià(
id
[0] == '@') {

312 
	`uc_”rÜ
("error: value‚ames starting with '@'‡re„eserved for‡pplication variables");

313  -
EINVAL
;

315 
”r
 = 
	`uc_mgr_defše_»gex
(
uc_mgr
, 
id
, 
n
);

316 ià(
”r
 < 0)

317  
”r
;

320 
	`¢d_cÚfig_d–‘e
(
d
);

322 
	}
}

327 
	$ev®u©e_defše
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

328 
¢d_cÚfig_t
 *
cfg
)

330 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

331 
¢d_cÚfig_t
 *
d
, *
n
;

332 cÚ¡ *
id
;

333 *
v¬
, *
s
;

334 
”r
;

336 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cfg
, "Defše", &
d
);

337 ià(
”r
 =ğ-
ENOENT
)

338  
	`ev®u©e_»gex
(
uc_mgr
, 
cfg
);

339 ià(
”r
 < 0)

340  
”r
;

342 ià(
	`¢d_cÚfig_g‘_ty³
(
d
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

343 
	`uc_”rÜ
("compoundypeƒxpected for Define");

344  -
EINVAL
;

347 ià(
uc_mgr
->
cÚf_fÜm©
 < 3) {

348 
	`uc_”rÜ
("Define is supported in v3+ syntax");

349  -
EINVAL
;

352 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
d
) {

353 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

354 
”r
 = 
	`¢d_cÚfig_g‘_id
(
n
, &
id
);

355 ià(
”r
 < 0)

356  
”r
;

357 
”r
 = 
	`¢d_cÚfig_g‘_ascii
(
n
, &
v¬
);

358 ià(
”r
 < 0)

359  
”r
;

360 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s
, 
v¬
);

361 
	`ä“
(
v¬
);

362 ià(
”r
 < 0)

363  
”r
;

364 ià(
id
[0] == '@') {

365 
	`ä“
(
s
);

366 
	`uc_”rÜ
("error: value‚ames starting with '@'‡re„eserved for‡pplication variables");

367  -
EINVAL
;

369 
”r
 = 
	`uc_mgr_£t_v¬ŸbË
(
uc_mgr
, 
id
, 
s
);

370 
	`ä“
(
s
);

371 ià(
”r
 < 0)

372  
”r
;

375 
	`¢d_cÚfig_d–‘e
(
d
);

377  
	`ev®u©e_»gex
(
uc_mgr
, 
cfg
);

378 
	}
}

383 
	$ev®u©e_defše_maüo
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

384 
¢d_cÚfig_t
 *
cfg
)

386 
¢d_cÚfig_t
 *
d
;

387 
”r
;

389 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cfg
, "DefšeMaüo", &
d
);

390 ià(
”r
 =ğ-
ENOENT
)

392 ià(
”r
 < 0)

393  
”r
;

395 ià(
	`¢d_cÚfig_g‘_ty³
(
d
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

396 
	`uc_”rÜ
("compoundypeƒxpected for DefineMacro");

397  -
EINVAL
;

400 ià(
uc_mgr
->
cÚf_fÜm©
 < 6) {

401 
	`uc_”rÜ
("DefineMacro is supported in v6+ syntax");

402  -
EINVAL
;

405 
”r
 = 
	`¢d_cÚfig_m”ge
(
uc_mgr
->
maüos
, 
d
, 0);

406 ià(
”r
 < 0)

407  
”r
;

409 
	}
}

411 
	$ev®u©e_maüo1
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

412 
¢d_cÚfig_t
 *
d¡
,

413 
¢d_cÚfig_t
 *
¬gs
)

415 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

416 
¢d_cÚfig_t
 *
m
, *
mc
, *
a
, *
n
;

417 cÚ¡ *
mid
, *
id
;

418 
Çme
[128], *
v¬
, *
v¬2
;

419 cÚ¡ *
s
;

420 
”r
;

422 
”r
 = 
	`¢d_cÚfig_g‘_id
(
¬gs
, &
mid
);

423 ià(
”r
 < 0)

424  
”r
;

425 
”r
 = 
	`¢d_cÚfig_£¬ch
(
uc_mgr
->
maüos
, 
mid
, &
m
);

426 ià(
”r
 < 0) {

427 
	`uc_”rÜ
("MaüØ'%s' i nÙ defšed", 
mid
);

428  
”r
;

431 
a
 = 
¬gs
;

432 ià(
	`¢d_cÚfig_g‘_ty³
(
¬gs
è=ğ
SND_CONFIG_TYPE_STRING
) {

433 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
¬gs
, &
s
);

434 ià(
”r
 < 0)

435  
”r
;

436 
”r
 = 
	`¢d_cÚfig_lßd_¡ršg
(&
a
, 
s
, 0);

437 ià(
”r
 < 0)

438  
”r
;

439 } ià(
	`¢d_cÚfig_g‘_ty³
(
¬gs
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

440  -
EINVAL
;

444 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
a
) {

445 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

446 
”r
 = 
	`¢d_cÚfig_g‘_id
(
n
, &
id
);

447 ià(
”r
 < 0)

448 
__”r_·th
;

449 
	`¢´štf
(
Çme
, Òame), "__%s", 
id
);

450 ià(
	`uc_mgr_g‘_v¬ŸbË
(
uc_mgr
, 
Çme
)) {

451 
	`uc_”rÜ
("MaüØ¬gum’ˆ'%s' i ®»ady defšed", 
Çme
);

452 
__”r_·th
;

454 
”r
 = 
	`¢d_cÚfig_g‘_ascii
(
n
, &
v¬
);

455 ià(
”r
 < 0)

456 
__”r_·th
;

457 ià(
uc_mgr
->
cÚf_fÜm©
 < 7) {

458 
”r
 = 
	`uc_mgr_£t_v¬ŸbË
(
uc_mgr
, 
Çme
, 
v¬
);

459 
	`ä“
(
v¬
);

461 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
v¬2
, 
v¬
);

462 
	`ä“
(
v¬
);

463 ià(
”r
 >= 0) {

464 
”r
 = 
	`uc_mgr_£t_v¬ŸbË
(
uc_mgr
, 
Çme
, 
v¬2
);

465 
	`ä“
(
v¬2
);

468 ià(
”r
 < 0)

469 
__”r_·th
;

473 
”r
 = 
	`¢d_cÚfig_cİy
(&
mc
, 
m
);

474 ià(
”r
 < 0)

475 
__”r_·th
;

476 
”r
 = 
	`uc_mgr_ev®u©e_š¶aû
(
uc_mgr
, 
mc
);

477 ià(
”r
 < 0) {

478 
	`¢d_cÚfig_d–‘e
(
mc
);

479 
__”r_·th
;

481 
”r
 = 
	`uc_mgr_cÚfig_Œ“_m”ge
(
uc_mgr
, 
d¡
, 
mc
, 
NULL
, NULL);

482 
	`¢d_cÚfig_d–‘e
(
mc
);

485 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
a
) {

486 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

487 
”r
 = 
	`¢d_cÚfig_g‘_id
(
n
, &
id
);

488 ià(
”r
 < 0)

489 
__”r_·th
;

490 
	`¢´štf
(
Çme
, Òame), "__%s", 
id
);

491 
”r
 = 
	`uc_mgr_d–‘e_v¬ŸbË
(
uc_mgr
, 
Çme
);

492 ià(
”r
 < 0)

493 
__”r_·th
;

496 
__”r_·th
:

497 ià(
a
 !ğ
¬gs
)

498 
	`¢d_cÚfig_d–‘e
(
a
);

499  
”r
;

500 
	}
}

505 
	$ev®u©e_maüo
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

506 
¢d_cÚfig_t
 *
cfg
)

508 
¢d_cÚfig_™”©Ü_t
 
i
, 
i2
, 
Ãxt
, 
Ãxt2
;

509 
¢d_cÚfig_t
 *
d
, *
n
, *
n2
;

510 
”r
, 
»t
;

512 
»t
 = 
	`ev®u©e_defše_maüo
(
uc_mgr
, 
cfg
);

513 ià(
»t
 < 0)

514  
»t
;

516 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cfg
, "Maüo", &
d
);

517 ià(
”r
 =ğ-
ENOENT
)

518  
»t
;

519 ià(
”r
 < 0)

520  
”r
;

522 ià(
	`¢d_cÚfig_g‘_ty³
(
d
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

523 
	`uc_”rÜ
("compoundypeƒxpected for DefineMacro");

524  -
EINVAL
;

527 ià(
uc_mgr
->
cÚf_fÜm©
 < 6) {

528 
	`uc_”rÜ
("Macro is supported in v6+ syntax");

529  -
EINVAL
;

532 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
d
) {

533 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

534 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

535 cÚ¡ *
id
;

536 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
))

537 
id
 = "";

538 
	`uc_”rÜ
("compoundy³ƒx³ùed fÜ Maüo.%s", 
id
);

539  -
EINVAL
;

541 
	`¢d_cÚfig_fÜ_—ch
(
i2
, 
Ãxt2
, 
n
) {

542 
n2
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i2
);

543 
”r
 = 
	`ev®u©e_maüo1
(
uc_mgr
, 
cfg
, 
n2
);

544 ià(
”r
 < 0)

545  
”r
;

549 
	`¢d_cÚfig_d–‘e
(
d
);

552 
	}
}

557 
	$ev®u©e_šşude
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

558 
¢d_cÚfig_t
 *
cfg
)

560 
¢d_cÚfig_t
 *
n
;

561 
”r
;

563 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cfg
, "Inşude", &
n
);

564 ià(
”r
 =ğ-
ENOENT
)

566 ià(
”r
 < 0)

567  
”r
;

569 
”r
 = 
	`uc_mgr_ev®u©e_šşude
(
uc_mgr
, 
cfg
, 
n
);

570 
	`¢d_cÚfig_d–‘e
(
n
);

571  
”r
;

572 
	}
}

577 
	$ev®u©e_cÚd™iÚ
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
cfg
)

579 
¢d_cÚfig_t
 *
n
;

580 
”r
;

582 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cfg
, "If", &
n
);

583 ià(
”r
 =ğ-
ENOENT
)

585 ià(
”r
 < 0)

586  
”r
;

588 
”r
 = 
	`uc_mgr_ev®u©e_cÚd™iÚ
(
uc_mgr
, 
cfg
, 
n
);

589 
	`¢d_cÚfig_d–‘e
(
n
);

590  
”r
;

591 
	}
}

596 
	$ev®u©e_v¬ŸÁ
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
cfg
)

598 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

599 
¢d_cÚfig_t
 *
n
, *
c
;

600 cÚ¡ *
id
;

601 
”r
;

603 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cfg
, "V¬ŸÁ", &
c
);

604 ià(
”r
 =ğ-
ENOENT
)

606 ià(
”r
 < 0)

607  
”r
;

609 ià(
uc_mgr
->
cÚf_fÜm©
 < 6) {

610 
	`uc_”rÜ
("Variant is supported in v6+ syntax");

611  -
EINVAL
;

614 ià(
uc_mgr
->
·r£_ma¡”_£ùiÚ
)

617 ià(
uc_mgr
->
·r£_v¬ŸÁ
 =ğ
NULL
)

618 
__»t
;

620 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
c
) {

621 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

623 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

624  -
EINVAL
;

626 ià(
	`¡rcmp
(
id
, 
uc_mgr
->
·r£_v¬ŸÁ
))

629 
”r
 = 
	`uc_mgr_ev®u©e_š¶aû
(
uc_mgr
, 
n
);

630 ià(
”r
 < 0)

631  
”r
;

633 
”r
 = 
	`uc_mgr_cÚfig_Œ“_m”ge
(
uc_mgr
, 
cfg
, 
n
, 
NULL
, NULL);

634 ià(
”r
 < 0)

635  
”r
;

636 
	`¢d_cÚfig_d–‘e
(
c
);

640 
__»t
:

641 
	`¢d_cÚfig_d–‘e
(
c
);

643 
	}
}

648 
	$uc_mgr_ev®u©e_š¶aû
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

649 
¢d_cÚfig_t
 *
cfg
)

651 
™”©iÚs
 = 10000;

652 
”r1
 = 0, 
”r2
 = 0, 
”r3
 = 0, 
”r4
 = 0, 
”r5
 = 0;

654 
”r1
 =ğ0 || 
”r2
 =ğ0 || 
”r3
 =ğ0 || 
”r4
 =ğ0 || 
”r5
 == 0) {

655 ià(
™”©iÚs
 == 0) {

656 
	`uc_”rÜ
("Maximal inplaceƒvaluation iterations‚umber„eached (recursive„eferences?)");

657  -
EINVAL
;

659 
™”©iÚs
--;

661 
”r1
 = 
	`ev®u©e_defše
(
uc_mgr
, 
cfg
);

662 ià(
”r1
 < 0)

663  
”r1
;

665 
”r2
 = 
	`ev®u©e_šşude
(
uc_mgr
, 
cfg
);

666 ià(
”r2
 < 0)

667  
”r2
;

670 ià(
”r2
 == 0)

672 
”r3
 = 
	`ev®u©e_v¬ŸÁ
(
uc_mgr
, 
cfg
);

673 ià(
”r3
 < 0)

674  
”r3
;

675 ià(
”r3
 == 0)

677 
uc_mgr
->
maüo_hİs
++;

678 ià(
uc_mgr
->
maüo_hİs
 > 100) {

679 
	`uc_”rÜ
("Maximal macro hops„eached!");

680  -
EINVAL
;

682 
”r4
 = 
	`ev®u©e_maüo
(
uc_mgr
, 
cfg
);

683 
uc_mgr
->
maüo_hİs
--;

684 ià(
”r4
 < 0)

685  
”r4
;

686 ià(
”r4
 == 0)

688 
”r5
 = 
	`ev®u©e_cÚd™iÚ
(
uc_mgr
, 
cfg
);

689 ià(
”r5
 < 0)

690  
”r5
;

693 
	}
}

698 
	$·r£_libcÚfig1
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
cfg
)

700 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

701 
¢d_cÚfig_t
 *
n
, *
cÚfig
 = 
NULL
;

702 cÚ¡ *
id
, *
fe
 = 
NULL
;

703 
boŞ
 
sub¡fe
 = 
çl£
, 
sub¡cÚfig
 = false;

704 
”r
;

706 ià(
	`¢d_cÚfig_g‘_id
(
cfg
, &
id
) < 0)

707  -
EINVAL
;

709 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

710 
	`uc_”rÜ
("compoundy³ƒx³ùed fÜ %s", 
id
);

711  -
EINVAL
;

714 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

715 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

717 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

718  -
EINVAL
;

720 ià(
	`¡rcmp
(
id
, "File") == 0 ||

721 
	`¡rcmp
(
id
, "SubstiFile") == 0) {

722 
sub¡fe
 = 
id
[0] == 'S';

723 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
fe
);

724 ià(
”r
 < 0)

725  
”r
;

729 ià(
	`¡rcmp
(
id
, "Config") == 0 ||

730 
	`¡rcmp
(
id
, "SubstiConfig") == 0) {

731 
sub¡cÚfig
 = 
id
[0] == 'S';

732 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_COMPOUND
)

733  -
EINVAL
;

734 
cÚfig
 = 
n
;

738 
	`uc_”rÜ
("unknowÀf›ld %s", 
id
);

739  -
EINVAL
;

742 ià(
fe
) {

743 ià(
sub¡fe
) {

744 
¢d_cÚfig_t
 *
cfg
;

745 
”r
 = 
	`uc_mgr_cÚfig_lßd
(
uc_mgr
->
cÚf_fÜm©
, 
fe
, &
cfg
);

746 ià(
”r
 < 0)

747  
”r
;

748 
”r
 = 
	`uc_mgr_sub¡™u‹_Œ“
(
uc_mgr
, 
cfg
);

749 ià(
”r
 < 0) {

750 
	`¢d_cÚfig_d–‘e
(
cfg
);

751  
”r
;

753 
”r
 = 
	`¢d_cÚfig_m”ge
(
uc_mgr
->
loÿl_cÚfig
, 
cfg
, 0);

754 ià(
”r
 < 0) {

755 
	`¢d_cÚfig_d–‘e
(
cfg
);

756  
”r
;

759 
f’ame
[
PATH_MAX
];

761 
	`ucm_f’ame
(
f’ame
, (f’ame), 
uc_mgr
->
cÚf_fÜm©
,

762 
fe
[0] =ğ'/' ? 
NULL
 : 
uc_mgr
->
cÚf_dœ_Çme
,

763 
fe
);

764 
”r
 = 
	`uc_mgr_cÚfig_lßd_što
(
uc_mgr
->
cÚf_fÜm©
, 
f’ame
, uc_mgr->
loÿl_cÚfig
);

765 ià(
”r
 < 0)

766  
”r
;

770 ià(
cÚfig
) {

771 ià(
sub¡cÚfig
) {

772 
”r
 = 
	`uc_mgr_sub¡™u‹_Œ“
(
uc_mgr
, 
cÚfig
);

773 ià(
”r
 < 0)

774  
”r
;

776 
”r
 = 
	`¢d_cÚfig_m”ge
(
uc_mgr
->
loÿl_cÚfig
, 
cÚfig
, 0);

777 ià(
”r
 < 0)

778  
”r
;

782 
	}
}

787 
	$·r£_libcÚfig
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
cfg
)

789 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

790 
¢d_cÚfig_t
 *
n
;

791 cÚ¡ *
id
;

792 
”r
;

794 ià(
	`¢d_cÚfig_g‘_id
(
cfg
, &
id
) < 0)

795  -
EINVAL
;

797 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

798 
	`uc_”rÜ
("compoundy³ƒx³ùed fÜ %s", 
id
);

799  -
EINVAL
;

802 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

803 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

805 
”r
 = 
	`·r£_libcÚfig1
(
uc_mgr
, 
n
);

806 ià(
”r
 < 0)

807  
”r
;

811 
	}
}

816 
	$·r£_Œªs™iÚ
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

817 
li¡_h—d
 *
i¡
,

818 
¢d_cÚfig_t
 *
cfg
)

820 
Œªs™iÚ_£qu’û
 *
t£q
;

821 cÚ¡ *
id
;

822 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

823 
¢d_cÚfig_t
 *
n
;

824 
”r
;

826 ià(
	`¢d_cÚfig_g‘_id
(
cfg
, &
id
) < 0)

827  -
EINVAL
;

829 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

830 
	`uc_”rÜ
("compoundy³ƒx³ùed fÜ %s", 
id
);

831  -
EINVAL
;

834 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

835 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

837 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

838  -
EINVAL
;

840 
t£q
 = 
	`ÿÎoc
(1, (*tseq));

841 ià(
t£q
 =ğ
NULL
)

842  -
ENOMEM
;

843 
	`INIT_LIST_HEAD
(&
t£q
->
Œªs™iÚ_li¡
);

845 
”r
 = 
	`g‘_¡ršg3
(
uc_mgr
, 
id
, &
t£q
->
Çme
);

846 ià(
”r
 < 0) {

847 
	`ä“
(
t£q
);

848  
”r
;

851 
”r
 = 
	`·r£_£qu’û
(
uc_mgr
, &
t£q
->
Œªs™iÚ_li¡
, 
n
);

852 ià(
”r
 < 0) {

853 
	`uc_mgr_ä“_Œªs™iÚ_–em’t
(
t£q
);

854  
”r
;

857 
	`li¡_add
(&
t£q
->
li¡
, 
i¡
);

860 
	}
}

865 
·r£_compound
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
cfg
,

866 (*
fú
)(
¢d_u£_ÿ£_mgr_t
 *, 
¢d_cÚfig_t
 *, *, *),

867 *
d©a1
, *
d©a2
)

869 cÚ¡ *
id
;

870 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

871 
¢d_cÚfig_t
 *
n
;

872 
”r
;

874 ià(
	`¢d_cÚfig_g‘_id
(
cfg
, &
id
) < 0)

875  -
EINVAL
;

877 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

878 
	`uc_”rÜ
("compoundy³ƒx³ùed fÜ %s", 
id
);

879  -
EINVAL
;

882 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

883 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

885 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

886 
	`uc_”rÜ
("compoundy³ƒx³ùed fÜ %s, i %d", 
id
, 
	`¢d_cÚfig_g‘_ty³
(
cfg
));

887  -
EINVAL
;

890 
”r
 = 
	`fú
(
uc_mgr
, 
n
, 
d©a1
, 
d©a2
);

891 ià(
”r
 < 0)

892  
”r
;

896 
	}
}

898 
	$¡r_Ëgacy_dev_šdex
(*
Çme
)

900 *
dÙ
 = 
	`¡rchr
(
Çme
, '.');

901 ià(!
dÙ
)

903 ià(
dÙ
[1] != '0' || dot[2] != '\0') {

904 
	`uc_”rÜ
("device‚ame %s contains‡ '.',"

905 "‡nd i nÙ†egacy foo.0 fÜm©", 
Çme
);

906  -
EINVAL
;

908 *
dÙ
 = '\0';

910 
	}
}

915 
	$·r£_deviû_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
 
ATTRIBUTE_UNUSED
,

916 
dev_li¡
 *dev_list,

917 
dev_li¡_ty³
 
ty³
,

918 
¢d_cÚfig_t
 *
cfg
)

920 
dev_li¡_node
 *
sdev
;

921 cÚ¡ *
id
;

922 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

923 
¢d_cÚfig_t
 *
n
;

924 
”r
;

926 ià(
dev_li¡
->
ty³
 !ğ
DEVLIST_NONE
) {

927 
	`uc_”rÜ
("error: multiple supported or"

929  -
EEXIST
;

932 ià(
	`¢d_cÚfig_g‘_id
(
cfg
, &
id
) < 0)

933  -
EINVAL
;

935 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

936 
	`uc_”rÜ
("compoundy³ƒx³ùed fÜ %s", 
id
);

937  -
EINVAL
;

940 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

941 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

943 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

944  -
EINVAL
;

946 
sdev
 = 
	`ÿÎoc
(1, (
dev_li¡_node
));

947 ià(
sdev
 =ğ
NULL
)

948  -
ENOMEM
;

949 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &
sdev
->
Çme
);

950 ià(
”r
 < 0) {

951 
	`ä“
(
sdev
);

952  
”r
;

954 
”r
 = 
	`¡r_Ëgacy_dev_šdex
(
sdev
->
Çme
);

955 ià(
”r
 < 0) {

956 
	`ä“
(
sdev
->
Çme
);

957 
	`ä“
(
sdev
);

958  
”r
;

960 
	`li¡_add
(&
sdev
->
li¡
, &
dev_li¡
->list);

963 
dev_li¡
->
ty³
 =ype;

966 
	}
}

980 
u£_ÿ£_deviû
 *
	$fšd_compÚ’t_dev
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

981 cÚ¡ *
Çme
)

983 
li¡_h—d
 *
pos
, *
posdev
, *
_posdev
;

984 
u£_ÿ£_v”b
 *
v”b
;

985 
u£_ÿ£_deviû
 *
dev
;

987 
	`li¡_fÜ_—ch
(
pos
, &
uc_mgr
->
v”b_li¡
) {

988 
v”b
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_v”b
, 
li¡
);

991 
	`li¡_fÜ_—ch
(
posdev
, &
v”b
->
cm±_deviû_li¡
) {

992 
dev
 = 
	`li¡_’Œy
(
posdev
, 
u£_ÿ£_deviû
, 
li¡
);

993 ià(!
	`¡rcmp
(
dev
->
Çme
,‚ame))

994  
dev
;

998 
	`li¡_fÜ_—ch_§ã
(
posdev
, 
_posdev
, &
v”b
->
deviû_li¡
) {

999 
dev
 = 
	`li¡_’Œy
(
posdev
, 
u£_ÿ£_deviû
, 
li¡
);

1000 ià(!
	`¡rcmp
(
dev
->
Çme
,‚ame)) {

1005 
	`li¡_d–
(&
dev
->
li¡
);

1006 
	`li¡_add_
(&
dev
->
li¡
,

1007 &
v”b
->
cm±_deviû_li¡
);

1008  
dev
;

1013  
NULL
;

1014 
	}
}

1021 
	$·r£_compÚ’t_£q
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1022 
¢d_cÚfig_t
 *
n
, 
’abË
,

1023 
compÚ’t_£qu’û
 *
cm±_£q
)

1025 *
v®
;

1026 
”r
;

1028 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &
v®
);

1029 ià(
”r
 < 0)

1030  
”r
;

1032 
cm±_£q
->
deviû
 = 
	`fšd_compÚ’t_dev
(
uc_mgr
, 
v®
);

1033 ià(!
cm±_£q
->
deviû
) {

1034 
	`uc_”rÜ
("”rÜ: CªnÙ fšd compÚ’ˆdeviû %s", 
v®
);

1035 
	`ä“
(
v®
);

1036  -
EINVAL
;

1038 
	`ä“
(
v®
);

1041 
cm±_£q
->
’abË
 =ƒnable;

1044 
	}
}

1064 
	$·r£_£qu’û
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1065 
li¡_h—d
 *
ba£
,

1066 
¢d_cÚfig_t
 *
cfg
)

1068 
£qu’û_–em’t
 *
cu¼
;

1069 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1070 
¢d_cÚfig_t
 *
n
;

1071 
”r
, 
idx
 = 0;

1072 cÚ¡ *
cmd
 = 
NULL
;

1074 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1075 
	`uc_”rÜ
("error: compound isƒxpected for sequence definition");

1076  -
EINVAL
;

1079 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1080 cÚ¡ *
id
;

1081 
idx
 ^= 1;

1082 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1083 
”r
 = 
	`¢d_cÚfig_g‘_id
(
n
, &
id
);

1084 ià(
”r
 < 0)

1086 ià(
idx
 == 1) {

1087 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_STRING
) {

1088 
	`uc_”rÜ
("error: stringype isƒxpected for sequence command");

1089  -
EINVAL
;

1091 
	`¢d_cÚfig_g‘_¡ršg
(
n
, &
cmd
);

1096 
cu¼
 = 
	`ÿÎoc
(1, (
£qu’û_–em’t
));

1097 ià(
cu¼
 =ğ
NULL
)

1098  -
ENOMEM
;

1099 
	`li¡_add_
(&
cu¼
->
li¡
, 
ba£
);

1101 ià(
	`¡rcmp
(
cmd
, "cdev") == 0) {

1102 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_CDEV
;

1103 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &
cu¼
->
d©a
.
cdev
);

1104 ià(
”r
 < 0) {

1105 
	`uc_”rÜ
("error: cdev„equires‡ string!");

1106  
”r
;

1111 ià(
	`¡rcmp
(
cmd
, "cset") == 0) {

1112 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_CSET
;

1113 
c£t
:

1114 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &
cu¼
->
d©a
.
c£t
);

1115 ià(
”r
 < 0) {

1116 
	`uc_”rÜ
("”rÜ: % »quœe ¨¡ršg!", 
cmd
);

1117  
”r
;

1122 ià(
	`¡rcmp
(
cmd
, "enadev") == 0 ||

1123 
	`¡rcmp
(
cmd
, "disdev") == 0) {

1125 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_CMPT_SEQ
;

1126 
”r
 = 
	`·r£_compÚ’t_£q
(
uc_mgr
, 
n
,

1127 
	`¡rcmp
(
cmd
, "enadev") == 0,

1128 &
cu¼
->
d©a
.
cm±_£q
);

1129 ià(
”r
 < 0) {

1130 
	`uc_”rÜ
("”rÜ: % »quœe ¨v®id deviû!", 
cmd
);

1131  
”r
;

1136 ià(
	`¡rcmp
(
cmd
, "enadev2") == 0) {

1137 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_DEV_ENABLE_SEQ
;

1138 
deviû
;

1141 ià(
	`¡rcmp
(
cmd
, "disdev2") == 0) {

1142 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_DEV_DISABLE_SEQ
;

1143 
deviû
:

1144 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &
cu¼
->
d©a
.
deviû
);

1145 ià(
”r
 < 0) {

1146 
	`uc_”rÜ
("”rÜ: % »quœe ¨v®id deviû!", 
cmd
);

1147  
”r
;

1152 ià(
	`¡rcmp
(
cmd
, "disdevall") == 0) {

1153 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_DEV_DISABLE_ALL
;

1157 ià(
	`¡rcmp
(
cmd
, "cset-bin-file") == 0) {

1158 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_CSET_BIN_FILE
;

1159 
c£t
;

1162 ià(
	`¡rcmp
(
cmd
, "cset-tlv") == 0) {

1163 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_CSET_TLV
;

1164 
c£t
;

1167 ià(
	`¡rcmp
(
cmd
, "cset-new") == 0) {

1168 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_CSET_NEW
;

1169 
c£t
;

1172 ià(
	`¡rcmp
(
cmd
, "ctl-remove") == 0) {

1173 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
;

1174 
c£t
;

1177 ià(
	`¡rcmp
(
cmd
, "sysw") == 0) {

1178 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_SYSSET
;

1179 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &
cu¼
->
d©a
.
sysw
);

1180 ià(
”r
 < 0) {

1181 
	`uc_”rÜ
("error: sysw„equires‡ string!");

1182  
”r
;

1187 ià(
	`¡rcmp
(
cmd
, "usleep") == 0) {

1188 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_SLEEP
;

1189 
”r
 = 
	`·r£_š‹g”_sub¡™u‹3
(
uc_mgr
, 
n
, &
cu¼
->
d©a
.
¦“p
);

1190 ià(
”r
 < 0) {

1191 
	`uc_”rÜ
("error: usleep„equires integer!");

1192  
”r
;

1197 ià(
	`¡rcmp
(
cmd
, "msleep") == 0) {

1198 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_SLEEP
;

1199 
”r
 = 
	`·r£_š‹g”_sub¡™u‹3
(
uc_mgr
, 
n
, &
cu¼
->
d©a
.
¦“p
);

1200 ià(
”r
 < 0) {

1201 
	`uc_”rÜ
("error: msleep„equires integer!");

1202  
”r
;

1204 
cu¼
->
d©a
.
¦“p
 *= 1000L;

1208 ià(
	`¡rcmp
(
cmd
, "exec") == 0) {

1209 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_EXEC
;

1210 
exec
:

1211 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &
cu¼
->
d©a
.
exec
);

1212 ià(
”r
 < 0) {

1213 
	`uc_”rÜ
("error:ƒxec„equires‡ string!");

1214  
”r
;

1219 ià(
	`¡rcmp
(
cmd
, "shell") == 0) {

1220 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_SHELL
;

1221 
exec
;

1224 ià(
	`¡rcmp
(
cmd
, "cfg-save") == 0) {

1225 
cu¼
->
ty³
 = 
SEQUENCE_ELEMENT_TYPE_CFGSAVE
;

1226 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &
cu¼
->
d©a
.
cfg§ve
);

1227 ià(
”r
 < 0) {

1228 
	`uc_”rÜ
("error: sysw„equires‡ string!");

1229  
”r
;

1234 ià(
	`¡rcmp
(
cmd
, "comment") == 0)

1235 
sk
;

1237 
	`uc_”rÜ
("”rÜ: sequ’û commªd '%s' i ignÜed", 
cmd
);

1239 
sk
:

1240 
	`li¡_d–
(&
cu¼
->
li¡
);

1241 
	`uc_mgr_ä“_£qu’û_–em’t
(
cu¼
);

1245 
	}
}

1250 
	$uc_mgr_add_v®ue
(
li¡_h—d
 *
ba£
, cÚ¡ *
key
, *
v®
)

1252 
ucm_v®ue
 *
cu¼
;

1254 
cu¼
 = 
	`ÿÎoc
(1, (
ucm_v®ue
));

1255 ià(
cu¼
 =ğ
NULL
)

1256  -
ENOMEM
;

1257 
cu¼
->
Çme
 = 
	`¡rdup
(
key
);

1258 ià(
cu¼
->
Çme
 =ğ
NULL
) {

1259 
	`ä“
(
cu¼
);

1260  -
ENOMEM
;

1262 
	`li¡_add_
(&
cu¼
->
li¡
, 
ba£
);

1263 
cu¼
->
d©a
 = 
v®
;

1265 
	}
}

1279 
	$·r£_v®ue
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
 
ATTRIBUTE_UNUSED
,

1280 
li¡_h—d
 *
ba£
,

1281 
¢d_cÚfig_t
 *
cfg
)

1283 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1284 
¢d_cÚfig_t
 *
n
;

1285 *
s
;

1286 
¢d_cÚfig_ty³_t
 
ty³
;

1287 
”r
;

1289 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1290 
	`uc_”rÜ
("error: compound isƒxpected for value definition");

1291  -
EINVAL
;

1295 
”r
 = 
	`uc_mgr_ev®u©e_š¶aû
(
uc_mgr
, 
cfg
);

1296 ià(
”r
 < 0)

1297  
”r
;

1299 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1300 cÚ¡ *
id
;

1301 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1302 
”r
 = 
	`¢d_cÚfig_g‘_id
(
n
, &
id
);

1303 ià(
”r
 < 0)

1306 
ty³
 = 
	`¢d_cÚfig_g‘_ty³
(
n
);

1307 
ty³
) {

1308 
SND_CONFIG_TYPE_INTEGER
:

1309 
SND_CONFIG_TYPE_INTEGER64
:

1310 
SND_CONFIG_TYPE_REAL
:

1311 
”r
 = 
	`¢d_cÚfig_g‘_ascii
(
n
, &
s
);

1312 ià(
”r
 < 0) {

1313 
	`uc_”rÜ
("”rÜ: uÇbËØ·r£ v®ufÜ id '%s': %s!", 
id
, 
	`¢d_¡»¼Ü
(
”r
));

1314  
”r
;

1317 
SND_CONFIG_TYPE_STRING
:

1318 
”r
 = 
	`·r£_¡ršg_sub¡™u‹
(
uc_mgr
, 
n
, &
s
);

1319 ià(
”r
 < 0) {

1320 
	`uc_”rÜ
("”rÜ: uÇbËØ·r£‡ sŒšg fÜ id '%s'!", 
id
);

1321  
”r
;

1325 
	`uc_”rÜ
("”rÜ: inv®idy³ %˜š V®ucompound '%s'", 
ty³
, 
id
);

1326  -
EINVAL
;

1328 
”r
 = 
	`uc_mgr_add_v®ue
(
ba£
, 
id
, 
s
);

1329 ià(
”r
 < 0) {

1330 
	`ä“
(
s
);

1331  
”r
;

1336 
	}
}

1380 
	$·r£_modif›r
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1381 
¢d_cÚfig_t
 *
cfg
,

1382 *
d©a1
, *
d©a2
)

1384 
u£_ÿ£_v”b
 *
v”b
 = 
d©a1
;

1385 
u£_ÿ£_modif›r
 *
modif›r
;

1386 *
Çme
;

1387 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1388 
¢d_cÚfig_t
 *
n
;

1389 
”r
;

1391 ià(
	`·r£_g‘_§ã_Çme
(
uc_mgr
, 
cfg
, 
d©a2
, &
Çme
) < 0)

1392  -
EINVAL
;

1395 
modif›r
 = 
	`ÿÎoc
(1, (*modifier));

1396 ià(
modif›r
 =ğ
NULL
) {

1397 
	`ä“
(
Çme
);

1398  -
ENOMEM
;

1400 
	`INIT_LIST_HEAD
(&
modif›r
->
’abË_li¡
);

1401 
	`INIT_LIST_HEAD
(&
modif›r
->
di§bË_li¡
);

1402 
	`INIT_LIST_HEAD
(&
modif›r
->
Œªs™iÚ_li¡
);

1403 
	`INIT_LIST_HEAD
(&
modif›r
->
dev_li¡
.
li¡
);

1404 
	`INIT_LIST_HEAD
(&
modif›r
->
v®ue_li¡
);

1405 
	`li¡_add_
(&
modif›r
->
li¡
, &
v”b
->
modif›r_li¡
);

1406 
modif›r
->
Çme
 =‚ame;

1409 
”r
 = 
	`uc_mgr_ev®u©e_š¶aû
(
uc_mgr
, 
cfg
);

1410 ià(
”r
 < 0)

1411  
”r
;

1413 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1414 cÚ¡ *
id
;

1415 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1416 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1419 ià(
	`¡rcmp
(
id
, "Comment") == 0) {

1420 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &
modif›r
->
comm’t
);

1421 ià(
”r
 < 0) {

1422 
	`uc_”rÜ
("error: failedo get modifier comment");

1423  
”r
;

1428 ià(
	`¡rcmp
(
id
, "SupportedDevice") == 0) {

1429 
”r
 = 
	`·r£_deviû_li¡
(
uc_mgr
, &
modif›r
->
dev_li¡
,

1430 
DEVLIST_SUPPORTED
, 
n
);

1431 ià(
”r
 < 0) {

1432 
	`uc_”rÜ
("error: failedo…arse supported"

1434  
”r
;

1438 ià(
	`¡rcmp
(
id
, "ConflictingDevice") == 0) {

1439 
”r
 = 
	`·r£_deviû_li¡
(
uc_mgr
, &
modif›r
->
dev_li¡
,

1440 
DEVLIST_CONFLICTING
, 
n
);

1441 ià(
”r
 < 0) {

1442 
	`uc_”rÜ
("error: failedo…arse conflicting"

1444  
”r
;

1448 ià(
	`¡rcmp
(
id
, "EnableSequence") == 0) {

1449 
”r
 = 
	`·r£_£qu’û
(
uc_mgr
, &
modif›r
->
’abË_li¡
, 
n
);

1450 ià(
”r
 < 0) {

1451 
	`uc_”rÜ
("error: failedo…arse modifier"

1453  
”r
;

1458 ià(
	`¡rcmp
(
id
, "DisableSequence") == 0) {

1459 
”r
 = 
	`·r£_£qu’û
(
uc_mgr
, &
modif›r
->
di§bË_li¡
, 
n
);

1460 ià(
”r
 < 0) {

1461 
	`uc_”rÜ
("error: failedo…arse modifier"

1463  
”r
;

1468 ià(
	`¡rcmp
(
id
, "TransitionSequence") == 0) {

1469 
”r
 = 
	`·r£_Œªs™iÚ
(
uc_mgr
, &
modif›r
->
Œªs™iÚ_li¡
, 
n
);

1470 ià(
”r
 < 0) {

1471 
	`uc_”rÜ
("error: failedo…arseransition"

1473  
”r
;

1478 ià(
	`¡rcmp
(
id
, "Value") == 0) {

1479 
”r
 = 
	`·r£_v®ue
(
uc_mgr
, &
modif›r
->
v®ue_li¡
, 
n
);

1480 ià(
”r
 < 0) {

1481 
	`uc_”rÜ
("error: failedo…arse Value");

1482  
”r
;

1489 
	}
}

1526 
	$·r£_deviû
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1527 
¢d_cÚfig_t
 *
cfg
,

1528 *
d©a1
, *
d©a2
)

1530 
u£_ÿ£_v”b
 *
v”b
 = 
d©a1
;

1531 *
Çme
;

1532 
u£_ÿ£_deviû
 *
deviû
;

1533 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1534 
¢d_cÚfig_t
 *
n
;

1535 
”r
;

1537 ià(
	`·r£_g‘_§ã_Çme
(
uc_mgr
, 
cfg
, 
d©a2
, &
Çme
) < 0)

1538  -
EINVAL
;

1540 
deviû
 = 
	`ÿÎoc
(1, (*device));

1541 ià(
deviû
 =ğ
NULL
) {

1542 
	`ä“
(
Çme
);

1543  -
ENOMEM
;

1545 
	`INIT_LIST_HEAD
(&
deviû
->
’abË_li¡
);

1546 
	`INIT_LIST_HEAD
(&
deviû
->
di§bË_li¡
);

1547 
	`INIT_LIST_HEAD
(&
deviû
->
Œªs™iÚ_li¡
);

1548 
	`INIT_LIST_HEAD
(&
deviû
->
dev_li¡
.
li¡
);

1549 
	`INIT_LIST_HEAD
(&
deviû
->
v®ue_li¡
);

1550 
	`li¡_add_
(&
deviû
->
li¡
, &
v”b
->
deviû_li¡
);

1551 
deviû
->
Çme
 =‚ame;

1554 
”r
 = 
	`uc_mgr_ev®u©e_š¶aû
(
uc_mgr
, 
cfg
);

1555 ià(
”r
 < 0)

1556  
”r
;

1558 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1559 cÚ¡ *
id
;

1560 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1561 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1564 ià(
	`¡rcmp
(
id
, "Comment") == 0) {

1565 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &
deviû
->
comm’t
);

1566 ià(
”r
 < 0) {

1567 
	`uc_”rÜ
("error: failedo get device comment");

1568  
”r
;

1573 ià(
	`¡rcmp
(
id
, "SupportedDevice") == 0) {

1574 
”r
 = 
	`·r£_deviû_li¡
(
uc_mgr
, &
deviû
->
dev_li¡
,

1575 
DEVLIST_SUPPORTED
, 
n
);

1576 ià(
”r
 < 0) {

1577 
	`uc_”rÜ
("error: failedo…arse supported"

1579  
”r
;

1583 ià(
	`¡rcmp
(
id
, "ConflictingDevice") == 0) {

1584 
”r
 = 
	`·r£_deviû_li¡
(
uc_mgr
, &
deviû
->
dev_li¡
,

1585 
DEVLIST_CONFLICTING
, 
n
);

1586 ià(
”r
 < 0) {

1587 
	`uc_”rÜ
("error: failedo…arse conflicting"

1589  
”r
;

1593 ià(
	`¡rcmp
(
id
, "EnableSequence") == 0) {

1594 
	`uc_dbg
("EnableSequence");

1595 
”r
 = 
	`·r£_£qu’û
(
uc_mgr
, &
deviû
->
’abË_li¡
, 
n
);

1596 ià(
”r
 < 0) {

1597 
	`uc_”rÜ
("error: failedo…arse deviceƒnable"

1599  
”r
;

1604 ià(
	`¡rcmp
(
id
, "DisableSequence") == 0) {

1605 
	`uc_dbg
("DisableSequence");

1606 
”r
 = 
	`·r£_£qu’û
(
uc_mgr
, &
deviû
->
di§bË_li¡
, 
n
);

1607 ià(
”r
 < 0) {

1608 
	`uc_”rÜ
("error: failedo…arse device disable"

1610  
”r
;

1615 ià(
	`¡rcmp
(
id
, "TransitionSequence") == 0) {

1616 
	`uc_dbg
("TransitionSequence");

1617 
”r
 = 
	`·r£_Œªs™iÚ
(
uc_mgr
, &
deviû
->
Œªs™iÚ_li¡
, 
n
);

1618 ià(
”r
 < 0) {

1619 
	`uc_”rÜ
("error: failedo…arseransition"

1621  
”r
;

1626 ià(
	`¡rcmp
(
id
, "Value") == 0) {

1627 
”r
 = 
	`·r£_v®ue
(
uc_mgr
, &
deviû
->
v®ue_li¡
, 
n
);

1628 ià(
”r
 < 0) {

1629 
	`uc_”rÜ
("error: failedo…arse Value");

1630  
”r
;

1636 
	}
}

1647 
	$·r£_dev_Çme_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1648 
¢d_cÚfig_t
 *
cfg
,

1649 
li¡_h—d
 *
li¡
)

1651 
¢d_cÚfig_t
 *
n
;

1652 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1653 cÚ¡ *
id
, *
Çme1
;

1654 *
Çme1s
, *
Çme2
;

1655 
ucm_dev_Çme
 *
dev
;

1656 
¢d_cÚfig_™”©Ü_t
 
pos
;

1657 
”r
;

1659 ià(
	`¢d_cÚfig_g‘_id
(
cfg
, &
id
) < 0)

1660  -
EINVAL
;

1662 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1663 
	`uc_”rÜ
("compoundy³ƒx³ùed fÜ %s", 
id
);

1664  -
EINVAL
;

1667 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1668 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1670 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
Çme1
) < 0)

1671  -
EINVAL
;

1673 
”r
 = 
	`g‘_¡ršg3
(
uc_mgr
, 
Çme1
, &
Çme1s
);

1674 ià(
”r
 < 0)

1675  
”r
;

1677 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &
Çme2
);

1678 ià(
”r
 < 0) {

1679 
	`ä“
(
Çme1s
);

1680 
	`uc_”rÜ
("”rÜ: faedØg‘¬g‘ deviû‚amfÜ '%s'", 
Çme1
);

1681  
”r
;

1685 
	`li¡_fÜ_—ch
(
pos
, 
li¡
) {

1686 
dev
 = 
	`li¡_’Œy
(
pos
, 
ucm_dev_Çme
, 
li¡
);

1687 ià(
	`¡rcmp
(
dev
->
Çme1
, 
Çme1s
) == 0) {

1688 
	`ä“
(
Çme2
);

1689 
	`ä“
(
Çme1s
);

1694 
	`ä“
(
Çme1s
);

1696 
dev
 = 
	`ÿÎoc
(1, (*dev));

1697 ià(
dev
 =ğ
NULL
) {

1698 
	`ä“
(
Çme2
);

1699  -
ENOMEM
;

1701 
dev
->
Çme1
 = 
	`¡rdup
(name1);

1702 ià(
dev
->
Çme1
 =ğ
NULL
) {

1703 
	`ä“
(
dev
);

1704 
	`ä“
(
Çme2
);

1705  -
ENOMEM
;

1707 
dev
->
Çme2
 =‚ame2;

1708 
	`li¡_add_
(&
dev
->
li¡
,†ist);

1712 
	}
}

1714 
·r£_compound_check_Ëgacy
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1715 
¢d_cÚfig_t
 *
cfg
,

1716 (*
fú
)(
¢d_u£_ÿ£_mgr_t
 *, 
¢d_cÚfig_t
 *, *, *),

1717 *
d©a1
)

1719 cÚ¡ *
id
, *
idchd
;

1720 
chd_ùr
 = 0, 
Ëgacy_fÜm©
 = 1;

1721 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1722 
¢d_cÚfig_t
 *
chd
;

1723 
”r
;

1725 
”r
 = 
	`¢d_cÚfig_g‘_id
(
cfg
, &
id
);

1726 ià(
”r
 < 0)

1727  
”r
;

1729 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1730 
chd_ùr
++;

1731 ià(
chd_ùr
 > 1) {

1735 
chd
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1737 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

1738 
Ëgacy_fÜm©
 = 0;

1742 ià(
	`¢d_cÚfig_g‘_id
(
chd
, &
idchd
) < 0)

1743  -
EINVAL
;

1745 ià(
	`¡rcmp
(
idchd
, "0")) {

1746 
Ëgacy_fÜm©
 = 0;

1750 ià(
chd_ùr
 != 1) {

1751 
Ëgacy_fÜm©
 = 0;

1754 ià(
Ëgacy_fÜm©
)

1755  
	`·r£_compound
(
uc_mgr
, 
cfg
, 
fú
, 
d©a1
, (*)
id
);

1757  
	`fú
(
uc_mgr
, 
cfg
, 
d©a1
, 
NULL
);

1758 
	}
}

1760 
	$·r£_deviû_Çme
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1761 
¢d_cÚfig_t
 *
cfg
,

1762 *
d©a1
,

1763 *
d©a2
 
ATTRIBUTE_UNUSED
)

1765  
	`·r£_compound_check_Ëgacy
(
uc_mgr
, 
cfg
, 
·r£_deviû
, 
d©a1
);

1766 
	}
}

1768 
	$·r£_modif›r_Çme
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1769 
¢d_cÚfig_t
 *
cfg
,

1770 *
d©a1
,

1771 *
d©a2
 
ATTRIBUTE_UNUSED
)

1773  
	`·r£_compound_check_Ëgacy
(
uc_mgr
, 
cfg
, 
·r£_modif›r
, 
d©a1
);

1774 
	}
}

1776 
	$v”b_dev_li¡_add
(
u£_ÿ£_v”b
 *
v”b
,

1777 
dev_li¡_ty³
 
d¡_ty³
,

1778 cÚ¡ *
d¡
,

1779 cÚ¡ *
¤c
)

1781 
u£_ÿ£_deviû
 *
deviû
;

1782 
li¡_h—d
 *
pos
;

1784 
	`li¡_fÜ_—ch
(
pos
, &
v”b
->
deviû_li¡
) {

1785 
deviû
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_deviû
, 
li¡
);

1786 ià(
	`¡rcmp
(
deviû
->
Çme
, 
d¡
) != 0)

1788 ià(
deviû
->
dev_li¡
.
ty³
 !ğ
d¡_ty³
) {

1789 ià(
	`li¡_em±y
(&
deviû
->
dev_li¡
.
li¡
)) {

1790 
deviû
->
dev_li¡
.
ty³
 = 
d¡_ty³
;

1792 
	`uc_”rÜ
("error: incompatible device†istype ('%s', '%s')",

1793 
deviû
->
Çme
, 
¤c
);

1794  -
EINVAL
;

1797  
	`uc_mgr_put_to_dev_li¡
(&
deviû
->
dev_li¡
, 
¤c
);

1799 
	`uc_”rÜ
("”rÜ: uÇbËØfšd deviû '%s'", 
d¡
);

1800  -
ENOENT
;

1801 
	}
}

1803 
	$v”b_dev_li¡_check
(
u£_ÿ£_v”b
 *
v”b
)

1805 
li¡_h—d
 *
pos
, *
pos2
;

1806 
u£_ÿ£_deviû
 *
deviû
;

1807 
dev_li¡_node
 *
dli¡
;

1808 
”r
;

1810 
	`li¡_fÜ_—ch
(
pos
, &
v”b
->
deviû_li¡
) {

1811 
deviû
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_deviû
, 
li¡
);

1812 
	`li¡_fÜ_—ch
(
pos2
, &
deviû
->
dev_li¡
.
li¡
) {

1813 
dli¡
 = 
	`li¡_’Œy
(
pos2
, 
dev_li¡_node
, 
li¡
);

1814 
”r
 = 
	`v”b_dev_li¡_add
(
v”b
, 
deviû
->
dev_li¡
.
ty³
,

1815 
dli¡
->
Çme
, 
deviû
->name);

1816 ià(
”r
 < 0)

1817  
”r
;

1821 
	}
}

1823 
	$v”b_deviû_mªagem’t
(
u£_ÿ£_v”b
 *
v”b
)

1825 
li¡_h—d
 *
pos
;

1826 
ucm_dev_Çme
 *
dev
;

1827 
”r
;

1830 
	`li¡_fÜ_—ch
(
pos
, &
v”b
->
»Çme_li¡
) {

1831 
dev
 = 
	`li¡_’Œy
(
pos
, 
ucm_dev_Çme
, 
li¡
);

1832 
”r
 = 
	`uc_mgr_»Çme_deviû
(
v”b
, 
dev
->
Çme1
, dev->
Çme2
);

1833 ià(
”r
 < 0) {

1834 
	`uc_”rÜ
("”rÜ: cªnÙ„’amdeviû '%s'Ø'%s'", 
dev
->
Çme1
, dev->
Çme2
);

1835  
”r
;

1840 
	`li¡_fÜ_—ch
(
pos
, &
v”b
->
»move_li¡
) {

1841 
dev
 = 
	`li¡_’Œy
(
pos
, 
ucm_dev_Çme
, 
li¡
);

1842 
”r
 = 
	`uc_mgr_»move_deviû
(
v”b
, 
dev
->
Çme2
);

1843 ià(
”r
 < 0) {

1844 
	`uc_”rÜ
("”rÜ: cªnÙ„emovdeviû '%s'", 
dev
->
Çme2
);

1845  
”r
;

1850 
	`uc_mgr_ä“_dev_Çme_li¡
(&
v”b
->
»Çme_li¡
);

1851 
	`uc_mgr_ä“_dev_Çme_li¡
(&
v”b
->
»move_li¡
);

1854  
	`v”b_dev_li¡_check
(
v”b
);

1855 
	}
}

1894 
	$·r£_v”b
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1895 
u£_ÿ£_v”b
 *
v”b
,

1896 
¢d_cÚfig_t
 *
cfg
)

1898 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1899 
¢d_cÚfig_t
 *
n
;

1900 
”r
;

1903 
”r
 = 
	`uc_mgr_ev®u©e_š¶aû
(
uc_mgr
, 
cfg
);

1904 ià(
”r
 < 0)

1905  
”r
;

1908 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

1909 cÚ¡ *
id
;

1910 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

1911 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

1914 ià(
	`¡rcmp
(
id
, "EnableSequence") == 0) {

1915 
	`uc_dbg
("Parse EnableSequence");

1916 
”r
 = 
	`·r£_£qu’û
(
uc_mgr
, &
v”b
->
’abË_li¡
, 
n
);

1917 ià(
”r
 < 0) {

1918 
	`uc_”rÜ
("error: failedo…arse verbƒnable sequence");

1919  
”r
;

1924 ià(
	`¡rcmp
(
id
, "DisableSequence") == 0) {

1925 
	`uc_dbg
("Parse DisableSequence");

1926 
”r
 = 
	`·r£_£qu’û
(
uc_mgr
, &
v”b
->
di§bË_li¡
, 
n
);

1927 ià(
”r
 < 0) {

1928 
	`uc_”rÜ
("error: failedo…arse verb disable sequence");

1929  
”r
;

1934 ià(
	`¡rcmp
(
id
, "TransitionSequence") == 0) {

1935 
	`uc_dbg
("Parse TransitionSequence");

1936 
”r
 = 
	`·r£_Œªs™iÚ
(
uc_mgr
, &
v”b
->
Œªs™iÚ_li¡
, 
n
);

1937 ià(
”r
 < 0) {

1938 
	`uc_”rÜ
("error: failedo…arseransition sequence");

1939  
”r
;

1944 ià(
	`¡rcmp
(
id
, "Value") == 0) {

1945 
	`uc_dbg
("Parse Value");

1946 
”r
 = 
	`·r£_v®ue
(
uc_mgr
, &
v”b
->
v®ue_li¡
, 
n
);

1947 ià(
”r
 < 0)

1948  
”r
;

1954 
	}
}

1967 
	$·r£_v”b_fe
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

1968 cÚ¡ *
u£_ÿ£_Çme
,

1969 cÚ¡ *
comm’t
,

1970 cÚ¡ *
fe
)

1972 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

1973 
¢d_cÚfig_t
 *
n
;

1974 
u£_ÿ£_v”b
 *
v”b
;

1975 
¢d_cÚfig_t
 *
cfg
;

1976 
”r
;

1979 
v”b
 = 
	`ÿÎoc
(1, (
u£_ÿ£_v”b
));

1980 ià(
v”b
 =ğ
NULL
)

1981  -
ENOMEM
;

1982 
	`INIT_LIST_HEAD
(&
v”b
->
’abË_li¡
);

1983 
	`INIT_LIST_HEAD
(&
v”b
->
di§bË_li¡
);

1984 
	`INIT_LIST_HEAD
(&
v”b
->
Œªs™iÚ_li¡
);

1985 
	`INIT_LIST_HEAD
(&
v”b
->
deviû_li¡
);

1986 
	`INIT_LIST_HEAD
(&
v”b
->
cm±_deviû_li¡
);

1987 
	`INIT_LIST_HEAD
(&
v”b
->
modif›r_li¡
);

1988 
	`INIT_LIST_HEAD
(&
v”b
->
v®ue_li¡
);

1989 
	`INIT_LIST_HEAD
(&
v”b
->
»Çme_li¡
);

1990 
	`INIT_LIST_HEAD
(&
v”b
->
»move_li¡
);

1991 
	`li¡_add_
(&
v”b
->
li¡
, &
uc_mgr
->
v”b_li¡
);

1992 ià(
u£_ÿ£_Çme
 =ğ
NULL
)

1993  -
EINVAL
;

1994 
v”b
->
Çme
 = 
	`¡rdup
(
u£_ÿ£_Çme
);

1995 ià(
v”b
->
Çme
 =ğ
NULL
)

1996  -
ENOMEM
;

1998 ià(
comm’t
 !ğ
NULL
) {

1999 
v”b
->
comm’t
 = 
	`¡rdup
(comment);

2000 ià(
v”b
->
comm’t
 =ğ
NULL
)

2001  -
ENOMEM
;

2005 
”r
 = 
	`uc_mgr_cÚfig_lßd_fe
(
uc_mgr
, 
fe
, &
cfg
);

2006 ià(
”r
 < 0)

2007  
”r
;

2010 
”r
 = 
	`uc_mgr_ev®u©e_š¶aû
(
uc_mgr
, 
cfg
);

2011 ià(
”r
 < 0)

2012 
_”r
;

2015 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

2016 cÚ¡ *
id
;

2017 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

2018 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

2022 ià(
	`¡rcmp
(
id
, "SectionVerb") == 0) {

2023 
”r
 = 
	`·r£_v”b
(
uc_mgr
, 
v”b
, 
n
);

2024 ià(
”r
 < 0) {

2025 
	`uc_”rÜ
("error: %s failedo…arse verb",

2026 
fe
);

2027 
_”r
;

2033 ià(
	`¡rcmp
(
id
, "SectionDevice") == 0) {

2034 
”r
 = 
	`·r£_compound
(
uc_mgr
, 
n
,

2035 
·r£_deviû_Çme
, 
v”b
, 
NULL
);

2036 ià(
”r
 < 0) {

2037 
	`uc_”rÜ
("error: %s failedo…arse device",

2038 
fe
);

2039 
_”r
;

2045 ià(
	`¡rcmp
(
id
, "SectionModifier") == 0) {

2046 
”r
 = 
	`·r£_compound
(
uc_mgr
, 
n
,

2047 
·r£_modif›r_Çme
, 
v”b
, 
NULL
);

2048 ià(
”r
 < 0) {

2049 
	`uc_”rÜ
("error: %s failedo…arse modifier",

2050 
fe
);

2051 
_”r
;

2057 ià(
	`¡rcmp
(
id
, "RenameDevice") == 0) {

2058 
”r
 = 
	`·r£_dev_Çme_li¡
(
uc_mgr
, 
n
, &
v”b
->
»Çme_li¡
);

2059 ià(
”r
 < 0) {

2060 
	`uc_”rÜ
("error: %s failedo…arse device„ename",

2061 
fe
);

2062 
_”r
;

2068 ià(
	`¡rcmp
(
id
, "RemoveDevice") == 0) {

2069 
”r
 = 
	`·r£_dev_Çme_li¡
(
uc_mgr
, 
n
, &
v”b
->
»move_li¡
);

2070 ià(
”r
 < 0) {

2071 
	`uc_”rÜ
("error: %s failedo…arse device„emove",

2072 
fe
);

2073 
_”r
;

2079 ià(
uc_mgr
->
cÚf_fÜm©
 > 3 && 
	`¡rcmp
(
id
, "LibraryConfig") == 0) {

2080 
”r
 = 
	`·r£_libcÚfig
(
uc_mgr
, 
n
);

2081 ià(
”r
 < 0) {

2082 
	`uc_”rÜ
("error: failedo…arse LibConfig");

2083 
_”r
;

2089 
	`¢d_cÚfig_d–‘e
(
cfg
);

2092 ià(
	`li¡_em±y
(&
v”b
->
deviû_li¡
)) {

2093 
	`uc_”rÜ
("”rÜ:‚Øu£ ca£ deviû defšed", 
fe
);

2094  -
EINVAL
;

2098 
”r
 = 
	`v”b_deviû_mªagem’t
(
v”b
);

2099 ià(
”r
 < 0) {

2100 
	`uc_”rÜ
("”rÜ: deviû mªagem’ˆ”rÜ iÀv”b '%s'", 
v”b
->
Çme
);

2101  
”r
;

2106 
_”r
:

2107 
	`¢d_cÚfig_d–‘e
(
cfg
);

2108  
”r
;

2109 
	}
}

2114 
	$·r£_v¬ŸÁ
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
cfg
,

2115 **
_vfe
, **
_vcomm’t
)

2117 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

2118 
¢d_cÚfig_t
 *
n
;

2119 *
fe
 = 
NULL
, *
comm’t
 = NULL;

2120 
”r
;

2123 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

2124 cÚ¡ *
id
;

2125 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

2126 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

2130 ià(
	`¡rcmp
(
id
, "File") == 0) {

2131 ià(
_vfe
) {

2132 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &
fe
);

2133 ià(
”r
 < 0) {

2134 
	`uc_”rÜ
("failedo get File");

2135 
__”rÜ
;

2142 ià(
	`¡ºcmp
(
id
, "Comment", 7) == 0) {

2143 ià(
_vcomm’t
) {

2144 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &
comm’t
);

2145 ià(
”r
 < 0) {

2146 
	`uc_”rÜ
("error: failedo get Comment");

2147 
__”rÜ
;

2153 
	`uc_”rÜ
("unknowÀf›ld '%s' iÀV¬ŸÁ seùiÚ", 
id
);

2154 
”r
 = -
EINVAL
;

2155 
__”rÜ
;

2158 ià(
_vfe
)

2159 *
_vfe
 = 
fe
;

2160 ià(
_vcomm’t
)

2161 *
_vcomm’t
 = 
comm’t
;

2164 
__”rÜ
:

2165 
	`ä“
(
fe
);

2166 
	`ä“
(
comm’t
);

2167  
”r
;

2168 
	}
}

2173 
	$·r£_ma¡”_£ùiÚ
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
cfg
,

2174 *
d©a1
 
ATTRIBUTE_UNUSED
,

2175 *
d©a2
 
ATTRIBUTE_UNUSED
)

2177 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

2178 
¢d_cÚfig_t
 *
n
, *
v¬ŸÁ
 = 
NULL
;

2179 *
u£_ÿ£_Çme
, *
fe
 = 
NULL
, *
comm’t
 = NULL;

2180 
boŞ
 
v¬ŸÁ_ok
 = 
çl£
;

2181 
”r
;

2183 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

2184 
	`uc_”rÜ
("compoundypeƒxpected for use case section");

2185  -
EINVAL
;

2188 
”r
 = 
	`·r£_g‘_§ã_Çme
(
uc_mgr
, 
cfg
, 
NULL
, &
u£_ÿ£_Çme
);

2189 ià(
”r
 < 0) {

2190 
	`uc_”rÜ
("unableo get‚ame for use case section");

2191  
”r
;

2195 
uc_mgr
->
·r£_ma¡”_£ùiÚ
 = 1;

2196 
”r
 = 
	`uc_mgr_ev®u©e_š¶aû
(
uc_mgr
, 
cfg
);

2197 
uc_mgr
->
·r£_ma¡”_£ùiÚ
 = 0;

2198 ià(
”r
 < 0)

2199 
__”rÜ
;

2202 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

2203 cÚ¡ *
id
;

2204 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

2205 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

2209 ià(
	`¡rcmp
(
id
, "File") == 0) {

2210 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &
fe
);

2211 ià(
”r
 < 0) {

2212 
	`uc_”rÜ
("failedo get File");

2213 
__”rÜ
;

2219 ià(
	`¡ºcmp
(
id
, "Comment", 7) == 0) {

2220 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &
comm’t
);

2221 ià(
”r
 < 0) {

2222 
	`uc_”rÜ
("error: failedo get Comment");

2223 
__”rÜ
;

2228 ià(
uc_mgr
->
cÚf_fÜm©
 >ğ6 && 
	`¡rcmp
(
id
, "Variant") == 0) {

2229 
¢d_cÚfig_™”©Ü_t
 
i2
, 
Ãxt2
;

2230 
v¬ŸÁ
 = 
n
;

2231 
	`¢d_cÚfig_fÜ_—ch
(
i2
, 
Ãxt2
, 
n
) {

2232 cÚ¡ *
id2
;

2233 
¢d_cÚfig_t
 *
n2
;

2234 
n2
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i2
);

2235 ià(
	`¢d_cÚfig_g‘_id
(
n2
, &
id2
) < 0)

2237 
”r
 = 
	`uc_mgr_ev®u©e_š¶aû
(
uc_mgr
, 
n2
);

2238 ià(
”r
 < 0)

2239 
__”rÜ
;

2240 ià(
	`¡rcmp
(
u£_ÿ£_Çme
, 
id2
) == 0)

2241 
v¬ŸÁ_ok
 = 
Œue
;

2246 
	`uc_”rÜ
("unknowÀf›ld '%s' iÀSeùiÚU£Ca£", 
id
);

2249 ià(
v¬ŸÁ
 && !
v¬ŸÁ_ok
) {

2250 
	`uc_”rÜ
("”rÜ: undefšed v¬ŸÁ '%s'", 
u£_ÿ£_Çme
);

2251 
”r
 = -
EINVAL
;

2252 
__”rÜ
;

2255 ià(!
v¬ŸÁ
) {

2256 
	`uc_dbg
("u£_ÿ£_Çm% f'%s'", 
u£_ÿ£_Çme
, 
fe
);

2259 ià(!
fe
) {

2260 
	`uc_”rÜ
("error: use case missing file");

2261 
”r
 = -
EINVAL
;

2262 
__”rÜ
;

2266 
”r
 = 
	`·r£_v”b_fe
(
uc_mgr
, 
u£_ÿ£_Çme
, 
comm’t
, 
fe
);

2269 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
v¬ŸÁ
) {

2270 *
vfe
, *
vcomm’t
;

2271 cÚ¡ *
id
;

2272 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

2273 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

2275 ià(!
	`·r£_is_Çme_§ã
(
id
)) {

2276 
”r
 = -
EINVAL
;

2277 
__”rÜ
;

2279 
”r
 = 
	`·r£_v¬ŸÁ
(
uc_mgr
, 
n
, &
vfe
, &
vcomm’t
);

2280 ià(
”r
 < 0)

2282 
uc_mgr
->
·r£_v¬ŸÁ
 = 
id
;

2283 
”r
 = 
	`·r£_v”b_fe
(
uc_mgr
, 
id
,

2284 
vcomm’t
 ? vcomm’ˆ: 
comm’t
,

2285 
vfe
 ? vf: 
fe
);

2286 
uc_mgr
->
·r£_v¬ŸÁ
 = 
NULL
;

2287 
	`ä“
(
vfe
);

2288 
	`ä“
(
vcomm’t
);

2292 
__”rÜ
:

2293 
	`ä“
(
u£_ÿ£_Çme
);

2294 
	`ä“
(
fe
);

2295 
	`ä“
(
comm’t
);

2296  
”r
;

2297 
	}
}

2302 
	$·r£_cÚŒŞs_fixedboÙ
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
cfg
)

2304 
”r
;

2306 ià(!
	`li¡_em±y
(&
uc_mgr
->
fixedboÙ_li¡
)) {

2307 
	`uc_”rÜ
("FixedBoot†ist is‚otƒmpty");

2308  -
EINVAL
;

2310 
”r
 = 
	`·r£_£qu’û
(
uc_mgr
, &uc_mgr->
fixedboÙ_li¡
, 
cfg
);

2311 ià(
”r
 < 0) {

2312 
	`uc_”rÜ
("Unableo…arse FixedBootSequence");

2313  
”r
;

2317 
	}
}

2322 
	$·r£_cÚŒŞs_boÙ
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
cfg
)

2324 
”r
;

2326 ià(!
	`li¡_em±y
(&
uc_mgr
->
boÙ_li¡
)) {

2327 
	`uc_”rÜ
("Boot†ist is‚otƒmpty");

2328  -
EINVAL
;

2330 
”r
 = 
	`·r£_£qu’û
(
uc_mgr
, &uc_mgr->
boÙ_li¡
, 
cfg
);

2331 ià(
”r
 < 0) {

2332 
	`uc_”rÜ
("Unableo…arse BootSequence");

2333  
”r
;

2337 
	}
}

2342 
	$·r£_cÚŒŞs
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
cfg
)

2344 
”r
;

2346 ià(!
	`li¡_em±y
(&
uc_mgr
->
deçuÉ_li¡
)) {

2347 
	`uc_”rÜ
("Default†ist is‚otƒmpty");

2348  -
EINVAL
;

2350 
”r
 = 
	`·r£_£qu’û
(
uc_mgr
, &uc_mgr->
deçuÉ_li¡
, 
cfg
);

2351 ià(
”r
 < 0) {

2352 
	`uc_”rÜ
("Unableo…arse SectionDefaults");

2353  
”r
;

2357 
	}
}

2407 
	$·r£_ma¡”_fe
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
cfg
)

2409 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

2410 
¢d_cÚfig_t
 *
n
;

2411 cÚ¡ *
id
;

2412 
”r
;

2414 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

2415 
	`uc_”rÜ
("compoundypeƒxpected for master file");

2416  -
EINVAL
;

2419 ià(
uc_mgr
->
cÚf_fÜm©
 >= 2) {

2420 
”r
 = 
	`·r£_syÁax_f›ld
(
uc_mgr
, 
cfg
, uc_mgr->
cÚf_fe_Çme
);

2421 ià(
”r
 < 0)

2422  
”r
;

2426 
”r
 = 
	`uc_mgr_ev®u©e_š¶aû
(
uc_mgr
, 
cfg
);

2427 ià(
”r
 < 0)

2428  
”r
;

2431 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

2433 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

2434 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

2437 ià(
	`¡rcmp
(
id
, "Comment") == 0) {

2438 
”r
 = 
	`·r£_¡ršg_sub¡™u‹3
(
uc_mgr
, 
n
, &uc_mgr->
comm’t
);

2439 ià(
”r
 < 0) {

2440 
	`uc_”rÜ
("error: failedo get master comment");

2441  
”r
;

2447 ià(
	`¡rcmp
(
id
, "SectionUseCase") == 0) {

2448 
”r
 = 
	`·r£_compound
(
uc_mgr
, 
n
,

2449 
·r£_ma¡”_£ùiÚ
,

2450 
NULL
, NULL);

2451 ià(
”r
 < 0)

2452  
”r
;

2457 ià(
	`¡rcmp
(
id
, "FixedBootSequence") == 0) {

2458 
”r
 = 
	`·r£_cÚŒŞs_fixedboÙ
(
uc_mgr
, 
n
);

2459 ià(
”r
 < 0)

2460  
”r
;

2465 ià(
	`¡rcmp
(
id
, "BootSequence") == 0) {

2466 
”r
 = 
	`·r£_cÚŒŞs_boÙ
(
uc_mgr
, 
n
);

2467 ià(
”r
 < 0)

2468  
”r
;

2473 ià(
	`¡rcmp
(
id
, "SectionDefaults") == 0) {

2474 
”r
 = 
	`·r£_cÚŒŞs
(
uc_mgr
, 
n
);

2475 ià(
”r
 < 0)

2476  
”r
;

2481 ià(
	`¡rcmp
(
id
, "ValueDefaults") == 0) {

2482 
”r
 = 
	`·r£_v®ue
(
uc_mgr
, &uc_mgr->
v®ue_li¡
, 
n
);

2483 ià(
”r
 < 0) {

2484 
	`uc_”rÜ
("error: failedo…arse ValueDefaults");

2485  
”r
;

2491 ià(
uc_mgr
->
cÚf_fÜm©
 > 3 && 
	`¡rcmp
(
id
, "LibraryConfig") == 0) {

2492 
”r
 = 
	`·r£_libcÚfig
(
uc_mgr
, 
n
);

2493 ià(
”r
 < 0) {

2494 
	`uc_”rÜ
("error: failedo…arse LibraryConfig");

2495  
”r
;

2501 ià(
	`¡rcmp
(
id
, "Error") == 0)

2502  
	`”rÜ_node
(
uc_mgr
, 
n
);

2505 ià(
	`¡rcmp
(
id
, "Syntax") == 0)

2508 
	`uc_”rÜ
("unknowÀma¡” ff›ld %s", 
id
);

2511 
	}
}

2514 
	$g‘_ÿrd_šfo
(
¢d_u£_ÿ£_mgr_t
 *
mgr
,

2515 cÚ¡ *
ùl_Çme
,

2516 
¢d_ùl_ÿrd_šfo_t
 **
šfo
)

2518 
ùl_li¡
 *ctl_list;

2519 
”r
;

2521 
”r
 = 
	`uc_mgr_İ’_ùl
(
mgr
, &
ùl_li¡
, 
ùl_Çme
, 0);

2522 ià(
”r
 < 0)

2523  
”r
;

2525 ià(
šfo
)

2526 *
šfo
 = 
ùl_li¡
->
ùl_šfo
;

2527  
”r
;

2528 
	}
}

2531 
	$g‘_by_ÿrd_Çme
(
¢d_u£_ÿ£_mgr_t
 *
mgr
, cÚ¡ *
ÿrd_Çme
)

2533 
ÿrd
, 
”r
;

2534 
¢d_ùl_ÿrd_šfo_t
 *
šfo
;

2535 cÚ¡ *
_driv”
, *
_Çme
, *
_lÚg_Çme
;

2537 
	`¢d_ùl_ÿrd_šfo_®loÿ
(&
šfo
);

2539 
ÿrd
 = -1;

2540 ià(
	`¢d_ÿrd_Ãxt
(&
ÿrd
) < 0 || card < 0) {

2541 
	`uc_”rÜ
("no soundcards found...");

2545 
ÿrd
 >= 0) {

2546 
Çme
[32];

2549 
	`uc_mgr_ä“_ùl_li¡
(
mgr
);

2551 
	`¥rštf
(
Çme
, "hw:%d", 
ÿrd
);

2552 
”r
 = 
	`g‘_ÿrd_šfo
(
mgr
, 
Çme
, &
šfo
);

2554 ià(
”r
 == 0) {

2555 
_driv”
 = 
	`¢d_ùl_ÿrd_šfo_g‘_driv”
(
šfo
);

2556 
_Çme
 = 
	`¢d_ùl_ÿrd_šfo_g‘_Çme
(
šfo
);

2557 
_lÚg_Çme
 = 
	`¢d_ùl_ÿrd_šfo_g‘_lÚgÇme
(
šfo
);

2558 ià(!
	`¡rcmp
(
ÿrd_Çme
, 
_driv”
) ||

2559 !
	`¡rcmp
(
ÿrd_Çme
, 
_Çme
) ||

2560 !
	`¡rcmp
(
ÿrd_Çme
, 
_lÚg_Çme
))

2564 ià(
	`¢d_ÿrd_Ãxt
(&
ÿrd
) < 0) {

2565 
	`uc_”rÜ
("snd_card_next");

2570 
	`uc_mgr_ä“_ùl_li¡
(
mgr
);

2573 
	}
}

2576 
šlše
 
	$g‘_by_ÿrd
(
¢d_u£_ÿ£_mgr_t
 *
mgr
, cÚ¡ *
ùl_Çme
)

2578  
	`g‘_ÿrd_šfo
(
mgr
, 
ùl_Çme
, 
NULL
);

2579 
	}
}

2581 
	$·r£_tİËv–_·th
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2582 *
f’ame
,

2583 
¢d_cÚfig_t
 *
cfg
)

2585 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
, 
i2
, 
Ãxt2
;

2586 
¢d_cÚfig_t
 *
n
, *
n2
;

2587 cÚ¡ *
id
;

2588 *
dœ
 = 
NULL
, *
fe
 = NULL, 
â
[
PATH_MAX
];

2589 
¡©64
 
¡
;

2590 
v”siÚ
;

2591 
”r
;

2593 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

2594 
	`uc_”rÜ
("compoundypeƒxpected for UseCasePath‚ode");

2595  -
EINVAL
;

2599 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

2600 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

2602 ià(
	`¢d_cÚfig_g‘_ty³
(
n
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

2603 
	`uc_”rÜ
("compoundypeƒxpected for UseCasePath.something‚ode");

2604  -
EINVAL
;

2607 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

2610 
v”siÚ
 = 2;

2613 
	`¢d_cÚfig_fÜ_—ch
(
i2
, 
Ãxt2
, 
n
) {

2615 
n2
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i2
);

2616 ià(
	`¢d_cÚfig_g‘_id
(
n2
, &
id
) < 0)

2619 ià(
	`¡rcmp
(
id
, "Version") == 0) {

2620 
”r
 = 
	`·r£_š‹g”_sub¡™u‹
(
uc_mgr
, 
n2
, &
v”siÚ
);

2621 ià(
”r
 < 0) {

2622 
	`uc_”rÜ
("unableo…arse UcmDirectory");

2623 
__”rÜ
;

2625 ià(
v”siÚ
 < 1 || version > 2) {

2626 
	`uc_”rÜ
("Version must be 1 or 2");

2627 
”r
 = -
EINVAL
;

2628 
__”rÜ
;

2633 ià(
	`¡rcmp
(
id
, "Directory") == 0) {

2634 
”r
 = 
	`·r£_¡ršg_sub¡™u‹
(
uc_mgr
, 
n2
, &
dœ
);

2635 ià(
”r
 < 0) {

2636 
	`uc_”rÜ
("unableo…arse Directory");

2637 
__”rÜ
;

2642 ià(
	`¡rcmp
(
id
, "File") == 0) {

2643 
”r
 = 
	`·r£_¡ršg_sub¡™u‹
(
uc_mgr
, 
n2
, &
fe
);

2644 ià(
”r
 < 0) {

2645 
	`uc_”rÜ
("unableo…arse File");

2646 
__”rÜ
;

2651 
	`uc_”rÜ
("unknowÀU£Ca£P©h f›ld %s", 
id
);

2654 ià(
dœ
 =ğ
NULL
) {

2655 
	`uc_”rÜ
("DœeùÜy i nÙ defšed iÀ%s!", 
f’ame
);

2656 
__Ãxt
;

2658 ià(
fe
 =ğ
NULL
) {

2659 
	`uc_”rÜ
("Fi nÙ defšed iÀ%s!", 
f’ame
);

2660 
__Ãxt
;

2663 
	`ucm_f’ame
(
â
, (â), 
v”siÚ
, 
dœ
, 
fe
);

2664 ià(
	`acûss
(
â
, 
R_OK
è=ğ0 && 
	`l¡©64
(â, &
¡
) == 0) {

2665 ià(
	`S_ISLNK
(
¡
.
¡_mode
)) {

2666 
ssize_t
 
r
;

2667 *
lšk
, *
dœ2
, *
p
;

2669 
lšk
 = 
	`m®loc
(
PATH_MAX
);

2670 ià(
lšk
 =ğ
NULL
)

2671 
__’omem
;

2672 
r
 = 
	`»adlšk
(
â
, 
lšk
, 
PATH_MAX
 - 1);

2673 ià(
r
 <= 0) {

2674 
	`ä“
(
lšk
);

2675 
__Ãxt
;

2677 
lšk
[
r
] = '\0';

2678 
p
 = 
	`¡¼chr
(
lšk
, '/');

2679 ià(
p
) {

2680 *
p
 = '\0';

2681 
dœ2
 = 
	`m®loc
(
PATH_MAX
);

2682 ià(
dœ2
 =ğ
NULL
) {

2683 
	`ä“
(
lšk
);

2684 
__’omem
;

2686 
	`¡ºıy
(
dœ2
, 
dœ
, 
PATH_MAX
 - 1);

2687 
	`¡ºÿt
(
dœ2
, "/", 
PATH_MAX
 - 1);

2688 
	`¡ºÿt
(
dœ2
, 
lšk
, 
PATH_MAX
 - 1);

2689 
â
[
PATH_MAX
 - 1] = '\0';

2690 
	`ä“
(
dœ
);

2691 
dœ
 = 
dœ2
;

2693 
	`ä“
(
lšk
);

2695 ià(
	`»¶aû_¡ršg
(&
uc_mgr
->
cÚf_dœ_Çme
, 
dœ
è=ğ
NULL
)

2696 
__’omem
;

2697 ià(
	`»¶aû_¡ršg
(&
uc_mgr
->
cÚf_fe_Çme
, 
fe
è=ğ
NULL
)

2698 
__’omem
;

2699 
	`¡ºıy
(
f’ame
, 
â
, 
PATH_MAX
);

2700 
f’ame
[
PATH_MAX
 - 1] = '\0';

2701 
uc_mgr
->
cÚf_fÜm©
 = 
v”siÚ
;

2702 
__ok
;

2705 
__Ãxt
:

2706 
	`ä“
(
fe
);

2707 ià(
dœ
 !ğ
â
)

2708 
	`ä“
(
dœ
);

2709 
dœ
 = 
NULL
;

2710 
fe
 = 
NULL
;

2713 
”r
 = -
ENOENT
;

2714 
__”rÜ
;

2716 
__’omem
:

2717 
”r
 = -
ENOMEM
;

2718 
__”rÜ
;

2720 
__ok
:

2721 
”r
 = 0;

2722 
__”rÜ
:

2723 
	`ä“
(
fe
);

2724 ià(
dœ
 !ğ
â
)

2725 
	`ä“
(
dœ
);

2726  
”r
;

2727 
	}
}

2729 
	$·r£_tİËv–_cÚfig
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2730 *
f’ame
,

2731 
¢d_cÚfig_t
 *
cfg
)

2733 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

2734 
¢d_cÚfig_t
 *
n
;

2735 cÚ¡ *
id
;

2736 
”r
;

2738 ià(
	`¢d_cÚfig_g‘_ty³
(
cfg
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

2739 
	`uc_”rÜ
("compoundypeƒxpected foroplevel file");

2740  -
EINVAL
;

2743 
”r
 = 
	`·r£_syÁax_f›ld
(
uc_mgr
, 
cfg
, 
f’ame
);

2744 ià(
”r
 < 0)

2745  
”r
;

2748 
”r
 = 
	`uc_mgr_ev®u©e_š¶aû
(
uc_mgr
, 
cfg
);

2749 ià(
”r
 < 0)

2750  
”r
;

2753 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cfg
) {

2755 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

2756 ià(
	`¢d_cÚfig_g‘_id
(
n
, &
id
) < 0)

2759 ià(
	`¡rcmp
(
id
, "UseCasePath") == 0) {

2760 
”r
 = 
	`·r£_tİËv–_·th
(
uc_mgr
, 
f’ame
, 
n
);

2761 ià(
”r
 == 0)

2762  
”r
;

2767 ià(
uc_mgr
->
cÚf_fÜm©
 > 3 && 
	`¡rcmp
(
id
, "LibraryConfig") == 0) {

2768 
”r
 = 
	`·r£_libcÚfig
(
uc_mgr
, 
n
);

2769 ià(
”r
 < 0) {

2770 
	`uc_”rÜ
("error: failedo…arse LibConfig");

2771  
”r
;

2777 ià(
	`¡rcmp
(
id
, "Syntax") == 0)

2780 
	`uc_”rÜ
("unknowÀtİËv– f›ld %s", 
id
);

2783  -
ENOENT
;

2784 
	}
}

2786 
	$lßd_tİËv–_cÚfig
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

2787 
¢d_cÚfig_t
 **
cfg
)

2789 
f’ame
[
PATH_MAX
];

2790 
¢d_cÚfig_t
 *
tcfg
;

2791 
”r
;

2793 
	`ucm_f’ame
(
f’ame
, (f’ame), 2, 
NULL
, "ucm.conf");

2795 ià(
	`acûss
(
f’ame
, 
R_OK
) != 0) {

2796 
	`uc_”rÜ
("UÇbËØfšdhtİ-Ëv– cÚfigu¿tiÚ f'%s'.", 
f’ame
);

2797  -
ENOENT
;

2800 
”r
 = 
	`uc_mgr_cÚfig_lßd
(2, 
f’ame
, &
tcfg
);

2801 ià(
”r
 < 0)

2802 
__”rÜ
;

2805 
”r
 = 
	`·r£_tİËv–_cÚfig
(
uc_mgr
, 
f’ame
, 
tcfg
);

2806 
	`¢d_cÚfig_d–‘e
(
tcfg
);

2807 ià(
”r
 < 0)

2808 
__”rÜ
;

2810 
”r
 = 
	`uc_mgr_cÚfig_lßd
(
uc_mgr
->
cÚf_fÜm©
, 
f’ame
, 
cfg
);

2811 ià(
”r
 < 0) {

2812 
	`uc_”rÜ
("error: could‚ot…arse configuration for card %s",

2813 
uc_mgr
->
ÿrd_Çme
);

2814 
__”rÜ
;

2819 
__”rÜ
:

2820  
”r
;

2821 
	}
}

2825 
	$uc_mgr_impÜt_ma¡”_cÚfig
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

2827 
¢d_cÚfig_t
 *
cfg
;

2828 cÚ¡ *
Çme
;

2829 
”r
;

2831 
”r
 = 
	`¢d_cÚfig_tİ
(&
uc_mgr
->
loÿl_cÚfig
);

2832 ià(
”r
 < 0)

2833  
”r
;

2835 
”r
 = 
	`¢d_cÚfig_tİ
(&
uc_mgr
->
maüos
);

2836 ià(
”r
 < 0)

2837  
”r
;

2839 
Çme
 = 
uc_mgr
->
ÿrd_Çme
;

2840 ià(
	`¡ºcmp
(
Çme
, "hw:", 3) == 0) {

2841 
”r
 = 
	`g‘_by_ÿrd
(
uc_mgr
, 
Çme
);

2842 ià(
”r
 < 0) {

2843 
	`uc_”rÜ
("ÿrd '%s' i nÙ v®id", 
Çme
);

2844 
__”rÜ
;

2846 } ià(
	`¡ºcmp
(
Çme
, "strict:", 7)) {

2849 
	`g‘_by_ÿrd_Çme
(
uc_mgr
, 
Çme
);

2852 
”r
 = 
	`lßd_tİËv–_cÚfig
(
uc_mgr
, &
cfg
);

2853 ià(
”r
 < 0)

2854 
__”rÜ
;

2856 
”r
 = 
	`·r£_ma¡”_fe
(
uc_mgr
, 
cfg
);

2857 ià(
uc_mgr
->
maüos
) {

2858 
	`¢d_cÚfig_d–‘e
(
uc_mgr
->
maüos
);

2859 
uc_mgr
->
maüos
 = 
NULL
;

2861 
	`¢d_cÚfig_d–‘e
(
cfg
);

2862 ià(
”r
 < 0) {

2863 
	`uc_mgr_ä“_ùl_li¡
(
uc_mgr
);

2864 
	`uc_mgr_ä“_v”b
(
uc_mgr
);

2867  
”r
;

2869 
__”rÜ
:

2870 
	`uc_mgr_ä“_ùl_li¡
(
uc_mgr
);

2871 
	`»¶aû_¡ršg
(&
uc_mgr
->
cÚf_dœ_Çme
, 
NULL
);

2872  
”r
;

2873 
	}
}

2875 
	$f’ame_f‹r
(cÚ¡ 
dœ’t64
 *
dœ’t
)

2877 ià(
dœ’t
 =ğ
NULL
)

2879 ià(
dœ’t
->
d_ty³
 =ğ
DT_DIR
) {

2880 ià(
dœ’t
->
d_Çme
[0] == '.') {

2881 ià(
dœ’t
->
d_Çme
[1] == '\0')

2883 ià(
dœ’t
->
d_Çme
[1] == '.' &&

2884 
dœ’t
->
d_Çme
[2] == '\0')

2890 
	}
}

2900 
	$uc_mgr_sÿn_ma¡”_cÚfigs
(cÚ¡ **
_li¡
[])

2902 
f’ame
[
PATH_MAX
], 
dæ
[PATH_MAX], 
â
[
FILENAME_MAX
];

2903 *
’v
 = 
	`g‘’v
(
ALSA_CONFIG_UCM2_VAR
);

2904 
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
;

2905 cÚ¡ **
li¡
, *
d_Çme
;

2906 *
s
;

2907 
¢d_cÚfig_t
 *
cfg
, *
c
;

2908 
i
, 
j
, 
út
, 
”r
, 
ÿrds
;

2909 
l
;

2910 
ssize_t
 
ss
;

2911 
dœ’t64
 **
Çm–i¡
;

2913 
i
 = -1;

2914 
ÿrds
 = 0;

2916 
”r
 = 
	`¢d_ÿrd_Ãxt
(&
i
);

2917 ià(
”r
 < 0)

2918  
”r
;

2919 ià(
i
 < 0)

2921 
ÿrds
++;

2923 
ÿrds
 += 4;

2925 ià(
’v
)

2926 
	`¢´štf
(
f’ame
, (f’ame), "%s/cÚf.vœt.d", 
’v
);

2928 
	`¢´štf
(
f’ame
, (filename), "%s/ucm2/conf.virt.d",

2929 
	`¢d_cÚfig_tİdœ
());

2931 #ià
	`defšed
(
_GNU_SOURCE
è&& !defšed(
__N‘BSD__
è&& !defšed(
__F»eBSD__
è&& !defšed(
__O³nBSD__
è&& !defšed(
__D¿gÚFly__
è&& !defšed(
__sun
è&& !defšed(
__ANDROID__
)

2932 
	#SORTFUNC
 
v”siÚsÜt64


	)

2934 
	#SORTFUNC
 
®phasÜt64


	)

2936 
”r
 = 
	`sÿndœ64
(
f’ame
, &
Çm–i¡
, 
f’ame_f‹r
, 
SORTFUNC
);

2937 ià(
”r
 < 0) {

2938 
”r
 = -
”ºo
;

2939 
	`uc_”rÜ
("error: could‚ot scan directory %s: %s",

2940 
f’ame
, 
	`¡»¼Ü
(-
”r
));

2941  
”r
;

2943 
út
 = 
”r
;

2945 
dæ
[0] = '\0';

2946 ià(
	`¡¾’
(
f’ame
) + 8 < (filename)) {

2947 
	`¡rÿt
(
f’ame
, "/default");

2948 
ss
 = 
	`»adlšk
(
f’ame
, 
dæ
, (dfl)-1);

2949 ià(
ss
 >= 0) {

2950 
dæ
[
ss
] = '\0';

2951 
dæ
[(dfl)-1] = '\0';

2952 ià(
dæ
[0] && dæ[
	`¡¾’
(dfl)-1] == '/')

2953 
dæ
[
	`¡¾’
(dfl)-1] = '\0';

2955 
dæ
[0] = '\0';

2959 
j
 = 0;

2960 
li¡
 = 
	`ÿÎoc
(1, (
ÿrds
 + 
út
) * 2 * (*));

2961 ià(
li¡
 =ğ
NULL
) {

2962 
”r
 = -
ENOMEM
;

2963 
__”r
;

2966 
i
 = -1;

2967 
j
 / 2 < 
ÿrds
) {

2968 
”r
 = 
	`¢d_ÿrd_Ãxt
(&
i
);

2969 ià(
”r
 < 0)

2970 
__”r
;

2971 ià(
i
 < 0)

2973 
	`¢´štf
(
â
, (â), "-hw:%d", 
i
);

2974 
”r
 = 
	`¢d_u£_ÿ£_mgr_İ’
(&
uc_mgr
, 
â
);

2975 ià(
”r
 =ğ-
ENOENT
 ||ƒ¼ =ğ-
ENXIO
)

2977 ià(
”r
 < 0) {

2978 
	`uc_”rÜ
("UÇbËØİ’ '%s': %s", 
â
, 
	`¢d_¡»¼Ü
(
”r
));

2979 
__”r
;

2981 
”r
 = 
	`¢d_u£_ÿ£_g‘
(
uc_mgr
, "comm’t", (cÚ¡ **)&
s
);

2982 ià(
”r
 < 0) {

2983 
”r
 = 
	`¢d_ÿrd_g‘_lÚgÇme
(
i
, &
s
);

2984 ià(
”r
 < 0)

2985 
__”r
;

2987 
	`¢d_u£_ÿ£_mgr_şo£
(
uc_mgr
);

2988 
li¡
[
j
] = 
	`¡rdup
(
â
 + 1);

2989 ià(
li¡
[
j
] =ğ
NULL
) {

2990 
	`ä“
(
s
);

2991 
”r
 = -
ENOMEM
;

2992 
__”r
;

2994 
li¡
[
j
 + 1] = 
s
;

2995 
j
 += 2;

2998 
i
 = 0; i < 
út
; i++) {

3000 
d_Çme
 = 
Çm–i¡
[
i
]->d_name;

3002 
	`¢´štf
(
â
, (â), "%s.cÚf", 
d_Çme
);

3003 
	`ucm_f’ame
(
f’ame
, (f’ame), 2, 
d_Çme
, 
â
);

3004 #ifdeà
HAVE_EACCESS


3005 ià(
	`—cûss
(
f’ame
, 
R_OK
))

3007 ià(
	`acûss
(
f’ame
, 
R_OK
))

3011 
”r
 = 
	`uc_mgr_cÚfig_lßd
(2, 
f’ame
, &
cfg
);

3012 ià(
”r
 < 0)

3013 
__”r
;

3014 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cfg
, "SyÁax", &
c
);

3015 ià(
”r
 < 0) {

3016 
	`uc_”rÜ
("SyÁax f›ld‚Ù found iÀ%s", 
d_Çme
);

3017 
	`¢d_cÚfig_d–‘e
(
cfg
);

3020 
”r
 = 
	`¢d_cÚfig_g‘_š‹g”
(
c
, &
l
);

3021 ià(
”r
 < 0) {

3022 
	`uc_”rÜ
("SyÁax f›ld i šv®id iÀ%s", 
d_Çme
);

3023 
	`¢d_cÚfig_d–‘e
(
cfg
);

3024 
__”r
;

3026 ià(
l
 < 2 ||† > 
SYNTAX_VERSION_MAX
) {

3027 
	`uc_”rÜ
("Incom·tibË syÁax %d iÀ%s", 
l
, 
d_Çme
);

3028 
	`¢d_cÚfig_d–‘e
(
cfg
);

3029 
__”r
;

3031 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cfg
, "Comm’t", &
c
);

3032 ià(
”r
 >= 0) {

3033 
”r
 = 
	`·r£_¡ršg
(
c
, (**)&
li¡
[
j
+1]);

3034 ià(
”r
 < 0) {

3035 
	`¢d_cÚfig_d–‘e
(
cfg
);

3036 
__”r
;

3039 
	`¢d_cÚfig_d–‘e
(
cfg
);

3040 
li¡
[
j
] = 
	`¡rdup
(
d_Çme
);

3041 ià(
li¡
[
j
] =ğ
NULL
) {

3042 
”r
 = -
ENOMEM
;

3043 
__”r
;

3045 ià(
	`¡rcmp
(
dæ
, 
li¡
[
j
]) == 0) {

3047 cÚ¡ *
§ve1
 = 
li¡
[
j
];

3048 cÚ¡ *
§ve2
 = 
li¡
[
j
 + 1];

3049 
	`memmove
(
li¡
 + 2,†i¡, 
j
 * (*));

3050 
li¡
[0] = 
§ve1
;

3051 
li¡
[1] = 
§ve2
;

3053 
j
 += 2;

3055 
”r
 = 0;

3057 
__”r
:

3058 
i
 = 0; i < 
út
; i++)

3059 
	`ä“
(
Çm–i¡
[
i
]);

3060 
	`ä“
(
Çm–i¡
);

3061 ià(
”r
 < 0) {

3062 
i
 = 0; i < 
j
; i++) {

3063 
	`ä“
((*)
li¡
[
i
 * 2]);

3064 
	`ä“
((*)
li¡
[
i
 * 2 + 1]);

3066 
	`ä“
(
li¡
);

3067  
”r
;

3070 *
_li¡
 = 
li¡
;

3071  
j
;

3072 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_cond.c

27 
	~"ucm_loÿl.h
"

28 
	~<»gex.h
>

30 
	$g‘_¡ršg
(
¢d_cÚfig_t
 *
compound
, cÚ¡ *
key
, cÚ¡ **
¡r
)

32 
¢d_cÚfig_t
 *
node
;

33 
”r
;

35 
”r
 = 
	`¢d_cÚfig_£¬ch
(
compound
, 
key
, &
node
);

36 ià(
”r
 < 0)

37  
”r
;

38  
	`¢d_cÚfig_g‘_¡ršg
(
node
, 
¡r
);

39 
	}
}

41 
	$if_ev®_¡ršg
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
ev®
)

43 cÚ¡ *
¡ršg1
 = 
NULL
, *
¡ršg2
 = NULL;

44 *
s1
, *
s2
;

45 
”r
;

47 ià(
uc_mgr
->
cÚf_fÜm©
 >= 3) {

48 
”r
 = 
	`g‘_¡ršg
(
ev®
, "Em±y", &
¡ršg1
);

49 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

50 
	`uc_”rÜ
("Stringƒrror (If.Condition.Empty)");

51  -
EINVAL
;

54 ià(
¡ršg1
) {

55 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s1
, 
¡ršg1
);

56 ià(
”r
 < 0)

57  
”r
;

58 
”r
 = 
s1
 =ğ
NULL
 || s1[0] == '\0';

59 
	`ä“
(
s1
);

60  
”r
;

64 
”r
 = 
	`g‘_¡ršg
(
ev®
, "SŒšg1", &
¡ršg1
);

65 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

66 
	`uc_”rÜ
("Stringƒrror (If.Condition.String1)");

67  -
EINVAL
;

70 
”r
 = 
	`g‘_¡ršg
(
ev®
, "SŒšg2", &
¡ršg2
);

71 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

72 
	`uc_”rÜ
("Stringƒrror (If.Condition.String2)");

73  -
EINVAL
;

76 ià(
¡ršg1
 || 
¡ršg2
) {

77 ià(
¡ršg1
 =ğ
NULL
) {

78 
	`uc_”rÜ
("If.Condition.String1‚ot defined");

79  -
EINVAL
;

81 ià(
¡ršg2
 =ğ
NULL
) {

82 
	`uc_”rÜ
("If.Condition.String2‚ot defined");

83  -
EINVAL
;

85 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s1
, 
¡ršg1
);

86 ià(
”r
 < 0)

87  
”r
;

88 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s2
, 
¡ršg2
);

89 ià(
”r
 < 0) {

90 
	`ä“
(
s1
);

91  
”r
;

93 
”r
 = 
	`¡rÿ£cmp
(
s1
, 
s2
) == 0;

94 
	`ä“
(
s2
);

95 
	`ä“
(
s1
);

96  
”r
;

99 
”r
 = 
	`g‘_¡ršg
(
ev®
, "Hay¡ack", &
¡ršg1
);

100 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

101 
	`uc_”rÜ
("Stringƒrror (If.Condition.Haystack)");

102  -
EINVAL
;

105 
”r
 = 
	`g‘_¡ršg
(
ev®
, "N“dË", &
¡ršg2
);

106 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

107 
	`uc_”rÜ
("Stringƒrror (If.Condition.Needle)");

108  -
EINVAL
;

111 ià(
¡ršg1
 || 
¡ršg2
) {

112 ià(
¡ršg1
 =ğ
NULL
) {

113 
	`uc_”rÜ
("If.Condition.Haystack‚ot defined");

114  -
EINVAL
;

116 ià(
¡ršg2
 =ğ
NULL
) {

117 
	`uc_”rÜ
("If.Condition.Needle‚ot defined");

118  -
EINVAL
;

120 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s1
, 
¡ršg1
);

121 ià(
”r
 < 0)

122  
”r
;

123 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s2
, 
¡ršg2
);

124 ià(
”r
 < 0) {

125 
	`ä“
(
s1
);

126  
”r
;

128 
”r
 = 
	`¡r¡r
(
s1
, 
s2
è!ğ
NULL
;

129 
	`ä“
(
s2
);

130 
	`ä“
(
s1
);

131  
”r
;

134 
	`uc_”rÜ
("Unknown String condition‡rguments");

135  -
EINVAL
;

136 
	}
}

138 
	$if_ev®_»gex_m©ch
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
ev®
)

140 cÚ¡ *
¡ršg
, *
»gex_¡ršg
;

141 *
s
;

142 
»gex_t
 
»
;

143 
İtiÚs
 = 
REG_EXTENDED
 | 
REG_ICASE
;

144 
»gm©ch_t
 
m©ch
[1];

145 
”r
;

147 
”r
 = 
	`g‘_¡ršg
(
ev®
, "SŒšg", &
¡ršg
);

148 ià(
”r
 < 0) {

149 
	`uc_”rÜ
("RegexMatchƒrror (If.Condition.String)");

150  -
EINVAL
;

153 
”r
 = 
	`g‘_¡ršg
(
ev®
, "Regex", &
»gex_¡ršg
);

154 ià(
”r
 < 0) {

155 
	`uc_”rÜ
("RegexMatchƒrror (If.Condition.Regex)");

156  -
EINVAL
;

159 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s
, 
»gex_¡ršg
);

160 ià(
”r
 < 0)

161  
”r
;

162 
”r
 = 
	`»gcomp
(&
»
, 
s
, 
İtiÚs
);

163 ià(
”r
) {

164 
	`uc_”rÜ
("Regex '%s' comp©iÚ faed (cod%d)", 
s
, 
”r
);

165 
	`ä“
(
s
);

166  -
EINVAL
;

168 
	`ä“
(
s
);

170 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s
, 
¡ršg
);

171 ià(
”r
 < 0) {

172 
	`»gä“
(&
»
);

173  
”r
;

175 
”r
 = 
	`»gexec
(&
»
, 
s
, 
	`ARRAY_SIZE
(
m©ch
), match, 0);

176 
	`ä“
(
s
);

177 
	`»gä“
(&
»
);

178  
”r
 == 0;

179 
	}
}

181 
	$if_ev®_cÚŒŞ_exi¡s
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
ev®
)

183 
¢d_ùl_t
 *
ùl
;

184 
ùl_li¡
 *ctl_list;

185 cÚ¡ *
deviû
 = 
NULL
, *
ùldef
, *
’umv®
 = NULL, *
Çme
;

186 
¢d_ùl_–em_id_t
 *
–em_id
;

187 
¢d_ùl_–em_šfo_t
 *
–em_šfo
;

188 
¢d_ùl_–em_ty³_t
 
ty³
;

189 *
s
;

190 
”r
, 
i
, 
™ems
;

192 
	`¢d_ùl_–em_id_®loÿ
(&
–em_id
);

193 
	`¢d_ùl_–em_šfo_®loÿ
(&
–em_šfo
);

195 
”r
 = 
	`g‘_¡ršg
(
ev®
, "Deviû", &
deviû
);

196 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

197 
	`uc_”rÜ
("ControlExistsƒrror (If.Condition.Device)");

198  -
EINVAL
;

201 
”r
 = 
	`g‘_¡ršg
(
ev®
, "CÚŒŞ", &
ùldef
);

202 ià(
”r
 < 0) {

203 
	`uc_”rÜ
("ControlExistsƒrror (If.Condition.Control)");

204  -
EINVAL
;

207 
”r
 = 
	`g‘_¡ršg
(
ev®
, "CÚŒŞEnum", &
’umv®
);

208 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

209 
	`uc_”rÜ
("ControlExistsƒrror (If.Condition.ControlEnum)");

210  -
EINVAL
;

213 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s
, 
ùldef
);

214 ià(
”r
 < 0)

215  
”r
;

216 
”r
 = 
	`¢d_ùl_ascii_–em_id_·r£
(
–em_id
, 
s
);

217 
	`ä“
(
s
);

218 ià(
”r
 < 0) {

219 
	`uc_”rÜ
("uÇbËØ·r£ƒËm’ˆid’tifiÿtÜ (%s)", 
ùldef
);

220  -
EINVAL
;

223 ià(
deviû
 =ğ
NULL
) {

224 
ùl
 = 
	`uc_mgr_g‘_ùl
(
uc_mgr
);

225 ià(
ùl
 =ğ
NULL
) {

226 
	`uc_”rÜ
("cannot determine control device");

227  -
EINVAL
;

230 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s
, 
deviû
);

231 ià(
”r
 < 0)

232  
”r
;

233 
”r
 = 
	`uc_mgr_İ’_ùl
(
uc_mgr
, &
ùl_li¡
, 
s
, 1);

234 
	`ä“
(
s
);

235 ià(
”r
 < 0)

236  
”r
;

237 
ùl
 = 
ùl_li¡
->ctl;

240 
	`¢d_ùl_–em_šfo_£t_id
(
–em_šfo
, 
–em_id
);

241 
”r
 = 
	`¢d_ùl_–em_šfo
(
ùl
, 
–em_šfo
);

242 ià(
”r
 < 0)

245 ià(
’umv®
) {

246 
ty³
 = 
	`¢d_ùl_–em_šfo_g‘_ty³
(
–em_šfo
);

247 ià(
ty³
 !ğ
SND_CTL_ELEM_TYPE_ENUMERATED
)

249 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s
, 
’umv®
);

250 ià(
”r
 < 0)

251  
”r
;

252 
™ems
 = 
	`¢d_ùl_–em_šfo_g‘_™ems
(
–em_šfo
);

253 
i
 = 0; i < 
™ems
; i++) {

254 
	`¢d_ùl_–em_šfo_£t_™em
(
–em_šfo
, 
i
);

255 
”r
 = 
	`¢d_ùl_–em_šfo
(
ùl
, 
–em_šfo
);

256 ià(
”r
 < 0) {

257 
	`ä“
(
s
);

258  
”r
;

260 
Çme
 = 
	`¢d_ùl_–em_šfo_g‘_™em_Çme
(
–em_šfo
);

261 ià(
	`¡rÿ£cmp
(
Çme
, 
s
) == 0) {

262 
	`ä“
(
s
);

266 
	`ä“
(
s
);

271 
	}
}

273 
	$if_ev®_·th
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
ev®
)

275 cÚ¡ *
·th
, *
mode
 = "";

276 
”r
, 
amode
 = 
F_OK
;

277 *
s
;

279 ià(
uc_mgr
->
cÚf_fÜm©
 < 4) {

280 
	`uc_”rÜ
("Path condition is supported in v4+ syntax");

281  -
EINVAL
;

284 
”r
 = 
	`g‘_¡ršg
(
ev®
, "P©h", &
·th
);

285 ià(
”r
 < 0) {

286 
	`uc_”rÜ
("Pathƒrror (If.Condition.Path)");

287  -
EINVAL
;

290 
”r
 = 
	`g‘_¡ršg
(
ev®
, "Mode", &
mode
);

291 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

292 
	`uc_”rÜ
("Pathƒrror (If.Condition.Mode)");

293  -
EINVAL
;

296 ià(
uc_mgr
->
cÚf_fÜm©
 < 7) {

297 
s
 = (*)
mode
;

299 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s
, 
mode
);

300 ià(
”r
 < 0)

301  
”r
;

303 ià(
	`¡ºÿ£cmp
(
s
, "exist", 5) == 0) {

304 
amode
 = 
F_OK
;

305 } ià(
	`¡rÿ£cmp
(
s
, "read") == 0) {

306 
amode
 = 
R_OK
;

307 } ià(
	`¡rÿ£cmp
(
s
, "write") == 0) {

308 
amode
 = 
W_OK
;

309 } ià(
	`¡rÿ£cmp
(
s
, "exec") == 0) {

310 
amode
 = 
X_OK
;

312 
	`uc_”rÜ
("P©h unknowÀmod'%s' (If.CÚd™iÚ.Mode)", 
s
);

313 
	`ä“
(
s
);

314  -
EINVAL
;

316 ià(
s
 !ğ
mode
)

317 
	`ä“
(
s
);

319 ià(
uc_mgr
->
cÚf_fÜm©
 < 7) {

320 
s
 = (*)
·th
;

322 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s
, 
·th
);

323 ià(
”r
 < 0)

324  
”r
;

326 #ifdeà
HAVE_EACCESS


327 
”r
 = 
	`—cûss
(
s
, 
amode
);

329 
”r
 = 
	`acûss
(
s
, 
amode
);

331 ià(
s
 !ğ
·th
)

332 
	`ä“
(
s
);

333  
”r
 ? 0 : 1;

334 
	}
}

336 
	$if_ev®
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
ev®
)

338 cÚ¡ *
ty³
;

339 
”r
;

341 ià(
	`¢d_cÚfig_g‘_ty³
(
ev®
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

342 
	`uc_”rÜ
("compoundypeƒxpected for If.Condition");

343  -
EINVAL
;

346 
”r
 = 
	`g‘_¡ršg
(
ev®
, "Ty³", &
ty³
);

347 ià(
”r
 < 0) {

348 
	`uc_”rÜ
("type blockƒrror (If.Condition)");

349  -
EINVAL
;

352 ià(
	`¡rcmp
(
ty³
, "AlwaysTrue") == 0)

355 ià(
	`¡rcmp
(
ty³
, "String") == 0)

356  
	`if_ev®_¡ršg
(
uc_mgr
, 
ev®
);

358 ià(
	`¡rcmp
(
ty³
, "ControlExists") == 0)

359  
	`if_ev®_cÚŒŞ_exi¡s
(
uc_mgr
, 
ev®
);

361 ià(
	`¡rcmp
(
ty³
, "RegexMatch") == 0)

362  
	`if_ev®_»gex_m©ch
(
uc_mgr
, 
ev®
);

364 ià(
	`¡rcmp
(
ty³
, "Path") == 0)

365  
	`if_ev®_·th
(
uc_mgr
, 
ev®
);

367 
	`uc_”rÜ
("unknown If.Condition.Type");

368  -
EINVAL
;

369 
	}
}

371 
	$if_ev®_Úe
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

372 
¢d_cÚfig_t
 *
cÚd
,

373 
¢d_cÚfig_t
 **
»suÉ
,

374 
¢d_cÚfig_t
 **
befÜe
,

375 
¢d_cÚfig_t
 **
aá”
)

377 
¢d_cÚfig_t
 *
ex´
, *
_Œue
 = 
NULL
, *
_çl£
 = NULL;

378 
”r
;

380 *
»suÉ
 = 
NULL
;

382 ià(
	`¢d_cÚfig_g‘_ty³
(
cÚd
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

383 
	`uc_”rÜ
("compoundypeƒxpected for If.1");

384  -
EINVAL
;

387 ià(
	`¢d_cÚfig_£¬ch
(
cÚd
, "CÚd™iÚ", &
ex´
) < 0) {

388 
	`uc_”rÜ
("condition blockƒxpected (If)");

389  -
EINVAL
;

392 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cÚd
, "True", &
_Œue
);

393 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

394 
	`uc_”rÜ
("true blockƒrror (If)");

395  -
EINVAL
;

398 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cÚd
, "F®£", &
_çl£
);

399 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

400 
	`uc_”rÜ
("false blockƒrror (If)");

401  -
EINVAL
;

404 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cÚd
, "BefÜe", 
befÜe
);

405 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

406 
	`uc_”rÜ
("before block identifierƒrror");

407  -
EINVAL
;

410 
”r
 = 
	`¢d_cÚfig_£¬ch
(
cÚd
, "Aá”", 
aá”
);

411 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

412 
	`uc_”rÜ
("before block identifierƒrror");

413  -
EINVAL
;

416 
”r
 = 
	`if_ev®
(
uc_mgr
, 
ex´
);

417 ià(
”r
 > 0) {

418 *
»suÉ
 = 
_Œue
;

420 } ià(
”r
 == 0) {

421 *
»suÉ
 = 
_çl£
;

424  
”r
;

426 
	}
}

429 
	$cÚfig_dump
(
¢d_cÚfig_t
 *
cfg
)

431 
¢d_ouut_t
 *
out
;

432 
	`¢d_ouut_¡dio_©ch
(&
out
, 
¡d”r
, 0);

433 
	`¢d_ouut_´štf
(
out
, "-----\n");

434 
	`¢d_cÚfig_§ve
(
cfg
, 
out
);

435 
	`¢d_ouut_şo£
(
out
);

436 
	}
}

442 
	$uc_mgr_ev®u©e_cÚd™iÚ
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

443 
¢d_cÚfig_t
 *
·»Á
,

444 
¢d_cÚfig_t
 *
cÚd
)

446 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

447 
¢d_cÚfig_t
 *
a
, *
n
, *
befÜe
, *
aá”
;

448 
”r
;

450 ià(
uc_mgr
->
cÚf_fÜm©
 < 2) {

451 
	`uc_”rÜ
("conditions‡re‚ot supported for v1 syntax");

452  -
EINVAL
;

455 ià(
	`¢d_cÚfig_g‘_ty³
(
cÚd
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

456 
	`uc_”rÜ
("compoundypeƒxpected for If");

457  -
EINVAL
;

460 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
cÚd
) {

461 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

462 
befÜe
 = 
aá”
 = 
NULL
;

463 
”r
 = 
	`if_ev®_Úe
(
uc_mgr
, 
n
, &
a
, &
befÜe
, &
aá”
);

464 ià(
”r
 < 0)

465  
”r
;

466 ià(
a
 =ğ
NULL
)

468 
”r
 = 
	`uc_mgr_ev®u©e_š¶aû
(
uc_mgr
, 
a
);

469 ià(
”r
 < 0)

470  
”r
;

471 
”r
 = 
	`uc_mgr_cÚfig_Œ“_m”ge
(
uc_mgr
, 
·»Á
, 
a
, 
befÜe
, 
aá”
);

472 ià(
”r
 < 0)

473  
”r
;

474 
	`¢d_cÚfig_d–‘e
(
a
);

477 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_confdoc.h

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_exec.c

30 
	~"ucm_loÿl.h
"

31 
	~<sys/¡©.h
>

32 
	~<sys/wa™.h
>

33 
	~<lim™s.h
>

34 
	~<dœ’t.h
>

36 #ià
defšed
(
__N‘BSD__
è|| defšed(
__O³nBSD__
è|| defšed(
__F»eBSD__
è|| defšed(
__D¿gÚFly__
)

37 
	~<sigÇl.h
>

38 #ià
defšed
(
__D¿gÚFly__
)

39 
	#’vœÚ
 
NULL


	)

41 **
’vœÚ
;

45 
±h»ad_mu‹x_t
 
	gfÜk_lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

50 
	$fšd_exec
(cÚ¡ *
Çme
, *
out
, 
size_t
 
Ën
)

52 
»t
 = 0;

53 
bš
[
PATH_MAX
];

54 *
·th
, *
tmp
, *
tmp2
 = 
NULL
;

55 
DIR
 *
dœ
;

56 
dœ’t64
 *
de
;

57 
¡©64
 
¡
;

58 ià(
Çme
[0] == '/') {

59 ià(
	`l¡©64
(
Çme
, &
¡
))

61 ià(!
	`S_ISREG
(
¡
.
¡_mode
è|| !(¡.¡_mod& 
S_IEXEC
))

63 
	`¢d_¡¾ıy
(
out
, 
Çme
, 
Ën
);

66 ià(!(
tmp
 = 
	`g‘’v
("PATH")))

68 
·th
 = 
	`®loÿ
(
	`¡¾’
(
tmp
) + 1);

69 ià(!
·th
)

71 
	`¡rıy
(
·th
, 
tmp
);

72 
tmp
 = 
	`¡¹ok_r
(
·th
, ":", &
tmp2
);

73 
tmp
 && !
»t
) {

74 ià((
dœ
 = 
	`İ’dœ
(
tmp
))) {

75 (
de
 = 
	`»addœ64
(
dœ
))) {

76 ià(
	`¡r¡r
(
de
->
d_Çme
, 
Çme
) != de->d_name)

78 
	`¢´štf
(
bš
, (bš), "%s/%s", 
tmp
,

79 
de
->
d_Çme
);

80 ià(
	`l¡©64
(
bš
, &
¡
))

82 ià(!
	`S_ISREG
(
¡
.
¡_mode
)

83 || !(
¡
.
¡_mode
 & 
S_IEXEC
))

85 
	`¢d_¡¾ıy
(
out
, 
bš
, 
Ën
);

86 
	`şo£dœ
(
dœ
);

89 
	`şo£dœ
(
dœ
);

91 
tmp
 = 
	`¡¹ok_r
(
NULL
, ":", &
tmp2
);

93  
»t
;

94 
	}
}

96 
	$ä“_¬gs
(**
¬gv
)

98 **
a
;

100 
a
 = 
¬gv
; *a;‡++)

101 
	`ä“
(*
a
);

102 
	`ä“
(
¬gv
);

103 
	}
}

105 
	$·r£_¬gs
(***
¬gv
, 
¬gc
, cÚ¡ *
cmd
)

107 *
s
, *
f
;

108 
i
 = 0, 
l
, 
eow
;

110 ià(!
¬gv
 || !
cmd
)

113 
s
 = 
	`®loÿ
(
	`¡¾’
(
cmd
) + 1);

114 ià(!
s
)

116 
	`¡rıy
(
s
, 
cmd
);

117 *
¬gv
 = 
	`ÿÎoc
(
¬gc
, (*));

119 *
s
 && 
i
 < 
¬gc
 - 1) {

120 *
s
 == ' ')

121 
s
++;

122 
f
 = 
s
;

123 
eow
 = 0;

124 *
s
) {

125 ià(*
s
 == '\\') {

126 
l
 = *(
s
 + 1);

127 ià(
l
 == 'b')

128 
l
 = '\b';

129 ià(
l
 == 'f')

130 
l
 = '\f';

131 ià(
l
 == 'n')

132 
l
 = '\n';

133 ià(
l
 == 'r')

134 
l
 = '\r';

135 ià(
l
 == 't')

136 
l
 = '\t';

138 
l
 = 0;

139 ià(
l
) {

140 *
s
++ = 
l
;

141 
	`memmove
(
s
, s + 1, 
	`¡¾’
(s));

143 
	`memmove
(
s
, s + 1, 
	`¡¾’
(s));

144 ià(*
s
)

145 
s
++;

147 } ià(
eow
) {

148 ià(*
s
 =ğ
eow
) {

149 
	`memmove
(
s
, s + 1, 
	`¡¾’
(s));

150 
eow
 = 0;

152 
s
++;

154 } ià(*
s
 == '\'' || *s == '"') {

155 
eow
 = *
s
;

156 
	`memmove
(
s
, s + 1, 
	`¡¾’
(s));

157 } ià(*
s
 == ' ') {

160 
s
++;

163 ià(
f
 !ğ
s
) {

164 ià(*
s
) {

165 *(*)
s
 = '\0';

166 
s
++;

168 (*
¬gv
)[
i
] = 
	`¡rdup
(
f
);

169 ià((*
¬gv
)[
i
] =ğ
NULL
) {

170 
	`ä“_¬gs
(*
¬gv
);

171  -
ENOMEM
;

173 
i
++;

176 (*
¬gv
)[
i
] = 
NULL
;

178 
	}
}

184 
	$uc_mgr_exec
(cÚ¡ *
´og
)

186 
pid_t
 
p
, 
f
, 
maxfd
;

187 
”r
 = 0, 
¡©us
;

188 
bš
[
PATH_MAX
];

189 
sigaùiÚ
 
§
;

190 
sigaùiÚ
 
šŒ
, 
qu™
;

191 
sig£t_t
 
omask
;

192 **
¬gv
;

194 ià(
	`·r£_¬gs
(&
¬gv
, 32, 
´og
))

195  -
EINVAL
;

197 
´og
 = 
¬gv
[0];

198 ià(
´og
 =ğ
NULL
) {

199 
”r
 = -
EINVAL
;

200 
__”rÜ
;

202 ià(
´og
[0] != '/' &&…rog[0] != '.') {

203 ià(!
	`fšd_exec
(
¬gv
[0], 
bš
, (bin))) {

204 
”r
 = -
ENOEXEC
;

205 
__”rÜ
;

207 
´og
 = 
bš
;

210 
maxfd
 = 
	`syscÚf
(
_SC_OPEN_MAX
);

217 
	`mem£t
(&
§
, 0, (sa));

218 
§
.
§_hªdËr
 = 
SIG_IGN
;

219 
	`sigem±y£t
(&
§
.
§_mask
);

220 
	`sigadd£t
(&
§
.
§_mask
, 
SIGCHLD
);

222 
	`±h»ad_mu‹x_lock
(&
fÜk_lock
);

224 
	`sig´ocmask
(
SIG_BLOCK
, &
§
.
§_mask
, &
omask
);

226 
	`sigaùiÚ
(
SIGINT
, &
§
, &
šŒ
);

227 
	`sigaùiÚ
(
SIGQUIT
, &
§
, &
qu™
);

229 
p
 = 
	`fÜk
();

231 ià(
p
 == -1) {

232 
”r
 = -
”ºo
;

233 
	`±h»ad_mu‹x_uÆock
(&
fÜk_lock
);

234 
	`uc_”rÜ
("UÇbËØfÜk(èfÜ \"%s\" -- %s", 
´og
,

235 
	`¡»¼Ü
(
”ºo
));

236 
__”rÜ
;

239 ià(
p
 == 0) {

240 
f
 = 
	`İ’
("/dev/nuÎ", 
O_RDWR
);

241 ià(
f
 == -1) {

242 
	`uc_”rÜ
("pid %d cannot open /dev/null for„edirect %s -- %s",

243 
	`g‘pid
(), 
´og
, 
	`¡»¼Ü
(
”ºo
));

244 
	`ex™
(1);

247 
	`şo£
(0);

248 
	`şo£
(1);

249 
	`şo£
(2);

251 
	`dup2
(
f
, 0);

252 
	`dup2
(
f
, 1);

253 
	`dup2
(
f
, 2);

255 
	`şo£
(
f
);

257 
f
 = 3; f < 
maxfd
; f++)

258 
	`şo£
(
f
);

261 
	`sigÇl
(
SIGINT
, 
SIG_DFL
);

262 
	`sigÇl
(
SIGQUIT
, 
SIG_DFL
);

264 
	`execve
(
´og
, 
¬gv
, 
’vœÚ
);

265 
	`ex™
(1);

268 
	`sigaùiÚ
(
SIGINT
, &
šŒ
, 
NULL
);

269 
	`sigaùiÚ
(
SIGQUIT
, &
qu™
, 
NULL
);

270 
	`sig´ocmask
(
SIG_SETMASK
, &
omask
, 
NULL
);

272 
	`±h»ad_mu‹x_uÆock
(&
fÜk_lock
);

277 
	`£gid
(
p
,…);

280 
f
 = 
	`wa™pid
(
p
, &
¡©us
, 0);

281 ià(
f
 == -1) {

282 ià(
”ºo
 =ğ
EAGAIN
)

284 
”r
 = -
”ºo
;

285 
__”rÜ
;

287 ià(
	`WIFSIGNALED
(
¡©us
)) {

288 
”r
 = -
EINTR
;

291 ià(
	`WIFEXITED
(
¡©us
)) {

292 
”r
 = 
	`WEXITSTATUS
(
¡©us
);

297 
__”rÜ
:

298 
	`ä“_¬gs
(
¬gv
);

299  
”r
;

300 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_include.c

27 
	~"ucm_loÿl.h
"

29 
	$g‘_¡ršg
(
¢d_cÚfig_t
 *
compound
, cÚ¡ *
key
, cÚ¡ **
¡r
)

31 
¢d_cÚfig_t
 *
node
;

32 
”r
;

34 
”r
 = 
	`¢d_cÚfig_£¬ch
(
compound
, 
key
, &
node
);

35 ià(
”r
 < 0)

36  
”r
;

37  
	`¢d_cÚfig_g‘_¡ršg
(
node
, 
¡r
);

38 
	}
}

40 
	$šşude_ev®_Úe
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

41 
¢d_cÚfig_t
 *
šc
,

42 
¢d_cÚfig_t
 **
»suÉ
,

43 
¢d_cÚfig_t
 **
befÜe
,

44 
¢d_cÚfig_t
 **
aá”
)

46 cÚ¡ *
fe
;

47 *
s
;

48 
”r
;

50 *
»suÉ
 = 
NULL
;

52 ià(
	`¢d_cÚfig_g‘_ty³
(
šc
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

53 
	`uc_”rÜ
("compoundypeƒxpected for Include.1");

54  -
EINVAL
;

57 
”r
 = 
	`g‘_¡ršg
(
šc
, "Fe", &
fe
);

58 ià(
”r
 < 0) {

59 
	`uc_”rÜ
("fileƒxpected (Include)");

60  -
EINVAL
;

63 
”r
 = 
	`¢d_cÚfig_£¬ch
(
šc
, "BefÜe", 
befÜe
);

64 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

65 
	`uc_”rÜ
("before block identifierƒrror");

66  -
EINVAL
;

69 
”r
 = 
	`¢d_cÚfig_£¬ch
(
šc
, "Aá”", 
aá”
);

70 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
) {

71 
	`uc_”rÜ
("before block identifierƒrror");

72  -
EINVAL
;

75 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s
, 
fe
);

76 ià(
”r
 < 0)

77  
”r
;

78 
”r
 = 
	`uc_mgr_cÚfig_lßd_fe
(
uc_mgr
, 
s
, 
»suÉ
);

79 
	`ä“
(
s
);

80  
”r
;

81 
	}
}

84 
	$cÚfig_dump
(
¢d_cÚfig_t
 *
cfg
)

86 
¢d_ouut_t
 *
out
;

87 
	`¢d_ouut_¡dio_©ch
(&
out
, 
¡d”r
, 0);

88 
	`¢d_ouut_´štf
(
out
, "-----\n");

89 
	`¢d_cÚfig_§ve
(
cfg
, 
out
);

90 
	`¢d_ouut_şo£
(
out
);

91 
	}
}

94 
	$fšd_pos™iÚ_node
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

95 
¢d_cÚfig_t
 **
»s
, snd_cÚfig_ˆ*
d¡
,

96 cÚ¡ *
id
, 
¢d_cÚfig_t
 *
pos
)

98 cÚ¡ *
s
;

99 *
s1
;

100 
”r
;

102 
”r
 = 
	`g‘_¡ršg
(
pos
, 
id
, &
s
);

103 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
)

104  
”r
;

105 ià(
”r
 == 0) {

106 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s1
, 
s
);

107 ià(
”r
 < 0)

108  
”r
;

109 
”r
 = 
	`¢d_cÚfig_£¬ch
(
d¡
, 
s1
, 
»s
);

110 
	`ä“
(
s1
);

111 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENOENT
)

112  
”r
;

115 
	}
}

117 
	$m”ge_™
(
¢d_cÚfig_t
 *
d¡
, snd_cÚfig_ˆ*
n
, snd_cÚfig_ˆ**
_dn
)

119 
¢d_cÚfig_t
 *
dn
;

120 cÚ¡ *
id
;

121 
”r
;

123 
”r
 = 
	`¢d_cÚfig_g‘_id
(
n
, &
id
);

124 ià(
”r
 < 0)

125  
”r
;

126 
”r
 = 
	`¢d_cÚfig_£¬ch
(
d¡
, 
id
, &
dn
);

127 ià(
”r
 < 0)

128  
”r
;

129 
”r
 = 
	`¢d_cÚfig_m”ge
(
dn
, 
n
, 0);

130 ià(
”r
 < 0)

131 
	`¢d_cÚfig_d–‘e
(
n
);

133 *
_dn
 = 
dn
;

134  
”r
;

135 
	}
}

137 
	$compound_m”ge
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
id
,

138 
¢d_cÚfig_t
 *
d¡
, snd_cÚfig_ˆ*
¤c
,

139 
¢d_cÚfig_t
 *
befÜe
, snd_cÚfig_ˆ*
aá”
)

141 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

142 
¢d_cÚfig_t
 *
n
, *
_befÜe
 = 
NULL
, *
_aá”
 = NULL;

143 
tmpid
[32];

144 
”r
, 
¬¿y
, 
idx
;

146 ià(
	`¢d_cÚfig_g‘_ty³
(
¤c
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

147 
	`uc_”rÜ
("compoundypeƒxpected forhe merged block");

148  -
EINVAL
;

151 ià(
befÜe
) {

152 
”r
 = 
	`fšd_pos™iÚ_node
(
uc_mgr
, &
_befÜe
, 
d¡
, 
id
, 
befÜe
);

153 ià(
”r
 < 0)

154  
”r
;

156 ià(
aá”
) {

157 
”r
 = 
	`fšd_pos™iÚ_node
(
uc_mgr
, &
_aá”
, 
d¡
, 
id
, 
aá”
);

158 ià(
”r
 < 0)

159  
”r
;

163 ià(!
_befÜe
 && !
_aá”
)

164  
	`¢d_cÚfig_m”ge
(
d¡
, 
¤c
, 0);

166 ià(
_befÜe
 && 
_aá”
) {

167 
	`uc_”rÜ
("defined both before‡nd‡fter identifiers inhe If or Include block");

168  -
EINVAL
;

171 
¬¿y
 = 
	`¢d_cÚfig_is_¬¿y
(
d¡
);

172 ià(
¬¿y
 < 0) {

173 
	`uc_”rÜ
("destination configuration‚ode is‚ot‡ compound");

174  
¬¿y
;

176 ià(
¬¿y
 && 
	`¢d_cÚfig_is_¬¿y
(
¤c
) <= 0) {

177 
	`uc_”rÜ
("source configuration‚ode is‚ot‡n‡rray");

178  -
EINVAL
;

181 
idx
 = 0;

184 ià(
¬¿y
 > 0) {

185 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
d¡
) {

186 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

187 
	`¢´štf
(
tmpid
, Ñmpid), "_tmp_%d", 
idx
++);

188 
”r
 = 
	`¢d_cÚfig_£t_id
(
n
, 
tmpid
);

189 ià(
”r
 < 0)

190  
”r
;

194 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
¤c
) {

195 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

196 
”r
 = 
	`¢d_cÚfig_»move
(
n
);

197 ià(
”r
 < 0)

198  
”r
;

200 ià(
¬¿y
 > 0) {

201 
	`¢´štf
(
tmpid
, Ñmpid), "_tmp_%d", 
idx
++);

202 
”r
 = 
	`¢d_cÚfig_£t_id
(
n
, 
tmpid
);

203 ià(
”r
 < 0)

204  
”r
;

206 ià(
_befÜe
) {

207 
”r
 = 
	`¢d_cÚfig_add_befÜe
(
_befÜe
, 
n
);

208 ià(
”r
 =ğ-
EEXIST
)

209 
”r
 = 
	`m”ge_™
(
d¡
, 
n
, &n);

210 ià(
”r
 < 0)

211  
”r
;

212 
_befÜe
 = 
NULL
;

213 
_aá”
 = 
n
;

214 } ià(
_aá”
) {

215 
”r
 = 
	`¢d_cÚfig_add_aá”
(
_aá”
, 
n
);

216 ià(
”r
 =ğ-
EEXIST
)

217 
”r
 = 
	`m”ge_™
(
d¡
, 
n
, &n);

218 ià(
”r
 < 0)

219  
”r
;

220 
_aá”
 = 
n
;

225 ià(
¬¿y
 > 0) {

226 
idx
 = 0;

227 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
d¡
) {

228 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

229 
	`¢´štf
(
tmpid
, Ñmpid), "%d", 
idx
++);

230 
”r
 = 
	`¢d_cÚfig_£t_id
(
n
, 
tmpid
);

231 ià(
”r
 < 0)

232  
”r
;

236 
	`¢d_cÚfig_d–‘e
(
¤c
);

238 
	}
}

240 
	$uc_mgr_cÚfig_Œ“_m”ge
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

241 
¢d_cÚfig_t
 *
·»Á
, snd_cÚfig_ˆ*
Ãw_ùx
,

242 
¢d_cÚfig_t
 *
befÜe
, snd_cÚfig_ˆ*
aá”
)

244 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

245 
¢d_cÚfig_t
 *
n
, *
·»Á2
;

246 cÚ¡ *
id
;

247 
”r
;

249 
”r
 = 
	`uc_mgr_sub¡™u‹_Œ“
(
uc_mgr
, 
Ãw_ùx
);

250 ià(
”r
 < 0)

251  
”r
;

253 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
Ãw_ùx
) {

254 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

255 
”r
 = 
	`¢d_cÚfig_»move
(
n
);

256 ià(
”r
 < 0)

257  
”r
;

258 
”r
 = 
	`¢d_cÚfig_g‘_id
(
n
, &
id
);

259 ià(
”r
 < 0) {

260 
__add
:

261 
”r
 = 
	`¢d_cÚfig_add
(
·»Á
, 
n
);

262 ià(
”r
 < 0)

263  
”r
;

265 
”r
 = 
	`¢d_cÚfig_£¬ch
(
·»Á
, 
id
, &
·»Á2
);

266 ià(
”r
 =ğ-
ENOENT
)

267 
__add
;

268 
”r
 = 
	`compound_m”ge
(
uc_mgr
, 
id
, 
·»Á2
, 
n
, 
befÜe
, 
aá”
);

269 ià(
”r
 < 0) {

270 
	`¢d_cÚfig_d–‘e
(
n
);

271  
”r
;

276 
	}
}

281 
	$uc_mgr_ev®u©e_šşude
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

282 
¢d_cÚfig_t
 *
·»Á
,

283 
¢d_cÚfig_t
 *
šc
)

285 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

286 
¢d_cÚfig_t
 *
a
, *
n
, *
befÜe
, *
aá”
;

287 
”r
;

289 ià(
uc_mgr
->
cÚf_fÜm©
 < 3) {

290 
	`uc_”rÜ
("in-place include is supported in v3+ syntax");

291  -
EINVAL
;

294 ià(
	`¢d_cÚfig_g‘_ty³
(
šc
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

295 
	`uc_”rÜ
("compoundypeƒxpected for Include");

296  -
EINVAL
;

299 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
šc
) {

300 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

301 
befÜe
 = 
aá”
 = 
NULL
;

302 
”r
 = 
	`šşude_ev®_Úe
(
uc_mgr
, 
n
, &
a
, &
befÜe
, &
aá”
);

303 ià(
”r
 < 0)

304  
”r
;

305 ià(
a
 =ğ
NULL
)

307 
”r
 = 
	`uc_mgr_ev®u©e_š¶aû
(
uc_mgr
, 
a
);

308 ià(
”r
 < 0) {

309 
	`¢d_cÚfig_d–‘e
(
a
);

310  
”r
;

312 
”r
 = 
	`uc_mgr_cÚfig_Œ“_m”ge
(
uc_mgr
, 
·»Á
, 
a
, 
befÜe
, 
aá”
);

313 
	`¢d_cÚfig_d–‘e
(
a
);

314 ià(
”r
 < 0)

315  
”r
;

318 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_local.h

36 
	#UC_MGR_DEBUG


	)

39 
	~"loÿl.h
"

40 
	~<±h»ad.h
>

41 
	~"u£-ÿ£.h
"

43 
	#SYNTAX_VERSION_MAX
 7

	)

45 
	#MAX_CARD_SHORT_NAME
 32

	)

46 
	#MAX_CARD_LONG_NAME
 80

	)

48 
	#SEQUENCE_ELEMENT_TYPE_CDEV
 1

	)

49 
	#SEQUENCE_ELEMENT_TYPE_CSET
 2

	)

50 
	#SEQUENCE_ELEMENT_TYPE_SLEEP
 3

	)

51 
	#SEQUENCE_ELEMENT_TYPE_EXEC
 4

	)

52 
	#SEQUENCE_ELEMENT_TYPE_SHELL
 5

	)

53 
	#SEQUENCE_ELEMENT_TYPE_CSET_BIN_FILE
 6

	)

54 
	#SEQUENCE_ELEMENT_TYPE_CSET_TLV
 7

	)

55 
	#SEQUENCE_ELEMENT_TYPE_CSET_NEW
 8

	)

56 
	#SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
 9

	)

57 
	#SEQUENCE_ELEMENT_TYPE_CMPT_SEQ
 10

	)

58 
	#SEQUENCE_ELEMENT_TYPE_SYSSET
 11

	)

59 
	#SEQUENCE_ELEMENT_TYPE_CFGSAVE
 12

	)

60 
	#SEQUENCE_ELEMENT_TYPE_DEV_ENABLE_SEQ
 13

	)

61 
	#SEQUENCE_ELEMENT_TYPE_DEV_DISABLE_SEQ
 14

	)

62 
	#SEQUENCE_ELEMENT_TYPE_DEV_DISABLE_ALL
 15

	)

64 
	sucm_v®ue
 {

65 
li¡_h—d
 
	mli¡
;

66 *
	mÇme
;

67 *
	md©a
;

71 
	scompÚ’t_£qu’û
 {

72 
u£_ÿ£_deviû
 *
	mdeviû
;

73 
	m’abË
;

76 
	s£qu’û_–em’t
 {

77 
li¡_h—d
 
	mli¡
;

78 
	mty³
;

80 
	m¦“p
;

81 *
	mcdev
;

82 *
	mc£t
;

83 *
	mexec
;

84 *
	msysw
;

85 *
	mcfg§ve
;

86 *
	mdeviû
;

87 
compÚ’t_£qu’û
 
	mcm±_£q
;

88 } 
	md©a
;

94 
	sŒªs™iÚ_£qu’û
 {

95 
li¡_h—d
 
	mli¡
;

96 *
	mÇme
;

97 
li¡_h—d
 
	mŒªs™iÚ_li¡
;

103 
	edev_li¡_ty³
 {

104 
	mDEVLIST_NONE
,

105 
	mDEVLIST_SUPPORTED
,

106 
	mDEVLIST_CONFLICTING


109 
	sdev_li¡_node
 {

110 
li¡_h—d
 
	mli¡
;

111 *
	mÇme
;

114 
	sdev_li¡
 {

115 
dev_li¡_ty³
 
	mty³
;

116 
li¡_h—d
 
	mli¡
;

119 
	sùl_dev
 {

120 
li¡_h—d
 
	mli¡
;

121 *
	mdeviû
;

124 
	sùl_li¡
 {

125 
li¡_h—d
 
	mli¡
;

126 
li¡_h—d
 
	mdev_li¡
;

127 
¢d_ùl_t
 *
	mùl
;

128 
¢d_ùl_ÿrd_šfo_t
 *
	mùl_šfo
;

129 
	m¦ave
;

130 
	mucm_group
;

133 
	sucm_dev_Çme
 {

134 
li¡_h—d
 
	mli¡
;

135 *
	mÇme1
;

136 *
	mÇme2
;

143 
	su£_ÿ£_modif›r
 {

144 
li¡_h—d
 
	mli¡
;

145 
li¡_h—d
 
	maùive_li¡
;

147 *
	mÇme
;

148 *
	mcomm’t
;

151 
li¡_h—d
 
	m’abË_li¡
;

152 
li¡_h—d
 
	mdi§bË_li¡
;

155 
li¡_h—d
 
	mŒªs™iÚ_li¡
;

158 
dev_li¡
 
	mdev_li¡
;

161 
li¡_h—d
 
	mv®ue_li¡
;

168 
	su£_ÿ£_deviû
 {

169 
li¡_h—d
 
	mli¡
;

170 
li¡_h—d
 
	maùive_li¡
;

172 *
	mÇme
;

173 *
	mcomm’t
;

176 
li¡_h—d
 
	m’abË_li¡
;

177 
li¡_h—d
 
	mdi§bË_li¡
;

180 
li¡_h—d
 
	mŒªs™iÚ_li¡
;

183 
dev_li¡
 
	mdev_li¡
;

186 
li¡_h—d
 
	mv®ue_li¡
;

193 
	su£_ÿ£_v”b
 {

194 
li¡_h—d
 
	mli¡
;

196 
	maùive
: 1;

198 *
	mÇme
;

199 *
	mcomm’t
;

202 
li¡_h—d
 
	m’abË_li¡
;

203 
li¡_h—d
 
	mdi§bË_li¡
;

206 
li¡_h—d
 
	mŒªs™iÚ_li¡
;

208 
li¡_h—d
 
	mdeviû_li¡
;

211 
li¡_h—d
 
	mcm±_deviû_li¡
;

214 
li¡_h—d
 
	mmodif›r_li¡
;

217 
li¡_h—d
 
	mv®ue_li¡
;

220 
li¡_h—d
 
	m»Çme_li¡
;

221 
li¡_h—d
 
	m»move_li¡
;

227 
	s¢d_u£_ÿ£_mgr
 {

228 *
	mÿrd_Çme
;

229 *
	mcÚf_fe_Çme
;

230 *
	mcÚf_dœ_Çme
;

231 *
	mcomm’t
;

232 
	mcÚf_fÜm©
;

233 
	mucm_ÿrd_numb”
;

234 
	msuµ»ss_nodev_”rÜs
;

235 cÚ¡ *
	m·r£_v¬ŸÁ
;

236 
	m·r£_ma¡”_£ùiÚ
;

237 
	m£qu’û_hİs
;

240 
li¡_h—d
 
	mÿrds_li¡
;

243 
li¡_h—d
 
	mv”b_li¡
;

246 
li¡_h—d
 
	mfixedboÙ_li¡
;

249 
li¡_h—d
 
	mboÙ_li¡
;

252 
li¡_h—d
 
	mdeçuÉ_li¡
;

253 
	mdeçuÉ_li¡_execu‹d
;

256 
li¡_h—d
 
	mv®ue_li¡
;

259 
u£_ÿ£_v”b
 *
	maùive_v”b
;

260 
li¡_h—d
 
	maùive_deviûs
;

261 
li¡_h—d
 
	maùive_modif›rs
;

264 
±h»ad_mu‹x_t
 
	mmu‹x
;

267 
li¡_h—d
 
	mv¬ŸbË_li¡
;

270 
li¡_h—d
 
	mùl_li¡
;

273 
¢d_cÚfig_t
 *
	mmaüos
;

274 
	mmaüo_hİs
;

277 
¢d_cÚfig_t
 *
	mloÿl_cÚfig
;

284 
	mš_compÚ’t_domaš
;

285 *
	mcdev
;

288 
	#uc_”rÜ
 
SNDERR


	)

290 #ifdeà
UC_MGR_DEBUG


291 
	#uc_dbg
 
SNDERR


	)

293 
	#uc_dbg
(
fmt
, 
¬g
...èdØ{ } 0)

	)

296 
uc_mgr_”rÜ
(cÚ¡ *
fmt
, ...);

297 
uc_mgr_¡dout
(cÚ¡ *
fmt
, ...);

299 cÚ¡ *
uc_mgr_sysfs_roÙ
();

300 cÚ¡ *
uc_mgr_cÚfig_dœ
(
fÜm©
);

301 
uc_mgr_cÚfig_lßd_što
(
fÜm©
, cÚ¡ *
fe
, 
¢d_cÚfig_t
 *
cfg
);

302 
uc_mgr_cÚfig_lßd
(
fÜm©
, cÚ¡ *
fe
, 
¢d_cÚfig_t
 **
cfg
);

303 
uc_mgr_cÚfig_lßd_fe
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
fe
, 
¢d_cÚfig_t
 **
cfg
);

304 
uc_mgr_impÜt_ma¡”_cÚfig
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
);

305 
uc_mgr_sÿn_ma¡”_cÚfigs
(cÚ¡ **
_li¡
[]);

307 
uc_mgr_put_to_dev_li¡
(
dev_li¡
 *dev_li¡, cÚ¡ *
Çme
);

308 
uc_mgr_»move_deviû
(
u£_ÿ£_v”b
 *
v”b
, cÚ¡ *
Çme
);

309 
uc_mgr_»Çme_deviû
(
u£_ÿ£_v”b
 *
v”b
, cÚ¡ *
¤c
,

310 cÚ¡ *
d¡
);

312 
uc_mgr_ä“_dev_Çme_li¡
(
li¡_h—d
 *
ba£
);

313 
uc_mgr_ä“_£qu’û_–em’t
(
£qu’û_–em’t
 *
£q
);

314 
uc_mgr_ä“_Œªs™iÚ_–em’t
(
Œªs™iÚ_£qu’û
 *
£q
);

315 
uc_mgr_ä“_v”b
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
);

316 
uc_mgr_ä“
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
);

318 
šlše
 
	$uc_mgr_has_loÿl_cÚfig
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

320  
uc_mgr
 && 
	`¢d_cÚfig_™”©Ü_fœ¡
(uc_mgr->
loÿl_cÚfig
) !=

321 
	`¢d_cÚfig_™”©Ü_’d
(
uc_mgr
->
loÿl_cÚfig
);

322 
	}
}

324 
uc_mgr_ÿrd_İ’
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
);

325 
uc_mgr_ÿrd_şo£
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
);

327 
uc_mgr_İ’_ùl
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

328 
ùl_li¡
 **ctl_list,

329 cÚ¡ *
deviû
,

330 
¦ave
);

332 
ùl_li¡
 *
uc_mgr_g‘_ma¡”_ùl
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
);

333 
ùl_li¡
 *
uc_mgr_g‘_ùl_by_ÿrd
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
ÿrd
);

334 
ùl_li¡
 *
uc_mgr_g‘_ùl_by_Çme
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

335 cÚ¡ *
Çme
, 
idx
);

336 
¢d_ùl_t
 *
uc_mgr_g‘_ùl
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
);

337 
uc_mgr_ä“_ùl_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
);

339 
uc_mgr_add_v®ue
(
li¡_h—d
 *
ba£
, cÚ¡ *
key
, *
v®
);

341 cÚ¡ *
uc_mgr_g‘_v¬ŸbË
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

342 cÚ¡ *
Çme
);

344 
uc_mgr_£t_v¬ŸbË
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

345 cÚ¡ *
Çme
,

346 cÚ¡ *
v®
);

348 
uc_mgr_d–‘e_v¬ŸbË
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
Çme
);

350 
uc_mgr_g‘_sub¡™u‹d_v®ue
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

351 **
_rv®ue
,

352 cÚ¡ *
v®ue
);

354 
uc_mgr_sub¡™u‹_Œ“
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

355 
¢d_cÚfig_t
 *
node
);

357 
uc_mgr_cÚfig_Œ“_m”ge
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

358 
¢d_cÚfig_t
 *
·»Á
, snd_cÚfig_ˆ*
Ãw_ùx
,

359 
¢d_cÚfig_t
 *
befÜe
, snd_cÚfig_ˆ*
aá”
);

361 
uc_mgr_ev®u©e_š¶aû
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

362 
¢d_cÚfig_t
 *
cfg
);

364 
uc_mgr_ev®u©e_šşude
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

365 
¢d_cÚfig_t
 *
·»Á
,

366 
¢d_cÚfig_t
 *
šc
);

368 
uc_mgr_ev®u©e_cÚd™iÚ
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

369 
¢d_cÚfig_t
 *
·»Á
,

370 
¢d_cÚfig_t
 *
cÚd
);

372 
uc_mgr_defše_»gex
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

373 cÚ¡ *
Çme
,

374 
¢d_cÚfig_t
 *
ev®
);

376 
uc_mgr_exec
(cÚ¡ *
´og
);

379 
	#ALSA_CONFIG_UCM_VAR
 "ALSA_CONFIG_UCM"

	)

382 
	#ALSA_CONFIG_UCM2_VAR
 "ALSA_CONFIG_UCM2"

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_regex.c

27 
	~"ucm_loÿl.h
"

28 
	~<ùy³.h
>

29 
	~<»gex.h
>

31 
	$g‘_¡ršg
(
¢d_cÚfig_t
 *
compound
, cÚ¡ *
key
, cÚ¡ **
¡r
)

33 
¢d_cÚfig_t
 *
node
;

34 
”r
;

36 
”r
 = 
	`¢d_cÚfig_£¬ch
(
compound
, 
key
, &
node
);

37 ià(
”r
 < 0)

38  
”r
;

39  
	`¢d_cÚfig_g‘_¡ršg
(
node
, 
¡r
);

40 
	}
}

42 *
	$exŒaù_sub¡ršg
(cÚ¡ *
d©a
, 
»gm©ch_t
 *
m©ch
)

44 *
s
;

45 
size_t
 
Ën
;

47 
Ën
 = 
m©ch
->
rm_eo
 - m©ch->
rm_so
;

48 
s
 = 
	`m®loc
(
Ën
 + 1);

49 ià(
s
 =ğ
NULL
)

50  
NULL
;

51 
	`memıy
(
s
, 
d©a
 + 
m©ch
->
rm_so
, 
Ën
);

52 
s
[
Ën
] = '\0';

53  
s
;

54 
	}
}

56 
	$£t_v¬ŸbËs
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
d©a
,

57 
m©ch_size
, 
»gm©ch_t
 *
m©ch
,

58 cÚ¡ *
Çme
)

60 
size_t
 
Çme2_Ën
 = 
	`¡¾’
(
Çme
) + 16;

61 *
Çme2
 = 
	`®loÿ
(
Çme2_Ën
);

62 *
s
;

63 
i
;

64 
”r
;

66 ià(
m©ch
[0].
rm_so
 < 0 || m©ch[0].
rm_eo
 < 0)

68 
s
 = 
	`exŒaù_sub¡ršg
(
d©a
, &
m©ch
[0]);

69 ià(
s
 =ğ
NULL
)

70  -
ENOMEM
;

71 
”r
 = 
	`uc_mgr_£t_v¬ŸbË
(
uc_mgr
, 
Çme
, 
s
);

72 
	`ä“
(
s
);

73 ià(
”r
 < 0)

74  
”r
;

75 
i
 = 1; i < 
m©ch_size
; i++) {

76 ià(
m©ch
[0].
rm_so
 < 0 || m©ch[0].
rm_eo
 < 0)

78 
s
 = 
	`exŒaù_sub¡ršg
(
d©a
, &
m©ch
[
i
]);

79 ià(
s
 =ğ
NULL
)

80  -
ENOMEM
;

81 
	`¢´štf
(
Çme2
, 
Çme2_Ën
, "%s%u", 
Çme
, 
i
);

82 
”r
 = 
	`uc_mgr_£t_v¬ŸbË
(
uc_mgr
, 
Çme2
, 
s
);

83 
	`ä“
(
s
);

84 ià(
”r
 < 0)

85  
”r
;

88 
	}
}

90 
	$uc_mgr_defše_»gex
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
Çme
,

91 
¢d_cÚfig_t
 *
ev®
)

93 cÚ¡ *
¡ršg
, *
»gex_¡ršg
, *
æags_¡ršg
;

94 *
s
;

95 
»gex_t
 
»
;

96 
İtiÚs
 = 0;

97 
»gm©ch_t
 
m©ch
[20];

98 
”r
;

100 ià(
uc_mgr
->
cÚf_fÜm©
 < 3) {

101 
	`uc_”rÜ
("define„egex is supported in v3+ syntax");

102  -
EINVAL
;

105 ià(
	`¢d_cÚfig_g‘_ty³
(
ev®
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

106 
	`uc_”rÜ
("compoundypeƒxpected for DefineRegex");

107  -
EINVAL
;

110 
”r
 = 
	`g‘_¡ršg
(
ev®
, "SŒšg", &
¡ršg
);

111 ià(
”r
 < 0) {

112 
	`uc_”rÜ
("DefineRegexƒrror (String)");

113  -
EINVAL
;

116 
”r
 = 
	`g‘_¡ršg
(
ev®
, "Regex", &
»gex_¡ršg
);

117 ià(
”r
 < 0) {

118 
	`uc_”rÜ
("DefineRegexƒrror (Regex string)");

119  -
EINVAL
;

122 
”r
 = 
	`g‘_¡ršg
(
ev®
, "FÏgs", &
æags_¡ršg
);

123 ià(
”r
 =ğ-
ENOENT
) {

124 
İtiÚs
 = 
REG_EXTENDED
;

125 } ià(
”r
 < 0) {

126 
	`uc_”rÜ
("DefineRegexƒrror (Flags string)");

127  -
EINVAL
;

129 *
æags_¡ršg
) {

130 
	`tŞow”
(*
æags_¡ršg
)) {

132 
İtiÚs
 |ğ
REG_EXTENDED
;

135 
İtiÚs
 |ğ
REG_ICASE
;

138 
İtiÚs
 |ğ
REG_NOSUB
;

141 
İtiÚs
 |ğ
REG_NEWLINE
;

144 
	`uc_”rÜ
("DefšeRegexƒ¼Ü (unknowÀæag '%c')", *
æags_¡ršg
);

145  -
EINVAL
;

147 
æags_¡ršg
++;

151 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s
, 
»gex_¡ršg
);

152 ià(
”r
 < 0)

153  
”r
;

154 
”r
 = 
	`»gcomp
(&
»
, 
s
, 
İtiÚs
);

155 
	`ä“
(
s
);

156 ià(
”r
) {

157 
	`uc_”rÜ
("Regex '%s' comp©iÚ faed (cod%d)", 
”r
);

158  -
EINVAL
;

161 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s
, 
¡ršg
);

162 ià(
”r
 < 0) {

163 
	`»gä“
(&
»
);

164  
”r
;

166 
”r
 = 
	`»gexec
(&
»
, 
s
, 
	`ARRAY_SIZE
(
m©ch
), match, 0);

167 ià(
”r
 < 0)

168 
”r
 = -
”ºo
;

169 ià(
”r
 =ğ
REG_NOMATCH
)

170 
”r
 = 0;

172 
”r
 = 
	`£t_v¬ŸbËs
(
uc_mgr
, 
s
, 
	`ARRAY_SIZE
(
m©ch
), m©ch, 
Çme
);

173 
	`ä“
(
s
);

174 
	`»gä“
(&
»
);

175  
”r
;

176 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_subs.c

27 
	~"ucm_loÿl.h
"

28 
	~<¡dboŞ.h
>

29 
	~<sys/¡©.h
>

30 
	~<lim™s.h
>

31 
	~<»gex.h
>

33 *
	$rv®_İ’_Çme
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

35 cÚ¡ *
Çme
;

36 ià(
uc_mgr
->
cÚf_fÜm©
 < 3)

37  
NULL
;

38 
Çme
 = 
uc_mgr
->
ÿrd_Çme
;

39 ià(
Çme
) {

40 ià(
	`¡ºcmp
(
Çme
, "strict:", 7) == 0)

41 
Çme
 += 7;

42  
	`¡rdup
(
Çme
);

44  
NULL
;

45 
	}
}

47 *
	$rv®_cÚf_libdœ
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

49 ià(
uc_mgr
->
cÚf_fÜm©
 < 4)

50  
NULL
;

51  
	`¡rdup
(
	`¢d_cÚfig_tİdœ
());

52 
	}
}

54 *
	$rv®_cÚf_tİdœ
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

56 cÚ¡ *
dœ
;

58 ià(
uc_mgr
->
cÚf_fÜm©
 < 3)

59  
NULL
;

60 
dœ
 = 
	`uc_mgr_cÚfig_dœ
(
uc_mgr
->
cÚf_fÜm©
);

61 ià(
dœ
 && dir[0])

62  
	`¡rdup
(
dœ
);

63  
NULL
;

64 
	}
}

66 *
	$rv®_cÚf_dœ
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

68 ià(
uc_mgr
->
cÚf_fÜm©
 < 3)

69  
NULL
;

70 ià(
uc_mgr
->
cÚf_dœ_Çme
 && uc_mgr->conf_dir_name[0])

71  
	`¡rdup
(
uc_mgr
->
cÚf_dœ_Çme
);

72  
NULL
;

73 
	}
}

75 *
	$rv®_cÚf_Çme
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

77 ià(
uc_mgr
->
cÚf_fe_Çme
 && uc_mgr->conf_file_name[0])

78  
	`¡rdup
(
uc_mgr
->
cÚf_fe_Çme
);

79  
NULL
;

80 
	}
}

82 *
	$g‘_ÿrd_numb”
(
ùl_li¡
 *ctl_list)

84 
num
[16];

86 ià(
ùl_li¡
 =ğ
NULL
)

87  
	`¡rdup
("");

88 
	`¢´štf
(
num
, Òum), "%i", 
	`¢d_ùl_ÿrd_šfo_g‘_ÿrd
(
ùl_li¡
->
ùl_šfo
));

89  
	`¡rdup
(
num
);

90 
	}
}

92 *
	$rv®_ÿrd_numb”
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

94 ià(
uc_mgr
->
cÚf_fÜm©
 < 3)

95  
NULL
;

96  
	`g‘_ÿrd_numb”
(
	`uc_mgr_g‘_ma¡”_ùl
(
uc_mgr
));

97 
	}
}

99 *
	$rv®_ÿrd_id
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

101 
ùl_li¡
 *ctl_list;

103 
ùl_li¡
 = 
	`uc_mgr_g‘_ma¡”_ùl
(
uc_mgr
);

104 ià(
ùl_li¡
 =ğ
NULL
)

105  
NULL
;

106  
	`¡rdup
(
	`¢d_ùl_ÿrd_šfo_g‘_id
(
ùl_li¡
->
ùl_šfo
));

107 
	}
}

109 *
	$rv®_ÿrd_driv”
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

111 
ùl_li¡
 *ctl_list;

113 
ùl_li¡
 = 
	`uc_mgr_g‘_ma¡”_ùl
(
uc_mgr
);

114 ià(
ùl_li¡
 =ğ
NULL
)

115  
NULL
;

116  
	`¡rdup
(
	`¢d_ùl_ÿrd_šfo_g‘_driv”
(
ùl_li¡
->
ùl_šfo
));

117 
	}
}

119 *
	$rv®_ÿrd_Çme
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

121 
ùl_li¡
 *ctl_list;

123 
ùl_li¡
 = 
	`uc_mgr_g‘_ma¡”_ùl
(
uc_mgr
);

124 ià(
ùl_li¡
 =ğ
NULL
)

125  
NULL
;

126  
	`¡rdup
(
	`¢d_ùl_ÿrd_šfo_g‘_Çme
(
ùl_li¡
->
ùl_šfo
));

127 
	}
}

129 *
	$rv®_ÿrd_lÚgÇme
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

131 
ùl_li¡
 *ctl_list;

133 
ùl_li¡
 = 
	`uc_mgr_g‘_ma¡”_ùl
(
uc_mgr
);

134 ià(
ùl_li¡
 =ğ
NULL
)

135  
NULL
;

136  
	`¡rdup
(
	`¢d_ùl_ÿrd_šfo_g‘_lÚgÇme
(
ùl_li¡
->
ùl_šfo
));

137 
	}
}

139 *
	$rv®_ÿrd_compÚ’ts
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

141 
ùl_li¡
 *ctl_list;

143 
ùl_li¡
 = 
	`uc_mgr_g‘_ma¡”_ùl
(
uc_mgr
);

144 ià(
ùl_li¡
 =ğ
NULL
)

145  
NULL
;

146  
	`¡rdup
(
	`¢d_ùl_ÿrd_šfo_g‘_compÚ’ts
(
ùl_li¡
->
ùl_šfo
));

147 
	}
}

149 
ùl_li¡
 *
	$g‘_ùl_li¡_by_Çme
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
id
)

151 *
Çme
, *
šdex
;

152 
idx
 = 0;

154 
Çme
 = 
	`®loÿ
(
	`¡¾’
(
id
) + 1);

155 
	`¡rıy
(
Çme
, 
id
);

156 
šdex
 = 
	`¡rchr
(
Çme
, '#');

157 ià(
šdex
) {

158 *
šdex
 = '\0';

159 ià(
	`§ã_¡¹Ş
(
šdex
 + 1, &
idx
))

160  
NULL
;

162  
	`uc_mgr_g‘_ùl_by_Çme
(
uc_mgr
, 
Çme
, 
idx
);

163 
	}
}

165 *
	$rv®_ÿrd_numb”_by_Çme
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
id
)

167 ià(
uc_mgr
->
cÚf_fÜm©
 < 3) {

168 
	`uc_”rÜ
("CardNumberByName substitution is supported in v3+ syntax");

169  
NULL
;

172 
	`uc_”rÜ
("${CardNumberByName} substitution is obsolete - use ${find-card}!");

174  
	`g‘_ÿrd_numb”
(
	`g‘_ùl_li¡_by_Çme
(
uc_mgr
, 
id
));

175 
	}
}

177 *
	$rv®_ÿrd_id_by_Çme
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
id
)

179 
ùl_li¡
 *ctl_list;

181 ià(
uc_mgr
->
cÚf_fÜm©
 < 3) {

182 
	`uc_”rÜ
("CardIdByName substitution is supported in v3+ syntax");

183  
NULL
;

186 
	`uc_”rÜ
("${CardIdByName} substitution is obsolete - use ${find-card}!");

188 
ùl_li¡
 = 
	`g‘_ùl_li¡_by_Çme
(
uc_mgr
, 
id
);

189 ià(
ùl_li¡
 =ğ
NULL
)

190  
NULL
;

191  
	`¡rdup
(
	`¢d_ùl_ÿrd_šfo_g‘_id
(
ùl_li¡
->
ùl_šfo
));

192 
	}
}

194 #iâdeà
DOC_HIDDEN


195 
	glookup_™”©e
 *(*
	tlookup_™”_fú_t
)

196 (
	t¢d_u£_ÿ£_mgr_t
 *
	tuc_mgr
, 
	tlookup_™”©e
 *
	t™”
);

197 cÚ¡ *(*
	tlookup_fú_t
)(*);

199 
	slookup_fú
 {

200 *
	mÇme
;

201 cÚ¡ *(*
	mfú
)(*
	mİaque
);

204 
	slookup_™”©e
 {

205 (*
	mš™
)(
¢d_u£_ÿ£_mgr_t
 *
	muc_mgr
, 
lookup_™”©e
 *
	m™”
,

206 
¢d_cÚfig_t
 *
	mcÚfig
);

207 (*
	mdÚe
)(
lookup_™”©e
 *
	m™”
);

208 
lookup_™”_fú_t
 
	mfœ¡
;

209 
lookup_™”_fú_t
 
	mÃxt
;

210 *(*
	m»tfú
)(
lookup_™”©e
 *
	m™”
, 
¢d_cÚfig_t
 *
	mcÚfig
);

211 
lookup_fú
 *
	mfús
;

212 
lookup_fú_t
 
	mfú
;

213 
ùl_li¡
 *
	mùl_li¡
;

214 *
	mšfo
;

218 *
	$rv®_lookup_maš
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

219 cÚ¡ *
qu”y
,

220 
lookup_™”©e
 *
™”
)

222 
¢d_cÚfig_t
 *
cÚfig
, *
d
;

223 
lookup_fú
 *
fú
;

224 
lookup_™”©e
 *
cu¼
;

225 cÚ¡ *
s
;

226 *
»suÉ
;

227 
»gm©ch_t
 
m©ch
[1];

228 
»gex_t
 
»
;

229 
”r
;

231 ià(
uc_mgr
->
cÚf_fÜm©
 < 4) {

232 
	`uc_”rÜ
("Lookups‡re supported in v4+ syntax");

233  
NULL
;

236 
”r
 = 
	`¢d_cÚfig_lßd_¡ršg
(&
cÚfig
, 
qu”y
, 0);

237 ià(
”r
 < 0) {

238 
	`uc_”rÜ
("Thlooku°¬gum’t '%s'‡» inv®id", 
qu”y
);

239  
NULL
;

241 ià(
™”
->
š™
 && i‹r->
	`š™
(
uc_mgr
, i‹r, 
cÚfig
))

242 
nuÎ
;

243 ià(
	`¢d_cÚfig_£¬ch
(
cÚfig
, "f›ld", &
d
)) {

244 
	`uc_”rÜ
("Lookups„equire field!");

245 
nuÎ
;

247 ià(
	`¢d_cÚfig_g‘_¡ršg
(
d
, &
s
))

248 
nuÎ
;

249 
fú
 = 
™”
->
fús
 ; fcn; fcn++) {

250 ià(
	`¡rÿ£cmp
(
fú
->
Çme
, 
s
) == 0) {

251 
™”
->
fú
 = fcn->fcn;

255 ià(
™”
->
fú
 =ğ
NULL
) {

256 
	`uc_”rÜ
("UnknowÀf›ld v®u'%s'", 
s
);

257 
nuÎ
;

259 ià(
	`¢d_cÚfig_£¬ch
(
cÚfig
, "»gex", &
d
)) {

260 
	`uc_”rÜ
("Lookups„equire„egex!");

261 
nuÎ
;

263 ià(
	`¢d_cÚfig_g‘_¡ršg
(
d
, &
s
))

264 
nuÎ
;

265 
”r
 = 
	`»gcomp
(&
»
, 
s
, 
REG_EXTENDED
 | 
REG_ICASE
);

266 ià(
”r
) {

267 
	`uc_”rÜ
("Regex '%s' comp©iÚ faed (cod%d)", 
s
, 
”r
);

268 
nuÎ
;

271 
»suÉ
 = 
NULL
;

272 
cu¼
 = 
™”
->
	`fœ¡
(
uc_mgr
, i‹r); cu¼; cu¼ = i‹r->
	`Ãxt
(uc_mgr, iter)) {

273 
s
 = 
cu¼
->
	`fú
(
™”
->
šfo
);

274 ià(
s
 =ğ
NULL
)

276 ià(
	`»gexec
(&
»
, 
s
, 
	`ARRAY_SIZE
(
m©ch
), match, 0) == 0) {

277 
»suÉ
 = 
cu¼
->
	`»tfú
(
™”
, 
cÚfig
);

281 
	`»gä“
(&
»
);

282 
fš
:

283 
	`¢d_cÚfig_d–‘e
(
cÚfig
);

284 ià(
™”
->
dÚe
)

285 
™”
->
	`dÚe
(iter);

286  
»suÉ
;

287 
nuÎ
:

288 
»suÉ
 = 
NULL
;

289 
fš
;

290 
	}
}

292 
lookup_™”©e
 *
	$rv®_ÿrd_lookup1
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

293 
lookup_™”©e
 *
™”
,

294 
ÿrd
)

296 ià(
	`¢d_ÿrd_Ãxt
(&
ÿrd
) < 0 || card < 0)

297  
NULL
;

298 
™”
->
ùl_li¡
 = 
	`uc_mgr_g‘_ùl_by_ÿrd
(
uc_mgr
, 
ÿrd
);

299 ià(
™”
->
ùl_li¡
 =ğ
NULL
)

300  
NULL
;

301 
™”
->
šfo
 = i‹r->
ùl_li¡
->
ùl_šfo
;

302  
™”
;

303 
	}
}

305 
lookup_™”©e
 *
	$rv®_ÿrd_lookup_fœ¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

306 
lookup_™”©e
 *
™”
)

308  
	`rv®_ÿrd_lookup1
(
uc_mgr
, 
™”
, -1);

309 
	}
}

311 
lookup_™”©e
 *
	$rv®_ÿrd_lookup_Ãxt
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

312 
lookup_™”©e
 *
™”
)

314  
	`rv®_ÿrd_lookup1
(
uc_mgr
, 
™”
, 
	`¢d_ùl_ÿrd_šfo_g‘_ÿrd
(™”->
šfo
));

315 
	}
}

317 *
	$rv®_ÿrd_lookup_»tuº
(
lookup_™”©e
 *
™”
, 
¢d_cÚfig_t
 *
cÚfig
)

319 
¢d_cÚfig_t
 *
d
;

320 cÚ¡ *
s
;

322 ià(
	`¢d_cÚfig_£¬ch
(
cÚfig
, "»tuº", &
d
))

323  
	`¡rdup
(
	`¢d_ùl_ÿrd_šfo_g‘_id
(
™”
->
šfo
));

324 ià(
	`¢d_cÚfig_g‘_¡ršg
(
d
, &
s
))

325  
NULL
;

326 ià(
	`¡rÿ£cmp
(
s
, "id") == 0)

327  
	`¡rdup
(
	`¢d_ùl_ÿrd_šfo_g‘_id
(
™”
->
šfo
));

328 ià(
	`¡rÿ£cmp
(
s
, "number") == 0) {

329 
num
[16];

330 
	`¢´štf
(
num
, Òum), "%d", 
	`¢d_ùl_ÿrd_šfo_g‘_ÿrd
(
™”
->
šfo
));

331  
	`¡rdup
(
num
);

333 
	`uc_”rÜ
("UnknowÀ»tuºy³ '%s'", 
s
);

334  
NULL
;

336 
	}
}

338 *
	$rv®_ÿrd_lookup
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
qu”y
)

340 
lookup_fú
 
fús
[] = {

341 { .
Çme
 = "id", (
lookup_fú_t
)
¢d_ùl_ÿrd_šfo_g‘_id
 },

342 { .
Çme
 = "driv”", (
lookup_fú_t
)
¢d_ùl_ÿrd_šfo_g‘_driv”
 },

343 { .
Çme
 = "Çme", (
lookup_fú_t
)
¢d_ùl_ÿrd_šfo_g‘_Çme
 },

344 { .
Çme
 = "lÚgÇme", (
lookup_fú_t
)
¢d_ùl_ÿrd_šfo_g‘_lÚgÇme
 },

345 { .
Çme
 = "mix”Çme", (
lookup_fú_t
)
¢d_ùl_ÿrd_šfo_g‘_mix”Çme
 },

346 { .
Çme
 = "compÚ’ts", (
lookup_fú_t
)
¢d_ùl_ÿrd_šfo_g‘_compÚ’ts
 },

349 
lookup_™”©e
 
™”
 = {

350 .
fœ¡
 = 
rv®_ÿrd_lookup_fœ¡
,

351 .
Ãxt
 = 
rv®_ÿrd_lookup_Ãxt
,

352 .
»tfú
 = 
rv®_ÿrd_lookup_»tuº
,

353 .
fús
 = fcns,

355  
	`rv®_lookup_maš
(
uc_mgr
, 
qu”y
, &
™”
);

356 
	}
}

358 
lookup_™”©e
 *
	$rv®_pcm_lookup1
(
lookup_™”©e
 *
™”
,

359 
deviû
)

361 
¢d_pcm_šfo_t
 *
pcmšfo
;

362 
¢d_ùl_t
 *
ùl
 = 
™”
->
ùl_li¡
->ctl;

363 
”r
;

365 
Ãxt
:

366 ià(
	`¢d_ùl_pcm_Ãxt_deviû
(
ùl
, &
deviû
) < 0 || device < 0)

367  
NULL
;

368 
pcmšfo
 = 
™”
->
šfo
;

369 
	`¢d_pcm_šfo_£t_deviû
(
pcmšfo
, 
deviû
);

370 
”r
 = 
	`¢d_ùl_pcm_šfo
(
ùl
, 
pcmšfo
);

371 ià(
”r
 < 0) {

372 ià(
”r
 =ğ-
ENOENT
)

373 
Ãxt
;

374 
	`uc_”rÜ
("UÇbËØobš PCM infØ(deviû %d)", 
deviû
);

375  
NULL
;

377  
™”
;

378 
	}
}

380 
lookup_™”©e
 *
	$rv®_pcm_lookup_fœ¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
 
ATTRIBUTE_UNUSED
,

381 
lookup_™”©e
 *
™”
)

383  
	`rv®_pcm_lookup1
(
™”
, -1);

384 
	}
}

386 
lookup_™”©e
 *
	$rv®_pcm_lookup_Ãxt
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
 
ATTRIBUTE_UNUSED
,

387 
lookup_™”©e
 *
™”
)

389  
	`rv®_pcm_lookup1
(
™”
, 
	`¢d_pcm_šfo_g‘_deviû
(™”->
šfo
));

390 
	}
}

392 *
	$rv®_pcm_lookup_»tuº
(
lookup_™”©e
 *
™”
,

393 
¢d_cÚfig_t
 *
cÚfig
 
ATTRIBUTE_UNUSED
)

395 
num
[16];

396 
	`¢´štf
(
num
, Òum), "%d", 
	`¢d_pcm_šfo_g‘_deviû
(
™”
->
šfo
));

397  
	`¡rdup
(
num
);

398 
	}
}

400 
	$rv®_pcm_lookup_š™
(
lookup_™”©e
 *
™”
,

401 
¢d_cÚfig_t
 *
cÚfig
)

403 
lookup_fú
 
pcm_fús
[] = {

404 { .
Çme
 = "id", (
lookup_fú_t
)
¢d_pcm_šfo_g‘_id
 },

405 { .
Çme
 = "Çme", (
lookup_fú_t
)
¢d_pcm_šfo_g‘_Çme
 },

406 { .
Çme
 = "subÇme", (
lookup_fú_t
)
¢d_pcm_šfo_g‘_subdeviû_Çme
 },

409 
¢d_cÚfig_t
 *
d
;

410 cÚ¡ *
s
;

411 
¢d_pcm_šfo_t
 *
pcmšfo
;

412 
¢d_pcm_¡»am_t
 
¡»am
 = 
SND_PCM_STREAM_PLAYBACK
;

414 ià(
	`¢d_cÚfig_£¬ch
(
cÚfig
, "¡»am", &
d
) == 0 &&

415 
	`¢d_cÚfig_g‘_¡ršg
(
d
, &
s
) == 0) {

416 ià(
	`¡rÿ£cmp
(
s
, "playback") == 0)

417 
¡»am
 = 
SND_PCM_STREAM_PLAYBACK
;

418 ià(
	`¡rÿ£cmp
(
s
, "capture") == 0)

419 
¡»am
 = 
SND_PCM_STREAM_CAPTURE
;

421 
	`uc_”rÜ
("UnknowÀ¡»amy³ '%s'", 
s
);

422  -
EINVAL
;

425 ià(
	`¢d_pcm_šfo_m®loc
(&
pcmšfo
))

426  -
ENOMEM
;

427 
	`¢d_pcm_šfo_£t_deviû
(
pcmšfo
, 0);

428 
	`¢d_pcm_šfo_£t_subdeviû
(
pcmšfo
, 0);

429 
	`¢d_pcm_šfo_£t_¡»am
(
pcmšfo
, 
¡»am
);

430 
™”
->
fœ¡
 = 
rv®_pcm_lookup_fœ¡
;

431 
™”
->
Ãxt
 = 
rv®_pcm_lookup_Ãxt
;

432 
™”
->
»tfú
 = 
rv®_pcm_lookup_»tuº
;

433 
™”
->
fús
 = 
pcm_fús
;

434 
™”
->
šfo
 = 
pcmšfo
;

436 
	}
}

438 
	$rv®_deviû_lookup_š™
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

439 
lookup_™”©e
 *
™”
,

440 
¢d_cÚfig_t
 *
cÚfig
)

443 cÚ¡ *
Çme
;

444 (*
š™
)(
lookup_™”©e
 *
™”
, 
¢d_cÚfig_t
 *
cÚfig
);

445 } *
t
, 
ty³s
[] = {

446 { .
Çme
 = "pcm", .
š™
 = 
rv®_pcm_lookup_š™
 },

449 
¢d_cÚfig_t
 *
d
;

450 cÚ¡ *
s
;

451 
”r
;

453 ià(
	`¢d_cÚfig_£¬ch
(
cÚfig
, "ùl", &
d
è|| 
	`¢d_cÚfig_g‘_¡ršg
(d, &
s
)) {

454 
™”
->
ùl_li¡
 = 
	`uc_mgr_g‘_ma¡”_ùl
(
uc_mgr
);

455 ià(
™”
->
ùl_li¡
 =ğ
NULL
) {

456 
	`uc_”rÜ
("Control device is‚ot defined!");

457  -
EINVAL
;

460 
”r
 = 
	`uc_mgr_İ’_ùl
(
uc_mgr
, &
™”
->
ùl_li¡
, 
s
, 1);

461 ià(
”r
 < 0) {

462 
	`uc_”rÜ
("CÚŒŞ deviû '%s'‚Ù found", 
s
);

463  -
EINVAL
;

466 ià(
	`¢d_cÚfig_£¬ch
(
cÚfig
, "ty³", &
d
è|| 
	`¢d_cÚfig_g‘_¡ršg
(d, &
s
)) {

467 
	`uc_”rÜ
("Missing deviceype!");

468  -
EINVAL
;

470 
t
 = 
ty³s
;->
Çme
;++)

471 ià(
	`¡rÿ£cmp
(
t
->
Çme
, 
s
) == 0)

472  
t
->
	`š™
(
™”
, 
cÚfig
);

473 
	`uc_”rÜ
("Deviûy³ '%s' i šv®id", 
s
);

474  -
EINVAL
;

475 
	}
}

477 
	$rv®_deviû_lookup_dÚe
(
lookup_™”©e
 *
™”
)

479 
	`ä“
(
™”
->
šfo
);

480 
	}
}

482 *
	$rv®_deviû_lookup
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
qu”y
)

484 
lookup_™”©e
 
™”
 = {

485 .
š™
 = 
rv®_deviû_lookup_š™
,

486 .
dÚe
 = 
rv®_deviû_lookup_dÚe
,

488  
	`rv®_lookup_maš
(
uc_mgr
, 
qu”y
, &
™”
);

489 
	}
}

491 *
	$rv®_’v
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
 
ATTRIBUTE_UNUSED
, cÚ¡ *
id
)

493 *
e
;

495 ià(*
id
 == '-') {

496 
e
 = 
	`g‘’v
(
id
 + 1);

497 ià(
e
 =ğ
NULL
)

498 
e
 = "";

500 
e
 = 
	`g‘’v
(
id
);

502 ià(
e
)

503  
	`¡rdup
(
e
);

504  
NULL
;

505 
	}
}

507 *
	$rv®_sysfs
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
 
ATTRIBUTE_UNUSED
, cÚ¡ *
id
)

509 
·th
[
PATH_MAX
], 
lšk
[PATH_MAX + 1];

510 
¡©64
 
sb
;

511 
ssize_t
 
Ën
;

512 cÚ¡ *
e
;

513 
fd
;

515 
e
 = 
	`uc_mgr_sysfs_roÙ
();

516 ià(
e
 =ğ
NULL
)

517  
NULL
;

518 ià(
id
[0] == '/')

519 
id
++;

520 
	`¢´štf
(
·th
, Õ©h), "%s/%s", 
e
, 
id
);

521 ià(
	`l¡©64
(
·th
, &
sb
) != 0)

522  
NULL
;

523 ià(
	`S_ISLNK
(
sb
.
¡_mode
)) {

524 
Ën
 = 
	`»adlšk
(
·th
, 
lšk
, (link) - 1);

525 ià(
Ën
 <= 0) {

526 
	`uc_”rÜ
("sysfs: cªnÙ„—d†šk '%s' (%d)", 
·th
, 
”ºo
);

527  
NULL
;

529 
lšk
[
Ën
] = '\0';

530 
e
 = 
	`¡¼chr
(
lšk
, '/');

531 ià(
e
)

532  
	`¡rdup
(
e
 + 1);

533  
NULL
;

535 ià(
	`S_ISDIR
(
sb
.
¡_mode
))

536  
NULL
;

537 ià((
sb
.
¡_mode
 & 
S_IRUSR
) == 0)

538  
NULL
;

540 
fd
 = 
	`İ’
(
·th
, 
O_RDONLY
);

541 ià(
fd
 < 0) {

542 
	`uc_”rÜ
("sysf İ’ faed fÜ '%s' (%d)", 
·th
, 
”ºo
);

543  
NULL
;

545 
Ën
 = 
	`»ad
(
fd
, 
·th
, (path)-1);

546 
	`şo£
(
fd
);

547 ià(
Ën
 < 0) {

548 
	`uc_”rÜ
("sysf uÇbËØ»ad v®u'%s' (%d)", 
·th
, 
”ºo
);

549  
NULL
;

551 
Ën
 > 0 && 
·th
[len-1] == '\n')

552 
Ën
--;

553 
·th
[
Ën
] = '\0';

554  
	`¡rdup
(
·th
);

555 
	}
}

557 *
	$rv®_v¬
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
id
)

559 cÚ¡ *
v
;

560 
boŞ
 
ignÜe_nÙ_found
 = 
çl£
;

562 ià(
uc_mgr
->
cÚf_fÜm©
 < 3) {

563 
	`uc_”rÜ
("variable substitution is supported in v3+ syntax");

564  
NULL
;

567 ià(
id
[0] == '-') {

568 
ignÜe_nÙ_found
 = 
Œue
;

569 
id
++;

570 } ià(
id
[0] == '@') {

571 
ignÜe_nÙ_found
 = 
Œue
;

573 
v
 = 
	`uc_mgr_g‘_v¬ŸbË
(
uc_mgr
, 
id
);

574 ià(
v
 =ğ
NULL
 && 
ignÜe_nÙ_found
)

575 
v
 = "";

576 ià(
v
)

577  
	`¡rdup
(
v
);

578  
NULL
;

579 
	}
}

581 
_¢d_ev®_¡ršg
(
¢d_cÚfig_t
 **
d¡
, cÚ¡ *
s
,

582 
¢d_cÚfig_ex·nd_fú_t
 
fú
, *
´iv©e_d©a
);

584 
	$rv®_ev®_v¬_cb
(
¢d_cÚfig_t
 **
d¡
, cÚ¡ *
s
, *
´iv©e_d©a
)

586 
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
 = 
´iv©e_d©a
;

587 cÚ¡ *
v
;

589 
v
 = 
	`uc_mgr_g‘_v¬ŸbË
(
uc_mgr
, 
s
);

590 ià(
v
 =ğ
NULL
)

591  -
ENOENT
;

592  
	`¢d_cÚfig_imake_¡ršg
(
d¡
, 
NULL
, 
v
);

593 
	}
}

595 *
	$rv®_ev®
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
e
)

597 
¢d_cÚfig_t
 *
d¡
;

598 *
r
;

599 
”r
;

601 ià(
uc_mgr
->
cÚf_fÜm©
 < 5) {

602 
	`uc_”rÜ
("variableƒvaluation is supported in v5+ syntax");

603  
NULL
;

605 
”r
 = 
	`_¢d_ev®_¡ršg
(&
d¡
, 
e
, 
rv®_ev®_v¬_cb
, 
uc_mgr
);

606 ià(
”r
 < 0) {

607 
	`uc_”rÜ
("uÇbËØev®u©'%s'", 
e
);

608  
NULL
;

610 
”r
 = 
	`¢d_cÚfig_g‘_ascii
(
d¡
, &
r
);

611 
	`¢d_cÚfig_d–‘e
(
d¡
);

612 ià(
”r
 < 0)

613  
NULL
;

614  
r
;

615 
	}
}

617 
	$rv®_ev®i
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
node
, cÚ¡ *
e
)

619 
¢d_cÚfig_t
 *
d¡
;

620 cÚ¡ *
id
;

621 *
s
;

622 
size_t
 
l
;

623 
”r
;

625 ià(
uc_mgr
->
cÚf_fÜm©
 < 6) {

626 
	`uc_”rÜ
("variableƒvaluation is supported in v6+ syntax");

627  -
EINVAL
;

629 
”r
 = 
	`¢d_cÚfig_g‘_id
(
node
, &
id
);

630 ià(
”r
 < 0)

631  
”r
;

632 
l
 = 
	`¡¾’
(
e
);

633 ià(
e
[
l
-1] != '}')

634  -
EINVAL
;

635 
s
 = 
	`m®loc
(
l
 + 1);

636 ià(
s
 =ğ
NULL
)

637  -
ENOMEM
;

638 
	`¡rıy
(
s
, 
e
);

639 
s
[
l
-1] = '\0';

640 
”r
 = 
	`_¢d_ev®_¡ršg
(&
d¡
, 
s
 + 8, 
rv®_ev®_v¬_cb
, 
uc_mgr
);

641 
	`ä“
(
s
);

642 ià(
”r
 < 0) {

643 
	`uc_”rÜ
("uÇbËØev®u©'%s'", 
e
);

644  
”r
;

646 
”r
 = 
	`¢d_cÚfig_£t_id
(
d¡
, 
id
);

647 ià(
”r
 < 0)

648  
”r
;

649  
	`¢d_cÚfig_sub¡™u‹
(
node
, 
d¡
);

650 
	}
}

652 
	#MATCH_VARIABLE
(
Çme
, 
id
, 
fú
, 
em±y_ok
) \

653 ià(
	`¡ºcmp
((
Çme
), (
id
), (id) - 1) == 0) { \

654 
rv®
 = 
	`fú
(
uc_mgr
); \

655 
idsize
 = (
id
) - 1; \

656 
®low_em±y
 = (
em±y_ok
); \

657 
__rv®
; \

658 }

	)

660 
	#MATCH_VARIABLE2
(
Çme
, 
id
, 
fú
, 
em±y_ok
) \

661 ià(
	`¡ºcmp
((
Çme
), (
id
), (id) - 1) == 0) { \

662 
idsize
 = (
id
) - 1; \

663 
®low_em±y
 = (
em±y_ok
); \

664 
fú2
 = (
fú
); \

665 
__m©ch2
; \

666 }

	)

671 
šlše
 cÚ¡ *
	$¡rchr_w™h_esÿ³
(cÚ¡ *
¡r
, 
c
)

673 *
s
;

676 
s
 = 
	`¡rchr
(
¡r
, 
c
);

677 ià(
s
 && s !ğ
¡r
) {

678 ià(*(
s
 - 1) == '\\') {

679 
¡r
 = 
s
 + 1;

683  
s
;

685 
	}
}

690 
šlše
 
	$¡ºıy_w™h_esÿ³
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
Ën
)

692 
c
;

694 
c
 = *
¤c
++;

695 
c
 !ğ'\0' && 
Ën
 > 0) {

696 ià(
c
 =ğ'\\' && *
¤c
 == '}') {

697 
c
 = *
¤c
++;

698 
Ën
--;

700 *
d¡
++ = 
c
;

701 
Ën
--;

702 
c
 = *
¤c
++;

704 *
d¡
 = '\0';

705 
	}
}

707 
	$uc_mgr_g‘_sub¡™u‹d_v®ue
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

708 **
_rv®ue
,

709 cÚ¡ *
v®ue
)

711 
size_t
 
size
, 
nsize
, 
idsize
, 
rv®size
, 
dpos
 = 0;

712 cÚ¡ *
tmp
;

713 *
r
, *
Ä
, *
rv®
, 
v2
[128];

714 
boŞ
 
ignÜe_”rÜ
, 
®low_em±y
;

715 *(*
fú2
)(
¢d_u£_ÿ£_mgr_t
 *, cÚ¡ *
id
);

716 
”r
;

718 ià(
v®ue
 =ğ
NULL
)

719  -
ENOENT
;

721 
size
 = 
	`¡¾’
(
v®ue
) + 1;

722 
r
 = 
	`m®loc
(
size
);

723 ià(
r
 =ğ
NULL
)

724  -
ENOMEM
;

726 *
v®ue
) {

727 ià(*
v®ue
 != '$') {

728 
__¡d
:

729 
r
[
dpos
++] = *
v®ue
;

730 
v®ue
++;

733 
ignÜe_”rÜ
 = 
çl£
;

734 ià(
v®ue
[1] =ğ'$' && v®ue[2] =ğ'{' && 
uc_mgr
->
cÚf_fÜm©
 >= 3) {

735 
v®ue
++;

736 
ignÜe_”rÜ
 = 
Œue
;

737 } ià(
v®ue
[1] != '{') {

738 
__¡d
;

740 
fú2
 = 
NULL
;

741 
	`MATCH_VARIABLE
(
v®ue
, "${O³nName}", 
rv®_İ’_Çme
, 
çl£
);

742 
	`MATCH_VARIABLE
(
v®ue
, "${CÚfLibDœ}", 
rv®_cÚf_libdœ
, 
çl£
);

743 
	`MATCH_VARIABLE
(
v®ue
, "${CÚfTİDœ}", 
rv®_cÚf_tİdœ
, 
çl£
);

744 
	`MATCH_VARIABLE
(
v®ue
, "${CÚfDœ}", 
rv®_cÚf_dœ
, 
çl£
);

745 
	`MATCH_VARIABLE
(
v®ue
, "${CÚfName}", 
rv®_cÚf_Çme
, 
çl£
);

746 
	`MATCH_VARIABLE
(
v®ue
, "${C¬dNumb”}", 
rv®_ÿrd_numb”
, 
Œue
);

747 
	`MATCH_VARIABLE
(
v®ue
, "${C¬dId}", 
rv®_ÿrd_id
, 
çl£
);

748 
	`MATCH_VARIABLE
(
v®ue
, "${C¬dDriv”}", 
rv®_ÿrd_driv”
, 
çl£
);

749 
	`MATCH_VARIABLE
(
v®ue
, "${C¬dName}", 
rv®_ÿrd_Çme
, 
çl£
);

750 
	`MATCH_VARIABLE
(
v®ue
, "${C¬dLÚgName}", 
rv®_ÿrd_lÚgÇme
, 
çl£
);

751 
	`MATCH_VARIABLE
(
v®ue
, "${C¬dCompÚ’ts}", 
rv®_ÿrd_compÚ’ts
, 
Œue
);

752 
	`MATCH_VARIABLE2
(
v®ue
, "${’v:", 
rv®_’v
, 
çl£
);

753 
	`MATCH_VARIABLE2
(
v®ue
, "${sys:", 
rv®_sysfs
, 
çl£
);

754 
	`MATCH_VARIABLE2
(
v®ue
, "${v¬:", 
rv®_v¬
, 
Œue
);

755 
	`MATCH_VARIABLE2
(
v®ue
, "${ev®:", 
rv®_ev®
, 
çl£
);

756 
	`MATCH_VARIABLE2
(
v®ue
, "${fšd-ÿrd:", 
rv®_ÿrd_lookup
, 
çl£
);

757 
	`MATCH_VARIABLE2
(
v®ue
, "${fšd-deviû:", 
rv®_deviû_lookup
, 
çl£
);

758 
	`MATCH_VARIABLE2
(
v®ue
, "${C¬dNumb”ByName:", 
rv®_ÿrd_numb”_by_Çme
, 
çl£
);

759 
	`MATCH_VARIABLE2
(
v®ue
, "${C¬dIdByName:", 
rv®_ÿrd_id_by_Çme
, 
çl£
);

760 
__m”r
:

761 
”r
 = -
EINVAL
;

762 
tmp
 = 
	`¡rchr
(
v®ue
, '}');

763 ià(
tmp
) {

764 
	`¡ºıy
(
r
, 
v®ue
, 
tmp
 + 1 - value);

765 
r
[
tmp
 + 1 - 
v®ue
] = '\0';

766 
	`uc_”rÜ
("v¬ŸbË '%s' i nÙ known!", 
r
);

768 
	`uc_”rÜ
("v¬ŸbË„eã»nû '%s' i nÙ com¶‘e", 
v®ue
);

770 
__”rÜ
;

771 
__m©ch2
:

772 
tmp
 = 
	`¡rchr_w™h_esÿ³
(
v®ue
 + 
idsize
, '}');

773 ià(
tmp
) {

774 
rv®size
 = 
tmp
 - (
v®ue
 + 
idsize
);

775 ià(
rv®size
 >ğ(
v2
)) {

776 
”r
 = -
ENOMEM
;

777 
__”rÜ
;

779 
	`¡ºıy_w™h_esÿ³
(
v2
, 
v®ue
 + 
idsize
, 
rv®size
);

780 
idsize
 +ğ
rv®size
 + 1;

781 ià(*
v2
 =ğ'$' && 
uc_mgr
->
cÚf_fÜm©
 >= 3) {

782 ià(
	`¡ºcmp
(
v®ue
, "${eval:", 7) == 0)

783 
__dœeù_fú2
;

784 
tmp
 = 
	`uc_mgr_g‘_v¬ŸbË
(
uc_mgr
, 
v2
 + 1);

785 ià(
tmp
 =ğ
NULL
) {

786 
	`uc_”rÜ
("defš'%s' i nÙ„—chabË iÀthi cÚ‹xt!", 
v2
 + 1);

787 
rv®
 = 
NULL
;

789 
rv®
 = 
	`fú2
(
uc_mgr
, 
tmp
);

792 
__dœeù_fú2
:

793 
rv®
 = 
	`fú2
(
uc_mgr
, 
v2
);

795 
__rv®
;

797 
__m”r
;

798 
__rv®
:

799 ià(
rv®
 =ğ
NULL
 || (!
®low_em±y
 &&„val[0] == '\0')) {

800 
	`ä“
(
rv®
);

801 ià(
ignÜe_”rÜ
) {

802 
v®ue
 +ğ
idsize
;

805 
	`¡ºıy
(
r
, 
v®ue
, 
idsize
);

806 
r
[
idsize
] = '\0';

807 
	`uc_”rÜ
("v¬ŸbË '%s' i % šhi cÚ‹xt!", 
r
,

808 
rv®
 ? "empty" : "not defined");

809 
”r
 = -
EINVAL
;

810 
__”rÜ
;

812 
v®ue
 +ğ
idsize
;

813 
rv®size
 = 
	`¡¾’
(
rv®
);

814 
nsize
 = 
size
 + 
rv®size
 - 
idsize
;

815 ià(
nsize
 > 
size
) {

816 
Ä
 = 
	`»®loc
(
r
, 
nsize
);

817 ià(
Ä
 =ğ
NULL
) {

818 
	`ä“
(
rv®
);

819 
”r
 = -
ENOMEM
;

820 
__”rÜ
;

822 
size
 = 
nsize
;

823 
r
 = 
Ä
;

825 
	`¡rıy
(
r
 + 
dpos
, 
rv®
);

826 
dpos
 +ğ
rv®size
;

827 
	`ä“
(
rv®
);

829 
r
[
dpos
] = '\0';

831 *
_rv®ue
 = 
r
;

834 
__”rÜ
:

835 
	`ä“
(
r
);

836  
”r
;

837 
	}
}

839 
šlše
 
	$uc_mgr_sub¡™u‹_check
(cÚ¡ *
s
)

841  
s
 && 
	`¡r¡r
(s, "${"è!ğ
NULL
;

842 
	}
}

844 
	$uc_mgr_sub¡™u‹_Œ“
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
¢d_cÚfig_t
 *
node
)

846 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

847 
¢d_cÚfig_t
 *
n
;

848 cÚ¡ *
id
, *
s2
;

849 *
s
;

850 
”r
;

852 
”r
 = 
	`¢d_cÚfig_g‘_id
(
node
, &
id
);

853 ià(
”r
 < 0)

854  
”r
;

855 ià(
	`uc_mgr_sub¡™u‹_check
(
id
)) {

856 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s
, 
id
);

857 ià(
”r
 < 0)

858  
”r
;

859 
”r
 = 
	`¢d_cÚfig_£t_id
(
node
, 
s
);

860 ià(
”r
 < 0) {

861 
	`uc_”rÜ
("uÇbËØ£ˆsub¡™u‹d id '%s' (Şd id '%s')", 
s
, 
id
);

862 
	`ä“
(
s
);

863  
”r
;

865 
	`ä“
(
s
);

867 ià(
	`¢d_cÚfig_g‘_ty³
(
node
è!ğ
SND_CONFIG_TYPE_COMPOUND
) {

868 ià(
	`¢d_cÚfig_g‘_ty³
(
node
è=ğ
SND_CONFIG_TYPE_STRING
) {

869 
”r
 = 
	`¢d_cÚfig_g‘_¡ršg
(
node
, &
s2
);

870 ià(
”r
 < 0)

871  
”r
;

872 ià(!
	`uc_mgr_sub¡™u‹_check
(
s2
))

874 ià(
	`¡ºcmp
(
s2
, "${evali:", 8) == 0)

875  
	`rv®_ev®i
(
uc_mgr
, 
node
, 
s2
);

876 
”r
 = 
	`uc_mgr_g‘_sub¡™u‹d_v®ue
(
uc_mgr
, &
s
, 
s2
);

877 ià(
”r
 < 0)

878  
”r
;

879 
”r
 = 
	`¢d_cÚfig_£t_¡ršg
(
node
, 
s
);

880 
	`ä“
(
s
);

881 ià(
”r
 < 0)

882  
”r
;

887 
”r
 = 
	`¢d_cÚfig_g‘_id
(
node
, &
id
);

888 ià(
”r
 < 0)

889  
”r
;

890 ià(
id
 && 
	`¡rcmp
(id, "DefineMacro") == 0)

892 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
node
) {

893 
n
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

894 
”r
 = 
	`uc_mgr_sub¡™u‹_Œ“
(
uc_mgr
, 
n
);

895 ià(
”r
 < 0)

896  
”r
;

899 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/utils.c

33 
	~"ucm_loÿl.h
"

35 
	$uc_mgr_”rÜ
(cÚ¡ *
fmt
,...)

37 
va_li¡
 
va
;

38 
	`va_¡¬t
(
va
, 
fmt
);

39 
	`årštf
(
¡d”r
, "ucm: ");

40 
	`vårštf
(
¡d”r
, 
fmt
, 
va
);

41 
	`va_’d
(
va
);

42 
	}
}

44 
	$uc_mgr_¡dout
(cÚ¡ *
fmt
,...)

46 
va_li¡
 
va
;

47 
	`va_¡¬t
(
va
, 
fmt
);

48 
	`vårštf
(
¡dout
, 
fmt
, 
va
);

49 
	`va_’d
(
va
);

50 
	}
}

52 cÚ¡ *
	$uc_mgr_sysfs_roÙ
()

54 cÚ¡ *
e
 = 
	`g‘’v
("SYSFS_PATH");

55 ià(
e
 =ğ
NULL
)

57 ià(*
e
 == '\0')

58 
	`uc_”rÜ
("no sysfs„oot!");

59  
e
;

60 
	}
}

62 
ùl_li¡
 *
	$uc_mgr_g‘_ma¡”_ùl
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

64 
li¡_h—d
 *
pos
;

65 
ùl_li¡
 *ùl_li¡ = 
NULL
, *
ùl_li¡2
;

67 
	`li¡_fÜ_—ch
(
pos
, &
uc_mgr
->
ùl_li¡
) {

68 
ùl_li¡2
 = 
	`li¡_’Œy
(
pos
, 
ùl_li¡
, 
li¡
);

69 ià(
ùl_li¡2
->
¦ave
)

71 ià(
ùl_li¡
) {

72 
	`uc_”rÜ
("multiple control device‚ames were found!");

73  
NULL
;

75 
ùl_li¡
 = 
ùl_li¡2
;

77  
ùl_li¡
;

78 
	}
}

80 
ùl_li¡
 *
	$uc_mgr_g‘_ùl_by_ÿrd
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, 
ÿrd
)

82 
ùl_li¡
 *ctl_list;

83 
úame
[32];

84 
”r
;

86 
	`¥rštf
(
úame
, "hw:%d", 
ÿrd
);

87 
”r
 = 
	`uc_mgr_İ’_ùl
(
uc_mgr
, &
ùl_li¡
, 
úame
, 1);

88 ià(
”r
 < 0)

89  
NULL
;

90  
ùl_li¡
;

91 
	}
}

93 
ùl_li¡
 *
	$uc_mgr_g‘_ùl_by_Çme
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
Çme
, 
idx
)

95 
li¡_h—d
 *
pos
;

96 
ùl_li¡
 *ctl_list;

97 cÚ¡ *
s
;

98 
idx2
, 
ÿrd
;

100 
idx2
 = 
idx
;

101 
	`li¡_fÜ_—ch
(
pos
, &
uc_mgr
->
ùl_li¡
) {

102 
ùl_li¡
 = 
	`li¡_’Œy
(
pos
, ùl_li¡, 
li¡
);

103 
s
 = 
	`¢d_ùl_ÿrd_šfo_g‘_Çme
(
ùl_li¡
->
ùl_šfo
);

104 ià(
s
 =ğ
NULL
)

106 ià(
	`¡rcmp
(
s
, 
Çme
) == 0) {

107 ià(
idx2
 == 0)

108  
ùl_li¡
;

109 
idx2
--;

113 
idx2
 = 
idx
;

114 
ÿrd
 = -1;

115 ià(
	`¢d_ÿrd_Ãxt
(&
ÿrd
) < 0 || card < 0)

116  
NULL
;

118 
ÿrd
 >= 0) {

119 
ùl_li¡
 = 
	`uc_mgr_g‘_ùl_by_ÿrd
(
uc_mgr
, 
ÿrd
);

120 ià(
ùl_li¡
 =ğ
NULL
)

122 
s
 = 
	`¢d_ùl_ÿrd_šfo_g‘_Çme
(
ùl_li¡
->
ùl_šfo
);

123 ià(
s
 && 
	`¡rcmp
(s, 
Çme
) == 0) {

124 ià(
idx2
 == 0)

125  
ùl_li¡
;

126 
idx2
--;

128 ià(
	`¢d_ÿrd_Ãxt
(&
ÿrd
) < 0)

132  
NULL
;

133 
	}
}

135 
¢d_ùl_t
 *
	$uc_mgr_g‘_ùl
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

137 
ùl_li¡
 *ctl_list;

139 
ùl_li¡
 = 
	`uc_mgr_g‘_ma¡”_ùl
(
uc_mgr
);

140 ià(
ùl_li¡
)

141  
ùl_li¡
->
ùl
;

142  
NULL
;

143 
	}
}

145 
	$uc_mgr_ä“_ùl
(
ùl_li¡
 *ctl_list)

147 
li¡_h—d
 *
pos
, *
Åos
;

148 
ùl_dev
 *ctl_dev;

150 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, &
ùl_li¡
->
dev_li¡
) {

151 
ùl_dev
 = 
	`li¡_’Œy
(
pos
, ùl_dev, 
li¡
);

152 
	`ä“
(
ùl_dev
->
deviû
);

153 
	`ä“
(
ùl_dev
);

155 
	`¢d_ùl_ÿrd_šfo_ä“
(
ùl_li¡
->
ùl_šfo
);

156 
	`ä“
(
ùl_li¡
);

157 
	}
}

159 
	$uc_mgr_ä“_ùl_li¡
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

161 
li¡_h—d
 *
pos
, *
Åos
;

162 
ùl_li¡
 *ctl_list;

164 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, &
uc_mgr
->
ùl_li¡
) {

165 
ùl_li¡
 = 
	`li¡_’Œy
(
pos
, ùl_li¡, 
li¡
);

166 
	`¢d_ùl_şo£
(
ùl_li¡
->
ùl
);

167 
	`li¡_d–
(&
ùl_li¡
->
li¡
);

168 
	`uc_mgr_ä“_ùl
(
ùl_li¡
);

170 
	}
}

172 
	$uc_mgr_ùl_add_dev
(
ùl_li¡
 *ùl_li¡, cÚ¡ *
deviû
)

174 
li¡_h—d
 *
pos
;

175 
ùl_dev
 *ctl_dev;

178 
	`li¡_fÜ_—ch
(
pos
, &
ùl_li¡
->
dev_li¡
) {

179 
ùl_dev
 = 
	`li¡_’Œy
(
pos
, ùl_dev, 
li¡
);

180 ià(
	`¡rcmp
(
ùl_dev
->
deviû
, device) == 0)

185 
ùl_dev
 = 
	`m®loc
((*ctl_dev));

186 ià(
ùl_dev
 =ğ
NULL
)

187  -
ENOMEM
;

188 
ùl_dev
->
deviû
 = 
	`¡rdup
(device);

189 ià(
ùl_dev
->
deviû
 =ğ
NULL
) {

190 
	`ä“
(
ùl_dev
);

191  -
ENOMEM
;

193 
	`li¡_add_
(&
ùl_dev
->
li¡
, &
ùl_li¡
->
dev_li¡
);

195 
	}
}

197 
	$uc_mgr_ùl_add
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

198 
ùl_li¡
 **ctl_list,

199 
¢d_ùl_t
 *
ùl
, 
ÿrd
,

200 
¢d_ùl_ÿrd_šfo_t
 *
šfo
,

201 cÚ¡ *
deviû
,

202 
¦ave
)

204 
ùl_li¡
 *
ş
 = 
NULL
;

205 cÚ¡ *
id
 = 
	`¢d_ùl_ÿrd_šfo_g‘_id
(
šfo
);

206 
dev
[
MAX_CARD_LONG_NAME
];

207 
”r
, 
h™
 = 0;

209 ià(
id
 =ğ
NULL
 || id[0] == '\0')

210  -
ENOENT
;

211 ià(!(*
ùl_li¡
)) {

212 
ş
 = 
	`m®loc
((*cl));

213 ià(
ş
 =ğ
NULL
)

214  -
ENOMEM
;

215 
	`INIT_LIST_HEAD
(&
ş
->
dev_li¡
);

216 
ş
->
ùl
 = ctl;

217 ià(
	`¢d_ùl_ÿrd_šfo_m®loc
(&
ş
->
ùl_šfo
) < 0) {

218 
	`ä“
(
ş
);

219  -
ENOMEM
;

221 
	`¢d_ùl_ÿrd_šfo_cİy
(
ş
->
ùl_šfo
, 
šfo
);

222 
ş
->
¦ave
 = slave;

223 *
ùl_li¡
 = 
ş
;

225 ià(!
¦ave
)

226 (*
ùl_li¡
)->
¦ave
 = slave;

228 ià(
ÿrd
 >= 0) {

229 
	`¢´štf
(
dev
, (dev), "hw:%d", 
ÿrd
);

230 
h™
 |ğ!!(
deviû
 && (
	`¡rcmp
(
dev
, device) == 0));

231 
”r
 = 
	`uc_mgr_ùl_add_dev
(*
ùl_li¡
, 
dev
);

232 ià(
”r
 < 0)

233 
__nomem
;

235 
	`¢´štf
(
dev
, (dev), "hw:%s", 
id
);

236 
h™
 |ğ!!(
deviû
 && (
	`¡rcmp
(
dev
, device) == 0));

237 
”r
 = 
	`uc_mgr_ùl_add_dev
(*
ùl_li¡
, 
dev
);

238 ià(
”r
 < 0)

239 
__nomem
;

241 ià(!
h™
 && 
deviû
) {

242 
”r
 = 
	`uc_mgr_ùl_add_dev
(*
ùl_li¡
, 
deviû
);

243 ià(
”r
 < 0)

244 
__nomem
;

247 
	`li¡_add_
(&(*
ùl_li¡
)->
li¡
, &
uc_mgr
->ctl_list);

250 
__nomem
:

251 ià(*
ùl_li¡
 =ğ
ş
) {

252 
	`uc_mgr_ä“_ùl
(
ş
);

253 *
ùl_li¡
 = 
NULL
;

255  -
ENOMEM
;

256 
	}
}

258 
	$uc_mgr_İ’_ùl
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
,

259 
ùl_li¡
 **
ùÎ
,

260 cÚ¡ *
deviû
,

261 
¦ave
)

263 
li¡_h—d
 *
pos1
, *
pos2
;

264 
¢d_ùl_t
 *
ùl
;

265 
ùl_li¡
 *ctl_list;

266 
ùl_dev
 *ctl_dev;

267 
¢d_ùl_ÿrd_šfo_t
 *
šfo
;

268 cÚ¡ *
id
;

269 
”r
, 
ÿrd
, 
ucm_group
, 
ucm_off£t
;

271 
	`¢d_ùl_ÿrd_šfo_®loÿ
(&
šfo
);

273 
ucm_group
 = 
	`_¢d_is_ucm_deviû
(
deviû
);

274 
ucm_off£t
 = 
ucm_group
 ? 8 : 0;

277 
	`li¡_fÜ_—ch
(
pos1
, &
uc_mgr
->
ùl_li¡
) {

278 
ùl_li¡
 = 
	`li¡_’Œy
(
pos1
, ùl_li¡, 
li¡
);

279 ià(
ùl_li¡
->
ucm_group
 != ucm_group)

281 
	`li¡_fÜ_—ch
(
pos2
, &
ùl_li¡
->
dev_li¡
) {

282 
ùl_dev
 = 
	`li¡_’Œy
(
pos2
, ùl_dev, 
li¡
);

283 ià(
	`¡rcmp
(
ùl_dev
->
deviû
, deviû + 
ucm_off£t
) == 0) {

284 *
ùÎ
 = 
ùl_li¡
;

285 ià(!
¦ave
)

286 
ùl_li¡
->
¦ave
 = 0;

292 
”r
 = 
	`¢d_ùl_İ’
(&
ùl
, 
deviû
, 0);

293 ià(
”r
 < 0)

294  
”r
;

296 
id
 = 
NULL
;

297 
”r
 = 
	`¢d_ùl_ÿrd_šfo
(
ùl
, 
šfo
);

298 ià(
”r
 == 0)

299 
id
 = 
	`¢d_ùl_ÿrd_šfo_g‘_id
(
šfo
);

300 ià(
”r
 < 0 || 
id
 =ğ
NULL
 || id[0] == '\0') {

301 
	`uc_”rÜ
("cÚŒŞ h¬dw¬šfØ(%s): %s", 
deviû
, 
	`¢d_¡»¼Ü
(
”r
));

302 
	`¢d_ùl_şo£
(
ùl
);

303  
”r
 >ğ0 ? -
EINVAL
 :ƒrr;

307 
	`li¡_fÜ_—ch
(
pos1
, &
uc_mgr
->
ùl_li¡
) {

308 
ùl_li¡
 = 
	`li¡_’Œy
(
pos1
, ùl_li¡, 
li¡
);

309 ià(
ùl_li¡
->
ucm_group
 != ucm_group)

311 ià(
	`¡rcmp
(
id
, 
	`¢d_ùl_ÿrd_šfo_g‘_id
(
ùl_li¡
->
ùl_šfo
)) == 0) {

312 
ÿrd
 = 
	`¢d_ÿrd_g‘_šdex
(
id
);

313 
”r
 = 
	`uc_mgr_ùl_add
(
uc_mgr
, &
ùl_li¡
, 
ùl
, 
ÿrd
, 
šfo
, 
deviû
 + 
ucm_off£t
, 
¦ave
);

314 ià(
”r
 < 0)

315 
__nomem
;

316 
	`¢d_ùl_şo£
(
ùl
);

317 
ùl_li¡
->
ucm_group
 = ucm_group;

318 *
ùÎ
 = 
ùl_li¡
;

323 
ùl_li¡
 = 
NULL
;

324 
”r
 = 
	`uc_mgr_ùl_add
(
uc_mgr
, &
ùl_li¡
, 
ùl
, -1, 
šfo
, 
deviû
 + 
ucm_off£t
, 
¦ave
);

325 ià(
”r
 < 0)

326 
__nomem
;

328 
ùl_li¡
->
ucm_group
 = ucm_group;

329 *
ùÎ
 = 
ùl_li¡
;

332 
__nomem
:

333 
	`¢d_ùl_şo£
(
ùl
);

334  -
ENOMEM
;

335 
	}
}

337 cÚ¡ *
	$uc_mgr_cÚfig_dœ
(
fÜm©
)

339 cÚ¡ *
·th
;

341 ià(
fÜm©
 >= 2) {

342 
·th
 = 
	`g‘’v
(
ALSA_CONFIG_UCM2_VAR
);

343 ià(!
·th
 ||…ath[0] == '\0')

344 
·th
 = 
ALSA_CONFIG_DIR
 "/ucm2";

346 
·th
 = 
	`g‘’v
(
ALSA_CONFIG_UCM_VAR
);

347 ià(!
·th
 ||…ath[0] == '\0')

348 
·th
 = 
ALSA_CONFIG_DIR
 "/ucm";

350  
·th
;

351 
	}
}

353 
	$uc_mgr_cÚfig_lßd_što
(
fÜm©
, cÚ¡ *
fe
, 
¢d_cÚfig_t
 *
tİ
)

355 
FILE
 *
å
;

356 
¢d_šput_t
 *
š
;

357 cÚ¡ *
deçuÉ_·ths
[2];

358 
”r
;

360 
å
 = 
	`fİ’
(
fe
, "r");

361 ià(!
å
) {

362 
”r
 = -
”ºo
;

363 
__”r_İ’
:

364 
	`uc_”rÜ
("could‚Ù o³ÀcÚfigu¿tiÚ f%s", 
fe
);

365  
”r
;

367 
”r
 = 
	`¢d_šput_¡dio_©ch
(&
š
, 
å
, 1);

368 ià(
”r
 < 0)

369 
__”r_İ’
;

371 
deçuÉ_·ths
[0] = 
	`uc_mgr_cÚfig_dœ
(
fÜm©
);

372 
deçuÉ_·ths
[1] = 
NULL
;

373 
”r
 = 
	`_¢d_cÚfig_lßd_w™h_šşude
(
tİ
, 
š
, 0, 
deçuÉ_·ths
);

374 ià(
”r
 < 0) {

375 
	`uc_”rÜ
("could‚Ù†ßd cÚfigu¿tiÚ f%s", 
fe
);

376 ià(
š
)

377 
	`¢d_šput_şo£
(
š
);

378  
”r
;

380 
”r
 = 
	`¢d_šput_şo£
(
š
);

381 ià(
”r
 < 0)

382  
”r
;

384 
	}
}

386 
	$uc_mgr_cÚfig_lßd
(
fÜm©
, cÚ¡ *
fe
, 
¢d_cÚfig_t
 **
cfg
)

388 
¢d_cÚfig_t
 *
tİ
;

389 
”r
;

391 
”r
 = 
	`¢d_cÚfig_tİ
(&
tİ
);

392 ià(
”r
 < 0)

393  
”r
;

394 
”r
 = 
	`uc_mgr_cÚfig_lßd_što
(
fÜm©
, 
fe
, 
tİ
);

395 ià(
”r
 < 0) {

396 
	`¢d_cÚfig_d–‘e
(
tİ
);

397  
”r
;

399 *
cfg
 = 
tİ
;

401 
	}
}

403 
	$uc_mgr_ä“_v®ue1
(
ucm_v®ue
 *
v®
)

405 
	`ä“
(
v®
->
Çme
);

406 
	`ä“
(
v®
->
d©a
);

407 
	`li¡_d–
(&
v®
->
li¡
);

408 
	`ä“
(
v®
);

409 
	}
}

411 
	$uc_mgr_ä“_v®ue
(
li¡_h—d
 *
ba£
)

413 
li¡_h—d
 *
pos
, *
Åos
;

414 
ucm_v®ue
 *
v®
;

416 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, 
ba£
) {

417 
v®
 = 
	`li¡_’Œy
(
pos
, 
ucm_v®ue
, 
li¡
);

418 
	`uc_mgr_ä“_v®ue1
(
v®
);

420 
	}
}

422 
	$uc_mgr_ä“_dev_li¡
(
dev_li¡
 *dev_list)

424 
li¡_h—d
 *
pos
, *
Åos
;

425 
dev_li¡_node
 *
dli¡
;

427 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, &
dev_li¡
->
li¡
) {

428 
dli¡
 = 
	`li¡_’Œy
(
pos
, 
dev_li¡_node
, 
li¡
);

429 
	`ä“
(
dli¡
->
Çme
);

430 
	`li¡_d–
(&
dli¡
->
li¡
);

431 
	`ä“
(
dli¡
);

433 
	}
}

435 
	$uc_mgr_put_to_dev_li¡
(
dev_li¡
 *dev_li¡, cÚ¡ *
Çme
)

437 
li¡_h—d
 *
pos
;

438 
dev_li¡_node
 *
dli¡
;

439 *
n
;

441 
	`li¡_fÜ_—ch
(
pos
, &
dev_li¡
->
li¡
) {

442 
dli¡
 = 
	`li¡_’Œy
(
pos
, 
dev_li¡_node
, 
li¡
);

443 ià(
	`¡rcmp
(
dli¡
->
Çme
,‚ame) == 0)

447 
dli¡
 = 
	`ÿÎoc
(1, (*dlist));

448 ià(
dli¡
 =ğ
NULL
)

449  -
ENOMEM
;

450 
n
 = 
	`¡rdup
(
Çme
);

451 ià(
n
 =ğ
NULL
) {

452 
	`ä“
(
dli¡
);

453  -
ENOMEM
;

455 
dli¡
->
Çme
 = 
n
;

456 
	`li¡_add
(&
dli¡
->
li¡
, &
dev_li¡
->list);

458 
	}
}

460 
	$uc_mgr_»Çme_š_dev_li¡
(
dev_li¡
 *dev_li¡, cÚ¡ *
¤c
,

461 cÚ¡ *
d¡
)

463 
li¡_h—d
 *
pos
;

464 
dev_li¡_node
 *
dli¡
;

465 *
d¡1
;

467 
	`li¡_fÜ_—ch
(
pos
, &
dev_li¡
->
li¡
) {

468 
dli¡
 = 
	`li¡_’Œy
(
pos
, 
dev_li¡_node
, 
li¡
);

469 ià(
	`¡rcmp
(
dli¡
->
Çme
, 
¤c
) == 0) {

470 
d¡1
 = 
	`¡rdup
(
d¡
);

471 ià(
d¡1
 =ğ
NULL
)

472  -
ENOMEM
;

473 
	`ä“
(
dli¡
->
Çme
);

474 
dli¡
->
Çme
 = 
d¡1
;

478  -
ENODEV
;

479 
	}
}

481 
	$uc_mgr_»move_äom_dev_li¡
(
dev_li¡
 *dev_li¡, cÚ¡ *
Çme
)

483 
li¡_h—d
 *
pos
;

484 
dev_li¡_node
 *
dli¡
;

486 
	`li¡_fÜ_—ch
(
pos
, &
dev_li¡
->
li¡
) {

487 
dli¡
 = 
	`li¡_’Œy
(
pos
, 
dev_li¡_node
, 
li¡
);

488 ià(
	`¡rcmp
(
dli¡
->
Çme
,‚ame) == 0) {

489 
	`ä“
(
dli¡
->
Çme
);

490 
	`li¡_d–
(&
dli¡
->
li¡
);

491 
	`ä“
(
dli¡
);

495  -
ENODEV
;

496 
	}
}

498 
	$uc_mgr_ä“_£qu’û_–em’t
(
£qu’û_–em’t
 *
£q
)

500 ià(
£q
 =ğ
NULL
)

502 
£q
->
ty³
) {

503 
SEQUENCE_ELEMENT_TYPE_CDEV
:

504 
	`ä“
(
£q
->
d©a
.
cdev
);

506 
SEQUENCE_ELEMENT_TYPE_CSET
:

507 
SEQUENCE_ELEMENT_TYPE_CSET_NEW
:

508 
SEQUENCE_ELEMENT_TYPE_CSET_BIN_FILE
:

509 
SEQUENCE_ELEMENT_TYPE_CSET_TLV
:

510 
SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
:

511 
	`ä“
(
£q
->
d©a
.
c£t
);

513 
SEQUENCE_ELEMENT_TYPE_SYSSET
:

514 
	`ä“
(
£q
->
d©a
.
sysw
);

516 
SEQUENCE_ELEMENT_TYPE_EXEC
:

517 
SEQUENCE_ELEMENT_TYPE_SHELL
:

518 
	`ä“
(
£q
->
d©a
.
exec
);

520 
SEQUENCE_ELEMENT_TYPE_CFGSAVE
:

521 
	`ä“
(
£q
->
d©a
.
cfg§ve
);

523 
SEQUENCE_ELEMENT_TYPE_DEV_ENABLE_SEQ
:

524 
SEQUENCE_ELEMENT_TYPE_DEV_DISABLE_SEQ
:

525 
	`ä“
(
£q
->
d©a
.
deviû
);

530 
	`ä“
(
£q
);

531 
	}
}

533 
	$uc_mgr_ä“_£qu’û
(
li¡_h—d
 *
ba£
)

535 
li¡_h—d
 *
pos
, *
Åos
;

536 
£qu’û_–em’t
 *
£q
;

538 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, 
ba£
) {

539 
£q
 = 
	`li¡_’Œy
(
pos
, 
£qu’û_–em’t
, 
li¡
);

540 
	`li¡_d–
(&
£q
->
li¡
);

541 
	`uc_mgr_ä“_£qu’û_–em’t
(
£q
);

543 
	}
}

545 
	$uc_mgr_ä“_Œªs™iÚ_–em’t
(
Œªs™iÚ_£qu’û
 *
t£q
)

547 
	`ä“
(
t£q
->
Çme
);

548 
	`uc_mgr_ä“_£qu’û
(&
t£q
->
Œªs™iÚ_li¡
);

549 
	`ä“
(
t£q
);

550 
	}
}

552 
	$uc_mgr_ä“_Œªs™iÚ
(
li¡_h—d
 *
ba£
)

554 
li¡_h—d
 *
pos
, *
Åos
;

555 
Œªs™iÚ_£qu’û
 *
t£q
;

557 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, 
ba£
) {

558 
t£q
 = 
	`li¡_’Œy
(
pos
, 
Œªs™iÚ_£qu’û
, 
li¡
);

559 
	`li¡_d–
(&
t£q
->
li¡
);

560 
	`uc_mgr_ä“_Œªs™iÚ_–em’t
(
t£q
);

562 
	}
}

564 
	$uc_mgr_ä“_dev_Çme_li¡
(
li¡_h—d
 *
ba£
)

566 
li¡_h—d
 *
pos
, *
Åos
;

567 
ucm_dev_Çme
 *
dev
;

569 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, 
ba£
) {

570 
dev
 = 
	`li¡_’Œy
(
pos
, 
ucm_dev_Çme
, 
li¡
);

571 
	`li¡_d–
(&
dev
->
li¡
);

572 
	`ä“
(
dev
->
Çme1
);

573 
	`ä“
(
dev
->
Çme2
);

574 
	`ä“
(
dev
);

576 
	}
}

578 
	$uc_mgr_ä“_modif›r
(
li¡_h—d
 *
ba£
)

580 
li¡_h—d
 *
pos
, *
Åos
;

581 
u£_ÿ£_modif›r
 *
mod
;

583 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, 
ba£
) {

584 
mod
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_modif›r
, 
li¡
);

585 
	`ä“
(
mod
->
Çme
);

586 
	`ä“
(
mod
->
comm’t
);

587 
	`uc_mgr_ä“_£qu’û
(&
mod
->
’abË_li¡
);

588 
	`uc_mgr_ä“_£qu’û
(&
mod
->
di§bË_li¡
);

589 
	`uc_mgr_ä“_Œªs™iÚ
(&
mod
->
Œªs™iÚ_li¡
);

590 
	`uc_mgr_ä“_dev_li¡
(&
mod
->
dev_li¡
);

591 
	`uc_mgr_ä“_v®ue
(&
mod
->
v®ue_li¡
);

592 
	`li¡_d–
(&
mod
->
li¡
);

593 
	`ä“
(
mod
);

595 
	}
}

597 
	$uc_mgr_ä“_deviû
(
u£_ÿ£_deviû
 *
dev
)

599 
	`ä“
(
dev
->
Çme
);

600 
	`ä“
(
dev
->
comm’t
);

601 
	`uc_mgr_ä“_£qu’û
(&
dev
->
’abË_li¡
);

602 
	`uc_mgr_ä“_£qu’û
(&
dev
->
di§bË_li¡
);

603 
	`uc_mgr_ä“_Œªs™iÚ
(&
dev
->
Œªs™iÚ_li¡
);

604 
	`uc_mgr_ä“_dev_li¡
(&
dev
->
dev_li¡
);

605 
	`uc_mgr_ä“_v®ue
(&
dev
->
v®ue_li¡
);

606 
	`li¡_d–
(&
dev
->
li¡
);

607 
	`ä“
(
dev
);

608 
	}
}

610 
	$uc_mgr_ä“_deviû_li¡
(
li¡_h—d
 *
ba£
)

612 
li¡_h—d
 *
pos
, *
Åos
;

613 
u£_ÿ£_deviû
 *
dev
;

615 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, 
ba£
) {

616 
dev
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_deviû
, 
li¡
);

617 
	`uc_mgr_ä“_deviû
(
dev
);

619 
	}
}

621 
	$uc_mgr_»Çme_deviû
(
u£_ÿ£_v”b
 *
v”b
, cÚ¡ *
¤c
,

622 cÚ¡ *
d¡
)

624 
u£_ÿ£_deviû
 *
deviû
;

625 
li¡_h—d
 *
pos
, *
Åos
;

626 *
d¡1
;

629 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, &
v”b
->
deviû_li¡
) {

630 
deviû
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_deviû
, 
li¡
);

631 ià(
	`¡rcmp
(
deviû
->
Çme
, 
¤c
) == 0) {

632 
d¡1
 = 
	`¡rdup
(
d¡
);

633 ià(
d¡1
 =ğ
NULL
)

634  -
ENOMEM
;

635 
	`ä“
(
deviû
->
Çme
);

636 
deviû
->
Çme
 = 
d¡1
;

639 
	`uc_mgr_»Çme_š_dev_li¡
(&
deviû
->
dev_li¡
, 
¤c
, 
d¡
);

642 
	}
}

644 
	$uc_mgr_»move_deviû
(
u£_ÿ£_v”b
 *
v”b
, cÚ¡ *
Çme
)

646 
u£_ÿ£_deviû
 *
deviû
;

647 
li¡_h—d
 *
pos
, *
Åos
;

648 
”r
, 
found
 = 0;

650 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, &
v”b
->
deviû_li¡
) {

651 
deviû
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_deviû
, 
li¡
);

652 ià(
	`¡rcmp
(
deviû
->
Çme
,‚ame) == 0) {

653 
	`uc_mgr_ä“_deviû
(
deviû
);

654 
found
++;

657 
”r
 = 
	`uc_mgr_»move_äom_dev_li¡
(&
deviû
->
dev_li¡
, 
Çme
);

658 ià(
”r
 < 0 &&ƒ¼ !ğ-
ENODEV
)

659  
”r
;

660 ià(
”r
 == 0)

661 
found
++;

663  
found
 =ğ0 ? -
ENODEV
 : 0;

664 
	}
}

666 cÚ¡ *
	$uc_mgr_g‘_v¬ŸbË
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
Çme
)

668 
li¡_h—d
 *
pos
;

669 
ucm_v®ue
 *
v®ue
;

671 
	`li¡_fÜ_—ch
(
pos
, &
uc_mgr
->
v¬ŸbË_li¡
) {

672 
v®ue
 = 
	`li¡_’Œy
(
pos
, 
ucm_v®ue
, 
li¡
);

673 ià(
	`¡rcmp
(
v®ue
->
Çme
,‚ame) == 0)

674  
v®ue
->
d©a
;

676  
NULL
;

677 
	}
}

679 
	$uc_mgr_£t_v¬ŸbË
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
Çme
,

680 cÚ¡ *
v®
)

682 
li¡_h—d
 *
pos
;

683 
ucm_v®ue
 *
cu¼
;

684 *
v®2
;

686 
	`li¡_fÜ_—ch
(
pos
, &
uc_mgr
->
v¬ŸbË_li¡
) {

687 
cu¼
 = 
	`li¡_’Œy
(
pos
, 
ucm_v®ue
, 
li¡
);

688 ià(
	`¡rcmp
(
cu¼
->
Çme
,‚ame) == 0) {

689 
v®2
 = 
	`¡rdup
(
v®
);

690 ià(
v®2
 =ğ
NULL
)

691  -
ENOMEM
;

692 
	`ä“
(
cu¼
->
d©a
);

693 
cu¼
->
d©a
 = 
v®2
;

698 
cu¼
 = 
	`ÿÎoc
(1, (
ucm_v®ue
));

699 ià(
cu¼
 =ğ
NULL
)

700  -
ENOMEM
;

701 
cu¼
->
Çme
 = 
	`¡rdup
(name);

702 ià(
cu¼
->
Çme
 =ğ
NULL
) {

703 
	`ä“
(
cu¼
);

704  -
ENOMEM
;

706 
cu¼
->
d©a
 = 
	`¡rdup
(
v®
);

707 ià(
cu¼
->
d©a
 =ğ
NULL
) {

708 
	`ä“
(
cu¼
->
Çme
);

709 
	`ä“
(
cu¼
);

710  -
ENOMEM
;

712 
	`li¡_add_
(&
cu¼
->
li¡
, &
uc_mgr
->
v¬ŸbË_li¡
);

714 
	}
}

716 
	$uc_mgr_d–‘e_v¬ŸbË
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
, cÚ¡ *
Çme
)

718 
li¡_h—d
 *
pos
;

719 
ucm_v®ue
 *
cu¼
;

721 
	`li¡_fÜ_—ch
(
pos
, &
uc_mgr
->
v¬ŸbË_li¡
) {

722 
cu¼
 = 
	`li¡_’Œy
(
pos
, 
ucm_v®ue
, 
li¡
);

723 ià(
	`¡rcmp
(
cu¼
->
Çme
,‚ame) == 0) {

724 
	`uc_mgr_ä“_v®ue1
(
cu¼
);

729  -
ENOENT
;

730 
	}
}

732 
	$uc_mgr_ä“_v”b
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

734 
li¡_h—d
 *
pos
, *
Åos
;

735 
u£_ÿ£_v”b
 *
v”b
;

737 ià(
uc_mgr
->
loÿl_cÚfig
) {

738 
	`¢d_cÚfig_d–‘e
(
uc_mgr
->
loÿl_cÚfig
);

739 
uc_mgr
->
loÿl_cÚfig
 = 
NULL
;

741 ià(
uc_mgr
->
maüos
) {

742 
	`¢d_cÚfig_d–‘e
(
uc_mgr
->
maüos
);

743 
uc_mgr
->
maüos
 = 
NULL
;

745 
	`li¡_fÜ_—ch_§ã
(
pos
, 
Åos
, &
uc_mgr
->
v”b_li¡
) {

746 
v”b
 = 
	`li¡_’Œy
(
pos
, 
u£_ÿ£_v”b
, 
li¡
);

747 
	`ä“
(
v”b
->
Çme
);

748 
	`ä“
(
v”b
->
comm’t
);

749 
	`uc_mgr_ä“_£qu’û
(&
v”b
->
’abË_li¡
);

750 
	`uc_mgr_ä“_£qu’û
(&
v”b
->
di§bË_li¡
);

751 
	`uc_mgr_ä“_Œªs™iÚ
(&
v”b
->
Œªs™iÚ_li¡
);

752 
	`uc_mgr_ä“_v®ue
(&
v”b
->
v®ue_li¡
);

753 
	`uc_mgr_ä“_deviû_li¡
(&
v”b
->
deviû_li¡
);

754 
	`uc_mgr_ä“_deviû_li¡
(&
v”b
->
cm±_deviû_li¡
);

755 
	`uc_mgr_ä“_modif›r
(&
v”b
->
modif›r_li¡
);

756 
	`uc_mgr_ä“_dev_Çme_li¡
(&
v”b
->
»Çme_li¡
);

757 
	`uc_mgr_ä“_dev_Çme_li¡
(&
v”b
->
»move_li¡
);

758 
	`li¡_d–
(&
v”b
->
li¡
);

759 
	`ä“
(
v”b
);

761 
	`uc_mgr_ä“_£qu’û
(&
uc_mgr
->
fixedboÙ_li¡
);

762 
	`uc_mgr_ä“_£qu’û
(&
uc_mgr
->
boÙ_li¡
);

763 
	`uc_mgr_ä“_£qu’û
(&
uc_mgr
->
deçuÉ_li¡
);

764 
	`uc_mgr_ä“_v®ue
(&
uc_mgr
->
v®ue_li¡
);

765 
	`uc_mgr_ä“_v®ue
(&
uc_mgr
->
v¬ŸbË_li¡
);

766 
	`ä“
(
uc_mgr
->
comm’t
);

767 
	`ä“
(
uc_mgr
->
cÚf_dœ_Çme
);

768 
	`ä“
(
uc_mgr
->
cÚf_fe_Çme
);

769 
uc_mgr
->
comm’t
 = 
NULL
;

770 
uc_mgr
->
cÚf_dœ_Çme
 = 
NULL
;

771 
uc_mgr
->
cÚf_fe_Çme
 = 
NULL
;

772 
uc_mgr
->
aùive_v”b
 = 
NULL
;

773 
	`INIT_LIST_HEAD
(&
uc_mgr
->
aùive_deviûs
);

774 
	`INIT_LIST_HEAD
(&
uc_mgr
->
aùive_modif›rs
);

775 
	}
}

777 
	$uc_mgr_ä“
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

779 
	`uc_mgr_ä“_v”b
(
uc_mgr
);

780 
	`uc_mgr_ä“_ùl_li¡
(
uc_mgr
);

781 
	`ä“
(
uc_mgr
->
ÿrd_Çme
);

782 
	`ä“
(
uc_mgr
);

783 
	}
}

789 
±h»ad_mu‹x_t
 
	gucm_ÿrds_mu‹x
 = 
PTHREAD_MUTEX_INITIALIZER
;

790 
LIST_HEAD
(
ucm_ÿrds
);

791 
	gucm_ÿrd_assign
;

793 
¢d_u£_ÿ£_mgr_t
 *
	$uc_mgr_ÿrd_fšd
(
ÿrd_numb”
)

795 
li¡_h—d
 *
pos
;

796 
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
;

798 
	`li¡_fÜ_—ch
(
pos
, &
ucm_ÿrds
) {

799 
uc_mgr
 = 
	`li¡_’Œy
(
pos
, 
¢d_u£_ÿ£_mgr_t
, 
ÿrds_li¡
);

800 ià(
uc_mgr
->
ucm_ÿrd_numb”
 =ğ
ÿrd_numb”
)

801  
uc_mgr
;

803  
NULL
;

804 
	}
}

806 
	$uc_mgr_ÿrd_İ’
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

808 
´ev
;

810 
	`±h»ad_mu‹x_lock
(&
ucm_ÿrds_mu‹x
);

811 
´ev
 = 
ucm_ÿrd_assign
++;

812 
	`uc_mgr_ÿrd_fšd
(
ucm_ÿrd_assign
)) {

813 
ucm_ÿrd_assign
++;

814 
ucm_ÿrd_assign
 &= 0xffff;

816 ià(
ucm_ÿrd_assign
 == 0)

817 
ucm_ÿrd_assign
++;

818 ià(
ucm_ÿrd_assign
 =ğ
´ev
) {

819 
	`±h»ad_mu‹x_uÆock
(&
ucm_ÿrds_mu‹x
);

820  -
ENOMEM
;

823 
uc_mgr
->
ucm_ÿrd_numb”
 = 
ucm_ÿrd_assign
;

824 
	`li¡_add
(&
uc_mgr
->
ÿrds_li¡
, &
ucm_ÿrds
);

825 
	`±h»ad_mu‹x_uÆock
(&
ucm_ÿrds_mu‹x
);

827 
	}
}

829 
	$uc_mgr_ÿrd_şo£
(
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
)

831 
	`±h»ad_mu‹x_lock
(&
ucm_ÿrds_mu‹x
);

832 
	`li¡_d–
(&
uc_mgr
->
ÿrds_li¡
);

833 
	`±h»ad_mu‹x_uÆock
(&
ucm_ÿrds_mu‹x
);

834 
	}
}

844 cÚ¡ *
	$uc_mgr_®ibcfg_by_deviû
(
¢d_cÚfig_t
 **
tİ
, cÚ¡ *
Çme
)

846 
buf
[5];

847 
ÿrd_num
;

848 
¢d_cÚfig_t
 *
cÚfig
;

849 
¢d_u£_ÿ£_mgr_t
 *
uc_mgr
;

850 
”r
;

852 ià(
	`¡ºcmp
(
Çme
, "_ucm", 4è|| 
	`¡¾’
(name) < 12 ||‚ame[8] != '.')

853  
NULL
;

854 
	`¡ºıy
(
buf
, 
Çme
 + 4, 4);

855 
buf
[4] = '\0';

856 
”r
 = 
	`§ã_¡¹Ş_ba£
(
buf
, &
ÿrd_num
, 16);

857 ià(
”r
 < 0 || 
ÿrd_num
 < 0 || card_num > 0xffff)

858  
NULL
;

859 
cÚfig
 = 
NULL
;

860 
	`±h»ad_mu‹x_lock
(&
ucm_ÿrds_mu‹x
);

861 
uc_mgr
 = 
	`uc_mgr_ÿrd_fšd
(
ÿrd_num
);

863 ià(
	`uc_mgr_has_loÿl_cÚfig
(
uc_mgr
)) {

864 
cÚfig
 = 
uc_mgr
->
loÿl_cÚfig
;

865 
	`¢d_cÚfig_»f
(
cÚfig
);

867 
	`±h»ad_mu‹x_uÆock
(&
ucm_ÿrds_mu‹x
);

868 ià(!
cÚfig
)

869  
NULL
;

870 *
tİ
 = 
cÚfig
;

871  
Çme
 + 9;

872 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/userfile.c

21 
	~"cÚfig.h
"

22 
	~<¡ršg.h
>

23 
	~<”ºo.h
>

24 
	~<as£¹.h
>

36 #ifdeà
HAVE_WORDEXP


37 
	~<wÜdexp.h
>

38 
	$¢d_u£r_fe
(cÚ¡ *
fe
, **
»suÉ
)

40 
wÜdexp_t
 
we
;

41 
”r
;

43 
	`as£¹
(
fe
 && 
»suÉ
);

44 
”r
 = 
	`wÜdexp
(
fe
, &
we
, 
WRDE_NOCMD
);

45 
”r
) {

46 
WRDE_NOSPACE
:

47 
	`wÜdä“
(&
we
);

48  -
ENOMEM
;

50 ià(
we
.
we_wÜdc
 == 1)

52 
	`wÜdä“
(&
we
);

55  -
EINVAL
;

57 *
»suÉ
 = 
	`¡rdup
(
we
.
we_wÜdv
[0]);

58 
	`wÜdä“
(&
we
);

59 ià(*
»suÉ
 =ğ
NULL
)

60  -
ENOMEM
;

62 
	}
}

66 
	~<sys/ty³s.h
>

67 
	~<uni¡d.h
>

68 
	~<pwd.h
>

69 
	~<¡dio.h
>

70 
	~<¡dlib.h
>

72 
	$¢d_u£r_fe
(cÚ¡ *
fe
, **
»suÉ
)

74 
”r
;

75 
size_t
 
Ën
;

76 *
buf
 = 
NULL
;

78 
	`as£¹
(
fe
 && 
»suÉ
);

79 *
»suÉ
 = 
NULL
;

82 ià(
fe
[0] == '~' && file[1] == '/') {

83 cÚ¡ *
home
 = 
	`g‘’v
("HOME");

84 ià(
home
 =ğ
NULL
) {

85 
·sswd
 
pw’t
, *
p
 = 
NULL
;

86 
uid_t
 
id
 = 
	`g‘uid
();

87 
size_t
 
bufsize
 = 1024;

89 
buf
 = 
	`m®loc
(
bufsize
);

90 ià(
buf
 =ğ
NULL
)

91 
out
;

93 (
”r
 = 
	`g‘pwuid_r
(
id
, &
pw’t
, 
buf
, 
bufsize
, &
p
)è=ğ
ERANGE
) {

94 *
Ãwbuf
;

95 
bufsize
 += 1024;

96 ià(
bufsize
 < 1024)

98 
Ãwbuf
 = 
	`»®loc
(
buf
, 
bufsize
);

99 ià(
Ãwbuf
 =ğ
NULL
)

100 
out
;

101 
buf
 = 
Ãwbuf
;

103 
home
 = 
”r
 ? "" : 
pw’t
.
pw_dœ
;

105 
Ën
 = 
	`¡¾’
(
home
è+ sŒËn(&
fe
[2]) + 2;

106 *
»suÉ
 = 
	`m®loc
(
Ën
);

107 ià(*
»suÉ
)

108 
	`¢´štf
(*
»suÉ
, 
Ën
, "%s/%s", 
home
, &
fe
[2]);

110 *
»suÉ
 = 
	`¡rdup
(
fe
);

113 
out
:

114 ià(
buf
)

115 
	`ä“
(
buf
);

117 ià(*
»suÉ
 =ğ
NULL
)

118  -
ENOMEM
;

120 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/audio_time.c

7 
	~"cÚfig.h
"

8 
	~<¡dio.h
>

9 #ià
HAVE_MALLOC_H


10 
	~<m®loc.h
>

12 
	~<uni¡d.h
>

13 
	~<¡dlib.h
>

14 
	~<¡ršg.h
>

15 
	~<g‘İt.h
>

16 
	~<fú.h
>

17 
	~<ùy³.h
>

18 
	~<”ºo.h
>

19 
	~<lim™s.h
>

20 
	~<time.h
>

21 
	~<loÿË.h
>

22 
	~<m©h.h
>

23 
	~"../šşude/asoundlib.h
"

25 *
	gpcm_Çme
 = "hw:0";

26 
¢d_ouut_t
 *
	gouut
 = 
NULL
;

28 
	$u§ge
(*
commªd
)

30 
	`´štf
("Usage: %s [OPTION]... \n"

39 , 
commªd
);

40 
	}
}

43 
	$time¡amp2ns
(
¢d_htime¡amp_t
 
t
)

45 
n£c
;

47 
n£c
 = 
t
.
tv_£c
 * 1000000000ULL;

48 
n£c
 +ğ
t
.
tv_n£c
;

50  
n£c
;

51 
	}
}

53 
	$timediff
(
¢d_htime¡amp_t
 
t1
, snd_htime¡amp_ˆ
t2
)

55 
n£c1
, 
n£c2
;

57 
n£c1
 = 
	`time¡amp2ns
(
t1
);

58 
n£c2
 = 
	`time¡amp2ns
(
t2
);

60  
n£c1
 - 
n£c2
;

61 
	}
}

63 
	$_g‘time¡amp
(
¢d_pcm_t
 *
hªdË
, 
¢d_htime¡amp_t
 *
time¡amp
,

64 
¢d_htime¡amp_t
 *
Œigg”_time¡amp
,

65 
¢d_htime¡amp_t
 *
audio_time¡amp
,

66 
¢d_pcm_audio_t¡amp_cÚfig_t
 *
audio_t¡amp_cÚfig
,

67 
¢d_pcm_audio_t¡amp_»pÜt_t
 *
audio_t¡amp_»pÜt
,

68 
¢d_pcm_uäames_t
 *
ava
, 
¢d_pcm_säames_t
 *
d–ay
)

70 
”r
;

71 
¢d_pcm_¡©us_t
 *
¡©us
;

73 
	`¢d_pcm_¡©us_®loÿ
(&
¡©us
);

75 
	`¢d_pcm_¡©us_£t_audio_ht¡amp_cÚfig
(
¡©us
, 
audio_t¡amp_cÚfig
);

77 ià((
”r
 = 
	`¢d_pcm_¡©us
(
hªdË
, 
¡©us
)) < 0) {

78 
	`´štf
("SŒ—m stu ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

79 
	`ex™
(0);

81 
	`¢d_pcm_¡©us_g‘_Œigg”_ht¡amp
(
¡©us
, 
Œigg”_time¡amp
);

82 
	`¢d_pcm_¡©us_g‘_ht¡amp
(
¡©us
, 
time¡amp
);

83 
	`¢d_pcm_¡©us_g‘_audio_ht¡amp
(
¡©us
, 
audio_time¡amp
);

84 
	`¢d_pcm_¡©us_g‘_audio_ht¡amp_»pÜt
(
¡©us
, 
audio_t¡amp_»pÜt
);

85 *
ava
 = 
	`¢d_pcm_¡©us_g‘_ava
(
¡©us
);

86 *
d–ay
 = 
	`¢d_pcm_¡©us_g‘_d–ay
(
¡©us
);

87 
	}
}

89 
	#TIMESTAMP_FREQ
 8

	)

90 
	#SAMPLE_FREQ
 48000

	)

91 
	#PERIOD
 (
SAMPLE_FREQ
/
TIMESTAMP_FREQ
)

	)

92 
	#PCM_LINK


	)

93 
	#TRACK_CAPTURE


	)

94 
	#TRACK_PLAYBACK


	)

96 
	#PLAYBACK_BUFFERS
 4

	)

97 
	#TSTAMP_TYPE
 
SND_PCM_TSTAMP_TYPE_MONOTONIC_RAW


	)

100 
	$maš
(
¬gc
, *
¬gv
[])

102 
c
;

103 
”r
;

104 
i
;

105 
¢d_pcm_t
 *
hªdË_p
 = 
NULL
;

106 
¢d_pcm_t
 *
hªdË_c
 = 
NULL
;

107 
¢d_pcm_säames_t
 
äames
;

108 
¢d_htime¡amp_t
 
t¡amp_c
, 
t¡amp_p
;

109 
¢d_htime¡amp_t
 
Œigg”_t¡amp_c
, 
Œigg”_t¡amp_p
;

110 
¢d_htime¡amp_t
 
audio_t¡amp_c
, 
audio_t¡amp_p
;

111 
bufãr_p
[
PERIOD
*4*4];

112 
bufãr_c
[
PERIOD
*4*4];

114 
¢d_pcm_hw_·¿ms_t
 *
hw·¿ms_p
;

115 
¢d_pcm_hw_·¿ms_t
 *
hw·¿ms_c
;

117 
¢d_pcm_sw_·¿ms_t
 *
sw·¿ms_p
;

118 
¢d_pcm_sw_·¿ms_t
 *
sw·¿ms_c
;

120 
¢d_pcm_uäames_t
 
äame_couÁ_c
 = 0;

121 
¢d_pcm_uäames_t
 
äame_couÁ_p
 = 0;

123 
¢d_pcm_säames_t
 
d–ay_p
, 
d–ay_c
;

124 
¢d_pcm_uäames_t
 
ava_p
, 
ava_c
;

126 
¢d_pcm_audio_t¡amp_cÚfig_t
 
audio_t¡amp_cÚfig_p
;

127 
¢d_pcm_audio_t¡amp_cÚfig_t
 
audio_t¡amp_cÚfig_c
;

128 
¢d_pcm_audio_t¡amp_»pÜt_t
 
audio_t¡amp_»pÜt_p
;

129 
¢d_pcm_audio_t¡amp_»pÜt_t
 
audio_t¡amp_»pÜt_c
;

131 
İtiÚ_šdex
;

132 cÚ¡ 
shÜt_İtiÚs
[] = "hcpdrD:t:";

134 cÚ¡ 
İtiÚ
 
lÚg_İtiÚs
[] = {

137 {"deviû", 
»quœed_¬gum’t
, 0, 'D'},

138 {"h–p", 
no_¬gum’t
, 0, 'h'},

140 {"ts_ty³", 
»quœed_¬gum’t
, 0, 't'},

145 
do_d–ay
 = 0;

146 
do_¶ayback
 = 0;

147 
do_ÿ±u»
 = 0;

148 
ty³
 = 0;

149 
do_»pÜt
 = 0;

151 (
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, 
shÜt_İtiÚs
, 
lÚg_İtiÚs
, &
İtiÚ_šdex
)) != -1) {

152 
c
) {

154 
	`u§ge
(
¬gv
[0]);

157 
do_¶ayback
 = 1;

160 
do_ÿ±u»
 = 1;

163 
do_d–ay
 = 1;

166 
pcm_Çme
 = 
İrg
;

169 
ty³
 = 
	`©oi
(
İrg
);

172 
do_»pÜt
 = 1;

176 
	`mem£t
(&
audio_t¡amp_cÚfig_p
, 0, (
¢d_pcm_audio_t¡amp_cÚfig_t
));

177 
	`mem£t
(&
audio_t¡amp_cÚfig_c
, 0, (
¢d_pcm_audio_t¡amp_cÚfig_t
));

178 
	`mem£t
(&
audio_t¡amp_»pÜt_p
, 0, (
¢d_pcm_audio_t¡amp_»pÜt_t
));

179 
	`mem£t
(&
audio_t¡amp_»pÜt_c
, 0, (
¢d_pcm_audio_t¡amp_»pÜt_t
));

181 ià(
do_¶ayback
) {

182 ià((
”r
 = 
	`¢d_pcm_İ’
(&
hªdË_p
, 
pcm_Çme
, 
SND_PCM_STREAM_PLAYBACK
, 0)) < 0) {

183 
	`´štf
("PÏyback o³À”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

184 
_ex™
;

187 ià((
”r
 = 
	`¢d_pcm_£t_·¿ms
(
hªdË_p
,

188 
SND_PCM_FORMAT_S16
,

189 
SND_PCM_ACCESS_RW_INTERLEAVED
,

191 
SAMPLE_FREQ
,

193 4*1000000/
TIMESTAMP_FREQ
)) < 0) {

194 
	`´štf
("PÏyback o³À”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

195 
_ex™
;

198 
	`¢d_pcm_hw_·¿ms_®loÿ
(&
hw·¿ms_p
);

200 
”r
 = 
	`¢d_pcm_hw_·¿ms_cu¼’t
(
hªdË_p
, 
hw·¿ms_p
);

201 ià(
”r
 < 0) {

202 
	`´štf
("UÇbËØd‘”mšcu¼’ˆhw·¿ms_p: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

203 
_ex™
;

206 ià(
	`¢d_pcm_hw_·¿ms_suµÜts_audio_ts_ty³
(
hw·¿ms_p
, 
SND_PCM_AUDIO_TSTAMP_TYPE_COMPAT
))

207 
	`´štf
("Playback supports‡udio compatimestamps\n");

208 ià(
	`¢d_pcm_hw_·¿ms_suµÜts_audio_ts_ty³
(
hw·¿ms_p
, 
SND_PCM_AUDIO_TSTAMP_TYPE_DEFAULT
))

209 
	`´štf
("Playback supports‡udio defaultimestamps\n");

210 ià(
	`¢d_pcm_hw_·¿ms_suµÜts_audio_ts_ty³
(
hw·¿ms_p
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK
))

211 
	`´štf
("Playback supports‡udio†inkimestamps\n");

212 ià(
	`¢d_pcm_hw_·¿ms_suµÜts_audio_ts_ty³
(
hw·¿ms_p
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_ABSOLUTE
))

213 
	`´štf
("Playback supports‡udio†ink‡bsoluteimestamps\n");

214 ià(
	`¢d_pcm_hw_·¿ms_suµÜts_audio_ts_ty³
(
hw·¿ms_p
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_ESTIMATED
))

215 
	`´štf
("Playback supports‡udio†inkƒstimatedimestamps\n");

216 ià(
	`¢d_pcm_hw_·¿ms_suµÜts_audio_ts_ty³
(
hw·¿ms_p
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_SYNCHRONIZED
))

217 
	`´štf
("Playback supports‡udio†ink synchronizedimestamps\n");

219 
	`¢d_pcm_sw_·¿ms_®loÿ
(&
sw·¿ms_p
);

221 
”r
 = 
	`¢d_pcm_sw_·¿ms_cu¼’t
(
hªdË_p
, 
sw·¿ms_p
);

222 ià(
”r
 < 0) {

223 
	`´štf
("UÇbËØd‘”mšcu¼’ˆsw·¿ms_p: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

224 
_ex™
;

228 
”r
 = 
	`¢d_pcm_sw_·¿ms_£t_t¡amp_mode
(
hªdË_p
, 
sw·¿ms_p
, 
SND_PCM_TSTAMP_ENABLE
);

229 ià(
”r
 < 0) {

230 
	`´štf
("UÇbËØ£ˆt¡am°mod: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

231 
_ex™
;

234 
”r
 = 
	`¢d_pcm_sw_·¿ms_£t_t¡amp_ty³
(
hªdË_p
, 
sw·¿ms_p
, 
TSTAMP_TYPE
);

235 ià(
”r
 < 0) {

236 
	`´štf
("UÇbËØ£ˆt¡am°ty³ : %s\n", 
	`¢d_¡»¼Ü
(
”r
));

237 
_ex™
;

241 
”r
 = 
	`¢d_pcm_sw_·¿ms
(
hªdË_p
, 
sw·¿ms_p
);

242 ià(
”r
 < 0) {

243 
	`´štf
("UÇbËØ£ˆsw·¿ms_°: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

244 
_ex™
;

249 ià(
do_ÿ±u»
) {

251 ià((
”r
 = 
	`¢d_pcm_İ’
(&
hªdË_c
, 
pcm_Çme
, 
SND_PCM_STREAM_CAPTURE
, 
SND_PCM_NONBLOCK
)) < 0) {

252 
	`´štf
("C­tu» o³À”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

253 
_ex™
;

255 ià((
”r
 = 
	`¢d_pcm_£t_·¿ms
(
hªdË_c
,

256 
SND_PCM_FORMAT_S16
,

257 
SND_PCM_ACCESS_RW_INTERLEAVED
,

259 
SAMPLE_FREQ
,

261 4*1000000/
TIMESTAMP_FREQ
)) < 0) {

262 
	`´štf
("C­tu» o³À”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

263 
_ex™
;

266 
	`¢d_pcm_hw_·¿ms_®loÿ
(&
hw·¿ms_c
);

268 
”r
 = 
	`¢d_pcm_hw_·¿ms_cu¼’t
(
hªdË_c
, 
hw·¿ms_c
);

269 ià(
”r
 < 0) {

270 
	`´štf
("UÇbËØd‘”mšcu¼’ˆhw·¿ms_c: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

271 
_ex™
;

274 ià(
	`¢d_pcm_hw_·¿ms_suµÜts_audio_ts_ty³
(
hw·¿ms_c
, 
SND_PCM_AUDIO_TSTAMP_TYPE_COMPAT
))

275 
	`´štf
("Capture supports‡udio compatimestamps\n");

276 ià(
	`¢d_pcm_hw_·¿ms_suµÜts_audio_ts_ty³
(
hw·¿ms_c
, 
SND_PCM_AUDIO_TSTAMP_TYPE_DEFAULT
))

277 
	`´štf
("Capture supports‡udio defaultimestamps\n");

278 ià(
	`¢d_pcm_hw_·¿ms_suµÜts_audio_ts_ty³
(
hw·¿ms_c
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK
))

279 
	`´štf
("Capture supports‡udio†inkimestamps\n");

280 ià(
	`¢d_pcm_hw_·¿ms_suµÜts_audio_ts_ty³
(
hw·¿ms_c
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_ABSOLUTE
))

281 
	`´štf
("Capture supports‡udio†ink‡bsoluteimestamps\n");

282 ià(
	`¢d_pcm_hw_·¿ms_suµÜts_audio_ts_ty³
(
hw·¿ms_c
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_ESTIMATED
))

283 
	`´štf
("Capture supports‡udio†inkƒstimatedimestamps\n");

284 ià(
	`¢d_pcm_hw_·¿ms_suµÜts_audio_ts_ty³
(
hw·¿ms_c
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_SYNCHRONIZED
))

285 
	`´štf
("Capture supports‡udio†ink synchronizedimestamps\n");

287 
	`¢d_pcm_sw_·¿ms_®loÿ
(&
sw·¿ms_c
);

289 
”r
 = 
	`¢d_pcm_sw_·¿ms_cu¼’t
(
hªdË_c
, 
sw·¿ms_c
);

290 ià(
”r
 < 0) {

291 
	`´štf
("UÇbËØd‘”mšcu¼’ˆsw·¿ms_c: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

292 
_ex™
;

296 
”r
 = 
	`¢d_pcm_sw_·¿ms_£t_t¡amp_mode
(
hªdË_c
, 
sw·¿ms_c
, 
SND_PCM_TSTAMP_ENABLE
);

297 ià(
”r
 < 0) {

298 
	`´štf
("UÇbËØ£ˆt¡am°mod: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

299 
_ex™
;

302 
”r
 = 
	`¢d_pcm_sw_·¿ms_£t_t¡amp_ty³
(
hªdË_c
, 
sw·¿ms_c
, 
TSTAMP_TYPE
);

303 ià(
”r
 < 0) {

304 
	`´štf
("UÇbËØ£ˆt¡am°ty³ : %s\n", 
	`¢d_¡»¼Ü
(
”r
));

305 
_ex™
;

309 
”r
 = 
	`¢d_pcm_sw_·¿ms
(
hªdË_c
, 
sw·¿ms_c
);

310 ià(
”r
 < 0) {

311 
	`´štf
("UÇbËØ£ˆsw·¿ms_ø: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

312 
_ex™
;

316 ià(
do_¶ayback
 && 
do_ÿ±u»
) {

317 #ifdeà
PCM_LINK


318 ià((
”r
 = 
	`¢d_pcm_lšk
(
hªdË_c
, 
hªdË_p
)) < 0) {

319 
	`´štf
("SŒ—m lškƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

320 
	`ex™
(0);

325 ià(
do_¶ayback
) {

326 
i
 = 
PLAYBACK_BUFFERS
;

327 
i
--) {

328 
äames
 = 
	`¢d_pcm_wr™ei
(
hªdË_p
, 
bufãr_p
, 
PERIOD
);

329 ià(
äames
 < 0) {

330 
	`´štf
("¢d_pcm_wr™e˜çed: %s\n", 
	`¢d_¡»¼Ü
(
äames
));

331 
_ex™
;

333 
äame_couÁ_p
 +ğ
äames
;

336 ià(
PLAYBACK_BUFFERS
 != 4)

337 
	`¢d_pcm_¡¬t
(
hªdË_p
);

340 ià(
do_ÿ±u»
) {

341 #iâdeà
PCM_LINK


343 
	`¢d_pcm_¡¬t
(
hªdË_c
);

345 ià(!
do_¶ayback
)

347 
	`¢d_pcm_¡¬t
(
hªdË_c
);

353 ià(
do_ÿ±u»
) {

355 
äames
 = 
	`¢d_pcm_wa™
(
hªdË_c
, -1);

356 ià(
äames
 < 0) {

357 
	`´štf
("¢d_pcm_wa™ faed: %s\n", 
	`¢d_¡»¼Ü
(
äames
));

358 
_ex™
;

361 
äames
 = 
	`¢d_pcm_»adi
(
hªdË_c
, 
bufãr_c
, 
PERIOD
);

362 ià(
äames
 < 0) {

363 
	`´štf
("¢d_pcm_»ad˜çed: %s\n", 
	`¢d_¡»¼Ü
(
äames
));

364 
_ex™
;

366 
äame_couÁ_c
 +ğ
äames
;

368 #ià
	`defšed
(
TRACK_CAPTURE
)

369 
audio_t¡amp_cÚfig_c
.
ty³_»que¡ed
 = 
ty³
;

370 
audio_t¡amp_cÚfig_c
.
»pÜt_d–ay
 = 
do_d–ay
;

371 
	`_g‘time¡amp
(
hªdË_c
, &
t¡amp_c
, &
Œigg”_t¡amp_c
,

372 &
audio_t¡amp_c
, &
audio_t¡amp_cÚfig_c
, &
audio_t¡amp_»pÜt_c
,

373 &
ava_c
, &
d–ay_c
);

374 #ià
	`defšed
(
TRACK_SAMPLE_COUNTS
)

375 
cu¼_couÁ_c
 = 
äame_couÁ_c
 + 
d–ay_c
;

378 
	`´štf
("capture: curr_count %lli driver count %lli, delta %lli\n",

379 ()
cu¼_couÁ_c
 * 1000000000LL / 
SAMPLE_FREQ
 ,

380 
	`time¡amp2ns
(
audio_t¡amp_c
),

381 ()
cu¼_couÁ_c
 * 1000000000LL / 
SAMPLE_FREQ
 - 
	`time¡amp2ns
(
audio_t¡amp_c
)

384 ià(
do_»pÜt
) {

385 ià(
audio_t¡amp_»pÜt_c
.
v®id
 == 0)

386 
	`´štf
("Audio captureimestamp„eport invalid - ");

387 ià(
audio_t¡amp_»pÜt_c
.
accu¿cy_»pÜt
 == 0)

388 
	`´štf
("Audio captureimestamp‡ccuracy„eport invalid");

389 
	`´štf
("\n");

393 
	`´štf
("\t capture: systime: %lli‚sec,‡udioime %lli‚sec, \tsystime delta %lli \t„esolution %d‚s \n",

394 
	`timediff
(
t¡amp_c
, 
Œigg”_t¡amp_c
),

395 
	`time¡amp2ns
(
audio_t¡amp_c
),

396 
	`timediff
(
t¡amp_c
, 
Œigg”_t¡amp_c
è- 
	`time¡amp2ns
(
audio_t¡amp_c
), 
audio_t¡amp_»pÜt_c
.
accu¿cy


401 ià(
do_¶ayback
) {

402 
äames
 = 
	`¢d_pcm_wr™ei
(
hªdË_p
, 
bufãr_p
, 
PERIOD
);

403 ià(
äames
 < 0) {

404 
	`´štf
("¢d_pcm_wr™e˜çed: %s\n", 
	`¢d_¡»¼Ü
(
äames
));

405 
_ex™
;

408 
äame_couÁ_p
 +ğ
äames
;

410 #ià
	`defšed
(
TRACK_PLAYBACK
)

412 
audio_t¡amp_cÚfig_p
.
ty³_»que¡ed
 = 
ty³
;

413 
audio_t¡amp_cÚfig_p
.
»pÜt_d–ay
 = 
do_d–ay
;

414 
	`_g‘time¡amp
(
hªdË_p
, &
t¡amp_p
, &
Œigg”_t¡amp_p
,

415 &
audio_t¡amp_p
, &
audio_t¡amp_cÚfig_p
, &
audio_t¡amp_»pÜt_p
,

416 &
ava_p
, &
d–ay_p
);

418 #ià
	`defšed
(
TRACK_SAMPLE_COUNTS
)

419 
cu¼_couÁ_p
 = 
äame_couÁ_p
 - 
d–ay_p
;

421 
	`´štf
("playback: curr_count %lli driver count %lli, delta %lli\n",

422 ()
cu¼_couÁ_p
 * 1000000000LL / 
SAMPLE_FREQ
 ,

423 
	`time¡amp2ns
(
audio_t¡amp_p
),

424 ()
cu¼_couÁ_p
 * 1000000000LL / 
SAMPLE_FREQ
 - 
	`time¡amp2ns
(
audio_t¡amp_p
)

427 ià(
do_»pÜt
) {

428 ià(
audio_t¡amp_»pÜt_p
.
v®id
 == 0)

429 
	`´štf
("Audio…laybackimestamp„eport invalid - ");

430 ià(
audio_t¡amp_»pÜt_p
.
accu¿cy_»pÜt
 == 0)

431 
	`´štf
("Audio…laybackimestamp‡ccuracy„eport invalid");

432 
	`´štf
("\n");

435 
	`´štf
("playback: systime: %lli‚sec,‡udioime %lli‚sec, \tsystime delta %lli„esolution %d‚s\n",

436 
	`timediff
(
t¡amp_p
, 
Œigg”_t¡amp_p
),

437 
	`time¡amp2ns
(
audio_t¡amp_p
),

438 
	`timediff
(
t¡amp_p
, 
Œigg”_t¡amp_p
è- 
	`time¡amp2ns
(
audio_t¡amp_p
), 
audio_t¡amp_»pÜt_p
.
accu¿cy


446 
_ex™
:

447 ià(
hªdË_p
)

448 
	`¢d_pcm_şo£
(
hªdË_p
);

449 ià(
hªdË_c
)

450 
	`¢d_pcm_şo£
(
hªdË_c
);

453 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/chmap.c

5 
	~"cÚfig.h
"

6 
	~<¡dio.h
>

7 
	~<¡dlib.h
>

8 
	~<¡ršg.h
>

9 
	~<ùy³.h
>

10 
	~<g‘İt.h
>

11 
	~"../šşude/asoundlib.h
"

13 
	$u§ge
()

15 
	`´štf
("usage: chmap [options] query\n"

24 
	}
}

26 
	$´št_chªÃls
(cÚ¡ 
¢d_pcm_chm­_t
 *
m­
)

28 
tmp
[128];

29 ià(
	`¢d_pcm_chm­_´št
(
m­
, (
tmp
),mp) > 0)

30 
	`´štf
(" %s\n", 
tmp
);

31 
	}
}

33 
	$qu”y_chm­s
(
¢d_pcm_t
 *
pcm
)

35 
¢d_pcm_chm­_qu”y_t
 **
m­s
 = 
	`¢d_pcm_qu”y_chm­s
(
pcm
);

36 
¢d_pcm_chm­_qu”y_t
 **
p
, *
v
;

38 ià(!
m­s
) {

39 
	`´štf
("Cannot query maps\n");

42 
p
 = 
m­s
; (
v
 = *pè!ğ
NULL
;…++) {

43 
	`´štf
("Type = %s, Channels = %d\n",

44 
	`¢d_pcm_chm­_ty³_Çme
(
v
->
ty³
),

45 
v
->
m­
.
chªÃls
);

46 
	`´št_chªÃls
(&
v
->
m­
);

48 
	`¢d_pcm_ä“_chm­s
(
m­s
);

50 
	}
}

52 
	$£tup_pcm
(
¢d_pcm_t
 *
pcm
, 
fÜm©
, 
chªÃls
, 
¿‹
)

54 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
;

56 
	`¢d_pcm_hw_·¿ms_®loÿ
(&
·¿ms
);

57 ià(
	`¢d_pcm_hw_·¿ms_ªy
(
pcm
, 
·¿ms
) < 0) {

58 
	`´štf
("Cannot init hw_params\n");

61 ià(
fÜm©
 !ğ
SND_PCM_FORMAT_UNKNOWN
) {

62 ià(
	`¢d_pcm_hw_·¿ms_£t_fÜm©
(
pcm
, 
·¿ms
, 
fÜm©
) < 0) {

63 
	`´štf
("Cannot set format %s\n",

64 
	`¢d_pcm_fÜm©_Çme
(
fÜm©
));

68 ià(
chªÃls
 > 0) {

69 ià(
	`¢d_pcm_hw_·¿ms_£t_chªÃls
(
pcm
, 
·¿ms
, 
chªÃls
) < 0) {

70 
	`´štf
("CªnÙ s‘ chªÃl %d\n", 
chªÃls
);

74 ià(
¿‹
 > 0) {

75 ià(
	`¢d_pcm_hw_·¿ms_£t_¿‹_Ã¬
(
pcm
, 
·¿ms
, (*)&
¿‹
, 0) < 0) {

76 
	`´štf
("CªnÙ s‘„©%d\n", 
¿‹
);

80 ià(
	`¢d_pcm_hw_·¿ms
(
pcm
, 
·¿ms
) < 0) {

81 
	`´štf
("Cannot set hw_params\n");

85 
	}
}

87 
	$g‘_chm­
(
¢d_pcm_t
 *
pcm
, 
fÜm©
, 
chªÃls
, 
¿‹
)

89 
¢d_pcm_chm­_t
 *
m­
;

91 ià(
	`£tup_pcm
(
pcm
, 
fÜm©
, 
chªÃls
, 
¿‹
))

93 
m­
 = 
	`¢d_pcm_g‘_chm­
(
pcm
);

94 ià(!
m­
) {

95 
	`´štf
("Cannot get chmap\n");

98 
	`´štf
("ChªÃl ğ%d\n", 
m­
->
chªÃls
);

99 
	`´št_chªÃls
(
m­
);

100 
	`ä“
(
m­
);

102 
	}
}

104 
	$£t_chm­
(
¢d_pcm_t
 *
pcm
, 
fÜm©
, 
chªÃls
, 
¿‹
,

105 
Çrgs
, **
¬g
)

107 
i
;

108 
¢d_pcm_chm­_t
 *
m­
;

110 ià(
chªÃls
 && chªÃl !ğ
Çrgs
) {

111 
	`´štf
("IncÚsi¡’ˆchªÃl %d v %d\n", 
chªÃls
, 
Çrgs
);

114 ià(!
chªÃls
) {

115 ià(!
Çrgs
) {

116 
	`´štf
("No channels‡re given\n");

119 
chªÃls
 = 
Çrgs
;

121 ià(
	`£tup_pcm
(
pcm
, 
fÜm©
, 
chªÃls
, 
¿‹
))

123 
m­
 = 
	`m®loc
((è* (
chªÃls
 + 1));

124 ià(!
m­
) {

125 
	`´štf
("cannot malloc\n");

128 
m­
->
chªÃls
 = channels;

129 
i
 = 0; i < 
chªÃls
; i++) {

130 
v®
 = 
	`¢d_pcm_chm­_äom_¡ršg
(
¬g
[
i
]);

131 ià(
v®
 < 0)

132 
v®
 = 
SND_CHMAP_UNKNOWN
;

133 
m­
->
pos
[
i
] = 
v®
;

135 ià(
	`¢d_pcm_£t_chm­
(
pcm
, 
m­
) < 0) {

136 
	`´štf
("Cannot set chmap\n");

139 
	`ä“
(
m­
);

141 
m­
 = 
	`¢d_pcm_g‘_chm­
(
pcm
);

142 ià(!
m­
) {

143 
	`´štf
("Cannot get chmap\n");

146 
	`´štf
("G‘ chªÃl ğ%d\n", 
m­
->
chªÃls
);

147 
	`´št_chªÃls
(
m­
);

148 
	`ä“
(
m­
);

150 
	}
}

152 
	$maš
(
¬gc
, **
¬gv
)

154 *
deviû
 = 
NULL
;

155 
¡»am
 = 
SND_PCM_STREAM_PLAYBACK
;

156 
fÜm©
 = 
SND_PCM_FORMAT_UNKNOWN
;

157 
chªÃls
 = 0;

158 
¿‹
 = 0;

159 
¢d_pcm_t
 *
pcm
;

160 
c
;

162 (
c
 = 
	`g‘İt
(
¬gc
, 
¬gv
, "D:s:f:c:r:")) != -1) {

163 
c
) {

165 
deviû
 = 
İrg
;

168 ià(*
İrg
 == 'c' || *optarg == 'C')

169 
¡»am
 = 
SND_PCM_STREAM_CAPTURE
;

171 
¡»am
 = 
SND_PCM_STREAM_PLAYBACK
;

174 
fÜm©
 = 
	`¢d_pcm_fÜm©_v®ue
(
İrg
);

177 
chªÃls
 = 
	`©oi
(
İrg
);

180 
¿‹
 = 
	`©oi
(
İrg
);

183 
	`u§ge
();

188 ià(
¬gc
 <ğ
İtšd
) {

189 
	`u§ge
();

193 ià(!
deviû
) {

194 
	`´štf
("No device is specified\n");

198 ià(
	`¢d_pcm_İ’
(&
pcm
, 
deviû
, 
¡»am
, 
SND_PCM_NONBLOCK
) < 0) {

199 
	`´štf
("CªnÙ o³ÀPCM sŒ—m % fÜ %s\n", 
deviû
,

200 
	`¢d_pcm_¡»am_Çme
(
¡»am
));

204 *
¬gv
[
İtšd
]) {

206  
	`qu”y_chm­s
(
pcm
);

208  
	`g‘_chm­
(
pcm
, 
fÜm©
, 
chªÃls
, 
¿‹
);

210  
	`£t_chm­
(
pcm
, 
fÜm©
, 
chªÃls
, 
¿‹
,

211 
¬gc
 - 
İtšd
 - 1, 
¬gv
 + optind + 1);

213 
	`u§ge
();

215 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/client_event_filter.c

1 
	~<®§/asoundlib.h
>

3 
	$dump_ev’t_f‹r
(
¢d_£q_ş›Á_šfo_t
 *
ş›Á_šfo
) {

4 
i
, 
b
;

6 
i
 = 0; i <= 255;) {

7 
b
 = 
	`¢d_£q_ş›Á_šfo_ev’t_f‹r_check
(
ş›Á_šfo
, 
i
);

8 
i
++;

9 
	`´štf
("%c%s%s", (
b
 ? 'X' : '.'),

10 (
i
 % 8 == 0 ? " " : ""),

11 (
i
 % 32 == 0 ? "\n" : ""));

13 
	`´štf
("\n");

14 
	}
}

16 
	$maš
() {

17 
¢d_£q_ş›Á_šfo_t
 *
ş›Á_šfo
;

19 
	`¢d_£q_ş›Á_šfo_®loÿ
(&
ş›Á_šfo
);

21 
	`´štf
("first client_info_event_filter :\n");

22 
	`dump_ev’t_f‹r
(
ş›Á_šfo
);

24 
	`¢d_£q_ş›Á_šfo_ev’t_f‹r_add
(
ş›Á_šfo
, 
SND_SEQ_EVENT_NOTEON
);

25 
	`´štf
("after snd_seq_client_info_event_filter_add(client_info, SND_SEQ_EVENT_NOTEON);\n");

26 
	`dump_ev’t_f‹r
(
ş›Á_šfo
);

28 
	`¢d_£q_ş›Á_šfo_ev’t_f‹r_add
(
ş›Á_šfo
, 
SND_SEQ_EVENT_PGMCHANGE
);

29 
	`´štf
("after snd_seq_client_info_event_filter_add(client_info, SND_SEQ_EVENT_PGMCHANGE);\n");

30 
	`dump_ev’t_f‹r
(
ş›Á_šfo
);

32 
	`¢d_£q_ş›Á_šfo_ev’t_f‹r_d–
(
ş›Á_šfo
, 
SND_SEQ_EVENT_NOTEON
);

33 
	`´štf
("after snd_seq_client_info_event_filter_del(client_info, SND_SEQ_EVENT_NOTEON);\n");

34 
	`dump_ev’t_f‹r
(
ş›Á_šfo
);

36 
	`¢d_£q_ş›Á_šfo_ev’t_f‹r_ş—r
(
ş›Á_šfo
);

37 
	`´štf
("after snd_seq_client_info_event_filter_clear(client_info);\n");

38 
	`dump_ev’t_f‹r
(
ş›Á_šfo
);

40 
	`¢d_£q_ş›Á_šfo_ev’t_f‹r_add
(
ş›Á_šfo
, 
SND_SEQ_EVENT_NOTEON
);

41 
	`´štf
("after snd_seq_client_info_event_filter_add(client_info, SND_SEQ_EVENT_NOTEON);\n");

42 
	`dump_ev’t_f‹r
(
ş›Á_šfo
);

45 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/control.c

1 
	~"cÚfig.h
"

2 
	~<¡dio.h
>

3 
	~<¡ršg.h
>

4 
	~"../šşude/asoundlib.h
"

6 
	$maš
()

8 
idx
, 
dev
, 
”r
;

9 
¢d_ùl_t
 *
hªdË
;

10 
¢d_ùl_ÿrd_šfo_t
 *
šfo
;

11 
¢d_pcm_šfo_t
 *
pcmšfo
;

12 
¢d_¿wmidi_šfo_t
 *
¿wmidišfo
;

13 
¡r
[128];

15 
	`¢d_ùl_ÿrd_šfo_®loÿ
(&
šfo
);

16 
	`¢d_pcm_šfo_®loÿ
(&
pcmšfo
);

17 
	`¢d_¿wmidi_šfo_®loÿ
(&
¿wmidišfo
);

19 
idx
 = -1;

21 ià((
”r
 = 
	`¢d_ÿrd_Ãxt
(&
idx
)) < 0) {

22 
	`´štf
("C¬d‚exˆ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

25 ià(
idx
 < 0)

27 
	`¥rštf
(
¡r
, "hw:CARD=%i", 
idx
);

28 ià((
”r
 = 
	`¢d_ùl_İ’
(&
hªdË
, 
¡r
, 0)) < 0) {

29 
	`´štf
("O³À”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

32 ià((
”r
 = 
	`¢d_ùl_ÿrd_šfo
(
hªdË
, 
šfo
)) < 0) {

33 
	`´štf
("HW infØ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

36 
	`´štf
("Soundÿrd #%i:\n", 
idx
 + 1);

37 
	`´štf
(" c¬d - %i\n", 
	`¢d_ùl_ÿrd_šfo_g‘_ÿrd
(
šfo
));

38 
	`´štf
(" id - '%s'\n", 
	`¢d_ùl_ÿrd_šfo_g‘_id
(
šfo
));

39 
	`´štf
(" driv” - '%s'\n", 
	`¢d_ùl_ÿrd_šfo_g‘_driv”
(
šfo
));

40 
	`´štf
("‚am- '%s'\n", 
	`¢d_ùl_ÿrd_šfo_g‘_Çme
(
šfo
));

41 
	`´štf
("†ÚgÇm- '%s'\n", 
	`¢d_ùl_ÿrd_šfo_g‘_lÚgÇme
(
šfo
));

42 
	`´štf
(" mix”Çm- '%s'\n", 
	`¢d_ùl_ÿrd_šfo_g‘_mix”Çme
(
šfo
));

43 
	`´štf
(" compÚ’t - '%s'\n", 
	`¢d_ùl_ÿrd_šfo_g‘_compÚ’ts
(
šfo
));

44 
dev
 = -1;

46 
¢d_pcm_sync_id_t
 
sync
;

47 ià((
”r
 = 
	`¢d_ùl_pcm_Ãxt_deviû
(
hªdË
, &
dev
)) < 0) {

48 
	`´štf
(" PCM‚exˆdeviûƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

51 ià(
dev
 < 0)

53 
	`¢d_pcm_šfo_£t_deviû
(
pcmšfo
, 
dev
);

54 
	`¢d_pcm_šfo_£t_subdeviû
(
pcmšfo
, 0);

55 
	`¢d_pcm_šfo_£t_¡»am
(
pcmšfo
, 
SND_PCM_STREAM_PLAYBACK
);

56 ià((
”r
 = 
	`¢d_ùl_pcm_šfo
(
hªdË
, 
pcmšfo
)) < 0) {

57 
	`´štf
(" PCM infØ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

60 
	`´štf
("PCM info, deviû #%i:\n", 
dev
);

61 
	`´štf
(" deviû - %i\n", 
	`¢d_pcm_šfo_g‘_deviû
(
pcmšfo
));

62 
	`´štf
(" subdeviû - %i\n", 
	`¢d_pcm_šfo_g‘_subdeviû
(
pcmšfo
));

63 
	`´štf
(" sŒ—m - %i\n", 
	`¢d_pcm_šfo_g‘_¡»am
(
pcmšfo
));

64 
	`´štf
(" c¬d - %i\n", 
	`¢d_pcm_šfo_g‘_ÿrd
(
pcmšfo
));

65 
	`´štf
(" id - '%s'\n", 
	`¢d_pcm_šfo_g‘_id
(
pcmšfo
));

66 
	`´štf
("‚am- '%s'\n", 
	`¢d_pcm_šfo_g‘_Çme
(
pcmšfo
));

67 
	`´štf
(" subdeviû‚am- '%s'\n", 
	`¢d_pcm_šfo_g‘_subdeviû_Çme
(
pcmšfo
));

68 
	`´štf
(" cÏs - 0x%x\n", 
	`¢d_pcm_šfo_g‘_şass
(
pcmšfo
));

69 
	`´štf
(" subşas - 0x%x\n", 
	`¢d_pcm_šfo_g‘_subşass
(
pcmšfo
));

70 
	`´štf
(" subdeviû couÁ - %i\n", 
	`¢d_pcm_šfo_g‘_subdeviûs_couÁ
(
pcmšfo
));

71 
	`´štf
(" subdeviû ava - %i\n", 
	`¢d_pcm_šfo_g‘_subdeviûs_ava
(
pcmšfo
));

72 
sync
 = 
	`¢d_pcm_šfo_g‘_sync
(
pcmšfo
);

73 
	`´štf
(" synø- 0x%x,0x%x,0x%x,0x%x\n", 
sync
.
id32
[0], sync.id32[1], sync.id32[2], sync.id32[3]);

75 
dev
 = -1;

77 ià((
”r
 = 
	`¢d_ùl_¿wmidi_Ãxt_deviû
(
hªdË
, &
dev
)) < 0) {

78 
	`´štf
(" RAWMIDI‚exˆdeviûƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

81 ià(
dev
 < 0)

83 
	`¢d_¿wmidi_šfo_£t_deviû
(
¿wmidišfo
, 
dev
);

84 
	`¢d_¿wmidi_šfo_£t_subdeviû
(
¿wmidišfo
, 0);

85 
	`¢d_¿wmidi_šfo_£t_¡»am
(
¿wmidišfo
, 
SND_RAWMIDI_STREAM_OUTPUT
);

86 ià((
”r
 = 
	`¢d_ùl_¿wmidi_šfo
(
hªdË
, 
¿wmidišfo
)) < 0) {

87 
	`´štf
(" RAWMIDI infØ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

90 
	`´štf
("RAWMIDI info, deviû #%i:\n", 
dev
);

91 
	`´štf
(" deviû - %i\n", 
	`¢d_¿wmidi_šfo_g‘_deviû
(
¿wmidišfo
));

92 
	`´štf
(" subdeviû - %i\n", 
	`¢d_¿wmidi_šfo_g‘_subdeviû
(
¿wmidišfo
));

93 
	`´štf
(" sŒ—m - %i\n", 
	`¢d_¿wmidi_šfo_g‘_¡»am
(
¿wmidišfo
));

94 
	`´štf
(" c¬d - %i\n", 
	`¢d_¿wmidi_šfo_g‘_ÿrd
(
¿wmidišfo
));

95 
	`´štf
(" fÏg - 0x%x\n", 
	`¢d_¿wmidi_šfo_g‘_æags
(
¿wmidišfo
));

96 
	`´štf
(" id - '%s'\n", 
	`¢d_¿wmidi_šfo_g‘_id
(
¿wmidišfo
));

97 
	`´štf
("‚am- '%s'\n", 
	`¢d_¿wmidi_šfo_g‘_Çme
(
¿wmidišfo
));

98 
	`´štf
(" subÇm- '%s'\n", 
	`¢d_¿wmidi_šfo_g‘_subdeviû_Çme
(
¿wmidišfo
));

99 
	`´štf
(" subdeviû couÁ - %i\n", 
	`¢d_¿wmidi_šfo_g‘_subdeviûs_couÁ
(
¿wmidišfo
));

100 
	`´štf
(" subdeviû ava - %i\n", 
	`¢d_¿wmidi_šfo_g‘_subdeviûs_ava
(
¿wmidišfo
));

102 
	`¢d_ùl_şo£
(
hªdË
);

105 
	`¢d_cÚfig_upd©e_ä“_glob®
();

107 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/latency.c

30 
	~"cÚfig.h
"

31 
	~<¡dio.h
>

32 
	~<¡dlib.h
>

33 
	~<¡ršg.h
>

34 
	~<sched.h
>

35 
	~<”ºo.h
>

36 
	~<g‘İt.h
>

37 
	~<time.h
>

38 
	~"../šşude/asoundlib.h
"

39 
	~<sys/time.h
>

40 
	~<m©h.h
>

42 #iâdeà
CLOCK_MONOTONIC_RAW


43 
	#CLOCK_MONOTONIC_RAW
 
CLOCK_MONOTONIC


	)

46 #ià
defšed
(
__O³nBSD__
)

47 
	#sched_g‘·¿m
(
pid
, 
·rm
è(-1)

	)

48 
	#sched_£tscheduËr
(
pid
, 
pŞicy
, 
·rm
è(-1)

	)

51 
time¥ec
 
	ttime¡amp_t
;

53 *
	gsched_pŞicy
 = "rr";

54 *
	gpdeviû
 = "hw:0,0";

55 *
	gcdeviû
 = "hw:0,0";

56 
¢d_pcm_fÜm©_t
 
	gfÜm©
 = 
SND_PCM_FORMAT_S16_LE
;

57 
	g¿‹
 = 22050;

58 
	gchªÃls
 = 2;

59 
	gbufãr_size
 = 0;

60 
	g³riod_size
 = 0;

61 
	gÏ‹ncy_mš
 = 32;

62 
	gÏ‹ncy_max
 = 2048;

63 
	gloİ_£c
 = 30;

64 
	gblock
 = 0;

65 
	gu£_pŞl
 = 0;

66 
	gu¦“p_v®
 = 0;

67 
	g»§m¶e
 = 1;

68 
	gsys_Ï‹ncy
 = 0;

69 
	gpos_dump
 = 0;

70 
	g»®time_check
 = 0;

71 
	gloİ_lim™
;

72 
¢d_pcm_uäames_t
 
	g¶ayback_bufãr_size
;

74 
¢d_ouut_t
 *
	gouut
 = 
NULL
;

76 
šlše
 
	$äames_to_miüo
(
size_t
 
äames
)

78  ()((
äames
 * 1000000LLè+ (
¿‹
 / 2)) /„ate;

79 
	}
}

81 
	$time¡amp_now
(
time¡amp_t
 *
t¡amp
)

83 ià(
	`şock_g‘time
(
CLOCK_MONOTONIC_RAW
, 
t¡amp
))

84 
	`´štf
("clock_gettime() failed\n");

85 
	}
}

87 
	$time¡amp_diff_miüo
(
time¡amp_t
 *
t¡amp
)

89 
time¡amp_t
 
now
, 
diff
;

90 
	`time¡amp_now
(&
now
);

91 ià(
t¡amp
->
tv_n£c
 > 
now
.tv_nsec) {

92 
diff
.
tv_£c
 = 
now
.tv_£ø- 
t¡amp
->tv_sec - 1;

93 
diff
.
tv_n£c
 = (
now
.tv_n£ø+ 1000000000Lè- 
t¡amp
->tv_nsec;

95 
diff
.
tv_£c
 = 
now
.tv_£ø- 
t¡amp
->tv_sec;

96 
diff
.
tv_n£c
 = 
now
.tv_n£ø- 
t¡amp
->tv_nsec;

99  (
diff
.
tv_£c
 * 1000000è+ ((diff.
tv_n£c
 + 500L) / 1000L);

100 
	}
}

102 
	$£¬ams_¡»am
(
¢d_pcm_t
 *
hªdË
,

103 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

104 cÚ¡ *
id
)

106 
”r
;

107 
¼©e
;

109 
”r
 = 
	`¢d_pcm_hw_·¿ms_ªy
(
hªdË
, 
·¿ms
);

110 ià(
”r
 < 0) {

111 
	`´štf
("Brok’ cÚfigu¿tiÚ fÜ % PCM:‚ØcÚfigu¿tiÚ avaabË: %s\n", 
	`¢d_¡»¼Ü
(
”r
), 
id
);

112  
”r
;

114 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_¿‹_»§m¶e
(
hªdË
, 
·¿ms
, 
»§m¶e
);

115 ià(
”r
 < 0) {

116 
	`´štf
("Re§m¶£tu°çed fÜ % (v® %i): %s\n", 
id
, 
»§m¶e
, 
	`¢d_¡»¼Ü
(
”r
));

117  
”r
;

119 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_acûss
(
hªdË
, 
·¿ms
, 
SND_PCM_ACCESS_RW_INTERLEAVED
);

120 ià(
”r
 < 0) {

121 
	`´štf
("Acûs ty³‚Ù‡vaabË fÜ %s: %s\n", 
id
, 
	`¢d_¡»¼Ü
(
”r
));

122  
”r
;

124 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_fÜm©
(
hªdË
, 
·¿ms
, 
fÜm©
);

125 ià(
”r
 < 0) {

126 
	`´štf
("Sam¶fÜm©‚Ù‡vaabË fÜ %s: %s\n", 
id
, 
	`¢d_¡»¼Ü
(
”r
));

127  
”r
;

129 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_chªÃls
(
hªdË
, 
·¿ms
, 
chªÃls
);

130 ià(
”r
 < 0) {

131 
	`´štf
("ChªÃl couÁ (%iènÙ‡vaabË fÜ %s: %s\n", 
chªÃls
, 
id
, 
	`¢d_¡»¼Ü
(
”r
));

132  
”r
;

134 
¼©e
 = 
¿‹
;

135 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_¿‹_Ã¬
(
hªdË
, 
·¿ms
, &
¼©e
, 0);

136 ià(
”r
 < 0) {

137 
	`´štf
("R©%iHz‚Ù‡vaabË fÜ %s: %s\n", 
¿‹
, 
id
, 
	`¢d_¡»¼Ü
(
”r
));

138  
”r
;

140 ià(()
¼©e
 !ğ
¿‹
) {

141 
	`´štf
("R©dÛ¢'ˆm©ch (»que¡ed %iHz, g‘ %iHz)\n", 
¿‹
, 
”r
);

142  -
EINVAL
;

145 ià(
sys_Ï‹ncy
 > 0 && 
	`¢d_pcm_hw_·¿ms_ÿn_di§bË_³riod_wakeup
(
·¿ms
)) {

146 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_³riod_wakeup
(
hªdË
, 
·¿ms
, 0);

147 ià(
”r
 < 0) {

148 
	`´štf
("CªnÙ di§bË…”iod wakeup fÜ %s\n", 
id
);

149  
”r
;

153 
	}
}

155 
	$£¬ams_bufsize
(
¢d_pcm_t
 *
hªdË
,

156 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

157 
¢d_pcm_hw_·¿ms_t
 *
¬ams
,

158 
¢d_pcm_uäames_t
 
bufsize
,

159 cÚ¡ *
id
)

161 
”r
;

162 
¢d_pcm_uäames_t
 
³riodsize
;

164 
	`¢d_pcm_hw_·¿ms_cİy
(
·¿ms
, 
¬ams
);

165 
³riodsize
 = 
bufsize
 * 2;

166 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_bufãr_size_Ã¬
(
hªdË
, 
·¿ms
, &
³riodsize
);

167 ià(
”r
 < 0) {

168 
	`´štf
("UÇbËØ£ˆbufã¸siz%l˜fÜ %s: %s\n", 
bufsize
 * 2, 
id
, 
	`¢d_¡»¼Ü
(
”r
));

169  
”r
;

171 ià(
³riod_size
 > 0)

172 
³riodsize
 = 
³riod_size
;

174 
³riodsize
 /= 2;

175 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_³riod_size_Ã¬
(
hªdË
, 
·¿ms
, &
³riodsize
, 0);

176 ià(
”r
 < 0) {

177 
	`´štf
("UÇbËØ£ˆ³riod siz%l˜fÜ %s: %s\n", 
³riodsize
, 
id
, 
	`¢d_¡»¼Ü
(
”r
));

178  
”r
;

181 
	}
}

183 
	$£¬ams_£t
(
¢d_pcm_t
 *
hªdË
,

184 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

185 
¢d_pcm_sw_·¿ms_t
 *
sw·¿ms
,

186 cÚ¡ *
id
)

188 
”r
;

189 
¢d_pcm_uäames_t
 
v®
;

191 
”r
 = 
	`¢d_pcm_hw_·¿ms
(
hªdË
, 
·¿ms
);

192 ià(
”r
 < 0) {

193 
	`´štf
("UÇbËØ£ˆhw…¬am fÜ %s: %s\n", 
id
, 
	`¢d_¡»¼Ü
(
”r
));

194  
”r
;

196 
”r
 = 
	`¢d_pcm_sw_·¿ms_cu¼’t
(
hªdË
, 
sw·¿ms
);

197 ià(
”r
 < 0) {

198 
	`´štf
("UÇbËØd‘”mšcu¼’ˆsw·¿m fÜ %s: %s\n", 
id
, 
	`¢d_¡»¼Ü
(
”r
));

199  
”r
;

201 
”r
 = 
	`¢d_pcm_sw_·¿ms_£t_¡¬t_th»shŞd
(
hªdË
, 
sw·¿ms
, 0x7fffffff);

202 ià(
”r
 < 0) {

203 
	`´štf
("UÇbËØ£ˆ¡¬ˆth»shŞd modfÜ %s: %s\n", 
id
, 
	`¢d_¡»¼Ü
(
”r
));

204  
”r
;

206 ià(!
block
)

207 
v®
 = 4;

209 
	`¢d_pcm_hw_·¿ms_g‘_³riod_size
(
·¿ms
, &
v®
, 
NULL
);

210 
”r
 = 
	`¢d_pcm_sw_·¿ms_£t_ava_mš
(
hªdË
, 
sw·¿ms
, 
v®
);

211 ià(
”r
 < 0) {

212 
	`´štf
("UÇbËØ£ˆava mš fÜ %s: %s\n", 
id
, 
	`¢d_¡»¼Ü
(
”r
));

213  
”r
;

215 
”r
 = 
	`¢d_pcm_sw_·¿ms
(
hªdË
, 
sw·¿ms
);

216 ià(
”r
 < 0) {

217 
	`´štf
("UÇbËØ£ˆsw…¬am fÜ %s: %s\n", 
id
, 
	`¢d_¡»¼Ü
(
”r
));

218  
”r
;

221 
	}
}

223 
	$£¬ams
(
¢d_pcm_t
 *
phªdË
, snd_pcm_ˆ*
chªdË
, *
bufsize
)

225 
”r
, 
Ï¡_bufsize
 = *
bufsize
;

226 
¢d_pcm_hw_·¿ms_t
 *
±_·¿ms
, *
ù_·¿ms
;

227 
¢d_pcm_hw_·¿ms_t
 *
p_·¿ms
, *
c_·¿ms
;

228 
¢d_pcm_sw_·¿ms_t
 *
p_sw·¿ms
, *
c_sw·¿ms
;

229 
¢d_pcm_uäames_t
 
p_size
, 
c_size
, 
p_psize
, 
c_psize
;

230 
p_time
, 
c_time
;

231 
v®
;

233 
	`¢d_pcm_hw_·¿ms_®loÿ
(&
p_·¿ms
);

234 
	`¢d_pcm_hw_·¿ms_®loÿ
(&
c_·¿ms
);

235 
	`¢d_pcm_hw_·¿ms_®loÿ
(&
±_·¿ms
);

236 
	`¢d_pcm_hw_·¿ms_®loÿ
(&
ù_·¿ms
);

237 
	`¢d_pcm_sw_·¿ms_®loÿ
(&
p_sw·¿ms
);

238 
	`¢d_pcm_sw_·¿ms_®loÿ
(&
c_sw·¿ms
);

239 ià((
”r
 = 
	`£¬ams_¡»am
(
phªdË
, 
±_·¿ms
, "playback")) < 0) {

240 
	`´štf
("UÇbËØ£ˆ·¿m‘” fÜ…Ïyback sŒ—m: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

241 
	`ex™
(0);

243 ià((
”r
 = 
	`£¬ams_¡»am
(
chªdË
, 
ù_·¿ms
, "capture")) < 0) {

244 
	`´štf
("UÇbËØ£ˆ·¿m‘” fÜ…Ïyback sŒ—m: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

245 
	`ex™
(0);

248 ià(
bufãr_size
 > 0) {

249 *
bufsize
 = 
bufãr_size
;

250 
__£t_™
;

253 
__agaš
:

254 ià(
bufãr_size
 > 0)

256 ià(
Ï¡_bufsize
 =ğ*
bufsize
)

257 *
bufsize
 += 4;

258 
Ï¡_bufsize
 = *
bufsize
;

259 ià(*
bufsize
 > 
Ï‹ncy_max
)

261 
__£t_™
:

262 ià((
”r
 = 
	`£¬ams_bufsize
(
phªdË
, 
p_·¿ms
, 
±_·¿ms
, *
bufsize
, "playback")) < 0) {

263 
	`´štf
("UÇbËØ£ˆhw…¬am‘” fÜ…Ïyback sŒ—m: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

264 
	`ex™
(0);

266 ià((
”r
 = 
	`£¬ams_bufsize
(
chªdË
, 
c_·¿ms
, 
ù_·¿ms
, *
bufsize
, "capture")) < 0) {

267 
	`´štf
("UÇbËØ£ˆhw…¬am‘” fÜ c­tu» sŒ—m: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

268 
	`ex™
(0);

271 
	`¢d_pcm_hw_·¿ms_g‘_³riod_size
(
p_·¿ms
, &
p_psize
, 
NULL
);

272 ià(
p_psize
 > ()*
bufsize
)

273 *
bufsize
 = 
p_psize
;

274 
	`¢d_pcm_hw_·¿ms_g‘_³riod_size
(
c_·¿ms
, &
c_psize
, 
NULL
);

275 ià(
c_psize
 > ()*
bufsize
)

276 *
bufsize
 = 
c_psize
;

277 
	`¢d_pcm_hw_·¿ms_g‘_³riod_time
(
p_·¿ms
, &
p_time
, 
NULL
);

278 
	`¢d_pcm_hw_·¿ms_g‘_³riod_time
(
c_·¿ms
, &
c_time
, 
NULL
);

279 ià(
p_time
 !ğ
c_time
)

280 
__agaš
;

282 
	`¢d_pcm_hw_·¿ms_g‘_bufãr_size
(
p_·¿ms
, &
p_size
);

283 
¶ayback_bufãr_size
 = 
p_size
;

284 ià(
p_psize
 * 2 < 
p_size
) {

285 
	`¢d_pcm_hw_·¿ms_g‘_³riods_mš
(
p_·¿ms
, &
v®
, 
NULL
);

286 ià(
v®
 > 2) {

287 
	`´štf
("playback device does‚ot support 2…eriods…er buffer\n");

288 
	`ex™
(0);

290 
__agaš
;

292 
	`¢d_pcm_hw_·¿ms_g‘_bufãr_size
(
c_·¿ms
, &
c_size
);

293 ià(
c_psize
 * 2 < 
c_size
) {

294 
	`¢d_pcm_hw_·¿ms_g‘_³riods_mš
(
c_·¿ms
, &
v®
, 
NULL
);

295 ià(
v®
 > 2 ) {

296 
	`´štf
("capture device does‚ot support 2…eriods…er buffer\n");

297 
	`ex™
(0);

299 
__agaš
;

301 ià((
”r
 = 
	`£¬ams_£t
(
phªdË
, 
p_·¿ms
, 
p_sw·¿ms
, "playback")) < 0) {

302 
	`´štf
("UÇbËØ£ˆsw…¬am‘” fÜ…Ïyback sŒ—m: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

303 
	`ex™
(0);

305 ià((
”r
 = 
	`£¬ams_£t
(
chªdË
, 
c_·¿ms
, 
c_sw·¿ms
, "capture")) < 0) {

306 
	`´štf
("UÇbËØ£ˆsw…¬am‘” fÜ…Ïyback sŒ—m: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

307 
	`ex™
(0);

310 ià((
”r
 = 
	`¢d_pcm_´•¬e
(
phªdË
)) < 0) {

311 
	`´štf
("P»·»ƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

312 
	`ex™
(0);

315 
	`¢d_pcm_dump
(
phªdË
, 
ouut
);

316 
	`¢d_pcm_dump
(
chªdË
, 
ouut
);

317 
	`fæush
(
¡dout
);

319 
	}
}

321 
	$show¡©
(
¢d_pcm_t
 *
hªdË
, 
size_t
 
äames
)

323 
”r
;

324 
¢d_pcm_¡©us_t
 *
¡©us
;

326 
	`¢d_pcm_¡©us_®loÿ
(&
¡©us
);

327 ià((
”r
 = 
	`¢d_pcm_¡©us
(
hªdË
, 
¡©us
)) < 0) {

328 
	`´štf
("SŒ—m stu ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

329 
	`ex™
(0);

331 
	`´štf
("*** f¿me ğ%l˜***\n", ()
äames
);

332 
	`¢d_pcm_¡©us_dump
(
¡©us
, 
ouut
);

333 
	}
}

335 
	$showÏ‹ncy
(
size_t
 
Ï‹ncy
)

337 
d
;

338 
Ï‹ncy
 *= 2;

339 
d
 = ()
Ï‹ncy
 / ()
¿‹
;

340 
	`´štf
("Tryšg†©’cy %l˜äames, %.3fus, %.6fm (%.4fHz)\n", ()
Ï‹ncy
, 
d
 * 1000000, d * 1000, ()1 / d);

341 
	}
}

343 
	$showšmax
(
size_t
 
š_max
)

345 
d
;

347 
	`´štf
("Maximum„—d: %l˜äames\n", ()
š_max
);

348 
d
 = ()
š_max
 / ()
¿‹
;

349 
	`´štf
("Maximum„—d†©’cy: %.3fus, %.6fm (%.4fHz)\n", 
d
 * 1000000, d * 1000, ()1 / d);

350 
	}
}

352 
	$g‘time¡amp
(
¢d_pcm_t
 *
hªdË
, 
¢d_time¡amp_t
 *
time¡amp
)

354 
”r
;

355 
¢d_pcm_¡©us_t
 *
¡©us
;

357 
	`¢d_pcm_¡©us_®loÿ
(&
¡©us
);

358 ià((
”r
 = 
	`¢d_pcm_¡©us
(
hªdË
, 
¡©us
)) < 0) {

359 
	`´štf
("SŒ—m stu ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

360 
	`ex™
(0);

362 
	`¢d_pcm_¡©us_g‘_Œigg”_t¡amp
(
¡©us
, 
time¡amp
);

363 
	}
}

365 
	$£tscheduËr
()

367 
sched_·¿m
 sched_param;

368 
pŞicy
 = 
SCHED_RR
;

369 cÚ¡ *
¥Şicy
 = "Round Robin";

371 ià(
	`¡rÿ£cmp
(
sched_pŞicy
, "fifo") == 0) {

372 
pŞicy
 = 
SCHED_FIFO
;

373 
¥Şicy
 = "FIFO";

374 } ià(
	`¡rÿ£cmp
(
sched_pŞicy
, "other") == 0) {

375 
pŞicy
 = 
SCHED_OTHER
;

376 
¥Şicy
 = "OTHER";

378 ià(
	`sched_g‘·¿m
(0, &
sched_·¿m
) < 0) {

379 
	`´štf
("Scheduler getparam failed...\n");

382 
sched_·¿m
.
sched_´iÜ™y
 = 
	`sched_g‘_´iÜ™y_max
(
pŞicy
);

383 ià(!
	`sched_£tscheduËr
(0, 
pŞicy
, &
sched_·¿m
)) {

384 
	`´štf
("ScheduË¸£ˆtØ% w™h…riÜ™y %i...\n", 
¥Şicy
, 
sched_·¿m
.
sched_´iÜ™y
);

385 
	`fæush
(
¡dout
);

388 
	`´štf
("!!!ScheduË¸£ˆtØ% w™h…riÜ™y %˜FAILED!!!\n", 
¥Şicy
, 
sched_·¿m
.
sched_´iÜ™y
);

389 
	}
}

391 
	$timediff
(
¢d_time¡amp_t
 
t1
, snd_time¡amp_ˆ
t2
)

393 sigÃd 
l
;

395 
t1
.
tv_£c
 -ğ
t2
.tv_sec;

396 
l
 = (sigÃd è
t1
.
tv_u£c
 - (sigÃd è
t2
.tv_usec;

397 ià(
l
 < 0) {

398 
t1
.
tv_£c
--;

399 
l
 = 1000000 +†;

400 
l
 %= 1000000;

402  (
t1
.
tv_£c
 * 1000000è+ 
l
;

403 
	}
}

405 
	$»adbuf
(
¢d_pcm_t
 *
hªdË
, *
buf
, 
Ën
, 
size_t
 *
äames
, size_ˆ*
max
)

407 
r
;

409 ià(!
block
) {

411 
r
 = 
	`¢d_pcm_»adi
(
hªdË
, 
buf
, 
Ën
);

412 } 
r
 =ğ-
EAGAIN
);

413 ià(
r
 > 0) {

414 *
äames
 +ğ
r
;

415 ià(()*
max
 < 
r
)

416 *
max
 = 
r
;

420 
äame_by‹s
 = (
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
è/ 8è* 
chªÃls
;

422 
r
 = 
	`¢d_pcm_»adi
(
hªdË
, 
buf
, 
Ën
);

423 ià(
r
 > 0) {

424 
buf
 +ğ
r
 * 
äame_by‹s
;

425 
Ën
 -ğ
r
;

426 *
äames
 +ğ
r
;

427 ià(()*
max
 < 
r
)

428 *
max
 = 
r
;

431 } 
r
 >ğ1 && 
Ën
 > 0);

434  
r
;

435 
	}
}

437 
	$wr™ebuf
(
¢d_pcm_t
 *
hªdË
, *
buf
, 
Ën
, 
size_t
 *
äames
)

439 
r
;

440 
äame_by‹s
 = (
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
è/ 8è* 
chªÃls
;

442 
Ën
 > 0) {

443 
r
 = 
	`¢d_pcm_wr™ei
(
hªdË
, 
buf
, 
Ën
);

444 ià(
r
 =ğ-
EAGAIN
)

447 ià(
r
 < 0)

448  
r
;

450 
buf
 +ğ
r
 * 
äame_by‹s
;

451 
Ën
 -ğ
r
;

452 *
äames
 +ğ
r
;

455 
	}
}

457 
	#FILTERSWEEP_LFO_CENTER
 2000.

	)

458 
	#FILTERSWEEP_LFO_DEPTH
 1800.

	)

459 
	#FILTERSWEEP_LFO_FREQ
 0.2

	)

460 
	#FILTER_BANDWIDTH
 50

	)

463 
	glfo
,
	gdlfo
,
	gfs
,
	gfc
,
	gBW
,
	gC
,
	gD
,
	ga0
,
	ga1
,
	ga2
,
	gb1
,
	gb2
,*
	gx
[3],*
	gy
[3];

465 
	$­¶yefãù
(* 
bufãr
,
r
)

467 * 
§m¶es
 = (*è
bufãr
;

468 
i
;

469 
i
=0;i<
r
;i++)

471 
chn
;

473 
fc
 = 
	`sš
(
lfo
)*
FILTERSWEEP_LFO_DEPTH
+
FILTERSWEEP_LFO_CENTER
;

474 
lfo
 +ğ
dlfo
;

475 ià(
lfo
>2.*
M_PI
)†fo -= 2.*M_PI;

476 
C
 = 1./
	`n
(
M_PI
*
BW
/
fs
);

477 
D
 = 2.*
	`cos
(2*
M_PI
*
fc
/
fs
);

478 
a0
 = 1./(1.+
C
);

479 
a1
 = 0;

480 
a2
 = -
a0
;

481 
b1
 = -
C
*
D
*
a0
;

482 
b2
 = (
C
-1)*
a0
;

484 
chn
=0;chn<
chªÃls
;chn++)

486 
x
[
chn
][2] = x[chn][1];

487 
x
[
chn
][1] = x[chn][0];

489 
y
[
chn
][2] = y[chn][1];

490 
y
[
chn
][1] = y[chn][0];

492 
x
[
chn
][0] = 
§m¶es
[
i
*
chªÃls
+chn];

493 
y
[
chn
][0] = 
a0
*
x
[chn][0] + 
a1
*x[chn][1] + 
a2
*x[chn][2]

494 - 
b1
*
y
[
chn
][1] - 
b2
*y[chn][2];

495 
§m¶es
[
i
*
chªÃls
+
chn
] = 
y
[chn][0];

498 
	}
}

500 
ssize_t
 
	$g‘_ava
(
¢d_pcm_t
 *
pcm
)

502 
ssize_t
 
ava
;

505 
ava
 = 
	`¢d_pcm_ava
(
pcm
);

506 ià(
ava
 =ğ-
EAGAIN
)

510  
ava
;

511 
	}
}

513 
	$h–p
()

515 
k
;

516 
	`´štf
(

540 
	`´štf
("Recognized sample formats‡re:");

541 
k
 = 0; k < 
SND_PCM_FORMAT_LAST
; ++k) {

542 cÚ¡ *
s
 = 
	`¢d_pcm_fÜm©_Çme
(
k
);

543 ià(
s
)

544 
	`´štf
(" %s", 
s
);

546 
	`´štf
("\n\n");

547 
	`´štf
(

554 
	}
}

556 
	$maš
(
¬gc
, *
¬gv
[])

558 
İtiÚ
 
lÚg_İtiÚ
[] =

560 {"h–p", 0, 
NULL
, 'h'},

561 {"pdeviû", 1, 
NULL
, 'P'},

562 {"cdeviû", 1, 
NULL
, 'C'},

563 {"mš", 1, 
NULL
, 'm'},

564 {"max", 1, 
NULL
, 'M'},

565 {"upd©es", 1, 
NULL
, 'U'},

566 {"äames", 1, 
NULL
, 'F'},

567 {"fÜm©", 1, 
NULL
, 'f'},

568 {"chªÃls", 1, 
NULL
, 'c'},

569 {"¿‹", 1, 
NULL
, 'r'},

570 {"bufãr", 1, 
NULL
, 'B'},

571 {"³riod", 1, 
NULL
, 'E'},

572 {"£cÚds", 1, 
NULL
, 's'},

573 {"block", 0, 
NULL
, 'b'},

574 {"pŞl", 0, 
NULL
, 'p'},

575 {"u¦“p", 1, 
NULL
, 'y'},

576 {"efãù", 0, 
NULL
, 'e'},

577 {"posdump", 0, 
NULL
, 'x'},

578 {"»®time", 0, 
NULL
, 'X'},

579 {"pŞicy", 1, 
NULL
, 'O'},

580 {
NULL
, 0, NULL, 0},

582 
¢d_pcm_t
 *
phªdË
, *
chªdË
;

583 *
bufãr
;

584 
”r
, 
Ï‹ncy
, 
mÜeh–p
;

585 
ok
;

586 
¢d_time¡amp_t
 
p_t¡amp
, 
c_t¡amp
;

587 
ssize_t
 
r
, 
ÿp_ava
, 
ÿp_ava_max
, 
pbk_fl
, 
pbk_fl_mš
;

588 
size_t
 
äames_š
, 
äames_out
, 
š_max
;

589 
time¡amp_t
 
t¡amp_¡¬t
;

590 
efãù
 = 0;

591 
mÜeh–p
 = 0;

593 
c
;

594 ià((
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hP:C:m:M:U:F:f:c:r:B:E:s:y:O:b³nxX", 
lÚg_İtiÚ
, 
NULL
)) < 0)

596 
c
) {

598 
mÜeh–p
++;

601 
pdeviû
 = 
	`¡rdup
(
İrg
);

604 
cdeviû
 = 
	`¡rdup
(
İrg
);

607 
”r
 = 
	`©oi
(
İrg
) / 2;

608 
Ï‹ncy_mš
 = 
”r
 >= 4 ?ƒrr : 4;

609 ià(
Ï‹ncy_max
 < 
Ï‹ncy_mš
)

610 
Ï‹ncy_max
 = 
Ï‹ncy_mš
;

613 
”r
 = 
	`©oi
(
İrg
) / 2;

614 
Ï‹ncy_max
 = 
Ï‹ncy_mš
 > 
”r
 ?†atency_min :ƒrr;

617 
”r
 = 
	`©oi
(
İrg
);

618 
sys_Ï‹ncy
 = 
”r
 <= 0 ? 0 :ƒrr;

621 
fÜm©
 = 
	`¢d_pcm_fÜm©_v®ue
(
İrg
);

622 ià(
fÜm©
 =ğ
SND_PCM_FORMAT_UNKNOWN
) {

623 
	`´štf
("Unknown format, settingo default S16_LE\n");

624 
fÜm©
 = 
SND_PCM_FORMAT_S16_LE
;

628 
”r
 = 
	`©oi
(
İrg
);

629 
chªÃls
 = 
”r
 >= 1 &&ƒrr < 1024 ?ƒrr : 1;

632 
”r
 = 
	`©oi
(
İrg
);

633 
¿‹
 = 
”r
 >= 4000 &&ƒrr < 200000 ?ƒrr : 44100;

636 
”r
 = 
	`©oi
(
İrg
);

637 
bufãr_size
 = 
”r
 >= 32 &&ƒrr < 200000 ?ƒrr : 0;

640 
”r
 = 
	`©oi
(
İrg
);

641 
³riod_size
 = 
”r
 >= 32 &&ƒrr < 200000 ?ƒrr : 0;

644 
”r
 = 
	`©oi
(
İrg
);

645 
loİ_£c
 = 
”r
 >= 1 &&ƒrr <= 100000 ?ƒrr : 30;

648 
block
 = 1;

651 
u£_pŞl
 = 1;

654 
u¦“p_v®
 = 
	`©oi
(
İrg
);

657 
efãù
 = 1;

660 
»§m¶e
 = 0;

663 
pos_dump
 = 1;

666 
»®time_check
 = 1;

669 
sched_pŞicy
 = 
İrg
;

674 ià(
mÜeh–p
) {

675 
	`h–p
();

678 
”r
 = 
	`¢d_ouut_¡dio_©ch
(&
ouut
, 
¡dout
, 0);

679 ià(
”r
 < 0) {

680 
	`´štf
("Ouuˆçed: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

684 
loİ_lim™
 = 
loİ_£c
 * 
¿‹
;

685 
Ï‹ncy
 = 
Ï‹ncy_mš
 - 4;

686 
bufãr
 = 
	`m®loc
((
Ï‹ncy_max
 * 2 * 
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
è/ 8è* 
chªÃls
);

689 ià(
sys_Ï‹ncy
 > 0) {

690 
block
 = 0;

691 
u£_pŞl
 = 0;

694 
	`£tscheduËr
();

696 
	`´štf
("PÏyback deviû i %s\n", 
pdeviû
);

697 
	`´štf
("C­tu» deviû i %s\n", 
cdeviû
);

698 
	`´štf
("Parameters‡re %iHz, %s, %i channels, %s mode, use…oll %s\n",

699 
¿‹
, 
	`¢d_pcm_fÜm©_Çme
(
fÜm©
),

700 
chªÃls
, 
block
 ? "blocking" : "non-blocking",

701 
u£_pŞl
 ? "yes" : "no");

702 
	`´štf
("Loop†imit is %lu frames, minimum†atency = %i, maximum†atency = %i",

703 
loİ_lim™
, 
Ï‹ncy_mš
 * 2, 
Ï‹ncy_max
 * 2);

704 ià(
sys_Ï‹ncy
 > 0)

705 
	`´štf
(", I/O upd©e %ims", 
sys_Ï‹ncy
);

706 ià(!
block
 && !
u£_pŞl
)

707 
	`´štf
(", I/O u¦“°%ius", 
u¦“p_v®
);

708 
	`´štf
("\n");

710 ià((
”r
 = 
	`¢d_pcm_İ’
(&
phªdË
, 
pdeviû
, 
SND_PCM_STREAM_PLAYBACK
, 
block
 ? 0 : 
SND_PCM_NONBLOCK
)) < 0) {

711 
	`´štf
("PÏyback o³À”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

714 ià((
”r
 = 
	`¢d_pcm_İ’
(&
chªdË
, 
cdeviû
, 
SND_PCM_STREAM_CAPTURE
, 
block
 ? 0 : 
SND_PCM_NONBLOCK
)) < 0) {

715 
	`´štf
("RecÜd o³À”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

720 ià(
efãù
) {

721 
fs
 = (è
¿‹
;

722 
BW
 = 
FILTER_BANDWIDTH
;

724 
lfo
 = 0;

725 
dlfo
 = 2.*
M_PI
*
FILTERSWEEP_LFO_FREQ
/
fs
;

727 
x
[0] = (*è
	`m®loc
(
chªÃls
*());

728 
x
[1] = (*è
	`m®loc
(
chªÃls
*());

729 
x
[2] = (*è
	`m®loc
(
chªÃls
*());

730 
y
[0] = (*è
	`m®loc
(
chªÃls
*());

731 
y
[1] = (*è
	`m®loc
(
chªÃls
*());

732 
y
[2] = (*è
	`m®loc
(
chªÃls
*());

735 
ÿp_ava_max
 = 0;

736 
pbk_fl_mš
 = 
Ï‹ncy
 * 2;

739 
äames_š
 = 
äames_out
 = 0;

740 ià(
	`£¬ams
(
phªdË
, 
chªdË
, &
Ï‹ncy
) < 0)

742 
	`showÏ‹ncy
(
Ï‹ncy
);

743 ià((
”r
 = 
	`¢d_pcm_lšk
(
chªdË
, 
phªdË
)) < 0) {

744 
	`´štf
("SŒ—m lškƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

745 
	`ex™
(0);

747 ià(
	`¢d_pcm_fÜm©_£t_s’û
(
fÜm©
, 
bufãr
, 
Ï‹ncy
 * 
chªÃls
) < 0) {

748 
	`årštf
(
¡d”r
, "silenceƒrror\n");

751 ià(
	`wr™ebuf
(
phªdË
, 
bufãr
, 
Ï‹ncy
, &
äames_out
) < 0) {

752 
	`årštf
(
¡d”r
, "writeƒrror\n");

755 ià(
	`wr™ebuf
(
phªdË
, 
bufãr
, 
Ï‹ncy
, &
äames_out
) < 0) {

756 
	`årštf
(
¡d”r
, "writeƒrror\n");

760 ià(
»®time_check
)

761 
	`time¡amp_now
(&
t¡amp_¡¬t
);

762 ià((
”r
 = 
	`¢d_pcm_¡¬t
(
chªdË
)) < 0) {

763 
	`´štf
("GØ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

764 
	`ex™
(0);

766 ià(
»®time_check
)

767 
	`´štf
("[%Îdus] SŒ—m s¹\n", 
	`time¡amp_diff_miüo
(&
t¡amp_¡¬t
));

768 
	`g‘time¡amp
(
phªdË
, &
p_t¡amp
);

769 
	`g‘time¡amp
(
chªdË
, &
c_t¡amp
);

771 
	`´štf
("Playback:\n");

772 
	`show¡©
(
phªdË
, 
äames_out
);

773 
	`´štf
("Capture:\n");

774 
	`show¡©
(
chªdË
, 
äames_š
);

777 
ok
 = 1;

778 
š_max
 = 0;

779 
ok
 && 
äames_š
 < 
loİ_lim™
) {

780 
ÿp_ava
 = 
Ï‹ncy
;

781 ià(
sys_Ï‹ncy
 > 0) {

782 
	`pŞl
(
NULL
, 0, 
sys_Ï‹ncy
);

783 
ÿp_ava
 = 
	`g‘_ava
(
chªdË
);

784 ià(
ÿp_ava
 < 0) {

785 
	`´štf
("Ava faed: %s\n", 
	`¢d_¡»¼Ü
(
ÿp_ava
));

786 
ok
 = 0;

789 } ià(
u£_pŞl
) {

791 
	`¢d_pcm_wa™
(
chªdË
, 1000);

792 } ià(!
block
 && 
u¦“p_v®
 > 0) {

793 
	`u¦“p
(
u¦“p_v®
);

795 ià(
pos_dump
 || 
»®time_check
) {

796 ià(
sys_Ï‹ncy
 <= 0)

797 
ÿp_ava
 = 
	`g‘_ava
(
chªdË
);

798 
pbk_fl
 = 
	`g‘_ava
(
phªdË
);

799 ià(
pbk_fl
 >= 0)

800 
pbk_fl
 = 
¶ayback_bufãr_size
 -…bk_fill;

801 ià(
ÿp_ava
 > 
ÿp_ava_max
)

802 
ÿp_ava_max
 = 
ÿp_ava
;

803 ià(
pbk_fl
 >ğ0 &&…bk_fÈ< 
pbk_fl_mš
)

804 
pbk_fl_mš
 = 
pbk_fl
;

805 ià(
»®time_check
) {

806 
diff
 = 
	`time¡amp_diff_miüo
(&
t¡amp_¡¬t
);

807 
ÿp_pos
 = 
	`äames_to_miüo
(
äames_š
 + 
ÿp_ava
);

808 
pbk_pos
 = 
	`äames_to_miüo
(
äames_out
 - 
pbk_fl
);

809 
	`´štf
("[%lldus] POS:…=%zd (min=%zd,„t=%lldus) c=%zd (max=%zd,„t=%lldus)\n",

810 
diff
, 
pbk_fl
, 
pbk_fl_mš
, 
pbk_pos
 - diff,

811 
ÿp_ava
, 
ÿp_ava_max
, 
ÿp_pos
 - 
diff
);

812 } ià(
pos_dump
) {

813 
	`´štf
("POS:…=%zd (min=%zd), c=%zd (max=%zd)\n",

814 
pbk_fl
, 
pbk_fl_mš
, 
ÿp_ava
, 
ÿp_ava_max
);

817 ià((
r
 = 
	`»adbuf
(
chªdË
, 
bufãr
, 
ÿp_ava
, &
äames_š
, &
š_max
)) < 0)

818 
ok
 = 0;

820 ià(
efãù
)

821 
	`­¶yefãù
(
bufãr
, 
r
);

822 ià(
	`wr™ebuf
(
phªdË
, 
bufãr
, 
r
, &
äames_out
) < 0)

823 
ok
 = 0;

826 ià(
ok
)

827 
	`´štf
("Success\n");

829 
	`´štf
("Failure\n");

830 
	`´štf
("Playback:\n");

831 
	`show¡©
(
phªdË
, 
äames_out
);

832 
	`´štf
("Capture:\n");

833 
	`show¡©
(
chªdË
, 
äames_š
);

834 
	`showšmax
(
š_max
);

835 ià(
p_t¡amp
.
tv_£c
 =ğ
c_t¡amp
.tv_sec &&

836 
p_t¡amp
.
tv_u£c
 =ğ
c_t¡amp
.tv_usec)

837 
	`´štf
("Hardware sync\n");

838 ià(
»®time_check
) {

839 
diff
 = 
	`time¡amp_diff_miüo
(&
t¡amp_¡¬t
);

840 
mtime
 = 
	`äames_to_miüo
(
äames_š
);

841 
	`´štf
("EÏp£d„—Ètime: %Îdus\n", 
diff
);

842 
	`´štf
("EÏp£d deviûime: %Îdus\n", 
mtime
);

843 
	`´štf
("Te¡imdifà(deviû -„—l): %Îdus\n", 
mtime
 - 
diff
);

845 
	`¢d_pcm_drİ
(
chªdË
);

846 
	`¢d_pcm_nÚblock
(
phªdË
, 0);

847 
	`¢d_pcm_d¿š
(
phªdË
);

848 
	`¢d_pcm_nÚblock
(
phªdË
, !
block
 ? 1 : 0);

849 ià(
ok
) {

851 
	`´štf
("Playbackime = %li.%i, Recordime = %li.%i, diff = %li\n",

852 ()
p_t¡amp
.
tv_£c
,

853 ()
p_t¡amp
.
tv_u£c
,

854 ()
c_t¡amp
.
tv_£c
,

855 ()
c_t¡amp
.
tv_u£c
,

856 
	`timediff
(
p_t¡amp
, 
c_t¡amp
));

860 
	`¢d_pcm_uÆšk
(
chªdË
);

861 
	`¢d_pcm_hw_ä“
(
phªdË
);

862 
	`¢d_pcm_hw_ä“
(
chªdË
);

864 
	`¢d_pcm_şo£
(
phªdË
);

865 
	`¢d_pcm_şo£
(
chªdË
);

866 
	`¢d_ouut_şo£
(
ouut
);

867 
	`¢d_cÚfig_upd©e_ä“_glob®
();

868 
	`ä“
(
bufãr
);

869 
	`ä“
(
pdeviû
);

870 
	`ä“
(
cdeviû
);

872 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/lsb/config.c

1 
	~<¡dlib.h
>

2 
	~<¡ršg.h
>

3 
	~<”ºo.h
>

4 
	~"‹¡.h
"

6 
cÚfigs_equ®
(
¢d_cÚfig_t
 *
c1
, snd_cÚfig_ˆ*
c2
);

9 
	$sub£t_of
(
¢d_cÚfig_t
 *
c1
, snd_cÚfig_ˆ*
c2
)

11 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

12 
¢d_cÚfig_t
 *
e1
, *
e2
;

13 cÚ¡ *
id
;

15 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
c1
) {

16 
e1
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

17 ià(
	`¢d_cÚfig_g‘_id
(
e1
, &
id
) < 0 || !id)

19 ià(
	`¢d_cÚfig_£¬ch
(
c2
, 
id
, &
e2
) < 0)

21 ià(!
	`cÚfigs_equ®
(
e1
, 
e2
))

25 
	}
}

28 
	$cÚfigs_equ®
(
¢d_cÚfig_t
 *
c1
, snd_cÚfig_ˆ*
c2
)

30 
i1
, 
i2
;

31 
i641
, 
i642
;

32 cÚ¡ *
s1
, *
s2
;

34 ià(
	`¢d_cÚfig_g‘_ty³
(
c1
è!ğ¢d_cÚfig_g‘_ty³(
c2
))

36 
	`¢d_cÚfig_g‘_ty³
(
c1
)) {

37 
SND_CONFIG_TYPE_INTEGER
:

38  
	`¢d_cÚfig_g‘_š‹g”
(
c1
, &
i1
) >= 0 &&

39 
	`¢d_cÚfig_g‘_š‹g”
(
c2
, &
i2
) >= 0 &&

40 
i1
 =ğ
i2
;

41 
SND_CONFIG_TYPE_INTEGER64
:

42  
	`¢d_cÚfig_g‘_š‹g”64
(
c1
, &
i641
) >= 0 &&

43 
	`¢d_cÚfig_g‘_š‹g”64
(
c2
, &
i642
) >= 0 &&

44 
i641
 =ğ
i642
;

45 
SND_CONFIG_TYPE_STRING
:

46  
	`¢d_cÚfig_g‘_¡ršg
(
c1
, &
s1
) >= 0 &&

47 
	`¢d_cÚfig_g‘_¡ršg
(
c2
, &
s2
) >= 0 &&

48 !
s1
 =ğ!
s2
 &&

49 (!
s1
 || !
	`¡rcmp
(s1, 
s2
));

50 
SND_CONFIG_TYPE_COMPOUND
:

51  
	`sub£t_of
(
c1
, 
c2
) && subset_of(c2, c1);

53 
	`årštf
(
¡d”r
, "unknown configuration‚odeype %d\n",

54 ()
	`¢d_cÚfig_g‘_ty³
(
c1
));

57 
	}
}

59 
	$‹¡_tİ
()

61 
¢d_cÚfig_t
 *
tİ
;

62 cÚ¡ *
id
;

64 ià(
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
tİ
)) < 0)

67 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_ty³
(
tİ
è=ğ
SND_CONFIG_TYPE_COMPOUND
);

68 
	`TEST_CHECK
(
	`¢d_cÚfig_™”©Ü_fœ¡
(
tİ
è=ğ
	`¢d_cÚfig_™”©Ü_’d
(top));

69 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_id
(
tİ
, &
id
è>ğ0 && id =ğ
NULL
);

71 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
tİ
));

72 
	}
}

74 
	$‹¡_lßd
()

76 cÚ¡ *
cÚfig_‹xt1
 = "s='world';";

77 cÚ¡ *
cÚfig_‹xt2
 = "c.elem 0";

78 
¢d_cÚfig_t
 *
lßded
, *
made
, *
c
, *
c2
;

79 
¢d_šput_t
 *
šput
;

81 
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
lßded
));

82 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_š‹g”
(&
c
, "i", 42));

83 
	`ALSA_CHECK
(
	`¢d_cÚfig_add
(
lßded
, 
c
));

84 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_¡ršg
(&
c
, "s", "hello"));

85 
	`ALSA_CHECK
(
	`¢d_cÚfig_add
(
lßded
, 
c
));

87 
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
made
));

88 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_¡ršg
(&
c
, "s", "world"));

89 
	`ALSA_CHECK
(
	`¢d_cÚfig_add
(
made
, 
c
));

90 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_š‹g”
(&
c
, "i", 42));

91 
	`ALSA_CHECK
(
	`¢d_cÚfig_add
(
made
, 
c
));

93 
	`ALSA_CHECK
(
	`¢d_šput_bufãr_İ’
(&
šput
, 
cÚfig_‹xt1
, 
	`¡¾’
(config_text1)));

94 
	`ALSA_CHECK
(
	`¢d_cÚfig_lßd
(
lßded
, 
šput
));

95 
	`ALSA_CHECK
(
	`¢d_šput_şo£
(
šput
));

96 
	`TEST_CHECK
(
	`cÚfigs_equ®
(
lßded
, 
made
));

98 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_compound
(&
c
, "c", 0));

99 
	`ALSA_CHECK
(
	`¢d_cÚfig_add
(
made
, 
c
));

100 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_š‹g”
(&
c2
, "elem", 0));

101 
	`ALSA_CHECK
(
	`¢d_cÚfig_add
(
c
, 
c2
));

103 
	`ALSA_CHECK
(
	`¢d_šput_bufãr_İ’
(&
šput
, 
cÚfig_‹xt2
, 
	`¡¾’
(config_text2)));

104 
	`ALSA_CHECK
(
	`¢d_cÚfig_lßd
(
lßded
, 
šput
));

105 
	`ALSA_CHECK
(
	`¢d_šput_şo£
(
šput
));

106 
	`TEST_CHECK
(
	`cÚfigs_equ®
(
lßded
, 
made
));

108 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
lßded
));

109 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
made
));

110 
	}
}

112 
	$‹¡_§ve
()

114 cÚ¡ *
‹xt
 =

119 
¢d_cÚfig_t
 *
Üig
, *
§ved
;

120 
¢d_šput_t
 *
šput
;

121 
¢d_ouut_t
 *
ouut
;

122 *
buf
;

123 
size_t
 
buf_size
;

125 
	`ALSA_CHECK
(
	`¢d_šput_bufãr_İ’
(&
šput
, 
‹xt
, 
	`¡¾’
(text)));

126 
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
Üig
));

127 
	`ALSA_CHECK
(
	`¢d_cÚfig_lßd
(
Üig
, 
šput
));

128 
	`ALSA_CHECK
(
	`¢d_šput_şo£
(
šput
));

129 
	`ALSA_CHECK
(
	`¢d_ouut_bufãr_İ’
(&
ouut
));

130 
	`ALSA_CHECK
(
	`¢d_cÚfig_§ve
(
Üig
, 
ouut
));

131 
buf_size
 = 
	`¢d_ouut_bufãr_¡ršg
(
ouut
, &
buf
);

132 
	`ALSA_CHECK
(
	`¢d_šput_bufãr_İ’
(&
šput
, 
buf
, 
buf_size
));

133 
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
§ved
));

134 
	`ALSA_CHECK
(
	`¢d_cÚfig_lßd
(
§ved
, 
šput
));

135 
	`ALSA_CHECK
(
	`¢d_šput_şo£
(
šput
));

136 
	`ALSA_CHECK
(
	`¢d_ouut_şo£
(
ouut
));

137 
	`TEST_CHECK
(
	`cÚfigs_equ®
(
Üig
, 
§ved
));

138 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
Üig
));

139 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
§ved
));

140 
	}
}

142 
	$‹¡_upd©e
()

144 
	`ALSA_CHECK
(
	`¢d_cÚfig_upd©e_ä“_glob®
());

145 
	`TEST_CHECK
(
¢d_cÚfig
 =ğ
NULL
);

146 
	`ALSA_CHECK
(
	`¢d_cÚfig_upd©e
());

147 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_ty³
(
¢d_cÚfig
è=ğ
SND_CONFIG_TYPE_COMPOUND
);

148 
	`ALSA_CHECK
(
	`¢d_cÚfig_upd©e
());

149 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_ty³
(
¢d_cÚfig
è=ğ
SND_CONFIG_TYPE_COMPOUND
);

150 
	`ALSA_CHECK
(
	`¢d_cÚfig_upd©e_ä“_glob®
());

151 
	`TEST_CHECK
(
¢d_cÚfig
 =ğ
NULL
);

152 
	}
}

154 
	$‹¡_£¬ch
()

156 cÚ¡ *
‹xt
 =

164 
¢d_šput_t
 *
šput
;

165 
¢d_cÚfig_t
 *
tİ
, *
c
;

166 cÚ¡ *
id
;

168 
	`ALSA_CHECK
(
	`¢d_šput_bufãr_İ’
(&
šput
, 
‹xt
, 
	`¡¾’
(text)));

169 
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
tİ
));

170 
	`ALSA_CHECK
(
	`¢d_cÚfig_lßd
(
tİ
, 
šput
));

171 
	`ALSA_CHECK
(
	`¢d_šput_şo£
(
šput
));

173 
	`ALSA_CHECK
(
	`¢d_cÚfig_£¬ch
(
tİ
, "a", &
c
));

174 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_id
(
c
, &
id
));

175 
	`TEST_CHECK
(!
	`¡rcmp
(
id
, "a"));

176 
	`ALSA_CHECK
(
	`¢d_cÚfig_£¬ch
(
tİ
, "b.d.e", &
c
));

177 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_id
(
c
, &
id
));

178 
	`TEST_CHECK
(!
	`¡rcmp
(
id
, "e"));

179 
	`ALSA_CHECK
(
	`¢d_cÚfig_£¬ch
(
tİ
, "b.c", 
NULL
));

180 
	`TEST_CHECK
(
	`¢d_cÚfig_£¬ch
(
tİ
, "x", 
NULL
è=ğ-
ENOENT
);

181 
	`TEST_CHECK
(
	`¢d_cÚfig_£¬ch
(
tİ
, "b.y", &
c
è=ğ-
ENOENT
);

182 
	`TEST_CHECK
(
	`¢d_cÚfig_£¬ch
(
tİ
, "a.z", &
c
è=ğ-
ENOENT
);

184 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
tİ
));

185 
	}
}

187 
	$‹¡_£¬chv
()

189 cÚ¡ *
‹xt
 =

197 
¢d_šput_t
 *
šput
;

198 
¢d_cÚfig_t
 *
tİ
, *
c
;

199 cÚ¡ *
id
;

201 
	`ALSA_CHECK
(
	`¢d_šput_bufãr_İ’
(&
šput
, 
‹xt
, 
	`¡¾’
(text)));

202 
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
tİ
));

203 
	`ALSA_CHECK
(
	`¢d_cÚfig_lßd
(
tİ
, 
šput
));

204 
	`ALSA_CHECK
(
	`¢d_šput_şo£
(
šput
));

206 
	`ALSA_CHECK
(
	`¢d_cÚfig_£¬chv
(
tİ
, &
c
, "a", 
NULL
));

207 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_id
(
c
, &
id
));

208 
	`TEST_CHECK
(!
	`¡rcmp
(
id
, "a"));

209 
	`ALSA_CHECK
(
	`¢d_cÚfig_£¬chv
(
tİ
, &
c
, "b", "d.e", 
NULL
));

210 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_id
(
c
, &
id
));

211 
	`TEST_CHECK
(!
	`¡rcmp
(
id
, "e"));

212 
	`ALSA_CHECK
(
	`¢d_cÚfig_£¬chv
(
tİ
, 
NULL
, "b.c", NULL));

213 
	`TEST_CHECK
(
	`¢d_cÚfig_£¬chv
(
tİ
, 
NULL
, "x", NULLè=ğ-
ENOENT
);

214 
	`TEST_CHECK
(
	`¢d_cÚfig_£¬chv
(
tİ
, &
c
, "b.y", 
NULL
è=ğ-
ENOENT
);

215 
	`TEST_CHECK
(
	`¢d_cÚfig_£¬chv
(
tİ
, &
c
, "a", "z", 
NULL
è=ğ-
ENOENT
);

217 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
tİ
));

218 
	}
}

220 
	$‹¡_add
()

222 
¢d_cÚfig_t
 *
c1
, *
c2
, *
c3
, *
c4
, *
c5
;

223 
¢d_cÚfig_™”©Ü_t
 
i
;

224 
couÁ
 = 0;

226 
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
c1
));

227 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_š‹g”
(&
c2
, "c2", 0xc2));

228 
	`ALSA_CHECK
(
	`¢d_cÚfig_add
(
c1
, 
c2
));

229 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_¡ršg
(&
c3
, "c3", "c3"));

230 
	`ALSA_CHECK
(
	`¢d_cÚfig_add
(
c1
, 
c3
));

231 
i
 = 
	`¢d_cÚfig_™”©Ü_fœ¡
(
c1
);

232 
i
 !ğ
	`¢d_cÚfig_™”©Ü_’d
(
c1
);

233 
i
 = 
	`¢d_cÚfig_™”©Ü_Ãxt
(i))

234 ++
couÁ
;

235 
	`TEST_CHECK
(
couÁ
 == 2);

236 
	`ALSA_CHECK
(
	`¢d_cÚfig_£¬ch
(
c1
, "c2", &
c2
));

237 
	`ALSA_CHECK
(
	`¢d_cÚfig_£¬ch
(
c1
, "c3", &
c3
));

238 
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
c4
));

239 
	`TEST_CHECK
(
	`¢d_cÚfig_add
(
c1
, 
c4
è=ğ-
EINVAL
);

240 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_š‹g”
(&
c5
, "c5", 5));

241 
	`ALSA_CHECK
(
	`¢d_cÚfig_add
(
c4
, 
c5
));

242 
	`TEST_CHECK
(
	`¢d_cÚfig_add
(
c1
, 
c5
è=ğ-
EINVAL
);

243 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c4
));

244 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_š‹g”
(&
c3
, "c3", 333));

245 
	`TEST_CHECK
(
	`¢d_cÚfig_add
(
c1
, 
c3
è=ğ-
EEXIST
);

246 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c3
));

247 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c1
));

248 
	}
}

250 
	$‹¡_d–‘e
()

252 
¢d_cÚfig_t
 *
c
;

254 
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
c
));

255 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

256 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_¡ršg
(&
c
, "s", "..."));

257 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

258 
	}
}

260 
	$‹¡_cİy
()

262 
¢d_cÚfig_t
 *
c1
, *
c2
, *
c3
;

263 
v®ue
;

265 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_š‹g”
(&
c1
, "c1", 123));

266 
	`ALSA_CHECK
(
	`¢d_cÚfig_cİy
(&
c2
, 
c1
));

267 
	`ALSA_CHECK
(
	`¢d_cÚfig_£t_š‹g”
(
c1
, 456));

268 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_ty³
(
c2
è=ğ
SND_CONFIG_TYPE_INTEGER
);

269 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_š‹g”
(
c2
, &
v®ue
));

270 
	`TEST_CHECK
(
v®ue
 == 123);

271 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c1
));

272 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c2
));

273 
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
c1
));

274 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_š‹g”
(&
c2
, "a", 1));

275 
	`ALSA_CHECK
(
	`¢d_cÚfig_add
(
c1
, 
c2
));

276 
	`ALSA_CHECK
(
	`¢d_cÚfig_cİy
(&
c3
, 
c1
));

277 
	`ALSA_CHECK
(
	`¢d_cÚfig_£t_š‹g”
(
c2
, 2));

278 
	`TEST_CHECK
(!
	`cÚfigs_equ®
(
c1
, 
c3
));

279 
	`ALSA_CHECK
(
	`¢d_cÚfig_£¬ch
(
c3
, "a", &
c2
));

280 
	`ALSA_CHECK
(
	`¢d_cÚfig_£t_š‹g”
(
c2
, 2));

281 
	`TEST_CHECK
(
	`cÚfigs_equ®
(
c1
, 
c3
));

282 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c1
));

283 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c3
));

284 
	}
}

286 
	$‹¡_make_š‹g”
()

288 
¢d_cÚfig_t
 *
c
;

289 cÚ¡ *
id
;

290 
v®ue
;

292 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_š‹g”
(&
c
, "i"));

293 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_ty³
(
c
è=ğ
SND_CONFIG_TYPE_INTEGER
);

294 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_id
(
c
, &
id
));

295 
	`TEST_CHECK
(!
	`¡rcmp
(
id
, "i"));

296 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_š‹g”
(
c
, &
v®ue
));

297 
	`TEST_CHECK
(
v®ue
 == 0);

298 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

299 
	}
}

301 
	$‹¡_make_š‹g”64
()

303 
¢d_cÚfig_t
 *
c
;

304 cÚ¡ *
id
;

305 
v®ue
;

307 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_š‹g”64
(&
c
, "i"));

308 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_ty³
(
c
è=ğ
SND_CONFIG_TYPE_INTEGER64
);

309 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_id
(
c
, &
id
));

310 
	`TEST_CHECK
(!
	`¡rcmp
(
id
, "i"));

311 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_š‹g”64
(
c
, &
v®ue
));

312 
	`TEST_CHECK
(
v®ue
 == 0);

313 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

314 
	}
}

316 
	$‹¡_make_¡ršg
()

318 
¢d_cÚfig_t
 *
c
;

319 cÚ¡ *
id
;

320 cÚ¡ *
v®ue
;

322 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_¡ršg
(&
c
, "s"));

323 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_ty³
(
c
è=ğ
SND_CONFIG_TYPE_STRING
);

324 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_id
(
c
, &
id
));

325 
	`TEST_CHECK
(!
	`¡rcmp
(
id
, "s"));

326 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_¡ršg
(
c
, &
v®ue
));

327 
	`TEST_CHECK
(
v®ue
 =ğ
NULL
);

328 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

329 
	}
}

331 
	$‹¡_make_compound
()

333 
¢d_cÚfig_t
 *
c
;

334 cÚ¡ *
id
;

336 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_compound
(&
c
, "c", 0));

337 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_ty³
(
c
è=ğ
SND_CONFIG_TYPE_COMPOUND
);

338 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_id
(
c
, &
id
));

339 
	`TEST_CHECK
(!
	`¡rcmp
(
id
, "c"));

340 
	`TEST_CHECK
(
	`¢d_cÚfig_™”©Ü_fœ¡
(
c
è=ğ
	`¢d_cÚfig_™”©Ü_’d
(c));

341 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

342 
	}
}

344 
	$‹¡_imake_š‹g”
()

346 
¢d_cÚfig_t
 *
c
;

347 cÚ¡ *
id
;

348 
v®ue
;

350 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_š‹g”
(&
c
, "i", 123));

351 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_ty³
(
c
è=ğ
SND_CONFIG_TYPE_INTEGER
);

352 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_id
(
c
, &
id
));

353 
	`TEST_CHECK
(!
	`¡rcmp
(
id
, "i"));

354 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_š‹g”
(
c
, &
v®ue
));

355 
	`TEST_CHECK
(
v®ue
 == 123);

356 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

357 
	}
}

359 
	$‹¡_imake_š‹g”64
()

361 
¢d_cÚfig_t
 *
c
;

362 cÚ¡ *
id
;

363 
v®ue
;

365 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_š‹g”64
(&
c
, "i", 123456789012345LL));

366 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_ty³
(
c
è=ğ
SND_CONFIG_TYPE_INTEGER64
);

367 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_id
(
c
, &
id
));

368 
	`TEST_CHECK
(!
	`¡rcmp
(
id
, "i"));

369 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_š‹g”64
(
c
, &
v®ue
));

370 
	`TEST_CHECK
(
v®ue
 == 123456789012345LL);

371 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

372 
	}
}

374 
	$‹¡_imake_¡ršg
()

376 
¢d_cÚfig_t
 *
c
;

377 cÚ¡ *
id
;

378 cÚ¡ *
v®ue
;

380 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_¡ršg
(&
c
, "s", "xyzzy"));

381 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_ty³
(
c
è=ğ
SND_CONFIG_TYPE_STRING
);

382 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_id
(
c
, &
id
));

383 
	`TEST_CHECK
(!
	`¡rcmp
(
id
, "s"));

384 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_¡ršg
(
c
, &
v®ue
));

385 
	`TEST_CHECK
(!
	`¡rcmp
(
v®ue
, "xyzzy"));

386 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

387 
	}
}

389 
	$‹¡_g‘_ty³
()

391 
¢d_cÚfig_t
 *
c
;

393 
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
c
));

394 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_ty³
(
c
è=ğ
SND_CONFIG_TYPE_COMPOUND
);

395 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

396 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_š‹g”
(&
c
, "i"));

397 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_ty³
(
c
è=ğ
SND_CONFIG_TYPE_INTEGER
);

398 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

399 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_¡ršg
(&
c
, "s"));

400 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_ty³
(
c
è=ğ
SND_CONFIG_TYPE_STRING
);

401 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

402 
	}
}

404 
	$‹¡_£t_š‹g”
()

406 
¢d_cÚfig_t
 *
c
;

407 
v®ue
;

409 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_š‹g”
(&
c
, "i"));

410 
	`ALSA_CHECK
(
	`¢d_cÚfig_£t_š‹g”
(
c
, 123));

411 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_š‹g”
(
c
, &
v®ue
));

412 
	`TEST_CHECK
(
v®ue
 == 123);

413 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

414 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_¡ršg
(&
c
, "s"));

415 
	`TEST_CHECK
(
	`¢d_cÚfig_£t_š‹g”
(
c
, 123è=ğ-
EINVAL
);

416 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

417 
	}
}

419 
	$‹¡_£t_š‹g”64
()

421 
¢d_cÚfig_t
 *
c
;

422 
v®ue
;

424 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_š‹g”64
(&
c
, "i"));

425 
	`ALSA_CHECK
(
	`¢d_cÚfig_£t_š‹g”64
(
c
, 123456789012345LL));

426 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_š‹g”64
(
c
, &
v®ue
));

427 
	`TEST_CHECK
(
v®ue
 == 123456789012345LL);

428 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

429 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_¡ršg
(&
c
, "s"));

430 
	`TEST_CHECK
(
	`¢d_cÚfig_£t_š‹g”64
(
c
, 123è=ğ-
EINVAL
);

431 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

432 
	}
}

434 
	$‹¡_£t_¡ršg
()

436 
¢d_cÚfig_t
 *
c
;

437 cÚ¡ *
v®ue
;

439 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_¡ršg
(&
c
, "s"));

440 
	`ALSA_CHECK
(
	`¢d_cÚfig_£t_¡ršg
(
c
, "string"));

441 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_¡ršg
(
c
, &
v®ue
));

442 
	`TEST_CHECK
(!
	`¡rcmp
(
v®ue
, "string"));

443 
	`ALSA_CHECK
(
	`¢d_cÚfig_£t_¡ršg
(
c
, 
NULL
));

444 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_¡ršg
(
c
, &
v®ue
));

445 
	`TEST_CHECK
(
v®ue
 =ğ
NULL
);

446 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

447 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_š‹g”
(&
c
, "i"));

448 
	`TEST_CHECK
(
	`¢d_cÚfig_£t_¡ršg
(
c
, ""è=ğ-
EINVAL
);

449 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

450 
	}
}

452 
	$‹¡_£t_ascii
()

454 
¢d_cÚfig_t
 *
c
;

455 cÚ¡ *
s
;

456 
i
;

458 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_¡ršg
(&
c
, "s"));

459 
	`ALSA_CHECK
(
	`¢d_cÚfig_£t_ascii
(
c
, "foo"));

460 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_¡ršg
(
c
, &
s
));

461 
	`TEST_CHECK
(!
	`¡rcmp
(
s
, "foo"));

462 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

463 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_š‹g”
(&
c
, "i"));

464 
	`ALSA_CHECK
(
	`¢d_cÚfig_£t_ascii
(
c
, "23"));

465 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_š‹g”
(
c
, &
i
));

466 
	`TEST_CHECK
(
i
 == 23);

467 
	`TEST_CHECK
(
	`¢d_cÚfig_£t_ascii
(
c
, "h®àblue"è=ğ-
EINVAL
);

468 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

469 
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
c
));

470 
	`TEST_CHECK
(
	`¢d_cÚfig_£t_ascii
(
c
, "0"è=ğ-
EINVAL
);

471 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

472 
	}
}

474 
	$‹¡_g‘_id
()

476 
¢d_cÚfig_t
 *
c
;

477 cÚ¡ *
id
;

479 
	`ALSA_CHECK
(
	`¢d_cÚfig_make_š‹g”
(&
c
, "my_id"));

480 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_id
(
c
, &
id
));

481 
	`TEST_CHECK
(!
	`¡rcmp
(
id
, "my_id"));

482 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

483 
	}
}

485 
	#‹¡_g‘_š‹g”
 
‹¡_£t_š‹g”


	)

486 
	#‹¡_g‘_š‹g”64
 
‹¡_£t_š‹g”64


	)

487 
	#‹¡_g‘_¡ršg
 
‹¡_£t_¡ršg


	)

489 
	$‹¡_g‘_ascii
()

491 
¢d_cÚfig_t
 *
c
;

492 *
v®ue
;

494 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_š‹g”
(&
c
, "i", 123));

495 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_ascii
(
c
, &
v®ue
));

496 
	`TEST_CHECK
(!
	`¡rcmp
(
v®ue
, "123"));

497 
	`ä“
(
v®ue
);

498 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

499 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_¡ršg
(&
c
, "s", "bar"));

500 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_ascii
(
c
, &
v®ue
));

501 
	`TEST_CHECK
(!
	`¡rcmp
(
v®ue
, "bar"));

502 
	`ä“
(
v®ue
);

503 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

504 
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
c
));

505 
	`TEST_CHECK
(
	`¢d_cÚfig_g‘_ascii
(
c
, &
v®ue
è=ğ-
EINVAL
);

506 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

507 
	}
}

509 
	$‹¡_™”©Üs
()

511 
¢d_cÚfig_t
 *
c
, *
c2
;

512 
¢d_cÚfig_™”©Ü_t
 
i
;

513 
v
;

515 
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
c
));

516 
i
 = 
	`¢d_cÚfig_™”©Ü_fœ¡
(
c
);

517 
	`TEST_CHECK
(
i
 =ğ
	`¢d_cÚfig_™”©Ü_’d
(
c
));

518 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_š‹g”
(&
c2
, "one", 1));

519 
	`ALSA_CHECK
(
	`¢d_cÚfig_add
(
c
, 
c2
));

520 
i
 = 
	`¢d_cÚfig_™”©Ü_fœ¡
(
c
);

521 
	`TEST_CHECK
(
i
 !ğ
	`¢d_cÚfig_™”©Ü_’d
(
c
));

522 
c2
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

523 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_š‹g”
(
c2
, &
v
));

524 
	`TEST_CHECK
(
v
 == 1);

525 
i
 = 
	`¢d_cÚfig_™”©Ü_Ãxt
(i);

526 
	`TEST_CHECK
(
i
 =ğ
	`¢d_cÚfig_™”©Ü_’d
(
c
));

527 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

528 
	}
}

530 
	$‹¡_fÜ_—ch
()

532 
¢d_cÚfig_t
 *
c
, *
c2
;

533 
¢d_cÚfig_™”©Ü_t
 
i
, 
Ãxt
;

534 
v
;

535 
couÁ
 = 0;

537 
	`ALSA_CHECK
(
	`¢d_cÚfig_tİ
(&
c
));

538 
	`ALSA_CHECK
(
	`¢d_cÚfig_imake_š‹g”
(&
c2
, "one", 1));

539 
	`ALSA_CHECK
(
	`¢d_cÚfig_add
(
c
, 
c2
));

540 
	`¢d_cÚfig_fÜ_—ch
(
i
, 
Ãxt
, 
c
) {

541 
	`TEST_CHECK
(
i
 !ğ
	`¢d_cÚfig_™”©Ü_’d
(
c
));

542 
c2
 = 
	`¢d_cÚfig_™”©Ü_’Œy
(
i
);

543 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_š‹g”
(
c2
, &
v
));

544 
	`TEST_CHECK
(
v
 == 1);

545 ++
couÁ
;

547 
	`TEST_CHECK
(
couÁ
 == 1);

548 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
c
));

549 
	}
}

551 
	$_ex·nd_fú
(
¢d_cÚfig_t
 **
d¡
, cÚ¡ *
s
, *
´iv©e_d©a
 
ATTRIBUTE_UNUSED
)

553 ià(
	`¡rcmp
(
s
, "var10") == 0)

554  
	`¢d_cÚfig_imake_š‹g”
(
d¡
, 
NULL
, 10);

555 ià(
	`¡rcmp
(
s
, "var50") == 0)

556  
	`¢d_cÚfig_imake_š‹g”
(
d¡
, 
NULL
, 50);

557  
	`¢d_cÚfig_imake_¡ršg
(
d¡
, 
NULL
, "");

558 
	}
}

560 
	$‹¡_ev®u©e_¡ršg
()

563 cÚ¡ *
ex´
;

564 
»suÉ
;

565 } *
p
, 
e
[] = {

566 { .
ex´
 = "$v¬10", .
»suÉ
 = 10 },

567 { .
ex´
 = "$v¬50", .
»suÉ
 = 50 },

568 { .
ex´
 = "$[1+1]", .
»suÉ
 = 2 },

569 { .
ex´
 = "$[10-5]", .
»suÉ
 = 5 },

570 { .
ex´
 = "$[10*5]", .
»suÉ
 = 50 },

571 { .
ex´
 = "$[15/5]", .
»suÉ
 = 3 },

572 { .
ex´
 = "$[12%5]", .
»suÉ
 = 2 },

573 { .
ex´
 = "$[0x¯|0x55]", .
»suÉ
 = 0xff },

574 { .
ex´
 = "$[0xff&0xfc]", .
»suÉ
 = 0xfc },

575 { .
ex´
 = "$[4294967296+10]", .
»suÉ
 = 4294967306LL },

576 { .
ex´
 = "$[$v¬10+1]", .
»suÉ
 = 11 },

577 { .
ex´
 = "$[$v¬10 + $v¬50]", .
»suÉ
 = 60 },

578 { .
ex´
 = "$[ $v¬10 + $[ $v¬50 + 10 ] ]", .
»suÉ
 = 70 },

579 { .
ex´
 = "$[ ( $v¬10 + ( $v¬50 + 112 ) ) + 5 ]", .
»suÉ
 = 177 },

580 { .
ex´
 = 
NULL
, .
»suÉ
 = 0 },

582 
¢d_cÚfig_t
 *
d¡
;

583 
l
;

584 
Î
;

586 
p
 = 
e
;…->
ex´
;…++) {

587 
	`ALSA_CHECK
(
	`¢d_cÚfig_ev®u©e_¡ršg
(&
d¡
, 
p
->
ex´
, 
_ex·nd_fú
, 
NULL
));

588 ià(
	`¢d_cÚfig_g‘_ty³
(
d¡
è=ğ
SND_CONFIG_TYPE_INTEGER
) {

589 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_š‹g”
(
d¡
, &
l
));

590 
	`TEST_CHECK
(
l
 =ğ
p
->
»suÉ
);

591 } ià(
	`¢d_cÚfig_g‘_ty³
(
d¡
è=ğ
SND_CONFIG_TYPE_INTEGER64
) {

592 
	`ALSA_CHECK
(
	`¢d_cÚfig_g‘_š‹g”64
(
d¡
, &
Î
));

593 
	`TEST_CHECK
(
Î
 =ğ
p
->
»suÉ
);

595 
	`ALSA_CHECK
(0);

597 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
d¡
));

599 
	}
}

601 
	$‹¡_lßd_¡ršg
()

603 cÚ¡ **
cfg
, *
cÚfigs
[] = {

607 
NULL


609 
¢d_cÚfig_t
 *
d¡
;

611 
cfg
 = 
cÚfigs
; *cfg; cfg++) {

612 
	`ALSA_CHECK
(
	`¢d_cÚfig_lßd_¡ršg
(&
d¡
, *
cfg
, 0));

613 
	`ALSA_CHECK
(
	`¢d_cÚfig_d–‘e
(
d¡
));

615 
	}
}

617 
	$maš
()

619 
	`‹¡_tİ
();

620 
	`‹¡_lßd
();

621 
	`‹¡_§ve
();

622 
	`‹¡_upd©e
();

623 
	`‹¡_£¬ch
();

624 
	`‹¡_£¬chv
();

625 
	`‹¡_add
();

626 
	`‹¡_d–‘e
();

627 
	`‹¡_cİy
();

628 
	`‹¡_make_š‹g”
();

629 
	`‹¡_make_š‹g”64
();

630 
	`‹¡_make_¡ršg
();

631 
	`‹¡_make_compound
();

632 
	`‹¡_imake_š‹g”
();

633 
	`‹¡_imake_š‹g”64
();

634 
	`‹¡_imake_¡ršg
();

635 
	`‹¡_g‘_ty³
();

636 
	`‹¡_£t_š‹g”
();

637 
	`‹¡_£t_š‹g”64
();

638 
	`‹¡_£t_¡ršg
();

639 
	`‹¡_£t_ascii
();

640 
	`‹¡_g‘_id
();

641 
	`‹¡_g‘_š‹g”
();

642 
	`‹¡_g‘_š‹g”64
();

643 
	`‹¡_g‘_¡ršg
();

644 
	`‹¡_g‘_ascii
();

645 
	`‹¡_™”©Üs
();

646 
	`‹¡_fÜ_—ch
();

647 
	`‹¡_ev®u©e_¡ršg
();

648 
	`‹¡_lßd_¡ršg
();

649  
	`TEST_EXIT_CODE
();

650 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/lsb/midi_event.c

1 
	~<¡dlib.h
>

2 
	~<¡ršg.h
>

3 
	~<”ºo.h
>

4 
	~<»gex.h
>

5 
	~"‹¡.h
"

11 
	$midi_m©ches_»gex
(*
midi
, 
couÁ
, cÚ¡ *
»gex
)

13 *
‹xt
;

14 
»gex_t
 
»
;

15 
»gm©ch_t
 
m©ch
;

16 
i
;

18 
‹xt
 = 
	`m®loc
(2 * 
couÁ
 + 1);

19 ià(!
‹xt
)

21 
i
 = 0; i < 
couÁ
; ++i)

22 
	`¥rštf
(
‹xt
 + 2 * 
i
, "%02x", 
midi
[i]);

23 ià(
	`»gcomp
(&
»
, 
»gex
, 
REG_EXTENDED
) != 0) {

24 
	`ä“
(
‹xt
);

27 
i
 = 
	`»gexec
(&
»
, 
‹xt
, 1, &
m©ch
, 0);

28 
i
 = i =ğ0 && 
m©ch
.
rm_so
 =ğ0 && m©ch.
rm_eo
 =ğ
	`¡¾’
(
‹xt
);

29 
	`»gä“
(&
»
);

30 
	`ä“
(
‹xt
);

31  
i
;

32 
	}
}

34 
	$‹¡_decode
()

36 
¢d_midi_ev’t_t
 *
midi_ev’t
;

37 
¢d_£q_ev’t_t
 
ev
;

38 
buf
[50];

39 
couÁ
;

41 ià(
	`ALSA_CHECK
(
	`¢d_midi_ev’t_Ãw
(256 , &
midi_ev’t
)) < 0)

44 
	#DECODE
(è
	`¢d_midi_ev’t_decode
(
midi_ev’t
, 
buf
, (buf), &
ev
)

	)

45 
	#BUF_MATCHES
(
¡r
è
	`midi_m©ches_»gex
(
buf
, 
couÁ
, sŒ)

	)

46 
	#DECODES_TO
(
¡r
è((
couÁ
 = 
	`DECODE
()), 
	`BUF_MATCHES
(¡r))

	)

48 
	`¢d_£q_ev_ş—r
(&
ev
);

50 
	`¢d_£q_ev_£t_fixed
(&
ev
);

51 
ev
.
ty³
 = 
SND_SEQ_EVENT_NONE
;

52 
	`TEST_CHECK
(
	`DECODE
(è=ğ-
ENOENT
);

54 
	`¢d_£q_ev_£t_nÙeoff
(&
ev
, 1, 2, 3);

55 
	`TEST_CHECK
(
	`DECODES_TO
("810203"));

57 
	`¢d_£q_ev_£t_nÙeÚ
(&
ev
, 4, 5, 6);

58 
	`TEST_CHECK
(
	`DECODES_TO
("940506"));

60 
	`¢d_£q_ev_£t_key´ess
(&
ev
, 7, 8, 9);

61 
	`TEST_CHECK
(
	`DECODES_TO
("a70809"));

63 
	`¢d_£q_ev_£t_cÚŒŞËr
(&
ev
, 10, 11, 12);

64 
	`TEST_CHECK
(
	`DECODES_TO
("ba0b0c"));

66 
	`¢d_£q_ev_£t_pgmchªge
(&
ev
, 13, 14);

67 
	`TEST_CHECK
(
	`DECODES_TO
("cd0e"));

69 
	`¢d_£q_ev_£t_chª´ess
(&
ev
, 15, 16);

70 
	`TEST_CHECK
(
	`DECODES_TO
("df10"));

72 
	`¢d_£q_ev_£t_p™chb’d
(&
ev
, 1, 0x222);

73 
	`TEST_CHECK
(
	`DECODES_TO
("e12244"));

75 
	`¢d_£q_ev_£t_sy£x
(&
ev
, 6, "\xf0\x7e\x7f\x06\x01\xf7");

76 
	`TEST_CHECK
(
	`DECODES_TO
("f07e7f0601f7"));

78 
	`¢d_£q_ev_£t_fixed
(&
ev
);

79 
ev
.
ty³
 = 
SND_SEQ_EVENT_QFRAME
;

80 
ev
.
d©a
.
cÚŒŞ
.
v®ue
 = 3;

81 
	`TEST_CHECK
(
	`DECODES_TO
("f103"));

83 
ev
.
ty³
 = 
SND_SEQ_EVENT_SONGPOS
;

84 
ev
.
d©a
.
cÚŒŞ
.
v®ue
 = 0x444;

85 
	`TEST_CHECK
(
	`DECODES_TO
("f24408"));

87 
ev
.
ty³
 = 
SND_SEQ_EVENT_SONGSEL
;

88 
ev
.
d©a
.
cÚŒŞ
.
v®ue
 = 5;

89 
	`TEST_CHECK
(
	`DECODES_TO
("f305"));

91 
ev
.
ty³
 = 
SND_SEQ_EVENT_TUNE_REQUEST
;

92 
	`TEST_CHECK
(
	`DECODES_TO
("f6"));

94 
ev
.
ty³
 = 
SND_SEQ_EVENT_CLOCK
;

95 
	`TEST_CHECK
(
	`DECODES_TO
("f8"));

97 
ev
.
ty³
 = 
SND_SEQ_EVENT_START
;

98 
	`TEST_CHECK
(
	`DECODES_TO
("fa"));

100 
ev
.
ty³
 = 
SND_SEQ_EVENT_CONTINUE
;

101 
	`TEST_CHECK
(
	`DECODES_TO
("fb"));

103 
ev
.
ty³
 = 
SND_SEQ_EVENT_STOP
;

104 
	`TEST_CHECK
(
	`DECODES_TO
("fc"));

106 
ev
.
ty³
 = 
SND_SEQ_EVENT_SENSING
;

107 
	`TEST_CHECK
(
	`DECODES_TO
("fe"));

109 
ev
.
ty³
 = 
SND_SEQ_EVENT_RESET
;

110 
	`TEST_CHECK
(
	`DECODES_TO
("ff"));

112 
ev
.
ty³
 = 
SND_SEQ_EVENT_CONTROL14
;

113 
ev
.
d©a
.
cÚŒŞ
.
chªÃl
 = 6;

114 
ev
.
d©a
.
cÚŒŞ
.
·¿m
 = 7;

115 
ev
.
d©a
.
cÚŒŞ
.
v®ue
 = 0x888;

120 
	`TEST_CHECK
(
	`DECODES_TO
("b6(0711(b6)?2708|2708(b6)?0711)"));

122 
ev
.
ty³
 = 
SND_SEQ_EVENT_NONREGPARAM
;

123 
ev
.
d©a
.
cÚŒŞ
.
chªÃl
 = 9;

124 
ev
.
d©a
.
cÚŒŞ
.
·¿m
 = 0xaaa;

125 
ev
.
d©a
.
cÚŒŞ
.
v®ue
 = 0xbbb;

126 
	`TEST_CHECK
(
	`DECODES_TO
("b9(622a(b9)?6315|6315(b9)?622a)(b9)?(0617(b9)?263b|263b(b9)?0617)"));

128 
ev
.
ty³
 = 
SND_SEQ_EVENT_REGPARAM
;

129 
ev
.
d©a
.
cÚŒŞ
.
chªÃl
 = 12;

130 
ev
.
d©a
.
cÚŒŞ
.
·¿m
 = 0xddd;

131 
ev
.
d©a
.
cÚŒŞ
.
v®ue
 = 0xeee;

132 
	`TEST_CHECK
(
	`DECODES_TO
("bc(645d(bc)?651b|651b(bc)?645d)(bc)?(061d(bc)?266e|266e(bc)?061d)"));

135 
	`¢d_£q_ev_£t_pgmchªge
(&
ev
, 0, 0x11);

136 
	`TEST_CHECK
(
	`DECODES_TO
("c011"));

137 
	`¢d_£q_ev_£t_sy£x
(&
ev
, 6, "\xf0\x7e\x7f\x09\x02\xf7");

138 
	`TEST_CHECK
(
	`DECODES_TO
("f07e7f0902f7"));

139 
	`¢d_£q_ev_£t_pgmchªge
(&
ev
, 0, 0x11);

140 
	`TEST_CHECK
(
	`DECODES_TO
("c011"));

143 
ev
.
ty³
 = 
SND_SEQ_EVENT_QFRAME
;

144 
ev
.
d©a
.
cÚŒŞ
.
v®ue
 = 0x11;

145 
	`TEST_CHECK
(
	`DECODES_TO
("f111"));

146 
	`TEST_CHECK
(
	`DECODES_TO
("f111"));

149 
	`TEST_CHECK
(
	`¢d_midi_ev’t_decode
(
midi_ev’t
, 
buf
, 1, &
ev
è=ğ-
ENOMEM
);

151 
	`¢d_midi_ev’t_ä“
(
midi_ev’t
);

152 
	}
}

154 
	$‹¡_»£t_decode
()

156 
¢d_midi_ev’t_t
 *
midi_ev’t
;

157 
¢d_£q_ev’t_t
 
ev
;

158 
buf
[50];

159 
couÁ
;

161 ià(
	`ALSA_CHECK
(
	`¢d_midi_ev’t_Ãw
(256 , &
midi_ev’t
)) < 0)

164 
	`¢d_£q_ev_ş—r
(&
ev
);

166 
	`¢d_£q_ev_£t_nÙeÚ
(&
ev
, 1, 2, 3);

167 
	`TEST_CHECK
(
	`DECODES_TO
("910203"));

169 
	`¢d_midi_ev’t_»£t_decode
(
midi_ev’t
);

171 
	`TEST_CHECK
(
	`DECODES_TO
("910203"));

173 
	`¢d_midi_ev’t_ä“
(
midi_ev’t
);

174 
	}
}

176 
	$‹¡_’code
()

178 
¢d_midi_ev’t_t
 *
midi_ev’t
;

179 
¢d_£q_ev’t_t
 
ev
;

181 ià(
	`ALSA_CHECK
(
	`¢d_midi_ev’t_Ãw
(256, &
midi_ev’t
)) < 0)

184 
	#ENCODE
(
¡r
è
	`¢d_midi_ev’t_’code
(
midi_ev’t
, \

185 (cÚ¡ *)
¡r
, \

186 (
¡r
è- 1, &
ev
)

	)

187 
	`TEST_CHECK
(
	`ENCODE
("\x81\x02\x03") == 3);

188 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_NOTEOFF
);

189 
	`TEST_CHECK
((
ev
.
æags
 & 
SND_SEQ_EVENT_LENGTH_MASK
è=ğ
SND_SEQ_EVENT_LENGTH_FIXED
);

190 
	`TEST_CHECK
(
ev
.
d©a
.
nÙe
.
chªÃl
 == 1);

191 
	`TEST_CHECK
(
ev
.
d©a
.
nÙe
.note == 2);

192 
	`TEST_CHECK
(
ev
.
d©a
.
nÙe
.
v–oc™y
 == 3);

194 
	`TEST_CHECK
(
	`ENCODE
("\x94\x05\x06") == 3);

195 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_NOTEON
);

196 
	`TEST_CHECK
(
ev
.
d©a
.
nÙe
.
chªÃl
 == 4);

197 
	`TEST_CHECK
(
ev
.
d©a
.
nÙe
.note == 5);

198 
	`TEST_CHECK
(
ev
.
d©a
.
nÙe
.
v–oc™y
 == 6);

200 
	`TEST_CHECK
(
	`ENCODE
("\xa7\x08\x09") == 3);

201 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_KEYPRESS
);

202 
	`TEST_CHECK
(
ev
.
d©a
.
nÙe
.
chªÃl
 == 7);

203 
	`TEST_CHECK
(
ev
.
d©a
.
nÙe
.note == 8);

204 
	`TEST_CHECK
(
ev
.
d©a
.
nÙe
.
v–oc™y
 == 9);

206 
	`TEST_CHECK
(
	`ENCODE
("\xba\x0b\x0c") == 3);

207 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_CONTROLLER
);

208 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
chªÃl
 == 10);

209 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
·¿m
 == 11);

210 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
v®ue
 == 12);

212 
	`TEST_CHECK
(
	`ENCODE
("\xcd\x0e") == 2);

213 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_PGMCHANGE
);

214 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
chªÃl
 == 13);

215 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
v®ue
 == 14);

217 
	`TEST_CHECK
(
	`ENCODE
("\xdf\x10") == 2);

218 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_CHANPRESS
);

219 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
chªÃl
 == 15);

220 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
v®ue
 == 16);

222 
	`TEST_CHECK
(
	`ENCODE
("\xe1\x22\x33") == 3);

223 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_PITCHBEND
);

224 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
chªÃl
 == 1);

225 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
v®ue
 == -1630);

227 
	`TEST_CHECK
(
	`ENCODE
("\xf0\x7f\x7f\x04\x01\x7f\x7f\xf7") == 8);

228 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_SYSEX
);

229 
	`TEST_CHECK
((
ev
.
æags
 & 
SND_SEQ_EVENT_LENGTH_MASK
è=ğ
SND_SEQ_EVENT_LENGTH_VARIABLE
);

230 
	`TEST_CHECK
(
ev
.
d©a
.
ext
.
Ën
 == 8);

231 
	`TEST_CHECK
(!
	`memcmp
(
ev
.
d©a
.
ext
.
±r
, "\xf0\x7f\x7f\x04\x01\x7f\x7f\xf7", 8));

233 
	`TEST_CHECK
(
	`ENCODE
("\xf1\x04") == 2);

234 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_QFRAME
);

235 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
v®ue
 == 4);

237 
	`TEST_CHECK
(
	`ENCODE
("\xf2\x55\x66") == 3);

238 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_SONGPOS
);

239 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
v®ue
 == 13141);

241 
	`TEST_CHECK
(
	`ENCODE
("\xf3\x07") == 2);

242 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_SONGSEL
);

243 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
v®ue
 == 7);

245 
	`TEST_CHECK
(
	`ENCODE
("\xf6") == 1);

246 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_TUNE_REQUEST
);

248 
	`TEST_CHECK
(
	`ENCODE
("\xf8") == 1);

249 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_CLOCK
);

251 
	`TEST_CHECK
(
	`ENCODE
("\xfa") == 1);

252 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_START
);

254 
	`TEST_CHECK
(
	`ENCODE
("\xfb") == 1);

255 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_CONTINUE
);

257 
	`TEST_CHECK
(
	`ENCODE
("\xfc") == 1);

258 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_STOP
);

260 
	`TEST_CHECK
(
	`ENCODE
("\xfe") == 1);

261 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_SENSING
);

263 
	`TEST_CHECK
(
	`ENCODE
("\xff") == 1);

264 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_RESET
);

266 
	`TEST_CHECK
(
	`ENCODE
("\xc1\xf8") == 2);

267 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_CLOCK
);

268 
	`TEST_CHECK
(
	`ENCODE
("\x22") == 1);

269 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_PGMCHANGE
);

270 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
chªÃl
 == 1);

271 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
v®ue
 == 0x22);

272 
	`TEST_CHECK
(
	`ENCODE
("\xf8") == 1);

273 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_CLOCK
);

274 
	`TEST_CHECK
(
	`ENCODE
("\x33") == 1);

275 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_PGMCHANGE
);

276 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
chªÃl
 == 1);

277 
	`TEST_CHECK
(
ev
.
d©a
.
cÚŒŞ
.
v®ue
 == 0x33);

279 
	`TEST_CHECK
(
	`ENCODE
("\xc1\xf6") == 2);

280 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_TUNE_REQUEST
);

281 
	`TEST_CHECK
(
	`ENCODE
("\x44\x44") == 2);

282 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_NONE
);

284 
	`¢d_midi_ev’t_ä“
(
midi_ev’t
);

285 
	}
}

287 
	$‹¡_»£t_’code
()

289 
¢d_midi_ev’t_t
 *
midi_ev’t
;

290 
¢d_£q_ev’t_t
 
ev
;

292 ià(
	`ALSA_CHECK
(
	`¢d_midi_ev’t_Ãw
(256, &
midi_ev’t
)) < 0)

295 
	`TEST_CHECK
(
	`ENCODE
("\x91\x02") == 2);

296 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_NONE
);

298 
	`¢d_midi_ev’t_»£t_’code
(
midi_ev’t
);

300 
	`TEST_CHECK
(
	`ENCODE
("\x03") == 1);

301 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_NONE
);

303 
	`¢d_midi_ev’t_ä“
(
midi_ev’t
);

304 
	}
}

306 
	$‹¡_š™
()

308 
¢d_midi_ev’t_t
 *
midi_ev’t
;

309 
¢d_£q_ev’t_t
 
ev
;

310 
buf
[50];

311 
couÁ
;

313 ià(
	`ALSA_CHECK
(
	`¢d_midi_ev’t_Ãw
(256, &
midi_ev’t
)) < 0)

316 
	`¢d_£q_ev_£t_nÙeÚ
(&
ev
, 1, 2, 3);

317 
	`TEST_CHECK
(
	`DECODES_TO
("910203"));

319 
	`TEST_CHECK
(
	`ENCODE
("\x94\x05") == 2);

320 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_NONE
);

322 
	`¢d_midi_ev’t_š™
(
midi_ev’t
);

324 
	`¢d_£q_ev_£t_nÙeÚ
(&
ev
, 1, 2, 3);

325 
	`TEST_CHECK
(
	`DECODES_TO
("910203"));

327 
	`TEST_CHECK
(
	`ENCODE
("\x06") == 1);

328 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_NONE
);

330 
	`¢d_midi_ev’t_ä“
(
midi_ev’t
);

331 
	}
}

333 
	$‹¡_’code_by‹
()

335 
¢d_midi_ev’t_t
 *
midi_ev’t
;

336 
¢d_£q_ev’t_t
 
ev
;

338 ià(
	`ALSA_CHECK
(
	`¢d_midi_ev’t_Ãw
(256, &
midi_ev’t
)) < 0)

341 
	#ENCODE_BYTE
(
c
è
	`¢d_midi_ev’t_’code_by‹
(
midi_ev’t
, c, &
ev
)

	)

342 
	`TEST_CHECK
(
	`ENCODE_BYTE
(0x81) == 0);

343 
	`TEST_CHECK
(
	`ENCODE_BYTE
(0x02) == 0);

344 
	`TEST_CHECK
(
	`ENCODE_BYTE
(0x03) == 1);

345 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_NOTEOFF
);

346 
	`TEST_CHECK
((
ev
.
æags
 & 
SND_SEQ_EVENT_LENGTH_MASK
è=ğ
SND_SEQ_EVENT_LENGTH_FIXED
);

347 
	`TEST_CHECK
(
ev
.
d©a
.
nÙe
.
chªÃl
 == 1);

348 
	`TEST_CHECK
(
ev
.
d©a
.
nÙe
.note == 2);

349 
	`TEST_CHECK
(
ev
.
d©a
.
nÙe
.
v–oc™y
 == 3);

350 
	`TEST_CHECK
(
	`ENCODE_BYTE
(0x04) == 0);

351 
	`TEST_CHECK
(
	`ENCODE_BYTE
(0xf8) == 1);

352 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_CLOCK
);

353 
	`TEST_CHECK
(
	`ENCODE_BYTE
(0x05) == 1);

354 
	`TEST_CHECK
(
ev
.
ty³
 =ğ
SND_SEQ_EVENT_NOTEOFF
);

355 
	`TEST_CHECK
(
ev
.
d©a
.
nÙe
.
chªÃl
 == 1);

356 
	`TEST_CHECK
(
ev
.
d©a
.
nÙe
.note == 4);

357 
	`TEST_CHECK
(
ev
.
d©a
.
nÙe
.
v–oc™y
 == 5);

359 
	`¢d_midi_ev’t_ä“
(
midi_ev’t
);

360 
	}
}

362 
	$maš
()

364 
	`‹¡_decode
();

365 
	`‹¡_»£t_decode
();

366 
	`‹¡_’code
();

367 
	`‹¡_»£t_’code
();

368 
	`‹¡_’code_by‹
();

369 
	`‹¡_š™
();

370  
	`TEST_EXIT_CODE
();

371 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/lsb/test.h

1 #iâdeà
TEST_H_INCLUDED


2 
	#TEST_H_INCLUDED


	)

4 
	~<¡dio.h
>

5 
	~<®§/asoundlib.h
>

8 
	gªy_‹¡_çed
;

10 
	#TEST_CHECK
(
cÚd
) do \

11 ià(!(
cÚd
)) { \

12 
	`årštf
(
¡d”r
, "%s:%d:e¡ faed: %s\n", 
__FILE__
, 
__LINE__
, #cond); \

13 
ªy_‹¡_çed
 = 1; \

15 0)

	)

17 
	#ALSA_CHECK
(
â
) ({ \

18 
”r
 = 
â
; \

19 ià(
”r
 < 0) { \

20 
	`årštf
(
¡d”r
, "%s:%d: ALSA function call failed (%s): %s\n", \

21 
__FILE__
, 
__LINE__
, 
	`¢d_¡»¼Ü
(
”r
), #fn); \

22 
ªy_‹¡_çed
 = 1; \

24 
”r
; \

25 })

	)

27 
	#TEST_EXIT_CODE
(è
ªy_‹¡_çed


	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/midifile.c

52 
	#NO_LC_DEFINES


	)

53 
	~"midife.h
"

54 #ifdeà
NO_LC_DEFINES


55 
	#sy¡em_exşusive
 0xf0

	)

56 
	#m‘a_ev’t
 0xFF

	)

57 
	#£t_‹mpo
 0x51

	)

58 
	#low”by‹
(
x
è(()(x & 0xff))

	)

59 
	#uµ”by‹
(
x
è(()((x & 0xff00)>>8))

	)

62 
	#NULLFUNC
 0

	)

64 
	#NULL
 0

	)

67 
	#THINK


	)

69 #ifdeà
THINK


70 
	~<¡dlib.h
>

73 
	~<¡dio.h
>

74 
	~<lim™s.h
>

76 
	~<¡ršg.h
>

82 (*
	gMf_g‘c
è(èğ
NULLFUNC
;

83 (*
	gMf_”rÜ
è(èğ
NULLFUNC
;

84 (*
	gMf_h—d”
è(èğ
NULLFUNC
;

85 (*
	gMf_Œack¡¬t
è(èğ
NULLFUNC
;

86 (*
	gMf_Œack’d
è(èğ
NULLFUNC
;

87 (*
	gMf_nÙeÚ
è(èğ
NULLFUNC
;

88 (*
	gMf_nÙeoff
è(èğ
NULLFUNC
;

89 (*
	gMf_´essu»
è(èğ
NULLFUNC
;

90 (*
	gMf_·¿m‘”
è(èğ
NULLFUNC
;

91 (*
	gMf_p™chb’d
è(èğ
NULLFUNC
;

92 (*
	gMf_´og¿m
è(èğ
NULLFUNC
;

93 (*
	gMf_chª´essu»
è(èğ
NULLFUNC
;

94 (*
	gMf_sy£x
è(èğ
NULLFUNC
;

95 (*
	gMf_¬b™¿ry
è(èğ
NULLFUNC
;

96 (*
	gMf_m‘amisc
è(èğ
NULLFUNC
;

97 (*
	gMf_£qnum
è(èğ
NULLFUNC
;

98 (*
	gMf_eÙ
è(èğ
NULLFUNC
;

99 (*
	gMf_sm±e
è(èğ
NULLFUNC
;

100 (*
	gMf_‹mpo
è(èğ
NULLFUNC
;

101 (*
	gMf_timesig
è(èğ
NULLFUNC
;

102 (*
	gMf_keysig
è(èğ
NULLFUNC
;

103 (*
	gMf_£q¥ecific
è(èğ
NULLFUNC
;

104 (*
	gMf_‹xt
è(èğ
NULLFUNC
;

107 (*
	gMf_putc
è(èğ
NULLFUNC
;

108 (*
	gMf_wr™‘¿ck
è(èğ
NULLFUNC
;

109 (*
	gMf_wr™‘empÙ¿ck
è(èğ
NULLFUNC
;

111 
	gMf_nom”ge
 = 0;

113 
	gMf_š‹¿ùive
 = 0;

114 
	gMf_cu¼time
 = 0L;

115 
	gMf_»®time
 = 0L;

116 
	gMf_f_»®time
 = 0;

117 
	gŞd_f_»®time
 = 0;

118 
	gMf_divisiÚ
 = 96;

119 
	gMf_cu¼‹mpo
 = 500000;

120 
	gŞd_cu¼‹mpo
 = 500000;

121 
	gŞd_»®time
 = 0;

122 
	gŞd_cu¼time
 = 0;

123 
	g»vi£d_time
 = 0;

124 
	g‹mpo_chªge_time
 = 0;

126 
	#MAX_HISTORY
 512

	)

127 
	g‹mpo_hi¡Üy
[
MAX_HISTORY
];

128 
	g‹mpo_hi¡Üy_time
[
MAX_HISTORY
];

129 
	g‹mpo_hi¡Üy_couÁ
 = 0;

132 
	gMf_tob”—d
 = 0L;

133 
	gMf_numby‹swr™‹n
 = 0L;

135 
»adv¬šum
 ();

136 
»ad32b™
 ();

137 
to32b™
 ();

138 
»ad16b™
 ();

139 
to16b™
 ();

140 *
msg
 ();

141 
»adh—d”
 ();

142 
»adŒack
 ();

143 
badby‹
 ();

144 
m‘«v’t
 ();

145 
sy£x
 ();

146 
chªmes§ge
 ();

147 
msgš™
 ();

148 
msgËng
 ();

149 
msgadd
 ();

150 
bigg”msg
 ();

151 
•utc
 ();

153 
mf_ticks2£c
 (
ticks
, 
divisiÚ
, 
‹mpo
);

154 
mf_wr™e_m‘a_ev’t
 ();

155 
mf_wr™e_‹mpo
 ();

156 
mf_wr™e_£qnum
 ();

157 
Wr™eV¬L’
 ();

159 #ifdeà
READ_MODS


160 
	~"mp_mod.c
"

161 
	gmod_fe_æag
 = 0;

163 
	gfÜû_ex™
;

166 
	$mä—d
 ()

168 
fÜû_ex™
 = 0;

169 ià(
Mf_g‘c
 =ğ
NULLFUNC
)

170 
	`mã¼Ü
 ("mfread() called without setting Mf_getc");

172 
	`»adh—d”
 ();

173 #ifdeà
READ_MODS


174 ià(
mod_fe_æag
)

175 
	`do_moduË
();

178 
	`»adŒack
 (è&& !
fÜû_ex™
)

180 
	}
}

184 
	$midife
 ()

186 
	`mä—d
 ();

187 
	}
}

191 
	$»admt
 (
s
)

192 *
s
;

194 
n
 = 0;

195 *
p
 = 
s
;

196 
c
;

198 
n
++ < 4 && (
c
 = (*
Mf_g‘c
è()è!ğ
EOF
)

200 ià(
c
 !ğ*
p
++)

202 
buff
[32];

203 ià(!
c
è(
EOF
);

204 ià(
c
 =ğ0x1aè(
EOF
);

205 (è
	`¡rıy
 (
buff
, "expecting ");

206 (è
	`¡rÿt
 (
buff
, 
s
);

207 
	`mã¼Ü
 (
buff
);

211  (
c
);

212 
	}
}

216 
	$eg‘c
 ()

218 
c
 = (*
Mf_g‘c
) ();

220 ià(
c
 =ğ
EOF
) {

221 
	`mã¼Ü
 ("premature EOF");

222 
fÜû_ex™
 = 1;

224 
Mf_tob”—d
--;

225  (
c
);

226 
	}
}

230 
	$»adh—d”
 ()

232 
fÜm©
, 
Árks
, 
divisiÚ
;

235 
Mf_divisiÚ
 = 96;

236 
Mf_cu¼‹mpo
 = 500000;

237 
Şd_cu¼‹mpo
 = 500000;

238 
‹mpo_hi¡Üy_couÁ
 = 0;

239 
‹mpo_hi¡Üy
[
‹mpo_hi¡Üy_couÁ
] = 
Mf_cu¼‹mpo
;

240 
‹mpo_hi¡Üy_time
[
‹mpo_hi¡Üy_couÁ
] = 0;

242 ià(
Mf_š‹¿ùive
)

244 
Mf_tob”—d
 = 0;

245 
fÜm©
 = 0;

246 
Árks
 = 1;

247 
divisiÚ
 = 96;

250 #ifdeà
READ_MODS


251 ià(!
	`¡ºcmp
(
Mf_fe_cÚ‹Ás
, "MThd", 4))

254 ià(
	`»admt
 ("MThd"è=ğ
EOF
)

257 
Mf_tob”—d
 = 
	`»ad32b™
 ();

258 
fÜm©
 = 
	`»ad16b™
 ();

259 
Árks
 = 
	`»ad16b™
 ();

260 
Mf_divisiÚ
 = 
divisiÚ
 = 
	`»ad16b™
 ();

262 #ifdeà
READ_MODS


265 
fÜm©
 = 0;

266 
Árks
 = 1;

267 
divisiÚ
 = 
Mf_divisiÚ
;

268 
Mf_tob”—d
 = 0;

269 
mod_fe_æag
 = 1;

273 ià(
Mf_h—d”
)

274 (*
Mf_h—d”
è(
fÜm©
, 
Árks
, 
divisiÚ
);

277 
Mf_tob”—d
 > 0 && !
fÜû_ex™
)

278 (è
	`eg‘c
 ();

279 
	}
}

285 
	$fšd_‹mpo
()

287 
i
;

288 
Şd_‹mpo
 = 
Mf_cu¼‹mpo
;

289 
Ãw_‹mpo
 = 
Mf_cu¼‹mpo
;

291 
i
 = 0; i <ğ
‹mpo_hi¡Üy_couÁ
; i++) {

292 ià(
‹mpo_hi¡Üy_time
[
i
] <ğ
Mf_cu¼time
è
Şd_‹mpo
 = 
‹mpo_hi¡Üy
[i];

293 
Ãw_‹mpo
 = 
‹mpo_hi¡Üy
[
i
];

294 ià(
‹mpo_hi¡Üy_time
[
i
] > 
»vi£d_time
) ;

296 ià(
i
 > 
‹mpo_hi¡Üy_couÁ
 || 
‹mpo_hi¡Üy_time
[i] > 
Mf_cu¼time
) {

297 #ifdeà
DEBUG_TIMES


298 
	`´štf
("[·¡ %lu, old_‹mpØ%lu]\n", 
‹mpo_hi¡Üy_time
[
i
], 
Şd_‹mpo
);

300 
»vi£d_time
 = 
Mf_cu¼time
;

301 (
Şd_‹mpo
);

303 
‹mpo_chªge_time
 = 
»vi£d_time
 = 
‹mpo_hi¡Üy_time
[
i
];

304 #ifdeà
DEBUG_TIMES


305 
	`´štf
("[»vi£d_tim%lu,‚ew_‹mpØ%lu]\n", 
»vi£d_time
, 
Ãw_‹mpo
);

307 (
Ãw_‹mpo
);

308 
	}
}

312 
	$»adŒack
 ()

317 
chªty³
[] =

322 
lookfÜ
;

323 
c
, 
c1
, 
ty³
;

324 
sy£xcÚtšue
 = 0;

325 
ruÂšg
 = 0;

326 
¡©us
 = 0;

327 
Ãeded
;

329 ià(
Mf_š‹¿ùive
)

331 
Mf_tob”—d
 = 
INT_MAX
;

335 ià(
	`»admt
 ("MTrk"è=ğ
EOF
)

338 
Mf_tob”—d
 = 
	`»ad32b™
 ();

340 
Mf_cu¼time
 = 
Mf_»®time
 = 0;

341 
Mf_f_»®time
 = 
Şd_f_»®time
 = 0;

342 
Şd_cu¼time
 = 
Şd_»®time
 = 0;

343 
Mf_cu¼‹mpo
 = 
	`fšd_‹mpo
();

345 ià(
Mf_Œack¡¬t
)

346 (*
Mf_Œack¡¬t
) ();

348 !
fÜû_ex™
 && (
Mf_š‹¿ùive
 || 
Mf_tob”—d
 > 0))

351 ià(
Mf_š‹¿ùive
)

352 
Mf_cu¼time
 += 1;

355 
d–_£cs
;

356 
d–_ticks
 = 
	`»adv¬šum
 ();

357 
»vi£d_time
 = 
Mf_cu¼time
;

358 
Mf_cu¼time
 +ğ
d–_ticks
;

365 
»vi£d_time
 < 
Mf_cu¼time
) {

366 
§ve_time
 = 
»vi£d_time
;

367 
§ve_‹mpo
 = 
Mf_cu¼‹mpo
;

368 
Mf_cu¼‹mpo
 = 
	`fšd_‹mpo
();

370 ià(
Mf_cu¼‹mpo
 !ğ
Şd_cu¼‹mpo
) {

371 
Şd_cu¼‹mpo
 = 
Mf_cu¼‹mpo
;

372 
Şd_»®time
 = 
Mf_»®time
;

373 ià(
»vi£d_time
 !ğ
‹mpo_chªge_time
) {

374 
Şd_f_»®time
 = 
Mf_f_»®time
;

375 
Şd_cu¼time
 = 
§ve_time
;

377 
d–_£cs
 = 
	`mf_ticks2£c
 (
»vi£d_time
-
Şd_cu¼time
, 
Mf_divisiÚ
, 
§ve_‹mpo
);

378 #ifdeà
DEBUG_TIMES


379 
	`´štf
("d(rev %lu - old %lu, div %d,empo %lu) = %.3f\n",

380 
»vi£d_time
, 
Şd_cu¼time
, 
Mf_divisiÚ
, 
§ve_‹mpo
, 
d–_£cs
 * 1600.0);

382 
Mf_f_»®time
 = 
Şd_f_»®time
 + 
d–_£cs
 * 1600.0;

383 
Mf_»®time
 = ()(0.5 + 
Mf_f_»®time
);

384 #ifdeà
DEBUG_TIMES


385 
	`´štf
("\‰=%luick Ğğ%lu c£c/16 < old %.2à+ %.2f)\n", 
Mf_cu¼time
, 
Mf_»®time
,

386 
Şd_f_»®time
, 
d–_£cs
 * 1600.0);

388 ià(
»vi£d_time
 =ğ
‹mpo_chªge_time
) {

389 
Şd_cu¼time
 = 
»vi£d_time
;

390 
Şd_f_»®time
 = 
Mf_f_»®time
;

394 
d–_£cs
 = 
	`mf_ticks2£c
 (
»vi£d_time
-
Şd_cu¼time
, 
Mf_divisiÚ
, 
Mf_cu¼‹mpo
);

395 #ifdeà
DEBUG_TIMES


396 
	`´štf
("d(rev %lu - old %lu, div %d,empo %lu) = %.3f\n",

397 
»vi£d_time
, 
Şd_cu¼time
, 
Mf_divisiÚ
, 
Mf_cu¼‹mpo
, 
d–_£cs
 * 1600.0);

399 
Mf_f_»®time
 = 
Şd_f_»®time
 + 
d–_£cs
 * 1600.0;

400 
Mf_»®time
 = ()(0.5 + 
Mf_f_»®time
);

401 #ifdeà
DEBUG_TIMES


402 
	`´štf
("\‰=%luick Ğğ%lu c£c/16 < old %.2à+ %.2f)\n", 
Mf_cu¼time
, 
Mf_»®time
,

403 
Şd_f_»®time
, 
d–_£cs
 * 1600.0);

411 
c
 = 
	`eg‘c
 ();

413 ià(
sy£xcÚtšue
 && 
c
 != 0xf7)

414 
	`mã¼Ü
 ("didn't findƒxpected continuation of‡ sysex");

416 ià((
c
 & 0x80) == 0)

418 ià(
¡©us
 == 0)

419 
	`mã¼Ü
 ("unexpected„unning status");

420 
ruÂšg
 = 1;

424 
¡©us
 = 
c
;

425 
ruÂšg
 = 0;

428 
Ãeded
 = 
chªty³
[(
¡©us
 >> 4) & 0xf];

430 ià(
Ãeded
)

433 ià(
ruÂšg
)

434 
c1
 = 
c
;

436 
c1
 = 
	`eg‘c
 ();

437 
	`chªmes§ge
 (
¡©us
, 
c1
, (
Ãeded
 > 1è? 
	`eg‘c
 () : 0);

441 
c
)

446 
ty³
 = 
	`eg‘c
 ();

447 
lookfÜ
 = 
Mf_tob”—d
 - 
	`»adv¬šum
 ();

448 
	`msgš™
 ();

450 
Mf_tob”—d
 > 
lookfÜ
)

451 
	`msgadd
 (
	`eg‘c
 ());

453 
	`m‘«v’t
 (
ty³
);

458 
lookfÜ
 = 
Mf_tob”—d
 - 
	`»adv¬šum
 ();

459 
	`msgš™
 ();

460 
	`msgadd
 (0xf0);

462 
Mf_tob”—d
 > 
lookfÜ
)

463 
	`msgadd
 (
c
 = 
	`eg‘c
 ());

465 ià(
c
 =ğ0xf7 || 
Mf_nom”ge
 == 0)

466 
	`sy£x
 ();

468 
sy£xcÚtšue
 = 1;

473 
lookfÜ
 = 
Mf_tob”—d
 - 
	`»adv¬šum
 ();

475 ià(!
sy£xcÚtšue
)

476 
	`msgš™
 ();

478 
Mf_tob”—d
 > 
lookfÜ
)

479 
	`msgadd
 (
c
 = 
	`eg‘c
 ());

481 ià(!
sy£xcÚtšue
)

483 ià(
Mf_¬b™¿ry
)

484 (*
Mf_¬b™¿ry
è(
	`msgËng
 (), 
	`msg
 ());

486 ià(
c
 == 0xf7)

488 
	`sy£x
 ();

489 
sy£xcÚtšue
 = 0;

493 
	`badby‹
 (
c
);

497 ià(
Mf_Œack’d
)

498 (*
Mf_Œack’d
) ();

500 
	}
}

504 
	$badby‹
 (
c
)

505 
c
;

507 
buff
[32];

509 (è
	`¥rštf
 (
buff
, "uÃx³ùed by‹: 0x%02x", 
c
);

510 
	`mã¼Ü
 (
buff
);

511 
	}
}

515 
	$m‘«v’t
 (
ty³
)

517 
Ëng
 = 
	`msgËng
 ();

518 *
m
 = 
	`msg
 ();

520 
ty³
)

523 ià(
Mf_£qnum
)

524 (*
Mf_£qnum
è(
	`to16b™
 (
m
[0], m[1]));

542 ià(
Mf_‹xt
)

543 (*
Mf_‹xt
è(
ty³
, 
Ëng
, 
m
);

546 ià(
Mf_eÙ
)

547 (*
Mf_eÙ
) ();

550 ià(
Mf_‹mpo
)

551 (*
Mf_‹mpo
è(
Mf_cu¼‹mpo
 = 
	`to32b™
 (0, 
m
[0], m[1], m[2]));

552 ià(
‹mpo_hi¡Üy
[
‹mpo_hi¡Üy_couÁ
] =ğ
Mf_cu¼‹mpo
) ;

553 ià(
‹mpo_hi¡Üy_time
[
‹mpo_hi¡Üy_couÁ
] > 
Mf_cu¼time
) ;

554 ià(
‹mpo_hi¡Üy_couÁ
 < 
MAX_HISTORY
 - 1)empo_history_count++;

555 
‹mpo_hi¡Üy
[
‹mpo_hi¡Üy_couÁ
] = 
Mf_cu¼‹mpo
;

556 
‹mpo_hi¡Üy_time
[
‹mpo_hi¡Üy_couÁ
] = 
Mf_cu¼time
;

559 ià(
Mf_sm±e
)

560 (*
Mf_sm±e
è(
m
[0], m[1], m[2], m[3], m[4]);

563 ià(
Mf_timesig
)

564 (*
Mf_timesig
è(
m
[0], m[1], m[2], m[3]);

567 ià(
Mf_keysig
)

568 (*
Mf_keysig
è(
m
[0], m[1]);

571 ià(
Mf_£q¥ecific
)

572 (*
Mf_£q¥ecific
è(
Ëng
, 
m
);

575 ià(
Mf_m‘amisc
)

576 (*
Mf_m‘amisc
è(
ty³
, 
Ëng
, 
m
);

578 
	}
}

582 
	$sy£x
 ()

584 ià(
Mf_sy£x
)

585 (*
Mf_sy£x
è(
	`msgËng
 (), 
	`msg
 ());

586 
	}
}

590 
	$chªmes§ge
 (
¡©us
, 
c1
, 
c2
)

591 
¡©us
;

592 
c1
, 
c2
;

594 
chª
 = 
¡©us
 & 0xf;

598 ià(
c1
 > 127) ;

599 ià(
c2
 > 127) c2 = 127;

601 
¡©us
 & 0xf0)

604 ià(
Mf_nÙeoff
)

605 (*
Mf_nÙeoff
è(
chª
, 
c1
, 
c2
);

608 ià(
Mf_nÙeÚ
)

609 (*
Mf_nÙeÚ
è(
chª
, 
c1
, 
c2
);

612 ià(
Mf_´essu»
)

613 (*
Mf_´essu»
è(
chª
, 
c1
, 
c2
);

616 ià(
Mf_·¿m‘”
)

617 (*
Mf_·¿m‘”
è(
chª
, 
c1
, 
c2
);

620 ià(
Mf_p™chb’d
)

621 (*
Mf_p™chb’d
è(
chª
, 
c1
, 
c2
);

624 ià(
Mf_´og¿m
)

625 (*
Mf_´og¿m
è(
chª
, 
c1
);

628 ià(
Mf_chª´essu»
)

629 (*
Mf_chª´essu»
è(
chª
, 
c1
);

632 
	}
}

638 
	$»adv¬šum
 ()

640 
v®ue
;

641 
c
;

643 
c
 = 
	`eg‘c
 ();

644 
v®ue
 = 
c
;

645 ià(
c
 & 0x80)

647 
v®ue
 &= 0x7f;

650 
c
 = 
	`eg‘c
 ();

651 
v®ue
 = (v®u<< 7è+ (
c
 & 0x7f);

653 
c
 & 0x80);

655  (
v®ue
);

656 
	}
}

659 
	$to32b™
 (
c1
, 
c2
, 
c3
, 
c4
)

661 
v®ue
 = 0L;

663 
v®ue
 = (
c1
 & 0xff);

664 
v®ue
 = (v®u<< 8è+ (
c2
 & 0xff);

665 
v®ue
 = (v®u<< 8è+ (
c3
 & 0xff);

666 
v®ue
 = (v®u<< 8è+ (
c4
 & 0xff);

667  (
v®ue
);

668 
	}
}

671 
	$to16b™
 (
c1
, 
c2
)

672 
c1
, 
c2
;

674  ((
c1
 & 0xffè<< 8è+ (
c2
 & 0xff);

675 
	}
}

678 
	$»ad32b™
 ()

680 
c1
, 
c2
, 
c3
, 
c4
;

682 
c1
 = 
	`eg‘c
 ();

683 
c2
 = 
	`eg‘c
 ();

684 
c3
 = 
	`eg‘c
 ();

685 
c4
 = 
	`eg‘c
 ();

686  
	`to32b™
 (
c1
, 
c2
, 
c3
, 
c4
);

687 
	}
}

690 
	$»ad16b™
 ()

692 
c1
, 
c2
;

693 
c1
 = 
	`eg‘c
 ();

694 
c2
 = 
	`eg‘c
 ();

695  
	`to16b™
 (
c1
, 
c2
);

696 
	}
}

700 
	$mã¼Ü
 (
s
)

701 *
s
;

703 ià(
Mf_”rÜ
)

704 (*
Mf_”rÜ
è(
s
);

705 
	`ex™
 (1);

706 
	}
}

712 
	#MSGINCREMENT
 128

	)

713 *
	gMsgbuff
 = 
NULL
;

714 
	gMsgsize
 = 0;

715 
	gMsgšdex
 = 0;

719 
	$msgš™
 ()

721 
Msgšdex
 = 0;

722 
	}
}

725 
	$msg
 ()

727  (
Msgbuff
);

728 
	}
}

732 
	$msgËng
 ()

734  (
Msgšdex
);

735 
	}
}

739 
	$msgadd
 (
c
)

740 
c
;

743 ià(
Msgšdex
 >ğ
Msgsize
)

744 
	`bigg”msg
 ();

745 
Msgbuff
[
Msgšdex
++] = 
c
;

746 
	}
}

750 
	$bigg”msg
 ()

753 *
Ãwmess
;

754 *
Şdmess
 = 
Msgbuff
;

755 
ŞdËng
 = 
Msgsize
;

757 
Msgsize
 +ğ
MSGINCREMENT
;

758 
Ãwmess
 = (*è
	`m®loc
 ((è( (è* 
Msgsize
));

760 ià(
Ãwmess
 =ğ
NULL
)

761 
	`mã¼Ü
 ("mallocƒrror!");

764 ià(
Şdmess
 !ğ
NULL
)

766 *
p
 = 
Ãwmess
;

767 *
q
 = 
Şdmess
;

768 *
’dq
 = &
Şdmess
[
ŞdËng
];

770 ; 
q
 !ğ
’dq
; 
p
++, q++)

771 *
p
 = *
q
;

772 
	`ä“
 (
Şdmess
);

774 
Msgbuff
 = 
Ãwmess
;

775 
	}
}

777 
	gÏ¡¡©us
 = 0;

808 
	$mfwr™e
 (
fÜm©
, 
Á¿cks
, 
divisiÚ
, 
å
)

809 
fÜm©
, 
Á¿cks
, 
divisiÚ
;

810 
FILE
 *
å
;

812 
i
;

813 
	`mf_wr™e_Œack_chunk
 (), 
	`mf_wr™e_h—d”_chunk
 ();

815 ià(
Mf_putc
 =ğ
NULLFUNC
)

816 
	`mã¼Ü
 ("mfmf_write() called without setting Mf_putc");

818 ià(
Mf_wr™‘¿ck
 =ğ
NULLFUNC
)

819 
	`mã¼Ü
 ("mfmf_write() called without setting Mf_mf_writetrack");

821 
Ï¡¡©us
 = 0;

824 
	`mf_wr™e_h—d”_chunk
 (
fÜm©
, 
Á¿cks
, 
divisiÚ
);

826 
Ï¡¡©us
 = 0;

829 ià(
fÜm©
 =ğ1 && (
Mf_wr™‘empÙ¿ck
))

831 (*
Mf_wr™‘empÙ¿ck
) ();

835 
i
 = 0; i < 
Á¿cks
; i++)

836 
	`mf_wr™e_Œack_chunk
 (
i
, 
å
);

837 
	}
}

840 
	$mf_wr™e_Œack_chunk
 (
which_Œack
, 
å
)

841 
which_Œack
;

842 
FILE
 *
å
;

844 
Œkhdr
, 
ŒkËngth
;

845 
off£t
, 
¶aû_m¬k”
;

846 
	`wr™e16b™
 (), 
	`wr™e32b™
 ();

849 
Ï¡¡©us
 = 0;

851 
Œkhdr
 = 
MTrk
;

852 
ŒkËngth
 = 0;

856 
off£t
 = 
	`á–l
 (
å
);

858 #ifdeà
DEBUG


859 
	`´štf
 ("off£ˆğ%d\n", (è
off£t
);

863 
	`wr™e32b™
 (
Œkhdr
);

864 
	`wr™e32b™
 (
ŒkËngth
);

866 
Mf_numby‹swr™‹n
 = 0L;

868 ià(
Mf_wr™‘¿ck
)

870 (*
Mf_wr™‘¿ck
è(
which_Œack
);

888 
¶aû_m¬k”
 = 
	`á–l
 (
å
);

895 #ifdeà
DEBUG


896 
	`´štf
 ("Ëngth = %d\n", (è
ŒkËngth
);

899 ià(
	`f£ek
 (
å
, 
off£t
, 0) < 0)

900 
	`mã¼Ü
 ("error seeking during final stage of write");

902 
ŒkËngth
 = 
Mf_numby‹swr™‹n
;

905 
	`wr™e32b™
 (
Œkhdr
);

906 
	`wr™e32b™
 (
ŒkËngth
);

908 
	`f£ek
 (
å
, 
¶aû_m¬k”
, 0);

909 
	}
}

913 
	$mf_wr™e_h—d”_chunk
 (
fÜm©
, 
Á¿cks
, 
divisiÚ
)

914 
fÜm©
, 
Á¿cks
, 
divisiÚ
;

916 
id’t
, 
Ëngth
;

917 
	`wr™e16b™
 (), 
	`wr™e32b™
 ();

919 
id’t
 = 
MThd
;

920 
Ëngth
 = 6;

924 
	`wr™e32b™
 (
id’t
);

925 
	`wr™e32b™
 (
Ëngth
);

926 
	`wr™e16b™
 (
fÜm©
);

927 
	`wr™e16b™
 (
Á¿cks
);

928 
	`wr™e16b™
 (
divisiÚ
);

929 
	}
}

951 
	$mf_wr™e_midi_ev’t
 (
d–_time
, 
ty³
, 
chª
, 
d©a
, 
size
)

952 
d–_time
;

953 
chª
, 
ty³
;

954 
size
;

955 *
d©a
;

957 
i
;

958 
c
;

960 
	`Wr™eV¬L’
 (
d–_time
);

964 ià(
ty³
 =ğ
sy¡em_exşusive
 ||ype == 0xf7)

966 
c
 = 
ty³
;

967 
Ï¡¡©us
 = 0;

970 
c
 = 
ty³
 | 
chª
;

972 ià(
chª
 > 15)

973 
	`³¼Ü
 ("error: MIDI channel greaterhan 16\n");

975 ià(
Ï¡¡©us
 !ğ
c
)

976 
	`•utc
 (
Ï¡¡©us
 = 
c
);

978 ià(
ty³
 =ğ
sy¡em_exşusive
 ||ype == 0xf7)

979 
	`Wr™eV¬L’
 (
size
);

982 
i
 = 0; i < ()
size
; i++)

983 
	`•utc
 (
d©a
[
i
]);

985  (
size
);

986 
	}
}

1003 
	$mf_wr™e_m‘a_ev’t
 (
d–_time
, 
ty³
, 
d©a
, 
size
)

1004 
d–_time
;

1005 *
d©a
, 
ty³
;

1006 
size
;

1008 
i
;

1010 
	`Wr™eV¬L’
 (
d–_time
);

1013 
	`•utc
 (
Ï¡¡©us
 = 
m‘a_ev’t
);

1016 
	`•utc
 (
ty³
);

1019 
	`Wr™eV¬L’
 (
size
);

1021 
i
 = 0; i < ()
size
; i++)

1023 ià(
	`•utc
 (
d©a
[
i
]) != data[i])

1026  (
size
);

1027 
	}
}

1030 
	$mf_wr™e_‹mpo
 (
d–_time
, 
‹mpo
)

1031 
d–_time
;

1032 
‹mpo
;

1038 
	`Wr™eV¬L’
 (
d–_time
);

1039 
	`•utc
 (
Ï¡¡©us
 = 
m‘a_ev’t
);

1040 
	`•utc
 (
£t_‹mpo
);

1042 
	`•utc
 (3);

1043 
	`•utc
 ((è(0xfà& (
‹mpo
 >> 16)));

1044 
	`•utc
 ((è(0xfà& (
‹mpo
 >> 8)));

1045 
	`•utc
 ((è(0xfà& 
‹mpo
));

1046 
	}
}

1049 
	$mf_wr™e_£qnum
 (
d–_time
, 
£qnum
)

1050 
d–_time
;

1051 
£qnum
;

1054 
	`Wr™eV¬L’
 (
d–_time
);

1055 
	`•utc
 (
Ï¡¡©us
 = 
m‘a_ev’t
);

1056 
	`•utc
 (0);

1058 
	`•utc
 ((è(0xfà& (
£qnum
 >> 8)));

1059 
	`•utc
 ((è(0xfà& 
£qnum
));

1060 
	}
}

1063 
	$mf_£c2ticks
 (
£cs
, 
divisiÚ
, 
‹mpo
)

1064 
divisiÚ
;

1065 
‹mpo
;

1066 
£cs
;

1068  (è(((
£cs
 * 1000.0è/ 4.0 * 
divisiÚ
è/ 
‹mpo
);

1069 
	}
}

1075 
	$Wr™eV¬L’
 (
v®ue
)

1076 
v®ue
;

1078 
bufãr
;

1080 
bufãr
 = 
v®ue
 & 0x7f;

1081 (
v®ue
 >>= 7) > 0)

1083 
bufãr
 <<= 8;

1084 
bufãr
 |= 0x80;

1085 
bufãr
 +ğ(
v®ue
 & 0x7f);

1089 
	`•utc
 ((è(
bufãr
 & 0xff));

1091 ià(
bufãr
 & 0x80)

1092 
bufãr
 >>= 8;

1096 
	}
}

1105 
	$mf_ticks2£c
 (
ticks
, 
divisiÚ
, 
‹mpo
)

1106 
divisiÚ
;

1107 
‹mpo
;

1108 
ticks
;

1110 
sm±e_fÜm©
, 
sm±e_»sŞutiÚ
;

1112 ià(
divisiÚ
 > 0)

1113  ((è(((è(
ticks
è* (è(
‹mpo
)è/ ((è(
divisiÚ
) * 1000000.0)));

1116 
sm±e_fÜm©
 = 
	`uµ”by‹
 (
divisiÚ
);

1117 
sm±e_»sŞutiÚ
 = 
	`low”by‹
 (
divisiÚ
);

1118  (è((è
ticks
 / (
sm±e_fÜm©
 * 
sm±e_»sŞutiÚ
 * 1000000.0));

1120 
	}
}

1136 
	$wr™e32b™
 (
d©a
)

1137 
d©a
;

1139 
	`•utc
 ((è((
d©a
 >> 24) & 0xff));

1140 
	`•utc
 ((è((
d©a
 >> 16) & 0xff));

1141 
	`•utc
 ((è((
d©a
 >> 8) & 0xff));

1142 
	`•utc
 ((è(
d©a
 & 0xff));

1143 
	}
}

1146 
	$wr™e16b™
 (
d©a
)

1147 
d©a
;

1149 
	`•utc
 ((è((
d©a
 & 0xff00) >> 8));

1150 
	`•utc
 ((è(
d©a
 & 0xff));

1151 
	}
}

1155 
	$•utc
 (
c
)

1156 
c
;

1158 
»tuº_v®
;

1160 ià((
Mf_putc
è=ğ
NULLFUNC
)

1162 
	`mã¼Ü
 ("Mf_putc undefined");

1166 
»tuº_v®
 = (*
Mf_putc
è(
c
);

1168 ià(
»tuº_v®
 =ğ
EOF
)

1169 
	`mã¼Ü
 ("error writing");

1171 
Mf_numby‹swr™‹n
++;

1172  (
»tuº_v®
);

1173 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/midifile.h

2 (*
Mf_g‘c
)();

3 (*
Mf_h—d”
)();

4 (*
Mf_Œack¡¬t
)();

5 (*
Mf_Œack’d
)();

6 (*
Mf_nÙeÚ
)();

7 (*
Mf_nÙeoff
)();

8 (*
Mf_´essu»
)();

9 (*
Mf_·¿m‘”
)();

10 (*
Mf_p™chb’d
)();

11 (*
Mf_´og¿m
)();

12 (*
Mf_chª´essu»
)();

13 (*
Mf_sy£x
)();

14 (*
Mf_m‘amisc
)();

15 (*
Mf_£q¥ecific
)();

16 (*
Mf_£qnum
)();

17 (*
Mf_‹xt
)();

18 (*
Mf_eÙ
)();

19 (*
Mf_timesig
)();

20 (*
Mf_sm±e
)();

21 (*
Mf_‹mpo
)();

22 (*
Mf_keysig
)();

23 (*
Mf_¬b™¿ry
)();

24 (*
Mf_”rÜ
)();

25 
Mf_cu¼time
;

26 
Mf_»®time
;

27 
Mf_cu¼‹mpo
;

28 
Mf_divisiÚ
;

29 
Mf_nom”ge
;

30 #ifdeà
READ_MODS


31 *
Mf_fe_cÚ‹Ás
;

32 
Mf_fe_size
;

36 (*
Mf_putc
)();

37 (*
Mf_wr™‘¿ck
)();

38 (*
Mf_wr™‘empÙ¿ck
)();

40 
midife
();

41 
mf_£c2ticks
();

42 
mfwr™e
();

43 
mf_wr™e_m‘a_ev’t
();

44 
mf_wr™e_midi_ev’t
(
d–_time
, 
ty³
,

45 
chª
, *
d©a
, 
size
);

46 
mf_ticks2£c
(
ticks
,
divisiÚ
,
‹mpo
);

47 
mf_wr™e_‹mpo
();

48 
mf_wr™e_£qnum
();

49 
mä—d
();

50 
mã¼Ü
(*
s
);

52 #iâdeà
NO_LC_DEFINES


54 
	#nÙe_off
 0x80

	)

55 
	#nÙe_Ú
 0x90

	)

56 
	#pŞy_aá”touch
 0xa0

	)

57 
	#cÚŒŞ_chªge
 0xb0

	)

58 
	#´og¿m_chng
 0xc0

	)

59 
	#chªÃl_aá”touch
 0xd0

	)

60 
	#p™ch_wh“l
 0xe0

	)

61 
	#sy¡em_exşusive
 0xf0

	)

62 
	#d–ay_·ck‘
 (1111)

	)

65 
	#dam³r_³d®
 0x40

	)

66 
	#pÜm’to
 0x41

	)

67 
	#su¡’uto
 0x42

	)

68 
	#soá_³d®
 0x43

	)

69 
	#g’”®_4
 0x44

	)

70 
	#hŞd_2
 0x45

	)

71 
	#g’”®_5
 0x50

	)

72 
	#g’”®_6
 0x51

	)

73 
	#g’”®_7
 0x52

	)

74 
	#g’”®_8
 0x53

	)

75 #iâdeà
PLAYMIDI


76 
	#ŒemŞo_d•th
 0x5c

	)

77 
	#ù¾_chÜus_d•th
 0x5d

	)

78 
	#d‘uÃ
 0x5e

	)

79 
	#pha£r_d•th
 0x5f

	)

83 
	#d©a_šc
 0x60

	)

84 
	#d©a_dec
 0x61

	)

87 
	#nÚ_»g_lsb
 0x62

	)

88 
	#nÚ_»g_msb
 0x63

	)

89 
	#»g_lsb
 0x64

	)

90 
	#»g_msb
 0x65

	)

93 
	#m‘a_ev’t
 0xFF

	)

94 
	#£qu’û_numb”
 0x00

	)

95 
	#‹xt_ev’t
 0x01

	)

96 
	#cİyright_nÙiû
 0x02

	)

97 
	#£qu’û_Çme
 0x03

	)

98 
	#š¡rum’t_Çme
 0x04

	)

99 
	#lyric
 0x05

	)

100 
	#m¬k”
 0x06

	)

101 
	#cue_pošt
 0x07

	)

102 
	#chªÃl_´efix
 0x20

	)

103 
	#’d_of_Œack
 0x2f

	)

104 
	#£t_‹mpo
 0x51

	)

105 
	#sm±e_off£t
 0x54

	)

106 
	#time_sigÇtu»
 0x58

	)

107 
	#key_sigÇtu»
 0x59

	)

108 
	#£qu’ûr_¥ecific
 0x74

	)

111 
	#Seq_Cœcu™s
 (0x01è

	)

112 
	#Big_BrŸr
 (0x02è

	)

113 
	#Oùave
 (0x03è

	)

114 
	#Moog
 (0x04è

	)

115 
	#Pas¥Üt
 (0x05è

	)

116 
	#LexicÚ
 (0x06è

	)

117 
	#Tempi
 (0x20è

	)

118 
	#S›l
 (0x21è

	)

119 
	#Kawai
 (0x41)

	)

120 
	#RŞªd
 (0x42)

	)

121 
	#KÜg
 (0x42)

	)

122 
	#Yamaha
 (0x43)

	)

126 
	#MThd
 0x4d546864

	)

127 
	#MTrk
 0x4d54726b

	)

129 #iâdeà
NO_LC_DEFINES


130 
	#low”by‹
(
x
è(()(x & 0xff))

	)

131 
	#uµ”by‹
(
x
è(()((x & 0xff00)>>8))

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/midiloop.c

1 
	~<¡dlib.h
>

2 
	~<¡dio.h
>

3 
	~<ùy³.h
>

4 
	~<sys/time.h
>

5 
	~"../šşude/asoundlib.h
"

6 
	~<¡ršg.h
>

7 
	~<sigÇl.h
>

9 
	$u§ge
()

11 
	`årštf
(
¡d”r
, "Usage: midiloop [options]\n");

12 
	`årštf
(
¡d”r
, " options:\n");

13 
	`årštf
(
¡d”r
, " -v: verbose mode\n");

14 
	`årštf
(
¡d”r
, " -i <rawmidi device> :est input device\n");

15 
	`årštf
(
¡d”r
, " -o <rawmidi device> :est output device\n");

16 
	}
}

18 
	g¡İ
 = 0;

20 
	$sighªdËr
(
dummy
 
ATTRIBUTE_UNUSED
)

22 
¡İ
=1;

23 
	}
}

25 
	$timediff
(
timev®
 
t1
, timev® 
t2
)

27 sigÃd 
l
;

29 
t1
.
tv_£c
 -ğ
t2
.tv_sec;

30 
l
 = (sigÃd è
t1
.
tv_u£c
 - (sigÃd è
t2
.tv_usec;

31 ià(
l
 < 0) {

32 
t1
.
tv_£c
--;

33 
l
 = -l;

34 
l
 %= 1000000;

36  (()
t1
.
tv_£c
 * ()1000000è+ ()
l
;

37 
	}
}

39 
	$wr™•©‹º
(
¢d_¿wmidi_t
 *
hªdË_out
, *
obuf
)

41 
·tsize
, 
i
;

43 
·tsize
 = 0;

44 
i
 = 0; i < 15; i++) {

45 
obuf
[
·tsize
++] = 0x90 + 
i
;

46 
obuf
[
·tsize
++] = 0x40;

47 
obuf
[
·tsize
++] = 0x3f;

48 
obuf
[
·tsize
++] = 0xb0 + 
i
;

49 
obuf
[
·tsize
++] = 0x2e;

50 
obuf
[
·tsize
++] = 0x7a;

51 
obuf
[
·tsize
++] = 0x80 + 
i
;

52 
obuf
[
·tsize
++] = 0x23;

53 
obuf
[
·tsize
++] = 0x24;

54 
obuf
[
·tsize
++] = 0xf0;

55 
obuf
[
·tsize
++] = 
i
;

56 
obuf
[
·tsize
++] = 0xf7;

58 
i
 = 
	`¢d_¿wmidi_wr™e
(
hªdË_out
, 
obuf
, 
·tsize
);

59 ià(
i
 !ğ
·tsize
) {

60 
	`´štf
("Wr™‹ÀÚly %˜by‹ äom %˜by‹s\n", 
i
, 
·tsize
);

61 
	`ex™
(
EXIT_FAILURE
);

63  
·tsize
;

64 
	}
}

66 
	$maš
(
¬gc
, ** 
¬gv
)

68 
i
, 
j
, 
k
, 
İos
, 
os
, 
·tsize
;

69 
”r
;

70 
v”bo£
 = 0;

71 
¢d_¿wmidi_t
 *
hªdË_š
 = 
NULL
, *
hªdË_out
 = NULL;

72 
ibuf
[512], 
obuf
[512];

73 *
šame
 = "hw:0,0", *
Úame
 = "hw:0,0";

74 
timev®
 
¡¬t
, 
’d
;

75 
diff
;

76 
¢d_¿wmidi_¡©us_t
 *
i¡©
, *
o¡©
;

78 
i
 = 1 ; i<
¬gc
 ; i++) {

79 ià(
¬gv
[
i
][0]=='-') {

80 ià(!
	`¡rcmp
(
¬gv
[
i
], "--help")) {

81 
	`u§ge
();

84 
¬gv
[
i
][1]) {

86 
	`u§ge
();

89 
v”bo£
 = 1;

92 ià(
i
 + 1 < 
¬gc
)

93 
šame
 = 
¬gv
[++
i
];

96 ià(
i
 + 1 < 
¬gc
)

97 
Úame
 = 
¬gv
[++
i
];

103 ià(
šame
 =ğ
NULL
)

104 
šame
 = 
Úame
;

105 ià(
Úame
 =ğ
NULL
)

106 
Úame
 = 
šame
;

108 ià(
v”bo£
) {

109 
	`årštf
(
¡d”r
, "Using: \n");

110 
	`årštf
(
¡d”r
, " IÅut: %  Ouut: %s\n", 
šame
, 
Úame
);

113 
”r
 = 
	`¢d_¿wmidi_İ’
(&
hªdË_š
, 
NULL
, 
šame
, 
SND_RAWMIDI_NONBLOCK
);

114 ià(
”r
) {

115 
	`årštf
(
¡d”r
,"¢d_¿wmidi_İ’ % çed: %d\n",
šame
,
”r
);

116 
	`ex™
(
EXIT_FAILURE
);

119 
”r
 = 
	`¢d_¿wmidi_İ’
(
NULL
, &
hªdË_out
, 
Úame
, 0);

120 ià(
”r
) {

121 
	`årštf
(
¡d”r
,"¢d_¿wmidi_İ’ % çed: %d\n",
Úame
,
”r
);

122 
	`ex™
(
EXIT_FAILURE
);

125 
	`sigÇl
(
SIGINT
, 
sighªdËr
);

127 
i
 = 
	`¢d_¿wmidi_»ad
(
hªdË_š
, 
ibuf
, (ibuf));

128 ià(
i
 > 0) {

129 
	`´štf
("R—d‡h—d: %i\n", 
i
);

130 
j
 = 0; j < 
i
; j++)

131 
	`´štf
("%02x:", 
ibuf
[
j
]);

132 
	`´štf
("\n");

133 
	`ex™
(
EXIT_FAILURE
);

136 
	`¢d_¿wmidi_nÚblock
(
hªdË_š
, 0);

138 
·tsize
 = 
	`wr™•©‹º
(
hªdË_out
, 
obuf
);

139 
	`g‘timeofday
(&
¡¬t
, 
NULL
);

140 
·tsize
 = 
	`wr™•©‹º
(
hªdË_out
, 
obuf
);

142 
k
 = 
os
 = 
İos
 = 
”r
 = 0;

143 !
¡İ
) {

144 
i
 = 
	`¢d_¿wmidi_»ad
(
hªdË_š
, 
ibuf
, (ibuf));

145 
j
 = 0; j < 
i
; j++, 
os
++)

146 ià(
obuf
[
k
] !ğ
ibuf
[
j
]) {

147 
	`´štf
("o ğ%i, i[0x%x] !ğo[0x%x]\n", 
os
, 
ibuf
[
j
], 
obuf
[
k
]);

148 ià(
İos
 > 0)

149 
¡İ
 = 1;

151 
	`´štf
("m©ch sucûss: ipo ğ%i, opo ğ%˜[%i:0x%x]\n", 
os
, 
İos
, 
k
, 
obuf
[k]);

152 
k
++; 
İos
++;

153 ià(
k
 >ğ
·tsize
) {

154 
·tsize
 = 
	`wr™•©‹º
(
hªdË_out
, 
obuf
);

155 
k
 = 0;

160 
	`g‘timeofday
(&
’d
, 
NULL
);

162 
	`´štf
("End...\n");

164 
	`¢d_¿wmidi_¡©us_®loÿ
(&
i¡©
);

165 
	`¢d_¿wmidi_¡©us_®loÿ
(&
o¡©
);

166 
”r
 = 
	`¢d_¿wmidi_¡©us
(
hªdË_š
, 
i¡©
);

167 ià(
”r
 < 0)

168 
	`årštf
(
¡d”r
, "špuˆ¡»am stu ”rÜ: %d\n", 
”r
);

169 
”r
 = 
	`¢d_¿wmidi_¡©us
(
hªdË_out
, 
o¡©
);

170 ià(
”r
 < 0)

171 
	`årštf
(
¡d”r
, "ouuˆ¡»am stu ”rÜ: %d\n", 
”r
);

172 
	`´štf
("šput.¡©us.ava = %zi\n", 
	`¢d_¿wmidi_¡©us_g‘_ava
(
i¡©
));

173 
	`´štf
("šput.¡©us.xrun ğ%zi\n", 
	`¢d_¿wmidi_¡©us_g‘_xruns
(
i¡©
));

174 
	`´štf
("ouut.¡©us.ava = %zi\n", 
	`¢d_¿wmidi_¡©us_g‘_ava
(
o¡©
));

175 
	`´štf
("ouut.¡©us.xrun ğ%zi\n", 
	`¢d_¿wmidi_¡©us_g‘_xruns
(
o¡©
));

177 
diff
 = 
	`timediff
(
’d
, 
¡¬t
);

178 
	`´štf
("Timdiff: %Îiu£ø(%Î˜by‹s/£c)\n", 
diff
, (()
İos
 * 1000000) / diff);

180 ià(
v”bo£
) {

181 
	`årštf
(
¡d”r
,"Closing\n");

184 
	`¢d_¿wmidi_d¿š
(
hªdË_š
);

185 
	`¢d_¿wmidi_şo£
(
hªdË_š
);

186 
	`¢d_¿wmidi_d¿š
(
hªdË_out
);

187 
	`¢d_¿wmidi_şo£
(
hªdË_out
);

190 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/mixtest.c

1 
	~<¡dlib.h
>

2 
	~<¡dio.h
>

3 
	~<¡ršg.h
>

4 
	~<uni¡d.h
>

5 
	~<sched.h
>

6 
	~<time.h
>

8 
	#rdtsşl
(
v®
) \

9 
__asm__
 
	`__vŞ©e__
("rdtsc" : "=A" (
v®
))

	)

11 
	#lik–y
(
x
è
	`__butš_ex³ù
((x),1)

	)

12 
	#uÆik–y
(
x
è
	`__butš_ex³ù
((x),0)

	)

14 
	ts16
;

15 
	ts32
;

18 
	#CONFIG_SMP


	)

21 #ifdeà
CONFIG_SMP


22 
	#LOCK_PREFIX
 "lock ; "

	)

24 
	#LOCK_PREFIX
 ""

	)

27 
	s__xchg_dummy
 { 
	ma
[100]; };

28 
	#__xg
(
x
è((
__xchg_dummy
 *)(x))

	)

30 
šlše
 
	$__cmpxchg
(vŞ©*
±r
, 
Şd
,

31 
Ãw
, 
size
)

33 
´ev
;

34 
size
) {

36 
__asm__
 
	`__vŞ©e__
(
LOCK_PREFIX
 "cmpxchgb %b1,%2"

37 : "÷"(
´ev
)

38 : "q"(
Ãw
), "m"(*
	`__xg
(
±r
)), "0"(
Şd
)

40  
´ev
;

42 
__asm__
 
	`__vŞ©e__
(
LOCK_PREFIX
 "cmpxchgw %w1,%2"

43 : "÷"(
´ev
)

44 : "q"(
Ãw
), "m"(*
	`__xg
(
±r
)), "0"(
Şd
)

46  
´ev
;

48 
__asm__
 
	`__vŞ©e__
(
LOCK_PREFIX
 "cmpxchgl %1,%2"

49 : "÷"(
´ev
)

50 : "q"(
Ãw
), "m"(*
	`__xg
(
±r
)), "0"(
Şd
)

52  
´ev
;

54  
Şd
;

55 
	}
}

57 
	#cmpxchg
(
±r
,
o
,
n
)\

58 ((
	`__ty³of__
(*(
±r
)))
	`__cmpxchg
(ÕŒ),()(
o
),\

59 ()(
n
),(*(
±r
))))

	)

61 
šlše
 
	$©omic_add
(vŞ©*
d¡
, 
v
)

63 
__asm__
 
	`__vŞ©e__
(

64 
LOCK_PREFIX
 "addl %1,%0"

65 :"=m" (*
d¡
)

66 :"œ" (
v
), "m" (*
d¡
));

67 
	}
}

69 
	$d‘eù_ıu_şock
()

71 
time¥ec
 
tm_begš
, 
tm_’d
;

72 
tsc_begš
, 
tsc_’d
;

75 
	`şock_g‘time
(
CLOCK_MONOTONIC
, &
tm_begš
);

77 
	`rdtsşl
(
tsc_begš
);

78 
	`şock_g‘time
(
CLOCK_MONOTONIC
, &
tm_begš
);

80 
	`u¦“p
(1000000);

82 
	`rdtsşl
(
tsc_’d
);

83 
	`şock_g‘time
(
CLOCK_MONOTONIC
, &
tm_’d
);

85  (
tsc_’d
 - 
tsc_begš
è/ (
tm_’d
.
tv_£c
 - 
tm_begš
.tv_£ø+ (tm_’d.
tv_n£c
 -m_begin.tv_nsec) / 1e9);

86 
	}
}

88 
	$mix_¬—s_¤v
(
size
,

89 cÚ¡ 
s16
 *
¤c
,

90 vŞ©
s32
 *
sum
,

91 
¤c_¡•
, 
sum_¡•
)

93 
¤c_¡•
 /ğ(*
¤c
);

94 
sum_¡•
 /ğ(*
sum
);

95 
size
-- > 0) {

96 
	`©omic_add
(
sum
, *
¤c
);

97 
¤c
 +ğ
¤c_¡•
;

98 
sum
 +ğ
sum_¡•
;

100 
	}
}

102 
	$§tu¿‹
(
size
,

103 
s16
 *
d¡
, cÚ¡ 
s32
 *
sum
,

104 
d¡_¡•
, 
sum_¡•
)

106 
d¡_¡•
 /ğ(*
d¡
);

107 
sum_¡•
 /ğ(*
sum
);

108 
size
-- > 0) {

109 
s32
 
§m¶e
 = *
sum
;

110 ià(
	`uÆik–y
(
§m¶e
 < -0x8000))

111 *
d¡
 = -0x8000;

112 ià(
	`uÆik–y
(
§m¶e
 > 0x7fff))

113 *
d¡
 = 0x7fff;

115 *
d¡
 = 
§m¶e
;

116 
d¡
 +ğ
d¡_¡•
;

117 
sum
 +ğ
sum_¡•
;

119 
	}
}

121 
	$mix_¬—s0
(
size
,

122 vŞ©
s16
 *
d¡
, s16 *
¤c
,

123 vŞ©
s32
 *
sum
,

124 
d¡_¡•
,

125 
¤c_¡•
,

126 
sum_¡•
)

128 
d¡_¡•
 /ğ(*
d¡
);

129 
¤c_¡•
 /ğ(*
¤c
);

130 
sum_¡•
 /ğ(*
sum
);

131 
size
-- > 0) {

132 
s32
 
§m¶e
 = *
d¡
 + *
¤c
;

133 ià(
	`uÆik–y
(
§m¶e
 < -0x8000))

134 *
d¡
 = -0x8000;

135 ià(
	`uÆik–y
(
§m¶e
 > 0x7fff))

136 *
d¡
 = 0x7fff;

138 *
d¡
 = 
§m¶e
;

139 
d¡
 +ğ
d¡_¡•
;

140 
¤c
 +ğ
¤c_¡•
;

141 
sum
 +ğ
sum_¡•
;

143 
	}
}

145 
	#MIX_AREAS_16
 
mix_¬—s1


	)

146 
	#MIX_AREAS_16_MMX
 
mix_¬—s1_mmx


	)

147 
	#MIX_AREAS_32
 
mix_¬—s1_32


	)

148 
	#MIX_AREAS_24
 
mix_¬—s1_24


	)

149 
	#MIX_AREAS_24_CMOV
 
mix_¬—s1_24_cmov


	)

150 
	#XADD
 "addl"

	)

151 
	#XSUB
 "subl"

	)

152 
	~"../¤c/pcm/pcm_dmix_i386.h
"

153 *
±r_mix_¬—s1_32
 
__©Œibu‹__
((
unu£d
)èğ&
mix_¬—s1_32
;

154 *
±r_mix_¬—s1_24
 
__©Œibu‹__
((
unu£d
)èğ&
mix_¬—s1_24
;

155 *
±r_mix_¬—s1_24_cmov
 
__©Œibu‹__
((
unu£d
)èğ&
mix_¬—s1_24_cmov
;

157 
	$mix_¬—s2
(
size
,

158 vŞ©
s16
 *
d¡
, cÚ¡ s16 *
¤c
,

159 vŞ©
s32
 *
sum
,

160 
d¡_¡•
,

161 
¤c_¡•
)

163 
d¡_¡•
 /ğ(*
d¡
);

164 
¤c_¡•
 /ğ(*
¤c
);

165 
size
-- > 0) {

166 
s32
 
§m¶e
 = *
¤c
;

167 
s32
 
Şd_§m¶e
 = *
sum
;

168 ià(
	`cmpxchg
(
d¡
, 0, 1) == 0)

169 
§m¶e
 -ğ
Şd_§m¶e
;

170 
	`©omic_add
(
sum
, 
§m¶e
);

172 
§m¶e
 = *
sum
;

173 ià(
	`uÆik–y
(
§m¶e
 < -0x8000))

174 *
d¡
 = -0x8000;

175 ià(
	`uÆik–y
(
§m¶e
 > 0x7fff))

176 *
d¡
 = 0x7fff;

178 *
d¡
 = 
§m¶e
;

179 } 
	`uÆik–y
(
§m¶e
 !ğ*
sum
));

180 
sum
++;

181 
d¡
 +ğ
d¡_¡•
;

182 
¤c
 +ğ
¤c_¡•
;

184 
	}
}

186 
	$£tscheduËr
()

188 
sched_·¿m
 sched_param;

190 ià(
	`sched_g‘·¿m
(0, &
sched_·¿m
) < 0) {

191 
	`´štf
("Scheduler getparam failed...\n");

194 
sched_·¿m
.
sched_´iÜ™y
 = 
	`sched_g‘_´iÜ™y_max
(
SCHED_RR
);

195 ià(!
	`sched_£tscheduËr
(0, 
SCHED_RR
, &
sched_·¿m
)) {

196 
	`´štf
("ScheduË¸£ˆtØRound Robš w™h…riÜ™y %i...\n", 
sched_·¿m
.
sched_´iÜ™y
);

197 
	`fæush
(
¡dout
);

200 
	`´štf
("!!!ScheduË¸£ˆtØRound Robš w™h…riÜ™y %˜FAILED!!!\n", 
sched_·¿m
.
sched_´iÜ™y
);

201 
	}
}

203 
	gÿche_size
 = 1024*1024;

205 
	$š™
(
s16
 *
d¡
, 
s32
 *
sum
, 
size
)

207 
couÁ
;

208 *
a
;

210 
couÁ
 = 
size
 - 1; count >= 0; count--)

211 *
sum
++ = 0;

212 
couÁ
 = 
size
 - 1; count >= 0; count--)

213 *
d¡
++ = 0;

214 
a
 = 
	`m®loc
(
ÿche_size
);

215 
couÁ
 = 
ÿche_size
 - 1; count >= 0; count--) {

216 
a
[
couÁ
] = count & 0xff;

217 
a
[
couÁ
] ^= 0x55;

218 
a
[
couÁ
] ^= 0xaa;

220 
	`ä“
(
a
);

221 
	}
}

223 
	$maš
(
¬gc
, **
¬gv
)

225 
size
 = 2048, 
n
 = 4, 
max
 = 32267;

226 
LOOP
 = 100;

227 
i
, 
t
;

228 
begš
, 
’d
, 
diff
, 
diffS
, 
diff0
, 
diff1
, 
diff1_mmx
, 
diff2
;

229 
ıu_şock
 = 
	`d‘eù_ıu_şock
();

230 
s16
 *
d¡
 = 
	`m®loc
((*d¡è* 
size
);

231 
s32
 *
sum
 = 
	`ÿÎoc
(
size
, (*sum));

232 
s16
 **
¤cs
 = 
	`m®loc
((*¤csè* 
n
);

234 
	`£tscheduËr
();

235 #iâdeà
CONFIG_SMP


236 
	`´štf
("CPU clock: %fMhz (UP)\n\n", 
ıu_şock
 / 10e5);

238 
	`´štf
("CPU clock: %fMhz (SMP)\n\n", 
ıu_şock
 / 10e5);

240 ià(
¬gc
 > 3) {

241 
size
 = 
	`©oi
(
¬gv
[1]);

242 
n
 = 
	`©oi
(
¬gv
[2]);

243 
max
 = 
	`©oi
(
¬gv
[3]);

245 ià(
¬gc
 > 4)

246 
ÿche_size
 = 
	`©oi
(
¬gv
[4]) * 1024;

247 
i
 = 0; i < 
n
; i++) {

248 
k
;

249 
s16
 *
s
;

250 
¤cs
[
i
] = 
s
 = 
	`m®loc
((
s16
è* 
size
);

251 
k
 = 0; k < 
size
; ++k, ++
s
) {

252 *
s
 = (
	`¿nd
(è% (
max
 * 2)) - max;

256 
t
 = 0, 
diffS
 = -1; < 
LOOP
;++) {

257 
	`š™
(
d¡
, 
sum
, 
size
);

258 
	`rdtsşl
(
begš
);

259 
i
 = 0; i < 
n
; i++) {

260 
	`mix_¬—s_¤v
(
size
, 
¤cs
[
i
], 
sum
, 2, 4);

262 
	`§tu¿‹
(
size
, 
d¡
, 
sum
, 2, 4);

263 
	`rdtsşl
(
’d
);

264 
diff
 = 
’d
 - 
begš
;

265 ià(
diff
 < 
diffS
)

266 
diffS
 = 
diff
;

267 
	`´štf
("mix_¬—s_¤v : %Îu \r", 
diff
); 
	`fæush
(
¡dout
);

270 
t
 = 0, 
diff0
 = -1; < 
LOOP
;++) {

271 
	`š™
(
d¡
, 
sum
, 
size
);

272 
	`rdtsşl
(
begš
);

273 
i
 = 0; i < 
n
; i++) {

274 
	`mix_¬—s0
(
size
, 
d¡
, 
¤cs
[
i
], 
sum
, 2, 2, 4);

276 
	`rdtsşl
(
’d
);

277 
diff
 = 
’d
 - 
begš
;

278 ià(
diff
 < 
diff0
)

279 
diff0
 = 
diff
;

280 
	`´štf
("mix_¬—s0 : %Îu \r", 
diff
); 
	`fæush
(
¡dout
);

283 
t
 = 0, 
diff1
 = -1; < 
LOOP
;++) {

284 
	`š™
(
d¡
, 
sum
, 
size
);

285 
	`rdtsşl
(
begš
);

286 
i
 = 0; i < 
n
; i++) {

287 
	`mix_¬—s1
(
size
, 
d¡
, 
¤cs
[
i
], 
sum
, 2, 2, 4);

289 
	`rdtsşl
(
’d
);

290 
diff
 = 
’d
 - 
begš
;

291 ià(
diff
 < 
diff1
)

292 
diff1
 = 
diff
;

293 
	`´štf
("mix_¬—s1 : %Îu \r", 
diff
); 
	`fæush
(
¡dout
);

296 
t
 = 0, 
diff1_mmx
 = -1; < 
LOOP
;++) {

297 
	`š™
(
d¡
, 
sum
, 
size
);

298 
	`rdtsşl
(
begš
);

299 
i
 = 0; i < 
n
; i++) {

300 
	`mix_¬—s1_mmx
(
size
, 
d¡
, 
¤cs
[
i
], 
sum
, 2, 2, 4);

302 
	`rdtsşl
(
’d
);

303 
diff
 = 
’d
 - 
begš
;

304 ià(
diff
 < 
diff1_mmx
)

305 
diff1_mmx
 = 
diff
;

306 
	`´štf
("mix_¬—s1_mmx: %Îu \r", 
diff
); 
	`fæush
(
¡dout
);

309 
t
 = 0, 
diff2
 = -1; < 
LOOP
;++) {

310 
	`š™
(
d¡
, 
sum
, 
size
);

311 
	`rdtsşl
(
begš
);

312 
i
 = 0; i < 
n
; i++) {

313 
	`mix_¬—s2
(
size
, 
d¡
, 
¤cs
[
i
], 
sum
, 2, 2);

315 
	`rdtsşl
(
’d
);

316 
diff
 = 
’d
 - 
begš
;

317 ià(
diff
 < 
diff2
)

318 
diff2
 = 
diff
;

319 
	`´štf
("mix_¬—s2 : %Îu \r", 
diff
); 
	`fæush
(
¡dout
);

322 
	`´štf
(" \r");

323 
	`´štf
("Summary (the bestimes):\n");

324 
	`´štf
("mix_¬—s_¤v : %8Îu %f%%\n", 
diffS
, 100*2*44100.0*diffS/(
size
*
n
*
ıu_şock
));

325 
	`´štf
("mix_¬—s0 : %8Îu %f%%\n", 
diff0
, 100*2*44100.0*diff0/(
size
*
n
*
ıu_şock
));

326 
	`´štf
("mix_¬—s1 : %8Îu %f%%\n", 
diff1
, 100*2*44100.0*diff1/(
size
*
n
*
ıu_şock
));

327 
	`´štf
("mix_¬—s1_mmx : %8Îu %f%%\n", 
diff1_mmx
, 100*2*44100.0*diff1_mmx/(
size
*
n
*
ıu_şock
));

328 
	`´štf
("mix_¬—s2 : %8Îu %f%%\n", 
diff2
, 100*2*44100.0*diff2/(
size
*
n
*
ıu_şock
));

330 
	`´štf
("\n");

331 
	`´štf
("¬—s1/¤v„©iØ : %f\n", ()
diff1
 / 
diffS
);

332 
	`´štf
("¬—s1_mmx/¤v„©iØ: %f\n", ()
diff1_mmx
 / 
diffS
);

335 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/namehint.c

1 
	~"../šşude/asoundlib.h
"

2 
	~<”r.h
>

4 
	$maš
(
¬gc
, *
¬gv
[])

6 cÚ¡ *
içû
 = "pcm";

7 **
hšts
;

8 **
n
;

9 
”r
;

11 ià(
¬gc
 > 1)

12 
içû
 = 
¬gv
[1];

13 
”r
 = 
	`¢d_deviû_Çme_hšt
(-1, 
içû
, &
hšts
);

14 ià(
”r
 < 0)

15 
	`”rx
(1, "¢d_deviû_Çme_hšˆ”rÜ: %s", 
	`¢d_¡»¼Ü
(
”r
));

16 
n
 = (**)
hšts
;

17 *
n
 !ğ
NULL
) {

18 
	`´štf
("%s\n", *
n
);

19 
n
++;

21 
	`¢d_deviû_Çme_ä“_hšt
(
hšts
);

23 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/oldapi.c

23 
	~<¡dio.h
>

24 
	~<¡dlib.h
>

25 
	~<¡ršg.h
>

26 
	~<sched.h
>

27 
	~<”ºo.h
>

28 
	~<g‘İt.h
>

29 
	#ALSA_PCM_OLD_HW_PARAMS_API


	)

30 
	#ALSA_PCM_OLD_SW_PARAMS_API


	)

31 
	~"../šşude/asoundlib.h
"

32 
	~<sys/time.h
>

34 (
	tmyfú
)(cÚ¡ 
	t¢d_pcm_hw_·¿ms_t
 *);

36 
	$maš
(
¬gc
 
ATTRIBUTE_UNUSED
, *
¬gv
[] ATTRIBUTE_UNUSED)

38 
myfú
 *
fú
;

39 
	`¢d_pcm_hw_·¿ms_g‘_acûss
(
NULL
);

40 
fú
 = &
¢d_pcm_hw_·¿ms_g‘_acûss
;

42 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/omixer.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<¡ršg.h
>

4 
	~<sched.h
>

5 
	~<”ºo.h
>

6 
	~<g‘İt.h
>

7 
	~"../šşude/mix”_Üdš¬y.h
"

8 
	~<sys/time.h
>

9 
	~<m©h.h
>

11 
	$h–p
()

13 
	`´štf
(

19 
	}
}

21 
	$maš
(
¬gc
, *
¬gv
[])

23 
İtiÚ
 
lÚg_İtiÚ
[] =

25 {"h–p", 0, 
NULL
, 'h'},

26 {"²ame", 1, 
NULL
, 'P'},

27 {"úame", 1, 
NULL
, 'C'},

28 {
NULL
, 0, NULL, 0},

30 
”r
, 
mÜeh–p
, 
»suÉ
 = 
EXIT_SUCCESS
;

31 *
²ame
 = "deçuÉ", *
úame
 = "default";

32 
¢d_pcm_t
 *
phªdË
 = 
NULL
, *
chªdË
 = NULL;

33 
¢do_mix”_t
 *
hªdË
;

35 
mÜeh–p
 = 0;

37 
c
;

38 ià((
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hP:C:", 
lÚg_İtiÚ
, 
NULL
)) < 0)

40 
c
) {

42 
mÜeh–p
++;

45 
²ame
 = 
	`¡rdup
(
İrg
);

48 
úame
 = 
	`¡rdup
(
İrg
);

53 ià(
mÜeh–p
) {

54 
	`h–p
();

58 ià(
	`¡rcmp
(
²ame
, "-")) {

59 
”r
 = 
	`¢d_pcm_İ’
(&
phªdË
, 
²ame
, 
SND_PCM_STREAM_PLAYBACK
, 0);

60 ià(
”r
 < 0) {

61 
	`årštf
(
¡d”r
, "PÏyback PCM o³À”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

62 
»suÉ
 = 
EXIT_FAILURE
;

63 
__’d
;

67 ià(
	`¡rcmp
(
úame
, "-")) {

68 
”r
 = 
	`¢d_pcm_İ’
(&
chªdË
, 
úame
, 
SND_PCM_STREAM_CAPTURE
, 0);

69 ià(
”r
 < 0) {

70 ià(
phªdË
)

71 
	`¢d_pcm_şo£
(
phªdË
);

72 
	`årštf
(
¡d”r
, "C­tu» PCM o³À”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

73 
»suÉ
 = 
EXIT_FAILURE
;

74 
__’d
;

78 
”r
 = 
	`¢do_mix”_İ’_pcm
(&
hªdË
, 
phªdË
, 
chªdË
, 
NULL
);

79 ià(
”r
 < 0) {

80 
	`årštf
(
¡d”r
, "mix” o³À”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

81 
»suÉ
 = 
EXIT_FAILURE
;

83 
	`¢do_mix”_şo£
(
hªdË
);

85 
__’d
:

86 ià(
chªdË
)

87 
	`¢d_pcm_şo£
(
chªdË
);

88 ià(
phªdË
)

89 
	`¢d_pcm_şo£
(
phªdË
);

90 
	`¢d_cÚfig_upd©e_ä“_glob®
();

91  
»suÉ
;

92 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/pcm-multi-thread.c

20 
	~<¡dio.h
>

21 
	~<±h»ad.h
>

22 
	~<g‘İt.h
>

23 
	~"../šşude/asoundlib.h
"

25 
	#MAX_THREADS
 10

	)

28 
	mMODE_AVAIL_UPDATE
,

29 
	mMODE_STATUS
,

30 
	mMODE_HWSYNC
,

31 
	mMODE_TIMESTAMP
,

32 
	mMODE_DELAY
,

33 
	mMODE_RANDOM


36 
	gmode_suffix
[] = {

40 cÚ¡ *
	gpcmdev
 = "default";

41 
	g¡»am
 = 
SND_PCM_STREAM_PLAYBACK
;

42 
	gnum_th»ads
 = 1;

43 
	g³riodsize
 = 16 * 1024;

44 
	gbufsize
 = 16 * 1024 * 4;

45 
	gchªÃls
 = 2;

46 
	g¿‹
 = 48000;

47 
¢d_pcm_fÜm©_t
 
	gfÜm©
 = 
SND_PCM_FORMAT_S16_LE
;

49 
	gruÂšg_mode
 = 
MODE_AVAIL_UPDATE
;

50 
	gshow_v®ue
 = 0;

51 
	gqu›t
 = 0;

53 
±h»ad_t
 
	g³•”_th»ads
[
MAX_THREADS
];

54 
	gruÂšg
 = 1;

55 
¢d_pcm_t
 *
	gpcm
;

57 *
	$³•”
(*
d©a
)

59 
th»ad_no
 = ()
d©a
;

60 
¢d_pcm_säames_t
 
v®
;

61 
¢d_pcm_¡©us_t
 *
¡©
;

62 
¢d_htime¡amp_t
 
t¡amp
;

63 
mode
 = 
ruÂšg_mode
, 
”r
;

65 
	`¢d_pcm_¡©us_®loÿ
(&
¡©
);

67 
ruÂšg
) {

68 ià(
ruÂšg_mode
 =ğ
MODE_RANDOM
)

69 
mode
 = 
	`¿nd
(è% 
MODE_RANDOM
;

70 
mode
) {

71 
MODE_AVAIL_UPDATE
:

72 
v®
 = 
	`¢d_pcm_ava_upd©e
(
pcm
);

73 
”r
 = 0;

75 
MODE_STATUS
:

76 
”r
 = 
	`¢d_pcm_¡©us
(
pcm
, 
¡©
);

77 
v®
 = 
	`¢d_pcm_¡©us_g‘_ava
(
¡©
);

79 
MODE_HWSYNC
:

80 
”r
 = 
	`¢d_pcm_hwsync
(
pcm
);

82 
MODE_TIMESTAMP
:

83 
”r
 = 
	`¢d_pcm_htime¡amp
(
pcm
, (
¢d_pcm_uäames_t
 *)&
v®
,

84 &
t¡amp
);

87 
”r
 = 
	`¢d_pcm_d–ay
(
pcm
, &
v®
);

91 ià(
qu›t
)

93 ià(
ruÂšg_mode
 =ğ
MODE_RANDOM
) {

94 
	`årštf
(
¡d”r
, "%d%c%s", 
th»ad_no
, 
mode_suffix
[
mode
],

95 
”r
 ? "!" : "");

97 ià(
show_v®ue
 && 
mode
 !ğ
MODE_HWSYNC
)

98 
	`årštf
(
¡d”r
, "\r%d ", ()
v®
);

100 
	`årštf
(
¡d”r
, "%d%s", 
th»ad_no
,

101 
”r
 ? "!" : "");

104  
NULL
;

105 
	}
}

107 
	$u§ge
()

109 
	`årštf
(
¡d”r
, "usage: multi-thread [-options]\n");

110 
	`årštf
(
¡d”r
, " -D str Set device‚ame\n");

111 
	`årštf
(
¡d”r
, " -r val Set sample„ate\n");

112 
	`årštf
(
¡d”r
, " -p val Set…eriod size (in frame)\n");

113 
	`årštf
(
¡d”r
, " -b val Set buffer size (in frame)\n");

114 
	`årštf
(
¡d”r
, " -c val Set‚umber of channels\n");

115 
	`årštf
(
¡d”r
, " -f str Set PCM format\n");

116 
	`årštf
(
¡d”r
, " -s str Set stream direction (playback or capture)\n");

117 
	`årštf
(
¡d”r
, " -t val Set‚umber ofhreads\n");

118 
	`årštf
(
¡d”r
, " -m str Running mode (avail, status, hwsync,imestamp, delay,„andom)\n");

119 
	`årštf
(
¡d”r
, " -v Show value\n");

120 
	`årštf
(
¡d”r
, " -q Quiet mode\n");

121 
	}
}

123 
	$·r£_İtiÚs
(
¬gc
, **
¬gv
)

125 
c
, 
i
;

127 (
c
 = 
	`g‘İt
(
¬gc
, 
¬gv
, "D:r:f:p:b:s:t:m:vq")) >= 0) {

128 
c
) {

130 
pcmdev
 = 
İrg
;

133 
¿‹
 = 
	`©oi
(
İrg
);

136 
³riodsize
 = 
	`©oi
(
İrg
);

139 
bufsize
 = 
	`©oi
(
İrg
);

142 
chªÃls
 = 
	`©oi
(
İrg
);

145 
fÜm©
 = 
	`¢d_pcm_fÜm©_v®ue
(
İrg
);

148 ià(*
İrg
 == 'p' || *optarg == 'P')

149 
¡»am
 = 
SND_PCM_STREAM_PLAYBACK
;

150 ià(*
İrg
 == 'c' || *optarg == 'C')

151 
¡»am
 = 
SND_PCM_STREAM_CAPTURE
;

153 
	`årštf
(
¡d”r
, "invalid stream direction\n");

158 
num_th»ads
 = 
	`©oi
(
İrg
);

159 ià(
num_th»ads
 < 1 ||‚um_th»ad > 
MAX_THREADS
) {

160 
	`årštf
(
¡d”r
, "invalid‚umber ofhreads\n");

165 
i
 = 0; i <ğ
MODE_RANDOM
; i++)

166 ià(
mode_suffix
[
i
] =ğ*
İrg
)

168 ià(
i
 > 
MODE_RANDOM
) {

169 
	`årštf
(
¡d”r
, "invalid modeype\n");

172 
ruÂšg_mode
 = 
i
;

175 
show_v®ue
 = 1;

178 
qu›t
 = 1;

181 
	`u§ge
();

186 
	}
}

188 
	$£tup_·¿ms
()

190 
¢d_pcm_hw_·¿ms_t
 *
hw
;

193 
	`¢d_pcm_hw_·¿ms_®loÿ
(&
hw
);

194 
	`¢d_pcm_hw_·¿ms_ªy
(
pcm
, 
hw
);

195 
	`¢d_pcm_hw_·¿ms_£t_acûss
(
pcm
, 
hw
, 
SND_PCM_ACCESS_RW_INTERLEAVED
);

196 
	`¢d_pcm_hw_·¿ms_£t_fÜm©
(
pcm
, 
hw
, 
fÜm©
);

197 
	`¢d_pcm_hw_·¿ms_£t_chªÃls
(
pcm
, 
hw
, 
chªÃls
);

198 
	`¢d_pcm_hw_·¿ms_£t_¿‹
(
pcm
, 
hw
, 
¿‹
, 0);

199 
	`¢d_pcm_hw_·¿ms_£t_³riod_size
(
pcm
, 
hw
, 
³riodsize
, 0);

200 
	`¢d_pcm_hw_·¿ms_£t_bufãr_size
(
pcm
, 
hw
, 
bufsize
);

201 ià(
	`¢d_pcm_hw_·¿ms
(
pcm
, 
hw
) < 0) {

202 
	`årštf
(
¡d”r
, "snd_pcm_hw_paramsƒrror\n");

206 
	}
}

208 
	$maš
(
¬gc
, **
¬gv
)

210 *
buf
;

211 
i
, 
”r
;

213 ià(
	`·r£_İtiÚs
(
¬gc
, 
¬gv
))

216 
”r
 = 
	`¢d_pcm_İ’
(&
pcm
, 
pcmdev
, 
¡»am
, 0);

217 ià(
”r
 < 0) {

218 
	`årštf
(
¡d”r
, "ÿÂÙ o³Àpcm %s\n", 
pcmdev
);

222 ià(
	`£tup_·¿ms
())

225 
buf
 = 
	`ÿÎoc
(1, 
	`¢d_pcm_fÜm©_size
(
fÜm©
, 
bufsize
è* 
chªÃls
);

226 ià(!
buf
) {

227 
	`årštf
(
¡d”r
, "cannot‡lloc buffer\n");

231 
i
 = 0; i < 
num_th»ads
; i++) {

232 ià(
	`±h»ad_ü—‹
(&
³•”_th»ads
[
i
], 
NULL
, 
³•”
, (*)()i)) {

233 
	`årštf
(
¡d”r
, "pthread_createƒrror\n");

238 ià(
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
)

239 
	`¢d_pcm_¡¬t
(
pcm
);

241 
size
 = 
	`¿nd
(è% (
bufsize
 / 2);

242 ià(
¡»am
 =ğ
SND_PCM_STREAM_PLAYBACK
)

243 
”r
 = 
	`¢d_pcm_wr™ei
(
pcm
, 
buf
, 
size
);

245 
”r
 = 
	`¢d_pcm_»adi
(
pcm
, 
buf
, 
size
);

246 ià(
”r
 < 0) {

247 
	`årštf
(
¡d”r
, "»ad/wr™”rÜ %d\n", 
”r
);

248 
”r
 = 
	`¢d_pcm_»cov”
(
pcm
,ƒrr, 0);

249 ià(
”r
 < 0)

251 ià(
¡»am
 =ğ
SND_PCM_STREAM_CAPTURE
)

252 
	`¢d_pcm_¡¬t
(
pcm
);

256 
ruÂšg
 = 0;

257 
i
 = 0; i < 
num_th»ads
; i++)

258 
	`±h»ad_ÿnûl
(
³•”_th»ads
[
i
]);

259 
i
 = 0; i < 
num_th»ads
; i++)

260 
	`±h»ad_još
(
³•”_th»ads
[
i
], 
NULL
);

263 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/pcm.c

5 
	~"cÚfig.h
"

7 
	~<¡dio.h
>

8 
	~<¡dlib.h
>

9 
	~<¡ršg.h
>

10 
	~<sched.h
>

11 
	~<”ºo.h
>

12 
	~<g‘İt.h
>

13 
	~"../šşude/asoundlib.h
"

14 
	~<sys/time.h
>

15 
	~<m©h.h
>

17 #iâdeà
ESTRPIPE


18 
	#ESTRPIPE
 
ESPIPE


	)

21 *
	gdeviû
 = "plughw:0,0";

22 
¢d_pcm_fÜm©_t
 
	gfÜm©
 = 
SND_PCM_FORMAT_S16
;

23 
	g¿‹
 = 44100;

24 
	gchªÃls
 = 1;

25 
	gbufãr_time
 = 500000;

26 
	g³riod_time
 = 100000;

27 
	gäeq
 = 440;

28 
	gv”bo£
 = 0;

29 
	g»§m¶e
 = 1;

30 
	g³riod_ev’t
 = 0;

32 
¢d_pcm_säames_t
 
	gbufãr_size
;

33 
¢d_pcm_säames_t
 
	g³riod_size
;

34 
¢d_ouut_t
 *
	gouut
 = 
NULL
;

36 
	$g’”©e_sše
(cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
,

37 
¢d_pcm_uäames_t
 
off£t
,

38 
couÁ
, *
_pha£
)

40 
max_pha£
 = 2. * 
M_PI
;

41 
pha£
 = *
_pha£
;

42 
¡•
 = 
max_pha£
*
äeq
/()
¿‹
;

43 *
§m¶es
[
chªÃls
];

44 
¡•s
[
chªÃls
];

45 
chn
;

46 
fÜm©_b™s
 = 
	`¢d_pcm_fÜm©_width
(
fÜm©
);

47 
maxv®
 = (1 << (
fÜm©_b™s
 - 1)) - 1;

48 
bps
 = 
fÜm©_b™s
 / 8;

49 
phys_bps
 = 
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
) / 8;

50 
big_’dŸn
 = 
	`¢d_pcm_fÜm©_big_’dŸn
(
fÜm©
) == 1;

51 
to_unsigÃd
 = 
	`¢d_pcm_fÜm©_unsigÃd
(
fÜm©
) == 1;

52 
is_æßt
 = (
fÜm©
 =ğ
SND_PCM_FORMAT_FLOAT_LE
 ||

53 
fÜm©
 =ğ
SND_PCM_FORMAT_FLOAT_BE
);

56 
chn
 = 0; chÀ< 
chªÃls
; chn++) {

57 ià((
¬—s
[
chn
].
fœ¡
 % 8) != 0) {

58 
	`´štf
("¬—s[%u].fœ¡ =ğ%u,‡bÜtšg...\n", 
chn
, 
¬—s
[chn].
fœ¡
);

59 
	`ex™
(
EXIT_FAILURE
);

61 
§m¶es
[
chn
] = (((*)
¬—s
[chn].
addr
è+ (¬—s[chn].
fœ¡
 / 8));

62 ià((
¬—s
[
chn
].
¡•
 % 16) != 0) {

63 
	`´štf
("¬—s[%u].¡• =ğ%u,‡bÜtšg...\n", 
chn
, 
¬—s
[chn].
¡•
);

64 
	`ex™
(
EXIT_FAILURE
);

66 
¡•s
[
chn
] = 
¬—s
[chn].
¡•
 / 8;

67 
§m¶es
[
chn
] +ğ
off£t
 * 
¡•s
[chn];

70 
couÁ
-- > 0) {

72 
f
;

73 
i
;

74 } 
fv®
;

75 
»s
, 
i
;

76 ià(
is_æßt
) {

77 
fv®
.
f
 = 
	`sš
(
pha£
);

78 
»s
 = 
fv®
.
i
;

80 
»s
 = 
	`sš
(
pha£
è* 
maxv®
;

81 ià(
to_unsigÃd
)

82 
»s
 ^ğ1U << (
fÜm©_b™s
 - 1);

83 
chn
 = 0; chÀ< 
chªÃls
; chn++) {

85 ià(
big_’dŸn
) {

86 
i
 = 0; i < 
bps
; i++)

87 *(
§m¶es
[
chn
] + 
phys_bps
 - 1 - 
i
èğ(
»s
 >> i * 8) & 0xff;

89 
i
 = 0; i < 
bps
; i++)

90 *(
§m¶es
[
chn
] + 
i
èğ(
»s
 >> i * 8) & 0xff;

92 
§m¶es
[
chn
] +ğ
¡•s
[chn];

94 
pha£
 +ğ
¡•
;

95 ià(
pha£
 >ğ
max_pha£
)

96 
pha£
 -ğ
max_pha£
;

98 *
_pha£
 = 
pha£
;

99 
	}
}

101 
	$£t_hw·¿ms
(
¢d_pcm_t
 *
hªdË
,

102 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
,

103 
¢d_pcm_acûss_t
 
acûss
)

105 
¼©e
;

106 
¢d_pcm_uäames_t
 
size
;

107 
”r
, 
dœ
;

110 
”r
 = 
	`¢d_pcm_hw_·¿ms_ªy
(
hªdË
, 
·¿ms
);

111 ià(
”r
 < 0) {

112 
	`´štf
("Brok’ cÚfigu¿tiÚ fÜ…Ïyback:‚ØcÚfigu¿tiÚ avaabË: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

113  
”r
;

116 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_¿‹_»§m¶e
(
hªdË
, 
·¿ms
, 
»§m¶e
);

117 ià(
”r
 < 0) {

118 
	`´štf
("Re§m¶šg s‘u°çed fÜ…Ïyback: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

119  
”r
;

122 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_acûss
(
hªdË
, 
·¿ms
, 
acûss
);

123 ià(
”r
 < 0) {

124 
	`´štf
("Acûs ty³‚Ù‡vaabË fÜ…Ïyback: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

125  
”r
;

128 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_fÜm©
(
hªdË
, 
·¿ms
, 
fÜm©
);

129 ià(
”r
 < 0) {

130 
	`´štf
("Sam¶fÜm©‚Ù‡vaabË fÜ…Ïyback: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

131  
”r
;

134 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_chªÃls
(
hªdË
, 
·¿ms
, 
chªÃls
);

135 ià(
”r
 < 0) {

136 
	`´štf
("ChªÃl couÁ (%uènÙ‡vaabË fÜ…Ïybacks: %s\n", 
chªÃls
, 
	`¢d_¡»¼Ü
(
”r
));

137  
”r
;

140 
¼©e
 = 
¿‹
;

141 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_¿‹_Ã¬
(
hªdË
, 
·¿ms
, &
¼©e
, 0);

142 ià(
”r
 < 0) {

143 
	`´štf
("R©%uHz‚Ù‡vaabË fÜ…Ïyback: %s\n", 
¿‹
, 
	`¢d_¡»¼Ü
(
”r
));

144  
”r
;

146 ià(
¼©e
 !ğ
¿‹
) {

147 
	`´štf
("R©dÛ¢'ˆm©ch (»que¡ed %uHz, g‘ %iHz)\n", 
¿‹
, 
”r
);

148  -
EINVAL
;

151 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_bufãr_time_Ã¬
(
hªdË
, 
·¿ms
, &
bufãr_time
, &
dœ
);

152 ià(
”r
 < 0) {

153 
	`´štf
("UÇbËØ£ˆbufã¸tim%u fÜ…Ïyback: %s\n", 
bufãr_time
, 
	`¢d_¡»¼Ü
(
”r
));

154  
”r
;

156 
”r
 = 
	`¢d_pcm_hw_·¿ms_g‘_bufãr_size
(
·¿ms
, &
size
);

157 ià(
”r
 < 0) {

158 
	`´štf
("UÇbËØg‘ bufã¸sizfÜ…Ïyback: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

159  
”r
;

161 
bufãr_size
 = 
size
;

163 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_³riod_time_Ã¬
(
hªdË
, 
·¿ms
, &
³riod_time
, &
dœ
);

164 ià(
”r
 < 0) {

165 
	`´štf
("UÇbËØ£ˆ³riodim%u fÜ…Ïyback: %s\n", 
³riod_time
, 
	`¢d_¡»¼Ü
(
”r
));

166  
”r
;

168 
”r
 = 
	`¢d_pcm_hw_·¿ms_g‘_³riod_size
(
·¿ms
, &
size
, &
dœ
);

169 ià(
”r
 < 0) {

170 
	`´štf
("UÇbËØg‘…”iod sizfÜ…Ïyback: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

171  
”r
;

173 
³riod_size
 = 
size
;

175 
”r
 = 
	`¢d_pcm_hw_·¿ms
(
hªdË
, 
·¿ms
);

176 ià(
”r
 < 0) {

177 
	`´štf
("UÇbËØ£ˆhw…¬am fÜ…Ïyback: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

178  
”r
;

181 
	}
}

183 
	$£t_sw·¿ms
(
¢d_pcm_t
 *
hªdË
, 
¢d_pcm_sw_·¿ms_t
 *
sw·¿ms
)

185 
”r
;

188 
”r
 = 
	`¢d_pcm_sw_·¿ms_cu¼’t
(
hªdË
, 
sw·¿ms
);

189 ià(
”r
 < 0) {

190 
	`´štf
("UÇbËØd‘”mšcu¼’ˆsw·¿m fÜ…Ïyback: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

191  
”r
;

195 
”r
 = 
	`¢d_pcm_sw_·¿ms_£t_¡¬t_th»shŞd
(
hªdË
, 
sw·¿ms
, (
bufãr_size
 / 
³riod_size
) *…eriod_size);

196 ià(
”r
 < 0) {

197 
	`´štf
("UÇbËØ£ˆ¡¬ˆth»shŞd modfÜ…Ïyback: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

198  
”r
;

202 
”r
 = 
	`¢d_pcm_sw_·¿ms_£t_ava_mš
(
hªdË
, 
sw·¿ms
, 
³riod_ev’t
 ? 
bufãr_size
 : 
³riod_size
);

203 ià(
”r
 < 0) {

204 
	`´štf
("UÇbËØ£ˆava mš fÜ…Ïyback: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

205  
”r
;

208 ià(
³riod_ev’t
) {

209 
”r
 = 
	`¢d_pcm_sw_·¿ms_£t_³riod_ev’t
(
hªdË
, 
sw·¿ms
, 1);

210 ià(
”r
 < 0) {

211 
	`´štf
("UÇbËØ£ˆ³riodƒv’t: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

212  
”r
;

216 
”r
 = 
	`¢d_pcm_sw_·¿ms
(
hªdË
, 
sw·¿ms
);

217 ià(
”r
 < 0) {

218 
	`´štf
("UÇbËØ£ˆsw…¬am fÜ…Ïyback: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

219  
”r
;

222 
	}
}

228 
	$xrun_»cov”y
(
¢d_pcm_t
 *
hªdË
, 
”r
)

230 ià(
v”bo£
)

231 
	`´štf
("stream„ecovery\n");

232 ià(
”r
 =ğ-
EPIPE
) {

233 
”r
 = 
	`¢d_pcm_´•¬e
(
hªdË
);

234 ià(
”r
 < 0)

235 
	`´štf
("Cª'ˆ»cov”y from und”run,…»·» faed: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

237 } ià(
”r
 =ğ-
ESTRPIPE
) {

238 (
”r
 = 
	`¢d_pcm_»sume
(
hªdË
)è=ğ-
EAGAIN
)

239 
	`¦“p
(1);

240 ià(
”r
 < 0) {

241 
”r
 = 
	`¢d_pcm_´•¬e
(
hªdË
);

242 ià(
”r
 < 0)

243 
	`´štf
("Cª'ˆ»cov”y from su¥’d,…»·» faed: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

247  
”r
;

248 
	}
}

254 
	$wr™e_loİ
(
¢d_pcm_t
 *
hªdË
,

255 sigÃd *
§m¶es
,

256 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
)

258 
pha£
 = 0;

259 sigÃd *
±r
;

260 
”r
, 
ıŒ
;

263 
	`g’”©e_sše
(
¬—s
, 0, 
³riod_size
, &
pha£
);

264 
±r
 = 
§m¶es
;

265 
ıŒ
 = 
³riod_size
;

266 
ıŒ
 > 0) {

267 
”r
 = 
	`¢d_pcm_wr™ei
(
hªdË
, 
±r
, 
ıŒ
);

268 ià(
”r
 =ğ-
EAGAIN
)

270 ià(
”r
 < 0) {

271 ià(
	`xrun_»cov”y
(
hªdË
, 
”r
) < 0) {

272 
	`´štf
("Wr™”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

273 
	`ex™
(
EXIT_FAILURE
);

277 
±r
 +ğ
”r
 * 
chªÃls
;

278 
ıŒ
 -ğ
”r
;

281 
	}
}

287 
	$wa™_fÜ_pŞl
(
¢d_pcm_t
 *
hªdË
, 
pŞlfd
 *
ufds
, 
couÁ
)

289 
»v’ts
;

292 
	`pŞl
(
ufds
, 
couÁ
, -1);

293 
	`¢d_pcm_pŞl_desütÜs_»v’ts
(
hªdË
, 
ufds
, 
couÁ
, &
»v’ts
);

294 ià(
»v’ts
 & 
POLLERR
)

295  -
EIO
;

296 ià(
»v’ts
 & 
POLLOUT
)

299 
	}
}

301 
	$wr™e_ªd_pŞl_loİ
(
¢d_pcm_t
 *
hªdË
,

302 sigÃd *
§m¶es
,

303 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
)

305 
pŞlfd
 *
ufds
;

306 
pha£
 = 0;

307 sigÃd *
±r
;

308 
”r
, 
couÁ
, 
ıŒ
, 
š™
;

310 
couÁ
 = 
	`¢d_pcm_pŞl_desütÜs_couÁ
 (
hªdË
);

311 ià(
couÁ
 <= 0) {

312 
	`´štf
("Invalid…oll descriptors count\n");

313  
couÁ
;

316 
ufds
 = 
	`m®loc
((
pŞlfd
è* 
couÁ
);

317 ià(
ufds
 =ğ
NULL
) {

318 
	`´štf
("Noƒnough memory\n");

319  -
ENOMEM
;

321 ià((
”r
 = 
	`¢d_pcm_pŞl_desütÜs
(
hªdË
, 
ufds
, 
couÁ
)) < 0) {

322 
	`´štf
("UÇbËØobš…ŞÈdesütÜ fÜ…Ïyback: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

323  
”r
;

326 
š™
 = 1;

328 ià(!
š™
) {

329 
”r
 = 
	`wa™_fÜ_pŞl
(
hªdË
, 
ufds
, 
couÁ
);

330 ià(
”r
 < 0) {

331 ià(
	`¢d_pcm_¡©e
(
hªdË
è=ğ
SND_PCM_STATE_XRUN
 ||

332 
	`¢d_pcm_¡©e
(
hªdË
è=ğ
SND_PCM_STATE_SUSPENDED
) {

333 
”r
 = 
	`¢d_pcm_¡©e
(
hªdË
è=ğ
SND_PCM_STATE_XRUN
 ? -
EPIPE
 : -
ESTRPIPE
;

334 ià(
	`xrun_»cov”y
(
hªdË
, 
”r
) < 0) {

335 
	`´štf
("Wr™”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

336 
	`ex™
(
EXIT_FAILURE
);

338 
š™
 = 1;

340 
	`´štf
("Wait for…oll failed\n");

341  
”r
;

346 
	`g’”©e_sše
(
¬—s
, 0, 
³riod_size
, &
pha£
);

347 
±r
 = 
§m¶es
;

348 
ıŒ
 = 
³riod_size
;

349 
ıŒ
 > 0) {

350 
”r
 = 
	`¢d_pcm_wr™ei
(
hªdË
, 
±r
, 
ıŒ
);

351 ià(
”r
 < 0) {

352 ià(
	`xrun_»cov”y
(
hªdË
, 
”r
) < 0) {

353 
	`´štf
("Wr™”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

354 
	`ex™
(
EXIT_FAILURE
);

356 
š™
 = 1;

359 ià(
	`¢d_pcm_¡©e
(
hªdË
è=ğ
SND_PCM_STATE_RUNNING
)

360 
š™
 = 0;

361 
±r
 +ğ
”r
 * 
chªÃls
;

362 
ıŒ
 -ğ
”r
;

363 ià(
ıŒ
 == 0)

367 
”r
 = 
	`wa™_fÜ_pŞl
(
hªdË
, 
ufds
, 
couÁ
);

368 ià(
”r
 < 0) {

369 ià(
	`¢d_pcm_¡©e
(
hªdË
è=ğ
SND_PCM_STATE_XRUN
 ||

370 
	`¢d_pcm_¡©e
(
hªdË
è=ğ
SND_PCM_STATE_SUSPENDED
) {

371 
”r
 = 
	`¢d_pcm_¡©e
(
hªdË
è=ğ
SND_PCM_STATE_XRUN
 ? -
EPIPE
 : -
ESTRPIPE
;

372 ià(
	`xrun_»cov”y
(
hªdË
, 
”r
) < 0) {

373 
	`´štf
("Wr™”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

374 
	`ex™
(
EXIT_FAILURE
);

376 
š™
 = 1;

378 
	`´štf
("Wait for…oll failed\n");

379  
”r
;

384 
	}
}

390 
	sasync_´iv©e_d©a
 {

391 sigÃd *
	m§m¶es
;

392 
¢d_pcm_chªÃl_¬—_t
 *
	m¬—s
;

393 
	mpha£
;

396 
	$async_ÿÎback
(
¢d_async_hªdËr_t
 *
ahªdËr
)

398 
¢d_pcm_t
 *
hªdË
 = 
	`¢d_async_hªdËr_g‘_pcm
(
ahªdËr
);

399 
async_´iv©e_d©a
 *
d©a
 = 
	`¢d_async_hªdËr_g‘_ÿÎback_´iv©e
(
ahªdËr
);

400 sigÃd *
§m¶es
 = 
d©a
->samples;

401 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
 = 
d©a
->areas;

402 
¢d_pcm_säames_t
 
ava
;

403 
”r
;

405 
ava
 = 
	`¢d_pcm_ava_upd©e
(
hªdË
);

406 
ava
 >ğ
³riod_size
) {

407 
	`g’”©e_sše
(
¬—s
, 0, 
³riod_size
, &
d©a
->
pha£
);

408 
”r
 = 
	`¢d_pcm_wr™ei
(
hªdË
, 
§m¶es
, 
³riod_size
);

409 ià(
”r
 < 0) {

410 
	`´štf
("Wr™”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

411 
	`ex™
(
EXIT_FAILURE
);

413 ià(
”r
 !ğ
³riod_size
) {

414 
	`´štf
("Wr™”rÜ: wr™‹À%˜ex³ùed %li\n", 
”r
, 
³riod_size
);

415 
	`ex™
(
EXIT_FAILURE
);

417 
ava
 = 
	`¢d_pcm_ava_upd©e
(
hªdË
);

419 
	}
}

421 
	$async_loİ
(
¢d_pcm_t
 *
hªdË
,

422 sigÃd *
§m¶es
,

423 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
)

425 
async_´iv©e_d©a
 
d©a
;

426 
¢d_async_hªdËr_t
 *
ahªdËr
;

427 
”r
, 
couÁ
;

429 
d©a
.
§m¶es
 = samples;

430 
d©a
.
¬—s
 =‡reas;

431 
d©a
.
pha£
 = 0;

432 
”r
 = 
	`¢d_async_add_pcm_hªdËr
(&
ahªdËr
, 
hªdË
, 
async_ÿÎback
, &
d©a
);

433 ià(
”r
 < 0) {

434 
	`´štf
("Unableo„egister‡sync handler\n");

435 
	`ex™
(
EXIT_FAILURE
);

437 
couÁ
 = 0; count < 2; count++) {

438 
	`g’”©e_sše
(
¬—s
, 0, 
³riod_size
, &
d©a
.
pha£
);

439 
”r
 = 
	`¢d_pcm_wr™ei
(
hªdË
, 
§m¶es
, 
³riod_size
);

440 ià(
”r
 < 0) {

441 
	`´štf
("In™ŸÈwr™”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

442 
	`ex™
(
EXIT_FAILURE
);

444 ià(
”r
 !ğ
³riod_size
) {

445 
	`´štf
("In™ŸÈwr™”rÜ: wr™‹À%˜ex³ùed %li\n", 
”r
, 
³riod_size
);

446 
	`ex™
(
EXIT_FAILURE
);

449 ià(
	`¢d_pcm_¡©e
(
hªdË
è=ğ
SND_PCM_STATE_PREPARED
) {

450 
”r
 = 
	`¢d_pcm_¡¬t
(
hªdË
);

451 ià(
”r
 < 0) {

452 
	`´štf
("S¹ƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

453 
	`ex™
(
EXIT_FAILURE
);

460 
	`¦“p
(1);

462 
	}
}

468 
	$async_dœeù_ÿÎback
(
¢d_async_hªdËr_t
 *
ahªdËr
)

470 
¢d_pcm_t
 *
hªdË
 = 
	`¢d_async_hªdËr_g‘_pcm
(
ahªdËr
);

471 
async_´iv©e_d©a
 *
d©a
 = 
	`¢d_async_hªdËr_g‘_ÿÎback_´iv©e
(
ahªdËr
);

472 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
my_¬—s
;

473 
¢d_pcm_uäames_t
 
off£t
, 
äames
, 
size
;

474 
¢d_pcm_säames_t
 
ava
, 
comm™»s
;

475 
¢d_pcm_¡©e_t
 
¡©e
;

476 
fœ¡
 = 0, 
”r
;

479 
¡©e
 = 
	`¢d_pcm_¡©e
(
hªdË
);

480 ià(
¡©e
 =ğ
SND_PCM_STATE_XRUN
) {

481 
”r
 = 
	`xrun_»cov”y
(
hªdË
, -
EPIPE
);

482 ià(
”r
 < 0) {

483 
	`´štf
("XRUN„ecov”y faed: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

484 
	`ex™
(
EXIT_FAILURE
);

486 
fœ¡
 = 1;

487 } ià(
¡©e
 =ğ
SND_PCM_STATE_SUSPENDED
) {

488 
”r
 = 
	`xrun_»cov”y
(
hªdË
, -
ESTRPIPE
);

489 ià(
”r
 < 0) {

490 
	`´štf
("SUSPEND„ecov”y faed: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

491 
	`ex™
(
EXIT_FAILURE
);

494 
ava
 = 
	`¢d_pcm_ava_upd©e
(
hªdË
);

495 ià(
ava
 < 0) {

496 
”r
 = 
	`xrun_»cov”y
(
hªdË
, 
ava
);

497 ià(
”r
 < 0) {

498 
	`´štf
("ava upd©çed: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

499 
	`ex™
(
EXIT_FAILURE
);

501 
fœ¡
 = 1;

504 ià(
ava
 < 
³riod_size
) {

505 ià(
fœ¡
) {

506 
fœ¡
 = 0;

507 
”r
 = 
	`¢d_pcm_¡¬t
(
hªdË
);

508 ià(
”r
 < 0) {

509 
	`´štf
("S¹ƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

510 
	`ex™
(
EXIT_FAILURE
);

517 
size
 = 
³riod_size
;

518 
size
 > 0) {

519 
äames
 = 
size
;

520 
”r
 = 
	`¢d_pcm_mm­_begš
(
hªdË
, &
my_¬—s
, &
off£t
, &
äames
);

521 ià(
”r
 < 0) {

522 ià((
”r
 = 
	`xrun_»cov”y
(
hªdË
,ƒrr)) < 0) {

523 
	`´štf
("MMAP begš‡vaƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

524 
	`ex™
(
EXIT_FAILURE
);

526 
fœ¡
 = 1;

528 
	`g’”©e_sše
(
my_¬—s
, 
off£t
, 
äames
, &
d©a
->
pha£
);

529 
comm™»s
 = 
	`¢d_pcm_mm­_comm™
(
hªdË
, 
off£t
, 
äames
);

530 ià(
comm™»s
 < 0 || (
¢d_pcm_uäames_t
)comm™» !ğ
äames
) {

531 ià((
”r
 = 
	`xrun_»cov”y
(
hªdË
, 
comm™»s
 >ğ0 ? -
EPIPE
 : commitres)) < 0) {

532 
	`´štf
("MMAP comm™ƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

533 
	`ex™
(
EXIT_FAILURE
);

535 
fœ¡
 = 1;

537 
size
 -ğ
äames
;

540 
	}
}

542 
	$async_dœeù_loİ
(
¢d_pcm_t
 *
hªdË
,

543 sigÃd *
§m¶es
 
ATTRIBUTE_UNUSED
,

544 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
 
ATTRIBUTE_UNUSED
)

546 
async_´iv©e_d©a
 
d©a
;

547 
¢d_async_hªdËr_t
 *
ahªdËr
;

548 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
my_¬—s
;

549 
¢d_pcm_uäames_t
 
off£t
, 
äames
, 
size
;

550 
¢d_pcm_säames_t
 
comm™»s
;

551 
”r
, 
couÁ
;

553 
d©a
.
§m¶es
 = 
NULL
;

554 
d©a
.
¬—s
 = 
NULL
;

555 
d©a
.
pha£
 = 0;

556 
”r
 = 
	`¢d_async_add_pcm_hªdËr
(&
ahªdËr
, 
hªdË
, 
async_dœeù_ÿÎback
, &
d©a
);

557 ià(
”r
 < 0) {

558 
	`´štf
("Unableo„egister‡sync handler\n");

559 
	`ex™
(
EXIT_FAILURE
);

561 
couÁ
 = 0; count < 2; count++) {

562 
size
 = 
³riod_size
;

563 
size
 > 0) {

564 
äames
 = 
size
;

565 
”r
 = 
	`¢d_pcm_mm­_begš
(
hªdË
, &
my_¬—s
, &
off£t
, &
äames
);

566 ià(
”r
 < 0) {

567 ià((
”r
 = 
	`xrun_»cov”y
(
hªdË
,ƒrr)) < 0) {

568 
	`´štf
("MMAP begš‡vaƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

569 
	`ex™
(
EXIT_FAILURE
);

572 
	`g’”©e_sše
(
my_¬—s
, 
off£t
, 
äames
, &
d©a
.
pha£
);

573 
comm™»s
 = 
	`¢d_pcm_mm­_comm™
(
hªdË
, 
off£t
, 
äames
);

574 ià(
comm™»s
 < 0 || (
¢d_pcm_uäames_t
)comm™» !ğ
äames
) {

575 ià((
”r
 = 
	`xrun_»cov”y
(
hªdË
, 
comm™»s
 >ğ0 ? -
EPIPE
 : commitres)) < 0) {

576 
	`´štf
("MMAP comm™ƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

577 
	`ex™
(
EXIT_FAILURE
);

580 
size
 -ğ
äames
;

583 
”r
 = 
	`¢d_pcm_¡¬t
(
hªdË
);

584 ià(
”r
 < 0) {

585 
	`´štf
("S¹ƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

586 
	`ex™
(
EXIT_FAILURE
);

592 
	`¦“p
(1);

594 
	}
}

600 
	$dœeù_loİ
(
¢d_pcm_t
 *
hªdË
,

601 sigÃd *
§m¶es
 
ATTRIBUTE_UNUSED
,

602 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
 
ATTRIBUTE_UNUSED
)

604 
pha£
 = 0;

605 cÚ¡ 
¢d_pcm_chªÃl_¬—_t
 *
my_¬—s
;

606 
¢d_pcm_uäames_t
 
off£t
, 
äames
, 
size
;

607 
¢d_pcm_säames_t
 
ava
, 
comm™»s
;

608 
¢d_pcm_¡©e_t
 
¡©e
;

609 
”r
, 
fœ¡
 = 1;

612 
¡©e
 = 
	`¢d_pcm_¡©e
(
hªdË
);

613 ià(
¡©e
 =ğ
SND_PCM_STATE_XRUN
) {

614 
”r
 = 
	`xrun_»cov”y
(
hªdË
, -
EPIPE
);

615 ià(
”r
 < 0) {

616 
	`´štf
("XRUN„ecov”y faed: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

617  
”r
;

619 
fœ¡
 = 1;

620 } ià(
¡©e
 =ğ
SND_PCM_STATE_SUSPENDED
) {

621 
”r
 = 
	`xrun_»cov”y
(
hªdË
, -
ESTRPIPE
);

622 ià(
”r
 < 0) {

623 
	`´štf
("SUSPEND„ecov”y faed: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

624  
”r
;

627 
ava
 = 
	`¢d_pcm_ava_upd©e
(
hªdË
);

628 ià(
ava
 < 0) {

629 
”r
 = 
	`xrun_»cov”y
(
hªdË
, 
ava
);

630 ià(
”r
 < 0) {

631 
	`´štf
("ava upd©çed: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

632  
”r
;

634 
fœ¡
 = 1;

637 ià(
ava
 < 
³riod_size
) {

638 ià(
fœ¡
) {

639 
fœ¡
 = 0;

640 
”r
 = 
	`¢d_pcm_¡¬t
(
hªdË
);

641 ià(
”r
 < 0) {

642 
	`´štf
("S¹ƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

643 
	`ex™
(
EXIT_FAILURE
);

646 
”r
 = 
	`¢d_pcm_wa™
(
hªdË
, -1);

647 ià(
”r
 < 0) {

648 ià((
”r
 = 
	`xrun_»cov”y
(
hªdË
,ƒrr)) < 0) {

649 
	`´štf
("¢d_pcm_wa™ƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

650 
	`ex™
(
EXIT_FAILURE
);

652 
fœ¡
 = 1;

657 
size
 = 
³riod_size
;

658 
size
 > 0) {

659 
äames
 = 
size
;

660 
”r
 = 
	`¢d_pcm_mm­_begš
(
hªdË
, &
my_¬—s
, &
off£t
, &
äames
);

661 ià(
”r
 < 0) {

662 ià((
”r
 = 
	`xrun_»cov”y
(
hªdË
,ƒrr)) < 0) {

663 
	`´štf
("MMAP begš‡vaƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

664 
	`ex™
(
EXIT_FAILURE
);

666 
fœ¡
 = 1;

668 
	`g’”©e_sše
(
my_¬—s
, 
off£t
, 
äames
, &
pha£
);

669 
comm™»s
 = 
	`¢d_pcm_mm­_comm™
(
hªdË
, 
off£t
, 
äames
);

670 ià(
comm™»s
 < 0 || (
¢d_pcm_uäames_t
)comm™» !ğ
äames
) {

671 ià((
”r
 = 
	`xrun_»cov”y
(
hªdË
, 
comm™»s
 >ğ0 ? -
EPIPE
 : commitres)) < 0) {

672 
	`´štf
("MMAP comm™ƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

673 
	`ex™
(
EXIT_FAILURE
);

675 
fœ¡
 = 1;

677 
size
 -ğ
äames
;

680 
	}
}

686 
	$dœeù_wr™e_loİ
(
¢d_pcm_t
 *
hªdË
,

687 sigÃd *
§m¶es
,

688 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
)

690 
pha£
 = 0;

691 sigÃd *
±r
;

692 
”r
, 
ıŒ
;

695 
	`g’”©e_sše
(
¬—s
, 0, 
³riod_size
, &
pha£
);

696 
±r
 = 
§m¶es
;

697 
ıŒ
 = 
³riod_size
;

698 
ıŒ
 > 0) {

699 
”r
 = 
	`¢d_pcm_mm­_wr™ei
(
hªdË
, 
±r
, 
ıŒ
);

700 ià(
”r
 =ğ-
EAGAIN
)

702 ià(
”r
 < 0) {

703 ià(
	`xrun_»cov”y
(
hªdË
, 
”r
) < 0) {

704 
	`´štf
("Wr™”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

705 
	`ex™
(
EXIT_FAILURE
);

709 
±r
 +ğ
”r
 * 
chªÃls
;

710 
ıŒ
 -ğ
”r
;

713 
	}
}

719 
	sŒªsãr_m‘hod
 {

720 cÚ¡ *
	mÇme
;

721 
¢d_pcm_acûss_t
 
	macûss
;

722 (*
	mŒªsãr_loİ
)(
¢d_pcm_t
 *
	mhªdË
,

723 sigÃd *
	m§m¶es
,

724 
¢d_pcm_chªÃl_¬—_t
 *
	m¬—s
);

727 
Œªsãr_m‘hod
 
	gŒªsãr_m‘hods
[] = {

728 { "wr™e", 
SND_PCM_ACCESS_RW_INTERLEAVED
, 
wr™e_loİ
 },

729 { "wr™e_ªd_pŞl", 
SND_PCM_ACCESS_RW_INTERLEAVED
, 
wr™e_ªd_pŞl_loİ
 },

730 { "async", 
SND_PCM_ACCESS_RW_INTERLEAVED
, 
async_loİ
 },

731 { "async_dœeù", 
SND_PCM_ACCESS_MMAP_INTERLEAVED
, 
async_dœeù_loİ
 },

732 { "dœeù_š‹¾—ved", 
SND_PCM_ACCESS_MMAP_INTERLEAVED
, 
dœeù_loİ
 },

733 { "dœeù_nÚš‹¾—ved", 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
, 
dœeù_loİ
 },

734 { "dœeù_wr™e", 
SND_PCM_ACCESS_MMAP_INTERLEAVED
, 
dœeù_wr™e_loİ
 },

735 { 
NULL
, 
SND_PCM_ACCESS_RW_INTERLEAVED
, NULL }

738 
	$h–p
()

740 
k
;

741 
	`´štf
(

756 
	`´štf
("Recognized sample formats‡re:");

757 
k
 = 0; k < 
SND_PCM_FORMAT_LAST
; ++k) {

758 cÚ¡ *
s
 = 
	`¢d_pcm_fÜm©_Çme
(
k
);

759 ià(
s
)

760 
	`´štf
(" %s", 
s
);

762 
	`´štf
("\n");

763 
	`´štf
("Recognizedransfer methods‡re:");

764 
k
 = 0; 
Œªsãr_m‘hods
[k].
Çme
; k++)

765 
	`´štf
(" %s", 
Œªsãr_m‘hods
[
k
].
Çme
);

766 
	`´štf
("\n");

767 
	}
}

769 
	$maš
(
¬gc
, *
¬gv
[])

771 
İtiÚ
 
lÚg_İtiÚ
[] =

773 {"h–p", 0, 
NULL
, 'h'},

774 {"deviû", 1, 
NULL
, 'D'},

775 {"¿‹", 1, 
NULL
, 'r'},

776 {"chªÃls", 1, 
NULL
, 'c'},

777 {"äequ’cy", 1, 
NULL
, 'f'},

778 {"bufãr", 1, 
NULL
, 'b'},

779 {"³riod", 1, 
NULL
, 'p'},

780 {"m‘hod", 1, 
NULL
, 'm'},

781 {"fÜm©", 1, 
NULL
, 'o'},

782 {"v”bo£", 1, 
NULL
, 'v'},

783 {"nÜe§m¶e", 1, 
NULL
, 'n'},

784 {"³v’t", 1, 
NULL
, 'e'},

785 {
NULL
, 0, NULL, 0},

787 
¢d_pcm_t
 *
hªdË
;

788 
”r
, 
mÜeh–p
;

789 
¢d_pcm_hw_·¿ms_t
 *
hw·¿ms
;

790 
¢d_pcm_sw_·¿ms_t
 *
sw·¿ms
;

791 
m‘hod
 = 0;

792 sigÃd *
§m¶es
;

793 
chn
;

794 
¢d_pcm_chªÃl_¬—_t
 *
¬—s
;

796 
	`¢d_pcm_hw_·¿ms_®loÿ
(&
hw·¿ms
);

797 
	`¢d_pcm_sw_·¿ms_®loÿ
(&
sw·¿ms
);

799 
mÜeh–p
 = 0;

801 
c
;

802 ià((
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hD:r:c:f:b:p:m:o:vÃ", 
lÚg_İtiÚ
, 
NULL
)) < 0)

804 
c
) {

806 
mÜeh–p
++;

809 
deviû
 = 
	`¡rdup
(
İrg
);

812 
¿‹
 = 
	`©oi
(
İrg
);

813 
¿‹
 =„ate < 4000 ? 4000 :„ate;

814 
¿‹
 =„ate > 196000 ? 196000 :„ate;

817 
chªÃls
 = 
	`©oi
(
İrg
);

818 
chªÃls
 = channels < 1 ? 1 : channels;

819 
chªÃls
 = channels > 1024 ? 1024 : channels;

822 
äeq
 = 
	`©oi
(
İrg
);

823 
äeq
 = freq < 50 ? 50 : freq;

824 
äeq
 = freq > 5000 ? 5000 : freq;

827 
bufãr_time
 = 
	`©oi
(
İrg
);

828 
bufãr_time
 = buffer_time < 1000 ? 1000 : buffer_time;

829 
bufãr_time
 = buffer_time > 1000000 ? 1000000 : buffer_time;

832 
³riod_time
 = 
	`©oi
(
İrg
);

833 
³riod_time
 =…eriod_time < 1000 ? 1000 :…eriod_time;

834 
³riod_time
 =…eriod_time > 1000000 ? 1000000 :…eriod_time;

837 
m‘hod
 = 0; 
Œªsãr_m‘hods
[m‘hod].
Çme
; method++)

838 ià(!
	`¡rÿ£cmp
(
Œªsãr_m‘hods
[
m‘hod
].
Çme
, 
İrg
))

840 ià(
Œªsãr_m‘hods
[
m‘hod
].
Çme
 =ğ
NULL
)

841 
m‘hod
 = 0;

844 
fÜm©
 = 0; fÜm© < 
SND_PCM_FORMAT_LAST
; format++) {

845 cÚ¡ *
fÜm©_Çme
 = 
	`¢d_pcm_fÜm©_Çme
(
fÜm©
);

846 ià(
fÜm©_Çme
)

847 ià(!
	`¡rÿ£cmp
(
fÜm©_Çme
, 
İrg
))

850 ià(
fÜm©
 =ğ
SND_PCM_FORMAT_LAST
)

851 
fÜm©
 = 
SND_PCM_FORMAT_S16
;

852 ià(!
	`¢d_pcm_fÜm©_lš—r
(
fÜm©
) &&

853 !(
fÜm©
 =ğ
SND_PCM_FORMAT_FLOAT_LE
 ||

854 
fÜm©
 =ğ
SND_PCM_FORMAT_FLOAT_BE
)) {

855 
	`´štf
("Invalid (non-linear/float) format %s\n",

856 
İrg
);

861 
v”bo£
 = 1;

864 
»§m¶e
 = 0;

867 
³riod_ev’t
 = 1;

872 ià(
mÜeh–p
) {

873 
	`h–p
();

877 
”r
 = 
	`¢d_ouut_¡dio_©ch
(&
ouut
, 
¡dout
, 0);

878 ià(
”r
 < 0) {

879 
	`´štf
("Ouuˆçed: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

883 
	`´štf
("PÏyback deviû i %s\n", 
deviû
);

884 
	`´štf
("SŒ—m…¬am‘” ¬%uHz, %s, %u chªÃls\n", 
¿‹
, 
	`¢d_pcm_fÜm©_Çme
(
fÜm©
), 
chªÃls
);

885 
	`´štf
("Sšwav¿‹ i %.4fHz\n", 
äeq
);

886 
	`´štf
("Usšg¿nsã¸m‘hod: %s\n", 
Œªsãr_m‘hods
[
m‘hod
].
Çme
);

888 ià((
”r
 = 
	`¢d_pcm_İ’
(&
hªdË
, 
deviû
, 
SND_PCM_STREAM_PLAYBACK
, 0)) < 0) {

889 
	`´štf
("PÏyback o³À”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

893 ià((
”r
 = 
	`£t_hw·¿ms
(
hªdË
, 
hw·¿ms
, 
Œªsãr_m‘hods
[
m‘hod
].
acûss
)) < 0) {

894 
	`´štf
("S‘tšg oàhw·¿m çed: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

895 
	`ex™
(
EXIT_FAILURE
);

897 ià((
”r
 = 
	`£t_sw·¿ms
(
hªdË
, 
sw·¿ms
)) < 0) {

898 
	`´štf
("S‘tšg oàsw·¿m çed: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

899 
	`ex™
(
EXIT_FAILURE
);

902 ià(
v”bo£
 > 0)

903 
	`¢d_pcm_dump
(
hªdË
, 
ouut
);

905 
§m¶es
 = 
	`m®loc
((
³riod_size
 * 
chªÃls
 * 
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
)) / 8);

906 ià(
§m¶es
 =ğ
NULL
) {

907 
	`´štf
("Noƒnough memory\n");

908 
	`ex™
(
EXIT_FAILURE
);

911 
¬—s
 = 
	`ÿÎoc
(
chªÃls
, (
¢d_pcm_chªÃl_¬—_t
));

912 ià(
¬—s
 =ğ
NULL
) {

913 
	`´štf
("Noƒnough memory\n");

914 
	`ex™
(
EXIT_FAILURE
);

916 
chn
 = 0; chÀ< 
chªÃls
; chn++) {

917 
¬—s
[
chn
].
addr
 = 
§m¶es
;

918 
¬—s
[
chn
].
fœ¡
 = chÀ* 
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
);

919 
¬—s
[
chn
].
¡•
 = 
chªÃls
 * 
	`¢d_pcm_fÜm©_physiÿl_width
(
fÜm©
);

922 
”r
 = 
Œªsãr_m‘hods
[
m‘hod
].
	`Œªsãr_loİ
(
hªdË
, 
§m¶es
, 
¬—s
);

923 ià(
”r
 < 0)

924 
	`´štf
("T¿nsã¸çed: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

926 
	`ä“
(
¬—s
);

927 
	`ä“
(
§m¶es
);

928 
	`¢d_pcm_şo£
(
hªdË
);

930 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/pcm_min.c

5 
	~"../šşude/asoundlib.h
"

7 *
	gdeviû
 = "default";

8 
	gbufãr
[16*1024];

10 
	$maš
()

12 
”r
;

13 
i
;

14 
¢d_pcm_t
 *
hªdË
;

15 
¢d_pcm_säames_t
 
äames
;

17 
i
 = 0; i < (
bufãr
); i++)

18 
bufãr
[
i
] = 
	`¿ndom
() & 0xff;

20 ià((
”r
 = 
	`¢d_pcm_İ’
(&
hªdË
, 
deviû
, 
SND_PCM_STREAM_PLAYBACK
, 0)) < 0) {

21 
	`´štf
("PÏyback o³À”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

22 
	`ex™
(
EXIT_FAILURE
);

24 ià((
”r
 = 
	`¢d_pcm_£t_·¿ms
(
hªdË
,

25 
SND_PCM_FORMAT_U8
,

26 
SND_PCM_ACCESS_RW_INTERLEAVED
,

31 
	`´štf
("PÏyback o³À”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

32 
	`ex™
(
EXIT_FAILURE
);

35 
i
 = 0; i < 16; i++) {

36 
äames
 = 
	`¢d_pcm_wr™ei
(
hªdË
, 
bufãr
, (buffer));

37 ià(
äames
 < 0)

38 
äames
 = 
	`¢d_pcm_»cov”
(
hªdË
, frames, 0);

39 ià(
äames
 < 0) {

40 
	`´štf
("¢d_pcm_wr™e˜çed: %s\n", 
	`¢d_¡»¼Ü
(
äames
));

43 ià(
äames
 > 0 && f¿me < ()(
bufãr
))

44 
	`´štf
("ShÜˆwr™Óx³ùed %li, wrÙ%li)\n", ()(
bufãr
), 
äames
);

48 
”r
 = 
	`¢d_pcm_d¿š
(
hªdË
);

49 ià(
”r
 < 0)

50 
	`´štf
("¢d_pcm_d¿š faed: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

51 
	`¢d_pcm_şo£
(
hªdË
);

53 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/playmidi1.c

37 
	~"cÚfig.h
"

39 
	~<¡dio.h
>

40 
	~<ùy³.h
>

41 
	~<fú.h
>

42 
	~<¡dlib.h
>

43 
	~<sys/ioùl.h
>

44 
	~<uni¡d.h
>

45 
	~<”ºo.h
>

46 
	~<¡ršg.h
>

48 
	~"midife.h
"

49 
	~"midife.c
"

51 
	~"../šşude/asoundlib.h
"

54 
	gu£_»®time
 = 0;

57 
	gu£_blockšg_mode
 = 1;

60 
	#DEST_CLIENT_NUMBER
 65

	)

61 
	#DEST_PORT_NUMBER
 0

	)

64 
	#WRITE_POOL_SIZE
 200

	)

65 
	#WRITE_POOL_SPACE
 10

	)

66 
	#READ_POOL_SIZE
 10

	)

68 
FILE
 *
	gF
;

69 
¢d_£q_t
 *
	g£q_hªdË
 = 
NULL
;

70 
	gµq
 = 96;

71 
	g¦ave_µq
 = 96;

73 
	gloÿl_£cs
 = 0;

74 
	gloÿl_ticks
 = 0;

75 
	gloÿl_‹mpo
 = 500000;

77 
	gde¡_queue
 = -1;

78 
	gsh¬ed_queue
 = 0;

79 
	gtick_off£t
 = 0;

80 
	gde¡_ş›Á
 = 
DEST_CLIENT_NUMBER
;

81 
	gde¡_pÜt
 = 
DEST_PORT_NUMBER
;

82 
	gmy_pÜt
 = 0;

84 
	gv”bo£
 = 0;

85 
	g¦ave
 = 0;

87 
	#VERB_INFO
 1

	)

88 
	#VERB_MUCH
 2

	)

89 
	#VERB_EVENT
 3

	)

91 
®§_¡¬t_tim”
();

92 
®§_¡İ_tim”
();

93 
wa™_¡¬t
();

96 
šlše
 
	$tick2time_dbl
(
tick
)

98  
loÿl_£cs
 + ((è(
tick
 - 
loÿl_ticks
è* (è
loÿl_‹mpo
 * 1.0E-6 / (è
µq
);

99 
	}
}

101 
	$tick2time
(
¢d_£q_»®_time_t
 * 
tm
, 
tick
)

103 
£cs
 = 
	`tick2time_dbl
(
tick
);

104 
tm
->
tv_£c
 = 
£cs
;

105 
tm
->
tv_n£c
 = (
£cs
 -m->
tv_£c
) * 1.0E9;

106 
	}
}

108 
	$wr™e_ev
(
¢d_£q_ev’t_t
 *
ev
)

110 
rc
;

112 ià(
u£_blockšg_mode
) {

113 
rc
 = 
	`¢d_£q_ev’t_ouut
(
£q_hªdË
, 
ev
);

114 ià(
rc
 < 0) {

115 
	`´štf
("wr™‹Àğ%˜(%s)\n", 
rc
, 
	`¢d_¡»¼Ü
(rc));

116 
	`ex™
(1);

120 (
rc
 = 
	`¢d_£q_ev’t_ouut
(
£q_hªdË
, 
ev
)) < 0) {

121 
Åfds
 = 
	`¢d_£q_pŞl_desütÜs_couÁ
(
£q_hªdË
, 
POLLOUT
);

122 
pŞlfd
 *
pfds
 = 
	`®loÿ
((*pfdsè* 
Åfds
);

123 
	`¢d_£q_pŞl_desütÜs
(
£q_hªdË
, 
pfds
, 
Åfds
, 
POLLOUT
);

124 ià((
rc
 = 
	`pŞl
(
pfds
, 
Åfds
, -1)) < 0) {

125 
	`´štf
("pŞÈ”rÜ = %˜(%s)\n", 
rc
, 
	`¢d_¡»¼Ü
(
”ºo
));

126 
	`ex™
(1);

129 
	}
}

132 
	$myg‘c
()

134  
	`g‘c
(
F
);

135 
	}
}

138 
	$my‹xt
(
ty³
 
ATTRIBUTE_UNUSED
, 
Ëng
, *
msg
)

140 *
p
;

141 *
•
 = 
msg
 + 
Ëng
;

143 ià(
v”bo£
 >ğ
VERB_INFO
) {

144 
p
 = 
msg
;… < 
•
;…++)

145 
	`putch¬
(
	`i¥ršt
(*
p
) ? *p : '?');

146 
	`putch¬
('\n');

148 
	}
}

150 
	$do_h—d”
(
fÜm©
, 
Á¿cks
, 
divisiÚ
)

152 
¢d_£q_queue_‹mpo_t
 *
‹mpo
;

154 ià(
v”bo£
 >ğ
VERB_INFO
)

155 
	`´štf
("smàfÜm© %d, %d¿cks, %d…pq\n", 
fÜm©
, 
Á¿cks
, 
divisiÚ
);

156 
µq
 = 
divisiÚ
;

158 ià(
fÜm©
 !ğ0 || 
Á¿cks
 != 1) {

159 
	`´štf
("This…layer does‚ot support merging ofracks.\n");

160 ià(! 
sh¬ed_queue
)

161 
	`®§_¡İ_tim”
();

162 
	`ex™
(1);

165 
	`¢d_£q_queue_‹mpo_®loÿ
(&
‹mpo
);

167 ià(
	`¢d_£q_g‘_queue_‹mpo
(
£q_hªdË
, 
de¡_queue
, 
‹mpo
) < 0) {

168 
	`³¼Ü
("get_queue_tempo");

169 
	`ex™
(1);

171 ià((
¦ave_µq
 = 
	`¢d_£q_queue_‹mpo_g‘_µq
(
‹mpo
)è!ğ
µq
) {

172 
	`¢d_£q_queue_‹mpo_£t_µq
(
‹mpo
, 
µq
);

173 ià(
	`¢d_£q_£t_queue_‹mpo
(
£q_hªdË
, 
de¡_queue
, 
‹mpo
) < 0) {

174 
	`³¼Ü
("set_queue_tempo");

175 ià(!
¦ave
 && !
sh¬ed_queue
)

176 
	`ex™
(1);

178 
	`´štf
("difã»Á PPQ %d iÀSMF from queuPPQ %d\n", 
µq
, 
¦ave_µq
);

180 
¦ave_µq
 = 
µq
;

181 ià(
v”bo£
 >ğ
VERB_INFO
)

182 
	`´štf
("ALSA Tim” upd©ed, PPQ = %d\n", 
	`¢d_£q_queue_‹mpo_g‘_µq
(
‹mpo
));

186 ià(
¦ave
) {

187 ià(
v”bo£
 >ğ
VERB_INFO
)

188 
	`´štf
("Waitillimer starts...\n");

189 
	`wa™_¡¬t
();

190 ià(
v”bo£
 >ğ
VERB_INFO
)

191 
	`´štf
("Go!\n");

192 } ià(
sh¬ed_queue
) {

193 
¢d_£q_queue_¡©us_t
 *
¡©
;

194 
	`¢d_£q_queue_¡©us_®loÿ
(&
¡©
);

195 
	`¢d_£q_g‘_queue_¡©us
(
£q_hªdË
, 
de¡_queue
, 
¡©
);

196 
tick_off£t
 = 
	`¢d_£q_queue_¡©us_g‘_tick_time
(
¡©
);

197 
	`årštf
(
¡d”r
, "tick off£ˆğ%d\n", 
tick_off£t
);

199 
	`®§_¡¬t_tim”
();

200 
tick_off£t
 = 0;

202 
	}
}

205 
	$£t_ev’t_time
(
¢d_£q_ev’t_t
 *
ev
, 
cu¼time
)

207 ià(
u£_»®time
) {

208 
¢d_£q_»®_time_t
 
¹ime
;

209 ià(
µq
 !ğ
¦ave_µq
)

210 
cu¼time
 = (cu¼tim* 
¦ave_µq
è/ 
µq
;

211 
	`tick2time
(&
¹ime
, 
cu¼time
);

212 
	`¢d_£q_ev_scheduË_»®
(
ev
, 
de¡_queue
, 0, &
¹ime
);

214 ià(
µq
 !ğ
¦ave_µq
)

215 
cu¼time
 = (cu¼tim* 
¦ave_µq
è/ 
µq
;

216 
cu¼time
 +ğ
tick_off£t
;

217 
	`¢d_£q_ev_scheduË_tick
(
ev
, 
de¡_queue
, 0, 
cu¼time
);

219 
	}
}

222 
	$£t_ev’t_h—d”
(
¢d_£q_ev’t_t
 *
ev
)

224 
	`¢d_£q_ev_ş—r
(
ev
);

225 
	`¢d_£q_ev_£t_de¡
(
ev
, 
de¡_ş›Á
, 
de¡_pÜt
);

226 
	`¢d_£q_ev_£t_sourû
(
ev
, 
my_pÜt
);

227 
	`£t_ev’t_time
(
ev
, 
Mf_cu¼time
);

228 
	}
}

231 
	$®§_¡¬t_tim”
()

233 
	`¢d_£q_¡¬t_queue
(
£q_hªdË
, 
de¡_queue
, 
NULL
);

234 
	}
}

237 
	$®§_¡İ_tim”
()

239 
¢d_£q_ev’t_t
 
ev
;

240 
	`£t_ev’t_h—d”
(&
ev
);

241 
	`¢d_£q_¡İ_queue
(
£q_hªdË
, 
de¡_queue
, &
ev
);

242 
	}
}

245 
	$do_‹mpo
(
us
)

247 
¢d_£q_ev’t_t
 
ev
;

249 ià(
v”bo£
 >ğ
VERB_MUCH
) {

250 
bpm
;

251 
bpm
 = 60.0E6 / (è
us
;

252 
	`´štf
("TempØ%d us/b—t, %.2àbpm\n", 
us
, 
bpm
);

256 
loÿl_£cs
 = 
	`tick2time_dbl
(
Mf_cu¼time
);

257 
loÿl_ticks
 = 
Mf_cu¼time
;

258 
loÿl_‹mpo
 = 
us
;

260 
	`£t_ev’t_h—d”
(&
ev
);

261 ià(!
¦ave
)

262 
	`¢d_£q_chªge_queue_‹mpo
(
£q_hªdË
, 
de¡_queue
, 
us
, &
ev
);

263 
	}
}

265 
	$do_nÙeÚ
(
chª
, 
p™ch
, 
vŞ
)

267 
¢d_£q_ev’t_t
 
ev
;

269 ià(
v”bo£
 >ğ
VERB_EVENT
)

270 
	`´štf
("%lu: NÙeOÀ(%dè%d %d\n", 
Mf_cu¼time
, 
chª
, 
p™ch
, 
vŞ
);

271 
	`£t_ev’t_h—d”
(&
ev
);

272 
	`¢d_£q_ev_£t_nÙeÚ
(&
ev
, 
chª
, 
p™ch
, 
vŞ
);

273 
	`wr™e_ev
(&
ev
);

274 
	}
}

277 
	$do_nÙeoff
(
chª
, 
p™ch
, 
vŞ
)

279 
¢d_£q_ev’t_t
 
ev
;

281 ià(
v”bo£
 >ğ
VERB_EVENT
)

282 
	`´štf
("%lu: NÙeOfà(%dè%d %d\n", 
Mf_cu¼time
, 
chª
, 
p™ch
, 
vŞ
);

283 
	`£t_ev’t_h—d”
(&
ev
);

284 
	`¢d_£q_ev_£t_nÙeoff
(&
ev
, 
chª
, 
p™ch
, 
vŞ
);

285 
	`wr™e_ev
(&
ev
);

286 
	}
}

289 
	$do_´og¿m
(
chª
, 
´og¿m
)

291 
¢d_£q_ev’t_t
 
ev
;

293 ià(
v”bo£
 >ğ
VERB_EVENT
)

294 
	`´štf
("%lu: Prog¿m (%dè%d\n", 
Mf_cu¼time
, 
chª
, 
´og¿m
);

295 
	`£t_ev’t_h—d”
(&
ev
);

296 
	`¢d_£q_ev_£t_pgmchªge
(&
ev
, 
chª
, 
´og¿m
);

297 
	`wr™e_ev
(&
ev
);

298 
	}
}

301 
	$do_·¿m‘”
(
chª
, 
cÚŒŞ
, 
v®ue
)

303 
¢d_£q_ev’t_t
 
ev
;

305 ià(
v”bo£
 >ğ
VERB_EVENT
)

306 
	`´štf
("%lu: CÚŒŞ (%dè%d %d\n", 
Mf_cu¼time
, 
chª
, 
cÚŒŞ
, 
v®ue
);

307 
	`£t_ev’t_h—d”
(&
ev
);

308 
	`¢d_£q_ev_£t_cÚŒŞËr
(&
ev
, 
chª
, 
cÚŒŞ
, 
v®ue
);

309 
	`wr™e_ev
(&
ev
);

310 
	}
}

313 
	$do_p™chb’d
(
chª
, 
lsb
, 
msb
)

315 
¢d_£q_ev’t_t
 
ev
;

317 ià(
v”bo£
 >ğ
VERB_EVENT
)

318 
	`´štf
("%lu: P™chb’d (%dè%d %d\n", 
Mf_cu¼time
, 
chª
, 
lsb
, 
msb
);

319 
	`£t_ev’t_h—d”
(&
ev
);

320 
	`¢d_£q_ev_£t_p™chb’d
(&
ev
, 
chª
, (
lsb
 + (
msb
 << 7)) - 8192);

321 
	`wr™e_ev
(&
ev
);

322 
	}
}

324 
	$do_´essu»
(
chª
, 
p™ch
, 
´essu»
)

326 
¢d_£q_ev’t_t
 
ev
;

328 ià(
v”bo£
 >ğ
VERB_EVENT
)

329 
	`´štf
("%lu: KeyP»s (%dè%d %d\n", 
Mf_cu¼time
, 
chª
, 
p™ch
, 
´essu»
);

330 
	`£t_ev’t_h—d”
(&
ev
);

331 
	`¢d_£q_ev_£t_key´ess
(&
ev
, 
chª
, 
p™ch
, 
´essu»
);

332 
	`wr™e_ev
(&
ev
);

333 
	}
}

335 
	$do_chª´essu»
(
chª
, 
´essu»
)

337 
¢d_£q_ev’t_t
 
ev
;

339 ià(
v”bo£
 >ğ
VERB_EVENT
)

340 
	`´štf
("%lu: ChªP»s (%dè%d\n", 
Mf_cu¼time
, 
chª
, 
´essu»
);

341 
	`£t_ev’t_h—d”
(&
ev
);

342 
	`¢d_£q_ev_£t_chª´ess
(&
ev
, 
chª
, 
´essu»
);

343 
	`wr™e_ev
(&
ev
);

344 
	}
}

346 
	$do_sy£x
(
Ën
, *
msg
)

348 
¢d_£q_ev’t_t
 
ev
;

350 ià(
v”bo£
 >ğ
VERB_MUCH
) {

351 
c
;

352 
	`´štf
("%lu: Sy£x,†’=%d\n", 
Mf_cu¼time
, 
Ën
);

353 
c
 = 0; c < 
Ën
; c++) {

354 
	`´štf
(" %02x", ()
msg
[
c
]);

355 ià(
c
 % 16 == 15)

356 
	`putch¬
('\n');

358 ià(
c
 % 16 != 15)

359 
	`putch¬
('\n');

362 
	`£t_ev’t_h—d”
(&
ev
);

363 
	`¢d_£q_ev_£t_sy£x
(&
ev
, 
Ën
, 
msg
);

364 
	`wr™e_ev
(&
ev
);

365 
	}
}

367 
¢d_£q_ev’t_t
 *
	$wa™_fÜ_ev’t
()

369 
Ëá
;

370 
¢d_£q_ev’t_t
 *
šput_ev’t
;

372 ià(
u£_blockšg_mode
) {

374 
Ëá
 = 
	`¢d_£q_ev’t_šput
(
£q_hªdË
, &
šput_ev’t
);

377 (
Ëá
 = 
	`¢d_£q_ev’t_šput
(
£q_hªdË
, &
šput_ev’t
)) >= 0 &&

378 
šput_ev’t
 =ğ
NULL
) {

379 
Åfds
 = 
	`¢d_£q_pŞl_desütÜs_couÁ
(
£q_hªdË
, 
POLLIN
);

380 
pŞlfd
 *
pfds
 = 
	`®loÿ
((*pfdsè* 
Åfds
);

381 
	`¢d_£q_pŞl_desütÜs
(
£q_hªdË
, 
pfds
, 
Åfds
, 
POLLIN
);

382 ià((
Ëá
 = 
	`pŞl
(
pfds
, 
Åfds
, -1)) < 0) {

383 
	`´štf
("pŞÈ”rÜ = %˜(%s)\n", 
”ºo
, 
	`¢d_¡»¼Ü
(errno));

384 
	`ex™
(1);

389 ià(
Ëá
 < 0) {

390 
	`´štf
("®§_synø”rÜ!:%s\n", 
	`¢d_¡»¼Ü
(
Ëá
));

391  
NULL
;

394  
šput_ev’t
;

395 
	}
}

398 
	$®§_sync
()

401 ià(
v”bo£
 >ğ
VERB_MUCH
)

402 
	`´štf
("alsa_sync syncing...\n");

404 
	`¢d_£q_d¿š_ouut
(
£q_hªdË
);

405 
	`¢d_£q_sync_ouut_queue
(
£q_hªdË
);

406 ià(
v”bo£
 >ğ
VERB_MUCH
)

407 
	`´štf
("alsa_sync synced\n");

408 
	`¦“p
(1);

409 
	}
}

413 
	$wa™_¡¬t
()

415 
¢d_£q_ev’t_t
 *
šput_ev’t
;

419 
šput_ev’t
 = 
	`wa™_fÜ_ev’t
();

420 ià(
šput_ev’t
) {

421 ià(
v”bo£
 >ğ
VERB_MUCH
)

422 
	`´štf
("wait_start gotƒvent.ype=%d, flags=%d\n",

423 
šput_ev’t
->
ty³
, iÅut_ev’t->
æags
);

424 ià(
šput_ev’t
->
ty³
 =ğ
SND_SEQ_EVENT_START
 &&

425 
šput_ev’t
->
d©a
.
queue
.queu=ğ
de¡_queue
) {

426 
	`¢d_£q_ä“_ev’t
(
šput_ev’t
);

429 
	`¢d_£q_ä“_ev’t
(
šput_ev’t
);

432 ià(
v”bo£
 >ğ
VERB_MUCH
)

433 
	`´štf
("start„eceived\n");

434 
	}
}

438 
	$u§ge
()

440 
	`årštf
(
¡d”r
, "usage:…laymidi1 [options] [file]\n");

441 
	`årštf
(
¡d”r
, " options:\n");

442 
	`årštf
(
¡d”r
, " -v: verbose mode\n");

443 
	`årštf
(
¡d”r
, " -a client:port : set destination‡ddress (default=%d:%d)\n",

444 
DEST_CLIENT_NUMBER
, 
DEST_PORT_NUMBER
);

445 
	`årštf
(
¡d”r
, " -q queue: usehe specified queue\n");

446 
	`årštf
(
¡d”r
, " -s queue: slave mode (allowƒxternal clock synchronization)\n");

447 
	`årštf
(
¡d”r
, " -r :…lay on„eal-time mode\n");

448 
	`årštf
(
¡d”r
, " -b :…lay on‚on-blocking mode\n");

449 
	}
}

451 
	$maš
(
¬gc
, *
¬gv
[])

453 
tmp
;

454 
c
;

455 
¢d_£q_addr_t
 
de¡_addr
;

456 cÚ¡ *
addr
 = "65:0";

458 (
c
 = 
	`g‘İt
(
¬gc
, 
¬gv
, "s:a:p:q:vrb")) != -1) {

459 
c
) {

461 
v”bo£
++;

465 
addr
 = 
İrg
;

468 
de¡_queue
 = 
	`©oi
(
İrg
);

469 ià(
de¡_queue
 < 0) {

470 
	`årštf
(
¡d”r
, "šv®id queunumb” %d\n", 
de¡_queue
);

471 
	`ex™
(1);

475 
¦ave
 = 1;

476 
de¡_queue
 = 
	`©oi
(
İrg
);

477 ià(
de¡_queue
 < 0) {

478 
	`årštf
(
¡d”r
, "šv®id queunumb” %d\n", 
de¡_queue
);

479 
	`ex™
(1);

483 
u£_»®time
 = 1;

486 
u£_blockšg_mode
 = 0;

489 
	`u§ge
();

490 
	`ex™
(1);

494 ià(
v”bo£
 >ğ
VERB_INFO
) {

495 ià(
u£_»®time
)

496 
	`´štf
("ALSA MIDI Player, feedingƒventso„eal-time queue\n");

498 
	`´štf
("ALSA MIDI Player, feedingƒventso song queue\n");

503 
tmp
 = 
	`¢d_£q_İ’
(&
£q_hªdË
, "hw", 
¦ave
 ? 
SND_SEQ_OPEN_DUPLEX
 : 
SND_SEQ_OPEN_OUTPUT
, 0);

504 ià(
tmp
 < 0) {

505 
	`³¼Ü
("open /dev/snd/seq");

506 
	`ex™
(1);

509 
tmp
 = 
	`¢d_£q_nÚblock
(
£q_hªdË
, !
u£_blockšg_mode
);

510 ià(
tmp
 < 0) {

511 
	`³¼Ü
("block_mode");

512 
	`ex™
(1);

518 ià(
¦ave
)

519 
	`¢d_£q_£t_ş›Á_ev’t_f‹r
(
£q_hªdË
, 
SND_SEQ_EVENT_START
);

520 
	`¢d_£q_£t_ş›Á_Çme
(
£q_hªdË
, "MIDI file…layer");

523 
my_pÜt
 = 
	`¢d_£q_ü—‹_sim¶e_pÜt
(
£q_hªdË
, "Port 0",

524 
SND_SEQ_PORT_CAP_WRITE
 |

525 
SND_SEQ_PORT_CAP_READ
,

526 
SND_SEQ_PORT_TYPE_MIDI_GENERIC
);

527 ià(
my_pÜt
 < 0) {

528 
	`³¼Ü
("create…ort");

529 
	`ex™
(1);

532 ià(
	`¢d_£q_·r£_add»ss
(
£q_hªdË
, &
de¡_addr
, 
addr
) < 0) {

533 
	`³¼Ü
("invalid destination‡ddress");

534 
	`ex™
(1);

536 
de¡_ş›Á
 = 
de¡_addr
.
ş›Á
;

537 
de¡_pÜt
 = 
de¡_addr
.
pÜt
;

540 ià(
de¡_queue
 >= 0) {

541 
sh¬ed_queue
 = 1;

542 ià(
	`¢d_£q_£t_queue_u§ge
(
£q_hªdË
, 
de¡_queue
, 1) < 0) {

543 
	`³¼Ü
("use queue");

544 
	`ex™
(1);

547 
sh¬ed_queue
 = 0;

548 
de¡_queue
 = 
	`¢d_£q_®loc_queue
(
£q_hªdË
);

549 ià(
de¡_queue
 < 0) {

550 
	`³¼Ü
("alloc queue");

551 
	`ex™
(1);

556 
tmp
 = 
	`¢d_£q_cÚÃù_to
(
£q_hªdË
, 
my_pÜt
, 
de¡_ş›Á
, 
de¡_pÜt
);

557 ià(
tmp
 < 0) {

558 
	`³¼Ü
("subscribe");

559 
	`ex™
(1);

563 ià(
¦ave
) {

564 
tmp
 = 
	`¢d_£q_cÚÃù_äom
(
£q_hªdË
, 
my_pÜt
,

565 
SND_SEQ_CLIENT_SYSTEM
,

566 
de¡_queue
 + 16 );

567 ià(
tmp
 < 0) {

568 
	`³¼Ü
("subscribe");

569 
	`ex™
(1);

574 ià(
	`¢d_£q_£t_ş›Á_poŞ_ouut
(
£q_hªdË
, 
WRITE_POOL_SIZE
) < 0 ||

575 
	`¢d_£q_£t_ş›Á_poŞ_šput
(
£q_hªdË
, 
READ_POOL_SIZE
) < 0 ||

576 
	`¢d_£q_£t_ş›Á_poŞ_ouut_room
(
£q_hªdË
, 
WRITE_POOL_SPACE
) < 0) {

577 
	`³¼Ü
("pool");

578 
	`ex™
(1);

581 ià(
İtšd
 < 
¬gc
) {

582 
F
 = 
	`fİ’
(
¬gv
[
İtšd
], "r");

583 ià(
F
 =ğ
NULL
) {

584 
	`årštf
(
¡d”r
, "¶aymidi1: cª'ˆİ’ f%s\n", 
¬gv
[
İtšd
]);

585 
	`ex™
(1);

588 
F
 = 
¡dš
;

590 
Mf_h—d”
 = 
do_h—d”
;

591 
Mf_‹mpo
 = 
do_‹mpo
;

592 
Mf_g‘c
 = 
myg‘c
;

593 
Mf_‹xt
 = 
my‹xt
;

595 
Mf_nÙeÚ
 = 
do_nÙeÚ
;

596 
Mf_nÙeoff
 = 
do_nÙeoff
;

597 
Mf_´og¿m
 = 
do_´og¿m
;

598 
Mf_·¿m‘”
 = 
do_·¿m‘”
;

599 
Mf_p™chb’d
 = 
do_p™chb’d
;

600 
Mf_´essu»
 = 
do_´essu»
;

601 
Mf_chª´essu»
 = 
do_chª´essu»
;

602 
Mf_sy£x
 = 
do_sy£x
;

605 
	`mä—d
();

607 
	`®§_sync
();

608 ià(! 
sh¬ed_queue
)

609 
	`®§_¡İ_tim”
();

611 
	`¢d_£q_şo£
(
£q_hªdË
);

613 ià(
v”bo£
 >ğ
VERB_INFO
) {

614 
	`´štf
("Stopping‡t %f s,ick %f\n",

615 
	`tick2time_dbl
(
Mf_cu¼time
 + 1), () (Mf_currtime + 1));

618 
	`ex™
(0);

619 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/queue_timer.c

1 
	~<uni¡d.h
>

2 
	~<sys/time.h
>

3 
	~<®§/asoundlib.h
>

4 
	~<®§/£q.h
>

6 
	$nÜm®ize
(
timev®
 *
tv
)

8 ià(
tv
->
tv_£c
 == 0) {

9 
tv
->
tv_u£c
 <ğ-1000000è{v->tv_u£ø+ğ1000000; --tv->
tv_£c
; }

10 
tv
->
tv_u£c
 >ğ1000000è{v->tv_u£ø-ğ1000000; ++tv->
tv_£c
; }

11 } ià(
tv
->
tv_£c
 < 0) {

12 
tv
->
tv_u£c
 <ğ-1000000è{v->tv_u£ø+ğ1000000; --tv->
tv_£c
; }

13 
tv
->
tv_u£c
 > 0è{v->tv_u£ø-ğ1000000; ++tv->
tv_£c
; }

15 
tv
->
tv_u£c
 >ğ1000000è{v->tv_u£ø-ğ1000000; ++tv->
tv_£c
; }

16 
tv
->
tv_u£c
 < 0è{v->tv_u£ø+ğ1000000; --tv->
tv_£c
; }

18 
	}
}

21 
	$maš
(
¬gc
 
ATTRIBUTE_UNUSED
, **
¬gv
 ATTRIBUTE_UNUSED)

23 
¢d_£q_t
 *
hªdË
;

24 
pÜtid
;

28 
queue
;

32 
timev®
 
¡¬‰v
, 
´evdiff
;

33 
couÁdown
 = -1;

38 ià(
	`¢d_£q_İ’
(&
hªdË
, "hw", 
SND_SEQ_OPEN_DUPLEX
, 0) < 0) {

39 
	`årštf
(
¡d”r
, "failedo open ALSA sequencer interface\n");

43 
	`¢d_£q_£t_ş›Á_Çme
(
hªdË
, "generator");

45 ià((
pÜtid
 = 
¢d_£q_ü—‹_sim¶e_pÜt


46 (
hªdË
, "generator",

47 
SND_SEQ_PORT_CAP_READ
 | 
SND_SEQ_PORT_CAP_SUBS_READ
, 0)) < 0) {

48 
	`årštf
(
¡d”r
, "failedo create ALSA sequencer…ort\n");

52 ià((
queue
 = 
	`¢d_£q_®loc_queue
(
hªdË
)) < 0) {

53 
	`årštf
(
¡d”r
, "failedo create ALSA sequencer queue\n");

68 
	`¢d_£q_¡¬t_queue
(
hªdË
, 
queue
, 0);

69 
	`¢d_£q_d¿š_ouut
(
hªdË
);

71 
	`g‘timeofday
(&
¡¬‰v
, 0);

72 
´evdiff
.
tv_£c
 = 0;

73 
´evdiff
.
tv_u£c
 = 0;

75 
couÁdown
 != 0) {

77 
¢d_£q_queue_¡©us_t
 *
¡©us
;

78 cÚ¡ 
¢d_£q_»®_time_t
 *
¹ime
;

79 
timev®
 
tv
, 
diff
, 
diffdiff
;

80 
time¥ec
 
ts
;

82 
	`¢d_£q_queue_¡©us_®loÿ
(&
¡©us
);

84 
	`¢d_£q_g‘_queue_¡©us
(
hªdË
, 
queue
, 
¡©us
);

85 
¹ime
 = 
	`¢d_£q_queue_¡©us_g‘_»®_time
(
¡©us
);

87 
	`g‘timeofday
(&
tv
, 0);

89 
tv
.
tv_£c
 -ğ
¡¬‰v
.tv_sec;

90 
tv
.
tv_u£c
 -ğ
¡¬‰v
.tv_usec;

91 
	`nÜm®ize
(&
tv
);

93 
diff
.
tv_£c
 = 
tv
.tv_£ø- 
¹ime
->tv_sec;

94 
diff
.
tv_u£c
 = 
tv
.tv_u£ø- 
¹ime
->
tv_n£c
 / 1000;

95 
	`nÜm®ize
(&
diff
);

97 
diffdiff
.
tv_£c
 = 
diff
.tv_£ø- 
´evdiff
.tv_sec;

98 
diffdiff
.
tv_u£c
 = 
diff
.tv_u£ø- 
´evdiff
.tv_usec;

99 
	`nÜm®ize
(&
diffdiff
);

100 
´evdiff
 = 
diff
;

102 
	`årštf
(
¡d”r
, "„ealime: %12ld sec %8ld usec\nqueueime: %12ld sec %8ld usec\n diff: %12ld sec %8ld usec\n diffdiff: %12ld sec %8ld usec\n",

103 ()
tv
.
tv_£c
,v.
tv_u£c
,

104 ()
¹ime
->
tv_£c
, (ìtime->
tv_n£c
 / 1000,

105 ()
diff
.
tv_£c
, diff.
tv_u£c
,

106 ()
diffdiff
.
tv_£c
, ()diffdiff.
tv_u£c
);

108 ià(
diffdiff
.
tv_u£c
 > 5000 ||

109 
diffdiff
.
tv_u£c
 < -5000) {

110 
	`årštf
(
¡d”r
, "oops! queue slipped\n");

111 ià(
tv
.
tv_£c
 < 5) {

112 
	`årštf
(
¡d”r
, "(ignoring in first few seconds)\n");

114 
couÁdown
 = 2;

117 ià(
couÁdown
 > 0) --countdown;

120 
	`årštf
(
¡d”r
, "\n");

122 
ts
.
tv_£c
 = 0;

123 
ts
.
tv_n£c
 = 500000000;

124 
	`Çno¦“p
(&
ts
, 0);

126  
EXIT_SUCCESS
;

127 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/rawmidi.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<ùy³.h
>

4 
	~"../šşude/asoundlib.h
"

5 
	~<sigÇl.h
>

7 
	$u§ge
()

9 
	`årštf
(
¡d”r
, "usage:„awmidi [options]\n");

10 
	`årštf
(
¡d”r
, " options:\n");

11 
	`årštf
(
¡d”r
, " -v: verbose mode\n");

12 
	`årštf
(
¡d”r
, " -i device-id :est ALSA input device\n");

13 
	`årštf
(
¡d”r
, " -o device-id :est ALSA output device\n");

14 
	`årštf
(
¡d”r
, " -I‚ode :est input‚ode\n");

15 
	`årštf
(
¡d”r
, " -O‚ode :est output‚ode\n");

16 
	`årštf
(
¡d”r
, " -c clock : kernel clockype (0=none, 1=realtime, 2=monotonic, 3=monotonic„aw)\n");

17 
	`årštf
(
¡d”r
, " -t:est midihru\n");

18 
	`årštf
(
¡d”r
, "ƒxample:\n");

19 
	`årštf
(
¡d”r
, "„awmidi -i hw:0,0 -O /dev/midi1\n");

20 
	`årštf
(
¡d”r
, "ests input for card 0, device 0, using snd_rawmidi API\n");

21 
	`årštf
(
¡d”r
, "‡nd /dev/midi1 using file descriptors\n");

22 
	}
}

24 
	g¡İ
=0;

26 
	$sighªdËr
(
dum
)

28 
¡İ
=1;

29 
	}
}

31 
	$maš
(
¬gc
,** 
¬gv
)

33 
i
;

34 
”r
;

35 
thru
=0;

36 
v”bo£
 = 0;

37 *
deviû_š
 = 
NULL
;

38 *
deviû_out
 = 
NULL
;

39 *
node_š
 = 
NULL
;

40 *
node_out
 = 
NULL
;

41 
şock_ty³
 = -1;

43 
fd_š
 = -1,
fd_out
 = -1;

44 
¢d_¿wmidi_t
 *
hªdË_š
 = 0,*
hªdË_out
 = 0;

46 ià(
¬gc
==1) {

47 
	`u§ge
();

48 
	`ex™
(0);

51 
i
 = 1 ; i<
¬gc
 ; i++) {

52 ià(
¬gv
[
i
][0]=='-') {

53 
¬gv
[
i
][1]) {

55 
	`u§ge
();

58 
v”bo£
 = 1;

61 
thru
 = 1;

64 ià(
i
 + 1 < 
¬gc
)

65 
şock_ty³
 = 
	`©oi
(
¬gv
[++
i
]);

68 ià(
i
 + 1 < 
¬gc
)

69 
deviû_š
 = 
¬gv
[++
i
];

72 ià(
i
 + 1 < 
¬gc
)

73 
node_š
 = 
¬gv
[++
i
];

76 ià(
i
 + 1 < 
¬gc
)

77 
deviû_out
 = 
¬gv
[++
i
];

80 ià(
i
 + 1 < 
¬gc
)

81 
node_out
 = 
¬gv
[++
i
];

87 ià(
v”bo£
) {

88 
	`årštf
(
¡d”r
,"Using: \n");

89 
	`årštf
(
¡d”r
,"Input: ");

90 ià(
deviû_š
) {

91 
	`årštf
(
¡d”r
,"deviû %s\n",
deviû_š
);

92 }ià(
node_š
){

93 
	`årštf
(
¡d”r
,"%s\n",
node_š
);

95 
	`årštf
(
¡d”r
,"NONE\n");

97 
	`årštf
(
¡d”r
,"Output: ");

98 ià(
deviû_out
) {

99 
	`årštf
(
¡d”r
,"deviû %s\n",
deviû_out
);

100 }ià(
node_out
){

101 
	`årštf
(
¡d”r
,"%s\n",
node_out
);

103 
	`årštf
(
¡d”r
,"NONE\n");

107 ià(
deviû_š
) {

108 
”r
 = 
	`¢d_¿wmidi_İ’
(&
hªdË_š
,
NULL
,
deviû_š
,0);

109 ià(
”r
) {

110 
	`årštf
(
¡d”r
,"¢d_¿wmidi_İ’ % çed: %d\n",
deviû_š
,
”r
);

113 ià(
node_š
 && (!
node_out
 || 
	`¡rcmp
(node_out,node_in))) {

114 
fd_š
 = 
	`İ’
(
node_š
,
O_RDONLY
);

115 ià(
fd_š
<0) {

116 
	`årštf
(
¡d”r
,"İ’ % fÜ iÅuˆçed\n",
node_š
);

120 
	`sigÇl
(
SIGINT
,
sighªdËr
);

122 ià(
deviû_out
) {

123 
”r
 = 
	`¢d_¿wmidi_İ’
(
NULL
,&
hªdË_out
,
deviû_out
,0);

124 ià(
”r
) {

125 
	`årštf
(
¡d”r
,"¢d_¿wmidi_İ’ % çed: %d\n",
deviû_out
,
”r
);

128 ià(
node_out
 && (!
node_š
 || 
	`¡rcmp
(node_out,node_in))) {

129 
fd_out
 = 
	`İ’
(
node_out
,
O_WRONLY
);

130 ià(
fd_out
<0) {

131 
	`årštf
(
¡d”r
,"İ’ % fÜ ouuˆçed\n",
node_out
);

135 ià(
node_š
 && 
node_out
 && 
	`¡rcmp
(node_out,node_in)==0) {

136 
fd_š
 = 
fd_out
 = 
	`İ’
(
node_out
,
O_RDWR
);

137 ià(
fd_out
<0) {

138 
	`årštf
(
¡d”r
,"İ’ % fÜ iÅuˆªd ouuˆçed\n",
node_out
);

142 ià(!
thru
) {

143 ià(
hªdË_š
 || 
fd_š
!=-1) {

144 ià(
şock_ty³
 != -1) {

145 
¢d_¿wmidi_·¿ms_t
 *
·¿ms
;

146 
	`¢d_¿wmidi_·¿ms_m®loc
(&
·¿ms
);

147 ià(!
hªdË_š
) {

148 
	`årštf
(
¡d”r
, "-c only usable with -i");

149 
şock_ty³
 = -1;

151 ià(
şock_ty³
 != -1) {

152 
	`årštf
(
¡d”r
, "EÇbË k”ÃÈşocky³ %d\n", 
şock_ty³
);

153 
	`¢d_¿wmidi_·¿ms_cu¼’t
(
hªdË_š
, 
·¿ms
);

154 
”r
 = 
	`¢d_¿wmidi_·¿ms_£t_»ad_mode
(
hªdË_š
, 
·¿ms
, 
SND_RAWMIDI_READ_TSTAMP
);

155 ià(
”r
) {

156 
	`årštf
(
¡d”r
,"¢d_¿wmidi_·¿ms_£t_»ad_modçed: %d\n", 
”r
);

157 
şock_ty³
 = -1;

160 ià(
şock_ty³
 != -1) {

161 
”r
 = 
	`¢d_¿wmidi_·¿ms_£t_şock_ty³
(
hªdË_š
, 
·¿ms
, 
şock_ty³
);

162 ià(
”r
) {

163 
	`årštf
(
¡d”r
, "¢d_¿wmidi_·¿ms_£t_şock_ty³ faed: %d\n", 
”r
);

164 
şock_ty³
 = -1;

167 ià(
şock_ty³
 != -1) {

168 
”r
 = 
	`¢d_¿wmidi_·¿ms
(
hªdË_š
, 
·¿ms
);

169 ià(
”r
) {

170 
	`årštf
(
¡d”r
, "¢d_¿wmidi_·¿m çed: %d\n", 
”r
);

171 
şock_ty³
 = -1;

174 
	`¢d_¿wmidi_·¿ms_ä“
(
·¿ms
);

177 
	`årštf
(
¡d”r
,"Read midi in\n");

178 
	`årštf
(
¡d”r
,"Press ctrl-co stop\n");

181 ià(
hªdË_š
) {

182 
buf
[1024];

183 
ssize_t
 
»t
;

184 !
¡İ
) {

185 ià(
şock_ty³
 != -1) {

186 
time¥ec
 
t¡amp
;

187 
»t
 = 
	`¢d_¿wmidi_Œ—d
(
hªdË_š
, &
t¡amp
, 
buf
, (buf));

188 ià(
»t
 < 0)

189 
	`årštf
(
¡d”r
, "»adime¡am°”rÜ: %d - %s\n", ()
»t
, 
	`¢d_¡»¼Ü
(ret));

190 ià(
»t
 > 0 && 
v”bo£
) {

191 
	`årštf
(
¡d”r
, "»ad [%Îd:%09Îd]", ()
t¡amp
.
tv_£c
, (é¡amp.
tv_n£c
);

192 
i
 = 0; i < 
»t
; i++)

193 
	`årštf
(
¡d”r
, " %02x", 
buf
[
i
]);

194 
	`årštf
(
¡d”r
, "\n");

197 
»t
 = 
	`¢d_¿wmidi_»ad
(
hªdË_š
, 
buf
, (buf));

198 ià(
»t
 < 0)

199 
	`årštf
(
¡d”r
, "»adƒ¼Ü: %d - %s\n", ()
»t
, 
	`¢d_¡»¼Ü
(ret));

200 ià(
»t
 > 0 && 
v”bo£
)

201 
i
 = 0; i < 
»t
; i++)

202 
	`årštf
(
¡d”r
,"»ad %02x\n",
buf
[
i
]);

206 ià(
fd_š
!=-1) {

207 
ch
;

208 !
¡İ
) {

209 
	`»ad
(
fd_š
,&
ch
,1);

210 ià(
v”bo£
) {

211 
	`årštf
(
¡d”r
,"»ad %02x\n",
ch
);

216 ià(
hªdË_out
 || 
fd_out
!=-1) {

217 
	`årštf
(
¡d”r
,"Writing‚ote on /‚ote off\n");

220 ià(
hªdË_out
) {

221 
ch
;

222 
ch
=0x90; 
	`¢d_¿wmidi_wr™e
(
hªdË_out
,&ch,1);

223 
ch
=60; 
	`¢d_¿wmidi_wr™e
(
hªdË_out
,&ch,1);

224 
ch
=100; 
	`¢d_¿wmidi_wr™e
(
hªdË_out
,&ch,1);

225 
	`¢d_¿wmidi_d¿š
(
hªdË_out
);

226 
	`¦“p
(1);

227 
ch
=0x90; 
	`¢d_¿wmidi_wr™e
(
hªdË_out
,&ch,1);

228 
ch
=60; 
	`¢d_¿wmidi_wr™e
(
hªdË_out
,&ch,1);

229 
ch
=0; 
	`¢d_¿wmidi_wr™e
(
hªdË_out
,&ch,1);

230 
	`¢d_¿wmidi_d¿š
(
hªdË_out
);

232 ià(
fd_out
!=-1) {

233 
ch
;

234 
ch
=0x90; 
	`wr™e
(
fd_out
,&ch,1);

235 
ch
=60; 
	`wr™e
(
fd_out
,&ch,1);

236 
ch
=100; 
	`wr™e
(
fd_out
,&ch,1);

237 
	`¦“p
(1);

238 
ch
=0x90; 
	`wr™e
(
fd_out
,&ch,1);

239 
ch
=60; 
	`wr™e
(
fd_out
,&ch,1);

240 
ch
=0; 
	`wr™e
(
fd_out
,&ch,1);

243 ià((
hªdË_š
 || 
fd_š
!=-1è&& (
hªdË_out
 || 
fd_out
!=-1)) {

244 ià(
v”bo£
) {

245 
	`årštf
(
¡d”r
,"Testing midihru in\n");

247 !
¡İ
) {

248 
ch
;

250 ià(
hªdË_š
) {

251 
	`¢d_¿wmidi_»ad
(
hªdË_š
,&
ch
,1);

253 ià(
fd_š
!=-1) {

254 
	`»ad
(
fd_š
,&
ch
,1);

256 ià(
v”bo£
) {

257 
	`årštf
(
¡d”r
,"thru: %02x\n",
ch
);

260 ià(
hªdË_out
) {

261 
	`¢d_¿wmidi_wr™e
(
hªdË_out
,&
ch
,1);

262 
	`¢d_¿wmidi_d¿š
(
hªdË_out
);

264 ià(
fd_out
!=-1) {

265 
	`wr™e
(
fd_out
,&
ch
,1);

269 
	`årštf
(
¡d”r
,"Testing midihru‚eeds both input‡nd output\n");

270 
	`ex™
(-1);

274 ià(
v”bo£
) {

275 
	`årštf
(
¡d”r
,"Closing\n");

278 ià(
hªdË_š
) {

279 
	`¢d_¿wmidi_d¿š
(
hªdË_š
);

280 
	`¢d_¿wmidi_şo£
(
hªdË_š
);

282 ià(
hªdË_out
) {

283 
	`¢d_¿wmidi_d¿š
(
hªdË_out
);

284 
	`¢d_¿wmidi_şo£
(
hªdË_out
);

286 ià(
fd_š
!=-1) {

287 
	`şo£
(
fd_š
);

289 ià(
fd_out
!=-1) {

290 
	`şo£
(
fd_out
);

294 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/seq-decoder.c

5 *
	gev’t_Çmes
[256] = {

6 [
SND_SEQ_EVENT_SYSTEM
]= "System",

7 [
SND_SEQ_EVENT_RESULT
]= "Result",

8 [
SND_SEQ_EVENT_NOTE
]= "Note",

9 [
SND_SEQ_EVENT_NOTEON
]= "Note On",

10 [
SND_SEQ_EVENT_NOTEOFF
]= "Note Off",

11 [
SND_SEQ_EVENT_KEYPRESS
]= "Key Pressure",

12 [
SND_SEQ_EVENT_CONTROLLER
]= "Controller",

13 [
SND_SEQ_EVENT_PGMCHANGE
]= "Program Change",

14 [
SND_SEQ_EVENT_CHANPRESS
]= "Channel Pressure",

15 [
SND_SEQ_EVENT_PITCHBEND
]= "Pitchbend",

16 [
SND_SEQ_EVENT_CONTROL14
]= "Control14",

17 [
SND_SEQ_EVENT_NONREGPARAM
]= "Nonregparam",

18 [
SND_SEQ_EVENT_REGPARAM
]= "Regparam",

19 [
SND_SEQ_EVENT_SONGPOS
]= "Song Position",

20 [
SND_SEQ_EVENT_SONGSEL
]= "Song Select",

21 [
SND_SEQ_EVENT_QFRAME
]= "Qframe",

22 [
SND_SEQ_EVENT_TIMESIGN
]= "SMF Time Signature",

23 [
SND_SEQ_EVENT_KEYSIGN
]= "SMF Key Signature",

24 [
SND_SEQ_EVENT_START
]= "Start",

25 [
SND_SEQ_EVENT_CONTINUE
]= "Continue",

26 [
SND_SEQ_EVENT_STOP
]= "Stop",

27 [
SND_SEQ_EVENT_SETPOS_TICK
]= "Set Position Tick",

28 [
SND_SEQ_EVENT_SETPOS_TIME
]= "Set Position Time",

29 [
SND_SEQ_EVENT_TEMPO
]= "Tempo",

30 [
SND_SEQ_EVENT_CLOCK
]= "Clock",

31 [
SND_SEQ_EVENT_TICK
]= "Tick",

32 [
SND_SEQ_EVENT_TUNE_REQUEST
]= "Tune Request",

33 [
SND_SEQ_EVENT_RESET
]= "Reset",

34 [
SND_SEQ_EVENT_SENSING
]= "Active Sensing",

35 [
SND_SEQ_EVENT_ECHO
]= "Echo",

36 [
SND_SEQ_EVENT_OSS
]= "OSS",

37 [
SND_SEQ_EVENT_CLIENT_START
]= "Client Start",

38 [
SND_SEQ_EVENT_CLIENT_EXIT
]= "Client Exit",

39 [
SND_SEQ_EVENT_CLIENT_CHANGE
]= "Client Change",

40 [
SND_SEQ_EVENT_PORT_START
]= "Port Start",

41 [
SND_SEQ_EVENT_PORT_EXIT
]= "Port Exit",

42 [
SND_SEQ_EVENT_PORT_CHANGE
]= "Port Change",

43 [
SND_SEQ_EVENT_PORT_SUBSCRIBED
]= "Port Subscribed",

44 [
SND_SEQ_EVENT_PORT_UNSUBSCRIBED
]= "Port Unsubscribed",

46 [
SND_SEQ_EVENT_SAMPLE
]= "Sample",

47 [
SND_SEQ_EVENT_SAMPLE_CLUSTER
]= "Sample Cluster",

48 [
SND_SEQ_EVENT_SAMPLE_START
]= "Sample Start",

49 [
SND_SEQ_EVENT_SAMPLE_STOP
]= "Sample Stop",

50 [
SND_SEQ_EVENT_SAMPLE_FREQ
]= "Sample Freq",

51 [
SND_SEQ_EVENT_SAMPLE_VOLUME
]= "Sample Volume",

52 [
SND_SEQ_EVENT_SAMPLE_LOOP
]= "Sample Loop",

53 [
SND_SEQ_EVENT_SAMPLE_POSITION
]= "Sample Position",

54 [
SND_SEQ_EVENT_SAMPLE_PRIVATE1
]= "Sample Private1",

56 [
SND_SEQ_EVENT_USR0
]= "User 0",

57 [
SND_SEQ_EVENT_USR1
]= "User 1",

58 [
SND_SEQ_EVENT_USR2
]= "User 2",

59 [
SND_SEQ_EVENT_USR3
]= "User 3",

60 [
SND_SEQ_EVENT_USR4
]= "User 4",

61 [
SND_SEQ_EVENT_USR5
]= "User 5",

62 [
SND_SEQ_EVENT_USR6
]= "User 6",

63 [
SND_SEQ_EVENT_USR7
]= "User 7",

64 [
SND_SEQ_EVENT_USR8
]= "User 8",

65 [
SND_SEQ_EVENT_USR9
]= "User 9",

67 [
SND_SEQ_EVENT_INSTR_BEGIN
]= "Instr Begin",

68 [
SND_SEQ_EVENT_INSTR_END
]= "Instr End",

69 [
SND_SEQ_EVENT_INSTR_INFO
]= "Instr Info",

70 [
SND_SEQ_EVENT_INSTR_INFO_RESULT
]= "Instr Info Result",

71 [
SND_SEQ_EVENT_INSTR_FINFO
]= "Instr Font Info",

72 [
SND_SEQ_EVENT_INSTR_FINFO_RESULT
]= "Instr Font Info Result",

73 [
SND_SEQ_EVENT_INSTR_RESET
]= "Instr Reset",

74 [
SND_SEQ_EVENT_INSTR_STATUS
]= "Instr Status",

75 [
SND_SEQ_EVENT_INSTR_STATUS_RESULT
]= "Instr Status Result",

76 [
SND_SEQ_EVENT_INSTR_PUT
]= "Instr Put",

77 [
SND_SEQ_EVENT_INSTR_GET
]= "Instr Get",

78 [
SND_SEQ_EVENT_INSTR_GET_RESULT
]= "Instr Get Result",

79 [
SND_SEQ_EVENT_INSTR_FREE
]= "Instr Free",

80 [
SND_SEQ_EVENT_INSTR_LIST
]= "Instr List",

81 [
SND_SEQ_EVENT_INSTR_LIST_RESULT
]= "Instr List Result",

82 [
SND_SEQ_EVENT_INSTR_CLUSTER
]= "Instr Cluster",

83 [
SND_SEQ_EVENT_INSTR_CLUSTER_GET
]= "Instr Cluster Get",

84 [
SND_SEQ_EVENT_INSTR_CLUSTER_RESULT
]= "Instr Cluster Result",

85 [
SND_SEQ_EVENT_INSTR_CHANGE
]= "Instr Change",

87 [
SND_SEQ_EVENT_SYSEX
]= "Sysex",

88 [
SND_SEQ_EVENT_BOUNCE
]= "Bounce",

89 [
SND_SEQ_EVENT_USR_VAR0
]= "User Var0",

90 [
SND_SEQ_EVENT_USR_VAR1
]= "User Var1",

91 [
SND_SEQ_EVENT_USR_VAR2
]= "User Var2",

92 [
SND_SEQ_EVENT_USR_VAR3
]= "User Var3",

93 [
SND_SEQ_EVENT_USR_VAR4
]= "User Var4",

95 [
SND_SEQ_EVENT_IPCSHM
]= "IPC Shm",

96 [
SND_SEQ_EVENT_USR_VARIPC0
]= "User IPC0",

97 [
SND_SEQ_EVENT_USR_VARIPC1
]= "User IPC1",

98 [
SND_SEQ_EVENT_USR_VARIPC2
]= "User IPC2",

99 [
SND_SEQ_EVENT_USR_VARIPC3
]= "User IPC3",

100 [
SND_SEQ_EVENT_USR_VARIPC4
]= "User IPC4",

102 [
SND_SEQ_EVENT_NONE
]= "None",

105 
	$decode_ev’t
(
¢d_£q_ev’t_t
 * 
ev
)

107 *
¥aû
 = " ";

109 
	`´štf
("EVENT>>> Ty³ = %d, fÏg ğ0x%x", 
ev
->
ty³
,ƒv->
æags
);

110 
ev
->
æags
 & 
SND_SEQ_TIME_STAMP_MASK
) {

111 
SND_SEQ_TIME_STAMP_TICK
:

112 
	`´štf
(",ime = %dicks",

113 
ev
->
time
.
tick
);

115 
SND_SEQ_TIME_STAMP_REAL
:

116 
	`´štf
(",ime = %d.%09d",

117 ()
ev
->
time
.time.
tv_£c
,

118 ()
ev
->
time
.time.
tv_n£c
);

121 
	`´štf
("\n%sSource = %d.%d, dest = %d.%d, queue = %d\n",

122 
¥aû
,

123 
ev
->
sourû
.
ş›Á
,

124 
ev
->
sourû
.
pÜt
,

125 
ev
->
de¡
.
ş›Á
,

126 
ev
->
de¡
.
pÜt
,

127 
ev
->
queue
);

129 ià(
ev’t_Çmes
[
ev
->
ty³
])

130 
	`´štf
("%sEv’ˆğ%s", 
¥aû
, 
ev’t_Çmes
[
ev
->
ty³
]);

132 
	`´štf
("%sEv’ˆğRe£rved %d\n", 
¥aû
, 
ev
->
ty³
);

134 
ev
->
ty³
) {

135 
SND_SEQ_EVENT_NOTE
:

136 
	`´štf
("; ch=%d,‚ote=%d, velocity=%d, off_velocity=%d, duration=%d\n",

137 
ev
->
d©a
.
nÙe
.
chªÃl
,

138 
ev
->
d©a
.
nÙe
.note,

139 
ev
->
d©a
.
nÙe
.
v–oc™y
,

140 
ev
->
d©a
.
nÙe
.
off_v–oc™y
,

141 
ev
->
d©a
.
nÙe
.
du¿tiÚ
);

144 
SND_SEQ_EVENT_NOTEON
:

145 
SND_SEQ_EVENT_NOTEOFF
:

146 
SND_SEQ_EVENT_KEYPRESS
:

147 
	`´štf
("; ch=%d,‚ote=%d, velocity=%d\n",

148 
ev
->
d©a
.
nÙe
.
chªÃl
,

149 
ev
->
d©a
.
nÙe
.note,

150 
ev
->
d©a
.
nÙe
.
v–oc™y
);

153 
SND_SEQ_EVENT_CONTROLLER
:

154 
	`´štf
("; ch=%d,…aram=%i, value=%i\n",

155 
ev
->
d©a
.
cÚŒŞ
.
chªÃl
,

156 
ev
->
d©a
.
cÚŒŞ
.
·¿m
,

157 
ev
->
d©a
.
cÚŒŞ
.
v®ue
);

160 
SND_SEQ_EVENT_PGMCHANGE
:

161 
	`´štf
("; ch=%d,…rogram=%i\n",

162 
ev
->
d©a
.
cÚŒŞ
.
chªÃl
,

163 
ev
->
d©a
.
cÚŒŞ
.
v®ue
);

166 
SND_SEQ_EVENT_CHANPRESS
:

167 
SND_SEQ_EVENT_PITCHBEND
:

168 
	`´štf
("; ch=%d, value=%i\n",

169 
ev
->
d©a
.
cÚŒŞ
.
chªÃl
,

170 
ev
->
d©a
.
cÚŒŞ
.
v®ue
);

173 
SND_SEQ_EVENT_SYSEX
:

175 *
sy£x
 = (*è
ev
 + (
¢d_£q_ev’t_t
);

176 
c
;

178 
	`´štf
(";†’=%d [", 
ev
->
d©a
.
ext
.
Ën
);

180 
c
 = 0; c < 
ev
->
d©a
.
ext
.
Ën
; c++) {

181 
	`´štf
("%02x%s", 
sy£x
[
c
], c < 
ev
->
d©a
.
ext
.
Ën
 - 1 ? ":" : "");

183 
	`´štf
("]\n");

187 
SND_SEQ_EVENT_QFRAME
:

188 
	`´štf
("; f¿me=0x%02x\n", 
ev
->
d©a
.
cÚŒŞ
.
v®ue
);

191 
SND_SEQ_EVENT_CLOCK
:

192 
SND_SEQ_EVENT_START
:

193 
SND_SEQ_EVENT_CONTINUE
:

194 
SND_SEQ_EVENT_STOP
:

195 
	`´štf
("; queuğ%i\n", 
ev
->
d©a
.
queue
.queue);

198 
SND_SEQ_EVENT_SENSING
:

199 
	`´štf
("\n");

202 
SND_SEQ_EVENT_ECHO
:

204 
i
;

206 
	`´štf
("; ");

207 
i
 = 0; i < 8; i++) {

208 
	`´štf
("%02i%s", 
ev
->
d©a
.
¿w8
.
d
[
i
], i < 7 ? ":" : "\n");

213 
SND_SEQ_EVENT_CLIENT_START
:

214 
SND_SEQ_EVENT_CLIENT_EXIT
:

215 
SND_SEQ_EVENT_CLIENT_CHANGE
:

216 
	`´štf
("; cl›Á=%i\n", 
ev
->
d©a
.
addr
.
ş›Á
);

219 
SND_SEQ_EVENT_PORT_START
:

220 
SND_SEQ_EVENT_PORT_EXIT
:

221 
SND_SEQ_EVENT_PORT_CHANGE
:

222 
	`´štf
("; cl›Á=%i,…Üˆğ%i\n", 
ev
->
d©a
.
addr
.
ş›Á
,ƒv->d©a.addr.
pÜt
);

225 
SND_SEQ_EVENT_PORT_SUBSCRIBED
:

226 
SND_SEQ_EVENT_PORT_UNSUBSCRIBED
:

227 
	`´štf
("; %i:%i -> %i:%i\n",

228 
ev
->
d©a
.
cÚÃù
.
£nd”
.
ş›Á
,ƒv->d©a.cÚÃù.£nd”.
pÜt
,

229 
ev
->
d©a
.
cÚÃù
.
de¡
.
ş›Á
,ƒv->d©a.cÚÃù.de¡.
pÜt
);

233 
	`´štf
(";‚ot implemented\n");

237 
ev
->
æags
 & 
SND_SEQ_EVENT_LENGTH_MASK
) {

238 
SND_SEQ_EVENT_LENGTH_FIXED
:

239  (
¢d_£q_ev’t_t
);

241 
SND_SEQ_EVENT_LENGTH_VARIABLE
:

242  (
¢d_£q_ev’t_t
è+ 
ev
->
d©a
.
ext
.
Ën
;

246 
	}
}

248 
	$ev’t_decod”_¡¬t_tim”
(
¢d_£q_t
 *
hªdË
, 
queue
,

249 
ş›Á
 
ATTRIBUTE_UNUSED
,

250 
pÜt
 
ATTRIBUTE_UNUSED
)

252 
”r
;

254 ià((
”r
 = 
	`¢d_£q_¡¬t_queue
(
hªdË
, 
queue
, 
NULL
))<0)

255 
	`årštf
(
¡d”r
, "Tim”ƒv’ˆouuˆ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

256 
	`¢d_£q_d¿š_ouut
(
hªdË
)>0)

257 
	`¦“p
(1);

258 
	}
}

260 
	$ev’t_decod”
(
¢d_£q_t
 *
hªdË
, 
¬gc
, *
¬gv
[])

262 
¢d_£q_ev’t_t
 *
ev
;

263 
¢d_£q_pÜt_šfo_t
 *
pšfo
;

264 
¢d_£q_pÜt_subsüibe_t
 *
sub
;

265 
¢d_£q_addr_t
 
addr
;

266 
ş›Á
, 
pÜt
, 
queue
, 
max
, 
”r
, 
v1
, 
v2
;

267 *
±r
;

268 
pŞlfd
 *
pfds
;

270 ià((
ş›Á
 = 
	`¢d_£q_ş›Á_id
(
hªdË
))<0) {

271 
	`årštf
(
¡d”r
, "CªnÙ d‘”mšş›Á‚umb”: %s\n", 
	`¢d_¡»¼Ü
(
ş›Á
));

274 
	`´štf
("Cl›Á ID = %i\n", 
ş›Á
);

275 ià((
queue
 = 
	`¢d_£q_®loc_queue
(
hªdË
))<0) {

276 
	`årštf
(
¡d”r
, "CªnÙ‡Îoÿ‹ queue: %s\n", 
	`¢d_¡»¼Ü
(
queue
));

279 
	`´štf
("QueuID = %i\n", 
queue
);

280 ià((
”r
 = 
	`¢d_£q_nÚblock
(
hªdË
, 1))<0)

281 
	`årštf
(
¡d”r
, "CªnÙ s‘‚Úblock mode: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

282 
	`¢d_£q_pÜt_šfo_®loÿ
(&
pšfo
);

283 
	`¢d_£q_pÜt_šfo_£t_Çme
(
pšfo
, "Input");

284 
	`¢d_£q_pÜt_šfo_£t_ty³
(
pšfo
, 
SND_SEQ_PORT_TYPE_MIDI_GENERIC
);

285 
	`¢d_£q_pÜt_šfo_£t_ÿ·b™y
(
pšfo
, 
SND_SEQ_PORT_CAP_WRITE
 | 
SND_SEQ_PORT_CAP_READ
 | 
SND_SEQ_PORT_CAP_SUBS_WRITE
);

288 
	`¢d_£q_pÜt_šfo_£t_time¡ampšg
(
pšfo
, 1);

289 
	`¢d_£q_pÜt_šfo_£t_time¡amp_»®
(
pšfo
, 1);

290 
	`¢d_£q_pÜt_šfo_£t_time¡amp_queue
(
pšfo
, 
queue
);

292 ià((
”r
 = 
	`¢d_£q_ü—‹_pÜt
(
hªdË
, 
pšfo
)) < 0) {

293 
	`årštf
(
¡d”r
, "CªnÙ c»©špuˆpÜt: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

296 
pÜt
 = 
	`¢d_£q_pÜt_šfo_g‘_pÜt
(
pšfo
);

297 
	`ev’t_decod”_¡¬t_tim”
(
hªdË
, 
queue
, 
ş›Á
, 
pÜt
);

299 
	`¢d_£q_pÜt_subsüibe_®loÿ
(&
sub
);

300 
addr
.
ş›Á
 = 
SND_SEQ_CLIENT_SYSTEM
;

301 
addr
.
pÜt
 = 
SND_SEQ_PORT_SYSTEM_ANNOUNCE
;

302 
	`¢d_£q_pÜt_subsüibe_£t_£nd”
(
sub
, &
addr
);

303 
addr
.
ş›Á
 = client;

304 
addr
.
pÜt
 =…ort;

305 
	`¢d_£q_pÜt_subsüibe_£t_de¡
(
sub
, &
addr
);

306 
	`¢d_£q_pÜt_subsüibe_£t_queue
(
sub
, 
queue
);

307 
	`¢d_£q_pÜt_subsüibe_£t_time_upd©e
(
sub
, 1);

308 
	`¢d_£q_pÜt_subsüibe_£t_time_»®
(
sub
, 1);

309 ià((
”r
 = 
	`¢d_£q_subsüibe_pÜt
(
hªdË
, 
sub
))<0) {

310 
	`årštf
(
¡d”r
, "CªnÙ subsüibªnounû…Üt: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

314 
addr
.
ş›Á
 = 
SND_SEQ_CLIENT_SYSTEM
;

315 
addr
.
pÜt
 = 
SND_SEQ_PORT_SYSTEM_TIMER
;

316 
	`¢d_£q_pÜt_subsüibe_£t_£nd”
(
sub
, &
addr
);

317 ià((
”r
 = 
	`¢d_£q_subsüibe_pÜt
(
hªdË
, 
sub
))<0) {

318 
	`årštf
(
¡d”r
, "CªnÙ subsüibtim”…Üt: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

322 
max
 = 0; max < 
¬gc
; max++) {

323 
±r
 = 
¬gv
[
max
];

324 ià(!
±r
)

326 
	`¢d_£q_pÜt_subsüibe_£t_time_»®
(
sub
, 0);

327 ià(
	`tŞow”
(*
±r
) == 'r') {

328 
	`¢d_£q_pÜt_subsüibe_£t_time_»®
(
sub
, 1);

329 
±r
++;

331 ià(
	`ssÿnf
(
±r
, "%i.%i", &
v1
, &
v2
) != 2) {

332 
	`årštf
(
¡d”r
, "WrÚg‡rgum’ˆ'%s'...\n", 
¬gv
[
max
]);

335 
addr
.
ş›Á
 = 
v1
;

336 
addr
.
pÜt
 = 
v2
;

337 
	`¢d_£q_pÜt_subsüibe_£t_£nd”
(
sub
, &
addr
);

338 ià((
”r
 = 
	`¢d_£q_subsüibe_pÜt
(
hªdË
, 
sub
))<0) {

339 
	`årštf
(
¡d”r
, "CªnÙ subsüibpÜˆ%˜äom cl›Á %i: %s\n", 
v2
, 
v1
, 
	`¢d_¡»¼Ü
(
”r
));

344 
max
 = 
	`¢d_£q_pŞl_desütÜs_couÁ
(
hªdË
, 
POLLIN
);

345 
pfds
 = 
	`®loÿ
((*pfdsè* 
max
);

347 
	`¢d_£q_pŞl_desütÜs
(
hªdË
, 
pfds
, 
max
, 
POLLIN
);

348 ià(
	`pŞl
(
pfds
, 
max
, -1) < 0)

351 ià((
”r
 = 
	`¢d_£q_ev’t_šput
(
hªdË
, &
ev
))<0)

353 ià(!
ev
)

355 
	`decode_ev’t
(
ev
);

356 
	`¢d_£q_ä“_ev’t
(
ev
);

357 } 
”r
 > 0);

359 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/seq-sender.c

2 #ifdeà
USE_PCM


7 
	gpÿrd
 = 0;

8 
	gpdeviû
 = 0;

9 
	g³riod_size
 = 1024;

11 
	$£t_hw·¿ms
(
¢d_pcm_t
 *
phªdË
)

13 
”r
;

14 
¢d_pcm_hw_·¿ms_t
 *
·¿ms
;

16 
”r
 = 
	`¢d_ouut_¡dio_©ch
(&
log
, 
¡d”r
, 0);

17 ià(
”r
 < 0) {

18 
	`årštf
(
¡d”r
, "cannot‡ttach output stdio\n");

19 
	`ex™
(0);

22 
	`¢d_pcm_hw_·¿ms_®loÿ
(&
·¿ms
);

23 
”r
 = 
	`¢d_pcm_hw_·¿ms_ªy
(
phªdË
, 
·¿ms
);

24 ià(
”r
 < 0) {

25 
	`årštf
(
¡d”r
, "Broken configuration forhis PCM:‚o configurations‡vailable\n");

26 
	`ex™
(0);

29 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_acûss
(
phªdË
, 
·¿ms
,

30 
SND_PCM_ACCESS_RW_INTERLEAVED
);

31 ià(
”r
 < 0) {

32 
	`årštf
(
¡d”r
, "Accessype‚ot‡vailable\n");

33 
	`ex™
(0);

35 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_fÜm©
(
phªdË
, 
·¿ms
, 
SND_PCM_FORMAT_S16_LE
);

36 ià(
”r
 < 0) {

37 
	`årštf
(
¡d”r
, "cannot set format\n");

38 
	`ex™
(0);

40 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_chªÃls
(
phªdË
, 
·¿ms
, 2);

41 ià(
”r
 < 0) {

42 
	`årštf
(
¡d”r
, "cannot set channels 2\n");

43 
	`ex™
(0);

45 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_¿‹_Ã¬
(
phªdË
, 
·¿ms
, 44100, 0);

46 ià(
”r
 < 0) {

47 
	`årštf
(
¡d”r
, "cannot set„ate\n");

48 
	`ex™
(0);

50 
”r
 = 
	`¢d_pcm_hw_·¿ms_£t_³riod_size_Ã¬
(
phªdË
, 
·¿ms
, 
³riod_size
);

51 ià(
”r
 < 0) {

52 
	`årštf
(
¡d”r
, "cannot set…eriod size\n");

53 
	`ex™
(0);

55 
”r
 = 
	`¢d_pcm_hw_·¿ms
(
phªdË
, 
·¿ms
);

56 ià(
”r
 < 0) {

57 
	`årštf
(
¡d”r
, "Unableo install hw…arams:\n");

58 
	`ex™
(0);

60 
	`¢d_pcm_hw_·¿ms_dump
(
·¿ms
, 
log
);

61 
	}
}

68 
	$ev’t_£nd”_¡¬t_tim”
(
¢d_£q_t
 *
hªdË
,

69 
ş›Á
 
ATTRIBUTE_UNUSED
,

70 
queue
,

71 
¢d_pcm_t
 *
phªdË
 
ATTRIBUTE_UNUSED
)

73 
”r
;

75 #ifdeà
USE_PCM


76 ià(
phªdË
) {

77 
¢d_pcm_¶ayback_šfo_t
 
pšfo
;

78 
¢d_£q_queue_tim”_t
 
qtim”
;

80 ià((
”r
 = 
	`¢d_pcm_¶ayback_šfo
(
phªdË
, &
pšfo
)) < 0) {

81 
	`årštf
(
¡d”r
, "PÏyback infØ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

82 
	`ex™
(0);

84 
	`bz”o
(&
qtim”
, (qtimer));

85 
qtim”
.
ty³
 = 
SND_SEQ_TIMER_MASTER
;

88 
qtim”
.
numb”
 = 
	`SND_TIMER_PCM
(
pÿrd
, 
pdeviû
, 
pšfo
.
subdeviû
 << 1);

89 ià((
”r
 = 
	`¢d_£q_£t_queue_tim”
(
hªdË
, 
queue
, &
qtim”
)) < 0) {

90 
	`årštf
(
¡d”r
, "Sequ’û¸PCMim” s‘u°çed: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

91 
	`ex™
(0);

95 ià((
”r
 = 
	`¢d_£q_¡¬t_queue
(
hªdË
, 
queue
, 
NULL
))<0)

96 
	`årštf
(
¡d”r
, "Tim”ƒv’ˆouuˆ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

97 
	`¢d_£q_d¿š_ouut
(
hªdË
);

98 
	}
}

100 
	$ev’t_£nd”_f‹r
(
¢d_£q_t
 *
hªdË
)

102 
”r
;

104 ià((
”r
 = 
	`¢d_£q_£t_ş›Á_ev’t_f‹r
(
hªdË
, 
SND_SEQ_EVENT_ECHO
)) < 0) {

105 
	`årštf
(
¡d”r
, "UÇbËØ£ˆş›Á info: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

108 
	}
}

110 
	$£nd_ev’t
(
¢d_£q_t
 *
hªdË
, 
queue
, 
ş›Á
, 
pÜt
,

111 
¢d_£q_addr_t
 *
de¡
, *
time
)

113 
”r
;

114 
¢d_£q_ev’t_t
 
ev
;

116 
	`bz”o
(&
ev
, (ev));

117 
ev
.
queue
 = queue;

118 
ev
.
sourû
.
ş›Á
 =ƒv.
de¡
.client = client;

119 
ev
.
sourû
.
pÜt
 =ƒv.
de¡
.port =…ort;

120 
ev
.
æags
 = 
SND_SEQ_TIME_STAMP_REAL
 | 
SND_SEQ_TIME_MODE_ABS
;

121 
ev
.
time
.time.
tv_£c
 = *time; (*time)++;

122 
ev
.
ty³
 = 
SND_SEQ_EVENT_ECHO
;

123 ià((
”r
 = 
	`¢d_£q_ev’t_ouut
(
hªdË
, &
ev
))<0)

124 
	`årštf
(
¡d”r
, "Ev’ˆouuˆ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

125 
ev
.
de¡
 = *dest;

126 
ev
.
ty³
 = 
SND_SEQ_EVENT_PGMCHANGE
;

127 
ev
.
d©a
.
cÚŒŞ
.
chªÃl
 = 0;

128 
ev
.
d©a
.
cÚŒŞ
.
v®ue
 = 16;

129 ià((
”r
 = 
	`¢d_£q_ev’t_ouut
(
hªdË
, &
ev
))<0)

130 
	`årštf
(
¡d”r
, "Ev’ˆouuˆ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

131 
ev
.
ty³
 = 
SND_SEQ_EVENT_NOTE
;

132 
ev
.
d©a
.
nÙe
.
chªÃl
 = 0;

133 
ev
.
d©a
.
nÙe
.nÙğ64 + (
queue
*2);

134 
ev
.
d©a
.
nÙe
.
v–oc™y
 = 127;

135 
ev
.
d©a
.
nÙe
.
off_v–oc™y
 = 127;

136 
ev
.
d©a
.
nÙe
.
du¿tiÚ
 = 500;

137 ià((
”r
 = 
	`¢d_£q_ev’t_ouut
(
hªdË
, &
ev
))<0)

138 
	`årštf
(
¡d”r
, "Ev’ˆouuˆ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

139 ià((
”r
 = 
	`¢d_£q_d¿š_ouut
(
hªdË
))<0)

140 
	`årštf
(
¡d”r
, "Ev’ˆd¿šƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

141 
	}
}

143 
	$ev’t_£nd”
(
¢d_£q_t
 *
hªdË
, 
¬gc
, *
¬gv
[])

145 
¢d_£q_ev’t_t
 *
ev
;

146 
¢d_£q_pÜt_šfo_t
 *
pšfo
;

147 
¢d_£q_pÜt_subsüibe_t
 *
sub
;

148 
¢d_£q_addr_t
 
addr
;

149 
pŞlfd
 *
pfds
;

150 
ş›Á
, 
pÜt
, 
queue
, 
max
, 
”r
, 
v1
, 
v2
, 
time
 = 0, 
pcm_æag
 = 0;

151 *
±r
;

152 
¢d_pcm_t
 *
phªdË
 = 
NULL
;

154 ià(
¬gc
 < 1) {

155 
	`årštf
(
¡d”r
, "Invalid destination...\n");

159 ià((
ş›Á
 = 
	`¢d_£q_ş›Á_id
(
hªdË
))<0) {

160 
	`årštf
(
¡d”r
, "CªnÙ d‘”mšş›Á‚umb”: %s\n", 
	`¢d_¡»¼Ü
(
ş›Á
));

163 
	`´štf
("Cl›Á ID = %i\n", 
ş›Á
);

164 ià((
queue
 = 
	`¢d_£q_®loc_queue
(
hªdË
))<0) {

165 
	`årštf
(
¡d”r
, "CªnÙ‡Îoÿ‹ queue: %s\n", 
	`¢d_¡»¼Ü
(
queue
));

168 
	`´štf
("QueuID = %i\n", 
queue
);

169 
	`ev’t_£nd”_f‹r
(
hªdË
);

170 ià((
”r
 = 
	`¢d_£q_nÚblock
(
hªdË
, 1))<0)

171 
	`årštf
(
¡d”r
, "CªnÙ s‘‚Úblock mode: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

173 
	`¢d_£q_pÜt_šfo_®loÿ
(&
pšfo
);

174 
	`¢d_£q_pÜt_šfo_£t_ÿ·b™y
(
pšfo
, 
SND_SEQ_PORT_CAP_WRITE
 | 
SND_SEQ_PORT_CAP_READ
);

175 
	`¢d_£q_pÜt_šfo_£t_Çme
(
pšfo
, "Output");

176 ià((
”r
 = 
	`¢d_£q_ü—‹_pÜt
(
hªdË
, 
pšfo
)) < 0) {

177 
	`årštf
(
¡d”r
, "CªnÙ c»©ouuˆpÜt: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

180 
pÜt
 = 
	`¢d_£q_pÜt_šfo_g‘_pÜt
(
pšfo
);

182 
	`¢d_£q_pÜt_subsüibe_®loÿ
(&
sub
);

183 
addr
.
ş›Á
 = client;

184 
addr
.
pÜt
 =…ort;

185 
	`¢d_£q_pÜt_subsüibe_£t_£nd”
(
sub
, &
addr
);

187 
max
 = 0; max < 
¬gc
; max++) {

188 
±r
 = 
¬gv
[
max
];

189 ià(!
±r
)

191 ià(!
	`¡rcmp
(
±r
, "pcm")) {

192 
pcm_æag
 = 1;

195 ià(
	`ssÿnf
(
±r
, "%i.%i", &
v1
, &
v2
) != 2) {

196 
	`årštf
(
¡d”r
, "WrÚg‡rgum’ˆ'%s'...\n", 
¬gv
[
max
]);

199 
addr
.
ş›Á
 = 
v1
;

200 
addr
.
pÜt
 = 
v2
;

201 
	`¢d_£q_pÜt_subsüibe_£t_de¡
(
sub
, &
addr
);

202 ià((
”r
 = 
	`¢d_£q_subsüibe_pÜt
(
hªdË
, 
sub
))<0) {

203 
	`årštf
(
¡d”r
, "CªnÙ subsüibpÜˆ%˜äom cl›Á %i: %s\n", 
v2
, 
v1
, 
	`¢d_¡»¼Ü
(
”r
));

208 
	`´štf
("De¡š©iÚ cl›Á = %i,…Üˆğ%i\n", 
addr
.
ş›Á
,‡ddr.
pÜt
);

210 #ifdeà
USE_PCM


211 ià(
pcm_æag
) {

212 ià((
”r
 = 
	`¢d_pcm_İ’
(&
phªdË
, "deçuÉ", 
SND_PCM_STREAM_PLAYBACK
, 0)) < 0) {

213 
	`årštf
(
¡d”r
, "PÏyback o³À”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

214 
	`ex™
(0);

216 
	`£t_hw·¿ms
(
phªdË
);

217 
pbuf
 = 
	`ÿÎoc
(1, 
³riod_size
 * 4);

218 ià(
pbuf
 =ğ
NULL
) {

219 
	`årštf
(
¡d”r
, "Noƒnough memory...\n");

220 
	`ex™
(0);

224 
	`ev’t_£nd”_¡¬t_tim”
(
hªdË
, 
ş›Á
, 
queue
, 
phªdË
);

227 
	`£nd_ev’t
(
hªdË
, 
queue
, 
ş›Á
, 
pÜt
, &
addr
, &
time
);

228 #ifdeà
USE_PCM


229 ià(
phªdË
)

230 
max
 +ğ
	`¢d_pcm_pŞl_desütÜs_couÁ
(
phªdË
);

232 
pfds
 = 
	`®loÿ
((*pfdsè* 
max
);

234 
n£qs
 = 
	`¢d_£q_pŞl_desütÜs_couÁ
(
hªdË
, 
POLLOUT
|
POLLIN
);

235 ià(
	`¢d_£q_ev’t_ouut_³ndšg
(
hªdË
))

236 
	`¢d_£q_pŞl_desütÜs
(
hªdË
, 
pfds
, 
n£qs
, 
POLLOUT
|
POLLIN
);

238 
	`¢d_£q_pŞl_desütÜs
(
hªdË
, 
pfds
, 
n£qs
, 
POLLIN
);

239 
max
 = 
n£qs
;

240 #ifdeà
USE_PCM


241 ià(
phªdË
) {

242 
pmax
 = 
	`¢d_pcm_pŞl_desütÜs_couÁ
(
phªdË
);

243 
	`¢d_£q_pŞl_desütÜs
(
phªdË
, 
pfds
 + 
max
, 
pmax
);

244 
max
 +ğ
pmax
;

247 ià(
	`pŞl
(
pfds
, 
max
, -1) < 0)

249 #ifdeà
USE_PCM


250 ià(
phªdË
 && (
pfds
[
n£qs
].
»v’ts
 & 
POLLOUT
)) {

251 ià(
	`¢d_pcm_wr™ei
(
phªdË
, 
pbuf
, 
³riod_size
) !=…eriod_size) {

252 
	`årštf
(
¡d”r
, "Playback writeƒrror!!\n");

253 
	`ex™
(0);

257 ià(
pfds
[0].
»v’ts
 & 
POLLOUT
)

258 
	`¢d_£q_d¿š_ouut
(
hªdË
);

259 ià(
pfds
[0].
»v’ts
 & 
POLLIN
) {

261 ià((
”r
 = 
	`¢d_£q_ev’t_šput
(
hªdË
, &
ev
))<0)

263 ià(!
ev
)

265 ià(
ev
->
ty³
 =ğ
SND_SEQ_EVENT_ECHO
)

266 
	`£nd_ev’t
(
hªdË
, 
queue
, 
ş›Á
, 
pÜt
, &
addr
, &
time
);

267 
	`decode_ev’t
(
ev
);

268 
	`¢d_£q_ä“_ev’t
(
ev
);

269 } 
”r
 > 0);

272 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/seq.c

1 
	~"cÚfig.h
"

3 
	~<¡dio.h
>

4 
	~<¡dlib.h
>

5 
	~<¡ršg.h
>

6 
	~<”ºo.h
>

7 
	~<ùy³.h
>

8 
	~<g‘İt.h
>

9 
	~"../šşude/asoundlib.h
"

11 
	~"£q-decod”.c
"

12 
	~"£q-£nd”.c
"

14 
	#SEQ_VERSION
 "0.0.1"

	)

16 
	#HELPID_HELP
 1000

	)

17 
	#HELPID_DEBUG
 1001

	)

18 
	#HELPID_VERBOSE
 1002

	)

19 
	#HELPID_VERSION
 1003

	)

21 
	gmax_ş›Ás
;

22 
	gmax_pÜts
;

23 
	gmax_queues
;

24 
	gdebug
 = 0;

25 
	gv”bo£
 = 0;

27 
	$£t_Çme
(
¢d_£q_t
 *
hªdË
)

29 
”r
;

30 
Çme
[64];

32 
	`¥rštf
(
Çme
, "SeqUt - %i", 
	`g‘pid
());

33 ià((
”r
 = 
	`¢d_£q_£t_ş›Á_Çme
(
hªdË
, 
Çme
)) < 0) {

34 
	`årštf
(
¡d”r
, "S‘ cl›Á infØ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

35 
	`ex™
(0);

37 
	}
}

39 
	$sy¡em_šfo
(
¢d_£q_t
 *
hªdË
)

41 
”r
;

42 
¢d_£q_sy¡em_šfo_t
 *
sysšfo
;

44 
	`¢d_£q_sy¡em_šfo_®loÿ
(&
sysšfo
);

45 ià((
”r
 = 
	`¢d_£q_sy¡em_šfo
(
hªdË
, 
sysšfo
))<0) {

46 
	`årštf
(
¡d”r
, "Sy¡em infØ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

47 
	`ex™
(0);

49 
max_ş›Ás
 = 
	`¢d_£q_sy¡em_šfo_g‘_ş›Ás
(
sysšfo
);

50 
max_pÜts
 = 
	`¢d_£q_sy¡em_šfo_g‘_pÜts
(
sysšfo
);

51 
max_queues
 = 
	`¢d_£q_sy¡em_šfo_g‘_pÜts
(
sysšfo
);

52 
	}
}

54 
	$show_sy¡em_šfo
(
¢d_£q_t
 *
hªdË
 
ATTRIBUTE_UNUSED
)

56 
	`´štf
("System info\n");

57 
	`´štf
(" Max queue  : %i\n", 
max_queues
);

58 
	`´štf
(" Max cl›Á  : %i\n", 
max_ş›Ás
);

59 
	`´štf
(" Max…Üt  : %i\n", 
max_pÜts
);

60 
	}
}

62 
	$show_queue_¡©us
(
¢d_£q_t
 *
hªdË
, 
queue
)

64 
”r
, 
idx
, 
mš
, 
max
;

65 
¢d_£q_queue_¡©us_t
 *
¡©us
;

67 
	`¢d_£q_queue_¡©us_®loÿ
(&
¡©us
);

68 
mš
 = 
queue
 < 0 ? 0 : queue;

69 
max
 = 
queue
 < 0 ? 
max_queues
 : queue + 1;

70 
idx
 = 
mš
; idx < 
max
; idx++) {

71 ià((
”r
 = 
	`¢d_£q_g‘_queue_¡©us
(
hªdË
, 
idx
, 
¡©us
))<0) {

72 ià(
”r
 =ğ-
ENOENT
)

74 
	`årštf
(
¡d”r
, "Cl›Á %˜šfØ”rÜ: %s\n", 
idx
, 
	`¢d_¡»¼Ü
(
”r
));

75 
	`ex™
(0);

77 
	`´štf
("Queu%˜šfo\n", 
	`¢d_£q_queue_¡©us_g‘_queue
(
¡©us
));

78 
	`´štf
(" Tick : %u\n", 
	`¢d_£q_queue_¡©us_g‘_tick_time
(
¡©us
));

79 
	`´štf
(" Realtime : %i.%i\n",

80 
	`¢d_£q_queue_¡©us_g‘_»®_time
(
¡©us
)->
tv_£c
,

81 
	`¢d_£q_queue_¡©us_g‘_»®_time
(
¡©us
)->
tv_n£c
);

82 
	`´štf
(" FÏg  : 0x%x\n", 
	`¢d_£q_queue_¡©us_g‘_¡©us
(
¡©us
));

84 
	}
}

86 
	$show_pÜt_šfo
(
¢d_£q_t
 *
hªdË
, 
ş›Á
, 
pÜt
)

88 
”r
, 
idx
, 
mš
, 
max
;

89 
¢d_£q_pÜt_šfo_t
 *
šfo
;

91 
	`¢d_£q_pÜt_šfo_®loÿ
(&
šfo
);

92 
mš
 = 
pÜt
 < 0 ? 0 :…ort;

93 
max
 = 
pÜt
 < 0 ? 
max_pÜts
 :…ort + 1;

94 
idx
 = 
mš
; idx < 
max
; idx++) {

95 ià((
”r
 = 
	`¢d_£q_g‘_ªy_pÜt_šfo
(
hªdË
, 
ş›Á
, 
idx
, 
šfo
))<0) {

96 ià(
”r
 =ğ-
ENOENT
)

98 
	`årštf
(
¡d”r
, "PÜˆ%i/%˜šfØ”rÜ: %s\n", 
ş›Á
, 
idx
, 
	`¢d_¡»¼Ü
(
”r
));

99 
	`ex™
(0);

101 
	`´štf
(" PÜˆ%˜šfo\n", 
idx
);

102 
	`´štf
(" Cl›Á : %i\n", 
	`¢d_£q_pÜt_šfo_g‘_ş›Á
(
šfo
));

103 
	`´štf
(" PÜˆ : %i\n", 
	`¢d_£q_pÜt_šfo_g‘_pÜt
(
šfo
));

104 
	`´štf
(" Nam : %s\n", 
	`¢d_£q_pÜt_šfo_g‘_Çme
(
šfo
));

105 
	`´štf
(" C­ab™y : 0x%x\n", 
	`¢d_£q_pÜt_šfo_g‘_ÿ·b™y
(
šfo
));

106 
	`´štf
(" Ty³ : 0x%x\n", 
	`¢d_£q_pÜt_šfo_g‘_ty³
(
šfo
));

109 
	`´štf
(" Ouuˆsub  : %i\n", 
	`¢d_£q_pÜt_šfo_g‘_wr™e_u£
(
šfo
));

110 
	`´štf
(" IÅuˆsub  : %i\n", 
	`¢d_£q_pÜt_šfo_g‘_»ad_u£
(
šfo
));

112 
	}
}

114 
	$show_ş›Á_šfo
(
¢d_£q_t
 *
hªdË
, 
ş›Á
)

116 
”r
, 
idx
, 
mš
, 
max
;

117 
¢d_£q_ş›Á_šfo_t
 *
šfo
;

119 
	`¢d_£q_ş›Á_šfo_®loÿ
(&
šfo
);

120 
mš
 = 
ş›Á
 < 0 ? 0 : client;

121 
max
 = 
ş›Á
 < 0 ? 
max_ş›Ás
 : client + 1;

122 
idx
 = 
mš
; idx < 
max
; idx++) {

123 ià((
”r
 = 
	`¢d_£q_g‘_ªy_ş›Á_šfo
(
hªdË
, 
idx
, 
šfo
))<0) {

124 ià(
”r
 =ğ-
ENOENT
)

126 
	`årštf
(
¡d”r
, "Cl›Á %˜šfØ”rÜ: %s\n", 
idx
, 
	`¢d_¡»¼Ü
(
”r
));

127 
	`ex™
(0);

129 
	`´štf
("Cl›Á %˜šfo\n", 
idx
);

130 ià(
v”bo£
)

131 
	`´štf
(" Cl›Á : %i\n", 
	`¢d_£q_ş›Á_šfo_g‘_ş›Á
(
šfo
));

132 
	`´štf
(" Ty³ : %s\n", 
	`¢d_£q_ş›Á_šfo_g‘_ty³
(
šfo
è=ğ
SND_SEQ_KERNEL_CLIENT
 ? "kernel" : "user");

133 
	`´štf
(" Nam : %s\n", 
	`¢d_£q_ş›Á_šfo_g‘_Çme
(
šfo
));

135 
	}
}

137 
	$h–p
()

139 
	`´štf
("Usage: seq <options> command\n");

140 
	`´štf
("\nAvailable options:\n");

141 
	`´štf
(" -h,--helphis help\n");

142 
	`´štf
(" -d,--debug debug mode\n");

143 
	`´štf
(" -v,--verbose verbose mode\n");

144 
	`´štf
(" -V,--version…rint version ofhis…rogram\n");

145 
	`´štf
("\nAvailable commands:\n");

146 
	`´štf
(" system show basic sequencer info\n");

147 
	`´štf
(" queue [#] show‡ll queues or specified queue\n");

148 
	`´štf
(" client [#] show‡ll clients or specified client\n");

149 
	`´štf
("…ort <client> [#] show‡ll…orts or specified…ort for specified client\n");

150 
	`´štf
(" decoderƒvent decoder\n");

151 
	`´štf
(" sender <client.port> [<client.port>] ...ƒvent sender\n");

152 
	}
}

154 
	$maš
(
¬gc
, *
¬gv
[])

156 
mÜeh–p
, 
”r
, 
¬g
, 
¬g1
;

157 
¢d_£q_t
 *
hªdË
;

158 
İtiÚ
 
lÚg_İtiÚ
[] =

160 {"h–p", 0, 
NULL
, 
HELPID_HELP
},

161 {"debug", 0, 
NULL
, 
HELPID_DEBUG
},

162 {"v”bo£", 0, 
NULL
, 
HELPID_VERBOSE
},

163 {"v”siÚ", 0, 
NULL
, 
HELPID_VERSION
},

164 {
NULL
, 0, NULL, 0},

167 
mÜeh–p
 = 0;

170 
c
;

172 ià((
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hdvV", 
lÚg_İtiÚ
, 
NULL
)) < 0)

174 
c
) {

176 
HELPID_HELP
:

177 
mÜeh–p
++;

180 
HELPID_DEBUG
:

181 
debug
 = 1;

184 
HELPID_VERBOSE
:

185 
v”bo£
 = 1;

188 
HELPID_VERSION
:

189 
	`´štf
("®§ùÈv”siÚ " 
SEQ_VERSION
 "\n");

192 
	`årštf
(
¡d”r
, "\07Invalid switch or option‚eeds‡n‡rgument.\n");

193 
mÜeh–p
++;

196 ià(
mÜeh–p
) {

197 
	`h–p
();

200 ià(
¬gc
 - 
İtšd
 <= 0) {

201 
	`årštf
(
¡d”r
, "seq: Specify command...\n");

204 ià((
”r
 = 
	`¢d_£q_İ’
(&
hªdË
, "hw", 
SND_SEQ_OPEN_DUPLEX
, 0))<0) {

205 
	`årštf
(
¡d”r
, "O³À”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

206 
	`ex™
(0);

208 
	`£t_Çme
(
hªdË
);

209 
	`sy¡em_šfo
(
hªdË
);

211 ià(!
	`¡rcmp
(
¬gv
[
İtšd
], "system")) {

212 
	`show_sy¡em_šfo
(
hªdË
);

213 } ià(!
	`¡rcmp
(
¬gv
[
İtšd
], "queue")) {

214 
¬g
 = 
¬gc
 - 
İtšd
 > 1 ? 
	`©oi
(
¬gv
[optind + 1]) : -1;

215 
	`show_queue_¡©us
(
hªdË
, 
¬g
);

216 } ià(!
	`¡rcmp
(
¬gv
[
İtšd
], "client")) {

217 
¬g
 = 
¬gc
 - 
İtšd
 > 1 ? 
	`©oi
(
¬gv
[optind + 1]) : -1;

218 
	`show_ş›Á_šfo
(
hªdË
, 
¬g
);

219 } ià(!
	`¡rcmp
(
¬gv
[
İtšd
], "port")) {

220 
¬g
 = 
¬gc
 - 
İtšd
 > 1 ? 
	`©oi
(
¬gv
[optind + 1]) : -1;

221 ià(
¬g
 < 0) {

222 
	`årštf
(
¡d”r
, "Specify…ort...\n");

223 
	`ex™
(0);

225 
¬g1
 = 
¬gc
 - 
İtšd
 > 2 ? 
	`©oi
(
¬gv
[optind + 2]) : -1;

226 
	`show_pÜt_šfo
(
hªdË
, 
¬g
, 
¬g1
);

227 } ià(!
	`¡rcmp
(
¬gv
[
İtšd
], "decoder")) {

228 
	`ev’t_decod”
(
hªdË
, 
¬gc
 - 
İtšd
 - 1, 
¬gv
 + optind + 1);

229 } ià(!
	`¡rcmp
(
¬gv
[
İtšd
], "sender")) {

230 
	`ev’t_£nd”
(
hªdË
, 
¬gc
 - 
İtšd
 - 1, 
¬gv
 + optind + 1);

232 
	`h–p
();

234 
	`ex™
(1);

235 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/timer.c

1 
	~"cÚfig.h
"

2 
	~<¡dio.h
>

3 
	~<¡dlib.h
>

4 
	~<¡ršg.h
>

5 
	~<sys/time.h
>

6 
	~"../šşude/asoundlib.h
"

8 
	$show_¡©us
(*
hªdË
)

10 
”r
;

11 
¢d_tim”_¡©us_t
 *
¡©us
;

13 
	`¢d_tim”_¡©us_®loÿ
(&
¡©us
);

14 ià((
”r
 = 
	`¢d_tim”_¡©us
(
hªdË
, 
¡©us
)) < 0) {

15 
	`årštf
(
¡d”r
, "tim” stu %˜(%s)\n", 
”r
, 
	`¢d_¡»¼Ü
(err));

18 
	`´štf
("STATUS:\n");

19 
	`´štf
("„esŞutiÚ = %li\n", 
	`¢d_tim”_¡©us_g‘_»sŞutiÚ
(
¡©us
));

20 
	`´štf
("†o¡ = %li\n", 
	`¢d_tim”_¡©us_g‘_lo¡
(
¡©us
));

21 
	`´štf
(" ov”ruÀğ%li\n", 
	`¢d_tim”_¡©us_g‘_ov”run
(
¡©us
));

22 
	`´štf
(" queuğ%li\n", 
	`¢d_tim”_¡©us_g‘_queue
(
¡©us
));

23 
	}
}

25 
	$»ad_loİ
(*
hªdË
, 
ma¡”_ticks
, 
timeout
)

27 
couÁ
, 
”r
;

28 
pŞlfd
 *
fds
;

29 
¢d_tim”_»ad_t
 
Œ
;

31 
couÁ
 = 
	`¢d_tim”_pŞl_desütÜs_couÁ
(
hªdË
);

32 
fds
 = 
	`ÿÎoc
(
couÁ
, (
pŞlfd
));

33 ià(
fds
 =ğ
NULL
) {

34 
	`årštf
(
¡d”r
, "mallocƒrror\n");

35 
	`ex™
(
EXIT_FAILURE
);

37 
ma¡”_ticks
-- > 0) {

38 ià((
”r
 = 
	`¢d_tim”_pŞl_desütÜs
(
hªdË
, 
fds
, 
couÁ
)) < 0) {

39 
	`årštf
(
¡d”r
, "¢d_tim”_pŞl_desütÜ ”rÜ: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

40 
	`ex™
(
EXIT_FAILURE
);

42 ià((
”r
 = 
	`pŞl
(
fds
, 
couÁ
, 
timeout
)) < 0) {

43 
	`årštf
(
¡d”r
, "pŞÈ”rÜ %˜(%s)\n", 
”r
, 
	`¡»¼Ü
(err));

44 
	`ex™
(
EXIT_FAILURE
);

46 ià(
”r
 == 0) {

47 
	`årštf
(
¡d”r
, "timerime out!!\n");

48 
	`ex™
(
EXIT_FAILURE
);

50 
	`¢d_tim”_»ad
(
hªdË
, &
Œ
, (tr)) == (tr)) {

51 
	`´štf
("TIMER:„esolution = %uns,icks = %u\n",

52 
Œ
.
»sŞutiÚ
,r.
ticks
);

55 
	`ä“
(
fds
);

56 
	}
}

58 
	$async_ÿÎback
(
¢d_async_hªdËr_t
 *
ahªdËr
)

60 
¢d_tim”_t
 *
hªdË
 = 
	`¢d_async_hªdËr_g‘_tim”
(
ahªdËr
);

61 *
acouÁ
 = 
	`¢d_async_hªdËr_g‘_ÿÎback_´iv©e
(
ahªdËr
);

62 
¢d_tim”_»ad_t
 
Œ
;

64 
	`¢d_tim”_»ad
(
hªdË
, &
Œ
, (tr)) == (tr)) {

65 
	`´štf
("TIMER:„esolution = %uns,icks = %u\n",

66 
Œ
.
»sŞutiÚ
,r.
ticks
);

68 (*
acouÁ
)++;

69 
	}
}

71 
	$maš
(
¬gc
, *
¬gv
[])

73 
idx
, 
”r
;

74 
şass
 = 
SND_TIMER_CLASS_GLOBAL
;

75 
sşass
 = 
SND_TIMER_CLASS_NONE
;

76 
ÿrd
 = 0;

77 
deviû
 = 
SND_TIMER_GLOBAL_SYSTEM
;

78 
subdeviû
 = 0;

79 
li¡
 = 0;

80 
async
 = 0;

81 
acouÁ
 = 0;

82 
¢d_tim”_t
 *
hªdË
;

83 
¢d_tim”_id_t
 *
id
;

84 
¢d_tim”_šfo_t
 *
šfo
;

85 
¢d_tim”_·¿ms_t
 *
·¿ms
;

86 
tim”Çme
[64];

87 
¢d_async_hªdËr_t
 *
ahªdËr
;

89 
	`¢d_tim”_id_®loÿ
(&
id
);

90 
	`¢d_tim”_šfo_®loÿ
(&
šfo
);

91 
	`¢d_tim”_·¿ms_®loÿ
(&
·¿ms
);

93 
idx
 = 1;

94 
idx
 < 
¬gc
) {

95 ià(!
	`¡ºcmp
(
¬gv
[
idx
], "class=", 5)) {

96 
şass
 = 
	`©oi
(
¬gv
[
idx
]+6);

97 } ià(!
	`¡ºcmp
(
¬gv
[
idx
], "sclass=", 6)) {

98 
sşass
 = 
	`©oi
(
¬gv
[
idx
]+7);

99 } ià(!
	`¡ºcmp
(
¬gv
[
idx
], "card=", 5)) {

100 
ÿrd
 = 
	`©oi
(
¬gv
[
idx
]+5);

101 } ià(!
	`¡ºcmp
(
¬gv
[
idx
], "device=", 7)) {

102 
deviû
 = 
	`©oi
(
¬gv
[
idx
]+7);

103 } ià(!
	`¡ºcmp
(
¬gv
[
idx
], "subdevice=", 10)) {

104 
subdeviû
 = 
	`©oi
(
¬gv
[
idx
]+10);

105 } ià(!
	`¡rcmp
(
¬gv
[
idx
], "list")) {

106 
li¡
 = 1;

107 } ià(!
	`¡rcmp
(
¬gv
[
idx
], "async")) {

108 
async
 = 1;

110 
idx
++;

112 ià(
şass
 =ğ
SND_TIMER_CLASS_SLAVE
 && 
sşass
 =ğ
SND_TIMER_SCLASS_NONE
) {

113 
	`årštf
(
¡d”r
, "slave class is‚ot set\n");

114 
	`ex™
(
EXIT_FAILURE
);

116 ià(
li¡
) {

117 
¢d_tim”_qu”y_t
 *
qhªdË
;

118 ià((
”r
 = 
	`¢d_tim”_qu”y_İ’
(&
qhªdË
, "hw", 0)) < 0) {

119 
	`årštf
(
¡d”r
, "¢d_tim”_qu”y_İ’ƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

120 
	`ex™
(
EXIT_FAILURE
);

122 
	`¢d_tim”_id_£t_şass
(
id
, 
SND_TIMER_CLASS_NONE
);

124 ià((
”r
 = 
	`¢d_tim”_qu”y_Ãxt_deviû
(
qhªdË
, 
id
)) < 0) {

125 
	`årštf
(
¡d”r
, "tim”‚exˆdeviûƒ¼Ü: %s\n", 
	`¢d_¡»¼Ü
(
”r
));

128 ià(
	`¢d_tim”_id_g‘_şass
(
id
) < 0)

130 
	`´štf
("Timer device: class %i, sclass %i, card %i, device %i, subdevice %i\n",

131 
	`¢d_tim”_id_g‘_şass
(
id
),

132 
	`¢d_tim”_id_g‘_sşass
(
id
),

133 
	`¢d_tim”_id_g‘_ÿrd
(
id
),

134 
	`¢d_tim”_id_g‘_deviû
(
id
),

135 
	`¢d_tim”_id_g‘_subdeviû
(
id
));

137 
	`¢d_tim”_qu”y_şo£
(
qhªdË
);

138 
	`ex™
(
EXIT_SUCCESS
);

140 
	`¥rštf
(
tim”Çme
, "hw:CLASS=%i,SCLASS=%i,CARD=%i,DEV=%i,SUBDEV=%i", 
şass
, 
sşass
, 
ÿrd
, 
deviû
, 
subdeviû
);

141 ià((
”r
 = 
	`¢d_tim”_İ’
(&
hªdË
, 
tim”Çme
, 
SND_TIMER_OPEN_NONBLOCK
))<0) {

142 
	`årštf
(
¡d”r
, "tim” o³À%˜(%s)\n", 
”r
, 
	`¢d_¡»¼Ü
(err));

143 
	`ex™
(
EXIT_FAILURE
);

145 
	`´štf
("Usšgim” cÏs %i, sÏvşas %i, c¬d %i, deviû %i, subdeviû %i\n", 
şass
, 
sşass
, 
ÿrd
, 
deviû
, 
subdeviû
);

146 ià((
”r
 = 
	`¢d_tim”_šfo
(
hªdË
, 
šfo
)) < 0) {

147 
	`årštf
(
¡d”r
, "tim” infØ%˜(%s)\n", 
”r
, 
	`¢d_¡»¼Ü
(err));

148 
	`ex™
(0);

150 
	`´štf
("Timer info:\n");

151 
	`´štf
(" sÏvğ%s\n", 
	`¢d_tim”_šfo_is_¦ave
(
šfo
) ? "yes" : "no");

152 
	`´štf
(" c¬d = %i\n", 
	`¢d_tim”_šfo_g‘_ÿrd
(
šfo
));

153 
	`´štf
(" id = '%s'\n", 
	`¢d_tim”_šfo_g‘_id
(
šfo
));

154 
	`´štf
("‚amğ'%s'\n", 
	`¢d_tim”_šfo_g‘_Çme
(
šfo
));

155 
	`´štf
("‡v”ag»sŞutiÚ = %li\n", 
	`¢d_tim”_šfo_g‘_»sŞutiÚ
(
šfo
));

156 
	`¢d_tim”_·¿ms_£t_auto_¡¬t
(
·¿ms
, 1);

157 ià(!
	`¢d_tim”_šfo_is_¦ave
(
šfo
)) {

158 
	`¢d_tim”_·¿ms_£t_ticks
(
·¿ms
, (1000000000 / 
	`¢d_tim”_šfo_g‘_»sŞutiÚ
(
šfo
)) / 50);

159 ià(
	`¢d_tim”_·¿ms_g‘_ticks
(
·¿ms
) < 1)

160 
	`¢d_tim”_·¿ms_£t_ticks
(
·¿ms
, 1);

161 
	`´štf
("Usšg %l˜tick(s)\n", 
	`¢d_tim”_·¿ms_g‘_ticks
(
·¿ms
));

163 
	`¢d_tim”_·¿ms_£t_ticks
(
·¿ms
, 1);

165 ià((
”r
 = 
	`¢d_tim”_·¿ms
(
hªdË
, 
·¿ms
)) < 0) {

166 
	`årštf
(
¡d”r
, "tim”…¬am %˜(%s)\n", 
”r
, 
	`¢d_¡»¼Ü
(err));

167 
	`ex™
(0);

169 
	`show_¡©us
(
hªdË
);

170 ià(
async
) {

171 
”r
 = 
	`¢d_async_add_tim”_hªdËr
(&
ahªdËr
, 
hªdË
, 
async_ÿÎback
, &
acouÁ
);

172 ià(
”r
 < 0) {

173 
	`årštf
(
¡d”r
, "uÇbËØadd‡synøhªdË¸%˜(%s)\n", 
”r
, 
	`¢d_¡»¼Ü
(err));

174 
	`ex™
(
EXIT_FAILURE
);

177 ià((
”r
 = 
	`¢d_tim”_¡¬t
(
hªdË
)) < 0) {

178 
	`årštf
(
¡d”r
, "tim” s¹ %˜(%s)\n", 
”r
, 
	`¢d_¡»¼Ü
(err));

179 
	`ex™
(
EXIT_FAILURE
);

181 ià(
async
) {

184 
acouÁ
 < 25)

185 
	`¦“p
(1);

186 
	`¢d_tim”_¡İ
(
hªdË
);

188 
	`»ad_loİ
(
hªdË
, 25, 
	`¢d_tim”_šfo_is_¦ave
(
šfo
) ? 10000 : 25);

190 
	`show_¡©us
(
hªdË
);

191 
	`¢d_tim”_şo£
(
hªdË
);

192 
	`´štf
("Done\n");

193  
EXIT_SUCCESS
;

194 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/user-ctl-element-set.c

10 
	~"cÚfig.h
"

11 
	~"../šşude/asoundlib.h
"

12 
	~<sound/v.h
>

13 
	~<¡dboŞ.h
>

15 
	s–em_£t_ŒŸl
 {

16 
¢d_ùl_t
 *
	mhªdË
;

18 
¢d_ùl_–em_ty³_t
 
	mty³
;

19 
	mmemb”_couÁ
;

20 
	m–em’t_couÁ
;

22 
¢d_ùl_–em_id_t
 *
	mid
;

24 (*
	madd_–em_£t
)(
–em_£t_ŒŸl
 *
	mŒŸl
,

25 
¢d_ùl_–em_šfo_t
 *
	mšfo
);

26 (*
	mcheck_–em_´İs
)(
–em_£t_ŒŸl
 *
	mŒŸl
,

27 
¢d_ùl_–em_šfo_t
 *
	mšfo
);

28 (*
	mchªge_–em_memb”s
)(
–em_£t_ŒŸl
 *
	mŒŸl
,

29 
¢d_ùl_–em_v®ue_t
 *
	m–em_d©a
);

30 (*
	m®loÿ‹_–em_£t_v
)(
–em_£t_ŒŸl
 *
	mŒŸl
,

31 **
	mv
);

33 
boŞ
 
	mv_»adabË
;

36 
	schm­_’Œy
 {

37 
	mty³
;

38 
	mËngth
;

39 
	mm­s
[0];

57 
	$add_boŞ_–em_£t
(
–em_£t_ŒŸl
 *
ŒŸl
,

58 
¢d_ùl_–em_šfo_t
 *
šfo
)

60  
	`¢d_ùl_add_boŞ—n_–em_£t
(
ŒŸl
->
hªdË
, 
šfo
,

61 
ŒŸl
->
–em’t_couÁ
,rŸl->
memb”_couÁ
);

62 
	}
}

64 
	$chªge_boŞ_–em_memb”s
(
–em_£t_ŒŸl
 *
ŒŸl
,

65 
¢d_ùl_–em_v®ue_t
 *
–em_d©a
)

67 
v®
;

68 
i
;

70 
i
 = 0; i < 
ŒŸl
->
memb”_couÁ
; ++i) {

71 
v®
 = 
	`¢d_ùl_–em_v®ue_g‘_boŞ—n
(
–em_d©a
, 
i
);

72 
	`¢d_ùl_–em_v®ue_£t_boŞ—n
(
–em_d©a
, 
i
, !
v®
);

74 
	}
}

76 
	$®loÿ‹_boŞ_–em_£t_v
(
–em_£t_ŒŸl
 *
ŒŸl
,

77 **
v
)

83 cÚ¡ 
	`SNDRV_CTL_TLVD_DECLARE_DB_MINMAX
(
¿nge
, -10000, 0);

85 *
v
 = 
	`m®loc
((
¿nge
));

86 ià(*
v
 =ğ
NULL
)

87  -
ENOMEM
;

88 
	`memıy
(*
v
, 
¿nge
, (range));

91 
	}
}

94 
	$add_št_–em_£t
(
–em_£t_ŒŸl
 *
ŒŸl
,

95 
¢d_ùl_–em_šfo_t
 *
šfo
)

97  
	`¢d_ùl_add_š‹g”_–em_£t
(
ŒŸl
->
hªdË
, 
šfo
,

98 
ŒŸl
->
–em’t_couÁ
,rŸl->
memb”_couÁ
,

100 
	}
}

102 
	$check_št_–em_´İs
(
–em_£t_ŒŸl
 *
ŒŸl
,

103 
¢d_ùl_–em_šfo_t
 *
šfo
)

105 ià(
	`¢d_ùl_–em_šfo_g‘_mš
(
šfo
) != 0)

106  -
EIO
;

107 ià(
	`¢d_ùl_–em_šfo_g‘_max
(
šfo
) != 25)

108  -
EIO
;

109 ià(
	`¢d_ùl_–em_šfo_g‘_¡•
(
šfo
) != 1)

110  -
EIO
;

113 
	}
}

115 
	$chªge_št_–em_memb”s
(
–em_£t_ŒŸl
 *
ŒŸl
,

116 
¢d_ùl_–em_v®ue_t
 *
–em_d©a
)

118 
v®
;

119 
i
;

121 
i
 = 0; i < 
ŒŸl
->
memb”_couÁ
; ++i) {

122 
v®
 = 
	`¢d_ùl_–em_v®ue_g‘_š‹g”
(
–em_d©a
, 
i
);

123 
	`¢d_ùl_–em_v®ue_£t_š‹g”
(
–em_d©a
, 
i
, ++
v®
);

125 
	}
}

127 
	$®loÿ‹_št_–em_£t_v
(
–em_£t_ŒŸl
 *
ŒŸl
,

128 **
v
)

130 
couÁ
, 
pos
;

131 
i
, 
j
;

132 
chm­_’Œy
 *
’Œy
;

135 
couÁ
 = 0;

136 
i
 = 1; i <= 25; ++i) {

137 
couÁ
 += 2;

138 
couÁ
 +ğ
i
;

141 *
v
 = 
	`m®loc
((2 + 
couÁ
) * ());

142 ià(!*
v
)

143  -
ENOMEM
;

149 (*
v
)[0] = 
SNDRV_CTL_TLVT_CONTAINER
;

150 (*
v
)[1] = 
couÁ
 * ();

151 
pos
 = 2;

153 
i
 = 1; i <ğ25 && 
pos
 < 
couÁ
; ++i) {

154 
’Œy
 = (
chm­_’Œy
 *)&(*
v
)[
pos
];

156 
’Œy
->
ty³
 = 
SNDRV_CTL_TLVT_CHMAP_FIXED
;

157 
’Œy
->
Ëngth
 = 
i
 * ();

158 
pos
 += 2;

160 
j
 = 0; j < 
i
; ++j)

161 
’Œy
->
m­s
[
j
] = 
SND_CHMAP_MONO
 + j;

162 
pos
 +ğ
i
;

166 
	}
}

169 cÚ¡ *cÚ¡ 
	gÏb–s
[] = {

177 
	$add_’um_–em_£t
(
–em_£t_ŒŸl
 *
ŒŸl
,

178 
¢d_ùl_–em_šfo_t
 *
šfo
)

180  
	`¢d_ùl_add_’um”©ed_–em_£t
(
ŒŸl
->
hªdË
, 
šfo
,

181 
ŒŸl
->
–em’t_couÁ
,rŸl->
memb”_couÁ
,

182 (
Ïb–s
) / (labels[0]),

183 
Ïb–s
);

184 
	}
}

186 
	$check_’um_–em_´İs
(
–em_£t_ŒŸl
 *
ŒŸl
,

187 
¢d_ùl_–em_šfo_t
 *
šfo
)

189 
™ems
;

190 
i
;

191 cÚ¡ *
Ïb–
;

192 
”r
;

194 
™ems
 = 
	`¢d_ùl_–em_šfo_g‘_™ems
(
šfo
);

195 ià(
™ems
 !ğ(
Ïb–s
) / (labels[0]))

196  -
EIO
;

199 
i
 = 0; i < 
™ems
; ++i) {

200 
	`¢d_ùl_–em_šfo_£t_™em
(
šfo
, 
i
);

201 
”r
 = 
	`¢d_ùl_–em_šfo
(
ŒŸl
->
hªdË
, 
šfo
);

202 ià(
”r
 < 0)

203  
”r
;

205 
Ïb–
 = 
	`¢d_ùl_–em_šfo_g‘_™em_Çme
(
šfo
);

206 ià(
	`¡ºcmp
(
Ïb–
, 
Ïb–s
[
i
], 
	`¡¾’
(labels[i])) != 0)

207  -
EIO
;

211 
	}
}

213 
	$chªge_’um_–em_memb”s
(
–em_£t_ŒŸl
 *
ŒŸl
,

214 
¢d_ùl_–em_v®ue_t
 *
–em_d©a
)

216 
v®
;

217 
i
;

219 
i
 = 0; i < 
ŒŸl
->
memb”_couÁ
; ++i) {

220 
v®
 = 
	`¢d_ùl_–em_v®ue_g‘_’um”©ed
(
–em_d©a
, 
i
);

221 
	`¢d_ùl_–em_v®ue_£t_’um”©ed
(
–em_d©a
, 
i
, ++
v®
);

223 
	}
}

226 
	$add_by‹s_–em_£t
(
–em_£t_ŒŸl
 *
ŒŸl
,

227 
¢d_ùl_–em_šfo_t
 *
šfo
)

229  
	`¢d_ùl_add_by‹s_–em_£t
(
ŒŸl
->
hªdË
, 
šfo
,

230 
ŒŸl
->
–em’t_couÁ
,rŸl->
memb”_couÁ
);

231 
	}
}

233 
	$chªge_by‹s_–em_memb”s
(
–em_£t_ŒŸl
 *
ŒŸl
,

234 
¢d_ùl_–em_v®ue_t
 *
–em_d©a
)

236 
v®
;

237 
i
;

239 
i
 = 0; i < 
ŒŸl
->
memb”_couÁ
; ++i) {

240 
v®
 = 
	`¢d_ùl_–em_v®ue_g‘_by‹
(
–em_d©a
, 
i
);

241 
	`¢d_ùl_–em_v®ue_£t_by‹
(
–em_d©a
, 
i
, ++
v®
);

243 
	}
}

245 
	$®loÿ‹_by‹s_–em_£t_v
(
–em_£t_ŒŸl
 *
ŒŸl
,

246 **
v
)

253 cÚ¡ 
	`SNDRV_CTL_TLVD_DECLARE_DB_LINEAR
(
¿nge
, -4813, 0);

255 *
v
 = 
	`m®loc
((
¿nge
));

256 ià(*
v
 =ğ
NULL
)

257  -
ENOMEM
;

258 
	`memıy
(*
v
, 
¿nge
, (range));

261 
	}
}

264 
	$add_›c958_–em_£t
(
–em_£t_ŒŸl
 *
ŒŸl
,

265 
¢d_ùl_–em_šfo_t
 *
šfo
)

267 
”r
;

269 
	`¢d_ùl_–em_šfo_g‘_id
(
šfo
, 
ŒŸl
->
id
);

271 
”r
 = 
	`¢d_ùl_–em_add_›c958
(
ŒŸl
->
hªdË
,rŸl->
id
);

272 ià(
”r
 < 0)

273  
”r
;

279  
	`¢d_ùl_–em_šfo
(
ŒŸl
->
hªdË
, 
šfo
);

280 
	}
}

282 
	$chªge_›c958_–em_memb”s
(
–em_£t_ŒŸl
 *
ŒŸl
,

283 
¢d_ùl_–em_v®ue_t
 *
–em_d©a
)

285 
¢d_«s_›c958_t
 
d©a
;

288 
ŒŸl
->
–em’t_couÁ
 = 1;

290 
	`¢d_ùl_–em_v®ue_g‘_›c958
(
–em_d©a
, &
d©a
);

292 
d©a
.
·d
 = 10;

293 
	`¢d_ùl_–em_v®ue_£t_›c958
(
–em_d©a
, &
d©a
);

294 
	}
}

297 
	$add_št64_–em_£t
(
–em_£t_ŒŸl
 *
ŒŸl
,

298 
¢d_ùl_–em_šfo_t
 *
šfo
)

300  
	`¢d_ùl_add_š‹g”64_–em_£t
(
ŒŸl
->
hªdË
, 
šfo
,

301 
ŒŸl
->
–em’t_couÁ
,rŸl->
memb”_couÁ
,

303 
	}
}

305 
	$check_št64_–em_´İs
(
–em_£t_ŒŸl
 *
ŒŸl
,

306 
¢d_ùl_–em_šfo_t
 *
šfo
)

308 ià(
	`¢d_ùl_–em_šfo_g‘_mš64
(
šfo
) != 0)

309  -
EIO
;

310 ià(
	`¢d_ùl_–em_šfo_g‘_max64
(
šfo
) != 10000)

311  -
EIO
;

312 ià(
	`¢d_ùl_–em_šfo_g‘_¡•64
(
šfo
) != 1)

313  -
EIO
;

316 
	}
}

318 
	$chªge_št64_–em_memb”s
(
–em_£t_ŒŸl
 *
ŒŸl
,

319 
¢d_ùl_–em_v®ue_t
 *
–em_d©a
)

321 
v®
;

322 
i
;

324 
i
 = 0; i < 
ŒŸl
->
memb”_couÁ
; ++i) {

325 
v®
 = 
	`¢d_ùl_–em_v®ue_g‘_š‹g”64
(
–em_d©a
, 
i
);

326 
	`¢d_ùl_–em_v®ue_£t_š‹g”64
(
–em_d©a
, 
i
, ++
v®
);

328 
	}
}

330 
	$®loÿ‹_št64_–em_£t_v
(
–em_£t_ŒŸl
 *
ŒŸl
,

331 **
v
)

348 cÚ¡ 
	`SNDRV_CTL_TLVD_DECLARE_DB_RANGE
(
¿nge
,

349 0, 4, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(-5940, 44, 1),

350 4, 22, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(-5636, 60, 0),

351 22, 33, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(-4556, 76, 0),

352 33, 37, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(-4072, 44, 0),

353 37, 48, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(-3832, 76, 0),

354 48, 66, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(-2996, 60, 0),

355 66, 84, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(-2204, 44, 0),

356 84, 95, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
( -836, 60, 0),

357 95, 99, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
( -176, 76, 0),

358 100, 10000, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(0, 0, 0),

361 *
v
 = 
	`m®loc
((
¿nge
));

362 ià(*
v
 =ğ
NULL
)

363  -
ENOMEM
;

364 
	`memıy
(*
v
, 
¿nge
, (range));

367 
	}
}

370 
	$add_–em_£t
(
–em_£t_ŒŸl
 *
ŒŸl
)

372 
¢d_ùl_–em_šfo_t
 *
šfo
;

373 
Çme
[64] = {0};

374 
”r
;

376 
	`¢´štf
(
Çme
, 64, "userspace-control-element-%s",

377 
	`¢d_ùl_–em_ty³_Çme
(
ŒŸl
->
ty³
));

379 
	`¢d_ùl_–em_šfo_®loÿ
(&
šfo
);

380 
	`¢d_ùl_–em_šfo_£t_š‹rçû
(
šfo
, 
SND_CTL_ELEM_IFACE_MIXER
);

381 
	`¢d_ùl_–em_šfo_£t_Çme
(
šfo
, 
Çme
);

383 
”r
 = 
ŒŸl
->
	`add_–em_£t
ÑrŸl, 
šfo
);

384 ià(
”r
 >= 0)

385 
	`¢d_ùl_–em_šfo_g‘_id
(
šfo
, 
ŒŸl
->
id
);

387  
”r
;

388 
	}
}

390 
	$check_ev’t
(
–em_£t_ŒŸl
 *
ŒŸl
, 
mask
,

391 
ex³ùed_couÁ
)

393 
pŞlfd
 
pfds
;

394 
couÁ
;

395 
»v’ts
;

396 
¢d_ùl_ev’t_t
 *
ev’t
;

397 
”r
;

399 
	`¢d_ùl_ev’t_®loÿ
(&
ev’t
);

401 ià(
	`¢d_ùl_pŞl_desütÜs_couÁ
(
ŒŸl
->
hªdË
) != 1)

402  -
ENXIO
;

404 ià(
	`¢d_ùl_pŞl_desütÜs
(
ŒŸl
->
hªdË
, &
pfds
, 1) != 1)

405  -
ENXIO
;

407 
ex³ùed_couÁ
 > 0) {

408 
couÁ
 = 
	`pŞl
(&
pfds
, 1, 1000);

409 ià(
couÁ
 < 0)

410  
”ºo
;

412 ià(
couÁ
 == 0)

413  -
ETIMEDOUT
;

415 
”r
 = 
	`¢d_ùl_pŞl_desütÜs_»v’ts
(
ŒŸl
->
hªdË
, &
pfds
,

416 
couÁ
, &
»v’ts
);

417 ià(
”r
 < 0)

418  
”r
;

419 ià(
»v’ts
 & 
POLLERR
)

420  -
EIO
;

421 ià(!(
»v’ts
 & 
POLLIN
))

424 
”r
 = 
	`¢d_ùl_»ad
(
ŒŸl
->
hªdË
, 
ev’t
);

425 ià(
”r
 < 0)

426  
”r
;

427 ià(
	`¢d_ùl_ev’t_g‘_ty³
(
ev’t
è!ğ
SND_CTL_EVENT_ELEM
)

433 ià((
	`¢d_ùl_ev’t_–em_g‘_mask
(
ev’t
è& 
mask
) != mask)

435 --
ex³ùed_couÁ
;

438 ià(
ex³ùed_couÁ
 != 0)

439  -
EIO
;

442 
	}
}

444 
	$check_–em_li¡
(
–em_£t_ŒŸl
 *
ŒŸl
)

446 
¢d_ùl_–em_li¡_t
 *
li¡
;

447 
¢d_ùl_–em_id_t
 *
id
;

448 
e
;

449 
i
;

450 
”r
;

452 
	`¢d_ùl_–em_li¡_®loÿ
(&
li¡
);

453 
	`¢d_ùl_–em_id_®loÿ
(&
id
);

455 
”r
 = 
	`¢d_ùl_–em_li¡
(
ŒŸl
->
hªdË
, 
li¡
);

456 ià(
”r
 < 0)

457  
”r
;

460 ià(
	`¢d_ùl_–em_li¡_g‘_couÁ
(
li¡
) == 0)

461  -
EIO
;

463 
”r
 = 
	`¢d_ùl_–em_li¡_®loc_¥aû
(
li¡
,

464 
	`¢d_ùl_–em_li¡_g‘_couÁ
(
li¡
));

465 ià(
”r
 < 0)

466  
”r
;

468 
”r
 = 
	`¢d_ùl_–em_li¡
(
ŒŸl
->
hªdË
, 
li¡
);

469 ià(
”r
 < 0)

470 
’d
;

472 ià(
ŒŸl
->
–em’t_couÁ
 > 
	`¢d_ùl_–em_li¡_g‘_couÁ
(
li¡
)) {

473 
”r
 = -
EIO
;

474 
’d
;

477 
i
 = 0;

478 
e
 = 0;ƒ < 
	`¢d_ùl_–em_li¡_g‘_couÁ
(
li¡
); ++e) {

479 
	`¢d_ùl_–em_li¡_g‘_id
(
li¡
, 
e
, 
id
);

481 ià(
	`¡rcmp
(
	`¢d_ùl_–em_id_g‘_Çme
(
id
),

482 
	`¢d_ùl_–em_id_g‘_Çme
(
ŒŸl
->
id
)) != 0)

484 ià(
	`¢d_ùl_–em_id_g‘_š‹rçû
(
id
) !=

485 
	`¢d_ùl_–em_id_g‘_š‹rçû
(
ŒŸl
->
id
))

487 ià(
	`¢d_ùl_–em_id_g‘_deviû
(
id
) !=

488 
	`¢d_ùl_–em_id_g‘_deviû
(
ŒŸl
->
id
))

490 ià(
	`¢d_ùl_–em_id_g‘_subdeviû
(
id
) !=

491 
	`¢d_ùl_–em_id_g‘_subdeviû
(
ŒŸl
->
id
))

498 ià(
	`¢d_ùl_–em_id_g‘_numid
(
id
) !=

499 
	`¢d_ùl_–em_id_g‘_numid
(
ŒŸl
->
id
è+ 
i
)

501 ià(
	`¢d_ùl_–em_id_g‘_šdex
(
id
) !=

502 
	`¢d_ùl_–em_id_g‘_šdex
(
ŒŸl
->
id
è+ 
i
)

505 ++
i
;

508 ià(
i
 !ğ
ŒŸl
->
–em’t_couÁ
)

509 
”r
 = -
EIO
;

510 
’d
:

511 
	`¢d_ùl_–em_li¡_ä“_¥aû
(
li¡
);

513  
”r
;

514 
	}
}

516 
	$check_–em_£t_´İs
(
–em_£t_ŒŸl
 *
ŒŸl
)

518 
¢d_ùl_–em_id_t
 *
id
;

519 
¢d_ùl_–em_šfo_t
 *
šfo
;

520 
numid
;

521 
šdex
;

522 
i
;

523 
j
;

524 
”r
;

526 
	`¢d_ùl_–em_id_®loÿ
(&
id
);

527 
	`¢d_ùl_–em_šfo_®loÿ
(&
šfo
);

529 
	`¢d_ùl_–em_šfo_£t_id
(
šfo
, 
ŒŸl
->
id
);

530 
numid
 = 
	`¢d_ùl_–em_id_g‘_numid
(
ŒŸl
->
id
);

531 
šdex
 = 
	`¢d_ùl_–em_id_g‘_šdex
(
ŒŸl
->
id
);

533 
i
 = 0; i < 
ŒŸl
->
–em’t_couÁ
; ++i) {

534 
	`¢d_ùl_–em_šfo_£t_šdex
(
šfo
, 
šdex
 + 
i
);

540 ià(
numid
 > 0)

541 
	`¢d_ùl_–em_šfo_£t_numid
(
šfo
, 
numid
 + 
i
);

543 
”r
 = 
	`¢d_ùl_–em_šfo
(
ŒŸl
->
hªdË
, 
šfo
);

544 ià(
”r
 < 0)

545  
”r
;

548 ià(
	`¢d_ùl_–em_šfo_g‘_ty³
(
šfo
è!ğ
ŒŸl
->
ty³
)

549  -
EIO
;

550 ià(
	`¢d_ùl_–em_šfo_g‘_couÁ
(
šfo
è!ğ
ŒŸl
->
memb”_couÁ
)

551  -
EIO
;

557 ià(
	`¢d_ùl_–em_šfo_g‘_owÃr
(
šfo
è!ğ
	`g‘pid
())

558  -
EIO
;

564 ià(!
	`¢d_ùl_–em_šfo_is_locked
(
šfo
))

565  -
EIO
;

573 ià(
ŒŸl
->
ty³
 !ğ
SND_CTL_ELEM_TYPE_IEC958
 &&

574 !
	`¢d_ùl_–em_šfo_is_v_wr™abË
(
šfo
))

575  -
EIO
;

578 ià(
ŒŸl
->
check_–em_´İs
 !ğ
NULL
) {

579 
”r
 = 
ŒŸl
->
	`check_–em_´İs
ÑrŸl, 
šfo
);

580 ià(
”r
 < 0)

581  
”r
;

584 
	`¢d_ùl_–em_šfo_g‘_id
(
šfo
, 
id
);

585 
”r
 = 
	`¢d_ùl_–em_uÆock
(
ŒŸl
->
hªdË
, 
id
);

586 ià(
”r
 < 0)

587  
”r
;

595 ià(
	`¢d_ùl_–em_šfo_is_v_»adabË
(
šfo
)) {

596 
d©a
[32];

597 
”r
 = 
	`¢d_ùl_–em_v_»ad
(
ŒŸl
->
hªdË
,rŸl->
id
,

598 
d©a
, (data));

599 ià(
”r
 >= 0)

600  -
EIO
;

601 ià(
”r
 !ğ-
ENXIO
)

602  
”r
;

604 
ŒŸl
->
v_»adabË
 = 
Œue
;

610 
	}
}

612 
	$check_–ems
(
–em_£t_ŒŸl
 *
ŒŸl
)

614 
¢d_ùl_–em_v®ue_t
 *
d©a
;

615 
numid
;

616 
šdex
;

617 
i
;

618 
”r
;

620 
	`¢d_ùl_–em_v®ue_®loÿ
(&
d©a
);

622 
	`¢d_ùl_–em_v®ue_£t_id
(
d©a
, 
ŒŸl
->
id
);

623 
numid
 = 
	`¢d_ùl_–em_id_g‘_numid
(
ŒŸl
->
id
);

624 
šdex
 = 
	`¢d_ùl_–em_id_g‘_šdex
(
ŒŸl
->
id
);

626 
i
 = 0; i < 
ŒŸl
->
–em’t_couÁ
; ++i) {

627 
	`¢d_ùl_–em_v®ue_£t_šdex
(
d©a
, 
šdex
 + 
i
);

633 ià(
numid
 > 0)

634 
	`¢d_ùl_–em_v®ue_£t_numid
(
d©a
, 
numid
 + 
i
);

636 
”r
 = 
	`¢d_ùl_–em_»ad
(
ŒŸl
->
hªdË
, 
d©a
);

637 ià(
”r
 < 0)

638  
”r
;

641 
ŒŸl
->
	`chªge_–em_memb”s
ÑrŸl, 
d©a
);

643 
”r
 = 
	`¢d_ùl_–em_wr™e
(
ŒŸl
->
hªdË
, 
d©a
);

644 ià(
”r
 < 0)

645  
”r
;

649 
	}
}

651 
	$check_v
(
–em_£t_ŒŸl
 *
ŒŸl
)

653 *
v
;

654 
mask
;

655 
couÁ
;

656 
Ën
;

657 *
cu¼
;

658 
”r
;

660 
”r
 = 
ŒŸl
->
	`®loÿ‹_–em_£t_v
ÑrŸl, &
v
);

661 ià(
”r
 < 0)

662  
”r
;

664 
Ën
 = 
v
[
SNDRV_CTL_TLVO_LEN
] + () * 2;

665 
cu¼
 = 
	`m®loc
(
Ën
);

666 ià(
cu¼
 =ğ
NULL
) {

667 
	`ä“
(
v
);

668  -
ENOMEM
;

676 
”r
 = 
	`¢d_ùl_–em_v_wr™e
(
ŒŸl
->
hªdË
,rŸl->
id
,

677 (cÚ¡ *)
v
);

678 ià(
”r
 < 0)

679 
’d
;

686 ià(!
ŒŸl
->
v_»adabË
) {

687 
mask
 = 
SND_CTL_EVENT_MASK_INFO
 | 
SND_CTL_EVENT_MASK_TLV
;

688 
couÁ
 = 
ŒŸl
->
–em’t_couÁ
;

690 
mask
 = 
SND_CTL_EVENT_MASK_TLV
;

691 
couÁ
 = 1;

693 
”r
 = 
	`check_ev’t
(
ŒŸl
, 
mask
, 
couÁ
);

694 ià(
”r
 < 0)

695 
’d
;

696 ià(!
ŒŸl
->
v_»adabË
) {

697 
¢d_ùl_–em_šfo_t
 *
šfo
;

698 
	`¢d_ùl_–em_šfo_®loÿ
(&
šfo
);

700 
	`¢d_ùl_–em_šfo_£t_id
(
šfo
, 
ŒŸl
->
id
);

701 
”r
 = 
	`¢d_ùl_–em_šfo
(
ŒŸl
->
hªdË
, 
šfo
);

702 ià(
”r
 < 0)

703  
”r
;

704 ià(!
	`¢d_ùl_–em_šfo_is_v_»adabË
(
šfo
))

705  -
EIO
;

708 
ŒŸl
->
v_»adabË
 = 
Œue
;

711 
”r
 = 
	`¢d_ùl_–em_v_»ad
(
ŒŸl
->
hªdË
,rŸl->
id
, 
cu¼
, 
Ën
);

712 ià(
”r
 < 0)

713 
’d
;

715 ià(
	`memcmp
(
cu¼
, 
v
, 
Ën
) != 0)

716 
”r
 = -
EIO
;

717 
’d
:

718 
	`ä“
(
v
);

719 
	`ä“
(
cu¼
);

721 
	}
}

723 
	$maš
()

725 
–em_£t_ŒŸl
 
ŒŸl
 = {0};

726 
i
;

727 
”r
;

729 
	`¢d_ùl_–em_id_®loÿ
(&
ŒŸl
.
id
);

731 
”r
 = 
	`¢d_ùl_İ’
(&
ŒŸl
.
hªdË
, "hw:0", 0);

732 ià(
”r
 < 0)

733  
EXIT_FAILURE
;

735 
”r
 = 
	`¢d_ùl_subsüibe_ev’ts
(
ŒŸl
.
hªdË
, 1);

736 ià(
”r
 < 0)

737  
EXIT_FAILURE
;

740 
i
 = 0; i < 
SND_CTL_ELEM_TYPE_LAST
; ++i) {

741 
ŒŸl
.
ty³
 = 
i
 + 1;

744 
ŒŸl
.
ty³
) {

745 
SND_CTL_ELEM_TYPE_BOOLEAN
:

746 
ŒŸl
.
–em’t_couÁ
 = 900;

747 
ŒŸl
.
memb”_couÁ
 = 128;

748 
ŒŸl
.
add_–em_£t
 = 
add_boŞ_–em_£t
;

749 
ŒŸl
.
check_–em_´İs
 = 
NULL
;

750 
ŒŸl
.
chªge_–em_memb”s
 = 
chªge_boŞ_–em_memb”s
;

751 
ŒŸl
.
®loÿ‹_–em_£t_v
 =

752 
®loÿ‹_boŞ_–em_£t_v
;

753 
ŒŸl
.
v_»adabË
 = 
çl£
;

755 
SND_CTL_ELEM_TYPE_INTEGER
:

756 
ŒŸl
.
–em’t_couÁ
 = 900;

757 
ŒŸl
.
memb”_couÁ
 = 128;

758 
ŒŸl
.
add_–em_£t
 = 
add_št_–em_£t
;

759 
ŒŸl
.
check_–em_´İs
 = 
check_št_–em_´İs
;

760 
ŒŸl
.
chªge_–em_memb”s
 = 
chªge_št_–em_memb”s
;

761 
ŒŸl
.
®loÿ‹_–em_£t_v
 =

762 
®loÿ‹_št_–em_£t_v
;

763 
ŒŸl
.
v_»adabË
 = 
çl£
;

765 
SND_CTL_ELEM_TYPE_ENUMERATED
:

766 
ŒŸl
.
–em’t_couÁ
 = 900;

767 
ŒŸl
.
memb”_couÁ
 = 128;

768 
ŒŸl
.
add_–em_£t
 = 
add_’um_–em_£t
;

769 
ŒŸl
.
check_–em_´İs
 = 
check_’um_–em_´İs
;

770 
ŒŸl
.
chªge_–em_memb”s
 = 
chªge_’um_–em_memb”s
;

771 
ŒŸl
.
®loÿ‹_–em_£t_v
 = 
NULL
;

772 
ŒŸl
.
v_»adabË
 = 
çl£
;

774 
SND_CTL_ELEM_TYPE_BYTES
:

775 
ŒŸl
.
–em’t_couÁ
 = 900;

776 
ŒŸl
.
memb”_couÁ
 = 512;

777 
ŒŸl
.
add_–em_£t
 = 
add_by‹s_–em_£t
;

778 
ŒŸl
.
check_–em_´İs
 = 
NULL
;

779 
ŒŸl
.
chªge_–em_memb”s
 = 
chªge_by‹s_–em_memb”s
;

780 
ŒŸl
.
®loÿ‹_–em_£t_v
 =

781 
®loÿ‹_by‹s_–em_£t_v
;

782 
ŒŸl
.
v_»adabË
 = 
çl£
;

784 
SND_CTL_ELEM_TYPE_IEC958
:

785 
ŒŸl
.
–em’t_couÁ
 = 1;

786 
ŒŸl
.
memb”_couÁ
 = 1;

787 
ŒŸl
.
add_–em_£t
 = 
add_›c958_–em_£t
;

788 
ŒŸl
.
check_–em_´İs
 = 
NULL
;

789 
ŒŸl
.
chªge_–em_memb”s
 = 
chªge_›c958_–em_memb”s
;

790 
ŒŸl
.
®loÿ‹_–em_£t_v
 = 
NULL
;

791 
ŒŸl
.
v_»adabË
 = 
çl£
;

793 
SND_CTL_ELEM_TYPE_INTEGER64
:

795 
ŒŸl
.
–em’t_couÁ
 = 900;

796 
ŒŸl
.
memb”_couÁ
 = 64;

797 
ŒŸl
.
add_–em_£t
 = 
add_št64_–em_£t
;

798 
ŒŸl
.
check_–em_´İs
 = 
check_št64_–em_´İs
;

799 
ŒŸl
.
chªge_–em_memb”s
 = 
chªge_št64_–em_memb”s
;

800 
ŒŸl
.
®loÿ‹_–em_£t_v
 =

801 
®loÿ‹_št64_–em_£t_v
;

802 
ŒŸl
.
v_»adabË
 = 
çl£
;

807 
”r
 = 
	`add_–em_£t
(&
ŒŸl
);

808 ià(
”r
 < 0) {

809 
	`´štf
("Failo‡dd‡nƒlement set with %sype.\n",

810 
	`¢d_ùl_–em_ty³_Çme
(
ŒŸl
.
ty³
));

813 
”r
 = 
	`check_ev’t
(&
ŒŸl
, 
SND_CTL_EVENT_MASK_ADD
,

814 
ŒŸl
.
–em’t_couÁ
);

815 ià(
”r
 < 0) {

816 
	`´štf
("Failo check someƒventso‡ddƒlements with "

818 
	`¢d_ùl_–em_ty³_Çme
(
ŒŸl
.
ty³
));

823 
”r
 = 
	`check_–em_li¡
(&
ŒŸl
);

824 ià(
”r
 < 0) {

825 
	`´štf
("Failo†istƒachƒlement with %sype.\n",

826 
	`¢d_ùl_–em_ty³_Çme
(
ŒŸl
.
ty³
));

831 
”r
 = 
	`check_–em_£t_´İs
(&
ŒŸl
);

832 ià(
”r
 < 0) {

833 
	`´štf
("Failo check…roperties ofƒachƒlement with "

835 
	`¢d_ùl_–em_ty³_Çme
(
ŒŸl
.
ty³
));

843 
”r
 = 
	`check_–ems
(&
ŒŸl
);

844 ià(
”r
 < 0) {

845 
	`´štf
("Failo change status ofƒachƒlement with %s "

847 
	`¢d_ùl_–em_ty³_Çme
(
ŒŸl
.
ty³
));

850 
”r
 = 
	`check_ev’t
(&
ŒŸl
, 
SND_CTL_EVENT_MASK_VALUE
,

851 
ŒŸl
.
–em’t_couÁ
);

852 ià(
”r
 < 0) {

853 
	`´štf
("Failo check someƒventso change status of "

855 
	`¢d_ùl_–em_ty³_Çme
(
ŒŸl
.
ty³
));

863 ià(
ŒŸl
.
®loÿ‹_–em_£t_v
 !ğ
NULL
) {

864 
”r
 = 
	`check_v
(&
ŒŸl
);

865 ià(
”r
 < 0) {

866 
	`´štf
("Failo change TLV data of‡nƒlement "

868 
	`¢d_ùl_–em_ty³_Çme
(
ŒŸl
.
ty³
));

874 
”r
 = 
	`¢d_ùl_–em_»move
(
ŒŸl
.
hªdË
,rŸl.
id
);

875 ià(
”r
 < 0) {

876 
	`´štf
("Failo„emoveƒlements with %sype.\n",

877 
	`¢d_ùl_–em_ty³_Çme
(
ŒŸl
.
ty³
));

880 
”r
 = 
	`check_ev’t
(&
ŒŸl
, 
SND_CTL_EVENT_MASK_REMOVE
,

881 
ŒŸl
.
–em’t_couÁ
);

882 ià(
”r
 < 0) {

883 
	`´štf
("Failo check someƒventso„emoveƒach "

885 
	`¢d_ùl_–em_ty³_Çme
(
ŒŸl
.
ty³
));

890 ià(
”r
 < 0) {

891 
	`´štf
("%s\n", 
	`¢d_¡»¼Ü
(
”r
));

894 
	`¢d_ùl_–em_»move
(
ŒŸl
.
hªdË
,rŸl.
id
);

895  
EXIT_FAILURE
;

898  
EXIT_SUCCESS
;

899 
	}
}

	@
1
.
0
239
17358
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/alsalisp/alsalisp.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/aserver/aserver.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/alisp.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/alsa-symbols.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/aserver.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/asoundef.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/asoundlib-head.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/asoundlib-tail.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/bswap.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/conf.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/control.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/control_external.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/control_plugin.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/error.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/global.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/hwdep.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/input.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/list.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/mixer.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/mixer_abst.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/output.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_external.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_extplug.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_ioplug.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_old.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_plugin.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_rate.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/rawmidi.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/search.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seq.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seq_event.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seq_midi_event.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seqmid.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asequencer.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asoc.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asound.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asound_fm.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/emu10k1.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/hdsp.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/hdspm.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/sb16_csp.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/sscape_ioctl.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/tlv.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/type_compat.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asequencer.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asoc.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asound.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asound_fm.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/emu10k1.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/hdsp.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/hdspm.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/sb16_csp.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/sscape_ioctl.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/tlv.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sys.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/timer.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/topology.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/type_compat.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/ump.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/ump_msg.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/use-case.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/ac97.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/hda.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/python.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/sbase.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/sbase.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/sbasedl.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/alisp/alisp.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/alisp/alisp_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/alisp/alisp_snd.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/async.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/conf.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/confeval.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/confmisc.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/cards.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_empty.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_ext.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_hw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_plugin.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_remap.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_shm.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_symbols.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/ctlparse.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/eld.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/hcontrol.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/namehint.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/setup.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/tlv.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/dlmisc.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/error.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep_hw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep_symbols.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/input.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/bag.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/mixer.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/mixer_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/mixer_simple.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/simple.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/simple_abst.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/simple_none.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/names.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/output.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/interval.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/interval.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/interval_inline.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/ladspa.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/mask.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/mask.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/mask_inline.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_adpcm.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_alaw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_asym.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_copy.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_direct.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_direct.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_generic.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_i386.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_i386.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_x86_64.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_x86_64.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dshare.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dsnoop.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_empty.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_ext_parm.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_extplug.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_file.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_generic.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_generic.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_hooks.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_hw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_iec958.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_ioplug.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_ladspa.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_lfloat.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_linear.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_meter.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_misc.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_mmap.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_mmap_emul.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_mulaw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_multi.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_null.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_params.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_plug.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_plugin.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_plugin.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_rate.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_rate_linear.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_route.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_share.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_shm.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_simple.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_softvol.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_symbols.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/plugin_ops.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/scopes/level.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_hw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_symbols.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_virt.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/ump.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/ump_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_event.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_hw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_midi_event.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_old.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_symbols.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seqmid.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/shmarea.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/socket.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_hw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_query.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_query_hw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_symbols.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/builder.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/channel.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/ctl.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/dapm.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/data.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/decoder.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/elem.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/log.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/ops.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/parser.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/pcm.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/save.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/text.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/tplg_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/main.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/parser.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_cond.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_confdoc.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_exec.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_include.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_regex.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_subs.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/utils.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/userfile.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/audio_time.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/chmap.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/client_event_filter.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/control.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/latency.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/lsb/config.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/lsb/midi_event.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/lsb/test.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/midifile.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/midifile.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/midiloop.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/mixtest.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/namehint.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/oldapi.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/omixer.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/pcm-multi-thread.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/pcm.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/pcm_min.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/playmidi1.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/queue_timer.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/rawmidi.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/seq-decoder.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/seq-sender.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/seq.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/timer.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/user-ctl-element-set.c
