cscope 15 $HOME/kth/assert/galapagos/use_cases/alsa-lib -q 0000012897 0003027957
	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/alsalisp/alsalisp.c

22 
	~<°dio.h
>

23 
	~<°dlib.h
>

24 
	~<°rög.h
>

25 
	~<uni°d.h
>

26 
	~<îr.h
>

28 
	~"asoundlib.h
"

29 
	~"Æi•.h
"

31 
	gvîbo£
 = 0;

32 
	gw¨nög
 = 0;

33 
	gdebug
 = 0;

35 
	$öãΩªt_fûíame
(c⁄° *
fûe
)

37 
Æi•_cfg
 
cfg
;

38 
¢d_öput_t
 *
ö
;

39 
¢d_ouçut_t
 *
out
;

40 
îr
;

42 
	`mem£t
(&
cfg
, 0, (cfg));

43 i‡(
fûe
 !
NULL
 && 
	`°rcmp
(file, "-") != 0) {

44 i‡((
îr
 = 
	`¢d_öput_°dio_›í
(&
ö
, 
fûe
, "r")) < 0) {

45 
	`Ârötf
(
°dîr
, "u«bÀÅÿ›í fûíamê'%s' (%s)\n", 
fûe
, 
	`¢d_°ªº‹
(
îr
));

49 i‡((
îr
 = 
	`¢d_öput_°dio_©èch
(&
ö
, 
°dö
, 0)) < 0) {

50 
	`Ârötf
(
°dîr
, "u«bÀÅÿ©èch stdö '%s' (%s)\n", 
fûe
, 
	`¢d_°ªº‹
(
îr
));

54 i‡(
	`¢d_ouçut_°dio_©èch
(&
out
, 
°dout
, 0) < 0) {

55 
	`¢d_öput_˛o£
(
ö
);

56 
	`Ârötf
(
°dîr
, "u«bÀÅÿ©èch stdouà(%s)\n", 
	`°ªº‹
(
î∫o
));

59 
cfg
.
vîbo£
 = verbose;

60 
cfg
.
w¨nög
 = warning;

61 
cfg
.
debug
 = debug;

62 
cfg
.
ö
 = in;

63 
cfg
.
out
 = cfg.
eout
 = cfg.
vout
 = cfg.
wout
 = cfg.
dout
 = out;

64 
îr
 = 
	`Æß_li•
(&
cfg
, 
NULL
);

65 i‡(
îr
 < 0)

66 
	`Ârötf
(
°dîr
, "ÆßÜi•Ñëu∫edÉº‹ %ò(%s)\n", 
îr
, 
	`°ªº‹
(err));

67 i‡(
vîbo£
)

68 
	`¥ötf
("fûê%†∑s£d ok vüálßÜi• i¡î¥ëî\n", 
fûe
);

69 
	`¢d_ouçut_˛o£
(
out
);

70 
	`¢d_öput_˛o£
(
ö
);

71 
	}
}

73 
	$ußge
()

75 
	`Ârötf
(
°dîr
, "usage:álsalisp [-vdw] [file...]\n");

76 
	`exô
(1);

77 
	}
}

79 
	$maö
(
¨gc
, **
¨gv
)

81 
c
;

83 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "vdw")) != -1) {

84 
c
) {

86 
vîbo£
 = 1;

89 
debug
 = 1;

92 
w¨nög
 = 1;

96 
	`ußge
();

100 
¨gc
 -
›töd
;

101 
¨gv
 +
›töd
;

103 i‡(
¨gc
 < 1)

104 
	`öãΩªt_fûíame
(
NULL
);

106 *
¨gv
)

107 
	`öãΩªt_fûíame
(*
¨gv
++);

110 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/aserver/aserver.c

21 
	~"a£rvî.h
"

23 
	~<sys/shm.h
>

24 
	~<sys/sockë.h
>

25 
	~<pﬁl.h
>

26 
	~<sys/un.h
>

27 
	~<sys/uio.h
>

28 
	~<°dio.h
>

29 
	~<uni°d.h
>

30 
	~<f˙é.h
>

31 
	~<°ddef.h
>

32 
	~<gë›t.h
>

33 
	~<√töë/ö.h
>

34 
	~<√tdb.h
>

35 
	~<limôs.h
>

36 
	~<sig«l.h
>

39 *
	gcomm™d
;

41 #i‡
__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 95)

42 
	#ERROR
(...) do {\

43 
	`Ârötf
(
°dîr
, "%†%s:%i:(%sË", 
comm™d
, 
__FILE__
, 
__LINE__
, 
__func__
); \

44 
	`Ârötf
(
°dîr
, 
__VA_ARGS__
); \

45 
	`putc
('\n', 
°dîr
); \

46 } 0)

	)

48 
	#ERROR
(
¨gs
...) do {\

49 
	`Ârötf
(
°dîr
, "%†%s:%i:(%sË", 
comm™d
, 
__FILE__
, 
__LINE__
, 
__func__
); \

50 
	`Ârötf
(
°dîr
, ##
¨gs
); \

51 
	`putc
('\n', 
°dîr
); \

52 } 0)

	)

55 
	#SYSERROR
(
°rög
Ë
	`ERROR
(°rög ": %s", 
	`°ªº‹
(
î∫o
))

	)

57 
	$make_loˇl_sockë
(c⁄° *
fûíame
)

59 
size_t
 
l
 = 
	`°æí
(
fûíame
);

60 
size_t
 
size
 = 
	`off£tof
(
sockaddr_un
, 
sun_∑th
Ë+ 
l
;

61 
sockaddr_un
 *
addr
 = 
	`Æloˇ
(
size
);

62 
sock
;

64 
sock
 = 
	`sockë
(
PF_LOCAL
, 
SOCK_STREAM
, 0);

65 i‡(
sock
 < 0) {

66 
ªsu…
 = -
î∫o
;

67 
	`SYSERROR
("socket failed");

68  
ªsu…
;

71 
	`u∆ök
(
fûíame
);

73 
addr
->
sun_Ámûy
 = 
AF_LOCAL
;

74 
	`mem˝y
(
addr
->
sun_∑th
, 
fûíame
, 
l
);

76 i‡(
	`böd
(
sock
, (
sockaddr
 *Ë
addr
, 
size
) < 0) {

77 
ªsu…
 = -
î∫o
;

78 
	`SYSERROR
("bind failed");

79 
	`˛o£
(
sock
);

80  
ªsu…
;

83  
sock
;

84 
	}
}

86 
	$make_öë_sockë
(
p‹t
)

88 
sockaddr_ö
 
addr
;

89 
sock
;

91 
sock
 = 
	`sockë
(
PF_INET
, 
SOCK_STREAM
, 0);

92 i‡(
sock
 < 0) {

93 
ªsu…
 = -
î∫o
;

94 
	`SYSERROR
("socket failed");

95  
ªsu…
;

98 
	`mem£t
(&
addr
, 0, (addr));

99 
addr
.
sö_Ámûy
 = 
AF_INET
;

100 
addr
.
sö_p‹t
 = 
	`ht⁄s
(
p‹t
);

101 
addr
.
sö_addr
.
s_addr
 = 
INADDR_ANY
;

103 i‡(
	`böd
(
sock
, (
sockaddr
 *Ë&
addr
, (addr)) < 0) {

104 
ªsu…
 = -
î∫o
;

105 
	`SYSERROR
("bind failed");

106 
	`˛o£
(
sock
);

107  
ªsu…
;

110  
sock
;

111 
	}
}

113 
pﬁlfd
 *
	gpﬁlfds
;

114 
	gpﬁlfds_cou¡
 = 0;

115 
waôî
 
	twaôî_t
;

116 (*
	twaôî_h™dÀr_t
)(
	twaôî_t
 *
	twaôî
, 
	tevíts
);

117 
	swaôî
 {

118 
fd
;

119 *
¥iv©e_d©a
;

120 
waôî_h™dÀr_t
 
h™dÀr
;

122 
waôî_t
 *
waôîs
;

124 
	$add_waôî
(
fd
, 
evíts
, 
waôî_h™dÀr_t
 
h™dÀr
,

125 *
d©a
)

127 
waôî_t
 *
w
 = &
waôîs
[
fd
];

128 
pﬁlfd
 *
pfd
 = &
pﬁlfds
[
pﬁlfds_cou¡
];

129 
	`as£π
(!
w
->
h™dÀr
);

130 
pfd
->
fd
 = fd;

131 
pfd
->
evíts
 =Évents;

132 
pfd
->
ªvíts
 = 0;

133 
w
->
fd
 = fd;

134 
w
->
¥iv©e_d©a
 = 
d©a
;

135 
w
->
h™dÀr
 = handler;

136 
pﬁlfds_cou¡
++;

137 
	}
}

139 
	$dñ_waôî
(
fd
)

141 
waôî_t
 *
w
 = &
waôîs
[
fd
];

142 
k
;

143 
	`as£π
(
w
->
h™dÀr
);

144 
w
->
h™dÀr
 = 0;

145 
k
 = 0; k < 
pﬁlfds_cou¡
; ++k) {

146 i‡(
pﬁlfds
[
k
].
fd
 == fd)

149 
	`as£π
(
k
 < 
pﬁlfds_cou¡
);

150 
pﬁlfds_cou¡
--;

151 
	`memmove
(&
pﬁlfds
[
k
], &pﬁlfds[k + 1], 
pﬁlfds_cou¡
 - k);

152 
	}
}

154 
˛õ¡
 
	t˛õ¡_t
;

157 (*
	m›í
)(
˛õ¡_t
 *
	m˛õ¡
, *
	mcookõ
);

158 (*
	mcmd
)(
˛õ¡_t
 *
	m˛õ¡
);

159 (*
	m˛o£
)(
˛õ¡_t
 *
	m˛õ¡
);

160 } 
	tå™•‹t_›s_t
;

162 
	s˛õ¡
 {

163 
li°_hód
 
	mli°
;

164 
	mpﬁl_fd
;

165 
	m˘æ_fd
;

166 
	mloˇl
;

167 
	må™•‹t_ty≥
;

168 
	mdev_ty≥
;

169 
	m«me
[256];

170 
	m°ªam
;

171 
	mmode
;

172 
å™•‹t_›s_t
 *
	m›s
;

173 
¢d_async_h™dÀr_t
 *
	masync_h™dÀr
;

174 
	masync_sig
;

175 
pid_t
 
	masync_pid
;

178 
¢d_pcm_t
 *
	mh™dÀ
;

179 
	mfd
;

180 } 
	mpcm
;

182 
¢d_˘l_t
 *
	mh™dÀ
;

183 
	mfd
;

184 } 
	m˘l
;

187 
¢d_øwmidi_t
 *
	mh™dÀ
;

188 } 
	møwmidi
;

190 
¢d_timî_›í_t
 *
	mh™dÀ
;

191 } 
	mtimî
;

193 
¢d_hwdï_t
 *
	mh™dÀ
;

194 } 
	mhwdï
;

196 
¢d_£q_t
 *
	mh™dÀ
;

197 } 
	m£q
;

199 } 
	mdevi˚
;

200 
	mpﬁlög
;

201 
	m›í
;

202 
	mcookõ
;

205 
	m˘æ_id
;

206 *
	m˘æ
;

207 } 
	mshm
;

208 } 
	må™•‹t
;

211 
LIST_HEAD
(
˛õ¡s
);

214 
li°_hód
 
	mli°
;

215 
	mfd
;

216 
uöt32_t
 
	mcookõ
;

217 } 
	töë_≥ndög_t
;

218 
LIST_HEAD
(
öë_≥ndögs
);

221 
	$pcm_h™dÀr
(
waôî_t
 *
waôî
, 
evíts
)

223 
˛õ¡_t
 *
˛õ¡
 = 
waôî
->
¥iv©e_d©a
;

224 
buf
[1];

225 
ssize_t
 
n
;

226 i‡(
evíts
 & 
POLLIN
) {

227 
n
 = 
	`wrôe
(
˛õ¡
->
pﬁl_fd
, 
buf
, 1);

228 i‡(
n
 != 1) {

229 
	`SYSERROR
("write failed");

230  -
î∫o
;

232 } i‡(
evíts
 & 
POLLOUT
) {

233 
n
 = 
	`ªad
(
˛õ¡
->
pﬁl_fd
, 
buf
, 1);

234 i‡(
n
 != 1) {

235 
	`SYSERROR
("read failed");

236  -
î∫o
;

239 
	`dñ_waôî
(
waôî
->
fd
);

240 
˛õ¡
->
pﬁlög
 = 0;

242 
	}
}

245 
	$pcm_shm_hw_±r_ch™ged
(
¢d_pcm_t
 *
pcm
, snd_pcm_à*
§c
 
ATTRIBUTE_UNUSED
)

247 
˛õ¡_t
 *
˛õ¡
 = 
pcm
->
hw
.
¥iv©e_d©a
;

248 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
˛õ¡
->
å™•‹t
.
shm
.ctrl;

249 
¢d_pcm_t
 *
lo›
;

251 
˘æ
->
hw
.
ch™ged
 = 1;

252 i‡(
pcm
->
hw
.
fd
 >= 0) {

253 
˘æ
->
hw
.
u£_mm≠
 = 1;

254 
˘æ
->
hw
.
off£t
 = 
pcm
->hw.offset;

257 
˘æ
->
hw
.
u£_mm≠
 = 0;

258 
˘æ
->
hw
.
±r
 = 
pcm
->hw.ptr ? *pcm->hw.ptr : 0;

259 
lo›
 = 
pcm
->
hw
.
ma°î
;Üoop;Üoop =Üoop->hw.master)

260 
lo›
->
hw
.
±r
 = &
˘æ
->hw.ptr;

261 
pcm
->
hw
.
±r
 = &
˘æ
->hw.ptr;

262 
	}
}

264 
	$pcm_shm_≠∂_±r_ch™ged
(
¢d_pcm_t
 *
pcm
, snd_pcm_à*
§c
 
ATTRIBUTE_UNUSED
)

266 
˛õ¡_t
 *
˛õ¡
 = 
pcm
->
≠∂
.
¥iv©e_d©a
;

267 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
˛õ¡
->
å™•‹t
.
shm
.ctrl;

268 
¢d_pcm_t
 *
lo›
;

270 
˘æ
->
≠∂
.
ch™ged
 = 1;

271 i‡(
pcm
->
≠∂
.
fd
 >= 0) {

272 
˘æ
->
≠∂
.
u£_mm≠
 = 1;

273 
˘æ
->
≠∂
.
off£t
 = 
pcm
->appl.offset;

276 
˘æ
->
≠∂
.
u£_mm≠
 = 0;

277 
˘æ
->
≠∂
.
±r
 = 
pcm
->appl.ptr ? *pcm->appl.ptr : 0;

278 
lo›
 = 
pcm
->
≠∂
.
ma°î
;Üoop;Üoop =Üoop->appl.master)

279 
lo›
->
≠∂
.
±r
 = &
˘æ
->appl.ptr;

280 
pcm
->
≠∂
.
±r
 = &
˘æ
->appl.ptr;

281 
	}
}

283 
	$pcm_shm_›í
(
˛õ¡_t
 *
˛õ¡
, *
cookõ
)

285 
shmid
;

286 
¢d_pcm_t
 *
pcm
;

287 
îr
;

288 
ªsu…
;

289 
îr
 = 
	`¢d_pcm_›í
(&
pcm
, 
˛õ¡
->
«me
, clõ¡->
°ªam
, 
SND_PCM_NONBLOCK
);

290 i‡(
îr
 < 0)

291  
îr
;

292 
˛õ¡
->
devi˚
.
pcm
.
h™dÀ
 =Öcm;

293 
˛õ¡
->
devi˚
.
pcm
.
fd
 = 
	`_¢d_pcm_pﬁl_des¸ùt‹
(pcm);

294 
pcm
->
hw
.
¥iv©e_d©a
 = 
˛õ¡
;

295 
pcm
->
hw
.
ch™ged
 = 
pcm_shm_hw_±r_ch™ged
;

296 
pcm
->
≠∂
.
¥iv©e_d©a
 = 
˛õ¡
;

297 
pcm
->
≠∂
.
ch™ged
 = 
pcm_shm_≠∂_±r_ch™ged
;

299 
shmid
 = 
	`shmgë
(
IPC_PRIVATE
, 
PCM_SHM_SIZE
, 0666);

300 i‡(
shmid
 < 0) {

301 
ªsu…
 = -
î∫o
;

302 
	`SYSERROR
("shmget failed");

303 
_îr
;

305 
˛õ¡
->
å™•‹t
.
shm
.
˘æ_id
 = 
shmid
;

306 
˛õ¡
->
å™•‹t
.
shm
.
˘æ
 = 
	`shm©
(
shmid
, 0, 0);

307 i‡(
˛õ¡
->
å™•‹t
.
shm
.
˘æ
 == (*) -1) {

308 
ªsu…
 = -
î∫o
;

309 
	`shm˘l
(
shmid
, 
IPC_RMID
, 0);

310 
	`SYSERROR
("shmat failed");

311 
_îr
;

313 *
cookõ
 = 
shmid
;

316 
_îr
:

317 
	`¢d_pcm_˛o£
(
pcm
);

318  
ªsu…
;

320 
	}
}

322 
	$pcm_shm_˛o£
(
˛õ¡_t
 *
˛õ¡
)

324 
îr
;

325 
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
˛õ¡
->
å™•‹t
.
shm
.ctrl;

326 i‡(
˛õ¡
->
pﬁlög
) {

327 
	`dñ_waôî
(
˛õ¡
->
devi˚
.
pcm
.
fd
);

328 
˛õ¡
->
pﬁlög
 = 0;

330 
îr
 = 
	`¢d_pcm_˛o£
(
˛õ¡
->
devi˚
.
pcm
.
h™dÀ
);

331 
˘æ
->
ªsu…
 = 
îr
;

332 i‡(
îr
 < 0)

333 
	`ERROR
("snd_pcm_close");

334 i‡(
˛õ¡
->
å™•‹t
.
shm
.
˘æ
) {

335 
îr
 = 
	`shmdt
((*)
˛õ¡
->
å™•‹t
.
shm
.
˘æ
);

336 i‡(
îr
 < 0)

337 
	`SYSERROR
("shmdt failed");

338 
îr
 = 
	`shm˘l
(
˛õ¡
->
å™•‹t
.
shm
.
˘æ_id
, 
IPC_RMID
, 0);

339 i‡(
îr
 < 0)

340 
	`SYSERROR
("shmctl IPC_RMID failed");

341 
˛õ¡
->
å™•‹t
.
shm
.
˘æ
 = 0;

343 
˛õ¡
->
›í
 = 0;

345 
	}
}

347 
	$shm_ack
(
˛õ¡_t
 *
˛õ¡
)

349 
pﬁlfd
 
pfd
;

350 
îr
;

351 
buf
[1];

352 
pfd
.
fd
 = 
˛õ¡
->
˘æ_fd
;

353 
pfd
.
evíts
 = 
POLLHUP
;

354 i‡(
	`pﬁl
(&
pfd
, 1, 0) == 1)

355  -
EBADFD
;

356 
îr
 = 
	`wrôe
(
˛õ¡
->
˘æ_fd
, 
buf
, 1);

357 i‡(
îr
 != 1)

358  -
EBADFD
;

360 
	}
}

362 
	$shm_ack_fd
(
˛õ¡_t
 *
˛õ¡
, 
fd
)

364 
pﬁlfd
 
pfd
;

365 
îr
;

366 
buf
[1];

367 
pfd
.
fd
 = 
˛õ¡
->
˘æ_fd
;

368 
pfd
.
evíts
 = 
POLLHUP
;

369 i‡(
	`pﬁl
(&
pfd
, 1, 0) == 1)

370  -
EBADFD
;

371 
îr
 = 
	`¢d_£nd_fd
(
˛õ¡
->
˘æ_fd
, 
buf
, 1, 
fd
);

372 i‡(
îr
 != 1)

373  -
EBADFD
;

375 
	}
}

377 
	$shm_rb±r_fd
(
˛õ¡_t
 *
˛õ¡
, 
¢d_pcm_rb±r_t
 *
rb±r
)

379 i‡(
rb±r
->
fd
 < 0)

380  -
EINVAL
;

381  
	`shm_ack_fd
(
˛õ¡
, 
rb±r
->
fd
);

382 
	}
}

384 
	$async_h™dÀr
(
¢d_async_h™dÀr_t
 *
h™dÀr
)

386 
˛õ¡_t
 *
˛õ¡
 = 
	`¢d_async_h™dÀr_gë_ˇŒback_¥iv©e
(
h™dÀr
);

388 
	`kûl
(
˛õ¡
->
async_pid
, clõ¡->
async_sig
);

389 
	}
}

391 
	$pcm_shm_cmd
(
˛õ¡_t
 *
˛õ¡
)

393 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
˛õ¡
->
å™•‹t
.
shm
.ctrl;

394 
buf
[1];

395 
îr
;

396 
cmd
;

397 
¢d_pcm_t
 *
pcm
;

398 
îr
 = 
	`ªad
(
˛õ¡
->
˘æ_fd
, 
buf
, 1);

399 i‡(
îr
 != 1)

400  -
EBADFD
;

401 
cmd
 = 
˘æ
->cmd;

402 
˘æ
->
cmd
 = 0;

403 
pcm
 = 
˛õ¡
->
devi˚
.pcm.
h™dÀ
;

404 
cmd
) {

405 
SND_PCM_IOCTL_ASYNC
:

406 
˘æ
->
ªsu…
 = 
	`¢d_pcm_async
(
pcm
, cål->
u
.
async
.
sig
, cål->u.async.
pid
);

407 i‡(
˘æ
->
ªsu…
 < 0)

409 i‡(
˘æ
->
u
.
async
.
sig
 >= 0) {

410 
	`as£π
(
˛õ¡
->
async_sig
 < 0);

411 
˘æ
->
ªsu…
 = 
	`¢d_async_add_pcm_h™dÀr
(&
˛õ¡
->
async_h™dÀr
, 
pcm
,ásync_handler, client);

412 i‡(
˘æ
->
ªsu…
 < 0)

415 
	`as£π
(
˛õ¡
->
async_sig
 >= 0);

416 
	`¢d_async_dñ_h™dÀr
(
˛õ¡
->
async_h™dÀr
);

418 
˛õ¡
->
async_sig
 = 
˘æ
->
u
.
async
.
sig
;

419 
˛õ¡
->
async_pid
 = 
˘æ
->
u
.
async
.
pid
;

421 
SNDRV_PCM_IOCTL_INFO
:

422 
˘æ
->
ªsu…
 = 
	`¢d_pcm_öfo
(
pcm
, (
¢d_pcm_öfo_t
 *Ë&˘æ->
u
.
öfo
);

424 
SNDRV_PCM_IOCTL_HW_REFINE
:

425 
˘æ
->
ªsu…
 = 
	`¢d_pcm_hw_ªföe
(
pcm
, (
¢d_pcm_hw_∑øms_t
 *Ë&˘æ->
u
.
hw_ªföe
);

427 
SNDRV_PCM_IOCTL_HW_PARAMS
:

428 
˘æ
->
ªsu…
 = 
	`¢d_pcm_hw_∑øms
(
pcm
, (
¢d_pcm_hw_∑øms_t
 *Ë&˘æ->
u
.
hw_∑øms
);

430 
SNDRV_PCM_IOCTL_HW_FREE
:

431 
˘æ
->
ªsu…
 = 
	`¢d_pcm_hw_‰ì
(
pcm
);

433 
SNDRV_PCM_IOCTL_SW_PARAMS
:

434 
˘æ
->
ªsu…
 = 
	`¢d_pcm_sw_∑øms
(
pcm
, (
¢d_pcm_sw_∑øms_t
 *Ë&˘æ->
u
.
sw_∑øms
);

436 
SNDRV_PCM_IOCTL_STATUS
:

437 
˘æ
->
ªsu…
 = 
	`¢d_pcm_°©us
(
pcm
, (
¢d_pcm_°©us_t
 *Ë&˘æ->
u
.
°©us
);

439 
SND_PCM_IOCTL_STATE
:

440 
˘æ
->
ªsu…
 = 
	`¢d_pcm_°©e
(
pcm
);

442 
SND_PCM_IOCTL_HWSYNC
:

443 
˘æ
->
ªsu…
 = 
	`¢d_pcm_hwsync
(
pcm
);

445 
SNDRV_PCM_IOCTL_DELAY
:

446 
˘æ
->
ªsu…
 = 
	`¢d_pcm_dñay
(
pcm
, (
¢d_pcm_s‰ames_t
 *Ë&˘æ->
u
.
dñay
.
‰ames
);

448 
SND_PCM_IOCTL_AVAIL_UPDATE
:

449 
˘æ
->
ªsu…
 = 
	`¢d_pcm_avaû_upd©e
(
pcm
);

451 
SNDRV_PCM_IOCTL_PREPARE
:

452 
˘æ
->
ªsu…
 = 
	`¢d_pcm_¥ï¨e
(
pcm
);

454 
SNDRV_PCM_IOCTL_RESET
:

455 
˘æ
->
ªsu…
 = 
	`¢d_pcm_ª£t
(
pcm
);

457 
SNDRV_PCM_IOCTL_START
:

458 
˘æ
->
ªsu…
 = 
	`¢d_pcm_°¨t
(
pcm
);

460 
SNDRV_PCM_IOCTL_DRAIN
:

461 
˘æ
->
ªsu…
 = 
	`¢d_pcm_døö
(
pcm
);

463 
SNDRV_PCM_IOCTL_DROP
:

464 
˘æ
->
ªsu…
 = 
	`¢d_pcm_dr›
(
pcm
);

466 
SNDRV_PCM_IOCTL_PAUSE
:

467 
˘æ
->
ªsu…
 = 
	`¢d_pcm_∑u£
(
pcm
, cål->
u
.
∑u£
.
íabÀ
);

469 
SNDRV_PCM_IOCTL_CHANNEL_INFO
:

470 
˘æ
->
ªsu…
 = 
	`¢d_pcm_ch™√l_öfo
(
pcm
, (
¢d_pcm_ch™√l_öfo_t
 *Ë&˘æ->
u
.
ch™√l_öfo
);

471 i‡(
˘æ
->
ªsu…
 >= 0 &&

472 
˘æ
->
u
.
ch™√l_öfo
.
ty≥
 =
SND_PCM_AREA_MMAP
)

473  
	`shm_ack_fd
(
˛õ¡
, 
˘æ
->
u
.
ch™√l_öfo
.u.
mm≠
.
fd
);

475 
SNDRV_PCM_IOCTL_REWIND
:

476 
˘æ
->
ªsu…
 = 
	`¢d_pcm_ªwöd
(
pcm
, cål->
u
.
ªwöd
.
‰ames
);

478 
SND_PCM_IOCTL_FORWARD
:

479 
˘æ
->
ªsu…
 = 
	`¢d_pcm_f‹w¨d
(
pcm
, cål->
u
.
f‹w¨d
.
‰ames
);

481 
SNDRV_PCM_IOCTL_LINK
:

484 
˘æ
->
ªsu…
 = -
ENOSYS
;

487 
SNDRV_PCM_IOCTL_UNLINK
:

488 
˘æ
->
ªsu…
 = 
	`¢d_pcm_u∆ök
(
pcm
);

490 
SNDRV_PCM_IOCTL_RESUME
:

491 
˘æ
->
ªsu…
 = 
	`¢d_pcm_ªsume
(
pcm
);

493 
SND_PCM_IOCTL_MMAP
:

495 
˘æ
->
ªsu…
 = 
	`¢d_pcm_mm≠
(
pcm
);

498 
SND_PCM_IOCTL_MUNMAP
:

500 
˘æ
->
ªsu…
 = 
	`¢d_pcm_munm≠
(
pcm
);

503 
SND_PCM_IOCTL_MMAP_COMMIT
:

504 
˘æ
->
ªsu…
 = 
	`¢d_pcm_mm≠_commô
(
pcm
,

505 
˘æ
->
u
.
mm≠_commô
.
off£t
,

506 
˘æ
->
u
.
mm≠_commô
.
‰ames
);

508 
SND_PCM_IOCTL_POLL_DESCRIPTOR
:

509 
˘æ
->
ªsu…
 = 0;

510  
	`shm_ack_fd
(
˛õ¡
, 
	`_¢d_pcm_pﬁl_des¸ùt‹
(
pcm
));

511 
SND_PCM_IOCTL_CLOSE
:

512 
˛õ¡
->
›s
->
	`˛o£
(client);

514 
SND_PCM_IOCTL_HW_PTR_FD
:

515  
	`shm_rb±r_fd
(
˛õ¡
, &
pcm
->
hw
);

516 
SND_PCM_IOCTL_APPL_PTR_FD
:

517  
	`shm_rb±r_fd
(
˛õ¡
, &
pcm
->
≠∂
);

519 
	`ERROR
("Bogu†cmd: %x", 
˘æ
->
cmd
);

520 
˘æ
->
ªsu…
 = -
ENOSYS
;

522  
	`shm_ack
(
˛õ¡
);

523 
	}
}

525 
å™•‹t_›s_t
 
	gpcm_shm_›s
 = {

526 .
›í
 = 
pcm_shm_›í
,

527 .
	gcmd
 = 
pcm_shm_cmd
,

528 .
	g˛o£
 = 
pcm_shm_˛o£
,

531 
	$˘l_h™dÀr
(
waôî_t
 *
waôî
, 
evíts
)

533 
˛õ¡_t
 *
˛õ¡
 = 
waôî
->
¥iv©e_d©a
;

534 
buf
[1] = "";

535 
ssize_t
 
n
;

536 i‡(
evíts
 & 
POLLIN
) {

537 
n
 = 
	`wrôe
(
˛õ¡
->
pﬁl_fd
, 
buf
, 1);

538 i‡(
n
 != 1) {

539 
	`SYSERROR
("write failed");

540  -
î∫o
;

543 
	`dñ_waôî
(
waôî
->
fd
);

544 
˛õ¡
->
pﬁlög
 = 0;

546 
	}
}

548 
	$˘l_shm_›í
(
˛õ¡_t
 *
˛õ¡
, *
cookõ
)

550 
shmid
;

551 
¢d_˘l_t
 *
˘l
;

552 
îr
;

553 
ªsu…
;

554 
îr
 = 
	`¢d_˘l_›í
(&
˘l
, 
˛õ¡
->
«me
, 
SND_CTL_NONBLOCK
);

555 i‡(
îr
 < 0)

556  
îr
;

557 
˛õ¡
->
devi˚
.
˘l
.
h™dÀ
 = ctl;

558 
˛õ¡
->
devi˚
.
˘l
.
fd
 = 
	`_¢d_˘l_pﬁl_des¸ùt‹
(ctl);

560 
shmid
 = 
	`shmgë
(
IPC_PRIVATE
, 
CTL_SHM_SIZE
, 0666);

561 i‡(
shmid
 < 0) {

562 
ªsu…
 = -
î∫o
;

563 
	`SYSERROR
("shmget failed");

564 
_îr
;

566 
˛õ¡
->
å™•‹t
.
shm
.
˘æ_id
 = 
shmid
;

567 
˛õ¡
->
å™•‹t
.
shm
.
˘æ
 = 
	`shm©
(
shmid
, 0, 0);

568 i‡(!
˛õ¡
->
å™•‹t
.
shm
.
˘æ
) {

569 
ªsu…
 = -
î∫o
;

570 
	`shm˘l
(
shmid
, 
IPC_RMID
, 0);

571 
	`SYSERROR
("shmat failed");

572 
_îr
;

574 *
cookõ
 = 
shmid
;

575 
	`add_waôî
(
˛õ¡
->
devi˚
.
˘l
.
fd
, 
POLLIN
, 
˘l_h™dÀr
, client);

576 
˛õ¡
->
pﬁlög
 = 1;

579 
_îr
:

580 
	`¢d_˘l_˛o£
(
˘l
);

581  
ªsu…
;

583 
	}
}

585 
	$˘l_shm_˛o£
(
˛õ¡_t
 *
˛õ¡
)

587 
îr
;

588 
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
˛õ¡
->
å™•‹t
.
shm
.ctrl;

589 i‡(
˛õ¡
->
pﬁlög
) {

590 
	`dñ_waôî
(
˛õ¡
->
devi˚
.
˘l
.
fd
);

591 
˛õ¡
->
pﬁlög
 = 0;

593 
îr
 = 
	`¢d_˘l_˛o£
(
˛õ¡
->
devi˚
.
˘l
.
h™dÀ
);

594 
˘æ
->
ªsu…
 = 
îr
;

595 i‡(
îr
 < 0)

596 
	`ERROR
("snd_ctl_close");

597 i‡(
˛õ¡
->
å™•‹t
.
shm
.
˘æ
) {

598 
îr
 = 
	`shmdt
((*)
˛õ¡
->
å™•‹t
.
shm
.
˘æ
);

599 i‡(
îr
 < 0)

600 
	`SYSERROR
("shmdt failed");

601 
îr
 = 
	`shm˘l
(
˛õ¡
->
å™•‹t
.
shm
.
˘æ_id
, 
IPC_RMID
, 0);

602 i‡(
îr
 < 0)

603 
	`SYSERROR
("shmctl failed");

604 
˛õ¡
->
å™•‹t
.
shm
.
˘æ
 = 0;

606 
˛õ¡
->
›í
 = 0;

608 
	}
}

610 
	$˘l_shm_cmd
(
˛õ¡_t
 *
˛õ¡
)

612 
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
˛õ¡
->
å™•‹t
.
shm
.ctrl;

613 
buf
[1];

614 
îr
;

615 
cmd
;

616 
¢d_˘l_t
 *
˘l
;

617 
îr
 = 
	`ªad
(
˛õ¡
->
˘æ_fd
, 
buf
, 1);

618 i‡(
îr
 != 1)

619  -
EBADFD
;

620 
cmd
 = 
˘æ
->cmd;

621 
˘æ
->
cmd
 = 0;

622 
˘l
 = 
˛õ¡
->
devi˚
.˘l.
h™dÀ
;

623 
cmd
) {

624 
SND_CTL_IOCTL_ASYNC
:

625 
˘æ
->
ªsu…
 = 
	`¢d_˘l_async
(
˘l
, cål->
u
.
async
.
sig
, cål->u.async.
pid
);

626 i‡(
˘æ
->
ªsu…
 < 0)

628 i‡(
˘æ
->
u
.
async
.
sig
 >= 0) {

629 
	`as£π
(
˛õ¡
->
async_sig
 < 0);

630 
˘æ
->
ªsu…
 = 
	`¢d_async_add_˘l_h™dÀr
(&
˛õ¡
->
async_h™dÀr
, 
˘l
,ásync_handler, client);

631 i‡(
˘æ
->
ªsu…
 < 0)

634 
	`as£π
(
˛õ¡
->
async_sig
 >= 0);

635 
	`¢d_async_dñ_h™dÀr
(
˛õ¡
->
async_h™dÀr
);

637 
˛õ¡
->
async_sig
 = 
˘æ
->
u
.
async
.
sig
;

638 
˛õ¡
->
async_pid
 = 
˘æ
->
u
.
async
.
pid
;

641 
SNDRV_CTL_IOCTL_SUBSCRIBE_EVENTS
:

642 
˘æ
->
ªsu…
 = 
	`¢d_˘l_subs¸ibe_evíts
(
˘l
, cål->
u
.
subs¸ibe_evíts
);

644 
SNDRV_CTL_IOCTL_CARD_INFO
:

645 
˘æ
->
ªsu…
 = 
	`¢d_˘l_ˇrd_öfo
(
˘l
, &˘æ->
u
.
ˇrd_öfo
);

647 
SNDRV_CTL_IOCTL_ELEM_LIST
:

649 
size_t
 
maxsize
 = 
CTL_SHM_DATA_MAXLEN
;

650 i‡(
˘æ
->
u
.
ñemít_li°
.
•a˚
 * (*˘æ->u.ñemít_li°.
pids
Ë> 
maxsize
) {

651 
˘æ
->
ªsu…
 = -
EFAULT
;

654 
˘æ
->
u
.
ñemít_li°
.
pids
 = (
¢d_˘l_ñem_id_t
*Ë˘æ->
d©a
;

655 
˘æ
->
ªsu…
 = 
	`¢d_˘l_ñem_li°
(
˘l
, &˘æ->
u
.
ñemít_li°
);

658 
SNDRV_CTL_IOCTL_ELEM_INFO
:

659 
˘æ
->
ªsu…
 = 
	`¢d_˘l_ñem_öfo
(
˘l
, &˘æ->
u
.
ñemít_öfo
);

661 
SNDRV_CTL_IOCTL_ELEM_READ
:

662 
˘æ
->
ªsu…
 = 
	`¢d_˘l_ñem_ªad
(
˘l
, &˘æ->
u
.
ñemít_ªad
);

664 
SNDRV_CTL_IOCTL_ELEM_WRITE
:

665 
˘æ
->
ªsu…
 = 
	`¢d_˘l_ñem_wrôe
(
˘l
, &˘æ->
u
.
ñemít_wrôe
);

667 
SNDRV_CTL_IOCTL_ELEM_LOCK
:

668 
˘æ
->
ªsu…
 = 
	`¢d_˘l_ñem_lock
(
˘l
, &˘æ->
u
.
ñemít_lock
);

670 
SNDRV_CTL_IOCTL_ELEM_UNLOCK
:

671 
˘æ
->
ªsu…
 = 
	`¢d_˘l_ñem_u∆ock
(
˘l
, &˘æ->
u
.
ñemít_u∆ock
);

673 
SNDRV_CTL_IOCTL_HWDEP_NEXT_DEVICE
:

674 
˘æ
->
ªsu…
 = 
	`¢d_˘l_hwdï_√xt_devi˚
(
˘l
, &˘æ->
u
.
devi˚
);

676 
SNDRV_CTL_IOCTL_HWDEP_INFO
:

677 
˘æ
->
ªsu…
 = 
	`¢d_˘l_hwdï_öfo
(
˘l
, &˘æ->
u
.
hwdï_öfo
);

679 
SNDRV_CTL_IOCTL_PCM_NEXT_DEVICE
:

680 
˘æ
->
ªsu…
 = 
	`¢d_˘l_pcm_√xt_devi˚
(
˘l
, &˘æ->
u
.
devi˚
);

682 
SNDRV_CTL_IOCTL_PCM_INFO
:

683 
˘æ
->
ªsu…
 = 
	`¢d_˘l_pcm_öfo
(
˘l
, &˘æ->
u
.
pcm_öfo
);

685 
SNDRV_CTL_IOCTL_PCM_PREFER_SUBDEVICE
:

686 
˘æ
->
ªsu…
 = 
	`¢d_˘l_pcm_¥e„r_subdevi˚
(
˘l
, cål->
u
.
pcm_¥e„r_subdevi˚
);

688 
SNDRV_CTL_IOCTL_RAWMIDI_NEXT_DEVICE
:

689 
˘æ
->
ªsu…
 = 
	`¢d_˘l_øwmidi_√xt_devi˚
(
˘l
, &˘æ->
u
.
devi˚
);

691 
SNDRV_CTL_IOCTL_RAWMIDI_INFO
:

692 
˘æ
->
ªsu…
 = 
	`¢d_˘l_øwmidi_öfo
(
˘l
, &˘æ->
u
.
øwmidi_öfo
);

694 
SNDRV_CTL_IOCTL_RAWMIDI_PREFER_SUBDEVICE
:

695 
˘æ
->
ªsu…
 = 
	`¢d_˘l_øwmidi_¥e„r_subdevi˚
(
˘l
, cål->
u
.
øwmidi_¥e„r_subdevi˚
);

697 
SNDRV_CTL_IOCTL_POWER
:

698 
˘æ
->
ªsu…
 = 
	`¢d_˘l_£t_powî_°©e
(
˘l
, cål->
u
.
powî_°©e
);

700 
SNDRV_CTL_IOCTL_POWER_STATE
:

701 
˘æ
->
ªsu…
 = 
	`¢d_˘l_gë_powî_°©e
(
˘l
, &˘æ->
u
.
powî_°©e
);

703 
SND_CTL_IOCTL_READ
:

704 
˘æ
->
ªsu…
 = 
	`¢d_˘l_ªad
(
˘l
, &˘æ->
u
.
ªad
);

706 
SND_CTL_IOCTL_CLOSE
:

707 
˛õ¡
->
›s
->
	`˛o£
(client);

709 
SND_CTL_IOCTL_POLL_DESCRIPTOR
:

710 
˘æ
->
ªsu…
 = 0;

711  
	`shm_ack_fd
(
˛õ¡
, 
	`_¢d_˘l_pﬁl_des¸ùt‹
(
˘l
));

713 
	`ERROR
("Bogu†cmd: %x", 
˘æ
->
cmd
);

714 
˘æ
->
ªsu…
 = -
ENOSYS
;

716  
	`shm_ack
(
˛õ¡
);

717 
	}
}

719 
å™•‹t_›s_t
 
	g˘l_shm_›s
 = {

720 .
›í
 = 
˘l_shm_›í
,

721 .
	gcmd
 = 
˘l_shm_cmd
,

722 .
	g˛o£
 = 
˘l_shm_˛o£
,

725 
	$¢d_˛õ¡_›í
(
˛õ¡_t
 *
˛õ¡
)

727 
îr
;

728 
¢d_˛õ¡_›í_ªque°_t
 
ªq
;

729 
¢d_˛õ¡_›í_™swî_t
 
™s
;

730 *
«me
;

731 
	`mem£t
(&
™s
, 0, (ans));

732 
îr
 = 
	`ªad
(
˛õ¡
->
˘æ_fd
, &
ªq
, (req));

733 i‡(
îr
 < 0) {

734 
	`SYSERROR
("read failed");

735 
	`exô
(1);

737 i‡(
îr
 !(
ªq
)) {

738 
™s
.
ªsu…
 = -
EINVAL
;

739 
_™swî
;

741 
«me
 = 
	`Æloˇ
(
ªq
.
«mñí
 + 1);

742 
îr
 = 
	`ªad
(
˛õ¡
->
˘æ_fd
, 
«me
, 
ªq
.
«mñí
);

743 i‡(
îr
 < 0) {

744 
	`SYSERROR
("read failed");

745 
	`exô
(1);

747 i‡(
îr
 !
ªq
.
«mñí
) {

748 
™s
.
ªsu…
 = -
EINVAL
;

749 
_™swî
;

752 
ªq
.
å™•‹t_ty≥
) {

753 
SND_TRANSPORT_TYPE_SHM
:

754 i‡(!
˛õ¡
->
loˇl
) {

755 
™s
.
ªsu…
 = -
EINVAL
;

756 
_™swî
;

758 
ªq
.
dev_ty≥
) {

759 
SND_DEV_TYPE_PCM
:

760 
˛õ¡
->
›s
 = &
pcm_shm_›s
;

762 
SND_DEV_TYPE_CONTROL
:

763 
˛õ¡
->
›s
 = &
˘l_shm_›s
;

766 
™s
.
ªsu…
 = -
EINVAL
;

767 
_™swî
;

771 
™s
.
ªsu…
 = -
EINVAL
;

772 
_™swî
;

775 
«me
[
ªq
.
«mñí
] = '\0';

777 
˛õ¡
->
å™•‹t_ty≥
 = 
ªq
.transport_type;

778 i‡((
˛õ¡
->
«me
Ë< (
size_t
)(
ªq
.
«mñí
 + 1)) {

779 
™s
.
ªsu…
 = -
ENOMEM
;

780 
_™swî
;

782 
	`°r˝y
(
˛õ¡
->
«me
,Çame);

783 
˛õ¡
->
°ªam
 = 
ªq
.stream;

784 
˛õ¡
->
mode
 = 
ªq
.mode;

786 
îr
 = 
˛õ¡
->
›s
->
	`›í
(˛õ¡, &
™s
.
cookõ
);

787 i‡(
îr
 < 0) {

788 
™s
.
ªsu…
 = 
îr
;

790 
˛õ¡
->
›í
 = 1;

791 
™s
.
ªsu…
 = 0;

794 
_™swî
:

795 
îr
 = 
	`wrôe
(
˛õ¡
->
˘æ_fd
, &
™s
, (ans));

796 i‡(
îr
 !(
™s
)) {

797 
	`SYSERROR
("write failed");

798 
	`exô
(1);

801 
	}
}

803 
	$˛õ¡_pﬁl_h™dÀr
(
waôî_t
 *
waôî
, 
evíts
 
ATTRIBUTE_UNUSED
)

805 
˛õ¡_t
 *
˛õ¡
 = 
waôî
->
¥iv©e_d©a
;

806 i‡(
˛õ¡
->
›í
)

807 
˛õ¡
->
›s
->
	`˛o£
(client);

808 
	`˛o£
(
˛õ¡
->
pﬁl_fd
);

809 
	`˛o£
(
˛õ¡
->
˘æ_fd
);

810 
	`dñ_waôî
(
˛õ¡
->
pﬁl_fd
);

811 
	`dñ_waôî
(
˛õ¡
->
˘æ_fd
);

812 
	`li°_dñ
(&
˛õ¡
->
li°
);

813 
	`‰ì
(
˛õ¡
);

815 
	}
}

817 
	$˛õ¡_˘æ_h™dÀr
(
waôî_t
 *
waôî
, 
evíts
)

819 
˛õ¡_t
 *
˛õ¡
 = 
waôî
->
¥iv©e_d©a
;

820 i‡(
evíts
 & 
POLLHUP
) {

821 i‡(
˛õ¡
->
›í
)

822 
˛õ¡
->
›s
->
	`˛o£
(client);

823 
	`˛o£
(
˛õ¡
->
˘æ_fd
);

824 
	`dñ_waôî
(
˛õ¡
->
˘æ_fd
);

825 
	`li°_dñ
(&
˛õ¡
->
li°
);

826 
	`‰ì
(
˛õ¡
);

829 i‡(
˛õ¡
->
›í
)

830  
˛õ¡
->
›s
->
	`cmd
(client);

832  
	`¢d_˛õ¡_›í
(
˛õ¡
);

833 
	}
}

835 
	$öë_≥ndög_h™dÀr
(
waôî_t
 *
waôî
, 
evíts
)

837 
öë_≥ndög_t
 *
≥ndög
 = 
waôî
->
¥iv©e_d©a
;

838 
öë_≥ndög_t
 *
pd©a
;

839 
˛õ¡_t
 *
˛õ¡
;

840 
uöt32_t
 
cookõ
;

841 
li°_hód
 *
ôem
;

842 
ªmove
 = 0;

843 i‡(
evíts
 & 
POLLHUP
)

844 
ªmove
 = 1;

846 
îr
 = 
	`ªad
(
waôî
->
fd
, &
cookõ
, (cookie));

847 i‡(
îr
 !(
cookõ
))

848 
ªmove
 = 1;

850 
îr
 = 
	`wrôe
(
waôî
->
fd
, &
cookõ
, (cookie));

851 i‡(
îr
 !(
cookõ
))

852 
ªmove
 = 1;

855 
	`dñ_waôî
(
waôî
->
fd
);

856 i‡(
ªmove
) {

857 
	`˛o£
(
waôî
->
fd
);

858 
	`li°_dñ
(&
≥ndög
->
li°
);

859 
	`‰ì
(
≥ndög
);

863 
	`li°_f‹_óch
(
ôem
, &
öë_≥ndögs
) {

864 
pd©a
 = 
	`li°_íåy
(
ôem
, 
öë_≥ndög_t
, 
li°
);

865 i‡(
pd©a
->
cookõ
 == cookie)

866 
found
;

868 
≥ndög
->
cookõ
 = cookie;

871 
found
:

872 
˛õ¡
 = 
	`ˇŒoc
(1, (*client));

873 
˛õ¡
->
loˇl
 = 0;

874 
˛õ¡
->
pﬁl_fd
 = 
pd©a
->
fd
;

875 
˛õ¡
->
˘æ_fd
 = 
waôî
->
fd
;

876 
	`add_waôî
(
˛õ¡
->
˘æ_fd
, 
POLLIN
 | 
POLLHUP
, 
˛õ¡_˘æ_h™dÀr
, client);

877 
	`add_waôî
(
˛õ¡
->
pﬁl_fd
, 
POLLHUP
, 
˛õ¡_pﬁl_h™dÀr
, client);

878 
˛õ¡
->
›í
 = 0;

879 
	`li°_add_èû
(&
˛õ¡
->
li°
, &
˛õ¡s
);

880 
	`li°_dñ
(&
≥ndög
->
li°
);

881 
	`li°_dñ
(&
pd©a
->
li°
);

882 
	`‰ì
(
≥ndög
);

883 
	`‰ì
(
pd©a
);

885 
	}
}

887 
	$loˇl_h™dÀr
(
waôî_t
 *
waôî
, 
evíts
 
ATTRIBUTE_UNUSED
)

889 
sock
;

890 
sock
 = 
	`ac˚±
(
waôî
->
fd
, 0, 0);

891 i‡(
sock
 < 0) {

892 
ªsu…
 = -
î∫o
;

893 
	`SYSERROR
("accept failed");

894  
ªsu…
;

896 
˛õ¡_t
 *
˛õ¡
 = 
	`ˇŒoc
(1, (*client));

897 
˛õ¡
->
˘æ_fd
 = 
sock
;

898 
˛õ¡
->
loˇl
 = 1;

899 
˛õ¡
->
›í
 = 0;

900 
	`add_waôî
(
sock
, 
POLLIN
 | 
POLLHUP
, 
˛õ¡_˘æ_h™dÀr
, 
˛õ¡
);

901 
	`li°_add_èû
(&
˛õ¡
->
li°
, &
˛õ¡s
);

904 
	}
}

906 
	$öë_h™dÀr
(
waôî_t
 *
waôî
, 
evíts
 
ATTRIBUTE_UNUSED
)

908 
sock
;

909 
sock
 = 
	`ac˚±
(
waôî
->
fd
, 0, 0);

910 i‡(
sock
 < 0) {

911 
ªsu…
 = -
î∫o
;

912 
	`SYSERROR
("accept failed");

913  
ªsu…
;

915 
öë_≥ndög_t
 *
≥ndög
 = 
	`ˇŒoc
(1, (*pending));

916 
≥ndög
->
fd
 = 
sock
;

917 
≥ndög
->
cookõ
 = 0;

918 
	`add_waôî
(
sock
, 
POLLIN
, 
öë_≥ndög_h™dÀr
, 
≥ndög
);

919 
	`li°_add_èû
(&
≥ndög
->
li°
, &
öë_≥ndögs
);

922 
	}
}

924 
	$£rvî
(c⁄° *
sock«me
, 
p‹t
)

926 
îr
, 
ªsu…
, 
sockn
 = -1, 
socki
 = -1;

927 
k
;

928 
›í_max
;

930 i‡(!
sock«me
 && 
p‹t
 < 0)

931  -
EINVAL
;

932 
›í_max
 = 
	`sysc⁄f
(
_SC_OPEN_MAX
);

933 i‡(
›í_max
 < 0) {

934 
ªsu…
 = -
î∫o
;

935 
	`SYSERROR
("sysconf failed");

936  
ªsu…
;

938 
pﬁlfds
 = 
	`ˇŒoc
((
size_t
Ë
›í_max
, (*pollfds));

939 
waôîs
 = 
	`ˇŒoc
((
size_t
Ë
›í_max
, (*waiters));

941 i‡(
sock«me
) {

942 
sockn
 = 
	`make_loˇl_sockë
(
sock«me
);

943 i‡(
sockn
 < 0)

944  
sockn
;

945 i‡(
	`f˙é
(
sockn
, 
F_SETFL
, 
O_NONBLOCK
) < 0) {

946 
ªsu…
 = -
î∫o
;

947 
	`SYSERROR
("fcntl O_NONBLOCK failed");

948 
_íd
;

950 i‡(
	`li°í
(
sockn
, 4) < 0) {

951 
ªsu…
 = -
î∫o
;

952 
	`SYSERROR
("listen failed");

953 
_íd
;

955 
	`add_waôî
(
sockn
, 
POLLIN
, 
loˇl_h™dÀr
, 
NULL
);

957 i‡(
p‹t
 >= 0) {

958 
socki
 = 
	`make_öë_sockë
(
p‹t
);

959 i‡(
socki
 < 0)

960  
socki
;

961 i‡(
	`f˙é
(
socki
, 
F_SETFL
, 
O_NONBLOCK
) < 0) {

962 
ªsu…
 = -
î∫o
;

963 
	`SYSERROR
("fcntl failed");

964 
_íd
;

966 i‡(
	`li°í
(
socki
, 4) < 0) {

967 
ªsu…
 = -
î∫o
;

968 
	`SYSERROR
("listen failed");

969 
_íd
;

971 
	`add_waôî
(
socki
, 
POLLIN
, 
öë_h™dÀr
, 
NULL
);

975 
pﬁlfd
 
pfds
[
›í_max
];

976 
size_t
 
pfds_cou¡
;

978 
îr
 = 
	`pﬁl
(
pﬁlfds
, 
pﬁlfds_cou¡
, -1);

979 } 
îr
 == 0);

980 i‡(
îr
 < 0) {

981 
	`SYSERROR
("poll failed");

985 
pfds_cou¡
 = 
pﬁlfds_cou¡
;

986 
	`mem˝y
(
pfds
, 
pﬁlfds
, (*pfdsË* 
pfds_cou¡
);

987 
k
 = 0; k < 
pfds_cou¡
; k++) {

988 
pﬁlfd
 *
pfd
 = &
pfds
[
k
];

989 i‡(
pfd
->
ªvíts
) {

990 
waôî_t
 *
w
 = &
waôîs
[
pfd
->
fd
];

991 i‡(!
w
->
h™dÀr
)

993 
îr
 = 
w
->
	`h™dÀr
(w, 
pfd
->
ªvíts
);

994 i‡(
îr
 < 0)

995 
	`ERROR
("waiter handler failed");

999 
_íd
:

1000 i‡(
sockn
 >= 0)

1001 
	`˛o£
(
sockn
);

1002 i‡(
socki
 >= 0)

1003 
	`˛o£
(
socki
);

1004 
	`‰ì
(
pﬁlfds
);

1005 
	`‰ì
(
waôîs
);

1006  
ªsu…
;

1007 
	}
}

1010 
	$ußge
()

1012 
	`Ârötf
(
°dîr
,

1015 
comm™d
);

1016 
	}
}

1018 
	$maö
(
¨gc
, **
¨gv
)

1020 c⁄° 
›ti⁄
 
l⁄g_›ti⁄s
[] = {

1024 
c
;

1025 
¢d_c⁄fig_t
 *
c⁄f
;

1026 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1027 c⁄° *
sock«me
 = 
NULL
;

1028 
p‹t
 = -1;

1029 
îr
;

1030 *
§v«me
;

1032 
comm™d
 = 
¨gv
[0];

1033 (
c
 = 
	`gë›t_l⁄g
(
¨gc
, 
¨gv
, "h", 
l⁄g_›ti⁄s
, 0)) != -1) {

1034 
c
) {

1036 
	`ußge
();

1039 
	`Ârötf
(
°dîr
, "Try `%†--hñp' f‹ m‹êöf‹m©i⁄\n", 
comm™d
);

1043 i‡(
¨gc
 - 
›töd
 != 1) {

1044 
	`ERROR
("youÇeedÅo specify serverÇame");

1047 
îr
 = 
	`¢d_c⁄fig_upd©e
();

1048 i‡(
îr
 < 0) {

1049 
	`ERROR
("cannotÑead configuration file");

1052 
§v«me
 = 
¨gv
[
›töd
];

1053 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
¢d_c⁄fig
, "£rvî", 
§v«me
, &
c⁄f
);

1054 i‡(
îr
 < 0) {

1055 
	`ERROR
("Missög deföôi⁄ f‹ sîvî %s", 
§v«me
);

1058 i‡(
	`¢d_c⁄fig_gë_ty≥
(
c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1059 
	`SNDERR
("InvÆidÅy≥ f‹ sîvî %†deföôi⁄", 
§v«me
);

1060  -
EINVAL
;

1062 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1063 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1064 c⁄° *
id
;

1065 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1067 i‡(
	`°rcmp
(
id
, "comment") == 0)

1069 i‡(
	`°rcmp
(
id
, "host") == 0)

1071 i‡(
	`°rcmp
(
id
, "socket") == 0) {

1072 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
sock«me
);

1073 i‡(
îr
 < 0) {

1074 
	`ERROR
("InvÆidÅy≥ f‹ %s", 
id
);

1079 i‡(
	`°rcmp
(
id
, "port") == 0) {

1080 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
p‹t
);

1081 i‡(
îr
 < 0) {

1082 
	`ERROR
("InvÆidÅy≥ f‹ %s", 
id
);

1087 
	`ERROR
("Unknow¿fõld %s", 
id
);

1090 i‡(!
sock«me
 && 
p‹t
 < 0) {

1091 
	`ERROR
("either socket orÖortÇeedÅo be defined");

1094 
	`£rvî
(
sock«me
, 
p‹t
);

1096 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/alisp.h

22 
	sÆi•_cfg
 {

23 
	mvîbo£
: 1,

24 
	mw¨nög
: 1,

25 
	mdebug
: 1;

26 
¢d_öput_t
 *
	mö
;

27 
¢d_ouçut_t
 *
	mout
;

28 
¢d_ouçut_t
 *
	meout
;

29 
¢d_ouçut_t
 *
	mvout
;

30 
¢d_ouçut_t
 *
	mwout
;

31 
¢d_ouçut_t
 *
	mdout
;

34 
	gÆi•_ö°™˚
;

35 
	gÆi•_obje˘
;

36 
	gÆi•_£q_ôî©‹
;

38 
Æi•_cfg
 *
Æß_li•_deÁu…_cfg
(
¢d_öput_t
 *
öput
);

39 
Æß_li•_deÁu…_cfg_‰ì
(
Æi•_cfg
 *
cfg
);

40 
Æß_li•
(
Æi•_cfg
 *
cfg
, 
Æi•_ö°™˚
 **
ö°™˚
);

41 
Æß_li•_‰ì
(
Æi•_ö°™˚
 *
ö°™˚
);

42 
	$Æß_li•_fun˘i⁄
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_£q_ôî©‹
 **
ªsu…
,

43 c⁄° *
id
, c⁄° *
¨gs
, ...)

44 #i‚de‡
DOC_HIDDEN


45 
	`__©åibuã__
 ((
	$f‹m©
 (
¥ötf
, 4, 5)))

48 
	`Æß_li•_ªsu…_‰ì
(
Æi•_ö°™˚
 *
ö°™˚
,

49 
Æi•_£q_ôî©‹
 *
ªsu…
);

50 
	`Æß_li•_£q_fú°
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
id
,

51 
Æi•_£q_ôî©‹
 **
£q
);

52 
	`Æß_li•_£q_√xt
(
Æi•_£q_ôî©‹
 **
£q
);

53 
	`Æß_li•_£q_cou¡
(
Æi•_£q_ôî©‹
 *
£q
);

54 
	`Æß_li•_£q_öãgî
(
Æi•_£q_ôî©‹
 *
£q
, *
vÆ
);

55 
	`Æß_li•_£q_poöãr
(
Æi•_£q_ôî©‹
 *
£q
, c⁄° *
±r_id
, **
±r
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/alsa-symbols.h

22 #i‚de‡
__ALSA_SYMBOLS_H


23 
	#__ALSA_SYMBOLS_H


	)

25 #i‡
deföed
(
PIC
Ë&& deföed(
VERSIONED_SYMBOLS
)

26 
	#USE_VERSIONED_SYMBOLS


	)

29 
	#INTERNAL_CONCAT2_2
(
Pª
, 
Po°
ËPª##
	)
Post

30 
	#INTERNAL
(
Name
Ë
	`INTERNAL_CONCAT2_2
(
__
, Name)

	)

32 #i‡
HAVE_ATTRIBUTE_SYMVER
 && 
__GNUC__
 > 10

33 
	#symbﬁ_vîsi⁄
(
ªÆ
, 
«me
, 
vîsi⁄
) \

34 
	`__ty≥of
 (
ªÆ
ËªÆ 
	`__©åibuã__
((
	`symvî
 (#«mê"@" #vîsi⁄)))

	)

35 
	#deÁu…_symbﬁ_vîsi⁄
(
ªÆ
, 
«me
, 
vîsi⁄
) \

36 
	`__ty≥of
 (
ªÆ
ËªÆ 
	`__©åibuã__
((
	`symvî
 (#«mê"@@" #vîsi⁄)))

	)

38 
	#symbﬁ_vîsi⁄
(
ªÆ
, 
«me
, 
vîsi⁄
) \

39 
	`__asm__
 (".symvî " 
	`ASM_NAME
(#ªÆË"," ASM_NAME(#«meË"@" #vîsi⁄)

	)

40 
	#deÁu…_symbﬁ_vîsi⁄
(
ªÆ
, 
«me
, 
vîsi⁄
) \

41 
	`__asm__
 (".symvî " 
	`ASM_NAME
(#ªÆË"," ASM_NAME(#«meË"@@" #vîsi⁄)

	)

44 #ifde‡
__˛™g__


45 
	#EXPORT_SYMBOL
 
	`__©åibuã__
((
	`visibûôy
("deÁu…")))

	)

47 
	#EXPORT_SYMBOL
 
	`__©åibuã__
((
	`visibûôy
("deÁu…"),
exã∫Æly_visibÀ
))

	)

50 #ifde‡
USE_VERSIONED_SYMBOLS


51 
	#u£_symbﬁ_vîsi⁄
(
ªÆ
, 
«me
, 
vîsi⁄
) \

52 
	`symbﬁ_vîsi⁄
(
ªÆ
, 
«me
, 
vîsi⁄
)

	)

53 
	#u£_deÁu…_symbﬁ_vîsi⁄
(
ªÆ
, 
«me
, 
vîsi⁄
) \

54 
	`deÁu…_symbﬁ_vîsi⁄
(
ªÆ
, 
«me
, 
vîsi⁄
)

	)

56 
	#u£_symbﬁ_vîsi⁄
(
ªÆ
, 
«me
, 
vîsi⁄
Ë

	)

57 #i‡
deföed
(
__Æpha__
Ë|| deföed(
__mùs__
)

58 
	#u£_deÁu…_symbﬁ_vîsi⁄
(
ªÆ
, 
«me
, 
vîsi⁄
) \

59 
	`__asm__
 (".wók " 
	`ASM_NAME
(#name)); \

60 
	`__asm__
 (
	`ASM_NAME
(#«meË" = " ASM_NAME(#ªÆ))

	)

62 
	#u£_deÁu…_symbﬁ_vîsi⁄
(
ªÆ
, 
«me
, 
vîsi⁄
) \

63 
	`__asm__
 (".wók " 
	`ASM_NAME
(#name)); \

64 
	`__asm__
 (".£à" 
	`ASM_NAME
(#«meË"," ASM_NAME(#ªÆ))

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/aserver.h

21 
	~"../§c/pcm/pcm_loˇl.h
"

22 
	~"../§c/c⁄åﬁ/c⁄åﬁ_loˇl.h
"

23 
	~<√tdb.h
>

25 
¢d_ª˚ive_fd
(
sock
, *
d©a
, 
size_t
 
Àn
, *
fd
);

27 
	e_¢d_dev_ty≥
 {

28 
	mSND_DEV_TYPE_PCM
,

29 
	mSND_DEV_TYPE_CONTROL
,

30 
	mSND_DEV_TYPE_RAWMIDI
,

31 
	mSND_DEV_TYPE_TIMER
,

32 
	mSND_DEV_TYPE_HWDEP
,

33 
	mSND_DEV_TYPE_SEQ
,

34 } 
	t¢d_dev_ty≥_t
;

36 
	e_¢d_å™•‹t_ty≥
 {

37 
	mSND_TRANSPORT_TYPE_SHM
,

38 
	mSND_TRANSPORT_TYPE_TCP
,

39 } 
	t¢d_å™•‹t_ty≥_t
;

41 
	#SND_PCM_IOCTL_HWSYNC
 
	`_IO
 ('A', 0x22)

	)

42 
	#SND_PCM_IOCTL_STATE
 
	`_IO
 ('A', 0xf1)

	)

43 
	#SND_PCM_IOCTL_MMAP
 
	`_IO
 ('A', 0xf2)

	)

44 
	#SND_PCM_IOCTL_MUNMAP
 
	`_IO
 ('A', 0xf3)

	)

45 
	#SND_PCM_IOCTL_MMAP_COMMIT
 
	`_IO
 ('A', 0xf4)

	)

46 
	#SND_PCM_IOCTL_AVAIL_UPDATE
 
	`_IO
 ('A', 0xf5)

	)

47 
	#SND_PCM_IOCTL_ASYNC
 
	`_IO
 ('A', 0xf6)

	)

48 
	#SND_PCM_IOCTL_CLOSE
 
	`_IO
 ('A', 0xf7)

	)

49 
	#SND_PCM_IOCTL_POLL_DESCRIPTOR
 
	`_IO
 ('A', 0xf8)

	)

50 
	#SND_PCM_IOCTL_HW_PTR_FD
 
	`_IO
 ('A', 0xf9)

	)

51 
	#SND_PCM_IOCTL_APPL_PTR_FD
 
	`_IO
 ('A', 0xÁ)

	)

52 
	#SND_PCM_IOCTL_FORWARD
 
	`_IO
 ('A', 0xfb)

	)

55 
¢d_pcm_u‰ames_t
 
	m±r
;

56 
	mu£_mm≠
;

57 
off_t
 
	moff£t
;

58 
	mch™ged
;

59 } 
	t¢d_pcm_shm_rb±r_t
;

62 
	mªsu…
;

63 
	mcmd
;

64 
¢d_pcm_shm_rb±r_t
 
	mhw
;

65 
¢d_pcm_shm_rb±r_t
 
	m≠∂
;

68 
	msig
;

69 
pid_t
 
	mpid
;

70 } 
	masync
;

71 
¢d_pcm_öfo_t
 
	möfo
;

72 
¢d_pcm_hw_∑øms_t
 
	mhw_ªföe
;

73 
¢d_pcm_hw_∑øms_t
 
	mhw_∑øms
;

74 
¢d_pcm_sw_∑øms_t
 
	msw_∑øms
;

75 
¢d_pcm_°©us_t
 
	m°©us
;

77 
¢d_pcm_u‰ames_t
 
	m‰ames
;

78 } 
	mavaû
;

80 
¢d_pcm_s‰ames_t
 
	m‰ames
;

81 } 
	mdñay
;

83 
	míabÀ
;

84 } 
	m∑u£
;

85 
¢d_pcm_ch™√l_öfo_t
 
	mch™√l_öfo
;

87 
¢d_pcm_u‰ames_t
 
	m‰ames
;

88 } 
	mªwöd
;

90 
¢d_pcm_u‰ames_t
 
	m‰ames
;

91 } 
	mf‹w¨d
;

93 
	mfd
;

94 } 
	mlök
;

96 
¢d_pcm_u‰ames_t
 
	moff£t
;

97 
¢d_pcm_u‰ames_t
 
	m‰ames
;

98 } 
	mmm≠_commô
;

100 
	mu£_mm≠
;

101 
	mshmid
;

102 
off_t
 
	moff£t
;

103 } 
	mrb±r
;

104 } 
	mu
;

105 
	md©a
[0];

106 } 
	t¢d_pcm_shm_˘æ_t
;

108 
	#PCM_SHM_SIZE
 (
¢d_pcm_shm_˘æ_t
)

	)

110 
	#SND_CTL_IOCTL_READ
 
	`_IOR
('U', 0xf1, 
¢d_˘l_evít_t
)

	)

111 
	#SND_CTL_IOCTL_CLOSE
 
	`_IO
 ('U', 0xf2)

	)

112 
	#SND_CTL_IOCTL_POLL_DESCRIPTOR
 
	`_IO
 ('U', 0xf3)

	)

113 
	#SND_CTL_IOCTL_ASYNC
 
	`_IO
 ('U', 0xf4)

	)

116 
	mªsu…
;

117 
	mcmd
;

120 
	msig
;

121 
pid_t
 
	mpid
;

122 } 
	masync
;

123 
	mdevi˚
;

124 
	msubs¸ibe_evíts
;

125 
¢d_˘l_ˇrd_öfo_t
 
	mˇrd_öfo
;

126 
¢d_˘l_ñem_li°_t
 
	mñemít_li°
;

127 
¢d_˘l_ñem_öfo_t
 
	mñemít_öfo
;

128 
¢d_˘l_ñem_vÆue_t
 
	mñemít_ªad
;

129 
¢d_˘l_ñem_vÆue_t
 
	mñemít_wrôe
;

130 
¢d_˘l_ñem_id_t
 
	mñemít_lock
;

131 
¢d_˘l_ñem_id_t
 
	mñemít_u∆ock
;

132 
¢d_hwdï_öfo_t
 
	mhwdï_öfo
;

133 
¢d_pcm_öfo_t
 
	mpcm_öfo
;

134 
	mpcm_¥e„r_subdevi˚
;

135 
¢d_øwmidi_öfo_t
 
	møwmidi_öfo
;

136 
	møwmidi_¥e„r_subdevi˚
;

137 
	mpowî_°©e
;

138 
¢d_˘l_evít_t
 
	mªad
;

139 } 
	mu
;

140 
	md©a
[0];

141 } 
	t¢d_˘l_shm_˘æ_t
;

143 
	#CTL_SHM_SIZE
 65536

	)

144 
	#CTL_SHM_DATA_MAXLEN
 (
CTL_SHM_SIZE
 - 
	`off£tof
(
¢d_˘l_shm_˘æ_t
, 
d©a
))

	)

147 
	mdev_ty≥
;

148 
	må™•‹t_ty≥
;

149 
	m°ªam
;

150 
	mmode
;

151 
	m«mñí
;

152 
	m«me
[0];

153 } 
	t¢d_˛õ¡_›í_ªque°_t
;

156 
	mªsu…
;

157 
	mcookõ
;

158 } 
	t¢d_˛õ¡_›í_™swî_t
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/asoundef.h

28 #i‚de‡
__ALSA_ASOUNDEF_H


29 
	#__ALSA_ASOUNDEF_H


	)

31 #ifde‡
__˝lu•lus


41 
	#IEC958_AES0_PROFESSIONAL
 (1<<0Ë

	)

42 
	#IEC958_AES0_NONAUDIO
 (1<<1Ë

	)

43 
	#IEC958_AES0_PRO_EMPHASIS
 (7<<2Ë

	)

44 
	#IEC958_AES0_PRO_EMPHASIS_NOTID
 (0<<2Ë

	)

45 
	#IEC958_AES0_PRO_EMPHASIS_NONE
 (1<<2Ë

	)

46 
	#IEC958_AES0_PRO_EMPHASIS_5015
 (3<<2Ë

	)

47 
	#IEC958_AES0_PRO_EMPHASIS_CCITT
 (7<<2Ë

	)

48 
	#IEC958_AES0_PRO_FREQ_UNLOCKED
 (1<<5Ë

	)

49 
	#IEC958_AES0_PRO_FS
 (3<<6Ë

	)

50 
	#IEC958_AES0_PRO_FS_NOTID
 (0<<6Ë

	)

51 
	#IEC958_AES0_PRO_FS_44100
 (1<<6Ë

	)

52 
	#IEC958_AES0_PRO_FS_48000
 (2<<6Ë

	)

53 
	#IEC958_AES0_PRO_FS_32000
 (3<<6Ë

	)

54 
	#IEC958_AES0_CON_NOT_COPYRIGHT
 (1<<2Ë

	)

55 
	#IEC958_AES0_CON_EMPHASIS
 (7<<3Ë

	)

56 
	#IEC958_AES0_CON_EMPHASIS_NONE
 (0<<3Ë

	)

57 
	#IEC958_AES0_CON_EMPHASIS_5015
 (1<<3Ë

	)

58 
	#IEC958_AES0_CON_MODE
 (3<<6Ë

	)

59 
	#IEC958_AES1_PRO_MODE
 (15<<0Ë

	)

60 
	#IEC958_AES1_PRO_MODE_NOTID
 (0<<0Ë

	)

61 
	#IEC958_AES1_PRO_MODE_STEREOPHONIC
 (2<<0Ë

	)

62 
	#IEC958_AES1_PRO_MODE_SINGLE
 (4<<0Ë

	)

63 
	#IEC958_AES1_PRO_MODE_TWO
 (8<<0Ë

	)

64 
	#IEC958_AES1_PRO_MODE_PRIMARY
 (12<<0Ë

	)

65 
	#IEC958_AES1_PRO_MODE_BYTE3
 (15<<0Ë

	)

66 
	#IEC958_AES1_PRO_USERBITS
 (15<<4Ë

	)

67 
	#IEC958_AES1_PRO_USERBITS_NOTID
 (0<<4Ë

	)

68 
	#IEC958_AES1_PRO_USERBITS_192
 (8<<4Ë

	)

69 
	#IEC958_AES1_PRO_USERBITS_UDEF
 (12<<4Ë

	)

70 
	#IEC958_AES1_CON_CATEGORY
 0x7‡

	)

71 
	#IEC958_AES1_CON_GENERAL
 0x00

	)

72 
	#IEC958_AES1_CON_LASEROPT_MASK
 0x07

	)

73 
	#IEC958_AES1_CON_LASEROPT_ID
 0x01

	)

74 
	#IEC958_AES1_CON_IEC908_CD
 (
IEC958_AES1_CON_LASEROPT_ID
|0x00Ë

	)

75 
	#IEC958_AES1_CON_NON_IEC908_CD
 (
IEC958_AES1_CON_LASEROPT_ID
|0x08Ë

	)

76 
	#IEC958_AES1_CON_MINI_DISC
 (
IEC958_AES1_CON_LASEROPT_ID
|0x48Ë

	)

77 
	#IEC958_AES1_CON_DVD
 (
IEC958_AES1_CON_LASEROPT_ID
|0x18Ë

	)

78 
	#IEC958_AES1_CON_LASTEROPT_OTHER
 (
IEC958_AES1_CON_LASEROPT_ID
|0x78Ë

	)

79 
	#IEC958_AES1_CON_DIGDIGCONV_MASK
 0x07

	)

80 
	#IEC958_AES1_CON_DIGDIGCONV_ID
 0x02

	)

81 
	#IEC958_AES1_CON_PCM_CODER
 (
IEC958_AES1_CON_DIGDIGCONV_ID
|0x00Ë

	)

82 
	#IEC958_AES1_CON_MIXER
 (
IEC958_AES1_CON_DIGDIGCONV_ID
|0x10Ë

	)

83 
	#IEC958_AES1_CON_RATE_CONVERTER
 (
IEC958_AES1_CON_DIGDIGCONV_ID
|0x18Ë

	)

84 
	#IEC958_AES1_CON_SAMPLER
 (
IEC958_AES1_CON_DIGDIGCONV_ID
|0x20Ë

	)

85 
	#IEC958_AES1_CON_DSP
 (
IEC958_AES1_CON_DIGDIGCONV_ID
|0x28Ë

	)

86 
	#IEC958_AES1_CON_DIGDIGCONV_OTHER
 (
IEC958_AES1_CON_DIGDIGCONV_ID
|0x78Ë

	)

87 
	#IEC958_AES1_CON_MAGNETIC_MASK
 0x07

	)

88 
	#IEC958_AES1_CON_MAGNETIC_ID
 0x03

	)

89 
	#IEC958_AES1_CON_DAT
 (
IEC958_AES1_CON_MAGNETIC_ID
|0x00Ë

	)

90 
	#IEC958_AES1_CON_VCR
 (
IEC958_AES1_CON_MAGNETIC_ID
|0x08Ë

	)

91 
	#IEC958_AES1_CON_DCC
 (
IEC958_AES1_CON_MAGNETIC_ID
|0x40Ë

	)

92 
	#IEC958_AES1_CON_MAGNETIC_DISC
 (
IEC958_AES1_CON_MAGNETIC_ID
|0x18Ë

	)

93 
	#IEC958_AES1_CON_MAGNETIC_OTHER
 (
IEC958_AES1_CON_MAGNETIC_ID
|0x78Ë

	)

94 
	#IEC958_AES1_CON_BROADCAST1_MASK
 0x07

	)

95 
	#IEC958_AES1_CON_BROADCAST1_ID
 0x04

	)

96 
	#IEC958_AES1_CON_DAB_JAPAN
 (
IEC958_AES1_CON_BROADCAST1_ID
|0x00Ë

	)

97 
	#IEC958_AES1_CON_DAB_EUROPE
 (
IEC958_AES1_CON_BROADCAST1_ID
|0x08Ë

	)

98 
	#IEC958_AES1_CON_DAB_USA
 (
IEC958_AES1_CON_BROADCAST1_ID
|0x60Ë

	)

99 
	#IEC958_AES1_CON_SOFTWARE
 (
IEC958_AES1_CON_BROADCAST1_ID
|0x40Ë

	)

100 
	#IEC958_AES1_CON_IEC62105
 (
IEC958_AES1_CON_BROADCAST1_ID
|0x20Ë

	)

101 
	#IEC958_AES1_CON_BROADCAST1_OTHER
 (
IEC958_AES1_CON_BROADCAST1_ID
|0x78Ë

	)

102 
	#IEC958_AES1_CON_BROADCAST2_MASK
 0x0‡

	)

103 
	#IEC958_AES1_CON_BROADCAST2_ID
 0x0ê

	)

104 
	#IEC958_AES1_CON_MUSICAL_MASK
 0x07

	)

105 
	#IEC958_AES1_CON_MUSICAL_ID
 0x05

	)

106 
	#IEC958_AES1_CON_SYNTHESIZER
 (
IEC958_AES1_CON_MUSICAL_ID
|0x00Ë

	)

107 
	#IEC958_AES1_CON_MICROPHONE
 (
IEC958_AES1_CON_MUSICAL_ID
|0x08Ë

	)

108 
	#IEC958_AES1_CON_MUSICAL_OTHER
 (
IEC958_AES1_CON_MUSICAL_ID
|0x78Ë

	)

109 
	#IEC958_AES1_CON_ADC_MASK
 0x1‡

	)

110 
	#IEC958_AES1_CON_ADC_ID
 0x06

	)

111 
	#IEC958_AES1_CON_ADC
 (
IEC958_AES1_CON_ADC_ID
|0x00Ë

	)

112 
	#IEC958_AES1_CON_ADC_OTHER
 (
IEC958_AES1_CON_ADC_ID
|0x60Ë

	)

113 
	#IEC958_AES1_CON_ADC_COPYRIGHT_MASK
 0x1‡

	)

114 
	#IEC958_AES1_CON_ADC_COPYRIGHT_ID
 0x16

	)

115 
	#IEC958_AES1_CON_ADC_COPYRIGHT
 (
IEC958_AES1_CON_ADC_COPYRIGHT_ID
|0x00Ë

	)

116 
	#IEC958_AES1_CON_ADC_COPYRIGHT_OTHER
 (
IEC958_AES1_CON_ADC_COPYRIGHT_ID
|0x60Ë

	)

117 
	#IEC958_AES1_CON_SOLIDMEM_MASK
 0x0‡

	)

118 
	#IEC958_AES1_CON_SOLIDMEM_ID
 0x08

	)

119 
	#IEC958_AES1_CON_SOLIDMEM_DIGITAL_RECORDER_PLAYER
 (
IEC958_AES1_CON_SOLIDMEM_ID
|0x00Ë

	)

120 
	#IEC958_AES1_CON_SOLIDMEM_OTHER
 (
IEC958_AES1_CON_SOLIDMEM_ID
|0x70Ë

	)

121 
	#IEC958_AES1_CON_EXPERIMENTAL
 0x40

	)

122 
	#IEC958_AES1_CON_ORIGINAL
 (1<<7Ë

	)

123 
	#IEC958_AES2_PRO_SBITS
 (7<<0Ë

	)

124 
	#IEC958_AES2_PRO_SBITS_20
 (2<<0Ë

	)

125 
	#IEC958_AES2_PRO_SBITS_24
 (4<<0Ë

	)

126 
	#IEC958_AES2_PRO_SBITS_UDEF
 (6<<0Ë

	)

127 
	#IEC958_AES2_PRO_WORDLEN
 (7<<3Ë

	)

128 
	#IEC958_AES2_PRO_WORDLEN_NOTID
 (0<<3Ë

	)

129 
	#IEC958_AES2_PRO_WORDLEN_22_18
 (2<<3Ë

	)

130 
	#IEC958_AES2_PRO_WORDLEN_23_19
 (4<<3Ë

	)

131 
	#IEC958_AES2_PRO_WORDLEN_24_20
 (5<<3Ë

	)

132 
	#IEC958_AES2_PRO_WORDLEN_20_16
 (6<<3Ë

	)

133 
	#IEC958_AES2_CON_SOURCE
 (15<<0Ë

	)

134 
	#IEC958_AES2_CON_SOURCE_UNSPEC
 (0<<0Ë

	)

135 
	#IEC958_AES2_CON_CHANNEL
 (15<<4Ë

	)

136 
	#IEC958_AES2_CON_CHANNEL_UNSPEC
 (0<<4Ë

	)

137 
	#IEC958_AES3_CON_FS
 (15<<0Ë

	)

138 
	#IEC958_AES3_CON_FS_44100
 (0<<0Ë

	)

139 
	#IEC958_AES3_CON_FS_NOTID
 (1<<0Ë

	)

140 
	#IEC958_AES3_CON_FS_48000
 (2<<0Ë

	)

141 
	#IEC958_AES3_CON_FS_32000
 (3<<0Ë

	)

142 
	#IEC958_AES3_CON_FS_22050
 (4<<0Ë

	)

143 
	#IEC958_AES3_CON_FS_24000
 (6<<0Ë

	)

144 
	#IEC958_AES3_CON_FS_88200
 (8<<0Ë

	)

145 
	#IEC958_AES3_CON_FS_768000
 (9<<0Ë

	)

146 
	#IEC958_AES3_CON_FS_96000
 (10<<0Ë

	)

147 
	#IEC958_AES3_CON_FS_176400
 (12<<0Ë

	)

148 
	#IEC958_AES3_CON_FS_192000
 (14<<0Ë

	)

149 
	#IEC958_AES3_CON_CLOCK
 (3<<4Ë

	)

150 
	#IEC958_AES3_CON_CLOCK_1000PPM
 (0<<4Ë

	)

151 
	#IEC958_AES3_CON_CLOCK_50PPM
 (1<<4Ë

	)

152 
	#IEC958_AES3_CON_CLOCK_VARIABLE
 (2<<4Ë

	)

153 
	#IEC958_AES4_CON_MAX_WORDLEN_24
 (1<<0Ë

	)

154 
	#IEC958_AES4_CON_WORDLEN
 (7<<1Ë

	)

155 
	#IEC958_AES4_CON_WORDLEN_NOTID
 (0<<1Ë

	)

156 
	#IEC958_AES4_CON_WORDLEN_20_16
 (1<<1Ë

	)

157 
	#IEC958_AES4_CON_WORDLEN_22_18
 (2<<1Ë

	)

158 
	#IEC958_AES4_CON_WORDLEN_23_19
 (4<<1Ë

	)

159 
	#IEC958_AES4_CON_WORDLEN_24_20
 (5<<1Ë

	)

160 
	#IEC958_AES4_CON_WORDLEN_21_17
 (6<<1Ë

	)

161 
	#IEC958_AES4_CON_ORIGFS
 (15<<4Ë

	)

162 
	#IEC958_AES4_CON_ORIGFS_NOTID
 (0<<4Ë

	)

163 
	#IEC958_AES4_CON_ORIGFS_192000
 (1<<4Ë

	)

164 
	#IEC958_AES4_CON_ORIGFS_12000
 (2<<4Ë

	)

165 
	#IEC958_AES4_CON_ORIGFS_176400
 (3<<4Ë

	)

166 
	#IEC958_AES4_CON_ORIGFS_96000
 (5<<4Ë

	)

167 
	#IEC958_AES4_CON_ORIGFS_8000
 (6<<4Ë

	)

168 
	#IEC958_AES4_CON_ORIGFS_88200
 (7<<4Ë

	)

169 
	#IEC958_AES4_CON_ORIGFS_16000
 (8<<4Ë

	)

170 
	#IEC958_AES4_CON_ORIGFS_24000
 (9<<4Ë

	)

171 
	#IEC958_AES4_CON_ORIGFS_11025
 (10<<4Ë

	)

172 
	#IEC958_AES4_CON_ORIGFS_22050
 (11<<4Ë

	)

173 
	#IEC958_AES4_CON_ORIGFS_32000
 (12<<4Ë

	)

174 
	#IEC958_AES4_CON_ORIGFS_48000
 (13<<4Ë

	)

175 
	#IEC958_AES4_CON_ORIGFS_44100
 (15<<4Ë

	)

176 
	#IEC958_AES5_CON_CGMSA
 (3<<0Ë

	)

177 
	#IEC958_AES5_CON_CGMSA_COPYFREELY
 (0<<0Ë

	)

178 
	#IEC958_AES5_CON_CGMSA_COPYONCE
 (1<<0Ë

	)

179 
	#IEC958_AES5_CON_CGMSA_COPYNOMORE
 (2<<0Ë

	)

180 
	#IEC958_AES5_CON_CGMSA_COPYNEVER
 (3<<0Ë

	)

182 
	#CEA861_AUDIO_INFOFRAME_DB1CC
 (7<<0Ë

	)

183 
	#CEA861_AUDIO_INFOFRAME_DB1CT
 (0xf<<4Ë

	)

184 
	#CEA861_AUDIO_INFOFRAME_DB1CT_FROM_STREAM
 (0<<4Ë

	)

185 
	#CEA861_AUDIO_INFOFRAME_DB1CT_IEC60958
 (1<<4Ë

	)

186 
	#CEA861_AUDIO_INFOFRAME_DB1CT_AC3
 (2<<4Ë

	)

187 
	#CEA861_AUDIO_INFOFRAME_DB1CT_MPEG1
 (3<<4Ë

	)

188 
	#CEA861_AUDIO_INFOFRAME_DB1CT_MP3
 (4<<4Ë

	)

189 
	#CEA861_AUDIO_INFOFRAME_DB1CT_MPEG2_MULTICH
 (5<<4Ë

	)

190 
	#CEA861_AUDIO_INFOFRAME_DB1CT_AAC
 (6<<4Ë

	)

191 
	#CEA861_AUDIO_INFOFRAME_DB1CT_DTS
 (7<<4Ë

	)

192 
	#CEA861_AUDIO_INFOFRAME_DB1CT_ATRAC
 (8<<4Ë

	)

193 
	#CEA861_AUDIO_INFOFRAME_DB1CT_ONEBIT
 (9<<4Ë

	)

194 
	#CEA861_AUDIO_INFOFRAME_DB1CT_DOLBY_DIG_PLUS
 (10<<4Ë

	)

195 
	#CEA861_AUDIO_INFOFRAME_DB1CT_DTS_HD
 (11<<4Ë

	)

196 
	#CEA861_AUDIO_INFOFRAME_DB1CT_MAT
 (12<<4Ë

	)

197 
	#CEA861_AUDIO_INFOFRAME_DB1CT_DST
 (13<<4Ë

	)

198 
	#CEA861_AUDIO_INFOFRAME_DB1CT_WMA_PRO
 (14<<4Ë

	)

199 
	#CEA861_AUDIO_INFOFRAME_DB2SF
 (7<<2Ë

	)

200 
	#CEA861_AUDIO_INFOFRAME_DB2SF_FROM_STREAM
 (0<<2Ë

	)

201 
	#CEA861_AUDIO_INFOFRAME_DB2SF_32000
 (1<<2Ë

	)

202 
	#CEA861_AUDIO_INFOFRAME_DB2SF_44100
 (2<<2Ë

	)

203 
	#CEA861_AUDIO_INFOFRAME_DB2SF_48000
 (3<<2Ë

	)

204 
	#CEA861_AUDIO_INFOFRAME_DB2SF_88200
 (4<<2Ë

	)

205 
	#CEA861_AUDIO_INFOFRAME_DB2SF_96000
 (5<<2Ë

	)

206 
	#CEA861_AUDIO_INFOFRAME_DB2SF_176400
 (6<<2Ë

	)

207 
	#CEA861_AUDIO_INFOFRAME_DB2SF_192000
 (7<<2Ë

	)

208 
	#CEA861_AUDIO_INFOFRAME_DB2SS
 (3<<0Ë

	)

209 
	#CEA861_AUDIO_INFOFRAME_DB2SS_FROM_STREAM
 (0<<0Ë

	)

210 
	#CEA861_AUDIO_INFOFRAME_DB2SS_16BIT
 (1<<0Ë

	)

211 
	#CEA861_AUDIO_INFOFRAME_DB2SS_20BIT
 (2<<0Ë

	)

212 
	#CEA861_AUDIO_INFOFRAME_DB2SS_24BIT
 (3<<0Ë

	)

213 
	#CEA861_AUDIO_INFOFRAME_DB5_DM_INH
 (1<<7Ë

	)

214 
	#CEA861_AUDIO_INFOFRAME_DB5_DM_INH_PERMITTED
 (0<<7Ë

	)

215 
	#CEA861_AUDIO_INFOFRAME_DB5_DM_INH_PROHIBITED
 (1<<7Ë

	)

216 
	#CEA861_AUDIO_INFOFRAME_DB5_LSV
 (0xf<<3Ë

	)

226 
	#MIDI_CHANNELS
 16

	)

227 
	#MIDI_GM_DRUM_CHANNEL
 (10-1Ë

	)

237 
	#MIDI_CMD_NOTE_OFF
 0x80

	)

238 
	#MIDI_CMD_NOTE_ON
 0x90

	)

239 
	#MIDI_CMD_NOTE_PRESSURE
 0xa0

	)

240 
	#MIDI_CMD_CONTROL
 0xb0

	)

241 
	#MIDI_CMD_PGM_CHANGE
 0xc0

	)

242 
	#MIDI_CMD_CHANNEL_PRESSURE
 0xd0

	)

243 
	#MIDI_CMD_BENDER
 0xe0

	)

245 
	#MIDI_CMD_COMMON_SYSEX
 0xf0

	)

246 
	#MIDI_CMD_COMMON_MTC_QUARTER
 0xf1

	)

247 
	#MIDI_CMD_COMMON_SONG_POS
 0xf2

	)

248 
	#MIDI_CMD_COMMON_SONG_SELECT
 0xf3

	)

249 
	#MIDI_CMD_COMMON_TUNE_REQUEST
 0xf6

	)

250 
	#MIDI_CMD_COMMON_SYSEX_END
 0xf7

	)

251 
	#MIDI_CMD_COMMON_CLOCK
 0xf8

	)

252 
	#MIDI_CMD_COMMON_START
 0xÁ

	)

253 
	#MIDI_CMD_COMMON_CONTINUE
 0xfb

	)

254 
	#MIDI_CMD_COMMON_STOP
 0xf¯

	)

255 
	#MIDI_CMD_COMMON_SENSING
 0x„

	)

256 
	#MIDI_CMD_COMMON_RESET
 0xf‡

	)

266 
	#MIDI_CTL_MSB_BANK
 0x00

	)

267 
	#MIDI_CTL_MSB_MODWHEEL
 0x01

	)

268 
	#MIDI_CTL_MSB_BREATH
 0x02

	)

269 
	#MIDI_CTL_MSB_FOOT
 0x04

	)

270 
	#MIDI_CTL_MSB_PORTAMENTO_TIME
 0x05

	)

271 
	#MIDI_CTL_MSB_DATA_ENTRY
 0x06

	)

272 
	#MIDI_CTL_MSB_MAIN_VOLUME
 0x07

	)

273 
	#MIDI_CTL_MSB_BALANCE
 0x08

	)

274 
	#MIDI_CTL_MSB_PAN
 0x0®

	)

275 
	#MIDI_CTL_MSB_EXPRESSION
 0x0b

	)

276 
	#MIDI_CTL_MSB_EFFECT1
 0x0¯

	)

277 
	#MIDI_CTL_MSB_EFFECT2
 0x0d

	)

278 
	#MIDI_CTL_MSB_GENERAL_PURPOSE1
 0x10

	)

279 
	#MIDI_CTL_MSB_GENERAL_PURPOSE2
 0x11

	)

280 
	#MIDI_CTL_MSB_GENERAL_PURPOSE3
 0x12

	)

281 
	#MIDI_CTL_MSB_GENERAL_PURPOSE4
 0x13

	)

282 
	#MIDI_CTL_LSB_BANK
 0x20

	)

283 
	#MIDI_CTL_LSB_MODWHEEL
 0x21

	)

284 
	#MIDI_CTL_LSB_BREATH
 0x22

	)

285 
	#MIDI_CTL_LSB_FOOT
 0x24

	)

286 
	#MIDI_CTL_LSB_PORTAMENTO_TIME
 0x25

	)

287 
	#MIDI_CTL_LSB_DATA_ENTRY
 0x26

	)

288 
	#MIDI_CTL_LSB_MAIN_VOLUME
 0x27

	)

289 
	#MIDI_CTL_LSB_BALANCE
 0x28

	)

290 
	#MIDI_CTL_LSB_PAN
 0x2®

	)

291 
	#MIDI_CTL_LSB_EXPRESSION
 0x2b

	)

292 
	#MIDI_CTL_LSB_EFFECT1
 0x2¯

	)

293 
	#MIDI_CTL_LSB_EFFECT2
 0x2d

	)

294 
	#MIDI_CTL_LSB_GENERAL_PURPOSE1
 0x30

	)

295 
	#MIDI_CTL_LSB_GENERAL_PURPOSE2
 0x31

	)

296 
	#MIDI_CTL_LSB_GENERAL_PURPOSE3
 0x32

	)

297 
	#MIDI_CTL_LSB_GENERAL_PURPOSE4
 0x33

	)

298 
	#MIDI_CTL_SUSTAIN
 0x40

	)

299 
	#MIDI_CTL_PORTAMENTO
 0x41

	)

300 
	#MIDI_CTL_SOSTENUTO
 0x42

	)

301 
	#MIDI_CTL_SUSTENUTO
 0x42

	)

302 
	#MIDI_CTL_SOFT_PEDAL
 0x43

	)

303 
	#MIDI_CTL_LEGATO_FOOTSWITCH
 0x44

	)

304 
	#MIDI_CTL_HOLD2
 0x45

	)

305 
	#MIDI_CTL_SC1_SOUND_VARIATION
 0x46

	)

306 
	#MIDI_CTL_SC2_TIMBRE
 0x47

	)

307 
	#MIDI_CTL_SC3_RELEASE_TIME
 0x48

	)

308 
	#MIDI_CTL_SC4_ATTACK_TIME
 0x49

	)

309 
	#MIDI_CTL_SC5_BRIGHTNESS
 0x4®

	)

310 
	#MIDI_CTL_SC6
 0x4b

	)

311 
	#MIDI_CTL_SC7
 0x4¯

	)

312 
	#MIDI_CTL_SC8
 0x4d

	)

313 
	#MIDI_CTL_SC9
 0x4ê

	)

314 
	#MIDI_CTL_SC10
 0x4‡

	)

315 
	#MIDI_CTL_GENERAL_PURPOSE5
 0x50

	)

316 
	#MIDI_CTL_GENERAL_PURPOSE6
 0x51

	)

317 
	#MIDI_CTL_GENERAL_PURPOSE7
 0x52

	)

318 
	#MIDI_CTL_GENERAL_PURPOSE8
 0x53

	)

319 
	#MIDI_CTL_PORTAMENTO_CONTROL
 0x54

	)

320 
	#MIDI_CTL_E1_REVERB_DEPTH
 0x5b

	)

321 
	#MIDI_CTL_E2_TREMOLO_DEPTH
 0x5¯

	)

322 
	#MIDI_CTL_E3_CHORUS_DEPTH
 0x5d

	)

323 
	#MIDI_CTL_E4_DETUNE_DEPTH
 0x5ê

	)

324 
	#MIDI_CTL_E5_PHASER_DEPTH
 0x5‡

	)

325 
	#MIDI_CTL_DATA_INCREMENT
 0x60

	)

326 
	#MIDI_CTL_DATA_DECREMENT
 0x61

	)

327 
	#MIDI_CTL_NONREG_PARM_NUM_LSB
 0x62

	)

328 
	#MIDI_CTL_NONREG_PARM_NUM_MSB
 0x63

	)

329 
	#MIDI_CTL_REGIST_PARM_NUM_LSB
 0x64

	)

330 
	#MIDI_CTL_REGIST_PARM_NUM_MSB
 0x65

	)

331 
	#MIDI_CTL_ALL_SOUNDS_OFF
 0x78

	)

332 
	#MIDI_CTL_RESET_CONTROLLERS
 0x79

	)

333 
	#MIDI_CTL_LOCAL_CONTROL_SWITCH
 0x7®

	)

334 
	#MIDI_CTL_ALL_NOTES_OFF
 0x7b

	)

335 
	#MIDI_CTL_OMNI_OFF
 0x7¯

	)

336 
	#MIDI_CTL_OMNI_ON
 0x7d

	)

337 
	#MIDI_CTL_MONO1
 0x7ê

	)

338 
	#MIDI_CTL_MONO2
 0x7‡

	)

342 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/asoundlib-head.h

28 #i‚de‡
__ASOUNDLIB_H


29 
	#__ASOUNDLIB_H


	)

31 
	~<uni°d.h
>

32 
	~<°dio.h
>

33 
	~<°dlib.h
>

34 
	~<sys/ty≥s.h
>

35 
	~<°rög.h
>

36 
	~<f˙é.h
>

37 
	~<as£π.h
>

38 
	~<pﬁl.h
>

39 
	~<î∫o.h
>

40 
	~<°d¨g.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/asoundlib-tail.h

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/bswap.h

22 #i‚de‡
__BSWAP_H


23 
	#__BSWAP_H


	)

25 #i‡
deföed
(
__FªeBSD__
Ë|| deföed(
__Døg⁄Fly__
Ë|| deföed(
__NëBSD__
)

26 
	~<sys/ídün.h
>

27 
	#bsw≠_16
 
bsw≠16


	)

28 
	#bsw≠_32
 
bsw≠32


	)

29 
	#bsw≠_64
 
bsw≠64


	)

30 #ñi‡
deföed
(
__O≥nBSD__
)

31 
	~<sys/ídün.h
>

32 
	#bsw≠_16
 
sw≠16


	)

33 
	#bsw≠_32
 
sw≠32


	)

34 
	#bsw≠_64
 
sw≠64


	)

35 #ñi‡
deföed
 (
__sun
)

36 
	~<sys/byã‹dî.h
>

37 
	#bsw≠_16
 
BSWAP_16


	)

38 
	#bsw≠_32
 
BSWAP_32


	)

39 
	#bsw≠_64
 
BSWAP_64


	)

41 
	~<byãsw≠.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/conf.h

28 #i‚de‡
__ALSA_CONF_H


29 
	#__ALSA_CONF_H


	)

31 #ifde‡
__˝lu•lus


43 
	#SND_CONFIG_DLSYM_VERSION_EVALUATE
 
_dlsym_c⁄fig_evÆu©e_001


	)

45 
	#SND_CONFIG_DLSYM_VERSION_HOOK
 
_dlsym_c⁄fig_hook_001


	)

48 
	e_¢d_c⁄fig_ty≥
 {

50 
SND_CONFIG_TYPE_INTEGER
,

52 
SND_CONFIG_TYPE_INTEGER64
,

54 
SND_CONFIG_TYPE_REAL
,

56 
SND_CONFIG_TYPE_STRING
,

58 
SND_CONFIG_TYPE_POINTER
,

60 
SND_CONFIG_TYPE_COMPOUND
 = 1024

61 } 
	t¢d_c⁄fig_ty≥_t
;

69 
_¢d_c⁄fig
 
	t¢d_c⁄fig_t
;

77 
_¢d_c⁄fig_ôî©‹
 *
	t¢d_c⁄fig_ôî©‹_t
;

83 
_¢d_c⁄fig_upd©e
 
	t¢d_c⁄fig_upd©e_t
;

85 
¢d_c⁄fig_t
 *
¢d_c⁄fig
;

87 c⁄° *
¢d_c⁄fig_t›dú
();

89 
¢d_c⁄fig_t›
(
¢d_c⁄fig_t
 **
c⁄fig
);

91 
¢d_c⁄fig_lﬂd
(
¢d_c⁄fig_t
 *
c⁄fig
, 
¢d_öput_t
 *
ö
);

92 
¢d_c⁄fig_lﬂd_°rög
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
s
, 
size_t
 
size
);

93 
¢d_c⁄fig_lﬂd_ovîride
(
¢d_c⁄fig_t
 *
c⁄fig
, 
¢d_öput_t
 *
ö
);

94 
¢d_c⁄fig_ßve
(
¢d_c⁄fig_t
 *
c⁄fig
, 
¢d_ouçut_t
 *
out
);

95 
¢d_c⁄fig_upd©e
();

96 
¢d_c⁄fig_upd©e_r
(
¢d_c⁄fig_t
 **
t›
, 
¢d_c⁄fig_upd©e_t
 **
upd©e
, c⁄° *
∑th
);

97 
¢d_c⁄fig_upd©e_‰ì
(
¢d_c⁄fig_upd©e_t
 *
upd©e
);

98 
¢d_c⁄fig_upd©e_‰ì_globÆ
();

100 
¢d_c⁄fig_upd©e_ªf
(
¢d_c⁄fig_t
 **
t›
);

101 
¢d_c⁄fig_ªf
(
¢d_c⁄fig_t
 *
t›
);

102 
¢d_c⁄fig_uƒef
(
¢d_c⁄fig_t
 *
t›
);

104 
¢d_c⁄fig_£¨ch
(
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° *
key
,

105 
¢d_c⁄fig_t
 **
ªsu…
);

106 
¢d_c⁄fig_£¨chv
(
¢d_c⁄fig_t
 *
c⁄fig
,

107 
¢d_c⁄fig_t
 **
ªsu…
, ...);

108 
¢d_c⁄fig_£¨ch_deföôi⁄
(
¢d_c⁄fig_t
 *
c⁄fig
,

109 c⁄° *
ba£
, c⁄° *
key
,

110 
¢d_c⁄fig_t
 **
ªsu…
);

122 (*
	g¢d_c⁄fig_ex∑nd_f˙_t
)(
	t¢d_c⁄fig_t
 **
	td°
, c⁄° *
	ts
, *
	t¥iv©e_d©a
);

124 
¢d_c⁄fig_ex∑nd_cu°om
(
¢d_c⁄fig_t
 *
c⁄fig
, snd_c⁄fig_à*
roŸ
,

125 
¢d_c⁄fig_ex∑nd_f˙_t
 
f˙
, *
¥iv©e_d©a
,

126 
¢d_c⁄fig_t
 **
ªsu…
);

127 
¢d_c⁄fig_ex∑nd
(
¢d_c⁄fig_t
 *
c⁄fig
, snd_c⁄fig_à*
roŸ
,

128 c⁄° *
¨gs
, 
¢d_c⁄fig_t
 *
¥iv©e_d©a
,

129 
¢d_c⁄fig_t
 **
ªsu…
);

130 
¢d_c⁄fig_evÆu©e
(
¢d_c⁄fig_t
 *
c⁄fig
, snd_c⁄fig_à*
roŸ
,

131 
¢d_c⁄fig_t
 *
¥iv©e_d©a
, snd_c⁄fig_à**
ªsu…
);

132 
¢d_c⁄fig_evÆu©e_°rög
(
¢d_c⁄fig_t
 **
d°
, c⁄° *
s
,

133 
¢d_c⁄fig_ex∑nd_f˙_t
 
f˙
, *
¥iv©e_d©a
);

135 
¢d_c⁄fig_add
(
¢d_c⁄fig_t
 *
c⁄fig
, snd_c⁄fig_à*
chûd
);

136 
¢d_c⁄fig_add_bef‹e
(
¢d_c⁄fig_t
 *
bef‹e
, snd_c⁄fig_à*
chûd
);

137 
¢d_c⁄fig_add_a·î
(
¢d_c⁄fig_t
 *
a·î
, snd_c⁄fig_à*
chûd
);

138 
¢d_c⁄fig_ªmove
(
¢d_c⁄fig_t
 *
c⁄fig
);

139 
¢d_c⁄fig_dñëe
(
¢d_c⁄fig_t
 *
c⁄fig
);

140 
¢d_c⁄fig_dñëe_compound_membîs
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
);

141 
¢d_c⁄fig_c›y
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
§c
);

142 
¢d_c⁄fig_sub°ôuã
(
¢d_c⁄fig_t
 *
d°
, snd_c⁄fig_à*
§c
);

143 
¢d_c⁄fig_mîge
(
¢d_c⁄fig_t
 *
d°
, snd_c⁄fig_à*
§c
, 
ovîride
);

145 
¢d_c⁄fig_make
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
key
,

146 
¢d_c⁄fig_ty≥_t
 
ty≥
);

147 
¢d_c⁄fig_make_öãgî
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
key
);

148 
¢d_c⁄fig_make_öãgî64
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
key
);

149 
¢d_c⁄fig_make_ªÆ
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
key
);

150 
¢d_c⁄fig_make_°rög
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
key
);

151 
¢d_c⁄fig_make_poöãr
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
key
);

152 
¢d_c⁄fig_make_compound
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
key
, 
joö
);

153 
¢d_c⁄fig_make_∑th
(
¢d_c⁄fig_t
 **
c⁄fig
, snd_c⁄fig_à*
roŸ
, c⁄° *
key
,

154 
joö
, 
ovîride
);

156 
¢d_c⁄fig_imake_öãgî
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
key
, c⁄° 
vÆue
);

157 
¢d_c⁄fig_imake_öãgî64
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
key
, c⁄° 
vÆue
);

158 
¢d_c⁄fig_imake_ªÆ
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
key
, c⁄° 
vÆue
);

159 
¢d_c⁄fig_imake_°rög
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
key
, c⁄° *
ascii
);

160 
¢d_c⁄fig_imake_ß„_°rög
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
key
, c⁄° *
ascii
);

161 
¢d_c⁄fig_imake_poöãr
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
key
, c⁄° *
±r
);

163 
¢d_c⁄fig_ty≥_t
 
¢d_c⁄fig_gë_ty≥
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
);

164 
¢d_c⁄fig_is_¨øy
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
);

165 
¢d_c⁄fig_is_em±y
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
);

167 
¢d_c⁄fig_£t_id
(
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° *
id
);

168 
¢d_c⁄fig_£t_öãgî
(
¢d_c⁄fig_t
 *
c⁄fig
, 
vÆue
);

169 
¢d_c⁄fig_£t_öãgî64
(
¢d_c⁄fig_t
 *
c⁄fig
, 
vÆue
);

170 
¢d_c⁄fig_£t_ªÆ
(
¢d_c⁄fig_t
 *
c⁄fig
, 
vÆue
);

171 
¢d_c⁄fig_£t_°rög
(
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° *
vÆue
);

172 
¢d_c⁄fig_£t_ascii
(
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° *
ascii
);

173 
¢d_c⁄fig_£t_poöãr
(
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° *
±r
);

174 
¢d_c⁄fig_gë_id
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° **
vÆue
);

175 
¢d_c⁄fig_gë_öãgî
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, *
vÆue
);

176 
¢d_c⁄fig_gë_öãgî64
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, *
vÆue
);

177 
¢d_c⁄fig_gë_ªÆ
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, *
vÆue
);

178 
¢d_c⁄fig_gë_úól
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, *
vÆue
);

179 
¢d_c⁄fig_gë_°rög
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° **
vÆue
);

180 
¢d_c⁄fig_gë_ascii
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, **
vÆue
);

181 
¢d_c⁄fig_gë_poöãr
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° **
vÆue
);

182 
¢d_c⁄fig_ã°_id
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° *
id
);

184 
¢d_c⁄fig_ôî©‹_t
 
¢d_c⁄fig_ôî©‹_fú°
(c⁄° 
¢d_c⁄fig_t
 *
node
);

185 
¢d_c⁄fig_ôî©‹_t
 
¢d_c⁄fig_ôî©‹_√xt
(c⁄° snd_c⁄fig_ôî©‹_à
ôî©‹
);

186 
¢d_c⁄fig_ôî©‹_t
 
¢d_c⁄fig_ôî©‹_íd
(c⁄° 
¢d_c⁄fig_t
 *
node
);

187 
¢d_c⁄fig_t
 *
¢d_c⁄fig_ôî©‹_íåy
(c⁄° 
¢d_c⁄fig_ôî©‹_t
 
ôî©‹
);

206 
	#¢d_c⁄fig_f‹_óch
(
pos
, 
√xt
, 
node
) \

207 
pos
 = 
	`¢d_c⁄fig_ôî©‹_fú°
(
node
), 
√xt
 = 
	`¢d_c⁄fig_ôî©‹_√xt
’os);Öo†!
	`¢d_c⁄fig_ôî©‹_íd
“ode);Öo†√xt,Çexà¢d_c⁄fig_ôî©‹_√xt’os))

	)

211 
¢d_c⁄fig_gë_boﬁ_ascii
(c⁄° *
ascii
);

212 
¢d_c⁄fig_gë_boﬁ
(c⁄° 
¢d_c⁄fig_t
 *
c⁄f
);

213 
¢d_c⁄fig_gë_ˇrd
(c⁄° 
¢d_c⁄fig_t
 *
c⁄f
);

214 
¢d_c⁄fig_gë_˘l_iÁ˚_ascii
(c⁄° *
ascii
);

215 
¢d_c⁄fig_gë_˘l_iÁ˚
(c⁄° 
¢d_c⁄fig_t
 *
c⁄f
);

222 
¢d_dev«me
 
	t¢d_dev«me_t
;

227 
	s¢d_dev«me
 {

228 *
	g«me
;

229 *
	gcommít
;

230 
¢d_dev«me_t
 *
	g√xt
;

233 
¢d_«mes_li°
(c⁄° *
iÁ˚
, 
¢d_dev«me_t
 **
li°
);

234 
¢d_«mes_li°_‰ì
(
¢d_dev«me_t
 *
li°
);

238 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/control.h

28 #i‚de‡
__ALSA_CONTROL_H


29 
	#__ALSA_CONTROL_H


	)

31 #ifde‡
__˝lu•lus


43 
	#SND_CONTROL_DLSYM_VERSION
 
_dlsym_c⁄åﬁ_001


	)

46 
	s¢d_´s_õc958
 {

47 
°©us
[24];

48 
subcode
[147];

49 
∑d
;

50 
dig_sub‰ame
[4];

51 } 
	t¢d_´s_õc958_t
;

79 
_¢d_˘l_ˇrd_öfo
 
	t¢d_˘l_ˇrd_öfo_t
;

82 
_¢d_˘l_ñem_id
 
	t¢d_˘l_ñem_id_t
;

153 
_¢d_˘l_ñem_li°
 
	t¢d_˘l_ñem_li°_t
;

156 
_¢d_˘l_ñem_öfo
 
	t¢d_˘l_ñem_öfo_t
;

210 
_¢d_˘l_ñem_vÆue
 
	t¢d_˘l_ñem_vÆue_t
;

213 
_¢d_˘l_evít
 
	t¢d_˘l_evít_t
;

216 
	e_¢d_˘l_ñem_ty≥
 {

218 
SND_CTL_ELEM_TYPE_NONE
 = 0,

220 
SND_CTL_ELEM_TYPE_BOOLEAN
,

222 
SND_CTL_ELEM_TYPE_INTEGER
,

224 
SND_CTL_ELEM_TYPE_ENUMERATED
,

226 
SND_CTL_ELEM_TYPE_BYTES
,

228 
SND_CTL_ELEM_TYPE_IEC958
,

230 
SND_CTL_ELEM_TYPE_INTEGER64
,

231 
SND_CTL_ELEM_TYPE_LAST
 = 
SND_CTL_ELEM_TYPE_INTEGER64


232 } 
	t¢d_˘l_ñem_ty≥_t
;

235 
	e_¢d_˘l_ñem_iÁ˚
 {

237 
SND_CTL_ELEM_IFACE_CARD
 = 0,

239 
SND_CTL_ELEM_IFACE_HWDEP
,

241 
SND_CTL_ELEM_IFACE_MIXER
,

243 
SND_CTL_ELEM_IFACE_PCM
,

245 
SND_CTL_ELEM_IFACE_RAWMIDI
,

247 
SND_CTL_ELEM_IFACE_TIMER
,

249 
SND_CTL_ELEM_IFACE_SEQUENCER
,

250 
SND_CTL_ELEM_IFACE_LAST
 = 
SND_CTL_ELEM_IFACE_SEQUENCER


251 } 
	t¢d_˘l_ñem_iÁ˚_t
;

254 
	e_¢d_˘l_evít_ty≥
 {

256 
SND_CTL_EVENT_ELEM
 = 0,

257 
SND_CTL_EVENT_LAST
 = 
SND_CTL_EVENT_ELEM


258 }
	t¢d_˘l_evít_ty≥_t
;

262 
	#SND_CTL_EVENT_MASK_REMOVE
 (~0U)

	)

264 
	#SND_CTL_EVENT_MASK_VALUE
 (1<<0)

	)

266 
	#SND_CTL_EVENT_MASK_INFO
 (1<<1)

	)

268 
	#SND_CTL_EVENT_MASK_ADD
 (1<<2)

	)

270 
	#SND_CTL_EVENT_MASK_TLV
 (1<<3)

	)

273 
	#SND_CTL_NAME_NONE
 ""

	)

275 
	#SND_CTL_NAME_PLAYBACK
 "Pœyback "

	)

277 
	#SND_CTL_NAME_CAPTURE
 "C≠tuª "

	)

280 
	#SND_CTL_NAME_IEC958_NONE
 ""

	)

282 
	#SND_CTL_NAME_IEC958_SWITCH
 "Swôch"

	)

284 
	#SND_CTL_NAME_IEC958_VOLUME
 "Vﬁume"

	)

286 
	#SND_CTL_NAME_IEC958_DEFAULT
 "DeÁu…"

	)

288 
	#SND_CTL_NAME_IEC958_MASK
 "Mask"

	)

290 
	#SND_CTL_NAME_IEC958_CON_MASK
 "C⁄ Mask"

	)

292 
	#SND_CTL_NAME_IEC958_PRO_MASK
 "PrÿMask"

	)

294 
	#SND_CTL_NAME_IEC958_PCM_STREAM
 "PCM Såóm"

	)

296 
	#SND_CTL_NAME_IEC958
(
ex∂
,
dúe˘i⁄
,
wh©
Ë"IEC958 "Éx∂ 
SND_CTL_NAME_
##dúe˘i⁄ 
SND_CTL_NAME_IEC958_
##
	)
what

299 
	#SND_CTL_POWER_MASK
 0xff00

	)

301 
	#SND_CTL_POWER_D0
 0x0000

	)

303 
	#SND_CTL_POWER_D1
 0x0100

	)

305 
	#SND_CTL_POWER_D2
 0x0200

	)

307 
	#SND_CTL_POWER_D3
 0x0300

	)

309 
	#SND_CTL_POWER_D3hŸ
 (
SND_CTL_POWER_D3
|0x0000)

	)

311 
	#SND_CTL_POWER_D3cﬁd
 (
SND_CTL_POWER_D3
|0x0001)

	)

314 
	#SND_CTL_TLVT_CONTAINER
 0x0000

	)

316 
	#SND_CTL_TLVT_DB_SCALE
 0x0001

	)

318 
	#SND_CTL_TLVT_DB_LINEAR
 0x0002

	)

320 
	#SND_CTL_TLVT_DB_RANGE
 0x0003

	)

322 
	#SND_CTL_TLVT_DB_MINMAX
 0x0004

	)

324 
	#SND_CTL_TLVT_DB_MINMAX_MUTE
 0x0005

	)

327 
	#SND_CTL_TLV_DB_GAIN_MUTE
 -9999999

	)

330 
	#SND_CTL_TLVT_CHMAP_FIXED
 0x00101

	)

332 
	#SND_CTL_TLVT_CHMAP_VAR
 0x00102

	)

334 
	#SND_CTL_TLVT_CHMAP_PAIRED
 0x00103

	)

337 
	e_¢d_˘l_ty≥
 {

339 
SND_CTL_TYPE_HW
,

341 
SND_CTL_TYPE_SHM
,

343 
SND_CTL_TYPE_INET
,

345 
SND_CTL_TYPE_EXT
,

347 
SND_CTL_TYPE_REMAP
,

348 } 
	t¢d_˘l_ty≥_t
;

351 
	#SND_CTL_NONBLOCK
 0x0001

	)

354 
	#SND_CTL_ASYNC
 0x0002

	)

357 
	#SND_CTL_READONLY
 0x0004

	)

360 
	#SND_CTL_EINTR
 0x0080

	)

363 
_¢d_˘l
 
	t¢d_˘l_t
;

366 
	#SND_SCTL_NOFREE
 0x0001

	)

369 
_¢d_s˘l
 
	t¢d_s˘l_t
;

371 
¢d_ˇrd_lﬂd
(
ˇrd
);

372 
¢d_ˇrd_√xt
(*
ˇrd
);

373 
¢d_ˇrd_gë_ödex
(c⁄° *
«me
);

374 
¢d_ˇrd_gë_«me
(
ˇrd
, **
«me
);

375 
¢d_ˇrd_gë_l⁄g«me
(
ˇrd
, **
«me
);

377 
¢d_˘l_›í
(
¢d_˘l_t
 **
˘l
, c⁄° *
«me
, 
mode
);

378 
¢d_˘l_›í_lc⁄f
(
¢d_˘l_t
 **
˘l
, c⁄° *
«me
, 
mode
, 
¢d_c⁄fig_t
 *
lc⁄f
);

379 
¢d_˘l_›í_ÁŒback
(
¢d_˘l_t
 **
˘l
, 
¢d_c⁄fig_t
 *
roŸ
, c⁄° *
«me
, c⁄° *
‹ig_«me
, 
mode
);

380 
¢d_˘l_˛o£
(
¢d_˘l_t
 *
˘l
);

381 
¢d_˘l_n⁄block
(
¢d_˘l_t
 *
˘l
, 
n⁄block
);

382 
__ölöe__
 
¢d_˘l_ab‹t
(
¢d_˘l_t
 *
˘l
Ë{  
¢d_˘l_n⁄block
(ctl, 2); }

383 
¢d_async_add_˘l_h™dÀr
(
¢d_async_h™dÀr_t
 **
h™dÀr
, 
¢d_˘l_t
 *
˘l
,

384 
¢d_async_ˇŒback_t
 
ˇŒback
, *
¥iv©e_d©a
);

385 
¢d_˘l_t
 *
¢d_async_h™dÀr_gë_˘l
(
¢d_async_h™dÀr_t
 *
h™dÀr
);

386 
¢d_˘l_pﬁl_des¸ùt‹s_cou¡
(
¢d_˘l_t
 *
˘l
);

387 
¢d_˘l_pﬁl_des¸ùt‹s
(
¢d_˘l_t
 *
˘l
, 
pﬁlfd
 *
pfds
, 
•a˚
);

388 
¢d_˘l_pﬁl_des¸ùt‹s_ªvíts
(
¢d_˘l_t
 *
˘l
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
);

389 
¢d_˘l_subs¸ibe_evíts
(
¢d_˘l_t
 *
˘l
, 
subs¸ibe
);

390 
¢d_˘l_ˇrd_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ˇrd_öfo_t
 *
öfo
);

391 
¢d_˘l_ñem_li°
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_li°_t
 *
li°
);

392 
¢d_˘l_ñem_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
);

393 
¢d_˘l_ñem_ªad
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_vÆue_t
 *
d©a
);

394 
¢d_˘l_ñem_wrôe
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_vÆue_t
 *
d©a
);

395 
¢d_˘l_ñem_lock
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_id_t
 *
id
);

396 
¢d_˘l_ñem_u∆ock
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_id_t
 *
id
);

397 
¢d_˘l_ñem_év_ªad
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

398 *
év
, 
év_size
);

399 
¢d_˘l_ñem_év_wrôe
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

400 c⁄° *
év
);

401 
¢d_˘l_ñem_év_comm™d
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

402 c⁄° *
év
);

403 #ifde‡
__ALSA_HWDEP_H


404 
¢d_˘l_hwdï_√xt_devi˚
(
¢d_˘l_t
 *
˘l
, * 
devi˚
);

405 
¢d_˘l_hwdï_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_hwdï_öfo_t
 * 
öfo
);

407 #ifde‡
__ALSA_PCM_H


408 
¢d_˘l_pcm_√xt_devi˚
(
¢d_˘l_t
 *
˘l
, *
devi˚
);

409 
¢d_˘l_pcm_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_pcm_öfo_t
 * 
öfo
);

410 
¢d_˘l_pcm_¥e„r_subdevi˚
(
¢d_˘l_t
 *
˘l
, 
subdev
);

412 #ifde‡
__ALSA_RAWMIDI_H


413 
¢d_˘l_øwmidi_√xt_devi˚
(
¢d_˘l_t
 *
˘l
, * 
devi˚
);

414 
¢d_˘l_øwmidi_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_øwmidi_öfo_t
 * 
öfo
);

415 
¢d_˘l_øwmidi_¥e„r_subdevi˚
(
¢d_˘l_t
 *
˘l
, 
subdev
);

417 #ifde‡
__ALSA_UMP_H


418 
¢d_˘l_ump_√xt_devi˚
(
¢d_˘l_t
 *
˘l
, *
devi˚
);

419 
¢d_˘l_ump_ídpoöt_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

420 
¢d_˘l_ump_block_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_ump_block_öfo_t
 *
öfo
);

422 
¢d_˘l_£t_powî_°©e
(
¢d_˘l_t
 *
˘l
, 
°©e
);

423 
¢d_˘l_gë_powî_°©e
(
¢d_˘l_t
 *
˘l
, *
°©e
);

425 
¢d_˘l_ªad
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_evít_t
 *
evít
);

426 
¢d_˘l_waô
(
¢d_˘l_t
 *
˘l
, 
timeout
);

427 c⁄° *
¢d_˘l_«me
(
¢d_˘l_t
 *
˘l
);

428 
¢d_˘l_ty≥_t
 
¢d_˘l_ty≥
(
¢d_˘l_t
 *
˘l
);

430 c⁄° *
¢d_˘l_ñem_ty≥_«me
(
¢d_˘l_ñem_ty≥_t
 
ty≥
);

431 c⁄° *
¢d_˘l_ñem_iÁ˚_«me
(
¢d_˘l_ñem_iÁ˚_t
 
iÁ˚
);

432 c⁄° *
¢d_˘l_evít_ty≥_«me
(
¢d_˘l_evít_ty≥_t
 
ty≥
);

434 
¢d_˘l_evít_ñem_gë_mask
(c⁄° 
¢d_˘l_evít_t
 *
obj
);

435 
¢d_˘l_evít_ñem_gë_numid
(c⁄° 
¢d_˘l_evít_t
 *
obj
);

436 
¢d_˘l_evít_ñem_gë_id
(c⁄° 
¢d_˘l_evít_t
 *
obj
, 
¢d_˘l_ñem_id_t
 *
±r
);

437 
¢d_˘l_ñem_iÁ˚_t
 
¢d_˘l_evít_ñem_gë_öãrÁ˚
(c⁄° 
¢d_˘l_evít_t
 *
obj
);

438 
¢d_˘l_evít_ñem_gë_devi˚
(c⁄° 
¢d_˘l_evít_t
 *
obj
);

439 
¢d_˘l_evít_ñem_gë_subdevi˚
(c⁄° 
¢d_˘l_evít_t
 *
obj
);

440 c⁄° *
¢d_˘l_evít_ñem_gë_«me
(c⁄° 
¢d_˘l_evít_t
 *
obj
);

441 
¢d_˘l_evít_ñem_gë_ödex
(c⁄° 
¢d_˘l_evít_t
 *
obj
);

443 
¢d_˘l_ñem_li°_Æloc_•a˚
(
¢d_˘l_ñem_li°_t
 *
obj
, 
íåõs
);

444 
¢d_˘l_ñem_li°_‰ì_•a˚
(
¢d_˘l_ñem_li°_t
 *
obj
);

446 *
¢d_˘l_ascii_ñem_id_gë
(
¢d_˘l_ñem_id_t
 *
id
);

447 
¢d_˘l_ascii_ñem_id_∑r£
(
¢d_˘l_ñem_id_t
 *
d°
, c⁄° *
°r
);

448 
¢d_˘l_ascii_vÆue_∑r£
(
¢d_˘l_t
 *
h™dÀ
,

449 
¢d_˘l_ñem_vÆue_t
 *
d°
,

450 
¢d_˘l_ñem_öfo_t
 *
öfo
,

451 c⁄° *
vÆue
);

453 
size_t
 
¢d_˘l_ñem_id_sizeof
();

458 
	#¢d_˘l_ñem_id_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_˘l_ñem_id
)

	)

459 
¢d_˘l_ñem_id_mÆloc
(
¢d_˘l_ñem_id_t
 **
±r
);

460 
¢d_˘l_ñem_id_‰ì
(
¢d_˘l_ñem_id_t
 *
obj
);

461 
¢d_˘l_ñem_id_˛ór
(
¢d_˘l_ñem_id_t
 *
obj
);

462 
¢d_˘l_ñem_id_c›y
(
¢d_˘l_ñem_id_t
 *
d°
, c⁄° snd_˘l_ñem_id_à*
§c
);

463 
¢d_˘l_ñem_id_com∑ª_numid
(c⁄° 
¢d_˘l_ñem_id_t
 *
id1
, c⁄° snd_˘l_ñem_id_à*
id2
);

464 
¢d_˘l_ñem_id_com∑ª_£t
(c⁄° 
¢d_˘l_ñem_id_t
 *
id1
, c⁄° snd_˘l_ñem_id_à*
id2
);

465 
¢d_˘l_ñem_id_gë_numid
(c⁄° 
¢d_˘l_ñem_id_t
 *
obj
);

466 
¢d_˘l_ñem_iÁ˚_t
 
¢d_˘l_ñem_id_gë_öãrÁ˚
(c⁄° 
¢d_˘l_ñem_id_t
 *
obj
);

467 
¢d_˘l_ñem_id_gë_devi˚
(c⁄° 
¢d_˘l_ñem_id_t
 *
obj
);

468 
¢d_˘l_ñem_id_gë_subdevi˚
(c⁄° 
¢d_˘l_ñem_id_t
 *
obj
);

469 c⁄° *
¢d_˘l_ñem_id_gë_«me
(c⁄° 
¢d_˘l_ñem_id_t
 *
obj
);

470 
¢d_˘l_ñem_id_gë_ödex
(c⁄° 
¢d_˘l_ñem_id_t
 *
obj
);

471 
¢d_˘l_ñem_id_£t_numid
(
¢d_˘l_ñem_id_t
 *
obj
, 
vÆ
);

472 
¢d_˘l_ñem_id_£t_öãrÁ˚
(
¢d_˘l_ñem_id_t
 *
obj
, 
¢d_˘l_ñem_iÁ˚_t
 
vÆ
);

473 
¢d_˘l_ñem_id_£t_devi˚
(
¢d_˘l_ñem_id_t
 *
obj
, 
vÆ
);

474 
¢d_˘l_ñem_id_£t_subdevi˚
(
¢d_˘l_ñem_id_t
 *
obj
, 
vÆ
);

475 
¢d_˘l_ñem_id_£t_«me
(
¢d_˘l_ñem_id_t
 *
obj
, c⁄° *
vÆ
);

476 
¢d_˘l_ñem_id_£t_ödex
(
¢d_˘l_ñem_id_t
 *
obj
, 
vÆ
);

478 
size_t
 
¢d_˘l_ˇrd_öfo_sizeof
();

491 
	#¢d_˘l_ˇrd_öfo_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_˘l_ˇrd_öfo
)

	)

493 
¢d_˘l_ˇrd_öfo_mÆloc
(
¢d_˘l_ˇrd_öfo_t
 **
±r
);

494 
¢d_˘l_ˇrd_öfo_‰ì
(
¢d_˘l_ˇrd_öfo_t
 *
obj
);

495 
¢d_˘l_ˇrd_öfo_˛ór
(
¢d_˘l_ˇrd_öfo_t
 *
obj
);

496 
¢d_˘l_ˇrd_öfo_c›y
(
¢d_˘l_ˇrd_öfo_t
 *
d°
, c⁄° snd_˘l_ˇrd_öfo_à*
§c
);

497 
¢d_˘l_ˇrd_öfo_gë_ˇrd
(c⁄° 
¢d_˘l_ˇrd_öfo_t
 *
obj
);

498 c⁄° *
¢d_˘l_ˇrd_öfo_gë_id
(c⁄° 
¢d_˘l_ˇrd_öfo_t
 *
obj
);

499 c⁄° *
¢d_˘l_ˇrd_öfo_gë_drivî
(c⁄° 
¢d_˘l_ˇrd_öfo_t
 *
obj
);

500 c⁄° *
¢d_˘l_ˇrd_öfo_gë_«me
(c⁄° 
¢d_˘l_ˇrd_öfo_t
 *
obj
);

501 c⁄° *
¢d_˘l_ˇrd_öfo_gë_l⁄g«me
(c⁄° 
¢d_˘l_ˇrd_öfo_t
 *
obj
);

502 c⁄° *
¢d_˘l_ˇrd_öfo_gë_mixî«me
(c⁄° 
¢d_˘l_ˇrd_öfo_t
 *
obj
);

503 c⁄° *
¢d_˘l_ˇrd_öfo_gë_comp⁄íts
(c⁄° 
¢d_˘l_ˇrd_öfo_t
 *
obj
);

505 
size_t
 
¢d_˘l_evít_sizeof
();

510 
	#¢d_˘l_evít_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_˘l_evít
)

	)

511 
¢d_˘l_evít_mÆloc
(
¢d_˘l_evít_t
 **
±r
);

512 
¢d_˘l_evít_‰ì
(
¢d_˘l_evít_t
 *
obj
);

513 
¢d_˘l_evít_˛ór
(
¢d_˘l_evít_t
 *
obj
);

514 
¢d_˘l_evít_c›y
(
¢d_˘l_evít_t
 *
d°
, c⁄° snd_˘l_evít_à*
§c
);

515 
¢d_˘l_evít_ty≥_t
 
¢d_˘l_evít_gë_ty≥
(c⁄° 
¢d_˘l_evít_t
 *
obj
);

517 
size_t
 
¢d_˘l_ñem_li°_sizeof
();

528 
	#¢d_˘l_ñem_li°_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_˘l_ñem_li°
)

	)

530 
¢d_˘l_ñem_li°_mÆloc
(
¢d_˘l_ñem_li°_t
 **
±r
);

531 
¢d_˘l_ñem_li°_‰ì
(
¢d_˘l_ñem_li°_t
 *
obj
);

532 
¢d_˘l_ñem_li°_˛ór
(
¢d_˘l_ñem_li°_t
 *
obj
);

533 
¢d_˘l_ñem_li°_c›y
(
¢d_˘l_ñem_li°_t
 *
d°
, c⁄° snd_˘l_ñem_li°_à*
§c
);

534 
¢d_˘l_ñem_li°_£t_off£t
(
¢d_˘l_ñem_li°_t
 *
obj
, 
vÆ
);

535 
¢d_˘l_ñem_li°_gë_u£d
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
);

536 
¢d_˘l_ñem_li°_gë_cou¡
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
);

537 
¢d_˘l_ñem_li°_gë_id
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
, 
idx
, 
¢d_˘l_ñem_id_t
 *
±r
);

538 
¢d_˘l_ñem_li°_gë_numid
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
, 
idx
);

539 
¢d_˘l_ñem_iÁ˚_t
 
¢d_˘l_ñem_li°_gë_öãrÁ˚
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
, 
idx
);

540 
¢d_˘l_ñem_li°_gë_devi˚
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
, 
idx
);

541 
¢d_˘l_ñem_li°_gë_subdevi˚
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
, 
idx
);

542 c⁄° *
¢d_˘l_ñem_li°_gë_«me
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
, 
idx
);

543 
¢d_˘l_ñem_li°_gë_ödex
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
, 
idx
);

545 
size_t
 
¢d_˘l_ñem_öfo_sizeof
();

550 
	#¢d_˘l_ñem_öfo_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_˘l_ñem_öfo
)

	)

551 
¢d_˘l_ñem_öfo_mÆloc
(
¢d_˘l_ñem_öfo_t
 **
±r
);

552 
¢d_˘l_ñem_öfo_‰ì
(
¢d_˘l_ñem_öfo_t
 *
obj
);

553 
¢d_˘l_ñem_öfo_˛ór
(
¢d_˘l_ñem_öfo_t
 *
obj
);

554 
¢d_˘l_ñem_öfo_c›y
(
¢d_˘l_ñem_öfo_t
 *
d°
, c⁄° snd_˘l_ñem_öfo_à*
§c
);

555 
¢d_˘l_ñem_ty≥_t
 
¢d_˘l_ñem_öfo_gë_ty≥
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

556 
¢d_˘l_ñem_öfo_is_ªadabÀ
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

557 
¢d_˘l_ñem_öfo_is_wrôabÀ
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

558 
¢d_˘l_ñem_öfo_is_vﬁ©ûe
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

559 
¢d_˘l_ñem_öfo_is_öa˘ive
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

560 
¢d_˘l_ñem_öfo_is_locked
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

561 
¢d_˘l_ñem_öfo_is_év_ªadabÀ
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

562 
¢d_˘l_ñem_öfo_is_év_wrôabÀ
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

563 
¢d_˘l_ñem_öfo_is_év_comm™dabÀ
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

564 
¢d_˘l_ñem_öfo_is_ow√r
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

565 
¢d_˘l_ñem_öfo_is_u£r
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

566 
pid_t
 
¢d_˘l_ñem_öfo_gë_ow√r
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

567 
¢d_˘l_ñem_öfo_gë_cou¡
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

568 
¢d_˘l_ñem_öfo_gë_mö
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

569 
¢d_˘l_ñem_öfo_gë_max
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

570 
¢d_˘l_ñem_öfo_gë_°ï
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

571 
¢d_˘l_ñem_öfo_gë_mö64
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

572 
¢d_˘l_ñem_öfo_gë_max64
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

573 
¢d_˘l_ñem_öfo_gë_°ï64
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

574 
¢d_˘l_ñem_öfo_gë_ôems
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

575 
¢d_˘l_ñem_öfo_£t_ôem
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
vÆ
);

576 c⁄° *
¢d_˘l_ñem_öfo_gë_ôem_«me
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

577 
¢d_˘l_ñem_öfo_gë_dimísi⁄s
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

578 
¢d_˘l_ñem_öfo_gë_dimísi⁄
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
, 
idx
);

579 
¢d_˘l_ñem_öfo_£t_dimísi⁄
(
¢d_˘l_ñem_öfo_t
 *
öfo
,

580 c⁄° 
dimísi⁄
[4]);

581 
¢d_˘l_ñem_öfo_gë_id
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
, 
¢d_˘l_ñem_id_t
 *
±r
);

582 
¢d_˘l_ñem_öfo_gë_numid
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

583 
¢d_˘l_ñem_iÁ˚_t
 
¢d_˘l_ñem_öfo_gë_öãrÁ˚
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

584 
¢d_˘l_ñem_öfo_gë_devi˚
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

585 
¢d_˘l_ñem_öfo_gë_subdevi˚
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

586 c⁄° *
¢d_˘l_ñem_öfo_gë_«me
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

587 
¢d_˘l_ñem_öfo_gë_ödex
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

588 
¢d_˘l_ñem_öfo_£t_id
(
¢d_˘l_ñem_öfo_t
 *
obj
, c⁄° 
¢d_˘l_ñem_id_t
 *
±r
);

589 
¢d_˘l_ñem_öfo_£t_numid
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
vÆ
);

590 
¢d_˘l_ñem_öfo_£t_öãrÁ˚
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
¢d_˘l_ñem_iÁ˚_t
 
vÆ
);

591 
¢d_˘l_ñem_öfo_£t_devi˚
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
vÆ
);

592 
¢d_˘l_ñem_öfo_£t_subdevi˚
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
vÆ
);

593 
¢d_˘l_ñem_öfo_£t_«me
(
¢d_˘l_ñem_öfo_t
 *
obj
, c⁄° *
vÆ
);

594 
¢d_˘l_ñem_öfo_£t_ödex
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
vÆ
);

595 
¢d_˘l_ñem_öfo_£t_ªad_wrôe
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
rvÆ
, 
wvÆ
);

596 
¢d_˘l_ñem_öfo_£t_év_ªad_wrôe
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
rvÆ
, 
wvÆ
);

597 
¢d_˘l_ñem_öfo_£t_öa˘ive
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
vÆ
);

599 
¢d_˘l_add_öãgî_ñem_£t
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
,

600 
ñemít_cou¡
,

601 
membî_cou¡
,

602 
mö
, 
max
, 
°ï
);

603 
¢d_˘l_add_öãgî64_ñem_£t
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
,

604 
ñemít_cou¡
,

605 
membî_cou¡
,

606 
mö
, 
max
,

607 
°ï
);

608 
¢d_˘l_add_boﬁón_ñem_£t
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
,

609 
ñemít_cou¡
,

610 
membî_cou¡
);

611 
¢d_˘l_add_íumî©ed_ñem_£t
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
,

612 
ñemít_cou¡
,

613 
membî_cou¡
,

614 
ôems
,

615 c⁄° *c⁄° 
œbñs
[]);

616 
¢d_˘l_add_byãs_ñem_£t
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
,

617 
ñemít_cou¡
,

618 
membî_cou¡
);

620 
¢d_˘l_ñem_add_öãgî
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
, 
cou¡
, 
imö
, 
imax
, 
i°ï
);

621 
¢d_˘l_ñem_add_öãgî64
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
, 
cou¡
, 
imö
, 
imax
, 
i°ï
);

622 
¢d_˘l_ñem_add_boﬁón
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
, 
cou¡
);

623 
¢d_˘l_ñem_add_íumî©ed
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
, 
cou¡
, 
ôems
, c⁄° *c⁄° 
«mes
[]);

624 
¢d_˘l_ñem_add_õc958
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
);

625 
¢d_˘l_ñem_ªmove
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_id_t
 *
id
);

627 
size_t
 
¢d_˘l_ñem_vÆue_sizeof
();

640 
	#¢d_˘l_ñem_vÆue_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_˘l_ñem_vÆue
)

	)

642 
¢d_˘l_ñem_vÆue_mÆloc
(
¢d_˘l_ñem_vÆue_t
 **
±r
);

643 
¢d_˘l_ñem_vÆue_‰ì
(
¢d_˘l_ñem_vÆue_t
 *
obj
);

644 
¢d_˘l_ñem_vÆue_˛ór
(
¢d_˘l_ñem_vÆue_t
 *
obj
);

645 
¢d_˘l_ñem_vÆue_c›y
(
¢d_˘l_ñem_vÆue_t
 *
d°
, c⁄° snd_˘l_ñem_vÆue_à*
§c
);

646 
¢d_˘l_ñem_vÆue_com∑ª
(
¢d_˘l_ñem_vÆue_t
 *
À·
, c⁄° snd_˘l_ñem_vÆue_à*
right
);

647 
¢d_˘l_ñem_vÆue_gë_id
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
, 
¢d_˘l_ñem_id_t
 *
±r
);

648 
¢d_˘l_ñem_vÆue_gë_numid
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
);

649 
¢d_˘l_ñem_iÁ˚_t
 
¢d_˘l_ñem_vÆue_gë_öãrÁ˚
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
);

650 
¢d_˘l_ñem_vÆue_gë_devi˚
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
);

651 
¢d_˘l_ñem_vÆue_gë_subdevi˚
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
);

652 c⁄° *
¢d_˘l_ñem_vÆue_gë_«me
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
);

653 
¢d_˘l_ñem_vÆue_gë_ödex
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
);

654 
¢d_˘l_ñem_vÆue_£t_id
(
¢d_˘l_ñem_vÆue_t
 *
obj
, c⁄° 
¢d_˘l_ñem_id_t
 *
±r
);

655 
¢d_˘l_ñem_vÆue_£t_numid
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
vÆ
);

656 
¢d_˘l_ñem_vÆue_£t_öãrÁ˚
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
¢d_˘l_ñem_iÁ˚_t
 
vÆ
);

657 
¢d_˘l_ñem_vÆue_£t_devi˚
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
vÆ
);

658 
¢d_˘l_ñem_vÆue_£t_subdevi˚
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
vÆ
);

659 
¢d_˘l_ñem_vÆue_£t_«me
(
¢d_˘l_ñem_vÆue_t
 *
obj
, c⁄° *
vÆ
);

660 
¢d_˘l_ñem_vÆue_£t_ödex
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
vÆ
);

661 
¢d_˘l_ñem_vÆue_gë_boﬁón
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
);

662 
¢d_˘l_ñem_vÆue_gë_öãgî
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
);

663 
¢d_˘l_ñem_vÆue_gë_öãgî64
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
);

664 
¢d_˘l_ñem_vÆue_gë_íumî©ed
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
);

665 
¢d_˘l_ñem_vÆue_gë_byã
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
);

666 
¢d_˘l_ñem_vÆue_£t_boﬁón
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
, 
vÆ
);

667 
¢d_˘l_ñem_vÆue_£t_öãgî
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
, 
vÆ
);

668 
¢d_˘l_ñem_vÆue_£t_öãgî64
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
, 
vÆ
);

669 
¢d_˘l_ñem_vÆue_£t_íumî©ed
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
, 
vÆ
);

670 
¢d_˘l_ñem_vÆue_£t_byã
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
, 
vÆ
);

671 
¢d_˘l_ñem_£t_byãs
(
¢d_˘l_ñem_vÆue_t
 *
obj
, *
d©a
, 
size_t
 
size
);

672 c⁄° * 
¢d_˘l_ñem_vÆue_gë_byãs
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
);

673 
¢d_˘l_ñem_vÆue_gë_õc958
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
, 
¢d_´s_õc958_t
 *
±r
);

674 
¢d_˘l_ñem_vÆue_£t_õc958
(
¢d_˘l_ñem_vÆue_t
 *
obj
, c⁄° 
¢d_´s_õc958_t
 *
±r
);

676 
¢d_év_∑r£_dB_öfo
(*
év
, 
év_size
,

677 **
db_évp
);

678 
¢d_év_gë_dB_ønge
(*
év
, 
øngemö
, 
øngemax
,

679 *
mö
, *
max
);

680 
¢d_év_c⁄vît_to_dB
(*
év
, 
øngemö
, 
øngemax
,

681 
vﬁume
, *
db_gaö
);

682 
¢d_év_c⁄vît_‰om_dB
(*
év
, 
øngemö
, 
øngemax
,

683 
db_gaö
, *
vÆue
, 
xdú
);

684 
¢d_˘l_gë_dB_ønge
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

685 *
mö
, *
max
);

686 
¢d_˘l_c⁄vît_to_dB
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

687 
vﬁume
, *
db_gaö
);

688 
¢d_˘l_c⁄vît_‰om_dB
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

689 
db_gaö
, *
vÆue
, 
xdú
);

700 
_¢d_h˘l_ñem
 
	t¢d_h˘l_ñem_t
;

703 
_¢d_h˘l
 
	t¢d_h˘l_t
;

711 (*
¢d_h˘l_com∑ª_t
)(c⁄° 
	t¢d_h˘l_ñem_t
 *
	te1
,

712 c⁄° 
	t¢d_h˘l_ñem_t
 *
	te2
);

713 
¢d_h˘l_com∑ª_Á°
(c⁄° 
¢d_h˘l_ñem_t
 *
c1
,

714 c⁄° 
¢d_h˘l_ñem_t
 *
c2
);

722 (*
¢d_h˘l_ˇŒback_t
)(
	t¢d_h˘l_t
 *
	th˘l
,

723 
	tmask
,

724 
	t¢d_h˘l_ñem_t
 *
	tñem
);

731 (*
¢d_h˘l_ñem_ˇŒback_t
)(
	t¢d_h˘l_ñem_t
 *
	tñem
,

732 
	tmask
);

734 
¢d_h˘l_›í
(
¢d_h˘l_t
 **
h˘l
, c⁄° *
«me
, 
mode
);

735 
¢d_h˘l_›í_˘l
(
¢d_h˘l_t
 **
h˘Õ
, 
¢d_˘l_t
 *
˘l
);

736 
¢d_h˘l_˛o£
(
¢d_h˘l_t
 *
h˘l
);

737 
¢d_h˘l_n⁄block
(
¢d_h˘l_t
 *
h˘l
, 
n⁄block
);

738 
__ölöe__
 
¢d_h˘l_ab‹t
(
¢d_h˘l_t
 *
h˘l
Ë{  
¢d_h˘l_n⁄block
(hctl, 2); }

739 
¢d_h˘l_pﬁl_des¸ùt‹s_cou¡
(
¢d_h˘l_t
 *
h˘l
);

740 
¢d_h˘l_pﬁl_des¸ùt‹s
(
¢d_h˘l_t
 *
h˘l
, 
pﬁlfd
 *
pfds
, 
•a˚
);

741 
¢d_h˘l_pﬁl_des¸ùt‹s_ªvíts
(
¢d_h˘l_t
 *
˘l
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
);

742 
¢d_h˘l_gë_cou¡
(
¢d_h˘l_t
 *
h˘l
);

743 
¢d_h˘l_£t_com∑ª
(
¢d_h˘l_t
 *
h˘l
, 
¢d_h˘l_com∑ª_t
 
hs‹t
);

744 
¢d_h˘l_ñem_t
 *
¢d_h˘l_fú°_ñem
(
¢d_h˘l_t
 *
h˘l
);

745 
¢d_h˘l_ñem_t
 *
¢d_h˘l_œ°_ñem
(
¢d_h˘l_t
 *
h˘l
);

746 
¢d_h˘l_ñem_t
 *
¢d_h˘l_föd_ñem
(
¢d_h˘l_t
 *
h˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
);

747 
¢d_h˘l_£t_ˇŒback
(
¢d_h˘l_t
 *
h˘l
, 
¢d_h˘l_ˇŒback_t
 
ˇŒback
);

748 
¢d_h˘l_£t_ˇŒback_¥iv©e
(
¢d_h˘l_t
 *
h˘l
, *
d©a
);

749 *
¢d_h˘l_gë_ˇŒback_¥iv©e
(
¢d_h˘l_t
 *
h˘l
);

750 
¢d_h˘l_lﬂd
(
¢d_h˘l_t
 *
h˘l
);

751 
¢d_h˘l_‰ì
(
¢d_h˘l_t
 *
h˘l
);

752 
¢d_h˘l_h™dÀ_evíts
(
¢d_h˘l_t
 *
h˘l
);

753 c⁄° *
¢d_h˘l_«me
(
¢d_h˘l_t
 *
h˘l
);

754 
¢d_h˘l_waô
(
¢d_h˘l_t
 *
h˘l
, 
timeout
);

755 
¢d_˘l_t
 *
¢d_h˘l_˘l
(
¢d_h˘l_t
 *
h˘l
);

757 
¢d_h˘l_ñem_t
 *
¢d_h˘l_ñem_√xt
(¢d_h˘l_ñem_à*
ñem
);

758 
¢d_h˘l_ñem_t
 *
¢d_h˘l_ñem_¥ev
(¢d_h˘l_ñem_à*
ñem
);

759 
¢d_h˘l_ñem_öfo
(
¢d_h˘l_ñem_t
 *
ñem
, 
¢d_˘l_ñem_öfo_t
 * 
öfo
);

760 
¢d_h˘l_ñem_ªad
(
¢d_h˘l_ñem_t
 *
ñem
, 
¢d_˘l_ñem_vÆue_t
 * 
vÆue
);

761 
¢d_h˘l_ñem_wrôe
(
¢d_h˘l_ñem_t
 *
ñem
, 
¢d_˘l_ñem_vÆue_t
 * 
vÆue
);

762 
¢d_h˘l_ñem_év_ªad
(
¢d_h˘l_ñem_t
 *
ñem
, *
év
, 
év_size
);

763 
¢d_h˘l_ñem_év_wrôe
(
¢d_h˘l_ñem_t
 *
ñem
, c⁄° *
év
);

764 
¢d_h˘l_ñem_év_comm™d
(
¢d_h˘l_ñem_t
 *
ñem
, c⁄° *
év
);

766 
¢d_h˘l_t
 *
¢d_h˘l_ñem_gë_h˘l
(
¢d_h˘l_ñem_t
 *
ñem
);

768 
¢d_h˘l_ñem_gë_id
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
, 
¢d_˘l_ñem_id_t
 *
±r
);

769 
¢d_h˘l_ñem_gë_numid
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
);

770 
¢d_˘l_ñem_iÁ˚_t
 
¢d_h˘l_ñem_gë_öãrÁ˚
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
);

771 
¢d_h˘l_ñem_gë_devi˚
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
);

772 
¢d_h˘l_ñem_gë_subdevi˚
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
);

773 c⁄° *
¢d_h˘l_ñem_gë_«me
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
);

774 
¢d_h˘l_ñem_gë_ödex
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
);

775 
¢d_h˘l_ñem_£t_ˇŒback
(
¢d_h˘l_ñem_t
 *
obj
, 
¢d_h˘l_ñem_ˇŒback_t
 
vÆ
);

776 * 
¢d_h˘l_ñem_gë_ˇŒback_¥iv©e
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
);

777 
¢d_h˘l_ñem_£t_ˇŒback_¥iv©e
(
¢d_h˘l_ñem_t
 *
obj
, * 
vÆ
);

790 
¢d_s˘l_buûd
(
¢d_s˘l_t
 **
˘l
, 
¢d_˘l_t
 *
h™dÀ
, 
¢d_c⁄fig_t
 *
c⁄fig
,

791 
¢d_c⁄fig_t
 *
¥iv©e_d©a
, 
mode
);

792 
¢d_s˘l_‰ì
(
¢d_s˘l_t
 *
h™dÀ
);

793 
¢d_s˘l_ö°Æl
(
¢d_s˘l_t
 *
h™dÀ
);

794 
¢d_s˘l_ªmove
(
¢d_s˘l_t
 *
h™dÀ
);

806 
¢d_devi˚_«me_höt
(
ˇrd
, c⁄° *
iÁ˚
, ***
höts
);

807 
¢d_devi˚_«me_‰ì_höt
(**
höts
);

808 *
¢d_devi˚_«me_gë_höt
(c⁄° *
höt
, c⁄° *
id
);

812 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/control_external.h

26 #i‚de‡
__ALSA_CONTROL_EXTERNAL_H


27 
	#__ALSA_CONTROL_EXTERNAL_H


	)

29 
	~"c⁄åﬁ.h
"

31 #ifde‡
__˝lu•lus


43 
	#SND_CTL_PLUGIN_ENTRY
(
«me
Ë
_¢d_˘l_
##«me##
_›í


	)

48 
	#SND_CTL_PLUGIN_SYMBOL
(
«me
Ë
	`SND_DLSYM_BUILD_VERSION
(
	`SND_CTL_PLUGIN_ENTRY
“ame), 
SND_CONTROL_DLSYM_VERSION
);

	)

53 
	#SND_CTL_PLUGIN_DEFINE_FUNC
(
∂ugö
) \

54 
	`SND_CTL_PLUGIN_ENTRY
(
∂ugö
Ë(
¢d_˘l_t
 **
h™dÀp
, c⁄° *
«me
,\

55 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
, 
mode
)

	)

58 
¢d_˘l_ext
 
	t¢d_˘l_ext_t
;

60 
¢d_˘l_ext_ˇŒback
 
	t¢d_˘l_ext_ˇŒback_t
;

62 
	t¢d_˘l_ext_key_t
;

63 #ifde‡
DOC_HIDDEN


65 
¢d_˘l_ext
 
	t¢d_˘l_ext_t
;

66 
¢d_˘l_ext_ˇŒback
 
	t¢d_˘l_ext_ˇŒback_t
;

69 (
¢d_˘l_ext_év_rw_t
)(
	t¢d_˘l_ext_t
 *
	text
, 
	t¢d_˘l_ext_key_t
 
	tkey
, 
	t›_Êag
, 
	tnumid
,

70 *
	tév
, 
	tév_size
);

75 
	#SND_CTL_EXT_VERSION_MAJOR
 1

	)

76 
	#SND_CTL_EXT_VERSION_MINOR
 0

	)

77 
	#SND_CTL_EXT_VERSION_TINY
 1

	)

81 
	#SND_CTL_EXT_VERSION
 ((
SND_CTL_EXT_VERSION_MAJOR
<<16) |\

82 (
SND_CTL_EXT_VERSION_MINOR
<<8) |\

83 (
SND_CTL_EXT_VERSION_TINY
))

	)

86 
	s¢d_˘l_ext
 {

91 
vîsi⁄
;

95 
ˇrd_idx
;

99 
id
[16];

103 
drivî
[16];

107 
«me
[32];

111 
l⁄g«me
[80];

115 
mixî«me
[80];

119 
pﬁl_fd
;

124 c⁄° 
¢d_˘l_ext_ˇŒback_t
 *
ˇŒback
;

128 *
¥iv©e_d©a
;

132 
¢d_˘l_t
 *
h™dÀ
;

134 
n⁄block
;

135 
subs¸ibed
;

141 
¢d_˘l_ext_év_rw_t
 *
c
;

142 c⁄° *
p
;

143 } 
év
;

147 
	s¢d_˘l_ext_ˇŒback
 {

151 (*
˛o£
)(
¢d_˘l_ext_t
 *
ext
);

155 (*
ñem_cou¡
)(
¢d_˘l_ext_t
 *
ext
);

159 (*
ñem_li°
)(
¢d_˘l_ext_t
 *
ext
, 
off£t
, 
¢d_˘l_ñem_id_t
 *
id
);

163 
¢d_˘l_ext_key_t
 (*
föd_ñem
)(
¢d_˘l_ext_t
 *
ext
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
);

167 (*
‰ì_key
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
);

171 (*
gë_©åibuã
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
,

172 *
ty≥
, *
acc
, *
cou¡
);

176 (*
gë_öãgî_öfo
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
,

177 *
imö
, *
imax
, *
i°ï
);

181 (*
gë_öãgî64_öfo
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
,

182 
öt64_t
 *
imö
, i¡64_à*
imax
, i¡64_à*
i°ï
);

186 (*
gë_íumî©ed_öfo
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
, *
ôems
);

190 (*
gë_íumî©ed_«me
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
, 
ôem
,

191 *
«me
, 
size_t
 
«me_max_Àn
);

195 (*
ªad_öãgî
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
, *
vÆue
);

199 (*
ªad_öãgî64
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
, 
öt64_t
 *
vÆue
);

203 (*
ªad_íumî©ed
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
, *
ôems
);

207 (*
ªad_byãs
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
, *
d©a
,

208 
size_t
 
max_byãs
);

212 (*
ªad_õc958
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
, 
¢d_´s_õc958_t
 *
õc958
);

216 (*
wrôe_öãgî
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
, *
vÆue
);

220 (*
wrôe_öãgî64
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
, 
öt64_t
 *
vÆue
);

224 (*
wrôe_íumî©ed
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
, *
ôems
);

228 (*
wrôe_byãs
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
, *
d©a
,

229 
size_t
 
max_byãs
);

233 (*
wrôe_õc958
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ext_key_t
 
key
, 
¢d_´s_õc958_t
 *
õc958
);

237 (*
subs¸ibe_evíts
)(
¢d_˘l_ext_t
 *
ext
, 
subs¸ibe
);

241 (*
ªad_evít
)(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ñem_id_t
 *
id
, *
evít_mask
);

245 (*
pﬁl_des¸ùt‹s_cou¡
)(
¢d_˘l_ext_t
 *
ext
);

249 (*
pﬁl_des¸ùt‹s
)(
¢d_˘l_ext_t
 *
ext
, 
pﬁlfd
 *
pfds
, 
•a˚
);

253 (*
pﬁl_ªvíts
)(
¢d_˘l_ext_t
 *
ext
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
);

259 
	e¢d_˘l_ext_ac˚ss
 {

260 
SND_CTL_EXT_ACCESS_READ
 = (1<<0),

261 
SND_CTL_EXT_ACCESS_WRITE
 = (1<<1),

262 
SND_CTL_EXT_ACCESS_READWRITE
 = (3<<0),

263 
SND_CTL_EXT_ACCESS_VOLATILE
 = (1<<2),

264 
SND_CTL_EXT_ACCESS_TLV_READ
 = (1<<4),

265 
SND_CTL_EXT_ACCESS_TLV_WRITE
 = (1<<5),

266 
SND_CTL_EXT_ACCESS_TLV_READWRITE
 = (3<<4),

267 
SND_CTL_EXT_ACCESS_TLV_COMMAND
 = (1<<6),

268 
SND_CTL_EXT_ACCESS_INACTIVE
 = (1<<8),

269 
SND_CTL_EXT_ACCESS_TLV_CALLBACK
 = (1<<28),

270 } 
	t¢d_˘l_ext_ac˚ss_t
;

275 
	#SND_CTL_EXT_KEY_NOT_FOUND
 (
¢d_˘l_ext_key_t
)(-1)

	)

277 
¢d_˘l_ext_¸óã
(
¢d_˘l_ext_t
 *
ext
, c⁄° *
«me
, 
mode
);

278 
¢d_˘l_ext_dñëe
(
¢d_˘l_ext_t
 *
ext
);

282 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/control_plugin.h

31 #i‚de‡
__ALSA_CONTROL_PLUGIN_H


32 
	#__ALSA_CONTROL_PLUGIN_H


	)

44 
¢d_˘l_hw_›í
(
¢d_˘l_t
 **
h™dÀ
, c⁄° *
«me
, 
ˇrd
, 
mode
);

45 
_¢d_˘l_hw_›í
(
¢d_˘l_t
 **
h™dÀp
, *
«me
, 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
, 
mode
);

50 
¢d_˘l_ªm≠_›í
(
¢d_˘l_t
 **
h™dÀp
, c⁄° *
«me
, 
¢d_c⁄fig_t
 *
ªm≠
,

51 
¢d_c⁄fig_t
 *
m≠
, 
¢d_˘l_t
 *
chûd
, 
mode
);

52 
_¢d_˘l_ªm≠_›í
(
¢d_˘l_t
 **
h™dÀp
, *
«me
, 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
, 
mode
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/error.h

28 #i‚de‡
__ALSA_ERROR_H


29 
	#__ALSA_ERROR_H


	)

31 #ifde‡
__˝lu•lus


41 
	#SND_ERROR_BEGIN
 500000

	)

42 
	#SND_ERROR_INCOMPATIBLE_VERSION
 (
SND_ERROR_BEGIN
+0Ë

	)

43 
	#SND_ERROR_ALISP_NIL
 (
SND_ERROR_BEGIN
+1Ë

	)

45 c⁄° *
¢d_°ªº‹
(
î∫um
);

59 (*
¢d_lib_îr‹_h™dÀr_t
)(c⁄° *
	tfûe
, 
	tlöe
, c⁄° *
	tfun˘i⁄
, 
	tîr
, c⁄° *
	tfmt
, ...) ;

60 
¢d_lib_îr‹_h™dÀr_t
 
¢d_lib_îr‹
;

61 
¢d_lib_îr‹_£t_h™dÀr
(
¢d_lib_îr‹_h™dÀr_t
 
h™dÀr
);

63 #i‡
__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 > 95)

64 
	#SNDERR
(...Ë
	`¢d_lib_îr‹
(
__FILE__
, 
__LINE__
, 
__func__
, 0, 
__VA_ARGS__
Ë

	)

65 
	#SYSERR
(...Ë
	`¢d_lib_îr‹
(
__FILE__
, 
__LINE__
, 
__func__
, 
î∫o
, 
__VA_ARGS__
Ë

	)

67 
	#SNDERR
(
¨gs
...Ë
	`¢d_lib_îr‹
(
__FILE__
, 
__LINE__
, 
__func__
, 0, ##¨gsË

	)

68 
	#SYSERR
(
¨gs
...Ë
	`¢d_lib_îr‹
(
__FILE__
, 
__LINE__
, 
__func__
, 
î∫o
, ##¨gsË

	)

73 #ifde‡
__˝lu•lus


78 (*
	t¢d_loˇl_îr‹_h™dÀr_t
)(c⁄° *
	tfûe
, 
	tlöe
,

79 c⁄° *
	tfunc
, 
	tîr
,

80 c⁄° *
	tfmt
, 
	tva_li°
 
	t¨g
);

82 
¢d_loˇl_îr‹_h™dÀr_t
 
	`¢d_lib_îr‹_£t_loˇl
(¢d_loˇl_îr‹_h™dÀr_à
func
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/global.h

28 #i‚de‡
__ALSA_GLOBAL_H_


29 
	#__ALSA_GLOBAL_H_


	)

32 
	~<time.h
>

34 #ifde‡
__˝lu•lus


47 c⁄° *
¢d_asoundlib_vîsi⁄
();

49 #i‚de‡
ATTRIBUTE_UNUSED


51 
	#ATTRIBUTE_UNUSED
 
	`__©åibuã__
 ((
__unu£d__
))

	)

54 #i‚de‡
__STRING


56 
	#__STRING
(
x
Ë#x

	)

59 #ifde‡
PIC


62 
	#__SND_DLSYM_VERSION
(
«me
, 
vîsi⁄
Ë
_
 ##Çamê## 
	)
version

67 
	#SND_DLSYM_BUILD_VERSION
(
«me
, 
vîsi⁄
Ë
	`__SND_DLSYM_VERSION
“ame, vîsi⁄);

	)

71 
	s¢d_dlsym_lök
 {

72 
¢d_dlsym_lök
 *
√xt
;

73 c⁄° *
dlsym_«me
;

74 c⁄° *
dlsym_±r
;

77 
¢d_dlsym_lök
 *
¢d_dlsym_°¨t
;

80 
	#__SND_DLSYM_VERSION
(
¥efix
, 
«me
, 
vîsi⁄
Ë
_
 ##Öªfix ##Çamê## 
	)
version

85 
	#SND_DLSYM_BUILD_VERSION
(
«me
, 
vîsi⁄
) \

86 
¢d_dlsym_lök
 
	`__SND_DLSYM_VERSION
(
¢d_dlsym_
, 
«me
, 
vîsi⁄
); \

87 
	`__SND_DLSYM_VERSION
(
¢d_dlsym_c⁄°ru˘‹_
, 
«me
, 
vîsi⁄
Ë(Ë
	`__©åibuã__
 ((
c⁄°ru˘‹
)); \

88 
	`__SND_DLSYM_VERSION
(
¢d_dlsym_c⁄°ru˘‹_
, 
«me
, 
vîsi⁄
) () { \

89 
	`__SND_DLSYM_VERSION
(
¢d_dlsym_
, 
«me
, 
vîsi⁄
).
√xt
 = 
¢d_dlsym_°¨t
; \

90 
	`__SND_DLSYM_VERSION
(
¢d_dlsym_
, 
«me
, 
vîsi⁄
).
dlsym_«me
 = 
	`__STRING
(name); \

91 
	`__SND_DLSYM_VERSION
(
¢d_dlsym_
, 
«me
, 
vîsi⁄
).
dlsym_±r
 = (*)&name; \

92 
¢d_dlsym_°¨t
 = &
	`__SND_DLSYM_VERSION
(
¢d_dlsym_
, 
«me
, 
vîsi⁄
); \

93 }

	)

98 
	#SND_DLSYM_VERSION
(
vîsi⁄
Ë
	`__STRING
(vîsi⁄)

	)

100 
¢d_dÕ©h
(*
∑th
, 
size_t
 
∑th_Àn
, c⁄° *
«me
);

101 *
¢d_dl›í
(c⁄° *
fûe
, 
mode
, *
îrbuf
, 
size_t
 
îrbuÊí
);

102 *
¢d_dlsym
(*
h™dÀ
, c⁄° *
«me
, c⁄° *
vîsi⁄
);

103 
¢d_dl˛o£
(*
h™dÀ
);

107 
	#__¢d_Æloˇ
(
±r
,
ty≥
Ëdÿ{ *±∏—y≥##
_t
 *Ë
	`Æloˇ
—y≥##
	`_sizeof
()); 
	`mem£t
(*±r, 0,Åy≥##_sizeof()); } 0)

	)

115 
_¢d_async_h™dÀr
 
	t¢d_async_h™dÀr_t
;

122 (*
	g¢d_async_ˇŒback_t
)(
	t¢d_async_h™dÀr_t
 *
	th™dÀr
);

124 
¢d_async_add_h™dÀr
(
¢d_async_h™dÀr_t
 **
h™dÀr
, 
fd
,

125 
¢d_async_ˇŒback_t
 
ˇŒback
, *
¥iv©e_d©a
);

126 
¢d_async_dñ_h™dÀr
(
¢d_async_h™dÀr_t
 *
h™dÀr
);

127 
¢d_async_h™dÀr_gë_fd
(
¢d_async_h™dÀr_t
 *
h™dÀr
);

128 
¢d_async_h™dÀr_gë_signo
(
¢d_async_h™dÀr_t
 *
h™dÀr
);

129 *
¢d_async_h™dÀr_gë_ˇŒback_¥iv©e
(
¢d_async_h™dÀr_t
 *
h™dÀr
);

131 
¢d_shm_¨ó
 *
¢d_shm_¨ó_¸óã
(
shmid
, *
±r
);

132 
¢d_shm_¨ó
 *
¢d_shm_¨ó_sh¨e
(¢d_shm_¨ó *
¨ó
);

133 
¢d_shm_¨ó_de°roy
(
¢d_shm_¨ó
 *
¨ó
);

135 
¢d_u£r_fûe
(c⁄° *
fûe
, **
ªsu…
);

137 #ifde‡
__GLIBC__


138 #i‡!
deföed
(
_POSIX_C_SOURCE
Ë&& !deföed(
_POSIX_SOURCE
)

139 
	stimevÆ
 {

140 
time_t
 
	gtv_£c
;

141 
	gtv_u£c
;

144 
	stime•ec
 {

145 
time_t
 
	gtv_£c
;

146 
	gtv_n£c
;

152 
timevÆ
 
	t¢d_time°amp_t
;

154 
time•ec
 
	t¢d_htime°amp_t
;

158 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/hwdep.h

28 #i‚de‡
__ALSA_HWDEP_H


29 
	#__ALSA_HWDEP_H


	)

31 #ifde‡
__˝lu•lus


42 
	#SND_HWDEP_DLSYM_VERSION
 
_dlsym_hwdï_001


	)

45 
_¢d_hwdï_öfo
 
	t¢d_hwdï_öfo_t
;

48 
_¢d_hwdï_d•_°©us
 
	t¢d_hwdï_d•_°©us_t
;

51 
_¢d_hwdï_d•_image
 
	t¢d_hwdï_d•_image_t
;

54 
	e_¢d_hwdï_iÁ˚
 {

55 
SND_HWDEP_IFACE_OPL2
 = 0,

56 
SND_HWDEP_IFACE_OPL3
,

57 
SND_HWDEP_IFACE_OPL4
,

58 
SND_HWDEP_IFACE_SB16CSP
,

59 
SND_HWDEP_IFACE_EMU10K1
,

60 
SND_HWDEP_IFACE_YSS225
,

61 
SND_HWDEP_IFACE_ICS2115
,

62 
SND_HWDEP_IFACE_SSCAPE
,

63 
SND_HWDEP_IFACE_VX
,

64 
SND_HWDEP_IFACE_MIXART
,

65 
SND_HWDEP_IFACE_USX2Y
,

66 
SND_HWDEP_IFACE_EMUX_WAVETABLE
,

67 
SND_HWDEP_IFACE_BLUETOOTH
,

68 
SND_HWDEP_IFACE_USX2Y_PCM
,

69 
SND_HWDEP_IFACE_PCXHR
,

70 
SND_HWDEP_IFACE_SB_RC
,

71 
SND_HWDEP_IFACE_HDA
,

72 
SND_HWDEP_IFACE_USB_STREAM
,

73 
SND_HWDEP_IFACE_FW_DICE
,

74 
SND_HWDEP_IFACE_FW_FIREWORKS
,

75 
SND_HWDEP_IFACE_FW_BEBOB
,

76 
SND_HWDEP_IFACE_FW_OXFW
,

77 
SND_HWDEP_IFACE_FW_DIGI00X
,

78 
SND_HWDEP_IFACE_FW_TASCAM
,

79 
SND_HWDEP_IFACE_LINE6
,

80 
SND_HWDEP_IFACE_FW_MOTU
,

81 
SND_HWDEP_IFACE_FW_FIREFACE
,

83 
SND_HWDEP_IFACE_LAST
 = 
SND_HWDEP_IFACE_FW_FIREFACE
,

84 } 
	t¢d_hwdï_iÁ˚_t
;

87 
	#SND_HWDEP_OPEN_READ
 (
O_RDONLY
)

	)

89 
	#SND_HWDEP_OPEN_WRITE
 (
O_WRONLY
)

	)

91 
	#SND_HWDEP_OPEN_DUPLEX
 (
O_RDWR
)

	)

93 
	#SND_HWDEP_OPEN_NONBLOCK
 (
O_NONBLOCK
)

	)

96 
	e_¢d_hwdï_ty≥
 {

98 
SND_HWDEP_TYPE_HW
,

100 
SND_HWDEP_TYPE_SHM
,

102 
SND_HWDEP_TYPE_INET


103 } 
	t¢d_hwdï_ty≥_t
;

106 
_¢d_hwdï
 
	t¢d_hwdï_t
;

108 
¢d_hwdï_›í
(
¢d_hwdï_t
 **
hwdï
, c⁄° *
«me
, 
mode
);

109 
¢d_hwdï_˛o£
(
¢d_hwdï_t
 *
hwdï
);

110 
¢d_hwdï_pﬁl_des¸ùt‹s
(
¢d_hwdï_t
 *
hwdï
, 
pﬁlfd
 *
pfds
, 
•a˚
);

111 
¢d_hwdï_pﬁl_des¸ùt‹s_cou¡
(
¢d_hwdï_t
 *
hwdï
);

112 
¢d_hwdï_pﬁl_des¸ùt‹s_ªvíts
(
¢d_hwdï_t
 *
hwdï
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
);

113 
¢d_hwdï_n⁄block
(
¢d_hwdï_t
 *
hwdï
, 
n⁄block
);

114 
¢d_hwdï_öfo
(
¢d_hwdï_t
 *
hwdï
, 
¢d_hwdï_öfo_t
 * 
öfo
);

115 
¢d_hwdï_d•_°©us
(
¢d_hwdï_t
 *
hwdï
, 
¢d_hwdï_d•_°©us_t
 *
°©us
);

116 
¢d_hwdï_d•_lﬂd
(
¢d_hwdï_t
 *
hwdï
, 
¢d_hwdï_d•_image_t
 *
block
);

117 
¢d_hwdï_io˘l
(
¢d_hwdï_t
 *
hwdï
, 
ªque°
, * 
¨g
);

118 
ssize_t
 
¢d_hwdï_wrôe
(
¢d_hwdï_t
 *
hwdï
, c⁄° *
buf„r
, 
size_t
 
size
);

119 
ssize_t
 
¢d_hwdï_ªad
(
¢d_hwdï_t
 *
hwdï
, *
buf„r
, 
size_t
 
size
);

121 
size_t
 
¢d_hwdï_öfo_sizeof
();

123 
	#¢d_hwdï_öfo_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_hwdï_öfo
)

	)

124 
¢d_hwdï_öfo_mÆloc
(
¢d_hwdï_öfo_t
 **
±r
);

125 
¢d_hwdï_öfo_‰ì
(
¢d_hwdï_öfo_t
 *
obj
);

126 
¢d_hwdï_öfo_c›y
(
¢d_hwdï_öfo_t
 *
d°
, c⁄° snd_hwdï_öfo_à*
§c
);

128 
¢d_hwdï_öfo_gë_devi˚
(c⁄° 
¢d_hwdï_öfo_t
 *
obj
);

129 
¢d_hwdï_öfo_gë_ˇrd
(c⁄° 
¢d_hwdï_öfo_t
 *
obj
);

130 c⁄° *
¢d_hwdï_öfo_gë_id
(c⁄° 
¢d_hwdï_öfo_t
 *
obj
);

131 c⁄° *
¢d_hwdï_öfo_gë_«me
(c⁄° 
¢d_hwdï_öfo_t
 *
obj
);

132 
¢d_hwdï_iÁ˚_t
 
¢d_hwdï_öfo_gë_iÁ˚
(c⁄° 
¢d_hwdï_öfo_t
 *
obj
);

133 
¢d_hwdï_öfo_£t_devi˚
(
¢d_hwdï_öfo_t
 *
obj
, 
vÆ
);

135 
size_t
 
¢d_hwdï_d•_°©us_sizeof
();

137 
	#¢d_hwdï_d•_°©us_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_hwdï_d•_°©us
)

	)

138 
¢d_hwdï_d•_°©us_mÆloc
(
¢d_hwdï_d•_°©us_t
 **
±r
);

139 
¢d_hwdï_d•_°©us_‰ì
(
¢d_hwdï_d•_°©us_t
 *
obj
);

140 
¢d_hwdï_d•_°©us_c›y
(
¢d_hwdï_d•_°©us_t
 *
d°
, c⁄° snd_hwdï_d•_°©us_à*
§c
);

142 
¢d_hwdï_d•_°©us_gë_vîsi⁄
(c⁄° 
¢d_hwdï_d•_°©us_t
 *
obj
);

143 c⁄° *
¢d_hwdï_d•_°©us_gë_id
(c⁄° 
¢d_hwdï_d•_°©us_t
 *
obj
);

144 
¢d_hwdï_d•_°©us_gë_num_d•s
(c⁄° 
¢d_hwdï_d•_°©us_t
 *
obj
);

145 
¢d_hwdï_d•_°©us_gë_d•_lﬂded
(c⁄° 
¢d_hwdï_d•_°©us_t
 *
obj
);

146 
¢d_hwdï_d•_°©us_gë_chù_ªady
(c⁄° 
¢d_hwdï_d•_°©us_t
 *
obj
);

148 
size_t
 
¢d_hwdï_d•_image_sizeof
();

150 
	#¢d_hwdï_d•_image_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_hwdï_d•_image
)

	)

151 
¢d_hwdï_d•_image_mÆloc
(
¢d_hwdï_d•_image_t
 **
±r
);

152 
¢d_hwdï_d•_image_‰ì
(
¢d_hwdï_d•_image_t
 *
obj
);

153 
¢d_hwdï_d•_image_c›y
(
¢d_hwdï_d•_image_t
 *
d°
, c⁄° snd_hwdï_d•_image_à*
§c
);

155 
¢d_hwdï_d•_image_gë_ödex
(c⁄° 
¢d_hwdï_d•_image_t
 *
obj
);

156 c⁄° *
¢d_hwdï_d•_image_gë_«me
(c⁄° 
¢d_hwdï_d•_image_t
 *
obj
);

157 c⁄° *
¢d_hwdï_d•_image_gë_image
(c⁄° 
¢d_hwdï_d•_image_t
 *
obj
);

158 
size_t
 
¢d_hwdï_d•_image_gë_Àngth
(c⁄° 
¢d_hwdï_d•_image_t
 *
obj
);

160 
¢d_hwdï_d•_image_£t_ödex
(
¢d_hwdï_d•_image_t
 *
obj
, 
_ödex
);

161 
¢d_hwdï_d•_image_£t_«me
(
¢d_hwdï_d•_image_t
 *
obj
, c⁄° *
«me
);

162 
¢d_hwdï_d•_image_£t_image
(
¢d_hwdï_d•_image_t
 *
obj
, *
buf„r
);

163 
¢d_hwdï_d•_image_£t_Àngth
(
¢d_hwdï_d•_image_t
 *
obj
, 
size_t
 
Àngth
);

167 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/input.h

28 #i‚de‡
__ALSA_INPUT_H


29 
	#__ALSA_INPUT_H


	)

31 
	~<°d¨g.h
>

33 #ifde‡
__˝lu•lus


56 
_¢d_öput
 
	t¢d_öput_t
;

59 
	e_¢d_öput_ty≥
 {

61 
SND_INPUT_STDIO
,

63 
SND_INPUT_BUFFER


64 } 
	t¢d_öput_ty≥_t
;

66 
¢d_öput_°dio_›í
(
¢d_öput_t
 **
öpuç
, c⁄° *
fûe
, c⁄° *
mode
);

67 
¢d_öput_°dio_©èch
(
¢d_öput_t
 **
öpuç
, 
FILE
 *
Â
, 
_˛o£
);

68 
¢d_öput_buf„r_›í
(
¢d_öput_t
 **
öpuç
, c⁄° *
buf„r
, 
ssize_t
 
size
);

69 
¢d_öput_˛o£
(
¢d_öput_t
 *
öput
);

70 
¢d_öput_sˇnf
(
¢d_öput_t
 *
öput
, c⁄° *
f‹m©
, ...)

71 #i‚de‡
DOC_HIDDEN


72 
__©åibuã__
 ((
f‹m©
 (
sˇnf
, 2, 3)))

75 *
¢d_öput_gës
(
¢d_öput_t
 *
öput
, *
°r
, 
size_t
 
size
);

76 
¢d_öput_gëc
(
¢d_öput_t
 *
öput
);

77 
¢d_öput_ungëc
(
¢d_öput_t
 *
öput
, 
c
);

81 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/list.h

15 #i‚de‡
_LIST_H


16 
	#_LIST_H


	)

18 
	~<°ddef.h
>

20 
	sli°_hód
 {

21 
li°_hód
 *
	m√xt
;

22 
li°_hód
 *
	m¥ev
;

26 
	#LIST_HEAD
(
x
) \

27 
li°_hód
 
x
 = { &x, &x }

	)

30 
ölöe
 
	$INIT_LIST_HEAD
(
li°_hód
 *
p
)

32 
p
->
√xt
 =Ö->
¥ev
 =Ö;

33 
	}
}

35 
	#li°_íåy_off£t
(
p
, 
ty≥
, 
off£t
) \

36 ((
ty≥
 *)((*)(
p
Ë- (
off£t
)))

	)

43 
	#li°_íåy
(
p
, 
ty≥
, 
membî
) \

44 
	`li°_íåy_off£t
(
p
, 
ty≥
, 
	`off£tof
—y≥, 
membî
))

	)

50 
	#li°_f‹_óch
(
p
, 
li°
) \

51 
p
 = (
li°
)->
√xt
;Ö !÷i°);Ö =Ö->√xt)

	)

58 
	#li°_f‹_óch_ß„
(
p
, 
s
, 
li°
) \

59 
p
 = (
li°
)->
√xt
; 
s
 =Ö->√xt,Ö !÷i°);Ö = s)

	)

65 
ölöe
 
	$li°_add
(
li°_hód
 *
p
, li°_hód *
li°
)

67 
li°_hód
 *
fú°
 = 
li°
->
√xt
;

69 
p
->
√xt
 = 
fú°
;

70 
fú°
->
¥ev
 = 
p
;

71 
li°
->
√xt
 = 
p
;

72 
p
->
¥ev
 = 
li°
;

73 
	}
}

79 
ölöe
 
	$li°_add_èû
(
li°_hód
 *
p
, li°_hód *
li°
)

81 
li°_hód
 *
œ°
 = 
li°
->
¥ev
;

83 
œ°
->
√xt
 = 
p
;

84 
p
->
¥ev
 = 
œ°
;

85 
p
->
√xt
 = 
li°
;

86 
li°
->
¥ev
 = 
p
;

87 
	}
}

94 
ölöe
 
	$li°_ö£π
(
li°_hód
 *
p
,

95 
li°_hód
 *
¥ev
,

96 
li°_hód
 *
√xt
)

98 
√xt
->
¥ev
 = 
p
;

99 
p
->
√xt
 =Çext;

100 
p
->
¥ev
 =Örev;

101 
¥ev
->
√xt
 = 
p
;

102 
	}
}

105 
ölöe
 
	$li°_dñ
(
li°_hód
 *
p
)

107 
p
->
¥ev
->
√xt
 =Ö->next;

108 
p
->
√xt
->
¥ev
 =Ö->prev;

109 
	}
}

112 
ölöe
 
	$li°_em±y
(c⁄° 
li°_hód
 *
p
)

114  
p
->
√xt
 ==Ö;

115 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/local.h

22 #i‚de‡
__LOCAL_H


23 
	#__LOCAL_H


	)

25 
	~"c⁄fig.h
"

27 
	~<uni°d.h
>

28 
	~<°dio.h
>

29 
	~<°dlib.h
>

30 
	~<°rög.h
>

31 
	~<f˙é.h
>

32 
	~<as£π.h
>

33 #ifde‡
HAVE_ENDIAN_H


34 
	~<ídün.h
>

35 #ñi‡
deföed
(
HAVE_SYS_ENDIAN_H
)

36 
	~<sys/ídün.h
>

38 #îr‹ 
Hódî
 
deföög
 
ídü¬ess
 
nŸ
 
deföed


40 #i‚de‡
__BYTE_ORDER


41 
	#__BYTE_ORDER
 
BYTE_ORDER


	)

43 #i‚de‡
__LITTLE_ENDIAN


44 
	#__LITTLE_ENDIAN
 
LITTLE_ENDIAN


	)

46 #i‚de‡
__BIG_ENDIAN


47 
	#__BIG_ENDIAN
 
BIG_ENDIAN


	)

49 
	~<°d¨g.h
>

50 
	~<pﬁl.h
>

51 
	~<sys/ty≥s.h
>

52 
	~<î∫o.h
>

53 #i‡
deföed
(
__löux__
)

54 
	~<löux/ty≥s.h
>

55 
	~<löux/io˘l.h
>

57 
	~"ty≥_com∑t.h
"

60 #ifde‡
SUPPORT_RESMGR


61 
	~<ªsmgr.h
>

63 #ifde‡
HAVE_LIBDL


64 
	~<dlf˙.h
>

66 
	#RTLD_NOW
 0

	)

69 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


70 
	#SND_LITTLE_ENDIAN


	)

71 
	#SNDRV_LITTLE_ENDIAN


	)

72 
	#SNDRV_LITTLE_ENDIAN_BITFIELD


	)

73 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


74 
	#SND_BIG_ENDIAN


	)

75 
	#SNDRV_BIG_ENDIAN


	)

76 
	#SNDRV_BIG_ENDIAN_BITFIELD


	)

81 #i‚de‡
HAVE_LFS


82 
	#°©64
 
°©


	)

83 
	#l°©64
 
l°©


	)

84 
	#dúít64
 
dúít


	)

85 
	#ªaddú64
 
ªaddú


	)

86 
	#sˇndú64
 
sˇndú


	)

87 
	#vîsi⁄s‹t64
 
vîsi⁄s‹t


	)

88 
	#Æphas‹t64
 
Æphas‹t


	)

89 
	#öo64_t
 
öo_t


	)

90 
	#f°©64
 
f°©


	)

91 
	#°©64
 
°©


	)

94 
	#_¢d_c⁄fig_ôî©‹
 
li°_hód


	)

95 
	#_¢d_öãrvÆ
 
¢d_öãrvÆ


	)

96 
	#_¢d_pcm_öfo
 
¢d_pcm_öfo


	)

97 
	#_¢d_pcm_hw_∑øms
 
¢d_pcm_hw_∑øms


	)

98 
	#_¢d_pcm_sw_∑øms
 
¢d_pcm_sw_∑øms


	)

99 
	#_¢d_pcm_°©us
 
¢d_pcm_°©us


	)

101 
	#_¢d_˘l_ˇrd_öfo
 
¢d_˘l_ˇrd_öfo


	)

102 
	#_¢d_˘l_ñem_id
 
¢d_˘l_ñem_id


	)

103 
	#_¢d_˘l_ñem_li°
 
¢d_˘l_ñem_li°


	)

104 
	#_¢d_˘l_ñem_öfo
 
¢d_˘l_ñem_öfo


	)

105 
	#_¢d_˘l_ñem_vÆue
 
¢d_˘l_ñem_vÆue


	)

106 
	#_¢d_˘l_evít
 
¢d_˘l_evít


	)

108 
	#_¢d_øwmidi_öfo
 
¢d_øwmidi_öfo


	)

109 
	#_¢d_øwmidi_∑øms
 
¢d_øwmidi_∑øms


	)

110 
	#_¢d_øwmidi_°©us
 
¢d_øwmidi_°©us


	)

112 
	#_¢d_hwdï_öfo
 
¢d_hwdï_öfo


	)

113 
	#_¢d_hwdï_d•_°©us
 
¢d_hwdï_d•_°©us


	)

114 
	#_¢d_hwdï_d•_image
 
¢d_hwdï_d•_image


	)

116 
	#_¢d_£q_queue_ãmpo
 
¢d_£q_queue_ãmpo


	)

117 
	#_¢d_£q_˛õ¡_öfo
 
¢d_£q_˛õ¡_öfo


	)

118 
	#_¢d_£q_p‹t_öfo
 
¢d_£q_p‹t_öfo


	)

119 
	#_¢d_£q_sy°em_öfo
 
¢d_£q_sy°em_öfo


	)

120 
	#_¢d_£q_queue_öfo
 
¢d_£q_queue_öfo


	)

121 
	#_¢d_£q_queue_°©us
 
¢d_£q_queue_°©us


	)

122 
	#_¢d_£q_queue_timî
 
¢d_£q_queue_timî


	)

123 
	#_¢d_£q_p‹t_subs¸ibe
 
¢d_£q_p‹t_subs¸ibe


	)

124 
	#_¢d_£q_quîy_subs¸ibe
 
¢d_£q_quîy_subs


	)

125 
	#_¢d_£q_˛õ¡_poﬁ
 
¢d_£q_˛õ¡_poﬁ


	)

126 
	#_¢d_£q_ªmove_evíts
 
¢d_£q_ªmove_evíts


	)

128 
	#_¢d_timî_id
 
¢d_timî_id


	)

129 
	#_¢d_timî_göfo
 
¢d_timî_göfo


	)

130 
	#_¢d_timî_g∑øms
 
¢d_timî_g∑øms


	)

131 
	#_¢d_timî_g°©us
 
¢d_timî_g°©us


	)

132 
	#_¢d_timî_£À˘
 
¢d_timî_£À˘


	)

133 
	#_¢d_timî_öfo
 
¢d_timî_öfo


	)

134 
	#_¢d_timî_∑øms
 
¢d_timî_∑øms


	)

135 
	#_¢d_timî_°©us
 
¢d_timî_°©us


	)

137 
	#ALSA_LIBRARY_BUILD


	)

140 
	#¢d_´s_õc958
 
¢drv_´s_õc958


	)

141 
	#¢d_pcm_u‰ames_t
 
¢drv_pcm_u‰ames_t


	)

142 
	#¢d_pcm_s‰ames_t
 
¢drv_pcm_s‰ames_t


	)

143 
	#¢d_pcm_ac˚ss_t
 
¢drv_pcm_ac˚ss_t


	)

144 
	#¢d_pcm_f‹m©_t
 
¢drv_pcm_f‹m©_t


	)

145 
	#¢d_pcm_subf‹m©_t
 
¢drv_pcm_subf‹m©_t


	)

146 
	#¢d_pcm_°©e_t
 
¢drv_pcm_°©e_t


	)

147 
	#¢d_öãrvÆ
 
¢drv_öãrvÆ


	)

148 
	#¢d_mask
 
¢drv_mask


	)

149 
	#¢d_˘l_ñem_ty≥_t
 
¢drv_˘l_ñem_ty≥_t


	)

150 
	#¢d_˘l_ñem_iÁ˚_t
 
¢drv_˘l_ñem_iÁ˚_t


	)

151 
	#¢d_˘l_év
 
¢drv_˘l_év


	)

154 #i‚de‡
__u£r


155 
	#__u£r


	)

157 #i‚de‡
__f‹˚


158 
	#__f‹˚


	)

161 
	~<sound/asound.h
>

164 #unde‡
¢d_´s_õc958


165 #unde‡
¢d_pcm_u‰ames_t


166 #unde‡
¢d_pcm_s‰ames_t


167 #unde‡
¢d_pcm_ac˚ss_t


168 #unde‡
¢d_pcm_f‹m©_t


169 #unde‡
¢d_pcm_subf‹m©_t


170 #unde‡
¢d_pcm_°©e_t


171 #unde‡
¢d_˘l_ñem_ty≥_t


172 #unde‡
¢d_˘l_ñem_iÁ˚_t


174 
	~"asoundef.h
"

175 
	~"Æß-symbﬁs.h
"

176 
	~"vîsi⁄.h
"

177 
	~"globÆ.h
"

178 
	~"öput.h
"

179 
	~"ouçut.h
"

180 
	~"îr‹.h
"

181 
	~"c⁄f.h
"

182 
	~"pcm.h
"

183 
	~"pcm_∂ugö.h
"

184 
	~"øwmidi.h
"

185 
	~"ump.h
"

186 
	~"timî.h
"

187 
	~"hwdï.h
"

188 
	~"c⁄åﬁ.h
"

189 
	~"mixî.h
"

190 
	~"£q_evít.h
"

191 
	~"£q.h
"

194 
	#¢d_£q_addr
 
¢drv_£q_addr


	)

195 
	#¢d_£q_tick_time_t
 
¢drv_£q_tick_time_t


	)

196 
	#¢d_£q_ªÆ_time
 
¢drv_£q_ªÆ_time


	)

197 
	#¢d_£q_time°amp
 
¢drv_£q_time°amp


	)

198 
	#¢d_£q_evít_ty≥_t
 
¢drv_£q_evít_ty≥_t


	)

199 
	#¢d_£q_evít_d©a
 
¢drv_£q_evít_d©a


	)

200 
	#¢d_£q_evít
 
¢drv_£q_evít


	)

201 
	#¢d_£q_ump_evít
 
¢drv_£q_ump_evít


	)

202 
	#¢d_£q_c⁄√˘
 
¢drv_£q_c⁄√˘


	)

203 
	#¢d_£q_ev_nŸe
 
¢drv_£q_ev_nŸe


	)

204 
	#¢d_£q_ev_˘æ
 
¢drv_£q_ev_˘æ


	)

205 
	#¢d_£q_ev_øw8
 
¢drv_£q_ev_øw8


	)

206 
	#¢d_£q_ev_øw32
 
¢drv_£q_ev_øw32


	)

207 
	#¢d_£q_ev_ext
 
¢drv_£q_ev_ext


	)

208 
	#¢d_£q_ªsu…
 
¢drv_£q_ªsu…


	)

209 
	#¢d_£q_queue_skew
 
¢drv_£q_queue_skew


	)

210 
	#¢d_£q_ev_queue_c⁄åﬁ
 
¢drv_£q_ev_queue_c⁄åﬁ


	)

211 
	#¢d_£q_˛õ¡_t
 
¢drv_£q_˛õ¡_t


	)

212 
	#¢d_£q_˛õ¡_ty≥_t
 
¢drv_£q_˛õ¡_ty≥_t


	)

214 
	~<sound/a£quí˚r.h
>

217 #unde‡
¢d_£q_˛õ¡_t


218 #unde‡
¢d_£q_˛õ¡_ty≥_t


220 
	~"£qmid.h
"

221 
	~"£q_midi_evít.h
"

222 
	~"li°.h
"

224 
	s_¢d_async_h™dÀr
 {

226 
	mSND_ASYNC_HANDLER_GENERIC
,

227 
	mSND_ASYNC_HANDLER_CTL
,

228 
	mSND_ASYNC_HANDLER_PCM
,

229 
	mSND_ASYNC_HANDLER_TIMER
,

230 } 
	mty≥
;

231 
	mfd
;

233 
¢d_˘l_t
 *
	m˘l
;

234 
¢d_pcm_t
 *
	mpcm
;

235 
¢d_timî_t
 *
	mtimî
;

236 } 
	mu
;

237 
¢d_async_ˇŒback_t
 
	mˇŒback
;

238 *
	m¥iv©e_d©a
;

239 
li°_hód
 
	mgli°
;

240 
li°_hód
 
	mhli°
;

243 
	e_¢d_£t_mode
 {

244 
	mSND_CHANGE
,

245 
	mSND_TRY
,

246 
	mSND_TEST
,

247 } 
	t¢d_£t_mode_t
;

249 
size_t
 
∑ge_Æign
(size_à
size
);

250 
size_t
 
∑ge_size
();

251 
size_t
 
∑ge_±r
(size_à
obje˘_off£t
, size_à
obje˘_size
, size_à*
off£t
, size_à*
mm≠_off£t
);

253 
	#ß„_°πﬁl_ba£
 
_¢d_ß„_°πﬁl_ba£


	)

254 
_¢d_ß„_°πﬁl_ba£
(c⁄° *
°r
, *
vÆ
, 
ba£
);

255 
ölöe
 
	$ß„_°πﬁl
(c⁄° *
°r
, *
vÆ
Ë{  
	`ß„_°πﬁl_ba£
(°r, vÆ, 0); 
	}
}

256 
	#ß„_°πﬁ_ba£
 
_¢d_ß„_°πﬁ_ba£


	)

257 
_¢d_ß„_°πﬁ_ba£
(c⁄° *
°r
, *
vÆ
, 
ba£
);

258 
ölöe
 
	$ß„_°πﬁ
(c⁄° *
°r
, *
vÆ
Ë{  
	`ß„_°πﬁ_ba£
(°r, vÆ, 0); 
	}
}

259 
	#ß„_°πod
 
_¢d_ß„_°πod


	)

260 
_¢d_ß„_°πod
(c⁄° *
°r
, *
vÆ
);

262 
¢d_£nd_fd
(
sock
, *
d©a
, 
size_t
 
Àn
, 
fd
);

263 
¢d_ª˚ive_fd
(
sock
, *
d©a
, 
size_t
 
Àn
, *
fd
);

264 
size_t
 
¢d_°æ˝y
(*
d°
, c⁄° *
§c
, size_à
size
);

269 #i‚de‡
NDEBUG


270 
	#CHECK_SANITY
(
x
Ë
	)
x

271 
¢d_lib_îr‹_h™dÀr_t
 
¢d_îr_msg
;

272 
	#SNDMSG
(
¨gs
...Ë
	`¢d_îr_msg
(
__FILE__
, 
__LINE__
, 
__func__
, 0, ##¨gs)

	)

273 
	#SYSMSG
(
¨gs
...Ë
	`¢d_îr_msg
(
__FILE__
, 
__LINE__
, 
__func__
, 
î∫o
, ##¨gs)

	)

275 
	#CHECK_SANITY
(
x
Ë0

	)

276 
	#SNDMSG
(
¨gs
...Ë

	)

277 
	#SYSMSG
(
¨gs
...Ë

	)

282 
	#HAVE_GNU_LD


	)

283 
	#HAVE_ELF


	)

284 
	#HAVE_ASM_PREVIOUS_DIRECTIVE


	)

291 
	#ASM_NAME
(
«me
Ë
__SYMBOL_PREFIX
 
	)
name

293 #ifde‡
HAVE_GNU_LD


294 #ifde‡
HAVE_ELF


297 #ifde‡
HAVE_ASM_PREVIOUS_DIRECTIVE


298 
	#__make_£˘i⁄_u«Œoˇãd
(
£˘i⁄_°rög
) \

299 
	`asm
 (".£˘i⁄ " 
£˘i⁄_°rög
 "\n\t.¥evious");

	)

300 #ñi‡
deföed
 
HAVE_ASM_POPSECTION_DIRECTIVE


301 
	#__make_£˘i⁄_u«Œoˇãd
(
£˘i⁄_°rög
) \

302 
	`asm
 (".push£˘i⁄ " 
£˘i⁄_°rög
 "\n\t.p›£˘i⁄");

	)

304 
	#__make_£˘i⁄_u«Œoˇãd
(
£˘i⁄_°rög
)

	)

309 #ifde‡
HAVE_SECTION_QUOTES


310 
	#lök_w¨nög
(
symbﬁ
, 
msg
) \

311 
	`__make_£˘i⁄_u«Œoˇãd
 (".gnu.w¨nög." 
	`ASM_NAME
(#symbol)) \

312 c⁄° 
__evoke_lök_w¨nög_
##
symbﬁ
[] \

313 
	`__©åibuã__
 ((
	`£˘i⁄
 (".gnu.w¨nög." 
	`ASM_NAME
(#symbﬁË"\"\n\t#\""))Ë
msg
;

	)

315 
	#lök_w¨nög
(
symbﬁ
, 
msg
) \

316 
	`__make_£˘i⁄_u«Œoˇãd
 (".gnu.w¨nög." 
	`ASM_NAME
(#symbol)) \

317 c⁄° 
__evoke_lök_w¨nög_
##
symbﬁ
[] \

318 
	`__©åibuã__
 ((
	`£˘i⁄
 (".gnu.w¨nög." 
	`ASM_NAME
(#symbﬁË"\n\t#"))Ë
msg
;

	)

321 
	#lök_w¨nög
(
symbﬁ
, 
msg
) \

322 
	`asm
 (".°ab†\"" 
msg
 "\",30,0,0,0\n\t" \

323 ".°ab†\"" 
	`ASM_NAME
(#symbﬁË"\",1,0,0,0\n");

	)

327 
	#lök_w¨nög
(
symbﬁ
, 
msg
)

	)

330 
ölöe
 
	$¢d_›í_devi˚
(c⁄° *
fûíame
, 
fmode
)

332 
fd
;

334 #ifde‡
O_CLOEXEC


335 
fmode
 |
O_CLOEXEC
;

337 
fd
 = 
	`›í
(
fûíame
, 
fmode
);

340 #ifde‡
SUPPORT_RESMGR


341 i‡(
fd
 < 0) {

342 i‡(
î∫o
 =
EAGAIN
 ||Éºnÿ=
EBUSY
)

343  
fd
;

344 i‡(! 
	`ac˚ss
(
fûíame
, 
F_OK
))

345 
fd
 = 
	`rsm_›í_devi˚
(
fûíame
, 
fmode
);

348 #i‚de‡
O_CLOEXEC


349 i‡(
fd
 >= 0)

350 
	`f˙é
(
fd
, 
F_SETFD
, 
FD_CLOEXEC
);

352  
fd
;

353 
	}
}

356 
	#¢d_dlobj_ˇche_gë
 \

357 
¢d1_dlobj_ˇche_gë


	)

358 
	#¢d_dlobj_ˇche_gë2
 \

359 
¢d1_dlobj_ˇche_gë2


	)

360 
	#¢d_dlobj_ˇche_put
 \

361 
¢d1_dlobj_ˇche_put


	)

362 
	#¢d_dlobj_ˇche_˛ónup
 \

363 
¢d1_dlobj_ˇche_˛ónup


	)

364 
	#¢d_c⁄fig_£t_h›
 \

365 
¢d1_c⁄fig_£t_h›


	)

366 
	#¢d_c⁄fig_check_h›
 \

367 
¢d1_c⁄fig_check_h›


	)

368 
	#¢d_c⁄fig_£¨ch_Æüs_hooks
 \

369 
¢d1_c⁄fig_£¨ch_Æüs_hooks


	)

372 *
¢d_dlobj_ˇche_gë
(c⁄° *
lib
, c⁄° *
«me
, c⁄° *
vîsi⁄
, 
vîbo£
);

373 *
¢d_dlobj_ˇche_gë2
(c⁄° *
lib
, c⁄° *
«me
, c⁄° *
vîsi⁄
, 
vîbo£
);

374 
¢d_dlobj_ˇche_put
(*
›í_func
);

375 
¢d_dlobj_ˇche_˛ónup
();

378 
¢d_c⁄fig_£t_h›
(
¢d_c⁄fig_t
 *
c⁄f
, 
h›
);

379 
¢d_c⁄fig_check_h›
(
¢d_c⁄fig_t
 *
c⁄f
);

380 
	#SND_CONF_MAX_HOPS
 64

	)

382 
¢d_c⁄fig_£¨ch_Æüs_hooks
(
¢d_c⁄fig_t
 *
c⁄fig
,

383 c⁄° *
ba£
, c⁄° *
key
,

384 
¢d_c⁄fig_t
 **
ªsu…
);

386 
_¢d_c⁄f_gíîic_id
(c⁄° *
id
);

388 
_¢d_c⁄fig_lﬂd_wôh_ö˛ude
(
¢d_c⁄fig_t
 *
c⁄fig
, 
¢d_öput_t
 *
ö
,

389 
ovîride
, c⁄° * c⁄° *
deÁu…_ö˛ude_∑th
);

392 
	#ARRAY_SIZE
(
x
Ë((xË/ (x[0]))

	)

394 
	#c⁄èöî_of
(
±r
, 
ty≥
, 
membî
) ({ \

395 c⁄° 
	`ty≥of
–((
ty≥
 *)0)->
membî
 ) *
__m±r
 = (
±r
); \

396 (
ty≥
 *)–(*)
__m±r
 - 
	`off£tof
—y≥,
membî
Ë);})

	)

398 #ifde‡
INTERNAL


399 *
	$INTERNAL
(
¢d_dl›í
)(c⁄° *
«me
, 
mode
, *
îrbuf
, 
size_t
 
îrbuÊí
);

402 #ifde‡
BUILD_UCM


404 c⁄° *
	`uc_mgr_Æibcfg_by_devi˚
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
«me
);

406 
ölöe
 
	$_¢d_is_ucm_devi˚
(c⁄° *
«me
)

408  
«me
 &&Çame[0] == '_' &&Çame[1] == 'u' &&Çame[2] == 'c' &&Çame[3] == 'm';

409 
	}
}

413 
ölöe
 c⁄° *
	$uc_mgr_Æibcfg_by_devi˚
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
«me
Ë{  
NULL
; 
	}
}

414 
ölöe
 
	$_¢d_is_ucm_devi˚
(c⁄° *
«me
Ë{  0; 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/mixer.h

28 #i‚de‡
__ALSA_MIXER_H


29 
	#__ALSA_MIXER_H


	)

31 #ifde‡
__˝lu•lus


42 
_¢d_mixî
 
	t¢d_mixî_t
;

44 
_¢d_mixî_˛ass
 
	t¢d_mixî_˛ass_t
;

46 
_¢d_mixî_ñem
 
	t¢d_mixî_ñem_t
;

55 (*
¢d_mixî_ˇŒback_t
)(
	t¢d_mixî_t
 *
	t˘l
,

56 
	tmask
,

57 
	t¢d_mixî_ñem_t
 *
	tñem
);

65 (*
¢d_mixî_ñem_ˇŒback_t
)(
	t¢d_mixî_ñem_t
 *
	tñem
,

66 
	tmask
);

74 (*
¢d_mixî_com∑ª_t
)(c⁄° 
	t¢d_mixî_ñem_t
 *
	te1
,

75 c⁄° 
	t¢d_mixî_ñem_t
 *
	te2
);

85 (*
¢d_mixî_evít_t
)(
	t¢d_mixî_˛ass_t
 *
	t˛ass_
, 
	tmask
,

86 
	t¢d_h˘l_ñem_t
 *
	thñem
, 
	t¢d_mixî_ñem_t
 *
	tmñem
);

90 
	e_¢d_mixî_ñem_ty≥
 {

92 
SND_MIXER_ELEM_SIMPLE
,

93 
SND_MIXER_ELEM_LAST
 = 
SND_MIXER_ELEM_SIMPLE


94 } 
	t¢d_mixî_ñem_ty≥_t
;

96 
¢d_mixî_›í
(
¢d_mixî_t
 **
mixî
, 
mode
);

97 
¢d_mixî_˛o£
(
¢d_mixî_t
 *
mixî
);

98 
¢d_mixî_ñem_t
 *
¢d_mixî_fú°_ñem
(
¢d_mixî_t
 *
mixî
);

99 
¢d_mixî_ñem_t
 *
¢d_mixî_œ°_ñem
(
¢d_mixî_t
 *
mixî
);

100 
¢d_mixî_h™dÀ_evíts
(
¢d_mixî_t
 *
mixî
);

101 
¢d_mixî_©èch
(
¢d_mixî_t
 *
mixî
, c⁄° *
«me
);

102 
¢d_mixî_©èch_h˘l
(
¢d_mixî_t
 *
mixî
, 
¢d_h˘l_t
 *
h˘l
);

103 
¢d_mixî_dëach
(
¢d_mixî_t
 *
mixî
, c⁄° *
«me
);

104 
¢d_mixî_dëach_h˘l
(
¢d_mixî_t
 *
mixî
, 
¢d_h˘l_t
 *
h˘l
);

105 
¢d_mixî_gë_h˘l
(
¢d_mixî_t
 *
mixî
, c⁄° *
«me
, 
¢d_h˘l_t
 **
h˘l
);

106 
¢d_mixî_pﬁl_des¸ùt‹s_cou¡
(
¢d_mixî_t
 *
mixî
);

107 
¢d_mixî_pﬁl_des¸ùt‹s
(
¢d_mixî_t
 *
mixî
, 
pﬁlfd
 *
pfds
, 
•a˚
);

108 
¢d_mixî_pﬁl_des¸ùt‹s_ªvíts
(
¢d_mixî_t
 *
mixî
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
);

109 
¢d_mixî_lﬂd
(
¢d_mixî_t
 *
mixî
);

110 
¢d_mixî_‰ì
(
¢d_mixî_t
 *
mixî
);

111 
¢d_mixî_waô
(
¢d_mixî_t
 *
mixî
, 
timeout
);

112 
¢d_mixî_£t_com∑ª
(
¢d_mixî_t
 *
mixî
, 
¢d_mixî_com∑ª_t
 
ms‹t
);

113 
¢d_mixî_£t_ˇŒback
(
¢d_mixî_t
 *
obj
, 
¢d_mixî_ˇŒback_t
 
vÆ
);

114 * 
¢d_mixî_gë_ˇŒback_¥iv©e
(c⁄° 
¢d_mixî_t
 *
obj
);

115 
¢d_mixî_£t_ˇŒback_¥iv©e
(
¢d_mixî_t
 *
obj
, * 
vÆ
);

116 
¢d_mixî_gë_cou¡
(c⁄° 
¢d_mixî_t
 *
obj
);

117 
¢d_mixî_˛ass_uƒegi°î
(
¢d_mixî_˛ass_t
 *
˛ss
);

119 
¢d_mixî_ñem_t
 *
¢d_mixî_ñem_√xt
(¢d_mixî_ñem_à*
ñem
);

120 
¢d_mixî_ñem_t
 *
¢d_mixî_ñem_¥ev
(¢d_mixî_ñem_à*
ñem
);

121 
¢d_mixî_ñem_£t_ˇŒback
(
¢d_mixî_ñem_t
 *
obj
, 
¢d_mixî_ñem_ˇŒback_t
 
vÆ
);

122 * 
¢d_mixî_ñem_gë_ˇŒback_¥iv©e
(c⁄° 
¢d_mixî_ñem_t
 *
obj
);

123 
¢d_mixî_ñem_£t_ˇŒback_¥iv©e
(
¢d_mixî_ñem_t
 *
obj
, * 
vÆ
);

124 
¢d_mixî_ñem_ty≥_t
 
¢d_mixî_ñem_gë_ty≥
(c⁄° 
¢d_mixî_ñem_t
 *
obj
);

126 
¢d_mixî_˛ass_ªgi°î
(
¢d_mixî_˛ass_t
 *
˛ass_
, 
¢d_mixî_t
 *
mixî
);

127 
¢d_mixî_ñem_√w
(
¢d_mixî_ñem_t
 **
ñem
,

128 
¢d_mixî_ñem_ty≥_t
 
ty≥
,

129 
com∑ª_weight
,

130 *
¥iv©e_d©a
,

131 (*
¥iv©e_‰ì
)(
¢d_mixî_ñem_t
 *
ñem
));

132 
¢d_mixî_ñem_add
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_˛ass_t
 *
˛ass_
);

133 
¢d_mixî_ñem_ªmove
(
¢d_mixî_ñem_t
 *
ñem
);

134 
¢d_mixî_ñem_‰ì
(
¢d_mixî_ñem_t
 *
ñem
);

135 
¢d_mixî_ñem_öfo
(
¢d_mixî_ñem_t
 *
ñem
);

136 
¢d_mixî_ñem_vÆue
(
¢d_mixî_ñem_t
 *
ñem
);

137 
¢d_mixî_ñem_©èch
(
¢d_mixî_ñem_t
 *
mñem
, 
¢d_h˘l_ñem_t
 *
hñem
);

138 
¢d_mixî_ñem_dëach
(
¢d_mixî_ñem_t
 *
mñem
, 
¢d_h˘l_ñem_t
 *
hñem
);

139 
¢d_mixî_ñem_em±y
(
¢d_mixî_ñem_t
 *
mñem
);

140 *
¢d_mixî_ñem_gë_¥iv©e
(c⁄° 
¢d_mixî_ñem_t
 *
mñem
);

142 
size_t
 
¢d_mixî_˛ass_sizeof
();

147 
	#¢d_mixî_˛ass_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_mixî_˛ass
)

	)

148 
¢d_mixî_˛ass_mÆloc
(
¢d_mixî_˛ass_t
 **
±r
);

149 
¢d_mixî_˛ass_‰ì
(
¢d_mixî_˛ass_t
 *
obj
);

150 
¢d_mixî_˛ass_c›y
(
¢d_mixî_˛ass_t
 *
d°
, c⁄° snd_mixî_˛ass_à*
§c
);

151 
¢d_mixî_t
 *
¢d_mixî_˛ass_gë_mixî
(c⁄° 
¢d_mixî_˛ass_t
 *
˛ass_
);

152 
¢d_mixî_evít_t
 
¢d_mixî_˛ass_gë_evít
(c⁄° 
¢d_mixî_˛ass_t
 *
˛ass_
);

153 *
¢d_mixî_˛ass_gë_¥iv©e
(c⁄° 
¢d_mixî_˛ass_t
 *
˛ass_
);

154 
¢d_mixî_com∑ª_t
 
¢d_mixî_˛ass_gë_com∑ª
(c⁄° 
¢d_mixî_˛ass_t
 *
˛ass_
);

155 
¢d_mixî_˛ass_£t_evít
(
¢d_mixî_˛ass_t
 *
˛ass_
, 
¢d_mixî_evít_t
 
evít
);

156 
¢d_mixî_˛ass_£t_¥iv©e
(
¢d_mixî_˛ass_t
 *
˛ass_
, *
¥iv©e_d©a
);

157 
¢d_mixî_˛ass_£t_¥iv©e_‰ì
(
¢d_mixî_˛ass_t
 *
˛ass_
, (*
¥iv©e_‰ì
)(snd_mixer_class_t *));

158 
¢d_mixî_˛ass_£t_com∑ª
(
¢d_mixî_˛ass_t
 *
˛ass_
, 
¢d_mixî_com∑ª_t
 
com∑ª
);

170 
	e_¢d_mixî_£Àm_ch™√l_id
 {

172 
SND_MIXER_SCHN_UNKNOWN
 = -1,

174 
SND_MIXER_SCHN_FRONT_LEFT
 = 0,

176 
SND_MIXER_SCHN_FRONT_RIGHT
,

178 
SND_MIXER_SCHN_REAR_LEFT
,

180 
SND_MIXER_SCHN_REAR_RIGHT
,

182 
SND_MIXER_SCHN_FRONT_CENTER
,

184 
SND_MIXER_SCHN_WOOFER
,

186 
SND_MIXER_SCHN_SIDE_LEFT
,

188 
SND_MIXER_SCHN_SIDE_RIGHT
,

190 
SND_MIXER_SCHN_REAR_CENTER
,

191 
SND_MIXER_SCHN_LAST
 = 31,

193 
SND_MIXER_SCHN_MONO
 = 
SND_MIXER_SCHN_FRONT_LEFT


194 } 
	t¢d_mixî_£Àm_ch™√l_id_t
;

197 
	e¢d_mixî_£Àm_ªg›t_ab°ø˘
 {

199 
SND_MIXER_SABSTRACT_NONE
 = 0,

201 
SND_MIXER_SABSTRACT_BASIC
,

205 
	s¢d_mixî_£Àm_ªg›t
 {

207 
vî
;

209 
¢d_mixî_£Àm_ªg›t_ab°ø˘
 
ab°ø˘
;

211 c⁄° *
devi˚
;

213 
¢d_pcm_t
 *
∂ayback_pcm
;

215 
¢d_pcm_t
 *
ˇ±uª_pcm
;

219 
_¢d_mixî_£Àm_id
 
	t¢d_mixî_£Àm_id_t
;

221 c⁄° *
¢d_mixî_£Àm_ch™√l_«me
(
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
);

223 
¢d_mixî_£Àm_ªgi°î
(
¢d_mixî_t
 *
mixî
,

224 
¢d_mixî_£Àm_ªg›t
 *
›ti⁄s
,

225 
¢d_mixî_˛ass_t
 **
˛as•
);

226 
¢d_mixî_£Àm_gë_id
(
¢d_mixî_ñem_t
 *
ñemít
,

227 
¢d_mixî_£Àm_id_t
 *
id
);

228 c⁄° *
¢d_mixî_£Àm_gë_«me
(
¢d_mixî_ñem_t
 *
ñem
);

229 
¢d_mixî_£Àm_gë_ödex
(
¢d_mixî_ñem_t
 *
ñem
);

230 
¢d_mixî_ñem_t
 *
¢d_mixî_föd_£Àm
(
¢d_mixî_t
 *
mixî
,

231 c⁄° 
¢d_mixî_£Àm_id_t
 *
id
);

233 
¢d_mixî_£Àm_is_a˘ive
(
¢d_mixî_ñem_t
 *
ñem
);

234 
¢d_mixî_£Àm_is_∂ayback_m⁄o
(
¢d_mixî_ñem_t
 *
ñem
);

235 
¢d_mixî_£Àm_has_∂ayback_ch™√l
(
¢d_mixî_ñem_t
 *
obj
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
);

236 
¢d_mixî_£Àm_is_ˇ±uª_m⁄o
(
¢d_mixî_ñem_t
 *
ñem
);

237 
¢d_mixî_£Àm_has_ˇ±uª_ch™√l
(
¢d_mixî_ñem_t
 *
obj
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
);

238 
¢d_mixî_£Àm_gë_ˇ±uª_group
(
¢d_mixî_ñem_t
 *
ñem
);

239 
¢d_mixî_£Àm_has_comm⁄_vﬁume
(
¢d_mixî_ñem_t
 *
ñem
);

240 
¢d_mixî_£Àm_has_∂ayback_vﬁume
(
¢d_mixî_ñem_t
 *
ñem
);

241 
¢d_mixî_£Àm_has_∂ayback_vﬁume_joöed
(
¢d_mixî_ñem_t
 *
ñem
);

242 
¢d_mixî_£Àm_has_ˇ±uª_vﬁume
(
¢d_mixî_ñem_t
 *
ñem
);

243 
¢d_mixî_£Àm_has_ˇ±uª_vﬁume_joöed
(
¢d_mixî_ñem_t
 *
ñem
);

244 
¢d_mixî_£Àm_has_comm⁄_swôch
(
¢d_mixî_ñem_t
 *
ñem
);

245 
¢d_mixî_£Àm_has_∂ayback_swôch
(
¢d_mixî_ñem_t
 *
ñem
);

246 
¢d_mixî_£Àm_has_∂ayback_swôch_joöed
(
¢d_mixî_ñem_t
 *
ñem
);

247 
¢d_mixî_£Àm_has_ˇ±uª_swôch
(
¢d_mixî_ñem_t
 *
ñem
);

248 
¢d_mixî_£Àm_has_ˇ±uª_swôch_joöed
(
¢d_mixî_ñem_t
 *
ñem
);

249 
¢d_mixî_£Àm_has_ˇ±uª_swôch_ex˛usive
(
¢d_mixî_ñem_t
 *
ñem
);

251 
¢d_mixî_£Àm_ask_∂ayback_vﬁ_dB
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
, *
dBvÆue
);

252 
¢d_mixî_£Àm_ask_ˇ±uª_vﬁ_dB
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
, *
dBvÆue
);

253 
¢d_mixî_£Àm_ask_∂ayback_dB_vﬁ
(
¢d_mixî_ñem_t
 *
ñem
, 
dBvÆue
, 
dú
, *
vÆue
);

254 
¢d_mixî_£Àm_ask_ˇ±uª_dB_vﬁ
(
¢d_mixî_ñem_t
 *
ñem
, 
dBvÆue
, 
dú
, *
vÆue
);

255 
¢d_mixî_£Àm_gë_∂ayback_vﬁume
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
);

256 
¢d_mixî_£Àm_gë_ˇ±uª_vﬁume
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
);

257 
¢d_mixî_£Àm_gë_∂ayback_dB
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
);

258 
¢d_mixî_£Àm_gë_ˇ±uª_dB
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
);

259 
¢d_mixî_£Àm_gë_∂ayback_swôch
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
);

260 
¢d_mixî_£Àm_gë_ˇ±uª_swôch
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
);

261 
¢d_mixî_£Àm_£t_∂ayback_vﬁume
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
);

262 
¢d_mixî_£Àm_£t_ˇ±uª_vﬁume
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
);

263 
¢d_mixî_£Àm_£t_∂ayback_dB
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
, 
dú
);

264 
¢d_mixî_£Àm_£t_ˇ±uª_dB
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
, 
dú
);

265 
¢d_mixî_£Àm_£t_∂ayback_vﬁume_Æl
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
);

266 
¢d_mixî_£Àm_£t_ˇ±uª_vﬁume_Æl
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
);

267 
¢d_mixî_£Àm_£t_∂ayback_dB_Æl
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
, 
dú
);

268 
¢d_mixî_£Àm_£t_ˇ±uª_dB_Æl
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
, 
dú
);

269 
¢d_mixî_£Àm_£t_∂ayback_swôch
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
);

270 
¢d_mixî_£Àm_£t_ˇ±uª_swôch
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
);

271 
¢d_mixî_£Àm_£t_∂ayback_swôch_Æl
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
);

272 
¢d_mixî_£Àm_£t_ˇ±uª_swôch_Æl
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
);

273 
¢d_mixî_£Àm_gë_∂ayback_vﬁume_ønge
(
¢d_mixî_ñem_t
 *
ñem
,

274 *
mö
, *
max
);

275 
¢d_mixî_£Àm_gë_∂ayback_dB_ønge
(
¢d_mixî_ñem_t
 *
ñem
,

276 *
mö
, *
max
);

277 
¢d_mixî_£Àm_£t_∂ayback_vﬁume_ønge
(
¢d_mixî_ñem_t
 *
ñem
,

278 
mö
, 
max
);

279 
¢d_mixî_£Àm_gë_ˇ±uª_vﬁume_ønge
(
¢d_mixî_ñem_t
 *
ñem
,

280 *
mö
, *
max
);

281 
¢d_mixî_£Àm_gë_ˇ±uª_dB_ønge
(
¢d_mixî_ñem_t
 *
ñem
,

282 *
mö
, *
max
);

283 
¢d_mixî_£Àm_£t_ˇ±uª_vﬁume_ønge
(
¢d_mixî_ñem_t
 *
ñem
,

284 
mö
, 
max
);

286 
¢d_mixî_£Àm_is_íumî©ed
(
¢d_mixî_ñem_t
 *
ñem
);

287 
¢d_mixî_£Àm_is_íum_∂ayback
(
¢d_mixî_ñem_t
 *
ñem
);

288 
¢d_mixî_£Àm_is_íum_ˇ±uª
(
¢d_mixî_ñem_t
 *
ñem
);

289 
¢d_mixî_£Àm_gë_íum_ôems
(
¢d_mixî_ñem_t
 *
ñem
);

290 
¢d_mixî_£Àm_gë_íum_ôem_«me
(
¢d_mixî_ñem_t
 *
ñem
, 
idx
, 
size_t
 
maxÀn
, *
°r
);

291 
¢d_mixî_£Àm_gë_íum_ôem
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
idxp
);

292 
¢d_mixî_£Àm_£t_íum_ôem
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
idx
);

294 
size_t
 
¢d_mixî_£Àm_id_sizeof
();

299 
	#¢d_mixî_£Àm_id_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_mixî_£Àm_id
)

	)

300 
¢d_mixî_£Àm_id_mÆloc
(
¢d_mixî_£Àm_id_t
 **
±r
);

301 
¢d_mixî_£Àm_id_‰ì
(
¢d_mixî_£Àm_id_t
 *
obj
);

302 
¢d_mixî_£Àm_id_c›y
(
¢d_mixî_£Àm_id_t
 *
d°
, c⁄° snd_mixî_£Àm_id_à*
§c
);

303 c⁄° *
¢d_mixî_£Àm_id_gë_«me
(c⁄° 
¢d_mixî_£Àm_id_t
 *
obj
);

304 
¢d_mixî_£Àm_id_gë_ödex
(c⁄° 
¢d_mixî_£Àm_id_t
 *
obj
);

305 
¢d_mixî_£Àm_id_£t_«me
(
¢d_mixî_£Àm_id_t
 *
obj
, c⁄° *
vÆ
);

306 
¢d_mixî_£Àm_id_£t_ödex
(
¢d_mixî_£Àm_id_t
 *
obj
, 
vÆ
);

307 
¢d_mixî_£Àm_id_∑r£
(
¢d_mixî_£Àm_id_t
 *
d°
, c⁄° *
°r
);

313 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/mixer_abst.h

26 #i‚de‡
__ALSA_MIXER_ABST_H


27 
	#__ALSA_MIXER_ABST_H


	)

29 #ifde‡
__˝lu•lus


39 
	#SM_PLAY
 0

	)

40 
	#SM_CAPT
 1

	)

42 
	#SM_CAP_GVOLUME
 (1<<1)

	)

43 
	#SM_CAP_GSWITCH
 (1<<2)

	)

44 
	#SM_CAP_PVOLUME
 (1<<3)

	)

45 
	#SM_CAP_PVOLUME_JOIN
 (1<<4)

	)

46 
	#SM_CAP_PSWITCH
 (1<<5)

	)

47 
	#SM_CAP_PSWITCH_JOIN
 (1<<6)

	)

48 
	#SM_CAP_CVOLUME
 (1<<7)

	)

49 
	#SM_CAP_CVOLUME_JOIN
 (1<<8)

	)

50 
	#SM_CAP_CSWITCH
 (1<<9)

	)

51 
	#SM_CAP_CSWITCH_JOIN
 (1<<10)

	)

52 
	#SM_CAP_CSWITCH_EXCL
 (1<<11)

	)

53 
	#SM_CAP_PENUM
 (1<<12)

	)

54 
	#SM_CAP_CENUM
 (1<<13)

	)

57 
	#SM_OPS_IS_ACTIVE
 0

	)

58 
	#SM_OPS_IS_MONO
 1

	)

59 
	#SM_OPS_IS_CHANNEL
 2

	)

60 
	#SM_OPS_IS_ENUMERATED
 3

	)

61 
	#SM_OPS_IS_ENUMCNT
 4

	)

63 
	#sm_£Àm
(
x
Ë((
sm_£Àm_t
 *)((x)->
¥iv©e_d©a
))

	)

64 
	#sm_£Àm_›s
(
x
Ë((
sm_£Àm_t
 *)((x)->
¥iv©e_d©a
))->
›s


	)

66 
	s_sm_£Àm
 {

67 
¢d_mixî_£Àm_id_t
 *
id
;

68 
sm_ñem_›s
 *
›s
;

69 
ˇps
;

70 
ˇ±uª_group
;

71 } 
	tsm_£Àm_t
;

73 
	s_sm_˛ass_basic
 {

74 *
devi˚
;

75 
¢d_˘l_t
 *
˘l
;

76 
¢d_h˘l_t
 *
h˘l
;

77 
¢d_˘l_ˇrd_öfo_t
 *
öfo
;

78 } 
	tsm_˛ass_basic_t
;

80 
	ssm_ñem_›s
 {

81 (*
is
)(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, 
cmd
, 
vÆ
);

82 (*
gë_ønge
)(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, *
mö
, *
max
);

83 (*
£t_ønge
)(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, 
mö
, 
max
);

84 (*
gë_dB_ønge
)(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, *
mö
, *
max
);

85 (*
ask_vﬁ_dB
)(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, 
vÆue
, *
dbVÆue
);

86 (*
ask_dB_vﬁ
)(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, 
dbVÆue
, *
vÆue
, 
xdú
);

87 (*
gë_vﬁume
)(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
);

88 (*
gë_dB
)(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
);

89 (*
£t_vﬁume
)(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
);

90 (*
£t_dB
)(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
, 
xdú
);

91 (*
gë_swôch
)(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
);

92 (*
£t_swôch
)(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
);

93 (*
íum_ôem_«me
)(
¢d_mixî_ñem_t
 *
ñem
, 
ôem
, 
size_t
 
maxÀn
, *
buf
);

94 (*
gë_íum_ôem
)(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
ôemp
);

95 (*
£t_íum_ôem
)(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
ôem
);

98 
¢d_mixî_£Àm_com∑ª
(c⁄° 
¢d_mixî_ñem_t
 *
c1
, c⁄° snd_mixî_ñem_à*
c2
);

100 
¢d_mixî_sbasic_öfo
(c⁄° 
¢d_mixî_˛ass_t
 *
mixî_˛ass
, 
sm_˛ass_basic_t
 *
öfo
);

101 *
¢d_mixî_sbasic_gë_¥iv©e
(c⁄° 
¢d_mixî_˛ass_t
 *
mixî_˛ass
);

102 
¢d_mixî_sbasic_£t_¥iv©e
(c⁄° 
¢d_mixî_˛ass_t
 *
mixî_˛ass
, *
¥iv©e_d©a
);

103 
¢d_mixî_sbasic_£t_¥iv©e_‰ì
(c⁄° 
¢d_mixî_˛ass_t
 *
mixî_˛ass
, (*
¥iv©e_‰ì
)(snd_mixer_class_t *mixer_class));

107 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/output.h

28 #i‚de‡
__ALSA_OUTPUT_H


29 
	#__ALSA_OUTPUT_H


	)

31 
	~<°d¨g.h
>

33 #ifde‡
__˝lu•lus


56 
_¢d_ouçut
 
	t¢d_ouçut_t
;

59 
	e_¢d_ouçut_ty≥
 {

61 
SND_OUTPUT_STDIO
,

63 
SND_OUTPUT_BUFFER


64 } 
	t¢d_ouçut_ty≥_t
;

66 
¢d_ouçut_°dio_›í
(
¢d_ouçut_t
 **
ouçuç
, c⁄° *
fûe
, c⁄° *
mode
);

67 
¢d_ouçut_°dio_©èch
(
¢d_ouçut_t
 **
ouçuç
, 
FILE
 *
Â
, 
_˛o£
);

68 
¢d_ouçut_buf„r_›í
(
¢d_ouçut_t
 **
ouçuç
);

69 
size_t
 
¢d_ouçut_buf„r_°rög
(
¢d_ouçut_t
 *
ouçut
, **
buf
);

70 
size_t
 
¢d_ouçut_buf„r_°ól
(
¢d_ouçut_t
 *
ouçut
, **
buf
);

71 
¢d_ouçut_˛o£
(
¢d_ouçut_t
 *
ouçut
);

72 
¢d_ouçut_¥ötf
(
¢d_ouçut_t
 *
ouçut
, c⁄° *
f‹m©
, ...)

73 #i‚de‡
DOC_HIDDEN


74 
__©åibuã__
 ((
f‹m©
 (
¥ötf
, 2, 3)))

77 
¢d_ouçut_v¥ötf
(
¢d_ouçut_t
 *
ouçut
, c⁄° *
f‹m©
, 
va_li°
 
¨gs
);

78 
¢d_ouçut_puts
(
¢d_ouçut_t
 *
ouçut
, c⁄° *
°r
);

79 
¢d_ouçut_putc
(
¢d_ouçut_t
 *
ouçut
, 
c
);

80 
¢d_ouçut_Êush
(
¢d_ouçut_t
 *
ouçut
);

84 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm.h

29 #i‚de‡
__ALSA_PCM_H


30 
	#__ALSA_PCM_H


	)

32 #ifde‡
__˝lu•lus


36 
	~<°döt.h
>

45 
	#SND_PCM_DLSYM_VERSION
 
_dlsym_pcm_001


	)

48 
_¢d_pcm_öfo
 
	t¢d_pcm_öfo_t
;

64 
_¢d_pcm_hw_∑øms
 
	t¢d_pcm_hw_∑øms_t
;

67 
_¢d_pcm_sw_∑øms
 
	t¢d_pcm_sw_∑øms_t
;

69 
_¢d_pcm_°©us
 
	t¢d_pcm_°©us_t
;

71 
_¢d_pcm_ac˚ss_mask
 
	t¢d_pcm_ac˚ss_mask_t
;

73 
_¢d_pcm_f‹m©_mask
 
	t¢d_pcm_f‹m©_mask_t
;

75 
_¢d_pcm_subf‹m©_mask
 
	t¢d_pcm_subf‹m©_mask_t
;

78 
	e_¢d_pcm_˛ass
 {

81 
SND_PCM_CLASS_GENERIC
 = 0,

83 
SND_PCM_CLASS_MULTI
,

85 
SND_PCM_CLASS_MODEM
,

87 
SND_PCM_CLASS_DIGITIZER
,

88 
SND_PCM_CLASS_LAST
 = 
SND_PCM_CLASS_DIGITIZER


89 } 
	t¢d_pcm_˛ass_t
;

92 
	e_¢d_pcm_sub˛ass
 {

94 
SND_PCM_SUBCLASS_GENERIC_MIX
 = 0,

96 
SND_PCM_SUBCLASS_MULTI_MIX
,

97 
SND_PCM_SUBCLASS_LAST
 = 
SND_PCM_SUBCLASS_MULTI_MIX


98 } 
	t¢d_pcm_sub˛ass_t
;

101 
	e_¢d_pcm_°ªam
 {

103 
SND_PCM_STREAM_PLAYBACK
 = 0,

105 
SND_PCM_STREAM_CAPTURE
,

106 
SND_PCM_STREAM_LAST
 = 
SND_PCM_STREAM_CAPTURE


107 } 
	t¢d_pcm_°ªam_t
;

110 
	e_¢d_pcm_ac˚ss
 {

112 
SND_PCM_ACCESS_MMAP_INTERLEAVED
 = 0,

114 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
,

116 
SND_PCM_ACCESS_MMAP_COMPLEX
,

118 
SND_PCM_ACCESS_RW_INTERLEAVED
,

120 
SND_PCM_ACCESS_RW_NONINTERLEAVED
,

121 
SND_PCM_ACCESS_LAST
 = 
SND_PCM_ACCESS_RW_NONINTERLEAVED


122 } 
	t¢d_pcm_ac˚ss_t
;

125 
	e_¢d_pcm_f‹m©
 {

127 
SND_PCM_FORMAT_UNKNOWN
 = -1,

129 
SND_PCM_FORMAT_S8
 = 0,

131 
SND_PCM_FORMAT_U8
,

133 
SND_PCM_FORMAT_S16_LE
,

135 
SND_PCM_FORMAT_S16_BE
,

137 
SND_PCM_FORMAT_U16_LE
,

139 
SND_PCM_FORMAT_U16_BE
,

141 
SND_PCM_FORMAT_S24_LE
,

143 
SND_PCM_FORMAT_S24_BE
,

145 
SND_PCM_FORMAT_U24_LE
,

147 
SND_PCM_FORMAT_U24_BE
,

149 
SND_PCM_FORMAT_S32_LE
,

151 
SND_PCM_FORMAT_S32_BE
,

153 
SND_PCM_FORMAT_U32_LE
,

155 
SND_PCM_FORMAT_U32_BE
,

157 
SND_PCM_FORMAT_FLOAT_LE
,

159 
SND_PCM_FORMAT_FLOAT_BE
,

161 
SND_PCM_FORMAT_FLOAT64_LE
,

163 
SND_PCM_FORMAT_FLOAT64_BE
,

165 
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
,

167 
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
,

169 
SND_PCM_FORMAT_MU_LAW
,

171 
SND_PCM_FORMAT_A_LAW
,

173 
SND_PCM_FORMAT_IMA_ADPCM
,

175 
SND_PCM_FORMAT_MPEG
,

177 
SND_PCM_FORMAT_GSM
,

179 
SND_PCM_FORMAT_S20_LE
,

181 
SND_PCM_FORMAT_S20_BE
,

183 
SND_PCM_FORMAT_U20_LE
,

185 
SND_PCM_FORMAT_U20_BE
,

187 
SND_PCM_FORMAT_SPECIAL
 = 31,

189 
SND_PCM_FORMAT_S24_3LE
 = 32,

191 
SND_PCM_FORMAT_S24_3BE
,

193 
SND_PCM_FORMAT_U24_3LE
,

195 
SND_PCM_FORMAT_U24_3BE
,

197 
SND_PCM_FORMAT_S20_3LE
,

199 
SND_PCM_FORMAT_S20_3BE
,

201 
SND_PCM_FORMAT_U20_3LE
,

203 
SND_PCM_FORMAT_U20_3BE
,

205 
SND_PCM_FORMAT_S18_3LE
,

207 
SND_PCM_FORMAT_S18_3BE
,

209 
SND_PCM_FORMAT_U18_3LE
,

211 
SND_PCM_FORMAT_U18_3BE
,

213 
SND_PCM_FORMAT_G723_24
,

215 
SND_PCM_FORMAT_G723_24_1B
,

217 
SND_PCM_FORMAT_G723_40
,

219 
SND_PCM_FORMAT_G723_40_1B
,

221 
SND_PCM_FORMAT_DSD_U8
,

223 
SND_PCM_FORMAT_DSD_U16_LE
,

225 
SND_PCM_FORMAT_DSD_U32_LE
,

227 
SND_PCM_FORMAT_DSD_U16_BE
,

229 
SND_PCM_FORMAT_DSD_U32_BE
,

230 
SND_PCM_FORMAT_LAST
 = 
SND_PCM_FORMAT_DSD_U32_BE
,

232 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


234 
SND_PCM_FORMAT_S16
 = 
SND_PCM_FORMAT_S16_LE
,

236 
SND_PCM_FORMAT_U16
 = 
SND_PCM_FORMAT_U16_LE
,

238 
SND_PCM_FORMAT_S24
 = 
SND_PCM_FORMAT_S24_LE
,

240 
SND_PCM_FORMAT_U24
 = 
SND_PCM_FORMAT_U24_LE
,

242 
SND_PCM_FORMAT_S32
 = 
SND_PCM_FORMAT_S32_LE
,

244 
SND_PCM_FORMAT_U32
 = 
SND_PCM_FORMAT_U32_LE
,

246 
SND_PCM_FORMAT_FLOAT
 = 
SND_PCM_FORMAT_FLOAT_LE
,

248 
SND_PCM_FORMAT_FLOAT64
 = 
SND_PCM_FORMAT_FLOAT64_LE
,

250 
SND_PCM_FORMAT_IEC958_SUBFRAME
 = 
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
,

252 
SND_PCM_FORMAT_S20
 = 
SND_PCM_FORMAT_S20_LE
,

254 
SND_PCM_FORMAT_U20
 = 
SND_PCM_FORMAT_U20_LE
,

255 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


257 
SND_PCM_FORMAT_S16
 = 
SND_PCM_FORMAT_S16_BE
,

259 
SND_PCM_FORMAT_U16
 = 
SND_PCM_FORMAT_U16_BE
,

261 
SND_PCM_FORMAT_S24
 = 
SND_PCM_FORMAT_S24_BE
,

263 
SND_PCM_FORMAT_U24
 = 
SND_PCM_FORMAT_U24_BE
,

265 
SND_PCM_FORMAT_S32
 = 
SND_PCM_FORMAT_S32_BE
,

267 
SND_PCM_FORMAT_U32
 = 
SND_PCM_FORMAT_U32_BE
,

269 
SND_PCM_FORMAT_FLOAT
 = 
SND_PCM_FORMAT_FLOAT_BE
,

271 
SND_PCM_FORMAT_FLOAT64
 = 
SND_PCM_FORMAT_FLOAT64_BE
,

273 
SND_PCM_FORMAT_IEC958_SUBFRAME
 = 
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
,

275 
SND_PCM_FORMAT_S20
 = 
SND_PCM_FORMAT_S20_BE
,

277 
SND_PCM_FORMAT_U20
 = 
SND_PCM_FORMAT_U20_BE
,

281 } 
	t¢d_pcm_f‹m©_t
;

284 
	e_¢d_pcm_subf‹m©
 {

286 
SND_PCM_SUBFORMAT_UNKNOWN
 = -1,

288 
SND_PCM_SUBFORMAT_STD
 = 0,

290 
SND_PCM_SUBFORMAT_MSBITS_MAX
 = 1,

292 
SND_PCM_SUBFORMAT_MSBITS_20
 = 2,

294 
SND_PCM_SUBFORMAT_MSBITS_24
 = 3,

295 
SND_PCM_SUBFORMAT_LAST
 = 
SND_PCM_SUBFORMAT_MSBITS_24


296 } 
	t¢d_pcm_subf‹m©_t
;

299 
	e_¢d_pcm_°©e
 {

301 
SND_PCM_STATE_OPEN
 = 0,

303 
SND_PCM_STATE_SETUP
,

305 
SND_PCM_STATE_PREPARED
,

307 
SND_PCM_STATE_RUNNING
,

309 
SND_PCM_STATE_XRUN
,

311 
SND_PCM_STATE_DRAINING
,

313 
SND_PCM_STATE_PAUSED
,

315 
SND_PCM_STATE_SUSPENDED
,

317 
SND_PCM_STATE_DISCONNECTED
,

318 
SND_PCM_STATE_LAST
 = 
SND_PCM_STATE_DISCONNECTED
,

320 
SND_PCM_STATE_PRIVATE1
 = 1024

321 } 
	t¢d_pcm_°©e_t
;

324 
	e_¢d_pcm_°¨t
 {

326 
SND_PCM_START_DATA
 = 0,

328 
SND_PCM_START_EXPLICIT
,

329 
SND_PCM_START_LAST
 = 
SND_PCM_START_EXPLICIT


330 } 
	t¢d_pcm_°¨t_t
;

333 
	e_¢d_pcm_xrun
 {

335 
SND_PCM_XRUN_NONE
 = 0,

337 
SND_PCM_XRUN_STOP
,

338 
SND_PCM_XRUN_LAST
 = 
SND_PCM_XRUN_STOP


339 } 
	t¢d_pcm_xrun_t
;

342 
	e_¢d_pcm_t°amp
 {

344 
SND_PCM_TSTAMP_NONE
 = 0,

346 
SND_PCM_TSTAMP_ENABLE
,

350 
SND_PCM_TSTAMP_MMAP
 = 
SND_PCM_TSTAMP_ENABLE
,

351 
SND_PCM_TSTAMP_LAST
 = 
SND_PCM_TSTAMP_ENABLE


352 } 
	t¢d_pcm_t°amp_t
;

355 
	e_¢d_pcm_t°amp_ty≥
 {

356 
SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY
 = 0,

357 
SND_PCM_TSTAMP_TYPE_MONOTONIC
,

358 
SND_PCM_TSTAMP_TYPE_MONOTONIC_RAW
,

359 
SND_PCM_TSTAMP_TYPE_LAST
 = 
SND_PCM_TSTAMP_TYPE_MONOTONIC_RAW
,

360 } 
	t¢d_pcm_t°amp_ty≥_t
;

363 
	e_¢d_pcm_audio_t°amp_ty≥
 {

368 
SND_PCM_AUDIO_TSTAMP_TYPE_COMPAT
 = 0,

369 
SND_PCM_AUDIO_TSTAMP_TYPE_DEFAULT
 = 1,

370 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK
 = 2,

371 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_ABSOLUTE
 = 3,

372 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_ESTIMATED
 = 4,

373 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_SYNCHRONIZED
 = 5,

374 
SND_PCM_AUDIO_TSTAMP_TYPE_LAST
 = 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_SYNCHRONIZED


375 } 
	t¢d_pcm_audio_t°amp_ty≥_t
;

378 
	s_¢d_pcm_audio_t°amp_c⁄fig
 {

380 
ty≥_ªque°ed
:4;

381 
ªp‹t_dñay
:1;

382 } 
	t¢d_pcm_audio_t°amp_c⁄fig_t
;

385 
	s_¢d_pcm_audio_t°amp_ªp‹t
 {

388 
vÆid
:1;

389 
a˘uÆ_ty≥
:4;

391 
accuøcy_ªp‹t
:1;

392 
accuøcy
;

393 } 
	t¢d_pcm_audio_t°amp_ªp‹t_t
;

396 
	t¢d_pcm_u‰ames_t
;

398 
	t¢d_pcm_s‰ames_t
;

401 
	#SND_PCM_NONBLOCK
 0x00000001

	)

403 
	#SND_PCM_ASYNC
 0x00000002

	)

405 
	#SND_PCM_EINTR
 0x00000080

	)

407 
	#SND_PCM_ABORT
 0x00008000

	)

409 
	#SND_PCM_NO_AUTO_RESAMPLE
 0x00010000

	)

411 
	#SND_PCM_NO_AUTO_CHANNELS
 0x00020000

	)

413 
	#SND_PCM_NO_AUTO_FORMAT
 0x00040000

	)

415 
	#SND_PCM_NO_SOFTVOL
 0x00080000

	)

418 
_¢d_pcm
 
	t¢d_pcm_t
;

421 
	e_¢d_pcm_ty≥
 {

423 
SND_PCM_TYPE_HW
 = 0,

425 
SND_PCM_TYPE_HOOKS
,

428 
SND_PCM_TYPE_MULTI
,

430 
SND_PCM_TYPE_FILE
,

432 
SND_PCM_TYPE_NULL
,

434 
SND_PCM_TYPE_SHM
,

436 
SND_PCM_TYPE_INET
,

438 
SND_PCM_TYPE_COPY
,

440 
SND_PCM_TYPE_LINEAR
,

442 
SND_PCM_TYPE_ALAW
,

444 
SND_PCM_TYPE_MULAW
,

446 
SND_PCM_TYPE_ADPCM
,

448 
SND_PCM_TYPE_RATE
,

450 
SND_PCM_TYPE_ROUTE
,

452 
SND_PCM_TYPE_PLUG
,

454 
SND_PCM_TYPE_SHARE
,

456 
SND_PCM_TYPE_METER
,

458 
SND_PCM_TYPE_MIX
,

460 
SND_PCM_TYPE_DROUTE
,

462 
SND_PCM_TYPE_LBSERVER
,

464 
SND_PCM_TYPE_LINEAR_FLOAT
,

466 
SND_PCM_TYPE_LADSPA
,

468 
SND_PCM_TYPE_DMIX
,

470 
SND_PCM_TYPE_JACK
,

472 
SND_PCM_TYPE_DSNOOP
,

474 
SND_PCM_TYPE_DSHARE
,

476 
SND_PCM_TYPE_IEC958
,

478 
SND_PCM_TYPE_SOFTVOL
,

480 
SND_PCM_TYPE_IOPLUG
,

482 
SND_PCM_TYPE_EXTPLUG
,

484 
SND_PCM_TYPE_MMAP_EMUL
,

485 
SND_PCM_TYPE_LAST
 = 
SND_PCM_TYPE_MMAP_EMUL


489 
_¢d_pcm_ty≥
 
	t¢d_pcm_ty≥_t
;

492 
	s_¢d_pcm_ch™√l_¨ó
 {

494 *
addr
;

496 
fú°
;

498 
°ï
;

499 } 
	t¢d_pcm_ch™√l_¨ó_t
;

502 
	u_¢d_pcm_sync_id
 {

504 
id
[16];

506 
id16
[8];

508 
id32
[4];

509 } 
	t¢d_pcm_sync_id_t
;

512 
	#SND_PCM_WAIT_INFINITE
 (-1)

	)

514 
	#SND_PCM_WAIT_IO
 (-10001)

	)

516 
	#SND_PCM_WAIT_DRAIN
 (-10002)

	)

519 
_¢d_pcm_sc›e
 
	t¢d_pcm_sc›e_t
;

521 
¢d_pcm_›í
(
¢d_pcm_t
 **
pcm
, c⁄° *
«me
,

522 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

523 
¢d_pcm_›í_lc⁄f
(
¢d_pcm_t
 **
pcm
, c⁄° *
«me
,

524 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
,

525 
¢d_c⁄fig_t
 *
lc⁄f
);

526 
¢d_pcm_›í_ÁŒback
(
¢d_pcm_t
 **
pcm
, 
¢d_c⁄fig_t
 *
roŸ
,

527 c⁄° *
«me
, c⁄° *
‹ig_«me
,

528 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

530 
¢d_pcm_˛o£
(
¢d_pcm_t
 *
pcm
);

531 c⁄° *
¢d_pcm_«me
(
¢d_pcm_t
 *
pcm
);

532 
¢d_pcm_ty≥_t
 
¢d_pcm_ty≥
(
¢d_pcm_t
 *
pcm
);

533 
¢d_pcm_°ªam_t
 
¢d_pcm_°ªam
(
¢d_pcm_t
 *
pcm
);

534 
¢d_pcm_pﬁl_des¸ùt‹s_cou¡
(
¢d_pcm_t
 *
pcm
);

535 
¢d_pcm_pﬁl_des¸ùt‹s
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
•a˚
);

536 
¢d_pcm_pﬁl_des¸ùt‹s_ªvíts
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
);

537 
¢d_pcm_n⁄block
(
¢d_pcm_t
 *
pcm
, 
n⁄block
);

538 
__ölöe__
 
¢d_pcm_ab‹t
(
¢d_pcm_t
 *
pcm
Ë{  
¢d_pcm_n⁄block
(pcm, 2); }

539 
¢d_async_add_pcm_h™dÀr
(
¢d_async_h™dÀr_t
 **
h™dÀr
, 
¢d_pcm_t
 *
pcm
,

540 
¢d_async_ˇŒback_t
 
ˇŒback
, *
¥iv©e_d©a
);

541 
¢d_pcm_t
 *
¢d_async_h™dÀr_gë_pcm
(
¢d_async_h™dÀr_t
 *
h™dÀr
);

542 
¢d_pcm_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_öfo_t
 *
öfo
);

543 
¢d_pcm_hw_∑øms_cuºít
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

544 
¢d_pcm_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

545 
¢d_pcm_hw_‰ì
(
¢d_pcm_t
 *
pcm
);

546 
¢d_pcm_sw_∑øms_cuºít
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
);

547 
¢d_pcm_sw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
);

548 
¢d_pcm_¥ï¨e
(
¢d_pcm_t
 *
pcm
);

549 
¢d_pcm_ª£t
(
¢d_pcm_t
 *
pcm
);

550 
¢d_pcm_°©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©us_t
 *
°©us
);

551 
¢d_pcm_°¨t
(
¢d_pcm_t
 *
pcm
);

552 
¢d_pcm_dr›
(
¢d_pcm_t
 *
pcm
);

553 
¢d_pcm_døö
(
¢d_pcm_t
 *
pcm
);

554 
¢d_pcm_∑u£
(
¢d_pcm_t
 *
pcm
, 
íabÀ
);

555 
¢d_pcm_°©e_t
 
¢d_pcm_°©e
(
¢d_pcm_t
 *
pcm
);

556 
¢d_pcm_hwsync
(
¢d_pcm_t
 *
pcm
);

557 
¢d_pcm_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
);

558 
¢d_pcm_ªsume
(
¢d_pcm_t
 *
pcm
);

559 
¢d_pcm_htime°amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 *
avaû
, 
¢d_htime°amp_t
 *
t°amp
);

560 
¢d_pcm_s‰ames_t
 
¢d_pcm_avaû
(
¢d_pcm_t
 *
pcm
);

561 
¢d_pcm_s‰ames_t
 
¢d_pcm_avaû_upd©e
(
¢d_pcm_t
 *
pcm
);

562 
¢d_pcm_avaû_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
avaûp
, snd_pcm_s‰ames_à*
dñayp
);

563 
¢d_pcm_s‰ames_t
 
¢d_pcm_ªwödabÀ
(
¢d_pcm_t
 *
pcm
);

564 
¢d_pcm_s‰ames_t
 
¢d_pcm_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
);

565 
¢d_pcm_s‰ames_t
 
¢d_pcm_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
);

566 
¢d_pcm_s‰ames_t
 
¢d_pcm_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
);

567 
¢d_pcm_s‰ames_t
 
¢d_pcm_wrôei
(
¢d_pcm_t
 *
pcm
, c⁄° *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
);

568 
¢d_pcm_s‰ames_t
 
¢d_pcm_ªadi
(
¢d_pcm_t
 *
pcm
, *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
);

569 
¢d_pcm_s‰ames_t
 
¢d_pcm_wrôí
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
);

570 
¢d_pcm_s‰ames_t
 
¢d_pcm_ªadn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
);

571 
¢d_pcm_waô
(
¢d_pcm_t
 *
pcm
, 
timeout
);

573 
¢d_pcm_lök
(
¢d_pcm_t
 *
pcm1
, snd_pcm_à*
pcm2
);

574 
¢d_pcm_u∆ök
(
¢d_pcm_t
 *
pcm
);

577 
	#SND_CHMAP_API_VERSION
 ((1 << 16Ë| (0 << 8Ë| 1)

	)

580 
	e¢d_pcm_chm≠_ty≥
 {

581 
SND_CHMAP_TYPE_NONE
 = 0,

582 
SND_CHMAP_TYPE_FIXED
,

583 
SND_CHMAP_TYPE_VAR
,

584 
SND_CHMAP_TYPE_PAIRED
,

585 
SND_CHMAP_TYPE_LAST
 = 
SND_CHMAP_TYPE_PAIRED
,

589 
	e¢d_pcm_chm≠_posôi⁄
 {

590 
SND_CHMAP_UNKNOWN
 = 0,

591 
SND_CHMAP_NA
,

592 
SND_CHMAP_MONO
,

593 
SND_CHMAP_FL
,

594 
SND_CHMAP_FR
,

595 
SND_CHMAP_RL
,

596 
SND_CHMAP_RR
,

597 
SND_CHMAP_FC
,

598 
SND_CHMAP_LFE
,

599 
SND_CHMAP_SL
,

600 
SND_CHMAP_SR
,

601 
SND_CHMAP_RC
,

602 
SND_CHMAP_FLC
,

603 
SND_CHMAP_FRC
,

604 
SND_CHMAP_RLC
,

605 
SND_CHMAP_RRC
,

606 
SND_CHMAP_FLW
,

607 
SND_CHMAP_FRW
,

608 
SND_CHMAP_FLH
,

609 
SND_CHMAP_FCH
,

610 
SND_CHMAP_FRH
,

611 
SND_CHMAP_TC
,

612 
SND_CHMAP_TFL
,

613 
SND_CHMAP_TFR
,

614 
SND_CHMAP_TFC
,

615 
SND_CHMAP_TRL
,

616 
SND_CHMAP_TRR
,

617 
SND_CHMAP_TRC
,

618 
SND_CHMAP_TFLC
,

619 
SND_CHMAP_TFRC
,

620 
SND_CHMAP_TSL
,

621 
SND_CHMAP_TSR
,

622 
SND_CHMAP_LLFE
,

623 
SND_CHMAP_RLFE
,

624 
SND_CHMAP_BC
,

625 
SND_CHMAP_BLC
,

626 
SND_CHMAP_BRC
,

627 
SND_CHMAP_LAST
 = 
SND_CHMAP_BRC
,

631 
	#SND_CHMAP_POSITION_MASK
 0xffff

	)

634 
	#SND_CHMAP_PHASE_INVERSE
 (0x01 << 16)

	)

636 
	#SND_CHMAP_DRIVER_SPEC
 (0x02 << 16)

	)

639 
	s¢d_pcm_chm≠
 {

640 
ch™√ls
;

641 
pos
[0];

642 } 
	t¢d_pcm_chm≠_t
;

645 
	s¢d_pcm_chm≠_quîy
 {

646 
¢d_pcm_chm≠_ty≥
 
ty≥
;

647 
¢d_pcm_chm≠_t
 
m≠
;

648 } 
	t¢d_pcm_chm≠_quîy_t
;

651 
¢d_pcm_chm≠_quîy_t
 **
¢d_pcm_quîy_chm≠s
(
¢d_pcm_t
 *
pcm
);

652 
¢d_pcm_chm≠_quîy_t
 **
¢d_pcm_quîy_chm≠s_‰om_hw
(
ˇrd
, 
dev
,

653 
subdev
,

654 
¢d_pcm_°ªam_t
 
°ªam
);

655 
¢d_pcm_‰ì_chm≠s
(
¢d_pcm_chm≠_quîy_t
 **
m≠s
);

656 
¢d_pcm_chm≠_t
 *
¢d_pcm_gë_chm≠
(
¢d_pcm_t
 *
pcm
);

657 
¢d_pcm_£t_chm≠
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_chm≠_t
 *
m≠
);

659 c⁄° *
¢d_pcm_chm≠_ty≥_«me
(
¢d_pcm_chm≠_ty≥
 
vÆ
);

660 c⁄° *
¢d_pcm_chm≠_«me
(
¢d_pcm_chm≠_posôi⁄
 
vÆ
);

661 c⁄° *
¢d_pcm_chm≠_l⁄g_«me
(
¢d_pcm_chm≠_posôi⁄
 
vÆ
);

662 
¢d_pcm_chm≠_¥öt
(c⁄° 
¢d_pcm_chm≠_t
 *
m≠
, 
size_t
 
maxÀn
, *
buf
);

663 
¢d_pcm_chm≠_‰om_°rög
(c⁄° *
°r
);

664 
¢d_pcm_chm≠_t
 *
¢d_pcm_chm≠_∑r£_°rög
(c⁄° *
°r
);

673 
¢d_pcm_ªcovî
(
¢d_pcm_t
 *
pcm
, 
îr
, 
sûít
);

674 
¢d_pcm_£t_∑øms
(
¢d_pcm_t
 *
pcm
,

675 
¢d_pcm_f‹m©_t
 
f‹m©
,

676 
¢d_pcm_ac˚ss_t
 
ac˚ss
,

677 
ch™√ls
,

678 
øã
,

679 
so·_ªßm∂e
,

680 
œãncy
);

681 
¢d_pcm_gë_∑øms
(
¢d_pcm_t
 *
pcm
,

682 
¢d_pcm_u‰ames_t
 *
buf„r_size
,

683 
¢d_pcm_u‰ames_t
 *
≥riod_size
);

694 
size_t
 
¢d_pcm_öfo_sizeof
();

699 
	#¢d_pcm_öfo_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_pcm_öfo
)

	)

700 
¢d_pcm_öfo_mÆloc
(
¢d_pcm_öfo_t
 **
±r
);

701 
¢d_pcm_öfo_‰ì
(
¢d_pcm_öfo_t
 *
obj
);

702 
¢d_pcm_öfo_c›y
(
¢d_pcm_öfo_t
 *
d°
, c⁄° snd_pcm_öfo_à*
§c
);

703 
¢d_pcm_öfo_gë_devi˚
(c⁄° 
¢d_pcm_öfo_t
 *
obj
);

704 
¢d_pcm_öfo_gë_subdevi˚
(c⁄° 
¢d_pcm_öfo_t
 *
obj
);

705 
¢d_pcm_°ªam_t
 
¢d_pcm_öfo_gë_°ªam
(c⁄° 
¢d_pcm_öfo_t
 *
obj
);

706 
¢d_pcm_öfo_gë_ˇrd
(c⁄° 
¢d_pcm_öfo_t
 *
obj
);

707 c⁄° *
¢d_pcm_öfo_gë_id
(c⁄° 
¢d_pcm_öfo_t
 *
obj
);

708 c⁄° *
¢d_pcm_öfo_gë_«me
(c⁄° 
¢d_pcm_öfo_t
 *
obj
);

709 c⁄° *
¢d_pcm_öfo_gë_subdevi˚_«me
(c⁄° 
¢d_pcm_öfo_t
 *
obj
);

710 
¢d_pcm_˛ass_t
 
¢d_pcm_öfo_gë_˛ass
(c⁄° 
¢d_pcm_öfo_t
 *
obj
);

711 
¢d_pcm_sub˛ass_t
 
¢d_pcm_öfo_gë_sub˛ass
(c⁄° 
¢d_pcm_öfo_t
 *
obj
);

712 
¢d_pcm_öfo_gë_subdevi˚s_cou¡
(c⁄° 
¢d_pcm_öfo_t
 *
obj
);

713 
¢d_pcm_öfo_gë_subdevi˚s_avaû
(c⁄° 
¢d_pcm_öfo_t
 *
obj
);

714 
¢d_pcm_sync_id_t
 
¢d_pcm_öfo_gë_sync
(c⁄° 
¢d_pcm_öfo_t
 *
obj
);

715 
¢d_pcm_öfo_£t_devi˚
(
¢d_pcm_öfo_t
 *
obj
, 
vÆ
);

716 
¢d_pcm_öfo_£t_subdevi˚
(
¢d_pcm_öfo_t
 *
obj
, 
vÆ
);

717 
¢d_pcm_öfo_£t_°ªam
(
¢d_pcm_öfo_t
 *
obj
, 
¢d_pcm_°ªam_t
 
vÆ
);

728 
¢d_pcm_hw_∑øms_™y
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

730 
¢d_pcm_hw_∑øms_ˇn_mm≠_ßm∂e_ªsﬁuti⁄
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

731 
¢d_pcm_hw_∑øms_is_doubÀ
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

732 
¢d_pcm_hw_∑øms_is_b©ch
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

733 
¢d_pcm_hw_∑øms_is_block_å™s„r
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

734 
¢d_pcm_hw_∑øms_is_m⁄Ÿ⁄ic
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

735 
¢d_pcm_hw_∑øms_ˇn_ovîønge
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

736 
¢d_pcm_hw_∑øms_ˇn_∑u£
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

737 
¢d_pcm_hw_∑øms_ˇn_ªsume
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

738 
¢d_pcm_hw_∑øms_is_hÆf_du∂ex
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

739 
¢d_pcm_hw_∑øms_is_joöt_du∂ex
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

740 
¢d_pcm_hw_∑øms_ˇn_sync_°¨t
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

741 
¢d_pcm_hw_∑øms_ˇn_dißbÀ_≥riod_wakeup
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

742 
¢d_pcm_hw_∑øms_is_≥r„˘_døö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

743 
¢d_pcm_hw_∑øms_suµ‹ts_audio_wÆl˛ock_ts
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

744 
¢d_pcm_hw_∑øms_suµ‹ts_audio_ts_ty≥
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
ty≥
);

745 
¢d_pcm_hw_∑øms_gë_øã_numdí
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

746 *
øã_num
,

747 *
øã_dí
);

748 
¢d_pcm_hw_∑øms_gë_sbôs
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

749 
¢d_pcm_hw_∑øms_gë_fifo_size
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

752 
_¢d_pcm_hw_°øãgy
 
	t¢d_pcm_hw_°øãgy_t
;

755 
	s_¢d_pcm_hw_°øãgy_sim∂e_choi˚s_li°
 {

756 
vÆue
;

757 
bad√ss
;

758 } 
	t¢d_pcm_hw_°øãgy_sim∂e_choi˚s_li°_t
;

760 
¢d_pcm_hw_∑øms_°øãgy
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

761 c⁄° 
¢d_pcm_hw_°øãgy_t
 *
°øãgy
,

762 
bad√ss_mö
,

763 
bad√ss_max
);

765 
¢d_pcm_hw_°øãgy_‰ì
(
¢d_pcm_hw_°øãgy_t
 *
°øãgy
);

766 
¢d_pcm_hw_°øãgy_sim∂e
(
¢d_pcm_hw_°øãgy_t
 **
°øãgyp
,

767 
bad√ss_mö
,

768 
bad√ss_max
);

769 
¢d_pcm_hw_∑øms_åy_ex∂aö_Áûuª
(
¢d_pcm_t
 *
pcm
,

770 
¢d_pcm_hw_∑øms_t
 *
Áû
,

771 
¢d_pcm_hw_∑øms_t
 *
suc˚ss
,

772 
dïth
,

773 
¢d_ouçut_t
 *
out
);

777 
size_t
 
¢d_pcm_hw_∑øms_sizeof
();

782 
	#¢d_pcm_hw_∑øms_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_pcm_hw_∑øms
)

	)

783 
¢d_pcm_hw_∑øms_mÆloc
(
¢d_pcm_hw_∑øms_t
 **
±r
);

784 
¢d_pcm_hw_∑øms_‰ì
(
¢d_pcm_hw_∑øms_t
 *
obj
);

785 
¢d_pcm_hw_∑øms_c›y
(
¢d_pcm_hw_∑øms_t
 *
d°
, c⁄° snd_pcm_hw_∑øms_à*
§c
);

787 #i‡!
deföed
(
ALSA_LIBRARY_BUILD
Ë&& !deföed(
ALSA_PCM_OLD_HW_PARAMS_API
)

789 
¢d_pcm_hw_∑øms_gë_ac˚ss
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 *
_ac˚ss
);

790 
¢d_pcm_hw_∑øms_ã°_ac˚ss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 
_ac˚ss
);

791 
¢d_pcm_hw_∑øms_£t_ac˚ss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 
_ac˚ss
);

792 
¢d_pcm_hw_∑øms_£t_ac˚ss_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 *
_ac˚ss
);

793 
¢d_pcm_hw_∑øms_£t_ac˚ss_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 *
_ac˚ss
);

794 
¢d_pcm_hw_∑øms_£t_ac˚ss_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_mask_t
 *
mask
);

795 
¢d_pcm_hw_∑øms_gë_ac˚ss_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_mask_t
 *
mask
);

797 
¢d_pcm_hw_∑øms_gë_f‹m©
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 *
vÆ
);

798 
¢d_pcm_hw_∑øms_ã°_f‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 
vÆ
);

799 
¢d_pcm_hw_∑øms_£t_f‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 
vÆ
);

800 
¢d_pcm_hw_∑øms_£t_f‹m©_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 *
f‹m©
);

801 
¢d_pcm_hw_∑øms_£t_f‹m©_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 *
f‹m©
);

802 
¢d_pcm_hw_∑øms_£t_f‹m©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_mask_t
 *
mask
);

803 
¢d_pcm_hw_∑øms_gë_f‹m©_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_mask_t
 *
mask
);

805 
¢d_pcm_hw_∑øms_gë_subf‹m©
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 *
subf‹m©
);

806 
¢d_pcm_hw_∑øms_ã°_subf‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 
subf‹m©
);

807 
¢d_pcm_hw_∑øms_£t_subf‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 
subf‹m©
);

808 
¢d_pcm_hw_∑øms_£t_subf‹m©_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 *
subf‹m©
);

809 
¢d_pcm_hw_∑øms_£t_subf‹m©_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 *
subf‹m©
);

810 
¢d_pcm_hw_∑øms_£t_subf‹m©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_mask_t
 *
mask
);

811 
¢d_pcm_hw_∑øms_gë_subf‹m©_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_mask_t
 *
mask
);

813 
¢d_pcm_hw_∑øms_gë_ch™√ls
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

814 
¢d_pcm_hw_∑øms_gë_ch™√ls_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

815 
¢d_pcm_hw_∑øms_gë_ch™√ls_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

816 
¢d_pcm_hw_∑øms_ã°_ch™√ls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
);

817 
¢d_pcm_hw_∑øms_£t_ch™√ls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
);

818 
¢d_pcm_hw_∑øms_£t_ch™√ls_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

819 
¢d_pcm_hw_∑øms_£t_ch™√ls_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

820 
¢d_pcm_hw_∑øms_£t_ch™√ls_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
max
);

821 
¢d_pcm_hw_∑øms_£t_ch™√ls_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

822 
¢d_pcm_hw_∑øms_£t_ch™√ls_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

823 
¢d_pcm_hw_∑øms_£t_ch™√ls_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

825 
¢d_pcm_hw_∑øms_gë_øã
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

826 
¢d_pcm_hw_∑øms_gë_øã_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

827 
¢d_pcm_hw_∑øms_gë_øã_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

828 
¢d_pcm_hw_∑øms_ã°_øã
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

829 
¢d_pcm_hw_∑øms_£t_øã
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

830 
¢d_pcm_hw_∑øms_£t_øã_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

831 
¢d_pcm_hw_∑øms_£t_øã_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

832 
¢d_pcm_hw_∑øms_£t_øã_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
);

833 
¢d_pcm_hw_∑øms_£t_øã_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

834 
¢d_pcm_hw_∑øms_£t_øã_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

835 
¢d_pcm_hw_∑øms_£t_øã_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

836 
¢d_pcm_hw_∑øms_£t_øã_ªßm∂e
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
);

837 
¢d_pcm_hw_∑øms_gë_øã_ªßm∂e
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

838 
¢d_pcm_hw_∑øms_£t_exp‹t_buf„r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
);

839 
¢d_pcm_hw_∑øms_gë_exp‹t_buf„r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

840 
¢d_pcm_hw_∑øms_£t_≥riod_wakeup
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
);

841 
¢d_pcm_hw_∑øms_gë_≥riod_wakeup
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

842 
¢d_pcm_hw_∑øms_£t_døö_sûí˚
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
);

843 
¢d_pcm_hw_∑øms_gë_døö_sûí˚
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

845 
¢d_pcm_hw_∑øms_gë_≥riod_time
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

846 
¢d_pcm_hw_∑øms_gë_≥riod_time_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

847 
¢d_pcm_hw_∑øms_gë_≥riod_time_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

848 
¢d_pcm_hw_∑øms_ã°_≥riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

849 
¢d_pcm_hw_∑øms_£t_≥riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

850 
¢d_pcm_hw_∑øms_£t_≥riod_time_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

851 
¢d_pcm_hw_∑øms_£t_≥riod_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

852 
¢d_pcm_hw_∑øms_£t_≥riod_time_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
);

853 
¢d_pcm_hw_∑øms_£t_≥riod_time_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

854 
¢d_pcm_hw_∑øms_£t_≥riod_time_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

855 
¢d_pcm_hw_∑øms_£t_≥riod_time_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

857 
¢d_pcm_hw_∑øms_gë_≥riod_size
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
‰ames
, *
dú
);

858 
¢d_pcm_hw_∑øms_gë_≥riod_size_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
‰ames
, *
dú
);

859 
¢d_pcm_hw_∑øms_gë_≥riod_size_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
‰ames
, *
dú
);

860 
¢d_pcm_hw_∑øms_ã°_≥riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
, 
dú
);

861 
¢d_pcm_hw_∑øms_£t_≥riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
, 
dú
);

862 
¢d_pcm_hw_∑øms_£t_≥riod_size_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
);

863 
¢d_pcm_hw_∑øms_£t_≥riod_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
);

864 
¢d_pcm_hw_∑øms_£t_≥riod_size_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
mö
, *
mödú
, snd_pcm_u‰ames_à*
max
, *
maxdú
);

865 
¢d_pcm_hw_∑øms_£t_≥riod_size_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
);

866 
¢d_pcm_hw_∑øms_£t_≥riod_size_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
);

867 
¢d_pcm_hw_∑øms_£t_≥riod_size_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
);

868 
¢d_pcm_hw_∑øms_£t_≥riod_size_öãgî
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

870 
¢d_pcm_hw_∑øms_gë_≥riods
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

871 
¢d_pcm_hw_∑øms_gë_≥riods_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

872 
¢d_pcm_hw_∑øms_gë_≥riods_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

873 
¢d_pcm_hw_∑øms_ã°_≥riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

874 
¢d_pcm_hw_∑øms_£t_≥riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

875 
¢d_pcm_hw_∑øms_£t_≥riods_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

876 
¢d_pcm_hw_∑øms_£t_≥riods_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

877 
¢d_pcm_hw_∑øms_£t_≥riods_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
);

878 
¢d_pcm_hw_∑øms_£t_≥riods_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

879 
¢d_pcm_hw_∑øms_£t_≥riods_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

880 
¢d_pcm_hw_∑øms_£t_≥riods_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

881 
¢d_pcm_hw_∑øms_£t_≥riods_öãgî
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

883 
¢d_pcm_hw_∑øms_gë_buf„r_time
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

884 
¢d_pcm_hw_∑øms_gë_buf„r_time_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

885 
¢d_pcm_hw_∑øms_gë_buf„r_time_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

886 
¢d_pcm_hw_∑øms_ã°_buf„r_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

887 
¢d_pcm_hw_∑øms_£t_buf„r_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

888 
¢d_pcm_hw_∑øms_£t_buf„r_time_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

889 
¢d_pcm_hw_∑øms_£t_buf„r_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

890 
¢d_pcm_hw_∑øms_£t_buf„r_time_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
);

891 
¢d_pcm_hw_∑øms_£t_buf„r_time_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

892 
¢d_pcm_hw_∑øms_£t_buf„r_time_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

893 
¢d_pcm_hw_∑øms_£t_buf„r_time_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

895 
¢d_pcm_hw_∑øms_gë_buf„r_size
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

896 
¢d_pcm_hw_∑øms_gë_buf„r_size_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

897 
¢d_pcm_hw_∑øms_gë_buf„r_size_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

898 
¢d_pcm_hw_∑øms_ã°_buf„r_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

899 
¢d_pcm_hw_∑øms_£t_buf„r_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

900 
¢d_pcm_hw_∑øms_£t_buf„r_size_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

901 
¢d_pcm_hw_∑øms_£t_buf„r_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

902 
¢d_pcm_hw_∑øms_£t_buf„r_size_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
mö
, snd_pcm_u‰ames_à*
max
);

903 
¢d_pcm_hw_∑øms_£t_buf„r_size_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

904 
¢d_pcm_hw_∑øms_£t_buf„r_size_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

905 
¢d_pcm_hw_∑øms_£t_buf„r_size_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

909 
¢d_pcm_hw_∑øms_gë_mö_Æign
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

920 
size_t
 
¢d_pcm_sw_∑øms_sizeof
();

925 
	#¢d_pcm_sw_∑øms_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_pcm_sw_∑øms
)

	)

926 
¢d_pcm_sw_∑øms_mÆloc
(
¢d_pcm_sw_∑øms_t
 **
±r
);

927 
¢d_pcm_sw_∑øms_‰ì
(
¢d_pcm_sw_∑øms_t
 *
obj
);

928 
¢d_pcm_sw_∑øms_c›y
(
¢d_pcm_sw_∑øms_t
 *
d°
, c⁄° snd_pcm_sw_∑øms_à*
§c
);

929 
¢d_pcm_sw_∑øms_gë_bound¨y
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

931 #i‡!
deföed
(
ALSA_LIBRARY_BUILD
Ë&& !deföed(
ALSA_PCM_OLD_SW_PARAMS_API
)

933 
¢d_pcm_sw_∑øms_£t_t°amp_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_t°amp_t
 
vÆ
);

934 
¢d_pcm_sw_∑øms_gë_t°amp_mode
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_t°amp_t
 *
vÆ
);

935 
¢d_pcm_sw_∑øms_£t_t°amp_ty≥
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_t°amp_ty≥_t
 
vÆ
);

936 
¢d_pcm_sw_∑øms_gë_t°amp_ty≥
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_t°amp_ty≥_t
 *
vÆ
);

937 
¢d_pcm_sw_∑øms_£t_avaû_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

938 
¢d_pcm_sw_∑øms_gë_avaû_mö
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

939 
¢d_pcm_sw_∑øms_£t_≥riod_evít
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
vÆ
);

940 
¢d_pcm_sw_∑øms_gë_≥riod_evít
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, *
vÆ
);

941 
¢d_pcm_sw_∑øms_£t_°¨t_thªshﬁd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

942 
¢d_pcm_sw_∑øms_gë_°¨t_thªshﬁd
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑ømsm
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

943 
¢d_pcm_sw_∑øms_£t_°›_thªshﬁd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

944 
¢d_pcm_sw_∑øms_gë_°›_thªshﬁd
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

945 
¢d_pcm_sw_∑øms_£t_sûí˚_thªshﬁd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

946 
¢d_pcm_sw_∑øms_gë_sûí˚_thªshﬁd
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

947 
¢d_pcm_sw_∑øms_£t_sûí˚_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

948 
¢d_pcm_sw_∑øms_gë_sûí˚_size
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

955 #i‚de‡
ALSA_LIBRARY_BUILD


956 #i‡
deföed
(
ALSA_PCM_OLD_HW_PARAMS_API
Ë|| deföed(
ALSA_PCM_OLD_SW_PARAMS_API
)

957 
	~"pcm_ﬁd.h
"

968 
size_t
 
¢d_pcm_ac˚ss_mask_sizeof
();

973 
	#¢d_pcm_ac˚ss_mask_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_pcm_ac˚ss_mask
)

	)

974 
¢d_pcm_ac˚ss_mask_mÆloc
(
¢d_pcm_ac˚ss_mask_t
 **
±r
);

975 
¢d_pcm_ac˚ss_mask_‰ì
(
¢d_pcm_ac˚ss_mask_t
 *
obj
);

976 
¢d_pcm_ac˚ss_mask_c›y
(
¢d_pcm_ac˚ss_mask_t
 *
d°
, c⁄° snd_pcm_ac˚ss_mask_à*
§c
);

977 
¢d_pcm_ac˚ss_mask_n⁄e
(
¢d_pcm_ac˚ss_mask_t
 *
mask
);

978 
¢d_pcm_ac˚ss_mask_™y
(
¢d_pcm_ac˚ss_mask_t
 *
mask
);

979 
¢d_pcm_ac˚ss_mask_ã°
(c⁄° 
¢d_pcm_ac˚ss_mask_t
 *
mask
, 
¢d_pcm_ac˚ss_t
 
vÆ
);

980 
¢d_pcm_ac˚ss_mask_em±y
(c⁄° 
¢d_pcm_ac˚ss_mask_t
 *
mask
);

981 
¢d_pcm_ac˚ss_mask_£t
(
¢d_pcm_ac˚ss_mask_t
 *
mask
, 
¢d_pcm_ac˚ss_t
 
vÆ
);

982 
¢d_pcm_ac˚ss_mask_ª£t
(
¢d_pcm_ac˚ss_mask_t
 *
mask
, 
¢d_pcm_ac˚ss_t
 
vÆ
);

993 
size_t
 
¢d_pcm_f‹m©_mask_sizeof
();

998 
	#¢d_pcm_f‹m©_mask_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_pcm_f‹m©_mask
)

	)

999 
¢d_pcm_f‹m©_mask_mÆloc
(
¢d_pcm_f‹m©_mask_t
 **
±r
);

1000 
¢d_pcm_f‹m©_mask_‰ì
(
¢d_pcm_f‹m©_mask_t
 *
obj
);

1001 
¢d_pcm_f‹m©_mask_c›y
(
¢d_pcm_f‹m©_mask_t
 *
d°
, c⁄° snd_pcm_f‹m©_mask_à*
§c
);

1002 
¢d_pcm_f‹m©_mask_n⁄e
(
¢d_pcm_f‹m©_mask_t
 *
mask
);

1003 
¢d_pcm_f‹m©_mask_™y
(
¢d_pcm_f‹m©_mask_t
 *
mask
);

1004 
¢d_pcm_f‹m©_mask_ã°
(c⁄° 
¢d_pcm_f‹m©_mask_t
 *
mask
, 
¢d_pcm_f‹m©_t
 
vÆ
);

1005 
¢d_pcm_f‹m©_mask_em±y
(c⁄° 
¢d_pcm_f‹m©_mask_t
 *
mask
);

1006 
¢d_pcm_f‹m©_mask_£t
(
¢d_pcm_f‹m©_mask_t
 *
mask
, 
¢d_pcm_f‹m©_t
 
vÆ
);

1007 
¢d_pcm_f‹m©_mask_ª£t
(
¢d_pcm_f‹m©_mask_t
 *
mask
, 
¢d_pcm_f‹m©_t
 
vÆ
);

1018 
size_t
 
¢d_pcm_subf‹m©_mask_sizeof
();

1023 
	#¢d_pcm_subf‹m©_mask_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_pcm_subf‹m©_mask
)

	)

1024 
¢d_pcm_subf‹m©_mask_mÆloc
(
¢d_pcm_subf‹m©_mask_t
 **
±r
);

1025 
¢d_pcm_subf‹m©_mask_‰ì
(
¢d_pcm_subf‹m©_mask_t
 *
obj
);

1026 
¢d_pcm_subf‹m©_mask_c›y
(
¢d_pcm_subf‹m©_mask_t
 *
d°
, c⁄° snd_pcm_subf‹m©_mask_à*
§c
);

1027 
¢d_pcm_subf‹m©_mask_n⁄e
(
¢d_pcm_subf‹m©_mask_t
 *
mask
);

1028 
¢d_pcm_subf‹m©_mask_™y
(
¢d_pcm_subf‹m©_mask_t
 *
mask
);

1029 
¢d_pcm_subf‹m©_mask_ã°
(c⁄° 
¢d_pcm_subf‹m©_mask_t
 *
mask
, 
¢d_pcm_subf‹m©_t
 
vÆ
);

1030 
¢d_pcm_subf‹m©_mask_em±y
(c⁄° 
¢d_pcm_subf‹m©_mask_t
 *
mask
);

1031 
¢d_pcm_subf‹m©_mask_£t
(
¢d_pcm_subf‹m©_mask_t
 *
mask
, 
¢d_pcm_subf‹m©_t
 
vÆ
);

1032 
¢d_pcm_subf‹m©_mask_ª£t
(
¢d_pcm_subf‹m©_mask_t
 *
mask
, 
¢d_pcm_subf‹m©_t
 
vÆ
);

1043 
size_t
 
¢d_pcm_°©us_sizeof
();

1048 
	#¢d_pcm_°©us_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_pcm_°©us
)

	)

1049 
¢d_pcm_°©us_mÆloc
(
¢d_pcm_°©us_t
 **
±r
);

1050 
¢d_pcm_°©us_‰ì
(
¢d_pcm_°©us_t
 *
obj
);

1051 
¢d_pcm_°©us_c›y
(
¢d_pcm_°©us_t
 *
d°
, c⁄° snd_pcm_°©us_à*
§c
);

1052 
¢d_pcm_°©e_t
 
¢d_pcm_°©us_gë_°©e
(c⁄° 
¢d_pcm_°©us_t
 *
obj
);

1053 
¢d_pcm_°©us_gë_åiggî_t°amp
(c⁄° 
¢d_pcm_°©us_t
 *
obj
, 
¢d_time°amp_t
 *
±r
);

1054 
¢d_pcm_°©us_gë_åiggî_ht°amp
(c⁄° 
¢d_pcm_°©us_t
 *
obj
, 
¢d_htime°amp_t
 *
±r
);

1055 
¢d_pcm_°©us_gë_t°amp
(c⁄° 
¢d_pcm_°©us_t
 *
obj
, 
¢d_time°amp_t
 *
±r
);

1056 
¢d_pcm_°©us_gë_ht°amp
(c⁄° 
¢d_pcm_°©us_t
 *
obj
, 
¢d_htime°amp_t
 *
±r
);

1057 
¢d_pcm_°©us_gë_audio_ht°amp
(c⁄° 
¢d_pcm_°©us_t
 *
obj
, 
¢d_htime°amp_t
 *
±r
);

1058 
¢d_pcm_°©us_gë_drivî_ht°amp
(c⁄° 
¢d_pcm_°©us_t
 *
obj
, 
¢d_htime°amp_t
 *
±r
);

1059 
¢d_pcm_°©us_gë_audio_ht°amp_ªp‹t
(c⁄° 
¢d_pcm_°©us_t
 *
obj
,

1060 
¢d_pcm_audio_t°amp_ªp‹t_t
 *
audio_t°amp_ªp‹t
);

1061 
¢d_pcm_°©us_£t_audio_ht°amp_c⁄fig
(
¢d_pcm_°©us_t
 *
obj
,

1062 
¢d_pcm_audio_t°amp_c⁄fig_t
 *
audio_t°amp_c⁄fig
);

1064 
ölöe
 
¢d_pcm_∑ck_audio_t°amp_c⁄fig
(*
d©a
,

1065 
¢d_pcm_audio_t°amp_c⁄fig_t
 *
c⁄fig
)

1067 *
d©a
 = 
c⁄fig
->
ªp‹t_dñay
;

1068 *
d©a
 <<= 4;

1069 *
d©a
 |
c⁄fig
->
ty≥_ªque°ed
;

1072 
ölöe
 
¢d_pcm_u≈ack_audio_t°amp_ªp‹t
(
d©a
, 
accuøcy
,

1073 
¢d_pcm_audio_t°amp_ªp‹t_t
 *
ªp‹t
)

1075 
d©a
 >>= 16;

1076 
ªp‹t
->
vÆid
 = 
d©a
 & 1;

1077 
ªp‹t
->
a˘uÆ_ty≥
 = (
d©a
 >> 1) & 0xF;

1078 
ªp‹t
->
accuøcy_ªp‹t
 = (
d©a
 >> 5) & 1;

1079 
ªp‹t
->
accuøcy
 =áccuracy;

1082 
¢d_pcm_s‰ames_t
 
¢d_pcm_°©us_gë_dñay
(c⁄° 
¢d_pcm_°©us_t
 *
obj
);

1083 
¢d_pcm_u‰ames_t
 
¢d_pcm_°©us_gë_avaû
(c⁄° 
¢d_pcm_°©us_t
 *
obj
);

1084 
¢d_pcm_u‰ames_t
 
¢d_pcm_°©us_gë_avaû_max
(c⁄° 
¢d_pcm_°©us_t
 *
obj
);

1085 
¢d_pcm_u‰ames_t
 
¢d_pcm_°©us_gë_ovîønge
(c⁄° 
¢d_pcm_°©us_t
 *
obj
);

1096 c⁄° *
¢d_pcm_ty≥_«me
(
¢d_pcm_ty≥_t
 
ty≥
);

1097 c⁄° *
¢d_pcm_°ªam_«me
(c⁄° 
¢d_pcm_°ªam_t
 
°ªam
);

1098 c⁄° *
¢d_pcm_ac˚ss_«me
(c⁄° 
¢d_pcm_ac˚ss_t
 
_ac˚ss
);

1099 c⁄° *
¢d_pcm_f‹m©_«me
(c⁄° 
¢d_pcm_f‹m©_t
 
f‹m©
);

1100 c⁄° *
¢d_pcm_f‹m©_des¸ùti⁄
(c⁄° 
¢d_pcm_f‹m©_t
 
f‹m©
);

1101 c⁄° *
¢d_pcm_subf‹m©_«me
(c⁄° 
¢d_pcm_subf‹m©_t
 
subf‹m©
);

1102 c⁄° *
¢d_pcm_subf‹m©_des¸ùti⁄
(c⁄° 
¢d_pcm_subf‹m©_t
 
subf‹m©
);

1103 
¢d_pcm_subf‹m©_t
 
¢d_pcm_subf‹m©_vÆue
(c⁄° * 
«me
);

1104 
¢d_pcm_f‹m©_t
 
¢d_pcm_f‹m©_vÆue
(c⁄° * 
«me
);

1105 c⁄° *
¢d_pcm_t°amp_mode_«me
(c⁄° 
¢d_pcm_t°amp_t
 
mode
);

1106 c⁄° *
¢d_pcm_°©e_«me
(c⁄° 
¢d_pcm_°©e_t
 
°©e
);

1117 
¢d_pcm_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
);

1118 
¢d_pcm_dump_hw_£tup
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
);

1119 
¢d_pcm_dump_sw_£tup
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
);

1120 
¢d_pcm_dump_£tup
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
);

1121 
¢d_pcm_hw_∑øms_dump
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_ouçut_t
 *
out
);

1122 
¢d_pcm_sw_∑øms_dump
(
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_ouçut_t
 *
out
);

1123 
¢d_pcm_°©us_dump
(
¢d_pcm_°©us_t
 *
°©us
, 
¢d_ouçut_t
 *
out
);

1134 
¢d_pcm_mm≠_begö
(
¢d_pcm_t
 *
pcm
,

1135 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 **
¨ós
,

1136 
¢d_pcm_u‰ames_t
 *
off£t
,

1137 
¢d_pcm_u‰ames_t
 *
‰ames
);

1138 
¢d_pcm_s‰ames_t
 
¢d_pcm_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

1139 
¢d_pcm_u‰ames_t
 
off£t
,

1140 
¢d_pcm_u‰ames_t
 
‰ames
);

1141 
¢d_pcm_s‰ames_t
 
¢d_pcm_mm≠_wrôei
(
¢d_pcm_t
 *
pcm
, c⁄° *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
);

1142 
¢d_pcm_s‰ames_t
 
¢d_pcm_mm≠_ªadi
(
¢d_pcm_t
 *
pcm
, *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
);

1143 
¢d_pcm_s‰ames_t
 
¢d_pcm_mm≠_wrôí
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
);

1144 
¢d_pcm_s‰ames_t
 
¢d_pcm_mm≠_ªadn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
);

1155 
¢d_pcm_f‹m©_sig√d
(
¢d_pcm_f‹m©_t
 
f‹m©
);

1156 
¢d_pcm_f‹m©_unsig√d
(
¢d_pcm_f‹m©_t
 
f‹m©
);

1157 
¢d_pcm_f‹m©_löór
(
¢d_pcm_f‹m©_t
 
f‹m©
);

1158 
¢d_pcm_f‹m©_Êﬂt
(
¢d_pcm_f‹m©_t
 
f‹m©
);

1159 
¢d_pcm_f‹m©_lôée_ídün
(
¢d_pcm_f‹m©_t
 
f‹m©
);

1160 
¢d_pcm_f‹m©_big_ídün
(
¢d_pcm_f‹m©_t
 
f‹m©
);

1161 
¢d_pcm_f‹m©_˝u_ídün
(
¢d_pcm_f‹m©_t
 
f‹m©
);

1162 
¢d_pcm_f‹m©_width
(
¢d_pcm_f‹m©_t
 
f‹m©
);

1163 
¢d_pcm_f‹m©_physiˇl_width
(
¢d_pcm_f‹m©_t
 
f‹m©
);

1164 
¢d_pcm_f‹m©_t
 
¢d_pcm_buûd_löór_f‹m©
(
width
, 
pwidth
, 
unsignd
, 
big_ídün
);

1165 
ssize_t
 
¢d_pcm_f‹m©_size
(
¢d_pcm_f‹m©_t
 
f‹m©
, 
size_t
 
ßm∂es
);

1166 
uöt8_t
 
¢d_pcm_f‹m©_sûí˚
(
¢d_pcm_f‹m©_t
 
f‹m©
);

1167 
uöt16_t
 
¢d_pcm_f‹m©_sûí˚_16
(
¢d_pcm_f‹m©_t
 
f‹m©
);

1168 
uöt32_t
 
¢d_pcm_f‹m©_sûí˚_32
(
¢d_pcm_f‹m©_t
 
f‹m©
);

1169 
uöt64_t
 
¢d_pcm_f‹m©_sûí˚_64
(
¢d_pcm_f‹m©_t
 
f‹m©
);

1170 
¢d_pcm_f‹m©_£t_sûí˚
(
¢d_pcm_f‹m©_t
 
f‹m©
, *
buf
, 
ßm∂es
);

1172 
¢d_pcm_s‰ames_t
 
¢d_pcm_byãs_to_‰ames
(
¢d_pcm_t
 *
pcm
, 
ssize_t
 
byãs
);

1173 
ssize_t
 
¢d_pcm_‰ames_to_byãs
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 
‰ames
);

1174 
¢d_pcm_byãs_to_ßm∂es
(
¢d_pcm_t
 *
pcm
, 
ssize_t
 
byãs
);

1175 
ssize_t
 
¢d_pcm_ßm∂es_to_byãs
(
¢d_pcm_t
 *
pcm
, 
ßm∂es
);

1177 
¢d_pcm_¨ó_sûí˚
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_ch™√l
, 
¢d_pcm_u‰ames_t
 
d°_off£t
,

1178 
ßm∂es
, 
¢d_pcm_f‹m©_t
 
f‹m©
);

1179 
¢d_pcm_¨ós_sûí˚
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_ch™√ls
, 
¢d_pcm_u‰ames_t
 
d°_off£t
,

1180 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
, 
¢d_pcm_f‹m©_t
 
f‹m©
);

1181 
¢d_pcm_¨ó_c›y
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_ch™√l
, 
¢d_pcm_u‰ames_t
 
d°_off£t
,

1182 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_ch™√l
, 
¢d_pcm_u‰ames_t
 
§c_off£t
,

1183 
ßm∂es
, 
¢d_pcm_f‹m©_t
 
f‹m©
);

1184 
¢d_pcm_¨ós_c›y
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_ch™√ls
, 
¢d_pcm_u‰ames_t
 
d°_off£t
,

1185 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_ch™√ls
, 
¢d_pcm_u‰ames_t
 
§c_off£t
,

1186 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
, 
¢d_pcm_f‹m©_t
 
f‹m©
);

1187 
¢d_pcm_¨ós_c›y_wøp
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_ch™√ls
,

1188 
¢d_pcm_u‰ames_t
 
d°_off£t
,

1189 c⁄° 
¢d_pcm_u‰ames_t
 
d°_size
,

1190 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_ch™√ls
,

1191 
¢d_pcm_u‰ames_t
 
§c_off£t
,

1192 c⁄° 
¢d_pcm_u‰ames_t
 
§c_size
,

1193 c⁄° 
ch™√ls
,

1194 
¢d_pcm_u‰ames_t
 
‰ames
,

1195 c⁄° 
¢d_pcm_f‹m©_t
 
f‹m©
);

1204 
ölöe
 *
¢d_pcm_ch™√l_¨ó_addr
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ó
, 
¢d_pcm_u‰ames_t
 
off£t
)

1206  (*)
¨ó
->
addr
 + (¨ó->
fú°
 +áªa->
°ï
 * 
off£t
) / 8;

1215 
ölöe
 
¢d_pcm_ch™√l_¨ó_°ï
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ó
)

1217  
¨ó
->
°ï
 / 8;

1230 
	e_¢d_pcm_hook_ty≥
 {

1231 
SND_PCM_HOOK_TYPE_HW_PARAMS
 = 0,

1232 
SND_PCM_HOOK_TYPE_HW_FREE
,

1233 
SND_PCM_HOOK_TYPE_CLOSE
,

1234 
SND_PCM_HOOK_TYPE_LAST
 = 
SND_PCM_HOOK_TYPE_CLOSE


1235 } 
	t¢d_pcm_hook_ty≥_t
;

1238 
_¢d_pcm_hook
 
	t¢d_pcm_hook_t
;

1240 (*
¢d_pcm_hook_func_t
)(
	t¢d_pcm_hook_t
 *
	thook
);

1241 
¢d_pcm_t
 *
¢d_pcm_hook_gë_pcm
(
¢d_pcm_hook_t
 *
hook
);

1242 *
¢d_pcm_hook_gë_¥iv©e
(
¢d_pcm_hook_t
 *
hook
);

1243 
¢d_pcm_hook_£t_¥iv©e
(
¢d_pcm_hook_t
 *
hook
, *
¥iv©e_d©a
);

1244 
¢d_pcm_hook_add
(
¢d_pcm_hook_t
 **
hookp
, 
¢d_pcm_t
 *
pcm
,

1245 
¢d_pcm_hook_ty≥_t
 
ty≥
,

1246 
¢d_pcm_hook_func_t
 
func
, *
¥iv©e_d©a
);

1247 
¢d_pcm_hook_ªmove
(
¢d_pcm_hook_t
 *
hook
);

1259 
	s_¢d_pcm_sc›e_›s
 {

1263 (*
íabÀ
)(
¢d_pcm_sc›e_t
 *
sc›e
);

1267 (*
dißbÀ
)(
¢d_pcm_sc›e_t
 *
sc›e
);

1271 (*
°¨t
)(
¢d_pcm_sc›e_t
 *
sc›e
);

1275 (*
°›
)(
¢d_pcm_sc›e_t
 *
sc›e
);

1279 (*
upd©e
)(
¢d_pcm_sc›e_t
 *
sc›e
);

1283 (*
ª£t
)(
¢d_pcm_sc›e_t
 *
sc›e
);

1287 (*
˛o£
)(
¢d_pcm_sc›e_t
 *
sc›e
);

1288 } 
	t¢d_pcm_sc›e_›s_t
;

1290 
¢d_pcm_u‰ames_t
 
¢d_pcm_mëî_gë_bufsize
(
¢d_pcm_t
 *
pcm
);

1291 
¢d_pcm_mëî_gë_ch™√ls
(
¢d_pcm_t
 *
pcm
);

1292 
¢d_pcm_mëî_gë_øã
(
¢d_pcm_t
 *
pcm
);

1293 
¢d_pcm_u‰ames_t
 
¢d_pcm_mëî_gë_now
(
¢d_pcm_t
 *
pcm
);

1294 
¢d_pcm_u‰ames_t
 
¢d_pcm_mëî_gë_bound¨y
(
¢d_pcm_t
 *
pcm
);

1295 
¢d_pcm_mëî_add_sc›e
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sc›e_t
 *
sc›e
);

1296 
¢d_pcm_sc›e_t
 *
¢d_pcm_mëî_£¨ch_sc›e
(
¢d_pcm_t
 *
pcm
, c⁄° *
«me
);

1297 
¢d_pcm_sc›e_mÆloc
(
¢d_pcm_sc›e_t
 **
±r
);

1298 
¢d_pcm_sc›e_£t_›s
(
¢d_pcm_sc›e_t
 *
sc›e
,

1299 c⁄° 
¢d_pcm_sc›e_›s_t
 *
vÆ
);

1300 
¢d_pcm_sc›e_£t_«me
(
¢d_pcm_sc›e_t
 *
sc›e
, c⁄° *
vÆ
);

1301 c⁄° *
¢d_pcm_sc›e_gë_«me
(
¢d_pcm_sc›e_t
 *
sc›e
);

1302 *
¢d_pcm_sc›e_gë_ˇŒback_¥iv©e
(
¢d_pcm_sc›e_t
 *
sc›e
);

1303 
¢d_pcm_sc›e_£t_ˇŒback_¥iv©e
(
¢d_pcm_sc›e_t
 *
sc›e
, *
vÆ
);

1304 
¢d_pcm_sc›e_s16_›í
(
¢d_pcm_t
 *
pcm
, c⁄° *
«me
,

1305 
¢d_pcm_sc›e_t
 **
sc›ï
);

1306 
öt16_t
 *
¢d_pcm_sc›e_s16_gë_ch™√l_buf„r
(
¢d_pcm_sc›e_t
 *
sc›e
,

1307 
ch™√l
);

1319 
	e_¢d_•cm_œãncy
 {

1322 
SND_SPCM_LATENCY_STANDARD
 = 0,

1325 
SND_SPCM_LATENCY_MEDIUM
,

1328 
SND_SPCM_LATENCY_REALTIME


1329 } 
	t¢d_•cm_œãncy_t
;

1332 
	e_¢d_•cm_xrun_ty≥
 {

1334 
SND_SPCM_XRUN_IGNORE
 = 0,

1336 
SND_SPCM_XRUN_STOP


1337 } 
	t¢d_•cm_xrun_ty≥_t
;

1340 
	e_¢d_•cm_du∂ex_ty≥
 {

1342 
SND_SPCM_DUPLEX_LIBERAL
 = 0,

1344 
SND_SPCM_DUPLEX_PEDANTIC


1345 } 
	t¢d_•cm_du∂ex_ty≥_t
;

1347 
¢d_•cm_öô
(
¢d_pcm_t
 *
pcm
,

1348 
øã
,

1349 
ch™√ls
,

1350 
¢d_pcm_f‹m©_t
 
f‹m©
,

1351 
¢d_pcm_subf‹m©_t
 
subf‹m©
,

1352 
¢d_•cm_œãncy_t
 
œãncy
,

1353 
¢d_pcm_ac˚ss_t
 
_ac˚ss
,

1354 
¢d_•cm_xrun_ty≥_t
 
xrun_ty≥
);

1356 
¢d_•cm_öô_du∂ex
(
¢d_pcm_t
 *
∂ayback_pcm
,

1357 
¢d_pcm_t
 *
ˇ±uª_pcm
,

1358 
øã
,

1359 
ch™√ls
,

1360 
¢d_pcm_f‹m©_t
 
f‹m©
,

1361 
¢d_pcm_subf‹m©_t
 
subf‹m©
,

1362 
¢d_•cm_œãncy_t
 
œãncy
,

1363 
¢d_pcm_ac˚ss_t
 
_ac˚ss
,

1364 
¢d_•cm_xrun_ty≥_t
 
xrun_ty≥
,

1365 
¢d_•cm_du∂ex_ty≥_t
 
du∂ex_ty≥
);

1367 
¢d_•cm_öô_gë_∑øms
(
¢d_pcm_t
 *
pcm
,

1368 *
øã
,

1369 
¢d_pcm_u‰ames_t
 *
buf„r_size
,

1370 
¢d_pcm_u‰ames_t
 *
≥riod_size
);

1382 c⁄° *
¢d_pcm_°¨t_mode_«me
(
¢d_pcm_°¨t_t
 
mode
Ë
__©åibuã__
((
dïªˇãd
));

1383 c⁄° *
¢d_pcm_xrun_mode_«me
(
¢d_pcm_xrun_t
 
mode
Ë
__©åibuã__
((
dïªˇãd
));

1384 
¢d_pcm_sw_∑øms_£t_°¨t_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_°¨t_t
 
vÆ
Ë
__©åibuã__
((
dïªˇãd
));

1385 
¢d_pcm_°¨t_t
 
¢d_pcm_sw_∑øms_gë_°¨t_mode
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
Ë
__©åibuã__
((
dïªˇãd
));

1386 
¢d_pcm_sw_∑øms_£t_xrun_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_xrun_t
 
vÆ
Ë
__©åibuã__
((
dïªˇãd
));

1387 
¢d_pcm_xrun_t
 
¢d_pcm_sw_∑øms_gë_xrun_mode
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
Ë
__©åibuã__
((
dïªˇãd
));

1388 #i‡!
deföed
(
ALSA_LIBRARY_BUILD
Ë&& !deföed(
ALSA_PCM_OLD_SW_PARAMS_API
)

1389 
¢d_pcm_sw_∑øms_£t_x„r_Æign
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
Ë
__©åibuã__
((
dïªˇãd
));

1390 
¢d_pcm_sw_∑øms_gë_x„r_Æign
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
Ë
__©åibuã__
((
dïªˇãd
));

1391 
¢d_pcm_sw_∑øms_£t_¶ìp_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
vÆ
Ë
__©åibuã__
((
dïªˇãd
));

1392 
¢d_pcm_sw_∑øms_gë_¶ìp_mö
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, *
vÆ
Ë
__©åibuã__
((
dïªˇãd
));

1394 #i‡!
deföed
(
ALSA_LIBRARY_BUILD
Ë&& !deföed(
ALSA_PCM_OLD_HW_PARAMS_API
)

1395 
¢d_pcm_hw_∑øms_gë_tick_time
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
Ë
__©åibuã__
((
dïªˇãd
));

1396 
¢d_pcm_hw_∑øms_gë_tick_time_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
Ë
__©åibuã__
((
dïªˇãd
));

1397 
¢d_pcm_hw_∑øms_gë_tick_time_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
Ë
__©åibuã__
((
dïªˇãd
));

1398 
¢d_pcm_hw_∑øms_ã°_tick_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
Ë
__©åibuã__
((
dïªˇãd
));

1399 
¢d_pcm_hw_∑øms_£t_tick_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
Ë
__©åibuã__
((
dïªˇãd
));

1400 
¢d_pcm_hw_∑øms_£t_tick_time_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
Ë
__©åibuã__
((
dïªˇãd
));

1401 
¢d_pcm_hw_∑øms_£t_tick_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
Ë
__©åibuã__
((
dïªˇãd
));

1402 
¢d_pcm_hw_∑øms_£t_tick_time_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
Ë
__©åibuã__
((
dïªˇãd
));

1403 
¢d_pcm_hw_∑øms_£t_tick_time_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
Ë
__©åibuã__
((
dïªˇãd
));

1404 
¢d_pcm_hw_∑øms_£t_tick_time_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
Ë
__©åibuã__
((
dïªˇãd
));

1405 
¢d_pcm_hw_∑øms_£t_tick_time_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
Ë
__©åibuã__
((
dïªˇãd
));

1410 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_external.h

26 #i‚de‡
__ALSA_PCM_EXTERNAL_H


27 
	#__ALSA_PCM_EXTERNAL_H


	)

29 
	~"pcm.h
"

31 #ifde‡
__˝lu•lus


43 
	#SND_PCM_PLUGIN_ENTRY
(
«me
Ë
_¢d_pcm_
##«me##
_›í


	)

48 
	#SND_PCM_PLUGIN_SYMBOL
(
«me
Ë
	`SND_DLSYM_BUILD_VERSION
(
	`SND_PCM_PLUGIN_ENTRY
“ame), 
SND_PCM_DLSYM_VERSION
);

	)

53 
	#SND_PCM_PLUGIN_DEFINE_FUNC
(
∂ugö
) \

54 
	`SND_PCM_PLUGIN_ENTRY
(
∂ugö
Ë(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,\

55 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
, \

56 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

	)

58 
	~"pcm_i›lug.h
"

59 
	~"pcm_exçlug.h
"

61 
¢d_pcm_∑r£_c⁄åﬁ_id
(
¢d_c⁄fig_t
 *
c⁄f
, 
¢d_˘l_ñem_id_t
 *
˘l_id
, *
ˇrdp
,

62 *
cch™√l•
, *
hw˘Õ
Ë
__©åibuã__
((
dïªˇãd
));

66 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_extplug.h

31 #i‚de‡
__ALSA_PCM_EXTPLUG_H


32 
	#__ALSA_PCM_EXTPLUG_H


	)

43 
	mSND_PCM_EXTPLUG_HW_FORMAT
,

44 
	mSND_PCM_EXTPLUG_HW_CHANNELS
,

45 
	mSND_PCM_EXTPLUG_HW_PARAMS


49 
¢d_pcm_exçlug
 
	t¢d_pcm_exçlug_t
;

51 
¢d_pcm_exçlug_ˇŒback
 
	t¢d_pcm_exçlug_ˇŒback_t
;

52 #ifde‡
DOC_HIDDEN


54 
¢d_pcm_exçlug
 
	t¢d_pcm_exçlug_t
;

55 
¢d_pcm_exçlug_ˇŒback
 
	t¢d_pcm_exçlug_ˇŒback_t
;

61 
	#SND_PCM_EXTPLUG_VERSION_MAJOR
 1

	)

62 
	#SND_PCM_EXTPLUG_VERSION_MINOR
 0

	)

63 
	#SND_PCM_EXTPLUG_VERSION_TINY
 2

	)

67 
	#SND_PCM_EXTPLUG_VERSION
 ((
SND_PCM_EXTPLUG_VERSION_MAJOR
<<16) |\

68 (
SND_PCM_EXTPLUG_VERSION_MINOR
<<8) |\

69 (
SND_PCM_EXTPLUG_VERSION_TINY
))

	)

72 
	s¢d_pcm_exçlug
 {

77 
	mvîsi⁄
;

81 c⁄° *
	m«me
;

85 c⁄° 
¢d_pcm_exçlug_ˇŒback_t
 *
	mˇŒback
;

89 *
	m¥iv©e_d©a
;

93 
¢d_pcm_t
 *
	mpcm
;

97 
¢d_pcm_°ªam_t
 
	m°ªam
;

101 
¢d_pcm_f‹m©_t
 
	mf‹m©
;

105 
¢d_pcm_subf‹m©_t
 
	msubf‹m©
;

109 
	mch™√ls
;

113 
	møã
;

117 
¢d_pcm_f‹m©_t
 
	m¶ave_f‹m©
;

121 
¢d_pcm_subf‹m©_t
 
	m¶ave_subf‹m©
;

125 
	m¶ave_ch™√ls
;

129 
	s¢d_pcm_exçlug_ˇŒback
 {

133 
¢d_pcm_s‰ames_t
 (*
å™s„r
)(
¢d_pcm_exçlug_t
 *
	mext
,

134 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
	md°_¨ós
,

135 
¢d_pcm_u‰ames_t
 
	md°_off£t
,

136 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
	m§c_¨ós
,

137 
¢d_pcm_u‰ames_t
 
	m§c_off£t
,

138 
¢d_pcm_u‰ames_t
 
	msize
);

142 (*
	m˛o£
)(
¢d_pcm_exçlug_t
 *
	mext
);

146 (*
	mhw_∑øms
)(
¢d_pcm_exçlug_t
 *
	mext
, 
¢d_pcm_hw_∑øms_t
 *
	m∑øms
);

150 (*
	mhw_‰ì
)(
¢d_pcm_exçlug_t
 *
	mext
);

154 (*
	mdump
)(
¢d_pcm_exçlug_t
 *
	mext
, 
¢d_ouçut_t
 *
	mout
);

158 (*
	möô
)(
¢d_pcm_exçlug_t
 *
	mext
);

162 
	m¢d_pcm_chm≠_quîy_t
 **(*
	mquîy_chm≠s
)(
¢d_pcm_exçlug_t
 *
	mext
);

166 
	m¢d_pcm_chm≠_t
 *(*
	mgë_chm≠
)(
¢d_pcm_exçlug_t
 *
	mext
);

170 (*
	m£t_chm≠
)(
¢d_pcm_exçlug_t
 *
	mext
, c⁄° 
¢d_pcm_chm≠_t
 *
	mm≠
);

174 
¢d_pcm_exçlug_¸óã
(
¢d_pcm_exçlug_t
 *
ext
, c⁄° *
«me
,

175 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
¶ave_c⁄f
,

176 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

177 
¢d_pcm_exçlug_dñëe
(
¢d_pcm_exçlug_t
 *
ext
);

180 
¢d_pcm_exçlug_∑øms_ª£t
(
¢d_pcm_exçlug_t
 *
ext
);

183 
¢d_pcm_exçlug_£t_∑øm_li°
(
¢d_pcm_exçlug_t
 *
exçlug
, 
ty≥
, 
num_li°
, c⁄° *
li°
);

184 
¢d_pcm_exçlug_£t_∑øm_mömax
(
¢d_pcm_exçlug_t
 *
exçlug
, 
ty≥
, 
mö
, 
max
);

185 
¢d_pcm_exçlug_£t_¶ave_∑øm_li°
(
¢d_pcm_exçlug_t
 *
exçlug
, 
ty≥
, 
num_li°
, c⁄° *
li°
);

186 
¢d_pcm_exçlug_£t_¶ave_∑øm_mömax
(
¢d_pcm_exçlug_t
 *
exçlug
, 
ty≥
, 
mö
, 
max
);

187 
¢d_pcm_exçlug_£t_∑øm_lök
(
¢d_pcm_exçlug_t
 *
exçlug
, 
ty≥
,

188 
kìp_lök
);

193 
__ölöe__
 
	$¢d_pcm_exçlug_£t_∑øm
(
¢d_pcm_exçlug_t
 *
exçlug
, 
ty≥
, 
vÆ
)

195  
	`¢d_pcm_exçlug_£t_∑øm_li°
(
exçlug
, 
ty≥
, 1, &
vÆ
);

196 
	}
}

201 
__ölöe__
 
	$¢d_pcm_exçlug_£t_¶ave_∑øm
(
¢d_pcm_exçlug_t
 *
exçlug
, 
ty≥
, 
vÆ
)

203  
	`¢d_pcm_exçlug_£t_¶ave_∑øm_li°
(
exçlug
, 
ty≥
, 1, &
vÆ
);

204 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_ioplug.h

31 #i‚de‡
__ALSA_PCM_IOPLUG_H


32 
	#__ALSA_PCM_IOPLUG_H


	)

43 
	mSND_PCM_IOPLUG_HW_ACCESS
 = 0,

44 
	mSND_PCM_IOPLUG_HW_FORMAT
,

45 
	mSND_PCM_IOPLUG_HW_CHANNELS
,

46 
	mSND_PCM_IOPLUG_HW_RATE
,

47 
	mSND_PCM_IOPLUG_HW_PERIOD_BYTES
,

48 
	mSND_PCM_IOPLUG_HW_BUFFER_BYTES
,

49 
	mSND_PCM_IOPLUG_HW_PERIODS
,

50 
	mSND_PCM_IOPLUG_HW_PARAMS


54 
¢d_pcm_i›lug
 
	t¢d_pcm_i›lug_t
;

56 
¢d_pcm_i›lug_ˇŒback
 
	t¢d_pcm_i›lug_ˇŒback_t
;

57 #ifde‡
DOC_HIDDEN


59 
¢d_pcm_i›lug
 
	t¢d_pcm_i›lug_t
;

60 
¢d_pcm_i›lug_ˇŒback
 
	t¢d_pcm_i›lug_ˇŒback_t
;

66 
	#SND_PCM_IOPLUG_FLAG_LISTED
 (1<<0Ë

	)

67 
	#SND_PCM_IOPLUG_FLAG_MONOTONIC
 (1<<1Ë

	)

69 
	#SND_PCM_IOPLUG_FLAG_BOUNDARY_WA
 (1<<2)

	)

74 
	#SND_PCM_IOPLUG_VERSION_MAJOR
 1

	)

75 
	#SND_PCM_IOPLUG_VERSION_MINOR
 0

	)

76 
	#SND_PCM_IOPLUG_VERSION_TINY
 2

	)

80 
	#SND_PCM_IOPLUG_VERSION
 ((
SND_PCM_IOPLUG_VERSION_MAJOR
<<16) |\

81 (
SND_PCM_IOPLUG_VERSION_MINOR
<<8) |\

82 (
SND_PCM_IOPLUG_VERSION_TINY
))

	)

85 
	s¢d_pcm_i›lug
 {

90 
	mvîsi⁄
;

94 c⁄° *
	m«me
;

95 
	mÊags
;

96 
	mpﬁl_fd
;

97 
	mpﬁl_evíts
;

98 
	mmm≠_rw
;

102 c⁄° 
¢d_pcm_i›lug_ˇŒback_t
 *
	mˇŒback
;

106 *
	m¥iv©e_d©a
;

110 
¢d_pcm_t
 *
	mpcm
;

112 
¢d_pcm_°ªam_t
 
	m°ªam
;

113 
¢d_pcm_°©e_t
 
	m°©e
;

114 vﬁ©ûê
¢d_pcm_u‰ames_t
 
	m≠∂_±r
;

115 vﬁ©ûê
¢d_pcm_u‰ames_t
 
	mhw_±r
;

116 
	mn⁄block
;

118 
¢d_pcm_ac˚ss_t
 
	mac˚ss
;

119 
¢d_pcm_f‹m©_t
 
	mf‹m©
;

120 
	mch™√ls
;

121 
	møã
;

122 
¢d_pcm_u‰ames_t
 
	m≥riod_size
;

123 
¢d_pcm_u‰ames_t
 
	mbuf„r_size
;

127 
	s¢d_pcm_i›lug_ˇŒback
 {

131 (*
	m°¨t
)(
¢d_pcm_i›lug_t
 *
	mio
);

135 (*
	m°›
)(
¢d_pcm_i›lug_t
 *
	mio
);

142 
¢d_pcm_s‰ames_t
 (*
poöãr
)(
¢d_pcm_i›lug_t
 *
	mio
);

146 
¢d_pcm_s‰ames_t
 (*
å™s„r
)(
¢d_pcm_i›lug_t
 *
	mio
,

147 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
	m¨ós
,

148 
¢d_pcm_u‰ames_t
 
	moff£t
,

149 
¢d_pcm_u‰ames_t
 
	msize
);

153 (*
	m˛o£
)(
¢d_pcm_i›lug_t
 *
	mio
);

157 (*
	mhw_∑øms
)(
¢d_pcm_i›lug_t
 *
	mio
, 
¢d_pcm_hw_∑øms_t
 *
	m∑øms
);

161 (*
	mhw_‰ì
)(
¢d_pcm_i›lug_t
 *
	mio
);

165 (*
	msw_∑øms
)(
¢d_pcm_i›lug_t
 *
	mio
, 
¢d_pcm_sw_∑øms_t
 *
	m∑øms
);

169 (*
	m¥ï¨e
)(
¢d_pcm_i›lug_t
 *
	mio
);

173 (*
	mdøö
)(
¢d_pcm_i›lug_t
 *
	mio
);

177 (*
	m∑u£
)(
¢d_pcm_i›lug_t
 *
	mio
, 
	míabÀ
);

181 (*
	mªsume
)(
¢d_pcm_i›lug_t
 *
	mio
);

185 (*
	mpﬁl_des¸ùt‹s_cou¡
)(
¢d_pcm_i›lug_t
 *
	mio
);

189 (*
	mpﬁl_des¸ùt‹s
)(
¢d_pcm_i›lug_t
 *
	mio
, 
pﬁlfd
 *
	mpfd
, 
	m•a˚
);

193 (*
	mpﬁl_ªvíts
)(
¢d_pcm_i›lug_t
 *
	mio
, 
pﬁlfd
 *
	mpfd
, 
	mnfds
, *
	mªvíts
);

197 (*
	mdump
)(
¢d_pcm_i›lug_t
 *
	mio
, 
¢d_ouçut_t
 *
	mout
);

201 (*
	mdñay
)(
¢d_pcm_i›lug_t
 *
	mio
, 
¢d_pcm_s‰ames_t
 *
	mdñayp
);

205 
	m¢d_pcm_chm≠_quîy_t
 **(*
	mquîy_chm≠s
)(
¢d_pcm_i›lug_t
 *
	mio
);

209 
	m¢d_pcm_chm≠_t
 *(*
	mgë_chm≠
)(
¢d_pcm_i›lug_t
 *
	mio
);

213 (*
	m£t_chm≠
)(
¢d_pcm_i›lug_t
 *
	mio
, c⁄° 
¢d_pcm_chm≠_t
 *
	mm≠
);

217 
¢d_pcm_i›lug_¸óã
(
¢d_pcm_i›lug_t
 *
io
, c⁄° *
«me
,

218 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

219 
¢d_pcm_i›lug_dñëe
(
¢d_pcm_i›lug_t
 *
io
);

222 
¢d_pcm_i›lug_ªöô_°©us
(
¢d_pcm_i›lug_t
 *
i›lug
);

225 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¢d_pcm_i›lug_mm≠_¨ós
(
¢d_pcm_i›lug_t
 *
i›lug
);

228 
¢d_pcm_i›lug_∑øms_ª£t
(
¢d_pcm_i›lug_t
 *
io
);

231 
¢d_pcm_i›lug_£t_∑øm_mömax
(
¢d_pcm_i›lug_t
 *
io
, 
ty≥
, 
mö
, 
max
);

232 
¢d_pcm_i›lug_£t_∑øm_li°
(
¢d_pcm_i›lug_t
 *
io
, 
ty≥
, 
num_li°
, c⁄° *
li°
);

235 
¢d_pcm_i›lug_£t_°©e
(
¢d_pcm_i›lug_t
 *
i›lug
, 
¢d_pcm_°©e_t
 
°©e
);

238 
¢d_pcm_u‰ames_t
 
¢d_pcm_i›lug_avaû
(c⁄° 
¢d_pcm_i›lug_t
 * c⁄° 
i›lug
,

239 c⁄° 
¢d_pcm_u‰ames_t
 
hw_±r
,

240 c⁄° 
¢d_pcm_u‰ames_t
 
≠∂_±r
);

241 
¢d_pcm_u‰ames_t
 
¢d_pcm_i›lug_hw_avaû
(c⁄° 
¢d_pcm_i›lug_t
 * c⁄° 
i›lug
,

242 c⁄° 
¢d_pcm_u‰ames_t
 
hw_±r
,

243 c⁄° 
¢d_pcm_u‰ames_t
 
≠∂_±r
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_old.h

5 
	#___symbﬁ_vîsi⁄
(
«me
, 
vîsi⁄
) \

6 
	`__asm__
 (".symvî " #«mê"," #«mê"@" 
vîsi⁄
)

	)

8 #ifde‡
ALSA_PCM_OLD_HW_PARAMS_API


10 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_ac˚ss
, "ALSA_0.9");

11 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_ac˚ss_fú°
, "ALSA_0.9");

12 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_ac˚ss_œ°
, "ALSA_0.9");

14 
¢d_pcm_hw_∑øms_gë_ac˚ss
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

15 
¢d_pcm_hw_∑øms_ã°_ac˚ss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 
vÆ
);

16 
¢d_pcm_hw_∑øms_£t_ac˚ss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 
vÆ
);

17 
¢d_pcm_ac˚ss_t
 
¢d_pcm_hw_∑øms_£t_ac˚ss_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

18 
¢d_pcm_ac˚ss_t
 
¢d_pcm_hw_∑øms_£t_ac˚ss_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

19 
¢d_pcm_hw_∑øms_£t_ac˚ss_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_mask_t
 *
mask
);

20 
¢d_pcm_hw_∑øms_gë_ac˚ss_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_mask_t
 *
mask
);

22 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_f‹m©
, "ALSA_0.9");

23 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_f‹m©_fú°
, "ALSA_0.9");

24 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_f‹m©_œ°
, "ALSA_0.9");

26 
¢d_pcm_hw_∑øms_gë_f‹m©
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

27 
¢d_pcm_hw_∑øms_ã°_f‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 
vÆ
);

28 
¢d_pcm_hw_∑øms_£t_f‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 
vÆ
);

29 
¢d_pcm_f‹m©_t
 
¢d_pcm_hw_∑øms_£t_f‹m©_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

30 
¢d_pcm_f‹m©_t
 
¢d_pcm_hw_∑øms_£t_f‹m©_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

31 
¢d_pcm_hw_∑øms_£t_f‹m©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_mask_t
 *
mask
);

32 
¢d_pcm_hw_∑øms_gë_f‹m©_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_mask_t
 *
mask
);

34 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_subf‹m©
, "ALSA_0.9");

35 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_subf‹m©_fú°
, "ALSA_0.9");

36 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_subf‹m©_œ°
, "ALSA_0.9");

38 
¢d_pcm_hw_∑øms_ã°_subf‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 
vÆ
);

39 
¢d_pcm_hw_∑øms_gë_subf‹m©
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

40 
¢d_pcm_hw_∑øms_£t_subf‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 
vÆ
);

41 
¢d_pcm_subf‹m©_t
 
¢d_pcm_hw_∑øms_£t_subf‹m©_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

42 
¢d_pcm_subf‹m©_t
 
¢d_pcm_hw_∑øms_£t_subf‹m©_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

43 
¢d_pcm_hw_∑øms_£t_subf‹m©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_mask_t
 *
mask
);

44 
¢d_pcm_hw_∑øms_gë_subf‹m©_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_mask_t
 *
mask
);

46 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_ch™√ls
, "ALSA_0.9");

47 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_ch™√ls_mö
, "ALSA_0.9");

48 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_ch™√ls_max
, "ALSA_0.9");

49 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_ch™√ls_√¨
, "ALSA_0.9");

50 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_ch™√ls_fú°
, "ALSA_0.9");

51 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_ch™√ls_œ°
, "ALSA_0.9");

53 
¢d_pcm_hw_∑øms_gë_ch™√ls
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

54 
¢d_pcm_hw_∑øms_gë_ch™√ls_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

55 
¢d_pcm_hw_∑øms_gë_ch™√ls_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

56 
¢d_pcm_hw_∑øms_ã°_ch™√ls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
);

57 
¢d_pcm_hw_∑øms_£t_ch™√ls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
);

58 
¢d_pcm_hw_∑øms_£t_ch™√ls_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

59 
¢d_pcm_hw_∑øms_£t_ch™√ls_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

60 
¢d_pcm_hw_∑øms_£t_ch™√ls_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
max
);

61 
¢d_pcm_hw_∑øms_£t_ch™√ls_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
);

62 
¢d_pcm_hw_∑øms_£t_ch™√ls_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

63 
¢d_pcm_hw_∑øms_£t_ch™√ls_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

65 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_øã
, "ALSA_0.9");

66 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_øã_mö
, "ALSA_0.9");

67 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_øã_max
, "ALSA_0.9");

68 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_øã_√¨
, "ALSA_0.9");

69 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_øã_fú°
, "ALSA_0.9");

70 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_øã_œ°
, "ALSA_0.9");

72 
¢d_pcm_hw_∑øms_gë_øã
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

73 
¢d_pcm_hw_∑øms_gë_øã_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

74 
¢d_pcm_hw_∑øms_gë_øã_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

75 
¢d_pcm_hw_∑øms_ã°_øã
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

76 
¢d_pcm_hw_∑øms_£t_øã
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

77 
¢d_pcm_hw_∑øms_£t_øã_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

78 
¢d_pcm_hw_∑øms_£t_øã_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

79 
¢d_pcm_hw_∑øms_£t_øã_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
);

80 
¢d_pcm_hw_∑øms_£t_øã_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, *
dú
);

81 
¢d_pcm_hw_∑øms_£t_øã_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

82 
¢d_pcm_hw_∑øms_£t_øã_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

83 
¢d_pcm_hw_∑øms_£t_øã_ªßm∂e
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
);

84 
¢d_pcm_hw_∑øms_gë_øã_ªßm∂e
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

86 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_≥riod_time
, "ALSA_0.9");

87 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_≥riod_time_mö
, "ALSA_0.9");

88 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_≥riod_time_max
, "ALSA_0.9");

89 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_≥riod_time_√¨
, "ALSA_0.9");

90 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_≥riod_time_fú°
, "ALSA_0.9");

91 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_≥riod_time_œ°
, "ALSA_0.9");

93 
¢d_pcm_hw_∑øms_gë_≥riod_time
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

94 
¢d_pcm_hw_∑øms_gë_≥riod_time_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

95 
¢d_pcm_hw_∑øms_gë_≥riod_time_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

96 
¢d_pcm_hw_∑øms_ã°_≥riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

97 
¢d_pcm_hw_∑øms_£t_≥riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

98 
¢d_pcm_hw_∑øms_£t_≥riod_time_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

99 
¢d_pcm_hw_∑øms_£t_≥riod_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

100 
¢d_pcm_hw_∑øms_£t_≥riod_time_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
);

101 
¢d_pcm_hw_∑øms_£t_≥riod_time_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, *
dú
);

102 
¢d_pcm_hw_∑øms_£t_≥riod_time_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

103 
¢d_pcm_hw_∑øms_£t_≥riod_time_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

105 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_≥riod_size
, "ALSA_0.9");

106 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_≥riod_size_mö
, "ALSA_0.9");

107 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_≥riod_size_max
, "ALSA_0.9");

108 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_≥riod_size_√¨
, "ALSA_0.9");

109 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_≥riod_size_fú°
, "ALSA_0.9");

110 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_≥riod_size_œ°
, "ALSA_0.9");

112 
¢d_pcm_s‰ames_t
 
¢d_pcm_hw_∑øms_gë_≥riod_size
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

113 
¢d_pcm_u‰ames_t
 
¢d_pcm_hw_∑øms_gë_≥riod_size_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

114 
¢d_pcm_u‰ames_t
 
¢d_pcm_hw_∑øms_gë_≥riod_size_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

115 
¢d_pcm_hw_∑øms_ã°_≥riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
, 
dú
);

116 
¢d_pcm_hw_∑øms_£t_≥riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
, 
dú
);

117 
¢d_pcm_hw_∑øms_£t_≥riod_size_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
);

118 
¢d_pcm_hw_∑øms_£t_≥riod_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
);

119 
¢d_pcm_hw_∑øms_£t_≥riod_size_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
mö
, *
mödú
, snd_pcm_u‰ames_à*
max
, *
maxdú
);

120 
¢d_pcm_u‰ames_t
 
¢d_pcm_hw_∑øms_£t_≥riod_size_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, snd_pcm_u‰ames_à
vÆ
, *
dú
);

121 
¢d_pcm_u‰ames_t
 
¢d_pcm_hw_∑øms_£t_≥riod_size_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

122 
¢d_pcm_u‰ames_t
 
¢d_pcm_hw_∑øms_£t_≥riod_size_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

123 
¢d_pcm_hw_∑øms_£t_≥riod_size_öãgî
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

125 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_≥riods
, "ALSA_0.9");

126 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_≥riods_mö
, "ALSA_0.9");

127 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_≥riods_max
, "ALSA_0.9");

128 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_≥riods_√¨
, "ALSA_0.9");

129 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_≥riods_fú°
, "ALSA_0.9");

130 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_≥riods_œ°
, "ALSA_0.9");

132 
¢d_pcm_hw_∑øms_gë_≥riods
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

133 
¢d_pcm_hw_∑øms_gë_≥riods_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

134 
¢d_pcm_hw_∑øms_gë_≥riods_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

135 
¢d_pcm_hw_∑øms_ã°_≥riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

136 
¢d_pcm_hw_∑øms_£t_≥riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

137 
¢d_pcm_hw_∑øms_£t_≥riods_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

138 
¢d_pcm_hw_∑øms_£t_≥riods_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

139 
¢d_pcm_hw_∑øms_£t_≥riods_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
);

140 
¢d_pcm_hw_∑øms_£t_≥riods_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, *
dú
);

141 
¢d_pcm_hw_∑øms_£t_≥riods_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

142 
¢d_pcm_hw_∑øms_£t_≥riods_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

143 
¢d_pcm_hw_∑øms_£t_≥riods_öãgî
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

145 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_buf„r_time
, "ALSA_0.9");

146 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_buf„r_time_mö
, "ALSA_0.9");

147 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_buf„r_time_max
, "ALSA_0.9");

148 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_buf„r_time_√¨
, "ALSA_0.9");

149 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_buf„r_time_fú°
, "ALSA_0.9");

150 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_buf„r_time_œ°
, "ALSA_0.9");

152 
¢d_pcm_hw_∑øms_gë_buf„r_time
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

153 
¢d_pcm_hw_∑øms_gë_buf„r_time_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

154 
¢d_pcm_hw_∑øms_gë_buf„r_time_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

155 
¢d_pcm_hw_∑øms_ã°_buf„r_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

156 
¢d_pcm_hw_∑øms_£t_buf„r_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

157 
¢d_pcm_hw_∑øms_£t_buf„r_time_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

158 
¢d_pcm_hw_∑øms_£t_buf„r_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

159 
¢d_pcm_hw_∑øms_£t_buf„r_time_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
);

160 
¢d_pcm_hw_∑øms_£t_buf„r_time_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, *
dú
);

161 
¢d_pcm_hw_∑øms_£t_buf„r_time_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

162 
¢d_pcm_hw_∑øms_£t_buf„r_time_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

164 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_buf„r_size
, "ALSA_0.9");

165 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_buf„r_size_mö
, "ALSA_0.9");

166 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_buf„r_size_max
, "ALSA_0.9");

167 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_buf„r_size_√¨
, "ALSA_0.9");

168 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_buf„r_size_fú°
, "ALSA_0.9");

169 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_buf„r_size_œ°
, "ALSA_0.9");

171 
¢d_pcm_s‰ames_t
 
¢d_pcm_hw_∑øms_gë_buf„r_size
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

172 
¢d_pcm_u‰ames_t
 
¢d_pcm_hw_∑øms_gë_buf„r_size_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

173 
¢d_pcm_u‰ames_t
 
¢d_pcm_hw_∑øms_gë_buf„r_size_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

174 
¢d_pcm_hw_∑øms_ã°_buf„r_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

175 
¢d_pcm_hw_∑øms_£t_buf„r_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

176 
¢d_pcm_hw_∑øms_£t_buf„r_size_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

177 
¢d_pcm_hw_∑øms_£t_buf„r_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

178 
¢d_pcm_hw_∑øms_£t_buf„r_size_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
mö
, snd_pcm_u‰ames_à*
max
);

179 
¢d_pcm_u‰ames_t
 
¢d_pcm_hw_∑øms_£t_buf„r_size_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, snd_pcm_u‰ames_à
vÆ
);

180 
¢d_pcm_u‰ames_t
 
¢d_pcm_hw_∑øms_£t_buf„r_size_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

181 
¢d_pcm_u‰ames_t
 
¢d_pcm_hw_∑øms_£t_buf„r_size_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

183 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_tick_time
, "ALSA_0.9");

184 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_tick_time_mö
, "ALSA_0.9");

185 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_gë_tick_time_max
, "ALSA_0.9");

186 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_tick_time_√¨
, "ALSA_0.9");

187 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_tick_time_fú°
, "ALSA_0.9");

188 
___symbﬁ_vîsi⁄
(
¢d_pcm_hw_∑øms_£t_tick_time_œ°
, "ALSA_0.9");

190 
¢d_pcm_hw_∑øms_gë_tick_time
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

191 
¢d_pcm_hw_∑øms_gë_tick_time_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

192 
¢d_pcm_hw_∑øms_gë_tick_time_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

193 
¢d_pcm_hw_∑øms_ã°_tick_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

194 
¢d_pcm_hw_∑øms_£t_tick_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

195 
¢d_pcm_hw_∑øms_£t_tick_time_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

196 
¢d_pcm_hw_∑øms_£t_tick_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

197 
¢d_pcm_hw_∑øms_£t_tick_time_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
);

198 
¢d_pcm_hw_∑øms_£t_tick_time_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, *
dú
);

199 
¢d_pcm_hw_∑øms_£t_tick_time_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

200 
¢d_pcm_hw_∑øms_£t_tick_time_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
);

205 #ifde‡
ALSA_PCM_OLD_SW_PARAMS_API


207 
___symbﬁ_vîsi⁄
(
¢d_pcm_sw_∑øms_gë_t°amp_mode
, "ALSA_0.9");

208 
___symbﬁ_vîsi⁄
(
¢d_pcm_sw_∑øms_gë_¶ìp_mö
, "ALSA_0.9");

209 
___symbﬁ_vîsi⁄
(
¢d_pcm_sw_∑øms_gë_avaû_mö
, "ALSA_0.9");

210 
___symbﬁ_vîsi⁄
(
¢d_pcm_sw_∑øms_gë_x„r_Æign
, "ALSA_0.9");

211 
___symbﬁ_vîsi⁄
(
¢d_pcm_sw_∑øms_gë_°¨t_thªshﬁd
, "ALSA_0.9");

212 
___symbﬁ_vîsi⁄
(
¢d_pcm_sw_∑øms_gë_°›_thªshﬁd
, "ALSA_0.9");

213 
___symbﬁ_vîsi⁄
(
¢d_pcm_sw_∑øms_gë_sûí˚_thªshﬁd
, "ALSA_0.9");

214 
___symbﬁ_vîsi⁄
(
¢d_pcm_sw_∑øms_gë_sûí˚_size
, "ALSA_0.9");

216 
¢d_pcm_sw_∑øms_£t_t°amp_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_t°amp_t
 
vÆ
);

217 
¢d_pcm_t°amp_t
 
¢d_pcm_sw_∑øms_gë_t°amp_mode
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
);

218 
¢d_pcm_sw_∑øms_£t_¶ìp_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
vÆ
);

219 
¢d_pcm_sw_∑øms_gë_¶ìp_mö
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
);

220 
¢d_pcm_sw_∑øms_£t_avaû_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

221 
¢d_pcm_u‰ames_t
 
¢d_pcm_sw_∑øms_gë_avaû_mö
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
);

222 
¢d_pcm_sw_∑øms_£t_x„r_Æign
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

223 
¢d_pcm_u‰ames_t
 
¢d_pcm_sw_∑øms_gë_x„r_Æign
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
);

224 
¢d_pcm_sw_∑øms_£t_°¨t_thªshﬁd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

225 
¢d_pcm_u‰ames_t
 
¢d_pcm_sw_∑øms_gë_°¨t_thªshﬁd
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
);

226 
¢d_pcm_sw_∑øms_£t_°›_thªshﬁd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

227 
¢d_pcm_u‰ames_t
 
¢d_pcm_sw_∑øms_gë_°›_thªshﬁd
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
);

228 
¢d_pcm_sw_∑øms_£t_sûí˚_thªshﬁd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

229 
¢d_pcm_u‰ames_t
 
¢d_pcm_sw_∑øms_gë_sûí˚_thªshﬁd
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
);

230 
¢d_pcm_sw_∑øms_£t_sûí˚_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

231 
¢d_pcm_u‰ames_t
 
¢d_pcm_sw_∑øms_gë_sûí˚_size
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_plugin.h

32 #i‚de‡
__ALSA_PCM_PLUGIN_H


33 
	#__ALSA_PCM_PLUGIN_H


	)

42 
	#SND_PCM_PLUGIN_RATE_MIN
 4000

	)

43 
	#SND_PCM_PLUGIN_RATE_MAX
 768000

	)

46 #ifde‡
HAVE_SOFT_FLOAT


47 
	#SND_PCM_PLUGIN_ROUTE_FLOAT
 0

	)

49 
	#SND_PCM_PLUGIN_ROUTE_FLOAT
 1

	)

52 
	#SND_PCM_PLUGIN_ROUTE_RESOLUTION
 16

	)

54 #i‡
SND_PCM_PLUGIN_ROUTE_FLOAT


56 
	t¢d_pcm_rouã_âabÀ_íåy_t
;

57 
	#SND_PCM_PLUGIN_ROUTE_HALF
 0.5

	)

58 
	#SND_PCM_PLUGIN_ROUTE_FULL
 1.0

	)

61 
	t¢d_pcm_rouã_âabÀ_íåy_t
;

62 
	#SND_PCM_PLUGIN_ROUTE_HALF
 (
SND_PCM_PLUGIN_ROUTE_RESOLUTION
 / 2Ë

	)

63 
	#SND_PCM_PLUGIN_ROUTE_FULL
 
SND_PCM_PLUGIN_ROUTE_RESOLUTION


	)

69 
¢d_pcm_hw_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

70 
ˇrd
, 
devi˚
, 
subdevi˚
,

71 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
,

72 
mm≠_emuœti⁄
, 
sync_±r_io˘l
);

73 
_¢d_pcm_hw_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

74 
¢d_c⁄fig_t
 *
roŸ
 
ATTRIBUTE_UNUSED
, snd_c⁄fig_à*
c⁄f
,

75 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

80 
¢d_pcm_c›y_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

81 
¢d_pcm_t
 *
¶ave
, 
˛o£_¶ave
);

82 
_¢d_pcm_c›y_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

83 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

84 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

89 
¢d_pcm_löór_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

90 
¢d_pcm_f‹m©_t
 
sf‹m©
, 
¢d_pcm_t
 *
¶ave
,

91 
˛o£_¶ave
);

92 
_¢d_pcm_löór_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

93 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

94 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

99 
¢d_pcm_lÊﬂt_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

100 
¢d_pcm_f‹m©_t
 
sf‹m©
, 
¢d_pcm_t
 *
¶ave
,

101 
˛o£_¶ave
);

102 
_¢d_pcm_lÊﬂt_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

103 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

104 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

109 
¢d_pcm_muœw_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

110 
¢d_pcm_f‹m©_t
 
sf‹m©
, 
¢d_pcm_t
 *
¶ave
,

111 
˛o£_¶ave
);

112 
_¢d_pcm_muœw_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

113 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

114 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

119 
¢d_pcm_Æaw_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

120 
¢d_pcm_f‹m©_t
 
sf‹m©
, 
¢d_pcm_t
 *
¶ave
,

121 
˛o£_¶ave
);

122 
_¢d_pcm_Æaw_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

123 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

124 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

129 
¢d_pcm_adpcm_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

130 
¢d_pcm_f‹m©_t
 
sf‹m©
, 
¢d_pcm_t
 *
¶ave
,

131 
˛o£_¶ave
);

132 
_¢d_pcm_adpcm_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

133 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

134 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

139 
¢d_pcm_õc958_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

140 
¢d_pcm_f‹m©_t
 
sf‹m©
, 
¢d_pcm_t
 *
¶ave
,

141 
˛o£_¶ave
,

142 c⁄° *
°©us_bôs
,

143 c⁄° *
¥ómbÀ_vÆs
,

144 
hdmi_mode
);

145 
_¢d_pcm_õc958_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

146 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

147 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

152 
¢d_pcm_rouã_lﬂd_âabÀ
(
¢d_c⁄fig_t
 *
â
, 
¢d_pcm_rouã_âabÀ_íåy_t
 *
âabÀ
,

153 
â_csize
, 
â_ssize
,

154 *
â_cu£d
, *
â_su£d
,

155 
sch™√ls
);

156 
¢d_pcm_rouã_dëîmöe_âabÀ
(
¢d_c⁄fig_t
 *
â
,

157 *
â_csize
,

158 *
â_ssize
);

159 
¢d_pcm_rouã_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

160 
¢d_pcm_f‹m©_t
 
sf‹m©
, 
sch™√ls
,

161 
¢d_pcm_rouã_âabÀ_íåy_t
 *
âabÀ
,

162 
â_ssize
,

163 
â_cu£d
, 
â_su£d
,

164 
¢d_pcm_t
 *
¶ave
, 
˛o£_¶ave
);

165 
_¢d_pcm_rouã_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

166 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

167 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

172 
¢d_pcm_øã_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

173 
¢d_pcm_f‹m©_t
 
sf‹m©
, 
§©e
,

174 c⁄° 
¢d_c⁄fig_t
 *
c⁄vîãr
,

175 
¢d_pcm_t
 *
¶ave
, 
˛o£_¶ave
);

176 
_¢d_pcm_øã_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

177 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

178 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

183 
¢d_pcm_hooks_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

184 
¢d_pcm_t
 *
¶ave
, 
˛o£_¶ave
);

185 
_¢d_pcm_hooks_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

186 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

187 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

192 
¢d_pcm_œd•a_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

193 c⁄° *
œd•a_∑th
,

194 
ch™√ls
,

195 
¢d_c⁄fig_t
 *
œd•a_µlugös
,

196 
¢d_c⁄fig_t
 *
œd•a_˝lugös
,

197 
¢d_pcm_t
 *
¶ave
, 
˛o£_¶ave
);

198 
_¢d_pcm_œd•a_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

199 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

200 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

205 
¢d_pcm_jack_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

206 
¢d_c⁄fig_t
 *
∂ayback_c⁄f
,

207 
¢d_c⁄fig_t
 *
ˇ±uª_c⁄f
,

208 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

209 
_¢d_pcm_jack_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

210 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

211 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_rate.h

31 #i‚de‡
__ALSA_PCM_RATE_H


32 
	#__ALSA_PCM_RATE_H


	)

34 #ifde‡
__˝lu•lus


41 
	#SND_PCM_RATE_PLUGIN_VERSION
 0x010003

	)

44 
	s¢d_pcm_øã_side_öfo
 {

45 
¢d_pcm_f‹m©_t
 
f‹m©
;

46 
øã
;

47 
¢d_pcm_u‰ames_t
 
buf„r_size
;

48 
¢d_pcm_u‰ames_t
 
≥riod_size
;

49 } 
	t¢d_pcm_øã_side_öfo_t
;

52 
	s¢d_pcm_øã_öfo
 {

53 
¢d_pcm_øã_side_öfo
 
ö
;

54 
¢d_pcm_øã_side_öfo
 
out
;

55 
ch™√ls
;

56 } 
	t¢d_pcm_øã_öfo_t
;

59 
SND_PCM_RATE_FLAG_INTERLEAVED
 = (1U << 0),

60 
SND_PCM_RATE_FLAG_SYNC_FORMATS
 = (1U << 1),

64 
	s¢d_pcm_øã_›s
 {

68 (*
˛o£
)(*
obj
);

72 (*
öô
)(*
obj
, 
¢d_pcm_øã_öfo_t
 *
öfo
);

76 (*
‰ì
)(*
obj
);

80 (*
ª£t
)(*
obj
);

84 (*
adju°_pôch
)(*
obj
, 
¢d_pcm_øã_öfo_t
 *
öfo
);

88 (*
c⁄vît
)(*
obj
,

89 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

90 
¢d_pcm_u‰ames_t
 
d°_off£t
, 
d°_‰ames
,

91 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

92 
¢d_pcm_u‰ames_t
 
§c_off£t
, 
§c_‰ames
);

96 (*
c⁄vît_s16
)(*
obj
, 
öt16_t
 *
d°
, 
d°_‰ames
,

97 c⁄° 
öt16_t
 *
§c
, 
§c_‰ames
);

101 
¢d_pcm_u‰ames_t
 (*
öput_‰ames
)(*
obj
, snd_pcm_u‰ames_à
‰ames
);

105 
¢d_pcm_u‰ames_t
 (*
ouçut_‰ames
)(*
obj
, snd_pcm_u‰ames_à
‰ames
);

110 
vîsi⁄
;

115 (*
gë_suµ‹ãd_øãs
)(*
obj
, *
øã_mö
,

116 *
øã_max
);

121 (*
dump
)(*
obj
, 
¢d_ouçut_t
 *
out
);

126 (*
gë_suµ‹ãd_f‹m©s
)(*
obj
, 
uöt64_t
 *
ö_f‹m©s
,

127 
uöt64_t
 *
out_f‹m©s
,

128 *
Êags
);

129 } 
	t¢d_pcm_øã_›s_t
;

132 (*
¢d_pcm_øã_›í_func_t
)(
	tvîsi⁄
, **
	tobjp
,

133 
	t¢d_pcm_øã_›s_t
 *
	t›•
);

135 (*
¢d_pcm_øã_›í_c⁄f_func_t
)(
	tvîsi⁄
, **
	tobjp
,

136 
	t¢d_pcm_øã_›s_t
 *
	t›•
, c⁄° 
	t¢d_c⁄fig_t
 *
	tc⁄f
);

141 
	#SND_PCM_RATE_PLUGIN_ENTRY
(
«me
Ë
_¢d_pcm_øã_
##«me##
_›í


	)

142 
	#SND_PCM_RATE_PLUGIN_CONF_ENTRY
(
«me
Ë
_¢d_pcm_øã_
##«me##
_›í_c⁄f


	)

144 #i‚de‡
DOC_HIDDEN


146 
	s¢d_pcm_øã_ﬁd_›s
 {

147 (*
˛o£
)(*
obj
);

148 (*
öô
)(*
obj
, 
¢d_pcm_øã_öfo_t
 *
öfo
);

149 (*
‰ì
)(*
obj
);

150 (*
ª£t
)(*
obj
);

151 (*
adju°_pôch
)(*
obj
, 
¢d_pcm_øã_öfo_t
 *
öfo
);

152 (*
c⁄vît
)(*
obj
,

153 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

154 
¢d_pcm_u‰ames_t
 
d°_off£t
, 
d°_‰ames
,

155 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

156 
¢d_pcm_u‰ames_t
 
§c_off£t
, 
§c_‰ames
);

157 (*
c⁄vît_s16
)(*
obj
, 
öt16_t
 *
d°
, 
d°_‰ames
,

158 c⁄° 
öt16_t
 *
§c
, 
§c_‰ames
);

159 
¢d_pcm_u‰ames_t
 (*
öput_‰ames
)(*
obj
, snd_pcm_u‰ames_à
‰ames
);

160 
¢d_pcm_u‰ames_t
 (*
ouçut_‰ames
)(*
obj
, snd_pcm_u‰ames_à
‰ames
);

161 } 
	t¢d_pcm_øã_ﬁd_›s_t
;

164 
	s¢d_pcm_øã_v2_›s
 {

165 (*
˛o£
)(*
obj
);

166 (*
öô
)(*
obj
, 
¢d_pcm_øã_öfo_t
 *
öfo
);

167 (*
‰ì
)(*
obj
);

168 (*
ª£t
)(*
obj
);

169 (*
adju°_pôch
)(*
obj
, 
¢d_pcm_øã_öfo_t
 *
öfo
);

170 (*
c⁄vît
)(*
obj
,

171 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

172 
¢d_pcm_u‰ames_t
 
d°_off£t
, 
d°_‰ames
,

173 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

174 
¢d_pcm_u‰ames_t
 
§c_off£t
, 
§c_‰ames
);

175 (*
c⁄vît_s16
)(*
obj
, 
öt16_t
 *
d°
, 
d°_‰ames
,

176 c⁄° 
öt16_t
 *
§c
, 
§c_‰ames
);

177 
¢d_pcm_u‰ames_t
 (*
öput_‰ames
)(*
obj
, snd_pcm_u‰ames_à
‰ames
);

178 
¢d_pcm_u‰ames_t
 (*
ouçut_‰ames
)(*
obj
, snd_pcm_u‰ames_à
‰ames
);

179 
vîsi⁄
;

180 (*
gë_suµ‹ãd_øãs
)(*
obj
, *
øã_mö
,

181 *
øã_max
);

182 (*
dump
)(*
obj
, 
¢d_ouçut_t
 *
out
);

183 } 
	t¢d_pcm_øã_v2_›s_t
;

186 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/rawmidi.h

28 #i‚de‡
__ALSA_RAWMIDI_H


29 
	#__ALSA_RAWMIDI_H


	)

31 #ifde‡
__˝lu•lus


42 
	#SND_RAWMIDI_DLSYM_VERSION
 
_dlsym_øwmidi_001


	)

45 
_¢d_øwmidi_öfo
 
	t¢d_øwmidi_öfo_t
;

47 
_¢d_øwmidi_∑øms
 
	t¢d_øwmidi_∑øms_t
;

49 
_¢d_øwmidi_°©us
 
	t¢d_øwmidi_°©us_t
;

52 
	e_¢d_øwmidi_°ªam
 {

54 
SND_RAWMIDI_STREAM_OUTPUT
 = 0,

56 
SND_RAWMIDI_STREAM_INPUT
,

57 
SND_RAWMIDI_STREAM_LAST
 = 
SND_RAWMIDI_STREAM_INPUT


58 } 
	t¢d_øwmidi_°ªam_t
;

61 
	#SND_RAWMIDI_APPEND
 0x0001

	)

63 
	#SND_RAWMIDI_NONBLOCK
 0x0002

	)

65 
	#SND_RAWMIDI_SYNC
 0x0004

	)

68 
_¢d_øwmidi
 
	t¢d_øwmidi_t
;

71 
	e_¢d_øwmidi_ty≥
 {

73 
SND_RAWMIDI_TYPE_HW
,

75 
SND_RAWMIDI_TYPE_SHM
,

77 
SND_RAWMIDI_TYPE_INET
,

79 
SND_RAWMIDI_TYPE_VIRTUAL


80 } 
	t¢d_øwmidi_ty≥_t
;

83 
	e_¢d_øwmidi_˛ock
 {

84 
SND_RAWMIDI_CLOCK_NONE
 = 0,

85 
SND_RAWMIDI_CLOCK_REALTIME
 = 1,

86 
SND_RAWMIDI_CLOCK_MONOTONIC
 = 2,

87 
SND_RAWMIDI_CLOCK_MONOTONIC_RAW
 = 3,

88 } 
	t¢d_øwmidi_˛ock_t
;

91 
	e_¢d_øwmidi_ªad_mode
 {

92 
SND_RAWMIDI_READ_STANDARD
 = 0,

93 
SND_RAWMIDI_READ_TSTAMP
 = 1,

94 } 
	t¢d_øwmidi_ªad_mode_t
;

97 
	#SND_RAWMIDI_INFO_UMP
 0x00000008

	)

99 
¢d_øwmidi_›í
(
¢d_øwmidi_t
 **
ö_rmidi
, snd_øwmidi_à**
out_rmidi
,

100 c⁄° *
«me
, 
mode
);

101 
¢d_øwmidi_›í_lc⁄f
(
¢d_øwmidi_t
 **
ö_rmidi
, snd_øwmidi_à**
out_rmidi
,

102 c⁄° *
«me
, 
mode
, 
¢d_c⁄fig_t
 *
lc⁄f
);

103 
¢d_øwmidi_˛o£
(
¢d_øwmidi_t
 *
rmidi
);

104 
¢d_øwmidi_pﬁl_des¸ùt‹s_cou¡
(
¢d_øwmidi_t
 *
rmidi
);

105 
¢d_øwmidi_pﬁl_des¸ùt‹s
(
¢d_øwmidi_t
 *
rmidi
, 
pﬁlfd
 *
pfds
, 
•a˚
);

106 
¢d_øwmidi_pﬁl_des¸ùt‹s_ªvíts
(
¢d_øwmidi_t
 *
øwmidi
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvít
);

107 
¢d_øwmidi_n⁄block
(
¢d_øwmidi_t
 *
rmidi
, 
n⁄block
);

108 
size_t
 
¢d_øwmidi_öfo_sizeof
();

113 
	#¢d_øwmidi_öfo_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_øwmidi_öfo
)

	)

114 
¢d_øwmidi_öfo_mÆloc
(
¢d_øwmidi_öfo_t
 **
±r
);

115 
¢d_øwmidi_öfo_‰ì
(
¢d_øwmidi_öfo_t
 *
obj
);

116 
¢d_øwmidi_öfo_c›y
(
¢d_øwmidi_öfo_t
 *
d°
, c⁄° snd_øwmidi_öfo_à*
§c
);

117 
¢d_øwmidi_öfo_gë_devi˚
(c⁄° 
¢d_øwmidi_öfo_t
 *
obj
);

118 
¢d_øwmidi_öfo_gë_subdevi˚
(c⁄° 
¢d_øwmidi_öfo_t
 *
obj
);

119 
¢d_øwmidi_°ªam_t
 
¢d_øwmidi_öfo_gë_°ªam
(c⁄° 
¢d_øwmidi_öfo_t
 *
obj
);

120 
¢d_øwmidi_öfo_gë_ˇrd
(c⁄° 
¢d_øwmidi_öfo_t
 *
obj
);

121 
¢d_øwmidi_öfo_gë_Êags
(c⁄° 
¢d_øwmidi_öfo_t
 *
obj
);

122 c⁄° *
¢d_øwmidi_öfo_gë_id
(c⁄° 
¢d_øwmidi_öfo_t
 *
obj
);

123 c⁄° *
¢d_øwmidi_öfo_gë_«me
(c⁄° 
¢d_øwmidi_öfo_t
 *
obj
);

124 c⁄° *
¢d_øwmidi_öfo_gë_subdevi˚_«me
(c⁄° 
¢d_øwmidi_öfo_t
 *
obj
);

125 
¢d_øwmidi_öfo_gë_subdevi˚s_cou¡
(c⁄° 
¢d_øwmidi_öfo_t
 *
obj
);

126 
¢d_øwmidi_öfo_gë_subdevi˚s_avaû
(c⁄° 
¢d_øwmidi_öfo_t
 *
obj
);

127 
¢d_øwmidi_öfo_£t_devi˚
(
¢d_øwmidi_öfo_t
 *
obj
, 
vÆ
);

128 
¢d_øwmidi_öfo_£t_subdevi˚
(
¢d_øwmidi_öfo_t
 *
obj
, 
vÆ
);

129 
¢d_øwmidi_öfo_£t_°ªam
(
¢d_øwmidi_öfo_t
 *
obj
, 
¢d_øwmidi_°ªam_t
 
vÆ
);

130 
¢d_øwmidi_öfo
(
¢d_øwmidi_t
 *
rmidi
, 
¢d_øwmidi_öfo_t
 * 
öfo
);

131 
size_t
 
¢d_øwmidi_∑øms_sizeof
();

136 
	#¢d_øwmidi_∑øms_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_øwmidi_∑øms
)

	)

137 
¢d_øwmidi_∑øms_mÆloc
(
¢d_øwmidi_∑øms_t
 **
±r
);

138 
¢d_øwmidi_∑øms_‰ì
(
¢d_øwmidi_∑øms_t
 *
obj
);

139 
¢d_øwmidi_∑øms_c›y
(
¢d_øwmidi_∑øms_t
 *
d°
, c⁄° snd_øwmidi_∑øms_à*
§c
);

140 
¢d_øwmidi_∑øms_£t_buf„r_size
(
¢d_øwmidi_t
 *
rmidi
, 
¢d_øwmidi_∑øms_t
 *
∑øms
, 
size_t
 
vÆ
);

141 
size_t
 
¢d_øwmidi_∑øms_gë_buf„r_size
(c⁄° 
¢d_øwmidi_∑øms_t
 *
∑øms
);

142 
¢d_øwmidi_∑øms_£t_avaû_mö
(
¢d_øwmidi_t
 *
rmidi
, 
¢d_øwmidi_∑øms_t
 *
∑øms
, 
size_t
 
vÆ
);

143 
size_t
 
¢d_øwmidi_∑øms_gë_avaû_mö
(c⁄° 
¢d_øwmidi_∑øms_t
 *
∑øms
);

144 
¢d_øwmidi_∑øms_£t_no_a˘ive_£nsög
(
¢d_øwmidi_t
 *
rmidi
, 
¢d_øwmidi_∑øms_t
 *
∑øms
, 
vÆ
);

145 
¢d_øwmidi_∑øms_gë_no_a˘ive_£nsög
(c⁄° 
¢d_øwmidi_∑øms_t
 *
∑øms
);

146 
¢d_øwmidi_∑øms_£t_ªad_mode
(c⁄° 
¢d_øwmidi_t
 *
øwmidi
, 
¢d_øwmidi_∑øms_t
 *
∑øms
, 
¢d_øwmidi_ªad_mode_t
 
vÆ
);

147 
¢d_øwmidi_ªad_mode_t
 
¢d_øwmidi_∑øms_gë_ªad_mode
(c⁄° 
¢d_øwmidi_∑øms_t
 *
∑øms
);

148 
¢d_øwmidi_∑øms_£t_˛ock_ty≥
(c⁄° 
¢d_øwmidi_t
 *
øwmidi
, 
¢d_øwmidi_∑øms_t
 *
∑øms
, 
¢d_øwmidi_˛ock_t
 
vÆ
);

149 
¢d_øwmidi_˛ock_t
 
¢d_øwmidi_∑øms_gë_˛ock_ty≥
(c⁄° 
¢d_øwmidi_∑øms_t
 *
∑øms
);

151 
¢d_øwmidi_∑øms
(
¢d_øwmidi_t
 *
rmidi
, 
¢d_øwmidi_∑øms_t
 * 
∑øms
);

152 
¢d_øwmidi_∑øms_cuºít
(
¢d_øwmidi_t
 *
rmidi
, 
¢d_øwmidi_∑øms_t
 *
∑øms
);

153 
size_t
 
¢d_øwmidi_°©us_sizeof
();

158 
	#¢d_øwmidi_°©us_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_øwmidi_°©us
)

	)

159 
¢d_øwmidi_°©us_mÆloc
(
¢d_øwmidi_°©us_t
 **
±r
);

160 
¢d_øwmidi_°©us_‰ì
(
¢d_øwmidi_°©us_t
 *
obj
);

161 
¢d_øwmidi_°©us_c›y
(
¢d_øwmidi_°©us_t
 *
d°
, c⁄° snd_øwmidi_°©us_à*
§c
);

162 
¢d_øwmidi_°©us_gë_t°amp
(c⁄° 
¢d_øwmidi_°©us_t
 *
obj
, 
¢d_htime°amp_t
 *
±r
);

163 
size_t
 
¢d_øwmidi_°©us_gë_avaû
(c⁄° 
¢d_øwmidi_°©us_t
 *
obj
);

164 
size_t
 
¢d_øwmidi_°©us_gë_xruns
(c⁄° 
¢d_øwmidi_°©us_t
 *
obj
);

165 
¢d_øwmidi_°©us
(
¢d_øwmidi_t
 *
rmidi
, 
¢d_øwmidi_°©us_t
 * 
°©us
);

166 
¢d_øwmidi_døö
(
¢d_øwmidi_t
 *
rmidi
);

167 
¢d_øwmidi_dr›
(
¢d_øwmidi_t
 *
rmidi
);

168 
ssize_t
 
¢d_øwmidi_wrôe
(
¢d_øwmidi_t
 *
rmidi
, c⁄° *
buf„r
, 
size_t
 
size
);

169 
ssize_t
 
¢d_øwmidi_ªad
(
¢d_øwmidi_t
 *
rmidi
, *
buf„r
, 
size_t
 
size
);

170 
ssize_t
 
¢d_øwmidi_åód
(
¢d_øwmidi_t
 *
rmidi
, 
time•ec
 *
t°amp
, *
buf„r
, 
size_t
 
size
);

171 c⁄° *
¢d_øwmidi_«me
(
¢d_øwmidi_t
 *
rmidi
);

172 
¢d_øwmidi_ty≥_t
 
¢d_øwmidi_ty≥
(
¢d_øwmidi_t
 *
rmidi
);

173 
¢d_øwmidi_°ªam_t
 
¢d_øwmidi_°ªam
(
¢d_øwmidi_t
 *
øwmidi
);

177 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/search.h

20 #i‚de‡
_SEARCH_H


21 
	#_SEARCH_H
 1

	)

23 
	~<„©uªs.h
>

25 
	#__√ed_size_t


	)

26 
	~<°ddef.h
>

28 
	g__BEGIN_DECLS


30 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


34 #ifde‡
__USE_GNU


35 
	sqñem


37 
qñem
 *
	mq_f‹w
;

38 
qñem
 *
	mq_back
;

39 
	mq_d©a
[1];

45 
ösque
 
__P
 ((*
__ñem
, *
__¥ev
));

48 
ªmque
 
__P
 ((*
__ñem
));

53 #i‚de‡
__COMPAR_FN_T


54 
	#__COMPAR_FN_T


	)

55 (*
	t__com∑r_‚_t
Ë
	t__PMT
 ((
	t__c⁄°
 
	t__±r_t
, __const __ptr_t));

57 #ifdef 
__USE_GNU


58 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

65 
FIND
,

66 
ENTER


68 
	tACTION
;

70 
	síåy


72 *
key
;

73 *
d©a
;

75 
	tENTRY
;

78 
_ENTRY
;

88 
ENTRY
 *
h£¨ch
 
	`__P
 ((ENTRY 
__ôem
, 
ACTION
 
__a˘i⁄
));

91 
h¸óã
 
	`__P
 ((
size_t
 
__√l
));

94 
hde°roy
 
	`__P
 (());

96 #ifde‡
__USE_GNU


98 
	sh£¨ch_d©a


100 
_ENTRY
 *
èbÀ
;

101 
size
;

102 
fûÀd
;

107 
h£¨ch_r
 
	`__P
 ((
ENTRY
 
__ôem
, 
ACTION
 
__a˘i⁄
, ENTRY **
__ªtvÆ
,

108 
h£¨ch_d©a
 *
__hèb
));

109 
h¸óã_r
 
	`__P
 ((
size_t
 
__√l
, 
h£¨ch_d©a
 *
__hèb
));

110 
hde°roy_r
 
	`__P
 ((
h£¨ch_d©a
 *
__hèb
));

121 
¥e‹dî
,

122 
po°‹dî
,

123 
íd‹dî
,

124 
Àaf


126 
	tVISIT
;

130 *
t£¨ch
 
	`__PMT
 ((
__c⁄°
 *
__key
, **
__roŸp
,

131 
__com∑r_‚_t
 
__com∑r
));

135 *
tföd
 
	`__PMT
 ((
__c⁄°
 *
__key
, *__c⁄° *
__roŸp
,

136 
__com∑r_‚_t
 
__com∑r
));

139 *
tdñëe
 
	`__PMT
 ((
__c⁄°
 *
__key
, **
__roŸp
,

140 
__com∑r_‚_t
 
__com∑r
));

142 #i‚de‡
__ACTION_FN_T


143 
	#__ACTION_FN_T


	)

144 (*
	t__a˘i⁄_‚_t
Ë
	t__PMT
 ((
	t__c⁄°
 *
	t__nodï
,

145 
	tVISIT
 
	t__vÆue
,

146 
	t__Àvñ
));

151 
twÆk
 
	`__PMT
 ((
__c⁄°
 *
__roŸ
, 
__a˘i⁄_‚_t
 
__a˘i⁄
));

153 #ifde‡
__USE_GNU


156 (*
	t__‰ì_‚_t
Ë
	t__PMT
 ((*
	t__nodï
));

159 
tde°roy
 
	`__PMT
 ((*
__roŸ
, 
__‰ì_‚_t
 
__‰ìf˘
));

165 *
lföd
 
	`__PMT
 ((
__c⁄°
 *
__key
, __c⁄° *
__ba£
,

166 
size_t
 *
__nmemb
, size_à
__size
,

167 
__com∑r_‚_t
 
__com∑r
));

171 *
l£¨ch
 
	`__PMT
 ((
__c⁄°
 *
__key
, *
__ba£
,

172 
size_t
 *
__nmemb
, size_à
__size
,

173 
__com∑r_‚_t
 
__com∑r
));

175 
__END_DECLS


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seq.h

29 #i‚de‡
__ALSA_SEQ_H


30 
	#__ALSA_SEQ_H


	)

32 #ifde‡
__˝lu•lus


44 
	#SND_SEQ_DLSYM_VERSION
 
_dlsym_£q_001


	)

47 
_¢d_£q
 
	t¢d_£q_t
;

52 
	#SND_SEQ_OPEN_OUTPUT
 1

	)

53 
	#SND_SEQ_OPEN_INPUT
 2

	)

54 
	#SND_SEQ_OPEN_DUPLEX
 (
SND_SEQ_OPEN_OUTPUT
|
SND_SEQ_OPEN_INPUT
Ë

	)

59 
	#SND_SEQ_NONBLOCK
 0x0001

	)

62 
	e_¢d_£q_ty≥
 {

63 
SND_SEQ_TYPE_HW
,

64 
SND_SEQ_TYPE_SHM
,

65 
SND_SEQ_TYPE_INET


66 } 
	t¢d_£q_ty≥_t
;

69 
	#SND_SEQ_ADDRESS_UNKNOWN
 253

	)

70 
	#SND_SEQ_ADDRESS_SUBSCRIBERS
 254

	)

71 
	#SND_SEQ_ADDRESS_BROADCAST
 255

	)

74 
	#SND_SEQ_CLIENT_SYSTEM
 0

	)

78 
¢d_£q_›í
(
¢d_£q_t
 **
h™dÀ
, c⁄° *
«me
, 
°ªams
, 
mode
);

79 
¢d_£q_›í_lc⁄f
(
¢d_£q_t
 **
h™dÀ
, c⁄° *
«me
, 
°ªams
, 
mode
, 
¢d_c⁄fig_t
 *
lc⁄f
);

80 c⁄° *
¢d_£q_«me
(
¢d_£q_t
 *
£q
);

81 
¢d_£q_ty≥_t
 
¢d_£q_ty≥
(
¢d_£q_t
 *
£q
);

82 
¢d_£q_˛o£
(
¢d_£q_t
 *
h™dÀ
);

83 
¢d_£q_pﬁl_des¸ùt‹s_cou¡
(
¢d_£q_t
 *
h™dÀ
, 
evíts
);

84 
¢d_£q_pﬁl_des¸ùt‹s
(
¢d_£q_t
 *
h™dÀ
, 
pﬁlfd
 *
pfds
, 
•a˚
, 
evíts
);

85 
¢d_£q_pﬁl_des¸ùt‹s_ªvíts
(
¢d_£q_t
 *
£q
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
);

86 
¢d_£q_n⁄block
(
¢d_£q_t
 *
h™dÀ
, 
n⁄block
);

87 
¢d_£q_˛õ¡_id
(
¢d_£q_t
 *
h™dÀ
);

89 
size_t
 
¢d_£q_gë_ouçut_buf„r_size
(
¢d_£q_t
 *
h™dÀ
);

90 
size_t
 
¢d_£q_gë_öput_buf„r_size
(
¢d_£q_t
 *
h™dÀ
);

91 
¢d_£q_£t_ouçut_buf„r_size
(
¢d_£q_t
 *
h™dÀ
, 
size_t
 
size
);

92 
¢d_£q_£t_öput_buf„r_size
(
¢d_£q_t
 *
h™dÀ
, 
size_t
 
size
);

95 
_¢d_£q_sy°em_öfo
 
	t¢d_£q_sy°em_öfo_t
;

97 
size_t
 
¢d_£q_sy°em_öfo_sizeof
();

99 
	#¢d_£q_sy°em_öfo_Æloˇ
(
±r
) \

100 
	`__¢d_Æloˇ
(
±r
, 
¢d_£q_sy°em_öfo
)

	)

101 
¢d_£q_sy°em_öfo_mÆloc
(
¢d_£q_sy°em_öfo_t
 **
±r
);

102 
¢d_£q_sy°em_öfo_‰ì
(
¢d_£q_sy°em_öfo_t
 *
±r
);

103 
¢d_£q_sy°em_öfo_c›y
(
¢d_£q_sy°em_öfo_t
 *
d°
, c⁄° snd_£q_sy°em_öfo_à*
§c
);

105 
¢d_£q_sy°em_öfo_gë_queues
(c⁄° 
¢d_£q_sy°em_öfo_t
 *
öfo
);

106 
¢d_£q_sy°em_öfo_gë_˛õ¡s
(c⁄° 
¢d_£q_sy°em_öfo_t
 *
öfo
);

107 
¢d_£q_sy°em_öfo_gë_p‹ts
(c⁄° 
¢d_£q_sy°em_öfo_t
 *
öfo
);

108 
¢d_£q_sy°em_öfo_gë_ch™√ls
(c⁄° 
¢d_£q_sy°em_öfo_t
 *
öfo
);

109 
¢d_£q_sy°em_öfo_gë_cur_˛õ¡s
(c⁄° 
¢d_£q_sy°em_öfo_t
 *
öfo
);

110 
¢d_£q_sy°em_öfo_gë_cur_queues
(c⁄° 
¢d_£q_sy°em_öfo_t
 *
öfo
);

112 
¢d_£q_sy°em_öfo
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_sy°em_öfo_t
 *
öfo
);

125 
_¢d_£q_˛õ¡_öfo
 
	t¢d_£q_˛õ¡_öfo_t
;

128 
	e¢d_£q_˛õ¡_ty≥
 {

129 
SND_SEQ_USER_CLIENT
 = 1,

130 
SND_SEQ_KERNEL_CLIENT
 = 2

131 } 
	t¢d_£q_˛õ¡_ty≥_t
;

135 
SND_SEQ_CLIENT_LEGACY_MIDI
 = 0,

136 
SND_SEQ_CLIENT_UMP_MIDI_1_0
 = 1,

137 
SND_SEQ_CLIENT_UMP_MIDI_2_0
 = 2

140 
size_t
 
¢d_£q_˛õ¡_öfo_sizeof
();

142 
	#¢d_£q_˛õ¡_öfo_Æloˇ
(
±r
) \

143 
	`__¢d_Æloˇ
(
±r
, 
¢d_£q_˛õ¡_öfo
)

	)

144 
¢d_£q_˛õ¡_öfo_mÆloc
(
¢d_£q_˛õ¡_öfo_t
 **
±r
);

145 
¢d_£q_˛õ¡_öfo_‰ì
(
¢d_£q_˛õ¡_öfo_t
 *
±r
);

146 
¢d_£q_˛õ¡_öfo_c›y
(
¢d_£q_˛õ¡_öfo_t
 *
d°
, c⁄° snd_£q_˛õ¡_öfo_à*
§c
);

148 
¢d_£q_˛õ¡_öfo_gë_˛õ¡
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

149 
¢d_£q_˛õ¡_ty≥_t
 
¢d_£q_˛õ¡_öfo_gë_ty≥
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

150 c⁄° *
¢d_£q_˛õ¡_öfo_gë_«me
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

151 
¢d_£q_˛õ¡_öfo_gë_brﬂdˇ°_fûãr
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

152 
¢d_£q_˛õ¡_öfo_gë_îr‹_boun˚
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

153 
¢d_£q_˛õ¡_öfo_gë_ˇrd
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

154 
¢d_£q_˛õ¡_öfo_gë_pid
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

155 c⁄° *
¢d_£q_˛õ¡_öfo_gë_evít_fûãr
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

156 
¢d_£q_˛õ¡_öfo_gë_num_p‹ts
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

157 
¢d_£q_˛õ¡_öfo_gë_evít_lo°
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

159 
¢d_£q_˛õ¡_öfo_gë_midi_vîsi⁄
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

160 
¢d_£q_˛õ¡_öfo_gë_ump_group_íabÀd
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
,

161 
group
);

162 
¢d_£q_˛õ¡_öfo_gë_ump_grou∂ess_íabÀd
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

163 
¢d_£q_˛õ¡_öfo_gë_ump_c⁄vîsi⁄
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

164 
¢d_£q_˛õ¡_öfo_£t_˛õ¡
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, 
˛õ¡
);

165 
¢d_£q_˛õ¡_öfo_£t_«me
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, c⁄° *
«me
);

166 
¢d_£q_˛õ¡_öfo_£t_brﬂdˇ°_fûãr
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, 
vÆ
);

167 
¢d_£q_˛õ¡_öfo_£t_îr‹_boun˚
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, 
vÆ
);

168 
¢d_£q_˛õ¡_öfo_£t_evít_fûãr
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, *
fûãr
);

169 
¢d_£q_˛õ¡_öfo_£t_midi_vîsi⁄
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, 
midi_vîsi⁄
);

170 
¢d_£q_˛õ¡_öfo_£t_ump_group_íabÀd
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
,

171 
group
, 
íabÀ
);

172 
¢d_£q_˛õ¡_öfo_£t_ump_grou∂ess_íabÀd
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
,

173 
íabÀ
);

174 
¢d_£q_˛õ¡_öfo_£t_ump_c⁄vîsi⁄
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, 
íabÀ
);

176 
¢d_£q_˛õ¡_öfo_evít_fûãr_˛ór
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

177 
¢d_£q_˛õ¡_öfo_evít_fûãr_add
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, 
evít_ty≥
);

178 
¢d_£q_˛õ¡_öfo_evít_fûãr_dñ
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, 
evít_ty≥
);

179 
¢d_£q_˛õ¡_öfo_evít_fûãr_check
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, 
evít_ty≥
);

181 
¢d_£q_gë_˛õ¡_öfo
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

182 
¢d_£q_gë_™y_˛õ¡_öfo
(
¢d_£q_t
 *
h™dÀ
, 
˛õ¡
, 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

183 
¢d_£q_£t_˛õ¡_öfo
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

184 
¢d_£q_quîy_√xt_˛õ¡
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_˛õ¡_öfo_t
 *
öfo
);

186 
¢d_£q_gë_ump_ídpoöt_öfo
(
¢d_£q_t
 *
£q
, 
˛õ¡
, *
öfo
);

187 
¢d_£q_gë_ump_block_öfo
(
¢d_£q_t
 *
£q
, 
˛õ¡
, 
blk
, *
öfo
);

188 
¢d_£q_£t_ump_ídpoöt_öfo
(
¢d_£q_t
 *
£q
, c⁄° *
öfo
);

189 
¢d_£q_£t_ump_block_öfo
(
¢d_£q_t
 *
£q
, 
blk
, c⁄° *
öfo
);

195 
_¢d_£q_˛õ¡_poﬁ
 
	t¢d_£q_˛õ¡_poﬁ_t
;

197 
size_t
 
¢d_£q_˛õ¡_poﬁ_sizeof
();

199 
	#¢d_£q_˛õ¡_poﬁ_Æloˇ
(
±r
) \

200 
	`__¢d_Æloˇ
(
±r
, 
¢d_£q_˛õ¡_poﬁ
)

	)

201 
¢d_£q_˛õ¡_poﬁ_mÆloc
(
¢d_£q_˛õ¡_poﬁ_t
 **
±r
);

202 
¢d_£q_˛õ¡_poﬁ_‰ì
(
¢d_£q_˛õ¡_poﬁ_t
 *
±r
);

203 
¢d_£q_˛õ¡_poﬁ_c›y
(
¢d_£q_˛õ¡_poﬁ_t
 *
d°
, c⁄° snd_£q_˛õ¡_poﬁ_à*
§c
);

205 
¢d_£q_˛õ¡_poﬁ_gë_˛õ¡
(c⁄° 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
);

206 
size_t
 
¢d_£q_˛õ¡_poﬁ_gë_ouçut_poﬁ
(c⁄° 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
);

207 
size_t
 
¢d_£q_˛õ¡_poﬁ_gë_öput_poﬁ
(c⁄° 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
);

208 
size_t
 
¢d_£q_˛õ¡_poﬁ_gë_ouçut_room
(c⁄° 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
);

209 
size_t
 
¢d_£q_˛õ¡_poﬁ_gë_ouçut_‰ì
(c⁄° 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
);

210 
size_t
 
¢d_£q_˛õ¡_poﬁ_gë_öput_‰ì
(c⁄° 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
);

211 
¢d_£q_˛õ¡_poﬁ_£t_ouçut_poﬁ
(
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
, 
size_t
 
size
);

212 
¢d_£q_˛õ¡_poﬁ_£t_öput_poﬁ
(
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
, 
size_t
 
size
);

213 
¢d_£q_˛õ¡_poﬁ_£t_ouçut_room
(
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
, 
size_t
 
size
);

215 
¢d_£q_gë_˛õ¡_poﬁ
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
);

216 
¢d_£q_£t_˛õ¡_poﬁ
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
);

230 
_¢d_£q_p‹t_öfo
 
	t¢d_£q_p‹t_öfo_t
;

233 
	#SND_SEQ_PORT_SYSTEM_TIMER
 0

	)

234 
	#SND_SEQ_PORT_SYSTEM_ANNOUNCE
 1

	)

237 
	#SND_SEQ_PORT_CAP_READ
 (1<<0Ë

	)

238 
	#SND_SEQ_PORT_CAP_WRITE
 (1<<1Ë

	)

240 
	#SND_SEQ_PORT_CAP_SYNC_READ
 (1<<2Ë

	)

241 
	#SND_SEQ_PORT_CAP_SYNC_WRITE
 (1<<3Ë

	)

243 
	#SND_SEQ_PORT_CAP_DUPLEX
 (1<<4Ë

	)

245 
	#SND_SEQ_PORT_CAP_SUBS_READ
 (1<<5Ë

	)

246 
	#SND_SEQ_PORT_CAP_SUBS_WRITE
 (1<<6Ë

	)

247 
	#SND_SEQ_PORT_CAP_NO_EXPORT
 (1<<7Ë

	)

248 
	#SND_SEQ_PORT_CAP_INACTIVE
 (1<<8Ë

	)

249 
	#SND_SEQ_PORT_CAP_UMP_ENDPOINT
 (1<<9Ë

	)

252 
	#SND_SEQ_PORT_DIR_UNKNOWN
 0

	)

253 
	#SND_SEQ_PORT_DIR_INPUT
 1

	)

254 
	#SND_SEQ_PORT_DIR_OUTPUT
 2

	)

255 
	#SND_SEQ_PORT_DIR_BIDIRECTION
 3

	)

259 
	#SND_SEQ_PORT_TYPE_SPECIFIC
 (1<<0)

	)

261 
	#SND_SEQ_PORT_TYPE_MIDI_GENERIC
 (1<<1)

	)

263 
	#SND_SEQ_PORT_TYPE_MIDI_GM
 (1<<2)

	)

265 
	#SND_SEQ_PORT_TYPE_MIDI_GS
 (1<<3)

	)

267 
	#SND_SEQ_PORT_TYPE_MIDI_XG
 (1<<4)

	)

269 
	#SND_SEQ_PORT_TYPE_MIDI_MT32
 (1<<5)

	)

271 
	#SND_SEQ_PORT_TYPE_MIDI_GM2
 (1<<6)

	)

273 
	#SND_SEQ_PORT_TYPE_MIDI_UMP
 (1<<7)

	)

276 
	#SND_SEQ_PORT_TYPE_SYNTH
 (1<<10)

	)

279 
	#SND_SEQ_PORT_TYPE_DIRECT_SAMPLE
 (1<<11)

	)

282 
	#SND_SEQ_PORT_TYPE_SAMPLE
 (1<<12)

	)

284 
	#SND_SEQ_PORT_TYPE_HARDWARE
 (1<<16)

	)

286 
	#SND_SEQ_PORT_TYPE_SOFTWARE
 (1<<17)

	)

288 
	#SND_SEQ_PORT_TYPE_SYNTHESIZER
 (1<<18)

	)

291 
	#SND_SEQ_PORT_TYPE_PORT
 (1<<19)

	)

293 
	#SND_SEQ_PORT_TYPE_APPLICATION
 (1<<20)

	)

296 
size_t
 
¢d_£q_p‹t_öfo_sizeof
();

298 
	#¢d_£q_p‹t_öfo_Æloˇ
(
±r
) \

299 
	`__¢d_Æloˇ
(
±r
, 
¢d_£q_p‹t_öfo
)

	)

300 
¢d_£q_p‹t_öfo_mÆloc
(
¢d_£q_p‹t_öfo_t
 **
±r
);

301 
¢d_£q_p‹t_öfo_‰ì
(
¢d_£q_p‹t_öfo_t
 *
±r
);

302 
¢d_£q_p‹t_öfo_c›y
(
¢d_£q_p‹t_öfo_t
 *
d°
, c⁄° snd_£q_p‹t_öfo_à*
§c
);

304 
¢d_£q_p‹t_öfo_gë_˛õ¡
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

305 
¢d_£q_p‹t_öfo_gë_p‹t
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

306 c⁄° 
¢d_£q_addr_t
 *
¢d_£q_p‹t_öfo_gë_addr
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

307 c⁄° *
¢d_£q_p‹t_öfo_gë_«me
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

308 
¢d_£q_p‹t_öfo_gë_ˇ∑bûôy
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

309 
¢d_£q_p‹t_öfo_gë_ty≥
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

310 
¢d_£q_p‹t_öfo_gë_midi_ch™√ls
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

311 
¢d_£q_p‹t_öfo_gë_midi_voi˚s
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

312 
¢d_£q_p‹t_öfo_gë_sy¡h_voi˚s
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

313 
¢d_£q_p‹t_öfo_gë_ªad_u£
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

314 
¢d_£q_p‹t_öfo_gë_wrôe_u£
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

315 
¢d_£q_p‹t_öfo_gë_p‹t_•ecifõd
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

316 
¢d_£q_p‹t_öfo_gë_time°ampög
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

317 
¢d_£q_p‹t_öfo_gë_time°amp_ªÆ
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

318 
¢d_£q_p‹t_öfo_gë_time°amp_queue
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

319 
¢d_£q_p‹t_öfo_gë_dúe˘i⁄
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

320 
¢d_£q_p‹t_öfo_gë_ump_group
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
);

322 
¢d_£q_p‹t_öfo_£t_˛õ¡
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
˛õ¡
);

323 
¢d_£q_p‹t_öfo_£t_p‹t
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
p‹t
);

324 
¢d_£q_p‹t_öfo_£t_addr
(
¢d_£q_p‹t_öfo_t
 *
öfo
, c⁄° 
¢d_£q_addr_t
 *
addr
);

325 
¢d_£q_p‹t_öfo_£t_«me
(
¢d_£q_p‹t_öfo_t
 *
öfo
, c⁄° *
«me
);

326 
¢d_£q_p‹t_öfo_£t_ˇ∑bûôy
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
ˇ∑bûôy
);

327 
¢d_£q_p‹t_öfo_£t_ty≥
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
ty≥
);

328 
¢d_£q_p‹t_öfo_£t_midi_ch™√ls
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
ch™√ls
);

329 
¢d_£q_p‹t_öfo_£t_midi_voi˚s
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
voi˚s
);

330 
¢d_£q_p‹t_öfo_£t_sy¡h_voi˚s
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
voi˚s
);

331 
¢d_£q_p‹t_öfo_£t_p‹t_•ecifõd
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
vÆ
);

332 
¢d_£q_p‹t_öfo_£t_time°ampög
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
íabÀ
);

333 
¢d_£q_p‹t_öfo_£t_time°amp_ªÆ
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
ªÆtime
);

334 
¢d_£q_p‹t_öfo_£t_time°amp_queue
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
queue
);

335 
¢d_£q_p‹t_öfo_£t_dúe˘i⁄
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
dúe˘i⁄
);

336 
¢d_£q_p‹t_öfo_£t_ump_group
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
ump_group
);

338 
¢d_£q_¸óã_p‹t
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_p‹t_öfo_t
 *
öfo
);

339 
¢d_£q_dñëe_p‹t
(
¢d_£q_t
 *
h™dÀ
, 
p‹t
);

340 
¢d_£q_gë_p‹t_öfo
(
¢d_£q_t
 *
h™dÀ
, 
p‹t
, 
¢d_£q_p‹t_öfo_t
 *
öfo
);

341 
¢d_£q_gë_™y_p‹t_öfo
(
¢d_£q_t
 *
h™dÀ
, 
˛õ¡
, 
p‹t
, 
¢d_£q_p‹t_öfo_t
 *
öfo
);

342 
¢d_£q_£t_p‹t_öfo
(
¢d_£q_t
 *
h™dÀ
, 
p‹t
, 
¢d_£q_p‹t_öfo_t
 *
öfo
);

343 
¢d_£q_quîy_√xt_p‹t
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_p‹t_öfo_t
 *
öfo
);

356 
_¢d_£q_p‹t_subs¸ibe
 
	t¢d_£q_p‹t_subs¸ibe_t
;

358 
size_t
 
¢d_£q_p‹t_subs¸ibe_sizeof
();

360 
	#¢d_£q_p‹t_subs¸ibe_Æloˇ
(
±r
) \

361 
	`__¢d_Æloˇ
(
±r
, 
¢d_£q_p‹t_subs¸ibe
)

	)

362 
¢d_£q_p‹t_subs¸ibe_mÆloc
(
¢d_£q_p‹t_subs¸ibe_t
 **
±r
);

363 
¢d_£q_p‹t_subs¸ibe_‰ì
(
¢d_£q_p‹t_subs¸ibe_t
 *
±r
);

364 
¢d_£q_p‹t_subs¸ibe_c›y
(
¢d_£q_p‹t_subs¸ibe_t
 *
d°
, c⁄° snd_£q_p‹t_subs¸ibe_à*
§c
);

366 c⁄° 
¢d_£q_addr_t
 *
¢d_£q_p‹t_subs¸ibe_gë_£ndî
(c⁄° 
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
);

367 c⁄° 
¢d_£q_addr_t
 *
¢d_£q_p‹t_subs¸ibe_gë_de°
(c⁄° 
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
);

368 
¢d_£q_p‹t_subs¸ibe_gë_queue
(c⁄° 
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
);

369 
¢d_£q_p‹t_subs¸ibe_gë_ex˛usive
(c⁄° 
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
);

370 
¢d_£q_p‹t_subs¸ibe_gë_time_upd©e
(c⁄° 
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
);

371 
¢d_£q_p‹t_subs¸ibe_gë_time_ªÆ
(c⁄° 
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
);

373 
¢d_£q_p‹t_subs¸ibe_£t_£ndî
(
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
, c⁄° 
¢d_£q_addr_t
 *
addr
);

374 
¢d_£q_p‹t_subs¸ibe_£t_de°
(
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
, c⁄° 
¢d_£q_addr_t
 *
addr
);

375 
¢d_£q_p‹t_subs¸ibe_£t_queue
(
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
, 
q
);

376 
¢d_£q_p‹t_subs¸ibe_£t_ex˛usive
(
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
, 
vÆ
);

377 
¢d_£q_p‹t_subs¸ibe_£t_time_upd©e
(
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
, 
vÆ
);

378 
¢d_£q_p‹t_subs¸ibe_£t_time_ªÆ
(
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
, 
vÆ
);

380 
¢d_£q_gë_p‹t_subs¸ùti⁄
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_p‹t_subs¸ibe_t
 *
sub
);

381 
¢d_£q_subs¸ibe_p‹t
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_p‹t_subs¸ibe_t
 *
sub
);

382 
¢d_£q_unsubs¸ibe_p‹t
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_p‹t_subs¸ibe_t
 *
sub
);

388 
_¢d_£q_quîy_subs¸ibe
 
	t¢d_£q_quîy_subs¸ibe_t
;

392 
SND_SEQ_QUERY_SUBS_READ
,

393 
SND_SEQ_QUERY_SUBS_WRITE


394 } 
	t¢d_£q_quîy_subs_ty≥_t
;

396 
size_t
 
¢d_£q_quîy_subs¸ibe_sizeof
();

398 
	#¢d_£q_quîy_subs¸ibe_Æloˇ
(
±r
) \

399 
	`__¢d_Æloˇ
(
±r
, 
¢d_£q_quîy_subs¸ibe
)

	)

400 
¢d_£q_quîy_subs¸ibe_mÆloc
(
¢d_£q_quîy_subs¸ibe_t
 **
±r
);

401 
¢d_£q_quîy_subs¸ibe_‰ì
(
¢d_£q_quîy_subs¸ibe_t
 *
±r
);

402 
¢d_£q_quîy_subs¸ibe_c›y
(
¢d_£q_quîy_subs¸ibe_t
 *
d°
, c⁄° snd_£q_quîy_subs¸ibe_à*
§c
);

404 
¢d_£q_quîy_subs¸ibe_gë_˛õ¡
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
);

405 
¢d_£q_quîy_subs¸ibe_gë_p‹t
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
);

406 c⁄° 
¢d_£q_addr_t
 *
¢d_£q_quîy_subs¸ibe_gë_roŸ
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
);

407 
¢d_£q_quîy_subs_ty≥_t
 
¢d_£q_quîy_subs¸ibe_gë_ty≥
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
);

408 
¢d_£q_quîy_subs¸ibe_gë_ödex
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
);

409 
¢d_£q_quîy_subs¸ibe_gë_num_subs
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
);

410 c⁄° 
¢d_£q_addr_t
 *
¢d_£q_quîy_subs¸ibe_gë_addr
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
);

411 
¢d_£q_quîy_subs¸ibe_gë_queue
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
);

412 
¢d_£q_quîy_subs¸ibe_gë_ex˛usive
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
);

413 
¢d_£q_quîy_subs¸ibe_gë_time_upd©e
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
);

414 
¢d_£q_quîy_subs¸ibe_gë_time_ªÆ
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
);

416 
¢d_£q_quîy_subs¸ibe_£t_˛õ¡
(
¢d_£q_quîy_subs¸ibe_t
 *
öfo
, 
˛õ¡
);

417 
¢d_£q_quîy_subs¸ibe_£t_p‹t
(
¢d_£q_quîy_subs¸ibe_t
 *
öfo
, 
p‹t
);

418 
¢d_£q_quîy_subs¸ibe_£t_roŸ
(
¢d_£q_quîy_subs¸ibe_t
 *
öfo
, c⁄° 
¢d_£q_addr_t
 *
addr
);

419 
¢d_£q_quîy_subs¸ibe_£t_ty≥
(
¢d_£q_quîy_subs¸ibe_t
 *
öfo
, 
¢d_£q_quîy_subs_ty≥_t
 
ty≥
);

420 
¢d_£q_quîy_subs¸ibe_£t_ödex
(
¢d_£q_quîy_subs¸ibe_t
 *
öfo
, 
_ödex
);

422 
¢d_£q_quîy_p‹t_subs¸ibîs
(
¢d_£q_t
 *
£q
, 
¢d_£q_quîy_subs¸ibe_t
 * 
subs
);

435 
_¢d_£q_queue_öfo
 
	t¢d_£q_queue_öfo_t
;

437 
_¢d_£q_queue_°©us
 
	t¢d_£q_queue_°©us_t
;

439 
_¢d_£q_queue_ãmpo
 
	t¢d_£q_queue_ãmpo_t
;

441 
_¢d_£q_queue_timî
 
	t¢d_£q_queue_timî_t
;

444 
	#SND_SEQ_QUEUE_DIRECT
 253

	)

446 
size_t
 
¢d_£q_queue_öfo_sizeof
();

448 
	#¢d_£q_queue_öfo_Æloˇ
(
±r
) \

449 
	`__¢d_Æloˇ
(
±r
, 
¢d_£q_queue_öfo
)

	)

450 
¢d_£q_queue_öfo_mÆloc
(
¢d_£q_queue_öfo_t
 **
±r
);

451 
¢d_£q_queue_öfo_‰ì
(
¢d_£q_queue_öfo_t
 *
±r
);

452 
¢d_£q_queue_öfo_c›y
(
¢d_£q_queue_öfo_t
 *
d°
, c⁄° snd_£q_queue_öfo_à*
§c
);

454 
¢d_£q_queue_öfo_gë_queue
(c⁄° 
¢d_£q_queue_öfo_t
 *
öfo
);

455 c⁄° *
¢d_£q_queue_öfo_gë_«me
(c⁄° 
¢d_£q_queue_öfo_t
 *
öfo
);

456 
¢d_£q_queue_öfo_gë_ow√r
(c⁄° 
¢d_£q_queue_öfo_t
 *
öfo
);

457 
¢d_£q_queue_öfo_gë_locked
(c⁄° 
¢d_£q_queue_öfo_t
 *
öfo
);

458 
¢d_£q_queue_öfo_gë_Êags
(c⁄° 
¢d_£q_queue_öfo_t
 *
öfo
);

460 
¢d_£q_queue_öfo_£t_«me
(
¢d_£q_queue_öfo_t
 *
öfo
, c⁄° *
«me
);

461 
¢d_£q_queue_öfo_£t_ow√r
(
¢d_£q_queue_öfo_t
 *
öfo
, 
ow√r
);

462 
¢d_£q_queue_öfo_£t_locked
(
¢d_£q_queue_öfo_t
 *
öfo
, 
locked
);

463 
¢d_£q_queue_öfo_£t_Êags
(
¢d_£q_queue_öfo_t
 *
öfo
, 
Êags
);

465 
¢d_£q_¸óã_queue
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_öfo_t
 *
öfo
);

466 
¢d_£q_Æloc_«med_queue
(
¢d_£q_t
 *
£q
, c⁄° *
«me
);

467 
¢d_£q_Æloc_queue
(
¢d_£q_t
 *
h™dÀ
);

468 
¢d_£q_‰ì_queue
(
¢d_£q_t
 *
h™dÀ
, 
q
);

469 
¢d_£q_gë_queue_öfo
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_öfo_t
 *
öfo
);

470 
¢d_£q_£t_queue_öfo
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_öfo_t
 *
öfo
);

471 
¢d_£q_quîy_«med_queue
(
¢d_£q_t
 *
£q
, c⁄° *
«me
);

473 
¢d_£q_gë_queue_ußge
(
¢d_£q_t
 *
h™dÀ
, 
q
);

474 
¢d_£q_£t_queue_ußge
(
¢d_£q_t
 *
h™dÀ
, 
q
, 
u£d
);

478 
size_t
 
¢d_£q_queue_°©us_sizeof
();

480 
	#¢d_£q_queue_°©us_Æloˇ
(
±r
) \

481 
	`__¢d_Æloˇ
(
±r
, 
¢d_£q_queue_°©us
)

	)

482 
¢d_£q_queue_°©us_mÆloc
(
¢d_£q_queue_°©us_t
 **
±r
);

483 
¢d_£q_queue_°©us_‰ì
(
¢d_£q_queue_°©us_t
 *
±r
);

484 
¢d_£q_queue_°©us_c›y
(
¢d_£q_queue_°©us_t
 *
d°
, c⁄° snd_£q_queue_°©us_à*
§c
);

486 
¢d_£q_queue_°©us_gë_queue
(c⁄° 
¢d_£q_queue_°©us_t
 *
öfo
);

487 
¢d_£q_queue_°©us_gë_evíts
(c⁄° 
¢d_£q_queue_°©us_t
 *
öfo
);

488 
¢d_£q_tick_time_t
 
¢d_£q_queue_°©us_gë_tick_time
(c⁄° 
¢d_£q_queue_°©us_t
 *
öfo
);

489 c⁄° 
¢d_£q_ªÆ_time_t
 *
¢d_£q_queue_°©us_gë_ªÆ_time
(c⁄° 
¢d_£q_queue_°©us_t
 *
öfo
);

490 
¢d_£q_queue_°©us_gë_°©us
(c⁄° 
¢d_£q_queue_°©us_t
 *
öfo
);

492 
¢d_£q_gë_queue_°©us
(
¢d_£q_t
 *
h™dÀ
, 
q
, 
¢d_£q_queue_°©us_t
 *
°©us
);

496 
size_t
 
¢d_£q_queue_ãmpo_sizeof
();

498 
	#¢d_£q_queue_ãmpo_Æloˇ
(
±r
) \

499 
	`__¢d_Æloˇ
(
±r
, 
¢d_£q_queue_ãmpo
)

	)

500 
¢d_£q_queue_ãmpo_mÆloc
(
¢d_£q_queue_ãmpo_t
 **
±r
);

501 
¢d_£q_queue_ãmpo_‰ì
(
¢d_£q_queue_ãmpo_t
 *
±r
);

502 
¢d_£q_queue_ãmpo_c›y
(
¢d_£q_queue_ãmpo_t
 *
d°
, c⁄° snd_£q_queue_ãmpo_à*
§c
);

504 
¢d_£q_queue_ãmpo_gë_queue
(c⁄° 
¢d_£q_queue_ãmpo_t
 *
öfo
);

505 
¢d_£q_queue_ãmpo_gë_ãmpo
(c⁄° 
¢d_£q_queue_ãmpo_t
 *
öfo
);

506 
¢d_£q_queue_ãmpo_gë_µq
(c⁄° 
¢d_£q_queue_ãmpo_t
 *
öfo
);

507 
¢d_£q_queue_ãmpo_gë_skew
(c⁄° 
¢d_£q_queue_ãmpo_t
 *
öfo
);

508 
¢d_£q_queue_ãmpo_gë_skew_ba£
(c⁄° 
¢d_£q_queue_ãmpo_t
 *
öfo
);

509 
¢d_£q_queue_ãmpo_£t_ãmpo
(
¢d_£q_queue_ãmpo_t
 *
öfo
, 
ãmpo
);

510 
¢d_£q_queue_ãmpo_£t_µq
(
¢d_£q_queue_ãmpo_t
 *
öfo
, 
µq
);

511 
¢d_£q_queue_ãmpo_£t_skew
(
¢d_£q_queue_ãmpo_t
 *
öfo
, 
skew
);

512 
¢d_£q_queue_ãmpo_£t_skew_ba£
(
¢d_£q_queue_ãmpo_t
 *
öfo
, 
ba£
);

514 
¢d_£q_gë_queue_ãmpo
(
¢d_£q_t
 *
h™dÀ
, 
q
, 
¢d_£q_queue_ãmpo_t
 *
ãmpo
);

515 
¢d_£q_£t_queue_ãmpo
(
¢d_£q_t
 *
h™dÀ
, 
q
, 
¢d_£q_queue_ãmpo_t
 *
ãmpo
);

522 
SND_SEQ_TIMER_ALSA
 = 0,

523 
SND_SEQ_TIMER_MIDI_CLOCK
 = 1,

524 
SND_SEQ_TIMER_MIDI_TICK
 = 2

525 } 
	t¢d_£q_queue_timî_ty≥_t
;

527 
size_t
 
¢d_£q_queue_timî_sizeof
();

529 
	#¢d_£q_queue_timî_Æloˇ
(
±r
) \

530 
	`__¢d_Æloˇ
(
±r
, 
¢d_£q_queue_timî
)

	)

531 
¢d_£q_queue_timî_mÆloc
(
¢d_£q_queue_timî_t
 **
±r
);

532 
¢d_£q_queue_timî_‰ì
(
¢d_£q_queue_timî_t
 *
±r
);

533 
¢d_£q_queue_timî_c›y
(
¢d_£q_queue_timî_t
 *
d°
, c⁄° snd_£q_queue_timî_à*
§c
);

535 
¢d_£q_queue_timî_gë_queue
(c⁄° 
¢d_£q_queue_timî_t
 *
öfo
);

536 
¢d_£q_queue_timî_ty≥_t
 
¢d_£q_queue_timî_gë_ty≥
(c⁄° 
¢d_£q_queue_timî_t
 *
öfo
);

537 c⁄° 
¢d_timî_id_t
 *
¢d_£q_queue_timî_gë_id
(c⁄° 
¢d_£q_queue_timî_t
 *
öfo
);

538 
¢d_£q_queue_timî_gë_ªsﬁuti⁄
(c⁄° 
¢d_£q_queue_timî_t
 *
öfo
);

540 
¢d_£q_queue_timî_£t_ty≥
(
¢d_£q_queue_timî_t
 *
öfo
, 
¢d_£q_queue_timî_ty≥_t
 
ty≥
);

541 
¢d_£q_queue_timî_£t_id
(
¢d_£q_queue_timî_t
 *
öfo
, c⁄° 
¢d_timî_id_t
 *
id
);

542 
¢d_£q_queue_timî_£t_ªsﬁuti⁄
(
¢d_£q_queue_timî_t
 *
öfo
, 
ªsﬁuti⁄
);

544 
¢d_£q_gë_queue_timî
(
¢d_£q_t
 *
h™dÀ
, 
q
, 
¢d_£q_queue_timî_t
 *
timî
);

545 
¢d_£q_£t_queue_timî
(
¢d_£q_t
 *
h™dÀ
, 
q
, 
¢d_£q_queue_timî_t
 *
timî
);

556 
¢d_£q_‰ì_evít
(
¢d_£q_evít_t
 *
ev
);

557 
ssize_t
 
¢d_£q_evít_Àngth
(
¢d_£q_evít_t
 *
ev
);

558 
¢d_£q_evít_ouçut
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_evít_t
 *
ev
);

559 
¢d_£q_evít_ouçut_buf„r
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_evít_t
 *
ev
);

560 
¢d_£q_evít_ouçut_dúe˘
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_evít_t
 *
ev
);

561 
¢d_£q_evít_öput
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_evít_t
 **
ev
);

562 
¢d_£q_evít_öput_≥ndög
(
¢d_£q_t
 *
£q
, 
„tch_£quí˚r
);

563 
¢d_£q_døö_ouçut
(
¢d_£q_t
 *
h™dÀ
);

564 
¢d_£q_evít_ouçut_≥ndög
(
¢d_£q_t
 *
£q
);

565 
¢d_£q_exåa˘_ouçut
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_evít_t
 **
ev
);

566 
¢d_£q_dr›_ouçut
(
¢d_£q_t
 *
h™dÀ
);

567 
¢d_£q_dr›_ouçut_buf„r
(
¢d_£q_t
 *
h™dÀ
);

568 
¢d_£q_dr›_öput
(
¢d_£q_t
 *
h™dÀ
);

569 
¢d_£q_dr›_öput_buf„r
(
¢d_£q_t
 *
h™dÀ
);

572 
_¢d_£q_ªmove_evíts
 
	t¢d_£q_ªmove_evíts_t
;

575 
	#SND_SEQ_REMOVE_INPUT
 (1<<0Ë

	)

576 
	#SND_SEQ_REMOVE_OUTPUT
 (1<<1Ë

	)

577 
	#SND_SEQ_REMOVE_DEST
 (1<<2Ë

	)

578 
	#SND_SEQ_REMOVE_DEST_CHANNEL
 (1<<3Ë

	)

579 
	#SND_SEQ_REMOVE_TIME_BEFORE
 (1<<4Ë

	)

580 
	#SND_SEQ_REMOVE_TIME_AFTER
 (1<<5Ë

	)

581 
	#SND_SEQ_REMOVE_TIME_TICK
 (1<<6Ë

	)

582 
	#SND_SEQ_REMOVE_EVENT_TYPE
 (1<<7Ë

	)

583 
	#SND_SEQ_REMOVE_IGNORE_OFF
 (1<<8Ë

	)

584 
	#SND_SEQ_REMOVE_TAG_MATCH
 (1<<9Ë

	)

586 
size_t
 
¢d_£q_ªmove_evíts_sizeof
();

588 
	#¢d_£q_ªmove_evíts_Æloˇ
(
±r
) \

589 
	`__¢d_Æloˇ
(
±r
, 
¢d_£q_ªmove_evíts
)

	)

590 
¢d_£q_ªmove_evíts_mÆloc
(
¢d_£q_ªmove_evíts_t
 **
±r
);

591 
¢d_£q_ªmove_evíts_‰ì
(
¢d_£q_ªmove_evíts_t
 *
±r
);

592 
¢d_£q_ªmove_evíts_c›y
(
¢d_£q_ªmove_evíts_t
 *
d°
, c⁄° snd_£q_ªmove_evíts_à*
§c
);

594 
¢d_£q_ªmove_evíts_gë_c⁄dôi⁄
(c⁄° 
¢d_£q_ªmove_evíts_t
 *
öfo
);

595 
¢d_£q_ªmove_evíts_gë_queue
(c⁄° 
¢d_£q_ªmove_evíts_t
 *
öfo
);

596 c⁄° 
¢d_£q_time°amp_t
 *
¢d_£q_ªmove_evíts_gë_time
(c⁄° 
¢d_£q_ªmove_evíts_t
 *
öfo
);

597 c⁄° 
¢d_£q_addr_t
 *
¢d_£q_ªmove_evíts_gë_de°
(c⁄° 
¢d_£q_ªmove_evíts_t
 *
öfo
);

598 
¢d_£q_ªmove_evíts_gë_ch™√l
(c⁄° 
¢d_£q_ªmove_evíts_t
 *
öfo
);

599 
¢d_£q_ªmove_evíts_gë_evít_ty≥
(c⁄° 
¢d_£q_ªmove_evíts_t
 *
öfo
);

600 
¢d_£q_ªmove_evíts_gë_èg
(c⁄° 
¢d_£q_ªmove_evíts_t
 *
öfo
);

602 
¢d_£q_ªmove_evíts_£t_c⁄dôi⁄
(
¢d_£q_ªmove_evíts_t
 *
öfo
, 
Êags
);

603 
¢d_£q_ªmove_evíts_£t_queue
(
¢d_£q_ªmove_evíts_t
 *
öfo
, 
queue
);

604 
¢d_£q_ªmove_evíts_£t_time
(
¢d_£q_ªmove_evíts_t
 *
öfo
, c⁄° 
¢d_£q_time°amp_t
 *
time
);

605 
¢d_£q_ªmove_evíts_£t_de°
(
¢d_£q_ªmove_evíts_t
 *
öfo
, c⁄° 
¢d_£q_addr_t
 *
addr
);

606 
¢d_£q_ªmove_evíts_£t_ch™√l
(
¢d_£q_ªmove_evíts_t
 *
öfo
, 
ch™√l
);

607 
¢d_£q_ªmove_evíts_£t_evít_ty≥
(
¢d_£q_ªmove_evíts_t
 *
öfo
, 
ty≥
);

608 
¢d_£q_ªmove_evíts_£t_èg
(
¢d_£q_ªmove_evíts_t
 *
öfo
, 
èg
);

610 
¢d_£q_ªmove_evíts
(
¢d_£q_t
 *
h™dÀ
, 
¢d_£q_ªmove_evíts_t
 *
öfo
);

612 
¢d_£q_ump_evít_ouçut
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_evít_t
 *
ev
);

613 
¢d_£q_ump_evít_ouçut_buf„r
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_evít_t
 *
ev
);

614 
¢d_£q_ump_exåa˘_ouçut
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_evít_t
 **
ev_ªs
);

615 
¢d_£q_ump_evít_ouçut_dúe˘
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_evít_t
 *
ev
);

616 
¢d_£q_ump_evít_öput
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_evít_t
 **
ev
);

627 
¢d_£q_£t_bô
(
ƒ
, *
¨øy
);

628 
¢d_£q_un£t_bô
(
ƒ
, *
¨øy
);

629 
¢d_£q_ch™ge_bô
(
ƒ
, *
¨øy
);

630 
¢d_£q_gë_bô
(
ƒ
, *
¨øy
);

644 
SND_SEQ_EVFLG_RESULT
,

645 
SND_SEQ_EVFLG_NOTE
,

646 
SND_SEQ_EVFLG_CONTROL
,

647 
SND_SEQ_EVFLG_QUEUE
,

648 
SND_SEQ_EVFLG_SYSTEM
,

649 
SND_SEQ_EVFLG_MESSAGE
,

650 
SND_SEQ_EVFLG_CONNECTION
,

651 
SND_SEQ_EVFLG_SAMPLE
,

652 
SND_SEQ_EVFLG_USERS
,

653 
SND_SEQ_EVFLG_INSTR
,

654 
SND_SEQ_EVFLG_QUOTE
,

655 
SND_SEQ_EVFLG_NONE
,

656 
SND_SEQ_EVFLG_RAW
,

657 
SND_SEQ_EVFLG_FIXED
,

658 
SND_SEQ_EVFLG_VARIABLE
,

659 
SND_SEQ_EVFLG_VARUSR


663 
SND_SEQ_EVFLG_NOTE_ONEARG
,

664 
SND_SEQ_EVFLG_NOTE_TWOARG


668 
SND_SEQ_EVFLG_QUEUE_NOARG
,

669 
SND_SEQ_EVFLG_QUEUE_TICK
,

670 
SND_SEQ_EVFLG_QUEUE_TIME
,

671 
SND_SEQ_EVFLG_QUEUE_VALUE


679 c⁄° 
¢d_£q_evít_ty≥s
[];

681 
	#_SND_SEQ_TYPE
(
x
Ë(1<<(x)Ë

	)

682 
	#_SND_SEQ_TYPE_OPT
(
x
Ë((x)<<24Ë

	)

685 
	#¢d_£q_ty≥_check
(
ev
,
x
Ë(
¢d_£q_evít_ty≥s
[”v)->
ty≥
] & 
	`_SND_SEQ_TYPE
(x))

	)

688 
	#¢d_£q_ev_is_ªsu…_ty≥
(
ev
) \

689 
	`¢d_£q_ty≥_check
(
ev
, 
SND_SEQ_EVFLG_RESULT
)

	)

691 
	#¢d_£q_ev_is_nŸe_ty≥
(
ev
) \

692 
	`¢d_£q_ty≥_check
(
ev
, 
SND_SEQ_EVFLG_NOTE
)

	)

694 
	#¢d_£q_ev_is_c⁄åﬁ_ty≥
(
ev
) \

695 
	`¢d_£q_ty≥_check
(
ev
, 
SND_SEQ_EVFLG_CONTROL
)

	)

697 
	#¢d_£q_ev_is_ch™√l_ty≥
(
ev
) \

698 (
¢d_£q_evít_ty≥s
[(
ev
)->
ty≥
] & (
	`_SND_SEQ_TYPE
(
SND_SEQ_EVFLG_NOTE
Ë| _SND_SEQ_TYPE(
SND_SEQ_EVFLG_CONTROL
)))

	)

701 
	#¢d_£q_ev_is_queue_ty≥
(
ev
) \

702 
	`¢d_£q_ty≥_check
(
ev
, 
SND_SEQ_EVFLG_QUEUE
)

	)

704 
	#¢d_£q_ev_is_mesßge_ty≥
(
ev
) \

705 
	`¢d_£q_ty≥_check
(
ev
, 
SND_SEQ_EVFLG_MESSAGE
)

	)

707 
	#¢d_£q_ev_is_subs¸ibe_ty≥
(
ev
) \

708 
	`¢d_£q_ty≥_check
(
ev
, 
SND_SEQ_EVFLG_CONNECTION
)

	)

710 
	#¢d_£q_ev_is_ßm∂e_ty≥
(
ev
) \

711 
	`¢d_£q_ty≥_check
(
ev
, 
SND_SEQ_EVFLG_SAMPLE
)

	)

713 
	#¢d_£q_ev_is_u£r_ty≥
(
ev
) \

714 
	`¢d_£q_ty≥_check
(
ev
, 
SND_SEQ_EVFLG_USERS
)

	)

716 
	#¢d_£q_ev_is_ö°r_ty≥
(
ev
) \

717 
	`¢d_£q_ty≥_check
(
ev
, 
SND_SEQ_EVFLG_INSTR
)

	)

719 
	#¢d_£q_ev_is_fixed_ty≥
(
ev
) \

720 
	`¢d_£q_ty≥_check
(
ev
, 
SND_SEQ_EVFLG_FIXED
)

	)

722 
	#¢d_£q_ev_is_v¨übÀ_ty≥
(
ev
) \

723 
	`¢d_£q_ty≥_check
(
ev
, 
SND_SEQ_EVFLG_VARIABLE
)

	)

725 
	#¢d_£q_ev_is_v¨u§_ty≥
(
ev
) \

726 
	`¢d_£q_ty≥_check
(
ev
, 
SND_SEQ_EVFLG_VARUSR
)

	)

728 
	#¢d_£q_ev_is_ª£rved
(
ev
) \

729 (! 
¢d_£q_evít_ty≥s
[(
ev
)->
ty≥
])

	)

735 
	#¢d_£q_ev_is_¥i‹
(
ev
) \

736 (((
ev
)->
Êags
 & 
SND_SEQ_PRIORITY_MASK
Ë=
SND_SEQ_PRIORITY_HIGH
)

	)

739 
	#¢d_£q_ev_Àngth_ty≥
(
ev
) \

740 ((
ev
)->
Êags
 & 
SND_SEQ_EVENT_LENGTH_MASK
)

	)

742 
	#¢d_£q_ev_is_fixed
(
ev
) \

743 (
	`¢d_£q_ev_Àngth_ty≥
(
ev
Ë=
SND_SEQ_EVENT_LENGTH_FIXED
)

	)

745 
	#¢d_£q_ev_is_v¨übÀ
(
ev
) \

746 (
	`¢d_£q_ev_Àngth_ty≥
(
ev
Ë=
SND_SEQ_EVENT_LENGTH_VARIABLE
)

	)

748 
	#¢d_£q_ev_is_v¨u§
(
ev
) \

749 (
	`¢d_£q_ev_Àngth_ty≥
(
ev
Ë=
SND_SEQ_EVENT_LENGTH_VARUSR
)

	)

752 
	#¢d_£q_ev_time°amp_ty≥
(
ev
) \

753 ((
ev
)->
Êags
 & 
SND_SEQ_TIME_STAMP_MASK
)

	)

755 
	#¢d_£q_ev_is_tick
(
ev
) \

756 (
	`¢d_£q_ev_time°amp_ty≥
(
ev
Ë=
SND_SEQ_TIME_STAMP_TICK
)

	)

758 
	#¢d_£q_ev_is_ªÆ
(
ev
) \

759 (
	`¢d_£q_ev_time°amp_ty≥
(
ev
Ë=
SND_SEQ_TIME_STAMP_REAL
)

	)

762 
	#¢d_£q_ev_timemode_ty≥
(
ev
) \

763 ((
ev
)->
Êags
 & 
SND_SEQ_TIME_MODE_MASK
)

	)

765 
	#¢d_£q_ev_is_ab°ime
(
ev
) \

766 (
	`¢d_£q_ev_timemode_ty≥
(
ev
Ë=
SND_SEQ_TIME_MODE_ABS
)

	)

768 
	#¢d_£q_ev_is_ª…ime
(
ev
) \

769 (
	`¢d_£q_ev_timemode_ty≥
(
ev
Ë=
SND_SEQ_TIME_MODE_REL
)

	)

772 
	#¢d_£q_ev_is_dúe˘
(
ev
) \

773 ((
ev
)->
queue
 =
SND_SEQ_QUEUE_DIRECT
)

	)

776 
	#¢d_£q_ev_is_ump
(
ev
) \

777 ((
ev
)->
Êags
 & 
SND_SEQ_EVENT_UMP
)

	)

781 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seq_event.h

28 #i‚de‡
__ALSA_SEQ_EVENT_H


29 
	#__ALSA_SEQ_EVENT_H


	)

41 
	t¢d_£q_evít_ty≥_t
;

44 
	e¢d_£q_evít_ty≥
 {

46 
	mSND_SEQ_EVENT_SYSTEM
 = 0,

48 
	mSND_SEQ_EVENT_RESULT
,

51 
	mSND_SEQ_EVENT_NOTE
 = 5,

53 
	mSND_SEQ_EVENT_NOTEON
,

55 
	mSND_SEQ_EVENT_NOTEOFF
,

57 
	mSND_SEQ_EVENT_KEYPRESS
,

60 
	mSND_SEQ_EVENT_CONTROLLER
 = 10,

62 
	mSND_SEQ_EVENT_PGMCHANGE
,

64 
	mSND_SEQ_EVENT_CHANPRESS
,

66 
	mSND_SEQ_EVENT_PITCHBEND
,

68 
	mSND_SEQ_EVENT_CONTROL14
,

70 
	mSND_SEQ_EVENT_NONREGPARAM
,

72 
	mSND_SEQ_EVENT_REGPARAM
,

75 
	mSND_SEQ_EVENT_SONGPOS
 = 20,

77 
	mSND_SEQ_EVENT_SONGSEL
,

79 
	mSND_SEQ_EVENT_QFRAME
,

81 
	mSND_SEQ_EVENT_TIMESIGN
,

83 
	mSND_SEQ_EVENT_KEYSIGN
,

86 
	mSND_SEQ_EVENT_START
 = 30,

88 
	mSND_SEQ_EVENT_CONTINUE
,

90 
	mSND_SEQ_EVENT_STOP
,

92 
	mSND_SEQ_EVENT_SETPOS_TICK
,

94 
	mSND_SEQ_EVENT_SETPOS_TIME
,

96 
	mSND_SEQ_EVENT_TEMPO
,

98 
	mSND_SEQ_EVENT_CLOCK
,

100 
	mSND_SEQ_EVENT_TICK
,

102 
	mSND_SEQ_EVENT_QUEUE_SKEW
,

104 
	mSND_SEQ_EVENT_SYNC_POS
,

107 
	mSND_SEQ_EVENT_TUNE_REQUEST
 = 40,

109 
	mSND_SEQ_EVENT_RESET
,

111 
	mSND_SEQ_EVENT_SENSING
,

114 
	mSND_SEQ_EVENT_ECHO
 = 50,

116 
	mSND_SEQ_EVENT_OSS
,

119 
	mSND_SEQ_EVENT_CLIENT_START
 = 60,

121 
	mSND_SEQ_EVENT_CLIENT_EXIT
,

123 
	mSND_SEQ_EVENT_CLIENT_CHANGE
,

125 
	mSND_SEQ_EVENT_PORT_START
,

127 
	mSND_SEQ_EVENT_PORT_EXIT
,

129 
	mSND_SEQ_EVENT_PORT_CHANGE
,

132 
	mSND_SEQ_EVENT_PORT_SUBSCRIBED
,

134 
	mSND_SEQ_EVENT_PORT_UNSUBSCRIBED
,

137 
	mSND_SEQ_EVENT_USR0
 = 90,

139 
	mSND_SEQ_EVENT_USR1
,

141 
	mSND_SEQ_EVENT_USR2
,

143 
	mSND_SEQ_EVENT_USR3
,

145 
	mSND_SEQ_EVENT_USR4
,

147 
	mSND_SEQ_EVENT_USR5
,

149 
	mSND_SEQ_EVENT_USR6
,

151 
	mSND_SEQ_EVENT_USR7
,

153 
	mSND_SEQ_EVENT_USR8
,

155 
	mSND_SEQ_EVENT_USR9
,

158 
	mSND_SEQ_EVENT_SYSEX
 = 130,

160 
	mSND_SEQ_EVENT_BOUNCE
,

162 
	mSND_SEQ_EVENT_USR_VAR0
 = 135,

164 
	mSND_SEQ_EVENT_USR_VAR1
,

166 
	mSND_SEQ_EVENT_USR_VAR2
,

168 
	mSND_SEQ_EVENT_USR_VAR3
,

170 
	mSND_SEQ_EVENT_USR_VAR4
,

173 
	mSND_SEQ_EVENT_NONE
 = 255

178 
	s¢d_£q_addr
 {

179 
	m˛õ¡
;

180 
	mp‹t
;

181 } 
	t¢d_£q_addr_t
;

184 
	s¢d_£q_c⁄√˘
 {

185 
¢d_£q_addr_t
 
	m£ndî
;

186 
¢d_£q_addr_t
 
	mde°
;

187 } 
	t¢d_£q_c⁄√˘_t
;

191 
	s¢d_£q_ªÆ_time
 {

192 
	mtv_£c
;

193 
	mtv_n£c
;

194 } 
	t¢d_£q_ªÆ_time_t
;

197 
	t¢d_£q_tick_time_t
;

200 
	u¢d_£q_time°amp
 {

201 
¢d_£q_tick_time_t
 
	mtick
;

202 
¢d_£q_ªÆ_time
 
	mtime
;

203 } 
	t¢d_£q_time°amp_t
;

211 
	#SND_SEQ_TIME_STAMP_TICK
 (0<<0Ë

	)

212 
	#SND_SEQ_TIME_STAMP_REAL
 (1<<0Ë

	)

213 
	#SND_SEQ_TIME_STAMP_MASK
 (1<<0Ë

	)

215 
	#SND_SEQ_TIME_MODE_ABS
 (0<<1Ë

	)

216 
	#SND_SEQ_TIME_MODE_REL
 (1<<1Ë

	)

217 
	#SND_SEQ_TIME_MODE_MASK
 (1<<1Ë

	)

219 
	#SND_SEQ_EVENT_LENGTH_FIXED
 (0<<2Ë

	)

220 
	#SND_SEQ_EVENT_LENGTH_VARIABLE
 (1<<2Ë

	)

221 
	#SND_SEQ_EVENT_LENGTH_VARUSR
 (2<<2Ë

	)

222 
	#SND_SEQ_EVENT_LENGTH_MASK
 (3<<2Ë

	)

224 
	#SND_SEQ_PRIORITY_NORMAL
 (0<<4Ë

	)

225 
	#SND_SEQ_PRIORITY_HIGH
 (1<<4Ë

	)

226 
	#SND_SEQ_PRIORITY_MASK
 (1<<4Ë

	)

228 
	#SND_SEQ_EVENT_UMP
 (1<<5Ë

	)

231 
	s¢d_£q_ev_nŸe
 {

232 
	mch™√l
;

233 
	mnŸe
;

234 
	mvñocôy
;

235 
	moff_vñocôy
;

236 
	mduøti⁄
;

237 } 
	t¢d_£q_ev_nŸe_t
;

240 
	s¢d_£q_ev_˘æ
 {

241 
	mch™√l
;

242 
	munu£d
[3];

243 
	m∑øm
;

244 sig√d 
	mvÆue
;

245 } 
	t¢d_£q_ev_˘æ_t
;

248 
	s¢d_£q_ev_øw8
 {

249 
	md
[12];

250 } 
	t¢d_£q_ev_øw8_t
;

253 
	s¢d_£q_ev_øw32
 {

254 
	md
[3];

255 } 
	t¢d_£q_ev_øw32_t
;

258 
	s¢d_£q_ev_ext
 {

259 
	mÀn
;

260 *
	m±r
;

261 } 
__©åibuã__
((
∑cked
));

263 
¢d_£q_ev_ext
 
	t¢d_£q_ev_ext_t
;

264 #ifde‡
DOC_HIDDEN


266 
¢d_£q_ev_ext
 
	t¢d_£q_ev_ext_t
;

270 
	s¢d_£q_ªsu…
 {

271 
	mevít
;

272 
	mªsu…
;

273 } 
	t¢d_£q_ªsu…_t
;

276 
	s¢d_£q_queue_skew
 {

277 
	mvÆue
;

278 
	mba£
;

279 } 
	t¢d_£q_queue_skew_t
;

282 
	s¢d_£q_ev_queue_c⁄åﬁ
 {

283 
	mqueue
;

284 
	munu£d
[3];

286 sig√d 
	mvÆue
;

287 
¢d_£q_time°amp_t
 
	mtime
;

288 
	mposôi⁄
;

289 
¢d_£q_queue_skew_t
 
	mskew
;

290 
	md32
[2];

291 
	md8
[8];

292 } 
	m∑øm
;

293 } 
	t¢d_£q_ev_queue_c⁄åﬁ_t
;

296 
	u¢d_£q_evít_d©a
 {

297 
¢d_£q_ev_nŸe_t
 
	mnŸe
;

298 
¢d_£q_ev_˘æ_t
 
	mc⁄åﬁ
;

299 
¢d_£q_ev_øw8_t
 
	møw8
;

300 
¢d_£q_ev_øw32_t
 
	møw32
;

301 
¢d_£q_ev_ext_t
 
	mext
;

302 
¢d_£q_ev_queue_c⁄åﬁ_t
 
	mqueue
;

303 
¢d_£q_time°amp_t
 
	mtime
;

304 
¢d_£q_addr_t
 
	maddr
;

305 
¢d_£q_c⁄√˘_t
 
	mc⁄√˘
;

306 
¢d_£q_ªsu…_t
 
	mªsu…
;

307 } 
	t¢d_£q_evít_d©a_t
;

310 
	s¢d_£q_evít
 {

311 
¢d_£q_evít_ty≥_t
 
	mty≥
;

312 
	mÊags
;

313 
	mèg
;

315 
	mqueue
;

316 
¢d_£q_time°amp_t
 
	mtime
;

318 
¢d_£q_addr_t
 
	msour˚
;

319 
¢d_£q_addr_t
 
	mde°
;

321 
¢d_£q_evít_d©a_t
 
	md©a
;

322 } 
	t¢d_£q_evít_t
;

325 
	s¢d_£q_ump_evít
 {

326 
¢d_£q_evít_ty≥_t
 
	mty≥
;

327 
	mÊags
;

328 
	mèg
;

329 
	mqueue
;

330 
¢d_£q_time°amp_t
 
	mtime
;

331 
¢d_£q_addr_t
 
	msour˚
;

332 
¢d_£q_addr_t
 
	mde°
;

335 
¢d_£q_evít_d©a_t
 
	md©a
;

336 
	mump
[4];

338 } 
	t¢d_£q_ump_evít_t
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seq_midi_event.h

28 #i‚de‡
__ALSA_SEQ_MIDI_EVENT_H


29 
	#__ALSA_SEQ_MIDI_EVENT_H


	)

31 #ifde‡
__˝lu•lus


43 
¢d_midi_evít
 
	t¢d_midi_evít_t
;

45 
¢d_midi_evít_√w
(
size_t
 
bufsize
, 
¢d_midi_evít_t
 **
rdev
);

46 
¢d_midi_evít_ªsize_buf„r
(
¢d_midi_evít_t
 *
dev
, 
size_t
 
bufsize
);

47 
¢d_midi_evít_‰ì
(
¢d_midi_evít_t
 *
dev
);

48 
¢d_midi_evít_öô
(
¢d_midi_evít_t
 *
dev
);

49 
¢d_midi_evít_ª£t_ícode
(
¢d_midi_evít_t
 *
dev
);

50 
¢d_midi_evít_ª£t_decode
(
¢d_midi_evít_t
 *
dev
);

51 
¢d_midi_evít_no_°©us
(
¢d_midi_evít_t
 *
dev
, 
⁄
);

53 
¢d_midi_evít_ícode
(
¢d_midi_evít_t
 *
dev
, c⁄° *
buf
, 
cou¡
, 
¢d_£q_evít_t
 *
ev
);

54 
¢d_midi_evít_ícode_byã
(
¢d_midi_evít_t
 *
dev
, 
c
, 
¢d_£q_evít_t
 *
ev
);

56 
¢d_midi_evít_decode
(
¢d_midi_evít_t
 *
dev
, *
buf
, 
cou¡
, c⁄° 
¢d_£q_evít_t
 *
ev
);

60 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seqmid.h

28 #i‚de‡
__ALSA_SEQMID_H


29 
	#__ALSA_SEQMID_H


	)

31 #ifde‡
__˝lu•lus


48 
ölöe
 
¢d_£q_ev_˛ór
(
¢d_£q_evít_t
 *
ev
)

50 
mem£t
(
ev
, 0, (*ev));

59 
ölöe
 
¢d_£q_ump_ev_˛ór
(
¢d_£q_ump_evít_t
 *
ev
)

61 
mem£t
(
ev
, 0, (*ev));

71 
	#¢d_£q_ev_£t_èg
(
ev
,
t
) \

72 ((
ev
)->
èg
 = (
t
))

	)

84 
	#¢d_£q_ev_£t_de°
(
ev
,
c
,
p
) \

85 ((
ev
)->
de°
.
˛õ¡
 = (
c
), (ev)->de°.
p‹t
 = (
p
))

	)

95 
	#¢d_£q_ev_£t_subs
(
ev
) \

96 ((
ev
)->
de°
.
˛õ¡
 = 
SND_SEQ_ADDRESS_SUBSCRIBERS
,\

97 (
ev
)->
de°
.
p‹t
 = 
SND_SEQ_ADDRESS_UNKNOWN
)

	)

107 
	#¢d_£q_ev_£t_brﬂdˇ°
(
ev
) \

108 ((
ev
)->
de°
.
˛õ¡
 = 
SND_SEQ_ADDRESS_BROADCAST
,\

109 (
ev
)->
de°
.
p‹t
 = 
SND_SEQ_ADDRESS_BROADCAST
)

	)

118 
	#¢d_£q_ev_£t_sour˚
(
ev
,
p
) \

119 ((
ev
)->
sour˚
.
p‹t
 = (
p
))

	)

130 
	#¢d_£q_ev_£t_dúe˘
(
ev
) \

131 ((
ev
)->
queue
 = 
SND_SEQ_QUEUE_DIRECT
)

	)

145 
	#¢d_£q_ev_scheduÀ_tick
(
ev
, 
q
, 
ªœtive
, 
âick
) \

146 ((
ev
)->
Êags
 &~(
SND_SEQ_TIME_STAMP_MASK
 | 
SND_SEQ_TIME_MODE_MASK
),\

147 (
ev
)->
Êags
 |
SND_SEQ_TIME_STAMP_TICK
,\

148 (
ev
)->
Êags
 |(
ªœtive
Ë? 
SND_SEQ_TIME_MODE_REL
 : 
SND_SEQ_TIME_MODE_ABS
,\

149 (
ev
)->
time
.
tick
 = (
âick
),\

150 (
ev
)->
queue
 = (
q
))

	)

164 
	#¢d_£q_ev_scheduÀ_ªÆ
(
ev
, 
q
, 
ªœtive
, 
πime
) \

165 ((
ev
)->
Êags
 &~(
SND_SEQ_TIME_STAMP_MASK
 | 
SND_SEQ_TIME_MODE_MASK
),\

166 (
ev
)->
Êags
 |
SND_SEQ_TIME_STAMP_REAL
,\

167 (
ev
)->
Êags
 |(
ªœtive
Ë? 
SND_SEQ_TIME_MODE_REL
 : 
SND_SEQ_TIME_MODE_ABS
,\

168 (
ev
)->
time
.timê*(
πime
),\

169 (
ev
)->
queue
 = (
q
))

	)

176 
	#¢d_£q_ev_£t_¥i‹ôy
(
ev
, 
high_¥i‹
) \

177 ((
ev
)->
Êags
 &~
SND_SEQ_PRIORITY_MASK
,\

178 (
ev
)->
Êags
 |(
high_¥i‹
Ë? 
SND_SEQ_PRIORITY_HIGH
 : 
SND_SEQ_PRIORITY_NORMAL
)

	)

188 
	#¢d_£q_ev_£t_fixed
(
ev
) \

189 ((
ev
)->
Êags
 &~
SND_SEQ_EVENT_LENGTH_MASK
,\

190 (
ev
)->
Êags
 |
SND_SEQ_EVENT_LENGTH_FIXED
)

	)

202 
	#¢d_£q_ev_£t_v¨übÀ
(
ev
, 
d©Æí
, 
d©≠å
) \

203 ((
ev
)->
Êags
 &~
SND_SEQ_EVENT_LENGTH_MASK
,\

204 (
ev
)->
Êags
 |
SND_SEQ_EVENT_LENGTH_VARIABLE
,\

205 (
ev
)->
d©a
.
ext
.
Àn
 = (
d©Æí
),\

206 (
ev
)->
d©a
.
ext
.
±r
 = (
d©≠å
))

	)

218 
	#¢d_£q_ev_£t_v¨u§
(
ev
, 
d©Æí
, 
d©≠å
) \

219 ((
ev
)->
Êags
 &~
SND_SEQ_EVENT_LENGTH_MASK
,\

220 (
ev
)->
Êags
 |
SND_SEQ_EVENT_LENGTH_VARUSR
,\

221 (
ev
)->
d©a
.
ext
.
Àn
 = (
d©Æí
),\

222 (
ev
)->
d©a
.
ext
.
±r
 = (
d©≠å
))

	)

231 
	#¢d_£q_ev_£t_queue_c⁄åﬁ
(
ev
, 
typ
, 
q
, 
vÆ
) \

232 ((
ev
)->
ty≥
 = (
typ
),\

233 
	`¢d_£q_ev_£t_de°
(
ev
, 
SND_SEQ_CLIENT_SYSTEM
, 
SND_SEQ_PORT_SYSTEM_TIMER
),\

234 (
ev
)->
d©a
.
queue
.queuê(
q
),\

235 (
ev
)->
d©a
.
queue
.
∑øm
.
vÆue
 = (
vÆ
))

	)

244 
	#¢d_£q_ev_£t_queue_°¨t
(
ev
, 
q
) \

245 
	`¢d_£q_ev_£t_queue_c⁄åﬁ
(
ev
, 
SND_SEQ_EVENT_START
, 
q
, 0)

	)

254 
	#¢d_£q_ev_£t_queue_°›
(
ev
, 
q
) \

255 
	`¢d_£q_ev_£t_queue_c⁄åﬁ
(
ev
, 
SND_SEQ_EVENT_STOP
, 
q
, 0)

	)

264 
	#¢d_£q_ev_£t_queue_c⁄töue
(
ev
, 
q
) \

265 
	`¢d_£q_ev_£t_queue_c⁄åﬁ
(
ev
, 
SND_SEQ_EVENT_CONTINUE
, 
q
, 0)

	)

273 
	#¢d_£q_ev_£t_queue_ãmpo
(
ev
, 
q
, 
vÆ
) \

274 
	`¢d_£q_ev_£t_queue_c⁄åﬁ
(
ev
, 
SND_SEQ_EVENT_TEMPO
, 
q
, 
vÆ
)

	)

282 
	#¢d_£q_ev_£t_queue_pos_ªÆ
(
ev
, 
q
, 
πime
) \

283 ((
ev
)->
ty≥
 = 
SND_SEQ_EVENT_SETPOS_TIME
,\

284 
	`¢d_£q_ev_£t_de°
(
ev
, 
SND_SEQ_CLIENT_SYSTEM
, 
SND_SEQ_PORT_SYSTEM_TIMER
),\

285 (
ev
)->
d©a
.
queue
.queuê(
q
),\

286 (
ev
)->
d©a
.
queue
.
∑øm
.
time
.timê*(
πime
))

	)

294 
	#¢d_£q_ev_£t_queue_pos_tick
(
ev
, 
q
, 
âime
) \

295 ((
ev
)->
ty≥
 = 
SND_SEQ_EVENT_SETPOS_TICK
,\

296 
	`¢d_£q_ev_£t_de°
(
ev
, 
SND_SEQ_CLIENT_SYSTEM
, 
SND_SEQ_PORT_SYSTEM_TIMER
),\

297 (
ev
)->
d©a
.
queue
.queuê(
q
),\

298 (
ev
)->
d©a
.
queue
.
∑øm
.
time
.
tick
 = (
âime
))

	)

304 
ölöe
 
¢d_£q_ev_£t_ump
(
¢d_£q_ump_evít_t
 *
ev
)

306 
ev
->
Êags
 |
SND_SEQ_EVENT_UMP
;

307 
ev
->
ty≥
 = 0;

316 
ölöe
 
¢d_£q_ev_£t_ump_d©a
(
¢d_£q_ump_evít_t
 *
ev
, *
d©a
, 
size_t
 
byãs
)

318 i‡(
byãs
 > 16)

319  -
EINVAL
;

320 
¢d_£q_ev_£t_ump
(
ev
);

321 
mem˝y
(
ev
->
ump
, 
d©a
, 
byãs
);

326 
¢d_£q_c⁄åﬁ_queue
(
¢d_£q_t
 *
£q
, 
q
, 
ty≥
, 
vÆue
, 
¢d_£q_evít_t
 *
ev
);

334 
	#¢d_£q_°¨t_queue
(
£q
, 
q
, 
ev
) \

335 
	`¢d_£q_c⁄åﬁ_queue
(
£q
, 
q
, 
SND_SEQ_EVENT_START
, 0, 
ev
)

	)

343 
	#¢d_£q_°›_queue
(
£q
, 
q
, 
ev
) \

344 
	`¢d_£q_c⁄åﬁ_queue
(
£q
, 
q
, 
SND_SEQ_EVENT_STOP
, 0, 
ev
)

	)

352 
	#¢d_£q_c⁄töue_queue
(
£q
, 
q
, 
ev
) \

353 
	`¢d_£q_c⁄åﬁ_queue
(
£q
, 
q
, 
SND_SEQ_EVENT_CONTINUE
, 0, 
ev
)

	)

362 
	#¢d_£q_ch™ge_queue_ãmpo
(
£q
, 
q
, 
ãmpo
, 
ev
) \

363 
	`¢d_£q_c⁄åﬁ_queue
(
£q
, 
q
, 
SND_SEQ_EVENT_TEMPO
, 
ãmpo
, 
ev
)

	)

366 
¢d_£q_¸óã_sim∂e_p‹t
(
¢d_£q_t
 *
£q
, c⁄° *
«me
,

367 
ˇps
, 
ty≥
);

369 
¢d_£q_dñëe_sim∂e_p‹t
(
¢d_£q_t
 *
£q
, 
p‹t
);

374 
¢d_£q_c⁄√˘_‰om
(
¢d_£q_t
 *
£q
, 
my_p‹t
, 
§c_˛õ¡
, 
§c_p‹t
);

375 
¢d_£q_c⁄√˘_to
(
¢d_£q_t
 *
£q
, 
my_p‹t
, 
de°_˛õ¡
, 
de°_p‹t
);

376 
¢d_£q_disc⁄√˘_‰om
(
¢d_£q_t
 *
£q
, 
my_p‹t
, 
§c_˛õ¡
, 
§c_p‹t
);

377 
¢d_£q_disc⁄√˘_to
(
¢d_£q_t
 *
£q
, 
my_p‹t
, 
de°_˛õ¡
, 
de°_p‹t
);

382 
¢d_£q_£t_˛õ¡_«me
(
¢d_£q_t
 *
£q
, c⁄° *
«me
);

383 
¢d_£q_£t_˛õ¡_evít_fûãr
(
¢d_£q_t
 *
£q
, 
evít_ty≥
);

384 
¢d_£q_£t_˛õ¡_midi_vîsi⁄
(
¢d_£q_t
 *
£q
, 
midi_vîsi⁄
);

385 
¢d_£q_£t_˛õ¡_ump_c⁄vîsi⁄
(
¢d_£q_t
 *
£q
, 
íabÀ
);

386 
¢d_£q_£t_˛õ¡_poﬁ_ouçut
(
¢d_£q_t
 *
£q
, 
size_t
 
size
);

387 
¢d_£q_£t_˛õ¡_poﬁ_ouçut_room
(
¢d_£q_t
 *
£q
, 
size_t
 
size
);

388 
¢d_£q_£t_˛õ¡_poﬁ_öput
(
¢d_£q_t
 *
£q
, 
size_t
 
size
);

390 
¢d_£q_sync_ouçut_queue
(
¢d_£q_t
 *
£q
);

395 
¢d_£q_∑r£_addªss
(
¢d_£q_t
 *
£q
, 
¢d_£q_addr_t
 *
addr
, c⁄° *
°r
);

400 
¢d_£q_ª£t_poﬁ_ouçut
(
¢d_£q_t
 *
£q
);

401 
¢d_£q_ª£t_poﬁ_öput
(
¢d_£q_t
 *
£q
);

411 
	#¢d_£q_ev_£t_nŸe
(
ev
, 
ch
, 
key
, 
vñ
, 
dur
) \

412 ((
ev
)->
ty≥
 = 
SND_SEQ_EVENT_NOTE
,\

413 
	`¢d_£q_ev_£t_fixed
(
ev
),\

414 (
ev
)->
d©a
.
nŸe
.
ch™√l
 = (
ch
),\

415 (
ev
)->
d©a
.
nŸe
.nŸê(
key
),\

416 (
ev
)->
d©a
.
nŸe
.
vñocôy
 = (
vñ
),\

417 (
ev
)->
d©a
.
nŸe
.
duøti⁄
 = (
dur
))

	)

426 
	#¢d_£q_ev_£t_nŸe⁄
(
ev
, 
ch
, 
key
, 
vñ
) \

427 ((
ev
)->
ty≥
 = 
SND_SEQ_EVENT_NOTEON
,\

428 
	`¢d_£q_ev_£t_fixed
(
ev
),\

429 (
ev
)->
d©a
.
nŸe
.
ch™√l
 = (
ch
),\

430 (
ev
)->
d©a
.
nŸe
.nŸê(
key
),\

431 (
ev
)->
d©a
.
nŸe
.
vñocôy
 = (
vñ
))

	)

440 
	#¢d_£q_ev_£t_nŸeoff
(
ev
, 
ch
, 
key
, 
vñ
) \

441 ((
ev
)->
ty≥
 = 
SND_SEQ_EVENT_NOTEOFF
,\

442 
	`¢d_£q_ev_£t_fixed
(
ev
),\

443 (
ev
)->
d©a
.
nŸe
.
ch™√l
 = (
ch
),\

444 (
ev
)->
d©a
.
nŸe
.nŸê(
key
),\

445 (
ev
)->
d©a
.
nŸe
.
vñocôy
 = (
vñ
))

	)

454 
	#¢d_£q_ev_£t_key¥ess
(
ev
,
ch
,
key
,
vñ
) \

455 ((
ev
)->
ty≥
 = 
SND_SEQ_EVENT_KEYPRESS
,\

456 
	`¢d_£q_ev_£t_fixed
(
ev
),\

457 (
ev
)->
d©a
.
nŸe
.
ch™√l
 = (
ch
),\

458 (
ev
)->
d©a
.
nŸe
.nŸê(
key
),\

459 (
ev
)->
d©a
.
nŸe
.
vñocôy
 = (
vñ
))

	)

468 
	#¢d_£q_ev_£t_c⁄åﬁÀr
(
ev
,
ch
,
cc
,
vÆ
) \

469 ((
ev
)->
ty≥
 = 
SND_SEQ_EVENT_CONTROLLER
,\

470 
	`¢d_£q_ev_£t_fixed
(
ev
),\

471 (
ev
)->
d©a
.
c⁄åﬁ
.
ch™√l
 = (
ch
),\

472 (
ev
)->
d©a
.
c⁄åﬁ
.
∑øm
 = (
cc
),\

473 (
ev
)->
d©a
.
c⁄åﬁ
.
vÆue
 = (
vÆ
))

	)

481 
	#¢d_£q_ev_£t_pgmch™ge
(
ev
,
ch
,
vÆ
) \

482 ((
ev
)->
ty≥
 = 
SND_SEQ_EVENT_PGMCHANGE
,\

483 
	`¢d_£q_ev_£t_fixed
(
ev
),\

484 (
ev
)->
d©a
.
c⁄åﬁ
.
ch™√l
 = (
ch
),\

485 (
ev
)->
d©a
.
c⁄åﬁ
.
vÆue
 = (
vÆ
))

	)

493 
	#¢d_£q_ev_£t_pôchbíd
(
ev
,
ch
,
vÆ
) \

494 ((
ev
)->
ty≥
 = 
SND_SEQ_EVENT_PITCHBEND
,\

495 
	`¢d_£q_ev_£t_fixed
(
ev
),\

496 (
ev
)->
d©a
.
c⁄åﬁ
.
ch™√l
 = (
ch
),\

497 (
ev
)->
d©a
.
c⁄åﬁ
.
vÆue
 = (
vÆ
))

	)

505 
	#¢d_£q_ev_£t_ch™¥ess
(
ev
,
ch
,
vÆ
) \

506 ((
ev
)->
ty≥
 = 
SND_SEQ_EVENT_CHANPRESS
,\

507 
	`¢d_£q_ev_£t_fixed
(
ev
),\

508 (
ev
)->
d©a
.
c⁄åﬁ
.
ch™√l
 = (
ch
),\

509 (
ev
)->
d©a
.
c⁄åﬁ
.
vÆue
 = (
vÆ
))

	)

519 
	#¢d_£q_ev_£t_sy£x
(
ev
,
d©Æí
,
d©≠å
) \

520 ((
ev
)->
ty≥
 = 
SND_SEQ_EVENT_SYSEX
,\

521 
	`¢d_£q_ev_£t_v¨übÀ
(
ev
, 
d©Æí
, 
d©≠å
))

	)

525 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asequencer.h

1 
	~<Æß/sound/u≠i/a£quí˚r.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asoc.h

1 
	~<Æß/sound/u≠i/asoc.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asound.h

2 
	~<Æß/sound/ty≥_com∑t.h
>

4 
	~<Æß/sound/u≠i/asound.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asound_fm.h

1 
	~<Æß/sound/u≠i/asound_fm.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/emu10k1.h

1 
	~<Æß/sound/ty≥_com∑t.h
>

2 
	~<Æß/sound/u≠i/emu10k1.h
>

3 #i‚de‡
__emu10k1_ty≥_deföed


4 
	#__emu10k1_ty≥_deföed


	)

5 
¢d_emu10k1_fx8010_öfo
 
	temu10k1_fx8010_öfo_t
;

6 
¢d_emu10k1_fx8010_c⁄åﬁ_g¥
 
	temu10k1_fx8010_c⁄åﬁ_g¥_t
;

7 
¢d_emu10k1_fx8010_code
 
	temu10k1_fx8010_code_t
;

8 
¢d_emu10k1_fx8010_åam
 
	temu10k1_fx8010_åam_t
;

9 
¢d_emu10k1_fx8010_pcm_ªc
 
	temu10k1_fx8010_pcm_t
;

10 
emu10k1_˘l_ñem_id
 
	temu10k1_˘l_ñem_id_t
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/hdsp.h

1 
	~<Æß/sound/ty≥_com∑t.h
>

2 
	~<Æß/sound/u≠i/hd•.h
>

3 #i‚de‡
__hd•_ty≥_deföed


4 
	#__hd•_ty≥_deföed


	)

5 
HDSP_IO_Ty≥
 
	tHDSP_IO_Ty≥
;

6 
hd•_≥ak_rms
 
	thd•_≥ak_rms_t
;

7 
hd•_c⁄fig_öfo
 
	thd•_c⁄fig_öfo_t
;

8 
hd•_fúmw¨e
 
	thd•_fúmw¨e_t
;

9 
hd•_vîsi⁄
 
	thd•_vîsi⁄_t
;

10 
hd•_mixî
 
	thd•_mixî_t
;

11 
hd•_9632_´b
 
	thd•_9632_´b_t
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/hdspm.h

1 
	~<Æß/sound/ty≥_com∑t.h
>

2 
	~<Æß/sound/u≠i/hd•m.h
>

3 #i‚de‡
__hd•m_ty≥_deföed


4 
	#__hd•m_ty≥_deföed


	)

5 
hd•m_≥ak_rms
 
	thd•m_≥ak_rms_t
;

6 
hd•m_c⁄fig_öfo
 
	thd•m_c⁄fig_öfo_t
;

7 
hd•m_vîsi⁄
 
	thd•m_vîsi⁄_t
;

8 
hd•m_ch™√lÁdî
 
	t¢d_hd•m_ch™√lÁdî_t
;

9 
hd•m_mixî
 
	thd•m_mixî_t
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/sb16_csp.h

1 
	~<Æß/sound/u≠i/sb16_c•.h
>

2 #i‚de‡
__sb16_c•_ty≥_deföed


3 
	#__sb16_c•_ty≥_deföed


	)

4 
¢d_sb_c•_mi¸ocode
 
	t¢d_sb_c•_mi¸ocode_t
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/sscape_ioctl.h

1 
	~<Æß/sound/u≠i/ssˇ≥_io˘l.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/tlv.h

1 
	~<Æß/sound/u≠i/év.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/type_compat.h

1 #i‚de‡
__SOUND_TYPE_COMPAT_H


2 
	#__SOUND_TYPE_COMPAT_H


	)

4 #i‚de‡
DOC_HIDDEN


5 
	~<°döt.h
>

6 #i‡
deföed
(
__löux__
)

7 
	~<löux/ty≥s.h
>

9 
uöt8_t
 
	t__u8
;

10 
uöt16_t
 
	t__u16
;

11 
uöt32_t
 
	t__u32
;

12 
uöt64_t
 
	t__u64
;

13 
öt8_t
 
	t__s8
;

14 
öt16_t
 
	t__s16
;

15 
öt32_t
 
	t__s32
;

16 
öt64_t
 
	t__s64
;

18 #i‡
deföed
(
__sun
)

19 
	~<sys/byã‹dî.h
>

20 
	#__˝u_to_À32
 
	`LE_32
(
x
)

	)

21 
	#__˝u_to_be32
 
	`BE_32
(
x
)

	)

22 
	#__˝u_to_À16
 
	`LE_16
(
x
)

	)

23 
	#__˝u_to_be16
 
	`BE_16
(
x
)

	)

25 
	~<sys/ídün.h
>

26 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


27 
	#__˝u_to_À32
(
x
Ë(x)

	)

28 
	#__˝u_to_be32
(
x
Ë
	`bsw≠_32
(x)

	)

29 
	#__˝u_to_À16
(
x
Ë(x)

	)

30 
	#__˝u_to_be16
(
x
Ë
	`bsw≠_16
(x)

	)

32 
	#__˝u_to_À32
(
x
Ë
	`bsw≠_32
(x)

	)

33 
	#__˝u_to_be32
(
x
Ë(x)

	)

34 
	#__˝u_to_À16
(
x
Ë
	`bsw≠_16
(x)

	)

35 
	#__˝u_to_be16
(
x
Ë(x)

	)

39 
	#__À32_to_˝u
 
__˝u_to_À32


	)

40 
	#__be32_to_˝u
 
__˝u_to_be32


	)

41 
	#__À16_to_˝u
 
__˝u_to_À16


	)

42 
	#__be16_to_˝u
 
__˝u_to_be16


	)

45 #i‚de‡
__kî√l_l⁄g_t


46 
	#__kî√l_l⁄g_t
 

	)

49 #i‚de‡
__u£r


50 
	#__u£r


	)

53 #i‚de‡
__∑cked


54 
	#__∑cked
 
	`__©åibuã__
((
__∑cked__
))

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asequencer.h

23 #i‚de‡
__SOUND_ASEQUENCER_H


24 
	#__SOUND_ASEQUENCER_H


	)

26 
	~<sound/asound.h
>

29 
	#SNDRV_SEQ_VERSION
 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 3)

	)

38 
	#SNDRV_SEQ_EVENT_SYSTEM
 0

	)

39 
	#SNDRV_SEQ_EVENT_RESULT
 1

	)

44 
	#SNDRV_SEQ_EVENT_NOTE
 5

	)

45 
	#SNDRV_SEQ_EVENT_NOTEON
 6

	)

46 
	#SNDRV_SEQ_EVENT_NOTEOFF
 7

	)

47 
	#SNDRV_SEQ_EVENT_KEYPRESS
 8

	)

52 
	#SNDRV_SEQ_EVENT_CONTROLLER
 10

	)

53 
	#SNDRV_SEQ_EVENT_PGMCHANGE
 11

	)

54 
	#SNDRV_SEQ_EVENT_CHANPRESS
 12

	)

55 
	#SNDRV_SEQ_EVENT_PITCHBEND
 13

	)

56 
	#SNDRV_SEQ_EVENT_CONTROL14
 14

	)

57 
	#SNDRV_SEQ_EVENT_NONREGPARAM
 15

	)

58 
	#SNDRV_SEQ_EVENT_REGPARAM
 16

	)

63 
	#SNDRV_SEQ_EVENT_SONGPOS
 20

	)

64 
	#SNDRV_SEQ_EVENT_SONGSEL
 21

	)

65 
	#SNDRV_SEQ_EVENT_QFRAME
 22

	)

66 
	#SNDRV_SEQ_EVENT_TIMESIGN
 23

	)

67 
	#SNDRV_SEQ_EVENT_KEYSIGN
 24

	)

72 
	#SNDRV_SEQ_EVENT_START
 30

	)

73 
	#SNDRV_SEQ_EVENT_CONTINUE
 31

	)

74 
	#SNDRV_SEQ_EVENT_STOP
 32

	)

75 
	#SNDRV_SEQ_EVENT_SETPOS_TICK
 33

	)

76 
	#SNDRV_SEQ_EVENT_SETPOS_TIME
 34

	)

77 
	#SNDRV_SEQ_EVENT_TEMPO
 35

	)

78 
	#SNDRV_SEQ_EVENT_CLOCK
 36

	)

79 
	#SNDRV_SEQ_EVENT_TICK
 37

	)

80 
	#SNDRV_SEQ_EVENT_QUEUE_SKEW
 38

	)

85 
	#SNDRV_SEQ_EVENT_TUNE_REQUEST
 40

	)

86 
	#SNDRV_SEQ_EVENT_RESET
 41

	)

87 
	#SNDRV_SEQ_EVENT_SENSING
 42

	)

92 
	#SNDRV_SEQ_EVENT_ECHO
 50

	)

93 
	#SNDRV_SEQ_EVENT_OSS
 51

	)

98 
	#SNDRV_SEQ_EVENT_CLIENT_START
 60

	)

99 
	#SNDRV_SEQ_EVENT_CLIENT_EXIT
 61

	)

100 
	#SNDRV_SEQ_EVENT_CLIENT_CHANGE
 62

	)

101 
	#SNDRV_SEQ_EVENT_PORT_START
 63

	)

102 
	#SNDRV_SEQ_EVENT_PORT_EXIT
 64

	)

103 
	#SNDRV_SEQ_EVENT_PORT_CHANGE
 65

	)

108 
	#SNDRV_SEQ_EVENT_PORT_SUBSCRIBED
 66

	)

109 
	#SNDRV_SEQ_EVENT_PORT_UNSUBSCRIBED
 67

	)

116 
	#SNDRV_SEQ_EVENT_USR0
 90

	)

117 
	#SNDRV_SEQ_EVENT_USR1
 91

	)

118 
	#SNDRV_SEQ_EVENT_USR2
 92

	)

119 
	#SNDRV_SEQ_EVENT_USR3
 93

	)

120 
	#SNDRV_SEQ_EVENT_USR4
 94

	)

121 
	#SNDRV_SEQ_EVENT_USR5
 95

	)

122 
	#SNDRV_SEQ_EVENT_USR6
 96

	)

123 
	#SNDRV_SEQ_EVENT_USR7
 97

	)

124 
	#SNDRV_SEQ_EVENT_USR8
 98

	)

125 
	#SNDRV_SEQ_EVENT_USR9
 99

	)

134 
	#SNDRV_SEQ_EVENT_SYSEX
 130

	)

135 
	#SNDRV_SEQ_EVENT_BOUNCE
 131

	)

137 
	#SNDRV_SEQ_EVENT_USR_VAR0
 135

	)

138 
	#SNDRV_SEQ_EVENT_USR_VAR1
 136

	)

139 
	#SNDRV_SEQ_EVENT_USR_VAR2
 137

	)

140 
	#SNDRV_SEQ_EVENT_USR_VAR3
 138

	)

141 
	#SNDRV_SEQ_EVENT_USR_VAR4
 139

	)

144 
	#SNDRV_SEQ_EVENT_KERNEL_ERROR
 150

	)

145 
	#SNDRV_SEQ_EVENT_KERNEL_QUOTE
 151

	)

152 
	#SNDRV_SEQ_EVENT_NONE
 255

	)

155 
	t¢d_£q_evít_ty≥_t
;

158 
	s¢d_£q_addr
 {

159 
	m˛õ¡
;

160 
	mp‹t
;

164 
	s¢d_£q_c⁄√˘
 {

165 
¢d_£q_addr
 
	m£ndî
;

166 
¢d_£q_addr
 
	mde°
;

170 
	#SNDRV_SEQ_ADDRESS_UNKNOWN
 253

	)

171 
	#SNDRV_SEQ_ADDRESS_SUBSCRIBERS
 254

	)

172 
	#SNDRV_SEQ_ADDRESS_BROADCAST
 255

	)

173 
	#SNDRV_SEQ_QUEUE_DIRECT
 253

	)

176 
	#SNDRV_SEQ_TIME_STAMP_TICK
 (0<<0Ë

	)

177 
	#SNDRV_SEQ_TIME_STAMP_REAL
 (1<<0Ë

	)

178 
	#SNDRV_SEQ_TIME_STAMP_MASK
 (1<<0)

	)

180 
	#SNDRV_SEQ_TIME_MODE_ABS
 (0<<1Ë

	)

181 
	#SNDRV_SEQ_TIME_MODE_REL
 (1<<1Ë

	)

182 
	#SNDRV_SEQ_TIME_MODE_MASK
 (1<<1)

	)

184 
	#SNDRV_SEQ_EVENT_LENGTH_FIXED
 (0<<2Ë

	)

185 
	#SNDRV_SEQ_EVENT_LENGTH_VARIABLE
 (1<<2Ë

	)

186 
	#SNDRV_SEQ_EVENT_LENGTH_VARUSR
 (2<<2Ë

	)

187 
	#SNDRV_SEQ_EVENT_LENGTH_MASK
 (3<<2)

	)

189 
	#SNDRV_SEQ_PRIORITY_NORMAL
 (0<<4Ë

	)

190 
	#SNDRV_SEQ_PRIORITY_HIGH
 (1<<4Ë

	)

191 
	#SNDRV_SEQ_PRIORITY_MASK
 (1<<4)

	)

193 
	#SNDRV_SEQ_EVENT_UMP
 (1<<5Ë

	)

196 
	s¢d_£q_ev_nŸe
 {

197 
	mch™√l
;

198 
	mnŸe
;

199 
	mvñocôy
;

200 
	moff_vñocôy
;

201 
	mduøti⁄
;

205 
	s¢d_£q_ev_˘æ
 {

206 
	mch™√l
;

207 
	munu£d1
, 
	munu£d2
, 
	munu£d3
;

208 
	m∑øm
;

209 sig√d 
	mvÆue
;

213 
	s¢d_£q_ev_øw8
 {

214 
	md
[12];

218 
	s¢d_£q_ev_øw32
 {

219 
	md
[3];

223 
	s¢d_£q_ev_ext
 {

224 
	mÀn
;

225 *
	m±r
;

226 } 
__©åibuã__
((
∑cked
));

228 
	s¢d_£q_ªsu…
 {

229 
	mevít
;

230 
	mªsu…
;

234 
	s¢d_£q_ªÆ_time
 {

235 
	mtv_£c
;

236 
	mtv_n£c
;

239 
	t¢d_£q_tick_time_t
;

241 
	u¢d_£q_time°amp
 {

242 
¢d_£q_tick_time_t
 
	mtick
;

243 
¢d_£q_ªÆ_time
 
	mtime
;

246 
	s¢d_£q_queue_skew
 {

247 
	mvÆue
;

248 
	mba£
;

252 
	s¢d_£q_ev_queue_c⁄åﬁ
 {

253 
	mqueue
;

254 
	m∑d
[3];

256 sig√d 
	mvÆue
;

257 
¢d_£q_time°amp
 
	mtime
;

258 
	mposôi⁄
;

259 
¢d_£q_queue_skew
 
	mskew
;

260 
	md32
[2];

261 
	md8
[8];

262 } 
	m∑øm
;

266 
	s¢d_£q_ev_quŸe
 {

267 
¢d_£q_addr
 
	m‹igö
;

268 
	mvÆue
;

269 
¢d_£q_evít
 *
	mevít
;

270 } 
__©åibuã__
((
∑cked
));

272 
	u¢d_£q_evít_d©a
 {

273 
¢d_£q_ev_nŸe
 
	mnŸe
;

274 
¢d_£q_ev_˘æ
 
	mc⁄åﬁ
;

275 
¢d_£q_ev_øw8
 
	møw8
;

276 
¢d_£q_ev_øw32
 
	møw32
;

277 
¢d_£q_ev_ext
 
	mext
;

278 
¢d_£q_ev_queue_c⁄åﬁ
 
	mqueue
;

279 
¢d_£q_time°amp
 
	mtime
;

280 
¢d_£q_addr
 
	maddr
;

281 
¢d_£q_c⁄√˘
 
	mc⁄√˘
;

282 
¢d_£q_ªsu…
 
	mªsu…
;

283 
¢d_£q_ev_quŸe
 
	mquŸe
;

287 
	s¢d_£q_evít
 {

288 
¢d_£q_evít_ty≥_t
 
	mty≥
;

289 
	mÊags
;

290 
	mèg
;

292 
	mqueue
;

293 
¢d_£q_time°amp
 
	mtime
;

295 
¢d_£q_addr
 
	msour˚
;

296 
¢d_£q_addr
 
	mde°
;

298 
¢d_£q_evít_d©a
 
	md©a
;

302 
	s¢d_£q_ump_evít
 {

303 
¢d_£q_evít_ty≥_t
 
	mty≥
;

304 
	mÊags
;

305 
	mèg
;

306 
	mqueue
;

307 
¢d_£q_time°amp
 
	mtime
;

308 
¢d_£q_addr
 
	msour˚
;

309 
¢d_£q_addr
 
	mde°
;

312 
¢d_£q_evít_d©a
 
	md©a
;

313 
	mump
[4];

320 
	s¢d_£q_evít_boun˚
 {

321 
	mîr
;

322 
¢d_£q_evít
 
	mevít
;

328 
	s¢d_£q_sy°em_öfo
 {

329 
	mqueues
;

330 
	m˛õ¡s
;

331 
	mp‹ts
;

332 
	mch™√ls
;

333 
	mcur_˛õ¡s
;

334 
	mcur_queues
;

335 
	mª£rved
[24];

340 
	s¢d_£q_ru¬ög_öfo
 {

341 
	m˛õ¡
;

342 
	mbig_ídün
;

343 
	m˝u_mode
;

344 
	m∑d
;

345 
	mª£rved
[12];

350 
	#SNDRV_SEQ_CLIENT_SYSTEM
 0

	)

352 
	#SNDRV_SEQ_CLIENT_DUMMY
 14

	)

353 
	#SNDRV_SEQ_CLIENT_OSS
 15

	)

357 
	t__bôwi£
 
	t¢d_£q_˛õ¡_ty≥_t
;

358 
	#NO_CLIENT
 ((
¢d_£q_˛õ¡_ty≥_t
Ë0)

	)

359 
	#USER_CLIENT
 ((
¢d_£q_˛õ¡_ty≥_t
Ë1)

	)

360 
	#KERNEL_CLIENT
 ((
¢d_£q_˛õ¡_ty≥_t
Ë2)

	)

363 
	#SNDRV_SEQ_FILTER_BROADCAST
 (1U<<0Ë

	)

364 
	#SNDRV_SEQ_FILTER_MULTICAST
 (1U<<1Ë

	)

365 
	#SNDRV_SEQ_FILTER_BOUNCE
 (1U<<2Ë

	)

366 
	#SNDRV_SEQ_FILTER_NO_CONVERT
 (1U<<30Ë

	)

367 
	#SNDRV_SEQ_FILTER_USE_EVENT
 (1U<<31Ë

	)

369 
	s¢d_£q_˛õ¡_öfo
 {

370 
	m˛õ¡
;

371 
¢d_£q_˛õ¡_ty≥_t
 
	mty≥
;

372 
	m«me
[64];

373 
	mfûãr
;

374 
	mmu…iˇ°_fûãr
[8];

375 
	mevít_fûãr
[32];

376 
	mnum_p‹ts
;

377 
	mevít_lo°
;

378 
	mˇrd
;

379 
	mpid
;

380 
	mmidi_vîsi⁄
;

381 
	mgroup_fûãr
;

385 
	mª£rved
[48];

389 
	#SNDRV_SEQ_CLIENT_LEGACY_MIDI
 0

	)

390 
	#SNDRV_SEQ_CLIENT_UMP_MIDI_1_0
 1

	)

391 
	#SNDRV_SEQ_CLIENT_UMP_MIDI_2_0
 2

	)

394 
	s¢d_£q_˛õ¡_poﬁ
 {

395 
	m˛õ¡
;

396 
	mouçut_poﬁ
;

397 
	möput_poﬁ
;

398 
	mouçut_room
;

399 
	mouçut_‰ì
;

400 
	möput_‰ì
;

401 
	mª£rved
[64];

407 
	#SNDRV_SEQ_REMOVE_INPUT
 (1<<0Ë

	)

408 
	#SNDRV_SEQ_REMOVE_OUTPUT
 (1<<1Ë

	)

409 
	#SNDRV_SEQ_REMOVE_DEST
 (1<<2Ë

	)

410 
	#SNDRV_SEQ_REMOVE_DEST_CHANNEL
 (1<<3Ë

	)

411 
	#SNDRV_SEQ_REMOVE_TIME_BEFORE
 (1<<4Ë

	)

412 
	#SNDRV_SEQ_REMOVE_TIME_AFTER
 (1<<5Ë

	)

413 
	#SNDRV_SEQ_REMOVE_TIME_TICK
 (1<<6Ë

	)

414 
	#SNDRV_SEQ_REMOVE_EVENT_TYPE
 (1<<7Ë

	)

415 
	#SNDRV_SEQ_REMOVE_IGNORE_OFF
 (1<<8Ë

	)

416 
	#SNDRV_SEQ_REMOVE_TAG_MATCH
 (1<<9Ë

	)

418 
	s¢d_£q_ªmove_evíts
 {

419 
	mªmove_mode
;

421 
¢d_£q_time°amp
 
	mtime
;

423 
	mqueue
;

424 
¢d_£q_addr
 
	mde°
;

425 
	mch™√l
;

427 
	mty≥
;

428 
	mèg
;

430 
	mª£rved
[10];

436 
	#SNDRV_SEQ_PORT_SYSTEM_TIMER
 0

	)

437 
	#SNDRV_SEQ_PORT_SYSTEM_ANNOUNCE
 1

	)

440 
	#SNDRV_SEQ_PORT_CAP_READ
 (1<<0Ë

	)

441 
	#SNDRV_SEQ_PORT_CAP_WRITE
 (1<<1Ë

	)

443 
	#SNDRV_SEQ_PORT_CAP_SYNC_READ
 (1<<2)

	)

444 
	#SNDRV_SEQ_PORT_CAP_SYNC_WRITE
 (1<<3)

	)

446 
	#SNDRV_SEQ_PORT_CAP_DUPLEX
 (1<<4)

	)

448 
	#SNDRV_SEQ_PORT_CAP_SUBS_READ
 (1<<5Ë

	)

449 
	#SNDRV_SEQ_PORT_CAP_SUBS_WRITE
 (1<<6Ë

	)

450 
	#SNDRV_SEQ_PORT_CAP_NO_EXPORT
 (1<<7Ë

	)

451 
	#SNDRV_SEQ_PORT_CAP_INACTIVE
 (1<<8Ë

	)

452 
	#SNDRV_SEQ_PORT_CAP_UMP_ENDPOINT
 (1<<9Ë

	)

455 
	#SNDRV_SEQ_PORT_TYPE_SPECIFIC
 (1<<0Ë

	)

456 
	#SNDRV_SEQ_PORT_TYPE_MIDI_GENERIC
 (1<<1Ë

	)

457 
	#SNDRV_SEQ_PORT_TYPE_MIDI_GM
 (1<<2Ë

	)

458 
	#SNDRV_SEQ_PORT_TYPE_MIDI_GS
 (1<<3Ë

	)

459 
	#SNDRV_SEQ_PORT_TYPE_MIDI_XG
 (1<<4Ë

	)

460 
	#SNDRV_SEQ_PORT_TYPE_MIDI_MT32
 (1<<5Ë

	)

461 
	#SNDRV_SEQ_PORT_TYPE_MIDI_GM2
 (1<<6Ë

	)

462 
	#SNDRV_SEQ_PORT_TYPE_MIDI_UMP
 (1<<7Ë

	)

465 
	#SNDRV_SEQ_PORT_TYPE_SYNTH
 (1<<10Ë

	)

466 
	#SNDRV_SEQ_PORT_TYPE_DIRECT_SAMPLE
 (1<<11Ë

	)

467 
	#SNDRV_SEQ_PORT_TYPE_SAMPLE
 (1<<12Ë

	)

469 
	#SNDRV_SEQ_PORT_TYPE_HARDWARE
 (1<<16Ë

	)

470 
	#SNDRV_SEQ_PORT_TYPE_SOFTWARE
 (1<<17Ë

	)

471 
	#SNDRV_SEQ_PORT_TYPE_SYNTHESIZER
 (1<<18Ë

	)

472 
	#SNDRV_SEQ_PORT_TYPE_PORT
 (1<<19Ë

	)

473 
	#SNDRV_SEQ_PORT_TYPE_APPLICATION
 (1<<20Ë

	)

476 
	#SNDRV_SEQ_PORT_FLG_GIVEN_PORT
 (1<<0)

	)

477 
	#SNDRV_SEQ_PORT_FLG_TIMESTAMP
 (1<<1)

	)

478 
	#SNDRV_SEQ_PORT_FLG_TIME_REAL
 (1<<2)

	)

481 
	#SNDRV_SEQ_PORT_DIR_UNKNOWN
 0

	)

482 
	#SNDRV_SEQ_PORT_DIR_INPUT
 1

	)

483 
	#SNDRV_SEQ_PORT_DIR_OUTPUT
 2

	)

484 
	#SNDRV_SEQ_PORT_DIR_BIDIRECTION
 3

	)

486 
	s¢d_£q_p‹t_öfo
 {

487 
¢d_£q_addr
 
	maddr
;

488 
	m«me
[64];

490 
	mˇ∑bûôy
;

491 
	mty≥
;

492 
	mmidi_ch™√ls
;

493 
	mmidi_voi˚s
;

494 
	msy¡h_voi˚s
;

496 
	mªad_u£
;

497 
	mwrôe_u£
;

499 *
	mkî√l
;

500 
	mÊags
;

501 
	mtime_queue
;

502 
	mdúe˘i⁄
;

503 
	mump_group
;

504 
	mª£rved
[57];

509 
	#SNDRV_SEQ_QUEUE_FLG_SYNC
 (1<<0Ë

	)

512 
	s¢d_£q_queue_öfo
 {

513 
	mqueue
;

519 
	mow√r
;

520 
	mlocked
:1;

521 
	m«me
[64];

522 
	mÊags
;

523 
	mª£rved
[60];

528 
	s¢d_£q_queue_°©us
 {

529 
	mqueue
;

530 
	mevíts
;

531 
¢d_£q_tick_time_t
 
	mtick
;

532 
¢d_£q_ªÆ_time
 
	mtime
;

533 
	mru¬ög
;

534 
	mÊags
;

535 
	mª£rved
[64];

540 
	s¢d_£q_queue_ãmpo
 {

541 
	mqueue
;

542 
	mãmpo
;

543 
	mµq
;

544 
	mskew_vÆue
;

545 
	mskew_ba£
;

546 
	mª£rved
[24];

551 
	#SNDRV_SEQ_TIMER_ALSA
 0

	)

552 
	#SNDRV_SEQ_TIMER_MIDI_CLOCK
 1

	)

553 
	#SNDRV_SEQ_TIMER_MIDI_TICK
 2

	)

556 
	s¢d_£q_queue_timî
 {

557 
	mqueue
;

558 
	mty≥
;

561 
¢d_timî_id
 
	mid
;

562 
	mªsﬁuti⁄
;

563 } 
	mÆß
;

564 } 
	mu
;

565 
	mª£rved
[64];

569 
	s¢d_£q_queue_˛õ¡
 {

570 
	mqueue
;

571 
	m˛õ¡
;

572 
	mu£d
;

575 
	mª£rved
[64];

579 
	#SNDRV_SEQ_PORT_SUBS_EXCLUSIVE
 (1<<0Ë

	)

580 
	#SNDRV_SEQ_PORT_SUBS_TIMESTAMP
 (1<<1)

	)

581 
	#SNDRV_SEQ_PORT_SUBS_TIME_REAL
 (1<<2)

	)

583 
	s¢d_£q_p‹t_subs¸ibe
 {

584 
¢d_£q_addr
 
	m£ndî
;

585 
¢d_£q_addr
 
	mde°
;

586 
	mvoi˚s
;

587 
	mÊags
;

588 
	mqueue
;

589 
	m∑d
[3];

590 
	mª£rved
[64];

594 
	#SNDRV_SEQ_QUERY_SUBS_READ
 0

	)

595 
	#SNDRV_SEQ_QUERY_SUBS_WRITE
 1

	)

597 
	s¢d_£q_quîy_subs
 {

598 
¢d_£q_addr
 
	mroŸ
;

599 
	mty≥
;

600 
	mödex
;

601 
	mnum_subs
;

602 
¢d_£q_addr
 
	maddr
;

603 
	mqueue
;

604 
	mÊags
;

605 
	mª£rved
[64];

612 
	#SNDRV_SEQ_CLIENT_UMP_INFO_ENDPOINT
 0

	)

613 
	#SNDRV_SEQ_CLIENT_UMP_INFO_BLOCK
 1

	)

615 
	s¢d_£q_˛õ¡_ump_öfo
 {

616 
	m˛õ¡
;

617 
	mty≥
;

618 
	möfo
[512];

619 } 
	g__∑cked
;

625 
	#SNDRV_SEQ_IOCTL_PVERSION
 
	`_IOR
 ('S', 0x00, )

	)

626 
	#SNDRV_SEQ_IOCTL_CLIENT_ID
 
	`_IOR
 ('S', 0x01, )

	)

627 
	#SNDRV_SEQ_IOCTL_SYSTEM_INFO
 
	`_IOWR
('S', 0x02, 
¢d_£q_sy°em_öfo
)

	)

628 
	#SNDRV_SEQ_IOCTL_RUNNING_MODE
 
	`_IOWR
('S', 0x03, 
¢d_£q_ru¬ög_öfo
)

	)

629 
	#SNDRV_SEQ_IOCTL_USER_PVERSION
 
	`_IOW
('S', 0x04, )

	)

631 
	#SNDRV_SEQ_IOCTL_GET_CLIENT_INFO
 
	`_IOWR
('S', 0x10, 
¢d_£q_˛õ¡_öfo
)

	)

632 
	#SNDRV_SEQ_IOCTL_SET_CLIENT_INFO
 
	`_IOW
 ('S', 0x11, 
¢d_£q_˛õ¡_öfo
)

	)

633 
	#SNDRV_SEQ_IOCTL_GET_CLIENT_UMP_INFO
 
	`_IOWR
('S', 0x12, 
¢d_£q_˛õ¡_ump_öfo
)

	)

634 
	#SNDRV_SEQ_IOCTL_SET_CLIENT_UMP_INFO
 
	`_IOWR
('S', 0x13, 
¢d_£q_˛õ¡_ump_öfo
)

	)

636 
	#SNDRV_SEQ_IOCTL_CREATE_PORT
 
	`_IOWR
('S', 0x20, 
¢d_£q_p‹t_öfo
)

	)

637 
	#SNDRV_SEQ_IOCTL_DELETE_PORT
 
	`_IOW
 ('S', 0x21, 
¢d_£q_p‹t_öfo
)

	)

638 
	#SNDRV_SEQ_IOCTL_GET_PORT_INFO
 
	`_IOWR
('S', 0x22, 
¢d_£q_p‹t_öfo
)

	)

639 
	#SNDRV_SEQ_IOCTL_SET_PORT_INFO
 
	`_IOW
 ('S', 0x23, 
¢d_£q_p‹t_öfo
)

	)

641 
	#SNDRV_SEQ_IOCTL_SUBSCRIBE_PORT
 
	`_IOW
 ('S', 0x30, 
¢d_£q_p‹t_subs¸ibe
)

	)

642 
	#SNDRV_SEQ_IOCTL_UNSUBSCRIBE_PORT
 
	`_IOW
 ('S', 0x31, 
¢d_£q_p‹t_subs¸ibe
)

	)

644 
	#SNDRV_SEQ_IOCTL_CREATE_QUEUE
 
	`_IOWR
('S', 0x32, 
¢d_£q_queue_öfo
)

	)

645 
	#SNDRV_SEQ_IOCTL_DELETE_QUEUE
 
	`_IOW
 ('S', 0x33, 
¢d_£q_queue_öfo
)

	)

646 
	#SNDRV_SEQ_IOCTL_GET_QUEUE_INFO
 
	`_IOWR
('S', 0x34, 
¢d_£q_queue_öfo
)

	)

647 
	#SNDRV_SEQ_IOCTL_SET_QUEUE_INFO
 
	`_IOWR
('S', 0x35, 
¢d_£q_queue_öfo
)

	)

648 
	#SNDRV_SEQ_IOCTL_GET_NAMED_QUEUE
 
	`_IOWR
('S', 0x36, 
¢d_£q_queue_öfo
)

	)

649 
	#SNDRV_SEQ_IOCTL_GET_QUEUE_STATUS
 
	`_IOWR
('S', 0x40, 
¢d_£q_queue_°©us
)

	)

650 
	#SNDRV_SEQ_IOCTL_GET_QUEUE_TEMPO
 
	`_IOWR
('S', 0x41, 
¢d_£q_queue_ãmpo
)

	)

651 
	#SNDRV_SEQ_IOCTL_SET_QUEUE_TEMPO
 
	`_IOW
 ('S', 0x42, 
¢d_£q_queue_ãmpo
)

	)

652 
	#SNDRV_SEQ_IOCTL_GET_QUEUE_TIMER
 
	`_IOWR
('S', 0x45, 
¢d_£q_queue_timî
)

	)

653 
	#SNDRV_SEQ_IOCTL_SET_QUEUE_TIMER
 
	`_IOW
 ('S', 0x46, 
¢d_£q_queue_timî
)

	)

654 
	#SNDRV_SEQ_IOCTL_GET_QUEUE_CLIENT
 
	`_IOWR
('S', 0x49, 
¢d_£q_queue_˛õ¡
)

	)

655 
	#SNDRV_SEQ_IOCTL_SET_QUEUE_CLIENT
 
	`_IOW
 ('S', 0x4a, 
¢d_£q_queue_˛õ¡
)

	)

656 
	#SNDRV_SEQ_IOCTL_GET_CLIENT_POOL
 
	`_IOWR
('S', 0x4b, 
¢d_£q_˛õ¡_poﬁ
)

	)

657 
	#SNDRV_SEQ_IOCTL_SET_CLIENT_POOL
 
	`_IOW
 ('S', 0x4c, 
¢d_£q_˛õ¡_poﬁ
)

	)

658 
	#SNDRV_SEQ_IOCTL_REMOVE_EVENTS
 
	`_IOW
 ('S', 0x4e, 
¢d_£q_ªmove_evíts
)

	)

659 
	#SNDRV_SEQ_IOCTL_QUERY_SUBS
 
	`_IOWR
('S', 0x4f, 
¢d_£q_quîy_subs
)

	)

660 
	#SNDRV_SEQ_IOCTL_GET_SUBSCRIPTION
 
	`_IOWR
('S', 0x50, 
¢d_£q_p‹t_subs¸ibe
)

	)

661 
	#SNDRV_SEQ_IOCTL_QUERY_NEXT_CLIENT
 
	`_IOWR
('S', 0x51, 
¢d_£q_˛õ¡_öfo
)

	)

662 
	#SNDRV_SEQ_IOCTL_QUERY_NEXT_PORT
 
	`_IOWR
('S', 0x52, 
¢d_£q_p‹t_öfo
)

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asoc.h

16 #i‚de‡
__LINUX_UAPI_SND_ASOC_H


17 
	#__LINUX_UAPI_SND_ASOC_H


	)

19 #i‡
deföed
(
__löux__
)

20 
	~<löux/ty≥s.h
>

26 
	#SND_SOC_TPLG_MAX_CHAN
 8

	)

31 
	#SND_SOC_TPLG_MAX_FORMATS
 16

	)

36 
	#SND_SOC_TPLG_STREAM_CONFIG_MAX
 8

	)

41 
	#SND_SOC_TPLG_HW_CONFIG_MAX
 8

	)

44 
	#SND_SOC_TPLG_CTL_VOLSW
 1

	)

45 
	#SND_SOC_TPLG_CTL_VOLSW_SX
 2

	)

46 
	#SND_SOC_TPLG_CTL_VOLSW_XR_SX
 3

	)

47 
	#SND_SOC_TPLG_CTL_ENUM
 4

	)

48 
	#SND_SOC_TPLG_CTL_BYTES
 5

	)

49 
	#SND_SOC_TPLG_CTL_ENUM_VALUE
 6

	)

50 
	#SND_SOC_TPLG_CTL_RANGE
 7

	)

51 
	#SND_SOC_TPLG_CTL_STROBE
 8

	)

55 
	#SND_SOC_TPLG_DAPM_CTL_VOLSW
 64

	)

56 
	#SND_SOC_TPLG_DAPM_CTL_ENUM_DOUBLE
 65

	)

57 
	#SND_SOC_TPLG_DAPM_CTL_ENUM_VIRT
 66

	)

58 
	#SND_SOC_TPLG_DAPM_CTL_ENUM_VALUE
 67

	)

59 
	#SND_SOC_TPLG_DAPM_CTL_PIN
 68

	)

62 
	#SND_SOC_TPLG_DAPM_INPUT
 0

	)

63 
	#SND_SOC_TPLG_DAPM_OUTPUT
 1

	)

64 
	#SND_SOC_TPLG_DAPM_MUX
 2

	)

65 
	#SND_SOC_TPLG_DAPM_MIXER
 3

	)

66 
	#SND_SOC_TPLG_DAPM_PGA
 4

	)

67 
	#SND_SOC_TPLG_DAPM_OUT_DRV
 5

	)

68 
	#SND_SOC_TPLG_DAPM_ADC
 6

	)

69 
	#SND_SOC_TPLG_DAPM_DAC
 7

	)

70 
	#SND_SOC_TPLG_DAPM_SWITCH
 8

	)

71 
	#SND_SOC_TPLG_DAPM_PRE
 9

	)

72 
	#SND_SOC_TPLG_DAPM_POST
 10

	)

73 
	#SND_SOC_TPLG_DAPM_AIF_IN
 11

	)

74 
	#SND_SOC_TPLG_DAPM_AIF_OUT
 12

	)

75 
	#SND_SOC_TPLG_DAPM_DAI_IN
 13

	)

76 
	#SND_SOC_TPLG_DAPM_DAI_OUT
 14

	)

77 
	#SND_SOC_TPLG_DAPM_DAI_LINK
 15

	)

78 
	#SND_SOC_TPLG_DAPM_BUFFER
 16

	)

79 
	#SND_SOC_TPLG_DAPM_SCHEDULER
 17

	)

80 
	#SND_SOC_TPLG_DAPM_EFFECT
 18

	)

81 
	#SND_SOC_TPLG_DAPM_SIGGEN
 19

	)

82 
	#SND_SOC_TPLG_DAPM_SRC
 20

	)

83 
	#SND_SOC_TPLG_DAPM_ASRC
 21

	)

84 
	#SND_SOC_TPLG_DAPM_ENCODER
 22

	)

85 
	#SND_SOC_TPLG_DAPM_DECODER
 23

	)

86 
	#SND_SOC_TPLG_DAPM_LAST
 
SND_SOC_TPLG_DAPM_DECODER


	)

89 
	#SND_SOC_TPLG_MAGIC
 0x41536F43

	)

92 
	#SND_SOC_TPLG_NUM_TEXTS
 16

	)

95 
	#SND_SOC_TPLG_ABI_VERSION
 0x5

	)

96 
	#SND_SOC_TPLG_ABI_VERSION_MIN
 0x4

	)

99 
	#SND_SOC_TPLG_TLV_SIZE
 32

	)

107 
	#SND_SOC_TPLG_TYPE_MIXER
 1

	)

108 
	#SND_SOC_TPLG_TYPE_BYTES
 2

	)

109 
	#SND_SOC_TPLG_TYPE_ENUM
 3

	)

110 
	#SND_SOC_TPLG_TYPE_DAPM_GRAPH
 4

	)

111 
	#SND_SOC_TPLG_TYPE_DAPM_WIDGET
 5

	)

112 
	#SND_SOC_TPLG_TYPE_DAI_LINK
 6

	)

113 
	#SND_SOC_TPLG_TYPE_PCM
 7

	)

114 
	#SND_SOC_TPLG_TYPE_MANIFEST
 8

	)

115 
	#SND_SOC_TPLG_TYPE_CODEC_LINK
 9

	)

116 
	#SND_SOC_TPLG_TYPE_BACKEND_LINK
 10

	)

117 
	#SND_SOC_TPLG_TYPE_PDATA
 11

	)

118 
	#SND_SOC_TPLG_TYPE_DAI
 12

	)

119 
	#SND_SOC_TPLG_TYPE_MAX
 
SND_SOC_TPLG_TYPE_DAI


	)

122 
	#SND_SOC_TPLG_TYPE_VENDOR_FW
 1000

	)

123 
	#SND_SOC_TPLG_TYPE_VENDOR_CONFIG
 1001

	)

124 
	#SND_SOC_TPLG_TYPE_VENDOR_COEFF
 1002

	)

125 
	#SND_SOC_TPLG_TYPEVENDOR_CODEC
 1003

	)

127 
	#SND_SOC_TPLG_STREAM_PLAYBACK
 0

	)

128 
	#SND_SOC_TPLG_STREAM_CAPTURE
 1

	)

131 
	#SND_SOC_TPLG_TUPLE_TYPE_UUID
 0

	)

132 
	#SND_SOC_TPLG_TUPLE_TYPE_STRING
 1

	)

133 
	#SND_SOC_TPLG_TUPLE_TYPE_BOOL
 2

	)

134 
	#SND_SOC_TPLG_TUPLE_TYPE_BYTE
 3

	)

135 
	#SND_SOC_TPLG_TUPLE_TYPE_WORD
 4

	)

136 
	#SND_SOC_TPLG_TUPLE_TYPE_SHORT
 5

	)

139 
	#SND_SOC_TPLG_DAI_FLGBIT_SYMMETRIC_RATES
 (1 << 0)

	)

140 
	#SND_SOC_TPLG_DAI_FLGBIT_SYMMETRIC_CHANNELS
 (1 << 1)

	)

141 
	#SND_SOC_TPLG_DAI_FLGBIT_SYMMETRIC_SAMPLEBITS
 (1 << 2)

	)

144 
	#SND_SOC_TPLG_DAI_CLK_GATE_UNDEFINED
 0

	)

145 
	#SND_SOC_TPLG_DAI_CLK_GATE_GATED
 1

	)

146 
	#SND_SOC_TPLG_DAI_CLK_GATE_CONT
 2

	)

149 
	#SND_SOC_TPLG_MCLK_CO
 0

	)

150 
	#SND_SOC_TPLG_MCLK_CI
 1

	)

155 
	#SND_SOC_DAI_FORMAT_I2S
 1

	)

156 
	#SND_SOC_DAI_FORMAT_RIGHT_J
 2

	)

157 
	#SND_SOC_DAI_FORMAT_LEFT_J
 3

	)

158 
	#SND_SOC_DAI_FORMAT_DSP_A
 4

	)

159 
	#SND_SOC_DAI_FORMAT_DSP_B
 5

	)

160 
	#SND_SOC_DAI_FORMAT_AC97
 6

	)

161 
	#SND_SOC_DAI_FORMAT_PDM
 7

	)

164 
	#SND_SOC_DAI_FORMAT_MSB
 
SND_SOC_DAI_FORMAT_LEFT_J


	)

165 
	#SND_SOC_DAI_FORMAT_LSB
 
SND_SOC_DAI_FORMAT_RIGHT_J


	)

168 
	#SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_RATES
 (1 << 0)

	)

169 
	#SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_CHANNELS
 (1 << 1)

	)

170 
	#SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_SAMPLEBITS
 (1 << 2)

	)

171 
	#SND_SOC_TPLG_LNK_FLGBIT_VOICE_WAKEUP
 (1 << 3)

	)

176 
	#SND_SOC_TPLG_BCLK_CP
 0

	)

177 
	#SND_SOC_TPLG_BCLK_CC
 1

	)

179 
	#SND_SOC_TPLG_BCLK_CM
 
SND_SOC_TPLG_BCLK_CP


	)

180 
	#SND_SOC_TPLG_BCLK_CS
 
SND_SOC_TPLG_BCLK_CC


	)

185 
	#SND_SOC_TPLG_FSYNC_CP
 0

	)

186 
	#SND_SOC_TPLG_FSYNC_CC
 1

	)

188 
	#SND_SOC_TPLG_FSYNC_CM
 
SND_SOC_TPLG_FSYNC_CP


	)

189 
	#SND_SOC_TPLG_FSYNC_CS
 
SND_SOC_TPLG_FSYNC_CC


	)

195 
	s¢d_soc_çlg_hdr
 {

196 
__À32
 
	mmagic
;

197 
__À32
 
	mabi
;

198 
__À32
 
	mvîsi⁄
;

199 
__À32
 
	mty≥
;

200 
__À32
 
	msize
;

201 
__À32
 
	mvíd‹_ty≥
;

202 
__À32
 
	m∑ylﬂd_size
;

203 
__À32
 
	mödex
;

204 
__À32
 
	mcou¡
;

205 } 
__©åibuã__
((
∑cked
));

208 
	s¢d_soc_çlg_víd‹_uuid_ñem
 {

209 
__À32
 
	mtokí
;

210 
	muuid
[16];

211 } 
__©åibuã__
((
∑cked
));

214 
	s¢d_soc_çlg_víd‹_vÆue_ñem
 {

215 
__À32
 
	mtokí
;

216 
__À32
 
	mvÆue
;

217 } 
__©åibuã__
((
∑cked
));

220 
	s¢d_soc_çlg_víd‹_°rög_ñem
 {

221 
__À32
 
	mtokí
;

222 
	m°rög
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

223 } 
__©åibuã__
((
∑cked
));

225 
	s¢d_soc_çlg_víd‹_¨øy
 {

226 
__À32
 
	msize
;

227 
__À32
 
	mty≥
;

228 
__À32
 
	mnum_ñems
;

230 
¢d_soc_çlg_víd‹_uuid_ñem
 
	muuid
[0];

231 
¢d_soc_çlg_víd‹_vÆue_ñem
 
	mvÆue
[0];

232 
¢d_soc_çlg_víd‹_°rög_ñem
 
	m°rög
[0];

234 } 
__©åibuã__
((
∑cked
));

241 
	s¢d_soc_çlg_¥iv©e
 {

242 
__À32
 
	msize
;

244 
	md©a
[0];

245 
¢d_soc_çlg_víd‹_¨øy
 
	m¨øy
[0];

247 } 
__©åibuã__
((
∑cked
));

252 
	s¢d_soc_çlg_év_dbsˇÀ
 {

253 
__À32
 
	mmö
;

254 
__À32
 
	m°ï
;

255 
__À32
 
	mmuã
;

256 } 
__©åibuã__
((
∑cked
));

258 
	s¢d_soc_çlg_˘l_év
 {

259 
__À32
 
	msize
;

260 
__À32
 
	mty≥
;

262 
__À32
 
	md©a
[
SND_SOC_TPLG_TLV_SIZE
];

263 
¢d_soc_çlg_év_dbsˇÀ
 
	msˇÀ
;

265 } 
__©åibuã__
((
∑cked
));

270 
	s¢d_soc_çlg_ch™√l
 {

271 
__À32
 
	msize
;

272 
__À32
 
	mªg
;

273 
__À32
 
	mshi·
;

274 
__À32
 
	mid
;

275 } 
__©åibuã__
((
∑cked
));

282 
	s¢d_soc_çlg_io_›s
 {

283 
__À32
 
	mgë
;

284 
__À32
 
	mput
;

285 
__À32
 
	möfo
;

286 } 
__©åibuã__
((
∑cked
));

291 
	s¢d_soc_çlg_˘l_hdr
 {

292 
__À32
 
	msize
;

293 
__À32
 
	mty≥
;

294 
	m«me
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

295 
__À32
 
	mac˚ss
;

296 
¢d_soc_çlg_io_›s
 
	m›s
;

297 
¢d_soc_çlg_˘l_év
 
	mév
;

298 } 
__©åibuã__
((
∑cked
));

303 
	s¢d_soc_çlg_°ªam_ˇps
 {

304 
__À32
 
	msize
;

305 
	m«me
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

306 
__À64
 
	mf‹m©s
;

307 
__À32
 
	møãs
;

308 
__À32
 
	møã_mö
;

309 
__À32
 
	møã_max
;

310 
__À32
 
	mch™√ls_mö
;

311 
__À32
 
	mch™√ls_max
;

312 
__À32
 
	m≥riods_mö
;

313 
__À32
 
	m≥riods_max
;

314 
__À32
 
	m≥riod_size_mö
;

315 
__À32
 
	m≥riod_size_max
;

316 
__À32
 
	mbuf„r_size_mö
;

317 
__À32
 
	mbuf„r_size_max
;

318 
__À32
 
	msig_bôs
;

319 } 
__©åibuã__
((
∑cked
));

324 
	s¢d_soc_çlg_°ªam
 {

325 
__À32
 
	msize
;

326 
	m«me
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

327 
__À64
 
	mf‹m©
;

328 
__À32
 
	møã
;

329 
__À32
 
	m≥riod_byãs
;

330 
__À32
 
	mbuf„r_byãs
;

331 
__À32
 
	mch™√ls
;

332 } 
__©åibuã__
((
∑cked
));

339 
	s¢d_soc_çlg_hw_c⁄fig
 {

340 
__À32
 
	msize
;

341 
__À32
 
	mid
;

342 
__À32
 
	mfmt
;

343 
__u8
 
	m˛ock_g©ed
;

344 
__u8
 
	mövît_b˛k
;

345 
__u8
 
	mövît_fsync
;

346 
__u8
 
	mb˛k_¥ovidî
;

347 
__u8
 
	mfsync_¥ovidî
;

348 
__u8
 
	mm˛k_dúe˘i⁄
;

349 
__À16
 
	mª£rved
;

350 
__À32
 
	mm˛k_øã
;

351 
__À32
 
	mb˛k_øã
;

352 
__À32
 
	mfsync_øã
;

353 
__À32
 
	mtdm_¶Ÿs
;

354 
__À32
 
	mtdm_¶Ÿ_width
;

355 
__À32
 
	mtx_¶Ÿs
;

356 
__À32
 
	mrx_¶Ÿs
;

357 
__À32
 
	mtx_ch™√ls
;

358 
__À32
 
	mtx_ch™m≠
[
SND_SOC_TPLG_MAX_CHAN
];

359 
__À32
 
	mrx_ch™√ls
;

360 
__À32
 
	mrx_ch™m≠
[
SND_SOC_TPLG_MAX_CHAN
];

361 } 
__©åibuã__
((
∑cked
));

375 
	s¢d_soc_çlg_m™i„°
 {

376 
__À32
 
	msize
;

377 
__À32
 
	mc⁄åﬁ_ñems
;

378 
__À32
 
	mwidgë_ñems
;

379 
__À32
 
	mgøph_ñems
;

380 
__À32
 
	mpcm_ñems
;

381 
__À32
 
	mdai_lök_ñems
;

382 
__À32
 
	mdai_ñems
;

383 
__À32
 
	mª£rved
[20];

384 
¢d_soc_çlg_¥iv©e
 
	m¥iv
;

385 } 
__©åibuã__
((
∑cked
));

397 
	s¢d_soc_çlg_mixî_c⁄åﬁ
 {

398 
¢d_soc_çlg_˘l_hdr
 
	mhdr
;

399 
__À32
 
	msize
;

400 
__À32
 
	mmö
;

401 
__À32
 
	mmax
;

402 
__À32
 
	m∂©f‹m_max
;

403 
__À32
 
	mövît
;

404 
__À32
 
	mnum_ch™√ls
;

405 
¢d_soc_çlg_ch™√l
 
	mch™√l
[
SND_SOC_TPLG_MAX_CHAN
];

406 
¢d_soc_çlg_¥iv©e
 
	m¥iv
;

407 } 
__©åibuã__
((
∑cked
));

419 
	s¢d_soc_çlg_íum_c⁄åﬁ
 {

420 
¢d_soc_çlg_˘l_hdr
 
	mhdr
;

421 
__À32
 
	msize
;

422 
__À32
 
	mnum_ch™√ls
;

423 
¢d_soc_çlg_ch™√l
 
	mch™√l
[
SND_SOC_TPLG_MAX_CHAN
];

424 
__À32
 
	môems
;

425 
__À32
 
	mmask
;

426 
__À32
 
	mcou¡
;

427 
	mãxts
[
SND_SOC_TPLG_NUM_TEXTS
][
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

428 
__À32
 
	mvÆues
[
SND_SOC_TPLG_NUM_TEXTS
 * 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
 / 4];

429 
¢d_soc_çlg_¥iv©e
 
	m¥iv
;

430 } 
__©åibuã__
((
∑cked
));

442 
	s¢d_soc_çlg_byãs_c⁄åﬁ
 {

443 
¢d_soc_çlg_˘l_hdr
 
	mhdr
;

444 
__À32
 
	msize
;

445 
__À32
 
	mmax
;

446 
__À32
 
	mmask
;

447 
__À32
 
	mba£
;

448 
__À32
 
	mnum_ªgs
;

449 
¢d_soc_çlg_io_›s
 
	mext_›s
;

450 
¢d_soc_çlg_¥iv©e
 
	m¥iv
;

451 } 
__©åibuã__
((
∑cked
));

463 
	s¢d_soc_çlg_d≠m_gøph_ñem
 {

464 
	msök
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

465 
	mc⁄åﬁ
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

466 
	msour˚
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

467 } 
__©åibuã__
((
∑cked
));

485 
	s¢d_soc_çlg_d≠m_widgë
 {

486 
__À32
 
	msize
;

487 
__À32
 
	mid
;

488 
	m«me
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

489 
	m¢ame
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

491 
__À32
 
	mªg
;

492 
__À32
 
	mshi·
;

493 
__À32
 
	mmask
;

494 
__À32
 
	msub£q
;

495 
__À32
 
	mövît
;

496 
__À32
 
	mign‹e_su•íd
;

497 
__À16
 
	mevít_Êags
;

498 
__À16
 
	mevít_ty≥
;

499 
__À32
 
	mnum_kc⁄åﬁs
;

500 
¢d_soc_çlg_¥iv©e
 
	m¥iv
;

505 } 
__©åibuã__
((
∑cked
));

518 
	s¢d_soc_çlg_pcm
 {

519 
__À32
 
	msize
;

520 
	mpcm_«me
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

521 
	mdai_«me
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

522 
__À32
 
	mpcm_id
;

523 
__À32
 
	mdai_id
;

524 
__À32
 
	m∂ayback
;

525 
__À32
 
	mˇ±uª
;

526 
__À32
 
	mcom¥ess
;

527 
¢d_soc_çlg_°ªam
 
	m°ªam
[
SND_SOC_TPLG_STREAM_CONFIG_MAX
];

528 
__À32
 
	mnum_°ªams
;

529 
¢d_soc_çlg_°ªam_ˇps
 
	mˇps
[2];

530 
__À32
 
	mÊag_mask
;

531 
__À32
 
	mÊags
;

532 
¢d_soc_çlg_¥iv©e
 
	m¥iv
;

533 } 
__©åibuã__
((
∑cked
));

546 
	s¢d_soc_çlg_lök_c⁄fig
 {

547 
__À32
 
	msize
;

548 
__À32
 
	mid
;

549 
	m«me
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

550 
	m°ªam_«me
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

551 
¢d_soc_çlg_°ªam
 
	m°ªam
[
SND_SOC_TPLG_STREAM_CONFIG_MAX
];

552 
__À32
 
	mnum_°ªams
;

553 
¢d_soc_çlg_hw_c⁄fig
 
	mhw_c⁄fig
[
SND_SOC_TPLG_HW_CONFIG_MAX
];

554 
__À32
 
	mnum_hw_c⁄figs
;

555 
__À32
 
	mdeÁu…_hw_c⁄fig_id
;

556 
__À32
 
	mÊag_mask
;

557 
__À32
 
	mÊags
;

558 
¢d_soc_çlg_¥iv©e
 
	m¥iv
;

559 } 
__©åibuã__
((
∑cked
));

572 
	s¢d_soc_çlg_dai
 {

573 
__À32
 
	msize
;

574 
	mdai_«me
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

575 
__À32
 
	mdai_id
;

576 
__À32
 
	m∂ayback
;

577 
__À32
 
	mˇ±uª
;

578 
¢d_soc_çlg_°ªam_ˇps
 
	mˇps
[2];

579 
__À32
 
	mÊag_mask
;

580 
__À32
 
	mÊags
;

581 
¢d_soc_çlg_¥iv©e
 
	m¥iv
;

582 } 
__©åibuã__
((
∑cked
));

589 
	s¢d_soc_çlg_m™i„°_v4
 {

590 
__À32
 
	msize
;

591 
__À32
 
	mc⁄åﬁ_ñems
;

592 
__À32
 
	mwidgë_ñems
;

593 
__À32
 
	mgøph_ñems
;

594 
__À32
 
	mpcm_ñems
;

595 
__À32
 
	mdai_lök_ñems
;

596 
¢d_soc_çlg_¥iv©e
 
	m¥iv
;

597 } 
__©åibuã__
((
∑cked
));

600 
	s¢d_soc_çlg_°ªam_ˇps_v4
 {

601 
__À32
 
	msize
;

602 
	m«me
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

603 
__À64
 
	mf‹m©s
;

604 
__À32
 
	møãs
;

605 
__À32
 
	møã_mö
;

606 
__À32
 
	møã_max
;

607 
__À32
 
	mch™√ls_mö
;

608 
__À32
 
	mch™√ls_max
;

609 
__À32
 
	m≥riods_mö
;

610 
__À32
 
	m≥riods_max
;

611 
__À32
 
	m≥riod_size_mö
;

612 
__À32
 
	m≥riod_size_max
;

613 
__À32
 
	mbuf„r_size_mö
;

614 
__À32
 
	mbuf„r_size_max
;

615 } 
__©åibuã__
((
∑cked
));

618 
	s¢d_soc_çlg_pcm_v4
 {

619 
__À32
 
	msize
;

620 
	mpcm_«me
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

621 
	mdai_«me
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

622 
__À32
 
	mpcm_id
;

623 
__À32
 
	mdai_id
;

624 
__À32
 
	m∂ayback
;

625 
__À32
 
	mˇ±uª
;

626 
__À32
 
	mcom¥ess
;

627 
¢d_soc_çlg_°ªam
 
	m°ªam
[
SND_SOC_TPLG_STREAM_CONFIG_MAX
];

628 
__À32
 
	mnum_°ªams
;

629 
¢d_soc_çlg_°ªam_ˇps_v4
 
	mˇps
[2];

630 } 
__©åibuã__
((
∑cked
));

633 
	s¢d_soc_çlg_lök_c⁄fig_v4
 {

634 
__À32
 
	msize
;

635 
__À32
 
	mid
;

636 
¢d_soc_çlg_°ªam
 
	m°ªam
[
SND_SOC_TPLG_STREAM_CONFIG_MAX
];

637 
__À32
 
	mnum_°ªams
;

638 } 
__©åibuã__
((
∑cked
));

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asound.h

24 #i‚de‡
__SOUND_ASOUND_H


25 
	#__SOUND_ASOUND_H


	)

27 #i‡
deföed
(
__KERNEL__
Ë|| deföed(
__löux__
)

28 
	~<löux/ty≥s.h
>

29 
	~<asm/byã‹dî.h
>

31 
	~<sys/ídün.h
>

32 
	~<sys/io˘l.h
>

35 
	~<°dlib.h
>

36 
	~<time.h
>

42 
	#SNDRV_PROTOCOL_VERSION
(
maj‹
, 
mö‹
, 
submö‹
Ë(((maj‹)<<16)|((mö‹)<<8)|(submö‹))

	)

43 
	#SNDRV_PROTOCOL_MAJOR
(
vîsi⁄
Ë(((vîsi⁄)>>16)&0xffff)

	)

44 
	#SNDRV_PROTOCOL_MINOR
(
vîsi⁄
Ë(((vîsi⁄)>>8)&0xff)

	)

45 
	#SNDRV_PROTOCOL_MICRO
(
vîsi⁄
Ë((vîsi⁄)&0xff)

	)

46 
	#SNDRV_PROTOCOL_INCOMPATIBLE
(
kvîsi⁄
, 
uvîsi⁄
) \

47 (
	`SNDRV_PROTOCOL_MAJOR
(
kvîsi⁄
Ë!SNDRV_PROTOCOL_MAJOR(
uvîsi⁄
) || \

48 (
	`SNDRV_PROTOCOL_MAJOR
(
kvîsi⁄
Ë=SNDRV_PROTOCOL_MAJOR(
uvîsi⁄
) && \

49 
	`SNDRV_PROTOCOL_MINOR
(
kvîsi⁄
Ë!SNDRV_PROTOCOL_MINOR(
uvîsi⁄
)))

	)

57 
	s¢d_´s_õc958
 {

58 
	m°©us
[24];

59 
	msubcode
[147];

60 
	m∑d
;

61 
	mdig_sub‰ame
[4];

70 
	s¢d_˚a_861_aud_if
 {

71 
	mdb1_˘_cc
;

72 
	mdb2_sf_ss
;

73 
	mdb3
;

74 
	mdb4_ˇ
;

75 
	mdb5_dmöh_lsv
;

84 
	#SNDRV_HWDEP_VERSION
 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 1)

	)

87 
	mSNDRV_HWDEP_IFACE_OPL2
 = 0,

88 
	mSNDRV_HWDEP_IFACE_OPL3
,

89 
	mSNDRV_HWDEP_IFACE_OPL4
,

90 
	mSNDRV_HWDEP_IFACE_SB16CSP
,

91 
	mSNDRV_HWDEP_IFACE_EMU10K1
,

92 
	mSNDRV_HWDEP_IFACE_YSS225
,

93 
	mSNDRV_HWDEP_IFACE_ICS2115
,

94 
	mSNDRV_HWDEP_IFACE_SSCAPE
,

95 
	mSNDRV_HWDEP_IFACE_VX
,

96 
	mSNDRV_HWDEP_IFACE_MIXART
,

97 
	mSNDRV_HWDEP_IFACE_USX2Y
,

98 
	mSNDRV_HWDEP_IFACE_EMUX_WAVETABLE
,

99 
	mSNDRV_HWDEP_IFACE_BLUETOOTH
,

100 
	mSNDRV_HWDEP_IFACE_USX2Y_PCM
,

101 
	mSNDRV_HWDEP_IFACE_PCXHR
,

102 
	mSNDRV_HWDEP_IFACE_SB_RC
,

103 
	mSNDRV_HWDEP_IFACE_HDA
,

104 
	mSNDRV_HWDEP_IFACE_USB_STREAM
,

105 
	mSNDRV_HWDEP_IFACE_FW_DICE
,

106 
	mSNDRV_HWDEP_IFACE_FW_FIREWORKS
,

107 
	mSNDRV_HWDEP_IFACE_FW_BEBOB
,

108 
	mSNDRV_HWDEP_IFACE_FW_OXFW
,

109 
	mSNDRV_HWDEP_IFACE_FW_DIGI00X
,

110 
	mSNDRV_HWDEP_IFACE_FW_TASCAM
,

111 
	mSNDRV_HWDEP_IFACE_LINE6
,

112 
	mSNDRV_HWDEP_IFACE_FW_MOTU
,

113 
	mSNDRV_HWDEP_IFACE_FW_FIREFACE
,

116 
	mSNDRV_HWDEP_IFACE_LAST
 = 
SNDRV_HWDEP_IFACE_FW_FIREFACE


119 
	s¢d_hwdï_öfo
 {

120 
	mdevi˚
;

121 
	mˇrd
;

122 
	mid
[64];

123 
	m«me
[80];

124 
	miÁ˚
;

125 
	mª£rved
[64];

129 
	s¢d_hwdï_d•_°©us
 {

130 
	mvîsi⁄
;

131 
	mid
[32];

132 
	mnum_d•s
;

133 
	md•_lﬂded
;

134 
	mchù_ªady
;

135 
	mª£rved
[16];

138 
	s¢d_hwdï_d•_image
 {

139 
	mödex
;

140 
	m«me
[64];

141 *
	mimage
;

142 
size_t
 
	mÀngth
;

143 
	mdrivî_d©a
;

146 
	#SNDRV_HWDEP_IOCTL_PVERSION
 
	`_IOR
 ('H', 0x00, )

	)

147 
	#SNDRV_HWDEP_IOCTL_INFO
 
	`_IOR
 ('H', 0x01, 
¢d_hwdï_öfo
)

	)

148 
	#SNDRV_HWDEP_IOCTL_DSP_STATUS
 
	`_IOR
('H', 0x02, 
¢d_hwdï_d•_°©us
)

	)

149 
	#SNDRV_HWDEP_IOCTL_DSP_LOAD
 
	`_IOW
('H', 0x03, 
¢d_hwdï_d•_image
)

	)

157 
	#SNDRV_PCM_VERSION
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 15)

	)

159 
	t¢d_pcm_u‰ames_t
;

160 sig√d 
	t¢d_pcm_s‰ames_t
;

163 
	mSNDRV_PCM_CLASS_GENERIC
 = 0,

164 
	mSNDRV_PCM_CLASS_MULTI
,

165 
	mSNDRV_PCM_CLASS_MODEM
,

166 
	mSNDRV_PCM_CLASS_DIGITIZER
,

168 
	mSNDRV_PCM_CLASS_LAST
 = 
SNDRV_PCM_CLASS_DIGITIZER
,

172 
	mSNDRV_PCM_SUBCLASS_GENERIC_MIX
 = 0,

173 
	mSNDRV_PCM_SUBCLASS_MULTI_MIX
,

175 
	mSNDRV_PCM_SUBCLASS_LAST
 = 
SNDRV_PCM_SUBCLASS_MULTI_MIX
,

179 
	mSNDRV_PCM_STREAM_PLAYBACK
 = 0,

180 
	mSNDRV_PCM_STREAM_CAPTURE
,

181 
	mSNDRV_PCM_STREAM_LAST
 = 
SNDRV_PCM_STREAM_CAPTURE
,

184 
	t__bôwi£
 
	t¢d_pcm_ac˚ss_t
;

185 
	#SNDRV_PCM_ACCESS_MMAP_INTERLEAVED
 ((
¢d_pcm_ac˚ss_t
Ë0Ë

	)

186 
	#SNDRV_PCM_ACCESS_MMAP_NONINTERLEAVED
 ((
¢d_pcm_ac˚ss_t
Ë1Ë

	)

187 
	#SNDRV_PCM_ACCESS_MMAP_COMPLEX
 ((
¢d_pcm_ac˚ss_t
Ë2Ë

	)

188 
	#SNDRV_PCM_ACCESS_RW_INTERLEAVED
 ((
¢d_pcm_ac˚ss_t
Ë3Ë

	)

189 
	#SNDRV_PCM_ACCESS_RW_NONINTERLEAVED
 ((
¢d_pcm_ac˚ss_t
Ë4Ë

	)

190 
	#SNDRV_PCM_ACCESS_LAST
 
SNDRV_PCM_ACCESS_RW_NONINTERLEAVED


	)

192 
	t__bôwi£
 
	t¢d_pcm_f‹m©_t
;

193 
	#SNDRV_PCM_FORMAT_S8
 ((
¢d_pcm_f‹m©_t
Ë0)

	)

194 
	#SNDRV_PCM_FORMAT_U8
 ((
¢d_pcm_f‹m©_t
Ë1)

	)

195 
	#SNDRV_PCM_FORMAT_S16_LE
 ((
¢d_pcm_f‹m©_t
Ë2)

	)

196 
	#SNDRV_PCM_FORMAT_S16_BE
 ((
¢d_pcm_f‹m©_t
Ë3)

	)

197 
	#SNDRV_PCM_FORMAT_U16_LE
 ((
¢d_pcm_f‹m©_t
Ë4)

	)

198 
	#SNDRV_PCM_FORMAT_U16_BE
 ((
¢d_pcm_f‹m©_t
Ë5)

	)

199 
	#SNDRV_PCM_FORMAT_S24_LE
 ((
¢d_pcm_f‹m©_t
Ë6Ë

	)

200 
	#SNDRV_PCM_FORMAT_S24_BE
 ((
¢d_pcm_f‹m©_t
Ë7Ë

	)

201 
	#SNDRV_PCM_FORMAT_U24_LE
 ((
¢d_pcm_f‹m©_t
Ë8Ë

	)

202 
	#SNDRV_PCM_FORMAT_U24_BE
 ((
¢d_pcm_f‹m©_t
Ë9Ë

	)

203 
	#SNDRV_PCM_FORMAT_S32_LE
 ((
¢d_pcm_f‹m©_t
Ë10)

	)

204 
	#SNDRV_PCM_FORMAT_S32_BE
 ((
¢d_pcm_f‹m©_t
Ë11)

	)

205 
	#SNDRV_PCM_FORMAT_U32_LE
 ((
¢d_pcm_f‹m©_t
Ë12)

	)

206 
	#SNDRV_PCM_FORMAT_U32_BE
 ((
¢d_pcm_f‹m©_t
Ë13)

	)

207 
	#SNDRV_PCM_FORMAT_FLOAT_LE
 ((
¢d_pcm_f‹m©_t
Ë14Ë

	)

208 
	#SNDRV_PCM_FORMAT_FLOAT_BE
 ((
¢d_pcm_f‹m©_t
Ë15Ë

	)

209 
	#SNDRV_PCM_FORMAT_FLOAT64_LE
 ((
¢d_pcm_f‹m©_t
Ë16Ë

	)

210 
	#SNDRV_PCM_FORMAT_FLOAT64_BE
 ((
¢d_pcm_f‹m©_t
Ë17Ë

	)

211 
	#SNDRV_PCM_FORMAT_IEC958_SUBFRAME_LE
 ((
¢d_pcm_f‹m©_t
Ë18Ë

	)

212 
	#SNDRV_PCM_FORMAT_IEC958_SUBFRAME_BE
 ((
¢d_pcm_f‹m©_t
Ë19Ë

	)

213 
	#SNDRV_PCM_FORMAT_MU_LAW
 ((
¢d_pcm_f‹m©_t
Ë20)

	)

214 
	#SNDRV_PCM_FORMAT_A_LAW
 ((
¢d_pcm_f‹m©_t
Ë21)

	)

215 
	#SNDRV_PCM_FORMAT_IMA_ADPCM
 ((
¢d_pcm_f‹m©_t
Ë22)

	)

216 
	#SNDRV_PCM_FORMAT_MPEG
 ((
¢d_pcm_f‹m©_t
Ë23)

	)

217 
	#SNDRV_PCM_FORMAT_GSM
 ((
¢d_pcm_f‹m©_t
Ë24)

	)

218 
	#SNDRV_PCM_FORMAT_S20_LE
 ((
¢d_pcm_f‹m©_t
Ë25Ë

	)

219 
	#SNDRV_PCM_FORMAT_S20_BE
 ((
¢d_pcm_f‹m©_t
Ë26Ë

	)

220 
	#SNDRV_PCM_FORMAT_U20_LE
 ((
¢d_pcm_f‹m©_t
Ë27Ë

	)

221 
	#SNDRV_PCM_FORMAT_U20_BE
 ((
¢d_pcm_f‹m©_t
Ë28Ë

	)

223 
	#SNDRV_PCM_FORMAT_SPECIAL
 ((
¢d_pcm_f‹m©_t
Ë31)

	)

224 
	#SNDRV_PCM_FORMAT_S24_3LE
 ((
¢d_pcm_f‹m©_t
Ë32Ë

	)

225 
	#SNDRV_PCM_FORMAT_S24_3BE
 ((
¢d_pcm_f‹m©_t
Ë33Ë

	)

226 
	#SNDRV_PCM_FORMAT_U24_3LE
 ((
¢d_pcm_f‹m©_t
Ë34Ë

	)

227 
	#SNDRV_PCM_FORMAT_U24_3BE
 ((
¢d_pcm_f‹m©_t
Ë35Ë

	)

228 
	#SNDRV_PCM_FORMAT_S20_3LE
 ((
¢d_pcm_f‹m©_t
Ë36Ë

	)

229 
	#SNDRV_PCM_FORMAT_S20_3BE
 ((
¢d_pcm_f‹m©_t
Ë37Ë

	)

230 
	#SNDRV_PCM_FORMAT_U20_3LE
 ((
¢d_pcm_f‹m©_t
Ë38Ë

	)

231 
	#SNDRV_PCM_FORMAT_U20_3BE
 ((
¢d_pcm_f‹m©_t
Ë39Ë

	)

232 
	#SNDRV_PCM_FORMAT_S18_3LE
 ((
¢d_pcm_f‹m©_t
Ë40Ë

	)

233 
	#SNDRV_PCM_FORMAT_S18_3BE
 ((
¢d_pcm_f‹m©_t
Ë41Ë

	)

234 
	#SNDRV_PCM_FORMAT_U18_3LE
 ((
¢d_pcm_f‹m©_t
Ë42Ë

	)

235 
	#SNDRV_PCM_FORMAT_U18_3BE
 ((
¢d_pcm_f‹m©_t
Ë43Ë

	)

236 
	#SNDRV_PCM_FORMAT_G723_24
 ((
¢d_pcm_f‹m©_t
Ë44Ë

	)

237 
	#SNDRV_PCM_FORMAT_G723_24_1B
 ((
¢d_pcm_f‹m©_t
Ë45Ë

	)

238 
	#SNDRV_PCM_FORMAT_G723_40
 ((
¢d_pcm_f‹m©_t
Ë46Ë

	)

239 
	#SNDRV_PCM_FORMAT_G723_40_1B
 ((
¢d_pcm_f‹m©_t
Ë47Ë

	)

240 
	#SNDRV_PCM_FORMAT_DSD_U8
 ((
¢d_pcm_f‹m©_t
Ë48Ë

	)

241 
	#SNDRV_PCM_FORMAT_DSD_U16_LE
 ((
¢d_pcm_f‹m©_t
Ë49Ë

	)

242 
	#SNDRV_PCM_FORMAT_DSD_U32_LE
 ((
¢d_pcm_f‹m©_t
Ë50Ë

	)

243 
	#SNDRV_PCM_FORMAT_DSD_U16_BE
 ((
¢d_pcm_f‹m©_t
Ë51Ë

	)

244 
	#SNDRV_PCM_FORMAT_DSD_U32_BE
 ((
¢d_pcm_f‹m©_t
Ë52Ë

	)

245 
	#SNDRV_PCM_FORMAT_LAST
 
SNDRV_PCM_FORMAT_DSD_U32_BE


	)

246 
	#SNDRV_PCM_FORMAT_FIRST
 
SNDRV_PCM_FORMAT_S8


	)

248 #ifde‡
SNDRV_LITTLE_ENDIAN


249 
	#SNDRV_PCM_FORMAT_S16
 
SNDRV_PCM_FORMAT_S16_LE


	)

250 
	#SNDRV_PCM_FORMAT_U16
 
SNDRV_PCM_FORMAT_U16_LE


	)

251 
	#SNDRV_PCM_FORMAT_S24
 
SNDRV_PCM_FORMAT_S24_LE


	)

252 
	#SNDRV_PCM_FORMAT_U24
 
SNDRV_PCM_FORMAT_U24_LE


	)

253 
	#SNDRV_PCM_FORMAT_S32
 
SNDRV_PCM_FORMAT_S32_LE


	)

254 
	#SNDRV_PCM_FORMAT_U32
 
SNDRV_PCM_FORMAT_U32_LE


	)

255 
	#SNDRV_PCM_FORMAT_FLOAT
 
SNDRV_PCM_FORMAT_FLOAT_LE


	)

256 
	#SNDRV_PCM_FORMAT_FLOAT64
 
SNDRV_PCM_FORMAT_FLOAT64_LE


	)

257 
	#SNDRV_PCM_FORMAT_IEC958_SUBFRAME
 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_LE


	)

258 
	#SNDRV_PCM_FORMAT_S20
 
SNDRV_PCM_FORMAT_S20_LE


	)

259 
	#SNDRV_PCM_FORMAT_U20
 
SNDRV_PCM_FORMAT_U20_LE


	)

261 #ifde‡
SNDRV_BIG_ENDIAN


262 
	#SNDRV_PCM_FORMAT_S16
 
SNDRV_PCM_FORMAT_S16_BE


	)

263 
	#SNDRV_PCM_FORMAT_U16
 
SNDRV_PCM_FORMAT_U16_BE


	)

264 
	#SNDRV_PCM_FORMAT_S24
 
SNDRV_PCM_FORMAT_S24_BE


	)

265 
	#SNDRV_PCM_FORMAT_U24
 
SNDRV_PCM_FORMAT_U24_BE


	)

266 
	#SNDRV_PCM_FORMAT_S32
 
SNDRV_PCM_FORMAT_S32_BE


	)

267 
	#SNDRV_PCM_FORMAT_U32
 
SNDRV_PCM_FORMAT_U32_BE


	)

268 
	#SNDRV_PCM_FORMAT_FLOAT
 
SNDRV_PCM_FORMAT_FLOAT_BE


	)

269 
	#SNDRV_PCM_FORMAT_FLOAT64
 
SNDRV_PCM_FORMAT_FLOAT64_BE


	)

270 
	#SNDRV_PCM_FORMAT_IEC958_SUBFRAME
 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_BE


	)

271 
	#SNDRV_PCM_FORMAT_S20
 
SNDRV_PCM_FORMAT_S20_BE


	)

272 
	#SNDRV_PCM_FORMAT_U20
 
SNDRV_PCM_FORMAT_U20_BE


	)

275 
	t__bôwi£
 
	t¢d_pcm_subf‹m©_t
;

276 
	#SNDRV_PCM_SUBFORMAT_STD
 ((
¢d_pcm_subf‹m©_t
Ë0)

	)

277 
	#SNDRV_PCM_SUBFORMAT_MSBITS_MAX
 ((
¢d_pcm_subf‹m©_t
Ë1)

	)

278 
	#SNDRV_PCM_SUBFORMAT_MSBITS_20
 ((
¢d_pcm_subf‹m©_t
Ë2)

	)

279 
	#SNDRV_PCM_SUBFORMAT_MSBITS_24
 ((
¢d_pcm_subf‹m©_t
Ë3)

	)

280 
	#SNDRV_PCM_SUBFORMAT_LAST
 
SNDRV_PCM_SUBFORMAT_MSBITS_24


	)

282 
	#SNDRV_PCM_INFO_MMAP
 0x00000001

	)

283 
	#SNDRV_PCM_INFO_MMAP_VALID
 0x00000002

	)

284 
	#SNDRV_PCM_INFO_DOUBLE
 0x00000004

	)

285 
	#SNDRV_PCM_INFO_BATCH
 0x00000010

	)

286 
	#SNDRV_PCM_INFO_SYNC_APPLPTR
 0x00000020

	)

287 
	#SNDRV_PCM_INFO_PERFECT_DRAIN
 0x00000040

	)

288 
	#SNDRV_PCM_INFO_INTERLEAVED
 0x00000100

	)

289 
	#SNDRV_PCM_INFO_NONINTERLEAVED
 0x00000200

	)

290 
	#SNDRV_PCM_INFO_COMPLEX
 0x00000400

	)

291 
	#SNDRV_PCM_INFO_BLOCK_TRANSFER
 0x00010000

	)

292 
	#SNDRV_PCM_INFO_OVERRANGE
 0x00020000

	)

293 
	#SNDRV_PCM_INFO_RESUME
 0x00040000

	)

294 
	#SNDRV_PCM_INFO_PAUSE
 0x00080000

	)

295 
	#SNDRV_PCM_INFO_HALF_DUPLEX
 0x00100000

	)

296 
	#SNDRV_PCM_INFO_JOINT_DUPLEX
 0x00200000

	)

297 
	#SNDRV_PCM_INFO_SYNC_START
 0x00400000

	)

298 
	#SNDRV_PCM_INFO_NO_PERIOD_WAKEUP
 0x00800000

	)

299 
	#SNDRV_PCM_INFO_HAS_WALL_CLOCK
 0x01000000

	)

300 
	#SNDRV_PCM_INFO_HAS_LINK_ATIME
 0x01000000

	)

301 
	#SNDRV_PCM_INFO_HAS_LINK_ABSOLUTE_ATIME
 0x02000000

	)

302 
	#SNDRV_PCM_INFO_HAS_LINK_ESTIMATED_ATIME
 0x04000000

	)

303 
	#SNDRV_PCM_INFO_HAS_LINK_SYNCHRONIZED_ATIME
 0x08000000

	)

305 
	#SNDRV_PCM_INFO_DRAIN_TRIGGER
 0x40000000

	)

306 
	#SNDRV_PCM_INFO_FIFO_IN_FRAMES
 0x80000000

	)

308 #i‡(
__BITS_PER_LONG
 =32 && 
deföed
(
__USE_TIME_BITS64
)Ë|| deföed 
__KERNEL__


309 
	#__SND_STRUCT_TIME64


	)

312 
	t__bôwi£
 
	t¢d_pcm_°©e_t
;

313 
	#SNDRV_PCM_STATE_OPEN
 ((
¢d_pcm_°©e_t
Ë0Ë

	)

314 
	#SNDRV_PCM_STATE_SETUP
 ((
¢d_pcm_°©e_t
Ë1Ë

	)

315 
	#SNDRV_PCM_STATE_PREPARED
 ((
¢d_pcm_°©e_t
Ë2Ë

	)

316 
	#SNDRV_PCM_STATE_RUNNING
 ((
¢d_pcm_°©e_t
Ë3Ë

	)

317 
	#SNDRV_PCM_STATE_XRUN
 ((
¢d_pcm_°©e_t
Ë4Ë

	)

318 
	#SNDRV_PCM_STATE_DRAINING
 ((
¢d_pcm_°©e_t
Ë5Ë

	)

319 
	#SNDRV_PCM_STATE_PAUSED
 ((
¢d_pcm_°©e_t
Ë6Ë

	)

320 
	#SNDRV_PCM_STATE_SUSPENDED
 ((
¢d_pcm_°©e_t
Ë7Ë

	)

321 
	#SNDRV_PCM_STATE_DISCONNECTED
 ((
¢d_pcm_°©e_t
Ë8Ë

	)

322 
	#SNDRV_PCM_STATE_LAST
 
SNDRV_PCM_STATE_DISCONNECTED


	)

325 
	mSNDRV_PCM_MMAP_OFFSET_DATA
 = 0x00000000,

326 
	mSNDRV_PCM_MMAP_OFFSET_STATUS_OLD
 = 0x80000000,

327 
	mSNDRV_PCM_MMAP_OFFSET_CONTROL_OLD
 = 0x81000000,

328 
	mSNDRV_PCM_MMAP_OFFSET_STATUS_NEW
 = 0x82000000,

329 
	mSNDRV_PCM_MMAP_OFFSET_CONTROL_NEW
 = 0x83000000,

330 #ifde‡
__SND_STRUCT_TIME64


331 
	mSNDRV_PCM_MMAP_OFFSET_STATUS
 = 
SNDRV_PCM_MMAP_OFFSET_STATUS_NEW
,

332 
	mSNDRV_PCM_MMAP_OFFSET_CONTROL
 = 
SNDRV_PCM_MMAP_OFFSET_CONTROL_NEW
,

334 
	mSNDRV_PCM_MMAP_OFFSET_STATUS
 = 
SNDRV_PCM_MMAP_OFFSET_STATUS_OLD
,

335 
	mSNDRV_PCM_MMAP_OFFSET_CONTROL
 = 
SNDRV_PCM_MMAP_OFFSET_CONTROL_OLD
,

339 
	u¢d_pcm_sync_id
 {

340 
	mid
[16];

341 
	mid16
[8];

342 
	mid32
[4];

345 
	s¢d_pcm_öfo
 {

346 
	mdevi˚
;

347 
	msubdevi˚
;

348 
	m°ªam
;

349 
	mˇrd
;

350 
	mid
[64];

351 
	m«me
[80];

352 
	msub«me
[32];

353 
	mdev_˛ass
;

354 
	mdev_sub˛ass
;

355 
	msubdevi˚s_cou¡
;

356 
	msubdevi˚s_avaû
;

357 
¢d_pcm_sync_id
 
	msync
;

358 
	mª£rved
[64];

361 
	t¢d_pcm_hw_∑øm_t
;

362 
	#SNDRV_PCM_HW_PARAM_ACCESS
 0

	)

363 
	#SNDRV_PCM_HW_PARAM_FORMAT
 1

	)

364 
	#SNDRV_PCM_HW_PARAM_SUBFORMAT
 2

	)

365 
	#SNDRV_PCM_HW_PARAM_FIRST_MASK
 
SNDRV_PCM_HW_PARAM_ACCESS


	)

366 
	#SNDRV_PCM_HW_PARAM_LAST_MASK
 
SNDRV_PCM_HW_PARAM_SUBFORMAT


	)

368 
	#SNDRV_PCM_HW_PARAM_SAMPLE_BITS
 8

	)

369 
	#SNDRV_PCM_HW_PARAM_FRAME_BITS
 9

	)

370 
	#SNDRV_PCM_HW_PARAM_CHANNELS
 10

	)

371 
	#SNDRV_PCM_HW_PARAM_RATE
 11

	)

372 
	#SNDRV_PCM_HW_PARAM_PERIOD_TIME
 12

	)

375 
	#SNDRV_PCM_HW_PARAM_PERIOD_SIZE
 13

	)

378 
	#SNDRV_PCM_HW_PARAM_PERIOD_BYTES
 14

	)

381 
	#SNDRV_PCM_HW_PARAM_PERIODS
 15

	)

384 
	#SNDRV_PCM_HW_PARAM_BUFFER_TIME
 16

	)

387 
	#SNDRV_PCM_HW_PARAM_BUFFER_SIZE
 17

	)

388 
	#SNDRV_PCM_HW_PARAM_BUFFER_BYTES
 18

	)

389 
	#SNDRV_PCM_HW_PARAM_TICK_TIME
 19

	)

390 
	#SNDRV_PCM_HW_PARAM_FIRST_INTERVAL
 
SNDRV_PCM_HW_PARAM_SAMPLE_BITS


	)

391 
	#SNDRV_PCM_HW_PARAM_LAST_INTERVAL
 
SNDRV_PCM_HW_PARAM_TICK_TIME


	)

393 
	#SNDRV_PCM_HW_PARAMS_NORESAMPLE
 (1<<0Ë

	)

394 
	#SNDRV_PCM_HW_PARAMS_EXPORT_BUFFER
 (1<<1Ë

	)

395 
	#SNDRV_PCM_HW_PARAMS_NO_PERIOD_WAKEUP
 (1<<2Ë

	)

396 
	#SNDRV_PCM_HW_PARAMS_NO_DRAIN_SILENCE
 (1<<3Ë

	)

400 
	s¢d_öãrvÆ
 {

401 
	mmö
, 
	mmax
;

402 
	m›ímö
:1,

403 
	m›ímax
:1,

404 
	möãgî
:1,

405 
	mem±y
:1;

408 
	#SNDRV_MASK_MAX
 256

	)

410 
	s¢d_mask
 {

411 
__u32
 
	mbôs
[(
SNDRV_MASK_MAX
+31)/32];

414 
	s¢d_pcm_hw_∑øms
 {

415 
	mÊags
;

416 
¢d_mask
 
	mmasks
[
SNDRV_PCM_HW_PARAM_LAST_MASK
 -

417 
SNDRV_PCM_HW_PARAM_FIRST_MASK
 + 1];

418 
¢d_mask
 
	mmªs
[5];

419 
¢d_öãrvÆ
 
	möãrvÆs
[
SNDRV_PCM_HW_PARAM_LAST_INTERVAL
 -

420 
SNDRV_PCM_HW_PARAM_FIRST_INTERVAL
 + 1];

421 
¢d_öãrvÆ
 
	múes
[9];

422 
	mrmask
;

423 
	mcmask
;

424 
	möfo
;

425 
	mmsbôs
;

426 
	møã_num
;

427 
	møã_dí
;

428 
¢d_pcm_u‰ames_t
 
	mfifo_size
;

429 
	mª£rved
[64];

433 
	mSNDRV_PCM_TSTAMP_NONE
 = 0,

434 
	mSNDRV_PCM_TSTAMP_ENABLE
,

435 
	mSNDRV_PCM_TSTAMP_LAST
 = 
SNDRV_PCM_TSTAMP_ENABLE
,

438 
	s¢d_pcm_sw_∑øms
 {

439 
	mt°amp_mode
;

440 
	m≥riod_°ï
;

441 
	m¶ìp_mö
;

442 
¢d_pcm_u‰ames_t
 
	mavaû_mö
;

443 
¢d_pcm_u‰ames_t
 
	mx„r_Æign
;

444 
¢d_pcm_u‰ames_t
 
	m°¨t_thªshﬁd
;

445 
¢d_pcm_u‰ames_t
 
	m°›_thªshﬁd
;

446 
¢d_pcm_u‰ames_t
 
	msûí˚_thªshﬁd
;

447 
¢d_pcm_u‰ames_t
 
	msûí˚_size
;

448 
¢d_pcm_u‰ames_t
 
	mbound¨y
;

449 
	m¥Ÿo
;

450 
	mt°amp_ty≥
;

451 
	mª£rved
[56];

454 
	s¢d_pcm_ch™√l_öfo
 {

455 
	mch™√l
;

456 
__kî√l_off_t
 
	moff£t
;

457 
	mfú°
;

458 
	m°ï
;

466 
	mSNDRV_PCM_AUDIO_TSTAMP_TYPE_COMPAT
 = 0,

469 
	mSNDRV_PCM_AUDIO_TSTAMP_TYPE_DEFAULT
 = 1,

470 
	mSNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK
 = 2,

471 
	mSNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK_ABSOLUTE
 = 3,

472 
	mSNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK_ESTIMATED
 = 4,

473 
	mSNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK_SYNCHRONIZED
 = 5,

474 
	mSNDRV_PCM_AUDIO_TSTAMP_TYPE_LAST
 = 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK_SYNCHRONIZED


478 °ru˘ { 
	m∑d
[(
time_t
Ë- ()]; } 
	t__time_∑d
;

480 
	s¢d_pcm_°©us
 {

481 
¢d_pcm_°©e_t
 
	m°©e
;

482 
__time_∑d
 
	m∑d1
;

483 
time•ec
 
	måiggî_t°amp
;

484 
time•ec
 
	mt°amp
;

485 
¢d_pcm_u‰ames_t
 
	m≠∂_±r
;

486 
¢d_pcm_u‰ames_t
 
	mhw_±r
;

487 
¢d_pcm_s‰ames_t
 
	mdñay
;

488 
¢d_pcm_u‰ames_t
 
	mavaû
;

489 
¢d_pcm_u‰ames_t
 
	mavaû_max
;

490 
¢d_pcm_u‰ames_t
 
	movîønge
;

491 
¢d_pcm_°©e_t
 
	msu•íded_°©e
;

492 
__u32
 
	maudio_t°amp_d©a
;

493 
time•ec
 
	maudio_t°amp
;

494 
time•ec
 
	mdrivî_t°amp
;

495 
__u32
 
	maudio_t°amp_accuøcy
;

496 
	mª£rved
[52-2*(
time•ec
)];

504 #ifde‡
__SND_STRUCT_TIME64


505 
	#__¢d_pcm_mm≠_°©us64
 
¢d_pcm_mm≠_°©us


	)

506 
	#__¢d_pcm_mm≠_c⁄åﬁ64
 
¢d_pcm_mm≠_c⁄åﬁ


	)

507 
	#__¢d_pcm_sync_±r64
 
¢d_pcm_sync_±r


	)

508 
	#__¢d_time•ec64
 
time•ec


	)

509 
	s__¢d_time•ec
 {

510 
__s32
 
	mtv_£c
;

511 
__s32
 
	mtv_n£c
;

514 
	#__¢d_pcm_mm≠_°©us
 
¢d_pcm_mm≠_°©us


	)

515 
	#__¢d_pcm_mm≠_c⁄åﬁ
 
¢d_pcm_mm≠_c⁄åﬁ


	)

516 
	#__¢d_pcm_sync_±r
 
¢d_pcm_sync_±r


	)

517 
	#__¢d_time•ec
 
time•ec


	)

518 
	s__¢d_time•ec64
 {

519 
__s64
 
	mtv_£c
;

520 
__s64
 
	mtv_n£c
;

525 
	s__¢d_pcm_mm≠_°©us
 {

526 
¢d_pcm_°©e_t
 
	m°©e
;

527 
	m∑d1
;

528 
¢d_pcm_u‰ames_t
 
	mhw_±r
;

529 
__¢d_time•ec
 
	mt°amp
;

530 
¢d_pcm_°©e_t
 
	msu•íded_°©e
;

531 
__¢d_time•ec
 
	maudio_t°amp
;

534 
	s__¢d_pcm_mm≠_c⁄åﬁ
 {

535 
¢d_pcm_u‰ames_t
 
	m≠∂_±r
;

536 
¢d_pcm_u‰ames_t
 
	mavaû_mö
;

539 
	#SNDRV_PCM_SYNC_PTR_HWSYNC
 (1<<0Ë

	)

540 
	#SNDRV_PCM_SYNC_PTR_APPL
 (1<<1Ë

	)

541 
	#SNDRV_PCM_SYNC_PTR_AVAIL_MIN
 (1<<2Ë

	)

543 
	s__¢d_pcm_sync_±r
 {

544 
	mÊags
;

546 
__¢d_pcm_mm≠_°©us
 
	m°©us
;

547 
	mª£rved
[64];

548 } 
	ms
;

550 
__¢d_pcm_mm≠_c⁄åﬁ
 
	mc⁄åﬁ
;

551 
	mª£rved
[64];

552 } 
	mc
;

555 #i‡
deföed
(
__BYTE_ORDER
Ë? __BYTE_ORDER =
__BIG_ENDIAN
 : defined(__BIG_ENDIAN)

556 
	t__∑d_bef‹e_u‰ame
[(
__u64
Ë- (
¢d_pcm_u‰ames_t
)];

557 
	t__∑d_a·î_u‰ame
[0];

560 #i‡
deföed
(
__BYTE_ORDER
Ë? __BYTE_ORDER =
__LITTLE_ENDIAN
 : defined(__LITTLE_ENDIAN)

561 
	t__∑d_bef‹e_u‰ame
[0];

562 
	t__∑d_a·î_u‰ame
[(
__u64
Ë- (
¢d_pcm_u‰ames_t
)];

565 
	s__¢d_pcm_mm≠_°©us64
 {

566 
¢d_pcm_°©e_t
 
	m°©e
;

567 
__u32
 
	m∑d1
;

568 
__∑d_bef‹e_u‰ame
 
	m__∑d1
;

569 
¢d_pcm_u‰ames_t
 
	mhw_±r
;

570 
__∑d_a·î_u‰ame
 
	m__∑d2
;

571 
__¢d_time•ec64
 
	mt°amp
;

572 
¢d_pcm_°©e_t
 
	msu•íded_°©e
;

573 
__u32
 
	m∑d3
;

574 
__¢d_time•ec64
 
	maudio_t°amp
;

577 
	s__¢d_pcm_mm≠_c⁄åﬁ64
 {

578 
__∑d_bef‹e_u‰ame
 
	m__∑d1
;

579 
¢d_pcm_u‰ames_t
 
	m≠∂_±r
;

580 
__∑d_bef‹e_u‰ame
 
	m__∑d2
;

582 
__∑d_bef‹e_u‰ame
 
	m__∑d3
;

583 
¢d_pcm_u‰ames_t
 
	mavaû_mö
;

584 
__∑d_a·î_u‰ame
 
	m__∑d4
;

587 
	s__¢d_pcm_sync_±r64
 {

588 
__u32
 
	mÊags
;

589 
__u32
 
	m∑d1
;

591 
__¢d_pcm_mm≠_°©us64
 
	m°©us
;

592 
	mª£rved
[64];

593 } 
	ms
;

595 
__¢d_pcm_mm≠_c⁄åﬁ64
 
	mc⁄åﬁ
;

596 
	mª£rved
[64];

597 } 
	mc
;

600 
	s¢d_x„ri
 {

601 
¢d_pcm_s‰ames_t
 
	mªsu…
;

602 *
	mbuf
;

603 
¢d_pcm_u‰ames_t
 
	m‰ames
;

606 
	s¢d_x„∫
 {

607 
¢d_pcm_s‰ames_t
 
	mªsu…
;

608 * *
	mbufs
;

609 
¢d_pcm_u‰ames_t
 
	m‰ames
;

613 
	mSNDRV_PCM_TSTAMP_TYPE_GETTIMEOFDAY
 = 0,

614 
	mSNDRV_PCM_TSTAMP_TYPE_MONOTONIC
,

615 
	mSNDRV_PCM_TSTAMP_TYPE_MONOTONIC_RAW
,

616 
	mSNDRV_PCM_TSTAMP_TYPE_LAST
 = 
SNDRV_PCM_TSTAMP_TYPE_MONOTONIC_RAW
,

621 
	mSNDRV_CHMAP_UNKNOWN
 = 0,

622 
	mSNDRV_CHMAP_NA
,

623 
	mSNDRV_CHMAP_MONO
,

625 
	mSNDRV_CHMAP_FL
,

626 
	mSNDRV_CHMAP_FR
,

627 
	mSNDRV_CHMAP_RL
,

628 
	mSNDRV_CHMAP_RR
,

629 
	mSNDRV_CHMAP_FC
,

630 
	mSNDRV_CHMAP_LFE
,

631 
	mSNDRV_CHMAP_SL
,

632 
	mSNDRV_CHMAP_SR
,

633 
	mSNDRV_CHMAP_RC
,

635 
	mSNDRV_CHMAP_FLC
,

636 
	mSNDRV_CHMAP_FRC
,

637 
	mSNDRV_CHMAP_RLC
,

638 
	mSNDRV_CHMAP_RRC
,

639 
	mSNDRV_CHMAP_FLW
,

640 
	mSNDRV_CHMAP_FRW
,

641 
	mSNDRV_CHMAP_FLH
,

642 
	mSNDRV_CHMAP_FCH
,

643 
	mSNDRV_CHMAP_FRH
,

644 
	mSNDRV_CHMAP_TC
,

645 
	mSNDRV_CHMAP_TFL
,

646 
	mSNDRV_CHMAP_TFR
,

647 
	mSNDRV_CHMAP_TFC
,

648 
	mSNDRV_CHMAP_TRL
,

649 
	mSNDRV_CHMAP_TRR
,

650 
	mSNDRV_CHMAP_TRC
,

652 
	mSNDRV_CHMAP_TFLC
,

653 
	mSNDRV_CHMAP_TFRC
,

654 
	mSNDRV_CHMAP_TSL
,

655 
	mSNDRV_CHMAP_TSR
,

656 
	mSNDRV_CHMAP_LLFE
,

657 
	mSNDRV_CHMAP_RLFE
,

658 
	mSNDRV_CHMAP_BC
,

659 
	mSNDRV_CHMAP_BLC
,

660 
	mSNDRV_CHMAP_BRC
,

661 
	mSNDRV_CHMAP_LAST
 = 
SNDRV_CHMAP_BRC
,

664 
	#SNDRV_CHMAP_POSITION_MASK
 0xffff

	)

665 
	#SNDRV_CHMAP_PHASE_INVERSE
 (0x01 << 16)

	)

666 
	#SNDRV_CHMAP_DRIVER_SPEC
 (0x02 << 16)

	)

668 
	#SNDRV_PCM_IOCTL_PVERSION
 
	`_IOR
('A', 0x00, )

	)

669 
	#SNDRV_PCM_IOCTL_INFO
 
	`_IOR
('A', 0x01, 
¢d_pcm_öfo
)

	)

670 
	#SNDRV_PCM_IOCTL_TSTAMP
 
	`_IOW
('A', 0x02, )

	)

671 
	#SNDRV_PCM_IOCTL_TTSTAMP
 
	`_IOW
('A', 0x03, )

	)

672 
	#SNDRV_PCM_IOCTL_USER_PVERSION
 
	`_IOW
('A', 0x04, )

	)

673 
	#SNDRV_PCM_IOCTL_HW_REFINE
 
	`_IOWR
('A', 0x10, 
¢d_pcm_hw_∑øms
)

	)

674 
	#SNDRV_PCM_IOCTL_HW_PARAMS
 
	`_IOWR
('A', 0x11, 
¢d_pcm_hw_∑øms
)

	)

675 
	#SNDRV_PCM_IOCTL_HW_FREE
 
	`_IO
('A', 0x12)

	)

676 
	#SNDRV_PCM_IOCTL_SW_PARAMS
 
	`_IOWR
('A', 0x13, 
¢d_pcm_sw_∑øms
)

	)

677 
	#SNDRV_PCM_IOCTL_STATUS
 
	`_IOR
('A', 0x20, 
¢d_pcm_°©us
)

	)

678 
	#SNDRV_PCM_IOCTL_DELAY
 
	`_IOR
('A', 0x21, 
¢d_pcm_s‰ames_t
)

	)

679 
	#SNDRV_PCM_IOCTL_HWSYNC
 
	`_IO
('A', 0x22)

	)

680 
	#__SNDRV_PCM_IOCTL_SYNC_PTR
 
	`_IOWR
('A', 0x23, 
__¢d_pcm_sync_±r
)

	)

681 
	#__SNDRV_PCM_IOCTL_SYNC_PTR64
 
	`_IOWR
('A', 0x23, 
__¢d_pcm_sync_±r64
)

	)

682 
	#SNDRV_PCM_IOCTL_SYNC_PTR
 
	`_IOWR
('A', 0x23, 
¢d_pcm_sync_±r
)

	)

683 
	#SNDRV_PCM_IOCTL_STATUS_EXT
 
	`_IOWR
('A', 0x24, 
¢d_pcm_°©us
)

	)

684 
	#SNDRV_PCM_IOCTL_CHANNEL_INFO
 
	`_IOR
('A', 0x32, 
¢d_pcm_ch™√l_öfo
)

	)

685 
	#SNDRV_PCM_IOCTL_PREPARE
 
	`_IO
('A', 0x40)

	)

686 
	#SNDRV_PCM_IOCTL_RESET
 
	`_IO
('A', 0x41)

	)

687 
	#SNDRV_PCM_IOCTL_START
 
	`_IO
('A', 0x42)

	)

688 
	#SNDRV_PCM_IOCTL_DROP
 
	`_IO
('A', 0x43)

	)

689 
	#SNDRV_PCM_IOCTL_DRAIN
 
	`_IO
('A', 0x44)

	)

690 
	#SNDRV_PCM_IOCTL_PAUSE
 
	`_IOW
('A', 0x45, )

	)

691 
	#SNDRV_PCM_IOCTL_REWIND
 
	`_IOW
('A', 0x46, 
¢d_pcm_u‰ames_t
)

	)

692 
	#SNDRV_PCM_IOCTL_RESUME
 
	`_IO
('A', 0x47)

	)

693 
	#SNDRV_PCM_IOCTL_XRUN
 
	`_IO
('A', 0x48)

	)

694 
	#SNDRV_PCM_IOCTL_FORWARD
 
	`_IOW
('A', 0x49, 
¢d_pcm_u‰ames_t
)

	)

695 
	#SNDRV_PCM_IOCTL_WRITEI_FRAMES
 
	`_IOW
('A', 0x50, 
¢d_x„ri
)

	)

696 
	#SNDRV_PCM_IOCTL_READI_FRAMES
 
	`_IOR
('A', 0x51, 
¢d_x„ri
)

	)

697 
	#SNDRV_PCM_IOCTL_WRITEN_FRAMES
 
	`_IOW
('A', 0x52, 
¢d_x„∫
)

	)

698 
	#SNDRV_PCM_IOCTL_READN_FRAMES
 
	`_IOR
('A', 0x53, 
¢d_x„∫
)

	)

699 
	#SNDRV_PCM_IOCTL_LINK
 
	`_IOW
('A', 0x60, )

	)

700 
	#SNDRV_PCM_IOCTL_UNLINK
 
	`_IO
('A', 0x61)

	)

712 
	#SNDRV_RAWMIDI_VERSION
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4)

	)

715 
	mSNDRV_RAWMIDI_STREAM_OUTPUT
 = 0,

716 
	mSNDRV_RAWMIDI_STREAM_INPUT
,

717 
	mSNDRV_RAWMIDI_STREAM_LAST
 = 
SNDRV_RAWMIDI_STREAM_INPUT
,

720 
	#SNDRV_RAWMIDI_INFO_OUTPUT
 0x00000001

	)

721 
	#SNDRV_RAWMIDI_INFO_INPUT
 0x00000002

	)

722 
	#SNDRV_RAWMIDI_INFO_DUPLEX
 0x00000004

	)

723 
	#SNDRV_RAWMIDI_INFO_UMP
 0x00000008

	)

725 
	s¢d_øwmidi_öfo
 {

726 
	mdevi˚
;

727 
	msubdevi˚
;

728 
	m°ªam
;

729 
	mˇrd
;

730 
	mÊags
;

731 
	mid
[64];

732 
	m«me
[80];

733 
	msub«me
[32];

734 
	msubdevi˚s_cou¡
;

735 
	msubdevi˚s_avaû
;

736 
	mª£rved
[64];

739 
	#SNDRV_RAWMIDI_MODE_FRAMING_MASK
 (7<<0)

	)

740 
	#SNDRV_RAWMIDI_MODE_FRAMING_SHIFT
 0

	)

741 
	#SNDRV_RAWMIDI_MODE_FRAMING_NONE
 (0<<0)

	)

742 
	#SNDRV_RAWMIDI_MODE_FRAMING_TSTAMP
 (1<<0)

	)

743 
	#SNDRV_RAWMIDI_MODE_CLOCK_MASK
 (7<<3)

	)

744 
	#SNDRV_RAWMIDI_MODE_CLOCK_SHIFT
 3

	)

745 
	#SNDRV_RAWMIDI_MODE_CLOCK_NONE
 (0<<3)

	)

746 
	#SNDRV_RAWMIDI_MODE_CLOCK_REALTIME
 (1<<3)

	)

747 
	#SNDRV_RAWMIDI_MODE_CLOCK_MONOTONIC
 (2<<3)

	)

748 
	#SNDRV_RAWMIDI_MODE_CLOCK_MONOTONIC_RAW
 (3<<3)

	)

750 
	#SNDRV_RAWMIDI_FRAMING_DATA_LENGTH
 16

	)

752 
	s¢d_øwmidi_‰amög_t°amp
 {

756 
__u8
 
	m‰ame_ty≥
;

757 
__u8
 
	mÀngth
;

758 
__u8
 
	mª£rved
[2];

759 
__u32
 
	mtv_n£c
;

760 
__u64
 
	mtv_£c
;

761 
__u8
 
	md©a
[
SNDRV_RAWMIDI_FRAMING_DATA_LENGTH
];

762 } 
	g__∑cked
;

764 
	s¢d_øwmidi_∑øms
 {

765 
	m°ªam
;

766 
size_t
 
	mbuf„r_size
;

767 
size_t
 
	mavaû_mö
;

768 
	mno_a˘ive_£nsög
: 1;

769 
	mmode
;

770 
	mª£rved
[12];

773 
	s¢d_øwmidi_°©us
 {

774 
	m°ªam
;

775 
__time_∑d
 
	m∑d1
;

776 
time•ec
 
	mt°amp
;

777 
size_t
 
	mavaû
;

778 
size_t
 
	mxruns
;

779 
	mª£rved
[16];

783 
	#SNDRV_UMP_EP_INFO_STATIC_BLOCKS
 0x01

	)

786 
	#SNDRV_UMP_EP_INFO_PROTO_MIDI_MASK
 0x0300

	)

787 
	#SNDRV_UMP_EP_INFO_PROTO_MIDI1
 0x0100

	)

788 
	#SNDRV_UMP_EP_INFO_PROTO_MIDI2
 0x0200

	)

789 
	#SNDRV_UMP_EP_INFO_PROTO_JRTS_MASK
 0x0003

	)

790 
	#SNDRV_UMP_EP_INFO_PROTO_JRTS_TX
 0x0001

	)

791 
	#SNDRV_UMP_EP_INFO_PROTO_JRTS_RX
 0x0002

	)

794 
	s¢d_ump_ídpoöt_öfo
 {

795 
	mˇrd
;

796 
	mdevi˚
;

797 
	mÊags
;

798 
	m¥Ÿocﬁ_ˇps
;

799 
	m¥Ÿocﬁ
;

800 
	mnum_blocks
;

801 
	mvîsi⁄
;

802 
	mÁmûy_id
;

803 
	mmodñ_id
;

804 
	mm™uÁ˘uªr_id
;

805 
	msw_ªvisi⁄
[4];

806 
	m∑ddög
;

807 
	m«me
[128];

808 
	m¥odu˘_id
[128];

809 
	mª£rved
[32];

810 } 
	g__∑cked
;

813 
	#SNDRV_UMP_DIR_INPUT
 0x01

	)

814 
	#SNDRV_UMP_DIR_OUTPUT
 0x02

	)

815 
	#SNDRV_UMP_DIR_BIDIRECTION
 0x03

	)

818 
	#SNDRV_UMP_BLOCK_IS_MIDI1
 (1U << 0Ë

	)

819 
	#SNDRV_UMP_BLOCK_IS_LOWSPEED
 (1U << 1Ë

	)

822 
	#SNDRV_UMP_BLOCK_UI_HINT_UNKNOWN
 0x00

	)

823 
	#SNDRV_UMP_BLOCK_UI_HINT_RECEIVER
 0x01

	)

824 
	#SNDRV_UMP_BLOCK_UI_HINT_SENDER
 0x02

	)

825 
	#SNDRV_UMP_BLOCK_UI_HINT_BOTH
 0x03

	)

828 
	#SNDRV_UMP_MAX_GROUPS
 16

	)

829 
	#SNDRV_UMP_MAX_BLOCKS
 32

	)

832 
	s¢d_ump_block_öfo
 {

833 
	mˇrd
;

834 
	mdevi˚
;

835 
	mblock_id
;

836 
	mdúe˘i⁄
;

837 
	ma˘ive
;

838 
	mfú°_group
;

839 
	mnum_groups
;

840 
	mmidi_ci_vîsi⁄
;

841 
	msy£x8_°ªams
;

842 
	mui_höt
;

843 
	mÊags
;

844 
	m«me
[128];

845 
	mª£rved
[32];

846 } 
	g__∑cked
;

848 
	#SNDRV_RAWMIDI_IOCTL_PVERSION
 
	`_IOR
('W', 0x00, )

	)

849 
	#SNDRV_RAWMIDI_IOCTL_INFO
 
	`_IOR
('W', 0x01, 
¢d_øwmidi_öfo
)

	)

850 
	#SNDRV_RAWMIDI_IOCTL_USER_PVERSION
 
	`_IOW
('W', 0x02, )

	)

851 
	#SNDRV_RAWMIDI_IOCTL_PARAMS
 
	`_IOWR
('W', 0x10, 
¢d_øwmidi_∑øms
)

	)

852 
	#SNDRV_RAWMIDI_IOCTL_STATUS
 
	`_IOWR
('W', 0x20, 
¢d_øwmidi_°©us
)

	)

853 
	#SNDRV_RAWMIDI_IOCTL_DROP
 
	`_IOW
('W', 0x30, )

	)

854 
	#SNDRV_RAWMIDI_IOCTL_DRAIN
 
	`_IOW
('W', 0x31, )

	)

856 
	#SNDRV_UMP_IOCTL_ENDPOINT_INFO
 
	`_IOR
('W', 0x40, 
¢d_ump_ídpoöt_öfo
)

	)

857 
	#SNDRV_UMP_IOCTL_BLOCK_INFO
 
	`_IOR
('W', 0x41, 
¢d_ump_block_öfo
)

	)

863 
	#SNDRV_TIMER_VERSION
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 7)

	)

866 
	mSNDRV_TIMER_CLASS_NONE
 = -1,

867 
	mSNDRV_TIMER_CLASS_SLAVE
 = 0,

868 
	mSNDRV_TIMER_CLASS_GLOBAL
,

869 
	mSNDRV_TIMER_CLASS_CARD
,

870 
	mSNDRV_TIMER_CLASS_PCM
,

871 
	mSNDRV_TIMER_CLASS_LAST
 = 
SNDRV_TIMER_CLASS_PCM
,

876 
	mSNDRV_TIMER_SCLASS_NONE
 = 0,

877 
	mSNDRV_TIMER_SCLASS_APPLICATION
,

878 
	mSNDRV_TIMER_SCLASS_SEQUENCER
,

879 
	mSNDRV_TIMER_SCLASS_OSS_SEQUENCER
,

880 
	mSNDRV_TIMER_SCLASS_LAST
 = 
SNDRV_TIMER_SCLASS_OSS_SEQUENCER
,

884 
	#SNDRV_TIMER_GLOBAL_SYSTEM
 0

	)

885 
	#SNDRV_TIMER_GLOBAL_RTC
 1

	)

886 
	#SNDRV_TIMER_GLOBAL_HPET
 2

	)

887 
	#SNDRV_TIMER_GLOBAL_HRTIMER
 3

	)

890 
	#SNDRV_TIMER_FLG_SLAVE
 (1<<0Ë

	)

892 
	s¢d_timî_id
 {

893 
	mdev_˛ass
;

894 
	mdev_s˛ass
;

895 
	mˇrd
;

896 
	mdevi˚
;

897 
	msubdevi˚
;

900 
	s¢d_timî_göfo
 {

901 
¢d_timî_id
 
	mtid
;

902 
	mÊags
;

903 
	mˇrd
;

904 
	mid
[64];

905 
	m«me
[80];

906 
	mª£rved0
;

907 
	mªsﬁuti⁄
;

908 
	mªsﬁuti⁄_mö
;

909 
	mªsﬁuti⁄_max
;

910 
	m˛õ¡s
;

911 
	mª£rved
[32];

914 
	s¢d_timî_g∑øms
 {

915 
¢d_timî_id
 
	mtid
;

916 
	m≥riod_num
;

917 
	m≥riod_dí
;

918 
	mª£rved
[32];

921 
	s¢d_timî_g°©us
 {

922 
¢d_timî_id
 
	mtid
;

923 
	mªsﬁuti⁄
;

924 
	mªsﬁuti⁄_num
;

925 
	mªsﬁuti⁄_dí
;

926 
	mª£rved
[32];

929 
	s¢d_timî_£À˘
 {

930 
¢d_timî_id
 
	mid
;

931 
	mª£rved
[32];

934 
	s¢d_timî_öfo
 {

935 
	mÊags
;

936 
	mˇrd
;

937 
	mid
[64];

938 
	m«me
[80];

939 
	mª£rved0
;

940 
	mªsﬁuti⁄
;

941 
	mª£rved
[64];

944 
	#SNDRV_TIMER_PSFLG_AUTO
 (1<<0Ë

	)

945 
	#SNDRV_TIMER_PSFLG_EXCLUSIVE
 (1<<1Ë

	)

946 
	#SNDRV_TIMER_PSFLG_EARLY_EVENT
 (1<<2Ë

	)

948 
	s¢d_timî_∑øms
 {

949 
	mÊags
;

950 
	mticks
;

951 
	mqueue_size
;

952 
	mª£rved0
;

953 
	mfûãr
;

954 
	mª£rved
[60];

957 
	s¢d_timî_°©us
 {

958 
time•ec
 
	mt°amp
;

959 
	mªsﬁuti⁄
;

960 
	mlo°
;

961 
	movîrun
;

962 
	mqueue
;

963 
	mª£rved
[64];

966 
	#SNDRV_TIMER_IOCTL_PVERSION
 
	`_IOR
('T', 0x00, )

	)

967 
	#SNDRV_TIMER_IOCTL_NEXT_DEVICE
 
	`_IOWR
('T', 0x01, 
¢d_timî_id
)

	)

968 
	#SNDRV_TIMER_IOCTL_TREAD_OLD
 
	`_IOW
('T', 0x02, )

	)

969 
	#SNDRV_TIMER_IOCTL_GINFO
 
	`_IOWR
('T', 0x03, 
¢d_timî_göfo
)

	)

970 
	#SNDRV_TIMER_IOCTL_GPARAMS
 
	`_IOW
('T', 0x04, 
¢d_timî_g∑øms
)

	)

971 
	#SNDRV_TIMER_IOCTL_GSTATUS
 
	`_IOWR
('T', 0x05, 
¢d_timî_g°©us
)

	)

972 
	#SNDRV_TIMER_IOCTL_SELECT
 
	`_IOW
('T', 0x10, 
¢d_timî_£À˘
)

	)

973 
	#SNDRV_TIMER_IOCTL_INFO
 
	`_IOR
('T', 0x11, 
¢d_timî_öfo
)

	)

974 
	#SNDRV_TIMER_IOCTL_PARAMS
 
	`_IOW
('T', 0x12, 
¢d_timî_∑øms
)

	)

975 
	#SNDRV_TIMER_IOCTL_STATUS
 
	`_IOR
('T', 0x14, 
¢d_timî_°©us
)

	)

977 
	#SNDRV_TIMER_IOCTL_START
 
	`_IO
('T', 0xa0)

	)

978 
	#SNDRV_TIMER_IOCTL_STOP
 
	`_IO
('T', 0xa1)

	)

979 
	#SNDRV_TIMER_IOCTL_CONTINUE
 
	`_IO
('T', 0xa2)

	)

980 
	#SNDRV_TIMER_IOCTL_PAUSE
 
	`_IO
('T', 0xa3)

	)

981 
	#SNDRV_TIMER_IOCTL_TREAD64
 
	`_IOW
('T', 0xa4, )

	)

983 #i‡
__BITS_PER_LONG
 == 64

984 
	#SNDRV_TIMER_IOCTL_TREAD
 
SNDRV_TIMER_IOCTL_TREAD_OLD


	)

986 
	#SNDRV_TIMER_IOCTL_TREAD
 (((
__kî√l_l⁄g_t
Ë>(
time_t
)) ? \

987 
SNDRV_TIMER_IOCTL_TREAD_OLD
 : \

988 
SNDRV_TIMER_IOCTL_TREAD64
)

	)

991 
	s¢d_timî_ªad
 {

992 
	mªsﬁuti⁄
;

993 
	mticks
;

997 
	mSNDRV_TIMER_EVENT_RESOLUTION
 = 0,

998 
	mSNDRV_TIMER_EVENT_TICK
,

999 
	mSNDRV_TIMER_EVENT_START
,

1000 
	mSNDRV_TIMER_EVENT_STOP
,

1001 
	mSNDRV_TIMER_EVENT_CONTINUE
,

1002 
	mSNDRV_TIMER_EVENT_PAUSE
,

1003 
	mSNDRV_TIMER_EVENT_EARLY
,

1004 
	mSNDRV_TIMER_EVENT_SUSPEND
,

1005 
	mSNDRV_TIMER_EVENT_RESUME
,

1007 
	mSNDRV_TIMER_EVENT_MSTART
 = 
SNDRV_TIMER_EVENT_START
 + 10,

1008 
	mSNDRV_TIMER_EVENT_MSTOP
 = 
SNDRV_TIMER_EVENT_STOP
 + 10,

1009 
	mSNDRV_TIMER_EVENT_MCONTINUE
 = 
SNDRV_TIMER_EVENT_CONTINUE
 + 10,

1010 
	mSNDRV_TIMER_EVENT_MPAUSE
 = 
SNDRV_TIMER_EVENT_PAUSE
 + 10,

1011 
	mSNDRV_TIMER_EVENT_MSUSPEND
 = 
SNDRV_TIMER_EVENT_SUSPEND
 + 10,

1012 
	mSNDRV_TIMER_EVENT_MRESUME
 = 
SNDRV_TIMER_EVENT_RESUME
 + 10,

1015 
	s¢d_timî_åód
 {

1016 
	mevít
;

1017 
__time_∑d
 
	m∑d1
;

1018 
time•ec
 
	mt°amp
;

1019 
	mvÆ
;

1020 
__time_∑d
 
	m∑d2
;

1029 
	#SNDRV_CTL_VERSION
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 9)

	)

1031 
	s¢d_˘l_ˇrd_öfo
 {

1032 
	mˇrd
;

1033 
	m∑d
;

1034 
	mid
[16];

1035 
	mdrivî
[16];

1036 
	m«me
[32];

1037 
	ml⁄g«me
[80];

1038 
	mª£rved_
[16];

1039 
	mmixî«me
[80];

1040 
	mcomp⁄íts
[128];

1043 
	t__bôwi£
 
	t¢d_˘l_ñem_ty≥_t
;

1044 
	#SNDRV_CTL_ELEM_TYPE_NONE
 ((
¢d_˘l_ñem_ty≥_t
Ë0Ë

	)

1045 
	#SNDRV_CTL_ELEM_TYPE_BOOLEAN
 ((
¢d_˘l_ñem_ty≥_t
Ë1Ë

	)

1046 
	#SNDRV_CTL_ELEM_TYPE_INTEGER
 ((
¢d_˘l_ñem_ty≥_t
Ë2Ë

	)

1047 
	#SNDRV_CTL_ELEM_TYPE_ENUMERATED
 ((
¢d_˘l_ñem_ty≥_t
Ë3Ë

	)

1048 
	#SNDRV_CTL_ELEM_TYPE_BYTES
 ((
¢d_˘l_ñem_ty≥_t
Ë4Ë

	)

1049 
	#SNDRV_CTL_ELEM_TYPE_IEC958
 ((
¢d_˘l_ñem_ty≥_t
Ë5Ë

	)

1050 
	#SNDRV_CTL_ELEM_TYPE_INTEGER64
 ((
¢d_˘l_ñem_ty≥_t
Ë6Ë

	)

1051 
	#SNDRV_CTL_ELEM_TYPE_LAST
 
SNDRV_CTL_ELEM_TYPE_INTEGER64


	)

1053 
	t__bôwi£
 
	t¢d_˘l_ñem_iÁ˚_t
;

1054 
	#SNDRV_CTL_ELEM_IFACE_CARD
 ((
¢d_˘l_ñem_iÁ˚_t
Ë0Ë

	)

1055 
	#SNDRV_CTL_ELEM_IFACE_HWDEP
 ((
¢d_˘l_ñem_iÁ˚_t
Ë1Ë

	)

1056 
	#SNDRV_CTL_ELEM_IFACE_MIXER
 ((
¢d_˘l_ñem_iÁ˚_t
Ë2Ë

	)

1057 
	#SNDRV_CTL_ELEM_IFACE_PCM
 ((
¢d_˘l_ñem_iÁ˚_t
Ë3Ë

	)

1058 
	#SNDRV_CTL_ELEM_IFACE_RAWMIDI
 ((
¢d_˘l_ñem_iÁ˚_t
Ë4Ë

	)

1059 
	#SNDRV_CTL_ELEM_IFACE_TIMER
 ((
¢d_˘l_ñem_iÁ˚_t
Ë5Ë

	)

1060 
	#SNDRV_CTL_ELEM_IFACE_SEQUENCER
 ((
¢d_˘l_ñem_iÁ˚_t
Ë6Ë

	)

1061 
	#SNDRV_CTL_ELEM_IFACE_LAST
 
SNDRV_CTL_ELEM_IFACE_SEQUENCER


	)

1063 
	#SNDRV_CTL_ELEM_ACCESS_READ
 (1<<0)

	)

1064 
	#SNDRV_CTL_ELEM_ACCESS_WRITE
 (1<<1)

	)

1065 
	#SNDRV_CTL_ELEM_ACCESS_READWRITE
 (
SNDRV_CTL_ELEM_ACCESS_READ
|
SNDRV_CTL_ELEM_ACCESS_WRITE
)

	)

1066 
	#SNDRV_CTL_ELEM_ACCESS_VOLATILE
 (1<<2Ë

	)

1068 
	#SNDRV_CTL_ELEM_ACCESS_TLV_READ
 (1<<4Ë

	)

1069 
	#SNDRV_CTL_ELEM_ACCESS_TLV_WRITE
 (1<<5Ë

	)

1070 
	#SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
 (
SNDRV_CTL_ELEM_ACCESS_TLV_READ
|
SNDRV_CTL_ELEM_ACCESS_TLV_WRITE
)

	)

1071 
	#SNDRV_CTL_ELEM_ACCESS_TLV_COMMAND
 (1<<6Ë

	)

1072 
	#SNDRV_CTL_ELEM_ACCESS_INACTIVE
 (1<<8Ë

	)

1073 
	#SNDRV_CTL_ELEM_ACCESS_LOCK
 (1<<9Ë

	)

1074 
	#SNDRV_CTL_ELEM_ACCESS_OWNER
 (1<<10Ë

	)

1075 
	#SNDRV_CTL_ELEM_ACCESS_TLV_CALLBACK
 (1<<28Ë

	)

1076 
	#SNDRV_CTL_ELEM_ACCESS_USER
 (1<<29Ë

	)

1080 
	#SNDRV_CTL_POWER_D0
 0x0000

	)

1081 
	#SNDRV_CTL_POWER_D1
 0x0100

	)

1082 
	#SNDRV_CTL_POWER_D2
 0x0200

	)

1083 
	#SNDRV_CTL_POWER_D3
 0x0300

	)

1084 
	#SNDRV_CTL_POWER_D3hŸ
 (
SNDRV_CTL_POWER_D3
|0x0000Ë

	)

1085 
	#SNDRV_CTL_POWER_D3cﬁd
 (
SNDRV_CTL_POWER_D3
|0x0001Ë

	)

1087 
	#SNDRV_CTL_ELEM_ID_NAME_MAXLEN
 44

	)

1089 
	s¢d_˘l_ñem_id
 {

1090 
	mnumid
;

1091 
¢d_˘l_ñem_iÁ˚_t
 
	miÁ˚
;

1092 
	mdevi˚
;

1093 
	msubdevi˚
;

1094 
	m«me
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

1095 
	mödex
;

1098 
	s¢d_˘l_ñem_li°
 {

1099 
	moff£t
;

1100 
	m•a˚
;

1101 
	mu£d
;

1102 
	mcou¡
;

1103 
¢d_˘l_ñem_id
 *
	mpids
;

1104 
	mª£rved
[50];

1107 
	s¢d_˘l_ñem_öfo
 {

1108 
¢d_˘l_ñem_id
 
	mid
;

1109 
¢d_˘l_ñem_ty≥_t
 
	mty≥
;

1110 
	mac˚ss
;

1111 
	mcou¡
;

1112 
__kî√l_pid_t
 
	mow√r
;

1115 
	mmö
;

1116 
	mmax
;

1117 
	m°ï
;

1118 } 
	möãgî
;

1120 
	mmö
;

1121 
	mmax
;

1122 
	m°ï
;

1123 } 
	möãgî64
;

1125 
	môems
;

1126 
	môem
;

1127 
	m«me
[64];

1128 
__u64
 
	m«mes_±r
;

1129 
	m«mes_Àngth
;

1130 } 
	míumî©ed
;

1131 
	mª£rved
[128];

1132 } 
	mvÆue
;

1133 
	mª£rved
[64];

1136 
	s¢d_˘l_ñem_vÆue
 {

1137 
¢d_˘l_ñem_id
 
	mid
;

1138 
	mödúe˘
: 1;

1141 
	mvÆue
[128];

1142 *
	mvÆue_±r
;

1143 } 
	möãgî
;

1145 
	mvÆue
[64];

1146 *
	mvÆue_±r
;

1147 } 
	möãgî64
;

1149 
	môem
[128];

1150 *
	môem_±r
;

1151 } 
	míumî©ed
;

1153 
	md©a
[512];

1154 *
	md©a_±r
;

1155 } 
	mbyãs
;

1156 
¢d_´s_õc958
 
	mõc958
;

1157 } 
	mvÆue
;

1158 
	mª£rved
[128];

1161 
	s¢d_˘l_év
 {

1162 
	mnumid
;

1163 
	mÀngth
;

1164 
	mév
[0];

1167 
	#SNDRV_CTL_IOCTL_PVERSION
 
	`_IOR
('U', 0x00, )

	)

1168 
	#SNDRV_CTL_IOCTL_CARD_INFO
 
	`_IOR
('U', 0x01, 
¢d_˘l_ˇrd_öfo
)

	)

1169 
	#SNDRV_CTL_IOCTL_ELEM_LIST
 
	`_IOWR
('U', 0x10, 
¢d_˘l_ñem_li°
)

	)

1170 
	#SNDRV_CTL_IOCTL_ELEM_INFO
 
	`_IOWR
('U', 0x11, 
¢d_˘l_ñem_öfo
)

	)

1171 
	#SNDRV_CTL_IOCTL_ELEM_READ
 
	`_IOWR
('U', 0x12, 
¢d_˘l_ñem_vÆue
)

	)

1172 
	#SNDRV_CTL_IOCTL_ELEM_WRITE
 
	`_IOWR
('U', 0x13, 
¢d_˘l_ñem_vÆue
)

	)

1173 
	#SNDRV_CTL_IOCTL_ELEM_LOCK
 
	`_IOW
('U', 0x14, 
¢d_˘l_ñem_id
)

	)

1174 
	#SNDRV_CTL_IOCTL_ELEM_UNLOCK
 
	`_IOW
('U', 0x15, 
¢d_˘l_ñem_id
)

	)

1175 
	#SNDRV_CTL_IOCTL_SUBSCRIBE_EVENTS
 
	`_IOWR
('U', 0x16, )

	)

1176 
	#SNDRV_CTL_IOCTL_ELEM_ADD
 
	`_IOWR
('U', 0x17, 
¢d_˘l_ñem_öfo
)

	)

1177 
	#SNDRV_CTL_IOCTL_ELEM_REPLACE
 
	`_IOWR
('U', 0x18, 
¢d_˘l_ñem_öfo
)

	)

1178 
	#SNDRV_CTL_IOCTL_ELEM_REMOVE
 
	`_IOWR
('U', 0x19, 
¢d_˘l_ñem_id
)

	)

1179 
	#SNDRV_CTL_IOCTL_TLV_READ
 
	`_IOWR
('U', 0x1a, 
¢d_˘l_év
)

	)

1180 
	#SNDRV_CTL_IOCTL_TLV_WRITE
 
	`_IOWR
('U', 0x1b, 
¢d_˘l_év
)

	)

1181 
	#SNDRV_CTL_IOCTL_TLV_COMMAND
 
	`_IOWR
('U', 0x1c, 
¢d_˘l_év
)

	)

1182 
	#SNDRV_CTL_IOCTL_HWDEP_NEXT_DEVICE
 
	`_IOWR
('U', 0x20, )

	)

1183 
	#SNDRV_CTL_IOCTL_HWDEP_INFO
 
	`_IOR
('U', 0x21, 
¢d_hwdï_öfo
)

	)

1184 
	#SNDRV_CTL_IOCTL_PCM_NEXT_DEVICE
 
	`_IOR
('U', 0x30, )

	)

1185 
	#SNDRV_CTL_IOCTL_PCM_INFO
 
	`_IOWR
('U', 0x31, 
¢d_pcm_öfo
)

	)

1186 
	#SNDRV_CTL_IOCTL_PCM_PREFER_SUBDEVICE
 
	`_IOW
('U', 0x32, )

	)

1187 
	#SNDRV_CTL_IOCTL_RAWMIDI_NEXT_DEVICE
 
	`_IOWR
('U', 0x40, )

	)

1188 
	#SNDRV_CTL_IOCTL_RAWMIDI_INFO
 
	`_IOWR
('U', 0x41, 
¢d_øwmidi_öfo
)

	)

1189 
	#SNDRV_CTL_IOCTL_RAWMIDI_PREFER_SUBDEVICE
 
	`_IOW
('U', 0x42, )

	)

1190 
	#SNDRV_CTL_IOCTL_UMP_NEXT_DEVICE
 
	`_IOWR
('U', 0x43, )

	)

1191 
	#SNDRV_CTL_IOCTL_UMP_ENDPOINT_INFO
 
	`_IOWR
('U', 0x44, 
¢d_ump_ídpoöt_öfo
)

	)

1192 
	#SNDRV_CTL_IOCTL_UMP_BLOCK_INFO
 
	`_IOWR
('U', 0x45, 
¢d_ump_block_öfo
)

	)

1193 
	#SNDRV_CTL_IOCTL_POWER
 
	`_IOWR
('U', 0xd0, )

	)

1194 
	#SNDRV_CTL_IOCTL_POWER_STATE
 
	`_IOR
('U', 0xd1, )

	)

1200 
	e¢drv_˘l_evít_ty≥
 {

1201 
	mSNDRV_CTL_EVENT_ELEM
 = 0,

1202 
	mSNDRV_CTL_EVENT_LAST
 = 
SNDRV_CTL_EVENT_ELEM
,

1205 
	#SNDRV_CTL_EVENT_MASK_VALUE
 (1<<0Ë

	)

1206 
	#SNDRV_CTL_EVENT_MASK_INFO
 (1<<1Ë

	)

1207 
	#SNDRV_CTL_EVENT_MASK_ADD
 (1<<2Ë

	)

1208 
	#SNDRV_CTL_EVENT_MASK_TLV
 (1<<3Ë

	)

1209 
	#SNDRV_CTL_EVENT_MASK_REMOVE
 (~0UË

	)

1211 
	s¢d_˘l_evít
 {

1212 
	mty≥
;

1215 
	mmask
;

1216 
¢d_˘l_ñem_id
 
	mid
;

1217 } 
	mñem
;

1218 
	md©a8
[60];

1219 } 
	md©a
;

1226 
	#SNDRV_CTL_NAME_NONE
 ""

	)

1227 
	#SNDRV_CTL_NAME_PLAYBACK
 "Pœyback "

	)

1228 
	#SNDRV_CTL_NAME_CAPTURE
 "C≠tuª "

	)

1230 
	#SNDRV_CTL_NAME_IEC958_NONE
 ""

	)

1231 
	#SNDRV_CTL_NAME_IEC958_SWITCH
 "Swôch"

	)

1232 
	#SNDRV_CTL_NAME_IEC958_VOLUME
 "Vﬁume"

	)

1233 
	#SNDRV_CTL_NAME_IEC958_DEFAULT
 "DeÁu…"

	)

1234 
	#SNDRV_CTL_NAME_IEC958_MASK
 "Mask"

	)

1235 
	#SNDRV_CTL_NAME_IEC958_CON_MASK
 "C⁄ Mask"

	)

1236 
	#SNDRV_CTL_NAME_IEC958_PRO_MASK
 "PrÿMask"

	)

1237 
	#SNDRV_CTL_NAME_IEC958_PCM_STREAM
 "PCM Såóm"

	)

1238 
	#SNDRV_CTL_NAME_IEC958
(
ex∂
,
dúe˘i⁄
,
wh©
Ë"IEC958 "Éx∂ 
SNDRV_CTL_NAME_
##dúe˘i⁄ 
SNDRV_CTL_NAME_IEC958_
##
	)
what

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asound_fm.h

2 #i‚de‡
__SOUND_ASOUND_FM_H


3 
	#__SOUND_ASOUND_FM_H


	)

30 
	#SNDRV_DM_FM_MODE_OPL2
 0x00

	)

31 
	#SNDRV_DM_FM_MODE_OPL3
 0x01

	)

33 
	s¢d_dm_fm_öfo
 {

34 
	mfm_mode
;

35 
	mrhythm
;

42 
	s¢d_dm_fm_voi˚
 {

43 
	m›
;

44 
	mvoi˚
;

46 
	mam
;

47 
	mvibøto
;

48 
	mdo_su°aö
;

49 
	mkbd_sˇÀ
;

50 
	mh¨m⁄ic
;

51 
	msˇÀ_Àvñ
;

52 
	mvﬁume
;

54 
	m©èck
;

55 
	mdeˇy
;

56 
	msu°aö
;

57 
	mªÀa£
;

59 
	m„edback
;

60 
	mc⁄√˘i⁄
;

61 
	mÀ·
;

62 
	mright
;

63 
	mwavef‹m
;

71 
	s¢d_dm_fm_nŸe
 {

72 
	mvoi˚
;

73 
	mo˘ave
;

74 
	m‚um
;

75 
	mkey_⁄
;

82 
	s¢d_dm_fm_∑øms
 {

83 
	mam_dïth
;

84 
	mvib_dïth
;

85 
	mkbd_•lô
;

86 
	mrhythm
;

89 
	mbass
;

90 
	m¢¨e
;

91 
	mtomtom
;

92 
	mcymbÆ
;

93 
	mhih©
;

100 
	#SNDRV_DM_FM_IOCTL_INFO
 
	`_IOR
('H', 0x20, 
¢d_dm_fm_öfo
)

	)

101 
	#SNDRV_DM_FM_IOCTL_RESET
 
	`_IO
 ('H', 0x21)

	)

102 
	#SNDRV_DM_FM_IOCTL_PLAY_NOTE
 
	`_IOW
('H', 0x22, 
¢d_dm_fm_nŸe
)

	)

103 
	#SNDRV_DM_FM_IOCTL_SET_VOICE
 
	`_IOW
('H', 0x23, 
¢d_dm_fm_voi˚
)

	)

104 
	#SNDRV_DM_FM_IOCTL_SET_PARAMS
 
	`_IOW
('H', 0x24, 
¢d_dm_fm_∑øms
)

	)

105 
	#SNDRV_DM_FM_IOCTL_SET_MODE
 
	`_IOW
('H', 0x25, )

	)

107 
	#SNDRV_DM_FM_IOCTL_SET_CONNECTION
 
	`_IOW
('H', 0x26, )

	)

109 
	#SNDRV_DM_FM_IOCTL_CLEAR_PATCHES
 
	`_IO
 ('H', 0x40)

	)

111 
	#SNDRV_DM_FM_OSS_IOCTL_RESET
 0x20

	)

112 
	#SNDRV_DM_FM_OSS_IOCTL_PLAY_NOTE
 0x21

	)

113 
	#SNDRV_DM_FM_OSS_IOCTL_SET_VOICE
 0x22

	)

114 
	#SNDRV_DM_FM_OSS_IOCTL_SET_PARAMS
 0x23

	)

115 
	#SNDRV_DM_FM_OSS_IOCTL_SET_MODE
 0x24

	)

116 
	#SNDRV_DM_FM_OSS_IOCTL_SET_OPL
 0x25

	)

122 
	#FM_KEY_SBI
 "SBI\032"

	)

123 
	#FM_KEY_2OP
 "2OP\032"

	)

124 
	#FM_KEY_4OP
 "4OP\032"

	)

126 
	ssbi_∑tch
 {

127 
	m¥og
;

128 
	mb™k
;

129 
	mkey
[4];

130 
	m«me
[25];

131 
	mexãnsi⁄
[7];

132 
	md©a
[32];

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/emu10k1.h

23 #i‚de‡
__SOUND_EMU10K1_H


24 
	#__SOUND_EMU10K1_H


	)

26 #ifde‡
__löux__


27 
	~<löux/ty≥s.h
>

34 
	#EMU10K1_CARD_CREATIVE
 0x00000000

	)

35 
	#EMU10K1_CARD_EMUAPS
 0x00000001

	)

37 
	#EMU10K1_FX8010_PCM_COUNT
 8

	)

44 
	#__EMU10K1_DECLARE_BITMAP
(
«me
,
bôs
) \

45 
«me
[(
bôs
Ë/ ((Ë* 8)]

	)

48 
	#iMAC0
 0x00

	)

49 
	#iMAC1
 0x01

	)

50 
	#iMAC2
 0x02

	)

51 
	#iMAC3
 0x03

	)

52 
	#iMACINT0
 0x04

	)

53 
	#iMACINT1
 0x05

	)

54 
	#iACC3
 0x06

	)

55 
	#iMACMV
 0x07

	)

56 
	#iANDXOR
 0x08

	)

57 
	#iTSTNEG
 0x09

	)

58 
	#iLIMITGE
 0x0®

	)

59 
	#iLIMITLT
 0x0b

	)

60 
	#iLOG
 0x0¯

	)

61 
	#iEXP
 0x0d

	)

62 
	#iINTERP
 0x0ê

	)

63 
	#iSKIP
 0x0‡

	)

66 
	#FXBUS
(
x
Ë(0x00 + (x)Ë

	)

67 
	#EXTIN
(
x
Ë(0x10 + (x)Ë

	)

68 
	#EXTOUT
(
x
Ë(0x20 + (x)Ë

	)

69 
	#FXBUS2
(
x
Ë(0x30 + (x)Ë

	)

72 
	#C_00000000
 0x40

	)

73 
	#C_00000001
 0x41

	)

74 
	#C_00000002
 0x42

	)

75 
	#C_00000003
 0x43

	)

76 
	#C_00000004
 0x44

	)

77 
	#C_00000008
 0x45

	)

78 
	#C_00000010
 0x46

	)

79 
	#C_00000020
 0x47

	)

80 
	#C_00000100
 0x48

	)

81 
	#C_00010000
 0x49

	)

82 
	#C_00080000
 0x4a

	)

83 
	#C_10000000
 0x4b

	)

84 
	#C_20000000
 0x4c

	)

85 
	#C_40000000
 0x4d

	)

86 
	#C_80000000
 0x4e

	)

87 
	#C_7fffffff
 0x4f

	)

88 
	#C_ffffffff
 0x50

	)

89 
	#C_ffffff„
 0x51

	)

90 
	#C_c0000000
 0x52

	)

91 
	#C_4f1bbcdc
 0x53

	)

92 
	#C_5a7ef9db
 0x54

	)

93 
	#C_00100000
 0x55

	)

94 
	#GPR_ACCU
 0x56

	)

95 
	#GPR_COND
 0x57

	)

96 
	#GPR_NOISE0
 0x58

	)

97 
	#GPR_NOISE1
 0x59

	)

98 
	#GPR_IRQ
 0x5®

	)

99 
	#GPR_DBAC
 0x5b

	)

100 
	#GPR
(
x
Ë(
FXGPREGBASE
 + (x)Ë

	)

101 
	#ITRAM_DATA
(
x
Ë(
TANKMEMDATAREGBASE
 + 0x00 + (x)Ë

	)

102 
	#ETRAM_DATA
(
x
Ë(
TANKMEMDATAREGBASE
 + 0x80 + (x)Ë

	)

103 
	#ITRAM_ADDR
(
x
Ë(
TANKMEMADDRREGBASE
 + 0x00 + (x)Ë

	)

104 
	#ETRAM_ADDR
(
x
Ë(
TANKMEMADDRREGBASE
 + 0x80 + (x)Ë

	)

106 
	#A_ITRAM_DATA
(
x
Ë(
TANKMEMDATAREGBASE
 + 0x00 + (x)Ë

	)

107 
	#A_ETRAM_DATA
(
x
Ë(
TANKMEMDATAREGBASE
 + 0xc0 + (x)Ë

	)

108 
	#A_ITRAM_ADDR
(
x
Ë(
TANKMEMADDRREGBASE
 + 0x00 + (x)Ë

	)

109 
	#A_ETRAM_ADDR
(
x
Ë(
TANKMEMADDRREGBASE
 + 0xc0 + (x)Ë

	)

110 
	#A_ITRAM_CTL
(
x
Ë(
A_TANKMEMCTLREGBASE
 + 0x00 + (x)Ë

	)

111 
	#A_ETRAM_CTL
(
x
Ë(
A_TANKMEMCTLREGBASE
 + 0xc0 + (x)Ë

	)

113 
	#A_FXBUS
(
x
Ë(0x00 + (x)Ë

	)

114 
	#A_EXTIN
(
x
Ë(0x40 + (x)Ë

	)

115 
	#A_P16VIN
(
x
Ë(0x50 + (x)Ë

	)

116 
	#A_EXTOUT
(
x
Ë(0x60 + (x)Ë

	)

117 
	#A_FXBUS2
(
x
Ë(0x80 + (x)Ë

	)

118 
	#A_EMU32OUTH
(
x
Ë(0xa0 + (x)Ë

	)

119 
	#A_EMU32OUTL
(
x
Ë(0xb0 + (x)Ë

	)

120 
	#A3_EMU32IN
(
x
Ë(0x160 + (x)Ë

	)

121 
	#A3_EMU32OUT
(
x
Ë(0x1E0 + (x)Ë

	)

122 
	#A_GPR
(
x
Ë(
A_FXGPREGBASE
 + (x))

	)

125 
	#CC_REG_NORMALIZED
 
C_00000001


	)

126 
	#CC_REG_BORROW
 
C_00000002


	)

127 
	#CC_REG_MINUS
 
C_00000004


	)

128 
	#CC_REG_ZERO
 
C_00000008


	)

129 
	#CC_REG_SATURATE
 
C_00000010


	)

130 
	#CC_REG_NONZERO
 
C_00000100


	)

133 
	#FXBUS_PCM_LEFT
 0x00

	)

134 
	#FXBUS_PCM_RIGHT
 0x01

	)

135 
	#FXBUS_PCM_LEFT_REAR
 0x02

	)

136 
	#FXBUS_PCM_RIGHT_REAR
 0x03

	)

137 
	#FXBUS_MIDI_LEFT
 0x04

	)

138 
	#FXBUS_MIDI_RIGHT
 0x05

	)

139 
	#FXBUS_PCM_CENTER
 0x06

	)

140 
	#FXBUS_PCM_LFE
 0x07

	)

141 
	#FXBUS_PCM_LEFT_FRONT
 0x08

	)

142 
	#FXBUS_PCM_RIGHT_FRONT
 0x09

	)

143 
	#FXBUS_MIDI_REVERB
 0x0c

	)

144 
	#FXBUS_MIDI_CHORUS
 0x0d

	)

145 
	#FXBUS_PCM_LEFT_SIDE
 0x0e

	)

146 
	#FXBUS_PCM_RIGHT_SIDE
 0x0f

	)

147 
	#FXBUS_PT_LEFT
 0x14

	)

148 
	#FXBUS_PT_RIGHT
 0x15

	)

151 
	#EXTIN_AC97_L
 0x00

	)

152 
	#EXTIN_AC97_R
 0x01

	)

153 
	#EXTIN_SPDIF_CD_L
 0x02

	)

154 
	#EXTIN_SPDIF_CD_R
 0x03

	)

155 
	#EXTIN_ZOOM_L
 0x04

	)

156 
	#EXTIN_ZOOM_R
 0x05

	)

157 
	#EXTIN_TOSLINK_L
 0x06

	)

158 
	#EXTIN_TOSLINK_R
 0x07

	)

159 
	#EXTIN_LINE1_L
 0x08

	)

160 
	#EXTIN_LINE1_R
 0x09

	)

161 
	#EXTIN_COAX_SPDIF_L
 0x0®

	)

162 
	#EXTIN_COAX_SPDIF_R
 0x0b

	)

163 
	#EXTIN_LINE2_L
 0x0¯

	)

164 
	#EXTIN_LINE2_R
 0x0d

	)

167 
	#EXTOUT_AC97_L
 0x00

	)

168 
	#EXTOUT_AC97_R
 0x01

	)

169 
	#EXTOUT_TOSLINK_L
 0x02

	)

170 
	#EXTOUT_TOSLINK_R
 0x03

	)

171 
	#EXTOUT_AC97_CENTER
 0x04

	)

172 
	#EXTOUT_AC97_LFE
 0x05

	)

173 
	#EXTOUT_HEADPHONE_L
 0x06

	)

174 
	#EXTOUT_HEADPHONE_R
 0x07

	)

175 
	#EXTOUT_REAR_L
 0x08

	)

176 
	#EXTOUT_REAR_R
 0x09

	)

177 
	#EXTOUT_ADC_CAP_L
 0x0®

	)

178 
	#EXTOUT_ADC_CAP_R
 0x0b

	)

179 
	#EXTOUT_MIC_CAP
 0x0¯

	)

180 
	#EXTOUT_AC97_REAR_L
 0x0d

	)

181 
	#EXTOUT_AC97_REAR_R
 0x0ê

	)

182 
	#EXTOUT_ACENTER
 0x11

	)

183 
	#EXTOUT_ALFE
 0x12

	)

186 
	#A_EXTIN_AC97_L
 0x00

	)

187 
	#A_EXTIN_AC97_R
 0x01

	)

188 
	#A_EXTIN_SPDIF_CD_L
 0x02

	)

189 
	#A_EXTIN_SPDIF_CD_R
 0x03

	)

190 
	#A_EXTIN_OPT_SPDIF_L
 0x04

	)

191 
	#A_EXTIN_OPT_SPDIF_R
 0x05

	)

192 
	#A_EXTIN_LINE2_L
 0x08

	)

193 
	#A_EXTIN_LINE2_R
 0x09

	)

194 
	#A_EXTIN_ADC_L
 0x0®

	)

195 
	#A_EXTIN_ADC_R
 0x0b

	)

196 
	#A_EXTIN_AUX2_L
 0x0¯

	)

197 
	#A_EXTIN_AUX2_R
 0x0d

	)

200 
	#A_EXTOUT_FRONT_L
 0x00

	)

201 
	#A_EXTOUT_FRONT_R
 0x01

	)

202 
	#A_EXTOUT_CENTER
 0x02

	)

203 
	#A_EXTOUT_LFE
 0x03

	)

204 
	#A_EXTOUT_HEADPHONE_L
 0x04

	)

205 
	#A_EXTOUT_HEADPHONE_R
 0x05

	)

206 
	#A_EXTOUT_REAR_L
 0x06

	)

207 
	#A_EXTOUT_REAR_R
 0x07

	)

208 
	#A_EXTOUT_AFRONT_L
 0x08

	)

209 
	#A_EXTOUT_AFRONT_R
 0x09

	)

210 
	#A_EXTOUT_ACENTER
 0x0®

	)

211 
	#A_EXTOUT_ALFE
 0x0b

	)

212 
	#A_EXTOUT_ASIDE_L
 0x0¯

	)

213 
	#A_EXTOUT_ASIDE_R
 0x0d

	)

214 
	#A_EXTOUT_AREAR_L
 0x0ê

	)

215 
	#A_EXTOUT_AREAR_R
 0x0‡

	)

216 
	#A_EXTOUT_AC97_L
 0x10

	)

217 
	#A_EXTOUT_AC97_R
 0x11

	)

218 
	#A_EXTOUT_ADC_CAP_L
 0x16

	)

219 
	#A_EXTOUT_ADC_CAP_R
 0x17

	)

220 
	#A_EXTOUT_MIC_CAP
 0x18

	)

223 
	#A_C_00000000
 0xc0

	)

224 
	#A_C_00000001
 0xc1

	)

225 
	#A_C_00000002
 0xc2

	)

226 
	#A_C_00000003
 0xc3

	)

227 
	#A_C_00000004
 0xc4

	)

228 
	#A_C_00000008
 0xc5

	)

229 
	#A_C_00000010
 0xc6

	)

230 
	#A_C_00000020
 0xc7

	)

231 
	#A_C_00000100
 0xc8

	)

232 
	#A_C_00010000
 0xc9

	)

233 
	#A_C_00000800
 0xˇ

	)

234 
	#A_C_10000000
 0xcb

	)

235 
	#A_C_20000000
 0xcc

	)

236 
	#A_C_40000000
 0xcd

	)

237 
	#A_C_80000000
 0x˚

	)

238 
	#A_C_7fffffff
 0xcf

	)

239 
	#A_C_ffffffff
 0xd0

	)

240 
	#A_C_ffffff„
 0xd1

	)

241 
	#A_C_c0000000
 0xd2

	)

242 
	#A_C_4f1bbcdc
 0xd3

	)

243 
	#A_C_5a7ef9db
 0xd4

	)

244 
	#A_C_00100000
 0xd5

	)

245 
	#A_GPR_ACCU
 0xd6

	)

246 
	#A_GPR_COND
 0xd7

	)

247 
	#A_GPR_NOISE0
 0xd8

	)

248 
	#A_GPR_NOISE1
 0xd9

	)

249 
	#A_GPR_IRQ
 0xd®

	)

250 
	#A_GPR_DBAC
 0xdb

	)

251 
	#A_GPR_DBACE
 0xdê

	)

254 
	#EMU10K1_DBG_ZC
 0x80000000

	)

255 
	#EMU10K1_DBG_SATURATION_OCCURED
 0x02000000

	)

256 
	#EMU10K1_DBG_SATURATION_ADDR
 0x01ff0000

	)

257 
	#EMU10K1_DBG_SINGLE_STEP
 0x00008000

	)

258 
	#EMU10K1_DBG_STEP
 0x00004000

	)

259 
	#EMU10K1_DBG_CONDITION_CODE
 0x00003e00

	)

260 
	#EMU10K1_DBG_SINGLE_STEP_ADDR
 0x000001f‡

	)

263 
	#TANKMEMADDRREG_ADDR_MASK
 0x000ffff‡

	)

264 
	#TANKMEMADDRREG_CLEAR
 0x00800000

	)

265 
	#TANKMEMADDRREG_ALIGN
 0x00400000

	)

266 
	#TANKMEMADDRREG_WRITE
 0x00200000

	)

267 
	#TANKMEMADDRREG_READ
 0x00100000

	)

269 
	s¢d_emu10k1_fx8010_öfo
 {

270 
	möã∫Æ_åam_size
;

271 
	mexã∫Æ_åam_size
;

272 
	mfxbus_«mes
[16][32];

273 
	mextö_«mes
[16][32];

274 
	mextout_«mes
[32][32];

275 
	mg¥_c⁄åﬁs
;

278 
	#EMU10K1_GPR_TRANSLATION_NONE
 0

	)

279 
	#EMU10K1_GPR_TRANSLATION_TABLE100
 1

	)

280 
	#EMU10K1_GPR_TRANSLATION_BASS
 2

	)

281 
	#EMU10K1_GPR_TRANSLATION_TREBLE
 3

	)

282 
	#EMU10K1_GPR_TRANSLATION_ONOFF
 4

	)

284 
	eemu10k1_˘l_ñem_iÁ˚
 {

285 
	mEMU10K1_CTL_ELEM_IFACE_MIXER
 = 2,

286 
	mEMU10K1_CTL_ELEM_IFACE_PCM
 = 3,

289 
	semu10k1_˘l_ñem_id
 {

290 
	m∑d
;

291 
	miÁ˚
;

292 
	mdevi˚
;

293 
	msubdevi˚
;

294 
	m«me
[44];

295 
	mödex
;

298 
	s¢d_emu10k1_fx8010_c⁄åﬁ_g¥
 {

299 
emu10k1_˘l_ñem_id
 
	mid
;

300 
	mvcou¡
;

301 
	mcou¡
;

302 
	mg¥
[32];

303 
	mvÆue
[32];

304 
	mmö
;

305 
	mmax
;

306 
	må™¶©i⁄
;

307 c⁄° *
	mév
;

311 
	s¢d_emu10k1_fx8010_c⁄åﬁ_ﬁd_g¥
 {

312 
emu10k1_˘l_ñem_id
 
	mid
;

313 
	mvcou¡
;

314 
	mcou¡
;

315 
	mg¥
[32];

316 
	mvÆue
[32];

317 
	mmö
;

318 
	mmax
;

319 
	må™¶©i⁄
;

322 
	s¢d_emu10k1_fx8010_code
 {

323 
	m«me
[128];

325 
__EMU10K1_DECLARE_BITMAP
(
g¥_vÆid
, 0x200);

326 
__u32
 *
	mg¥_m≠
;

328 
	mg¥_add_c⁄åﬁ_cou¡
;

329 
¢d_emu10k1_fx8010_c⁄åﬁ_g¥
 *
	mg¥_add_c⁄åﬁs
;

331 
	mg¥_dñ_c⁄åﬁ_cou¡
;

332 
emu10k1_˘l_ñem_id
 *
	mg¥_dñ_c⁄åﬁs
;

334 
	mg¥_li°_c⁄åﬁ_cou¡
;

335 
	mg¥_li°_c⁄åﬁ_tŸÆ
;

336 
¢d_emu10k1_fx8010_c⁄åﬁ_g¥
 *
	mg¥_li°_c⁄åﬁs
;

338 
__EMU10K1_DECLARE_BITMAP
(
åam_vÆid
, 0x100);

339 
__u32
 *
	måam_d©a_m≠
;

340 
__u32
 *
	måam_addr_m≠
;

342 
__EMU10K1_DECLARE_BITMAP
(
code_vÆid
, 1024);

343 
__u32
 *
	mcode
;

346 
	s¢d_emu10k1_fx8010_åam
 {

347 
	maddªss
;

348 
	msize
;

349 *
	mßm∂es
;

353 
	s¢d_emu10k1_fx8010_pcm_ªc
 {

354 
	msub°ªam
;

355 
	mªs1
;

356 
	mch™√ls
;

357 
	måam_°¨t
;

358 
	mbuf„r_size
;

359 
	mg¥_size
;

360 
	mg¥_±r
;

361 
	mg¥_cou¡
;

362 
	mg¥_tmpcou¡
;

363 
	mg¥_åiggî
;

364 
	mg¥_ru¬ög
;

365 
	m∑d
;

366 
	mëøm
[32];

367 
	mªs2
;

370 
	#SNDRV_EMU10K1_VERSION
 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 1)

	)

372 
	#SNDRV_EMU10K1_IOCTL_INFO
 
	`_IOR
 ('H', 0x10, 
¢d_emu10k1_fx8010_öfo
)

	)

373 
	#SNDRV_EMU10K1_IOCTL_CODE_POKE
 
	`_IOW
 ('H', 0x11, 
¢d_emu10k1_fx8010_code
)

	)

374 
	#SNDRV_EMU10K1_IOCTL_CODE_PEEK
 
	`_IOWR
('H', 0x12, 
¢d_emu10k1_fx8010_code
)

	)

375 
	#SNDRV_EMU10K1_IOCTL_TRAM_SETUP
 
	`_IOW
 ('H', 0x20, )

	)

376 
	#SNDRV_EMU10K1_IOCTL_TRAM_POKE
 
	`_IOW
 ('H', 0x21, 
¢d_emu10k1_fx8010_åam
)

	)

377 
	#SNDRV_EMU10K1_IOCTL_TRAM_PEEK
 
	`_IOWR
('H', 0x22, 
¢d_emu10k1_fx8010_åam
)

	)

378 
	#SNDRV_EMU10K1_IOCTL_PCM_POKE
 
	`_IOW
 ('H', 0x30, 
¢d_emu10k1_fx8010_pcm_ªc
)

	)

379 
	#SNDRV_EMU10K1_IOCTL_PCM_PEEK
 
	`_IOWR
('H', 0x31, 
¢d_emu10k1_fx8010_pcm_ªc
)

	)

380 
	#SNDRV_EMU10K1_IOCTL_PVERSION
 
	`_IOR
 ('H', 0x40, )

	)

381 
	#SNDRV_EMU10K1_IOCTL_STOP
 
	`_IO
 ('H', 0x80)

	)

382 
	#SNDRV_EMU10K1_IOCTL_CONTINUE
 
	`_IO
 ('H', 0x81)

	)

383 
	#SNDRV_EMU10K1_IOCTL_ZERO_TRAM_COUNTER
 
	`_IO
 ('H', 0x82)

	)

384 
	#SNDRV_EMU10K1_IOCTL_SINGLE_STEP
 
	`_IOW
 ('H', 0x83, )

	)

385 
	#SNDRV_EMU10K1_IOCTL_DBG_READ
 
	`_IOR
 ('H', 0x84, )

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/hdsp.h

2 #i‚de‡
__SOUND_HDSP_H


3 
	#__SOUND_HDSP_H


	)

23 #ifde‡
__löux__


24 
	~<löux/ty≥s.h
>

27 
	#HDSP_MATRIX_MIXER_SIZE
 2048

	)

29 
	eHDSP_IO_Ty≥
 {

30 
	mDigiÁ˚
,

31 
	mMu…iÁ˚
,

32 
	mH9652
,

33 
	mH9632
,

34 
	mRPM
,

35 
	mUndeföed
,

38 
	shd•_≥ak_rms
 {

39 
__u32
 
	möput_≥aks
[26];

40 
__u32
 
	m∂ayback_≥aks
[26];

41 
__u32
 
	mouçut_≥aks
[28];

42 
__u64
 
	möput_rms
[26];

43 
__u64
 
	m∂ayback_rms
[26];

45 
__u64
 
	mouçut_rms
[26];

48 
	#SNDRV_HDSP_IOCTL_GET_PEAK_RMS
 
	`_IOR
('H', 0x40, 
hd•_≥ak_rms
)

	)

50 
	shd•_c⁄fig_öfo
 {

51 
	m¥ef_sync_ªf
;

52 
	mw‹d˛ock_sync_check
;

53 
	m•dif_sync_check
;

54 
	mad©sync_sync_check
;

55 
	mad©_sync_check
[3];

56 
	m•dif_ö
;

57 
	m•dif_out
;

58 
	m•dif_¥o„ssi⁄Æ
;

59 
	m•dif_emphasis
;

60 
	m•dif_n⁄audio
;

61 
	m•dif_ßm∂e_øã
;

62 
	msy°em_ßm∂e_øã
;

63 
	mautosync_ßm∂e_øã
;

64 
	msy°em_˛ock_mode
;

65 
	m˛ock_sour˚
;

66 
	mautosync_ªf
;

67 
	mlöe_out
;

68 
	m∑s°hru
;

69 
	mda_gaö
;

70 
	mad_gaö
;

71 
	mph⁄e_gaö
;

72 
	mxÃ_bªakout_ˇbÀ
;

73 
	m™Æog_exãnsi⁄_bﬂrd
;

76 
	#SNDRV_HDSP_IOCTL_GET_CONFIG_INFO
 
	`_IOR
('H', 0x41, 
hd•_c⁄fig_öfo
)

	)

78 
	shd•_fúmw¨e
 {

79 *
	mfúmw¨e_d©a
;

82 
	#SNDRV_HDSP_IOCTL_UPLOAD_FIRMWARE
 
	`_IOW
('H', 0x42, 
hd•_fúmw¨e
)

	)

84 
	shd•_vîsi⁄
 {

85 
HDSP_IO_Ty≥
 
	mio_ty≥
;

86 
	mfúmw¨e_ªv
;

89 
	#SNDRV_HDSP_IOCTL_GET_VERSION
 
	`_IOR
('H', 0x43, 
hd•_vîsi⁄
)

	)

91 
	shd•_mixî
 {

92 
	mm©rix
[
HDSP_MATRIX_MIXER_SIZE
];

95 
	#SNDRV_HDSP_IOCTL_GET_MIXER
 
	`_IOR
('H', 0x44, 
hd•_mixî
)

	)

97 
	shd•_9632_´b
 {

98 
	m´bi
;

99 
	m´bo
;

102 
	#SNDRV_HDSP_IOCTL_GET_9632_AEB
 
	`_IOR
('H', 0x45, 
hd•_9632_´b
)

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/hdspm.h

2 #i‚de‡
__SOUND_HDSPM_H


3 
	#__SOUND_HDSPM_H


	)

24 #ifde‡
__löux__


25 
	~<löux/ty≥s.h
>

29 
	#HDSPM_MAX_CHANNELS
 64

	)

31 
	ehd•m_io_ty≥
 {

32 
	mMADI
,

33 
	mMADIÁ˚
,

34 
	mAIO
,

35 
	mAES32
,

36 
	mRayDAT


39 
	ehd•m_•ìd
 {

40 
	mss
,

41 
	mds
,

42 
	mqs


47 
	shd•m_≥ak_rms
 {

48 
__u32
 
	möput_≥aks
[64];

49 
__u32
 
	m∂ayback_≥aks
[64];

50 
__u32
 
	mouçut_≥aks
[64];

52 
__u64
 
	möput_rms
[64];

53 
__u64
 
	m∂ayback_rms
[64];

54 
__u64
 
	mouçut_rms
[64];

56 
__u8
 
	m•ìd
;

57 
	m°©us2
;

60 
	#SNDRV_HDSPM_IOCTL_GET_PEAK_RMS
 \

61 
	`_IOR
('H', 0x42, 
hd•m_≥ak_rms
)

	)

65 
	shd•m_c⁄fig
 {

66 
	m¥ef_sync_ªf
;

67 
	mw‹d˛ock_sync_check
;

68 
	mmadi_sync_check
;

69 
	msy°em_ßm∂e_øã
;

70 
	mautosync_ßm∂e_øã
;

71 
	msy°em_˛ock_mode
;

72 
	m˛ock_sour˚
;

73 
	mautosync_ªf
;

74 
	mlöe_out
;

75 
	m∑s°hru
;

76 
	m™Æog_out
;

79 
	#SNDRV_HDSPM_IOCTL_GET_CONFIG
 \

80 
	`_IOR
('H', 0x41, 
hd•m_c⁄fig
)

	)

91 
	ehd•m_…c_f‹m©
 {

92 
	mf‹m©_övÆid
,

93 
	mÂs_24
,

94 
	mÂs_25
,

95 
	mÂs_2997
,

96 
	mÂs_30


99 
	ehd•m_…c_‰ame
 {

100 
	m‰ame_övÆid
,

101 
	mdr›_‰ame
,

102 
	mfuŒ_‰ame


105 
	ehd•m_…c_öput_f‹m©
 {

106 
	m¡sc
,

107 
	m∑l
,

108 
	mno_video


111 
	shd•m_…c
 {

112 
	m…c
;

114 
hd•m_…c_f‹m©
 
	mf‹m©
;

115 
hd•m_…c_‰ame
 
	m‰ame
;

116 
hd•m_…c_öput_f‹m©
 
	möput_f‹m©
;

119 
	#SNDRV_HDSPM_IOCTL_GET_LTC
 
	`_IOR
('H', 0x46, 
hd•m_…c
)

	)

127 
	ehd•m_sync
 {

128 
	mhd•m_sync_no_lock
 = 0,

129 
	mhd•m_sync_lock
 = 1,

130 
	mhd•m_sync_sync
 = 2

133 
	ehd•m_madi_öput
 {

134 
	mhd•m_öput_›tiˇl
 = 0,

135 
	mhd•m_öput_cﬂx
 = 1

138 
	ehd•m_madi_ch™√l_f‹m©
 {

139 
	mhd•m_f‹m©_ch_64
 = 0,

140 
	mhd•m_f‹m©_ch_56
 = 1

143 
	ehd•m_madi_‰ame_f‹m©
 {

144 
	mhd•m_‰ame_48
 = 0,

145 
	mhd•m_‰ame_96
 = 1

148 
	ehd•m_syncsour˚
 {

149 
	msyncsour˚_wc
 = 0,

150 
	msyncsour˚_madi
 = 1,

151 
	msyncsour˚_tco
 = 2,

152 
	msyncsour˚_sync
 = 3,

153 
	msyncsour˚_n⁄e
 = 4

156 
	shd•m_°©us
 {

157 
__u8
 
	mˇrd_ty≥
;

158 
hd•m_syncsour˚
 
	mautosync_sour˚
;

160 
__u64
 
	mˇrd_˛ock
;

161 
__u32
 
	mma°î_≥riod
;

165 
__u8
 
	msync_wc
;

166 
__u8
 
	msync_madi
;

167 
__u8
 
	msync_tco
;

168 
__u8
 
	msync_ö
;

169 
__u8
 
	mmadi_öput
;

170 
__u8
 
	mch™√l_f‹m©
;

171 
__u8
 
	m‰ame_f‹m©
;

172 } 
	mmadi
;

173 } 
	mˇrd_•ecific
;

176 
	#SNDRV_HDSPM_IOCTL_GET_STATUS
 \

177 
	`_IOR
('H', 0x47, 
hd•m_°©us
)

	)

183 
	#HDSPM_ADDON_TCO
 1

	)

185 
	shd•m_vîsi⁄
 {

186 
__u8
 
	mˇrd_ty≥
;

187 
	mˇrd«me
[20];

188 
	m£rül
;

189 
	mfúmw¨e_ªv
;

190 
	madd⁄s
;

193 
	#SNDRV_HDSPM_IOCTL_GET_VERSION
 
	`_IOR
('H', 0x48, 
hd•m_vîsi⁄
)

	)

208 
	#HDSPM_MIXER_CHANNELS
 
HDSPM_MAX_CHANNELS


	)

210 
	shd•m_ch™√lÁdî
 {

211 
	mö
[
HDSPM_MIXER_CHANNELS
];

212 
	mpb
[
HDSPM_MIXER_CHANNELS
];

215 
	shd•m_mixî
 {

216 
hd•m_ch™√lÁdî
 
	mch
[
HDSPM_MIXER_CHANNELS
];

219 
	shd•m_mixî_io˘l
 {

220 
hd•m_mixî
 *
	mmixî
;

224 
	#SNDRV_HDSPM_IOCTL_GET_MIXER
 
	`_IOR
('H', 0x44, 
hd•m_mixî_io˘l
)

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/sb16_csp.h

23 #i‚de‡
__SOUND_SB16_CSP_H


24 
	#__SOUND_SB16_CSP_H


	)

28 
	#SNDRV_SB_CSP_MODE_NONE
 0x00

	)

29 
	#SNDRV_SB_CSP_MODE_DSP_READ
 0x01

	)

30 
	#SNDRV_SB_CSP_MODE_DSP_WRITE
 0x02

	)

31 
	#SNDRV_SB_CSP_MODE_QSOUND
 0x04

	)

34 
	#SNDRV_SB_CSP_LOAD_FROMUSER
 0x01

	)

35 
	#SNDRV_SB_CSP_LOAD_INITBLOCK
 0x02

	)

38 
	#SNDRV_SB_CSP_SAMPLE_8BIT
 0x01

	)

39 
	#SNDRV_SB_CSP_SAMPLE_16BIT
 0x02

	)

42 
	#SNDRV_SB_CSP_MONO
 0x01

	)

43 
	#SNDRV_SB_CSP_STEREO
 0x02

	)

46 
	#SNDRV_SB_CSP_RATE_8000
 0x01

	)

47 
	#SNDRV_SB_CSP_RATE_11025
 0x02

	)

48 
	#SNDRV_SB_CSP_RATE_22050
 0x04

	)

49 
	#SNDRV_SB_CSP_RATE_44100
 0x08

	)

50 
	#SNDRV_SB_CSP_RATE_ALL
 0x0f

	)

53 
	#SNDRV_SB_CSP_ST_IDLE
 0x00

	)

54 
	#SNDRV_SB_CSP_ST_LOADED
 0x01

	)

55 
	#SNDRV_SB_CSP_ST_RUNNING
 0x02

	)

56 
	#SNDRV_SB_CSP_ST_PAUSED
 0x04

	)

57 
	#SNDRV_SB_CSP_ST_AUTO
 0x08

	)

58 
	#SNDRV_SB_CSP_ST_QSOUND
 0x10

	)

61 
	#SNDRV_SB_CSP_QSOUND_MAX_RIGHT
 0x20

	)

64 
	#SNDRV_SB_CSP_MAX_MICROCODE_FILE_SIZE
 0x3000

	)

67 
	s¢d_sb_c•_mc_hódî
 {

68 
	mcodec_«me
[16];

69 
	mfunc_ªq
;

73 
	s¢d_sb_c•_mi¸ocode
 {

74 
¢d_sb_c•_mc_hódî
 
	möfo
;

75 
	md©a
[
SNDRV_SB_CSP_MAX_MICROCODE_FILE_SIZE
];

79 
	s¢d_sb_c•_°¨t
 {

80 
	mßm∂e_width
;

81 
	mch™√ls
;

85 
	s¢d_sb_c•_öfo
 {

86 
	mcodec_«me
[16];

87 
	mfunc_ƒ
;

88 
	macc_f‹m©
;

89 
	macc_ch™√ls
;

90 
	macc_width
;

91 
	macc_øãs
;

92 
	mc•_mode
;

93 
	mrun_ch™√ls
;

94 
	mrun_width
;

95 
	mvîsi⁄
;

96 
	m°©e
;

101 
	#SNDRV_SB_CSP_IOCTL_INFO
 
	`_IOR
('H', 0x10, 
¢d_sb_c•_öfo
)

	)

109 
	#SNDRV_SB_CSP_IOCTL_LOAD_CODE
 \

110 
	`_IOC
(
_IOC_WRITE
, 'H', 0x11, (
¢d_sb_c•_mi¸ocode
))

	)

112 
	#SNDRV_SB_CSP_IOCTL_UNLOAD_CODE
 
	`_IO
('H', 0x12)

	)

114 
	#SNDRV_SB_CSP_IOCTL_START
 
	`_IOW
('H', 0x13, 
¢d_sb_c•_°¨t
)

	)

116 
	#SNDRV_SB_CSP_IOCTL_STOP
 
	`_IO
('H', 0x14)

	)

118 
	#SNDRV_SB_CSP_IOCTL_PAUSE
 
	`_IO
('H', 0x15)

	)

120 
	#SNDRV_SB_CSP_IOCTL_RESTART
 
	`_IO
('H', 0x16)

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/sscape_ioctl.h

1 #i‚de‡
SSCAPE_IOCTL_H


2 
	#SSCAPE_IOCTL_H


	)

5 
	sssˇ≥_boŸblock


7 
	mcode
[256];

8 
	mvîsi⁄
;

11 
	#SSCAPE_MICROCODE_SIZE
 65536

	)

13 
	sssˇ≥_mi¸ocode


15 *
	mcode
;

18 
	#SND_SSCAPE_LOAD_BOOTB
 
	`_IOWR
('P', 100, 
ssˇ≥_boŸblock
)

	)

19 
	#SND_SSCAPE_LOAD_MCODE
 
	`_IOW
 ('P', 101, 
ssˇ≥_mi¸ocode
)

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/tlv.h

14 #i‚de‡
__UAPI_SOUND_TLV_H


15 
	#__UAPI_SOUND_TLV_H


	)

17 
	#SNDRV_CTL_TLVT_CONTAINER
 0

	)

18 
	#SNDRV_CTL_TLVT_DB_SCALE
 1

	)

19 
	#SNDRV_CTL_TLVT_DB_LINEAR
 2

	)

20 
	#SNDRV_CTL_TLVT_DB_RANGE
 3

	)

21 
	#SNDRV_CTL_TLVT_DB_MINMAX
 4

	)

22 
	#SNDRV_CTL_TLVT_DB_MINMAX_MUTE
 5

	)

28 
	#SNDRV_CTL_TLVT_CHMAP_FIXED
 0x101

	)

29 
	#SNDRV_CTL_TLVT_CHMAP_VAR
 0x102

	)

30 
	#SNDRV_CTL_TLVT_CHMAP_PAIRED
 0x103

	)

40 
	#SNDRV_CTL_TLVD_ITEM
(
ty≥
, ...) \

41 (
ty≥
), 
	`SNDRV_CTL_TLVD_LENGTH
(
__VA_ARGS__
), 
	)
__VA_ARGS__

42 
	#SNDRV_CTL_TLVD_LENGTH
(...) \

43 (()((c⁄° []Ë{ 
__VA_ARGS__
 }))

	)

46 
	#SNDRV_CTL_TLVO_TYPE
 0

	)

47 
	#SNDRV_CTL_TLVO_LEN
 1

	)

49 
	#SNDRV_CTL_TLVD_CONTAINER_ITEM
(...) \

50 
	`SNDRV_CTL_TLVD_ITEM
(
SNDRV_CTL_TLVT_CONTAINER
, 
__VA_ARGS__
)

	)

51 
	#SNDRV_CTL_TLVD_DECLARE_CONTAINER
(
«me
, ...) \

52 
«me
[] = { \

53 
	`SNDRV_CTL_TLVD_CONTAINER_ITEM
(
__VA_ARGS__
) \

54 }

	)

56 
	#SNDRV_CTL_TLVD_DB_SCALE_MASK
 0xffff

	)

57 
	#SNDRV_CTL_TLVD_DB_SCALE_MUTE
 0x10000

	)

58 
	#SNDRV_CTL_TLVD_DB_SCALE_ITEM
(
mö
, 
°ï
, 
muã
) \

59 
	`SNDRV_CTL_TLVD_ITEM
(
SNDRV_CTL_TLVT_DB_SCALE
, \

60 (
mö
), \

61 ((
°ï
Ë& 
SNDRV_CTL_TLVD_DB_SCALE_MASK
) | \

62 ((
muã
Ë? 
SNDRV_CTL_TLVD_DB_SCALE_MUTE
 : 0))

	)

63 
	#SNDRV_CTL_TLVD_DECLARE_DB_SCALE
(
«me
, 
mö
, 
°ï
, 
muã
) \

64 
«me
[] = { \

65 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(
mö
, 
°ï
, 
muã
) \

66 }

	)

69 
	#SNDRV_CTL_TLVO_DB_SCALE_MIN
 2

	)

70 
	#SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
 3

	)

73 
	#SNDRV_CTL_TLVD_DB_MINMAX_ITEM
(
mö_dB
, 
max_dB
) \

74 
	`SNDRV_CTL_TLVD_ITEM
(
SNDRV_CTL_TLVT_DB_MINMAX
, (
mö_dB
), (
max_dB
))

	)

75 
	#SNDRV_CTL_TLVD_DB_MINMAX_MUTE_ITEM
(
mö_dB
, 
max_dB
) \

76 
	`SNDRV_CTL_TLVD_ITEM
(
SNDRV_CTL_TLVT_DB_MINMAX_MUTE
, (
mö_dB
), (
max_dB
))

	)

77 
	#SNDRV_CTL_TLVD_DECLARE_DB_MINMAX
(
«me
, 
mö_dB
, 
max_dB
) \

78 
«me
[] = { \

79 
	`SNDRV_CTL_TLVD_DB_MINMAX_ITEM
(
mö_dB
, 
max_dB
) \

80 }

	)

81 
	#SNDRV_CTL_TLVD_DECLARE_DB_MINMAX_MUTE
(
«me
, 
mö_dB
, 
max_dB
) \

82 
«me
[] = { \

83 
	`SNDRV_CTL_TLVD_DB_MINMAX_MUTE_ITEM
(
mö_dB
, 
max_dB
) \

84 }

	)

87 
	#SNDRV_CTL_TLVO_DB_MINMAX_MIN
 2

	)

88 
	#SNDRV_CTL_TLVO_DB_MINMAX_MAX
 3

	)

91 
	#SNDRV_CTL_TLVD_DB_LINEAR_ITEM
(
mö_dB
, 
max_dB
) \

92 
	`SNDRV_CTL_TLVD_ITEM
(
SNDRV_CTL_TLVT_DB_LINEAR
, (
mö_dB
), (
max_dB
))

	)

93 
	#SNDRV_CTL_TLVD_DECLARE_DB_LINEAR
(
«me
, 
mö_dB
, 
max_dB
) \

94 
«me
[] = { \

95 
	`SNDRV_CTL_TLVD_DB_LINEAR_ITEM
(
mö_dB
, 
max_dB
) \

96 }

	)

99 
	#SNDRV_CTL_TLVO_DB_LINEAR_MIN
 2

	)

100 
	#SNDRV_CTL_TLVO_DB_LINEAR_MAX
 3

	)

108 
	#SNDRV_CTL_TLVD_DB_RANGE_ITEM
(...) \

109 
	`SNDRV_CTL_TLVD_ITEM
(
SNDRV_CTL_TLVT_DB_RANGE
, 
__VA_ARGS__
)

	)

110 
	#SNDRV_CTL_TLVD_DECLARE_DB_RANGE
(
«me
, ...) \

111 
«me
[] = { \

112 
	`SNDRV_CTL_TLVD_DB_RANGE_ITEM
(
__VA_ARGS__
) \

113 }

	)

115 
	#SNDRV_CTL_TLVD_DB_GAIN_MUTE
 -9999999

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sys.h

1 #w¨nög 
This
 
hódî
 
is
 
dïªˇãd
, 
u£
 <
Æß
/
asoundlib
.
h
> 
ö°ód
.

2 
	~<Æß/asoundlib.h
>

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/timer.h

28 #i‚de‡
__ALSA_TIMER_H


29 
	#__ALSA_TIMER_H


	)

31 #ifde‡
__˝lu•lus


42 
	#SND_TIMER_DLSYM_VERSION
 
_dlsym_timî_001


	)

44 
	#SND_TIMER_QUERY_DLSYM_VERSION
 
_dlsym_timî_quîy_001


	)

47 
_¢d_timî_id
 
	t¢d_timî_id_t
;

49 
_¢d_timî_göfo
 
	t¢d_timî_göfo_t
;

51 
_¢d_timî_g∑øms
 
	t¢d_timî_g∑øms_t
;

53 
_¢d_timî_g°©us
 
	t¢d_timî_g°©us_t
;

55 
_¢d_timî_öfo
 
	t¢d_timî_öfo_t
;

57 
_¢d_timî_∑øms
 
	t¢d_timî_∑øms_t
;

59 
_¢d_timî_°©us
 
	t¢d_timî_°©us_t
;

61 
	e_¢d_timî_˛ass
 {

62 
SND_TIMER_CLASS_NONE
 = -1,

63 
SND_TIMER_CLASS_SLAVE
 = 0,

64 
SND_TIMER_CLASS_GLOBAL
,

65 
SND_TIMER_CLASS_CARD
,

66 
SND_TIMER_CLASS_PCM
,

67 
SND_TIMER_CLASS_LAST
 = 
SND_TIMER_CLASS_PCM


68 } 
	t¢d_timî_˛ass_t
;

71 
	e_¢d_timî_¶ave_˛ass
 {

72 
SND_TIMER_SCLASS_NONE
 = 0,

73 
SND_TIMER_SCLASS_APPLICATION
,

74 
SND_TIMER_SCLASS_SEQUENCER
,

75 
SND_TIMER_SCLASS_OSS_SEQUENCER
,

76 
SND_TIMER_SCLASS_LAST
 = 
SND_TIMER_SCLASS_OSS_SEQUENCER


77 } 
	t¢d_timî_¶ave_˛ass_t
;

80 
	e_¢d_timî_evít
 {

81 
SND_TIMER_EVENT_RESOLUTION
 = 0,

82 
SND_TIMER_EVENT_TICK
,

83 
SND_TIMER_EVENT_START
,

84 
SND_TIMER_EVENT_STOP
,

85 
SND_TIMER_EVENT_CONTINUE
,

86 
SND_TIMER_EVENT_PAUSE
,

87 
SND_TIMER_EVENT_EARLY
,

88 
SND_TIMER_EVENT_SUSPEND
,

89 
SND_TIMER_EVENT_RESUME
,

91 
SND_TIMER_EVENT_MSTART
 = 
SND_TIMER_EVENT_START
 + 10,

92 
SND_TIMER_EVENT_MSTOP
 = 
SND_TIMER_EVENT_STOP
 + 10,

93 
SND_TIMER_EVENT_MCONTINUE
 = 
SND_TIMER_EVENT_CONTINUE
 + 10,

94 
SND_TIMER_EVENT_MPAUSE
 = 
SND_TIMER_EVENT_PAUSE
 + 10,

95 
SND_TIMER_EVENT_MSUSPEND
 = 
SND_TIMER_EVENT_SUSPEND
 + 10,

96 
SND_TIMER_EVENT_MRESUME
 = 
SND_TIMER_EVENT_RESUME
 + 10

97 } 
	t¢d_timî_evít_t
;

100 
	s_¢d_timî_ªad
 {

101 
ªsﬁuti⁄
;

102 
ticks
;

103 } 
	t¢d_timî_ªad_t
;

106 
	s_¢d_timî_åód
 {

107 
¢d_timî_evít_t
 
evít
;

108 
¢d_htime°amp_t
 
t°amp
;

109 
vÆ
;

110 } 
	t¢d_timî_åód_t
;

113 
	#SND_TIMER_GLOBAL_SYSTEM
 0

	)

115 
	#SND_TIMER_GLOBAL_RTC
 1

	)

117 
	#SND_TIMER_GLOBAL_HPET
 2

	)

119 
	#SND_TIMER_GLOBAL_HRTIMER
 3

	)

122 
	#SND_TIMER_OPEN_NONBLOCK
 (1<<0)

	)

124 
	#SND_TIMER_OPEN_TREAD
 (1<<1)

	)

127 
	e_¢d_timî_ty≥
 {

129 
SND_TIMER_TYPE_HW
 = 0,

131 
SND_TIMER_TYPE_SHM
,

133 
SND_TIMER_TYPE_INET


134 } 
	t¢d_timî_ty≥_t
;

137 
_¢d_timî_quîy
 
	t¢d_timî_quîy_t
;

139 
_¢d_timî
 
	t¢d_timî_t
;

142 
¢d_timî_quîy_›í
(
¢d_timî_quîy_t
 **
h™dÀ
, c⁄° *
«me
, 
mode
);

143 
¢d_timî_quîy_›í_lc⁄f
(
¢d_timî_quîy_t
 **
h™dÀ
, c⁄° *
«me
, 
mode
, 
¢d_c⁄fig_t
 *
lc⁄f
);

144 
¢d_timî_quîy_˛o£
(
¢d_timî_quîy_t
 *
h™dÀ
);

145 
¢d_timî_quîy_√xt_devi˚
(
¢d_timî_quîy_t
 *
h™dÀ
, 
¢d_timî_id_t
 *
tid
);

146 
¢d_timî_quîy_öfo
(
¢d_timî_quîy_t
 *
h™dÀ
, 
¢d_timî_göfo_t
 *
öfo
);

147 
¢d_timî_quîy_∑øms
(
¢d_timî_quîy_t
 *
h™dÀ
, 
¢d_timî_g∑øms_t
 *
∑øms
);

148 
¢d_timî_quîy_°©us
(
¢d_timî_quîy_t
 *
h™dÀ
, 
¢d_timî_g°©us_t
 *
°©us
);

150 
¢d_timî_›í
(
¢d_timî_t
 **
h™dÀ
, c⁄° *
«me
, 
mode
);

151 
¢d_timî_›í_lc⁄f
(
¢d_timî_t
 **
h™dÀ
, c⁄° *
«me
, 
mode
, 
¢d_c⁄fig_t
 *
lc⁄f
);

152 
¢d_timî_˛o£
(
¢d_timî_t
 *
h™dÀ
);

153 
¢d_async_add_timî_h™dÀr
(
¢d_async_h™dÀr_t
 **
h™dÀr
, 
¢d_timî_t
 *
timî
,

154 
¢d_async_ˇŒback_t
 
ˇŒback
, *
¥iv©e_d©a
);

155 
¢d_timî_t
 *
¢d_async_h™dÀr_gë_timî
(
¢d_async_h™dÀr_t
 *
h™dÀr
);

156 
¢d_timî_pﬁl_des¸ùt‹s_cou¡
(
¢d_timî_t
 *
h™dÀ
);

157 
¢d_timî_pﬁl_des¸ùt‹s
(
¢d_timî_t
 *
h™dÀ
, 
pﬁlfd
 *
pfds
, 
•a˚
);

158 
¢d_timî_pﬁl_des¸ùt‹s_ªvíts
(
¢d_timî_t
 *
timî
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
);

159 
¢d_timî_öfo
(
¢d_timî_t
 *
h™dÀ
, 
¢d_timî_öfo_t
 *
timî
);

160 
¢d_timî_∑øms
(
¢d_timî_t
 *
h™dÀ
, 
¢d_timî_∑øms_t
 *
∑øms
);

161 
¢d_timî_°©us
(
¢d_timî_t
 *
h™dÀ
, 
¢d_timî_°©us_t
 *
°©us
);

162 
¢d_timî_°¨t
(
¢d_timî_t
 *
h™dÀ
);

163 
¢d_timî_°›
(
¢d_timî_t
 *
h™dÀ
);

164 
¢d_timî_c⁄töue
(
¢d_timî_t
 *
h™dÀ
);

165 
ssize_t
 
¢d_timî_ªad
(
¢d_timî_t
 *
h™dÀ
, *
buf„r
, 
size_t
 
size
);

167 
size_t
 
¢d_timî_id_sizeof
();

169 
	#¢d_timî_id_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_timî_id
)

	)

170 
¢d_timî_id_mÆloc
(
¢d_timî_id_t
 **
±r
);

171 
¢d_timî_id_‰ì
(
¢d_timî_id_t
 *
obj
);

172 
¢d_timî_id_c›y
(
¢d_timî_id_t
 *
d°
, c⁄° snd_timî_id_à*
§c
);

174 
¢d_timî_id_£t_˛ass
(
¢d_timî_id_t
 *
id
, 
dev_˛ass
);

175 
¢d_timî_id_gë_˛ass
(
¢d_timî_id_t
 *
id
);

176 
¢d_timî_id_£t_s˛ass
(
¢d_timî_id_t
 *
id
, 
dev_s˛ass
);

177 
¢d_timî_id_gë_s˛ass
(
¢d_timî_id_t
 *
id
);

178 
¢d_timî_id_£t_ˇrd
(
¢d_timî_id_t
 *
id
, 
ˇrd
);

179 
¢d_timî_id_gë_ˇrd
(
¢d_timî_id_t
 *
id
);

180 
¢d_timî_id_£t_devi˚
(
¢d_timî_id_t
 *
id
, 
devi˚
);

181 
¢d_timî_id_gë_devi˚
(
¢d_timî_id_t
 *
id
);

182 
¢d_timî_id_£t_subdevi˚
(
¢d_timî_id_t
 *
id
, 
subdevi˚
);

183 
¢d_timî_id_gë_subdevi˚
(
¢d_timî_id_t
 *
id
);

185 
size_t
 
¢d_timî_göfo_sizeof
();

187 
	#¢d_timî_göfo_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_timî_göfo
)

	)

188 
¢d_timî_göfo_mÆloc
(
¢d_timî_göfo_t
 **
±r
);

189 
¢d_timî_göfo_‰ì
(
¢d_timî_göfo_t
 *
obj
);

190 
¢d_timî_göfo_c›y
(
¢d_timî_göfo_t
 *
d°
, c⁄° snd_timî_göfo_à*
§c
);

192 
¢d_timî_göfo_£t_tid
(
¢d_timî_göfo_t
 *
obj
, 
¢d_timî_id_t
 *
tid
);

193 
¢d_timî_id_t
 *
¢d_timî_göfo_gë_tid
(
¢d_timî_göfo_t
 *
obj
);

194 
¢d_timî_göfo_gë_Êags
(
¢d_timî_göfo_t
 *
obj
);

195 
¢d_timî_göfo_gë_ˇrd
(
¢d_timî_göfo_t
 *
obj
);

196 *
¢d_timî_göfo_gë_id
(
¢d_timî_göfo_t
 *
obj
);

197 *
¢d_timî_göfo_gë_«me
(
¢d_timî_göfo_t
 *
obj
);

198 
¢d_timî_göfo_gë_ªsﬁuti⁄
(
¢d_timî_göfo_t
 *
obj
);

199 
¢d_timî_göfo_gë_ªsﬁuti⁄_mö
(
¢d_timî_göfo_t
 *
obj
);

200 
¢d_timî_göfo_gë_ªsﬁuti⁄_max
(
¢d_timî_göfo_t
 *
obj
);

201 
¢d_timî_göfo_gë_˛õ¡s
(
¢d_timî_göfo_t
 *
obj
);

203 
size_t
 
¢d_timî_öfo_sizeof
();

205 
	#¢d_timî_öfo_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_timî_öfo
)

	)

206 
¢d_timî_öfo_mÆloc
(
¢d_timî_öfo_t
 **
±r
);

207 
¢d_timî_öfo_‰ì
(
¢d_timî_öfo_t
 *
obj
);

208 
¢d_timî_öfo_c›y
(
¢d_timî_öfo_t
 *
d°
, c⁄° snd_timî_öfo_à*
§c
);

210 
¢d_timî_öfo_is_¶ave
(
¢d_timî_öfo_t
 * 
öfo
);

211 
¢d_timî_öfo_gë_ˇrd
(
¢d_timî_öfo_t
 * 
öfo
);

212 c⁄° *
¢d_timî_öfo_gë_id
(
¢d_timî_öfo_t
 * 
öfo
);

213 c⁄° *
¢d_timî_öfo_gë_«me
(
¢d_timî_öfo_t
 * 
öfo
);

214 
¢d_timî_öfo_gë_ªsﬁuti⁄
(
¢d_timî_öfo_t
 * 
öfo
);

216 
size_t
 
¢d_timî_∑øms_sizeof
();

218 
	#¢d_timî_∑øms_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_timî_∑øms
)

	)

219 
¢d_timî_∑øms_mÆloc
(
¢d_timî_∑øms_t
 **
±r
);

220 
¢d_timî_∑øms_‰ì
(
¢d_timî_∑øms_t
 *
obj
);

221 
¢d_timî_∑øms_c›y
(
¢d_timî_∑øms_t
 *
d°
, c⁄° snd_timî_∑øms_à*
§c
);

223 
¢d_timî_∑øms_£t_auto_°¨t
(
¢d_timî_∑øms_t
 * 
∑øms
, 
auto_°¨t
);

224 
¢d_timî_∑øms_gë_auto_°¨t
(
¢d_timî_∑øms_t
 * 
∑øms
);

225 
¢d_timî_∑øms_£t_ex˛usive
(
¢d_timî_∑øms_t
 * 
∑øms
, 
ex˛usive
);

226 
¢d_timî_∑øms_gë_ex˛usive
(
¢d_timî_∑øms_t
 * 
∑øms
);

227 
¢d_timî_∑øms_£t_óæy_evít
(
¢d_timî_∑øms_t
 * 
∑øms
, 
óæy_evít
);

228 
¢d_timî_∑øms_gë_óæy_evít
(
¢d_timî_∑øms_t
 * 
∑øms
);

229 
¢d_timî_∑øms_£t_ticks
(
¢d_timî_∑øms_t
 * 
∑øms
, 
ticks
);

230 
¢d_timî_∑øms_gë_ticks
(
¢d_timî_∑øms_t
 * 
∑øms
);

231 
¢d_timî_∑øms_£t_queue_size
(
¢d_timî_∑øms_t
 * 
∑øms
, 
queue_size
);

232 
¢d_timî_∑øms_gë_queue_size
(
¢d_timî_∑øms_t
 * 
∑øms
);

233 
¢d_timî_∑øms_£t_fûãr
(
¢d_timî_∑øms_t
 * 
∑øms
, 
fûãr
);

234 
¢d_timî_∑øms_gë_fûãr
(
¢d_timî_∑øms_t
 * 
∑øms
);

236 
size_t
 
¢d_timî_°©us_sizeof
();

238 
	#¢d_timî_°©us_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_timî_°©us
)

	)

239 
¢d_timî_°©us_mÆloc
(
¢d_timî_°©us_t
 **
±r
);

240 
¢d_timî_°©us_‰ì
(
¢d_timî_°©us_t
 *
obj
);

241 
¢d_timî_°©us_c›y
(
¢d_timî_°©us_t
 *
d°
, c⁄° snd_timî_°©us_à*
§c
);

243 
¢d_htime°amp_t
 
¢d_timî_°©us_gë_time°amp
(
¢d_timî_°©us_t
 * 
°©us
);

244 
¢d_timî_°©us_gë_ªsﬁuti⁄
(
¢d_timî_°©us_t
 * 
°©us
);

245 
¢d_timî_°©us_gë_lo°
(
¢d_timî_°©us_t
 * 
°©us
);

246 
¢d_timî_°©us_gë_ovîrun
(
¢d_timî_°©us_t
 * 
°©us
);

247 
¢d_timî_°©us_gë_queue
(
¢d_timî_°©us_t
 * 
°©us
);

250 
¢d_timî_öfo_gë_ticks
(
¢d_timî_öfo_t
 * 
öfo
);

254 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/topology.h

21 #i‚de‡
__ALSA_TOPOLOGY_H


22 
	#__ALSA_TOPOLOGY_H


	)

24 
	~<°döt.h
>

26 #ifde‡
__˝lu•lus


741 
	#SND_TPLG_MAX_CHAN
 8

	)

744 
¢d_çlg
 
	t¢d_çlg_t
;

747 
	e¢d_çlg_ty≥
 {

748 
SND_TPLG_TYPE_TLV
 = 0,

749 
SND_TPLG_TYPE_MIXER
,

750 
SND_TPLG_TYPE_ENUM
,

751 
SND_TPLG_TYPE_TEXT
,

752 
SND_TPLG_TYPE_DATA
,

753 
SND_TPLG_TYPE_BYTES
,

754 
SND_TPLG_TYPE_STREAM_CONFIG
,

755 
SND_TPLG_TYPE_STREAM_CAPS
,

756 
SND_TPLG_TYPE_PCM
,

757 
SND_TPLG_TYPE_DAPM_WIDGET
,

758 
SND_TPLG_TYPE_DAPM_GRAPH
,

759 
SND_TPLG_TYPE_BE
,

760 
SND_TPLG_TYPE_CC
,

761 
SND_TPLG_TYPE_MANIFEST
,

762 
SND_TPLG_TYPE_TOKEN
,

763 
SND_TPLG_TYPE_TUPLE
,

764 
SND_TPLG_TYPE_LINK
,

765 
SND_TPLG_TYPE_HW_CONFIG
,

766 
SND_TPLG_TYPE_DAI
,

770 
	#SND_TPLG_INDEX_ALL
 0

	)

773 
	#SND_TPLG_CREATE_VERBOSE
 (1<<0Ë

	)

774 
	#SND_TPLG_CREATE_DAPM_NOSORT
 (1<<1Ë

	)

780 c⁄° *
¢d_çlg_vîsi⁄
();

786 
¢d_çlg_t
 *
¢d_çlg_√w
();

792 
¢d_çlg_t
 *
¢d_çlg_¸óã
(
Êags
);

798 
¢d_çlg_‰ì
(
¢d_çlg_t
 *
çlg
);

807 
¢d_çlg_lﬂd
(
¢d_çlg_t
 *
çlg
, c⁄° *
buf
, 
size_t
 
size
);

816 
¢d_çlg_buûd_fûe
(
¢d_çlg_t
 *
çlg
, c⁄° *
öfûe
,

817 c⁄° *
outfûe
);

824 
¢d_çlg_vîbo£
(
¢d_çlg_t
 *
çlg
, 
vîbo£
);

829 
	s¢d_çlg_év_ãm∂©e
 {

830 
ty≥
;

836 
	s¢d_çlg_év_dbsˇÀ_ãm∂©e
 {

837 
¢d_çlg_év_ãm∂©e
 
hdr
;

838 
mö
;

839 
°ï
;

840 
muã
;

846 
	s¢d_çlg_ch™√l_ñem
 {

847 
size
;

848 
ªg
;

849 
shi·
;

850 
id
;

856 
	s¢d_çlg_ch™√l_m≠_ãm∂©e
 {

857 
num_ch™√ls
;

858 
¢d_çlg_ch™√l_ñem
 
ch™√l
[
SND_TPLG_MAX_CHAN
];

864 
	s¢d_çlg_pd©a_ãm∂©e
 {

865 
Àngth
;

866 c⁄° *
d©a
;

872 
	s¢d_çlg_io_›s_ãm∂©e
 {

873 
gë
;

874 
put
;

875 
öfo
;

881 
	s¢d_çlg_˘l_ãm∂©e
 {

882 
ty≥
;

883 c⁄° *
«me
;

884 
ac˚ss
;

885 
¢d_çlg_io_›s_ãm∂©e
 
›s
;

887 
¢d_çlg_év_ãm∂©e
 *
év
;

888 
¢d_çlg_év_dbsˇÀ_ãm∂©e
 *
év_sˇÀ
;

895 
	s¢d_çlg_mixî_ãm∂©e
 {

896 
¢d_çlg_˘l_ãm∂©e
 
hdr
;

897 
¢d_çlg_ch™√l_m≠_ãm∂©e
 *
m≠
;

898 
mö
;

899 
max
;

900 
∂©f‹m_max
;

901 
övît
;

902 
¢d_soc_çlg_¥iv©e
 *
¥iv
;

908 
	s¢d_çlg_íum_ãm∂©e
 {

909 
¢d_çlg_˘l_ãm∂©e
 
hdr
;

910 
¢d_çlg_ch™√l_m≠_ãm∂©e
 *
m≠
;

911 
ôems
;

912 
mask
;

913 c⁄° **
ãxts
;

914 c⁄° **
vÆues
;

915 
¢d_soc_çlg_¥iv©e
 *
¥iv
;

921 
	s¢d_çlg_byãs_ãm∂©e
 {

922 
¢d_çlg_˘l_ãm∂©e
 
hdr
;

923 
max
;

924 
mask
;

925 
ba£
;

926 
num_ªgs
;

927 
¢d_çlg_io_›s_ãm∂©e
 
ext_›s
;

928 
¢d_soc_çlg_¥iv©e
 *
¥iv
;

934 
	s¢d_çlg_gøph_ñem
 {

935 c⁄° *
§c
;

936 c⁄° *
˘l
;

937 c⁄° *
sök
;

943 
	s¢d_çlg_gøph_ãm∂©e
 {

944 
cou¡
;

945 
¢d_çlg_gøph_ñem
 
ñem
[0];

951 
	s¢d_çlg_widgë_ãm∂©e
 {

952 
id
;

953 c⁄° *
«me
;

954 c⁄° *
¢ame
;

955 
ªg
;

956 
shi·
;

957 
mask
;

958 
sub£q
;

959 
övît
;

960 
ign‹e_su•íd
;

961 
evít_Êags
;

962 
evít_ty≥
;

963 
¢d_soc_çlg_¥iv©e
 *
¥iv
;

964 
num_˘ls
;

965 
¢d_çlg_˘l_ãm∂©e
 *
˘l
[0];

971 
	s¢d_çlg_°ªam_ãm∂©e
 {

972 c⁄° *
«me
;

973 
f‹m©
;

974 
øã
;

975 
≥riod_byãs
;

976 
buf„r_byãs
;

977 
ch™√ls
;

983 
	s¢d_çlg_°ªam_ˇps_ãm∂©e
 {

984 c⁄° *
«me
;

985 
uöt64_t
 
f‹m©s
;

986 
øãs
;

987 
øã_mö
;

988 
øã_max
;

989 
ch™√ls_mö
;

990 
ch™√ls_max
;

991 
≥riods_mö
;

992 
≥riods_max
;

993 
≥riod_size_mö
;

994 
≥riod_size_max
;

995 
buf„r_size_mö
;

996 
buf„r_size_max
;

997 
sig_bôs
;

1003 
	s¢d_çlg_pcm_ãm∂©e
 {

1004 c⁄° *
pcm_«me
;

1005 c⁄° *
dai_«me
;

1006 
pcm_id
;

1007 
dai_id
;

1008 
∂ayback
;

1009 
ˇ±uª
;

1010 
com¥ess
;

1011 
¢d_çlg_°ªam_ˇps_ãm∂©e
 *
ˇps
[2];

1012 
Êag_mask
;

1013 
Êags
;

1014 
¢d_soc_çlg_¥iv©e
 *
¥iv
;

1015 
num_°ªams
;

1016 
¢d_çlg_°ªam_ãm∂©e
 
°ªam
[0];

1023 
	s¢d_çlg_hw_c⁄fig_ãm∂©e
 {

1024 
id
;

1025 
fmt
;

1026 
˛ock_g©ed
;

1027 
övît_b˛k
;

1028 
övît_fsync
;

1029 
b˛k_¥ovidî
;

1030 
fsync_¥ovidî
;

1031 
m˛k_dúe˘i⁄
;

1032 
ª£rved
;

1033 
m˛k_øã
;

1034 
b˛k_øã
;

1035 
fsync_øã
;

1036 
tdm_¶Ÿs
;

1037 
tdm_¶Ÿ_width
;

1038 
tx_¶Ÿs
;

1039 
rx_¶Ÿs
;

1040 
tx_ch™√ls
;

1041 *
tx_ch™m≠
;

1042 
rx_ch™√ls
;

1043 *
rx_ch™m≠
;

1050 
	s¢d_çlg_dai_ãm∂©e
 {

1051 c⁄° *
dai_«me
;

1052 
dai_id
;

1053 
∂ayback
;

1054 
ˇ±uª
;

1055 
¢d_çlg_°ªam_ˇps_ãm∂©e
 *
ˇps
[2];

1056 
Êag_mask
;

1057 
Êags
;

1058 
¢d_soc_çlg_¥iv©e
 *
¥iv
;

1065 
	s¢d_çlg_lök_ãm∂©e
 {

1066 c⁄° *
«me
;

1067 
id
;

1068 c⁄° *
°ªam_«me
;

1070 
num_°ªams
;

1071 
¢d_çlg_°ªam_ãm∂©e
 *
°ªam
;

1073 
¢d_çlg_hw_c⁄fig_ãm∂©e
 *
hw_c⁄fig
;

1074 
num_hw_c⁄figs
;

1075 
deÁu…_hw_c⁄fig_id
;

1077 
Êag_mask
;

1078 
Êags
;

1079 
¢d_soc_çlg_¥iv©e
 *
¥iv
;

1085 
	s¢d_çlg_obj_ãm∂©e
 {

1086 
¢d_çlg_ty≥
 
ty≥
;

1087 
ödex
;

1088 
vîsi⁄
;

1089 
víd‹_ty≥
;

1091 
¢d_çlg_widgë_ãm∂©e
 *
widgë
;

1092 
¢d_çlg_mixî_ãm∂©e
 *
mixî
;

1093 
¢d_çlg_byãs_ãm∂©e
 *
byãs_˘l
;

1094 
¢d_çlg_íum_ãm∂©e
 *
íum_˘l
;

1095 
¢d_çlg_gøph_ãm∂©e
 *
gøph
;

1096 
¢d_çlg_pcm_ãm∂©e
 *
pcm
;

1097 
¢d_çlg_lök_ãm∂©e
 *
lök
;

1098 
¢d_çlg_dai_ãm∂©e
 *
dai
;

1100 } 
	t¢d_çlg_obj_ãm∂©e_t
;

1108 
¢d_çlg_add_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
);

1116 
¢d_çlg_buûd
(
¢d_çlg_t
 *
çlg
, c⁄° *
outfûe
);

1125 
¢d_çlg_buûd_bö
(
¢d_çlg_t
 *
çlg
, **
bö
, 
size_t
 *
size
);

1134 
¢d_çlg_£t_m™i„°_d©a
(
¢d_çlg_t
 *
çlg
, c⁄° *
d©a
, 
Àn
);

1142 
¢d_çlg_£t_vîsi⁄
(
¢d_çlg_t
 *
çlg
, 
vîsi⁄
);

1147 
	#SND_TPLG_SAVE_SORT
 (1<<0Ë

	)

1148 
	#SND_TPLG_SAVE_GROUPS
 (1<<1Ë

	)

1149 
	#SND_TPLG_SAVE_NOCHECK
 (1<<16Ë

	)

1163 
¢d_çlg_ßve
(
¢d_çlg_t
 *
çlg
, **
d°
, 
Êags
);

1173 
¢d_çlg_decode
(
¢d_çlg_t
 *
çlg
, *
bö
, 
size_t
 
size
, 
dÊags
);

1177 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/type_compat.h

22 #i‚de‡
__TYPE_COMPAT_H


23 
	#__TYPE_COMPAT_H


	)

25 #i‚de‡
EBADFD


26 
	#EBADFD
 
EBADF


	)

28 #i‚de‡
ESTRPIPE


29 
	#ESTRPIPE
 
ESPIPE


	)

32 #i‚de‡
__u16


33 
	#__u16
 
uöt16_t


	)

35 #i‚de‡
__u32


36 
	#__u32
 
uöt32_t


	)

38 #i‚de‡
__u64


39 
	#__u64
 
uöt64_t


	)

41 #i‚de‡
__À16


42 
	#__À16
 
uöt16_t


	)

44 #i‚de‡
__À32


45 
	#__À32
 
uöt32_t


	)

47 #i‚de‡
__À64


48 
	#__À64
 
uöt64_t


	)

50 #i‚de‡
__kî√l_pid_t


51 
	#__kî√l_pid_t
 
pid_t


	)

53 #i‚de‡
__kî√l_off_t


54 
	#__kî√l_off_t
 
off_t


	)

57 #i‚de‡
__bôwi£


58 
	#__bôwi£


	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/ump.h

9 #i‚de‡
__ALSA_UMP_H


10 
	#__ALSA_UMP_H


	)

12 #ifde‡
__˝lu•lus


17 
_¢d_ump
 
	t¢d_ump_t
;

19 
¢d_ump_ídpoöt_öfo
 
	t¢d_ump_ídpoöt_öfo_t
;

21 
¢d_ump_block_öfo
 
	t¢d_ump_block_öfo_t
;

23 
¢d_ump_›í
(
¢d_ump_t
 **
öpuç
, snd_ump_à**
ouçuç
, c⁄° *
«me
, 
mode
);

24 
¢d_ump_˛o£
(
¢d_ump_t
 *
ump
);

25 
¢d_øwmidi_t
 *
¢d_ump_øwmidi
(
¢d_ump_t
 *
ump
);

26 c⁄° *
¢d_ump_«me
(
¢d_ump_t
 *
ump
);

27 
¢d_ump_pﬁl_des¸ùt‹s_cou¡
(
¢d_ump_t
 *
ump
);

28 
¢d_ump_pﬁl_des¸ùt‹s
(
¢d_ump_t
 *
ump
, 
pﬁlfd
 *
pfds
, 
•a˚
);

29 
¢d_ump_pﬁl_des¸ùt‹s_ªvíts
(
¢d_ump_t
 *
ump
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
);

30 
¢d_ump_n⁄block
(
¢d_ump_t
 *
ump
, 
n⁄block
);

31 
¢d_ump_øwmidi_öfo
(
¢d_ump_t
 *
ump
, 
¢d_øwmidi_öfo_t
 *
öfo
);

32 
¢d_ump_øwmidi_∑øms
(
¢d_ump_t
 *
ump
, 
¢d_øwmidi_∑øms_t
 *
∑øms
);

33 
¢d_ump_øwmidi_∑øms_cuºít
(
¢d_ump_t
 *
ump
, 
¢d_øwmidi_∑øms_t
 *
∑øms
);

34 
¢d_ump_øwmidi_°©us
(
¢d_ump_t
 *
ump
, 
¢d_øwmidi_°©us_t
 *
°©us
);

35 
¢d_ump_dr›
(
¢d_ump_t
 *
ump
);

36 
¢d_ump_døö
(
¢d_ump_t
 *
ump
);

37 
ssize_t
 
¢d_ump_wrôe
(
¢d_ump_t
 *
ump
, c⁄° *
buf„r
, 
size_t
 
size
);

38 
ssize_t
 
¢d_ump_ªad
(
¢d_ump_t
 *
ump
, *
buf„r
, 
size_t
 
size
);

39 
ssize_t
 
¢d_ump_åód
(
¢d_ump_t
 *
ump
, 
time•ec
 *
t°amp
, *
buf„r
, 
size_t
 
size
);

42 
	#SND_UMP_MAX_GROUPS
 16

	)

44 
	#SND_UMP_MAX_BLOCKS
 32

	)

47 
	e_¢d_ump_dúe˘i⁄
 {

49 
SND_UMP_DIR_INPUT
 = 0x01,

51 
SND_UMP_DIR_OUTPUT
 = 0x02,

53 
SND_UMP_DIR_BIDIRECTION
 = 0x03,

57 
	#SND_UMP_EP_INFO_STATIC_BLOCKS
 0x01

	)

60 
	#SND_UMP_EP_INFO_PROTO_MIDI_MASK
 0x0300

	)

62 
	#SND_UMP_EP_INFO_PROTO_MIDI1
 0x0100

	)

64 
	#SND_UMP_EP_INFO_PROTO_MIDI2
 0x0200

	)

66 
	#SND_UMP_EP_INFO_PROTO_JRTS_MASK
 0x0003

	)

68 
	#SND_UMP_EP_INFO_PROTO_JRTS_TX
 0x0001

	)

70 
	#SND_UMP_EP_INFO_PROTO_JRTS_RX
 0x0002

	)

72 
size_t
 
¢d_ump_ídpoöt_öfo_sizeof
();

77 
	#¢d_ump_ídpoöt_öfo_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_ump_ídpoöt_öfo
)

	)

78 
¢d_ump_ídpoöt_öfo_mÆloc
(
¢d_ump_ídpoöt_öfo_t
 **
öfo
);

79 
¢d_ump_ídpoöt_öfo_‰ì
(
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

80 
¢d_ump_ídpoöt_öfo_c›y
(
¢d_ump_ídpoöt_öfo_t
 *
d°
, c⁄° snd_ump_ídpoöt_öfo_à*
§c
);

81 
¢d_ump_ídpoöt_öfo_gë_ˇrd
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

82 
¢d_ump_ídpoöt_öfo_gë_devi˚
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

83 
¢d_ump_ídpoöt_öfo_gë_Êags
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

84 
¢d_ump_ídpoöt_öfo_gë_¥Ÿocﬁ_ˇps
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

85 
¢d_ump_ídpoöt_öfo_gë_¥Ÿocﬁ
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

86 
¢d_ump_ídpoöt_öfo_gë_num_blocks
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

87 
¢d_ump_ídpoöt_öfo_gë_vîsi⁄
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

88 
¢d_ump_ídpoöt_öfo_gë_m™uÁ˘uªr_id
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

89 
¢d_ump_ídpoöt_öfo_gë_Ámûy_id
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

90 
¢d_ump_ídpoöt_öfo_gë_modñ_id
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

91 c⁄° *
¢d_ump_ídpoöt_öfo_gë_sw_ªvisi⁄
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

92 c⁄° *
¢d_ump_ídpoöt_öfo_gë_«me
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

93 c⁄° *
¢d_ump_ídpoöt_öfo_gë_¥odu˘_id
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

94 
¢d_ump_ídpoöt_öfo
(
¢d_ump_t
 *
ump
, 
¢d_ump_ídpoöt_öfo_t
 *
öfo
);

97 
	#SND_UMP_BLOCK_IS_MIDI1
 (1U << 0)

	)

99 
	#SND_UMP_BLOCK_IS_LOWSPEED
 (1U << 1)

	)

102 
	e_¢d_ump_block_ui_höt
 {

104 
SND_UMP_BLOCK_UI_HINT_UNKNOWN
 = 0x00,

106 
SND_UMP_BLOCK_UI_HINT_RECEIVER
 = 0x01,

108 
SND_UMP_BLOCK_UI_HINT_SENDER
 = 0x02,

110 
SND_UMP_BLOCK_UI_HINT_BOTH
 = 0x03,

113 
size_t
 
¢d_ump_block_öfo_sizeof
();

118 
	#¢d_ump_block_öfo_Æloˇ
(
±r
Ë
	`__¢d_Æloˇ
’å, 
¢d_ump_block_öfo
)

	)

119 
¢d_ump_block_öfo_mÆloc
(
¢d_ump_block_öfo_t
 **
öfo
);

120 
¢d_ump_block_öfo_‰ì
(
¢d_ump_block_öfo_t
 *
öfo
);

121 
¢d_ump_block_öfo_c›y
(
¢d_ump_block_öfo_t
 *
d°
, c⁄° snd_ump_block_öfo_à*
§c
);

122 
¢d_ump_block_öfo_gë_ˇrd
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
);

123 
¢d_ump_block_öfo_gë_devi˚
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
);

124 
¢d_ump_block_öfo_gë_block_id
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
);

125 
¢d_ump_block_öfo_£t_block_id
(
¢d_ump_block_öfo_t
 *
öfo
, 
id
);

126 
¢d_ump_block_öfo_gë_a˘ive
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
);

127 
¢d_ump_block_öfo_gë_Êags
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
);

128 
¢d_ump_block_öfo_gë_dúe˘i⁄
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
);

129 
¢d_ump_block_öfo_gë_fú°_group
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
);

130 
¢d_ump_block_öfo_gë_num_groups
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
);

131 
¢d_ump_block_öfo_gë_midi_ci_vîsi⁄
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
);

132 
¢d_ump_block_öfo_gë_sy£x8_°ªams
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
);

133 
¢d_ump_block_öfo_gë_ui_höt
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
);

134 c⁄° *
¢d_ump_block_öfo_gë_«me
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
);

135 
¢d_ump_block_öfo
(
¢d_ump_t
 *
ump
, 
¢d_ump_block_öfo_t
 *
öfo
);

137 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/ump_msg.h

9 #i‚de‡
__ALSA_UMP_MSG_H


10 
	#__ALSA_UMP_MSG_H


	)

12 
	~<°döt.h
>

14 #ifde‡
__˝lu•lus


19 
	s_¢d_ump_msg_hdr
 {

20 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


21 
uöt8_t
 
ty≥
:4;

22 
uöt8_t
 
group
:4;

23 
uöt8_t
 
°©us
:4;

24 
uöt8_t
 
ch™√l
:4;

25 
uöt8_t
 
byã1
;

26 
uöt8_t
 
byã2
;

28 
uöt8_t
 
byã2
;

29 
uöt8_t
 
byã1
;

30 
uöt8_t
 
ch™√l
:4;

31 
uöt8_t
 
°©us
:4;

32 
uöt8_t
 
group
:4;

33 
uöt8_t
 
ty≥
:4;

35 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_hdr_t
;

38 
	s_¢d_ump_msg_midi1_nŸe
 {

39 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


40 
uöt8_t
 
ty≥
:4;

41 
uöt8_t
 
group
:4;

42 
uöt8_t
 
°©us
:4;

43 
uöt8_t
 
ch™√l
:4;

44 
uöt8_t
 
nŸe
;

45 
uöt8_t
 
vñocôy
;

47 
uöt8_t
 
vñocôy
;

48 
uöt8_t
 
nŸe
;

49 
uöt8_t
 
ch™√l
:4;

50 
uöt8_t
 
°©us
:4;

51 
uöt8_t
 
group
:4;

52 
uöt8_t
 
ty≥
:4;

54 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi1_nŸe_t
;

57 
	s_¢d_ump_msg_midi1_∑f
 {

58 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


59 
uöt8_t
 
ty≥
:4;

60 
uöt8_t
 
group
:4;

61 
uöt8_t
 
°©us
:4;

62 
uöt8_t
 
ch™√l
:4;

63 
uöt8_t
 
nŸe
;

64 
uöt8_t
 
d©a
;

66 
uöt8_t
 
d©a
;

67 
uöt8_t
 
nŸe
;

68 
uöt8_t
 
ch™√l
:4;

69 
uöt8_t
 
°©us
:4;

70 
uöt8_t
 
group
:4;

71 
uöt8_t
 
ty≥
:4;

73 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi1_∑f_t
;

76 
	s_¢d_ump_msg_midi1_cc
 {

77 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


78 
uöt8_t
 
ty≥
:4;

79 
uöt8_t
 
group
:4;

80 
uöt8_t
 
°©us
:4;

81 
uöt8_t
 
ch™√l
:4;

82 
uöt8_t
 
ödex
;

83 
uöt8_t
 
d©a
;

85 
uöt8_t
 
d©a
;

86 
uöt8_t
 
ödex
;

87 
uöt8_t
 
ch™√l
:4;

88 
uöt8_t
 
°©us
:4;

89 
uöt8_t
 
group
:4;

90 
uöt8_t
 
ty≥
:4;

92 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi1_cc_t
;

95 
	s_¢d_ump_msg_midi1_¥ogøm
 {

96 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


97 
uöt8_t
 
ty≥
:4;

98 
uöt8_t
 
group
:4;

99 
uöt8_t
 
°©us
:4;

100 
uöt8_t
 
ch™√l
:4;

101 
uöt8_t
 
¥ogøm
;

102 
uöt8_t
 
ª£rved
;

104 
uöt8_t
 
ª£rved
;

105 
uöt8_t
 
¥ogøm
;

106 
uöt8_t
 
ch™√l
:4;

107 
uöt8_t
 
°©us
:4;

108 
uöt8_t
 
group
:4;

109 
uöt8_t
 
ty≥
:4;

111 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi1_¥ogøm_t
;

114 
	s_¢d_ump_msg_midi1_ˇf
 {

115 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


116 
uöt8_t
 
ty≥
:4;

117 
uöt8_t
 
group
:4;

118 
uöt8_t
 
°©us
:4;

119 
uöt8_t
 
ch™√l
:4;

120 
uöt8_t
 
d©a
;

121 
uöt8_t
 
ª£rved
;

123 
uöt8_t
 
ª£rved
;

124 
uöt8_t
 
d©a
;

125 
uöt8_t
 
ch™√l
:4;

126 
uöt8_t
 
°©us
:4;

127 
uöt8_t
 
group
:4;

128 
uöt8_t
 
ty≥
:4;

130 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi1_ˇf_t
;

133 
	s_¢d_ump_msg_midi1_pôchbíd
 {

134 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


135 
uöt8_t
 
ty≥
:4;

136 
uöt8_t
 
group
:4;

137 
uöt8_t
 
°©us
:4;

138 
uöt8_t
 
ch™√l
:4;

139 
uöt8_t
 
d©a_lsb
;

140 
uöt8_t
 
d©a_msb
;

142 
uöt8_t
 
d©a_msb
;

143 
uöt8_t
 
d©a_lsb
;

144 
uöt8_t
 
ch™√l
:4;

145 
uöt8_t
 
°©us
:4;

146 
uöt8_t
 
group
:4;

147 
uöt8_t
 
ty≥
:4;

149 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi1_pôchbíd_t
;

152 
	s¢d_ump_msg_sy°em
 {

153 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


154 
uöt8_t
 
ty≥
:4;

155 
uöt8_t
 
group
:4;

156 
uöt8_t
 
°©us
;

157 
uöt8_t
 
∑rm1
;

158 
uöt8_t
 
∑rm2
;

160 
uöt8_t
 
∑rm1
;

161 
uöt8_t
 
∑rm2
;

162 
uöt8_t
 
°©us
;

163 
uöt8_t
 
group
:4;

164 
uöt8_t
 
ty≥
:4;

166 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_sy°em_t
;

169 
	u_¢d_ump_msg_midi1
 {

170 
¢d_ump_msg_midi1_nŸe_t
 
nŸe_⁄
;

171 
¢d_ump_msg_midi1_nŸe_t
 
nŸe_off
;

172 
¢d_ump_msg_midi1_∑f_t
 
pﬁy_¥essuª
;

173 
¢d_ump_msg_midi1_cc_t
 
c⁄åﬁ_ch™ge
;

174 
¢d_ump_msg_midi1_¥ogøm_t
 
¥ogøm_ch™ge
;

175 
¢d_ump_msg_midi1_ˇf_t
 
ch™√l_¥essuª
;

176 
¢d_ump_msg_midi1_pôchbíd_t
 
pôchbíd
;

177 
¢d_ump_msg_sy°em_t
 
sy°em
;

178 
¢d_ump_msg_hdr_t
 
hdr
;

179 
uöt32_t
 
øw
;

180 } 
	t¢d_ump_msg_midi1_t
;

184 
SND_UMP_MIDI2_NOTE_ATTR_NO_DATA
 = 0x00,

185 
SND_UMP_MIDI2_NOTE_ATTR_MANUFACTURER
 = 0x01,

186 
SND_UMP_MIDI2_NOTE_ATTR_PROFILE
 = 0x02,

187 
SND_UMP_MIDI2_NOTE_ATTR_PITCH79
 = 0x03,

191 
	s_¢d_ump_msg_midi2_nŸe
 {

192 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


193 
uöt8_t
 
ty≥
:4;

194 
uöt8_t
 
group
:4;

195 
uöt8_t
 
°©us
:4;

196 
uöt8_t
 
ch™√l
:4;

197 
uöt8_t
 
nŸe
;

198 
uöt8_t
 
©å_ty≥
;

200 
uöt16_t
 
vñocôy
;

201 
uöt16_t
 
©å_d©a
;

203 
uöt8_t
 
©å_ty≥
;

204 
uöt8_t
 
nŸe
;

205 
uöt8_t
 
ch™√l
:4;

206 
uöt8_t
 
°©us
:4;

207 
uöt8_t
 
group
:4;

208 
uöt8_t
 
ty≥
:4;

210 
uöt16_t
 
©å_d©a
;

211 
uöt16_t
 
vñocôy
;

213 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi2_nŸe_t
;

216 
	s_¢d_ump_msg_midi2_∑f
 {

217 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


218 
uöt8_t
 
ty≥
:4;

219 
uöt8_t
 
group
:4;

220 
uöt8_t
 
°©us
:4;

221 
uöt8_t
 
ch™√l
:4;

222 
uöt8_t
 
nŸe
;

223 
uöt8_t
 
ª£rved
;

225 
uöt32_t
 
d©a
;

227 
uöt8_t
 
ª£rved
;

228 
uöt8_t
 
nŸe
;

229 
uöt8_t
 
ch™√l
:4;

230 
uöt8_t
 
°©us
:4;

231 
uöt8_t
 
group
:4;

232 
uöt8_t
 
ty≥
:4;

234 
uöt32_t
 
d©a
;

236 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi2_∑f_t
;

239 
	s_¢d_ump_msg_midi2_≥r_nŸe_cc
 {

240 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


241 
uöt8_t
 
ty≥
:4;

242 
uöt8_t
 
group
:4;

243 
uöt8_t
 
°©us
:4;

244 
uöt8_t
 
ch™√l
:4;

245 
uöt8_t
 
nŸe
;

246 
uöt8_t
 
ödex
;

248 
uöt32_t
 
d©a
;

250 
uöt8_t
 
ödex
;

251 
uöt8_t
 
nŸe
;

252 
uöt8_t
 
ch™√l
:4;

253 
uöt8_t
 
°©us
:4;

254 
uöt8_t
 
group
:4;

255 
uöt8_t
 
ty≥
:4;

257 
uöt32_t
 
d©a
;

259 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi2_≥r_nŸe_cc_t
;

263 
SND_UMP_MIDI2_PNMGMT_RESET_CONTROLLERS
 = 0x01,

264 
SND_UMP_MIDI2_PNMGMT_DETACH_CONTROLLERS
 = 0x02,

268 
	s_¢d_ump_msg_midi2_≥r_nŸe_mgmt
 {

269 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


270 
uöt8_t
 
ty≥
:4;

271 
uöt8_t
 
group
:4;

272 
uöt8_t
 
°©us
:4;

273 
uöt8_t
 
ch™√l
:4;

274 
uöt8_t
 
nŸe
;

275 
uöt8_t
 
Êags
;

277 
uöt32_t
 
ª£rved
;

279 
uöt8_t
 
Êags
;

280 
uöt8_t
 
nŸe
;

281 
uöt8_t
 
ch™√l
:4;

282 
uöt8_t
 
°©us
:4;

283 
uöt8_t
 
group
:4;

284 
uöt8_t
 
ty≥
:4;

286 
uöt32_t
 
ª£rved
;

288 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi2_≥r_nŸe_mgmt_t
;

291 
	s_¢d_ump_msg_midi2_cc
 {

292 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


293 
uöt8_t
 
ty≥
:4;

294 
uöt8_t
 
group
:4;

295 
uöt8_t
 
°©us
:4;

296 
uöt8_t
 
ch™√l
:4;

297 
uöt8_t
 
ödex
;

298 
uöt8_t
 
ª£rved
;

300 
uöt32_t
 
d©a
;

302 
uöt8_t
 
ª£rved
;

303 
uöt8_t
 
ödex
;

304 
uöt8_t
 
ch™√l
:4;

305 
uöt8_t
 
°©us
:4;

306 
uöt8_t
 
group
:4;

307 
uöt8_t
 
ty≥
:4;

309 
uöt32_t
 
d©a
;

311 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi2_cc_t
;

314 
	s_¢d_ump_msg_midi2_Ωn
 {

315 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


316 
uöt8_t
 
ty≥
:4;

317 
uöt8_t
 
group
:4;

318 
uöt8_t
 
°©us
:4;

319 
uöt8_t
 
ch™√l
:4;

320 
uöt8_t
 
b™k
;

321 
uöt8_t
 
ödex
;

323 
uöt32_t
 
d©a
;

325 
uöt8_t
 
ödex
;

326 
uöt8_t
 
b™k
;

327 
uöt8_t
 
ch™√l
:4;

328 
uöt8_t
 
°©us
:4;

329 
uöt8_t
 
group
:4;

330 
uöt8_t
 
ty≥
:4;

332 
uöt32_t
 
d©a
;

334 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi2_Ωn_t
;

337 
	s_¢d_ump_msg_midi2_¥ogøm
 {

338 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


339 
uöt8_t
 
ty≥
:4;

340 
uöt8_t
 
group
:4;

341 
uöt8_t
 
°©us
:4;

342 
uöt8_t
 
ch™√l
:4;

343 
uöt16_t
 
ª£rved
:15;

344 
uöt16_t
 
b™k_vÆid
:1;

346 
uöt8_t
 
¥ogøm
;

347 
uöt8_t
 
ª£rved2
;

348 
uöt8_t
 
b™k_msb
;

349 
uöt8_t
 
b™k_lsb
;

351 
uöt16_t
 
b™k_vÆid
:1;

352 
uöt16_t
 
ª£rved
:15;

353 
uöt8_t
 
ch™√l
:4;

354 
uöt8_t
 
°©us
:4;

355 
uöt8_t
 
group
:4;

356 
uöt8_t
 
ty≥
:4;

358 
uöt8_t
 
b™k_lsb
;

359 
uöt8_t
 
b™k_msb
;

360 
uöt8_t
 
ª£rved2
;

361 
uöt8_t
 
¥ogøm
;

363 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi2_¥ogøm_t
;

366 
	s_¢d_ump_msg_midi2_ˇf
 {

367 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


368 
uöt8_t
 
ty≥
:4;

369 
uöt8_t
 
group
:4;

370 
uöt8_t
 
°©us
:4;

371 
uöt8_t
 
ch™√l
:4;

372 
uöt16_t
 
ª£rved
;

374 
uöt32_t
 
d©a
;

376 
uöt16_t
 
ª£rved
;

377 
uöt8_t
 
ch™√l
:4;

378 
uöt8_t
 
°©us
:4;

379 
uöt8_t
 
group
:4;

380 
uöt8_t
 
ty≥
:4;

382 
uöt32_t
 
d©a
;

384 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi2_ˇf_t
;

387 
	s_¢d_ump_msg_midi2_pôchbíd
 {

388 #ifde‡
SNDRV_BIG_ENDIAN_BITFIELD


389 
uöt8_t
 
ty≥
:4;

390 
uöt8_t
 
group
:4;

391 
uöt8_t
 
°©us
:4;

392 
uöt8_t
 
ch™√l
:4;

393 
uöt16_t
 
ª£rved
;

395 
uöt32_t
 
d©a
;

397 
uöt16_t
 
ª£rved
;

398 
uöt8_t
 
ch™√l
:4;

399 
uöt8_t
 
°©us
:4;

400 
uöt8_t
 
group
:4;

401 
uöt8_t
 
ty≥
:4;

403 
uöt32_t
 
d©a
;

405 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi2_pôchbíd_t
;

408 
	s_¢d_ump_msg_midi2_≥r_nŸe_pôchbíd
 {

409 #ifde‡
__BIG_ENDIAN_BITFIELD


410 
uöt8_t
 
ty≥
:4;

411 
uöt8_t
 
group
:4;

412 
uöt8_t
 
°©us
:4;

413 
uöt8_t
 
ch™√l
:4;

414 
uöt8_t
 
nŸe
;

415 
uöt8_t
 
ª£rved
;

417 
uöt32_t
 
d©a
;

420 
uöt8_t
 
ª£rved
;

421 
uöt8_t
 
nŸe
;

422 
uöt8_t
 
ch™√l
:4;

423 
uöt8_t
 
°©us
:4;

424 
uöt8_t
 
group
:4;

425 
uöt8_t
 
ty≥
:4;

427 
uöt32_t
 
d©a
;

429 } 
	t__©åibuã
((
	t∑cked
)Ë
	t¢d_ump_msg_midi2_≥r_nŸe_pôchbíd_t
;

432 
	u_¢d_ump_msg_midi2
 {

433 
¢d_ump_msg_midi2_nŸe_t
 
nŸe_⁄
;

434 
¢d_ump_msg_midi2_nŸe_t
 
nŸe_off
;

435 
¢d_ump_msg_midi2_∑f_t
 
pﬁy_¥essuª
;

436 
¢d_ump_msg_midi2_≥r_nŸe_cc_t
 
≥r_nŸe_acc
;

437 
¢d_ump_msg_midi2_≥r_nŸe_cc_t
 
≥r_nŸe_rcc
;

438 
¢d_ump_msg_midi2_≥r_nŸe_mgmt_t
 
≥r_nŸe_mgmt
;

439 
¢d_ump_msg_midi2_cc_t
 
c⁄åﬁ_ch™ge
;

440 
¢d_ump_msg_midi2_Ωn_t
 
Ωn
;

441 
¢d_ump_msg_midi2_Ωn_t
 
ƒ≤
;

442 
¢d_ump_msg_midi2_Ωn_t
 
ªœtive_Ωn
;

443 
¢d_ump_msg_midi2_Ωn_t
 
ªœtive_ƒ≤
;

444 
¢d_ump_msg_midi2_¥ogøm_t
 
¥ogøm_ch™ge
;

445 
¢d_ump_msg_midi2_ˇf_t
 
ch™√l_¥essuª
;

446 
¢d_ump_msg_midi2_pôchbíd_t
 
pôchbíd
;

447 
¢d_ump_msg_midi2_≥r_nŸe_pôchbíd_t
 
≥r_nŸe_pôchbíd
;

448 
¢d_ump_msg_hdr_t
 
hdr
;

449 
uöt32_t
 
øw
[2];

450 } 
	t¢d_ump_msg_midi2_t
;

456 
SND_UMP_MSG_TYPE_UTILITY
 = 0x00,

457 
SND_UMP_MSG_TYPE_SYSTEM
 = 0x01,

458 
SND_UMP_MSG_TYPE_MIDI1_CHANNEL_VOICE
 = 0x02,

459 
SND_UMP_MSG_TYPE_DATA
 = 0x03,

460 
SND_UMP_MSG_TYPE_MIDI2_CHANNEL_VOICE
 = 0x04,

461 
SND_UMP_MSG_TYPE_EXTENDED_DATA
 = 0x05,

462 
SND_UMP_MSG_TYPE_FLEX_DATA
 = 0x0d,

463 
SND_UMP_MSG_TYPE_STREAM
 = 0x0f,

470 
SND_UMP_MSG_PER_NOTE_RCC
 = 0x0,

471 
SND_UMP_MSG_PER_NOTE_ACC
 = 0x1,

472 
SND_UMP_MSG_RPN
 = 0x2,

473 
SND_UMP_MSG_NRPN
 = 0x3,

474 
SND_UMP_MSG_RELATIVE_RPN
 = 0x4,

475 
SND_UMP_MSG_RELATIVE_NRPN
 = 0x5,

476 
SND_UMP_MSG_PER_NOTE_PITCHBEND
 = 0x6,

477 
SND_UMP_MSG_NOTE_OFF
 = 0x8,

478 
SND_UMP_MSG_NOTE_ON
 = 0x9,

479 
SND_UMP_MSG_POLY_PRESSURE
 = 0xa,

480 
SND_UMP_MSG_CONTROL_CHANGE
 = 0xb,

481 
SND_UMP_MSG_PROGRAM_CHANGE
 = 0xc,

482 
SND_UMP_MSG_CHANNEL_PRESSURE
 = 0xd,

483 
SND_UMP_MSG_PITCHBEND
 = 0xe,

484 
SND_UMP_MSG_PER_NOTE_MGMT
 = 0xf,

491 
SND_UMP_MSG_REALTIME
 = 0xf0,

492 
SND_UMP_MSG_SYSEX_START
 = 0xf0,

493 
SND_UMP_MSG_MIDI_TIME_CODE
 = 0xf1,

494 
SND_UMP_MSG_SONG_POSITION
 = 0xf2,

495 
SND_UMP_MSG_SONG_SELECT
 = 0xf3,

496 
SND_UMP_MSG_TUNE_REQUEST
 = 0xf6,

497 
SND_UMP_MSG_SYSEX_END
 = 0xf7,

498 
SND_UMP_MSG_TIMING_CLOCK
 = 0xf8,

499 
SND_UMP_MSG_START
 = 0xfa,

500 
SND_UMP_MSG_CONTINUE
 = 0xfb,

501 
SND_UMP_MSG_STOP
 = 0xfc,

502 
SND_UMP_MSG_ACTIVE_SENSING
 = 0xfe,

503 
SND_UMP_MSG_RESET
 = 0xff,

508 
SND_UMP_SYSEX_STATUS_SINGLE
 = 0,

509 
SND_UMP_SYSEX_STATUS_START
 = 1,

510 
SND_UMP_SYSEX_STATUS_CONTINUE
 = 2,

511 
SND_UMP_SYSEX_STATUS_END
 = 3,

516 
SND_UMP_UTILITY_MSG_STATUS_NOOP
 = 0x00,

517 
SND_UMP_UTILITY_MSG_STATUS_JR_CLOCK
 = 0x01,

518 
SND_UMP_UTILITY_MSG_STATUS_JR_TSTAMP
 = 0x02,

519 
SND_UMP_UTILITY_MSG_STATUS_DCTPQ
 = 0x03,

520 
SND_UMP_UTILITY_MSG_STATUS_DC
 = 0x04,

525 
SND_UMP_STREAM_MSG_STATUS_EP_DISCOVERY
 = 0x00,

526 
SND_UMP_STREAM_MSG_STATUS_EP_INFO
 = 0x01,

527 
SND_UMP_STREAM_MSG_STATUS_DEVICE_INFO
 = 0x02,

528 
SND_UMP_STREAM_MSG_STATUS_EP_NAME
 = 0x03,

529 
SND_UMP_STREAM_MSG_STATUS_PRODUCT_ID
 = 0x04,

530 
SND_UMP_STREAM_MSG_STATUS_STREAM_CFG_REQUEST
 = 0x05,

531 
SND_UMP_STREAM_MSG_STATUS_STREAM_CFG
 = 0x06,

532 
SND_UMP_STREAM_MSG_STATUS_FB_DISCOVERY
 = 0x10,

533 
SND_UMP_STREAM_MSG_STATUS_FB_INFO
 = 0x11,

534 
SND_UMP_STREAM_MSG_STATUS_FB_NAME
 = 0x12,

535 
SND_UMP_STREAM_MSG_STATUS_START_CLIP
 = 0x20,

536 
SND_UMP_STREAM_MSG_STATUS_END_CLIP
 = 0x21,

541 
SND_UMP_STREAM_MSG_REQUEST_EP_INFO
 = (1U << 0),

542 
SND_UMP_STREAM_MSG_REQUEST_DEVICE_INFO
 = (1U << 1),

543 
SND_UMP_STREAM_MSG_REQUEST_EP_NAME
 = (1U << 2),

544 
SND_UMP_STREAM_MSG_REQUEST_PRODUCT_ID
 = (1U << 3),

545 
SND_UMP_STREAM_MSG_REQUEST_STREAM_CFG
 = (1U << 4),

550 
SND_UMP_STREAM_MSG_REQUEST_FB_INFO
 = (1U << 0),

551 
SND_UMP_STREAM_MSG_REQUEST_FB_NAME
 = (1U << 1),

556 
SND_UMP_STREAM_MSG_EP_INFO_CAP_TXJR
 = (1U << 0),

557 
SND_UMP_STREAM_MSG_EP_INFO_CAP_RXJR
 = (1U << 1),

558 
SND_UMP_STREAM_MSG_EP_INFO_CAP_MIDI1
 = (1U << 8),

559 
SND_UMP_STREAM_MSG_EP_INFO_CAP_MIDI2
 = (1U << 9),

564 
SND_UMP_STREAM_MSG_FORMAT_SINGLE
 = 0,

565 
SND_UMP_STREAM_MSG_FORMAT_START
 = 1,

566 
SND_UMP_STREAM_MSG_FORMAT_CONTINUE
 = 2,

567 
SND_UMP_STREAM_MSG_FORMAT_END
 = 3,

573 
ölöe
 
uöt8_t
 
¢d_ump_msg_hdr_°©us
(
uöt32_t
 
ump
)

575  (
ump
 >> 20) & 0x0f;

581 
ölöe
 
uöt8_t
 
¢d_ump_msg_hdr_ch™√l
(
uöt32_t
 
ump
)

583  (
ump
 >> 16) & 0x0f;

589 
ölöe
 
uöt8_t
 
¢d_ump_msg_hdr_ty≥
(
uöt32_t
 
ump
)

591  (
ump
 >> 28);

597 
ölöe
 
¢d_ump_msg_ty≥_is_grou∂ess
(
uöt8_t
 
ty≥
)

599  
ty≥
 =
SND_UMP_MSG_TYPE_UTILITY
 ||Åy≥ =
SND_UMP_MSG_TYPE_STREAM
;

605 
ölöe
 
uöt8_t
 
¢d_ump_msg_hdr_group
(
uöt32_t
 
ump
)

607  (
ump
 >> 24) & 0x0f;

613 
ölöe
 
uöt8_t
 
¢d_ump_msg_°©us
(c⁄° 
uöt32_t
 *
ump
)

615  
¢d_ump_msg_hdr_°©us
(*
ump
);

621 
ölöe
 
uöt8_t
 
¢d_ump_msg_ch™√l
(c⁄° 
uöt32_t
 *
ump
)

623  
¢d_ump_msg_hdr_ch™√l
(*
ump
);

629 
ölöe
 
uöt8_t
 
¢d_ump_msg_ty≥
(c⁄° 
uöt32_t
 *
ump
)

631  
¢d_ump_msg_hdr_ty≥
(*
ump
);

637 
ölöe
 
uöt8_t
 
¢d_ump_msg_group
(c⁄° 
uöt32_t
 *
ump
)

639  
¢d_ump_msg_hdr_group
(*
ump
);

645 
ölöe
 
uöt8_t
 
¢d_ump_sy£x_msg_°©us
(c⁄° 
uöt32_t
 *
ump
)

647  (*
ump
 >> 20) & 0xf;

653 
ölöe
 
uöt8_t
 
¢d_ump_sy£x_msg_Àngth
(c⁄° 
uöt32_t
 *
ump
)

655  (*
ump
 >> 16) & 0xf;

658 
¢d_ump_msg_sy£x_ex∑nd
(c⁄° 
uöt32_t
 *
ump
, 
uöt8_t
 *
buf
, 
size_t
 
maxÀn
,

659 
size_t
 *
fûÀd
);

661 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/use-case.h

38 #i‚de‡
__ALSA_USE_CASE_H


39 
	#__ALSA_USE_CASE_H


	)

41 #ifde‡
__˝lu•lus


45 
	~<Æß/asoundlib.h
>

100 
	#SND_USE_CASE_VERB_INACTIVE
 "I«˘ive"

	)

101 
	#SND_USE_CASE_VERB_HIFI
 "HiFi"

	)

102 
	#SND_USE_CASE_VERB_HIFI_LOW_POWER
 "HiFòLow Powî"

	)

103 
	#SND_USE_CASE_VERB_VOICE
 "Voi˚"

	)

104 
	#SND_USE_CASE_VERB_VOICE_LOW_POWER
 "Voi˚ Low Powî"

	)

105 
	#SND_USE_CASE_VERB_VOICECALL
 "Voi˚ CÆl"

	)

106 
	#SND_USE_CASE_VERB_IP_VOICECALL
 "Voi˚ CÆ»IP"

	)

107 
	#SND_USE_CASE_VERB_ANALOG_RADIO
 "FM A«log Radio"

	)

108 
	#SND_USE_CASE_VERB_DIGITAL_RADIO
 "FM DigôÆ Radio"

	)

132 
	#SND_USE_CASE_DEV_NONE
 "N⁄e"

	)

133 
	#SND_USE_CASE_DEV_SPEAKER
 "S≥akî"

	)

134 
	#SND_USE_CASE_DEV_LINE
 "Löe"

	)

135 
	#SND_USE_CASE_DEV_MIC
 "Mic"

	)

136 
	#SND_USE_CASE_DEV_HEADPHONES
 "Hódph⁄es"

	)

137 
	#SND_USE_CASE_DEV_HEADSET
 "Hód£t"

	)

138 
	#SND_USE_CASE_DEV_HANDSET
 "H™d£t"

	)

139 
	#SND_USE_CASE_DEV_BLUETOOTH
 "BluëoŸh"

	)

140 
	#SND_USE_CASE_DEV_EARPIECE
 "E¨põ˚"

	)

141 
	#SND_USE_CASE_DEV_SPDIF
 "SPDIF"

	)

142 
	#SND_USE_CASE_DEV_HDMI
 "HDMI"

	)

143 
	#SND_USE_CASE_DEV_USB
 "USB"

	)

144 
	#SND_USE_CASE_DEV_DIRECT
 "Dúe˘"

	)

173 
	#SND_USE_CASE_MOD_CAPTURE_VOICE
 "C≠tuª Voi˚"

	)

174 
	#SND_USE_CASE_MOD_CAPTURE_MUSIC
 "C≠tuª Music"

	)

175 
	#SND_USE_CASE_MOD_PLAY_MUSIC
 "Pœy Music"

	)

176 
	#SND_USE_CASE_MOD_PLAY_VOICE
 "Pœy Voi˚"

	)

177 
	#SND_USE_CASE_MOD_PLAY_TONE
 "Pœy T⁄e"

	)

178 
	#SND_USE_CASE_MOD_ECHO_REF
 "EchÿRe„ªn˚"

	)

190 
	#SND_USE_CASE_TQ_MUSIC
 "Music"

	)

191 
	#SND_USE_CASE_TQ_VOICE
 "Voi˚"

	)

192 
	#SND_USE_CASE_TQ_TONES
 "T⁄es"

	)

195 
¢d_u£_ˇ£_mgr
 
	t¢d_u£_ˇ£_mgr_t
;

203 *
¢d_u£_ˇ£_idítifõr
(c⁄° *
fmt
, ...);

211 
¢d_u£_ˇ£_‰ì_li°
(c⁄° *
li°
[], 
ôems
);

241 
¢d_u£_ˇ£_gë_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

242 c⁄° *
idítifõr
,

243 c⁄° **
li°
[]);

412 
¢d_u£_ˇ£_gë
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

413 c⁄° *
idítifõr
,

414 c⁄° **
vÆue
);

427 
¢d_u£_ˇ£_gëi
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

428 c⁄° *
idítifõr
,

429 *
vÆue
);

458 
¢d_u£_ˇ£_£t
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

459 c⁄° *
idítifõr
,

460 c⁄° *
vÆue
);

484 
¢d_u£_ˇ£_mgr_›í
(
¢d_u£_ˇ£_mgr_t
 **
uc_mgr
,

485 c⁄° *
ˇrd_«me
);

493 
¢d_u£_ˇ£_mgr_ªlﬂd
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
);

500 
¢d_u£_ˇ£_mgr_˛o£
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
);

507 
¢d_u£_ˇ£_mgr_ª£t
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
);

518 
__ölöe__
 
¢d_u£_ˇ£_ˇrd_li°
(c⁄° **
li°
[])

520  
¢d_u£_ˇ£_gë_li°
(
NULL
, NULL, 
li°
);

529 
__ölöe__
 
¢d_u£_ˇ£_vîb_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

530 c⁄° **
li°
[])

532  
¢d_u£_ˇ£_gë_li°
(
uc_mgr
, "_vîbs", 
li°
);

542 
¢d_u£_ˇ£_∑r£_˘l_ñem_id
(
¢d_˘l_ñem_id_t
 *
d°
,

543 c⁄° *
ucm_id
,

544 c⁄° *
vÆue
);

553 
¢d_u£_ˇ£_∑r£_£Àm_id
(
¢d_mixî_£Àm_id_t
 *
d°
,

554 c⁄° *
ucm_id
,

555 c⁄° *
vÆue
);

561 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/ac97.c

22 
	~<°dio.h
>

23 
	~<°dlib.h
>

24 
	~<uni°d.h
>

25 
	~<°rög.h
>

26 
	~<f˙é.h
>

27 
	~<sys/io˘l.h
>

28 
	~<m©h.h
>

29 
	~"asoundlib.h
"

30 
	~"mixî_ab°.h
"

31 
	~"sba£.h
"

33 
sm_ñem_›s
 
	gsim∂e_ac97_›s
;

35 
mñem_sids
 
	gsids
[] = {

37 .
sid
 = 
SID_MASTER
,

38 .
	g¢ame
 = "Master",

39 .
	gsödex
 = 0,

40 .
	gweight
 = 1,

41 .
	gch™m≠
 = { 3, 0 },

42 .
	gs›s
 = &
sim∂e_ac97_›s
,

46 
	#SELECTORS
 ((
£À˘‹s
)/(£À˘‹s[0]))

	)

48 
hñem_£À˘‹
 
	g£À˘‹s
[] = {

50 .
iÁ˚
 = 
SND_CTL_ELEM_IFACE_MIXER
,

51 .
	g«me
 = "Master Playback Volume",

52 .
	gödex
 = 0,

53 .
	gsid
 = 
SID_MASTER
,

54 .
	gpuΩo£
 = 
PURPOSE_VOLUME
,

55 .
	gˇps
 = 
SM_CAP_PVOLUME
,

58 .
	giÁ˚
 = 
SND_CTL_ELEM_IFACE_MIXER
,

59 .
	g«me
 = "Master Playback Switch",

60 .
	gödex
 = 0,

61 .
	gsid
 = 
SID_MASTER
,

62 .
	gpuΩo£
 = 
PURPOSE_SWITCH
,

63 .
	gˇps
 = 
SM_CAP_PSWITCH
,

67 
	$Æß_mixî_sim∂e_evít
(
¢d_mixî_˛ass_t
 *
˛ass
, 
mask
,

68 
¢d_h˘l_ñem_t
 *
hñem
, 
¢d_mixî_ñem_t
 *
mñem
)

70 
b˛ass_¥iv©e
 *
¥iv
 = 
	`¢d_mixî_sbasic_gë_¥iv©e
(
˛ass
);

71  
¥iv
->
›s
.
	`evít
(
˛ass
, 
mask
, 
hñem
, 
mñem
);

72 
	}
}

74 
	$Æß_mixî_sim∂e_öô
(
¢d_mixî_˛ass_t
 *
˛ass
)

76 
b˛ass_ba£_›s
 *
›s
;

77 
îr
;

79 
îr
 = 
	`mixî_sim∂e_basic_dl›í
(
˛ass
, &
›s
);

80 i‡(
îr
 < 0)

82 
îr
 = 
›s
->
	`£Ãeg
(
˛ass
, 
£À˘‹s
, 
SELECTORS
);

83 i‡(
îr
 < 0)

84  
îr
;

85 
îr
 = 
›s
->
	`sidªg
(
˛ass
, 
sids
, 
SELECTORS
);

86 i‡(
îr
 < 0)

87  
îr
;

89 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/hda.c

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~<uni°d.h
>

26 
	~<°rög.h
>

27 
	~<f˙é.h
>

28 
	~<sys/io˘l.h
>

29 
	~<m©h.h
>

30 
	~"asoundlib.h
"

31 
	~"mixî_ab°.h
"

32 
	~"sba£.h
"

34 
sm_ñem_›s
 
	gsim∂e_hda_›s
;

36 
mñem_sids
 
	gsids
[] = {

38 .
sid
 = 
SID_FRONT
,

39 .
	g¢ame
 = "Front",

40 .
	gsödex
 = 0,

41 .
	gweight
 = 1,

42 .
	gch™m≠
 = { 3, 0 },

43 .
	gs›s
 = &
sim∂e_hda_›s
,

47 
	#SELECTORS
 ((
£À˘‹s
)/(£À˘‹s[0]))

	)

49 
hñem_£À˘‹
 
	g£À˘‹s
[] = {

51 .
iÁ˚
 = 
SND_CTL_ELEM_IFACE_MIXER
,

52 .
	g«me
 = "Front Playback Volume",

53 .
	gödex
 = 0,

54 .
	gsid
 = 
SID_FRONT
,

55 .
	gpuΩo£
 = 
PURPOSE_VOLUME
,

56 .
	gˇps
 = 
SM_CAP_PVOLUME
,

59 .
	giÁ˚
 = 
SND_CTL_ELEM_IFACE_MIXER
,

60 .
	g«me
 = "Front Playback Switch",

61 .
	gödex
 = 0,

62 .
	gsid
 = 
SID_FRONT
,

63 .
	gpuΩo£
 = 
PURPOSE_SWITCH
,

64 .
	gˇps
 = 
SM_CAP_PSWITCH
,

68 
	$Æß_mixî_sim∂e_evít
(
¢d_mixî_˛ass_t
 *
˛ass
, 
mask
,

69 
¢d_h˘l_ñem_t
 *
hñem
, 
¢d_mixî_ñem_t
 *
mñem
)

71 
b˛ass_¥iv©e
 *
¥iv
 = 
	`¢d_mixî_sbasic_gë_¥iv©e
(
˛ass
);

72  
¥iv
->
›s
.
	`evít
(
˛ass
, 
mask
, 
hñem
, 
mñem
);

73 
	}
}

75 
	$Æß_mixî_sim∂e_öô
(
¢d_mixî_˛ass_t
 *
˛ass
)

77 
b˛ass_ba£_›s
 *
›s
;

78 
îr
;

80 
îr
 = 
	`mixî_sim∂e_basic_dl›í
(
˛ass
, &
›s
);

81 i‡(
îr
 < 0)

83 
îr
 = 
›s
->
	`£Ãeg
(
˛ass
, 
£À˘‹s
, 
SELECTORS
);

84 i‡(
îr
 < 0)

85  
îr
;

86 
îr
 = 
›s
->
	`sidªg
(
˛ass
, 
sids
, 
SELECTORS
);

87 i‡(
îr
 < 0)

88  
îr
;

90 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/python.c

22 
	~"Pyth⁄.h
"

23 
	~<°ddef.h
>

24 
	~<limôs.h
>

25 
	~"c⁄fig.h
"

26 
	~"asoundlib.h
"

27 
	~"mixî_ab°.h
"

29 #i‡(
__GNUC__
 > 4 || (__GNUC__ =4 && 
__GNUC_MINOR__
 >= 2))

30 #¥agm®
GCC
 
dügno°ic
 
ign‹ed
 "-Wstrict-aliasing"

33 
	spyth⁄_¥iv
 {

34 
	mpy_öôülized
;

35 
PyObje˘
 *
	mpy_evít_func
;

36 
PyObje˘
 *
	mpy_mdi˘
;

37 
PyObje˘
 *
	mpy_mixî
;

40 
	#SCRIPT
 "smixî/pyth⁄/maö.py"

	)

42 
	spymñem
 {

43 
PyObje˘_HEAD


44 
sm_£Àm_t
 
	m£Àm
;

45 
PyObje˘
 *
	mpy_mixî
;

46 
¢d_mixî_ñem_t
 *
	mmñem
;

49 
	spymixî
 {

50 
PyObje˘_HEAD


51 
¢d_mixî_˛ass_t
 *
	m˛ass
;

52 
¢d_mixî_t
 *
	mmixî
;

53 
PyObje˘
 *
	mmdi˘
;

54 
	mh˘l_cou¡
;

55 **
	mh˘l
;

56 
	mhñem_cou¡
;

57 **
	mhñem
;

58 
	mmñem_cou¡
;

59 **
	mmñem
;

62 
PyI¡î¥ëîSèã
 *
	gmaö_öãΩªãr
;

64 #i‡
PY_MAJOR_VERSION
 >= 3

65 
	#PyI¡_FromL⁄g
 
PyL⁄g_FromL⁄g


	)

68 
ölöe
 
	$gë_l⁄g
(
PyObje˘
 *
o
, *
vÆ
)

70 #i‡
PY_MAJOR_VERSION
 < 3

71 i‡(
	`PyI¡_Check
(
o
)) {

72 *
vÆ
 = 
	`PyI¡_AsL⁄g
(
o
);

76 i‡(
	`PyL⁄g_Check
(
o
)) {

77 *
vÆ
 = 
	`PyL⁄g_AsL⁄g
(
o
);

81 
	}
}

83 
ölöe
 
PyObje˘
 *
	$I¡înFromSåög
(c⁄° *
«me
)

85 #i‡
PY_MAJOR_VERSION
 < 3

86  
	`PySåög_I¡înFromSåög
(
«me
);

88  
	`PyUnicode_I¡înFromSåög
(
«me
);

90 
	}
}

92 *
	$gë_C_±r
(
PyObje˘
 *
obj
, c⁄° *
©å
)

94 
PyObje˘
 *
o
;

95 
vÆ
;

97 
o
 = 
	`PyObje˘_GëAâr
(
obj
, 
	`I¡înFromSåög
(
©å
));

98 i‡(!
o
) {

99 
	`PyEº_F‹m©
(
PyExc_Ty≥Eº‹
, "missög '%s'áâribuã", 
©å
);

100  
NULL
;

102 i‡(
	`gë_l⁄g
(
o
, &
vÆ
)) {

103 
	`PyEº_F‹m©
(
PyExc_Ty≥Eº‹
, "'%s'áâribuã i†nŸ I¡ o∏L⁄g", 
©å
);

104  
NULL
;

106  (*)
vÆ
;

107 
	}
}

109 
pymñem
 *
	$mñem_to_pymñem
(
¢d_mixî_ñem_t
 *
ñem
)

111  (
pymñem
 *)((*)
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
Ë- 
	`off£tof
(pymñem, 
£Àm
));

112 
	}
}

114 
	$pˇŒ
(
pymñem
 *pymñem, c⁄° *
©å
, 
PyObje˘
 *
¨gs
, PyObje˘ **
_ªs
)

116 
PyObje˘
 *
obj
 = (PyObje˘ *)
pymñem
, *
ªs
;

117 
xªs
 = 0;

119 i‡(
_ªs
)

120 *
_ªs
 = 
NULL
;

121 
obj
 = 
	`PyObje˘_GëAâr
(obj, 
	`I¡înFromSåög
(
©å
));

122 i‡(!
obj
) {

123 
	`PyEº_F‹m©
(
PyExc_Ty≥Eº‹
, "missög '%s'áâribuã", 
©å
);

124 
	`PyEº_Pröt
();

125 
	`PyEº_CÀ¨
();

126 
	`Py_DECREF
(
¨gs
);

127  -
EIO
;

129 
ªs
 = 
	`PyObje˘_CÆlObje˘
(
obj
, 
¨gs
);

130 
	`Py_XDECREF
(
¨gs
);

131 i‡(
ªs
 =
NULL
) {

132 
	`PyEº_Pröt
();

133 
	`PyEº_CÀ¨
();

134  -
EIO
;

136 i‡(
_ªs
 && 
	`PyTu∂e_Check
(
ªs
)) {

137 *
_ªs
 = 
ªs
;

138 
ªs
 = 
	`PyTu∂e_GëIãm
(res, 0);

140 i‡(
	`PyL⁄g_Check
(
ªs
)) {

141 
xªs
 = 
	`PyL⁄g_AsL⁄g
(
ªs
);

142 #i‡
PY_MAJOR_VERSION
 < 3

143 } i‡(
	`PyI¡_Check
(
ªs
)) {

144 
xªs
 = 
	`PyI¡_AsL⁄g
(
ªs
);

146 } i‡(
ªs
 =
Py_N⁄e
) {

147 
xªs
 = 0;

148 } i‡(
	`PyBoﬁ_Check
(
ªs
)) {

149 
xªs
 = 
ªs
 =
Py_True
;

151 
	`PyEº_F‹m©
(
PyExc_Ty≥Eº‹
, "wr⁄gÑesu… from '%s'!", 
©å
);

152 
	`PyEº_Pröt
();

153 
	`PyEº_CÀ¨
();

154 
	`Py_DECREF
(
ªs
);

155 i‡(
_ªs
)

156 *
_ªs
 = 
NULL
;

157  -
EIO
;

159 i‡(
_ªs
 && *_res)

160  
xªs
;

161 
	`Py_DECREF
(
ªs
);

162  
xªs
;

163 
	}
}

165 
	$is_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, 
cmd
, 
vÆ
)

167 
PyObje˘
 *
obj1
;

168 
pymñem
 *pymñem = 
	`mñem_to_pymñem
(
ñem
);

169 *
s
, 
f˙
[32] = "opsIs";

170 
ªs
, 
xdú
 = 1, 
xvÆ
 = 0;

172 
cmd
) {

173 
SM_OPS_IS_ACTIVE
: 
s
 = "A˘ive"; 
xdú
 = 0; ;

174 
SM_OPS_IS_MONO
: 
s
 = "Mono"; ;

175 
SM_OPS_IS_CHANNEL
: 
s
 = "Ch™√l"; 
xvÆ
 = 1; ;

176 
SM_OPS_IS_ENUMERATED
: 
s
 = "Enumî©ed"; 
xdú
 = 
vÆ
 == 1; ;

177 
SM_OPS_IS_ENUMCNT
: 
s
 = "EnumCnt"; ;

181 
	`°rˇt
(
f˙
, 
s
);

183 
obj1
 = 
	`PyTu∂e_New
(
xdú
 + 
xvÆ
);

184 i‡(
xdú
) {

185 
	`PyTu∂e_SET_ITEM
(
obj1
, 0, 
	`PyI¡_FromL⁄g
(
dú
));

186 i‡(
xvÆ
)

187 
	`PyTu∂e_SET_ITEM
(
obj1
, 1, 
	`PyI¡_FromL⁄g
(
vÆ
));

189 
ªs
 = 
	`pˇŒ
(
pymñem
, 
f˙
, 
obj1
, 
NULL
);

190  
ªs
 < 0 ? 0 :Ñes;

191 
	}
}

193 
	$gë_x_ønge_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

194 *
mö
, *
max
, c⁄° *
©å
)

196 
PyObje˘
 *
obj1
, *
t1
, *
t2
, *
ªs
;

197 
pymñem
 *pymñem = 
	`mñem_to_pymñem
(
ñem
);

198 
îr
;

200 
obj1
 = 
	`PyTu∂e_New
(1);

201 
	`PyTu∂e_SET_ITEM
(
obj1
, 0, 
	`PyI¡_FromL⁄g
(
dú
));

202 
îr
 = 
	`pˇŒ
(
pymñem
, 
©å
, 
obj1
, &
ªs
);

203 i‡(
îr
 >= 0) {

204 
t1
 = 
	`PyTu∂e_GëIãm
(
ªs
, 1);

205 
t2
 = 
	`PyTu∂e_GëIãm
(
ªs
, 2);

206 i‡(
	`PyL⁄g_Check
(
t1
Ë&& PyL⁄g_Check(
t2
)) {

207 *
mö
 = 
	`PyL⁄g_AsL⁄g
(
	`PyTu∂e_GëIãm
(
ªs
, 1));

208 *
max
 = 
	`PyL⁄g_AsL⁄g
(
	`PyTu∂e_GëIãm
(
ªs
, 2));

209 
îr
 = 0;

210 #i‡
PY_MAJOR_VERSION
 < 3

211 } i‡(
	`PyI¡_Check
(
t1
Ë&& PyI¡_Check(
t2
)) {

212 *
mö
 = 
	`PyI¡_AsL⁄g
(
	`PyTu∂e_GëIãm
(
ªs
, 1));

213 *
max
 = 
	`PyI¡_AsL⁄g
(
	`PyTu∂e_GëIãm
(
ªs
, 2));

214 
îr
 = 0;

217 
	`PyEº_F‹m©
(
PyExc_Ty≥Eº‹
, "wrongÑesult (invalidÅuple)");

218 
	`PyEº_Pröt
();

219 
	`PyEº_CÀ¨
();

220 
îr
 = -
EIO
;

223 
	`Py_XDECREF
(
ªs
);

224  
îr
;

225 
	}
}

227 
	$gë_ønge_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

228 *
mö
, *
max
)

230  
	`gë_x_ønge_›s
(
ñem
, 
dú
, 
mö
, 
max
, "opsGetRange");

231 
	}
}

233 
	$£t_ønge_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

234 
mö
, 
max
)

236 
PyObje˘
 *
obj1
;

237 
pymñem
 *pymñem = 
	`mñem_to_pymñem
(
ñem
);

239 
obj1
 = 
	`PyTu∂e_New
(3);

240 
	`PyTu∂e_SET_ITEM
(
obj1
, 0, 
	`PyI¡_FromL⁄g
(
dú
));

241 
	`PyTu∂e_SET_ITEM
(
obj1
, 1, 
	`PyI¡_FromL⁄g
(
mö
));

242 
	`PyTu∂e_SET_ITEM
(
obj1
, 2, 
	`PyI¡_FromL⁄g
(
max
));

243  
	`pˇŒ
(
pymñem
, "›sGëR™ge", 
obj1
, 
NULL
);

244 
	}
}

246 
	$gë_x_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

247 
ch™√l
, *
vÆue
,

248 c⁄° *
©å
)

250 
PyObje˘
 *
obj1
, *
t1
, *
ªs
;

251 
pymñem
 *pymñem = 
	`mñem_to_pymñem
(
ñem
);

252 
îr
;

254 
obj1
 = 
	`PyTu∂e_New
(2);

255 
	`PyTu∂e_SET_ITEM
(
obj1
, 0, 
	`PyI¡_FromL⁄g
(
dú
));

256 
	`PyTu∂e_SET_ITEM
(
obj1
, 1, 
	`PyI¡_FromL⁄g
(
ch™√l
));

257 
îr
 = 
	`pˇŒ
(
pymñem
, 
©å
, 
obj1
, &
ªs
);

258 i‡(
îr
 >= 0) {

259 
t1
 = 
	`PyTu∂e_GëIãm
(
ªs
, 1);

260 i‡(
	`PyL⁄g_Check
(
t1
)) {

261 *
vÆue
 = 
	`PyL⁄g_AsL⁄g
(
t1
);

262 
îr
 = 0;

263 #i‡
PY_MAJOR_VERSION
 < 3

264 } i‡(
	`PyI¡_Check
(
t1
)) {

265 *
vÆue
 = 
	`PyI¡_AsL⁄g
(
t1
);

266 
îr
 = 0;

269 
	`PyEº_F‹m©
(
PyExc_Ty≥Eº‹
, "wrongÑesult (invalidÅuple)");

270 
	`PyEº_Pröt
();

271 
	`PyEº_CÀ¨
();

272 
îr
 = -
EIO
;

275 
	`Py_XDECREF
(
ªs
);

276  
îr
;

277 
	}
}

279 
	$gë_vﬁume_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

280 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
)

282  
	`gë_x_›s
(
ñem
, 
dú
, 
ch™√l
, 
vÆue
, "opsGetVolume");

283 
	}
}

285 
	$gë_swôch_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

286 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
)

288 
vÆue1
;

289 
ªs
;

290 
ªs
 = 
	`gë_x_›s
(
ñem
, 
dú
, 
ch™√l
, &
vÆue1
, "opsGetSwitch");

291 *
vÆue
 = 
vÆue1
;

292  
ªs
;

293 
	}
}

295 
	$ask_vﬁ_dB_›s
(
¢d_mixî_ñem_t
 *
ñem
,

296 
dú
,

297 
vÆue
,

298 *
dbVÆue
)

300  
	`gë_x_›s
(
ñem
, 
dú
, 
vÆue
, 
dbVÆue
, "opsGetVolDB");

301 
	}
}

303 
	$ask_dB_vﬁ_›s
(
¢d_mixî_ñem_t
 *
ñem
,

304 
dú
,

305 
vÆue
,

306 *
dbVÆue
,

307 
xdú
)

309 
PyObje˘
 *
obj1
, *
t1
, *
ªs
;

310 
pymñem
 *pymñem = 
	`mñem_to_pymñem
(
ñem
);

311 
îr
;

313 
obj1
 = 
	`PyTu∂e_New
(3);

314 
	`PyTu∂e_SET_ITEM
(
obj1
, 0, 
	`PyI¡_FromL⁄g
(
dú
));

315 
	`PyTu∂e_SET_ITEM
(
obj1
, 1, 
	`PyI¡_FromL⁄g
(
vÆue
));

316 
	`PyTu∂e_SET_ITEM
(
obj1
, 2, 
	`PyI¡_FromL⁄g
(
xdú
));

317 
îr
 = 
	`pˇŒ
(
pymñem
, "›sGëDBVﬁ", 
obj1
, &
ªs
);

318 i‡(
îr
 >= 0) {

319 
t1
 = 
	`PyTu∂e_GëIãm
(
ªs
, 1);

320 i‡(
	`PyL⁄g_Check
(
t1
)) {

321 *
dbVÆue
 = 
	`PyL⁄g_AsL⁄g
(
t1
);

322 
îr
 = 0;

323 #i‡
PY_MAJOR_VERSION
 < 3

324 } i‡(
	`PyI¡_Check
(
t1
)) {

325 *
dbVÆue
 = 
	`PyI¡_AsL⁄g
(
t1
);

326 
îr
 = 0;

329 
	`PyEº_F‹m©
(
PyExc_Ty≥Eº‹
, "wrongÑesult (invalidÅuple)");

330 
	`PyEº_Pröt
();

331 
	`PyEº_CÀ¨
();

332 
îr
 = -
EIO
;

335 
	`Py_XDECREF
(
ªs
);

336  
îr
;

337 
	}
}

339 
	$gë_dB_›s
(
¢d_mixî_ñem_t
 *
ñem
,

340 
dú
,

341 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
,

342 *
vÆue
)

344  
	`gë_x_›s
(
ñem
, 
dú
, 
ch™√l
, 
vÆue
, "opsGetDB");

345 
	}
}

347 
	$gë_dB_ønge_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

348 *
mö
, *
max
)

350  
	`gë_x_ønge_›s
(
ñem
, 
dú
, 
mö
, 
max
, "opsGetDBRange");

351 
	}
}

353 
	$£t_vﬁume_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

354 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
)

356 
PyObje˘
 *
obj1
;

357 
pymñem
 *pymñem = 
	`mñem_to_pymñem
(
ñem
);

359 
obj1
 = 
	`PyTu∂e_New
(3);

360 
	`PyTu∂e_SET_ITEM
(
obj1
, 0, 
	`PyI¡_FromL⁄g
(
dú
));

361 
	`PyTu∂e_SET_ITEM
(
obj1
, 1, 
	`PyI¡_FromL⁄g
(
ch™√l
));

362 
	`PyTu∂e_SET_ITEM
(
obj1
, 2, 
	`PyI¡_FromL⁄g
(
vÆue
));

363  
	`pˇŒ
(
pymñem
, "›sSëVﬁume", 
obj1
, 
NULL
);

364 
	}
}

366 
	$£t_swôch_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

367 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
)

369 
PyObje˘
 *
obj1
;

370 
pymñem
 *pymñem = 
	`mñem_to_pymñem
(
ñem
);

372 
obj1
 = 
	`PyTu∂e_New
(3);

373 
	`PyTu∂e_SET_ITEM
(
obj1
, 0, 
	`PyI¡_FromL⁄g
(
dú
));

374 
	`PyTu∂e_SET_ITEM
(
obj1
, 1, 
	`PyI¡_FromL⁄g
(
ch™√l
));

375 
	`PyTu∂e_SET_ITEM
(
obj1
, 2, 
	`PyI¡_FromL⁄g
(
vÆue
));

376  
	`pˇŒ
(
pymñem
, "›sSëSwôch", 
obj1
, 
NULL
);

377 
	}
}

379 
	$£t_dB_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

380 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
,

381 
db_gaö
, 
xdú
)

383 
PyObje˘
 *
obj1
;

384 
pymñem
 *pymñem = 
	`mñem_to_pymñem
(
ñem
);

386 
obj1
 = 
	`PyTu∂e_New
(4);

387 
	`PyTu∂e_SET_ITEM
(
obj1
, 0, 
	`PyI¡_FromL⁄g
(
dú
));

388 
	`PyTu∂e_SET_ITEM
(
obj1
, 1, 
	`PyI¡_FromL⁄g
(
ch™√l
));

389 
	`PyTu∂e_SET_ITEM
(
obj1
, 2, 
	`PyI¡_FromL⁄g
(
db_gaö
));

390 
	`PyTu∂e_SET_ITEM
(
obj1
, 3, 
	`PyI¡_FromL⁄g
(
xdú
));

391  
	`pˇŒ
(
pymñem
, "›sSëDB", 
obj1
, 
NULL
);

392 
	}
}

394 
	$íum_ôem_«me_›s
(
¢d_mixî_ñem_t
 *
ñem
,

395 
ôem
,

396 
size_t
 
maxÀn
, *
buf
)

398 
PyObje˘
 *
obj1
, *
obj2
, *
t1
, *
ªs
;

399 
pymñem
 *pymñem = 
	`mñem_to_pymñem
(
ñem
);

400 
îr
;

401 
Àn
;

402 *
s
;

404 
obj1
 = 
	`PyTu∂e_New
(1);

405 
	`PyTu∂e_SET_ITEM
(
obj1
, 0, 
	`PyI¡_FromL⁄g
(
ôem
));

406 
îr
 = 
	`pˇŒ
(
pymñem
, "›sGëEnumIãmName", 
obj1
, &
ªs
);

407 i‡(
îr
 >= 0) {

408 
t1
 = 
	`PyTu∂e_GëIãm
(
ªs
, 1);

409 i‡(
	`PyUnicode_Check
(
t1
)) {

410 
obj2
 = 
	`PyUnicode_AsEncodedSåög
(
t1
, "utf-8", "strict");

411 i‡(
obj2
) {

412 
s
 = 
	`PyByãs_AsSåög
(
obj2
);

413 
Àn
 = 
	`°æí
(
s
);

414 i‡(
maxÀn
 - 1 > 
Àn
)

415 
Àn
 = 
maxÀn
 - 1;

416 
	`mem˝y
(
buf
, 
s
, 
Àn
);

417 
buf
[
Àn
] = '\0';

418 
	`Py_DECREF
(
obj2
);

420 
îæbl
;

422 #i‡
PY_MAJOR_VERSION
 < 3

423 } i‡(
	`PySåög_Check
(
t1
)) {

424 
s
 = 
	`PySåög_AsSåög
(
t1
);

425 
Àn
 = 
	`°æí
(
s
);

426 i‡(
maxÀn
 - 1 > 
Àn
)

427 
Àn
 = 
maxÀn
 - 1;

428 
	`mem˝y
(
buf
, 
s
, 
Àn
);

429 
buf
[
Àn
] = '\0';

432 
îæbl
:

433 
	`PyEº_F‹m©
(
PyExc_Ty≥Eº‹
, "wrongÑesult (invalidÅuple)");

434 
	`PyEº_Pröt
();

435 
	`PyEº_CÀ¨
();

436 
îr
 = -
EIO
;

439 
	`Py_XDECREF
(
ªs
);

440  
îr
;

441 
	}
}

443 
	$gë_íum_ôem_›s
(
¢d_mixî_ñem_t
 *
ñem
,

444 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
,

445 *
ôemp
)

447 
PyObje˘
 *
obj1
, *
t1
, *
ªs
;

448 
pymñem
 *pymñem = 
	`mñem_to_pymñem
(
ñem
);

449 
îr
;

451 
obj1
 = 
	`PyTu∂e_New
(1);

452 
	`PyTu∂e_SET_ITEM
(
obj1
, 0, 
	`PyI¡_FromL⁄g
(
ch™√l
));

453 
îr
 = 
	`pˇŒ
(
pymñem
, "›sGëEnumIãm", 
obj1
, &
ªs
);

454 i‡(
îr
 >= 0) {

455 
t1
 = 
	`PyTu∂e_GëIãm
(
ªs
, 1);

456 i‡(
	`PyL⁄g_Check
(
t1
)) {

457 *
ôemp
 = 
	`PyL⁄g_AsL⁄g
(
t1
);

458 
îr
 = 0;

459 #i‡
PY_MAJOR_VERSION
 < 3

460 } i‡(
	`PyI¡_Check
(
t1
)) {

461 *
ôemp
 = 
	`PyI¡_AsL⁄g
(
t1
);

462 
îr
 = 0;

465 
	`PyEº_F‹m©
(
PyExc_Ty≥Eº‹
, "wrongÑesult (invalidÅuple)");

466 
	`PyEº_Pröt
();

467 
	`PyEº_CÀ¨
();

468 
îr
 = -
EIO
;

471 
	`Py_XDECREF
(
ªs
);

472  
îr
;

473 
	}
}

475 
	$£t_íum_ôem_›s
(
¢d_mixî_ñem_t
 *
ñem
,

476 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
,

477 
ôem
)

479 
PyObje˘
 *
obj1
;

480 
pymñem
 *pymñem = 
	`mñem_to_pymñem
(
ñem
);

482 
obj1
 = 
	`PyTu∂e_New
(2);

483 
	`PyTu∂e_SET_ITEM
(
obj1
, 0, 
	`PyI¡_FromL⁄g
(
ch™√l
));

484 
	`PyTu∂e_SET_ITEM
(
obj1
, 1, 
	`PyI¡_FromL⁄g
(
ôem
));

485  
	`pˇŒ
(
pymñem
, "›sSëEnumIãm", 
obj1
, 
NULL
);

486 
	}
}

488 
sm_ñem_›s
 
	gsim∂e_pyth⁄_›s
 = {

489 .
is
 = 
is_›s
,

490 .
	ggë_ønge
 = 
gë_ønge_›s
,

491 .
	ggë_dB_ønge
 = 
gë_dB_ønge_›s
,

492 .
	g£t_ønge
 = 
£t_ønge_›s
,

493 .
	gask_vﬁ_dB
 = 
ask_vﬁ_dB_›s
,

494 .
	gask_dB_vﬁ
 = 
ask_dB_vﬁ_›s
,

495 .
	ggë_vﬁume
 = 
gë_vﬁume_›s
,

496 .
	ggë_dB
 = 
gë_dB_›s
,

497 .
	g£t_vﬁume
 = 
£t_vﬁume_›s
,

498 .
	g£t_dB
 = 
£t_dB_›s
,

499 .
	ggë_swôch
 = 
gë_swôch_›s
,

500 .
	g£t_swôch
 = 
£t_swôch_›s
,

501 .
	gíum_ôem_«me
 = 
íum_ôem_«me_›s
,

502 .
	ggë_íum_ôem
 = 
gë_íum_ôem_›s
,

503 .
	g£t_íum_ôem
 = 
£t_íum_ôem_›s


506 
	$£Àm_‰ì
(
¢d_mixî_ñem_t
 *
ñem
)

508 
sm_£Àm_t
 *
sim∂e
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

510 i‡(
sim∂e
->
id
) {

511 
	`¢d_mixî_£Àm_id_‰ì
(
sim∂e
->
id
);

512 
sim∂e
->
id
 = 
NULL
;

514 
	}
}

516 
PyObje˘
 *

517 
	$pymñem_ˇp
(
pymñem
 *pymñem 
ATTRIBUTE_UNUSED
, *
¥iv
)

519  
	`PyI¡_FromL⁄g
(()
¥iv
);

520 
	}
}

522 
PyObje˘
 *

523 
	$pymñem_gë_ˇps
(
pymñem
 *pymñem, *
¥iv
 
ATTRIBUTE_UNUSED
)

525  
	`PyI¡_FromL⁄g
(
pymñem
->
£Àm
.
ˇps
);

526 
	}
}

528 
PyObje˘
 *

529 
	$pymñem_gë_«me
(
pymñem
 *pymñem, *
¥iv
 
ATTRIBUTE_UNUSED
)

531  
	`PyUnicode_FromSåög
(
	`¢d_mixî_£Àm_id_gë_«me
(
pymñem
->
£Àm
.
id
));

532 
	}
}

534 
PyObje˘
 *

535 
	$pymñem_gë_ödex
(
pymñem
 *pymñem, *
¥iv
 
ATTRIBUTE_UNUSED
)

537  
	`PyI¡_FromL⁄g
(
	`¢d_mixî_£Àm_id_gë_ödex
(
pymñem
->
£Àm
.
id
));

538 
	}
}

541 
	$pymñem_£t_ˇps
(
pymñem
 *pymñem, 
PyObje˘
 *
vÆ
, *
¥iv
 
ATTRIBUTE_UNUSED
)

543 i‡(
	`PyL⁄g_Check
(
vÆ
)) {

544 
pymñem
->
£Àm
.
ˇps
 = 
	`PyL⁄g_AsL⁄g
(
vÆ
);

547 #i‡
PY_MAJOR_VERSION
 < 3

548 i‡(
	`PyI¡_Check
(
vÆ
)) {

549 
pymñem
->
£Àm
.
ˇps
 = 
	`PyI¡_AsL⁄g
(
vÆ
);

553 
	`PyEº_SëSåög
(
PyExc_Ty≥Eº‹
, "TheÜastáttribute value must beán integer");

555 
	}
}

557 
PyObje˘
 *

558 
	$pymñem_ign‹e
(
pymñem
 *pymñem 
ATTRIBUTE_UNUSED
, 
PyObje˘
 *
¨gs
 ATTRIBUTE_UNUSED)

560 
Py_RETURN_NONE
;

561 
	}
}

563 
PyObje˘
 *

564 
	$pymñem_ign‹e1
(
pymñem
 *pymñem 
ATTRIBUTE_UNUSED
, 
PyObje˘
 *
¨gs
 ATTRIBUTE_UNUSED)

566 
Py_RETURN_TRUE
;

567 
	}
}

569 
PyObje˘
 *

570 
	$pymñem_îr‹
(
pymñem
 *pymñem 
ATTRIBUTE_UNUSED
, 
PyObje˘
 *
¨gs
 ATTRIBUTE_UNUSED)

572  
	`PyI¡_FromL⁄g
(-
EIO
);

573 
	}
}

575 
PyObje˘
 *

576 
	$pymñem_©èch
(
pymñem
 *pymñem, 
PyObje˘
 *
¨gs
)

578 
PyObje˘
 *
obj
;

579 
¢d_h˘l_ñem_t
 *
hñem
;

580 
îr
;

582 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "O", &
obj
))

583  
NULL
;

584 
hñem
 = (
¢d_h˘l_ñem_t
 *)
	`gë_C_±r
(
obj
, "get_C_helem");

585 i‡(
hñem
 =
NULL
)

586  
NULL
;

587 
îr
 = 
	`¢d_mixî_ñem_©èch
(
pymñem
->
mñem
, 
hñem
);

588 i‡(
îr
 < 0) {

589 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "C™nŸáâach hc⁄åﬁÉÀmíàtÿmixîÉÀmít: %s", 
	`¢d_°ªº‹
(
îr
));

590  
NULL
;

592 
Py_RETURN_NONE
;

593 
	}
}

595 
PyObje˘
 *

596 
	$pymñem_dëach
(
pymñem
 *pymñem, 
PyObje˘
 *
¨gs
)

598 
PyObje˘
 *
obj
;

599 
¢d_h˘l_ñem_t
 *
hñem
;

600 
îr
;

602 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "O", &
obj
))

603  
NULL
;

604 
hñem
 = (
¢d_h˘l_ñem_t
 *)
	`gë_C_±r
(
obj
, "get_C_helem");

605 i‡(
hñem
 =
NULL
)

606  
NULL
;

607 
îr
 = 
	`¢d_mixî_ñem_dëach
(
pymñem
->
mñem
, 
hñem
);

608 i‡(
îr
 < 0) {

609 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "C™nŸ dëach hc⁄åﬁÉÀmíàtÿmixîÉÀmít: %s", 
	`¢d_°ªº‹
(
îr
));

610  
NULL
;

612 
Py_RETURN_NONE
;

613 
	}
}

615 
PyObje˘
 *

616 
	$pymñem_evít_öfo
(
pymñem
 *pymñem, 
PyObje˘
 *
¨gs
)

618 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, ""))

619  
NULL
;

620  
	`PyI¡_FromL⁄g
(
	`¢d_mixî_ñem_öfo
(
pymñem
->
mñem
));

621 
	}
}

623 
PyObje˘
 *

624 
	$pymñem_evít_vÆue
(
pymñem
 *pymñem, 
PyObje˘
 *
¨gs
)

626 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, ""))

627  
NULL
;

628  
	`PyI¡_FromL⁄g
(
	`¢d_mixî_ñem_vÆue
(
pymñem
->
mñem
));

629 
	}
}

632 
	$pymñem_öô
(
pymñem
 *pymñem, 
PyObje˘
 *
¨gs
, PyObje˘ *
kwds
 
ATTRIBUTE_UNUSED
)

634 *
«me
;

635 
ödex
, 
weight
;

636 
¢d_mixî_£Àm_id_t
 *
id
;

637 
îr
;

639 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "Osii", &
pymñem
->
py_mixî
, &
«me
, &
ödex
, &
weight
))

641 
	`mem£t
(&
pymñem
->
£Àm
, 0, (pymelem->selem));

642 i‡(
	`¢d_mixî_£Àm_id_mÆloc
(&
id
))

644 
	`¢d_mixî_£Àm_id_£t_«me
(
id
, 
«me
);

645 
	`¢d_mixî_£Àm_id_£t_ödex
(
id
, 
ödex
);

646 
pymñem
->
£Àm
.
id
 = id;

647 
pymñem
->
£Àm
.
›s
 = &
sim∂e_pyth⁄_›s
;

648 
îr
 = 
	`¢d_mixî_ñem_√w
(&
pymñem
->
mñem
, 
SND_MIXER_ELEM_SIMPLE
,

649 
weight
, &
pymñem
->
£Àm
, 
£Àm_‰ì
);

650 i‡(
îr
 < 0) {

651 
	`¢d_mixî_£Àm_id_‰ì
(
id
);

655 
	}
}

658 
	$pymñem_dóŒoc
(
pymñem
 *
£lf
)

660 
	`£Àm_‰ì
(
£lf
->
mñem
);

661 
	}
}

663 
PyGëSëDef
 
	gpymñem_gë£ãrs
[] = {

664 {"CAP_GVOLUME", (
gëãr
)
pymñem_ˇp
, 
NULL
, NULL, (*)
SM_CAP_GVOLUME
},

665 {"CAP_GSWITCH", (
gëãr
)
pymñem_ˇp
, 
NULL
, NULL, (*)
SM_CAP_GSWITCH
},

666 {"CAP_PVOLUME", (
gëãr
)
pymñem_ˇp
, 
NULL
, NULL, (*)
SM_CAP_PVOLUME
},

667 {"CAP_PVOLUME_JOIN", (
gëãr
)
pymñem_ˇp
, 
NULL
, NULL, (*)
SM_CAP_PVOLUME_JOIN
},

668 {"CAP_PSWITCH", (
gëãr
)
pymñem_ˇp
, 
NULL
, NULL, (*)
SM_CAP_PSWITCH
},

669 {"CAP_PSWITCH_JOIN", (
gëãr
)
pymñem_ˇp
, 
NULL
, NULL, (*)
SM_CAP_PSWITCH_JOIN
},

670 {"CAP_CVOLUME", (
gëãr
)
pymñem_ˇp
, 
NULL
, NULL, (*)
SM_CAP_CVOLUME
},

671 {"CAP_CVOLUME_JOIN", (
gëãr
)
pymñem_ˇp
, 
NULL
, NULL, (*)
SM_CAP_CVOLUME_JOIN
},

672 {"CAP_CSWITCH", (
gëãr
)
pymñem_ˇp
, 
NULL
, NULL, (*)
SM_CAP_CSWITCH
},

673 {"CAP_CSWITCH_JOIN", (
gëãr
)
pymñem_ˇp
, 
NULL
, NULL, (*)
SM_CAP_CSWITCH_JOIN
},

674 {"CAP_CSWITCH_EXCL", (
gëãr
)
pymñem_ˇp
, 
NULL
, NULL, (*)
SM_CAP_CSWITCH_EXCL
},

675 {"CAP_PENUM", (
gëãr
)
pymñem_ˇp
, 
NULL
, NULL, (*)
SM_CAP_PENUM
},

676 {"CAP_CENUM", (
gëãr
)
pymñem_ˇp
, 
NULL
, NULL, (*)
SM_CAP_CENUM
},

678 {"ˇps", (
gëãr
)
pymñem_gë_ˇps
, (
£âî
)
pymñem_£t_ˇps
, 
NULL
, NULL},

680 {"«me", (
gëãr
)
pymñem_gë_«me
, 
NULL
, NULL, NULL},

681 {"ödex", (
gëãr
)
pymñem_gë_ödex
, 
NULL
, NULL, NULL},

683 {
NULL
,NULL,NULL,NULL,NULL}

686 
PyMëhodDef
 
	gpymñem_mëhods
[] = {

687 {"©èch", (
PyCFun˘i⁄
)
pymñem_©èch
, 
METH_VARARGS
, 
NULL
},

688 {"dëach", (
PyCFun˘i⁄
)
pymñem_dëach
, 
METH_VARARGS
, 
NULL
},

691 {"›sIsA˘ive", (
PyCFun˘i⁄
)
pymñem_ign‹e1
, 
METH_VARARGS
, 
NULL
},

692 {"›sIsM⁄o", (
PyCFun˘i⁄
)
pymñem_ign‹e
, 
METH_VARARGS
, 
NULL
},

693 {"›sIsCh™√l", (
PyCFun˘i⁄
)
pymñem_ign‹e
, 
METH_VARARGS
, 
NULL
},

694 {"›sIsEnumî©ed", (
PyCFun˘i⁄
)
pymñem_ign‹e
, 
METH_VARARGS
, 
NULL
},

695 {"›sIsEnumC¡", (
PyCFun˘i⁄
)
pymñem_ign‹e
, 
METH_VARARGS
, 
NULL
},

697 {"›sGëDB", (
PyCFun˘i⁄
)
pymñem_îr‹
, 
METH_VARARGS
, 
NULL
},

699 {"evítInfo", (
PyCFun˘i⁄
)
pymñem_evít_öfo
, 
METH_VARARGS
, 
NULL
},

700 {"evítVÆue", (
PyCFun˘i⁄
)
pymñem_evít_vÆue
, 
METH_VARARGS
, 
NULL
},

702 {
NULL
,NULL,0,NULL}

705 
PyTy≥Obje˘
 
	gpymñem_ty≥
 = {

706 
PyV¨Obje˘_HEAD_INIT
(
NULL
, 0)

707 
ç_«me
: "smixer_python.InternalMElement",

708 
ç_basicsize
: (
pymñem
),

709 
ç_dóŒoc
: (
de°ru˘‹
)
pymñem_dóŒoc
,

710 
ç_Êags
: 
Py_TPFLAGS_DEFAULT
 | 
Py_TPFLAGS_BASETYPE
,

711 
ç_doc
: 
NULL
 ,

712 
ç_gë£t
: 
pymñem_gë£ãrs
,

713 
ç_öô
: (
öô¥oc
)
pymñem_öô
,

714 
ç_Æloc
: 
PyTy≥_GíîicAŒoc
,

715 
ç_√w
: 
PyTy≥_GíîicNew
,

716 
ç_‰ì
: 
PyObje˘_Dñ
,

717 
ç_mëhods
: 
pymñem_mëhods
,

720 
PyObje˘
 *

721 
	$pymixî_©èch_h˘l
(
pymixî
 *pymixî, 
PyObje˘
 *
¨gs
)

723 
PyObje˘
 *
obj
;

724 
¢d_h˘l_t
 *
h˘l
;

725 **
h˘ls
;

726 
îr
;

728 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "O", &
obj
))

729  
NULL
;

730 
h˘l
 = (
¢d_h˘l_t
 *)
	`gë_C_±r
(
obj
, "get_C_hctl");

731 i‡(
h˘l
 =
NULL
)

732  
NULL
;

733 
îr
 = 
	`¢d_mixî_©èch_h˘l
(
pymixî
->
mixî
, 
h˘l
);

734 i‡(
îr
 < 0) {

735 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "C™nŸáâach h˘l: %s", 
	`¢d_°ªº‹
(
îr
));

736  
NULL
;

738 
h˘ls
 = 
	`ªÆloc
(
pymixî
->
h˘l
, (*Ë* (pymixî->
h˘l_cou¡
+1) * 2);

739 i‡(
h˘ls
 =
NULL
) {

740 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
, "NoÉnough memory");

741  
NULL
;

743 
pymixî
->
h˘l
 = 
h˘ls
;

744 
pymixî
->
h˘l
[pymixî->
h˘l_cou¡
*2] = (*)hctl;

745 
pymixî
->
h˘l
[pymixî->
h˘l_cou¡
*2+1] = (*)
obj
;

746 
pymixî
->
h˘l_cou¡
++;

747 
	`Py_INCREF
(
obj
);

748 
Py_RETURN_NONE
;

749 
	}
}

751 
PyObje˘
 *

752 
	$pymixî_ªgi°î
(
pymixî
 *pymixî, 
PyObje˘
 *
¨gs
)

754 
îr
;

756 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, ""))

757  
NULL
;

758 
îr
 = 
	`¢d_mixî_˛ass_ªgi°î
(
pymixî
->
˛ass
,Öymixî->
mixî
);

759 i‡(
îr
 < 0) {

760 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "C™nŸÑegi°î mixî: %s", 
	`¢d_°ªº‹
(
îr
));

761  
NULL
;

763 
Py_RETURN_NONE
;

764 
	}
}

766 
PyObje˘
 *

767 
	$pymixî_mñemít_√w
(
pymixî
 *pymixî, 
PyObje˘
 *
¨gs
)

769 
PyObje˘
 *
obj
, *
obj1
, *
obj2
;

770 *
˛ass
, *
«me
;

771 
ödex
, 
weight
;

773 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "ssii", &
˛ass
, &
«me
, &
ödex
, &
weight
))

774  
NULL
;

775 
obj
 = 
	`PyDi˘_GëIãmSåög
(
pymixî
->
mdi˘
, 
˛ass
);

776 i‡(
obj
) {

777 
obj1
 = 
	`PyTu∂e_New
(4);

778 
	`PyTu∂e_SET_ITEM
(
obj1
, 0, (
PyObje˘
 *)
pymixî
);

779 
	`Py_INCREF
((
PyObje˘
 *)
pymixî
);

780 
	`PyTu∂e_SET_ITEM
(
obj1
, 1, 
	`PyUnicode_FromSåög
(
«me
));

781 
	`PyTu∂e_SET_ITEM
(
obj1
, 2, 
	`PyI¡_FromL⁄g
(
ödex
));

782 
	`PyTu∂e_SET_ITEM
(
obj1
, 3, 
	`PyI¡_FromL⁄g
(
weight
));

783 
obj2
 = 
	`PyObje˘_CÆlObje˘
(
obj
, 
obj1
);

784 
	`Py_XDECREF
(
obj1
);

785 i‡(
obj2
) {

786 
pymñem
 *pymñem = (pymñem *)
obj2
;

787 **
mñems
 = 
	`ªÆloc
(
pymixî
->
mñem
, (*Ë* (pymixî->
mñem_cou¡
 + 1) * 2);

788 i‡(
mñems
 =
NULL
) {

789 
	`Py_DECREF
(
obj2
);

790  
NULL
;

792 
mñems
[
pymixî
->
mñem_cou¡
*2] = 
pymñem
->
mñem
;

793 
mñems
[
pymixî
->
mñem_cou¡
*2+1] = 
obj2
;

794 
	`Py_INCREF
(
obj2
);

795 
pymixî
->
mñem
 = 
mñems
;

796 
pymixî
->
mñem_cou¡
++;

799 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "C™nŸ föd cœs†'%s'", 
˛ass
);

800  
NULL
;

802  
obj2
;

803 
	}
}

805 
PyObje˘
 *

806 
	$pymixî_mñemít_add
(
pymixî
 *pymixî, 
PyObje˘
 *
¨gs
)

808 
PyObje˘
 *
obj
;

809 
pymñem
 *pymelem;

810 
îr
;

812 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "O", &
obj
))

813  
NULL
;

814 
pymñem
 = (pymñem *)
obj
;

815 
îr
 = 
	`¢d_mixî_ñem_add
(
pymñem
->
mñem
, 
pymixî
->
˛ass
);

816 i‡(
îr
 < 0) {

817 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "C™nŸádd mixîÉÀmít: %s", 
	`¢d_°ªº‹
(
îr
));

818  
NULL
;

820 
Py_RETURN_NONE
;

821 
	}
}

824 
	$pymixî_öô
(
pymixî
 *pymixî, 
PyObje˘
 *
¨gs
, PyObje˘ *
kwds
 
ATTRIBUTE_UNUSED
)

826 
˛ass
, 
mixî
;

828 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "iiO", &
˛ass
, &
mixî
, &
pymixî
->
mdi˘
))

830 
pymixî
->
˛ass
 = (
¢d_mixî_˛ass_t
 *)class;

831 
pymixî
->
mixî
 = (
¢d_mixî_t
 *)mixer;

832 
pymixî
->
h˘l_cou¡
 = 0;

833 
pymixî
->
h˘l
 = 
NULL
;

834 
pymixî
->
hñem_cou¡
 = 0;

835 
pymixî
->
hñem
 = 
NULL
;

836 
pymixî
->
mñem_cou¡
 = 0;

837 
pymixî
->
mñem
 = 
NULL
;

839 
	}
}

842 
	$pymixî_‰ì
(
pymixî
 *
£lf
)

844 
idx
;

846 
idx
 = 0; idx < 
£lf
->
h˘l_cou¡
; idx++) {

847 
	`¢d_mixî_dëach_h˘l
(
£lf
->
mixî
, sñf->
h˘l
[
idx
*2]);

848 
	`Py_DECREF
((
PyObje˘
 *)
£lf
->
h˘l
[
idx
*2+1]);

850 i‡(
£lf
->
h˘l
)

851 
	`‰ì
(
£lf
->
h˘l
);

852 
£lf
->
h˘l_cou¡
 = 0;

853 
£lf
->
h˘l
 = 
NULL
;

854 
idx
 = 0; idx < 
£lf
->
hñem_cou¡
; idx++)

855 
	`Py_DECREF
((
PyObje˘
 *)
£lf
->
hñem
[
idx
*2+1]);

856 i‡(
£lf
->
hñem
)

857 
	`‰ì
(
£lf
->
hñem
);

858 
£lf
->
hñem_cou¡
 = 0;

859 
£lf
->
hñem
 = 
NULL
;

860 
idx
 = 0; idx < 
£lf
->
mñem_cou¡
; idx++)

861 
	`Py_DECREF
((
PyObje˘
 *)
£lf
->
mñem
[
idx
*2+1]);

862 i‡(
£lf
->
mñem
)

863 
	`‰ì
(
£lf
->
mñem
);

864 
£lf
->
mñem_cou¡
 = 0;

865 
£lf
->
mñem
 = 
NULL
;

866 
	}
}

869 
	$pymixî_dóŒoc
(
pymixî
 *
£lf
)

871 
	`pymixî_‰ì
(
£lf
);

872 
	}
}

874 
PyGëSëDef
 
	gpymixî_gë£ãrs
[] = {

875 {
NULL
,NULL,NULL,NULL,NULL}

878 
PyMëhodDef
 
	gpymixî_mëhods
[] = {

879 {"©èchHCé", (
PyCFun˘i⁄
)
pymixî_©èch_h˘l
, 
METH_VARARGS
, 
NULL
},

880 {"ªgi°î", (
PyCFun˘i⁄
)
pymixî_ªgi°î
, 
METH_VARARGS
, 
NULL
},

881 {"√wMEÀmít", (
PyCFun˘i⁄
)
pymixî_mñemít_√w
, 
METH_VARARGS
, 
NULL
},

882 {"addMEÀmít", (
PyCFun˘i⁄
)
pymixî_mñemít_add
, 
METH_VARARGS
, 
NULL
},

883 {
NULL
,NULL,0,NULL}

886 
PyTy≥Obje˘
 
	gpymixî_ty≥
 = {

887 
PyV¨Obje˘_HEAD_INIT
(
NULL
, 0)

888 
ç_«me
: "smixer_python.InternalMixer",

889 
ç_basicsize
: (
pymixî
),

890 
ç_dóŒoc
: (
de°ru˘‹
)
pymixî_dóŒoc
,

891 
ç_Êags
: 
Py_TPFLAGS_DEFAULT
 | 
Py_TPFLAGS_BASETYPE
,

892 
ç_doc
: 
NULL
 ,

893 
ç_gë£t
: 
pymixî_gë£ãrs
,

894 
ç_öô
: (
öô¥oc
)
pymixî_öô
,

895 
ç_Æloc
: 
PyTy≥_GíîicAŒoc
,

896 
ç_√w
: 
PyTy≥_GíîicNew
,

897 
ç_‰ì
: 
PyObje˘_Dñ
,

898 
ç_mëhods
: 
pymixî_mëhods
,

901 
PyMëhodDef
 
	gpyth⁄_mëhods
[] = {

902 {
NULL
, NULL, 0, NULL}

905 
PyObje˘
 *
	$√w_hñem
(
pyth⁄_¥iv
 *
¥iv
, 
¢d_h˘l_ñem_t
 *
hñem
)

907 
PyObje˘
 *
obj
, *
py_h˘l
 = 
NULL
, *
obj1
, *
obj2
;

908 
¢d_h˘l_t
 *
h˘l
 = 
	`¢d_h˘l_ñem_gë_h˘l
(
hñem
);

909 
pymixî
 *pymixî = (pymixî *)
¥iv
->
py_mixî
;

910 
idx
;

912 
idx
 = 0; idx < 
pymixî
->
h˘l_cou¡
; idx++) {

913 i‡(
pymixî
->
h˘l
[
idx
] == hctl) {

914 
py_h˘l
 = 
pymixî
->
h˘l
[
idx
*2+1];

918 i‡(
py_h˘l
 =
NULL
)

919  
NULL
;

920 
obj
 = 
	`PyDi˘_GëIãmSåög
(
¥iv
->
py_mdi˘
, "HElement");

921 i‡(
obj
) {

922 
obj1
 = 
	`PyTu∂e_New
(3);

923 
	`PyTu∂e_SET_ITEM
(
obj1
, 0, 
py_h˘l
);

924 
	`Py_INCREF
(
py_h˘l
);

925 
	`PyTu∂e_SET_ITEM
(
obj1
, 1, 
	`PyFlﬂt_FromDoubÀ
(1));

926 
	`PyTu∂e_SET_ITEM
(
obj1
, 2, 
	`PyI¡_FromL⁄g
(()
hñem
));

927 
obj2
 = 
	`PyObje˘_CÆlObje˘
(
obj
, 
obj1
);

928 i‡(
obj2
 =
NULL
) {

929 
	`PyEº_Pröt
();

930 
	`PyEº_CÀ¨
();

932 
	`Py_XDECREF
(
obj1
);

934 
	`SNDERR
("UnableÅo create InternalMixer object");

935  
NULL
;

937 i‡(
obj2
) {

938 
pymixî
 *pymixî = (pymixî *)
¥iv
->
py_mixî
;

939 **
hñems
 = 
	`ªÆloc
(
pymixî
->
hñem
, (*Ë* (pymixî->
hñem_cou¡
 + 1) * 2);

940 i‡(
hñems
 =
NULL
) {

941 
	`Py_DECREF
(
obj2
);

942  
NULL
;

944 
hñems
[
pymixî
->
hñem_cou¡
*2] = 
hñem
;

945 
hñems
[
pymixî
->
hñem_cou¡
*2+1] = 
obj2
;

946 
	`Py_INCREF
(
obj2
);

947 
pymixî
->
hñem
 = 
hñems
;

948 
pymixî
->
hñem_cou¡
++;

950  
obj2
;

951 
	}
}

953 
PyObje˘
 *
	$föd_hñem
(
pyth⁄_¥iv
 *
¥iv
, 
¢d_h˘l_ñem_t
 *
hñem
)

955 
pymixî
 *pymixî = (pymixî *)
¥iv
->
py_mixî
;

956 
idx
;

958 
idx
 = 0; idx < 
pymixî
->
hñem_cou¡
; idx++) {

959 i‡(
pymixî
->
hñem
[
idx
*2] == helem)

960  (
PyObje˘
 *)
pymixî
->
hñem
[
idx
*2+1];

962  
NULL
;

963 
	}
}

965 
PyObje˘
 *
	$föd_mñem
(
pyth⁄_¥iv
 *
¥iv
, 
¢d_mixî_ñem_t
 *
mñem
)

967 
pymixî
 *pymixî = (pymixî *)
¥iv
->
py_mixî
;

968 
idx
;

970 
idx
 = 0; idx < 
pymixî
->
mñem_cou¡
; idx++) {

971 i‡(
pymixî
->
mñem
[
idx
*2] == melem)

972  (
PyObje˘
 *)
pymixî
->
mñem
[
idx
*2+1];

974  
NULL
;

975 
	}
}

977 
	$Æß_mixî_sim∂e_evít
(
¢d_mixî_˛ass_t
 *
˛ass
, 
mask
,

978 
¢d_h˘l_ñem_t
 *
hñem
, 
¢d_mixî_ñem_t
 *
mñem
)

980 
pyth⁄_¥iv
 *
¥iv
 = 
	`¢d_mixî_sbasic_gë_¥iv©e
(
˛ass
);

981 
PyThªadSèã
 *
t°©e
;

982 
PyObje˘
 *
t
, *
o
, *
r
;

983 
ªs
 = -
ENOMEM
;

985 
t°©e
 = 
	`PyThªadSèã_New
(
maö_öãΩªãr
);

986 
	`PyThªadSèã_Sw≠
(
t°©e
);

988 
t
 = 
	`PyTu∂e_New
(3);

989 i‡(
t
) {

990 
	`PyTu∂e_SET_ITEM
(
t
, 0, (
PyObje˘
 *)
	`PyI¡_FromL⁄g
(
mask
));

991 
o
 = 
	`föd_hñem
(
¥iv
, 
hñem
);

992 i‡(
mask
 & 
SND_CTL_EVENT_MASK_ADD
) {

993 i‡(
o
 =
NULL
)

994 
o
 = 
	`√w_hñem
(
¥iv
, 
hñem
);

996 i‡(
o
 =
NULL
)

998 
	`PyTu∂e_SET_ITEM
(
t
, 1, 
o
);

999 
	`Py_INCREF
(
o
);

1000 
o
 = 
mñem
 ? 
	`föd_mñem
(
¥iv
, mñemË: 
Py_N⁄e
;

1001 
	`PyTu∂e_SET_ITEM
(
t
, 2, 
o
);

1002 
	`Py_INCREF
(
o
);

1003 
r
 = 
	`PyObje˘_CÆlObje˘
(
¥iv
->
py_evít_func
, 
t
);

1004 
	`Py_DECREF
(
t
);

1005 i‡(
r
) {

1006 i‡(
	`PyL⁄g_Check
(
r
)) {

1007 
ªs
 = 
	`PyL⁄g_AsL⁄g
(
r
);

1008 #i‡
PY_MAJOR_VERSION
 < 3

1009 } i‡(
	`PyI¡_Check
(
r
)) {

1010 
ªs
 = 
	`PyI¡_AsL⁄g
(
r
);

1012 } i‡(
r
 =
Py_N⁄e
) {

1013 
ªs
 = 0;

1015 
	`Py_DECREF
(
r
);

1017 
	`PyEº_Pröt
();

1018 
	`PyEº_CÀ¨
();

1019 
ªs
 = -
EIO
;

1023  
ªs
;

1024 
	}
}

1026 
	$Æß_mixî_sim∂e_‰ì
(
¢d_mixî_˛ass_t
 *
˛ass
)

1028 
pyth⁄_¥iv
 *
¥iv
 = 
	`¢d_mixî_sbasic_gë_¥iv©e
(
˛ass
);

1030 i‡(
¥iv
->
py_mixî
) {

1031 
	`pymixî_‰ì
((
pymixî
 *)
¥iv
->
py_mixî
);

1032 
	`Py_DECREF
(
¥iv
->
py_mixî
);

1034 i‡(
¥iv
->
py_öôülized
) {

1035 
	`Py_XDECREF
(
¥iv
->
py_evít_func
);

1036 
	`Py_FöÆize
();

1038 
	`‰ì
(
¥iv
);

1039 
	}
}

1041 
	$Æß_mixî_sim∂e_pyöô
(
pyth⁄_¥iv
 *
¥iv
,

1042 
PyObje˘
 *
py_mod
,

1043 
FILE
 *
Â
,

1044 c⁄° *
fûe
,

1045 
¢d_mixî_˛ass_t
 *
˛ass
,

1046 
¢d_mixî_t
 *
mixî
,

1047 c⁄° *
devi˚
)

1049 
PyObje˘
 *
obj
, *
obj1
, *
obj2
, *
mdi˘
;

1051 
mdi˘
 = 
¥iv
->
py_mdi˘
 = 
	`PyModuÀ_GëDi˘
(
py_mod
);

1052 
obj
 = 
	`PyUnicode_FromSåög
(
fûe
);

1053 i‡(
obj
)

1054 
	`PyDi˘_SëIãmSåög
(
mdi˘
, "__fûe__", 
obj
);

1055 
	`Py_XDECREF
(
obj
);

1056 
obj
 = 
	`PyUnicode_FromSåög
(
devi˚
);

1057 i‡(
obj
)

1058 
	`PyDi˘_SëIãmSåög
(
mdi˘
, "devi˚", 
obj
);

1059 
	`Py_XDECREF
(
obj
);

1060 
	`Py_INCREF
(&
pymñem_ty≥
);

1061 
	`Py_INCREF
(&
pymixî_ty≥
);

1062 
	`PyModuÀ_AddObje˘
(
py_mod
, "I¡î«lMEÀmít", (
PyObje˘
 *)&
pymñem_ty≥
);

1063 
	`PyModuÀ_AddObje˘
(
py_mod
, "I¡î«lMixî", (
PyObje˘
 *)&
pymixî_ty≥
);

1064 
obj
 = 
	`PyDi˘_GëIãmSåög
(
mdi˘
, "InternalMixer");

1065 i‡(
obj
) {

1066 
obj1
 = 
	`PyTu∂e_New
(3);

1067 
	`PyTu∂e_SET_ITEM
(
obj1
, 0, 
	`PyI¡_FromL⁄g
(()
˛ass
));

1068 
	`PyTu∂e_SET_ITEM
(
obj1
, 1, 
	`PyI¡_FromL⁄g
(()
mixî
));

1069 
	`PyTu∂e_SET_ITEM
(
obj1
, 2, 
mdi˘
);

1070 
	`Py_INCREF
(
mdi˘
);

1071 
obj2
 = 
	`PyObje˘_CÆlObje˘
(
obj
, 
obj1
);

1072 
	`Py_XDECREF
(
obj1
);

1073 
	`PyDi˘_SëIãmSåög
(
mdi˘
, "mixî", 
obj2
);

1074 
¥iv
->
py_mixî
 = 
obj2
;

1076 
	`SNDERR
("UnableÅo create InternalMixer object");

1077  -
EIO
;

1080 
obj
 = 
	`PyRun_FûeEx
(
Â
, 
fûe
, 
Py_fûe_öput
, 
mdi˘
, mdict, 1);

1081 i‡(
obj
 =
NULL
)

1082 
	`PyEº_Pröt
();

1083 
	`Py_XDECREF
(
obj
);

1084 
¥iv
->
py_evít_func
 = 
	`PyDi˘_GëIãmSåög
(
mdi˘
, "event");

1085 i‡(
¥iv
->
py_evít_func
 =
NULL
) {

1086 
	`SNDERR
("UnableÅo findÖython function 'event'");

1087  -
EIO
;

1090 
	}
}

1092 #i‡
PY_MAJOR_VERSION
 >= 3

1093 
PyModuÀDef
 
	gsmixî_pyth⁄_moduÀ
 = {

1094 
PyModuÀDef_HEAD_INIT
,

1096 
NULL
,

1098 
pyth⁄_mëhods
,

1099 
NULL
,

1100 
NULL
,

1101 
NULL
,

1102 
NULL


1106 
	$Æß_mixî_sim∂e_föô
(
¢d_mixî_˛ass_t
 *
˛ass
,

1107 
¢d_mixî_t
 *
mixî
,

1108 c⁄° *
devi˚
)

1110 
pyth⁄_¥iv
 *
¥iv
;

1111 
FILE
 *
Â
;

1112 c⁄° *
fûe
;

1113 
PyObje˘
 *
obj
, *
py_mod
;

1114 
∑th
[
PATH_MAX
];

1116 
¥iv
 = 
	`ˇŒoc
(1, (*priv));

1117 i‡(
¥iv
 =
NULL
)

1118  -
ENOMEM
;

1120 
	`¢d_mixî_sbasic_£t_¥iv©e
(
˛ass
, 
¥iv
);

1121 
	`¢d_mixî_sbasic_£t_¥iv©e_‰ì
(
˛ass
, 
Æß_mixî_sim∂e_‰ì
);

1123 
fûe
 = 
	`gëív
("ALSA_MIXER_SIMPLE_MPYTHON");

1124 i‡(
fûe
 =
NULL
) {

1125 
	`¢d_dÕ©h
(
∑th
, ’©h), 
SCRIPT
);

1126 
fûe
 = 
∑th
;

1129 
Â
 = 
	`f›í
(
fûe
, "r");

1130 i‡(
Â
 =
NULL
) {

1131 
	`SNDERR
("U«bÀÅÿfödÖyth⁄ moduÀ '%s'", 
fûe
);

1132  -
ENODEV
;

1135 
	`Py_Inôülize
();

1136 i‡(
	`PyTy≥_Ródy
(&
pymñem_ty≥
) < 0 ||

1137 
	`PyTy≥_Ródy
(&
pymixî_ty≥
) < 0) {

1138 
	`f˛o£
(
Â
);

1139  -
EIO
;

1141 #i‡
PY_MAJOR_VERSION
 < 3

1142 
	`Py_InôModuÀ
("smixî_pyth⁄", 
pyth⁄_mëhods
);

1144 
	`PyModuÀ_Cª©e
(&
smixî_pyth⁄_moduÀ
);

1146 
¥iv
->
py_öôülized
 = 1;

1147 
maö_öãΩªãr
 = 
	`PyThªadSèã_Gë
()->
öãΩ
;

1148 
obj
 = 
	`PyImp‹t_GëModuÀDi˘
();

1149 
py_mod
 = 
	`PyDi˘_GëIãmSåög
(
obj
, "__main__");

1150 i‡(
py_mod
)

1151 
	`Æß_mixî_sim∂e_pyöô
(
¥iv
, 
py_mod
, 
Â
, 
fûe
, 
˛ass
, 
mixî
, 
devi˚
);

1153 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/sbase.c

22 
	~<°dio.h
>

23 
	~<°dlib.h
>

24 
	~<uni°d.h
>

25 
	~<°rög.h
>

26 
	~<f˙é.h
>

27 
	~<sys/io˘l.h
>

28 
	~<m©h.h
>

29 
	~"asoundlib.h
"

30 
	~"mixî_ab°.h
"

31 
	~"sba£.h
"

37 
£Àm_ªad
(
¢d_mixî_ñem_t
 *
ñem
);

43 
	$ch™m≠_to_ch™√ls
(
ch™m≠
)

45 
i
, 
ªs
;

47 
i
 = 0, 
ªs
 = 0; i < 
MAX_CHANNEL
; i++)

48 i‡(
ch™m≠
 & (1 << 
i
))

49 
ªs
++;

50  
ªs
;

51 
	}
}

54 
	$to_u£r
(
£Àm_ba£
 *
s
, 
dú
, 
hñem_ba£
 *
c
, 
vÆue
)

56 
öt64_t
 
n
;

57 i‡(
c
->
max
 =c->
mö
)

58  
s
->
dú
[dú].
mö
;

59 
n
 = (
öt64_t
Ë(
vÆue
 - 
c
->
mö
Ë* (
s
->
dú
[dú].
max
 - s->dir[dir].min);

60  
s
->
dú
[dú].
mö
 + (
n
 + (
c
->
max
 - c->min) / 2) / (c->max - c->min);

61 
	}
}

63 
	$‰om_u£r
(
£Àm_ba£
 *
s
, 
dú
, 
hñem_ba£
 *
c
, 
vÆue
)

65 
öt64_t
 
n
;

66 i‡(
s
->
dú
[dú].
max
 =s->dú[dú].
mö
)

67  
c
->
mö
;

68 
n
 = (
öt64_t
Ë(
vÆue
 - 
s
->
dú
[dú].
mö
Ë* (
c
->
max
 - c->min);

69  
c
->
mö
 + (
n
 + (
s
->
dú
[dú].
max
 - s->dir[dir].min) / 2) / (s->dir[dir].max - s->dir[dir].min);

70 
	}
}

73 
	$upd©e_ønges
(
£Àm_ba£
 *
s
)

75 
mask
[2] = { 
SM_CAP_PVOLUME
, 
SM_CAP_CVOLUME
 };

76 
gmask
[2] = { 
SM_CAP_GVOLUME
, SM_CAP_GVOLUME };

77 
dú
, 
ok_Êag
;

78 
li°_hód
 *
pos
;

79 
hñem_ba£
 *
hñem
;

81 
dú
 = 0; dir < 2; dir++) {

82 
s
->
dú
[dú].
mö
 = 0;

83 
s
->
dú
[dú].
max
 = 0;

84 
ok_Êag
 = 0;

85 
	`li°_f‹_óch
(
pos
, &
s
->
hñems
) {

86 
hñem
 = 
	`li°_íåy
(
pos
, 
hñem_ba£
, 
li°
);

87 
	`¥ötf
("mö = %li, max = %li\n", 
hñem
->
mö
, hñem->
max
);

88 i‡(
hñem
->
ˇps
 & 
mask
[
dú
]) {

89 
s
->
dú
[dú].
mö
 = 
hñem
->min;

90 
s
->
dú
[dú].
max
 = 
hñem
->max;

91 
ok_Êag
 = 1;

95 i‡(
ok_Êag
)

97 
	`li°_f‹_óch
(
pos
, &
s
->
hñems
) {

98 
hñem
 = 
	`li°_íåy
(
pos
, 
hñem_ba£
, 
li°
);

99 i‡(
hñem
->
ˇps
 & 
gmask
[
dú
]) {

100 
s
->
dú
[dú].
mö
 = 
hñem
->min;

101 
s
->
dú
[dú].
max
 = 
hñem
->max;

106 
	}
}

112 
	$is_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, 
cmd
, 
vÆ
)

114 
£Àm_ba£
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

116 
cmd
) {

118 
SM_OPS_IS_ACTIVE
: {

119 
li°_hód
 *
pos
;

120 
hñem_ba£
 *
hñem
;

121 
	`li°_f‹_óch
(
pos
, &
s
->
hñems
) {

122 
hñem
 = 
	`li°_íåy
(
pos
, 
hñem_ba£
, 
li°
);

123 i‡(
hñem
->
öa˘ive
)

129 
SM_OPS_IS_MONO
:

130  
	`ch™m≠_to_ch™√ls
(
s
->
dú
[dú].
ch™m≠
) == 1;

132 
SM_OPS_IS_CHANNEL
:

133 i‡(
vÆ
 > 
MAX_CHANNEL
)

135  !!((1 << 
vÆ
Ë& 
s
->
dú
[dú].
ch™m≠
);

137 
SM_OPS_IS_ENUMERATED
: {

138 
hñem_ba£
 *
hñem
;

139 
hñem
 = 
	`li°_íåy
(
s
->
hñems
.
√xt
, 
hñem_ba£
, 
li°
);

140  !!(
hñem
->
puΩo£
 =
PURPOSE_ENUMLIST
);

143 
SM_OPS_IS_ENUMCNT
: {

144 
hñem_ba£
 *
hñem
;

145 
hñem
 = 
	`li°_íåy
(
s
->
hñems
.
√xt
, 
hñem_ba£
, 
li°
);

146  
hñem
->
max
;

152 
	}
}

154 
	$gë_ønge_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

155 *
mö
, *
max
)

157 
£Àm_ba£
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

159 *
mö
 = 
s
->
dú
[dir].min;

160 *
max
 = 
s
->
dú
[dir].max;

163 
	}
}

165 
	$gë_dB_ønge_›s
(
¢d_mixî_ñem_t
 *
ñem
 
ATTRIBUTE_UNUSED
,

166 
dú
 
ATTRIBUTE_UNUSED
,

167 *
mö
 
ATTRIBUTE_UNUSED
,

168 *
max
 
ATTRIBUTE_UNUSED
)

170  -
ENXIO
;

171 
	}
}

173 
	$£t_ønge_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

174 
mö
, 
max
)

176 
£Àm_ba£
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

177 
îr
;

179 
s
->
dú
[dú].
f‹˚d_ønge
 = 1;

180 
s
->
dú
[dú].
mö
 = min;

181 
s
->
dú
[dú].
max
 = max;

183 i‡((
îr
 = 
	`£Àm_ªad
(
ñem
)) < 0)

184  
îr
;

186 
	}
}

188 
	$gë_vﬁume_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

189 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
)

191 
£Àm_ba£
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

193 *
vÆue
 = 
s
->
dú
[dú].
vﬁ
[
ch™√l
];

195 
	}
}

197 
	$gë_dB_›s
(
¢d_mixî_ñem_t
 *
ñem
 
ATTRIBUTE_UNUSED
,

198 
dú
 
ATTRIBUTE_UNUSED
,

199 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
 
ATTRIBUTE_UNUSED
,

200 *
vÆue
 
ATTRIBUTE_UNUSED
)

202  -
ENXIO
;

203 
	}
}

205 
	$gë_swôch_›s
(
¢d_mixî_ñem_t
 *
ñem
 
ATTRIBUTE_UNUSED
,

206 
dú
 
ATTRIBUTE_UNUSED
,

207 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
 
ATTRIBUTE_UNUSED
,

208 *
vÆue
)

211 *
vÆue
 = 0;

213 
	}
}

215 
	$£t_vﬁume_›s
(
¢d_mixî_ñem_t
 *
ñem
 
ATTRIBUTE_UNUSED
,

216 
dú
 
ATTRIBUTE_UNUSED
,

217 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
 
ATTRIBUTE_UNUSED
,

218 
vÆue
 
ATTRIBUTE_UNUSED
)

222 
	}
}

224 
	$£t_dB_›s
(
¢d_mixî_ñem_t
 *
ñem
 
ATTRIBUTE_UNUSED
,

225 
dú
 
ATTRIBUTE_UNUSED
,

226 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
 
ATTRIBUTE_UNUSED
,

227 
vÆue
 
ATTRIBUTE_UNUSED
,

228 
xdú
 
ATTRIBUTE_UNUSED
)

230  -
ENXIO
;

231 
	}
}

233 
	$£t_swôch_›s
(
¢d_mixî_ñem_t
 *
ñem
 
ATTRIBUTE_UNUSED
,

234 
dú
 
ATTRIBUTE_UNUSED
,

235 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
 
ATTRIBUTE_UNUSED
,

236 
vÆue
 
ATTRIBUTE_UNUSED
)

241 
	}
}

243 
	$íum_ôem_«me_›s
(
¢d_mixî_ñem_t
 *
ñem
 
ATTRIBUTE_UNUSED
,

244 
ôem
 
ATTRIBUTE_UNUSED
,

245 
size_t
 
maxÀn
 
ATTRIBUTE_UNUSED
,

246 *
buf
 
ATTRIBUTE_UNUSED
)

250 
	}
}

252 
	$gë_íum_ôem_›s
(
¢d_mixî_ñem_t
 *
ñem
 
ATTRIBUTE_UNUSED
,

253 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
 
ATTRIBUTE_UNUSED
,

254 *
ôemp
 
ATTRIBUTE_UNUSED
)

258 
	}
}

260 
	$£t_íum_ôem_›s
(
¢d_mixî_ñem_t
 *
ñem
 
ATTRIBUTE_UNUSED
,

261 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
 
ATTRIBUTE_UNUSED
,

262 
ôem
 
ATTRIBUTE_UNUSED
)

266 
	}
}

268 
sm_ñem_›s
 
	gsim∂e_ac97_›s
 = {

269 .
is
 = 
is_›s
,

270 .
	ggë_ønge
 = 
gë_ønge_›s
,

271 .
	ggë_dB_ønge
 = 
gë_dB_ønge_›s
,

272 .
	g£t_ønge
 = 
£t_ønge_›s
,

273 .
	ggë_vﬁume
 = 
gë_vﬁume_›s
,

274 .
	ggë_dB
 = 
gë_dB_›s
,

275 .
	g£t_vﬁume
 = 
£t_vﬁume_›s
,

276 .
	g£t_dB
 = 
£t_dB_›s
,

277 .
	ggë_swôch
 = 
gë_swôch_›s
,

278 .
	g£t_swôch
 = 
£t_swôch_›s
,

279 .
	gíum_ôem_«me
 = 
íum_ôem_«me_›s
,

280 .
	ggë_íum_ôem
 = 
gë_íum_ôem_›s
,

281 .
	g£t_íum_ôem
 = 
£t_íum_ôem_›s


288 
	$£Àm_ªad
(
¢d_mixî_ñem_t
 *
ñem
)

290 
	`¥ötf
("ñemÑód: %p\n", 
ñem
);

292 
	}
}

294 
	$sim∂e_evít_ªmove
(
¢d_h˘l_ñem_t
 *
hñem
,

295 
¢d_mixî_ñem_t
 *
mñem
 
ATTRIBUTE_UNUSED
)

297 
	`¥ötf
("evíàªmove: %p\n", 
hñem
);

299 
	}
}

301 
	$£Àm_‰ì
(
¢d_mixî_ñem_t
 *
ñem
)

303 
£Àm_ba£
 *
sim∂e
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

304 
hñem_ba£
 *
hsim∂e
;

305 
li°_hód
 *
pos
, *
≈os
;

307 i‡(
sim∂e
->
£Àm
.
id
)

308 
	`¢d_mixî_£Àm_id_‰ì
(
sim∂e
->
£Àm
.
id
);

309 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, &
sim∂e
->
hñems
) {

310 
hsim∂e
 = 
	`li°_íåy
(
pos
, 
hñem_ba£
, 
li°
);

311 
	`‰ì
(
hsim∂e
);

313 
	`‰ì
(
sim∂e
);

314 
	}
}

316 
	$sim∂e_evít_add1
(
¢d_mixî_˛ass_t
 *
˛ass
,

317 
¢d_h˘l_ñem_t
 *
hñem
,

318 
hñem_£À˘‹
 *
£l
)

320 
b˛ass_¥iv©e
 *
¥iv
 = 
	`¢d_mixî_sbasic_gë_¥iv©e
(
˛ass
);

321 
¢d_mixî_ñem_t
 *
mñem
;

322 
¢d_mixî_£Àm_id_t
 *
id
;

323 
¢d_˘l_ñem_öfo_t
 *
öfo
;

324 
£Àm_ba£
 *
sim∂e
;

325 
hñem_ba£
 *
hsim∂e
;

326 
¢d_˘l_ñem_ty≥_t
 
˘y≥
;

327 
mö
, 
max
;

328 
îr
, 
√w
 = 0;

329 
li°_hód
 *
pos
;

330 
b˛ass_sid
 *
bsid
;

331 
mñem_sids
 *
sid
;

332 
ui
;

334 
	`li°_f‹_óch
(
pos
, &
¥iv
->
sids
) {

335 
bsid
 = 
	`li°_íåy
(
pos
, 
b˛ass_sid
, 
li°
);

336 
ui
 = 0; uò< 
bsid
->
cou¡
; ui++) {

337 i‡(
bsid
->
sids
[
ui
].
sid
 =
£l
->sid) {

338 
sid
 = &
bsid
->
sids
[
ui
];

339 
__sid_ok
;

345 
__sid_ok
:

346 
	`¢d_˘l_ñem_öfo_Æloˇ
(&
öfo
);

347 
îr
 = 
	`¢d_h˘l_ñem_öfo
(
hñem
, 
öfo
);

348 i‡(
îr
 < 0)

349  
îr
;

350 
˘y≥
 = 
	`¢d_˘l_ñem_öfo_gë_ty≥
(
öfo
);

351 
˘y≥
) {

352 
SND_CTL_ELEM_TYPE_ENUMERATED
:

353 
mö
 = 0;

354 
max
 = 
	`¢d_˘l_ñem_öfo_gë_ôems
(
öfo
);

356 
SND_CTL_ELEM_TYPE_INTEGER
:

357 
mö
 = 
	`¢d_˘l_ñem_öfo_gë_mö
(
öfo
);

358 
max
 = 
	`¢d_˘l_ñem_öfo_gë_max
(
öfo
);

361 
mö
 = 
max
 = 0;

365 
	`¥ötf
("evíàadd: %p, %∞(%s)\n", 
hñem
, 
£l
, 
	`¢d_h˘l_ñem_gë_«me
(helem));

366 i‡(
	`¢d_mixî_£Àm_id_mÆloc
(&
id
))

367  -
ENOMEM
;

368 
hsim∂e
 = 
	`ˇŒoc
(1, (*hsimple));

369 i‡(
hsim∂e
 =
NULL
) {

370 
	`¢d_mixî_£Àm_id_‰ì
(
id
);

371  -
ENOMEM
;

373 
£l
->
puΩo£
) {

374 
PURPOSE_SWITCH
:

375 i‡(
˘y≥
 !
SND_CTL_ELEM_TYPE_BOOLEAN
) {

376 
__övÆid_ty≥
:

377 
	`¢d_mixî_£Àm_id_‰ì
(
id
);

378 
	`‰ì
(
hsim∂e
);

379  -
EINVAL
;

382 
PURPOSE_VOLUME
:

383 i‡(
˘y≥
 !
SND_CTL_ELEM_TYPE_INTEGER
)

384 
__övÆid_ty≥
;

387 
hsim∂e
->
puΩo£
 = 
£l
->purpose;

388 
hsim∂e
->
ˇps
 = 
£l
->caps;

389 
hsim∂e
->
mö
 = min;

390 
hsim∂e
->
max
 = max;

391 
	`¢d_mixî_£Àm_id_£t_«me
(
id
, 
sid
->
¢ame
);

392 
	`¢d_mixî_£Àm_id_£t_ödex
(
id
, 
sid
->
södex
);

393 
mñem
 = 
	`¢d_mixî_föd_£Àm
(
	`¢d_mixî_˛ass_gë_mixî
(
˛ass
), 
id
);

394 i‡(!
mñem
) {

395 
sim∂e
 = 
	`ˇŒoc
(1, (*simple));

396 i‡(!
sim∂e
) {

397 
	`¢d_mixî_£Àm_id_‰ì
(
id
);

398 
	`‰ì
(
hsim∂e
);

399  -
ENOMEM
;

401 
sim∂e
->
£Àm
.
id
 = id;

402 
sim∂e
->
£Àm
.
›s
 = &
sim∂e_ac97_›s
;

403 
	`INIT_LIST_HEAD
(&
sim∂e
->
hñems
);

404 
sim∂e
->
sid
 = 
£l
->sid;

405 
îr
 = 
	`¢d_mixî_ñem_√w
(&
mñem
, 
SND_MIXER_ELEM_SIMPLE
,

406 
sid
->
weight
,

407 
sim∂e
, 
£Àm_‰ì
);

408 i‡(
îr
 < 0) {

409 
	`¢d_mixî_£Àm_id_‰ì
(
id
);

410 
	`‰ì
(
hsim∂e
);

411 
	`‰ì
(
sim∂e
);

412  
îr
;

414 
√w
 = 1;

416 
sim∂e
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
mñem
);

417 
	`¢d_mixî_£Àm_id_‰ì
(
id
);

419 
	`li°_add_èû
(&
hsim∂e
->
li°
, &
sim∂e
->
hñems
);

420 
hsim∂e
->
öa˘ive
 = 
	`¢d_˘l_ñem_öfo_is_öa˘ive
(
öfo
);

421 
îr
 = 
	`¢d_mixî_ñem_©èch
(
mñem
, 
hñem
);

422 i‡(
îr
 < 0)

423 
__îr‹
;

424 
sim∂e
->
dú
[0].
ch™m≠
 |
sid
->chanmap[0];

425 
sim∂e
->
dú
[1].
ch™m≠
 |
sid
->chanmap[1];

426 
sim∂e
->
£Àm
.
ˇps
 |
hsim∂e
->caps;

427 
	`upd©e_ønges
(
sim∂e
);

429 
îr
 = 
	`sim∂e_upd©e
(
mñem
);

430 i‡(
îr
 < 0) {

431 i‡(
√w
)

432 
__îr‹
;

433  
îr
;

436 i‡(
√w
)

437 
îr
 = 
	`¢d_mixî_ñem_add
(
mñem
, 
˛ass
);

439 
îr
 = 
	`¢d_mixî_ñem_öfo
(
mñem
);

440 i‡(
îr
 < 0)

441  
îr
;

442 
îr
 = 
	`£Àm_ªad
(
mñem
);

443 i‡(
îr
 < 0)

444  
îr
;

445 i‡(
îr
)

446 
îr
 = 
	`¢d_mixî_ñem_vÆue
(
mñem
);

447  
îr
;

448 
__îr‹
:

449 i‡(
√w
)

450 
	`¢d_mixî_ñem_‰ì
(
mñem
);

451  -
EINVAL
;

452 
	}
}

454 
	$sim∂e_evít_add
(
¢d_mixî_˛ass_t
 *
˛ass
, 
¢d_h˘l_ñem_t
 *
hñem
)

456 
b˛ass_¥iv©e
 *
¥iv
 = 
	`¢d_mixî_sbasic_gë_¥iv©e
(
˛ass
);

457 
b˛ass_£À˘‹
 *
£l
;

458 
hñem_£À˘‹
 *
h£l
;

459 
li°_hód
 *
pos
;

460 
¢d_˘l_ñem_iÁ˚_t
 
iÁ˚
 = 
	`¢d_h˘l_ñem_gë_öãrÁ˚
(
hñem
);

461 c⁄° *
«me
 = 
	`¢d_h˘l_ñem_gë_«me
(
hñem
);

462 
ödex
 = 
	`¢d_h˘l_ñem_gë_ödex
(
hñem
);

463 
ui
;

464 
îr
;

466 
	`li°_f‹_óch
(
pos
, &
¥iv
->
£À˘‹s
) {

467 
£l
 = 
	`li°_íåy
(
pos
, 
b˛ass_£À˘‹
, 
li°
);

468 
ui
 = 0; uò< 
£l
->
cou¡
; ui++) {

469 
h£l
 = &
£l
->
£À˘‹s
[
ui
];

470 i‡(
h£l
->
iÁ˚
 =iÁ˚ && !
	`°rcmp
(h£l->
«me
,ÇameË&& h£l->
ödex
 == index) {

471 
îr
 = 
	`sim∂e_evít_add1
(
˛ass
, 
hñem
, 
h£l
);

472 i‡(
îr
 < 0)

473  
îr
;

478 
	}
}

480 
	$Æß_mixî_sbasic_evít
(
¢d_mixî_˛ass_t
 *
˛ass
, 
mask
,

481 
¢d_h˘l_ñem_t
 *
hñem
, 
¢d_mixî_ñem_t
 *
mñem
)

483 
îr
;

484 i‡(
mask
 =
SND_CTL_EVENT_MASK_REMOVE
)

485  
	`sim∂e_evít_ªmove
(
hñem
, 
mñem
);

486 i‡(
mask
 & 
SND_CTL_EVENT_MASK_ADD
) {

487 
îr
 = 
	`sim∂e_evít_add
(
˛ass
, 
hñem
);

488 i‡(
îr
 < 0)

489  
îr
;

491 i‡(
mask
 & 
SND_CTL_EVENT_MASK_INFO
) {

492 
îr
 = 
	`sim∂e_evít_ªmove
(
hñem
, 
mñem
);

493 i‡(
îr
 < 0)

494  
îr
;

495 
îr
 = 
	`sim∂e_evít_add
(
˛ass
, 
hñem
);

496 i‡(
îr
 < 0)

497  
îr
;

500 i‡(
mask
 & 
SND_CTL_EVENT_MASK_VALUE
) {

501 
îr
 = 
	`£Àm_ªad
(
mñem
);

502 i‡(
îr
 < 0)

503  
îr
;

504 i‡(
îr
) {

505 
îr
 = 
	`¢d_mixî_ñem_vÆue
(
mñem
);

506 i‡(
îr
 < 0)

507  
îr
;

511 
	}
}

513 
	$sbasic_˝riv_‰ì
(
¢d_mixî_˛ass_t
 *
˛ass
)

515 
b˛ass_¥iv©e
 *
¥iv
 = 
	`¢d_mixî_sbasic_gë_¥iv©e
(
˛ass
);

516 
b˛ass_£À˘‹
 *
£l
;

517 
b˛ass_sid
 *
sid
;

518 
li°_hód
 *
pos
, *
pos1
;

520 
	`li°_f‹_óch_ß„
(
pos
, 
pos1
, &
¥iv
->
£À˘‹s
) {

521 
£l
 = 
	`li°_íåy
(
pos
, 
b˛ass_£À˘‹
, 
li°
);

522 
	`‰ì
(
£l
);

524 
	`li°_f‹_óch_ß„
(
pos
, 
pos1
, &
¥iv
->
sids
) {

525 
sid
 = 
	`li°_íåy
(
pos
, 
b˛ass_sid
, 
li°
);

526 
	`‰ì
(
sid
);

528 
	`‰ì
(
¥iv
);

529 
	}
}

531 
	$Æß_mixî_sbasic_öô¥iv
(
¢d_mixî_˛ass_t
 *
˛ass
,

532 
b˛ass_¥iv©e
 *
¥iv
)

534 
	`INIT_LIST_HEAD
(&
¥iv
->
£À˘‹s
);

535 
	`INIT_LIST_HEAD
(&
¥iv
->
sids
);

536 
	`¢d_mixî_sbasic_£t_¥iv©e
(
˛ass
, 
¥iv
);

537 
	`¢d_mixî_sbasic_£t_¥iv©e_‰ì
(
˛ass
, 
sbasic_˝riv_‰ì
);

538 
	}
}

540 
	$Æß_mixî_sbasic_£Ãeg
(
¢d_mixî_˛ass_t
 *
˛ass
,

541 
hñem_£À˘‹
 *
£À˘‹s
,

542 
cou¡
)

544 
b˛ass_¥iv©e
 *
¥iv
 = 
	`¢d_mixî_sbasic_gë_¥iv©e
(
˛ass
);

545 
b˛ass_£À˘‹
 *
£l
 = 
	`ˇŒoc
(1, (*sel));

547 i‡(
£l
 =
NULL
)

548  -
ENOMEM
;

549 i‡(
¥iv
 =
NULL
) {

550 
¥iv
 = 
	`ˇŒoc
(1, (*priv));

551 i‡(
¥iv
 =
NULL
) {

552 
	`‰ì
(
£l
);

553  -
ENOMEM
;

556 
£l
->
£À˘‹s
 = selectors;

557 
£l
->
cou¡
 = count;

558 
	`li°_add_èû
(&
£l
->
li°
, &
¥iv
->
£À˘‹s
);

560 
	}
}

562 
	$Æß_mixî_sbasic_sidªg
(
¢d_mixî_˛ass_t
 *
˛ass
,

563 
mñem_sids
 *
sids
,

564 
cou¡
)

566 
b˛ass_¥iv©e
 *
¥iv
 = 
	`¢d_mixî_sbasic_gë_¥iv©e
(
˛ass
);

567 
b˛ass_sid
 *
sid
 = 
	`ˇŒoc
(1, (*sid));

569 i‡(
sid
 =
NULL
)

570  -
ENOMEM
;

571 i‡(
¥iv
 =
NULL
) {

572 
¥iv
 = 
	`ˇŒoc
(1, (*priv));

573 i‡(
¥iv
 =
NULL
) {

574 
	`‰ì
(
sid
);

575  -
ENOMEM
;

577 
	`INIT_LIST_HEAD
(&
¥iv
->
£À˘‹s
);

578 
	`INIT_LIST_HEAD
(&
¥iv
->
sids
);

579 
	`¢d_mixî_sbasic_£t_¥iv©e
(
˛ass
, 
¥iv
);

580 
	`¢d_mixî_sbasic_£t_¥iv©e_‰ì
(
˛ass
, 
sbasic_˝riv_‰ì
);

582 
sid
->
sids
 = sids;

583 
sid
->
cou¡
 = count;

584 
	`li°_add
(&
sid
->
li°
, &
¥iv
->
sids
);

586 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/sbase.h

22 #i‚de‡
__SMIXER_BASE_H


24 
	~"li°.h
"

26 
	#MAX_CHANNEL
 6

	)

28 
	#SID_MASTER
 0

	)

29 
	#SID_HEADPHONE
 1

	)

30 
	#SID_FRONT
 2

	)

31 
	#SID_PCM
 3

	)

32 
	#SID_CD
 4

	)

34 
	smñem_sids
 {

35 
	msid
;

36 c⁄° *
	m¢ame
;

37 
	msödex
;

38 
	mweight
;

39 
	mch™m≠
[2];

40 
sm_ñem_›s
 *
	ms›s
;

43 
	#PURPOSE_VOLUME
 0

	)

44 
	#PURPOSE_SWITCH
 1

	)

45 
	#PURPOSE_ENUMLIST
 2

	)

47 
	shñem_£À˘‹
 {

48 
¢d_˘l_ñem_iÁ˚_t
 
	miÁ˚
;

49 c⁄° *
	m«me
;

50 
	mödex
;

51 
	msid
;

52 
	mpuΩo£
;

53 
	mˇps
;

56 
	shñem_ba£
 {

57 
li°_hód
 
	mli°
;

58 
¢d_h˘l_ñem_t
 *
	mhñem
;

59 
	mpuΩo£
;

60 
	mˇps
;

61 
	möa˘ive
: 1;

62 
	mmö
, 
	mmax
;

63 
	mcou¡
;

66 
	s£Àm_ba£
 {

67 
sm_£Àm_t
 
	m£Àm
;

68 
li°_hód
 
	mhñems
;

69 
	msid
;

71 
	mch™m≠
;

72 
	mf‹˚d_ønge
: 1;

73 
	mmö
, 
	mmax
;

74 
	mvﬁ
[
MAX_CHANNEL
];

75 } 
	mdú
[2];

78 
	sb˛ass_£À˘‹
 {

79 
li°_hód
 
	mli°
;

80 
hñem_£À˘‹
 *
	m£À˘‹s
;

81 
	mcou¡
;

84 
	sb˛ass_sid
 {

85 
li°_hód
 
	mli°
;

86 
mñem_sids
 *
	msids
;

87 
	mcou¡
;

90 
	sb˛ass_ba£_›s
 {

91 (*
	mevít
)(
¢d_mixî_˛ass_t
 *
	m˛ass
, 
	mmask
,

92 
¢d_h˘l_ñem_t
 *
	mhñem
, 
¢d_mixî_ñem_t
 *
	mmñem
);

93 (*
	m£Ãeg
)(
¢d_mixî_˛ass_t
 *
	m˛ass
,

94 
hñem_£À˘‹
 *
	m£À˘‹s
,

95 
	mcou¡
);

96 (*
	msidªg
)(
¢d_mixî_˛ass_t
 *
	m˛ass
,

97 
mñem_sids
 *
	msids
,

98 
	mcou¡
);

99 } 
	tb˛ass_ba£_›s_t
;

101 
	sb˛ass_¥iv©e
 {

102 
li°_hód
 
	m£À˘‹s
;

103 
li°_hód
 
	msids
;

104 *
	mdl_sba£
;

105 
b˛ass_ba£_›s_t
 
	m›s
;

108 
mixî_sim∂e_basic_dl›í
(
¢d_mixî_˛ass_t
 *
˛ass
,

109 
b˛ass_ba£_›s_t
 **
›s
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/sbasedl.c

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~<uni°d.h
>

26 
	~<°rög.h
>

27 
	~<f˙é.h
>

28 
	~<sys/io˘l.h
>

29 
	~<m©h.h
>

30 
	~<dlf˙.h
>

31 
	~"c⁄fig.h
"

32 
	~"asoundlib.h
"

33 
	~"mixî_ab°.h
"

34 
	~"sba£.h
"

36 
	#SO_PATH
 "smixî"

	)

38 
	$mixî_sim∂e_basic_dl›í
(
¢d_mixî_˛ass_t
 *
˛ass
,

39 
b˛ass_ba£_›s_t
 **
›s
)

41 
b˛ass_¥iv©e
 *
¥iv
 = 
	`¢d_mixî_sbasic_gë_¥iv©e
(
˛ass
);

42 c⁄° *
lib
 = "smixer-sbase.so";

43 (*
öô¥iv
)(
¢d_mixî_˛ass_t
 *
˛ass
, 
b˛ass_¥iv©e
 *
¥iv
);

44 *
xlib
, *
∑th
, 
îrbuf
[256];

45 *
h
;

46 
öôÊag
 = 0;

48 i‡(
¥iv
 =
NULL
) {

49 
¥iv
 = 
	`ˇŒoc
(1, (*priv));

50 i‡(
¥iv
 =
NULL
)

51  -
ENOMEM
;

52 
öôÊag
 = 1;

54 
∑th
 = 
	`gëív
("ALSA_MIXER_SIMPLE_MODULES");

55 i‡(!
∑th
)

56 
∑th
 = 
SO_PATH
;

57 
xlib
 = 
	`mÆloc
(
	`°æí
(
lib
Ë+ såÀn(
∑th
) + 1 + 1);

58 i‡(
xlib
 =
NULL
) {

59 i‡(
öôÊag
)

60 
	`‰ì
(
¥iv
);

61  -
ENOMEM
;

63 
	`°r˝y
(
xlib
, 
∑th
);

64 
	`°rˇt
(
xlib
, "/");

65 
	`°rˇt
(
xlib
, 
lib
);

66 
h
 = 
	`¢d_dl›í
(
xlib
, 
RTLD_NOW
, 
îrbuf
, (errbuf));

67 i‡(
h
 =
NULL
) {

68 
	`SNDERR
("U«bÀÅÿ›íÜibøry '%s': %s", 
xlib
, 
îrbuf
);

69 
__îr‹
;

71 
öô¥iv
 = 
	`dlsym
(
h
, "alsa_mixer_sbasic_initpriv");

72 i‡(
öô¥iv
 =
NULL
) {

73 
	`SNDERR
("Symbﬁ 'Æß_mixî_sbasic_öô¥iv' wa†nŸ found i¿'%s'", 
xlib
);

74 
__îr‹
;

76 
¥iv
->
›s
.
evít
 = 
	`dlsym
(
h
, "alsa_mixer_sbasic_event");

77 i‡(
¥iv
->
›s
.
evít
 =
NULL
) {

78 
	`SNDERR
("Symbﬁ 'Æß_mixî_sbasic_evít' wa†nŸ found i¿'%s'", 
xlib
);

79 
__îr‹
;

81 
¥iv
->
›s
.
£Ãeg
 = 
	`dlsym
(
h
, "alsa_mixer_sbasic_selreg");

82 i‡(
¥iv
->
›s
.
£Ãeg
 =
NULL
) {

83 
	`SNDERR
("Symbﬁ 'Æß_mixî_sbasic_£Ãeg' wa†nŸ found i¿'%s'", 
xlib
);

84 
__îr‹
;

86 
¥iv
->
›s
.
sidªg
 = 
	`dlsym
(
h
, "alsa_mixer_sbasic_sidreg");

87 i‡(
¥iv
->
›s
.
sidªg
 =
NULL
) {

88 
	`SNDERR
("Symbﬁ 'Æß_mixî_sbasic_sidªg' wa†nŸ found i¿'%s'", 
xlib
);

89 
__îr‹
;

91 
	`‰ì
(
xlib
);

92 i‡(
öôÊag
)

93 
	`öô¥iv
(
˛ass
, 
¥iv
);

94 
¥iv
->
dl_sba£
 = 
h
;

95 i‡(
›s
)

96 *
›s
 = &
¥iv
->ops;

99 
__îr‹
:

100 i‡(
öôÊag
)

101 
	`‰ì
(
¥iv
);

102 i‡(
h
)

103 
	`¢d_dl˛o£
(
h
);

104 
	`‰ì
(
xlib
);

105  -
ENXIO
;

106 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/alisp/alisp.c

24 
	#Æi•_£q_ôî©‹
 
Æi•_obje˘


	)

26 
	~"loˇl.h
"

27 
	~"Æi•.h
"

28 
	~"Æi•_loˇl.h
"

30 
	~<as£π.h
>

32 
	~<limôs.h
>

33 
	~<°dio.h
>

34 
	~<°dlib.h
>

35 
	~<°rög.h
>

36 
	~<˘y≥.h
>

37 
	~<m©h.h
>

38 
	~<îr.h
>

41 
Æi•_obje˘
 
	gÆß_li•_nû
;

42 
Æi•_obje˘
 
	gÆß_li•_t
;

45 
Æi•_obje˘
 * 
∑r£_obje˘
(
Æi•_ö°™˚
 *
ö°™˚
, 
havëokí
);

46 
¥öc_c⁄s
(
¢d_ouçut_t
 *
out
, 
Æi•_obje˘
 * 
p
);

47 
¥öc_obje˘
(
¢d_ouçut_t
 *
out
, 
Æi•_obje˘
 * 
p
);

48 
Æi•_obje˘
 * 
evÆ
(
Æi•_ö°™˚
 *
ö°™˚
, Æi•_obje˘ * 
p
);

51 
Æi•_obje˘
 *
F_evÆ
(
Æi•_ö°™˚
 *
ö°™˚
, alisp_object *);

52 
Æi•_obje˘
 *
F_¥ogn
(
Æi•_ö°™˚
 *
ö°™˚
, alisp_object *);

53 
Æi•_obje˘
 *
F_funˇŒ
(
Æi•_ö°™˚
 *
ö°™˚
, alisp_object *);

56 
Æi•_ö˛ude_fûe
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
fûíame
);

62 
	$gë_°rög_hash
(c⁄° *
s
)

64 
vÆ
 = 0;

65 i‡(
s
 =
NULL
)

66  
vÆ
;

67 *
s
)

68 
vÆ
 +*
s
++;

69  
vÆ
 & 
ALISP_OBJ_PAIR_HASH_MASK
;

70 
	}
}

72 
	$nomem
()

74 
	`SNDERR
("alisp:ÇoÉnough memory");

75 
	}
}

77 
	$li•_vîbo£
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
fmt
, ...)

79 
va_li°
 
≠
;

81 i‡(!
ö°™˚
->
vîbo£
)

83 
	`va_°¨t
(
≠
, 
fmt
);

84 
	`¢d_ouçut_¥ötf
(
ö°™˚
->
vout
, "alisp: ");

85 
	`¢d_ouçut_v¥ötf
(
ö°™˚
->
vout
, 
fmt
, 
≠
);

86 
	`¢d_ouçut_putc
(
ö°™˚
->
vout
, '\n');

87 
	`va_íd
(
≠
);

88 
	}
}

90 
	$li•_îr‹
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
fmt
, ...)

92 
va_li°
 
≠
;

94 i‡(!
ö°™˚
->
w¨nög
)

96 
	`va_°¨t
(
≠
, 
fmt
);

97 
	`¢d_ouçut_¥ötf
(
ö°™˚
->
eout
, "alispÉrror: ");

98 
	`¢d_ouçut_v¥ötf
(
ö°™˚
->
eout
, 
fmt
, 
≠
);

99 
	`¢d_ouçut_putc
(
ö°™˚
->
eout
, '\n');

100 
	`va_íd
(
≠
);

101 
	}
}

103 
	$li•_w¨n
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
fmt
, ...)

105 
va_li°
 
≠
;

107 i‡(!
ö°™˚
->
w¨nög
)

109 
	`va_°¨t
(
≠
, 
fmt
);

110 
	`¢d_ouçut_¥ötf
(
ö°™˚
->
wout
, "alisp warning: ");

111 
	`¢d_ouçut_v¥ötf
(
ö°™˚
->
wout
, 
fmt
, 
≠
);

112 
	`¢d_ouçut_putc
(
ö°™˚
->
wout
, '\n');

113 
	`va_íd
(
≠
);

114 
	}
}

116 
	$li•_debug
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
fmt
, ...)

118 
va_li°
 
≠
;

120 i‡(!
ö°™˚
->
debug
)

122 
	`va_°¨t
(
≠
, 
fmt
);

123 
	`¢d_ouçut_¥ötf
(
ö°™˚
->
dout
, "alisp debug: ");

124 
	`¢d_ouçut_v¥ötf
(
ö°™˚
->
dout
, 
fmt
, 
≠
);

125 
	`¢d_ouçut_putc
(
ö°™˚
->
dout
, '\n');

126 
	`va_íd
(
≠
);

127 
	}
}

129 
Æi•_obje˘
 * 
	$√w_obje˘
(
Æi•_ö°™˚
 *
ö°™˚
, 
ty≥
)

131 
Æi•_obje˘
 * 
p
;

133 i‡(
	`li°_em±y
(&
ö°™˚
->
‰ì_objs_li°
)) {

134 
p
 = (
Æi•_obje˘
 *)
	`mÆloc
((alisp_object));

135 i‡(
p
 =
NULL
) {

136 
	`nomem
();

137  
NULL
;

139 
	`li•_debug
(
ö°™˚
, "Æloˇtög c⁄†%p", 
p
);

141 
p
 = (
Æi•_obje˘
 *)
ö°™˚
->
‰ì_objs_li°
.
√xt
;

142 
	`li°_dñ
(&
p
->
li°
);

143 
ö°™˚
->
‰ì_objs
--;

144 
	`li•_debug
(
ö°™˚
, "ªcy˛ög c⁄†%p", 
p
);

147 
ö°™˚
->
u£d_objs
++;

149 
	`Æi•_£t_ty≥
(
p
, 
ty≥
);

150 
	`Æi•_£t_ªfs
(
p
, 1);

151 i‡(
ty≥
 =
ALISP_OBJ_CONS
) {

152 
p
->
vÆue
.
c
.
ˇr
 = &
Æß_li•_nû
;

153 
p
->
vÆue
.
c
.
cdr
 = &
Æß_li•_nû
;

154 
	`li°_add
(&
p
->
li°
, &
ö°™˚
->
u£d_objs_li°
[0][
ALISP_OBJ_CONS
]);

157 i‡(
ö°™˚
->
u£d_objs
 + in°™˚->
‰ì_objs
 > in°™˚->
max_objs
)

158 
ö°™˚
->
max_objs
 = in°™˚->
u£d_objs
 + in°™˚->
‰ì_objs
;

160  
p
;

161 
	}
}

163 
	$‰ì_obje˘
(
Æi•_obje˘
 * 
p
)

165 
	`Æi•_gë_ty≥
(
p
)) {

166 
ALISP_OBJ_STRING
:

167 
ALISP_OBJ_IDENTIFIER
:

168 
	`‰ì
(
p
->
vÆue
.
s
);

169 
	`Æi•_£t_ty≥
(
p
, 
ALISP_OBJ_INTEGER
);

174 
	}
}

176 
	$dñëe_obje˘
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
p
)

178 i‡(
p
 =
NULL
 ||Ö =&
Æß_li•_nû
 ||Ö =&
Æß_li•_t
)

180 i‡(
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_NIL
) ||

181 
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_T
))

183 
	`as£π
(
	`Æi•_gë_ªfs
(
p
) > 0);

184 
	`li•_debug
(
ö°™˚
, "dñëêc⁄†%∞—y≥ = %i,Ñef†%iË(†'%s')", 
p
, 
	`Æi•_gë_ty≥
’), 
	`Æi•_gë_ªfs
(p),

185 
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_STRING
) ||

186 
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_IDENTIFIER
Ë?Ö->
vÆue
.
s
 : "???");

187 i‡(
	`Æi•_dec_ªfs
(
p
))

189 
	`li°_dñ
(&
p
->
li°
);

190 
ö°™˚
->
u£d_objs
--;

191 
	`‰ì_obje˘
(
p
);

192 i‡(
ö°™˚
->
‰ì_objs
 >
ALISP_FREE_OBJ_POOL
) {

193 
	`li•_debug
(
ö°™˚
, "‰ìd c⁄†%p", 
p
);

194 
	`‰ì
(
p
);

197 
	`li•_debug
(
ö°™˚
, "moved c⁄†%∞tÿ‰ìÜi°", 
p
);

198 
	`li°_add
(&
p
->
li°
, &
ö°™˚
->
‰ì_objs_li°
);

199 
ö°™˚
->
‰ì_objs
++;

200 
	}
}

202 
	$dñëe_åì
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
p
)

204 i‡(
p
 =
NULL
)

206 i‡(
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_CONS
)) {

207 
	`dñëe_åì
(
ö°™˚
, 
p
->
vÆue
.
c
.
ˇr
);

208 
	`dñëe_åì
(
ö°™˚
, 
p
->
vÆue
.
c
.
cdr
);

210 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

211 
	}
}

213 
Æi•_obje˘
 * 
	$ö¸ef_obje˘
(
Æi•_ö°™˚
 *
ö°™˚
 
ATTRIBUTE_UNUSED
, 
Æi•_obje˘
 * 
p
)

215 i‡(
p
 =
NULL
 ||Ö =&
Æß_li•_nû
 ||Ö =&
Æß_li•_t
)

216  
p
;

217 i‡(
	`Æi•_gë_ªfs
(
p
Ë=
ALISP_MAX_REFS
) {

218 
	`as£π
(0);

219 
	`Ârötf
(
°dîr
, "OOPS:álsaÜisp: incref fatalÉrror\n");

220 
	`exô
(
EXIT_FAILURE
);

222 
	`Æi•_öc_ªfs
(
p
);

223  
p
;

224 
	}
}

226 
Æi•_obje˘
 * 
	$ö¸ef_åì
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
p
)

228 i‡(
p
 =
NULL
)

229  
NULL
;

230 i‡(
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_CONS
)) {

231 
	`ö¸ef_åì
(
ö°™˚
, 
p
->
vÆue
.
c
.
ˇr
);

232 
	`ö¸ef_åì
(
ö°™˚
, 
p
->
vÆue
.
c
.
cdr
);

234  
	`ö¸ef_obje˘
(
ö°™˚
, 
p
);

235 
	}
}

240 
Æi•_obje˘
 * 
	$ö¸ef_åì_ex∂icô
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
p
, Æi•_obje˘ * 
e
)

242 i‡(
p
 =
NULL
)

243  
NULL
;

244 i‡(
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_CONS
)) {

245 i‡(
e
 =
p
) {

246 
	`ö¸ef_åì
(
ö°™˚
, 
p
->
vÆue
.
c
.
ˇr
);

247 
	`ö¸ef_åì
(
ö°™˚
, 
p
->
vÆue
.
c
.
cdr
);

249 
	`ö¸ef_åì_ex∂icô
(
ö°™˚
, 
p
->
vÆue
.
c
.
ˇr
, 
e
);

250 
	`ö¸ef_åì_ex∂icô
(
ö°™˚
, 
p
->
vÆue
.
c
.
cdr
, 
e
);

253 i‡(
e
 =
p
)

254  
	`ö¸ef_obje˘
(
ö°™˚
, 
p
);

255  
p
;

256 
	}
}

259 
	$‰ì_obje˘s
(
Æi•_ö°™˚
 *
ö°™˚
)

261 
li°_hód
 *
pos
, *
pos1
;

262 
Æi•_obje˘
 * 
p
;

263 
Æi•_obje˘_∑ú
 * 
∑ú
;

264 
i
, 
j
;

266 
i
 = 0; i < 
ALISP_OBJ_PAIR_HASH_SIZE
; i++) {

267 
	`li°_f‹_óch_ß„
(
pos
, 
pos1
, &
ö°™˚
->
£tobjs_li°
[
i
]) {

268 
∑ú
 = 
	`li°_íåy
(
pos
, 
Æi•_obje˘_∑ú
, 
li°
);

269 
	`li•_debug
(
ö°™˚
, "‰ìögÖaú: '%s' -> %p", 
∑ú
->
«me
,Öaú->
vÆue
);

270 
	`dñëe_åì
(
ö°™˚
, 
∑ú
->
vÆue
);

271 
	`‰ì
((*)
∑ú
->
«me
);

272 
	`‰ì
(
∑ú
);

275 
i
 = 0; i < 
ALISP_OBJ_PAIR_HASH_SIZE
; i++)

276 
j
 = 0; j <
ALISP_OBJ_LAST_SEARCH
; j++) {

277 
	`li°_f‹_óch_ß„
(
pos
, 
pos1
, &
ö°™˚
->
u£d_objs_li°
[
i
][
j
]) {

278 
p
 = 
	`li°_íåy
(
pos
, 
Æi•_obje˘
, 
li°
);

279 
	`li•_w¨n
(
ö°™˚
, "obje˘ %∞i†°û»ª„ªn˚d %òtimes!", 
p
, 
	`Æi•_gë_ªfs
(p));

281 
	`¢d_ouçut_¥ötf
(
ö°™˚
->
wout
, ">>>> ");

282 
	`¥öc_obje˘
(
ö°™˚
->
wout
, 
p
);

283 
	`¢d_ouçut_¥ötf
(
ö°™˚
->
wout
, " <<<<\n");

285 i‡(
	`Æi•_gë_ªfs
(
p
) > 0)

286 
	`Æi•_£t_ªfs
(
p
, 1);

287 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

290 
	`li°_f‹_óch_ß„
(
pos
, 
pos1
, &
ö°™˚
->
‰ì_objs_li°
) {

291 
p
 = 
	`li°_íåy
(
pos
, 
Æi•_obje˘
, 
li°
);

292 
	`li°_dñ
(&
p
->
li°
);

293 
	`‰ì
(
p
);

294 
	`li•_debug
(
ö°™˚
, "‰ìd (ÆlËc⁄†%p", 
p
);

296 
	}
}

298 
Æi•_obje˘
 * 
	$£¨ch_obje˘_idítifõr
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
s
)

300 
li°_hód
 * 
pos
;

301 
Æi•_obje˘
 * 
p
;

303 
	`li°_f‹_óch
(
pos
, &
ö°™˚
->
u£d_objs_li°
[
	`gë_°rög_hash
(
s
)][
ALISP_OBJ_IDENTIFIER
]) {

304 
p
 = 
	`li°_íåy
(
pos
, 
Æi•_obje˘
, 
li°
);

305 i‡(
	`Æi•_gë_ªfs
(
p
Ë> 
ALISP_MAX_REFS_LIMIT
)

307 i‡(!
	`°rcmp
(
p
->
vÆue
.
s
, s))

308  
	`ö¸ef_obje˘
(
ö°™˚
, 
p
);

311  
NULL
;

312 
	}
}

314 
Æi•_obje˘
 * 
	$£¨ch_obje˘_°rög
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
s
)

316 
li°_hód
 * 
pos
;

317 
Æi•_obje˘
 * 
p
;

319 
	`li°_f‹_óch
(
pos
, &
ö°™˚
->
u£d_objs_li°
[
	`gë_°rög_hash
(
s
)][
ALISP_OBJ_STRING
]) {

320 
p
 = 
	`li°_íåy
(
pos
, 
Æi•_obje˘
, 
li°
);

321 i‡(!
	`°rcmp
(
p
->
vÆue
.
s
, s)) {

322 i‡(
	`Æi•_gë_ªfs
(
p
Ë> 
ALISP_MAX_REFS_LIMIT
)

324  
	`ö¸ef_obje˘
(
ö°™˚
, 
p
);

328  
NULL
;

329 
	}
}

331 
Æi•_obje˘
 * 
	$£¨ch_obje˘_öãgî
(
Æi•_ö°™˚
 *
ö°™˚
, 
ö
)

333 
li°_hód
 * 
pos
;

334 
Æi•_obje˘
 * 
p
;

336 
	`li°_f‹_óch
(
pos
, &
ö°™˚
->
u£d_objs_li°
[
ö
 & 
ALISP_OBJ_PAIR_HASH_MASK
][
ALISP_OBJ_INTEGER
]) {

337 
p
 = 
	`li°_íåy
(
pos
, 
Æi•_obje˘
, 
li°
);

338 i‡(
p
->
vÆue
.
i
 =
ö
) {

339 i‡(
	`Æi•_gë_ªfs
(
p
Ë> 
ALISP_MAX_REFS_LIMIT
)

341  
	`ö¸ef_obje˘
(
ö°™˚
, 
p
);

345  
NULL
;

346 
	}
}

348 
Æi•_obje˘
 * 
	$£¨ch_obje˘_Êﬂt
(
Æi•_ö°™˚
 *
ö°™˚
, 
ö
)

350 
li°_hód
 * 
pos
;

351 
Æi•_obje˘
 * 
p
;

353 
	`li°_f‹_óch
(
pos
, &
ö°™˚
->
u£d_objs_li°
[()
ö
 & 
ALISP_OBJ_PAIR_HASH_MASK
][
ALISP_OBJ_FLOAT
]) {

354 
p
 = 
	`li°_íåy
(
pos
, 
Æi•_obje˘
, 
li°
);

355 i‡(
p
->
vÆue
.
i
 =
ö
) {

356 i‡(
	`Æi•_gë_ªfs
(
p
Ë> 
ALISP_MAX_REFS_LIMIT
)

358  
	`ö¸ef_obje˘
(
ö°™˚
, 
p
);

362  
NULL
;

363 
	}
}

365 
Æi•_obje˘
 * 
	$£¨ch_obje˘_poöãr
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
±r
)

367 
li°_hód
 * 
pos
;

368 
Æi•_obje˘
 * 
p
;

370 
	`li°_f‹_óch
(
pos
, &
ö°™˚
->
u£d_objs_li°
[()
±r
 & 
ALISP_OBJ_PAIR_HASH_MASK
][
ALISP_OBJ_POINTER
]) {

371 
p
 = 
	`li°_íåy
(
pos
, 
Æi•_obje˘
, 
li°
);

372 i‡(
p
->
vÆue
.
±r
 ==Ötr) {

373 i‡(
	`Æi•_gë_ªfs
(
p
Ë> 
ALISP_MAX_REFS_LIMIT
)

375  
	`ö¸ef_obje˘
(
ö°™˚
, 
p
);

379  
NULL
;

380 
	}
}

382 
Æi•_obje˘
 * 
	$√w_öãgî
(
Æi•_ö°™˚
 *
ö°™˚
, 
vÆue
)

384 
Æi•_obje˘
 * 
obj
;

386 
obj
 = 
	`£¨ch_obje˘_öãgî
(
ö°™˚
, 
vÆue
);

387 i‡(
obj
 !
NULL
)

388  
obj
;

389 
obj
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_INTEGER
);

390 i‡(
obj
) {

391 
	`li°_add
(&
obj
->
li°
, &
ö°™˚
->
u£d_objs_li°
[
vÆue
 & 
ALISP_OBJ_PAIR_HASH_MASK
][
ALISP_OBJ_INTEGER
]);

392 
obj
->
vÆue
.
i
 = value;

394  
obj
;

395 
	}
}

397 
Æi•_obje˘
 * 
	$√w_Êﬂt
(
Æi•_ö°™˚
 *
ö°™˚
, 
vÆue
)

399 
Æi•_obje˘
 * 
obj
;

401 
obj
 = 
	`£¨ch_obje˘_Êﬂt
(
ö°™˚
, 
vÆue
);

402 i‡(
obj
 !
NULL
)

403  
obj
;

404 
obj
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_FLOAT
);

405 i‡(
obj
) {

406 
	`li°_add
(&
obj
->
li°
, &
ö°™˚
->
u£d_objs_li°
[()
vÆue
 & 
ALISP_OBJ_PAIR_HASH_MASK
][
ALISP_OBJ_FLOAT
]);

407 
obj
->
vÆue
.
f
 = value;

409  
obj
;

410 
	}
}

412 
Æi•_obje˘
 * 
	$√w_°rög
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
°r
)

414 
Æi•_obje˘
 * 
obj
;

416 
obj
 = 
	`£¨ch_obje˘_°rög
(
ö°™˚
, 
°r
);

417 i‡(
obj
 !
NULL
)

418  
obj
;

419 
obj
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_STRING
);

420 i‡(
obj
)

421 
	`li°_add
(&
obj
->
li°
, &
ö°™˚
->
u£d_objs_li°
[
	`gë_°rög_hash
(
°r
)][
ALISP_OBJ_STRING
]);

422 i‡(
obj
 && (obj->
vÆue
.
s
 = 
	`°rdup
(
°r
)Ë=
NULL
) {

423 
	`dñëe_obje˘
(
ö°™˚
, 
obj
);

424 
	`nomem
();

425  
NULL
;

427  
obj
;

428 
	}
}

430 
Æi•_obje˘
 * 
	$√w_idítifõr
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
id
)

432 
Æi•_obje˘
 * 
obj
;

434 
obj
 = 
	`£¨ch_obje˘_idítifõr
(
ö°™˚
, 
id
);

435 i‡(
obj
 !
NULL
)

436  
obj
;

437 
obj
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_IDENTIFIER
);

438 i‡(
obj
)

439 
	`li°_add
(&
obj
->
li°
, &
ö°™˚
->
u£d_objs_li°
[
	`gë_°rög_hash
(
id
)][
ALISP_OBJ_IDENTIFIER
]);

440 i‡(
obj
 && (obj->
vÆue
.
s
 = 
	`°rdup
(
id
)Ë=
NULL
) {

441 
	`dñëe_obje˘
(
ö°™˚
, 
obj
);

442 
	`nomem
();

443  
NULL
;

445  
obj
;

446 
	}
}

448 
Æi•_obje˘
 * 
	$√w_poöãr
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
±r
)

450 
Æi•_obje˘
 * 
obj
;

452 
obj
 = 
	`£¨ch_obje˘_poöãr
(
ö°™˚
, 
±r
);

453 i‡(
obj
 !
NULL
)

454  
obj
;

455 
obj
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_POINTER
);

456 i‡(
obj
) {

457 
	`li°_add
(&
obj
->
li°
, &
ö°™˚
->
u£d_objs_li°
[()
±r
 & 
ALISP_OBJ_PAIR_HASH_MASK
][
ALISP_OBJ_POINTER
]);

458 
obj
->
vÆue
.
±r
 =Ötr;

460  
obj
;

461 
	}
}

463 
Æi•_obje˘
 * 
	$√w_c⁄s_poöãr
(
Æi•_ö°™˚
 * 
ö°™˚
, c⁄° *
±r_id
, *
±r
)

465 
Æi•_obje˘
 * 
Àx¥
;

467 i‡(
±r
 =
NULL
)

468  &
Æß_li•_nû
;

469 
Àx¥
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

470 i‡(
Àx¥
 =
NULL
)

471  
NULL
;

472 
Àx¥
->
vÆue
.
c
.
ˇr
 = 
	`√w_°rög
(
ö°™˚
, 
±r_id
);

473 i‡(
Àx¥
->
vÆue
.
c
.
ˇr
 =
NULL
)

474 
__íd
;

475 
Àx¥
->
vÆue
.
c
.
cdr
 = 
	`√w_poöãr
(
ö°™˚
, 
±r
);

476 i‡(
Àx¥
->
vÆue
.
c
.
cdr
 =
NULL
) {

477 
	`dñëe_obje˘
(
ö°™˚
, 
Àx¥
->
vÆue
.
c
.
ˇr
);

478 
__íd
:

479 
	`dñëe_obje˘
(
ö°™˚
, 
Àx¥
);

480  
NULL
;

482  
Àx¥
;

483 
	}
}

485 
	$Æß_li•_öô_obje˘s
(Ë
	`__©åibuã__
 ((
c⁄°ru˘‹
));

487 
	$Æß_li•_öô_obje˘s
()

489 
	`mem£t
(&
Æß_li•_nû
, 0, (alsa_lisp_nil));

490 
	`Æi•_£t_ty≥
(&
Æß_li•_nû
, 
ALISP_OBJ_NIL
);

491 
	`INIT_LIST_HEAD
(&
Æß_li•_nû
.
li°
);

492 
	`mem£t
(&
Æß_li•_t
, 0, (alsa_lisp_t));

493 
	`Æi•_£t_ty≥
(&
Æß_li•_t
, 
ALISP_OBJ_T
);

494 
	`INIT_LIST_HEAD
(&
Æß_li•_t
.
li°
);

495 
	}
}

501 
	$xgëc
(
Æi•_ö°™˚
 *
ö°™˚
)

503 
ö°™˚
->
ch¨no
++;

504 i‡(
ö°™˚
->
Àx_buÂ
 > in°™˚->
Àx_buf
)

505  *--(
ö°™˚
->
Àx_buÂ
);

506  
	`¢d_öput_gëc
(
ö°™˚
->
ö
);

507 
	}
}

509 
ölöe
 
	$xungëc
(
Æi•_ö°™˚
 *
ö°™˚
, 
c
)

511 *(
ö°™˚
->
Àx_buÂ
)++ = 
c
;

512 
ö°™˚
->
ch¨no
--;

513 
	}
}

515 
	$öô_Àx
(
Æi•_ö°™˚
 *
ö°™˚
)

517 
ö°™˚
->
ch¨no
 = in°™˚->
löío
 = 1;

518 
ö°™˚
->
tokí_buf„r_max
 = 10;

519 i‡((
ö°™˚
->
tokí_buf„r
 = (*)
	`mÆloc
(ö°™˚->
tokí_buf„r_max
)Ë=
NULL
) {

520 
	`nomem
();

521  -
ENOMEM
;

523 
ö°™˚
->
Àx_buÂ
 = in°™˚->
Àx_buf
;

525 
	}
}

527 
	$d⁄e_Àx
(
Æi•_ö°™˚
 *
ö°™˚
)

529 
	`‰ì
(
ö°™˚
->
tokí_buf„r
);

530 
	}
}

532 * 
	$exãnd_buf
(
Æi•_ö°™˚
 *
ö°™˚
, *
p
)

534 
off
 = 
p
 - 
ö°™˚
->
tokí_buf„r
;

536 
ö°™˚
->
tokí_buf„r_max
 += 10;

537 
ö°™˚
->
tokí_buf„r
 = (*)
	`ªÆloc
(ö°™˚->tokí_buf„r, in°™˚->
tokí_buf„r_max
);

538 i‡(
ö°™˚
->
tokí_buf„r
 =
NULL
) {

539 
	`nomem
();

540  
NULL
;

543  
ö°™˚
->
tokí_buf„r
 + 
off
;

544 
	}
}

546 
	$gëtokí
(
Æi•_ö°™˚
 *
ö°™˚
)

548 *
p
;

549 
c
;

552 
c
 = 
	`xgëc
(
ö°™˚
);

553 
c
) {

555 ++
ö°™˚
->
löío
;

563 (
c
 = 
	`xgëc
(
ö°™˚
)Ë!'\n' && c !
EOF
)

565 i‡(
c
 !
EOF
)

566 ++
ö°™˚
->
löío
;

571 
c
 = 
	`xgëc
(
ö°™˚
);

572 
	`•rötf
(
ö°™˚
->
tokí_buf„r
, "%d", 
c
);

573  
ö°™˚
->
thi°okí
 = 
ALISP_INTEGER
;

577 
c
 = 
	`xgëc
(
ö°™˚
);

578 i‡(!
	`isdigô
(
c
)) {

579 
	`xungëc
(
ö°™˚
, 
c
);

580 
c
 = '-';

581 
gŸ_id
;

583 
	`xungëc
(
ö°™˚
, 
c
);

584 
c
 = '-';

592 
p
 = 
ö°™˚
->
tokí_buf„r
;

593 
ö°™˚
->
thi°okí
 = 
ALISP_INTEGER
;

595 
__ok
:

596 i‡(
p
 - 
ö°™˚
->
tokí_buf„r
 >ö°™˚->
tokí_buf„r_max
 - 1) {

597 
p
 = 
	`exãnd_buf
(
ö°™˚
,Ö);

598 i‡(
p
 =
NULL
)

599  
ö°™˚
->
thi°okí
 = 
EOF
;

601 *
p
++ = 
c
;

602 
c
 = 
	`xgëc
(
ö°™˚
);

603 i‡(
c
 ='.' && 
ö°™˚
->
thi°okí
 =
ALISP_INTEGER
) {

604 
c
 = 
	`xgëc
(
ö°™˚
);

605 
	`xungëc
(
ö°™˚
, 
c
);

606 i‡(
	`isdigô
(
c
)) {

607 
ö°™˚
->
thi°okí
 = 
ALISP_FLOAT
;

608 
c
 = '.';

609 
__ok
;

611 
c
 = '.';

613 } i‡(
c
 ='e' && 
ö°™˚
->
thi°okí
 =
ALISP_FLOAT
) {

614 
c
 = 
	`xgëc
(
ö°™˚
);

615 i‡(
	`isdigô
(
c
)) {

616 
ö°™˚
->
thi°okí
 = 
ALISP_FLOATE
;

617 
__ok
;

620 } 
	`isdigô
(
c
));

621 
	`xungëc
(
ö°™˚
, 
c
);

622 *
p
 = '\0';

623  
ö°™˚
->
thi°okí
;

625 
gŸ_id
:

639 
p
 = 
ö°™˚
->
tokí_buf„r
;

641 i‡(
p
 - 
ö°™˚
->
tokí_buf„r
 >ö°™˚->
tokí_buf„r_max
 - 1) {

642 
p
 = 
	`exãnd_buf
(
ö°™˚
,Ö);

643 i‡(
p
 =
NULL
)

644  
ö°™˚
->
thi°okí
 = 
EOF
;

646 *
p
++ = 
c
;

647 
c
 = 
	`xgëc
(
ö°™˚
);

648 } 
	`iß um
(
c
Ë|| 
	`°rchr
("!_-+*/%<>=&", cË!
NULL
);

649 
	`xungëc
(
ö°™˚
, 
c
);

650 *
p
 = '\0';

651  
ö°™˚
->
thi°okí
 = 
ALISP_IDENTIFIER
;

655 
p
 = 
ö°™˚
->
tokí_buf„r
;

656 (
c
 = 
	`xgëc
(
ö°™˚
)Ë!'"' && c !
EOF
) {

657 i‡(
p
 - 
ö°™˚
->
tokí_buf„r
 >ö°™˚->
tokí_buf„r_max
 - 1) {

658 
p
 = 
	`exãnd_buf
(
ö°™˚
,Ö);

659 i‡(
p
 =
NULL
)

660  
ö°™˚
->
thi°okí
 = 
EOF
;

662 i‡(
c
 == '\\') {

663 
c
 = 
	`xgëc
(
ö°™˚
);

664 
c
) {

665 '\n': ++
ö°™˚
->
löío
; ;

666 'a': *
p
++ = '\a'; ;

667 'b': *
p
++ = '\b'; ;

668 'f': *
p
++ = '\f'; ;

669 'n': *
p
++ = '\n'; ;

670 'r': *
p
++ = '\r'; ;

671 't': *
p
++ = '\t'; ;

672 'v': *
p
++ = '\v'; ;

673 : *
p
++ = 
c
;

676 i‡(
c
 == '\n')

677 ++
ö°™˚
->
löío
;

678 *
p
++ = 
c
;

681 *
p
 = '\0';

682  
ö°™˚
->
thi°okí
 = 
ALISP_STRING
;

685  
ö°™˚
->
thi°okí
 = 
c
;

688 
	}
}

694 
Æi•_obje˘
 * 
	$∑r£_f‹m
(
Æi•_ö°™˚
 *
ö°™˚
)

696 
thi°okí
;

697 
Æi•_obje˘
 * 
p
, * 
fú°
 = 
NULL
, * 
¥ev
 = NULL;

699 (
thi°okí
 = 
	`gëtokí
(
ö°™˚
)Ë!')' &&Åhi°okí !
EOF
) {

703 i‡(
thi°okí
 == '.') {

704 
	`gëtokí
(
ö°™˚
);

705 i‡(
¥ev
 =
NULL
) {

706 
	`li•_îr‹
(
ö°™˚
, "unexpected '.'");

707 
__îr
:

708 
	`dñëe_åì
(
ö°™˚
, 
fú°
);

709  
NULL
;

711 
¥ev
->
vÆue
.
c
.
cdr
 = 
	`∑r£_obje˘
(
ö°™˚
, 1);

712 i‡(
¥ev
->
vÆue
.
c
.
cdr
 =
NULL
)

713 
__îr
;

714 i‡((
thi°okí
 = 
	`gëtokí
(
ö°™˚
)) != ')') {

715 
	`li•_îr‹
(
ö°™˚
, "expected ')'");

716 
__îr
;

721 
p
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

722 i‡(
p
 =
NULL
)

723 
__îr
;

725 i‡(
fú°
 =
NULL
)

726 
fú°
 = 
p
;

727 i‡(
¥ev
 !
NULL
)

728 
¥ev
->
vÆue
.
c
.
cdr
 = 
p
;

730 
p
->
vÆue
.
c
.
ˇr
 = 
	`∑r£_obje˘
(
ö°™˚
, 1);

731 i‡(
p
->
vÆue
.
c
.
ˇr
 =
NULL
)

732 
__îr
;

734 
¥ev
 = 
p
;

737 i‡(
fú°
 =
NULL
)

738  &
Æß_li•_nû
;

740  
fú°
;

741 
	}
}

743 
Æi•_obje˘
 * 
	$quŸe_obje˘
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
obj
)

745 
Æi•_obje˘
 * 
p
;

747 i‡(
obj
 =
NULL
)

748 
__íd1
;

750 
p
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

751 i‡(
p
 =
NULL
)

752 
__íd1
;

754 
p
->
vÆue
.
c
.
ˇr
 = 
	`√w_idítifõr
(
ö°™˚
, "quote");

755 i‡(
p
->
vÆue
.
c
.
ˇr
 =
NULL
)

756 
__íd
;

757 
p
->
vÆue
.
c
.
cdr
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

758 i‡(
p
->
vÆue
.
c
.
cdr
 =
NULL
) {

759 
	`dñëe_obje˘
(
ö°™˚
, 
p
->
vÆue
.
c
.
ˇr
);

760 
__íd
:

761 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

762 
__íd1
:

763 
	`dñëe_åì
(
ö°™˚
, 
obj
);

764  
NULL
;

767 
p
->
vÆue
.
c
.
cdr
->vÆue.c.
ˇr
 = 
obj
;

768  
p
;

769 
	}
}

771 
ölöe
 
Æi•_obje˘
 * 
	$∑r£_quŸe
(
Æi•_ö°™˚
 *
ö°™˚
)

773  
	`quŸe_obje˘
(
ö°™˚
, 
	`∑r£_obje˘
(instance, 0));

774 
	}
}

776 
Æi•_obje˘
 * 
	$∑r£_obje˘
(
Æi•_ö°™˚
 *
ö°™˚
, 
havëokí
)

778 
thi°okí
;

779 
Æi•_obje˘
 * 
p
 = 
NULL
;

781 i‡(!
havëokí
)

782 
thi°okí
 = 
	`gëtokí
(
ö°™˚
);

784 
thi°okí
 = 
ö°™˚
->thistoken;

786 
thi°okí
) {

787 
EOF
:

790 
p
 = 
	`∑r£_f‹m
(
ö°™˚
);

793 
p
 = 
	`∑r£_quŸe
(
ö°™˚
);

795 
ALISP_IDENTIFIER
:

796 i‡(!
	`°rcmp
(
ö°™˚
->
tokí_buf„r
, "t"))

797 
p
 = &
Æß_li•_t
;

798 i‡(!
	`°rcmp
(
ö°™˚
->
tokí_buf„r
, "nil"))

799 
p
 = &
Æß_li•_nû
;

801 
p
 = 
	`√w_idítifõr
(
ö°™˚
, in°™˚->
tokí_buf„r
);

804 
ALISP_INTEGER
: {

805 
p
 = 
	`√w_öãgî
(
ö°™˚
, 
	`©ﬁ
(ö°™˚->
tokí_buf„r
));

808 
ALISP_FLOAT
:

809 
ALISP_FLOATE
: {

810 
p
 = 
	`√w_Êﬂt
(
ö°™˚
, 
	`©of
(ö°™˚->
tokí_buf„r
));

813 
ALISP_STRING
:

814 
p
 = 
	`√w_°rög
(
ö°™˚
, in°™˚->
tokí_buf„r
);

817 
	`li•_w¨n
(
ö°™˚
, "%d:%d: u√x≥˘ed ch¨a˘î `%c'", in°™˚->
löío
, in°™˚->
ch¨no
, 
thi°okí
);

821  
p
;

822 
	}
}

828 
Æi•_obje˘_∑ú
 * 
	$£t_obje˘_dúe˘
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
«me
, Æi•_obje˘ * 
vÆue
)

830 
Æi•_obje˘_∑ú
 *
p
;

831 c⁄° *
id
;

833 
id
 = 
«me
->
vÆue
.
s
;

834 
p
 = (
Æi•_obje˘_∑ú
 *)
	`mÆloc
((alisp_object_pair));

835 i‡(
p
 =
NULL
) {

836 
	`nomem
();

837  
NULL
;

839 
p
->
«me
 = 
	`°rdup
(
id
);

840 i‡(
p
->
«me
 =
NULL
) {

841 
	`dñëe_åì
(
ö°™˚
, 
vÆue
);

842 
	`‰ì
(
p
);

843  
NULL
;

845 
	`li°_add
(&
p
->
li°
, &
ö°™˚
->
£tobjs_li°
[
	`gë_°rög_hash
(
id
)]);

846 
p
->
vÆue
 = value;

847  
p
;

848 
	}
}

850 
	$check_£t_obje˘
(
Æi•_ö°™˚
 * 
ö°™˚
, 
Æi•_obje˘
 * 
«me
)

852 i‡(
«me
 =&
Æß_li•_nû
) {

853 
	`li•_w¨n
(
ö°™˚
, "settingÅhe value ofáÇil object");

856 i‡(
«me
 =&
Æß_li•_t
) {

857 
	`li•_w¨n
(
ö°™˚
, "settingÅhe value ofáÅ object");

860 i‡(!
	`Æi•_com∑ª_ty≥
(
«me
, 
ALISP_OBJ_IDENTIFIER
) &&

861 !
	`Æi•_com∑ª_ty≥
(
«me
, 
ALISP_OBJ_STRING
)) {

862 
	`li•_w¨n
(
ö°™˚
, "settingÅhe value ofán object withÇon-indentifier");

866 
	}
}

868 
Æi•_obje˘_∑ú
 * 
	$£t_obje˘
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
«me
, Æi•_obje˘ * 
vÆue
)

870 
li°_hód
 *
pos
;

871 
Æi•_obje˘_∑ú
 *
p
;

872 c⁄° *
id
;

874 i‡(
«me
 =
NULL
 || 
vÆue
 == NULL)

875  
NULL
;

877 
id
 = 
«me
->
vÆue
.
s
;

879 
	`li°_f‹_óch
(
pos
, &
ö°™˚
->
£tobjs_li°
[
	`gë_°rög_hash
(
id
)]) {

880 
p
 = 
	`li°_íåy
(
pos
, 
Æi•_obje˘_∑ú
, 
li°
);

881 i‡(!
	`°rcmp
(
p
->
«me
, 
id
)) {

882 
	`dñëe_åì
(
ö°™˚
, 
p
->
vÆue
);

883 
p
->
vÆue
 = value;

884  
p
;

888 
p
 = (
Æi•_obje˘_∑ú
 *)
	`mÆloc
((alisp_object_pair));

889 i‡(
p
 =
NULL
) {

890 
	`nomem
();

891  
NULL
;

893 
p
->
«me
 = 
	`°rdup
(
id
);

894 i‡(
p
->
«me
 =
NULL
) {

895 
	`dñëe_åì
(
ö°™˚
, 
vÆue
);

896 
	`‰ì
(
p
);

897  
NULL
;

899 
	`li°_add
(&
p
->
li°
, &
ö°™˚
->
£tobjs_li°
[
	`gë_°rög_hash
(
id
)]);

900 
p
->
vÆue
 = value;

901  
p
;

902 
	}
}

904 
Æi•_obje˘
 * 
	$un£t_obje˘
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
«me
)

906 
li°_hód
 *
pos
;

907 
Æi•_obje˘
 *
ªs
;

908 
Æi•_obje˘_∑ú
 *
p
;

909 c⁄° *
id
;

911 i‡(!
	`Æi•_com∑ª_ty≥
(
«me
, 
ALISP_OBJ_IDENTIFIER
) &&

912 !
	`Æi•_com∑ª_ty≥
(
«me
, 
ALISP_OBJ_STRING
)) {

913 
	`li•_w¨n
(
ö°™˚
, "unset object witháÇon-indentifier");

914  &
Æß_li•_nû
;

916 
id
 = 
«me
->
vÆue
.
s
;

918 
	`li°_f‹_óch
(
pos
, &
ö°™˚
->
£tobjs_li°
[
	`gë_°rög_hash
(
id
)]) {

919 
p
 = 
	`li°_íåy
(
pos
, 
Æi•_obje˘_∑ú
, 
li°
);

920 i‡(!
	`°rcmp
(
p
->
«me
, 
id
)) {

921 
	`li°_dñ
(&
p
->
li°
);

922 
ªs
 = 
p
->
vÆue
;

923 
	`‰ì
((*)
p
->
«me
);

924 
	`‰ì
(
p
);

925  
ªs
;

929  &
Æß_li•_nû
;

930 
	}
}

932 
Æi•_obje˘
 * 
	$gë_obje˘1
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
id
)

934 
Æi•_obje˘_∑ú
 *
p
;

935 
li°_hód
 *
pos
;

937 
	`li°_f‹_óch
(
pos
, &
ö°™˚
->
£tobjs_li°
[
	`gë_°rög_hash
(
id
)]) {

938 
p
 = 
	`li°_íåy
(
pos
, 
Æi•_obje˘_∑ú
, 
li°
);

939 i‡(!
	`°rcmp
(
p
->
«me
, 
id
))

940  
p
->
vÆue
;

943  &
Æß_li•_nû
;

944 
	}
}

946 
Æi•_obje˘
 * 
	$gë_obje˘
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
«me
)

948 i‡(!
	`Æi•_com∑ª_ty≥
(
«me
, 
ALISP_OBJ_IDENTIFIER
) &&

949 !
	`Æi•_com∑ª_ty≥
(
«me
, 
ALISP_OBJ_STRING
)) {

950 
	`dñëe_åì
(
ö°™˚
, 
«me
);

951  &
Æß_li•_nû
;

953  
	`gë_obje˘1
(
ö°™˚
, 
«me
->
vÆue
.
s
);

954 
	}
}

956 
Æi•_obje˘
 * 
	$ª∂a˚_obje˘
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
«me
, Æi•_obje˘ * 
⁄ew
)

958 
Æi•_obje˘_∑ú
 *
p
;

959 
Æi•_obje˘
 *
r
;

960 
li°_hód
 *
pos
;

961 c⁄° *
id
;

963 i‡(!
	`Æi•_com∑ª_ty≥
(
«me
, 
ALISP_OBJ_IDENTIFIER
) &&

964 !
	`Æi•_com∑ª_ty≥
(
«me
, 
ALISP_OBJ_STRING
)) {

965 
	`dñëe_åì
(
ö°™˚
, 
«me
);

966  &
Æß_li•_nû
;

968 
id
 = 
«me
->
vÆue
.
s
;

969 
	`li°_f‹_óch
(
pos
, &
ö°™˚
->
£tobjs_li°
[
	`gë_°rög_hash
(
id
)]) {

970 
p
 = 
	`li°_íåy
(
pos
, 
Æi•_obje˘_∑ú
, 
li°
);

971 i‡(!
	`°rcmp
(
p
->
«me
, 
id
)) {

972 
r
 = 
p
->
vÆue
;

973 
p
->
vÆue
 = 
⁄ew
;

974  
r
;

978  
NULL
;

979 
	}
}

981 
	$dump_obje˘s
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
‚ame
)

983 
Æi•_obje˘_∑ú
 *
p
;

984 
¢d_ouçut_t
 *
out
;

985 
li°_hód
 *
pos
;

986 
i
, 
îr
;

988 i‡(!
	`°rcmp
(
‚ame
, "-"))

989 
îr
 = 
	`¢d_ouçut_°dio_©èch
(&
out
, 
°dout
, 0);

991 
îr
 = 
	`¢d_ouçut_°dio_›í
(&
out
, 
‚ame
, "w+");

992 i‡(
îr
 < 0) {

993 
	`SNDERR
("Æi•: c™nŸ o≥¿fûê'%s' f‹ wrôög (%s)", 
‚ame
, 
	`¢d_°ªº‹
(
î∫o
));

997 
i
 = 0; i < 
ALISP_OBJ_PAIR_HASH_SIZE
; i++) {

998 
	`li°_f‹_óch
(
pos
, &
ö°™˚
->
£tobjs_li°
[
i
]) {

999 
p
 = 
	`li°_íåy
(
pos
, 
Æi•_obje˘_∑ú
, 
li°
);

1000 i‡(
	`Æi•_com∑ª_ty≥
(
p
->
vÆue
, 
ALISP_OBJ_CONS
) &&

1001 
	`Æi•_com∑ª_ty≥
(
p
->
vÆue
->vÆue.
c
.
ˇr
, 
ALISP_OBJ_IDENTIFIER
) &&

1002 !
	`°rcmp
(
p
->
vÆue
->vÆue.
c
.
ˇr
->vÆue.
s
, "lambda")) {

1003 
	`¢d_ouçut_¥ötf
(
out
, "(defu¿%†", 
p
->
«me
);

1004 
	`¥öc_c⁄s
(
out
, 
p
->
vÆue
->vÆue.
c
.
cdr
);

1005 
	`¢d_ouçut_¥ötf
(
out
, ")\n");

1008 
	`¢d_ouçut_¥ötf
(
out
, "(£tq %†'", 
p
->
«me
);

1009 
	`¥öc_obje˘
(
out
, 
p
->
vÆue
);

1010 
	`¢d_ouçut_¥ötf
(
out
, ")\n");

1013 
	`¢d_ouçut_˛o£
(
out
);

1014 
	}
}

1016 c⁄° *
	$obj_ty≥_°r
(
Æi•_obje˘
 * 
p
)

1018 
	`Æi•_gë_ty≥
(
p
)) {

1019 
ALISP_OBJ_NIL
:  "nil";

1020 
ALISP_OBJ_T
:  "t";

1021 
ALISP_OBJ_INTEGER
:  "integer";

1022 
ALISP_OBJ_FLOAT
:  "float";

1023 
ALISP_OBJ_IDENTIFIER
:  "identifier";

1024 
ALISP_OBJ_STRING
:  "string";

1025 
ALISP_OBJ_POINTER
:  "pointer";

1026 
ALISP_OBJ_CONS
:  "cons";

1027 : 
	`as£π
(0);

1029 
	}
}

1031 
	$¥öt_obj_li°s
(
Æi•_ö°™˚
 *
ö°™˚
, 
¢d_ouçut_t
 *
out
)

1033 
li°_hód
 *
pos
;

1034 
Æi•_obje˘
 * 
p
;

1035 
i
, 
j
;

1037 
	`¢d_ouçut_¥ötf
(
out
, "** used objects\n");

1038 
i
 = 0; i < 
ALISP_OBJ_PAIR_HASH_SIZE
; i++)

1039 
j
 = 0; j <
ALISP_OBJ_LAST_SEARCH
; j++)

1040 
	`li°_f‹_óch
(
pos
, &
ö°™˚
->
u£d_objs_li°
[
i
][
j
]) {

1041 
p
 = 
	`li°_íåy
(
pos
, 
Æi•_obje˘
, 
li°
);

1042 
	`¢d_ouçut_¥ötf
(
out
, "** %∞(%sË(", 
p
, 
	`obj_ty≥_°r
(p));

1043 i‡(!
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_CONS
))

1044 
	`¥öc_obje˘
(
out
, 
p
);

1046 
	`¢d_ouçut_¥ötf
(
out
, "cons");

1047 
	`¢d_ouçut_¥ötf
(
out
, "Ëªfs=%i\n", 
	`Æi•_gë_ªfs
(
p
));

1049 
	`¢d_ouçut_¥ötf
(
out
, "** free objects\n");

1050 
	`li°_f‹_óch
(
pos
, &
ö°™˚
->
‰ì_objs_li°
) {

1051 
p
 = 
	`li°_íåy
(
pos
, 
Æi•_obje˘
, 
li°
);

1052 
	`¢d_ouçut_¥ötf
(
out
, "** %p\n", 
p
);

1054 
	}
}

1056 
	$dump_obj_li°s
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
‚ame
)

1058 
¢d_ouçut_t
 *
out
;

1059 
îr
;

1061 i‡(!
	`°rcmp
(
‚ame
, "-"))

1062 
îr
 = 
	`¢d_ouçut_°dio_©èch
(&
out
, 
°dout
, 0);

1064 
îr
 = 
	`¢d_ouçut_°dio_›í
(&
out
, 
‚ame
, "w+");

1065 i‡(
îr
 < 0) {

1066 
	`SNDERR
("Æi•: c™nŸ o≥¿fûê'%s' f‹ wrôög (%s)", 
‚ame
, 
	`¢d_°ªº‹
(
î∫o
));

1070 
	`¥öt_obj_li°s
(
ö°™˚
, 
out
);

1072 
	`¢d_ouçut_˛o£
(
out
);

1073 
	}
}

1079 
	$cou¡_li°
(
Æi•_obje˘
 * 
p
)

1081 
i
 = 0;

1083 
p
 !&
Æß_li•_nû
 && 
	`Æi•_com∑ª_ty≥
’, 
ALISP_OBJ_CONS
)) {

1084 
p
 =Ö->
vÆue
.
c
.
cdr
;

1085 ++
i
;

1088  
i
;

1089 
	}
}

1091 
ölöe
 
Æi•_obje˘
 * 
	$ˇr
(
Æi•_obje˘
 * 
p
)

1093 i‡(
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_CONS
))

1094  
p
->
vÆue
.
c
.
ˇr
;

1096  &
Æß_li•_nû
;

1097 
	}
}

1099 
ölöe
 
Æi•_obje˘
 * 
	$cdr
(
Æi•_obje˘
 * 
p
)

1101 i‡(
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_CONS
))

1102  
p
->
vÆue
.
c
.
cdr
;

1104  &
Æß_li•_nû
;

1105 
	}
}

1110 
Æi•_obje˘
 * 
	$F_ˇr
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1112 
Æi•_obje˘
 *
p1
 = 
	`ˇr
(
¨gs
), *
p2
;

1113 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

1114 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

1115 
p1
 = 
	`evÆ
(
ö°™˚
,Ö1);

1116 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
p1
));

1117 
p2
 = 
	`ˇr
(
p1
);

1118 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

1119  
p2
;

1120 
	}
}

1125 
Æi•_obje˘
 * 
	$F_cdr
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1127 
Æi•_obje˘
 *
p1
 = 
	`ˇr
(
¨gs
), *
p2
;

1128 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

1129 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

1130 
p1
 = 
	`evÆ
(
ö°™˚
,Ö1);

1131 
	`dñëe_åì
(
ö°™˚
, 
	`ˇr
(
p1
));

1132 
p2
 = 
	`cdr
(
p1
);

1133 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

1134  
p2
;

1135 
	}
}

1140 
Æi•_obje˘
 * 
	$F_add
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1142 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
p1
, * 
n
;

1143 
v
 = 0;

1144 
f
 = 0;

1145 
ty≥
 = 
ALISP_OBJ_INTEGER
;

1147 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

1149 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
)) {

1150 i‡(
ty≥
 =
ALISP_OBJ_FLOAT
)

1151 
f
 +
p1
->
vÆue
.
i
;

1153 
v
 +
p1
->
vÆue
.
i
;

1154 } i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_FLOAT
)) {

1155 
f
 +
p1
->
vÆue
.‡+ 
v
;

1156 
v
 = 0;

1157 
ty≥
 = 
ALISP_OBJ_FLOAT
;

1159 
	`li•_w¨n
(
ö°™˚
, "sum witháÇon integer or float operand");

1161 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1162 
p
 = 
	`cdr
(
n
 =Ö);

1163 
	`dñëe_obje˘
(
ö°™˚
, 
n
);

1164 i‡(
p
 =&
Æß_li•_nû
)

1166 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

1168 i‡(
ty≥
 =
ALISP_OBJ_INTEGER
) {

1169  
	`√w_öãgî
(
ö°™˚
, 
v
);

1171  
	`√w_Êﬂt
(
ö°™˚
, 
f
);

1173 
	}
}

1178 
Æi•_obje˘
 * 
	$F_c⁄ˇt
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1180 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
p1
, * 
n
;

1181 *
°r
 = 
NULL
, *
°r1
;

1183 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

1185 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_STRING
)) {

1186 
°r1
 = 
	`ªÆloc
(
°r
, (°∏? 
	`°æí
(°rË: 0Ë+ såÀn(
p1
->
vÆue
.
s
) + 1);

1187 i‡(
°r1
 =
NULL
) {

1188 
	`nomem
();

1189 
	`‰ì
(
°r
);

1190  
NULL
;

1192 i‡(
°r
 =
NULL
)

1193 
	`°r˝y
(
°r1
, 
p1
->
vÆue
.
s
);

1195 
	`°rˇt
(
°r1
, 
p1
->
vÆue
.
s
);

1196 
°r
 = 
°r1
;

1198 
	`li•_w¨n
(
ö°™˚
, "concat witháÇon string or identifier operand");

1200 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1201 
p
 = 
	`cdr
(
n
 =Ö);

1202 
	`dñëe_obje˘
(
ö°™˚
, 
n
);

1203 i‡(
p
 =&
Æß_li•_nû
)

1205 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

1207 i‡(
°r
) {

1208 
p
 = 
	`√w_°rög
(
ö°™˚
, 
°r
);

1209 
	`‰ì
(
°r
);

1211 
p
 = &
Æß_li•_nû
;

1213  
p
;

1214 
	}
}

1219 
Æi•_obje˘
 * 
	$F_sub
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1221 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
p1
, * 
n
;

1222 
v
 = 0;

1223 
f
 = 0;

1224 
ty≥
 = 
ALISP_OBJ_INTEGER
;

1227 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

1228 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
)) {

1229 i‡(
p
 =
¨gs
 && 
	`cdr
’Ë!&
Æß_li•_nû
) {

1230 
v
 = 
p1
->
vÆue
.
i
;

1232 i‡(
ty≥
 =
ALISP_OBJ_FLOAT
)

1233 
f
 -
p1
->
vÆue
.
i
;

1235 
v
 -
p1
->
vÆue
.
i
;

1237 } i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_FLOAT
)) {

1238 i‡(
ty≥
 =
ALISP_OBJ_INTEGER
) {

1239 
f
 = 
v
;

1240 
ty≥
 = 
ALISP_OBJ_FLOAT
;

1242 i‡(
p
 =
¨gs
 && 
	`cdr
’Ë!&
Æß_li•_nû
)

1243 
f
 = 
p1
->
vÆue
.f;

1245 
f
 -
p1
->
vÆue
.f;

1248 
	`li•_w¨n
(
ö°™˚
, "difference witháÇon integer or float operand");

1249 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1250 
n
 = 
	`cdr
(
p
);

1251 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

1252 
p
 = 
n
;

1253 } 
p
 !&
Æß_li•_nû
);

1255 i‡(
ty≥
 =
ALISP_OBJ_INTEGER
) {

1256  
	`√w_öãgî
(
ö°™˚
, 
v
);

1258  
	`√w_Êﬂt
(
ö°™˚
, 
f
);

1260 
	}
}

1265 
Æi•_obje˘
 * 
	$F_mul
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1267 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
p1
, * 
n
;

1268 
v
 = 1;

1269 
f
 = 1;

1270 
ty≥
 = 
ALISP_OBJ_INTEGER
;

1273 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

1274 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
)) {

1275 i‡(
ty≥
 =
ALISP_OBJ_FLOAT
)

1276 
f
 *
p1
->
vÆue
.
i
;

1278 
v
 *
p1
->
vÆue
.
i
;

1279 } i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_FLOAT
)) {

1280 
f
 *
p1
->
vÆue
.‡* 
v
; v = 1;

1281 
ty≥
 = 
ALISP_OBJ_FLOAT
;

1283 
	`li•_w¨n
(
ö°™˚
, "product witháÇon integer or float operand");

1285 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1286 
n
 = 
	`cdr
(
p
);

1287 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

1288 
p
 = 
n
;

1289 } 
p
 !&
Æß_li•_nû
);

1291 i‡(
ty≥
 =
ALISP_OBJ_INTEGER
) {

1292  
	`√w_öãgî
(
ö°™˚
, 
v
);

1294  
	`√w_Êﬂt
(
ö°™˚
, 
f
);

1296 
	}
}

1301 
Æi•_obje˘
 * 
	$F_div
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1303 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
p1
, * 
n
;

1304 
v
 = 0;

1305 
f
 = 0;

1306 
ty≥
 = 
ALISP_OBJ_INTEGER
;

1309 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

1310 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
)) {

1311 i‡(
p
 =
¨gs
 && 
	`cdr
’Ë!&
Æß_li•_nû
) {

1312 
v
 = 
p1
->
vÆue
.
i
;

1314 i‡(
p1
->
vÆue
.
i
 == 0) {

1315 
	`li•_w¨n
(
ö°™˚
, "division by zero");

1316 
v
 = 0;

1317 
f
 = 0;

1320 i‡(
ty≥
 =
ALISP_OBJ_FLOAT
)

1321 
f
 /
p1
->
vÆue
.
i
;

1323 
v
 /
p1
->
vÆue
.
i
;

1326 } i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_FLOAT
)) {

1327 i‡(
ty≥
 =
ALISP_OBJ_INTEGER
) {

1328 
f
 = 
v
;

1329 
ty≥
 = 
ALISP_OBJ_FLOAT
;

1331 i‡(
p
 =
¨gs
 && 
	`cdr
’Ë!&
Æß_li•_nû
) {

1332 
f
 = 
p1
->
vÆue
.f;

1334 i‡(
p1
->
vÆue
.
f
 == 0) {

1335 
	`li•_w¨n
(
ö°™˚
, "division by zero");

1336 
f
 = 0;

1339 
f
 /
p1
->
vÆue
.
i
;

1343 
	`li•_w¨n
(
ö°™˚
, "quotient witháÇon integer or float operand");

1344 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1345 
n
 = 
	`cdr
(
p
);

1346 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

1347 
p
 = 
n
;

1348 } 
p
 !&
Æß_li•_nû
);

1350 i‡(
ty≥
 =
ALISP_OBJ_INTEGER
) {

1351  
	`√w_öãgî
(
ö°™˚
, 
v
);

1353  
	`√w_Êﬂt
(
ö°™˚
, 
f
);

1355 
	}
}

1360 
Æi•_obje˘
 * 
	$F_mod
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1362 
Æi•_obje˘
 * 
p1
, * 
p2
, * 
p3
;

1364 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

1365 
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
¨gs
)));

1366 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

1367 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

1368 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

1370 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
) &&

1371 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
)) {

1372 i‡(
p2
->
vÆue
.
i
 == 0) {

1373 
	`li•_w¨n
(
ö°™˚
, "module by zero");

1374 
p3
 = 
	`√w_öãgî
(
ö°™˚
, 0);

1376 
p3
 = 
	`√w_öãgî
(
ö°™˚
, 
p1
->
vÆue
.
i
 % 
p2
->value.i);

1378 } i‡((
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
) ||

1379 
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_FLOAT
)) &&

1380 (
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
) ||

1381 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_FLOAT
))) {

1382 
f1
, 
f2
;

1383 
f1
 = 
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
Ë?Ö1->
vÆue
.
i
 :Ö1->vÆue.
f
;

1384 
f2
 = 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
Ë?Ö2->
vÆue
.
i
 :Ö2->vÆue.
f
;

1385 
f1
 = 
	`fmod
(f1, 
f2
);

1386 i‡(
f1
 =
EDOM
) {

1387 
	`li•_w¨n
(
ö°™˚
, "module by zero");

1388 
p3
 = 
	`√w_Êﬂt
(
ö°™˚
, 0);

1390 
p3
 = 
	`√w_Êﬂt
(
ö°™˚
, 
f1
);

1393 
	`li•_w¨n
(
ö°™˚
, "module witháÇon integer or float operand");

1394 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1395 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1396  &
Æß_li•_nû
;

1399 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1400 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1401  
p3
;

1402 
	}
}

1407 
Æi•_obje˘
 * 
	$F_…
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1409 
Æi•_obje˘
 * 
p1
, * 
p2
;

1411 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

1412 
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
¨gs
)));

1413 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

1414 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

1415 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

1417 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
) &&

1418 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
)) {

1419 i‡(
p1
->
vÆue
.
i
 < 
p2
->value.i) {

1420 
__åue
:

1421 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1422 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1423  &
Æß_li•_t
;

1425 } i‡((
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
) ||

1426 
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_FLOAT
)) &&

1427 (
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
) ||

1428 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_FLOAT
))) {

1429 
f1
, 
f2
;

1430 
f1
 = 
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
Ë?Ö1->
vÆue
.
i
 :Ö1->vÆue.
f
;

1431 
f2
 = 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
Ë?Ö2->
vÆue
.
i
 :Ö2->vÆue.
f
;

1432 i‡(
f1
 < 
f2
)

1433 
__åue
;

1435 
	`li•_w¨n
(
ö°™˚
, "comparison witháÇon integer or float operand");

1438 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1439 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1440  &
Æß_li•_nû
;

1441 
	}
}

1446 
Æi•_obje˘
 * 
	$F_gt
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1448 
Æi•_obje˘
 * 
p1
, * 
p2
;

1450 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

1451 
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
¨gs
)));

1452 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

1453 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

1454 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

1456 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
) &&

1457 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
)) {

1458 i‡(
p1
->
vÆue
.
i
 > 
p2
->value.i) {

1459 
__åue
:

1460 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1461 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1462  &
Æß_li•_t
;

1464 } i‡((
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
) ||

1465 
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_FLOAT
)) &&

1466 (
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
) ||

1467 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_FLOAT
))) {

1468 
f1
, 
f2
;

1469 
f1
 = 
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
Ë?Ö1->
vÆue
.
i
 :Ö1->vÆue.
f
;

1470 
f2
 = 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
Ë?Ö2->
vÆue
.
i
 :Ö2->vÆue.
f
;

1471 i‡(
f1
 > 
f2
)

1472 
__åue
;

1474 
	`li•_w¨n
(
ö°™˚
, "comparison witháÇon integer or float operand");

1477 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1478 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1479  &
Æß_li•_nû
;

1480 
	}
}

1485 
Æi•_obje˘
 * 
	$F_À
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1487 
Æi•_obje˘
 * 
p1
, * 
p2
;

1489 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

1490 
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
¨gs
)));

1491 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

1492 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

1493 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

1495 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
) &&

1496 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
)) {

1497 i‡(
p1
->
vÆue
.
i
 <
p2
->value.i) {

1498 
__åue
:

1499 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1500 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1501  &
Æß_li•_t
;

1503 } i‡((
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
) ||

1504 
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_FLOAT
)) &&

1505 (
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
) ||

1506 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_FLOAT
))) {

1507 
f1
, 
f2
;

1508 
f1
 = 
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
Ë?Ö1->
vÆue
.
i
 :Ö1->vÆue.
f
;

1509 
f2
 = 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
Ë?Ö2->
vÆue
.
i
 :Ö2->vÆue.
f
;

1510 i‡(
f1
 <
f2
)

1511 
__åue
;

1513 
	`li•_w¨n
(
ö°™˚
, "comparison witháÇon integer or float operand");

1516 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1517 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1518  &
Æß_li•_nû
;

1519 
	}
}

1524 
Æi•_obje˘
 * 
	$F_ge
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1526 
Æi•_obje˘
 * 
p1
, * 
p2
;

1528 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

1529 
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
¨gs
)));

1530 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

1531 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

1532 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

1534 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
) &&

1535 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
)) {

1536 i‡(
p1
->
vÆue
.
i
 >
p2
->value.i) {

1537 
__åue
:

1538 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1539 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1540  &
Æß_li•_t
;

1542 } i‡((
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
) ||

1543 
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_FLOAT
)) &&

1544 (
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
) ||

1545 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_FLOAT
))) {

1546 
f1
, 
f2
;

1547 
f1
 = 
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
Ë?Ö1->
vÆue
.
i
 :Ö1->vÆue.
f
;

1548 
f2
 = 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
Ë?Ö2->
vÆue
.
i
 :Ö2->vÆue.
f
;

1549 i‡(
f1
 >
f2
)

1550 
__åue
;

1552 
	`li•_w¨n
(
ö°™˚
, "comparison witháÇon integer or float operand");

1555 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1556 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1557  &
Æß_li•_nû
;

1558 
	}
}

1563 
Æi•_obje˘
 * 
	$F_numeq
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1565 
Æi•_obje˘
 * 
p1
, * 
p2
;

1567 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

1568 
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
¨gs
)));

1569 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

1570 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

1571 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

1573 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
) &&

1574 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
)) {

1575 i‡(
p1
->
vÆue
.
i
 =
p2
->value.i) {

1576 
__åue
:

1577 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1578 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1579  &
Æß_li•_t
;

1581 } i‡((
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
) ||

1582 
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_FLOAT
)) &&

1583 (
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
) ||

1584 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_FLOAT
))) {

1585 
f1
, 
f2
;

1586 
f1
 = 
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
Ë?Ö1->
vÆue
.
i
 :Ö1->vÆue.
f
;

1587 
f2
 = 
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_INTEGER
Ë?Ö2->
vÆue
.
i
 :Ö2->vÆue.
f
;

1588 i‡(
f1
 =
f2
)

1589 
__åue
;

1591 
	`li•_w¨n
(
ö°™˚
, "comparison witháÇon integer or float operand");

1594 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1595 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1596  &
Æß_li•_nû
;

1597 
	}
}

1602 
Æi•_obje˘
 * 
	$F_num√q
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1604 
Æi•_obje˘
 * 
p
;

1606 
p
 = 
	`F_numeq
(
ö°™˚
, 
¨gs
);

1607 i‡(
p
 =&
Æß_li•_nû
)

1608  &
Æß_li•_t
;

1609  &
Æß_li•_nû
;

1610 
	}
}

1616 
Æi•_obje˘
 * 
	$F_exfun
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1618 
Æi•_obje˘
 * 
p1
, * 
p2
;

1620 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

1621 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

1622 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

1623 
p2
 = 
	`gë_obje˘
(
ö°™˚
, 
p1
);

1624 i‡(
p2
 =&
Æß_li•_nû
) {

1625 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1626  &
Æß_li•_nû
;

1628 
p2
 = 
	`ˇr
(p2);

1629 i‡(
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_IDENTIFIER
) &&

1630 !
	`°rcmp
(
p2
->
vÆue
.
s
, "lambda")) {

1631 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1632  &
Æß_li•_t
;

1634 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1635  &
Æß_li•_nû
;

1636 
	}
}

1638 
	$¥öc_°rög
(
¢d_ouçut_t
 *
out
, *
s
)

1640 *
p
;

1642 
	`¢d_ouçut_putc
(
out
, '"');

1643 
p
 = 
s
; *p != '\0'; ++p)

1644 *
p
) {

1645 '\a': 
	`¢d_ouçut_putc
(
out
, '\\'); snd_output_putc(out, 'a'); ;

1646 '\b': 
	`¢d_ouçut_putc
(
out
, '\\'); snd_output_putc(out, 'b'); ;

1647 '\f': 
	`¢d_ouçut_putc
(
out
, '\\'); snd_output_putc(out, 'f'); ;

1648 '\n': 
	`¢d_ouçut_putc
(
out
, '\\'); snd_output_putc(out, 'n'); ;

1649 '\r': 
	`¢d_ouçut_putc
(
out
, '\\'); snd_output_putc(out, 'r'); ;

1650 '\t': 
	`¢d_ouçut_putc
(
out
, '\\'); snd_output_putc(out, 't'); ;

1651 '\v': 
	`¢d_ouçut_putc
(
out
, '\\'); snd_output_putc(out, 'v'); ;

1652 '"': 
	`¢d_ouçut_putc
(
out
, '\\'); snd_output_putc(out, '"'); ;

1653 : 
	`¢d_ouçut_putc
(
out
, *
p
);

1655 
	`¢d_ouçut_putc
(
out
, '"');

1656 
	}
}

1658 
	$¥öc_c⁄s
(
¢d_ouçut_t
 *
out
, 
Æi•_obje˘
 * 
p
)

1661 
	`¥öc_obje˘
(
out
, 
p
->
vÆue
.
c
.
ˇr
);

1662 
p
 =Ö->
vÆue
.
c
.
cdr
;

1663 i‡(
p
 !&
Æß_li•_nû
) {

1664 
	`¢d_ouçut_putc
(
out
, ' ');

1665 i‡(!
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_CONS
)) {

1666 
	`¢d_ouçut_¥ötf
(
out
, ". ");

1667 
	`¥öc_obje˘
(
out
, 
p
);

1670 } 
p
 !&
Æß_li•_nû
 && 
	`Æi•_com∑ª_ty≥
’, 
ALISP_OBJ_CONS
));

1671 
	}
}

1673 
	$¥öc_obje˘
(
¢d_ouçut_t
 *
out
, 
Æi•_obje˘
 * 
p
)

1675 
	`Æi•_gë_ty≥
(
p
)) {

1676 
ALISP_OBJ_NIL
:

1677 
	`¢d_ouçut_¥ötf
(
out
, "nil");

1679 
ALISP_OBJ_T
:

1680 
	`¢d_ouçut_putc
(
out
, 't');

1682 
ALISP_OBJ_IDENTIFIER
:

1683 
	`¢d_ouçut_¥ötf
(
out
, "%s", 
p
->
vÆue
.
s
);

1685 
ALISP_OBJ_STRING
:

1686 
	`¥öc_°rög
(
out
, 
p
->
vÆue
.
s
);

1688 
ALISP_OBJ_INTEGER
:

1689 
	`¢d_ouçut_¥ötf
(
out
, "%ld", 
p
->
vÆue
.
i
);

1691 
ALISP_OBJ_FLOAT
:

1692 
	`¢d_ouçut_¥ötf
(
out
, "%f", 
p
->
vÆue
.
f
);

1694 
ALISP_OBJ_POINTER
:

1695 
	`¢d_ouçut_¥ötf
(
out
, "<%p>", 
p
->
vÆue
.
±r
);

1697 
ALISP_OBJ_CONS
:

1698 
	`¢d_ouçut_putc
(
out
, '(');

1699 
	`¥öc_c⁄s
(
out
, 
p
);

1700 
	`¢d_ouçut_putc
(
out
, ')');

1702 
	}
}

1707 
Æi•_obje˘
 * 
	$F_¥öc
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1709 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
p1
 = 
NULL
, * 
n
;

1712 i‡(
p1
)

1713 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1714 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

1715 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_STRING
))

1716 
	`¢d_ouçut_¥ötf
(
ö°™˚
->
out
, "%s", 
p1
->
vÆue
.
s
);

1718 
	`¥öc_obje˘
(
ö°™˚
->
out
, 
p1
);

1719 
n
 = 
	`cdr
(
p
);

1720 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

1721 
p
 = 
n
;

1722 } 
p
 !&
Æß_li•_nû
);

1724  
p1
;

1725 
	}
}

1730 
Æi•_obje˘
 * 
	$F_©om
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1732 
Æi•_obje˘
 * 
p
;

1734 
p
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

1735 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

1736 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

1737 i‡(
p
 =
NULL
)

1738  
NULL
;

1740 
	`Æi•_gë_ty≥
(
p
)) {

1741 
ALISP_OBJ_T
:

1742 
ALISP_OBJ_NIL
:

1743 
ALISP_OBJ_INTEGER
:

1744 
ALISP_OBJ_FLOAT
:

1745 
ALISP_OBJ_STRING
:

1746 
ALISP_OBJ_IDENTIFIER
:

1747 
ALISP_OBJ_POINTER
:

1748 
	`dñëe_åì
(
ö°™˚
, 
p
);

1749  &
Æß_li•_t
;

1754 
	`dñëe_åì
(
ö°™˚
, 
p
);

1755  &
Æß_li•_nû
;

1756 
	}
}

1761 
Æi•_obje˘
 * 
	$F_c⁄s
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1763 
Æi•_obje˘
 * 
p
;

1765 
p
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

1766 i‡(
p
) {

1767 
p
->
vÆue
.
c
.
ˇr
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

1768 
p
->
vÆue
.
c
.
cdr
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
¨gs
)));

1769 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

1770 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

1771 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

1773 
	`dñëe_åì
(
ö°™˚
, 
¨gs
);

1776  
p
;

1777 
	}
}

1782 
Æi•_obje˘
 * 
	$F_li°
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1784 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
fú°
 = 
NULL
, * 
¥ev
 = NULL, * 
p1
;

1786 i‡(
p
 =&
Æß_li•_nû
)

1787  &
Æß_li•_nû
;

1790 
p1
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

1791 i‡(
p1
 =
NULL
) {

1792 
	`dñëe_åì
(
ö°™˚
, 
p
);

1793 
	`dñëe_åì
(
ö°™˚
, 
fú°
);

1794  
NULL
;

1796 
p1
->
vÆue
.
c
.
ˇr
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

1797 i‡(
p1
->
vÆue
.
c
.
ˇr
 =
NULL
) {

1798 
	`dñëe_åì
(
ö°™˚
, 
fú°
);

1799 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
p
));

1800 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

1801  
NULL
;

1803 i‡(
fú°
 =
NULL
)

1804 
fú°
 = 
p1
;

1805 i‡(
¥ev
 !
NULL
)

1806 
¥ev
->
vÆue
.
c
.
cdr
 = 
p1
;

1807 
¥ev
 = 
p1
;

1808 
p
 = 
	`cdr
(
p1
 =Ö);

1809 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

1810 } 
p
 !&
Æß_li•_nû
);

1812  
fú°
;

1813 
	}
}

1815 
ölöe
 
	$eq
(
Æi•_obje˘
 * 
p1
, Æi•_obje˘ * 
p2
)

1817  
p1
 =
p2
;

1818 
	}
}

1820 
	$equÆ
(
Æi•_obje˘
 * 
p1
, Æi•_obje˘ * 
p2
)

1822 
ty≥1
, 
ty≥2
;

1824 i‡(
	`eq
(
p1
, 
p2
))

1827 
ty≥1
 = 
	`Æi•_gë_ty≥
(
p1
);

1828 
ty≥2
 = 
	`Æi•_gë_ty≥
(
p2
);

1830 i‡(
ty≥1
 =
ALISP_OBJ_CONS
 || 
ty≥2
 == ALISP_OBJ_CONS)

1833 i‡(
ty≥1
 =
ty≥2
) {

1834 
ty≥1
) {

1835 
ALISP_OBJ_STRING
:

1836  !
	`°rcmp
(
p1
->
vÆue
.
s
, 
p2
->value.s);

1837 
ALISP_OBJ_INTEGER
:

1838  
p1
->
vÆue
.
i
 =
p2
->value.i;

1839 
ALISP_OBJ_FLOAT
:

1840  
p1
->
vÆue
.
i
 =
p2
->value.i;

1845 
	}
}

1850 
Æi•_obje˘
 * 
	$F_eq
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1852 
Æi•_obje˘
 * 
p1
, * 
p2
;

1854 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

1855 
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
¨gs
)));

1856 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

1857 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

1858 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

1860 i‡(
	`eq
(
p1
, 
p2
)) {

1861 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1862 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1863  &
Æß_li•_t
;

1865 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1866 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1867  &
Æß_li•_nû
;

1868 
	}
}

1873 
Æi•_obje˘
 * 
	$F_equÆ
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1875 
Æi•_obje˘
 * 
p1
, * 
p2
;

1877 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

1878 
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
¨gs
)));

1879 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

1880 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

1881 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

1883 i‡(
	`equÆ
(
p1
, 
p2
)) {

1884 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1885 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1886  &
Æß_li•_t
;

1888 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1889 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1890  &
Æß_li•_nû
;

1891 
	}
}

1896 
Æi•_obje˘
 * 
	$F_quŸe
(
Æi•_ö°™˚
 *
ö°™˚
 
ATTRIBUTE_UNUSED
, 
Æi•_obje˘
 * 
¨gs
)

1898 
Æi•_obje˘
 *
p
 = 
	`ˇr
(
¨gs
);

1900 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

1901 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

1902  
p
;

1903 
	}
}

1908 
Æi•_obje˘
 * 
	$F_™d
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1910 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
p1
 = 
NULL
, * 
n
;

1913 i‡(
p1
)

1914 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1915 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

1916 i‡(
p1
 =&
Æß_li•_nû
) {

1917 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1918 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
p
));

1919 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

1920  &
Æß_li•_nû
;

1922 
p
 = 
	`cdr
(
n
 =Ö);

1923 
	`dñëe_obje˘
(
ö°™˚
, 
n
);

1924 } 
p
 !&
Æß_li•_nû
);

1926  
p1
;

1927 
	}
}

1932 
Æi•_obje˘
 * 
	$F_‹
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1934 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
p1
 = 
NULL
, * 
n
;

1937 i‡(
p1
)

1938 
	`dñëe_åì
(
ö°™˚
, 
p1
);

1939 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

1940 i‡(
p1
 !&
Æß_li•_nû
) {

1941 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
p
));

1942 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

1943  
p1
;

1945 
p
 = 
	`cdr
(
n
 =Ö);

1946 
	`dñëe_obje˘
(
ö°™˚
, 
n
);

1947 } 
p
 !&
Æß_li•_nû
);

1949  &
Æß_li•_nû
;

1950 
	}
}

1956 
Æi•_obje˘
 * 
	$F_nŸ
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1958 
Æi•_obje˘
 * 
p
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

1960 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

1961 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

1962 i‡(
p
 !&
Æß_li•_nû
) {

1963 
	`dñëe_åì
(
ö°™˚
, 
p
);

1964  &
Æß_li•_nû
;

1967 
	`dñëe_åì
(
ö°™˚
, 
p
);

1968  &
Æß_li•_t
;

1969 
	}
}

1974 
Æi•_obje˘
 * 
	$F_c⁄d
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

1976 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
p1
, * 
p2
, * 
p3
;

1979 
p1
 = 
	`ˇr
(
p
);

1980 i‡((
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p1
))Ë!&
Æß_li•_nû
) {

1981 
p3
 = 
	`cdr
(
p1
);

1982 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

1983 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
p
));

1984 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

1985 i‡(
p3
 !&
Æß_li•_nû
) {

1986 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1987  
	`F_¥ogn
(
ö°™˚
, 
p3
);

1989 
	`dñëe_åì
(
ö°™˚
, 
p3
);

1990  
p2
;

1993 
	`dñëe_åì
(
ö°™˚
, 
p2
);

1994 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
p1
));

1995 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

1997 
p
 = 
	`cdr
(
p2
 =Ö);

1998 
	`dñëe_obje˘
(
ö°™˚
, 
p2
);

1999 } 
p
 !&
Æß_li•_nû
);

2001  &
Æß_li•_nû
;

2002 
	}
}

2007 
Æi•_obje˘
 * 
	$F_if
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2009 
Æi•_obje˘
 * 
p1
, * 
p2
, * 
p3
;

2011 
p1
 = 
	`ˇr
(
¨gs
);

2012 
p2
 = 
	`ˇr
(
	`cdr
(
¨gs
));

2013 
p3
 = 
	`cdr
(cdr(
¨gs
));

2014 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

2015 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2017 
p1
 = 
	`evÆ
(
ö°™˚
,Ö1);

2018 i‡(
p1
 !&
Æß_li•_nû
) {

2019 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2020 
	`dñëe_åì
(
ö°™˚
, 
p3
);

2021  
	`evÆ
(
ö°™˚
, 
p2
);

2024 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2025 
	`dñëe_åì
(
ö°™˚
, 
p2
);

2026  
	`F_¥ogn
(
ö°™˚
, 
p3
);

2027 
	}
}

2032 
Æi•_obje˘
 * 
	$F_whí
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2034 
Æi•_obje˘
 * 
p1
, * 
p2
;

2036 
p1
 = 
	`ˇr
(
¨gs
);

2037 
p2
 = 
	`cdr
(
¨gs
);

2038 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2039 i‡((
p1
 = 
	`evÆ
(
ö°™˚
,Ö1)Ë!&
Æß_li•_nû
) {

2040 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2041  
	`F_¥ogn
(
ö°™˚
, 
p2
);

2043 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2044 
	`dñëe_åì
(
ö°™˚
, 
p2
);

2047  &
Æß_li•_nû
;

2048 
	}
}

2053 
Æi•_obje˘
 * 
	$F_u∆ess
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2055 
Æi•_obje˘
 * 
p1
, * 
p2
;

2057 
p1
 = 
	`ˇr
(
¨gs
);

2058 
p2
 = 
	`cdr
(
¨gs
);

2059 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2060 i‡((
p1
 = 
	`evÆ
(
ö°™˚
,Ö1)Ë=&
Æß_li•_nû
) {

2061  
	`F_¥ogn
(
ö°™˚
, 
p2
);

2063 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2064 
	`dñëe_åì
(
ö°™˚
, 
p2
);

2067  &
Æß_li•_nû
;

2068 
	}
}

2073 
Æi•_obje˘
 * 
	$F_whûe
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2075 
Æi•_obje˘
 * 
p1
, * 
p2
, * 
p3
;

2077 
p1
 = 
	`ˇr
(
¨gs
);

2078 
p2
 = 
	`cdr
(
¨gs
);

2080 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2082 
	`ö¸ef_åì
(
ö°™˚
, 
p1
);

2083 i‡((
p3
 = 
	`evÆ
(
ö°™˚
, 
p1
)Ë=&
Æß_li•_nû
)

2085 
	`dñëe_åì
(
ö°™˚
, 
p3
);

2086 
	`ö¸ef_åì
(
ö°™˚
, 
p2
);

2087 
	`dñëe_åì
(
ö°™˚
, 
	`F_¥ogn
(ö°™˚, 
p2
));

2090 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2091 
	`dñëe_åì
(
ö°™˚
, 
p2
);

2092  &
Æß_li•_nû
;

2093 
	}
}

2098 
Æi•_obje˘
 * 
	$F_¥ogn
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2100 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
p1
 = 
NULL
, * 
n
;

2103 i‡(
p1
)

2104 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2105 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

2106 
n
 = 
	`cdr
(
p
);

2107 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

2108 
p
 = 
n
;

2109 } 
p
 !&
Æß_li•_nû
);

2111  
p1
;

2112 
	}
}

2117 
Æi•_obje˘
 * 
	$F_¥og1
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2119 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
fú°
 = 
NULL
, * 
p1
;

2122 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

2123 i‡(
fú°
 =
NULL
)

2124 
fú°
 = 
p1
;

2126 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2127 
p1
 = 
	`cdr
(
p
);

2128 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

2129 
p
 = 
p1
;

2130 } 
p
 !&
Æß_li•_nû
);

2132 i‡(
fú°
 =
NULL
)

2133 
fú°
 = &
Æß_li•_nû
;

2135  
fú°
;

2136 
	}
}

2141 
Æi•_obje˘
 * 
	$F_¥og2
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2143 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
£c⁄d
 = 
NULL
, * 
p1
;

2144 
i
 = 0;

2147 ++
i
;

2148 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

2149 i‡(
i
 == 2)

2150 
£c⁄d
 = 
p1
;

2152 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2153 
p1
 = 
	`cdr
(
p
);

2154 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

2155 
p
 = 
p1
;

2156 } 
p
 !&
Æß_li•_nû
);

2158 i‡(
£c⁄d
 =
NULL
)

2159 
£c⁄d
 = &
Æß_li•_nû
;

2161  
£c⁄d
;

2162 
	}
}

2167 
Æi•_obje˘
 * 
	$F_£t
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2169 
Æi•_obje˘
 * 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
)),

2170 * 
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
¨gs
)));

2172 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

2173 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

2174 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2175 i‡(!
	`check_£t_obje˘
(
ö°™˚
, 
p1
)) {

2176 
	`dñëe_åì
(
ö°™˚
, 
p2
);

2177 
p2
 = &
Æß_li•_nû
;

2179 i‡(
	`£t_obje˘
(
ö°™˚
, 
p1
, 
p2
Ë=
NULL
) {

2180 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2181 
	`dñëe_åì
(
ö°™˚
, 
p2
);

2182  
NULL
;

2185 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2186  
	`ö¸ef_åì
(
ö°™˚
, 
p2
);

2187 
	}
}

2192 
Æi•_obje˘
 * 
	$F_un£t
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2194 
Æi•_obje˘
 * 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

2196 
	`dñëe_åì
(
ö°™˚
, 
	`un£t_obje˘
(ö°™˚, 
p1
));

2197 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

2198 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2199  
p1
;

2200 
	}
}

2207 
Æi•_obje˘
 * 
	$F_£tq
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2209 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
p1
, * 
p2
 = 
NULL
, *
n
;

2212 
p1
 = 
	`ˇr
(
p
);

2213 
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
p
)));

2214 
n
 = 
	`cdr
(cdr(
p
));

2215 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
p
));

2216 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

2217 i‡(!
	`check_£t_obje˘
(
ö°™˚
, 
p1
)) {

2218 
	`dñëe_åì
(
ö°™˚
, 
p2
);

2219 
p2
 = &
Æß_li•_nû
;

2221 i‡(
	`£t_obje˘
(
ö°™˚
, 
p1
, 
p2
Ë=
NULL
) {

2222 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2223 
	`dñëe_åì
(
ö°™˚
, 
p2
);

2224  
NULL
;

2227 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2228 
p
 = 
n
;

2229 } 
p
 !&
Æß_li•_nû
);

2231  
	`ö¸ef_åì
(
ö°™˚
, 
p2
);

2232 
	}
}

2239 
Æi•_obje˘
 * 
	$F_un£tq
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2241 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
p1
 = 
NULL
, * 
n
;

2244 i‡(
p1
)

2245 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2246 
p1
 = 
	`un£t_obje˘
(
ö°™˚
, 
	`ˇr
(
p
));

2247 
	`dñëe_åì
(
ö°™˚
, 
	`ˇr
(
p
));

2248 
p
 = 
	`cdr
(
n
 =Ö);

2249 
	`dñëe_obje˘
(
ö°™˚
, 
n
);

2250 } 
p
 !&
Æß_li•_nû
);

2252  
p1
;

2253 
	}
}

2260 
Æi•_obje˘
 * 
	$F_defun
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2262 
Æi•_obje˘
 * 
p1
 = 
	`ˇr
(
¨gs
),

2263 * 
p2
 = 
	`ˇr
(
	`cdr
(
¨gs
)),

2264 * 
p3
 = 
	`cdr
(cdr(
¨gs
));

2265 
Æi•_obje˘
 * 
Àx¥
;

2267 
Àx¥
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

2268 i‡(
Àx¥
) {

2269 
Àx¥
->
vÆue
.
c
.
ˇr
 = 
	`√w_idítifõr
(
ö°™˚
, "lambda");

2270 i‡(
Àx¥
->
vÆue
.
c
.
ˇr
 =
NULL
) {

2271 
	`dñëe_obje˘
(
ö°™˚
, 
Àx¥
);

2272 
	`dñëe_åì
(
ö°™˚
, 
¨gs
);

2273  
NULL
;

2275 i‡((
Àx¥
->
vÆue
.
c
.
cdr
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
)Ë=
NULL
) {

2276 
	`dñëe_obje˘
(
ö°™˚
, 
Àx¥
->
vÆue
.
c
.
ˇr
);

2277 
	`dñëe_obje˘
(
ö°™˚
, 
Àx¥
);

2278 
	`dñëe_åì
(
ö°™˚
, 
¨gs
);

2279  
NULL
;

2281 
Àx¥
->
vÆue
.
c
.
cdr
->vÆue.c.
ˇr
 = 
p2
;

2282 
Àx¥
->
vÆue
.
c
.
cdr
->vÆue.c.cd∏
p3
;

2283 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

2284 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2285 i‡(
	`£t_obje˘
(
ö°™˚
, 
p1
, 
Àx¥
Ë=
NULL
) {

2286 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2287 
	`dñëe_åì
(
ö°™˚
, 
Àx¥
);

2288  
NULL
;

2290 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2292 
	`dñëe_åì
(
ö°™˚
, 
¨gs
);

2294  &
Æß_li•_nû
;

2295 
	}
}

2297 
Æi•_obje˘
 * 
	$evÆ_func
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
p
, Æi•_obje˘ * 
¨gs
)

2299 
Æi•_obje˘
 * 
p1
, * 
p2
, * 
p3
, * 
p4
;

2300 
Æi•_obje˘
 ** 
evÆ_objs
, ** 
ßve_objs
;

2301 
i
;

2303 
p1
 = 
	`ˇr
(
p
);

2304 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_IDENTIFIER
) &&

2305 !
	`°rcmp
(
p1
->
vÆue
.
s
, "lambda")) {

2306 
p2
 = 
	`ˇr
(
	`cdr
(
p
));

2307 
p3
 = 
¨gs
;

2309 i‡((
i
 = 
	`cou¡_li°
(
p2
)Ë!cou¡_li°(
p3
)) {

2310 
	`li•_w¨n
(
ö°™˚
, "wrongÇumber ofÖarameters");

2311 
_dñëe
;

2314 
evÆ_objs
 = 
	`mÆloc
(2 * 
i
 * (
Æi•_obje˘
 *));

2315 i‡(
evÆ_objs
 =
NULL
) {

2316 
	`nomem
();

2317 
_dñëe
;

2319 
ßve_objs
 = 
evÆ_objs
 + 
i
;

2324 
i
 = 0;

2325 
p3
 !&
Æß_li•_nû
) {

2326 
evÆ_objs
[
i
++] = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p3
));

2327 
p3
 = 
	`cdr
(
p4
 =Ö3);

2328 
	`dñëe_obje˘
(
ö°™˚
, 
p4
);

2334 
i
 = 0;

2335 
p2
 !&
Æß_li•_nû
) {

2336 
p3
 = 
	`ˇr
(
p2
);

2337 
ßve_objs
[
i
] = 
	`ª∂a˚_obje˘
(
ö°™˚
, 
p3
, 
evÆ_objs
[i]);

2338 i‡(
ßve_objs
[
i
] =
NULL
 &&

2339 
	`£t_obje˘_dúe˘
(
ö°™˚
, 
p3
, 
evÆ_objs
[
i
]Ë=
NULL
) {

2340 
p4
 = 
NULL
;

2341 
_íd
;

2343 
p2
 = 
	`cdr
(p2);

2344 ++
i
;

2347 
p4
 = 
	`F_¥ogn
(
ö°™˚
, 
	`cdr
(
	`ö¸ef_åì
(ö°™˚, 
p3
 = cdr(
p
))));

2352 
p2
 = 
	`ˇr
(
p3
);

2353 
	`dñëe_obje˘
(
ö°™˚
, 
p3
);

2354 
i
 = 0;

2355 
p2
 !&
Æß_li•_nû
) {

2356 
p3
 = 
	`ˇr
(
p2
);

2357 i‡(
ßve_objs
[
i
] =
NULL
) {

2358 
p3
 = 
	`un£t_obje˘
(
ö°™˚
,Ö3);

2360 
p3
 = 
	`ª∂a˚_obje˘
(
ö°™˚
,Ö3, 
ßve_objs
[
i
]);

2362 
i
++;

2363 
	`dñëe_åì
(
ö°™˚
, 
p3
);

2364 
	`dñëe_åì
(
ö°™˚
, 
	`ˇr
(
p2
));

2365 
p2
 = 
	`cdr
(
p3
 =Ö2);

2366 
	`dñëe_obje˘
(
ö°™˚
, 
p3
);

2369 
_íd
:

2370 
	`‰ì
(
evÆ_objs
);

2372  
p4
;

2374 
_dñëe
:

2375 
	`dñëe_åì
(
ö°™˚
, 
¨gs
);

2377  &
Æß_li•_nû
;

2378 
	}
}

2380 
Æi•_obje˘
 * 
	$F_gc
(
Æi•_ö°™˚
 *
ö°™˚
 
ATTRIBUTE_UNUSED
, 
Æi•_obje˘
 * 
¨gs
 ATTRIBUTE_UNUSED)

2383  &
Æß_li•_t
;

2384 
	}
}

2390 
Æi•_obje˘
 * 
	$F_∑th
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2392 
Æi•_obje˘
 * 
p1
;

2394 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

2395 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

2396 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2397 i‡(!
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_STRING
)) {

2398 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2399  &
Æß_li•_nû
;

2401 i‡(!
	`°rcmp
(
p1
->
vÆue
.
s
, "data")) {

2402 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2403  
	`√w_°rög
(
ö°™˚
, 
	`¢d_c⁄fig_t›dú
());

2405 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2406  &
Æß_li•_nû
;

2407 
	}
}

2412 
Æi•_obje˘
 * 
	$F_ö˛ude
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2414 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
p1
;

2415 
ªs
 = -
ENOENT
;

2418 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

2419 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_STRING
))

2420 
ªs
 = 
	`Æi•_ö˛ude_fûe
(
ö°™˚
, 
p1
->
vÆue
.
s
);

2421 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2422 
p
 = 
	`cdr
(
p1
 =Ö);

2423 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

2424 } 
p
 !&
Æß_li•_nû
);

2426  
	`√w_öãgî
(
ö°™˚
, 
ªs
);

2427 
	}
}

2433 
Æi•_obje˘
 * 
	$F_°rög_to_öãgî
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2435 
Æi•_obje˘
 * 
p
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
)), * 
p1
;

2437 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

2438 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2439 i‡(
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_INTEGER
))

2440  
p
;

2441 i‡(
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_FLOAT
)) {

2442 
p1
 = 
	`√w_öãgî
(
ö°™˚
, 
	`Êo‹
(
p
->
vÆue
.
f
));

2444 
	`li•_w¨n
(
ö°™˚
, "expectedán integer or float for integer conversion");

2445 
p1
 = &
Æß_li•_nû
;

2447 
	`dñëe_åì
(
ö°™˚
, 
p
);

2448  
p1
;

2449 
	}
}

2455 
Æi•_obje˘
 * 
	$F_°rög_to_Êﬂt
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2457 
Æi•_obje˘
 * 
p
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
)), * 
p1
;

2459 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

2460 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2461 i‡(
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_FLOAT
))

2462  
p
;

2463 i‡(
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_INTEGER
)) {

2464 
p1
 = 
	`√w_Êﬂt
(
ö°™˚
, 
p
->
vÆue
.
i
);

2466 
	`li•_w¨n
(
ö°™˚
, "expectedán integer or float for integer conversion");

2467 
p1
 = &
Æß_li•_nû
;

2469 
	`dñëe_åì
(
ö°™˚
, 
p
);

2470  
p1
;

2471 
	}
}

2473 
	$≠≥nd_to_°rög
(**
s
, *
Àn
, *
‰om
, 
size
)

2475 i‡(*
Àn
 == 0) {

2476 *
s
 = 
	`mÆloc
(*
Àn
 = 
size
 + 1);

2477 i‡(*
s
 =
NULL
) {

2478 
	`nomem
();

2479  -
ENOMEM
;

2481 
	`mem˝y
(*
s
, 
‰om
, 
size
);

2483 *
Àn
 +
size
;

2484 *
s
 = 
	`ªÆloc
(*s, *
Àn
);

2485 i‡(*
s
 =
NULL
) {

2486 
	`nomem
();

2487  -
ENOMEM
;

2489 
	`mem˝y
(*
s
 + 
	`°æí
(*s), 
‰om
, 
size
);

2491 (*
s
)[*
Àn
 - 1] = '\0';

2493 
	}
}

2495 
	$f‹m©_∑r£_ch¨
(
Æi•_ö°™˚
 *
ö°™˚
, **
s
, *
Àn
, 
Æi•_obje˘
 *
p
)

2497 
b
;

2499 i‡(!
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_INTEGER
)) {

2500 
	`li•_w¨n
(
ö°™˚
, "format:Éxpected integer\n");

2503 
b
 = 
p
->
vÆue
.
i
;

2504  
	`≠≥nd_to_°rög
(
s
, 
Àn
, &
b
, 1);

2505 
	}
}

2507 
	$f‹m©_∑r£_öãgî
(
Æi•_ö°™˚
 *
ö°™˚
, **
s
, *
Àn
, 
Æi•_obje˘
 *
p
)

2509 
ªs
;

2510 *
s1
;

2512 i‡(!
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_INTEGER
) &&

2513 !
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_FLOAT
)) {

2514 
	`li•_w¨n
(
ö°™˚
, "format:Éxpected integer or float\n");

2517 
s1
 = 
	`mÆloc
(64);

2518 i‡(
s1
 =
NULL
) {

2519 
	`nomem
();

2520  -
ENOMEM
;

2522 
	`•rötf
(
s1
, "%li", 
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_FLOAT
Ë? ()
	`Êo‹
’->
vÆue
.
f
Ë:Ö->vÆue.
i
);

2523 
ªs
 = 
	`≠≥nd_to_°rög
(
s
, 
Àn
, 
s1
, 
	`°æí
(s1));

2524 
	`‰ì
(
s1
);

2525  
ªs
;

2526 
	}
}

2528 
	$f‹m©_∑r£_Êﬂt
(
Æi•_ö°™˚
 *
ö°™˚
, **
s
, *
Àn
, 
Æi•_obje˘
 *
p
)

2530 
ªs
;

2531 *
s1
;

2533 i‡(!
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_INTEGER
) &&

2534 !
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_FLOAT
)) {

2535 
	`li•_w¨n
(
ö°™˚
, "format:Éxpected integer or float\n");

2538 
s1
 = 
	`mÆloc
(64);

2539 i‡(
s1
 =
NULL
) {

2540 
	`nomem
();

2541  -
ENOMEM
;

2543 
	`•rötf
(
s1
, "%f", 
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_FLOAT
Ë?Ö->
vÆue
.
f
 : (Ì->vÆue.
i
);

2544 
ªs
 = 
	`≠≥nd_to_°rög
(
s
, 
Àn
, 
s1
, 
	`°æí
(s1));

2545 
	`‰ì
(
s1
);

2546  
ªs
;

2547 
	}
}

2549 
	$f‹m©_∑r£_°rög
(
Æi•_ö°™˚
 *
ö°™˚
, **
s
, *
Àn
, 
Æi•_obje˘
 *
p
)

2551 i‡(!
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_STRING
)) {

2552 
	`li•_w¨n
(
ö°™˚
, "format:Éxpected string\n");

2555  
	`≠≥nd_to_°rög
(
s
, 
Àn
, 
p
->
vÆue
.s, 
	`°æí
(p->value.s));

2556 
	}
}

2562 
Æi•_obje˘
 * 
	$F_f‹m©
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2564 
Æi•_obje˘
 * 
p
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
)), * 
p1
 = 
	`cdr
◊rgs), * 
n
;

2565 *
s
, *
s1
, *
s2
;

2566 
Àn
;

2568 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2569 i‡(!
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_STRING
)) {

2570 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2571 
	`dñëe_åì
(
ö°™˚
, 
p
);

2572 
	`li•_w¨n
(
ö°™˚
, "format:Éxpectedán format string");

2573  &
Æß_li•_nû
;

2575 
s
 = 
p
->
vÆue
.s;

2576 
s1
 = 
NULL
;

2577 
Àn
 = 0;

2578 
n
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p1
));

2581 
s2
 = 
s
;

2582 *
s2
 && *s2 != '%')

2583 
s2
++;

2584 i‡(
s2
 !
s
) {

2585 i‡(
	`≠≥nd_to_°rög
(&
s1
, &
Àn
, 
s
, 
s2
 - s) < 0) {

2586 
__îr‹
:

2587 
	`dñëe_åì
(
ö°™˚
, 
n
);

2588 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
p1
));

2589 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

2590 
	`dñëe_åì
(
ö°™˚
, 
p
);

2591  
NULL
;

2594 i‡(*
s2
 == '%')

2595 
s2
++;

2596 *
s2
) {

2598 i‡(
	`≠≥nd_to_°rög
(&
s1
, &
Àn
, 
s2
, 1) < 0)

2599 
__îr‹
;

2600 
s
 = 
s2
 + 1;

2603 i‡(
	`f‹m©_∑r£_ch¨
(
ö°™˚
, &
s1
, &
Àn
, 
n
) < 0)

2604 
__îr‹
;

2605 
s
 = 
s2
 + 1;

2606 
__√xt
;

2609 i‡(
	`f‹m©_∑r£_öãgî
(
ö°™˚
, &
s1
, &
Àn
, 
n
) < 0)

2610 
__îr‹
;

2611 
s
 = 
s2
 + 1;

2612 
__√xt
;

2614 i‡(
	`f‹m©_∑r£_Êﬂt
(
ö°™˚
, &
s1
, &
Àn
, 
n
) < 0)

2615 
__îr‹
;

2616 
s
 = 
s2
 + 1;

2617 
__√xt
;

2619 i‡(
	`f‹m©_∑r£_°rög
(
ö°™˚
, &
s1
, &
Àn
, 
n
) < 0)

2620 
__îr‹
;

2621 
s
 = 
s2
 + 1;

2622 
__√xt
;

2624 
__íd
;

2626 
	`li•_w¨n
(
ö°™˚
, "unknow¿f‹m© ch¨ '%c'", *
s2
);

2627 
s
 = 
s2
 + 1;

2628 
__√xt
;

2631 
__√xt
:

2632 
	`dñëe_åì
(
ö°™˚
, 
n
);

2633 
p1
 = 
	`cdr
(
n
 =Ö1);

2634 
	`dñëe_obje˘
(
ö°™˚
, 
n
);

2635 
n
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p1
));

2636 } *
s
);

2637 
__íd
:

2638 
	`dñëe_åì
(
ö°™˚
, 
n
);

2639 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
p1
));

2640 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

2641 
	`dñëe_åì
(
ö°™˚
, 
p
);

2642 i‡(
Àn
 > 0) {

2643 
p1
 = 
	`√w_°rög
(
ö°™˚
, 
s1
);

2644 
	`‰ì
(
s1
);

2646 
p1
 = &
Æß_li•_nû
;

2648  
p1
;

2649 
	}
}

2661 
Æi•_obje˘
 * 
	$F_com∑ª_°rögs
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2663 
Æi•_obje˘
 * 
p1
 = 
¨gs
, * 
n
, * 
p
[7];

2664 *
s1
, *
s2
;

2665 
°¨t1
, 
íd1
, 
°¨t2
, 
íd2
;

2667 
°¨t1
 = 0; start1 < 7; start1++) {

2668 
p
[
°¨t1
] = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p1
));

2669 
p1
 = 
	`cdr
(
n
 =Ö1);

2670 
	`dñëe_obje˘
(
ö°™˚
, 
n
);

2672 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2673 i‡(
	`Æi•_com∑ª_ty≥
(
p
[0], 
ALISP_OBJ_STRING
)) {

2674 
	`li•_w¨n
(
ö°™˚
, "compare-strings: firstárgument must be string\n");

2675 
p1
 = &
Æß_li•_nû
;

2676 
__îr
;

2678 i‡(
	`Æi•_com∑ª_ty≥
(
p
[1], 
ALISP_OBJ_INTEGER
)) {

2679 
	`li•_w¨n
(
ö°™˚
, "compare-strings: secondárgument must be integer\n");

2680 
p1
 = &
Æß_li•_nû
;

2681 
__îr
;

2683 i‡(
	`Æi•_com∑ª_ty≥
(
p
[2], 
ALISP_OBJ_INTEGER
)) {

2684 
	`li•_w¨n
(
ö°™˚
, "compare-strings:Åhirdárgument must be integer\n");

2685 
p1
 = &
Æß_li•_nû
;

2686 
__îr
;

2688 i‡(
	`Æi•_com∑ª_ty≥
(
p
[3], 
ALISP_OBJ_STRING
)) {

2689 
	`li•_w¨n
(
ö°™˚
, "compare-strings: fifthárgument must be string\n");

2690 
p1
 = &
Æß_li•_nû
;

2691 
__îr
;

2693 i‡(!
	`Æi•_com∑ª_ty≥
(
p
[4], 
ALISP_OBJ_NIL
) &&

2694 !
	`Æi•_com∑ª_ty≥
(
p
[4], 
ALISP_OBJ_INTEGER
)) {

2695 
	`li•_w¨n
(
ö°™˚
, "compare-strings: fourthárgument must be integer\n");

2696 
p1
 = &
Æß_li•_nû
;

2697 
__îr
;

2699 i‡(!
	`Æi•_com∑ª_ty≥
(
p
[5], 
ALISP_OBJ_NIL
) &&

2700 !
	`Æi•_com∑ª_ty≥
(
p
[5], 
ALISP_OBJ_INTEGER
)) {

2701 
	`li•_w¨n
(
ö°™˚
, "compare-strings: sixthárgument must be integer\n");

2702 
p1
 = &
Æß_li•_nû
;

2703 
__îr
;

2705 
s1
 = 
p
[0]->
vÆue
.
s
;

2706 
°¨t1
 = 
p
[1]->
vÆue
.
i
;

2707 
íd1
 = 
p
[2]->
vÆue
.
i
;

2708 
s2
 = 
p
[3]->
vÆue
.
s
;

2709 
°¨t2
 = 
	`Æi•_com∑ª_ty≥
(
p
[4], 
ALISP_OBJ_NIL
Ë? 0 :Ö[4]->
vÆue
.
i
;

2710 
íd2
 = 
	`Æi•_com∑ª_ty≥
(
p
[5], 
ALISP_OBJ_NIL
Ë? 
°¨t2
 + (
íd1
 - 
°¨t1
Ë:Ö[5]->
vÆue
.
i
;

2711 i‡(
°¨t1
 < 0 || 
°¨t2
 < 0 || 
íd1
 < 0 || 
íd2
 < 0 ||

2712 
°¨t1
 >()
	`°æí
(
s1
Ë|| 
°¨t2
 >()°æí(
s2
) ||

2713 (
íd1
 - 
°¨t1
Ë!(
íd2
 - 
°¨t2
)) {

2714 
p1
 = &
Æß_li•_nû
;

2715 
__îr
;

2717 i‡(
p
[6] !&
Æß_li•_nû
) {

2718 
°¨t1
 < 
íd1
) {

2719 i‡(
s1
[
°¨t1
] == '\0' ||

2720 
s2
[
°¨t2
] == '\0' ||

2721 
	`tﬁowî
(
s1
[
°¨t1
]Ë!tﬁowî(
s2
[
°¨t2
])) {

2722 
p1
 = &
Æß_li•_nû
;

2723 
__îr
;

2725 
°¨t1
++;

2726 
°¨t2
++;

2729 
°¨t1
 < 
íd1
) {

2730 i‡(
s1
[
°¨t1
] == '\0' ||

2731 
s2
[
°¨t2
] == '\0' ||

2732 
s1
[
°¨t1
] !
s2
[
°¨t2
]) {

2733 
p1
 = &
Æß_li•_nû
;

2734 
__îr
;

2736 
°¨t1
++;

2737 
°¨t2
++;

2740 
p1
 = &
Æß_li•_t
;

2742 
__îr
:

2743 
°¨t1
 = 0; start1 < 7; start1++)

2744 
	`dñëe_åì
(
ö°™˚
, 
p
[
°¨t1
]);

2745  
p1
;

2746 
	}
}

2751 
Æi•_obje˘
 * 
	$F_assoc
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2753 
Æi•_obje˘
 * 
p1
, * 
p2
, * 
n
;

2755 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

2756 
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
¨gs
)));

2757 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

2758 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

2759 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2762 i‡(
	`eq
(
p1
, 
	`ˇr
(ˇr(
p2
)))) {

2763 
n
 = 
	`ˇr
(
p2
);

2764 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2765 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
p2
));

2766 
	`dñëe_obje˘
(
ö°™˚
, 
p2
);

2767  
n
;

2769 
	`dñëe_åì
(
ö°™˚
, 
	`ˇr
(
p2
));

2770 
p2
 = 
	`cdr
(
n
 =Ö2);

2771 
	`dñëe_obje˘
(
ö°™˚
, 
n
);

2772 } 
p2
 !&
Æß_li•_nû
);

2774 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2775  &
Æß_li•_nû
;

2776 
	}
}

2781 
Æi•_obje˘
 * 
	$F_øssoc
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2783 
Æi•_obje˘
 * 
p1
, *
p2
, * 
n
;

2785 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

2786 
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
¨gs
)));

2787 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

2788 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

2789 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2792 i‡(
	`eq
(
p1
, 
	`cdr
(
	`ˇr
(
p2
)))) {

2793 
n
 = 
	`ˇr
(
p2
);

2794 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2795 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
p2
));

2796 
	`dñëe_obje˘
(
ö°™˚
, 
p2
);

2797  
n
;

2799 
	`dñëe_åì
(
ö°™˚
, 
	`ˇr
(
p2
));

2800 
p2
 = 
	`cdr
(
n
 =Ö2);

2801 
	`dñëe_obje˘
(
ö°™˚
, 
n
);

2802 } 
p2
 !&
Æß_li•_nû
);

2804 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2805  &
Æß_li•_nû
;

2806 
	}
}

2811 
Æi•_obje˘
 * 
	$F_assq
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2813 
Æi•_obje˘
 * 
p1
, * 
p2
, * 
n
;

2815 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

2816 
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
¨gs
)));

2817 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

2818 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

2819 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2822 i‡(
	`equÆ
(
p1
, 
	`ˇr
(ˇr(
p2
)))) {

2823 
n
 = 
	`ˇr
(
p2
);

2824 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2825 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
p2
));

2826 
	`dñëe_obje˘
(
ö°™˚
, 
p2
);

2827  
n
;

2829 
	`dñëe_åì
(
ö°™˚
, 
	`ˇr
(
p2
));

2830 
p2
 = 
	`cdr
(
n
 =Ö2);

2831 
	`dñëe_obje˘
(
ö°™˚
, 
n
);

2832 } 
p2
 !&
Æß_li•_nû
);

2834 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2835  &
Æß_li•_nû
;

2836 
	}
}

2841 
Æi•_obje˘
 * 
	$F_¡h
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2843 
Æi•_obje˘
 * 
p1
, * 
p2
, * 
n
;

2844 
idx
;

2846 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

2847 
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
¨gs
)));

2848 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

2849 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

2850 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2852 i‡(!
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
)) {

2853 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2854 
	`dñëe_åì
(
ö°™˚
, 
p2
);

2855  &
Æß_li•_nû
;

2857 i‡(!
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_CONS
)) {

2858 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

2859 
	`dñëe_åì
(
ö°™˚
, 
p2
);

2860  &
Æß_li•_nû
;

2862 
idx
 = 
p1
->
vÆue
.
i
;

2863 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

2864 
idx
-- > 0) {

2865 
	`dñëe_åì
(
ö°™˚
, 
	`ˇr
(
p2
));

2866 
p2
 = 
	`cdr
(
n
 =Ö2);

2867 
	`dñëe_obje˘
(
ö°™˚
, 
n
);

2869 
n
 = 
	`ˇr
(
p2
);

2870 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
p2
));

2871 
	`dñëe_obje˘
(
ö°™˚
, 
p2
);

2872  
n
;

2873 
	}
}

2878 
Æi•_obje˘
 * 
	$F_øssq
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2880 
Æi•_obje˘
 * 
p1
, * 
p2
, * 
n
;

2882 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

2883 
p2
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
	`cdr
(
¨gs
)));

2884 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

2885 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

2886 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

2889 i‡(
	`equÆ
(
p1
, 
	`cdr
(
	`ˇr
(
p2
)))) {

2890 
n
 = 
	`ˇr
(
p2
);

2891 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2892 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
p2
));

2893 
	`dñëe_obje˘
(
ö°™˚
, 
p2
);

2894  
n
;

2896 
	`dñëe_åì
(
ö°™˚
, 
	`ˇr
(
p2
));

2897 
p2
 = 
	`cdr
(
n
 =Ö2);

2898 
	`dñëe_obje˘
(
ö°™˚
, 
n
);

2899 } 
p2
 !&
Æß_li•_nû
);

2901 
	`dñëe_åì
(
ö°™˚
, 
p1
);

2902  &
Æß_li•_nû
;

2903 
	}
}

2905 
Æi•_obje˘
 * 
	$F_dump_mem‹y
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2907 
Æi•_obje˘
 * 
p
 = 
	`ˇr
(
¨gs
);

2909 i‡(
p
 !&
Æß_li•_nû
 && 
	`cdr
(
¨gs
) == &alsa_lisp_nil &&

2910 
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_STRING
)) {

2911 i‡(
	`°æí
(
p
->
vÆue
.
s
) > 0) {

2912 
	`dump_obje˘s
(
ö°™˚
, 
p
->
vÆue
.
s
);

2913 
	`dñëe_åì
(
ö°™˚
, 
¨gs
);

2914  &
Æß_li•_t
;

2916 
	`li•_w¨n
(
ö°™˚
, "expected filename");

2918 
	`li•_w¨n
(
ö°™˚
, "wrongÇumber ofÖarameters (expected string)");

2920 
	`dñëe_åì
(
ö°™˚
, 
¨gs
);

2921  &
Æß_li•_nû
;

2922 
	}
}

2924 
Æi•_obje˘
 * 
	$F_°©_mem‹y
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2926 
	`¢d_ouçut_¥ötf
(
ö°™˚
->
out
, "*** Memory stats\n");

2927 
	`¢d_ouçut_¥ötf
(
ö°™˚
->
out
, " used_objs = %li, free_objs = %li, max_objs = %li, obj_size = %i (total bytes = %li, max bytes = %li)\n",

2928 
ö°™˚
->
u£d_objs
,

2929 
ö°™˚
->
‰ì_objs
,

2930 
ö°™˚
->
max_objs
,

2931 ()(
Æi•_obje˘
),

2932 ()((
ö°™˚
->
u£d_objs
 + in°™˚->
‰ì_objs
Ë* (
Æi•_obje˘
)),

2933 ()(
ö°™˚
->
max_objs
 * (
Æi•_obje˘
)));

2934 
	`dñëe_åì
(
ö°™˚
, 
¨gs
);

2935  &
Æß_li•_nû
;

2936 
	}
}

2938 
Æi•_obje˘
 * 
	$F_check_mem‹y
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2940 
	`dñëe_åì
(
ö°™˚
, 
¨gs
);

2941 i‡(
ö°™˚
->
u£d_objs
 > 0) {

2942 
	`Ârötf
(
°dîr
, "!!!alsaÜisp - check memory failed!!!\n");

2943 
	`F_°©_mem‹y
(
ö°™˚
, &
Æß_li•_nû
);

2944 
	`exô
(
EXIT_FAILURE
);

2946  &
Æß_li•_t
;

2947 
	}
}

2949 
Æi•_obje˘
 * 
	$F_dump_obje˘s
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

2951 
Æi•_obje˘
 * 
p
 = 
	`ˇr
(
¨gs
);

2953 i‡(
p
 !&
Æß_li•_nû
 && 
	`cdr
(
¨gs
) == &alsa_lisp_nil &&

2954 
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_STRING
)) {

2955 i‡(
	`°æí
(
p
->
vÆue
.
s
) > 0) {

2956 
	`dump_obj_li°s
(
ö°™˚
, 
p
->
vÆue
.
s
);

2957 
	`dñëe_åì
(
ö°™˚
, 
¨gs
);

2958  &
Æß_li•_t
;

2960 
	`li•_w¨n
(
ö°™˚
, "expected filename");

2962 
	`li•_w¨n
(
ö°™˚
, "wrongÇumber ofÖarameters (expected string)");

2964 
	`dñëe_åì
(
ö°™˚
, 
¨gs
);

2965  &
Æß_li•_nû
;

2966 
	}
}

2968 
	söåösic
 {

2969 c⁄° *
	m«me
;

2970 
	mÆi•_obje˘
 * (*
	mfunc
)(
Æi•_ö°™˚
 *
	mö°™˚
, 
Æi•_obje˘
 * 
	m¨gs
);

2973 c⁄° 
öåösic
 
	göåösics
[] = {

2974 { "!=", 
F_num√q
 },

2975 { "%", 
F_mod
 },

2976 { "&check-mem‹y", 
F_check_mem‹y
 },

2977 { "&dump-mem‹y", 
F_dump_mem‹y
 },

2978 { "&dump-obje˘s", 
F_dump_obje˘s
 },

2979 { "&°©-mem‹y", 
F_°©_mem‹y
 },

2980 { "*", 
F_mul
 },

2981 { "+", 
F_add
 },

2982 { "-", 
F_sub
 },

2983 { "/", 
F_div
 },

2984 { "<", 
F_…
 },

2985 { "<=", 
F_À
 },

2986 { "=", 
F_numeq
 },

2987 { ">", 
F_gt
 },

2988 { ">=", 
F_ge
 },

2989 { "™d", 
F_™d
 },

2990 { "assoc", 
F_assoc
 },

2991 { "assq", 
F_assq
 },

2992 { "©om", 
F_©om
 },

2993 { "ˇr", 
F_ˇr
 },

2994 { "cdr", 
F_cdr
 },

2995 { "com∑ª-°rögs", 
F_com∑ª_°rögs
 },

2996 { "c⁄ˇt", 
F_c⁄ˇt
 },

2997 { "c⁄d", 
F_c⁄d
 },

2998 { "c⁄s", 
F_c⁄s
 },

2999 { "defun", 
F_defun
 },

3000 { "eq", 
F_eq
 },

3001 { "equÆ", 
F_equÆ
 },

3002 { "evÆ", 
F_evÆ
 },

3003 { "exfun", 
F_exfun
 },

3004 { "f‹m©", 
F_f‹m©
 },

3005 { "funˇŒ", 
F_funˇŒ
 },

3006 { "g¨bage-cﬁÀ˘", 
F_gc
 },

3007 { "gc", 
F_gc
 },

3008 { "if", 
F_if
 },

3009 { "ö˛ude", 
F_ö˛ude
 },

3010 { "li°", 
F_li°
 },

3011 { "nŸ", 
F_nŸ
 },

3012 { "¡h", 
F_¡h
 },

3013 { "nuŒ", 
F_nŸ
 },

3014 { "‹", 
F_‹
 },

3015 { "∑th", 
F_∑th
 },

3016 { "¥öc", 
F_¥öc
 },

3017 { "¥og1", 
F_¥og1
 },

3018 { "¥og2", 
F_¥og2
 },

3019 { "¥ogn", 
F_¥ogn
 },

3020 { "quŸe", 
F_quŸe
 },

3021 { "øssoc", 
F_øssoc
 },

3022 { "øssq", 
F_øssq
 },

3023 { "£t", 
F_£t
 },

3024 { "£tf", 
F_£tq
 },

3025 { "£tq", 
F_£tq
 },

3026 { "°rög-equÆ", 
F_equÆ
 },

3027 { "°rög-to-Êﬂt", 
F_°rög_to_Êﬂt
 },

3028 { "°rög-to-öãgî", 
F_°rög_to_öãgî
 },

3029 { "°rög-to-numbî", 
F_°rög_to_Êﬂt
 },

3030 { "°rög=", 
F_equÆ
 },

3031 { "u∆ess", 
F_u∆ess
 },

3032 { "un£t", 
F_un£t
 },

3033 { "un£tf", 
F_un£tq
 },

3034 { "un£tq", 
F_un£tq
 },

3035 { "whí", 
F_whí
 },

3036 { "whûe", 
F_whûe
 },

3039 
	~"Æi•_¢d.c
"

3041 
	$com∑r
(c⁄° *
p1
, c⁄° *
p2
)

3043  
	`°rcmp
(((
öåösic
 *)
p1
)->
«me
,

3044 ((
öåösic
 *)
p2
)->
«me
);

3045 
	}
}

3047 
ölöe
 
Æi•_obje˘
 * 
	$evÆ_c⁄s1
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
p1
, Æi•_obje˘ * 
p2
)

3049 
Æi•_obje˘
 * 
p3
;

3050 
öåösic
 
key
, *
ôem
;

3052 
key
.
«me
 = 
p1
->
vÆue
.
s
;

3054 i‡((
ôem
 = 
	`b£¨ch
(&
key
, 
öåösics
,

3055  
öåösics
 /  intrinsics[0],

3056  
öåösics
[0], 
com∑r
)Ë!
NULL
) {

3057 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

3058  
ôem
->
	`func
(
ö°™˚
, 
p2
);

3061 i‡((
ôem
 = 
	`b£¨ch
(&
key
, 
¢d_öåösics
,

3062  
¢d_öåösics
 /  snd_intrinsics[0],

3063  
¢d_öåösics
[0], 
com∑r
)Ë!
NULL
) {

3064 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

3065  
ôem
->
	`func
(
ö°™˚
, 
p2
);

3068 i‡((
p3
 = 
	`gë_obje˘
(
ö°™˚
, 
p1
)Ë!&
Æß_li•_nû
) {

3069 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

3070  
	`evÆ_func
(
ö°™˚
, 
p3
, 
p2
);

3072 
	`li•_w¨n
(
ö°™˚
, "fun˘i⁄ `%s' i†undeföed", 
p1
->
vÆue
.
s
);

3073 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

3074 
	`dñëe_åì
(
ö°™˚
, 
p2
);

3077  &
Æß_li•_nû
;

3078 
	}
}

3083 
Æi•_obje˘
 * 
	$F_funˇŒ
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

3085 
Æi•_obje˘
 * 
p
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
)), * 
p1
;

3087 i‡(!
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_IDENTIFIER
) &&

3088 !
	`Æi•_com∑ª_ty≥
(
p
, 
ALISP_OBJ_STRING
)) {

3089 
	`li•_w¨n
(
ö°™˚
, "expectedán functionÇame");

3090 
	`dñëe_åì
(
ö°™˚
, 
p
);

3091 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

3092 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

3093  &
Æß_li•_nû
;

3095 
p1
 = 
	`cdr
(
¨gs
);

3096 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

3097  
	`evÆ_c⁄s1
(
ö°™˚
, 
p
, 
p1
);

3098 
	}
}

3100 
ölöe
 
Æi•_obje˘
 * 
	$evÆ_c⁄s
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
p
)

3102 
Æi•_obje˘
 * 
p1
 = 
	`ˇr
(
p
), * 
p2
;

3104 i‡(
p1
 !&
Æß_li•_nû
 && 
	`Æi•_com∑ª_ty≥
’1, 
ALISP_OBJ_IDENTIFIER
)) {

3105 i‡(!
	`°rcmp
(
p1
->
vÆue
.
s
, "lambda"))

3106  
p
;

3108 
p2
 = 
	`cdr
(
p
);

3109 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

3110  
	`evÆ_c⁄s1
(
ö°™˚
, 
p1
, 
p2
);

3112 
	`dñëe_åì
(
ö°™˚
, 
p
);

3115  &
Æß_li•_nû
;

3116 
	}
}

3118 
Æi•_obje˘
 * 
	$evÆ
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
p
)

3120 
	`Æi•_gë_ty≥
(
p
)) {

3121 
ALISP_OBJ_IDENTIFIER
: {

3122 
Æi•_obje˘
 *
r
 = 
	`ö¸ef_åì
(
ö°™˚
, 
	`gë_obje˘
(ö°™˚, 
p
));

3123 
	`dñëe_obje˘
(
ö°™˚
, 
p
);

3124  
r
;

3126 
ALISP_OBJ_INTEGER
:

3127 
ALISP_OBJ_FLOAT
:

3128 
ALISP_OBJ_STRING
:

3129 
ALISP_OBJ_POINTER
:

3130  
p
;

3131 
ALISP_OBJ_CONS
:

3132  
	`evÆ_c⁄s
(
ö°™˚
, 
p
);

3137  
p
;

3138 
	}
}

3140 
Æi•_obje˘
 * 
	$F_evÆ
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

3142  
	`evÆ
(
ö°™˚
,ÉvÆ(ö°™˚, 
	`ˇr
(
¨gs
)));

3143 
	}
}

3149 
	$Æi•_ö˛ude_fûe
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
fûíame
)

3151 
¢d_öput_t
 *
ﬁd_ö
;

3152 
Æi•_obje˘
 *
p
, *
p1
;

3153 *
«me
;

3154 
ªtvÆ
 = 0, 
îr
;

3156 
îr
 = 
	`¢d_u£r_fûe
(
fûíame
, &
«me
);

3157 i‡(
îr
 < 0)

3158  
îr
;

3159 
ﬁd_ö
 = 
ö°™˚
->
ö
;

3160 
îr
 = 
	`¢d_öput_°dio_›í
(&
ö°™˚
->
ö
, 
«me
, "r");

3161 i‡(
îr
 < 0) {

3162 
ªtvÆ
 = 
îr
;

3163 
_îr
;

3165 i‡(
ö°™˚
->
vîbo£
)

3166 
	`li•_vîbo£
(
ö°™˚
, "** in˛udêfûíamê'%s'", 
«me
);

3169 i‡((
p
 = 
	`∑r£_obje˘
(
ö°™˚
, 0)Ë=
NULL
)

3171 i‡(
ö°™˚
->
vîbo£
) {

3172 
	`li•_vîbo£
(
ö°™˚
, "** code");

3173 
	`¥öc_obje˘
(
ö°™˚
->
vout
, 
p
);

3174 
	`¢d_ouçut_putc
(
ö°™˚
->
vout
, '\n');

3176 
p1
 = 
	`evÆ
(
ö°™˚
, 
p
);

3177 i‡(
p1
 =
NULL
) {

3178 
ªtvÆ
 = -
ENOMEM
;

3181 i‡(
ö°™˚
->
vîbo£
) {

3182 
	`li•_vîbo£
(
ö°™˚
, "**Ñesult");

3183 
	`¥öc_obje˘
(
ö°™˚
->
vout
, 
p1
);

3184 
	`¢d_ouçut_putc
(
ö°™˚
->
vout
, '\n');

3186 
	`dñëe_åì
(
ö°™˚
, 
p1
);

3187 i‡(
ö°™˚
->
debug
) {

3188 
	`li•_debug
(
ö°™˚
, "** objectsáfter operation");

3189 
	`¥öt_obj_li°s
(
ö°™˚
, in°™˚->
dout
);

3193 
	`¢d_öput_˛o£
(
ö°™˚
->
ö
);

3194 
_îr
:

3195 
	`‰ì
(
«me
);

3196 
ö°™˚
->
ö
 = 
ﬁd_ö
;

3197  
ªtvÆ
;

3198 
	}
}

3200 
	$Æß_li•
(
Æi•_cfg
 *
cfg
, 
Æi•_ö°™˚
 **
_ö°™˚
)

3202 
Æi•_ö°™˚
 *
ö°™˚
;

3203 
Æi•_obje˘
 *
p
, *
p1
;

3204 
i
, 
j
, 
ªtvÆ
 = 0;

3206 
ö°™˚
 = (
Æi•_ö°™˚
 *)
	`ˇŒoc
(1, (alisp_instance));

3207 i‡(
ö°™˚
 =
NULL
) {

3208 
	`nomem
();

3209  -
ENOMEM
;

3211 
ö°™˚
->
vîbo£
 = 
cfg
->vîbo£ && cfg->
vout
;

3212 
ö°™˚
->
w¨nög
 = 
cfg
->w¨nög && cfg->
wout
;

3213 
ö°™˚
->
debug
 = 
cfg
->debug && cfg->
dout
;

3214 
ö°™˚
->
ö
 = 
cfg
->in;

3215 
ö°™˚
->
out
 = 
cfg
->out;

3216 
ö°™˚
->
vout
 = 
cfg
->vout;

3217 
ö°™˚
->
eout
 = 
cfg
->eout;

3218 
ö°™˚
->
wout
 = 
cfg
->wout;

3219 
ö°™˚
->
dout
 = 
cfg
->dout;

3220 
	`INIT_LIST_HEAD
(&
ö°™˚
->
‰ì_objs_li°
);

3221 
i
 = 0; i < 
ALISP_OBJ_PAIR_HASH_SIZE
; i++) {

3222 
j
 = 0; j <
ALISP_OBJ_LAST_SEARCH
; j++)

3223 
	`INIT_LIST_HEAD
(&
ö°™˚
->
u£d_objs_li°
[
i
][
j
]);

3224 
	`INIT_LIST_HEAD
(&
ö°™˚
->
£tobjs_li°
[
i
]);

3227 
	`öô_Àx
(
ö°™˚
);

3230 i‡((
p
 = 
	`∑r£_obje˘
(
ö°™˚
, 0)Ë=
NULL
)

3232 i‡(
ö°™˚
->
vîbo£
) {

3233 
	`li•_vîbo£
(
ö°™˚
, "** code");

3234 
	`¥öc_obje˘
(
ö°™˚
->
vout
, 
p
);

3235 
	`¢d_ouçut_putc
(
ö°™˚
->
vout
, '\n');

3237 
p1
 = 
	`evÆ
(
ö°™˚
, 
p
);

3238 i‡(
p1
 =
NULL
) {

3239 
ªtvÆ
 = -
ENOMEM
;

3242 i‡(
ö°™˚
->
vîbo£
) {

3243 
	`li•_vîbo£
(
ö°™˚
, "**Ñesult");

3244 
	`¥öc_obje˘
(
ö°™˚
->
vout
, 
p1
);

3245 
	`¢d_ouçut_putc
(
ö°™˚
->
vout
, '\n');

3247 
	`dñëe_åì
(
ö°™˚
, 
p1
);

3248 i‡(
ö°™˚
->
debug
) {

3249 
	`li•_debug
(
ö°™˚
, "** objectsáfter operation");

3250 
	`¥öt_obj_li°s
(
ö°™˚
, in°™˚->
dout
);

3254 i‡(
_ö°™˚
)

3255 *
_ö°™˚
 = 
ö°™˚
;

3257 
	`Æß_li•_‰ì
(
ö°™˚
);

3259  
ªtvÆ
;

3260 
	}
}

3262 
	$Æß_li•_‰ì
(
Æi•_ö°™˚
 *
ö°™˚
)

3264 i‡(
ö°™˚
 =
NULL
)

3266 
	`d⁄e_Àx
(
ö°™˚
);

3267 
	`‰ì_obje˘s
(
ö°™˚
);

3268 
	`‰ì
(
ö°™˚
);

3269 
	}
}

3271 
Æi•_cfg
 *
	$Æß_li•_deÁu…_cfg
(
¢d_öput_t
 *
öput
)

3273 
¢d_ouçut_t
 *
ouçut
, *
eouçut
;

3274 
Æi•_cfg
 *
cfg
;

3275 
îr
;

3277 
îr
 = 
	`¢d_ouçut_°dio_©èch
(&
ouçut
, 
°dout
, 0);

3278 i‡(
îr
 < 0)

3279  
NULL
;

3280 
îr
 = 
	`¢d_ouçut_°dio_©èch
(&
eouçut
, 
°dîr
, 0);

3281 i‡(
îr
 < 0) {

3282 
	`¢d_ouçut_˛o£
(
ouçut
);

3283  
NULL
;

3285 
cfg
 = 
	`ˇŒoc
(1, (
Æi•_cfg
));

3286 i‡(
cfg
 =
NULL
) {

3287 
	`¢d_ouçut_˛o£
(
eouçut
);

3288 
	`¢d_ouçut_˛o£
(
ouçut
);

3289  
NULL
;

3291 
cfg
->
out
 = 
ouçut
;

3292 
cfg
->
wout
 = 
eouçut
;

3293 
cfg
->
eout
 = 
eouçut
;

3294 
cfg
->
dout
 = 
eouçut
;

3295 
cfg
->
ö
 = 
öput
;

3296  
cfg
;

3297 
	}
}

3299 
	$Æß_li•_deÁu…_cfg_‰ì
(
Æi•_cfg
 *
cfg
)

3301 
	`¢d_öput_˛o£
(
cfg
->
ö
);

3302 
	`¢d_ouçut_˛o£
(
cfg
->
out
);

3303 
	`¢d_ouçut_˛o£
(
cfg
->
dout
);

3304 
	`‰ì
(
cfg
);

3305 
	}
}

3307 
	$Æß_li•_fun˘i⁄
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_£q_ôî©‹
 **
ªsu…
,

3308 c⁄° *
id
, c⁄° *
¨gs
, ...)

3310 
îr
 = 0;

3311 
Æi•_obje˘
 *
Ørgs
 = 
NULL
, *
obj
, *
ªs
;

3313 i‡(
¨gs
 && *args != 'n') {

3314 
va_li°
 
≠
;

3315 
Æi•_obje˘
 *
p
;

3316 
p
 = 
NULL
;

3317 
	`va_°¨t
(
≠
, 
¨gs
);

3318 *
¨gs
) {

3319 i‡(*
¨gs
++ != '%') {

3320 
îr
 = -
EINVAL
;

3323 i‡(*
¨gs
 == '\0') {

3324 
îr
 = -
EINVAL
;

3327 
obj
 = 
NULL
;

3328 
îr
 = 0;

3329 *
¨gs
++) {

3331 
obj
 = 
	`√w_°rög
(
ö°™˚
, 
	`va_¨g
(
≠
, *));

3334 
obj
 = 
	`√w_öãgî
(
ö°™˚
, 
	`va_¨g
(
≠
, ));

3337 
obj
 = 
	`√w_öãgî
(
ö°™˚
, 
	`va_¨g
(
≠
, ));

3341 
obj
 = 
	`√w_öãgî
(
ö°™˚
, 
	`va_¨g
(
≠
, ));

3344 
_±rid
[24];

3345 *
±rid
 = 
_±rid
;

3346 *
¨gs
 && *args != '%')

3347 *
±rid
++ = *
¨gs
++;

3348 *
±rid
 = 0;

3349 i‡(
±rid
 =
_±rid
) {

3350 
îr
 = -
EINVAL
;

3353 
obj
 = 
	`√w_c⁄s_poöãr
(
ö°™˚
, 
_±rid
, 
	`va_¨g
(
≠
, *));

3354 
obj
 = 
	`quŸe_obje˘
(
ö°™˚
, obj);

3358 
îr
 = -
EINVAL
;

3361 i‡(
îr
 < 0)

3362 
__¨gs_íd
;

3363 i‡(
obj
 =
NULL
) {

3364 
îr
 = -
ENOMEM
;

3365 
__¨gs_íd
;

3367 i‡(
p
 =
NULL
) {

3368 
p
 = 
Ørgs
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

3370 
p
->
vÆue
.
c
.
cdr
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

3371 
p
 =Ö->
vÆue
.
c
.
cdr
;

3373 i‡(
p
 =
NULL
) {

3374 
îr
 = -
ENOMEM
;

3375 
__¨gs_íd
;

3377 
p
->
vÆue
.
c
.
ˇr
 = 
obj
;

3379 
__¨gs_íd
:

3380 
	`va_íd
(
≠
);

3381 i‡(
îr
 < 0)

3382  
îr
;

3384 
	`¢d_ouçut_¥ötf
(
ö°™˚
->
wout
, ">>>");

3385 
	`¥öc_obje˘
(
ö°™˚
->
wout
, 
Ørgs
);

3386 
	`¢d_ouçut_¥ötf
(
ö°™˚
->
wout
, "<<<\n");

3390 
îr
 = -
ENOENT
;

3391 i‡(
Ørgs
 =
NULL
)

3392 
Ørgs
 = &
Æß_li•_nû
;

3393 i‡((
obj
 = 
	`gë_obje˘1
(
ö°™˚
, 
id
)Ë!&
Æß_li•_nû
) {

3394 
ªs
 = 
	`evÆ_func
(
ö°™˚
, 
obj
, 
Ørgs
);

3395 
îr
 = 0;

3397 
öåösic
 
key
, *
ôem
;

3398 
key
.
«me
 = 
id
;

3399 i‡((
ôem
 = 
	`b£¨ch
(&
key
, 
öåösics
,

3400  
öåösics
 /  intrinsics[0],

3401  
öåösics
[0], 
com∑r
)Ë!
NULL
) {

3402 
ªs
 = 
ôem
->
	`func
(
ö°™˚
, 
Ørgs
);

3403 
îr
 = 0;

3404 } i‡((
ôem
 = 
	`b£¨ch
(&
key
, 
¢d_öåösics
,

3405  
¢d_öåösics
 /  snd_intrinsics[0],

3406  
¢d_öåösics
[0], 
com∑r
)Ë!
NULL
) {

3407 
ªs
 = 
ôem
->
	`func
(
ö°™˚
, 
Ørgs
);

3408 
îr
 = 0;

3410 
ªs
 = &
Æß_li•_nû
;

3413 i‡(
ªs
 =
NULL
)

3414 
îr
 = -
ENOMEM
;

3415 i‡(
îr
 =0 && 
ªsu…
) {

3416 *
ªsu…
 = 
ªs
;

3418 
	`dñëe_åì
(
ö°™˚
, 
ªs
);

3422 
	}
}

3424 
	$Æß_li•_ªsu…_‰ì
(
Æi•_ö°™˚
 *
ö°™˚
,

3425 
Æi•_£q_ôî©‹
 *
ªsu…
)

3427 
	`dñëe_åì
(
ö°™˚
, 
ªsu…
);

3428 
	}
}

3430 
	$Æß_li•_£q_fú°
(
Æi•_ö°™˚
 *
ö°™˚
, c⁄° *
id
,

3431 
Æi•_£q_ôî©‹
 **
£q
)

3433 
Æi•_obje˘
 * 
p1
;

3435 
p1
 = 
	`gë_obje˘1
(
ö°™˚
, 
id
);

3436 i‡(
p1
 =
NULL
)

3437  -
ENOMEM
;

3438 *
£q
 = 
p1
;

3440 
	}
}

3442 
	$Æß_li•_£q_√xt
(
Æi•_£q_ôî©‹
 **
£q
)

3444 
Æi•_obje˘
 * 
p1
 = *
£q
;

3446 
p1
 = 
	`cdr
(p1);

3447 i‡(
p1
 =&
Æß_li•_nû
)

3448  -
ENOENT
;

3449 *
£q
 = 
p1
;

3451 
	}
}

3453 
	$Æß_li•_£q_cou¡
(
Æi•_£q_ôî©‹
 *
£q
)

3455 
cou¡
 = 0;

3457 
£q
 !&
Æß_li•_nû
) {

3458 
cou¡
++;

3459 
£q
 = 
	`cdr
(seq);

3461  
cou¡
;

3462 
	}
}

3464 
	$Æß_li•_£q_öãgî
(
Æi•_£q_ôî©‹
 *
£q
, *
vÆ
)

3466 i‡(
	`Æi•_com∑ª_ty≥
(
£q
, 
ALISP_OBJ_CONS
))

3467 
£q
 = seq->
vÆue
.
c
.
cdr
;

3468 i‡(
	`Æi•_com∑ª_ty≥
(
£q
, 
ALISP_OBJ_INTEGER
))

3469 *
vÆ
 = 
£q
->
vÆue
.
i
;

3471  -
EINVAL
;

3473 
	}
}

3475 
	$Æß_li•_£q_poöãr
(
Æi•_£q_ôî©‹
 *
£q
, c⁄° *
±r_id
, **
±r
)

3477 
Æi•_obje˘
 * 
p2
;

3479 i‡(
	`Æi•_com∑ª_ty≥
(
£q
, 
ALISP_OBJ_CONS
) &&

3480 
	`Æi•_com∑ª_ty≥
(
£q
->
vÆue
.
c
.
ˇr
, 
ALISP_OBJ_CONS
))

3481 
£q
 = seq->
vÆue
.
c
.
ˇr
;

3482 i‡(
	`Æi•_com∑ª_ty≥
(
£q
, 
ALISP_OBJ_CONS
)) {

3483 
p2
 = 
£q
->
vÆue
.
c
.
ˇr
;

3484 i‡(!
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_STRING
))

3485  -
EINVAL
;

3486 i‡(
	`°rcmp
(
p2
->
vÆue
.
s
, 
±r_id
))

3487  -
EINVAL
;

3488 
p2
 = 
£q
->
vÆue
.
c
.
cdr
;

3489 i‡(!
	`Æi•_com∑ª_ty≥
(
p2
, 
ALISP_OBJ_POINTER
))

3490  -
EINVAL
;

3491 *
±r
 = (*)
£q
->
vÆue
.ptr;

3493  -
EINVAL
;

3495 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/alisp/alisp_local.h

24 
	~"li°.h
"

26 
	eÆi•_tokís
 {

27 
	mALISP_IDENTIFIER
,

28 
	mALISP_INTEGER
,

29 
	mALISP_FLOAT
,

30 
	mALISP_FLOATE
,

31 
	mALISP_STRING


34 
	eÆi•_obje˘s
 {

35 
	mALISP_OBJ_INTEGER
,

36 
	mALISP_OBJ_FLOAT
,

37 
	mALISP_OBJ_IDENTIFIER
,

38 
	mALISP_OBJ_STRING
,

39 
	mALISP_OBJ_POINTER
,

40 
	mALISP_OBJ_CONS
,

41 
	mALISP_OBJ_LAST_SEARCH
 = 
ALISP_OBJ_CONS
,

42 
	mALISP_OBJ_NIL
,

43 
	mALISP_OBJ_T
,

46 
	gÆi•_obje˘
;

48 
	#ALISP_TYPE_MASK
 0xf0000000

	)

49 
	#ALISP_TYPE_SHIFT
 28

	)

50 
	#ALISP_REFS_MASK
 0x0fffffff

	)

51 
	#ALISP_REFS_SHIFT
 0

	)

52 
	#ALISP_MAX_REFS
 (
ALISP_REFS_MASK
>>
ALISP_REFS_SHIFT
)

	)

53 
	#ALISP_MAX_REFS_LIMIT
 ((
ALISP_MAX_REFS
 + 1Ë/ 2)

	)

55 
	sÆi•_obje˘
 {

56 
li°_hód
 
	mli°
;

57 
	mty≥_ªfs
;

59 *
	ms
;

60 
	mi
;

61 
	mf
;

62 c⁄° *
	m±r
;

64 
Æi•_obje˘
 *
	mˇr
;

65 
Æi•_obje˘
 *
	mcdr
;

66 } 
	mc
;

67 } 
	mvÆue
;

70 
ölöe
 
Æi•_obje˘s
 
	$Æi•_gë_ty≥
(
Æi•_obje˘
 *
p
)

72  (
p
->
ty≥_ªfs
 >> 
ALISP_TYPE_SHIFT
);

73 
	}
}

75 
ölöe
 
	$Æi•_£t_ty≥
(
Æi•_obje˘
 *
p
, 
Æi•_obje˘s
 
ty≥
)

77 
p
->
ty≥_ªfs
 &~
ALISP_TYPE_MASK
;

78 
p
->
ty≥_ªfs
 |()
ty≥
 << 
ALISP_TYPE_SHIFT
;

79 
	}
}

81 
ölöe
 
	$Æi•_com∑ª_ty≥
(
Æi•_obje˘
 *
p
, 
Æi•_obje˘s
 
ty≥
)

83  (()
ty≥
 << 
ALISP_TYPE_SHIFT
) ==

84 (
p
->
ty≥_ªfs
 & 
ALISP_TYPE_MASK
);

85 
	}
}

87 
ölöe
 
	$Æi•_£t_ªfs
(
Æi•_obje˘
 *
p
, 
ªfs
)

89 
p
->
ty≥_ªfs
 &~
ALISP_REFS_MASK
;

90 
p
->
ty≥_ªfs
 |
ªfs
 & 
ALISP_REFS_MASK
;

91 
	}
}

93 
ölöe
 
	$Æi•_gë_ªfs
(
Æi•_obje˘
 *
p
)

95  
p
->
ty≥_ªfs
 & 
ALISP_REFS_MASK
;

96 
	}
}

98 
ölöe
 
	$Æi•_öc_ªfs
(
Æi•_obje˘
 *
p
)

100 
r
 = 
	`Æi•_gë_ªfs
(
p
) + 1;

101 
	`Æi•_£t_ªfs
(
p
, 
r
);

102  
r
;

103 
	}
}

105 
ölöe
 
	$Æi•_dec_ªfs
(
Æi•_obje˘
 *
p
)

107 
r
 = 
	`Æi•_gë_ªfs
(
p
) - 1;

108 
	`Æi•_£t_ªfs
(
p
, 
r
);

109  
r
;

110 
	}
}

112 
	sÆi•_obje˘_∑ú
 {

113 
li°_hód
 
	mli°
;

114 c⁄° *
	m«me
;

115 
Æi•_obje˘
 *
	mvÆue
;

118 
	#ALISP_LEX_BUF_MAX
 16

	)

119 
	#ALISP_OBJ_PAIR_HASH_SHIFT
 4

	)

120 
	#ALISP_OBJ_PAIR_HASH_SIZE
 (1<<
ALISP_OBJ_PAIR_HASH_SHIFT
)

	)

121 
	#ALISP_OBJ_PAIR_HASH_MASK
 (
ALISP_OBJ_PAIR_HASH_SIZE
-1)

	)

122 
	#ALISP_FREE_OBJ_POOL
 512

	)

124 
	sÆi•_ö°™˚
 {

125 
	mvîbo£
: 1,

126 
	mw¨nög
: 1,

127 
	mdebug
: 1;

129 
¢d_öput_t
 *
	mö
;

130 
¢d_ouçut_t
 *
	mout
;

131 
¢d_ouçut_t
 *
	meout
;

132 
¢d_ouçut_t
 *
	mvout
;

133 
¢d_ouçut_t
 *
	mwout
;

134 
¢d_ouçut_t
 *
	mdout
;

136 
	mch¨no
;

137 
	mlöío
;

138 
	mÀx_buf
[
ALISP_LEX_BUF_MAX
];

139 *
	mÀx_buÂ
;

140 *
	mtokí_buf„r
;

141 
	mtokí_buf„r_max
;

142 
	mthi°okí
;

144 
	m‰ì_objs
;

145 
	mu£d_objs
;

146 
	mmax_objs
;

147 
li°_hód
 
	m‰ì_objs_li°
;

148 
li°_hód
 
	mu£d_objs_li°
[
ALISP_OBJ_PAIR_HASH_SIZE
][
ALISP_OBJ_LAST_SEARCH
 + 1];

150 
li°_hód
 
	m£tobjs_li°
[
ALISP_OBJ_PAIR_HASH_SIZE
];

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/alisp/alisp_snd.c

22 
	~"../c⁄åﬁ/c⁄åﬁ_loˇl.h
"

24 
	saˇŒ_èbÀ
 {

25 c⁄° *
	m«me
;

26 
	mÆi•_obje˘
 * (*
	mfunc
Ë(
Æi•_ö°™˚
 *
	mö°™˚
, 
aˇŒ_èbÀ
 * 
	môem
, 
Æi•_obje˘
 * 
	m¨gs
);

27 * 
	mxfunc
;

28 c⁄° *
	m¥efix
;

35 
ölöe
 
	$gë_öãgî
(
Æi•_obje˘
 * 
obj
)

37 i‡(
	`Æi•_com∑ª_ty≥
(
obj
, 
ALISP_OBJ_INTEGER
))

38  
obj
->
vÆue
.
i
;

40 
	}
}

42 
ölöe
 c⁄° *
	$gë_poöãr
(
Æi•_obje˘
 * 
obj
)

44 i‡(
	`Æi•_com∑ª_ty≥
(
obj
, 
ALISP_OBJ_POINTER
))

45  
obj
->
vÆue
.
±r
;

46  
NULL
;

47 
	}
}

49 c⁄° *
	$gë_°rög
(
Æi•_obje˘
 * 
obj
, c⁄° * 
deÊt
)

51 i‡(
obj
 =&
Æß_li•_t
)

53 i‡(
	`Æi•_com∑ª_ty≥
(
obj
, 
ALISP_OBJ_STRING
) ||

54 
	`Æi•_com∑ª_ty≥
(
obj
, 
ALISP_OBJ_IDENTIFIER
))

55  
obj
->
vÆue
.
s
;

56  
deÊt
;

57 
	}
}

59 
	sÊags
 {

60 c⁄° *
	mkey
;

61 
	mmask
;

64 
	$gë_Êags
(
Æi•_ö°™˚
 * 
ö°™˚
,

65 
Æi•_obje˘
 * 
obj
,

66 c⁄° 
Êags
 * flags,

67 
deÊt
)

69 c⁄° *
key
;

70 
övît
;

71 
ªsu…
;

72 c⁄° 
Êags
 *
±r
;

73 
Æi•_obje˘
 *
n
;

75 i‡(
obj
 =&
Æß_li•_nû
)

76  
deÊt
;

77 
ªsu…
 = 
deÊt
;

79 
key
 = 
	`gë_°rög
(
obj
, 
NULL
);

80 i‡(
key
) {

81 
övît
 = 
key
[0] == '!';

82 
key
 +
övît
;

83 
±r
 = 
Êags
;

84 
±r
->
key
) {

85 i‡(!
	`°rcmp
(
±r
->
key
, key)) {

86 i‡(
övît
)

87 
ªsu…
 &~
±r
->
mask
;

89 
ªsu…
 |
±r
->
mask
;

92 
±r
++;

95 
	`dñëe_åì
(
ö°™˚
, 
	`ˇr
(
obj
));

96 
obj
 = 
	`cdr
(
n
 = obj);

97 
	`dñëe_obje˘
(
ö°™˚
, 
n
);

98 } 
obj
 !&
Æß_li•_nû
);

99  
ªsu…
;

100 
	}
}

102 c⁄° *
	$gë_±r
(
Æi•_ö°™˚
 * 
ö°™˚
,

103 
Æi•_obje˘
 * 
obj
,

104 c⁄° *
_±r_id
)

106 c⁄° *
±r_id
;

107 c⁄° *
±r
;

109 
±r_id
 = 
	`gë_°rög
(
	`ˇr
(
obj
), 
NULL
);

110 i‡(
±r_id
 =
NULL
) {

111 
	`dñëe_åì
(
ö°™˚
, 
obj
);

112  
NULL
;

114 i‡(
	`°rcmp
(
±r_id
, 
_±r_id
)) {

115 
	`dñëe_åì
(
ö°™˚
, 
obj
);

116  
NULL
;

118 
±r
 = 
	`gë_poöãr
(
	`cdr
(
obj
));

119 
	`dñëe_åì
(
ö°™˚
, 
obj
);

120  
±r
;

121 
	}
}

123 
Æi•_obje˘
 * 
	$√w_Àx¥
(
Æi•_ö°™˚
 * 
ö°™˚
, 
îr
)

125 
Æi•_obje˘
 * 
Àx¥
;

127 
Àx¥
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

128 i‡(
Àx¥
 =
NULL
)

129  
NULL
;

130 
Àx¥
->
vÆue
.
c
.
ˇr
 = 
	`√w_öãgî
(
ö°™˚
, 
îr
);

131 i‡(
Àx¥
->
vÆue
.
c
.
ˇr
 =
NULL
) {

132 
	`dñëe_obje˘
(
ö°™˚
, 
Àx¥
);

133  
NULL
;

135 
Àx¥
->
vÆue
.
c
.
cdr
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

136 i‡(
Àx¥
->
vÆue
.
c
.
cdr
 =
NULL
) {

137 
	`dñëe_obje˘
(
ö°™˚
, 
Àx¥
->
vÆue
.
c
.
ˇr
);

138 
	`dñëe_obje˘
(
ö°™˚
, 
Àx¥
);

139  
NULL
;

141  
Àx¥
;

142 
	}
}

144 
Æi•_obje˘
 * 
	$add_c⁄s
(
Æi•_ö°™˚
 * 
ö°™˚
,

145 
Æi•_obje˘
 *
Àx¥
,

146 
cdr
, c⁄° *
id
,

147 
Æi•_obje˘
 *
obj
)

149 
Æi•_obje˘
 * 
p1
, * 
p2
;

151 i‡(
Àx¥
 =
NULL
 || 
obj
 == NULL) {

152 
	`dñëe_åì
(
ö°™˚
, 
obj
);

153  
NULL
;

155 i‡(
cdr
) {

156 
p1
 = 
Àx¥
->
vÆue
.
c
.
cdr
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

158 
p1
 = 
Àx¥
->
vÆue
.
c
.
ˇr
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

160 
Àx¥
 = 
p1
;

161 i‡(
p1
 =
NULL
) {

162 
	`dñëe_åì
(
ö°™˚
, 
obj
);

163  
NULL
;

165 
p1
->
vÆue
.
c
.
ˇr
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

166 i‡((
p2
 = 
p1
->
vÆue
.
c
.
ˇr
Ë=
NULL
)

167 
__îr
;

168 
p2
->
vÆue
.
c
.
ˇr
 = 
	`√w_°rög
(
ö°™˚
, 
id
);

169 i‡(
p2
->
vÆue
.
c
.
ˇr
 =
NULL
) {

170 
__îr
:

171 i‡(
cdr
)

172 
Àx¥
->
vÆue
.
c
.
cdr
 = 
NULL
;

174 
Àx¥
->
vÆue
.
c
.
ˇr
 = 
NULL
;

175 
	`dñëe_åì
(
ö°™˚
, 
p1
);

176 
	`dñëe_åì
(
ö°™˚
, 
obj
);

177  
NULL
;

179 
p2
->
vÆue
.
c
.
cdr
 = 
obj
;

180  
Àx¥
;

181 
	}
}

183 
Æi•_obje˘
 * 
	$add_c⁄s2
(
Æi•_ö°™˚
 * 
ö°™˚
,

184 
Æi•_obje˘
 *
Àx¥
,

185 
cdr
, 
Æi•_obje˘
 *
obj
)

187 
Æi•_obje˘
 * 
p1
;

189 i‡(
Àx¥
 =
NULL
 || 
obj
 == NULL) {

190 
	`dñëe_åì
(
ö°™˚
, 
obj
);

191  
NULL
;

193 i‡(
cdr
) {

194 
p1
 = 
Àx¥
->
vÆue
.
c
.
cdr
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

196 
p1
 = 
Àx¥
->
vÆue
.
c
.
ˇr
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

198 
Àx¥
 = 
p1
;

199 i‡(
p1
 =
NULL
) {

200 
	`dñëe_åì
(
ö°™˚
, 
obj
);

201  
NULL
;

203 
p1
->
vÆue
.
c
.
ˇr
 = 
obj
;

204  
Àx¥
;

205 
	}
}

207 
Æi•_obje˘
 * 
	$√w_ªsu…1
(
Æi•_ö°™˚
 * 
ö°™˚
,

208 
îr
, c⁄° *
±r_id
, *
±r
)

210 
Æi•_obje˘
 * 
Àx¥
, * 
p1
;

212 i‡(
îr
 < 0)

213 
±r
 = 
NULL
;

214 
Àx¥
 = 
	`√w_obje˘
(
ö°™˚
, 
ALISP_OBJ_CONS
);

215 i‡(
Àx¥
 =
NULL
)

216  
NULL
;

217 
Àx¥
->
vÆue
.
c
.
ˇr
 = 
	`√w_öãgî
(
ö°™˚
, 
îr
);

218 i‡(
Àx¥
->
vÆue
.
c
.
ˇr
 =
NULL
) {

219 
	`dñëe_obje˘
(
ö°™˚
, 
Àx¥
);

220  
NULL
;

222 
p1
 = 
	`add_c⁄s
(
ö°™˚
, 
Àx¥
, 1, 
±r_id
, 
	`√w_poöãr
(ö°™˚, 
±r
));

223 i‡(
p1
 =
NULL
) {

224 
	`dñëe_obje˘
(
ö°™˚
, 
Àx¥
);

225  
NULL
;

227  
Àx¥
;

228 
	}
}

230 
Æi•_obje˘
 * 
	$√w_ªsu…2
(
Æi•_ö°™˚
 * 
ö°™˚
,

231 
îr
, 
vÆ
)

233 
Æi•_obje˘
 * 
Àx¥
, * 
p1
;

235 i‡(
îr
 < 0)

236 
vÆ
 = 0;

237 
Àx¥
 = 
	`√w_Àx¥
(
ö°™˚
, 
îr
);

238 i‡(
Àx¥
 =
NULL
)

239  
NULL
;

240 
p1
 = 
Àx¥
->
vÆue
.
c
.
cdr
;

241 
p1
->
vÆue
.
c
.
ˇr
 = 
	`√w_öãgî
(
ö°™˚
, 
vÆ
);

242 i‡(
p1
->
vÆue
.
c
.
ˇr
 =
NULL
) {

243 
	`dñëe_obje˘
(
ö°™˚
, 
Àx¥
);

244  
NULL
;

246  
Àx¥
;

247 
	}
}

249 
Æi•_obje˘
 * 
	$√w_ªsu…3
(
Æi•_ö°™˚
 * 
ö°™˚
,

250 
îr
, c⁄° *
°r
)

252 
Æi•_obje˘
 * 
Àx¥
, * 
p1
;

254 i‡(
îr
 < 0)

255 
°r
 = "";

256 
Àx¥
 = 
	`√w_Àx¥
(
ö°™˚
, 
îr
);

257 i‡(
Àx¥
 =
NULL
)

258  
NULL
;

259 
p1
 = 
Àx¥
->
vÆue
.
c
.
cdr
;

260 
p1
->
vÆue
.
c
.
ˇr
 = 
	`√w_°rög
(
ö°™˚
, 
°r
);

261 i‡(
p1
->
vÆue
.
c
.
ˇr
 =
NULL
) {

262 
	`dñëe_obje˘
(
ö°™˚
, 
Àx¥
);

263  
NULL
;

265  
Àx¥
;

266 
	}
}

276 (*
	t¢d_öt_µ_°Ω_öt_t
)(**
	tr˘l
, c⁄° *
	t«me
, 
	tmode
);

277 (*
	t¢d_öt_µ_p_t
)(**
	tr˘l
, *
	th™dÀ
);

278 (*
	t¢d_öt_p_t
)(*
	tr˘l
);

279 * (*
	t¢d_°r_p_t
)(*
	tr˘l
);

280 (*
	t¢d_öt_öç_t
)(*
	tvÆ
);

281 (*
	t¢d_öt_°r_t
)(c⁄° *
	t°r
);

282 (*
	t¢d_öt_öt_°Ω_t
)(
	tvÆ
, **
	t°r
);

283 *(*
	t¢d_p_p_t
)(*
	th™dÀ
);

285 
Æi•_obje˘
 * 
	$FA_öt_µ_°Ω_öt
(
Æi•_ö°™˚
 * 
ö°™˚
, 
aˇŒ_èbÀ
 * 
ôem
, 
Æi•_obje˘
 * 
¨gs
)

287 c⁄° *
«me
;

288 
îr
, 
mode
;

289 *
h™dÀ
;

290 
Æi•_obje˘
 *
p1
, *
p2
;

291 c⁄° 
Êags
 flags[] = {

292 { "n⁄block", 
SND_CTL_NONBLOCK
 },

293 { "async", 
SND_CTL_ASYNC
 },

294 { "ªad⁄ly", 
SND_CTL_READONLY
 },

295 { 
NULL
, 0 }

298 
«me
 = 
	`gë_°rög
(
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
)), 
NULL
);

299 i‡(
«me
 =
NULL
)

300  &
Æß_li•_nû
;

301 
mode
 = 
	`gë_Êags
(
ö°™˚
, 
p2
 = 
	`evÆ
(ö°™˚, 
	`ˇr
(
	`cdr
(
¨gs
))), 
Êags
, 0);

302 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

303 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

304 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

305 
	`dñëe_åì
(
ö°™˚
, 
p2
);

306 
îr
 = ((
¢d_öt_µ_°Ω_öt_t
)
ôem
->
xfunc
)(&
h™dÀ
, 
«me
, 
mode
);

307 
	`dñëe_åì
(
ö°™˚
, 
p1
);

308  
	`√w_ªsu…1
(
ö°™˚
, 
îr
, 
ôem
->
¥efix
, 
h™dÀ
);

309 
	}
}

311 
Æi•_obje˘
 * 
	$FA_öt_µ_p
(
Æi•_ö°™˚
 * 
ö°™˚
, 
aˇŒ_èbÀ
 * 
ôem
, 
Æi•_obje˘
 * 
¨gs
)

313 
îr
;

314 *
h™dÀ
;

315 c⁄° *
¥efix1
;

316 
Æi•_obje˘
 *
p1
;

318 i‡(
ôem
->
xfunc
 =&
¢d_h˘l_›í_˘l
)

319 
¥efix1
 = "ctl";

321 
	`dñëe_åì
(
ö°™˚
, 
¨gs
);

322  &
Æß_li•_nû
;

324 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

325 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

326 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

327 
h™dÀ
 = (*)
	`gë_±r
(
ö°™˚
, 
p1
, 
¥efix1
);

328 i‡(
h™dÀ
 =
NULL
)

329  &
Æß_li•_nû
;

330 
îr
 = ((
¢d_öt_µ_p_t
)
ôem
->
xfunc
)(&
h™dÀ
, handle);

331  
	`√w_ªsu…1
(
ö°™˚
, 
îr
, 
ôem
->
¥efix
, 
h™dÀ
);

332 
	}
}

334 
Æi•_obje˘
 * 
	$FA_p_p
(
Æi•_ö°™˚
 * 
ö°™˚
, 
aˇŒ_èbÀ
 * 
ôem
, 
Æi•_obje˘
 * 
¨gs
)

336 *
h™dÀ
;

337 c⁄° *
¥efix1
;

338 
Æi•_obje˘
 * 
p1
;

340 i‡(
ôem
->
xfunc
 =&
¢d_h˘l_fú°_ñem
 ||

341 
ôem
->
xfunc
 =&
¢d_h˘l_œ°_ñem
 ||

342 
ôem
->
xfunc
 =&
¢d_h˘l_ñem_√xt
 ||

343 
ôem
->
xfunc
 =&
¢d_h˘l_ñem_¥ev
)

344 
¥efix1
 = "hctl_elem";

345 i‡(
ôem
->
xfunc
 =&
¢d_h˘l_˘l
)

346 
¥efix1
 = "ctl";

348 
	`dñëe_åì
(
ö°™˚
, 
¨gs
);

349  &
Æß_li•_nû
;

351 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

352 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

353 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

354 
h™dÀ
 = (*)
	`gë_±r
(
ö°™˚
, 
p1
, 
ôem
->
¥efix
);

355 i‡(
h™dÀ
 =
NULL
)

356  &
Æß_li•_nû
;

357 
h™dÀ
 = ((
¢d_p_p_t
)
ôem
->
xfunc
)(handle);

358  
	`√w_c⁄s_poöãr
(
ö°™˚
, 
¥efix1
, 
h™dÀ
);

359 
	}
}

361 
Æi•_obje˘
 * 
	$FA_öt_p
(
Æi•_ö°™˚
 * 
ö°™˚
, 
aˇŒ_èbÀ
 * 
ôem
, 
Æi•_obje˘
 * 
¨gs
)

363 *
h™dÀ
;

364 
Æi•_obje˘
 * 
p1
;

366 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

367 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

368 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

369 
h™dÀ
 = (*)
	`gë_±r
(
ö°™˚
, 
p1
, 
ôem
->
¥efix
);

370 i‡(
h™dÀ
 =
NULL
)

371  &
Æß_li•_nû
;

372  
	`√w_öãgî
(
ö°™˚
, ((
¢d_öt_p_t
)
ôem
->
xfunc
)(
h™dÀ
));

373 
	}
}

375 
Æi•_obje˘
 * 
	$FA_°r_p
(
Æi•_ö°™˚
 * 
ö°™˚
, 
aˇŒ_èbÀ
 * 
ôem
, 
Æi•_obje˘
 * 
¨gs
)

377 *
h™dÀ
;

378 
Æi•_obje˘
 * 
p1
;

380 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

381 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

382 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

383 
h™dÀ
 = (*)
	`gë_±r
(
ö°™˚
, 
p1
, 
ôem
->
¥efix
);

384 i‡(
h™dÀ
 =
NULL
)

385  &
Æß_li•_nû
;

386  
	`√w_°rög
(
ö°™˚
, ((
¢d_°r_p_t
)
ôem
->
xfunc
)(
h™dÀ
));

387 
	}
}

389 
Æi•_obje˘
 * 
	$FA_öt_öç
(
Æi•_ö°™˚
 * 
ö°™˚
, 
aˇŒ_èbÀ
 * 
ôem
, 
Æi•_obje˘
 * 
¨gs
)

391 
vÆ
, 
îr
;

392 
Æi•_obje˘
 * 
p1
;

394 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

395 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

396 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

397 i‡(!
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
)) {

398 
	`dñëe_åì
(
ö°™˚
, 
p1
);

399  &
Æß_li•_nû
;

401 
vÆ
 = 
p1
->
vÆue
.
i
;

402 
	`dñëe_åì
(
ö°™˚
, 
p1
);

403 
îr
 = ((
¢d_öt_öç_t
)
ôem
->
xfunc
)(&
vÆ
);

404  
	`√w_ªsu…2
(
ö°™˚
, 
îr
, 
vÆ
);

405 
	}
}

407 
Æi•_obje˘
 * 
	$FA_öt_°r
(
Æi•_ö°™˚
 * 
ö°™˚
, 
aˇŒ_èbÀ
 * 
ôem
, 
Æi•_obje˘
 * 
¨gs
)

409 
îr
;

410 
Æi•_obje˘
 * 
p1
;

412 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

413 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

414 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

415 i‡(!
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_STRING
) &&

416 !
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_IDENTIFIER
)) {

417 
	`dñëe_åì
(
ö°™˚
, 
p1
);

418  &
Æß_li•_nû
;

420 
îr
 = ((
¢d_öt_°r_t
)
ôem
->
xfunc
)(
p1
->
vÆue
.
s
);

421 
	`dñëe_åì
(
ö°™˚
, 
p1
);

422  
	`√w_öãgî
(
ö°™˚
, 
îr
);

423 
	}
}

425 
Æi•_obje˘
 * 
	$FA_öt_öt_°Ω
(
Æi•_ö°™˚
 * 
ö°™˚
, 
aˇŒ_èbÀ
 * 
ôem
, 
Æi•_obje˘
 * 
¨gs
)

427 
îr
;

428 *
°r
;

429 
vÆ
;

430 
Æi•_obje˘
 * 
p1
;

432 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

433 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

434 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

435 i‡(!
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_INTEGER
)) {

436 
	`dñëe_åì
(
ö°™˚
, 
p1
);

437  &
Æß_li•_nû
;

439 
vÆ
 = 
p1
->
vÆue
.
i
;

440 
	`dñëe_åì
(
ö°™˚
, 
p1
);

441 
îr
 = ((
¢d_öt_öt_°Ω_t
)
ôem
->
xfunc
)(
vÆ
, &
°r
);

442  
	`√w_ªsu…3
(
ö°™˚
, 
îr
, 
°r
);

443 
	}
}

445 
Æi•_obje˘
 * 
	$FA_ˇrd_öfo
(
Æi•_ö°™˚
 * 
ö°™˚
, 
aˇŒ_èbÀ
 * 
ôem
, 
Æi•_obje˘
 * 
¨gs
)

447 
¢d_˘l_t
 *
h™dÀ
;

448 
Æi•_obje˘
 * 
Àx¥
, * 
p1
;

449 
¢d_˘l_ˇrd_öfo_t
 
öfo
 = {0};

450 
îr
;

452 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

453 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

454 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

455 
h™dÀ
 = (
¢d_˘l_t
 *)
	`gë_±r
(
ö°™˚
, 
p1
, 
ôem
->
¥efix
);

456 i‡(
h™dÀ
 =
NULL
)

457  &
Æß_li•_nû
;

458 
îr
 = 
	`¢d_˘l_ˇrd_öfo
(
h™dÀ
, &
öfo
);

459 
Àx¥
 = 
	`√w_Àx¥
(
ö°™˚
, 
îr
);

460 i‡(
îr
 < 0)

461  
Àx¥
;

462 
p1
 = 
	`add_c⁄s
(
ö°™˚
, 
Àx¥
->
vÆue
.
c
.
cdr
, 0, "id", 
	`√w_°rög
(ö°™˚, 
	`¢d_˘l_ˇrd_öfo_gë_id
(&
öfo
)));

463 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "drivî", 
	`√w_°rög
(ö°™˚, 
	`¢d_˘l_ˇrd_öfo_gë_drivî
(&
öfo
)));

464 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "«me", 
	`√w_°rög
(ö°™˚, 
	`¢d_˘l_ˇrd_öfo_gë_«me
(&
öfo
)));

465 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "l⁄g«me", 
	`√w_°rög
(ö°™˚, 
	`¢d_˘l_ˇrd_öfo_gë_l⁄g«me
(&
öfo
)));

466 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "mixî«me", 
	`√w_°rög
(ö°™˚, 
	`¢d_˘l_ˇrd_öfo_gë_mixî«me
(&
öfo
)));

467 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "comp⁄íts", 
	`√w_°rög
(ö°™˚, 
	`¢d_˘l_ˇrd_öfo_gë_comp⁄íts
(&
öfo
)));

468 i‡(
p1
 =
NULL
) {

469 
	`dñëe_åì
(
ö°™˚
, 
Àx¥
);

470  
NULL
;

472  
Àx¥
;

473 
	}
}

475 
Æi•_obje˘
 * 
	$¸óã_˘l_ñem_id
(
Æi•_ö°™˚
 * 
ö°™˚
, 
¢d_˘l_ñem_id_t
 * 
id
, 
Æi•_obje˘
 * 
c⁄s
)

477 
c⁄s
 = 
	`add_c⁄s
(
ö°™˚
, c⁄s, 0, "numid", 
	`√w_öãgî
(ö°™˚, 
	`¢d_˘l_ñem_id_gë_numid
(
id
)));

478 
c⁄s
 = 
	`add_c⁄s
(
ö°™˚
, c⁄s, 1, "iÁ˚", 
	`√w_°rög
(ö°™˚, 
	`¢d_˘l_ñem_iÁ˚_«me
(
	`¢d_˘l_ñem_id_gë_öãrÁ˚
(
id
))));

479 
c⁄s
 = 
	`add_c⁄s
(
ö°™˚
, c⁄s, 1, "dev", 
	`√w_öãgî
(ö°™˚, 
	`¢d_˘l_ñem_id_gë_devi˚
(
id
)));

480 
c⁄s
 = 
	`add_c⁄s
(
ö°™˚
, c⁄s, 1, "subdev", 
	`√w_öãgî
(ö°™˚, 
	`¢d_˘l_ñem_id_gë_subdevi˚
(
id
)));

481 
c⁄s
 = 
	`add_c⁄s
(
ö°™˚
, c⁄s, 1, "«me", 
	`√w_°rög
(ö°™˚, 
	`¢d_˘l_ñem_id_gë_«me
(
id
)));

482 
c⁄s
 = 
	`add_c⁄s
(
ö°™˚
, c⁄s, 1, "ödex", 
	`√w_öãgî
(ö°™˚, 
	`¢d_˘l_ñem_id_gë_ödex
(
id
)));

483  
c⁄s
;

484 
	}
}

486 
	$∑r£_˘l_ñem_id
(
Æi•_ö°™˚
 * 
ö°™˚
,

487 
Æi•_obje˘
 * 
c⁄s
,

488 
¢d_˘l_ñem_id_t
 * 
id
)

490 
Æi•_obje˘
 *
p1
;

491 c⁄° *
xid
;

493 i‡(
c⁄s
 =
NULL
)

494  -
ENOMEM
;

495 
	`¢d_˘l_ñem_id_˛ór
(
id
);

496 
id
->
numid
 = 0;

498 
p1
 = 
	`ˇr
(
c⁄s
);

499 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_CONS
)) {

500 
xid
 = 
	`gë_°rög
(
p1
->
vÆue
.
c
.
ˇr
, 
NULL
);

501 i‡(
xid
 =
NULL
) {

503 } i‡(!
	`°rcmp
(
xid
, "numid")) {

504 
	`¢d_˘l_ñem_id_£t_numid
(
id
, 
	`gë_öãgî
(
p1
->
vÆue
.
c
.
cdr
));

505 } i‡(!
	`°rcmp
(
xid
, "iface")) {

506 
	`¢d_˘l_ñem_id_£t_öãrÁ˚
(
id
, 
	`¢d_c⁄fig_gë_˘l_iÁ˚_ascii
(
	`gë_°rög
(
p1
->
vÆue
.
c
.
cdr
, "0")));

507 } i‡(!
	`°rcmp
(
xid
, "dev")) {

508 
	`¢d_˘l_ñem_id_£t_devi˚
(
id
, 
	`gë_öãgî
(
p1
->
vÆue
.
c
.
cdr
));

509 } i‡(!
	`°rcmp
(
xid
, "subdev")) {

510 
	`¢d_˘l_ñem_id_£t_subdevi˚
(
id
, 
	`gë_öãgî
(
p1
->
vÆue
.
c
.
cdr
));

511 } i‡(!
	`°rcmp
(
xid
, "name")) {

512 
	`¢d_˘l_ñem_id_£t_«me
(
id
, 
	`gë_°rög
(
p1
->
vÆue
.
c
.
cdr
, "?"));

513 } i‡(!
	`°rcmp
(
xid
, "index")) {

514 
	`¢d_˘l_ñem_id_£t_ödex
(
id
, 
	`gë_öãgî
(
p1
->
vÆue
.
c
.
cdr
));

517 
	`dñëe_åì
(
ö°™˚
, 
p1
);

518 
c⁄s
 = 
	`cdr
(
p1
 = cons);

519 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

520 } 
c⁄s
 !&
Æß_li•_nû
);

522 
	}
}

524 
Æi•_obje˘
 * 
	$FA_h˘l_föd_ñem
(
Æi•_ö°™˚
 * 
ö°™˚
, 
aˇŒ_èbÀ
 * 
ôem
, 
Æi•_obje˘
 * 
¨gs
)

526 
¢d_h˘l_t
 *
h™dÀ
;

527 
¢d_˘l_ñem_id_t
 
id
 = {0};

528 
Æi•_obje˘
 *
p1
;

530 
h™dÀ
 = (
¢d_h˘l_t
 *)
	`gë_±r
(
ö°™˚
, 
	`ˇr
(
¨gs
), 
ôem
->
¥efix
);

531 i‡(
h™dÀ
 =
NULL
) {

532 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

533 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

534  &
Æß_li•_nû
;

536 
p1
 = 
	`ˇr
(
	`cdr
(
¨gs
));

537 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

538 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

539 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

540 i‡(
	`∑r£_˘l_ñem_id
(
ö°™˚
, 
	`evÆ
(ö°™˚, 
p1
), &
id
) < 0)

541  &
Æß_li•_nû
;

542  
	`√w_c⁄s_poöãr
(
ö°™˚
, "h˘l_ñem", 
	`¢d_h˘l_föd_ñem
(
h™dÀ
, &
id
));

543 
	}
}

545 
Æi•_obje˘
 * 
	$FA_h˘l_ñem_öfo
(
Æi•_ö°™˚
 * 
ö°™˚
, 
aˇŒ_èbÀ
 * 
ôem
, 
Æi•_obje˘
 * 
¨gs
)

547 
¢d_h˘l_ñem_t
 *
h™dÀ
;

548 
Æi•_obje˘
 * 
Àx¥
, * 
p1
, * 
p2
;

549 
¢d_˘l_ñem_öfo_t
 
öfo
 = {0};

550 
¢d_˘l_ñem_id_t
 
id
 = {0};

551 
¢d_˘l_ñem_ty≥_t
 
ty≥
;

552 
îr
;

554 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

555 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

556 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

557 
h™dÀ
 = (
¢d_h˘l_ñem_t
 *)
	`gë_±r
(
ö°™˚
, 
p1
, 
ôem
->
¥efix
);

558 i‡(
h™dÀ
 =
NULL
)

559  &
Æß_li•_nû
;

560 
îr
 = 
	`¢d_h˘l_ñem_öfo
(
h™dÀ
, &
öfo
);

561 
Àx¥
 = 
	`√w_Àx¥
(
ö°™˚
, 
îr
);

562 i‡(
îr
 < 0)

563  
Àx¥
;

564 
ty≥
 = 
	`¢d_˘l_ñem_öfo_gë_ty≥
(&
öfo
);

565 
p1
 = 
	`add_c⁄s
(
ö°™˚
, 
Àx¥
->
vÆue
.
c
.
cdr
, 0, "id", 
p2
 = 
	`√w_obje˘
(ö°™˚, 
ALISP_OBJ_CONS
));

566 
	`¢d_˘l_ñem_öfo_gë_id
(&
öfo
, &
id
);

567 i‡(
	`¸óã_˘l_ñem_id
(
ö°™˚
, &
id
, 
p2
Ë=
NULL
) {

568 
	`dñëe_åì
(
ö°™˚
, 
Àx¥
);

569  
NULL
;

571 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "ty≥", 
	`√w_°rög
(ö°™˚, 
	`¢d_˘l_ñem_ty≥_«me
(
ty≥
)));

572 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "ªadabÀ", 
	`√w_öãgî
(ö°™˚, 
	`¢d_˘l_ñem_öfo_is_ªadabÀ
(&
öfo
)));

573 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "wrôabÀ", 
	`√w_öãgî
(ö°™˚, 
	`¢d_˘l_ñem_öfo_is_wrôabÀ
(&
öfo
)));

574 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "vﬁ©ûe", 
	`√w_öãgî
(ö°™˚, 
	`¢d_˘l_ñem_öfo_is_vﬁ©ûe
(&
öfo
)));

575 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "öa˘ive", 
	`√w_öãgî
(ö°™˚, 
	`¢d_˘l_ñem_öfo_is_öa˘ive
(&
öfo
)));

576 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "locked", 
	`√w_öãgî
(ö°™˚, 
	`¢d_˘l_ñem_öfo_is_locked
(&
öfo
)));

577 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "isow√r", 
	`√w_öãgî
(ö°™˚, 
	`¢d_˘l_ñem_öfo_is_ow√r
(&
öfo
)));

578 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "ow√r", 
	`√w_öãgî
(ö°™˚, 
	`¢d_˘l_ñem_öfo_gë_ow√r
(&
öfo
)));

579 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "cou¡", 
	`√w_öãgî
(ö°™˚, 
	`¢d_˘l_ñem_öfo_gë_cou¡
(&
öfo
)));

580 
îr
 = 
	`INTERNAL
(
¢d_˘l_ñem_öfo_gë_dimísi⁄s
)(&
öfo
);

581 i‡(
îr
 > 0) {

582 
idx
;

583 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "dimísi⁄s", 
p2
 = 
	`√w_obje˘
(ö°™˚, 
ALISP_OBJ_CONS
));

584 
idx
 = 0; idx < 
îr
; idx++)

585 
p2
 = 
	`add_c⁄s2
(
ö°™˚
,Ö2, 
idx
 > 0, 
	`√w_öãgî
(ö°™˚, 
	`INTERNAL
(
¢d_˘l_ñem_öfo_gë_dimísi⁄
)(&
öfo
, idx)));

587 
ty≥
) {

588 
SND_CTL_ELEM_TYPE_ENUMERATED
: {

589 
ôems
, 
ôem
;

590 
ôems
 = 
	`¢d_˘l_ñem_öfo_gë_ôems
(&
öfo
);

591 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "ôems", 
p2
 = 
	`√w_obje˘
(ö°™˚, 
ALISP_OBJ_CONS
));

592 
ôem
 = 0; iãm < 
ôems
; item++) {

593 
	`¢d_˘l_ñem_öfo_£t_ôem
(&
öfo
, 
ôem
);

594 
îr
 = 
	`¢d_h˘l_ñem_öfo
(
h™dÀ
, &
öfo
);

595 i‡(
îr
 < 0) {

596 
p2
 = 
	`add_c⁄s2
(
ö°™˚
,Ö2, 
ôem
, &
Æß_li•_nû
);

598 
p2
 = 
	`add_c⁄s2
(
ö°™˚
,Ö2, 
ôem
, 
	`√w_°rög
(ö°™˚, 
	`¢d_˘l_ñem_öfo_gë_ôem_«me
(&
öfo
)));

603 
SND_CTL_ELEM_TYPE_INTEGER
:

604 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "mö", 
	`√w_öãgî
(ö°™˚, 
	`¢d_˘l_ñem_öfo_gë_mö
(&
öfo
)));

605 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "max", 
	`√w_öãgî
(ö°™˚, 
	`¢d_˘l_ñem_öfo_gë_max
(&
öfo
)));

606 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "°ï", 
	`√w_öãgî
(ö°™˚, 
	`¢d_˘l_ñem_öfo_gë_°ï
(&
öfo
)));

608 
SND_CTL_ELEM_TYPE_INTEGER64
:

609 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "mö64", 
	`√w_Êﬂt
(ö°™˚, 
	`¢d_˘l_ñem_öfo_gë_mö64
(&
öfo
)));

610 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "max64", 
	`√w_Êﬂt
(ö°™˚, 
	`¢d_˘l_ñem_öfo_gë_max64
(&
öfo
)));

611 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "°ï64", 
	`√w_Êﬂt
(ö°™˚, 
	`¢d_˘l_ñem_öfo_gë_°ï64
(&
öfo
)));

616 i‡(
p1
 =
NULL
) {

617 
	`dñëe_åì
(
ö°™˚
, 
Àx¥
);

618  
NULL
;

620  
Àx¥
;

621 
	}
}

623 
Æi•_obje˘
 * 
	$FA_h˘l_ñem_ªad
(
Æi•_ö°™˚
 * 
ö°™˚
, 
aˇŒ_èbÀ
 * 
ôem
, 
Æi•_obje˘
 * 
¨gs
)

625 
¢d_h˘l_ñem_t
 *
h™dÀ
;

626 
Æi•_obje˘
 * 
Àx¥
, * 
p1
 = 
NULL
, * 
obj
;

627 
¢d_˘l_ñem_öfo_t
 
öfo
 = {0};

628 
¢d_˘l_ñem_vÆue_t
 
vÆue
 = {0};

629 
¢d_˘l_ñem_ty≥_t
 
ty≥
;

630 
idx
, 
cou¡
;

631 
îr
;

633 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

634 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

635 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

636 
h™dÀ
 = (
¢d_h˘l_ñem_t
 *)
	`gë_±r
(
ö°™˚
, 
p1
, 
ôem
->
¥efix
);

637 i‡(
h™dÀ
 =
NULL
)

638  &
Æß_li•_nû
;

639 
îr
 = 
	`¢d_h˘l_ñem_öfo
(
h™dÀ
, &
öfo
);

640 i‡(
îr
 >= 0)

641 
îr
 = 
	`¢d_h˘l_ñem_ªad
(
h™dÀ
, &
vÆue
);

642 
Àx¥
 = 
	`√w_Àx¥
(
ö°™˚
, 
îr
);

643 i‡(
îr
 < 0)

644  
Àx¥
;

645 
ty≥
 = 
	`¢d_˘l_ñem_öfo_gë_ty≥
(&
öfo
);

646 
cou¡
 = 
	`¢d_˘l_ñem_öfo_gë_cou¡
(&
öfo
);

647 i‡(
ty≥
 =
SND_CTL_ELEM_TYPE_IEC958
) {

648 
cou¡
 = (
¢d_´s_õc958_t
);

649 
ty≥
 = 
SND_CTL_ELEM_TYPE_BYTES
;

651 
idx
 = 0; idx < 
cou¡
; idx++) {

652 
ty≥
) {

653 
SND_CTL_ELEM_TYPE_BOOLEAN
:

654 
obj
 = 
	`√w_öãgî
(
ö°™˚
, 
	`¢d_˘l_ñem_vÆue_gë_boﬁón
(&
vÆue
, 
idx
));

656 
SND_CTL_ELEM_TYPE_INTEGER
:

657 
obj
 = 
	`√w_öãgî
(
ö°™˚
, 
	`¢d_˘l_ñem_vÆue_gë_öãgî
(&
vÆue
, 
idx
));

659 
SND_CTL_ELEM_TYPE_INTEGER64
:

660 
obj
 = 
	`√w_öãgî
(
ö°™˚
, 
	`¢d_˘l_ñem_vÆue_gë_öãgî64
(&
vÆue
, 
idx
));

662 
SND_CTL_ELEM_TYPE_ENUMERATED
:

663 
obj
 = 
	`√w_öãgî
(
ö°™˚
, 
	`¢d_˘l_ñem_vÆue_gë_íumî©ed
(&
vÆue
, 
idx
));

665 
SND_CTL_ELEM_TYPE_BYTES
:

666 
obj
 = 
	`√w_öãgî
(
ö°™˚
, 
	`¢d_˘l_ñem_vÆue_gë_byã
(&
vÆue
, 
idx
));

669 
obj
 = 
NULL
;

672 i‡(
idx
 == 0) {

673 
p1
 = 
	`add_c⁄s2
(
ö°™˚
, 
Àx¥
->
vÆue
.
c
.
cdr
, 0, 
obj
);

675 
p1
 = 
	`add_c⁄s2
(
ö°™˚
,Ö1, 1, 
obj
);

678 i‡(
p1
 =
NULL
) {

679 
	`dñëe_åì
(
ö°™˚
, 
Àx¥
);

680  &
Æß_li•_nû
;

682  
Àx¥
;

683 
	}
}

685 
Æi•_obje˘
 * 
	$FA_h˘l_ñem_wrôe
(
Æi•_ö°™˚
 * 
ö°™˚
, 
aˇŒ_èbÀ
 * 
ôem
, 
Æi•_obje˘
 * 
¨gs
)

687 
¢d_h˘l_ñem_t
 *
h™dÀ
;

688 
Æi•_obje˘
 * 
p1
 = 
NULL
, * 
obj
;

689 
¢d_˘l_ñem_öfo_t
 
öfo
 = {0};

690 
¢d_˘l_ñem_vÆue_t
 
vÆue
 = {0};

691 
¢d_˘l_ñem_ty≥_t
 
ty≥
;

692 
idx
, 
cou¡
;

693 
îr
;

695 
p1
 = 
	`ˇr
(
	`cdr
(
¨gs
));

696 
obj
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

697 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
¨gs
)));

698 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
¨gs
));

699 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

700 
h™dÀ
 = (
¢d_h˘l_ñem_t
 *)
	`gë_±r
(
ö°™˚
, 
obj
, 
ôem
->
¥efix
);

701 i‡(
h™dÀ
 =
NULL
) {

702 
	`dñëe_åì
(
ö°™˚
, 
p1
);

703  &
Æß_li•_nû
;

705 
îr
 = 
	`¢d_h˘l_ñem_öfo
(
h™dÀ
, &
öfo
);

706 i‡(
îr
 < 0) {

707 
	`dñëe_åì
(
ö°™˚
, 
p1
);

708  
	`√w_öãgî
(
ö°™˚
, 
îr
);

710 
ty≥
 = 
	`¢d_˘l_ñem_öfo_gë_ty≥
(&
öfo
);

711 
cou¡
 = 
	`¢d_˘l_ñem_öfo_gë_cou¡
(&
öfo
);

712 i‡(
ty≥
 =
SND_CTL_ELEM_TYPE_IEC958
) {

713 
cou¡
 = (
¢d_´s_õc958_t
);

714 
ty≥
 = 
SND_CTL_ELEM_TYPE_BYTES
;

716 
idx
 = -1;

718 i‡(++
idx
 >
cou¡
) {

719 
	`dñëe_åì
(
ö°™˚
, 
p1
);

722 
obj
 = 
	`ˇr
(
p1
);

723 
ty≥
) {

724 
SND_CTL_ELEM_TYPE_BOOLEAN
:

725 
	`¢d_˘l_ñem_vÆue_£t_boﬁón
(&
vÆue
, 
idx
, 
	`gë_öãgî
(
obj
));

727 
SND_CTL_ELEM_TYPE_INTEGER
:

728 
	`¢d_˘l_ñem_vÆue_£t_öãgî
(&
vÆue
, 
idx
, 
	`gë_öãgî
(
obj
));

730 
SND_CTL_ELEM_TYPE_INTEGER64
:

731 
	`¢d_˘l_ñem_vÆue_£t_öãgî64
(&
vÆue
, 
idx
, 
	`gë_öãgî
(
obj
));

733 
SND_CTL_ELEM_TYPE_ENUMERATED
:

734 
	`¢d_˘l_ñem_vÆue_£t_íumî©ed
(&
vÆue
, 
idx
, 
	`gë_öãgî
(
obj
));

736 
SND_CTL_ELEM_TYPE_BYTES
:

737 
	`¢d_˘l_ñem_vÆue_£t_byã
(&
vÆue
, 
idx
, 
	`gë_öãgî
(
obj
));

742 
	`dñëe_åì
(
ö°™˚
, 
obj
);

743 
p1
 = 
	`cdr
(
obj
 =Ö1);

744 
	`dñëe_obje˘
(
ö°™˚
, 
obj
);

745 } 
p1
 !&
Æß_li•_nû
);

746 
îr
 = 
	`¢d_h˘l_ñem_wrôe
(
h™dÀ
, &
vÆue
);

747  
	`√w_öãgî
(
ö°™˚
, 
îr
);

748 
	}
}

750 
Æi•_obje˘
 * 
	$FA_pcm_öfo
(
Æi•_ö°™˚
 * 
ö°™˚
, 
aˇŒ_èbÀ
 * 
ôem
, 
Æi•_obje˘
 * 
¨gs
)

752 
¢d_pcm_t
 *
h™dÀ
;

753 
Æi•_obje˘
 * 
Àx¥
, * 
p1
;

754 
¢d_pcm_öfo_t
 
öfo
 = {0};

755 
îr
;

757 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

758 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

759 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

760 
h™dÀ
 = (
¢d_pcm_t
 *)
	`gë_±r
(
ö°™˚
, 
p1
, 
ôem
->
¥efix
);

761 i‡(
h™dÀ
 =
NULL
)

762  &
Æß_li•_nû
;

763 
îr
 = 
	`¢d_pcm_öfo
(
h™dÀ
, &
öfo
);

764 
Àx¥
 = 
	`√w_Àx¥
(
ö°™˚
, 
îr
);

765 i‡(
îr
 < 0)

766  
Àx¥
;

767 
p1
 = 
	`add_c⁄s
(
ö°™˚
, 
Àx¥
->
vÆue
.
c
.
cdr
, 0, "ˇrd", 
	`√w_öãgî
(ö°™˚, 
	`¢d_pcm_öfo_gë_ˇrd
(&
öfo
)));

768 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "devi˚", 
	`√w_öãgî
(ö°™˚, 
	`¢d_pcm_öfo_gë_devi˚
(&
öfo
)));

769 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "subdevi˚", 
	`√w_öãgî
(ö°™˚, 
	`¢d_pcm_öfo_gë_subdevi˚
(&
öfo
)));

770 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "id", 
	`√w_°rög
(ö°™˚, 
	`¢d_pcm_öfo_gë_id
(&
öfo
)));

771 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "«me", 
	`√w_°rög
(ö°™˚, 
	`¢d_pcm_öfo_gë_«me
(&
öfo
)));

772 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "subdevi˚_«me", 
	`√w_°rög
(ö°™˚, 
	`¢d_pcm_öfo_gë_subdevi˚_«me
(&
öfo
)));

773 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "˛ass", 
	`√w_öãgî
(ö°™˚, 
	`¢d_pcm_öfo_gë_˛ass
(&
öfo
)));

774 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "sub˛ass", 
	`√w_öãgî
(ö°™˚, 
	`¢d_pcm_öfo_gë_sub˛ass
(&
öfo
)));

775 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "subdevi˚s_cou¡", 
	`√w_öãgî
(ö°™˚, 
	`¢d_pcm_öfo_gë_subdevi˚s_cou¡
(&
öfo
)));

776 
p1
 = 
	`add_c⁄s
(
ö°™˚
,Ö1, 1, "subdevi˚s_avaû", 
	`√w_öãgî
(ö°™˚, 
	`¢d_pcm_öfo_gë_subdevi˚s_avaû
(&
öfo
)));

778  
Àx¥
;

779 
	}
}

785 c⁄° 
aˇŒ_èbÀ
 
	gaˇŒ_èbÀ
[] = {

786 { "ˇrd_gë_ödex", &
FA_öt_°r
, (*)
¢d_ˇrd_gë_ödex
, 
NULL
 },

787 { "ˇrd_gë_l⁄g«me", &
FA_öt_öt_°Ω
, (*)
¢d_ˇrd_gë_l⁄g«me
, 
NULL
 },

788 { "ˇrd_gë_«me", &
FA_öt_öt_°Ω
, (*)
¢d_ˇrd_gë_«me
, 
NULL
 },

789 { "ˇrd_√xt", &
FA_öt_öç
, (*)&
¢d_ˇrd_√xt
, 
NULL
 },

790 { "˘l_ˇrd_öfo", &
FA_ˇrd_öfo
, 
NULL
, "ctl" },

791 { "˘l_˛o£", &
FA_öt_p
, (*)&
¢d_˘l_˛o£
, "ctl" },

792 { "˘l_›í", &
FA_öt_µ_°Ω_öt
, (*)&
¢d_˘l_›í
, "ctl" },

793 { "h˘l_˛o£", &
FA_öt_p
, (*)&
¢d_h˘l_˛o£
, "hctl" },

794 { "h˘l_˘l", &
FA_p_p
, (*)&
¢d_h˘l_˘l
, "hctl" },

795 { "h˘l_ñem_öfo", &
FA_h˘l_ñem_öfo
, (*)&
¢d_h˘l_ñem_öfo
, "hctl_elem" },

796 { "h˘l_ñem_√xt", &
FA_p_p
, (*)&
¢d_h˘l_ñem_√xt
, "hctl_elem" },

797 { "h˘l_ñem_¥ev", &
FA_p_p
, (*)&
¢d_h˘l_ñem_¥ev
, "hctl_elem" },

798 { "h˘l_ñem_ªad", &
FA_h˘l_ñem_ªad
, (*)&
¢d_h˘l_ñem_ªad
, "hctl_elem" },

799 { "h˘l_ñem_wrôe", &
FA_h˘l_ñem_wrôe
, (*)&
¢d_h˘l_ñem_wrôe
, "hctl_elem" },

800 { "h˘l_föd_ñem", &
FA_h˘l_föd_ñem
, (*)&
¢d_h˘l_föd_ñem
, "hctl" },

801 { "h˘l_fú°_ñem", &
FA_p_p
, (*)&
¢d_h˘l_fú°_ñem
, "hctl" },

802 { "h˘l_‰ì", &
FA_öt_p
, (*)&
¢d_h˘l_‰ì
, "hctl" },

803 { "h˘l_œ°_ñem", &
FA_p_p
, (*)&
¢d_h˘l_œ°_ñem
, "hctl" },

804 { "h˘l_lﬂd", &
FA_öt_p
, (*)&
¢d_h˘l_lﬂd
, "hctl" },

805 { "h˘l_›í", &
FA_öt_µ_°Ω_öt
, (*)&
¢d_h˘l_›í
, "hctl" },

806 { "h˘l_›í_˘l", &
FA_öt_µ_p
, (*)&
¢d_h˘l_›í_˘l
, "hctl" },

807 { "pcm_öfo", &
FA_pcm_öfo
, 
NULL
, "pcm" },

808 { "pcm_«me", &
FA_°r_p
, (*)&
¢d_pcm_«me
, "pcm" },

811 
	$aˇŒ_com∑r
(c⁄° *
p1
, c⁄° *
p2
)

813  
	`°rcmp
(((
aˇŒ_èbÀ
 *)
p1
)->
«me
,

814 ((
aˇŒ_èbÀ
 *)
p2
)->
«me
);

815 
	}
}

817 
Æi•_obje˘
 * 
	$F_aˇŒ
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

819 
Æi•_obje˘
 * 
p1
, *
p2
;

820 
aˇŒ_èbÀ
 
key
, *
ôem
;

822 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

823 
p2
 = 
	`cdr
(
¨gs
);

824 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

825 i‡(!
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_IDENTIFIER
) &&

826 !
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_STRING
)) {

827 
	`dñëe_åì
(
ö°™˚
, 
p2
);

828  &
Æß_li•_nû
;

830 
key
.
«me
 = 
p1
->
vÆue
.
s
;

831 i‡((
ôem
 = 
	`b£¨ch
(&
key
, 
aˇŒ_èbÀ
,

832  
aˇŒ_èbÀ
 / ácall_table[0],

833  
aˇŒ_èbÀ
[0], 
aˇŒ_com∑r
)Ë!
NULL
) {

834 
	`dñëe_åì
(
ö°™˚
, 
p1
);

835  
ôem
->
	`func
(
ö°™˚
, iãm, 
p2
);

837 
	`dñëe_åì
(
ö°™˚
, 
p1
);

838 
	`dñëe_åì
(
ö°™˚
, 
p2
);

839 
	`li•_w¨n
(
ö°™˚
, "aˇŒ fun˘i⁄ %s' i†undeföed", 
p1
->
vÆue
.
s
);

840  &
Æß_li•_nû
;

841 
	}
}

843 
Æi•_obje˘
 * 
	$F_ah™dÀ
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

845 
Æi•_obje˘
 *
p1
;

847 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

848 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

849 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

850 
¨gs
 = 
	`ˇr
(
	`cdr
(
p1
));

851 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(cdr(
p1
)));

852 
	`dñëe_obje˘
(
ö°™˚
, 
	`cdr
(
p1
));

853 
	`dñëe_åì
(
ö°™˚
, 
	`ˇr
(
p1
));

854 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

855  
¨gs
;

856 
	}
}

858 
Æi•_obje˘
 * 
	$F_´º‹
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

860 
Æi•_obje˘
 *
p1
;

862 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
¨gs
));

863 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
¨gs
));

864 
	`dñëe_obje˘
(
ö°™˚
, 
¨gs
);

865 
¨gs
 = 
	`ˇr
(
p1
);

866 i‡(
¨gs
 =&
Æß_li•_nû
) {

867 
	`dñëe_åì
(
ö°™˚
, 
p1
);

868  
	`√w_öãgî
(
ö°™˚
, 
SND_ERROR_ALISP_NIL
);

870 
	`dñëe_åì
(
ö°™˚
, 
	`cdr
(
p1
));

871 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

873  
¨gs
;

874 
	}
}

876 
	$comm⁄_îr‹
(
¢d_ouçut_t
 **
rout
, 
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

878 
Æi•_obje˘
 * 
p
 = 
¨gs
, * 
p1
;

879 
¢d_ouçut_t
 *
out
;

880 
îr
;

882 
îr
 = 
	`¢d_ouçut_buf„r_›í
(&
out
);

883 i‡(
îr
 < 0) {

884 
	`dñëe_åì
(
ö°™˚
, 
¨gs
);

885  
îr
;

889 
p1
 = 
	`evÆ
(
ö°™˚
, 
	`ˇr
(
p
));

890 i‡(
	`Æi•_com∑ª_ty≥
(
p1
, 
ALISP_OBJ_STRING
))

891 
	`¢d_ouçut_¥ötf
(
out
, "%s", 
p1
->
vÆue
.
s
);

893 
	`¥öc_obje˘
(
out
, 
p1
);

894 
	`dñëe_åì
(
ö°™˚
, 
p1
);

895 
p
 = 
	`cdr
(
p1
 =Ö);

896 
	`dñëe_obje˘
(
ö°™˚
, 
p1
);

897 } 
p
 !&
Æß_li•_nû
);

899 *
rout
 = 
out
;

901 
	}
}

903 
Æi•_obje˘
 * 
	$F_¢dîr
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

905 
¢d_ouçut_t
 *
out
;

906 *
°r
;

908 i‡(
	`comm⁄_îr‹
(&
out
, 
ö°™˚
, 
¨gs
) < 0)

909  &
Æß_li•_nû
;

910 
	`¢d_ouçut_buf„r_°rög
(
out
, &
°r
);

911 
	`SNDERR
(
°r
);

912 
	`¢d_ouçut_˛o£
(
out
);

913  &
Æß_li•_t
;

914 
	}
}

916 
Æi•_obje˘
 * 
	$F_sy£º
(
Æi•_ö°™˚
 *
ö°™˚
, 
Æi•_obje˘
 * 
¨gs
)

918 
¢d_ouçut_t
 *
out
;

919 *
°r
;

921 i‡(
	`comm⁄_îr‹
(&
out
, 
ö°™˚
, 
¨gs
) < 0)

922  &
Æß_li•_nû
;

923 
	`¢d_ouçut_buf„r_°rög
(
out
, &
°r
);

924 
	`SYSERR
(
°r
);

925 
	`¢d_ouçut_˛o£
(
out
);

926  &
Æß_li•_t
;

927 
	}
}

929 c⁄° 
öåösic
 
	g¢d_öåösics
[] = {

930 { "AˇŒ", 
F_aˇŒ
 },

931 { "Aîr‹", 
F_´º‹
 },

932 { "Ah™dÀ", 
F_ah™dÀ
 },

933 { "Aªsu…", 
F_ah™dÀ
 },

934 { "A¢dîr", 
F_¢dîr
 },

935 { "Asy£º", 
F_sy£º
 }

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/async.c

27 
	~"pcm/pcm_loˇl.h
"

28 
	~"c⁄åﬁ/c⁄åﬁ_loˇl.h
"

29 
	~<sig«l.h
>

31 
siga˘i⁄
 
	g¥evious_a˘i⁄
;

32 #i‚de‡
DOC_HIDDEN


33 
	#MAX_SIG_FUNCTION_CODE
 10

	)

36 #ifde‡
SND_ASYNC_RT_SIGNAL


38 
	g¢d_async_signo
;

40 
	$¢d_async_öô
(Ë
	`__©åibuã__
 ((
c⁄°ru˘‹
));

42 
	$¢d_async_öô
()

44 
¢d_async_signo
 = 
	`__libc_Æloˇã_πsig
(0);

45 i‡(
¢d_async_signo
 < 0) {

46 
	`SNDERR
("UnableÅo findá RT signalÅo use for snd_async");

47 
	`exô
(1);

49 
	}
}

52 c⁄° 
	g¢d_async_signo
 = 
SIGIO
;

55 
LIST_HEAD
(
¢d_async_h™dÀrs
);

57 
	$¢d_async_h™dÀr
(
signo
 
ATTRIBUTE_UNUSED
, 
sigöfo_t
 *
sigöfo
, *
c⁄ãxt
 ATTRIBUTE_UNUSED)

59 #i‡
	`deföed
(
__Døg⁄Fly__
Ë|| deföed(
__FªeBSD__
Ë|| deföed(
__O≥nBSD__
)

61 
li°_hód
 *
i
;

62 
	`li°_f‹_óch
(
i
, &
¢d_async_h™dÀrs
) {

63 
¢d_async_h™dÀr_t
 *
h
 = 
	`li°_íåy
(
i
, snd_async_h™dÀr_t, 
gli°
);

64 i‡(
h
->
ˇŒback
)

65 
h
->
	`ˇŒback
(h);

68 
fd
;

69 
li°_hód
 *
i
;

71 i‡(
signo
 =
SIGIO


72 && ()(
¥evious_a˘i⁄
.
ß_siga˘i⁄
Ë> 
MAX_SIG_FUNCTION_CODE
)

73 
¥evious_a˘i⁄
.
	`ß_siga˘i⁄
(
signo
, 
sigöfo
, 
c⁄ãxt
);

74 
fd
 = 
sigöfo
->
si_fd
;

75 
	`li°_f‹_óch
(
i
, &
¢d_async_h™dÀrs
) {

76 
¢d_async_h™dÀr_t
 *
h
 = 
	`li°_íåy
(
i
, snd_async_h™dÀr_t, 
gli°
);

77 i‡(
h
->
fd
 =fd && h->
ˇŒback
)

78 
h
->
	`ˇŒback
(h);

81 
	}
}

112 
	$¢d_async_add_h™dÀr
(
¢d_async_h™dÀr_t
 **
h™dÀr
, 
fd
,

113 
¢d_async_ˇŒback_t
 
ˇŒback
, *
¥iv©e_d©a
)

115 
¢d_async_h™dÀr_t
 *
h
;

116 
was_em±y
;

117 
	`as£π
(
h™dÀr
);

118 
h
 = 
	`mÆloc
((*h));

119 i‡(!
h
)

120  -
ENOMEM
;

121 
h
->
fd
 = fd;

122 
h
->
ˇŒback
 = callback;

123 
h
->
¥iv©e_d©a
 =Örivate_data;

124 
was_em±y
 = 
	`li°_em±y
(&
¢d_async_h™dÀrs
);

125 
	`li°_add_èû
(&
h
->
gli°
, &
¢d_async_h™dÀrs
);

126 
	`INIT_LIST_HEAD
(&
h
->
hli°
);

127 *
h™dÀr
 = 
h
;

128 i‡(
was_em±y
) {

129 
îr
;

130 
siga˘i⁄
 
a˘
;

131 
	`mem£t
(&
a˘
, 0, (act));

132 
a˘
.
ß_Êags
 = 
SA_RESTART
 | 
SA_SIGINFO
;

133 
a˘
.
ß_siga˘i⁄
 = 
¢d_async_h™dÀr
;

134 
	`sigem±y£t
(&
a˘
.
ß_mask
);

135 
	`as£π
(!
¥evious_a˘i⁄
.
ß_siga˘i⁄
);

136 
îr
 = 
	`siga˘i⁄
(
¢d_async_signo
, &
a˘
, &
¥evious_a˘i⁄
);

137 i‡(
îr
 < 0) {

138 
	`SYSERR
("sigaction");

139  -
î∫o
;

143 
	}
}

150 
	$¢d_async_dñ_h™dÀr
(
¢d_async_h™dÀr_t
 *
h™dÀr
)

152 
îr
 = 0;

153 
was_em±y
 = 
	`li°_em±y
(&
¢d_async_h™dÀrs
);

154 
	`as£π
(
h™dÀr
);

155 
	`li°_dñ
(&
h™dÀr
->
gli°
);

156 i‡(!
was_em±y


157 && 
	`li°_em±y
(&
¢d_async_h™dÀrs
)) {

158 
îr
 = 
	`siga˘i⁄
(
¢d_async_signo
, &
¥evious_a˘i⁄
, 
NULL
);

159 i‡(
îr
 < 0) {

160 
	`SYSERR
("sigaction");

161  -
î∫o
;

163 
	`mem£t
(&
¥evious_a˘i⁄
, 0, (previous_action));

165 i‡(
h™dÀr
->
ty≥
 =
SND_ASYNC_HANDLER_GENERIC
)

166 
_íd
;

167 i‡(!
	`li°_em±y
(&
h™dÀr
->
hli°
))

168 
	`li°_dñ
(&
h™dÀr
->
hli°
);

169 i‡(!
	`li°_em±y
(&
h™dÀr
->
hli°
))

170 
_íd
;

171 
h™dÀr
->
ty≥
) {

172 #ifde‡
BUILD_PCM


173 
SND_ASYNC_HANDLER_PCM
:

174 
îr
 = 
	`¢d_pcm_async
(
h™dÀr
->
u
.
pcm
, -1, 1);

177 
SND_ASYNC_HANDLER_CTL
:

178 
îr
 = 
	`¢d_˘l_async
(
h™dÀr
->
u
.
˘l
, -1, 1);

181 
	`as£π
(0);

183 
_íd
:

184 
	`‰ì
(
h™dÀr
);

185  
îr
;

186 
	}
}

197 
	$¢d_async_h™dÀr_gë_signo
(
¢d_async_h™dÀr_t
 *
h™dÀr
)

199 
	`as£π
(
h™dÀr
);

200  
¢d_async_signo
;

201 
	}
}

208 
	$¢d_async_h™dÀr_gë_fd
(
¢d_async_h™dÀr_t
 *
h™dÀr
)

210 
	`as£π
(
h™dÀr
);

211  
h™dÀr
->
fd
;

212 
	}
}

219 *
	$¢d_async_h™dÀr_gë_ˇŒback_¥iv©e
(
¢d_async_h™dÀr_t
 *
h™dÀr
)

221 
	`as£π
(
h™dÀr
);

222  
h™dÀr
->
¥iv©e_d©a
;

223 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/conf.c

427 
	~"loˇl.h
"

428 
	~<°d¨g.h
>

429 
	~<°dboﬁ.h
>

430 
	~<limôs.h
>

431 
	~<sys/°©.h
>

432 
	~<dúít.h
>

433 
	~<loˇÀ.h
>

434 #ifde‡
HAVE_LIBPTHREAD


435 
	~<±hªad.h
>

438 #i‚de‡
DOC_HIDDEN


440 #ifde‡
HAVE_LIBPTHREAD


441 
±hªad_muãx_t
 
	g¢d_c⁄fig_upd©e_muãx
;

442 
±hªad_⁄˚_t
 
	g¢d_c⁄fig_upd©e_muãx_⁄˚
 = 
PTHREAD_ONCE_INIT
;

445 
	s_¢d_c⁄fig
 {

446 *
	mid
;

447 
¢d_c⁄fig_ty≥_t
 
	mty≥
;

448 
	mªfcou¡
;

450 
	möãgî
;

451 
	möãgî64
;

452 *
	m°rög
;

453 
	mªÆ
;

454 c⁄° *
	m±r
;

456 
li°_hód
 
	mfõlds
;

457 
boﬁ
 
	mjoö
;

458 } 
	mcompound
;

459 } 
	mu
;

460 
li°_hód
 
	mli°
;

461 
¢d_c⁄fig_t
 *
	m∑ª¡
;

462 
	mh›
;

465 
	sfûedesc
 {

466 *
	m«me
;

467 
¢d_öput_t
 *
	mö
;

468 
	mlöe
, 
	mcﬁumn
;

469 
fûedesc
 *
	m√xt
;

475 
li°_hód
 
	mö˛ude_∑ths
;

479 
	sö˛ude_∑th
 {

480 *
	mdú
;

481 
li°_hód
 
	mli°
;

484 
	#LOCAL_ERROR
 (-0x68000000)

	)

486 
	#LOCAL_UNTERMINATED_STRING
 (
LOCAL_ERROR
 - 0)

	)

487 
	#LOCAL_UNTERMINATED_QUOTE
 (
LOCAL_ERROR
 - 1)

	)

488 
	#LOCAL_UNEXPECTED_CHAR
 (
LOCAL_ERROR
 - 2)

	)

489 
	#LOCAL_UNEXPECTED_EOF
 (
LOCAL_ERROR
 - 3)

	)

492 
fûedesc
 *
	mcuºít
;

493 
	mungë
;

494 
	mch
;

495 } 
	töput_t
;

497 #ifde‡
HAVE_LIBPTHREAD


499 
	$¢d_c⁄fig_öô_muãx
()

501 
±hªad_muãx©å_t
 
©å
;

503 
	`±hªad_muãx©å_öô
(&
©å
);

504 #ifde‡
HAVE_PTHREAD_MUTEX_RECURSIVE


505 
	`±hªad_muãx©å_£ây≥
(&
©å
, 
PTHREAD_MUTEX_RECURSIVE
);

507 
	`±hªad_muãx_öô
(&
¢d_c⁄fig_upd©e_muãx
, &
©å
);

508 
	`±hªad_muãx©å_de°roy
(&
©å
);

509 
	}
}

511 
ölöe
 
	$¢d_c⁄fig_lock
()

513 
	`±hªad_⁄˚
(&
¢d_c⁄fig_upd©e_muãx_⁄˚
, 
¢d_c⁄fig_öô_muãx
);

514 
	`±hªad_muãx_lock
(&
¢d_c⁄fig_upd©e_muãx
);

515 
	}
}

517 
ölöe
 
	$¢d_c⁄fig_u∆ock
()

519 
	`±hªad_muãx_u∆ock
(&
¢d_c⁄fig_upd©e_muãx
);

520 
	}
}

524 
ölöe
 
	$¢d_c⁄fig_lock
(Ë{ 
	}
}

525 
ölöe
 
	$¢d_c⁄fig_u∆ock
(Ë{ 
	}
}

539 
	$add_ö˛ude_∑th
(
fûedesc
 *
fd
, c⁄° *
dú
)

541 
ö˛ude_∑th
 *
∑th
;

542 
fûedesc
 *
fd1
;

543 
li°_hód
 *
pos
;

546 
fd1
 = 
fd
; fd1; fd1 = fd1->
√xt
) {

547 
	`li°_f‹_óch
(
pos
, &
fd1
->
ö˛ude_∑ths
) {

548 
∑th
 = 
	`li°_íåy
(
pos
, 
ö˛ude_∑th
, 
li°
);

549 i‡(
	`°rcmp
(
∑th
->
dú
, dir) == 0)

554 
∑th
 = 
	`ˇŒoc
(1, (*path));

555 i‡(!
∑th
)

556  -
ENOMEM
;

558 
∑th
->
dú
 = 
	`°rdup
(dir);

559 i‡(
∑th
->
dú
 =
NULL
) {

560 
	`‰ì
(
∑th
);

561  -
ENOMEM
;

564 
	`li°_add_èû
(&
∑th
->
li°
, &
fd
->
ö˛ude_∑ths
);

566 
	}
}

572 
	$‰ì_ö˛ude_∑ths
(
fûedesc
 *
fd
)

574 
li°_hód
 *
pos
, *
≈os
, *
ba£
;

575 
ö˛ude_∑th
 *
∑th
;

577 
ba£
 = &
fd
->
ö˛ude_∑ths
;

578 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, 
ba£
) {

579 
∑th
 = 
	`li°_íåy
(
pos
, 
ö˛ude_∑th
, 
li°
);

580 
	`li°_dñ
(&
∑th
->
li°
);

581 i‡(
∑th
->
dú
)

582 
	`‰ì
(
∑th
->
dú
);

583 
	`‰ì
(
∑th
);

585 
	}
}

598 c⁄° *
	$¢d_c⁄fig_t›dú
()

600 *
t›dú
;

602 i‡(!
t›dú
) {

603 
t›dú
 = 
	`gëív
("ALSA_CONFIG_DIR");

604 i‡(!
t›dú
 || *t›dú !'/' || 
	`°æí
—›dúË>
PATH_MAX
)

605 
t›dú
 = 
ALSA_CONFIG_DIR
;

607  
t›dú
;

608 
	}
}

610 #i‚de‡
DOC_HIDDEN


612 *
	$_¢d_c⁄fig_∑th
(c⁄° *
«me
)

614 c⁄° *
roŸ
 = 
	`¢d_c⁄fig_t›dú
();

615 *
∑th
 = 
	`mÆloc
(
	`°æí
(
roŸ
Ë+ såÀn(
«me
) + 2);

616 i‡(!
∑th
)

617  
NULL
;

618 
	`•rötf
(
∑th
, "%s/%s", 
roŸ
, 
«me
);

619  
∑th
;

620 
	}
}

638 
	$öput_°dio_›í
(
¢d_öput_t
 **
öpuç
, c⁄° *
fûe
,

639 
fûedesc
 *
cuºít
)

641 
li°_hód
 *
pos
;

642 
ö˛ude_∑th
 *
∑th
;

643 
fuŒ_∑th
[
PATH_MAX
];

644 
îr
;

646 i‡(
fûe
[0] == '/')

647  
	`¢d_öput_°dio_›í
(
öpuç
, 
fûe
, "r");

652 
îr
 = -
ENOENT
;

653 
cuºít
) {

654 
	`li°_f‹_óch
(
pos
, &
cuºít
->
ö˛ude_∑ths
) {

655 
∑th
 = 
	`li°_íåy
(
pos
, 
ö˛ude_∑th
, 
li°
);

656 i‡(!
∑th
->
dú
)

659 
	`¢¥ötf
(
fuŒ_∑th
, 
PATH_MAX
, "%s/%s", 
∑th
->
dú
, 
fûe
);

660 
îr
 = 
	`¢d_öput_°dio_›í
(
öpuç
, 
fuŒ_∑th
, "r");

661 i‡(
îr
 == 0)

664 
cuºít
 = cuºít->
√xt
;

667  
îr
;

668 
	}
}

670 
	$_¢d_ß„_°πﬁl_ba£
(c⁄° *
°r
, *
vÆ
, 
ba£
)

672 *
íd
;

673 
v
;

674 i‡(!*
°r
)

675  -
EINVAL
;

676 
î∫o
 = 0;

677 
v
 = 
	`°πﬁl
(
°r
, &
íd
, 
ba£
);

678 i‡(
î∫o
)

679  -
î∫o
;

680 i‡(*
íd
)

681  -
EINVAL
;

682 *
vÆ
 = 
v
;

684 
	}
}

686 
	$_¢d_ß„_°πﬁ_ba£
(c⁄° *
°r
, *
vÆ
, 
ba£
)

688 *
íd
;

689 
v
;

690 i‡(!*
°r
)

691  -
EINVAL
;

692 
î∫o
 = 0;

693 
v
 = 
	`°πﬁ
(
°r
, &
íd
, 
ba£
);

694 i‡(
î∫o
)

695  -
î∫o
;

696 i‡(*
íd
)

697  -
EINVAL
;

698 *
vÆ
 = 
v
;

700 
	}
}

702 
	$_¢d_ß„_°πod
(c⁄° *
°r
, *
vÆ
)

704 *
íd
;

705 
v
;

706 #ifde‡
HAVE_USELOCALE


707 
loˇÀ_t
 
ßved_loˇÀ
, 
c_loˇÀ
;

709 *
ßved_loˇÀ
;

710 
loc°r
[64];

712 
îr
;

714 i‡(!*
°r
)

715  -
EINVAL
;

716 #ifde‡
HAVE_USELOCALE


717 
c_loˇÀ
 = 
	`√wloˇÀ
(
LC_NUMERIC_MASK
, "C", 0);

718 
ßved_loˇÀ
 = 
	`u£loˇÀ
(
c_loˇÀ
);

720 
ßved_loˇÀ
 = 
	`£éoˇÀ
(
LC_NUMERIC
, 
NULL
);

721 i‡(
ßved_loˇÀ
) {

722 
	`¢¥ötf
(
loc°r
, ÷oc°r), "%s", 
ßved_loˇÀ
);

723 
	`£éoˇÀ
(
LC_NUMERIC
, "C");

726 
î∫o
 = 0;

727 
v
 = 
	`°πod
(
°r
, &
íd
);

728 
îr
 = -
î∫o
;

729 #ifde‡
HAVE_USELOCALE


730 i‡(
c_loˇÀ
 !(
loˇÀ_t
)0) {

731 
	`u£loˇÀ
(
ßved_loˇÀ
);

732 
	`‰ìloˇÀ
(
c_loˇÀ
);

735 i‡(
ßved_loˇÀ
)

736 
	`£éoˇÀ
(
LC_NUMERIC
, 
loc°r
);

738 i‡(
îr
)

739  
îr
;

740 i‡(*
íd
)

741  -
EINVAL
;

742 *
vÆ
 = 
v
;

744 
	}
}

746 
	$gë_ch¨
(
öput_t
 *
öput
)

748 
c
;

749 
fûedesc
 *
fd
;

750 i‡(
öput
->
ungë
) {

751 
öput
->
ungë
 = 0;

752  
öput
->
ch
;

754 
agaö
:

755 
fd
 = 
öput
->
cuºít
;

756 
c
 = 
	`¢d_öput_gëc
(
fd
->
ö
);

757 
c
) {

759 
fd
->
cﬁumn
 = 0;

760 
fd
->
löe
++;

763 
fd
->
cﬁumn
 += 8 - fd->column % 8;

765 
EOF
:

766 i‡(
fd
->
√xt
) {

767 
	`¢d_öput_˛o£
(
fd
->
ö
);

768 
	`‰ì
(
fd
->
«me
);

769 
öput
->
cuºít
 = 
fd
->
√xt
;

770 
	`‰ì
(
fd
);

771 
agaö
;

773  
LOCAL_UNEXPECTED_EOF
;

775 
fd
->
cﬁumn
++;

778  ()
c
;

779 
	}
}

781 
	$ungë_ch¨
(
c
, 
öput_t
 *
öput
)

783 
	`as£π
(!
öput
->
ungë
);

784 
öput
->
ch
 = 
c
;

785 
öput
->
ungë
 = 1;

786 
	}
}

788 
gë_dñim°rög
(**
°rög
, 
dñim
, 
öput_t
 *
öput
);

790 
	$gë_ch¨_skù_commíts
(
öput_t
 *
öput
)

792 
c
;

794 
c
 = 
	`gë_ch¨
(
öput
);

795 i‡(
c
 == '<') {

796 *
°r
;

797 
¢d_öput_t
 *
ö
;

798 
fûedesc
 *
fd
;

799 
DIR
 *
dúp
;

800 
îr
 = 
	`gë_dñim°rög
(&
°r
, '>', 
öput
);

801 i‡(
îr
 < 0)

802  
îr
;

804 i‡(!
	`°∫cmp
(
°r
, "searchdir:", 10)) {

806 *
tmp
 = 
	`_¢d_c⁄fig_∑th
(
°r
 + 10);

807 
	`‰ì
(
°r
);

808 i‡(
tmp
 =
NULL
)

809  -
ENOMEM
;

810 
°r
 = 
tmp
;

812 
dúp
 = 
	`›ídú
(
°r
);

813 i‡(!
dúp
) {

814 
	`SNDERR
("InvÆid sórch dú %s", 
°r
);

815 
	`‰ì
(
°r
);

816  -
EINVAL
;

818 
	`˛o£dú
(
dúp
);

820 
îr
 = 
	`add_ö˛ude_∑th
(
öput
->
cuºít
, 
°r
);

821 i‡(
îr
 < 0) {

822 
	`SNDERR
("C™nŸádd sórch dú %s", 
°r
);

823 
	`‰ì
(
°r
);

824  
îr
;

826 
	`‰ì
(
°r
);

830 i‡(!
	`°∫cmp
(
°r
, "confdir:", 8)) {

832 *
tmp
 = 
	`_¢d_c⁄fig_∑th
(
°r
 + 8);

833 
	`‰ì
(
°r
);

834 i‡(
tmp
 =
NULL
)

835  -
ENOMEM
;

836 
°r
 = 
tmp
;

837 
îr
 = 
	`¢d_öput_°dio_›í
(&
ö
, 
°r
, "r");

839 
îr
 = 
	`öput_°dio_›í
(&
ö
, 
°r
, 
öput
->
cuºít
);

842 i‡(
îr
 < 0) {

843 
	`SNDERR
("C™nŸác˚s†fûê%s", 
°r
);

844 
	`‰ì
(
°r
);

845  
îr
;

847 
fd
 = 
	`mÆloc
((*fd));

848 i‡(!
fd
) {

849 
	`‰ì
(
°r
);

850  -
ENOMEM
;

852 
fd
->
«me
 = 
°r
;

853 
fd
->
ö
 = in;

854 
fd
->
√xt
 = 
öput
->
cuºít
;

855 
fd
->
löe
 = 1;

856 
fd
->
cﬁumn
 = 0;

857 
	`INIT_LIST_HEAD
(&
fd
->
ö˛ude_∑ths
);

858 
öput
->
cuºít
 = 
fd
;

861 i‡(
c
 != '#')

864 
c
 = 
	`gë_ch¨
(
öput
);

865 i‡(
c
 < 0)

866  
c
;

867 i‡(
c
 == '\n')

872  
c
;

873 
	}
}

876 
	$gë_n⁄whôe
(
öput_t
 *
öput
)

878 
c
;

880 
c
 = 
	`gë_ch¨_skù_commíts
(
öput
);

881 
c
) {

889  
c
;

892 
	}
}

894 
ölöe
 
	$gë_hexach¨
(
öput_t
 *
öput
)

896 
c
, 
num
 = 0;

898 
c
 = 
	`gë_ch¨
(
öput
);

899 i‡(
c
 >'0' && c <'9'Ë
num
 |= (c - '0') << 4;

900 i‡(
c
 >'a' && c <'f'Ë
num
 |= (c - 'a') << 4;

901 i‡(
c
 >'A' && c <'F'Ë
num
 |= (c - 'A') << 4;

902 
c
 = 
	`gë_ch¨
(
öput
);

903 i‡(
c
 >'0' && c <'9'Ë
num
 |= (c - '0') << 0;

904 i‡(
c
 >'a' && c <'f'Ë
num
 |= (c - 'a') << 0;

905 i‡(
c
 >'A' && c <'F'Ë
num
 |= (c - 'A') << 0;

906  
num
;

907 
	}
}

909 
	$gë_quŸedch¨
(
öput_t
 *
öput
)

911 
c
;

912 
c
 = 
	`gë_ch¨
(
öput
);

913 
c
) {

927  
	`gë_hexach¨
(
öput
);

931 
num
 = 
c
 - '0';

932 
i
 = 1;

934 
c
 = 
	`gë_ch¨
(
öput
);

935 i‡(
c
 < '0' || c > '7') {

936 
	`ungë_ch¨
(
c
, 
öput
);

939 
num
 =Çum * 8 + 
c
 - '0';

940 
i
++;

941 } 
i
 < 3);

942  
num
;

945  
c
;

947 
	}
}

949 
	#LOCAL_STR_BUFSIZE
 64

	)

950 
	sloˇl_°rög
 {

951 *
	mbuf
;

952 
size_t
 
	mÆloc
;

953 
size_t
 
	midx
;

954 
	mtmpbuf
[
LOCAL_STR_BUFSIZE
];

957 
	$öô_loˇl_°rög
(
loˇl_°rög
 *
s
)

959 
	`mem£t
(
s
, 0, (*s));

960 
s
->
buf
 = s->
tmpbuf
;

961 
s
->
Æloc
 = 
LOCAL_STR_BUFSIZE
;

962 
	}
}

964 
	$‰ì_loˇl_°rög
(
loˇl_°rög
 *
s
)

966 i‡(
s
->
buf
 !s->
tmpbuf
)

967 
	`‰ì
(
s
->
buf
);

968 
	}
}

970 
	$add_ch¨_loˇl_°rög
(
loˇl_°rög
 *
s
, 
c
)

972 i‡(
s
->
idx
 >s->
Æloc
) {

973 
size_t
 
«Œoc
 = 
s
->
Æloc
 * 2;

974 i‡(
s
->
buf
 =s->
tmpbuf
) {

975 
s
->
buf
 = 
	`mÆloc
(
«Œoc
);

976 i‡(
s
->
buf
 =
NULL
)

977  -
ENOMEM
;

978 
	`mem˝y
(
s
->
buf
, s->
tmpbuf
, s->
Æloc
);

980 *
±r
 = 
	`ªÆloc
(
s
->
buf
, 
«Œoc
);

981 i‡(
±r
 =
NULL
)

982  -
ENOMEM
;

983 
s
->
buf
 = 
±r
;

985 
s
->
Æloc
 = 
«Œoc
;

987 
s
->
buf
[s->
idx
++] = 
c
;

989 
	}
}

991 *
	$c›y_loˇl_°rög
(
loˇl_°rög
 *
s
)

993 *
d°
 = 
	`mÆloc
(
s
->
idx
 + 1);

994 i‡(
d°
) {

995 
	`mem˝y
(
d°
, 
s
->
buf
, s->
idx
);

996 
d°
[
s
->
idx
] = '\0';

998  
d°
;

999 
	}
}

1001 
	$gë_‰ì°rög
(**
°rög
, 
id
, 
öput_t
 *
öput
)

1003 
loˇl_°rög
 
°r
;

1004 
c
;

1006 
	`öô_loˇl_°rög
(&
°r
);

1008 
c
 = 
	`gë_ch¨
(
öput
);

1009 i‡(
c
 < 0) {

1010 i‡(
c
 =
LOCAL_UNEXPECTED_EOF
) {

1011 *
°rög
 = 
	`c›y_loˇl_°rög
(&
°r
);

1012 i‡(! *
°rög
)

1013 
c
 = -
ENOMEM
;

1015 
c
 = 0;

1019 
c
) {

1021 i‡(!
id
)

1040 *
°rög
 = 
	`c›y_loˇl_°rög
(&
°r
);

1041 i‡(! *
°rög
)

1042 
c
 = -
ENOMEM
;

1044 
	`ungë_ch¨
(
c
, 
öput
);

1045 
c
 = 0;

1047 
_out
;

1051 i‡(
	`add_ch¨_loˇl_°rög
(&
°r
, 
c
) < 0) {

1052 
c
 = -
ENOMEM
;

1056 
_out
:

1057 
	`‰ì_loˇl_°rög
(&
°r
);

1058  
c
;

1059 
	}
}

1061 
	$gë_dñim°rög
(**
°rög
, 
dñim
, 
öput_t
 *
öput
)

1063 
loˇl_°rög
 
°r
;

1064 
c
;

1066 
	`öô_loˇl_°rög
(&
°r
);

1068 
c
 = 
	`gë_ch¨
(
öput
);

1069 i‡(
c
 < 0)

1071 i‡(
c
 == '\\') {

1072 
c
 = 
	`gë_quŸedch¨
(
öput
);

1073 i‡(
c
 < 0)

1075 i‡(
c
 == '\n')

1077 } i‡(
c
 =
dñim
) {

1078 *
°rög
 = 
	`c›y_loˇl_°rög
(&
°r
);

1079 i‡(! *
°rög
)

1080 
c
 = -
ENOMEM
;

1082 
c
 = 0;

1085 i‡(
	`add_ch¨_loˇl_°rög
(&
°r
, 
c
) < 0) {

1086 
c
 = -
ENOMEM
;

1090 
	`‰ì_loˇl_°rög
(&
°r
);

1091  
c
;

1092 
	}
}

1095 
	$gë_°rög
(**
°rög
, 
id
, 
öput_t
 *
öput
)

1097 
c
 = 
	`gë_n⁄whôe
(
öput
), 
îr
;

1098 i‡(
c
 < 0)

1099  
c
;

1100 
c
) {

1110  
LOCAL_UNEXPECTED_CHAR
;

1113 
îr
 = 
	`gë_dñim°rög
(
°rög
, 
c
, 
öput
);

1114 i‡(
îr
 < 0)

1115  
îr
;

1118 
	`ungë_ch¨
(
c
, 
öput
);

1119 
îr
 = 
	`gë_‰ì°rög
(
°rög
, 
id
, 
öput
);

1120 i‡(
îr
 < 0)

1121  
îr
;

1124 
	}
}

1126 
	$_¢d_c⁄fig_make
(
¢d_c⁄fig_t
 **
c⁄fig
, **
id
, 
¢d_c⁄fig_ty≥_t
 
ty≥
)

1128 
¢d_c⁄fig_t
 *
n
;

1129 
	`as£π
(
c⁄fig
);

1130 
n
 = 
	`ˇŒoc
(1, (*n));

1131 i‡(
n
 =
NULL
) {

1132 i‡(*
id
) {

1133 
	`‰ì
(*
id
);

1134 *
id
 = 
NULL
;

1136  -
ENOMEM
;

1138 i‡(
id
) {

1139 
n
->
id
 = *id;

1140 *
id
 = 
NULL
;

1142 
n
->
ty≥
 =Åype;

1143 i‡(
ty≥
 =
SND_CONFIG_TYPE_COMPOUND
)

1144 
	`INIT_LIST_HEAD
(&
n
->
u
.
compound
.
fõlds
);

1145 *
c⁄fig
 = 
n
;

1147 
	}
}

1150 
	$_¢d_c⁄fig_make_add
(
¢d_c⁄fig_t
 **
c⁄fig
, **
id
,

1151 
¢d_c⁄fig_ty≥_t
 
ty≥
, 
¢d_c⁄fig_t
 *
∑ª¡
)

1153 
¢d_c⁄fig_t
 *
n
;

1154 
îr
;

1155 
	`as£π
(
∑ª¡
->
ty≥
 =
SND_CONFIG_TYPE_COMPOUND
);

1156 
îr
 = 
	`_¢d_c⁄fig_make
(&
n
, 
id
, 
ty≥
);

1157 i‡(
îr
 < 0)

1158  
îr
;

1159 
n
->
∑ª¡
 =Öarent;

1160 
	`li°_add_èû
(&
n
->
li°
, &
∑ª¡
->
u
.
compound
.
fõlds
);

1161 *
c⁄fig
 = 
n
;

1163 
	}
}

1165 
	$_¢d_c⁄fig_£¨ch
(
¢d_c⁄fig_t
 *
c⁄fig
,

1166 c⁄° *
id
, 
Àn
, 
¢d_c⁄fig_t
 **
ªsu…
)

1168 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1169 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄fig
) {

1170 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1171 i‡(
Àn
 < 0) {

1172 i‡(
	`°rcmp
(
n
->
id
, id) != 0)

1174 } i‡(
	`°æí
(
n
->
id
Ë!(
size_t
Ë
Àn
 ||

1175 
	`memcmp
(
n
->
id
, id, (
size_t
Ë
Àn
) != 0)

1177 i‡(
ªsu…
)

1178 *
ªsu…
 = 
n
;

1181  -
ENOENT
;

1182 
	}
}

1184 
	$∑r£_vÆue
(
¢d_c⁄fig_t
 **
_n
, snd_c⁄fig_à*
∑ª¡
, 
öput_t
 *
öput
, **
id
, 
skù
)

1186 
¢d_c⁄fig_t
 *
n
 = *
_n
;

1187 *
s
;

1188 
îr
;

1190 
îr
 = 
	`gë_°rög
(&
s
, 0, 
öput
);

1191 i‡(
îr
 < 0)

1192  
îr
;

1193 i‡(
skù
) {

1194 
	`‰ì
(
s
);

1197 i‡(
îr
 =0 && ((
s
[0] >= '0' && s[0] <= '9') || s[0] == '-')) {

1198 
i
;

1199 
î∫o
 = 0;

1200 
îr
 = 
	`ß„_°πﬁl
(
s
, &
i
);

1201 i‡(
îr
 < 0) {

1202 
r
;

1203 
îr
 = 
	`ß„_°πod
(
s
, &
r
);

1204 i‡(
îr
 >= 0) {

1205 
	`‰ì
(
s
);

1206 i‡(
n
) {

1207 i‡(
n
->
ty≥
 !
SND_CONFIG_TYPE_REAL
) {

1208 
	`SNDERR
("%†i†nŸáÑól", *
id
);

1209  -
EINVAL
;

1212 
îr
 = 
	`_¢d_c⁄fig_make_add
(&
n
, 
id
, 
SND_CONFIG_TYPE_REAL
, 
∑ª¡
);

1213 i‡(
îr
 < 0)

1214  
îr
;

1216 
n
->
u
.
ªÆ
 = 
r
;

1217 *
_n
 = 
n
;

1221 
	`‰ì
(
s
);

1222 i‡(
n
) {

1223 i‡(
n
->
ty≥
 !
SND_CONFIG_TYPE_INTEGER
 &&Ç->ty≥ !
SND_CONFIG_TYPE_INTEGER64
) {

1224 
	`SNDERR
("%†i†nŸá¿öãgî", *
id
);

1225  -
EINVAL
;

1228 i‡(
i
 <
INT_MAX
)

1229 
îr
 = 
	`_¢d_c⁄fig_make_add
(&
n
, 
id
, 
SND_CONFIG_TYPE_INTEGER
, 
∑ª¡
);

1231 
îr
 = 
	`_¢d_c⁄fig_make_add
(&
n
, 
id
, 
SND_CONFIG_TYPE_INTEGER64
, 
∑ª¡
);

1232 i‡(
îr
 < 0)

1233  
îr
;

1235 i‡(
n
->
ty≥
 =
SND_CONFIG_TYPE_INTEGER
)

1236 
n
->
u
.
öãgî
 = (Ë
i
;

1238 
n
->
u
.
öãgî64
 = 
i
;

1239 *
_n
 = 
n
;

1243 i‡(
n
) {

1244 i‡(
n
->
ty≥
 !
SND_CONFIG_TYPE_STRING
) {

1245 
	`SNDERR
("%†i†nŸá såög", *
id
);

1246 
	`‰ì
(
s
);

1247  -
EINVAL
;

1250 
îr
 = 
	`_¢d_c⁄fig_make_add
(&
n
, 
id
, 
SND_CONFIG_TYPE_STRING
, 
∑ª¡
);

1251 i‡(
îr
 < 0)

1252  
îr
;

1254 
	`‰ì
(
n
->
u
.
°rög
);

1255 
n
->
u
.
°rög
 = 
s
;

1256 *
_n
 = 
n
;

1258 
	}
}

1260 
∑r£_defs
(
¢d_c⁄fig_t
 *
∑ª¡
, 
öput_t
 *
öput
, 
skù
, 
ovîride
);

1261 
∑r£_¨øy_defs
(
¢d_c⁄fig_t
 *
Áπhî
, 
öput_t
 *
öput
, 
skù
, 
ovîride
);

1263 
	$∑r£_¨øy_def
(
¢d_c⁄fig_t
 *
∑ª¡
, 
öput_t
 *
öput
, *
idx
, 
skù
, 
ovîride
)

1265 *
id
 = 
NULL
;

1266 
c
;

1267 
îr
;

1268 
¢d_c⁄fig_t
 *
n
 = 
NULL
;

1270 i‡(!
skù
) {

1271 
¢d_c⁄fig_t
 *
g
;

1272 
°©ic_id
[12];

1274 
	`¢¥ötf
(
°©ic_id
, (°©ic_id), "%i", *
idx
);

1275 i‡(
	`_¢d_c⁄fig_£¨ch
(
∑ª¡
, 
°©ic_id
, -1, &
g
) == 0) {

1276 i‡(
ovîride
) {

1277 
	`¢d_c⁄fig_dñëe
(
n
);

1280 (*
idx
)++;

1286 
id
 = 
	`°rdup
(
°©ic_id
);

1287 i‡(
id
 =
NULL
)

1288  -
ENOMEM
;

1290 
c
 = 
	`gë_n⁄whôe
(
öput
);

1291 i‡(
c
 < 0) {

1292 
îr
 = 
c
;

1293 
__íd
;

1295 
c
) {

1299 
ídchr
;

1300 i‡(!
skù
) {

1301 i‡(
n
) {

1302 i‡(
n
->
ty≥
 !
SND_CONFIG_TYPE_COMPOUND
) {

1303 
	`SNDERR
("%†i†nŸá compound", 
id
);

1304 
îr
 = -
EINVAL
;

1305 
__íd
;

1308 
îr
 = 
	`_¢d_c⁄fig_make_add
(&
n
, &
id
, 
SND_CONFIG_TYPE_COMPOUND
, 
∑ª¡
);

1309 i‡(
îr
 < 0)

1310 
__íd
;

1313 i‡(
c
 == '{') {

1314 
îr
 = 
	`∑r£_defs
(
n
, 
öput
, 
skù
, 
ovîride
);

1315 
ídchr
 = '}';

1317 
îr
 = 
	`∑r£_¨øy_defs
(
n
, 
öput
, 
skù
, 
ovîride
);

1318 
ídchr
 = ']';

1320 
c
 = 
	`gë_n⁄whôe
(
öput
);

1321 i‡(
c
 < 0) {

1322 
îr
 = 
c
;

1323 
__íd
;

1325 i‡(
c
 !
ídchr
) {

1326 i‡(
n
)

1327 
	`¢d_c⁄fig_dñëe
(
n
);

1328 
îr
 = 
LOCAL_UNEXPECTED_CHAR
;

1329 
__íd
;

1334 
	`ungë_ch¨
(
c
, 
öput
);

1335 
îr
 = 
	`∑r£_vÆue
(&
n
, 
∑ª¡
, 
öput
, &
id
, 
skù
);

1336 i‡(
îr
 < 0)

1337 
__íd
;

1340 
îr
 = 0;

1341 
__íd
:

1342 
	`‰ì
(
id
);

1343  
îr
;

1344 
	}
}

1346 
	$∑r£_¨øy_defs
(
¢d_c⁄fig_t
 *
∑ª¡
, 
öput_t
 *
öput
, 
skù
, 
ovîride
)

1348 
idx
 = 0;

1350 
c
 = 
	`gë_n⁄whôe
(
öput
), 
îr
;

1351 i‡(
c
 < 0)

1352  
c
;

1353 
	`ungë_ch¨
(
c
, 
öput
);

1354 i‡(
c
 == ']')

1356 
îr
 = 
	`∑r£_¨øy_def
(
∑ª¡
, 
öput
, &
idx
, 
skù
, 
ovîride
);

1357 i‡(
îr
 < 0)

1358  
îr
;

1359 
idx
++;

1362 
	}
}

1364 
	$∑r£_def
(
¢d_c⁄fig_t
 *
∑ª¡
, 
öput_t
 *
öput
, 
skù
, 
ovîride
)

1366 *
id
 = 
NULL
;

1367 
c
;

1368 
îr
;

1369 
¢d_c⁄fig_t
 *
n
;

1370 íum {
MERGE_CREATE
, 
MERGE
, 
OVERRIDE
, 
DONT_OVERRIDE
} 
mode
;

1372 
c
 = 
	`gë_n⁄whôe
(
öput
);

1373 i‡(
c
 < 0)

1374  
c
;

1375 
c
) {

1377 
mode
 = 
MERGE_CREATE
;

1380 
mode
 = 
MERGE
;

1383 
mode
 = 
DONT_OVERRIDE
;

1386 
mode
 = 
OVERRIDE
;

1389 
mode
 = !
ovîride
 ? 
MERGE_CREATE
 : 
OVERRIDE
;

1390 
	`ungë_ch¨
(
c
, 
öput
);

1392 
îr
 = 
	`gë_°rög
(&
id
, 1, 
öput
);

1393 i‡(
îr
 < 0)

1394  
îr
;

1395 
c
 = 
	`gë_n⁄whôe
(
öput
);

1396 i‡(
c
 != '.')

1398 i‡(
skù
) {

1399 
	`‰ì
(
id
);

1402 i‡(
	`_¢d_c⁄fig_£¨ch
(
∑ª¡
, 
id
, -1, &
n
) == 0) {

1403 i‡(
mode
 =
DONT_OVERRIDE
) {

1404 
skù
 = 1;

1405 
	`‰ì
(
id
);

1408 i‡(
mode
 !
OVERRIDE
) {

1409 i‡(
n
->
ty≥
 !
SND_CONFIG_TYPE_COMPOUND
) {

1410 
	`SNDERR
("%†i†nŸá compound", 
id
);

1411  -
EINVAL
;

1413 
n
->
u
.
compound
.
joö
 = 
åue
;

1414 
∑ª¡
 = 
n
;

1415 
	`‰ì
(
id
);

1418 
	`¢d_c⁄fig_dñëe
(
n
);

1420 i‡(
mode
 =
MERGE
) {

1421 
	`SNDERR
("%†d€†nŸÉxi°s", 
id
);

1422 
îr
 = -
ENOENT
;

1423 
__íd
;

1425 
îr
 = 
	`_¢d_c⁄fig_make_add
(&
n
, &
id
, 
SND_CONFIG_TYPE_COMPOUND
, 
∑ª¡
);

1426 i‡(
îr
 < 0)

1427 
__íd
;

1428 
n
->
u
.
compound
.
joö
 = 
åue
;

1429 
∑ª¡
 = 
n
;

1431 i‡(
c
 == '=') {

1432 
c
 = 
	`gë_n⁄whôe
(
öput
);

1433 i‡(
c
 < 0)

1434  
c
;

1436 i‡(!
skù
) {

1437 i‡(
	`_¢d_c⁄fig_£¨ch
(
∑ª¡
, 
id
, -1, &
n
) == 0) {

1438 i‡(
mode
 =
DONT_OVERRIDE
) {

1439 
skù
 = 1;

1440 
n
 = 
NULL
;

1441 } i‡(
mode
 =
OVERRIDE
) {

1442 
	`¢d_c⁄fig_dñëe
(
n
);

1443 
n
 = 
NULL
;

1446 
n
 = 
NULL
;

1447 i‡(
mode
 =
MERGE
) {

1448 
	`SNDERR
("%†d€†nŸÉxi°s", 
id
);

1449 
îr
 = -
ENOENT
;

1450 
__íd
;

1454 
c
) {

1458 
ídchr
;

1459 i‡(!
skù
) {

1460 i‡(
n
) {

1461 i‡(
n
->
ty≥
 !
SND_CONFIG_TYPE_COMPOUND
) {

1462 
	`SNDERR
("%†i†nŸá compound", 
id
);

1463 
îr
 = -
EINVAL
;

1464 
__íd
;

1467 
îr
 = 
	`_¢d_c⁄fig_make_add
(&
n
, &
id
, 
SND_CONFIG_TYPE_COMPOUND
, 
∑ª¡
);

1468 i‡(
îr
 < 0)

1469 
__íd
;

1472 i‡(
c
 == '{') {

1473 
îr
 = 
	`∑r£_defs
(
n
, 
öput
, 
skù
, 
ovîride
);

1474 
ídchr
 = '}';

1476 
îr
 = 
	`∑r£_¨øy_defs
(
n
, 
öput
, 
skù
, 
ovîride
);

1477 
ídchr
 = ']';

1479 
c
 = 
	`gë_n⁄whôe
(
öput
);

1480 i‡(
c
 !
ídchr
) {

1481 i‡(
n
)

1482 
	`¢d_c⁄fig_dñëe
(
n
);

1483 
îr
 = 
LOCAL_UNEXPECTED_CHAR
;

1484 
__íd
;

1489 
	`ungë_ch¨
(
c
, 
öput
);

1490 
îr
 = 
	`∑r£_vÆue
(&
n
, 
∑ª¡
, 
öput
, &
id
, 
skù
);

1491 i‡(
îr
 < 0)

1492 
__íd
;

1495 
c
 = 
	`gë_n⁄whôe
(
öput
);

1496 
c
) {

1501 
	`ungë_ch¨
(
c
, 
öput
);

1503 
__íd
:

1504 
	`‰ì
(
id
);

1505  
îr
;

1506 
	}
}

1508 
	$∑r£_defs
(
¢d_c⁄fig_t
 *
∑ª¡
, 
öput_t
 *
öput
, 
skù
, 
ovîride
)

1510 
c
, 
îr
;

1512 
c
 = 
	`gë_n⁄whôe
(
öput
);

1513 i‡(
c
 < 0)

1514  
c
 =
LOCAL_UNEXPECTED_EOF
 ? 0 : c;

1515 
	`ungë_ch¨
(
c
, 
öput
);

1516 i‡(
c
 == '}')

1518 
îr
 = 
	`∑r£_def
(
∑ª¡
, 
öput
, 
skù
, 
ovîride
);

1519 i‡(
îr
 < 0)

1520  
îr
;

1523 
	}
}

1525 
	$°rög_¥öt
(*
°r
, 
id
, 
¢d_ouçut_t
 *
out
)

1527 
q
;

1528 *
p
 = (*)
°r
;

1529 i‡(!
p
 || !*p) {

1530 
	`¢d_ouçut_puts
(
out
, "''");

1533 i‡(!
id
) {

1534 *
p
) {

1538 
quŸed
;

1541 
lo›
:

1542 *
p
) {

1544 
n⁄quŸed
;

1558 
quŸed
;

1560 i‡(*
p
 <= 31 || *p >= 127)

1561 
quŸed
;

1562 
p
++;

1563 
lo›
;

1565 
n⁄quŸed
:

1566 
	`¢d_ouçut_puts
(
out
, 
°r
);

1568 
quŸed
:

1569 
q
 = 
	`°rchr
(
°r
, '\'') ? '"' : '\'';

1570 
	`¢d_ouçut_putc
(
out
, 
q
);

1571 
p
 = (*)
°r
;

1572 *
p
) {

1573 
c
;

1574 
c
 = *
p
;

1575 
c
) {

1577 
	`¢d_ouçut_putc
(
out
, '\\');

1578 
	`¢d_ouçut_putc
(
out
, 'n');

1581 
	`¢d_ouçut_putc
(
out
, '\\');

1582 
	`¢d_ouçut_putc
(
out
, 't');

1585 
	`¢d_ouçut_putc
(
out
, '\\');

1586 
	`¢d_ouçut_putc
(
out
, 'v');

1589 
	`¢d_ouçut_putc
(
out
, '\\');

1590 
	`¢d_ouçut_putc
(
out
, 'b');

1593 
	`¢d_ouçut_putc
(
out
, '\\');

1594 
	`¢d_ouçut_putc
(
out
, 'r');

1597 
	`¢d_ouçut_putc
(
out
, '\\');

1598 
	`¢d_ouçut_putc
(
out
, 'f');

1601 i‡(
c
 =
q
) {

1602 
	`¢d_ouçut_putc
(
out
, '\\');

1603 
	`¢d_ouçut_putc
(
out
, 
c
);

1605 i‡(
c
 >= 32 && c <= 126)

1606 
	`¢d_ouçut_putc
(
out
, 
c
);

1608 
	`¢d_ouçut_¥ötf
(
out
, "\\%04o", 
c
);

1612 
p
++;

1614 
	`¢d_ouçut_putc
(
out
, 
q
);

1615 
	}
}

1617 
	$Àvñ_¥öt
(
¢d_ouçut_t
 *
out
, 
Àvñ
)

1619 
a
[
Àvñ
 + 1];

1620 
	`mem£t
(
a
, '\t', 
Àvñ
);

1621 
a
[
Àvñ
] = '\0';

1622 
	`¢d_ouçut_puts
(
out
, 
a
);

1623 
	}
}

1625 
_¢d_c⁄fig_ßve_chûdªn
(
¢d_c⁄fig_t
 *
c⁄fig
, 
¢d_ouçut_t
 *
out
,

1626 
Àvñ
, 
joös
,

1627 
¨øy
);

1629 
	$_¢d_c⁄fig_ßve_node_vÆue
(
¢d_c⁄fig_t
 *
n
, 
¢d_ouçut_t
 *
out
,

1630 
Àvñ
)

1632 
îr
, 
¨øy
;

1633 
n
->
ty≥
) {

1634 
SND_CONFIG_TYPE_INTEGER
:

1635 
	`¢d_ouçut_¥ötf
(
out
, "%ld", 
n
->
u
.
öãgî
);

1637 
SND_CONFIG_TYPE_INTEGER64
:

1638 
	`¢d_ouçut_¥ötf
(
out
, "%Œd", 
n
->
u
.
öãgî64
);

1640 
SND_CONFIG_TYPE_REAL
:

1641 
	`¢d_ouçut_¥ötf
(
out
, "%-16g", 
n
->
u
.
ªÆ
);

1643 
SND_CONFIG_TYPE_STRING
:

1644 
	`°rög_¥öt
(
n
->
u
.
°rög
, 0, 
out
);

1646 
SND_CONFIG_TYPE_POINTER
:

1647 
	`SNDERR
("cannot saveÑuntimeÖointerÅype");

1648  -
EINVAL
;

1649 
SND_CONFIG_TYPE_COMPOUND
:

1650 
¨øy
 = 
	`¢d_c⁄fig_is_¨øy
(
n
);

1651 
	`¢d_ouçut_putc
(
out
, 
¨øy
 ? '[' : '{');

1652 
	`¢d_ouçut_putc
(
out
, '\n');

1653 
îr
 = 
	`_¢d_c⁄fig_ßve_chûdªn
(
n
, 
out
, 
Àvñ
 + 1, 0, 
¨øy
);

1654 i‡(
îr
 < 0)

1655  
îr
;

1656 
	`Àvñ_¥öt
(
out
, 
Àvñ
);

1657 
	`¢d_ouçut_putc
(
out
, 
¨øy
 ? ']' : '}');

1661 
	}
}

1663 
	$id_¥öt
(
¢d_c⁄fig_t
 *
n
, 
¢d_ouçut_t
 *
out
, 
joös
)

1665 i‡(
joös
 > 0) {

1666 
	`as£π
(
n
->
∑ª¡
);

1667 
	`id_¥öt
(
n
->
∑ª¡
, 
out
, 
joös
 - 1);

1668 
	`¢d_ouçut_putc
(
out
, '.');

1670 
	`°rög_¥öt
(
n
->
id
, 1, 
out
);

1671 
	}
}

1673 
	$_¢d_c⁄fig_ßve_chûdªn
(
¢d_c⁄fig_t
 *
c⁄fig
, 
¢d_ouçut_t
 *
out
,

1674 
Àvñ
, 
joös
,

1675 
¨øy
)

1677 
îr
;

1678 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1679 
	`as£π
(
c⁄fig
 && 
out
);

1680 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄fig
) {

1681 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1682 i‡(
n
->
ty≥
 =
SND_CONFIG_TYPE_COMPOUND
 &&

1683 
n
->
u
.
compound
.
joö
) {

1684 
îr
 = 
	`_¢d_c⁄fig_ßve_chûdªn
(
n
, 
out
, 
Àvñ
, 
joös
 + 1, 0);

1685 i‡(
îr
 < 0)

1686  
îr
;

1689 
	`Àvñ_¥öt
(
out
, 
Àvñ
);

1690 i‡(!
¨øy
) {

1691 
	`id_¥öt
(
n
, 
out
, 
joös
);

1692 
	`¢d_ouçut_putc
(
out
, ' ');

1694 
	`¢d_ouçut_putc
(
out
, '=');

1697 
îr
 = 
	`_¢d_c⁄fig_ßve_node_vÆue
(
n
, 
out
, 
Àvñ
);

1698 i‡(
îr
 < 0)

1699  
îr
;

1701 
	`¢d_ouçut_putc
(
out
, ';');

1703 
	`¢d_ouçut_putc
(
out
, '\n');

1706 
	}
}

1730 
	$¢d_c⁄fig_sub°ôuã
(
¢d_c⁄fig_t
 *
d°
, snd_c⁄fig_à*
§c
)

1732 
	`as£π
(
d°
 && 
§c
);

1733 i‡(
d°
->
ty≥
 =
SND_CONFIG_TYPE_COMPOUND
) {

1734 
îr
 = 
	`¢d_c⁄fig_dñëe_compound_membîs
(
d°
);

1735 i‡(
îr
 < 0)

1736  
îr
;

1738 i‡(
d°
->
ty≥
 =
SND_CONFIG_TYPE_COMPOUND
 &&

1739 
§c
->
ty≥
 =
SND_CONFIG_TYPE_COMPOUND
) {

1740 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1741 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
§c
) {

1742 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1743 
n
->
∑ª¡
 = 
d°
;

1745 
§c
->
u
.
compound
.
fõlds
.
√xt
->
¥ev
 = &
d°
->u.compound.fields;

1746 
§c
->
u
.
compound
.
fõlds
.
¥ev
->
√xt
 = &
d°
->u.compound.fields;

1748 
	`‰ì
(
d°
->
id
);

1749 i‡(
d°
->
ty≥
 =
SND_CONFIG_TYPE_STRING
)

1750 
	`‰ì
(
d°
->
u
.
°rög
);

1751 
d°
->
id
 = 
§c
->id;

1752 
d°
->
ty≥
 = 
§c
->type;

1753 
d°
->
u
 = 
§c
->u;

1754 
	`‰ì
(
§c
);

1756 
	}
}

1778 
	$¢d_c⁄fig_gë_ty≥_ascii
(c⁄° *
ascii
, 
¢d_c⁄fig_ty≥_t
 *
ty≥
)

1780 
	`as£π
(
ascii
 && 
ty≥
);

1781 i‡(!
	`°rcmp
(
ascii
, "integer")) {

1782 *
ty≥
 = 
SND_CONFIG_TYPE_INTEGER
;

1785 i‡(!
	`°rcmp
(
ascii
, "integer64")) {

1786 *
ty≥
 = 
SND_CONFIG_TYPE_INTEGER64
;

1789 i‡(!
	`°rcmp
(
ascii
, "real")) {

1790 *
ty≥
 = 
SND_CONFIG_TYPE_REAL
;

1793 i‡(!
	`°rcmp
(
ascii
, "string")) {

1794 *
ty≥
 = 
SND_CONFIG_TYPE_STRING
;

1797 i‡(!
	`°rcmp
(
ascii
, "compound")) {

1798 *
ty≥
 = 
SND_CONFIG_TYPE_COMPOUND
;

1801  -
EINVAL
;

1802 
	}
}

1812 
¢d_c⁄fig_ty≥_t
 
	$¢d_c⁄fig_gë_ty≥
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
)

1814  
c⁄fig
->
ty≥
;

1815 
	}
}

1817 
	$check_¨øy_ôem
(c⁄° *
id
, 
ödex
)

1819 c⁄° *
p
;

1820 
vÆ
;

1822 
p
 = 
id
; *p;Ö++) {

1823 i‡(*
p
 < '0' || *p > '9')

1827 i‡(
	`ß„_°πﬁ
(
id
, &
vÆ
))

1829  
vÆ
 =
ödex
;

1830 
	}
}

1838 
	$¢d_c⁄fig_is_¨øy
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
)

1840 
idx
;

1841 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1842 
¢d_c⁄fig_t
 *
node
;

1844 
	`as£π
(
c⁄fig
);

1845 i‡(
c⁄fig
->
ty≥
 !
SND_CONFIG_TYPE_COMPOUND
)

1846  -
EINVAL
;

1847 
idx
 = 0;

1848 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄fig
) {

1849 
node
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1850 i‡(!
	`check_¨øy_ôem
(
node
->
id
, 
idx
))

1852 
idx
++;

1854  
idx
;

1855 
	}
}

1862 
	$¢d_c⁄fig_is_em±y
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
)

1864 
	`as£π
(
c⁄fig
);

1865 i‡(
c⁄fig
->
ty≥
 !
SND_CONFIG_TYPE_COMPOUND
)

1866  -
EINVAL
;

1867  
	`li°_em±y
(&
c⁄fig
->
u
.
compound
.
fõlds
);

1868 
	}
}

1886 
	$¢d_c⁄fig_gë_id
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° **
id
)

1888 
	`as£π
(
c⁄fig
 && 
id
);

1889 *
id
 = 
c⁄fig
->id;

1891 
	}
}

1908 
	$¢d_c⁄fig_£t_id
(
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° *
id
)

1910 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1911 *
√w_id
;

1912 
	`as£π
(
c⁄fig
);

1913 i‡(
id
) {

1914 i‡(
c⁄fig
->
∑ª¡
) {

1915 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄fig
->
∑ª¡
) {

1916 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1917 i‡(
n
 !
c⁄fig
 && 
	`°rcmp
(
id
,Ç->id) == 0)

1918  -
EEXIST
;

1921 
√w_id
 = 
	`°rdup
(
id
);

1922 i‡(!
√w_id
)

1923  -
ENOMEM
;

1925 i‡(
c⁄fig
->
∑ª¡
)

1926  -
EINVAL
;

1927 
√w_id
 = 
NULL
;

1929 
	`‰ì
(
c⁄fig
->
id
);

1930 
c⁄fig
->
id
 = 
√w_id
;

1932 
	}
}

1950 
	$¢d_c⁄fig_t›
(
¢d_c⁄fig_t
 **
c⁄fig
)

1952 
	`as£π
(
c⁄fig
);

1953  
	`_¢d_c⁄fig_make
(
c⁄fig
, 0, 
SND_CONFIG_TYPE_COMPOUND
);

1954 
	}
}

1956 #i‚de‡
DOC_HIDDEN


1957 
	$_¢d_c⁄fig_lﬂd_wôh_ö˛ude
(
¢d_c⁄fig_t
 *
c⁄fig
, 
¢d_öput_t
 *
ö
,

1958 
ovîride
, c⁄° * c⁄° *
ö˛ude_∑ths
)

1960 
îr
;

1961 
öput_t
 
öput
;

1962 
fûedesc
 *
fd
, *
fd_√xt
;

1964 
	`as£π
(
c⁄fig
 && 
ö
);

1965 
fd
 = 
	`mÆloc
((*fd));

1966 i‡(!
fd
)

1967  -
ENOMEM
;

1968 
fd
->
«me
 = 
NULL
;

1969 
fd
->
ö
 = in;

1970 
fd
->
löe
 = 1;

1971 
fd
->
cﬁumn
 = 0;

1972 
fd
->
√xt
 = 
NULL
;

1973 
	`INIT_LIST_HEAD
(&
fd
->
ö˛ude_∑ths
);

1974 i‡(
ö˛ude_∑ths
) {

1975 ; *
ö˛ude_∑ths
; include_paths++) {

1976 
îr
 = 
	`add_ö˛ude_∑th
(
fd
, *
ö˛ude_∑ths
);

1977 i‡(
îr
 < 0)

1978 
_íd
;

1981 
îr
 = 
	`add_ö˛ude_∑th
(
fd
, 
	`¢d_c⁄fig_t›dú
());

1982 i‡(
îr
 < 0)

1983 
_íd
;

1985 
öput
.
cuºít
 = 
fd
;

1986 
öput
.
ungë
 = 0;

1987 
îr
 = 
	`∑r£_defs
(
c⁄fig
, &
öput
, 0, 
ovîride
);

1988 
fd
 = 
öput
.
cuºít
;

1989 i‡(
îr
 < 0) {

1990 c⁄° *
°r
;

1991 
îr
) {

1992 
LOCAL_UNTERMINATED_STRING
:

1993 
°r
 = "Unterminated string";

1994 
îr
 = -
EINVAL
;

1996 
LOCAL_UNTERMINATED_QUOTE
:

1997 
°r
 = "Unterminated quote";

1998 
îr
 = -
EINVAL
;

2000 
LOCAL_UNEXPECTED_CHAR
:

2001 
°r
 = "Unexpected char";

2002 
îr
 = -
EINVAL
;

2004 
LOCAL_UNEXPECTED_EOF
:

2005 
°r
 = "UnexpectedÉnd of file";

2006 
îr
 = -
EINVAL
;

2009 
°r
 = 
	`°ªº‹
(-
îr
);

2012 
	`SNDERR
("%s:%d:%d:%s", 
fd
->
«me
 ? fd->«mê: "_t›Àvñ_", fd->
löe
, fd->
cﬁumn
, 
°r
);

2013 
_íd
;

2015 
îr
 = 
	`gë_ch¨
(&
öput
);

2016 
fd
 = 
öput
.
cuºít
;

2017 i‡(
îr
 !
LOCAL_UNEXPECTED_EOF
) {

2018 
	`SNDERR
("%s:%d:%d:U√x≥˘ed }", 
fd
->
«me
 ? fd->«mê: "", fd->
löe
, fd->
cﬁumn
);

2019 
îr
 = -
EINVAL
;

2020 
_íd
;

2022 
îr
 = 0;

2023 
_íd
:

2024 
fd
->
√xt
) {

2025 
fd_√xt
 = 
fd
->
√xt
;

2026 
	`¢d_öput_˛o£
(
fd
->
ö
);

2027 
	`‰ì
(
fd
->
«me
);

2028 
	`‰ì_ö˛ude_∑ths
(
fd
);

2029 
	`‰ì
(
fd
);

2030 
fd
 = 
fd_√xt
;

2033 
	`‰ì_ö˛ude_∑ths
(
fd
);

2034 
	`‰ì
(
fd
);

2035  
îr
;

2036 
	}
}

2055 
	$¢d_c⁄fig_lﬂd
(
¢d_c⁄fig_t
 *
c⁄fig
, 
¢d_öput_t
 *
ö
)

2057  
	`_¢d_c⁄fig_lﬂd_wôh_ö˛ude
(
c⁄fig
, 
ö
, 0, 
NULL
);

2058 
	}
}

2076 
	$¢d_c⁄fig_lﬂd_°rög
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
s
, 
size_t
 
size
)

2078 
¢d_öput_t
 *
öput
;

2079 
¢d_c⁄fig_t
 *
d°
;

2080 
îr
;

2082 
	`as£π
(
c⁄fig
 && 
s
);

2083 i‡(
size
 == 0)

2084 
size
 = 
	`°æí
(
s
);

2085 
îr
 = 
	`¢d_öput_buf„r_›í
(&
öput
, 
s
, 
size
);

2086 i‡(
îr
 < 0)

2087  
îr
;

2088 
îr
 = 
	`¢d_c⁄fig_t›
(&
d°
);

2089 i‡(
îr
 < 0) {

2090 
	`¢d_öput_˛o£
(
öput
);

2091  
îr
;

2093 
îr
 = 
	`¢d_c⁄fig_lﬂd
(
d°
, 
öput
);

2094 
	`¢d_öput_˛o£
(
öput
);

2095 i‡(
îr
 < 0) {

2096 
	`¢d_c⁄fig_dñëe
(
d°
);

2097  
îr
;

2099 *
c⁄fig
 = 
d°
;

2101 
	}
}

2113 
	$¢d_c⁄fig_lﬂd_ovîride
(
¢d_c⁄fig_t
 *
c⁄fig
, 
¢d_öput_t
 *
ö
)

2115  
	`_¢d_c⁄fig_lﬂd_wôh_ö˛ude
(
c⁄fig
, 
ö
, 1, 
NULL
);

2116 
	}
}

2142 
	$¢d_c⁄fig_add
(
¢d_c⁄fig_t
 *
∑ª¡
, snd_c⁄fig_à*
chûd
)

2144 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

2145 
	`as£π
(
∑ª¡
 && 
chûd
);

2146 i‡(!
chûd
->
id
 || chûd->
∑ª¡
)

2147  -
EINVAL
;

2148 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
∑ª¡
) {

2149 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

2150 i‡(
	`°rcmp
(
chûd
->
id
, 
n
->id) == 0)

2151  -
EEXIST
;

2153 
chûd
->
∑ª¡
 =Öarent;

2154 
	`li°_add_èû
(&
chûd
->
li°
, &
∑ª¡
->
u
.
compound
.
fõlds
);

2156 
	}
}

2180 
	$¢d_c⁄fig_add_a·î
(
¢d_c⁄fig_t
 *
a·î
, snd_c⁄fig_à*
chûd
)

2182 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

2183 
¢d_c⁄fig_t
 *
∑ª¡
;

2184 
	`as£π
(
a·î
 && 
chûd
);

2185 
∑ª¡
 = 
a·î
->parent;

2186 
	`as£π
(
∑ª¡
);

2187 i‡(!
chûd
->
id
 || chûd->
∑ª¡
)

2188  -
EINVAL
;

2189 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
∑ª¡
) {

2190 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

2191 i‡(
	`°rcmp
(
chûd
->
id
, 
n
->id) == 0)

2192  -
EEXIST
;

2194 
chûd
->
∑ª¡
 =Öarent;

2195 
	`li°_ö£π
(&
chûd
->
li°
, &
a·î
->li°,á·î->li°.
√xt
);

2197 
	}
}

2221 
	$¢d_c⁄fig_add_bef‹e
(
¢d_c⁄fig_t
 *
bef‹e
, snd_c⁄fig_à*
chûd
)

2223 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

2224 
¢d_c⁄fig_t
 *
∑ª¡
;

2225 
	`as£π
(
bef‹e
 && 
chûd
);

2226 
∑ª¡
 = 
bef‹e
->parent;

2227 
	`as£π
(
∑ª¡
);

2228 i‡(!
chûd
->
id
 || chûd->
∑ª¡
)

2229  -
EINVAL
;

2230 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
∑ª¡
) {

2231 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

2232 i‡(
	`°rcmp
(
chûd
->
id
, 
n
->id) == 0)

2233  -
EEXIST
;

2235 
chûd
->
∑ª¡
 =Öarent;

2236 
	`li°_ö£π
(&
chûd
->
li°
, 
bef‹e
->li°.
¥ev
, &before->list);

2238 
	}
}

2243 
	$_¢d_c⁄fig_¨øy_mîge
(
¢d_c⁄fig_t
 *
d°
, snd_c⁄fig_à*
§c
, 
ödex
)

2245 
¢d_c⁄fig_ôî©‹_t
 
si
, 
¢ext
;

2246 
îr
;

2248 
	`¢d_c⁄fig_f‹_óch
(
si
, 
¢ext
, 
§c
) {

2249 
¢d_c⁄fig_t
 *
¢
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
si
);

2250 
id
[16];

2251 
	`¢d_c⁄fig_ªmove
(
¢
);

2252 
	`¢¥ötf
(
id
, (id), "%d", 
ödex
++);

2253 
îr
 = 
	`¢d_c⁄fig_£t_id
(
¢
, 
id
);

2254 i‡(
îr
 < 0) {

2255 
	`¢d_c⁄fig_dñëe
(
¢
);

2256  
îr
;

2258 
¢
->
∑ª¡
 = 
d°
;

2259 
	`li°_add_èû
(&
¢
->
li°
, &
d°
->
u
.
compound
.
fõlds
);

2261 
	`¢d_c⁄fig_dñëe
(
§c
);

2263 
	}
}

2290 
	$¢d_c⁄fig_mîge
(
¢d_c⁄fig_t
 *
d°
, snd_c⁄fig_à*
§c
, 
ovîride
)

2292 
¢d_c⁄fig_ôî©‹_t
 
di
, 
si
, 
d√xt
, 
¢ext
;

2293 
boﬁ
 
found
;

2294 
îr
, 
¨øy
;

2296 
	`as£π
(
d°
);

2297 i‡(
§c
 =
NULL
)

2299 i‡(
d°
->
ty≥
 !
SND_CONFIG_TYPE_COMPOUND
 || 
§c
->type != SND_CONFIG_TYPE_COMPOUND)

2300  
	`¢d_c⁄fig_sub°ôuã
(
d°
, 
§c
);

2301 
¨øy
 = 
	`¢d_c⁄fig_is_¨øy
(
d°
);

2302 i‡(
¨øy
 && 
	`¢d_c⁄fig_is_¨øy
(
§c
))

2303  
	`_¢d_c⁄fig_¨øy_mîge
(
d°
, 
§c
, 
¨øy
);

2304 
	`¢d_c⁄fig_f‹_óch
(
si
, 
¢ext
, 
§c
) {

2305 
¢d_c⁄fig_t
 *
¢
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
si
);

2306 
found
 = 
Ál£
;

2307 
	`¢d_c⁄fig_f‹_óch
(
di
, 
d√xt
, 
d°
) {

2308 
¢d_c⁄fig_t
 *
dn
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
di
);

2309 i‡(
	`°rcmp
(
¢
->
id
, 
dn
->id) == 0) {

2310 i‡(
ovîride
 ||

2311 
¢
->
ty≥
 !
SND_CONFIG_TYPE_COMPOUND
 ||

2312 
dn
->
ty≥
 !
SND_CONFIG_TYPE_COMPOUND
) {

2313 
	`¢d_c⁄fig_ªmove
(
¢
);

2314 
îr
 = 
	`¢d_c⁄fig_sub°ôuã
(
dn
, 
¢
);

2315 i‡(
îr
 < 0)

2316  
îr
;

2318 
îr
 = 
	`¢d_c⁄fig_mîge
(
dn
, 
¢
, 0);

2319 i‡(
îr
 < 0)

2320  
îr
;

2322 
found
 = 
åue
;

2326 i‡(!
found
) {

2328 
	`¢d_c⁄fig_ªmove
(
¢
);

2329 
¢
->
∑ª¡
 = 
d°
;

2330 
	`li°_add_èû
(&
¢
->
li°
, &
d°
->
u
.
compound
.
fõlds
);

2333 
	`¢d_c⁄fig_dñëe
(
§c
);

2335 
	}
}

2350 
	$¢d_c⁄fig_ªmove
(
¢d_c⁄fig_t
 *
c⁄fig
)

2352 
	`as£π
(
c⁄fig
);

2353 i‡(
c⁄fig
->
∑ª¡
)

2354 
	`li°_dñ
(&
c⁄fig
->
li°
);

2355 
c⁄fig
->
∑ª¡
 = 
NULL
;

2357 
	}
}

2381 
	$¢d_c⁄fig_dñëe
(
¢d_c⁄fig_t
 *
c⁄fig
)

2383 
	`as£π
(
c⁄fig
);

2384 i‡(
c⁄fig
->
ªfcou¡
 > 0) {

2385 
c⁄fig
->
ªfcou¡
--;

2388 
c⁄fig
->
ty≥
) {

2389 
SND_CONFIG_TYPE_COMPOUND
:

2391 
îr
;

2392 
li°_hód
 *
i
;

2393 
i
 = 
c⁄fig
->
u
.
compound
.
fõlds
.
√xt
;

2394 
i
 !&
c⁄fig
->
u
.
compound
.
fõlds
) {

2395 
li°_hód
 *
√xti
 = 
i
->
√xt
;

2396 
¢d_c⁄fig_t
 *
chûd
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

2397 
îr
 = 
	`¢d_c⁄fig_dñëe
(
chûd
);

2398 i‡(
îr
 < 0)

2399  
îr
;

2400 
i
 = 
√xti
;

2404 
SND_CONFIG_TYPE_STRING
:

2405 
	`‰ì
(
c⁄fig
->
u
.
°rög
);

2410 i‡(
c⁄fig
->
∑ª¡
)

2411 
	`li°_dñ
(&
c⁄fig
->
li°
);

2412 
	`‰ì
(
c⁄fig
->
id
);

2413 
	`‰ì
(
c⁄fig
);

2415 
	}
}

2435 
	$¢d_c⁄fig_dñëe_compound_membîs
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
)

2437 
îr
;

2438 
li°_hód
 *
i
;

2440 
	`as£π
(
c⁄fig
);

2441 i‡(
c⁄fig
->
ty≥
 !
SND_CONFIG_TYPE_COMPOUND
)

2442  -
EINVAL
;

2443 
i
 = 
c⁄fig
->
u
.
compound
.
fõlds
.
√xt
;

2444 
i
 !&
c⁄fig
->
u
.
compound
.
fõlds
) {

2445 
li°_hód
 *
√xti
 = 
i
->
√xt
;

2446 
¢d_c⁄fig_t
 *
chûd
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

2447 
îr
 = 
	`¢d_c⁄fig_dñëe
(
chûd
);

2448 i‡(
îr
 < 0)

2449  
îr
;

2450 
i
 = 
√xti
;

2453 
	}
}

2474 
	$¢d_c⁄fig_make
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
id
,

2475 
¢d_c⁄fig_ty≥_t
 
ty≥
)

2477 *
id1
;

2478 
	`as£π
(
c⁄fig
);

2479 i‡(
id
) {

2480 
id1
 = 
	`°rdup
(
id
);

2481 i‡(!
id1
)

2482  -
ENOMEM
;

2484 
id1
 = 
NULL
;

2485  
	`_¢d_c⁄fig_make
(
c⁄fig
, &
id1
, 
ty≥
);

2486 
	}
}

2508 
	$¢d_c⁄fig_make_öãgî
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
id
)

2510  
	`¢d_c⁄fig_make
(
c⁄fig
, 
id
, 
SND_CONFIG_TYPE_INTEGER
);

2511 
	}
}

2533 
	$¢d_c⁄fig_make_öãgî64
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
id
)

2535  
	`¢d_c⁄fig_make
(
c⁄fig
, 
id
, 
SND_CONFIG_TYPE_INTEGER64
);

2536 
	}
}

2555 
	$¢d_c⁄fig_make_ªÆ
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
id
)

2557  
	`¢d_c⁄fig_make
(
c⁄fig
, 
id
, 
SND_CONFIG_TYPE_REAL
);

2558 
	}
}

2580 
	$¢d_c⁄fig_make_°rög
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
id
)

2582  
	`¢d_c⁄fig_make
(
c⁄fig
, 
id
, 
SND_CONFIG_TYPE_STRING
);

2583 
	}
}

2602 
	$¢d_c⁄fig_make_poöãr
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
id
)

2604  
	`¢d_c⁄fig_make
(
c⁄fig
, 
id
, 
SND_CONFIG_TYPE_POINTER
);

2605 
	}
}

2645 
	$¢d_c⁄fig_make_compound
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
id
,

2646 
joö
)

2648 
îr
;

2649 
îr
 = 
	`¢d_c⁄fig_make
(
c⁄fig
, 
id
, 
SND_CONFIG_TYPE_COMPOUND
);

2650 i‡(
îr
 < 0)

2651  
îr
;

2652 (*
c⁄fig
)->
u
.
compound
.
joö
 = join;

2654 
	}
}

2697 
	$¢d_c⁄fig_make_∑th
(
¢d_c⁄fig_t
 **
c⁄fig
, snd_c⁄fig_à*
roŸ
,

2698 c⁄° *
key
, 
joö
, 
ovîride
)

2700 
¢d_c⁄fig_t
 *
n
;

2701 c⁄° *
p
;

2702 
îr
;

2705 
p
 = 
	`°rchr
(
key
, '.');

2706 i‡(
p
) {

2707 
îr
 = 
	`_¢d_c⁄fig_£¨ch
(
roŸ
, 
key
, 
p
 - key, &
n
);

2708 i‡(
îr
 < 0) {

2709 
size_t
 
l
 = 
p
 - 
key
;

2710 *
s
 = 
	`mÆloc
(
l
 + 1);

2711 i‡(
s
 =
NULL
)

2712  -
ENOMEM
;

2713 
	`°∫˝y
(
s
, 
key
, 
l
);

2714 
s
[
l
] = '\0';

2715 
îr
 = 
	`¢d_c⁄fig_make_compound
(&
n
, 
s
, 
joö
);

2716 
	`‰ì
(
s
);

2717 i‡(
îr
 < 0)

2718  
îr
;

2719 
îr
 = 
	`¢d_c⁄fig_add
(
roŸ
, 
n
);

2720 i‡(
îr
 < 0)

2721  
îr
;

2723 
roŸ
 = 
n
;

2724 
key
 = 
p
 + 1;

2726 
îr
 = 
	`_¢d_c⁄fig_£¨ch
(
roŸ
, 
key
, -1, 
c⁄fig
);

2727 i‡(
îr
 == 0) {

2728 i‡((*
c⁄fig
)->
ty≥
 !
SND_CONFIG_TYPE_COMPOUND
) {

2729 i‡(
ovîride
) {

2730 
îr
 = 
	`¢d_c⁄fig_dñëe
(*
c⁄fig
);

2731 i‡(
îr
 < 0)

2732  
îr
;

2733 
__make
;

2735  -
EACCES
;

2740 
__make
:

2741 
îr
 = 
	`¢d_c⁄fig_make_compound
(&
n
, 
key
, 
joö
);

2742 i‡(
îr
 < 0)

2743  
îr
;

2744 
îr
 = 
	`¢d_c⁄fig_add
(
roŸ
, 
n
);

2745 i‡(
îr
 < 0)

2746  
îr
;

2747 *
c⁄fig
 = 
n
;

2751 
	}
}

2772 
	$¢d_c⁄fig_imake_öãgî
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
id
, c⁄° 
vÆue
)

2774 
îr
;

2776 
îr
 = 
	`¢d_c⁄fig_make
(
c⁄fig
, 
id
, 
SND_CONFIG_TYPE_INTEGER
);

2777 i‡(
îr
 < 0)

2778  
îr
;

2779 (*
c⁄fig
)->
u
.
öãgî
 = 
vÆue
;

2781 
	}
}

2802 
	$¢d_c⁄fig_imake_öãgî64
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
id
, c⁄° 
vÆue
)

2804 
îr
;

2806 
îr
 = 
	`¢d_c⁄fig_make
(
c⁄fig
, 
id
, 
SND_CONFIG_TYPE_INTEGER64
);

2807 i‡(
îr
 < 0)

2808  
îr
;

2809 (*
c⁄fig
)->
u
.
öãgî64
 = 
vÆue
;

2811 
	}
}

2829 
	$¢d_c⁄fig_imake_ªÆ
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
id
, c⁄° 
vÆue
)

2831 
îr
;

2833 
îr
 = 
	`¢d_c⁄fig_make
(
c⁄fig
, 
id
, 
SND_CONFIG_TYPE_REAL
);

2834 i‡(
îr
 < 0)

2835  
îr
;

2836 (*
c⁄fig
)->
u
.
ªÆ
 = 
vÆue
;

2838 
	}
}

2859 
	$¢d_c⁄fig_imake_°rög
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
id
, c⁄° *
vÆue
)

2861 
îr
;

2862 
¢d_c⁄fig_t
 *
tmp
;

2864 
îr
 = 
	`¢d_c⁄fig_make
(&
tmp
, 
id
, 
SND_CONFIG_TYPE_STRING
);

2865 i‡(
îr
 < 0)

2866  
îr
;

2867 i‡(
vÆue
) {

2868 
tmp
->
u
.
°rög
 = 
	`°rdup
(
vÆue
);

2869 i‡(!
tmp
->
u
.
°rög
) {

2870 
	`¢d_c⁄fig_dñëe
(
tmp
);

2871  -
ENOMEM
;

2874 
tmp
->
u
.
°rög
 = 
NULL
;

2876 *
c⁄fig
 = 
tmp
;

2878 
	}
}

2900 
	$¢d_c⁄fig_imake_ß„_°rög
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
id
, c⁄° *
vÆue
)

2902 
îr
;

2903 
¢d_c⁄fig_t
 *
tmp
;

2904 *
c
;

2906 
îr
 = 
	`¢d_c⁄fig_make
(&
tmp
, 
id
, 
SND_CONFIG_TYPE_STRING
);

2907 i‡(
îr
 < 0)

2908  
îr
;

2909 i‡(
vÆue
) {

2910 
tmp
->
u
.
°rög
 = 
	`°rdup
(
vÆue
);

2911 i‡(!
tmp
->
u
.
°rög
) {

2912 
	`¢d_c⁄fig_dñëe
(
tmp
);

2913  -
ENOMEM
;

2916 
c
 = 
tmp
->
u
.
°rög
; *c; c++) {

2917 i‡(*
c
 == ' ' || *c == '-' || *c == '_' ||

2918 (*
c
 >= '0' && *c <= '9') ||

2919 (*
c
 >= 'a' && *c <= 'z') ||

2920 (*
c
 >= 'A' && *c <= 'Z'))

2922 *
c
 = '_';

2925 
tmp
->
u
.
°rög
 = 
NULL
;

2927 *
c⁄fig
 = 
tmp
;

2929 
	}
}

2948 
	$¢d_c⁄fig_imake_poöãr
(
¢d_c⁄fig_t
 **
c⁄fig
, c⁄° *
id
, c⁄° *
vÆue
)

2950 
îr
;

2952 
îr
 = 
	`¢d_c⁄fig_make
(
c⁄fig
, 
id
, 
SND_CONFIG_TYPE_POINTER
);

2953 i‡(
îr
 < 0)

2954  
îr
;

2955 (*
c⁄fig
)->
u
.
±r
 = 
vÆue
;

2957 
	}
}

2973 
	$¢d_c⁄fig_£t_öãgî
(
¢d_c⁄fig_t
 *
c⁄fig
, 
vÆue
)

2975 
	`as£π
(
c⁄fig
);

2976 i‡(
c⁄fig
->
ty≥
 !
SND_CONFIG_TYPE_INTEGER
)

2977  -
EINVAL
;

2978 
c⁄fig
->
u
.
öãgî
 = 
vÆue
;

2980 
	}
}

2996 
	$¢d_c⁄fig_£t_öãgî64
(
¢d_c⁄fig_t
 *
c⁄fig
, 
vÆue
)

2998 
	`as£π
(
c⁄fig
);

2999 i‡(
c⁄fig
->
ty≥
 !
SND_CONFIG_TYPE_INTEGER64
)

3000  -
EINVAL
;

3001 
c⁄fig
->
u
.
öãgî64
 = 
vÆue
;

3003 
	}
}

3016 
	$¢d_c⁄fig_£t_ªÆ
(
¢d_c⁄fig_t
 *
c⁄fig
, 
vÆue
)

3018 
	`as£π
(
c⁄fig
);

3019 i‡(
c⁄fig
->
ty≥
 !
SND_CONFIG_TYPE_REAL
)

3020  -
EINVAL
;

3021 
c⁄fig
->
u
.
ªÆ
 = 
vÆue
;

3023 
	}
}

3042 
	$¢d_c⁄fig_£t_°rög
(
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° *
vÆue
)

3044 *
√w_°rög
;

3045 
	`as£π
(
c⁄fig
);

3046 i‡(
c⁄fig
->
ty≥
 !
SND_CONFIG_TYPE_STRING
)

3047  -
EINVAL
;

3048 i‡(
vÆue
) {

3049 
√w_°rög
 = 
	`°rdup
(
vÆue
);

3050 i‡(!
√w_°rög
)

3051  -
ENOMEM
;

3053 
√w_°rög
 = 
NULL
;

3055 
	`‰ì
(
c⁄fig
->
u
.
°rög
);

3056 
c⁄fig
->
u
.
°rög
 = 
√w_°rög
;

3058 
	}
}

3073 
	$¢d_c⁄fig_£t_poöãr
(
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° *
vÆue
)

3075 
	`as£π
(
c⁄fig
);

3076 i‡(
c⁄fig
->
ty≥
 !
SND_CONFIG_TYPE_POINTER
)

3077  -
EINVAL
;

3078 
c⁄fig
->
u
.
±r
 = 
vÆue
;

3080 
	}
}

3107 
	$¢d_c⁄fig_£t_ascii
(
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° *
ascii
)

3109 
	`as£π
(
c⁄fig
 && 
ascii
);

3110 
c⁄fig
->
ty≥
) {

3111 
SND_CONFIG_TYPE_INTEGER
:

3113 
i
;

3114 
îr
 = 
	`ß„_°πﬁ
(
ascii
, &
i
);

3115 i‡(
îr
 < 0)

3116  
îr
;

3117 
c⁄fig
->
u
.
öãgî
 = 
i
;

3120 
SND_CONFIG_TYPE_INTEGER64
:

3122 
i
;

3123 
îr
 = 
	`ß„_°πﬁl
(
ascii
, &
i
);

3124 i‡(
îr
 < 0)

3125  
îr
;

3126 
c⁄fig
->
u
.
öãgî64
 = 
i
;

3129 
SND_CONFIG_TYPE_REAL
:

3131 
d
;

3132 
îr
 = 
	`ß„_°πod
(
ascii
, &
d
);

3133 i‡(
îr
 < 0)

3134  
îr
;

3135 
c⁄fig
->
u
.
ªÆ
 = 
d
;

3138 
SND_CONFIG_TYPE_STRING
:

3140 *
±r
 = 
	`°rdup
(
ascii
);

3141 i‡(
±r
 =
NULL
)

3142  -
ENOMEM
;

3143 
	`‰ì
(
c⁄fig
->
u
.
°rög
);

3144 
c⁄fig
->
u
.
°rög
 = 
±r
;

3148  -
EINVAL
;

3151 
	}
}

3167 
	$¢d_c⁄fig_gë_öãgî
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, *
±r
)

3169 
	`as£π
(
c⁄fig
 && 
±r
);

3170 i‡(
c⁄fig
->
ty≥
 !
SND_CONFIG_TYPE_INTEGER
)

3171  -
EINVAL
;

3172 *
±r
 = 
c⁄fig
->
u
.
öãgî
;

3174 
	}
}

3190 
	$¢d_c⁄fig_gë_öãgî64
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, *
±r
)

3192 
	`as£π
(
c⁄fig
 && 
±r
);

3193 i‡(
c⁄fig
->
ty≥
 !
SND_CONFIG_TYPE_INTEGER64
)

3194  -
EINVAL
;

3195 *
±r
 = 
c⁄fig
->
u
.
öãgî64
;

3197 
	}
}

3210 
	$¢d_c⁄fig_gë_ªÆ
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, *
±r
)

3212 
	`as£π
(
c⁄fig
 && 
±r
);

3213 i‡(
c⁄fig
->
ty≥
 !
SND_CONFIG_TYPE_REAL
)

3214  -
EINVAL
;

3215 *
±r
 = 
c⁄fig
->
u
.
ªÆ
;

3217 
	}
}

3233 
	$¢d_c⁄fig_gë_úól
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, *
±r
)

3235 
	`as£π
(
c⁄fig
 && 
±r
);

3236 i‡(
c⁄fig
->
ty≥
 =
SND_CONFIG_TYPE_REAL
)

3237 *
±r
 = 
c⁄fig
->
u
.
ªÆ
;

3238 i‡(
c⁄fig
->
ty≥
 =
SND_CONFIG_TYPE_INTEGER
)

3239 *
±r
 = 
c⁄fig
->
u
.
öãgî
;

3240 i‡(
c⁄fig
->
ty≥
 =
SND_CONFIG_TYPE_INTEGER64
)

3241 *
±r
 = 
c⁄fig
->
u
.
öãgî64
;

3243  -
EINVAL
;

3245 
	}
}

3268 
	$¢d_c⁄fig_gë_°rög
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° **
±r
)

3270 
	`as£π
(
c⁄fig
 && 
±r
);

3271 i‡(
c⁄fig
->
ty≥
 !
SND_CONFIG_TYPE_STRING
)

3272  -
EINVAL
;

3273 *
±r
 = 
c⁄fig
->
u
.
°rög
;

3275 
	}
}

3289 
	$¢d_c⁄fig_gë_poöãr
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° **
±r
)

3291 
	`as£π
(
c⁄fig
 && 
±r
);

3292 i‡(
c⁄fig
->
ty≥
 !
SND_CONFIG_TYPE_POINTER
)

3293  -
EINVAL
;

3294 *
±r
 = 
c⁄fig
->
u
.ptr;

3296 
	}
}

3325 
	$¢d_c⁄fig_gë_ascii
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, **
ascii
)

3327 
	`as£π
(
c⁄fig
 && 
ascii
);

3328 
c⁄fig
->
ty≥
) {

3329 
SND_CONFIG_TYPE_INTEGER
:

3331 
ªs
[12];

3332 
îr
;

3333 
îr
 = 
	`¢¥ötf
(
ªs
, ‘es), "%li", 
c⁄fig
->
u
.
öãgî
);

3334 i‡(
îr
 < 0 ||Éº =(
ªs
)) {

3335 
	`as£π
(0);

3336  -
ENOMEM
;

3338 *
ascii
 = 
	`°rdup
(
ªs
);

3341 
SND_CONFIG_TYPE_INTEGER64
:

3343 
ªs
[32];

3344 
îr
;

3345 
îr
 = 
	`¢¥ötf
(
ªs
, ‘es), "%Œi", 
c⁄fig
->
u
.
öãgî64
);

3346 i‡(
îr
 < 0 ||Éº =(
ªs
)) {

3347 
	`as£π
(0);

3348  -
ENOMEM
;

3350 *
ascii
 = 
	`°rdup
(
ªs
);

3353 
SND_CONFIG_TYPE_REAL
:

3355 
ªs
[32];

3356 
îr
;

3357 
îr
 = 
	`¢¥ötf
(
ªs
, ‘es), "%-16g", 
c⁄fig
->
u
.
ªÆ
);

3358 i‡(
îr
 < 0 ||Éº =(
ªs
)) {

3359 
	`as£π
(0);

3360  -
ENOMEM
;

3362 i‡(
ªs
[0]) {

3363 *
±r
;

3364 
±r
 = 
ªs
 + 
	`°æí
(res) - 1;

3365 
±r
 !
ªs
 && *ptr == ' ')

3366 
±r
--;

3367 i‡(*
±r
 != ' ')

3368 
±r
++;

3369 *
±r
 = '\0';

3371 *
ascii
 = 
	`°rdup
(
ªs
);

3374 
SND_CONFIG_TYPE_STRING
:

3375 i‡(
c⁄fig
->
u
.
°rög
)

3376 *
ascii
 = 
	`°rdup
(
c⁄fig
->
u
.
°rög
);

3378 *
ascii
 = 
NULL
;

3383  -
EINVAL
;

3385 i‡(*
ascii
 =
NULL
)

3386  -
ENOMEM
;

3388 
	}
}

3399 
	$¢d_c⁄fig_ã°_id
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° *
id
)

3401 
	`as£π
(
c⁄fig
 && 
id
);

3402 i‡(
c⁄fig
->
id
)

3403  
	`°rcmp
(
c⁄fig
->
id
, id);

3406 
	}
}

3426 
	$¢d_c⁄fig_ßve
(
¢d_c⁄fig_t
 *
c⁄fig
, 
¢d_ouçut_t
 *
out
)

3428 
	`as£π
(
c⁄fig
 && 
out
);

3429 i‡(
c⁄fig
->
ty≥
 =
SND_CONFIG_TYPE_COMPOUND
) {

3430 
¨øy
 = 
	`¢d_c⁄fig_is_¨øy
(
c⁄fig
);

3431  
	`_¢d_c⁄fig_ßve_chûdªn
(
c⁄fig
, 
out
, 0, 0, 
¨øy
);

3433  
	`_¢d_c⁄fig_ßve_node_vÆue
(
c⁄fig
, 
out
, 0);

3435 
	}
}

3441 #i‚de‡
DOC_HIDDEN


3443 
	#SND_CONFIG_SEARCH
(
c⁄fig
, 
key
, 
ªsu…
, 
exåa_code
) \

3445 
¢d_c⁄fig_t
 *
n
; \

3446 
îr
; \

3447 c⁄° *
p
; \

3448 
	`as£π
(
c⁄fig
 && 
key
); \

3450 i‡(
c⁄fig
->
ty≥
 !
SND_CONFIG_TYPE_COMPOUND
) \

3451  -
ENOENT
; \

3452 { 
exåa_code
 ; } \

3453 
p
 = 
	`°rchr
(
key
, '.'); \

3454 i‡(
p
) { \

3455 
îr
 = 
	`_¢d_c⁄fig_£¨ch
(
c⁄fig
, 
key
, 
p
 - key, &
n
); \

3456 i‡(
îr
 < 0) \

3457  
îr
; \

3458 
c⁄fig
 = 
n
; \

3459 
key
 = 
p
 + 1; \

3461  
	`_¢d_c⁄fig_£¨ch
(
c⁄fig
, 
key
, -1, 
ªsu…
); \

3463 }

	)

3465 
	#SND_CONFIG_SEARCHA
(
roŸ
, 
c⁄fig
, 
key
, 
ªsu…
, 
f˙
, 
exåa_code
) \

3467 
¢d_c⁄fig_t
 *
n
; \

3468 
îr
; \

3469 c⁄° *
p
; \

3470 
	`as£π
(
c⁄fig
 && 
key
); \

3472 i‡(
c⁄fig
->
ty≥
 !
SND_CONFIG_TYPE_COMPOUND
) { \

3473 i‡(
	`¢d_c⁄fig_gë_°rög
(
c⁄fig
, &
p
) < 0) \

3474  -
ENOENT
; \

3475 
îr
 = 
	`f˙
(
roŸ
,ÑoŸ, 
p
, &
c⁄fig
); \

3476 i‡(
îr
 < 0) \

3477  
îr
; \

3479 { 
exåa_code
 ; } \

3480 
p
 = 
	`°rchr
(
key
, '.'); \

3481 i‡(
p
) { \

3482 
îr
 = 
	`_¢d_c⁄fig_£¨ch
(
c⁄fig
, 
key
, 
p
 - key, &
n
); \

3483 i‡(
îr
 < 0) \

3484  
îr
; \

3485 
c⁄fig
 = 
n
; \

3486 
key
 = 
p
 + 1; \

3488  
	`_¢d_c⁄fig_£¨ch
(
c⁄fig
, 
key
, -1, 
ªsu…
); \

3490 }

	)

3492 
	#SND_CONFIG_SEARCHV
(
c⁄fig
, 
ªsu…
, 
f˙
) \

3494 
¢d_c⁄fig_t
 *
n
; \

3495 
va_li°
 
¨g
; \

3496 
	`as£π
(
c⁄fig
); \

3497 
	`va_°¨t
(
¨g
, 
ªsu…
); \

3499 c⁄° *
k
 = 
	`va_¨g
(
¨g
, const *); \

3500 
îr
; \

3501 i‡(!
k
) \

3503 
îr
 = 
	`f˙
(
c⁄fig
, 
k
, &
n
); \

3504 i‡(
îr
 < 0) { \

3505 
	`va_íd
(
¨g
); \

3506  
îr
; \

3508 
c⁄fig
 = 
n
; \

3510 
	`va_íd
(
¨g
); \

3511 i‡(
ªsu…
) \

3512 *
ªsu…
 = 
n
; \

3514 }

	)

3516 
	#SND_CONFIG_SEARCHVA
(
roŸ
, 
c⁄fig
, 
ªsu…
, 
f˙
) \

3518 
¢d_c⁄fig_t
 *
n
; \

3519 
va_li°
 
¨g
; \

3520 
	`as£π
(
c⁄fig
); \

3521 
	`va_°¨t
(
¨g
, 
ªsu…
); \

3523 c⁄° *
k
 = 
	`va_¨g
(
¨g
, const *); \

3524 
îr
; \

3525 i‡(!
k
) \

3527 
îr
 = 
	`f˙
(
roŸ
, 
c⁄fig
, 
k
, &
n
); \

3528 i‡(
îr
 < 0) { \

3529 
	`va_íd
(
¨g
); \

3530  
îr
; \

3532 
c⁄fig
 = 
n
; \

3534 
	`va_íd
(
¨g
); \

3535 i‡(
ªsu…
) \

3536 *
ªsu…
 = 
n
; \

3538 }

	)

3540 
	#SND_CONFIG_SEARCH_ALIAS
(
c⁄fig
, 
ba£
, 
key
, 
ªsu…
, 
f˙1
, 
f˙2
) \

3542 
¢d_c⁄fig_t
 *
ªs
 = 
NULL
; \

3543 *
ﬁd_key
; \

3544 
îr
, 
fú°
 = 1, 
maxlo›
 = 1000; \

3545 
	`as£π
(
c⁄fig
 && 
key
); \

3547 
ﬁd_key
 = 
	`°rdup
(
key
); \

3548 i‡(
ﬁd_key
 =
NULL
) { \

3549 
îr
 = -
ENOMEM
; \

3550 
ªs
 = 
NULL
; \

3553 
îr
 = 
fú°
 && 
ba£
 ? -
EIO
 : 
	`f˙1
(
c⁄fig
, c⁄fig, 
key
, &
ªs
); \

3554 i‡(
îr
 < 0) { \

3555 i‡(!
ba£
) \

3557 
îr
 = 
	`f˙2
(
c⁄fig
, c⁄fig, &
ªs
, 
ba£
, 
key
, 
NULL
); \

3558 i‡(
îr
 < 0) \

3561 i‡(
	`¢d_c⁄fig_gë_°rög
(
ªs
, &
key
) < 0) \

3563 
	`as£π
(
key
); \

3564 i‡(!
fú°
 && (
	`°rcmp
(
key
, 
ﬁd_key
Ë=0 || 
maxlo›
 <= 0)) { \

3565 i‡(
maxlo›
 == 0) \

3566 
	`SNDERR
("maximumÜoop countÑeached (circular configuration?)"); \

3568 
	`SNDERR
("key %†ª„r†tÿô£lf", 
key
); \

3569 
îr
 = -
EINVAL
; \

3570 
ªs
 = 
NULL
; \

3573 
	`‰ì
(
ﬁd_key
); \

3574 
fú°
 = 0; \

3575 
maxlo›
--; \

3577 
	`‰ì
(
ﬁd_key
); \

3578 i‡(!
ªs
) \

3579  
îr
; \

3580 i‡(
ªsu…
) \

3581 *
ªsu…
 = 
ªs
; \

3583 }

	)

3627 
	$¢d_c⁄fig_£¨ch
(
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° *
key
, snd_c⁄fig_à**
ªsu…
)

3629 
	`SND_CONFIG_SEARCH
(
c⁄fig
, 
key
, 
ªsu…
, );

3630 
	}
}

3682 
	$¢d_c⁄fig_£¨cha
(
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄fig
, c⁄° *
key
, snd_c⁄fig_à**
ªsu…
)

3684 
	`SND_CONFIG_SEARCHA
(
roŸ
, 
c⁄fig
, 
key
, 
ªsu…
, 
¢d_c⁄fig_£¨cha
, );

3685 
	}
}

3718 
	$¢d_c⁄fig_£¨chv
(
¢d_c⁄fig_t
 *
c⁄fig
, snd_c⁄fig_à**
ªsu…
, ...)

3720 
	`SND_CONFIG_SEARCHV
(
c⁄fig
, 
ªsu…
, 
¢d_c⁄fig_£¨ch
);

3721 
	}
}

3747 
	$¢d_c⁄fig_£¨chva
(
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄fig
, snd_c⁄fig_à**
ªsu…
, ...)

3749 
	`SND_CONFIG_SEARCHVA
(
roŸ
, 
c⁄fig
, 
ªsu…
, 
¢d_c⁄fig_£¨cha
);

3750 
	}
}

3778 
	$¢d_c⁄fig_£¨ch_Æüs
(
¢d_c⁄fig_t
 *
c⁄fig
,

3779 c⁄° *
ba£
, c⁄° *
key
,

3780 
¢d_c⁄fig_t
 **
ªsu…
)

3782 
	`SND_CONFIG_SEARCH_ALIAS
(
c⁄fig
, 
ba£
, 
key
, 
ªsu…
,

3783 
¢d_c⁄fig_£¨cha
, 
¢d_c⁄fig_£¨chva
);

3784 
	}
}

3786 
¢d_c⁄fig_hooks
(
¢d_c⁄fig_t
 *
c⁄fig
, snd_c⁄fig_à*
¥iv©e_d©a
);

3810 
	$¢d_c⁄fig_£¨ch_hooks
(
¢d_c⁄fig_t
 *
c⁄fig
, c⁄° *
key
, snd_c⁄fig_à**
ªsu…
)

3812 
	`SND_CONFIG_SEARCH
(
c⁄fig
, 
key
, 
ªsu…
, \

3813 
îr
 = 
	`¢d_c⁄fig_hooks
(
c⁄fig
, 
NULL
); \

3814 i‡(
îr
 < 0) \

3815  
îr
; \

3817 
	}
}

3843 
	$¢d_c⁄fig_£¨cha_hooks
(
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄fig
, c⁄° *
key
, snd_c⁄fig_à**
ªsu…
)

3845 
	`SND_CONFIG_SEARCHA
(
roŸ
, 
c⁄fig
, 
key
, 
ªsu…
,

3846 
¢d_c⁄fig_£¨cha_hooks
,

3847 
îr
 = 
	`¢d_c⁄fig_hooks
(
c⁄fig
, 
NULL
); \

3848 i‡(
îr
 < 0) \

3849  
îr
; \

3851 
	}
}

3879 
	$¢d_c⁄fig_£¨chva_hooks
(
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄fig
,

3880 
¢d_c⁄fig_t
 **
ªsu…
, ...)

3882 
	`SND_CONFIG_SEARCHVA
(
roŸ
, 
c⁄fig
, 
ªsu…
, 
¢d_c⁄fig_£¨cha_hooks
);

3883 
	}
}

3908 
	$¢d_c⁄fig_£¨ch_Æüs_hooks
(
¢d_c⁄fig_t
 *
c⁄fig
,

3909 c⁄° *
ba£
, c⁄° *
key
,

3910 
¢d_c⁄fig_t
 **
ªsu…
)

3912 
	`SND_CONFIG_SEARCH_ALIAS
(
c⁄fig
, 
ba£
, 
key
, 
ªsu…
,

3913 
¢d_c⁄fig_£¨cha_hooks
,

3914 
¢d_c⁄fig_£¨chva_hooks
);

3915 
	}
}

3918 
	#ALSA_CONFIG_PATH_VAR
 "ALSA_CONFIG_PATH"

	)

3942 
¢d_c⁄fig_t
 *
	g¢d_c⁄fig
 = 
NULL
;

3944 #i‚de‡
DOC_HIDDEN


3945 
	sföfo
 {

3946 *
	m«me
;

3947 
dev_t
 
	mdev
;

3948 
öo64_t
 
	möo
;

3949 
time_t
 
	mmtime
;

3952 
	s_¢d_c⁄fig_upd©e
 {

3953 
	mcou¡
;

3954 
föfo
 *
	mföfo
;

3958 
¢d_c⁄fig_upd©e_t
 *
	g¢d_c⁄fig_globÆ_upd©e
 = 
NULL
;

3960 
	$¢d_c⁄fig_hooks_ˇŒ
(
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄fig
, snd_c⁄fig_à*
¥iv©e_d©a
)

3962 *
h
 = 
NULL
;

3963 
¢d_c⁄fig_t
 *
c
, *
func_c⁄f
 = 
NULL
;

3964 *
buf
 = 
NULL
, 
îrbuf
[256];

3965 c⁄° *
lib
 = 
NULL
, *
func_«me
 = NULL;

3966 c⁄° *
°r
;

3967 (*
func
)(
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄fig
, snd_c⁄fig_à**
d°
, snd_c⁄fig_à*
¥iv©e_d©a
Ë
NULL
;

3968 
îr
;

3970 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, "func", &
c
);

3971 i‡(
îr
 < 0) {

3972 
	`SNDERR
("Field func is missing");

3973  
îr
;

3975 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
c
, &
°r
);

3976 i‡(
îr
 < 0) {

3977 
	`SNDERR
("InvalidÅype for field func");

3978  
îr
;

3980 
	`as£π
(
°r
);

3981 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "hook_func", 
°r
, &
func_c⁄f
);

3982 i‡(
îr
 >= 0) {

3983 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

3984 i‡(
	`¢d_c⁄fig_gë_ty≥
(
func_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

3985 
	`SNDERR
("InvÆidÅy≥ f‹ fun¯%†deföôi⁄", 
°r
);

3986 
îr
 = -
EINVAL
;

3987 
_îr
;

3989 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
func_c⁄f
) {

3990 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

3991 c⁄° *
id
 = 
n
->id;

3992 i‡(
	`°rcmp
(
id
, "comment") == 0)

3994 i‡(
	`°rcmp
(
id
, "lib") == 0) {

3995 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
lib
);

3996 i‡(
îr
 < 0) {

3997 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

3998 
_îr
;

4002 i‡(
	`°rcmp
(
id
, "func") == 0) {

4003 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
func_«me
);

4004 i‡(
îr
 < 0) {

4005 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

4006 
_îr
;

4010 
	`SNDERR
("Unknow¿fõld %s", 
id
);

4013 i‡(!
func_«me
) {

4014 
Àn
 = 16 + 
	`°æí
(
°r
) + 1;

4015 
buf
 = 
	`mÆloc
(
Àn
);

4016 i‡(! 
buf
) {

4017 
îr
 = -
ENOMEM
;

4018 
_îr
;

4020 
	`¢¥ötf
(
buf
, 
Àn
, "¢d_c⁄fig_hook_%s", 
°r
);

4021 
buf
[
Àn
-1] = '\0';

4022 
func_«me
 = 
buf
;

4024 
h
 = 
	`INTERNAL
(
¢d_dl›í
)(
lib
, 
RTLD_NOW
, 
îrbuf
, (errbuf));

4025 
func
 = 
h
 ? 
	`¢d_dlsym
(h, 
func_«me
, 
	`SND_DLSYM_VERSION
(
SND_CONFIG_DLSYM_VERSION_HOOK
)Ë: 
NULL
;

4026 
îr
 = 0;

4027 i‡(!
h
) {

4028 
	`SNDERR
("C™nŸ o≥¿sh¨edÜibøry %†(%s)", 
lib
, 
îrbuf
);

4029 
îr
 = -
ENOENT
;

4030 } i‡(!
func
) {

4031 
	`SNDERR
("symbﬁ %†i†nŸ deföed insidê%s", 
func_«me
, 
lib
);

4032 
	`¢d_dl˛o£
(
h
);

4033 
îr
 = -
ENXIO
;

4035 
_îr
:

4036 i‡(
func_c⁄f
)

4037 
	`¢d_c⁄fig_dñëe
(
func_c⁄f
);

4038 i‡(
îr
 >= 0) {

4039 
¢d_c⁄fig_t
 *
ƒoŸ
;

4040 
îr
 = 
	`func
(
roŸ
, 
c⁄fig
, &
ƒoŸ
, 
¥iv©e_d©a
);

4041 i‡(
îr
 < 0)

4042 
	`SNDERR
("fun˘i⁄ %†ªtu∫edÉº‹: %s", 
func_«me
, 
	`¢d_°ªº‹
(
îr
));

4043 
	`¢d_dl˛o£
(
h
);

4044 i‡(
îr
 >0 && 
ƒoŸ
)

4045 
îr
 = 
	`¢d_c⁄fig_sub°ôuã
(
roŸ
, 
ƒoŸ
);

4047 
	`‰ì
(
buf
);

4048 i‡(
îr
 < 0)

4049  
îr
;

4051 
	}
}

4053 
	$¢d_c⁄fig_hooks
(
¢d_c⁄fig_t
 *
c⁄fig
, snd_c⁄fig_à*
¥iv©e_d©a
)

4055 
¢d_c⁄fig_t
 *
n
;

4056 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

4057 
îr
, 
hô
, 
idx
 = 0;

4059 i‡((
îr
 = 
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, "@hooks", &
n
)) < 0)

4061 
	`¢d_c⁄fig_lock
();

4062 
	`¢d_c⁄fig_ªmove
(
n
);

4064 
hô
 = 0;

4065 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
n
) {

4066 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

4067 c⁄° *
id
 = 
n
->id;

4068 
i
;

4069 
îr
 = 
	`ß„_°πﬁ
(
id
, &
i
);

4070 i‡(
îr
 < 0) {

4071 
	`SNDERR
("id o‡fõld %†i†nŸánd i¡egî", 
id
);

4072 
îr
 = -
EINVAL
;

4073 
_îr
;

4075 i‡(
i
 =
idx
) {

4076 
îr
 = 
	`¢d_c⁄fig_hooks_ˇŒ
(
c⁄fig
, 
n
, 
¥iv©e_d©a
);

4077 i‡(
îr
 < 0)

4078 
_îr
;

4079 
idx
++;

4080 
hô
 = 1;

4083 } 
hô
);

4084 
îr
 = 0;

4085 
_îr
:

4086 
	`¢d_c⁄fig_dñëe
(
n
);

4087 
	`¢d_c⁄fig_u∆ock
();

4088  
îr
;

4089 
	}
}

4091 
	$c⁄fig_fûíame_fûãr
(c⁄° 
dúít64
 *
dúít
)

4093 
size_t
 
Êí
;

4095 i‡(
dúít
 =
NULL
)

4097 i‡(
dúít
->
d_ty≥
 =
DT_DIR
)

4100 
Êí
 = 
	`°æí
(
dúít
->
d_«me
);

4101 i‡(
Êí
 <= 5)

4104 i‡(
	`°∫cmp
(&
dúít
->
d_«me
[
Êí
-5], ".conf", 5) == 0)

4108 
	}
}

4110 
	$c⁄fig_fûe_›í
(
¢d_c⁄fig_t
 *
roŸ
, c⁄° *
fûíame
)

4112 
¢d_öput_t
 *
ö
;

4113 
îr
;

4115 
îr
 = 
	`¢d_öput_°dio_›í
(&
ö
, 
fûíame
, "r");

4116 i‡(
îr
 >= 0) {

4117 
îr
 = 
	`¢d_c⁄fig_lﬂd
(
roŸ
, 
ö
);

4118 
	`¢d_öput_˛o£
(
ö
);

4119 i‡(
îr
 < 0)

4120 
	`SNDERR
("%†may bêﬁd o∏c‹ru±ed: c⁄sidîÅÿªmovê‹ fix it", 
fûíame
);

4122 
	`SNDERR
("ˇ¬Ÿác˚s†fûê%s", 
fûíame
);

4124  
îr
;

4125 
	}
}

4127 
	$c⁄fig_fûe_lﬂd
(
¢d_c⁄fig_t
 *
roŸ
, c⁄° *
‚
, 
îr‹s
)

4129 
°©64
 
°
;

4130 
dúít64
 **
«mñi°
;

4131 
îr
, 
n
;

4133 i‡(!
îr‹s
 && 
	`ac˚ss
(
‚
, 
R_OK
) < 0)

4135 i‡(
	`°©64
(
‚
, &
°
) < 0) {

4136 
	`SNDERR
("ˇ¬Ÿ sèàfûe/dúe˘‹y %s", 
‚
);

4139 i‡(!
	`S_ISDIR
(
°
.
°_mode
))

4140  
	`c⁄fig_fûe_›í
(
roŸ
, 
‚
);

4141 #i‚de‡
DOC_HIDDEN


4142 #i‡
	`deföed
(
_GNU_SOURCE
Ë&& !deföed(
__NëBSD__
Ë&& !deföed(
__FªeBSD__
Ë&& !deföed(
__O≥nBSD__
Ë&& !deföed(
__Døg⁄Fly__
Ë&& !deföed(
__sun
Ë&& !deföed(
__ANDROID__
)

4143 
	#SORTFUNC
 
vîsi⁄s‹t64


	)

4145 
	#SORTFUNC
 
Æphas‹t64


	)

4148 
n
 = 
	`sˇndú64
(
‚
, &
«mñi°
, 
c⁄fig_fûíame_fûãr
, 
SORTFUNC
);

4149 i‡(
n
 > 0) {

4150 
j
;

4151 
îr
 = 0;

4152 
j
 = 0; j < 
n
; ++j) {

4153 i‡(
îr
 >= 0) {

4154 
¶
 = 
	`°æí
(
‚
Ë+ såÀn(
«mñi°
[
j
]->
d_«me
) + 2;

4155 *
fûíame
 = 
	`mÆloc
(
¶
);

4156 
	`¢¥ötf
(
fûíame
, 
¶
, "%s/%s", 
‚
, 
«mñi°
[
j
]->
d_«me
);

4157 
fûíame
[
¶
-1] = '\0';

4159 
îr
 = 
	`c⁄fig_fûe_›í
(
roŸ
, 
fûíame
);

4160 
	`‰ì
(
fûíame
);

4162 
	`‰ì
(
«mñi°
[
j
]);

4164 
	`‰ì
(
«mñi°
);

4165 i‡(
îr
 < 0)

4166  
îr
;

4169 
	}
}

4171 
	$c⁄fig_fûe_lﬂd_u£r
(
¢d_c⁄fig_t
 *
roŸ
, c⁄° *
‚
, 
îr‹s
)

4173 *
‚2
;

4174 
îr
;

4176 
îr
 = 
	`¢d_u£r_fûe
(
‚
, &
‚2
);

4177 i‡(
îr
 < 0)

4178  
	`c⁄fig_fûe_lﬂd
(
roŸ
, 
‚
, 
îr‹s
);

4179 
îr
 = 
	`c⁄fig_fûe_lﬂd
(
roŸ
, 
‚2
, 
îr‹s
);

4180 
	`‰ì
(
‚2
);

4181  
îr
;

4182 
	}
}

4184 
	$c⁄fig_fûe_lﬂd_u£r_Æl
(
¢d_c⁄fig_t
 *
_roŸ
, snd_c⁄fig_à*
_fûe
, 
îr‹s
)

4186 
¢d_c⁄fig_t
 *
fûe
 = 
_fûe
, *
roŸ
 = 
_roŸ
, *
n
;

4187 *
«me
, *
«me2
, *
ªmaö
, *
∫ame
 = 
NULL
;

4188 
îr
;

4190 i‡(
	`¢d_c⁄fig_gë_ty≥
(
_fûe
Ë=
SND_CONFIG_TYPE_COMPOUND
) {

4191 i‡((
îr
 = 
	`¢d_c⁄fig_£¨ch
(
_fûe
, "fûe", &
fûe
)) < 0) {

4192 
	`SNDERR
("Field fileÇot found");

4193  
îr
;

4195 i‡((
îr
 = 
	`¢d_c⁄fig_£¨ch
(
_fûe
, "roŸ", &
roŸ
)) >= 0) {

4196 
îr
 = 
	`¢d_c⁄fig_gë_ascii
(
roŸ
, &
∫ame
);

4197 i‡(
îr
 < 0) {

4198 
	`SNDERR
("FieldÑoot is bad");

4199  
îr
;

4201 
îr
 = 
	`¢d_c⁄fig_make_compound
(&
roŸ
, 
∫ame
, 0);

4202 i‡(
îr
 < 0)

4203  
îr
;

4206 i‡((
îr
 = 
	`¢d_c⁄fig_gë_ascii
(
fûe
, &
«me
)) < 0)

4207 
_îr
;

4208 
«me2
 = 
«me
;

4209 
ªmaö
 = 
	`°r°r
(
«me
, "|||");

4211 i‡(
ªmaö
) {

4212 *
ªmaö
 = '\0';

4213 
ªmaö
 += 3;

4215 
îr
 = 
	`c⁄fig_fûe_lﬂd_u£r
(
roŸ
, 
«me2
, 
îr‹s
);

4216 i‡(
îr
 < 0)

4217 
_îr
;

4218 i‡(
îr
 == 0)

4220 i‡(!
ªmaö
)

4222 
«me2
 = 
ªmaö
;

4223 
ªmaö
 = 
	`°r°r
(remain, "|||");

4225 
_îr
:

4226 i‡(
roŸ
 !
_roŸ
) {

4227 i‡(
îr
 == 0) {

4228 i‡(
	`¢d_c⁄fig_gë_ty≥
(
roŸ
Ë=
SND_CONFIG_TYPE_COMPOUND
) {

4229 i‡(
	`¢d_c⁄fig_is_em±y
(
roŸ
))

4230 
_dñ
;

4232 
îr
 = 
	`¢d_c⁄fig_make_∑th
(&
n
, 
_roŸ
, 
∫ame
, 0, 1);

4233 i‡(
îr
 < 0)

4234 
_dñ
;

4235 
îr
 = 
	`¢d_c⁄fig_sub°ôuã
(
n
, 
roŸ
);

4236 i‡(
îr
 == 0)

4237 
_fö
;

4239 
_dñ
:

4240 
	`¢d_c⁄fig_dñëe
(
roŸ
);

4242 
_fö
:

4243 
	`‰ì
(
«me
);

4244 
	`‰ì
(
∫ame
);

4245  
îr
;

4246 
	}
}

4260 
	$¢d_c⁄fig_hook_lﬂd
(
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄fig
, snd_c⁄fig_à**
d°
, snd_c⁄fig_à*
¥iv©e_d©a
)

4262 
¢d_c⁄fig_t
 *
n
;

4263 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

4264 
îr
, 
idx
 = 0, 
îr‹s
 = 1, 
hô
;

4266 
	`as£π
(
roŸ
 && 
d°
);

4267 i‡((
îr
 = 
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, "îr‹s", &
n
)) >= 0) {

4268 
îr‹s
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

4269 i‡(
îr‹s
 < 0) {

4270 
	`SNDERR
("Invalid bool value in fieldÉrrors");

4271  
îr‹s
;

4274 i‡((
îr
 = 
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, "fûes", &
n
)) < 0) {

4275 
	`SNDERR
("UnableÅo find field files inÅheÖre-load section");

4276  -
EINVAL
;

4278 i‡((
îr
 = 
	`¢d_c⁄fig_ex∑nd
(
n
, 
roŸ
, 
NULL
, 
¥iv©e_d©a
, &n)) < 0) {

4279 
	`SNDERR
("UnableÅoÉxpand filenames inÅheÖre-load section");

4280  
îr
;

4282 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

4283 
	`SNDERR
("InvalidÅype for field filenames");

4284 
_îr
;

4287 
hô
 = 0;

4288 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
n
) {

4289 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

4290 c⁄° *
id
 = 
n
->id;

4291 
i
;

4292 
îr
 = 
	`ß„_°πﬁ
(
id
, &
i
);

4293 i‡(
îr
 < 0) {

4294 
	`SNDERR
("id o‡fõld %†i†nŸánd i¡egî", 
id
);

4295 
îr
 = -
EINVAL
;

4296 
_îr
;

4298 i‡(
i
 =
idx
) {

4299 
îr
 = 
	`c⁄fig_fûe_lﬂd_u£r_Æl
(
roŸ
, 
n
, 
îr‹s
);

4300 i‡(
îr
 < 0)

4301 
_îr
;

4302 
idx
++;

4303 
hô
 = 1;

4306 } 
hô
);

4307 *
d°
 = 
NULL
;

4308 
îr
 = 0;

4309 
_îr
:

4310 
	`¢d_c⁄fig_dñëe
(
n
);

4311  
îr
;

4312 
	}
}

4313 #i‚de‡
DOC_HIDDEN


4314 
SND_DLSYM_BUILD_VERSION
(
¢d_c⁄fig_hook_lﬂd
, 
SND_CONFIG_DLSYM_VERSION_HOOK
);

4317 #i‚de‡
DOC_HIDDEN


4318 
¢d_dëîmöe_drivî
(
ˇrd
, **
drivî
);

4321 
¢d_c⁄fig_t
 *
	$_¢d_c⁄fig_hook_¥iv©e_d©a
(
ˇrd
, c⁄° *
drivî
)

4323 
¢d_c⁄fig_t
 *
¥iv©e_d©a
, *
v
;

4324 
îr
;

4326 
îr
 = 
	`¢d_c⁄fig_make_compound
(&
¥iv©e_d©a
, 
NULL
, 0);

4327 i‡(
îr
 < 0)

4328 
__îr
;

4329 
îr
 = 
	`¢d_c⁄fig_imake_öãgî
(&
v
, "öãgî", 
ˇrd
);

4330 i‡(
îr
 < 0)

4331 
__îr
;

4332 
îr
 = 
	`¢d_c⁄fig_add
(
¥iv©e_d©a
, 
v
);

4333 i‡(
îr
 < 0) {

4334 
	`¢d_c⁄fig_dñëe
(
v
);

4335 
__îr
;

4337 
îr
 = 
	`¢d_c⁄fig_imake_°rög
(&
v
, "°rög", 
drivî
);

4338 i‡(
îr
 < 0)

4339 
__îr
;

4340 
îr
 = 
	`¢d_c⁄fig_add
(
¥iv©e_d©a
, 
v
);

4341 i‡(
îr
 < 0) {

4342 
	`¢d_c⁄fig_dñëe
(
v
);

4343 
__îr
;

4345  
¥iv©e_d©a
;

4347 
__îr
:

4348 
	`¢d_c⁄fig_dñëe
(
¥iv©e_d©a
);

4349  
NULL
;

4350 
	}
}

4352 
	$_¢d_c⁄fig_hook_èbÀ
(
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄fig
, snd_c⁄fig_à*
¥iv©e_d©a
)

4354 
¢d_c⁄fig_t
 *
n
, *
ä
;

4355 c⁄° *
id
;

4356 
îr
;

4358 i‡(
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, "èbÀ", &
n
) < 0)

4360 i‡((
îr
 = 
	`¢d_c⁄fig_ex∑nd
(
n
, 
roŸ
, 
NULL
, 
¥iv©e_d©a
, &n)) < 0) {

4361 
	`SNDERR
("UnableÅoÉxpandÅable compound");

4362  
îr
;

4364 i‡(
	`¢d_c⁄fig_£¨ch
(
n
, "id", &
ä
) < 0 ||

4365 
	`¢d_c⁄fig_gë_°rög
(
ä
, &
id
) < 0) {

4366 
	`SNDERR
("UnableÅo find fieldÅable.id");

4367 
	`¢d_c⁄fig_dñëe
(
n
);

4368  -
EINVAL
;

4370 i‡(
	`¢d_c⁄fig_£¨ch
(
n
, "vÆue", &
ä
) < 0 ||

4371 
	`¢d_c⁄fig_gë_ty≥
(
ä
Ë!
SND_CONFIG_TYPE_STRING
) {

4372 
	`SNDERR
("UnableÅo find fieldÅable.value");

4373 
	`¢d_c⁄fig_dñëe
(
n
);

4374  -
EINVAL
;

4376 
	`¢d_c⁄fig_ªmove
(
ä
);

4377 i‡((
îr
 = 
	`¢d_c⁄fig_£t_id
(
ä
, 
id
)) < 0) {

4378 
	`¢d_c⁄fig_dñëe
(
ä
);

4379 
	`¢d_c⁄fig_dñëe
(
n
);

4380  
îr
;

4382 
	`¢d_c⁄fig_dñëe
(
n
);

4383 i‡((
îr
 = 
	`¢d_c⁄fig_add
(
roŸ
, 
ä
)) < 0) {

4384 
	`¢d_c⁄fig_dñëe
(
ä
);

4385  
îr
;

4388 
	}
}

4405 
	$¢d_c⁄fig_hook_lﬂd_f‹_Æl_ˇrds
(
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄fig
, snd_c⁄fig_à**
d°
, snd_c⁄fig_à*
¥iv©e_d©a
 
ATTRIBUTE_UNUSED
)

4407 
ˇrd
 = -1, 
îr
;

4408 
¢d_c⁄fig_t
 *
lﬂded
;

4410 
îr
 = 
	`¢d_c⁄fig_t›
(&
lﬂded
);

4411 i‡(
îr
 < 0)

4412  
îr
;

4414 
îr
 = 
	`¢d_ˇrd_√xt
(&
ˇrd
);

4415 i‡(
îr
 < 0)

4416 
__fö_îr
;

4417 i‡(
ˇrd
 >= 0) {

4418 
¢d_c⁄fig_t
 *
n
, *
m
, *
¥iv©e_d©a
 = 
NULL
;

4419 c⁄° *
drivî
;

4420 *
fdrivî
 = 
NULL
;

4421 
boﬁ
 
lﬂd
;

4422 
îr
 = 
	`¢d_dëîmöe_drivî
(
ˇrd
, &
fdrivî
);

4423 i‡(
îr
 < 0)

4424 
__fö_îr
;

4425 i‡(
	`¢d_c⁄fig_£¨ch
(
roŸ
, 
fdrivî
, &
n
) >= 0) {

4426 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
drivî
) < 0) {

4427 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë=
SND_CONFIG_TYPE_COMPOUND
) {

4428 
	`¢d_c⁄fig_gë_id
(
n
, &
drivî
);

4429 
__°d
;

4431 
__îr
;

4434 *
s
 = 
	`°rchr
(
drivî
, '.');

4435 i‡(
s
 =
NULL
)

4437 
drivî
 = 
s
 + 1;

4439 i‡(
	`¢d_c⁄fig_£¨ch
(
roŸ
, 
drivî
, &
n
) >= 0)

4440 
__îr
;

4442 
drivî
 = 
fdrivî
;

4444 
__°d
:

4445 
lﬂd
 = 
åue
;

4446 
îr
 = 
	`¢d_c⁄fig_imake_öãgî
(&
m
, 
drivî
, 1);

4447 i‡(
îr
 < 0)

4448 
__îr
;

4449 
îr
 = 
	`¢d_c⁄fig_add
(
lﬂded
, 
m
);

4450 i‡(
îr
 < 0) {

4451 i‡(
îr
 =-
EEXIST
) {

4452 
	`¢d_c⁄fig_dñëe
(
m
);

4453 
lﬂd
 = 
Ál£
;

4455 
__îr
;

4458 
¥iv©e_d©a
 = 
	`_¢d_c⁄fig_hook_¥iv©e_d©a
(
ˇrd
, 
drivî
);

4459 i‡(!
¥iv©e_d©a
) {

4460 
îr
 = -
ENOMEM
;

4461 
__îr
;

4463 
îr
 = 
	`_¢d_c⁄fig_hook_èbÀ
(
roŸ
, 
c⁄fig
, 
¥iv©e_d©a
);

4464 i‡(
îr
 < 0)

4465 
__îr
;

4466 i‡(
lﬂd
)

4467 
îr
 = 
	`¢d_c⁄fig_hook_lﬂd
(
roŸ
, 
c⁄fig
, &
n
, 
¥iv©e_d©a
);

4468 
__îr
:

4469 i‡(
¥iv©e_d©a
)

4470 
	`¢d_c⁄fig_dñëe
(
¥iv©e_d©a
);

4471 
	`‰ì
(
fdrivî
);

4472 i‡(
îr
 < 0)

4473 
__fö_îr
;

4475 } 
ˇrd
 >= 0);

4476 
	`¢d_c⁄fig_dñëe
(
lﬂded
);

4477 *
d°
 = 
NULL
;

4479 
__fö_îr
:

4480 
	`¢d_c⁄fig_dñëe
(
lﬂded
);

4481  
îr
;

4482 
	}
}

4483 #i‚de‡
DOC_HIDDEN


4484 
SND_DLSYM_BUILD_VERSION
(
¢d_c⁄fig_hook_lﬂd_f‹_Æl_ˇrds
, 
SND_CONFIG_DLSYM_VERSION_HOOK
);

4514 
	$¢d_c⁄fig_upd©e_r
(
¢d_c⁄fig_t
 **
_t›
, 
¢d_c⁄fig_upd©e_t
 **
_upd©e
, c⁄° *
cfgs
)

4516 
îr
;

4517 c⁄° *
c⁄figs
, *
c
;

4518 
k
;

4519 
size_t
 
l
;

4520 
¢d_c⁄fig_upd©e_t
 *
loˇl
;

4521 
¢d_c⁄fig_upd©e_t
 *
upd©e
;

4522 
¢d_c⁄fig_t
 *
t›
;

4524 
	`as£π
(
_t›
 && 
_upd©e
);

4525 
t›
 = *
_t›
;

4526 
upd©e
 = *
_upd©e
;

4527 
c⁄figs
 = 
cfgs
;

4528 i‡(!
c⁄figs
) {

4529 
c⁄figs
 = 
	`gëív
(
ALSA_CONFIG_PATH_VAR
);

4530 i‡(!
c⁄figs
 || !*configs) {

4531 c⁄° *
t›dú
 = 
	`¢d_c⁄fig_t›dú
();

4532 *
s
 = 
	`Æloˇ
(
	`°æí
(
t›dú
) +

4533 
	`°æí
("alsa.conf") + 2);

4534 
	`•rötf
(
s
, "%s/Æß.c⁄f", 
t›dú
);

4535 
c⁄figs
 = 
s
;

4538 
k
 = 0, 
c
 = 
c⁄figs
; (
l
 = 
	`°rc•n
(c, ": ")) > 0; ) {

4539 
c
 +
l
;

4540 
k
++;

4541 i‡(!*
c
)

4543 
c
++;

4545 i‡(
k
 == 0) {

4546 
loˇl
 = 
NULL
;

4547 
_ªªad
;

4549 
loˇl
 = (
¢d_c⁄fig_upd©e_t
 *)
	`ˇŒoc
(1, (snd_config_update_t));

4550 i‡(!
loˇl
)

4551  -
ENOMEM
;

4552 
loˇl
->
cou¡
 = 
k
;

4553 
loˇl
->
föfo
 = 
	`ˇŒoc
÷oˇl->
cou¡
, (finfo));

4554 i‡(!
loˇl
->
föfo
) {

4555 
	`‰ì
(
loˇl
);

4556  -
ENOMEM
;

4558 
k
 = 0, 
c
 = 
c⁄figs
; (
l
 = 
	`°rc•n
(c, ": ")) > 0; ) {

4559 
«me
[
l
 + 1];

4560 
	`mem˝y
(
«me
, 
c
, 
l
);

4561 
«me
[
l
] = 0;

4562 
îr
 = 
	`¢d_u£r_fûe
(
«me
, &
loˇl
->
föfo
[
k
].name);

4563 i‡(
îr
 < 0)

4564 
_íd
;

4565 
c
 +
l
;

4566 
k
++;

4567 i‡(!*
c
)

4569 
c
++;

4571 
k
 = 0; k < 
loˇl
->
cou¡
; ++k) {

4572 
°©64
 
°
;

4573 
föfo
 *
lf
 = &
loˇl
->föfo[
k
];

4574 i‡(
	`°©64
(
lf
->
«me
, &
°
) >= 0) {

4575 
lf
->
dev
 = 
°
.
°_dev
;

4576 
lf
->
öo
 = 
°
.
°_öo
;

4577 
lf
->
mtime
 = 
°
.
°_mtime
;

4579 
	`SNDERR
("C™nŸác˚s†fûê%s", 
lf
->
«me
);

4580 
	`‰ì
(
lf
->
«me
);

4581 
	`memmove
(&
loˇl
->
föfo
[
k
], &loˇl->föfo[k+1], (föfoË* (loˇl->
cou¡
 - k - 1));

4582 
k
--;

4583 
loˇl
->
cou¡
--;

4586 i‡(!
upd©e
)

4587 
_ªªad
;

4588 i‡(
loˇl
->
cou¡
 !
upd©e
->count)

4589 
_ªªad
;

4590 
k
 = 0; k < 
loˇl
->
cou¡
; ++k) {

4591 
föfo
 *
lf
 = &
loˇl
->föfo[
k
];

4592 
föfo
 *
uf
 = &
upd©e
->föfo[
k
];

4593 i‡(
	`°rcmp
(
lf
->
«me
, 
uf
->name) != 0 ||

4594 
lf
->
dev
 !
uf
->dev ||

4595 
lf
->
öo
 !
uf
->ino ||

4596 
lf
->
mtime
 !
uf
->mtime)

4597 
_ªªad
;

4599 
îr
 = 0;

4601 
_íd
:

4602 i‡(
îr
 < 0) {

4603 i‡(
t›
) {

4604 
	`¢d_c⁄fig_dñëe
(
t›
);

4605 *
_t›
 = 
NULL
;

4607 i‡(
upd©e
) {

4608 
	`¢d_c⁄fig_upd©e_‰ì
(
upd©e
);

4609 *
_upd©e
 = 
NULL
;

4612 i‡(
loˇl
)

4613 
	`¢d_c⁄fig_upd©e_‰ì
(
loˇl
);

4614  
îr
;

4616 
_ªªad
:

4617 *
_t›
 = 
NULL
;

4618 *
_upd©e
 = 
NULL
;

4619 i‡(
upd©e
) {

4620 
	`¢d_c⁄fig_upd©e_‰ì
(
upd©e
);

4621 
upd©e
 = 
NULL
;

4623 i‡(
t›
) {

4624 
	`¢d_c⁄fig_dñëe
(
t›
);

4625 
t›
 = 
NULL
;

4627 
îr
 = 
	`¢d_c⁄fig_t›
(&
t›
);

4628 i‡(
îr
 < 0)

4629 
_íd
;

4630 i‡(!
loˇl
)

4631 
_skù
;

4632 
k
 = 0; k < 
loˇl
->
cou¡
; ++k) {

4633 
¢d_öput_t
 *
ö
;

4634 
îr
 = 
	`¢d_öput_°dio_›í
(&
ö
, 
loˇl
->
föfo
[
k
].
«me
, "r");

4635 i‡(
îr
 >= 0) {

4636 
îr
 = 
	`¢d_c⁄fig_lﬂd
(
t›
, 
ö
);

4637 
	`¢d_öput_˛o£
(
ö
);

4638 i‡(
îr
 < 0) {

4639 
	`SNDERR
("%†may bêﬁd o∏c‹ru±ed: c⁄sidîÅÿªmovê‹ fix it", 
loˇl
->
föfo
[
k
].
«me
);

4640 
_íd
;

4643 
	`SNDERR
("ˇ¬Ÿác˚s†fûê%s", 
loˇl
->
föfo
[
k
].
«me
);

4646 
_skù
:

4647 
îr
 = 
	`¢d_c⁄fig_hooks
(
t›
, 
NULL
);

4648 i‡(
îr
 < 0) {

4649 
	`SNDERR
("hooks failed,Ñemoving configuration");

4650 
_íd
;

4652 *
_t›
 = 
t›
;

4653 *
_upd©e
 = 
loˇl
;

4655 
	}
}

4675 
	$¢d_c⁄fig_upd©e
()

4677 
îr
;

4679 
	`¢d_c⁄fig_lock
();

4680 
îr
 = 
	`¢d_c⁄fig_upd©e_r
(&
¢d_c⁄fig
, &
¢d_c⁄fig_globÆ_upd©e
, 
NULL
);

4681 
	`¢d_c⁄fig_u∆ock
();

4682  
îr
;

4683 
	}
}

4696 
	$¢d_c⁄fig_upd©e_ªf
(
¢d_c⁄fig_t
 **
t›
)

4698 
îr
;

4700 i‡(
t›
)

4701 *
t›
 = 
NULL
;

4702 
	`¢d_c⁄fig_lock
();

4703 
îr
 = 
	`¢d_c⁄fig_upd©e_r
(&
¢d_c⁄fig
, &
¢d_c⁄fig_globÆ_upd©e
, 
NULL
);

4704 i‡(
îr
 >= 0) {

4705 i‡(
¢d_c⁄fig
) {

4706 i‡(
t›
) {

4707 
¢d_c⁄fig
->
ªfcou¡
++;

4708 *
t›
 = 
¢d_c⁄fig
;

4711 
îr
 = -
ENODEV
;

4714 
	`¢d_c⁄fig_u∆ock
();

4715  
îr
;

4716 
	}
}

4725 
	$¢d_c⁄fig_ªf
(
¢d_c⁄fig_t
 *
cfg
)

4727 
	`¢d_c⁄fig_lock
();

4728 i‡(
cfg
)

4729 
cfg
->
ªfcou¡
++;

4730 
	`¢d_c⁄fig_u∆ock
();

4731 
	}
}

4745 
	$¢d_c⁄fig_uƒef
(
¢d_c⁄fig_t
 *
cfg
)

4747 
	`¢d_c⁄fig_lock
();

4748 i‡(
cfg
)

4749 
	`¢d_c⁄fig_dñëe
(
cfg
);

4750 
	`¢d_c⁄fig_u∆ock
();

4751 
	}
}

4758 
	$¢d_c⁄fig_upd©e_‰ì
(
¢d_c⁄fig_upd©e_t
 *
upd©e
)

4760 
k
;

4762 
	`as£π
(
upd©e
);

4763 
k
 = 0; k < 
upd©e
->
cou¡
; k++)

4764 
	`‰ì
(
upd©e
->
föfo
[
k
].
«me
);

4765 
	`‰ì
(
upd©e
->
föfo
);

4766 
	`‰ì
(
upd©e
);

4768 
	}
}

4780 
	$¢d_c⁄fig_upd©e_‰ì_globÆ
()

4782 
	`¢d_c⁄fig_lock
();

4783 i‡(
¢d_c⁄fig
)

4784 
	`¢d_c⁄fig_dñëe
(
¢d_c⁄fig
);

4785 
¢d_c⁄fig
 = 
NULL
;

4786 i‡(
¢d_c⁄fig_globÆ_upd©e
)

4787 
	`¢d_c⁄fig_upd©e_‰ì
(
¢d_c⁄fig_globÆ_upd©e
);

4788 
¢d_c⁄fig_globÆ_upd©e
 = 
NULL
;

4789 
	`¢d_c⁄fig_u∆ock
();

4791 
	`¢d_dlobj_ˇche_˛ónup
();

4794 
	}
}

4812 
¢d_c⁄fig_ôî©‹_t
 
	$¢d_c⁄fig_ôî©‹_fú°
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
)

4814 
	`as£π
(
c⁄fig
->
ty≥
 =
SND_CONFIG_TYPE_COMPOUND
);

4815  
c⁄fig
->
u
.
compound
.
fõlds
.
√xt
;

4816 
	}
}

4832 
¢d_c⁄fig_ôî©‹_t
 
	$¢d_c⁄fig_ôî©‹_√xt
(c⁄° 
¢d_c⁄fig_ôî©‹_t
 
ôî©‹
)

4834  
ôî©‹
->
√xt
;

4835 
	}
}

4850 
¢d_c⁄fig_ôî©‹_t
 
	$¢d_c⁄fig_ôî©‹_íd
(c⁄° 
¢d_c⁄fig_t
 *
c⁄fig
)

4852 
	`as£π
(
c⁄fig
->
ty≥
 =
SND_CONFIG_TYPE_COMPOUND
);

4853  (c⁄° 
¢d_c⁄fig_ôî©‹_t
)&
c⁄fig
->
u
.
compound
.
fõlds
;

4854 
	}
}

4864 
¢d_c⁄fig_t
 *
	$¢d_c⁄fig_ôî©‹_íåy
(c⁄° 
¢d_c⁄fig_ôî©‹_t
 
ôî©‹
)

4866  
	`li°_íåy
(
ôî©‹
, 
¢d_c⁄fig_t
, 
li°
);

4867 
	}
}

4869 #i‚de‡
DOC_HIDDEN


4870 
	e_¢d_c⁄fig_wÆk_∑ss
 {

4871 
	mSND_CONFIG_WALK_PASS_PRE
,

4872 
	mSND_CONFIG_WALK_PASS_POST
,

4873 
	mSND_CONFIG_WALK_PASS_LEAF
,

4874 } 
	t¢d_c⁄fig_wÆk_∑ss_t
;

4879 #i‚de‡
DOC_HIDDEN


4880 (*
	t¢d_c⁄fig_wÆk_ˇŒback_t
)(
	t¢d_c⁄fig_t
 *
	t§c
,

4881 
	t¢d_c⁄fig_t
 *
	troŸ
,

4882 
	t¢d_c⁄fig_t
 **
	td°
,

4883 
	t¢d_c⁄fig_wÆk_∑ss_t
 
	t∑ss
,

4884 
	t¢d_c⁄fig_ex∑nd_f˙_t
 
	tf˙
,

4885 *
	t¥iv©e_d©a
);

4888 
	$¢d_c⁄fig_wÆk
(
¢d_c⁄fig_t
 *
§c
,

4889 
¢d_c⁄fig_t
 *
roŸ
,

4890 
¢d_c⁄fig_t
 **
d°
,

4891 
¢d_c⁄fig_wÆk_ˇŒback_t
 
ˇŒback
,

4892 
¢d_c⁄fig_ex∑nd_f˙_t
 
f˙
,

4893 *
¥iv©e_d©a
)

4895 
îr
;

4896 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

4898 
	`¢d_c⁄fig_gë_ty≥
(
§c
)) {

4899 
SND_CONFIG_TYPE_COMPOUND
:

4900 
îr
 = 
	`ˇŒback
(
§c
, 
roŸ
, 
d°
, 
SND_CONFIG_WALK_PASS_PRE
, 
f˙
, 
¥iv©e_d©a
);

4901 i‡(
îr
 <= 0)

4902  
îr
;

4903 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
§c
) {

4904 
¢d_c⁄fig_t
 *
s
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

4905 
¢d_c⁄fig_t
 *
d
 = 
NULL
;

4907 
îr
 = 
	`¢d_c⁄fig_wÆk
(
s
, 
roŸ
, (
d°
 && *d°Ë? &
d
 : 
NULL
,

4908 
ˇŒback
, 
f˙
, 
¥iv©e_d©a
);

4909 i‡(
îr
 < 0)

4910 
_îr‹
;

4911 i‡(
îr
 && 
d
) {

4912 
îr
 = 
	`¢d_c⁄fig_add
(*
d°
, 
d
);

4913 i‡(
îr
 < 0)

4914 
_îr‹
;

4917 
îr
 = 
	`ˇŒback
(
§c
, 
roŸ
, 
d°
, 
SND_CONFIG_WALK_PASS_POST
, 
f˙
, 
¥iv©e_d©a
);

4918 i‡(
îr
 <= 0) {

4919 
_îr‹
:

4920 i‡(
d°
 && *dst)

4921 
	`¢d_c⁄fig_dñëe
(*
d°
);

4925 
îr
 = 
	`ˇŒback
(
§c
, 
roŸ
, 
d°
, 
SND_CONFIG_WALK_PASS_LEAF
, 
f˙
, 
¥iv©e_d©a
);

4928  
îr
;

4929 
	}
}

4931 
	$_¢d_c⁄fig_c›y
(
¢d_c⁄fig_t
 *
§c
,

4932 
¢d_c⁄fig_t
 *
roŸ
 
ATTRIBUTE_UNUSED
,

4933 
¢d_c⁄fig_t
 **
d°
,

4934 
¢d_c⁄fig_wÆk_∑ss_t
 
∑ss
,

4935 
¢d_c⁄fig_ex∑nd_f˙_t
 
f˙
 
ATTRIBUTE_UNUSED
,

4936 *
¥iv©e_d©a
 
ATTRIBUTE_UNUSED
)

4938 
îr
;

4939 c⁄° *
id
 = 
§c
->id;

4940 
¢d_c⁄fig_ty≥_t
 
ty≥
 = 
	`¢d_c⁄fig_gë_ty≥
(
§c
);

4941 
∑ss
) {

4942 
SND_CONFIG_WALK_PASS_PRE
:

4943 
îr
 = 
	`¢d_c⁄fig_make_compound
(
d°
, 
id
, 
§c
->
u
.
compound
.
joö
);

4944 i‡(
îr
 < 0)

4945  
îr
;

4947 
SND_CONFIG_WALK_PASS_LEAF
:

4948 
îr
 = 
	`¢d_c⁄fig_make
(
d°
, 
id
, 
ty≥
);

4949 i‡(
îr
 < 0)

4950  
îr
;

4951 
ty≥
) {

4952 
SND_CONFIG_TYPE_INTEGER
:

4954 
v
;

4955 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
§c
, &
v
);

4956 
	`as£π
(
îr
 >= 0);

4957 
	`¢d_c⁄fig_£t_öãgî
(*
d°
, 
v
);

4960 
SND_CONFIG_TYPE_INTEGER64
:

4962 
v
;

4963 
îr
 = 
	`¢d_c⁄fig_gë_öãgî64
(
§c
, &
v
);

4964 
	`as£π
(
îr
 >= 0);

4965 
	`¢d_c⁄fig_£t_öãgî64
(*
d°
, 
v
);

4968 
SND_CONFIG_TYPE_REAL
:

4970 
v
;

4971 
îr
 = 
	`¢d_c⁄fig_gë_ªÆ
(
§c
, &
v
);

4972 
	`as£π
(
îr
 >= 0);

4973 
	`¢d_c⁄fig_£t_ªÆ
(*
d°
, 
v
);

4976 
SND_CONFIG_TYPE_STRING
:

4978 c⁄° *
s
;

4979 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
§c
, &
s
);

4980 
	`as£π
(
îr
 >= 0);

4981 
îr
 = 
	`¢d_c⁄fig_£t_°rög
(*
d°
, 
s
);

4982 i‡(
îr
 < 0)

4983  
îr
;

4987 
	`as£π
(0);

4994 
	}
}

5014 
	$¢d_c⁄fig_c›y
(
¢d_c⁄fig_t
 **
d°
,

5015 
¢d_c⁄fig_t
 *
§c
)

5017  
	`¢d_c⁄fig_wÆk
(
§c
, 
NULL
, 
d°
, 
_¢d_c⁄fig_c›y
, NULL, NULL);

5018 
	}
}

5020 
	$_¢d_c⁄fig_ex∑nd_v¨s
(
¢d_c⁄fig_t
 **
d°
, c⁄° *
s
, *
¥iv©e_d©a
)

5022 
¢d_c⁄fig_t
 *
vÆ
, *
v¨s
 = 
¥iv©e_d©a
;

5023 i‡(
	`¢d_c⁄fig_£¨ch
(
v¨s
, 
s
, &
vÆ
) < 0) {

5024 *
d°
 = 
NULL
;

5027  
	`¢d_c⁄fig_c›y
(
d°
, 
vÆ
);

5028 
	}
}

5030 
	$_¢d_c⁄fig_ex∑nd
(
¢d_c⁄fig_t
 *
§c
,

5031 
¢d_c⁄fig_t
 *
roŸ
 
ATTRIBUTE_UNUSED
,

5032 
¢d_c⁄fig_t
 **
d°
,

5033 
¢d_c⁄fig_wÆk_∑ss_t
 
∑ss
,

5034 
¢d_c⁄fig_ex∑nd_f˙_t
 
f˙
,

5035 *
¥iv©e_d©a
)

5037 
îr
;

5038 c⁄° *
id
 = 
§c
->id;

5039 
¢d_c⁄fig_ty≥_t
 
ty≥
 = 
	`¢d_c⁄fig_gë_ty≥
(
§c
);

5040 
∑ss
) {

5041 
SND_CONFIG_WALK_PASS_PRE
:

5043 i‡(
id
 && 
	`°rcmp
(id, "@args") == 0)

5045 
îr
 = 
	`¢d_c⁄fig_make_compound
(
d°
, 
id
, 
§c
->
u
.
compound
.
joö
);

5046 i‡(
îr
 < 0)

5047  
îr
;

5050 
SND_CONFIG_WALK_PASS_LEAF
:

5051 
ty≥
) {

5052 
SND_CONFIG_TYPE_INTEGER
:

5054 
v
;

5055 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
§c
, &
v
);

5056 
	`as£π
(
îr
 >= 0);

5057 
îr
 = 
	`¢d_c⁄fig_imake_öãgî
(
d°
, 
id
, 
v
);

5058 i‡(
îr
 < 0)

5059  
îr
;

5062 
SND_CONFIG_TYPE_INTEGER64
:

5064 
v
;

5065 
îr
 = 
	`¢d_c⁄fig_gë_öãgî64
(
§c
, &
v
);

5066 
	`as£π
(
îr
 >= 0);

5067 
îr
 = 
	`¢d_c⁄fig_imake_öãgî64
(
d°
, 
id
, 
v
);

5068 i‡(
îr
 < 0)

5069  
îr
;

5072 
SND_CONFIG_TYPE_REAL
:

5074 
v
;

5075 
îr
 = 
	`¢d_c⁄fig_gë_ªÆ
(
§c
, &
v
);

5076 
	`as£π
(
îr
 >= 0);

5077 
îr
 = 
	`¢d_c⁄fig_imake_ªÆ
(
d°
, 
id
, 
v
);

5078 i‡(
îr
 < 0)

5079  
îr
;

5082 
SND_CONFIG_TYPE_STRING
:

5084 c⁄° *
s
;

5085 
¢d_c⁄fig_t
 *
v¨s
 = 
¥iv©e_d©a
;

5086 
	`¢d_c⁄fig_gë_°rög
(
§c
, &
s
);

5087 i‡(
s
 && *s == '$') {

5088 
îr
 = 
	`¢d_c⁄fig_evÆu©e_°rög
(
d°
, 
s
, 
f˙
, 
v¨s
);

5089 i‡(
îr
 < 0)

5090  
îr
;

5091 i‡(*
d°
 =
NULL
)

5093 
îr
 = 
	`¢d_c⁄fig_£t_id
(*
d°
, 
id
);

5094 i‡(
îr
 < 0) {

5095 
	`¢d_c⁄fig_dñëe
(*
d°
);

5096  
îr
;

5099 
îr
 = 
	`¢d_c⁄fig_imake_°rög
(
d°
, 
id
, 
s
);

5100 i‡(
îr
 < 0)

5101  
îr
;

5106 
	`as£π
(0);

5113 
	}
}

5115 
	$_¢d_c⁄fig_evÆu©e
(
¢d_c⁄fig_t
 *
§c
,

5116 
¢d_c⁄fig_t
 *
roŸ
,

5117 
¢d_c⁄fig_t
 **
d°
 
ATTRIBUTE_UNUSED
,

5118 
¢d_c⁄fig_wÆk_∑ss_t
 
∑ss
,

5119 
¢d_c⁄fig_ex∑nd_f˙_t
 
f˙
 
ATTRIBUTE_UNUSED
,

5120 *
¥iv©e_d©a
)

5122 
îr
;

5123 i‡(
∑ss
 =
SND_CONFIG_WALK_PASS_PRE
) {

5124 *
buf
 = 
NULL
, 
îrbuf
[256];

5125 c⁄° *
lib
 = 
NULL
, *
func_«me
 = NULL;

5126 c⁄° *
°r
;

5127 (*
func
)(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
,

5128 
¢d_c⁄fig_t
 *
§c
, snd_c⁄fig_à*
¥iv©e_d©a
Ë
NULL
;

5129 *
h
 = 
NULL
;

5130 
¢d_c⁄fig_t
 *
c
, *
func_c⁄f
 = 
NULL
;

5131 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
§c
, "@func", &
c
);

5132 i‡(
îr
 < 0)

5134 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
c
, &
°r
);

5135 i‡(
îr
 < 0) {

5136 
	`SNDERR
("InvalidÅype for @func");

5137  
îr
;

5139 
	`as£π
(
°r
);

5140 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "func", 
°r
, &
func_c⁄f
);

5141 i‡(
îr
 >= 0) {

5142 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

5143 i‡(
	`¢d_c⁄fig_gë_ty≥
(
func_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

5144 
	`SNDERR
("InvÆidÅy≥ f‹ fun¯%†deföôi⁄", 
°r
);

5145 
îr
 = -
EINVAL
;

5146 
_îr
;

5148 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
func_c⁄f
) {

5149 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

5150 c⁄° *
id
 = 
n
->id;

5151 i‡(
	`°rcmp
(
id
, "comment") == 0)

5153 i‡(
	`°rcmp
(
id
, "lib") == 0) {

5154 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
lib
);

5155 i‡(
îr
 < 0) {

5156 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

5157 
_îr
;

5161 i‡(
	`°rcmp
(
id
, "func") == 0) {

5162 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
func_«me
);

5163 i‡(
îr
 < 0) {

5164 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

5165 
_îr
;

5169 
	`SNDERR
("Unknow¿fõld %s", 
id
);

5172 i‡(!
func_«me
) {

5173 
Àn
 = 9 + 
	`°æí
(
°r
) + 1;

5174 
buf
 = 
	`mÆloc
(
Àn
);

5175 i‡(! 
buf
) {

5176 
îr
 = -
ENOMEM
;

5177 
_îr
;

5179 
	`¢¥ötf
(
buf
, 
Àn
, "¢d_func_%s", 
°r
);

5180 
buf
[
Àn
-1] = '\0';

5181 
func_«me
 = 
buf
;

5183 
h
 = 
	`INTERNAL
(
¢d_dl›í
)(
lib
, 
RTLD_NOW
, 
îrbuf
, (errbuf));

5184 i‡(
h
)

5185 
func
 = 
	`¢d_dlsym
(
h
, 
func_«me
, 
	`SND_DLSYM_VERSION
(
SND_CONFIG_DLSYM_VERSION_EVALUATE
));

5186 
îr
 = 0;

5187 i‡(!
h
) {

5188 
	`SNDERR
("C™nŸ o≥¿sh¨edÜibøry %†(%s)", 
lib
, 
îrbuf
);

5189 
îr
 = -
ENOENT
;

5190 
_îrbuf
;

5191 } i‡(!
func
) {

5192 
	`SNDERR
("symbﬁ %†i†nŸ deföed insidê%s", 
func_«me
, 
lib
);

5193 
	`¢d_dl˛o£
(
h
);

5194 
îr
 = -
ENXIO
;

5195 
_îrbuf
;

5197 
_îr
:

5198 i‡(
func_c⁄f
)

5199 
	`¢d_c⁄fig_dñëe
(
func_c⁄f
);

5200 i‡(
îr
 >= 0) {

5201 
¢d_c⁄fig_t
 *
evÆ
;

5202 
îr
 = 
	`func
(&
evÆ
, 
roŸ
, 
§c
, 
¥iv©e_d©a
);

5203 i‡(
îr
 < 0)

5204 
	`SNDERR
("fun˘i⁄ %†ªtu∫edÉº‹: %s", 
func_«me
, 
	`¢d_°ªº‹
(
îr
));

5205 
	`¢d_dl˛o£
(
h
);

5206 i‡(
îr
 >0 && 
evÆ
)

5207 
îr
 = 
	`¢d_c⁄fig_sub°ôuã
(
§c
, 
evÆ
);

5209 
_îrbuf
:

5210 
	`‰ì
(
buf
);

5211 i‡(
îr
 < 0)

5212  
îr
;

5216 
	}
}

5229 
	$¢d_c⁄fig_evÆu©e
(
¢d_c⁄fig_t
 *
c⁄fig
, snd_c⁄fig_à*
roŸ
,

5230 
¢d_c⁄fig_t
 *
¥iv©e_d©a
, snd_c⁄fig_à**
ªsu…
)

5233 
	`as£π
(
ªsu…
 =
NULL
);

5234  
	`¢d_c⁄fig_wÆk
(
c⁄fig
, 
roŸ
, 
ªsu…
, 
_¢d_c⁄fig_evÆu©e
, 
NULL
, 
¥iv©e_d©a
);

5235 
	}
}

5237 
	$lﬂd_deÁu…s
(
¢d_c⁄fig_t
 *
subs
, snd_c⁄fig_à*
defs
)

5239 
¢d_c⁄fig_ôî©‹_t
 
d
, 
d√xt
;

5240 
	`¢d_c⁄fig_f‹_óch
(
d
, 
d√xt
, 
defs
) {

5241 
¢d_c⁄fig_t
 *
def
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
d
);

5242 
¢d_c⁄fig_ôî©‹_t
 
f
, 
‚ext
;

5243 i‡(
	`¢d_c⁄fig_gë_ty≥
(
def
Ë!
SND_CONFIG_TYPE_COMPOUND
)

5245 
	`¢d_c⁄fig_f‹_óch
(
f
, 
‚ext
, 
def
) {

5246 
¢d_c⁄fig_t
 *
Êd
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
f
);

5247 c⁄° *
id
 = 
Êd
->id;

5248 i‡(
	`°rcmp
(
id
, "type") == 0)

5250 i‡(
	`°rcmp
(
id
, "default") == 0) {

5251 
¢d_c⁄fig_t
 *
deÊt
;

5252 
îr
;

5253 
îr
 = 
	`¢d_c⁄fig_c›y
(&
deÊt
, 
Êd
);

5254 i‡(
îr
 < 0)

5255  
îr
;

5256 
îr
 = 
	`¢d_c⁄fig_£t_id
(
deÊt
, 
def
->
id
);

5257 i‡(
îr
 < 0) {

5258 
	`¢d_c⁄fig_dñëe
(
deÊt
);

5259  
îr
;

5261 
îr
 = 
	`¢d_c⁄fig_add
(
subs
, 
deÊt
);

5262 i‡(
îr
 < 0) {

5263 
	`¢d_c⁄fig_dñëe
(
deÊt
);

5264  
îr
;

5268 
	`SNDERR
("Unknow¿fõld %s", 
id
);

5269  -
EINVAL
;

5273 
	}
}

5275 
	$skù_bœnk
(c⁄° **
±r
)

5278 **
±r
) {

5288 (*
±r
)++;

5290 
	}
}

5292 
	$∑r£_ch¨
(c⁄° **
±r
)

5294 
c
;

5295 
	`as£π
(**
±r
 == '\\');

5296 (*
±r
)++;

5297 
c
 = **
±r
;

5298 
c
) {

5300 
c
 = '\n';

5303 
c
 = '\t';

5306 
c
 = '\v';

5309 
c
 = '\b';

5312 
c
 = '\r';

5315 
c
 = '\f';

5320 
num
 = 
c
 - '0';

5321 
i
 = 1;

5322 (*
±r
)++;

5324 
c
 = **
±r
;

5325 i‡(
c
 < '0' || c > '7')

5327 
num
 =Çum * 8 + 
c
 - '0';

5328 
i
++;

5329 (*
±r
)++;

5330 } 
i
 < 3);

5331  
num
;

5336 (*
±r
)++;

5337  
c
;

5338 
	}
}

5340 
	$∑r£_id
(c⁄° **
±r
)

5342 i‡(!**
±r
)

5343  -
EINVAL
;

5345 **
±r
) {

5357 (*
±r
)++;

5359 
	}
}

5361 
	$∑r£_°rög
(c⁄° **
±r
, **
vÆ
)

5363 c⁄° 
size_t
 
bufsize
 = 256;

5364 
_buf
[
bufsize
];

5365 *
buf
 = 
_buf
;

5366 
size_t
 
Æloc
 = 
bufsize
;

5367 
dñim
 = **
±r
;

5368 
size_t
 
idx
 = 0;

5369 (*
±r
)++;

5371 
c
 = **
±r
;

5372 
c
) {

5374 
	`SNDERR
("Unterminated string");

5375  -
EINVAL
;

5377 
c
 = 
	`∑r£_ch¨
(
±r
);

5378 i‡(
c
 < 0) {

5379 i‡(
Æloc
 > 
bufsize
)

5380 
	`‰ì
(
buf
);

5381  
c
;

5385 (*
±r
)++;

5386 i‡(
c
 =
dñim
) {

5387 *
vÆ
 = 
	`mÆloc
(
idx
 + 1);

5388 i‡(!*
vÆ
)

5389  -
ENOMEM
;

5390 
	`mem˝y
(*
vÆ
, 
buf
, 
idx
);

5391 (*
vÆ
)[
idx
] = 0;

5392 i‡(
Æloc
 > 
bufsize
)

5393 
	`‰ì
(
buf
);

5397 i‡(
idx
 >
Æloc
) {

5398 
size_t
 
ﬁd_Æloc
 = 
Æloc
;

5399 
Æloc
 *= 2;

5400 i‡(
ﬁd_Æloc
 =
bufsize
) {

5401 
buf
 = 
	`mÆloc
(
Æloc
);

5402 i‡(!
buf
)

5403  -
ENOMEM
;

5404 
	`mem˝y
(
buf
, 
_buf
, 
ﬁd_Æloc
);

5406 *
buf2
 = 
	`ªÆloc
(
buf
, 
Æloc
);

5407 i‡(!
buf2
) {

5408 
	`‰ì
(
buf
);

5409  -
ENOMEM
;

5411 
buf
 = 
buf2
;

5414 
buf
[
idx
++] = 
c
;

5416 
	}
}

5420 
	$∑r£_¨g
(c⁄° **
±r
, *
v¨Àn
, **
vÆ
)

5422 c⁄° *
°r
;

5423 
îr
, 
vÆÀn
;

5424 
	`skù_bœnk
(
±r
);

5425 
°r
 = *
±r
;

5426 i‡(*
°r
 == '"' || *str == '\'') {

5427 
îr
 = 
	`∑r£_°rög
(
±r
, 
vÆ
);

5428 i‡(
îr
 < 0)

5429  
îr
;

5430 *
v¨Àn
 = 0;

5433 
îr
 = 
	`∑r£_id
(
±r
);

5434 i‡(
îr
 < 0)

5435  
îr
;

5436 
vÆÀn
 = *
±r
 - 
°r
;

5437 
	`skù_bœnk
(
±r
);

5438 i‡(**
±r
 != '=') {

5439 *
v¨Àn
 = 0;

5440 
_vÆue
;

5442 *
v¨Àn
 = 
vÆÀn
;

5443 (*
±r
)++;

5444 
	`skù_bœnk
(
±r
);

5445 
°r
 = *
±r
;

5446 i‡(*
°r
 == '"' || *str == '\'') {

5447 
îr
 = 
	`∑r£_°rög
(
±r
, 
vÆ
);

5448 i‡(
îr
 < 0)

5449  
îr
;

5452 
îr
 = 
	`∑r£_id
(
±r
);

5453 i‡(
îr
 < 0)

5454  
îr
;

5455 
vÆÀn
 = *
±r
 - 
°r
;

5456 
_vÆue
:

5457 *
vÆ
 = 
	`mÆloc
(
vÆÀn
 + 1);

5458 i‡(!*
vÆ
)

5459  -
ENOMEM
;

5460 
	`mem˝y
(*
vÆ
, 
°r
, 
vÆÀn
);

5461 (*
vÆ
)[
vÆÀn
] = 0;

5463 
	}
}

5470 
	$∑r£_¨gs
(
¢d_c⁄fig_t
 *
subs
, c⁄° *
°r
, snd_c⁄fig_à*
defs
)

5472 
îr
;

5473 
¨g
 = 0;

5474 i‡(
°r
 =
NULL
)

5476 
	`skù_bœnk
(&
°r
);

5477 i‡(!*
°r
)

5479 i‡(*
°r
 == '{') {

5480 
Àn
 = 
	`°æí
(
°r
);

5481 
¢d_öput_t
 *
öput
;

5482 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

5484 
°r
[--
Àn
]) {

5496 i‡(
°r
[
Àn
] != '}')

5497  -
EINVAL
;

5498 
îr
 = 
	`¢d_öput_buf„r_›í
(&
öput
, 
°r
 + 1, 
Àn
 - 1);

5499 i‡(
îr
 < 0)

5500  
îr
;

5501 
îr
 = 
	`¢d_c⁄fig_lﬂd_ovîride
(
subs
, 
öput
);

5502 
	`¢d_öput_˛o£
(
öput
);

5503 i‡(
îr
 < 0)

5504  
îr
;

5505 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
subs
) {

5506 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

5507 
¢d_c⁄fig_t
 *
d
;

5508 c⁄° *
id
 = 
n
->id;

5509 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
defs
, 
id
, &
d
);

5510 i‡(
îr
 < 0) {

5511 
	`SNDERR
("Unknow¿∑ømëî %s", 
id
);

5512  
îr
;

5519 
buf
[256];

5520 c⁄° *
v¨
 = 
buf
;

5521 
v¨Àn
;

5522 
¢d_c⁄fig_t
 *
def
, *
sub
, *
typ
;

5523 c⁄° *
√w
 = 
°r
;

5524 c⁄° *
tmp
;

5525 *
vÆ
 = 
NULL
;

5527 
sub
 = 
NULL
;

5528 
îr
 = 
	`∑r£_¨g
(&
√w
, &
v¨Àn
, &
vÆ
);

5529 i‡(
îr
 < 0)

5530 
_îr
;

5531 i‡(
v¨Àn
 > 0) {

5532 
	`as£π
(
v¨Àn
 < (
buf
));

5533 
	`mem˝y
(
buf
, 
°r
, 
v¨Àn
);

5534 
buf
[
v¨Àn
] = 0;

5536 
	`•rötf
(
buf
, "%d", 
¨g
);

5538 
îr
 = 
	`¢d_c⁄fig_£¨ch_Æüs
(
defs
, 
NULL
, 
v¨
, &
def
);

5539 i‡(
îr
 < 0) {

5540 
	`SNDERR
("Unknow¿∑ømëî %s", 
v¨
);

5541 
_îr
;

5543 i‡(
	`¢d_c⁄fig_gë_ty≥
(
def
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

5544 
	`SNDERR
("P¨amëî %†deföôi⁄ i†nŸ c‹ª˘", 
v¨
);

5545 
îr
 = -
EINVAL
;

5546 
_îr
;

5548 
v¨
 = 
def
->
id
;

5549 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
subs
, 
v¨
, &
sub
);

5550 i‡(
îr
 >= 0)

5551 
	`¢d_c⁄fig_dñëe
(
sub
);

5552 
sub
 = 
NULL
;

5553 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
def
, "ty≥", &
typ
);

5554 i‡(
îr
 < 0) {

5555 
_övÆid_ty≥
:

5556 
	`SNDERR
("P¨amëî %†deföôi⁄ i†missögá vÆidÅy≥ info", 
v¨
);

5557 
_îr
;

5559 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
typ
, &
tmp
);

5560 i‡(
îr
 < 0 || !
tmp
)

5561 
_övÆid_ty≥
;

5562 i‡(
	`°rcmp
(
tmp
, "integer") == 0) {

5563 
v
;

5564 
îr
 = 
	`¢d_c⁄fig_make
(&
sub
, 
v¨
, 
SND_CONFIG_TYPE_INTEGER
);

5565 i‡(
îr
 < 0)

5566 
_îr
;

5567 
îr
 = 
	`ß„_°πﬁ
(
vÆ
, &
v
);

5568 i‡(
îr
 < 0) {

5569 
	`SNDERR
("P¨amëî %†mu° bê™ i¡egî", 
v¨
);

5570 
_îr
;

5572 
îr
 = 
	`¢d_c⁄fig_£t_öãgî
(
sub
, 
v
);

5573 i‡(
îr
 < 0)

5574 
_îr
;

5575 } i‡(
	`°rcmp
(
tmp
, "integer64") == 0) {

5576 
v
;

5577 
îr
 = 
	`¢d_c⁄fig_make
(&
sub
, 
v¨
, 
SND_CONFIG_TYPE_INTEGER64
);

5578 i‡(
îr
 < 0)

5579 
_îr
;

5580 
îr
 = 
	`ß„_°πﬁl
(
vÆ
, &
v
);

5581 i‡(
îr
 < 0) {

5582 
	`SNDERR
("P¨amëî %†mu° bê™ i¡egî", 
v¨
);

5583 
_îr
;

5585 
îr
 = 
	`¢d_c⁄fig_£t_öãgî64
(
sub
, 
v
);

5586 i‡(
îr
 < 0)

5587 
_îr
;

5588 } i‡(
	`°rcmp
(
tmp
, "real") == 0) {

5589 
v
;

5590 
îr
 = 
	`¢d_c⁄fig_make
(&
sub
, 
v¨
, 
SND_CONFIG_TYPE_REAL
);

5591 i‡(
îr
 < 0)

5592 
_îr
;

5593 
îr
 = 
	`ß„_°πod
(
vÆ
, &
v
);

5594 i‡(
îr
 < 0) {

5595 
	`SNDERR
("P¨amëî %†mu° bê®ªÆ", 
v¨
);

5596 
_îr
;

5598 
îr
 = 
	`¢d_c⁄fig_£t_ªÆ
(
sub
, 
v
);

5599 i‡(
îr
 < 0)

5600 
_îr
;

5601 } i‡(
	`°rcmp
(
tmp
, "string") == 0) {

5602 
îr
 = 
	`¢d_c⁄fig_make
(&
sub
, 
v¨
, 
SND_CONFIG_TYPE_STRING
);

5603 i‡(
îr
 < 0)

5604 
_îr
;

5605 
îr
 = 
	`¢d_c⁄fig_£t_°rög
(
sub
, 
vÆ
);

5606 i‡(
îr
 < 0)

5607 
_îr
;

5609 
îr
 = -
EINVAL
;

5610 
_övÆid_ty≥
;

5612 
îr
 = 
	`¢d_c⁄fig_£t_id
(
sub
, 
v¨
);

5613 i‡(
îr
 < 0)

5614 
_îr
;

5615 
îr
 = 
	`¢d_c⁄fig_add
(
subs
, 
sub
);

5616 i‡(
îr
 < 0) {

5617 
_îr
:

5618 i‡(
sub
)

5619 
	`¢d_c⁄fig_dñëe
(
sub
);

5620 
	`‰ì
(
vÆ
);

5621  
îr
;

5623 
	`‰ì
(
vÆ
);

5624 i‡(!*
√w
)

5626 i‡(*
√w
 != ',')

5627  -
EINVAL
;

5628 
°r
 = 
√w
 + 1;

5629 
¨g
++;

5632 
	}
}

5653 
	$¢d_c⁄fig_ex∑nd_cu°om
(
¢d_c⁄fig_t
 *
c⁄fig
, snd_c⁄fig_à*
roŸ
,

5654 
¢d_c⁄fig_ex∑nd_f˙_t
 
f˙
, *
¥iv©e_d©a
,

5655 
¢d_c⁄fig_t
 **
ªsu…
)

5657 
¢d_c⁄fig_t
 *
ªs
;

5658 
îr
;

5660 
îr
 = 
	`¢d_c⁄fig_wÆk
(
c⁄fig
, 
roŸ
, &
ªs
, 
_¢d_c⁄fig_ex∑nd
, 
f˙
, 
¥iv©e_d©a
);

5661 i‡(
îr
 < 0) {

5662 
	`SNDERR
("Ex∑ndÉº‹ (wÆk): %s", 
	`¢d_°ªº‹
(
îr
));

5663  
îr
;

5665 *
ªsu…
 = 
ªs
;

5667 
	}
}

5686 
	$¢d_c⁄fig_ex∑nd
(
¢d_c⁄fig_t
 *
c⁄fig
, snd_c⁄fig_à*
roŸ
, c⁄° *
¨gs
,

5687 
¢d_c⁄fig_t
 *
¥iv©e_d©a
, snd_c⁄fig_à**
ªsu…
)

5689 
îr
;

5690 
¢d_c⁄fig_t
 *
defs
, *
subs
 = 
NULL
, *
ªs
;

5691 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, "@¨gs", &
defs
);

5692 i‡(
îr
 < 0) {

5693 i‡(
¨gs
 !
NULL
) {

5694 
	`SNDERR
("Unknow¿∑ømëî†%s", 
¨gs
);

5695  -
EINVAL
;

5697 
îr
 = 
	`¢d_c⁄fig_c›y
(&
ªs
, 
c⁄fig
);

5698 i‡(
îr
 < 0)

5699  
îr
;

5701 
îr
 = 
	`¢d_c⁄fig_t›
(&
subs
);

5702 i‡(
îr
 < 0)

5703  
îr
;

5704 
îr
 = 
	`lﬂd_deÁu…s
(
subs
, 
defs
);

5705 i‡(
îr
 < 0) {

5706 
	`SNDERR
("Lﬂd deÁu…†îr‹: %s", 
	`¢d_°ªº‹
(
îr
));

5707 
_íd
;

5709 
îr
 = 
	`∑r£_¨gs
(
subs
, 
¨gs
, 
defs
);

5710 i‡(
îr
 < 0) {

5711 
	`SNDERR
("P¨£árgumít†îr‹: %s", 
	`¢d_°ªº‹
(
îr
));

5712 
_íd
;

5714 
îr
 = 
	`¢d_c⁄fig_evÆu©e
(
subs
, 
roŸ
, 
¥iv©e_d©a
, 
NULL
);

5715 i‡(
îr
 < 0) {

5716 
	`SNDERR
("Arg†evÆu©êîr‹: %s", 
	`¢d_°ªº‹
(
îr
));

5717 
_íd
;

5719 
îr
 = 
	`¢d_c⁄fig_wÆk
(
c⁄fig
, 
roŸ
, &
ªs
, 
_¢d_c⁄fig_ex∑nd
, 
_¢d_c⁄fig_ex∑nd_v¨s
, 
subs
);

5720 i‡(
îr
 < 0) {

5721 
	`SNDERR
("Ex∑ndÉº‹ (wÆk): %s", 
	`¢d_°ªº‹
(
îr
));

5722 
_íd
;

5725 
îr
 = 
	`¢d_c⁄fig_evÆu©e
(
ªs
, 
roŸ
, 
¥iv©e_d©a
, 
NULL
);

5726 i‡(
îr
 < 0) {

5727 
	`SNDERR
("EvÆu©êîr‹: %s", 
	`¢d_°ªº‹
(
îr
));

5728 
	`¢d_c⁄fig_dñëe
(
ªs
);

5729 
_íd
;

5731 *
ªsu…
 = 
ªs
;

5732 
îr
 = 1;

5733 
_íd
:

5734 i‡(
subs
)

5735 
	`¢d_c⁄fig_dñëe
(
subs
);

5736  
îr
;

5737 
	}
}

5768 
	$¢d_c⁄fig_£¨ch_deföôi⁄
(
¢d_c⁄fig_t
 *
c⁄fig
,

5769 c⁄° *
ba£
, c⁄° *
«me
,

5770 
¢d_c⁄fig_t
 **
ªsu…
)

5772 
¢d_c⁄fig_t
 *
c⁄f
;

5773 *
key
;

5774 c⁄° *
¨gs
 = 
	`°rchr
(
«me
, ':');

5775 
îr
;

5776 i‡(
¨gs
) {

5777 
¨gs
++;

5778 
key
 = 
	`Æloˇ
(
¨gs
 - 
«me
);

5779 
	`mem˝y
(
key
, 
«me
, 
¨gs
 -Çame - 1);

5780 
key
[
¨gs
 - 
«me
 - 1] = '\0';

5782 
key
 = (*Ë
«me
;

5788 
	`¢d_c⁄fig_lock
();

5789 
îr
 = 
	`¢d_c⁄fig_£¨ch_Æüs_hooks
(
c⁄fig
, 
	`°rchr
(
key
, '.'Ë? 
NULL
 : 
ba£
, key, &
c⁄f
);

5790 i‡(
îr
 < 0) {

5791 
	`¢d_c⁄fig_u∆ock
();

5792  
îr
;

5794 
îr
 = 
	`¢d_c⁄fig_ex∑nd
(
c⁄f
, 
c⁄fig
, 
¨gs
, 
NULL
, 
ªsu…
);

5795 
	`¢d_c⁄fig_u∆ock
();

5796  
îr
;

5797 
	}
}

5799 #i‚de‡
DOC_HIDDEN


5800 
	$¢d_c⁄fig_£t_h›
(
¢d_c⁄fig_t
 *
c⁄f
, 
h›
)

5802 
c⁄f
->
h›
 = hop;

5803 
	}
}

5805 
	$¢d_c⁄fig_check_h›
(
¢d_c⁄fig_t
 *
c⁄f
)

5807 i‡(
c⁄f
) {

5808 i‡(
c⁄f
->
h›
 >
SND_CONF_MAX_HOPS
) {

5809 
	`SYSERR
("Too many definitionÜevels (looped?)\n");

5810  -
EINVAL
;

5812  
c⁄f
->
h›
;

5815 
	}
}

5820 
	$_¢d_c⁄fig_íd
(Ë
	`__©åibuã__
 ((
de°ru˘‹
));

5822 
	$_¢d_c⁄fig_íd
()

5824 
k
;

5825 i‡(
¢d_c⁄fig
)

5826 
	`¢d_c⁄fig_dñëe
(
¢d_c⁄fig
);

5827 
¢d_c⁄fig
 = 0;

5828 
k
 = 0; k < 
fûes_öfo_cou¡
; ++k)

5829 
	`‰ì
(
fûes_öfo
[
k
].
«me
);

5830 
	`‰ì
(
fûes_öfo
);

5831 
fûes_öfo
 = 
NULL
;

5832 
fûes_öfo_cou¡
 = 0;

5833 
	}
}

5836 #i‚de‡
DOC_HIDDEN


5837 
size_t
 
	$∑ge_size
()

5839 
s
 = 
	`sysc⁄f
(
_SC_PAGE_SIZE
);

5840 
	`as£π
(
s
 > 0);

5841  
s
;

5842 
	}
}

5844 
size_t
 
	$∑ge_Æign
(
size_t
 
size
)

5846 
size_t
 
r
;

5847 
psz
 = 
	`∑ge_size
();

5848 
r
 = 
size
 % 
psz
;

5849 i‡(
r
)

5850  
size
 + 
psz
 - 
r
;

5851  
size
;

5852 
	}
}

5854 
size_t
 
	$∑ge_±r
(
size_t
 
obje˘_off£t
, size_à
obje˘_size
, size_à*
off£t
, size_à*
mm≠_off£t
)

5856 
size_t
 
r
;

5857 
psz
 = 
	`∑ge_size
();

5858 
	`as£π
(
off£t
);

5859 
	`as£π
(
mm≠_off£t
);

5860 *
mm≠_off£t
 = 
obje˘_off£t
;

5861 
obje˘_off£t
 %
psz
;

5862 *
mm≠_off£t
 -
obje˘_off£t
;

5863 
obje˘_size
 +
obje˘_off£t
;

5864 
r
 = 
obje˘_size
 % 
psz
;

5865 i‡(
r
)

5866 
r
 = 
obje˘_size
 + 
psz
 -Ñ;

5868 
r
 = 
obje˘_size
;

5869 *
off£t
 = 
obje˘_off£t
;

5870  
r
;

5871 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/confeval.c

34 
	~"loˇl.h
"

35 
	~<°dlib.h
>

36 
	~<°dio.h
>

37 
	~<°rög.h
>

38 
	~<˘y≥.h
>

39 
	~<limôs.h
>

41 #i‚de‡
DOC_HIDDEN


42 
	tvÆue_ty≥_t
;

45 c⁄° *
	$_föd_íd_of_ex¥essi⁄
(c⁄° *
s
, 
begö
, 
íd
)

47 
cou¡
 = 1;

48 *
s
) {

49 i‡(*
s
 =
begö
) {

50 
cou¡
++;

51 } i‡(*
s
 =
íd
) {

52 
cou¡
--;

53 i‡(
cou¡
 == 0)

54  
s
 + 1;

56 
s
++;

58  
NULL
;

59 
	}
}

61 
	$_∑r£_öãgî
(
vÆue_ty≥_t
 *
vÆ
, c⁄° **
s
)

63 
v
;

64 *
íd
;

66 
î∫o
 = 0;

67 
v
 = 
	`°πﬁl
(*
s
, &
íd
, 0);

68 i‡(
î∫o
)

69  -
î∫o
;

70 *
vÆ
 = 
v
;

71 i‡((()*
vÆ
Ë!
v
)

72  -
ERANGE
;

73 *
s
 = 
íd
;

75 
	}
}

77 
	$_to_öãgî
(
vÆue_ty≥_t
 *
vÆ
, 
¢d_c⁄fig_t
 *
c
)

79 
îr
;

81 
	`¢d_c⁄fig_gë_ty≥
(
c
)) {

82 
SND_CONFIG_TYPE_INTEGER
:

84 
v
;

85 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
c
, &
v
);

86 i‡(
îr
 >= 0)

87 *
vÆ
 = 
v
;

90 
SND_CONFIG_TYPE_INTEGER64
:

92 
v
;

93 
îr
 = 
	`¢d_c⁄fig_gë_öãgî64
(
c
, &
v
);

94 i‡(
îr
 >= 0) {

95 *
vÆ
 = 
v
;

96 i‡((()*
vÆ
Ë!
v
)

97  -
ERANGE
;

102 
SND_CONFIG_TYPE_STRING
:

104 c⁄° *
s
;

105 
v
;

106 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
c
, &
s
);

107 i‡(
îr
 >= 0) {

108 
îr
 = 
	`ß„_°πﬁl
(
s
, &
v
);

109 i‡(
îr
 >= 0) {

110 *
vÆ
 = 
v
;

111 i‡((()*
vÆ
Ë!
v
)

112  -
ERANGE
;

119  -
EINVAL
;

121  
îr
;

122 
	}
}

124 #i‚de‡
DOC_HIDDEN


125 
	$_¢d_evÆ_°rög
(
¢d_c⁄fig_t
 **
d°
, c⁄° *
s
,

126 
¢d_c⁄fig_ex∑nd_f˙_t
 
f˙
, *
¥iv©e_d©a
)

128 
¢d_c⁄fig_t
 *
tmp
;

129 c⁄° *
ßve
, *
e
;

130 *
m
;

131 
vÆue_ty≥_t
 
À·
, 
right
;

132 
îr
, 
c
, 
›
, 
off
;

134 
LEFT
,

135 
OP
,

136 
RIGHT
,

137 
END


138 } 
pos
;

140 *
s
 && *s <= ' ') s++;

141 
ßve
 = 
s
;

142 
pos
 = 
LEFT
;

143 
›
 = 0;

144 *
s
) {

145 *
s
 && *s <= ' ') s++;

146 
c
 = *
s
;

147 i‡(
c
 == '\0')

149 i‡(
pos
 =
END
) {

150 
	`SNDERR
("u√x≥˘edÉx¥essi⁄Åaû '%s'", 
s
);

151  -
EINVAL
;

153 i‡(
pos
 =
OP
) {

154 
c
) {

161 '&': 
›
 = 
c
; ;

163 
	`SNDERR
("unknow¿›î©i⁄ '%c'", 
c
);

164  -
EINVAL
;

166 
pos
 = 
RIGHT
;

167 
s
++;

170 i‡(
c
 == '(') {

171 
e
 = 
	`_föd_íd_of_ex¥essi⁄
(
s
 + 1, '(', ')');

172 
off
 = 1;

173 
_ex¥
;

174 } i‡(
c
 == '$') {

175 i‡(
s
[1] == '[') {

176 
e
 = 
	`_föd_íd_of_ex¥essi⁄
(
s
 + 2, '[', ']');

177 
off
 = 2;

178 
_ex¥
:

179 i‡(
e
 =
NULL
)

180  -
EINVAL
;

181 
m
 = 
	`mÆloc
(
e
 - 
s
 - (
off
 - 1));

182 i‡(
m
 =
NULL
)

183  -
ENOMEM
;

184 
	`mem˝y
(
m
, 
s
 + 
off
, 
e
 - s - off);

185 
m
[
e
 - 
s
 - (
off
 + 1)] = '\0';

186 
îr
 = 
	`_¢d_evÆ_°rög
(&
tmp
, 
m
, 
f˙
, 
¥iv©e_d©a
);

187 
	`‰ì
(
m
);

188 i‡(
îr
 < 0)

189  
îr
;

190 
s
 = 
e
;

191 i‡(*
s
)

192 
s
++;

194 
e
 = 
s
 + 1;

195 *
e
) {

196 i‡(!
	`iß um
(*
e
) && *e != '_')

198 
e
++;

200 
m
 = 
	`mÆloc
(
e
 - 
s
);

201 i‡(
m
 =
NULL
)

202  -
ENOMEM
;

203 
	`mem˝y
(
m
, 
s
 + 1, 
e
 - s - 1);

204 
m
[
e
 - 
s
 - 1] = '\0';

205 
îr
 = 
	`f˙
(&
tmp
, 
m
, 
¥iv©e_d©a
);

206 
	`‰ì
(
m
);

207 i‡(
îr
 < 0)

208  
îr
;

209 i‡(
tmp
 =
NULL
) {

210 
îr
 = 
	`¢d_c⁄fig_imake_öãgî
(&
tmp
, 
NULL
, 0);

211 i‡(
îr
 < 0)

212  
îr
;

214 
s
 = 
e
;

216 
îr
 = 
	`_to_öãgî
(
›
 =
LEFT
 ? &
À·
 : &
right
, 
tmp
);

217 
	`¢d_c⁄fig_dñëe
(
tmp
);

218 } i‡(
c
 == '-' || (c >= '0' && c <= '9')) {

219 
îr
 = 
	`_∑r£_öãgî
(
›
 =
LEFT
 ? &
À·
 : &
right
, &
s
);

221  -
EINVAL
;

223 i‡(
îr
 < 0)

224  
îr
;

225 
pos
 = 
›
 =
LEFT
 ? 
OP
 : 
END
;

227 i‡(
pos
 !
OP
 &&Öo†!
END
) {

228 
	`SNDERR
("öcom∂ëêex¥essi⁄ '%s'", 
ßve
);

229  -
EINVAL
;

232 i‡(
pos
 =
END
) {

233 
›
) {

234 '+': 
À·
 =Üe· + 
right
; ;

235 '-': 
À·
 =Üe· - 
right
; ;

236 '*': 
À·
 =Üe· * 
right
; ;

237 '/': 
À·
 =Üe· / 
right
; ;

238 '%': 
À·
 =Üe· % 
right
; ;

239 '|': 
À·
 =Üe· | 
right
; ;

240 '&': 
À·
 =Üe· & 
right
; ;

241 :  -
EINVAL
;

245 i‡(
À·
 > 
INT_MAX
 ||Üe· < 
INT_MIN
)

246  
	`¢d_c⁄fig_imake_öãgî64
(
d°
, 
NULL
, 
À·
);

248  
	`¢d_c⁄fig_imake_öãgî
(
d°
, 
NULL
, 
À·
);

249 
	}
}

261 
	$¢d_c⁄fig_evÆu©e_°rög
(
¢d_c⁄fig_t
 **
d°
, c⁄° *
s
,

262 
¢d_c⁄fig_ex∑nd_f˙_t
 
f˙
, *
¥iv©e_d©a
)

264 
	`as£π
(
d°
 && 
s
);

265 
îr
;

267 i‡(*
s
 != '$')

268  -
EINVAL
;

269 i‡(
s
[1] == '[') {

270 
îr
 = 
	`_¢d_evÆ_°rög
(
d°
, 
s
, 
f˙
, 
¥iv©e_d©a
);

271 i‡(
îr
 < 0)

272 
	`SNDERR
("wr⁄gÉx¥essi⁄ '%s'", 
s
);

274 
îr
 = 
	`f˙
(
d°
, 
s
 + 1, 
¥iv©e_d©a
);

276  
îr
;

277 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/confmisc.c

77 
	~"loˇl.h
"

78 
	~<°dlib.h
>

79 
	~<°dio.h
>

80 
	~<°rög.h
>

81 
	~<˘y≥.h
>

82 
	~<limôs.h
>

89 
	$¢d_c⁄fig_gë_boﬁ_ascii
(c⁄° *
ascii
)

91 
k
;

93 c⁄° 
°r
[8];

94 
vÆ
;

95 } 
b
[] = {

105 
k
 = 0; k < (
b
) / (*b); k++) {

106 i‡(
	`°rˇ£cmp
(
b
[
k
].
°r
, 
ascii
) == 0)

107  
b
[
k
].
vÆ
;

109  -
EINVAL
;

110 
	}
}

117 
	$¢d_c⁄fig_gë_boﬁ
(c⁄° 
¢d_c⁄fig_t
 *
c⁄f
)

119 
v
;

120 c⁄° *
°r
, *
id
;

121 
îr
;

123 
îr
 = 
	`¢d_c⁄fig_gë_id
(
c⁄f
, &
id
);

124 i‡(
îr
 < 0)

125  
îr
;

126 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
c⁄f
, &
v
);

127 i‡(
îr
 >= 0) {

128 i‡(
v
 < 0 || v > 1) {

129 
_övÆid_vÆue
:

130 
	`SNDERR
("InvÆid vÆuêf‹ %s", 
id
);

131  -
EINVAL
;

133  
v
;

135 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
c⁄f
, &
°r
);

136 i‡(
îr
 < 0) {

137 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

138  -
EINVAL
;

140 
îr
 = 
	`¢d_c⁄fig_gë_boﬁ_ascii
(
°r
);

141 i‡(
îr
 < 0)

142 
_övÆid_vÆue
;

143  
îr
;

144 
	}
}

151 
	$¢d_c⁄fig_gë_ˇrd
(c⁄° 
¢d_c⁄fig_t
 *
c⁄f
)

153 c⁄° *
°r
, *
id
;

154 
v
;

155 
îr
;

157 i‡(
	`¢d_c⁄fig_gë_öãgî
(
c⁄f
, &
v
) < 0) {

158 i‡(
	`¢d_c⁄fig_gë_°rög
(
c⁄f
, &
°r
)) {

159 i‡(
	`¢d_c⁄fig_gë_id
(
c⁄f
, &
id
) >= 0)

160 
	`SNDERR
("InvÆid fõld %s", 
id
);

161  -
EINVAL
;

163 
îr
 = 
	`¢d_ˇrd_gë_ödex
(
°r
);

164 i‡(
îr
 < 0) {

165 
	`SNDERR
("C™nŸ gë c¨d index f‹ %s", 
°r
);

166  
îr
;

168 
v
 = 
îr
;

170 i‡(
v
 < 0 || v > 
INT_MAX
)

171  -
EINVAL
;

172  
v
;

173 
	}
}

180 
	$¢d_c⁄fig_gë_˘l_iÁ˚_ascii
(c⁄° *
ascii
)

182 
v
;

183 
¢d_˘l_ñem_iÁ˚_t
 
idx
;

184 i‡(
	`isdigô
(
ascii
[0])) {

185 i‡(
	`ß„_°πﬁ
(
ascii
, &
v
) >= 0) {

186 i‡(
v
 < 0 || v > 
SND_CTL_ELEM_IFACE_LAST
)

187  -
EINVAL
;

188  
v
;

191 
idx
 = 0; idx <
SND_CTL_ELEM_IFACE_LAST
; idx++) {

192 i‡(
	`°rˇ£cmp
(
	`¢d_˘l_ñem_iÁ˚_«me
(
idx
), 
ascii
) == 0)

193  
idx
;

195  -
EINVAL
;

196 
	}
}

203 
	$¢d_c⁄fig_gë_˘l_iÁ˚
(c⁄° 
¢d_c⁄fig_t
 *
c⁄f
)

205 
v
;

206 c⁄° *
°r
, *
id
;

207 
îr
;

209 
îr
 = 
	`¢d_c⁄fig_gë_id
(
c⁄f
, &
id
);

210 i‡(
îr
 < 0)

211  
îr
;

212 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
c⁄f
, &
v
);

213 i‡(
îr
 >= 0) {

214 i‡(
v
 < 0 || v > 
SND_CTL_ELEM_IFACE_LAST
) {

215 
_övÆid_vÆue
:

216 
	`SNDERR
("InvÆid vÆuêf‹ %s", 
id
);

217  -
EINVAL
;

219  
v
;

221 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
c⁄f
, &
°r
);

222 i‡(
îr
 < 0) {

223 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

224  -
EINVAL
;

226 
îr
 = 
	`¢d_c⁄fig_gë_˘l_iÁ˚_ascii
(
°r
);

227 i‡(
îr
 < 0)

228 
_övÆid_vÆue
;

229  
îr
;

230 
	}
}

255 
	$¢d_func_gëív
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
, snd_c⁄fig_à*
§c
,

256 
¢d_c⁄fig_t
 *
¥iv©e_d©a
)

258 
¢d_c⁄fig_t
 *
n
, *
d
;

259 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

260 c⁄° *
ªs
, *
id
;

261 *
def
 = 
NULL
;

262 
idx
 = 0, 
îr
, 
hô
;

264 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
§c
, "v¨s", &
n
);

265 i‡(
îr
 < 0) {

266 
	`SNDERR
("field varsÇot found");

267 
__îr‹
;

269 
îr
 = 
	`¢d_c⁄fig_evÆu©e
(
n
, 
roŸ
, 
¥iv©e_d©a
, 
NULL
);

270 i‡(
îr
 < 0) {

271 
	`SNDERR
("errorÉvaluating vars");

272 
__îr‹
;

274 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
§c
, "deÁu…", &
d
);

275 i‡(
îr
 < 0) {

276 
	`SNDERR
("field defaultÇot found");

277 
__îr‹
;

279 
îr
 = 
	`¢d_c⁄fig_evÆu©e
(
d
, 
roŸ
, 
¥iv©e_d©a
, 
NULL
);

280 i‡(
îr
 < 0) {

281 
	`SNDERR
("errorÉvaluating default");

282 
__îr‹
;

284 
îr
 = 
	`¢d_c⁄fig_gë_ascii
(
d
, &
def
);

285 i‡(
îr
 < 0) {

286 
	`SNDERR
("error getting field default");

287 
__îr‹
;

290 
hô
 = 0;

291 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
n
) {

292 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

293 c⁄° *
±r
;

294 
i
;

295 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

297 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_STRING
) {

298 
	`SNDERR
("fõld %†i†nŸá såög", 
id
);

299 
îr
 = -
EINVAL
;

300 
__îr‹
;

302 
îr
 = 
	`ß„_°πﬁ
(
id
, &
i
);

303 i‡(
îr
 < 0) {

304 
	`SNDERR
("id o‡fõld %†i†nŸá¿öãgî", 
id
);

305 
îr
 = -
EINVAL
;

306 
__îr‹
;

308 i‡(
i
 =
idx
) {

309 
idx
++;

310 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
±r
);

311 i‡(
îr
 < 0) {

312 
	`SNDERR
("övÆid såög f‹ id %s", 
id
);

313 
îr
 = -
EINVAL
;

314 
__îr‹
;

316 
ªs
 = 
	`gëív
(
±r
);

317 i‡(
ªs
 !
NULL
 && *res != '\0')

318 
__ok
;

319 
hô
 = 1;

322 } 
hô
);

323 
ªs
 = 
def
;

324 
__ok
:

325 
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
);

326 i‡(
îr
 >= 0)

327 
îr
 = 
	`¢d_c⁄fig_imake_°rög
(
d°
, 
id
, 
ªs
);

328 
__îr‹
:

329 
	`‰ì
(
def
);

330  
îr
;

331 
	}
}

332 #i‚de‡
DOC_HIDDEN


333 
SND_DLSYM_BUILD_VERSION
(
¢d_func_gëív
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

355 
	$¢d_func_igëív
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
, snd_c⁄fig_à*
§c
,

356 
¢d_c⁄fig_t
 *
¥iv©e_d©a
)

358 
¢d_c⁄fig_t
 *
d
;

359 c⁄° *
°r
, *
id
;

360 
îr
;

361 
v
;

363 
îr
 = 
	`¢d_func_gëív
(&
d
, 
roŸ
, 
§c
, 
¥iv©e_d©a
);

364 i‡(
îr
 < 0)

365  
îr
;

366 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
d
, &
°r
);

367 i‡(
îr
 < 0) {

368 
	`¢d_c⁄fig_dñëe
(
d
);

369  
îr
;

371 
îr
 = 
	`ß„_°πﬁ
(
°r
, &
v
);

372 i‡(
îr
 < 0) {

373 
	`¢d_c⁄fig_dñëe
(
d
);

374  
îr
;

376 
	`¢d_c⁄fig_dñëe
(
d
);

377 
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
);

378 i‡(
îr
 < 0)

379  
îr
;

380 
îr
 = 
	`¢d_c⁄fig_imake_öãgî
(
d°
, 
id
, 
v
);

381 i‡(
îr
 < 0)

382  
îr
;

384 
	}
}

385 #i‚de‡
DOC_HIDDEN


386 
SND_DLSYM_BUILD_VERSION
(
¢d_func_igëív
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

406 
	$¢d_func_c⁄ˇt
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
, snd_c⁄fig_à*
§c
,

407 
¢d_c⁄fig_t
 *
¥iv©e_d©a
)

409 
¢d_c⁄fig_t
 *
n
;

410 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

411 c⁄° *
id
;

412 *
ªs
 = 
NULL
, *
tmp
;

413 
idx
 = 0, 
Àn
 = 0, 
Àn1
, 
îr
, 
hô
;

415 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
§c
, "°rögs", &
n
);

416 i‡(
îr
 < 0) {

417 
	`SNDERR
("field stringsÇot found");

418 
__îr‹
;

420 
îr
 = 
	`¢d_c⁄fig_evÆu©e
(
n
, 
roŸ
, 
¥iv©e_d©a
, 
NULL
);

421 i‡(
îr
 < 0) {

422 
	`SNDERR
("errorÉvaluating strings");

423 
__îr‹
;

426 
hô
 = 0;

427 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
n
) {

428 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

429 *
±r
;

430 c⁄° *
id
;

431 
i
;

432 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

434 
îr
 = 
	`ß„_°πﬁ
(
id
, &
i
);

435 i‡(
îr
 < 0) {

436 
	`SNDERR
("id o‡fõld %†i†nŸá¿öãgî", 
id
);

437 
îr
 = -
EINVAL
;

438 
__îr‹
;

440 i‡(
i
 =
idx
) {

441 
idx
++;

442 
îr
 = 
	`¢d_c⁄fig_gë_ascii
(
n
, &
±r
);

443 i‡(
îr
 < 0) {

444 
	`SNDERR
("övÆidásciò°rög f‹ id %s", 
id
);

445 
îr
 = -
EINVAL
;

446 
__îr‹
;

448 
Àn1
 = 
	`°æí
(
±r
);

449 
tmp
 = 
	`ªÆloc
(
ªs
, 
Àn
 + 
Àn1
 + 1);

450 i‡(
tmp
 =
NULL
) {

451 
	`‰ì
(
±r
);

452 
îr
 = -
ENOMEM
;

453 
__îr‹
;

455 
	`mem˝y
(
tmp
 + 
Àn
, 
±r
, 
Àn1
);

456 
	`‰ì
(
±r
);

457 
Àn
 +
Àn1
;

458 
tmp
[
Àn
] = '\0';

459 
ªs
 = 
tmp
;

460 
hô
 = 1;

463 } 
hô
);

464 i‡(
ªs
 =
NULL
) {

465 
	`SNDERR
("empty string isÇotáccepted");

466 
îr
 = -
EINVAL
;

467 
__îr‹
;

469 
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
);

470 i‡(
îr
 >= 0)

471 
îr
 = 
	`¢d_c⁄fig_imake_°rög
(
d°
, 
id
, 
ªs
);

472 
__îr‹
:

473 
	`‰ì
(
ªs
);

474  
îr
;

475 
	}
}

476 #i‚de‡
DOC_HIDDEN


477 
SND_DLSYM_BUILD_VERSION
(
¢d_func_c⁄ˇt
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

481 
	$¢d_func_i›s
(
¢d_c⁄fig_t
 **
d°
,

482 
¢d_c⁄fig_t
 *
roŸ
,

483 
¢d_c⁄fig_t
 *
§c
,

484 
¢d_c⁄fig_t
 *
¥iv©e_d©a
,

485 
›
)

487 
¢d_c⁄fig_t
 *
n
;

488 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

489 c⁄° *
id
;

490 *
ªs
 = 
NULL
;

491 
ªsu…
 = 0, 
vÆ
;

492 
idx
 = 0, 
îr
, 
hô
;

494 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
§c
, "öãgîs", &
n
);

495 i‡(
îr
 < 0) {

496 
	`SNDERR
("field integersÇot found");

497 
__îr‹
;

499 
îr
 = 
	`¢d_c⁄fig_evÆu©e
(
n
, 
roŸ
, 
¥iv©e_d©a
, 
NULL
);

500 i‡(
îr
 < 0) {

501 
	`SNDERR
("errorÉvaluating integers");

502 
__îr‹
;

505 
hô
 = 0;

506 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
n
) {

507 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

508 c⁄° *
id
;

509 
i
;

510 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

512 
îr
 = 
	`ß„_°πﬁ
(
id
, &
i
);

513 i‡(
îr
 < 0) {

514 
	`SNDERR
("id o‡fõld %†i†nŸá¿öãgî", 
id
);

515 
îr
 = -
EINVAL
;

516 
__îr‹
;

518 i‡(
i
 =
idx
) {

519 
idx
++;

520 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
vÆ
);

521 i‡(
îr
 < 0) {

522 
	`SNDERR
("övÆid i¡egî f‹ id %s", 
id
);

523 
îr
 = -
EINVAL
;

524 
__îr‹
;

526 
›
) {

527 0: 
ªsu…
 +
vÆ
; ;

528 1: 
ªsu…
 *
vÆ
; ;

530 
hô
 = 1;

533 } 
hô
);

534 
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
);

535 i‡(
îr
 >= 0)

536 
îr
 = 
	`¢d_c⁄fig_imake_öãgî
(
d°
, 
id
, 
ªsu…
);

537 
	`‰ì
(
ªs
);

538 
__îr‹
:

539  
îr
;

540 
	}
}

560 
	$¢d_func_üdd
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
,

561 
¢d_c⁄fig_t
 *
§c
, snd_c⁄fig_à*
¥iv©e_d©a
)

563  
	`¢d_func_i›s
(
d°
, 
roŸ
, 
§c
, 
¥iv©e_d©a
, 0);

564 
	}
}

565 #i‚de‡
DOC_HIDDEN


566 
SND_DLSYM_BUILD_VERSION
(
¢d_func_üdd
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

586 
	$¢d_func_imul
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
,

587 
¢d_c⁄fig_t
 *
§c
, snd_c⁄fig_à*
¥iv©e_d©a
)

589  
	`¢d_func_i›s
(
d°
, 
roŸ
, 
§c
, 
¥iv©e_d©a
, 1);

590 
	}
}

591 #i‚de‡
DOC_HIDDEN


592 
SND_DLSYM_BUILD_VERSION
(
¢d_func_imul
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

611 
	$¢d_func_d©adú
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
 
ATTRIBUTE_UNUSED
,

612 
¢d_c⁄fig_t
 *
§c
, snd_c⁄fig_à*
¥iv©e_d©a
 
ATTRIBUTE_UNUSED
)

614 
îr
;

615 c⁄° *
id
;

617 
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
);

618 i‡(
îr
 < 0)

619  
îr
;

620  
	`¢d_c⁄fig_imake_°rög
(
d°
, 
id
, 
	`¢d_c⁄fig_t›dú
());

621 
	}
}

622 #i‚de‡
DOC_HIDDEN


623 
SND_DLSYM_BUILD_VERSION
(
¢d_func_d©adú
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

626 
	$›í_˘l
(
ˇrd
, 
¢d_˘l_t
 **
˘l
)

628 
«me
[16];

629 
	`¢¥ötf
(
«me
, “ame), "hw:%li", 
ˇrd
);

630 
«me
[(name)-1] = '\0';

631  
	`¢d_˘l_›í
(
˘l
, 
«me
, 0);

632 
	}
}

635 
	$°rög_‰om_öãgî
(**
d°
, 
v
)

637 
°r
[32];

638 *
ªs
;

639 
	`•rötf
(
°r
, "%li", 
v
);

640 
ªs
 = 
	`°rdup
(
°r
);

641 i‡(
ªs
 =
NULL
)

642  -
ENOMEM
;

643 *
d°
 = 
ªs
;

645 
	}
}

648 
	$_¢d_func_¥iv©e_d©a
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
§c
,

649 
¢d_c⁄fig_t
 **
¥iv©e_d©a
, c⁄° *
id
)

651 
îr
;

653 i‡(*
¥iv©e_d©a
 =
NULL
)

654  
	`¢d_c⁄fig_c›y
(
d°
, 
§c
);

655 i‡(
	`¢d_c⁄fig_gë_ty≥
(*
¥iv©e_d©a
Ë=
SND_CONFIG_TYPE_COMPOUND
) {

656 
îr
 = 
	`¢d_c⁄fig_£¨ch
(*
¥iv©e_d©a
, 
id
,Örivate_data);

657 i‡(
îr
)

658 
nŸfound
;

660 
îr
 = 
	`¢d_c⁄fig_ã°_id
(*
¥iv©e_d©a
, 
id
);

661 i‡(
îr
) {

662 
nŸfound
:

663 
	`SNDERR
("fõld %†nŸ found", 
id
);

664  -
EINVAL
;

667 
	}
}

687 
	$¢d_func_¥iv©e_°rög
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
 
ATTRIBUTE_UNUSED
,

688 
¢d_c⁄fig_t
 *
§c
, snd_c⁄fig_à*
¥iv©e_d©a
)

690 
îr
;

691 c⁄° *
°r
, *
id
;

693 
îr
 = 
	`_¢d_func_¥iv©e_d©a
(
d°
, 
§c
, &
¥iv©e_d©a
, "string");

694 i‡(
îr
)

695  
îr
;

696 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
¥iv©e_d©a
, &
°r
);

697 i‡(
îr
 < 0) {

698 
	`SNDERR
("field string isÇotá string");

699  
îr
;

701 
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
);

702 i‡(
îr
 >= 0)

703 
îr
 = 
	`¢d_c⁄fig_imake_°rög
(
d°
, 
id
, 
°r
);

704  
îr
;

705 
	}
}

706 #i‚de‡
DOC_HIDDEN


707 
SND_DLSYM_BUILD_VERSION
(
¢d_func_¥iv©e_°rög
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

727 
	$¢d_func_¥iv©e_öãgî
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
 
ATTRIBUTE_UNUSED
,

728 
¢d_c⁄fig_t
 *
§c
, snd_c⁄fig_à*
¥iv©e_d©a
)

730 
îr
;

731 c⁄° *
id
;

732 
vÆ
;

734 
îr
 = 
	`_¢d_func_¥iv©e_d©a
(
d°
, 
§c
, &
¥iv©e_d©a
, "integer");

735 i‡(
îr
)

736  
îr
;

737 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
¥iv©e_d©a
, &
vÆ
);

738 i‡(
îr
 < 0) {

739 
	`SNDERR
("field integer isÇotá string");

740  
îr
;

742 
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
);

743 i‡(
îr
 >= 0)

744 
îr
 = 
	`¢d_c⁄fig_imake_öãgî
(
d°
, 
id
, 
vÆ
);

745  
îr
;

746 
	}
}

747 #i‚de‡
DOC_HIDDEN


748 
SND_DLSYM_BUILD_VERSION
(
¢d_func_¥iv©e_öãgî
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

751 #i‚de‡
DOC_HIDDEN


752 
	$¢d_dëîmöe_drivî
(
ˇrd
, **
drivî
)

754 
¢d_˘l_t
 *
˘l
 = 
NULL
;

755 
¢d_˘l_ˇrd_öfo_t
 
öfo
 = {0};

756 *
ªs
 = 
NULL
;

757 
îr
;

759 
	`as£π
(
ˇrd
 >0 && c¨d <
SND_MAX_CARDS
);

760 
îr
 = 
	`›í_˘l
(
ˇrd
, &
˘l
);

761 i‡(
îr
 < 0) {

762 
	`SNDERR
("couldÇŸ o≥¿c⁄åﬁ f‹ c¨d %i", 
ˇrd
);

763 
__îr‹
;

765 
îr
 = 
	`¢d_˘l_ˇrd_öfo
(
˘l
, &
öfo
);

766 i‡(
îr
 < 0) {

767 
	`SNDERR
("¢d_˘l_ˇrd_öfÿîr‹: %s", 
	`¢d_°ªº‹
(
îr
));

768 
__îr‹
;

770 
ªs
 = 
	`°rdup
(
	`¢d_˘l_ˇrd_öfo_gë_drivî
(&
öfo
));

771 i‡(
ªs
 =
NULL
)

772 
îr
 = -
ENOMEM
;

774 *
drivî
 = 
ªs
;

775 
îr
 = 0;

777 
__îr‹
:

778 i‡(
˘l
)

779 
	`¢d_˘l_˛o£
(
˘l
);

780  
îr
;

781 
	}
}

801 
	$¢d_func_¥iv©e_ˇrd_drivî
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
 
ATTRIBUTE_UNUSED
, snd_c⁄fig_à*
§c
,

802 
¢d_c⁄fig_t
 *
¥iv©e_d©a
)

804 *
drivî
;

805 c⁄° *
id
;

806 
îr
;

807 
ˇrd
;

809 
îr
 = 
	`¢d_c⁄fig_ã°_id
(
¥iv©e_d©a
, "card");

810 i‡(
îr
) {

811 
	`SNDERR
("field cardÇot found");

812  -
EINVAL
;

814 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
¥iv©e_d©a
, &
ˇrd
);

815 i‡(
îr
 < 0) {

816 
	`SNDERR
("field card isÇotán integer");

817  
îr
;

819 i‡((
îr
 = 
	`¢d_dëîmöe_drivî
(
ˇrd
, &
drivî
)) < 0)

820  
îr
;

821 
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
);

822 i‡(
îr
 >= 0)

823 
îr
 = 
	`¢d_c⁄fig_imake_°rög
(
d°
, 
id
, 
drivî
);

824 
	`‰ì
(
drivî
);

825  
îr
;

826 
	}
}

827 #i‚de‡
DOC_HIDDEN


828 
SND_DLSYM_BUILD_VERSION
(
¢d_func_¥iv©e_ˇrd_drivî
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

831 
	$∑r£_ˇrd
(
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
§c
,

832 
¢d_c⁄fig_t
 *
¥iv©e_d©a
)

834 
¢d_c⁄fig_t
 *
n
;

835 *
°r
;

836 
ˇrd
, 
îr
;

838 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
§c
, "ˇrd", &
n
);

839 i‡(
îr
 < 0) {

840 
	`SNDERR
("field cardÇot found");

841  
îr
;

843 
îr
 = 
	`¢d_c⁄fig_evÆu©e
(
n
, 
roŸ
, 
¥iv©e_d©a
, 
NULL
);

844 i‡(
îr
 < 0) {

845 
	`SNDERR
("errorÉvaluating card");

846  
îr
;

848 
îr
 = 
	`¢d_c⁄fig_gë_ascii
(
n
, &
°r
);

849 i‡(
îr
 < 0) {

850 
	`SNDERR
("field card isÇotán integer orá string");

851  
îr
;

853 
ˇrd
 = 
	`¢d_ˇrd_gë_ödex
(
°r
);

854 i‡(
ˇrd
 < 0)

855 
	`SNDERR
("ˇ¬Ÿ föd c¨d '%s'", 
°r
);

856 
	`‰ì
(
°r
);

857  
ˇrd
;

858 
	}
}

877 
	$¢d_func_ˇrd_öum
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
, snd_c⁄fig_à*
§c
,

878 
¢d_c⁄fig_t
 *
¥iv©e_d©a
)

880 c⁄° *
id
;

881 
ˇrd
, 
îr
;

883 
ˇrd
 = 
	`∑r£_ˇrd
(
roŸ
, 
§c
, 
¥iv©e_d©a
);

884 i‡(
ˇrd
 < 0)

885  
ˇrd
;

886 
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
);

887 i‡(
îr
 >= 0)

888 
îr
 = 
	`¢d_c⁄fig_imake_öãgî
(
d°
, 
id
, 
ˇrd
);

889  
îr
;

890 
	}
}

891 #i‚de‡
DOC_HIDDEN


892 
SND_DLSYM_BUILD_VERSION
(
¢d_func_ˇrd_öum
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

912 
	$¢d_func_ˇrd_drivî
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
, snd_c⁄fig_à*
§c
,

913 
¢d_c⁄fig_t
 *
¥iv©e_d©a
)

915 
¢d_c⁄fig_t
 *
vÆ
;

916 
ˇrd
, 
îr
;

918 
ˇrd
 = 
	`∑r£_ˇrd
(
roŸ
, 
§c
, 
¥iv©e_d©a
);

919 i‡(
ˇrd
 < 0)

920  
ˇrd
;

921 
îr
 = 
	`¢d_c⁄fig_imake_öãgî
(&
vÆ
, "ˇrd", 
ˇrd
);

922 i‡(
îr
 < 0)

923  
îr
;

924 
îr
 = 
	`¢d_func_¥iv©e_ˇrd_drivî
(
d°
, 
roŸ
, 
§c
, 
vÆ
);

925 
	`¢d_c⁄fig_dñëe
(
vÆ
);

926  
îr
;

927 
	}
}

928 #i‚de‡
DOC_HIDDEN


929 
SND_DLSYM_BUILD_VERSION
(
¢d_func_ˇrd_drivî
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

949 
	$¢d_func_ˇrd_id
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
, snd_c⁄fig_à*
§c
,

950 
¢d_c⁄fig_t
 *
¥iv©e_d©a
)

952 
¢d_˘l_t
 *
˘l
 = 
NULL
;

953 
¢d_˘l_ˇrd_öfo_t
 
öfo
 = {0};

954 c⁄° *
id
;

955 
ˇrd
, 
îr
;

957 
ˇrd
 = 
	`∑r£_ˇrd
(
roŸ
, 
§c
, 
¥iv©e_d©a
);

958 i‡(
ˇrd
 < 0)

959  
ˇrd
;

960 
îr
 = 
	`›í_˘l
(
ˇrd
, &
˘l
);

961 i‡(
îr
 < 0) {

962 
	`SNDERR
("couldÇŸ o≥¿c⁄åﬁ f‹ c¨d %i", 
ˇrd
);

963 
__îr‹
;

965 
îr
 = 
	`¢d_˘l_ˇrd_öfo
(
˘l
, &
öfo
);

966 i‡(
îr
 < 0) {

967 
	`SNDERR
("¢d_˘l_ˇrd_öfÿîr‹: %s", 
	`¢d_°ªº‹
(
îr
));

968 
__îr‹
;

970 
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
);

971 i‡(
îr
 >= 0)

972 
îr
 = 
	`¢d_c⁄fig_imake_°rög
(
d°
, 
id
,

973 
	`¢d_˘l_ˇrd_öfo_gë_id
(&
öfo
));

974 
__îr‹
:

975 i‡(
˘l
)

976 
	`¢d_˘l_˛o£
(
˘l
);

977  
îr
;

978 
	}
}

979 #i‚de‡
DOC_HIDDEN


980 
SND_DLSYM_BUILD_VERSION
(
¢d_func_ˇrd_id
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

1000 
	$¢d_func_ˇrd_«me
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
,

1001 
¢d_c⁄fig_t
 *
§c
, snd_c⁄fig_à*
¥iv©e_d©a
)

1003 
¢d_˘l_t
 *
˘l
 = 
NULL
;

1004 
¢d_˘l_ˇrd_öfo_t
 
öfo
 = {0};

1005 c⁄° *
id
;

1006 
ˇrd
, 
îr
;

1008 
ˇrd
 = 
	`∑r£_ˇrd
(
roŸ
, 
§c
, 
¥iv©e_d©a
);

1009 i‡(
ˇrd
 < 0)

1010  
ˇrd
;

1011 
îr
 = 
	`›í_˘l
(
ˇrd
, &
˘l
);

1012 i‡(
îr
 < 0) {

1013 
	`SNDERR
("couldÇŸ o≥¿c⁄åﬁ f‹ c¨d %i", 
ˇrd
);

1014 
__îr‹
;

1016 
îr
 = 
	`¢d_˘l_ˇrd_öfo
(
˘l
, &
öfo
);

1017 i‡(
îr
 < 0) {

1018 
	`SNDERR
("¢d_˘l_ˇrd_öfÿîr‹: %s", 
	`¢d_°ªº‹
(
îr
));

1019 
__îr‹
;

1021 
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
);

1022 i‡(
îr
 >= 0)

1023 
îr
 = 
	`¢d_c⁄fig_imake_ß„_°rög
(
d°
, 
id
,

1024 
	`¢d_˘l_ˇrd_öfo_gë_«me
(&
öfo
));

1025 
__îr‹
:

1026 i‡(
˘l
)

1027 
	`¢d_˘l_˛o£
(
˘l
);

1028  
îr
;

1029 
	}
}

1030 #i‚de‡
DOC_HIDDEN


1031 
SND_DLSYM_BUILD_VERSION
(
¢d_func_ˇrd_«me
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

1034 #ifde‡
DOXYGEN


1037 #i‚de‡
BUILD_PCM


1038 
	#BUILD_PCM


	)

1042 #ifde‡
BUILD_PCM


1064 
	$¢d_func_pcm_id
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
, snd_c⁄fig_à*
§c
, *
¥iv©e_d©a
)

1066 
¢d_c⁄fig_t
 *
n
;

1067 
¢d_˘l_t
 *
˘l
 = 
NULL
;

1068 
¢d_pcm_öfo_t
 
öfo
 = {0};

1069 c⁄° *
id
;

1070 
ˇrd
, 
devi˚
, 
subdevi˚
 = 0;

1071 
îr
;

1073 
ˇrd
 = 
	`∑r£_ˇrd
(
roŸ
, 
§c
, 
¥iv©e_d©a
);

1074 i‡(
ˇrd
 < 0)

1075  
ˇrd
;

1076 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
§c
, "devi˚", &
n
);

1077 i‡(
îr
 < 0) {

1078 
	`SNDERR
("field deviceÇot found");

1079 
__îr‹
;

1081 
îr
 = 
	`¢d_c⁄fig_evÆu©e
(
n
, 
roŸ
, 
¥iv©e_d©a
, 
NULL
);

1082 i‡(
îr
 < 0) {

1083 
	`SNDERR
("errorÉvaluating device");

1084 
__îr‹
;

1086 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
devi˚
);

1087 i‡(
îr
 < 0) {

1088 
	`SNDERR
("field device isÇotán integer");

1089 
__îr‹
;

1091 i‡(
	`¢d_c⁄fig_£¨ch
(
§c
, "subdevi˚", &
n
) >= 0) {

1092 
îr
 = 
	`¢d_c⁄fig_evÆu©e
(
n
, 
roŸ
, 
¥iv©e_d©a
, 
NULL
);

1093 i‡(
îr
 < 0) {

1094 
	`SNDERR
("errorÉvaluating subdevice");

1095 
__îr‹
;

1097 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
subdevi˚
);

1098 i‡(
îr
 < 0) {

1099 
	`SNDERR
("field subdevice isÇotán integer");

1100 
__îr‹
;

1103 
îr
 = 
	`›í_˘l
(
ˇrd
, &
˘l
);

1104 i‡(
îr
 < 0) {

1105 
	`SNDERR
("couldÇŸ o≥¿c⁄åﬁ f‹ c¨d %li", 
ˇrd
);

1106 
__îr‹
;

1108 
	`¢d_pcm_öfo_£t_devi˚
(&
öfo
, 
devi˚
);

1109 
	`¢d_pcm_öfo_£t_subdevi˚
(&
öfo
, 
subdevi˚
);

1110 
îr
 = 
	`¢d_˘l_pcm_öfo
(
˘l
, &
öfo
);

1111 i‡(
îr
 < 0) {

1112 
	`SNDERR
("¢d_˘l_pcm_öfÿîr‹: %s", 
	`¢d_°ªº‹
(
îr
));

1113 
__îr‹
;

1115 
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
);

1116 i‡(
îr
 >= 0)

1117 
îr
 = 
	`¢d_c⁄fig_imake_°rög
(
d°
, 
id
,

1118 
	`¢d_pcm_öfo_gë_id
(&
öfo
));

1119 
__îr‹
:

1120 i‡(
˘l
)

1121 
	`¢d_˘l_˛o£
(
˘l
);

1122  
îr
;

1123 
	}
}

1124 #i‚de‡
DOC_HIDDEN


1125 
SND_DLSYM_BUILD_VERSION
(
¢d_func_pcm_id
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

1148 
	$¢d_func_pcm_¨gs_by_˛ass
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
, snd_c⁄fig_à*
§c
, *
¥iv©e_d©a
)

1150 
¢d_c⁄fig_t
 *
n
;

1151 
¢d_˘l_t
 *
˘l
 = 
NULL
;

1152 
¢d_pcm_öfo_t
 
öfo
 = {0};

1153 c⁄° *
id
;

1154 
ˇrd
 = -1, 
dev
;

1155 
˛ass
, 
ödex
;

1156 
idx
 = 0;

1157 
îr
;

1159 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
§c
, "˛ass", &
n
);

1160 i‡(
îr
 < 0) {

1161 
	`SNDERR
("field classÇot found");

1162 
__out
;

1164 
îr
 = 
	`¢d_c⁄fig_evÆu©e
(
n
, 
roŸ
, 
¥iv©e_d©a
, 
NULL
);

1165 i‡(
îr
 < 0) {

1166 
	`SNDERR
("errorÉvaluating class");

1167 
__out
;

1169 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
˛ass
);

1170 i‡(
îr
 < 0) {

1171 
	`SNDERR
("field class isÇotán integer");

1172 
__out
;

1174 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
§c
, "ödex", &
n
);

1175 i‡(
îr
 < 0) {

1176 
	`SNDERR
("field indexÇot found");

1177 
__out
;

1179 
îr
 = 
	`¢d_c⁄fig_evÆu©e
(
n
, 
roŸ
, 
¥iv©e_d©a
, 
NULL
);

1180 i‡(
îr
 < 0) {

1181 
	`SNDERR
("errorÉvaluating index");

1182 
__out
;

1184 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
ödex
);

1185 i‡(
îr
 < 0) {

1186 
	`SNDERR
("field index isÇotán integer");

1187 
__out
;

1191 
îr
 = 
	`¢d_ˇrd_√xt
(&
ˇrd
);

1192 i‡(
îr
 < 0) {

1193 
	`SNDERR
("couldÇot getÇext card");

1194 
__out
;

1196 i‡(
ˇrd
 < 0)

1198 
îr
 = 
	`›í_˘l
(
ˇrd
, &
˘l
);

1199 i‡(
îr
 < 0) {

1200 
	`SNDERR
("couldÇŸ o≥¿c⁄åﬁ f‹ c¨d %i", 
ˇrd
);

1201 
__out
;

1203 
dev
 = -1;

1205 
îr
 = 
	`¢d_˘l_pcm_√xt_devi˚
(
˘l
, &
dev
);

1206 i‡(
îr
 < 0) {

1207 
	`SNDERR
("couldÇŸ gëÇexàpcm f‹ c¨d %i", 
ˇrd
);

1208 
__out
;

1210 i‡(
dev
 < 0)

1212 
	`¢d_pcm_öfo_£t_devi˚
(&
öfo
, 
dev
);

1213 
îr
 = 
	`¢d_˘l_pcm_öfo
(
˘l
, &
öfo
);

1214 i‡(
îr
 < 0)

1216 i‡(
	`¢d_pcm_öfo_gë_˛ass
(&
öfo
Ë=(
¢d_pcm_˛ass_t
)
˛ass
 &&

1217 
ödex
 =
idx
++)

1218 
__out
;

1220 
	`¢d_˘l_˛o£
(
˘l
);

1221 
˘l
 = 
NULL
;

1223 
îr
 = -
ENODEV
;

1225 
__out
:

1226 i‡(
˘l
)

1227 
	`¢d_˘l_˛o£
(
˘l
);

1228 i‡(
îr
 < 0)

1229  
îr
;

1230 if((
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
)) >= 0) {

1231 
«me
[32];

1232 
	`¢¥ötf
(
«me
, “ame), "CARD=%i,DEV=%i", 
ˇrd
, 
dev
);

1233 
îr
 = 
	`¢d_c⁄fig_imake_°rög
(
d°
, 
id
, 
«me
);

1235  
îr
;

1236 
	}
}

1237 #i‚de‡
DOC_HIDDEN


1238 
SND_DLSYM_BUILD_VERSION
(
¢d_func_pcm_¨gs_by_˛ass
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

1258 
	$¢d_func_¥iv©e_pcm_subdevi˚
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
 
ATTRIBUTE_UNUSED
,

1259 
¢d_c⁄fig_t
 *
§c
, snd_c⁄fig_à*
¥iv©e_d©a
)

1261 
¢d_pcm_öfo_t
 
öfo
 = {0};

1262 c⁄° *
id
;

1263 c⁄° *
d©a
;

1264 
¢d_pcm_t
 *
pcm
;

1265 
îr
;

1267 i‡(
¥iv©e_d©a
 =
NULL
)

1268  
	`¢d_c⁄fig_c›y
(
d°
, 
§c
);

1269 
îr
 = 
	`¢d_c⁄fig_ã°_id
(
¥iv©e_d©a
, "pcm_handle");

1270 i‡(
îr
) {

1271 
	`SNDERR
("fieldÖcm_handleÇot found");

1272  -
EINVAL
;

1274 
îr
 = 
	`¢d_c⁄fig_gë_poöãr
(
¥iv©e_d©a
, &
d©a
);

1275 
pcm
 = (
¢d_pcm_t
 *)
d©a
;

1276 i‡(
îr
 < 0) {

1277 
	`SNDERR
("fieldÖcm_handle isÇotáÖointer");

1278  
îr
;

1280 
îr
 = 
	`¢d_pcm_öfo
(
pcm
, &
öfo
);

1281 i‡(
îr
 < 0) {

1282 
	`SNDERR
("¢d_˘l_pcm_öfÿîr‹: %s", 
	`¢d_°ªº‹
(
îr
));

1283  
îr
;

1285 
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
);

1286 i‡(
îr
 >= 0)

1287 
îr
 = 
	`¢d_c⁄fig_imake_öãgî
(
d°
, 
id
,

1288 
	`¢d_pcm_öfo_gë_subdevi˚
(&
öfo
));

1289  
îr
;

1290 
	}
}

1291 #i‚de‡
DOC_HIDDEN


1292 
SND_DLSYM_BUILD_VERSION
(
¢d_func_¥iv©e_pcm_subdevi˚
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

1318 
	$¢d_func_ª„r
(
¢d_c⁄fig_t
 **
d°
, snd_c⁄fig_à*
roŸ
, snd_c⁄fig_à*
§c
,

1319 
¢d_c⁄fig_t
 *
¥iv©e_d©a
)

1321 
¢d_c⁄fig_t
 *
n
;

1322 c⁄° *
fûe
 = 
NULL
, *
«me
 = NULL;

1323 
îr
;

1325 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
§c
, "fûe", &
n
);

1326 i‡(
îr
 >= 0) {

1327 
îr
 = 
	`¢d_c⁄fig_evÆu©e
(
n
, 
roŸ
, 
¥iv©e_d©a
, 
NULL
);

1328 i‡(
îr
 < 0) {

1329 
	`SNDERR
("errorÉvaluating file");

1330 
_íd
;

1332 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
fûe
);

1333 i‡(
îr
 < 0) {

1334 
	`SNDERR
("file isÇotá string");

1335 
_íd
;

1338 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
§c
, "«me", &
n
);

1339 i‡(
îr
 >= 0) {

1340 
îr
 = 
	`¢d_c⁄fig_evÆu©e
(
n
, 
roŸ
, 
¥iv©e_d©a
, 
NULL
);

1341 i‡(
îr
 < 0) {

1342 
	`SNDERR
("errorÉvaluatingÇame");

1343 
_íd
;

1345 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
«me
);

1346 i‡(
îr
 < 0) {

1347 
	`SNDERR
("name isÇotá string");

1348 
_íd
;

1351 i‡(!
«me
) {

1352 
îr
 = -
EINVAL
;

1353 
	`SNDERR
("name isÇot specified");

1354 
_íd
;

1356 i‡(
fûe
) {

1357 
¢d_öput_t
 *
öput
;

1358 
îr
 = 
	`¢d_öput_°dio_›í
(&
öput
, 
fûe
, "r");

1359 i‡(
îr
 < 0) {

1360 
	`SNDERR
("U«bÀÅÿ›í fûê%s: %s", 
fûe
, 
	`¢d_°ªº‹
(
îr
));

1361 
_íd
;

1363 
îr
 = 
	`¢d_c⁄fig_lﬂd
(
roŸ
, 
öput
);

1364 
	`¢d_öput_˛o£
(
öput
);

1365 i‡(
îr
 < 0)

1366 
_íd
;

1368 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, 
NULL
, 
«me
, 
d°
);

1369 i‡(
îr
 >= 0) {

1370 c⁄° *
id
;

1371 
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
);

1372 i‡(
îr
 >= 0)

1373 
îr
 = 
	`¢d_c⁄fig_£t_id
(*
d°
, 
id
);

1375 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
§c
, "deÁu…", &
n
);

1376 i‡(
îr
 < 0)

1377 
	`SNDERR
("U«bÀÅÿföd deföôi⁄ '%s'", 
«me
);

1379 c⁄° *
id
;

1380 
îr
 = 
	`¢d_c⁄fig_evÆu©e
(
n
, 
roŸ
, 
¥iv©e_d©a
, 
NULL
);

1381 i‡(
îr
 < 0)

1382  
îr
;

1383 i‡((
îr
 = 
	`¢d_c⁄fig_c›y
(
d°
, 
n
)) >= 0) {

1384 i‡((
îr
 = 
	`¢d_c⁄fig_gë_id
(
§c
, &
id
)) < 0 ||

1385 (
îr
 = 
	`¢d_c⁄fig_£t_id
(*
d°
, 
id
)) < 0)

1386 
	`¢d_c⁄fig_dñëe
(*
d°
);

1390 
_íd
:

1391  
îr
;

1392 
	}
}

1393 #i‚de‡
DOC_HIDDEN


1394 
SND_DLSYM_BUILD_VERSION
(
¢d_func_ª„r
, 
SND_CONFIG_DLSYM_VERSION_EVALUATE
);

1397 #i‚de‡
DOC_HIDDEN


1398 
	$_¢d_c⁄f_gíîic_id
(c⁄° *
id
)

1400 c⁄° 
ids
[3][8] = { "comment", "type", "hint" };

1401 
k
;

1402 
k
 = 0; k < (
ids
) / (ids[0]); ++k) {

1403 i‡(
	`°rcmp
(
id
, 
ids
[
k
]) == 0)

1407 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/cards.c

28 
	~"c⁄åﬁ_loˇl.h
"

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<uni°d.h
>

32 
	~<°rög.h
>

33 
	~<˘y≥.h
>

34 
	~<f˙é.h
>

35 
	~<sys/io˘l.h
>

37 #i‚de‡
DOC_HIDDEN


38 
	#SND_FILE_CONTROL
 
ALSA_DEVICE_DIRECTORY
 "c⁄åﬁC%i"

	)

39 
	#SND_FILE_LOAD
 
ALOAD_DEVICE_DIRECTORY
 "ÆﬂdC%i"

	)

42 
	$¢d_ˇrd_lﬂd2
(c⁄° *
c⁄åﬁ
)

44 
›í_dev
;

45 
¢d_˘l_ˇrd_öfo_t
 
öfo
;

47 
›í_dev
 = 
	`¢d_›í_devi˚
(
c⁄åﬁ
, 
O_RDONLY
);

48 i‡(
›í_dev
 >= 0) {

49 i‡(
	`io˘l
(
›í_dev
, 
SNDRV_CTL_IOCTL_CARD_INFO
, &
öfo
) < 0) {

50 
îr
 = -
î∫o
;

51 
	`˛o£
(
›í_dev
);

52  
îr
;

54 
	`˛o£
(
›í_dev
);

55  
öfo
.
ˇrd
;

57  -
î∫o
;

59 
	}
}

61 
	$¢d_ˇrd_lﬂd1
(
ˇrd
)

63 
ªs
;

64 
c⁄åﬁ
[(
SND_FILE_CONTROL
) + 10];

66 
	`•rötf
(
c⁄åﬁ
, 
SND_FILE_CONTROL
, 
ˇrd
);

67 
ªs
 = 
	`¢d_ˇrd_lﬂd2
(
c⁄åﬁ
);

68 #ifde‡
SUPPORT_ALOAD


69 i‡(
ªs
 < 0) {

70 
Æﬂd
[(
SND_FILE_LOAD
) + 10];

71 
	`•rötf
(
Æﬂd
, 
SND_FILE_LOAD
, 
ˇrd
);

72 
ªs
 = 
	`¢d_ˇrd_lﬂd2
(
Æﬂd
);

75  
ªs
;

76 
	}
}

83 
	$¢d_ˇrd_lﬂd
(
ˇrd
)

85  !!(
	`¢d_ˇrd_lﬂd1
(
ˇrd
) >= 0);

86 
	}
}

108 
	$¢d_ˇrd_√xt
(*
rˇrd
)

110 
ˇrd
;

112 i‡(
rˇrd
 =
NULL
)

113  -
EINVAL
;

114 
ˇrd
 = *
rˇrd
;

115 
ˇrd
 = card < 0 ? 0 : card + 1;

116 ; 
ˇrd
 < 
SND_MAX_CARDS
; card++) {

117 i‡(
	`¢d_ˇrd_lﬂd
(
ˇrd
)) {

118 *
rˇrd
 = 
ˇrd
;

122 *
rˇrd
 = -1;

124 
	}
}

140 
	$¢d_ˇrd_gë_ödex
(c⁄° *
°rög
)

142 
ˇrd
, 
îr
;

143 
¢d_˘l_t
 *
h™dÀ
;

144 
¢d_˘l_ˇrd_öfo_t
 
öfo
;

146 i‡(!
°rög
 || *string == '\0')

147  -
EINVAL
;

148 i‡((
	`isdigô
(*
°rög
) && *(string + 1) == 0) ||

149 (
	`isdigô
(*
°rög
) && isdigit(*(string + 1)) && *(string + 2) == 0)) {

151 i‡(
	`ssˇnf
(
°rög
, "%i", &
ˇrd
) != 1)

152  -
EINVAL
;

153 i‡(
ˇrd
 < 0 || c¨d >
SND_MAX_CARDS
)

154  -
EINVAL
;

155 
îr
 = 
	`¢d_ˇrd_lﬂd1
(
ˇrd
);

156 i‡(
îr
 >= 0)

157  
ˇrd
;

158  
îr
;

160 i‡(
°rög
[0] == '/')

162  
	`¢d_ˇrd_lﬂd2
(
°rög
);

164 
ˇrd
 = 0; c¨d < 
SND_MAX_CARDS
; card++) {

165 #ifde‡
SUPPORT_ALOAD


166 i‡(! 
	`¢d_ˇrd_lﬂd
(
ˇrd
))

169 i‡(
	`¢d_˘l_hw_›í
(&
h™dÀ
, 
NULL
, 
ˇrd
, 0) < 0)

171 i‡(
	`¢d_˘l_ˇrd_öfo
(
h™dÀ
, &
öfo
) < 0) {

172 
	`¢d_˘l_˛o£
(
h™dÀ
);

175 
	`¢d_˘l_˛o£
(
h™dÀ
);

176 i‡(!
	`°rcmp
((c⁄° *)
öfo
.
id
, 
°rög
))

177  
ˇrd
;

179  -
ENODEV
;

180 
	}
}

192 
	$¢d_ˇrd_gë_«me
(
ˇrd
, **
«me
)

194 
¢d_˘l_t
 *
h™dÀ
;

195 
¢d_˘l_ˇrd_öfo_t
 
öfo
;

196 
îr
;

198 i‡(
«me
 =
NULL
)

199  -
EINVAL
;

200 i‡((
îr
 = 
	`¢d_˘l_hw_›í
(&
h™dÀ
, 
NULL
, 
ˇrd
, 0)) < 0)

201  
îr
;

202 i‡((
îr
 = 
	`¢d_˘l_ˇrd_öfo
(
h™dÀ
, &
öfo
)) < 0) {

203 
	`¢d_˘l_˛o£
(
h™dÀ
);

204  
îr
;

206 
	`¢d_˘l_˛o£
(
h™dÀ
);

207 *
«me
 = 
	`°rdup
((c⁄° *)
öfo
.name);

208 i‡(*
«me
 =
NULL
)

209  -
ENOMEM
;

211 
	}
}

222 
	$¢d_ˇrd_gë_l⁄g«me
(
ˇrd
, **
«me
)

224 
¢d_˘l_t
 *
h™dÀ
;

225 
¢d_˘l_ˇrd_öfo_t
 
öfo
;

226 
îr
;

228 i‡(
«me
 =
NULL
)

229  -
EINVAL
;

230 i‡((
îr
 = 
	`¢d_˘l_hw_›í
(&
h™dÀ
, 
NULL
, 
ˇrd
, 0)) < 0)

231  
îr
;

232 i‡((
îr
 = 
	`¢d_˘l_ˇrd_öfo
(
h™dÀ
, &
öfo
)) < 0) {

233 
	`¢d_˘l_˛o£
(
h™dÀ
);

234  
îr
;

236 
	`¢d_˘l_˛o£
(
h™dÀ
);

237 *
«me
 = 
	`°rdup
((c⁄° *)
öfo
.
l⁄g«me
);

238 i‡(*
«me
 =
NULL
)

239  -
ENOMEM
;

241 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control.c

188 
	~"c⁄åﬁ_loˇl.h
"

189 
	~<°dio.h
>

190 
	~<°dlib.h
>

191 
	~<°döt.h
>

192 
	~<°d¨g.h
>

193 
	~<uni°d.h
>

194 
	~<°rög.h
>

195 
	~<f˙é.h
>

196 
	~<sig«l.h
>

197 
	~<pﬁl.h
>

198 
	~<°dboﬁ.h
>

199 
	~<limôs.h
>

209 c⁄° *
	$¢d_˘l_«me
(
¢d_˘l_t
 *
˘l
)

211 
	`as£π
(
˘l
);

212  
˘l
->
«me
;

213 
	}
}

222 
¢d_˘l_ty≥_t
 
	$¢d_˘l_ty≥
(
¢d_˘l_t
 *
˘l
)

224 
	`as£π
(
˘l
);

225  
˘l
->
ty≥
;

226 
	}
}

236 
	$¢d_˘l_˛o£
(
¢d_˘l_t
 *
˘l
)

238 
îr
;

239 !
	`li°_em±y
(&
˘l
->
async_h™dÀrs
)) {

240 
¢d_async_h™dÀr_t
 *
h
 = 
	`li°_íåy
(&
˘l
->
async_h™dÀrs
.
√xt
, snd_async_h™dÀr_t, 
hli°
);

241 
	`¢d_async_dñ_h™dÀr
(
h
);

243 
îr
 = 
˘l
->
›s
->
	`˛o£
(ctl);

244 
	`‰ì
(
˘l
->
«me
);

245 
	`¢d_dlobj_ˇche_put
(
˘l
->
›í_func
);

246 
	`‰ì
(
˘l
);

247  
îr
;

248 
	}
}

256 
	$¢d_˘l_n⁄block
(
¢d_˘l_t
 *
˘l
, 
n⁄block
)

258 
îr
;

259 
	`as£π
(
˘l
);

260 
îr
 = 
˘l
->
›s
->
	`n⁄block
(˘l, 
n⁄block
);

261 i‡(
îr
 < 0)

262  
îr
;

263 
˘l
->
n⁄block
 =Çonblock;

265 
	}
}

267 #i‚de‡
DOC_HIDDEN


268 
	$¢d_˘l_√w
(
¢d_˘l_t
 **
˘Õ
, 
¢d_˘l_ty≥_t
 
ty≥
, c⁄° *
«me
, 
mode
)

270 
¢d_˘l_t
 *
˘l
;

271 
˘l
 = 
	`ˇŒoc
(1, (*ctl));

272 i‡(!
˘l
)

273  -
ENOMEM
;

274 
˘l
->
ty≥
 =Åype;

275 
˘l
->
mode
 = mode;

276 i‡(
«me
)

277 
˘l
->
«me
 = 
	`°rdup
(name);

278 
	`INIT_LIST_HEAD
(&
˘l
->
async_h™dÀrs
);

279 *
˘Õ
 = 
˘l
;

281 
	}
}

293 
	$¢d_˘l_async
(
¢d_˘l_t
 *
˘l
, 
sig
, 
pid_t
 
pid
)

295 
	`as£π
(
˘l
);

296 i‡(
sig
 == 0)

297 
sig
 = 
SIGIO
;

298 i‡(
pid
 == 0)

299 
pid
 = 
	`gëpid
();

300  
˘l
->
›s
->
	`async
(˘l, 
sig
, 
pid
);

301 
	}
}

309 
	$¢d_˘l_pﬁl_des¸ùt‹s_cou¡
(
¢d_˘l_t
 *
˘l
)

311 
	`as£π
(
˘l
);

312 i‡(
˘l
->
›s
->
pﬁl_des¸ùt‹s_cou¡
)

313  
˘l
->
›s
->
	`pﬁl_des¸ùt‹s_cou¡
(ctl);

314 i‡(
˘l
->
pﬁl_fd
 < 0)

317 
	}
}

326 
	$¢d_˘l_pﬁl_des¸ùt‹s
(
¢d_˘l_t
 *
˘l
, 
pﬁlfd
 *
pfds
, 
•a˚
)

328 
	`as£π
(
˘l
 && 
pfds
);

329 i‡(
˘l
->
›s
->
pﬁl_des¸ùt‹s
)

330  
˘l
->
›s
->
	`pﬁl_des¸ùt‹s
(˘l, 
pfds
, 
•a˚
);

331 i‡(
˘l
->
pﬁl_fd
 < 0)

333 i‡(
•a˚
 > 0) {

334 
pfds
->
fd
 = 
˘l
->
pﬁl_fd
;

335 
pfds
->
evíts
 = 
POLLIN
|
POLLERR
|
POLLNVAL
;

339 
	}
}

349 
	$¢d_˘l_pﬁl_des¸ùt‹s_ªvíts
(
¢d_˘l_t
 *
˘l
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

351 
	`as£π
(
˘l
 && 
pfds
 && 
ªvíts
);

352 i‡(
˘l
->
›s
->
pﬁl_ªvíts
)

353  
˘l
->
›s
->
	`pﬁl_ªvíts
(˘l, 
pfds
, 
nfds
, 
ªvíts
);

354 i‡(
nfds
 == 1) {

355 *
ªvíts
 = 
pfds
->revents;

358  -
EINVAL
;

359 
	}
}

367 
	$¢d_˘l_subs¸ibe_evíts
(
¢d_˘l_t
 *
˘l
, 
subs¸ibe
)

369 
	`as£π
(
˘l
);

370  
˘l
->
›s
->
	`subs¸ibe_evíts
(˘l, 
subs¸ibe
);

371 
	}
}

385 
	$¢d_˘l_ˇrd_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ˇrd_öfo_t
 *
öfo
)

387 
	`as£π
(
˘l
 && 
öfo
);

388  
˘l
->
›s
->
	`ˇrd_öfo
(˘l, 
öfo
);

389 
	}
}

412 
	$¢d_˘l_ñem_li°
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_li°_t
 *
li°
)

414 
	`as£π
(
˘l
 && 
li°
);

415 
	`as£π
(
li°
->
•a˚
 =0 ||Üi°->
pids
);

416  
˘l
->
›s
->
	`ñemít_li°
(˘l, 
li°
);

417 
	}
}

425 
	$¢d_˘l_ñem_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
)

427 
	`as£π
(
˘l
 && 
öfo
 && (öfo->
id
.
«me
[0] || info->id.
numid
));

428  
˘l
->
›s
->
	`ñemít_öfo
(˘l, 
öfo
);

429 
	}
}

431 #i‚de‡
DOC_HIDDEN


433 
boﬁ
 
	$vÆid©e_ñemít_membî_dimísi⁄
(
¢d_˘l_ñem_öfo_t
 *
öfo
)

435 
membîs
;

436 
i
;

438 i‡(
öfo
->
dimí
.
d
[0] == 0)

439  
åue
;

441 
membîs
 = 1;

442 
i
 = 0; i < 
	`ARRAY_SIZE
(
öfo
->
dimí
.
d
); ++i) {

443 i‡(
öfo
->
dimí
.
d
[
i
] == 0)

445 
membîs
 *
öfo
->
dimí
.
d
[
i
];

447 i‡(
membîs
 > 
öfo
->
cou¡
)

448  
Ál£
;

451 ++
i
; i < 
	`ARRAY_SIZE
(
öfo
->
dimí
.
d
); ++i) {

452 i‡(
öfo
->
dimí
.
d
[
i
] > 0)

453  
Ál£
;

456  
membîs
 =
öfo
->
cou¡
;

457 
	}
}

459 
	#vÆid©e_ñemít_membî_dimísi⁄
(
öfo
Ë
åue


	)

462 
	#USER_ACCESS_DEFAULT
 (\

463 
SNDRV_CTL_ELEM_ACCESS_READWRITE
 |\

464 
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
 |\

465 
SNDRV_CTL_ELEM_ACCESS_USER
)

	)

467 
	#USER_ACCESS_SETTABLE
 (\

468 
SNDRV_CTL_ELEM_ACCESS_READWRITE
 |\

469 
SNDRV_CTL_ELEM_ACCESS_VOLATILE
 |\

470 
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
 |\

471 
SNDRV_CTL_ELEM_ACCESS_INACTIVE
 |\

472 
SNDRV_CTL_ELEM_ACCESS_USER
)

	)

474 
ölöe
 
	$£t_u£r_ac˚ss
(
¢d_˘l_ñem_öfo_t
 *
öfo
)

476 i‡(
öfo
->
ac˚ss
 == 0) {

477 
öfo
->
ac˚ss
 = 
USER_ACCESS_DEFAULT
;

479 i‡((
öfo
->
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_READWRITE
) == 0)

481 i‡(
öfo
->
ac˚ss
 & ~
USER_ACCESS_SETTABLE
)

483 
öfo
->
ac˚ss
 |
SNDRV_CTL_ELEM_ACCESS_USER
;

486 
	}
}

488 
	$__¢d_˘l_add_ñem_£t
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
,

489 
ñemít_cou¡
,

490 
membî_cou¡
)

492 i‡(
˘l
 =
NULL
 || 
öfo
->
id
.
«me
[0] == '\0')

493  -
EINVAL
;

495 i‡(
	`£t_u£r_ac˚ss
(
öfo
))

496  -
EINVAL
;

498 
öfo
->
ow√r
 = 
ñemít_cou¡
;

499 
öfo
->
cou¡
 = 
membî_cou¡
;

501 i‡(!
	`vÆid©e_ñemít_membî_dimísi⁄
(
öfo
))

502  -
EINVAL
;

504  
˘l
->
›s
->
	`ñemít_add
(˘l, 
öfo
);

505 
	}
}

551 
	$¢d_˘l_add_öãgî_ñem_£t
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
,

552 
ñemít_cou¡
,

553 
membî_cou¡
,

554 
mö
, 
max
, 
°ï
)

556 
¢d_˘l_ñem_vÆue_t
 
d©a
 = {0};

557 
i
;

558 
j
;

559 
numid
;

560 
îr
;

562 i‡(
öfo
 =
NULL
)

563  -
EINVAL
;

565 
öfo
->
ty≥
 = 
SND_CTL_ELEM_TYPE_INTEGER
;

566 
öfo
->
vÆue
.
öãgî
.
mö
 = min;

567 
öfo
->
vÆue
.
öãgî
.
max
 = max;

568 
öfo
->
vÆue
.
öãgî
.
°ï
 = step;

570 
îr
 = 
	`__¢d_˘l_add_ñem_£t
(
˘l
, 
öfo
, 
ñemít_cou¡
, 
membî_cou¡
);

571 i‡(
îr
 < 0)

572  
îr
;

573 
numid
 = 
	`¢d_˘l_ñem_id_gë_numid
(&
öfo
->
id
);

576 
d©a
.
id
 = 
öfo
->id;

577 
i
 = 0; i < 
ñemít_cou¡
; i++) {

578 
	`¢d_˘l_ñem_id_£t_numid
(&
d©a
.
id
, 
numid
 + 
i
);

580 
j
 = 0; j < 
membî_cou¡
; j++)

581 
d©a
.
vÆue
.
öãgî
.vÆue[
j
] = 
mö
;

583 
îr
 = 
˘l
->
›s
->
	`ñemít_wrôe
(˘l, &
d©a
);

584 i‡(
îr
 < 0)

585  
îr
;

589 
	}
}

633 
	$¢d_˘l_add_öãgî64_ñem_£t
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
,

634 
ñemít_cou¡
,

635 
membî_cou¡
,

636 
mö
, 
max
, 
°ï
)

638 
¢d_˘l_ñem_vÆue_t
 
d©a
 = {0};

639 
i
;

640 
j
;

641 
numid
;

642 
îr
;

644 i‡(
öfo
 =
NULL
)

645  -
EINVAL
;

647 
öfo
->
ty≥
 = 
SND_CTL_ELEM_TYPE_INTEGER64
;

648 
öfo
->
vÆue
.
öãgî64
.
mö
 = min;

649 
öfo
->
vÆue
.
öãgî64
.
max
 = max;

650 
öfo
->
vÆue
.
öãgî64
.
°ï
 = step;

652 
îr
 = 
	`__¢d_˘l_add_ñem_£t
(
˘l
, 
öfo
, 
ñemít_cou¡
, 
membî_cou¡
);

653 i‡(
îr
 < 0)

654  
îr
;

655 
numid
 = 
	`¢d_˘l_ñem_id_gë_numid
(&
öfo
->
id
);

658 
d©a
.
id
 = 
öfo
->id;

659 
i
 = 0; i < 
ñemít_cou¡
; i++) {

660 
	`¢d_˘l_ñem_id_£t_numid
(&
d©a
.
id
, 
numid
 + 
i
);

662 
j
 = 0; j < 
membî_cou¡
; j++)

663 
d©a
.
vÆue
.
öãgî64
.vÆue[
j
] = 
mö
;

665 
îr
 = 
˘l
->
›s
->
	`ñemít_wrôe
(˘l, &
d©a
);

666 i‡(
îr
 < 0)

667  
îr
;

671 
	}
}

711 
	$¢d_˘l_add_boﬁón_ñem_£t
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
,

712 
ñemít_cou¡
,

713 
membî_cou¡
)

715 i‡(
öfo
 =
NULL
)

716  -
EINVAL
;

718 
öfo
->
ty≥
 = 
SND_CTL_ELEM_TYPE_BOOLEAN
;

719 
öfo
->
vÆue
.
öãgî
.
mö
 = 0;

720 
öfo
->
vÆue
.
öãgî
.
max
 = 1;

722  
	`__¢d_˘l_add_ñem_£t
(
˘l
, 
öfo
, 
ñemít_cou¡
, 
membî_cou¡
);

723 
	}
}

768 
	$¢d_˘l_add_íumî©ed_ñem_£t
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
,

769 
ñemít_cou¡
,

770 
membî_cou¡
,

771 
ôems
,

772 c⁄° *c⁄° 
œbñs
[])

774 
i
, 
byãs
;

775 *
buf
, *
p
;

776 
îr
;

778 i‡(
öfo
 =
NULL
 || 
œbñs
 == NULL)

779  -
EINVAL
;

781 
öfo
->
ty≥
 = 
SND_CTL_ELEM_TYPE_ENUMERATED
;

782 
öfo
->
ow√r
 = 
ñemít_cou¡
;

783 
öfo
->
cou¡
 = 
membî_cou¡
;

784 
öfo
->
vÆue
.
íumî©ed
.
ôems
 = items;

786 
byãs
 = 0;

787 
i
 = 0; i < 
ôems
; ++i)

788 
byãs
 +
	`°æí
(
œbñs
[
i
]) + 1;

789 i‡(
byãs
 == 0)

790  -
EINVAL
;

791 
buf
 = 
	`mÆloc
(
byãs
);

792 i‡(
buf
 =
NULL
)

793  -
ENOMEM
;

794 
öfo
->
vÆue
.
íumî©ed
.
«mes_±r
 = (
uöçå_t
)
buf
;

795 
öfo
->
vÆue
.
íumî©ed
.
«mes_Àngth
 = 
byãs
;

796 
p
 = 
buf
;

797 
i
 = 0; i < 
ôems
; ++i) {

798 
	`°r˝y
(
p
, 
œbñs
[
i
]);

799 
p
 +
	`°æí
(
œbñs
[
i
]) + 1;

802 
îr
 = 
	`__¢d_˘l_add_ñem_£t
(
˘l
, 
öfo
, 
ñemít_cou¡
, 
membî_cou¡
);

804 
	`‰ì
(
buf
);

806  
îr
;

807 
	}
}

848 
	$¢d_˘l_add_byãs_ñem_£t
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
,

849 
ñemít_cou¡
,

850 
membî_cou¡
)

852 i‡(
öfo
 =
NULL
)

853  -
EINVAL
;

855 
öfo
->
ty≥
 = 
SND_CTL_ELEM_TYPE_BYTES
;

857  
	`__¢d_˘l_add_ñem_£t
(
˘l
, 
öfo
, 
ñemít_cou¡
, 
membî_cou¡
);

858 
	}
}

867 
	$¢d_˘l_ñem_add_öãgî
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

868 
membî_cou¡
,

869 
mö
, 
max
, 
°ï
)

871 
¢d_˘l_ñem_öfo_t
 
öfo
 = {0};

873 
	`as£π
(
˘l
 && 
id
 && id->
«me
[0]);

875 
öfo
.
id
 = *id;

877  
	`¢d_˘l_add_öãgî_ñem_£t
(
˘l
, &
öfo
, 1, 
membî_cou¡
,

878 
mö
, 
max
, 
°ï
);

879 
	}
}

888 
	$¢d_˘l_ñem_add_öãgî64
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

889 
membî_cou¡
,

890 
mö
, 
max
, 
°ï
)

892 
¢d_˘l_ñem_öfo_t
 
öfo
 = {0};

894 
	`as£π
(
˘l
 && 
id
 && id->
«me
[0]);

896 
öfo
.
id
 = *id;

898  
	`¢d_˘l_add_öãgî64_ñem_£t
(
˘l
, &
öfo
, 1, 
membî_cou¡
,

899 
mö
, 
max
, 
°ï
);

900 
	}
}

909 
	$¢d_˘l_ñem_add_boﬁón
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

910 
membî_cou¡
)

912 
¢d_˘l_ñem_öfo_t
 
öfo
 = {0};

914 
	`as£π
(
˘l
 && 
id
 && id->
«me
[0]);

916 
öfo
.
id
 = *id;

918  
	`¢d_˘l_add_boﬁón_ñem_£t
(
˘l
, &
öfo
, 1, 
membî_cou¡
);

919 
	}
}

930 
	$¢d_˘l_ñem_add_íumî©ed
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

931 
membî_cou¡
, 
ôems
,

932 c⁄° *c⁄° 
œbñs
[])

934 
¢d_˘l_ñem_öfo_t
 
öfo
 = {0};

936 
	`as£π
(
˘l
 && 
id
 && id->
«me
[0] && 
œbñs
);

938 
öfo
.
id
 = *id;

940  
	`¢d_˘l_add_íumî©ed_ñem_£t
(
˘l
, &
öfo
, 1, 
membî_cou¡
,

941 
ôems
, 
œbñs
);

942 
	}
}

973 
	$¢d_˘l_ñem_add_õc958
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
)

975 
¢d_˘l_ñem_öfo_t
 
öfo
 = {0};

977 
	`as£π
(
˘l
 && 
id
 && id->
«me
[0]);

979 
öfo
.
id
 = *id;

980 
öfo
.
ty≥
 = 
SND_CTL_ELEM_TYPE_IEC958
;

981 
öfo
.
ow√r
 = 1;

982 
öfo
.
cou¡
 = 1;

983  
˘l
->
›s
->
	`ñemít_add
(˘l, &
öfo
);

984 
	}
}

992 
	$¢d_˘l_ñem_ªmove
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_id_t
 *
id
)

994 
	`as£π
(
˘l
 && 
id
 && (id->
«me
[0] || id->
numid
));

995  
˘l
->
›s
->
	`ñemít_ªmove
(˘l, 
id
);

996 
	}
}

1013 
	$¢d_˘l_ñem_ªad
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_vÆue_t
 *
d©a
)

1015 
	`as£π
(
˘l
 && 
d©a
 && (d©a->
id
.
«me
[0] || d©a->id.
numid
));

1016  
˘l
->
›s
->
	`ñemít_ªad
(˘l, 
d©a
);

1017 
	}
}

1034 
	$¢d_˘l_ñem_wrôe
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_vÆue_t
 *
d©a
)

1036 
	`as£π
(
˘l
 && 
d©a
 && (d©a->
id
.
«me
[0] || d©a->id.
numid
));

1037  
˘l
->
›s
->
	`ñemít_wrôe
(˘l, 
d©a
);

1038 
	}
}

1040 
	$¢d_˘l_év_do
(
¢d_˘l_t
 *
˘l
, 
›_Êag
,

1041 c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

1042 *
év
, 
év_size
)

1044 
¢d_˘l_ñem_öfo_t
 *
öfo
 = 
NULL
;

1045 
îr
;

1047 i‡(
id
->
numid
 == 0) {

1048 
öfo
 = 
	`ˇŒoc
(1, (*info));

1049 i‡(
öfo
 =
NULL
)

1050  -
ENOMEM
;

1051 
öfo
->
id
 = *id;

1052 
id
 = &
öfo
->id;

1053 
îr
 = 
	`¢d_˘l_ñem_öfo
(
˘l
, 
öfo
);

1054 i‡(
îr
 < 0)

1055 
__îr
;

1056 i‡(
id
->
numid
 == 0) {

1057 
îr
 = -
ENOENT
;

1058 
__îr
;

1061 
îr
 = 
˘l
->
›s
->
	`ñemít_év
(˘l, 
›_Êag
, 
id
->
numid
, 
év
, 
év_size
);

1062 
__îr
:

1063 i‡(
öfo
)

1064 
	`‰ì
(
öfo
);

1065  
îr
;

1066 
	}
}

1083 
	$¢d_˘l_ñem_év_ªad
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

1084 *
év
, 
év_size
)

1086 
îr
;

1087 
	`as£π
(
˘l
 && 
id
 && (id->
«me
[0] || id->
numid
Ë&& 
év
);

1088 i‡(
év_size
 < 2 * ())

1089  -
EINVAL
;

1095 
év
[
SNDRV_CTL_TLVO_TYPE
] = -1;

1096 
év
[
SNDRV_CTL_TLVO_LEN
] = 0;

1097 
îr
 = 
	`¢d_˘l_év_do
(
˘l
, 0, 
id
, 
év
, 
év_size
);

1098 i‡(
îr
 >0 && 
év
[
SNDRV_CTL_TLVO_TYPE
] == ()-1)

1099 
îr
 = -
ENXIO
;

1100  
îr
;

1101 
	}
}

1120 
	$¢d_˘l_ñem_év_wrôe
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

1121 c⁄° *
év
)

1123 
	`as£π
(
˘l
 && 
id
 && (id->
«me
[0] || id->
numid
Ë&& 
év
);

1124  
	`¢d_˘l_év_do
(
˘l
, 1, 
id
, (*)
év
,

1125 
év
[
SNDRV_CTL_TLVO_LEN
] + 2 * ());

1126 
	}
}

1145 
	$¢d_˘l_ñem_év_comm™d
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

1146 c⁄° *
év
)

1148 
	`as£π
(
˘l
 && 
id
 && (id->
«me
[0] || id->
numid
Ë&& 
év
);

1149  
	`¢d_˘l_év_do
(
˘l
, -1, 
id
, (*)
év
,

1150 
év
[
SNDRV_CTL_TLVO_LEN
] + 2 * ());

1151 
	}
}

1159 
	$¢d_˘l_ñem_lock
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_id_t
 *
id
)

1161 
	`as£π
(
˘l
 && 
id
);

1162  
˘l
->
›s
->
	`ñemít_lock
(˘l, 
id
);

1163 
	}
}

1171 
	$¢d_˘l_ñem_u∆ock
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_id_t
 *
id
)

1173 
	`as£π
(
˘l
 && 
id
);

1174  
˘l
->
›s
->
	`ñemít_u∆ock
(˘l, 
id
);

1175 
	}
}

1183 
	$¢d_˘l_hwdï_√xt_devi˚
(
¢d_˘l_t
 *
˘l
, *
devi˚
)

1185 
	`as£π
(
˘l
 && 
devi˚
);

1186  
˘l
->
›s
->
	`hwdï_√xt_devi˚
(˘l, 
devi˚
);

1187 
	}
}

1195 
	$¢d_˘l_hwdï_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_hwdï_öfo_t
 * 
öfo
)

1197 
	`as£π
(
˘l
 && 
öfo
);

1198  
˘l
->
›s
->
	`hwdï_öfo
(˘l, 
öfo
);

1199 
	}
}

1207 
	$¢d_˘l_pcm_√xt_devi˚
(
¢d_˘l_t
 *
˘l
, * 
devi˚
)

1209 
	`as£π
(
˘l
 && 
devi˚
);

1210  
˘l
->
›s
->
	`pcm_√xt_devi˚
(˘l, 
devi˚
);

1211 
	}
}

1219 
	$¢d_˘l_pcm_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_pcm_öfo_t
 * 
öfo
)

1221 
	`as£π
(
˘l
 && 
öfo
);

1222  
˘l
->
›s
->
	`pcm_öfo
(˘l, 
öfo
);

1223 
	}
}

1231 
	$¢d_˘l_pcm_¥e„r_subdevi˚
(
¢d_˘l_t
 *
˘l
, 
subdev
)

1233 
	`as£π
(
˘l
);

1234  
˘l
->
›s
->
	`pcm_¥e„r_subdevi˚
(˘l, 
subdev
);

1235 
	}
}

1243 
	$¢d_˘l_øwmidi_√xt_devi˚
(
¢d_˘l_t
 *
˘l
, * 
devi˚
)

1245 
	`as£π
(
˘l
 && 
devi˚
);

1246  
˘l
->
›s
->
	`øwmidi_√xt_devi˚
(˘l, 
devi˚
);

1247 
	}
}

1255 
	$¢d_˘l_øwmidi_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_øwmidi_öfo_t
 * 
öfo
)

1257 
	`as£π
(
˘l
 && 
öfo
);

1258  
˘l
->
›s
->
	`øwmidi_öfo
(˘l, 
öfo
);

1259 
	}
}

1267 
	$¢d_˘l_øwmidi_¥e„r_subdevi˚
(
¢d_˘l_t
 *
˘l
, 
subdev
)

1269 
	`as£π
(
˘l
);

1270  
˘l
->
›s
->
	`øwmidi_¥e„r_subdevi˚
(˘l, 
subdev
);

1271 
	}
}

1279 
	$¢d_˘l_ump_√xt_devi˚
(
¢d_˘l_t
 *
˘l
, *
devi˚
)

1281 
	`as£π
(
˘l
 && 
devi˚
);

1282 i‡(
˘l
->
›s
->
ump_√xt_devi˚
)

1283  
˘l
->
›s
->
	`ump_√xt_devi˚
(˘l, 
devi˚
);

1284  -
ENXIO
;

1285 
	}
}

1293 
	$¢d_˘l_ump_ídpoöt_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

1295 
	`as£π
(
˘l
 && 
öfo
);

1296  
˘l
->
›s
->
	`ump_ídpoöt_öfo
(˘l, 
öfo
);

1297 
	}
}

1305 
	$¢d_˘l_ump_block_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_ump_block_öfo_t
 *
öfo
)

1307 
	`as£π
(
˘l
 && 
öfo
);

1308  
˘l
->
›s
->
	`ump_block_öfo
(˘l, 
öfo
);

1309 
	}
}

1317 
	$¢d_˘l_£t_powî_°©e
(
¢d_˘l_t
 *
˘l
, 
°©e
)

1319 
	`as£π
(
˘l
);

1320 i‡(
˘l
->
›s
->
£t_powî_°©e
)

1321  
˘l
->
›s
->
	`£t_powî_°©e
(˘l, 
°©e
);

1322  -
ENXIO
;

1323 
	}
}

1331 
	$¢d_˘l_gë_powî_°©e
(
¢d_˘l_t
 *
˘l
, *
°©e
)

1333 
	`as£π
(
˘l
);

1334 i‡(
˘l
->
›s
->
gë_powî_°©e
)

1335  
˘l
->
›s
->
	`gë_powî_°©e
(˘l, 
°©e
);

1336  -
ENXIO
;

1337 
	}
}

1345 
	$¢d_˘l_ªad
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_evít_t
 *
evít
)

1347 
	`as£π
(
˘l
 && 
evít
);

1348  (
˘l
->
›s
->
ªad
)(˘l, 
evít
);

1349 
	}
}

1357 
	$¢d_˘l_waô
(
¢d_˘l_t
 *
˘l
, 
timeout
)

1359 
pﬁlfd
 *
pfd
;

1360 
ªvíts
;

1361 
≈fds
, 
îr
, 
îr_pﬁl
;

1363 
≈fds
 = 
	`¢d_˘l_pﬁl_des¸ùt‹s_cou¡
(
˘l
);

1364 i‡(
≈fds
 <= 0 ||Çpfds >= 16) {

1365 
	`SNDERR
("InvÆidÖﬁl_fd†%d", 
≈fds
);

1366  -
EIO
;

1368 
pfd
 = 
	`Æloˇ
((*pfdË* 
≈fds
);

1369 
îr
 = 
	`¢d_˘l_pﬁl_des¸ùt‹s
(
˘l
, 
pfd
, 
≈fds
);

1370 i‡(
îr
 < 0)

1371  
îr
;

1372 i‡(
îr
 !
≈fds
) {

1373 
	`SNDMSG
("övÆidÖﬁ»des¸ùt‹†%d", 
îr
);

1374  -
EIO
;

1377 
îr_pﬁl
 = 
	`pﬁl
(
pfd
, 
≈fds
, 
timeout
);

1378 i‡(
îr_pﬁl
 < 0)

1379  -
î∫o
;

1380 i‡(! 
îr_pﬁl
)

1382 
îr
 = 
	`¢d_˘l_pﬁl_des¸ùt‹s_ªvíts
(
˘l
, 
pfd
, 
≈fds
, &
ªvíts
);

1383 i‡(
îr
 < 0)

1384  
îr
;

1385 i‡(
ªvíts
 & (
POLLERR
 | 
POLLNVAL
))

1386  -
EIO
;

1387 i‡(
ªvíts
 & (
POLLIN
 | 
POLLOUT
))

1390 
	}
}

1400 
	$¢d_async_add_˘l_h™dÀr
(
¢d_async_h™dÀr_t
 **
h™dÀr
, 
¢d_˘l_t
 *
˘l
,

1401 
¢d_async_ˇŒback_t
 
ˇŒback
, *
¥iv©e_d©a
)

1403 
îr
;

1404 
was_em±y
;

1405 
¢d_async_h™dÀr_t
 *
h
;

1406 
îr
 = 
	`¢d_async_add_h™dÀr
(&
h
, 
	`_¢d_˘l_async_des¸ùt‹
(
˘l
),

1407 
ˇŒback
, 
¥iv©e_d©a
);

1408 i‡(
îr
 < 0)

1409  
îr
;

1410 
h
->
ty≥
 = 
SND_ASYNC_HANDLER_CTL
;

1411 
h
->
u
.
˘l
 = ctl;

1412 
was_em±y
 = 
	`li°_em±y
(&
˘l
->
async_h™dÀrs
);

1413 
	`li°_add_èû
(&
h
->
hli°
, &
˘l
->
async_h™dÀrs
);

1414 i‡(
was_em±y
) {

1415 
îr
 = 
	`¢d_˘l_async
(
˘l
, 
	`¢d_async_h™dÀr_gë_signo
(
h
), 
	`gëpid
());

1416 i‡(
îr
 < 0) {

1417 
	`¢d_async_dñ_h™dÀr
(
h
);

1418  
îr
;

1421 *
h™dÀr
 = 
h
;

1423 
	}
}

1430 
¢d_˘l_t
 *
	$¢d_async_h™dÀr_gë_˘l
(
¢d_async_h™dÀr_t
 *
h™dÀr
)

1432 
	`as£π
(
h™dÀr
->
ty≥
 =
SND_ASYNC_HANDLER_CTL
);

1433  
h™dÀr
->
u
.
˘l
;

1434 
	}
}

1436 c⁄° *c⁄° 
	gbuûd_ö_˘ls
[] = {

1437 "hw", "em±y", "ªm≠", "shm", 
NULL


1440 
	$¢d_˘l_›í_c⁄f
(
¢d_˘l_t
 **
˘Õ
, c⁄° *
«me
,

1441 
¢d_c⁄fig_t
 *
˘l_roŸ
, snd_c⁄fig_à*
˘l_c⁄f
, 
mode
)

1443 c⁄° *
°r
;

1444 *
buf
 = 
NULL
, *
buf1
 = NULL;

1445 
îr
;

1446 
¢d_c⁄fig_t
 *
c⁄f
, *
ty≥_c⁄f
 = 
NULL
;

1447 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1448 c⁄° *
lib
 = 
NULL
, *
›í_«me
 = NULL;

1449 c⁄° *
id
;

1450 (*
›í_func
)(
¢d_˘l_t
 **, c⁄° *, 
¢d_c⁄fig_t
 *, snd_c⁄fig_à*, Ë
NULL
;

1451 #i‚de‡
PIC


1452 *
	`¢d_c⁄åﬁ_›í_symbﬁs
();

1454 i‡(
	`¢d_c⁄fig_gë_ty≥
(
˘l_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1455 i‡(
«me
)

1456 
	`SNDERR
("InvÆidÅy≥ f‹ CTL %†deföôi⁄", 
«me
);

1458 
	`SNDERR
("InvalidÅype for CTL definition");

1459  -
EINVAL
;

1461 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
˘l_c⁄f
, "ty≥", &
c⁄f
);

1462 i‡(
îr
 < 0) {

1463 
	`SNDERR
("type isÇot defined");

1464  
îr
;

1466 
îr
 = 
	`¢d_c⁄fig_gë_id
(
c⁄f
, &
id
);

1467 i‡(
îr
 < 0) {

1468 
	`SNDERR
("unableÅo get id");

1469  
îr
;

1471 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
c⁄f
, &
°r
);

1472 i‡(
îr
 < 0) {

1473 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1474  
îr
;

1476 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
˘l_roŸ
, "˘l_ty≥", 
°r
, &
ty≥_c⁄f
);

1477 i‡(
îr
 >= 0) {

1478 i‡(
	`¢d_c⁄fig_gë_ty≥
(
ty≥_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1479 
	`SNDERR
("InvÆidÅy≥ f‹ CTLÅy≥ %†deföôi⁄", 
°r
);

1480 
îr
 = -
EINVAL
;

1481 
_îr
;

1483 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
ty≥_c⁄f
) {

1484 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1485 c⁄° *
id
;

1486 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1488 i‡(
	`°rcmp
(
id
, "comment") == 0)

1490 i‡(
	`°rcmp
(
id
, "lib") == 0) {

1491 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
lib
);

1492 i‡(
îr
 < 0) {

1493 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1494 
_îr
;

1498 i‡(
	`°rcmp
(
id
, "open") == 0) {

1499 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
›í_«me
);

1500 i‡(
îr
 < 0) {

1501 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1502 
_îr
;

1506 
	`SNDERR
("Unknow¿fõld %s", 
id
);

1507 
îr
 = -
EINVAL
;

1508 
_îr
;

1511 i‡(!
›í_«me
) {

1512 
buf
 = 
	`mÆloc
(
	`°æí
(
°r
) + 32);

1513 i‡(
buf
 =
NULL
) {

1514 
îr
 = -
ENOMEM
;

1515 
_îr
;

1517 
›í_«me
 = 
buf
;

1518 
	`•rötf
(
buf
, "_¢d_˘l_%s_›í", 
°r
);

1520 i‡(!
lib
) {

1521 c⁄° *c⁄° *
buûd_ö
 = 
buûd_ö_˘ls
;

1522 *
buûd_ö
) {

1523 i‡(!
	`°rcmp
(*
buûd_ö
, 
°r
))

1525 
buûd_ö
++;

1527 i‡(*
buûd_ö
 =
NULL
) {

1528 
buf1
 = 
	`mÆloc
(
	`°æí
(
°r
) + 32);

1529 i‡(
buf1
 =
NULL
) {

1530 
îr
 = -
ENOMEM
;

1531 
_îr
;

1533 
lib
 = 
buf1
;

1534 
	`•rötf
(
buf1
, "libasound_moduÀ_˘l_%s.so", 
°r
);

1537 #i‚de‡
PIC


1538 
	`¢d_c⁄åﬁ_›í_symbﬁs
();

1540 
›í_func
 = 
	`¢d_dlobj_ˇche_gë
(
lib
, 
›í_«me
,

1541 
	`SND_DLSYM_VERSION
(
SND_CONTROL_DLSYM_VERSION
), 1);

1542 i‡(
›í_func
) {

1543 
îr
 = 
	`›í_func
(
˘Õ
, 
«me
, 
˘l_roŸ
, 
˘l_c⁄f
, 
mode
);

1544 i‡(
îr
 >= 0) {

1545 (*
˘Õ
)->
›í_func
 = open_func;

1546 
îr
 = 0;

1548 
	`¢d_dlobj_ˇche_put
(
›í_func
);

1551 
îr
 = -
ENXIO
;

1553 
_îr
:

1554 i‡(
ty≥_c⁄f
)

1555 
	`¢d_c⁄fig_dñëe
(
ty≥_c⁄f
);

1556 
	`‰ì
(
buf
);

1557 
	`‰ì
(
buf1
);

1558  
îr
;

1559 
	}
}

1561 
	$¢d_˘l_›í_noupd©e
(
¢d_˘l_t
 **
˘Õ
, 
¢d_c⁄fig_t
 *
roŸ
,

1562 c⁄° *
«me
, 
mode
, 
h›
)

1564 
îr
;

1565 
¢d_c⁄fig_t
 *
˘l_c⁄f
;

1566 c⁄° *
°r
;

1568 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "˘l", 
«me
, &
˘l_c⁄f
);

1569 i‡(
îr
 < 0) {

1570 
	`SNDERR
("InvÆid CTL %s", 
«me
);

1571  
îr
;

1573 i‡(
	`¢d_c⁄fig_gë_°rög
(
˘l_c⁄f
, &
°r
) >= 0)

1574 
îr
 = 
	`¢d_˘l_›í_noupd©e
(
˘Õ
, 
roŸ
, 
°r
, 
mode
, 
h›
 + 1);

1576 
	`¢d_c⁄fig_£t_h›
(
˘l_c⁄f
, 
h›
);

1577 
îr
 = 
	`¢d_˘l_›í_c⁄f
(
˘Õ
, 
«me
, 
roŸ
, 
˘l_c⁄f
, 
mode
);

1579 
	`¢d_c⁄fig_dñëe
(
˘l_c⁄f
);

1580  
îr
;

1581 
	}
}

1583 #i‚de‡
DOC_HIDDEN


1584 
	$_¢d_˘l_›í_«med_chûd
(
¢d_˘l_t
 **
p˘l
, c⁄° *
«me
,

1585 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

1586 
mode
, 
¢d_c⁄fig_t
 *
∑ª¡_c⁄f
)

1588 c⁄° *
°r
;

1589 
h›
;

1591 i‡((
h›
 = 
	`¢d_c⁄fig_check_h›
(
∑ª¡_c⁄f
)) < 0)

1592  
h›
;

1593 i‡(
	`¢d_c⁄fig_gë_°rög
(
c⁄f
, &
°r
) >= 0)

1594  
	`¢d_˘l_›í_noupd©e
(
p˘l
, 
roŸ
, 
°r
, 
mode
, 
h›
 + 1);

1595  
	`¢d_˘l_›í_c⁄f
(
p˘l
, 
«me
, 
roŸ
, 
c⁄f
, 
mode
);

1596 
	}
}

1608 
	$¢d_˘l_›í
(
¢d_˘l_t
 **
˘Õ
, c⁄° *
«me
, 
mode
)

1610 
¢d_c⁄fig_t
 *
t›
;

1611 
îr
;

1613 
	`as£π
(
˘Õ
 && 
«me
);

1614 i‡(
	`_¢d_is_ucm_devi˚
(
«me
)) {

1615 
«me
 = 
	`uc_mgr_Æibcfg_by_devi˚
(&
t›
,Çame);

1616 i‡(
«me
 =
NULL
)

1617  -
ENODEV
;

1619 
îr
 = 
	`¢d_c⁄fig_upd©e_ªf
(&
t›
);

1620 i‡(
îr
 < 0)

1621  
îr
;

1623 
îr
 = 
	`¢d_˘l_›í_noupd©e
(
˘Õ
, 
t›
, 
«me
, 
mode
, 0);

1624 
	`¢d_c⁄fig_uƒef
(
t›
);

1625  
îr
;

1626 
	}
}

1636 
	$¢d_˘l_›í_lc⁄f
(
¢d_˘l_t
 **
˘Õ
, c⁄° *
«me
,

1637 
mode
, 
¢d_c⁄fig_t
 *
lc⁄f
)

1639 
	`as£π
(
˘Õ
 && 
«me
 && 
lc⁄f
);

1640  
	`¢d_˘l_›í_noupd©e
(
˘Õ
, 
lc⁄f
, 
«me
, 
mode
, 0);

1641 
	}
}

1652 
	$¢d_˘l_›í_ÁŒback
(
¢d_˘l_t
 **
˘Õ
, 
¢d_c⁄fig_t
 *
roŸ
,

1653 c⁄° *
«me
, c⁄° *
‹ig_«me
, 
mode
)

1655 
îr
;

1656 
	`as£π
(
˘Õ
 && 
«me
 && 
roŸ
);

1657 
îr
 = 
	`¢d_˘l_›í_noupd©e
(
˘Õ
, 
roŸ
, 
«me
, 
mode
, 0);

1658 i‡(
îr
 >= 0) {

1659 
	`‰ì
((*
˘Õ
)->
«me
);

1660 (*
˘Õ
)->
«me
 = 
‹ig_«me
 ? 
	`°rdup
(‹ig_«meË: 
NULL
;

1662  
îr
;

1663 
	}
}

1665 #i‚de‡
DOC_HIDDEN


1666 
	#TYPE
(
v
Ë[
SND_CTL_ELEM_TYPE_
##v] = #v

	)

1667 
	#IFACE
(
v
Ë[
SND_CTL_ELEM_IFACE_
##v] = #v

	)

1668 
	#IFACE1
(
v
, 
n
Ë[
SND_CTL_ELEM_IFACE_
##v] = #n

	)

1669 
	#EVENT
(
v
Ë[
SND_CTL_EVENT_
##v] = #v

	)

1671 c⁄° *c⁄° 
	g¢d_˘l_ñem_ty≥_«mes
[] = {

1672 
TYPE
(
NONE
),

1673 
TYPE
(
BOOLEAN
),

1674 
TYPE
(
INTEGER
),

1675 
TYPE
(
ENUMERATED
),

1676 
TYPE
(
BYTES
),

1677 
TYPE
(
IEC958
),

1678 
TYPE
(
INTEGER64
),

1681 c⁄° *c⁄° 
	g¢d_˘l_ñem_iÁ˚_«mes
[] = {

1682 
IFACE
(
CARD
),

1683 
IFACE
(
HWDEP
),

1684 
IFACE
(
MIXER
),

1685 
IFACE
(
PCM
),

1686 
IFACE
(
RAWMIDI
),

1687 
IFACE
(
TIMER
),

1688 
IFACE
(
SEQUENCER
),

1691 c⁄° *c⁄° 
	g¢d_˘l_evít_ty≥_«mes
[] = {

1692 
EVENT
(
ELEM
),

1701 c⁄° *
	$¢d_˘l_ñem_ty≥_«me
(
¢d_˘l_ñem_ty≥_t
 
ty≥
)

1703 
	`as£π
(
ty≥
 <
SND_CTL_ELEM_TYPE_LAST
);

1704  
¢d_˘l_ñem_ty≥_«mes
[
ty≥
];

1705 
	}
}

1712 c⁄° *
	$¢d_˘l_ñem_iÁ˚_«me
(
¢d_˘l_ñem_iÁ˚_t
 
iÁ˚
)

1714 
	`as£π
(
iÁ˚
 <
SND_CTL_ELEM_IFACE_LAST
);

1715  
¢d_˘l_ñem_iÁ˚_«mes
[
iÁ˚
];

1716 
	}
}

1723 c⁄° *
	$¢d_˘l_evít_ty≥_«me
(
¢d_˘l_evít_ty≥_t
 
ty≥
)

1725 
	`as£π
(
ty≥
 <
SND_CTL_EVENT_LAST
);

1726  
¢d_˘l_evít_ty≥_«mes
[
ty≥
];

1727 
	}
}

1740 
	$¢d_˘l_ñem_li°_Æloc_•a˚
(
¢d_˘l_ñem_li°_t
 *
obj
, 
íåõs
)

1742 
	`‰ì
(
obj
->
pids
);

1743 
obj
->
pids
 = 
	`ˇŒoc
(
íåõs
, (*obj->pids));

1744 i‡(!
obj
->
pids
) {

1745 
obj
->
•a˚
 = 0;

1746  -
ENOMEM
;

1748 
obj
->
•a˚
 = 
íåõs
;

1750 
	}
}

1760 
	$¢d_˘l_ñem_li°_‰ì_•a˚
(
¢d_˘l_ñem_li°_t
 *
obj
)

1762 
	`‰ì
(
obj
->
pids
);

1763 
obj
->
pids
 = 
NULL
;

1764 
obj
->
•a˚
 = 0;

1765 
	}
}

1772 
	$¢d_˘l_evít_ñem_gë_mask
(c⁄° 
¢d_˘l_evít_t
 *
obj
)

1774 
	`as£π
(
obj
);

1775 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_EVENT_ELEM
);

1776  
obj
->
d©a
.
ñem
.
mask
;

1777 
	}
}

1784 
	$¢d_˘l_evít_ñem_gë_id
(c⁄° 
¢d_˘l_evít_t
 *
obj
, 
¢d_˘l_ñem_id_t
 *
±r
)

1786 
	`as£π
(
obj
 && 
±r
);

1787 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_EVENT_ELEM
);

1788 *
±r
 = 
obj
->
d©a
.
ñem
.
id
;

1789 
	}
}

1796 
	$¢d_˘l_evít_ñem_gë_numid
(c⁄° 
¢d_˘l_evít_t
 *
obj
)

1798 
	`as£π
(
obj
);

1799 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_EVENT_ELEM
);

1800  
obj
->
d©a
.
ñem
.
id
.
numid
;

1801 
	}
}

1808 
¢d_˘l_ñem_iÁ˚_t
 
	$¢d_˘l_evít_ñem_gë_öãrÁ˚
(c⁄° 
¢d_˘l_evít_t
 *
obj
)

1810 
	`as£π
(
obj
);

1811 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_EVENT_ELEM
);

1812  
obj
->
d©a
.
ñem
.
id
.
iÁ˚
;

1813 
	}
}

1820 
	$¢d_˘l_evít_ñem_gë_devi˚
(c⁄° 
¢d_˘l_evít_t
 *
obj
)

1822 
	`as£π
(
obj
);

1823 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_EVENT_ELEM
);

1824  
obj
->
d©a
.
ñem
.
id
.
devi˚
;

1825 
	}
}

1832 
	$¢d_˘l_evít_ñem_gë_subdevi˚
(c⁄° 
¢d_˘l_evít_t
 *
obj
)

1834 
	`as£π
(
obj
);

1835 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_EVENT_ELEM
);

1836  
obj
->
d©a
.
ñem
.
id
.
subdevi˚
;

1837 
	}
}

1844 c⁄° *
	$¢d_˘l_evít_ñem_gë_«me
(c⁄° 
¢d_˘l_evít_t
 *
obj
)

1846 
	`as£π
(
obj
);

1847 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_EVENT_ELEM
);

1848  (c⁄° *)
obj
->
d©a
.
ñem
.
id
.
«me
;

1849 
	}
}

1856 
	$¢d_˘l_evít_ñem_gë_ödex
(c⁄° 
¢d_˘l_evít_t
 *
obj
)

1858 
	`as£π
(
obj
);

1859 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_EVENT_ELEM
);

1860  
obj
->
d©a
.
ñem
.
id
.
ödex
;

1861 
	}
}

1863 #i‚de‡
DOC_HIDDEN


1864 
	$_¢d_˘l_pﬁl_des¸ùt‹
(
¢d_˘l_t
 *
˘l
)

1866 
	`as£π
(
˘l
);

1867  
˘l
->
pﬁl_fd
;

1868 
	}
}

1875 
size_t
 
	$¢d_˘l_ñem_id_sizeof
()

1877  (
¢d_˘l_ñem_id_t
);

1878 
	}
}

1885 
	$¢d_˘l_ñem_id_mÆloc
(
¢d_˘l_ñem_id_t
 **
±r
)

1887 
	`as£π
(
±r
);

1888 *
±r
 = 
	`ˇŒoc
(1, (
¢d_˘l_ñem_id_t
));

1889 i‡(!*
±r
)

1890  -
ENOMEM
;

1892 
	}
}

1898 
	$¢d_˘l_ñem_id_‰ì
(
¢d_˘l_ñem_id_t
 *
obj
)

1900 
	`‰ì
(
obj
);

1901 
	}
}

1907 
	$¢d_˘l_ñem_id_˛ór
(
¢d_˘l_ñem_id_t
 *
obj
)

1909 
	`mem£t
(
obj
, 0, (
¢d_˘l_ñem_id_t
));

1910 
	}
}

1917 
	$¢d_˘l_ñem_id_c›y
(
¢d_˘l_ñem_id_t
 *
d°
, c⁄° snd_˘l_ñem_id_à*
§c
)

1919 
	`as£π
(
d°
 && 
§c
);

1920 *
d°
 = *
§c
;

1921 
	}
}

1934 
	$¢d_˘l_ñem_id_com∑ª_numid
(c⁄° 
¢d_˘l_ñem_id_t
 *
id1
, c⁄° snd_˘l_ñem_id_à*
id2
)

1936 
öt64_t
 
d
;

1938 
	`as£π
(
id1
 && 
id2
);

1939 
d
 = (
öt64_t
)
id1
->
numid
 - (öt64_t)
id2
->numid;

1940 i‡(
d
 & ((
öt64_t
)
INT_MAX
 + 1)) {

1941 i‡(
d
 > 
INT_MAX
)

1942 
d
 = 
INT_MAX
;

1943 i‡(
d
 < 
INT_MIN
)

1944 
d
 = 
INT_MIN
;

1946  
d
;

1947 
	}
}

1964 
	$¢d_˘l_ñem_id_com∑ª_£t
(c⁄° 
¢d_˘l_ñem_id_t
 *
id1
, c⁄° snd_˘l_ñem_id_à*
id2
)

1966 
d
;

1968 
	`as£π
(
id1
 && 
id2
);

1971 
	`as£π
((
id1
->
iÁ˚
 | id1->
devi˚
 | id1->
subdevi˚
 | id1->
ödex
Ë<
INT_MAX
);

1972 
	`as£π
((
id2
->
iÁ˚
 | id2->
devi˚
 | id2->
subdevi˚
 | 
id1
->
ödex
Ë<
INT_MAX
);

1973 
d
 = 
id1
->
iÁ˚
 - 
id2
->iface;

1974 i‡(
d
 != 0)

1975  
d
;

1976 
d
 = 
id1
->
devi˚
 - 
id2
->device;

1977 i‡(
d
 != 0)

1978  
d
;

1979 
d
 = 
id1
->
subdevi˚
 - 
id2
->subdevice;

1980 i‡(
d
 != 0)

1981  
d
;

1982 
d
 = 
	`°rcmp
((c⁄° *)
id1
->
«me
, (c⁄° *)
id2
->name);

1983 i‡(
d
 != 0)

1984  
d
;

1985  
id1
->
ödex
 - 
id2
->index;

1986 
	}
}

1993 
	$¢d_˘l_ñem_id_gë_numid
(c⁄° 
¢d_˘l_ñem_id_t
 *
obj
)

1995 
	`as£π
(
obj
);

1996  
obj
->
numid
;

1997 
	}
}

2004 
¢d_˘l_ñem_iÁ˚_t
 
	$¢d_˘l_ñem_id_gë_öãrÁ˚
(c⁄° 
¢d_˘l_ñem_id_t
 *
obj
)

2006 
	`as£π
(
obj
);

2007  
obj
->
iÁ˚
;

2008 
	}
}

2015 
	$¢d_˘l_ñem_id_gë_devi˚
(c⁄° 
¢d_˘l_ñem_id_t
 *
obj
)

2017 
	`as£π
(
obj
);

2018  
obj
->
devi˚
;

2019 
	}
}

2026 
	$¢d_˘l_ñem_id_gë_subdevi˚
(c⁄° 
¢d_˘l_ñem_id_t
 *
obj
)

2028 
	`as£π
(
obj
);

2029  
obj
->
subdevi˚
;

2030 
	}
}

2037 c⁄° *
	$¢d_˘l_ñem_id_gë_«me
(c⁄° 
¢d_˘l_ñem_id_t
 *
obj
)

2039 
	`as£π
(
obj
);

2040  (c⁄° *)
obj
->
«me
;

2041 
	}
}

2048 
	$¢d_˘l_ñem_id_gë_ödex
(c⁄° 
¢d_˘l_ñem_id_t
 *
obj
)

2050 
	`as£π
(
obj
);

2051  
obj
->
ödex
;

2052 
	}
}

2059 
	$¢d_˘l_ñem_id_£t_numid
(
¢d_˘l_ñem_id_t
 *
obj
, 
vÆ
)

2061 
	`as£π
(
obj
);

2062 
obj
->
numid
 = 
vÆ
;

2063 
	}
}

2070 
	$¢d_˘l_ñem_id_£t_öãrÁ˚
(
¢d_˘l_ñem_id_t
 *
obj
, 
¢d_˘l_ñem_iÁ˚_t
 
vÆ
)

2072 
	`as£π
(
obj
);

2073 
obj
->
iÁ˚
 = 
vÆ
;

2074 
	}
}

2081 
	$¢d_˘l_ñem_id_£t_devi˚
(
¢d_˘l_ñem_id_t
 *
obj
, 
vÆ
)

2083 
	`as£π
(
obj
);

2084 
obj
->
devi˚
 = 
vÆ
;

2085 
	}
}

2092 
	$¢d_˘l_ñem_id_£t_subdevi˚
(
¢d_˘l_ñem_id_t
 *
obj
, 
vÆ
)

2094 
	`as£π
(
obj
);

2095 
obj
->
subdevi˚
 = 
vÆ
;

2096 
	}
}

2103 
	$¢d_˘l_ñem_id_£t_«me
(
¢d_˘l_ñem_id_t
 *
obj
, c⁄° *
vÆ
)

2105 
	`as£π
(
obj
);

2106 
	`¢d_°æ˝y
((*)
obj
->
«me
, 
vÆ
, (obj->name));

2107 
	}
}

2114 
	$¢d_˘l_ñem_id_£t_ödex
(
¢d_˘l_ñem_id_t
 *
obj
, 
vÆ
)

2116 
	`as£π
(
obj
);

2117 
obj
->
ödex
 = 
vÆ
;

2118 
	}
}

2124 
size_t
 
	$¢d_˘l_ˇrd_öfo_sizeof
()

2126  (
¢d_˘l_ˇrd_öfo_t
);

2127 
	}
}

2141 
	$¢d_˘l_ˇrd_öfo_mÆloc
(
¢d_˘l_ˇrd_öfo_t
 **
±r
)

2143 
	`as£π
(
±r
);

2144 *
±r
 = 
	`ˇŒoc
(1, (
¢d_˘l_ˇrd_öfo_t
));

2145 i‡(!*
±r
)

2146  -
ENOMEM
;

2148 
	}
}

2156 
	$¢d_˘l_ˇrd_öfo_‰ì
(
¢d_˘l_ˇrd_öfo_t
 *
obj
)

2158 
	`‰ì
(
obj
);

2159 
	}
}

2168 
	$¢d_˘l_ˇrd_öfo_˛ór
(
¢d_˘l_ˇrd_öfo_t
 *
obj
)

2170 
	`mem£t
(
obj
, 0, (
¢d_˘l_ˇrd_öfo_t
));

2171 
	}
}

2179 
	$¢d_˘l_ˇrd_öfo_c›y
(
¢d_˘l_ˇrd_öfo_t
 *
d°
, c⁄° snd_˘l_ˇrd_öfo_à*
§c
)

2181 
	`as£π
(
d°
 && 
§c
);

2182 *
d°
 = *
§c
;

2183 
	}
}

2193 
	$¢d_˘l_ˇrd_öfo_gë_ˇrd
(c⁄° 
¢d_˘l_ˇrd_öfo_t
 *
obj
)

2195 
	`as£π
(
obj
);

2196  
obj
->
ˇrd
;

2197 
	}
}

2207 c⁄° *
	$¢d_˘l_ˇrd_öfo_gë_id
(c⁄° 
¢d_˘l_ˇrd_öfo_t
 *
obj
)

2209 
	`as£π
(
obj
);

2210  (c⁄° *)
obj
->
id
;

2211 
	}
}

2221 c⁄° *
	$¢d_˘l_ˇrd_öfo_gë_drivî
(c⁄° 
¢d_˘l_ˇrd_öfo_t
 *
obj
)

2223 
	`as£π
(
obj
);

2224  (c⁄° *)
obj
->
drivî
;

2225 
	}
}

2235 c⁄° *
	$¢d_˘l_ˇrd_öfo_gë_«me
(c⁄° 
¢d_˘l_ˇrd_öfo_t
 *
obj
)

2237 
	`as£π
(
obj
);

2238  (c⁄° *)
obj
->
«me
;

2239 
	}
}

2249 c⁄° *
	$¢d_˘l_ˇrd_öfo_gë_l⁄g«me
(c⁄° 
¢d_˘l_ˇrd_öfo_t
 *
obj
)

2251 
	`as£π
(
obj
);

2252  (c⁄° *)
obj
->
l⁄g«me
;

2253 
	}
}

2263 c⁄° *
	$¢d_˘l_ˇrd_öfo_gë_mixî«me
(c⁄° 
¢d_˘l_ˇrd_öfo_t
 *
obj
)

2265 
	`as£π
(
obj
);

2266  (c⁄° *)
obj
->
mixî«me
;

2267 
	}
}

2277 c⁄° *
	$¢d_˘l_ˇrd_öfo_gë_comp⁄íts
(c⁄° 
¢d_˘l_ˇrd_öfo_t
 *
obj
)

2279 
	`as£π
(
obj
);

2280  (c⁄° *)
obj
->
comp⁄íts
;

2281 
	}
}

2287 
size_t
 
	$¢d_˘l_evít_sizeof
()

2289  (
¢d_˘l_evít_t
);

2290 
	}
}

2297 
	$¢d_˘l_evít_mÆloc
(
¢d_˘l_evít_t
 **
±r
)

2299 
	`as£π
(
±r
);

2300 *
±r
 = 
	`ˇŒoc
(1, (
¢d_˘l_evít_t
));

2301 i‡(!*
±r
)

2302  -
ENOMEM
;

2304 
	}
}

2310 
	$¢d_˘l_evít_‰ì
(
¢d_˘l_evít_t
 *
obj
)

2312 
	`‰ì
(
obj
);

2313 
	}
}

2319 
	$¢d_˘l_evít_˛ór
(
¢d_˘l_evít_t
 *
obj
)

2321 
	`mem£t
(
obj
, 0, (
¢d_˘l_evít_t
));

2322 
	}
}

2329 
	$¢d_˘l_evít_c›y
(
¢d_˘l_evít_t
 *
d°
, c⁄° snd_˘l_evít_à*
§c
)

2331 
	`as£π
(
d°
 && 
§c
);

2332 *
d°
 = *
§c
;

2333 
	}
}

2340 
¢d_˘l_evít_ty≥_t
 
	$¢d_˘l_evít_gë_ty≥
(c⁄° 
¢d_˘l_evít_t
 *
obj
)

2342 
	`as£π
(
obj
);

2343  
obj
->
ty≥
;

2344 
	}
}

2350 
size_t
 
	$¢d_˘l_ñem_li°_sizeof
()

2352  (
¢d_˘l_ñem_li°_t
);

2353 
	}
}

2363 
	$¢d_˘l_ñem_li°_mÆloc
(
¢d_˘l_ñem_li°_t
 **
±r
)

2365 
	`as£π
(
±r
);

2366 *
±r
 = 
	`ˇŒoc
(1, (
¢d_˘l_ñem_li°_t
));

2367 i‡(!*
±r
)

2368  -
ENOMEM
;

2370 
	}
}

2384 
	$¢d_˘l_ñem_li°_‰ì
(
¢d_˘l_ñem_li°_t
 *
obj
)

2386 
	`‰ì
(
obj
);

2387 
	}
}

2401 
	$¢d_˘l_ñem_li°_˛ór
(
¢d_˘l_ñem_li°_t
 *
obj
)

2403 
	`mem£t
(
obj
, 0, (
¢d_˘l_ñem_li°_t
));

2404 
	}
}

2415 
	$¢d_˘l_ñem_li°_c›y
(
¢d_˘l_ñem_li°_t
 *
d°
, c⁄° snd_˘l_ñem_li°_à*
§c
)

2417 
	`as£π
(
d°
 && 
§c
);

2418 *
d°
 = *
§c
;

2419 
	}
}

2426 
	$¢d_˘l_ñem_li°_£t_off£t
(
¢d_˘l_ñem_li°_t
 *
obj
, 
vÆ
)

2428 
	`as£π
(
obj
);

2429 
obj
->
off£t
 = 
vÆ
;

2430 
	}
}

2443 
	$¢d_˘l_ñem_li°_gë_u£d
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
)

2445 
	`as£π
(
obj
);

2446  
obj
->
u£d
;

2447 
	}
}

2461 
	$¢d_˘l_ñem_li°_gë_cou¡
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
)

2463 
	`as£π
(
obj
);

2464  
obj
->
cou¡
;

2465 
	}
}

2473 
	$¢d_˘l_ñem_li°_gë_id
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
, 
idx
, 
¢d_˘l_ñem_id_t
 *
±r
)

2475 
	`as£π
(
obj
 && 
±r
);

2476 
	`as£π
(
idx
 < 
obj
->
u£d
);

2477 *
±r
 = 
obj
->
pids
[
idx
];

2478 
	}
}

2486 
	$¢d_˘l_ñem_li°_gë_numid
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
, 
idx
)

2488 
	`as£π
(
obj
);

2489 
	`as£π
(
idx
 < 
obj
->
u£d
);

2490  
obj
->
pids
[
idx
].
numid
;

2491 
	}
}

2499 
¢d_˘l_ñem_iÁ˚_t
 
	$¢d_˘l_ñem_li°_gë_öãrÁ˚
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
, 
idx
)

2501 
	`as£π
(
obj
);

2502 
	`as£π
(
idx
 < 
obj
->
u£d
);

2503  
obj
->
pids
[
idx
].
iÁ˚
;

2504 
	}
}

2512 
	$¢d_˘l_ñem_li°_gë_devi˚
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
, 
idx
)

2514 
	`as£π
(
obj
);

2515 
	`as£π
(
idx
 < 
obj
->
u£d
);

2516  
obj
->
pids
[
idx
].
devi˚
;

2517 
	}
}

2525 
	$¢d_˘l_ñem_li°_gë_subdevi˚
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
, 
idx
)

2527 
	`as£π
(
obj
);

2528 
	`as£π
(
idx
 < 
obj
->
u£d
);

2529  
obj
->
pids
[
idx
].
subdevi˚
;

2530 
	}
}

2538 c⁄° *
	$¢d_˘l_ñem_li°_gë_«me
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
, 
idx
)

2540 
	`as£π
(
obj
);

2541 
	`as£π
(
idx
 < 
obj
->
u£d
);

2542  (c⁄° *)
obj
->
pids
[
idx
].
«me
;

2543 
	}
}

2551 
	$¢d_˘l_ñem_li°_gë_ödex
(c⁄° 
¢d_˘l_ñem_li°_t
 *
obj
, 
idx
)

2553 
	`as£π
(
obj
);

2554 
	`as£π
(
idx
 < 
obj
->
u£d
);

2555  
obj
->
pids
[
idx
].
ödex
;

2556 
	}
}

2562 
size_t
 
	$¢d_˘l_ñem_öfo_sizeof
()

2564  (
¢d_˘l_ñem_öfo_t
);

2565 
	}
}

2572 
	$¢d_˘l_ñem_öfo_mÆloc
(
¢d_˘l_ñem_öfo_t
 **
±r
)

2574 
	`as£π
(
±r
);

2575 *
±r
 = 
	`ˇŒoc
(1, (
¢d_˘l_ñem_öfo_t
));

2576 i‡(!*
±r
)

2577  -
ENOMEM
;

2579 
	}
}

2585 
	$¢d_˘l_ñem_öfo_‰ì
(
¢d_˘l_ñem_öfo_t
 *
obj
)

2587 
	`‰ì
(
obj
);

2588 
	}
}

2594 
	$¢d_˘l_ñem_öfo_˛ór
(
¢d_˘l_ñem_öfo_t
 *
obj
)

2596 
	`mem£t
(
obj
, 0, (
¢d_˘l_ñem_öfo_t
));

2597 
	}
}

2604 
	$¢d_˘l_ñem_öfo_c›y
(
¢d_˘l_ñem_öfo_t
 *
d°
, c⁄° snd_˘l_ñem_öfo_à*
§c
)

2606 
	`as£π
(
d°
 && 
§c
);

2607 *
d°
 = *
§c
;

2608 
	}
}

2615 
¢d_˘l_ñem_ty≥_t
 
	$¢d_˘l_ñem_öfo_gë_ty≥
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2617 
	`as£π
(
obj
);

2618  
obj
->
ty≥
;

2619 
	}
}

2626 
	$¢d_˘l_ñem_öfo_is_ªadabÀ
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2628 
	`as£π
(
obj
);

2629  !!(
obj
->
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_READ
);

2630 
	}
}

2637 
	$¢d_˘l_ñem_öfo_is_wrôabÀ
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2639 
	`as£π
(
obj
);

2640  !!(
obj
->
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_WRITE
);

2641 
	}
}

2648 
	$¢d_˘l_ñem_öfo_is_vﬁ©ûe
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2650 
	`as£π
(
obj
);

2651  !!(
obj
->
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_VOLATILE
);

2652 
	}
}

2659 
	$¢d_˘l_ñem_öfo_is_öa˘ive
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2661 
	`as£π
(
obj
);

2662  !!(
obj
->
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_INACTIVE
);

2663 
	}
}

2670 
	$¢d_˘l_ñem_öfo_is_locked
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2672 
	`as£π
(
obj
);

2673  !!(
obj
->
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_LOCK
);

2674 
	}
}

2681 
	$¢d_˘l_ñem_öfo_is_ow√r
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2683 
	`as£π
(
obj
);

2684  !!(
obj
->
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_OWNER
);

2685 
	}
}

2692 
	$¢d_˘l_ñem_öfo_is_u£r
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2694 
	`as£π
(
obj
);

2695  !!(
obj
->
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_USER
);

2696 
	}
}

2703 
	$¢d_˘l_ñem_öfo_is_év_ªadabÀ
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2705 
	`as£π
(
obj
);

2706  !!(
obj
->
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_READ
);

2707 
	}
}

2714 
	$¢d_˘l_ñem_öfo_is_év_wrôabÀ
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2716 
	`as£π
(
obj
);

2717  !!(
obj
->
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_WRITE
);

2718 
	}
}

2725 
	$¢d_˘l_ñem_öfo_is_év_comm™dabÀ
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2727 
	`as£π
(
obj
);

2728  !!(
obj
->
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_COMMAND
);

2729 
	}
}

2736 
	$¢d_˘l_ñem_öfo_is_ödúe˘
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2738 
	`as£π
(
obj
);

2740 
	}
}

2741 
lök_w¨nög
(
¢d_˘l_ñem_öfo_is_ödúe˘
, "Warning: snd_ctl_elem_info_is_indirect is deprecated, doÇot use it");

2748 
pid_t
 
	$¢d_˘l_ñem_öfo_gë_ow√r
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2750 
	`as£π
(
obj
);

2751  
obj
->
ow√r
;

2752 
	}
}

2759 
	$¢d_˘l_ñem_öfo_gë_cou¡
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2761 
	`as£π
(
obj
);

2762  
obj
->
cou¡
;

2763 
	}
}

2770 
	$¢d_˘l_ñem_öfo_gë_mö
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2772 
	`as£π
(
obj
);

2773 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_ELEM_TYPE_INTEGER
);

2774  
obj
->
vÆue
.
öãgî
.
mö
;

2775 
	}
}

2782 
	$¢d_˘l_ñem_öfo_gë_max
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2784 
	`as£π
(
obj
);

2785 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_ELEM_TYPE_INTEGER
);

2786  
obj
->
vÆue
.
öãgî
.
max
;

2787 
	}
}

2794 
	$¢d_˘l_ñem_öfo_gë_°ï
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2796 
	`as£π
(
obj
);

2797 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_ELEM_TYPE_INTEGER
);

2798  
obj
->
vÆue
.
öãgî
.
°ï
;

2799 
	}
}

2806 
	$¢d_˘l_ñem_öfo_gë_mö64
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2808 
	`as£π
(
obj
);

2809 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_ELEM_TYPE_INTEGER64
);

2810  
obj
->
vÆue
.
öãgî64
.
mö
;

2811 
	}
}

2818 
	$¢d_˘l_ñem_öfo_gë_max64
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2820 
	`as£π
(
obj
);

2821 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_ELEM_TYPE_INTEGER64
);

2822  
obj
->
vÆue
.
öãgî64
.
max
;

2823 
	}
}

2830 
	$¢d_˘l_ñem_öfo_gë_°ï64
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2832 
	`as£π
(
obj
);

2833 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_ELEM_TYPE_INTEGER64
);

2834  
obj
->
vÆue
.
öãgî64
.
°ï
;

2835 
	}
}

2842 
	$¢d_˘l_ñem_öfo_gë_ôems
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2844 
	`as£π
(
obj
);

2845 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_ELEM_TYPE_ENUMERATED
);

2846  
obj
->
vÆue
.
íumî©ed
.
ôems
;

2847 
	}
}

2854 
	$¢d_˘l_ñem_öfo_£t_ôem
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
vÆ
)

2856 
	`as£π
(
obj
);

2857 
obj
->
vÆue
.
íumî©ed
.
ôem
 = 
vÆ
;

2858 
	}
}

2865 c⁄° *
	$¢d_˘l_ñem_öfo_gë_ôem_«me
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2867 
	`as£π
(
obj
);

2868 
	`as£π
(
obj
->
ty≥
 =
SND_CTL_ELEM_TYPE_ENUMERATED
);

2869  
obj
->
vÆue
.
íumî©ed
.
«me
;

2870 
	}
}

2880 #i‚de‡
DOXYGEN


2881 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_˘l_ñem_öfo_gë_dimísi⁄s
)(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
 
ATTRIBUTE_UNUSED
)

2883 
	$¢d_˘l_ñem_öfo_gë_dimísi⁄s
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2887 
i
;

2889 
	`as£π
(
obj
);

2890 
i
 = 3; i >= 0; i--)

2891 i‡(
obj
->
dimí
.
d
[
i
])

2893  
i
 + 1;

2895  -
EINVAL
;

2897 
	}
}

2898 
u£_deÁu…_symbﬁ_vîsi⁄
(
__¢d_˘l_ñem_öfo_gë_dimísi⁄s
, 
¢d_˘l_ñem_öfo_gë_dimísi⁄s
, 
ALSA_0
.9.3);

2909 #i‚de‡
DOXYGEN


2910 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_˘l_ñem_öfo_gë_dimísi⁄
)(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
 
ATTRIBUTE_UNUSED
, 
idx
 ATTRIBUTE_UNUSED)

2912 
	$¢d_˘l_ñem_öfo_gë_dimísi⁄
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
, 
idx
)

2916 
	`as£π
(
obj
);

2917 i‡(
idx
 > 3)

2919  
obj
->
dimí
.
d
[
idx
];

2921  -
EINVAL
;

2923 
	}
}

2924 
u£_deÁu…_symbﬁ_vîsi⁄
(
__¢d_˘l_ñem_öfo_gë_dimísi⁄
, 
¢d_˘l_ñem_öfo_gë_dimísi⁄
, 
ALSA_0
.9.3);

2944 
	$¢d_˘l_ñem_öfo_£t_dimísi⁄
(
¢d_˘l_ñem_öfo_t
 *
öfo
 
ATTRIBUTE_UNUSED
,

2945 c⁄° 
dimísi⁄
[4] 
ATTRIBUTE_UNUSED
)

2948 
i
;

2950 i‡(
öfo
 =
NULL
)

2951  -
EINVAL
;

2953 
i
 = 0; i < 
	`ARRAY_SIZE
(
öfo
->
dimí
.
d
); i++) {

2954 i‡(
dimísi⁄
[
i
] < 0)

2955  -
EINVAL
;

2957 
öfo
->
dimí
.
d
[
i
] = 
dimísi⁄
[i];

2962  -
EINVAL
;

2964 
	}
}

2971 
	$¢d_˘l_ñem_öfo_gë_id
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
, 
¢d_˘l_ñem_id_t
 *
±r
)

2973 
	`as£π
(
obj
 && 
±r
);

2974 *
±r
 = 
obj
->
id
;

2975 
	}
}

2982 
	$¢d_˘l_ñem_öfo_gë_numid
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2984 
	`as£π
(
obj
);

2985  
obj
->
id
.
numid
;

2986 
	}
}

2993 
¢d_˘l_ñem_iÁ˚_t
 
	$¢d_˘l_ñem_öfo_gë_öãrÁ˚
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

2995 
	`as£π
(
obj
);

2996  
obj
->
id
.
iÁ˚
;

2997 
	}
}

3004 
	$¢d_˘l_ñem_öfo_gë_devi˚
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

3006 
	`as£π
(
obj
);

3007  
obj
->
id
.
devi˚
;

3008 
	}
}

3015 
	$¢d_˘l_ñem_öfo_gë_subdevi˚
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

3017 
	`as£π
(
obj
);

3018  
obj
->
id
.
subdevi˚
;

3019 
	}
}

3026 c⁄° *
	$¢d_˘l_ñem_öfo_gë_«me
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

3028 
	`as£π
(
obj
);

3029  (c⁄° *)
obj
->
id
.
«me
;

3030 
	}
}

3037 
	$¢d_˘l_ñem_öfo_gë_ödex
(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
)

3039 
	`as£π
(
obj
);

3040  
obj
->
id
.
ödex
;

3041 
	}
}

3048 
	$¢d_˘l_ñem_öfo_£t_id
(
¢d_˘l_ñem_öfo_t
 *
obj
, c⁄° 
¢d_˘l_ñem_id_t
 *
±r
)

3050 
	`as£π
(
obj
 && 
±r
);

3051 
obj
->
id
 = *
±r
;

3052 
	}
}

3059 
	$¢d_˘l_ñem_öfo_£t_numid
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
vÆ
)

3061 
	`as£π
(
obj
);

3062 
obj
->
id
.
numid
 = 
vÆ
;

3063 
	}
}

3070 
	$¢d_˘l_ñem_öfo_£t_öãrÁ˚
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
¢d_˘l_ñem_iÁ˚_t
 
vÆ
)

3072 
	`as£π
(
obj
);

3073 
obj
->
id
.
iÁ˚
 = 
vÆ
;

3074 
	}
}

3081 
	$¢d_˘l_ñem_öfo_£t_devi˚
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
vÆ
)

3083 
	`as£π
(
obj
);

3084 
obj
->
id
.
devi˚
 = 
vÆ
;

3085 
	}
}

3092 
	$¢d_˘l_ñem_öfo_£t_subdevi˚
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
vÆ
)

3094 
	`as£π
(
obj
);

3095 
obj
->
id
.
subdevi˚
 = 
vÆ
;

3096 
	}
}

3103 
	$¢d_˘l_ñem_öfo_£t_«me
(
¢d_˘l_ñem_öfo_t
 *
obj
, c⁄° *
vÆ
)

3105 
	`as£π
(
obj
);

3106 
	`¢d_°æ˝y
((*)
obj
->
id
.
«me
, 
vÆ
, (obj->id.name));

3107 
	}
}

3114 
	$¢d_˘l_ñem_öfo_£t_ödex
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
vÆ
)

3116 
	`as£π
(
obj
);

3117 
obj
->
id
.
ödex
 = 
vÆ
;

3118 
	}
}

3126 
	$¢d_˘l_ñem_öfo_£t_ªad_wrôe
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
rvÆ
, 
wvÆ
)

3128 
	`as£π
(
obj
);

3129 
obj
->
ac˚ss
 = (obj->ac˚s†& ~
SNDRV_CTL_ELEM_ACCESS_READWRITE
) |

3130 (
rvÆ
 ? 
SNDRV_CTL_ELEM_ACCESS_READ
 : 0) |

3131 (
wvÆ
 ? 
SNDRV_CTL_ELEM_ACCESS_WRITE
 : 0);

3132 
	}
}

3140 
	$¢d_˘l_ñem_öfo_£t_év_ªad_wrôe
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
rvÆ
, 
wvÆ
)

3142 
	`as£π
(
obj
);

3143 
obj
->
ac˚ss
 = (obj->ac˚s†& ~
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
) |

3144 (
rvÆ
 ? 
SNDRV_CTL_ELEM_ACCESS_TLV_READ
 : 0) |

3145 (
wvÆ
 ? 
SNDRV_CTL_ELEM_ACCESS_TLV_WRITE
 : 0);

3146 
	}
}

3153 
	$¢d_˘l_ñem_öfo_£t_öa˘ive
(
¢d_˘l_ñem_öfo_t
 *
obj
, 
vÆ
)

3155 
	`as£π
(
obj
);

3156 
obj
->
ac˚ss
 = (obj->ac˚s†& ~
SNDRV_CTL_ELEM_ACCESS_INACTIVE
) |

3157 (
vÆ
 ? 
SNDRV_CTL_ELEM_ACCESS_INACTIVE
 : 0);

3158 
	}
}

3164 
size_t
 
	$¢d_˘l_ñem_vÆue_sizeof
()

3166  (
¢d_˘l_ñem_vÆue_t
);

3167 
	}
}

3181 
	$¢d_˘l_ñem_vÆue_mÆloc
(
¢d_˘l_ñem_vÆue_t
 **
±r
)

3183 
	`as£π
(
±r
);

3184 *
±r
 = 
	`ˇŒoc
(1, (
¢d_˘l_ñem_vÆue_t
));

3185 i‡(!*
±r
)

3186  -
ENOMEM
;

3188 
	}
}

3196 
	$¢d_˘l_ñem_vÆue_‰ì
(
¢d_˘l_ñem_vÆue_t
 *
obj
)

3198 
	`‰ì
(
obj
);

3199 
	}
}

3208 
	$¢d_˘l_ñem_vÆue_˛ór
(
¢d_˘l_ñem_vÆue_t
 *
obj
)

3210 
	`mem£t
(
obj
, 0, (
¢d_˘l_ñem_vÆue_t
));

3211 
	}
}

3218 
	$¢d_˘l_ñem_vÆue_c›y
(
¢d_˘l_ñem_vÆue_t
 *
d°
,

3219 c⁄° 
¢d_˘l_ñem_vÆue_t
 *
§c
)

3221 
	`as£π
(
d°
 && 
§c
);

3222 *
d°
 = *
§c
;

3223 
	}
}

3232 
	$¢d_˘l_ñem_vÆue_com∑ª
(
¢d_˘l_ñem_vÆue_t
 *
À·
,

3233 c⁄° 
¢d_˘l_ñem_vÆue_t
 *
right
)

3235 
	`as£π
(
À·
 && 
right
);

3236  
	`memcmp
(
À·
, 
right
, (*left));

3237 
	}
}

3248 
	$¢d_˘l_ñem_vÆue_gë_id
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
, 
¢d_˘l_ñem_id_t
 *
±r
)

3250 
	`as£π
(
obj
 && 
±r
);

3251 *
±r
 = 
obj
->
id
;

3252 
	}
}

3262 
	$¢d_˘l_ñem_vÆue_gë_numid
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
)

3264 
	`as£π
(
obj
);

3265  
obj
->
id
.
numid
;

3266 
	}
}

3276 
¢d_˘l_ñem_iÁ˚_t
 
	$¢d_˘l_ñem_vÆue_gë_öãrÁ˚
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
)

3278 
	`as£π
(
obj
);

3279  
obj
->
id
.
iÁ˚
;

3280 
	}
}

3290 
	$¢d_˘l_ñem_vÆue_gë_devi˚
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
)

3292 
	`as£π
(
obj
);

3293  
obj
->
id
.
devi˚
;

3294 
	}
}

3304 
	$¢d_˘l_ñem_vÆue_gë_subdevi˚
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
)

3306 
	`as£π
(
obj
);

3307  
obj
->
id
.
subdevi˚
;

3308 
	}
}

3318 c⁄° *
	$¢d_˘l_ñem_vÆue_gë_«me
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
)

3320 
	`as£π
(
obj
);

3321  (c⁄° *)
obj
->
id
.
«me
;

3322 
	}
}

3332 
	$¢d_˘l_ñem_vÆue_gë_ödex
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
)

3334 
	`as£π
(
obj
);

3335  
obj
->
id
.
ödex
;

3336 
	}
}

3347 
	$¢d_˘l_ñem_vÆue_£t_id
(
¢d_˘l_ñem_vÆue_t
 *
obj
, c⁄° 
¢d_˘l_ñem_id_t
 *
±r
)

3349 
	`as£π
(
obj
 && 
±r
);

3350 
obj
->
id
 = *
±r
;

3351 
	}
}

3361 
	$¢d_˘l_ñem_vÆue_£t_numid
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
vÆ
)

3363 
	`as£π
(
obj
);

3364 
obj
->
id
.
numid
 = 
vÆ
;

3365 
	}
}

3375 
	$¢d_˘l_ñem_vÆue_£t_öãrÁ˚
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
¢d_˘l_ñem_iÁ˚_t
 
vÆ
)

3377 
	`as£π
(
obj
);

3378 
obj
->
id
.
iÁ˚
 = 
vÆ
;

3379 
	}
}

3389 
	$¢d_˘l_ñem_vÆue_£t_devi˚
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
vÆ
)

3391 
	`as£π
(
obj
);

3392 
obj
->
id
.
devi˚
 = 
vÆ
;

3393 
	}
}

3403 
	$¢d_˘l_ñem_vÆue_£t_subdevi˚
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
vÆ
)

3405 
	`as£π
(
obj
);

3406 
obj
->
id
.
subdevi˚
 = 
vÆ
;

3407 
	}
}

3417 
	$¢d_˘l_ñem_vÆue_£t_«me
(
¢d_˘l_ñem_vÆue_t
 *
obj
, c⁄° *
vÆ
)

3419 
	`as£π
(
obj
);

3420 
	`¢d_°æ˝y
((*)
obj
->
id
.
«me
, 
vÆ
, (obj->id.name));

3421 
	}
}

3431 
	$¢d_˘l_ñem_vÆue_£t_ödex
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
vÆ
)

3433 
	`as£π
(
obj
);

3434 
obj
->
id
.
ödex
 = 
vÆ
;

3435 
	}
}

3448 
	$¢d_˘l_ñem_vÆue_gë_boﬁón
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
)

3450 
	`as£π
(
obj
);

3451 
	`as£π
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
vÆue
.
öãgî
.value));

3452  
obj
->
vÆue
.
öãgî
.vÆue[
idx
];

3453 
	}
}

3466 
	$¢d_˘l_ñem_vÆue_gë_öãgî
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
)

3468 
	`as£π
(
obj
);

3469 
	`as£π
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
vÆue
.
öãgî
.value));

3470  
obj
->
vÆue
.
öãgî
.vÆue[
idx
];

3471 
	}
}

3484 
	$¢d_˘l_ñem_vÆue_gë_öãgî64
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
)

3486 
	`as£π
(
obj
);

3487 
	`as£π
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
vÆue
.
öãgî64
.value));

3488  
obj
->
vÆue
.
öãgî64
.vÆue[
idx
];

3489 
	}
}

3502 
	$¢d_˘l_ñem_vÆue_gë_íumî©ed
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
)

3504 
	`as£π
(
obj
);

3505 
	`as£π
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
vÆue
.
íumî©ed
.
ôem
));

3506  
obj
->
vÆue
.
íumî©ed
.
ôem
[
idx
];

3507 
	}
}

3520 
	$¢d_˘l_ñem_vÆue_gë_byã
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
)

3522 
	`as£π
(
obj
);

3523 
	`as£π
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
vÆue
.
byãs
.
d©a
));

3524  
obj
->
vÆue
.
byãs
.
d©a
[
idx
];

3525 
	}
}

3538 
	$¢d_˘l_ñem_vÆue_£t_boﬁón
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
, 
vÆ
)

3540 
	`as£π
(
obj
);

3541 
	`as£π
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
vÆue
.
öãgî
.value));

3542 
obj
->
vÆue
.
öãgî
.vÆue[
idx
] = 
vÆ
;

3543 
	}
}

3556 
	$¢d_˘l_ñem_vÆue_£t_öãgî
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
, 
vÆ
)

3558 
	`as£π
(
obj
);

3559 
	`as£π
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
vÆue
.
öãgî
.value));

3560 
obj
->
vÆue
.
öãgî
.vÆue[
idx
] = 
vÆ
;

3561 
	}
}

3574 
	$¢d_˘l_ñem_vÆue_£t_öãgî64
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
, 
vÆ
)

3576 
	`as£π
(
obj
);

3577 
	`as£π
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
vÆue
.
öãgî64
.value));

3578 
obj
->
vÆue
.
öãgî64
.vÆue[
idx
] = 
vÆ
;

3579 
	}
}

3592 
	$¢d_˘l_ñem_vÆue_£t_íumî©ed
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
, 
vÆ
)

3594 
	`as£π
(
obj
);

3595 
	`as£π
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
vÆue
.
íumî©ed
.
ôem
));

3596 
obj
->
vÆue
.
íumî©ed
.
ôem
[
idx
] = 
vÆ
;

3597 
	}
}

3610 
	$¢d_˘l_ñem_vÆue_£t_byã
(
¢d_˘l_ñem_vÆue_t
 *
obj
, 
idx
, 
vÆ
)

3612 
	`as£π
(
obj
);

3613 
	`as£π
(
idx
 < 
	`ARRAY_SIZE
(
obj
->
vÆue
.
byãs
.
d©a
));

3614 
obj
->
vÆue
.
byãs
.
d©a
[
idx
] = 
vÆ
;

3615 
	}
}

3630 
	$¢d_˘l_ñem_£t_byãs
(
¢d_˘l_ñem_vÆue_t
 *
obj
, *
d©a
, 
size_t
 
size
)

3632 
	`as£π
(
obj
);

3633 
	`as£π
(
size
 <
	`ARRAY_SIZE
(
obj
->
vÆue
.
byãs
.
d©a
));

3634 
	`mem˝y
(
obj
->
vÆue
.
byãs
.
d©a
, d©a, 
size
);

3635 
	}
}

3649 c⁄° * 
	$¢d_˘l_ñem_vÆue_gë_byãs
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
)

3651 
	`as£π
(
obj
);

3652  
obj
->
vÆue
.
byãs
.
d©a
;

3653 
	}
}

3667 
	$¢d_˘l_ñem_vÆue_gë_õc958
(c⁄° 
¢d_˘l_ñem_vÆue_t
 *
obj
, 
¢d_´s_õc958_t
 *
±r
)

3669 
	`as£π
(
obj
 && 
±r
);

3670 
	`mem˝y
(
±r
, &
obj
->
vÆue
.
õc958
, (*ptr));

3671 
	}
}

3685 
	$¢d_˘l_ñem_vÆue_£t_õc958
(
¢d_˘l_ñem_vÆue_t
 *
obj
, c⁄° 
¢d_´s_õc958_t
 *
±r
)

3687 
	`as£π
(
obj
 && 
±r
);

3688 
	`mem˝y
(&
obj
->
vÆue
.
õc958
, 
±r
, (obj->value.iec958));

3689 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_empty.c

29 
	~"c⁄åﬁ_loˇl.h
"

31 #i‚de‡
PIC


33 c⁄° *
	g_¢d_moduÀ_c⁄åﬁ_em±y
 = "";

73 
	$_¢d_˘l_em±y_›í
(
¢d_˘l_t
 **
h™dÀp
, c⁄° *
«me
 
ATTRIBUTE_UNUSED
,

74 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
, 
mode
)

76 
¢d_c⁄fig_t
 *
chûd
 = 
NULL
;

77 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

79 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

80 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

81 c⁄° *
id
;

82 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

84 i‡(
	`_¢d_c⁄f_gíîic_id
(
id
))

86 i‡(
	`°rcmp
(
id
, "child") == 0) {

87 
chûd
 = 
n
;

90 
	`SNDERR
("Unknow¿fõld %s", 
id
);

91  -
EINVAL
;

93 i‡(!
chûd
) {

94 
	`SNDERR
("child isÇot defined");

95  -
EINVAL
;

97  
	`_¢d_˘l_›í_«med_chûd
(
h™dÀp
, 
«me
, 
roŸ
, 
chûd
, 
mode
, 
c⁄f
);

98 
	}
}

99 #i‚de‡
DOC_HIDDEN


100 
SND_DLSYM_BUILD_VERSION
(
_¢d_˘l_em±y_›í
, 
SND_CONTROL_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_ext.c

30 
	~"c⁄åﬁ_loˇl.h
"

31 
	~"c⁄åﬁ_exã∫Æ.h
"

32 
	~<°dio.h
>

33 
	~<°dlib.h
>

34 
	~<uni°d.h
>

35 
	~<°rög.h
>

37 #i‚de‡
PIC


39 c⁄° *
	g_¢d_moduÀ_c⁄åﬁ_ext
 = "";

42 
	$¢d_˘l_ext_˛o£
(
¢d_˘l_t
 *
h™dÀ
)

44 
¢d_˘l_ext_t
 *
ext
 = 
h™dÀ
->
¥iv©e_d©a
;

46 i‡(
ext
->
ˇŒback
->
˛o£
)

47 
ext
->
ˇŒback
->
	`˛o£
(ext);

49 
	}
}

51 
	$¢d_˘l_ext_n⁄block
(
¢d_˘l_t
 *
h™dÀ
, 
n⁄block
)

53 
¢d_˘l_ext_t
 *
ext
 = 
h™dÀ
->
¥iv©e_d©a
;

55 
ext
->
n⁄block
 =Çonblock;

57 
	}
}

59 
	$¢d_˘l_ext_async
(
¢d_˘l_t
 *
˘l
 
ATTRIBUTE_UNUSED
,

60 
sig
 
ATTRIBUTE_UNUSED
,

61 
pid_t
 
pid
 
ATTRIBUTE_UNUSED
)

63  -
ENOSYS
;

64 
	}
}

66 
	$¢d_˘l_ext_subs¸ibe_evíts
(
¢d_˘l_t
 *
h™dÀ
, 
subs¸ibe
)

68 
¢d_˘l_ext_t
 *
ext
 = 
h™dÀ
->
¥iv©e_d©a
;

70 i‡(
subs¸ibe
 < 0)

71  
ext
->
subs¸ibed
;

72 
ext
->
subs¸ibed
 = !!
subs¸ibe
;

73 i‡(
ext
->
ˇŒback
->
subs¸ibe_evíts
)

74 
ext
->
ˇŒback
->
	`subs¸ibe_evíts
”xt, 
subs¸ibe
);

76 
	}
}

78 
	$¢d_˘l_ext_ˇrd_öfo
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_ˇrd_öfo_t
 *
öfo
)

80 
¢d_˘l_ext_t
 *
ext
 = 
h™dÀ
->
¥iv©e_d©a
;

82 
	`mem£t
(
öfo
, 0, (*info));

83 
öfo
->
ˇrd
 = 
ext
->
ˇrd_idx
;

84 
	`mem˝y
(
öfo
->
id
, 
ext
->id, (info->id));

85 
	`mem˝y
(
öfo
->
drivî
, 
ext
->driver, (info->driver));

86 
	`mem˝y
(
öfo
->
«me
, 
ext
->name, (info->name));

87 
	`mem˝y
(
öfo
->
l⁄g«me
, 
ext
->longname, (info->longname));

88 
	`mem˝y
(
öfo
->
mixî«me
, 
ext
->mixername, (info->mixername));

90 
	}
}

92 
	$¢d_˘l_ext_ñem_li°
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_ñem_li°_t
 *
li°
)

94 
¢d_˘l_ext_t
 *
ext
 = 
h™dÀ
->
¥iv©e_d©a
;

95 
ªt
;

96 
i
, 
off£t
;

97 
¢d_˘l_ñem_id_t
 *
ids
;

99 
li°
->
cou¡
 = 
ext
->
ˇŒback
->
	`ñem_cou¡
(ext);

100 
li°
->
u£d
 = 0;

101 
ids
 = 
li°
->
pids
;

102 
off£t
 = 
li°
->offset;

103 
i
 = 0; i < 
li°
->
•a˚
; i++) {

104 i‡(
off£t
 >
li°
->
cou¡
)

106 
	`¢d_˘l_ñem_id_˛ór
(
ids
);

107 
ªt
 = 
ext
->
ˇŒback
->
	`ñem_li°
”xt, 
off£t
, 
ids
);

108 i‡(
ªt
 < 0)

109  
ªt
;

110 
ids
->
numid
 = 
off£t
 + 1;

111 
li°
->
u£d
++;

112 
off£t
++;

113 
ids
++;

116 
	}
}

118 
¢d_˘l_ext_key_t
 
	$gë_ñem
(
¢d_˘l_ext_t
 *
ext
, 
¢d_˘l_ñem_id_t
 *
id
)

120 
numid
 = 
id
->numid;

121 i‡(
numid
 > 0) {

122 
ext
->
ˇŒback
->
	`ñem_li°
”xt, 
numid
 - 1, 
id
);

123 
id
->
numid
 =Çumid;

125 
id
->
numid
 = 0;

126  
ext
->
ˇŒback
->
	`föd_ñem
”xt, 
id
);

127 
	}
}

129 
	$¢d_˘l_ext_ñem_öfo
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_ñem_öfo_t
 *
öfo
)

131 
¢d_˘l_ext_t
 *
ext
 = 
h™dÀ
->
¥iv©e_d©a
;

132 
¢d_˘l_ext_key_t
 
key
;

133 
ty≥
, 
ªt
;

135 
key
 = 
	`gë_ñem
(
ext
, &
öfo
->
id
);

136 i‡(
key
 =
SND_CTL_EXT_KEY_NOT_FOUND
)

137  -
ENOENT
;

138 
ªt
 = 
ext
->
ˇŒback
->
	`gë_©åibuã
”xt, 
key
, &
ty≥
, &
öfo
->
ac˚ss
, &öfo->
cou¡
);

139 i‡(
ªt
 < 0)

140 
îr
;

141 
öfo
->
ty≥
 =Åype;

142 
ªt
 = -
EINVAL
;

143 
öfo
->
ty≥
) {

144 
SND_CTL_ELEM_TYPE_BOOLEAN
:

145 
öfo
->
vÆue
.
öãgî
.
mö
 = 0;

146 
öfo
->
vÆue
.
öãgî
.
max
 = 1;

147 
ªt
 = 0;

149 
SND_CTL_ELEM_TYPE_INTEGER
:

150 i‡(! 
ext
->
ˇŒback
->
gë_öãgî_öfo
)

151 
îr
;

152 
ªt
 = 
ext
->
ˇŒback
->
	`gë_öãgî_öfo
”xt, 
key
, &
öfo
->
vÆue
.
öãgî
.
mö
,

153 &
öfo
->
vÆue
.
öãgî
.
max
,

154 &
öfo
->
vÆue
.
öãgî
.
°ï
);

156 
SND_CTL_ELEM_TYPE_INTEGER64
:

157 i‡(! 
ext
->
ˇŒback
->
gë_öãgî64_öfo
)

158 
îr
;

160 
öt64_t
 
xmö
, 
xmax
, 
x°ï
;

161 
ªt
 = 
ext
->
ˇŒback
->
	`gë_öãgî64_öfo
”xt, 
key
,

162 &
xmö
,

163 &
xmax
,

164 &
x°ï
);

165 
öfo
->
vÆue
.
öãgî64
.
mö
 = 
xmö
;

166 
öfo
->
vÆue
.
öãgî64
.
max
 = 
xmax
;

167 
öfo
->
vÆue
.
öãgî64
.
°ï
 = 
x°ï
;

170 
SND_CTL_ELEM_TYPE_ENUMERATED
:

171 i‡(! 
ext
->
ˇŒback
->
gë_íumî©ed_öfo
)

172 
îr
;

173 
ªt
 = 
ext
->
ˇŒback
->
	`gë_íumî©ed_öfo
”xt, 
key
, &
öfo
->
vÆue
.
íumî©ed
.
ôems
);

174 
ext
->
ˇŒback
->
	`gë_íumî©ed_«me
”xt, 
key
, 
öfo
->
vÆue
.
íumî©ed
.
ôem
,

175 
öfo
->
vÆue
.
íumî©ed
.
«me
,

176 (
öfo
->
vÆue
.
íumî©ed
.
«me
));

179 
ªt
 = 0;

183 
îr
:

184 i‡(
ext
->
ˇŒback
->
‰ì_key
)

185 
ext
->
ˇŒback
->
	`‰ì_key
”xt, 
key
);

187  
ªt
;

188 
	}
}

190 
	$¢d_˘l_ext_ñem_add
(
¢d_˘l_t
 *
h™dÀ
 
ATTRIBUTE_UNUSED
,

191 
¢d_˘l_ñem_öfo_t
 *
öfo
 
ATTRIBUTE_UNUSED
)

193  -
ENXIO
;

194 
	}
}

196 
	$¢d_˘l_ext_ñem_ª∂a˚
(
¢d_˘l_t
 *
h™dÀ
 
ATTRIBUTE_UNUSED
,

197 
¢d_˘l_ñem_öfo_t
 *
öfo
 
ATTRIBUTE_UNUSED
)

199  -
ENXIO
;

200 
	}
}

202 
	$¢d_˘l_ext_ñem_ªmove
(
¢d_˘l_t
 *
h™dÀ
 
ATTRIBUTE_UNUSED
,

203 
¢d_˘l_ñem_id_t
 *
id
 
ATTRIBUTE_UNUSED
)

205  -
ENXIO
;

206 
	}
}

208 
	$¢d_˘l_ext_ñem_ªad
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_ñem_vÆue_t
 *
c⁄åﬁ
)

210 
¢d_˘l_ext_t
 *
ext
 = 
h™dÀ
->
¥iv©e_d©a
;

211 
¢d_˘l_ext_key_t
 
key
;

212 
ty≥
, 
ªt
;

213 
ac˚ss
, 
cou¡
;

215 
key
 = 
	`gë_ñem
(
ext
, &
c⁄åﬁ
->
id
);

216 i‡(
key
 =
SND_CTL_EXT_KEY_NOT_FOUND
)

217  -
ENOENT
;

218 
ªt
 = 
ext
->
ˇŒback
->
	`gë_©åibuã
”xt, 
key
, &
ty≥
, &
ac˚ss
, &
cou¡
);

219 i‡(
ªt
 < 0)

220 
îr
;

221 
ªt
 = -
EINVAL
;

222 
ty≥
) {

223 
SND_CTL_ELEM_TYPE_BOOLEAN
:

224 
SND_CTL_ELEM_TYPE_INTEGER
:

225 i‡(! 
ext
->
ˇŒback
->
ªad_öãgî
)

226 
îr
;

227 
ªt
 = 
ext
->
ˇŒback
->
	`ªad_öãgî
”xt, 
key
, 
c⁄åﬁ
->
vÆue
.
öãgî
.value);

229 
SND_CTL_ELEM_TYPE_INTEGER64
:

230 i‡(! 
ext
->
ˇŒback
->
ªad_öãgî64
)

231 
îr
;

232 
ªt
 = 
ext
->
ˇŒback
->
	`ªad_öãgî64
”xt, 
key
,

233 (
öt64_t
*)
c⁄åﬁ
->
vÆue
.
öãgî64
.value);

235 
SND_CTL_ELEM_TYPE_ENUMERATED
:

236 i‡(! 
ext
->
ˇŒback
->
ªad_íumî©ed
)

237 
îr
;

238 
ªt
 = 
ext
->
ˇŒback
->
	`ªad_íumî©ed
”xt, 
key
, 
c⁄åﬁ
->
vÆue
.
íumî©ed
.
ôem
);

240 
SND_CTL_ELEM_TYPE_BYTES
:

241 i‡(! 
ext
->
ˇŒback
->
ªad_byãs
)

242 
îr
;

243 
ªt
 = 
ext
->
ˇŒback
->
	`ªad_byãs
”xt, 
key
, 
c⁄åﬁ
->
vÆue
.
byãs
.
d©a
,

244 (
c⁄åﬁ
->
vÆue
.
byãs
.
d©a
));

246 
SND_CTL_ELEM_TYPE_IEC958
:

247 i‡(! 
ext
->
ˇŒback
->
ªad_õc958
)

248 
îr
;

249 
ªt
 = 
ext
->
ˇŒback
->
	`ªad_õc958
”xt, 
key
, (
¢d_´s_õc958_t
 *)&
c⁄åﬁ
->
vÆue
.
õc958
);

255 
îr
:

256 i‡(
ext
->
ˇŒback
->
‰ì_key
)

257 
ext
->
ˇŒback
->
	`‰ì_key
”xt, 
key
);

259  
ªt
;

260 
	}
}

262 
	$¢d_˘l_ext_ñem_wrôe
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_ñem_vÆue_t
 *
c⁄åﬁ
)

264 
¢d_˘l_ext_t
 *
ext
 = 
h™dÀ
->
¥iv©e_d©a
;

265 
¢d_˘l_ext_key_t
 
key
;

266 
ty≥
, 
ªt
;

267 
ac˚ss
, 
cou¡
;

269 
key
 = 
	`gë_ñem
(
ext
, &
c⁄åﬁ
->
id
);

270 i‡(
key
 =
SND_CTL_EXT_KEY_NOT_FOUND
)

271  -
ENOENT
;

272 
ªt
 = 
ext
->
ˇŒback
->
	`gë_©åibuã
”xt, 
key
, &
ty≥
, &
ac˚ss
, &
cou¡
);

273 i‡(
ªt
 < 0)

274 
îr
;

275 
ªt
 = -
EINVAL
;

276 
ty≥
) {

277 
SND_CTL_ELEM_TYPE_BOOLEAN
:

278 
SND_CTL_ELEM_TYPE_INTEGER
:

279 i‡(! 
ext
->
ˇŒback
->
wrôe_öãgî
)

280 
îr
;

281 
ªt
 = 
ext
->
ˇŒback
->
	`wrôe_öãgî
”xt, 
key
, 
c⁄åﬁ
->
vÆue
.
öãgî
.value);

283 
SND_CTL_ELEM_TYPE_INTEGER64
:

284 i‡(! 
ext
->
ˇŒback
->
wrôe_öãgî64
)

285 
îr
;

286 
ªt
 = 
ext
->
ˇŒback
->
	`wrôe_öãgî64
”xt, 
key
, (
öt64_t
 *)
c⁄åﬁ
->
vÆue
.
öãgî64
.value);

288 
SND_CTL_ELEM_TYPE_ENUMERATED
:

289 i‡(! 
ext
->
ˇŒback
->
wrôe_íumî©ed
)

290 
îr
;

291 
ªt
 = 
ext
->
ˇŒback
->
	`wrôe_íumî©ed
”xt, 
key
, 
c⁄åﬁ
->
vÆue
.
íumî©ed
.
ôem
);

293 
SND_CTL_ELEM_TYPE_BYTES
:

294 i‡(! 
ext
->
ˇŒback
->
wrôe_byãs
)

295 
îr
;

296 
ªt
 = 
ext
->
ˇŒback
->
	`wrôe_byãs
”xt, 
key
, 
c⁄åﬁ
->
vÆue
.
byãs
.
d©a
,

297 (
c⁄åﬁ
->
vÆue
.
byãs
.
d©a
));

299 
SND_CTL_ELEM_TYPE_IEC958
:

300 i‡(! 
ext
->
ˇŒback
->
wrôe_õc958
)

301 
îr
;

302 
ªt
 = 
ext
->
ˇŒback
->
	`wrôe_õc958
”xt, 
key
, (
¢d_´s_õc958_t
 *)&
c⁄åﬁ
->
vÆue
.
õc958
);

308 
îr
:

309 i‡(
ext
->
ˇŒback
->
‰ì_key
)

310 
ext
->
ˇŒback
->
	`‰ì_key
”xt, 
key
);

312  
ªt
;

313 
	}
}

315 
	$¢d_˘l_ext_ñem_lock
(
¢d_˘l_t
 *
h™dÀ
 
ATTRIBUTE_UNUSED
,

316 
¢d_˘l_ñem_id_t
 *
id
 
ATTRIBUTE_UNUSED
)

318  -
ENXIO
;

319 
	}
}

321 
	$¢d_˘l_ext_ñem_u∆ock
(
¢d_˘l_t
 *
h™dÀ
 
ATTRIBUTE_UNUSED
,

322 
¢d_˘l_ñem_id_t
 *
id
 
ATTRIBUTE_UNUSED
)

324  -
ENXIO
;

325 
	}
}

327 
	$¢d_˘l_ext_ñem_év
(
¢d_˘l_t
 *
h™dÀ
, 
›_Êag
,

328 
numid
,

329 *
év
, 
év_size
)

331 
¢d_˘l_ext_t
 *
ext
 = 
h™dÀ
->
¥iv©e_d©a
;

332 
¢d_˘l_ext_key_t
 
key
;

333 
ty≥
, 
ªt
;

334 
ac˚ss
, 
cou¡
, 
Àn
;

335 
¢d_˘l_ñem_id_t
 
id
;

338 i‡(
ext
->
vîsi⁄
 <
	`SNDRV_PROTOCOL_VERSION
(1, 0, 0))

339  -
ENXIO
;

341 
	`¢d_˘l_ñem_id_˛ór
(&
id
);

342 i‡(
numid
 > 0) {

343 
ext
->
ˇŒback
->
	`ñem_li°
”xt, 
numid
 - 1, &
id
);

344 
id
.
numid
 =Çumid;

346 
id
.
numid
 = 0;

347 
key
 = 
ext
->
ˇŒback
->
	`föd_ñem
”xt, &
id
);

349 i‡(
key
 =
SND_CTL_EXT_KEY_NOT_FOUND
)

350  -
ENOENT
;

351 
ªt
 = 
ext
->
ˇŒback
->
	`gë_©åibuã
”xt, 
key
, &
ty≥
, &
ac˚ss
, &
cou¡
);

352 i‡(
ªt
 < 0)

353  
ªt
;

355 i‡((
›_Êag
 =0 && (
ac˚ss
 & 
SND_CTL_EXT_ACCESS_TLV_READ
) == 0) ||

356 (
›_Êag
 > 0 && (
ac˚ss
 & 
SND_CTL_EXT_ACCESS_TLV_WRITE
) == 0) ||

357 (
›_Êag
 < 0 && (
ac˚ss
 & 
SND_CTL_EXT_ACCESS_TLV_COMMAND
) == 0))

358  -
ENXIO
;

359 i‡(
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_CALLBACK
) {

360  
ext
->
év
.
	`c
”xt, 
key
, 
›_Êag
, 
numid
,Ålv, 
év_size
);

362 i‡(
›_Êag
)

363  -
ENXIO
;

364 
Àn
 = 
ext
->
év
.
p
[1] + 2 * ();

365 i‡(
év_size
 < 
Àn
)

366  -
ENOMEM
;

367 
	`mem˝y
(
év
, 
ext
->év.
p
, 
Àn
);

370 
	}
}

372 
	$¢d_˘l_ext_√xt_devi˚
(
¢d_˘l_t
 *
h™dÀ
 
ATTRIBUTE_UNUSED
,

373 *
devi˚
 
ATTRIBUTE_UNUSED
)

375  -
ENXIO
;

376 
	}
}

378 
	$¢d_˘l_ext_¥e„r_subdevi˚
(
¢d_˘l_t
 *
h™dÀ
 
ATTRIBUTE_UNUSED
,

379 
subdev
 
ATTRIBUTE_UNUSED
)

381  -
ENXIO
;

382 
	}
}

384 
	$¢d_˘l_ext_hwdï_öfo
(
¢d_˘l_t
 *
h™dÀ
 
ATTRIBUTE_UNUSED
,

385 
¢d_hwdï_öfo_t
 *
öfo
 
ATTRIBUTE_UNUSED
)

387  -
ENXIO
;

388 
	}
}

390 
	$¢d_˘l_ext_pcm_öfo
(
¢d_˘l_t
 *
h™dÀ
 
ATTRIBUTE_UNUSED
,

391 
¢d_pcm_öfo_t
 *
öfo
 
ATTRIBUTE_UNUSED
)

393  -
ENXIO
;

394 
	}
}

396 
	$¢d_˘l_ext_øwmidi_öfo
(
¢d_˘l_t
 *
h™dÀ
 
ATTRIBUTE_UNUSED
,

397 
¢d_øwmidi_öfo_t
 *
öfo
 
ATTRIBUTE_UNUSED
)

399  -
ENXIO
;

400 
	}
}

402 
	$¢d_˘l_ext_£t_powî_°©e
(
¢d_˘l_t
 *
h™dÀ
 
ATTRIBUTE_UNUSED
,

403 
°©e
 
ATTRIBUTE_UNUSED
)

406 
	}
}

408 
	$¢d_˘l_ext_gë_powî_°©e
(
¢d_˘l_t
 *
h™dÀ
 
ATTRIBUTE_UNUSED
,

409 *
°©e
 
ATTRIBUTE_UNUSED
)

412 
	}
}

414 
	$¢d_˘l_ext_ªad
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_evít_t
 *
evít
)

416 
¢d_˘l_ext_t
 *
ext
 = 
h™dÀ
->
¥iv©e_d©a
;

418 i‡(
ext
->
ˇŒback
->
ªad_evít
) {

419 
	`mem£t
(
evít
, 0, (*event));

420  
ext
->
ˇŒback
->
	`ªad_evít
”xt, &
evít
->
d©a
.
ñem
.
id
, &evít->d©a.ñem.
mask
);

423  -
EINVAL
;

424 
	}
}

426 
	$¢d_˘l_ext_pﬁl_des¸ùt‹s_cou¡
(
¢d_˘l_t
 *
h™dÀ
)

428 
¢d_˘l_ext_t
 *
ext
 = 
h™dÀ
->
¥iv©e_d©a
;

430 i‡(
ext
->
ˇŒback
->
pﬁl_des¸ùt‹s_cou¡
)

431  
ext
->
ˇŒback
->
	`pﬁl_des¸ùt‹s_cou¡
(ext);

432 i‡(
ext
->
pﬁl_fd
 >= 0)

435 
	}
}

437 
	$¢d_˘l_ext_pﬁl_des¸ùt‹s
(
¢d_˘l_t
 *
h™dÀ
, 
pﬁlfd
 *
pfds
, 
•a˚
)

439 
¢d_˘l_ext_t
 *
ext
 = 
h™dÀ
->
¥iv©e_d©a
;

441 i‡(
ext
->
ˇŒback
->
pﬁl_des¸ùt‹s
)

442  
ext
->
ˇŒback
->
	`pﬁl_des¸ùt‹s
”xt, 
pfds
, 
•a˚
);

443 i‡(
ext
->
pﬁl_fd
 < 0)

445 i‡(
•a˚
 > 0) {

446 
pfds
->
fd
 = 
ext
->
pﬁl_fd
;

447 
pfds
->
evíts
 = 
POLLIN
|
POLLERR
|
POLLNVAL
;

451 
	}
}

453 
	$¢d_˘l_ext_pﬁl_ªvíts
(
¢d_˘l_t
 *
h™dÀ
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

455 
¢d_˘l_ext_t
 *
ext
 = 
h™dÀ
->
¥iv©e_d©a
;

457 i‡(
ext
->
ˇŒback
->
pﬁl_ªvíts
)

458  
ext
->
ˇŒback
->
	`pﬁl_ªvíts
”xt, 
pfds
, 
nfds
, 
ªvíts
);

459 i‡(
nfds
 == 1) {

460 *
ªvíts
 = 
pfds
->revents;

463  -
EINVAL
;

464 
	}
}

466 c⁄° 
¢d_˘l_›s_t
 
	g¢d_˘l_ext_›s
 = {

467 .
˛o£
 = 
¢d_˘l_ext_˛o£
,

468 .
	gn⁄block
 = 
¢d_˘l_ext_n⁄block
,

469 .
	gasync
 = 
¢d_˘l_ext_async
,

470 .
	gsubs¸ibe_evíts
 = 
¢d_˘l_ext_subs¸ibe_evíts
,

471 .
	gˇrd_öfo
 = 
¢d_˘l_ext_ˇrd_öfo
,

472 .
	gñemít_li°
 = 
¢d_˘l_ext_ñem_li°
,

473 .
	gñemít_öfo
 = 
¢d_˘l_ext_ñem_öfo
,

474 .
	gñemít_add
 = 
¢d_˘l_ext_ñem_add
,

475 .
	gñemít_ª∂a˚
 = 
¢d_˘l_ext_ñem_ª∂a˚
,

476 .
	gñemít_ªmove
 = 
¢d_˘l_ext_ñem_ªmove
,

477 .
	gñemít_ªad
 = 
¢d_˘l_ext_ñem_ªad
,

478 .
	gñemít_wrôe
 = 
¢d_˘l_ext_ñem_wrôe
,

479 .
	gñemít_lock
 = 
¢d_˘l_ext_ñem_lock
,

480 .
	gñemít_u∆ock
 = 
¢d_˘l_ext_ñem_u∆ock
,

481 .
	gñemít_év
 = 
¢d_˘l_ext_ñem_év
,

482 .
	ghwdï_√xt_devi˚
 = 
¢d_˘l_ext_√xt_devi˚
,

483 .
	ghwdï_öfo
 = 
¢d_˘l_ext_hwdï_öfo
,

484 .
	gpcm_√xt_devi˚
 = 
¢d_˘l_ext_√xt_devi˚
,

485 .
	gpcm_öfo
 = 
¢d_˘l_ext_pcm_öfo
,

486 .
	gpcm_¥e„r_subdevi˚
 = 
¢d_˘l_ext_¥e„r_subdevi˚
,

487 .
	gøwmidi_√xt_devi˚
 = 
¢d_˘l_ext_√xt_devi˚
,

488 .
	gøwmidi_öfo
 = 
¢d_˘l_ext_øwmidi_öfo
,

489 .
	gøwmidi_¥e„r_subdevi˚
 = 
¢d_˘l_ext_¥e„r_subdevi˚
,

490 .
	g£t_powî_°©e
 = 
¢d_˘l_ext_£t_powî_°©e
,

491 .
	ggë_powî_°©e
 = 
¢d_˘l_ext_gë_powî_°©e
,

492 .
	gªad
 = 
¢d_˘l_ext_ªad
,

493 .
	gpﬁl_des¸ùt‹s_cou¡
 = 
¢d_˘l_ext_pﬁl_des¸ùt‹s_cou¡
,

494 .
	gpﬁl_des¸ùt‹s
 = 
¢d_˘l_ext_pﬁl_des¸ùt‹s
,

495 .
	gpﬁl_ªvíts
 = 
¢d_˘l_ext_pﬁl_ªvíts
,

708 
	$¢d_˘l_ext_¸óã
(
¢d_˘l_ext_t
 *
ext
, c⁄° *
«me
, 
mode
)

710 
¢d_˘l_t
 *
˘l
;

711 
îr
;

713 i‡(
ext
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 0) ||

714 
ext
->
vîsi⁄
 > 
SND_CTL_EXT_VERSION
) {

715 
	`SNDERR
("ctl_ext: Plugin version mismatch");

716  -
ENXIO
;

719 
îr
 = 
	`¢d_˘l_√w
(&
˘l
, 
SND_CTL_TYPE_EXT
, 
«me
, 
mode
);

720 i‡(
îr
 < 0)

721  
îr
;

723 
ext
->
h™dÀ
 = 
˘l
;

725 
˘l
->
›s
 = &
¢d_˘l_ext_›s
;

726 
˘l
->
¥iv©e_d©a
 = 
ext
;

727 
˘l
->
pﬁl_fd
 = 
ext
->poll_fd;

728 i‡(
mode
 & 
SND_CTL_NONBLOCK
)

729 
ext
->
n⁄block
 = 1;

732 
	}
}

739 
	$¢d_˘l_ext_dñëe
(
¢d_˘l_ext_t
 *
ext
)

741  
	`¢d_˘l_˛o£
(
ext
->
h™dÀ
);

742 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_hw.c

29 
	~"c⁄åﬁ_loˇl.h
"

30 
	~<°dio.h
>

31 
	~<°dlib.h
>

32 
	~<uni°d.h
>

33 
	~<sig«l.h
>

34 
	~<°rög.h
>

35 
	~<f˙é.h
>

36 
	~<sys/io˘l.h
>

38 #i‚de‡
PIC


40 c⁄° *
	g_¢d_moduÀ_c⁄åﬁ_hw
 = "";

43 #i‚de‡
DOC_HIDDEN


45 #i‚de‡
F_SETSIG


46 
	#F_SETSIG
 10

	)

49 
	#SNDRV_FILE_CONTROL
 
ALSA_DEVICE_DIRECTORY
 "c⁄åﬁC%i"

	)

50 
	#SNDRV_CTL_VERSION_MAX
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4)

	)

53 
	mˇrd
;

54 
	mfd
;

55 
	m¥Ÿocﬁ
;

56 } 
	t¢d_˘l_hw_t
;

59 
	$¢d_˘l_hw_˛o£
(
¢d_˘l_t
 *
h™dÀ
)

61 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

62 
ªs
;

63 
ªs
 = 
	`˛o£
(
hw
->
fd
Ë< 0 ? -
î∫o
 : 0;

64 
	`‰ì
(
hw
);

65  
ªs
;

66 
	}
}

68 
	$¢d_˘l_hw_n⁄block
(
¢d_˘l_t
 *
h™dÀ
, 
n⁄block
)

70 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

71 
Êags
;

72 
fd
 = 
hw
->fd;

73 i‡((
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
)) < 0) {

74 
	`SYSERR
("F_GETFL failed");

75  -
î∫o
;

77 i‡(
n⁄block
)

78 
Êags
 |
O_NONBLOCK
;

80 
Êags
 &~
O_NONBLOCK
;

81 i‡(
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
) < 0) {

82 
	`SYSERR
("F_SETFL for O_NONBLOCK failed");

83  -
î∫o
;

86 
	}
}

88 
	$¢d_˘l_hw_async
(
¢d_˘l_t
 *
˘l
, 
sig
, 
pid_t
 
pid
)

90 
Êags
;

91 
¢d_˘l_hw_t
 *
hw
 = 
˘l
->
¥iv©e_d©a
;

92 
fd
 = 
hw
->fd;

94 i‡((
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
)) < 0) {

95 
	`SYSERR
("F_GETFL failed");

96  -
î∫o
;

98 i‡(
sig
 >= 0)

99 
Êags
 |
O_ASYNC
;

101 
Êags
 &~
O_ASYNC
;

102 i‡(
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
) < 0) {

103 
	`SYSERR
("F_SETFL for O_ASYNC failed");

104  -
î∫o
;

106 i‡(
sig
 < 0)

108 i‡(
	`f˙é
(
fd
, 
F_SETSIG
, ()
sig
) < 0) {

109 
	`SYSERR
("F_SETSIG failed");

110  -
î∫o
;

112 i‡(
	`f˙é
(
fd
, 
F_SETOWN
, ()
pid
) < 0) {

113 
	`SYSERR
("F_SETOWN failed");

114  -
î∫o
;

117 
	}
}

119 
	$¢d_˘l_hw_subs¸ibe_evíts
(
¢d_˘l_t
 *
h™dÀ
, 
subs¸ibe
)

121 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

122 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_SUBSCRIBE_EVENTS
, &
subs¸ibe
) < 0) {

123 
	`SYSERR
("SNDRV_CTL_IOCTL_SUBSCRIBE_EVENTS failed");

124  -
î∫o
;

127 
	}
}

129 
	$¢d_˘l_hw_ˇrd_öfo
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_ˇrd_öfo_t
 *
öfo
)

131 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

132 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_CARD_INFO
, 
öfo
) < 0) {

133 
	`SYSERR
("SNDRV_CTL_IOCTL_CARD_INFO failed");

134  -
î∫o
;

137 
	}
}

139 
	$¢d_˘l_hw_ñem_li°
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_ñem_li°_t
 *
li°
)

141 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

142 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_LIST
, 
li°
) < 0)

143  -
î∫o
;

145 
	}
}

147 
	$¢d_˘l_hw_ñem_öfo
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_ñem_öfo_t
 *
öfo
)

149 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

150 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_INFO
, 
öfo
) < 0)

151  -
î∫o
;

153 
	}
}

155 
	$¢d_˘l_hw_ñem_add
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_ñem_öfo_t
 *
öfo
)

157 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

159 i‡(
öfo
->
ty≥
 =
SNDRV_CTL_ELEM_TYPE_ENUMERATED
 &&

160 
hw
->
¥Ÿocﬁ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 7))

161  -
ENXIO
;

163 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_ADD
, 
öfo
) < 0)

164  -
î∫o
;

166 
	}
}

168 
	$¢d_˘l_hw_ñem_ª∂a˚
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_ñem_öfo_t
 *
öfo
)

170 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

172 i‡(
öfo
->
ty≥
 =
SNDRV_CTL_ELEM_TYPE_ENUMERATED
 &&

173 
hw
->
¥Ÿocﬁ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 7))

174  -
ENXIO
;

176 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_REPLACE
, 
öfo
) < 0)

177  -
î∫o
;

179 
	}
}

181 
	$¢d_˘l_hw_ñem_ªmove
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_ñem_id_t
 *
id
)

183 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

184 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_REMOVE
, 
id
) < 0)

185  -
î∫o
;

187 
	}
}

189 
	$¢d_˘l_hw_ñem_ªad
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_ñem_vÆue_t
 *
c⁄åﬁ
)

191 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

192 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_READ
, 
c⁄åﬁ
) < 0)

193  -
î∫o
;

195 
	}
}

197 
	$¢d_˘l_hw_ñem_wrôe
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_ñem_vÆue_t
 *
c⁄åﬁ
)

199 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

200 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_WRITE
, 
c⁄åﬁ
) < 0)

201  -
î∫o
;

203 
	}
}

205 
	$¢d_˘l_hw_ñem_lock
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_ñem_id_t
 *
id
)

207 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

208 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_LOCK
, 
id
) < 0)

209  -
î∫o
;

211 
	}
}

213 
	$¢d_˘l_hw_ñem_u∆ock
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_ñem_id_t
 *
id
)

215 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

216 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_ELEM_UNLOCK
, 
id
) < 0)

217  -
î∫o
;

219 
	}
}

221 
	$¢d_˘l_hw_ñem_év
(
¢d_˘l_t
 *
h™dÀ
, 
›_Êag
,

222 
numid
,

223 *
év
, 
év_size
)

225 
öum
;

226 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

227 
¢d_˘l_év
 *
xév
;

230 i‡(
hw
->
¥Ÿocﬁ
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4))

231  -
ENXIO
;

233 
›_Êag
) {

234 -1: 
öum
 = 
SNDRV_CTL_IOCTL_TLV_COMMAND
; ;

235 0: 
öum
 = 
SNDRV_CTL_IOCTL_TLV_READ
; ;

236 1: 
öum
 = 
SNDRV_CTL_IOCTL_TLV_WRITE
; ;

237 :  -
EINVAL
;

239 
xév
 = 
	`mÆloc
((
¢d_˘l_év
Ë+ 
év_size
);

240 i‡(
xév
 =
NULL
)

241  -
ENOMEM
;

242 
xév
->
numid
 =Çumid;

243 
xév
->
Àngth
 = 
év_size
;

244 
	`mem˝y
(
xév
->
év
,Ålv, 
év_size
);

245 i‡(
	`io˘l
(
hw
->
fd
, 
öum
, 
xév
) < 0) {

246 
	`‰ì
(
xév
);

247  -
î∫o
;

249 i‡(
›_Êag
 == 0) {

250 
size
;

251 
size
 = 
xév
->
év
[
SNDRV_CTL_TLVO_LEN
] + 2 * ();

252 i‡(
size
 > 
év_size
) {

253 
	`‰ì
(
xév
);

254  -
EFAULT
;

256 
	`mem˝y
(
év
, 
xév
->év, 
size
);

258 
	`‰ì
(
xév
);

260 
	}
}

262 
	$¢d_˘l_hw_hwdï_√xt_devi˚
(
¢d_˘l_t
 *
h™dÀ
, * 
devi˚
)

264 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

265 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_HWDEP_NEXT_DEVICE
, 
devi˚
) < 0)

266  -
î∫o
;

268 
	}
}

270 
	$¢d_˘l_hw_hwdï_öfo
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_hwdï_öfo_t
 * 
öfo
)

272 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

273 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_HWDEP_INFO
, 
öfo
) < 0)

274  -
î∫o
;

276 
	}
}

278 
	$¢d_˘l_hw_pcm_√xt_devi˚
(
¢d_˘l_t
 *
h™dÀ
, * 
devi˚
)

280 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

281 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_PCM_NEXT_DEVICE
, 
devi˚
) < 0)

282  -
î∫o
;

284 
	}
}

286 
	$¢d_˘l_hw_pcm_öfo
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_pcm_öfo_t
 * 
öfo
)

288 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

289 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_PCM_INFO
, 
öfo
) < 0)

290  -
î∫o
;

292 i‡(
	`__¢d_pcm_öfo_ñd_fixup_check
(
öfo
))

293  
	`__¢d_pcm_öfo_ñd_fixup
(
öfo
);

295 
	}
}

297 
	$¢d_˘l_hw_pcm_¥e„r_subdevi˚
(
¢d_˘l_t
 *
h™dÀ
, 
subdev
)

299 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

300 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_PCM_PREFER_SUBDEVICE
, &
subdev
) < 0)

301  -
î∫o
;

303 
	}
}

305 
	$¢d_˘l_hw_øwmidi_√xt_devi˚
(
¢d_˘l_t
 *
h™dÀ
, * 
devi˚
)

307 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

308 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_RAWMIDI_NEXT_DEVICE
, 
devi˚
) < 0)

309  -
î∫o
;

311 
	}
}

313 
	$¢d_˘l_hw_øwmidi_öfo
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_øwmidi_öfo_t
 * 
öfo
)

315 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

316 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_RAWMIDI_INFO
, 
öfo
) < 0)

317  -
î∫o
;

319 
	}
}

321 
	$¢d_˘l_hw_øwmidi_¥e„r_subdevi˚
(
¢d_˘l_t
 *
h™dÀ
, 
subdev
)

323 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

324 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_RAWMIDI_PREFER_SUBDEVICE
, &
subdev
) < 0)

325  -
î∫o
;

327 
	}
}

329 
	$¢d_˘l_hw_ump_√xt_devi˚
(
¢d_˘l_t
 *
h™dÀ
, *
devi˚
)

331 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

332 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_UMP_NEXT_DEVICE
, 
devi˚
) < 0)

333  -
î∫o
;

335 
	}
}

337 
	$¢d_˘l_hw_ump_ídpoöt_öfo
(
¢d_˘l_t
 *
h™dÀ
,

338 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

340 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

341 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_UMP_ENDPOINT_INFO
, 
öfo
) < 0)

342  -
î∫o
;

344 
	}
}

346 
	$¢d_˘l_hw_ump_block_öfo
(
¢d_˘l_t
 *
h™dÀ
,

347 
¢d_ump_block_öfo_t
 *
öfo
)

349 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

350 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_UMP_BLOCK_INFO
, 
öfo
) < 0)

351  -
î∫o
;

353 
	}
}

355 
	$¢d_˘l_hw_£t_powî_°©e
(
¢d_˘l_t
 *
h™dÀ
, 
°©e
)

357 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

358 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_POWER
, &
°©e
) < 0)

359  -
î∫o
;

361 
	}
}

363 
	$¢d_˘l_hw_gë_powî_°©e
(
¢d_˘l_t
 *
h™dÀ
, *
°©e
)

365 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

366 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_CTL_IOCTL_POWER_STATE
, 
°©e
) < 0)

367  -
î∫o
;

369 
	}
}

371 
	$¢d_˘l_hw_ªad
(
¢d_˘l_t
 *
h™dÀ
, 
¢d_˘l_evít_t
 *
evít
)

373 
¢d_˘l_hw_t
 *
hw
 = 
h™dÀ
->
¥iv©e_d©a
;

374 
ssize_t
 
ªs
 = 
	`ªad
(
hw
->
fd
, 
evít
, (*event));

375 i‡(
ªs
 <= 0)

376  -
î∫o
;

377 i‡(
	`CHECK_SANITY
(
ªs
 !(*
evít
))) {

378 
	`SNDMSG
("snd_ctl_hw_read:Ñead sizeÉrror (req:%d, got:%d)",

379 (*
evít
), 
ªs
);

380  -
EINVAL
;

383 
	}
}

385 c⁄° 
¢d_˘l_›s_t
 
	g¢d_˘l_hw_›s
 = {

386 .
˛o£
 = 
¢d_˘l_hw_˛o£
,

387 .
	gn⁄block
 = 
¢d_˘l_hw_n⁄block
,

388 .
	gasync
 = 
¢d_˘l_hw_async
,

389 .
	gsubs¸ibe_evíts
 = 
¢d_˘l_hw_subs¸ibe_evíts
,

390 .
	gˇrd_öfo
 = 
¢d_˘l_hw_ˇrd_öfo
,

391 .
	gñemít_li°
 = 
¢d_˘l_hw_ñem_li°
,

392 .
	gñemít_öfo
 = 
¢d_˘l_hw_ñem_öfo
,

393 .
	gñemít_add
 = 
¢d_˘l_hw_ñem_add
,

394 .
	gñemít_ª∂a˚
 = 
¢d_˘l_hw_ñem_ª∂a˚
,

395 .
	gñemít_ªmove
 = 
¢d_˘l_hw_ñem_ªmove
,

396 .
	gñemít_ªad
 = 
¢d_˘l_hw_ñem_ªad
,

397 .
	gñemít_wrôe
 = 
¢d_˘l_hw_ñem_wrôe
,

398 .
	gñemít_lock
 = 
¢d_˘l_hw_ñem_lock
,

399 .
	gñemít_u∆ock
 = 
¢d_˘l_hw_ñem_u∆ock
,

400 .
	gñemít_év
 = 
¢d_˘l_hw_ñem_év
,

401 .
	ghwdï_√xt_devi˚
 = 
¢d_˘l_hw_hwdï_√xt_devi˚
,

402 .
	ghwdï_öfo
 = 
¢d_˘l_hw_hwdï_öfo
,

403 .
	gpcm_√xt_devi˚
 = 
¢d_˘l_hw_pcm_√xt_devi˚
,

404 .
	gpcm_öfo
 = 
¢d_˘l_hw_pcm_öfo
,

405 .
	gpcm_¥e„r_subdevi˚
 = 
¢d_˘l_hw_pcm_¥e„r_subdevi˚
,

406 .
	gøwmidi_√xt_devi˚
 = 
¢d_˘l_hw_øwmidi_√xt_devi˚
,

407 .
	gøwmidi_öfo
 = 
¢d_˘l_hw_øwmidi_öfo
,

408 .
	gøwmidi_¥e„r_subdevi˚
 = 
¢d_˘l_hw_øwmidi_¥e„r_subdevi˚
,

409 .
	gump_√xt_devi˚
 = 
¢d_˘l_hw_ump_√xt_devi˚
,

410 .
	gump_ídpoöt_öfo
 = 
¢d_˘l_hw_ump_ídpoöt_öfo
,

411 .
	gump_block_öfo
 = 
¢d_˘l_hw_ump_block_öfo
,

412 .
	g£t_powî_°©e
 = 
¢d_˘l_hw_£t_powî_°©e
,

413 .
	ggë_powî_°©e
 = 
¢d_˘l_hw_gë_powî_°©e
,

414 .
	gªad
 = 
¢d_˘l_hw_ªad
,

428 
	$¢d_˘l_hw_›í
(
¢d_˘l_t
 **
h™dÀ
, c⁄° *
«me
, 
ˇrd
, 
mode
)

430 
fd
, 
vî
;

431 
fûíame
[(
SNDRV_FILE_CONTROL
) + 10];

432 
fmode
;

433 
¢d_˘l_t
 *
˘l
;

434 
¢d_˘l_hw_t
 *
hw
;

435 
îr
;

437 *
h™dÀ
 = 
NULL
;

439 i‡(
	`CHECK_SANITY
(
ˇrd
 < 0 || c¨d >
SND_MAX_CARDS
)) {

440 
	`SNDMSG
("InvÆid c¨d index %d", 
ˇrd
);

441  -
EINVAL
;

443 
	`•rötf
(
fûíame
, 
SNDRV_FILE_CONTROL
, 
ˇrd
);

444 i‡(
mode
 & 
SND_CTL_READONLY
)

445 
fmode
 = 
O_RDONLY
;

447 
fmode
 = 
O_RDWR
;

448 i‡(
mode
 & 
SND_CTL_NONBLOCK
)

449 
fmode
 |
O_NONBLOCK
;

450 i‡(
mode
 & 
SND_CTL_ASYNC
)

451 
fmode
 |
O_ASYNC
;

452 
fd
 = 
	`¢d_›í_devi˚
(
fûíame
, 
fmode
);

453 i‡(
fd
 < 0) {

454 
	`¢d_ˇrd_lﬂd
(
ˇrd
);

455 
fd
 = 
	`¢d_›í_devi˚
(
fûíame
, 
fmode
);

456 i‡(
fd
 < 0)

457  -
î∫o
;

459 i‡(
	`io˘l
(
fd
, 
SNDRV_CTL_IOCTL_PVERSION
, &
vî
) < 0) {

460 
îr
 = -
î∫o
;

461 
	`˛o£
(
fd
);

462  
îr
;

464 i‡(
	`SNDRV_PROTOCOL_INCOMPATIBLE
(
vî
, 
SNDRV_CTL_VERSION_MAX
)) {

465 
	`˛o£
(
fd
);

466  -
SND_ERROR_INCOMPATIBLE_VERSION
;

468 
hw
 = 
	`ˇŒoc
(1, (
¢d_˘l_hw_t
));

469 i‡(
hw
 =
NULL
) {

470 
	`˛o£
(
fd
);

471  -
ENOMEM
;

473 
hw
->
ˇrd
 = card;

474 
hw
->
fd
 = fd;

475 
hw
->
¥Ÿocﬁ
 = 
vî
;

477 
îr
 = 
	`¢d_˘l_√w
(&
˘l
, 
SND_CTL_TYPE_HW
, 
«me
, 
mode
);

478 i‡(
îr
 < 0) {

479 
	`˛o£
(
fd
);

480 
	`‰ì
(
hw
);

481  
îr
;

483 
˘l
->
›s
 = &
¢d_˘l_hw_›s
;

484 
˘l
->
¥iv©e_d©a
 = 
hw
;

485 
˘l
->
pﬁl_fd
 = 
fd
;

486 *
h™dÀ
 = 
˘l
;

488 
	}
}

524 
	$_¢d_˘l_hw_›í
(
¢d_˘l_t
 **
h™dÀp
, *
«me
, 
¢d_c⁄fig_t
 *
roŸ
 
ATTRIBUTE_UNUSED
, snd_c⁄fig_à*
c⁄f
, 
mode
)

526 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

527 
ˇrd
 = -1;

528 
îr
;

529 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

530 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

531 c⁄° *
id
;

532 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

534 i‡(
	`_¢d_c⁄f_gíîic_id
(
id
))

536 i‡(
	`°rcmp
(
id
, "card") == 0) {

537 
îr
 = 
	`¢d_c⁄fig_gë_ˇrd
(
n
);

538 i‡(
îr
 < 0)

539  
îr
;

540 
ˇrd
 = 
îr
;

543  -
EINVAL
;

545 i‡(
ˇrd
 < 0)

546  -
EINVAL
;

547  
	`¢d_˘l_hw_›í
(
h™dÀp
, 
«me
, 
ˇrd
, 
mode
);

548 
	}
}

549 #i‚de‡
DOC_HIDDEN


550 
SND_DLSYM_BUILD_VERSION
(
_¢d_˘l_hw_›í
, 
SND_CONTROL_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_local.h

22 
	~"loˇl.h
"

23 
	~<sound/év.h
>

25 
	s_¢d_˘l_›s
 {

26 (*
	m˛o£
)(
¢d_˘l_t
 *
	mh™dÀ
);

27 (*
	mn⁄block
)(
¢d_˘l_t
 *
	mh™dÀ
, nonblock);

28 (*
	masync
)(
¢d_˘l_t
 *
	mh™dÀ
, 
	msig
, 
pid_t
 
	mpid
);

29 (*
	msubs¸ibe_evíts
)(
¢d_˘l_t
 *
	mh™dÀ
, 
	msubs¸ibe
);

30 (*
	mˇrd_öfo
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_˘l_ˇrd_öfo_t
 *
	möfo
);

31 (*
	mñemít_li°
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_˘l_ñem_li°_t
 *
	mli°
);

32 (*
	mñemít_öfo
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_˘l_ñem_öfo_t
 *
	möfo
);

33 (*
	mñemít_add
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_˘l_ñem_öfo_t
 *
	möfo
);

34 (*
	mñemít_ª∂a˚
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_˘l_ñem_öfo_t
 *
	möfo
);

35 (*
	mñemít_ªmove
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_˘l_ñem_id_t
 *
	mid
);

36 (*
	mñemít_ªad
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_˘l_ñem_vÆue_t
 *
	mc⁄åﬁ
);

37 (*
	mñemít_wrôe
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_˘l_ñem_vÆue_t
 *
	mc⁄åﬁ
);

38 (*
	mñemít_lock
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_˘l_ñem_id_t
 *
	mlock
);

39 (*
	mñemít_u∆ock
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_˘l_ñem_id_t
 *
	mu∆ock
);

40 (*
	mñemít_év
)(
¢d_˘l_t
 *
	mh™dÀ
, 
	m›_Êag
, 
	mnumid
,

41 *
	mév
, 
	mév_size
);

42 (*
	mhwdï_√xt_devi˚
)(
¢d_˘l_t
 *
	mh™dÀ
, *
	mdevi˚
);

43 (*
	mhwdï_öfo
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_hwdï_öfo_t
 * 
	möfo
);

44 (*
	mpcm_√xt_devi˚
)(
¢d_˘l_t
 *
	mh™dÀ
, *
	mdevi˚
);

45 (*
	mpcm_öfo
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_pcm_öfo_t
 * 
	möfo
);

46 (*
	mpcm_¥e„r_subdevi˚
)(
¢d_˘l_t
 *
	mh™dÀ
, 
	msubdev
);

47 (*
	møwmidi_√xt_devi˚
)(
¢d_˘l_t
 *
	mh™dÀ
, *
	mdevi˚
);

48 (*
	møwmidi_öfo
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_øwmidi_öfo_t
 * 
	möfo
);

49 (*
	møwmidi_¥e„r_subdevi˚
)(
¢d_˘l_t
 *
	mh™dÀ
, 
	msubdev
);

50 (*
	mump_√xt_devi˚
)(
¢d_˘l_t
 *
	mh™dÀ
, *
	mdevi˚
);

51 (*
	mump_ídpoöt_öfo
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_ump_ídpoöt_öfo_t
 *
	möfo
);

52 (*
	mump_block_öfo
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_ump_block_öfo_t
 *
	möfo
);

53 (*
	m£t_powî_°©e
)(
¢d_˘l_t
 *
	mh™dÀ
, 
	m°©e
);

54 (*
	mgë_powî_°©e
)(
¢d_˘l_t
 *
	mh™dÀ
, *
	m°©e
);

55 (*
	mªad
)(
¢d_˘l_t
 *
	mh™dÀ
, 
¢d_˘l_evít_t
 *
	mevít
);

56 (*
	mpﬁl_des¸ùt‹s_cou¡
)(
¢d_˘l_t
 *
	mh™dÀ
);

57 (*
	mpﬁl_des¸ùt‹s
)(
¢d_˘l_t
 *
	mh™dÀ
, 
pﬁlfd
 *
	mpfds
, 
	m•a˚
);

58 (*
	mpﬁl_ªvíts
)(
¢d_˘l_t
 *
	mh™dÀ
, 
pﬁlfd
 *
	mpfds
, 
	mnfds
, *
	mªvíts
);

59 } 
	t¢d_˘l_›s_t
;

62 
	s_¢d_˘l
 {

63 *
	m›í_func
;

64 *
	m«me
;

65 
¢d_˘l_ty≥_t
 
	mty≥
;

66 c⁄° 
¢d_˘l_›s_t
 *
	m›s
;

67 *
	m¥iv©e_d©a
;

68 
	mmode
;

69 
	mn⁄block
;

70 
	mpﬁl_fd
;

71 
li°_hód
 
	masync_h™dÀrs
;

74 
	s_¢d_h˘l_ñem
 {

75 
¢d_˘l_ñem_id_t
 
	mid
;

76 
li°_hód
 
	mli°
;

77 
	mcom∑ª_weight
;

79 
¢d_h˘l_ñem_ˇŒback_t
 
	mˇŒback
;

80 *
	mˇŒback_¥iv©e
;

82 
¢d_h˘l_t
 *
	mh˘l
;

85 
	s_¢d_h˘l
 {

86 
¢d_˘l_t
 *
	m˘l
;

87 
li°_hód
 
	mñems
;

88 
	mÆloc
;

89 
	mcou¡
;

90 
¢d_h˘l_ñem_t
 **
	m≥Àms
;

91 
¢d_h˘l_com∑ª_t
 
	mcom∑ª
;

92 
¢d_h˘l_ˇŒback_t
 
	mˇŒback
;

93 *
	mˇŒback_¥iv©e
;

98 
	#¢d_˘l_√w
 
¢d1_˘l_√w


	)

100 
¢d_˘l_√w
(
¢d_˘l_t
 **
˘Õ
, 
¢d_˘l_ty≥_t
 
ty≥
, c⁄° *
«me
, 
mode
);

101 
_¢d_˘l_pﬁl_des¸ùt‹
(
¢d_˘l_t
 *
˘l
);

102 
	#_¢d_˘l_async_des¸ùt‹
 
_¢d_˘l_pﬁl_des¸ùt‹


	)

103 
¢d_˘l_hw_›í
(
¢d_˘l_t
 **
h™dÀ
, c⁄° *
«me
, 
ˇrd
, 
mode
);

104 
¢d_˘l_shm_›í
(
¢d_˘l_t
 **
h™dÀp
, c⁄° *
«me
, c⁄° *
sock«me
, c⁄° *
¢ame
, 
mode
);

105 
¢d_˘l_async
(
¢d_˘l_t
 *
˘l
, 
sig
, 
pid_t
 
pid
);

107 
	#CTLINABORT
(
x
Ë((x)->
n⁄block
 =2)

	)

109 #ifde‡
INTERNAL


110 
	$INTERNAL
(
¢d_˘l_ñem_öfo_gë_dimísi⁄s
)(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
);

111 
	$INTERNAL
(
¢d_˘l_ñem_öfo_gë_dimísi⁄
)(c⁄° 
¢d_˘l_ñem_öfo_t
 *
obj
, 
idx
);

114 
	`_¢d_˘l_›í_«med_chûd
(
¢d_˘l_t
 **
p˘l
, c⁄° *
«me
,

115 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

116 
mode
, 
¢d_c⁄fig_t
 *
∑ª¡_c⁄f
);

117 
ölöe
 

118 
	$_¢d_˘l_›í_chûd
(
¢d_˘l_t
 **
p˘l
, 
¢d_c⁄fig_t
 *
roŸ
,

119 
¢d_c⁄fig_t
 *
c⁄f
, 
mode
, snd_c⁄fig_à*
∑ª¡_c⁄f
)

121  
	`_¢d_˘l_›í_«med_chûd
(
p˘l
, 
NULL
, 
roŸ
, 
c⁄f
, 
mode
, 
∑ª¡_c⁄f
);

122 
	}
}

124 
__¢d_˘l_add_ñem_£t
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
,

125 
ñemít_cou¡
,

126 
membî_cou¡
);

128 
__¢d_˘l_ascii_ñem_id_∑r£
(
¢d_˘l_ñem_id_t
 *
d°
,

129 c⁄° *
°r
,

130 c⁄° **
ªt_±r
);

132 
ölöe
 

133 
	$__¢d_pcm_öfo_ñd_fixup_check
(
¢d_pcm_öfo_t
 *
öfo
)

135  
öfo
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
 &&

136 
	`°∫cmp
((*)
öfo
->
«me
, "HDMI ", 5) == 0;

137 
	}
}

139 
__¢d_pcm_öfo_ñd_fixup
(
¢d_pcm_öfo_t
 *
öfo
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_plugin.c

61 
	~"c⁄åﬁ_loˇl.h
"

62 
	~"c⁄åﬁ_∂ugö.h
"

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_remap.c

28 
	~"c⁄åﬁ_loˇl.h
"

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°döt.h
>

32 
	~<°d¨g.h
>

33 
	~<uni°d.h
>

34 
	~<°rög.h
>

36 #i‚de‡
DOC_HIDDEN


38 
	#REMAP_DEBUG
 1

	)

39 
	#debug
(
f‹m©
, 
¨gs
...Ë
	`Ârötf
(
°dîr
, f‹m©, ##¨gs)

	)

40 
	#debug_id
(
id
, 
f‹m©
, 
¨gs
...) do { \

41 *
s
 = 
	`¢d_˘l_ascii_ñem_id_gë
(
id
); \

42 
	`Ârötf
(
°dîr
, "%s: ", 
s
); 
	`‰ì
(s); \

43 
	`Ârötf
(
°dîr
, 
f‹m©
, ##
¨gs
); \

44 } 0)

	)

46 
	#REMAP_DEBUG
 0

	)

47 
	#debug
(
f‹m©
, 
¨gs
...Ëdÿ{ } 0)

	)

48 
	#debug_id
(
id
, 
f‹m©
, 
¨gs
...Ëdÿ{ } 0)

	)

51 
	#EREMAPNOTFOUND
 (888899)

	)

54 #i‚de‡
PIC


56 c⁄° *
	g_¢d_moduÀ_c⁄åﬁ_ªm≠
 = "";

59 #i‚de‡
DOC_HIDDEN


61 
	mnumid_chûd
;

62 
	mnumid_≠p
;

63 } 
	t¢d_˘l_numid_t
;

66 
¢d_˘l_ñem_id_t
 
	mid_chûd
;

67 
¢d_˘l_ñem_id_t
 
	mid_≠p
;

68 } 
	t¢d_˘l_ªm≠_id_t
;

71 
¢d_˘l_ñem_id_t
 
	mm≠_id
;

72 
¢d_˘l_ñem_ty≥_t
 
	mty≥
;

73 
size_t
 
	mc⁄åﬁs_ôems
;

74 
size_t
 
	mc⁄åﬁs_Æloc
;

75 
	s¢d_˘l_m≠_˘l
 {

76 
¢d_˘l_ñem_id_t
 
	mid_chûd
;

77 
size_t
 
	mch™√l_m≠_ôems
;

78 
size_t
 
	mch™√l_m≠_Æloc
;

79 *
	mch™√l_m≠
;

80 } *
	mc⁄åﬁs
;

81 
	mevít_mask
;

82 } 
	t¢d_˘l_m≠_t
;

85 
¢d_˘l_t
 *
	mchûd
;

86 
	mnumid_ªm≠_a˘ive
;

87 
	mnumid_≠p_œ°
;

88 
size_t
 
	mnumid_ôems
;

89 
size_t
 
	mnumid_Æloc
;

90 
¢d_˘l_numid_t
 *
	mnumid
;

91 
¢d_˘l_numid_t
 
	mnumid_ãmp
;

92 
size_t
 
	mªm≠_ôems
;

93 
size_t
 
	mªm≠_Æloc
;

94 
¢d_˘l_ªm≠_id_t
 *
	mªm≠
;

95 
size_t
 
	mm≠_ôems
;

96 
size_t
 
	mm≠_Æloc
;

97 
¢d_˘l_m≠_t
 *
	mm≠
;

98 
size_t
 
	mm≠_ªad_queue_hód
;

99 
size_t
 
	mm≠_ªad_queue_èû
;

100 
¢d_˘l_m≠_t
 **
	mm≠_ªad_queue
;

101 } 
	t¢d_˘l_ªm≠_t
;

104 
¢d_˘l_numid_t
 *
	$ªm≠_numid_ãmp
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
numid
)

106 
¥iv
->
numid_ãmp
.
numid_chûd
 = 
numid
;

107 
¥iv
->
numid_ãmp
.
numid_≠p
 = 
numid
;

108  &
¥iv
->
numid_ãmp
;

109 
	}
}

111 
¢d_˘l_numid_t
 *
	$ªm≠_föd_numid_≠p
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
numid_≠p
)

113 
¢d_˘l_numid_t
 *
numid
;

114 
size_t
 
cou¡
;

116 i‡(!
¥iv
->
numid_ªm≠_a˘ive
)

117  
	`ªm≠_numid_ãmp
(
¥iv
, 
numid_≠p
);

118 
numid
 = 
¥iv
->numid;

119 
cou¡
 = 
¥iv
->
numid_ôems
; cou¡ > 0; cou¡--, 
numid
++)

120 i‡(
numid_≠p
 =
numid
->numid_app)

121  
numid
;

122  
NULL
;

123 
	}
}

125 
¢d_˘l_numid_t
 *
	$ªm≠_numid_√w
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
numid_chûd
,

126 
numid_≠p
)

128 
¢d_˘l_numid_t
 *
numid
;

130 i‡(
¥iv
->
numid_Æloc
 =¥iv->
numid_ôems
) {

131 
numid
 = 
	`ªÆloc
(
¥iv
->numid, (¥iv->
numid_Æloc
 + 16) * (*numid));

132 i‡(
numid
 =
NULL
)

133  
NULL
;

134 
	`mem£t
(
numid
 + 
¥iv
->
numid_Æloc
, 0, (*numid) * 16);

135 
¥iv
->
numid_Æloc
 += 16;

136 
¥iv
->
numid
 =Çumid;

138 
numid
 = &
¥iv
->numid[¥iv->
numid_ôems
++];

139 
numid
->
numid_chûd
 =Çumid_child;

140 
numid
->
numid_≠p
 =Çumid_app;

141 
	`debug
("√wÇumid: chûd %uáµ %u\n", 
numid
->
numid_chûd
,Çumid->
numid_≠p
);

142  
numid
;

143 
	}
}

145 
¢d_˘l_numid_t
 *
	$ªm≠_numid_chûd_√w
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
numid_chûd
)

147 
numid_≠p
;

149 i‡(
numid_chûd
 == 0)

150  
NULL
;

151 i‡(
¥iv
->
numid_ªm≠_a˘ive
 && 
	`ªm≠_föd_numid_≠p
’riv, 
numid_chûd
)) {

152 
	`ªm≠_föd_numid_≠p
(
¥iv
,Öriv->
numid_≠p_œ°
))

153 
¥iv
->
numid_≠p_œ°
++;

154 
numid_≠p
 = 
¥iv
->
numid_≠p_œ°
;

156 
numid_≠p
 = 
numid_chûd
;

158  
	`ªm≠_numid_√w
(
¥iv
, 
numid_chûd
, 
numid_≠p
);

159 
	}
}

161 
¢d_˘l_numid_t
 *
	$ªm≠_föd_numid_chûd
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
numid_chûd
)

163 
¢d_˘l_numid_t
 *
numid
;

164 
size_t
 
cou¡
;

166 i‡(!
¥iv
->
numid_ªm≠_a˘ive
)

167  
	`ªm≠_numid_ãmp
(
¥iv
, 
numid_chûd
);

168 
numid
 = 
¥iv
->numid;

169 
cou¡
 = 
¥iv
->
numid_ôems
; cou¡ > 0; cou¡--, 
numid
++)

170 i‡(
numid_chûd
 =
numid
->numid_child)

171  
numid
;

172  
	`ªm≠_numid_chûd_√w
(
¥iv
, 
numid_chûd
);

173 
	}
}

175 
¢d_˘l_ªm≠_id_t
 *
	$ªm≠_föd_id_chûd
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
¢d_˘l_ñem_id_t
 *
id
)

177 
size_t
 
cou¡
;

178 
¢d_˘l_ªm≠_id_t
 *
rid
;

180 i‡(
id
->
numid
 > 0) {

181 
rid
 = 
¥iv
->
ªm≠
;

182 
cou¡
 = 
¥iv
->
ªm≠_ôems
; cou¡ > 0; cou¡--, 
rid
++)

183 i‡(
id
->
numid
 =
rid
->
id_chûd
.numid)

184  
rid
;

186 
rid
 = 
¥iv
->
ªm≠
;

187 
cou¡
 = 
¥iv
->
ªm≠_ôems
; cou¡ > 0; cou¡--, 
rid
++)

188 i‡(
	`¢d_˘l_ñem_id_com∑ª_£t
(
id
, &
rid
->
id_chûd
) == 0)

189  
rid
;

190  
NULL
;

191 
	}
}

193 
¢d_˘l_ªm≠_id_t
 *
	$ªm≠_föd_id_≠p
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
¢d_˘l_ñem_id_t
 *
id
)

195 
size_t
 
cou¡
;

196 
¢d_˘l_ªm≠_id_t
 *
rid
;

198 i‡(
id
->
numid
 > 0) {

199 
rid
 = 
¥iv
->
ªm≠
;

200 
cou¡
 = 
¥iv
->
ªm≠_ôems
; cou¡ > 0; cou¡--, 
rid
++)

201 i‡(
id
->
numid
 =
rid
->
id_≠p
.numid)

202  
rid
;

204 
rid
 = 
¥iv
->
ªm≠
;

205 
cou¡
 = 
¥iv
->
ªm≠_ôems
; cou¡ > 0; cou¡--, 
rid
++)

206 i‡(
	`¢d_˘l_ñem_id_com∑ª_£t
(
id
, &
rid
->
id_≠p
) == 0)

207  
rid
;

208  
NULL
;

209 
	}
}

211 
¢d_˘l_m≠_t
 *
	$ªm≠_föd_m≠_numid
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
numid
)

213 
size_t
 
cou¡
;

214 
¢d_˘l_m≠_t
 *
m≠
;

216 i‡(
numid
 == 0)

217  
NULL
;

218 
m≠
 = 
¥iv
->map;

219 
cou¡
 = 
¥iv
->
m≠_ôems
; cou¡ > 0; cou¡--, 
m≠
++) {

220 i‡(
numid
 =
m≠
->
m≠_id
.numid)

221  
m≠
;

223  
NULL
;

224 
	}
}

226 
¢d_˘l_m≠_t
 *
	$ªm≠_föd_m≠_id
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
¢d_˘l_ñem_id_t
 *
id
)

228 
size_t
 
cou¡
;

229 
¢d_˘l_m≠_t
 *
m≠
;

231 i‡(
id
->
numid
 > 0)

232  
	`ªm≠_föd_m≠_numid
(
¥iv
, 
id
->
numid
);

233 
m≠
 = 
¥iv
->map;

234 
cou¡
 = 
¥iv
->
m≠_ôems
; cou¡ > 0; cou¡--, 
m≠
++)

235 i‡(
	`¢d_˘l_ñem_id_com∑ª_£t
(
id
, &
m≠
->
m≠_id
) == 0)

236  
m≠
;

237  
NULL
;

238 
	}
}

240 
	$ªm≠_id_to_chûd
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
¢d_˘l_ñem_id_t
 *
id
, 
¢d_˘l_ªm≠_id_t
 **
_rid
)

242 
¢d_˘l_ªm≠_id_t
 *
rid
;

243 
¢d_˘l_numid_t
 *
numid
;

245 
	`debug_id
(
id
, "%†íãr\n", 
__func__
);

246 
rid
 = 
	`ªm≠_föd_id_≠p
(
¥iv
, 
id
);

247 i‡(
rid
) {

248 i‡(
rid
->
id_≠p
.
numid
 == 0) {

249 
numid
 = 
	`ªm≠_föd_numid_≠p
(
¥iv
, 
id
->numid);

250 i‡(
numid
) {

251 
rid
->
id_chûd
.
numid
 =Çumid->
numid_chûd
;

252 
rid
->
id_≠p
.
numid
 =Çumid->
numid_≠p
;

255 *
id
 = 
rid
->
id_chûd
;

257 i‡(
	`ªm≠_föd_id_chûd
(
¥iv
, 
id
))

258  -
ENOENT
;

259 
numid
 = 
	`ªm≠_föd_numid_≠p
(
¥iv
, 
id
->numid);

260 i‡(
numid
)

261 
id
->
numid
 =Çumid->
numid_chûd
;

263 
id
->
numid
 = 0;

265 *
_rid
 = 
rid
;

266 
	`debug_id
(
id
, "%†Àave\n", 
__func__
);

268 
	}
}

270 
	$ªm≠_id_to_≠p
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
¢d_˘l_ñem_id_t
 *
id
, 
¢d_˘l_ªm≠_id_t
 *
rid
, 
îr
)

272 
¢d_˘l_numid_t
 *
numid
;

274 i‡(
rid
) {

275 i‡(
îr
 >0 && 
rid
->
id_≠p
.
numid
 == 0) {

276 
numid
 = 
	`ªm≠_numid_chûd_√w
(
¥iv
, 
id
->numid);

277 i‡(
numid
 =
NULL
)

278  -
EIO
;

279 
rid
->
id_chûd
.
numid
 =Çumid->
numid_chûd
;

280 
rid
->
id_≠p
.
numid
 =Çumid->
numid_≠p
;

282 *
id
 = 
rid
->
id_≠p
;

284 i‡(
îr
 >= 0) {

285 
numid
 = 
	`ªm≠_föd_numid_chûd
(
¥iv
, 
id
->numid);

286 i‡(
numid
 =
NULL
)

287  -
EIO
;

288 
id
->
numid
 =Çumid->
numid_≠p
;

291  
îr
;

292 
	}
}

294 
	$ªm≠_‰ì
(
¢d_˘l_ªm≠_t
 *
¥iv
)

296 
size_t
 
idx1
, 
idx2
;

297 
¢d_˘l_m≠_t
 *
m≠
;

299 
idx1
 = 0; idx1 < 
¥iv
->
m≠_ôems
; idx1++) {

300 
m≠
 = &
¥iv
->m≠[
idx1
];

301 
idx2
 = 0; idx2 < 
m≠
->
c⁄åﬁs_ôems
; idx2++)

302 
	`‰ì
(
m≠
->
c⁄åﬁs
[
idx2
].
ch™√l_m≠
);

303 
	`‰ì
(
m≠
->
c⁄åﬁs
);

305 
	`‰ì
(
¥iv
->
m≠_ªad_queue
);

306 
	`‰ì
(
¥iv
->
m≠
);

307 
	`‰ì
(
¥iv
->
ªm≠
);

308 
	`‰ì
(
¥iv
->
numid
);

309 
	`‰ì
(
¥iv
);

310 
	}
}

312 
	$¢d_˘l_ªm≠_˛o£
(
¢d_˘l_t
 *
˘l
)

314 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

315 
îr
 = 
	`¢d_˘l_˛o£
(
¥iv
->
chûd
);

316 
	`ªm≠_‰ì
(
¥iv
);

317  
îr
;

318 
	}
}

320 
	$¢d_˘l_ªm≠_n⁄block
(
¢d_˘l_t
 *
˘l
, 
n⁄block
)

322 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

323  
	`¢d_˘l_n⁄block
(
¥iv
->
chûd
, 
n⁄block
);

324 
	}
}

326 
	$¢d_˘l_ªm≠_async
(
¢d_˘l_t
 *
˘l
, 
sig
, 
pid_t
 
pid
)

328 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

329  
	`¢d_˘l_async
(
¥iv
->
chûd
, 
sig
, 
pid
);

330 
	}
}

332 
	$¢d_˘l_ªm≠_subs¸ibe_evíts
(
¢d_˘l_t
 *
˘l
, 
subs¸ibe
)

334 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

335  
	`¢d_˘l_subs¸ibe_evíts
(
¥iv
->
chûd
, 
subs¸ibe
);

336 
	}
}

338 
	$¢d_˘l_ªm≠_ˇrd_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ˇrd_öfo_t
 *
öfo
)

340 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

341  
	`¢d_˘l_ˇrd_öfo
(
¥iv
->
chûd
, 
öfo
);

342 
	}
}

344 
	$¢d_˘l_ªm≠_ñem_li°
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_li°_t
 *
li°
)

346 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

347 
¢d_˘l_ñem_id_t
 *
id
;

348 
¢d_˘l_ªm≠_id_t
 *
rid
;

349 
¢d_˘l_numid_t
 *
numid
;

350 
¢d_˘l_m≠_t
 *
m≠
;

351 
ödex
;

352 
size_t
 
ödex2
;

353 
îr
;

355 
îr
 = 
	`¢d_˘l_ñem_li°
(
¥iv
->
chûd
, 
li°
);

356 i‡(
îr
 < 0)

357  
îr
;

358 
ödex
 = 0; index < 
li°
->
u£d
; index++) {

359 
id
 = &
li°
->
pids
[
ödex
];

360 
rid
 = 
	`ªm≠_föd_id_chûd
(
¥iv
, 
id
);

361 i‡(
rid
) {

362 
rid
->
id_≠p
.
numid
 = 
id
->numid;

363 *
id
 = 
rid
->
id_≠p
;

365 
numid
 = 
	`ªm≠_föd_numid_chûd
(
¥iv
, 
id
->numid);

366 i‡(
numid
 =
NULL
)

367  -
EIO
;

368 
id
->
numid
 =Çumid->
numid_≠p
;

370 i‡(
li°
->
off£t
 >li°->
cou¡
 + 
¥iv
->
m≠_ôems
)

372 
ödex2
 = 0;

373 i‡(
li°
->
off£t
 >Üi°->
cou¡
)

374 
ödex2
 = 
li°
->
off£t
 -Üi°->
cou¡
;

375  ; 
ödex
 < 
li°
->
•a˚
 && 
ödex2
 < 
¥iv
->
m≠_ôems
; index2++, index++) {

376 
id
 = &
li°
->
pids
[
ödex
];

377 
m≠
 = &
¥iv
->m≠[
ödex2
];

378 *
id
 = 
m≠
->
m≠_id
;

379 
li°
->
u£d
++;

381 
li°
->
cou¡
 +
¥iv
->
m≠_ôems
;

383 
	}
}

385 #i‚de‡
DOC_HIDDEN


386 
	#ACCESS_BITS
(
bôs
) \

387 (
bôs
 & (
SNDRV_CTL_ELEM_ACCESS_READWRITE
|\

388 
SNDRV_CTL_ELEM_ACCESS_VOLATILE
|\

389 
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
))

	)

392 
	$ªm≠_m≠_ñem_öfo
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
¢d_˘l_ñem_öfo_t
 *
öfo
)

394 
¢d_˘l_m≠_t
 *
m≠
;

395 
¢d_˘l_ñem_öfo_t
 
öfo2
, 
öfo3
;

396 
size_t
 
ôem
;

397 
ac˚ss
;

398 
size_t
 
cou¡
;

399 
ow√r
, 
îr
;

401 
m≠
 = 
	`ªm≠_föd_m≠_id
(
¥iv
, &
öfo
->
id
);

402 i‡(
m≠
 =
NULL
)

403  -
EREMAPNOTFOUND
;

404 
	`debug_id
(&
öfo
->
id
, "%s\n", 
__func__
);

405 
	`as£π
(
m≠
->
c⁄åﬁs_ôems
 > 0);

406 
	`¢d_˘l_ñem_öfo_˛ór
(&
öfo2
);

407 
öfo2
.
id
 = 
m≠
->
c⁄åﬁs
[0].
id_chûd
;

408 
	`debug_id
(&
öfo2
.
id
, "%†c⁄åﬁs[0]\n", 
__func__
);

409 
îr
 = 
	`¢d_˘l_ñem_öfo
(
¥iv
->
chûd
, &
öfo2
);

410 i‡(
îr
 < 0)

411  
îr
;

412 i‡(
öfo2
.
ty≥
 !
SNDRV_CTL_ELEM_TYPE_BOOLEAN
 &&

413 
öfo2
.
ty≥
 !
SNDRV_CTL_ELEM_TYPE_INTEGER
 &&

414 
öfo2
.
ty≥
 !
SNDRV_CTL_ELEM_TYPE_INTEGER64
 &&

415 
öfo2
.
ty≥
 !
SNDRV_CTL_ELEM_TYPE_BYTES
)

416  -
EIO
;

417 
m≠
->
c⁄åﬁs
[0].
id_chûd
.
numid
 = 
öfo2
.
id
.numid;

418 
m≠
->
ty≥
 = 
öfo2
.type;

419 
ac˚ss
 = 
öfo2
.access;

420 
ow√r
 = 
öfo2
.owner;

421 
cou¡
 = 
m≠
->
c⁄åﬁs
[0].
ch™√l_m≠_ôems
;

422 
ôem
 = 1; iãm < 
m≠
->
c⁄åﬁs_ôems
; item++) {

423 
	`¢d_˘l_ñem_öfo_˛ór
(&
öfo3
);

424 
öfo3
.
id
 = 
m≠
->
c⁄åﬁs
[
ôem
].
id_chûd
;

425 
	`debug_id
(&
öfo3
.
id
, "%†c⁄åﬁs[%zd]\n", 
__func__
, 
ôem
);

426 
îr
 = 
	`¢d_˘l_ñem_öfo
(
¥iv
->
chûd
, &
öfo3
);

427 i‡(
îr
 < 0)

428  
îr
;

429 i‡(
öfo2
.
ty≥
 !
öfo3
.type)

430  -
EIO
;

431 i‡(
	`ACCESS_BITS
(
öfo2
.
ac˚ss
Ë!ACCESS_BITS(
öfo3
.access))

432  -
EIO
;

433 i‡(
öfo2
.
ty≥
 =
SNDRV_CTL_ELEM_TYPE_BOOLEAN
 ||

434 
öfo2
.
ty≥
 =
SNDRV_CTL_ELEM_TYPE_INTEGER
) {

435 i‡(
	`memcmp
(&
öfo2
.
vÆue
.
öãgî
, &
öfo3
.value.integer, (info2.value.integer)))

436  -
EIO
;

437 } i‡(
öfo2
.
ty≥
 =
SNDRV_CTL_ELEM_TYPE_INTEGER64
) {

438 i‡(
	`memcmp
(&
öfo2
.
vÆue
.
öãgî64
, &
öfo3
.value.integer64, (info2.value.integer64)))

439  -
EIO
;

441 
ac˚ss
 |
öfo3
.access;

442 i‡(
ow√r
 == 0)

443 
ow√r
 = 
öfo3
.owner;

444 i‡(
cou¡
 < 
m≠
->
c⁄åﬁs
[
ôem
].
ch™√l_m≠_ôems
)

445 
cou¡
 = 
m≠
->
c⁄åﬁs
[
ôem
].
ch™√l_m≠_ôems
;

447 
	`¢d_˘l_ñem_öfo_˛ór
(
öfo
);

448 
öfo
->
id
 = 
m≠
->
m≠_id
;

449 
öfo
->
ty≥
 = 
öfo2
.type;

450 
öfo
->
ac˚ss
 =áccess;

451 
öfo
->
cou¡
 = count;

452 i‡(
öfo2
.
ty≥
 =
SNDRV_CTL_ELEM_TYPE_BOOLEAN
 ||

453 
öfo2
.
ty≥
 =
SNDRV_CTL_ELEM_TYPE_INTEGER
)

454 
öfo
->
vÆue
.
öãgî
 = 
öfo2
.value.integer;

455 i‡(
öfo2
.
ty≥
 =
SNDRV_CTL_ELEM_TYPE_INTEGER64
)

456 
öfo
->
vÆue
.
öãgî64
 = 
öfo2
.value.integer64;

457 i‡(
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_LOCK
)

458 
öfo
->
ow√r
 = owner;

460 
	}
}

462 
	$¢d_˘l_ªm≠_ñem_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
)

464 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

465 
¢d_˘l_ªm≠_id_t
 *
rid
;

466 
îr
;

468 
	`debug_id
(&
öfo
->
id
, "%s\n", 
__func__
);

469 
îr
 = 
	`ªm≠_m≠_ñem_öfo
(
¥iv
, 
öfo
);

470 i‡(
îr
 !-
EREMAPNOTFOUND
)

471  
îr
;

472 
îr
 = 
	`ªm≠_id_to_chûd
(
¥iv
, &
öfo
->
id
, &
rid
);

473 i‡(
îr
 < 0)

474  
îr
;

475 
îr
 = 
	`¢d_˘l_ñem_öfo
(
¥iv
->
chûd
, 
öfo
);

476  
	`ªm≠_id_to_≠p
(
¥iv
, &
öfo
->
id
, 
rid
, 
îr
);

477 
	}
}

479 
	$ªm≠_m≠_ñem_ªad
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
¢d_˘l_ñem_vÆue_t
 *
c⁄åﬁ
)

481 
¢d_˘l_m≠_t
 *
m≠
;

482 
¢d_˘l_m≠_˘l
 *
m˘l
;

483 
¢d_˘l_ñem_vÆue_t
 
c⁄åﬁ2
;

484 
size_t
 
ôem
, 
ödex
;

485 
îr
;

487 
m≠
 = 
	`ªm≠_föd_m≠_id
(
¥iv
, &
c⁄åﬁ
->
id
);

488 i‡(
m≠
 =
NULL
)

489  -
EREMAPNOTFOUND
;

490 
	`debug_id
(&
c⁄åﬁ
->
id
, "%s\n", 
__func__
);

491 
	`¢d_˘l_ñem_vÆue_˛ór
(
c⁄åﬁ
);

492 
c⁄åﬁ
->
id
 = 
m≠
->
m≠_id
;

493 
ôem
 = 0; iãm < 
m≠
->
c⁄åﬁs_ôems
; item++) {

494 
m˘l
 = &
m≠
->
c⁄åﬁs
[
ôem
];

495 
	`¢d_˘l_ñem_vÆue_˛ór
(&
c⁄åﬁ2
);

496 
c⁄åﬁ2
.
id
 = 
m˘l
->
id_chûd
;

497 
	`debug_id
(&
c⁄åﬁ2
.
id
, "%†c⁄åﬁs[%zd]\n", 
__func__
, 
ôem
);

498 
îr
 = 
	`¢d_˘l_ñem_ªad
(
¥iv
->
chûd
, &
c⁄åﬁ2
);

499 i‡(
îr
 < 0)

500  
îr
;

501 i‡(
m≠
->
ty≥
 =
SNDRV_CTL_ELEM_TYPE_BOOLEAN
 ||

502 
m≠
->
ty≥
 =
SNDRV_CTL_ELEM_TYPE_INTEGER
) {

503 
ödex
 = 0; index < 
m˘l
->
ch™√l_m≠_ôems
; index++) {

504 
§c
 = 
m˘l
->
ch™√l_m≠
[
ödex
];

505 i‡(()
§c
 < 
	`ARRAY_SIZE
(
c⁄åﬁ
->
vÆue
.
öãgî
.value))

506 
c⁄åﬁ
->
vÆue
.
öãgî
.vÆue[
ödex
] = 
c⁄åﬁ2
.vÆue.öãgî.vÆue[
§c
];

508 } i‡(
m≠
->
ty≥
 =
SNDRV_CTL_ELEM_TYPE_INTEGER64
) {

509 
ödex
 = 0; index < 
m˘l
->
ch™√l_m≠_ôems
; index++) {

510 
§c
 = 
m˘l
->
ch™√l_m≠
[
ödex
];

511 i‡(()
§c
 < 
	`ARRAY_SIZE
(
c⁄åﬁ
->
vÆue
.
öãgî64
.value))

512 
c⁄åﬁ
->
vÆue
.
öãgî64
.vÆue[
ödex
] = 
c⁄åﬁ2
.vÆue.öãgî64.vÆue[
§c
];

514 } i‡(
m≠
->
ty≥
 =
SNDRV_CTL_ELEM_TYPE_BYTES
) {

515 
ödex
 = 0; index < 
m˘l
->
ch™√l_m≠_ôems
; index++) {

516 
§c
 = 
m˘l
->
ch™√l_m≠
[
ödex
];

517 i‡(()
§c
 < 
	`ARRAY_SIZE
(
c⁄åﬁ
->
vÆue
.
byãs
.
d©a
))

518 
c⁄åﬁ
->
vÆue
.
byãs
.
d©a
[
ödex
] = 
c⁄åﬁ2
.vÆue.byãs.d©a[
§c
];

523 
	}
}

525 
	$¢d_˘l_ªm≠_ñem_ªad
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_vÆue_t
 *
c⁄åﬁ
)

527 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

528 
¢d_˘l_ªm≠_id_t
 *
rid
;

529 
îr
;

531 
	`debug_id
(&
c⁄åﬁ
->
id
, "%s\n", 
__func__
);

532 
îr
 = 
	`ªm≠_m≠_ñem_ªad
(
¥iv
, 
c⁄åﬁ
);

533 i‡(
îr
 !-
EREMAPNOTFOUND
)

534  
îr
;

535 
îr
 = 
	`ªm≠_id_to_chûd
(
¥iv
, &
c⁄åﬁ
->
id
, &
rid
);

536 i‡(
îr
 < 0)

537  
îr
;

538 
îr
 = 
	`¢d_˘l_ñem_ªad
(
¥iv
->
chûd
, 
c⁄åﬁ
);

539  
	`ªm≠_id_to_≠p
(
¥iv
, &
c⁄åﬁ
->
id
, 
rid
, 
îr
);

540 
	}
}

542 
	$ªm≠_m≠_ñem_wrôe
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
¢d_˘l_ñem_vÆue_t
 *
c⁄åﬁ
)

544 
¢d_˘l_m≠_t
 *
m≠
;

545 
¢d_˘l_m≠_˘l
 *
m˘l
;

546 
¢d_˘l_ñem_vÆue_t
 
c⁄åﬁ2
;

547 
size_t
 
ôem
, 
ödex
;

548 
îr
, 
ch™ges
;

550 
m≠
 = 
	`ªm≠_föd_m≠_id
(
¥iv
, &
c⁄åﬁ
->
id
);

551 i‡(
m≠
 =
NULL
)

552  -
EREMAPNOTFOUND
;

553 
	`debug_id
(&
c⁄åﬁ
->
id
, "%s\n", 
__func__
);

554 
c⁄åﬁ
->
id
 = 
m≠
->
m≠_id
;

555 
ôem
 = 0; iãm < 
m≠
->
c⁄åﬁs_ôems
; item++) {

556 
m˘l
 = &
m≠
->
c⁄åﬁs
[
ôem
];

557 
	`¢d_˘l_ñem_vÆue_˛ór
(&
c⁄åﬁ2
);

558 
c⁄åﬁ2
.
id
 = 
m˘l
->
id_chûd
;

559 
	`debug_id
(&
c⁄åﬁ2
.
id
, "%†c⁄åﬁs[%zd]\n", 
__func__
, 
ôem
);

560 
îr
 = 
	`¢d_˘l_ñem_ªad
(
¥iv
->
chûd
, &
c⁄åﬁ2
);

561 i‡(
îr
 < 0)

562  
îr
;

563 
ch™ges
 = 0;

564 i‡(
m≠
->
ty≥
 =
SNDRV_CTL_ELEM_TYPE_BOOLEAN
 ||

565 
m≠
->
ty≥
 =
SNDRV_CTL_ELEM_TYPE_INTEGER
) {

566 
ödex
 = 0; index < 
m˘l
->
ch™√l_m≠_ôems
; index++) {

567 
d°
 = 
m˘l
->
ch™√l_m≠
[
ödex
];

568 i‡(()
d°
 < 
	`ARRAY_SIZE
(
c⁄åﬁ
->
vÆue
.
öãgî
.value)) {

569 
ch™ges
 |
c⁄åﬁ2
.
vÆue
.
öãgî
.vÆue[
d°
] !
c⁄åﬁ
->vÆue.öãgî.vÆue[
ödex
];

570 
c⁄åﬁ2
.
vÆue
.
öãgî
.vÆue[
d°
] = 
c⁄åﬁ
->vÆue.öãgî.vÆue[
ödex
];

573 } i‡(
m≠
->
ty≥
 =
SNDRV_CTL_ELEM_TYPE_INTEGER64
) {

574 
ödex
 = 0; index < 
m˘l
->
ch™√l_m≠_ôems
; index++) {

575 
d°
 = 
m˘l
->
ch™√l_m≠
[
ödex
];

576 i‡(()
d°
 < 
	`ARRAY_SIZE
(
c⁄åﬁ
->
vÆue
.
öãgî64
.value)) {

577 
ch™ges
 |
c⁄åﬁ2
.
vÆue
.
öãgî64
.vÆue[
d°
] !
c⁄åﬁ
->vÆue.öãgî64.vÆue[
ödex
];

578 
c⁄åﬁ2
.
vÆue
.
öãgî64
.vÆue[
d°
] = 
c⁄åﬁ
->vÆue.öãgî64.vÆue[
ödex
];

581 } i‡(
m≠
->
ty≥
 =
SNDRV_CTL_ELEM_TYPE_BYTES
) {

582 
ödex
 = 0; index < 
m˘l
->
ch™√l_m≠_ôems
; index++) {

583 
d°
 = 
m˘l
->
ch™√l_m≠
[
ödex
];

584 i‡(()
d°
 < 
	`ARRAY_SIZE
(
c⁄åﬁ
->
vÆue
.
byãs
.
d©a
)) {

585 
ch™ges
 |
c⁄åﬁ2
.
vÆue
.
byãs
.
d©a
[
d°
] !
c⁄åﬁ
->vÆue.byãs.d©a[
ödex
];

586 
c⁄åﬁ2
.
vÆue
.
byãs
.
d©a
[
d°
] = 
c⁄åﬁ
->vÆue.byãs.d©a[
ödex
];

590 
	`debug_id
(&
c⁄åﬁ2
.
id
, "%†ch™ge†%d\n", 
__func__
, 
ch™ges
);

591 i‡(
ch™ges
 > 0) {

592 
îr
 = 
	`¢d_˘l_ñem_wrôe
(
¥iv
->
chûd
, &
c⁄åﬁ2
);

593 i‡(
îr
 < 0)

594  
îr
;

598 
	}
}

600 
	$¢d_˘l_ªm≠_ñem_wrôe
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_vÆue_t
 *
c⁄åﬁ
)

602 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

603 
¢d_˘l_ªm≠_id_t
 *
rid
;

604 
îr
;

606 
	`debug_id
(&
c⁄åﬁ
->
id
, "%s\n", 
__func__
);

607 
îr
 = 
	`ªm≠_m≠_ñem_wrôe
(
¥iv
, 
c⁄åﬁ
);

608 i‡(
îr
 !-
EREMAPNOTFOUND
)

609  
îr
;

610 
îr
 = 
	`ªm≠_id_to_chûd
(
¥iv
, &
c⁄åﬁ
->
id
, &
rid
);

611 i‡(
îr
 < 0)

612  
îr
;

613 
îr
 = 
	`¢d_˘l_ñem_wrôe
(
¥iv
->
chûd
, 
c⁄åﬁ
);

614  
	`ªm≠_id_to_≠p
(
¥iv
, &
c⁄åﬁ
->
id
, 
rid
, 
îr
);

615 
	}
}

617 
	$¢d_˘l_ªm≠_ñem_lock
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_id_t
 *
id
)

619 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

620 
¢d_˘l_ªm≠_id_t
 *
rid
;

621 
îr
;

623 
	`debug_id
(
id
, "%s\n", 
__func__
);

624 
îr
 = 
	`ªm≠_id_to_chûd
(
¥iv
, 
id
, &
rid
);

625 i‡(
îr
 < 0)

626  
îr
;

627 
îr
 = 
	`¢d_˘l_ñem_lock
(
¥iv
->
chûd
, 
id
);

628  
	`ªm≠_id_to_≠p
(
¥iv
, 
id
, 
rid
, 
îr
);

629 
	}
}

631 
	$¢d_˘l_ªm≠_ñem_u∆ock
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_id_t
 *
id
)

633 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

634 
¢d_˘l_ªm≠_id_t
 *
rid
;

635 
îr
;

637 
	`debug_id
(
id
, "%s\n", 
__func__
);

638 
îr
 = 
	`ªm≠_id_to_chûd
(
¥iv
, 
id
, &
rid
);

639 i‡(
îr
 < 0)

640  
îr
;

641 
îr
 = 
	`¢d_˘l_ñem_u∆ock
(
¥iv
->
chûd
, 
id
);

642  
	`ªm≠_id_to_≠p
(
¥iv
, 
id
, 
rid
, 
îr
);

643 
	}
}

645 
	$ªm≠_gë_m≠_numid
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
¢d_˘l_m≠_˘l
 *
m˘l
)

647 
¢d_˘l_ñem_öfo_t
 
öfo
;

648 
¢d_˘l_numid_t
 *
numid
;

649 
îr
;

651 i‡(
m˘l
->
id_chûd
.
numid
 > 0)

653 
	`debug_id
(&
m˘l
->
id_chûd
, "%†gëÇumid\n", 
__func__
);

654 
	`¢d_˘l_ñem_öfo_˛ór
(&
öfo
);

655 
öfo
.
id
 = 
m˘l
->
id_chûd
;

656 
îr
 = 
	`¢d_˘l_ñem_öfo
(
¥iv
->
chûd
, &
öfo
);

657 i‡(
îr
 < 0)

658  
îr
;

659 
numid
 = 
	`ªm≠_föd_numid_chûd
(
¥iv
, 
öfo
.
id
.numid);

660 i‡(
numid
 =
NULL
)

661  -
EIO
;

662 
m˘l
->
id_chûd
.
numid
 = 
öfo
.
id
.numid;

664 
	}
}

666 
	$ªm≠_m≠_ñem_év
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
›_Êag
, 
numid
,

667 *
év
, 
év_size
)

669 
¢d_˘l_m≠_t
 *
m≠
;

670 
¢d_˘l_m≠_˘l
 *
m˘l
;

671 
size_t
 
ôem
;

672 *
év2
;

673 
îr
;

675 
m≠
 = 
	`ªm≠_föd_m≠_numid
(
¥iv
, 
numid
);

676 i‡(
m≠
 =
NULL
)

677  -
EREMAPNOTFOUND
;

678 i‡(
›_Êag
 != 0)

679  -
ENXIO
;

680 
	`debug
("%†numid %d\n", 
__func__
, 
numid
);

681 
m˘l
 = &
m≠
->
c⁄åﬁs
[0];

682 
îr
 = 
	`ªm≠_gë_m≠_numid
(
¥iv
, 
m˘l
);

683 i‡(
îr
 < 0)

684  
îr
;

685 
	`mem£t
(
év
, 0, 
év_size
);

686 
îr
 = 
¥iv
->
chûd
->
›s
->
	`ñemít_év
’riv->chûd, 
›_Êag
, 
m˘l
->
id_chûd
.
numid
, 
év
, 
év_size
);

687 i‡(
îr
 < 0)

688  
îr
;

689 
év2
 = 
	`mÆloc
(
év_size
);

690 i‡(
év2
 =
NULL
)

691  -
ENOMEM
;

692 
ôem
 = 1; iãm < 
m≠
->
c⁄åﬁs_ôems
; item++) {

693 
m˘l
 = &
m≠
->
c⁄åﬁs
[
ôem
];

694 
îr
 = 
	`ªm≠_gë_m≠_numid
(
¥iv
, 
m˘l
);

695 i‡(
îr
 < 0) {

696 
	`‰ì
(
év2
);

697  
îr
;

699 
	`mem£t
(
év2
, 0, 
év_size
);

700 
îr
 = 
¥iv
->
chûd
->
›s
->
	`ñemít_év
’riv->chûd, 
›_Êag
, 
m˘l
->
id_chûd
.
numid
, 
év2
, 
év_size
);

701 i‡(
îr
 < 0) {

702 
	`‰ì
(
év2
);

703  
îr
;

705 i‡(
	`memcmp
(
év
, 
év2
, 
év_size
) != 0) {

706 
	`‰ì
(
év2
);

707  -
EIO
;

710 
	`‰ì
(
év2
);

712 
	}
}

714 
	$¢d_˘l_ªm≠_ñem_év
(
¢d_˘l_t
 *
˘l
, 
›_Êag
,

715 
numid
,

716 *
év
, 
év_size
)

718 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

719 
¢d_˘l_numid_t
 *
m≠_numid
;

720 
îr
;

722 
	`debug
("%s:Çumid = %d, op_Êag = %d\n", 
__func__
, 
numid
, 
›_Êag
);

723 
îr
 = 
	`ªm≠_m≠_ñem_év
(
¥iv
, 
›_Êag
, 
numid
, 
év
, 
év_size
);

724 i‡(
îr
 !-
EREMAPNOTFOUND
)

725  
îr
;

726 
m≠_numid
 = 
	`ªm≠_föd_numid_≠p
(
¥iv
, 
numid
);

727 i‡(
m≠_numid
 =
NULL
)

728  -
ENOENT
;

729  
¥iv
->
chûd
->
›s
->
	`ñemít_év
’riv->chûd, 
›_Êag
, 
m≠_numid
->
numid_chûd
, 
év
, 
év_size
);

730 
	}
}

732 
	$¢d_˘l_ªm≠_hwdï_√xt_devi˚
(
¢d_˘l_t
 *
˘l
, * 
devi˚
)

734 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

735  
	`¢d_˘l_hwdï_√xt_devi˚
(
¥iv
->
chûd
, 
devi˚
);

736 
	}
}

738 
	$¢d_˘l_ªm≠_hwdï_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_hwdï_öfo_t
 * 
öfo
)

740 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

741  
	`¢d_˘l_hwdï_öfo
(
¥iv
->
chûd
, 
öfo
);

742 
	}
}

744 
	$¢d_˘l_ªm≠_pcm_√xt_devi˚
(
¢d_˘l_t
 *
˘l
, * 
devi˚
)

746 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

747  
	`¢d_˘l_pcm_√xt_devi˚
(
¥iv
->
chûd
, 
devi˚
);

748 
	}
}

750 
	$¢d_˘l_ªm≠_pcm_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_pcm_öfo_t
 * 
öfo
)

752 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

753  
	`¢d_˘l_pcm_öfo
(
¥iv
->
chûd
, 
öfo
);

754 
	}
}

756 
	$¢d_˘l_ªm≠_pcm_¥e„r_subdevi˚
(
¢d_˘l_t
 *
˘l
, 
subdev
)

758 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

759  
	`¢d_˘l_pcm_¥e„r_subdevi˚
(
¥iv
->
chûd
, 
subdev
);

760 
	}
}

762 
	$¢d_˘l_ªm≠_øwmidi_√xt_devi˚
(
¢d_˘l_t
 *
˘l
, * 
devi˚
)

764 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

765  
	`¢d_˘l_øwmidi_√xt_devi˚
(
¥iv
->
chûd
, 
devi˚
);

766 
	}
}

768 
	$¢d_˘l_ªm≠_øwmidi_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_øwmidi_öfo_t
 * 
öfo
)

770 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

771  
	`¢d_˘l_øwmidi_öfo
(
¥iv
->
chûd
, 
öfo
);

772 
	}
}

774 
	$¢d_˘l_ªm≠_øwmidi_¥e„r_subdevi˚
(
¢d_˘l_t
 *
˘l
, 
subdev
)

776 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

777  
	`¢d_˘l_øwmidi_¥e„r_subdevi˚
(
¥iv
->
chûd
, 
subdev
);

778 
	}
}

780 
	$¢d_˘l_ªm≠_£t_powî_°©e
(
¢d_˘l_t
 *
˘l
, 
°©e
)

782 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

783  
	`¢d_˘l_£t_powî_°©e
(
¥iv
->
chûd
, 
°©e
);

784 
	}
}

786 
	$¢d_˘l_ªm≠_gë_powî_°©e
(
¢d_˘l_t
 *
˘l
, *
°©e
)

788 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

789  
	`¢d_˘l_gë_powî_°©e
(
¥iv
->
chûd
, 
°©e
);

790 
	}
}

792 
	$_√xt_±r
(
size_t
 *
±r
, size_à
cou¡
)

794 *
±r
 = (*±∏+ 1Ë% 
cou¡
;

795 
	}
}

797 
	$ªm≠_evít_f‹_Æl_m≠_c⁄åﬁs
(
¢d_˘l_ªm≠_t
 *
¥iv
,

798 
¢d_˘l_ñem_id_t
 *
id
,

799 
evít_mask
)

801 
size_t
 
cou¡
, 
ödex
, 
hód
;

802 
¢d_˘l_m≠_t
 *
m≠
;

803 
¢d_˘l_m≠_˘l
 *
m˘l
;

804 
found
;

806 i‡(
evít_mask
 =
SNDRV_CTL_EVENT_MASK_REMOVE
)

807 
evít_mask
 = 
SNDRV_CTL_EVENT_MASK_INFO
;

808 
m≠
 = 
¥iv
->map;

809 
cou¡
 = 
¥iv
->
m≠_ôems
; cou¡ > 0; cou¡--, 
m≠
++) {

810 
ödex
 = 0; index < 
m≠
->
c⁄åﬁs_ôems
; index++) {

811 
m˘l
 = &
m≠
->
c⁄åﬁs
[
ödex
];

812 i‡(
m˘l
->
id_chûd
.
numid
 == 0) {

813 i‡(
	`¢d_˘l_ñem_id_com∑ª_£t
(
id
, &
m˘l
->
id_chûd
))

815 
m˘l
->
id_chûd
.
numid
 = 
id
->numid;

817 i‡(
id
->
numid
 !
m˘l
->
id_chûd
.numid)

819 
	`debug_id
(&
m≠
->
m≠_id
, "%†found (Æl)\n", 
__func__
);

820 
m≠
->
evít_mask
 |=Évent_mask;

821 
found
 = 0;

822 
hód
 = 
¥iv
->
m≠_ªad_queue_hód
;

823 
hód
 !
¥iv
->
m≠_ªad_queue_èû
;

824 
	`_√xt_±r
(&
hód
, 
¥iv
->
m≠_ôems
))

825 i‡(
¥iv
->
m≠_ªad_queue
[
hód
] =
m≠
) {

826 
found
 = 1;

829 i‡(
found
)

831 
	`debug_id
(&
m≠
->
m≠_id
, "%†m¨kög f‹Ñód\n", 
__func__
);

832 
¥iv
->
m≠_ªad_queue
[¥iv->
m≠_ªad_queue_èû
] = 
m≠
;

833 
	`_√xt_±r
(&
¥iv
->
m≠_ªad_queue_èû
,Öriv->
m≠_ôems
);

836 
	}
}

838 
	$¢d_˘l_ªm≠_ªad
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_evít_t
 *
evít
)

840 
¢d_˘l_ªm≠_t
 *
¥iv
 = 
˘l
->
¥iv©e_d©a
;

841 
¢d_˘l_ªm≠_id_t
 *
rid
;

842 
¢d_˘l_numid_t
 *
numid
;

843 
¢d_˘l_m≠_t
 *
m≠
;

844 
îr
;

846 i‡(
¥iv
->
m≠_ªad_queue_hód
 !¥iv->
m≠_ªad_queue_èû
) {

847 
m≠
 = 
¥iv
->
m≠_ªad_queue
[¥iv->
m≠_ªad_queue_hód
];

848 
	`_√xt_±r
(&
¥iv
->
m≠_ªad_queue_hód
,Öriv->
m≠_ôems
);

849 
	`mem£t
(
evít
, 0, (*event));

850 
evít
->
ty≥
 = 
SNDRV_CTL_EVENT_ELEM
;

851 
evít
->
d©a
.
ñem
.
mask
 = 
m≠
->
evít_mask
;

852 
evít
->
d©a
.
ñem
.
id
 = 
m≠
->
m≠_id
;

853 
m≠
->
evít_mask
 = 0;

854 
	`debug_id
(&
m≠
->
m≠_id
, "%†queuêªad\n", 
__func__
);

857 
îr
 = 
	`¢d_˘l_ªad
(
¥iv
->
chûd
, 
evít
);

858 i‡(
îr
 < 0 || 
evít
->
ty≥
 !
SNDRV_CTL_EVENT_ELEM
)

859  
îr
;

860 i‡(
evít
->
d©a
.
ñem
.
mask
 =
SNDRV_CTL_EVENT_MASK_REMOVE
 ||

861 (
evít
->
d©a
.
ñem
.
mask
 & (
SNDRV_CTL_EVENT_MASK_VALUE
 | 
SNDRV_CTL_EVENT_MASK_INFO
 |

862 
SNDRV_CTL_EVENT_MASK_ADD
 | 
SNDRV_CTL_EVENT_MASK_TLV
)) != 0) {

863 
	`debug_id
(&
evít
->
d©a
.
ñem
.
id
, "%†evíàmask 0x%x\n", 
__func__
,Évít->d©a.ñem.
mask
);

864 
	`ªm≠_evít_f‹_Æl_m≠_c⁄åﬁs
(
¥iv
, &
evít
->
d©a
.
ñem
.
id
,Évít->d©a.ñem.
mask
);

865 
rid
 = 
	`ªm≠_föd_id_chûd
(
¥iv
, &
evít
->
d©a
.
ñem
.
id
);

866 i‡(
rid
) {

867 i‡(
rid
->
id_chûd
.
numid
 == 0) {

868 
numid
 = 
	`ªm≠_föd_numid_chûd
(
¥iv
, 
evít
->
d©a
.
ñem
.
id
.numid);

869 i‡(
numid
 =
NULL
)

870  -
EIO
;

871 
rid
->
id_chûd
.
numid
 =Çumid->
numid_chûd
;

872 
rid
->
id_≠p
.
numid
 =Çumid->
numid_≠p
;

874 
evít
->
d©a
.
ñem
.
id
 = 
rid
->
id_≠p
;

876 
numid
 = 
	`ªm≠_föd_numid_chûd
(
¥iv
, 
evít
->
d©a
.
ñem
.
id
.numid);

877 i‡(
numid
 =
NULL
)

878  -
EIO
;

879 
evít
->
d©a
.
ñem
.
id
.
numid
 =Çumid->
numid_≠p
;

882  
îr
;

883 
	}
}

885 c⁄° 
¢d_˘l_›s_t
 
	g¢d_˘l_ªm≠_›s
 = {

886 .
˛o£
 = 
¢d_˘l_ªm≠_˛o£
,

887 .
	gn⁄block
 = 
¢d_˘l_ªm≠_n⁄block
,

888 .
	gasync
 = 
¢d_˘l_ªm≠_async
,

889 .
	gsubs¸ibe_evíts
 = 
¢d_˘l_ªm≠_subs¸ibe_evíts
,

890 .
	gˇrd_öfo
 = 
¢d_˘l_ªm≠_ˇrd_öfo
,

891 .
	gñemít_li°
 = 
¢d_˘l_ªm≠_ñem_li°
,

892 .
	gñemít_öfo
 = 
¢d_˘l_ªm≠_ñem_öfo
,

893 .
	gñemít_ªad
 = 
¢d_˘l_ªm≠_ñem_ªad
,

894 .
	gñemít_wrôe
 = 
¢d_˘l_ªm≠_ñem_wrôe
,

895 .
	gñemít_lock
 = 
¢d_˘l_ªm≠_ñem_lock
,

896 .
	gñemít_u∆ock
 = 
¢d_˘l_ªm≠_ñem_u∆ock
,

897 .
	gñemít_év
 = 
¢d_˘l_ªm≠_ñem_év
,

898 .
	ghwdï_√xt_devi˚
 = 
¢d_˘l_ªm≠_hwdï_√xt_devi˚
,

899 .
	ghwdï_öfo
 = 
¢d_˘l_ªm≠_hwdï_öfo
,

900 .
	gpcm_√xt_devi˚
 = 
¢d_˘l_ªm≠_pcm_√xt_devi˚
,

901 .
	gpcm_öfo
 = 
¢d_˘l_ªm≠_pcm_öfo
,

902 .
	gpcm_¥e„r_subdevi˚
 = 
¢d_˘l_ªm≠_pcm_¥e„r_subdevi˚
,

903 .
	gøwmidi_√xt_devi˚
 = 
¢d_˘l_ªm≠_øwmidi_√xt_devi˚
,

904 .
	gøwmidi_öfo
 = 
¢d_˘l_ªm≠_øwmidi_öfo
,

905 .
	gøwmidi_¥e„r_subdevi˚
 = 
¢d_˘l_ªm≠_øwmidi_¥e„r_subdevi˚
,

906 .
	g£t_powî_°©e
 = 
¢d_˘l_ªm≠_£t_powî_°©e
,

907 .
	ggë_powî_°©e
 = 
¢d_˘l_ªm≠_gë_powî_°©e
,

908 .
	gªad
 = 
¢d_˘l_ªm≠_ªad
,

911 
	$add_to_ªm≠
(
¢d_˘l_ªm≠_t
 *
¥iv
,

912 
¢d_˘l_ñem_id_t
 *
chûd
,

913 
¢d_˘l_ñem_id_t
 *
≠p
)

915 
¢d_˘l_ªm≠_id_t
 *
rid
;

917 i‡(
¥iv
->
ªm≠_Æloc
 =¥iv->
ªm≠_ôems
) {

918 
rid
 = 
	`ªÆloc
(
¥iv
->
ªm≠
, (¥iv->
ªm≠_Æloc
 + 16) * (*rid));

919 i‡(
rid
 =
NULL
)

920  -
ENOMEM
;

921 
	`mem£t
(
rid
 + 
¥iv
->
ªm≠_Æloc
, 0, (*rid) * 16);

922 
¥iv
->
ªm≠_Æloc
 += 16;

923 
¥iv
->
ªm≠
 = 
rid
;

925 
rid
 = &
¥iv
->
ªm≠
[¥iv->
ªm≠_ôems
++];

926 
rid
->
id_chûd
 = *
chûd
;

927 
rid
->
id_≠p
 = *
≠p
;

928 
	`debug_id
(&
rid
->
id_chûd
, "%†ªm≠ chûd\n", 
__func__
);

929 
	`debug_id
(&
rid
->
id_≠p
, "%†ªm≠áµ\n", 
__func__
);

931 
	}
}

933 
	$∑r£_ªm≠
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
¢d_c⁄fig_t
 *
c⁄f
)

935 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

936 
¢d_˘l_ñem_id_t
 
chûd
, 
≠p
;

937 
îr
;

939 i‡(
c⁄f
 =
NULL
)

941 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

942 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

943 c⁄° *
id
, *
°r
;

944 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

946 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
) < 0) {

947 
	`SNDERR
("expected string withÅheÅarget control id!");

948  -
EINVAL
;

950 
	`¢d_˘l_ñem_id_˛ór
(&
≠p
);

951 
îr
 = 
	`¢d_˘l_ascii_ñem_id_∑r£
(&
≠p
, 
°r
);

952 i‡(
îr
 < 0) {

953 
	`SNDERR
("u«bÀÅÿ∑r£Å¨gë id '%s'!", 
°r
);

954  -
EINVAL
;

956 i‡(
	`ªm≠_föd_id_≠p
(
¥iv
, &
≠p
)) {

957 
	`SNDERR
("du∂iˇãÅ¨gë id '%s'!", 
id
);

958  -
EINVAL
;

960 
	`¢d_˘l_ñem_id_˛ór
(&
chûd
);

961 
îr
 = 
	`¢d_˘l_ascii_ñem_id_∑r£
(&
chûd
, 
id
);

962 i‡(
îr
 < 0) {

963 
	`SNDERR
("u«bÀÅÿ∑r£ sour˚ id '%s'!", 
id
);

964  -
EINVAL
;

966 i‡(
	`ªm≠_föd_id_chûd
(
¥iv
, &
≠p
)) {

967 
	`SNDERR
("du∂iˇã sour˚ id '%s'!", 
id
);

968  -
EINVAL
;

970 
îr
 = 
	`add_to_ªm≠
(
¥iv
, &
chûd
, &
≠p
);

971 i‡(
îr
 < 0)

972  
îr
;

976 
	}
}

978 
	$√w_m≠
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
¢d_˘l_m≠_t
 **
_m≠
, 
¢d_˘l_ñem_id_t
 *
id
)

980 
¢d_˘l_m≠_t
 *
m≠
;

981 
¢d_˘l_numid_t
 *
numid
;

983 i‡(
¥iv
->
m≠_Æloc
 =¥iv->
m≠_ôems
) {

984 
m≠
 = 
	`ªÆloc
(
¥iv
->m≠, (¥iv->
m≠_Æloc
 + 16) * (*map));

985 i‡(
m≠
 =
NULL
)

986  -
ENOMEM
;

987 
	`mem£t
(
m≠
 + 
¥iv
->
m≠_Æloc
, 0, (*map) * 16);

988 
¥iv
->
m≠_Æloc
 += 16;

989 
¥iv
->
m≠
 = map;

991 
m≠
 = &
¥iv
->m≠[¥iv->
m≠_ôems
++];

992 
m≠
->
m≠_id
 = *
id
;

993 
numid
 = 
	`ªm≠_numid_√w
(
¥iv
, 0, ++¥iv->
numid_≠p_œ°
);

994 i‡(
numid
 =
NULL
)

995  -
ENOMEM
;

996 
m≠
->
m≠_id
.
numid
 =Çumid->
numid_≠p
;

997 
	`debug_id
(&
m≠
->
m≠_id
, "%†¸óãd\n", 
__func__
);

998 *
_m≠
 = 
m≠
;

1000 
	}
}

1002 
	$add_˘l_to_m≠
(
¢d_˘l_m≠_t
 *
m≠
, 
¢d_˘l_m≠_˘l
 **
_m˘l
, 
¢d_˘l_ñem_id_t
 *
id
)

1004 
¢d_˘l_m≠_˘l
 *
m˘l
;

1006 i‡(
m≠
->
c⁄åﬁs_Æloc
 =m≠->
c⁄åﬁs_ôems
) {

1007 
m˘l
 = 
	`ªÆloc
(
m≠
->
c⁄åﬁs
, (m≠->
c⁄åﬁs_Æloc
 + 4) * (*mctl));

1008 i‡(
m˘l
 =
NULL
)

1009  -
ENOMEM
;

1010 
	`mem£t
(
m˘l
 + 
m≠
->
c⁄åﬁs_Æloc
, 0, (*mctl) * 4);

1011 
m≠
->
c⁄åﬁs_Æloc
 += 4;

1012 
m≠
->
c⁄åﬁs
 = 
m˘l
;

1014 
m˘l
 = &
m≠
->
c⁄åﬁs
[m≠->
c⁄åﬁs_ôems
++];

1015 
m˘l
->
id_chûd
 = *
id
;

1016 *
_m˘l
 = 
m˘l
;

1018 
	}
}

1020 
	$add_chn_to_m≠
(
¢d_˘l_m≠_˘l
 *
m˘l
, 
idx
, 
vÆ
)

1022 
size_t
 
off
;

1023 *
m≠
;

1025 i‡(
m˘l
->
ch™√l_m≠_Æloc
 <(
size_t
)
idx
) {

1026 
m≠
 = 
	`ªÆloc
(
m˘l
->
ch™√l_m≠
, (
idx
 + 4) * (*map));

1027 i‡(
m≠
 =
NULL
)

1028  -
ENOMEM
;

1029 
m˘l
->
ch™√l_m≠
 = 
m≠
;

1030 
off
 = 
m˘l
->
ch™√l_m≠_Æloc
;

1031 
m˘l
->
ch™√l_m≠_Æloc
 = 
idx
 + 4;

1032  ; 
off
 < 
m˘l
->
ch™√l_m≠_Æloc
; off++)

1033 
m≠
[
off
] = -1;

1035 i‡((
size_t
)
idx
 >
m˘l
->
ch™√l_m≠_ôems
)

1036 
m˘l
->
ch™√l_m≠_ôems
 = 
idx
 + 1;

1037 
m˘l
->
ch™√l_m≠
[
idx
] = 
vÆ
;

1039 
	}
}

1041 
	$∑r£_m≠_vödex
(
¢d_˘l_m≠_˘l
 *
m˘l
, 
¢d_c⁄fig_t
 *
c⁄f
)

1043 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1044 
îr
;

1046 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1047 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1048 
idx
 = -1, 
chn
 = -1;

1049 c⁄° *
id
;

1050 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1052 i‡(
	`ß„_°πﬁ
(
id
, &
idx
Ë|| 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
chn
)) {

1053 
	`SNDERR
("Wr⁄g ch™√»m≠pög (%ld -> %ld)", 
idx
, 
chn
);

1054  -
EINVAL
;

1056 
îr
 = 
	`add_chn_to_m≠
(
m˘l
, 
idx
, 
chn
);

1057 i‡(
îr
 < 0)

1058  
îr
;

1062 
	}
}

1064 
	$∑r£_m≠_c⁄fig
(
¢d_˘l_m≠_˘l
 *
m˘l
, 
¢d_c⁄fig_t
 *
c⁄f
)

1066 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1067 
îr
;

1069 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1070 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1071 c⁄° *
id
;

1072 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1074 i‡(
	`°rcmp
(
id
, "vindex") == 0) {

1075 
îr
 = 
	`∑r£_m≠_vödex
(
m˘l
, 
n
);

1076 i‡(
îr
 < 0)

1077  
îr
;

1081 
	}
}

1083 
	$∑r£_m≠1
(
¢d_˘l_m≠_t
 *
m≠
, 
¢d_c⁄fig_t
 *
c⁄f
)

1085 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1086 
¢d_˘l_ñem_id_t
 
cid
;

1087 
¢d_˘l_m≠_˘l
 *
m˘l
;

1088 
îr
;

1090 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1091 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1092 c⁄° *
id
;

1093 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1095 
	`¢d_˘l_ñem_id_˛ór
(&
cid
);

1096 
îr
 = 
	`¢d_˘l_ascii_ñem_id_∑r£
(&
cid
, 
id
);

1097 i‡(
îr
 < 0) {

1098 
	`SNDERR
("u«bÀÅÿ∑r£ c⁄åﬁ id '%s'!", 
id
);

1099  -
EINVAL
;

1101 
îr
 = 
	`add_˘l_to_m≠
(
m≠
, &
m˘l
, &
cid
);

1102 i‡(
îr
 < 0)

1103  
îr
;

1104 
îr
 = 
	`∑r£_m≠_c⁄fig
(
m˘l
, 
n
);

1105 i‡(
îr
 < 0)

1106  
îr
;

1110 
	}
}

1112 
	$∑r£_m≠
(
¢d_˘l_ªm≠_t
 *
¥iv
, 
¢d_c⁄fig_t
 *
c⁄f
)

1114 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1115 
¢d_˘l_ñem_id_t
 
eid
;

1116 
¢d_˘l_m≠_t
 *
m≠
;

1117 
îr
;

1119 i‡(
c⁄f
 =
NULL
)

1121 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1122 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1123 c⁄° *
id
;

1124 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1126 
	`¢d_˘l_ñem_id_˛ór
(&
eid
);

1127 
îr
 = 
	`¢d_˘l_ascii_ñem_id_∑r£
(&
eid
, 
id
);

1128 i‡(
îr
 < 0) {

1129 
	`SNDERR
("u«bÀÅÿ∑r£ id '%s'!", 
id
);

1130  -
EINVAL
;

1132 
îr
 = 
	`√w_m≠
(
¥iv
, &
m≠
, &
eid
);

1133 i‡(
îr
 < 0)

1135 
îr
 = 
	`∑r£_m≠1
(
m≠
, 
n
);

1136 i‡(
îr
 < 0)

1137  
îr
;

1141 
	}
}

1156 
	$¢d_˘l_ªm≠_›í
(
¢d_˘l_t
 **
h™dÀp
, c⁄° *
«me
, 
¢d_c⁄fig_t
 *
ªm≠
,

1157 
¢d_c⁄fig_t
 *
m≠
, 
¢d_˘l_t
 *
chûd
, 
mode
)

1159 
¢d_˘l_ªm≠_t
 *
¥iv
;

1160 
¢d_˘l_t
 *
˘l
;

1161 
ªsu…
, 
îr
;

1164 i‡(!
ªm≠
 && !
m≠
)

1165 
_no›
;

1167 
¥iv
 = 
	`ˇŒoc
(1, (*priv));

1168 i‡(
¥iv
 =
NULL
)

1169  -
ENOMEM
;

1171 
îr
 = 
	`∑r£_ªm≠
(
¥iv
, 
ªm≠
);

1172 i‡(
îr
 < 0) {

1173 
ªsu…
 = 
îr
;

1174 
_îr
;

1177 
îr
 = 
	`∑r£_m≠
(
¥iv
, 
m≠
);

1178 i‡(
îr
 < 0) {

1179 
ªsu…
 = 
îr
;

1180 
_îr
;

1184 i‡(
¥iv
->
m≠_ôems
 =0 &&Öriv->
ªm≠_ôems
 == 0) {

1185 
	`ªm≠_‰ì
(
¥iv
);

1186 
_no›
:

1187 
	`‰ì
(
chûd
->
«me
);

1188 
chûd
->
«me
 =Çamê? 
	`°rdup
“ameË: 
NULL
;

1189 i‡(
«me
 && !
chûd
->name)

1190  -
ENOMEM
;

1191 *
h™dÀp
 = 
chûd
;

1195 
¥iv
->
m≠_ªad_queue
 = 
	`ˇŒoc
’riv->
m≠_ôems
, (priv->map_read_queue[0]));

1196 i‡(
¥iv
->
m≠_ªad_queue
 =
NULL
) {

1197 
ªsu…
 = -
ENOMEM
;

1198 
_îr
;

1201 
¥iv
->
numid_ªm≠_a˘ive
 =Öriv->
m≠_ôems
 > 0;

1203 
¥iv
->
chûd
 = child;

1204 
îr
 = 
	`¢d_˘l_√w
(&
˘l
, 
SND_CTL_TYPE_REMAP
, 
«me
, 
mode
);

1205 i‡(
îr
 < 0) {

1206 
ªsu…
 = 
îr
;

1207 
_îr
;

1209 
˘l
->
›s
 = &
¢d_˘l_ªm≠_›s
;

1210 
˘l
->
¥iv©e_d©a
 = 
¥iv
;

1211 
˘l
->
pﬁl_fd
 = 
chûd
->poll_fd;

1213 *
h™dÀp
 = 
˘l
;

1216 
_îr
:

1217 
	`ªm≠_‰ì
(
¥iv
);

1218  
ªsu…
;

1219 
	}
}

1292 
	$_¢d_˘l_ªm≠_›í
(
¢d_˘l_t
 **
h™dÀp
, *
«me
, 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
, 
mode
)

1294 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1295 
¢d_c⁄fig_t
 *
chûd
 = 
NULL
;

1296 
¢d_c⁄fig_t
 *
ªm≠
 = 
NULL
;

1297 
¢d_c⁄fig_t
 *
m≠
 = 
NULL
;

1298 
¢d_˘l_t
 *
c˘l
;

1299 
îr
;

1301 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1302 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1303 c⁄° *
id
;

1304 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1306 i‡(
	`_¢d_c⁄f_gíîic_id
(
id
))

1308 i‡(
	`°rcmp
(
id
, "remap") == 0) {

1309 
ªm≠
 = 
n
;

1312 i‡(
	`°rcmp
(
id
, "map") == 0) {

1313 
m≠
 = 
n
;

1316 i‡(
	`°rcmp
(
id
, "child") == 0) {

1317 
chûd
 = 
n
;

1320 
	`SNDERR
("Unknow¿fõld %s", 
id
);

1321  -
EINVAL
;

1323 i‡(!
chûd
) {

1324 
	`SNDERR
("child isÇot defined");

1325  -
EINVAL
;

1327 
îr
 = 
	`_¢d_˘l_›í_chûd
(&
c˘l
, 
roŸ
, 
chûd
, 
mode
, 
c⁄f
);

1328 i‡(
îr
 < 0)

1329  
îr
;

1330 
îr
 = 
	`¢d_˘l_ªm≠_›í
(
h™dÀp
, 
«me
, 
ªm≠
, 
m≠
, 
c˘l
, 
mode
);

1331 i‡(
îr
 < 0)

1332 
	`¢d_˘l_˛o£
(
c˘l
);

1333  
îr
;

1334 
	}
}

1335 #i‚de‡
DOC_HIDDEN


1336 
SND_DLSYM_BUILD_VERSION
(
_¢d_˘l_ªm≠_›í
, 
SND_CONTROL_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_shm.c

22 
	~<°dio.h
>

23 
	~<°dlib.h
>

24 
	~<°ddef.h
>

25 
	~<uni°d.h
>

26 
	~<°rög.h
>

27 
	~<f˙é.h
>

28 
	~<sys/shm.h
>

29 
	~<sys/sockë.h
>

30 
	~<pﬁl.h
>

31 
	~<sys/un.h
>

32 
	~<sys/uio.h
>

33 
	~<sys/mm™.h
>

34 
	~<√töë/ö.h
>

35 
	~<√tdb.h
>

36 
	~"a£rvî.h
"

38 #i‚de‡
PIC


40 c⁄° *
	g_¢d_moduÀ_c⁄åﬁ_shm
 = "";

43 #i‚de‡
DOC_HIDDEN


45 
	msockë
;

46 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
	m˘æ
;

47 } 
	t¢d_˘l_shm_t
;

50 
	$¢d_˘l_shm_a˘i⁄
(
¢d_˘l_t
 *
˘l
)

52 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

53 
îr
;

54 
buf
[1] = {0};

55 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

56 
îr
 = 
	`wrôe
(
shm
->
sockë
, 
buf
, 1);

57 i‡(
îr
 != 1)

58  -
EBADFD
;

59 
îr
 = 
	`ªad
(
shm
->
sockë
, 
buf
, 1);

60 i‡(
îr
 != 1)

61  -
EBADFD
;

62 i‡(
˘æ
->
cmd
) {

63 
	`SNDERR
("Server hasÇot doneÅhe cmd");

64  -
EBADFD
;

66  
˘æ
->
ªsu…
;

67 
	}
}

69 
	$¢d_˘l_shm_a˘i⁄_fd
(
¢d_˘l_t
 *
˘l
, *
fd
)

71 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

72 
îr
;

73 
buf
[1];

74 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

75 
îr
 = 
	`wrôe
(
shm
->
sockë
, 
buf
, 1);

76 i‡(
îr
 != 1)

77  -
EBADFD
;

78 
îr
 = 
	`¢d_ª˚ive_fd
(
shm
->
sockë
, 
buf
, 1, 
fd
);

79 i‡(
îr
 != 1)

80  -
EBADFD
;

81 i‡(
˘æ
->
cmd
) {

82 
	`SNDERR
("Server hasÇot doneÅhe cmd");

83  -
EBADFD
;

85  
˘æ
->
ªsu…
;

86 
	}
}

88 
	$¢d_˘l_shm_˛o£
(
¢d_˘l_t
 *
˘l
)

90 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

91 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

92 
ªsu…
;

93 
˘æ
->
cmd
 = 
SND_CTL_IOCTL_CLOSE
;

94 
ªsu…
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

95 
	`shmdt
((*)
˘æ
);

96 
	`˛o£
(
shm
->
sockë
);

97 
	`‰ì
(
shm
);

98  
ªsu…
;

99 
	}
}

101 
	$¢d_˘l_shm_n⁄block
(
¢d_˘l_t
 *
h™dÀ
 
ATTRIBUTE_UNUSED
, 
n⁄block
 ATTRIBUTE_UNUSED)

104 
	}
}

106 
	$¢d_˘l_shm_async
(
¢d_˘l_t
 *
˘l
, 
sig
, 
pid_t
 
pid
)

108 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

109 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

110 
˘æ
->
cmd
 = 
SND_CTL_IOCTL_ASYNC
;

111 
˘æ
->
u
.
async
.
sig
 = sig;

112 i‡(
pid
 == 0)

113 
pid
 = 
	`gëpid
();

114 
˘æ
->
u
.
async
.
pid
 =Öid;

115  
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

116 
	}
}

118 
	$¢d_˘l_shm_pﬁl_des¸ùt‹
(
¢d_˘l_t
 *
˘l
)

120 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

121 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

122 
fd
, 
îr
;

123 
˘æ
->
cmd
 = 
SND_CTL_IOCTL_POLL_DESCRIPTOR
;

124 
îr
 = 
	`¢d_˘l_shm_a˘i⁄_fd
(
˘l
, &
fd
);

125 i‡(
îr
 < 0)

126  
îr
;

127  
fd
;

128 
	}
}

130 
	$¢d_˘l_shm_subs¸ibe_evíts
(
¢d_˘l_t
 *
˘l
, 
subs¸ibe
)

132 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

133 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

134 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_SUBSCRIBE_EVENTS
;

135 
˘æ
->
u
.
subs¸ibe_evíts
 = 
subs¸ibe
;

136  
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

137 
	}
}

139 
	$¢d_˘l_shm_ˇrd_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ˇrd_öfo_t
 *
öfo
)

141 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

142 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

143 
îr
;

145 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_CARD_INFO
;

146 
îr
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

147 i‡(
îr
 < 0)

148  
îr
;

149 *
öfo
 = 
˘æ
->
u
.
ˇrd_öfo
;

150  
îr
;

151 
	}
}

153 
	$¢d_˘l_shm_ñem_li°
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_li°_t
 *
li°
)

155 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

156 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

157 
size_t
 
maxsize
 = 
CTL_SHM_DATA_MAXLEN
;

158 
size_t
 
byãs
 = 
li°
->
•a˚
 * (*li°->
pids
);

159 
îr
;

160 
¢d_˘l_ñem_id_t
 *
pids
 = 
li°
->pids;

161 i‡(
byãs
 > 
maxsize
)

162  -
EINVAL
;

163 
˘æ
->
u
.
ñemít_li°
 = *
li°
;

164 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_ELEM_LIST
;

165 
îr
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

166 i‡(
îr
 < 0)

167  
îr
;

168 *
li°
 = 
˘æ
->
u
.
ñemít_li°
;

169 
li°
->
pids
 =Öids;

170 
byãs
 = 
li°
->
u£d
 * (*li°->
pids
);

171 
	`mem˝y
(
pids
, (*)
˘æ
->
d©a
, 
byãs
);

172  
îr
;

173 
	}
}

175 
	$¢d_˘l_shm_ñem_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_öfo_t
 *
öfo
)

177 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

178 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

179 
îr
;

180 
˘æ
->
u
.
ñemít_öfo
 = *
öfo
;

181 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_ELEM_INFO
;

182 
îr
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

183 i‡(
îr
 < 0)

184  
îr
;

185 *
öfo
 = 
˘æ
->
u
.
ñemít_öfo
;

186  
îr
;

187 
	}
}

189 
	$¢d_˘l_shm_ñem_ªad
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_vÆue_t
 *
c⁄åﬁ
)

191 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

192 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

193 
îr
;

194 
˘æ
->
u
.
ñemít_ªad
 = *
c⁄åﬁ
;

195 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_ELEM_READ
;

196 
îr
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

197 i‡(
îr
 < 0)

198  
îr
;

199 *
c⁄åﬁ
 = 
˘æ
->
u
.
ñemít_ªad
;

200  
îr
;

201 
	}
}

203 
	$¢d_˘l_shm_ñem_wrôe
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_vÆue_t
 *
c⁄åﬁ
)

205 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

206 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

207 
îr
;

208 
˘æ
->
u
.
ñemít_wrôe
 = *
c⁄åﬁ
;

209 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_ELEM_WRITE
;

210 
îr
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

211 i‡(
îr
 < 0)

212  
îr
;

213 *
c⁄åﬁ
 = 
˘æ
->
u
.
ñemít_wrôe
;

214  
îr
;

215 
	}
}

217 
	$¢d_˘l_shm_ñem_lock
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_id_t
 *
id
)

219 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

220 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

221 
îr
;

222 
˘æ
->
u
.
ñemít_lock
 = *
id
;

223 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_ELEM_LOCK
;

224 
îr
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

225 i‡(
îr
 < 0)

226  
îr
;

227 *
id
 = 
˘æ
->
u
.
ñemít_lock
;

228  
îr
;

229 
	}
}

231 
	$¢d_˘l_shm_ñem_u∆ock
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_ñem_id_t
 *
id
)

233 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

234 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

235 
îr
;

236 
˘æ
->
u
.
ñemít_u∆ock
 = *
id
;

237 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_ELEM_UNLOCK
;

238 
îr
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

239 i‡(
îr
 < 0)

240  
îr
;

241 *
id
 = 
˘æ
->
u
.
ñemít_u∆ock
;

242  
îr
;

243 
	}
}

245 
	$¢d_˘l_shm_hwdï_√xt_devi˚
(
¢d_˘l_t
 *
˘l
, * 
devi˚
)

247 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

248 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

249 
îr
;

250 
˘æ
->
u
.
devi˚
 = *device;

251 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_HWDEP_NEXT_DEVICE
;

252 
îr
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

253 i‡(
îr
 < 0)

254  
îr
;

255 *
devi˚
 = 
˘æ
->
u
.device;

256  
îr
;

257 
	}
}

259 
	$¢d_˘l_shm_hwdï_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_hwdï_öfo_t
 * 
öfo
)

261 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

262 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

263 
îr
;

264 
˘æ
->
u
.
hwdï_öfo
 = *
öfo
;

265 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_HWDEP_INFO
;

266 
îr
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

267 i‡(
îr
 < 0)

268  
îr
;

269 *
öfo
 = 
˘æ
->
u
.
hwdï_öfo
;

270  
îr
;

271 
	}
}

273 
	$¢d_˘l_shm_pcm_√xt_devi˚
(
¢d_˘l_t
 *
˘l
, * 
devi˚
)

275 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

276 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

277 
îr
;

278 
˘æ
->
u
.
devi˚
 = *device;

279 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_PCM_NEXT_DEVICE
;

280 
îr
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

281 i‡(
îr
 < 0)

282  
îr
;

283 *
devi˚
 = 
˘æ
->
u
.device;

284  
îr
;

285 
	}
}

287 
	$¢d_˘l_shm_pcm_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_pcm_öfo_t
 * 
öfo
)

289 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

290 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

291 
îr
;

292 
˘æ
->
u
.
pcm_öfo
 = *
öfo
;

293 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_PCM_INFO
;

294 
îr
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

295 i‡(
îr
 < 0)

296  
îr
;

297 *
öfo
 = 
˘æ
->
u
.
pcm_öfo
;

298  
îr
;

299 
	}
}

301 
	$¢d_˘l_shm_pcm_¥e„r_subdevi˚
(
¢d_˘l_t
 *
˘l
, 
subdev
)

303 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

304 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

305 
˘æ
->
u
.
pcm_¥e„r_subdevi˚
 = 
subdev
;

306 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_PCM_PREFER_SUBDEVICE
;

307  
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

308 
	}
}

310 
	$¢d_˘l_shm_øwmidi_√xt_devi˚
(
¢d_˘l_t
 *
˘l
, * 
devi˚
)

312 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

313 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

314 
îr
;

315 
˘æ
->
u
.
devi˚
 = *device;

316 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_RAWMIDI_NEXT_DEVICE
;

317 
îr
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

318 i‡(
îr
 < 0)

319  
îr
;

320 *
devi˚
 = 
˘æ
->
u
.device;

321  
îr
;

322 
	}
}

324 
	$¢d_˘l_shm_øwmidi_öfo
(
¢d_˘l_t
 *
˘l
, 
¢d_øwmidi_öfo_t
 * 
öfo
)

326 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

327 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

328 
îr
;

329 
˘æ
->
u
.
øwmidi_öfo
 = *
öfo
;

330 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_RAWMIDI_INFO
;

331 
îr
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

332 i‡(
îr
 < 0)

333  
îr
;

334 *
öfo
 = 
˘æ
->
u
.
øwmidi_öfo
;

335  
îr
;

336 
	}
}

338 
	$¢d_˘l_shm_øwmidi_¥e„r_subdevi˚
(
¢d_˘l_t
 *
˘l
, 
subdev
)

340 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

341 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

342 
˘æ
->
u
.
øwmidi_¥e„r_subdevi˚
 = 
subdev
;

343 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_RAWMIDI_PREFER_SUBDEVICE
;

344  
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

345 
	}
}

347 
	$¢d_˘l_shm_£t_powî_°©e
(
¢d_˘l_t
 *
˘l
, 
°©e
)

349 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

350 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

351 
˘æ
->
u
.
powî_°©e
 = 
°©e
;

352 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_POWER
;

353  
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

354 
	}
}

356 
	$¢d_˘l_shm_gë_powî_°©e
(
¢d_˘l_t
 *
˘l
, *
°©e
)

358 
¢d_˘l_shm_t
 *
shm
 = 
˘l
->
¥iv©e_d©a
;

359 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

360 
îr
;

361 
˘æ
->
cmd
 = 
SNDRV_CTL_IOCTL_POWER_STATE
;

362 
îr
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

363 i‡(
îr
 < 0)

364  
îr
;

365 *
°©e
 = 
˘æ
->
u
.
powî_°©e
;

366  
îr
;

367 
	}
}

369 
	$¢d_˘l_shm_ªad
(
¢d_˘l_t
 *
˘l
, 
¢d_˘l_evít_t
 *
evít
)

371 
¢d_˘l_shm_t
 *
shm
;

372 vﬁ©ûê
¢d_˘l_shm_˘æ_t
 *
˘æ
;

373 
îr
;

374 
îr
 = 
	`¢d_˘l_waô
(
˘l
, -1);

375 i‡(
îr
 < 0)

377 
shm
 = 
˘l
->
¥iv©e_d©a
;

378 
˘æ
 = 
shm
->ctrl;

379 
˘æ
->
u
.
ªad
 = *
evít
;

380 
˘æ
->
cmd
 = 
SND_CTL_IOCTL_READ
;

381 
îr
 = 
	`¢d_˘l_shm_a˘i⁄
(
˘l
);

382 i‡(
îr
 < 0)

383  
îr
;

384 *
evít
 = 
˘æ
->
u
.
ªad
;

385  
îr
;

386 
	}
}

388 c⁄° 
¢d_˘l_›s_t
 
	g¢d_˘l_shm_›s
 = {

389 .
˛o£
 = 
¢d_˘l_shm_˛o£
,

390 .
	gn⁄block
 = 
¢d_˘l_shm_n⁄block
,

391 .
	gasync
 = 
¢d_˘l_shm_async
,

392 .
	gsubs¸ibe_evíts
 = 
¢d_˘l_shm_subs¸ibe_evíts
,

393 .
	gˇrd_öfo
 = 
¢d_˘l_shm_ˇrd_öfo
,

394 .
	gñemít_li°
 = 
¢d_˘l_shm_ñem_li°
,

395 .
	gñemít_öfo
 = 
¢d_˘l_shm_ñem_öfo
,

396 .
	gñemít_ªad
 = 
¢d_˘l_shm_ñem_ªad
,

397 .
	gñemít_wrôe
 = 
¢d_˘l_shm_ñem_wrôe
,

398 .
	gñemít_lock
 = 
¢d_˘l_shm_ñem_lock
,

399 .
	gñemít_u∆ock
 = 
¢d_˘l_shm_ñem_u∆ock
,

400 .
	ghwdï_√xt_devi˚
 = 
¢d_˘l_shm_hwdï_√xt_devi˚
,

401 .
	ghwdï_öfo
 = 
¢d_˘l_shm_hwdï_öfo
,

402 .
	gpcm_√xt_devi˚
 = 
¢d_˘l_shm_pcm_√xt_devi˚
,

403 .
	gpcm_öfo
 = 
¢d_˘l_shm_pcm_öfo
,

404 .
	gpcm_¥e„r_subdevi˚
 = 
¢d_˘l_shm_pcm_¥e„r_subdevi˚
,

405 .
	gøwmidi_√xt_devi˚
 = 
¢d_˘l_shm_øwmidi_√xt_devi˚
,

406 .
	gøwmidi_öfo
 = 
¢d_˘l_shm_øwmidi_öfo
,

407 .
	gøwmidi_¥e„r_subdevi˚
 = 
¢d_˘l_shm_øwmidi_¥e„r_subdevi˚
,

408 .
	g£t_powî_°©e
 = 
¢d_˘l_shm_£t_powî_°©e
,

409 .
	ggë_powî_°©e
 = 
¢d_˘l_shm_gë_powî_°©e
,

410 .
	gªad
 = 
¢d_˘l_shm_ªad
,

413 
	$make_loˇl_sockë
(c⁄° *
fûíame
)

415 
size_t
 
l
 = 
	`°æí
(
fûíame
);

416 
size_t
 
size
 = 
	`off£tof
(
sockaddr_un
, 
sun_∑th
Ë+ 
l
;

417 
sockaddr_un
 *
addr
 = 
	`Æloˇ
(
size
);

418 
sock
;

420 
sock
 = 
	`sockë
(
PF_LOCAL
, 
SOCK_STREAM
, 0);

421 i‡(
sock
 < 0)

422  -
î∫o
;

424 
addr
->
sun_Ámûy
 = 
AF_LOCAL
;

425 
	`mem˝y
(
addr
->
sun_∑th
, 
fûíame
, 
l
);

427 i‡(
	`c⁄√˘
(
sock
, (
sockaddr
 *Ë
addr
, 
size
) < 0) {

428 
	`˛o£
(
sock
);

429  -
î∫o
;

431  
sock
;

432 
	}
}

434 
	$¢d_˘l_shm_›í
(
¢d_˘l_t
 **
h™dÀp
, c⁄° *
«me
, c⁄° *
sock«me
, c⁄° *
¢ame
, 
mode
)

436 
¢d_˘l_t
 *
˘l
;

437 
¢d_˘l_shm_t
 *
shm
 = 
NULL
;

438 
¢d_˛õ¡_›í_ªque°_t
 *
ªq
;

439 
¢d_˛õ¡_›í_™swî_t
 
™s
;

440 
size_t
 
¢amñí
, 
ªqÀn
;

441 
îr
;

442 
ªsu…
;

443 
sock
 = -1;

444 
¢d_˘l_shm_˘æ_t
 *
˘æ
 = 
NULL
;

445 
¢amñí
 = 
	`°æí
(
¢ame
);

446 i‡(
¢amñí
 > 255)

447  -
EINVAL
;

449 
ªsu…
 = 
	`make_loˇl_sockë
(
sock«me
);

450 i‡(
ªsu…
 < 0) {

451 
	`SNDERR
("£rvî f‹ sockë %†i†nŸÑu¬ög", 
sock«me
);

452 
_îr
;

454 
sock
 = 
ªsu…
;

456 
ªqÀn
 = (*
ªq
Ë+ 
¢amñí
;

457 
ªq
 = 
	`Æloˇ
(
ªqÀn
);

458 
	`mem˝y
(
ªq
->
«me
, 
¢ame
, 
¢amñí
);

459 
ªq
->
dev_ty≥
 = 
SND_DEV_TYPE_CONTROL
;

460 
ªq
->
å™•‹t_ty≥
 = 
SND_TRANSPORT_TYPE_SHM
;

461 
ªq
->
°ªam
 = 0;

462 
ªq
->
mode
 = mode;

463 
ªq
->
«mñí
 = 
¢amñí
;

464 
îr
 = 
	`wrôe
(
sock
, 
ªq
, 
ªqÀn
);

465 i‡(
îr
 < 0) {

466 
	`SNDERR
("writeÉrror");

467 
ªsu…
 = -
î∫o
;

468 
_îr
;

470 i‡((
size_t
Ë
îr
 !
ªqÀn
) {

471 
	`SNDERR
("write sizeÉrror");

472 
ªsu…
 = -
EINVAL
;

473 
_îr
;

475 
îr
 = 
	`ªad
(
sock
, &
™s
, (ans));

476 i‡(
îr
 < 0) {

477 
	`SNDERR
("readÉrror");

478 
ªsu…
 = -
î∫o
;

479 
_îr
;

481 i‡(
îr
 !(
™s
)) {

482 
	`SNDERR
("read sizeÉrror");

483 
ªsu…
 = -
EINVAL
;

484 
_îr
;

486 
ªsu…
 = 
™s
.result;

487 i‡(
ªsu…
 < 0)

488 
_îr
;

490 
˘æ
 = 
	`shm©
(
™s
.
cookõ
, 0, 0);

491 i‡(!
˘æ
) {

492 
ªsu…
 = -
î∫o
;

493 
_îr
;

496 
shm
 = 
	`ˇŒoc
(1, (
¢d_˘l_shm_t
));

497 i‡(!
shm
) {

498 
ªsu…
 = -
ENOMEM
;

499 
_îr
;

502 
shm
->
sockë
 = 
sock
;

503 
shm
->
˘æ
 = ctrl;

505 
îr
 = 
	`¢d_˘l_√w
(&
˘l
, 
SND_CTL_TYPE_SHM
, 
«me
, 
mode
);

506 i‡(
îr
 < 0) {

507 
ªsu…
 = 
îr
;

508 
_îr
;

510 
˘l
->
›s
 = &
¢d_˘l_shm_›s
;

511 
˘l
->
¥iv©e_d©a
 = 
shm
;

512 
îr
 = 
	`¢d_˘l_shm_pﬁl_des¸ùt‹
(
˘l
);

513 i‡(
îr
 < 0) {

514 
	`¢d_˘l_˛o£
(
˘l
);

515  
îr
;

517 
˘l
->
pﬁl_fd
 = 
îr
;

518 *
h™dÀp
 = 
˘l
;

521 
_îr
:

522 
	`˛o£
(
sock
);

523 i‡(
˘æ
)

524 
	`shmdt
(
˘æ
);

525 
	`‰ì
(
shm
);

526  
ªsu…
;

527 
	}
}

529 
	$_¢d_˘l_shm_›í
(
¢d_˘l_t
 **
h™dÀp
, *
«me
, 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
, 
mode
)

531 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

532 c⁄° *
£rvî
 = 
NULL
;

533 c⁄° *
˘l_«me
 = 
NULL
;

534 
¢d_c⁄fig_t
 *
sc⁄fig
;

535 c⁄° *
sock«me
 = 
NULL
;

536 
p‹t
 = -1;

537 
îr
;

539 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

540 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

541 c⁄° *
id
;

542 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

544 i‡(
	`_¢d_c⁄f_gíîic_id
(
id
))

546 i‡(
	`°rcmp
(
id
, "server") == 0) {

547 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
£rvî
);

548 i‡(
îr
 < 0) {

549 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

550  -
EINVAL
;

554 i‡(
	`°rcmp
(
id
, "ctl") == 0) {

555 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
˘l_«me
);

556 i‡(
îr
 < 0) {

557 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

558  -
EINVAL
;

562 
	`SNDERR
("Unknow¿fõld %s", 
id
);

563  -
EINVAL
;

565 i‡(!
˘l_«me
) {

566 
	`SNDERR
("ctl isÇot defined");

567  -
EINVAL
;

569 i‡(!
£rvî
) {

570 
	`SNDERR
("server isÇot defined");

571  -
EINVAL
;

573 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "£rvî", 
£rvî
, &
sc⁄fig
);

574 i‡(
îr
 < 0) {

575 
	`SNDERR
("Unknow¿£rvî %s", 
£rvî
);

576  -
EINVAL
;

578 i‡(
	`¢d_c⁄fig_gë_ty≥
(
sc⁄fig
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

579 
	`SNDERR
("InvÆidÅy≥ f‹ sîvî %†deföôi⁄", 
£rvî
);

580 
îr
 = -
EINVAL
;

581 
_îr
;

583 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
sc⁄fig
) {

584 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

585 c⁄° *
id
;

586 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

588 i‡(
	`_¢d_c⁄f_gíîic_id
(
id
))

590 i‡(
	`°rcmp
(
id
, "host") == 0)

592 i‡(
	`°rcmp
(
id
, "socket") == 0) {

593 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
sock«me
);

594 i‡(
îr
 < 0) {

595 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

596 
_îr
;

600 i‡(
	`°rcmp
(
id
, "port") == 0) {

601 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
p‹t
);

602 i‡(
îr
 < 0) {

603 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

604 
_îr
;

608 
	`SNDERR
("Unknow¿fõld %s", 
id
);

609 
îr
 = -
EINVAL
;

610 
_îr
;

613 i‡(!
sock«me
) {

614 
	`SNDERR
("socket isÇot defined");

615 
_îr
;

617 
îr
 = 
	`¢d_˘l_shm_›í
(
h™dÀp
, 
«me
, 
sock«me
, 
˘l_«me
, 
mode
);

618 
_îr
:

619 
	`¢d_c⁄fig_dñëe
(
sc⁄fig
);

620  
îr
;

621 
	}
}

622 
SND_DLSYM_BUILD_VERSION
(
_¢d_˘l_shm_›í
, 
SND_CONTROL_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_symbols.c

21 #i‚de‡
PIC


23 c⁄° *
_¢d_moduÀ_c⁄åﬁ_hw
;

24 c⁄° *
_¢d_moduÀ_c⁄åﬁ_em±y
;

25 c⁄° *
_¢d_moduÀ_c⁄åﬁ_ªm≠
;

26 c⁄° *
_¢d_moduÀ_c⁄åﬁ_shm
;

27 c⁄° *
_¢d_moduÀ_c⁄åﬁ_ext
;

29 c⁄° **
	g¢d_c⁄åﬁ_›í_obje˘s
[] = {

30 &
_¢d_moduÀ_c⁄åﬁ_hw
,

31 &
_¢d_moduÀ_c⁄åﬁ_em±y
,

32 
	~"˘l_symbﬁs_li°.c
"

35 *
	$¢d_c⁄åﬁ_›í_symbﬁs
()

37  
¢d_c⁄åﬁ_›í_obje˘s
;

38 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/ctlparse.c

28 
	~"c⁄åﬁ_loˇl.h
"

29 
	~<uni°d.h
>

30 
	~<°rög.h
>

31 
	~<˘y≥.h
>

32 
	~<m©h.h
>

36 
ölöe
 
	$c⁄vît_¥™ge1
(
≥rc
, 
mö
, 
max
)

38 
tmp
;

40 #ifde‡
HAVE_SOFT_FLOAT


41 
tmp
 = 
≥rc
 * (
max
 - 
mö
);

42 
tmp
 =Åmp / 100 + ((tmp % 100) < 50 ? 0 : 1);

44 
tmp
 = 
	`röt
(()
≥rc
 * ()(
max
 - 
mö
) * 0.01);

46 i‡(
tmp
 =0 && 
≥rc
 > 0)

47 
tmp
++;

48  
tmp
 + 
mö
;

49 
	}
}

51 
	#check_ønge
(
vÆ
, 
mö
, 
max
) \

52 ((
vÆ
 < 
mö
Ë? (möË: ((vÆ > 
max
Ë? (maxË: (vÆ)))

	)

54 
	$gë_öãgî
(c⁄° **
±r
, 
mö
, 
max
)

56 
vÆ
 = 
mö
;

57 *
p
 = (*)*
±r
, *
s
;

59 i‡(*
p
 == ':')

60 
p
++;

61 i‡(*
p
 ='\0' || (!
	`isdigô
(*p) && *p != '-'))

62 
out
;

64 
s
 = 
p
;

65 
vÆ
 = 
	`°πﬁ
(
s
, &
p
, 0);

66 i‡(*
p
 == '.') {

67 
p
++;

68 ()
	`°πﬁ
(
p
, &p, 10);

70 i‡(*
p
 == '%') {

71 
vÆ
 = ()
	`c⁄vît_¥™ge1
(
	`°πod
(
s
, 
NULL
), 
mö
, 
max
);

72 
p
++;

74 
vÆ
 = 
	`check_ønge
(vÆ, 
mö
, 
max
);

75 i‡(*
p
 == ',')

76 
p
++;

77 
out
:

78 *
±r
 = 
p
;

79  
vÆ
;

80 
	}
}

82 
	$gë_öãgî64
(c⁄° **
±r
, 
mö
, 
max
)

84 
vÆ
 = 
mö
;

85 *
p
 = (*)*
±r
, *
s
;

87 i‡(*
p
 == ':')

88 
p
++;

89 i‡(*
p
 ='\0' || (!
	`isdigô
(*p) && *p != '-'))

90 
out
;

92 
s
 = 
p
;

93 
vÆ
 = 
	`°πﬁ
(
s
, &
p
, 0);

94 i‡(*
p
 == '.') {

95 
p
++;

96 ()
	`°πﬁ
(
p
, &p, 10);

98 i‡(*
p
 == '%') {

99 
vÆ
 = ()
	`c⁄vît_¥™ge1
(
	`°πod
(
s
, 
NULL
), 
mö
, 
max
);

100 
p
++;

102 
vÆ
 = 
	`check_ønge
(vÆ, 
mö
, 
max
);

103 i‡(*
p
 == ',')

104 
p
++;

105 
out
:

106 *
±r
 = 
p
;

107  
vÆ
;

108 
	}
}

117 *
	$¢d_˘l_ascii_ñem_id_gë
(
¢d_˘l_ñem_id_t
 *
id
)

119 
numid
, 
ödex
, 
devi˚
, 
subdevi˚
;

120 
buf
[256], 
buf1
[32];

121 c⁄° *
iÁ˚
;

123 
numid
 = 
	`¢d_˘l_ñem_id_gë_numid
(
id
);

124 
iÁ˚
 = 
	`¢d_˘l_ñem_iÁ˚_«me
(
	`¢d_˘l_ñem_id_gë_öãrÁ˚
(
id
));

125 i‡(
numid
 > 0) {

126 
	`¢¥ötf
(
buf
, (buf), "numid=%u,iface=%s,name='%s'",

127 
numid
, 
iÁ˚
, 
	`¢d_˘l_ñem_id_gë_«me
(
id
));

129 
	`¢¥ötf
(
buf
, (buf), "iface=%s,name='%s'",

130 
iÁ˚
, 
	`¢d_˘l_ñem_id_gë_«me
(
id
));

132 
buf
[(buf)-1] = '\0';

133 
ödex
 = 
	`¢d_˘l_ñem_id_gë_ödex
(
id
);

134 
devi˚
 = 
	`¢d_˘l_ñem_id_gë_devi˚
(
id
);

135 
subdevi˚
 = 
	`¢d_˘l_ñem_id_gë_subdevi˚
(
id
);

136 i‡(
ödex
) {

137 
	`¢¥ötf
(
buf1
, (buf1), ",ödex=%u", 
ödex
);

138 i‡(
	`°æí
(
buf
Ë+ såÀn(
buf1
) < (buf))

139 
	`°rˇt
(
buf
, 
buf1
);

141 i‡(
devi˚
) {

142 
	`¢¥ötf
(
buf1
, (buf1), ",devi˚=%u", 
devi˚
);

143 i‡(
	`°æí
(
buf
Ë+ såÀn(
buf1
) < (buf))

144 
	`°rˇt
(
buf
, 
buf1
);

146 i‡(
subdevi˚
) {

147 
	`¢¥ötf
(
buf1
, (buf1), ",subdevi˚=%u", 
subdevi˚
);

148 i‡(
	`°æí
(
buf
Ë+ såÀn(
buf1
) < (buf))

149 
	`°rˇt
(
buf
, 
buf1
);

151  
	`°rdup
(
buf
);

152 
	}
}

154 #i‚de‡
DOC_HIDDEN


156 
	$__¢d_˘l_ascii_ñem_id_∑r£
(
¢d_˘l_ñem_id_t
 *
d°
, c⁄° *
°r
,

157 c⁄° **
ªt_±r
)

159 
c
, 
size
, 
numid
;

160 
îr
 = -
EINVAL
;

161 *
±r
;

163 
	`is•a˚
(*
°r
))

164 
°r
++;

165 i‡(!(*
°r
))

166 
out
;

167 
	`¢d_˘l_ñem_id_£t_öãrÁ˚
(
d°
, 
SND_CTL_ELEM_IFACE_MIXER
);

168 *
°r
) {

169 i‡(!
	`°∫ˇ£cmp
(
°r
, "numid=", 6)) {

170 
°r
 += 6;

171 
numid
 = 
	`©oi
(
°r
);

172 i‡(
numid
 <= 0) {

173 
	`Ârötf
(
°dîr
, "amixî: InvÆidÇumid %d\n", 
numid
);

174 
out
;

176 
	`¢d_˘l_ñem_id_£t_numid
(
d°
, 
	`©oi
(
°r
));

177 
	`isdigô
(*
°r
))

178 
°r
++;

179 } i‡(!
	`°∫ˇ£cmp
(
°r
, "iface=", 6)) {

180 
°r
 += 6;

181 i‡(!
	`°∫ˇ£cmp
(
°r
, "card", 4)) {

182 
	`¢d_˘l_ñem_id_£t_öãrÁ˚
(
d°
, 
SND_CTL_ELEM_IFACE_CARD
);

183 
°r
 += 4;

184 } i‡(!
	`°∫ˇ£cmp
(
°r
, "mixer", 5)) {

185 
	`¢d_˘l_ñem_id_£t_öãrÁ˚
(
d°
, 
SND_CTL_ELEM_IFACE_MIXER
);

186 
°r
 += 5;

187 } i‡(!
	`°∫ˇ£cmp
(
°r
, "pcm", 3)) {

188 
	`¢d_˘l_ñem_id_£t_öãrÁ˚
(
d°
, 
SND_CTL_ELEM_IFACE_PCM
);

189 
°r
 += 3;

190 } i‡(!
	`°∫ˇ£cmp
(
°r
, "rawmidi", 7)) {

191 
	`¢d_˘l_ñem_id_£t_öãrÁ˚
(
d°
, 
SND_CTL_ELEM_IFACE_RAWMIDI
);

192 
°r
 += 7;

193 } i‡(!
	`°∫ˇ£cmp
(
°r
, "timer", 5)) {

194 
	`¢d_˘l_ñem_id_£t_öãrÁ˚
(
d°
, 
SND_CTL_ELEM_IFACE_TIMER
);

195 
°r
 += 5;

196 } i‡(!
	`°∫ˇ£cmp
(
°r
, "sequencer", 9)) {

197 
	`¢d_˘l_ñem_id_£t_öãrÁ˚
(
d°
, 
SND_CTL_ELEM_IFACE_SEQUENCER
);

198 
°r
 += 9;

200 
out
;

202 } i‡(!
	`°∫ˇ£cmp
(
°r
, "name=", 5)) {

203 
buf
[64];

204 
°r
 += 5;

205 
±r
 = 
buf
;

206 
size
 = 0;

207 i‡(*
°r
 == '\'' || *str == '\"') {

208 
c
 = *
°r
++;

209 *
°r
 && *°∏!
c
) {

210 i‡(
size
 < ()(
buf
)) {

211 *
±r
++ = *
°r
;

212 
size
++;

214 
°r
++;

216 i‡(*
°r
 =
c
)

217 
°r
++;

219 *
°r
 && *str != ',') {

220 i‡(
size
 < ()(
buf
)) {

221 *
±r
++ = *
°r
;

222 
size
++;

224 
°r
++;

227 *
±r
 = '\0';

228 
	`¢d_˘l_ñem_id_£t_«me
(
d°
, 
buf
);

229 } i‡(!
	`°∫ˇ£cmp
(
°r
, "index=", 6)) {

230 
°r
 += 6;

231 
	`¢d_˘l_ñem_id_£t_ödex
(
d°
, 
	`©oi
(
°r
));

232 
	`isdigô
(*
°r
))

233 
°r
++;

234 } i‡(!
	`°∫ˇ£cmp
(
°r
, "device=", 7)) {

235 
°r
 += 7;

236 
	`¢d_˘l_ñem_id_£t_devi˚
(
d°
, 
	`©oi
(
°r
));

237 
	`isdigô
(*
°r
))

238 
°r
++;

239 } i‡(!
	`°∫ˇ£cmp
(
°r
, "subdevice=", 10)) {

240 
°r
 += 10;

241 
	`¢d_˘l_ñem_id_£t_subdevi˚
(
d°
, 
	`©oi
(
°r
));

242 
	`isdigô
(*
°r
))

243 
°r
++;

245 i‡(*
°r
 == ',') {

246 
°r
++;

251 i‡(
ªt_±r
 && 
	`is•a˚
(*
°r
))

253 i‡(*
°r
)

254 
out
;

257 
îr
 = 0;

259 
out
:

260 i‡(
ªt_±r
)

261 *
ªt_±r
 = 
°r
;

262  
îr
;

263 
	}
}

272 
	$¢d_˘l_ascii_ñem_id_∑r£
(
¢d_˘l_ñem_id_t
 *
d°
, c⁄° *
°r
)

274  
	`__¢d_˘l_ascii_ñem_id_∑r£
(
d°
, 
°r
, 
NULL
);

275 
	}
}

277 
	$gë_˘l_íum_ôem_ödex
(
¢d_˘l_t
 *
h™dÀ
,

278 
¢d_˘l_ñem_öfo_t
 *
öfo
,

279 c⁄° **
±Ω
)

281 *
±r
 = (*)*
±Ω
;

282 
ôems
, 
i
, 
Àn
;

283 c⁄° *
«me
;

284 
íd
;

286 
ôems
 = 
	`¢d_˘l_ñem_öfo_gë_ôems
(
öfo
);

287 i‡(
ôems
 <= 0)

290 
íd
 = *
±r
;

291 i‡(
íd
 == '\'' ||Énd == '"')

292 
±r
++;

294 
íd
 = '\0';

296 
i
 = 0; i < 
ôems
; i++) {

297 
	`¢d_˘l_ñem_öfo_£t_ôem
(
öfo
, 
i
);

298 i‡(
	`¢d_˘l_ñem_öfo
(
h™dÀ
, 
öfo
) < 0)

300 
«me
 = 
	`¢d_˘l_ñem_öfo_gë_ôem_«me
(
öfo
);

301 
Àn
 = 
	`°æí
(
«me
);

302 i‡(
	`°∫cmp
(
«me
, 
±r
, 
Àn
))

304 i‡(
íd
 ='\0' && (
±r
[
Àn
] == '\0' ||Ötr[len] == ',' ||Ötr[len] == '\n')) {

305 *
±Ω
 = 
±r
 + 
Àn
;

306  
i
;

308 i‡(
íd
 !'\0' && 
±r
[
Àn
] ==Énd) {

309 *
±Ω
 = 
±r
 + 
Àn
 + 1;

310  
i
;

314 
	}
}

316 
	$gë_˘l_ty≥_max_ñemíts
(
¢d_˘l_ñem_ty≥_t
 
ty≥
)

318 
¢d_˘l_ñem_vÆue
 
vÆue
;

320 
ty≥
) {

321 
SND_CTL_ELEM_TYPE_BOOLEAN
:

322 
SND_CTL_ELEM_TYPE_INTEGER
:

323  
	`ARRAY_SIZE
(
vÆue
.vÆue.
öãgî
.value);

324 
SND_CTL_ELEM_TYPE_INTEGER64
:

325  
	`ARRAY_SIZE
(
vÆue
.vÆue.
öãgî64
.value);

326 
SND_CTL_ELEM_TYPE_ENUMERATED
:

327  
	`ARRAY_SIZE
(
vÆue
.vÆue.
íumî©ed
.
ôem
);

328 
SND_CTL_ELEM_TYPE_BYTES
:

329  
	`ARRAY_SIZE
(
vÆue
.vÆue.
byãs
.
d©a
);

333 
	}
}

346 
	$¢d_˘l_ascii_vÆue_∑r£
(
¢d_˘l_t
 *
h™dÀ
,

347 
¢d_˘l_ñem_vÆue_t
 *
d°
,

348 
¢d_˘l_ñem_öfo_t
 *
öfo
,

349 c⁄° *
vÆue
)

351 c⁄° *
±r
 = 
vÆue
;

352 
¢d_˘l_ñem_id_t
 
myid
 = {0};

353 
¢d_˘l_ñem_ty≥_t
 
ty≥
;

354 
idx
, 
cou¡
;

355 
tmp
;

356 
tmp64
;

358 
	`¢d_˘l_ñem_öfo_gë_id
(
öfo
, &
myid
);

359 
ty≥
 = 
	`¢d_˘l_ñem_öfo_gë_ty≥
(
öfo
);

360 
cou¡
 = 
	`¢d_˘l_ñem_öfo_gë_cou¡
(
öfo
);

361 
	`¢d_˘l_ñem_vÆue_£t_id
(
d°
, &
myid
);

363 i‡(
cou¡
 > 
	`gë_˘l_ty≥_max_ñemíts
(
ty≥
))

364 
cou¡
 = 
	`gë_˘l_ty≥_max_ñemíts
(
ty≥
);

366 
idx
 = 0; idx < 
cou¡
 && 
±r
 && *ptr; idx++) {

367 i‡(*
±r
 == ',')

368 
skù
;

369 
ty≥
) {

370 
SND_CTL_ELEM_TYPE_BOOLEAN
:

371 
tmp
 = 0;

372 i‡(!
	`°∫ˇ£cmp
(
±r
, "on", 2) ||

373 !
	`°∫ˇ£cmp
(
±r
, "up", 2)) {

374 
tmp
 = 1;

375 
±r
 += 2;

376 } i‡(!
	`°∫ˇ£cmp
(
±r
, "yes", 3)) {

377 
tmp
 = 1;

378 
±r
 += 3;

379 } i‡(!
	`°∫ˇ£cmp
(
±r
, "toggle", 6)) {

380 
tmp
 = 
	`¢d_˘l_ñem_vÆue_gë_boﬁón
(
d°
, 
idx
);

381 
tmp
 =Åmp > 0 ? 0 : 1;

382 
±r
 += 6;

383 } i‡(
	`isdigô
(*
±r
)) {

384 
tmp
 = 
	`©oi
(
±r
) > 0 ? 1 : 0;

385 
	`isdigô
(*
±r
))

386 
±r
++;

388 *
±r
 && *ptr != ',')

389 
±r
++;

391 
	`¢d_˘l_ñem_vÆue_£t_boﬁón
(
d°
, 
idx
, 
tmp
);

393 
SND_CTL_ELEM_TYPE_INTEGER
:

394 
tmp
 = 
	`gë_öãgî
(&
±r
,

395 
	`¢d_˘l_ñem_öfo_gë_mö
(
öfo
),

396 
	`¢d_˘l_ñem_öfo_gë_max
(
öfo
));

397 
	`¢d_˘l_ñem_vÆue_£t_öãgî
(
d°
, 
idx
, 
tmp
);

399 
SND_CTL_ELEM_TYPE_INTEGER64
:

400 
tmp64
 = 
	`gë_öãgî64
(&
±r
,

401 
	`¢d_˘l_ñem_öfo_gë_mö64
(
öfo
),

402 
	`¢d_˘l_ñem_öfo_gë_max64
(
öfo
));

403 
	`¢d_˘l_ñem_vÆue_£t_öãgî64
(
d°
, 
idx
, 
tmp64
);

405 
SND_CTL_ELEM_TYPE_ENUMERATED
:

406 
tmp
 = 
	`gë_˘l_íum_ôem_ödex
(
h™dÀ
, 
öfo
, &
±r
);

407 i‡(
tmp
 < 0)

408 
tmp
 = 
	`gë_öãgî
(&
±r
, 0,

409 
	`¢d_˘l_ñem_öfo_gë_ôems
(
öfo
) - 1);

410 
	`¢d_˘l_ñem_vÆue_£t_íumî©ed
(
d°
, 
idx
, 
tmp
);

412 
SND_CTL_ELEM_TYPE_BYTES
:

413 
tmp
 = 
	`gë_öãgî
(&
±r
, 0, 255);

414 
	`¢d_˘l_ñem_vÆue_£t_byã
(
d°
, 
idx
, 
tmp
);

419 
skù
:

420 i‡(!
	`°rchr
(
vÆue
, ','))

421 
±r
 = 
vÆue
;

422 i‡(*
±r
 == ',')

423 
±r
++;

426 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/eld.c

29 
	~"c⁄åﬁ_loˇl.h
"

30 
	~<°dio.h
>

31 
	~<°dlib.h
>

32 
	~<uni°d.h
>

33 
	~<°rög.h
>

34 
	~<˘y≥.h
>

36 
	$__fûl_ñd_˘l_id
(
¢d_˘l_ñem_id_t
 *
id
, 
dev
, 
subdev
)

38 
	`¢d_˘l_ñem_id_£t_öãrÁ˚
(
id
, 
SND_CTL_ELEM_IFACE_PCM
);

39 
	`¢d_˘l_ñem_id_£t_«me
(
id
, "ELD");

40 
	`¢d_˘l_ñem_id_£t_devi˚
(
id
, 
dev
);

41 
	`¢d_˘l_ñem_id_£t_ödex
(
id
, 
subdev
);

42 
	}
}

44 
	$__¢d_pcm_öfo_ñd_fixup
(
¢d_pcm_öfo_t
 * 
öfo
)

46 
¢d_˘l_t
 *
˘l
;

47 
¢d_˘l_ñem_öfo_t
 
cöfo
 = {0};

48 
¢d_˘l_ñem_vÆue_t
 
vÆue
 = {0};

49 *
ñd
;

50 
l
, 
•c
;

51 *
s
, 
c
;

52 
ªt
, 
vÆid
;

54 
ªt
 = 
	`¢d_˘l_hw_›í
(&
˘l
, 
NULL
, 
öfo
->
ˇrd
, 0);

55 i‡(
ªt
 < 0) {

56 
	`SYSMSG
("Cannot openÅheássociated CTL");

57  
ªt
;

60 
	`__fûl_ñd_˘l_id
(&
cöfo
.
id
, 
öfo
->
devi˚
, info->
subdevi˚
);

61 
vÆue
.
id
 = 
cöfo
.id;

62 
ªt
 = 
	`¢d_˘l_ñem_öfo
(
˘l
, &
cöfo
);

63 i‡(
ªt
 >0 && 
cöfo
.
ty≥
 =
SND_CTL_ELEM_TYPE_BYTES
)

64 
ªt
 = 
	`¢d_˘l_ñem_ªad
(
˘l
, &
vÆue
);

65 
	`¢d_˘l_˛o£
(
˘l
);

66 i‡(
ªt
 =-
ENOENT
 || 
cöfo
.
ty≥
 !
SND_CTL_ELEM_TYPE_BYTES
 || cöfo.
cou¡
 == 0)

68 i‡(
ªt
 < 0) {

69 
	`SYSMSG
("CannotÑead ELD");

70  
ªt
;

73 
ñd
 = 
vÆue
.vÆue.
byãs
.
d©a
;

74 i‡(
cöfo
.
cou¡
 < 20 || cinfo.count > 256)

75  -
EIO
;

76 
l
 = 
ñd
[4] & 0x1f;

77 i‡(
l
 == 0)

79 
__¥e£¡
;

80 i‡(
l
 > 16 || 20 +Ü > 
cöfo
.
cou¡
) {

81 
	`SNDERR
("ELD decode failed, using old HDMI outputÇames");

84 
s
 = 
	`Æloˇ
(
l
 + 1);

86 
vÆid
 = 0;

87 
•c
 = 0;

88 
l
 > 0) {

89 
l
--;

90 
c
 = 
ñd
[20 + 
l
];

91 i‡(
c
 <= ' ' || c >= 0x7f) {

92 
s
[
l
] = ' ';

94 
vÆid
 +!!
	`iß um
(
c
);

95 
s
[
l
] = 
c
;

96 i‡(
•c
 == 0)

97 
•c
 = 
l
 + 1;

100 i‡(
vÆid
 > 3) {

101 
s
[
•c
] = '\0';

102 
	`¢d_°æ˝y
((*)
öfo
->
«me
, 
s
, (info->name));

104 
__¥e£¡
:

105 
	`°∫ˇt
((*)
öfo
->
«me
, " *", (info->name) - 1);

106 ((*)
öfo
->
«me
)[(info->name)-1] = '\0';

109 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/hcontrol.c

45 
	~"c⁄åﬁ_loˇl.h
"

46 
	~<°dio.h
>

47 
	~<°dlib.h
>

48 
	~<uni°d.h
>

49 
	~<°rög.h
>

50 
	~<f˙é.h
>

51 
	~<sys/io˘l.h
>

52 #ifde‡
HAVE_LIBPTHREAD


53 
	~<±hªad.h
>

56 #i‚de‡
DOC_HIDDEN


57 
	#NOT_FOUND
 1000000000

	)

60 
¢d_h˘l_com∑ª_deÁu…
(c⁄° 
¢d_h˘l_ñem_t
 *
c1
,

61 c⁄° 
¢d_h˘l_ñem_t
 *
c2
);

70 
	$¢d_h˘l_›í
(
¢d_h˘l_t
 **
h˘Õ
, c⁄° *
«me
, 
mode
)

72 
¢d_˘l_t
 *
˘l
;

73 
îr
;

75 i‡((
îr
 = 
	`¢d_˘l_›í
(&
˘l
, 
«me
, 
mode
)) < 0)

76  
îr
;

77 
îr
 = 
	`¢d_h˘l_›í_˘l
(
h˘Õ
, 
˘l
);

78 i‡(
îr
 < 0)

79 
	`¢d_˘l_˛o£
(
˘l
);

80  
îr
;

81 
	}
}

89 
	$¢d_h˘l_›í_˘l
(
¢d_h˘l_t
 **
h˘Õ
, 
¢d_˘l_t
 *
˘l
)

91 
¢d_h˘l_t
 *
h˘l
;

93 
	`as£π
(
h˘Õ
);

94 *
h˘Õ
 = 
NULL
;

95 i‡((
h˘l
 = (
¢d_h˘l_t
 *)
	`ˇŒoc
(1, (¢d_h˘l_t))Ë=
NULL
)

96  -
ENOMEM
;

97 
	`INIT_LIST_HEAD
(&
h˘l
->
ñems
);

98 
h˘l
->
˘l
 = ctl;

99 *
h˘Õ
 = 
h˘l
;

101 
	}
}

111 
	$¢d_h˘l_˛o£
(
¢d_h˘l_t
 *
h˘l
)

113 
îr
;

115 
	`as£π
(
h˘l
);

116 
îr
 = 
	`¢d_˘l_˛o£
(
h˘l
->
˘l
);

117 
	`¢d_h˘l_‰ì
(
h˘l
);

118 
	`‰ì
(
h˘l
);

119  
îr
;

120 
	}
}

130 c⁄° *
	$¢d_h˘l_«me
(
¢d_h˘l_t
 *
h˘l
)

132 
	`as£π
(
h˘l
);

133  
	`¢d_˘l_«me
(
h˘l
->
˘l
);

134 
	}
}

142 
	$¢d_h˘l_n⁄block
(
¢d_h˘l_t
 *
h˘l
, 
n⁄block
)

144 
	`as£π
(
h˘l
);

145  
	`¢d_˘l_n⁄block
(
h˘l
->
˘l
, 
n⁄block
);

146 
	}
}

157 
	$¢d_h˘l_async
(
¢d_h˘l_t
 *
h˘l
, 
sig
, 
pid_t
 
pid
)

159 
	`as£π
(
h˘l
);

160  
	`¢d_˘l_async
(
h˘l
->
˘l
, 
sig
, 
pid
);

161 
	}
}

168 
	$¢d_h˘l_pﬁl_des¸ùt‹s_cou¡
(
¢d_h˘l_t
 *
h˘l
)

170 
	`as£π
(
h˘l
);

171  
	`¢d_˘l_pﬁl_des¸ùt‹s_cou¡
(
h˘l
->
˘l
);

172 
	}
}

181 
	$¢d_h˘l_pﬁl_des¸ùt‹s
(
¢d_h˘l_t
 *
h˘l
, 
pﬁlfd
 *
pfds
, 
•a˚
)

183 
	`as£π
(
h˘l
);

184  
	`¢d_˘l_pﬁl_des¸ùt‹s
(
h˘l
->
˘l
, 
pfds
, 
•a˚
);

185 
	}
}

195 
	$¢d_h˘l_pﬁl_des¸ùt‹s_ªvíts
(
¢d_h˘l_t
 *
h˘l
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

197 
	`as£π
(
h˘l
);

198  
	`¢d_˘l_pﬁl_des¸ùt‹s_ªvíts
(
h˘l
->
˘l
, 
pfds
, 
nfds
, 
ªvíts
);

199 
	}
}

201 
	$¢d_h˘l_throw_evít
(
¢d_h˘l_t
 *
h˘l
, 
mask
,

202 
¢d_h˘l_ñem_t
 *
ñem
)

204 i‡(
h˘l
->
ˇŒback
)

205  
h˘l
->
	`ˇŒback
(h˘l, 
mask
, 
ñem
);

207 
	}
}

209 
	$¢d_h˘l_ñem_throw_evít
(
¢d_h˘l_ñem_t
 *
ñem
,

210 
mask
)

212 i‡(
ñem
->
ˇŒback
)

213  
ñem
->
	`ˇŒback
”Àm, 
mask
);

215 
	}
}

217 
	$¢d_h˘l_com∑ª_mixî_¥i‹ôy_lookup
(c⁄° **
«me
, c⁄° * c⁄° *
«mes
, 
c€f
)

219 
ªs
;

221 
ªs
 = 0; *
«mes
;Çames++,Ñe†+
c€f
) {

222 i‡(!
	`°∫cmp
(*
«me
, *
«mes
, 
	`°æí
(*names))) {

223 *
«me
 +
	`°æí
(*
«mes
);

224 i‡(**
«me
 == ' ')

225 (*
«me
)++;

226  
ªs
+1;

229  
NOT_FOUND
;

230 
	}
}

232 
	$gë_com∑ª_weight
(c⁄° 
¢d_˘l_ñem_id_t
 *
id
)

234 c⁄° *c⁄° 
«mes
[] = {

268 
NULL


270 c⁄° *c⁄° 
«mes1
[] = {

282 
NULL


284 c⁄° *c⁄° 
«mes2
[] = {

293 
NULL


295 c⁄° *
«me
 = (*)
id
->«me, *
«me1
;

296 
ªs
, 
ªs1
;

298 i‡((
ªs
 = 
	`¢d_h˘l_com∑ª_mixî_¥i‹ôy_lookup
((c⁄° **)&
«me
, 
«mes
, 1000000)Ë=
NOT_FOUND
)

299  
NOT_FOUND
;

300 i‡(*
«me
 == '\0')

301  
ªs
;

302 
«me1
 = 
«me
; *name1 != '\0';Çame1++);

303 
«me1
--;Çame1 !
«me
 && *name1 != ' ';Çame1--);

304 
«me1
 !
«me
 && *name1 == ' ')

305 
«me1
--;

306 i‡(
«me1
 !
«me
) {

307 ; 
«me1
 !
«me
 && *name1 != ' ';Çame1--);

308 
«me
 = 
«me1
;

309 i‡((
ªs1
 = 
	`¢d_h˘l_com∑ª_mixî_¥i‹ôy_lookup
((c⁄° **)&
«me
, 
«mes1
, 1000)Ë=
NOT_FOUND
)

310  
ªs
;

311 
ªs
 +
ªs1
;

313 
«me
 = 
«me1
;

315 i‡((
ªs1
 = 
	`¢d_h˘l_com∑ª_mixî_¥i‹ôy_lookup
((c⁄° **)&
«me
, 
«mes2
, 1)Ë=
NOT_FOUND
)

316  
ªs
;

317  
ªs
 + 
ªs1
;

318 
	}
}

320 
	$_¢d_h˘l_föd_ñem
(
¢d_h˘l_t
 *
h˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
, *
dú
)

322 
l
, 
u
;

323 
¢d_h˘l_ñem_t
 
ñ
;

324 
c
 = 0;

325 
idx
 = -1;

326 
	`as£π
(
h˘l
 && 
id
);

327 
	`as£π
(
h˘l
->
com∑ª
);

328 
ñ
.
id
 = *id;

329 
ñ
.
com∑ª_weight
 = 
	`gë_com∑ª_weight
(
id
);

330 
l
 = 0;

331 
u
 = 
h˘l
->
cou¡
;

332 
l
 < 
u
) {

333 
idx
 = (
l
 + 
u
) / 2;

334 
c
 = 
h˘l
->
	`com∑ª
(&
ñ
, h˘l->
≥Àms
[
idx
]);

335 i‡(
c
 < 0)

336 
u
 = 
idx
;

337 i‡(
c
 > 0)

338 
l
 = 
idx
 + 1;

342 *
dú
 = 
c
;

343  
idx
;

344 
	}
}

346 
	$¢d_h˘l_ñem_add
(
¢d_h˘l_t
 *
h˘l
, 
¢d_h˘l_ñem_t
 *
ñem
)

348 
dú
;

349 
idx
;

350 
ñem
->
com∑ª_weight
 = 
	`gë_com∑ª_weight
(&ñem->
id
);

351 i‡(
h˘l
->
cou¡
 =h˘l->
Æloc
) {

352 
¢d_h˘l_ñem_t
 **
h
;

353 
h˘l
->
Æloc
 += 32;

354 
h
 = 
	`ªÆloc
(
h˘l
->
≥Àms
, (*hË* h˘l->
Æloc
);

355 i‡(!
h
) {

356 
h˘l
->
Æloc
 -= 32;

357  -
ENOMEM
;

359 
h˘l
->
≥Àms
 = 
h
;

361 i‡(
h˘l
->
cou¡
 == 0) {

362 
	`li°_add_èû
(&
ñem
->
li°
, &
h˘l
->
ñems
);

363 
h˘l
->
≥Àms
[0] = 
ñem
;

365 
idx
 = 
	`_¢d_h˘l_föd_ñem
(
h˘l
, &
ñem
->
id
, &
dú
);

366 
	`as£π
(
dú
 != 0);

367 i‡(
dú
 > 0) {

368 
	`li°_add
(&
ñem
->
li°
, &
h˘l
->
≥Àms
[
idx
]->list);

369 
idx
++;

371 
	`li°_add_èû
(&
ñem
->
li°
, &
h˘l
->
≥Àms
[
idx
]->list);

373 
	`memmove
(
h˘l
->
≥Àms
 + 
idx
 + 1,

374 
h˘l
->
≥Àms
 + 
idx
,

375 (
h˘l
->
cou¡
 - 
idx
Ë* (
¢d_h˘l_ñem_t
 *));

376 
h˘l
->
≥Àms
[
idx
] = 
ñem
;

378 
h˘l
->
cou¡
++;

379  
	`¢d_h˘l_throw_evít
(
h˘l
, 
SNDRV_CTL_EVENT_MASK_ADD
, 
ñem
);

380 
	}
}

382 
	$¢d_h˘l_ñem_ªmove
(
¢d_h˘l_t
 *
h˘l
, 
idx
)

384 
¢d_h˘l_ñem_t
 *
ñem
 = 
h˘l
->
≥Àms
[
idx
];

385 
m
;

386 
	`¢d_h˘l_ñem_throw_evít
(
ñem
, 
SNDRV_CTL_EVENT_MASK_REMOVE
);

387 
	`li°_dñ
(&
ñem
->
li°
);

388 
	`‰ì
(
ñem
);

389 
h˘l
->
cou¡
--;

390 
m
 = 
h˘l
->
cou¡
 - 
idx
;

391 i‡(
m
 > 0)

392 
	`memmove
(
h˘l
->
≥Àms
 + 
idx
,

393 
h˘l
->
≥Àms
 + 
idx
 + 1,

394 
m
 * (
¢d_h˘l_ñem_t
 *));

395 
	}
}

402 
	$¢d_h˘l_‰ì
(
¢d_h˘l_t
 *
h˘l
)

404 
h˘l
->
cou¡
 > 0)

405 
	`¢d_h˘l_ñem_ªmove
(
h˘l
, h˘l->
cou¡
 - 1);

406 
	`‰ì
(
h˘l
->
≥Àms
);

407 
h˘l
->
≥Àms
 = 0;

408 
h˘l
->
Æloc
 = 0;

409 
	`INIT_LIST_HEAD
(&
h˘l
->
ñems
);

411 
	}
}

413 
¢d_h˘l_t
 *
	gcom∑ª_h˘l
;

414 
	$h˘l_com∑ª
(c⁄° *
a
, c⁄° *
b
) {

415  
com∑ª_h˘l
->
	`com∑ª
(*(c⁄° 
¢d_h˘l_ñem_t
 * c⁄° *Ë
a
,

416 *(c⁄° 
¢d_h˘l_ñem_t
 * c⁄° *Ë
b
);

417 
	}
}

419 
	$¢d_h˘l_s‹t
(
¢d_h˘l_t
 *
h˘l
)

421 
k
;

422 #ifde‡
HAVE_LIBPTHREAD


423 
±hªad_muãx_t
 
sync_lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

426 
	`as£π
(
h˘l
);

427 
	`as£π
(
h˘l
->
com∑ª
);

428 
	`INIT_LIST_HEAD
(&
h˘l
->
ñems
);

430 #ifde‡
HAVE_LIBPTHREAD


431 
	`±hªad_muãx_lock
(&
sync_lock
);

433 
com∑ª_h˘l
 = 
h˘l
;

434 
	`qs‹t
(
h˘l
->
≥Àms
, h˘l->
cou¡
, (*h˘l->≥Àms), 
h˘l_com∑ª
);

435 #ifde‡
HAVE_LIBPTHREAD


436 
	`±hªad_muãx_u∆ock
(&
sync_lock
);

438 
k
 = 0; k < 
h˘l
->
cou¡
; k++)

439 
	`li°_add_èû
(&
h˘l
->
≥Àms
[
k
]->
li°
, &h˘l->
ñems
);

440 
	}
}

448 
	$¢d_h˘l_£t_com∑ª
(
¢d_h˘l_t
 *
h˘l
, 
¢d_h˘l_com∑ª_t
 
com∑ª
)

450 
	`as£π
(
h˘l
);

451 
h˘l
->
com∑ª
 = com∑ª =
NULL
 ? 
¢d_h˘l_com∑ª_deÁu…
 : compare;

452 
	`¢d_h˘l_s‹t
(
h˘l
);

454 
	}
}

462 
	$¢d_h˘l_com∑ª_Á°
(c⁄° 
¢d_h˘l_ñem_t
 *
c1
,

463 c⁄° 
¢d_h˘l_ñem_t
 *
c2
)

465  
c1
->
id
.
numid
 - 
c2
->id.numid;

466 
	}
}

468 
	$¢d_h˘l_com∑ª_deÁu…
(c⁄° 
¢d_h˘l_ñem_t
 *
c1
,

469 c⁄° 
¢d_h˘l_ñem_t
 *
c2
)

471 
ªs
, 
d
;

473 
d
 = 
c1
->
id
.
iÁ˚
 - 
c2
->id.iface;

474 i‡(
d
 != 0)

475  
d
;

476 i‡(
c1
->
id
.
iÁ˚
 =
SNDRV_CTL_ELEM_IFACE_MIXER
) {

477 
d
 = 
c1
->
com∑ª_weight
 - 
c2
->compare_weight;

478 i‡(
d
 != 0)

479  
d
;

481 
d
 = 
c1
->
id
.
devi˚
 - 
c2
->id.device;

482 i‡(
d
 != 0)

483  
d
;

484 
d
 = 
c1
->
id
.
subdevi˚
 - 
c2
->id.subdevice;

485 i‡(
d
 != 0)

486  
d
;

487 
ªs
 = 
	`°rcmp
((c⁄° *)
c1
->
id
.
«me
, (c⁄° *)
c2
->id.name);

488 i‡(
ªs
 != 0)

489  
ªs
;

490  
c1
->
id
.
ödex
 - 
c2
->id.index;

491 
	}
}

498 
¢d_h˘l_ñem_t
 *
	$¢d_h˘l_fú°_ñem
(
¢d_h˘l_t
 *
h˘l
)

500 
	`as£π
(
h˘l
);

501 i‡(
	`li°_em±y
(&
h˘l
->
ñems
))

502  
NULL
;

503  
	`li°_íåy
(
h˘l
->
ñems
.
√xt
, 
¢d_h˘l_ñem_t
, 
li°
);

504 
	}
}

511 
¢d_h˘l_ñem_t
 *
	$¢d_h˘l_œ°_ñem
(
¢d_h˘l_t
 *
h˘l
)

513 
	`as£π
(
h˘l
);

514 i‡(
	`li°_em±y
(&
h˘l
->
ñems
))

515  
NULL
;

516  
	`li°_íåy
(
h˘l
->
ñems
.
¥ev
, 
¢d_h˘l_ñem_t
, 
li°
);

517 
	}
}

524 
¢d_h˘l_ñem_t
 *
	$¢d_h˘l_ñem_√xt
(
¢d_h˘l_ñem_t
 *
ñem
)

526 
	`as£π
(
ñem
);

527 i‡(
ñem
->
li°
.
√xt
 =&ñem->
h˘l
->
ñems
)

528  
NULL
;

529  
	`li°_íåy
(
ñem
->
li°
.
√xt
, 
¢d_h˘l_ñem_t
,Üist);

530 
	}
}

537 
¢d_h˘l_ñem_t
 *
	$¢d_h˘l_ñem_¥ev
(
¢d_h˘l_ñem_t
 *
ñem
)

539 
	`as£π
(
ñem
);

540 i‡(
ñem
->
li°
.
¥ev
 =&ñem->
h˘l
->
ñems
)

541  
NULL
;

542  
	`li°_íåy
(
ñem
->
li°
.
¥ev
, 
¢d_h˘l_ñem_t
,Üist);

543 
	}
}

551 
¢d_h˘l_ñem_t
 *
	$¢d_h˘l_föd_ñem
(
¢d_h˘l_t
 *
h˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
)

553 
dú
;

554 
ªs
 = 
	`_¢d_h˘l_föd_ñem
(
h˘l
, 
id
, &
dú
);

555 i‡(
ªs
 < 0 || 
dú
 != 0)

556  
NULL
;

557  
h˘l
->
≥Àms
[
ªs
];

558 
	}
}

565 
	$¢d_h˘l_lﬂd
(
¢d_h˘l_t
 *
h˘l
)

567 
¢d_˘l_ñem_li°_t
 
li°
;

568 
îr
 = 0;

569 
idx
;

571 
	`as£π
(
h˘l
);

572 
	`as£π
(
h˘l
->
˘l
);

573 
	`as£π
(
h˘l
->
cou¡
 == 0);

574 
	`as£π
(
	`li°_em±y
(&
h˘l
->
ñems
));

575 
	`mem£t
(&
li°
, 0, (list));

576 i‡((
îr
 = 
	`¢d_˘l_ñem_li°
(
h˘l
->
˘l
, &
li°
)) < 0)

577 
_íd
;

578 
li°
.
cou¡
 !li°.
u£d
) {

579 
îr
 = 
	`¢d_˘l_ñem_li°_Æloc_•a˚
(&
li°
,Üi°.
cou¡
);

580 i‡(
îr
 < 0)

581 
_íd
;

582 i‡((
îr
 = 
	`¢d_˘l_ñem_li°
(
h˘l
->
˘l
, &
li°
)) < 0)

583 
_íd
;

585 i‡(
h˘l
->
Æloc
 < 
li°
.
cou¡
) {

586 
h˘l
->
Æloc
 = 
li°
.
cou¡
;

587 
	`‰ì
(
h˘l
->
≥Àms
);

588 
h˘l
->
≥Àms
 = 
	`mÆloc
(h˘l->
Æloc
 * (*hctl->pelems));

589 i‡(!
h˘l
->
≥Àms
) {

590 
îr
 = -
ENOMEM
;

591 
_íd
;

594 
idx
 = 0; idx < 
li°
.
cou¡
; idx++) {

595 
¢d_h˘l_ñem_t
 *
ñem
;

596 
ñem
 = 
	`ˇŒoc
(1, (
¢d_h˘l_ñem_t
));

597 i‡(
ñem
 =
NULL
) {

598 
	`¢d_h˘l_‰ì
(
h˘l
);

599 
îr
 = -
ENOMEM
;

600 
_íd
;

602 
ñem
->
id
 = 
li°
.
pids
[
idx
];

603 
ñem
->
h˘l
 = hctl;

604 
ñem
->
com∑ª_weight
 = 
	`gë_com∑ª_weight
(&ñem->
id
);

605 
h˘l
->
≥Àms
[
idx
] = 
ñem
;

606 
	`li°_add_èû
(&
ñem
->
li°
, &
h˘l
->
ñems
);

607 
h˘l
->
cou¡
++;

609 i‡(!
h˘l
->
com∑ª
)

610 
h˘l
->
com∑ª
 = 
¢d_h˘l_com∑ª_deÁu…
;

611 
	`¢d_h˘l_s‹t
(
h˘l
);

612 
idx
 = 0; idx < 
h˘l
->
cou¡
; idx++) {

613 
ªs
 = 
	`¢d_h˘l_throw_evít
(
h˘l
, 
SNDRV_CTL_EVENT_MASK_ADD
,

614 
h˘l
->
≥Àms
[
idx
]);

615 i‡(
ªs
 < 0)

616  
ªs
;

618 
îr
 = 
	`¢d_˘l_subs¸ibe_evíts
(
h˘l
->
˘l
, 1);

619 
_íd
:

620 
	`‰ì
(
li°
.
pids
);

621  
îr
;

622 
	}
}

629 
	$¢d_h˘l_£t_ˇŒback
(
¢d_h˘l_t
 *
h˘l
, 
¢d_h˘l_ˇŒback_t
 
ˇŒback
)

631 
	`as£π
(
h˘l
);

632 
h˘l
->
ˇŒback
 = callback;

633 
	}
}

640 
	$¢d_h˘l_£t_ˇŒback_¥iv©e
(
¢d_h˘l_t
 *
h˘l
, *
ˇŒback_¥iv©e
)

642 
	`as£π
(
h˘l
);

643 
h˘l
->
ˇŒback_¥iv©e
 = callback_private;

644 
	}
}

651 *
	$¢d_h˘l_gë_ˇŒback_¥iv©e
(
¢d_h˘l_t
 *
h˘l
)

653 
	`as£π
(
h˘l
);

654  
h˘l
->
ˇŒback_¥iv©e
;

655 
	}
}

662 
	$¢d_h˘l_gë_cou¡
(
¢d_h˘l_t
 *
h˘l
)

664  
h˘l
->
cou¡
;

665 
	}
}

675 
	$¢d_h˘l_waô
(
¢d_h˘l_t
 *
h˘l
, 
timeout
)

677 
pﬁlfd
 *
pfd
;

678 *
ªvíts
;

679 
i
, 
≈fds
, 
pﬁlio
, 
îr
, 
îr_pﬁl
;

681 
≈fds
 = 
	`¢d_h˘l_pﬁl_des¸ùt‹s_cou¡
(
h˘l
);

682 i‡(
≈fds
 <= 0 ||Çpfds >= 16) {

683 
	`SNDERR
("InvÆidÖﬁl_fd†%d", 
≈fds
);

684  -
EIO
;

686 
pfd
 = 
	`Æloˇ
((*pfdË* 
≈fds
);

687 
ªvíts
 = 
	`Æloˇ
((*ªvítsË* 
≈fds
);

688 
îr
 = 
	`¢d_h˘l_pﬁl_des¸ùt‹s
(
h˘l
, 
pfd
, 
≈fds
);

689 i‡(
îr
 < 0)

690  
îr
;

691 i‡(
îr
 !
≈fds
) {

692 
	`SNDMSG
("övÆidÖﬁ»des¸ùt‹†%d", 
îr
);

693  -
EIO
;

696 
pﬁlio
 = 0;

697 
îr_pﬁl
 = 
	`pﬁl
(
pfd
, 
≈fds
, 
timeout
);

698 i‡(
îr_pﬁl
 < 0) {

699 i‡(
î∫o
 =
EINTR
 && !
	`CTLINABORT
(
h˘l
->
˘l
Ë&& !(h˘l->˘l->
mode
 & 
SND_CTL_EINTR
))

701  -
î∫o
;

703 i‡(! 
îr_pﬁl
)

705 
îr
 = 
	`¢d_h˘l_pﬁl_des¸ùt‹s_ªvíts
(
h˘l
, 
pfd
, 
≈fds
, 
ªvíts
);

706 i‡(
îr
 < 0)

707  
îr
;

708 
i
 = 0; i < 
≈fds
; i++) {

709 i‡(
ªvíts
[
i
] & (
POLLERR
 | 
POLLNVAL
))

710  -
EIO
;

711 i‡((
ªvíts
[
i
] & (
POLLIN
 | 
POLLOUT
)) == 0)

713 
pﬁlio
++;

715 } ! 
pﬁlio
);

716  
îr_pﬁl
 > 0 ? 1 : 0;

717 
	}
}

724 
¢d_˘l_t
 *
	$¢d_h˘l_˘l
(
¢d_h˘l_t
 *
h˘l
)

726  
h˘l
->
˘l
;

727 
	}
}

729 
	$¢d_h˘l_h™dÀ_evít
(
¢d_h˘l_t
 *
h˘l
, 
¢d_˘l_evít_t
 *
evít
)

731 
¢d_h˘l_ñem_t
 *
ñem
;

732 
ªs
;

734 
	`as£π
(
h˘l
);

735 
	`as£π
(
h˘l
->
˘l
);

736 
evít
->
ty≥
) {

737 
SND_CTL_EVENT_ELEM
:

742 i‡(
evít
->
d©a
.
ñem
.
mask
 =
SNDRV_CTL_EVENT_MASK_REMOVE
) {

743 
dú
;

744 
ªs
 = 
	`_¢d_h˘l_föd_ñem
(
h˘l
, &
evít
->
d©a
.
ñem
.
id
, &
dú
);

745 i‡(
ªs
 < 0 || 
dú
 != 0)

746  -
ENOENT
;

747 
	`¢d_h˘l_ñem_ªmove
(
h˘l
, (Ë
ªs
);

750 i‡(
evít
->
d©a
.
ñem
.
mask
 & 
SNDRV_CTL_EVENT_MASK_ADD
) {

751 
ñem
 = 
	`ˇŒoc
(1, (
¢d_h˘l_ñem_t
));

752 i‡(
ñem
 =
NULL
)

753  -
ENOMEM
;

754 
ñem
->
id
 = 
evít
->
d©a
.elem.id;

755 
ñem
->
h˘l
 = hctl;

756 
ªs
 = 
	`¢d_h˘l_ñem_add
(
h˘l
, 
ñem
);

757 i‡(
ªs
 < 0)

758  
ªs
;

760 i‡(
evít
->
d©a
.
ñem
.
mask
 & (
SNDRV_CTL_EVENT_MASK_VALUE
 |

761 
SNDRV_CTL_EVENT_MASK_INFO
)) {

762 
ñem
 = 
	`¢d_h˘l_föd_ñem
(
h˘l
, &
evít
->
d©a
.ñem.
id
);

763 i‡(!
ñem
)

764  -
ENOENT
;

765 
ªs
 = 
	`¢d_h˘l_ñem_throw_evít
(
ñem
, 
evít
->
d©a
.ñem.
mask
 &

766 (
SNDRV_CTL_EVENT_MASK_VALUE
 |

767 
SNDRV_CTL_EVENT_MASK_INFO
));

768 i‡(
ªs
 < 0)

769  
ªs
;

772 
	}
}

779 
	$¢d_h˘l_h™dÀ_evíts
(
¢d_h˘l_t
 *
h˘l
)

781 
¢d_˘l_evít_t
 
evít
;

782 
ªs
;

783 
cou¡
 = 0;

785 
	`as£π
(
h˘l
);

786 
	`as£π
(
h˘l
->
˘l
);

787 (
ªs
 = 
	`¢d_˘l_ªad
(
h˘l
->
˘l
, &
evít
)) != 0 &&

788 
ªs
 !-
EAGAIN
) {

789 i‡(
ªs
 < 0)

790  
ªs
;

791 
ªs
 = 
	`¢d_h˘l_h™dÀ_evít
(
h˘l
, &
evít
);

792 i‡(
ªs
 < 0)

793  
ªs
;

794 
cou¡
++;

796  
cou¡
;

797 
	}
}

805 
	$¢d_h˘l_ñem_öfo
(
¢d_h˘l_ñem_t
 *
ñem
, 
¢d_˘l_ñem_öfo_t
 *
öfo
)

807 
	`as£π
(
ñem
);

808 
	`as£π
(
ñem
->
h˘l
);

809 
	`as£π
(
öfo
);

810 
öfo
->
id
 = 
ñem
->id;

811  
	`¢d_˘l_ñem_öfo
(
ñem
->
h˘l
->
˘l
, 
öfo
);

812 
	}
}

820 
	$¢d_h˘l_ñem_ªad
(
¢d_h˘l_ñem_t
 *
ñem
, 
¢d_˘l_ñem_vÆue_t
 * 
vÆue
)

822 
	`as£π
(
ñem
);

823 
	`as£π
(
ñem
->
h˘l
);

824 
	`as£π
(
vÆue
);

825 
vÆue
->
id
 = 
ñem
->id;

826  
	`¢d_˘l_ñem_ªad
(
ñem
->
h˘l
->
˘l
, 
vÆue
);

827 
	}
}

837 
	$¢d_h˘l_ñem_wrôe
(
¢d_h˘l_ñem_t
 *
ñem
, 
¢d_˘l_ñem_vÆue_t
 * 
vÆue
)

839 
	`as£π
(
ñem
);

840 
	`as£π
(
ñem
->
h˘l
);

841 
	`as£π
(
vÆue
);

842 
vÆue
->
id
 = 
ñem
->id;

843  
	`¢d_˘l_ñem_wrôe
(
ñem
->
h˘l
->
˘l
, 
vÆue
);

844 
	}
}

853 
	$¢d_h˘l_ñem_év_ªad
(
¢d_h˘l_ñem_t
 *
ñem
, *
év
, 
év_size
)

855 
	`as£π
(
ñem
);

856 
	`as£π
(
év
);

857 
	`as£π
(
év_size
 >= 12);

858  
	`¢d_˘l_ñem_év_ªad
(
ñem
->
h˘l
->
˘l
, &ñem->
id
, 
év
, 
év_size
);

859 
	}
}

869 
	$¢d_h˘l_ñem_év_wrôe
(
¢d_h˘l_ñem_t
 *
ñem
, c⁄° *
év
)

871 
	`as£π
(
ñem
);

872 
	`as£π
(
év
);

873 
	`as£π
(
év
[
SNDRV_CTL_TLVO_LEN
] >= 4);

874  
	`¢d_˘l_ñem_év_wrôe
(
ñem
->
h˘l
->
˘l
, &ñem->
id
, 
év
);

875 
	}
}

885 
	$¢d_h˘l_ñem_év_comm™d
(
¢d_h˘l_ñem_t
 *
ñem
, c⁄° *
év
)

887 
	`as£π
(
ñem
);

888 
	`as£π
(
év
);

889 
	`as£π
(
év
[
SNDRV_CTL_TLVO_LEN
] >= 4);

890  
	`¢d_˘l_ñem_év_comm™d
(
ñem
->
h˘l
->
˘l
, &ñem->
id
, 
év
);

891 
	}
}

898 
¢d_h˘l_t
 *
	$¢d_h˘l_ñem_gë_h˘l
(
¢d_h˘l_ñem_t
 *
ñem
)

900 
	`as£π
(
ñem
);

901  
ñem
->
h˘l
;

902 
	}
}

909 
	$¢d_h˘l_ñem_gë_id
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
, 
¢d_˘l_ñem_id_t
 *
±r
)

911 
	`as£π
(
obj
 && 
±r
);

912 *
±r
 = 
obj
->
id
;

913 
	}
}

920 
	$¢d_h˘l_ñem_gë_numid
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
)

922 
	`as£π
(
obj
);

923  
obj
->
id
.
numid
;

924 
	}
}

931 
¢d_˘l_ñem_iÁ˚_t
 
	$¢d_h˘l_ñem_gë_öãrÁ˚
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
)

933 
	`as£π
(
obj
);

934  
obj
->
id
.
iÁ˚
;

935 
	}
}

942 
	$¢d_h˘l_ñem_gë_devi˚
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
)

944 
	`as£π
(
obj
);

945  
obj
->
id
.
devi˚
;

946 
	}
}

953 
	$¢d_h˘l_ñem_gë_subdevi˚
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
)

955 
	`as£π
(
obj
);

956  
obj
->
id
.
subdevi˚
;

957 
	}
}

964 c⁄° *
	$¢d_h˘l_ñem_gë_«me
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
)

966 
	`as£π
(
obj
);

967  (c⁄° *)
obj
->
id
.
«me
;

968 
	}
}

975 
	$¢d_h˘l_ñem_gë_ödex
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
)

977 
	`as£π
(
obj
);

978  
obj
->
id
.
ödex
;

979 
	}
}

986 
	$¢d_h˘l_ñem_£t_ˇŒback
(
¢d_h˘l_ñem_t
 *
obj
, 
¢d_h˘l_ñem_ˇŒback_t
 
vÆ
)

988 
	`as£π
(
obj
);

989 
obj
->
ˇŒback
 = 
vÆ
;

990 
	}
}

997 
	$¢d_h˘l_ñem_£t_ˇŒback_¥iv©e
(
¢d_h˘l_ñem_t
 *
obj
, * 
vÆ
)

999 
	`as£π
(
obj
);

1000 
obj
->
ˇŒback_¥iv©e
 = 
vÆ
;

1001 
	}
}

1008 * 
	$¢d_h˘l_ñem_gë_ˇŒback_¥iv©e
(c⁄° 
¢d_h˘l_ñem_t
 *
obj
)

1010 
	`as£π
(
obj
);

1011  
obj
->
ˇŒback_¥iv©e
;

1012 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/namehint.c

29 
	~"loˇl.h
"

31 #i‚de‡
DOC_HIDDEN


32 
	#DEV_SKIP
 9999

	)

33 
	shöt_li°
 {

34 **
	mli°
;

35 
	mcou¡
;

36 
	mÆloˇãd
;

37 c⁄° *
	msiÁ˚
;

38 
¢d_˘l_ñem_iÁ˚_t
 
	miÁ˚
;

39 
¢d_˘l_t
 *
	m˘l
;

40 
¢d_˘l_ˇrd_öfo_t
 *
	möfo
;

41 
	mˇrd
;

42 
	mdevi˚
;

43 
	mdevi˚_öput
;

44 
	mdevi˚_ouçut
;

45 
	m°ªam
;

46 
	mshow_Æl
;

47 *
	mˇrd«me
;

51 
	$höt_li°_add
(
höt_li°
 *
li°
,

52 c⁄° *
«me
,

53 c⁄° *
des¸ùti⁄
)

55 *
x
;

57 i‡(
li°
->
cou¡
 + 1 >li°->
Æloˇãd
) {

58 **
n
 = 
	`ªÆloc
(
li°
->li°, (li°->
Æloˇãd
 + 10) * (*));

59 i‡(
n
 =
NULL
)

60  -
ENOMEM
;

61 
	`mem£t
(
n
 + 
li°
->
Æloˇãd
, 0, 10 * (*n));

62 
li°
->
Æloˇãd
 += 10;

63 
li°
->li° = 
n
;

65 i‡(
«me
 =
NULL
) {

66 
x
 = 
NULL
;

68 
x
 = 
	`mÆloc
(4 + 
	`°æí
(
«me
Ë+ (
des¸ùti⁄
 !
NULL
 ? (4 + strlen(description) + 1) : 0) + 1);

69 i‡(
x
 =
NULL
)

70  -
ENOMEM
;

71 
	`mem˝y
(
x
, "NAME", 4);

72 
	`°r˝y
(
x
 + 4, 
«me
);

73 i‡(
des¸ùti⁄
 !
NULL
) {

74 
	`°rˇt
(
x
, "|DESC");

75 
	`°rˇt
(
x
, 
des¸ùti⁄
);

78 
li°
->li°[li°->
cou¡
++] = 
x
;

80 
	}
}

85 
	$höt_li°_add_cu°om
(
höt_li°
 *
li°
,

86 c⁄° *
íåy
)

88 
îr
;

89 c⁄° *
£p
;

90 *
«me
;

92 
	`as£π
(
íåy
);

94 
£p
 = 
	`°rchr
(
íåy
, '|');

95 i‡(
£p
 =
NULL
)

96  
	`höt_li°_add
(
li°
, 
íåy
, 
NULL
);

98 
«me
 = 
	`°∫dup
(
íåy
, 
£p
 -Éntry);

99 i‡(
«me
 =
NULL
)

100  -
ENOMEM
;

102 
îr
 = 
	`höt_li°_add
(
li°
, 
«me
, 
£p
 + 1);

103 
	`‰ì
(
«me
);

104  
îr
;

105 
	}
}

107 
	$zîo_h™dÀr
(c⁄° *
fûe
 
ATTRIBUTE_UNUSED
,

108 
löe
 
ATTRIBUTE_UNUSED
,

109 c⁄° *
fun˘i⁄
 
ATTRIBUTE_UNUSED
,

110 
îr
 
ATTRIBUTE_UNUSED
,

111 c⁄° *
fmt
 
ATTRIBUTE_UNUSED
,

112 
va_li°
 
¨g
 
ATTRIBUTE_UNUSED
)

114 
	}
}

116 
	$gë_dev_«me1
(
höt_li°
 *
li°
, **
ªs
, 
devi˚
,

117 
°ªam
)

119 *
ªs
 = 
NULL
;

120 i‡(
devi˚
 < 0 || devi˚ =
DEV_SKIP
)

122 
li°
->
iÁ˚
) {

123 #ifde‡
BUILD_HWDEP


124 
SND_CTL_ELEM_IFACE_HWDEP
:

126 
¢d_hwdï_öfo_t
 
öfo
 = {0};

127 
	`¢d_hwdï_öfo_£t_devi˚
(&
öfo
, 
devi˚
);

128 i‡(
	`¢d_˘l_hwdï_öfo
(
li°
->
˘l
, &
öfo
) < 0)

130 *
ªs
 = 
	`°rdup
(
	`¢d_hwdï_öfo_gë_«me
(&
öfo
));

134 #ifde‡
BUILD_PCM


135 
SND_CTL_ELEM_IFACE_PCM
:

137 
¢d_pcm_öfo_t
 
öfo
 = {0};

138 
	`¢d_pcm_öfo_£t_devi˚
(&
öfo
, 
devi˚
);

139 
	`¢d_pcm_öfo_£t_°ªam
(&
öfo
, 
°ªam
 ? 
SND_PCM_STREAM_CAPTURE
 : 
SND_PCM_STREAM_PLAYBACK
);

140 i‡(
	`¢d_˘l_pcm_öfo
(
li°
->
˘l
, &
öfo
) < 0)

142 
	`¢d_pcm_öfo_gë_˛ass
(&
öfo
)) {

143 
SND_PCM_CLASS_MODEM
:

144 
SND_PCM_CLASS_DIGITIZER
:

145  -
ENODEV
;

149 *
ªs
 = 
	`°rdup
(
	`¢d_pcm_öfo_gë_«me
(&
öfo
));

153 #ifde‡
BUILD_RAWMIDI


154 
SND_CTL_ELEM_IFACE_RAWMIDI
:

156 
¢d_øwmidi_öfo_t
 
öfo
 = {0};

157 
	`¢d_øwmidi_öfo_£t_devi˚
(&
öfo
, 
devi˚
);

158 
	`¢d_øwmidi_öfo_£t_°ªam
(&
öfo
, 
°ªam
 ? 
SND_RAWMIDI_STREAM_INPUT
 : 
SND_RAWMIDI_STREAM_OUTPUT
);

159 i‡(
	`¢d_˘l_øwmidi_öfo
(
li°
->
˘l
, &
öfo
) < 0)

161 *
ªs
 = 
	`°rdup
(
	`¢d_øwmidi_öfo_gë_«me
(&
öfo
));

168 
	}
}

170 *
	$gë_dev_«me
(
höt_li°
 *
li°
)

172 *
°r1
, *
°r2
, *
ªs
;

173 
devi˚
;

175 
devi˚
 = 
li°
->
devi˚_öput
 >= 0 ?Üist->device_input :Üist->device;

176 i‡(
	`gë_dev_«me1
(
li°
, &
°r1
, 
devi˚
, 1) < 0)

177  
NULL
;

178 
devi˚
 = 
li°
->
devi˚_ouçut
 >= 0 ?Üist->device_output :Üist->device;

179 i‡(
	`gë_dev_«me1
(
li°
, &
°r2
, 
devi˚
, 0) < 0) {

180 i‡(
°r1
)

181 
	`‰ì
(
°r1
);

182  
NULL
;

184 i‡(
°r1
 !
NULL
 || 
°r2
 != NULL) {

185 i‡(
°r1
 !
NULL
 && 
°r2
 != NULL) {

186 i‡(
	`°rcmp
(
°r1
, 
°r2
) == 0) {

187 
ªs
 = 
	`mÆloc
(
	`°æí
(
li°
->
ˇrd«me
Ë+ såÀn(
°r2
) + 3);

188 i‡(
ªs
 !
NULL
) {

189 
	`°r˝y
(
ªs
, 
li°
->
ˇrd«me
);

190 
	`°rˇt
(
ªs
, ", ");

191 
	`°rˇt
(
ªs
, 
°r2
);

194 
ªs
 = 
	`mÆloc
(
	`°æí
(
li°
->
ˇrd«me
Ë+ såÀn(
°r2
Ë+ såÀn(
°r1
) + 6);

195 i‡(
ªs
 !
NULL
) {

196 
	`°r˝y
(
ªs
, 
li°
->
ˇrd«me
);

197 
	`°rˇt
(
ªs
, ", ");

198 
	`°rˇt
(
ªs
, 
°r2
);

199 
	`°rˇt
(
ªs
, " / ");

200 
	`°rˇt
(
ªs
, 
°r1
);

203 
	`‰ì
(
°r2
);

204 
	`‰ì
(
°r1
);

205  
ªs
;

207 i‡(
°r1
 !
NULL
) {

208 
°r2
 = "Input";

210 
°r1
 = 
°r2
;

211 
°r2
 = "Output";

213 
ªs
 = 
	`mÆloc
(
	`°æí
(
li°
->
ˇrd«me
Ë+ såÀn(
°r1
) + 19);

214 i‡(
ªs
 =
NULL
) {

215 
	`‰ì
(
°r1
);

216  
NULL
;

218 
	`°r˝y
(
ªs
, 
li°
->
ˇrd«me
);

219 
	`°rˇt
(
ªs
, ", ");

220 
	`°rˇt
(
ªs
, 
°r1
);

221 
	`°rˇt
(
ªs
, "|IOID");

222 
	`°rˇt
(
ªs
, 
°r2
);

223 
	`‰ì
(
°r1
);

224  
ªs
;

228 i‡(
li°
->
devi˚
 >0 ||Üi°->
devi˚_öput
 >0 ||Üi°->
devi˚_ouçut
 >= 0)

229  
NULL
;

230  
	`°rdup
(
li°
->
ˇrd«me
);

231 
	}
}

233 #i‚de‡
DOC_HIDDEN


234 
	#BUF_SIZE
 128

	)

237 
	$åy_c⁄fig
(
¢d_c⁄fig_t
 *
c⁄fig
,

238 
höt_li°
 *
li°
,

239 c⁄° *
ba£
,

240 c⁄° *
«me
)

242 
¢d_loˇl_îr‹_h™dÀr_t
 
eh
;

243 
¢d_c⁄fig_t
 *
ªs
 = 
NULL
, *
cfg
, *
cfg1
, *
n
;

244 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

245 *
buf
, *
buf1
 = 
NULL
, *
buf2
;

246 c⁄° *
°r
;

247 
îr
 = 0, 
Àvñ
;

248 
dev
 = 
li°
->
devi˚
;

249 
˛ónup_ªs
 = 0;

251 
li°
->
devi˚_öput
 = -1;

252 
li°
->
devi˚_ouçut
 = -1;

253 
buf
 = 
	`mÆloc
(
BUF_SIZE
);

254 i‡(
buf
 =
NULL
)

255  -
ENOMEM
;

256 
	`•rötf
(
buf
, "%s.%s", 
ba£
, 
«me
);

258 i‡(
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, 
buf
, &
cfg
) >= 0 &&

259 
	`¢d_c⁄fig_gë_°rög
(
cfg
, &
°r
) >= 0 &&

260 ((
	`°∫cmp
(
ba£
, 
°r
, 
	`°æí
(base)) == 0 &&

261 
°r
[
	`°æí
(
ba£
)] ='.'Ë|| 
	`°rchr
(°r, '.'Ë=
NULL
))

262 
__skù_add
;

263 i‡(
li°
->
ˇrd
 >0 &&Üi°->
devi˚
 >= 0)

264 
	`•rötf
(
buf
, "%s:CARD=%s,DEV=%i", 
«me
, 
	`¢d_˘l_ˇrd_öfo_gë_id
(
li°
->
öfo
),Üi°->
devi˚
);

265 i‡(
li°
->
ˇrd
 >= 0)

266 
	`•rötf
(
buf
, "%s:CARD=%s", 
«me
, 
	`¢d_˘l_ˇrd_öfo_gë_id
(
li°
->
öfo
));

268 
	`°r˝y
(
buf
, 
«me
);

269 
eh
 = 
	`¢d_lib_îr‹_£t_loˇl
(&
zîo_h™dÀr
);

270 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
c⁄fig
, 
ba£
, 
buf
, &
ªs
);

271 
	`¢d_lib_îr‹_£t_loˇl
(
eh
);

272 i‡(
îr
 < 0)

273 
__skù_add
;

274 
˛ónup_ªs
 = 1;

275 
îr
 = -
EINVAL
;

276 i‡(
	`¢d_c⁄fig_gë_ty≥
(
ªs
Ë!
SND_CONFIG_TYPE_COMPOUND
)

277 
__˛ónup
;

278 i‡(
	`¢d_c⁄fig_£¨ch
(
ªs
, "ty≥", 
NULL
) < 0)

279 
__˛ónup
;

283 
¢d_ouçut_t
 *
out
;

284 
	`Ârötf
(
°dîr
, "********* PCM '%s':\n", 
buf
);

285 
	`¢d_ouçut_°dio_©èch
(&
out
, 
°dîr
, 0);

286 
	`¢d_c⁄fig_ßve
(
ªs
, 
out
);

287 
	`¢d_ouçut_˛o£
(
out
);

288 
	`Ârötf
(
°dîr
, "\n");

292 
cfg1
 = 
ªs
;

293 
Àvñ
 = 0;

294 
__höt
:

295 
Àvñ
++;

296 i‡(
	`¢d_c⁄fig_£¨ch
(
cfg1
, "ty≥", &
cfg
) >= 0 &&

297 
	`¢d_c⁄fig_gë_°rög
(
cfg
, &
°r
) >= 0 &&

298 
	`°rcmp
(
°r
, "hw") == 0) {

299 i‡(
	`¢d_c⁄fig_£¨ch
(
cfg1
, "devi˚", &
cfg
) >= 0) {

300 i‡(
	`¢d_c⁄fig_gë_öãgî
(
cfg
, &
dev
) < 0) {

301 
	`SNDERR
("(%sËdevi˚ mu° bê™ i¡egî", 
buf
);

302 
îr
 = -
EINVAL
;

303 
__˛ónup
;

308 i‡(
	`¢d_c⁄fig_£¨ch
(
cfg1
, "höt", &
cfg
) >= 0) {

309 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

310 
	`SNDERR
("höà(%sËmu° bê®compound", 
buf
);

311 
îr
 = -
EINVAL
;

312 
__˛ónup
;

314 i‡(
li°
->
ˇrd
 < 0 &&

315 
	`¢d_c⁄fig_£¨ch
(
cfg
, "omô_nﬂrgs", &
n
) >= 0 &&

316 
	`¢d_c⁄fig_gë_boﬁ
(
n
) > 0)

317 
__skù_add
;

318 i‡(
Àvñ
 == 1 &&

319 
	`¢d_c⁄fig_£¨ch
(
cfg
, "show", &
n
) >= 0 &&

320 
	`¢d_c⁄fig_gë_boﬁ
(
n
) <= 0)

321 
__skù_add
;

322 i‡(
buf1
 =
NULL
 &&

323 
	`¢d_c⁄fig_£¨ch
(
cfg
, "des¸ùti⁄", &
n
) >= 0 &&

324 
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
) >= 0) {

325 
buf1
 = 
	`°rdup
(
°r
);

326 i‡(
buf1
 =
NULL
) {

327 
îr
 = -
ENOMEM
;

328 
__˛ónup
;

331 i‡(
	`¢d_c⁄fig_£¨ch
(
cfg
, "devi˚", &
n
) >= 0) {

332 i‡(
	`¢d_c⁄fig_gë_öãgî
(
n
, &
dev
) < 0) {

333 
	`SNDERR
("(%sËdevi˚ mu° bê™ i¡egî", 
buf
);

334 
îr
 = -
EINVAL
;

335 
__˛ónup
;

337 
li°
->
devi˚_öput
 = 
dev
;

338 
li°
->
devi˚_ouçut
 = 
dev
;

340 i‡(
	`¢d_c⁄fig_£¨ch
(
cfg
, "devi˚_öput", &
n
) >= 0) {

341 i‡(
	`¢d_c⁄fig_gë_öãgî
(
n
, &
li°
->
devi˚_öput
) < 0) {

342 
	`SNDERR
("(%sËdevi˚_öpuàmu° bê™ i¡egî", 
buf
);

343 
îr
 = -
EINVAL
;

344 
__˛ónup
;

347 i‡(
li°
->
devi˚_ouçut
 < 0)

348 
li°
->
devi˚_ouçut
 = 
DEV_SKIP
;

350 i‡(
	`¢d_c⁄fig_£¨ch
(
cfg
, "devi˚_ouçut", &
n
) >= 0) {

351 i‡(
	`¢d_c⁄fig_gë_öãgî
(
n
, &
li°
->
devi˚_ouçut
) < 0) {

352 
	`SNDERR
("(%sËdevi˚_ouçuàmu° bê™ i¡egî", 
buf
);

353 
îr
 = -
EINVAL
;

354 
__˛ónup
;

357 i‡(
li°
->
devi˚_öput
 < 0)

358 
li°
->
devi˚_öput
 = 
DEV_SKIP
;

360 } i‡(
Àvñ
 =1 && !
li°
->
show_Æl
)

361 
__skù_add
;

362 i‡(
	`¢d_c⁄fig_£¨ch
(
cfg1
, "¶ave", &
cfg
) >= 0 &&

363 
	`¢d_c⁄fig_£¨ch
(
cfg
, 
ba£
, &
cfg1
) >= 0)

364 
__höt
;

365 
	`¢d_c⁄fig_dñëe
(
ªs
);

366 
ªs
 = 
NULL
;

367 
˛ónup_ªs
 = 0;

368 i‡(
	`°rchr
(
buf
, ':'Ë!
NULL
)

369 
__ok
;

372 
eh
 = 
	`¢d_lib_îr‹_£t_loˇl
(&
zîo_h™dÀr
);

373 
îr
 = 
	`¢d_c⁄fig_£¨ch_Æüs_hooks
(
c⁄fig
, 
ba£
, 
buf
, &
ªs
);

374 
	`¢d_lib_îr‹_£t_loˇl
(
eh
);

375 i‡(
îr
 < 0)

376 
__˛ónup
;

377 i‡(
	`¢d_c⁄fig_£¨ch
(
ªs
, "@¨gs", &
cfg
) >= 0) {

378 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

380 i‡(
	`¢d_c⁄fig_gë_id
(
	`¢d_c⁄fig_ôî©‹_íåy
(
i
), &
°r
) < 0)

382 *
°r
 && *str >= '0' && *str <= '9') str++;

383 i‡(*
°r
 == '\0')

386 i‡(
	`¢d_c⁄fig_£¨ch
(
	`¢d_c⁄fig_ôî©‹_íåy
(
i
),

387 "deÁu…", 
NULL
) < 0) {

388 
îr
 = -
EINVAL
;

389 
__˛ónup
;

393 
__ok
:

394 
îr
 = 0;

395 
__˛ónup
:

396 i‡(
îr
 >= 0) {

397 
li°
->
devi˚
 = 
dev
;

398 
°r
 = 
li°
->
ˇrd
 >0 ? 
	`gë_dev_«me
÷i°Ë: 
NULL
;

399 i‡(
°r
 !
NULL
) {

400 
Àvñ
 = (
buf1
 =
NULL
 ? 0 : 
	`°æí
(buf1)Ë+ 1 + såÀn(
°r
);

401 
buf2
 = 
	`ªÆloc
((*)
°r
, 
Àvñ
 + 1);

402 i‡(
buf2
 !
NULL
) {

403 i‡(
buf1
 !
NULL
) {

404 
°r
 = 
	`°rchr
(
buf2
, '|');

405 i‡(
°r
 !
NULL
)

406 
	`memmove
(
buf2
 + (
Àvñ
 - 
	`°æí
(
°r
)), str, strlen(str));

408 
°r
 = 
buf2
 + 
	`°æí
(buf2);

409 *(*)
°r
++ = '\n';

410 
	`mem˝y
((*)
°r
, 
buf1
, 
	`°æí
(buf1));

411 
buf2
[
Àvñ
] = '\0';

412 
	`‰ì
(
buf1
);

414 
buf1
 = 
buf2
;

416 
	`‰ì
((*)
°r
);

418 } i‡(
li°
->
devi˚
 >= 0)

419 
__skù_add
;

420 
îr
 = 
	`höt_li°_add
(
li°
, 
buf
, 
buf1
);

422 
__skù_add
:

423 i‡(
ªs
 && 
˛ónup_ªs
)

424 
	`¢d_c⁄fig_dñëe
(
ªs
);

425 i‡(
buf1
)

426 
	`‰ì
(
buf1
);

427 
	`‰ì
(
buf
);

428  
îr
;

429 
	}
}

431 #i‚de‡
DOC_HIDDEN


432 
	#IFACE
(
v
, 
f˙
Ë[
SND_CTL_ELEM_IFACE_
##v] = (
√xt_devi˚s_t
)
	)
fcn

434 (*
	t√xt_devi˚s_t
)(
	t¢d_˘l_t
 *, *);

436 c⁄° 
√xt_devi˚s_t
 
√xt_devi˚s
[] = {

437 
	`IFACE
(
CARD
, 
NULL
),

438 
	`IFACE
(
HWDEP
, 
¢d_˘l_hwdï_√xt_devi˚
),

439 
	`IFACE
(
MIXER
, 
NULL
),

440 
	`IFACE
(
PCM
, 
¢d_˘l_pcm_√xt_devi˚
),

441 
	`IFACE
(
RAWMIDI
, 
¢d_˘l_øwmidi_√xt_devi˚
),

442 
	`IFACE
(
TIMER
, 
NULL
),

443 
	`IFACE
(
SEQUENCER
, 
NULL
)

444 
	}
};

447 
	$add_ˇrd
(
¢d_c⁄fig_t
 *
c⁄fig
, snd_c⁄fig_à*
rw_c⁄fig
, 
höt_li°
 *
li°
, 
ˇrd
)

449 
îr
, 
ok
;

450 
¢d_c⁄fig_t
 *
c⁄f
, *
n
;

451 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

452 c⁄° *
°r
;

453 
˘l_«me
[16];

454 
¢d_˘l_ˇrd_öfo_t
 
öfo
 = {0};

455 
devi˚
, 
max_devi˚
 = 0;

457 
li°
->
öfo
 = &info;

458 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, 
li°
->
siÁ˚
, &
c⁄f
);

459 i‡(
îr
 < 0)

460  
îr
;

461 
	`•rötf
(
˘l_«me
, "hw:%i", 
ˇrd
);

462 
îr
 = 
	`¢d_˘l_›í
(&
li°
->
˘l
, 
˘l_«me
, 0);

463 i‡(
îr
 < 0)

464  
îr
;

465 
îr
 = 
	`¢d_˘l_ˇrd_öfo
(
li°
->
˘l
, &
öfo
);

466 i‡(
îr
 < 0)

467 
__îr‹
;

468 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

469 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

470 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
°r
) < 0)

473 i‡(
√xt_devi˚s
[
li°
->
iÁ˚
] !
NULL
) {

474 
li°
->
ˇrd
 = card;

475 
devi˚
 = 
max_devi˚
 = -1;

476 
îr
 = 
√xt_devi˚s
[
li°
->
iÁ˚
]÷i°->
˘l
, &
devi˚
);

477 i‡(
devi˚
 < 0)

478 
îr
 = -
EINVAL
;

480 
max_devi˚
 = 
devi˚
;

481 
îr
 >0 && 
devi˚
 >= 0) {

482 
îr
 = 
√xt_devi˚s
[
li°
->
iÁ˚
]÷i°->
˘l
, &
devi˚
);

483 i‡(
îr
 >0 && 
devi˚
 > 
max_devi˚
)

484 
max_devi˚
 = 
devi˚
;

486 
ok
 = 0;

487 
devi˚
 = 0; 
îr
 >0 && devi˚ <
max_devi˚
; device++) {

488 
li°
->
devi˚
 = device;

489 
îr
 = 
	`åy_c⁄fig
(
rw_c⁄fig
, 
li°
,Üi°->
siÁ˚
, 
°r
);

490 i‡(
îr
 < 0)

492 
ok
++;

494 i‡(
ok
)

497 
îr
 = -
EINVAL
;

499 i‡(
îr
 =-
EXDEV
)

501 i‡(
îr
 < 0) {

502 
li°
->
ˇrd
 = card;

503 
li°
->
devi˚
 = -1;

504 
îr
 = 
	`åy_c⁄fig
(
rw_c⁄fig
, 
li°
,Üi°->
siÁ˚
, 
°r
);

506 i‡(
îr
 =-
ENOMEM
)

507 
__îr‹
;

509 
îr
 = 0;

510 
__îr‹
:

511 
	`¢d_˘l_˛o£
(
li°
->
˘l
);

512  
îr
;

513 
	}
}

515 
	$gë_ˇrd_«me
(
höt_li°
 *
li°
, 
ˇrd
)

517 
sˇrd
[16], *
s
;

518 
îr
;

520 
	`‰ì
(
li°
->
ˇrd«me
);

521 
li°
->
ˇrd«me
 = 
NULL
;

522 
îr
 = 
	`¢d_ˇrd_gë_«me
(
ˇrd
, &
li°
->
ˇrd«me
);

523 i‡(
îr
 <= 0)

525 
	`•rötf
(
sˇrd
, " #%i", 
ˇrd
);

526 
s
 = 
	`ªÆloc
(
li°
->
ˇrd«me
, 
	`°æí
÷i°->ˇrd«meË+ såÀn(
sˇrd
) + 1);

527 i‡(
s
 =
NULL
)

528  -
ENOMEM
;

529 
li°
->
ˇrd«me
 = 
s
;

531 
	}
}

533 
	$add_so·w¨e_devi˚s
(
¢d_c⁄fig_t
 *
c⁄fig
, snd_c⁄fig_à*
rw_c⁄fig
,

534 
höt_li°
 *
li°
)

536 
îr
;

537 
¢d_c⁄fig_t
 *
c⁄f
, *
n
;

538 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

539 c⁄° *
°r
;

541 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, 
li°
->
siÁ˚
, &
c⁄f
);

542 i‡(
îr
 < 0)

543  
îr
;

544 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

545 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

546 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
°r
) < 0)

548 
li°
->
ˇrd
 = -1;

549 
li°
->
devi˚
 = -1;

550 
îr
 = 
	`åy_c⁄fig
(
rw_c⁄fig
, 
li°
,Üi°->
siÁ˚
, 
°r
);

551 i‡(
îr
 =-
ENOMEM
)

552  -
ENOMEM
;

555 
	}
}

583 
	$¢d_devi˚_«me_höt
(
ˇrd
, c⁄° *
iÁ˚
, ***
höts
)

585 
höt_li°
 
li°
;

586 
ehöts
[24];

587 c⁄° *
°r
;

588 
¢d_c⁄fig_t
 *
c⁄f
, *
loˇl_c⁄fig
 = 
NULL
, *
loˇl_c⁄fig_rw
 = NULL;

589 
¢d_c⁄fig_upd©e_t
 *
loˇl_c⁄fig_upd©e
 = 
NULL
;

590 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

591 
îr
;

593 i‡(
höts
 =
NULL
)

594  -
EINVAL
;

595 
îr
 = 
	`¢d_c⁄fig_upd©e_r
(&
loˇl_c⁄fig
, &
loˇl_c⁄fig_upd©e
, 
NULL
);

596 i‡(
îr
 < 0)

597  
îr
;

598 
îr
 = 
	`¢d_c⁄fig_c›y
(&
loˇl_c⁄fig_rw
, 
loˇl_c⁄fig
);

599 i‡(
îr
 < 0)

600  
îr
;

601 
li°
.li° = 
NULL
;

602 
li°
.
cou¡
 =Üi°.
Æloˇãd
 = 0;

603 
li°
.
siÁ˚
 = 
iÁ˚
;

604 
li°
.
show_Æl
 = 0;

605 
li°
.
ˇrd«me
 = 
NULL
;

606 i‡(
	`°rcmp
(
iÁ˚
, "pcm") == 0)

607 
li°
.
iÁ˚
 = 
SND_CTL_ELEM_IFACE_PCM
;

608 i‡(
	`°rcmp
(
iÁ˚
, "rawmidi") == 0)

609 
li°
.
iÁ˚
 = 
SND_CTL_ELEM_IFACE_RAWMIDI
;

610 i‡(
	`°rcmp
(
iÁ˚
, "timer") == 0)

611 
li°
.
iÁ˚
 = 
SND_CTL_ELEM_IFACE_TIMER
;

612 i‡(
	`°rcmp
(
iÁ˚
, "seq") == 0)

613 
li°
.
iÁ˚
 = 
SND_CTL_ELEM_IFACE_SEQUENCER
;

614 i‡(
	`°rcmp
(
iÁ˚
, "hwdep") == 0)

615 
li°
.
iÁ˚
 = 
SND_CTL_ELEM_IFACE_HWDEP
;

616 i‡(
	`°rcmp
(
iÁ˚
, "ctl") == 0)

617 
li°
.
iÁ˚
 = 
SND_CTL_ELEM_IFACE_MIXER
;

619 
îr
 = -
EINVAL
;

620 
__îr‹
;

623 i‡(
	`¢d_c⁄fig_£¨ch
(
loˇl_c⁄fig
, "deÁu…s.«mehöt.showÆl", &
c⁄f
) >= 0)

624 
li°
.
show_Æl
 = 
	`¢d_c⁄fig_gë_boﬁ
(
c⁄f
) > 0;

625 i‡(
ˇrd
 >= 0) {

626 
îr
 = 
	`gë_ˇrd_«me
(&
li°
, 
ˇrd
);

627 i‡(
îr
 >= 0)

628 
îr
 = 
	`add_ˇrd
(
loˇl_c⁄fig
, 
loˇl_c⁄fig_rw
, &
li°
, 
ˇrd
);

630 
	`add_so·w¨e_devi˚s
(
loˇl_c⁄fig
, 
loˇl_c⁄fig_rw
, &
li°
);

631 
îr
 = 
	`¢d_ˇrd_√xt
(&
ˇrd
);

632 i‡(
îr
 < 0)

633 
__îr‹
;

634 
ˇrd
 >= 0) {

635 
îr
 = 
	`gë_ˇrd_«me
(&
li°
, 
ˇrd
);

636 i‡(
îr
 < 0)

637 
__îr‹
;

638 
îr
 = 
	`add_ˇrd
(
loˇl_c⁄fig
, 
loˇl_c⁄fig_rw
, &
li°
, 
ˇrd
);

639 i‡(
îr
 < 0)

640 
__îr‹
;

641 
îr
 = 
	`¢d_ˇrd_√xt
(&
ˇrd
);

642 i‡(
îr
 < 0)

643 
__îr‹
;

646 
	`•rötf
(
ehöts
, "«mehöt.%s", 
li°
.
siÁ˚
);

647 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
loˇl_c⁄fig
, 
ehöts
, &
c⁄f
);

648 i‡(
îr
 >= 0) {

649 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

650 i‡(
	`¢d_c⁄fig_gë_°rög
(
	`¢d_c⁄fig_ôî©‹_íåy
(
i
),

651 &
°r
) < 0)

653 
îr
 = 
	`höt_li°_add_cu°om
(&
li°
, 
°r
);

654 i‡(
îr
 < 0)

655 
__îr‹
;

658 
îr
 = 0;

659 
__îr‹
:

663 i‡(!
îr
 && !
li°
.list)

664 
îr
 = 
	`höt_li°_add
(&
li°
, 
NULL
, NULL);

665 i‡(
îr
 < 0)

666 
	`¢d_devi˚_«me_‰ì_höt
((**)
li°
.list);

668 *
höts
 = (**)
li°
.list;

669 
	`‰ì
(
li°
.
ˇrd«me
);

670 i‡(
loˇl_c⁄fig_rw
)

671 
	`¢d_c⁄fig_dñëe
(
loˇl_c⁄fig_rw
);

672 i‡(
loˇl_c⁄fig
)

673 
	`¢d_c⁄fig_dñëe
(
loˇl_c⁄fig
);

674 i‡(
loˇl_c⁄fig_upd©e
)

675 
	`¢d_c⁄fig_upd©e_‰ì
(
loˇl_c⁄fig_upd©e
);

676  
îr
;

677 
	}
}

684 
	$¢d_devi˚_«me_‰ì_höt
(**
höts
)

686 **
h
;

688 i‡(
höts
 =
NULL
)

690 
h
 = (**)
höts
;

691 *
h
) {

692 
	`‰ì
(*
h
);

693 
h
++;

695 
	`‰ì
(
höts
);

697 
	}
}

712 *
	$¢d_devi˚_«me_gë_höt
(c⁄° *
höt
, c⁄° *
id
)

714 c⁄° *
höt1
 = (c⁄° *)
höt
, *
dñim
;

715 *
ªs
;

716 
size
;

718 i‡(
	`°æí
(
id
) != 4)

719  
NULL
;

720 *
höt1
 != '\0') {

721 
dñim
 = 
	`°rchr
(
höt1
, '|');

722 i‡(
	`memcmp
(
id
, 
höt1
, 4) != 0) {

723 i‡(
dñim
 =
NULL
)

724  
NULL
;

725 
höt1
 = 
dñim
 + 1;

728 i‡(
dñim
 =
NULL
)

729  
	`°rdup
(
höt1
 + 4);

730 
size
 = 
dñim
 - 
höt1
 - 4;

731 
ªs
 = 
	`mÆloc
(
size
 + 1);

732 i‡(
ªs
 !
NULL
) {

733 
	`mem˝y
(
ªs
, 
höt1
 + 4, 
size
);

734 
ªs
[
size
] = '\0';

736  
ªs
;

738  
NULL
;

739 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/setup.c

32 
	~"loˇl.h
"

33 
	~<°dio.h
>

34 
	~<°dlib.h
>

35 
	~<°d¨g.h
>

36 
	~<uni°d.h
>

37 
	~<°rög.h
>

38 
	~<˘y≥.h
>

40 #i‚de‡
DOC_HIDDEN


42 
	mlock
: 1;

43 
	m¥e£rve
: 1;

44 
¢d_˘l_ñem_id_t
 *
	mid
;

45 
¢d_˘l_ñem_öfo_t
 *
	möfo
;

46 
¢d_˘l_ñem_vÆue_t
 *
	mvÆ
;

47 
¢d_˘l_ñem_vÆue_t
 *
	mmask
;

48 
¢d_˘l_ñem_vÆue_t
 *
	mﬁd
;

49 
li°_hód
 
	mli°
;

50 } 
	t¢d_s˘l_ñem_t
;

52 
	s_¢d_s˘l
 {

53 
	mmode
;

54 
¢d_˘l_t
 *
	m˘l
;

55 
li°_hód
 
	mñems
;

59 
	$‰ì_ñems
(
¢d_s˘l_t
 *
h
)

61 
îr
 = 0;

62 !
	`li°_em±y
(&
h
->
ñems
)) {

63 
¢d_s˘l_ñem_t
 *
ñem
 = 
	`li°_íåy
(
h
->
ñems
.
√xt
, snd_s˘l_ñem_t, 
li°
);

64 
	`¢d_˘l_ñem_id_‰ì
(
ñem
->
id
);

65 
	`¢d_˘l_ñem_öfo_‰ì
(
ñem
->
öfo
);

66 
	`¢d_˘l_ñem_vÆue_‰ì
(
ñem
->
vÆ
);

67 
	`¢d_˘l_ñem_vÆue_‰ì
(
ñem
->
mask
);

68 
	`¢d_˘l_ñem_vÆue_‰ì
(
ñem
->
ﬁd
);

69 
	`li°_dñ
(&
ñem
->
li°
);

70 
	`‰ì
(
ñem
);

72 i‡((
h
->
mode
 & 
SND_SCTL_NOFREE
) == 0)

73 
îr
 = 
	`¢d_˘l_˛o£
(
h
->
˘l
);

74 
	`‰ì
(
h
);

75  
îr
;

76 
	}
}

83 
	$¢d_s˘l_ö°Æl
(
¢d_s˘l_t
 *
h
)

85 
li°_hód
 *
pos
;

86 
îr
;

87 
k
;

88 
	`as£π
(
h
);

89 
	`li°_f‹_óch
(
pos
, &
h
->
ñems
) {

90 
¢d_s˘l_ñem_t
 *
ñem
 = 
	`li°_íåy
(
pos
, snd_s˘l_ñem_t, 
li°
);

91 
cou¡
;

92 
¢d_˘l_ñem_ty≥_t
 
ty≥
;

93 i‡(
ñem
->
lock
) {

94 
îr
 = 
	`¢d_˘l_ñem_lock
(
h
->
˘l
, 
ñem
->
id
);

95 i‡(
îr
 < 0) {

96 
	`SNDERR
("CannotÜock ctlÉlem");

97  
îr
;

100 
îr
 = 
	`¢d_˘l_ñem_ªad
(
h
->
˘l
, 
ñem
->
ﬁd
);

101 i‡(
îr
 < 0) {

102 
	`SNDERR
("CannotÑead ctlÉlem");

103  
îr
;

105 
cou¡
 = 
	`¢d_˘l_ñem_öfo_gë_cou¡
(
ñem
->
öfo
);

106 
ty≥
 = 
	`¢d_˘l_ñem_öfo_gë_ty≥
(
ñem
->
öfo
);

107 
ty≥
) {

108 
SND_CTL_ELEM_TYPE_BOOLEAN
:

109 
k
 = 0; k < 
cou¡
; ++k) {

110 
ﬁd
, 
vÆ
, 
mask
;

111 
ﬁd
 = 
	`¢d_˘l_ñem_vÆue_gë_boﬁón
(
ñem
->ﬁd, 
k
);

112 
mask
 = 
	`¢d_˘l_ñem_vÆue_gë_boﬁón
(
ñem
->mask, 
k
);

113 
ﬁd
 &~
mask
;

114 i‡(
ﬁd
) {

115 
vÆ
 = 
	`¢d_˘l_ñem_vÆue_gë_boﬁón
(
ñem
->vÆ, 
k
);

116 
vÆ
 |
ﬁd
;

117 
	`¢d_˘l_ñem_vÆue_£t_boﬁón
(
ñem
->
vÆ
, 
k
, val);

121 
SND_CTL_ELEM_TYPE_INTEGER
:

122 
k
 = 0; k < 
cou¡
; ++k) {

123 
ﬁd
, 
vÆ
, 
mask
;

124 
ﬁd
 = 
	`¢d_˘l_ñem_vÆue_gë_öãgî
(
ñem
->ﬁd, 
k
);

125 
mask
 = 
	`¢d_˘l_ñem_vÆue_gë_öãgî
(
ñem
->mask, 
k
);

126 
ﬁd
 &~
mask
;

127 i‡(
ﬁd
) {

128 
vÆ
 = 
	`¢d_˘l_ñem_vÆue_gë_öãgî
(
ñem
->vÆ, 
k
);

129 
vÆ
 |
ﬁd
;

130 
	`¢d_˘l_ñem_vÆue_£t_öãgî
(
ñem
->
vÆ
, 
k
, val);

134 
SND_CTL_ELEM_TYPE_ENUMERATED
:

135 
k
 = 0; k < 
cou¡
; ++k) {

136 
ﬁd
, 
vÆ
, 
mask
;

137 
ﬁd
 = 
	`¢d_˘l_ñem_vÆue_gë_íumî©ed
(
ñem
->ﬁd, 
k
);

138 
mask
 = 
	`¢d_˘l_ñem_vÆue_gë_íumî©ed
(
ñem
->mask, 
k
);

139 
ﬁd
 &~
mask
;

140 i‡(
ﬁd
) {

141 
vÆ
 = 
	`¢d_˘l_ñem_vÆue_gë_íumî©ed
(
ñem
->vÆ, 
k
);

142 
vÆ
 |
ﬁd
;

143 
	`¢d_˘l_ñem_vÆue_£t_íumî©ed
(
ñem
->
vÆ
, 
k
, val);

147 
SND_CTL_ELEM_TYPE_IEC958
:

148 
cou¡
 = (
¢d_´s_õc958_t
);

150 
SND_CTL_ELEM_TYPE_BYTES
:

151 
k
 = 0; k < 
cou¡
; ++k) {

152 
ﬁd
, 
vÆ
, 
mask
;

153 
ﬁd
 = 
	`¢d_˘l_ñem_vÆue_gë_byã
(
ñem
->ﬁd, 
k
);

154 
mask
 = 
	`¢d_˘l_ñem_vÆue_gë_byã
(
ñem
->mask, 
k
);

155 
ﬁd
 &~
mask
;

156 i‡(
ﬁd
) {

157 
vÆ
 = 
	`¢d_˘l_ñem_vÆue_gë_byã
(
ñem
->vÆ, 
k
);

158 
vÆ
 |
ﬁd
;

159 
	`¢d_˘l_ñem_vÆue_£t_byã
(
ñem
->
vÆ
, 
k
, val);

164 
	`as£π
(0);

167 
îr
 = 
	`¢d_˘l_ñem_wrôe
(
h
->
˘l
, 
ñem
->
vÆ
);

168 i‡(
îr
 < 0) {

169 
	`SNDERR
("Cannot write ctlÉlem");

170  
îr
;

174 
	}
}

181 
	$¢d_s˘l_ªmove
(
¢d_s˘l_t
 *
h
)

183 
li°_hód
 *
pos
;

184 
îr
;

185 
	`as£π
(
h
);

186 
	`li°_f‹_óch
(
pos
, &
h
->
ñems
) {

187 
¢d_s˘l_ñem_t
 *
ñem
 = 
	`li°_íåy
(
pos
, snd_s˘l_ñem_t, 
li°
);

188 i‡(
ñem
->
lock
) {

189 
îr
 = 
	`¢d_˘l_ñem_u∆ock
(
h
->
˘l
, 
ñem
->
id
);

190 i‡(
îr
 < 0) {

191 
	`SNDERR
("Cannot unlock ctlÉlem");

192  
îr
;

205 i‡(
ñem
->
¥e£rve
 && 
	`¢d_˘l_ñem_vÆue_com∑ª
”Àm->
vÆ
,ÉÀm->
ﬁd
)) {

206 
îr
 = 
	`¢d_˘l_ñem_wrôe
(
h
->
˘l
, 
ñem
->
ﬁd
);

207 i‡(
îr
 < 0) {

208 
	`SNDERR
("CannotÑestore ctlÉlem");

209  
îr
;

214 
	}
}

216 
	$¢d_c⁄fig_gë_˘l_ñem_íumî©ed
(
¢d_c⁄fig_t
 *
n
, 
¢d_˘l_t
 *
˘l
,

217 
¢d_˘l_ñem_öfo_t
 *
öfo
)

219 c⁄° *
°r
;

220 
vÆ
;

221 
idx
, 
ôems
;

222 
	`¢d_c⁄fig_gë_ty≥
(
n
)) {

223 
SND_CONFIG_TYPE_INTEGER
:

224 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
vÆ
);

225  
vÆ
;

226 
SND_CONFIG_TYPE_STRING
:

227 
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
);

232 
ôems
 = 
	`¢d_˘l_ñem_öfo_gë_ôems
(
öfo
);

233 
idx
 = 0; idx < 
ôems
; idx++) {

234 
îr
;

235 
	`¢d_˘l_ñem_öfo_£t_ôem
(
öfo
, 
idx
);

236 
îr
 = 
	`¢d_˘l_ñem_öfo
(
˘l
, 
öfo
);

237 i‡(
îr
 < 0) {

238 
	`SNDERR
("Cannot obtain info for CTLÉlem");

239  
îr
;

241 i‡(
	`°rcmp
(
°r
, 
	`¢d_˘l_ñem_öfo_gë_ôem_«me
(
öfo
)) == 0)

242  
idx
;

245 
	}
}

247 
	$¢d_c⁄fig_gë_˘l_ñem_vÆue
(
¢d_c⁄fig_t
 *
c⁄f
,

248 
¢d_˘l_t
 *
˘l
,

249 
¢d_˘l_ñem_vÆue_t
 *
vÆ
,

250 
¢d_˘l_ñem_vÆue_t
 *
mask
,

251 
¢d_˘l_ñem_öfo_t
 *
öfo
)

253 
îr
;

254 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

255 
¢d_˘l_ñem_id_t
 
id
 = {0};

256 
¢d_˘l_ñem_ty≥_t
 
ty≥
;

257 
cou¡
;

258 
v
;

259 
idx
;

260 
	`¢d_˘l_ñem_vÆue_gë_id
(
vÆ
, &
id
);

261 
cou¡
 = 
	`¢d_˘l_ñem_öfo_gë_cou¡
(
öfo
);

262 
ty≥
 = 
	`¢d_˘l_ñem_öfo_gë_ty≥
(
öfo
);

263 i‡(
cou¡
 == 1) {

264 
ty≥
) {

265 
SND_CTL_ELEM_TYPE_BOOLEAN
:

266 
v
 = 
	`¢d_c⁄fig_gë_boﬁ
(
c⁄f
);

267 i‡(
v
 >= 0) {

268 
	`¢d_˘l_ñem_vÆue_£t_boﬁón
(
vÆ
, 0, 
v
);

269 i‡(
mask
)

270 
	`¢d_˘l_ñem_vÆue_£t_boﬁón
(
mask
, 0, 1);

274 
SND_CTL_ELEM_TYPE_INTEGER
:

275 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
c⁄f
, &
v
);

276 i‡(
îr
 == 0) {

277 
	`¢d_˘l_ñem_vÆue_£t_öãgî
(
vÆ
, 0, 
v
);

278 i‡(
mask
)

279 
	`¢d_˘l_ñem_vÆue_£t_öãgî
(
mask
, 0, ~0L);

283 
SND_CTL_ELEM_TYPE_ENUMERATED
:

284 
v
 = 
	`¢d_c⁄fig_gë_˘l_ñem_íumî©ed
(
c⁄f
, 
˘l
, 
öfo
);

285 i‡(
v
 >= 0) {

286 
	`¢d_˘l_ñem_vÆue_£t_íumî©ed
(
vÆ
, 0, 
v
);

287 i‡(
mask
)

288 
	`¢d_˘l_ñem_vÆue_£t_íumî©ed
(
mask
, 0, ~0);

292 
SND_CTL_ELEM_TYPE_BYTES
:

293 
SND_CTL_ELEM_TYPE_IEC958
:

296 
	`SNDERR
("Unknow¿c⁄åﬁÅy≥: %d", 
ty≥
);

297  -
EINVAL
;

300 
ty≥
) {

301 
SND_CTL_ELEM_TYPE_IEC958
:

302 
cou¡
 = (
¢d_´s_õc958_t
);

304 
SND_CTL_ELEM_TYPE_BYTES
:

306 c⁄° *
buf
;

307 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
c⁄f
, &
buf
);

308 i‡(
îr
 >= 0) {

309 
c1
 = 0;

310 
Àn
 = 
	`°æí
(
buf
);

311 
idx
 = 0;

312 i‡(
Àn
 % 2 !0 ||Üí > 
cou¡
 * 2) {

313 
_bad_c⁄ã¡
:

314 
	`SNDERR
("bad value content");

315  -
EINVAL
;

317 *
buf
) {

318 
c
 = *
buf
++;

319 i‡(
c
 >= '0' && c <= '9')

320 
c
 -= '0';

321 i‡(
c
 >= 'a' && c <= 'f')

322 
c
 = c - 'a' + 10;

323 i‡(
c
 >= 'A' && c <= 'F')

324 
c
 = c - 'A' + 10;

326 
_bad_c⁄ã¡
;

328 i‡(
idx
 % 2 == 1) {

329 
	`¢d_˘l_ñem_vÆue_£t_byã
(
vÆ
, 
idx
 / 2, 
c1
 << 4 | 
c
);

330 i‡(
mask
)

331 
	`¢d_˘l_ñem_vÆue_£t_byã
(
mask
, 
idx
 / 2, 0xff);

333 
c1
 = 
c
;

334 
idx
++;

342 i‡(
	`¢d_c⁄fig_gë_ty≥
(
c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

343 
	`SNDERR
("bad valueÅype");

344  -
EINVAL
;

347 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

348 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

349 c⁄° *
id
;

350 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

352 
îr
 = 
	`ß„_°πﬁ
(
id
, &
idx
);

353 i‡(
îr
 < 0 || 
idx
 < 0 || (Ëidx >
cou¡
) {

354 
	`SNDERR
("bad value index");

355  -
EINVAL
;

357 
ty≥
) {

358 
SND_CTL_ELEM_TYPE_BOOLEAN
:

359 
v
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

360 i‡(
v
 < 0)

361 
_bad_c⁄ã¡
;

362 
	`¢d_˘l_ñem_vÆue_£t_boﬁón
(
vÆ
, 
idx
, 
v
);

363 i‡(
mask
)

364 
	`¢d_˘l_ñem_vÆue_£t_boﬁón
(
mask
, 
idx
, 1);

366 
SND_CTL_ELEM_TYPE_INTEGER
:

367 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
v
);

368 i‡(
îr
 < 0)

369 
_bad_c⁄ã¡
;

370 
	`¢d_˘l_ñem_vÆue_£t_öãgî
(
vÆ
, 
idx
, 
v
);

371 i‡(
mask
)

372 
	`¢d_˘l_ñem_vÆue_£t_öãgî
(
mask
, 
idx
, ~0L);

374 
SND_CTL_ELEM_TYPE_ENUMERATED
:

375 
v
 = 
	`¢d_c⁄fig_gë_˘l_ñem_íumî©ed
(
n
, 
˘l
, 
öfo
);

376 i‡(
v
 < 0)

377 
_bad_c⁄ã¡
;

378 
	`¢d_˘l_ñem_vÆue_£t_íumî©ed
(
vÆ
, 
idx
, 
v
);

379 i‡(
mask
)

380 
	`¢d_˘l_ñem_vÆue_£t_íumî©ed
(
mask
, 
idx
, ~0);

382 
SND_CTL_ELEM_TYPE_BYTES
:

383 
SND_CTL_ELEM_TYPE_IEC958
:

384 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
v
);

385 i‡(
îr
 < 0 || 
v
 < 0 || v > 255)

386 
_bad_c⁄ã¡
;

387 
	`¢d_˘l_ñem_vÆue_£t_byã
(
vÆ
, 
idx
, 
v
);

388 i‡(
mask
)

389 
	`¢d_˘l_ñem_vÆue_£t_byã
(
mask
, 
idx
, 0xff);

396 
	}
}

398 
	$add_ñem
(
¢d_s˘l_t
 *
h
, 
¢d_c⁄fig_t
 *
_c⁄f
, snd_c⁄fig_à*
¥iv©e_d©a
, *
quô
)

400 
¢d_c⁄fig_t
 *
c⁄f
;

401 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

402 
iÁ˚
 = 
SND_CTL_ELEM_IFACE_MIXER
;

403 c⁄° *
«me
 = 
NULL
;

404 
ödex
 = 0;

405 
devi˚
 = -1;

406 
subdevi˚
 = -1;

407 
lock
 = 0;

408 
¥e£rve
 = 0;

409 
›ti⁄Æ
 = 0;

410 
skù_ª°
 = 0;

411 
¢d_c⁄fig_t
 *
vÆue
 = 
NULL
, *
mask
 = NULL;

412 
¢d_s˘l_ñem_t
 *
ñem
 = 
NULL
;

413 
îr
;

414 
îr
 = 
	`¢d_c⁄fig_ex∑nd
(
_c⁄f
, _c⁄f, 
NULL
, 
¥iv©e_d©a
, &
c⁄f
);

415 i‡(
îr
 < 0)

416  
îr
;

417 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

418 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

419 c⁄° *
id
;

420 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

422 i‡(
	`°rcmp
(
id
, "comment") == 0)

424 i‡(
	`°rcmp
(
id
, "iface") == 0 || strcmp(id, "interface") == 0) {

425 c⁄° *
±r
;

426 i‡((
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
±r
)) < 0) {

427 
	`SNDERR
("fõld %†i†nŸá såög", 
id
);

428 
_îr
;

430 i‡((
îr
 = 
	`¢d_c⁄fig_gë_˘l_iÁ˚_ascii
(
±r
)) < 0) {

431 
	`SNDERR
("InvÆid vÆuêf‹ '%s'", 
id
);

432 
_îr
;

434 
iÁ˚
 = 
îr
;

437 i‡(
	`°rcmp
(
id
, "name") == 0) {

438 i‡((
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
«me
)) < 0) {

439 
	`SNDERR
("fõld %†i†nŸá såög", 
id
);

440 
_îr
;

444 i‡(
	`°rcmp
(
id
, "index") == 0) {

445 i‡((
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
ödex
)) < 0) {

446 
	`SNDERR
("fõld %†i†nŸá¿öãgî", 
id
);

447 
_îr
;

451 i‡(
	`°rcmp
(
id
, "device") == 0) {

452 i‡((
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
devi˚
)) < 0) {

453 
	`SNDERR
("fõld %†i†nŸá¿öãgî", 
id
);

454 
_îr
;

458 i‡(
	`°rcmp
(
id
, "subdevice") == 0) {

459 i‡((
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
subdevi˚
)) < 0) {

460 
	`SNDERR
("fõld %†i†nŸá¿öãgî", 
id
);

461 
_îr
;

465 i‡(
	`°rcmp
(
id
, "lock") == 0) {

466 
îr
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

467 i‡(
îr
 < 0)

468 
_îr
;

469 
lock
 = 
îr
;

472 i‡(
	`°rcmp
(
id
, "preserve") == 0) {

473 
îr
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

474 i‡(
îr
 < 0)

475 
_îr
;

476 
¥e£rve
 = 
îr
;

479 i‡(
	`°rcmp
(
id
, "value") == 0) {

480 
vÆue
 = 
n
;

483 i‡(
	`°rcmp
(
id
, "mask") == 0) {

484 
mask
 = 
n
;

487 i‡(
	`°rcmp
(
id
, "optional") == 0) {

488 
îr
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

489 i‡(
îr
 < 0)

490 
_îr
;

491 
›ti⁄Æ
 = 
îr
;

494 i‡(
	`°rcmp
(
id
, "skip_rest") == 0) {

495 
îr
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

496 i‡(
îr
 < 0)

497 
_îr
;

498 
skù_ª°
 = 
îr
;

501 
	`SNDERR
("Unknow¿fõld %s", 
id
);

502  -
EINVAL
;

504 i‡(
«me
 =
NULL
) {

505 
	`SNDERR
("Missing controlÇame");

506 
îr
 = -
EINVAL
;

507 
_îr
;

509 i‡(
vÆue
 =
NULL
) {

510 
	`SNDERR
("Missing control value");

511 
îr
 = -
EINVAL
;

512 
_îr
;

514 i‡(
devi˚
 < 0)

515 
devi˚
 = 0;

516 i‡(
subdevi˚
 < 0)

517 
subdevi˚
 = 0;

518 
ñem
 = 
	`ˇŒoc
(1, (*elem));

519 i‡(!
ñem
)

520  -
ENOMEM
;

521 
îr
 = 
	`¢d_˘l_ñem_id_mÆloc
(&
ñem
->
id
);

522 i‡(
îr
 < 0)

523 
_îr
;

524 
îr
 = 
	`¢d_˘l_ñem_öfo_mÆloc
(&
ñem
->
öfo
);

525 i‡(
îr
 < 0)

526 
_îr
;

527 
îr
 = 
	`¢d_˘l_ñem_vÆue_mÆloc
(&
ñem
->
vÆ
);

528 i‡(
îr
 < 0)

529 
_îr
;

530 
îr
 = 
	`¢d_˘l_ñem_vÆue_mÆloc
(&
ñem
->
mask
);

531 i‡(
îr
 < 0)

532 
_îr
;

533 
îr
 = 
	`¢d_˘l_ñem_vÆue_mÆloc
(&
ñem
->
ﬁd
);

534 i‡(
îr
 < 0)

535 
_îr
;

536 
ñem
->
lock
 =Üock;

537 
ñem
->
¥e£rve
 =Öreserve;

538 
	`¢d_˘l_ñem_id_£t_öãrÁ˚
(
ñem
->
id
, 
iÁ˚
);

539 
	`¢d_˘l_ñem_id_£t_«me
(
ñem
->
id
, 
«me
);

540 
	`¢d_˘l_ñem_id_£t_ödex
(
ñem
->
id
, 
ödex
);

541 
	`¢d_˘l_ñem_id_£t_devi˚
(
ñem
->
id
, 
devi˚
);

542 
	`¢d_˘l_ñem_id_£t_subdevi˚
(
ñem
->
id
, 
subdevi˚
);

543 
	`¢d_˘l_ñem_öfo_£t_id
(
ñem
->
öfo
,ÉÀm->
id
);

544 
îr
 = 
	`¢d_˘l_ñem_öfo
(
h
->
˘l
, 
ñem
->
öfo
);

545 i‡(
îr
 < 0) {

546 i‡(! 
›ti⁄Æ
)

547 
	`SNDERR
("C™nŸ obèö infÿf‹ CTLÉÀm (%s,'%s',%li,%li,%li): %s", 
	`¢d_˘l_ñem_iÁ˚_«me
(
iÁ˚
), 
«me
, 
ödex
, 
devi˚
, 
subdevi˚
, 
	`¢d_°ªº‹
(
îr
));

548 
_îr
;

550 i‡(
skù_ª°
)

551 *
quô
 = 1;

553 
	`¢d_˘l_ñem_vÆue_£t_id
(
ñem
->
vÆ
,ÉÀm->
id
);

554 
	`¢d_˘l_ñem_vÆue_£t_id
(
ñem
->
ﬁd
,ÉÀm->
id
);

555 i‡(
mask
) {

556 
îr
 = 
	`¢d_c⁄fig_gë_˘l_ñem_vÆue
(
vÆue
, 
h
->
˘l
, 
ñem
->
vÆ
, 
NULL
,ÉÀm->
öfo
);

557 i‡(
îr
 < 0)

558 
_îr
;

559 
îr
 = 
	`¢d_c⁄fig_gë_˘l_ñem_vÆue
(
mask
, 
h
->
˘l
, 
ñem
->mask, 
NULL
,ÉÀm->
öfo
);

560 i‡(
îr
 < 0)

561 
_îr
;

563 
îr
 = 
	`¢d_c⁄fig_gë_˘l_ñem_vÆue
(
vÆue
, 
h
->
˘l
, 
ñem
->
vÆ
,ÉÀm->
mask
,ÉÀm->
öfo
);

564 i‡(
îr
 < 0)

565 
_îr
;

568 
îr
 = 
	`¢d_c⁄fig_gë_˘l_ñem_vÆue
(
vÆue
, 
h
->
˘l
, 
ñem
->
vÆ
,ÉÀm->
mask
,ÉÀm->
öfo
);

569 i‡(
îr
 < 0)

570 
_îr
;

571 
	`li°_add_èû
(&
ñem
->
li°
, &
h
->
ñems
);

573 
_îr
:

574 i‡(
îr
 < 0 && 
ñem
) {

575 i‡(
ñem
->
id
)

576 
	`¢d_˘l_ñem_id_‰ì
(
ñem
->
id
);

577 i‡(
ñem
->
öfo
)

578 
	`¢d_˘l_ñem_öfo_‰ì
(
ñem
->
öfo
);

579 i‡(
ñem
->
vÆ
)

580 
	`¢d_˘l_ñem_vÆue_‰ì
(
ñem
->
vÆ
);

581 i‡(
ñem
->
mask
)

582 
	`¢d_˘l_ñem_vÆue_‰ì
(
ñem
->
mask
);

583 i‡(
ñem
->
ﬁd
)

584 
	`¢d_˘l_ñem_vÆue_‰ì
(
ñem
->
ﬁd
);

585 
	`‰ì
(
ñem
);

586 i‡(
îr
 !-
ENOMEM
 && 
›ti⁄Æ
)

587 
îr
 = 0;

589 i‡(
c⁄f
)

590 
	`¢d_c⁄fig_dñëe
(
c⁄f
);

591  
îr
;

592 
	}
}

603 
	$¢d_s˘l_buûd
(
¢d_s˘l_t
 **
s˘l
, 
¢d_˘l_t
 *
h™dÀ
, 
¢d_c⁄fig_t
 *
c⁄f
, snd_c⁄fig_à*
¥iv©e_d©a
, 
mode
)

605 
¢d_s˘l_t
 *
h
;

606 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

607 
îr
, 
quô
 = 0;

609 
	`as£π
(
s˘l
);

610 
	`as£π
(
h™dÀ
);

611 
	`as£π
(
c⁄f
);

612 *
s˘l
 = 
NULL
;

613 i‡(
	`¢d_c⁄fig_gë_ty≥
(
c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
)

614  -
EINVAL
;

615 
h
 = 
	`ˇŒoc
(1, (*h));

616 i‡(!
h
) {

617 i‡(
mode
 & 
SND_SCTL_NOFREE
)

618  -
ENOMEM
;

619 
	`¢d_˘l_˛o£
(
h™dÀ
);

620  -
ENOMEM
;

622 
h
->
mode
 = mode;

623 
h
->
˘l
 = 
h™dÀ
;

624 
	`INIT_LIST_HEAD
(&
h
->
ñems
);

625 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

626 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

627 
îr
 = 
	`add_ñem
(
h
, 
n
, 
¥iv©e_d©a
, &
quô
);

628 i‡(
îr
 < 0) {

629 
	`‰ì_ñems
(
h
);

630  
îr
;

632 i‡(
quô
)

635 *
s˘l
 = 
h
;

637 
	}
}

644 
	$¢d_s˘l_‰ì
(
¢d_s˘l_t
 *
s˘l
)

646 
	`as£π
(
s˘l
);

647  
	`‰ì_ñems
(
s˘l
);

648 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/tlv.c

29 
	~"c⁄åﬁ_loˇl.h
"

30 
	~<°dio.h
>

31 
	~<°dlib.h
>

32 
	~<uni°d.h
>

33 
	~<°rög.h
>

34 #i‚de‡
HAVE_SOFT_FLOAT


35 
	~<m©h.h
>

38 #i‚de‡
DOC_HIDDEN


40 
	#öt_ödex
(
size
Ë(((sizeË+ (Ë- 1Ë/ ())

	)

42 
	#MAX_TLV_RANGE_SIZE
 256

	)

59 
	$¢d_év_∑r£_dB_öfo
(*
év
,

60 
év_size
,

61 **
db_évp
)

63 
ty≥
;

64 
size
;

65 
îr
;

67 *
db_évp
 = 
NULL
;

68 
ty≥
 = 
év
[
SNDRV_CTL_TLVO_TYPE
];

69 
size
 = 
év
[
SNDRV_CTL_TLVO_LEN
];

70 
év_size
 -= 2 * ();

71 i‡(
size
 > 
év_size
) {

72 
	`SNDERR
("TLV sizeÉrror");

73  -
EINVAL
;

75 
ty≥
) {

76 
SND_CTL_TLVT_CONTAINER
:

77 
size
 = 
	`öt_ödex
(size) * ();

78 
év
 += 2;

79 
size
 > 0) {

80 
Àn
;

81 
îr
 = 
	`¢d_év_∑r£_dB_öfo
(
év
, 
size
, 
db_évp
);

82 i‡(
îr
 < 0)

83  
îr
;

84 i‡(
îr
 > 0)

85  
îr
;

86 
Àn
 = 
	`öt_ödex
(
év
[
SNDRV_CTL_TLVO_LEN
]) + 2;

87 
size
 -
Àn
 * ();

88 
év
 +
Àn
;

91 
SND_CTL_TLVT_DB_SCALE
:

92 
SND_CTL_TLVT_DB_MINMAX
:

93 
SND_CTL_TLVT_DB_MINMAX_MUTE
:

94 #i‚de‡
HAVE_SOFT_FLOAT


95 
SND_CTL_TLVT_DB_LINEAR
:

97 
SND_CTL_TLVT_DB_RANGE
: {

98 
mösize
;

99 i‡(
ty≥
 =
SND_CTL_TLVT_DB_RANGE
)

100 
mösize
 = 4 * ();

102 
mösize
 = 2 * ();

103 i‡(
size
 < 
mösize
) {

104 
	`SNDERR
("Invalid dB_scale TLV size");

105  -
EINVAL
;

107 i‡(
size
 > 
MAX_TLV_RANGE_SIZE
) {

108 
	`SNDERR
("Toÿbig dB_sˇÀ TLV size: %d", 
size
);

109  -
EINVAL
;

111 *
db_évp
 = 
év
;

112  
size
 + () * 2;

117  -
EINVAL
;

118 
	}
}

129 
	$¢d_év_gë_dB_ønge
(*
év
, 
øngemö
, 
øngemax
,

130 *
mö
, *
max
)

132 
îr
;

134 
év
[
SNDRV_CTL_TLVO_TYPE
]) {

135 
SND_CTL_TLVT_DB_RANGE
: {

136 
pos
, 
Àn
;

137 
Àn
 = 
	`öt_ödex
(
év
[
SNDRV_CTL_TLVO_LEN
]);

138 i‡(
Àn
 > 
MAX_TLV_RANGE_SIZE
)

139  -
EINVAL
;

140 
pos
 = 2;

141 
pos
 + 4 <
Àn
) {

142 
rmö
, 
rmax
;

143 
submö
, 
submax
;

144 
submö
 = ()
év
[
pos
];

145 
submax
 = ()
év
[
pos
 + 1];

146 i‡(
øngemax
 < 
submax
)

147 
submax
 = 
øngemax
;

148 
îr
 = 
	`¢d_év_gë_dB_ønge
(
év
 + 
pos
 + 2,

149 
submö
, 
submax
,

150 &
rmö
, &
rmax
);

151 i‡(
îr
 < 0)

152  
îr
;

153 i‡(
pos
 > 2) {

154 i‡(
rmö
 < *
mö
)

155 *
mö
 = 
rmö
;

156 i‡(
rmax
 > *
max
)

157 *
max
 = 
rmax
;

159 *
mö
 = 
rmö
;

160 *
max
 = 
rmax
;

162 i‡(
øngemax
 =
submax
)

164 
pos
 +
	`öt_ödex
(
év
[pos + 3]) + 4;

168 
SND_CTL_TLVT_DB_SCALE
: {

169 
°ï
;

170 i‡(
év
[
SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
] & 0x10000)

171 *
mö
 = 
SND_CTL_TLV_DB_GAIN_MUTE
;

173 *
mö
 = ()
év
[
SNDRV_CTL_TLVO_DB_SCALE_MIN
];

174 
°ï
 = (
év
[
SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
] & 0xffff);

175 *
max
 = ()
év
[
SNDRV_CTL_TLVO_DB_SCALE_MIN
] +

176 
°ï
 * (
øngemax
 - 
øngemö
);

179 
SND_CTL_TLVT_DB_MINMAX
:

180 
SND_CTL_TLVT_DB_LINEAR
:

181 *
mö
 = ()
év
[
SNDRV_CTL_TLVO_DB_LINEAR_MIN
];

182 *
max
 = ()
év
[
SNDRV_CTL_TLVO_DB_LINEAR_MAX
];

184 
SND_CTL_TLVT_DB_MINMAX_MUTE
:

185 *
mö
 = 
SND_CTL_TLV_DB_GAIN_MUTE
;

186 *
max
 = ()
év
[
SNDRV_CTL_TLVO_DB_MINMAX_MAX
];

189  -
EINVAL
;

190 
	}
}

201 
	$¢d_év_c⁄vît_to_dB
(*
év
, 
øngemö
, 
øngemax
,

202 
vﬁume
, *
db_gaö
)

204 
ty≥
 = 
év
[
SNDRV_CTL_TLVO_TYPE
];

206 
ty≥
) {

207 
SND_CTL_TLVT_DB_RANGE
: {

208 
pos
, 
Àn
;

209 
Àn
 = 
	`öt_ödex
(
év
[
SNDRV_CTL_TLVO_LEN
]);

210 i‡(
Àn
 > 
MAX_TLV_RANGE_SIZE
)

211  -
EINVAL
;

212 
pos
 = 2;

213 
pos
 + 4 <
Àn
) {

214 
øngemö
 = ()
év
[
pos
];

215 
øngemax
 = ()
év
[
pos
 + 1];

216 i‡(
vﬁume
 >
øngemö
 && vﬁumê<
øngemax
)

217  
	`¢d_év_c⁄vît_to_dB
(
év
 + 
pos
 + 2,

218 
øngemö
, 
øngemax
,

219 
vﬁume
, 
db_gaö
);

220 
pos
 +
	`öt_ödex
(
év
[pos + 3]) + 4;

222  -
EINVAL
;

224 
SND_CTL_TLVT_DB_SCALE
: {

225 
mö
, 
°ï
, 
muã
;

226 
mö
 = 
év
[
SNDRV_CTL_TLVO_DB_SCALE_MIN
];

227 
°ï
 = (
év
[
SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
] & 0xffff);

228 
muã
 = (
év
[
SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
] >> 16) & 1;

229 i‡(
muã
 && 
vﬁume
 <
øngemö
)

230 *
db_gaö
 = 
SND_CTL_TLV_DB_GAIN_MUTE
;

232 *
db_gaö
 = (
vﬁume
 - 
øngemö
Ë* 
°ï
 + 
mö
;

235 
SND_CTL_TLVT_DB_MINMAX
:

236 
SND_CTL_TLVT_DB_MINMAX_MUTE
: {

237 
mödb
, 
maxdb
;

238 
mödb
 = 
év
[
SNDRV_CTL_TLVO_DB_MINMAX_MIN
];

239 
maxdb
 = 
év
[
SNDRV_CTL_TLVO_DB_MINMAX_MAX
];

240 i‡(
vﬁume
 <
øngemö
 || 
øngemax
 <=Ñangemin) {

241 i‡(
ty≥
 =
SND_CTL_TLVT_DB_MINMAX_MUTE
)

242 *
db_gaö
 = 
SND_CTL_TLV_DB_GAIN_MUTE
;

244 *
db_gaö
 = 
mödb
;

245 } i‡(
vﬁume
 >
øngemax
)

246 *
db_gaö
 = 
maxdb
;

248 *
db_gaö
 = (
maxdb
 - 
mödb
Ë* (
vﬁume
 - 
øngemö
) /

249 (
øngemax
 - 
øngemö
Ë+ 
mödb
;

252 #i‚de‡
HAVE_SOFT_FLOAT


253 
SND_CTL_TLVT_DB_LINEAR
: {

254 
mödb
 = 
év
[
SNDRV_CTL_TLVO_DB_LINEAR_MIN
];

255 
maxdb
 = 
év
[
SNDRV_CTL_TLVO_DB_LINEAR_MAX
];

256 i‡(
vﬁume
 <
øngemö
 || 
øngemax
 <=Ñangemin)

257 *
db_gaö
 = 
mödb
;

258 i‡(
vﬁume
 >
øngemax
)

259 *
db_gaö
 = 
maxdb
;

261 
vÆ
 = ()(
vﬁume
 - 
øngemö
) /

262 ()(
øngemax
 - 
øngemö
);

263 i‡(
mödb
 <
SND_CTL_TLV_DB_GAIN_MUTE
)

264 *
db_gaö
 = ()(100.0 * 20.0 * 
	`log10
(
vÆ
)) +

265 
maxdb
;

268 
lmö
 = 
	`pow
(10.0, 
mödb
/2000.0);

269 
lmax
 = 
	`pow
(10.0, 
maxdb
/2000.0);

270 
vÆ
 = (
lmax
 - 
lmö
) * val +Ümin;

271 *
db_gaö
 = ()(100.0 * 20.0 * 
	`log10
(
vÆ
));

278  -
EINVAL
;

279 
	}
}

293 
	$¢d_év_c⁄vît_‰om_dB
(*
év
, 
øngemö
, 
øngemax
,

294 
db_gaö
, *
vÆue
, 
xdú
)

296 
ty≥
 = 
év
[
SNDRV_CTL_TLVO_TYPE
];

298 
ty≥
) {

299 
SND_CTL_TLVT_DB_RANGE
: {

300 
dbmö
, 
dbmax
, 
¥ev_submax
;

301 
pos
, 
Àn
;

302 
Àn
 = 
	`öt_ödex
(
év
[
SNDRV_CTL_TLVO_LEN
]);

303 i‡(
Àn
 < 6 ||Üí > 
MAX_TLV_RANGE_SIZE
)

304  -
EINVAL
;

305 
pos
 = 2;

306 
¥ev_submax
 = 0;

307 
pos
 + 4 <
Àn
) {

308 
submö
, 
submax
;

309 
submö
 = ()
év
[
pos
];

310 
submax
 = ()
év
[
pos
 + 1];

311 i‡(
øngemax
 < 
submax
)

312 
submax
 = 
øngemax
;

313 i‡(!
	`¢d_év_gë_dB_ønge
(
év
 + 
pos
 + 2,

314 
submö
, 
submax
,

315 &
dbmö
, &
dbmax
) &&

316 
db_gaö
 >
dbmö
 && db_gaö <
dbmax
)

317  
	`¢d_év_c⁄vît_‰om_dB
(
év
 + 
pos
 + 2,

318 
submö
, 
submax
,

319 
db_gaö
, 
vÆue
, 
xdú
);

320 i‡(
db_gaö
 < 
dbmö
) {

321 *
vÆue
 = 
xdú
 > 0 || 
pos
 =2 ? 
submö
 : 
¥ev_submax
;

324 
¥ev_submax
 = 
submax
;

325 i‡(
øngemax
 =
submax
)

327 
pos
 +
	`öt_ödex
(
év
[pos + 3]) + 4;

329 *
vÆue
 = 
¥ev_submax
;

332 
SND_CTL_TLVT_DB_SCALE
: {

333 
mö
, 
°ï
, 
max
, 
muã
;

334 
mö
 = 
év
[
SNDRV_CTL_TLVO_DB_SCALE_MIN
];

335 
°ï
 = 
év
[
SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
] & 0xffff;

336 
muã
 = 
év
[
SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
] & 0x10000;

337 
max
 = 
mö
 + ()(
°ï
 * (
øngemax
 - 
øngemö
));

338 i‡(
db_gaö
 <
mö
)

339 i‡(
db_gaö
 > 
SND_CTL_TLV_DB_GAIN_MUTE
 && 
xdú
 > 0 &&

340 
muã
)

341 *
vÆue
 = 
øngemö
 + 1;

343 *
vÆue
 = 
øngemö
;

344 i‡(
db_gaö
 >
max
)

345 *
vÆue
 = 
øngemax
;

347 
v
 = (
db_gaö
 - 
mö
Ë* (
øngemax
 - 
øngemö
);

348 i‡(
xdú
 > 0)

349 
v
 +(
max
 - 
mö
) - 1;

350 i‡(
xdú
 == 0)

351 
v
 +((
max
 - 
mö
) + 1) / 2;

352 
v
 = v / (
max
 - 
mö
Ë+ 
øngemö
;

353 *
vÆue
 = 
v
;

357 
SND_CTL_TLVT_DB_MINMAX
:

358 
SND_CTL_TLVT_DB_MINMAX_MUTE
: {

359 
mö
, 
max
;

360 
mö
 = 
év
[
SNDRV_CTL_TLVO_DB_MINMAX_MIN
];

361 
max
 = 
év
[
SNDRV_CTL_TLVO_DB_MINMAX_MAX
];

362 i‡(
db_gaö
 <
mö
)

363 i‡(
db_gaö
 > 
SND_CTL_TLV_DB_GAIN_MUTE
 && 
xdú
 > 0 &&

364 
ty≥
 =
SND_CTL_TLVT_DB_MINMAX_MUTE
)

365 *
vÆue
 = 
øngemö
 + 1;

367 *
vÆue
 = 
øngemö
;

368 i‡(
db_gaö
 >
max
)

369 *
vÆue
 = 
øngemax
;

371 
v
 = (
db_gaö
 - 
mö
Ë* (
øngemax
 - 
øngemö
);

372 i‡(
xdú
 > 0)

373 
v
 +(
max
 - 
mö
) - 1;

374 i‡(
xdú
 == 0)

375 
v
 +((
max
 - 
mö
) + 1) / 2;

376 
v
 = v / (
max
 - 
mö
Ë+ 
øngemö
;

377 *
vÆue
 = 
v
;

381 #i‚de‡
HAVE_SOFT_FLOAT


382 
SND_CTL_TLVT_DB_LINEAR
: {

383 
mö
, 
max
;

384 
mö
 = 
év
[
SNDRV_CTL_TLVO_DB_LINEAR_MIN
];

385 
max
 = 
év
[
SNDRV_CTL_TLVO_DB_LINEAR_MAX
];

386 i‡(
db_gaö
 <
mö
)

387 *
vÆue
 = 
øngemö
;

388 i‡(
db_gaö
 >
max
)

389 *
vÆue
 = 
øngemax
;

392 
vmö
, 
vmax
, 
v
;

393 
vmö
 = (
mö
 <
SND_CTL_TLV_DB_GAIN_MUTE
) ? 0.0 :

394 
	`pow
(10.0, ()
mö
 / 2000.0);

395 
vmax
 = !
max
 ? 1.0 : 
	`pow
(10.0, ()max / 2000.0);

396 
v
 = 
	`pow
(10.0, ()
db_gaö
 / 2000.0);

397 
v
 = (v - 
vmö
Ë* (
øngemax
 - 
øngemö
Ë/ (
vmax
 - vmin);

398 i‡(
xdú
 > 0)

399 
v
 = 
	`˚û
(v);

400 i‡(
xdú
 == 0)

401 
v
 = 
	`Ãöt
(v);

402 *
vÆue
 = ()
v
 + 
øngemö
;

410  -
EINVAL
;

411 
	}
}

413 #i‚de‡
DOC_HIDDEN


414 
	#TEMP_TLV_SIZE
 4096

	)

415 
	sév_öfo
 {

416 
	mmövÆ
, 
	mmaxvÆ
;

417 *
	mév
;

418 
	mbuf
[
TEMP_TLV_SIZE
];

422 
	$gë_év_öfo
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

423 
év_öfo
 *
ªc
)

425 
¢d_˘l_ñem_öfo_t
 
öfo
 = {0};

426 
îr
;

428 
	`¢d_˘l_ñem_öfo_£t_id
(&
öfo
, 
id
);

429 
îr
 = 
	`¢d_˘l_ñem_öfo
(
˘l
, &
öfo
);

430 i‡(
îr
 < 0)

431  
îr
;

432 i‡(!
	`¢d_˘l_ñem_öfo_is_év_ªadabÀ
(&
öfo
))

433  -
EINVAL
;

434 i‡(
	`¢d_˘l_ñem_öfo_gë_ty≥
(&
öfo
Ë!
SND_CTL_ELEM_TYPE_INTEGER
)

435  -
EINVAL
;

436 
ªc
->
mövÆ
 = 
	`¢d_˘l_ñem_öfo_gë_mö
(&
öfo
);

437 
ªc
->
maxvÆ
 = 
	`¢d_˘l_ñem_öfo_gë_max
(&
öfo
);

438 
îr
 = 
	`¢d_˘l_ñem_év_ªad
(
˘l
, 
id
, 
ªc
->
buf
, (rec->buf));

439 i‡(
îr
 < 0)

440  
îr
;

441 
îr
 = 
	`¢d_év_∑r£_dB_öfo
(
ªc
->
buf
, ‘ec->buf), &ªc->
év
);

442 i‡(
îr
 < 0)

443  
îr
;

445 
	}
}

455 
	$¢d_˘l_gë_dB_ønge
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

456 *
mö
, *
max
)

458 
év_öfo
 
öfo
;

459 
îr
;

461 
îr
 = 
	`gë_év_öfo
(
˘l
, 
id
, &
öfo
);

462 i‡(
îr
 < 0)

463  
îr
;

464  
	`¢d_év_gë_dB_ønge
(
öfo
.
év
, info.
mövÆ
, info.
maxvÆ
,

465 
mö
, 
max
);

466 
	}
}

476 
	$¢d_˘l_c⁄vît_to_dB
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

477 
vﬁume
, *
db_gaö
)

479 
év_öfo
 
öfo
;

480 
îr
;

482 
îr
 = 
	`gë_év_öfo
(
˘l
, 
id
, &
öfo
);

483 i‡(
îr
 < 0)

484  
îr
;

485  
	`¢d_év_c⁄vît_to_dB
(
öfo
.
év
, info.
mövÆ
, info.
maxvÆ
,

486 
vﬁume
, 
db_gaö
);

487 
	}
}

499 
	$¢d_˘l_c⁄vît_‰om_dB
(
¢d_˘l_t
 *
˘l
, c⁄° 
¢d_˘l_ñem_id_t
 *
id
,

500 
db_gaö
, *
vÆue
, 
xdú
)

502 
év_öfo
 
öfo
;

503 
îr
;

505 
îr
 = 
	`gë_év_öfo
(
˘l
, 
id
, &
öfo
);

506 i‡(
îr
 < 0)

507  
îr
;

508  
	`¢d_év_c⁄vît_‰om_dB
(
öfo
.
év
, info.
mövÆ
, info.
maxvÆ
,

509 
db_gaö
, 
vÆue
, 
xdú
);

510 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/dlmisc.c

30 
	~"loˇl.h
"

31 
	~"li°.h
"

32 #ifde‡
HAVE_LIBPTHREAD


33 
	~<±hªad.h
>

35 
	~<limôs.h
>

37 #i‡
deföed
(
HAVE_LIBDL
Ë&& deföed(
__GLIBC__
Ë&& !deföed(
__UCLIBC__
)

38 
	#DL_ORIGIN_AVAILABLE
 1

	)

41 #i‚de‡
DOC_HIDDEN


42 #i‚de‡
PIC


43 
¢d_dlsym_lök
 *
	g¢d_dlsym_°¨t
 = 
NULL
;

45 
	g¢d_∂ugö_dú_£t
 = 0;

46 *
	g¢d_∂ugö_dú
 = 
NULL
;

49 #ifde‡
HAVE_LIBPTHREAD


50 
±hªad_muãx_t
 
	g¢d_dÕ©h_muãx
 = 
PTHREAD_MUTEX_INITIALIZER
;

52 
ölöe
 
	$¢d_dÕ©h_lock
()

54 
	`±hªad_muãx_lock
(&
¢d_dÕ©h_muãx
);

55 
	}
}

57 
ölöe
 
	$¢d_dÕ©h_u∆ock
()

59 
	`±hªad_muãx_u∆ock
(&
¢d_dÕ©h_muãx
);

60 
	}
}

62 
ölöe
 
	$¢d_dÕ©h_lock
(Ë{
	}
}

63 
ölöe
 
	$¢d_dÕ©h_u∆ock
(Ë{
	}
}

66 
	$¢d_dlöfo_‹igö
(*
∑th
, 
size_t
 
∑th_Àn
)

68 #ifde‡
DL_ORIGIN_AVAILABLE


69 
lök_m≠
 *
löks
;

70 
Dl_öfo
 
öfo
;

71 
‹igö
[
PATH_MAX
];

72 i‡(
	`dœddr1
(&
¢d_dÕ©h
, &
öfo
, (**)&
löks
, 
RTLD_DL_LINKMAP
) == 0)

74 i‡(
	`dlöfo
(
löks
, 
RTLD_DI_ORIGIN
, 
‹igö
))

76 
	`¢¥ötf
(
∑th
, 
∑th_Àn
, "%s/Æß-lib", 
‹igö
);

77 i‡(
	`ac˚ss
(
∑th
, 
X_OK
) == 0)

78 
¢d_∂ugö_dú
 = 
	`°rdup
(
∑th
);

80 
	}
}

90 
	$¢d_dÕ©h
(*
∑th
, 
size_t
 
∑th_Àn
, c⁄° *
«me
)

92 
	`¢d_dÕ©h_lock
();

93 i‡(!
¢d_∂ugö_dú_£t
) {

94 c⁄° *
ív
 = 
	`gëív
("ALSA_PLUGIN_DIR");

95 i‡(
ív
) {

96 
¢d_∂ugö_dú
 = 
	`°rdup
(
ív
);

98 
	`¢d_dlöfo_‹igö
(
∑th
, 
∑th_Àn
);

100 
¢d_∂ugö_dú_£t
 = 1;

102 
	`¢¥ötf
(
∑th
, 
∑th_Àn
, "%s/%s",

103 
¢d_∂ugö_dú
 ? snd_∂ugö_dú : 
ALSA_PLUGIN_DIR
, 
«me
);

104 
	`¢d_dÕ©h_u∆ock
();

106 
	}
}

119 #i‚de‡
DOXYGEN


120 
EXPORT_SYMBOL
 *
	$INTERNAL
(
¢d_dl›í
)(c⁄° *
«me
, 
mode
, *
îrbuf
, 
size_t
 
îrbuÊí
)

122 *
	$¢d_dl›í
(c⁄° *
«me
, 
mode
, *
îrbuf
, 
size_t
 
îrbuÊí
)

125 #i‚de‡
PIC


126 i‡(
«me
 =
NULL
)

127  &
¢d_dlsym_°¨t
;

129 #ifde‡
HAVE_LIBDL


130 i‡(
«me
 =
NULL
) {

131 c⁄° * 
£lf
 = 
NULL
;

132 i‡(
£lf
 =
NULL
) {

133 
Dl_öfo
 
dlöfo
;

134 i‡(
	`dœddr
(
¢d_dl›í
, &
dlöfo
) > 0)

135 
£lf
 = 
dlöfo
.
dli_‚ame
;

137 
«me
 = 
£lf
;

141 #ifde‡
HAVE_LIBDL


147 *
h™dÀ
 = 
NULL
;

148 c⁄° *
fûíame
 = 
«me
;

149 
∑th
[
PATH_MAX
];

151 i‡(
«me
 &&Çame[0] != '/') {

152 i‡(
	`¢d_dÕ©h
(
∑th
, ’©h), 
«me
) == 0)

153 
fûíame
 = 
∑th
;

155 
h™dÀ
 = 
	`dl›í
(
fûíame
, 
mode
);

156 i‡(!
h™dÀ
)

157 
îΩ©h
;

158  
h™dÀ
;

159 
îΩ©h
:

160 i‡(
îrbuf
)

161 
	`¢¥ötf
(
îrbuf
, 
îrbuÊí
, "%s", 
	`dÀº‹
());

163  
NULL
;

164 
	}
}

166 #i‚de‡
DOXYGEN


167 
EXPORT_SYMBOL
 *
	$INTERNAL
(
¢d_dl›í_ﬁd
)(c⁄° *
«me
, 
mode
)

169  
	`INTERNAL
(
¢d_dl›í
)(
«me
, 
mode
, 
NULL
, 0);

170 
	}
}

173 #i‚de‡
DOC_HIDDEN


174 
u£_symbﬁ_vîsi⁄
(
__¢d_dl›í_ﬁd
, 
¢d_dl›í
, 
ALSA_0
.9);

175 
u£_deÁu…_symbﬁ_vîsi⁄
(
__¢d_dl›í
, 
¢d_dl›í
, 
ALSA_1
.1.6);

186 
	$¢d_dl˛o£
(*
h™dÀ
)

188 #i‚de‡
PIC


189 i‡(
h™dÀ
 =&
¢d_dlsym_°¨t
)

192 #ifde‡
HAVE_LIBDL


193  
	`dl˛o£
(
h™dÀ
);

197 
	}
}

209 
	$¢d_dlsym_vîify
(*
h™dÀ
, c⁄° *
«me
, c⁄° *
vîsi⁄
)

211 #ifde‡
HAVE_LIBDL


212 
ªs
;

213 *
v«me
;

215 i‡(
h™dÀ
 =
NULL
)

216  -
EINVAL
;

217 
v«me
 = 
	`Æloˇ
(1 + 
	`°æí
(
«me
Ë+ såÀn(
vîsi⁄
) + 1);

218 i‡(
v«me
 =
NULL
)

219  -
ENOMEM
;

220 
v«me
[0] = '_';

221 
	`°r˝y
(
v«me
 + 1, 
«me
);

222 
	`°rˇt
(
v«me
, 
vîsi⁄
);

223 
ªs
 = 
	`dlsym
(
h™dÀ
, 
v«me
Ë=
NULL
 ? -
ENOENT
 : 0;

225 i‡(
ªs
 < 0)

226 
	`SNDERR
("u«bÀÅÿvîify vîsi⁄ f‹ symbﬁ %s", 
«me
);

227  
ªs
;

231 
	}
}

246 *
	$¢d_dlsym
(*
h™dÀ
, c⁄° *
«me
, c⁄° *
vîsi⁄
)

248 
îr
;

250 #i‚de‡
PIC


251 i‡(
h™dÀ
 =&
¢d_dlsym_°¨t
) {

254 
¢d_dlsym_lök
 *
lök
 = 
¢d_dlsym_°¨t
;

255 
lök
) {

256 i‡(!
	`°rcmp
(
«me
, 
lök
->
dlsym_«me
))

257  (*)
lök
->
dlsym_±r
;

258 
lök
 =Üök->
√xt
;

260  
NULL
;

263 #ifde‡
HAVE_LIBDL


264 #ifde‡
VERSIONED_SYMBOLS


265 i‡(
vîsi⁄
) {

266 
îr
 = 
	`¢d_dlsym_vîify
(
h™dÀ
, 
«me
, 
vîsi⁄
);

267 i‡(
îr
 < 0)

268  
NULL
;

271  
	`dlsym
(
h™dÀ
, 
«me
);

273  
NULL
;

275 
	}
}

281 #i‚de‡
DOC_HIDDEN


282 
	sdlobj_ˇche
 {

283 c⁄° *
	mlib
;

284 c⁄° *
	m«me
;

285 *
	mdlobj
;

286 *
	mfunc
;

287 
	mªf˙t
;

288 
li°_hód
 
	mli°
;

291 #ifde‡
HAVE_LIBPTHREAD


292 
±hªad_muãx_t
 
	g¢d_dlobj_muãx
 = 
PTHREAD_MUTEX_INITIALIZER
;

294 
ölöe
 
	$¢d_dlobj_lock
()

296 
	`±hªad_muãx_lock
(&
¢d_dlobj_muãx
);

297 
	}
}

299 
ölöe
 
	$¢d_dlobj_u∆ock
()

301 
	`±hªad_muãx_u∆ock
(&
¢d_dlobj_muãx
);

302 
	}
}

304 
ölöe
 
	$¢d_dlobj_lock
(Ë{
	}
}

305 
ölöe
 
	$¢d_dlobj_u∆ock
(Ë{
	}
}

308 
LIST_HEAD
(
pcm_dlobj_li°
);

310 
dlobj_ˇche
 *

311 
	$¢d_dlobj_ˇche_gë0
(c⁄° *
lib
, c⁄° *
«me
,

312 c⁄° *
vîsi⁄
, 
vîbo£
)

314 
li°_hód
 *
p
;

315 
dlobj_ˇche
 *
c
;

316 *
func
, *
dlobj
;

317 
îrbuf
[256];

319 
	`li°_f‹_óch
(
p
, &
pcm_dlobj_li°
) {

320 
c
 = 
	`li°_íåy
(
p
, 
dlobj_ˇche
, 
li°
);

321 i‡(
c
->
lib
 &&Üib && 
	`°rcmp
(c->lib,Üib) != 0)

323 i‡(!
c
->
lib
 &&Üib)

325 i‡(!
lib
 && 
c
->lib)

327 i‡(
	`°rcmp
(
c
->
«me
,Çame) == 0) {

328 
c
->
ªf˙t
++;

329  
c
;

333 
îrbuf
[0] = '\0';

334 
dlobj
 = 
	`INTERNAL
(
¢d_dl›í
)(
lib
, 
RTLD_NOW
,

335 
vîbo£
 ? 
îrbuf
 : 0,

336 
vîbo£
 ? (
îrbuf
) : 0);

337 i‡(
dlobj
 =
NULL
) {

338 i‡(
vîbo£
)

339 
	`SNDERR
("Cannot open sharedÜibrary %s (%s)",

340 
lib
 ?Üib : "[builtin]",

341 
îrbuf
);

342  
NULL
;

345 
func
 = 
	`¢d_dlsym
(
dlobj
, 
«me
, 
vîsi⁄
);

346 i‡(
func
 =
NULL
) {

347 i‡(
vîbo£
)

348 
	`SNDERR
("symbol %s isÇot defined inside %s",

349 
«me
, 
lib
 ?Üib : "[builtin]");

350 
__îr
;

352 
c
 = 
	`mÆloc
((*c));

353 i‡(! 
c
)

354 
__îr
;

355 
c
->
ªf˙t
 = 1;

356 
c
->
lib
 =Üib ? 
	`°rdup
÷ibË: 
NULL
;

357 
c
->
«me
 = 
	`°rdup
(name);

358 i‡((
lib
 && ! 
c
->libË|| ! c->
«me
) {

359 
	`‰ì
((*)
c
->
«me
);

360 
	`‰ì
((*)
c
->
lib
);

361 
	`‰ì
(
c
);

362 
__îr
:

363 
	`¢d_dl˛o£
(
dlobj
);

364  
NULL
;

366 
c
->
dlobj
 = dlobj;

367 
c
->
func
 = func;

368 
	`li°_add_èû
(&
c
->
li°
, &
pcm_dlobj_li°
);

369  
c
;

370 
	}
}

372 *
	$¢d_dlobj_ˇche_gë
(c⁄° *
lib
, c⁄° *
«me
,

373 c⁄° *
vîsi⁄
, 
vîbo£
)

375 
dlobj_ˇche
 *
c
;

376 *
func
 = 
NULL
;

378 
	`¢d_dlobj_lock
();

379 
c
 = 
	`¢d_dlobj_ˇche_gë0
(
lib
, 
«me
, 
vîsi⁄
, 
vîbo£
);

380 i‡(
c
)

381 
func
 = 
c
->func;

382 
	`¢d_dlobj_u∆ock
();

383  
func
;

384 
	}
}

386 *
	$¢d_dlobj_ˇche_gë2
(c⁄° *
lib
, c⁄° *
«me
,

387 c⁄° *
vîsi⁄
, 
vîbo£
)

389 
dlobj_ˇche
 *
c
;

390 *
func
 = 
NULL
;

392 
	`¢d_dlobj_lock
();

393 
c
 = 
	`¢d_dlobj_ˇche_gë0
(
lib
, 
«me
, 
vîsi⁄
, 
vîbo£
);

394 i‡(
c
) {

395 
func
 = 
c
->func;

397 
c
->
ªf˙t
++;

399 
	`¢d_dlobj_u∆ock
();

400  
func
;

401 
	}
}

403 
	$¢d_dlobj_ˇche_put
(*
func
)

405 
li°_hód
 *
p
;

406 
dlobj_ˇche
 *
c
;

407 
ªf˙t
;

409 i‡(!
func
)

410  -
ENOENT
;

412 
	`¢d_dlobj_lock
();

413 
	`li°_f‹_óch
(
p
, &
pcm_dlobj_li°
) {

414 
c
 = 
	`li°_íåy
(
p
, 
dlobj_ˇche
, 
li°
);

415 i‡(
c
->
func
 == func) {

416 
ªf˙t
 = 
c
->refcnt;

417 i‡(
c
->
ªf˙t
 > 0)

418 
c
->
ªf˙t
--;

419 
	`¢d_dlobj_u∆ock
();

420  
ªf˙t
 =1 ? 0 : -
EINVAL
;

423 
	`¢d_dlobj_u∆ock
();

424  -
ENOENT
;

425 
	}
}

427 
	$¢d_dlobj_ˇche_˛ónup
()

429 
li°_hód
 *
p
, *
≈os
;

430 
dlobj_ˇche
 *
c
;

432 
	`¢d_dlobj_lock
();

433 
	`li°_f‹_óch_ß„
(
p
, 
≈os
, &
pcm_dlobj_li°
) {

434 
c
 = 
	`li°_íåy
(
p
, 
dlobj_ˇche
, 
li°
);

435 i‡(
c
->
ªf˙t
)

437 
	`li°_dñ
(
p
);

438 
	`¢d_dl˛o£
(
c
->
dlobj
);

439 
	`‰ì
((*)
c
->
«me
);

440 
	`‰ì
((*)
c
->
lib
);

441 
	`‰ì
(
c
);

443 
	`¢d_dlobj_u∆ock
();

444 
	`¢d_dÕ©h_lock
();

445 
¢d_∂ugö_dú_£t
 = 0;

446 
	`‰ì
(
¢d_∂ugö_dú
);

447 
¢d_∂ugö_dú
 = 
NULL
;

448 
	`¢d_dÕ©h_u∆ock
();

449 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/error.c

31 
	~"loˇl.h
"

32 
	~<°dio.h
>

33 
	~<°dlib.h
>

34 
	~<°d¨g.h
>

35 
	~<°rög.h
>

40 c⁄° *
	g¢d_îr‹_codes
[] =

51 c⁄° *
	$¢d_°ªº‹
(
î∫um
)

53 i‡(
î∫um
 < 0)

54 
î∫um
 = -errnum;

55 i‡(
î∫um
 < 
SND_ERROR_BEGIN
)

56  (c⁄° *Ë
	`°ªº‹
(
î∫um
);

57 
î∫um
 -
SND_ERROR_BEGIN
;

58 i‡((Ë
î∫um
 >(
¢d_îr‹_codes
) / (const *))

60  
¢d_îr‹_codes
[
î∫um
];

61 
	}
}

63 #i‚de‡
DOC_HIDDEN


64 #ifde‡
HAVE___THREAD


65 
	#TLS_PFX
 
__thªad


	)

67 
	#TLS_PFX


	)

71 
TLS_PFX
 
¢d_loˇl_îr‹_h™dÀr_t
 
	gloˇl_îr‹
 = 
NULL
;

78 
¢d_loˇl_îr‹_h™dÀr_t
 
	$¢d_lib_îr‹_£t_loˇl
(
¢d_loˇl_îr‹_h™dÀr_t
 
func
)

80 
¢d_loˇl_îr‹_h™dÀr_t
 
ﬁd
 = 
loˇl_îr‹
;

81 
loˇl_îr‹
 = 
func
;

82  
ﬁd
;

83 
	}
}

98 
	$¢d_lib_îr‹_deÁu…
(c⁄° *
fûe
, 
löe
, c⁄° *
fun˘i⁄
, 
îr
, c⁄° *
fmt
, ...)

100 
va_li°
 
¨g
;

101 
	`va_°¨t
(
¨g
, 
fmt
);

102 i‡(
loˇl_îr‹
) {

103 
	`loˇl_îr‹
(
fûe
, 
löe
, 
fun˘i⁄
, 
îr
, 
fmt
, 
¨g
);

104 
	`va_íd
(
¨g
);

107 
	`Ârötf
(
°dîr
, "ALSAÜib %s:%i:(%sË", 
fûe
, 
löe
, 
fun˘i⁄
);

108 
	`vÂrötf
(
°dîr
, 
fmt
, 
¨g
);

109 i‡(
îr
)

110 
	`Ârötf
(
°dîr
, ": %s", 
	`¢d_°ªº‹
(
îr
));

111 
	`putc
('\n', 
°dîr
);

112 
	`va_íd
(
¨g
);

113 
	}
}

120 
¢d_lib_îr‹_h™dÀr_t
 
	g¢d_lib_îr‹
 = 
¢d_lib_îr‹_deÁu…
;

129 
	$¢d_lib_îr‹_£t_h™dÀr
(
¢d_lib_îr‹_h™dÀr_t
 
h™dÀr
)

131 
¢d_lib_îr‹
 = 
h™dÀr
 =
NULL
 ? 
¢d_lib_îr‹_deÁu…
 : handler;

132 #i‚de‡
NDEBUG


133 i‡(
¢d_lib_îr‹
 !
¢d_lib_îr‹_deÁu…
)

134 
¢d_îr_msg
 = 
¢d_lib_îr‹
;

137 
	}
}

143 c⁄° *
	$¢d_asoundlib_vîsi⁄
()

145  
SND_LIB_VERSION_STR
;

146 
	}
}

148 #i‚de‡
NDEBUG


152 
	$¢d_îr_msg_deÁu…
(c⁄° *
fûe
, 
löe
, c⁄° *
fun˘i⁄
, 
îr
, c⁄° *
fmt
, ...)

154 
va_li°
 
¨g
;

155 c⁄° *
vîbo£
;

157 
vîbo£
 = 
	`gëív
("LIBASOUND_DEBUG");

158 i‡(! 
vîbo£
 || ! *verbose)

160 
	`va_°¨t
(
¨g
, 
fmt
);

161 
	`Ârötf
(
°dîr
, "ALSAÜib %s:%i:(%sË", 
fûe
, 
löe
, 
fun˘i⁄
);

162 
	`vÂrötf
(
°dîr
, 
fmt
, 
¨g
);

163 i‡(
îr
)

164 
	`Ârötf
(
°dîr
, ": %s", 
	`¢d_°ªº‹
(
îr
));

165 
	`putc
('\n', 
°dîr
);

166 
	`va_íd
(
¨g
);

167 #ifde‡
ALSA_DEBUG_ASSERT


168 
vîbo£
 = 
	`gëív
("LIBASOUND_DEBUG_ASSERT");

169 i‡(
vîbo£
 && *verbose)

170 
	`as£π
(0);

172 
	}
}

177 
¢d_lib_îr‹_h™dÀr_t
 
	g¢d_îr_msg
 = 
¢d_îr_msg_deÁu…
;

192 
size_t
 
	$¢d_°æ˝y
(*
d°
, c⁄° *
§c
, 
size_t
 
size
)

194 
size_t
 
ªt
 = 
	`°æí
(
§c
);

195 i‡(
size
) {

196 
size_t
 
Àn
 = 
ªt
 >
size
 ? size - 1 :Ñet;

197 
	`mem˝y
(
d°
, 
§c
, 
Àn
);

198 
d°
[
Àn
] = '\0';

200  
ªt
;

201 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep.c

31 
	~"hwdï_loˇl.h
"

32 
	~<°dio.h
>

33 
	~<°dlib.h
>

34 
	~<uni°d.h
>

35 
	~<°rög.h
>

36 
	~<f˙é.h
>

37 
	~<sys/io˘l.h
>

39 
	$¢d_hwdï_›í_c⁄f
(
¢d_hwdï_t
 **
hwdï
,

40 c⁄° *
«me
, 
¢d_c⁄fig_t
 *
hwdï_roŸ
,

41 
¢d_c⁄fig_t
 *
hwdï_c⁄f
, 
mode
)

43 c⁄° *
°r
;

44 
buf
[256], 
îrbuf
[256];

45 
îr
;

46 
¢d_c⁄fig_t
 *
c⁄f
, *
ty≥_c⁄f
 = 
NULL
;

47 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

48 c⁄° *
id
;

49 c⁄° *
lib
 = 
NULL
, *
›í_«me
 = NULL;

50 (*
›í_func
)(
¢d_hwdï_t
 **, c⁄° *, 
¢d_c⁄fig_t
 *, snd_c⁄fig_à*, Ë
NULL
;

51 #i‚de‡
PIC


52 *
	`¢d_hwdï_›í_symbﬁs
();

54 *
h
 = 
NULL
;

55 i‡(
	`¢d_c⁄fig_gë_ty≥
(
hwdï_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

56 i‡(
«me
)

57 
	`SNDERR
("InvÆidÅy≥ f‹ HWDEP %†deföôi⁄", 
«me
);

59 
	`SNDERR
("InvalidÅype for HWDEP definition");

60  -
EINVAL
;

62 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
hwdï_c⁄f
, "ty≥", &
c⁄f
);

63 i‡(
îr
 < 0) {

64 
	`SNDERR
("type isÇot defined");

65  
îr
;

67 
îr
 = 
	`¢d_c⁄fig_gë_id
(
c⁄f
, &
id
);

68 i‡(
îr
 < 0) {

69 
	`SNDERR
("unableÅo get id");

70  
îr
;

72 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
c⁄f
, &
°r
);

73 i‡(
îr
 < 0) {

74 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

75  
îr
;

77 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
hwdï_roŸ
, "hwdï_ty≥", 
°r
, &
ty≥_c⁄f
);

78 i‡(
îr
 >= 0) {

79 i‡(
	`¢d_c⁄fig_gë_ty≥
(
ty≥_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

80 
	`SNDERR
("InvÆidÅy≥ f‹ HWDEPÅy≥ %†deföôi⁄", 
°r
);

81 
îr
 = -
EINVAL
;

82 
_îr
;

84 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
ty≥_c⁄f
) {

85 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

86 c⁄° *
id
;

87 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

89 i‡(
	`°rcmp
(
id
, "comment") == 0)

91 i‡(
	`°rcmp
(
id
, "lib") == 0) {

92 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
lib
);

93 i‡(
îr
 < 0) {

94 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

95 
_îr
;

99 i‡(
	`°rcmp
(
id
, "open") == 0) {

100 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
›í_«me
);

101 i‡(
îr
 < 0) {

102 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

103 
_îr
;

107 
	`SNDERR
("Unknow¿fõld %s", 
id
);

108 
îr
 = -
EINVAL
;

109 
_îr
;

112 i‡(!
›í_«me
) {

113 
›í_«me
 = 
buf
;

114 
	`¢¥ötf
(
buf
, (buf), "_¢d_hwdï_%s_›í", 
°r
);

116 #i‚de‡
PIC


117 
	`¢d_hwdï_›í_symbﬁs
();

119 
h
 = 
	`INTERNAL
(
¢d_dl›í
)(
lib
, 
RTLD_NOW
, 
îrbuf
, (errbuf));

120 i‡(
h
)

121 
›í_func
 = 
	`¢d_dlsym
(
h
, 
›í_«me
, 
	`SND_DLSYM_VERSION
(
SND_HWDEP_DLSYM_VERSION
));

122 
îr
 = 0;

123 i‡(!
h
) {

124 
	`SNDERR
("C™nŸ o≥¿sh¨edÜibøry %†(%s)", 
lib
, 
îrbuf
);

125 
îr
 = -
ENOENT
;

126 } i‡(!
›í_func
) {

127 
	`SNDERR
("symbﬁ %†i†nŸ deföed insidê%s", 
›í_«me
, 
lib
);

128 
	`¢d_dl˛o£
(
h
);

129 
îr
 = -
ENXIO
;

131 
_îr
:

132 i‡(
ty≥_c⁄f
)

133 
	`¢d_c⁄fig_dñëe
(
ty≥_c⁄f
);

134 i‡(
îr
 >= 0) {

135 
îr
 = 
	`›í_func
(
hwdï
, 
«me
, 
hwdï_roŸ
, 
hwdï_c⁄f
, 
mode
);

136 i‡(
îr
 >= 0) {

137 (*
hwdï
)->
dl_h™dÀ
 = 
h
;

139 
	`¢d_dl˛o£
(
h
);

142  
îr
;

143 
	}
}

145 
	$¢d_hwdï_›í_noupd©e
(
¢d_hwdï_t
 **
hwdï
, 
¢d_c⁄fig_t
 *
roŸ
, c⁄° *
«me
, 
mode
)

147 
îr
;

148 
¢d_c⁄fig_t
 *
hwdï_c⁄f
;

149 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "hwdï", 
«me
, &
hwdï_c⁄f
);

150 i‡(
îr
 < 0) {

151 
	`SNDERR
("Unknow¿HwDï %s", 
«me
);

152  
îr
;

154 
îr
 = 
	`¢d_hwdï_›í_c⁄f
(
hwdï
, 
«me
, 
roŸ
, 
hwdï_c⁄f
, 
mode
);

155 
	`¢d_c⁄fig_dñëe
(
hwdï_c⁄f
);

156  
îr
;

157 
	}
}

169 
	$¢d_hwdï_›í
(
¢d_hwdï_t
 **
hwdï
, c⁄° *
«me
, 
mode
)

171 
¢d_c⁄fig_t
 *
t›
;

172 
îr
;

174 
	`as£π
(
hwdï
 && 
«me
);

175 
îr
 = 
	`¢d_c⁄fig_upd©e_ªf
(&
t›
);

176 i‡(
îr
 < 0)

177  
îr
;

178 
îr
 = 
	`¢d_hwdï_›í_noupd©e
(
hwdï
, 
t›
, 
«me
, 
mode
);

179 
	`¢d_c⁄fig_uƒef
(
t›
);

180  
îr
;

181 
	}
}

194 
	$¢d_hwdï_›í_lc⁄f
(
¢d_hwdï_t
 **
hwdï
, c⁄° *
«me
,

195 
mode
, 
¢d_c⁄fig_t
 *
lc⁄f
)

197 
	`as£π
(
hwdï
 && 
«me
 && 
lc⁄f
);

198  
	`¢d_hwdï_›í_noupd©e
(
hwdï
, 
lc⁄f
, 
«me
, 
mode
);

199 
	}
}

209 
	$¢d_hwdï_˛o£
(
¢d_hwdï_t
 *
hwdï
)

211 
îr
;

212 
	`as£π
(
hwdï
);

213 
îr
 = 
hwdï
->
›s
->
	`˛o£
(hwdep);

214 i‡(
hwdï
->
dl_h™dÀ
)

215 
	`¢d_dl˛o£
(
hwdï
->
dl_h™dÀ
);

216 
	`‰ì
(
hwdï
->
«me
);

217 
	`‰ì
(
hwdï
);

218  
îr
;

219 
	}
}

229 c⁄° *
	$¢d_hwdï_«me
(
¢d_hwdï_t
 *
hwdï
)

231 
	`as£π
(
hwdï
);

232  
hwdï
->
«me
;

233 
	}
}

242 
¢d_hwdï_ty≥_t
 
	$¢d_hwdï_ty≥
(
¢d_hwdï_t
 *
hwdï
)

244 
	`as£π
(
hwdï
);

245  
hwdï
->
ty≥
;

246 
	}
}

253 
	$¢d_hwdï_pﬁl_des¸ùt‹s_cou¡
(
¢d_hwdï_t
 *
hwdï
)

255 
	`as£π
(
hwdï
);

257 
	}
}

266 
	$¢d_hwdï_pﬁl_des¸ùt‹s
(
¢d_hwdï_t
 *
hwdï
, 
pﬁlfd
 *
pfds
, 
•a˚
)

268 
	`as£π
(
hwdï
);

269 i‡(
•a˚
 >= 1) {

270 
pfds
->
fd
 = 
hwdï
->
pﬁl_fd
;

271 
hwdï
->
mode
 & 
O_ACCMODE
) {

272 
O_WRONLY
:

273 
pfds
->
evíts
 = 
POLLOUT
|
POLLERR
|
POLLNVAL
;

275 
O_RDONLY
:

276 
pfds
->
evíts
 = 
POLLIN
|
POLLERR
|
POLLNVAL
;

278 
O_RDWR
:

279 
pfds
->
evíts
 = 
POLLOUT
|
POLLIN
|
POLLERR
|
POLLNVAL
;

282  -
EIO
;

287 
	}
}

297 
	$¢d_hwdï_pﬁl_des¸ùt‹s_ªvíts
(
¢d_hwdï_t
 *
hwdï
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

299 
	`as£π
(
hwdï
 && 
pfds
 && 
ªvíts
);

300 i‡(
nfds
 == 1) {

301 *
ªvíts
 = 
pfds
->revents;

304  -
EINVAL
;

305 
	}
}

313 
	$¢d_hwdï_n⁄block
(
¢d_hwdï_t
 *
hwdï
, 
n⁄block
)

315 
îr
;

316 
	`as£π
(
hwdï
);

317 i‡((
îr
 = 
hwdï
->
›s
->
	`n⁄block
(hwdï, 
n⁄block
)) < 0)

318  
îr
;

319 i‡(
n⁄block
)

320 
hwdï
->
mode
 |
SND_HWDEP_OPEN_NONBLOCK
;

322 
hwdï
->
mode
 &~
SND_HWDEP_OPEN_NONBLOCK
;

324 
	}
}

330 
size_t
 
	$¢d_hwdï_öfo_sizeof
()

332  (
¢d_hwdï_öfo_t
);

333 
	}
}

343 
	$¢d_hwdï_öfo_mÆloc
(
¢d_hwdï_öfo_t
 **
öfo
)

345 
	`as£π
(
öfo
);

346 *
öfo
 = 
	`ˇŒoc
(1, (
¢d_hwdï_öfo_t
));

347 i‡(!*
öfo
)

348  -
ENOMEM
;

350 
	}
}

359 
	$¢d_hwdï_öfo_‰ì
(
¢d_hwdï_öfo_t
 *
öfo
)

361 
	`as£π
(
öfo
);

362 
	`‰ì
(
öfo
);

363 
	}
}

370 
	$¢d_hwdï_öfo_c›y
(
¢d_hwdï_öfo_t
 *
d°
, c⁄° snd_hwdï_öfo_à*
§c
)

372 
	`as£π
(
d°
 && 
§c
);

373 *
d°
 = *
§c
;

374 
	}
}

381 
	$¢d_hwdï_öfo_gë_ˇrd
(c⁄° 
¢d_hwdï_öfo_t
 *
obj
)

383 
	`as£π
(
obj
);

384  
obj
->
ˇrd
;

385 
	}
}

392 
	$¢d_hwdï_öfo_gë_devi˚
(c⁄° 
¢d_hwdï_öfo_t
 *
öfo
)

394 
	`as£π
(
öfo
);

395  
öfo
->
devi˚
;

396 
	}
}

403 c⁄° *
	$¢d_hwdï_öfo_gë_id
(c⁄° 
¢d_hwdï_öfo_t
 *
obj
)

405 
	`as£π
(
obj
);

406  (c⁄° *)
obj
->
id
;

407 
	}
}

414 c⁄° *
	$¢d_hwdï_öfo_gë_«me
(c⁄° 
¢d_hwdï_öfo_t
 *
obj
)

416 
	`as£π
(
obj
);

417  (c⁄° *)
obj
->
«me
;

418 
	}
}

425 
¢d_hwdï_iÁ˚_t
 
	$¢d_hwdï_öfo_gë_iÁ˚
(c⁄° 
¢d_hwdï_öfo_t
 *
obj
)

427 
	`as£π
(
obj
);

428  
obj
->
iÁ˚
;

429 
	}
}

436 
	$¢d_hwdï_öfo_£t_devi˚
(
¢d_hwdï_öfo_t
 *
obj
, 
vÆ
)

438 
	`as£π
(
obj
);

439 
obj
->
devi˚
 = 
vÆ
;

440 
	}
}

448 
	$¢d_hwdï_öfo
(
¢d_hwdï_t
 *
hwdï
, 
¢d_hwdï_öfo_t
 * 
öfo
)

450 
	`as£π
(
hwdï
);

451 
	`as£π
(
öfo
);

452  
hwdï
->
›s
->
	`öfo
(hwdï, 
öfo
);

453 
	}
}

462 
	$¢d_hwdï_io˘l
(
¢d_hwdï_t
 *
hwdï
, 
ªque°
, * 
¨g
)

464 
	`as£π
(
hwdï
);

465  
hwdï
->
›s
->
	`io˘l
(hwdï, 
ªque°
, 
¨g
);

466 
	}
}

474 
ssize_t
 
	$¢d_hwdï_wrôe
(
¢d_hwdï_t
 *
hwdï
, c⁄° *
buf„r
, 
size_t
 
size
)

476 
	`as£π
(
hwdï
);

477 
	`as£π
(((
hwdï
->
mode
 & 
O_ACCMODE
Ë=
O_WRONLY
Ë|| ((hwdï->modê& O_ACCMODEË=
O_RDWR
));

478 
	`as£π
(
buf„r
 || 
size
 == 0);

479  
hwdï
->
›s
->
	`wrôe
(hwdï, 
buf„r
, 
size
);

480 
	}
}

488 
ssize_t
 
	$¢d_hwdï_ªad
(
¢d_hwdï_t
 *
hwdï
, *
buf„r
, 
size_t
 
size
)

490 
	`as£π
(
hwdï
);

491 
	`as£π
(((
hwdï
->
mode
 & 
O_ACCMODE
Ë=
O_RDONLY
Ë|| ((hwdï->modê& O_ACCMODEË=
O_RDWR
));

492 
	`as£π
(
buf„r
 || 
size
 == 0);

493  (
hwdï
->
›s
->
ªad
)(hwdï, 
buf„r
, 
size
);

494 
	}
}

502 
	$¢d_hwdï_d•_°©us
(
¢d_hwdï_t
 *
hwdï
, 
¢d_hwdï_d•_°©us_t
 *
öfo
)

504 
	`as£π
(
hwdï
);

505 
	`as£π
(
öfo
);

506  
hwdï
->
›s
->
	`io˘l
(hwdï, 
SNDRV_HWDEP_IOCTL_DSP_STATUS
, (*)
öfo
);

507 
	}
}

515 
	$¢d_hwdï_d•_lﬂd
(
¢d_hwdï_t
 *
hwdï
, 
¢d_hwdï_d•_image_t
 *
block
)

517 
	`as£π
(
hwdï
);

518 
	`as£π
(
block
);

519  
hwdï
->
›s
->
	`io˘l
(hwdï, 
SNDRV_HWDEP_IOCTL_DSP_LOAD
, (*)
block
);

520 
	}
}

526 
size_t
 
	$¢d_hwdï_d•_°©us_sizeof
()

528  (
¢d_hwdï_d•_°©us_t
);

529 
	}
}

539 
	$¢d_hwdï_d•_°©us_mÆloc
(
¢d_hwdï_d•_°©us_t
 **
öfo
)

541 
	`as£π
(
öfo
);

542 *
öfo
 = 
	`ˇŒoc
(1, (
¢d_hwdï_d•_°©us_t
));

543 i‡(!*
öfo
)

544  -
ENOMEM
;

546 
	}
}

555 
	$¢d_hwdï_d•_°©us_‰ì
(
¢d_hwdï_d•_°©us_t
 *
öfo
)

557 
	`as£π
(
öfo
);

558 
	`‰ì
(
öfo
);

559 
	}
}

566 
	$¢d_hwdï_d•_°©us_c›y
(
¢d_hwdï_d•_°©us_t
 *
d°
, c⁄° snd_hwdï_d•_°©us_à*
§c
)

568 
	`as£π
(
d°
 && 
§c
);

569 *
d°
 = *
§c
;

570 
	}
}

577 
	$¢d_hwdï_d•_°©us_gë_vîsi⁄
(c⁄° 
¢d_hwdï_d•_°©us_t
 *
obj
)

579 
	`as£π
(
obj
);

580  
obj
->
vîsi⁄
;

581 
	}
}

588 c⁄° *
	$¢d_hwdï_d•_°©us_gë_id
(c⁄° 
¢d_hwdï_d•_°©us_t
 *
obj
)

590 
	`as£π
(
obj
);

591  (c⁄° *)
obj
->
id
;

592 
	}
}

599 
	$¢d_hwdï_d•_°©us_gë_num_d•s
(c⁄° 
¢d_hwdï_d•_°©us_t
 *
obj
)

601 
	`as£π
(
obj
);

602  
obj
->
num_d•s
;

603 
	}
}

610 
	$¢d_hwdï_d•_°©us_gë_d•_lﬂded
(c⁄° 
¢d_hwdï_d•_°©us_t
 *
öfo
)

612 
	`as£π
(
öfo
);

613  
öfo
->
d•_lﬂded
;

614 
	}
}

621 
	$¢d_hwdï_d•_°©us_gë_chù_ªady
(c⁄° 
¢d_hwdï_d•_°©us_t
 *
obj
)

623 
	`as£π
(
obj
);

624  
obj
->
chù_ªady
;

625 
	}
}

631 
size_t
 
	$¢d_hwdï_d•_image_sizeof
()

633  (
¢d_hwdï_d•_image_t
);

634 
	}
}

644 
	$¢d_hwdï_d•_image_mÆloc
(
¢d_hwdï_d•_image_t
 **
öfo
)

646 
	`as£π
(
öfo
);

647 *
öfo
 = 
	`ˇŒoc
(1, (
¢d_hwdï_d•_image_t
));

648 i‡(!*
öfo
)

649  -
ENOMEM
;

651 
	}
}

660 
	$¢d_hwdï_d•_image_‰ì
(
¢d_hwdï_d•_image_t
 *
öfo
)

662 
	`as£π
(
öfo
);

663 
	`‰ì
(
öfo
);

664 
	}
}

671 
	$¢d_hwdï_d•_image_c›y
(
¢d_hwdï_d•_image_t
 *
d°
, c⁄° snd_hwdï_d•_image_à*
§c
)

673 
	`as£π
(
d°
 && 
§c
);

674 *
d°
 = *
§c
;

675 
	}
}

682 
	$¢d_hwdï_d•_image_gë_ödex
(c⁄° 
¢d_hwdï_d•_image_t
 *
obj
)

684 
	`as£π
(
obj
);

685  
obj
->
ödex
;

686 
	}
}

693 c⁄° *
	$¢d_hwdï_d•_image_gë_«me
(c⁄° 
¢d_hwdï_d•_image_t
 *
obj
)

695 
	`as£π
(
obj
);

696  (c⁄° *)
obj
->
«me
;

697 
	}
}

704 
size_t
 
	$¢d_hwdï_d•_image_gë_Àngth
(c⁄° 
¢d_hwdï_d•_image_t
 *
obj
)

706 
	`as£π
(
obj
);

707  
obj
->
Àngth
;

708 
	}
}

715 c⁄° *
	$¢d_hwdï_d•_image_gë_image
(c⁄° 
¢d_hwdï_d•_image_t
 *
obj
)

717 
	`as£π
(
obj
);

718  
obj
->
image
;

719 
	}
}

726 
	$¢d_hwdï_d•_image_£t_ödex
(
¢d_hwdï_d•_image_t
 *
obj
, 
ödex
)

728 
	`as£π
(
obj
);

729 
obj
->
ödex
 = index;

730 
	}
}

737 
	$¢d_hwdï_d•_image_£t_«me
(
¢d_hwdï_d•_image_t
 *
obj
, c⁄° *
«me
)

739 
	`as£π
(
obj
 && 
«me
);

740 
	`°∫˝y
((*)
obj
->
«me
,Çame, (obj->name));

741 
obj
->
«me
[(obj->name)-1] = 0;

742 
	}
}

749 
	$¢d_hwdï_d•_image_£t_Àngth
(
¢d_hwdï_d•_image_t
 *
obj
, 
size_t
 
Àngth
)

751 
	`as£π
(
obj
);

752 
obj
->
Àngth
 =Üength;

753 
	}
}

760 
	$¢d_hwdï_d•_image_£t_image
(
¢d_hwdï_d•_image_t
 *
obj
, *
image
)

762 
	`as£π
(
obj
);

763 
obj
->
image
 = image;

764 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep_hw.c

22 
	~"hwdï_loˇl.h
"

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~<uni°d.h
>

26 
	~<°rög.h
>

27 
	~<f˙é.h
>

28 
	~<sys/io˘l.h
>

30 #i‚de‡
PIC


32 c⁄° *
	g_¢d_moduÀ_hwdï_hw
 = "";

35 
	#SNDRV_FILE_HWDEP
 
ALSA_DEVICE_DIRECTORY
 "hwC%iD%i"

	)

36 
	#SNDRV_HWDEP_VERSION_MAX
 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 1)

	)

38 
	$¢d_hwdï_hw_˛o£
(
¢d_hwdï_t
 *
hwdï
)

40 
ªs
;

41 
	`as£π
(
hwdï
);

42 
ªs
 = 
	`˛o£
(
hwdï
->
pﬁl_fd
Ë< 0 ? -
î∫o
 : 0;

43  
ªs
;

44 
	}
}

46 
	$¢d_hwdï_hw_n⁄block
(
¢d_hwdï_t
 *
hwdï
, 
n⁄block
)

48 
Êags
;

49 
	`as£π
(
hwdï
);

50 i‡((
Êags
 = 
	`f˙é
(
hwdï
->
pﬁl_fd
, 
F_GETFL
)) < 0)

51  -
î∫o
;

52 i‡(
n⁄block
)

53 
Êags
 |
O_NONBLOCK
;

55 
Êags
 &~
O_NONBLOCK
;

56 i‡(
	`f˙é
(
hwdï
->
pﬁl_fd
, 
F_SETFL
, 
Êags
) < 0)

57  -
î∫o
;

59 
	}
}

61 
	$¢d_hwdï_hw_öfo
(
¢d_hwdï_t
 *
hwdï
, 
¢d_hwdï_öfo_t
 *
öfo
)

63 
	`as£π
(
hwdï
 && 
öfo
);

64 i‡(
	`io˘l
(
hwdï
->
pﬁl_fd
, 
SNDRV_HWDEP_IOCTL_INFO
, 
öfo
) < 0)

65  -
î∫o
;

67 
	}
}

69 
	$¢d_hwdï_hw_io˘l
(
¢d_hwdï_t
 *
hwdï
, 
ªque°
, * 
¨g
)

71 
	`as£π
(
hwdï
);

72 i‡(
	`io˘l
(
hwdï
->
pﬁl_fd
, 
ªque°
, 
¨g
) < 0)

73  -
î∫o
;

75 
	}
}

77 
ssize_t
 
	$¢d_hwdï_hw_wrôe
(
¢d_hwdï_t
 *
hwdï
, c⁄° *
buf„r
, 
size_t
 
size
)

79 
ssize_t
 
ªsu…
;

80 
	`as£π
(
hwdï
 && (
buf„r
 || 
size
 == 0));

81 
ªsu…
 = 
	`wrôe
(
hwdï
->
pﬁl_fd
, 
buf„r
, 
size
);

82 i‡(
ªsu…
 < 0)

83  -
î∫o
;

84  
ªsu…
;

85 
	}
}

87 
ssize_t
 
	$¢d_hwdï_hw_ªad
(
¢d_hwdï_t
 *
hwdï
, *
buf„r
, 
size_t
 
size
)

89 
ssize_t
 
ªsu…
;

90 
	`as£π
(
hwdï
 && (
buf„r
 || 
size
 == 0));

91 
ªsu…
 = 
	`ªad
(
hwdï
->
pﬁl_fd
, 
buf„r
, 
size
);

92 i‡(
ªsu…
 < 0)

93  -
î∫o
;

94  
ªsu…
;

95 
	}
}

97 c⁄° 
¢d_hwdï_›s_t
 
	g¢d_hwdï_hw_›s
 = {

98 .
˛o£
 = 
¢d_hwdï_hw_˛o£
,

99 .
	gn⁄block
 = 
¢d_hwdï_hw_n⁄block
,

100 .
	göfo
 = 
¢d_hwdï_hw_öfo
,

101 .
	gio˘l
 = 
¢d_hwdï_hw_io˘l
,

102 .
	gwrôe
 = 
¢d_hwdï_hw_wrôe
,

103 .
	gªad
 = 
¢d_hwdï_hw_ªad
,

106 
	$¢d_hwdï_hw_›í
(
¢d_hwdï_t
 **
h™dÀ
, c⁄° *
«me
, 
ˇrd
, 
devi˚
, 
mode
)

108 
fd
, 
vî
, 
ªt
;

109 
fûíame
[(
SNDRV_FILE_HWDEP
) + 20];

110 
¢d_hwdï_t
 *
hwdï
;

111 
	`as£π
(
h™dÀ
);

113 *
h™dÀ
 = 
NULL
;

115 i‡(
ˇrd
 < 0 || c¨d >
SND_MAX_CARDS
)

116  -
EINVAL
;

117 
	`•rötf
(
fûíame
, 
SNDRV_FILE_HWDEP
, 
ˇrd
, 
devi˚
);

118 
fd
 = 
	`¢d_›í_devi˚
(
fûíame
, 
mode
);

119 i‡(
fd
 < 0) {

120 
	`¢d_ˇrd_lﬂd
(
ˇrd
);

121 
fd
 = 
	`¢d_›í_devi˚
(
fûíame
, 
mode
);

122 i‡(
fd
 < 0)

123  -
î∫o
;

125 i‡(
	`io˘l
(
fd
, 
SNDRV_HWDEP_IOCTL_PVERSION
, &
vî
) < 0) {

126 
ªt
 = -
î∫o
;

127 
	`˛o£
(
fd
);

128  
ªt
;

130 i‡(
	`SNDRV_PROTOCOL_INCOMPATIBLE
(
vî
, 
SNDRV_HWDEP_VERSION_MAX
)) {

131 
	`˛o£
(
fd
);

132  -
SND_ERROR_INCOMPATIBLE_VERSION
;

134 
hwdï
 = (
¢d_hwdï_t
 *Ë
	`ˇŒoc
(1, (snd_hwdep_t));

135 i‡(
hwdï
 =
NULL
) {

136 
	`˛o£
(
fd
);

137  -
ENOMEM
;

139 
hwdï
->
«me
 = 
	`°rdup
(name);

140 
hwdï
->
pﬁl_fd
 = 
fd
;

141 
hwdï
->
mode
 = mode;

142 
hwdï
->
ty≥
 = 
SND_HWDEP_TYPE_HW
;

143 
hwdï
->
›s
 = &
¢d_hwdï_hw_›s
;

144 *
h™dÀ
 = 
hwdï
;

146 
	}
}

148 
	$_¢d_hwdï_hw_›í
(
¢d_hwdï_t
 **
hwdï
, *
«me
,

149 
¢d_c⁄fig_t
 *
roŸ
 
ATTRIBUTE_UNUSED
,

150 
¢d_c⁄fig_t
 *
c⁄f
, 
mode
)

152 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

153 
ˇrd
 = -1, 
devi˚
 = 0;

154 
îr
;

155 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

156 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

157 c⁄° *
id
;

158 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

160 i‡(
	`_¢d_c⁄f_gíîic_id
(
id
))

162 i‡(
	`°rcmp
(
id
, "card") == 0) {

163 
îr
 = 
	`¢d_c⁄fig_gë_ˇrd
(
n
);

164 i‡(
îr
 < 0)

165  
îr
;

166 
ˇrd
 = 
îr
;

169 i‡(
	`°rcmp
(
id
, "device") == 0) {

170 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
devi˚
);

171 i‡(
îr
 < 0)

172  
îr
;

175 
	`SNDERR
("U√x≥˘ed fõld %s", 
id
);

176  -
EINVAL
;

178 i‡(
ˇrd
 < 0)

179  -
EINVAL
;

180  
	`¢d_hwdï_hw_›í
(
hwdï
, 
«me
, 
ˇrd
, 
devi˚
, 
mode
);

181 
	}
}

182 
SND_DLSYM_BUILD_VERSION
(
_¢d_hwdï_hw_›í
, 
SND_HWDEP_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep_local.h

22 
	~"loˇl.h
"

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~<limôs.h
>

28 (*
	m˛o£
)(
¢d_hwdï_t
 *
	mhwdï
);

29 (*
	mn⁄block
)(
¢d_hwdï_t
 *
	mhwdï
, nonblock);

30 (*
	möfo
)(
¢d_hwdï_t
 *
	mhwdï
, 
¢d_hwdï_öfo_t
 *info);

31 (*
	mio˘l
)(
¢d_hwdï_t
 *
	mhwdï
, 
	mªque°
, * 
	m¨g
);

32 
ssize_t
 (*
wrôe
)(
¢d_hwdï_t
 *
	mhwdï
, c⁄° *
	mbuf„r
, 
size_t
 
	msize
);

33 
ssize_t
 (*
ªad
)(
¢d_hwdï_t
 *
	mhwdï
, *
	mbuf„r
, 
size_t
 
	msize
);

34 } 
	t¢d_hwdï_›s_t
;

36 
	s_¢d_hwdï
 {

37 *
	mdl_h™dÀ
;

38 *
	m«me
;

39 
¢d_hwdï_ty≥_t
 
	mty≥
;

40 
	mmode
;

41 
	mpﬁl_fd
;

42 c⁄° 
¢d_hwdï_›s_t
 *
	m›s
;

43 *
	m¥iv©e_d©a
;

46 
¢d_hwdï_hw_›í
(
¢d_hwdï_t
 **
h™dÀ
, c⁄° *
«me
, 
ˇrd
, 
devi˚
, 
mode
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep_symbols.c

21 #i‚de‡
PIC


23 c⁄° *
_¢d_moduÀ_hwdï_hw
;

25 c⁄° **
	g¢d_hwdï_›í_obje˘s
[] = {

26 &
_¢d_moduÀ_hwdï_hw


29 *
	$¢d_hwdï_›í_symbﬁs
()

31  
¢d_hwdï_›í_obje˘s
;

32 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/input.c

30 
	~"loˇl.h
"

31 
	~<°d¨g.h
>

32 
	~<°dio.h
>

33 
	~<°dlib.h
>

34 
	~<uni°d.h
>

36 #i‚de‡
DOC_HIDDEN


38 
	s_¢d_öput_›s
 {

39 (*
	m˛o£
)(
¢d_öput_t
 *
	möput
);

40 (*
	msˇn
)(
¢d_öput_t
 *
	möput
, c⁄° *
	mf‹m©
, 
va_li°
 
	m¨gs
);

41 *(*(
	mgës
))(
¢d_öput_t
 *
	möput
, *
	m°r
, 
size_t
 
	msize
);

42 (*
	mgëch
)(
¢d_öput_t
 *
	möput
);

43 (*
	mungëch
)(
¢d_öput_t
 *
	möput
, 
	mc
);

44 } 
	t¢d_öput_›s_t
;

46 
	s_¢d_öput
 {

47 
¢d_öput_ty≥_t
 
	mty≥
;

48 c⁄° 
¢d_öput_›s_t
 *
	m›s
;

49 *
	m¥iv©e_d©a
;

58 
	$¢d_öput_˛o£
(
¢d_öput_t
 *
öput
)

60 
îr
 = 
öput
->
›s
->
	`˛o£
(input);

61 
	`‰ì
(
öput
);

62  
îr
;

63 
	}
}

74 
	$¢d_öput_sˇnf
(
¢d_öput_t
 *
öput
, c⁄° *
f‹m©
, ...)

76 
ªsu…
;

77 
va_li°
 
¨gs
;

78 
	`va_°¨t
(
¨gs
, 
f‹m©
);

79 
ªsu…
 = 
öput
->
›s
->
	`sˇn
(öput, 
f‹m©
, 
¨gs
);

80 
	`va_íd
(
¨gs
);

81  
ªsu…
;

82 
	}
}

94 *
	$¢d_öput_gës
(
¢d_öput_t
 *
öput
, *
°r
, 
size_t
 
size
)

96  (
öput
->
›s
->
gës
)(öput, 
°r
, 
size
);

97 
	}
}

104 
	$¢d_öput_gëc
(
¢d_öput_t
 *
öput
)

106  
öput
->
›s
->
	`gëch
(input);

107 
	}
}

115 
	$¢d_öput_ungëc
(
¢d_öput_t
 *
öput
, 
c
)

117  
öput
->
›s
->
	`ungëch
(öput, 
c
);

118 
	}
}

120 #i‚de‡
DOC_HIDDEN


121 
	s_¢d_öput_°dio
 {

122 
	m˛o£
;

123 
FILE
 *
	mÂ
;

124 } 
	t¢d_öput_°dio_t
;

126 
	$¢d_öput_°dio_˛o£
(
¢d_öput_t
 *
öput
 
ATTRIBUTE_UNUSED
)

128 
¢d_öput_°dio_t
 *
°dio
 = 
öput
->
¥iv©e_d©a
;

129 i‡(
°dio
->
˛o£
)

130 
	`f˛o£
(
°dio
->
Â
);

131 
	`‰ì
(
°dio
);

133 
	}
}

135 
	$¢d_öput_°dio_sˇn
(
¢d_öput_t
 *
öput
, c⁄° *
f‹m©
, 
va_li°
 
¨gs
)

137 
¢d_öput_°dio_t
 *
°dio
 = 
öput
->
¥iv©e_d©a
;

138 
	`vfsˇnf
(
FILE
 *, c⁄° *, 
va_li°
);

139  
	`vfsˇnf
(
°dio
->
Â
, 
f‹m©
, 
¨gs
);

140 
	}
}

142 *
	$¢d_öput_°dio_gës
(
¢d_öput_t
 *
öput
, *
°r
, 
size_t
 
size
)

144 
¢d_öput_°dio_t
 *
°dio
 = 
öput
->
¥iv©e_d©a
;

145  
	`fgës
(
°r
, (Ë
size
, 
°dio
->
Â
);

146 
	}
}

148 
	$¢d_öput_°dio_gëc
(
¢d_öput_t
 *
öput
)

150 
¢d_öput_°dio_t
 *
°dio
 = 
öput
->
¥iv©e_d©a
;

151  
	`gëc
(
°dio
->
Â
);

152 
	}
}

154 
	$¢d_öput_°dio_ungëc
(
¢d_öput_t
 *
öput
, 
c
)

156 
¢d_öput_°dio_t
 *
°dio
 = 
öput
->
¥iv©e_d©a
;

157  
	`ungëc
(
c
, 
°dio
->
Â
);

158 
	}
}

160 c⁄° 
¢d_öput_›s_t
 
	g¢d_öput_°dio_›s
 = {

161 .
˛o£
 = 
¢d_öput_°dio_˛o£
,

162 .
	gsˇn
 = 
¢d_öput_°dio_sˇn
,

163 .
	ggës
 = 
¢d_öput_°dio_gës
,

164 .
	ggëch
 = 
¢d_öput_°dio_gëc
,

165 .
	gungëch
 = 
¢d_öput_°dio_ungëc
,

179 
	$¢d_öput_°dio_©èch
(
¢d_öput_t
 **
öpuç
, 
FILE
 *
Â
, 
_˛o£
)

181 
¢d_öput_t
 *
öput
;

182 
¢d_öput_°dio_t
 *
°dio
;

183 
	`as£π
(
öpuç
 && 
Â
);

184 
°dio
 = 
	`ˇŒoc
(1, (*stdio));

185 i‡(!
°dio
)

186  -
ENOMEM
;

187 
öput
 = 
	`ˇŒoc
(1, (*input));

188 i‡(!
öput
) {

189 
	`‰ì
(
°dio
);

190  -
ENOMEM
;

192 
°dio
->
Â
 = fp;

193 
°dio
->
˛o£
 = 
_˛o£
;

194 
öput
->
ty≥
 = 
SND_INPUT_STDIO
;

195 
öput
->
›s
 = &
¢d_öput_°dio_›s
;

196 
öput
->
¥iv©e_d©a
 = 
°dio
;

197 *
öpuç
 = 
öput
;

199 
	}
}

209 
	$¢d_öput_°dio_›í
(
¢d_öput_t
 **
öpuç
, c⁄° *
fûe
, c⁄° *
mode
)

211 
îr
;

212 
FILE
 *
Â
 = 
	`f›í
(
fûe
, 
mode
);

213 i‡(!
Â
) {

215  -
î∫o
;

217 
îr
 = 
	`¢d_öput_°dio_©èch
(
öpuç
, 
Â
, 1);

218 i‡(
îr
 < 0)

219 
	`f˛o£
(
Â
);

220  
îr
;

221 
	}
}

223 #i‚de‡
DOC_HIDDEN


225 
	s_¢d_öput_buf„r
 {

226 *
	mbuf
;

227 *
	m±r
;

228 
size_t
 
	msize
;

229 } 
	t¢d_öput_buf„r_t
;

231 
	$¢d_öput_buf„r_˛o£
(
¢d_öput_t
 *
öput
)

233 
¢d_öput_buf„r_t
 *
buf„r
 = 
öput
->
¥iv©e_d©a
;

234 
	`‰ì
(
buf„r
->
buf
);

235 
	`‰ì
(
buf„r
);

237 
	}
}

239 
	$¢d_öput_buf„r_sˇn
(
¢d_öput_t
 *
öput
, c⁄° *
f‹m©
, 
va_li°
 
¨gs
)

241 
¢d_öput_buf„r_t
 *
buf„r
 = 
öput
->
¥iv©e_d©a
;

242 
	`vssˇnf
(c⁄° *, c⁄° *, 
va_li°
);

244 
	`as£π
(0);

245  
	`vssˇnf
((*)
buf„r
->
±r
, 
f‹m©
, 
¨gs
);

246 
	}
}

248 *
	$¢d_öput_buf„r_gës
(
¢d_öput_t
 *
öput
, *
°r
, 
size_t
 
size
)

250 
¢d_öput_buf„r_t
 *
buf„r
 = 
öput
->
¥iv©e_d©a
;

251 
size_t
 
bsize
 = 
buf„r
->
size
;

252 --
size
 > 0 && 
bsize
 > 0) {

253 
c
 = *
buf„r
->
±r
++;

254 
bsize
--;

255 *
°r
++ = 
c
;

256 i‡(
c
 == '\n')

259 i‡(
bsize
 =
buf„r
->
size
)

260  
NULL
;

261 
buf„r
->
size
 = 
bsize
;

262 *
°r
 = '\0';

263  
°r
;

264 
	}
}

266 
	$¢d_öput_buf„r_gëc
(
¢d_öput_t
 *
öput
)

268 
¢d_öput_buf„r_t
 *
buf„r
 = 
öput
->
¥iv©e_d©a
;

269 i‡(
buf„r
->
size
 == 0)

270  
EOF
;

271 
buf„r
->
size
--;

272  *
buf„r
->
±r
++;

273 
	}
}

275 
	$¢d_öput_buf„r_ungëc
(
¢d_öput_t
 *
öput
, 
c
)

277 
¢d_öput_buf„r_t
 *
buf„r
 = 
öput
->
¥iv©e_d©a
;

278 i‡(
buf„r
->
±r
 =buf„r->
buf
)

279  
EOF
;

280 
buf„r
->
±r
--;

281 
	`as£π
(*
buf„r
->
±r
 =(Ë
c
);

282 
buf„r
->
size
++;

283  
c
;

284 
	}
}

286 c⁄° 
¢d_öput_›s_t
 
	g¢d_öput_buf„r_›s
 = {

287 .
˛o£
 = 
¢d_öput_buf„r_˛o£
,

288 .
	gsˇn
 = 
¢d_öput_buf„r_sˇn
,

289 .
	ggës
 = 
¢d_öput_buf„r_gës
,

290 .
	ggëch
 = 
¢d_öput_buf„r_gëc
,

291 .
	gungëch
 = 
¢d_öput_buf„r_ungëc
,

306 
	$¢d_öput_buf„r_›í
(
¢d_öput_t
 **
öpuç
, c⁄° *
buf
, 
ssize_t
 
size
)

308 
¢d_öput_t
 *
öput
;

309 
¢d_öput_buf„r_t
 *
buf„r
;

310 
	`as£π
(
öpuç
);

311 
buf„r
 = 
	`ˇŒoc
(1, (*buffer));

312 i‡(!
buf„r
)

313  -
ENOMEM
;

314 
öput
 = 
	`ˇŒoc
(1, (*input));

315 i‡(!
öput
) {

316 
	`‰ì
(
buf„r
);

317  -
ENOMEM
;

319 i‡(
size
 < 0)

320 
size
 = 
	`°æí
(
buf
);

321 
buf„r
->
buf
 = 
	`mÆloc
((
size_t
)
size
 + 1);

322 i‡(!
buf„r
->
buf
) {

323 
	`‰ì
(
öput
);

324 
	`‰ì
(
buf„r
);

325  -
ENOMEM
;

327 
	`mem˝y
(
buf„r
->
buf
, buf, (
size_t
Ë
size
);

328 
buf„r
->
buf
[
size
] = 0;

329 
buf„r
->
±r
 = buf„r->
buf
;

330 
buf„r
->
size
 = size;

331 
öput
->
ty≥
 = 
SND_INPUT_BUFFER
;

332 
öput
->
›s
 = &
¢d_öput_buf„r_›s
;

333 
öput
->
¥iv©e_d©a
 = 
buf„r
;

334 *
öpuç
 = 
öput
;

336 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/bag.c

22 
	~"mixî_loˇl.h
"

24 
	$bag_√w
(
bag_t
 **
bag
)

26 
bag_t
 *
b
 = 
	`mÆloc
((*b));

27 i‡(!
b
)

28  -
ENOMEM
;

29 
	`INIT_LIST_HEAD
(
b
);

30 *
bag
 = 
b
;

32 
	}
}

34 
	$bag_‰ì
(
bag_t
 *
bag
)

36 
	`as£π
(
	`li°_em±y
(
bag
));

37 
	`‰ì
(
bag
);

38 
	}
}

40 
	$bag_em±y
(
bag_t
 *
bag
)

42  
	`li°_em±y
(
bag
);

43 
	}
}

45 
	$bag_add
(
bag_t
 *
bag
, *
±r
)

47 
bag1_t
 *
b
 = 
	`mÆloc
((*b));

48 i‡(!
b
)

49  -
ENOMEM
;

50 
b
->
±r
 =Ötr;

51 
	`li°_add_èû
(&
b
->
li°
, 
bag
);

53 
	}
}

55 
	$bag_dñ
(
bag_t
 *
bag
, *
±r
)

57 
li°_hód
 *
pos
;

58 
	`li°_f‹_óch
(
pos
, 
bag
) {

59 
bag1_t
 *
b
 = 
	`li°_íåy
(
pos
, bag1_t, 
li°
);

60 i‡(
b
->
±r
 ==Ötr) {

61 
	`li°_dñ
(&
b
->
li°
);

62 
	`‰ì
(
b
);

66  -
ENOENT
;

67 
	}
}

69 
	$bag_dñ_Æl
(
bag_t
 *
bag
)

71 !
	`li°_em±y
(
bag
))

72 
	`li°_dñ
(
bag
->
√xt
);

73 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/mixer.c

42 
	~"mixî_loˇl.h
"

43 
	~<°dio.h
>

44 
	~<°dlib.h
>

45 
	~<uni°d.h
>

46 
	~<°rög.h
>

47 
	~<f˙é.h
>

48 
	~<sys/io˘l.h
>

50 #i‚de‡
DOC_HIDDEN


51 
	s_¢d_mixî_¶ave
 {

52 
¢d_h˘l_t
 *
	mh˘l
;

53 
li°_hód
 
	mli°
;

54 } 
	t¢d_mixî_¶ave_t
;

58 
¢d_mixî_com∑ª_deÁu…
(c⁄° 
¢d_mixî_ñem_t
 *
c1
,

59 c⁄° 
¢d_mixî_ñem_t
 *
c2
);

68 
	$¢d_mixî_›í
(
¢d_mixî_t
 **
mixîp
, 
mode
 
ATTRIBUTE_UNUSED
)

70 
¢d_mixî_t
 *
mixî
;

71 
	`as£π
(
mixîp
);

72 
mixî
 = 
	`ˇŒoc
(1, (*mixer));

73 i‡(
mixî
 =
NULL
)

74  -
ENOMEM
;

75 
	`INIT_LIST_HEAD
(&
mixî
->
¶aves
);

76 
	`INIT_LIST_HEAD
(&
mixî
->
˛as£s
);

77 
	`INIT_LIST_HEAD
(&
mixî
->
ñems
);

78 
mixî
->
com∑ª
 = 
¢d_mixî_com∑ª_deÁu…
;

79 *
mixîp
 = 
mixî
;

81 
	}
}

96 
	$¢d_mixî_ñem_©èch
(
¢d_mixî_ñem_t
 *
mñem
,

97 
¢d_h˘l_ñem_t
 *
hñem
)

99 
bag_t
 *
bag
 = 
	`¢d_h˘l_ñem_gë_ˇŒback_¥iv©e
(
hñem
);

100 
îr
;

101 
îr
 = 
	`bag_add
(
bag
, 
mñem
);

102 i‡(
îr
 < 0)

103  
îr
;

104  
	`bag_add
(&
mñem
->
hñems
, 
hñem
);

105 
	}
}

119 
	$¢d_mixî_ñem_dëach
(
¢d_mixî_ñem_t
 *
mñem
,

120 
¢d_h˘l_ñem_t
 *
hñem
)

122 
bag_t
 *
bag
 = 
	`¢d_h˘l_ñem_gë_ˇŒback_¥iv©e
(
hñem
);

123 
îr
;

124 
îr
 = 
	`bag_dñ
(
bag
, 
mñem
);

125 
	`as£π
(
îr
 >= 0);

126 
îr
 = 
	`bag_dñ
(&
mñem
->
hñems
, 
hñem
);

127 
	`as£π
(
îr
 >= 0);

129 
	}
}

138 
	$¢d_mixî_ñem_em±y
(
¢d_mixî_ñem_t
 *
mñem
)

140  
	`bag_em±y
(&
mñem
->
hñems
);

141 
	}
}

143 
	$h˘l_ñem_evít_h™dÀr
(
¢d_h˘l_ñem_t
 *
hñem
,

144 
mask
)

146 
bag_t
 *
bag
 = 
	`¢d_h˘l_ñem_gë_ˇŒback_¥iv©e
(
hñem
);

147 i‡(
mask
 =
SND_CTL_EVENT_MASK_REMOVE
) {

148 
ªs
 = 0;

149 
îr
;

150 
bag_ôî©‹_t
 
i
, 
n
;

151 
	`bag_f‹_óch_ß„
(
i
, 
n
, 
bag
) {

152 
¢d_mixî_ñem_t
 *
mñem
 = 
	`bag_ôî©‹_íåy
(
i
);

153 
¢d_mixî_˛ass_t
 *
˛ass
 = 
mñem
->class;

154 
îr
 = 
˛ass
->
	`evít
(˛ass, 
mask
, 
hñem
, 
mñem
);

155 i‡(
îr
 < 0)

156 
ªs
 = 
îr
;

161 
	`as£π
(
	`bag_em±y
(
bag
));

162 
	`bag_‰ì
(
bag
);

163  
ªs
;

165 i‡(
mask
 & (
SND_CTL_EVENT_MASK_VALUE
 | 
SND_CTL_EVENT_MASK_INFO
)) {

166 
îr
 = 0;

167 
bag_ôî©‹_t
 
i
, 
n
;

168 
	`bag_f‹_óch_ß„
(
i
, 
n
, 
bag
) {

169 
¢d_mixî_ñem_t
 *
mñem
 = 
	`bag_ôî©‹_íåy
(
i
);

170 
¢d_mixî_˛ass_t
 *
˛ass
 = 
mñem
->class;

171 
îr
 = 
˛ass
->
	`evít
(˛ass, 
mask
, 
hñem
, 
mñem
);

172 i‡(
îr
 < 0)

173  
îr
;

177 
	}
}

179 
	$h˘l_evít_h™dÀr
(
¢d_h˘l_t
 *
h˘l
, 
mask
,

180 
¢d_h˘l_ñem_t
 *
ñem
)

182 
¢d_mixî_t
 *
mixî
 = 
	`¢d_h˘l_gë_ˇŒback_¥iv©e
(
h˘l
);

183 
ªs
 = 0;

184 i‡(
mask
 & 
SND_CTL_EVENT_MASK_ADD
) {

185 
li°_hód
 *
pos
;

186 
bag_t
 *
bag
;

187 
îr
 = 
	`bag_√w
(&
bag
);

188 i‡(
îr
 < 0)

189  
îr
;

190 
	`¢d_h˘l_ñem_£t_ˇŒback
(
ñem
, 
h˘l_ñem_evít_h™dÀr
);

191 
	`¢d_h˘l_ñem_£t_ˇŒback_¥iv©e
(
ñem
, 
bag
);

192 
	`li°_f‹_óch
(
pos
, &
mixî
->
˛as£s
) {

193 
¢d_mixî_˛ass_t
 *
c
;

194 
c
 = 
	`li°_íåy
(
pos
, 
¢d_mixî_˛ass_t
, 
li°
);

195 
îr
 = 
c
->
	`evít
(c, 
mask
, 
ñem
, 
NULL
);

196 i‡(
îr
 < 0)

197 
ªs
 = 
îr
;

200  
ªs
;

201 
	}
}

210 
	$¢d_mixî_©èch
(
¢d_mixî_t
 *
mixî
, c⁄° *
«me
)

212 
¢d_h˘l_t
 *
h˘l
;

213 
îr
;

215 
îr
 = 
	`¢d_h˘l_›í
(&
h˘l
, 
«me
, 0);

216 i‡(
îr
 < 0)

217  
îr
;

218 
îr
 = 
	`¢d_mixî_©èch_h˘l
(
mixî
, 
h˘l
);

219 i‡(
îr
 < 0)

220  
îr
;

222 
	}
}

232 
	$¢d_mixî_©èch_h˘l
(
¢d_mixî_t
 *
mixî
, 
¢d_h˘l_t
 *
h˘l
)

234 
¢d_mixî_¶ave_t
 *
¶ave
;

235 
îr
;

237 
	`as£π
(
h˘l
);

238 
¶ave
 = 
	`ˇŒoc
(1, (*slave));

239 i‡(
¶ave
 =
NULL
) {

240 
	`¢d_h˘l_˛o£
(
h˘l
);

241  -
ENOMEM
;

243 
îr
 = 
	`¢d_h˘l_n⁄block
(
h˘l
, 1);

244 i‡(
îr
 < 0) {

245 
	`¢d_h˘l_˛o£
(
h˘l
);

246 
	`‰ì
(
¶ave
);

247  
îr
;

249 
	`¢d_h˘l_£t_ˇŒback
(
h˘l
, 
h˘l_evít_h™dÀr
);

250 
	`¢d_h˘l_£t_ˇŒback_¥iv©e
(
h˘l
, 
mixî
);

251 
¶ave
->
h˘l
 = hctl;

252 
	`li°_add_èû
(&
¶ave
->
li°
, &
mixî
->
¶aves
);

254 
	}
}

262 
	$¢d_mixî_dëach
(
¢d_mixî_t
 *
mixî
, c⁄° *
«me
)

264 
li°_hód
 *
pos
;

265 
	`li°_f‹_óch
(
pos
, &
mixî
->
¶aves
) {

266 
¢d_mixî_¶ave_t
 *
s
;

267 
s
 = 
	`li°_íåy
(
pos
, 
¢d_mixî_¶ave_t
, 
li°
);

268 i‡(
	`°rcmp
(
«me
, 
	`¢d_h˘l_«me
(
s
->
h˘l
)) == 0) {

269 
	`¢d_h˘l_˛o£
(
s
->
h˘l
);

270 
	`li°_dñ
(
pos
);

271 
	`‰ì
(
s
);

275  -
ENOENT
;

276 
	}
}

286 
	$¢d_mixî_dëach_h˘l
(
¢d_mixî_t
 *
mixî
, 
¢d_h˘l_t
 *
h˘l
)

288 
li°_hód
 *
pos
;

289 
	`li°_f‹_óch
(
pos
, &
mixî
->
¶aves
) {

290 
¢d_mixî_¶ave_t
 *
s
;

291 
s
 = 
	`li°_íåy
(
pos
, 
¢d_mixî_¶ave_t
, 
li°
);

292 i‡(
h˘l
 =
s
->hctl) {

293 
	`li°_dñ
(
pos
);

294 
	`‰ì
(
s
);

298  -
ENOENT
;

299 
	}
}

308 
	$¢d_mixî_gë_h˘l
(
¢d_mixî_t
 *
mixî
, c⁄° *
«me
, 
¢d_h˘l_t
 **
h˘l
)

310 
li°_hód
 *
pos
;

311 
	`li°_f‹_óch
(
pos
, &
mixî
->
¶aves
) {

312 
¢d_mixî_¶ave_t
 *
s
;

313 
s
 = 
	`li°_íåy
(
pos
, 
¢d_mixî_¶ave_t
, 
li°
);

314 i‡(
	`°rcmp
(
«me
, 
	`¢d_h˘l_«me
(
s
->
h˘l
)) == 0) {

315 *
h˘l
 = 
s
->hctl;

319  -
ENOENT
;

320 
	}
}

322 
	$¢d_mixî_throw_evít
(
¢d_mixî_t
 *
mixî
, 
mask
,

323 
¢d_mixî_ñem_t
 *
ñem
)

325 
mixî
->
evíts
++;

326 i‡(
mixî
->
ˇŒback
)

327  
mixî
->
	`ˇŒback
(mixî, 
mask
, 
ñem
);

329 
	}
}

331 
	$¢d_mixî_ñem_throw_evít
(
¢d_mixî_ñem_t
 *
ñem
, 
mask
)

333 
ñem
->
˛ass
->
mixî
->
evíts
++;

334 i‡(
ñem
->
ˇŒback
)

335  
ñem
->
	`ˇŒback
”Àm, 
mask
);

337 
	}
}

339 
	$_¢d_mixî_föd_ñem
(
¢d_mixî_t
 *
mixî
, 
¢d_mixî_ñem_t
 *
ñem
, *
dú
)

341 
l
, 
u
;

342 
c
 = 0;

343 
idx
 = -1;

344 
	`as£π
(
mixî
 && 
ñem
);

345 
	`as£π
(
mixî
->
com∑ª
);

346 
l
 = 0;

347 
u
 = 
mixî
->
cou¡
;

348 
l
 < 
u
) {

349 
idx
 = (
l
 + 
u
) / 2;

350 
c
 = 
mixî
->
	`com∑ª
(
ñem
, mixî->
≥Àms
[
idx
]);

351 i‡(
c
 < 0)

352 
u
 = 
idx
;

353 i‡(
c
 > 0)

354 
l
 = 
idx
 + 1;

358 *
dú
 = 
c
;

359  
idx
;

360 
	}
}

369 *
	$¢d_mixî_ñem_gë_¥iv©e
(c⁄° 
¢d_mixî_ñem_t
 *
ñem
)

371  
ñem
->
¥iv©e_d©a
;

372 
	}
}

385 
¢d_mixî_ñem_√w
(
¢d_mixî_ñem_t
 **
ñem
,

386 
¢d_mixî_ñem_ty≥_t
 
ty≥
,

387 
com∑ª_weight
,

388 *
¥iv©e_d©a
,

389 (*
¥iv©e_‰ì
)(
¢d_mixî_ñem_t
 *
ñem
))

391 
¢d_mixî_ñem_t
 *
mñem
 = 
	`ˇŒoc
(1, (*melem));

392 i‡(
mñem
 =
NULL
)

393  -
ENOMEM
;

394 
mñem
->
ty≥
 =Åype;

395 
mñem
->
com∑ª_weight
 = compare_weight;

396 
mñem
->
¥iv©e_d©a
 =Örivate_data;

397 
mñem
->
¥iv©e_‰ì
 =Örivate_free;

398 
	`INIT_LIST_HEAD
(&
mñem
->
hñems
);

399 *
ñem
 = 
mñem
;

401 
	}
}

411 
	$¢d_mixî_ñem_add
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_˛ass_t
 *
˛ass
)

413 
dú
, 
idx
;

414 
¢d_mixî_t
 *
mixî
 = 
˛ass
->mixer;

415 
ñem
->
˛ass
 = class;

417 i‡(
mixî
->
cou¡
 =mixî->
Æloc
) {

418 
¢d_mixî_ñem_t
 **
m
;

419 
mixî
->
Æloc
 += 32;

420 
m
 = 
	`ªÆloc
(
mixî
->
≥Àms
, (*mË* mixî->
Æloc
);

421 i‡(!
m
) {

422 
mixî
->
Æloc
 -= 32;

423  -
ENOMEM
;

425 
mixî
->
≥Àms
 = 
m
;

427 i‡(
mixî
->
cou¡
 == 0) {

428 
	`li°_add_èû
(&
ñem
->
li°
, &
mixî
->
ñems
);

429 
mixî
->
≥Àms
[0] = 
ñem
;

431 
idx
 = 
	`_¢d_mixî_föd_ñem
(
mixî
, 
ñem
, &
dú
);

432 
	`as£π
(
dú
 != 0);

433 i‡(
dú
 > 0) {

434 
	`li°_add
(&
ñem
->
li°
, &
mixî
->
≥Àms
[
idx
]->list);

435 
idx
++;

437 
	`li°_add_èû
(&
ñem
->
li°
, &
mixî
->
≥Àms
[
idx
]->list);

439 
	`memmove
(
mixî
->
≥Àms
 + 
idx
 + 1,

440 
mixî
->
≥Àms
 + 
idx
,

441 (
mixî
->
cou¡
 - 
idx
Ë* (
¢d_mixî_ñem_t
 *));

442 
mixî
->
≥Àms
[
idx
] = 
ñem
;

444 
mixî
->
cou¡
++;

445  
	`¢d_mixî_throw_evít
(
mixî
, 
SND_CTL_EVENT_MASK_ADD
, 
ñem
);

446 
	}
}

455 
	$¢d_mixî_ñem_ªmove
(
¢d_mixî_ñem_t
 *
ñem
)

457 
¢d_mixî_t
 *
mixî
 = 
ñem
->
˛ass
->mixer;

458 
bag_ôî©‹_t
 
i
, 
n
;

459 
îr
, 
idx
, 
dú
;

460 
m
;

461 
	`as£π
(
ñem
);

462 
	`as£π
(
mixî
->
cou¡
);

463 
idx
 = 
	`_¢d_mixî_föd_ñem
(
mixî
, 
ñem
, &
dú
);

464 i‡(
dú
 != 0)

465  -
EINVAL
;

466 
	`bag_f‹_óch_ß„
(
i
, 
n
, &
ñem
->
hñems
) {

467 
¢d_h˘l_ñem_t
 *
hñem
 = 
	`bag_ôî©‹_íåy
(
i
);

468 
	`¢d_mixî_ñem_dëach
(
ñem
, 
hñem
);

470 
îr
 = 
	`¢d_mixî_ñem_throw_evít
(
ñem
, 
SND_CTL_EVENT_MASK_REMOVE
);

471 
	`li°_dñ
(&
ñem
->
li°
);

472 
	`¢d_mixî_ñem_‰ì
(
ñem
);

473 
mixî
->
cou¡
--;

474 
m
 = 
mixî
->
cou¡
 - 
idx
;

475 i‡(
m
 > 0)

476 
	`memmove
(
mixî
->
≥Àms
 + 
idx
,

477 
mixî
->
≥Àms
 + 
idx
 + 1,

478 
m
 * (
¢d_mixî_ñem_t
 *));

479  
îr
;

480 
	}
}

488 
	$¢d_mixî_ñem_‰ì
(
¢d_mixî_ñem_t
 *
ñem
)

490 i‡(
ñem
->
¥iv©e_‰ì
)

491 
ñem
->
	`¥iv©e_‰ì
(elem);

492 
	`‰ì
(
ñem
);

493 
	}
}

502 
	$¢d_mixî_ñem_öfo
(
¢d_mixî_ñem_t
 *
ñem
)

504  
	`¢d_mixî_ñem_throw_evít
(
ñem
, 
SND_CTL_EVENT_MASK_INFO
);

505 
	}
}

514 
	$¢d_mixî_ñem_vÆue
(
¢d_mixî_ñem_t
 *
ñem
)

516  
	`¢d_mixî_ñem_throw_evít
(
ñem
, 
SND_CTL_EVENT_MASK_VALUE
);

517 
	}
}

527 
	$¢d_mixî_˛ass_ªgi°î
(
¢d_mixî_˛ass_t
 *
˛ass
, 
¢d_mixî_t
 *
mixî
)

529 
li°_hód
 *
pos
;

530 
˛ass
->
mixî
 = mixer;

531 
	`li°_add_èû
(&
˛ass
->
li°
, &
mixî
->
˛as£s
);

532 i‡(!
˛ass
->
evít
)

534 
	`li°_f‹_óch
(
pos
, &
mixî
->
¶aves
) {

535 
îr
;

536 
¢d_mixî_¶ave_t
 *
¶ave
;

537 
¢d_h˘l_ñem_t
 *
ñem
;

538 
¶ave
 = 
	`li°_íåy
(
pos
, 
¢d_mixî_¶ave_t
, 
li°
);

539 
ñem
 = 
	`¢d_h˘l_fú°_ñem
(
¶ave
->
h˘l
);

540 
ñem
) {

541 
îr
 = 
˛ass
->
	`evít
(˛ass, 
SND_CTL_EVENT_MASK_ADD
, 
ñem
, 
NULL
);

542 i‡(
îr
 < 0)

543  
îr
;

544 
ñem
 = 
	`¢d_h˘l_ñem_√xt
(elem);

548 
	}
}

557 
	$¢d_mixî_˛ass_uƒegi°î
(
¢d_mixî_˛ass_t
 *
˛ass
)

559 
k
;

560 
¢d_mixî_ñem_t
 *
e
;

561 
¢d_mixî_t
 *
mixî
 = 
˛ass
->mixer;

562 
k
 = 
mixî
->
cou¡
; k > 0; k--) {

563 
e
 = 
mixî
->
≥Àms
[
k
-1];

564 i‡(
e
->
˛ass
 == class)

565 
	`¢d_mixî_ñem_ªmove
(
e
);

567 i‡(
˛ass
->
¥iv©e_‰ì
)

568 
˛ass
->
	`¥iv©e_‰ì
(class);

569 
	`li°_dñ
(&
˛ass
->
li°
);

570 
	`‰ì
(
˛ass
);

572 
	}
}

579 
	$¢d_mixî_lﬂd
(
¢d_mixî_t
 *
mixî
)

581 
li°_hód
 *
pos
;

582 
	`li°_f‹_óch
(
pos
, &
mixî
->
¶aves
) {

583 
îr
;

584 
¢d_mixî_¶ave_t
 *
s
;

585 
s
 = 
	`li°_íåy
(
pos
, 
¢d_mixî_¶ave_t
, 
li°
);

586 
îr
 = 
	`¢d_h˘l_lﬂd
(
s
->
h˘l
);

587 i‡(
îr
 < 0)

588  
îr
;

591 
	}
}

597 
	$¢d_mixî_‰ì
(
¢d_mixî_t
 *
mixî
)

599 
li°_hód
 *
pos
;

600 
	`li°_f‹_óch
(
pos
, &
mixî
->
¶aves
) {

601 
¢d_mixî_¶ave_t
 *
s
;

602 
s
 = 
	`li°_íåy
(
pos
, 
¢d_mixî_¶ave_t
, 
li°
);

603 
	`¢d_h˘l_‰ì
(
s
->
h˘l
);

605 
	}
}

612 
	$¢d_mixî_˛o£
(
¢d_mixî_t
 *
mixî
)

614 
ªs
 = 0;

615 
	`as£π
(
mixî
);

616 !
	`li°_em±y
(&
mixî
->
˛as£s
)) {

617 
¢d_mixî_˛ass_t
 *
c
;

618 
c
 = 
	`li°_íåy
(
mixî
->
˛as£s
.
√xt
, 
¢d_mixî_˛ass_t
, 
li°
);

619 
	`¢d_mixî_˛ass_uƒegi°î
(
c
);

621 
	`as£π
(
	`li°_em±y
(&
mixî
->
ñems
));

622 
	`as£π
(
mixî
->
cou¡
 == 0);

623 
	`‰ì
(
mixî
->
≥Àms
);

624 
mixî
->
≥Àms
 = 
NULL
;

625 !
	`li°_em±y
(&
mixî
->
¶aves
)) {

626 
îr
;

627 
¢d_mixî_¶ave_t
 *
s
;

628 
s
 = 
	`li°_íåy
(
mixî
->
¶aves
.
√xt
, 
¢d_mixî_¶ave_t
, 
li°
);

629 
îr
 = 
	`¢d_h˘l_˛o£
(
s
->
h˘l
);

630 i‡(
îr
 < 0)

631 
ªs
 = 
îr
;

632 
	`li°_dñ
(&
s
->
li°
);

633 
	`‰ì
(
s
);

635 
	`‰ì
(
mixî
);

636  
ªs
;

637 
	}
}

639 
	$¢d_mixî_com∑ª_deÁu…
(c⁄° 
¢d_mixî_ñem_t
 *
c1
,

640 c⁄° 
¢d_mixî_ñem_t
 *
c2
)

642 
d
 = 
c1
->
com∑ª_weight
 - 
c2
->compare_weight;

643 i‡(
d
)

644  
d
;

645 
	`as£π
(
c1
->
˛ass
 && c1->˛ass->
com∑ª
);

646 
	`as£π
(
c2
->
˛ass
 && c2->˛ass->
com∑ª
);

647 
	`as£π
(
c1
->
˛ass
 =
c2
->class);

648  
c1
->
˛ass
->
	`com∑ª
(c1, 
c2
);

649 
	}
}

651 
	$mixî_com∑ª
(c⁄° *
a
, c⁄° *
b
)

653 
¢d_mixî_t
 *
mixî
;

655 
mixî
 = (*((c⁄° 
¢d_mixî_ñem_t
 * c⁄° *)
a
))->
˛ass
->mixer;

656  
mixî
->
	`com∑ª
(*(c⁄° 
¢d_mixî_ñem_t
 * c⁄° *)
a
, *(c⁄° snd_mixî_ñem_à* c⁄° *)
b
);

657 
	}
}

659 
	$¢d_mixî_s‹t
(
¢d_mixî_t
 *
mixî
)

661 
k
;

662 
	`as£π
(
mixî
);

663 
	`as£π
(
mixî
->
com∑ª
);

664 
	`INIT_LIST_HEAD
(&
mixî
->
ñems
);

665 
	`qs‹t
(
mixî
->
≥Àms
, mixî->
cou¡
, (
¢d_mixî_ñem_t
 *), 
mixî_com∑ª
);

666 
k
 = 0; k < 
mixî
->
cou¡
; k++)

667 
	`li°_add_èû
(&
mixî
->
≥Àms
[
k
]->
li°
, &mixî->
ñems
);

669 
	}
}

677 
	$¢d_mixî_£t_com∑ª
(
¢d_mixî_t
 *
mixî
, 
¢d_mixî_com∑ª_t
 
com∑ª
)

679 
¢d_mixî_com∑ª_t
 
com∑ª_ﬁd
;

680 
îr
;

682 
	`as£π
(
mixî
);

683 
com∑ª_ﬁd
 = 
mixî
->
com∑ª
;

684 
mixî
->
com∑ª
 = com∑ª =
NULL
 ? 
¢d_mixî_com∑ª_deÁu…
 : compare;

685 i‡((
îr
 = 
	`¢d_mixî_s‹t
(
mixî
)) < 0) {

686 
mixî
->
com∑ª
 = 
com∑ª_ﬁd
;

687  
îr
;

690 
	}
}

697 
	$¢d_mixî_pﬁl_des¸ùt‹s_cou¡
(
¢d_mixî_t
 *
mixî
)

699 
li°_hód
 *
pos
;

700 
c
 = 0;

701 
	`as£π
(
mixî
);

702 
	`li°_f‹_óch
(
pos
, &
mixî
->
¶aves
) {

703 
¢d_mixî_¶ave_t
 *
s
;

704 
n
;

705 
s
 = 
	`li°_íåy
(
pos
, 
¢d_mixî_¶ave_t
, 
li°
);

706 
n
 = 
	`¢d_h˘l_pﬁl_des¸ùt‹s_cou¡
(
s
->
h˘l
);

707 i‡(
n
 < 0)

708  
n
;

709 
c
 +
n
;

711  
c
;

712 
	}
}

721 
	$¢d_mixî_pﬁl_des¸ùt‹s
(
¢d_mixî_t
 *
mixî
, 
pﬁlfd
 *
pfds
, 
•a˚
)

723 
li°_hód
 *
pos
;

724 
cou¡
 = 0;

725 
	`as£π
(
mixî
);

726 
	`li°_f‹_óch
(
pos
, &
mixî
->
¶aves
) {

727 
¢d_mixî_¶ave_t
 *
s
;

728 
n
;

729 
s
 = 
	`li°_íåy
(
pos
, 
¢d_mixî_¶ave_t
, 
li°
);

730 
n
 = 
	`¢d_h˘l_pﬁl_des¸ùt‹s
(
s
->
h˘l
, 
pfds
, 
•a˚
);

731 i‡(
n
 < 0)

732  
n
;

733 i‡(
•a˚
 >(Ë
n
) {

734 
cou¡
 +
n
;

735 
•a˚
 -
n
;

736 
pfds
 +
n
;

738 
•a˚
 = 0;

740  
cou¡
;

741 
	}
}

751 
	$¢d_mixî_pﬁl_des¸ùt‹s_ªvíts
(
¢d_mixî_t
 *
mixî
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

753 
idx
;

754 
ªs
;

755 
	`as£π
(
mixî
 && 
pfds
 && 
ªvíts
);

756 i‡(
nfds
 == 0)

757  -
EINVAL
;

758 
ªs
 = 0;

759 
idx
 = 0; idx < 
nfds
; idx++, 
pfds
++)

760 
ªs
 |
pfds
->
ªvíts
 & (
POLLIN
|
POLLERR
|
POLLNVAL
);

761 *
ªvíts
 = 
ªs
;

763 
	}
}

771 
	$¢d_mixî_waô
(
¢d_mixî_t
 *
mixî
, 
timeout
)

773 
pﬁlfd
 
•fds
[16];

774 
pﬁlfd
 *
pfds
 = 
•fds
;

775 
îr
;

776 
cou¡
;

777 
cou¡
 = 
	`¢d_mixî_pﬁl_des¸ùt‹s
(
mixî
, 
pfds
, (
•fds
) / (spfds[0]));

778 i‡(
cou¡
 < 0)

779  
cou¡
;

780 i‡((Ë
cou¡
 > (
•fds
) / (spfds[0])) {

781 
pfds
 = 
	`Æloˇ
(
cou¡
 * (*pfds));

782 i‡(!
pfds
)

783  -
ENOMEM
;

784 
îr
 = 
	`¢d_mixî_pﬁl_des¸ùt‹s
(
mixî
, 
pfds
,

785 (Ë
cou¡
);

786 
	`as£π
(
îr
 =
cou¡
);

788 
îr
 = 
	`pﬁl
(
pfds
, (Ë
cou¡
, 
timeout
);

789 i‡(
îr
 < 0)

790  -
î∫o
;

792 
	}
}

799 
¢d_mixî_ñem_t
 *
	$¢d_mixî_fú°_ñem
(
¢d_mixî_t
 *
mixî
)

801 
	`as£π
(
mixî
);

802 i‡(
	`li°_em±y
(&
mixî
->
ñems
))

803  
NULL
;

804  
	`li°_íåy
(
mixî
->
ñems
.
√xt
, 
¢d_mixî_ñem_t
, 
li°
);

805 
	}
}

812 
¢d_mixî_ñem_t
 *
	$¢d_mixî_œ°_ñem
(
¢d_mixî_t
 *
mixî
)

814 
	`as£π
(
mixî
);

815 i‡(
	`li°_em±y
(&
mixî
->
ñems
))

816  
NULL
;

817  
	`li°_íåy
(
mixî
->
ñems
.
¥ev
, 
¢d_mixî_ñem_t
, 
li°
);

818 
	}
}

825 
¢d_mixî_ñem_t
 *
	$¢d_mixî_ñem_√xt
(
¢d_mixî_ñem_t
 *
ñem
)

827 
	`as£π
(
ñem
);

828 i‡(
ñem
->
li°
.
√xt
 =&ñem->
˛ass
->
mixî
->
ñems
)

829  
NULL
;

830  
	`li°_íåy
(
ñem
->
li°
.
√xt
, 
¢d_mixî_ñem_t
,Üist);

831 
	}
}

838 
¢d_mixî_ñem_t
 *
	$¢d_mixî_ñem_¥ev
(
¢d_mixî_ñem_t
 *
ñem
)

840 
	`as£π
(
ñem
);

841 i‡(
ñem
->
li°
.
¥ev
 =&ñem->
˛ass
->
mixî
->
ñems
)

842  
NULL
;

843  
	`li°_íåy
(
ñem
->
li°
.
¥ev
, 
¢d_mixî_ñem_t
,Üist);

844 
	}
}

851 
	$¢d_mixî_h™dÀ_evíts
(
¢d_mixî_t
 *
mixî
)

853 
li°_hód
 *
pos
;

854 
	`as£π
(
mixî
);

855 
mixî
->
evíts
 = 0;

856 
	`li°_f‹_óch
(
pos
, &
mixî
->
¶aves
) {

857 
îr
;

858 
¢d_mixî_¶ave_t
 *
s
;

859 
s
 = 
	`li°_íåy
(
pos
, 
¢d_mixî_¶ave_t
, 
li°
);

860 
îr
 = 
	`¢d_h˘l_h™dÀ_evíts
(
s
->
h˘l
);

861 i‡(
îr
 < 0)

862  
îr
;

864  
mixî
->
evíts
;

865 
	}
}

872 
	$¢d_mixî_£t_ˇŒback
(
¢d_mixî_t
 *
obj
, 
¢d_mixî_ˇŒback_t
 
vÆ
)

874 
	`as£π
(
obj
);

875 
obj
->
ˇŒback
 = 
vÆ
;

876 
	}
}

883 
	$¢d_mixî_£t_ˇŒback_¥iv©e
(
¢d_mixî_t
 *
mixî
, * 
vÆ
)

885 
	`as£π
(
mixî
);

886 
mixî
->
ˇŒback_¥iv©e
 = 
vÆ
;

887 
	}
}

894 * 
	$¢d_mixî_gë_ˇŒback_¥iv©e
(c⁄° 
¢d_mixî_t
 *
mixî
)

896 
	`as£π
(
mixî
);

897  
mixî
->
ˇŒback_¥iv©e
;

898 
	}
}

905 
	$¢d_mixî_gë_cou¡
(c⁄° 
¢d_mixî_t
 *
mixî
)

907 
	`as£π
(
mixî
);

908  
mixî
->
cou¡
;

909 
	}
}

916 
	$¢d_mixî_ñem_£t_ˇŒback
(
¢d_mixî_ñem_t
 *
mixî
, 
¢d_mixî_ñem_ˇŒback_t
 
vÆ
)

918 
	`as£π
(
mixî
);

919 
mixî
->
ˇŒback
 = 
vÆ
;

920 
	}
}

927 
	$¢d_mixî_ñem_£t_ˇŒback_¥iv©e
(
¢d_mixî_ñem_t
 *
mixî
, * 
vÆ
)

929 
	`as£π
(
mixî
);

930 
mixî
->
ˇŒback_¥iv©e
 = 
vÆ
;

931 
	}
}

938 * 
	$¢d_mixî_ñem_gë_ˇŒback_¥iv©e
(c⁄° 
¢d_mixî_ñem_t
 *
mixî
)

940 
	`as£π
(
mixî
);

941  
mixî
->
ˇŒback_¥iv©e
;

942 
	}
}

949 
¢d_mixî_ñem_ty≥_t
 
	$¢d_mixî_ñem_gë_ty≥
(c⁄° 
¢d_mixî_ñem_t
 *
mixî
)

951 
	`as£π
(
mixî
);

952  
mixî
->
ty≥
;

953 
	}
}

960 
size_t
 
	$¢d_mixî_˛ass_sizeof
()

962  (
¢d_mixî_˛ass_t
);

963 
	}
}

970 
	$¢d_mixî_˛ass_mÆloc
(
¢d_mixî_˛ass_t
 **
±r
)

972 
	`as£π
(
±r
);

973 *
±r
 = 
	`ˇŒoc
(1, (
¢d_mixî_˛ass_t
));

974 i‡(!*
±r
)

975  -
ENOMEM
;

977 
	}
}

983 
	$¢d_mixî_˛ass_‰ì
(
¢d_mixî_˛ass_t
 *
obj
)

985 i‡(
obj
->
¥iv©e_‰ì
)

986 
obj
->
	`¥iv©e_‰ì
(obj);

987 
	`‰ì
(
obj
);

988 
	}
}

995 
	$¢d_mixî_˛ass_c›y
(
¢d_mixî_˛ass_t
 *
d°
, c⁄° snd_mixî_˛ass_à*
§c
)

997 
	`as£π
(
d°
 && 
§c
);

998 *
d°
 = *
§c
;

999 
	}
}

1006 
¢d_mixî_t
 *
	$¢d_mixî_˛ass_gë_mixî
(c⁄° 
¢d_mixî_˛ass_t
 *
obj
)

1008 
	`as£π
(
obj
);

1009  
obj
->
mixî
;

1010 
	}
}

1017 
¢d_mixî_evít_t
 
	$¢d_mixî_˛ass_gë_evít
(c⁄° 
¢d_mixî_˛ass_t
 *
obj
)

1019 
	`as£π
(
obj
);

1020  
obj
->
evít
;

1021 
	}
}

1028 *
	$¢d_mixî_˛ass_gë_¥iv©e
(c⁄° 
¢d_mixî_˛ass_t
 *
obj
)

1030 
	`as£π
(
obj
);

1031  
obj
->
¥iv©e_d©a
;

1032 
	}
}

1040 
¢d_mixî_com∑ª_t
 
	$¢d_mixî_˛ass_gë_com∑ª
(c⁄° 
¢d_mixî_˛ass_t
 *
obj
)

1042 
	`as£π
(
obj
);

1043  
obj
->
com∑ª
;

1044 
	}
}

1052 
	$¢d_mixî_˛ass_£t_evít
(
¢d_mixî_˛ass_t
 *
obj
, 
¢d_mixî_evít_t
 
evít
)

1054 
	`as£π
(
obj
);

1055 
obj
->
evít
 =Évent;

1057 
	}
}

1065 
	$¢d_mixî_˛ass_£t_¥iv©e
(
¢d_mixî_˛ass_t
 *
obj
, *
¥iv©e_d©a
)

1067 
	`as£π
(
obj
);

1068 
obj
->
¥iv©e_d©a
 =Örivate_data;

1070 
	}
}

1078 
¢d_mixî_˛ass_£t_¥iv©e_‰ì
(
¢d_mixî_˛ass_t
 *
obj
, (*
¥iv©e_‰ì
)(snd_mixer_class_t *))

1080 
	`as£π
(
obj
);

1081 
obj
->
¥iv©e_‰ì
 =Örivate_free;

1083 
	}
}

1091 
	$¢d_mixî_˛ass_£t_com∑ª
(
¢d_mixî_˛ass_t
 *
obj
, 
¢d_mixî_com∑ª_t
 
com∑ª
)

1093 
	`as£π
(
obj
);

1094 
obj
->
com∑ª
 = compare;

1096 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/mixer_local.h

23 
	~"loˇl.h
"

25 
	s_bag1
 {

26 *
	m±r
;

27 
li°_hód
 
	mli°
;

28 } 
	tbag1_t
;

30 
li°_hód
 
	tbag_t
;

32 
bag_√w
(
bag_t
 **
bag
);

33 
bag_‰ì
(
bag_t
 *
bag
);

34 
bag_add
(
bag_t
 *
bag
, *
±r
);

35 
bag_dñ
(
bag_t
 *
bag
, *
±r
);

36 
bag_em±y
(
bag_t
 *
bag
);

37 
bag_dñ_Æl
(
bag_t
 *
bag
);

39 
li°_hód
 *
	tbag_ôî©‹_t
;

41 
	#bag_ôî©‹_íåy
(
i
Ë(
	`li°_íåy
((i), 
bag1_t
, 
li°
)->
±r
)

	)

42 
	#bag_f‹_óch
(
pos
, 
bag
Ë
	`li°_f‹_óch
’os, bag)

	)

43 
	#bag_f‹_óch_ß„
(
pos
, 
√xt
, 
bag
Ë
	`li°_f‹_óch_ß„
’os,Çext, bag)

	)

45 
	s_¢d_mixî_˛ass
 {

46 
li°_hód
 
	mli°
;

47 
¢d_mixî_t
 *
	mmixî
;

48 
¢d_mixî_evít_t
 
	mevít
;

49 *
	m¥iv©e_d©a
;

50 (*
	m¥iv©e_‰ì
)(
¢d_mixî_˛ass_t
 *
	m˛ass
);

51 
¢d_mixî_com∑ª_t
 
	mcom∑ª
;

54 
	s_¢d_mixî_ñem
 {

55 
¢d_mixî_ñem_ty≥_t
 
	mty≥
;

56 
li°_hód
 
	mli°
;

57 
¢d_mixî_˛ass_t
 *
	m˛ass
;

58 *
	m¥iv©e_d©a
;

59 (*
	m¥iv©e_‰ì
)(
¢d_mixî_ñem_t
 *
	mñem
);

60 
¢d_mixî_ñem_ˇŒback_t
 
	mˇŒback
;

61 *
	mˇŒback_¥iv©e
;

62 
bag_t
 
	mhñems
;

63 
	mcom∑ª_weight
;

66 
	s_¢d_mixî
 {

67 
li°_hód
 
	m¶aves
;

68 
li°_hód
 
	m˛as£s
;

69 
li°_hód
 
	mñems
;

70 
¢d_mixî_ñem_t
 **
	m≥Àms
;

71 
	mcou¡
;

72 
	mÆloc
;

73 
	mevíts
;

74 
¢d_mixî_ˇŒback_t
 
	mˇŒback
;

75 *
	mˇŒback_¥iv©e
;

76 
¢d_mixî_com∑ª_t
 
	mcom∑ª
;

79 
	s_¢d_mixî_£Àm_id
 {

80 
	m«me
[60];

81 
	mödex
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/mixer_simple.h

22 
	~"mixî_ab°.h
"

25 
	#¢d_mixî_sim∂e_n⁄e_ªgi°î
 \

26 
¢d1_mixî_sim∂e_n⁄e_ªgi°î


	)

27 
	#¢d_mixî_sim∂e_basic_ªgi°î
 \

28 
¢d1_mixî_sim∂e_basic_ªgi°î


	)

30 
¢d_mixî_sim∂e_n⁄e_ªgi°î
(
¢d_mixî_t
 *
mixî
, 
¢d_mixî_£Àm_ªg›t
 *
›ti⁄s
, 
¢d_mixî_˛ass_t
 **
˛as•
);

32 #ifde‡
HAVE_LIBDL


33 
¢d_mixî_sim∂e_basic_ªgi°î
(
¢d_mixî_t
 *
mixî
, 
¢d_mixî_£Àm_ªg›t
 *
›ti⁄s
, 
¢d_mixî_˛ass_t
 **
˛as•
);

35 
ölöe
 
	$¢d_mixî_sim∂e_basic_ªgi°î
(
¢d_mixî_t
 *
mixî
 
ATTRIBUTE_UNUSED
,

36 
¢d_mixî_£Àm_ªg›t
 *
›ti⁄s
 
ATTRIBUTE_UNUSED
,

37 
¢d_mixî_˛ass_t
 **
˛as•
 
ATTRIBUTE_UNUSED
)

39  -
ENXIO
;

40 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/simple.c

32 
	~"mixî_loˇl.h
"

33 
	~"mixî_sim∂e.h
"

34 
	~<°dio.h
>

35 
	~<°dlib.h
>

36 
	~<uni°d.h
>

37 
	~<°rög.h
>

38 
	~<f˙é.h
>

39 
	~<sys/io˘l.h
>

40 
	~<m©h.h
>

49 
	$¢d_mixî_£Àm_ªgi°î
(
¢d_mixî_t
 *
mixî
,

50 
¢d_mixî_£Àm_ªg›t
 *
›ti⁄s
,

51 
¢d_mixî_˛ass_t
 **
˛as•
)

53 i‡(
›ti⁄s
 && o±i⁄s->
vî
 == 1) {

54 i‡(
›ti⁄s
->
devi˚
 !
NULL
 &&

55 (
›ti⁄s
->
∂ayback_pcm
 !
NULL
 ||

56 
›ti⁄s
->
ˇ±uª_pcm
 !
NULL
))

57  -
EINVAL
;

58 i‡(
›ti⁄s
->
devi˚
 =
NULL
 &&

59 
›ti⁄s
->
∂ayback_pcm
 =
NULL
 &&

60 
›ti⁄s
->
ˇ±uª_pcm
 =
NULL
)

61  -
EINVAL
;

63 i‡(
›ti⁄s
 =
NULL
 ||

64 (
›ti⁄s
->
vî
 =1 && o±i⁄s->
ab°ø˘
 =
SND_MIXER_SABSTRACT_NONE
)) {

65 
îr
 = 
	`¢d_mixî_sim∂e_n⁄e_ªgi°î
(
mixî
, 
›ti⁄s
, 
˛as•
);

66 i‡(
îr
 < 0)

67  
îr
;

68 i‡(
›ti⁄s
 !
NULL
) {

69 
îr
 = 
	`¢d_mixî_©èch
(
mixî
, 
›ti⁄s
->
devi˚
);

70 i‡(
îr
 < 0)

71  
îr
;

74 } i‡(
›ti⁄s
->
vî
 == 1) {

75 i‡(
›ti⁄s
->
ab°ø˘
 =
SND_MIXER_SABSTRACT_BASIC
)

76  
	`¢d_mixî_sim∂e_basic_ªgi°î
(
mixî
, 
›ti⁄s
, 
˛as•
);

78  -
ENXIO
;

79 
	}
}

81 #i‚de‡
DOC_HIDDEN


83 
	#CHECK_BASIC
(
xñem
) \

85 
	`as£π
(
xñem
); \

86 
	`as£π
((
xñem
)->
ty≥
 =
SND_MIXER_ELEM_SIMPLE
); \

87 }

	)

89 
	#CHECK_DIR
(
xñem
, 
xwh©
) \

91 
xˇps
 = ((
sm_£Àm_t
 *)(
ñem
)->
¥iv©e_d©a
)->
ˇps
; \

92 i‡(! (
xˇps
 & (
xwh©
))) \

93  -
EINVAL
; \

94 }

	)

96 
	#CHECK_DIR_CHN
(
xñem
, 
xwh©
, 
xjoö
, 
xch™√l
) \

98 
xˇps
 = ((
sm_£Àm_t
 *)(
ñem
)->
¥iv©e_d©a
)->
ˇps
; \

99 i‡(! (
xˇps
 & (
xwh©
))) \

100  -
EINVAL
; \

101 i‡(
xˇps
 & (
xjoö
)) \

102 
xch™√l
 = 0; \

103 }

	)

105 
	#CHECK_ENUM
(
xñem
) \

106 i‡(!(((
sm_£Àm_t
 *)(
ñem
)->
¥iv©e_d©a
)->
ˇps
 & (
SM_CAP_PENUM
|
SM_CAP_CENUM
))) \

107  -
EINVAL
;

	)

109 
	#COND_CAPS
(
xñem
, 
wh©
) \

110 !!(((
sm_£Àm_t
 *)(
ñem
)->
¥iv©e_d©a
)->
ˇps
 & (
wh©
))

	)

114 #i‚de‡
DOC_HIDDEN


115 
	$¢d_mixî_£Àm_com∑ª
(c⁄° 
¢d_mixî_ñem_t
 *
c1
, c⁄° snd_mixî_ñem_à*
c2
)

117 
sm_£Àm_t
 *
s1
 = 
c1
->
¥iv©e_d©a
;

118 
sm_£Àm_t
 *
s2
 = 
c2
->
¥iv©e_d©a
;

119 
ªs
 = 
	`°rcmp
(
s1
->
id
->
«me
, 
s2
->id->name);

120 i‡(
ªs
)

121  
ªs
;

122  
s1
->
id
->
ödex
 - 
s2
->id->index;

123 
	}
}

132 
¢d_mixî_ñem_t
 *
	$¢d_mixî_föd_£Àm
(
¢d_mixî_t
 *
mixî
,

133 c⁄° 
¢d_mixî_£Àm_id_t
 *
id
)

135 
li°_hód
 *
li°
;

136 
¢d_mixî_ñem_t
 *
e
;

137 
sm_£Àm_t
 *
s
;

139 
	`li°_f‹_óch
(
li°
, &
mixî
->
ñems
) {

140 
e
 = 
	`li°_íåy
(
li°
, 
¢d_mixî_ñem_t
,Üist);

141 i‡(
e
->
ty≥
 !
SND_MIXER_ELEM_SIMPLE
)

143 
s
 = 
e
->
¥iv©e_d©a
;

144 i‡(!
	`°rcmp
(
s
->
id
->
«me
, id->«meË&& s->id->
ödex
 == id->index)

145  
e
;

147  
NULL
;

148 
	}
}

155 
	$¢d_mixî_£Àm_gë_id
(
¢d_mixî_ñem_t
 *
ñem
,

156 
¢d_mixî_£Àm_id_t
 *
id
)

158 
sm_£Àm_t
 *
s
;

159 
	`as£π
(
id
);

160 
	`CHECK_BASIC
(
ñem
);

161 
s
 = 
ñem
->
¥iv©e_d©a
;

162 *
id
 = *
s
->id;

163 
	}
}

170 c⁄° *
	$¢d_mixî_£Àm_gë_«me
(
¢d_mixî_ñem_t
 *
ñem
)

172 
sm_£Àm_t
 *
s
;

173 
	`CHECK_BASIC
(
ñem
);

174 
s
 = 
ñem
->
¥iv©e_d©a
;

175  
s
->
id
->
«me
;

176 
	}
}

183 
	$¢d_mixî_£Àm_gë_ödex
(
¢d_mixî_ñem_t
 *
ñem
)

185 
sm_£Àm_t
 *
s
;

186 
	`CHECK_BASIC
(
ñem
);

187 
s
 = 
ñem
->
¥iv©e_d©a
;

188  
s
->
id
->
ödex
;

189 
	}
}

196 
	$¢d_mixî_£Àm_has_comm⁄_vﬁume
(
¢d_mixî_ñem_t
 *
ñem
)

198 
	`CHECK_BASIC
(
ñem
);

199  
	`COND_CAPS
(
ñem
, 
SM_CAP_GVOLUME
);

200 
	}
}

207 
	$¢d_mixî_£Àm_has_comm⁄_swôch
(
¢d_mixî_ñem_t
 *
ñem
)

209 
	`CHECK_BASIC
(
ñem
);

210  
	`COND_CAPS
(
ñem
, 
SM_CAP_GSWITCH
);

211 
	}
}

218 c⁄° *
	$¢d_mixî_£Àm_ch™√l_«me
(
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
)

220 c⁄° *c⁄° 
¨øy
[
SND_MIXER_SCHN_LAST
 + 1] = {

221 [
SND_MIXER_SCHN_FRONT_LEFT
] = "Front Left",

222 [
SND_MIXER_SCHN_FRONT_RIGHT
] = "Front Right",

223 [
SND_MIXER_SCHN_REAR_LEFT
] = "Rear Left",

224 [
SND_MIXER_SCHN_REAR_RIGHT
] = "Rear Right",

225 [
SND_MIXER_SCHN_FRONT_CENTER
] = "Front Center",

226 [
SND_MIXER_SCHN_WOOFER
] = "Woofer",

227 [
SND_MIXER_SCHN_SIDE_LEFT
] = "Side Left",

228 [
SND_MIXER_SCHN_SIDE_RIGHT
] = "Side Right",

229 [
SND_MIXER_SCHN_REAR_CENTER
] = "Rear Center"

231 c⁄° *
p
;

232 
	`as£π
(
ch™√l
 <
SND_MIXER_SCHN_LAST
);

233 
p
 = 
¨øy
[
ch™√l
];

234 i‡(!
p
)

236  
p
;

237 
	}
}

244 
	$¢d_mixî_£Àm_is_a˘ive
(
¢d_mixî_ñem_t
 *
ñem
)

246 
	`CHECK_BASIC
(
ñem
);

247  
	`sm_£Àm_›s
(
ñem
)->
	`is
”Àm, 
SM_PLAY
, 
SM_OPS_IS_ACTIVE
, 0);

248 
	}
}

255 
	$¢d_mixî_£Àm_is_∂ayback_m⁄o
(
¢d_mixî_ñem_t
 *
ñem
)

257 
	`CHECK_BASIC
(
ñem
);

258  
	`sm_£Àm_›s
(
ñem
)->
	`is
”Àm, 
SM_PLAY
, 
SM_OPS_IS_MONO
, 0);

259 
	}
}

267 
	$¢d_mixî_£Àm_has_∂ayback_ch™√l
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
)

269 
	`CHECK_BASIC
(
ñem
);

270  
	`sm_£Àm_›s
(
ñem
)->
	`is
”Àm, 
SM_PLAY
, 
SM_OPS_IS_CHANNEL
, ()
ch™√l
);

271 
	}
}

279 
	$¢d_mixî_£Àm_gë_∂ayback_vﬁume_ønge
(
¢d_mixî_ñem_t
 *
ñem
,

280 *
mö
, *
max
)

282 
	`CHECK_BASIC
(
ñem
);

283 
	`CHECK_DIR
(
ñem
, 
SM_CAP_PVOLUME
);

284  
	`sm_£Àm_›s
(
ñem
)->
	`gë_ønge
”Àm, 
SM_PLAY
, 
mö
, 
max
);

285 
	}
}

293 
	$¢d_mixî_£Àm_gë_∂ayback_dB_ønge
(
¢d_mixî_ñem_t
 *
ñem
,

294 *
mö
, *
max
)

296 
	`CHECK_BASIC
(
ñem
);

297 
	`CHECK_DIR
(
ñem
, 
SM_CAP_PVOLUME
);

298  
	`sm_£Àm_›s
(
ñem
)->
	`gë_dB_ønge
”Àm, 
SM_PLAY
, 
mö
, 
max
);

299 
	}
}

307 
	$¢d_mixî_£Àm_£t_∂ayback_vﬁume_ønge
(
¢d_mixî_ñem_t
 *
ñem
,

308 
mö
, 
max
)

310 
	`CHECK_BASIC
(
ñem
);

311 
	`as£π
(
mö
 < 
max
);

312 
	`CHECK_DIR
(
ñem
, 
SM_CAP_PVOLUME
);

313  
	`sm_£Àm_›s
(
ñem
)->
	`£t_ønge
”Àm, 
SM_PLAY
, 
mö
, 
max
);

314 
	}
}

321 
	$¢d_mixî_£Àm_has_∂ayback_vﬁume
(
¢d_mixî_ñem_t
 *
ñem
)

323 
	`CHECK_BASIC
(
ñem
);

324  
	`COND_CAPS
(
ñem
, 
SM_CAP_PVOLUME
);

325 
	}
}

332 
	$¢d_mixî_£Àm_has_∂ayback_vﬁume_joöed
(
¢d_mixî_ñem_t
 *
ñem
)

334 
	`CHECK_BASIC
(
ñem
);

335  
	`COND_CAPS
(
ñem
, 
SM_CAP_PVOLUME_JOIN
);

336 
	}
}

343 
	$¢d_mixî_£Àm_has_∂ayback_swôch
(
¢d_mixî_ñem_t
 *
ñem
)

345 
	`CHECK_BASIC
(
ñem
);

346  
	`COND_CAPS
(
ñem
, 
SM_CAP_PSWITCH
);

347 
	}
}

354 
	$¢d_mixî_£Àm_has_∂ayback_swôch_joöed
(
¢d_mixî_ñem_t
 *
ñem
)

356 
	`CHECK_BASIC
(
ñem
);

357  
	`COND_CAPS
(
ñem
, 
SM_CAP_PSWITCH_JOIN
);

358 
	}
}

367 
	$¢d_mixî_£Àm_ask_∂ayback_vﬁ_dB
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
, *
dBvÆue
)

369 
	`CHECK_BASIC
(
ñem
);

370 
	`CHECK_DIR
(
ñem
, 
SM_CAP_PVOLUME
);

371  
	`sm_£Àm_›s
(
ñem
)->
	`ask_vﬁ_dB
”Àm, 
SM_PLAY
, 
vÆue
, 
dBvÆue
);

372 
	}
}

383 
	$¢d_mixî_£Àm_ask_∂ayback_dB_vﬁ
(
¢d_mixî_ñem_t
 *
ñem
, 
dBvÆue
, 
dú
, *
vÆue
)

385 
	`CHECK_BASIC
(
ñem
);

386 
	`CHECK_DIR
(
ñem
, 
SM_CAP_PVOLUME
);

387  
	`sm_£Àm_›s
(
ñem
)->
	`ask_dB_vﬁ
”Àm, 
SM_PLAY
, 
dBvÆue
, 
vÆue
, 
dú
);

388 
	}
}

397 
	$¢d_mixî_£Àm_gë_∂ayback_vﬁume
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
)

399 
	`CHECK_BASIC
(
ñem
);

400 
	`CHECK_DIR_CHN
(
ñem
, 
SM_CAP_PVOLUME
, 
SM_CAP_PVOLUME_JOIN
, 
ch™√l
);

401  
	`sm_£Àm_›s
(
ñem
)->
	`gë_vﬁume
”Àm, 
SM_PLAY
, 
ch™√l
, 
vÆue
);

402 
	}
}

411 
	$¢d_mixî_£Àm_gë_∂ayback_dB
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
)

413 
ˇps
;

415 
	`CHECK_BASIC
(
ñem
);

416 
ˇps
 = ((
sm_£Àm_t
 *)
ñem
->
¥iv©e_d©a
)->caps;

417 i‡(!(
ˇps
 & 
SM_CAP_PVOLUME
))

418  -
EINVAL
;

419 i‡(
ˇps
 & 
SM_CAP_PVOLUME_JOIN
)

420 
ch™√l
 = 0;

421  
	`sm_£Àm_›s
(
ñem
)->
	`gë_dB
”Àm, 
SM_PLAY
, 
ch™√l
, 
vÆue
);

422 
	}
}

431 
	$¢d_mixî_£Àm_gë_∂ayback_swôch
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
)

433 
	`CHECK_BASIC
(
ñem
);

434 
	`CHECK_DIR_CHN
(
ñem
, 
SM_CAP_PSWITCH
, 
SM_CAP_PSWITCH_JOIN
, 
ch™√l
);

435  
	`sm_£Àm_›s
(
ñem
)->
	`gë_swôch
”Àm, 
SM_PLAY
, 
ch™√l
, 
vÆue
);

436 
	}
}

445 
	$¢d_mixî_£Àm_£t_∂ayback_vﬁume
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
)

447 
	`CHECK_BASIC
(
ñem
);

448 
	`CHECK_DIR_CHN
(
ñem
, 
SM_CAP_PVOLUME
, 
SM_CAP_PVOLUME_JOIN
, 
ch™√l
);

449  
	`sm_£Àm_›s
(
ñem
)->
	`£t_vﬁume
”Àm, 
SM_PLAY
, 
ch™√l
, 
vÆue
);

450 
	}
}

461 
	$¢d_mixî_£Àm_£t_∂ayback_dB
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
, 
dú
)

463 
	`CHECK_BASIC
(
ñem
);

464 
	`CHECK_DIR_CHN
(
ñem
, 
SM_CAP_PVOLUME
, 
SM_CAP_PVOLUME_JOIN
, 
ch™√l
);

465  
	`sm_£Àm_›s
(
ñem
)->
	`£t_dB
”Àm, 
SM_PLAY
, 
ch™√l
, 
vÆue
, 
dú
);

466 
	}
}

474 
	$¢d_mixî_£Àm_£t_∂ayback_vﬁume_Æl
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
)

476 
¢d_mixî_£Àm_ch™√l_id_t
 
chn
;

477 
îr
;

479 
chn
 = 0; chn < 32; chn++) {

480 i‡(!
	`¢d_mixî_£Àm_has_∂ayback_ch™√l
(
ñem
, 
chn
))

482 
îr
 = 
	`¢d_mixî_£Àm_£t_∂ayback_vﬁume
(
ñem
, 
chn
, 
vÆue
);

483 i‡(
îr
 < 0)

484  
îr
;

485 i‡(
chn
 =0 && 
	`¢d_mixî_£Àm_has_∂ayback_vﬁume_joöed
(
ñem
))

489 
	}
}

499 
	$¢d_mixî_£Àm_£t_∂ayback_dB_Æl
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
, 
dú
)

501 
¢d_mixî_£Àm_ch™√l_id_t
 
chn
;

502 
îr
;

504 
chn
 = 0; chn < 32; chn++) {

505 i‡(!
	`¢d_mixî_£Àm_has_∂ayback_ch™√l
(
ñem
, 
chn
))

507 
îr
 = 
	`¢d_mixî_£Àm_£t_∂ayback_dB
(
ñem
, 
chn
, 
vÆue
, 
dú
);

508 i‡(
îr
 < 0)

509  
îr
;

510 i‡(
chn
 =0 && 
	`¢d_mixî_£Àm_has_∂ayback_vﬁume_joöed
(
ñem
))

514 
	}
}

523 
	$¢d_mixî_£Àm_£t_∂ayback_swôch
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
)

525 
	`CHECK_BASIC
(
ñem
);

526 
	`CHECK_DIR_CHN
(
ñem
, 
SM_CAP_PSWITCH
, 
SM_CAP_PSWITCH_JOIN
, 
ch™√l
);

527  
	`sm_£Àm_›s
(
ñem
)->
	`£t_swôch
”Àm, 
SM_PLAY
, 
ch™√l
, 
vÆue
);

528 
	}
}

536 
	$¢d_mixî_£Àm_£t_∂ayback_swôch_Æl
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
)

538 
¢d_mixî_£Àm_ch™√l_id_t
 
chn
;

539 
îr
;

541 
	`CHECK_BASIC
(
ñem
);

542 
chn
 = 0; chn < 32; chn++) {

543 i‡(!
	`¢d_mixî_£Àm_has_∂ayback_ch™√l
(
ñem
, 
chn
))

545 
îr
 = 
	`¢d_mixî_£Àm_£t_∂ayback_swôch
(
ñem
, 
chn
, 
vÆue
);

546 i‡(
îr
 < 0)

547  
îr
;

548 i‡(
chn
 =0 && 
	`¢d_mixî_£Àm_has_∂ayback_swôch_joöed
(
ñem
))

552 
	}
}

559 
	$¢d_mixî_£Àm_is_ˇ±uª_m⁄o
(
¢d_mixî_ñem_t
 *
ñem
)

561 
	`CHECK_BASIC
(
ñem
);

562 
	`CHECK_DIR
(
ñem
, 
SM_CAP_CVOLUME
|
SM_CAP_CSWITCH
);

563  
	`sm_£Àm_›s
(
ñem
)->
	`is
”Àm, 
SM_CAPT
, 
SM_OPS_IS_MONO
, 0);

564 
	}
}

572 
	$¢d_mixî_£Àm_has_ˇ±uª_ch™√l
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
)

574 
	`CHECK_BASIC
(
ñem
);

575 
	`CHECK_DIR
(
ñem
, 
SM_CAP_CVOLUME
|
SM_CAP_CSWITCH
);

576  
	`sm_£Àm_›s
(
ñem
)->
	`is
”Àm, 
SM_CAPT
, 
SM_OPS_IS_CHANNEL
, 
ch™√l
);

577 
	}
}

585 
	$¢d_mixî_£Àm_gë_ˇ±uª_vﬁume_ønge
(
¢d_mixî_ñem_t
 *
ñem
,

586 *
mö
, *
max
)

588 
	`CHECK_BASIC
(
ñem
);

589 
	`CHECK_DIR
(
ñem
, 
SM_CAP_CVOLUME
);

590  
	`sm_£Àm_›s
(
ñem
)->
	`gë_ønge
”Àm, 
SM_CAPT
, 
mö
, 
max
);

591 
	}
}

599 
	$¢d_mixî_£Àm_gë_ˇ±uª_dB_ønge
(
¢d_mixî_ñem_t
 *
ñem
,

600 *
mö
, *
max
)

602 
	`CHECK_BASIC
(
ñem
);

603 
	`CHECK_DIR
(
ñem
, 
SM_CAP_CVOLUME
);

604  
	`sm_£Àm_›s
(
ñem
)->
	`gë_dB_ønge
”Àm, 
SM_CAPT
, 
mö
, 
max
);

605 
	}
}

613 
	$¢d_mixî_£Àm_£t_ˇ±uª_vﬁume_ønge
(
¢d_mixî_ñem_t
 *
ñem
,

614 
mö
, 
max
)

616 
	`CHECK_BASIC
(
ñem
);

617 
	`as£π
(
mö
 < 
max
);

618 
	`CHECK_DIR
(
ñem
, 
SM_CAP_CVOLUME
);

619  
	`sm_£Àm_›s
(
ñem
)->
	`£t_ønge
”Àm, 
SM_CAPT
, 
mö
, 
max
);

620 
	}
}

627 
	$¢d_mixî_£Àm_has_ˇ±uª_vﬁume
(
¢d_mixî_ñem_t
 *
ñem
)

629 
	`CHECK_BASIC
(
ñem
);

630  
	`COND_CAPS
(
ñem
, 
SM_CAP_CVOLUME
);

631 
	}
}

638 
	$¢d_mixî_£Àm_has_ˇ±uª_vﬁume_joöed
(
¢d_mixî_ñem_t
 *
ñem
)

640 
	`CHECK_BASIC
(
ñem
);

641  
	`COND_CAPS
(
ñem
, 
SM_CAP_CVOLUME_JOIN
);

642 
	}
}

649 
	$¢d_mixî_£Àm_has_ˇ±uª_swôch
(
¢d_mixî_ñem_t
 *
ñem
)

651 
	`CHECK_BASIC
(
ñem
);

652  
	`COND_CAPS
(
ñem
, 
SM_CAP_CSWITCH
);

653 
	}
}

660 
	$¢d_mixî_£Àm_has_ˇ±uª_swôch_joöed
(
¢d_mixî_ñem_t
 *
ñem
)

662 
	`CHECK_BASIC
(
ñem
);

663  
	`COND_CAPS
(
ñem
, 
SM_CAP_CSWITCH_JOIN
);

664 
	}
}

671 
	$¢d_mixî_£Àm_has_ˇ±uª_swôch_ex˛usive
(
¢d_mixî_ñem_t
 *
ñem
)

673 
	`CHECK_BASIC
(
ñem
);

674  
	`COND_CAPS
(
ñem
, 
SM_CAP_CSWITCH_EXCL
);

675 
	}
}

682 
	$¢d_mixî_£Àm_gë_ˇ±uª_group
(
¢d_mixî_ñem_t
 *
ñem
)

684 
sm_£Àm_t
 *
s
;

685 
	`CHECK_BASIC
(
ñem
);

686 
s
 = 
ñem
->
¥iv©e_d©a
;

687 i‡(! (
s
->
ˇps
 & 
SM_CAP_CSWITCH_EXCL
))

688  -
EINVAL
;

689  
s
->
ˇ±uª_group
;

690 
	}
}

699 
	$¢d_mixî_£Àm_ask_ˇ±uª_vﬁ_dB
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
, *
dBvÆue
)

701 
	`CHECK_BASIC
(
ñem
);

702 
	`CHECK_DIR
(
ñem
, 
SM_CAP_CVOLUME
);

703  
	`sm_£Àm_›s
(
ñem
)->
	`ask_vﬁ_dB
”Àm, 
SM_CAPT
, 
vÆue
, 
dBvÆue
);

704 
	}
}

715 
	$¢d_mixî_£Àm_ask_ˇ±uª_dB_vﬁ
(
¢d_mixî_ñem_t
 *
ñem
, 
dBvÆue
, 
dú
, *
vÆue
)

717 
	`CHECK_BASIC
(
ñem
);

718 
	`CHECK_DIR
(
ñem
, 
SM_CAP_CVOLUME
);

719  
	`sm_£Àm_›s
(
ñem
)->
	`ask_dB_vﬁ
”Àm, 
SM_CAPT
, 
dBvÆue
, 
vÆue
, 
dú
);

720 
	}
}

729 
	$¢d_mixî_£Àm_gë_ˇ±uª_vﬁume
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
)

731 
	`CHECK_BASIC
(
ñem
);

732 
	`CHECK_DIR_CHN
(
ñem
, 
SM_CAP_CVOLUME
, 
SM_CAP_CVOLUME_JOIN
, 
ch™√l
);

733  
	`sm_£Àm_›s
(
ñem
)->
	`gë_vﬁume
”Àm, 
SM_CAPT
, 
ch™√l
, 
vÆue
);

734 
	}
}

743 
	$¢d_mixî_£Àm_gë_ˇ±uª_dB
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
)

745 
	`CHECK_BASIC
(
ñem
);

746 
	`CHECK_DIR_CHN
(
ñem
, 
SM_CAP_CVOLUME
, 
SM_CAP_CVOLUME_JOIN
, 
ch™√l
);

747  
	`sm_£Àm_›s
(
ñem
)->
	`gë_dB
”Àm, 
SM_CAPT
, 
ch™√l
, 
vÆue
);

748 
	}
}

757 
	$¢d_mixî_£Àm_gë_ˇ±uª_swôch
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
)

759 
	`CHECK_BASIC
(
ñem
);

760 
	`CHECK_DIR_CHN
(
ñem
, 
SM_CAP_CSWITCH
, 
SM_CAP_CSWITCH_JOIN
, 
ch™√l
);

761  
	`sm_£Àm_›s
(
ñem
)->
	`gë_swôch
”Àm, 
SM_CAPT
, 
ch™√l
, 
vÆue
);

762 
	}
}

771 
	$¢d_mixî_£Àm_£t_ˇ±uª_vﬁume
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
)

773 
	`CHECK_BASIC
(
ñem
);

774 
	`CHECK_DIR_CHN
(
ñem
, 
SM_CAP_CVOLUME
, 
SM_CAP_CVOLUME_JOIN
, 
ch™√l
);

775  
	`sm_£Àm_›s
(
ñem
)->
	`£t_vﬁume
”Àm, 
SM_CAPT
, 
ch™√l
, 
vÆue
);

776 
	}
}

787 
	$¢d_mixî_£Àm_£t_ˇ±uª_dB
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
, 
dú
)

789 
	`CHECK_BASIC
(
ñem
);

790 
	`CHECK_DIR_CHN
(
ñem
, 
SM_CAP_CVOLUME
, 
SM_CAP_CVOLUME_JOIN
, 
ch™√l
);

791  
	`sm_£Àm_›s
(
ñem
)->
	`£t_dB
”Àm, 
SM_CAPT
, 
ch™√l
, 
vÆue
, 
dú
);

792 
	}
}

800 
	$¢d_mixî_£Àm_£t_ˇ±uª_vﬁume_Æl
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
)

802 
¢d_mixî_£Àm_ch™√l_id_t
 
chn
;

803 
îr
;

805 
chn
 = 0; chn < 32; chn++) {

806 i‡(!
	`¢d_mixî_£Àm_has_ˇ±uª_ch™√l
(
ñem
, 
chn
))

808 
îr
 = 
	`¢d_mixî_£Àm_£t_ˇ±uª_vﬁume
(
ñem
, 
chn
, 
vÆue
);

809 i‡(
îr
 < 0)

810  
îr
;

811 i‡(
chn
 =0 && 
	`¢d_mixî_£Àm_has_ˇ±uª_vﬁume_joöed
(
ñem
))

815 
	}
}

825 
	$¢d_mixî_£Àm_£t_ˇ±uª_dB_Æl
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
, 
dú
)

827 
¢d_mixî_£Àm_ch™√l_id_t
 
chn
;

828 
îr
;

830 
chn
 = 0; chn < 32; chn++) {

831 i‡(!
	`¢d_mixî_£Àm_has_ˇ±uª_ch™√l
(
ñem
, 
chn
))

833 
îr
 = 
	`¢d_mixî_£Àm_£t_ˇ±uª_dB
(
ñem
, 
chn
, 
vÆue
, 
dú
);

834 i‡(
îr
 < 0)

835  
îr
;

836 i‡(
chn
 =0 && 
	`¢d_mixî_£Àm_has_ˇ±uª_vﬁume_joöed
(
ñem
))

840 
	}
}

849 
	$¢d_mixî_£Àm_£t_ˇ±uª_swôch
(
¢d_mixî_ñem_t
 *
ñem
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
)

851 
	`CHECK_BASIC
(
ñem
);

852 
	`CHECK_DIR_CHN
(
ñem
, 
SM_CAP_CSWITCH
, 
SM_CAP_CSWITCH_JOIN
, 
ch™√l
);

853  
	`sm_£Àm_›s
(
ñem
)->
	`£t_swôch
”Àm, 
SM_CAPT
, 
ch™√l
, 
vÆue
);

854 
	}
}

862 
	$¢d_mixî_£Àm_£t_ˇ±uª_swôch_Æl
(
¢d_mixî_ñem_t
 *
ñem
, 
vÆue
)

864 
¢d_mixî_£Àm_ch™√l_id_t
 
chn
;

865 
îr
;

867 
chn
 = 0; chn < 32; chn++) {

868 i‡(!
	`¢d_mixî_£Àm_has_ˇ±uª_ch™√l
(
ñem
, 
chn
))

870 
îr
 = 
	`¢d_mixî_£Àm_£t_ˇ±uª_swôch
(
ñem
, 
chn
, 
vÆue
);

871 i‡(
îr
 < 0)

872  
îr
;

873 i‡(
chn
 =0 && 
	`¢d_mixî_£Àm_has_ˇ±uª_swôch_joöed
(
ñem
))

877 
	}
}

884 
	$¢d_mixî_£Àm_is_íumî©ed
(
¢d_mixî_ñem_t
 *
ñem
)

886 
	`CHECK_BASIC
(
ñem
);

887  
	`sm_£Àm_›s
(
ñem
)->
	`is
”Àm, 
SM_PLAY
, 
SM_OPS_IS_ENUMERATED
, 0);

888 
	}
}

895 
	$¢d_mixî_£Àm_is_íum_∂ayback
(
¢d_mixî_ñem_t
 *
ñem
)

897 
	`CHECK_BASIC
(
ñem
);

898  
	`sm_£Àm_›s
(
ñem
)->
	`is
”Àm, 
SM_PLAY
, 
SM_OPS_IS_ENUMERATED
, 1);

899 
	}
}

906 
	$¢d_mixî_£Àm_is_íum_ˇ±uª
(
¢d_mixî_ñem_t
 *
ñem
)

908 
	`CHECK_BASIC
(
ñem
);

909  
	`sm_£Àm_›s
(
ñem
)->
	`is
”Àm, 
SM_CAPT
, 
SM_OPS_IS_ENUMERATED
, 1);

910 
	}
}

917 
	$¢d_mixî_£Àm_gë_íum_ôems
(
¢d_mixî_ñem_t
 *
ñem
)

919 
	`CHECK_BASIC
(
ñem
);

920 
	`CHECK_ENUM
(
ñem
);

921  
	`sm_£Àm_›s
(
ñem
)->
	`is
”Àm, 
SM_PLAY
, 
SM_OPS_IS_ENUMCNT
, 0);

922 
	}
}

932 
	$¢d_mixî_£Àm_gë_íum_ôem_«me
(
¢d_mixî_ñem_t
 *
ñem
,

933 
ôem
,

934 
size_t
 
maxÀn
, *
buf
)

936 
	`CHECK_BASIC
(
ñem
);

937 
	`CHECK_ENUM
(
ñem
);

938  
	`sm_£Àm_›s
(
ñem
)->
	`íum_ôem_«me
”Àm, 
ôem
, 
maxÀn
, 
buf
);

939 
	}
}

948 
	$¢d_mixî_£Àm_gë_íum_ôem
(
¢d_mixî_ñem_t
 *
ñem
,

949 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
,

950 *
ôemp
)

952 
	`CHECK_BASIC
(
ñem
);

953 
	`CHECK_ENUM
(
ñem
);

954  
	`sm_£Àm_›s
(
ñem
)->
	`gë_íum_ôem
”Àm, 
ch™√l
, 
ôemp
);

955 
	}
}

964 
	$¢d_mixî_£Àm_£t_íum_ôem
(
¢d_mixî_ñem_t
 *
ñem
,

965 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
,

966 
ôem
)

968 
	`CHECK_BASIC
(
ñem
);

969 
	`CHECK_ENUM
(
ñem
);

970  
	`sm_£Àm_›s
(
ñem
)->
	`£t_íum_ôem
”Àm, 
ch™√l
, 
ôem
);

971 
	}
}

977 
size_t
 
	$¢d_mixî_£Àm_id_sizeof
()

979  (
¢d_mixî_£Àm_id_t
);

980 
	}
}

987 
	$¢d_mixî_£Àm_id_mÆloc
(
¢d_mixî_£Àm_id_t
 **
±r
)

989 
	`as£π
(
±r
);

990 *
±r
 = 
	`ˇŒoc
(1, (
¢d_mixî_£Àm_id_t
));

991 i‡(!*
±r
)

992  -
ENOMEM
;

994 
	}
}

1000 
	$¢d_mixî_£Àm_id_‰ì
(
¢d_mixî_£Àm_id_t
 *
obj
)

1002 
	`‰ì
(
obj
);

1003 
	}
}

1010 
	$¢d_mixî_£Àm_id_c›y
(
¢d_mixî_£Àm_id_t
 *
d°
, c⁄° snd_mixî_£Àm_id_à*
§c
)

1012 
	`as£π
(
d°
 && 
§c
);

1013 *
d°
 = *
§c
;

1014 
	}
}

1021 c⁄° *
	$¢d_mixî_£Àm_id_gë_«me
(c⁄° 
¢d_mixî_£Àm_id_t
 *
obj
)

1023 
	`as£π
(
obj
);

1024  
obj
->
«me
;

1025 
	}
}

1032 
	$¢d_mixî_£Àm_id_gë_ödex
(c⁄° 
¢d_mixî_£Àm_id_t
 *
obj
)

1034 
	`as£π
(
obj
);

1035  
obj
->
ödex
;

1036 
	}
}

1043 
	$¢d_mixî_£Àm_id_£t_«me
(
¢d_mixî_£Àm_id_t
 *
obj
, c⁄° *
vÆ
)

1045 
	`as£π
(
obj
);

1046 
	`°∫˝y
(
obj
->
«me
, 
vÆ
, (obj->name));

1047 
obj
->
«me
[(obj->name)-1] = '\0';

1048 
	}
}

1055 
	$¢d_mixî_£Àm_id_£t_ödex
(
¢d_mixî_£Àm_id_t
 *
obj
, 
vÆ
)

1057 
	`as£π
(
obj
);

1058 
obj
->
ödex
 = 
vÆ
;

1059 
	}
}

1066 
	$¢d_mixî_£Àm_id_∑r£
(
¢d_mixî_£Àm_id_t
 *
d°
, c⁄° *
°r
)

1068 
c
, 
size
;

1069 
buf
[128];

1070 *
±r
 = 
buf
;

1072 
	`mem£t
(
d°
, 0, (*dst));

1073 *
°r
 == ' ' || *str == '\t')

1074 
°r
++;

1075 i‡(!(*
°r
))

1076  -
EINVAL
;

1077 
size
 = 1;

1078 i‡(*
°r
 != '"' && *str != '\'') {

1079 *
°r
 && *str != ',') {

1080 i‡(
size
 < ()(
buf
)) {

1081 *
±r
++ = *
°r
;

1082 
size
++;

1084 
°r
++;

1087 
c
 = *
°r
++;

1088 *
°r
 && *°∏!
c
) {

1089 i‡(
size
 < ()(
buf
)) {

1090 *
±r
++ = *
°r
;

1091 
size
++;

1093 
°r
++;

1095 i‡(*
°r
 =
c
)

1096 
°r
++;

1098 i‡(*
°r
 == '\0') {

1099 *
±r
 = 0;

1100 
_£t
;

1102 i‡(*
°r
 != ',')

1103  -
EINVAL
;

1104 *
±r
 = 0;

1105 
°r
++;

1106 i‡(
°r
[0] < '0' || str[1] > '9')

1107  -
EINVAL
;

1108 
d°
->
ödex
 = 
	`©oi
(
°r
);

1109 
_£t
:

1110 
	`¢d_°æ˝y
(
d°
->
«me
, 
buf
, (dst->name));

1112 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/simple_abst.c

30 
	~"mixî_loˇl.h
"

31 
	~"mixî_sim∂e.h
"

32 
	~<°dio.h
>

33 
	~<°dlib.h
>

34 
	~<uni°d.h
>

35 
	~<°rög.h
>

36 
	~<f˙é.h
>

37 
	~<sys/io˘l.h
>

38 
	~<m©h.h
>

39 
	~<dlf˙.h
>

41 #i‚de‡
DOC_HIDDEN


43 
	#SO_PATH
 "smixî"

	)

45 
	s_˛ass_¥iv
 {

46 *
	mdevi˚
;

47 
¢d_˘l_t
 *
	m˘l
;

48 
¢d_h˘l_t
 *
	mh˘l
;

49 
	m©èch_Êag
;

50 
¢d_˘l_ˇrd_öfo_t
 *
	möfo
;

51 *
	mdlh™dÀ
;

52 *
	m¥iv©e_d©a
;

53 (*
	m¥iv©e_‰ì
)(
¢d_mixî_˛ass_t
 *
	m˛ass
);

54 } 
	t˛ass_¥iv_t
;

56 (*
	t¢d_mixî_sbasic_öô_t
)(
	t¢d_mixî_˛ass_t
 *
	t˛ass
);

57 (*
	t¢d_mixî_sfbasic_öô_t
)(
	t¢d_mixî_˛ass_t
 *
	t˛ass
,

58 
	t¢d_mixî_t
 *
	tmixî
,

59 c⁄° *
	tdevi˚
);

63 
	$åy_›í
(
¢d_mixî_˛ass_t
 *
˛ass
, c⁄° *
lib
)

65 
˛ass_¥iv_t
 *
¥iv
 = 
	`¢d_mixî_˛ass_gë_¥iv©e
(
˛ass
);

66 
¢d_mixî_evít_t
 
evít_func
;

67 
¢d_mixî_sbasic_öô_t
 
öô_func
 = 
NULL
;

68 *
xlib
, *
∑th
, 
îrbuf
[256];

69 *
h
;

70 
îr
 = 0;

72 i‡(!
lib
)

73  -
ENXIO
;

74 
∑th
 = 
	`gëív
("ALSA_MIXER_SIMPLE_MODULES");

75 i‡(!
∑th
)

76 
∑th
 = 
SO_PATH
;

77 
xlib
 = 
	`mÆloc
(
	`°æí
(
lib
Ë+ såÀn(
∑th
) + 1 + 1);

78 i‡(
xlib
 =
NULL
)

79  -
ENOMEM
;

80 
	`°r˝y
(
xlib
, 
∑th
);

81 
	`°rˇt
(
xlib
, "/");

82 
	`°rˇt
(
xlib
, 
lib
);

83 
h
 = 
	`INTERNAL
(
¢d_dl›í
)(
xlib
, 
RTLD_NOW
, 
îrbuf
, (errbuf));

84 i‡(
h
 =
NULL
) {

85 
	`SNDERR
("U«bÀÅÿ›íÜibøry '%s' (%s)", 
xlib
, 
îrbuf
);

86 
	`‰ì
(
xlib
);

87  -
ENXIO
;

89 
¥iv
->
dlh™dÀ
 = 
h
;

90 
evít_func
 = 
	`¢d_dlsym
(
h
, "Æß_mixî_sim∂e_evít", 
NULL
);

91 i‡(
evít_func
 =
NULL
) {

92 
	`SNDERR
("Symbﬁ 'Æß_mixî_sim∂e_evít' wa†nŸ found i¿'%s'", 
xlib
);

93 
îr
 = -
ENXIO
;

95 i‡(
îr
 == 0) {

96 
öô_func
 = 
	`¢d_dlsym
(
h
, "Æß_mixî_sim∂e_öô", 
NULL
);

97 i‡(
öô_func
 =
NULL
) {

98 
	`SNDERR
("Symbﬁ 'Æß_mixî_sim∂e_öô' wa†nŸ found i¿'%s'", 
xlib
);

99 
îr
 = -
ENXIO
;

102 
	`‰ì
(
xlib
);

103 
îr
 =Éº =0 ? 
	`öô_func
(
˛ass
) :Érr;

104 i‡(
îr
 < 0)

105  
îr
;

106 
	`¢d_mixî_˛ass_£t_evít
(
˛ass
, 
evít_func
);

108 
	}
}

110 
	$åy_›í_fuŒ
(
¢d_mixî_˛ass_t
 *
˛ass
, 
¢d_mixî_t
 *
mixî
,

111 c⁄° *
lib
, c⁄° *
devi˚
)

113 
˛ass_¥iv_t
 *
¥iv
 = 
	`¢d_mixî_˛ass_gë_¥iv©e
(
˛ass
);

114 
¢d_mixî_evít_t
 
evít_func
;

115 
¢d_mixî_sfbasic_öô_t
 
öô_func
 = 
NULL
;

116 *
xlib
, *
∑th
, 
îrbuf
[256];

117 *
h
;

118 
îr
 = 0;

120 
∑th
 = 
	`gëív
("ALSA_MIXER_SIMPLE_MODULES");

121 i‡(!
∑th
)

122 
∑th
 = 
SO_PATH
;

123 
xlib
 = 
	`mÆloc
(
	`°æí
(
lib
Ë+ såÀn(
∑th
) + 1 + 1);

124 i‡(
xlib
 =
NULL
)

125  -
ENOMEM
;

126 
	`°r˝y
(
xlib
, 
∑th
);

127 
	`°rˇt
(
xlib
, "/");

128 
	`°rˇt
(
xlib
, 
lib
);

130 
h
 = 
	`INTERNAL
(
¢d_dl›í
)(
xlib
, 
RTLD_NOW
|
RTLD_GLOBAL
, 
îrbuf
, (errbuf));

131 i‡(
h
 =
NULL
) {

132 
	`SNDERR
("U«bÀÅÿ›íÜibøry '%s'", 
xlib
);

133 
	`‰ì
(
xlib
);

134  -
ENXIO
;

136 
¥iv
->
dlh™dÀ
 = 
h
;

137 
evít_func
 = 
	`¢d_dlsym
(
h
, "Æß_mixî_sim∂e_evít", 
NULL
);

138 i‡(
evít_func
 =
NULL
) {

139 
	`SNDERR
("Symbﬁ 'Æß_mixî_sim∂e_evít' wa†nŸ found i¿'%s'", 
xlib
);

140 
îr
 = -
ENXIO
;

142 i‡(
îr
 == 0) {

143 
öô_func
 = 
	`¢d_dlsym
(
h
, "Æß_mixî_sim∂e_föô", 
NULL
);

144 i‡(
öô_func
 =
NULL
) {

145 
	`SNDERR
("Symbﬁ 'Æß_mixî_sim∂e_föô' wa†nŸ found i¿'%s'", 
xlib
);

146 
îr
 = -
ENXIO
;

149 
	`‰ì
(
xlib
);

150 
îr
 =Éº =0 ? 
	`öô_func
(
˛ass
, 
mixî
, 
devi˚
) :Érr;

151 i‡(
îr
 < 0)

152  
îr
;

153 
	`¢d_mixî_˛ass_£t_evít
(
˛ass
, 
evít_func
);

155 
	}
}

157 
	$m©ch
(
¢d_mixî_˛ass_t
 *
˛ass
, c⁄° *
lib
, c⁄° *
£¨chl
)

159 
˛ass_¥iv_t
 *
¥iv
 = 
	`¢d_mixî_˛ass_gë_¥iv©e
(
˛ass
);

160 c⁄° *
comp⁄íts
;

162 i‡(
£¨chl
 =
NULL
)

163  
	`åy_›í
(
˛ass
, 
lib
);

164 
comp⁄íts
 = 
	`¢d_˘l_ˇrd_öfo_gë_comp⁄íts
(
¥iv
->
öfo
);

165 *
comp⁄íts
 != '\0') {

166 i‡(!
	`°∫cmp
(
comp⁄íts
, 
£¨chl
, 
	`°æí
(searchl)))

167  
	`åy_›í
(
˛ass
, 
lib
);

168 *
comp⁄íts
 != ' ' && *components != '\0')

169 
comp⁄íts
++;

170 *
comp⁄íts
 == ' ' && *components != '\0')

171 
comp⁄íts
++;

174 
	}
}

176 
	$föd_fuŒ
(
¢d_mixî_˛ass_t
 *
˛ass
, 
¢d_mixî_t
 *
mixî
,

177 
¢d_c⁄fig_t
 *
t›
, c⁄° *
devi˚
)

179 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

180 *
lib
;

181 c⁄° *
id
;

182 
îr
;

184 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
t›
) {

185 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

186 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

188 i‡(
	`°rcmp
(
id
, "_full"))

190 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, (c⁄° **)&
lib
);

191 i‡(
îr
 < 0)

192  
îr
;

193 
îr
 = 
	`åy_›í_fuŒ
(
˛ass
, 
mixî
, 
lib
, 
devi˚
);

194 i‡(
îr
 < 0)

195  
îr
;

198  -
ENOENT
;

199 
	}
}

201 
	$föd_moduÀ
(
¢d_mixî_˛ass_t
 *
˛ass
, 
¢d_c⁄fig_t
 *
t›
)

203 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

204 
¢d_c⁄fig_ôî©‹_t
 
j
, 
j√xt
;

205 *
lib
, *
£¨chl
;

206 c⁄° *
id
;

207 
îr
;

209 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
t›
) {

210 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

211 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

213 i‡(*
id
 == '_')

215 
£¨chl
 = 
NULL
;

216 
lib
 = 
NULL
;

217 
	`¢d_c⁄fig_f‹_óch
(
j
, 
j√xt
, 
n
) {

218 
¢d_c⁄fig_t
 *
m
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
j
);

219 i‡(
	`¢d_c⁄fig_gë_id
(
m
, &
id
) < 0)

221 i‡(!
	`°rcmp
(
id
, "searchl")) {

222 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
m
, (c⁄° **)&
£¨chl
);

223 i‡(
îr
 < 0)

224  
îr
;

227 i‡(!
	`°rcmp
(
id
, "lib")) {

228 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
m
, (c⁄° **)&
lib
);

229 i‡(
îr
 < 0)

230  
îr
;

234 
îr
 = 
	`m©ch
(
˛ass
, 
lib
, 
£¨chl
);

235 i‡(
îr
 == 1)

237 i‡(
îr
 < 0)

238  
îr
;

240  -
ENOENT
;

241 
	}
}

243 
	$¥iv©e_‰ì
(
¢d_mixî_˛ass_t
 *
˛ass
)

245 
˛ass_¥iv_t
 *
¥iv
 = 
	`¢d_mixî_˛ass_gë_¥iv©e
(
˛ass
);

247 i‡(
¥iv
->
¥iv©e_‰ì
)

248 
¥iv
->
	`¥iv©e_‰ì
(
˛ass
);

249 i‡(
¥iv
->
dlh™dÀ
)

250 
	`¢d_dl˛o£
(
¥iv
->
dlh™dÀ
);

251 i‡(
¥iv
->
öfo
)

252 
	`¢d_˘l_ˇrd_öfo_‰ì
(
¥iv
->
öfo
);

253 i‡(
¥iv
->
h˘l
) {

254 i‡(
¥iv
->
©èch_Êag
)

255 
	`¢d_mixî_dëach_h˘l
(
	`¢d_mixî_˛ass_gë_mixî
(
˛ass
), 
¥iv
->
h˘l
);

256 
	`¢d_h˘l_˛o£
(
¥iv
->
h˘l
);

257 } i‡(
¥iv
->
˘l
)

258 
	`¢d_˘l_˛o£
(
¥iv
->
˘l
);

259 
	`‰ì
(
¥iv
->
devi˚
);

260 
	`‰ì
(
¥iv
);

261 
	}
}

270 
	$¢d_mixî_sim∂e_basic_ªgi°î
(
¢d_mixî_t
 *
mixî
,

271 
¢d_mixî_£Àm_ªg›t
 *
›ti⁄s
,

272 
¢d_mixî_˛ass_t
 **
˛as•
)

274 
¢d_mixî_˛ass_t
 *
˛ass
;

275 
˛ass_¥iv_t
 *
¥iv
 = 
	`ˇŒoc
(1, (*priv));

276 c⁄° *
fûe
;

277 
¢d_öput_t
 *
öput
;

278 
¢d_c⁄fig_t
 *
t›
 = 
NULL
;

279 
îr
;

281 i‡(
¥iv
 =
NULL
)

282  -
ENOMEM
;

283 i‡(
›ti⁄s
->
devi˚
 =
NULL
) {

284 
	`‰ì
(
¥iv
);

285  -
EINVAL
;

287 i‡(
	`¢d_mixî_˛ass_mÆloc
(&
˛ass
)) {

288 
	`‰ì
(
¥iv
);

289  -
ENOMEM
;

291 
¥iv
->
devi˚
 = 
	`°rdup
(
›ti⁄s
->device);

292 i‡(
¥iv
->
devi˚
 =
NULL
) {

293 
	`‰ì
(
¥iv
);

294 
	`¢d_mixî_˛ass_‰ì
(
˛ass
);

295  -
ENOMEM
;

297 
	`¢d_mixî_˛ass_£t_com∑ª
(
˛ass
, 
¢d_mixî_£Àm_com∑ª
);

298 
	`¢d_mixî_˛ass_£t_¥iv©e
(
˛ass
, 
¥iv
);

299 
	`¢d_mixî_˛ass_£t_¥iv©e_‰ì
(
˛ass
, 
¥iv©e_‰ì
);

300 
fûe
 = 
	`gëív
("ALSA_MIXER_SIMPLE");

301 i‡(!
fûe
) {

302 c⁄° *
t›dú
 = 
	`¢d_c⁄fig_t›dú
();

303 *
s
 = 
	`Æloˇ
(
	`°æí
(
t›dú
) + strlen("smixer.conf") + 2);

304 
	`•rötf
(
s
, "%s/smixî.c⁄f", 
t›dú
);

305 
fûe
 = 
s
;

307 
îr
 = 
	`¢d_c⁄fig_t›
(&
t›
);

308 i‡(
îr
 >= 0) {

309 
îr
 = 
	`¢d_öput_°dio_›í
(&
öput
, 
fûe
, "r");

310 i‡(
îr
 < 0) {

311 
	`SNDERR
("u«bÀÅÿ›í sim∂êmixî c⁄figuøti⁄ fûê'%s'", 
fûe
);

312 
__îr‹
;

314 
îr
 = 
	`¢d_c⁄fig_lﬂd
(
t›
, 
öput
);

315 
	`¢d_öput_˛o£
(
öput
);

316 i‡(
îr
 < 0) {

317 
	`SNDERR
("%†may bêﬁd o∏c‹ru±ed: c⁄sidîÅÿªmovê‹ fix it", 
fûe
);

318 
__îr‹
;

320 
îr
 = 
	`föd_fuŒ
(
˛ass
, 
mixî
, 
t›
, 
¥iv
->
devi˚
);

321 i‡(
îr
 >= 0)

322 
__fuŒ
;

324 i‡(
îr
 >= 0) {

325 
îr
 = 
	`¢d_˘l_›í
(&
¥iv
->
˘l
,Öriv->
devi˚
, 0);

326 i‡(
îr
 < 0) {

327 
	`SNDERR
("u«bÀÅÿ›í c⁄åﬁ devi˚ '%s': %s", 
¥iv
->
devi˚
, 
	`¢d_°ªº‹
(
îr
));

328 
__îr‹
;

330 
îr
 = 
	`¢d_h˘l_›í_˘l
(&
¥iv
->
h˘l
,Öriv->
˘l
);

331 i‡(
îr
 < 0)

332 
__îr‹
;

333 
îr
 = 
	`¢d_˘l_ˇrd_öfo_mÆloc
(&
¥iv
->
öfo
);

334 i‡(
îr
 < 0)

335 
__îr‹
;

336 
îr
 = 
	`¢d_˘l_ˇrd_öfo
(
¥iv
->
˘l
,Öriv->
öfo
);

337 i‡(
îr
 < 0)

338 
__îr‹
;

340 i‡(
îr
 >= 0)

341 
îr
 = 
	`föd_moduÀ
(
˛ass
, 
t›
);

342 i‡(
îr
 >= 0)

343 
îr
 = 
	`¢d_mixî_©èch_h˘l
(
mixî
, 
¥iv
->
h˘l
);

344 i‡(
îr
 >= 0) {

345 
¥iv
->
©èch_Êag
 = 1;

346 
îr
 = 
	`¢d_mixî_˛ass_ªgi°î
(
˛ass
, 
mixî
);

348 
__fuŒ
:

349 i‡(
îr
 < 0) {

350 
__îr‹
:

351 i‡(
t›
)

352 
	`¢d_c⁄fig_dñëe
(
t›
);

353 i‡(
˛ass
)

354 
	`¢d_mixî_˛ass_‰ì
(
˛ass
);

355  
îr
;

357 i‡(
t›
)

358 
	`¢d_c⁄fig_dñëe
(
t›
);

359 i‡(
˛as•
)

360 *
˛as•
 = 
˛ass
;

362 
	}
}

370 
	$¢d_mixî_sbasic_öfo
(c⁄° 
¢d_mixî_˛ass_t
 *
˛ass
, 
sm_˛ass_basic_t
 *
öfo
)

372 
˛ass_¥iv_t
 *
¥iv
 = 
	`¢d_mixî_˛ass_gë_¥iv©e
(
˛ass
);

374 i‡(
˛ass
 =
NULL
 || 
öfo
 == NULL)

375  -
EINVAL
;

376 
öfo
->
devi˚
 = 
¥iv
->device;

377 
öfo
->
˘l
 = 
¥iv
->ctl;

378 
öfo
->
h˘l
 = 
¥iv
->hctl;

379 
öfo
->öfÿ
¥iv
->info;

381 
	}
}

388 *
	$¢d_mixî_sbasic_gë_¥iv©e
(c⁄° 
¢d_mixî_˛ass_t
 *
˛ass
)

390 
˛ass_¥iv_t
 *
¥iv
 = 
	`¢d_mixî_˛ass_gë_¥iv©e
(
˛ass
);

392 i‡(
˛ass
 =
NULL
)

393  
NULL
;

394  
¥iv
->
¥iv©e_d©a
;

395 
	}
}

402 
	$¢d_mixî_sbasic_£t_¥iv©e
(c⁄° 
¢d_mixî_˛ass_t
 *
˛ass
, *
¥iv©e_d©a
)

404 
˛ass_¥iv_t
 *
¥iv
;

406 i‡(
˛ass
 =
NULL
)

408 
¥iv
 = 
	`¢d_mixî_˛ass_gë_¥iv©e
(
˛ass
);

409 
¥iv
->
¥iv©e_d©a
 =Örivate_data;

410 
	}
}

417 
¢d_mixî_sbasic_£t_¥iv©e_‰ì
(c⁄° 
¢d_mixî_˛ass_t
 *
˛ass
, (*
¥iv©e_‰ì
)(snd_mixer_class_t *class))

419 
˛ass_¥iv_t
 *
¥iv
;

421 i‡(
˛ass
 =
NULL
)

423 
¥iv
 = 
	`¢d_mixî_˛ass_gë_¥iv©e
(
˛ass
);

424 
¥iv
->
¥iv©e_‰ì
 =Örivate_free;

425 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/simple_none.c

32 
	~"loˇl.h
"

33 
	~"mixî_sim∂e.h
"

34 
	~<°dio.h
>

35 
	~<°dlib.h
>

36 
	~<uni°d.h
>

37 
	~<°rög.h
>

38 
	~<f˙é.h
>

39 
	~<sys/io˘l.h
>

40 
	~<as£π.h
>

41 
	~<m©h.h
>

42 
	~<limôs.h
>

44 #i‚de‡
DOC_HIDDEN


46 
	#MIXER_COMPARE_WEIGHT_SIMPLE_BASE
 0

	)

47 
	#MIXER_COMPARE_WEIGHT_NEXT_BASE
 10000000

	)

48 
	#MIXER_COMPARE_WEIGHT_NOT_FOUND
 1000000000

	)

50 
	e_£Àm_˘l_ty≥
 {

51 
	mCTL_SINGLE
,

52 
	mCTL_GLOBAL_ENUM
,

53 
	mCTL_GLOBAL_SWITCH
,

54 
	mCTL_GLOBAL_VOLUME
,

55 
	mCTL_GLOBAL_ROUTE
,

56 
	mCTL_PLAYBACK_ENUM
,

57 
	mCTL_PLAYBACK_SWITCH
,

58 
	mCTL_PLAYBACK_VOLUME
,

59 
	mCTL_PLAYBACK_ROUTE
,

60 
	mCTL_CAPTURE_ENUM
,

61 
	mCTL_CAPTURE_SWITCH
,

62 
	mCTL_CAPTURE_VOLUME
,

63 
	mCTL_CAPTURE_ROUTE
,

64 
	mCTL_CAPTURE_SOURCE
,

65 
	mCTL_LAST
 = 
CTL_CAPTURE_SOURCE
,

66 } 
	t£Àm_˘l_ty≥_t
;

68 
	s_£Àm_˘l
 {

69 
¢d_h˘l_ñem_t
 *
	mñem
;

70 
¢d_˘l_ñem_ty≥_t
 
	mty≥
;

71 
	möa˘ive
: 1;

72 
	mvÆues
;

73 
	mmö
, 
	mmax
;

74 } 
	t£Àm_˘l_t
;

76 
	s_£Àm_n⁄e
 {

77 
sm_£Àm_t
 
	m£Àm
;

78 
£Àm_˘l_t
 
	m˘ls
[
CTL_LAST
 + 1];

79 
	mˇ±uª_ôem
;

80 
	s£Àm_°r
 {

81 
	mønge
: 1;

82 
	mdb_öôülized
: 1;

83 
	mdb_öô_îr‹
: 1;

84 
	mmö
, 
	mmax
;

85 
	mch™√ls
;

86 
	mvﬁ
[32];

87 
	msw
;

88 *
	mdb_öfo
;

89 } 
	m°r
[2];

90 } 
	t£Àm_n⁄e_t
;

92 c⁄° 
	smixî_«me_èbÀ
 {

93 c⁄° *
	ml⁄g«me
;

94 c⁄° *
	msh‹äame
;

95 } 
	g«me_èbÀ
[] = {

107 c⁄° *
	$gë_sh‹t_«me
(c⁄° *
 ame
)

109 c⁄° 
mixî_«me_èbÀ
 *
p
;

110 
p
 = 
«me_èbÀ
;Ö->
l⁄g«me
;Ö++) {

111 i‡(!
	`°rcmp
(
 ame
, 
p
->
l⁄g«me
))

112  
p
->
sh‹äame
;

114  
 ame
;

115 
	}
}

117 
	$com∑ª_mixî_¥i‹ôy_lookup
(c⁄° **
«me
, c⁄° * c⁄° *
«mes
, 
c€f
)

119 
ªs
;

121 
ªs
 = 0; *
«mes
;Çames++,Ñe†+
c€f
) {

122 i‡(!
	`°∫cmp
(*
«me
, *
«mes
, 
	`°æí
(*names))) {

123 *
«me
 +
	`°æí
(*
«mes
);

124 i‡(**
«me
 == ' ')

125 (*
«me
)++;

126  
ªs
+1;

129  
MIXER_COMPARE_WEIGHT_NOT_FOUND
;

130 
	}
}

132 
	$gë_com∑ª_weight
(c⁄° *
«me
, 
idx
)

134 c⁄° *c⁄° 
«mes
[] = {

168 
NULL


170 c⁄° *c⁄° 
«mes1
[] = {

172 
NULL
,

174 c⁄° *c⁄° 
«mes2
[] = {

188 
NULL
,

190 c⁄° *
«me1
;

191 
ªs
, 
ªs1
;

193 i‡((
ªs
 = 
	`com∑ª_mixî_¥i‹ôy_lookup
((c⁄° **)&
«me
, 
«mes
, 1000)Ë=
MIXER_COMPARE_WEIGHT_NOT_FOUND
)

194  
MIXER_COMPARE_WEIGHT_NOT_FOUND
;

195 i‡(*
«me
 == '\0')

196 
__ªs
;

197 
«me1
 = 
«me
; *name1 != '\0';Çame1++);

198 
«me1
--;Çame1 !
«me
 && *name1 != ' ';Çame1--);

199 
«me1
 !
«me
 && *name1 == ' ')

200 
«me1
--;

201 i‡(
«me1
 !
«me
) {

202 ; 
«me1
 !
«me
 && *name1 != ' ';Çame1--);

203 
«me
 = 
«me1
;

204 i‡((
ªs1
 = 
	`com∑ª_mixî_¥i‹ôy_lookup
((c⁄° **)&
«me
, 
«mes1
, 200)Ë=
MIXER_COMPARE_WEIGHT_NOT_FOUND
)

205  
ªs
;

206 
ªs
 +
ªs1
;

208 
«me
 = 
«me1
;

210 i‡((
ªs1
 = 
	`com∑ª_mixî_¥i‹ôy_lookup
((c⁄° **)&
«me
, 
«mes2
, 20)Ë=
MIXER_COMPARE_WEIGHT_NOT_FOUND
)

211  
ªs
;

212 
__ªs
:

213  
MIXER_COMPARE_WEIGHT_SIMPLE_BASE
 + 
ªs
 + 
idx
;

214 
	}
}

216 
	$to_u£r
(
£Àm_n⁄e_t
 *
s
, 
dú
, 
£Àm_˘l_t
 *
c
, 
vÆue
)

218 
öt64_t
 
n
;

219 i‡(
c
->
max
 =c->
mö
)

220  
s
->
°r
[
dú
].
mö
;

221 
n
 = (
öt64_t
Ë(
vÆue
 - 
c
->
mö
Ë* (
s
->
°r
[
dú
].
max
 - s->str[dir].min);

222  
s
->
°r
[
dú
].
mö
 + (
n
 + (
c
->
max
 - c->min) / 2) / (c->max - c->min);

223 
	}
}

225 
	$‰om_u£r
(
£Àm_n⁄e_t
 *
s
, 
dú
, 
£Àm_˘l_t
 *
c
, 
vÆue
)

227 
öt64_t
 
n
;

228 i‡(
s
->
°r
[
dú
].
max
 =s->°r[dú].
mö
)

229  
c
->
mö
;

230 
n
 = (
öt64_t
Ë(
vÆue
 - 
s
->
°r
[
dú
].
mö
Ë* (
c
->
max
 - c->min);

231  
c
->
mö
 + (
n
 + (
s
->
°r
[
dú
].
max
 - s->str[dir].min) / 2) / (s->str[dir].max - s->str[dir].min);

232 
	}
}

234 
	$ñem_ªad_vﬁume
(
£Àm_n⁄e_t
 *
s
, 
dú
, 
£Àm_˘l_ty≥_t
 
ty≥
)

236 
¢d_˘l_ñem_vÆue_t
 
˘l
 = {0};

237 
idx
;

238 
îr
;

239 
£Àm_˘l_t
 *
c
 = &
s
->
˘ls
[
ty≥
];

240 i‡((
îr
 = 
	`¢d_h˘l_ñem_ªad
(
c
->
ñem
, &
˘l
)) < 0)

241  
îr
;

242 
idx
 = 0; idx < 
s
->
°r
[
dú
].
ch™√ls
; idx++) {

243 
idx1
 = 
idx
;

244 i‡(
idx
 >
c
->
vÆues
)

245 
idx1
 = 0;

246 
s
->
°r
[
dú
].
vﬁ
[
idx
] =

247 
	`to_u£r
(
s
, 
dú
, 
c
,

248 
	`¢d_˘l_ñem_vÆue_gë_öãgî
(&
˘l
, 
idx1
));

251 
	}
}

253 
	$ñem_ªad_swôch
(
£Àm_n⁄e_t
 *
s
, 
dú
, 
£Àm_˘l_ty≥_t
 
ty≥
)

255 
¢d_˘l_ñem_vÆue_t
 
˘l
 = {0};

256 
idx
;

257 
îr
;

258 
£Àm_˘l_t
 *
c
 = &
s
->
˘ls
[
ty≥
];

259 i‡((
îr
 = 
	`¢d_h˘l_ñem_ªad
(
c
->
ñem
, &
˘l
)) < 0)

260  
îr
;

261 
idx
 = 0; idx < 
s
->
°r
[
dú
].
ch™√ls
; idx++) {

262 
idx1
 = 
idx
;

263 i‡(
idx
 >
c
->
vÆues
)

264 
idx1
 = 0;

265 i‡(!
	`¢d_˘l_ñem_vÆue_gë_öãgî
(&
˘l
, 
idx1
))

266 
s
->
°r
[
dú
].
sw
 &~(1 << 
idx
);

269 
	}
}

271 
	$ñem_ªad_rouã
(
£Àm_n⁄e_t
 *
s
, 
dú
, 
£Àm_˘l_ty≥_t
 
ty≥
)

273 
¢d_˘l_ñem_vÆue_t
 
˘l
 = {0};

274 
idx
;

275 
îr
;

276 
£Àm_˘l_t
 *
c
 = &
s
->
˘ls
[
ty≥
];

277 i‡((
îr
 = 
	`¢d_h˘l_ñem_ªad
(
c
->
ñem
, &
˘l
)) < 0)

278  
îr
;

279 
idx
 = 0; idx < 
s
->
°r
[
dú
].
ch™√ls
; idx++) {

280 
idx1
 = 
idx
;

281 i‡(
idx
 >
c
->
vÆues
)

282 
idx1
 = 0;

283 i‡(!
	`¢d_˘l_ñem_vÆue_gë_öãgî
(&
˘l
,

284 
idx1
 * 
c
->
vÆues
 + idx1))

285 
s
->
°r
[
dú
].
sw
 &~(1 << 
idx
);

288 
	}
}

290 
	$ñem_ªad_íum
(
£Àm_n⁄e_t
 *
s
)

292 
¢d_˘l_ñem_vÆue_t
 
˘l
 = {0};

293 
idx
;

294 
îr
;

295 
ty≥
;

296 
£Àm_˘l_t
 *
c
;

297 
ty≥
 = 
CTL_GLOBAL_ENUM
;

298 i‡((
s
->
£Àm
.
ˇps
 & (
SM_CAP_CENUM
 | 
SM_CAP_PENUM
)) ==

299 (
SM_CAP_CENUM
 | 
SM_CAP_PENUM
))

300 
ty≥
 = 
CTL_GLOBAL_ENUM
;

301 i‡(
s
->
£Àm
.
ˇps
 & 
SM_CAP_PENUM
)

302 
ty≥
 = 
CTL_PLAYBACK_ENUM
;

303 i‡(
s
->
£Àm
.
ˇps
 & 
SM_CAP_CENUM
)

304 
ty≥
 = 
CTL_CAPTURE_ENUM
;

305 
c
 = &
s
->
˘ls
[
ty≥
];

306 i‡((
îr
 = 
	`¢d_h˘l_ñem_ªad
(
c
->
ñem
, &
˘l
)) < 0)

307  
îr
;

308 
idx
 = 0; idx < 
s
->
°r
[0].
ch™√ls
; idx++) {

309 
idx1
 = 
idx
;

310 i‡(
idx
 >
c
->
vÆues
)

311 
idx1
 = 0;

312 
s
->
°r
[0].
vﬁ
[
idx
] =

313 
	`¢d_˘l_ñem_vÆue_gë_íumî©ed
(&
˘l
, 
idx1
);

316 
	}
}

318 
	$£Àm_ªad
(
¢d_mixî_ñem_t
 *
ñem
)

320 
£Àm_n⁄e_t
 *
s
;

321 
idx
;

322 
îr
 = 0;

323 
pvﬁ
[32], 
cvﬁ
[32];

324 
psw
, 
csw
;

326 
	`as£π
(
	`¢d_mixî_ñem_gë_ty≥
(
ñem
Ë=
SND_MIXER_ELEM_SIMPLE
);

327 
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

329 
	`mem˝y
(
pvﬁ
, 
s
->
°r
[
SM_PLAY
].
vﬁ
, (pvol));

330 
	`mem£t
(&
s
->
°r
[
SM_PLAY
].
vﬁ
, 0, (s->str[SM_PLAY].vol));

331 
psw
 = 
s
->
°r
[
SM_PLAY
].
sw
;

332 
s
->
°r
[
SM_PLAY
].
sw
 = ~0U;

333 
	`mem˝y
(
cvﬁ
, 
s
->
°r
[
SM_CAPT
].
vﬁ
, (cvol));

334 
	`mem£t
(&
s
->
°r
[
SM_CAPT
].
vﬁ
, 0, (s->str[SM_CAPT].vol));

335 
csw
 = 
s
->
°r
[
SM_CAPT
].
sw
;

336 
s
->
°r
[
SM_CAPT
].
sw
 = ~0U;

338 i‡(
s
->
˘ls
[
CTL_GLOBAL_ENUM
].
ñem
) {

339 
îr
 = 
	`ñem_ªad_íum
(
s
);

340 i‡(
îr
 < 0)

341  
îr
;

342 
__skù_cswôch
;

345 i‡(
s
->
˘ls
[
CTL_CAPTURE_ENUM
].
ñem
) {

346 
îr
 = 
	`ñem_ªad_íum
(
s
);

347 i‡(
îr
 < 0)

348  
îr
;

349 
__skù_cswôch
;

352 i‡(
s
->
˘ls
[
CTL_PLAYBACK_ENUM
].
ñem
) {

353 
îr
 = 
	`ñem_ªad_íum
(
s
);

354 i‡(
îr
 < 0)

355  
îr
;

356 
__skù_cswôch
;

360 i‡(
s
->
˘ls
[
CTL_PLAYBACK_VOLUME
].
ñem
)

361 
îr
 = 
	`ñem_ªad_vﬁume
(
s
, 
SM_PLAY
, 
CTL_PLAYBACK_VOLUME
);

362 i‡(
s
->
˘ls
[
CTL_GLOBAL_VOLUME
].
ñem
)

363 
îr
 = 
	`ñem_ªad_vﬁume
(
s
, 
SM_PLAY
, 
CTL_GLOBAL_VOLUME
);

364 i‡(
s
->
˘ls
[
CTL_SINGLE
].
ñem
 &&

365 
s
->
˘ls
[
CTL_SINGLE
].
ty≥
 =
SND_CTL_ELEM_TYPE_INTEGER
)

366 
îr
 = 
	`ñem_ªad_vﬁume
(
s
, 
SM_PLAY
, 
CTL_SINGLE
);

367 i‡(
îr
 < 0)

368  
îr
;

370 i‡((
s
->
£Àm
.
ˇps
 & (
SM_CAP_GSWITCH
|
SM_CAP_PSWITCH
)) == 0) {

371 
s
->
°r
[
SM_PLAY
].
sw
 = 0;

372 
__skù_pswôch
;

374 i‡(
s
->
˘ls
[
CTL_PLAYBACK_SWITCH
].
ñem
) {

375 
îr
 = 
	`ñem_ªad_swôch
(
s
, 
SM_PLAY
, 
CTL_PLAYBACK_SWITCH
);

376 i‡(
îr
 < 0)

377  
îr
;

379 i‡(
s
->
˘ls
[
CTL_GLOBAL_SWITCH
].
ñem
) {

380 
îr
 = 
	`ñem_ªad_swôch
(
s
, 
SM_PLAY
, 
CTL_GLOBAL_SWITCH
);

381 i‡(
îr
 < 0)

382  
îr
;

384 i‡(
s
->
˘ls
[
CTL_SINGLE
].
ñem
 &&

385 
s
->
˘ls
[
CTL_SINGLE
].
ty≥
 =
SND_CTL_ELEM_TYPE_BOOLEAN
) {

386 
îr
 = 
	`ñem_ªad_swôch
(
s
, 
SM_PLAY
, 
CTL_SINGLE
);

387 i‡(
îr
 < 0)

388  
îr
;

390 i‡(
s
->
˘ls
[
CTL_PLAYBACK_ROUTE
].
ñem
) {

391 
îr
 = 
	`ñem_ªad_rouã
(
s
, 
SM_PLAY
, 
CTL_PLAYBACK_ROUTE
);

392 i‡(
îr
 < 0)

393  
îr
;

395 i‡(
s
->
˘ls
[
CTL_GLOBAL_ROUTE
].
ñem
) {

396 
îr
 = 
	`ñem_ªad_rouã
(
s
, 
SM_PLAY
, 
CTL_GLOBAL_ROUTE
);

397 i‡(
îr
 < 0)

398  
îr
;

400 
__skù_pswôch
:

402 i‡(
s
->
˘ls
[
CTL_CAPTURE_VOLUME
].
ñem
)

403 
îr
 = 
	`ñem_ªad_vﬁume
(
s
, 
SM_CAPT
, 
CTL_CAPTURE_VOLUME
);

404 i‡(
s
->
˘ls
[
CTL_GLOBAL_VOLUME
].
ñem
)

405 
îr
 = 
	`ñem_ªad_vﬁume
(
s
, 
SM_CAPT
, 
CTL_GLOBAL_VOLUME
);

406 i‡(
s
->
˘ls
[
CTL_SINGLE
].
ñem
 &&

407 
s
->
˘ls
[
CTL_SINGLE
].
ty≥
 =
SND_CTL_ELEM_TYPE_INTEGER
)

408 
îr
 = 
	`ñem_ªad_vﬁume
(
s
, 
SM_CAPT
, 
CTL_SINGLE
);

409 i‡(
îr
 < 0)

410  
îr
;

412 i‡((
s
->
£Àm
.
ˇps
 & (
SM_CAP_GSWITCH
|
SM_CAP_CSWITCH
)) == 0) {

413 
s
->
°r
[
SM_CAPT
].
sw
 = 0;

414 
__skù_cswôch
;

416 i‡(
s
->
˘ls
[
CTL_CAPTURE_SWITCH
].
ñem
) {

417 
îr
 = 
	`ñem_ªad_swôch
(
s
, 
SM_CAPT
, 
CTL_CAPTURE_SWITCH
);

418 i‡(
îr
 < 0)

419  
îr
;

421 i‡(
s
->
˘ls
[
CTL_GLOBAL_SWITCH
].
ñem
) {

422 
îr
 = 
	`ñem_ªad_swôch
(
s
, 
SM_CAPT
, 
CTL_GLOBAL_SWITCH
);

423 i‡(
îr
 < 0)

424  
îr
;

426 i‡(
s
->
˘ls
[
CTL_SINGLE
].
ñem
 &&

427 
s
->
˘ls
[
CTL_SINGLE
].
ty≥
 =
SND_CTL_ELEM_TYPE_BOOLEAN
) {

428 
îr
 = 
	`ñem_ªad_swôch
(
s
, 
SM_CAPT
, 
CTL_SINGLE
);

429 i‡(
îr
 < 0)

430  
îr
;

432 i‡(
s
->
˘ls
[
CTL_CAPTURE_ROUTE
].
ñem
) {

433 
îr
 = 
	`ñem_ªad_rouã
(
s
, 
SM_CAPT
, 
CTL_CAPTURE_ROUTE
);

434 i‡(
îr
 < 0)

435  
îr
;

437 i‡(
s
->
˘ls
[
CTL_GLOBAL_ROUTE
].
ñem
) {

438 
îr
 = 
	`ñem_ªad_rouã
(
s
, 
SM_CAPT
, 
CTL_GLOBAL_ROUTE
);

439 i‡(
îr
 < 0)

440  
îr
;

442 i‡(
s
->
˘ls
[
CTL_CAPTURE_SOURCE
].
ñem
) {

443 
¢d_˘l_ñem_vÆue_t
 
˘l
 = {0};

444 
£Àm_˘l_t
 *
c
 = &
s
->
˘ls
[
CTL_CAPTURE_SOURCE
];

445 
îr
 = 
	`¢d_h˘l_ñem_ªad
(
c
->
ñem
, &
˘l
);

446 i‡(
îr
 < 0)

447  
îr
;

448 
idx
 = 0; idx < 
s
->
°r
[
SM_CAPT
].
ch™√ls
; idx++) {

449 
idx1
 = 
idx
;

450 i‡(
idx
 >
c
->
vÆues
)

451 
idx1
 = 0;

452 i‡(
	`¢d_˘l_ñem_vÆue_gë_íumî©ed
(&
˘l
, 
idx1
) !=

453 
s
->
ˇ±uª_ôem
)

454 
s
->
°r
[
SM_CAPT
].
sw
 &~(1 << 
idx
);

457 
__skù_cswôch
:

459 i‡(
	`memcmp
(
pvﬁ
, 
s
->
°r
[
SM_PLAY
].
vﬁ
, (pvol)) ||

460 
psw
 !
s
->
°r
[
SM_PLAY
].
sw
 ||

461 
	`memcmp
(
cvﬁ
, 
s
->
°r
[
SM_CAPT
].
vﬁ
, (cvol)) ||

462 
csw
 !
s
->
°r
[
SM_CAPT
].
sw
)

465 
	}
}

467 
	$ñem_wrôe_vﬁume
(
£Àm_n⁄e_t
 *
s
, 
dú
, 
£Àm_˘l_ty≥_t
 
ty≥
)

469 
¢d_˘l_ñem_vÆue_t
 
˘l
 = {0};

470 
idx
;

471 
îr
;

472 
£Àm_˘l_t
 *
c
 = &
s
->
˘ls
[
ty≥
];

473 i‡((
îr
 = 
	`¢d_h˘l_ñem_ªad
(
c
->
ñem
, &
˘l
)) < 0)

474  
îr
;

475 
idx
 = 0; idx < 
c
->
vÆues
; idx++)

476 
	`¢d_˘l_ñem_vÆue_£t_öãgî
(&
˘l
, 
idx
,

477 
	`‰om_u£r
(
s
, 
dú
, 
c
, s->
°r
[dú].
vﬁ
[
idx
]));

478 i‡((
îr
 = 
	`¢d_h˘l_ñem_wrôe
(
c
->
ñem
, &
˘l
)) < 0)

479  
îr
;

481 
	}
}

483 
	$ñem_wrôe_swôch
(
£Àm_n⁄e_t
 *
s
, 
dú
, 
£Àm_˘l_ty≥_t
 
ty≥
)

485 
¢d_˘l_ñem_vÆue_t
 
˘l
 = {0};

486 
idx
;

487 
îr
;

488 
£Àm_˘l_t
 *
c
 = &
s
->
˘ls
[
ty≥
];

489 i‡((
îr
 = 
	`¢d_h˘l_ñem_ªad
(
c
->
ñem
, &
˘l
)) < 0)

490  
îr
;

491 
idx
 = 0; idx < 
c
->
vÆues
; idx++)

492 
	`¢d_˘l_ñem_vÆue_£t_öãgî
(&
˘l
, 
idx
,

493 !!(
s
->
°r
[
dú
].
sw
 & (1 << 
idx
)));

494 i‡((
îr
 = 
	`¢d_h˘l_ñem_wrôe
(
c
->
ñem
, &
˘l
)) < 0)

495  
îr
;

497 
	}
}

499 
	$ñem_wrôe_swôch_c⁄°™t
(
£Àm_n⁄e_t
 *
s
, 
£Àm_˘l_ty≥_t
 
ty≥
, 
vÆ
)

501 
¢d_˘l_ñem_vÆue_t
 
˘l
 = {0};

502 
idx
;

503 
îr
;

504 
£Àm_˘l_t
 *
c
 = &
s
->
˘ls
[
ty≥
];

505 i‡((
îr
 = 
	`¢d_h˘l_ñem_ªad
(
c
->
ñem
, &
˘l
)) < 0)

506  
îr
;

507 
idx
 = 0; idx < 
c
->
vÆues
; idx++)

508 
	`¢d_˘l_ñem_vÆue_£t_öãgî
(&
˘l
, 
idx
, !!
vÆ
);

509 i‡((
îr
 = 
	`¢d_h˘l_ñem_wrôe
(
c
->
ñem
, &
˘l
)) < 0)

510  
îr
;

512 
	}
}

514 
	$ñem_wrôe_rouã
(
£Àm_n⁄e_t
 *
s
, 
dú
, 
£Àm_˘l_ty≥_t
 
ty≥
)

516 
¢d_˘l_ñem_vÆue_t
 
˘l
 = {0};

517 
idx
;

518 
îr
;

519 
£Àm_˘l_t
 *
c
 = &
s
->
˘ls
[
ty≥
];

520 i‡((
îr
 = 
	`¢d_h˘l_ñem_ªad
(
c
->
ñem
, &
˘l
)) < 0)

521  
îr
;

522 
idx
 = 0; idx < 
c
->
vÆues
 * c->values; idx++)

523 
	`¢d_˘l_ñem_vÆue_£t_öãgî
(&
˘l
, 
idx
, 0);

524 
idx
 = 0; idx < 
c
->
vÆues
; idx++)

525 
	`¢d_˘l_ñem_vÆue_£t_öãgî
(&
˘l
, 
idx
 * 
c
->
vÆues
 + idx,

526 !!(
s
->
°r
[
dú
].
sw
 & (1 << 
idx
)));

527 i‡((
îr
 = 
	`¢d_h˘l_ñem_wrôe
(
c
->
ñem
, &
˘l
)) < 0)

528  
îr
;

530 
	}
}

532 
	$ñem_wrôe_íum
(
£Àm_n⁄e_t
 *
s
)

534 
¢d_˘l_ñem_vÆue_t
 
˘l
 = {0};

535 
idx
;

536 
îr
;

537 
ty≥
;

538 
£Àm_˘l_t
 *
c
;

539 
ty≥
 = 
CTL_GLOBAL_ENUM
;

540 i‡((
s
->
£Àm
.
ˇps
 & (
SM_CAP_CENUM
 | 
SM_CAP_PENUM
)) ==

541 (
SM_CAP_CENUM
 | 
SM_CAP_PENUM
))

542 
ty≥
 = 
CTL_GLOBAL_ENUM
;

543 i‡(
s
->
£Àm
.
ˇps
 & 
SM_CAP_PENUM
)

544 
ty≥
 = 
CTL_PLAYBACK_ENUM
;

545 i‡(
s
->
£Àm
.
ˇps
 & 
SM_CAP_CENUM
)

546 
ty≥
 = 
CTL_CAPTURE_ENUM
;

547 
c
 = &
s
->
˘ls
[
ty≥
];

548 i‡((
îr
 = 
	`¢d_h˘l_ñem_ªad
(
c
->
ñem
, &
˘l
)) < 0)

549  
îr
;

550 
idx
 = 0; idx < 
c
->
vÆues
; idx++)

551 
	`¢d_˘l_ñem_vÆue_£t_íumî©ed
(&
˘l
, 
idx
,

552 ()
s
->
°r
[0].
vﬁ
[
idx
]);

553 i‡((
îr
 = 
	`¢d_h˘l_ñem_wrôe
(
c
->
ñem
, &
˘l
)) < 0)

554  
îr
;

556 
	}
}

558 
	$£Àm_wrôe_maö
(
¢d_mixî_ñem_t
 *
ñem
)

560 
£Àm_n⁄e_t
 *
s
;

561 
idx
;

562 
îr
;

564 
	`as£π
(
	`¢d_mixî_ñem_gë_ty≥
(
ñem
Ë=
SND_MIXER_ELEM_SIMPLE
);

565 
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

567 i‡(
s
->
˘ls
[
CTL_GLOBAL_ENUM
].
ñem
)

568  
	`ñem_wrôe_íum
(
s
);

570 i‡(
s
->
˘ls
[
CTL_PLAYBACK_ENUM
].
ñem
)

571  
	`ñem_wrôe_íum
(
s
);

573 i‡(
s
->
˘ls
[
CTL_CAPTURE_ENUM
].
ñem
)

574  
	`ñem_wrôe_íum
(
s
);

576 i‡(
s
->
˘ls
[
CTL_SINGLE
].
ñem
) {

577 i‡(
s
->
˘ls
[
CTL_SINGLE
].
ty≥
 =
SND_CTL_ELEM_TYPE_INTEGER
)

578 
îr
 = 
	`ñem_wrôe_vﬁume
(
s
, 
SM_PLAY
, 
CTL_SINGLE
);

580 
îr
 = 
	`ñem_wrôe_swôch
(
s
, 
SM_PLAY
, 
CTL_SINGLE
);

581 i‡(
îr
 < 0)

582  
îr
;

584 i‡(
s
->
˘ls
[
CTL_GLOBAL_VOLUME
].
ñem
) {

585 
îr
 = 
	`ñem_wrôe_vﬁume
(
s
, 
SM_PLAY
, 
CTL_GLOBAL_VOLUME
);

586 i‡(
îr
 < 0)

587  
îr
;

589 i‡(
s
->
˘ls
[
CTL_GLOBAL_SWITCH
].
ñem
) {

590 i‡(
s
->
˘ls
[
CTL_PLAYBACK_SWITCH
].
ñem
 &&

591 
s
->
˘ls
[
CTL_CAPTURE_SWITCH
].
ñem
)

592 
îr
 = 
	`ñem_wrôe_swôch_c⁄°™t
(
s
, 
CTL_GLOBAL_SWITCH
,

595 
îr
 = 
	`ñem_wrôe_swôch
(
s
, 
SM_PLAY
, 
CTL_GLOBAL_SWITCH
);

596 i‡(
îr
 < 0)

597  
îr
;

599 i‡(
s
->
˘ls
[
CTL_PLAYBACK_VOLUME
].
ñem
) {

600 
îr
 = 
	`ñem_wrôe_vﬁume
(
s
, 
SM_PLAY
, 
CTL_PLAYBACK_VOLUME
);

601 i‡(
îr
 < 0)

602  
îr
;

604 i‡(
s
->
˘ls
[
CTL_PLAYBACK_SWITCH
].
ñem
) {

605 
îr
 = 
	`ñem_wrôe_swôch
(
s
, 
SM_PLAY
, 
CTL_PLAYBACK_SWITCH
);

606 i‡(
îr
 < 0)

607  
îr
;

609 i‡(
s
->
˘ls
[
CTL_PLAYBACK_ROUTE
].
ñem
) {

610 
îr
 = 
	`ñem_wrôe_rouã
(
s
, 
SM_PLAY
, 
CTL_PLAYBACK_ROUTE
);

611 i‡(
îr
 < 0)

612  
îr
;

614 i‡(
s
->
˘ls
[
CTL_CAPTURE_VOLUME
].
ñem
) {

615 
îr
 = 
	`ñem_wrôe_vﬁume
(
s
, 
SM_CAPT
, 
CTL_CAPTURE_VOLUME
);

616 i‡(
îr
 < 0)

617  
îr
;

619 i‡(
s
->
˘ls
[
CTL_CAPTURE_SWITCH
].
ñem
) {

620 
îr
 = 
	`ñem_wrôe_swôch
(
s
, 
SM_CAPT
, 
CTL_CAPTURE_SWITCH
);

621 i‡(
îr
 < 0)

622  
îr
;

624 i‡(
s
->
˘ls
[
CTL_CAPTURE_ROUTE
].
ñem
) {

625 
îr
 = 
	`ñem_wrôe_rouã
(
s
, 
SM_CAPT
, 
CTL_CAPTURE_ROUTE
);

626 i‡(
îr
 < 0)

627  
îr
;

629 i‡(
s
->
˘ls
[
CTL_CAPTURE_SOURCE
].
ñem
) {

630 
¢d_˘l_ñem_vÆue_t
 
˘l
 = {0};

631 
£Àm_˘l_t
 *
c
 = &
s
->
˘ls
[
CTL_CAPTURE_SOURCE
];

632 i‡((
îr
 = 
	`¢d_h˘l_ñem_ªad
(
c
->
ñem
, &
˘l
)) < 0)

633  
îr
;

634 
idx
 = 0; idx < 
c
->
vÆues
; idx++) {

635 i‡(
s
->
°r
[
SM_CAPT
].
sw
 & (1 << 
idx
))

636 
	`¢d_˘l_ñem_vÆue_£t_íumî©ed
(&
˘l
,

637 
idx
, 
s
->
ˇ±uª_ôem
);

639 i‡((
îr
 = 
	`¢d_h˘l_ñem_wrôe
(
c
->
ñem
, &
˘l
)) < 0)

640  
îr
;

642 
îr
 = 
	`£Àm_ªad
(
ñem
);

643 i‡(
îr
 < 0)

644  
îr
;

647 
	}
}

649 
	$£Àm_wrôe
(
¢d_mixî_ñem_t
 *
ñem
)

651 
îr
;

653 
îr
 = 
	`£Àm_wrôe_maö
(
ñem
);

654 i‡(
îr
 < 0)

655 
	`£Àm_ªad
(
ñem
);

656  
îr
;

657 
	}
}

659 
	$£Àm_‰ì
(
¢d_mixî_ñem_t
 *
ñem
)

661 
£Àm_n⁄e_t
 *
sim∂e
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

662 
	`as£π
(
	`¢d_mixî_ñem_gë_ty≥
(
ñem
Ë=
SND_MIXER_ELEM_SIMPLE
);

663 i‡(
sim∂e
->
£Àm
.
id
)

664 
	`¢d_mixî_£Àm_id_‰ì
(
sim∂e
->
£Àm
.
id
);

666 
	`‰ì
(
sim∂e
->
°r
[0].
db_öfo
);

667 
	`‰ì
(
sim∂e
->
°r
[1].
db_öfo
);

668 
	`‰ì
(
sim∂e
);

669 
	}
}

671 
	$sim∂e_upd©e
(
¢d_mixî_ñem_t
 *
mñem
)

673 
£Àm_n⁄e_t
 *
sim∂e
;

674 
ˇps
, 
pch™√ls
, 
cch™√ls
;

675 
pmö
, 
pmax
, 
cmö
, 
cmax
;

676 
£Àm_˘l_t
 *
˘l
;

678 
ˇps
 = 0;

679 
pch™√ls
 = 0;

680 
pmö
 = 
LONG_MAX
;

681 
pmax
 = 
LONG_MIN
;

682 
cch™√ls
 = 0;

683 
cmö
 = 
LONG_MAX
;

684 
cmax
 = 
LONG_MIN
;

685 
	`as£π
(
	`¢d_mixî_ñem_gë_ty≥
(
mñem
Ë=
SND_MIXER_ELEM_SIMPLE
);

686 
sim∂e
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
mñem
);

687 
˘l
 = &
sim∂e
->
˘ls
[
CTL_SINGLE
];

688 i‡(
˘l
->
ñem
) {

689 
pch™√ls
 = 
cch™√ls
 = 
˘l
->
vÆues
;

690 i‡(
˘l
->
ty≥
 =
SND_CTL_ELEM_TYPE_INTEGER
) {

691 
ˇps
 |
SM_CAP_GVOLUME
;

692 
pmö
 = 
cmö
 = 
˘l
->
mö
;

693 
pmax
 = 
cmax
 = 
˘l
->
max
;

695 
ˇps
 |
SM_CAP_GSWITCH
;

697 
˘l
 = &
sim∂e
->
˘ls
[
CTL_GLOBAL_SWITCH
];

698 i‡(
˘l
->
ñem
) {

699 i‡(
pch™√ls
 < 
˘l
->
vÆues
)

700 
pch™√ls
 = 
˘l
->
vÆues
;

701 i‡(
cch™√ls
 < 
˘l
->
vÆues
)

702 
cch™√ls
 = 
˘l
->
vÆues
;

703 
ˇps
 |
SM_CAP_GSWITCH
;

705 
˘l
 = &
sim∂e
->
˘ls
[
CTL_GLOBAL_ROUTE
];

706 i‡(
˘l
->
ñem
) {

707 i‡(
pch™√ls
 < 
˘l
->
vÆues
)

708 
pch™√ls
 = 
˘l
->
vÆues
;

709 i‡(
cch™√ls
 < 
˘l
->
vÆues
)

710 
cch™√ls
 = 
˘l
->
vÆues
;

711 
ˇps
 |
SM_CAP_GSWITCH
;

713 
˘l
 = &
sim∂e
->
˘ls
[
CTL_GLOBAL_VOLUME
];

714 i‡(
˘l
->
ñem
) {

715 i‡(
pch™√ls
 < 
˘l
->
vÆues
)

716 
pch™√ls
 = 
˘l
->
vÆues
;

717 i‡(
pmö
 > 
˘l
->
mö
)

718 
pmö
 = 
˘l
->
mö
;

719 i‡(
pmax
 < 
˘l
->
max
)

720 
pmax
 = 
˘l
->
max
;

721 i‡(
cch™√ls
 < 
˘l
->
vÆues
)

722 
cch™√ls
 = 
˘l
->
vÆues
;

723 i‡(
cmö
 > 
˘l
->
mö
)

724 
cmö
 = 
˘l
->
mö
;

725 i‡(
cmax
 < 
˘l
->
max
)

726 
cmax
 = 
˘l
->
max
;

727 
ˇps
 |
SM_CAP_GVOLUME
;

729 
˘l
 = &
sim∂e
->
˘ls
[
CTL_PLAYBACK_SWITCH
];

730 i‡(
˘l
->
ñem
) {

731 i‡(
pch™√ls
 < 
˘l
->
vÆues
)

732 
pch™√ls
 = 
˘l
->
vÆues
;

733 
ˇps
 |
SM_CAP_PSWITCH
;

734 
ˇps
 &~
SM_CAP_GSWITCH
;

736 
˘l
 = &
sim∂e
->
˘ls
[
CTL_PLAYBACK_ROUTE
];

737 i‡(
˘l
->
ñem
) {

738 i‡(
pch™√ls
 < 
˘l
->
vÆues
)

739 
pch™√ls
 = 
˘l
->
vÆues
;

740 
ˇps
 |
SM_CAP_PSWITCH
;

741 
ˇps
 &~
SM_CAP_GSWITCH
;

743 
˘l
 = &
sim∂e
->
˘ls
[
CTL_CAPTURE_SWITCH
];

744 i‡(
˘l
->
ñem
) {

745 i‡(
cch™√ls
 < 
˘l
->
vÆues
)

746 
cch™√ls
 = 
˘l
->
vÆues
;

747 
ˇps
 |
SM_CAP_CSWITCH
;

748 
ˇps
 &~
SM_CAP_GSWITCH
;

750 
˘l
 = &
sim∂e
->
˘ls
[
CTL_CAPTURE_ROUTE
];

751 i‡(
˘l
->
ñem
) {

752 i‡(
cch™√ls
 < 
˘l
->
vÆues
)

753 
cch™√ls
 = 
˘l
->
vÆues
;

754 
ˇps
 |
SM_CAP_CSWITCH
;

755 
ˇps
 &~
SM_CAP_GSWITCH
;

757 
˘l
 = &
sim∂e
->
˘ls
[
CTL_PLAYBACK_VOLUME
];

758 i‡(
˘l
->
ñem
) {

759 i‡(
pch™√ls
 < 
˘l
->
vÆues
)

760 
pch™√ls
 = 
˘l
->
vÆues
;

761 i‡(
pmö
 > 
˘l
->
mö
)

762 
pmö
 = 
˘l
->
mö
;

763 i‡(
pmax
 < 
˘l
->
max
)

764 
pmax
 = 
˘l
->
max
;

765 
ˇps
 |
SM_CAP_PVOLUME
;

766 
ˇps
 &~
SM_CAP_GVOLUME
;

768 
˘l
 = &
sim∂e
->
˘ls
[
CTL_CAPTURE_VOLUME
];

769 i‡(
˘l
->
ñem
) {

770 i‡(
cch™√ls
 < 
˘l
->
vÆues
)

771 
cch™√ls
 = 
˘l
->
vÆues
;

772 i‡(
cmö
 > 
˘l
->
mö
)

773 
cmö
 = 
˘l
->
mö
;

774 i‡(
cmax
 < 
˘l
->
max
)

775 
cmax
 = 
˘l
->
max
;

776 
ˇps
 |
SM_CAP_CVOLUME
;

777 
ˇps
 &~
SM_CAP_GVOLUME
;

779 
˘l
 = &
sim∂e
->
˘ls
[
CTL_CAPTURE_SOURCE
];

780 i‡(
˘l
->
ñem
) {

781 i‡(
cch™√ls
 < 
˘l
->
vÆues
)

782 
cch™√ls
 = 
˘l
->
vÆues
;

783 
ˇps
 |
SM_CAP_CSWITCH
 | 
SM_CAP_CSWITCH_EXCL
;

784 
ˇps
 &~
SM_CAP_GSWITCH
;

786 
˘l
 = &
sim∂e
->
˘ls
[
CTL_GLOBAL_ENUM
];

787 i‡(
˘l
->
ñem
) {

788 i‡(
pch™√ls
 < 
˘l
->
vÆues
)

789 
pch™√ls
 = 
˘l
->
vÆues
;

790 
ˇps
 |
SM_CAP_PENUM
 | 
SM_CAP_CENUM
;

792 
˘l
 = &
sim∂e
->
˘ls
[
CTL_PLAYBACK_ENUM
];

793 i‡(
˘l
->
ñem
) {

794 i‡(
pch™√ls
 < 
˘l
->
vÆues
)

795 
pch™√ls
 = 
˘l
->
vÆues
;

796 
ˇps
 |
SM_CAP_PENUM
;

798 
˘l
 = &
sim∂e
->
˘ls
[
CTL_CAPTURE_ENUM
];

799 i‡(
˘l
->
ñem
) {

800 i‡(
pch™√ls
 < 
˘l
->
vÆues
)

801 
pch™√ls
 = 
˘l
->
vÆues
;

802 
ˇps
 |
SM_CAP_CENUM
;

804 i‡(
pch™√ls
 > 32)

805 
pch™√ls
 = 32;

806 i‡(
cch™√ls
 > 32)

807 
cch™√ls
 = 32;

808 i‡(
ˇps
 & (
SM_CAP_GSWITCH
|
SM_CAP_PSWITCH
))

809 
ˇps
 |
SM_CAP_PSWITCH_JOIN
;

810 i‡(
ˇps
 & (
SM_CAP_GVOLUME
|
SM_CAP_PVOLUME
))

811 
ˇps
 |
SM_CAP_PVOLUME_JOIN
;

812 i‡(
ˇps
 & (
SM_CAP_GSWITCH
|
SM_CAP_CSWITCH
))

813 
ˇps
 |
SM_CAP_CSWITCH_JOIN
;

814 i‡(
ˇps
 & (
SM_CAP_GVOLUME
|
SM_CAP_CVOLUME
))

815 
ˇps
 |
SM_CAP_CVOLUME_JOIN
;

816 i‡(
pch™√ls
 > 1 || 
cch™√ls
 > 1) {

817 i‡(
sim∂e
->
˘ls
[
CTL_SINGLE
].
ñem
 &&

818 
sim∂e
->
˘ls
[
CTL_SINGLE
].
vÆues
 > 1) {

819 i‡(
ˇps
 & 
SM_CAP_GSWITCH
)

820 
ˇps
 &~(
SM_CAP_PSWITCH_JOIN
|
SM_CAP_CSWITCH_JOIN
);

822 
ˇps
 &~(
SM_CAP_PVOLUME_JOIN
|
SM_CAP_CVOLUME_JOIN
);

824 i‡(
sim∂e
->
˘ls
[
CTL_GLOBAL_ROUTE
].
ñem
 ||

825 (
sim∂e
->
˘ls
[
CTL_GLOBAL_SWITCH
].
ñem
 &&

826 
sim∂e
->
˘ls
[
CTL_GLOBAL_SWITCH
].
vÆues
 > 1)) {

827 
ˇps
 &~(
SM_CAP_PSWITCH_JOIN
|
SM_CAP_CSWITCH_JOIN
);

829 i‡(
sim∂e
->
˘ls
[
CTL_GLOBAL_VOLUME
].
ñem
 &&

830 
sim∂e
->
˘ls
[
CTL_GLOBAL_VOLUME
].
vÆues
 > 1) {

831 
ˇps
 &~(
SM_CAP_PVOLUME_JOIN
|
SM_CAP_CVOLUME_JOIN
);

834 i‡(
pch™√ls
 > 1) {

835 i‡(
sim∂e
->
˘ls
[
CTL_PLAYBACK_ROUTE
].
ñem
 ||

836 (
sim∂e
->
˘ls
[
CTL_PLAYBACK_SWITCH
].
ñem
 &&

837 
sim∂e
->
˘ls
[
CTL_PLAYBACK_SWITCH
].
vÆues
 > 1)) {

838 
ˇps
 &~
SM_CAP_PSWITCH_JOIN
;

840 i‡(
sim∂e
->
˘ls
[
CTL_PLAYBACK_VOLUME
].
ñem
 &&

841 
sim∂e
->
˘ls
[
CTL_PLAYBACK_VOLUME
].
vÆues
 > 1) {

842 
ˇps
 &~
SM_CAP_PVOLUME_JOIN
;

845 i‡(
cch™√ls
 > 1) {

846 i‡(
sim∂e
->
˘ls
[
CTL_CAPTURE_ROUTE
].
ñem
 ||

847 (
sim∂e
->
˘ls
[
CTL_CAPTURE_SWITCH
].
ñem
 &&

848 
sim∂e
->
˘ls
[
CTL_CAPTURE_SWITCH
].
vÆues
 > 1) ||

849 (
sim∂e
->
˘ls
[
CTL_CAPTURE_SOURCE
].
ñem
 &&

850 
sim∂e
->
˘ls
[
CTL_CAPTURE_SOURCE
].
vÆues
 > 1)) {

851 
ˇps
 &~
SM_CAP_CSWITCH_JOIN
;

853 i‡(
sim∂e
->
˘ls
[
CTL_CAPTURE_VOLUME
].
ñem
 &&

854 
sim∂e
->
˘ls
[
CTL_CAPTURE_VOLUME
].
vÆues
 > 1) {

855 
ˇps
 &~
SM_CAP_CVOLUME_JOIN
;

860 i‡((
ˇps
 & (
SM_CAP_GSWITCH
|
SM_CAP_PSWITCH
|
SM_CAP_CSWITCH
)) &&

861 (
ˇps
 & (
SM_CAP_GSWITCH
|
SM_CAP_PSWITCH
|
SM_CAP_CSWITCH
)) == (caps & SM_CAP_GSWITCH)) {

862 
ˇps
 &~(
SM_CAP_GSWITCH
|
SM_CAP_CSWITCH_JOIN
|
SM_CAP_CSWITCH_EXCL
);

863 
ˇps
 |
SM_CAP_PSWITCH
;

866 i‡((
ˇps
 & 
SM_CAP_GSWITCH
) &&

867 (
ˇps
 & (
SM_CAP_PSWITCH
|
SM_CAP_CSWITCH
)) == 0)

868 
ˇps
 |
SM_CAP_PSWITCH
|
SM_CAP_CSWITCH
;

870 i‡((
ˇps
 & 
SM_CAP_GVOLUME
) &&

871 (
ˇps
 & (
SM_CAP_PVOLUME
|
SM_CAP_CVOLUME
)) == 0)

872 
ˇps
 |
SM_CAP_PVOLUME
|
SM_CAP_CVOLUME
;

874 
sim∂e
->
£Àm
.
ˇps
 = caps;

875 
sim∂e
->
°r
[
SM_PLAY
].
ch™√ls
 = 
pch™√ls
;

876 i‡(!
sim∂e
->
°r
[
SM_PLAY
].
ønge
) {

877 
sim∂e
->
°r
[
SM_PLAY
].
mö
 = 
pmö
 !
LONG_MAX
 ?Ömin : 0;

878 
sim∂e
->
°r
[
SM_PLAY
].
max
 = 
pmax
 !
LONG_MIN
 ?Ömax : 0;

880 
sim∂e
->
°r
[
SM_CAPT
].
ch™√ls
 = 
cch™√ls
;

881 i‡(!
sim∂e
->
°r
[
SM_CAPT
].
ønge
) {

882 
sim∂e
->
°r
[
SM_CAPT
].
mö
 = 
cmö
 !
LONG_MAX
 ? cmin : 0;

883 
sim∂e
->
°r
[
SM_CAPT
].
max
 = 
cmax
 !
LONG_MIN
 ? cmax : 0;

886 
	}
}

888 #i‚de‡
DOC_HIDDEN


889 c⁄° 
	ssuf
 {

890 c⁄° *
	msuffix
;

891 
£Àm_˘l_ty≥_t
 
	mty≥
;

892 } 
	gsuffixes
[] = {

893 {" Pœyback Enum", 
CTL_PLAYBACK_ENUM
},

894 {" Pœyback Swôch", 
CTL_PLAYBACK_SWITCH
},

895 {" Pœyback Rouã", 
CTL_PLAYBACK_ROUTE
},

896 {" Pœyback Vﬁume", 
CTL_PLAYBACK_VOLUME
},

897 {" C≠tuª Enum", 
CTL_CAPTURE_ENUM
},

898 {" C≠tuª Swôch", 
CTL_CAPTURE_SWITCH
},

899 {" C≠tuª Rouã", 
CTL_CAPTURE_ROUTE
},

900 {" C≠tuª Vﬁume", 
CTL_CAPTURE_VOLUME
},

901 {" Enum", 
CTL_GLOBAL_ENUM
},

902 {" Swôch", 
CTL_GLOBAL_SWITCH
},

903 {" Rouã", 
CTL_GLOBAL_ROUTE
},

904 {" Vﬁume", 
CTL_GLOBAL_VOLUME
},

905 {
NULL
, 0}

910 
	$ba£_Àn
(c⁄° *
«me
, 
£Àm_˘l_ty≥_t
 *
ty≥
)

912 c⁄° 
suf
 *
p
;

913 
size_t
 
∆í
 = 
	`°æí
(
«me
);

916 i‡(!
	`°rcmp
(
«me
, "Capture Volume")) {

917 *
ty≥
 = 
CTL_CAPTURE_VOLUME
;

918  
	`°æí
("Capture");

920 i‡(!
	`°rcmp
(
«me
, "Capture Switch")) {

921 *
ty≥
 = 
CTL_CAPTURE_SWITCH
;

922  
	`°æí
("Capture");

925 
p
 = 
suffixes
;Ö->
suffix
;Ö++) {

926 
size_t
 
¶í
 = 
	`°æí
(
p
->
suffix
);

927 
size_t
 
l
;

928 i‡(
∆í
 > 
¶í
) {

929 
l
 = 
∆í
 - 
¶í
;

930 i‡(
	`°∫cmp
(
«me
 + 
l
, 
p
->
suffix
, 
¶í
) == 0 &&

931 (
l
 < 1 || 
«me
[l-1] != '-')) {

932 *
ty≥
 = 
p
->type;

933  
l
;

945 i‡(!
	`°rcmp
(
«me
, "Input Source")) {

946 *
ty≥
 = 
CTL_CAPTURE_ROUTE
;

947  
	`°æí
(
«me
);

949 i‡(
	`°r°r
(
«me
, "3D Control")) {

950 i‡(
	`°r°r
(
«me
, "Depth")) {

951 *
ty≥
 = 
CTL_PLAYBACK_VOLUME
;

952  
	`°æí
(
«me
);

956 *
ty≥
 = 
CTL_SINGLE
;

957  
	`°æí
(
«me
);

958 
	}
}

965 
	$_¢d_mixî_£Àm_£t_vﬁume
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
)

967 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

968 i‡(
s
->
£Àm
.
ˇps
 & 
SM_CAP_GVOLUME
)

969 
dú
 = 
SM_PLAY
;

970 i‡((Ë
ch™√l
 >
s
->
°r
[
dú
].
ch™√ls
)

972 i‡(
vÆue
 < 
s
->
°r
[
dú
].
mö
 || vÆuê> s->°r[dú].
max
)

974 i‡(
s
->
£Àm
.
ˇps
 &

975 (
dú
 =
SM_PLAY
 ? 
SM_CAP_PVOLUME_JOIN
 : 
SM_CAP_CVOLUME_JOIN
))

976 
ch™√l
 = 0;

977 i‡(
vÆue
 !
s
->
°r
[
dú
].
vﬁ
[
ch™√l
]) {

978 
s
->
°r
[
dú
].
vﬁ
[
ch™√l
] = 
vÆue
;

982 
	}
}

984 
	$_¢d_mixî_£Àm_£t_swôch
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
)

986 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

987 i‡((Ë
ch™√l
 >
s
->
°r
[
dú
].
ch™√ls
)

989 i‡(
s
->
£Àm
.
ˇps
 &

990 (
dú
 =
SM_PLAY
 ? 
SM_CAP_PSWITCH_JOIN
 : 
SM_CAP_CSWITCH_JOIN
))

991 
ch™√l
 = 0;

992 i‡(
vÆue
) {

993 i‡(!(
s
->
°r
[
dú
].
sw
 & (1 << 
ch™√l
))) {

994 
s
->
°r
[
dú
].
sw
 |1 << 
ch™√l
;

998 i‡(
s
->
°r
[
dú
].
sw
 & (1 << 
ch™√l
)) {

999 
s
->
°r
[
dú
].
sw
 &~(1 << 
ch™√l
);

1004 
	}
}

1006 
	$is_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
, 
cmd
, 
vÆ
)

1008 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

1010 
cmd
) {

1012 
SM_OPS_IS_ACTIVE
: {

1013 
£Àm_˘l_ty≥_t
 
˘l
;

1014 
˘l
 = 
CTL_SINGLE
; cé <
CTL_LAST
; ctl++)

1015 i‡(
s
->
˘ls
[
˘l
].
ñem
 !
NULL
 && s->˘ls[˘l].
öa˘ive
)

1020 
SM_OPS_IS_MONO
:

1021  
s
->
°r
[
dú
].
ch™√ls
 == 1;

1023 
SM_OPS_IS_CHANNEL
:

1024  (Ë
vÆ
 < 
s
->
°r
[
dú
].
ch™√ls
;

1026 
SM_OPS_IS_ENUMERATED
:

1027 i‡(
vÆ
 == 1) {

1028 i‡(
dú
 =
SM_PLAY
 && (
s
->
£Àm
.
ˇps
 & 
SM_CAP_PENUM
Ë&& !(s->£Àm.ˇp†& 
SM_CAP_CENUM
) )

1030 i‡(
dú
 =
SM_CAPT
 && (
s
->
£Àm
.
ˇps
 & 
SM_CAP_CENUM
Ë&& !(s->£Àm.ˇp†& 
SM_CAP_PENUM
) )

1034 i‡(
s
->
£Àm
.
ˇps
 & (
SM_CAP_CENUM
 | 
SM_CAP_PENUM
) )

1038 
SM_OPS_IS_ENUMCNT
:

1040 i‡–(
s
->
£Àm
.
ˇps
 & (
SM_CAP_CENUM
 | 
SM_CAP_PENUM
)) == (SM_CAP_CENUM | SM_CAP_PENUM) ) {

1041 i‡(! 
s
->
˘ls
[
CTL_GLOBAL_ENUM
].
ñem
)

1042  -
EINVAL
;

1043  
s
->
˘ls
[
CTL_GLOBAL_ENUM
].
max
;

1045 } i‡(
s
->
£Àm
.
ˇps
 & 
SM_CAP_PENUM
 ) {

1046 i‡(! 
s
->
˘ls
[
CTL_PLAYBACK_ENUM
].
ñem
)

1047  -
EINVAL
;

1048  
s
->
˘ls
[
CTL_PLAYBACK_ENUM
].
max
;

1050 } i‡(
s
->
£Àm
.
ˇps
 & 
SM_CAP_CENUM
 ) {

1051 i‡(! 
s
->
˘ls
[
CTL_CAPTURE_ENUM
].
ñem
)

1052  -
EINVAL
;

1053  
s
->
˘ls
[
CTL_CAPTURE_ENUM
].
max
;

1059 
	}
}

1061 
	$gë_ønge_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

1062 *
mö
, *
max
)

1064 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

1065 *
mö
 = 
s
->
°r
[
dú
].min;

1066 *
max
 = 
s
->
°r
[
dú
].max;

1068 
	}
}

1070 
	$£t_ønge_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

1071 
mö
, 
max
)

1073 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

1074 
îr
;

1076 
s
->
°r
[
dú
].
ønge
 = 1;

1077 
s
->
°r
[
dú
].
mö
 = min;

1078 
s
->
°r
[
dú
].
max
 = max;

1079 i‡((
îr
 = 
	`£Àm_ªad
(
ñem
)) < 0)

1080  
îr
;

1082 
	}
}

1084 
	$gë_vﬁume_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

1085 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
)

1087 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

1088 i‡(
s
->
£Àm
.
ˇps
 & 
SM_CAP_GVOLUME
)

1089 
dú
 = 
SM_PLAY
;

1090 i‡((Ë
ch™√l
 >
s
->
°r
[
dú
].
ch™√ls
)

1091  -
EINVAL
;

1092 *
vÆue
 = 
s
->
°r
[
dú
].
vﬁ
[
ch™√l
];

1094 
	}
}

1096 
öô_db_ønge
(
¢d_h˘l_ñem_t
 *
˘l
, 
£Àm_°r
 *
ªc
);

1098 
	$c⁄vît_to_dB
(
¢d_h˘l_ñem_t
 *
˘l
, 
£Àm_°r
 *
ªc
,

1099 
vﬁume
, *
db_gaö
)

1101 i‡(
	`öô_db_ønge
(
˘l
, 
ªc
) < 0)

1102  -
EINVAL
;

1103  
	`¢d_év_c⁄vît_to_dB
(
ªc
->
db_öfo
,Ñec->
mö
,Ñec->
max
,

1104 
vﬁume
, 
db_gaö
);

1105 
	}
}

1109 
	$öô_db_ønge
(
¢d_h˘l_ñem_t
 *
˘l
, 
£Àm_°r
 *
ªc
)

1111 
¢d_˘l_ñem_öfo_t
 
öfo
 = {0};

1112 *
év
 = 
NULL
;

1113 c⁄° 
év_size
 = 4096;

1114 *
dbªc
;

1115 
db_size
;

1117 i‡(
ªc
->
db_öô_îr‹
)

1118  -
EINVAL
;

1119 i‡(
ªc
->
db_öôülized
)

1122 i‡(
	`¢d_h˘l_ñem_öfo
(
˘l
, &
öfo
) < 0)

1123 
îr‹
;

1124 i‡(!
	`¢d_˘l_ñem_öfo_is_év_ªadabÀ
(&
öfo
))

1125 
îr‹
;

1126 
év
 = 
	`mÆloc
(
év_size
);

1127 i‡(!
év
)

1128  -
ENOMEM
;

1129 i‡(
	`¢d_h˘l_ñem_év_ªad
(
˘l
, 
év
, 
év_size
) < 0)

1130 
îr‹
;

1131 
db_size
 = 
	`¢d_év_∑r£_dB_öfo
(
év
, 
év_size
, &
dbªc
);

1132 i‡(
db_size
 < 0)

1133 
îr‹
;

1134 
ªc
->
db_öfo
 = 
	`mÆloc
(
db_size
);

1135 i‡(!
ªc
->
db_öfo
)

1136 
îr‹
;

1137 
	`mem˝y
(
ªc
->
db_öfo
, 
dbªc
, 
db_size
);

1138 
	`‰ì
(
év
);

1139 
ªc
->
db_öôülized
 = 1;

1142 
îr‹
:

1143 
	`‰ì
(
év
);

1144 
ªc
->
db_öô_îr‹
 = 1;

1145  -
EINVAL
;

1146 
	}
}

1149 
£Àm_˘l_t
 *
	$gë_£Àm_˘l
(
£Àm_n⁄e_t
 *
s
, 
dú
)

1151 
£Àm_˘l_t
 *
c
;

1152 i‡(
dú
 =
SM_PLAY
)

1153 
c
 = &
s
->
˘ls
[
CTL_PLAYBACK_VOLUME
];

1154 i‡(
dú
 =
SM_CAPT
)

1155 
c
 = &
s
->
˘ls
[
CTL_CAPTURE_VOLUME
];

1157  
NULL
;

1158 i‡(! 
c
->
ñem
)

1159 
c
 = &
s
->
˘ls
[
CTL_GLOBAL_VOLUME
];

1160 i‡(! 
c
->
ñem
)

1161 
c
 = &
s
->
˘ls
[
CTL_SINGLE
];

1162 i‡(! 
c
->
ñem
)

1163  
NULL
;

1164 i‡(
c
->
ty≥
 !
SND_CTL_ELEM_TYPE_INTEGER
)

1165  
NULL
;

1166  
c
;

1167 
	}
}

1169 
	$gë_dB_ønge
(
¢d_h˘l_ñem_t
 *
˘l
, 
£Àm_°r
 *
ªc
,

1170 *
mö
, *
max
)

1172 i‡(
	`öô_db_ønge
(
˘l
, 
ªc
) < 0)

1173  -
EINVAL
;

1175  
	`¢d_év_gë_dB_ønge
(
ªc
->
db_öfo
,Ñec->
mö
,Ñec->
max
, min, max);

1176 
	}
}

1178 
	$gë_dB_ønge_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

1179 *
mö
, *
max
)

1181 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

1182 
£Àm_˘l_t
 *
c
;

1184 i‡(
s
->
£Àm
.
ˇps
 & 
SM_CAP_GVOLUME
)

1185 
dú
 = 
SM_PLAY
;

1186 
c
 = 
	`gë_£Àm_˘l
(
s
, 
dú
);

1187 i‡(! 
c
)

1188  -
EINVAL
;

1189  
	`gë_dB_ønge
(
c
->
ñem
, &
s
->
°r
[
dú
], 
mö
, 
max
);

1190 
	}
}

1192 
	$c⁄vît_‰om_dB
(
¢d_h˘l_ñem_t
 *
˘l
, 
£Àm_°r
 *
ªc
,

1193 
db_gaö
, *
vÆue
, 
xdú
)

1195 i‡(
	`öô_db_ønge
(
˘l
, 
ªc
) < 0)

1196  -
EINVAL
;

1198  
	`¢d_év_c⁄vît_‰om_dB
(
ªc
->
db_öfo
,Ñec->
mö
,Ñec->
max
,

1199 
db_gaö
, 
vÆue
, 
xdú
);

1200 
	}
}

1202 
	$ask_vﬁ_dB_›s
(
¢d_mixî_ñem_t
 *
ñem
,

1203 
dú
,

1204 
vÆue
,

1205 *
dBvÆue
)

1207 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

1208 
£Àm_˘l_t
 *
c
;

1210 
c
 = 
	`gë_£Àm_˘l
(
s
, 
dú
);

1211 i‡(! 
c
)

1212  -
EINVAL
;

1213 
ªs
 = 
	`c⁄vît_to_dB
(
c
->
ñem
, &
s
->
°r
[
dú
], 
vÆue
, 
dBvÆue
);

1214  
ªs
;

1215 
	}
}

1217 
	$gë_dB_›s
(
¢d_mixî_ñem_t
 *
ñem
,

1218 
dú
,

1219 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
,

1220 *
vÆue
)

1222 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

1223 
£Àm_˘l_t
 *
c
;

1224 
îr
;

1225 
vﬁume
, 
db_gaö
;

1227 i‡(
s
->
£Àm
.
ˇps
 & 
SM_CAP_GVOLUME
)

1228 
dú
 = 
SM_PLAY
;

1229 
c
 = 
	`gë_£Àm_˘l
(
s
, 
dú
);

1230 i‡(! 
c
)

1231  -
EINVAL
;

1232 i‡((
îr
 = 
	`gë_vﬁume_›s
(
ñem
, 
dú
, 
ch™√l
, &
vﬁume
)) < 0)

1233 
_îr
;

1234 i‡((
îr
 = 
	`c⁄vît_to_dB
(
c
->
ñem
, &
s
->
°r
[
dú
], 
vﬁume
, &
db_gaö
)) < 0)

1235 
_îr
;

1236 
îr
 = 0;

1237 *
vÆue
 = 
db_gaö
;

1238 
_îr
:

1239  
îr
;

1240 
	}
}

1242 
	$gë_swôch_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

1243 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, *
vÆue
)

1245 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

1246 i‡(
s
->
£Àm
.
ˇps
 & 
SM_CAP_GSWITCH
)

1247 
dú
 = 
SM_PLAY
;

1248 i‡((Ë
ch™√l
 >
s
->
°r
[
dú
].
ch™√ls
)

1249  -
EINVAL
;

1250 *
vÆue
 = !!(
s
->
°r
[
dú
].
sw
 & (1 << 
ch™√l
));

1252 
	}
}

1254 
	$£t_vﬁume_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

1255 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
)

1257 
ch™ged
;

1258 
ch™ged
 = 
	`_¢d_mixî_£Àm_£t_vﬁume
(
ñem
, 
dú
, 
ch™√l
, 
vÆue
);

1259 i‡(
ch™ged
 < 0)

1260  
ch™ged
;

1261 i‡(
ch™ged
)

1262  
	`£Àm_wrôe
(
ñem
);

1264 
	}
}

1266 
	$ask_dB_vﬁ_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

1267 
dbVÆue
, *
vÆue
, 
xdú
)

1269 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

1270 
£Àm_˘l_t
 *
c
;

1272 i‡(
s
->
£Àm
.
ˇps
 & 
SM_CAP_GVOLUME
)

1273 
dú
 = 
SM_PLAY
;

1274 
c
 = 
	`gë_£Àm_˘l
(
s
, 
dú
);

1275 i‡(! 
c
)

1276  -
EINVAL
;

1277  
	`c⁄vît_‰om_dB
(
c
->
ñem
, &
s
->
°r
[
dú
], 
dbVÆue
, 
vÆue
, 
xdú
);

1278 
	}
}

1280 
	$£t_dB_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

1281 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
,

1282 
db_gaö
, 
xdú
)

1284 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

1285 
£Àm_˘l_t
 *
c
;

1286 
vÆue
;

1287 
îr
;

1289 i‡(
s
->
£Àm
.
ˇps
 & 
SM_CAP_GVOLUME
)

1290 
dú
 = 
SM_PLAY
;

1291 
c
 = 
	`gë_£Àm_˘l
(
s
, 
dú
);

1292 i‡(! 
c
)

1293  -
EINVAL
;

1294 
îr
 = 
	`c⁄vît_‰om_dB
(
c
->
ñem
, &
s
->
°r
[
dú
], 
db_gaö
, &
vÆue
, 
xdú
);

1295 i‡(
îr
 < 0)

1296  
îr
;

1297  
	`£t_vﬁume_›s
(
ñem
, 
dú
, 
ch™√l
, 
vÆue
);

1298 
	}
}

1300 
	$£t_swôch_›s
(
¢d_mixî_ñem_t
 *
ñem
, 
dú
,

1301 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
, 
vÆue
)

1303 
ch™ged
;

1304 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

1305 i‡(
s
->
£Àm
.
ˇps
 & 
SM_CAP_GSWITCH
)

1306 
dú
 = 
SM_PLAY
;

1307 i‡(
dú
 =
SM_PLAY
) {

1308 i‡(! (
s
->
£Àm
.
ˇps
 & (
SM_CAP_GSWITCH
|
SM_CAP_PSWITCH
)))

1309  -
EINVAL
;

1311 i‡(! (
s
->
£Àm
.
ˇps
 & (
SM_CAP_GSWITCH
|
SM_CAP_CSWITCH
)))

1312  -
EINVAL
;

1314 
ch™ged
 = 
	`_¢d_mixî_£Àm_£t_swôch
(
ñem
, 
dú
, 
ch™√l
, 
vÆue
);

1315 i‡(
ch™ged
 < 0)

1316  
ch™ged
;

1317 i‡(
ch™ged
)

1318  
	`£Àm_wrôe
(
ñem
);

1320 
	}
}

1322 
	$íum_ôem_«me_›s
(
¢d_mixî_ñem_t
 *
ñem
,

1323 
ôem
,

1324 
size_t
 
maxÀn
, *
buf
)

1326 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

1327 
¢d_˘l_ñem_öfo_t
 
öfo
 = {0};

1328 
¢d_h˘l_ñem_t
 *
hñem
;

1329 
ty≥
;

1331 
ty≥
 = 
CTL_GLOBAL_ENUM
;

1332 
hñem
 = 
s
->
˘ls
[
ty≥
].
ñem
;

1333 i‡(!
hñem
) {

1334 
ty≥
 = 
CTL_PLAYBACK_ENUM
;

1335 
hñem
 = 
s
->
˘ls
[
ty≥
].
ñem
;

1337 i‡(!
hñem
) {

1338 
ty≥
 = 
CTL_CAPTURE_ENUM
;

1339 
hñem
 = 
s
->
˘ls
[
ty≥
].
ñem
;

1341 
	`as£π
(
hñem
);

1342 i‡(
ôem
 >()
s
->
˘ls
[
ty≥
].
max
)

1343  -
EINVAL
;

1344 
	`¢d_h˘l_ñem_öfo
(
hñem
, &
öfo
);

1345 
	`¢d_˘l_ñem_öfo_£t_ôem
(&
öfo
, 
ôem
);

1346 
	`¢d_h˘l_ñem_öfo
(
hñem
, &
öfo
);

1347 
	`°∫˝y
(
buf
, 
	`¢d_˘l_ñem_öfo_gë_ôem_«me
(&
öfo
), 
maxÀn
);

1349 
	}
}

1351 
	$gë_íum_ôem_›s
(
¢d_mixî_ñem_t
 *
ñem
,

1352 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
,

1353 *
ôemp
)

1355 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

1356 
¢d_˘l_ñem_vÆue_t
 
˘l
 = {0};

1357 
¢d_h˘l_ñem_t
 *
hñem
;

1358 
îr
;

1360 i‡((Ë
ch™√l
 >
s
->
°r
[0].
ch™√ls
)

1361  -
EINVAL
;

1362 
hñem
 = 
s
->
˘ls
[
CTL_GLOBAL_ENUM
].
ñem
;

1363 i‡(!
hñem
Ëhñem = 
s
->
˘ls
[
CTL_PLAYBACK_ENUM
].
ñem
;

1364 i‡(!
hñem
Ëhñem = 
s
->
˘ls
[
CTL_CAPTURE_ENUM
].
ñem
;

1365 
	`as£π
(
hñem
);

1366 
îr
 = 
	`¢d_h˘l_ñem_ªad
(
hñem
, &
˘l
);

1367 i‡(! 
îr
)

1368 *
ôemp
 = 
	`¢d_˘l_ñem_vÆue_gë_íumî©ed
(&
˘l
, 
ch™√l
);

1369  
îr
;

1370 
	}
}

1372 
	$£t_íum_ôem_›s
(
¢d_mixî_ñem_t
 *
ñem
,

1373 
¢d_mixî_£Àm_ch™√l_id_t
 
ch™√l
,

1374 
ôem
)

1376 
£Àm_n⁄e_t
 *
s
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
ñem
);

1377 
¢d_˘l_ñem_vÆue_t
 
˘l
 = {0};

1378 
¢d_h˘l_ñem_t
 *
hñem
;

1379 
îr
;

1380 
ty≥
;

1382 i‡((Ë
ch™√l
 >
s
->
°r
[0].
ch™√ls
) {

1383  -
EINVAL
;

1385 
ty≥
 = 
CTL_GLOBAL_ENUM
;

1386 
hñem
 = 
s
->
˘ls
[
ty≥
].
ñem
;

1387 i‡(!
hñem
) {

1388 
ty≥
 = 
CTL_PLAYBACK_ENUM
;

1389 
hñem
 = 
s
->
˘ls
[
ty≥
].
ñem
;

1391 i‡(!
hñem
) {

1392 
ty≥
 = 
CTL_CAPTURE_ENUM
;

1393 
hñem
 = 
s
->
˘ls
[
ty≥
].
ñem
;

1395 
	`as£π
(
hñem
);

1396 i‡(
ôem
 >()
s
->
˘ls
[
ty≥
].
max
) {

1397  -
EINVAL
;

1399 
îr
 = 
	`¢d_h˘l_ñem_ªad
(
hñem
, &
˘l
);

1400 i‡(
îr
 < 0) {

1401  
îr
;

1403 
	`¢d_˘l_ñem_vÆue_£t_íumî©ed
(&
˘l
, 
ch™√l
, 
ôem
);

1404  
	`¢d_h˘l_ñem_wrôe
(
hñem
, &
˘l
);

1405 
	}
}

1407 
sm_ñem_›s
 
	gsim∂e_n⁄e_›s
 = {

1408 .
is
 = 
is_›s
,

1409 .
	ggë_ønge
 = 
gë_ønge_›s
,

1410 .
	ggë_dB_ønge
 = 
gë_dB_ønge_›s
,

1411 .
	g£t_ønge
 = 
£t_ønge_›s
,

1412 .
	gask_vﬁ_dB
 = 
ask_vﬁ_dB_›s
,

1413 .
	gask_dB_vﬁ
 = 
ask_dB_vﬁ_›s
,

1414 .
	ggë_vﬁume
 = 
gë_vﬁume_›s
,

1415 .
	ggë_dB
 = 
gë_dB_›s
,

1416 .
	g£t_vﬁume
 = 
£t_vﬁume_›s
,

1417 .
	g£t_dB
 = 
£t_dB_›s
,

1418 .
	ggë_swôch
 = 
gë_swôch_›s
,

1419 .
	g£t_swôch
 = 
£t_swôch_›s
,

1420 .
	gíum_ôem_«me
 = 
íum_ôem_«me_›s
,

1421 .
	ggë_íum_ôem
 = 
gë_íum_ôem_›s
,

1422 .
	g£t_íum_ôem
 = 
£t_íum_ôem_›s


1425 
	$sim∂e_add1
(
¢d_mixî_˛ass_t
 *
˛ass
, c⁄° *
«me
,

1426 
¢d_h˘l_ñem_t
 *
hñem
, 
£Àm_˘l_ty≥_t
 
ty≥
,

1427 
vÆue
)

1429 
¢d_mixî_ñem_t
 *
mñem
;

1430 
¢d_mixî_£Àm_id_t
 *
id
;

1431 
√w
 = 0;

1432 
îr
;

1433 
¢d_˘l_ñem_öfo_t
 
öfo
 = {0};

1434 
£Àm_n⁄e_t
 *
sim∂e
;

1435 c⁄° *
«me1
;

1436 
¢d_˘l_ñem_ty≥_t
 
˘y≥
;

1437 
vÆues
;

1439 
îr
 = 
	`¢d_h˘l_ñem_öfo
(
hñem
, &
öfo
);

1440 i‡(
îr
 < 0)

1441  
îr
;

1442 
˘y≥
 = 
	`¢d_˘l_ñem_öfo_gë_ty≥
(&
öfo
);

1443 
vÆues
 = 
	`¢d_˘l_ñem_öfo_gë_cou¡
(&
öfo
);

1444 
ty≥
) {

1445 
CTL_SINGLE
:

1446 i‡(
˘y≥
 =
SND_CTL_ELEM_TYPE_ENUMERATED
)

1447 
ty≥
 = 
CTL_GLOBAL_ENUM
;

1448 i‡(
˘y≥
 !
SND_CTL_ELEM_TYPE_BOOLEAN
 &&

1449 
˘y≥
 !
SND_CTL_ELEM_TYPE_INTEGER
)

1452 
CTL_GLOBAL_ROUTE
:

1453 
CTL_PLAYBACK_ROUTE
:

1454 
CTL_CAPTURE_ROUTE
:

1456 
n
;

1457 i‡(
˘y≥
 =
SND_CTL_ELEM_TYPE_ENUMERATED
) {

1458 i‡(
ty≥
 =
CTL_PLAYBACK_ROUTE
)

1459 
ty≥
 = 
CTL_PLAYBACK_ENUM
;

1460 i‡(
ty≥
 =
CTL_CAPTURE_ROUTE
)

1461 
ty≥
 = 
CTL_CAPTURE_ENUM
;

1463 
ty≥
 = 
CTL_GLOBAL_ENUM
;

1466 i‡(
˘y≥
 !
SND_CTL_ELEM_TYPE_BOOLEAN
)

1468 #ifde‡
HAVE_SOFT_FLOAT


1470 
n
 = 1;Ç < 256;Ç++)

1471 i‡(
n
 *Ç =
vÆues
)

1474 
n
 = 
	`sqπ
(()
vÆues
);

1476 i‡(
n
 *Ç !
vÆues
)

1478 
vÆues
 = 
n
;

1481 
CTL_GLOBAL_SWITCH
:

1482 
CTL_PLAYBACK_SWITCH
:

1483 
CTL_CAPTURE_SWITCH
:

1484 i‡(
˘y≥
 =
SND_CTL_ELEM_TYPE_ENUMERATED
) {

1485 i‡(
ty≥
 =
CTL_PLAYBACK_SWITCH
)

1486 
ty≥
 = 
CTL_PLAYBACK_ENUM
;

1487 i‡(
ty≥
 =
CTL_CAPTURE_SWITCH
)

1488 
ty≥
 = 
CTL_CAPTURE_ENUM
;

1490 
ty≥
 = 
CTL_GLOBAL_ENUM
;

1493 i‡(
˘y≥
 !
SND_CTL_ELEM_TYPE_BOOLEAN
)

1496 
CTL_GLOBAL_VOLUME
:

1497 
CTL_PLAYBACK_VOLUME
:

1498 
CTL_CAPTURE_VOLUME
:

1499 i‡(
˘y≥
 =
SND_CTL_ELEM_TYPE_ENUMERATED
) {

1500 i‡(
ty≥
 =
CTL_PLAYBACK_VOLUME
)

1501 
ty≥
 = 
CTL_PLAYBACK_ENUM
;

1502 i‡(
ty≥
 =
CTL_CAPTURE_VOLUME
)

1503 
ty≥
 = 
CTL_CAPTURE_ENUM
;

1505 
ty≥
 = 
CTL_GLOBAL_ENUM
;

1508 i‡(
˘y≥
 !
SND_CTL_ELEM_TYPE_INTEGER
)

1511 
CTL_CAPTURE_SOURCE
:

1512 i‡(
˘y≥
 !
SND_CTL_ELEM_TYPE_ENUMERATED
)

1515 
CTL_GLOBAL_ENUM
:

1516 
CTL_PLAYBACK_ENUM
:

1517 
CTL_CAPTURE_ENUM
:

1518 i‡(
˘y≥
 !
SND_CTL_ELEM_TYPE_ENUMERATED
)

1522 
	`as£π
(0);

1525 
«me1
 = 
	`gë_sh‹t_«me
(
«me
);

1526 i‡(
	`¢d_mixî_£Àm_id_mÆloc
(&
id
))

1527  -
ENOMEM
;

1528 
	`¢d_mixî_£Àm_id_£t_«me
(
id
, 
«me1
);

1529 
	`¢d_mixî_£Àm_id_£t_ödex
(
id
, 
	`¢d_h˘l_ñem_gë_ödex
(
hñem
));

1530 
mñem
 = 
	`¢d_mixî_föd_£Àm
(
	`¢d_mixî_˛ass_gë_mixî
(
˛ass
), 
id
);

1531 i‡(!
mñem
) {

1532 
sim∂e
 = 
	`ˇŒoc
(1, (*simple));

1533 i‡(!
sim∂e
) {

1534 
	`¢d_mixî_£Àm_id_‰ì
(
id
);

1535  -
ENOMEM
;

1537 
sim∂e
->
£Àm
.
id
 = id;

1538 
sim∂e
->
£Àm
.
›s
 = &
sim∂e_n⁄e_›s
;

1539 
îr
 = 
	`¢d_mixî_ñem_√w
(&
mñem
, 
SND_MIXER_ELEM_SIMPLE
,

1540 
	`gë_com∑ª_weight
(

1541 
	`¢d_mixî_£Àm_id_gë_«me
(
sim∂e
->
£Àm
.
id
),

1542 
	`¢d_mixî_£Àm_id_gë_ödex
(
sim∂e
->
£Àm
.
id
)),

1543 
sim∂e
, 
£Àm_‰ì
);

1544 i‡(
îr
 < 0) {

1545 
	`¢d_mixî_£Àm_id_‰ì
(
id
);

1546 
	`‰ì
(
sim∂e
);

1547  
îr
;

1549 
√w
 = 1;

1551 
sim∂e
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
mñem
);

1552 
	`¢d_mixî_£Àm_id_‰ì
(
id
);

1554 i‡(
sim∂e
->
˘ls
[
ty≥
].
ñem
) {

1555 
	`SNDERR
("helem (%s,'%s',%u,%u,%u)áppearsÅwice or more",

1556 
	`¢d_˘l_ñem_iÁ˚_«me
(

1557 
	`¢d_h˘l_ñem_gë_öãrÁ˚
(
hñem
)),

1558 
	`¢d_h˘l_ñem_gë_«me
(
hñem
),

1559 
	`¢d_h˘l_ñem_gë_ödex
(
hñem
),

1560 
	`¢d_h˘l_ñem_gë_devi˚
(
hñem
),

1561 
	`¢d_h˘l_ñem_gë_subdevi˚
(
hñem
));

1562 
îr
 = -
EINVAL
;

1563 
__îr‹
;

1565 
sim∂e
->
˘ls
[
ty≥
].
ñem
 = 
hñem
;

1566 
sim∂e
->
˘ls
[
ty≥
].ty≥ = 
	`¢d_˘l_ñem_öfo_gë_ty≥
(&
öfo
);

1567 
sim∂e
->
˘ls
[
ty≥
].
öa˘ive
 = 
	`¢d_˘l_ñem_öfo_is_öa˘ive
(&
öfo
);

1568 
sim∂e
->
˘ls
[
ty≥
].
vÆues
 = values;

1569 i‡–(
ty≥
 =
CTL_GLOBAL_ENUM
) ||

1570 (
ty≥
 =
CTL_PLAYBACK_ENUM
) ||

1571 (
ty≥
 =
CTL_CAPTURE_ENUM
) ) {

1572 
sim∂e
->
˘ls
[
ty≥
].
mö
 = 0;

1573 
sim∂e
->
˘ls
[
ty≥
].
max
 = 
	`¢d_˘l_ñem_öfo_gë_ôems
(&
öfo
);

1575 i‡(
˘y≥
 =
SND_CTL_ELEM_TYPE_INTEGER
) {

1576 
sim∂e
->
˘ls
[
ty≥
].
mö
 =

1577 
	`¢d_˘l_ñem_öfo_gë_mö
(&
öfo
);

1578 
sim∂e
->
˘ls
[
ty≥
].
max
 =

1579 
	`¢d_˘l_ñem_öfo_gë_max
(&
öfo
);

1582 
ty≥
) {

1583 
CTL_CAPTURE_SOURCE
:

1584 
sim∂e
->
ˇ±uª_ôem
 = 
vÆue
;

1589 
îr
 = 
	`¢d_mixî_ñem_©èch
(
mñem
, 
hñem
);

1590 i‡(
îr
 < 0)

1591 
__îr‹
;

1592 
îr
 = 
	`sim∂e_upd©e
(
mñem
);

1593 i‡(
îr
 < 0) {

1594 i‡(
√w
)

1595 
__îr‹
;

1596  
îr
;

1598 i‡(
√w
)

1599 
îr
 = 
	`¢d_mixî_ñem_add
(
mñem
, 
˛ass
);

1601 
îr
 = 
	`¢d_mixî_ñem_öfo
(
mñem
);

1602 i‡(
îr
 < 0)

1603  
îr
;

1604 
îr
 = 
	`£Àm_ªad
(
mñem
);

1605 i‡(
îr
 < 0)

1606  
îr
;

1607 i‡(
îr
)

1608 
îr
 = 
	`¢d_mixî_ñem_vÆue
(
mñem
);

1609  
îr
;

1610 
__îr‹
:

1611 i‡(
√w
)

1612 
	`¢d_mixî_ñem_‰ì
(
mñem
);

1613  -
EINVAL
;

1614 
	}
}

1616 
	$sim∂e_evít_add
(
¢d_mixî_˛ass_t
 *
˛ass
, 
¢d_h˘l_ñem_t
 *
hñem
)

1618 c⁄° *
«me
 = 
	`¢d_h˘l_ñem_gë_«me
(
hñem
);

1619 
£Àm_˘l_ty≥_t
 
ty≥
;

1620 
íame
[128];

1621 
size_t
 
Àn
;

1623 i‡(
	`¢d_h˘l_ñem_gë_öãrÁ˚
(
hñem
Ë!
SND_CTL_ELEM_IFACE_MIXER
)

1625 i‡(
	`°rcmp
(
«me
, "Capture Source") == 0) {

1626 
¢d_˘l_ñem_öfo_t
 
öfo
 = {0};

1627 
k
, 
ôems
;

1628 
îr
;

1629 
îr
 = 
	`¢d_h˘l_ñem_öfo
(
hñem
, &
öfo
);

1630 
	`as£π
(
îr
 >= 0);

1631 i‡(
	`¢d_˘l_ñem_öfo_gë_ty≥
(&
öfo
) !=

1632 
SND_CTL_ELEM_TYPE_ENUMERATED
)

1634 
ôems
 = 
	`¢d_˘l_ñem_öfo_gë_ôems
(&
öfo
);

1635 
k
 = 0; k < 
ôems
; ++k) {

1636 c⁄° *
n
;

1637 
	`¢d_˘l_ñem_öfo_£t_ôem
(&
öfo
, 
k
);

1638 
îr
 = 
	`¢d_h˘l_ñem_öfo
(
hñem
, &
öfo
);

1639 i‡(
îr
 < 0)

1640  
îr
;

1641 
n
 = 
	`¢d_˘l_ñem_öfo_gë_ôem_«me
(&
öfo
);

1642 
îr
 = 
	`sim∂e_add1
(
˛ass
, 
n
, 
hñem
, 
CTL_CAPTURE_SOURCE
,

1643 
k
);

1644 i‡(
îr
 < 0)

1645  
îr
;

1650 
Àn
 = 
	`ba£_Àn
(
«me
, &
ty≥
);

1651 i‡(
Àn
 >(
íame
))

1652 
Àn
 = (
íame
) - 1;

1653 
	`mem˝y
(
íame
, 
«me
, 
Àn
);

1654 
íame
[
Àn
] = 0;

1656  
	`sim∂e_add1
(
˛ass
, 
íame
, 
hñem
, 
ty≥
, 0);

1657 
	}
}

1659 
	$sim∂e_evít_ªmove
(
¢d_h˘l_ñem_t
 *
hñem
,

1660 
¢d_mixî_ñem_t
 *
mñem
)

1662 
£Àm_n⁄e_t
 *
sim∂e
 = 
	`¢d_mixî_ñem_gë_¥iv©e
(
mñem
);

1663 
îr
;

1664 
k
;

1665 
k
 = 0; k <
CTL_LAST
; k++) {

1666 i‡(
sim∂e
->
˘ls
[
k
].
ñem
 =
hñem
)

1669 
	`as£π
(
k
 <
CTL_LAST
);

1670 
sim∂e
->
˘ls
[
k
].
ñem
 = 
NULL
;

1671 
îr
 = 
	`¢d_mixî_ñem_dëach
(
mñem
, 
hñem
);

1672 i‡(
îr
 < 0)

1673  
îr
;

1674 i‡(
	`¢d_mixî_ñem_em±y
(
mñem
))

1675  
	`¢d_mixî_ñem_ªmove
(
mñem
);

1676 
îr
 = 
	`sim∂e_upd©e
(
mñem
);

1677  
	`¢d_mixî_ñem_öfo
(
mñem
);

1678 
	}
}

1680 
	$sim∂e_evít
(
¢d_mixî_˛ass_t
 *
˛ass
, 
mask
,

1681 
¢d_h˘l_ñem_t
 *
hñem
, 
¢d_mixî_ñem_t
 *
mñem
)

1683 
îr
;

1684 i‡(
mask
 =
SND_CTL_EVENT_MASK_REMOVE
)

1685  
	`sim∂e_evít_ªmove
(
hñem
, 
mñem
);

1686 i‡(
mask
 & 
SND_CTL_EVENT_MASK_ADD
) {

1687 
îr
 = 
	`sim∂e_evít_add
(
˛ass
, 
hñem
);

1688 i‡(
îr
 < 0)

1689  
îr
;

1691 i‡(
mask
 & 
SND_CTL_EVENT_MASK_INFO
) {

1692 
îr
 = 
	`sim∂e_evít_ªmove
(
hñem
, 
mñem
);

1693 i‡(
îr
 < 0)

1694  
îr
;

1695 
îr
 = 
	`sim∂e_evít_add
(
˛ass
, 
hñem
);

1696 i‡(
îr
 < 0)

1697  
îr
;

1700 i‡(
mask
 & 
SND_CTL_EVENT_MASK_VALUE
) {

1701 
îr
 = 
	`£Àm_ªad
(
mñem
);

1702 i‡(
îr
 < 0)

1703  
îr
;

1704 i‡(
îr
) {

1705 
îr
 = 
	`¢d_mixî_ñem_vÆue
(
mñem
);

1706 i‡(
îr
 < 0)

1707  
îr
;

1711 
	}
}

1720 
	$¢d_mixî_sim∂e_n⁄e_ªgi°î
(
¢d_mixî_t
 *
mixî
,

1721 
¢d_mixî_£Àm_ªg›t
 *
›ti⁄s
 
ATTRIBUTE_UNUSED
,

1722 
¢d_mixî_˛ass_t
 **
˛as•
)

1724 
¢d_mixî_˛ass_t
 *
˛ass
;

1725 
îr
;

1727 i‡(
	`¢d_mixî_˛ass_mÆloc
(&
˛ass
))

1728  -
ENOMEM
;

1729 
	`¢d_mixî_˛ass_£t_evít
(
˛ass
, 
sim∂e_evít
);

1730 
	`¢d_mixî_˛ass_£t_com∑ª
(
˛ass
, 
¢d_mixî_£Àm_com∑ª
);

1731 
îr
 = 
	`¢d_mixî_˛ass_ªgi°î
(
˛ass
, 
mixî
);

1732 i‡(
îr
 < 0) {

1733 
	`‰ì
(
˛ass
);

1734  
îr
;

1736 i‡(
˛as•
)

1737 *
˛as•
 = 
˛ass
;

1739 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/names.c

33 
	~"loˇl.h
"

34 
	~<°d¨g.h
>

35 
	~<limôs.h
>

36 
	~<sys/°©.h
>

42 
	$¢d_«mes_li°
(c⁄° *
iÁ˚
 
ATTRIBUTE_UNUSED
,

43 
¢d_dev«me_t
 **
li°
 
ATTRIBUTE_UNUSED
)

45  -
ENXIO
;

46 
	}
}

47 
lök_w¨nög
(
¢d_«mes_li°
, "Warning: snd_names_list is deprecated, use snd_device_name_hint");

53 
	$¢d_«mes_li°_‰ì
(
¢d_dev«me_t
 *
li°
 
ATTRIBUTE_UNUSED
)

55 
	}
}

56 
lök_w¨nög
(
¢d_«mes_li°_‰ì
, "Warning: snd_names_list_free is deprecated, use snd_device_name_free_hint");

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/output.c

30 
	~"loˇl.h
"

31 
	~<°d¨g.h
>

32 
	~<°dio.h
>

33 
	~<°dlib.h
>

34 
	~<uni°d.h
>

36 #i‚de‡
DOC_HIDDEN


37 
	s_¢d_ouçut_›s
 {

38 (*
	m˛o£
)(
¢d_ouçut_t
 *
	mouçut
);

39 (*
	m¥öt
)(
¢d_ouçut_t
 *
	mouçut
, c⁄° *
	mf‹m©
, 
va_li°
 
	m¨gs
);

40 (*
	mputs
)(
¢d_ouçut_t
 *
	mouçut
, c⁄° *
	m°r
);

41 (*
	mputch
)(
¢d_ouçut_t
 *
	mouçut
, 
	mc
);

42 (*
	mÊush
)(
¢d_ouçut_t
 *
	mouçut
);

43 } 
	t¢d_ouçut_›s_t
;

45 
	s_¢d_ouçut
 {

46 
¢d_ouçut_ty≥_t
 
	mty≥
;

47 c⁄° 
¢d_ouçut_›s_t
 *
	m›s
;

48 *
	m¥iv©e_d©a
;

57 
	$¢d_ouçut_˛o£
(
¢d_ouçut_t
 *
ouçut
)

59 
îr
 = 
ouçut
->
›s
->
	`˛o£
(output);

60 
	`‰ì
(
ouçut
);

61  
îr
;

62 
	}
}

71 
	$¢d_ouçut_¥ötf
(
¢d_ouçut_t
 *
ouçut
, c⁄° *
f‹m©
, ...)

73 
ªsu…
;

74 
va_li°
 
¨gs
;

75 
	`va_°¨t
(
¨gs
, 
f‹m©
);

76 
ªsu…
 = 
ouçut
->
›s
->
	`¥öt
(ouçut, 
f‹m©
, 
¨gs
);

77 
	`va_íd
(
¨gs
);

78  
ªsu…
;

79 
	}
}

88 
	$¢d_ouçut_v¥ötf
(
¢d_ouçut_t
 *
ouçut
, c⁄° *
f‹m©
, 
va_li°
 
¨gs
)

90  
ouçut
->
›s
->
	`¥öt
(ouçut, 
f‹m©
, 
¨gs
);

91 
	}
}

99 
	$¢d_ouçut_puts
(
¢d_ouçut_t
 *
ouçut
, c⁄° *
°r
)

101  
ouçut
->
›s
->
	`puts
(ouçut, 
°r
);

102 
	}
}

110 
	$¢d_ouçut_putc
(
¢d_ouçut_t
 *
ouçut
, 
c
)

112  
ouçut
->
›s
->
	`putch
(ouçut, 
c
);

113 
	}
}

124 
	$¢d_ouçut_Êush
(
¢d_ouçut_t
 *
ouçut
)

126  
ouçut
->
›s
->
	`Êush
(output);

127 
	}
}

129 #i‚de‡
DOC_HIDDEN


130 
	s_¢d_ouçut_°dio
 {

131 
	m˛o£
;

132 
FILE
 *
	mÂ
;

133 } 
	t¢d_ouçut_°dio_t
;

135 
	$¢d_ouçut_°dio_˛o£
(
¢d_ouçut_t
 *
ouçut
)

137 
¢d_ouçut_°dio_t
 *
°dio
 = 
ouçut
->
¥iv©e_d©a
;

138 i‡(
°dio
->
˛o£
)

139 
	`f˛o£
(
°dio
->
Â
);

140 
	`‰ì
(
°dio
);

142 
	}
}

144 
	$¢d_ouçut_°dio_¥öt
(
¢d_ouçut_t
 *
ouçut
, c⁄° *
f‹m©
, 
va_li°
 
¨gs
)

146 
¢d_ouçut_°dio_t
 *
°dio
 = 
ouçut
->
¥iv©e_d©a
;

147  
	`vÂrötf
(
°dio
->
Â
, 
f‹m©
, 
¨gs
);

148 
	}
}

150 
	$¢d_ouçut_°dio_puts
(
¢d_ouçut_t
 *
ouçut
, c⁄° *
°r
)

152 
¢d_ouçut_°dio_t
 *
°dio
 = 
ouçut
->
¥iv©e_d©a
;

153  
	`Âuts
(
°r
, 
°dio
->
Â
);

154 
	}
}

156 
	$¢d_ouçut_°dio_putc
(
¢d_ouçut_t
 *
ouçut
, 
c
)

158 
¢d_ouçut_°dio_t
 *
°dio
 = 
ouçut
->
¥iv©e_d©a
;

159  
	`putc
(
c
, 
°dio
->
Â
);

160 
	}
}

162 
	$¢d_ouçut_°dio_Êush
(
¢d_ouçut_t
 *
ouçut
)

164 
¢d_ouçut_°dio_t
 *
°dio
 = 
ouçut
->
¥iv©e_d©a
;

165  
	`fÊush
(
°dio
->
Â
);

166 
	}
}

168 c⁄° 
¢d_ouçut_›s_t
 
	g¢d_ouçut_°dio_›s
 = {

169 .
˛o£
 = 
¢d_ouçut_°dio_˛o£
,

170 .
	g¥öt
 = 
¢d_ouçut_°dio_¥öt
,

171 .
	gputs
 = 
¢d_ouçut_°dio_puts
,

172 .
	gputch
 = 
¢d_ouçut_°dio_putc
,

173 .
	gÊush
 = 
¢d_ouçut_°dio_Êush
,

188 
	$¢d_ouçut_°dio_©èch
(
¢d_ouçut_t
 **
ouçuç
, 
FILE
 *
Â
, 
_˛o£
)

190 
¢d_ouçut_t
 *
ouçut
;

191 
¢d_ouçut_°dio_t
 *
°dio
;

192 
	`as£π
(
ouçuç
 && 
Â
);

193 
°dio
 = 
	`ˇŒoc
(1, (*stdio));

194 i‡(!
°dio
)

195  -
ENOMEM
;

196 
ouçut
 = 
	`ˇŒoc
(1, (*output));

197 i‡(!
ouçut
) {

198 
	`‰ì
(
°dio
);

199  -
ENOMEM
;

201 
°dio
->
Â
 = fp;

202 
°dio
->
˛o£
 = 
_˛o£
;

203 
ouçut
->
ty≥
 = 
SND_OUTPUT_STDIO
;

204 
ouçut
->
›s
 = &
¢d_ouçut_°dio_›s
;

205 
ouçut
->
¥iv©e_d©a
 = 
°dio
;

206 *
ouçuç
 = 
ouçut
;

208 
	}
}

218 
	$¢d_ouçut_°dio_›í
(
¢d_ouçut_t
 **
ouçuç
, c⁄° *
fûe
, c⁄° *
mode
)

220 
îr
;

221 
FILE
 *
Â
 = 
	`f›í
(
fûe
, 
mode
);

222 i‡(!
Â
) {

224  -
î∫o
;

226 
îr
 = 
	`¢d_ouçut_°dio_©èch
(
ouçuç
, 
Â
, 1);

227 i‡(
îr
 < 0)

228 
	`f˛o£
(
Â
);

229  
îr
;

230 
	}
}

232 #i‚de‡
DOC_HIDDEN


234 
	s_¢d_ouçut_buf„r
 {

235 *
	mbuf
;

236 
size_t
 
	mÆloc
;

237 
size_t
 
	msize
;

238 } 
	t¢d_ouçut_buf„r_t
;

240 
	$¢d_ouçut_buf„r_˛o£
(
¢d_ouçut_t
 *
ouçut
)

242 
¢d_ouçut_buf„r_t
 *
buf„r
 = 
ouçut
->
¥iv©e_d©a
;

243 
	`‰ì
(
buf„r
->
buf
);

244 
	`‰ì
(
buf„r
);

246 
	}
}

248 
	$¢d_ouçut_buf„r_√ed
(
¢d_ouçut_t
 *
ouçut
, 
size_t
 
size
)

250 
¢d_ouçut_buf„r_t
 *
buf„r
 = 
ouçut
->
¥iv©e_d©a
;

251 
size_t
 
_‰ì
 = 
buf„r
->
Æloc
 - buf„r->
size
;

252 
size_t
 
Æloc
;

253 *
buf
;

257 
size
++;

258 i‡(
_‰ì
 >
size
)

259  
_‰ì
;

260 i‡(
buf„r
->
Æloc
 == 0)

261 
Æloc
 = 256;

263 
Æloc
 = 
buf„r
->alloc;

264 
Æloc
 < 
buf„r
->
size
 + size)

265 
Æloc
 *= 2;

266 
buf
 = 
	`ªÆloc
(
buf„r
->buf, 
Æloc
);

267 i‡(!
buf
)

268  -
ENOMEM
;

269 
buf„r
->
buf
 = buf;

270 
buf„r
->
Æloc
 =álloc;

271  
buf„r
->
Æloc
 - buf„r->
size
;

272 
	}
}

274 
	$¢d_ouçut_buf„r_¥öt
(
¢d_ouçut_t
 *
ouçut
, c⁄° *
f‹m©
, 
va_li°
 
¨gs
)

276 
¢d_ouçut_buf„r_t
 *
buf„r
 = 
ouçut
->
¥iv©e_d©a
;

277 
size_t
 
size
 = 256;

278 
ªsu…
;

279 
ªsu…
 = 
	`¢d_ouçut_buf„r_√ed
(
ouçut
, 
size
);

280 i‡(
ªsu…
 < 0)

281  
ªsu…
;

282 
ªsu…
 = 
	`v¢¥ötf
((*)
buf„r
->
buf
 + buf„r->
size
, size, 
f‹m©
, 
¨gs
);

283 
	`as£π
(
ªsu…
 >= 0);

284 i‡((
size_t
)
ªsu…
 <
size
) {

285 
buf„r
->
size
 +
ªsu…
;

286  
ªsu…
;

288 
size
 = 
ªsu…
;

289 
ªsu…
 = 
	`¢d_ouçut_buf„r_√ed
(
ouçut
, 
size
);

290 i‡(
ªsu…
 < 0)

291  
ªsu…
;

292 
ªsu…
 = 
	`v¢¥ötf
((*)
buf„r
->
buf
 + buf„r->
size
,Ñesu…, 
f‹m©
, 
¨gs
);

293 
	`as£π
(
ªsu…
 =()
size
);

294 
buf„r
->
size
 +
ªsu…
;

295  
ªsu…
;

296 
	}
}

298 
	$¢d_ouçut_buf„r_puts
(
¢d_ouçut_t
 *
ouçut
, c⁄° *
°r
)

300 
¢d_ouçut_buf„r_t
 *
buf„r
 = 
ouçut
->
¥iv©e_d©a
;

301 
size_t
 
size
 = 
	`°æí
(
°r
);

302 
îr
;

303 
îr
 = 
	`¢d_ouçut_buf„r_√ed
(
ouçut
, 
size
);

304 i‡(
îr
 < 0)

305  
îr
;

306 
	`mem˝y
(
buf„r
->
buf
 + buf„r->
size
, 
°r
, size);

307 
buf„r
->
size
 += size;

308  
size
;

309 
	}
}

311 
	$¢d_ouçut_buf„r_putc
(
¢d_ouçut_t
 *
ouçut
, 
c
)

313 
¢d_ouçut_buf„r_t
 *
buf„r
 = 
ouçut
->
¥iv©e_d©a
;

314 
îr
;

315 
îr
 = 
	`¢d_ouçut_buf„r_√ed
(
ouçut
, 1);

316 i‡(
îr
 < 0)

317  
îr
;

318 
buf„r
->
buf
[buf„r->
size
++] = 
c
;

320 
	}
}

322 
	$¢d_ouçut_buf„r_Êush
(
¢d_ouçut_t
 *
ouçut
 
ATTRIBUTE_UNUSED
)

324 
¢d_ouçut_buf„r_t
 *
buf„r
 = 
ouçut
->
¥iv©e_d©a
;

325 
buf„r
->
size
 = 0;

327 
	}
}

329 c⁄° 
¢d_ouçut_›s_t
 
	g¢d_ouçut_buf„r_›s
 = {

330 .
˛o£
 = 
¢d_ouçut_buf„r_˛o£
,

331 .
	g¥öt
 = 
¢d_ouçut_buf„r_¥öt
,

332 .
	gputs
 = 
¢d_ouçut_buf„r_puts
,

333 .
	gputch
 = 
¢d_ouçut_buf„r_putc
,

334 .
	gÊush
 = 
¢d_ouçut_buf„r_Êush
,

348 
size_t
 
	$¢d_ouçut_buf„r_°rög
(
¢d_ouçut_t
 *
ouçut
, **
buf
)

350 
¢d_ouçut_buf„r_t
 *
buf„r
 = 
ouçut
->
¥iv©e_d©a
;

351 *
buf
 = (*)
buf„r
->buf;

352  
buf„r
->
size
;

353 
	}
}

365 
size_t
 
	$¢d_ouçut_buf„r_°ól
(
¢d_ouçut_t
 *
ouçut
, **
buf
)

367 
¢d_ouçut_buf„r_t
 *
buf„r
 = 
ouçut
->
¥iv©e_d©a
;

368 
size_t
 
size
;

369 *
buf
 = (*)
buf„r
->buf;

370 
size
 = 
buf„r
->size;

371 
buf„r
->
buf
 = 
NULL
;

372 
buf„r
->
Æloc
 = 0;

373 
buf„r
->
size
 = 0;

374  
size
;

375 
	}
}

383 
	$¢d_ouçut_buf„r_›í
(
¢d_ouçut_t
 **
ouçuç
)

385 
¢d_ouçut_t
 *
ouçut
;

386 
¢d_ouçut_buf„r_t
 *
buf„r
;

387 
	`as£π
(
ouçuç
);

388 
buf„r
 = 
	`ˇŒoc
(1, (*buffer));

389 i‡(!
buf„r
)

390  -
ENOMEM
;

391 
ouçut
 = 
	`ˇŒoc
(1, (*output));

392 i‡(!
ouçut
) {

393 
	`‰ì
(
buf„r
);

394  -
ENOMEM
;

396 
buf„r
->
buf
 = 
NULL
;

397 
buf„r
->
Æloc
 = 0;

398 
buf„r
->
size
 = 0;

399 
ouçut
->
ty≥
 = 
SND_OUTPUT_BUFFER
;

400 
ouçut
->
›s
 = &
¢d_ouçut_buf„r_›s
;

401 
ouçut
->
¥iv©e_d©a
 = 
buf„r
;

402 *
ouçuç
 = 
ouçut
;

404 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/interval.c

22 
	#SND_INTERVAL_C


	)

23 
	#SND_INTERVAL_INLINE


	)

25 
	~"pcm_loˇl.h
"

26 
	~<sys/ty≥s.h
>

27 
	~<limôs.h
>

29 
ölöe
 
	$div64_32
(
uöt64_t
 *
n
, 
uöt32_t
 
d
, uöt32_à*
ªm
)

31 *
ªm
 = *
n
 % 
d
;

32 *
n
 /
d
;

33 
	}
}

35 
ölöe
 
	$div32
(
a
, 
b
,

36 *
r
)

38 i‡(
b
 == 0) {

39 *
r
 = 0;

40  
UINT_MAX
;

42 *
r
 = 
a
 % 
b
;

43  
a
 / 
b
;

44 
	}
}

46 
ölöe
 
	$div_down
(
a
, 
b
)

48 i‡(
b
 == 0)

49  
UINT_MAX
;

50  
a
 / 
b
;

51 
	}
}

53 
ölöe
 
	$div_up
(
a
, 
b
)

55 
r
;

56 
q
;

57 i‡(
b
 == 0)

58  
UINT_MAX
;

59 
q
 = 
	`div32
(
a
, 
b
, &
r
);

60 i‡(
r
)

61 ++
q
;

62  
q
;

63 
	}
}

65 
ölöe
 
	$mul
(
a
, 
b
)

67 i‡(
a
 == 0)

69 i‡(
	`div_down
(
UINT_MAX
, 
a
Ë< 
b
)

70  
UINT_MAX
;

71  
a
 * 
b
;

72 
	}
}

74 
ölöe
 
	$add
(
a
, 
b
)

76 i‡(
a
 >
UINT_MAX
 - 
b
)

77  
UINT_MAX
;

78  
a
 + 
b
;

79 
	}
}

81 
ölöe
 
	$sub
(
a
, 
b
)

83 i‡(
a
 > 
b
)

84  
a
 - 
b
;

86 
	}
}

88 
ölöe
 
	$muldiv32
(
a
, 
b
,

89 
c
, *
r
)

91 
uöt64_t
 
n
 = (uöt64_tË
a
 * 
b
;

92 i‡(
c
 == 0) {

93 
	`as£π
(
n
 > 0);

94 *
r
 = 0;

95  
UINT_MAX
;

97 
	`div64_32
(&
n
, 
c
, 
r
);

98 i‡(
n
 >
UINT_MAX
) {

99 *
r
 = 0;

100  
UINT_MAX
;

102  
n
;

103 
	}
}

105 
	$¢d_öãrvÆ_ªföe_mö
(
¢d_öãrvÆ_t
 *
i
, 
mö
, 
›ímö
)

107 
ch™ged
 = 0;

108 i‡(
	`¢d_öãrvÆ_em±y
(
i
))

109  -
ENOENT
;

110 i‡(
i
->
mö
 < min) {

111 
i
->
mö
 = min;

112 
i
->
›ímö
 = openmin;

113 
ch™ged
 = 1;

114 } i‡(
i
->
mö
 =mö && !i->
›ímö
 && openmin) {

115 
i
->
›ímö
 = 1;

116 
ch™ged
 = 1;

118 i‡(
i
->
öãgî
) {

119 i‡(
i
->
›ímö
) {

120 
i
->
mö
++;

121 
i
->
›ímö
 = 0;

124 i‡(
	`¢d_öãrvÆ_checkem±y
(
i
)) {

125 
	`¢d_öãrvÆ_n⁄e
(
i
);

126  -
EINVAL
;

128  
ch™ged
;

129 
	}
}

131 
	$¢d_öãrvÆ_ªföe_max
(
¢d_öãrvÆ_t
 *
i
, 
max
, 
›ímax
)

133 
ch™ged
 = 0;

134 i‡(
	`¢d_öãrvÆ_em±y
(
i
))

135  -
ENOENT
;

136 i‡(
i
->
max
 > max) {

137 
i
->
max
 = max;

138 
i
->
›ímax
 = openmax;

139 
ch™ged
 = 1;

140 } i‡(
i
->
max
 =max && !i->
›ímax
 && openmax) {

141 
i
->
›ímax
 = 1;

142 
ch™ged
 = 1;

144 i‡(
i
->
öãgî
) {

145 i‡(
i
->
›ímax
) {

146 
i
->
max
--;

147 
i
->
›ímax
 = 0;

150 i‡(
	`¢d_öãrvÆ_checkem±y
(
i
)) {

151 
	`¢d_öãrvÆ_n⁄e
(
i
);

152  -
EINVAL
;

154  
ch™ged
;

155 
	}
}

158 
	$¢d_öãrvÆ_ªföe
(
¢d_öãrvÆ_t
 *
i
, c⁄° snd_öãrvÆ_à*
v
)

160 
ch™ged
 = 0;

161 i‡(
	`¢d_öãrvÆ_em±y
(
i
))

162  -
ENOENT
;

163 i‡(
i
->
mö
 < 
v
->min) {

164 
i
->
mö
 = 
v
->min;

165 
i
->
›ímö
 = 
v
->openmin;

166 
ch™ged
 = 1;

167 } i‡(
i
->
mö
 =
v
->mö && !i->
›ímö
 && v->openmin) {

168 
i
->
›ímö
 = 1;

169 
ch™ged
 = 1;

171 i‡(
i
->
max
 > 
v
->max) {

172 
i
->
max
 = 
v
->max;

173 
i
->
›ímax
 = 
v
->openmax;

174 
ch™ged
 = 1;

175 } i‡(
i
->
max
 =
v
->max && !i->
›ímax
 && v->openmax) {

176 
i
->
›ímax
 = 1;

177 
ch™ged
 = 1;

179 i‡(!
i
->
öãgî
 && 
v
->integer) {

180 
i
->
öãgî
 = 1;

181 
ch™ged
 = 1;

183 i‡(
i
->
öãgî
) {

184 i‡(
i
->
›ímö
) {

185 
i
->
mö
++;

186 
i
->
›ímö
 = 0;

188 i‡(
i
->
›ímax
) {

189 
i
->
max
--;

190 
i
->
›ímax
 = 0;

192 } i‡(!
i
->
›ímö
 && !i->
›ímax
 && i->
mö
 =i->
max
)

193 
i
->
öãgî
 = 1;

194 i‡(
	`¢d_öãrvÆ_checkem±y
(
i
)) {

195 
	`¢d_öãrvÆ_n⁄e
(
i
);

196  -
EINVAL
;

198  
ch™ged
;

199 
	}
}

201 
	$¢d_öãrvÆ_ªföe_fú°
(
¢d_öãrvÆ_t
 *
i
)

203 c⁄° 
œ°_max
 = 
i
->
max
;

205 i‡(
	`¢d_öãrvÆ_em±y
(
i
))

206  -
ENOENT
;

207 i‡(
	`¢d_öãrvÆ_sögÀ
(
i
))

209 
i
->
max
 = i->
mö
;

210 i‡(
i
->
›ímö
)

211 
i
->
max
++;

213 
i
->
›ímax
 = (i->›ímax && i->
max
 >
œ°_max
);

215 
	}
}

217 
	$¢d_öãrvÆ_ªföe_œ°
(
¢d_öãrvÆ_t
 *
i
)

219 c⁄° 
œ°_mö
 = 
i
->
mö
;

221 i‡(
	`¢d_öãrvÆ_em±y
(
i
))

222  -
ENOENT
;

223 i‡(
	`¢d_öãrvÆ_sögÀ
(
i
))

225 
i
->
mö
 = i->
max
;

226 i‡(
i
->
›ímax
)

227 
i
->
mö
--;

229 
i
->
›ímö
 = (i->›ímö && i->
mö
 <
œ°_mö
);

231 
	}
}

233 
	$¢d_öãrvÆ_ªföe_£t
(
¢d_öãrvÆ_t
 *
i
, 
vÆ
)

235 
¢d_öãrvÆ_t
 
t
;

236 
t
.
em±y
 = 0;

237 
t
.
mö
 =Å.
max
 = 
vÆ
;

238 
t
.
›ímö
 =Å.
›ímax
 = 0;

239 
t
.
öãgî
 = 1;

240  
	`¢d_öãrvÆ_ªföe
(
i
, &
t
);

241 
	}
}

243 
	$¢d_öãrvÆ_add
(c⁄° 
¢d_öãrvÆ_t
 *
a
, c⁄° snd_öãrvÆ_à*
b
, snd_öãrvÆ_à*
c
)

245 i‡(
a
->
em±y
 || 
b
->empty) {

246 
	`¢d_öãrvÆ_n⁄e
(
c
);

249 
c
->
em±y
 = 0;

250 
c
->
mö
 = 
	`add
(
a
->mö, 
b
->min);

251 
c
->
›ímö
 = (
a
->›ímö || 
b
->openmin);

252 
c
->
max
 = 
	`add
(
a
->max, 
b
->max);

253 
c
->
›ímax
 = (
a
->›ímax || 
b
->openmax);

254 
c
->
öãgî
 = (
a
->öãgî && 
b
->integer);

255 
	}
}

257 
	$¢d_öãrvÆ_sub
(c⁄° 
¢d_öãrvÆ_t
 *
a
, c⁄° snd_öãrvÆ_à*
b
, snd_öãrvÆ_à*
c
)

259 i‡(
a
->
em±y
 || 
b
->empty) {

260 
	`¢d_öãrvÆ_n⁄e
(
c
);

263 
c
->
em±y
 = 0;

264 
c
->
mö
 = 
	`sub
(
a
->mö, 
b
->
max
);

265 
c
->
›ímö
 = (
a
->›ímö || 
b
->
›ímax
);

266 
c
->
max
 = 
	`add
(
a
->max, 
b
->
mö
);

267 
c
->
›ímax
 = (
a
->›ímax || 
b
->
›ímö
);

268 
c
->
öãgî
 = (
a
->öãgî && 
b
->integer);

269 
	}
}

271 
	$¢d_öãrvÆ_mul
(c⁄° 
¢d_öãrvÆ_t
 *
a
, c⁄° snd_öãrvÆ_à*
b
, snd_öãrvÆ_à*
c
)

273 i‡(
a
->
em±y
 || 
b
->empty) {

274 
	`¢d_öãrvÆ_n⁄e
(
c
);

277 
c
->
em±y
 = 0;

278 
c
->
mö
 = 
	`mul
(
a
->mö, 
b
->min);

279 
c
->
›ímö
 = (
a
->›ímö || 
b
->openmin);

280 
c
->
max
 = 
	`mul
(
a
->max, 
b
->max);

281 
c
->
›ímax
 = (
a
->›ímax || 
b
->openmax);

282 
c
->
öãgî
 = (
a
->öãgî && 
b
->integer);

283 
	}
}

285 
	$¢d_öãrvÆ_div
(c⁄° 
¢d_öãrvÆ_t
 *
a
, c⁄° snd_öãrvÆ_à*
b
, snd_öãrvÆ_à*
c
)

287 
r
;

288 i‡(
a
->
em±y
 || 
b
->empty) {

289 
	`¢d_öãrvÆ_n⁄e
(
c
);

292 
c
->
em±y
 = 0;

293 
c
->
mö
 = 
	`div32
(
a
->mö, 
b
->
max
, &
r
);

294 
c
->
›ímö
 = (
r
 || 
a
->›ímö || 
b
->
›ímax
);

295 i‡(
b
->
mö
 > 0) {

296 
c
->
max
 = 
	`div32
(
a
->max, 
b
->
mö
, &
r
);

297 i‡(
r
) {

298 
c
->
max
++;

299 
c
->
›ímax
 = 1;

301 
c
->
›ímax
 = (
a
->›ímax || 
b
->
›ímö
);

303 
c
->
max
 = 
UINT_MAX
;

304 
c
->
›ímax
 = 0;

306 
c
->
öãgî
 = 0;

307 
	}
}

310 
	$¢d_öãrvÆ_muldiv
(c⁄° 
¢d_öãrvÆ_t
 *
a
, c⁄° snd_öãrvÆ_à*
b
,

311 c⁄° 
¢d_öãrvÆ_t
 *
c
, snd_öãrvÆ_à*
d
)

313 
r
;

314 i‡(
a
->
em±y
 || 
b
->em±y || 
c
->empty) {

315 
	`¢d_öãrvÆ_n⁄e
(
d
);

318 
d
->
em±y
 = 0;

319 
d
->
mö
 = 
	`muldiv32
(
a
->mö, 
b
->mö, 
c
->
max
, &
r
);

320 
d
->
›ímö
 = (
r
 || 
a
->›ímö || 
b
->›ímö || 
c
->
›ímax
);

321 
d
->
max
 = 
	`muldiv32
(
a
->max, 
b
->max, 
c
->
mö
, &
r
);

322 i‡(
r
) {

323 
d
->
max
++;

324 
d
->
›ímax
 = 1;

326 
d
->
›ímax
 = (
a
->›ímax || 
b
->›ímax || 
c
->
›ímö
);

327 
d
->
öãgî
 = 0;

328 
	}
}

331 
	$¢d_öãrvÆ_muldivk
(c⁄° 
¢d_öãrvÆ_t
 *
a
, c⁄° snd_öãrvÆ_à*
b
,

332 
k
, 
¢d_öãrvÆ_t
 *
c
)

334 
r
;

335 i‡(
a
->
em±y
 || 
b
->empty) {

336 
	`¢d_öãrvÆ_n⁄e
(
c
);

339 
c
->
em±y
 = 0;

340 
c
->
mö
 = 
	`muldiv32
(
a
->mö, 
b
->mö, 
k
, &
r
);

341 
c
->
›ímö
 = (
r
 || 
a
->›ímö || 
b
->openmin);

342 
c
->
max
 = 
	`muldiv32
(
a
->max, 
b
->max, 
k
, &
r
);

343 i‡(
r
) {

344 
c
->
max
++;

345 
c
->
›ímax
 = 1;

347 
c
->
›ímax
 = (
a
->›ímax || 
b
->openmax);

348 
c
->
öãgî
 = 0;

349 
	}
}

352 
	$¢d_öãrvÆ_mulkdiv
(c⁄° 
¢d_öãrvÆ_t
 *
a
, 
k
,

353 c⁄° 
¢d_öãrvÆ_t
 *
b
, snd_öãrvÆ_à*
c
)

355 
r
;

356 i‡(
a
->
em±y
 || 
b
->empty) {

357 
	`¢d_öãrvÆ_n⁄e
(
c
);

360 
c
->
em±y
 = 0;

361 
c
->
mö
 = 
	`muldiv32
(
a
->mö, 
k
, 
b
->
max
, &
r
);

362 
c
->
›ímö
 = (
r
 || 
a
->›ímö || 
b
->
›ímax
);

363 i‡(
b
->
mö
 > 0) {

364 
c
->
max
 = 
	`muldiv32
(
a
->max, 
k
, 
b
->
mö
, &
r
);

365 i‡(
r
) {

366 
c
->
max
++;

367 
c
->
›ímax
 = 1;

369 
c
->
›ímax
 = (
a
->›ímax || 
b
->
›ímö
);

371 
c
->
max
 = 
UINT_MAX
;

372 
c
->
›ímax
 = 0;

374 
c
->
öãgî
 = 0;

375 
	}
}

377 
	$¢d_öãrvÆ_¥öt
(c⁄° 
¢d_öãrvÆ_t
 *
i
, 
¢d_ouçut_t
 *
out
)

379 i‡(
	`¢d_öãrvÆ_em±y
(
i
))

380 
	`¢d_ouçut_¥ötf
(
out
, "NONE");

381 i‡(
i
->
mö
 =0 && i->
›ímö
 == 0 &&

382 
i
->
max
 =
UINT_MAX
 && i->
›ímax
 == 0)

383 
	`¢d_ouçut_¥ötf
(
out
, "ALL");

384 i‡(
	`¢d_öãrvÆ_sögÀ
(
i
Ë&& i->
öãgî
)

385 
	`¢d_ouçut_¥ötf
(
out
, "%u", 
	`¢d_öãrvÆ_vÆue
(
i
));

387 
	`¢d_ouçut_¥ötf
(
out
, "%c%u %u%c",

388 
i
->
›ímö
 ? '(' : '[',

389 
i
->
mö
, i->
max
,

390 
i
->
›ímax
 ? ')' : ']');

391 
	}
}

394 
	$bound¨y_abs
(
a
, 
adú
, *
b
, *
bdú
)

396 i‡(
a
 < 0 || (®=0 && 
adú
 < 0)) {

397 *
b
 = -
a
;

398 *
bdú
 = -
adú
;

400 *
b
 = 
a
;

401 *
bdú
 = 
adú
;

403 
	}
}

406 
	$bound¨y_sub
(
a
, 
adú
, 
b
, 
bdú
, *
c
, *
cdú
)

408 
adú
 =ádir < 0 ? -1 : (adir > 0 ? 1 : 0);

409 
bdú
 = bdir < 0 ? -1 : (bdir > 0 ? 1 : 0);

410 *
c
 = 
a
 - 
b
;

411 *
cdú
 = 
adú
 - 
bdú
;

412 i‡(*
cdú
 == -2) {

413 
	`as£π
(*
c
 > 
INT_MIN
);

414 (*
c
)--;

415 } i‡(*
cdú
 == 2) {

416 
	`as£π
(*
c
 < 
INT_MAX
);

417 (*
c
)++;

419 
	}
}

421 
	$bound¨y_…
(
a
, 
adú
, 
b
, 
bdú
)

423 
	`as£π
(
a
 > 0 || 
adú
 >= 0);

424 
	`as£π
(
b
 > 0 || 
bdú
 >= 0);

425 i‡(
adú
 < 0) {

426 
a
--;

427 
adú
 = 1;

428 } i‡(
adú
 > 0)

429 
adú
 = 1;

430 i‡(
bdú
 < 0) {

431 
b
--;

432 
bdú
 = 1;

433 } i‡(
bdú
 > 0)

434 
bdú
 = 1;

435  
a
 < 
b
 || (®=b && 
adú
 < 
bdú
);

436 
	}
}

439 
	$bound¨y_√¨î
(
mö
, 
mödú
, 
be°
, 
be°dú
, 
max
, 
maxdú
)

441 
dmö
, 
dmödú
;

442 
dmax
, 
dmaxdú
;

443 
	`bound¨y_sub
(
be°
, 
be°dú
, 
mö
, 
mödú
, &
dmö
, &
dmödú
);

444 
	`bound¨y_sub
(
max
, 
maxdú
, 
be°
, 
be°dú
, &
dmax
, &
dmaxdú
);

445  
	`bound¨y_…
(
dmö
, 
dmödú
, 
dmax
, 
dmaxdú
);

446 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/interval.h

22 
_¢d_öãrvÆ
 
	t¢d_öãrvÆ_t
;

24 #ifde‡
SND_INTERVAL_INLINE


25 
	~"öãrvÆ_ölöe.h
"

27 
¢d_öãrvÆ_™y
(
¢d_öãrvÆ_t
 *
i
);

28 
¢d_öãrvÆ_n⁄e
(
¢d_öãrvÆ_t
 *
i
);

29 
¢d_öãrvÆ_£töãgî
(
¢d_öãrvÆ_t
 *
i
);

30 
¢d_öãrvÆ_em±y
(c⁄° 
¢d_öãrvÆ_t
 *
i
);

31 
¢d_öãrvÆ_sögÀ
(c⁄° 
¢d_öãrvÆ_t
 *
i
);

32 
¢d_öãrvÆ_vÆue
(c⁄° 
¢d_öãrvÆ_t
 *
i
);

33 
¢d_öãrvÆ_£t_vÆue
(
¢d_öãrvÆ_t
 *
i
, 
vÆ
);

34 
¢d_öãrvÆ_mö
(c⁄° 
¢d_öãrvÆ_t
 *
i
);

35 
¢d_öãrvÆ_max
(c⁄° 
¢d_öãrvÆ_t
 *
i
);

36 
¢d_öãrvÆ_£t_mömax
(
¢d_öãrvÆ_t
 *
i
, 
mö
, 
max
);

37 
¢d_öãrvÆ_ã°
(c⁄° 
¢d_öãrvÆ_t
 *
i
, 
vÆ
);

38 
¢d_öãrvÆ_c›y
(
¢d_öãrvÆ_t
 *
d°
, c⁄° snd_öãrvÆ_à*
§c
);

39 
¢d_öãrvÆ_Êo‹
(
¢d_öãrvÆ_t
 *
i
);

40 
¢d_öãrvÆ_unÊo‹
(
¢d_öãrvÆ_t
 *
i
);

41 
¢d_öãrvÆ_Æways_eq
(c⁄° 
¢d_öãrvÆ_t
 *
i1
, c⁄° snd_öãrvÆ_à*
i2
);

42 
¢d_öãrvÆ_√vî_eq
(c⁄° 
¢d_öãrvÆ_t
 *
i1
, c⁄° snd_öãrvÆ_à*
i2
);

46 
	#¢d_öãrvÆ_add
 
¢d1_öãrvÆ_add


	)

47 
	#¢d_öãrvÆ_sub
 
¢d1_öãrvÆ_sub


	)

48 
	#¢d_öãrvÆ_mul
 
¢d1_öãrvÆ_mul


	)

49 
	#¢d_öãrvÆ_div
 
¢d1_öãrvÆ_div


	)

50 
	#¢d_öãrvÆ_muldiv
 
¢d1_öãrvÆ_muldiv


	)

51 
	#¢d_öãrvÆ_muldivk
 
¢d1_öãrvÆ_muldivk


	)

52 
	#¢d_öãrvÆ_mulkdiv
 
¢d1_öãrvÆ_mulkdiv


	)

53 
	#¢d_öãrvÆ_¥öt
 
¢d1_öãrvÆ_¥öt


	)

54 
	#¢d_öãrvÆ_ªföe_mö
 
¢d1_öãrvÆ_ªföe_mö


	)

55 
	#¢d_öãrvÆ_ªföe_max
 
¢d1_öãrvÆ_ªföe_max


	)

56 
	#¢d_öãrvÆ_ªföe
 
¢d1_öãrvÆ_ªföe


	)

57 
	#¢d_öãrvÆ_ªföe_fú°
 
¢d1_öãrvÆ_ªföe_fú°


	)

58 
	#¢d_öãrvÆ_ªföe_œ°
 
¢d1_öãrvÆ_ªföe_œ°


	)

59 
	#¢d_öãrvÆ_ªföe_£t
 
¢d1_öãrvÆ_ªföe_£t


	)

61 
¢d_öãrvÆ_add
(c⁄° 
¢d_öãrvÆ_t
 *
a
, c⁄° snd_öãrvÆ_à*
b
, snd_öãrvÆ_à*
c
);

62 
¢d_öãrvÆ_sub
(c⁄° 
¢d_öãrvÆ_t
 *
a
, c⁄° snd_öãrvÆ_à*
b
, snd_öãrvÆ_à*
c
);

63 
¢d_öãrvÆ_mul
(c⁄° 
¢d_öãrvÆ_t
 *
a
, c⁄° snd_öãrvÆ_à*
b
, snd_öãrvÆ_à*
c
);

64 
¢d_öãrvÆ_div
(c⁄° 
¢d_öãrvÆ_t
 *
a
, c⁄° snd_öãrvÆ_à*
b
, snd_öãrvÆ_à*
c
);

65 
¢d_öãrvÆ_muldiv
(c⁄° 
¢d_öãrvÆ_t
 *
a
, c⁄° snd_öãrvÆ_à*
b
,

66 c⁄° 
¢d_öãrvÆ_t
 *
c
, snd_öãrvÆ_à*
d
);

67 
¢d_öãrvÆ_muldivk
(c⁄° 
¢d_öãrvÆ_t
 *
a
, c⁄° snd_öãrvÆ_à*
b
,

68 
k
, 
¢d_öãrvÆ_t
 *
c
);

69 
¢d_öãrvÆ_mulkdiv
(c⁄° 
¢d_öãrvÆ_t
 *
a
, 
k
,

70 c⁄° 
¢d_öãrvÆ_t
 *
b
, snd_öãrvÆ_à*
c
);

71 
¢d_öãrvÆ_¥öt
(c⁄° 
¢d_öãrvÆ_t
 *
i
, 
¢d_ouçut_t
 *
out
);

72 
¢d_öãrvÆ_ªföe_mö
(
¢d_öãrvÆ_t
 *
i
, 
mö
, 
›ímö
);

73 
¢d_öãrvÆ_ªföe_max
(
¢d_öãrvÆ_t
 *
i
, 
max
, 
›ímax
);

74 
¢d_öãrvÆ_ªföe
(
¢d_öãrvÆ_t
 *
i
, c⁄° snd_öãrvÆ_à*
v
);

75 
¢d_öãrvÆ_ªföe_fú°
(
¢d_öãrvÆ_t
 *
i
);

76 
¢d_öãrvÆ_ªföe_œ°
(
¢d_öãrvÆ_t
 *
i
);

77 
¢d_öãrvÆ_ªföe_£t
(
¢d_öãrvÆ_t
 *
i
, 
vÆ
);

78 
bound¨y_sub
(
a
, 
adú
, 
b
, 
bdú
, *
c
, *
cdú
);

79 
bound¨y_…
(
a
, 
adú
, 
b
, 
bdú
);

80 
bound¨y_√¨î
(
mö
, 
mödú
, 
be°
, 
be°dú
, 
max
, 
maxdú
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/interval_inline.h

22 
	#INTERVAL_INLINE
 
ölöe


	)

24 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_™y
(
¢d_öãrvÆ_t
 *
i
)

26 
i
->
mö
 = 0;

27 
i
->
›ímö
 = 0;

28 
i
->
max
 = 
UINT_MAX
;

29 
i
->
›ímax
 = 0;

30 
i
->
öãgî
 = 0;

31 
i
->
em±y
 = 0;

32 
	}
}

34 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_n⁄e
(
¢d_öãrvÆ_t
 *
i
)

36 
i
->
em±y
 = 1;

37 
	}
}

39 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_checkem±y
(c⁄° 
¢d_öãrvÆ_t
 *
i
)

41  (
i
->
mö
 > i->
max
 ||

42 (
i
->
mö
 =i->
max
 && (i->
›ímö
 || i->
›ímax
)));

43 
	}
}

45 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_em±y
(c⁄° 
¢d_öãrvÆ_t
 *
i
)

47  
i
->
em±y
;

48 
	}
}

50 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_sögÀ
(c⁄° 
¢d_öãrvÆ_t
 *
i
)

52 
	`as£π
(!
	`¢d_öãrvÆ_em±y
(
i
));

53  (
i
->
mö
 =i->
max
 ||

54 (
i
->
mö
 + 1 =i->
max
 && (i->
›ímö
 || i->
›ímax
)));

55 
	}
}

57 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_vÆue
(c⁄° 
¢d_öãrvÆ_t
 *
i
)

59 
	`as£π
(
	`¢d_öãrvÆ_sögÀ
(
i
));

60 i‡(
i
->
›ímö
 && !i->
›ímax
)

61  
i
->
max
;

62  
i
->
mö
;

63 
	}
}

65 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_£t_vÆue
(
¢d_öãrvÆ_t
 *
i
, 
vÆ
)

67 
i
->
›ímax
 = i->
›ímö
 = 0;

68 
i
->
mö
 = i->
max
 = 
vÆ
;

69 
i
->
öãgî
 = 0;

70 
i
->
em±y
 = 0;

71 
	}
}

73 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_mö
(c⁄° 
¢d_öãrvÆ_t
 *
i
)

75 
	`as£π
(!
	`¢d_öãrvÆ_em±y
(
i
));

76  
i
->
mö
;

77 
	}
}

79 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_max
(c⁄° 
¢d_öãrvÆ_t
 *
i
)

81 
	`as£π
(!
	`¢d_öãrvÆ_em±y
(
i
));

82  
i
->
max
;

83 
	}
}

85 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_£t_mömax
(
¢d_öãrvÆ_t
 *
i
, 
mö
, 
max
)

87 
i
->
›ímax
 = i->
›ímö
 = 0;

88 
i
->
mö
 = min;

89 
i
->
max
 = max;

90 
i
->
öãgî
 = 0;

91 
i
->
em±y
 = 0;

92 
	}
}

94 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_ã°
(c⁄° 
¢d_öãrvÆ_t
 *
i
, 
vÆ
)

96  !((
i
->
mö
 > 
vÆ
 || (i->mö =vÆ && i->
›ímö
) ||

97 
i
->
max
 < 
vÆ
 || (i->max =vÆ && i->
›ímax
)));

98 
	}
}

100 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_c›y
(
¢d_öãrvÆ_t
 *
d
, c⁄° snd_öãrvÆ_à*
s
)

102 *
d
 = *
s
;

103 
	}
}

105 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_£töãgî
(
¢d_öãrvÆ_t
 *
i
)

107 i‡(
i
->
öãgî
)

109 i‡(
i
->
›ímö
 && i->
›ímax
 && i->
mö
 =i->
max
)

110  -
EINVAL
;

111 
i
->
öãgî
 = 1;

113 
	}
}

115 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_Êo‹
(
¢d_öãrvÆ_t
 *
i
)

117 i‡(
i
->
öãgî
 || 
	`¢d_öãrvÆ_em±y
(i))

119 
i
->
›ímö
 = 0;

120 i‡(
i
->
›ímax
) {

121 
i
->
max
--;

122 
i
->
›ímax
 = 0;

124 
i
->
öãgî
 = 1;

125 
	}
}

127 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_unÊo‹
(
¢d_öãrvÆ_t
 *
i
)

129 i‡(
	`¢d_öãrvÆ_em±y
(
i
))

131 i‡(
i
->
max
 =
UINT_MAX
)

133 i‡(
i
->
›ímax
)

135 
i
->
max
++;

136 
i
->
›ímax
 = 1;

137 
i
->
öãgî
 = 0;

138 
	}
}

141 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_Æways_eq
(c⁄° 
¢d_öãrvÆ_t
 *
i1
, c⁄° snd_öãrvÆ_à*
i2
)

143  
	`¢d_öãrvÆ_sögÀ
(
i1
Ë&& snd_öãrvÆ_sögÀ(
i2
) &&

144 
	`¢d_öãrvÆ_vÆue
(
i1
Ë=¢d_öãrvÆ_vÆue(
i2
);

145 
	}
}

147 
INTERVAL_INLINE
 
	$¢d_öãrvÆ_√vî_eq
(c⁄° 
¢d_öãrvÆ_t
 *
i1
, c⁄° snd_öãrvÆ_à*
i2
)

150  (
i1
->
max
 < 
i2
->
mö
 ||

151 (
i1
->
max
 =
i2
->
mö
 &&

152 (
i1
->
›ímax
 || i1->
›ímö
)) ||

153 
i1
->
mö
 > 
i2
->
max
 ||

154 (
i1
->
mö
 =
i2
->
max
 &&

155 (
i1
->
›ímö
 || 
i2
->
›ímax
)));

156 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/ladspa.h

22 #i‚de‡
LADSPA_INCLUDED


23 
	#LADSPA_INCLUDED


	)

25 
	#LADSPA_VERSION
 "1.1"

	)

26 
	#LADSPA_VERSION_MAJOR
 1

	)

27 
	#LADSPA_VERSION_MINOR
 1

	)

29 #ifde‡
__˝lu•lus


84 
	tLADSPA_D©a
;

94 
	tLADSPA_Pr›îtõs
;

99 
	#LADSPA_PROPERTY_REALTIME
 0x1

	)

106 
	#LADSPA_PROPERTY_INPLACE_BROKEN
 0x2

	)

132 
	#LADSPA_PROPERTY_HARD_RT_CAPABLE
 0x4

	)

134 
	#LADSPA_IS_REALTIME
(
x
Ë((xË& 
LADSPA_PROPERTY_REALTIME
)

	)

135 
	#LADSPA_IS_INPLACE_BROKEN
(
x
Ë((xË& 
LADSPA_PROPERTY_INPLACE_BROKEN
)

	)

136 
	#LADSPA_IS_HARD_RT_CAPABLE
(
x
Ë((xË& 
LADSPA_PROPERTY_HARD_RT_CAPABLE
)

	)

152 
	tLADSPA_P‹tDes¸ùt‹
;

155 
	#LADSPA_PORT_INPUT
 0x1

	)

158 
	#LADSPA_PORT_OUTPUT
 0x2

	)

162 
	#LADSPA_PORT_CONTROL
 0x4

	)

166 
	#LADSPA_PORT_AUDIO
 0x8

	)

168 
	#LADSPA_IS_PORT_INPUT
(
x
Ë((xË& 
LADSPA_PORT_INPUT
)

	)

169 
	#LADSPA_IS_PORT_OUTPUT
(
x
Ë((xË& 
LADSPA_PORT_OUTPUT
)

	)

170 
	#LADSPA_IS_PORT_CONTROL
(
x
Ë((xË& 
LADSPA_PORT_CONTROL
)

	)

171 
	#LADSPA_IS_PORT_AUDIO
(
x
Ë((xË& 
LADSPA_PORT_AUDIO
)

	)

200 
	tLADSPA_P‹tR™geHötDes¸ùt‹
;

208 
	#LADSPA_HINT_BOUNDED_BELOW
 0x1

	)

216 
	#LADSPA_HINT_BOUNDED_ABOVE
 0x2

	)

224 
	#LADSPA_HINT_TOGGLED
 0x4

	)

232 
	#LADSPA_HINT_SAMPLE_RATE
 0x8

	)

237 
	#LADSPA_HINT_LOGARITHMIC
 0x10

	)

245 
	#LADSPA_HINT_INTEGER
 0x20

	)

258 
	#LADSPA_HINT_DEFAULT_MASK
 0x3C0

	)

261 
	#LADSPA_HINT_DEFAULT_NONE
 0x0

	)

265 
	#LADSPA_HINT_DEFAULT_MINIMUM
 0x40

	)

272 
	#LADSPA_HINT_DEFAULT_LOW
 0x80

	)

279 
	#LADSPA_HINT_DEFAULT_MIDDLE
 0xC0

	)

286 
	#LADSPA_HINT_DEFAULT_HIGH
 0x100

	)

290 
	#LADSPA_HINT_DEFAULT_MAXIMUM
 0x140

	)

295 
	#LADSPA_HINT_DEFAULT_0
 0x200

	)

300 
	#LADSPA_HINT_DEFAULT_1
 0x240

	)

303 
	#LADSPA_HINT_DEFAULT_100
 0x280

	)

308 
	#LADSPA_HINT_DEFAULT_440
 0x2C0

	)

310 
	#LADSPA_IS_HINT_BOUNDED_BELOW
(
x
Ë((xË& 
LADSPA_HINT_BOUNDED_BELOW
)

	)

311 
	#LADSPA_IS_HINT_BOUNDED_ABOVE
(
x
Ë((xË& 
LADSPA_HINT_BOUNDED_ABOVE
)

	)

312 
	#LADSPA_IS_HINT_TOGGLED
(
x
Ë((xË& 
LADSPA_HINT_TOGGLED
)

	)

313 
	#LADSPA_IS_HINT_SAMPLE_RATE
(
x
Ë((xË& 
LADSPA_HINT_SAMPLE_RATE
)

	)

314 
	#LADSPA_IS_HINT_LOGARITHMIC
(
x
Ë((xË& 
LADSPA_HINT_LOGARITHMIC
)

	)

315 
	#LADSPA_IS_HINT_INTEGER
(
x
Ë((xË& 
LADSPA_HINT_INTEGER
)

	)

317 
	#LADSPA_IS_HINT_HAS_DEFAULT
(
x
Ë((xË& 
LADSPA_HINT_DEFAULT_MASK
)

	)

318 
	#LADSPA_IS_HINT_DEFAULT_MINIMUM
(
x
Ë(((xË& 
LADSPA_HINT_DEFAULT_MASK
) \

319 =
LADSPA_HINT_DEFAULT_MINIMUM
)

	)

320 
	#LADSPA_IS_HINT_DEFAULT_LOW
(
x
Ë(((xË& 
LADSPA_HINT_DEFAULT_MASK
) \

321 =
LADSPA_HINT_DEFAULT_LOW
)

	)

322 
	#LADSPA_IS_HINT_DEFAULT_MIDDLE
(
x
Ë(((xË& 
LADSPA_HINT_DEFAULT_MASK
) \

323 =
LADSPA_HINT_DEFAULT_MIDDLE
)

	)

324 
	#LADSPA_IS_HINT_DEFAULT_HIGH
(
x
Ë(((xË& 
LADSPA_HINT_DEFAULT_MASK
) \

325 =
LADSPA_HINT_DEFAULT_HIGH
)

	)

326 
	#LADSPA_IS_HINT_DEFAULT_MAXIMUM
(
x
Ë(((xË& 
LADSPA_HINT_DEFAULT_MASK
) \

327 =
LADSPA_HINT_DEFAULT_MAXIMUM
)

	)

328 
	#LADSPA_IS_HINT_DEFAULT_0
(
x
Ë(((xË& 
LADSPA_HINT_DEFAULT_MASK
) \

329 =
LADSPA_HINT_DEFAULT_0
)

	)

330 
	#LADSPA_IS_HINT_DEFAULT_1
(
x
Ë(((xË& 
LADSPA_HINT_DEFAULT_MASK
) \

331 =
LADSPA_HINT_DEFAULT_1
)

	)

332 
	#LADSPA_IS_HINT_DEFAULT_100
(
x
Ë(((xË& 
LADSPA_HINT_DEFAULT_MASK
) \

333 =
LADSPA_HINT_DEFAULT_100
)

	)

334 
	#LADSPA_IS_HINT_DEFAULT_440
(
x
Ë(((xË& 
LADSPA_HINT_DEFAULT_MASK
) \

335 =
LADSPA_HINT_DEFAULT_440
)

	)

337 
	s_LADSPA_P‹tR™geHöt
 {

340 
LADSPA_P‹tR™geHötDes¸ùt‹
 
HötDes¸ùt‹
;

345 
LADSPA_D©a
 
LowîBound
;

350 
LADSPA_D©a
 
UµîBound
;

352 } 
	tLADSPA_P‹tR™geHöt
;

363 * 
	tLADSPA_H™dÀ
;

373 
	s_LADSPA_Des¸ùt‹
 {

379 
UniqueID
;

386 c⁄° * 
Labñ
;

389 
LADSPA_Pr›îtõs
 
Pr›îtõs
;

393 c⁄° * 
Name
;

397 c⁄° * 
Makî
;

402 c⁄° * 
C›yright
;

406 
P‹tCou¡
;

410 c⁄° 
LADSPA_P‹tDes¸ùt‹
 * 
P‹tDes¸ùt‹s
;

415 c⁄° * c⁄° * 
P‹tNames
;

419 c⁄° 
LADSPA_P‹tR™geHöt
 * 
P‹tR™geHöts
;

426 * 
Im∂emíèti⁄D©a
;

437 
LADSPA_H™dÀ
 (*
ö°™tüã
)(c⁄° 
_LADSPA_Des¸ùt‹
 * 
Des¸ùt‹
,

438 
Sam∂eR©e
);

466 (*
c⁄√˘_p‹t
)(
LADSPA_H™dÀ
 
In°™˚
,

467 
P‹t
,

468 
LADSPA_D©a
 * 
D©aLoˇti⁄
);

489 (*
a˘iv©e
)(
LADSPA_H™dÀ
 
In°™˚
);

505 (*
run
)(
LADSPA_H™dÀ
 
In°™˚
,

506 
Sam∂eCou¡
);

521 (*
run_addög
)(
LADSPA_H™dÀ
 
In°™˚
,

522 
Sam∂eCou¡
);

533 (*
£t_run_addög_gaö
)(
LADSPA_H™dÀ
 
In°™˚
,

534 
LADSPA_D©a
 
Gaö
);

549 (*
dó˘iv©e
)(
LADSPA_H™dÀ
 
In°™˚
);

558 (*
˛ónup
)(
LADSPA_H™dÀ
 
In°™˚
);

560 } 
	tLADSPA_Des¸ùt‹
;

589 c⁄° 
LADSPA_Des¸ùt‹
 * 
œd•a_des¸ùt‹
(
Index
);

592 c⁄° 
	tLADSPA_Des¸ùt‹
 *

593 (*
	tLADSPA_Des¸ùt‹_Fun˘i⁄
)(
	tIndex
);

597 #ifde‡
__˝lu•lus


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/mask.c

22 
	#SND_MASK_C


	)

23 
	#SND_MASK_INLINE


	)

25 
	~"c⁄fig.h
"

26 
	~<sys/ty≥s.h
>

27 
	~<limôs.h
>

28 
	~"pcm_loˇl.h
"

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/mask.h

22 
_¢d_mask
 
	t¢d_mask_t
;

24 
	#SND_MASK_MAX
 64

	)

26 #ifde‡
SND_MASK_INLINE


27 
	~"mask_ölöe.h
"

29 
¢d_mask_n⁄e
(
¢d_mask_t
 *
mask
);

30 
¢d_mask_™y
(
¢d_mask_t
 *
mask
);

31 
¢d_mask_lﬂd
(
¢d_mask_t
 *
mask
, 
msk
);

32 
¢d_mask_em±y
(c⁄° 
¢d_mask_t
 *
mask
);

33 
¢d_mask_fuŒ
(c⁄° 
¢d_mask_t
 *
mask
);

34 
¢d_mask_£t
(
¢d_mask_t
 *
mask
, 
vÆ
);

35 
¢d_mask_ª£t
(
¢d_mask_t
 *
mask
, 
vÆ
);

36 
¢d_mask_c›y
(
¢d_mask_t
 *
mask
, c⁄° snd_mask_à*
v
);

37 
¢d_mask_ã°
(c⁄° 
¢d_mask_t
 *
mask
, 
vÆ
);

38 
¢d_mask_öãr£˘
(
¢d_mask_t
 *
mask
, c⁄° snd_mask_à*
v
);

39 
¢d_mask_uni⁄
(
¢d_mask_t
 *
mask
, c⁄° snd_mask_à*
v
);

40 
¢d_mask_cou¡
(c⁄° 
¢d_mask_t
 *
mask
);

41 
¢d_mask_mö
(c⁄° 
¢d_mask_t
 *
mask
);

42 
¢d_mask_max
(c⁄° 
¢d_mask_t
 *
mask
);

43 
¢d_mask_£t_ønge
(
¢d_mask_t
 *
mask
, 
‰om
, 
to
);

44 
¢d_mask_ª£t_ønge
(
¢d_mask_t
 *
mask
, 
‰om
, 
to
);

45 
¢d_mask_Àave
(
¢d_mask_t
 *
mask
, 
vÆ
);

46 
¢d_mask_eq
(c⁄° 
¢d_mask_t
 *
mask
, c⁄° snd_mask_à*
v
);

47 
¢d_mask_sögÀ
(c⁄° 
¢d_mask_t
 *
mask
);

48 
¢d_mask_ªföe
(
¢d_mask_t
 *
mask
, c⁄° snd_mask_à*
v
);

49 
¢d_mask_ªföe_fú°
(
¢d_mask_t
 *
mask
);

50 
¢d_mask_ªföe_œ°
(
¢d_mask_t
 *
mask
);

51 
¢d_mask_ªföe_mö
(
¢d_mask_t
 *
mask
, 
vÆ
);

52 
¢d_mask_ªföe_max
(
¢d_mask_t
 *
mask
, 
vÆ
);

53 
¢d_mask_ªföe_£t
(
¢d_mask_t
 *
mask
, 
vÆ
);

54 
¢d_mask_vÆue
(c⁄° 
¢d_mask_t
 *
mask
);

55 
¢d_mask_Æways_eq
(c⁄° 
¢d_mask_t
 *
m1
, c⁄° snd_mask_à*
m2
);

56 
¢d_mask_√vî_eq
(c⁄° 
¢d_mask_t
 *
m1
, c⁄° snd_mask_à*
m2
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/mask_inline.h

22 
	~<°rögs.h
>

23 
	~<sys/ty≥s.h
>

25 
	#MASK_INLINE
 
ölöe


	)

27 
	#MASK_MAX
 
SND_MASK_MAX


	)

28 
	#MASK_SIZE
 (
MASK_MAX
 / 32)

	)

30 
	#MASK_OFS
(
i
Ë((iË>> 5)

	)

31 
	#MASK_BIT
(
i
Ë(1U << ((iË& 31))

	)

33 
MASK_INLINE
 
	$ld2
(
uöt32_t
 
v
)

35 
r
 = 0;

37 i‡(
v
 >= 0x10000) {

38 
v
 >>= 16;

39 
r
 += 16;

41 i‡(
v
 >= 0x100) {

42 
v
 >>= 8;

43 
r
 += 8;

45 i‡(
v
 >= 0x10) {

46 
v
 >>= 4;

47 
r
 += 4;

49 i‡(
v
 >= 4) {

50 
v
 >>= 2;

51 
r
 += 2;

53 i‡(
v
 >= 2)

54 
r
++;

55  
r
;

56 
	}
}

58 
MASK_INLINE
 
	$hweight32
(
uöt32_t
 
v
)

60 
v
 = (v & 0x55555555) + ((v >> 1) & 0x55555555);

61 
v
 = (v & 0x33333333) + ((v >> 2) & 0x33333333);

62 
v
 = (v & 0x0F0F0F0F) + ((v >> 4) & 0x0F0F0F0F);

63 
v
 = (v & 0x00FF00FF) + ((v >> 8) & 0x00FF00FF);

64  (
v
 & 0x0000FFFF) + ((v >> 16) & 0x0000FFFF);

65 
	}
}

67 
MASK_INLINE
 
size_t
 
	$¢d_mask_sizeof
()

69  (
¢d_mask_t
);

70 
	}
}

72 
MASK_INLINE
 
	$¢d_mask_n⁄e
(
¢d_mask_t
 *
mask
)

74 
	`mem£t
(
mask
, 0, (*mask));

75 
	}
}

77 
MASK_INLINE
 
	$¢d_mask_™y
(
¢d_mask_t
 *
mask
)

79 
	`mem£t
(
mask
, 0xff, 
MASK_SIZE
 * (
uöt32_t
));

80 
	}
}

82 
MASK_INLINE
 
	$¢d_mask_em±y
(c⁄° 
¢d_mask_t
 *
mask
)

84 
i
;

85 
i
 = 0; i < 
MASK_SIZE
; i++)

86 i‡(
mask
->
bôs
[
i
])

89 
	}
}

91 
MASK_INLINE
 
	$¢d_mask_fuŒ
(c⁄° 
¢d_mask_t
 *
mask
)

93 
i
;

94 
i
 = 0; i < 
MASK_SIZE
; i++)

95 i‡(
mask
->
bôs
[
i
] != 0xffffffff)

98 
	}
}

100 
MASK_INLINE
 
	$¢d_mask_cou¡
(c⁄° 
¢d_mask_t
 *
mask
)

102 
i
, 
w
 = 0;

103 
i
 = 0; i < 
MASK_SIZE
; i++)

104 
w
 +
	`hweight32
(
mask
->
bôs
[
i
]);

105  
w
;

106 
	}
}

108 
MASK_INLINE
 
	$¢d_mask_mö
(c⁄° 
¢d_mask_t
 *
mask
)

110 
i
;

111 
	`as£π
(!
	`¢d_mask_em±y
(
mask
));

112 
i
 = 0; i < 
MASK_SIZE
; i++) {

113 i‡(
mask
->
bôs
[
i
])

114  
	`ffs
(
mask
->
bôs
[
i
]) - 1 + (i << 5);

117 
	}
}

119 
MASK_INLINE
 
	$¢d_mask_max
(c⁄° 
¢d_mask_t
 *
mask
)

121 
i
;

122 
	`as£π
(!
	`¢d_mask_em±y
(
mask
));

123 
i
 = 
MASK_SIZE
 - 1; i >= 0; i--) {

124 i‡(
mask
->
bôs
[
i
])

125  
	`ld2
(
mask
->
bôs
[
i
]) + (i << 5);

128 
	}
}

130 
MASK_INLINE
 
	$¢d_mask_£t
(
¢d_mask_t
 *
mask
, 
vÆ
)

132 
	`as£π
(
vÆ
 <
SND_MASK_MAX
);

133 
mask
->
bôs
[
	`MASK_OFS
(
vÆ
)] |
	`MASK_BIT
(val);

134 
	}
}

136 
MASK_INLINE
 
	$¢d_mask_ª£t
(
¢d_mask_t
 *
mask
, 
vÆ
)

138 
	`as£π
(
vÆ
 <
SND_MASK_MAX
);

139 
mask
->
bôs
[
	`MASK_OFS
(
vÆ
)] &~
	`MASK_BIT
(val);

140 
	}
}

142 
MASK_INLINE
 
	$¢d_mask_£t_ønge
(
¢d_mask_t
 *
mask
, 
‰om
, 
to
)

144 
i
;

145 
	`as£π
(
to
 <
SND_MASK_MAX
 && 
‰om
 <=Åo);

146 
i
 = 
‰om
; i <
to
; i++)

147 
mask
->
bôs
[
	`MASK_OFS
(
i
)] |
	`MASK_BIT
(i);

148 
	}
}

150 
MASK_INLINE
 
	$¢d_mask_ª£t_ønge
(
¢d_mask_t
 *
mask
, 
‰om
, 
to
)

152 
i
;

153 
	`as£π
(
to
 <
SND_MASK_MAX
 && 
‰om
 <=Åo);

154 
i
 = 
‰om
; i <
to
; i++)

155 
mask
->
bôs
[
	`MASK_OFS
(
i
)] &~
	`MASK_BIT
(i);

156 
	}
}

158 
MASK_INLINE
 
	$¢d_mask_Àave
(
¢d_mask_t
 *
mask
, 
vÆ
)

160 
v
;

161 
	`as£π
(
vÆ
 <
SND_MASK_MAX
);

162 
v
 = 
mask
->
bôs
[
	`MASK_OFS
(
vÆ
)] & 
	`MASK_BIT
(val);

163 
	`¢d_mask_n⁄e
(
mask
);

164 
mask
->
bôs
[
	`MASK_OFS
(
vÆ
)] = 
v
;

165 
	}
}

167 
MASK_INLINE
 
	$¢d_mask_öãr£˘
(
¢d_mask_t
 *
mask
, c⁄° snd_mask_à*
v
)

169 
i
;

170 
i
 = 0; i < 
MASK_SIZE
; i++)

171 
mask
->
bôs
[
i
] &
v
->bits[i];

172 
	}
}

174 
MASK_INLINE
 
	$¢d_mask_uni⁄
(
¢d_mask_t
 *
mask
, c⁄° snd_mask_à*
v
)

176 
i
;

177 
i
 = 0; i < 
MASK_SIZE
; i++)

178 
mask
->
bôs
[
i
] |
v
->bits[i];

179 
	}
}

181 
MASK_INLINE
 
	$¢d_mask_eq
(c⁄° 
¢d_mask_t
 *
mask
, c⁄° snd_mask_à*
v
)

183  ! 
	`memcmp
(
mask
, 
v
, 
MASK_SIZE
 * 4);

184 
	}
}

186 
MASK_INLINE
 
	$¢d_mask_c›y
(
¢d_mask_t
 *
mask
, c⁄° snd_mask_à*
v
)

188 *
mask
 = *
v
;

189 
	}
}

191 
MASK_INLINE
 
	$¢d_mask_ã°
(c⁄° 
¢d_mask_t
 *
mask
, 
vÆ
)

193 
	`as£π
(
vÆ
 <
SND_MASK_MAX
);

194  
mask
->
bôs
[
	`MASK_OFS
(
vÆ
)] & 
	`MASK_BIT
(val);

195 
	}
}

197 
MASK_INLINE
 
	$¢d_mask_sögÀ
(c⁄° 
¢d_mask_t
 *
mask
)

199 
i
, 
c
 = 0;

200 
	`as£π
(!
	`¢d_mask_em±y
(
mask
));

201 
i
 = 0; i < 
MASK_SIZE
; i++) {

202 i‡(! 
mask
->
bôs
[
i
])

204 i‡(
mask
->
bôs
[
i
] & (mask->bits[i] - 1))

206 i‡(
c
)

208 
c
++;

211 
	}
}

213 
MASK_INLINE
 
	$¢d_mask_ªföe
(
¢d_mask_t
 *
mask
, c⁄° snd_mask_à*
v
)

215 
¢d_mask_t
 
ﬁd
;

216 i‡(
	`¢d_mask_em±y
(
mask
))

217  -
ENOENT
;

218 
	`¢d_mask_c›y
(&
ﬁd
, 
mask
);

219 
	`¢d_mask_öãr£˘
(
mask
, 
v
);

220 i‡(
	`¢d_mask_em±y
(
mask
))

221  -
EINVAL
;

222  !
	`¢d_mask_eq
(
mask
, &
ﬁd
);

223 
	}
}

225 
MASK_INLINE
 
	$¢d_mask_ªföe_fú°
(
¢d_mask_t
 *
mask
)

227 i‡(
	`¢d_mask_em±y
(
mask
))

228  -
ENOENT
;

229 i‡(
	`¢d_mask_sögÀ
(
mask
))

231 
	`¢d_mask_Àave
(
mask
, 
	`¢d_mask_mö
(mask));

233 
	}
}

235 
MASK_INLINE
 
	$¢d_mask_ªföe_œ°
(
¢d_mask_t
 *
mask
)

237 i‡(
	`¢d_mask_em±y
(
mask
))

238  -
ENOENT
;

239 i‡(
	`¢d_mask_sögÀ
(
mask
))

241 
	`¢d_mask_Àave
(
mask
, 
	`¢d_mask_max
(mask));

243 
	}
}

245 
MASK_INLINE
 
	$¢d_mask_ªföe_mö
(
¢d_mask_t
 *
mask
, 
vÆ
)

247 i‡(
	`¢d_mask_em±y
(
mask
))

248  -
ENOENT
;

249 i‡(
	`¢d_mask_mö
(
mask
Ë>
vÆ
)

251 
	`¢d_mask_ª£t_ønge
(
mask
, 0, 
vÆ
 - 1);

252 i‡(
	`¢d_mask_em±y
(
mask
))

253  -
EINVAL
;

255 
	}
}

257 
MASK_INLINE
 
	$¢d_mask_ªföe_max
(
¢d_mask_t
 *
mask
, 
vÆ
)

259 i‡(
	`¢d_mask_em±y
(
mask
))

260  -
ENOENT
;

261 i‡(
	`¢d_mask_max
(
mask
Ë<
vÆ
)

263 
	`¢d_mask_ª£t_ønge
(
mask
, 
vÆ
 + 1, 
SND_MASK_MAX
);

264 i‡(
	`¢d_mask_em±y
(
mask
))

265  -
EINVAL
;

267 
	}
}

269 
MASK_INLINE
 
	$¢d_mask_ªföe_£t
(
¢d_mask_t
 *
mask
, 
vÆ
)

271 
ch™ged
;

272 i‡(
	`¢d_mask_em±y
(
mask
))

273  -
ENOENT
;

274 
ch™ged
 = !
	`¢d_mask_sögÀ
(
mask
);

275 
	`¢d_mask_Àave
(
mask
, 
vÆ
);

276 i‡(
	`¢d_mask_em±y
(
mask
))

277  -
EINVAL
;

278  
ch™ged
;

279 
	}
}

281 
MASK_INLINE
 
	$¢d_mask_vÆue
(c⁄° 
¢d_mask_t
 *
mask
)

283 
	`as£π
(!
	`¢d_mask_em±y
(
mask
));

284  
	`¢d_mask_mö
(
mask
);

285 
	}
}

287 
MASK_INLINE
 
	$¢d_mask_Æways_eq
(c⁄° 
¢d_mask_t
 *
m1
, c⁄° snd_mask_à*
m2
)

289  
	`¢d_mask_sögÀ
(
m1
Ë&& snd_mask_sögÀ(
m2
) &&

290 
	`¢d_mask_vÆue
(
m1
Ë=¢d_mask_vÆue(
m2
);

291 
	}
}

293 
MASK_INLINE
 
	$¢d_mask_√vî_eq
(c⁄° 
¢d_mask_t
 *
m1
, c⁄° snd_mask_à*
m2
)

295 
i
;

296 
i
 = 0; i < 
MASK_SIZE
; i++)

297 i‡(
m1
->
bôs
[
i
] & 
m2
->bits[i])

300 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm.c

671 
	~"pcm_loˇl.h
"

672 
	~<°dio.h
>

673 
	~<°rög.h
>

674 #i‡
HAVE_MALLOC_H


675 
	~<mÆloc.h
>

677 
	~<°d¨g.h
>

678 
	~<sig«l.h
>

679 
	~<˘y≥.h
>

680 
	~<pﬁl.h
>

681 
	~<sys/mm™.h
>

682 
	~<limôs.h
>

684 #i‚de‡
DOC_HIDDEN


686 
	$pcm_°©e_to_îr‹
(
¢d_pcm_°©e_t
 
°©e
)

688 
°©e
) {

689 
SND_PCM_STATE_XRUN
:

690  -
EPIPE
;

691 
SND_PCM_STATE_SUSPENDED
:

692  -
ESTRPIPE
;

693 
SND_PCM_STATE_DISCONNECTED
:

694  -
ENODEV
;

698 
	}
}

700 
	#P_STATE
(
x
Ë(1U << 
SND_PCM_STATE_
 ## x)

	)

701 
	#P_STATE_RUNNABLE
 (
	`P_STATE
(
PREPARED
) | \

702 
	`P_STATE
(
RUNNING
) | \

703 
	`P_STATE
(
XRUN
) | \

704 
	`P_STATE
(
PAUSED
) | \

705 
	`P_STATE
(
DRAINING
))

	)

708 
	$bad_pcm_°©e
(
¢d_pcm_t
 *
pcm
, 
suµ‹ãd_°©es
,

709 
no›_°©es
)

711 
¢d_pcm_°©e_t
 
°©e
;

712 
îr
;

714 i‡(
pcm
->
own_°©e_check
)

716 
°©e
 = 
	`¢d_pcm_°©e
(
pcm
);

717 i‡(
no›_°©es
 & (1U << 
°©e
))

719 i‡(
suµ‹ãd_°©es
 & (1U << 
°©e
))

721 
îr
 = 
	`pcm_°©e_to_îr‹
(
°©e
);

722 i‡(
îr
 < 0)

723  
îr
;

724  -
EBADFD
;

725 
	}
}

736 c⁄° *
	$¢d_pcm_«me
(
¢d_pcm_t
 *
pcm
)

738 
	`as£π
(
pcm
);

739  
pcm
->
«me
;

740 
	}
}

749 
¢d_pcm_ty≥_t
 
	$¢d_pcm_ty≥
(
¢d_pcm_t
 *
pcm
)

751 
	`as£π
(
pcm
);

752  
pcm
->
ty≥
;

753 
	}
}

762 
¢d_pcm_°ªam_t
 
	$¢d_pcm_°ªam
(
¢d_pcm_t
 *
pcm
)

764 
	`as£π
(
pcm
);

765  
pcm
->
°ªam
;

766 
	}
}

776 
	$¢d_pcm_˛o£
(
¢d_pcm_t
 *
pcm
)

778 
ªs
 = 0, 
îr
;

779 
	`as£π
(
pcm
);

780 i‡(
pcm
->
£tup
 && !pcm->
d⁄Ÿ_˛o£
) {

781 
	`¢d_pcm_dr›
(
pcm
);

782 
îr
 = 
	`¢d_pcm_hw_‰ì
(
pcm
);

783 i‡(
îr
 < 0)

784 
ªs
 = 
îr
;

786 i‡(
pcm
->
mm≠_ch™√ls
)

787 
	`¢d_pcm_munm≠
(
pcm
);

788 !
	`li°_em±y
(&
pcm
->
async_h™dÀrs
)) {

789 
¢d_async_h™dÀr_t
 *
h
 = 
	`li°_íåy
(
pcm
->
async_h™dÀrs
.
√xt
, snd_async_h™dÀr_t, 
hli°
);

790 
	`¢d_async_dñ_h™dÀr
(
h
);

792 i‡(
pcm
->
›s
->
˛o£
)

793 
îr
 = 
pcm
->
›s
->
	`˛o£
’cm->
›_¨g
);

795 
îr
 = -
ENOSYS
;

796 i‡(
îr
 < 0)

797 
ªs
 = 
îr
;

798 
îr
 = 
	`¢d_pcm_‰ì
(
pcm
);

799 i‡(
îr
 < 0)

800 
ªs
 = 
îr
;

801  
ªs
;

802 
	}
}

812 
	$¢d_pcm_n⁄block
(
¢d_pcm_t
 *
pcm
, 
n⁄block
)

814 
îr
 = 0;

816 
	`as£π
(
pcm
);

821 i‡(
pcm
->
›s
->
n⁄block
)

822 
îr
 = 
pcm
->
›s
->
	`n⁄block
’cm->
›_¨g
, 
n⁄block
);

824 
îr
 = -
ENOSYS
;

825 i‡(
îr
 < 0)

826 
u∆ock
;

827 i‡(
n⁄block
 == 2) {

828 
pcm
->
mode
 |
SND_PCM_ABORT
;

829 
u∆ock
;

831 i‡(
n⁄block
)

832 
pcm
->
mode
 |
SND_PCM_NONBLOCK
;

834 i‡(
pcm
->
hw_Êags
 & 
SND_PCM_HW_PARAMS_NO_PERIOD_WAKEUP
)

835 
îr
 = -
EINVAL
;

837 
pcm
->
mode
 &~
SND_PCM_NONBLOCK
;

839 
u∆ock
:

841  
îr
;

842 
	}
}

844 #i‚de‡
DOC_HIDDEN


854 
	$¢d_pcm_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
)

856 
îr
 = 0;

858 
	`as£π
(
pcm
);

859 i‡(
sig
 == 0)

860 
sig
 = 
SIGIO
;

861 i‡(
pid
 == 0)

862 
pid
 = 
	`gëpid
();

864 #ifde‡
THREAD_SAFE_API


866 
pcm
->
lock_íabÀd
 = 0;

868 i‡(
pcm
->
›s
->
async
)

869 
îr
 = 
pcm
->
›s
->
	`async
’cm->
›_¨g
, 
sig
, 
pid
);

871 
îr
 = -
ENOSYS
;

872  
îr
;

873 
	}
}

882 
	$¢d_pcm_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_öfo_t
 *
öfo
)

884 
îr
 = 0;

886 
	`as£π
(
pcm
 && 
öfo
);

887 i‡(
pcm
->
›s
->
öfo
)

888 
îr
 = 
pcm
->
›s
->
	`öfo
’cm->
›_¨g
, 
öfo
);

890 
îr
 = -
ENOSYS
;

891  
îr
;

892 
	}
}

900 
	$¢d_pcm_hw_∑øms_cuºít
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

902 
‰ame_bôs
;

904 
	`as£π
(
pcm
 && 
∑øms
);

905 i‡(!
pcm
->
£tup
)

906  -
EBADFD
;

907 
	`mem£t
(
∑øms
, 0, 
	`¢d_pcm_hw_∑øms_sizeof
());

908 
∑øms
->
Êags
 = 
pcm
->
hw_Êags
;

909 
	`¢d_mask_£t
(&
∑øms
->
masks
[
SND_PCM_HW_PARAM_ACCESS
 - 
SND_PCM_HW_PARAM_FIRST_MASK
], 
pcm
->
ac˚ss
);

910 
	`¢d_mask_£t
(&
∑øms
->
masks
[
SND_PCM_HW_PARAM_FORMAT
 - 
SND_PCM_HW_PARAM_FIRST_MASK
], 
pcm
->
f‹m©
);

911 
	`¢d_mask_£t
(&
∑øms
->
masks
[
SND_PCM_HW_PARAM_SUBFORMAT
 - 
SND_PCM_HW_PARAM_FIRST_MASK
], 
pcm
->
subf‹m©
);

912 
‰ame_bôs
 = 
	`¢d_pcm_f‹m©_physiˇl_width
(
pcm
->
f‹m©
Ë*Öcm->
ch™√ls
;

913 
	`¢d_öãrvÆ_£t_vÆue
(&
∑øms
->
öãrvÆs
[
SND_PCM_HW_PARAM_FRAME_BITS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], 
‰ame_bôs
);

914 
	`¢d_öãrvÆ_£t_vÆue
(&
∑øms
->
öãrvÆs
[
SND_PCM_HW_PARAM_CHANNELS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], 
pcm
->
ch™√ls
);

915 
	`¢d_öãrvÆ_£t_vÆue
(&
∑øms
->
öãrvÆs
[
SND_PCM_HW_PARAM_RATE
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], 
pcm
->
øã
);

916 
	`¢d_öãrvÆ_£t_vÆue
(&
∑øms
->
öãrvÆs
[
SND_PCM_HW_PARAM_PERIOD_TIME
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], 
pcm
->
≥riod_time
);

917 
	`¢d_öãrvÆ_£t_vÆue
(&
∑øms
->
öãrvÆs
[
SND_PCM_HW_PARAM_PERIOD_SIZE
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], 
pcm
->
≥riod_size
);

918 
	`¢d_öãrvÆ_c›y
(&
∑øms
->
öãrvÆs
[
SND_PCM_HW_PARAM_PERIODS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], &
pcm
->
≥riods
);

919 
	`¢d_öãrvÆ_c›y
(&
∑øms
->
öãrvÆs
[
SND_PCM_HW_PARAM_BUFFER_TIME
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], &
pcm
->
buf„r_time
);

920 
	`¢d_öãrvÆ_£t_vÆue
(&
∑øms
->
öãrvÆs
[
SND_PCM_HW_PARAM_BUFFER_SIZE
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], 
pcm
->
buf„r_size
);

921 
	`¢d_öãrvÆ_£t_vÆue
(&
∑øms
->
öãrvÆs
[
SND_PCM_HW_PARAM_BUFFER_BYTES
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
], (
pcm
->
buf„r_size
 * 
‰ame_bôs
) / 8);

922 
∑øms
->
öfo
 = 
pcm
->info;

923 
∑øms
->
msbôs
 = 
pcm
->msbits;

924 
∑øms
->
øã_num
 = 
pcm
->rate_num;

925 
∑øms
->
øã_dí
 = 
pcm
->rate_den;

926 
∑øms
->
fifo_size
 = 
pcm
->fifo_size;

928 
	}
}

951 
	$¢d_pcm_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

953 
îr
;

954 
	`as£π
(
pcm
 && 
∑øms
);

955 
îr
 = 
	`_¢d_pcm_hw_∑øms_öã∫Æ
(
pcm
, 
∑øms
);

956 i‡(
îr
 < 0)

957  
îr
;

958 
îr
 = 
	`¢d_pcm_¥ï¨e
(
pcm
);

959  
îr
;

960 
	}
}

968 
	$¢d_pcm_hw_‰ì
(
¢d_pcm_t
 *
pcm
)

970 
îr
;

971 i‡(! 
pcm
->
£tup
)

973 i‡(
pcm
->
mm≠_ch™√ls
) {

974 
îr
 = 
	`¢d_pcm_munm≠
(
pcm
);

975 i‡(
îr
 < 0)

976  
îr
;

980 i‡(
pcm
->
›s
->
hw_‰ì
)

981 
îr
 = 
pcm
->
›s
->
	`hw_‰ì
’cm->
›_¨g
);

983 
îr
 = -
ENOSYS
;

984 
pcm
->
£tup
 = 0;

985 i‡(
îr
 < 0)

986  
îr
;

988 
	}
}

1001 
	$¢d_pcm_sw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
)

1003 
îr
;

1005 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1006 
	`SNDMSG
("PCMÇot set up");

1007  -
EIO
;

1009 i‡(! 
∑øms
->
avaû_mö
) {

1010 
	`SNDMSG
("params->avail_min is 0");

1011  -
EINVAL
;

1017 i‡(
∑øms
->
°¨t_thªshﬁd
 <
pcm
->
buf„r_size
 &&

1018 
∑øms
->
°¨t_thªshﬁd
 > (
pcm
->
buf„r_size
 /Ö¨ams->
avaû_mö
) *Öarams->avail_min) {

1019 
	`SNDMSG
("params->avail_minÖroblem for start_threshold");

1020  -
EINVAL
;

1023 
	`__¢d_pcm_lock
(
pcm
->
›_¨g
);

1024 i‡(
pcm
->
›s
->
sw_∑øms
)

1025 
îr
 = 
pcm
->
›s
->
	`sw_∑øms
’cm->
›_¨g
, 
∑øms
);

1027 
îr
 = -
ENOSYS
;

1028 i‡(
îr
 < 0) {

1029 
	`__¢d_pcm_u∆ock
(
pcm
->
›_¨g
);

1030  
îr
;

1032 
pcm
->
t°amp_mode
 = 
∑øms
->tstamp_mode;

1033 
pcm
->
t°amp_ty≥
 = 
∑øms
->tstamp_type;

1034 
pcm
->
≥riod_°ï
 = 
∑øms
->period_step;

1035 
pcm
->
avaû_mö
 = 
∑øms
->avail_min;

1036 
pcm
->
≥riod_evít
 = 
	`sw_gë_≥riod_evít
(
∑øms
);

1037 
pcm
->
°¨t_thªshﬁd
 = 
∑øms
->start_threshold;

1038 
pcm
->
°›_thªshﬁd
 = 
∑øms
->stop_threshold;

1039 
pcm
->
sûí˚_thªshﬁd
 = 
∑øms
->silence_threshold;

1040 
pcm
->
sûí˚_size
 = 
∑øms
->silence_size;

1041 
pcm
->
bound¨y
 = 
∑øms
->boundary;

1042 
	`__¢d_pcm_u∆ock
(
pcm
->
›_¨g
);

1044 
	}
}

1054 
	$¢d_pcm_°©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©us_t
 *
°©us
)

1056 
îr
;

1058 
	`as£π
(
pcm
 && 
°©us
);

1059 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1060 i‡(
pcm
->
Á°_›s
->
°©us
)

1061 
îr
 = 
pcm
->
Á°_›s
->
	`°©us
’cm->
Á°_›_¨g
, 
°©us
);

1063 
îr
 = -
ENOSYS
;

1064 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1066  
îr
;

1067 
	}
}

1083 
¢d_pcm_°©e_t
 
	$¢d_pcm_°©e
(
¢d_pcm_t
 *
pcm
)

1085 
¢d_pcm_°©e_t
 
°©e
;

1087 
	`as£π
(
pcm
);

1088 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1089 
°©e
 = 
	`__¢d_pcm_°©e
(
pcm
);

1090 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1091  
°©e
;

1092 
	}
}

1107 
	$¢d_pcm_hwsync
(
¢d_pcm_t
 *
pcm
)

1109 
îr
;

1111 
	`as£π
(
pcm
);

1112 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1113 
	`SNDMSG
("PCMÇot set up");

1114  -
EIO
;

1116 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1117 
îr
 = 
	`__¢d_pcm_hwsync
(
pcm
);

1118 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1119  
îr
;

1120 
	}
}

1152 
	$¢d_pcm_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
)

1154 
îr
;

1156 
	`as£π
(
pcm
);

1157 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1158 
	`SNDMSG
("PCMÇot set up");

1159  -
EIO
;

1161 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1162 
îr
 = 
	`__¢d_pcm_dñay
(
pcm
, 
dñayp
);

1163 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1164  
îr
;

1165 
	}
}

1181 
	$¢d_pcm_ªsume
(
¢d_pcm_t
 *
pcm
)

1183 
îr
 = 0;

1185 
	`as£π
(
pcm
);

1186 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1187 
	`SNDMSG
("PCMÇot set up");

1188  -
EIO
;

1191 i‡(
pcm
->
Á°_›s
->
ªsume
)

1192 
îr
 = 
pcm
->
Á°_›s
->
	`ªsume
’cm->
Á°_›_¨g
);

1194 
îr
 = -
ENOSYS
;

1195  
îr
;

1196 
	}
}

1210 
	$¢d_pcm_htime°amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 *
avaû
, 
¢d_htime°amp_t
 *
t°amp
)

1212 
îr
;

1214 
	`as£π
(
pcm
);

1215 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1216 
	`SNDMSG
("PCMÇot set up");

1217  -
EIO
;

1219 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1220 i‡(
pcm
->
Á°_›s
->
htime°amp
)

1221 
îr
 = 
pcm
->
Á°_›s
->
	`htime°amp
’cm->
Á°_›_¨g
, 
avaû
, 
t°amp
);

1223 
îr
 = -
ENOSYS
;

1224 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1225  
îr
;

1226 
	}
}

1235 
	$¢d_pcm_¥ï¨e
(
¢d_pcm_t
 *
pcm
)

1237 
îr
;

1239 
	`as£π
(
pcm
);

1240 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1241 
	`SNDMSG
("PCMÇot set up");

1242  -
EIO
;

1244 
îr
 = 
	`bad_pcm_°©e
(
pcm
, ~
	`P_STATE
(
DISCONNECTED
), 0);

1245 i‡(
îr
 < 0)

1246  
îr
;

1247 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1248 i‡(
pcm
->
Á°_›s
->
¥ï¨e
)

1249 
îr
 = 
pcm
->
Á°_›s
->
	`¥ï¨e
’cm->
Á°_›_¨g
);

1251 
îr
 = -
ENOSYS
;

1252 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1253  
îr
;

1254 
	}
}

1265 
	$¢d_pcm_ª£t
(
¢d_pcm_t
 *
pcm
)

1267 
îr
;

1269 
	`as£π
(
pcm
);

1270 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1271 
	`SNDMSG
("PCMÇot set up");

1272  -
EIO
;

1274 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1275 i‡(
pcm
->
Á°_›s
->
ª£t
)

1276 
îr
 = 
pcm
->
Á°_›s
->
	`ª£t
’cm->
Á°_›_¨g
);

1278 
îr
 = -
ENOSYS
;

1279 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1280  
îr
;

1281 
	}
}

1290 
	$¢d_pcm_°¨t
(
¢d_pcm_t
 *
pcm
)

1292 
îr
;

1294 
	`as£π
(
pcm
);

1295 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1296 
	`SNDMSG
("PCMÇot set up");

1297  -
EIO
;

1299 
îr
 = 
	`bad_pcm_°©e
(
pcm
, 
	`P_STATE
(
PREPARED
), 0);

1300 i‡(
îr
 < 0)

1301  
îr
;

1302 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1303 
îr
 = 
	`__¢d_pcm_°¨t
(
pcm
);

1304 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1305  
îr
;

1306 
	}
}

1321 
	$¢d_pcm_dr›
(
¢d_pcm_t
 *
pcm
)

1323 
îr
;

1325 
	`as£π
(
pcm
);

1326 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1327 
	`SNDMSG
("PCMÇot set up");

1328  -
EIO
;

1330 
îr
 = 
	`bad_pcm_°©e
(
pcm
, 
P_STATE_RUNNABLE
 | 
	`P_STATE
(
SETUP
) |

1331 
	`P_STATE
(
SUSPENDED
), 0);

1332 i‡(
îr
 < 0)

1333  
îr
;

1334 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1335 i‡(
pcm
->
Á°_›s
->
dr›
)

1336 
îr
 = 
pcm
->
Á°_›s
->
	`dr›
’cm->
Á°_›_¨g
);

1338 
îr
 = -
ENOSYS
;

1339 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1340  
îr
;

1341 
	}
}

1358 
	$¢d_pcm_døö
(
¢d_pcm_t
 *
pcm
)

1360 
îr
;

1362 
	`as£π
(
pcm
);

1363 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1364 
	`SNDMSG
("PCMÇot set up");

1365  -
EIO
;

1367 
îr
 = 
	`bad_pcm_°©e
(
pcm
, 
P_STATE_RUNNABLE
 | 
	`P_STATE
(
SETUP
), P_STATE(SETUP));

1368 i‡(
îr
 < 0)

1369  
îr
;

1370 i‡(
îr
 == 1)

1373 i‡(
pcm
->
Á°_›s
->
døö
)

1374 
îr
 = 
pcm
->
Á°_›s
->
	`døö
’cm->
Á°_›_¨g
);

1376 
îr
 = -
ENOSYS
;

1377  
îr
;

1378 
	}
}

1392 
	$¢d_pcm_∑u£
(
¢d_pcm_t
 *
pcm
, 
íabÀ
)

1394 
îr
;

1396 
	`as£π
(
pcm
);

1397 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1398 
	`SNDMSG
("PCMÇot set up");

1399  -
EIO
;

1401 
îr
 = 
	`bad_pcm_°©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1402 i‡(
îr
 < 0)

1403  
îr
;

1404 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1405 i‡(
pcm
->
Á°_›s
->
∑u£
)

1406 
îr
 = 
pcm
->
Á°_›s
->
	`∑u£
’cm->
Á°_›_¨g
, 
íabÀ
);

1408 
îr
 = -
ENOSYS
;

1409 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1410  
îr
;

1411 
	}
}

1424 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_ªwödabÀ
(
¢d_pcm_t
 *
pcm
)

1426 
¢d_pcm_s‰ames_t
 
ªsu…
;

1427 
îr
;

1429 
	`as£π
(
pcm
);

1430 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1431 
	`SNDMSG
("PCMÇot set up");

1432  -
EIO
;

1434 
îr
 = 
	`bad_pcm_°©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1435 i‡(
îr
 < 0)

1436  
îr
;

1437 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1438 i‡(
pcm
->
Á°_›s
->
ªwödabÀ
)

1439 
ªsu…
 = 
pcm
->
Á°_›s
->
	`ªwödabÀ
’cm->
Á°_›_¨g
);

1441 
ªsu…
 = -
ENOSYS
;

1442 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1443  
ªsu…
;

1444 
	}
}

1455 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

1457 
¢d_pcm_s‰ames_t
 
ªsu…
;

1458 
îr
;

1460 
	`as£π
(
pcm
);

1461 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1462 
	`SNDMSG
("PCMÇot set up");

1463  -
EIO
;

1465 i‡(
‰ames
 == 0)

1467 
îr
 = 
	`bad_pcm_°©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1468 i‡(
îr
 < 0)

1469  
îr
;

1470 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1471 i‡(
pcm
->
Á°_›s
->
ªwöd
)

1472 
ªsu…
 = 
pcm
->
Á°_›s
->
	`ªwöd
’cm->
Á°_›_¨g
, 
‰ames
);

1474 
ªsu…
 = -
ENOSYS
;

1475 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1476  
ªsu…
;

1477 
	}
}

1490 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
)

1492 
¢d_pcm_s‰ames_t
 
ªsu…
;

1493 
îr
;

1495 
	`as£π
(
pcm
);

1496 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1497 
	`SNDMSG
("PCMÇot set up");

1498  -
EIO
;

1500 
îr
 = 
	`bad_pcm_°©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1501 i‡(
îr
 < 0)

1502  
îr
;

1503 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1504 i‡(
pcm
->
Á°_›s
->
f‹w¨dabÀ
)

1505 
ªsu…
 = 
pcm
->
Á°_›s
->
	`f‹w¨dabÀ
’cm->
Á°_›_¨g
);

1507 
ªsu…
 = -
ENOSYS
;

1508 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1509  
ªsu…
;

1510 
	}
}

1521 #i‚de‡
DOXYGEN


1522 
EXPORT_SYMBOL
 
¢d_pcm_s‰ames_t
 
	$INTERNAL
(
¢d_pcm_f‹w¨d
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

1524 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

1527 
¢d_pcm_s‰ames_t
 
ªsu…
;

1528 
îr
;

1530 
	`as£π
(
pcm
);

1531 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1532 
	`SNDMSG
("PCMÇot set up");

1533  -
EIO
;

1535 i‡(
‰ames
 == 0)

1537 
îr
 = 
	`bad_pcm_°©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1538 i‡(
îr
 < 0)

1539  
îr
;

1540 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1541 i‡(
pcm
->
Á°_›s
->
f‹w¨d
)

1542 
ªsu…
 = 
pcm
->
Á°_›s
->
	`f‹w¨d
’cm->
Á°_›_¨g
, 
‰ames
);

1544 
ªsu…
 = -
ENOSYS
;

1545 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1546  
ªsu…
;

1547 
	}
}

1548 
u£_deÁu…_symbﬁ_vîsi⁄
(
__¢d_pcm_f‹w¨d
, 
¢d_pcm_f‹w¨d
, 
ALSA_0
.9.0
rc8
);

1569 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_wrôei
(
¢d_pcm_t
 *
pcm
, c⁄° *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

1571 
îr
;

1573 
	`as£π
(
pcm
);

1574 
	`as£π
(
size
 =0 || 
buf„r
);

1575 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1576 
	`SNDMSG
("PCMÇot set up");

1577  -
EIO
;

1579 i‡(
pcm
->
ac˚ss
 !
SND_PCM_ACCESS_RW_INTERLEAVED
) {

1580 
	`SNDMSG
("övÆidác˚s†ty≥ %s", 
	`¢d_pcm_ac˚ss_«me
(
pcm
->
ac˚ss
));

1581  -
EINVAL
;

1583 
îr
 = 
	`bad_pcm_°©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1584 i‡(
îr
 < 0)

1585  
îr
;

1586  
	`_¢d_pcm_wrôei
(
pcm
, 
buf„r
, 
size
);

1587 
	}
}

1608 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_wrôí
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

1610 
îr
;

1612 
	`as£π
(
pcm
);

1613 
	`as£π
(
size
 =0 || 
bufs
);

1614 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1615 
	`SNDMSG
("PCMÇot set up");

1616  -
EIO
;

1618 i‡(
pcm
->
ac˚ss
 !
SND_PCM_ACCESS_RW_NONINTERLEAVED
) {

1619 
	`SNDMSG
("övÆidác˚s†ty≥ %s", 
	`¢d_pcm_ac˚ss_«me
(
pcm
->
ac˚ss
));

1620  -
EINVAL
;

1622 
îr
 = 
	`bad_pcm_°©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1623 i‡(
îr
 < 0)

1624  
îr
;

1625  
	`_¢d_pcm_wrôí
(
pcm
, 
bufs
, 
size
);

1626 
	}
}

1647 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_ªadi
(
¢d_pcm_t
 *
pcm
, *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

1649 
îr
;

1651 
	`as£π
(
pcm
);

1652 
	`as£π
(
size
 =0 || 
buf„r
);

1653 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1654 
	`SNDMSG
("PCMÇot set up");

1655  -
EIO
;

1657 i‡(
pcm
->
ac˚ss
 !
SND_PCM_ACCESS_RW_INTERLEAVED
) {

1658 
	`SNDMSG
("övÆidác˚s†ty≥ %s", 
	`¢d_pcm_ac˚ss_«me
(
pcm
->
ac˚ss
));

1659  -
EINVAL
;

1661 
îr
 = 
	`bad_pcm_°©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1662 i‡(
îr
 < 0)

1663  
îr
;

1664  
	`_¢d_pcm_ªadi
(
pcm
, 
buf„r
, 
size
);

1665 
	}
}

1686 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_ªadn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

1688 
îr
;

1690 
	`as£π
(
pcm
);

1691 
	`as£π
(
size
 =0 || 
bufs
);

1692 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

1693 
	`SNDMSG
("PCMÇot set up");

1694  -
EIO
;

1696 i‡(
pcm
->
ac˚ss
 !
SND_PCM_ACCESS_RW_NONINTERLEAVED
) {

1697 
	`SNDMSG
("övÆidác˚s†ty≥ %s", 
	`¢d_pcm_ac˚ss_«me
(
pcm
->
ac˚ss
));

1698  -
EINVAL
;

1700 
îr
 = 
	`bad_pcm_°©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

1701 i‡(
îr
 < 0)

1702  
îr
;

1703  
	`_¢d_pcm_ªadn
(
pcm
, 
bufs
, 
size
);

1704 
	}
}

1714 
	$¢d_pcm_lök
(
¢d_pcm_t
 *
pcm1
, snd_pcm_à*
pcm2
)

1716 
îr
 = 0;

1718 
	`as£π
(
pcm1
);

1719 
	`as£π
(
pcm2
);

1720 i‡(
pcm1
->
Á°_›s
->
lök
)

1721 
îr
 = 
pcm1
->
Á°_›s
->
	`lök
’cm1->
Á°_›_¨g
, 
pcm2
);

1723 
îr
 = -
ENOSYS
;

1724  
îr
;

1725 
	}
}

1732 
	$¢d_pcm_u∆ök
(
¢d_pcm_t
 *
pcm
)

1734 
îr
 = 0;

1736 
	`as£π
(
pcm
);

1737 i‡(
pcm
->
Á°_›s
->
u∆ök
)

1738 
îr
 = 
pcm
->
Á°_›s
->
	`u∆ök
’cm->
Á°_›_¨g
);

1740 
îr
 = -
ENOSYS
;

1741  
îr
;

1742 
	}
}

1745 
	$__¢d_pcm_pﬁl_des¸ùt‹s_cou¡
(
¢d_pcm_t
 *
pcm
)

1747 i‡(
pcm
->
Á°_›s
->
pﬁl_des¸ùt‹s_cou¡
)

1748  
pcm
->
Á°_›s
->
	`pﬁl_des¸ùt‹s_cou¡
’cm->
Á°_›_¨g
);

1749  
pcm
->
pﬁl_fd_cou¡
;

1750 
	}
}

1759 
	$¢d_pcm_pﬁl_des¸ùt‹s_cou¡
(
¢d_pcm_t
 *
pcm
)

1761 
cou¡
;

1763 
	`as£π
(
pcm
);

1764 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1765 
cou¡
 = 
	`__¢d_pcm_pﬁl_des¸ùt‹s_cou¡
(
pcm
);

1766 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1767  
cou¡
;

1768 
	}
}

1771 
	$__¢d_pcm_pﬁl_des¸ùt‹s
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
,

1772 
•a˚
)

1774 i‡(
pcm
->
Á°_›s
->
pﬁl_des¸ùt‹s
)

1775  
pcm
->
Á°_›s
->
	`pﬁl_des¸ùt‹s
’cm->
Á°_›_¨g
, 
pfds
, 
•a˚
);

1776 i‡(
pcm
->
pﬁl_fd
 < 0) {

1777 
	`SNDMSG
("poll_fd < 0");

1778  -
EIO
;

1780 i‡(
•a˚
 >1 && 
pfds
) {

1781 
pfds
->
fd
 = 
pcm
->
pﬁl_fd
;

1782 
pfds
->
evíts
 = 
pcm
->
pﬁl_evíts
 | 
POLLERR
 | 
POLLNVAL
;

1787 
	}
}

1823 
	$¢d_pcm_pﬁl_des¸ùt‹s
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
•a˚
)

1825 
îr
;

1827 
	`as£π
(
pcm
 && 
pfds
);

1828 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1829 
îr
 = 
	`__¢d_pcm_pﬁl_des¸ùt‹s
(
pcm
, 
pfds
, 
•a˚
);

1830 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1831  
îr
;

1832 
	}
}

1834 
__¢d_pcm_pﬁl_ªvíts
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
,

1835 
nfds
, *
ªvíts
);

1865 
	$¢d_pcm_pﬁl_des¸ùt‹s_ªvíts
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

1867 
îr
;

1869 
	`as£π
(
pcm
 && 
pfds
 && 
ªvíts
);

1870 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

1871 
îr
 = 
	`__¢d_pcm_pﬁl_ªvíts
(
pcm
, 
pfds
, 
nfds
, 
ªvíts
);

1872 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

1873  
îr
;

1874 
	}
}

1876 
	$__¢d_pcm_pﬁl_ªvíts
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
,

1877 
nfds
, *
ªvíts
)

1879 i‡(
pcm
->
Á°_›s
->
pﬁl_ªvíts
)

1880  
pcm
->
Á°_›s
->
	`pﬁl_ªvíts
’cm->
Á°_›_¨g
, 
pfds
, 
nfds
, 
ªvíts
);

1881 i‡(
nfds
 == 1) {

1882 *
ªvíts
 = 
pfds
->revents;

1885  -
EINVAL
;

1886 
	}
}

1888 #i‚de‡
DOC_HIDDEN


1889 
	#PCMTYPE
(
v
Ë[
SND_PCM_TYPE_
##v] = #v

	)

1890 
	#STATE
(
v
Ë[
SND_PCM_STATE_
##v] = #v

	)

1891 
	#STREAM
(
v
Ë[
SND_PCM_STREAM_
##v] = #v

	)

1892 
	#READY
(
v
Ë[
SND_PCM_READY_
##v] = #v

	)

1893 
	#XRUN
(
v
Ë[
SND_PCM_XRUN_
##v] = #v

	)

1894 
	#SILENCE
(
v
Ë[
SND_PCM_SILENCE_
##v] = #v

	)

1895 
	#TSTAMP
(
v
Ë[
SND_PCM_TSTAMP_
##v] = #v

	)

1896 
	#TSTAMP_TYPE
(
v
Ë[
SND_PCM_TSTAMP_TYPE_
##v] = #v

	)

1897 
	#ACCESS
(
v
Ë[
SND_PCM_ACCESS_
##v] = #v

	)

1898 
	#START
(
v
Ë[
SND_PCM_START_
##v] = #v

	)

1899 
	#HW_PARAM
(
v
Ë[
SND_PCM_HW_PARAM_
##v] = #v

	)

1900 
	#SW_PARAM
(
v
Ë[
SND_PCM_SW_PARAM_
##v] = #v

	)

1901 
	#FORMAT
(
v
Ë[
SND_PCM_FORMAT_
##v] = #v

	)

1902 
	#SUBFORMAT
(
v
Ë[
SND_PCM_SUBFORMAT_
##v] = #v

	)

1904 
	#FORMATD
(
v
, 
d
Ë[
SND_PCM_FORMAT_
##v] = 
	)
d

1905 
	#SUBFORMATD
(
v
, 
d
Ë[
SND_PCM_SUBFORMAT_
##v] = 
	)
d

1908 c⁄° *c⁄° 
	g¢d_pcm_°ªam_«mes
[] = {

1909 
STREAM
(
PLAYBACK
),

1910 
STREAM
(
CAPTURE
),

1913 c⁄° *c⁄° 
	g¢d_pcm_°©e_«mes
[] = {

1914 
STATE
(
OPEN
),

1915 
STATE
(
SETUP
),

1916 
STATE
(
PREPARED
),

1917 
STATE
(
RUNNING
),

1918 
STATE
(
XRUN
),

1919 
STATE
(
DRAINING
),

1920 
STATE
(
PAUSED
),

1921 
STATE
(
SUSPENDED
),

1922 
STATE
(
DISCONNECTED
),

1925 c⁄° *c⁄° 
	g¢d_pcm_ac˚ss_«mes
[] = {

1926 
ACCESS
(
MMAP_INTERLEAVED
),

1927 
ACCESS
(
MMAP_NONINTERLEAVED
),

1928 
ACCESS
(
MMAP_COMPLEX
),

1929 
ACCESS
(
RW_INTERLEAVED
),

1930 
ACCESS
(
RW_NONINTERLEAVED
),

1933 c⁄° *c⁄° 
	g¢d_pcm_f‹m©_«mes
[] = {

1934 
FORMAT
(
S8
),

1935 
FORMAT
(
U8
),

1936 
FORMAT
(
S16_LE
),

1937 
FORMAT
(
S16_BE
),

1938 
FORMAT
(
U16_LE
),

1939 
FORMAT
(
U16_BE
),

1940 
FORMAT
(
S24_LE
),

1941 
FORMAT
(
S24_BE
),

1942 
FORMAT
(
U24_LE
),

1943 
FORMAT
(
U24_BE
),

1944 
FORMAT
(
S32_LE
),

1945 
FORMAT
(
S32_BE
),

1946 
FORMAT
(
U32_LE
),

1947 
FORMAT
(
U32_BE
),

1948 
FORMAT
(
FLOAT_LE
),

1949 
FORMAT
(
FLOAT_BE
),

1950 
FORMAT
(
FLOAT64_LE
),

1951 
FORMAT
(
FLOAT64_BE
),

1952 
FORMAT
(
IEC958_SUBFRAME_LE
),

1953 
FORMAT
(
IEC958_SUBFRAME_BE
),

1954 
FORMAT
(
MU_LAW
),

1955 
FORMAT
(
A_LAW
),

1956 
FORMAT
(
IMA_ADPCM
),

1957 
FORMAT
(
MPEG
),

1958 
FORMAT
(
GSM
),

1959 
FORMAT
(
S20_LE
),

1960 
FORMAT
(
S20_BE
),

1961 
FORMAT
(
U20_LE
),

1962 
FORMAT
(
U20_BE
),

1963 
FORMAT
(
SPECIAL
),

1964 
FORMAT
(
S24_3LE
),

1965 
FORMAT
(
S24_3BE
),

1966 
FORMAT
(
U24_3LE
),

1967 
FORMAT
(
U24_3BE
),

1968 
FORMAT
(
S20_3LE
),

1969 
FORMAT
(
S20_3BE
),

1970 
FORMAT
(
U20_3LE
),

1971 
FORMAT
(
U20_3BE
),

1972 
FORMAT
(
S18_3LE
),

1973 
FORMAT
(
S18_3BE
),

1974 
FORMAT
(
U18_3LE
),

1975 
FORMAT
(
U18_3BE
),

1976 
FORMAT
(
G723_24
),

1977 
FORMAT
(
G723_24_1B
),

1978 
FORMAT
(
G723_40
),

1979 
FORMAT
(
G723_40_1B
),

1980 
FORMAT
(
DSD_U8
),

1981 
FORMAT
(
DSD_U16_LE
),

1982 
FORMAT
(
DSD_U32_LE
),

1983 
FORMAT
(
DSD_U16_BE
),

1984 
FORMAT
(
DSD_U32_BE
),

1987 c⁄° *c⁄° 
	g¢d_pcm_f‹m©_Æü£s
[
SND_PCM_FORMAT_LAST
+1] = {

1988 
FORMAT
(
S16
),

1989 
FORMAT
(
U16
),

1990 
FORMAT
(
S24
),

1991 
FORMAT
(
U24
),

1992 
FORMAT
(
S32
),

1993 
FORMAT
(
U32
),

1994 
FORMAT
(
FLOAT
),

1995 
FORMAT
(
FLOAT64
),

1996 
FORMAT
(
IEC958_SUBFRAME
),

1997 
FORMAT
(
S20
),

1998 
FORMAT
(
U20
),

2001 c⁄° *c⁄° 
	g¢d_pcm_f‹m©_des¸ùti⁄s
[] = {

2002 
FORMATD
(
S8
, "Signed 8 bit"),

2003 
FORMATD
(
U8
, "Unsigned 8 bit"),

2004 
FORMATD
(
S16_LE
, "Signed 16 bit Little Endian"),

2005 
FORMATD
(
S16_BE
, "Signed 16 bit Big Endian"),

2006 
FORMATD
(
U16_LE
, "Unsigned 16 bit Little Endian"),

2007 
FORMATD
(
U16_BE
, "Unsigned 16 bit Big Endian"),

2008 
FORMATD
(
S24_LE
, "Signed 24 bit Little Endian"),

2009 
FORMATD
(
S24_BE
, "Signed 24 bit Big Endian"),

2010 
FORMATD
(
U24_LE
, "Unsigned 24 bit Little Endian"),

2011 
FORMATD
(
U24_BE
, "Unsigned 24 bit Big Endian"),

2012 
FORMATD
(
S32_LE
, "Signed 32 bit Little Endian"),

2013 
FORMATD
(
S32_BE
, "Signed 32 bit Big Endian"),

2014 
FORMATD
(
U32_LE
, "Unsigned 32 bit Little Endian"),

2015 
FORMATD
(
U32_BE
, "Unsigned 32 bit Big Endian"),

2016 
FORMATD
(
FLOAT_LE
, "Float 32 bit Little Endian"),

2017 
FORMATD
(
FLOAT_BE
, "Float 32 bit Big Endian"),

2018 
FORMATD
(
FLOAT64_LE
, "Float 64 bit Little Endian"),

2019 
FORMATD
(
FLOAT64_BE
, "Float 64 bit Big Endian"),

2020 
FORMATD
(
IEC958_SUBFRAME_LE
, "IEC-958 Little Endian"),

2021 
FORMATD
(
IEC958_SUBFRAME_BE
, "IEC-958 Big Endian"),

2022 
FORMATD
(
MU_LAW
, "Mu-Law"),

2023 
FORMATD
(
A_LAW
, "A-Law"),

2024 
FORMATD
(
IMA_ADPCM
, "Ima-ADPCM"),

2025 
FORMATD
(
MPEG
, "MPEG"),

2026 
FORMATD
(
GSM
, "GSM"),

2027 
FORMATD
(
S20_LE
, "Signed 20 bit Little Endian in 4 bytes, LSB justified"),

2028 
FORMATD
(
S20_BE
, "Signed 20 bit Big Endian in 4 bytes, LSB justified"),

2029 
FORMATD
(
U20_LE
, "Unsigned 20 bit Little Endian in 4 bytes, LSB justified"),

2030 
FORMATD
(
U20_BE
, "Unsigned 20 bit Big Endian in 4 bytes, LSB justified"),

2031 
FORMATD
(
SPECIAL
, "Special"),

2032 
FORMATD
(
S24_3LE
, "Signed 24 bit Little Endian in 3bytes"),

2033 
FORMATD
(
S24_3BE
, "Signed 24 bit Big Endian in 3bytes"),

2034 
FORMATD
(
U24_3LE
, "Unsigned 24 bit Little Endian in 3bytes"),

2035 
FORMATD
(
U24_3BE
, "Unsigned 24 bit Big Endian in 3bytes"),

2036 
FORMATD
(
S20_3LE
, "Signed 20 bit Little Endian in 3bytes"),

2037 
FORMATD
(
S20_3BE
, "Signed 20 bit Big Endian in 3bytes"),

2038 
FORMATD
(
U20_3LE
, "Unsigned 20 bit Little Endian in 3bytes"),

2039 
FORMATD
(
U20_3BE
, "Unsigned 20 bit Big Endian in 3bytes"),

2040 
FORMATD
(
S18_3LE
, "Signed 18 bit Little Endian in 3bytes"),

2041 
FORMATD
(
S18_3BE
, "Signed 18 bit Big Endian in 3bytes"),

2042 
FORMATD
(
U18_3LE
, "Unsigned 18 bit Little Endian in 3bytes"),

2043 
FORMATD
(
U18_3BE
, "Unsigned 18 bit Big Endian in 3bytes"),

2044 
FORMATD
(
G723_24
, "G.723 (ADPCM) 24 kbit/s, 8 samples in 3 bytes"),

2045 
FORMATD
(
G723_24_1B
, "G.723 (ADPCM) 24 kbit/s, 1 sample in 1 byte"),

2046 
FORMATD
(
G723_40
, "G.723 (ADPCM) 40 kbit/s, 8 samples in 3 bytes"),

2047 
FORMATD
(
G723_40_1B
, "G.723 (ADPCM) 40 kbit/s, 1 sample in 1 byte"),

2048 
FORMATD
(
DSD_U8
, "Direct Stream Digital, 1-byte (x8), oldest bit in MSB"),

2049 
FORMATD
(
DSD_U16_LE
, "Direct Stream Digital, 2-byte (x16),ÜittleÉndian, oldest bits in MSB"),

2050 
FORMATD
(
DSD_U32_LE
, "Direct Stream Digital, 4-byte (x32),ÜittleÉndian, oldest bits in MSB"),

2051 
FORMATD
(
DSD_U16_BE
, "Direct Stream Digital, 2-byte (x16), bigÉndian, oldest bits in MSB"),

2052 
FORMATD
(
DSD_U32_BE
, "Direct Stream Digital, 4-byte (x32), bigÉndian, oldest bits in MSB"),

2055 c⁄° *c⁄° 
	g¢d_pcm_ty≥_«mes
[] = {

2056 
PCMTYPE
(
HW
),

2057 
PCMTYPE
(
HOOKS
),

2058 
PCMTYPE
(
MULTI
),

2059 
PCMTYPE
(
FILE
),

2060 
PCMTYPE
(
NULL
),

2061 
PCMTYPE
(
SHM
),

2062 
PCMTYPE
(
INET
),

2063 
PCMTYPE
(
COPY
),

2064 
PCMTYPE
(
LINEAR
),

2065 
PCMTYPE
(
ALAW
),

2066 
PCMTYPE
(
MULAW
),

2067 
PCMTYPE
(
ADPCM
),

2068 
PCMTYPE
(
RATE
),

2069 
PCMTYPE
(
ROUTE
),

2070 
PCMTYPE
(
PLUG
),

2071 
PCMTYPE
(
SHARE
),

2072 
PCMTYPE
(
METER
),

2073 
PCMTYPE
(
MIX
),

2074 
PCMTYPE
(
DROUTE
),

2075 
PCMTYPE
(
LBSERVER
),

2076 
PCMTYPE
(
LINEAR_FLOAT
),

2077 
PCMTYPE
(
LADSPA
),

2078 
PCMTYPE
(
DMIX
),

2079 
PCMTYPE
(
JACK
),

2080 
PCMTYPE
(
DSNOOP
),

2081 
PCMTYPE
(
IEC958
),

2082 
PCMTYPE
(
SOFTVOL
),

2083 
PCMTYPE
(
IOPLUG
),

2084 
PCMTYPE
(
EXTPLUG
),

2085 
PCMTYPE
(
MMAP_EMUL
),

2088 c⁄° *c⁄° 
	g¢d_pcm_subf‹m©_«mes
[] = {

2089 
SUBFORMAT
(
STD
),

2090 
SUBFORMAT
(
MSBITS_MAX
),

2091 
SUBFORMAT
(
MSBITS_20
),

2092 
SUBFORMAT
(
MSBITS_24
),

2095 c⁄° *c⁄° 
	g¢d_pcm_subf‹m©_des¸ùti⁄s
[] = {

2096 
SUBFORMATD
(
STD
, "Standard"),

2097 
SUBFORMATD
(
MSBITS_MAX
, "Maximum based on PCM format"),

2098 
SUBFORMATD
(
MSBITS_20
, "20 most significant bits"),

2099 
SUBFORMATD
(
MSBITS_24
, "24 most significant bits"),

2102 c⁄° *c⁄° 
	g¢d_pcm_°¨t_mode_«mes
[] = {

2103 
START
(
EXPLICIT
),

2104 
START
(
DATA
),

2107 c⁄° *c⁄° 
	g¢d_pcm_xrun_mode_«mes
[] = {

2108 
XRUN
(
NONE
),

2109 
XRUN
(
STOP
),

2112 c⁄° *c⁄° 
	g¢d_pcm_t°amp_mode_«mes
[] = {

2113 
TSTAMP
(
NONE
),

2114 
TSTAMP
(
ENABLE
),

2117 c⁄° *c⁄° 
	g¢d_pcm_t°amp_ty≥_«mes
[] = {

2118 
TSTAMP_TYPE
(
GETTIMEOFDAY
),

2119 
TSTAMP_TYPE
(
MONOTONIC
),

2120 
TSTAMP_TYPE
(
MONOTONIC_RAW
),

2129 c⁄° *
	$¢d_pcm_°ªam_«me
(c⁄° 
¢d_pcm_°ªam_t
 
°ªam
)

2131 i‡(
°ªam
 > 
SND_PCM_STREAM_LAST
)

2132  
NULL
;

2133  
¢d_pcm_°ªam_«mes
[
°ªam
];

2134 
	}
}

2141 c⁄° *
	$¢d_pcm_ac˚ss_«me
(c⁄° 
¢d_pcm_ac˚ss_t
 
acc
)

2143 i‡(
acc
 > 
SND_PCM_ACCESS_LAST
)

2144  
NULL
;

2145  
¢d_pcm_ac˚ss_«mes
[
acc
];

2146 
	}
}

2153 c⁄° *
	$¢d_pcm_f‹m©_«me
(c⁄° 
¢d_pcm_f‹m©_t
 
f‹m©
)

2155 i‡(
f‹m©
 > 
SND_PCM_FORMAT_LAST
)

2156  
NULL
;

2157  
¢d_pcm_f‹m©_«mes
[
f‹m©
];

2158 
	}
}

2165 c⁄° *
	$¢d_pcm_f‹m©_des¸ùti⁄
(c⁄° 
¢d_pcm_f‹m©_t
 
f‹m©
)

2167 i‡(
f‹m©
 > 
SND_PCM_FORMAT_LAST
)

2168  
NULL
;

2169  
¢d_pcm_f‹m©_des¸ùti⁄s
[
f‹m©
];

2170 
	}
}

2177 
¢d_pcm_f‹m©_t
 
	$¢d_pcm_f‹m©_vÆue
(c⁄° * 
«me
)

2179 
¢d_pcm_f‹m©_t
 
f‹m©
;

2180 
f‹m©
 = 0; f‹m© <
SND_PCM_FORMAT_LAST
; format++) {

2181 i‡(
¢d_pcm_f‹m©_«mes
[
f‹m©
] &&

2182 
	`°rˇ£cmp
(
«me
, 
¢d_pcm_f‹m©_«mes
[
f‹m©
]) == 0) {

2183  
f‹m©
;

2185 i‡(
¢d_pcm_f‹m©_Æü£s
[
f‹m©
] &&

2186 
	`°rˇ£cmp
(
«me
, 
¢d_pcm_f‹m©_Æü£s
[
f‹m©
]) == 0) {

2187  
f‹m©
;

2190 
f‹m©
 = 0; f‹m© <
SND_PCM_FORMAT_LAST
; format++) {

2191 i‡(
¢d_pcm_f‹m©_des¸ùti⁄s
[
f‹m©
] &&

2192 
	`°rˇ£cmp
(
«me
, 
¢d_pcm_f‹m©_des¸ùti⁄s
[
f‹m©
]) == 0) {

2193  
f‹m©
;

2196  
SND_PCM_FORMAT_UNKNOWN
;

2197 
	}
}

2204 c⁄° *
	$¢d_pcm_subf‹m©_«me
(c⁄° 
¢d_pcm_subf‹m©_t
 
subf‹m©
)

2206 i‡(
subf‹m©
 > 
SND_PCM_SUBFORMAT_LAST
)

2207  
NULL
;

2208  
¢d_pcm_subf‹m©_«mes
[
subf‹m©
];

2209 
	}
}

2216 c⁄° *
	$¢d_pcm_subf‹m©_des¸ùti⁄
(c⁄° 
¢d_pcm_subf‹m©_t
 
subf‹m©
)

2218 i‡(
subf‹m©
 > 
SND_PCM_SUBFORMAT_LAST
)

2219  
NULL
;

2220  
¢d_pcm_subf‹m©_des¸ùti⁄s
[
subf‹m©
];

2221 
	}
}

2228 
¢d_pcm_subf‹m©_t
 
	$¢d_pcm_subf‹m©_vÆue
(c⁄° * 
«me
)

2230 
¢d_pcm_subf‹m©_t
 
subf‹m©
;

2232 
subf‹m©
 = 0; subf‹m© <
SND_PCM_SUBFORMAT_LAST
; subformat++) {

2233 i‡(
¢d_pcm_subf‹m©_«mes
[
subf‹m©
] &&

2234 !
	`°rˇ£cmp
(
«me
, 
¢d_pcm_subf‹m©_«mes
[
subf‹m©
]))

2235  
subf‹m©
;

2238 
subf‹m©
 = 0; subf‹m© <
SND_PCM_SUBFORMAT_LAST
; subformat++) {

2239 i‡(
¢d_pcm_subf‹m©_des¸ùti⁄s
[
subf‹m©
] &&

2240 !
	`°rˇ£cmp
(
«me
, 
¢d_pcm_subf‹m©_des¸ùti⁄s
[
subf‹m©
]))

2241  
subf‹m©
;

2244  
SND_PCM_SUBFORMAT_UNKNOWN
;

2245 
	}
}

2252 c⁄° *
	$¢d_pcm_°¨t_mode_«me
(
¢d_pcm_°¨t_t
 
mode
)

2254 i‡(
mode
 > 
SND_PCM_START_LAST
)

2255  
NULL
;

2256  
¢d_pcm_°¨t_mode_«mes
[
mode
];

2257 
	}
}

2259 #i‚de‡
DOC_HIDDEN


2260 
lök_w¨nög
(
¢d_pcm_°¨t_mode_«me
, "Warning: start_mode is deprecated, considerÅo use start_threshold");

2268 c⁄° *
	$¢d_pcm_xrun_mode_«me
(
¢d_pcm_xrun_t
 
mode
)

2270 i‡(
mode
 > 
SND_PCM_XRUN_LAST
)

2271  
NULL
;

2272  
¢d_pcm_xrun_mode_«mes
[
mode
];

2273 
	}
}

2275 #i‚de‡
DOC_HIDDEN


2276 
lök_w¨nög
(
¢d_pcm_xrun_mode_«me
, "Warning: xrun_mode is deprecated, considerÅo use stop_threshold");

2284 c⁄° *
	$¢d_pcm_t°amp_mode_«me
(c⁄° 
¢d_pcm_t°amp_t
 
mode
)

2286 i‡(
mode
 > 
SND_PCM_TSTAMP_LAST
)

2287  
NULL
;

2288  
¢d_pcm_t°amp_mode_«mes
[
mode
];

2289 
	}
}

2296 c⁄° *
	$¢d_pcm_t°amp_ty≥_«me
(
¢d_pcm_t°amp_ty≥_t
 
ty≥
)

2298 i‡(
ty≥
 > 
SND_PCM_TSTAMP_TYPE_LAST
)

2299  
NULL
;

2300  
¢d_pcm_t°amp_ty≥_«mes
[
ty≥
];

2301 
	}
}

2308 c⁄° *
	$¢d_pcm_°©e_«me
(c⁄° 
¢d_pcm_°©e_t
 
°©e
)

2310 i‡(
°©e
 > 
SND_PCM_STATE_LAST
)

2311  
NULL
;

2312  
¢d_pcm_°©e_«mes
[
°©e
];

2313 
	}
}

2320 #i‚de‡
DOXYGEN


2321 
EXPORT_SYMBOL
 c⁄° *
	$INTERNAL
(
¢d_pcm_ty≥_«me
)(
¢d_pcm_ty≥_t
 
ty≥
)

2323 c⁄° *
	$¢d_pcm_ty≥_«me
(
¢d_pcm_ty≥_t
 
ty≥
)

2326 i‡(
ty≥
 > 
SND_PCM_TYPE_LAST
)

2327  
NULL
;

2328  
¢d_pcm_ty≥_«mes
[
ty≥
];

2329 
	}
}

2330 
u£_deÁu…_symbﬁ_vîsi⁄
(
__¢d_pcm_ty≥_«me
, 
¢d_pcm_ty≥_«me
, 
ALSA_0
.9.0);

2338 
	$¢d_pcm_dump_hw_£tup
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

2340 
	`as£π
(
pcm
);

2341 
	`as£π
(
out
);

2342 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

2343 
	`SNDMSG
("PCMÇot set up");

2344  -
EIO
;

2346 
	`¢d_ouçut_¥ötf
(
out
, " såóm : %s\n", 
	`¢d_pcm_°ªam_«me
(
pcm
->
°ªam
));

2347 
	`¢d_ouçut_¥ötf
(
out
, "ác˚s† : %s\n", 
	`¢d_pcm_ac˚ss_«me
(
pcm
->
ac˚ss
));

2348 
	`¢d_ouçut_¥ötf
(
out
, " f‹m© : %s\n", 
	`¢d_pcm_f‹m©_«me
(
pcm
->
f‹m©
));

2349 
	`¢d_ouçut_¥ötf
(
out
, " subf‹m© : %s\n", 
	`¢d_pcm_subf‹m©_«me
(
pcm
->
subf‹m©
));

2350 
	`¢d_ouçut_¥ötf
(
out
, " ch™√l† : %u\n", 
pcm
->
ch™√ls
);

2351 
	`¢d_ouçut_¥ötf
(
out
, "Ñ©ê : %u\n", 
pcm
->
øã
);

2352 
	`¢d_ouçut_¥ötf
(
out
, "ÉxactÑate : %g (%u/%u)\n",

2353 (
pcm
->
øã_dí
 ? ((Ëpcm->
øã_num
 /Öcm->rate_den) : 0.0),

2354 
pcm
->
øã_num
,Öcm->
øã_dí
);

2355 
	`¢d_ouçut_¥ötf
(
out
, " msbô† : %u\n", 
pcm
->
msbôs
);

2356 
	`¢d_ouçut_¥ötf
(
out
, " buf„r_sizê : %lu\n", 
pcm
->
buf„r_size
);

2357 
	`¢d_ouçut_¥ötf
(
out
, "Öîiod_sizê : %lu\n", 
pcm
->
≥riod_size
);

2358 
	`¢d_ouçut_¥ötf
(
out
, "Öîiod_timê : %u\n", 
pcm
->
≥riod_time
);

2360 
	}
}

2368 
	$¢d_pcm_dump_sw_£tup
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

2370 
	`as£π
(
pcm
);

2371 
	`as£π
(
out
);

2372 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

2373 
	`SNDMSG
("PCMÇot set up");

2374  -
EIO
;

2376 
	`¢d_ouçut_¥ötf
(
out
, "Å°amp_modê : %s\n", 
	`¢d_pcm_t°amp_mode_«me
(
pcm
->
t°amp_mode
));

2377 
	`¢d_ouçut_¥ötf
(
out
, "Å°amp_ty≥ : %s\n", 
	`¢d_pcm_t°amp_ty≥_«me
(
pcm
->
t°amp_ty≥
));

2378 
	`¢d_ouçut_¥ötf
(
out
, "Öîiod_°ï : %d\n", 
pcm
->
≥riod_°ï
);

2379 
	`¢d_ouçut_¥ötf
(
out
, "ávaû_mö : %ld\n", 
pcm
->
avaû_mö
);

2380 
	`¢d_ouçut_¥ötf
(
out
, "Öîiod_evíà: %i\n", 
pcm
->
≥riod_evít
);

2381 
	`¢d_ouçut_¥ötf
(
out
, " sèπ_thªshﬁd : %ld\n", 
pcm
->
°¨t_thªshﬁd
);

2382 
	`¢d_ouçut_¥ötf
(
out
, " st›_thªshﬁd : %ld\n", 
pcm
->
°›_thªshﬁd
);

2383 
	`¢d_ouçut_¥ötf
(
out
, " sûí˚_thªshﬁd: %ld\n", 
pcm
->
sûí˚_thªshﬁd
);

2384 
	`¢d_ouçut_¥ötf
(
out
, " sûí˚_sizê: %ld\n", 
pcm
->
sûí˚_size
);

2385 
	`¢d_ouçut_¥ötf
(
out
, " bound¨y : %ld\n", 
pcm
->
bound¨y
);

2387 
	}
}

2395 
	$¢d_pcm_dump_£tup
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

2397 
	`¢d_pcm_dump_hw_£tup
(
pcm
, 
out
);

2398 
	`¢d_pcm_dump_sw_£tup
(
pcm
, 
out
);

2400 
	}
}

2408 
	$¢d_pcm_°©us_dump
(
¢d_pcm_°©us_t
 *
°©us
, 
¢d_ouçut_t
 *
out
)

2410 
	`as£π
(
°©us
);

2411 
	`¢d_ouçut_¥ötf
(
out
, " sèã : %s\n", 
	`¢d_pcm_°©e_«me
((
¢d_pcm_°©e_t
Ë
°©us
->
°©e
));

2412 
	`¢d_ouçut_¥ötf
(
out
, "Årigger_time: %ld.%06ld\n",

2413 
°©us
->
åiggî_t°amp
.
tv_£c
,

2414 
°©us
->
åiggî_t°amp
.
tv_n£c
 / 1000);

2415 
	`¢d_ouçut_¥ötf
(
out
, "Åstamp : %ld.%06ld\n",

2416 
°©us
->
t°amp
.
tv_£c
, sètus->t°amp.
tv_n£c
 / 1000);

2417 
	`¢d_ouçut_¥ötf
(
out
, " dñay : %ld\n", ()
°©us
->
dñay
);

2418 
	`¢d_ouçut_¥ötf
(
out
, "ávaû : %ld\n", ()
°©us
->
avaû
);

2419 
	`¢d_ouçut_¥ötf
(
out
, "ávaû_max : %ld\n", ()
°©us
->
avaû_max
);

2421 
	}
}

2429 
	$¢d_pcm_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

2431 
îr
 = 0;

2433 
	`as£π
(
pcm
);

2434 
	`as£π
(
out
);

2435 i‡(
pcm
->
›s
->
dump
)

2436 
pcm
->
›s
->
	`dump
’cm->
›_¨g
, 
out
);

2438 
îr
 = -
ENOSYS
;

2439  
îr
;

2440 
	}
}

2448 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_byãs_to_‰ames
(
¢d_pcm_t
 *
pcm
, 
ssize_t
 
byãs
)

2450 
	`as£π
(
pcm
);

2451 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

2452 
	`SNDMSG
("PCMÇot set up");

2453  -
EIO
;

2455  
byãs
 * 8 / 
pcm
->
‰ame_bôs
;

2456 
	}
}

2464 
ssize_t
 
	$¢d_pcm_‰ames_to_byãs
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 
‰ames
)

2466 
	`as£π
(
pcm
);

2467 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

2468 
	`SNDMSG
("PCMÇot set up");

2469  -
EIO
;

2471  
‰ames
 * 
pcm
->
‰ame_bôs
 / 8;

2472 
	}
}

2480 
	$¢d_pcm_byãs_to_ßm∂es
(
¢d_pcm_t
 *
pcm
, 
ssize_t
 
byãs
)

2482 
	`as£π
(
pcm
);

2483 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

2484 
	`SNDMSG
("PCMÇot set up");

2485  -
EIO
;

2487  
byãs
 * 8 / 
pcm
->
ßm∂e_bôs
;

2488 
	}
}

2496 
ssize_t
 
	$¢d_pcm_ßm∂es_to_byãs
(
¢d_pcm_t
 *
pcm
, 
ßm∂es
)

2498 
	`as£π
(
pcm
);

2499 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

2500 
	`SNDMSG
("PCMÇot set up");

2501  -
EIO
;

2503  
ßm∂es
 * 
pcm
->
ßm∂e_bôs
 / 8;

2504 
	}
}

2516 
	$¢d_async_add_pcm_h™dÀr
(
¢d_async_h™dÀr_t
 **
h™dÀr
, 
¢d_pcm_t
 *
pcm
,

2517 
¢d_async_ˇŒback_t
 
ˇŒback
, *
¥iv©e_d©a
)

2519 
îr
;

2520 
was_em±y
;

2521 
¢d_async_h™dÀr_t
 *
h
;

2522 
îr
 = 
	`¢d_async_add_h™dÀr
(&
h
, 
	`_¢d_pcm_async_des¸ùt‹
(
pcm
),

2523 
ˇŒback
, 
¥iv©e_d©a
);

2524 i‡(
îr
 < 0)

2525  
îr
;

2526 
h
->
ty≥
 = 
SND_ASYNC_HANDLER_PCM
;

2527 
h
->
u
.
pcm
 =Öcm;

2528 
was_em±y
 = 
	`li°_em±y
(&
pcm
->
async_h™dÀrs
);

2529 
	`li°_add_èû
(&
h
->
hli°
, &
pcm
->
async_h™dÀrs
);

2530 i‡(
was_em±y
) {

2531 
îr
 = 
	`¢d_pcm_async
(
pcm
, 
	`¢d_async_h™dÀr_gë_signo
(
h
), 
	`gëpid
());

2532 i‡(
îr
 < 0) {

2533 
	`¢d_async_dñ_h™dÀr
(
h
);

2534  
îr
;

2537 *
h™dÀr
 = 
h
;

2539 
	}
}

2546 
¢d_pcm_t
 *
	$¢d_async_h™dÀr_gë_pcm
(
¢d_async_h™dÀr_t
 *
h™dÀr
)

2548 i‡(
h™dÀr
->
ty≥
 !
SND_ASYNC_HANDLER_PCM
) {

2549 
	`SNDMSG
("övÆid h™dÀ∏ty≥ %d", 
h™dÀr
->
ty≥
);

2550  
NULL
;

2552  
h™dÀr
->
u
.
pcm
;

2553 
	}
}

2555 c⁄° *c⁄° 
	gbuûd_ö_pcms
[] = {

2559 
NULL


2562 
	$¢d_pcm_›í_c⁄f
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

2563 
¢d_c⁄fig_t
 *
pcm_roŸ
, snd_c⁄fig_à*
pcm_c⁄f
,

2564 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

2566 c⁄° *
°r
;

2567 *
buf
 = 
NULL
, *
buf1
 = NULL;

2568 
îr
;

2569 
¢d_c⁄fig_t
 *
c⁄f
, *
ty≥_c⁄f
 = 
NULL
, *
tmp
;

2570 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

2571 c⁄° *
id
;

2572 c⁄° *
lib
 = 
NULL
, *
›í_«me
 = NULL;

2573 (*
›í_func
)(
¢d_pcm_t
 **, const *,

2574 
¢d_c⁄fig_t
 *, snd_config_t *,

2575 
¢d_pcm_°ªam_t
, Ë
NULL
;

2576 #i‚de‡
PIC


2577 *
	`¢d_pcm_›í_symbﬁs
();

2579 i‡(
	`¢d_c⁄fig_gë_ty≥
(
pcm_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

2580 *
vÆ
;

2581 
id
 = 
NULL
;

2582 
	`¢d_c⁄fig_gë_id
(
pcm_c⁄f
, &
id
);

2583 
vÆ
 = 
NULL
;

2584 
	`¢d_c⁄fig_gë_ascii
(
pcm_c⁄f
, &
vÆ
);

2585 
	`SNDERR
("InvÆidÅy≥ f‹ PCM %s%sdeföôi⁄ (id: %s, vÆue: %s)", 
«me
 ?Çamê: "",Çamê? " " : "", 
id
, 
vÆ
);

2586 
	`‰ì
(
vÆ
);

2587  -
EINVAL
;

2589 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
pcm_c⁄f
, "ty≥", &
c⁄f
);

2590 i‡(
îr
 < 0) {

2591 
	`SNDERR
("type isÇot defined");

2592  
îr
;

2594 
îr
 = 
	`¢d_c⁄fig_gë_id
(
c⁄f
, &
id
);

2595 i‡(
îr
 < 0) {

2596 
	`SNDERR
("unableÅo get id");

2597  
îr
;

2599 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
c⁄f
, &
°r
);

2600 i‡(
îr
 < 0) {

2601 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

2602  
îr
;

2604 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
pcm_roŸ
, "pcm_ty≥", 
°r
, &
ty≥_c⁄f
);

2605 i‡(
îr
 >= 0) {

2606 i‡(
	`¢d_c⁄fig_gë_ty≥
(
ty≥_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

2607 
	`SNDERR
("InvÆidÅy≥ f‹ PCMÅy≥ %†deföôi⁄", 
°r
);

2608 
îr
 = -
EINVAL
;

2609 
_îr
;

2611 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
ty≥_c⁄f
) {

2612 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

2613 c⁄° *
id
;

2614 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

2616 i‡(
	`°rcmp
(
id
, "comment") == 0)

2618 i‡(
	`°rcmp
(
id
, "lib") == 0) {

2619 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
lib
);

2620 i‡(
îr
 < 0) {

2621 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

2622 
_îr
;

2626 i‡(
	`°rcmp
(
id
, "open") == 0) {

2627 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
›í_«me
);

2628 i‡(
îr
 < 0) {

2629 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

2630 
_îr
;

2634 
	`SNDERR
("Unknow¿fõld %s", 
id
);

2635 
îr
 = -
EINVAL
;

2636 
_îr
;

2639 i‡(!
›í_«me
) {

2640 
buf
 = 
	`mÆloc
(
	`°æí
(
°r
) + 32);

2641 i‡(
buf
 =
NULL
) {

2642 
îr
 = -
ENOMEM
;

2643 
_îr
;

2645 
›í_«me
 = 
buf
;

2646 
	`•rötf
(
buf
, "_¢d_pcm_%s_›í", 
°r
);

2648 i‡(!
lib
) {

2649 c⁄° *c⁄° *
buûd_ö
 = 
buûd_ö_pcms
;

2650 *
buûd_ö
) {

2651 i‡(!
	`°rcmp
(*
buûd_ö
, 
°r
))

2653 
buûd_ö
++;

2655 i‡(*
buûd_ö
 =
NULL
) {

2656 
buf1
 = 
	`mÆloc
(
	`°æí
(
°r
) + 32);

2657 i‡(
buf1
 =
NULL
) {

2658 
îr
 = -
ENOMEM
;

2659 
_îr
;

2661 
lib
 = 
buf1
;

2662 
	`•rötf
(
buf1
, "libasound_moduÀ_pcm_%s.so", 
°r
);

2665 #i‚de‡
PIC


2666 
	`¢d_pcm_›í_symbﬁs
();

2668 
›í_func
 = 
	`¢d_dlobj_ˇche_gë
(
lib
, 
›í_«me
,

2669 
	`SND_DLSYM_VERSION
(
SND_PCM_DLSYM_VERSION
), 1);

2670 i‡(
›í_func
) {

2671 
îr
 = 
	`›í_func
(
pcmp
, 
«me
, 
pcm_roŸ
, 
pcm_c⁄f
, 
°ªam
, 
mode
);

2672 i‡(
îr
 >= 0) {

2673 i‡((*
pcmp
)->
›í_func
) {

2675 
	`¢d_dlobj_ˇche_put
(
›í_func
);

2677 (*
pcmp
)->
›í_func
 = open_func;

2679 
îr
 = 0;

2681 
	`¢d_dlobj_ˇche_put
(
›í_func
);

2684 
îr
 = -
ENXIO
;

2686 i‡(
îr
 >= 0) {

2687 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
pcm_roŸ
, "deÁu…s.pcm.com∑t", &
tmp
);

2688 i‡(
îr
 >= 0) {

2689 
i
;

2690 i‡(
	`¢d_c⁄fig_gë_öãgî
(
tmp
, &
i
) >= 0) {

2691 i‡(
i
 > 0)

2692 (*
pcmp
)->
com∑t
 = 1;

2695 *
°r
 = 
	`gëív
("LIBASOUND_COMPAT");

2696 i‡(
°r
 && *str)

2697 (*
pcmp
)->
com∑t
 = 1;

2699 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
pcm_roŸ
, "deÁu…s.pcm.mö≥riodtime", &
tmp
);

2700 i‡(
îr
 >= 0)

2701 
	`¢d_c⁄fig_gë_öãgî
(
tmp
, &(*
pcmp
)->
mö≥riodtime
);

2702 
îr
 = 0;

2704 
_îr
:

2705 i‡(
ty≥_c⁄f
)

2706 
	`¢d_c⁄fig_dñëe
(
ty≥_c⁄f
);

2707 
	`‰ì
(
buf
);

2708 
	`‰ì
(
buf1
);

2709  
îr
;

2710 
	}
}

2712 
	$¢d_pcm_›í_noupd©e
(
¢d_pcm_t
 **
pcmp
, 
¢d_c⁄fig_t
 *
roŸ
,

2713 c⁄° *
«me
, 
¢d_pcm_°ªam_t
 
°ªam
,

2714 
mode
, 
h›
)

2716 
îr
;

2717 
¢d_c⁄fig_t
 *
pcm_c⁄f
;

2718 c⁄° *
°r
;

2720 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "pcm", 
«me
, &
pcm_c⁄f
);

2721 i‡(
îr
 < 0) {

2722 
	`SNDERR
("Unknow¿PCM %s", 
«me
);

2723  
îr
;

2725 i‡(
	`¢d_c⁄fig_gë_°rög
(
pcm_c⁄f
, &
°r
) >= 0)

2726 
îr
 = 
	`¢d_pcm_›í_noupd©e
(
pcmp
, 
roŸ
, 
°r
, 
°ªam
, 
mode
,

2727 
h›
 + 1);

2729 
	`¢d_c⁄fig_£t_h›
(
pcm_c⁄f
, 
h›
);

2730 
îr
 = 
	`¢d_pcm_›í_c⁄f
(
pcmp
, 
«me
, 
roŸ
, 
pcm_c⁄f
, 
°ªam
, 
mode
);

2732 
	`¢d_c⁄fig_dñëe
(
pcm_c⁄f
);

2733  
îr
;

2734 
	}
}

2744 
	$¢d_pcm_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

2745 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

2747 
¢d_c⁄fig_t
 *
t›
;

2748 
îr
;

2750 
	`as£π
(
pcmp
 && 
«me
);

2751 i‡(
	`_¢d_is_ucm_devi˚
(
«me
)) {

2752 
«me
 = 
	`uc_mgr_Æibcfg_by_devi˚
(&
t›
,Çame);

2753 i‡(
«me
 =
NULL
)

2754  -
ENODEV
;

2756 
îr
 = 
	`¢d_c⁄fig_upd©e_ªf
(&
t›
);

2757 i‡(
îr
 < 0)

2758  
îr
;

2760 
îr
 = 
	`¢d_pcm_›í_noupd©e
(
pcmp
, 
t›
, 
«me
, 
°ªam
, 
mode
, 0);

2761 
	`¢d_c⁄fig_uƒef
(
t›
);

2762  
îr
;

2763 
	}
}

2774 
	$¢d_pcm_›í_lc⁄f
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

2775 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
,

2776 
¢d_c⁄fig_t
 *
lc⁄f
)

2778 
	`as£π
(
pcmp
 && 
«me
 && 
lc⁄f
);

2779  
	`¢d_pcm_›í_noupd©e
(
pcmp
, 
lc⁄f
, 
«me
, 
°ªam
, 
mode
, 0);

2780 
	}
}

2792 
	$¢d_pcm_›í_ÁŒback
(
¢d_pcm_t
 **
pcmp
, 
¢d_c⁄fig_t
 *
roŸ
,

2793 c⁄° *
«me
, c⁄° *
‹ig_«me
,

2794 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

2796 
îr
;

2797 
	`as£π
(
pcmp
 && 
«me
 && 
roŸ
);

2798 
îr
 = 
	`¢d_pcm_›í_noupd©e
(
pcmp
, 
roŸ
, 
«me
, 
°ªam
, 
mode
, 0);

2799 i‡(
îr
 >= 0) {

2800 
	`‰ì
((*
pcmp
)->
«me
);

2801 (*
pcmp
)->
«me
 = 
‹ig_«me
 ? 
	`°rdup
(‹ig_«meË: 
NULL
;

2803  
îr
;

2804 
	}
}

2806 #i‚de‡
DOC_HIDDEN


2807 
	$¢d_pcm_√w
(
¢d_pcm_t
 **
pcmp
, 
¢d_pcm_ty≥_t
 
ty≥
, c⁄° *
«me
,

2808 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

2810 
¢d_pcm_t
 *
pcm
;

2811 #ifde‡
THREAD_SAFE_API


2812 
±hªad_muãx©å_t
 
©å
;

2815 
pcm
 = 
	`ˇŒoc
(1, (*pcm));

2816 i‡(!
pcm
)

2817  -
ENOMEM
;

2818 
pcm
->
ty≥
 =Åype;

2819 i‡(
«me
)

2820 
pcm
->
«me
 = 
	`°rdup
(name);

2821 
pcm
->
°ªam
 = stream;

2822 
pcm
->
mode
 = mode;

2823 
pcm
->
pﬁl_fd_cou¡
 = 1;

2824 
pcm
->
pﬁl_fd
 = -1;

2825 
pcm
->
›_¨g
 =Öcm;

2826 
pcm
->
Á°_›_¨g
 =Öcm;

2827 
	`INIT_LIST_HEAD
(&
pcm
->
async_h™dÀrs
);

2828 #ifde‡
THREAD_SAFE_API


2829 
	`±hªad_muãx©å_öô
(&
©å
);

2830 #ifde‡
HAVE_PTHREAD_MUTEX_RECURSIVE


2831 
	`±hªad_muãx©å_£ây≥
(&
©å
, 
PTHREAD_MUTEX_RECURSIVE
);

2833 
	`±hªad_muãx_öô
(&
pcm
->
lock
, &
©å
);

2834 
	`±hªad_muãx©å_de°roy
(&
©å
);

2838 
pcm
->
√ed_lock
 = 1;

2839 i‡(
mode
 & 
SND_PCM_ASYNC
) {

2841 
pcm
->
lock_íabÀd
 = 0;

2844 
do_lock_íabÀ
 = -1;

2847 i‡(
do_lock_íabÀ
 == -1) {

2848 *
p
 = 
	`gëív
("LIBASOUND_THREAD_SAFE");

2849 
do_lock_íabÀ
 = !
p
 || *p != '0';

2851 
pcm
->
lock_íabÀd
 = 
do_lock_íabÀ
;

2854 *
pcmp
 = 
pcm
;

2856 
	}
}

2858 
	$¢d_pcm_‰ì
(
¢d_pcm_t
 *
pcm
)

2860 
	`as£π
(
pcm
);

2861 
	`‰ì
(
pcm
->
«me
);

2862 
	`‰ì
(
pcm
->
hw
.
lök_d°
);

2863 
	`‰ì
(
pcm
->
≠∂
.
lök_d°
);

2864 
	`¢d_dlobj_ˇche_put
(
pcm
->
›í_func
);

2865 #ifde‡
THREAD_SAFE_API


2866 
	`±hªad_muãx_de°roy
(&
pcm
->
lock
);

2868 
	`‰ì
(
pcm
);

2870 
	}
}

2872 
	$¢d_pcm_›í_«med_¶ave
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

2873 
¢d_c⁄fig_t
 *
roŸ
,

2874 
¢d_c⁄fig_t
 *
c⁄f
, 
¢d_pcm_°ªam_t
 
°ªam
,

2875 
mode
, 
¢d_c⁄fig_t
 *
∑ª¡_c⁄f
)

2877 c⁄° *
°r
;

2878 
h›
;

2880 i‡((
h›
 = 
	`¢d_c⁄fig_check_h›
(
∑ª¡_c⁄f
)) < 0)

2881  
h›
;

2882 i‡(
	`¢d_c⁄fig_gë_°rög
(
c⁄f
, &
°r
) >= 0)

2883  
	`¢d_pcm_›í_noupd©e
(
pcmp
, 
roŸ
, 
°r
, 
°ªam
, 
mode
,

2884 
h›
 + 1);

2885  
	`¢d_pcm_›í_c⁄f
(
pcmp
, 
«me
, 
roŸ
, 
c⁄f
, 
°ªam
, 
mode
);

2886 
	}
}

2903 
	$¢d_pcm_waô
(
¢d_pcm_t
 *
pcm
, 
timeout
)

2905 
îr
;

2907 
	`__¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

2908 
îr
 = 
	`__¢d_pcm_waô_ö_lock
(
pcm
, 
timeout
);

2909 
	`__¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

2910  
îr
;

2911 
	}
}

2913 #i‚de‡
DOC_HIDDEN


2915 
	$__¢d_pcm_waô_ö_lock
(
¢d_pcm_t
 *
pcm
, 
timeout
)

2917 
îr
;

2920 i‡(
	`__¢d_pcm_°©e
(
pcm
Ë!
SND_PCM_STATE_DRAINING
 &&

2921 !
	`¢d_pcm_may_waô_f‹_avaû_mö
(
pcm
, 
	`¢d_pcm_mm≠_avaû
(pcm))) {

2923 
îr
 = 
	`pcm_°©e_to_îr‹
(
	`__¢d_pcm_°©e
(
pcm
));

2924  
îr
 < 0 ?Érr : 1;

2926  
	`¢d_pcm_waô_nocheck
(
pcm
, 
timeout
);

2927 
	}
}

2929 
	$__¢d_pcm_waô_io_timeout
(
¢d_pcm_t
 *
pcm
)

2931 
timeout
;

2934 
timeout
 = (
pcm
->
≥riod_size
 * 1000ULLË/Öcm->
øã
;

2936 i‡(
timeout
 < 0)

2937 
timeout
 = 0;

2939 
timeout
 += 200;

2940  
timeout
;

2941 
	}
}

2943 
	$__¢d_pcm_waô_døö_timeout
(
¢d_pcm_t
 *
pcm
)

2945 
timeout
;

2948 i‡(
	`¢d_pcm_°ªam
(
pcm
Ë=
SND_PCM_STREAM_CAPTURE
)

2951 
timeout
 = (
	`¢d_pcm_mm≠_∂ayback_dñay
(
pcm
Ë* 1000LLË/Öcm->
øã
;

2953 i‡(
timeout
 < 0)

2954 
timeout
 = 0;

2956 
timeout
 += 200;

2957  
timeout
;

2958 
	}
}

2967 
	$¢d_pcm_waô_nocheck
(
¢d_pcm_t
 *
pcm
, 
timeout
)

2969 
pﬁlfd
 *
pfd
;

2970 
ªvíts
 = 0;

2971 
≈fds
, 
îr
, 
îr_pﬁl
;

2973 
≈fds
 = 
	`__¢d_pcm_pﬁl_des¸ùt‹s_cou¡
(
pcm
);

2974 i‡(
≈fds
 <= 0 ||Çpfds >= 16) {

2975 
	`SNDERR
("InvÆidÖﬁl_fd†%d", 
≈fds
);

2976  -
EIO
;

2978 
pfd
 = 
	`Æloˇ
((*pfdË* 
≈fds
);

2979 
îr
 = 
	`__¢d_pcm_pﬁl_des¸ùt‹s
(
pcm
, 
pfd
, 
≈fds
);

2980 i‡(
îr
 < 0)

2981  
îr
;

2982 i‡(
îr
 !
≈fds
) {

2983 
	`SNDMSG
("övÆidÖﬁ»des¸ùt‹†%d", 
îr
);

2984  -
EIO
;

2986 i‡(
timeout
 =
SND_PCM_WAIT_IO
)

2987 
timeout
 = 
	`__¢d_pcm_waô_io_timeout
(
pcm
);

2988 i‡(
timeout
 =
SND_PCM_WAIT_DRAIN
)

2989 
timeout
 = 
	`__¢d_pcm_waô_døö_timeout
(
pcm
);

2990 i‡(
timeout
 < -1)

2991 
	`SNDMSG
("övÆid snd_pcm_waôÅimeouà¨gumíà%d", 
timeout
);

2993 
	`__¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

2994 
îr_pﬁl
 = 
	`pﬁl
(
pfd
, 
≈fds
, 
timeout
);

2995 
	`__¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

2996 i‡(
îr_pﬁl
 < 0) {

2997 i‡(
î∫o
 =
EINTR
 && !
	`PCMINABORT
(
pcm
Ë&& !’cm->
mode
 & 
SND_PCM_EINTR
))

2999  -
î∫o
;

3001 i‡(! 
îr_pﬁl
)

3003 
îr
 = 
	`__¢d_pcm_pﬁl_ªvíts
(
pcm
, 
pfd
, 
≈fds
, &
ªvíts
);

3004 i‡(
îr
 < 0)

3005  
îr
;

3006 i‡(
ªvíts
 & (
POLLERR
 | 
POLLNVAL
)) {

3008 
îr
 = 
	`pcm_°©e_to_îr‹
(
	`__¢d_pcm_°©e
(
pcm
));

3009  
îr
 < 0 ?Éº : -
EIO
;

3011 } !(
ªvíts
 & (
POLLIN
 | 
POLLOUT
)));

3014 
¢d_pcm_s‰ames_t
 
avaû_upd©e
;

3015 
	`__¢d_pcm_hwsync
(
pcm
);

3016 
avaû_upd©e
 = 
	`__¢d_pcm_avaû_upd©e
(
pcm
);

3017 i‡(
avaû_upd©e
 < (
¢d_pcm_s‰ames_t
)
pcm
->
avaû_mö
) {

3018 
	`¥ötf
("*** snd_pcm_wait() FATAL ERROR!!!\n");

3019 
	`¥ötf
("avaû_mö = %li,ávaû_upd©ê%li\n", 
pcm
->
avaû_mö
, 
avaû_upd©e
);

3023  
îr_pﬁl
 > 0 ? 1 : 0;

3024 
	}
}

3050 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

3052 
¢d_pcm_s‰ames_t
 
ªsu…
;

3054 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

3055 
ªsu…
 = 
	`__¢d_pcm_avaû_upd©e
(
pcm
);

3056 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

3057  
ªsu…
;

3058 
	}
}

3074 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_avaû
(
¢d_pcm_t
 *
pcm
)

3076 
îr
;

3077 
¢d_pcm_s‰ames_t
 
ªsu…
;

3079 
	`as£π
(
pcm
);

3080 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

3081 
	`SNDMSG
("PCMÇot set up");

3082  -
EIO
;

3084 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

3085 
îr
 = 
	`__¢d_pcm_hwsync
(
pcm
);

3086 i‡(
îr
 < 0)

3087 
ªsu…
 = 
îr
;

3089 
ªsu…
 = 
	`__¢d_pcm_avaû_upd©e
(
pcm
);

3090 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

3091  
ªsu…
;

3092 
	}
}

3105 
	$¢d_pcm_avaû_dñay
(
¢d_pcm_t
 *
pcm
,

3106 
¢d_pcm_s‰ames_t
 *
avaûp
,

3107 
¢d_pcm_s‰ames_t
 *
dñayp
)

3109 
¢d_pcm_s‰ames_t
 
sf
;

3110 
îr
;

3112 
	`as£π
(
pcm
 && 
avaûp
 && 
dñayp
);

3113 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

3114 
	`SNDMSG
("PCMÇot set up");

3115  -
EIO
;

3117 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

3118 
îr
 = 
	`__¢d_pcm_hwsync
(
pcm
);

3119 i‡(
îr
 < 0)

3120 
u∆ock
;

3121 
sf
 = 
	`__¢d_pcm_avaû_upd©e
(
pcm
);

3122 i‡(
sf
 < 0) {

3123 
îr
 = ()
sf
;

3124 
u∆ock
;

3126 
îr
 = 
	`__¢d_pcm_dñay
(
pcm
, 
dñayp
);

3127 i‡(
îr
 < 0)

3128 
u∆ock
;

3129 *
avaûp
 = 
sf
;

3130 
îr
 = 0;

3131 
u∆ock
:

3132 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

3133  
îr
;

3134 
	}
}

3144 
	$¢d_pcm_¨ó_sûí˚
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
, 
¢d_pcm_u‰ames_t
 
d°_off£t
,

3145 
ßm∂es
, 
¢d_pcm_f‹m©_t
 
f‹m©
)

3148 *
d°
;

3149 
d°_°ï
;

3150 
width
;

3151 
uöt64_t
 
sûí˚
;

3152 i‡(!
d°_¨ó
->
addr
)

3154 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

3155 
width
 = 
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
);

3156 
sûí˚
 = 
	`¢d_pcm_f‹m©_sûí˚_64
(
f‹m©
);

3161 i‡(
d°_¨ó
->
°ï
 =(Ë
width
 &&

3162 
width
 != 24 &&

3163 ((
öçå_t
)
d°
 & 7) == 0) {

3164 
dw‹ds
 = 
ßm∂es
 * 
width
 / 64;

3165 
uöt64_t
 *
d°p
 = (uöt64_à*)
d°
;

3166 
ßm∂es
 -
dw‹ds
 * 64 / 
width
;

3167 
dw‹ds
-- > 0)

3168 *
d°p
++ = 
sûí˚
;

3169 i‡(
ßm∂es
 == 0)

3171 
d°
 = (*)
d°p
;

3173 
d°_°ï
 = 
d°_¨ó
->
°ï
 / 8;

3174 
width
) {

3176 
uöt8_t
 
s0
 = 
sûí˚
 & 0xf0;

3177 
uöt8_t
 
s1
 = 
sûí˚
 & 0x0f;

3178 
d°bô
 = 
d°_¨ó
->
fú°
 % 8;

3179 
d°bô_°ï
 = 
d°_¨ó
->
°ï
 % 8;

3180 
ßm∂es
-- > 0) {

3181 i‡(
d°bô
) {

3182 *
d°
 &= 0xf0;

3183 *
d°
 |
s1
;

3185 *
d°
 &= 0x0f;

3186 *
d°
 |
s0
;

3188 
d°
 +
d°_°ï
;

3189 
d°bô
 +
d°bô_°ï
;

3190 i‡(
d°bô
 == 8) {

3191 
d°
++;

3192 
d°bô
 = 0;

3198 
uöt8_t
 
sû
 = 
sûí˚
;

3199 
ßm∂es
-- > 0) {

3200 *
d°
 = 
sû
;

3201 
d°
 +
d°_°ï
;

3206 
uöt16_t
 
sû
 = 
sûí˚
;

3207 
ßm∂es
-- > 0) {

3208 *(
uöt16_t
*)
d°
 = 
sû
;

3209 
d°
 +
d°_°ï
;

3214 
ßm∂es
-- > 0) {

3215 #ifde‡
SNDRV_LITTLE_ENDIAN


3216 *(
d°
 + 0Ë
sûí˚
 >> 0;

3217 *(
d°
 + 1Ë
sûí˚
 >> 8;

3218 *(
d°
 + 2Ë
sûí˚
 >> 16;

3220 *(
d°
 + 2Ë
sûí˚
 >> 0;

3221 *(
d°
 + 1Ë
sûí˚
 >> 8;

3222 *(
d°
 + 0Ë
sûí˚
 >> 16;

3224 
d°
 +
d°_°ï
;

3229 
uöt32_t
 
sû
 = 
sûí˚
;

3230 
ßm∂es
-- > 0) {

3231 *(
uöt32_t
*)
d°
 = 
sû
;

3232 
d°
 +
d°_°ï
;

3237 
ßm∂es
-- > 0) {

3238 *(
uöt64_t
*)
d°
 = 
sûí˚
;

3239 
d°
 +
d°_°ï
;

3244 
	`SNDMSG
("övÆid f‹m© width %d", 
width
);

3245  -
EINVAL
;

3248 
	}
}

3259 
	$¢d_pcm_¨ós_sûí˚
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
, 
¢d_pcm_u‰ames_t
 
d°_off£t
,

3260 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
, 
¢d_pcm_f‹m©_t
 
f‹m©
)

3262 
width
 = 
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
);

3263 
ch™√ls
 > 0) {

3264 *
addr
 = 
d°_¨ós
->addr;

3265 
°ï
 = 
d°_¨ós
->step;

3266 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
begö
 = 
d°_¨ós
;

3267 
ch™√ls1
 = 
ch™√ls
;

3268 
chns
 = 0;

3269 
îr
;

3271 
ch™√ls1
--;

3272 
chns
++;

3273 
d°_¨ós
++;

3274 i‡(
ch™√ls1
 == 0 ||

3275 
d°_¨ós
->
addr
 !=áddr ||

3276 
d°_¨ós
->
°ï
 != step ||

3277 
d°_¨ós
->
fú°
 !d°_¨ós[-1].fú° + 
width
)

3280 i‡(
chns
 > 1 && chn†* 
width
 =
°ï
) {

3282 
¢d_pcm_ch™√l_¨ó_t
 
d
;

3283 
d
.
addr
 = 
begö
->addr;

3284 
d
.
fú°
 = 
begö
->first;

3285 
d
.
°ï
 = 
width
;

3286 
îr
 = 
	`¢d_pcm_¨ó_sûí˚
(&
d
, 
d°_off£t
 * 
chns
, 
‰ames
 * chns, 
f‹m©
);

3287 
ch™√ls
 -
chns
;

3289 
îr
 = 
	`¢d_pcm_¨ó_sûí˚
(
begö
, 
d°_off£t
, 
‰ames
, 
f‹m©
);

3290 
d°_¨ós
 = 
begö
 + 1;

3291 
ch™√ls
--;

3293 i‡(
îr
 < 0)

3294  
îr
;

3297 
	}
}

3310 
	$¢d_pcm_¨ó_c›y
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
, 
¢d_pcm_u‰ames_t
 
d°_off£t
,

3311 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
, 
¢d_pcm_u‰ames_t
 
§c_off£t
,

3312 
ßm∂es
, 
¢d_pcm_f‹m©_t
 
f‹m©
)

3315 c⁄° *
§c
;

3316 *
d°
;

3317 
width
;

3318 
§c_°ï
, 
d°_°ï
;

3319 i‡(
d°_¨ó
 =
§c_¨ó
 && 
d°_off£t
 =
§c_off£t
)

3321 i‡(!
§c_¨ó
->
addr
)

3322  
	`¢d_pcm_¨ó_sûí˚
(
d°_¨ó
, 
d°_off£t
, 
ßm∂es
, 
f‹m©
);

3323 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

3324 i‡(!
d°_¨ó
->
addr
)

3326 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

3327 
width
 = 
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
);

3328 i‡(
§c_¨ó
->
°ï
 =(Ë
width
 &&

3329 
d°_¨ó
->
°ï
 =(Ë
width
) {

3330 
size_t
 
byãs
 = 
ßm∂es
 * 
width
 / 8;

3331 
ßm∂es
 -
byãs
 * 8 / 
width
;

3332 
	`as£π
(
§c
 < 
d°
 || sr¯>d° + 
byãs
);

3333 
	`as£π
(
d°
 < 
§c
 || d° >§¯+ 
byãs
);

3334 
	`mem˝y
(
d°
, 
§c
, 
byãs
);

3335 i‡(
ßm∂es
 == 0)

3338 
§c_°ï
 = 
§c_¨ó
->
°ï
 / 8;

3339 
d°_°ï
 = 
d°_¨ó
->
°ï
 / 8;

3340 
width
) {

3342 
§cbô
 = 
§c_¨ó
->
fú°
 % 8;

3343 
§cbô_°ï
 = 
§c_¨ó
->
°ï
 % 8;

3344 
d°bô
 = 
d°_¨ó
->
fú°
 % 8;

3345 
d°bô_°ï
 = 
d°_¨ó
->
°ï
 % 8;

3346 
ßm∂es
-- > 0) {

3347 
§cvÆ
;

3348 i‡(
§cbô
)

3349 
§cvÆ
 = *
§c
 & 0x0f;

3351 
§cvÆ
 = *
§c
 & 0xf0;

3352 i‡(
d°bô
)

3353 *
d°
 &= 0xf0;

3355 *
d°
 &= 0x0f;

3356 *
d°
 |
§cvÆ
;

3357 
§c
 +
§c_°ï
;

3358 
§cbô
 +
§cbô_°ï
;

3359 i‡(
§cbô
 == 8) {

3360 
§c
++;

3361 
§cbô
 = 0;

3363 
d°
 +
d°_°ï
;

3364 
d°bô
 +
d°bô_°ï
;

3365 i‡(
d°bô
 == 8) {

3366 
d°
++;

3367 
d°bô
 = 0;

3373 
ßm∂es
-- > 0) {

3374 *
d°
 = *
§c
;

3375 
§c
 +
§c_°ï
;

3376 
d°
 +
d°_°ï
;

3381 
ßm∂es
-- > 0) {

3382 *(
uöt16_t
*)
d°
 = *(c⁄° uöt16_t*)
§c
;

3383 
§c
 +
§c_°ï
;

3384 
d°
 +
d°_°ï
;

3389 
ßm∂es
-- > 0) {

3390 *(
d°
 + 0Ë*(
§c
 + 0);

3391 *(
d°
 + 1Ë*(
§c
 + 1);

3392 *(
d°
 + 2Ë*(
§c
 + 2);

3393 
§c
 +
§c_°ï
;

3394 
d°
 +
d°_°ï
;

3398 
ßm∂es
-- > 0) {

3399 *(
uöt32_t
*)
d°
 = *(c⁄° uöt32_t*)
§c
;

3400 
§c
 +
§c_°ï
;

3401 
d°
 +
d°_°ï
;

3406 
ßm∂es
-- > 0) {

3407 *(
uöt64_t
*)
d°
 = *(c⁄° uöt64_t*)
§c
;

3408 
§c
 +
§c_°ï
;

3409 
d°
 +
d°_°ï
;

3414 
	`SNDMSG
("övÆid f‹m© width %d", 
width
);

3415  -
EINVAL
;

3418 
	}
}

3431 
	$¢d_pcm_¨ós_c›y
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
, 
¢d_pcm_u‰ames_t
 
d°_off£t
,

3432 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
, 
¢d_pcm_u‰ames_t
 
§c_off£t
,

3433 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
, 
¢d_pcm_f‹m©_t
 
f‹m©
)

3435 
width
 = 
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
);

3436 
	`as£π
(
d°_¨ós
);

3437 
	`as£π
(
§c_¨ós
);

3438 i‡(! 
ch™√ls
) {

3439 
	`SNDMSG
("övÆid ch™√l†%d", 
ch™√ls
);

3440  -
EINVAL
;

3442 i‡(! 
‰ames
) {

3443 
	`SNDMSG
("övÆid føme†%ld", 
‰ames
);

3444  -
EINVAL
;

3446 
ch™√ls
 > 0) {

3447 
°ï
 = 
§c_¨ós
->step;

3448 *
§c_addr
 = 
§c_¨ós
->
addr
;

3449 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_°¨t
 = 
§c_¨ós
;

3450 *
d°_addr
 = 
d°_¨ós
->
addr
;

3451 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_°¨t
 = 
d°_¨ós
;

3452 
ch™√ls1
 = 
ch™√ls
;

3453 
chns
 = 0;

3454 
d°_¨ós
->
°ï
 == step) {

3455 
ch™√ls1
--;

3456 
chns
++;

3457 
§c_¨ós
++;

3458 
d°_¨ós
++;

3459 i‡(
ch™√ls1
 == 0 ||

3460 
§c_¨ós
->
°ï
 != step ||

3461 
§c_¨ós
->
addr
 !
§c_addr
 ||

3462 
d°_¨ós
->
addr
 !
d°_addr
 ||

3463 
§c_¨ós
->
fú°
 !§c_¨ós[-1].fú° + 
width
 ||

3464 
d°_¨ós
->
fú°
 !d°_¨ós[-1].fú° + 
width
)

3467 i‡(
chns
 > 1 && chn†* 
width
 =
°ï
) {

3468 i‡(
§c_off£t
 !
d°_off£t
 ||

3469 
§c_°¨t
->
addr
 !
d°_°¨t
->addr ||

3470 
§c_°¨t
->
fú°
 !
d°_°¨t
->first) {

3472 
¢d_pcm_ch™√l_¨ó_t
 
s
, 
d
;

3473 
s
.
addr
 = 
§c_°¨t
->addr;

3474 
s
.
fú°
 = 
§c_°¨t
->first;

3475 
s
.
°ï
 = 
width
;

3476 
d
.
addr
 = 
d°_°¨t
->addr;

3477 
d
.
fú°
 = 
d°_°¨t
->first;

3478 
d
.
°ï
 = 
width
;

3479 
	`¢d_pcm_¨ó_c›y
(&
d
, 
d°_off£t
 * 
chns
,

3480 &
s
, 
§c_off£t
 * 
chns
,

3481 
‰ames
 * 
chns
, 
f‹m©
);

3483 
ch™√ls
 -
chns
;

3485 
	`¢d_pcm_¨ó_c›y
(
d°_°¨t
, 
d°_off£t
,

3486 
§c_°¨t
, 
§c_off£t
,

3487 
‰ames
, 
f‹m©
);

3488 
§c_¨ós
 = 
§c_°¨t
 + 1;

3489 
d°_¨ós
 = 
d°_°¨t
 + 1;

3490 
ch™√ls
--;

3494 
	}
}

3509 
	$¢d_pcm_¨ós_c›y_wøp
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_ch™√ls
,

3510 
¢d_pcm_u‰ames_t
 
d°_off£t
,

3511 c⁄° 
¢d_pcm_u‰ames_t
 
d°_size
,

3512 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_ch™√ls
,

3513 
¢d_pcm_u‰ames_t
 
§c_off£t
,

3514 c⁄° 
¢d_pcm_u‰ames_t
 
§c_size
,

3515 c⁄° 
ch™√ls
,

3516 
¢d_pcm_u‰ames_t
 
‰ames
,

3517 c⁄° 
¢d_pcm_f‹m©_t
 
f‹m©
)

3519 
‰ames
 > 0) {

3520 
îr
;

3521 
¢d_pcm_u‰ames_t
 
x„r
 = 
‰ames
;

3523 i‡((
d°_off£t
 + 
x„r
Ë> 
d°_size
)

3524 
x„r
 = 
d°_size
 - 
d°_off£t
;

3526 i‡((
§c_off£t
 + 
x„r
Ë> 
§c_size
)

3527 
x„r
 = 
§c_size
 - 
§c_off£t
;

3528 
îr
 = 
	`¢d_pcm_¨ós_c›y
(
d°_ch™√ls
, 
d°_off£t
, 
§c_ch™√ls
,

3529 
§c_off£t
, 
ch™√ls
, 
x„r
, 
f‹m©
);

3530 i‡(
îr
 < 0)

3531  
îr
;

3533 
d°_off£t
 +
x„r
;

3534 i‡(
d°_off£t
 >
d°_size
)

3535 
d°_off£t
 = 0;

3536 
§c_off£t
 +
x„r
;

3537 i‡(
§c_off£t
 >
§c_size
)

3538 
§c_off£t
 = 0;

3539 
‰ames
 -
x„r
;

3543 
	}
}

3545 
	$dump_⁄e_∑øm
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
k
, 
¢d_ouçut_t
 *
out
)

3547 
	`¢d_ouçut_¥ötf
(
out
, "%s: ", 
	`¢d_pcm_hw_∑øm_«me
(
k
));

3548 
	`¢d_pcm_hw_∑øm_dump
(
∑øms
, 
k
, 
out
);

3549 
	`¢d_ouçut_putc
(
out
, '\n');

3550 
	}
}

3558 
	$¢d_pcm_hw_∑øms_dump
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_ouçut_t
 *
out
)

3560 
k
;

3561 
k
 = 
SND_PCM_HW_PARAM_FIRST_MASK
; k <
SND_PCM_HW_PARAM_LAST_MASK
; k++)

3562 
	`dump_⁄e_∑øm
(
∑øms
, 
k
, 
out
);

3563 
k
 = 
SND_PCM_HW_PARAM_FIRST_INTERVAL
; k <
SND_PCM_HW_PARAM_LAST_INTERVAL
; k++)

3564 
	`dump_⁄e_∑øm
(
∑øms
, 
k
, 
out
);

3566 
	}
}

3578 
	$¢d_pcm_hw_∑øms_ˇn_mm≠_ßm∂e_ªsﬁuti⁄
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3580 
	`as£π
(
∑øms
);

3581 i‡(
	`CHECK_SANITY
(
∑øms
->
öfo
 == ~0U)) {

3582 
	`SNDMSG
("invalid PCM info field");

3585  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_MMAP_VALID
);

3586 
	}
}

3598 
	$¢d_pcm_hw_∑øms_is_doubÀ
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3600 
	`as£π
(
∑øms
);

3601 i‡(
	`CHECK_SANITY
(
∑øms
->
öfo
 == ~0U)) {

3602 
	`SNDMSG
("invalid PCM info field");

3605  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_DOUBLE
);

3606 
	}
}

3618 
	$¢d_pcm_hw_∑øms_is_b©ch
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3620 
	`as£π
(
∑øms
);

3621 i‡(
	`CHECK_SANITY
(
∑øms
->
öfo
 == ~0U)) {

3622 
	`SNDMSG
("invalid PCM info field");

3625  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_BATCH
);

3626 
	}
}

3638 
	$¢d_pcm_hw_∑øms_is_block_å™s„r
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3640 
	`as£π
(
∑øms
);

3641 i‡(
	`CHECK_SANITY
(
∑øms
->
öfo
 == ~0U)) {

3642 
	`SNDMSG
("invalid PCM info field");

3645  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_BLOCK_TRANSFER
);

3646 
	}
}

3658 
	$¢d_pcm_hw_∑øms_is_m⁄Ÿ⁄ic
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3660 
	`as£π
(
∑øms
);

3661 i‡(
	`CHECK_SANITY
(
∑øms
->
öfo
 == ~0U)) {

3662 
	`SNDMSG
("invalid PCM info field");

3665  !!(
∑øms
->
öfo
 & 
SND_PCM_INFO_MONOTONIC
);

3666 
	}
}

3678 
	$¢d_pcm_hw_∑øms_ˇn_ovîønge
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3680 
	`as£π
(
∑øms
);

3681 i‡(
	`CHECK_SANITY
(
∑øms
->
öfo
 == ~0U)) {

3682 
	`SNDMSG
("invalid PCM info field");

3685  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_OVERRANGE
);

3686 
	}
}

3698 
	$¢d_pcm_hw_∑øms_ˇn_∑u£
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3700 
	`as£π
(
∑øms
);

3701 i‡(
	`CHECK_SANITY
(
∑øms
->
öfo
 == ~0U)) {

3702 
	`SNDMSG
("invalid PCM info field");

3705  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_PAUSE
);

3706 
	}
}

3718 
	$¢d_pcm_hw_∑øms_ˇn_ªsume
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3720 
	`as£π
(
∑øms
);

3721 i‡(
	`CHECK_SANITY
(
∑øms
->
öfo
 == ~0U)) {

3722 
	`SNDMSG
("invalid PCM info field");

3725  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_RESUME
);

3726 
	}
}

3738 
	$¢d_pcm_hw_∑øms_is_hÆf_du∂ex
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3740 
	`as£π
(
∑øms
);

3741 i‡(
	`CHECK_SANITY
(
∑øms
->
öfo
 == ~0U)) {

3742 
	`SNDMSG
("invalid PCM info field");

3745  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_HALF_DUPLEX
);

3746 
	}
}

3758 
	$¢d_pcm_hw_∑øms_is_joöt_du∂ex
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3760 
	`as£π
(
∑øms
);

3761 i‡(
	`CHECK_SANITY
(
∑øms
->
öfo
 == ~0U)) {

3762 
	`SNDMSG
("invalid PCM info field");

3765  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_JOINT_DUPLEX
);

3766 
	}
}

3778 
	$¢d_pcm_hw_∑øms_ˇn_sync_°¨t
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3780 
	`as£π
(
∑øms
);

3781 i‡(
	`CHECK_SANITY
(
∑øms
->
öfo
 == ~0U)) {

3782 
	`SNDMSG
("invalid PCM info field");

3785  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_SYNC_START
);

3786 
	}
}

3794 
	$¢d_pcm_hw_∑øms_ˇn_dißbÀ_≥riod_wakeup
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3796 
	`as£π
(
∑øms
);

3797 i‡(
	`CHECK_SANITY
(
∑øms
->
öfo
 == ~0U)) {

3798 
	`SNDMSG
("invalid PCM info field");

3801  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_NO_PERIOD_WAKEUP
);

3802 
	}
}

3817 
	$¢d_pcm_hw_∑øms_is_≥r„˘_døö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3819 
	`as£π
(
∑øms
);

3820 i‡(
	`CHECK_SANITY
(
∑øms
->
öfo
 == ~0U)) {

3821 
	`SNDMSG
("invalid PCM info field");

3824  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_PERFECT_DRAIN
);

3825 
	}
}

3837 
	$¢d_pcm_hw_∑øms_suµ‹ts_audio_wÆl˛ock_ts
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3840  
	`¢d_pcm_hw_∑øms_suµ‹ts_audio_ts_ty≥
(
∑øms
,

3841 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_COMPAT
);

3842 
	}
}

3855 
	$¢d_pcm_hw_∑øms_suµ‹ts_audio_ts_ty≥
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
ty≥
)

3857 
	`as£π
(
∑øms
);

3858 i‡(
	`CHECK_SANITY
(
∑øms
->
öfo
 == ~0U)) {

3859 
	`SNDMSG
("invalid PCM info field");

3862 
ty≥
) {

3863 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_COMPAT
:

3864  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_HAS_WALL_CLOCK
);

3865 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_DEFAULT
:

3867 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK
:

3868  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_HAS_LINK_ATIME
);

3869 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK_ABSOLUTE
:

3870  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_HAS_LINK_ABSOLUTE_ATIME
);

3871 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK_ESTIMATED
:

3872  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_HAS_LINK_ESTIMATED_ATIME
);

3873 
SNDRV_PCM_AUDIO_TSTAMP_TYPE_LINK_SYNCHRONIZED
:

3874  !!(
∑øms
->
öfo
 & 
SNDRV_PCM_INFO_HAS_LINK_SYNCHRONIZED_ATIME
);

3878 
	}
}

3891 
	$¢d_pcm_hw_∑øms_gë_øã_numdí
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

3892 *
øã_num
, *
øã_dí
)

3894 
	`as£π
(
∑øms
);

3895 i‡(
	`CHECK_SANITY
(
∑øms
->
øã_dí
 == 0)) {

3896 
	`SNDMSG
("invalidÑate_den value");

3897  -
EINVAL
;

3899 *
øã_num
 = 
∑øms
->rate_num;

3900 *
øã_dí
 = 
∑øms
->rate_den;

3902 
	}
}

3922 
	$¢d_pcm_hw_∑øms_gë_sbôs
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3924 
	`as£π
(
∑øms
);

3925 i‡(
	`CHECK_SANITY
(
∑øms
->
msbôs
 == 0)) {

3926 
	`SNDMSG
("invalid msbits value");

3927  -
EINVAL
;

3929  
∑øms
->
msbôs
;

3930 
	}
}

3941 
	$¢d_pcm_hw_∑øms_gë_fifo_size
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3943 
	`as£π
(
∑øms
);

3944 i‡(
	`CHECK_SANITY
(
∑øms
->
öfo
 == ~0U)) {

3945 
	`SNDMSG
("invalid PCM info field");

3946  -
EINVAL
;

3948  
∑øms
->
fifo_size
;

3949 
	}
}

3964 
	$¢d_pcm_hw_∑øms_™y
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

3966 
	`_¢d_pcm_hw_∑øms_™y
(
∑øms
);

3967  
	`¢d_pcm_hw_ªföe
(
pcm
, 
∑øms
);

3968 
	}
}

3974 
size_t
 
	$¢d_pcm_ac˚ss_mask_sizeof
()

3976  (
¢d_pcm_ac˚ss_mask_t
);

3977 
	}
}

3984 
	$¢d_pcm_ac˚ss_mask_mÆloc
(
¢d_pcm_ac˚ss_mask_t
 **
±r
)

3986 
	`as£π
(
±r
);

3987 *
±r
 = 
	`ˇŒoc
(1, (
¢d_pcm_ac˚ss_mask_t
));

3988 i‡(!*
±r
)

3989  -
ENOMEM
;

3991 
	}
}

3997 
	$¢d_pcm_ac˚ss_mask_‰ì
(
¢d_pcm_ac˚ss_mask_t
 *
obj
)

3999 
	`‰ì
(
obj
);

4000 
	}
}

4007 
	$¢d_pcm_ac˚ss_mask_c›y
(
¢d_pcm_ac˚ss_mask_t
 *
d°
, c⁄° snd_pcm_ac˚ss_mask_à*
§c
)

4009 
	`as£π
(
d°
 && 
§c
);

4010 *
d°
 = *
§c
;

4011 
	}
}

4017 
	$¢d_pcm_ac˚ss_mask_n⁄e
(
¢d_pcm_ac˚ss_mask_t
 *
mask
)

4019 
	`¢d_mask_n⁄e
((
¢d_mask_t
 *Ë
mask
);

4020 
	}
}

4026 
	$¢d_pcm_ac˚ss_mask_™y
(
¢d_pcm_ac˚ss_mask_t
 *
mask
)

4028 
	`¢d_mask_™y
((
¢d_mask_t
 *Ë
mask
);

4029 
	}
}

4036 
	$¢d_pcm_ac˚ss_mask_ã°
(c⁄° 
¢d_pcm_ac˚ss_mask_t
 *
mask
, 
¢d_pcm_ac˚ss_t
 
vÆ
)

4038  
	`¢d_mask_ã°
((c⁄° 
¢d_mask_t
 *Ë
mask
, (Ë
vÆ
);

4039 
	}
}

4047 
	$¢d_pcm_ac˚ss_mask_em±y
(c⁄° 
¢d_pcm_ac˚ss_mask_t
 *
mask
)

4049  
	`¢d_mask_em±y
((c⁄° 
¢d_mask_t
 *Ë
mask
);

4050 
	}
}

4057 
	$¢d_pcm_ac˚ss_mask_£t
(
¢d_pcm_ac˚ss_mask_t
 *
mask
, 
¢d_pcm_ac˚ss_t
 
vÆ
)

4059 
	`¢d_mask_£t
((
¢d_mask_t
 *Ë
mask
, (Ë
vÆ
);

4060 
	}
}

4067 
	$¢d_pcm_ac˚ss_mask_ª£t
(
¢d_pcm_ac˚ss_mask_t
 *
mask
, 
¢d_pcm_ac˚ss_t
 
vÆ
)

4069 
	`¢d_mask_ª£t
((
¢d_mask_t
 *Ë
mask
, (Ë
vÆ
);

4070 
	}
}

4076 
size_t
 
	$¢d_pcm_f‹m©_mask_sizeof
()

4078  (
¢d_pcm_f‹m©_mask_t
);

4079 
	}
}

4086 
	$¢d_pcm_f‹m©_mask_mÆloc
(
¢d_pcm_f‹m©_mask_t
 **
±r
)

4088 
	`as£π
(
±r
);

4089 *
±r
 = 
	`ˇŒoc
(1, (
¢d_pcm_f‹m©_mask_t
));

4090 i‡(!*
±r
)

4091  -
ENOMEM
;

4093 
	}
}

4099 
	$¢d_pcm_f‹m©_mask_‰ì
(
¢d_pcm_f‹m©_mask_t
 *
obj
)

4101 
	`‰ì
(
obj
);

4102 
	}
}

4109 
	$¢d_pcm_f‹m©_mask_c›y
(
¢d_pcm_f‹m©_mask_t
 *
d°
, c⁄° snd_pcm_f‹m©_mask_à*
§c
)

4111 
	`as£π
(
d°
 && 
§c
);

4112 *
d°
 = *
§c
;

4113 
	}
}

4119 
	$¢d_pcm_f‹m©_mask_n⁄e
(
¢d_pcm_f‹m©_mask_t
 *
mask
)

4121 
	`¢d_mask_n⁄e
((
¢d_mask_t
 *Ë
mask
);

4122 
	}
}

4128 
	$¢d_pcm_f‹m©_mask_™y
(
¢d_pcm_f‹m©_mask_t
 *
mask
)

4130 
	`¢d_mask_™y
((
¢d_mask_t
 *Ë
mask
);

4131 
	}
}

4138 
	$¢d_pcm_f‹m©_mask_ã°
(c⁄° 
¢d_pcm_f‹m©_mask_t
 *
mask
, 
¢d_pcm_f‹m©_t
 
vÆ
)

4140  
	`¢d_mask_ã°
((c⁄° 
¢d_mask_t
 *Ë
mask
, (Ë
vÆ
);

4141 
	}
}

4149 
	$¢d_pcm_f‹m©_mask_em±y
(c⁄° 
¢d_pcm_f‹m©_mask_t
 *
mask
)

4151  
	`¢d_mask_em±y
((c⁄° 
¢d_mask_t
 *Ë
mask
);

4152 
	}
}

4159 
	$¢d_pcm_f‹m©_mask_£t
(
¢d_pcm_f‹m©_mask_t
 *
mask
, 
¢d_pcm_f‹m©_t
 
vÆ
)

4161 
	`¢d_mask_£t
((
¢d_mask_t
 *Ë
mask
, (Ë
vÆ
);

4162 
	}
}

4169 
	$¢d_pcm_f‹m©_mask_ª£t
(
¢d_pcm_f‹m©_mask_t
 *
mask
, 
¢d_pcm_f‹m©_t
 
vÆ
)

4171 
	`¢d_mask_ª£t
((
¢d_mask_t
 *Ë
mask
, (Ë
vÆ
);

4172 
	}
}

4179 
size_t
 
	$¢d_pcm_subf‹m©_mask_sizeof
()

4181  (
¢d_pcm_subf‹m©_mask_t
);

4182 
	}
}

4189 
	$¢d_pcm_subf‹m©_mask_mÆloc
(
¢d_pcm_subf‹m©_mask_t
 **
±r
)

4191 
	`as£π
(
±r
);

4192 *
±r
 = 
	`ˇŒoc
(1, (
¢d_pcm_subf‹m©_mask_t
));

4193 i‡(!*
±r
)

4194  -
ENOMEM
;

4196 
	}
}

4202 
	$¢d_pcm_subf‹m©_mask_‰ì
(
¢d_pcm_subf‹m©_mask_t
 *
obj
)

4204 
	`‰ì
(
obj
);

4205 
	}
}

4212 
	$¢d_pcm_subf‹m©_mask_c›y
(
¢d_pcm_subf‹m©_mask_t
 *
d°
, c⁄° snd_pcm_subf‹m©_mask_à*
§c
)

4214 
	`as£π
(
d°
 && 
§c
);

4215 *
d°
 = *
§c
;

4216 
	}
}

4222 
	$¢d_pcm_subf‹m©_mask_n⁄e
(
¢d_pcm_subf‹m©_mask_t
 *
mask
)

4224 
	`¢d_mask_n⁄e
((
¢d_mask_t
 *Ë
mask
);

4225 
	}
}

4231 
	$¢d_pcm_subf‹m©_mask_™y
(
¢d_pcm_subf‹m©_mask_t
 *
mask
)

4233 
	`¢d_mask_™y
((
¢d_mask_t
 *Ë
mask
);

4234 
	}
}

4241 
	$¢d_pcm_subf‹m©_mask_ã°
(c⁄° 
¢d_pcm_subf‹m©_mask_t
 *
mask
, 
¢d_pcm_subf‹m©_t
 
vÆ
)

4243  
	`¢d_mask_ã°
((c⁄° 
¢d_mask_t
 *Ë
mask
, (Ë
vÆ
);

4244 
	}
}

4252 
	$¢d_pcm_subf‹m©_mask_em±y
(c⁄° 
¢d_pcm_subf‹m©_mask_t
 *
mask
)

4254  
	`¢d_mask_em±y
((c⁄° 
¢d_mask_t
 *Ë
mask
);

4255 
	}
}

4262 
	$¢d_pcm_subf‹m©_mask_£t
(
¢d_pcm_subf‹m©_mask_t
 *
mask
, 
¢d_pcm_subf‹m©_t
 
vÆ
)

4264 
	`¢d_mask_£t
((
¢d_mask_t
 *Ë
mask
, (Ë
vÆ
);

4265 
	}
}

4272 
	$¢d_pcm_subf‹m©_mask_ª£t
(
¢d_pcm_subf‹m©_mask_t
 *
mask
, 
¢d_pcm_subf‹m©_t
 
vÆ
)

4274 
	`¢d_mask_ª£t
((
¢d_mask_t
 *Ë
mask
, (Ë
vÆ
);

4275 
	}
}

4282 
size_t
 
	$¢d_pcm_hw_∑øms_sizeof
()

4284  (
¢d_pcm_hw_∑øms_t
);

4285 
	}
}

4292 
	$¢d_pcm_hw_∑øms_mÆloc
(
¢d_pcm_hw_∑øms_t
 **
±r
)

4294 
	`as£π
(
±r
);

4295 *
±r
 = 
	`ˇŒoc
(1, (
¢d_pcm_hw_∑øms_t
));

4296 i‡(!*
±r
)

4297  -
ENOMEM
;

4299 
	}
}

4305 
	$¢d_pcm_hw_∑øms_‰ì
(
¢d_pcm_hw_∑øms_t
 *
obj
)

4307 
	`‰ì
(
obj
);

4308 
	}
}

4315 
	$¢d_pcm_hw_∑øms_c›y
(
¢d_pcm_hw_∑øms_t
 *
d°
, c⁄° snd_pcm_hw_∑øms_à*
§c
)

4317 
	`as£π
(
d°
 && 
§c
);

4318 *
d°
 = *
§c
;

4319 
	}
}

4328 #i‚de‡
DOXYGEN


4329 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_ac˚ss
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 *
ac˚ss
)

4331 
	$¢d_pcm_hw_∑øms_gë_ac˚ss
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 *
ac˚ss
)

4334 
_vÆ
;

4335 
îr
 = 
	`¢d_pcm_hw_∑øm_gë
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
, &
_vÆ
, 
NULL
);

4336 i‡(
îr
 >= 0)

4337 *
ac˚ss
 = 
_vÆ
;

4338  
îr
;

4339 
	}
}

4348 
	$¢d_pcm_hw_∑øms_ã°_ac˚ss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 
ac˚ss
)

4350  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_ACCESS
, 
ac˚ss
, 0);

4351 
	}
}

4360 
	$¢d_pcm_hw_∑øms_£t_ac˚ss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 
ac˚ss
)

4362  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_ACCESS
, 
ac˚ss
, 0);

4363 
	}
}

4372 #i‚de‡
DOXYGEN


4373 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_ac˚ss_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 *
ac˚ss
)

4375 
	$¢d_pcm_hw_∑øms_£t_ac˚ss_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 *
ac˚ss
)

4378  
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
, 
ac˚ss
, 
NULL
);

4379 
	}
}

4388 #i‚de‡
DOXYGEN


4389 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_ac˚ss_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 *
ac˚ss
)

4391 
	$¢d_pcm_hw_∑øms_£t_ac˚ss_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 *
ac˚ss
)

4394  
	`¢d_pcm_hw_∑øm_£t_œ°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
, 
ac˚ss
, 
NULL
);

4395 
	}
}

4404 
	$¢d_pcm_hw_∑øms_£t_ac˚ss_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_mask_t
 *
mask
)

4406  
	`¢d_pcm_hw_∑øm_£t_mask
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_ACCESS
, (
¢d_mask_t
 *Ë
mask
);

4407 
	}
}

4414 
	$¢d_pcm_hw_∑øms_gë_ac˚ss_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_mask_t
 *
mask
)

4416 i‡(
∑øms
 =
NULL
 || 
mask
 == NULL)

4417  -
EINVAL
;

4418 
	`¢d_pcm_ac˚ss_mask_c›y
(
mask
, 
	`¢d_pcm_hw_∑øm_gë_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
));

4420 
	}
}

4429 #i‚de‡
DOXYGEN


4430 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 *
f‹m©
)

4432 
	$¢d_pcm_hw_∑øms_gë_f‹m©
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 *
f‹m©
)

4435  
	`¢d_pcm_hw_∑øm_gë
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
, (*)
f‹m©
, 
NULL
);

4436 
	}
}

4445 
	$¢d_pcm_hw_∑øms_ã°_f‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 
f‹m©
)

4447  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_FORMAT
, 
f‹m©
, 0);

4448 
	}
}

4457 
	$¢d_pcm_hw_∑øms_£t_f‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 
f‹m©
)

4459  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_FORMAT
, 
f‹m©
, 0);

4460 
	}
}

4469 #i‚de‡
DOXYGEN


4470 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_f‹m©_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 *
f‹m©
)

4472 
	$¢d_pcm_hw_∑øms_£t_f‹m©_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 *
f‹m©
)

4475  
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
, (*)
f‹m©
, 
NULL
);

4476 
	}
}

4485 #i‚de‡
DOXYGEN


4486 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_f‹m©_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 *
f‹m©
)

4488 
	$¢d_pcm_hw_∑øms_£t_f‹m©_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 *
f‹m©
)

4491  
	`¢d_pcm_hw_∑øm_£t_œ°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
, (*)
f‹m©
, 
NULL
);

4492 
	}
}

4501 
	$¢d_pcm_hw_∑øms_£t_f‹m©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_mask_t
 *
mask
)

4503  
	`¢d_pcm_hw_∑øm_£t_mask
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_FORMAT
, (
¢d_mask_t
 *Ë
mask
);

4504 
	}
}

4511 
	$¢d_pcm_hw_∑øms_gë_f‹m©_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_mask_t
 *
mask
)

4513 
	`¢d_pcm_f‹m©_mask_c›y
(
mask
, 
	`¢d_pcm_hw_∑øm_gë_mask
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
));

4514 
	}
}

4523 #i‚de‡
DOXYGEN


4524 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_subf‹m©
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 *
subf‹m©
)

4526 
	$¢d_pcm_hw_∑øms_gë_subf‹m©
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 *
subf‹m©
)

4529  
	`¢d_pcm_hw_∑øm_gë
(
∑øms
, 
SND_PCM_HW_PARAM_SUBFORMAT
, (*)
subf‹m©
, 
NULL
);

4530 
	}
}

4539 
	$¢d_pcm_hw_∑øms_ã°_subf‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 
subf‹m©
)

4541  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_SUBFORMAT
, 
subf‹m©
, 0);

4542 
	}
}

4551 
	$¢d_pcm_hw_∑øms_£t_subf‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 
subf‹m©
)

4553  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_SUBFORMAT
, 
subf‹m©
, 0);

4554 
	}
}

4563 #i‚de‡
DOXYGEN


4564 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_subf‹m©_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 *
subf‹m©
)

4566 
	$¢d_pcm_hw_∑øms_£t_subf‹m©_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 *
subf‹m©
)

4569  
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_SUBFORMAT
, (*)
subf‹m©
, 
NULL
);

4570 
	}
}

4579 #i‚de‡
DOXYGEN


4580 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_subf‹m©_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 *
subf‹m©
)

4582 
	$¢d_pcm_hw_∑øms_£t_subf‹m©_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 *
subf‹m©
)

4585  
	`¢d_pcm_hw_∑øm_£t_œ°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_SUBFORMAT
, (*)
subf‹m©
, 
NULL
);

4586 
	}
}

4595 
	$¢d_pcm_hw_∑øms_£t_subf‹m©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_mask_t
 *
mask
)

4597  
	`¢d_pcm_hw_∑øm_£t_mask
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_SUBFORMAT
, (
¢d_mask_t
 *Ë
mask
);

4598 
	}
}

4605 
	$¢d_pcm_hw_∑øms_gë_subf‹m©_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_mask_t
 *
mask
)

4607 
	`¢d_pcm_subf‹m©_mask_c›y
(
mask
, 
	`¢d_pcm_hw_∑øm_gë_mask
(
∑øms
, 
SND_PCM_HW_PARAM_SUBFORMAT
));

4608 
	}
}

4617 #i‚de‡
DOXYGEN


4618 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_ch™√ls
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

4620 
	$¢d_pcm_hw_∑øms_gë_ch™√ls
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

4623  
	`¢d_pcm_hw_∑øm_gë
(
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
vÆ
, 
NULL
);

4624 
	}
}

4632 #i‚de‡
DOXYGEN


4633 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_ch™√ls_mö
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

4635 
	$¢d_pcm_hw_∑øms_gë_ch™√ls_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

4638  
	`¢d_pcm_hw_∑øm_gë_mö
(
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
vÆ
, 
NULL
);

4639 
	}
}

4647 #i‚de‡
DOXYGEN


4648 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_ch™√ls_max
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

4650 
	$¢d_pcm_hw_∑øms_gë_ch™√ls_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

4653  
	`¢d_pcm_hw_∑øm_gë_max
(
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
vÆ
, 
NULL
);

4654 
	}
}

4663 
	$¢d_pcm_hw_∑øms_ã°_ch™√ls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
)

4665  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_CHANNELS
, 
vÆ
, 0);

4666 
	}
}

4675 
	$¢d_pcm_hw_∑øms_£t_ch™√ls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
)

4677  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_CHANNELS
, 
vÆ
, 0);

4678 
	}
}

4687 
	$¢d_pcm_hw_∑øms_£t_ch™√ls_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

4689  
	`¢d_pcm_hw_∑øm_£t_mö
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_CHANNELS
, 
vÆ
, 
NULL
);

4690 
	}
}

4699 
	$¢d_pcm_hw_∑øms_£t_ch™√ls_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

4701  
	`¢d_pcm_hw_∑øm_£t_max
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_CHANNELS
, 
vÆ
, 
NULL
);

4702 
	}
}

4712 
	$¢d_pcm_hw_∑øms_£t_ch™√ls_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
max
)

4714  
	`¢d_pcm_hw_∑øm_£t_mömax
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_CHANNELS
, 
mö
, 
NULL
, 
max
, NULL);

4715 
	}
}

4724 #i‚de‡
DOXYGEN


4725 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_ch™√ls_√¨
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

4727 
	$¢d_pcm_hw_∑øms_£t_ch™√ls_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

4730  
	`¢d_pcm_hw_∑øm_£t_√¨
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
vÆ
, 
NULL
);

4731 
	}
}

4740 #i‚de‡
DOXYGEN


4741 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_ch™√ls_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

4743 
	$¢d_pcm_hw_∑øms_£t_ch™√ls_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

4746  
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
vÆ
, 
NULL
);

4747 
	}
}

4756 #i‚de‡
DOXYGEN


4757 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_ch™√ls_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

4759 
	$¢d_pcm_hw_∑øms_£t_ch™√ls_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

4762  
	`¢d_pcm_hw_∑øm_£t_œ°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
vÆ
, 
NULL
);

4763 
	}
}

4775 #i‚de‡
DOXYGEN


4776 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_øã
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

4778 
	$¢d_pcm_hw_∑øms_gë_øã
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

4781  
	`¢d_pcm_hw_∑øm_gë
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
, 
vÆ
, 
dú
);

4782 
	}
}

4793 #i‚de‡
DOXYGEN


4794 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_øã_mö
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

4796 
	$¢d_pcm_hw_∑øms_gë_øã_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

4799  
	`¢d_pcm_hw_∑øm_gë_mö
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
, 
vÆ
, 
dú
);

4800 
	}
}

4811 #i‚de‡
DOXYGEN


4812 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_øã_max
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

4814 
	$¢d_pcm_hw_∑øms_gë_øã_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

4817  
	`¢d_pcm_hw_∑øm_gë_max
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
, 
vÆ
, 
dú
);

4818 
	}
}

4830 
	$¢d_pcm_hw_∑øms_ã°_øã
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
)

4832  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_RATE
, 
vÆ
, 
dú
);

4833 
	}
}

4845 
	$¢d_pcm_hw_∑øms_£t_øã
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
)

4847  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_RATE
, 
vÆ
, 
dú
);

4848 
	}
}

4860 
	$¢d_pcm_hw_∑øms_£t_øã_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

4862  
	`¢d_pcm_hw_∑øm_£t_mö
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_RATE
, 
vÆ
, 
dú
);

4863 
	}
}

4875 
	$¢d_pcm_hw_∑øms_£t_øã_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

4877  
	`¢d_pcm_hw_∑øm_£t_max
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_RATE
, 
vÆ
, 
dú
);

4878 
	}
}

4892 
	$¢d_pcm_hw_∑øms_£t_øã_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
)

4894  
	`¢d_pcm_hw_∑øm_£t_mömax
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_RATE
, 
mö
, 
mödú
, 
max
, 
maxdú
);

4895 
	}
}

4907 #i‚de‡
DOXYGEN


4908 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_øã_√¨
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

4910 
	$¢d_pcm_hw_∑øms_£t_øã_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

4913  
	`¢d_pcm_hw_∑øm_£t_√¨
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_RATE
, 
vÆ
, 
dú
);

4914 
	}
}

4926 #i‚de‡
DOXYGEN


4927 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_øã_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

4929 
	$¢d_pcm_hw_∑øms_£t_øã_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

4932  
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_RATE
, 
vÆ
, 
dú
);

4933 
	}
}

4945 #i‚de‡
DOXYGEN


4946 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_øã_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

4948 
	$¢d_pcm_hw_∑øms_£t_øã_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

4951  
	`¢d_pcm_hw_∑øm_£t_œ°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_RATE
, 
vÆ
, 
dú
);

4952 
	}
}

4961 
	$¢d_pcm_hw_∑øms_£t_øã_ªßm∂e
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
)

4963 
	`as£π
(
pcm
 && 
∑øms
);

4964 i‡(!
vÆ
)

4965 
∑øms
->
Êags
 |
SND_PCM_HW_PARAMS_NORESAMPLE
;

4967 
∑øms
->
Êags
 &~
SND_PCM_HW_PARAMS_NORESAMPLE
;

4968 
∑øms
->
rmask
 = ~0;

4969  
	`¢d_pcm_hw_ªföe
(
pcm
, 
∑øms
);

4970 
	}
}

4979 
	$¢d_pcm_hw_∑øms_gë_øã_ªßm∂e
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

4981 
	`as£π
(
pcm
 && 
∑øms
 && 
vÆ
);

4982 *
vÆ
 = 
∑øms
->
Êags
 & 
SND_PCM_HW_PARAMS_NORESAMPLE
 ? 0 : 1;

4984 
	}
}

4993 
	$¢d_pcm_hw_∑øms_£t_exp‹t_buf„r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
)

4995 
	`as£π
(
pcm
 && 
∑øms
);

4996 i‡(
vÆ
)

4997 
∑øms
->
Êags
 |
SND_PCM_HW_PARAMS_EXPORT_BUFFER
;

4999 
∑øms
->
Êags
 &~
SND_PCM_HW_PARAMS_EXPORT_BUFFER
;

5000 
∑øms
->
rmask
 = ~0;

5001  
	`¢d_pcm_hw_ªföe
(
pcm
, 
∑øms
);

5002 
	}
}

5011 
	$¢d_pcm_hw_∑øms_gë_exp‹t_buf„r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

5013 
	`as£π
(
pcm
 && 
∑øms
 && 
vÆ
);

5014 *
vÆ
 = 
∑øms
->
Êags
 & 
SND_PCM_HW_PARAMS_EXPORT_BUFFER
 ? 1 : 0;

5016 
	}
}

5040 
	$¢d_pcm_hw_∑øms_£t_≥riod_wakeup
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
)

5042 
	`as£π
(
pcm
 && 
∑øms
);

5044 i‡(!
vÆ
) {

5045 i‡(!(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
))

5046  -
EINVAL
;

5047 
∑øms
->
Êags
 |
SND_PCM_HW_PARAMS_NO_PERIOD_WAKEUP
;

5049 
∑øms
->
Êags
 &~
SND_PCM_HW_PARAMS_NO_PERIOD_WAKEUP
;

5050 
∑øms
->
rmask
 = ~0;

5052  
	`¢d_pcm_hw_ªföe
(
pcm
, 
∑øms
);

5053 
	}
}

5062 
	$¢d_pcm_hw_∑øms_gë_≥riod_wakeup
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

5064 
	`as£π
(
pcm
 && 
∑øms
 && 
vÆ
);

5065 *
vÆ
 = 
∑øms
->
Êags
 & 
SND_PCM_HW_PARAMS_NO_PERIOD_WAKEUP
 ? 0 : 1;

5067 
	}
}

5081 
	$¢d_pcm_hw_∑øms_£t_døö_sûí˚
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
)

5083 
	`as£π
(
pcm
 && 
∑øms
);

5084 i‡(
vÆ
)

5085 
∑øms
->
Êags
 &~
SND_PCM_HW_PARAMS_NO_DRAIN_SILENCE
;

5087 
∑øms
->
Êags
 |
SND_PCM_HW_PARAMS_NO_DRAIN_SILENCE
;

5088 
∑øms
->
rmask
 = ~0;

5089  
	`¢d_pcm_hw_ªföe
(
pcm
, 
∑øms
);

5090 
	}
}

5099 
	$¢d_pcm_hw_∑øms_gë_døö_sûí˚
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
)

5101 
	`as£π
(
pcm
 && 
∑øms
 && 
vÆ
);

5102 *
vÆ
 = 
∑øms
->
Êags
 & 
SND_PCM_HW_PARAMS_NO_DRAIN_SILENCE
 ? 0 : 1;

5104 
	}
}

5115 #i‚de‡
DOXYGEN


5116 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_time
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5118 
	$¢d_pcm_hw_∑øms_gë_≥riod_time
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5121  
	`¢d_pcm_hw_∑øm_gë
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
vÆ
, 
dú
);

5122 
	}
}

5133 #i‚de‡
DOXYGEN


5134 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_time_mö
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5136 
	$¢d_pcm_hw_∑øms_gë_≥riod_time_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5139  
	`¢d_pcm_hw_∑øm_gë_mö
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
vÆ
, 
dú
);

5140 
	}
}

5151 #i‚de‡
DOXYGEN


5152 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_time_max
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5154 
	$¢d_pcm_hw_∑øms_gë_≥riod_time_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5157  
	`¢d_pcm_hw_∑øm_gë_max
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
vÆ
, 
dú
);

5158 
	}
}

5170 
	$¢d_pcm_hw_∑øms_ã°_≥riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
)

5172  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
vÆ
, 
dú
);

5173 
	}
}

5185 
	$¢d_pcm_hw_∑øms_£t_≥riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
)

5187  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
vÆ
, 
dú
);

5188 
	}
}

5201 
	$¢d_pcm_hw_∑øms_£t_≥riod_time_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5203  
	`¢d_pcm_hw_∑øm_£t_mö
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
vÆ
, 
dú
);

5204 
	}
}

5216 
	$¢d_pcm_hw_∑øms_£t_≥riod_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5218  
	`¢d_pcm_hw_∑øm_£t_max
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
vÆ
, 
dú
);

5219 
	}
}

5233 
	$¢d_pcm_hw_∑øms_£t_≥riod_time_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
)

5235  
	`¢d_pcm_hw_∑øm_£t_mömax
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
mö
, 
mödú
, 
max
, 
maxdú
);

5236 
	}
}

5248 #i‚de‡
DOXYGEN


5249 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_time_√¨
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5251 
	$¢d_pcm_hw_∑øms_£t_≥riod_time_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5254  
	`¢d_pcm_hw_∑øm_£t_√¨
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
vÆ
, 
dú
);

5255 
	}
}

5267 #i‚de‡
DOXYGEN


5268 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_time_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5270 
	$¢d_pcm_hw_∑øms_£t_≥riod_time_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5273  
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
vÆ
, 
dú
);

5274 
	}
}

5284 #i‚de‡
DOXYGEN


5285 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_time_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5287 
	$¢d_pcm_hw_∑øms_£t_≥riod_time_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5290  
	`¢d_pcm_hw_∑øm_£t_œ°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
vÆ
, 
dú
);

5291 
	}
}

5303 #i‚de‡
DOXYGEN


5304 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_size
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
)

5306 
	$¢d_pcm_hw_∑øms_gë_≥riod_size
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
)

5309 
_vÆ
;

5310 
îr
 = 
	`¢d_pcm_hw_∑øm_gë
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_vÆ
, 
dú
);

5311 i‡(
îr
 >= 0)

5312 *
vÆ
 = 
_vÆ
;

5313  
îr
;

5314 
	}
}

5325 #i‚de‡
DOXYGEN


5326 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_size_mö
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
)

5328 
	$¢d_pcm_hw_∑øms_gë_≥riod_size_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
)

5331 
_vÆ
 = *
vÆ
;

5332 
îr
 = 
	`¢d_pcm_hw_∑øm_gë_mö
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_vÆ
, 
dú
);

5333 i‡(
îr
 >= 0)

5334 *
vÆ
 = 
_vÆ
;

5335  
îr
;

5336 
	}
}

5347 #i‚de‡
DOXYGEN


5348 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_size_max
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
)

5350 
	$¢d_pcm_hw_∑øms_gë_≥riod_size_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
)

5353 
_vÆ
 = *
vÆ
;

5354 
îr
 = 
	`¢d_pcm_hw_∑øm_gë_max
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_vÆ
, 
dú
);

5355 i‡(
îr
 >= 0)

5356 *
vÆ
 = 
_vÆ
;

5357  
îr
;

5358 
	}
}

5370 
	$¢d_pcm_hw_∑øms_ã°_≥riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
, 
dú
)

5372  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 
vÆ
, 
dú
);

5373 
	}
}

5385 
	$¢d_pcm_hw_∑øms_£t_≥riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
, 
dú
)

5387  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 
vÆ
, 
dú
);

5388 
	}
}

5400 
	$¢d_pcm_hw_∑øms_£t_≥riod_size_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
)

5402 
_vÆ
 = *
vÆ
;

5403 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_mö
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_vÆ
, 
dú
);

5404 i‡(
îr
 >= 0)

5405 *
vÆ
 = 
_vÆ
;

5406  
îr
;

5407 
	}
}

5419 
	$¢d_pcm_hw_∑øms_£t_≥riod_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
)

5421 
_vÆ
 = *
vÆ
;

5422 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_max
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_vÆ
, 
dú
);

5423 i‡(
îr
 >= 0)

5424 *
vÆ
 = 
_vÆ
;

5425  
îr
;

5426 
	}
}

5440 
	$¢d_pcm_hw_∑øms_£t_≥riod_size_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
mö
, *
mödú
, snd_pcm_u‰ames_à*
max
, *
maxdú
)

5442 
_mö
 = *
mö
;

5443 
_max
 = *
max
;

5444 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_mömax
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_mö
, 
mödú
, &
_max
, 
maxdú
);

5445 *
mö
 = 
_mö
;

5446 *
max
 = 
_max
;

5447  
îr
;

5448 
	}
}

5460 #i‚de‡
DOXYGEN


5461 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_size_√¨
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
)

5463 
	$¢d_pcm_hw_∑øms_£t_≥riod_size_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
)

5466 
_vÆ
 = *
vÆ
;

5467 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_√¨
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_vÆ
, 
dú
);

5468 i‡(
îr
 >= 0)

5469 *
vÆ
 = 
_vÆ
;

5470  
îr
;

5471 
	}
}

5483 #i‚de‡
DOXYGEN


5484 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_size_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
)

5486 
	$¢d_pcm_hw_∑øms_£t_≥riod_size_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
)

5489 
_vÆ
;

5490 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_vÆ
, 
dú
);

5491 i‡(
îr
 >= 0)

5492 *
vÆ
 = 
_vÆ
;

5493  
îr
;

5494 
	}
}

5506 #i‚de‡
DOXYGEN


5507 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_size_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
)

5509 
	$¢d_pcm_hw_∑øms_£t_≥riod_size_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
)

5512 
_vÆ
;

5513 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_œ°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, &
_vÆ
, 
dú
);

5514 i‡(
îr
 >= 0)

5515 *
vÆ
 = 
_vÆ
;

5516  
îr
;

5517 
	}
}

5525 
	$¢d_pcm_hw_∑øms_£t_≥riod_size_öãgî
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

5527  
	`¢d_pcm_hw_∑øm_£t_öãgî
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
);

5528 
	}
}

5540 #i‚de‡
DOXYGEN


5541 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riods
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5543 
	$¢d_pcm_hw_∑øms_gë_≥riods
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5546  
	`¢d_pcm_hw_∑øm_gë
(
∑øms
, 
SND_PCM_HW_PARAM_PERIODS
, 
vÆ
, 
dú
);

5547 
	}
}

5558 #i‚de‡
DOXYGEN


5559 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riods_mö
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5561 
	$¢d_pcm_hw_∑øms_gë_≥riods_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5564  
	`¢d_pcm_hw_∑øm_gë_mö
(
∑øms
, 
SND_PCM_HW_PARAM_PERIODS
, 
vÆ
, 
dú
);

5565 
	}
}

5576 #i‚de‡
DOXYGEN


5577 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riods_max
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5579 
	$¢d_pcm_hw_∑øms_gë_≥riods_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5582  
	`¢d_pcm_hw_∑øm_gë_max
(
∑øms
, 
SND_PCM_HW_PARAM_PERIODS
, 
vÆ
, 
dú
);

5583 
	}
}

5595 
	$¢d_pcm_hw_∑øms_ã°_≥riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
)

5597  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_PERIODS
, 
vÆ
, 
dú
);

5598 
	}
}

5610 
	$¢d_pcm_hw_∑øms_£t_≥riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
)

5612  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIODS
, 
vÆ
, 
dú
);

5613 
	}
}

5625 
	$¢d_pcm_hw_∑øms_£t_≥riods_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5627  
	`¢d_pcm_hw_∑øm_£t_mö
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIODS
, 
vÆ
, 
dú
);

5628 
	}
}

5640 
	$¢d_pcm_hw_∑øms_£t_≥riods_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5642  
	`¢d_pcm_hw_∑øm_£t_max
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIODS
, 
vÆ
, 
dú
);

5643 
	}
}

5657 
	$¢d_pcm_hw_∑øms_£t_≥riods_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
)

5659  
	`¢d_pcm_hw_∑øm_£t_mömax
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIODS
, 
mö
, 
mödú
, 
max
, 
maxdú
);

5660 
	}
}

5672 #i‚de‡
DOXYGEN


5673 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riods_√¨
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5675 
	$¢d_pcm_hw_∑øms_£t_≥riods_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5678  
	`¢d_pcm_hw_∑øm_£t_√¨
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_PERIODS
, 
vÆ
, 
dú
);

5679 
	}
}

5691 #i‚de‡
DOXYGEN


5692 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riods_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5694 
	$¢d_pcm_hw_∑øms_£t_≥riods_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5697  
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_PERIODS
, 
vÆ
, 
dú
);

5698 
	}
}

5710 #i‚de‡
DOXYGEN


5711 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riods_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5713 
	$¢d_pcm_hw_∑øms_£t_≥riods_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5716  
	`¢d_pcm_hw_∑øm_£t_œ°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_PERIODS
, 
vÆ
, 
dú
);

5717 
	}
}

5725 
	$¢d_pcm_hw_∑øms_£t_≥riods_öãgî
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

5727  
	`¢d_pcm_hw_∑øm_£t_öãgî
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_PERIODS
);

5728 
	}
}

5740 #i‚de‡
DOXYGEN


5741 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_time
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5743 
	$¢d_pcm_hw_∑øms_gë_buf„r_time
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5746  
	`¢d_pcm_hw_∑øm_gë
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
vÆ
, 
dú
);

5747 
	}
}

5758 #i‚de‡
DOXYGEN


5759 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_time_mö
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5761 
	$¢d_pcm_hw_∑øms_gë_buf„r_time_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5764  
	`¢d_pcm_hw_∑øm_gë_mö
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
vÆ
, 
dú
);

5765 
	}
}

5776 #i‚de‡
DOXYGEN


5777 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_time_max
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5779 
	$¢d_pcm_hw_∑øms_gë_buf„r_time_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5782  
	`¢d_pcm_hw_∑øm_gë_max
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
vÆ
, 
dú
);

5783 
	}
}

5795 
	$¢d_pcm_hw_∑øms_ã°_buf„r_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
)

5797  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
vÆ
, 
dú
);

5798 
	}
}

5810 
	$¢d_pcm_hw_∑øms_£t_buf„r_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
)

5812  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
vÆ
, 
dú
);

5813 
	}
}

5825 
	$¢d_pcm_hw_∑øms_£t_buf„r_time_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5827  
	`¢d_pcm_hw_∑øm_£t_mö
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
vÆ
, 
dú
);

5828 
	}
}

5840 
	$¢d_pcm_hw_∑øms_£t_buf„r_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5842  
	`¢d_pcm_hw_∑øm_£t_max
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
vÆ
, 
dú
);

5843 
	}
}

5857 
	$¢d_pcm_hw_∑øms_£t_buf„r_time_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
)

5859  
	`¢d_pcm_hw_∑øm_£t_mömax
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
mö
, 
mödú
, 
max
, 
maxdú
);

5860 
	}
}

5872 #i‚de‡
DOXYGEN


5873 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_time_√¨
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5875 
	$¢d_pcm_hw_∑øms_£t_buf„r_time_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5878  
	`¢d_pcm_hw_∑øm_£t_√¨
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
vÆ
, 
dú
);

5879 
	}
}

5891 #i‚de‡
DOXYGEN


5892 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_time_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5894 
	$¢d_pcm_hw_∑øms_£t_buf„r_time_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5897  
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
vÆ
, 
dú
);

5898 
	}
}

5910 #i‚de‡
DOXYGEN


5911 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_time_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5913 
	$¢d_pcm_hw_∑øms_£t_buf„r_time_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

5916  
	`¢d_pcm_hw_∑øm_£t_œ°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
, 
vÆ
, 
dú
);

5917 
	}
}

5926 #i‚de‡
DOXYGEN


5927 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_size
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

5929 
	$¢d_pcm_hw_∑øms_gë_buf„r_size
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

5932 
_vÆ
;

5933 
îr
 = 
	`¢d_pcm_hw_∑øm_gë
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_vÆ
, 
NULL
);

5934 i‡(
îr
 >= 0)

5935 *
vÆ
 = 
_vÆ
;

5936  
îr
;

5937 
	}
}

5945 #i‚de‡
DOXYGEN


5946 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_size_mö
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

5948 
	$¢d_pcm_hw_∑øms_gë_buf„r_size_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

5951 
_vÆ
;

5952 
îr
 = 
	`¢d_pcm_hw_∑øm_gë_mö
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_vÆ
, 
NULL
);

5953 i‡(
îr
 >= 0)

5954 *
vÆ
 = 
_vÆ
;

5955  
îr
;

5956 
	}
}

5966 #i‚de‡
DOXYGEN


5967 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_size_max
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

5969 
	$¢d_pcm_hw_∑øms_gë_buf„r_size_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

5972 
_vÆ
;

5973 
îr
 = 
	`¢d_pcm_hw_∑øm_gë_max
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_vÆ
, 
NULL
);

5974 i‡(
îr
 >= 0)

5975 *
vÆ
 = 
_vÆ
;

5976  
îr
;

5977 
	}
}

5988 
	$¢d_pcm_hw_∑øms_ã°_buf„r_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
)

5990  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TEST
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, 
vÆ
, 0);

5991 
	}
}

6002 
	$¢d_pcm_hw_∑øms_£t_buf„r_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
)

6004  
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, 
vÆ
, 0);

6005 
	}
}

6014 
	$¢d_pcm_hw_∑øms_£t_buf„r_size_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6016 
_vÆ
 = *
vÆ
;

6017 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_mö
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_vÆ
, 
NULL
);

6018 i‡(
îr
 >= 0)

6019 *
vÆ
 = 
_vÆ
;

6020  
îr
;

6021 
	}
}

6030 
	$¢d_pcm_hw_∑øms_£t_buf„r_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6032 
_vÆ
 = *
vÆ
;

6033 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_max
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_vÆ
, 
NULL
);

6034 i‡(
îr
 >= 0)

6035 *
vÆ
 = 
_vÆ
;

6036  
îr
;

6037 
	}
}

6047 
	$¢d_pcm_hw_∑øms_£t_buf„r_size_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
mö
, snd_pcm_u‰ames_à*
max
)

6049 
_mö
 = *
mö
;

6050 
_max
 = *
max
;

6051 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_mömax
(
pcm
, 
∑øms
, 
SND_TRY
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_mö
, 
NULL
, &
_max
, NULL);

6052 *
mö
 = 
_mö
;

6053 *
max
 = 
_max
;

6054  
îr
;

6055 
	}
}

6064 #i‚de‡
DOXYGEN


6065 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_size_√¨
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6067 
	$¢d_pcm_hw_∑øms_£t_buf„r_size_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6070 
_vÆ
 = *
vÆ
;

6071 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_√¨
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_vÆ
, 
NULL
);

6072 i‡(
îr
 >= 0)

6073 *
vÆ
 = 
_vÆ
;

6074  
îr
;

6075 
	}
}

6084 #i‚de‡
DOXYGEN


6085 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_size_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6087 
	$¢d_pcm_hw_∑øms_£t_buf„r_size_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6090 
_vÆ
;

6091 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_vÆ
, 
NULL
);

6092 i‡(
îr
 >= 0)

6093 *
vÆ
 = 
_vÆ
;

6094  
îr
;

6095 
	}
}

6104 #i‚de‡
DOXYGEN


6105 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_size_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6107 
	$¢d_pcm_hw_∑øms_£t_buf„r_size_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6110 
_vÆ
;

6111 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_œ°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
_vÆ
, 
NULL
);

6112 i‡(
îr
 >= 0)

6113 *
vÆ
 = 
_vÆ
;

6114  
îr
;

6115 
	}
}

6127 #i‚de‡
DOXYGEN


6128 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_tick_time
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
 
ATTRIBUTE_UNUSED
, *
vÆ
, *
dú
 ATTRIBUTE_UNUSED)

6130 
	$¢d_pcm_hw_∑øms_gë_tick_time
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

6133 *
vÆ
 = 0;

6135 
	}
}

6146 #i‚de‡
DOXYGEN


6147 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_tick_time_mö
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
 
ATTRIBUTE_UNUSED
, *
vÆ
, *
dú
 ATTRIBUTE_UNUSED)

6149 
	$¢d_pcm_hw_∑øms_gë_tick_time_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

6152 *
vÆ
 = 0;

6154 
	}
}

6165 #i‚de‡
DOXYGEN


6166 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_tick_time_max
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
 
ATTRIBUTE_UNUSED
, *
vÆ
, *
dú
 ATTRIBUTE_UNUSED)

6168 
	$¢d_pcm_hw_∑øms_gë_tick_time_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

6171 *
vÆ
 = 0;

6173 
	}
}

6185 
	$¢d_pcm_hw_∑øms_ã°_tick_time
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
 ATTRIBUTE_UNUSED, 
vÆ
, 
dú
 ATTRIBUTE_UNUSED)

6187  
vÆ
 ? -
EINVAL
 : 0;

6188 
	}
}

6200 
	$¢d_pcm_hw_∑øms_£t_tick_time
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
 ATTRIBUTE_UNUSED, 
vÆ
 ATTRIBUTE_UNUSED, 
dú
 ATTRIBUTE_UNUSED)

6203 
	}
}

6215 
	$¢d_pcm_hw_∑øms_£t_tick_time_mö
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
 ATTRIBUTE_UNUSED, *
vÆ
 ATTRIBUTE_UNUSED, *
dú
 ATTRIBUTE_UNUSED)

6218 
	}
}

6230 
	$¢d_pcm_hw_∑øms_£t_tick_time_max
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
 ATTRIBUTE_UNUSED, *
vÆ
 ATTRIBUTE_UNUSED, *
dú
 ATTRIBUTE_UNUSED)

6233 
	}
}

6247 
	$¢d_pcm_hw_∑øms_£t_tick_time_mömax
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
 ATTRIBUTE_UNUSED, *
mö
 ATTRIBUTE_UNUSED, *
mödú
 ATTRIBUTE_UNUSED, *
max
 ATTRIBUTE_UNUSED, *
maxdú
 ATTRIBUTE_UNUSED)

6250 
	}
}

6262 #i‚de‡
DOXYGEN


6263 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_tick_time_√¨
)(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
 ATTRIBUTE_UNUSED, *
vÆ
 ATTRIBUTE_UNUSED, *
dú
 ATTRIBUTE_UNUSED)

6265 
	$¢d_pcm_hw_∑øms_£t_tick_time_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

6269 
	}
}

6281 #i‚de‡
DOXYGEN


6282 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_tick_time_fú°
)(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
 ATTRIBUTE_UNUSED, *
vÆ
 ATTRIBUTE_UNUSED, *
dú
 ATTRIBUTE_UNUSED)

6284 
	$¢d_pcm_hw_∑øms_£t_tick_time_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

6288 
	}
}

6300 #i‚de‡
DOXYGEN


6301 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_tick_time_œ°
)(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
 ATTRIBUTE_UNUSED, *
vÆ
 ATTRIBUTE_UNUSED, *
dú
 ATTRIBUTE_UNUSED)

6303 
	$¢d_pcm_hw_∑øms_£t_tick_time_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
)

6307 
	}
}

6315 
	$¢d_pcm_hw_∑øms_gë_mö_Æign
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6317 
f‹m©
, 
ch™√ls
, 
fb
, 
mö_Æign
;

6318 
îr
;

6320 
îr
 = 
	`¢d_pcm_hw_∑øm_gë
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
, &
f‹m©
, 
NULL
);

6321 i‡(
îr
 < 0)

6322  
îr
;

6323 
îr
 = 
	`¢d_pcm_hw_∑øm_gë
(
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
, &
ch™√ls
, 
NULL
);

6324 i‡(
îr
 < 0)

6325  
îr
;

6327 
fb
 = 
	`¢d_pcm_f‹m©_physiˇl_width
((
¢d_pcm_f‹m©_t
)
f‹m©
Ë* 
ch™√ls
;

6328 
mö_Æign
 = 1;

6329 
fb
 % 8) {

6330 
fb
 *= 2;

6331 
mö_Æign
 *= 2;

6333 i‡(
vÆ
)

6334 *
vÆ
 = 
mö_Æign
;

6336 
	}
}

6338 #i‚de‡
DOXYGEN


6339 
	$¢d_pcm_sw_∑øms_cuºít_no_lock
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
)

6341 
∑øms
->
¥Ÿo
 = 
SNDRV_PCM_VERSION
;

6342 
∑øms
->
t°amp_mode
 = 
pcm
->tstamp_mode;

6343 
∑øms
->
t°amp_ty≥
 = 
pcm
->tstamp_type;

6344 
∑øms
->
≥riod_°ï
 = 
pcm
->period_step;

6345 
∑øms
->
¶ìp_mö
 = 0;

6346 
∑øms
->
avaû_mö
 = 
pcm
->avail_min;

6347 
	`sw_£t_≥riod_evít
(
∑øms
, 
pcm
->
≥riod_evít
);

6348 
∑øms
->
x„r_Æign
 = 1;

6349 
∑øms
->
°¨t_thªshﬁd
 = 
pcm
->start_threshold;

6350 
∑øms
->
°›_thªshﬁd
 = 
pcm
->stop_threshold;

6351 
∑øms
->
sûí˚_thªshﬁd
 = 
pcm
->silence_threshold;

6352 
∑øms
->
sûí˚_size
 = 
pcm
->silence_size;

6353 
∑øms
->
bound¨y
 = 
pcm
->boundary;

6354 
	}
}

6365 
	$¢d_pcm_sw_∑øms_cuºít
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
)

6367 
	`as£π
(
pcm
 && 
∑øms
);

6368 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

6369 
	`SNDMSG
("PCMÇot set up");

6370  -
EIO
;

6372 
	`__¢d_pcm_lock
(
pcm
);

6373 
	`¢d_pcm_sw_∑øms_cuºít_no_lock
(
pcm
, 
∑øms
);

6374 
	`__¢d_pcm_u∆ock
(
pcm
);

6376 
	}
}

6384 
	$¢d_pcm_sw_∑øms_dump
(
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_ouçut_t
 *
out
)

6386 
	`¢d_ouçut_¥ötf
(
out
, "t°amp_mode: %s\n", 
	`¢d_pcm_t°amp_mode_«me
(
∑øms
->
t°amp_mode
));

6387 
	`¢d_ouçut_¥ötf
(
out
, "t°amp_ty≥: %s\n", 
	`¢d_pcm_t°amp_ty≥_«me
(
∑øms
->
t°amp_ty≥
));

6388 
	`¢d_ouçut_¥ötf
(
out
, "≥riod_°ï: %u\n", 
∑øms
->
≥riod_°ï
);

6389 
	`¢d_ouçut_¥ötf
(
out
, "avaû_mö: %lu\n", 
∑øms
->
avaû_mö
);

6390 
	`¢d_ouçut_¥ötf
(
out
, "°¨t_thªshﬁd: %ld\n", 
∑øms
->
°¨t_thªshﬁd
);

6391 
	`¢d_ouçut_¥ötf
(
out
, "°›_thªshﬁd: %ld\n", 
∑øms
->
°›_thªshﬁd
);

6392 
	`¢d_ouçut_¥ötf
(
out
, "sûí˚_thªshﬁd: %lu\n", 
∑øms
->
sûí˚_thªshﬁd
);

6393 
	`¢d_ouçut_¥ötf
(
out
, "sûí˚_size: %lu\n", 
∑øms
->
sûí˚_size
);

6394 
	`¢d_ouçut_¥ötf
(
out
, "bound¨y: %lu\n", 
∑øms
->
bound¨y
);

6396 
	}
}

6402 
size_t
 
	$¢d_pcm_sw_∑øms_sizeof
()

6404  (
¢d_pcm_sw_∑øms_t
);

6405 
	}
}

6412 
	$¢d_pcm_sw_∑øms_mÆloc
(
¢d_pcm_sw_∑øms_t
 **
±r
)

6414 
	`as£π
(
±r
);

6415 *
±r
 = 
	`ˇŒoc
(1, (
¢d_pcm_sw_∑øms_t
));

6416 i‡(!*
±r
)

6417  -
ENOMEM
;

6419 
	}
}

6425 
	$¢d_pcm_sw_∑øms_‰ì
(
¢d_pcm_sw_∑øms_t
 *
obj
)

6427 
	`‰ì
(
obj
);

6428 
	}
}

6435 
	$¢d_pcm_sw_∑øms_c›y
(
¢d_pcm_sw_∑øms_t
 *
d°
, c⁄° snd_pcm_sw_∑øms_à*
§c
)

6437 
	`as£π
(
d°
 && 
§c
);

6438 *
d°
 = *
§c
;

6439 
	}
}

6447 
	$¢d_pcm_sw_∑øms_gë_bound¨y
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6449 
	`as£π
(
∑øms
);

6450 *
vÆ
 = 
∑øms
->
bound¨y
;

6452 
	}
}

6461 
	$¢d_pcm_sw_∑øms_£t_°¨t_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_°¨t_t
 
vÆ
)

6463 
	`as£π
(
pcm
 && 
∑øms
);

6464 
vÆ
) {

6465 
SND_PCM_START_DATA
:

6466 
∑øms
->
°¨t_thªshﬁd
 = 1;

6468 
SND_PCM_START_EXPLICIT
:

6469 
∑øms
->
°¨t_thªshﬁd
 = 
pcm
->
bound¨y
;

6472 
	`SNDMSG
("övÆid sèπ modêvÆuê%d", 
vÆ
);

6473  -
EINVAL
;

6476 
	}
}

6478 #i‚de‡
DOC_HIDDEN


6479 
lök_w¨nög
(
¢d_pcm_sw_∑øms_£t_°¨t_mode
, "Warning: start_mode is deprecated, considerÅo use start_threshold");

6487 
¢d_pcm_°¨t_t
 
	$¢d_pcm_sw_∑øms_gë_°¨t_mode
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
)

6489 
	`as£π
(
∑øms
);

6491  
∑øms
->
°¨t_thªshﬁd
 > 1024 * 1024 ? 
SND_PCM_START_EXPLICIT
 : 
SND_PCM_START_DATA
;

6492 
	}
}

6494 #i‚de‡
DOC_HIDDEN


6495 
lök_w¨nög
(
¢d_pcm_sw_∑øms_gë_°¨t_mode
, "Warning: start_mode is deprecated, considerÅo use start_threshold");

6505 #i‚de‡
DOXYGEN


6506 
	$¢d_pcm_sw_∑øms_£t_xrun_mode
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_xrun_t
 
vÆ
)

6508 
	$¢d_pcm_sw_∑øms_£t_xrun_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_xrun_t
 
vÆ
)

6511 
	`as£π
(
pcm
 && 
∑øms
);

6512 
vÆ
) {

6513 
SND_PCM_XRUN_STOP
:

6514 
∑øms
->
°›_thªshﬁd
 = 
pcm
->
buf„r_size
;

6516 
SND_PCM_XRUN_NONE
:

6517 
∑øms
->
°›_thªshﬁd
 = 
pcm
->
bound¨y
;

6520 
	`SNDMSG
("övÆid xru¿modêvÆuê%d", 
vÆ
);

6521  -
EINVAL
;

6524 
	}
}

6526 #i‚de‡
DOC_HIDDEN


6527 
lök_w¨nög
(
¢d_pcm_sw_∑øms_£t_xrun_mode
, "Warning: xrun_mode is deprecated, considerÅo use stop_threshold");

6535 
¢d_pcm_xrun_t
 
	$¢d_pcm_sw_∑øms_gë_xrun_mode
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
)

6537 
	`as£π
(
∑øms
);

6539  
∑øms
->
°›_thªshﬁd
 > 1024 * 1024 ? 
SND_PCM_XRUN_NONE
 : 
SND_PCM_XRUN_STOP
;

6540 
	}
}

6542 #i‚de‡
DOC_HIDDEN


6543 
lök_w¨nög
(
¢d_pcm_sw_∑øms_gë_xrun_mode
, "Warning: xrun_mode is deprecated, considerÅo use stop_threshold");

6553 #i‚de‡
DOXYGEN


6554 
	$¢d_pcm_sw_∑øms_£t_t°amp_mode
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_t°amp_t
 
vÆ
)

6556 
	$¢d_pcm_sw_∑øms_£t_t°amp_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_t°amp_t
 
vÆ
)

6559 
	`as£π
(
pcm
 && 
∑øms
);

6560 i‡(
	`CHECK_SANITY
(
vÆ
 > 
SND_PCM_TSTAMP_LAST
)) {

6561 
	`SNDMSG
("övÆidÅ°amp_modêvÆuê%d", 
vÆ
);

6562  -
EINVAL
;

6564 
∑øms
->
t°amp_mode
 = 
vÆ
;

6566 
	}
}

6574 #i‚de‡
DOXYGEN


6575 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_∑øms_gë_t°amp_mode
)(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_t°amp_t
 *
vÆ
)

6577 
	$¢d_pcm_sw_∑øms_gë_t°amp_mode
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_t°amp_t
 *
vÆ
)

6580 
	`as£π
(
∑øms
 && 
vÆ
);

6581 *
vÆ
 = 
∑øms
->
t°amp_mode
;

6583 
	}
}

6592 
	$¢d_pcm_sw_∑øms_£t_t°amp_ty≥
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_t°amp_ty≥_t
 
vÆ
)

6594 
	`as£π
(
pcm
 && 
∑øms
);

6595 i‡(
	`CHECK_SANITY
(
vÆ
 > 
SND_PCM_TSTAMP_TYPE_LAST
)) {

6596 
	`SNDMSG
("övÆidÅ°amp_ty≥ vÆuê%d", 
vÆ
);

6597  -
EINVAL
;

6599 
∑øms
->
t°amp_ty≥
 = 
vÆ
;

6601 
	}
}

6609 
	$¢d_pcm_sw_∑øms_gë_t°amp_ty≥
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_t°amp_ty≥_t
 *
vÆ
)

6611 
	`as£π
(
∑øms
 && 
vÆ
);

6612 *
vÆ
 = 
∑øms
->
t°amp_ty≥
;

6614 
	}
}

6623 #i‚de‡
DOXYGEN


6624 
	$¢d_pcm_sw_∑øms_£t_¶ìp_mö
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
 ATTRIBUTE_UNUSED, 
vÆ
 ATTRIBUTE_UNUSED)

6626 
	$¢d_pcm_sw_∑øms_£t_¶ìp_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
vÆ
)

6630 
	}
}

6638 #i‚de‡
DOXYGEN


6639 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_∑øms_gë_¶ìp_mö
)(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
 
ATTRIBUTE_UNUSED
, *
vÆ
)

6641 
	$¢d_pcm_sw_∑øms_gë_¶ìp_mö
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, *
vÆ
)

6644 *
vÆ
 = 0;

6646 
	}
}

6662 #i‚de‡
DOXYGEN


6663 
EXPORT_SYMBOL
 
	$¢d_pcm_sw_∑øms_£t_avaû_mö
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
)

6665 
	$¢d_pcm_sw_∑øms_£t_avaû_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
)

6668 
	`as£π
(
pcm
 && 
∑øms
);

6673 i‡(
vÆ
 < 
pcm
->
≥riod_size
)

6674 
vÆ
 = 
pcm
->
≥riod_size
;

6675 
∑øms
->
avaû_mö
 = 
vÆ
;

6677 
	}
}

6688 #i‚de‡
DOXYGEN


6689 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_∑øms_gë_avaû_mö
)(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6691 
	$¢d_pcm_sw_∑øms_gë_avaû_mö
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6694 
	`as£π
(
∑øms
 && 
vÆ
);

6695 *
vÆ
 = 
∑øms
->
avaû_mö
;

6697 
	}
}

6708 
	$¢d_pcm_sw_∑øms_£t_≥riod_evít
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
vÆ
)

6710 
	`as£π
(
pcm
 && 
∑øms
);

6711 
	`sw_£t_≥riod_evít
(
∑øms
, 
vÆ
);

6713 
	}
}

6721 
	$¢d_pcm_sw_∑øms_gë_≥riod_evít
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, *
vÆ
)

6723 
	`as£π
(
∑øms
 && 
vÆ
);

6724 *
vÆ
 = 
	`sw_gë_≥riod_evít
(
∑øms
);

6726 
	}
}

6735 #i‚de‡
DOXYGEN


6736 
EXPORT_SYMBOL
 
	$¢d_pcm_sw_∑øms_£t_x„r_Æign
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
 ATTRIBUTE_UNUSED, 
¢d_pcm_u‰ames_t
 
vÆ
 ATTRIBUTE_UNUSED)

6738 
	$¢d_pcm_sw_∑øms_£t_x„r_Æign
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
)

6742 
	}
}

6750 #i‚de‡
DOXYGEN


6751 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_∑øms_gë_x„r_Æign
)(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6753 
	$¢d_pcm_sw_∑øms_gë_x„r_Æign
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6756 *
vÆ
 = 1;

6758 
	}
}

6770 #i‚de‡
DOXYGEN


6771 
EXPORT_SYMBOL
 
	$¢d_pcm_sw_∑øms_£t_°¨t_thªshﬁd
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
)

6773 
	$¢d_pcm_sw_∑øms_£t_°¨t_thªshﬁd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
)

6776 
	`as£π
(
pcm
 && 
∑øms
);

6777 
∑øms
->
°¨t_thªshﬁd
 = 
vÆ
;

6779 
	}
}

6790 #i‚de‡
DOXYGEN


6791 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_∑øms_gë_°¨t_thªshﬁd
)(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6793 
	$¢d_pcm_sw_∑øms_gë_°¨t_thªshﬁd
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6796 
	`as£π
(
∑øms
);

6797 *
vÆ
 = 
∑øms
->
°¨t_thªshﬁd
;

6799 
	}
}

6814 #i‚de‡
DOXYGEN


6815 
EXPORT_SYMBOL
 
	$¢d_pcm_sw_∑øms_£t_°›_thªshﬁd
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
)

6817 
	$¢d_pcm_sw_∑øms_£t_°›_thªshﬁd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
)

6820 
	`as£π
(
pcm
 && 
∑øms
);

6821 
∑øms
->
°›_thªshﬁd
 = 
vÆ
;

6823 
	}
}

6836 #i‚de‡
DOXYGEN


6837 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_∑øms_gë_°›_thªshﬁd
)(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6839 
	$¢d_pcm_sw_∑øms_gë_°›_thªshﬁd
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6842 
	`as£π
(
∑øms
);

6843 *
vÆ
 = 
∑øms
->
°›_thªshﬁd
;

6845 
	}
}

6859 #i‚de‡
DOXYGEN


6860 
EXPORT_SYMBOL
 
	$¢d_pcm_sw_∑øms_£t_sûí˚_thªshﬁd
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
)

6862 
	$¢d_pcm_sw_∑øms_£t_sûí˚_thªshﬁd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
)

6865 
	`as£π
(
pcm
 && 
∑øms
);

6866 i‡(
	`CHECK_SANITY
(
vÆ
 >
pcm
->
buf„r_size
)) {

6867 
	`SNDMSG
("invalid silent_threshold value %ld (buffer_size = %ld)",

6868 
vÆ
, 
pcm
->
buf„r_size
);

6869  -
EINVAL
;

6871 
∑øms
->
sûí˚_thªshﬁd
 = 
vÆ
;

6873 
	}
}

6885 #i‚de‡
DOXYGEN


6886 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_∑øms_gë_sûí˚_thªshﬁd
)(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6888 
	$¢d_pcm_sw_∑øms_gë_sûí˚_thªshﬁd
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6891 
	`as£π
(
∑øms
 && 
vÆ
);

6892 *
vÆ
 = 
∑øms
->
sûí˚_thªshﬁd
;

6894 
	}
}

6917 #i‚de‡
DOXYGEN


6918 
EXPORT_SYMBOL
 
	$¢d_pcm_sw_∑øms_£t_sûí˚_size
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
)

6920 
	$¢d_pcm_sw_∑øms_£t_sûí˚_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
)

6923 
	`as£π
(
pcm
 && 
∑øms
);

6924 i‡(
	`CHECK_SANITY
(
vÆ
 < 
pcm
->
bound¨y
 && vÆ >Öcm->
buf„r_size
)) {

6925 
	`SNDMSG
("invalid silence_size %ld (boundary %ld, buffer_size %ld)",

6926 
vÆ
, 
pcm
->
bound¨y
,Öcm->
buf„r_size
);

6927  -
EINVAL
;

6929 
∑øms
->
sûí˚_size
 = 
vÆ
;

6931 
	}
}

6943 #i‚de‡
DOXYGEN


6944 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_sw_∑øms_gë_sûí˚_size
)(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6946 
	$¢d_pcm_sw_∑øms_gë_sûí˚_size
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

6949 
	`as£π
(
∑øms
);

6950 *
vÆ
 = 
∑øms
->
sûí˚_size
;

6952 
	}
}

6959 
size_t
 
	$¢d_pcm_°©us_sizeof
()

6961  (
¢d_pcm_°©us_t
);

6962 
	}
}

6969 
	$¢d_pcm_°©us_mÆloc
(
¢d_pcm_°©us_t
 **
±r
)

6971 
	`as£π
(
±r
);

6972 *
±r
 = 
	`ˇŒoc
(1, (
¢d_pcm_°©us_t
));

6973 i‡(!*
±r
)

6974  -
ENOMEM
;

6976 
	}
}

6982 
	$¢d_pcm_°©us_‰ì
(
¢d_pcm_°©us_t
 *
obj
)

6984 
	`‰ì
(
obj
);

6985 
	}
}

6992 
	$¢d_pcm_°©us_c›y
(
¢d_pcm_°©us_t
 *
d°
, c⁄° snd_pcm_°©us_à*
§c
)

6994 
	`as£π
(
d°
 && 
§c
);

6995 *
d°
 = *
§c
;

6996 
	}
}

7003 
¢d_pcm_°©e_t
 
	$¢d_pcm_°©us_gë_°©e
(c⁄° 
¢d_pcm_°©us_t
 *
obj
)

7005 
	`as£π
(
obj
);

7006  
obj
->
°©e
;

7007 
	}
}

7018 
	$¢d_pcm_°©us_gë_åiggî_t°amp
(c⁄° 
¢d_pcm_°©us_t
 *
obj
, 
¢d_time°amp_t
 *
±r
)

7020 
	`as£π
(
obj
 && 
±r
);

7021 
±r
->
tv_£c
 = 
obj
->
åiggî_t°amp
.tv_sec;

7022 
±r
->
tv_u£c
 = 
obj
->
åiggî_t°amp
.
tv_n£c
 / 1000L;

7023 
	}
}

7034 #i‚de‡
DOXYGEN


7035 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_°©us_gë_åiggî_ht°amp
)(c⁄° 
¢d_pcm_°©us_t
 *
obj
, 
¢d_htime°amp_t
 *
±r
)

7037 
	$¢d_pcm_°©us_gë_åiggî_ht°amp
(c⁄° 
¢d_pcm_°©us_t
 *
obj
, 
¢d_htime°amp_t
 *
±r
)

7040 
	`as£π
(
obj
 && 
±r
);

7041 *
±r
 = 
obj
->
åiggî_t°amp
;

7042 
	}
}

7043 
u£_deÁu…_symbﬁ_vîsi⁄
(
__¢d_pcm_°©us_gë_åiggî_ht°amp
, 
¢d_pcm_°©us_gë_åiggî_ht°amp
, 
ALSA_0
.9.0
rc8
);

7050 
	$¢d_pcm_°©us_gë_t°amp
(c⁄° 
¢d_pcm_°©us_t
 *
obj
, 
¢d_time°amp_t
 *
±r
)

7052 
	`as£π
(
obj
 && 
±r
);

7053 
±r
->
tv_£c
 = 
obj
->
t°amp
.tv_sec;

7054 
±r
->
tv_u£c
 = 
obj
->
t°amp
.
tv_n£c
 / 1000L;

7055 
	}
}

7062 #i‚de‡
DOXYGEN


7063 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_pcm_°©us_gë_ht°amp
)(c⁄° 
¢d_pcm_°©us_t
 *
obj
, 
¢d_htime°amp_t
 *
±r
)

7065 
	$¢d_pcm_°©us_gë_ht°amp
(c⁄° 
¢d_pcm_°©us_t
 *
obj
, 
¢d_htime°amp_t
 *
±r
)

7068 
	`as£π
(
obj
 && 
±r
);

7069 *
±r
 = 
obj
->
t°amp
;

7070 
	}
}

7071 
u£_deÁu…_symbﬁ_vîsi⁄
(
__¢d_pcm_°©us_gë_ht°amp
, 
¢d_pcm_°©us_gë_ht°amp
, 
ALSA_0
.9.0
rc8
);

7078 
	$¢d_pcm_°©us_gë_audio_ht°amp
(c⁄° 
¢d_pcm_°©us_t
 *
obj
, 
¢d_htime°amp_t
 *
±r
)

7080 
	`as£π
(
obj
 && 
±r
);

7081 *
±r
 = 
obj
->
audio_t°amp
;

7082 
	}
}

7090 
	$¢d_pcm_°©us_gë_drivî_ht°amp
(c⁄° 
¢d_pcm_°©us_t
 *
obj
, 
¢d_htime°amp_t
 *
±r
)

7092 
	`as£π
(
obj
 && 
±r
);

7093 *
±r
 = 
obj
->
drivî_t°amp
;

7094 
	}
}

7101 
	$¢d_pcm_°©us_gë_audio_ht°amp_ªp‹t
(c⁄° 
¢d_pcm_°©us_t
 *
obj
,

7102 
¢d_pcm_audio_t°amp_ªp‹t_t
 *
audio_t°amp_ªp‹t
)

7104 
	`as£π
(
obj
 && 
audio_t°amp_ªp‹t
);

7105 
	`¢d_pcm_u≈ack_audio_t°amp_ªp‹t
(
obj
->
audio_t°amp_d©a
,

7106 
obj
->
audio_t°amp_accuøcy
,

7107 
audio_t°amp_ªp‹t
);

7108 
	}
}

7115 
	$¢d_pcm_°©us_£t_audio_ht°amp_c⁄fig
(
¢d_pcm_°©us_t
 *
obj
,

7116 
¢d_pcm_audio_t°amp_c⁄fig_t
 *
audio_t°amp_c⁄fig
)

7118 
	`as£π
(
obj
 && 
audio_t°amp_c⁄fig
);

7119 
	`¢d_pcm_∑ck_audio_t°amp_c⁄fig
(&
obj
->
audio_t°amp_d©a
, 
audio_t°amp_c⁄fig
);

7120 
	}
}

7132 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_°©us_gë_dñay
(c⁄° 
¢d_pcm_°©us_t
 *
obj
)

7134 
	`as£π
(
obj
);

7135  
obj
->
dñay
;

7136 
	}
}

7142 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_°©us_gë_avaû
(c⁄° 
¢d_pcm_°©us_t
 *
obj
)

7144 
	`as£π
(
obj
);

7145  
obj
->
avaû
;

7146 
	}
}

7154 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_°©us_gë_avaû_max
(c⁄° 
¢d_pcm_°©us_t
 *
obj
)

7156 
	`as£π
(
obj
);

7157  
obj
->
avaû_max
;

7158 
	}
}

7164 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_°©us_gë_ovîønge
(c⁄° 
¢d_pcm_°©us_t
 *
obj
)

7166 
	`as£π
(
obj
);

7167  
obj
->
ovîønge
;

7168 
	}
}

7174 
size_t
 
	$¢d_pcm_öfo_sizeof
()

7176  (
¢d_pcm_öfo_t
);

7177 
	}
}

7184 
	$¢d_pcm_öfo_mÆloc
(
¢d_pcm_öfo_t
 **
±r
)

7186 
	`as£π
(
±r
);

7187 *
±r
 = 
	`ˇŒoc
(1, (
¢d_pcm_öfo_t
));

7188 i‡(!*
±r
)

7189  -
ENOMEM
;

7191 
	}
}

7197 
	$¢d_pcm_öfo_‰ì
(
¢d_pcm_öfo_t
 *
obj
)

7199 
	`‰ì
(
obj
);

7200 
	}
}

7207 
	$¢d_pcm_öfo_c›y
(
¢d_pcm_öfo_t
 *
d°
, c⁄° snd_pcm_öfo_à*
§c
)

7209 
	`as£π
(
d°
 && 
§c
);

7210 *
d°
 = *
§c
;

7211 
	}
}

7218 
	$¢d_pcm_öfo_gë_devi˚
(c⁄° 
¢d_pcm_öfo_t
 *
obj
)

7220 
	`as£π
(
obj
);

7221  
obj
->
devi˚
;

7222 
	}
}

7229 
	$¢d_pcm_öfo_gë_subdevi˚
(c⁄° 
¢d_pcm_öfo_t
 *
obj
)

7231 
	`as£π
(
obj
);

7232  
obj
->
subdevi˚
;

7233 
	}
}

7240 
¢d_pcm_°ªam_t
 
	$¢d_pcm_öfo_gë_°ªam
(c⁄° 
¢d_pcm_öfo_t
 *
obj
)

7242 
	`as£π
(
obj
);

7243  
obj
->
°ªam
;

7244 
	}
}

7251 
	$¢d_pcm_öfo_gë_ˇrd
(c⁄° 
¢d_pcm_öfo_t
 *
obj
)

7253 
	`as£π
(
obj
);

7254  
obj
->
ˇrd
;

7255 
	}
}

7262 c⁄° *
	$¢d_pcm_öfo_gë_id
(c⁄° 
¢d_pcm_öfo_t
 *
obj
)

7264 
	`as£π
(
obj
);

7265  (c⁄° *)
obj
->
id
;

7266 
	}
}

7273 c⁄° *
	$¢d_pcm_öfo_gë_«me
(c⁄° 
¢d_pcm_öfo_t
 *
obj
)

7275 
	`as£π
(
obj
);

7276  (c⁄° *)
obj
->
«me
;

7277 
	}
}

7284 c⁄° *
	$¢d_pcm_öfo_gë_subdevi˚_«me
(c⁄° 
¢d_pcm_öfo_t
 *
obj
)

7286 
	`as£π
(
obj
);

7287  (c⁄° *)
obj
->
sub«me
;

7288 
	}
}

7295 
¢d_pcm_˛ass_t
 
	$¢d_pcm_öfo_gë_˛ass
(c⁄° 
¢d_pcm_öfo_t
 *
obj
)

7297 
	`as£π
(
obj
);

7298  
obj
->
dev_˛ass
;

7299 
	}
}

7306 
¢d_pcm_sub˛ass_t
 
	$¢d_pcm_öfo_gë_sub˛ass
(c⁄° 
¢d_pcm_öfo_t
 *
obj
)

7308 
	`as£π
(
obj
);

7309  
obj
->
dev_sub˛ass
;

7310 
	}
}

7317 
	$¢d_pcm_öfo_gë_subdevi˚s_cou¡
(c⁄° 
¢d_pcm_öfo_t
 *
obj
)

7319 
	`as£π
(
obj
);

7320  
obj
->
subdevi˚s_cou¡
;

7321 
	}
}

7328 
	$¢d_pcm_öfo_gë_subdevi˚s_avaû
(c⁄° 
¢d_pcm_öfo_t
 *
obj
)

7330 
	`as£π
(
obj
);

7331  
obj
->
subdevi˚s_avaû
;

7332 
	}
}

7339 
¢d_pcm_sync_id_t
 
	$¢d_pcm_öfo_gë_sync
(c⁄° 
¢d_pcm_öfo_t
 *
obj
)

7341 
¢d_pcm_sync_id_t
 
ªs
;

7342 
	`as£π
(
obj
);

7343 
	`mem˝y
(&
ªs
, &
obj
->
sync
, (res));

7344  
ªs
;

7345 
	}
}

7352 
	$¢d_pcm_öfo_£t_devi˚
(
¢d_pcm_öfo_t
 *
obj
, 
vÆ
)

7354 
	`as£π
(
obj
);

7355 
obj
->
devi˚
 = 
vÆ
;

7356 
	}
}

7363 
	$¢d_pcm_öfo_£t_subdevi˚
(
¢d_pcm_öfo_t
 *
obj
, 
vÆ
)

7365 
	`as£π
(
obj
);

7366 
obj
->
subdevi˚
 = 
vÆ
;

7367 
	}
}

7374 
	$¢d_pcm_öfo_£t_°ªam
(
¢d_pcm_öfo_t
 *
obj
, 
¢d_pcm_°ªam_t
 
vÆ
)

7376 
	`as£π
(
obj
);

7377 
obj
->
°ªam
 = 
vÆ
;

7378 
	}
}

7400 
	$¢d_pcm_mm≠_begö
(
¢d_pcm_t
 *
pcm
,

7401 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 **
¨ós
,

7402 
¢d_pcm_u‰ames_t
 *
off£t
,

7403 
¢d_pcm_u‰ames_t
 *
‰ames
)

7405 
îr
;

7407 
îr
 = 
	`bad_pcm_°©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

7408 i‡(
îr
 < 0)

7409  
îr
;

7410 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

7411 
îr
 = 
	`__¢d_pcm_mm≠_begö
(
pcm
, 
¨ós
, 
off£t
, 
‰ames
);

7412 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

7413  
îr
;

7414 
	}
}

7416 #i‚de‡
DOC_HIDDEN


7417 
	$__¢d_pcm_mm≠_begö_gíîic
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_ch™√l_¨ó_t
 **
¨ós
,

7418 
¢d_pcm_u‰ames_t
 *
off£t
, snd_pcm_u‰ames_à*
‰ames
)

7420 
¢d_pcm_u‰ames_t
 
c⁄t
;

7421 
¢d_pcm_u‰ames_t
 
f
;

7422 
¢d_pcm_u‰ames_t
 
avaû
;

7423 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
x¨ós
;

7425 
	`as£π
(
pcm
 && 
¨ós
 && 
off£t
 && 
‰ames
);

7428 
x¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

7429 i‡(
x¨ós
 =
NULL
)

7430  -
EBADFD
;

7431 *
¨ós
 = 
x¨ós
;

7432 *
off£t
 = *
pcm
->
≠∂
.
±r
 %Öcm->
buf„r_size
;

7433 
avaû
 = 
	`¢d_pcm_mm≠_avaû
(
pcm
);

7434 i‡(
avaû
 > 
pcm
->
buf„r_size
)

7435 
avaû
 = 
pcm
->
buf„r_size
;

7436 
c⁄t
 = 
pcm
->
buf„r_size
 - *
off£t
;

7437 
f
 = *
‰ames
;

7438 i‡(
f
 > 
avaû
)

7439 
f
 = 
avaû
;

7440 i‡(
f
 > 
c⁄t
)

7441 
f
 = 
c⁄t
;

7442 *
‰ames
 = 
f
;

7444 
	}
}

7447 
	$__¢d_pcm_mm≠_begö
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_ch™√l_¨ó_t
 **
¨ós
,

7448 
¢d_pcm_u‰ames_t
 *
off£t
, snd_pcm_u‰ames_à*
‰ames
)

7450 
	`as£π
(
pcm
 && 
¨ós
 && 
off£t
 && 
‰ames
);

7452 i‡(
pcm
->
Á°_›s
->
mm≠_begö
)

7453  
pcm
->
Á°_›s
->
	`mm≠_begö
’cm->
Á°_›_¨g
, 
¨ós
, 
off£t
, 
‰ames
);

7455  
	`__¢d_pcm_mm≠_begö_gíîic
(
pcm
, 
¨ós
, 
off£t
, 
‰ames
);

7456 
	}
}

7513 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

7514 
¢d_pcm_u‰ames_t
 
off£t
,

7515 
¢d_pcm_u‰ames_t
 
‰ames
)

7517 
¢d_pcm_s‰ames_t
 
ªsu…
;

7518 
îr
;

7520 
îr
 = 
	`bad_pcm_°©e
(
pcm
, 
P_STATE_RUNNABLE
, 0);

7521 i‡(
îr
 < 0)

7522  
îr
;

7523 
	`¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

7524 
ªsu…
 = 
	`__¢d_pcm_mm≠_commô
(
pcm
, 
off£t
, 
‰ames
);

7525 
	`¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

7526  
ªsu…
;

7527 
	}
}

7529 #i‚de‡
DOC_HIDDEN


7531 
¢d_pcm_s‰ames_t
 
	$__¢d_pcm_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

7532 
¢d_pcm_u‰ames_t
 
off£t
,

7533 
¢d_pcm_u‰ames_t
 
‰ames
)

7535 
	`as£π
(
pcm
);

7536 i‡(
	`CHECK_SANITY
(
off£t
 !*
pcm
->
≠∂
.
±r
 %Öcm->
buf„r_size
)) {

7537 
	`SNDMSG
("commit offset (%ld) doesn't match witháppl_ptr (%ld) %% buf_size (%ld)",

7538 
off£t
, *
pcm
->
≠∂
.
±r
,Öcm->
buf„r_size
);

7539  -
EPIPE
;

7541 i‡(
	`CHECK_SANITY
(
‰ames
 > 
	`¢d_pcm_mm≠_avaû
(
pcm
))) {

7542 
	`SNDMSG
("commô føme†(%ldËovîÊow (avaû = %ld)", 
‰ames
,

7543 
	`¢d_pcm_mm≠_avaû
(
pcm
));

7544  -
EPIPE
;

7546 i‡(
pcm
->
Á°_›s
->
mm≠_commô
)

7547  
pcm
->
Á°_›s
->
	`mm≠_commô
’cm->
Á°_›_¨g
, 
off£t
, 
‰ames
);

7549  -
ENOSYS
;

7550 
	}
}

7552 
	$_¢d_pcm_pﬁl_des¸ùt‹
(
¢d_pcm_t
 *
pcm
)

7554 
	`as£π
(
pcm
);

7555  
pcm
->
pﬁl_fd
;

7556 
	}
}

7558 
	$¢d_pcm_¨ós_‰om_buf
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

7559 *
buf
)

7561 
ch™√l
;

7562 
ch™√ls
;

7564 
	`¢d_pcm_lock
(
pcm
);

7565 
ch™√ls
 = 
pcm
->channels;

7566 
ch™√l
 = 0; ch™√»< 
ch™√ls
; ++ch™√l, ++
¨ós
) {

7567 
¨ós
->
addr
 = 
buf
;

7568 
¨ós
->
fú°
 = 
ch™√l
 * 
pcm
->
ßm∂e_bôs
;

7569 
¨ós
->
°ï
 = 
pcm
->
‰ame_bôs
;

7571 
	`¢d_pcm_u∆ock
(
pcm
);

7572 
	}
}

7574 
	$¢d_pcm_¨ós_‰om_bufs
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

7575 **
bufs
)

7577 
ch™√l
;

7578 
ch™√ls
;

7580 
	`¢d_pcm_lock
(
pcm
);

7581 
ch™√ls
 = 
pcm
->channels;

7582 
ch™√l
 = 0; ch™√»< 
ch™√ls
; ++ch™√l, ++
¨ós
, ++
bufs
) {

7583 
¨ós
->
addr
 = *
bufs
;

7584 
¨ós
->
fú°
 = 0;

7585 
¨ós
->
°ï
 = 
pcm
->
ßm∂e_bôs
;

7587 
	`¢d_pcm_u∆ock
(
pcm
);

7588 
	}
}

7590 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_ªad_¨ós
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

7591 
¢d_pcm_u‰ames_t
 
off£t
, snd_pcm_u‰ames_à
size
,

7592 
¢d_pcm_x„r_¨ós_func_t
 
func
)

7594 
¢d_pcm_u‰ames_t
 
x„r
 = 0;

7595 
¢d_pcm_s‰ames_t
 
îr
 = 0;

7596 
¢d_pcm_°©e_t
 
°©e
;

7598 i‡(
size
 == 0)

7601 
	`__¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

7602 
size
 > 0) {

7603 
¢d_pcm_u‰ames_t
 
‰ames
;

7604 
¢d_pcm_s‰ames_t
 
avaû
;

7605 
_agaö
:

7606 
°©e
 = 
	`__¢d_pcm_°©e
(
pcm
);

7607 
°©e
) {

7608 
SND_PCM_STATE_PREPARED
:

7609 
îr
 = 
	`__¢d_pcm_°¨t
(
pcm
);

7610 i‡(
îr
 < 0)

7611 
_íd
;

7613 
SND_PCM_STATE_RUNNING
:

7614 
îr
 = 
	`__¢d_pcm_hwsync
(
pcm
);

7615 i‡(
îr
 < 0)

7616 
_íd
;

7618 
SND_PCM_STATE_DRAINING
:

7619 
SND_PCM_STATE_PAUSED
:

7622 
îr
 = 
	`pcm_°©e_to_îr‹
(
°©e
);

7623 i‡(!
îr
)

7624 
îr
 = -
EBADFD
;

7625 
_íd
;

7627 
avaû
 = 
	`__¢d_pcm_avaû_upd©e
(
pcm
);

7628 i‡(
avaû
 < 0) {

7629 
îr
 = 
avaû
;

7630 
_íd
;

7632 i‡(
avaû
 == 0) {

7633 i‡(
°©e
 =
SND_PCM_STATE_DRAINING
)

7634 
_íd
;

7635 i‡(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
) {

7636 
îr
 = -
EAGAIN
;

7637 
_íd
;

7640 
îr
 = 
	`__¢d_pcm_waô_ö_lock
(
pcm
, 
SND_PCM_WAIT_IO
);

7641 i‡(
îr
 < 0)

7643 
_agaö
;

7646 
‰ames
 = 
size
;

7647 i‡(
‰ames
 > (
¢d_pcm_u‰ames_t
Ë
avaû
)

7648 
‰ames
 = 
avaû
;

7649 i‡(! 
‰ames
)

7651 
îr
 = 
	`func
(
pcm
, 
¨ós
, 
off£t
, 
‰ames
);

7652 i‡(
îr
 < 0)

7654 
‰ames
 = 
îr
;

7655 
off£t
 +
‰ames
;

7656 
size
 -
‰ames
;

7657 
x„r
 +
‰ames
;

7659 
_íd
:

7660 
	`__¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

7661  
x„r
 > 0 ? (
¢d_pcm_s‰ames_t
Ëx„∏: 
	`¢d_pcm_check_îr‹
(
pcm
, 
îr
);

7662 
	}
}

7664 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_wrôe_¨ós
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

7665 
¢d_pcm_u‰ames_t
 
off£t
, snd_pcm_u‰ames_à
size
,

7666 
¢d_pcm_x„r_¨ós_func_t
 
func
)

7668 
¢d_pcm_u‰ames_t
 
x„r
 = 0;

7669 
¢d_pcm_s‰ames_t
 
îr
 = 0;

7670 
¢d_pcm_°©e_t
 
°©e
;

7672 i‡(
size
 == 0)

7675 
	`__¢d_pcm_lock
(
pcm
->
Á°_›_¨g
);

7676 
size
 > 0) {

7677 
¢d_pcm_u‰ames_t
 
‰ames
;

7678 
¢d_pcm_s‰ames_t
 
avaû
;

7679 
_agaö
:

7680 
°©e
 = 
	`__¢d_pcm_°©e
(
pcm
);

7681 
°©e
) {

7682 
SND_PCM_STATE_PREPARED
:

7683 
SND_PCM_STATE_PAUSED
:

7685 
SND_PCM_STATE_RUNNING
:

7686 
îr
 = 
	`__¢d_pcm_hwsync
(
pcm
);

7687 i‡(
îr
 < 0)

7688 
_íd
;

7691 
îr
 = 
	`pcm_°©e_to_îr‹
(
°©e
);

7692 i‡(!
îr
)

7693 
îr
 = -
EBADFD
;

7694 
_íd
;

7696 
avaû
 = 
	`__¢d_pcm_avaû_upd©e
(
pcm
);

7697 i‡(
avaû
 < 0) {

7698 
îr
 = 
avaû
;

7699 
_íd
;

7701 i‡(
°©e
 =
SND_PCM_STATE_RUNNING
 &&

7702 
size
 > (
¢d_pcm_u‰ames_t
)
avaû
) {

7703 i‡(
	`¢d_pcm_may_waô_f‹_avaû_mö
(
pcm
, 
avaû
)) {

7704 i‡(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
) {

7705 
îr
 = -
EAGAIN
;

7706 
_íd
;

7709 
îr
 = 
	`¢d_pcm_waô_nocheck
(
pcm
, 
SND_PCM_WAIT_IO
);

7710 i‡(
îr
 < 0)

7712 
_agaö
;

7717 
avaû
 = 
	`__¢d_pcm_avaû_upd©e
(
pcm
);

7718 i‡(
avaû
 < 0) {

7719 
îr
 = 
avaû
;

7720 
_íd
;

7723 
‰ames
 = 
size
;

7724 i‡(
‰ames
 > (
¢d_pcm_u‰ames_t
Ë
avaû
)

7725 
‰ames
 = 
avaû
;

7726 i‡(! 
‰ames
)

7728 
îr
 = 
	`func
(
pcm
, 
¨ós
, 
off£t
, 
‰ames
);

7729 i‡(
îr
 < 0)

7731 
‰ames
 = 
îr
;

7732 i‡(
°©e
 =
SND_PCM_STATE_PREPARED
) {

7733 
¢d_pcm_s‰ames_t
 
hw_avaû
 = 
pcm
->
buf„r_size
 - 
avaû
;

7734 
hw_avaû
 +
‰ames
;

7736 
°©e
 = 
	`__¢d_pcm_°©e
(
pcm
);

7737 i‡(
°©e
 =
SND_PCM_STATE_PREPARED
 &&

7738 
hw_avaû
 >= 0 &&

7739 (
¢d_pcm_u‰ames_t
Ë
hw_avaû
 >
pcm
->
°¨t_thªshﬁd
) {

7740 
îr
 = 
	`__¢d_pcm_°¨t
(
pcm
);

7741 i‡(
îr
 < 0)

7742 
_íd
;

7745 
off£t
 +
‰ames
;

7746 
size
 -
‰ames
;

7747 
x„r
 +
‰ames
;

7749 
_íd
:

7750 
	`__¢d_pcm_u∆ock
(
pcm
->
Á°_›_¨g
);

7751  
x„r
 > 0 ? (
¢d_pcm_s‰ames_t
Ëx„∏: 
	`¢d_pcm_check_îr‹
(
pcm
, 
îr
);

7752 
	}
}

7754 
¢d_pcm_u‰ames_t
 
	$_¢d_pcm_mm≠_hw_±r
(
¢d_pcm_t
 *
pcm
)

7756  *
pcm
->
hw
.
±r
;

7757 
	}
}

7759 
¢d_pcm_u‰ames_t
 
	$_¢d_pcm_bound¨y
(
¢d_pcm_t
 *
pcm
)

7761  
pcm
->
bound¨y
;

7762 
	}
}

7764 #i‚de‡
DOC_HIDDEN


7765 
lök_w¨nög
(
_¢d_pcm_mm≠_hw_±r
, "Warning: _snd_pcm_mmap_hw_ptr() is deprecated, considerÅoÇot useÅhis function");

7766 
lök_w¨nög
(
_¢d_pcm_bound¨y
, "Warning: _snd_pcm_boundary() is deprecated, considerÅo use snd_pcm_sw_params_current()");

7769 c⁄° *c⁄° 
	g«mes
[
SND_PCM_HW_PARAM_LAST_INTERVAL
 + 1] = {

7770 [
SND_PCM_HW_PARAM_FORMAT
] = "format",

7771 [
SND_PCM_HW_PARAM_CHANNELS
] = "channels",

7772 [
SND_PCM_HW_PARAM_RATE
] = "rate",

7773 [
SND_PCM_HW_PARAM_PERIOD_TIME
] = "period_time",

7774 [
SND_PCM_HW_PARAM_PERIOD_SIZE
] = "period_size",

7775 [
SND_PCM_HW_PARAM_BUFFER_TIME
] = "buffer_time",

7776 [
SND_PCM_HW_PARAM_BUFFER_SIZE
] = "buffer_size",

7777 [
SND_PCM_HW_PARAM_PERIODS
] = "periods"

7780 
	$¢d_pcm_¶ave_c⁄f
(
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

7781 
¢d_c⁄fig_t
 **
_pcm_c⁄f
, 
cou¡
, ...)

7783 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

7784 c⁄° *
°r
;

7786 
ödex
;

7787 
Êags
;

7788 *
±r
;

7789 
¥e£¡
;

7790 } 
fõlds
[
cou¡
];

7791 
k
;

7792 
¢d_c⁄fig_t
 *
pcm_c⁄f
 = 
NULL
;

7793 
îr
;

7794 
to_‰ì
 = 0;

7795 
va_li°
 
¨gs
;

7796 
	`as£π
(
roŸ
);

7797 
	`as£π
(
c⁄f
);

7798 
	`as£π
(
_pcm_c⁄f
);

7799 i‡(
	`¢d_c⁄fig_gë_°rög
(
c⁄f
, &
°r
) >= 0) {

7800 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "pcm_¶ave", 
°r
, &
c⁄f
);

7801 i‡(
îr
 < 0) {

7802 
	`SNDERR
("Invalid slave definition");

7803  -
EINVAL
;

7805 
to_‰ì
 = 1;

7807 i‡(
	`¢d_c⁄fig_gë_ty≥
(
c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

7808 
	`SNDERR
("Invalid slave definition");

7809 
îr
 = -
EINVAL
;

7810 
_îr
;

7812 
	`va_°¨t
(
¨gs
, 
cou¡
);

7813 
k
 = 0; k < 
cou¡
; ++k) {

7814 
fõlds
[
k
].
ödex
 = 
	`va_¨g
(
¨gs
, );

7815 
fõlds
[
k
].
Êags
 = 
	`va_¨g
(
¨gs
, );

7816 
fõlds
[
k
].
±r
 = 
	`va_¨g
(
¨gs
, *);

7817 
fõlds
[
k
].
¥e£¡
 = 0;

7819 
	`va_íd
(
¨gs
);

7820 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

7821 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

7822 c⁄° *
id
;

7823 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

7825 i‡(
	`°rcmp
(
id
, "comment") == 0)

7827 i‡(
	`°rcmp
(
id
, "pcm") == 0) {

7828 i‡(
pcm_c⁄f
 !
NULL
)

7829 
	`¢d_c⁄fig_dñëe
(
pcm_c⁄f
);

7830 i‡((
îr
 = 
	`¢d_c⁄fig_c›y
(&
pcm_c⁄f
, 
n
)) < 0)

7831 
_îr
;

7834 
k
 = 0; k < 
cou¡
; ++k) {

7835 
idx
 = 
fõlds
[
k
].
ödex
;

7836 
v
;

7837 
	`as£π
(
idx
 < 
SND_PCM_HW_PARAM_LAST_INTERVAL
);

7838 
	`as£π
(
«mes
[
idx
]);

7839 i‡(
	`°rcmp
(
id
, 
«mes
[
idx
]) != 0)

7841 
idx
) {

7842 
SND_PCM_HW_PARAM_FORMAT
:

7844 
¢d_pcm_f‹m©_t
 
f
;

7845 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
);

7846 i‡(
îr
 < 0) {

7847 
_övÆid
:

7848 
	`SNDERR
("övÆidÅy≥ f‹ %s", 
id
);

7849 
_îr
;

7851 i‡((
fõlds
[
k
].
Êags
 & 
SCONF_UNCHANGED
) &&

7852 
	`°rˇ£cmp
(
°r
, "unchanged") == 0) {

7853 *(
¢d_pcm_f‹m©_t
*)
fõlds
[
k
].
±r
 = (snd_pcm_format_t) -2;

7856 
f
 = 
	`¢d_pcm_f‹m©_vÆue
(
°r
);

7857 i‡(
f
 =
SND_PCM_FORMAT_UNKNOWN
) {

7858 
	`SNDERR
("unknow¿f‹m© %s", 
°r
);

7859 
îr
 = -
EINVAL
;

7860 
_îr
;

7862 *(
¢d_pcm_f‹m©_t
*)
fõlds
[
k
].
±r
 = 
f
;

7866 i‡((
fõlds
[
k
].
Êags
 & 
SCONF_UNCHANGED
)) {

7867 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
);

7868 i‡(
îr
 >= 0 &&

7869 
	`°rˇ£cmp
(
°r
, "unchanged") == 0) {

7870 *(*)
fõlds
[
k
].
±r
 = -2;

7874 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
v
);

7875 i‡(
îr
 < 0)

7876 
_övÆid
;

7877 *(*)
fõlds
[
k
].
±r
 = 
v
;

7880 
fõlds
[
k
].
¥e£¡
 = 1;

7883 i‡(
k
 < 
cou¡
)

7885 
	`SNDERR
("Unknow¿fõld %s", 
id
);

7886 
îr
 = -
EINVAL
;

7887 
_îr
;

7889 i‡(!
pcm_c⁄f
) {

7890 
	`SNDERR
("missing fieldÖcm");

7891 
îr
 = -
EINVAL
;

7892 
_îr
;

7894 
k
 = 0; k < 
cou¡
; ++k) {

7895 i‡((
fõlds
[
k
].
Êags
 & 
SCONF_MANDATORY
Ë&& !fõlds[k].
¥e£¡
) {

7896 
	`SNDERR
("missög fõld %s", 
«mes
[
fõlds
[
k
].
ödex
]);

7897 
îr
 = -
EINVAL
;

7898 
_îr
;

7901 *
_pcm_c⁄f
 = 
pcm_c⁄f
;

7902 
pcm_c⁄f
 = 
NULL
;

7903 
îr
 = 0;

7904 
_îr
:

7905 i‡(
pcm_c⁄f
)

7906 
	`¢d_c⁄fig_dñëe
(
pcm_c⁄f
);

7907 i‡(
to_‰ì
)

7908 
	`¢d_c⁄fig_dñëe
(
c⁄f
);

7909  
îr
;

7910 
	}
}

7912 
	$¢d_pcm_£t_±r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_rb±r_t
 *
rb±r
,

7913 vﬁ©ûê
¢d_pcm_u‰ames_t
 *
hw_±r
, 
fd
, 
off_t
 
off£t
)

7915 
rb±r
->
ma°î
 = 
NULL
;

7916 
rb±r
->
±r
 = 
hw_±r
;

7917 
rb±r
->
fd
 = fd;

7918 
rb±r
->
off£t
 = offset;

7919 i‡(
rb±r
->
ch™ged
)

7920 
rb±r
->
	`ch™ged
(
pcm
, 
NULL
);

7921 
	}
}

7923 
	$¢d_pcm_£t_hw_±r
(
¢d_pcm_t
 *
pcm
, vﬁ©ûê
¢d_pcm_u‰ames_t
 *
hw_±r
, 
fd
, 
off_t
 
off£t
)

7925 
	`as£π
(
pcm
);

7926 
	`as£π
(
hw_±r
);

7927 
	`¢d_pcm_£t_±r
(
pcm
, &pcm->
hw
, 
hw_±r
, 
fd
, 
off£t
);

7928 
	}
}

7930 
	$¢d_pcm_£t_≠∂_±r
(
¢d_pcm_t
 *
pcm
, vﬁ©ûê
¢d_pcm_u‰ames_t
 *
≠∂_±r
, 
fd
, 
off_t
 
off£t
)

7932 
	`as£π
(
pcm
);

7933 
	`as£π
(
≠∂_±r
);

7934 
	`¢d_pcm_£t_±r
(
pcm
, &pcm->
≠∂
, 
≠∂_±r
, 
fd
, 
off£t
);

7935 
	}
}

7937 
	$¢d_pcm_lök_±r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_rb±r_t
 *
pcm_rb±r
,

7938 
¢d_pcm_t
 *
¶ave
, 
¢d_pcm_rb±r_t
 *
¶ave_rb±r
)

7940 
¢d_pcm_t
 **
a
;

7941 
idx
;

7943 
a
 = 
¶ave_rb±r
->
lök_d°
;

7944 
idx
 = 0; idx < 
¶ave_rb±r
->
lök_d°_cou¡
; idx++)

7945 i‡(
a
[
idx
] =
NULL
) {

7946 
a
[
idx
] = 
pcm
;

7947 
__found_‰ì_∂a˚
;

7949 
a
 = 
	`ªÆloc
◊, (
¢d_pcm_t
 *Ë* (
¶ave_rb±r
->
lök_d°_cou¡
 + 1));

7950 i‡(
a
 =
NULL
) {

7951 
pcm_rb±r
->
±r
 = 
NULL
;

7952 
pcm_rb±r
->
fd
 = -1;

7953 
pcm_rb±r
->
off£t
 = 0UL;

7956 
a
[
¶ave_rb±r
->
lök_d°_cou¡
++] = 
pcm
;

7957 
__found_‰ì_∂a˚
:

7958 
pcm_rb±r
->
ma°î
 = 
¶ave_rb±r
->ma°î ? sœve_rb±r->ma°î : 
¶ave
;

7959 
pcm_rb±r
->
±r
 = 
¶ave_rb±r
->ptr;

7960 
pcm_rb±r
->
fd
 = 
¶ave_rb±r
->fd;

7961 
pcm_rb±r
->
off£t
 = 
¶ave_rb±r
->offset;

7962 
¶ave_rb±r
->
lök_d°
 = 
a
;

7963 i‡(
pcm_rb±r
->
ch™ged
)

7964 
pcm_rb±r
->
	`ch™ged
(
pcm
, 
¶ave
);

7965 
	}
}

7967 
	$¢d_pcm_u∆ök_±r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_rb±r_t
 *
pcm_rb±r
,

7968 
¢d_pcm_t
 *
¶ave
, 
¢d_pcm_rb±r_t
 *
¶ave_rb±r
)

7970 
¢d_pcm_t
 **
a
;

7971 
idx
;

7973 
a
 = 
¶ave_rb±r
->
lök_d°
;

7974 
idx
 = 0; idx < 
¶ave_rb±r
->
lök_d°_cou¡
; idx++) {

7975 i‡(
a
[
idx
] =
pcm
) {

7976 
a
[
idx
] = 
NULL
;

7977 
__found
;

7983 
__found
:

7984 
pcm_rb±r
->
ma°î
 = 
NULL
;

7985 
pcm_rb±r
->
±r
 = 
NULL
;

7986 
pcm_rb±r
->
fd
 = -1;

7987 
pcm_rb±r
->
off£t
 = 0UL;

7988 i‡(
pcm_rb±r
->
ch™ged
)

7989 
pcm_rb±r
->
	`ch™ged
(
pcm
, 
¶ave
);

7990 
	}
}

7992 
	$¢d_pcm_lök_hw_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_à*
¶ave
)

7994 
	`as£π
(
pcm
);

7995 
	`as£π
(
¶ave
);

7996 
	`¢d_pcm_lök_±r
(
pcm
, &pcm->
hw
, 
¶ave
, &slave->hw);

7997 
	}
}

7999 
	$¢d_pcm_lök_≠∂_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_à*
¶ave
)

8001 
	`as£π
(
pcm
);

8002 
	`as£π
(
¶ave
);

8003 
	`¢d_pcm_lök_±r
(
pcm
, &pcm->
≠∂
, 
¶ave
, &slave->appl);

8004 
	}
}

8006 
	$¢d_pcm_u∆ök_hw_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_à*
¶ave
)

8008 
	`as£π
(
pcm
);

8009 
	`as£π
(
¶ave
);

8010 
	`¢d_pcm_u∆ök_±r
(
pcm
, &pcm->
hw
, 
¶ave
, &slave->hw);

8011 
	}
}

8013 
	$¢d_pcm_u∆ök_≠∂_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_à*
¶ave
)

8015 
	`as£π
(
pcm
);

8016 
	`as£π
(
¶ave
);

8017 
	`¢d_pcm_u∆ök_±r
(
pcm
, &pcm->
≠∂
, 
¶ave
, &slave->appl);

8018 
	}
}

8026 #i‚de‡
DOC_HIDDEN


8028 #ifde‡
USE_VERSIONED_SYMBOLS


8030 
	#OBSOLETE1
(
«me
, 
wh©
, 
√w
) \

8031 
	`deÁu…_symbﬁ_vîsi⁄
(
__
##
«me
,Çame, 
√w
); \

8032 
	`symbﬁ_vîsi⁄
(
__ﬁd_
##
«me
,Çame, 
wh©
);

	)

8036 
	#OBSOLETE1
(
«me
, 
wh©
, 
√w
) \

8037 
	`u£_deÁu…_symbﬁ_vîsi⁄
(
__
##
«me
,Çame, 
√w
);

	)

8041 
	#__P_OLD_GET
(
pfx
, 
«me
, 
vÆ_ty≥
, 
ªt_ty≥
) \

8042 
EXPORT_SYMBOL
 
ªt_ty≥
 
pfx
##
	`«me
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
) \

8044 
vÆ_ty≥
 
vÆ
; \

8045 i‡(
	`INTERNAL
(
«me
)(
∑øms
, &
vÆ
) < 0) \

8047  (
ªt_ty≥
)
vÆ
; \

8048 }

	)

8050 
	#__P_OLD_GET1
(
pfx
, 
«me
, 
vÆ_ty≥
, 
ªt_ty≥
) \

8051 
EXPORT_SYMBOL
 
ªt_ty≥
 
pfx
##
	`«me
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
) \

8053 
vÆ_ty≥
 
vÆ
; \

8054 i‡(
	`INTERNAL
(
«me
)(
∑øms
, &
vÆ
, 
dú
) < 0) \

8056  (
ªt_ty≥
)
vÆ
; \

8057 }

	)

8059 
	#__OLD_GET
(
«me
, 
vÆ_ty≥
, 
ªt_ty≥
Ë
	`__P_OLD_GET
(
__ﬁd_
,Çame, vÆ_ty≥,Ñë_ty≥)

	)

8060 
	#__OLD_GET1
(
«me
, 
vÆ_ty≥
, 
ªt_ty≥
Ë
	`__P_OLD_GET1
(
__ﬁd_
,Çame, vÆ_ty≥,Ñë_ty≥)

	)

8062 
__OLD_GET
(
¢d_pcm_hw_∑øms_gë_ac˚ss
, 
¢d_pcm_ac˚ss_t
, );

8063 
__OLD_GET
(
¢d_pcm_hw_∑øms_gë_f‹m©
, 
¢d_pcm_f‹m©_t
, );

8064 
__OLD_GET
(
¢d_pcm_hw_∑øms_gë_subf‹m©
, 
¢d_pcm_subf‹m©_t
, );

8065 
__OLD_GET
(
¢d_pcm_hw_∑øms_gë_ch™√ls
, , );

8066 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_øã
, , );

8067 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_≥riod_time
, , );

8068 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_≥riod_size
, 
¢d_pcm_u‰ames_t
, 
¢d_pcm_s‰ames_t
);

8069 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_≥riods
, , );

8070 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_buf„r_time
, , );

8071 
__OLD_GET
(
¢d_pcm_hw_∑øms_gë_buf„r_size
, 
¢d_pcm_u‰ames_t
, 
¢d_pcm_s‰ames_t
);

8072 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_tick_time
, , );

8074 
__OLD_GET
(
¢d_pcm_hw_∑øms_gë_ch™√ls_mö
, , );

8075 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_øã_mö
, , );

8076 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_≥riod_time_mö
, , );

8077 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_≥riod_size_mö
, 
¢d_pcm_u‰ames_t
, snd_pcm_uframes_t);

8078 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_≥riods_mö
, , );

8079 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_buf„r_time_mö
, , );

8080 
__OLD_GET
(
¢d_pcm_hw_∑øms_gë_buf„r_size_mö
, 
¢d_pcm_u‰ames_t
, snd_pcm_uframes_t);

8081 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_tick_time_mö
, , );

8083 
__OLD_GET
(
¢d_pcm_hw_∑øms_gë_ch™√ls_max
, , );

8084 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_øã_max
, , );

8085 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_≥riod_time_max
, , );

8086 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_≥riod_size_max
, 
¢d_pcm_u‰ames_t
, snd_pcm_uframes_t);

8087 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_≥riods_max
, , );

8088 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_buf„r_time_max
, , );

8089 
__OLD_GET
(
¢d_pcm_hw_∑øms_gë_buf„r_size_max
, 
¢d_pcm_u‰ames_t
, snd_pcm_uframes_t);

8090 
__OLD_GET1
(
¢d_pcm_hw_∑øms_gë_tick_time_max
, , );

8092 
	#__P_OLD_NEAR
(
pfx
, 
«me
, 
ªt_ty≥
) \

8093 
EXPORT_SYMBOL
 
ªt_ty≥
 
pfx
##
	`«me
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,Ñë_ty≥ 
vÆ
) \

8095 i‡(
	`INTERNAL
(
«me
)(
pcm
, 
∑øms
, &
vÆ
) < 0) \

8097  (
ªt_ty≥
)
vÆ
; \

8098 }

	)

8100 
	#__P_OLD_NEAR1
(
pfx
, 
«me
, 
ªt_ty≥
) \

8101 
EXPORT_SYMBOL
 
ªt_ty≥
 
pfx
##
	`«me
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,Ñë_ty≥ 
vÆ
, *
dú
) \

8103 i‡(
	`INTERNAL
(
«me
)(
pcm
, 
∑øms
, &
vÆ
, 
dú
) < 0) \

8105  (
ªt_ty≥
)
vÆ
; \

8106 }

	)

8108 
	#__OLD_NEAR
(
«me
, 
ªt_ty≥
Ë
	`__P_OLD_NEAR
(
__ﬁd_
,Çame,Ñë_ty≥)

	)

8109 
	#__OLD_NEAR1
(
«me
, 
ªt_ty≥
Ë
	`__P_OLD_NEAR1
(
__ﬁd_
,Çame,Ñë_ty≥)

	)

8111 
__OLD_NEAR
(
¢d_pcm_hw_∑øms_£t_ch™√ls_√¨
, );

8112 
__OLD_NEAR1
(
¢d_pcm_hw_∑øms_£t_øã_√¨
, );

8113 
__OLD_NEAR1
(
¢d_pcm_hw_∑øms_£t_≥riod_time_√¨
, );

8114 
__OLD_NEAR1
(
¢d_pcm_hw_∑øms_£t_≥riod_size_√¨
, 
¢d_pcm_u‰ames_t
);

8115 
__OLD_NEAR1
(
¢d_pcm_hw_∑øms_£t_≥riods_√¨
, );

8116 
__OLD_NEAR1
(
¢d_pcm_hw_∑øms_£t_buf„r_time_√¨
, );

8117 
__OLD_NEAR
(
¢d_pcm_hw_∑øms_£t_buf„r_size_√¨
, 
¢d_pcm_u‰ames_t
);

8118 
__OLD_NEAR1
(
¢d_pcm_hw_∑øms_£t_tick_time_√¨
, );

8120 
	#__P_OLD_SET_FL
(
pfx
, 
«me
, 
ªt_ty≥
) \

8121 
EXPORT_SYMBOL
 
ªt_ty≥
 
pfx
##
	`«me
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
) \

8123 
ªt_ty≥
 
vÆ
; \

8124 i‡(
	`INTERNAL
(
«me
)(
pcm
, 
∑øms
, &
vÆ
) < 0) \

8126  (
ªt_ty≥
)
vÆ
; \

8127 }

	)

8129 
	#__P_OLD_SET_FL1
(
pfx
, 
«me
, 
ªt_ty≥
) \

8130 
EXPORT_SYMBOL
 
ªt_ty≥
 
pfx
##
	`«me
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
dú
) \

8132 
ªt_ty≥
 
vÆ
; \

8133 i‡(
	`INTERNAL
(
«me
)(
pcm
, 
∑øms
, &
vÆ
, 
dú
) < 0) \

8135  (
ªt_ty≥
)
vÆ
; \

8136 }

	)

8138 
	#__OLD_SET_FL
(
«me
, 
ªt_ty≥
Ë
	`__P_OLD_SET_FL
(
__ﬁd_
,Çame,Ñë_ty≥)

	)

8139 
	#__OLD_SET_FL1
(
«me
, 
ªt_ty≥
Ë
	`__P_OLD_SET_FL1
(
__ﬁd_
,Çame,Ñë_ty≥)

	)

8141 
__OLD_SET_FL
(
¢d_pcm_hw_∑øms_£t_ac˚ss_fú°
, 
¢d_pcm_ac˚ss_t
);

8142 
__OLD_SET_FL
(
¢d_pcm_hw_∑øms_£t_f‹m©_fú°
, 
¢d_pcm_f‹m©_t
);

8143 
__OLD_SET_FL
(
¢d_pcm_hw_∑øms_£t_subf‹m©_fú°
, 
¢d_pcm_subf‹m©_t
);

8144 
__OLD_SET_FL
(
¢d_pcm_hw_∑øms_£t_ch™√ls_fú°
, );

8145 
__OLD_SET_FL1
(
¢d_pcm_hw_∑øms_£t_øã_fú°
, );

8146 
__OLD_SET_FL1
(
¢d_pcm_hw_∑øms_£t_≥riod_time_fú°
, );

8147 
__OLD_SET_FL1
(
¢d_pcm_hw_∑øms_£t_≥riod_size_fú°
, 
¢d_pcm_u‰ames_t
);

8148 
__OLD_SET_FL1
(
¢d_pcm_hw_∑øms_£t_≥riods_fú°
, );

8149 
__OLD_SET_FL1
(
¢d_pcm_hw_∑øms_£t_buf„r_time_fú°
, );

8150 
__OLD_SET_FL
(
¢d_pcm_hw_∑øms_£t_buf„r_size_fú°
, 
¢d_pcm_u‰ames_t
);

8151 
__OLD_SET_FL1
(
¢d_pcm_hw_∑øms_£t_tick_time_fú°
, );

8153 
__OLD_SET_FL
(
¢d_pcm_hw_∑øms_£t_ac˚ss_œ°
, 
¢d_pcm_ac˚ss_t
);

8154 
__OLD_SET_FL
(
¢d_pcm_hw_∑øms_£t_f‹m©_œ°
, 
¢d_pcm_f‹m©_t
);

8155 
__OLD_SET_FL
(
¢d_pcm_hw_∑øms_£t_subf‹m©_œ°
, 
¢d_pcm_subf‹m©_t
);

8156 
__OLD_SET_FL
(
¢d_pcm_hw_∑øms_£t_ch™√ls_œ°
, );

8157 
__OLD_SET_FL1
(
¢d_pcm_hw_∑øms_£t_øã_œ°
, );

8158 
__OLD_SET_FL1
(
¢d_pcm_hw_∑øms_£t_≥riod_time_œ°
, );

8159 
__OLD_SET_FL1
(
¢d_pcm_hw_∑øms_£t_≥riod_size_œ°
, 
¢d_pcm_u‰ames_t
);

8160 
__OLD_SET_FL1
(
¢d_pcm_hw_∑øms_£t_≥riods_œ°
, );

8161 
__OLD_SET_FL1
(
¢d_pcm_hw_∑øms_£t_buf„r_time_œ°
, );

8162 
__OLD_SET_FL
(
¢d_pcm_hw_∑øms_£t_buf„r_size_œ°
, 
¢d_pcm_u‰ames_t
);

8163 
__OLD_SET_FL1
(
¢d_pcm_hw_∑øms_£t_tick_time_œ°
, );

8165 
	#__P_OLD_GET_SW
(
pfx
, 
«me
, 
ªt_ty≥
) \

8166 
EXPORT_SYMBOL
 
ªt_ty≥
 
pfx
##
	`«me
(
¢d_pcm_sw_∑øms_t
 *
∑øms
) \

8168 
ªt_ty≥
 
vÆ
; \

8169 i‡(
	`INTERNAL
(
«me
)(
∑øms
, &
vÆ
) < 0) \

8171  (
ªt_ty≥
)
vÆ
; \

8172 }

	)

8174 
	#__OLD_GET_SW
(
«me
, 
ªt_ty≥
Ë
	`__P_OLD_GET_SW
(
__ﬁd_
,Çame,Ñë_ty≥)

	)

8176 
__OLD_GET_SW
(
¢d_pcm_sw_∑øms_gë_t°amp_mode
, 
¢d_pcm_t°amp_t
);

8177 
__OLD_GET_SW
(
¢d_pcm_sw_∑øms_gë_¶ìp_mö
, );

8178 
__OLD_GET_SW
(
¢d_pcm_sw_∑øms_gë_avaû_mö
, 
¢d_pcm_u‰ames_t
);

8179 
__OLD_GET_SW
(
¢d_pcm_sw_∑øms_gë_x„r_Æign
, 
¢d_pcm_u‰ames_t
);

8180 
__OLD_GET_SW
(
¢d_pcm_sw_∑øms_gë_°¨t_thªshﬁd
, 
¢d_pcm_u‰ames_t
);

8181 
__OLD_GET_SW
(
¢d_pcm_sw_∑øms_gë_°›_thªshﬁd
, 
¢d_pcm_u‰ames_t
);

8182 
__OLD_GET_SW
(
¢d_pcm_sw_∑øms_gë_sûí˚_thªshﬁd
, 
¢d_pcm_u‰ames_t
);

8183 
__OLD_GET_SW
(
¢d_pcm_sw_∑øms_gë_sûí˚_size
, 
¢d_pcm_u‰ames_t
);

8185 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_ac˚ss
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8186 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_ac˚ss_fú°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8187 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_ac˚ss_œ°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8189 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_f‹m©
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8190 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_f‹m©_fú°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8191 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_f‹m©_œ°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8193 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_subf‹m©
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8194 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_subf‹m©_fú°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8195 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_subf‹m©_œ°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8197 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_ch™√ls
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8198 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_ch™√ls_mö
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8199 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_ch™√ls_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8200 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_ch™√ls_√¨
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8201 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_ch™√ls_fú°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8202 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_ch™√ls_œ°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8204 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_øã
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8205 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_øã_mö
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8206 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_øã_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8207 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_øã_√¨
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8208 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_øã_fú°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8209 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_øã_œ°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8211 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_≥riod_time
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8212 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_≥riod_time_mö
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8213 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_≥riod_time_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8214 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_≥riod_time_√¨
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8215 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_≥riod_time_fú°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8216 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_≥riod_time_œ°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8218 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_≥riod_size
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8219 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_≥riod_size_mö
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8220 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_≥riod_size_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8221 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_≥riod_size_√¨
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8222 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_≥riod_size_fú°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8223 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_≥riod_size_œ°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8225 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_≥riods
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8226 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_≥riods_mö
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8227 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_≥riods_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8228 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_≥riods_√¨
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8229 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_≥riods_fú°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8230 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_≥riods_œ°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8232 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_buf„r_time
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8233 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_buf„r_time_mö
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8234 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_buf„r_time_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8235 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_buf„r_time_√¨
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8236 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_buf„r_time_fú°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8237 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_buf„r_time_œ°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8239 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_buf„r_size
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8240 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_buf„r_size_mö
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8241 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_buf„r_size_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8242 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_buf„r_size_√¨
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8243 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_buf„r_size_fú°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8244 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_buf„r_size_œ°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8246 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_tick_time
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8247 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_tick_time_mö
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8248 
OBSOLETE1
(
¢d_pcm_hw_∑øms_gë_tick_time_max
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8249 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_tick_time_√¨
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8250 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_tick_time_fú°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8251 
OBSOLETE1
(
¢d_pcm_hw_∑øms_£t_tick_time_œ°
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8253 
OBSOLETE1
(
¢d_pcm_sw_∑øms_gë_t°amp_mode
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8254 
OBSOLETE1
(
¢d_pcm_sw_∑øms_gë_¶ìp_mö
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8255 
OBSOLETE1
(
¢d_pcm_sw_∑øms_gë_avaû_mö
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8256 
OBSOLETE1
(
¢d_pcm_sw_∑øms_gë_x„r_Æign
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8257 
OBSOLETE1
(
¢d_pcm_sw_∑øms_gë_°¨t_thªshﬁd
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8258 
OBSOLETE1
(
¢d_pcm_sw_∑øms_gë_°›_thªshﬁd
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8259 
OBSOLETE1
(
¢d_pcm_sw_∑øms_gë_sûí˚_thªshﬁd
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8260 
OBSOLETE1
(
¢d_pcm_sw_∑øms_gë_sûí˚_size
, 
ALSA_0
.9, ALSA_0.9.0
rc4
);

8264 
	$chm≠_equÆ
(c⁄° 
¢d_pcm_chm≠_t
 *
a
, c⁄° snd_pcm_chm≠_à*
b
)

8266 i‡(
a
->
ch™√ls
 !
b
->channels)

8268  !
	`memcmp
(
a
->
pos
, 
b
->pos,á->
ch™√ls
 * (a->pos[0]));

8269 
	}
}

8283 
¢d_pcm_chm≠_quîy_t
 **
	$¢d_pcm_quîy_chm≠s
(
¢d_pcm_t
 *
pcm
)

8285 i‡(!
pcm
->
›s
->
quîy_chm≠s
)

8286  
NULL
;

8287  
pcm
->
›s
->
	`quîy_chm≠s
(pcm);

8288 
	}
}

8294 
	$¢d_pcm_‰ì_chm≠s
(
¢d_pcm_chm≠_quîy_t
 **
m≠s
)

8296 
¢d_pcm_chm≠_quîy_t
 **
p
;

8297 i‡(!
m≠s
)

8299 
p
 = 
m≠s
; *p;Ö++)

8300 
	`‰ì
(*
p
);

8301 
	`‰ì
(
m≠s
);

8302 
	}
}

8311 
¢d_pcm_chm≠_t
 *
	$¢d_pcm_gë_chm≠
(
¢d_pcm_t
 *
pcm
)

8313 i‡(!
pcm
->
›s
->
gë_chm≠
)

8314  
NULL
;

8315  
pcm
->
›s
->
	`gë_chm≠
(pcm);

8316 
	}
}

8324 
	$¢d_pcm_£t_chm≠
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_chm≠_t
 *
m≠
)

8326 c⁄° 
¢d_pcm_chm≠_t
 *
ﬁdm≠
;

8327 
noch™ge
;

8329 
ﬁdm≠
 = 
	`¢d_pcm_gë_chm≠
(
pcm
);

8330 
noch™ge
 = (
ﬁdm≠
 && 
	`chm≠_equÆ
(ﬁdm≠, 
m≠
));

8331 
	`‰ì
((*)
ﬁdm≠
);

8332 i‡(
noch™ge
)

8335 i‡(!
pcm
->
›s
->
£t_chm≠
)

8336  -
ENXIO
;

8337  
pcm
->
›s
->
	`£t_chm≠
’cm, 
m≠
);

8338 
	}
}

8342 #i‚de‡
DOC_HIDDEN


8343 
	#_NAME
(
n
Ë[
SND_CHMAP_TYPE_
##n] = #n

	)

8344 c⁄° *
	gchm≠_ty≥_«mes
[
SND_CHMAP_TYPE_LAST
 + 1] = {

8345 
_NAME
(
NONE
), _NAME(
FIXED
), _NAME(
VAR
), _NAME(
PAIRED
),

8347 #unde‡
_NAME


8355 c⁄° *
	$¢d_pcm_chm≠_ty≥_«me
(
¢d_pcm_chm≠_ty≥
 
vÆ
)

8357 i‡(
vÆ
 <
SND_CHMAP_TYPE_LAST
)

8358  
chm≠_ty≥_«mes
[
vÆ
];

8360  
NULL
;

8361 
	}
}

8363 #i‚de‡
DOC_HIDDEN


8364 
	#_NAME
(
n
Ë[
SND_CHMAP_
##n] = #n

	)

8365 c⁄° *
	gchm≠_«mes
[
SND_CHMAP_LAST
 + 1] = {

8366 
_NAME
(
UNKNOWN
), _NAME(
NA
), _NAME(
MONO
),

8367 
_NAME
(
FL
), _NAME(
FR
),

8368 
_NAME
(
RL
), _NAME(
RR
),

8369 
_NAME
(
FC
), _NAME(
LFE
),

8370 
_NAME
(
SL
), _NAME(
SR
),

8371 
_NAME
(
RC
), _NAME(
FLC
), _NAME(
FRC
), _NAME(
RLC
), _NAME(
RRC
),

8372 
_NAME
(
FLW
), _NAME(
FRW
),

8373 
_NAME
(
FLH
), _NAME(
FCH
), _NAME(
FRH
), _NAME(
TC
),

8374 
_NAME
(
TFL
), _NAME(
TFR
), _NAME(
TFC
),

8375 
_NAME
(
TRL
), _NAME(
TRR
), _NAME(
TRC
),

8376 
_NAME
(
TFLC
), _NAME(
TFRC
), _NAME(
TSL
), _NAME(
TSR
),

8377 
_NAME
(
LLFE
), _NAME(
RLFE
),

8378 
_NAME
(
BC
), _NAME(
BLC
), _NAME(
BRC
),

8380 #unde‡
_NAME


8388 c⁄° *
	$¢d_pcm_chm≠_«me
(
¢d_pcm_chm≠_posôi⁄
 
vÆ
)

8390 i‡(
vÆ
 <
SND_CHMAP_LAST
)

8391  
chm≠_«mes
[
vÆ
];

8393  
NULL
;

8394 
	}
}

8396 c⁄° *
	gchm≠_l⁄g_«mes
[
SND_CHMAP_LAST
 + 1] = {

8397 [
SND_CHMAP_UNKNOWN
] = "Unknown",

8398 [
SND_CHMAP_NA
] = "Unused",

8399 [
SND_CHMAP_MONO
] = "Mono",

8400 [
SND_CHMAP_FL
] = "Front Left",

8401 [
SND_CHMAP_FR
] = "Front Right",

8402 [
SND_CHMAP_RL
] = "Rear Left",

8403 [
SND_CHMAP_RR
] = "Rear Right",

8404 [
SND_CHMAP_FC
] = "Front Center",

8405 [
SND_CHMAP_LFE
] = "LFE",

8406 [
SND_CHMAP_SL
] = "Side Left",

8407 [
SND_CHMAP_SR
] = "Side Right",

8408 [
SND_CHMAP_RC
] = "Rear Center",

8409 [
SND_CHMAP_FLC
] = "Front Left Center",

8410 [
SND_CHMAP_FRC
] = "Front Right Center",

8411 [
SND_CHMAP_RLC
] = "Rear Left Center",

8412 [
SND_CHMAP_RRC
] = "Rear Right Center",

8413 [
SND_CHMAP_FLW
] = "Front Left Wide",

8414 [
SND_CHMAP_FRW
] = "Front Right Wide",

8415 [
SND_CHMAP_FLH
] = "Front Left High",

8416 [
SND_CHMAP_FCH
] = "Front Center High",

8417 [
SND_CHMAP_FRH
] = "Front Right High",

8418 [
SND_CHMAP_TC
] = "Top Center",

8419 [
SND_CHMAP_TFL
] = "Top Front Left",

8420 [
SND_CHMAP_TFR
] = "Top Front Right",

8421 [
SND_CHMAP_TFC
] = "Top Front Center",

8422 [
SND_CHMAP_TRL
] = "Top Rear Left",

8423 [
SND_CHMAP_TRR
] = "Top Rear Right",

8424 [
SND_CHMAP_TRC
] = "Top Rear Center",

8425 [
SND_CHMAP_TFLC
] = "Top Front Left Center",

8426 [
SND_CHMAP_TFRC
] = "Top Front Right Center",

8427 [
SND_CHMAP_TSL
] = "Top Side Left",

8428 [
SND_CHMAP_TSR
] = "Top Side Right",

8429 [
SND_CHMAP_LLFE
] = "Left LFE",

8430 [
SND_CHMAP_RLFE
] = "Right LFE",

8431 [
SND_CHMAP_BC
] = "Bottom Center",

8432 [
SND_CHMAP_BLC
] = "Bottom Left Center",

8433 [
SND_CHMAP_BRC
] = "Bottom Right Center",

8441 c⁄° *
	$¢d_pcm_chm≠_l⁄g_«me
(
¢d_pcm_chm≠_posôi⁄
 
vÆ
)

8443 i‡(
vÆ
 <
SND_CHMAP_LAST
)

8444  
chm≠_l⁄g_«mes
[
vÆ
];

8446  
NULL
;

8447 
	}
}

8456 
	$¢d_pcm_chm≠_¥öt
(c⁄° 
¢d_pcm_chm≠_t
 *
m≠
, 
size_t
 
maxÀn
, *
buf
)

8458 
i
, 
Àn
 = 0;

8460 
i
 = 0; i < 
m≠
->
ch™√ls
; i++) {

8461 
p
 = 
m≠
->
pos
[
i
] & 
SND_CHMAP_POSITION_MASK
;

8462 i‡(
i
 > 0) {

8463 
Àn
 +
	`¢¥ötf
(
buf
 +Üí, 
maxÀn
 -Üen, " ");

8464 i‡(
Àn
 >
maxÀn
)

8465  -
ENOMEM
;

8467 i‡(
m≠
->
pos
[
i
] & 
SND_CHMAP_DRIVER_SPEC
)

8468 
Àn
 +
	`¢¥ötf
(
buf
 +Üí, 
maxÀn
 -Üí, "%d", 
p
);

8470 c⁄° *
«me
 = 
chm≠_«mes
[
p
];

8471 i‡(
«me
)

8472 
Àn
 +
	`¢¥ötf
(
buf
 +Üí, 
maxÀn
 -Üen,

8473 "%s", 
«me
);

8475 
Àn
 +
	`¢¥ötf
(
buf
 +Üí, 
maxÀn
 -Üen,

8476 "Ch%d", 
p
);

8478 i‡(
Àn
 >
maxÀn
)

8479  -
ENOMEM
;

8480 i‡(
m≠
->
pos
[
i
] & 
SND_CHMAP_PHASE_INVERSE
) {

8481 
Àn
 +
	`¢¥ötf
(
buf
 +Üí, 
maxÀn
 -Üen, "[INV]");

8482 i‡(
Àn
 >
maxÀn
)

8483  -
ENOMEM
;

8486  
Àn
;

8487 
	}
}

8489 
	$°r_to_chm≠
(c⁄° *
°r
, 
Àn
)

8491 
vÆ
;

8492 
v
;

8493 *
p
;

8495 i‡(
	`isdigô
(*
°r
)) {

8496 
v
 = 
	`°πoul
(
°r
, &
p
, 0);

8497 i‡(
v
 =
ULONG_MAX
)

8499 
vÆ
 = 
v
;

8500 
vÆ
 |
SND_CHMAP_DRIVER_SPEC
;

8501 
°r
 = 
p
;

8502 } i‡(!
	`°∫ˇ£cmp
(
°r
, "ch", 2)) {

8503 
v
 = 
	`°πoul
(
°r
 + 2, &
p
, 0);

8504 i‡(
v
 =
ULONG_MAX
)

8506 
vÆ
 = 
v
;

8507 
°r
 = 
p
;

8509 
vÆ
 = 0; vÆ <
SND_CHMAP_LAST
; val++) {

8510 
¶í
;

8511 
	`as£π
(
chm≠_«mes
[
vÆ
]);

8512 
¶í
 = 
	`°æí
(
chm≠_«mes
[
vÆ
]);

8513 i‡(
¶í
 > 
Àn
)

8515 i‡(!
	`°∫ˇ£cmp
(
°r
, 
chm≠_«mes
[
vÆ
], 
¶í
) &&

8516 !
	`ißÕha
(
°r
[
¶í
])) {

8517 
°r
 +
¶í
;

8521 i‡(
vÆ
 > 
SND_CHMAP_LAST
)

8524 i‡(
°r
 && !
	`°∫ˇ£cmp
(str, "[INV]", 5))

8525 
vÆ
 |
SND_CHMAP_PHASE_INVERSE
;

8526  
vÆ
;

8527 
	}
}

8534 
	$¢d_pcm_chm≠_‰om_°rög
(c⁄° *
°r
)

8536  
	`°r_to_chm≠
(
°r
, 
	`°æí
(str));

8537 
	}
}

8546 
¢d_pcm_chm≠_t
 *
	$¢d_pcm_chm≠_∑r£_°rög
(c⁄° *
°r
)

8548 
i
, 
ch
 = 0;

8549 
tmp_m≠
[64];

8550 
¢d_pcm_chm≠_t
 *
m≠
;

8553 c⁄° *
p
;

8554 
Àn
, 
vÆ
;

8556 i‡(
ch
 >()((
tmp_m≠
) / (tmp_map[0])))

8557  
NULL
;

8558 
p
 = 
°r
; *∞&& 
	`iß um
(*p);Ö++)

8560 
Àn
 = 
p
 - 
°r
;

8561 i‡(!
Àn
)

8562  
NULL
;

8563 
vÆ
 = 
	`°r_to_chm≠
(
°r
, 
Àn
);

8564 i‡(
vÆ
 < 0)

8565  
NULL
;

8566 
°r
 +
Àn
;

8567 i‡(*
°r
 == '[') {

8568 i‡(!
	`°∫cmp
(
°r
, "[INV]", 5)) {

8569 
vÆ
 |
SND_CHMAP_PHASE_INVERSE
;

8570 
°r
 += 5;

8573 
tmp_m≠
[
ch
] = 
vÆ
;

8574 
ch
++;

8575 ; *
°r
 && !
	`iß um
(*str); str++)

8577 i‡(!*
°r
)

8580 
m≠
 = 
	`mÆloc
((*m≠Ë+ 
ch
 * ());

8581 i‡(!
m≠
)

8582  
NULL
;

8583 
m≠
->
ch™√ls
 = 
ch
;

8584 
i
 = 0; i < 
ch
; i++)

8585 
m≠
->
pos
[
i
] = 
tmp_m≠
[i];

8586  
m≠
;

8587 
	}
}

8590 
	$_c›y_to_fixed_quîy_m≠
(
¢d_pcm_chm≠_quîy_t
 **
d°
,

8591 c⁄° 
¢d_pcm_chm≠_t
 *
§c
)

8593 *
d°
 = 
	`mÆloc
((
§c
->
ch™√ls
 + 2) * ());

8594 i‡(!*
d°
)

8595  -
ENOMEM
;

8596 (*
d°
)->
ty≥
 = 
SND_CHMAP_TYPE_FIXED
;

8597 
	`mem˝y
(&(*
d°
)->
m≠
, 
§c
, (§c->
ch™√ls
 + 1) * ());

8599 
	}
}

8601 #i‚de‡
DOC_HIDDEN


8603 
¢d_pcm_chm≠_quîy_t
 **

8604 
	$_¢d_pcm_make_sögÀ_quîy_chm≠s
(c⁄° 
¢d_pcm_chm≠_t
 *
§c
)

8606 
¢d_pcm_chm≠_quîy_t
 **
m≠s
;

8608 
m≠s
 = 
	`ˇŒoc
(2, (*maps));

8609 i‡(!
m≠s
)

8610  
NULL
;

8611 i‡(
	`_c›y_to_fixed_quîy_m≠
(
m≠s
, 
§c
)) {

8612 
	`‰ì
(
m≠s
);

8613  
NULL
;

8615  
m≠s
;

8616 
	}
}

8619 
¢d_pcm_chm≠_t
 *
	$_¢d_pcm_c›y_chm≠
(c⁄° 
¢d_pcm_chm≠_t
 *
§c
)

8621 
¢d_pcm_chm≠_t
 *
m≠
;

8623 
m≠
 = 
	`mÆloc
((
§c
->
ch™√ls
 + 1) * ());

8624 i‡(!
m≠
)

8625  
NULL
;

8626 
	`mem˝y
(
m≠
, 
§c
, (§c->
ch™√ls
 + 1) * ());

8627  
m≠
;

8628 
	}
}

8631 
¢d_pcm_chm≠_quîy_t
 **

8632 
	$_¢d_pcm_c›y_chm≠_quîy
(
¢d_pcm_chm≠_quîy_t
 * c⁄° *
§c
)

8634 
¢d_pcm_chm≠_quîy_t
 * c⁄° *
p
;

8635 
¢d_pcm_chm≠_quîy_t
 **
m≠s
;

8636 
i
, 
nums
;

8638 
nums
 = 0, 
p
 = 
§c
; *p;Ö++)

8639 
nums
++;

8641 
m≠s
 = 
	`ˇŒoc
(
nums
 + 1, (*maps));

8642 i‡(!
m≠s
)

8643  
NULL
;

8644 
i
 = 0; i < 
nums
; i++) {

8645 
m≠s
[
i
] = 
	`mÆloc
((
§c
[i]->
m≠
.
ch™√ls
 + 2) * ());

8646 i‡(!
m≠s
[
i
]) {

8647 
	`¢d_pcm_‰ì_chm≠s
(
m≠s
);

8648  
NULL
;

8650 
	`mem˝y
(
m≠s
[
i
], 
§c
[i], (§c[i]->
m≠
.
ch™√ls
 + 2) * ());

8652  
m≠s
;

8653 
	}
}

8656 
¢d_pcm_chm≠_t
 *

8657 
	$_¢d_pcm_choo£_fixed_chm≠
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chm≠_quîy_t
 * c⁄° *
m≠s
)

8659 
¢d_pcm_chm≠_quîy_t
 * c⁄° *
p
;

8661 
p
 = 
m≠s
; *p;Ö++) {

8662 i‡((*
p
)->
m≠
.
ch™√ls
 =
pcm
->channels)

8663  
	`_¢d_pcm_c›y_chm≠
(&(*
p
)->
m≠
);

8665  
NULL
;

8666 
	}
}

8671 
¢d_pcm_chm≠_quîy_t
 **

8672 
	$_¢d_pcm_∑r£_c⁄fig_chm≠s
(
¢d_c⁄fig_t
 *
c⁄f
)

8674 
¢d_pcm_chm≠_t
 *
chm≠
;

8675 
¢d_pcm_chm≠_quîy_t
 **
m≠s
;

8676 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

8677 c⁄° *
°r
;

8678 
nums
, 
îr
;

8680 i‡(
	`¢d_c⁄fig_gë_ty≥
(
c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
)

8681  
NULL
;

8683 
nums
 = 0;

8684 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

8685 
nums
++;

8688 
m≠s
 = 
	`ˇŒoc
(
nums
 + 1, (*maps));

8689 i‡(!
m≠s
)

8690  
NULL
;

8692 
nums
 = 0;

8693 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

8694 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

8695 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
);

8696 i‡(
îr
 < 0)

8697 
îr‹
;

8698 
chm≠
 = 
	`¢d_pcm_chm≠_∑r£_°rög
(
°r
);

8699 i‡(!
chm≠
)

8700 
îr‹
;

8701 i‡(
	`_c›y_to_fixed_quîy_m≠
(
m≠s
 + 
nums
, 
chm≠
)) {

8702 
	`‰ì
(
chm≠
);

8703 
îr‹
;

8705 
	`‰ì
(
chm≠
);

8706 
nums
++;

8708  
m≠s
;

8710 
îr‹
:

8711 
	`¢d_pcm_‰ì_chm≠s
(
m≠s
);

8712  
NULL
;

8713 
	}
}

8737 
	$¢d_pcm_ªcovî
(
¢d_pcm_t
 *
pcm
, 
îr
, 
sûít
)

8739 i‡(
îr
 > 0)

8740 
îr
 = -err;

8741 i‡(
îr
 =-
EINTR
)

8743 i‡(
îr
 =-
EPIPE
) {

8744 c⁄° *
s
;

8745 i‡(
	`¢d_pcm_°ªam
(
pcm
Ë=
SND_PCM_STREAM_PLAYBACK
)

8746 
s
 = "underrun";

8748 
s
 = "overrun";

8749 i‡(!
sûít
)

8750 
	`SNDERR
("%†occuºed", 
s
);

8751 
îr
 = 
	`¢d_pcm_¥ï¨e
(
pcm
);

8752 i‡(
îr
 < 0) {

8753 
	`SNDERR
("ˇ¬ŸÑecovîy from %s,Öª∑ª faûed: %s", 
s
, 
	`¢d_°ªº‹
(
îr
));

8754  
îr
;

8758 i‡(
îr
 =-
ESTRPIPE
) {

8759 (
îr
 = 
	`¢d_pcm_ªsume
(
pcm
)Ë=-
EAGAIN
)

8761 
	`pﬁl
(
NULL
, 0, 1000);

8762 i‡(
îr
 < 0) {

8763 
îr
 = 
	`¢d_pcm_¥ï¨e
(
pcm
);

8764 i‡(
îr
 < 0) {

8765 
	`SNDERR
("ˇ¬ŸÑecovîy from su•íd,Öª∑ª faûed: %s", 
	`¢d_°ªº‹
(
îr
));

8766  
îr
;

8771  
îr
;

8772 
	}
}

8785 
	$¢d_pcm_£t_∑øms
(
¢d_pcm_t
 *
pcm
,

8786 
¢d_pcm_f‹m©_t
 
f‹m©
,

8787 
¢d_pcm_ac˚ss_t
 
ac˚ss
,

8788 
ch™√ls
,

8789 
øã
,

8790 
so·_ªßm∂e
,

8791 
œãncy
)

8793 
¢d_pcm_hw_∑øms_t
 
∑øms_ßved
, 
∑øms
 = {0};

8794 
¢d_pcm_sw_∑øms_t
 
sw∑øms
 = {0};

8795 c⁄° *
s
 = 
	`¢d_pcm_°ªam_«me
(
	`¢d_pcm_°ªam
(
pcm
));

8796 
¢d_pcm_u‰ames_t
 
buf„r_size
, 
≥riod_size
;

8797 
º©e
, 
≥riod_time
;

8798 
îr
;

8800 
	`as£π
(
pcm
);

8802 
îr
 = 
	`¢d_pcm_hw_∑øms_™y
(
pcm
, &
∑øms
);

8803 i‡(
îr
 < 0) {

8804 
	`SNDERR
("Broken configuration for %s:Ço configurationsávailable",

8805 
s
);

8806  
îr
;

8809 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_øã_ªßm∂e
(
pcm
, &
∑øms
, 
so·_ªßm∂e
);

8810 i‡(
îr
 < 0) {

8811 
	`SNDERR
("Resampling setup failed for %s: %s",

8812 
s
, 
	`¢d_°ªº‹
(
îr
));

8813  
îr
;

8816 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_ac˚ss
(
pcm
, &
∑øms
, 
ac˚ss
);

8817 i‡(
îr
 < 0) {

8818 
	`SNDERR
("AccessÅypeÇotávailable for %s: %s",

8819 
s
, 
	`¢d_°ªº‹
(
îr
));

8820  
îr
;

8823 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_f‹m©
(
pcm
, &
∑øms
, 
f‹m©
);

8824 i‡(
îr
 < 0) {

8825 
	`SNDERR
("Sample formatÇotávailable for %s: %s",

8826 
s
, 
	`¢d_°ªº‹
(
îr
));

8827  
îr
;

8830 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_ch™√ls
(
pcm
, &
∑øms
, 
ch™√ls
);

8831 i‡(
îr
 < 0) {

8832 
	`SNDERR
("Channels count (%i)Çotávailable for %s: %s",

8833 
ch™√ls
, 
s
, 
	`¢d_°ªº‹
(
îr
));

8834  
îr
;

8837 
º©e
 = 
øã
;

8838 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_øã_√¨
)(
pcm
, &
∑øms
, &
º©e
,

8840 i‡(
îr
 < 0) {

8841 
	`SNDERR
("Rate %iHzÇotávailable forÖlayback: %s",

8842 
øã
, 
	`¢d_°ªº‹
(
îr
));

8843  
îr
;

8845 i‡(
º©e
 !
øã
) {

8846 
	`SNDERR
("Rate doesn't match (requested %iHz, get %iHz)",

8847 
øã
, 
º©e
);

8848  -
EINVAL
;

8851 
∑øms_ßved
 = 
∑øms
;

8852 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_time_√¨
)(
pcm
, &
∑øms
,

8853 &
œãncy
, 
NULL
);

8854 i‡(
îr
 < 0) {

8856 
∑øms
 = 
∑øms_ßved
;

8858 
≥riod_time
 = 
œãncy
 / 4;

8859 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_time_√¨
)(
pcm
,

8860 &
∑øms
, &
≥riod_time
, 
NULL
);

8861 i‡(
îr
 < 0) {

8862 
	`SNDERR
("UnableÅo setÖeriodÅime %i for %s: %s",

8863 
≥riod_time
, 
s
, 
	`¢d_°ªº‹
(
îr
));

8864  
îr
;

8866 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_size
)(&
∑øms
,

8867 &
≥riod_size
, 
NULL
);

8868 i‡(
îr
 < 0) {

8869 
	`SNDERR
("UnableÅo getÖeriod size for %s: %s",

8870 
s
, 
	`¢d_°ªº‹
(
îr
));

8871  
îr
;

8873 
buf„r_size
 = 
≥riod_size
 * 4;

8874 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_size_√¨
)(
pcm
,

8875 &
∑øms
, &
buf„r_size
);

8876 i‡(
îr
 < 0) {

8877 
	`SNDERR
("UnableÅo set buffer size %lu %s: %s",

8878 
buf„r_size
, 
s
, 
	`¢d_°ªº‹
(
îr
));

8879  
îr
;

8881 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_size
)(&
∑øms
,

8882 &
buf„r_size
);

8883 i‡(
îr
 < 0) {

8884 
	`SNDERR
("UnableÅo get buffer size for %s: %s",

8885 
s
, 
	`¢d_°ªº‹
(
îr
));

8886  
îr
;

8890 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_size
)(&
∑øms
,

8891 &
buf„r_size
);

8892 i‡(
îr
 < 0) {

8893 
	`SNDERR
("UnableÅo get buffer size for %s: %s",

8894 
s
, 
	`¢d_°ªº‹
(
îr
));

8895  
îr
;

8897 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_time
)(&
∑øms
,

8898 &
œãncy
, 
NULL
);

8899 i‡(
îr
 < 0) {

8900 
	`SNDERR
("UnableÅo get bufferÅime (latency) for %s: %s",

8901 
s
, 
	`¢d_°ªº‹
(
îr
));

8902  
îr
;

8905 
≥riod_time
 = 
œãncy
 / 4;

8906 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_time_√¨
)(
pcm
,

8907 &
∑øms
, &
≥riod_time
, 
NULL
);

8908 i‡(
îr
 < 0) {

8909 
	`SNDERR
("UnableÅo setÖeriodÅime %i for %s: %s",

8910 
≥riod_time
, 
s
, 
	`¢d_°ªº‹
(
îr
));

8911  
îr
;

8913 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_size
)(&
∑øms
,

8914 &
≥riod_size
, 
NULL
);

8915 i‡(
îr
 < 0) {

8916 
	`SNDERR
("UnableÅo getÖeriod size for %s: %s",

8917 
s
, 
	`¢d_°ªº‹
(
îr
));

8918  
îr
;

8922 
îr
 = 
	`¢d_pcm_hw_∑øms
(
pcm
, &
∑øms
);

8923 i‡(
îr
 < 0) {

8924 
	`SNDERR
("UnableÅo set hwÖarams for %s: %s",

8925 
s
, 
	`¢d_°ªº‹
(
îr
));

8926  
îr
;

8930 
îr
 = 
	`¢d_pcm_sw_∑øms_cuºít
(
pcm
, &
sw∑øms
);

8931 i‡(
îr
 < 0) {

8932 
	`SNDERR
("UnableÅo determine current swparams for %s: %s",

8933 
s
, 
	`¢d_°ªº‹
(
îr
));

8934  
îr
;

8940 
îr
 = 
	`¢d_pcm_sw_∑øms_£t_°¨t_thªshﬁd
(
pcm
, &
sw∑øms
,

8941 (
buf„r_size
 / 
≥riod_size
) *Öeriod_size);

8942 i‡(
îr
 < 0) {

8943 
	`SNDERR
("UnableÅo set startÅhreshold mode for %s: %s",

8944 
s
, 
	`¢d_°ªº‹
(
îr
));

8945  
îr
;

8951 
îr
 = 
	`¢d_pcm_sw_∑øms_£t_avaû_mö
(
pcm
, &
sw∑øms
, 
≥riod_size
);

8952 i‡(
îr
 < 0) {

8953 
	`SNDERR
("UnableÅo setávail min for %s: %s",

8954 
s
, 
	`¢d_°ªº‹
(
îr
));

8955  
îr
;

8958 
îr
 = 
	`¢d_pcm_sw_∑øms
(
pcm
, &
sw∑øms
);

8959 i‡(
îr
 < 0) {

8960 
	`SNDERR
("UnableÅo set swÖarams for %s: %s",

8961 
s
, 
	`¢d_°ªº‹
(
îr
));

8962  
îr
;

8965 
	}
}

8974 
	$¢d_pcm_gë_∑øms
(
¢d_pcm_t
 *
pcm
,

8975 
¢d_pcm_u‰ames_t
 *
buf„r_size
,

8976 
¢d_pcm_u‰ames_t
 *
≥riod_size
)

8978 
¢d_pcm_hw_∑øms_t
 
∑øms
 = {0};

8979 
îr
;

8981 
	`as£π
(
pcm
);

8982 
îr
 = 
	`¢d_pcm_hw_∑øms_cuºít
(
pcm
, &
∑øms
);

8983 i‡(
îr
 < 0)

8984  
îr
;

8985 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_size
)(&
∑øms
, 
buf„r_size
);

8986 i‡(
îr
 < 0)

8987  
îr
;

8988  
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_size
)(&
∑øms
, 
≥riod_size
,

8989 
NULL
);

8990 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_adpcm.c

59 
	~"pcm_loˇl.h
"

60 
	~"pcm_∂ugö.h
"

61 
	~"∂ugö_›s.h
"

62 
	~"bsw≠.h
"

64 #i‚de‡
PIC


66 c⁄° *
	g_¢d_moduÀ_pcm_adpcm
 = "";

69 #i‚de‡
DOC_HIDDEN


71 (*
	tadpcm_f
)(c⁄° 
	t¢d_pcm_ch™√l_¨ó_t
 *
	td°_¨ós
,

72 
	t¢d_pcm_u‰ames_t
 
	td°_off£t
,

73 c⁄° 
	t¢d_pcm_ch™√l_¨ó_t
 *
	t§c_¨ós
,

74 
	t¢d_pcm_u‰ames_t
 
	t§c_off£t
,

75 
	tch™√ls
, 
	t¢d_pcm_u‰ames_t
 
	t‰ames
,

76 
	tgëputidx
,

77 
	t¢d_pcm_adpcm_°©e_t
 *
	t°©es
);

81 
¢d_pcm_∂ugö_t
 
∂ug
;

82 
gëput_idx
;

83 
adpcm_f
 
func
;

84 
¢d_pcm_f‹m©_t
 
sf‹m©
;

85 
¢d_pcm_adpcm_°©e_t
 *
°©es
;

86 } 
	t¢d_pcm_adpcm_t
;

91 c⁄° 
IndexAdju°
[8] = { -1, -1, -1, -1, 2, 4, 6, 8 
	}
};

94 c⁄° 
	gSãpSize
[89] = {

106 
	$adpcm_ícodî
(
¶
, 
¢d_pcm_adpcm_°©e_t
 * 
°©e
)

108 
diff
;

109 
¥ed_diff
;

111 
sign
;

112 
°ï
;

113 
adju°_idx
;

115 
i
;

118 
diff
 = 
¶
 - 
°©e
->
¥ed_vÆ
;

119 
sign
 = (
diff
 < 0) ? 0x8 : 0x0;

120 i‡(
sign
) {

121 
diff
 = -diff;

134 
°ï
 = 
SãpSize
[
°©e
->
°ï_idx
];

137 
¥ed_diff
 = 
°ï
 >> 3;

138 
adju°_idx
 = 0, 
i
 = 0x4; i; i >>1, 
°ï
 >>= 1) {

139 i‡(
diff
 >
°ï
) {

140 
adju°_idx
 |
i
;

141 
diff
 -
°ï
;

142 
¥ed_diff
 +
°ï
;

147 
°©e
->
¥ed_vÆ
 +
sign
 ? -
¥ed_diff
 :Öred_diff;

149 i‡(
°©e
->
¥ed_vÆ
 > 32767) {

150 
°©e
->
¥ed_vÆ
 = 32767;

151 } i‡(
°©e
->
¥ed_vÆ
 < -32768) {

152 
°©e
->
¥ed_vÆ
 = -32768;

156 
°©e
->
°ï_idx
 +
IndexAdju°
[
adju°_idx
];

158 i‡(
°©e
->
°ï_idx
 < 0) {

159 
°©e
->
°ï_idx
 = 0;

160 } i‡(
°©e
->
°ï_idx
 > 88) {

161 
°©e
->
°ï_idx
 = 88;

163  (
sign
 | 
adju°_idx
);

164 
	}
}

167 
	$adpcm_decodî
(
code
, 
¢d_pcm_adpcm_°©e_t
 * 
°©e
)

169 
¥ed_diff
;

170 
°ï
;

171 
sign
;

173 
i
;

176 
sign
 = 
code
 & 0x8;

177 
code
 &= 0x7;

184 
°ï
 = 
SãpSize
[
°©e
->
°ï_idx
];

187 
¥ed_diff
 = 
°ï
 >> 3;

188 
i
 = 0x4; i; i >>1, 
°ï
 >>= 1) {

189 i‡(
code
 & 
i
) {

190 
¥ed_diff
 +
°ï
;

193 
°©e
->
¥ed_vÆ
 +(
sign
Ë? -
¥ed_diff
 :Öred_diff;

196 i‡(
°©e
->
¥ed_vÆ
 > 32767) {

197 
°©e
->
¥ed_vÆ
 = 32767;

198 } i‡(
°©e
->
¥ed_vÆ
 < -32768) {

199 
°©e
->
¥ed_vÆ
 = -32768;

203 
°©e
->
°ï_idx
 +
IndexAdju°
[
code
];

205 i‡(
°©e
->
°ï_idx
 < 0) {

206 
°©e
->
°ï_idx
 = 0;

207 } i‡(
°©e
->
°ï_idx
 > 88) {

208 
°©e
->
°ï_idx
 = 88;

210  (
°©e
->
¥ed_vÆ
);

211 
	}
}

213 #i‚de‡
DOC_HIDDEN


215 
	$¢d_pcm_adpcm_decode
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

216 
¢d_pcm_u‰ames_t
 
d°_off£t
,

217 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

218 
¢d_pcm_u‰ames_t
 
§c_off£t
,

219 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

220 
putidx
,

221 
¢d_pcm_adpcm_°©e_t
 *
°©es
)

223 
	#PUT16_LABELS


	)

224 
	~"∂ugö_›s.h
"

225 #unde‡
PUT16_LABELS


226 *
put
 = 
put16_œbñs
[
putidx
];

227 
ch™√l
;

228 
ch™√l
 = 0; ch™√»< 
ch™√ls
; ++ch™√l, ++
°©es
) {

229 c⁄° *
§c
;

230 
§cbô
;

231 *
d°
;

232 
§c_°ï
, 
§cbô_°ï
, 
d°_°ï
;

233 
¢d_pcm_u‰ames_t
 
‰ames1
;

234 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

235 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

236 
§cbô
 = 
§c_¨ó
->
fú°
 + src_¨ó->
°ï
 * 
§c_off£t
;

237 
§c
 = (c⁄° *Ë
§c_¨ó
->
addr
 + 
§cbô
 / 8;

238 
§cbô
 %= 8;

239 
§c_°ï
 = 
§c_¨ó
->
°ï
 / 8;

240 
§cbô_°ï
 = 
§c_¨ó
->
°ï
 % 8;

241 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

242 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
);

243 
‰ames1
 = 
‰ames
;

244 
‰ames1
-- > 0) {

245 
öt16_t
 
ßm∂e
;

246 
v
;

247 i‡(
§cbô
)

248 
v
 = *
§c
 & 0x0f;

250 
v
 = (*
§c
 >> 4) & 0x0f;

251 
ßm∂e
 = 
	`adpcm_decodî
(
v
, 
°©es
);

252 *
put
;

253 
	#PUT16_END
 
a·î


	)

254 
	~"∂ugö_›s.h
"

255 #unde‡
PUT16_END


256 
a·î
:

257 
§c
 +
§c_°ï
;

258 
§cbô
 +
§cbô_°ï
;

259 i‡(
§cbô
 == 8) {

260 
§c
++;

261 
§cbô
 = 0;

263 
d°
 +
d°_°ï
;

266 
	}
}

268 
	$¢d_pcm_adpcm_ícode
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

269 
¢d_pcm_u‰ames_t
 
d°_off£t
,

270 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

271 
¢d_pcm_u‰ames_t
 
§c_off£t
,

272 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

273 
gëidx
,

274 
¢d_pcm_adpcm_°©e_t
 *
°©es
)

276 
	#GET16_LABELS


	)

277 
	~"∂ugö_›s.h
"

278 #unde‡
GET16_LABELS


279 *
gë
 = 
gë16_œbñs
[
gëidx
];

280 
ch™√l
;

281 
öt16_t
 
ßm∂e
 = 0;

282 
ch™√l
 = 0; ch™√»< 
ch™√ls
; ++ch™√l, ++
°©es
) {

283 c⁄° *
§c
;

284 *
d°
;

285 
d°bô
;

286 
§c_°ï
, 
d°_°ï
, 
d°bô_°ï
;

287 
¢d_pcm_u‰ames_t
 
‰ames1
;

288 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

289 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

290 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

291 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
);

292 
d°bô
 = 
d°_¨ó
->
fú°
 + d°_¨ó->
°ï
 * 
d°_off£t
;

293 
d°
 = (*Ë
d°_¨ó
->
addr
 + 
d°bô
 / 8;

294 
d°bô
 %= 8;

295 
d°_°ï
 = 
d°_¨ó
->
°ï
 / 8;

296 
d°bô_°ï
 = 
d°_¨ó
->
°ï
 % 8;

297 
‰ames1
 = 
‰ames
;

298 
‰ames1
-- > 0) {

299 
v
;

300 *
gë
;

301 
	#GET16_END
 
a·î


	)

302 
	~"∂ugö_›s.h
"

303 #unde‡
GET16_END


304 
a·î
:

305 
v
 = 
	`adpcm_ícodî
(
ßm∂e
, 
°©es
);

306 i‡(
d°bô
)

307 *
d°
 = (*d° & 0xf0Ë| 
v
;

309 *
d°
 = (*d° & 0x0fË| (
v
 << 4);

310 
§c
 +
§c_°ï
;

311 
d°
 +
d°_°ï
;

312 
d°bô
 +
d°bô_°ï
;

313 i‡(
d°bô
 == 8) {

314 
d°
++;

315 
d°bô
 = 0;

319 
	}
}

323 
	$¢d_pcm_adpcm_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

325 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
¥iv©e_d©a
;

326 
îr
;

327 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

328 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

329 &
ac˚ss_mask
);

330 i‡(
îr
 < 0)

331  
îr
;

332 i‡(
adpcm
->
sf‹m©
 =
SND_PCM_FORMAT_IMA_ADPCM
) {

333 
¢d_pcm_f‹m©_mask_t
 
f‹m©_mask
 = { 
SND_PCM_FMTBIT_LINEAR
 };

334 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
,

335 &
f‹m©_mask
);

337 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
∑øms
,

338 
SND_PCM_FORMAT_IMA_ADPCM
);

340 i‡(
îr
 < 0)

341  
îr
;

342 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
∑øms
,

343 
SND_PCM_SUBFORMAT_STD
);

344 i‡(
îr
 < 0)

345  
îr
;

346 
∑øms
->
öfo
 &~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

348 
	}
}

350 
	$¢d_pcm_adpcm_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

352 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
¥iv©e_d©a
;

353 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

354 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

355 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

356 &
ßc˚ss_mask
);

357 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
•¨ams
, 
adpcm
->
sf‹m©
);

358 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
•¨ams
, 
SND_PCM_SUBFORMAT_STD
);

360 
	}
}

362 
	$¢d_pcm_adpcm_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

363 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

365 
îr
;

366 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

367 
SND_PCM_HW_PARBIT_RATE
 |

368 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

369 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

370 
SND_PCM_HW_PARBIT_PERIODS
 |

371 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

372 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

373 
SND_PCM_HW_PARBIT_TICK_TIME
);

374 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

375 i‡(
îr
 < 0)

376  
îr
;

378 
	}
}

380 
	$¢d_pcm_adpcm_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

381 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

383 
îr
;

384 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

385 
SND_PCM_HW_PARBIT_RATE
 |

386 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

387 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

388 
SND_PCM_HW_PARBIT_PERIODS
 |

389 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

390 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

391 
SND_PCM_HW_PARBIT_TICK_TIME
);

392 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

393 i‡(
îr
 < 0)

394  
îr
;

396 
	}
}

398 
	$¢d_pcm_adpcm_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

400  
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

401 
¢d_pcm_adpcm_hw_ªföe_˝ª∑ª
,

402 
¢d_pcm_adpcm_hw_ªföe_cch™ge
,

403 
¢d_pcm_adpcm_hw_ªföe_•ª∑ª
,

404 
¢d_pcm_adpcm_hw_ªföe_sch™ge
,

405 
¢d_pcm_gíîic_hw_ªföe
);

406 
	}
}

408 
	$¢d_pcm_adpcm_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 * 
∑øms
)

410 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
¥iv©e_d©a
;

411 
¢d_pcm_f‹m©_t
 
f‹m©
;

412 
îr
 = 
	`¢d_pcm_hw_∑øms_¶ave
(
pcm
, 
∑øms
,

413 
¢d_pcm_adpcm_hw_ªföe_cch™ge
,

414 
¢d_pcm_adpcm_hw_ªföe_•ª∑ª
,

415 
¢d_pcm_adpcm_hw_ªföe_sch™ge
,

416 
¢d_pcm_gíîic_hw_∑øms
);

417 i‡(
îr
 < 0)

418  
îr
;

420 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(
∑øms
, &
f‹m©
);

421 i‡(
îr
 < 0)

422  
îr
;

424 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

425 i‡(
adpcm
->
sf‹m©
 =
SND_PCM_FORMAT_IMA_ADPCM
) {

426 
adpcm
->
gëput_idx
 = 
	`¢d_pcm_löór_gë_ödex
(
f‹m©
, 
SND_PCM_FORMAT_S16
);

427 
adpcm
->
func
 = 
¢d_pcm_adpcm_ícode
;

429 
adpcm
->
gëput_idx
 = 
	`¢d_pcm_löór_put_ödex
(
SND_PCM_FORMAT_S16
,ádpcm->
sf‹m©
);

430 
adpcm
->
func
 = 
¢d_pcm_adpcm_decode
;

433 i‡(
adpcm
->
sf‹m©
 =
SND_PCM_FORMAT_IMA_ADPCM
) {

434 
adpcm
->
gëput_idx
 = 
	`¢d_pcm_löór_put_ödex
(
SND_PCM_FORMAT_S16
, 
f‹m©
);

435 
adpcm
->
func
 = 
¢d_pcm_adpcm_decode
;

437 
adpcm
->
gëput_idx
 = 
	`¢d_pcm_löór_gë_ödex
◊dpcm->
sf‹m©
, 
SND_PCM_FORMAT_S16
);

438 
adpcm
->
func
 = 
¢d_pcm_adpcm_ícode
;

441 
	`as£π
(!
adpcm
->
°©es
);

442 
adpcm
->
°©es
 = 
	`mÆloc
◊dpcm->
∂ug
.
gí
.
¶ave
->
ch™√ls
 * (*adpcm->states));

443 i‡(
adpcm
->
°©es
 =
NULL
)

444  -
ENOMEM
;

446 
	}
}

448 
	$¢d_pcm_adpcm_hw_‰ì
(
¢d_pcm_t
 *
pcm
)

450 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
¥iv©e_d©a
;

451 
	`‰ì
(
adpcm
->
°©es
);

452 
adpcm
->
°©es
 = 
NULL
;

453  
	`¢d_pcm_hw_‰ì
(
adpcm
->
∂ug
.
gí
.
¶ave
);

454 
	}
}

456 
	$¢d_pcm_adpcm_öô
(
¢d_pcm_t
 *
pcm
)

458 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
¥iv©e_d©a
;

459 
k
;

460 
k
 = 0; k < 
pcm
->
ch™√ls
; ++k) {

461 
adpcm
->
°©es
[
k
].
¥ed_vÆ
 = 0;

462 
adpcm
->
°©es
[
k
].
°ï_idx
 = 0;

465 
	}
}

467 
¢d_pcm_u‰ames_t


468 
	$¢d_pcm_adpcm_wrôe_¨ós
(
¢d_pcm_t
 *
pcm
,

469 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

470 
¢d_pcm_u‰ames_t
 
off£t
,

471 
¢d_pcm_u‰ames_t
 
size
,

472 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

473 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

474 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

476 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
¥iv©e_d©a
;

477 i‡(
size
 > *
¶ave_sizï
)

478 
size
 = *
¶ave_sizï
;

479 
adpcm
->
	`func
(
¶ave_¨ós
, 
¶ave_off£t
,

480 
¨ós
, 
off£t
,

481 
pcm
->
ch™√ls
, 
size
,

482 
adpcm
->
gëput_idx
,ádpcm->
°©es
);

483 *
¶ave_sizï
 = 
size
;

484  
size
;

485 
	}
}

487 
¢d_pcm_u‰ames_t


488 
	$¢d_pcm_adpcm_ªad_¨ós
(
¢d_pcm_t
 *
pcm
,

489 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

490 
¢d_pcm_u‰ames_t
 
off£t
,

491 
¢d_pcm_u‰ames_t
 
size
,

492 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

493 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

494 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

496 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
¥iv©e_d©a
;

497 i‡(
size
 > *
¶ave_sizï
)

498 
size
 = *
¶ave_sizï
;

499 
adpcm
->
	`func
(
¨ós
, 
off£t
,

500 
¶ave_¨ós
, 
¶ave_off£t
,

501 
pcm
->
ch™√ls
, 
size
,

502 
adpcm
->
gëput_idx
,ádpcm->
°©es
);

503 *
¶ave_sizï
 = 
size
;

504  
size
;

505 
	}
}

507 
	$¢d_pcm_adpcm_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

509 
¢d_pcm_adpcm_t
 *
adpcm
 = 
pcm
->
¥iv©e_d©a
;

510 
	`¢d_ouçut_¥ötf
(
out
, "Ima-ADPCM conversion PCM (%s)\n",

511 
	`¢d_pcm_f‹m©_«me
(
adpcm
->
sf‹m©
));

512 i‡(
pcm
->
£tup
) {

513 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

514 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

516 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

517 
	`¢d_pcm_dump
(
adpcm
->
∂ug
.
gí
.
¶ave
, 
out
);

518 
	}
}

520 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_adpcm_›s
 = {

521 .
˛o£
 = 
¢d_pcm_gíîic_˛o£
,

522 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

523 .
	ghw_ªföe
 = 
¢d_pcm_adpcm_hw_ªföe
,

524 .
	ghw_∑øms
 = 
¢d_pcm_adpcm_hw_∑øms
,

525 .
	ghw_‰ì
 = 
¢d_pcm_adpcm_hw_‰ì
,

526 .
	gsw_∑øms
 = 
¢d_pcm_gíîic_sw_∑øms
,

527 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

528 .
	gdump
 = 
¢d_pcm_adpcm_dump
,

529 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

530 .
	gasync
 = 
¢d_pcm_gíîic_async
,

531 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

532 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

533 .
	gquîy_chm≠s
 = 
¢d_pcm_gíîic_quîy_chm≠s
,

534 .
	ggë_chm≠
 = 
¢d_pcm_gíîic_gë_chm≠
,

535 .
	g£t_chm≠
 = 
¢d_pcm_gíîic_£t_chm≠
,

550 
	$¢d_pcm_adpcm_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
, 
¢d_pcm_f‹m©_t
 
sf‹m©
, snd_pcm_à*
¶ave
, 
˛o£_¶ave
)

552 
¢d_pcm_t
 *
pcm
;

553 
¢d_pcm_adpcm_t
 *
adpcm
;

554 
îr
;

555 
	`as£π
(
pcmp
 && 
¶ave
);

556 i‡(
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1 &&

557 
sf‹m©
 !
SND_PCM_FORMAT_IMA_ADPCM
)

558  -
EINVAL
;

559 
adpcm
 = 
	`ˇŒoc
(1, (
¢d_pcm_adpcm_t
));

560 i‡(!
adpcm
) {

561  -
ENOMEM
;

563 
adpcm
->
sf‹m©
 = sformat;

564 
	`¢d_pcm_∂ugö_öô
(&
adpcm
->
∂ug
);

565 
adpcm
->
∂ug
.
ªad
 = 
¢d_pcm_adpcm_ªad_¨ós
;

566 
adpcm
->
∂ug
.
wrôe
 = 
¢d_pcm_adpcm_wrôe_¨ós
;

567 
adpcm
->
∂ug
.
öô
 = 
¢d_pcm_adpcm_öô
;

568 
adpcm
->
∂ug
.
gí
.
¶ave
 = slave;

569 
adpcm
->
∂ug
.
gí
.
˛o£_¶ave
 = close_slave;

571 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_ADPCM
, 
«me
, 
¶ave
->
°ªam
, sœve->
mode
);

572 i‡(
îr
 < 0) {

573 
	`‰ì
(
adpcm
);

574  
îr
;

576 
pcm
->
›s
 = &
¢d_pcm_adpcm_›s
;

577 
pcm
->
Á°_›s
 = &
¢d_pcm_∂ugö_Á°_›s
;

578 
pcm
->
¥iv©e_d©a
 = 
adpcm
;

579 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

580 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

581 
pcm
->
t°amp_ty≥
 = 
¶ave
->tstamp_type;

582 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
adpcm
->
∂ug
.
hw_±r
, -1, 0);

583 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
adpcm
->
∂ug
.
≠∂_±r
, -1, 0);

584 *
pcmp
 = 
pcm
;

587 
	}
}

633 
	$_¢d_pcm_adpcm_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

634 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

635 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

637 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

638 
îr
;

639 
¢d_pcm_t
 *
•cm
;

640 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

641 
¢d_pcm_f‹m©_t
 
sf‹m©
;

642 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

643 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

644 c⁄° *
id
;

645 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

647 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

649 i‡(
	`°rcmp
(
id
, "slave") == 0) {

650 
¶ave
 = 
n
;

653 
	`SNDERR
("Unknow¿fõld %s", 
id
);

654  -
EINVAL
;

656 i‡(!
¶ave
) {

657 
	`SNDERR
("slave isÇot defined");

658  -
EINVAL
;

660 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 1,

661 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_MANDATORY
, &
sf‹m©
);

662 i‡(
îr
 < 0)

663  
îr
;

664 i‡(
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1 &&

665 
sf‹m©
 !
SND_PCM_FORMAT_IMA_ADPCM
) {

666 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

667 
	`SNDERR
("invalid slave format");

668  -
EINVAL
;

670 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

671 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

672 i‡(
îr
 < 0)

673  
îr
;

674 
îr
 = 
	`¢d_pcm_adpcm_›í
(
pcmp
, 
«me
, 
sf‹m©
, 
•cm
, 1);

675 i‡(
îr
 < 0)

676 
	`¢d_pcm_˛o£
(
•cm
);

677  
îr
;

678 
	}
}

679 #i‚de‡
DOC_HIDDEN


680 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_adpcm_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_alaw.c

29 
	~"pcm_loˇl.h
"

30 
	~"bsw≠.h
"

31 
	~"pcm_∂ugö.h
"

33 
	~"∂ugö_›s.h
"

35 #i‚de‡
PIC


37 c⁄° *
	g_¢d_moduÀ_pcm_Æaw
 = "";

40 #i‚de‡
DOC_HIDDEN


42 (*
	tÆaw_f
)(c⁄° 
	t¢d_pcm_ch™√l_¨ó_t
 *
	td°_¨ós
,

43 
	t¢d_pcm_u‰ames_t
 
	td°_off£t
,

44 c⁄° 
	t¢d_pcm_ch™√l_¨ó_t
 *
	t§c_¨ós
,

45 
	t¢d_pcm_u‰ames_t
 
	t§c_off£t
,

46 
	tch™√ls
, 
	t¢d_pcm_u‰ames_t
 
	t‰ames
,

47 
	tgëputidx
);

51 
¢d_pcm_∂ugö_t
 
∂ug
;

52 
gëput_idx
;

53 
Æaw_f
 
func
;

54 
¢d_pcm_f‹m©_t
 
sf‹m©
;

55 } 
	t¢d_pcm_Æaw_t
;

59 
ölöe
 
	$vÆ_£g
(
vÆ
)

61 
r
 = 1;

62 
vÆ
 >>= 8;

63 i‡(
vÆ
 & 0xf0) {

64 
vÆ
 >>= 4;

65 
r
 += 4;

67 i‡(
vÆ
 & 0x0c) {

68 
vÆ
 >>= 2;

69 
r
 += 2;

71 i‡(
vÆ
 & 0x02)

72 
r
 += 1;

73  
r
;

74 
	}
}

96 
	$s16_to_Æaw
(
pcm_vÆ
)

98 
mask
;

99 
£g
;

100 
avÆ
;

102 i‡(
pcm_vÆ
 >= 0) {

103 
mask
 = 0xD5;

105 
mask
 = 0x55;

106 
pcm_vÆ
 = -pcm_val;

107 i‡(
pcm_vÆ
 > 0x7fff)

108 
pcm_vÆ
 = 0x7fff;

111 i‡(
pcm_vÆ
 < 256)

112 
avÆ
 = 
pcm_vÆ
 >> 4;

115 
£g
 = 
	`vÆ_£g
(
pcm_vÆ
);

116 
avÆ
 = (
£g
 << 4Ë| ((
pcm_vÆ
 >> (seg + 3)) & 0x0f);

118  
avÆ
 ^ 
mask
;

119 
	}
}

125 
	$Æaw_to_s16
(
a_vÆ
)

127 
t
;

128 
£g
;

130 
a_vÆ
 ^= 0x55;

131 
t
 = 
a_vÆ
 & 0x7f;

132 i‡(
t
 < 16)

133 
t
 = (t << 4) + 8;

135 
£g
 = (
t
 >> 4) & 0x07;

136 
t
 = ((t & 0x0f) << 4) + 0x108;

137 
t
 <<
£g
 -1;

139  ((
a_vÆ
 & 0x80Ë? 
t
 : -t);

140 
	}
}

142 #i‚de‡
DOC_HIDDEN


144 
	$¢d_pcm_Æaw_decode
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

145 
¢d_pcm_u‰ames_t
 
d°_off£t
,

146 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

147 
¢d_pcm_u‰ames_t
 
§c_off£t
,

148 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

149 
putidx
)

151 
	#PUT16_LABELS


	)

152 
	~"∂ugö_›s.h
"

153 #unde‡
PUT16_LABELS


154 *
put
 = 
put16_œbñs
[
putidx
];

155 
ch™√l
;

156 
ch™√l
 = 0; ch™√»< 
ch™√ls
; ++channel) {

157 c⁄° *
§c
;

158 *
d°
;

159 
§c_°ï
, 
d°_°ï
;

160 
¢d_pcm_u‰ames_t
 
‰ames1
;

161 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

162 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

163 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

164 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

165 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
);

166 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
);

167 
‰ames1
 = 
‰ames
;

168 
‰ames1
-- > 0) {

169 
öt16_t
 
ßm∂e
 = 
	`Æaw_to_s16
(*
§c
);

170 *
put
;

171 
	#PUT16_END
 
a·î


	)

172 
	~"∂ugö_›s.h
"

173 #unde‡
PUT16_END


174 
a·î
:

175 
§c
 +
§c_°ï
;

176 
d°
 +
d°_°ï
;

179 
	}
}

181 
	$¢d_pcm_Æaw_ícode
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

182 
¢d_pcm_u‰ames_t
 
d°_off£t
,

183 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

184 
¢d_pcm_u‰ames_t
 
§c_off£t
,

185 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

186 
gëidx
)

188 
	#GET16_LABELS


	)

189 
	~"∂ugö_›s.h
"

190 #unde‡
GET16_LABELS


191 *
gë
 = 
gë16_œbñs
[
gëidx
];

192 
ch™√l
;

193 
öt16_t
 
ßm∂e
 = 0;

194 
ch™√l
 = 0; ch™√»< 
ch™√ls
; ++channel) {

195 c⁄° *
§c
;

196 *
d°
;

197 
§c_°ï
, 
d°_°ï
;

198 
¢d_pcm_u‰ames_t
 
‰ames1
;

199 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

200 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

201 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

202 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

203 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
);

204 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
);

205 
‰ames1
 = 
‰ames
;

206 
‰ames1
-- > 0) {

207 *
gë
;

208 
	#GET16_END
 
a·î


	)

209 
	~"∂ugö_›s.h
"

210 #unde‡
GET16_END


211 
a·î
:

212 *
d°
 = 
	`s16_to_Æaw
(
ßm∂e
);

213 
§c
 +
§c_°ï
;

214 
d°
 +
d°_°ï
;

217 
	}
}

221 
	$¢d_pcm_Æaw_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

223 
¢d_pcm_Æaw_t
 *
Æaw
 = 
pcm
->
¥iv©e_d©a
;

224 
îr
;

225 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

226 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

227 &
ac˚ss_mask
);

228 i‡(
îr
 < 0)

229  
îr
;

230 i‡(
Æaw
->
sf‹m©
 =
SND_PCM_FORMAT_A_LAW
) {

231 
¢d_pcm_f‹m©_mask_t
 
f‹m©_mask
 = { 
SND_PCM_FMTBIT_LINEAR
 };

232 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
,

233 &
f‹m©_mask
);

235 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
∑øms
,

236 
SND_PCM_FORMAT_A_LAW
);

238 i‡(
îr
 < 0)

239  
îr
;

240 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
∑øms
, 
SND_PCM_SUBFORMAT_STD
);

241 i‡(
îr
 < 0)

242  
îr
;

243 
∑øms
->
öfo
 &~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

245 
	}
}

247 
	$¢d_pcm_Æaw_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

249 
¢d_pcm_Æaw_t
 *
Æaw
 = 
pcm
->
¥iv©e_d©a
;

250 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

251 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

252 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

253 &
ßc˚ss_mask
);

254 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
•¨ams
, 
Æaw
->
sf‹m©
);

255 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
•¨ams
, 
SND_PCM_SUBFORMAT_STD
);

257 
	}
}

259 
	$¢d_pcm_Æaw_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

260 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

262 
îr
;

263 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

264 
SND_PCM_HW_PARBIT_RATE
 |

265 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

266 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

267 
SND_PCM_HW_PARBIT_PERIODS
 |

268 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

269 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

270 
SND_PCM_HW_PARBIT_TICK_TIME
);

271 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

272 i‡(
îr
 < 0)

273  
îr
;

275 
	}
}

277 
	$¢d_pcm_Æaw_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

278 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

280 
îr
;

281 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

282 
SND_PCM_HW_PARBIT_RATE
 |

283 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

284 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

285 
SND_PCM_HW_PARBIT_PERIODS
 |

286 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

287 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

288 
SND_PCM_HW_PARBIT_TICK_TIME
);

289 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

290 i‡(
îr
 < 0)

291  
îr
;

293 
	}
}

295 
	$¢d_pcm_Æaw_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

297  
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

298 
¢d_pcm_Æaw_hw_ªföe_˝ª∑ª
,

299 
¢d_pcm_Æaw_hw_ªföe_cch™ge
,

300 
¢d_pcm_Æaw_hw_ªföe_•ª∑ª
,

301 
¢d_pcm_Æaw_hw_ªföe_sch™ge
,

302 
¢d_pcm_gíîic_hw_ªföe
);

303 
	}
}

305 
	$¢d_pcm_Æaw_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 * 
∑øms
)

307 
¢d_pcm_Æaw_t
 *
Æaw
 = 
pcm
->
¥iv©e_d©a
;

308 
¢d_pcm_f‹m©_t
 
f‹m©
;

309 
îr
 = 
	`¢d_pcm_hw_∑øms_¶ave
(
pcm
, 
∑øms
,

310 
¢d_pcm_Æaw_hw_ªföe_cch™ge
,

311 
¢d_pcm_Æaw_hw_ªföe_•ª∑ª
,

312 
¢d_pcm_Æaw_hw_ªföe_sch™ge
,

313 
¢d_pcm_gíîic_hw_∑øms
);

314 i‡(
îr
 < 0)

315  
îr
;

317 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(
∑øms
, &
f‹m©
);

318 i‡(
îr
 < 0)

319  
îr
;

321 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

322 i‡(
Æaw
->
sf‹m©
 =
SND_PCM_FORMAT_A_LAW
) {

323 
Æaw
->
gëput_idx
 = 
	`¢d_pcm_löór_gë_ödex
(
f‹m©
, 
SND_PCM_FORMAT_S16
);

324 
Æaw
->
func
 = 
¢d_pcm_Æaw_ícode
;

326 
Æaw
->
gëput_idx
 = 
	`¢d_pcm_löór_put_ödex
(
SND_PCM_FORMAT_S16
,áœw->
sf‹m©
);

327 
Æaw
->
func
 = 
¢d_pcm_Æaw_decode
;

330 i‡(
Æaw
->
sf‹m©
 =
SND_PCM_FORMAT_A_LAW
) {

331 
Æaw
->
gëput_idx
 = 
	`¢d_pcm_löór_put_ödex
(
SND_PCM_FORMAT_S16
, 
f‹m©
);

332 
Æaw
->
func
 = 
¢d_pcm_Æaw_decode
;

334 
Æaw
->
gëput_idx
 = 
	`¢d_pcm_löór_gë_ödex
◊œw->
sf‹m©
, 
SND_PCM_FORMAT_S16
);

335 
Æaw
->
func
 = 
¢d_pcm_Æaw_ícode
;

339 
	}
}

341 
¢d_pcm_u‰ames_t


342 
	$¢d_pcm_Æaw_wrôe_¨ós
(
¢d_pcm_t
 *
pcm
,

343 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

344 
¢d_pcm_u‰ames_t
 
off£t
,

345 
¢d_pcm_u‰ames_t
 
size
,

346 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

347 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

348 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

350 
¢d_pcm_Æaw_t
 *
Æaw
 = 
pcm
->
¥iv©e_d©a
;

351 i‡(
size
 > *
¶ave_sizï
)

352 
size
 = *
¶ave_sizï
;

353 
Æaw
->
	`func
(
¶ave_¨ós
, 
¶ave_off£t
,

354 
¨ós
, 
off£t
,

355 
pcm
->
ch™√ls
, 
size
,

356 
Æaw
->
gëput_idx
);

357 *
¶ave_sizï
 = 
size
;

358  
size
;

359 
	}
}

361 
¢d_pcm_u‰ames_t


362 
	$¢d_pcm_Æaw_ªad_¨ós
(
¢d_pcm_t
 *
pcm
,

363 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

364 
¢d_pcm_u‰ames_t
 
off£t
,

365 
¢d_pcm_u‰ames_t
 
size
,

366 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

367 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

368 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

370 
¢d_pcm_Æaw_t
 *
Æaw
 = 
pcm
->
¥iv©e_d©a
;

371 i‡(
size
 > *
¶ave_sizï
)

372 
size
 = *
¶ave_sizï
;

373 
Æaw
->
	`func
(
¨ós
, 
off£t
,

374 
¶ave_¨ós
, 
¶ave_off£t
,

375 
pcm
->
ch™√ls
, 
size
,

376 
Æaw
->
gëput_idx
);

377 *
¶ave_sizï
 = 
size
;

378  
size
;

379 
	}
}

381 
	$¢d_pcm_Æaw_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

383 
¢d_pcm_Æaw_t
 *
Æaw
 = 
pcm
->
¥iv©e_d©a
;

384 
	`¢d_ouçut_¥ötf
(
out
, "A-Law conversion PCM (%s)\n",

385 
	`¢d_pcm_f‹m©_«me
(
Æaw
->
sf‹m©
));

386 i‡(
pcm
->
£tup
) {

387 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

388 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

390 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

391 
	`¢d_pcm_dump
(
Æaw
->
∂ug
.
gí
.
¶ave
, 
out
);

392 
	}
}

394 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_Æaw_›s
 = {

395 .
˛o£
 = 
¢d_pcm_gíîic_˛o£
,

396 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

397 .
	ghw_ªföe
 = 
¢d_pcm_Æaw_hw_ªföe
,

398 .
	ghw_∑øms
 = 
¢d_pcm_Æaw_hw_∑øms
,

399 .
	ghw_‰ì
 = 
¢d_pcm_gíîic_hw_‰ì
,

400 .
	gsw_∑øms
 = 
¢d_pcm_gíîic_sw_∑øms
,

401 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

402 .
	gdump
 = 
¢d_pcm_Æaw_dump
,

403 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

404 .
	gasync
 = 
¢d_pcm_gíîic_async
,

405 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

406 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

407 .
	gquîy_chm≠s
 = 
¢d_pcm_gíîic_quîy_chm≠s
,

408 .
	ggë_chm≠
 = 
¢d_pcm_gíîic_gë_chm≠
,

409 .
	g£t_chm≠
 = 
¢d_pcm_gíîic_£t_chm≠
,

424 
	$¢d_pcm_Æaw_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
, 
¢d_pcm_f‹m©_t
 
sf‹m©
, snd_pcm_à*
¶ave
, 
˛o£_¶ave
)

426 
¢d_pcm_t
 *
pcm
;

427 
¢d_pcm_Æaw_t
 *
Æaw
;

428 
îr
;

429 
	`as£π
(
pcmp
 && 
¶ave
);

430 i‡(
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1 &&

431 
sf‹m©
 !
SND_PCM_FORMAT_A_LAW
)

432  -
EINVAL
;

433 
Æaw
 = 
	`ˇŒoc
(1, (
¢d_pcm_Æaw_t
));

434 i‡(!
Æaw
) {

435  -
ENOMEM
;

437 
	`¢d_pcm_∂ugö_öô
(&
Æaw
->
∂ug
);

438 
Æaw
->
sf‹m©
 = sformat;

439 
Æaw
->
∂ug
.
ªad
 = 
¢d_pcm_Æaw_ªad_¨ós
;

440 
Æaw
->
∂ug
.
wrôe
 = 
¢d_pcm_Æaw_wrôe_¨ós
;

441 
Æaw
->
∂ug
.
undo_ªad
 = 
¢d_pcm_∂ugö_undo_ªad_gíîic
;

442 
Æaw
->
∂ug
.
undo_wrôe
 = 
¢d_pcm_∂ugö_undo_wrôe_gíîic
;

443 
Æaw
->
∂ug
.
gí
.
¶ave
 = slave;

444 
Æaw
->
∂ug
.
gí
.
˛o£_¶ave
 = close_slave;

446 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_ALAW
, 
«me
, 
¶ave
->
°ªam
, sœve->
mode
);

447 i‡(
îr
 < 0) {

448 
	`‰ì
(
Æaw
);

449  
îr
;

451 
pcm
->
›s
 = &
¢d_pcm_Æaw_›s
;

452 
pcm
->
Á°_›s
 = &
¢d_pcm_∂ugö_Á°_›s
;

453 
pcm
->
¥iv©e_d©a
 = 
Æaw
;

454 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

455 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

456 
pcm
->
t°amp_ty≥
 = 
¶ave
->tstamp_type;

457 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
Æaw
->
∂ug
.
hw_±r
, -1, 0);

458 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
Æaw
->
∂ug
.
≠∂_±r
, -1, 0);

459 *
pcmp
 = 
pcm
;

462 
	}
}

508 
	$_¢d_pcm_Æaw_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

509 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

510 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

512 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

513 
îr
;

514 
¢d_pcm_t
 *
•cm
;

515 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

516 
¢d_pcm_f‹m©_t
 
sf‹m©
;

517 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

518 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

519 c⁄° *
id
;

520 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

522 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

524 i‡(
	`°rcmp
(
id
, "slave") == 0) {

525 
¶ave
 = 
n
;

528 
	`SNDERR
("Unknow¿fõld %s", 
id
);

529  -
EINVAL
;

531 i‡(!
¶ave
) {

532 
	`SNDERR
("slave isÇot defined");

533  -
EINVAL
;

535 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 1,

536 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_MANDATORY
, &
sf‹m©
);

537 i‡(
îr
 < 0)

538  
îr
;

539 i‡(
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1 &&

540 
sf‹m©
 !
SND_PCM_FORMAT_A_LAW
) {

541 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

542 
	`SNDERR
("invalid slave format");

543  -
EINVAL
;

545 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

546 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

547 i‡(
îr
 < 0)

548  
îr
;

549 
îr
 = 
	`¢d_pcm_Æaw_›í
(
pcmp
, 
«me
, 
sf‹m©
, 
•cm
, 1);

550 i‡(
îr
 < 0)

551 
	`¢d_pcm_˛o£
(
•cm
);

552  
îr
;

553 
	}
}

554 #i‚de‡
DOC_HIDDEN


555 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_Æaw_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_asym.c

9 
	~"pcm_loˇl.h
"

11 #i‚de‡
PIC


13 c⁄° *
	g_¢d_moduÀ_pcm_asym
 = "";

77 
	$_¢d_pcm_asym_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
 
ATTRIBUTE_UNUSED
,

78 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

79 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

81 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

82 
îr
;

83 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

84 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

85 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

86 c⁄° *
id
;

87 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

89 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

91 i‡(
	`°rcmp
(
id
, "playback") == 0) {

92 i‡(
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

93 
¶ave
 = 
n
;

96 i‡(
	`°rcmp
(
id
, "capture") == 0) {

97 i‡(
°ªam
 =
SND_PCM_STREAM_CAPTURE
)

98 
¶ave
 = 
n
;

101 
	`SNDERR
("Unknow¿fõld %s", 
id
);

102  -
EINVAL
;

104 i‡(! 
¶ave
) {

105 
	`SNDERR
("%s slave isÇot defined",

106 
°ªam
 =
SND_PCM_STREAM_PLAYBACK
 ? "playback" : "capture");

107  -
EINVAL
;

109 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 0);

110 i‡(
îr
 < 0)

111  
îr
;

112 
îr
 = 
	`¢d_pcm_›í_«med_¶ave
(
pcmp
, 
«me
, 
roŸ
, 
sc⁄f
, 
°ªam
,

113 
mode
, 
c⁄f
);

114 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

115  
îr
;

116 
	}
}

117 #i‚de‡
DOC_HIDDEN


118 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_asym_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_copy.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_∂ugö.h
"

31 
	~"bsw≠.h
"

33 #i‚de‡
PIC


35 c⁄° *
	g_¢d_moduÀ_pcm_c›y
 = "";

38 #i‚de‡
DOC_HIDDEN


41 
¢d_pcm_∂ugö_t
 
	m∂ug
;

42 } 
	t¢d_pcm_c›y_t
;

45 
	$¢d_pcm_c›y_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

47 
îr
;

48 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

49 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

50 &
ac˚ss_mask
);

51 i‡(
îr
 < 0)

52  
îr
;

53 
∑øms
->
öfo
 &~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

55 
	}
}

57 
	$¢d_pcm_c›y_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

59 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

60 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

61 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

62 &
ßc˚ss_mask
);

64 
	}
}

66 
	$¢d_pcm_c›y_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

67 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

69 
îr
;

70 
löks
 = ~
SND_PCM_HW_PARBIT_ACCESS
;

71 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

72 i‡(
îr
 < 0)

73  
îr
;

75 
	}
}

77 
	$¢d_pcm_c›y_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

78 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

80 
îr
;

81 
löks
 = ~
SND_PCM_HW_PARBIT_ACCESS
;

82 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

83 i‡(
îr
 < 0)

84  
îr
;

86 
	}
}

88 
	$¢d_pcm_c›y_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

90  
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

91 
¢d_pcm_c›y_hw_ªföe_˝ª∑ª
,

92 
¢d_pcm_c›y_hw_ªföe_cch™ge
,

93 
¢d_pcm_c›y_hw_ªföe_•ª∑ª
,

94 
¢d_pcm_c›y_hw_ªföe_sch™ge
,

95 
¢d_pcm_gíîic_hw_ªföe
);

96 
	}
}

98 
	$¢d_pcm_c›y_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

100  
	`¢d_pcm_hw_∑øms_¶ave
(
pcm
, 
∑øms
,

101 
¢d_pcm_c›y_hw_ªföe_cch™ge
,

102 
¢d_pcm_c›y_hw_ªföe_•ª∑ª
,

103 
¢d_pcm_c›y_hw_ªföe_sch™ge
,

104 
¢d_pcm_gíîic_hw_∑øms
);

105 
	}
}

107 
¢d_pcm_u‰ames_t


108 
	$¢d_pcm_c›y_wrôe_¨ós
(
¢d_pcm_t
 *
pcm
,

109 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

110 
¢d_pcm_u‰ames_t
 
off£t
,

111 
¢d_pcm_u‰ames_t
 
size
,

112 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

113 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

114 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

116 i‡(
size
 > *
¶ave_sizï
)

117 
size
 = *
¶ave_sizï
;

118 
	`¢d_pcm_¨ós_c›y
(
¶ave_¨ós
, 
¶ave_off£t
,

119 
¨ós
, 
off£t
,

120 
pcm
->
ch™√ls
, 
size
,Öcm->
f‹m©
);

121 *
¶ave_sizï
 = 
size
;

122  
size
;

123 
	}
}

125 
¢d_pcm_u‰ames_t


126 
	$¢d_pcm_c›y_ªad_¨ós
(
¢d_pcm_t
 *
pcm
,

127 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

128 
¢d_pcm_u‰ames_t
 
off£t
,

129 
¢d_pcm_u‰ames_t
 
size
,

130 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

131 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

132 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

134 i‡(
size
 > *
¶ave_sizï
)

135 
size
 = *
¶ave_sizï
;

136 
	`¢d_pcm_¨ós_c›y
(
¨ós
, 
off£t
,

137 
¶ave_¨ós
, 
¶ave_off£t
,

138 
pcm
->
ch™√ls
, 
size
,Öcm->
f‹m©
);

139 *
¶ave_sizï
 = 
size
;

140  
size
;

141 
	}
}

143 
	$¢d_pcm_c›y_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

145 
¢d_pcm_c›y_t
 *
c›y
 = 
pcm
->
¥iv©e_d©a
;

146 
	`¢d_ouçut_¥ötf
(
out
, "Copy conversion PCM\n");

147 i‡(
pcm
->
£tup
) {

148 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

149 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

151 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

152 
	`¢d_pcm_dump
(
c›y
->
∂ug
.
gí
.
¶ave
, 
out
);

153 
	}
}

155 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_c›y_›s
 = {

156 .
˛o£
 = 
¢d_pcm_gíîic_˛o£
,

157 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

158 .
	ghw_ªföe
 = 
¢d_pcm_c›y_hw_ªföe
,

159 .
	ghw_∑øms
 = 
¢d_pcm_c›y_hw_∑øms
,

160 .
	ghw_‰ì
 = 
¢d_pcm_gíîic_hw_‰ì
,

161 .
	gsw_∑øms
 = 
¢d_pcm_gíîic_sw_∑øms
,

162 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

163 .
	gdump
 = 
¢d_pcm_c›y_dump
,

164 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

165 .
	gasync
 = 
¢d_pcm_gíîic_async
,

166 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

167 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

168 .
	gquîy_chm≠s
 = 
¢d_pcm_gíîic_quîy_chm≠s
,

169 .
	ggë_chm≠
 = 
¢d_pcm_gíîic_gë_chm≠
,

170 .
	g£t_chm≠
 = 
¢d_pcm_gíîic_£t_chm≠
,

184 
	$¢d_pcm_c›y_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
, snd_pcm_à*
¶ave
, 
˛o£_¶ave
)

186 
¢d_pcm_t
 *
pcm
;

187 
¢d_pcm_c›y_t
 *
c›y
;

188 
îr
;

189 
	`as£π
(
pcmp
 && 
¶ave
);

190 
c›y
 = 
	`ˇŒoc
(1, (
¢d_pcm_c›y_t
));

191 i‡(!
c›y
) {

192  -
ENOMEM
;

194 
	`¢d_pcm_∂ugö_öô
(&
c›y
->
∂ug
);

195 
c›y
->
∂ug
.
ªad
 = 
¢d_pcm_c›y_ªad_¨ós
;

196 
c›y
->
∂ug
.
wrôe
 = 
¢d_pcm_c›y_wrôe_¨ós
;

197 
c›y
->
∂ug
.
undo_ªad
 = 
¢d_pcm_∂ugö_undo_ªad_gíîic
;

198 
c›y
->
∂ug
.
undo_wrôe
 = 
¢d_pcm_∂ugö_undo_wrôe_gíîic
;

199 
c›y
->
∂ug
.
gí
.
¶ave
 = slave;

200 
c›y
->
∂ug
.
gí
.
˛o£_¶ave
 = close_slave;

202 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_COPY
, 
«me
, 
¶ave
->
°ªam
, sœve->
mode
);

203 i‡(
îr
 < 0) {

204 
	`‰ì
(
c›y
);

205  
îr
;

207 
pcm
->
›s
 = &
¢d_pcm_c›y_›s
;

208 
pcm
->
Á°_›s
 = &
¢d_pcm_∂ugö_Á°_›s
;

209 
pcm
->
¥iv©e_d©a
 = 
c›y
;

210 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

211 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

212 
pcm
->
t°amp_ty≥
 = 
¶ave
->tstamp_type;

213 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
c›y
->
∂ug
.
hw_±r
, -1, 0);

214 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
c›y
->
∂ug
.
≠∂_±r
, -1, 0);

215 *
pcmp
 = 
pcm
;

218 
	}
}

262 
	$_¢d_pcm_c›y_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

263 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

264 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

266 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

267 
îr
;

268 
¢d_pcm_t
 *
•cm
;

269 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

270 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

271 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

272 c⁄° *
id
;

273 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

275 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

277 i‡(
	`°rcmp
(
id
, "slave") == 0) {

278 
¶ave
 = 
n
;

281 
	`SNDERR
("Unknow¿fõld %s", 
id
);

282  -
EINVAL
;

284 i‡(!
¶ave
) {

285 
	`SNDERR
("slave isÇot defined");

286  -
EINVAL
;

288 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 0);

289 i‡(
îr
 < 0)

290  
îr
;

291 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

292 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

293 i‡(
îr
 < 0)

294  
îr
;

295 
îr
 = 
	`¢d_pcm_c›y_›í
(
pcmp
, 
«me
, 
•cm
, 1);

296 i‡(
îr
 < 0)

297 
	`¢d_pcm_˛o£
(
•cm
);

298  
îr
;

299 
	}
}

300 #i‚de‡
DOC_HIDDEN


301 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_c›y_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_direct.c

22 
	~"pcm_loˇl.h
"

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~<°ddef.h
>

26 
	~<uni°d.h
>

27 
	~<sig«l.h
>

28 
	~<°rög.h
>

29 
	~<f˙é.h
>

30 
	~<˘y≥.h
>

31 
	~<gΩ.h
>

32 
	~<sys/io˘l.h
>

33 
	~<sys/mm™.h
>

34 
	~<pﬁl.h
>

35 
	~<sys/shm.h
>

36 
	~<sys/£m.h
>

37 
	~<sys/waô.h
>

38 
	~<sys/sockë.h
>

39 
	~<sys/°©.h
>

40 
	~<sys/un.h
>

41 
	~<sys/mm™.h
>

42 
	~"pcm_dúe˘.h
"

48 #i‡!
deföed
(
__O≥nBSD__
Ë&& !deföed(
__Døg⁄Fly__
Ë&& !deföed(
__ANDROID__
)

49 
	u£mun
 {

50 
	mvÆ
;

51 
£mid_ds
 *
	mbuf
;

52 *
	m¨øy
;

53 #i‡
deföed
(
__löux__
)

54 
£möfo
 *
	m__buf
;

64 
	$¢d_pcm_dúe˘_£m≠h‹e_¸óã_‹_c⁄√˘
(
¢d_pcm_dúe˘_t
 *
dmix
)

66 
£mun
 
s
;

67 
£mid_ds
 
buf
;

68 
i
;

70 
dmix
->
£mid
 = 
	`£mgë
(dmix->
ùc_key
, 
DIRECT_IPC_SEMS
,

71 
IPC_CREAT
 | 
dmix
->
ùc_≥rm
);

72 i‡(
dmix
->
£mid
 < 0)

73  -
î∫o
;

74 i‡(
dmix
->
ùc_gid
 < 0)

76 
i
 = 0; i < 
DIRECT_IPC_SEMS
; i++) {

77 
s
.
buf
 = &buf;

78 i‡(
	`£m˘l
(
dmix
->
£mid
, 
i
, 
IPC_STAT
, 
s
) < 0) {

79 
îr
 = -
î∫o
;

80 
	`¢d_pcm_dúe˘_£m≠h‹e_disˇrd
(
dmix
);

81  
îr
;

83 
buf
.
£m_≥rm
.
gid
 = 
dmix
->
ùc_gid
;

84 
s
.
buf
 = &buf;

85 
	`£m˘l
(
dmix
->
£mid
, 
i
, 
IPC_SET
, 
s
);

88 
	}
}

90 
	$¢d_pcm_dúe˘_magic
(
¢d_pcm_dúe˘_t
 *
dmix
)

92 i‡(!
dmix
->
dúe˘_mem‹y_ac˚ss
)

93  0xa15ad300 + (
¢d_pcm_dúe˘_sh¨e_t
);

95  0xb15ad300 + (
¢d_pcm_dúe˘_sh¨e_t
);

96 
	}
}

102 
	$¢d_pcm_dúe˘_shm_¸óã_‹_c⁄√˘
(
¢d_pcm_dúe˘_t
 *
dmix
)

104 
shmid_ds
 
buf
;

105 
tmpid
, 
îr
, 
fú°_ö°™˚
 = 0;

107 
ªåygë
:

108 
dmix
->
shmid
 = 
	`shmgë
(dmix->
ùc_key
, (
¢d_pcm_dúe˘_sh¨e_t
),

109 
dmix
->
ùc_≥rm
);

110 i‡(
dmix
->
shmid
 < 0 && 
î∫o
 =
ENOENT
) {

111 i‡((
dmix
->
shmid
 = 
	`shmgë
(dmix->
ùc_key
, (
¢d_pcm_dúe˘_sh¨e_t
),

112 
IPC_CREAT
 | 
IPC_EXCL
 | 
dmix
->
ùc_≥rm
)) != -1)

113 
fú°_ö°™˚
 = 1;

114 i‡(
î∫o
 =
EEXIST
)

115 
ªåygë
;

117 
îr
 = -
î∫o
;

118 i‡(
dmix
->
shmid
 < 0) {

119 i‡(
î∫o
 =
EINVAL
)

120 i‡((
tmpid
 = 
	`shmgë
(
dmix
->
ùc_key
, 0, dmix->
ùc_≥rm
)) != -1)

121 i‡(!
	`shm˘l
(
tmpid
, 
IPC_STAT
, &
buf
))

122 i‡(!
buf
.
shm_«âch
)

124 i‡(!
	`shm˘l
(
tmpid
, 
IPC_RMID
, 
NULL
))

125 
ªåygë
;

126  
îr
;

128 
dmix
->
shm±r
 = 
	`shm©
(dmix->
shmid
, 0, 0);

129 i‡(
dmix
->
shm±r
 == (*) -1) {

130 
îr
 = -
î∫o
;

131 
	`¢d_pcm_dúe˘_shm_disˇrd
(
dmix
);

132  
îr
;

134 
	`mlock
(
dmix
->
shm±r
, (
¢d_pcm_dúe˘_sh¨e_t
));

135 i‡(
	`shm˘l
(
dmix
->
shmid
, 
IPC_STAT
, &
buf
) < 0) {

136 
îr
 = -
î∫o
;

137 
	`¢d_pcm_dúe˘_shm_disˇrd
(
dmix
);

138  
îr
;

140 i‡(
fú°_ö°™˚
) {

141 
	`mem£t
(
dmix
->
shm±r
, 0, (
¢d_pcm_dúe˘_sh¨e_t
));

142 i‡(
dmix
->
ùc_gid
 >= 0) {

143 
buf
.
shm_≥rm
.
gid
 = 
dmix
->
ùc_gid
;

144 
	`shm˘l
(
dmix
->
shmid
, 
IPC_SET
, &
buf
);

146 
dmix
->
shm±r
->
magic
 = 
	`¢d_pcm_dúe˘_magic
(dmix);

149 i‡(
dmix
->
shm±r
->
magic
 !
	`¢d_pcm_dúe˘_magic
(dmix)) {

150 
	`¢d_pcm_dúe˘_shm_disˇrd
(
dmix
);

151  -
EINVAL
;

155 
	}
}

164 
	$_¢d_pcm_dúe˘_shm_disˇrd
(
¢d_pcm_dúe˘_t
 *
dmix
)

166 
shmid_ds
 
buf
;

167 
ªt
 = 0;

169 i‡(
dmix
->
shmid
 < 0)

170  -
EINVAL
;

171 i‡(
dmix
->
shm±r
 !(*Ë-1 && 
	`shmdt
(dmix->shmptr) < 0)

172  -
î∫o
;

173 
dmix
->
shm±r
 = (*) -1;

174 i‡(
	`shm˘l
(
dmix
->
shmid
, 
IPC_STAT
, &
buf
) < 0)

175  -
î∫o
;

176 i‡(
buf
.
shm_«âch
 == 0) {

177 i‡(
	`shm˘l
(
dmix
->
shmid
, 
IPC_RMID
, 
NULL
) < 0)

178  -
î∫o
;

179 
ªt
 = 1;

181 
dmix
->
shmid
 = -1;

182  
ªt
;

183 
	}
}

186 
	$¢d_pcm_dúe˘_shm_disˇrd
(
¢d_pcm_dúe˘_t
 *
dmix
)

188  
	`_¢d_pcm_dúe˘_shm_disˇrd
(
dmix
);

189 
	}
}

195 
	$gë_tmp_«me
(*
fûíame
, 
size_t
 
size
)

197 
timevÆ
 
tv
;

199 
	`gëtimeofday
(&
tv
, 
NULL
);

200 
	`¢¥ötf
(
fûíame
, 
size
, 
TMPDIR
 "/Æß-dmix-%i-%li-%li", ()
	`gëpid
(), ()
tv
.
tv_£c
, (Èv.
tv_u£c
);

201 
fûíame
[
size
-1] = '\0';

203 
	}
}

205 
	$make_loˇl_sockë
(c⁄° *
fûíame
, 
£rvî
, 
mode_t
 
ùc_≥rm
, 
ùc_gid
)

207 
size_t
 
l
 = 
	`°æí
(
fûíame
);

208 
size_t
 
size
 = 
	`off£tof
(
sockaddr_un
, 
sun_∑th
Ë+ 
l
;

209 
sockaddr_un
 *
addr
 = 
	`Æloˇ
(
size
);

210 
sock
;

212 
sock
 = 
	`sockë
(
PF_LOCAL
, 
SOCK_STREAM
, 0);

213 i‡(
sock
 < 0) {

214 
ªsu…
 = -
î∫o
;

215 
	`SYSERR
("socket failed");

216  
ªsu…
;

219 i‡(
£rvî
)

220 
	`u∆ök
(
fûíame
);

221 
	`mem£t
(
addr
, 0, 
size
);

222 
addr
->
sun_Ámûy
 = 
AF_LOCAL
;

223 
	`mem˝y
(
addr
->
sun_∑th
, 
fûíame
, 
l
);

225 i‡(
£rvî
) {

226 i‡(
	`böd
(
sock
, (
sockaddr
 *Ë
addr
, 
size
) < 0) {

227 
ªsu…
 = -
î∫o
;

228 
	`SYSERR
("böd faûed: %s", 
fûíame
);

229 
	`˛o£
(
sock
);

230  
ªsu…
;

232 i‡(
	`chmod
(
fûíame
, 
ùc_≥rm
) < 0) {

233 
ªsu…
 = -
î∫o
;

234 
	`SYSERR
("chmod faûed: %s", 
fûíame
);

235 
	`˛o£
(
sock
);

236 
	`u∆ök
(
fûíame
);

237  
ªsu…
;

239 i‡(
	`chown
(
fûíame
, -1, 
ùc_gid
) < 0) {

241 
ªsu…
 = -
î∫o
;

242 
	`SYSERR
("chow¿Áûed: %s", 
fûíame
);

243 
	`˛o£
(
sock
);

244 
	`u∆ök
(
fûíame
);

245  
ªsu…
;

250 i‡(
	`c⁄√˘
(
sock
, (
sockaddr
 *Ë
addr
, 
size
) < 0) {

251 
ªsu…
 = -
î∫o
;

252 
	`SYSERR
("c⁄√˘ faûed: %s", 
fûíame
);

253 
	`˛o£
(
sock
);

254  
ªsu…
;

257  
sock
;

258 
	}
}

261 
	#SERVER_JOB_DEBUG


	)

262 
	#£rvî_¥ötf
(
fmt
, 
¨gs
...Ë
	`¥ötf
(fmt, ##¨gs)

	)

264 #unde‡
SERVER_JOB_DEBUG


265 
	#£rvî_¥ötf
(
fmt
, 
¨gs
...Ë

	)

268 
¢d_pcm_dúe˘_t
 *
	g£rvî_job_dmix
;

270 
	$£rvî_˛ónup
(
¢d_pcm_dúe˘_t
 *
dmix
)

272 
	`˛o£
(
dmix
->
£rvî_fd
);

273 
	`˛o£
(
dmix
->
hw_fd
);

274 i‡(
dmix
->
£rvî_‰ì
)

275 
dmix
->
	`£rvî_‰ì
(dmix);

276 
	`u∆ök
(
dmix
->
shm±r
->
sockë_«me
);

277 
	`_¢d_pcm_dúe˘_shm_disˇrd
(
dmix
);

278 
	`¢d_pcm_dúe˘_£m≠h‹e_disˇrd
(
dmix
);

279 
	}
}

281 
	$£rvî_job_sig«l
(
sig
 
ATTRIBUTE_UNUSED
)

283 
	`¢d_pcm_dúe˘_£m≠h‹e_down
(
£rvî_job_dmix
, 
DIRECT_IPC_SEM_CLIENT
);

284 
	`£rvî_˛ónup
(
£rvî_job_dmix
);

285 
	`£rvî_¥ötf
("DIRECT SERVER EXIT - SIGNAL\n");

286 
	`_exô
(
EXIT_SUCCESS
);

287 
	}
}

292 
	$_¢d_£nd_fd
(
sock
, *
d©a
, 
size_t
 
Àn
, 
fd
)

294 
ªt
;

295 
size_t
 
cmsg_Àn
 = 
	`CMSG_LEN
(());

296 
cmsghdr
 *
cmsg
 = 
	`Æloˇ
(
cmsg_Àn
);

297 *
fds
 = (*Ë
	`CMSG_DATA
(
cmsg
);

298 
msghdr
 msghdr;

299 
iovec
 
vec
;

301 
vec
.
iov_ba£
 = (*)&
d©a
;

302 
vec
.
iov_Àn
 = 
Àn
;

304 
cmsg
->
cmsg_Àn
 = cmsg_len;

305 
cmsg
->
cmsg_Àvñ
 = 
SOL_SOCKET
;

306 
cmsg
->
cmsg_ty≥
 = 
SCM_RIGHTS
;

307 *
fds
 = 
fd
;

309 
msghdr
.
msg_«me
 = 
NULL
;

310 
msghdr
.
msg_«mñí
 = 0;

311 
msghdr
.
msg_iov
 = &
vec
;

312 
msghdr
.
msg_iovÀn
 = 1;

313 
msghdr
.
msg_c⁄åﬁ
 = 
cmsg
;

314 
msghdr
.
msg_c⁄åﬁÀn
 = 
cmsg_Àn
;

315 
msghdr
.
msg_Êags
 = 0;

317 
ªt
 = 
	`£ndmsg
(
sock
, &
msghdr
, 0 );

318 i‡(
ªt
 < 0)

319  -
î∫o
;

320  
ªt
;

321 
	}
}

323 
	$£rvî_job
(
¢d_pcm_dúe˘_t
 *
dmix
)

325 
ªt
, 
sck
, 
i
;

326 
max
 = 128, 
cuºít
 = 0;

327 
pﬁlfd
 
pfds
[
max
 + 1];

329 
£rvî_job_dmix
 = 
dmix
;

331 
	`sig«l
(
SIGHUP
, 
£rvî_job_sig«l
);

332 
	`sig«l
(
SIGQUIT
, 
£rvî_job_sig«l
);

333 
	`sig«l
(
SIGTERM
, 
£rvî_job_sig«l
);

334 
	`sig«l
(
SIGKILL
, 
£rvî_job_sig«l
);

336 
i
 = 
	`sysc⁄f
(
_SC_OPEN_MAX
);

337 #ifde‡
SERVER_JOB_DEBUG


338 --
i
 >= 3) {

340 --
i
 >= 0) {

342 i‡(
i
 !
dmix
->
£rvî_fd
 && i !dmix->
hw_fd
)

343 
	`˛o£
(
i
);

347 
	`£tsid
();

349 
pfds
[0].
fd
 = 
dmix
->
£rvî_fd
;

350 
pfds
[0].
evíts
 = 
POLLIN
 | 
POLLERR
 | 
POLLHUP
;

352 
	`£rvî_¥ötf
("DIRECT SERVER STARTED\n");

354 
ªt
 = 
	`pﬁl
(
pfds
, 
cuºít
 + 1, 500);

355 
	`£rvî_¥ötf
("DIRECT SERVER:Öﬁ»ªà%i,Ñevíts[0] = 0x%x,Éºnÿ%i\n", 
ªt
, 
pfds
[0].
ªvíts
, 
î∫o
);

356 i‡(
ªt
 < 0) {

357 i‡(
î∫o
 =
EINTR
)

362 i‡(
ªt
 =0 || (
pfds
[0].
ªvíts
 & (
POLLERR
 | 
POLLHUP
))) {

363 
shmid_ds
 
buf
;

364 
	`¢d_pcm_dúe˘_£m≠h‹e_down
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

365 i‡(
	`shm˘l
(
dmix
->
shmid
, 
IPC_STAT
, &
buf
) < 0) {

366 
	`_¢d_pcm_dúe˘_shm_disˇrd
(
dmix
);

367 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

370 
	`£rvî_¥ötf
("DIRECT SERVER:Ç©tch = %i\n", ()
buf
.
shm_«âch
);

371 i‡(
buf
.
shm_«âch
 == 1)

373 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

376 i‡(
pfds
[0].
ªvíts
 & 
POLLIN
) {

377 
ªt
--;

378 
sck
 = 
	`ac˚±
(
dmix
->
£rvî_fd
, 0, 0);

379 i‡(
sck
 >= 0) {

380 
	`£rvî_¥ötf
("DIRECT SERVER:Çew c⁄√˘i⁄ %i\n", 
sck
);

381 i‡(
cuºít
 =
max
) {

382 
	`˛o£
(
sck
);

384 
buf
 = 'A';

385 
pfds
[
cuºít
+1].
fd
 = 
sck
;

386 
pfds
[
cuºít
+1].
evíts
 = 
POLLIN
 | 
POLLERR
 | 
POLLHUP
;

387 
	`_¢d_£nd_fd
(
sck
, &
buf
, 1, 
dmix
->
hw_fd
);

388 
	`£rvî_¥ötf
("DIRECT SERVER: fd sent ok\n");

389 
cuºít
++;

393 
i
 = 0; i < 
cuºít
 && 
ªt
 > 0; i++) {

394 
pﬁlfd
 *
pfd
 = &
pfds
[
i
+1];

395 
cmd
;

396 
	`£rvî_¥ötf
("˛õ¡ %òªvít†0x%x\n", 
pfd
->
fd
,Öfd->
ªvíts
);

397 i‡(
pfd
->
ªvíts
 & (
POLLERR
 | 
POLLHUP
)) {

398 
ªt
--;

399 
	`˛o£
(
pfd
->
fd
);

400 
pfd
->
fd
 = -1;

403 i‡(!(
pfd
->
ªvíts
 & 
POLLIN
))

405 
ªt
--;

406 i‡(
	`ªad
(
pfd
->
fd
, &
cmd
, 1) == 1)

407 
cmd
 = 0 ;

409 
i
 = 0; i < 
cuºít
; i++) {

410 i‡(
pfds
[
i
+1].
fd
 < 0) {

411 i‡(
i
 + 1 !
max
)

412 
	`mem˝y
(&
pfds
[
i
+1], &pfds[i+2], (
pﬁlfd
Ë* (
max
 - i - 1));

413 
cuºít
--;

417 
	`£rvî_˛ónup
(
dmix
);

418 
	`£rvî_¥ötf
("DIRECT SERVER EXIT\n");

419 #ifde‡
SERVER_JOB_DEBUG


420 
	`˛o£
(0); close(1); close(2);

422 
	`_exô
(
EXIT_SUCCESS
);

423 
	}
}

425 
	$¢d_pcm_dúe˘_£rvî_¸óã
(
¢d_pcm_dúe˘_t
 *
dmix
)

427 
ªt
;

429 
dmix
->
£rvî_fd
 = -1;

431 
ªt
 = 
	`gë_tmp_«me
(
dmix
->
shm±r
->
sockë_«me
, (dmix->shmptr->socket_name));

432 i‡(
ªt
 < 0)

433  
ªt
;

435 
ªt
 = 
	`make_loˇl_sockë
(
dmix
->
shm±r
->
sockë_«me
, 1, dmix->
ùc_≥rm
, dmix->
ùc_gid
);

436 i‡(
ªt
 < 0)

437  
ªt
;

438 
dmix
->
£rvî_fd
 = 
ªt
;

440 
ªt
 = 
	`li°í
(
dmix
->
£rvî_fd
, 4);

441 i‡(
ªt
 < 0) {

442 
	`˛o£
(
dmix
->
£rvî_fd
);

443  
ªt
;

446 
ªt
 = 
	`f‹k
();

447 i‡(
ªt
 < 0) {

448 
	`˛o£
(
dmix
->
£rvî_fd
);

449  
ªt
;

450 } i‡(
ªt
 == 0) {

451 
ªt
 = 
	`f‹k
();

452 i‡(
ªt
 == 0)

453 
	`£rvî_job
(
dmix
);

454 
	`_exô
(
EXIT_SUCCESS
);

456 
	`waôpid
(
ªt
, 
NULL
, 0);

458 
dmix
->
£rvî_pid
 = 
ªt
;

459 
dmix
->
£rvî
 = 1;

461 
	}
}

463 
	$¢d_pcm_dúe˘_£rvî_disˇrd
(
¢d_pcm_dúe˘_t
 *
dmix
)

465 i‡(
dmix
->
£rvî
) {

468 
dmix
->
£rvî_pid
 = (
pid_t
)-1;

470 i‡(
dmix
->
£rvî_fd
 > 0) {

471 
	`˛o£
(
dmix
->
£rvî_fd
);

472 
dmix
->
£rvî_fd
 = -1;

474 
dmix
->
£rvî
 = 0;

476 
	}
}

482 
	$¢d_pcm_dúe˘_˛õ¡_c⁄√˘
(
¢d_pcm_dúe˘_t
 *
dmix
)

484 
ªt
;

485 
buf
;

487 
ªt
 = 
	`make_loˇl_sockë
(
dmix
->
shm±r
->
sockë_«me
, 0, -1, -1);

488 i‡(
ªt
 < 0)

489  
ªt
;

490 
dmix
->
comm_fd
 = 
ªt
;

492 
ªt
 = 
	`¢d_ª˚ive_fd
(
dmix
->
comm_fd
, &
buf
, 1, &dmix->
hw_fd
);

493 i‡(
ªt
 < 1 || 
buf
 != 'A') {

494 
	`˛o£
(
dmix
->
comm_fd
);

495 
dmix
->
comm_fd
 = -1;

496  
ªt
;

499 
dmix
->
˛õ¡
 = 1;

501 
	}
}

503 
	$¢d_pcm_dúe˘_˛õ¡_disˇrd
(
¢d_pcm_dúe˘_t
 *
dmix
)

505 i‡(
dmix
->
˛õ¡
) {

506 
	`˛o£
(
dmix
->
comm_fd
);

507 
dmix
->
comm_fd
 = -1;

510 
	}
}

516 
	$¢d_pcm_dúe˘_n⁄block
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
n⁄block
 ATTRIBUTE_UNUSED)

520 
	}
}

522 
	$¢d_pcm_dúe˘_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
)

524 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

525  
	`¢d_timî_async
(
dmix
->
timî
, 
sig
, 
pid
);

526 
	}
}

529 
	$¢d_pcm_dúe˘_˛ór_timî_queue
(
¢d_pcm_dúe˘_t
 *
dmix
)

531 
ch™ged
 = 0;

532 i‡(
dmix
->
timî_√ed_pﬁl
) {

533 
	`pﬁl
(&
dmix
->
timî_fd
, 1, 0) > 0) {

534 
ch™ged
++;

536 i‡(
dmix
->
åód
) {

537 
¢d_timî_åód_t
 
rbuf
[4];

538 
	`¢d_timî_ªad
(
dmix
->
timî
, 
rbuf
, (rbuf));

540 
¢d_timî_ªad_t
 
rbuf
;

541 
	`¢d_timî_ªad
(
dmix
->
timî
, &
rbuf
, (rbuf));

545 i‡(
dmix
->
åód
) {

546 
¢d_timî_åód_t
 
rbuf
[4];

547 
Àn
;

548 (
Àn
 = 
	`¢d_timî_ªad
(
dmix
->
timî
, 
rbuf
,

549 (
rbuf
))) > 0

550 && (++
ch™ged
) &&

551 
Àn
 !(
rbuf
[0]))

554 
¢d_timî_ªad_t
 
rbuf
;

555 
	`¢d_timî_ªad
(
dmix
->
timî
, &
rbuf
, (rbuf)) > 0)

556 
ch™ged
++;

559  
ch™ged
;

560 
	}
}

562 
	$¢d_pcm_dúe˘_timî_°›
(
¢d_pcm_dúe˘_t
 *
dmix
)

564 
	`¢d_timî_°›
(
dmix
->
timî
);

566 
	}
}

568 
	#RECOVERIES_FLAG_SUSPENDED
 (1U << 31)

	)

569 
	#RECOVERIES_MASK
 ((1U << 31Ë- 1)

	)

578 
	$¢d_pcm_dúe˘_¶ave_ªcovî
(
¢d_pcm_dúe˘_t
 *
dúe˘
)

580 
ªcovîõs
;

581 
°©e
;

582 
ªt
;

583 
£mîr
;

585 
£mîr
 = 
	`¢d_pcm_dúe˘_£m≠h‹e_down
(
dúe˘
,

586 
DIRECT_IPC_SEM_CLIENT
);

587 i‡(
£mîr
 < 0) {

588 
	`SNDERR
("SEMDOWN FAILED wôhÉº %d", 
£mîr
);

589  
£mîr
;

592 
°©e
 = 
	`¢d_pcm_°©e
(
dúe˘
->
•cm
);

593 i‡(
°©e
 !
SND_PCM_STATE_XRUN
 && sèã !
SND_PCM_STATE_SUSPENDED
) {

595 
£mîr
 = 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
dúe˘
,

596 
DIRECT_IPC_SEM_CLIENT
);

597 i‡(
£mîr
 < 0) {

598 
	`SNDERR
("SEMUP FAILED wôhÉº %d", 
£mîr
);

599  
£mîr
;

604 
ªcovîõs
 = 
dúe˘
->
shm±r
->
s
.recoveries;

605 
ªcovîõs
 = (ªcovîõ†+ 1Ë& 
RECOVERIES_MASK
;

606 i‡(
°©e
 =
SND_PCM_STATE_SUSPENDED
)

607 
ªcovîõs
 |
RECOVERIES_FLAG_SUSPENDED
;

608 
dúe˘
->
shm±r
->
s
.
ªcovîõs
 =Ñecoveries;

614 i‡(
°©e
 =
SND_PCM_STATE_SUSPENDED
 &&

615 (
dúe˘
->
•cm
->
öfo
 & 
SND_PCM_INFO_RESUME
)) {

616 
	`¢d_pcm_ªsume
(
dúe˘
->
•cm
);

617 
	`¢d_pcm_dr›
(
dúe˘
->
•cm
);

618 
	`¢d_pcm_dúe˘_timî_°›
(
dúe˘
);

619 
	`¢d_pcm_dúe˘_˛ór_timî_queue
(
dúe˘
);

622 
ªt
 = 
	`¢d_pcm_¥ï¨e
(
dúe˘
->
•cm
);

623 i‡(
ªt
 < 0) {

624 
	`SNDERR
("recover: unableÅoÖrepare slave");

625 
£mîr
 = 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
dúe˘
,

626 
DIRECT_IPC_SEM_CLIENT
);

627 i‡(
£mîr
 < 0) {

628 
	`SNDERR
("SEMUP FAILED wôhÉº %d", 
£mîr
);

629  
£mîr
;

631  
ªt
;

634 i‡(
dúe˘
->
ty≥
 =
SND_PCM_TYPE_DSHARE
) {

635 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
;

636 
d°_¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
dúe˘
->
•cm
);

637 
	`¢d_pcm_¨ós_sûí˚
(
d°_¨ós
, 0, 
dúe˘
->
•cm
->
ch™√ls
,

638 
dúe˘
->
•cm
->
buf„r_size
,

639 
dúe˘
->
•cm
->
f‹m©
);

642 
ªt
 = 
	`¢d_pcm_°¨t
(
dúe˘
->
•cm
);

643 i‡(
ªt
 < 0) {

644 
	`SNDERR
("recover: unableÅo start slave");

645 
£mîr
 = 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
dúe˘
,

646 
DIRECT_IPC_SEM_CLIENT
);

647 i‡(
£mîr
 < 0) {

648 
	`SNDERR
("SEMUP FAILED wôhÉº %d", 
£mîr
);

649  
£mîr
;

651  
ªt
;

653 
£mîr
 = 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
dúe˘
,

654 
DIRECT_IPC_SEM_CLIENT
);

655 i‡(
£mîr
 < 0) {

656 
	`SNDERR
("SEMUP FAILED wôhÉº %d", 
£mîr
);

657  
£mîr
;

660 
	}
}

666 
	$¢d_pcm_dúe˘_check_xrun
(
¢d_pcm_dúe˘_t
 *
dúe˘
, 
¢d_pcm_t
 *
pcm
)

668 
îr
;

670 
	`¢d_pcm_°©e
(
dúe˘
->
•cm
)) {

671 
SND_PCM_STATE_DISCONNECTED
:

672 
dúe˘
->
°©e
 = 
SNDRV_PCM_STATE_DISCONNECTED
;

673  -
ENODEV
;

674 
SND_PCM_STATE_XRUN
:

675 
SND_PCM_STATE_SUSPENDED
:

676 i‡((
îr
 = 
	`¢d_pcm_dúe˘_¶ave_ªcovî
(
dúe˘
)) < 0)

677  
îr
;

683 i‡(
dúe˘
->
°©e
 =
SND_PCM_STATE_XRUN
)

684  -
EPIPE
;

685 i‡(
dúe˘
->
°©e
 =
SND_PCM_STATE_SUSPENDED
)

686  -
ESTRPIPE
;

687 i‡(
dúe˘
->
shm±r
->
s
.
ªcovîõs
 != direct->recoveries) {

691 
dúe˘
->
ªcovîõs
 = dúe˘->
shm±r
->
s
.recoveries;

692 
pcm
->
Á°_›s
->
	`dr›
’cm->
Á°_›_¨g
);

694 
	`gëtime°amp
(&
dúe˘
->
åiggî_t°amp
, 
pcm
->
t°amp_ty≥
);

699 i‡(
dúe˘
->
ªcovîõs
 & 
RECOVERIES_FLAG_SUSPENDED
) {

700 
dúe˘
->
°©e
 = 
SND_PCM_STATE_SUSPENDED
;

701  -
ESTRPIPE
;

703 
dúe˘
->
°©e
 = 
SND_PCM_STATE_XRUN
;

704  -
EPIPE
;

708 
	}
}

726 
	$¢d_pcm_dúe˘_pﬁl_des¸ùt‹s
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
,

727 
•a˚
)

729 i‡(
pcm
->
pﬁl_fd
 < 0) {

730 
	`SNDMSG
("poll_fd < 0");

731  -
EIO
;

733 i‡(
•a˚
 >1 && 
pfds
) {

734 
pfds
->
fd
 = 
pcm
->
pﬁl_fd
;

735 
pfds
->
evíts
 = 
pcm
->
pﬁl_evíts
 | 
POLLERR
 | 
POLLNVAL
;

742 
	`__¢d_pcm_°©e
(
pcm
)) {

743 
SND_PCM_STATE_XRUN
:

744  -
EPIPE
;

749 
	}
}

751 
	$¢d_pcm_dúe˘_pﬁl_ªvíts
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

753 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

754 
evíts
;

755 
em±y
 = 0;

757 
	`as£π
(
pfds
 && 
nfds
 =1 && 
ªvíts
);

759 
timî_ch™ged
:

760 
evíts
 = 
pfds
[0].
ªvíts
;

761 i‡(
evíts
 & 
POLLIN
) {

762 
¢d_pcm_u‰ames_t
 
avaû
;

763 
	`__¢d_pcm_avaû_upd©e
(
pcm
);

764 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

765 
evíts
 |
POLLOUT
;

766 
evíts
 &~
POLLIN
;

767 
avaû
 = 
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
);

769 
avaû
 = 
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
pcm
);

771 
em±y
 = 
avaû
 < 
pcm
->
avaû_mö
;

774 i‡(
	`¢d_pcm_dúe˘_check_xrun
(
dmix
, 
pcm
) < 0 ||

775 
	`¢d_pcm_°©e
(
dmix
->
•cm
Ë=
SND_PCM_STATE_SETUP
) {

776 
evíts
 |
POLLERR
;

778 i‡(
em±y
) {

787 i‡(
	`¢d_pcm_dúe˘_˛ór_timî_queue
(
dmix
))

788 
timî_ch™ged
;

789 
evíts
 &~(
POLLOUT
|
POLLIN
);

791 
	`__¢d_pcm_°©e
(
pcm
)) {

792 
SND_PCM_STATE_XRUN
:

793 
SND_PCM_STATE_SUSPENDED
:

794 
SND_PCM_STATE_SETUP
:

795 
evíts
 |
POLLERR
;

802 *
ªvíts
 = 
evíts
;

804 
	}
}

806 
	$¢d_pcm_dúe˘_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_öfo_t
 * 
öfo
)

808 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

810 i‡(
dmix
->
•cm
 && !dmix->
shm±r
->
u£_£rvî
)

811  
	`¢d_pcm_öfo
(
dmix
->
•cm
, 
öfo
);

813 
	`mem£t
(
öfo
, 0, (*info));

814 
öfo
->
°ªam
 = 
pcm
->stream;

815 
öfo
->
ˇrd
 = -1;

817 i‡(
pcm
->
«me
) {

818 
	`¢d_°æ˝y
((*)
öfo
->
id
, 
pcm
->
«me
, (info->id));

819 
	`¢d_°æ˝y
((*)
öfo
->
«me
, 
pcm
->name, (info->name));

820 
	`¢d_°æ˝y
((*)
öfo
->
sub«me
, 
pcm
->
«me
, (info->subname));

822 
öfo
->
subdevi˚s_cou¡
 = 1;

824 
	}
}

826 
ölöe
 
¢d_mask_t
 *
	$hw_∑øm_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

827 
¢d_pcm_hw_∑øm_t
 
v¨
)

829  &
∑øms
->
masks
[
v¨
 - 
SND_PCM_HW_PARAM_FIRST_MASK
];

830 
	}
}

832 
ölöe
 
¢d_öãrvÆ_t
 *
	$hw_∑øm_öãrvÆ
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

833 
¢d_pcm_hw_∑øm_t
 
v¨
)

835  &
∑øms
->
öãrvÆs
[
v¨
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
];

836 
	}
}

838 
	$hw_∑øm_öãrvÆ_ªföe_⁄e
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

839 
¢d_pcm_hw_∑øm_t
 
v¨
,

840 
¢d_öãrvÆ_t
 *
§c
)

842 
¢d_öãrvÆ_t
 *
i
;

844 i‡(!(
∑øms
->
rmask
 & (1<<
v¨
)))

846 
i
 = 
	`hw_∑øm_öãrvÆ
(
∑øms
, 
v¨
);

847 i‡(
	`¢d_öãrvÆ_em±y
(
i
)) {

848 
	`SNDERR
("dsh¨êöãrvÆ %òem±y?", ()
v¨
);

849  -
EINVAL
;

851 i‡(
	`¢d_öãrvÆ_ªföe
(
i
, 
§c
))

852 
∑øms
->
cmask
 |1<<
v¨
;

854 
	}
}

856 
	$hw_∑øm_öãrvÆ_ªföe_mömax
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

857 
¢d_pcm_hw_∑øm_t
 
v¨
,

858 
imö
,

859 
imax
)

861 
¢d_öãrvÆ_t
 
t
;

863 
	`mem£t
(&
t
, 0, (t));

864 
	`¢d_öãrvÆ_£t_mömax
(&
t
, 
imö
, 
imax
);

865 
t
.
öãgî
 = 1;

866  
	`hw_∑øm_öãrvÆ_ªföe_⁄e
(
∑øms
, 
v¨
, &
t
);

867 
	}
}

870 
	$¢d_öãrvÆ_°ï
(
¢d_öãrvÆ
 *
i
, 
mö
,

871 
°ï
)

873 
n
;

874 
ch™ged
 = 0;

875 
n
 = (
i
->
mö
 - möË% 
°ï
;

876 i‡(
n
 !0 || 
i
->
›ímö
) {

877 
i
->
mö
 +
°ï
 - 
n
;

878 
ch™ged
 = 1;

880 
n
 = (
i
->
max
 - 
mö
Ë% 
°ï
;

881 i‡(
n
 !0 || 
i
->
›ímax
) {

882 
i
->
max
 -
n
;

883 
ch™ged
 = 1;

885 i‡(
	`¢d_öãrvÆ_checkem±y
(
i
)) {

886 
i
->
em±y
 = 1;

887  -
EINVAL
;

889  
ch™ged
;

890 
	}
}

892 #unde‡
REFINE_DEBUG


894 
	$¢d_pcm_dúe˘_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

896 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

897 c⁄° 
¢d_mask_t
 
ac˚ss
 = { .
bôs
 = {

898 (1<<
SNDRV_PCM_ACCESS_MMAP_INTERLEAVED
) |

899 (1<<
SNDRV_PCM_ACCESS_MMAP_NONINTERLEAVED
) |

900 (1<<
SNDRV_PCM_ACCESS_RW_INTERLEAVED
) |

901 (1<<
SNDRV_PCM_ACCESS_RW_NONINTERLEAVED
),

903 
îr
;

905 #ifde‡
REFINE_DEBUG


906 
¢d_ouçut_t
 *
log
;

907 
	`¢d_ouçut_°dio_©èch
(&
log
, 
°dîr
, 0);

908 
	`¢d_ouçut_puts
(
log
, "DMIX REFINE (begin):\n");

909 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
log
);

911 i‡(
∑øms
->
rmask
 & (1<<
SND_PCM_HW_PARAM_ACCESS
)) {

912 i‡(
	`¢d_mask_em±y
(
	`hw_∑øm_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
))) {

913 
	`SNDERR
("dshareáccess maskÉmpty?");

914  -
EINVAL
;

916 i‡(
	`¢d_mask_ªföe
(
	`hw_∑øm_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
), &
ac˚ss
))

917 
∑øms
->
cmask
 |1<<
SND_PCM_HW_PARAM_ACCESS
;

919 i‡(
∑øms
->
rmask
 & (1<<
SND_PCM_HW_PARAM_FORMAT
)) {

920 i‡(
	`¢d_mask_em±y
(
	`hw_∑øm_mask
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
))) {

921 
	`SNDERR
("dshare format maskÉmpty?");

922  -
EINVAL
;

924 i‡(
	`¢d_mask_ªföe_£t
(
	`hw_∑øm_mask
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
),

925 
dsh¨e
->
shm±r
->
hw
.
f‹m©
))

926 
∑øms
->
cmask
 |1<<
SND_PCM_HW_PARAM_FORMAT
;

929 i‡(
∑øms
->
rmask
 & (1<<
SND_PCM_HW_PARAM_CHANNELS
)) {

930 i‡(
	`¢d_öãrvÆ_em±y
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
))) {

931 
	`SNDERR
("dshare channels maskÉmpty?");

932  -
EINVAL
;

934 
îr
 = 
	`¢d_öãrvÆ_ªföe_£t
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
), 
dsh¨e
->
ch™√ls
);

935 i‡(
îr
 < 0)

936  
îr
;

938 
îr
 = 
	`hw_∑øm_öãrvÆ_ªföe_⁄e
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
,

939 &
dsh¨e
->
shm±r
->
hw
.
øã
);

940 i‡(
îr
 < 0)

941  
îr
;

943 i‡(
dsh¨e
->
max_≥riods
 < 0) {

944 
îr
 = 
	`hw_∑øm_öãrvÆ_ªföe_⁄e
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

945 &
dsh¨e
->
shm±r
->
hw
.
≥riod_size
);

946 i‡(
îr
 < 0)

947  
îr
;

948 
îr
 = 
	`hw_∑øm_öãrvÆ_ªföe_⁄e
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
,

949 &
dsh¨e
->
shm±r
->
hw
.
≥riod_time
);

950 i‡(
îr
 < 0)

951  
îr
;

952 
îr
 = 
	`hw_∑øm_öãrvÆ_ªföe_⁄e
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

953 &
dsh¨e
->
shm±r
->
hw
.
buf„r_size
);

954 i‡(
îr
 < 0)

955  
îr
;

956 
îr
 = 
	`hw_∑øm_öãrvÆ_ªföe_⁄e
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
,

957 &
dsh¨e
->
shm±r
->
hw
.
buf„r_time
);

958 i‡(
îr
 < 0)

959  
îr
;

960 } i‡(
∑øms
->
rmask
 & ((1<<
SND_PCM_HW_PARAM_PERIODS
)|

961 (1<<
SND_PCM_HW_PARAM_BUFFER_BYTES
)|

962 (1<<
SND_PCM_HW_PARAM_BUFFER_SIZE
)|

963 (1<<
SND_PCM_HW_PARAM_BUFFER_TIME
)|

964 (1<<
SND_PCM_HW_PARAM_PERIOD_TIME
)|

965 (1<<
SND_PCM_HW_PARAM_PERIOD_SIZE
)|

966 (1<<
SND_PCM_HW_PARAM_PERIOD_BYTES
))) {

967 
¢d_öãrvÆ_t
 
≥riod_size
 = 
dsh¨e
->
shm±r
->
hw
.period_size;

968 
¢d_öãrvÆ_t
 
≥riod_time
 = 
dsh¨e
->
shm±r
->
hw
.period_time;

969 
ch™ged
;

970 
max_≥riods
 = 
dsh¨e
->max_periods;

971 i‡(
max_≥riods
 < 2)

972 
max_≥riods
 = 
dsh¨e
->
¶ave_buf„r_size
 / dsh¨e->
¶ave_≥riod_size
;

975 
îr
 = 
	`hw_∑øm_öãrvÆ_ªföe_mömax
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

976 2 * 
dsh¨e
->
¶ave_≥riod_size
, dsh¨e->
¶ave_buf„r_size
);

977 i‡(
îr
 < 0)

978  
îr
;

979 i‡(
dsh¨e
->
v¨_≥riodsize
) {

981 i‡(
dsh¨e
->
shm±r
->
hw
.
buf„r_size
.
max
 / 2 > 
≥riod_size
.max) {

982 
≥riod_size
.
max
 = 
dsh¨e
->
shm±r
->
hw
.
buf„r_size
.max / 2;

983 
≥riod_size
.
›ímax
 = 
dsh¨e
->
shm±r
->
hw
.
buf„r_size
.openmax;

985 i‡(
dsh¨e
->
shm±r
->
hw
.
buf„r_time
.
max
 / 2 > 
≥riod_time
.max) {

986 
≥riod_time
.
max
 = 
dsh¨e
->
shm±r
->
hw
.
buf„r_time
.max / 2;

987 
≥riod_time
.
›ímax
 = 
dsh¨e
->
shm±r
->
hw
.
buf„r_time
.openmax;

991 
îr
 = 
	`hw_∑øm_öãrvÆ_ªföe_⁄e
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

992 &
≥riod_size
);

993 i‡(
îr
 < 0)

994  
îr
;

995 
îr
 = 
	`hw_∑øm_öãrvÆ_ªföe_⁄e
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
,

996 &
≥riod_time
);

997 i‡(
îr
 < 0)

998  
îr
;

1000 
ch™ged
 = 0;

1001 
îr
 = 
	`hw_∑øm_öãrvÆ_ªföe_mömax
(
∑øms
, 
SND_PCM_HW_PARAM_PERIODS
,

1002 2, 
max_≥riods
);

1003 i‡(
îr
 < 0)

1004  
îr
;

1005 
ch™ged
 |
îr
;

1006 
îr
 = 
	`¢d_pcm_hw_ªföe_so·
(
pcm
, 
∑øms
);

1007 i‡(
îr
 < 0)

1008  
îr
;

1009 
ch™ged
 |
îr
;

1010 
îr
 = 
	`¢d_öãrvÆ_°ï
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
),

1011 0, 
dsh¨e
->
¶ave_≥riod_size
);

1012 i‡(
îr
 < 0)

1013  
îr
;

1014 
ch™ged
 |
îr
;

1015 i‡(
îr
)

1016 
∑øms
->
rmask
 |(1 << 
SND_PCM_HW_PARAM_PERIOD_SIZE
);

1017 } 
ch™ged
);

1019 
dsh¨e
->
timî_ticks
 = 
	`hw_∑øm_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
)->
max
 / dsh¨e->
¶ave_≥riod_size
;

1020 
∑øms
->
öfo
 = 
dsh¨e
->
shm±r
->
s
.info;

1021 #ifde‡
REFINE_DEBUG


1022 
	`¢d_ouçut_puts
(
log
, "DMIX REFINE (end):\n");

1023 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
log
);

1024 
	`¢d_ouçut_˛o£
(
log
);

1027 
	}
}

1029 
	$¢d_pcm_dúe˘_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 * 
∑øms
)

1031 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

1033 
∑øms
->
öfo
 = 
dmix
->
shm±r
->
s
.info;

1034 
∑øms
->
øã_num
 = 
dmix
->
shm±r
->
s
.
øã
;

1035 
∑øms
->
øã_dí
 = 1;

1036 
∑øms
->
fifo_size
 = 0;

1037 
∑øms
->
msbôs
 = 
dmix
->
shm±r
->
s
.msbits;

1039 
	}
}

1041 
	$¢d_pcm_dúe˘_hw_‰ì
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1045 
	}
}

1047 
	$¢d_pcm_dúe˘_sw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
)

1049 i‡(
∑øms
->
t°amp_ty≥
 !
pcm
->tstamp_type)

1050  -
EINVAL
;

1054 
	}
}

1056 
	$¢d_pcm_dúe˘_ch™√l_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_öfo_t
 * 
öfo
)

1058  
	`¢d_pcm_ch™√l_öfo_shm
(
pcm
, 
öfo
, -1);

1059 
	}
}

1061 
	$¢d_pcm_dúe˘_mm≠
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1064 
	}
}

1066 
	$¢d_pcm_dúe˘_munm≠
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1069 
	}
}

1071 
¢d_pcm_chm≠_quîy_t
 **
	$¢d_pcm_dúe˘_quîy_chm≠s
(
¢d_pcm_t
 *
pcm
)

1073 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

1074 
¢d_pcm_chm≠_quîy_t
 **
sm≠s
, **
m≠s
;

1075 
i
, 
j
;

1077 i‡(
dmix
->
bödögs
 =
NULL
)

1078  
	`¢d_pcm_quîy_chm≠s
(
dmix
->
•cm
);

1080 
m≠s
 = 
	`ˇŒoc
(2, (*maps));

1081 i‡(!
m≠s
)

1082  
NULL
;

1083 
m≠s
[0] = 
	`ˇŒoc
(
dmix
->
ch™√ls
 + 2, (*));

1084 i‡(!
m≠s
[0]) {

1085 
	`‰ì
(
m≠s
);

1086  
NULL
;

1088 
sm≠s
 = 
	`¢d_pcm_quîy_chm≠s
(
dmix
->
•cm
);

1089 i‡(
sm≠s
 =
NULL
) {

1090 
	`¢d_pcm_‰ì_chm≠s
(
m≠s
);

1091  
NULL
;

1093 
m≠s
[0]->
ty≥
 = 
SND_CHMAP_TYPE_FIXED
;

1094 
m≠s
[0]->
m≠
.
ch™√ls
 = 
dmix
->channels;

1095 
i
 = 0; i < 
dmix
->
ch™√ls
; i++) {

1096 
j
 = 
dmix
->
bödögs
[
i
];

1097 i‡(
j
 =
UINT_MAX
 || 
sm≠s
[0]->
m≠
.
ch™√ls
 < j)

1099 
m≠s
[0]->
m≠
.
pos
[
i
] = 
sm≠s
[0]->m≠.pos[
j
];

1101  
m≠s
;

1102 
	}
}

1104 
¢d_pcm_chm≠_t
 *
	$¢d_pcm_dúe˘_gë_chm≠
(
¢d_pcm_t
 *
pcm
)

1106 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

1107  
	`¢d_pcm_gë_chm≠
(
dmix
->
•cm
);

1108 
	}
}

1110 
	$¢d_pcm_dúe˘_£t_chm≠
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_chm≠_t
 *
m≠
)

1112 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

1113  
	`¢d_pcm_£t_chm≠
(
dmix
->
•cm
, 
m≠
);

1114 
	}
}

1116 
	$¢d_pcm_dúe˘_¥ï¨e
(
¢d_pcm_t
 *
pcm
)

1118 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

1119 
îr
;

1121 
	`¢d_pcm_°©e
(
dmix
->
•cm
)) {

1122 
SND_PCM_STATE_SETUP
:

1123 
SND_PCM_STATE_XRUN
:

1124 
SND_PCM_STATE_SUSPENDED
:

1125 
îr
 = 
	`¢d_pcm_¥ï¨e
(
dmix
->
•cm
);

1126 i‡(
îr
 < 0)

1127  
îr
;

1128 
	`¢d_pcm_°¨t
(
dmix
->
•cm
);

1130 
SND_PCM_STATE_OPEN
:

1131 
SND_PCM_STATE_DISCONNECTED
:

1132  -
EBADFD
;

1136 
	`¢d_pcm_dúe˘_check_öãæóve
(
dmix
, 
pcm
);

1137 
dmix
->
°©e
 = 
SND_PCM_STATE_PREPARED
;

1138 
dmix
->
≠∂_±r
 = dmix->
œ°_≠∂_±r
 = 0;

1139 
dmix
->
hw_±r
 = 0;

1140  
	`¢d_pcm_dúe˘_£t_timî_∑øms
(
dmix
);

1141 
	}
}

1143 
	$¢d_pcm_dúe˘_ªsume
(
¢d_pcm_t
 *
pcm
)

1145 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

1146 
îr
;

1148 
îr
 = 
	`¢d_pcm_dúe˘_¶ave_ªcovî
(
dmix
);

1149  
îr
 < 0 ?Éº : -
ENOSYS
;

1150 
	}
}

1152 
	#COPY_SLAVE
(
fõld
Ë(
dmix
->
shm±r
->
s
.fõld = 
•cm
->fõld)

	)

1155 
	$ßve_¶ave_£âög
(
¢d_pcm_dúe˘_t
 *
dmix
, 
¢d_pcm_t
 *
•cm
)

1157 
•cm
->
öfo
 &~
SND_PCM_INFO_PAUSE
;

1159 
	`COPY_SLAVE
(
ac˚ss
);

1160 
	`COPY_SLAVE
(
f‹m©
);

1161 
	`COPY_SLAVE
(
subf‹m©
);

1162 
	`COPY_SLAVE
(
ch™√ls
);

1163 
	`COPY_SLAVE
(
øã
);

1164 
	`COPY_SLAVE
(
≥riod_size
);

1165 
	`COPY_SLAVE
(
≥riod_time
);

1166 
	`COPY_SLAVE
(
≥riods
);

1167 
	`COPY_SLAVE
(
t°amp_mode
);

1168 
	`COPY_SLAVE
(
t°amp_ty≥
);

1169 
	`COPY_SLAVE
(
≥riod_°ï
);

1170 
	`COPY_SLAVE
(
avaû_mö
);

1171 
	`COPY_SLAVE
(
°¨t_thªshﬁd
);

1172 
	`COPY_SLAVE
(
°›_thªshﬁd
);

1173 
	`COPY_SLAVE
(
sûí˚_thªshﬁd
);

1174 
	`COPY_SLAVE
(
sûí˚_size
);

1175 
	`COPY_SLAVE
(
bound¨y
);

1176 
	`COPY_SLAVE
(
öfo
);

1177 
	`COPY_SLAVE
(
msbôs
);

1178 
	`COPY_SLAVE
(
øã_num
);

1179 
	`COPY_SLAVE
(
øã_dí
);

1180 
	`COPY_SLAVE
(
hw_Êags
);

1181 
	`COPY_SLAVE
(
fifo_size
);

1182 
	`COPY_SLAVE
(
buf„r_size
);

1183 
	`COPY_SLAVE
(
buf„r_time
);

1184 
	`COPY_SLAVE
(
ßm∂e_bôs
);

1185 
	`COPY_SLAVE
(
‰ame_bôs
);

1187 
dmix
->
shm±r
->
s
.
öfo
 &~
SND_PCM_INFO_RESUME
;

1188 
	}
}

1190 #unde‡
COPY_SLAVE


1197 
	$¢d_pcm_dúe˘_öôülize_¶ave
(
¢d_pcm_dúe˘_t
 *
dmix
, 
¢d_pcm_t
 *
•cm
, 
¶ave_∑øms
 *
∑øms
)

1199 
¢d_pcm_hw_∑øms_t
 
hw_∑øms
 = {0};

1200 
¢d_pcm_sw_∑øms_t
 
sw_∑øms
 = {0};

1201 
ªt
, 
buf„r_is_nŸ_öôülized
;

1202 
¢d_pcm_u‰ames_t
 
bound¨y
;

1203 
pﬁlfd
 
fd
;

1204 
lo›s
 = 10;

1206 
__agaö
:

1207 i‡(
lo›s
-- <= 0) {

1208 
	`SNDERR
("unableÅo findá valid configuration for slave");

1209  -
EINVAL
;

1211 
ªt
 = 
	`¢d_pcm_hw_∑øms_™y
(
•cm
, &
hw_∑øms
);

1212 i‡(
ªt
 < 0) {

1213 
	`SNDERR
("snd_pcm_hw_params_any failed");

1214  
ªt
;

1216 
ªt
 = 
	`¢d_pcm_hw_∑øms_£t_ac˚ss
(
•cm
, &
hw_∑øms
,

1217 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

1218 i‡(
ªt
 < 0) {

1219 
ªt
 = 
	`¢d_pcm_hw_∑øms_£t_ac˚ss
(
•cm
, &
hw_∑øms
,

1220 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

1221 i‡(
ªt
 < 0) {

1222 
	`SNDERR
("slaveÖlugin doesÇot support mmap interleaved or mmapÇoninterleavedáccess");

1223  
ªt
;

1226 i‡(
∑øms
->
f‹m©
 =
SND_PCM_FORMAT_UNKNOWN
)

1227 
ªt
 = -
EINVAL
;

1229 
ªt
 = 
	`¢d_pcm_hw_∑øms_£t_f‹m©
(
•cm
, &
hw_∑øms
,

1230 
∑øms
->
f‹m©
);

1231 i‡(
ªt
 < 0) {

1232 c⁄° 
¢d_pcm_f‹m©_t
 
dmix_f‹m©s
[] = {

1233 
SND_PCM_FORMAT_S32
,

1234 
SND_PCM_FORMAT_S32
 ^ 
SND_PCM_FORMAT_S32_LE
 ^

1235 
SND_PCM_FORMAT_S32_BE
,

1236 
SND_PCM_FORMAT_S16
,

1237 
SND_PCM_FORMAT_S16
 ^ 
SND_PCM_FORMAT_S16_LE
 ^

1238 
SND_PCM_FORMAT_S16_BE
,

1239 
SND_PCM_FORMAT_S24_LE
,

1240 
SND_PCM_FORMAT_S24_3LE
,

1241 
SND_PCM_FORMAT_U8
,

1243 
¢d_pcm_f‹m©_t
 
f‹m©
;

1244 
i
;

1246 
i
 = 0; i < 
	`ARRAY_SIZE
(
dmix_f‹m©s
); ++i) {

1247 
f‹m©
 = 
dmix_f‹m©s
[
i
];

1248 
ªt
 = 
	`¢d_pcm_hw_∑øms_£t_f‹m©
(
•cm
, &
hw_∑øms
,

1249 
f‹m©
);

1250 i‡(
ªt
 >= 0)

1253 i‡(
ªt
 < 0 && 
dmix
->
ty≥
 !
SND_PCM_TYPE_DMIX
) {

1255 
ªt
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_f‹m©_fú°
)(
•cm
,

1256 &
hw_∑øms
, &
f‹m©
);

1258 i‡(
ªt
 < 0) {

1259 
	`SNDERR
("requested oráuto-format isÇotávailable");

1260  
ªt
;

1262 
∑øms
->
f‹m©
 = format;

1264 
ªt
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_ch™√ls_√¨
)(
•cm
, &
hw_∑øms
,

1265 (*)&
∑øms
->
ch™√ls
);

1266 i‡(
ªt
 < 0) {

1267 
	`SNDERR
("requested count of channels isÇotávailable");

1268  
ªt
;

1270 
ªt
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_øã_√¨
)(
•cm
, &
hw_∑øms
,

1271 (*)&
∑øms
->
øã
, 0);

1272 i‡(
ªt
 < 0) {

1273 
	`SNDERR
("requestedÑate isÇotávailable");

1274  
ªt
;

1277 
buf„r_is_nŸ_öôülized
 = 0;

1278 i‡(
∑øms
->
buf„r_time
 > 0) {

1279 
ªt
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_time_√¨
)(
•cm
,

1280 &
hw_∑øms
, (*)&
∑øms
->
buf„r_time
, 0);

1281 i‡(
ªt
 < 0) {

1282 
	`SNDERR
("unableÅo set bufferÅime");

1283  
ªt
;

1285 } i‡(
∑øms
->
buf„r_size
 > 0) {

1286 
ªt
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_size_√¨
)(
•cm
,

1287 &
hw_∑øms
, (
¢d_pcm_u‰ames_t
 *)&
∑øms
->
buf„r_size
);

1288 i‡(
ªt
 < 0) {

1289 
	`SNDERR
("unableÅo set buffer size");

1290  
ªt
;

1293 
buf„r_is_nŸ_öôülized
 = 1;

1296 i‡(
∑øms
->
≥riod_time
 > 0) {

1297 
ªt
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_time_√¨
)(
•cm
,

1298 &
hw_∑øms
, (*)&
∑øms
->
≥riod_time
, 0);

1299 i‡(
ªt
 < 0) {

1300 
	`SNDERR
("unableÅo setÖeriod_time");

1301  
ªt
;

1303 } i‡(
∑øms
->
≥riod_size
 > 0) {

1304 
ªt
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_size_√¨
)(
•cm
,

1305 &
hw_∑øms
, (
¢d_pcm_u‰ames_t
 *)&
∑øms
->
≥riod_size
,

1307 i‡(
ªt
 < 0) {

1308 
	`SNDERR
("unableÅo setÖeriod_size");

1309  
ªt
;

1313 i‡(
buf„r_is_nŸ_öôülized
 && 
∑øms
->
≥riods
 > 0) {

1314 
≥riods
 = 
∑øms
->periods;

1315 
ªt
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riods_√¨
)(
•cm
,

1316 &
hw_∑øms
, &
∑øms
->
≥riods
, 0);

1317 i‡(
ªt
 < 0) {

1318 
	`SNDERR
("unableÅo setÑequestedÖeriods");

1319  
ªt
;

1321 i‡(
∑øms
->
≥riods
 == 1) {

1322 
∑øms
->
≥riods
 =Öeriods;

1323 i‡(
∑øms
->
≥riod_time
 > 0) {

1324 
∑øms
->
≥riod_time
 /= 2;

1325 
__agaö
;

1326 } i‡(
∑øms
->
≥riod_size
 > 0) {

1327 
∑øms
->
≥riod_size
 /= 2;

1328 
__agaö
;

1330 
	`SNDERR
("unableÅo use stream withÖeriods == 1");

1331  
ªt
;

1335 
ªt
 = 
	`¢d_pcm_hw_∑øms
(
•cm
, &
hw_∑øms
);

1336 i‡(
ªt
 < 0) {

1337 
	`SNDERR
("unableÅo install hwÖarams");

1338  
ªt
;

1342 
dmix
->
shm±r
->
hw
.
f‹m©
 =

1343 
	`¢d_mask_vÆue
(
	`hw_∑øm_mask
(&
hw_∑øms
,

1344 
SND_PCM_HW_PARAM_FORMAT
));

1345 
dmix
->
shm±r
->
hw
.
øã
 =

1346 *
	`hw_∑øm_öãrvÆ
(&
hw_∑øms
, 
SND_PCM_HW_PARAM_RATE
);

1347 
dmix
->
shm±r
->
hw
.
buf„r_size
 =

1348 *
	`hw_∑øm_öãrvÆ
(&
hw_∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
);

1349 
dmix
->
shm±r
->
hw
.
buf„r_time
 =

1350 *
	`hw_∑øm_öãrvÆ
(&
hw_∑øms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
);

1351 
dmix
->
shm±r
->
hw
.
≥riod_size
 =

1352 *
	`hw_∑øm_öãrvÆ
(&
hw_∑øms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
);

1353 
dmix
->
shm±r
->
hw
.
≥riod_time
 =

1354 *
	`hw_∑øm_öãrvÆ
(&
hw_∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
);

1355 
dmix
->
shm±r
->
hw
.
≥riods
 =

1356 *
	`hw_∑øm_öãrvÆ
(&
hw_∑øms
, 
SND_PCM_HW_PARAM_PERIODS
);

1359 
ªt
 = 
	`¢d_pcm_sw_∑øms_cuºít
(
•cm
, &
sw_∑øms
);

1360 i‡(
ªt
 < 0) {

1361 
	`SNDERR
("unableÅo get current sw_params");

1362  
ªt
;

1365 
ªt
 = 
	`¢d_pcm_sw_∑øms_gë_bound¨y
(&
sw_∑øms
, &
bound¨y
);

1366 i‡(
ªt
 < 0) {

1367 
	`SNDERR
("unableÅo get boundary");

1368  
ªt
;

1370 
ªt
 = 
	`¢d_pcm_sw_∑øms_£t_°›_thªshﬁd
(
•cm
, &
sw_∑øms
, 
bound¨y
);

1371 i‡(
ªt
 < 0) {

1372 
	`SNDERR
("unableÅo set stopÅhreshold");

1373  
ªt
;

1380 
ªt
 = 
	`¢d_pcm_sw_∑øms_£t_t°amp_mode
(
•cm
, &
sw_∑øms
,

1381 
SND_PCM_TSTAMP_ENABLE
);

1382 i‡(
ªt
 < 0) {

1383 
	`SNDERR
("unableÅoÅstamp mode MMAP");

1384  
ªt
;

1387 i‡(
dmix
->
t°amp_ty≥
 != -1) {

1388 
ªt
 = 
	`¢d_pcm_sw_∑øms_£t_t°amp_ty≥
(
•cm
, &
sw_∑øms
,

1389 
dmix
->
t°amp_ty≥
);

1390 i‡(
ªt
 < 0) {

1391 
	`SNDERR
("unableÅo setÅstampÅype");

1392  
ªt
;

1396 i‡(
dmix
->
ty≥
 !
SND_PCM_TYPE_DMIX
 &&

1397 
dmix
->
ty≥
 !
SND_PCM_TYPE_DSHARE
)

1398 
__skù_sûícög
;

1400 
ªt
 = 
	`¢d_pcm_sw_∑øms_£t_sûí˚_thªshﬁd
(
•cm
, &
sw_∑øms
, 0);

1401 i‡(
ªt
 < 0) {

1402 
	`SNDERR
("unableÅo set silenceÅhreshold");

1403  
ªt
;

1405 
ªt
 = 
	`¢d_pcm_sw_∑øms_£t_sûí˚_size
(
•cm
, &
sw_∑øms
, 
bound¨y
);

1406 i‡(
ªt
 < 0) {

1407 
	`SNDERR
("unableÅo set silenceÅhreshold (please upgradeÅo 0.9.0rc8+ driver)");

1408  
ªt
;

1411 
__skù_sûícög
:

1413 
ªt
 = 
	`¢d_pcm_sw_∑øms
(
•cm
, &
sw_∑øms
);

1414 i‡(
ªt
 < 0) {

1415 
	`SNDERR
("unableÅo install swÖarams (please upgradeÅo 0.9.0rc8+ driver)");

1416  
ªt
;

1419 i‡(
dmix
->
ty≥
 =
SND_PCM_TYPE_DSHARE
) {

1420 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
;

1421 
d°_¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
•cm
);

1422 
	`¢d_pcm_¨ós_sûí˚
(
d°_¨ós
, 0, 
•cm
->
ch™√ls
,

1423 
•cm
->
buf„r_size
, spcm->
f‹m©
);

1426 
ªt
 = 
	`¢d_pcm_°¨t
(
•cm
);

1427 i‡(
ªt
 < 0) {

1428 
	`SNDERR
("unableÅo start PCM stream");

1429  
ªt
;

1432 i‡(
	`¢d_pcm_pﬁl_des¸ùt‹s_cou¡
(
•cm
) != 1) {

1433 
	`SNDERR
("unableÅo use hardwareÖcm with fd moreÅhan one!!!");

1434  
ªt
;

1436 
	`¢d_pcm_pﬁl_des¸ùt‹s
(
•cm
, &
fd
, 1);

1437 
dmix
->
hw_fd
 = 
fd
.fd;

1439 
	`ßve_¶ave_£âög
(
dmix
, 
•cm
);

1448 
dmix
->
¶ave_buf„r_size
 = 
•cm
->
buf„r_size
;

1449 
dmix
->
¶ave_≥riod_size
 = 
•cm
->
≥riod_size
;

1450 
dmix
->
¶ave_bound¨y
 = 
•cm
->
bound¨y
;

1452 
•cm
->
d⁄Ÿ_˛o£
 = 1;

1455 
vî
 = 0;

1456 
	`io˘l
(
•cm
->
pﬁl_fd
, 
SNDRV_PCM_IOCTL_PVERSION
, &
vî
);

1457 i‡(
vî
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 8))

1458 
dmix
->
shm±r
->
u£_£rvî
 = 1;

1462 
	}
}

1469 
	$¢d_pcm_dúe˘_öôülize_pﬁl_fd
(
¢d_pcm_dúe˘_t
 *
dmix
)

1471 
ªt
;

1472 
¢d_pcm_öfo_t
 
öfo
 = {0};

1473 
«me
[128];

1474 
ˇ±uª
 = 
dmix
->
ty≥
 =
SND_PCM_TYPE_DSNOOP
 ? 1 : 0;

1476 
dmix
->
åód
 = 1;

1477 
dmix
->
timî_√ed_pﬁl
 = 0;

1478 
dmix
->
timî_ticks
 = 1;

1479 
ªt
 = 
	`¢d_pcm_öfo
(
dmix
->
•cm
, &
öfo
);

1480 i‡(
ªt
 < 0) {

1481 
	`SNDERR
("unableÅo info for slaveÖcm");

1482  
ªt
;

1484 
	`•rötf
(
«me
, "hw:CLASS=%i,SCLASS=0,CARD=%i,DEV=%i,SUBDEV=%i",

1485 ()
SND_TIMER_CLASS_PCM
,

1486 
	`¢d_pcm_öfo_gë_ˇrd
(&
öfo
),

1487 
	`¢d_pcm_öfo_gë_devi˚
(&
öfo
),

1488 
	`¢d_pcm_öfo_gë_subdevi˚
(&
öfo
Ë* 2 + 
ˇ±uª
);

1489 
ªt
 = 
	`¢d_timî_›í
(&
dmix
->
timî
, 
«me
,

1490 
SND_TIMER_OPEN_NONBLOCK
 | 
SND_TIMER_OPEN_TREAD
);

1491 i‡(
ªt
 < 0) {

1492 
dmix
->
åód
 = 0;

1493 
ªt
 = 
	`¢d_timî_›í
(&
dmix
->
timî
, 
«me
,

1494 
SND_TIMER_OPEN_NONBLOCK
);

1495 i‡(
ªt
 < 0) {

1496 
	`SNDERR
("u«bÀÅÿ›íÅimî '%s'", 
«me
);

1497  
ªt
;

1501 i‡(
	`¢d_timî_pﬁl_des¸ùt‹s_cou¡
(
dmix
->
timî
) != 1) {

1502 
	`SNDERR
("u«bÀÅÿu£Åimî '%s' wôh m‹êth™ o√ fd!", 
«me
);

1503  
ªt
;

1505 
	`¢d_timî_pﬁl_des¸ùt‹s
(
dmix
->
timî
, &dmix->
timî_fd
, 1);

1506 
dmix
->
pﬁl_fd
 = dmix->
timî_fd
.
fd
;

1508 
dmix
->
timî_evíts
 = (1<<
SND_TIMER_EVENT_MSUSPEND
) |

1509 (1<<
SND_TIMER_EVENT_MRESUME
) |

1510 (1<<
SND_TIMER_EVENT_MSTOP
) |

1511 (1<<
SND_TIMER_EVENT_STOP
);

1517 
vî
 = 0;

1518 
	`io˘l
(
dmix
->
pﬁl_fd
, 
SNDRV_TIMER_IOCTL_PVERSION
, &
vî
);

1523 i‡(
vî
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4))

1524 
dmix
->
timî_√ed_pﬁl
 = 1;

1529 i‡(
vî
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 5)) {

1530 
dmix
->
timî_evíts
 &~((1<<
SND_TIMER_EVENT_MSUSPEND
) |

1531 (1<<
SND_TIMER_EVENT_MRESUME
));

1532 
dmix
->
timî_evíts
 |(1<<
SND_TIMER_EVENT_MPAUSE
) |

1533 (1<<
SND_TIMER_EVENT_MCONTINUE
);

1537 i‡(
vî
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 6))

1538 
dmix
->
timî_evíts
 |1<<
SND_TIMER_EVENT_START
;

1541 
	}
}

1543 
¢d_pcm_u‰ames_t
 
	$ªˇlc_bound¨y_size
(
bsize
, 
¢d_pcm_u‰ames_t
 
buf„r_size
)

1545 i‡(
bsize
 > 
LONG_MAX
) {

1546 
bsize
 = 
buf„r_size
;

1547 
bsize
 * 2 <
LONG_MAX
 - 
buf„r_size
)

1548 
bsize
 *= 2;

1550  (
¢d_pcm_u‰ames_t
)
bsize
;

1551 
	}
}

1553 
	#COPY_SLAVE
(
fõld
Ë(
•cm
->fõld = 
dmix
->
shm±r
->
s
.fõld)

	)

1556 
	$c›y_¶ave_£âög
(
¢d_pcm_dúe˘_t
 *
dmix
, 
¢d_pcm_t
 *
•cm
)

1558 
	`COPY_SLAVE
(
ac˚ss
);

1559 
	`COPY_SLAVE
(
f‹m©
);

1560 
	`COPY_SLAVE
(
subf‹m©
);

1561 
	`COPY_SLAVE
(
ch™√ls
);

1562 
	`COPY_SLAVE
(
øã
);

1563 
	`COPY_SLAVE
(
≥riod_size
);

1564 
	`COPY_SLAVE
(
≥riod_time
);

1565 
	`COPY_SLAVE
(
≥riods
);

1566 
	`COPY_SLAVE
(
t°amp_mode
);

1567 
	`COPY_SLAVE
(
t°amp_ty≥
);

1568 
	`COPY_SLAVE
(
≥riod_°ï
);

1569 
	`COPY_SLAVE
(
avaû_mö
);

1570 
	`COPY_SLAVE
(
°¨t_thªshﬁd
);

1571 
	`COPY_SLAVE
(
°›_thªshﬁd
);

1572 
	`COPY_SLAVE
(
sûí˚_thªshﬁd
);

1573 
	`COPY_SLAVE
(
sûí˚_size
);

1574 
	`COPY_SLAVE
(
bound¨y
);

1575 
	`COPY_SLAVE
(
öfo
);

1576 
	`COPY_SLAVE
(
msbôs
);

1577 
	`COPY_SLAVE
(
øã_num
);

1578 
	`COPY_SLAVE
(
øã_dí
);

1579 
	`COPY_SLAVE
(
hw_Êags
);

1580 
	`COPY_SLAVE
(
fifo_size
);

1581 
	`COPY_SLAVE
(
buf„r_size
);

1582 
	`COPY_SLAVE
(
buf„r_time
);

1583 
	`COPY_SLAVE
(
ßm∂e_bôs
);

1584 
	`COPY_SLAVE
(
‰ame_bôs
);

1586 
•cm
->
öfo
 &~
SND_PCM_INFO_PAUSE
;

1587 
•cm
->
bound¨y
 = 
	`ªˇlc_bound¨y_size
(
dmix
->
shm±r
->
s
.bound¨y, spcm->
buf„r_size
);

1588 
	}
}

1590 #unde‡
COPY_SLAVE


1596 
	$¢d_pcm_dúe˘_›í_£c⁄d¨y_˛õ¡
(
¢d_pcm_t
 **
•cmp
, 
¢d_pcm_dúe˘_t
 *
dmix
, c⁄° *
˛õ¡_«me
)

1598 
ªt
;

1599 
¢d_pcm_t
 *
•cm
;

1601 
ªt
 = 
	`¢d_pcm_hw_›í_fd
(
•cmp
, 
˛õ¡_«me
, 
dmix
->
hw_fd
, 0);

1602 i‡(
ªt
 < 0) {

1603 
	`SNDERR
("unableÅo open hardware");

1604  
ªt
;

1607 
•cm
 = *
•cmp
;

1608 
•cm
->
d⁄Ÿ_˛o£
 = 1;

1609 
•cm
->
£tup
 = 1;

1611 
	`c›y_¶ave_£âög
(
dmix
, 
•cm
);

1614 
dmix
->
¶ave_buf„r_size
 = 
•cm
->
buf„r_size
;

1615 
dmix
->
¶ave_≥riod_size
 = dmix->
shm±r
->
s
.
≥riod_size
;

1616 
dmix
->
¶ave_bound¨y
 = 
•cm
->
bound¨y
;

1617 
dmix
->
ªcovîõs
 = dmix->
shm±r
->
s
.recoveries;

1619 
ªt
 = 
	`¢d_pcm_mm≠
(
•cm
);

1620 i‡(
ªt
 < 0) {

1621 
	`SNDERR
("unableÅo mmap channels");

1622  
ªt
;

1625 
	}
}

1630 
	$¢d_pcm_dúe˘_öôülize_£c⁄d¨y_¶ave
(
¢d_pcm_dúe˘_t
 *
dmix
,

1631 
¢d_pcm_t
 *
•cm
,

1632 
¶ave_∑øms
 *
∑øms
 
ATTRIBUTE_UNUSED
)

1634 
ªt
;

1636 
•cm
->
d⁄Ÿ_˛o£
 = 1;

1637 
•cm
->
£tup
 = 1;

1639 
	`c›y_¶ave_£âög
(
dmix
, 
•cm
);

1642 
dmix
->
¶ave_buf„r_size
 = 
•cm
->
buf„r_size
;

1643 
dmix
->
¶ave_≥riod_size
 = dmix->
shm±r
->
s
.
≥riod_size
;

1644 
dmix
->
¶ave_bound¨y
 = 
•cm
->
bound¨y
;

1646 
ªt
 = 
	`¢d_pcm_mm≠
(
•cm
);

1647 i‡(
ªt
 < 0) {

1648 
	`SNDERR
("unableÅo mmap channels");

1649  
ªt
;

1652 
	}
}

1654 
	$¢d_pcm_dúe˘_£t_timî_∑øms
(
¢d_pcm_dúe˘_t
 *
dmix
)

1656 
¢d_timî_∑øms_t
 
∑øms
 = {0};

1657 
fûãr
;

1658 
ªt
;

1660 
	`¢d_timî_∑øms_£t_auto_°¨t
(&
∑øms
, 1);

1661 i‡(
dmix
->
ty≥
 !
SND_PCM_TYPE_DSNOOP
)

1662 
	`¢d_timî_∑øms_£t_óæy_evít
(&
∑øms
, 1);

1663 
	`¢d_timî_∑øms_£t_ticks
(&
∑øms
, 
dmix
->
timî_ticks
);

1664 i‡(
dmix
->
åód
) {

1665 
fûãr
 = (1<<
SND_TIMER_EVENT_TICK
) |

1666 
dmix
->
timî_evíts
;

1667 
	`INTERNAL
(
¢d_timî_∑øms_£t_fûãr
)(&
∑øms
, 
fûãr
);

1669 
ªt
 = 
	`¢d_timî_∑øms
(
dmix
->
timî
, &
∑øms
);

1670 i‡(
ªt
 < 0) {

1671 
	`SNDERR
("unableÅo setÅimerÖarameters");

1672  
ªt
;

1675 
	}
}

1680 
	$¢d_pcm_dúe˘_check_öãæóve
(
¢d_pcm_dúe˘_t
 *
dmix
, 
¢d_pcm_t
 *
pcm
)

1682 
chn
, 
ch™√ls
;

1683 
bôs
;

1684 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
;

1685 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
;

1687 
bôs
 = 
	`¢d_pcm_f‹m©_physiˇl_width
(
pcm
->
f‹m©
);

1688 i‡((
bôs
 % 8) != 0)

1689 
__noöãæóved
;

1690 
ch™√ls
 = 
dmix
->channels;

1691 i‡(
ch™√ls
 !
dmix
->
•cm
->channels)

1692 
__noöãæóved
;

1693 
d°_¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
dmix
->
•cm
);

1694 
§c_¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

1695 
chn
 = 1; ch¿< 
ch™√ls
; chn++) {

1696 i‡(
d°_¨ós
[
chn
-1].
addr
 != dst_areas[chn].addr)

1697 
__noöãæóved
;

1698 i‡(
§c_¨ós
[
chn
-1].
addr
 != src_areas[chn].addr)

1699 
__noöãæóved
;

1701 
chn
 = 0; ch¿< 
ch™√ls
; chn++) {

1702 i‡(
dmix
->
bödögs
 && dmix->bödögs[
chn
] != chn)

1703 
__noöãæóved
;

1704 i‡(
d°_¨ós
[
chn
].
fú°
 !ch¿* 
bôs
 ||

1705 
d°_¨ós
[
chn
].
°ï
 !
ch™√ls
 * 
bôs
)

1706 
__noöãæóved
;

1707 i‡(
§c_¨ós
[
chn
].
fú°
 !ch¿* 
bôs
 ||

1708 
§c_¨ós
[
chn
].
°ï
 !
ch™√ls
 * 
bôs
)

1709 
__noöãæóved
;

1711  
dmix
->
öãæóved
 = 1;

1712 
__noöãæóved
:

1713  
dmix
->
öãæóved
 = 0;

1714 
	}
}

1721 
	$¢d_pcm_dúe˘_∑r£_bödögs
(
¢d_pcm_dúe˘_t
 *
dmix
,

1722 
¶ave_∑øms
 *
∑øms
,

1723 
¢d_c⁄fig_t
 *
cfg
)

1725 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1726 
chn
, 
chn1
, 
cou¡
 = 0;

1727 *
bödögs
;

1728 
îr
;

1730 
dmix
->
ch™√ls
 = 
UINT_MAX
;

1731 i‡(
cfg
 =
NULL
)

1733 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1734 
	`SNDERR
("invalidÅype for bindings");

1735  -
EINVAL
;

1737 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1738 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1739 c⁄° *
id
;

1740 
cch™√l
;

1741 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1743 
îr
 = 
	`ß„_°πﬁ
(
id
, &
cch™√l
);

1744 i‡(
îr
 < 0 || 
cch™√l
 < 0) {

1745 
	`SNDERR
("övÆid clõ¡ ch™√»ö bödög: %s", 
id
);

1746  -
EINVAL
;

1748 i‡(()
cch™√l
 >
cou¡
)

1749 
cou¡
 = 
cch™√l
 + 1;

1751 i‡(
cou¡
 == 0)

1753 i‡(
cou¡
 > 1024) {

1754 
	`SNDERR
("client channel out ofÑange");

1755  -
EINVAL
;

1757 
bödögs
 = 
	`mÆloc
(
cou¡
 * ());

1758 i‡(
bödögs
 =
NULL
)

1759  -
ENOMEM
;

1760 
chn
 = 0; ch¿< 
cou¡
; chn++)

1761 
bödögs
[
chn
] = 
UINT_MAX
;

1762 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1763 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1764 c⁄° *
id
;

1765 
cch™√l
, 
sch™√l
;

1766 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1768 
	`ß„_°πﬁ
(
id
, &
cch™√l
);

1769 i‡(
	`¢d_c⁄fig_gë_öãgî
(
n
, &
sch™√l
) < 0) {

1770 
	`SNDERR
("u«bÀÅÿgë sœvêch™√»(should bêöãgîÅy≥Ëö bödög: %s", 
id
);

1771 
	`‰ì
(
bödögs
);

1772  -
EINVAL
;

1774 i‡(
sch™√l
 < 0 || sch™√»>
∑øms
->
ch™√ls
) {

1775 
	`SNDERR
("invalid slave channelÇumber %ld in bindingÅo %ld",

1776 
sch™√l
, 
cch™√l
);

1777 
	`‰ì
(
bödögs
);

1778  -
EINVAL
;

1780 
bödögs
[
cch™√l
] = 
sch™√l
;

1782 i‡(
dmix
->
ty≥
 =
SND_PCM_TYPE_DSNOOP
 ||

1783 ! 
dmix
->
bödögs
)

1784 
__skù_ßme_d°
;

1785 
chn
 = 0; ch¿< 
cou¡
; chn++) {

1786 
chn1
 = 0; chn1 < 
cou¡
; chn1++) {

1787 i‡(
chn
 =
chn1
)

1789 i‡(
bödögs
[
chn
] =
dmix
->bödögs[
chn1
]) {

1790 
	`SNDERR
("u«bÀÅÿrouã ch™√l†%d,%dÅÿßmêde°ö©i⁄ %d", 
chn
, 
chn1
, 
bödögs
[chn]);

1791 
	`‰ì
(
bödögs
);

1792  -
EINVAL
;

1796 
__skù_ßme_d°
:

1797 
dmix
->
bödögs
 = bindings;

1798 
dmix
->
ch™√ls
 = 
cou¡
;

1800 
	}
}

1806 
	$_¢d_pcm_dúe˘_gë_¶ave_ùc_off£t
(
¢d_c⁄fig_t
 *
roŸ
,

1807 
¢d_c⁄fig_t
 *
sc⁄f
,

1808 
dúe˘i⁄
,

1809 
h›
)

1811 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1812 
¢d_c⁄fig_t
 *
pcm_c⁄f
, *
pcm_c⁄f2
;

1813 
îr
;

1814 
ˇrd
 = 0, 
devi˚
 = 0, 
subdevi˚
 = 0;

1815 c⁄° *
°r
;

1817 i‡(
	`¢d_c⁄fig_gë_°rög
(
sc⁄f
, &
°r
) >= 0) {

1818 i‡(
h›
 > 
SND_CONF_MAX_HOPS
) {

1819 
	`SNDERR
("Too many definitionÜevels (looped?)");

1820  -
EINVAL
;

1822 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "pcm", 
°r
, &
pcm_c⁄f
);

1823 i‡(
îr
 < 0) {

1824 
	`SNDERR
("Unknow¿¶avêPCM %s", 
°r
);

1825  
îr
;

1827 
îr
 = 
	`_¢d_pcm_dúe˘_gë_¶ave_ùc_off£t
(
roŸ
, 
pcm_c⁄f
,

1828 
dúe˘i⁄
,

1829 
h›
 + 1);

1830 
	`¢d_c⁄fig_dñëe
(
pcm_c⁄f
);

1831  
îr
;

1836 
¢d_ouçut_t
 *
out
;

1837 
	`¢d_ouçut_°dio_©èch
(&
out
, 
°dîr
, 0);

1838 
	`¢d_c⁄fig_ßve
(
sc⁄f
, 
out
);

1839 
	`¢d_ouçut_˛o£
(
out
);

1843 i‡(
	`¢d_c⁄fig_£¨ch
(
sc⁄f
, "¶ave", &
pcm_c⁄f
) >= 0) {

1844 i‡(
	`¢d_c⁄fig_£¨ch
(
pcm_c⁄f
, "pcm", &pcm_conf) >= 0) {

1845  
	`_¢d_pcm_dúe˘_gë_¶ave_ùc_off£t
(
roŸ
,

1846 
pcm_c⁄f
,

1847 
dúe˘i⁄
,

1848 
h›
 + 1);

1850 i‡(
	`¢d_c⁄fig_gë_°rög
(
pcm_c⁄f
, &
°r
) >= 0 &&

1851 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "pcm_slave",

1852 
°r
, &
pcm_c⁄f
) >= 0) {

1853 i‡(
	`¢d_c⁄fig_£¨ch
(
pcm_c⁄f
, "pcm",

1854 &
pcm_c⁄f2
) >= 0) {

1855 
îr
 =

1856 
	`_¢d_pcm_dúe˘_gë_¶ave_ùc_off£t
(

1857 
roŸ
, 
pcm_c⁄f2
, 
dúe˘i⁄
, 
h›
 + 1);

1858 
	`¢d_c⁄fig_dñëe
(
pcm_c⁄f
);

1859  
îr
;

1861 
	`¢d_c⁄fig_dñëe
(
pcm_c⁄f
);

1866 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
sc⁄f
) {

1867 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1868 c⁄° *
id
, *
°r
;

1869 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1871 i‡(
	`°rcmp
(
id
, "type") == 0) {

1872 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
);

1873 i‡(
îr
 < 0) {

1874 
	`SNDERR
("Invalid value for PCMÅype definition");

1875  -
EINVAL
;

1877 i‡(
	`°rcmp
(
°r
, "hw")) {

1878 
	`SNDERR
("InvÆidÅy≥ '%s' f‹ sœvêPCM", 
°r
);

1879  -
EINVAL
;

1883 i‡(
	`°rcmp
(
id
, "card") == 0) {

1884 
îr
 = 
	`¢d_c⁄fig_gë_ˇrd
(
n
);

1885 i‡(
îr
 < 0)

1886  
îr
;

1887 
ˇrd
 = 
îr
;

1890 i‡(
	`°rcmp
(
id
, "device") == 0) {

1891 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
devi˚
);

1892 i‡(
îr
 < 0) {

1893 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1894  
îr
;

1898 i‡(
	`°rcmp
(
id
, "subdevice") == 0) {

1899 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
subdevi˚
);

1900 i‡(
îr
 < 0) {

1901 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1902  
îr
;

1907 i‡(
devi˚
 < 0)

1908 
devi˚
 = 0;

1909 i‡(
subdevi˚
 < 0)

1910 
subdevi˚
 = 0;

1911  (
dúe˘i⁄
 << 1Ë+ (
devi˚
 << 2Ë+ (
subdevi˚
 << 8Ë+ (
ˇrd
 << 12);

1912 
	}
}

1914 
	$¢d_pcm_dúe˘_gë_¶ave_ùc_off£t
(
¢d_c⁄fig_t
 *
roŸ
,

1915 
¢d_c⁄fig_t
 *
sc⁄f
,

1916 
dúe˘i⁄
)

1918  
	`_¢d_pcm_dúe˘_gë_¶ave_ùc_off£t
(
roŸ
, 
sc⁄f
, 
dúe˘i⁄
, 0);

1919 
	}
}

1921 
	$¢d_pcm_dúe˘_∑r£_›í_c⁄f
(
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

1922 
°ªam
, 
¢d_pcm_dúe˘_›í_c⁄f
 *
ªc
)

1924 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1925 
ùc_key_add_uid
 = 0;

1926 
¢d_c⁄fig_t
 *
n
;

1927 
îr
;

1929 
ªc
->
¶ave
 = 
NULL
;

1930 
ªc
->
bödögs
 = 
NULL
;

1931 
ªc
->
ùc_key
 = 0;

1932 
ªc
->
ùc_≥rm
 = 0600;

1933 
ªc
->
ùc_gid
 = -1;

1934 
ªc
->
¶ow±r
 = 1;

1935 
ªc
->
max_≥riods
 = 0;

1936 
ªc
->
v¨_≥riodsize
 = 0;

1937 #ifde‡
LOCKLESS_DMIX_DEFAULT


1938 
ªc
->
dúe˘_mem‹y_ac˚ss
 = 1;

1940 
ªc
->
dúe˘_mem‹y_ac˚ss
 = 0;

1942 
ªc
->
hw_±r_Æignmít
 = 
SND_PCM_HW_PTR_ALIGNMENT_AUTO
;

1943 
ªc
->
t°amp_ty≥
 = -1;

1946 i‡(
	`¢d_c⁄fig_£¨ch
(
roŸ
, "deÁu…s.pcm.dmix_max_≥riods", &
n
) >= 0) {

1947 
vÆ
;

1948 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
vÆ
);

1949 i‡(
îr
 >= 0)

1950 
ªc
->
max_≥riods
 = 
vÆ
;

1953 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1954 c⁄° *
id
;

1955 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1956 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1958 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

1960 i‡(
	`°rcmp
(
id
, "ipc_key") == 0) {

1961 
key
;

1962 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
key
);

1963 i‡(
îr
 < 0) {

1964 
	`SNDERR
("The field ipc_key must beán integerÅype");

1966  
îr
;

1968 
ªc
->
ùc_key
 = 
key
;

1971 i‡(
	`°rcmp
(
id
, "ipc_perm") == 0) {

1972 
≥rm
;

1973 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
≥rm
);

1974 i‡(
îr
 < 0) {

1975 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1976  
îr
;

1978 i‡((
≥rm
 & ~0777) != 0) {

1979 
	`SNDERR
("The field ipc_perm must beá valid fileÖermission");

1980  -
EINVAL
;

1982 
ªc
->
ùc_≥rm
 = 
≥rm
;

1985 i‡(
	`°rcmp
(
id
, "hw_ptr_alignment") == 0) {

1986 c⁄° *
°r
;

1987 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
);

1988 i‡(
îr
 < 0) {

1989 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1990  -
EINVAL
;

1992 i‡(
	`°rcmp
(
°r
, "no") == 0 || strcmp(str, "off") == 0)

1993 
ªc
->
hw_±r_Æignmít
 = 
SND_PCM_HW_PTR_ALIGNMENT_NO
;

1994 i‡(
	`°rcmp
(
°r
, "roundup") == 0)

1995 
ªc
->
hw_±r_Æignmít
 = 
SND_PCM_HW_PTR_ALIGNMENT_ROUNDUP
;

1996 i‡(
	`°rcmp
(
°r
, "rounddown") == 0)

1997 
ªc
->
hw_±r_Æignmít
 = 
SND_PCM_HW_PTR_ALIGNMENT_ROUNDDOWN
;

1998 i‡(
	`°rcmp
(
°r
, "auto") == 0)

1999 
ªc
->
hw_±r_Æignmít
 = 
SND_PCM_HW_PTR_ALIGNMENT_AUTO
;

2001 
	`SNDERR
("Thêfõld hw_±r_Æignmíài†övÆid : %s", 
°r
);

2002  -
EINVAL
;

2007 i‡(
	`°rcmp
(
id
, "tstamp_type") == 0) {

2008 c⁄° *
°r
;

2009 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
);

2010 i‡(
îr
 < 0) {

2011 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

2012  -
EINVAL
;

2014 i‡(
	`°rcmp
(
°r
, "default") == 0)

2015 
ªc
->
t°amp_ty≥
 = -1;

2016 i‡(
	`°rcmp
(
°r
, "gettimeofday") == 0)

2017 
ªc
->
t°amp_ty≥
 = 
SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY
;

2018 i‡(
	`°rcmp
(
°r
, "monotonic") == 0)

2019 
ªc
->
t°amp_ty≥
 = 
SND_PCM_TSTAMP_TYPE_MONOTONIC
;

2020 i‡(
	`°rcmp
(
°r
, "monotonic_raw") == 0)

2021 
ªc
->
t°amp_ty≥
 = 
SND_PCM_TSTAMP_TYPE_MONOTONIC_RAW
;

2023 
	`SNDERR
("ThêfõldÅ°amp_ty≥ i†övÆid : %s", 
°r
);

2024  -
EINVAL
;

2028 i‡(
	`°rcmp
(
id
, "ipc_gid") == 0) {

2029 *
group
;

2030 *
ídp
;

2031 
îr
 = 
	`¢d_c⁄fig_gë_ascii
(
n
, &
group
);

2032 i‡(
îr
 < 0) {

2033 
	`SNDERR
("The field ipc_gid must beá valid group");

2034  
îr
;

2036 i‡(! *
group
) {

2037 
ªc
->
ùc_gid
 = -1;

2038 
	`‰ì
(
group
);

2041 i‡(
	`isdigô
(*
group
) == 0) {

2042 
˛í
 = 
	`sysc⁄f
(
_SC_GETGR_R_SIZE_MAX
);

2043 
size_t
 
Àn
 = (
˛í
 == -1) ? 1024 : (size_t)clen;

2044 
group
 
gΩ
, *
pgΩ
;

2045 *
buf„r
 = (*)
	`mÆloc
(
Àn
);

2046 i‡(
buf„r
 =
NULL
)

2047  -
ENOMEM
;

2048 
°
 = 
	`gëg∫am_r
(
group
, &
gΩ
, 
buf„r
, 
Àn
, &
pgΩ
);

2049 i‡(
°
 !0 || !
pgΩ
) {

2050 
	`SNDERR
("Thêfõld ipc_gid mu° bê®vÆid grou∞(¸óã grou∞%s)", 
group
);

2051 
	`‰ì
(
buf„r
);

2052  -
EINVAL
;

2054 
ªc
->
ùc_gid
 = 
pgΩ
->
gr_gid
;

2055 
	`‰ì
(
buf„r
);

2057 
ªc
->
ùc_gid
 = 
	`°πﬁ
(
group
, &
ídp
, 10);

2059 
	`‰ì
(
group
);

2062 i‡(
	`°rcmp
(
id
, "ipc_key_add_uid") == 0) {

2063 i‡((
îr
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
)) < 0) {

2064 
	`SNDERR
("The field ipc_key_add_uid must beá booleanÅype");

2065  
îr
;

2067 
ùc_key_add_uid
 = 
îr
;

2070 i‡(
	`°rcmp
(
id
, "slave") == 0) {

2071 
ªc
->
¶ave
 = 
n
;

2074 i‡(
	`°rcmp
(
id
, "bindings") == 0) {

2075 
ªc
->
bödögs
 = 
n
;

2078 i‡(
	`°rcmp
(
id
, "slowptr") == 0) {

2079 
îr
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

2080 i‡(
îr
 < 0)

2081  
îr
;

2082 
ªc
->
¶ow±r
 = 
îr
;

2085 i‡(
	`°rcmp
(
id
, "max_periods") == 0) {

2086 
vÆ
;

2087 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
vÆ
);

2088 i‡(
îr
 < 0)

2089  
îr
;

2090 
ªc
->
max_≥riods
 = 
vÆ
;

2093 i‡(
	`°rcmp
(
id
, "var_periodsize") == 0) {

2094 
îr
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

2095 i‡(
îr
 < 0)

2096  
îr
;

2097 
ªc
->
v¨_≥riodsize
 = 
îr
;

2100 i‡(
	`°rcmp
(
id
, "direct_memory_access") == 0) {

2101 
îr
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

2102 i‡(
îr
 < 0)

2103  
îr
;

2104 
ªc
->
dúe˘_mem‹y_ac˚ss
 = 
îr
;

2107 
	`SNDERR
("Unknow¿fõld %s", 
id
);

2108  -
EINVAL
;

2110 i‡(!
ªc
->
¶ave
) {

2111 
	`SNDERR
("slave isÇot defined");

2112  -
EINVAL
;

2114 i‡(!
ªc
->
ùc_key
) {

2115 
	`SNDERR
("Unique IPC key isÇot defined");

2116  -
EINVAL
;

2118 i‡(
ùc_key_add_uid
)

2119 
ªc
->
ùc_key
 +
	`gëuid
();

2120 
îr
 = 
	`¢d_pcm_dúe˘_gë_¶ave_ùc_off£t
(
roŸ
, 
c⁄f
, 
°ªam
);

2121 i‡(
îr
 < 0)

2122  
îr
;

2123 
ªc
->
ùc_key
 +
îr
;

2126 
	}
}

2128 
	$¢d_pcm_dúe˘_ª£t_¶ave_±r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_dúe˘_t
 *
dmix
,

2129 
¢d_pcm_u‰ames_t
 
hw_±r
)

2131 
dmix
->
¶ave_≠∂_±r
 = dmix->
¶ave_hw_±r
 = 
hw_±r
;

2132 i‡(
dmix
->
hw_±r_Æignmít
 =
SND_PCM_HW_PTR_ALIGNMENT_ROUNDUP
 ||

2133 (
dmix
->
hw_±r_Æignmít
 =
SND_PCM_HW_PTR_ALIGNMENT_AUTO
 &&

2134 
pcm
->
buf„r_size
 <pcm->
≥riod_size
 * 2))

2135 
dmix
->
¶ave_≠∂_±r
 =

2136 ((
dmix
->
¶ave_≠∂_±r
 + dmix->
¶ave_≥riod_size
 - 1) /

2137 
dmix
->
¶ave_≥riod_size
) * dmix->slave_period_size;

2138 i‡(
dmix
->
hw_±r_Æignmít
 =
SND_PCM_HW_PTR_ALIGNMENT_ROUNDDOWN
 ||

2139 (
dmix
->
hw_±r_Æignmít
 =
SND_PCM_HW_PTR_ALIGNMENT_AUTO
 &&

2140 ((
dmix
->
¶ave_≥riod_size
 * 
SEC_TO_MS
Ë/ 
pcm
->
øã
Ë< 
LOW_LATENCY_PERIOD_TIME
))

2141 
dmix
->
¶ave_≠∂_±r
 = dmix->
¶ave_hw_±r
 =

2142 ((
dmix
->
¶ave_hw_±r
 / dmix->
¶ave_≥riod_size
) *

2143 
dmix
->
¶ave_≥riod_size
);

2144 
	}
}

2146 
	$_¢d_pcm_dúe˘_√w
(
¢d_pcm_t
 **
pcmp
, 
¢d_pcm_dúe˘_t
 **
_dmix
, 
ty≥
,

2147 c⁄° *
«me
, 
¢d_pcm_dúe˘_›í_c⁄f
 *
›ts
,

2148 
¶ave_∑øms
 *
∑øms
, 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

2150 
¢d_pcm_dúe˘_t
 *
dmix
;

2151 
Áû_£m_lo›
 = 10;

2152 
ªt
;

2154 
dmix
 = 
	`ˇŒoc
(1, (
¢d_pcm_dúe˘_t
));

2155 i‡(!
dmix
)

2156  -
ENOMEM
;

2158 
ªt
 = 
	`¢d_pcm_dúe˘_∑r£_bödögs
(
dmix
, 
∑øms
, 
›ts
->
bödögs
);

2159 i‡(
ªt
 < 0) {

2160 
	`‰ì
(
dmix
);

2161  
ªt
;

2164 
dmix
->
ùc_key
 = 
›ts
->ipc_key;

2165 
dmix
->
ùc_≥rm
 = 
›ts
->ipc_perm;

2166 
dmix
->
ùc_gid
 = 
›ts
->ipc_gid;

2167 
dmix
->
t°amp_ty≥
 = 
›ts
->tstamp_type;

2168 
dmix
->
£mid
 = -1;

2169 
dmix
->
shmid
 = -1;

2170 
dmix
->
shm±r
 = (*) -1;

2171 
dmix
->
ty≥
 =Åype;

2173 
ªt
 = 
	`¢d_pcm_√w
(
pcmp
, 
ty≥
, 
«me
, 
°ªam
, 
mode
);

2174 i‡(
ªt
 < 0)

2175 
_îr_no£m
;

2178 
ªt
 = 
	`¢d_pcm_dúe˘_£m≠h‹e_¸óã_‹_c⁄√˘
(
dmix
);

2179 i‡(
ªt
 < 0) {

2180 
	`SNDERR
("unableÅo create IPC semaphore");

2181 
_îr_no£m_‰ì
;

2183 
ªt
 = 
	`¢d_pcm_dúe˘_£m≠h‹e_down
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

2184 i‡(
ªt
 < 0) {

2185 
	`¢d_pcm_dúe˘_£m≠h‹e_disˇrd
(
dmix
);

2186 i‡(--
Áû_£m_lo›
 <= 0)

2187 
_îr_no£m_‰ì
;

2193 
ªt
 = 
	`¢d_pcm_dúe˘_shm_¸óã_‹_c⁄√˘
(
dmix
);

2194 i‡(
ªt
 < 0) {

2195 
	`SNDERR
("unableÅo create IPC shm instance");

2196 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

2197 
_îr_no£m_‰ì
;

2199 *
_dmix
 = 
dmix
;

2202  
ªt
;

2203 
_îr_no£m_‰ì
:

2204 
	`¢d_pcm_‰ì
(*
pcmp
);

2205 *
pcmp
 = 
NULL
;

2206 
_îr_no£m
:

2207 
	`‰ì
(
dmix
->
bödögs
);

2208 
	`‰ì
(
dmix
);

2209  
ªt
;

2210 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_direct.h

22 
	~"pcm_loˇl.h
"

23 
	~"../timî/timî_loˇl.h
"

25 
	#DIRECT_IPC_SEMS
 1

	)

26 
	#DIRECT_IPC_SEM_CLIENT
 0

	)

28 
	#SEC_TO_MS
 1000

	)

30 
	#LOW_LATENCY_PERIOD_TIME
 10

	)

33 (
	tmix_¨ós_t
)(
	tsize
,

34 vﬁ©ûê*
	td°
, *
	t§c
,

35 vﬁ©ûêsig√d *
	tsum
, 
	tsize_t
 
	td°_°ï
,

36 
	tsize_t
 
	t§c_°ï
, size_à
	tsum_°ï
);

38 (
	tmix_¨ós_16_t
)(
	tsize
,

39 vﬁ©ûêsig√d *
	td°
, sig√d *
	t§c
,

40 vﬁ©ûêsig√d *
	tsum
, 
	tsize_t
 
	td°_°ï
,

41 
	tsize_t
 
	t§c_°ï
, size_à
	tsum_°ï
);

43 (
	tmix_¨ós_32_t
)(
	tsize
,

44 vﬁ©ûêsig√d *
	td°
, sig√d *
	t§c
,

45 vﬁ©ûêsig√d *
	tsum
, 
	tsize_t
 
	td°_°ï
,

46 
	tsize_t
 
	t§c_°ï
, size_à
	tsum_°ï
);

48 (
	tmix_¨ós_24_t
)(
	tsize
,

49 vﬁ©ûê*
	td°
, *
	t§c
,

50 vﬁ©ûêsig√d *
	tsum
, 
	tsize_t
 
	td°_°ï
,

51 
	tsize_t
 
	t§c_°ï
, size_à
	tsum_°ï
);

53 (
	tmix_¨ós_u8_t
)(
	tsize
,

54 vﬁ©ûê*
	td°
, *
	t§c
,

55 vﬁ©ûêsig√d *
	tsum
, 
	tsize_t
 
	td°_°ï
,

56 
	tsize_t
 
	t§c_°ï
, size_à
	tsum_°ï
);

58 
	e¢d_pcm_dúe˘_hw_±r_Æignmít
 {

59 
SND_PCM_HW_PTR_ALIGNMENT_NO
 = 0,

60 
SND_PCM_HW_PTR_ALIGNMENT_ROUNDUP
 = 1,

61 
SND_PCM_HW_PTR_ALIGNMENT_ROUNDDOWN
 = 2,

62 
SND_PCM_HW_PTR_ALIGNMENT_AUTO
 = 3

63 } 
	t¢d_pcm_dúe˘_hw_±r_Æignmít_t
;

65 
	s¶ave_∑øms
 {

66 
¢d_pcm_f‹m©_t
 
f‹m©
;

67 
øã
;

68 
ch™√ls
;

69 
≥riod_time
;

70 
buf„r_time
;

71 
¢d_pcm_s‰ames_t
 
≥riod_size
;

72 
¢d_pcm_s‰ames_t
 
buf„r_size
;

73 
≥riods
;

78 
magic
;

79 
sockë_«me
[256];

80 
¢d_pcm_ty≥_t
 
ty≥
;

81 
u£_£rvî
;

83 
f‹m©
;

84 
¢d_öãrvÆ_t
 
øã
;

85 
¢d_öãrvÆ_t
 
buf„r_size
;

86 
¢d_öãrvÆ_t
 
buf„r_time
;

87 
¢d_öãrvÆ_t
 
≥riod_size
;

88 
¢d_öãrvÆ_t
 
≥riod_time
;

89 
¢d_öãrvÆ_t
 
≥riods
;

90 } 
hw
;

93 
¢d_pcm_ac˚ss_t
 
ac˚ss
;

94 
¢d_pcm_f‹m©_t
 
f‹m©
;

95 
¢d_pcm_subf‹m©_t
 
subf‹m©
;

96 
ch™√ls
;

97 
øã
;

98 
≥riod_size
;

99 
≥riod_time
;

100 
¢d_öãrvÆ_t
 
≥riods
;

101 
¢d_pcm_t°amp_t
 
t°amp_mode
;

102 
¢d_pcm_t°amp_ty≥_t
 
t°amp_ty≥
;

103 
≥riod_°ï
;

104 
¶ìp_mö
;

105 
avaû_mö
;

106 
°¨t_thªshﬁd
;

107 
°›_thªshﬁd
;

108 
sûí˚_thªshﬁd
;

109 
sûí˚_size
;

110 
ªcovîõs
;

111 
bound¨y
;

112 
öfo
;

113 
msbôs
;

114 
øã_num
;

115 
øã_dí
;

116 
hw_Êags
;

117 
fifo_size
;

118 
buf„r_size
;

119 
¢d_öãrvÆ_t
 
buf„r_time
;

120 
ßm∂e_bôs
;

121 
‰ame_bôs
;

122 } 
s
;

125 
chn_mask
;

126 } 
dsh¨e
;

127 } 
u
;

128 } 
	t¢d_pcm_dúe˘_sh¨e_t
;

130 
¢d_pcm_dúe˘
 
	t¢d_pcm_dúe˘_t
;

132 
	s¢d_pcm_dúe˘
 {

133 
¢d_pcm_ty≥_t
 
ty≥
;

134 
key_t
 
ùc_key
;

135 
mode_t
 
ùc_≥rm
;

136 
ùc_gid
;

137 
£mid
;

138 
locked
[
DIRECT_IPC_SEMS
];

139 
shmid
;

140 
¢d_pcm_dúe˘_sh¨e_t
 *
shm±r
;

141 
¢d_pcm_t
 *
•cm
;

142 
¢d_pcm_u‰ames_t
 
≠∂_±r
;

143 
¢d_pcm_u‰ames_t
 
œ°_≠∂_±r
;

144 
¢d_pcm_u‰ames_t
 
hw_±r
;

145 
¢d_pcm_u‰ames_t
 
avaû_max
;

146 
¢d_pcm_u‰ames_t
 
¶ave_≠∂_±r
;

147 
¢d_pcm_u‰ames_t
 
¶ave_hw_±r
;

148 
¢d_pcm_u‰ames_t
 
¶ave_≥riod_size
;

149 
¢d_pcm_u‰ames_t
 
¶ave_buf„r_size
;

150 
¢d_pcm_u‰ames_t
 
¶ave_bound¨y
;

151 (*
sync_±r
)(
¢d_pcm_t
 *
pcm
);

152 
¢d_pcm_°©e_t
 
°©e
;

153 
¢d_htime°amp_t
 
åiggî_t°amp
;

154 
¢d_htime°amp_t
 
upd©e_t°amp
;

155 
£rvî
, 
˛õ¡
;

156 
comm_fd
;

157 
hw_fd
;

158 
pﬁlfd
 
timî_fd
;

159 
pﬁl_fd
;

160 
åód
: 1;

161 
timî_√ed_pﬁl
: 1;

162 
timî_evíts
;

163 
timî_ticks
;

164 
£rvî_fd
;

165 
pid_t
 
£rvî_pid
;

166 
¢d_timî_t
 *
timî
;

167 
öãæóved
;

168 
¶ow±r
;

169 
max_≥riods
;

170 
v¨_≥riodsize
;

171 
ch™√ls
;

172 *
bödögs
;

173 
ªcovîõs
;

174 
dúe˘_mem‹y_ac˚ss
;

175 
¢d_pcm_dúe˘_hw_±r_Æignmít_t
 
hw_±r_Æignmít
;

176 
t°amp_ty≥
;

179 
shmid_sum
;

180 sig√d *
sum_buf„r
;

181 
mix_¨ós_16_t
 *
mix_¨ós_16
;

182 
mix_¨ós_32_t
 *
mix_¨ós_32
;

183 
mix_¨ós_24_t
 *
mix_¨ós_24
;

184 
mix_¨ós_u8_t
 *
mix_¨ós_u8
;

185 
mix_¨ós_16_t
 *
ªmix_¨ós_16
;

186 
mix_¨ós_32_t
 *
ªmix_¨ós_32
;

187 
mix_¨ós_24_t
 *
ªmix_¨ós_24
;

188 
mix_¨ós_u8_t
 *
ªmix_¨ós_u8
;

189 
u£_£m
;

190 } 
dmix
;

192 
chn_mask
;

193 } 
dsh¨e
;

194 } 
u
;

195 (*
£rvî_‰ì
)(
¢d_pcm_dúe˘_t
 *
dúe˘
);

199 
	#¢d_pcm_dúe˘_£m≠h‹e_¸óã_‹_c⁄√˘
 \

200 
¢d1_pcm_dúe˘_£m≠h‹e_¸óã_‹_c⁄√˘


	)

201 
	#¢d_pcm_dúe˘_shm_¸óã_‹_c⁄√˘
 \

202 
¢d1_pcm_dúe˘_shm_¸óã_‹_c⁄√˘


	)

203 
	#¢d_pcm_dúe˘_shm_disˇrd
 \

204 
¢d1_pcm_dúe˘_shm_disˇrd


	)

205 
	#¢d_pcm_dúe˘_£rvî_¸óã
 \

206 
¢d1_pcm_dúe˘_£rvî_¸óã


	)

207 
	#¢d_pcm_dúe˘_£rvî_disˇrd
 \

208 
¢d1_pcm_dúe˘_£rvî_disˇrd


	)

209 
	#¢d_pcm_dúe˘_˛õ¡_c⁄√˘
 \

210 
¢d1_pcm_dúe˘_˛õ¡_c⁄√˘


	)

211 
	#¢d_pcm_dúe˘_˛õ¡_disˇrd
 \

212 
¢d1_pcm_dúe˘_˛õ¡_disˇrd


	)

213 
	#¢d_pcm_dúe˘_öôülize_¶ave
 \

214 
¢d1_pcm_dúe˘_öôülize_¶ave


	)

215 
	#¢d_pcm_dúe˘_öôülize_£c⁄d¨y_¶ave
 \

216 
¢d1_pcm_dúe˘_öôülize_£c⁄d¨y_¶ave


	)

217 
	#¢d_pcm_dúe˘_öôülize_pﬁl_fd
 \

218 
¢d1_pcm_dúe˘_öôülize_pﬁl_fd


	)

219 
	#¢d_pcm_dúe˘_check_öãæóve
 \

220 
¢d1_pcm_dúe˘_check_öãæóve


	)

221 
	#¢d_pcm_dúe˘_∑r£_bödögs
 \

222 
¢d1_pcm_dúe˘_∑r£_bödögs


	)

223 
	#¢d_pcm_dúe˘_n⁄block
 \

224 
¢d1_pcm_dúe˘_n⁄block


	)

225 
	#¢d_pcm_dúe˘_async
 \

226 
¢d1_pcm_dúe˘_async


	)

227 
	#¢d_pcm_dúe˘_pﬁl_des¸ùt‹s
 \

228 
¢d1_pcm_dúe˘_pﬁl_des¸ùt‹s


	)

229 
	#¢d_pcm_dúe˘_pﬁl_ªvíts
 \

230 
¢d1_pcm_dúe˘_pﬁl_ªvíts


	)

231 
	#¢d_pcm_dúe˘_öfo
 \

232 
¢d1_pcm_dúe˘_öfo


	)

233 
	#¢d_pcm_dúe˘_hw_ªföe
 \

234 
¢d1_pcm_dúe˘_hw_ªföe


	)

235 
	#¢d_pcm_dúe˘_hw_∑øms
 \

236 
¢d1_pcm_dúe˘_hw_∑øms


	)

237 
	#¢d_pcm_dúe˘_hw_‰ì
 \

238 
¢d1_pcm_dúe˘_hw_‰ì


	)

239 
	#¢d_pcm_dúe˘_sw_∑øms
 \

240 
¢d1_pcm_dúe˘_sw_∑øms


	)

241 
	#¢d_pcm_dúe˘_ch™√l_öfo
 \

242 
¢d1_pcm_dúe˘_ch™√l_öfo


	)

243 
	#¢d_pcm_dúe˘_mm≠
 \

244 
¢d1_pcm_dúe˘_mm≠


	)

245 
	#¢d_pcm_dúe˘_munm≠
 \

246 
¢d1_pcm_dúe˘_munm≠


	)

247 
	#¢d_pcm_dúe˘_¥ï¨e
 \

248 
¢d1_pcm_dúe˘_¥ï¨e


	)

249 
	#¢d_pcm_dúe˘_ªsume
 \

250 
¢d1_pcm_dúe˘_ªsume


	)

251 
	#¢d_pcm_dúe˘_timî_°›
 \

252 
¢d1_pcm_dúe˘_timî_°›


	)

253 
	#¢d_pcm_dúe˘_˛ór_timî_queue
 \

254 
¢d1_pcm_dúe˘_˛ór_timî_queue


	)

255 
	#¢d_pcm_dúe˘_£t_timî_∑øms
 \

256 
¢d1_pcm_dúe˘_£t_timî_∑øms


	)

257 
	#¢d_pcm_dúe˘_›í_£c⁄d¨y_˛õ¡
 \

258 
¢d1_pcm_dúe˘_›í_£c⁄d¨y_˛õ¡


	)

259 
	#¢d_pcm_dúe˘_∑r£_›í_c⁄f
 \

260 
¢d1_pcm_dúe˘_∑r£_›í_c⁄f


	)

261 
	#¢d_pcm_dúe˘_quîy_chm≠s
 \

262 
¢d1_pcm_dúe˘_quîy_chm≠s


	)

263 
	#¢d_pcm_dúe˘_gë_chm≠
 \

264 
¢d1_pcm_dúe˘_gë_chm≠


	)

265 
	#¢d_pcm_dúe˘_£t_chm≠
 \

266 
¢d1_pcm_dúe˘_£t_chm≠


	)

267 
	#¢d_pcm_dúe˘_ª£t_¶ave_±r
 \

268 
¢d1_pcm_dúe˘_ª£t_¶ave_±r


	)

269 
	#¢d_pcm_dúe˘_check_xrun
 \

270 
¢d1_pcm_dúe˘_check_xrun


	)

271 
	#¢d_pcm_dúe˘_¶ave_ªcovî
 \

272 
¢d1_pcm_dúe˘_¶ave_ªcovî


	)

274 
	`¢d_pcm_dúe˘_£m≠h‹e_¸óã_‹_c⁄√˘
(
¢d_pcm_dúe˘_t
 *
dmix
);

276 
ölöe
 
	$¢d_pcm_dúe˘_£m≠h‹e_disˇrd
(
¢d_pcm_dúe˘_t
 *
dmix
)

278 i‡(
dmix
->
£mid
 >= 0) {

279 i‡(
	`£m˘l
(
dmix
->
£mid
, 0, 
IPC_RMID
, 
NULL
) < 0)

280  -
î∫o
;

281 
dmix
->
£mid
 = -1;

284 
	}
}

286 
ölöe
 
	$¢d_pcm_dúe˘_£m≠h‹e_down
(
¢d_pcm_dúe˘_t
 *
dmix
, 
£m_num
)

288 
£mbuf
 
›
[2] = { { 
£m_num
, 0, 0 }, { sem_num, 1, 
SEM_UNDO
 } };

289 
îr
 = 
	`£m›
(
dmix
->
£mid
, 
›
, 2);

290 i‡(
îr
 == 0)

291 
dmix
->
locked
[
£m_num
]++;

292 i‡(
îr
 == -1)

293 
îr
 = -
î∫o
;

294  
îr
;

295 
	}
}

297 
ölöe
 
	$¢d_pcm_dúe˘_£m≠h‹e_up
(
¢d_pcm_dúe˘_t
 *
dmix
, 
£m_num
)

299 
£mbuf
 
›
 = { 
£m_num
, -1, 
SEM_UNDO
 | 
IPC_NOWAIT
 };

300 
îr
 = 
	`£m›
(
dmix
->
£mid
, &
›
, 1);

301 i‡(
îr
 == 0)

302 
dmix
->
locked
[
£m_num
]--;

303 i‡(
îr
 == -1)

304 
îr
 = -
î∫o
;

305  
îr
;

306 
	}
}

308 
ölöe
 
	$¢d_pcm_dúe˘_£m≠h‹e_föÆ
(
¢d_pcm_dúe˘_t
 *
dmix
, 
£m_num
)

310 i‡(
dmix
->
locked
[
£m_num
] != 1) {

311 
	`SNDMSG
("övÆid sem≠h‹êcou¡ÅÿföÆizê%d: %d", 
£m_num
, 
dmix
->
locked
[sem_num]);

312  -
EBUSY
;

314  
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
dmix
, 
£m_num
);

315 
	}
}

317 
¢d_pcm_dúe˘_shm_¸óã_‹_c⁄√˘
(
¢d_pcm_dúe˘_t
 *
dmix
);

318 
¢d_pcm_dúe˘_shm_disˇrd
(
¢d_pcm_dúe˘_t
 *
dmix
);

319 
¢d_pcm_dúe˘_£rvî_¸óã
(
¢d_pcm_dúe˘_t
 *
dmix
);

320 
¢d_pcm_dúe˘_£rvî_disˇrd
(
¢d_pcm_dúe˘_t
 *
dmix
);

321 
¢d_pcm_dúe˘_˛õ¡_c⁄√˘
(
¢d_pcm_dúe˘_t
 *
dmix
);

322 
¢d_pcm_dúe˘_˛õ¡_disˇrd
(
¢d_pcm_dúe˘_t
 *
dmix
);

323 
¢d_pcm_dúe˘_öôülize_¶ave
(
¢d_pcm_dúe˘_t
 *
dmix
, 
¢d_pcm_t
 *
•cm
, 
¶ave_∑øms
 *
∑øms
);

324 
¢d_pcm_dúe˘_öôülize_£c⁄d¨y_¶ave
(
¢d_pcm_dúe˘_t
 *
dmix
, 
¢d_pcm_t
 *
•cm
, 
¶ave_∑øms
 *
∑øms
);

325 
¢d_pcm_dúe˘_öôülize_pﬁl_fd
(
¢d_pcm_dúe˘_t
 *
dmix
);

326 
¢d_pcm_dúe˘_check_öãæóve
(
¢d_pcm_dúe˘_t
 *
dmix
, 
¢d_pcm_t
 *
pcm
);

327 
¢d_pcm_dúe˘_∑r£_bödögs
(
¢d_pcm_dúe˘_t
 *
dmix
,

328 
¶ave_∑øms
 *
∑øms
,

329 
¢d_c⁄fig_t
 *
cfg
);

330 
¢d_pcm_dúe˘_n⁄block
(
¢d_pcm_t
 *
pcm
, 
n⁄block
);

331 
¢d_pcm_dúe˘_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
);

332 
¢d_pcm_dúe˘_pﬁl_des¸ùt‹s
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
,

333 
•a˚
);

334 
¢d_pcm_dúe˘_pﬁl_ªvíts
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
);

335 
¢d_pcm_dúe˘_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_öfo_t
 * 
öfo
);

336 
¢d_pcm_dúe˘_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

337 
¢d_pcm_dúe˘_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 * 
∑øms
);

338 
¢d_pcm_dúe˘_hw_‰ì
(
¢d_pcm_t
 *
pcm
);

339 
¢d_pcm_dúe˘_sw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 * 
∑øms
);

340 
¢d_pcm_dúe˘_ch™√l_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_öfo_t
 * 
öfo
);

341 
¢d_pcm_dúe˘_mm≠
(
¢d_pcm_t
 *
pcm
);

342 
¢d_pcm_dúe˘_munm≠
(
¢d_pcm_t
 *
pcm
);

343 
¢d_pcm_dúe˘_¥ï¨e
(
¢d_pcm_t
 *
pcm
);

344 
¢d_pcm_dúe˘_ªsume
(
¢d_pcm_t
 *
pcm
);

345 
¢d_pcm_dúe˘_timî_°›
(
¢d_pcm_dúe˘_t
 *
dmix
);

346 
¢d_pcm_dúe˘_˛ór_timî_queue
(
¢d_pcm_dúe˘_t
 *
dmix
);

347 
¢d_pcm_dúe˘_£t_timî_∑øms
(
¢d_pcm_dúe˘_t
 *
dmix
);

348 
¢d_pcm_dúe˘_›í_£c⁄d¨y_˛õ¡
(
¢d_pcm_t
 **
•cmp
, 
¢d_pcm_dúe˘_t
 *
dmix
, c⁄° *
˛õ¡_«me
);

350 
¢d_pcm_chm≠_quîy_t
 **
¢d_pcm_dúe˘_quîy_chm≠s
(
¢d_pcm_t
 *
pcm
);

351 
¢d_pcm_chm≠_t
 *
¢d_pcm_dúe˘_gë_chm≠
(
¢d_pcm_t
 *
pcm
);

352 
¢d_pcm_dúe˘_£t_chm≠
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_chm≠_t
 *
m≠
);

353 
¢d_pcm_dúe˘_¶ave_ªcovî
(
¢d_pcm_dúe˘_t
 *
dúe˘
);

354 
¢d_pcm_dúe˘_check_xrun
(
¢d_pcm_dúe˘_t
 *
dúe˘
, 
¢d_pcm_t
 *
pcm
);

355 
¢d_timî_async
(
¢d_timî_t
 *
timî
, 
sig
, 
pid_t
 
pid
);

356 
time•ec
 
¢d_pcm_hw_Á°_t°amp
(
¢d_pcm_t
 *
pcm
);

357 
¢d_pcm_dúe˘_ª£t_¶ave_±r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_dúe˘_t
 *
dmix
, 
¢d_pcm_u‰ames_t
 
hw_±r
);

359 
	s¢d_pcm_dúe˘_›í_c⁄f
 {

360 
key_t
 
	mùc_key
;

361 
mode_t
 
	mùc_≥rm
;

362 
	mùc_gid
;

363 
	m¶ow±r
;

364 
	mmax_≥riods
;

365 
	mv¨_≥riodsize
;

366 
	mdúe˘_mem‹y_ac˚ss
;

367 
¢d_pcm_dúe˘_hw_±r_Æignmít_t
 
	mhw_±r_Æignmít
;

368 
	mt°amp_ty≥
;

369 
¢d_c⁄fig_t
 *
	m¶ave
;

370 
¢d_c⁄fig_t
 *
	mbödögs
;

373 
¢d_pcm_dúe˘_∑r£_›í_c⁄f
(
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
, 
°ªam
, 
¢d_pcm_dúe˘_›í_c⁄f
 *
ªc
);

375 
_¢d_pcm_dúe˘_√w
(
¢d_pcm_t
 **
pcmp
, 
¢d_pcm_dúe˘_t
 **
_dmix
, 
ty≥
,

376 c⁄° *
«me
, 
¢d_pcm_dúe˘_›í_c⁄f
 *
›ts
,

377 
¶ave_∑øms
 *
∑øms
, 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix.c

29 
	~"pcm_loˇl.h
"

30 
	~<°dio.h
>

31 
	~<°dlib.h
>

32 
	~<°ddef.h
>

33 
	~<uni°d.h
>

34 
	~<sig«l.h
>

35 
	~<°rög.h
>

36 
	~<f˙é.h
>

37 
	~<˘y≥.h
>

38 
	~<gΩ.h
>

39 
	~<sys/io˘l.h
>

40 
	~<sys/mm™.h
>

41 
	~<sys/shm.h
>

42 
	~<sys/£m.h
>

43 
	~<sys/waô.h
>

44 
	~<sys/sockë.h
>

45 
	~<sys/un.h
>

46 
	~<sys/mm™.h
>

47 
	~"pcm_dúe˘.h
"

49 #i‚de‡
PIC


51 c⁄° *
	g_¢d_moduÀ_pcm_dmix
 = "";

54 #i‚de‡
DOC_HIDDEN


56 
	#STATE_RUN_PENDING
 1024

	)

63 
shm_sum_disˇrd
(
¢d_pcm_dúe˘_t
 *
dmix
);

68 
	$shm_sum_¸óã_‹_c⁄√˘
(
¢d_pcm_dúe˘_t
 *
dmix
)

70 
shmid_ds
 
buf
;

71 
tmpid
, 
îr
;

72 
size_t
 
size
;

74 
size
 = 
dmix
->
shm±r
->
s
.
ch™√ls
 *

75 
dmix
->
shm±r
->
s
.
buf„r_size
 *

77 
ªåyshm
:

78 
dmix
->
u
.dmix.
shmid_sum
 = 
	`shmgë
(dmix->
ùc_key
 + 1, 
size
,

79 
IPC_CREAT
 | 
dmix
->
ùc_≥rm
);

80 
îr
 = -
î∫o
;

81 i‡(
dmix
->
u
.dmix.
shmid_sum
 < 0) {

82 i‡(
î∫o
 =
EINVAL
)

83 i‡((
tmpid
 = 
	`shmgë
(
dmix
->
ùc_key
 + 1, 0, dmix->
ùc_≥rm
)) != -1)

84 i‡(!
	`shm˘l
(
tmpid
, 
IPC_STAT
, &
buf
))

85 i‡(!
buf
.
shm_«âch
)

87 i‡(!
	`shm˘l
(
tmpid
, 
IPC_RMID
, 
NULL
))

88 
ªåyshm
;

89  
îr
;

91 i‡(
	`shm˘l
(
dmix
->
u
.dmix.
shmid_sum
, 
IPC_STAT
, &
buf
) < 0) {

92 
îr
 = -
î∫o
;

93 
	`shm_sum_disˇrd
(
dmix
);

94  
îr
;

96 i‡(
dmix
->
ùc_gid
 >= 0) {

97 
buf
.
shm_≥rm
.
gid
 = 
dmix
->
ùc_gid
;

98 
	`shm˘l
(
dmix
->
u
.dmix.
shmid_sum
, 
IPC_SET
, &
buf
);

100 
dmix
->
u
.dmix.
sum_buf„r
 = 
	`shm©
(dmix->u.dmix.
shmid_sum
, 0, 0);

101 i‡(
dmix
->
u
.dmix.
sum_buf„r
 == (*) -1) {

102 
îr
 = -
î∫o
;

103 
	`shm_sum_disˇrd
(
dmix
);

104  
îr
;

106 
	`mlock
(
dmix
->
u
.dmix.
sum_buf„r
, 
size
);

108 
	}
}

110 
	$shm_sum_disˇrd
(
¢d_pcm_dúe˘_t
 *
dmix
)

112 
shmid_ds
 
buf
;

113 
ªt
 = 0;

115 i‡(
dmix
->
u
.dmix.
shmid_sum
 < 0)

116  -
EINVAL
;

117 i‡(
dmix
->
u
.dmix.
sum_buf„r
 !(*Ë-1 && 
	`shmdt
(dmix->u.dmix.sum_buffer) < 0)

118  -
î∫o
;

119 
dmix
->
u
.dmix.
sum_buf„r
 = (*) -1;

120 i‡(
	`shm˘l
(
dmix
->
u
.dmix.
shmid_sum
, 
IPC_STAT
, &
buf
) < 0)

121  -
î∫o
;

122 i‡(
buf
.
shm_«âch
 == 0) {

123 i‡(
	`shm˘l
(
dmix
->
u
.dmix.
shmid_sum
, 
IPC_RMID
, 
NULL
) < 0)

124  -
î∫o
;

125 
ªt
 = 1;

127 
dmix
->
u
.dmix.
shmid_sum
 = -1;

128  
ªt
;

129 
	}
}

131 
	$dmix_£rvî_‰ì
(
¢d_pcm_dúe˘_t
 *
dmix
)

134 
	`shm_sum_¸óã_‹_c⁄√˘
(
dmix
);

135 
	`shm_sum_disˇrd
(
dmix
);

136 
	}
}

143 
	~"pcm_dmix_gíîic.c
"

144 #i‡
deföed
(
__i386__
)

145 
	~"pcm_dmix_i386.c
"

146 #ñi‡
deföed
(
__x86_64__
)

147 
	~"pcm_dmix_x86_64.c
"

149 #i‚de‡
DOC_HIDDEN


150 
	#mix_£À˘_ˇŒbacks
(
x
Ë
	`gíîic_mix_£À˘_ˇŒbacks
(x)

	)

151 
	#dmix_suµ‹ãd_f‹m©
 
gíîic_dmix_suµ‹ãd_f‹m©


	)

155 
	$mix_¨ós
(
¢d_pcm_dúe˘_t
 *
dmix
,

156 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

157 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

158 
¢d_pcm_u‰ames_t
 
§c_ofs
,

159 
¢d_pcm_u‰ames_t
 
d°_ofs
,

160 
¢d_pcm_u‰ames_t
 
size
)

162 
§c_°ï
, 
d°_°ï
;

163 
chn
, 
dchn
, 
ch™√ls
, 
ßm∂e_size
;

164 
mix_¨ós_t
 *
do_mix_¨ós
;

166 
ch™√ls
 = 
dmix
->channels;

167 
dmix
->
shm±r
->
s
.
f‹m©
) {

168 
SND_PCM_FORMAT_S16_LE
:

169 
SND_PCM_FORMAT_S16_BE
:

170 
ßm∂e_size
 = 2;

171 
do_mix_¨ós
 = (
mix_¨ós_t
 *)
dmix
->
u
.dmix.
mix_¨ós_16
;

173 
SND_PCM_FORMAT_S32_LE
:

174 
SND_PCM_FORMAT_S32_BE
:

175 
ßm∂e_size
 = 4;

176 
do_mix_¨ós
 = (
mix_¨ós_t
 *)
dmix
->
u
.dmix.
mix_¨ós_32
;

178 
SND_PCM_FORMAT_S24_LE
:

179 
ßm∂e_size
 = 4;

180 
do_mix_¨ós
 = (
mix_¨ós_t
 *)
dmix
->
u
.dmix.
mix_¨ós_24
;

182 
SND_PCM_FORMAT_S24_3LE
:

183 
ßm∂e_size
 = 3;

184 
do_mix_¨ós
 = (
mix_¨ós_t
 *)
dmix
->
u
.dmix.
mix_¨ós_24
;

186 
SND_PCM_FORMAT_U8
:

187 
ßm∂e_size
 = 1;

188 
do_mix_¨ós
 = (
mix_¨ós_t
 *)
dmix
->
u
.dmix.
mix_¨ós_u8
;

193 i‡(
dmix
->
öãæóved
) {

198 
	`do_mix_¨ós
(
size
 * 
ch™√ls
,

199 (*)
d°_¨ós
[0].
addr
 + 
ßm∂e_size
 * 
d°_ofs
 * 
ch™√ls
,

200 (*)
§c_¨ós
[0].
addr
 + 
ßm∂e_size
 * 
§c_ofs
 * 
ch™√ls
,

201 
dmix
->
u
.dmix.
sum_buf„r
 + 
d°_ofs
 * 
ch™√ls
,

202 
ßm∂e_size
,

203 
ßm∂e_size
,

207 
chn
 = 0; ch¿< 
ch™√ls
; chn++) {

208 
dchn
 = 
dmix
->
bödögs
 ? dmix->bödögs[
chn
] : chn;

209 i‡(
dchn
 >
dmix
->
shm±r
->
s
.
ch™√ls
)

211 
§c_°ï
 = 
§c_¨ós
[
chn
].
°ï
 / 8;

212 
d°_°ï
 = 
d°_¨ós
[
dchn
].
°ï
 / 8;

213 
	`do_mix_¨ós
(
size
,

214 ((*)
d°_¨ós
[
dchn
].
addr
 + d°_¨ós[dchn].
fú°
 / 8Ë+ 
d°_ofs
 * 
d°_°ï
,

215 ((*)
§c_¨ós
[
chn
].
addr
 + src_¨ós[chn].
fú°
 / 8Ë+ 
§c_ofs
 * 
§c_°ï
,

216 
dmix
->
u
.dmix.
sum_buf„r
 + dmix->
shm±r
->
s
.
ch™√ls
 * 
d°_ofs
 + 
dchn
,

217 
d°_°ï
,

218 
§c_°ï
,

219 
dmix
->
shm±r
->
s
.
ch™√ls
 * (signed ));

221 
	}
}

223 
	$ªmix_¨ós
(
¢d_pcm_dúe˘_t
 *
dmix
,

224 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

225 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

226 
¢d_pcm_u‰ames_t
 
§c_ofs
,

227 
¢d_pcm_u‰ames_t
 
d°_ofs
,

228 
¢d_pcm_u‰ames_t
 
size
)

230 
§c_°ï
, 
d°_°ï
;

231 
chn
, 
dchn
, 
ch™√ls
, 
ßm∂e_size
;

232 
mix_¨ós_t
 *
do_ªmix_¨ós
;

234 
ch™√ls
 = 
dmix
->channels;

235 
dmix
->
shm±r
->
s
.
f‹m©
) {

236 
SND_PCM_FORMAT_S16_LE
:

237 
SND_PCM_FORMAT_S16_BE
:

238 
ßm∂e_size
 = 2;

239 
do_ªmix_¨ós
 = (
mix_¨ós_t
 *)
dmix
->
u
.dmix.
ªmix_¨ós_16
;

241 
SND_PCM_FORMAT_S32_LE
:

242 
SND_PCM_FORMAT_S32_BE
:

243 
ßm∂e_size
 = 4;

244 
do_ªmix_¨ós
 = (
mix_¨ós_t
 *)
dmix
->
u
.dmix.
ªmix_¨ós_32
;

246 
SND_PCM_FORMAT_S24_LE
:

247 
ßm∂e_size
 = 4;

248 
do_ªmix_¨ós
 = (
mix_¨ós_t
 *)
dmix
->
u
.dmix.
ªmix_¨ós_24
;

250 
SND_PCM_FORMAT_S24_3LE
:

251 
ßm∂e_size
 = 3;

252 
do_ªmix_¨ós
 = (
mix_¨ós_t
 *)
dmix
->
u
.dmix.
ªmix_¨ós_24
;

254 
SND_PCM_FORMAT_U8
:

255 
ßm∂e_size
 = 1;

256 
do_ªmix_¨ós
 = (
mix_¨ós_t
 *)
dmix
->
u
.dmix.
ªmix_¨ós_u8
;

261 i‡(
dmix
->
öãæóved
) {

266 
	`do_ªmix_¨ós
(
size
 * 
ch™√ls
,

267 (*)
d°_¨ós
[0].
addr
 + 
ßm∂e_size
 * 
d°_ofs
 * 
ch™√ls
,

268 (*)
§c_¨ós
[0].
addr
 + 
ßm∂e_size
 * 
§c_ofs
 * 
ch™√ls
,

269 
dmix
->
u
.dmix.
sum_buf„r
 + 
d°_ofs
 * 
ch™√ls
,

270 
ßm∂e_size
,

271 
ßm∂e_size
,

275 
chn
 = 0; ch¿< 
ch™√ls
; chn++) {

276 
dchn
 = 
dmix
->
bödögs
 ? dmix->bödögs[
chn
] : chn;

277 i‡(
dchn
 >
dmix
->
shm±r
->
s
.
ch™√ls
)

279 
§c_°ï
 = 
§c_¨ós
[
chn
].
°ï
 / 8;

280 
d°_°ï
 = 
d°_¨ós
[
dchn
].
°ï
 / 8;

281 
	`do_ªmix_¨ós
(
size
,

282 ((*)
d°_¨ós
[
dchn
].
addr
 + d°_¨ós[dchn].
fú°
 / 8Ë+ 
d°_ofs
 * 
d°_°ï
,

283 ((*)
§c_¨ós
[
chn
].
addr
 + src_¨ós[chn].
fú°
 / 8Ë+ 
§c_ofs
 * 
§c_°ï
,

284 
dmix
->
u
.dmix.
sum_buf„r
 + dmix->
shm±r
->
s
.
ch™√ls
 * 
d°_ofs
 + 
dchn
,

285 
d°_°ï
,

286 
§c_°ï
,

287 
dmix
->
shm±r
->
s
.
ch™√ls
 * (signed ));

289 
	}
}

295 #i‚de‡
DOC_HIDDEN


296 
	$dmix_down_£m
(
¢d_pcm_dúe˘_t
 *
dmix
)

298 i‡(
dmix
->
u
.dmix.
u£_£m
)

299 
	`¢d_pcm_dúe˘_£m≠h‹e_down
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

300 
	}
}

302 
	$dmix_up_£m
(
¢d_pcm_dúe˘_t
 *
dmix
)

304 i‡(
dmix
->
u
.dmix.
u£_£m
)

305 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

306 
	}
}

312 
	$¢d_pcm_dmix_sync_¨ó
(
¢d_pcm_t
 *
pcm
)

314 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

315 
¢d_pcm_u‰ames_t
 
¶ave_hw_±r
, 
¶ave_≠∂_±r
, 
¶ave_size
;

316 
¢d_pcm_u‰ames_t
 
≠∂_±r
, 
size
, 
å™s„r
;

317 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
, *
d°_¨ós
;

323 
size
 = 
	`pcm_‰ame_diff2
(
dmix
->
≠∂_±r
, dmix->
œ°_≠∂_±r
, 
pcm
->
bound¨y
);

324 i‡(! 
size
)

329 
¶ave_size
 = 
	`pcm_‰ame_diff
(
dmix
->
¶ave_≠∂_±r
, dmix->
¶ave_hw_±r
, dmix->
¶ave_bound¨y
);

330 i‡(
¶ave_size
 > 
dmix
->
¶ave_buf„r_size
) {

331 
å™s„r
 = 
dmix
->
¶ave_buf„r_size
 - 
¶ave_size
;

332 i‡(
å™s„r
 > 
size
)

333 
å™s„r
 = 
size
;

334 
dmix
->
œ°_≠∂_±r
 +
å™s„r
;

335 
dmix
->
œ°_≠∂_±r
 %
pcm
->
bound¨y
;

336 
dmix
->
¶ave_≠∂_±r
 +
å™s„r
;

337 
dmix
->
¶ave_≠∂_±r
 %dmix->
¶ave_bound¨y
;

338 
size
 = 
	`pcm_‰ame_diff2
(
dmix
->
≠∂_±r
, dmix->
œ°_≠∂_±r
, 
pcm
->
bound¨y
);

339 i‡(! 
size
)

344 
¶ave_hw_±r
 = 
dmix
->slave_hw_ptr;

348 
¶ave_hw_±r
 -¶ave_hw_±∏% 
dmix
->
¶ave_≥riod_size
;

349 
¶ave_hw_±r
 +
dmix
->
¶ave_buf„r_size
;

350 i‡(
¶ave_hw_±r
 >
dmix
->
¶ave_bound¨y
)

351 
¶ave_hw_±r
 -
dmix
->
¶ave_bound¨y
;

352 
¶ave_size
 = 
	`pcm_‰ame_diff
(
¶ave_hw_±r
, 
dmix
->
¶ave_≠∂_±r
, dmix->
¶ave_bound¨y
);

353 i‡(
¶ave_size
 < 
size
)

354 
size
 = 
¶ave_size
;

355 i‡(! 
size
)

359 
§c_¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

360 
d°_¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
dmix
->
•cm
);

361 
≠∂_±r
 = 
dmix
->
œ°_≠∂_±r
 % 
pcm
->
buf„r_size
;

362 
dmix
->
œ°_≠∂_±r
 +
size
;

363 
dmix
->
œ°_≠∂_±r
 %
pcm
->
bound¨y
;

364 
¶ave_≠∂_±r
 = 
dmix
->¶ave_≠∂_±∏% dmix->
¶ave_buf„r_size
;

365 
dmix
->
¶ave_≠∂_±r
 +
size
;

366 
dmix
->
¶ave_≠∂_±r
 %dmix->
¶ave_bound¨y
;

367 
	`dmix_down_£m
(
dmix
);

369 
å™s„r
 = 
size
;

370 i‡(
≠∂_±r
 + 
å™s„r
 > 
pcm
->
buf„r_size
)

371 
å™s„r
 = 
pcm
->
buf„r_size
 - 
≠∂_±r
;

372 i‡(
¶ave_≠∂_±r
 + 
å™s„r
 > 
dmix
->
¶ave_buf„r_size
)

373 
å™s„r
 = 
dmix
->
¶ave_buf„r_size
 - 
¶ave_≠∂_±r
;

374 
	`mix_¨ós
(
dmix
, 
§c_¨ós
, 
d°_¨ós
, 
≠∂_±r
, 
¶ave_≠∂_±r
, 
å™s„r
);

375 
size
 -
å™s„r
;

376 i‡(! 
size
)

378 
¶ave_≠∂_±r
 +
å™s„r
;

379 
¶ave_≠∂_±r
 %
dmix
->
¶ave_buf„r_size
;

380 
≠∂_±r
 +
å™s„r
;

381 
≠∂_±r
 %
pcm
->
buf„r_size
;

383 
	`dmix_up_£m
(
dmix
);

384 
	}
}

389 
	$¢d_pcm_dmix_sync_±r0
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
¶ave_hw_±r
)

391 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

392 
¢d_pcm_u‰ames_t
 
ﬁd_¶ave_hw_±r
, 
avaû
;

393 
¢d_pcm_s‰ames_t
 
diff
;

395 
ﬁd_¶ave_hw_±r
 = 
dmix
->
¶ave_hw_±r
;

396 
dmix
->
¶ave_hw_±r
 = slave_hw_ptr;

397 
diff
 = 
	`pcm_‰ame_diff
(
¶ave_hw_±r
, 
ﬁd_¶ave_hw_±r
, 
dmix
->
¶ave_bound¨y
);

398 i‡(
diff
 == 0)

400 i‡(
dmix
->
°©e
 !
SND_PCM_STATE_RUNNING
 &&

401 
dmix
->
°©e
 !
SND_PCM_STATE_DRAINING
)

404 
dmix
->
hw_±r
 +
diff
;

405 
dmix
->
hw_±r
 %
pcm
->
bound¨y
;

406 i‡(
pcm
->
°›_thªshﬁd
 >pcm->
bound¨y
)

408 
avaû
 = 
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
);

409 i‡(
avaû
 > 
dmix
->
avaû_max
)

410 
dmix
->
avaû_max
 = 
avaû
;

411 i‡(
avaû
 >
pcm
->
°›_thªshﬁd
) {

412 
	`¢d_timî_°›
(
dmix
->
timî
);

413 
	`gëtime°amp
(&
dmix
->
åiggî_t°amp
, 
pcm
->
t°amp_ty≥
);

414 i‡(
dmix
->
°©e
 =
SND_PCM_STATE_RUNNING
) {

415 
dmix
->
°©e
 = 
SND_PCM_STATE_XRUN
;

416  -
EPIPE
;

418 
dmix
->
°©e
 = 
SND_PCM_STATE_SETUP
;

420 
	`¢d_pcm_dúe˘_˛ór_timî_queue
(
dmix
);

423 
	}
}

425 
	$¢d_pcm_dmix_sync_±r
(
¢d_pcm_t
 *
pcm
)

427 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

428 
¢d_pcm_u‰ames_t
 
¶ave_hw_±r
;

429 
îr
;

431 i‡(
dmix
->
¶ow±r
)

432 
	`¢d_pcm_hwsync
(
dmix
->
•cm
);

433 
¶ave_hw_±r
 = *
dmix
->
•cm
->
hw
.
±r
;

434 
îr
 = 
	`¢d_pcm_dúe˘_check_xrun
(
dmix
, 
pcm
);

435 i‡(
îr
 < 0)

436  
îr
;

438  
	`¢d_pcm_dmix_sync_±r0
(
pcm
, 
¶ave_hw_±r
);

439 
	}
}

445 
¢d_pcm_°©e_t
 
	$¢d_pcm_dmix_°©e
(
¢d_pcm_t
 *
pcm
)

447 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

449 
	`¢d_pcm_dúe˘_check_xrun
(
dmix
, 
pcm
);

450 i‡(
dmix
->
°©e
 =
STATE_RUN_PENDING
)

451  
SNDRV_PCM_STATE_RUNNING
;

452  
dmix
->
°©e
;

453 
	}
}

455 
	$¢d_pcm_dmix_°©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©us_t
 * 
°©us
)

457 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

459 
	`mem£t
(
°©us
, 0, (*status));

460 
	`¢d_pcm_°©us
(
dmix
->
•cm
, 
°©us
);

462 
dmix
->
°©e
) {

463 
SNDRV_PCM_STATE_DRAINING
:

464 
SNDRV_PCM_STATE_RUNNING
:

465 
	`¢d_pcm_dmix_sync_±r0
(
pcm
, 
°©us
->
hw_±r
);

466 
°©us
->
dñay
 = 
	`¢d_pcm_mm≠_∂ayback_dñay
(
pcm
);

472 
°©us
->
°©e
 = 
	`¢d_pcm_dmix_°©e
(
pcm
);

473 
°©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

474 
°©us
->
≠∂_±r
 = *
pcm
->
≠∂
.
±r
;

475 
°©us
->
åiggî_t°amp
 = 
dmix
->trigger_tstamp;

476 
°©us
->
avaû
 = 
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
);

477 
°©us
->
avaû_max
 = sètus->
avaû
 > 
dmix
->avail_max ? status->avail : dmix->avail_max;

478 
dmix
->
avaû_max
 = 0;

480 
	}
}

482 
	$¢d_pcm_dmix_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
)

484 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

485 
îr
;

487 
dmix
->
°©e
) {

488 
SNDRV_PCM_STATE_DRAINING
:

489 
SNDRV_PCM_STATE_RUNNING
:

490 
îr
 = 
	`¢d_pcm_dmix_sync_±r
(
pcm
);

491 i‡(
îr
 < 0)

492  
îr
;

494 
SNDRV_PCM_STATE_PREPARED
:

495 
SNDRV_PCM_STATE_SUSPENDED
:

496 
STATE_RUN_PENDING
:

497 *
dñayp
 = 
	`¢d_pcm_mm≠_∂ayback_dñay
(
pcm
);

499 
SNDRV_PCM_STATE_XRUN
:

500  -
EPIPE
;

501 
SNDRV_PCM_STATE_DISCONNECTED
:

502  -
ENODEV
;

504  -
EBADFD
;

506 
	}
}

508 
	$¢d_pcm_dmix_hwsync
(
¢d_pcm_t
 *
pcm
)

510 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

512 
dmix
->
°©e
) {

513 
SNDRV_PCM_STATE_DRAINING
:

514 
SNDRV_PCM_STATE_RUNNING
:

516  
	`¢d_pcm_dmix_sync_±r
(
pcm
);

517 
SNDRV_PCM_STATE_PREPARED
:

518 
SNDRV_PCM_STATE_SUSPENDED
:

519 
STATE_RUN_PENDING
:

521 
SNDRV_PCM_STATE_XRUN
:

522  -
EPIPE
;

523 
SNDRV_PCM_STATE_DISCONNECTED
:

524  -
ENODEV
;

526  -
EBADFD
;

528 
	}
}

530 
	$¢d_pcm_dmix_ª£t
(
¢d_pcm_t
 *
pcm
)

532 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

533 
dmix
->
hw_±r
 %
pcm
->
≥riod_size
;

534 
dmix
->
≠∂_±r
 = dmix->
œ°_≠∂_±r
 = dmix->
hw_±r
;

535 
	`¢d_pcm_dúe˘_ª£t_¶ave_±r
(
pcm
, 
dmix
, *dmix->
•cm
->
hw
.
±r
);

537 
	}
}

539 
	$¢d_pcm_dmix_°¨t_timî
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_dúe˘_t
 *
dmix
)

541 
îr
;

543 
	`¢d_pcm_hwsync
(
dmix
->
•cm
);

544 
	`¢d_pcm_dúe˘_ª£t_¶ave_±r
(
pcm
, 
dmix
, *dmix->
•cm
->
hw
.
±r
);

545 
îr
 = 
	`¢d_timî_°¨t
(
dmix
->
timî
);

546 i‡(
îr
 < 0)

547  
îr
;

548 
dmix
->
°©e
 = 
SND_PCM_STATE_RUNNING
;

550 
	}
}

552 
	$¢d_pcm_dmix_°¨t
(
¢d_pcm_t
 *
pcm
)

554 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

555 
¢d_pcm_s‰ames_t
 
avaû
;

556 
îr
;

558 i‡(
dmix
->
°©e
 !
SND_PCM_STATE_PREPARED
)

559  -
EBADFD
;

560 
avaû
 = 
	`¢d_pcm_mm≠_∂ayback_hw_avaû
(
pcm
);

561 i‡(
avaû
 == 0)

562 
dmix
->
°©e
 = 
STATE_RUN_PENDING
;

563 i‡(
avaû
 < 0)

566 i‡((
îr
 = 
	`¢d_pcm_dmix_°¨t_timî
(
pcm
, 
dmix
)) < 0)

567  
îr
;

568 
	`¢d_pcm_dmix_sync_¨ó
(
pcm
);

570 
	`gëtime°amp
(&
dmix
->
åiggî_t°amp
, 
pcm
->
t°amp_ty≥
);

572 
	}
}

574 
	$¢d_pcm_dmix_dr›
(
¢d_pcm_t
 *
pcm
)

576 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

577 i‡(
dmix
->
°©e
 =
SND_PCM_STATE_OPEN
)

578  -
EBADFD
;

579 
dmix
->
°©e
 = 
SND_PCM_STATE_SETUP
;

580 
	`¢d_pcm_dúe˘_timî_°›
(
dmix
);

582 
	}
}

585 
	$__¢d_pcm_dmix_døö
(
¢d_pcm_t
 *
pcm
)

587 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

588 
¢d_pcm_u‰ames_t
 
°›_thªshﬁd
;

589 
îr
 = 0;

591 
	`¢d_pcm_°©e
(
dmix
->
•cm
)) {

592 
SND_PCM_STATE_SUSPENDED
:

593  -
ESTRPIPE
;

598 i‡(
dmix
->
°©e
 =
SND_PCM_STATE_OPEN
)

599  -
EBADFD
;

600 i‡(
dmix
->
°©e
 =
SND_PCM_STATE_PREPARED
) {

601 i‡(
	`¢d_pcm_mm≠_∂ayback_hw_avaû
(
pcm
) > 0)

602 
	`¢d_pcm_dmix_°¨t
(
pcm
);

604 
	`¢d_pcm_dmix_dr›
(
pcm
);

609 i‡(
dmix
->
°©e
 =
SND_PCM_STATE_XRUN
) {

610 
	`¢d_pcm_dmix_dr›
(
pcm
);

614 
°›_thªshﬁd
 = 
pcm
->stop_threshold;

615 i‡(
pcm
->
°›_thªshﬁd
 >Öcm->
buf„r_size
)

616 
pcm
->
°›_thªshﬁd
 =Öcm->
buf„r_size
;

617 
dmix
->
°©e
 = 
SND_PCM_STATE_DRAINING
;

619 
îr
 = 
	`¢d_pcm_dmix_sync_±r
(
pcm
);

620 i‡(
îr
 < 0) {

621 
	`¢d_pcm_dmix_dr›
(
pcm
);

622 
d⁄e
;

624 i‡(
dmix
->
°©e
 =
SND_PCM_STATE_DRAINING
) {

625 
	`¢d_pcm_dmix_sync_¨ó
(
pcm
);

626 i‡((
pcm
->
mode
 & 
SND_PCM_NONBLOCK
) == 0) {

627 
	`¢d_pcm_waô_nocheck
(
pcm
, 
SND_PCM_WAIT_DRAIN
);

628 
	`¢d_pcm_dúe˘_˛ór_timî_queue
(
dmix
);

631 
	`¢d_pcm_°©e
(
dmix
->
•cm
)) {

632 
SND_PCM_STATE_SUSPENDED
:

633 
îr
 = -
ESTRPIPE
;

634 
d⁄e
;

639 i‡(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
) {

640 i‡(
dmix
->
°©e
 =
SND_PCM_STATE_DRAINING
) {

641 
îr
 = -
EAGAIN
;

642 
d⁄e
;

645 } 
dmix
->
°©e
 =
SND_PCM_STATE_DRAINING
);

646 
d⁄e
:

647 
pcm
->
°›_thªshﬁd
 = stop_threshold;

648  
îr
;

649 
	}
}

651 
	$¢d_pcm_dmix_døö
(
¢d_pcm_t
 *
pcm
)

653 
îr
;

655 
	`¢d_pcm_lock
(
pcm
);

656 
îr
 = 
	`__¢d_pcm_dmix_døö
(
pcm
);

657 
	`¢d_pcm_u∆ock
(
pcm
);

658  
îr
;

659 
	}
}

661 
	$¢d_pcm_dmix_∑u£
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
íabÀ
 ATTRIBUTE_UNUSED)

663  -
EIO
;

664 
	}
}

666 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dmix_ªwödabÀ
(
¢d_pcm_t
 *
pcm
)

668  
	`¢d_pcm_mm≠_∂ayback_hw_ªwödabÀ
(
pcm
);

669 
	}
}

671 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dmix_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

673 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

674 
¢d_pcm_u‰ames_t
 
¶ave_≠∂_±r
, 
¶ave_size
;

675 
¢d_pcm_u‰ames_t
 
≠∂_±r
, 
size
, 
å™s„r
, 
ªsu…
, 
‰ames_to_ªmix
;

676 
îr
;

677 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
, *
d°_¨ós
;

679 i‡(
dmix
->
°©e
 =
SND_PCM_STATE_RUNNING
 ||

680 
dmix
->
°©e
 =
SND_PCM_STATE_DRAINING
) {

681 
îr
 = 
	`¢d_pcm_dmix_hwsync
(
pcm
);

682 i‡(
îr
 < 0)

683  
îr
;

693 
size
 = 
	`pcm_‰ame_diff
(
dmix
->
œ°_≠∂_±r
, dmix->
≠∂_±r
, 
pcm
->
bound¨y
);

694 i‡(
‰ames
 < 
size
)

695 
size
 = 
‰ames
;

696 
	`¢d_pcm_mm≠_≠∂_backw¨d
(
pcm
, 
size
);

697 
‰ames
 -
size
;

698 i‡(!
‰ames
)

699  
size
;

700 
ªsu…
 = 
size
;

705 
size
 = 
	`pcm_‰ame_diff
(
dmix
->
≠∂_±r
, dmix->
hw_±r
, 
pcm
->
bound¨y
);

706 i‡(
size
 > 
‰ames
)

707 
size
 = 
‰ames
;

708 
¶ave_size
 = 
	`pcm_‰ame_diff
(
dmix
->
¶ave_≠∂_±r
, dmix->
¶ave_hw_±r
, 
pcm
->
bound¨y
);

709 i‡(
¶ave_size
 < 
size
)

710 
size
 = 
¶ave_size
;

715 
‰ames_to_ªmix
 = 
size
;

718 
§c_¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

719 
d°_¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
dmix
->
•cm
);

720 
dmix
->
œ°_≠∂_±r
 -
size
;

721 
dmix
->
œ°_≠∂_±r
 %
pcm
->
bound¨y
;

722 
≠∂_±r
 = 
dmix
->
œ°_≠∂_±r
 % 
pcm
->
buf„r_size
;

723 
dmix
->
¶ave_≠∂_±r
 -
size
;

724 
dmix
->
¶ave_≠∂_±r
 %dmix->
¶ave_bound¨y
;

725 
¶ave_≠∂_±r
 = 
dmix
->¶ave_≠∂_±∏% dmix->
¶ave_buf„r_size
;

726 
	`dmix_down_£m
(
dmix
);

728 
å™s„r
 = 
size
;

729 i‡(
≠∂_±r
 + 
å™s„r
 > 
pcm
->
buf„r_size
)

730 
å™s„r
 = 
pcm
->
buf„r_size
 - 
≠∂_±r
;

731 i‡(
¶ave_≠∂_±r
 + 
å™s„r
 > 
dmix
->
¶ave_buf„r_size
)

732 
å™s„r
 = 
dmix
->
¶ave_buf„r_size
 - 
¶ave_≠∂_±r
;

733 
	`ªmix_¨ós
(
dmix
, 
§c_¨ós
, 
d°_¨ós
, 
≠∂_±r
, 
¶ave_≠∂_±r
, 
å™s„r
);

734 
size
 -
å™s„r
;

735 i‡(! 
size
)

737 
¶ave_≠∂_±r
 +
å™s„r
;

738 
¶ave_≠∂_±r
 %
dmix
->
¶ave_buf„r_size
;

739 
≠∂_±r
 +
å™s„r
;

740 
≠∂_±r
 %
pcm
->
buf„r_size
;

742 
	`dmix_up_£m
(
dmix
);

744 
	`¢d_pcm_mm≠_≠∂_backw¨d
(
pcm
, 
‰ames_to_ªmix
);

745 
ªsu…
 +
‰ames_to_ªmix
;

750  
ªsu…
;

751 
	}
}

753 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dmix_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
)

755  
	`¢d_pcm_mm≠_avaû
(
pcm
);

756 
	}
}

758 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dmix_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

760 
¢d_pcm_s‰ames_t
 
avaû
;

762 
avaû
 = 
	`¢d_pcm_dmix_f‹w¨dabÀ
(
pcm
);

763 i‡(
‰ames
 > (
¢d_pcm_u‰ames_t
)
avaû
)

764 
‰ames
 = 
avaû
;

765 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
‰ames
);

766  
‰ames
;

767 
	}
}

769 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dmix_ªadi
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, *
buf„r
 ATTRIBUTE_UNUSED, 
¢d_pcm_u‰ames_t
 
size
 ATTRIBUTE_UNUSED)

771  -
ENODEV
;

772 
	}
}

774 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dmix_ªadn
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, **
bufs
 ATTRIBUTE_UNUSED, 
¢d_pcm_u‰ames_t
 
size
 ATTRIBUTE_UNUSED)

776  -
ENODEV
;

777 
	}
}

779 
	$¢d_pcm_dmix_˛o£
(
¢d_pcm_t
 *
pcm
)

781 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

783 i‡(
dmix
->
timî
)

784 
	`¢d_timî_˛o£
(
dmix
->
timî
);

785 
	`¢d_pcm_dúe˘_£m≠h‹e_down
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

786 
	`¢d_pcm_˛o£
(
dmix
->
•cm
);

787 i‡(
dmix
->
£rvî
)

788 
	`¢d_pcm_dúe˘_£rvî_disˇrd
(
dmix
);

789 i‡(
dmix
->
˛õ¡
)

790 
	`¢d_pcm_dúe˘_˛õ¡_disˇrd
(
dmix
);

791 
	`shm_sum_disˇrd
(
dmix
);

792 i‡(
	`¢d_pcm_dúe˘_shm_disˇrd
(
dmix
)) {

793 i‡(
	`¢d_pcm_dúe˘_£m≠h‹e_disˇrd
(
dmix
))

794 
	`¢d_pcm_dúe˘_£m≠h‹e_föÆ
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

796 
	`¢d_pcm_dúe˘_£m≠h‹e_föÆ
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

797 
	`‰ì
(
dmix
->
bödögs
);

798 
pcm
->
¥iv©e_d©a
 = 
NULL
;

799 
	`‰ì
(
dmix
);

801 
	}
}

803 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dmix_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

804 
¢d_pcm_u‰ames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

805 
¢d_pcm_u‰ames_t
 
size
)

807 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

808 
îr
;

810 
îr
 = 
	`¢d_pcm_dúe˘_check_xrun
(
dmix
, 
pcm
);

811 i‡(
îr
 < 0)

812  
îr
;

813 i‡(! 
size
)

815 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
size
);

816 i‡(
dmix
->
°©e
 =
STATE_RUN_PENDING
) {

817 i‡((
îr
 = 
	`¢d_pcm_dmix_°¨t_timî
(
pcm
, 
dmix
)) < 0)

818  
îr
;

819 } i‡(
dmix
->
°©e
 =
SND_PCM_STATE_RUNNING
 ||

820 
dmix
->
°©e
 =
SND_PCM_STATE_DRAINING
) {

821 i‡((
îr
 = 
	`¢d_pcm_dmix_sync_±r
(
pcm
)) < 0)

822  
îr
;

824 i‡(
dmix
->
°©e
 =
SND_PCM_STATE_RUNNING
 ||

825 
dmix
->
°©e
 =
SND_PCM_STATE_DRAINING
) {

828 
	`¢d_pcm_dmix_sync_¨ó
(
pcm
);

830 i‡(
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
Ë<Öcm->
avaû_mö
)

831 
	`¢d_pcm_dúe˘_˛ór_timî_queue
(
dmix
);

833  
size
;

834 
	}
}

836 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dmix_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

838 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

839 
îr
;

841 i‡(
dmix
->
°©e
 =
SND_PCM_STATE_RUNNING
 ||

842 
dmix
->
°©e
 =
SND_PCM_STATE_DRAINING
) {

843 i‡((
îr
 = 
	`¢d_pcm_dmix_sync_±r
(
pcm
)) < 0)

844  
îr
;

846 i‡(
dmix
->
°©e
 =
SND_PCM_STATE_XRUN
)

847  -
EPIPE
;

849  
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
);

850 
	}
}

852 
	$¢d_pcm_dmix_htime°amp
(
¢d_pcm_t
 *
pcm
,

853 
¢d_pcm_u‰ames_t
 *
avaû
,

854 
¢d_htime°amp_t
 *
t°amp
)

856 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

857 
¢d_pcm_u‰ames_t
 
avaû1
;

858 
ok
 = 0;

861 i‡(
dmix
->
°©e
 =
SND_PCM_STATE_RUNNING
 ||

862 
dmix
->
°©e
 =
SND_PCM_STATE_DRAINING
)

863 
	`¢d_pcm_dmix_sync_±r
(
pcm
);

864 
avaû1
 = 
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
);

865 i‡(
ok
 && *
avaû
 =
avaû1
)

867 *
avaû
 = 
avaû1
;

868 *
t°amp
 = 
	`¢d_pcm_hw_Á°_t°amp
(
dmix
->
•cm
);

869 
ok
 = 1;

872 
	}
}

874 
	$¢d_pcm_dmix_pﬁl_ªvíts
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

876 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

877 i‡(
dmix
->
°©e
 =
SND_PCM_STATE_RUNNING
)

878 
	`¢d_pcm_dmix_sync_¨ó
(
pcm
);

879  
	`¢d_pcm_dúe˘_pﬁl_ªvíts
(
pcm
, 
pfds
, 
nfds
, 
ªvíts
);

880 
	}
}

883 
	$¢d_pcm_dmix_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

885 
¢d_pcm_dúe˘_t
 *
dmix
 = 
pcm
->
¥iv©e_d©a
;

887 
	`¢d_ouçut_¥ötf
(
out
, "Direct Stream Mixing PCM\n");

888 i‡(
pcm
->
£tup
) {

889 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

890 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

892 i‡(
dmix
->
•cm
)

893 
	`¢d_pcm_dump
(
dmix
->
•cm
, 
out
);

894 
	}
}

896 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_dmix_›s
 = {

897 .
˛o£
 = 
¢d_pcm_dmix_˛o£
,

898 .
	göfo
 = 
¢d_pcm_dúe˘_öfo
,

899 .
	ghw_ªföe
 = 
¢d_pcm_dúe˘_hw_ªföe
,

900 .
	ghw_∑øms
 = 
¢d_pcm_dúe˘_hw_∑øms
,

901 .
	ghw_‰ì
 = 
¢d_pcm_dúe˘_hw_‰ì
,

902 .
	gsw_∑øms
 = 
¢d_pcm_dúe˘_sw_∑øms
,

903 .
	gch™√l_öfo
 = 
¢d_pcm_dúe˘_ch™√l_öfo
,

904 .
	gdump
 = 
¢d_pcm_dmix_dump
,

905 .
	gn⁄block
 = 
¢d_pcm_dúe˘_n⁄block
,

906 .
	gasync
 = 
¢d_pcm_dúe˘_async
,

907 .
	gmm≠
 = 
¢d_pcm_dúe˘_mm≠
,

908 .
	gmunm≠
 = 
¢d_pcm_dúe˘_munm≠
,

909 .
	gquîy_chm≠s
 = 
¢d_pcm_dúe˘_quîy_chm≠s
,

910 .
	ggë_chm≠
 = 
¢d_pcm_dúe˘_gë_chm≠
,

911 .
	g£t_chm≠
 = 
¢d_pcm_dúe˘_£t_chm≠
,

914 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_dmix_Á°_›s
 = {

915 .
°©us
 = 
¢d_pcm_dmix_°©us
,

916 .
	g°©e
 = 
¢d_pcm_dmix_°©e
,

917 .
	ghwsync
 = 
¢d_pcm_dmix_hwsync
,

918 .
	gdñay
 = 
¢d_pcm_dmix_dñay
,

919 .
	g¥ï¨e
 = 
¢d_pcm_dúe˘_¥ï¨e
,

920 .
	gª£t
 = 
¢d_pcm_dmix_ª£t
,

921 .
	g°¨t
 = 
¢d_pcm_dmix_°¨t
,

922 .
	gdr›
 = 
¢d_pcm_dmix_dr›
,

923 .
	gdøö
 = 
¢d_pcm_dmix_døö
,

924 .
	g∑u£
 = 
¢d_pcm_dmix_∑u£
,

925 .
	gªwödabÀ
 = 
¢d_pcm_dmix_ªwödabÀ
,

926 .
	gªwöd
 = 
¢d_pcm_dmix_ªwöd
,

927 .
	gf‹w¨dabÀ
 = 
¢d_pcm_dmix_f‹w¨dabÀ
,

928 .
	gf‹w¨d
 = 
¢d_pcm_dmix_f‹w¨d
,

929 .
	gªsume
 = 
¢d_pcm_dúe˘_ªsume
,

930 .
	glök
 = 
NULL
,

931 .
	glök_¶aves
 = 
NULL
,

932 .
	gu∆ök
 = 
NULL
,

933 .
	gwrôei
 = 
¢d_pcm_mm≠_wrôei
,

934 .
	gwrôí
 = 
¢d_pcm_mm≠_wrôí
,

935 .
	gªadi
 = 
¢d_pcm_dmix_ªadi
,

936 .
	gªadn
 = 
¢d_pcm_dmix_ªadn
,

937 .
	gavaû_upd©e
 = 
¢d_pcm_dmix_avaû_upd©e
,

938 .
	gmm≠_commô
 = 
¢d_pcm_dmix_mm≠_commô
,

939 .
	ghtime°amp
 = 
¢d_pcm_dmix_htime°amp
,

940 .
	gpﬁl_des¸ùt‹s
 = 
¢d_pcm_dúe˘_pﬁl_des¸ùt‹s
,

941 .
	gpﬁl_des¸ùt‹s_cou¡
 = 
NULL
,

942 .
	gpﬁl_ªvíts
 = 
¢d_pcm_dmix_pﬁl_ªvíts
,

960 
	$¢d_pcm_dmix_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

961 
¢d_pcm_dúe˘_›í_c⁄f
 *
›ts
,

962 
¶ave_∑øms
 *
∑øms
,

963 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
sc⁄f
,

964 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

966 
¢d_pcm_t
 *
pcm
, *
•cm
 = 
NULL
;

967 
¢d_pcm_dúe˘_t
 *
dmix
;

968 
ªt
, 
fú°_ö°™˚
;

970 
	`as£π
(
pcmp
);

972 i‡(
°ªam
 !
SND_PCM_STREAM_PLAYBACK
) {

973 
	`SNDERR
("The dmixÖlugin supports onlyÖlayback stream");

974  -
EINVAL
;

977 
ªt
 = 
	`_¢d_pcm_dúe˘_√w
(&
pcm
, &
dmix
, 
SND_PCM_TYPE_DMIX
, 
«me
, 
›ts
, 
∑øms
, 
°ªam
, 
mode
);

978 i‡(
ªt
 < 0)

979  
ªt
;

980 
fú°_ö°™˚
 = 
ªt
;

982 
pcm
->
›s
 = &
¢d_pcm_dmix_›s
;

983 
pcm
->
Á°_›s
 = &
¢d_pcm_dmix_Á°_›s
;

984 
pcm
->
¥iv©e_d©a
 = 
dmix
;

985 
dmix
->
°©e
 = 
SND_PCM_STATE_OPEN
;

986 
dmix
->
¶ow±r
 = 
›ts
->slowptr;

987 
dmix
->
max_≥riods
 = 
›ts
->max_periods;

988 
dmix
->
v¨_≥riodsize
 = 
›ts
->var_periodsize;

989 
dmix
->
hw_±r_Æignmít
 = 
›ts
->hw_ptr_alignment;

990 
dmix
->
sync_±r
 = 
¢d_pcm_dmix_sync_±r
;

991 
dmix
->
dúe˘_mem‹y_ac˚ss
 = 
›ts
->direct_memory_access;

993 
ªåy
:

994 i‡(
fú°_ö°™˚
) {

997 
ªt
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
,

998 
mode
 | 
SND_PCM_NONBLOCK
, 
NULL
);

999 i‡(
ªt
 < 0) {

1000 
	`SNDERR
("unableÅo open slave");

1001 
_îr
;

1004 i‡(
	`¢d_pcm_ty≥
(
•cm
Ë!
SND_PCM_TYPE_HW
) {

1005 
	`SNDERR
("dmixÖlugin can be only connectedÅo hwÖlugin");

1006 
ªt
 = -
EINVAL
;

1007 
_îr
;

1010 
ªt
 = 
	`¢d_pcm_dúe˘_öôülize_¶ave
(
dmix
, 
•cm
, 
∑øms
);

1011 i‡(
ªt
 < 0) {

1012 
	`SNDERR
("unableÅo initialize slave");

1013 
_îr
;

1016 
dmix
->
•cm
 = spcm;

1018 i‡(
dmix
->
shm±r
->
u£_£rvî
) {

1019 
dmix
->
£rvî_‰ì
 = 
dmix_£rvî_‰ì
;

1021 
ªt
 = 
	`¢d_pcm_dúe˘_£rvî_¸óã
(
dmix
);

1022 i‡(
ªt
 < 0) {

1023 
	`SNDERR
("unableÅo create server");

1024 
_îr
;

1028 
dmix
->
shm±r
->
ty≥
 = 
•cm
->type;

1030 i‡(
dmix
->
shm±r
->
u£_£rvî
) {

1032 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

1033 
ªt
 = 
	`¢d_pcm_dúe˘_˛õ¡_c⁄√˘
(
dmix
);

1034 i‡(
ªt
 < 0) {

1035 
	`SNDERR
("unableÅo connect client");

1036 
_îr_no£m
;

1039 
	`¢d_pcm_dúe˘_£m≠h‹e_down
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

1040 
ªt
 = 
	`¢d_pcm_dúe˘_›í_£c⁄d¨y_˛õ¡
(&
•cm
, 
dmix
, "dmix_client");

1041 i‡(
ªt
 < 0)

1042 
_îr
;

1045 
ªt
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
,

1046 
mode
 | 
SND_PCM_NONBLOCK
 |

1047 
SND_PCM_APPEND
,

1048 
NULL
);

1049 i‡(
ªt
 < 0) {

1053 i‡(
ªt
 =-
EBADFD
) {

1054 
fú°_ö°™˚
 = 1;

1055 
ªåy
;

1057 
	`SNDERR
("unableÅo open slave");

1058 
_îr
;

1060 i‡(
	`¢d_pcm_ty≥
(
•cm
Ë!
SND_PCM_TYPE_HW
) {

1061 
	`SNDERR
("dmixÖlugin can be only connectedÅo hwÖlugin");

1062 
ªt
 = -
EINVAL
;

1063 
_îr
;

1066 
ªt
 = 
	`¢d_pcm_dúe˘_öôülize_£c⁄d¨y_¶ave
(
dmix
, 
•cm
, 
∑øms
);

1067 i‡(
ªt
 < 0) {

1068 
	`SNDERR
("unableÅo initialize slave");

1069 
_îr
;

1073 
dmix
->
•cm
 = spcm;

1076 
ªt
 = 
	`shm_sum_¸óã_‹_c⁄√˘
(
dmix
);

1077 i‡(
ªt
 < 0) {

1078 
	`SNDERR
("unableÅo initialize sumÑing buffer");

1079 
_îr
;

1082 
ªt
 = 
	`¢d_pcm_dúe˘_öôülize_pﬁl_fd
(
dmix
);

1083 i‡(
ªt
 < 0) {

1084 
	`SNDERR
("unableÅo initializeÖoll_fd");

1085 
_îr
;

1088 
	`mix_£À˘_ˇŒbacks
(
dmix
);

1090 
pcm
->
pﬁl_fd
 = 
dmix
->poll_fd;

1091 
pcm
->
pﬁl_evíts
 = 
POLLIN
;

1092 
pcm
->
t°amp_ty≥
 = 
•cm
->tstamp_type;

1093 
pcm
->
mm≠_rw
 = 1;

1094 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
dmix
->
hw_±r
, -1, 0);

1095 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
dmix
->
≠∂_±r
, -1, 0);

1097 i‡(
dmix
->
ch™√ls
 =
UINT_MAX
)

1098 
dmix
->
ch™√ls
 = dmix->
shm±r
->
s
.channels;

1100 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

1102 *
pcmp
 = 
pcm
;

1105 
_îr
:

1106 i‡(
dmix
->
timî
)

1107 
	`¢d_timî_˛o£
(
dmix
->
timî
);

1108 i‡(
dmix
->
£rvî
)

1109 
	`¢d_pcm_dúe˘_£rvî_disˇrd
(
dmix
);

1110 i‡(
dmix
->
˛õ¡
)

1111 
	`¢d_pcm_dúe˘_˛õ¡_disˇrd
(
dmix
);

1112 i‡(
•cm
)

1113 
	`¢d_pcm_˛o£
(
•cm
);

1114 i‡(
dmix
->
u
.dmix.
shmid_sum
 >= 0)

1115 
	`shm_sum_disˇrd
(
dmix
);

1116 i‡((
dmix
->
shmid
 >0Ë&& (
	`¢d_pcm_dúe˘_shm_disˇrd
(dmix))) {

1117 i‡(
	`¢d_pcm_dúe˘_£m≠h‹e_disˇrd
(
dmix
))

1118 
	`¢d_pcm_dúe˘_£m≠h‹e_föÆ
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

1120 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
dmix
, 
DIRECT_IPC_SEM_CLIENT
);

1121 
_îr_no£m
:

1122 
	`‰ì
(
dmix
->
bödögs
);

1123 
	`‰ì
(
dmix
);

1124 
	`¢d_pcm_‰ì
(
pcm
);

1125  
ªt
;

1126 
	}
}

1285 
	$_¢d_pcm_dmix_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1286 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

1287 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

1289 
¢d_c⁄fig_t
 *
sc⁄f
;

1290 
¶ave_∑øms
 
∑øms
;

1291 
¢d_pcm_dúe˘_›í_c⁄f
 
d›í
;

1292 
bsize
, 
psize
;

1293 
îr
;

1295 
îr
 = 
	`¢d_pcm_dúe˘_∑r£_›í_c⁄f
(
roŸ
, 
c⁄f
, 
°ªam
, &
d›í
);

1296 i‡(
îr
 < 0)

1297  
îr
;

1300 
∑øms
.
f‹m©
 = 
SND_PCM_FORMAT_S16
;

1301 
∑øms
.
øã
 = 48000;

1302 
∑øms
.
ch™√ls
 = 2;

1303 
∑øms
.
≥riod_time
 = -1;

1304 
∑øms
.
buf„r_time
 = -1;

1305 
bsize
 = 
psize
 = -1;

1306 
∑øms
.
≥riods
 = 3;

1308 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
d›í
.
¶ave
, &
sc⁄f
, 8,

1309 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_UNCHANGED
, &
∑øms
.
f‹m©
,

1310 
SND_PCM_HW_PARAM_RATE
, 0, &
∑øms
.
øã
,

1311 
SND_PCM_HW_PARAM_CHANNELS
, 0, &
∑øms
.
ch™√ls
,

1312 
SND_PCM_HW_PARAM_PERIOD_TIME
, 0, &
∑øms
.
≥riod_time
,

1313 
SND_PCM_HW_PARAM_BUFFER_TIME
, 0, &
∑øms
.
buf„r_time
,

1314 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 0, &
psize
,

1315 
SND_PCM_HW_PARAM_BUFFER_SIZE
, 0, &
bsize
,

1316 
SND_PCM_HW_PARAM_PERIODS
, 0, &
∑øms
.
≥riods
);

1317 i‡(
îr
 < 0)

1318  
îr
;

1321 i‡(
psize
 =-1 && 
∑øms
.
≥riod_time
 == -1)

1322 
∑øms
.
≥riod_time
 = 125000;

1324 i‡(
∑øms
.
f‹m©
 == -2)

1325 
∑øms
.
f‹m©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1326 i‡(!(
dmix_suµ‹ãd_f‹m©
 & (1ULL << 
∑øms
.
f‹m©
))) {

1328 
	`SNDERR
("Unsupported format");

1329 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1330  -
EINVAL
;

1333 
∑øms
.
≥riod_size
 = 
psize
;

1334 
∑øms
.
buf„r_size
 = 
bsize
;

1336 
îr
 = 
	`¢d_pcm_dmix_›í
(
pcmp
, 
«me
, &
d›í
, &
∑øms
,

1337 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
);

1338 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1339  
îr
;

1340 
	}
}

1341 #i‚de‡
DOC_HIDDEN


1342 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_dmix_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_generic.c

3 
	#LOCK_PREFIX
 "lock ; "

	)

4 
	#ARCH_ADD
(
p
,
a
) \

5 
__asm__
 
	`__vﬁ©ûe__
(
LOCK_PREFIX
 "addl %1,%0" \

6 :"=m" (*
p
) \

7 :"ú" (
a
), "m" (*
p
))

	)

8 
	s__xchg_dummy
 { 
	ma
[100]; };

9 
	#__xg
(
x
Ë((
__xchg_dummy
 *)(x))

	)

10 
ölöe
 
	$__cmpxchg
(vﬁ©ûê*
±r
, 
ﬁd
,

11 
√w
, 
size
)

13 
¥ev
;

14 
size
) {

16 
__asm__
 
	`__vﬁ©ûe__
(
LOCK_PREFIX
 "cmpxchgb %b1,%2"

17 : "˜"(
¥ev
)

18 : "q"(
√w
), "m"(*
	`__xg
(
±r
)), "0"(
ﬁd
)

20  
¥ev
;

22 
__asm__
 
	`__vﬁ©ûe__
(
LOCK_PREFIX
 "cmpxchgw %w1,%2"

23 : "˜"(
¥ev
)

24 : "q"(
√w
), "m"(*
	`__xg
(
±r
)), "0"(
ﬁd
)

26  
¥ev
;

28 
__asm__
 
	`__vﬁ©ûe__
(
LOCK_PREFIX
 "cmpxchgl %1,%2"

29 : "˜"(
¥ev
)

30 : "q"(
√w
), "m"(*
	`__xg
(
±r
)), "0"(
ﬁd
)

32  
¥ev
;

34  
ﬁd
;

35 
	}
}

37 
	#ARCH_CMPXCHG
(
±r
,
o
,
n
)\

38 ((
	`__ty≥of__
(*(
±r
)))
	`__cmpxchg
(’å),()(
o
),\

39 ()(
n
),(*(
±r
))))

	)

40 
	#IS_CONCURRENT
 1

	)

43 #i‚de‡
ARCH_ADD


44 
	#ARCH_ADD
(
p
,
a
Ë(*’Ë+◊))

	)

45 
	#ARCH_CMPXCHG
(
p
,
a
,
b
Ë(*’)Ë

	)

46 
	#IS_CONCURRENT
 0

	)

49 #i‡
IS_CONCURRENT


50 
	$mix_¨ós_16
(
size
,

51 vﬁ©ûêsig√d *
d°
, sig√d *
§c
,

52 vﬁ©ûêsig√d *
sum
, 
size_t
 
d°_°ï
,

53 
size_t
 
§c_°ï
, size_à
sum_°ï
)

55 sig√d 
ßm∂e
, 
ﬁd_ßm∂e
;

58 
ßm∂e
 = *
§c
;

59 
ﬁd_ßm∂e
 = *
sum
;

60 i‡(
	`ARCH_CMPXCHG
(
d°
, 0, 1) == 0)

61 
ßm∂e
 -
ﬁd_ßm∂e
;

62 
	`ARCH_ADD
(
sum
, 
ßm∂e
);

64 
ﬁd_ßm∂e
 = *
sum
;

65 i‡(
ﬁd_ßm∂e
 > 0x7fff)

66 
ßm∂e
 = 0x7fff;

67 i‡(
ﬁd_ßm∂e
 < -0x8000)

68 
ßm∂e
 = -0x8000;

70 
ßm∂e
 = 
ﬁd_ßm∂e
;

71 *
d°
 = 
ßm∂e
;

72 } 
IS_CONCURRENT
 && *
sum
 !
ﬁd_ßm∂e
);

73 i‡(!--
size
)

75 
§c
 = (sig√d *Ë((*)§¯+ 
§c_°ï
);

76 
d°
 = (sig√d *Ë((*)d° + 
d°_°ï
);

77 
sum
 = (sig√d *Ë((*)sum + 
sum_°ï
);

79 
	}
}

81 
	$mix_¨ós_32
(
size
,

82 vﬁ©ûêsig√d *
d°
, sig√d *
§c
,

83 vﬁ©ûêsig√d *
sum
, 
size_t
 
d°_°ï
,

84 
size_t
 
§c_°ï
, size_à
sum_°ï
)

86 sig√d 
ßm∂e
, 
ﬁd_ßm∂e
;

89 
ßm∂e
 = *
§c
 >> 8;

90 
ﬁd_ßm∂e
 = *
sum
;

91 i‡(
	`ARCH_CMPXCHG
(
d°
, 0, 1) == 0)

92 
ßm∂e
 -
ﬁd_ßm∂e
;

93 
	`ARCH_ADD
(
sum
, 
ßm∂e
);

95 
ﬁd_ßm∂e
 = *
sum
;

96 i‡(
ﬁd_ßm∂e
 > 0x7fffff)

97 
ßm∂e
 = 0x7fffffff;

98 i‡(
ﬁd_ßm∂e
 < -0x800000)

99 
ßm∂e
 = -0x80000000;

101 
ßm∂e
 = 
ﬁd_ßm∂e
 * 256;

102 *
d°
 = 
ßm∂e
;

103 } 
IS_CONCURRENT
 && *
sum
 !
ﬁd_ßm∂e
);

104 i‡(!--
size
)

106 
§c
 = (sig√d *Ë((*)§¯+ 
§c_°ï
);

107 
d°
 = (sig√d *Ë((*)d° + 
d°_°ï
);

108 
sum
 = (sig√d *Ë((*)sum + 
sum_°ï
);

110 
	}
}

112 
	$mix_£À˘_ˇŒbacks
(
¢d_pcm_dúe˘_t
 *
dmix
)

114 
dmix
->
u
.dmix.
mix_¨ós_16
 = mix_areas_16;

115 
dmix
->
u
.dmix.
mix_¨ós_32
 = mix_areas_32;

116 
	}
}

121 
	#gíîic_dmix_suµ‹ãd_f‹m©
 \

122 ((1ULL << 
SND_PCM_FORMAT_S16_LE
Ë| (1ULL << 
SND_PCM_FORMAT_S32_LE
) |\

123 (1ULL << 
SND_PCM_FORMAT_S16_BE
Ë| (1ULL << 
SND_PCM_FORMAT_S32_BE
) |\

124 (1ULL << 
SND_PCM_FORMAT_S24_LE
Ë| (1ULL << 
SND_PCM_FORMAT_S24_3LE
) | \

125 (1ULL << 
SND_PCM_FORMAT_U8
))

	)

127 
	~"bsw≠.h
"

129 
	$gíîic_mix_¨ós_16_«tive
(
size
,

130 vﬁ©ûêsig√d *
d°
,

131 sig√d *
§c
,

132 vﬁ©ûêsig√d *
sum
,

133 
size_t
 
d°_°ï
,

134 
size_t
 
§c_°ï
,

135 
size_t
 
sum_°ï
)

137 sig√d 
ßm∂e
;

140 
ßm∂e
 = *
§c
;

141 i‡(! *
d°
) {

142 *
sum
 = 
ßm∂e
;

143 *
d°
 = *
§c
;

145 
ßm∂e
 +*
sum
;

146 *
sum
 = 
ßm∂e
;

147 i‡(
ßm∂e
 > 0x7fff)

148 
ßm∂e
 = 0x7fff;

149 i‡(
ßm∂e
 < -0x8000)

150 
ßm∂e
 = -0x8000;

151 *
d°
 = 
ßm∂e
;

153 i‡(!--
size
)

155 
§c
 = (sig√d *Ë((*)§¯+ 
§c_°ï
);

156 
d°
 = (sig√d *Ë((*)d° + 
d°_°ï
);

157 
sum
 = (sig√d *Ë((*)sum + 
sum_°ï
);

159 
	}
}

161 
	$gíîic_ªmix_¨ós_16_«tive
(
size
,

162 vﬁ©ûêsig√d *
d°
,

163 sig√d *
§c
,

164 vﬁ©ûêsig√d *
sum
,

165 
size_t
 
d°_°ï
,

166 
size_t
 
§c_°ï
,

167 
size_t
 
sum_°ï
)

169 sig√d 
ßm∂e
;

172 
ßm∂e
 = *
§c
;

173 i‡(! *
d°
) {

174 *
sum
 = -
ßm∂e
;

175 *
d°
 = -
ßm∂e
;

177 *
sum
 = 
ßm∂e
 = *sum - sample;

178 i‡(
ßm∂e
 > 0x7fff)

179 
ßm∂e
 = 0x7fff;

180 i‡(
ßm∂e
 < -0x8000)

181 
ßm∂e
 = -0x8000;

182 *
d°
 = 
ßm∂e
;

184 i‡(!--
size
)

186 
§c
 = (sig√d *Ë((*)§¯+ 
§c_°ï
);

187 
d°
 = (sig√d *Ë((*)d° + 
d°_°ï
);

188 
sum
 = (sig√d *Ë((*)sum + 
sum_°ï
);

190 
	}
}

192 
	$gíîic_mix_¨ós_32_«tive
(
size
,

193 vﬁ©ûêsig√d *
d°
,

194 sig√d *
§c
,

195 vﬁ©ûêsig√d *
sum
,

196 
size_t
 
d°_°ï
,

197 
size_t
 
§c_°ï
,

198 
size_t
 
sum_°ï
)

200 sig√d 
ßm∂e
;

203 
ßm∂e
 = *
§c
 >> 8;

204 i‡(! *
d°
) {

205 *
sum
 = 
ßm∂e
;

206 *
d°
 = *
§c
;

208 
ßm∂e
 +*
sum
;

209 *
sum
 = 
ßm∂e
;

210 i‡(
ßm∂e
 > 0x7fffff)

211 
ßm∂e
 = 0x7fffffff;

212 i‡(
ßm∂e
 < -0x800000)

213 
ßm∂e
 = -0x80000000;

215 
ßm∂e
 *= 256;

216 *
d°
 = 
ßm∂e
;

218 i‡(!--
size
)

220 
§c
 = (sig√d *Ë((*)§¯+ 
§c_°ï
);

221 
d°
 = (sig√d *Ë((*)d° + 
d°_°ï
);

222 
sum
 = (sig√d *Ë((*)sum + 
sum_°ï
);

224 
	}
}

226 
	$gíîic_ªmix_¨ós_32_«tive
(
size
,

227 vﬁ©ûêsig√d *
d°
,

228 sig√d *
§c
,

229 vﬁ©ûêsig√d *
sum
,

230 
size_t
 
d°_°ï
,

231 
size_t
 
§c_°ï
,

232 
size_t
 
sum_°ï
)

234 sig√d 
ßm∂e
;

237 
ßm∂e
 = *
§c
 >> 8;

238 i‡(! *
d°
) {

239 *
sum
 = -
ßm∂e
;

240 *
d°
 = -*
§c
;

242 *
sum
 = 
ßm∂e
 = *sum - sample;

243 i‡(
ßm∂e
 > 0x7fffff)

244 
ßm∂e
 = 0x7fffffff;

245 i‡(
ßm∂e
 < -0x800000)

246 
ßm∂e
 = -0x80000000;

248 
ßm∂e
 *= 256;

249 *
d°
 = 
ßm∂e
;

251 i‡(!--
size
)

253 
§c
 = (sig√d *Ë((*)§¯+ 
§c_°ï
);

254 
d°
 = (sig√d *Ë((*)d° + 
d°_°ï
);

255 
sum
 = (sig√d *Ë((*)sum + 
sum_°ï
);

257 
	}
}

259 
	$gíîic_mix_¨ós_16_sw≠
(
size
,

260 vﬁ©ûêsig√d *
d°
,

261 sig√d *
§c
,

262 vﬁ©ûêsig√d *
sum
,

263 
size_t
 
d°_°ï
,

264 
size_t
 
§c_°ï
,

265 
size_t
 
sum_°ï
)

267 sig√d 
ßm∂e
;

270 
ßm∂e
 = (sig√d Ë
	`bsw≠_16
(*
§c
);

271 i‡(! *
d°
) {

272 *
sum
 = 
ßm∂e
;

273 *
d°
 = *
§c
;

275 
ßm∂e
 +*
sum
;

276 *
sum
 = 
ßm∂e
;

277 i‡(
ßm∂e
 > 0x7fff)

278 
ßm∂e
 = 0x7fff;

279 i‡(
ßm∂e
 < -0x8000)

280 
ßm∂e
 = -0x8000;

281 *
d°
 = (sig√d Ë
	`bsw≠_16
((sig√d Ë
ßm∂e
);

283 i‡(!--
size
)

285 
§c
 = (sig√d *Ë((*)§¯+ 
§c_°ï
);

286 
d°
 = (sig√d *Ë((*)d° + 
d°_°ï
);

287 
sum
 = (sig√d *Ë((*)sum + 
sum_°ï
);

289 
	}
}

291 
	$gíîic_ªmix_¨ós_16_sw≠
(
size
,

292 vﬁ©ûêsig√d *
d°
,

293 sig√d *
§c
,

294 vﬁ©ûêsig√d *
sum
,

295 
size_t
 
d°_°ï
,

296 
size_t
 
§c_°ï
,

297 
size_t
 
sum_°ï
)

299 sig√d 
ßm∂e
;

302 
ßm∂e
 = (sig√d Ë
	`bsw≠_16
(*
§c
);

303 i‡(! *
d°
) {

304 *
sum
 = -
ßm∂e
;

305 *
d°
 = (sig√d Ë
	`bsw≠_16
((sig√d Ë-
ßm∂e
);

307 *
sum
 = 
ßm∂e
 = *sum - sample;

308 i‡(
ßm∂e
 > 0x7fff)

309 
ßm∂e
 = 0x7fff;

310 i‡(
ßm∂e
 < -0x8000)

311 
ßm∂e
 = -0x8000;

312 *
d°
 = (sig√d Ë
	`bsw≠_16
((sig√d Ë
ßm∂e
);

314 i‡(!--
size
)

316 
§c
 = (sig√d *Ë((*)§¯+ 
§c_°ï
);

317 
d°
 = (sig√d *Ë((*)d° + 
d°_°ï
);

318 
sum
 = (sig√d *Ë((*)sum + 
sum_°ï
);

320 
	}
}

322 
	$gíîic_mix_¨ós_32_sw≠
(
size
,

323 vﬁ©ûêsig√d *
d°
,

324 sig√d *
§c
,

325 vﬁ©ûêsig√d *
sum
,

326 
size_t
 
d°_°ï
,

327 
size_t
 
§c_°ï
,

328 
size_t
 
sum_°ï
)

330 sig√d 
ßm∂e
;

333 
ßm∂e
 = (sig√d Ë
	`bsw≠_32
(*
§c
) >> 8;

334 i‡(! *
d°
) {

335 *
sum
 = 
ßm∂e
;

336 *
d°
 = *
§c
;

338 
ßm∂e
 +*
sum
;

339 *
sum
 = 
ßm∂e
;

340 i‡(
ßm∂e
 > 0x7fffff)

341 
ßm∂e
 = 0x7fffffff;

342 i‡(
ßm∂e
 < -0x800000)

343 
ßm∂e
 = -0x80000000;

345 
ßm∂e
 *= 256;

346 *
d°
 = 
	`bsw≠_32
(
ßm∂e
);

348 i‡(!--
size
)

350 
§c
 = (sig√d *Ë((*)§¯+ 
§c_°ï
);

351 
d°
 = (sig√d *Ë((*)d° + 
d°_°ï
);

352 
sum
 = (sig√d *Ë((*)sum + 
sum_°ï
);

354 
	}
}

356 
	$gíîic_ªmix_¨ós_32_sw≠
(
size
,

357 vﬁ©ûêsig√d *
d°
,

358 sig√d *
§c
,

359 vﬁ©ûêsig√d *
sum
,

360 
size_t
 
d°_°ï
,

361 
size_t
 
§c_°ï
,

362 
size_t
 
sum_°ï
)

364 sig√d 
ßm∂e
;

367 
ßm∂e
 = (sig√d Ë
	`bsw≠_32
(*
§c
) >> 8;

368 i‡(! *
d°
) {

369 *
sum
 = -
ßm∂e
;

370 *
d°
 = 
	`bsw≠_32
(-
ßm∂e
);

372 *
sum
 = 
ßm∂e
 = *sum - sample;

373 i‡(
ßm∂e
 > 0x7fffff)

374 
ßm∂e
 = 0x7fffffff;

375 i‡(
ßm∂e
 < -0x800000)

376 
ßm∂e
 = -0x80000000;

378 
ßm∂e
 *= 256;

379 *
d°
 = 
	`bsw≠_32
(
ßm∂e
);

381 i‡(!--
size
)

383 
§c
 = (sig√d *Ë((*)§¯+ 
§c_°ï
);

384 
d°
 = (sig√d *Ë((*)d° + 
d°_°ï
);

385 
sum
 = (sig√d *Ë((*)sum + 
sum_°ï
);

387 
	}
}

390 
	$gíîic_mix_¨ós_24
(
size
,

391 vﬁ©ûê*
d°
,

392 *
§c
,

393 vﬁ©ûêsig√d *
sum
,

394 
size_t
 
d°_°ï
,

395 
size_t
 
§c_°ï
,

396 
size_t
 
sum_°ï
)

398 sig√d 
ßm∂e
;

401 
ßm∂e
 = 
§c
[0] | (src[1] << 8) | (((signed *)src)[2] << 16);

402 i‡(!(
d°
[0] | dst[1] | dst[2])) {

403 *
sum
 = 
ßm∂e
;

405 
ßm∂e
 +*
sum
;

406 *
sum
 = 
ßm∂e
;

407 i‡(
ßm∂e
 > 0x7fffff)

408 
ßm∂e
 = 0x7fffff;

409 i‡(
ßm∂e
 < -0x800000)

410 
ßm∂e
 = -0x800000;

412 
d°
[0] = 
ßm∂e
;

413 
d°
[1] = 
ßm∂e
 >> 8;

414 
d°
[2] = 
ßm∂e
 >> 16;

415 i‡(!--
size
)

417 
d°
 +
d°_°ï
;

418 
§c
 +
§c_°ï
;

419 
sum
 = (sig√d *Ë((*)sum + 
sum_°ï
);

421 
	}
}

423 
	$gíîic_ªmix_¨ós_24
(
size
,

424 vﬁ©ûê*
d°
,

425 *
§c
,

426 vﬁ©ûêsig√d *
sum
,

427 
size_t
 
d°_°ï
,

428 
size_t
 
§c_°ï
,

429 
size_t
 
sum_°ï
)

431 sig√d 
ßm∂e
;

434 
ßm∂e
 = 
§c
[0] | (src[1] << 8) | (((signed *)src)[2] << 16);

435 i‡(!(
d°
[0] | dst[1] | dst[2])) {

436 
ßm∂e
 = -sample;

437 *
sum
 = 
ßm∂e
;

439 *
sum
 = 
ßm∂e
 = *sum - sample;

440 i‡(
ßm∂e
 > 0x7fffff)

441 
ßm∂e
 = 0x7fffff;

442 i‡(
ßm∂e
 < -0x800000)

443 
ßm∂e
 = -0x800000;

445 
d°
[0] = 
ßm∂e
;

446 
d°
[1] = 
ßm∂e
 >> 8;

447 
d°
[2] = 
ßm∂e
 >> 16;

448 i‡(!--
size
)

450 
d°
 +
d°_°ï
;

451 
§c
 +
§c_°ï
;

452 
sum
 = (sig√d *Ë((*)sum + 
sum_°ï
);

454 
	}
}

456 
	$gíîic_mix_¨ós_u8
(
size
,

457 vﬁ©ûê*
d°
,

458 *
§c
,

459 vﬁ©ûêsig√d *
sum
,

460 
size_t
 
d°_°ï
,

461 
size_t
 
§c_°ï
,

462 
size_t
 
sum_°ï
)

465 
ßm∂e
 = *
§c
 - 0x80;

466 i‡(*
d°
 == 0x80) {

467 *
sum
 = 
ßm∂e
;

469 
ßm∂e
 +*
sum
;

470 *
sum
 = 
ßm∂e
;

471 i‡(
ßm∂e
 > 0x7f)

472 
ßm∂e
 = 0x7f;

473 i‡(
ßm∂e
 < -0x80)

474 
ßm∂e
 = -0x80;

476 *
d°
 = 
ßm∂e
 + 0x80;

477 i‡(!--
size
)

479 
d°
 +
d°_°ï
;

480 
§c
 +
§c_°ï
;

481 
sum
 = (sig√d *Ë((*)sum + 
sum_°ï
);

483 
	}
}

485 
	$gíîic_ªmix_¨ós_u8
(
size
,

486 vﬁ©ûê*
d°
,

487 *
§c
,

488 vﬁ©ûêsig√d *
sum
,

489 
size_t
 
d°_°ï
,

490 
size_t
 
§c_°ï
,

491 
size_t
 
sum_°ï
)

494 
ßm∂e
 = *
§c
 - 0x80;

495 i‡(*
d°
 == 0x80) {

496 
ßm∂e
 = -sample;

497 *
sum
 = 
ßm∂e
;

499 *
sum
 = 
ßm∂e
 = *sum - sample;

500 i‡(
ßm∂e
 > 0x7f)

501 
ßm∂e
 = 0x7f;

502 i‡(
ßm∂e
 < -0x80)

503 
ßm∂e
 = -0x80;

505 *
d°
 = 
ßm∂e
 + 0x80;

506 i‡(!--
size
)

508 
d°
 +
d°_°ï
;

509 
§c
 +
§c_°ï
;

510 
sum
 = (sig√d *Ë((*)sum + 
sum_°ï
);

512 
	}
}

515 
	$gíîic_mix_£À˘_ˇŒbacks
(
¢d_pcm_dúe˘_t
 *
dmix
)

517 i‡(
	`¢d_pcm_f‹m©_˝u_ídün
(
dmix
->
shm±r
->
s
.
f‹m©
)) {

518 
dmix
->
u
.dmix.
mix_¨ós_16
 = 
gíîic_mix_¨ós_16_«tive
;

519 
dmix
->
u
.dmix.
mix_¨ós_32
 = 
gíîic_mix_¨ós_32_«tive
;

520 
dmix
->
u
.dmix.
ªmix_¨ós_16
 = 
gíîic_ªmix_¨ós_16_«tive
;

521 
dmix
->
u
.dmix.
ªmix_¨ós_32
 = 
gíîic_ªmix_¨ós_32_«tive
;

523 
dmix
->
u
.dmix.
mix_¨ós_16
 = 
gíîic_mix_¨ós_16_sw≠
;

524 
dmix
->
u
.dmix.
mix_¨ós_32
 = 
gíîic_mix_¨ós_32_sw≠
;

525 
dmix
->
u
.dmix.
ªmix_¨ós_16
 = 
gíîic_ªmix_¨ós_16_sw≠
;

526 
dmix
->
u
.dmix.
ªmix_¨ós_32
 = 
gíîic_ªmix_¨ós_32_sw≠
;

528 
dmix
->
u
.dmix.
mix_¨ós_24
 = 
gíîic_mix_¨ós_24
;

529 
dmix
->
u
.dmix.
mix_¨ós_u8
 = 
gíîic_mix_¨ós_u8
;

530 
dmix
->
u
.dmix.
ªmix_¨ós_24
 = 
gíîic_ªmix_¨ós_24
;

531 
dmix
->
u
.dmix.
ªmix_¨ós_u8
 = 
gíîic_ªmix_¨ós_u8
;

532 
dmix
->
u
.dmix.
u£_£m
 = 1;

533 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_i386.c

5 
	#MIX_AREAS_16
 
mix_¨ós_16


	)

6 
	#MIX_AREAS_16_MMX
 
mix_¨ós_16_mmx


	)

7 
	#MIX_AREAS_32
 
mix_¨ós_32


	)

8 
	#MIX_AREAS_24
 
mix_¨ós_24


	)

9 
	#MIX_AREAS_24_CMOV
 
mix_¨ós_24_cmov


	)

10 
	#LOCK_PREFIX
 ""

	)

11 
	#XADD
 "addl"

	)

12 
	#XSUB
 "subl"

	)

13 
	~"pcm_dmix_i386.h
"

14 #unde‡
MIX_AREAS_16


15 #unde‡
MIX_AREAS_16_MMX


16 #unde‡
MIX_AREAS_32


17 #unde‡
MIX_AREAS_24


18 #unde‡
MIX_AREAS_24_CMOV


19 #unde‡
LOCK_PREFIX


20 #unde‡
XADD


21 #unde‡
XSUB


23 
	#MIX_AREAS_16
 
ªmix_¨ós_16


	)

24 
	#MIX_AREAS_16_MMX
 
ªmix_¨ós_16_mmx


	)

25 
	#MIX_AREAS_32
 
ªmix_¨ós_32


	)

26 
	#MIX_AREAS_24
 
ªmix_¨ós_24


	)

27 
	#MIX_AREAS_24_CMOV
 
ªmix_¨ós_24_cmov


	)

28 
	#LOCK_PREFIX
 ""

	)

29 
	#XADD
 "subl"

	)

30 
	#XSUB
 "addl"

	)

31 
	~"pcm_dmix_i386.h
"

32 #unde‡
MIX_AREAS_16


33 #unde‡
MIX_AREAS_16_MMX


34 #unde‡
MIX_AREAS_32


35 #unde‡
MIX_AREAS_24


36 #unde‡
MIX_AREAS_24_CMOV


37 #unde‡
LOCK_PREFIX


38 #unde‡
XADD


39 #unde‡
XSUB


41 
	#MIX_AREAS_16
 
mix_¨ós_16_smp


	)

42 
	#MIX_AREAS_16_MMX
 
mix_¨ós_16_smp_mmx


	)

43 
	#MIX_AREAS_32
 
mix_¨ós_32_smp


	)

44 
	#MIX_AREAS_24
 
mix_¨ós_24_smp


	)

45 
	#MIX_AREAS_24_CMOV
 
mix_¨ós_24_smp_cmov


	)

46 
	#LOCK_PREFIX
 "lock ; "

	)

47 
	#XADD
 "addl"

	)

48 
	#XSUB
 "subl"

	)

49 
	~"pcm_dmix_i386.h
"

50 #unde‡
MIX_AREAS_16


51 #unde‡
MIX_AREAS_16_MMX


52 #unde‡
MIX_AREAS_32


53 #unde‡
MIX_AREAS_24


54 #unde‡
MIX_AREAS_24_CMOV


55 #unde‡
LOCK_PREFIX


56 #unde‡
XADD


57 #unde‡
XSUB


59 
	#MIX_AREAS_16
 
ªmix_¨ós_16_smp


	)

60 
	#MIX_AREAS_16_MMX
 
ªmix_¨ós_16_smp_mmx


	)

61 
	#MIX_AREAS_32
 
ªmix_¨ós_32_smp


	)

62 
	#MIX_AREAS_24
 
ªmix_¨ós_24_smp


	)

63 
	#MIX_AREAS_24_CMOV
 
ªmix_¨ós_24_smp_cmov


	)

64 
	#LOCK_PREFIX
 "lock ; "

	)

65 
	#XADD
 "subl"

	)

66 
	#XSUB
 "addl"

	)

67 
	~"pcm_dmix_i386.h
"

68 #unde‡
MIX_AREAS_16


69 #unde‡
MIX_AREAS_16_MMX


70 #unde‡
MIX_AREAS_32


71 #unde‡
MIX_AREAS_24


72 #unde‡
MIX_AREAS_24_CMOV


73 #unde‡
LOCK_PREFIX


74 #unde‡
XADD


75 #unde‡
XSUB


77 
	#i386_dmix_suµ‹ãd_f‹m©
 \

78 ((1ULL << 
SND_PCM_FORMAT_S16_LE
) |\

79 (1ULL << 
SND_PCM_FORMAT_S32_LE
) |\

80 (1ULL << 
SND_PCM_FORMAT_S24_LE
) |\

81 (1ULL << 
SND_PCM_FORMAT_S24_3LE
))

	)

83 
	#dmix_suµ‹ãd_f‹m©
 \

84 (
i386_dmix_suµ‹ãd_f‹m©
 | 
gíîic_dmix_suµ‹ãd_f‹m©
)

	)

86 
	$mix_£À˘_ˇŒbacks
(
¢d_pcm_dúe˘_t
 *
dmix
)

88 
smp
 = 0, 
mmx
 = 0, 
cmov
 = 0;

90 i‡(!
dmix
->
dúe˘_mem‹y_ac˚ss
) {

91 
	`gíîic_mix_£À˘_ˇŒbacks
(
dmix
);

95 i‡(!((1ULL<< 
dmix
->
shm±r
->
s
.
f‹m©
Ë& 
i386_dmix_suµ‹ãd_f‹m©
)) {

96 
	`gíîic_mix_£À˘_ˇŒbacks
(
dmix
);

100 i‡(!
smp
) {

101 
FILE
 *
ö
;

102 
löe
[255];

105 
ö
 = 
	`f›í
("/proc/cpuinfo", "r");

106 i‡(
ö
) {

107 !
	`„of
(
ö
Ë&& (
	`fgës
(
löe
, ÷öe), inË!
NULL
)) {

108 i‡(!
	`°∫cmp
(
löe
, "processor", 9))

109 
smp
++;

110 i‡(!
	`°∫cmp
(
löe
, "flags", 5)) {

111 i‡(
	`°r°r
(
löe
, " mmx"))

112 
mmx
 = 1;

113 i‡(
	`°r°r
(
löe
, " cmov"))

114 
cmov
 = 1;

117 
	`f˛o£
(
ö
);

121 i‡(
mmx
) {

122 
dmix
->
u
.dmix.
mix_¨ós_16
 = 
smp
 > 1 ? 
mix_¨ós_16_smp_mmx
 : 
mix_¨ós_16_mmx
;

123 
dmix
->
u
.dmix.
ªmix_¨ós_16
 = 
smp
 > 1 ? 
ªmix_¨ós_16_smp_mmx
 : 
ªmix_¨ós_16_mmx
;

125 
dmix
->
u
.dmix.
mix_¨ós_16
 = 
smp
 > 1 ? 
mix_¨ós_16_smp
 : mix_areas_16;

126 
dmix
->
u
.dmix.
ªmix_¨ós_16
 = 
smp
 > 1 ? 
ªmix_¨ós_16_smp
 :Ñemix_areas_16;

128 
dmix
->
u
.dmix.
mix_¨ós_32
 = 
smp
 > 1 ? 
mix_¨ós_32_smp
 : mix_areas_32;

129 
dmix
->
u
.dmix.
ªmix_¨ós_32
 = 
smp
 > 1 ? 
ªmix_¨ós_32_smp
 :Ñemix_areas_32;

130 i‡(
cmov
) {

131 
dmix
->
u
.dmix.
mix_¨ós_24
 = 
smp
 > 1 ? 
mix_¨ós_24_smp_cmov
 : 
mix_¨ós_24_cmov
;

132 
dmix
->
u
.dmix.
ªmix_¨ós_24
 = 
smp
 > 1 ? 
ªmix_¨ós_24_smp_cmov
 : 
ªmix_¨ós_24_cmov
;

134 
dmix
->
u
.dmix.
mix_¨ós_24
 = 
smp
 > 1 ? 
mix_¨ós_24_smp
: mix_areas_24;

135 
dmix
->
u
.dmix.
ªmix_¨ós_24
 = 
smp
 > 1 ? 
ªmix_¨ós_24_smp
:Ñemix_areas_24;

137 
dmix
->
u
.dmix.
u£_£m
 = 0;

138 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_i386.h

29 #i‡
deföed
(
__GNUC__
Ë&& __GNUC__ < 5 && deföed(
__PIC__
)

30 
	#BOUNDED_EBX


	)

36 
	$MIX_AREAS_16
(
size
,

37 vﬁ©ûêsig√d *
d°
, sig√d *
§c
,

38 vﬁ©ûêsig√d *
sum
, 
size_t
 
d°_°ï
,

39 
size_t
 
§c_°ï
, size_à
sum_°ï
)

41 #ifde‡
BOUNDED_EBX


42 
ﬁd_ebx
;

52 
__asm__
 
	`__vﬁ©ûe__
 (

54 #ifde‡
BOUNDED_EBX


89 "\t" 
LOCK_PREFIX
 "cmpxchgw %%cx, (%%edi)\n"

92 "\t" 
XSUB
 " %%edx, %%ecx\n"

94 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%ebx)\n"

149 #ifde‡
BOUNDED_EBX


152 : [
size
] "+&rm" (size)

153 #ifde‡
BOUNDED_EBX


154 , [
ﬁd_ebx
] "=m" (old_ebx)

156 : [
d°
] "m" (d°), [
§c
] "m" (§c), [
sum
] "m" (sum),

157 [
d°_°ï
] "im" (d°_°ï), [
§c_°ï
] "im" (src_step),

158 [
sum_°ï
] "im" (sum_step)

160 #i‚de‡
BOUNDED_EBX


164 
	}
}

169 
	$MIX_AREAS_16_MMX
(
size
,

170 vﬁ©ûêsig√d *
d°
, sig√d *
§c
,

171 vﬁ©ûêsig√d *
sum
, 
size_t
 
d°_°ï
,

172 
size_t
 
§c_°ï
, size_à
sum_°ï
)

174 #ifde‡
BOUNDED_EBX


175 
ﬁd_ebx
;

185 
__asm__
 
	`__vﬁ©ûe__
 (

187 #ifde‡
BOUNDED_EBX


217 "\t" 
LOCK_PREFIX
 "cmpxchgw %%cx, (%%edi)\n"

220 "\t" 
XSUB
 " %%edx, %%ecx\n"

222 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%ebx)\n"

248 #ifde‡
BOUNDED_EBX


251 : [
size
] "+&rm" (size)

252 #ifde‡
BOUNDED_EBX


253 , [
ﬁd_ebx
] "=m" (old_ebx)

255 : [
d°
] "m" (d°), [
§c
] "m" (§c), [
sum
] "m" (sum),

256 [
d°_°ï
] "im" (d°_°ï), [
§c_°ï
] "im" (src_step),

257 [
sum_°ï
] "im" (sum_step)

259 #i‚de‡
BOUNDED_EBX


262 #ifde‡
HAVE_MMX


269 
	}
}

274 
	$MIX_AREAS_32
(
size
,

275 vﬁ©ûêsig√d *
d°
, sig√d *
§c
,

276 vﬁ©ûêsig√d *
sum
, 
size_t
 
d°_°ï
,

277 
size_t
 
§c_°ï
, size_à
sum_°ï
)

279 #ifde‡
BOUNDED_EBX


280 
ﬁd_ebx
;

290 
__asm__
 
	`__vﬁ©ûe__
 (

292 #ifde‡
BOUNDED_EBX


319 "\t" 
LOCK_PREFIX
 "cmpxchgl %%ecx, (%%edi)\n"

324 "\t" 
XSUB
 " %%edx, %%ecx\n"

331 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%ebx)\n"

376 #ifde‡
BOUNDED_EBX


379 : [
size
] "+&rm" (size)

380 #ifde‡
BOUNDED_EBX


381 , [
ﬁd_ebx
] "=m" (old_ebx)

383 : [
d°
] "m" (d°), [
§c
] "m" (§c), [
sum
] "m" (sum),

384 [
d°_°ï
] "im" (d°_°ï), [
§c_°ï
] "im" (src_step),

385 [
sum_°ï
] "im" (sum_step)

387 #i‚de‡
BOUNDED_EBX


391 
	}
}

396 
	$MIX_AREAS_24
(
size
,

397 vﬁ©ûê*
d°
, *
§c
,

398 vﬁ©ûêsig√d *
sum
, 
size_t
 
d°_°ï
,

399 
size_t
 
§c_°ï
, size_à
sum_°ï
)

401 #ifde‡
BOUNDED_EBX


402 
ﬁd_ebx
;

412 
__asm__
 
	`__vﬁ©ûe__
 (

414 #ifde‡
BOUNDED_EBX


443 "\t" 
LOCK_PREFIX
 "btsw $0, (%%edi)\n"

445 "\t" 
XSUB
 " %%edx, %%ecx\n"

447 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%ebx)\n"

491 #ifde‡
BOUNDED_EBX


494 : [
size
] "+&rm" (size)

495 #ifde‡
BOUNDED_EBX


496 , [
ﬁd_ebx
] "=m" (old_ebx)

498 : [
d°
] "m" (d°), [
§c
] "m" (§c), [
sum
] "m" (sum),

499 [
d°_°ï
] "im" (d°_°ï), [
§c_°ï
] "im" (src_step),

500 [
sum_°ï
] "im" (sum_step)

502 #i‚de‡
BOUNDED_EBX


506 
	}
}

511 
	$MIX_AREAS_24_CMOV
(
size
,

512 vﬁ©ûê*
d°
, *
§c
,

513 vﬁ©ûêsig√d *
sum
, 
size_t
 
d°_°ï
,

514 
size_t
 
§c_°ï
, size_à
sum_°ï
)

516 #ifde‡
BOUNDED_EBX


517 
ﬁd_ebx
;

527 
__asm__
 
	`__vﬁ©ûe__
 (

529 #ifde‡
BOUNDED_EBX


556 "\t" 
LOCK_PREFIX
 "btsw $0, (%%edi)\n"

559 "\t" 
XSUB
 " %%edx, %%ecx\n"

561 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%ebx)\n"

599 #ifde‡
BOUNDED_EBX


602 : [
size
] "+&rm" (size)

603 #ifde‡
BOUNDED_EBX


604 , [
ﬁd_ebx
] "=m" (old_ebx)

606 : [
d°
] "m" (d°), [
§c
] "m" (§c), [
sum
] "m" (sum),

607 [
d°_°ï
] "im" (d°_°ï), [
§c_°ï
] "im" (src_step),

608 [
sum_°ï
] "im" (sum_step)

610 #i‚de‡
BOUNDED_EBX


614 
	}
}

616 #ifde‡
BOUNDED_EBX


617 #unde‡
BOUNDED_EBX


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_x86_64.c

5 
	#MIX_AREAS_16
 
mix_¨ós_16


	)

6 
	#MIX_AREAS_32
 
mix_¨ós_32


	)

7 
	#MIX_AREAS_24
 
mix_¨ós_24


	)

8 
	#LOCK_PREFIX
 ""

	)

9 
	#XADD
 "addl"

	)

10 
	#XSUB
 "subl"

	)

11 
	~"pcm_dmix_x86_64.h
"

12 #unde‡
MIX_AREAS_16


13 #unde‡
MIX_AREAS_32


14 #unde‡
MIX_AREAS_24


15 #unde‡
LOCK_PREFIX


16 #unde‡
XADD


17 #unde‡
XSUB


19 
	#MIX_AREAS_16
 
ªmix_¨ós_16


	)

20 
	#MIX_AREAS_32
 
ªmix_¨ós_32


	)

21 
	#MIX_AREAS_24
 
ªmix_¨ós_24


	)

22 
	#LOCK_PREFIX
 ""

	)

23 
	#XADD
 "subl"

	)

24 
	#XSUB
 "addl"

	)

25 
	~"pcm_dmix_x86_64.h
"

26 #unde‡
MIX_AREAS_16


27 #unde‡
MIX_AREAS_32


28 #unde‡
MIX_AREAS_24


29 #unde‡
LOCK_PREFIX


30 #unde‡
XADD


31 #unde‡
XSUB


33 
	#MIX_AREAS_16
 
mix_¨ós_16_smp


	)

34 
	#MIX_AREAS_32
 
mix_¨ós_32_smp


	)

35 
	#MIX_AREAS_24
 
mix_¨ós_24_smp


	)

36 
	#LOCK_PREFIX
 "lock ; "

	)

37 
	#XADD
 "addl"

	)

38 
	#XSUB
 "subl"

	)

39 
	~"pcm_dmix_x86_64.h
"

40 #unde‡
MIX_AREAS_16


41 #unde‡
MIX_AREAS_32


42 #unde‡
MIX_AREAS_24


43 #unde‡
LOCK_PREFIX


44 #unde‡
XADD


45 #unde‡
XSUB


47 
	#MIX_AREAS_16
 
ªmix_¨ós_16_smp


	)

48 
	#MIX_AREAS_32
 
ªmix_¨ós_32_smp


	)

49 
	#MIX_AREAS_24
 
ªmix_¨ós_24_smp


	)

50 
	#LOCK_PREFIX
 "lock ; "

	)

51 
	#XADD
 "subl"

	)

52 
	#XSUB
 "addl"

	)

53 
	~"pcm_dmix_x86_64.h
"

54 #unde‡
MIX_AREAS_16


55 #unde‡
MIX_AREAS_32


56 #unde‡
MIX_AREAS_24


57 #unde‡
LOCK_PREFIX


58 #unde‡
XADD


59 #unde‡
XSUB


61 
	#x86_64_dmix_suµ‹ãd_f‹m©
 \

62 ((1ULL << 
SND_PCM_FORMAT_S16_LE
) |\

63 (1ULL << 
SND_PCM_FORMAT_S32_LE
) |\

64 (1ULL << 
SND_PCM_FORMAT_S24_3LE
))

	)

66 
	#dmix_suµ‹ãd_f‹m©
 \

67 (
x86_64_dmix_suµ‹ãd_f‹m©
 | 
gíîic_dmix_suµ‹ãd_f‹m©
)

	)

69 
	$mix_£À˘_ˇŒbacks
(
¢d_pcm_dúe˘_t
 *
dmix
)

71 
smp
 = 0;

73 i‡(!
dmix
->
dúe˘_mem‹y_ac˚ss
) {

74 
	`gíîic_mix_£À˘_ˇŒbacks
(
dmix
);

78 i‡(!((1ULL<< 
dmix
->
shm±r
->
s
.
f‹m©
Ë& 
x86_64_dmix_suµ‹ãd_f‹m©
)) {

79 
	`gíîic_mix_£À˘_ˇŒbacks
(
dmix
);

83 i‡(!
smp
) {

84 
FILE
 *
ö
;

85 
löe
[255];

88 
ö
 = 
	`f›í
("/proc/cpuinfo", "r");

89 i‡(
ö
) {

90 !
	`„of
(
ö
Ë&& (
	`fgës
(
löe
, ÷öe), inË!
NULL
)) {

91 i‡(!
	`°∫cmp
(
löe
, "processor", 9))

92 
smp
++;

94 
	`f˛o£
(
ö
);

98 
dmix
->
u
.dmix.
mix_¨ós_16
 = 
smp
 > 1 ? 
mix_¨ós_16_smp
 : mix_areas_16;

99 
dmix
->
u
.dmix.
ªmix_¨ós_16
 = 
smp
 > 1 ? 
ªmix_¨ós_16_smp
 :Ñemix_areas_16;

100 
dmix
->
u
.dmix.
mix_¨ós_32
 = 
smp
 > 1 ? 
mix_¨ós_32_smp
 : mix_areas_32;

101 
dmix
->
u
.dmix.
ªmix_¨ós_32
 = 
smp
 > 1 ? 
ªmix_¨ós_32_smp
 :Ñemix_areas_32;

102 
dmix
->
u
.dmix.
mix_¨ós_24
 = 
smp
 > 1 ? 
mix_¨ós_24_smp
 : mix_areas_24;

103 
dmix
->
u
.dmix.
ªmix_¨ós_24
 = 
smp
 > 1 ? 
ªmix_¨ós_24_smp
 :Ñemix_areas_24;

104 
dmix
->
u
.dmix.
u£_£m
 = 0;

105 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_x86_64.h

30 #i‡
deföed
(
__GNUC__
Ë&& __GNUC__ < 5 && deföed(
__PIC__
)

31 
	#BOUNDED_RBX


	)

37 
	$MIX_AREAS_16
(
size
,

38 vﬁ©ûêsig√d *
d°
, sig√d *
§c
,

39 vﬁ©ûêsig√d *
sum
, 
size_t
 
d°_°ï
,

40 
size_t
 
§c_°ï
, size_à
sum_°ï
)

42 #ifde‡
BOUNDED_RBX


43 
ﬁd_rbx
;

53 
__asm__
 
	`__vﬁ©ûe__
 (

55 #ifde‡
BOUNDED_RBX


61 #i‚de‡
_ILP32


91 "\t" 
LOCK_PREFIX
 "cmpxchgw %%cx, (%%rdi)\n"

94 "\t" 
XSUB
 " %%edx, %%ecx\n"

96 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%rbx)\n"

118 #i‚de‡
_ILP32


133 #ifde‡
BOUNDED_RBX


136 : [
size
] "+&rm" (size)

137 #ifde‡
BOUNDED_RBX


138 , [
ﬁd_rbx
] "=m" (old_rbx)

140 : [
d°
] "m" (d°), [
§c
] "m" (§c), [
sum
] "m" (sum),

141 [
d°_°ï
] "im" (d°_°ï), [
§c_°ï
] "im" (src_step),

142 [
sum_°ï
] "im" (sum_step)

144 #i‚de‡
BOUNDED_RBX


147 #ifde‡
HAVE_MMX


154 
	}
}

159 
	$MIX_AREAS_32
(
size
,

160 vﬁ©ûêsig√d *
d°
, sig√d *
§c
,

161 vﬁ©ûêsig√d *
sum
, 
size_t
 
d°_°ï
,

162 
size_t
 
§c_°ï
, size_à
sum_°ï
)

164 #ifde‡
BOUNDED_RBX


165 
ﬁd_rbx
;

175 
__asm__
 
	`__vﬁ©ûe__
 (

177 #ifde‡
BOUNDED_RBX


183 #i‚de‡
_ILP32


213 "\t" 
LOCK_PREFIX
 "cmpxchgl %%ecx, (%%rdi)\n"

218 "\t" 
XSUB
 " %%edx, %%ecx\n"

225 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%rbx)\n"

262 #i‚de‡
_ILP32


275 #ifde‡
BOUNDED_RBX


278 : [
size
] "+&rm" (size)

279 #ifde‡
BOUNDED_RBX


280 , [
ﬁd_rbx
] "=m" (old_rbx)

282 : [
d°
] "m" (d°), [
§c
] "m" (§c), [
sum
] "m" (sum),

283 [
d°_°ï
] "im" (d°_°ï), [
§c_°ï
] "im" (src_step),

284 [
sum_°ï
] "im" (sum_step)

286 #i‚de‡
BOUNDED_RBX


290 
	}
}

295 
	$MIX_AREAS_24
(
size
,

296 vﬁ©ûê*
d°
, *
§c
,

297 vﬁ©ûêsig√d *
sum
, 
size_t
 
d°_°ï
,

298 
size_t
 
§c_°ï
, size_à
sum_°ï
)

300 #ifde‡
BOUNDED_RBX


301 
ﬁd_rbx
;

311 
__asm__
 
	`__vﬁ©ûe__
 (

313 #ifde‡
BOUNDED_RBX


319 #i‚de‡
_ILP32


351 "\t" 
LOCK_PREFIX
 "btsw $0, (%%rdi)\n"

353 "\t" 
XSUB
 " %%edx, %%ecx\n"

355 "\t" 
LOCK_PREFIX
 
XADD
 " %%ecx, (%%rbx)\n"

386 #i‚de‡
_ILP32


399 #ifde‡
BOUNDED_RBX


402 : [
size
] "+&rm" (size)

403 #ifde‡
BOUNDED_RBX


404 , [
ﬁd_rbx
] "=m" (old_rbx)

406 : [
d°
] "m" (d°), [
§c
] "m" (§c), [
sum
] "m" (sum),

407 [
d°_°ï
] "im" (d°_°ï), [
§c_°ï
] "im" (src_step),

408 [
sum_°ï
] "im" (sum_step)

410 #i‚de‡
BOUNDED_RBX


414 
	}
}

416 #ifde‡
BOUNDED_RBX


417 #unde‡
BOUNDED_RBX


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dshare.c

29 
	~"pcm_loˇl.h
"

30 
	~<°dio.h
>

31 
	~<°dlib.h
>

32 
	~<°ddef.h
>

33 
	~<uni°d.h
>

34 
	~<sig«l.h
>

35 
	~<°rög.h
>

36 
	~<f˙é.h
>

37 
	~<˘y≥.h
>

38 
	~<gΩ.h
>

39 
	~<sys/io˘l.h
>

40 
	~<sys/mm™.h
>

41 
	~<sys/shm.h
>

42 
	~<sys/£m.h
>

43 
	~<sys/waô.h
>

44 
	~<sys/sockë.h
>

45 
	~<sys/un.h
>

46 
	~<sys/mm™.h
>

47 
	~"pcm_dúe˘.h
"

49 #i‚de‡
PIC


51 c⁄° *
	g_¢d_moduÀ_pcm_dsh¨e
 = "";

54 #i‚de‡
DOC_HIDDEN


56 
	#STATE_RUN_PENDING
 1024

	)

59 
	$do_sûí˚
(
¢d_pcm_t
 *
pcm
)

61 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

62 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
;

63 
chn
, 
dchn
, 
ch™√ls
;

64 
¢d_pcm_f‹m©_t
 
f‹m©
;

66 
d°_¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
dsh¨e
->
•cm
);

67 
ch™√ls
 = 
dsh¨e
->channels;

68 
f‹m©
 = 
dsh¨e
->
shm±r
->
s
.format;

69 
chn
 = 0; ch¿< 
ch™√ls
; chn++) {

70 
dchn
 = 
dsh¨e
->
bödögs
 ? dsh¨e->bödögs[
chn
] : chn;

71 i‡(
dchn
 !
UINT_MAX
)

72 
	`¢d_pcm_¨ó_sûí˚
(&
d°_¨ós
[
dchn
], 0,

73 
dsh¨e
->
shm±r
->
s
.
buf„r_size
, 
f‹m©
);

75 
	}
}

77 
	$sh¨e_¨ós
(
¢d_pcm_dúe˘_t
 *
dsh¨e
,

78 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

79 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

80 
¢d_pcm_u‰ames_t
 
§c_ofs
,

81 
¢d_pcm_u‰ames_t
 
d°_ofs
,

82 
¢d_pcm_u‰ames_t
 
size
)

84 
chn
, 
dchn
, 
ch™√ls
;

85 
¢d_pcm_f‹m©_t
 
f‹m©
;

87 
ch™√ls
 = 
dsh¨e
->channels;

88 
f‹m©
 = 
dsh¨e
->
shm±r
->
s
.format;

89 i‡(
dsh¨e
->
öãæóved
) {

90 
fbyãs
 = 
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
) / 8;

91 
	`mem˝y
(((*)
d°_¨ós
[0].
addr
Ë+ (
d°_ofs
 * 
ch™√ls
 * 
fbyãs
),

92 ((*)
§c_¨ós
[0].
addr
Ë+ (
§c_ofs
 * 
ch™√ls
 * 
fbyãs
),

93 
size
 * 
ch™√ls
 * 
fbyãs
);

95 
chn
 = 0; ch¿< 
ch™√ls
; chn++) {

96 
dchn
 = 
dsh¨e
->
bödögs
 ? dsh¨e->bödögs[
chn
] : chn;

97 i‡(
dchn
 !
UINT_MAX
)

98 
	`¢d_pcm_¨ó_c›y
(&
d°_¨ós
[
dchn
], 
d°_ofs
,

99 &
§c_¨ós
[
chn
], 
§c_ofs
, 
size
, 
f‹m©
);

103 
	}
}

108 
	$¢d_pcm_dsh¨e_sync_¨ó
(
¢d_pcm_t
 *
pcm
)

110 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

111 
¢d_pcm_u‰ames_t
 
¶ave_hw_±r
, 
¶ave_≠∂_±r
, 
¶ave_size
;

112 
¢d_pcm_u‰ames_t
 
≠∂_±r
, 
size
;

113 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
, *
d°_¨ós
;

116 
size
 = 
	`pcm_‰ame_diff
(
dsh¨e
->
≠∂_±r
, dsh¨e->
œ°_≠∂_±r
, 
pcm
->
bound¨y
);

117 i‡(! 
size
)

119 
¶ave_hw_±r
 = 
dsh¨e
->slave_hw_ptr;

123 
¶ave_hw_±r
 -¶ave_hw_±∏% 
dsh¨e
->
¶ave_≥riod_size
;

124 
¶ave_hw_±r
 +
dsh¨e
->
¶ave_buf„r_size
;

125 i‡(
¶ave_hw_±r
 >
dsh¨e
->
¶ave_bound¨y
)

126 
¶ave_hw_±r
 -
dsh¨e
->
¶ave_bound¨y
;

127 
¶ave_size
 = 
	`pcm_‰ame_diff
(
¶ave_hw_±r
, 
dsh¨e
->
¶ave_≠∂_±r
, dsh¨e->
¶ave_bound¨y
);

128 i‡(
¶ave_size
 < 
size
)

129 
size
 = 
¶ave_size
;

130 i‡(! 
size
)

134 
§c_¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

135 
d°_¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
dsh¨e
->
•cm
);

136 
≠∂_±r
 = 
dsh¨e
->
œ°_≠∂_±r
 % 
pcm
->
buf„r_size
;

137 
dsh¨e
->
œ°_≠∂_±r
 +
size
;

138 
dsh¨e
->
œ°_≠∂_±r
 %
pcm
->
bound¨y
;

139 
¶ave_≠∂_±r
 = 
dsh¨e
->¶ave_≠∂_±∏% dsh¨e->
¶ave_buf„r_size
;

140 
dsh¨e
->
¶ave_≠∂_±r
 +
size
;

141 
dsh¨e
->
¶ave_≠∂_±r
 %dsh¨e->
¶ave_bound¨y
;

143 
¢d_pcm_u‰ames_t
 
å™s„r
 = 
size
;

144 i‡(
≠∂_±r
 + 
å™s„r
 > 
pcm
->
buf„r_size
)

145 
å™s„r
 = 
pcm
->
buf„r_size
 - 
≠∂_±r
;

146 i‡(
¶ave_≠∂_±r
 + 
å™s„r
 > 
dsh¨e
->
¶ave_buf„r_size
)

147 
å™s„r
 = 
dsh¨e
->
¶ave_buf„r_size
 - 
¶ave_≠∂_±r
;

148 
	`sh¨e_¨ós
(
dsh¨e
, 
§c_¨ós
, 
d°_¨ós
, 
≠∂_±r
, 
¶ave_≠∂_±r
, 
å™s„r
);

149 
size
 -
å™s„r
;

150 i‡(! 
size
)

152 
¶ave_≠∂_±r
 +
å™s„r
;

153 
¶ave_≠∂_±r
 %
dsh¨e
->
¶ave_buf„r_size
;

154 
≠∂_±r
 +
å™s„r
;

155 
≠∂_±r
 %
pcm
->
buf„r_size
;

157 
	}
}

162 
	$¢d_pcm_dsh¨e_sync_±r0
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
¶ave_hw_±r
)

164 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

165 
¢d_pcm_u‰ames_t
 
ﬁd_¶ave_hw_±r
, 
avaû
;

166 
¢d_pcm_s‰ames_t
 
diff
;

168 
ﬁd_¶ave_hw_±r
 = 
dsh¨e
->
¶ave_hw_±r
;

169 
dsh¨e
->
¶ave_hw_±r
 = slave_hw_ptr;

170 
diff
 = 
	`pcm_‰ame_diff
(
¶ave_hw_±r
, 
ﬁd_¶ave_hw_±r
, 
dsh¨e
->
¶ave_bound¨y
);

171 i‡(
diff
 == 0)

173 i‡(
dsh¨e
->
°©e
 !
SND_PCM_STATE_RUNNING
 &&

174 
dsh¨e
->
°©e
 !
SND_PCM_STATE_DRAINING
)

177 
dsh¨e
->
hw_±r
 +
diff
;

178 
dsh¨e
->
hw_±r
 %
pcm
->
bound¨y
;

180 i‡(
pcm
->
°›_thªshﬁd
 >pcm->
bound¨y
)

182 
avaû
 = 
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
);

183 i‡(
avaû
 > 
dsh¨e
->
avaû_max
)

184 
dsh¨e
->
avaû_max
 = 
avaû
;

185 i‡(
avaû
 >
pcm
->
°›_thªshﬁd
) {

186 
	`¢d_timî_°›
(
dsh¨e
->
timî
);

187 
	`do_sûí˚
(
pcm
);

188 
	`gëtime°amp
(&
dsh¨e
->
åiggî_t°amp
, 
pcm
->
t°amp_ty≥
);

189 i‡(
dsh¨e
->
°©e
 =
SND_PCM_STATE_RUNNING
) {

190 
dsh¨e
->
°©e
 = 
SND_PCM_STATE_XRUN
;

191  -
EPIPE
;

193 
dsh¨e
->
°©e
 = 
SND_PCM_STATE_SETUP
;

195 
	`¢d_pcm_dúe˘_˛ór_timî_queue
(
dsh¨e
);

198 
	}
}

200 
	$¢d_pcm_dsh¨e_sync_±r
(
¢d_pcm_t
 *
pcm
)

202 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

203 
¢d_pcm_u‰ames_t
 
¶ave_hw_±r
;

204 
îr
;

206 i‡(
dsh¨e
->
¶ow±r
)

207 
	`¢d_pcm_hwsync
(
dsh¨e
->
•cm
);

208 
¶ave_hw_±r
 = *
dsh¨e
->
•cm
->
hw
.
±r
;

209 
îr
 = 
	`¢d_pcm_dúe˘_check_xrun
(
dsh¨e
, 
pcm
);

210 i‡(
îr
 < 0)

211  
îr
;

213  
	`¢d_pcm_dsh¨e_sync_±r0
(
pcm
, 
¶ave_hw_±r
);

214 
	}
}

220 
¢d_pcm_°©e_t
 
¢d_pcm_dsh¨e_°©e
(
¢d_pcm_t
 *
pcm
);

222 
	$¢d_pcm_dsh¨e_°©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©us_t
 * 
°©us
)

224 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

226 
	`mem£t
(
°©us
, 0, (*status));

227 
	`¢d_pcm_°©us
(
dsh¨e
->
•cm
, 
°©us
);

229 
dsh¨e
->
°©e
) {

230 
SNDRV_PCM_STATE_DRAINING
:

231 
SNDRV_PCM_STATE_RUNNING
:

232 
	`¢d_pcm_dsh¨e_sync_±r0
(
pcm
, 
°©us
->
hw_±r
);

233 
°©us
->
dñay
 = 
	`¢d_pcm_mm≠_∂ayback_dñay
(
pcm
);

238 
°©us
->
°©e
 = 
	`¢d_pcm_dsh¨e_°©e
(
pcm
);

239 
°©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

240 
°©us
->
≠∂_±r
 = *
pcm
->
≠∂
.
±r
;

241 
°©us
->
åiggî_t°amp
 = 
dsh¨e
->trigger_tstamp;

242 
°©us
->
avaû
 = 
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
);

243 
°©us
->
avaû_max
 = sètus->
avaû
 > 
dsh¨e
->avail_max ? status->avail : dshare->avail_max;

244 
dsh¨e
->
avaû_max
 = 0;

246 
	}
}

248 
¢d_pcm_°©e_t
 
	$¢d_pcm_dsh¨e_°©e
(
¢d_pcm_t
 *
pcm
)

250 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

252 
	`¢d_pcm_dúe˘_check_xrun
(
dsh¨e
, 
pcm
);

253 i‡(
dsh¨e
->
°©e
 =
STATE_RUN_PENDING
)

254  
SNDRV_PCM_STATE_RUNNING
;

255  
dsh¨e
->
°©e
;

256 
	}
}

258 
	$¢d_pcm_dsh¨e_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
)

260 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

261 
îr
;

263 
dsh¨e
->
°©e
) {

264 
SNDRV_PCM_STATE_DRAINING
:

265 
SNDRV_PCM_STATE_RUNNING
:

266 
îr
 = 
	`¢d_pcm_dsh¨e_sync_±r
(
pcm
);

267 i‡(
îr
 < 0)

268  
îr
;

270 
SNDRV_PCM_STATE_PREPARED
:

271 
SNDRV_PCM_STATE_SUSPENDED
:

272 
STATE_RUN_PENDING
:

273 *
dñayp
 = 
	`¢d_pcm_mm≠_∂ayback_dñay
(
pcm
);

275 
SNDRV_PCM_STATE_XRUN
:

276  -
EPIPE
;

277 
SNDRV_PCM_STATE_DISCONNECTED
:

278  -
ENODEV
;

280  -
EBADFD
;

282 
	}
}

284 
	$¢d_pcm_dsh¨e_hwsync
(
¢d_pcm_t
 *
pcm
)

286 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

288 
dsh¨e
->
°©e
) {

289 
SNDRV_PCM_STATE_DRAINING
:

290 
SNDRV_PCM_STATE_RUNNING
:

291  
	`¢d_pcm_dsh¨e_sync_±r
(
pcm
);

292 
SNDRV_PCM_STATE_PREPARED
:

293 
SNDRV_PCM_STATE_SUSPENDED
:

295 
SNDRV_PCM_STATE_XRUN
:

296  -
EPIPE
;

297 
SNDRV_PCM_STATE_DISCONNECTED
:

298  -
ENODEV
;

300  -
EBADFD
;

302 
	}
}

304 
	$¢d_pcm_dsh¨e_ª£t
(
¢d_pcm_t
 *
pcm
)

306 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

307 
dsh¨e
->
hw_±r
 %
pcm
->
≥riod_size
;

308 
dsh¨e
->
≠∂_±r
 = dsh¨e->
œ°_≠∂_±r
 = dsh¨e->
hw_±r
;

309 
	`¢d_pcm_dúe˘_ª£t_¶ave_±r
(
pcm
, 
dsh¨e
, *dsh¨e->
•cm
->
hw
.
±r
);

311 
	}
}

313 
	$¢d_pcm_dsh¨e_°¨t_timî
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_dúe˘_t
 *
dsh¨e
)

315 
îr
;

317 
	`¢d_pcm_hwsync
(
dsh¨e
->
•cm
);

318 
	`¢d_pcm_dúe˘_ª£t_¶ave_±r
(
pcm
, 
dsh¨e
, *dsh¨e->
•cm
->
hw
.
±r
);

319 
îr
 = 
	`¢d_timî_°¨t
(
dsh¨e
->
timî
);

320 i‡(
îr
 < 0)

321  
îr
;

322 
dsh¨e
->
°©e
 = 
SND_PCM_STATE_RUNNING
;

324 
	}
}

326 
	$¢d_pcm_dsh¨e_°¨t
(
¢d_pcm_t
 *
pcm
)

328 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

329 
¢d_pcm_s‰ames_t
 
avaû
;

330 
îr
;

332 i‡(
dsh¨e
->
°©e
 !
SND_PCM_STATE_PREPARED
)

333  -
EBADFD
;

334 
avaû
 = 
	`¢d_pcm_mm≠_∂ayback_hw_avaû
(
pcm
);

335 i‡(
avaû
 == 0)

336 
dsh¨e
->
°©e
 = 
STATE_RUN_PENDING
;

337 i‡(
avaû
 < 0)

340 
îr
 = 
	`¢d_pcm_dsh¨e_°¨t_timî
(
pcm
, 
dsh¨e
);

341 i‡(
îr
 < 0)

342  
îr
;

343 
	`¢d_pcm_dsh¨e_sync_¨ó
(
pcm
);

345 
	`gëtime°amp
(&
dsh¨e
->
åiggî_t°amp
, 
pcm
->
t°amp_ty≥
);

347 
	}
}

349 
	$¢d_pcm_dsh¨e_dr›
(
¢d_pcm_t
 *
pcm
)

351 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

352 i‡(
dsh¨e
->
°©e
 =
SND_PCM_STATE_OPEN
)

353  -
EBADFD
;

354 
dsh¨e
->
°©e
 = 
SND_PCM_STATE_SETUP
;

355 
	`¢d_pcm_dúe˘_timî_°›
(
dsh¨e
);

356 
	`do_sûí˚
(
pcm
);

358 
	}
}

361 
	$__¢d_pcm_dsh¨e_døö
(
¢d_pcm_t
 *
pcm
)

363 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

364 
¢d_pcm_u‰ames_t
 
°›_thªshﬁd
;

365 
îr
;

367 
	`¢d_pcm_°©e
(
dsh¨e
->
•cm
)) {

368 
SND_PCM_STATE_SUSPENDED
:

369  -
ESTRPIPE
;

374 i‡(
dsh¨e
->
°©e
 =
SND_PCM_STATE_OPEN
)

375  -
EBADFD
;

376 i‡(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
)

377  -
EAGAIN
;

378 i‡(
dsh¨e
->
°©e
 =
SND_PCM_STATE_PREPARED
) {

379 i‡(
	`¢d_pcm_mm≠_∂ayback_hw_avaû
(
pcm
) > 0)

380 
	`¢d_pcm_dsh¨e_°¨t
(
pcm
);

382 
	`¢d_pcm_dsh¨e_dr›
(
pcm
);

387 i‡(
dsh¨e
->
°©e
 =
SND_PCM_STATE_XRUN
) {

388 
	`¢d_pcm_dsh¨e_dr›
(
pcm
);

392 
°›_thªshﬁd
 = 
pcm
->stop_threshold;

393 i‡(
pcm
->
°›_thªshﬁd
 >Öcm->
buf„r_size
)

394 
pcm
->
°›_thªshﬁd
 =Öcm->
buf„r_size
;

395 
dsh¨e
->
°©e
 = 
SND_PCM_STATE_DRAINING
;

397 
îr
 = 
	`¢d_pcm_dsh¨e_sync_±r
(
pcm
);

398 i‡(
îr
 < 0) {

399 
	`¢d_pcm_dsh¨e_dr›
(
pcm
);

402 i‡(
dsh¨e
->
°©e
 =
SND_PCM_STATE_DRAINING
) {

403 
	`¢d_pcm_dsh¨e_sync_¨ó
(
pcm
);

404 
	`¢d_pcm_waô_nocheck
(
pcm
, 
SND_PCM_WAIT_DRAIN
);

405 
	`¢d_pcm_dúe˘_˛ór_timî_queue
(
dsh¨e
);

407 
	`¢d_pcm_°©e
(
dsh¨e
->
•cm
)) {

408 
SND_PCM_STATE_SUSPENDED
:

409  -
ESTRPIPE
;

414 } 
dsh¨e
->
°©e
 =
SND_PCM_STATE_DRAINING
);

415 
pcm
->
°›_thªshﬁd
 = stop_threshold;

417 
	}
}

419 
	$¢d_pcm_dsh¨e_døö
(
¢d_pcm_t
 *
pcm
)

421 
îr
;

423 
	`¢d_pcm_lock
(
pcm
);

424 
îr
 = 
	`__¢d_pcm_dsh¨e_døö
(
pcm
);

425 
	`¢d_pcm_u∆ock
(
pcm
);

426  
îr
;

427 
	}
}

429 
	$¢d_pcm_dsh¨e_∑u£
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
íabÀ
 ATTRIBUTE_UNUSED)

431  -
EIO
;

432 
	}
}

434 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dsh¨e_ªwödabÀ
(
¢d_pcm_t
 *
pcm
)

436  
	`¢d_pcm_mm≠_∂ayback_hw_ªwödabÀ
(
pcm
);

437 
	}
}

439 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dsh¨e_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

441 
¢d_pcm_s‰ames_t
 
avaû
;

443 
avaû
 = 
	`¢d_pcm_dsh¨e_ªwödabÀ
(
pcm
);

444 i‡(
‰ames
 > (
¢d_pcm_u‰ames_t
)
avaû
)

445 
‰ames
 = 
avaû
;

446 
	`¢d_pcm_mm≠_≠∂_backw¨d
(
pcm
, 
‰ames
);

447  
‰ames
;

448 
	}
}

450 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dsh¨e_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
)

452  
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
);

453 
	}
}

455 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dsh¨e_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

457 
¢d_pcm_s‰ames_t
 
avaû
;

459 
avaû
 = 
	`¢d_pcm_dsh¨e_f‹w¨dabÀ
(
pcm
);

460 i‡(
‰ames
 > (
¢d_pcm_u‰ames_t
)
avaû
)

461 
‰ames
 = 
avaû
;

462 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
‰ames
);

463  
‰ames
;

464 
	}
}

466 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dsh¨e_ªadi
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, *
buf„r
 ATTRIBUTE_UNUSED, 
¢d_pcm_u‰ames_t
 
size
 ATTRIBUTE_UNUSED)

468  -
ENODEV
;

469 
	}
}

471 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dsh¨e_ªadn
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, **
bufs
 ATTRIBUTE_UNUSED, 
¢d_pcm_u‰ames_t
 
size
 ATTRIBUTE_UNUSED)

473  -
ENODEV
;

474 
	}
}

476 
	$¢d_pcm_dsh¨e_˛o£
(
¢d_pcm_t
 *
pcm
)

478 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

480 i‡(
dsh¨e
->
timî
)

481 
	`¢d_timî_˛o£
(
dsh¨e
->
timî
);

482 i‡(
dsh¨e
->
bödögs
)

483 
	`do_sûí˚
(
pcm
);

484 
	`¢d_pcm_dúe˘_£m≠h‹e_down
(
dsh¨e
, 
DIRECT_IPC_SEM_CLIENT
);

485 
dsh¨e
->
shm±r
->
u
.dsh¨e.
chn_mask
 &= ~dshare->u.dshare.chn_mask;

486 
	`¢d_pcm_˛o£
(
dsh¨e
->
•cm
);

487 i‡(
dsh¨e
->
£rvî
)

488 
	`¢d_pcm_dúe˘_£rvî_disˇrd
(
dsh¨e
);

489 i‡(
dsh¨e
->
˛õ¡
)

490 
	`¢d_pcm_dúe˘_˛õ¡_disˇrd
(
dsh¨e
);

491 i‡(
	`¢d_pcm_dúe˘_shm_disˇrd
(
dsh¨e
)) {

492 i‡(
	`¢d_pcm_dúe˘_£m≠h‹e_disˇrd
(
dsh¨e
))

493 
	`¢d_pcm_dúe˘_£m≠h‹e_föÆ
(
dsh¨e
, 
DIRECT_IPC_SEM_CLIENT
);

495 
	`¢d_pcm_dúe˘_£m≠h‹e_föÆ
(
dsh¨e
, 
DIRECT_IPC_SEM_CLIENT
);

496 
	`‰ì
(
dsh¨e
->
bödögs
);

497 
pcm
->
¥iv©e_d©a
 = 
NULL
;

498 
	`‰ì
(
dsh¨e
);

500 
	}
}

502 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dsh¨e_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

503 
¢d_pcm_u‰ames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

504 
¢d_pcm_u‰ames_t
 
size
)

506 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

507 
îr
;

509 
îr
 = 
	`¢d_pcm_dúe˘_check_xrun
(
dsh¨e
, 
pcm
);

510 i‡(
îr
 < 0)

511  
îr
;

512 i‡(! 
size
)

514 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
size
);

515 i‡(
dsh¨e
->
°©e
 =
STATE_RUN_PENDING
) {

516 
îr
 = 
	`¢d_pcm_dsh¨e_°¨t_timî
(
pcm
, 
dsh¨e
);

517 i‡(
îr
 < 0)

518  
îr
;

519 } i‡(
dsh¨e
->
°©e
 =
SND_PCM_STATE_RUNNING
 ||

520 
dsh¨e
->
°©e
 =
SND_PCM_STATE_DRAINING
) {

521 i‡((
îr
 = 
	`¢d_pcm_dsh¨e_sync_±r
(
pcm
)) < 0)

522  
îr
;

524 i‡(
dsh¨e
->
°©e
 =
SND_PCM_STATE_RUNNING
 ||

525 
dsh¨e
->
°©e
 =
SND_PCM_STATE_DRAINING
) {

528 
	`¢d_pcm_dsh¨e_sync_¨ó
(
pcm
);

530 i‡(
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
Ë<Öcm->
avaû_mö
)

531 
	`¢d_pcm_dúe˘_˛ór_timî_queue
(
dsh¨e
);

533  
size
;

534 
	}
}

536 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_dsh¨e_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

538 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

539 
îr
;

541 i‡(
dsh¨e
->
°©e
 =
SND_PCM_STATE_RUNNING
 ||

542 
dsh¨e
->
°©e
 =
SND_PCM_STATE_DRAINING
) {

543 i‡((
îr
 = 
	`¢d_pcm_dsh¨e_sync_±r
(
pcm
)) < 0)

544  
îr
;

546 i‡(
dsh¨e
->
°©e
 =
SND_PCM_STATE_XRUN
)

547  -
EPIPE
;

549  
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
);

550 
	}
}

552 
	$¢d_pcm_dsh¨e_htime°amp
(
¢d_pcm_t
 *
pcm
,

553 
¢d_pcm_u‰ames_t
 *
avaû
,

554 
¢d_htime°amp_t
 *
t°amp
)

556 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

557 
¢d_pcm_u‰ames_t
 
avaû1
;

558 
ok
 = 0;

561 i‡(
dsh¨e
->
°©e
 =
SND_PCM_STATE_RUNNING
 ||

562 
dsh¨e
->
°©e
 =
SND_PCM_STATE_DRAINING
)

563 
	`¢d_pcm_dsh¨e_sync_±r
(
pcm
);

564 
avaû1
 = 
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
);

565 i‡(
ok
 && *
avaû
 =
avaû1
)

567 *
avaû
 = 
avaû1
;

568 *
t°amp
 = 
	`¢d_pcm_hw_Á°_t°amp
(
dsh¨e
->
•cm
);

569 
ok
 = 1;

572 
	}
}

574 
	$¢d_pcm_dsh¨e_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

576 
¢d_pcm_dúe˘_t
 *
dsh¨e
 = 
pcm
->
¥iv©e_d©a
;

578 
	`¢d_ouçut_¥ötf
(
out
, "Direct Share PCM\n");

579 i‡(
pcm
->
£tup
) {

580 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

581 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

583 i‡(
dsh¨e
->
•cm
)

584 
	`¢d_pcm_dump
(
dsh¨e
->
•cm
, 
out
);

585 
	}
}

587 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_dsh¨e_dummy_›s
 = {

588 .
˛o£
 = 
¢d_pcm_dsh¨e_˛o£
,

591 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_dsh¨e_Á°_dummy_›s
;

593 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_dsh¨e_›s
 = {

594 .
˛o£
 = 
¢d_pcm_dsh¨e_˛o£
,

595 .
	göfo
 = 
¢d_pcm_dúe˘_öfo
,

596 .
	ghw_ªföe
 = 
¢d_pcm_dúe˘_hw_ªföe
,

597 .
	ghw_∑øms
 = 
¢d_pcm_dúe˘_hw_∑øms
,

598 .
	ghw_‰ì
 = 
¢d_pcm_dúe˘_hw_‰ì
,

599 .
	gsw_∑øms
 = 
¢d_pcm_dúe˘_sw_∑øms
,

600 .
	gch™√l_öfo
 = 
¢d_pcm_dúe˘_ch™√l_öfo
,

601 .
	gdump
 = 
¢d_pcm_dsh¨e_dump
,

602 .
	gn⁄block
 = 
¢d_pcm_dúe˘_n⁄block
,

603 .
	gasync
 = 
¢d_pcm_dúe˘_async
,

604 .
	gmm≠
 = 
¢d_pcm_dúe˘_mm≠
,

605 .
	gmunm≠
 = 
¢d_pcm_dúe˘_munm≠
,

606 .
	ggë_chm≠
 = 
¢d_pcm_dúe˘_gë_chm≠
,

607 .
	g£t_chm≠
 = 
¢d_pcm_dúe˘_£t_chm≠
,

610 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_dsh¨e_Á°_›s
 = {

611 .
°©us
 = 
¢d_pcm_dsh¨e_°©us
,

612 .
	g°©e
 = 
¢d_pcm_dsh¨e_°©e
,

613 .
	ghwsync
 = 
¢d_pcm_dsh¨e_hwsync
,

614 .
	gdñay
 = 
¢d_pcm_dsh¨e_dñay
,

615 .
	g¥ï¨e
 = 
¢d_pcm_dúe˘_¥ï¨e
,

616 .
	gª£t
 = 
¢d_pcm_dsh¨e_ª£t
,

617 .
	g°¨t
 = 
¢d_pcm_dsh¨e_°¨t
,

618 .
	gdr›
 = 
¢d_pcm_dsh¨e_dr›
,

619 .
	gdøö
 = 
¢d_pcm_dsh¨e_døö
,

620 .
	g∑u£
 = 
¢d_pcm_dsh¨e_∑u£
,

621 .
	gªwödabÀ
 = 
¢d_pcm_dsh¨e_ªwödabÀ
,

622 .
	gªwöd
 = 
¢d_pcm_dsh¨e_ªwöd
,

623 .
	gf‹w¨dabÀ
 = 
¢d_pcm_dsh¨e_f‹w¨dabÀ
,

624 .
	gf‹w¨d
 = 
¢d_pcm_dsh¨e_f‹w¨d
,

625 .
	gªsume
 = 
¢d_pcm_dúe˘_ªsume
,

626 .
	glök
 = 
NULL
,

627 .
	glök_¶aves
 = 
NULL
,

628 .
	gu∆ök
 = 
NULL
,

629 .
	gwrôei
 = 
¢d_pcm_mm≠_wrôei
,

630 .
	gwrôí
 = 
¢d_pcm_mm≠_wrôí
,

631 .
	gªadi
 = 
¢d_pcm_dsh¨e_ªadi
,

632 .
	gªadn
 = 
¢d_pcm_dsh¨e_ªadn
,

633 .
	gavaû_upd©e
 = 
¢d_pcm_dsh¨e_avaû_upd©e
,

634 .
	gmm≠_commô
 = 
¢d_pcm_dsh¨e_mm≠_commô
,

635 .
	ghtime°amp
 = 
¢d_pcm_dsh¨e_htime°amp
,

636 .
	gpﬁl_des¸ùt‹s
 = 
¢d_pcm_dúe˘_pﬁl_des¸ùt‹s
,

637 .
	gpﬁl_des¸ùt‹s_cou¡
 = 
NULL
,

638 .
	gpﬁl_ªvíts
 = 
¢d_pcm_dúe˘_pﬁl_ªvíts
,

656 
	$¢d_pcm_dsh¨e_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

657 
¢d_pcm_dúe˘_›í_c⁄f
 *
›ts
,

658 
¶ave_∑øms
 *
∑øms
,

659 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
sc⁄f
,

660 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

662 
¢d_pcm_t
 *
pcm
, *
•cm
 = 
NULL
;

663 
¢d_pcm_dúe˘_t
 *
dsh¨e
;

664 
ªt
, 
fú°_ö°™˚
;

665 
chn
;

667 
	`as£π
(
pcmp
);

669 i‡(
°ªam
 !
SND_PCM_STREAM_PLAYBACK
) {

670 
	`SNDERR
("The dshareÖlugin supports onlyÖlayback stream");

671  -
EINVAL
;

674 
ªt
 = 
	`_¢d_pcm_dúe˘_√w
(&
pcm
, &
dsh¨e
, 
SND_PCM_TYPE_DSHARE
, 
«me
, 
›ts
, 
∑øms
, 
°ªam
, 
mode
);

675 i‡(
ªt
 < 0)

676  
ªt
;

677 
fú°_ö°™˚
 = 
ªt
;

679 i‡(!
dsh¨e
->
bödögs
) {

680 
pcm
->
›s
 = &
¢d_pcm_dsh¨e_dummy_›s
;

681 
pcm
->
Á°_›s
 = &
¢d_pcm_dsh¨e_Á°_dummy_›s
;

683 
pcm
->
›s
 = &
¢d_pcm_dsh¨e_›s
;

684 
pcm
->
Á°_›s
 = &
¢d_pcm_dsh¨e_Á°_›s
;

686 
pcm
->
¥iv©e_d©a
 = 
dsh¨e
;

687 
dsh¨e
->
°©e
 = 
SND_PCM_STATE_OPEN
;

688 
dsh¨e
->
¶ow±r
 = 
›ts
->slowptr;

689 
dsh¨e
->
max_≥riods
 = 
›ts
->max_periods;

690 
dsh¨e
->
v¨_≥riodsize
 = 
›ts
->var_periodsize;

691 
dsh¨e
->
hw_±r_Æignmít
 = 
›ts
->hw_ptr_alignment;

692 
dsh¨e
->
sync_±r
 = 
¢d_pcm_dsh¨e_sync_±r
;

694 
ªåy
:

695 i‡(
fú°_ö°™˚
) {

698 
ªt
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
,

699 
mode
 | 
SND_PCM_NONBLOCK
, 
NULL
);

700 i‡(
ªt
 < 0) {

701 
	`SNDERR
("unableÅo open slave");

702 
_îr
;

705 i‡(
	`¢d_pcm_ty≥
(
•cm
Ë!
SND_PCM_TYPE_HW
) {

706 
	`SNDERR
("dshareÖlugin can be only connectedÅo hwÖlugin");

707 
_îr
;

710 
ªt
 = 
	`¢d_pcm_dúe˘_öôülize_¶ave
(
dsh¨e
, 
•cm
, 
∑øms
);

711 i‡(
ªt
 < 0) {

712 
	`SNDERR
("unableÅo initialize slave");

713 
_îr
;

716 
dsh¨e
->
•cm
 = spcm;

718 i‡(
dsh¨e
->
shm±r
->
u£_£rvî
) {

719 
ªt
 = 
	`¢d_pcm_dúe˘_£rvî_¸óã
(
dsh¨e
);

720 i‡(
ªt
 < 0) {

721 
	`SNDERR
("unableÅo create server");

722 
_îr
;

726 
dsh¨e
->
shm±r
->
ty≥
 = 
•cm
->type;

728 i‡(
dsh¨e
->
shm±r
->
u£_£rvî
) {

730 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
dsh¨e
, 
DIRECT_IPC_SEM_CLIENT
);

731 
ªt
 = 
	`¢d_pcm_dúe˘_˛õ¡_c⁄√˘
(
dsh¨e
);

732 i‡(
ªt
 < 0) {

733 
	`SNDERR
("unableÅo connect client");

734 
_îr_no£m
;

737 
	`¢d_pcm_dúe˘_£m≠h‹e_down
(
dsh¨e
, 
DIRECT_IPC_SEM_CLIENT
);

738 
ªt
 = 
	`¢d_pcm_dúe˘_›í_£c⁄d¨y_˛õ¡
(&
•cm
, 
dsh¨e
, "dshare_client");

739 i‡(
ªt
 < 0)

740 
_îr
;

744 
ªt
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
,

745 
mode
 | 
SND_PCM_NONBLOCK
 |

746 
SND_PCM_APPEND
,

747 
NULL
);

748 i‡(
ªt
 < 0) {

752 i‡(
ªt
 =-
EBADFD
) {

753 
fú°_ö°™˚
 = 1;

754 
ªåy
;

756 
	`SNDERR
("unableÅo open slave");

757 
_îr
;

759 i‡(
	`¢d_pcm_ty≥
(
•cm
Ë!
SND_PCM_TYPE_HW
) {

760 
	`SNDERR
("dshareÖlugin can be only connectedÅo hwÖlugin");

761 
ªt
 = -
EINVAL
;

762 
_îr
;

765 
ªt
 = 
	`¢d_pcm_dúe˘_öôülize_£c⁄d¨y_¶ave
(
dsh¨e
, 
•cm
, 
∑øms
);

766 i‡(
ªt
 < 0) {

767 
	`SNDERR
("unableÅo initialize slave");

768 
_îr
;

772 
dsh¨e
->
•cm
 = spcm;

775 
chn
 = 0; 
dsh¨e
->
bödögs
 && (ch¿< dsh¨e->
ch™√ls
); chn++) {

776 
dchn
 = 
dsh¨e
->
bödögs
 ? dsh¨e->bödögs[
chn
] : chn;

777 i‡(
dchn
 !
UINT_MAX
)

778 
dsh¨e
->
u
.dsh¨e.
chn_mask
 |(1ULL << 
dchn
);

780 i‡(
dsh¨e
->
shm±r
->
u
.dsh¨e.
chn_mask
 & dshare->u.dshare.chn_mask) {

781 
	`SNDERR
("destination channel specified in bindings isálready used");

782 
dsh¨e
->
u
.dsh¨e.
chn_mask
 = 0;

783 
ªt
 = -
EINVAL
;

784 
_îr
;

786 
dsh¨e
->
shm±r
->
u
.dsh¨e.
chn_mask
 |= dshare->u.dshare.chn_mask;

788 
ªt
 = 
	`¢d_pcm_dúe˘_öôülize_pﬁl_fd
(
dsh¨e
);

789 i‡(
ªt
 < 0) {

790 
	`SNDERR
("unableÅo initializeÖoll_fd");

791 
_îr
;

794 
pcm
->
pﬁl_fd
 = 
dsh¨e
->poll_fd;

795 
pcm
->
pﬁl_evíts
 = 
POLLIN
;

796 
pcm
->
t°amp_ty≥
 = 
•cm
->tstamp_type;

797 
pcm
->
mm≠_rw
 = 1;

798 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
dsh¨e
->
hw_±r
, -1, 0);

799 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
dsh¨e
->
≠∂_±r
, -1, 0);

801 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
dsh¨e
, 
DIRECT_IPC_SEM_CLIENT
);

803 *
pcmp
 = 
pcm
;

806 
_îr
:

807 i‡(
dsh¨e
->
shm±r
 != (*) -1)

808 
dsh¨e
->
shm±r
->
u
.dsh¨e.
chn_mask
 &= ~dshare->u.dshare.chn_mask;

809 i‡(
dsh¨e
->
timî
)

810 
	`¢d_timî_˛o£
(
dsh¨e
->
timî
);

811 i‡(
dsh¨e
->
£rvî
)

812 
	`¢d_pcm_dúe˘_£rvî_disˇrd
(
dsh¨e
);

813 i‡(
dsh¨e
->
˛õ¡
)

814 
	`¢d_pcm_dúe˘_˛õ¡_disˇrd
(
dsh¨e
);

815 i‡(
•cm
)

816 
	`¢d_pcm_˛o£
(
•cm
);

817 i‡((
dsh¨e
->
shmid
 >0Ë&& (
	`¢d_pcm_dúe˘_shm_disˇrd
(dshare))) {

818 i‡(
	`¢d_pcm_dúe˘_£m≠h‹e_disˇrd
(
dsh¨e
))

819 
	`¢d_pcm_dúe˘_£m≠h‹e_föÆ
(
dsh¨e
, 
DIRECT_IPC_SEM_CLIENT
);

821 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
dsh¨e
, 
DIRECT_IPC_SEM_CLIENT
);

822 
_îr_no£m
:

823 
	`‰ì
(
dsh¨e
->
bödögs
);

824 
	`‰ì
(
dsh¨e
);

825 
	`¢d_pcm_‰ì
(
pcm
);

826  
ªt
;

827 
	}
}

921 
	$_¢d_pcm_dsh¨e_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

922 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

923 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

925 
¢d_c⁄fig_t
 *
sc⁄f
;

926 
¶ave_∑øms
 
∑øms
;

927 
¢d_pcm_dúe˘_›í_c⁄f
 
d›í
;

928 
bsize
, 
psize
;

929 
îr
;

931 
îr
 = 
	`¢d_pcm_dúe˘_∑r£_›í_c⁄f
(
roŸ
, 
c⁄f
, 
°ªam
, &
d›í
);

932 i‡(
îr
 < 0)

933  
îr
;

936 
∑øms
.
f‹m©
 = 
SND_PCM_FORMAT_S16
;

937 
∑øms
.
øã
 = 48000;

938 
∑øms
.
ch™√ls
 = 2;

939 
∑øms
.
≥riod_time
 = -1;

940 
∑øms
.
buf„r_time
 = -1;

941 
bsize
 = 
psize
 = -1;

942 
∑øms
.
≥riods
 = 3;

943 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
d›í
.
¶ave
, &
sc⁄f
, 8,

944 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_UNCHANGED
, &
∑øms
.
f‹m©
,

945 
SND_PCM_HW_PARAM_RATE
, 0, &
∑øms
.
øã
,

946 
SND_PCM_HW_PARAM_CHANNELS
, 0, &
∑øms
.
ch™√ls
,

947 
SND_PCM_HW_PARAM_PERIOD_TIME
, 0, &
∑øms
.
≥riod_time
,

948 
SND_PCM_HW_PARAM_BUFFER_TIME
, 0, &
∑øms
.
buf„r_time
,

949 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 0, &
psize
,

950 
SND_PCM_HW_PARAM_BUFFER_SIZE
, 0, &
bsize
,

951 
SND_PCM_HW_PARAM_PERIODS
, 0, &
∑øms
.
≥riods
);

952 i‡(
îr
 < 0)

953  
îr
;

956 i‡(
psize
 =-1 && 
∑øms
.
≥riod_time
 == -1)

957 
∑øms
.
≥riod_time
 = 125000;

959 i‡(
∑øms
.
f‹m©
 == -2)

960 
∑øms
.
f‹m©
 = 
SND_PCM_FORMAT_UNKNOWN
;

962 
∑øms
.
≥riod_size
 = 
psize
;

963 
∑øms
.
buf„r_size
 = 
bsize
;

965 
îr
 = 
	`¢d_pcm_dsh¨e_›í
(
pcmp
, 
«me
, &
d›í
, &
∑øms
,

966 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
);

967 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

968  
îr
;

969 
	}
}

970 #i‚de‡
DOC_HIDDEN


971 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_dsh¨e_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dsnoop.c

29 
	~"pcm_loˇl.h
"

30 
	~<°dio.h
>

31 
	~<°dlib.h
>

32 
	~<°ddef.h
>

33 
	~<uni°d.h
>

34 
	~<sig«l.h
>

35 
	~<°rög.h
>

36 
	~<f˙é.h
>

37 
	~<˘y≥.h
>

38 
	~<gΩ.h
>

39 
	~<sys/io˘l.h
>

40 
	~<sys/mm™.h
>

41 
	~<sys/shm.h
>

42 
	~<sys/£m.h
>

43 
	~<sys/waô.h
>

44 
	~<sys/sockë.h
>

45 
	~<sys/un.h
>

46 
	~<sys/mm™.h
>

47 
	~"pcm_dúe˘.h
"

49 #i‚de‡
PIC


51 c⁄° *
	g_¢d_moduÀ_pcm_d¢o›
 = "";

58 
	$¢o›_time°amp
(
¢d_pcm_t
 *
pcm
)

60 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

61 
¢d_pcm_u‰ames_t
 
±r1
 = -2LL , 
±r2
;

65 
±r2
 = *
d¢o›
->
•cm
->
hw
.
±r
;

66 i‡(
±r1
 =
±r2
)

68 
±r1
 = 
±r2
;

69 
d¢o›
->
upd©e_t°amp
 = 
	`¢d_pcm_hw_Á°_t°amp
(d¢o›->
•cm
);

71 
d¢o›
->
¶ave_hw_±r
 = 
±r1
;

73 
	}
}

75 
	$¢o›_¨ós
(
¢d_pcm_dúe˘_t
 *
d¢o›
,

76 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

77 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

78 
¢d_pcm_u‰ames_t
 
§c_ofs
,

79 
¢d_pcm_u‰ames_t
 
d°_ofs
,

80 
¢d_pcm_u‰ames_t
 
size
)

82 
chn
, 
schn
, 
ch™√ls
;

83 
¢d_pcm_f‹m©_t
 
f‹m©
;

85 
ch™√ls
 = 
d¢o›
->channels;

86 
f‹m©
 = 
d¢o›
->
shm±r
->
s
.format;

87 i‡(
d¢o›
->
öãæóved
) {

88 
fbyãs
 = 
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
) / 8;

89 
	`mem˝y
(((*)
d°_¨ós
[0].
addr
Ë+ (
d°_ofs
 * 
ch™√ls
 * 
fbyãs
),

90 ((*)
§c_¨ós
[0].
addr
Ë+ (
§c_ofs
 * 
ch™√ls
 * 
fbyãs
),

91 
size
 * 
ch™√ls
 * 
fbyãs
);

93 
chn
 = 0; ch¿< 
ch™√ls
; chn++) {

94 
schn
 = 
d¢o›
->
bödögs
 ? d¢o›->bödögs[
chn
] : chn;

95 
	`¢d_pcm_¨ó_c›y
(&
d°_¨ós
[
chn
], 
d°_ofs
, &
§c_¨ós
[
schn
], 
§c_ofs
, 
size
, 
f‹m©
);

98 
	}
}

103 
	$¢d_pcm_d¢o›_sync_¨ó
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
¶ave_hw_±r
, snd_pcm_u‰ames_à
size
)

105 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

106 
¢d_pcm_u‰ames_t
 
hw_±r
 = 
d¢o›
->hw_ptr;

107 
¢d_pcm_u‰ames_t
 
å™s„r
;

108 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
, *
d°_¨ós
;

111 
d°_¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

112 
§c_¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
d¢o›
->
•cm
);

113 
hw_±r
 %
pcm
->
buf„r_size
;

114 
¶ave_hw_±r
 %
d¢o›
->
¶ave_buf„r_size
;

115 
size
 > 0) {

116 
å™s„r
 = 
hw_±r
 + 
size
 > 
pcm
->
buf„r_size
 ?Öcm->buffer_size - hw_ptr : size;

117 
å™s„r
 = 
¶ave_hw_±r
 +Åøns„∏> 
d¢o›
->
¶ave_buf„r_size
 ?

118 
d¢o›
->
¶ave_buf„r_size
 - 
¶ave_hw_±r
 : 
å™s„r
;

119 
size
 -
å™s„r
;

120 
	`¢o›_¨ós
(
d¢o›
, 
§c_¨ós
, 
d°_¨ós
, 
¶ave_hw_±r
, 
hw_±r
, 
å™s„r
);

121 
¶ave_hw_±r
 +
å™s„r
;

122 
¶ave_hw_±r
 %
d¢o›
->
¶ave_buf„r_size
;

123 
hw_±r
 +
å™s„r
;

124 
hw_±r
 %
pcm
->
buf„r_size
;

126 
	}
}

131 
	$¢d_pcm_d¢o›_sync_±r
(
¢d_pcm_t
 *
pcm
)

133 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

134 
¢d_pcm_u‰ames_t
 
¶ave_hw_±r
, 
ﬁd_¶ave_hw_±r
, 
avaû
;

135 
¢d_pcm_s‰ames_t
 
diff
;

136 
îr
;

138 i‡(
d¢o›
->
¶ow±r
)

139 
	`¢d_pcm_hwsync
(
d¢o›
->
•cm
);

140 
ﬁd_¶ave_hw_±r
 = 
d¢o›
->
¶ave_hw_±r
;

141 
	`¢o›_time°amp
(
pcm
);

142 
¶ave_hw_±r
 = 
d¢o›
->slave_hw_ptr;

143 
îr
 = 
	`¢d_pcm_dúe˘_check_xrun
(
d¢o›
, 
pcm
);

144 i‡(
îr
 < 0)

145  
îr
;

146 
diff
 = 
	`pcm_‰ame_diff
(
¶ave_hw_±r
, 
ﬁd_¶ave_hw_±r
, 
d¢o›
->
¶ave_bound¨y
);

147 i‡(
diff
 == 0)

149 
	`¢d_pcm_d¢o›_sync_¨ó
(
pcm
, 
ﬁd_¶ave_hw_±r
, 
diff
);

150 
d¢o›
->
hw_±r
 +
diff
;

151 
d¢o›
->
hw_±r
 %
pcm
->
bound¨y
;

153 i‡(
pcm
->
°›_thªshﬁd
 >pcm->
bound¨y
)

155 i‡((
avaû
 = 
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
pcm
)Ë>pcm->
°›_thªshﬁd
) {

156 
	`gëtime°amp
(&
d¢o›
->
åiggî_t°amp
, 
pcm
->
t°amp_ty≥
);

157 
d¢o›
->
°©e
 = 
SND_PCM_STATE_XRUN
;

158 
d¢o›
->
avaû_max
 = 
avaû
;

159  -
EPIPE
;

161 i‡(
avaû
 > 
d¢o›
->
avaû_max
)

162 
d¢o›
->
avaû_max
 = 
avaû
;

164 
	}
}

170 
	$¢d_pcm_d¢o›_°©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©us_t
 * 
°©us
)

172 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

173 
¢d_pcm_°©e_t
 
°©e
;

175 
d¢o›
->
°©e
) {

176 
SNDRV_PCM_STATE_DRAINING
:

177 
SNDRV_PCM_STATE_RUNNING
:

178 
	`¢d_pcm_d¢o›_sync_±r
(
pcm
);

183 
	`mem£t
(
°©us
, 0, (*status));

184 
	`¢d_pcm_°©us
(
d¢o›
->
•cm
, 
°©us
);

185 
°©e
 = 
	`¢d_pcm_°©e
(
d¢o›
->
•cm
);

186 
°©us
->
°©e
 = sèã =
SND_PCM_STATE_RUNNING
 ? 
d¢o›
->state : state;

187 
°©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

188 
°©us
->
≠∂_±r
 = *
pcm
->
≠∂
.
±r
;

189 
°©us
->
åiggî_t°amp
 = 
d¢o›
->trigger_tstamp;

190 
°©us
->
avaû
 = 
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
pcm
);

191 
°©us
->
avaû_max
 = sètus->
avaû
 > 
d¢o›
->avail_max ? status->avail : dsnoop->avail_max;

192 
d¢o›
->
avaû_max
 = 0;

193 
°©us
->
dñay
 = 
	`¢d_pcm_mm≠_ˇ±uª_dñay
(
pcm
);

195 
	}
}

197 
¢d_pcm_°©e_t
 
	$¢d_pcm_d¢o›_°©e
(
¢d_pcm_t
 *
pcm
)

199 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

201 
	`¢d_pcm_dúe˘_check_xrun
(
d¢o›
, 
pcm
);

202  
d¢o›
->
°©e
;

203 
	}
}

205 
	$¢d_pcm_d¢o›_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
)

207 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

208 
îr
;

210 
d¢o›
->
°©e
) {

211 
SNDRV_PCM_STATE_DRAINING
:

212 
SNDRV_PCM_STATE_RUNNING
:

213 
îr
 = 
	`¢d_pcm_d¢o›_sync_±r
(
pcm
);

214 i‡(
îr
 < 0)

215  
îr
;

217 
SNDRV_PCM_STATE_PREPARED
:

218 
SNDRV_PCM_STATE_SUSPENDED
:

219 *
dñayp
 = 
	`¢d_pcm_mm≠_ˇ±uª_dñay
(
pcm
);

221 
SNDRV_PCM_STATE_XRUN
:

222  -
EPIPE
;

223 
SNDRV_PCM_STATE_DISCONNECTED
:

224  -
ENODEV
;

226  -
EBADFD
;

228 
	}
}

230 
	$¢d_pcm_d¢o›_hwsync
(
¢d_pcm_t
 *
pcm
)

232 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

234 
d¢o›
->
°©e
) {

235 
SNDRV_PCM_STATE_DRAINING
:

236 
SNDRV_PCM_STATE_RUNNING
:

237  
	`¢d_pcm_d¢o›_sync_±r
(
pcm
);

238 
SNDRV_PCM_STATE_PREPARED
:

239 
SNDRV_PCM_STATE_SUSPENDED
:

241 
SNDRV_PCM_STATE_XRUN
:

242  -
EPIPE
;

243 
SNDRV_PCM_STATE_DISCONNECTED
:

244  -
ENODEV
;

246  -
EBADFD
;

248 
	}
}

250 
	$¢d_pcm_d¢o›_ª£t
(
¢d_pcm_t
 *
pcm
)

252 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

253 
d¢o›
->
hw_±r
 %
pcm
->
≥riod_size
;

254 
d¢o›
->
≠∂_±r
 = d¢o›->
hw_±r
;

255 
	`¢d_pcm_dúe˘_ª£t_¶ave_±r
(
pcm
, 
d¢o›
, d¢o›->
¶ave_hw_±r
);

257 
	}
}

259 
	$¢d_pcm_d¢o›_°¨t
(
¢d_pcm_t
 *
pcm
)

261 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

262 
îr
;

264 i‡(
d¢o›
->
°©e
 !
SND_PCM_STATE_PREPARED
)

265  -
EBADFD
;

266 
	`¢d_pcm_hwsync
(
d¢o›
->
•cm
);

267 
	`¢o›_time°amp
(
pcm
);

268 
	`¢d_pcm_dúe˘_ª£t_¶ave_±r
(
pcm
, 
d¢o›
, d¢o›->
¶ave_hw_±r
);

269 
îr
 = 
	`¢d_timî_°¨t
(
d¢o›
->
timî
);

270 i‡(
îr
 < 0)

271  
îr
;

272 
d¢o›
->
°©e
 = 
SND_PCM_STATE_RUNNING
;

273 
d¢o›
->
åiggî_t°amp
 = d¢o›->
upd©e_t°amp
;

275 
	}
}

277 
	$¢d_pcm_d¢o›_dr›
(
¢d_pcm_t
 *
pcm
)

279 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

280 i‡(
d¢o›
->
°©e
 =
SND_PCM_STATE_OPEN
)

281  -
EBADFD
;

282 
d¢o›
->
°©e
 = 
SND_PCM_STATE_SETUP
;

283 
	`¢d_timî_°›
(
d¢o›
->
timî
);

285 
	}
}

288 
	$__¢d_pcm_d¢o›_døö
(
¢d_pcm_t
 *
pcm
)

290 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

291 
¢d_pcm_u‰ames_t
 
°›_thªshﬁd
;

292 
îr
;

294 i‡(
d¢o›
->
°©e
 =
SND_PCM_STATE_OPEN
)

295  -
EBADFD
;

296 
°›_thªshﬁd
 = 
pcm
->stop_threshold;

297 i‡(
pcm
->
°›_thªshﬁd
 >Öcm->
buf„r_size
)

298 
pcm
->
°›_thªshﬁd
 =Öcm->
buf„r_size
;

299 
d¢o›
->
°©e
 =
SND_PCM_STATE_RUNNING
) {

300 
îr
 = 
	`¢d_pcm_d¢o›_sync_±r
(
pcm
);

301 i‡(
îr
 < 0)

303 i‡(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
)

304  -
EAGAIN
;

305 
	`__¢d_pcm_waô_ö_lock
(
pcm
, 
SND_PCM_WAIT_DRAIN
);

307 
pcm
->
°›_thªshﬁd
 = stop_threshold;

308  
	`¢d_pcm_d¢o›_dr›
(
pcm
);

309 
	}
}

311 
	$¢d_pcm_d¢o›_døö
(
¢d_pcm_t
 *
pcm
)

313 
îr
;

315 
	`¢d_pcm_lock
(
pcm
);

316 
îr
 = 
	`__¢d_pcm_d¢o›_døö
(
pcm
);

317 
	`¢d_pcm_u∆ock
(
pcm
);

318  
îr
;

319 
	}
}

321 
	$¢d_pcm_d¢o›_∑u£
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
íabÀ
 ATTRIBUTE_UNUSED)

323  -
EIO
;

324 
	}
}

326 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_d¢o›_ªwödabÀ
(
¢d_pcm_t
 *
pcm
)

328  
	`¢d_pcm_mm≠_ˇ±uª_hw_ªwödabÀ
(
pcm
);

329 
	}
}

331 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_d¢o›_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

333 
¢d_pcm_s‰ames_t
 
avaû
;

335 
avaû
 = 
	`¢d_pcm_d¢o›_ªwödabÀ
(
pcm
);

336 i‡(
‰ames
 > (
¢d_pcm_u‰ames_t
)
avaû
)

337 
‰ames
 = 
avaû
;

338 
	`¢d_pcm_mm≠_≠∂_backw¨d
(
pcm
, 
‰ames
);

339  
‰ames
;

340 
	}
}

342 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_d¢o›_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
)

344  
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
pcm
);

345 
	}
}

347 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_d¢o›_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

349 
¢d_pcm_s‰ames_t
 
avaû
;

351 
avaû
 = 
	`¢d_pcm_d¢o›_f‹w¨dabÀ
(
pcm
);

352 i‡(
‰ames
 > (
¢d_pcm_u‰ames_t
)
avaû
)

353 
‰ames
 = 
avaû
;

354 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
‰ames
);

355  
‰ames
;

356 
	}
}

358 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_d¢o›_wrôei
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, c⁄° *
buf„r
 ATTRIBUTE_UNUSED, 
¢d_pcm_u‰ames_t
 
size
 ATTRIBUTE_UNUSED)

360  -
ENODEV
;

361 
	}
}

363 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_d¢o›_wrôí
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, **
bufs
 ATTRIBUTE_UNUSED, 
¢d_pcm_u‰ames_t
 
size
 ATTRIBUTE_UNUSED)

365  -
ENODEV
;

366 
	}
}

368 
	$¢d_pcm_d¢o›_˛o£
(
¢d_pcm_t
 *
pcm
)

370 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

372 i‡(
d¢o›
->
timî
)

373 
	`¢d_timî_˛o£
(
d¢o›
->
timî
);

374 
	`¢d_pcm_dúe˘_£m≠h‹e_down
(
d¢o›
, 
DIRECT_IPC_SEM_CLIENT
);

375 
	`¢d_pcm_˛o£
(
d¢o›
->
•cm
);

376 i‡(
d¢o›
->
£rvî
)

377 
	`¢d_pcm_dúe˘_£rvî_disˇrd
(
d¢o›
);

378 i‡(
d¢o›
->
˛õ¡
)

379 
	`¢d_pcm_dúe˘_˛õ¡_disˇrd
(
d¢o›
);

380 i‡(
	`¢d_pcm_dúe˘_shm_disˇrd
(
d¢o›
)) {

381 i‡(
	`¢d_pcm_dúe˘_£m≠h‹e_disˇrd
(
d¢o›
))

382 
	`¢d_pcm_dúe˘_£m≠h‹e_föÆ
(
d¢o›
, 
DIRECT_IPC_SEM_CLIENT
);

384 
	`¢d_pcm_dúe˘_£m≠h‹e_föÆ
(
d¢o›
, 
DIRECT_IPC_SEM_CLIENT
);

385 
	`‰ì
(
d¢o›
->
bödögs
);

386 
pcm
->
¥iv©e_d©a
 = 
NULL
;

387 
	`‰ì
(
d¢o›
);

389 
	}
}

391 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_d¢o›_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

392 
¢d_pcm_u‰ames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

393 
¢d_pcm_u‰ames_t
 
size
)

395 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

396 
îr
;

398 
îr
 = 
	`¢d_pcm_dúe˘_check_xrun
(
d¢o›
, 
pcm
);

399 i‡(
îr
 < 0)

400  
îr
;

401 i‡(
d¢o›
->
°©e
 =
SND_PCM_STATE_RUNNING
) {

402 
îr
 = 
	`¢d_pcm_d¢o›_sync_±r
(
pcm
);

403 i‡(
îr
 < 0)

404  
îr
;

406 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
size
);

408 i‡(
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
pcm
Ë<Öcm->
avaû_mö
)

409 
	`¢d_pcm_dúe˘_˛ór_timî_queue
(
d¢o›
);

410  
size
;

411 
	}
}

413 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_d¢o›_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

415 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

416 
îr
;

418 i‡(
d¢o›
->
°©e
 =
SND_PCM_STATE_RUNNING
) {

419 
îr
 = 
	`¢d_pcm_d¢o›_sync_±r
(
pcm
);

420 i‡(
îr
 < 0)

421  
îr
;

423 i‡(
d¢o›
->
°©e
 =
SND_PCM_STATE_XRUN
)

424  -
EPIPE
;

426  
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
pcm
);

427 
	}
}

429 
	$¢d_pcm_d¢o›_htime°amp
(
¢d_pcm_t
 *
pcm
,

430 
¢d_pcm_u‰ames_t
 *
avaû
,

431 
¢d_htime°amp_t
 *
t°amp
)

433 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

434 
¢d_pcm_u‰ames_t
 
avaû1
;

435 
ok
 = 0;

438 i‡(
d¢o›
->
°©e
 =
SND_PCM_STATE_RUNNING
 ||

439 
d¢o›
->
°©e
 =
SND_PCM_STATE_DRAINING
)

440 
	`¢d_pcm_d¢o›_sync_±r
(
pcm
);

441 
avaû1
 = 
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
pcm
);

442 i‡(
ok
 && *
avaû
 =
avaû1
)

444 *
avaû
 = 
avaû1
;

445 *
t°amp
 = 
	`¢d_pcm_hw_Á°_t°amp
(
d¢o›
->
•cm
);

446 
ok
 = 1;

449 
	}
}

451 
	$¢d_pcm_d¢o›_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

453 
¢d_pcm_dúe˘_t
 *
d¢o›
 = 
pcm
->
¥iv©e_d©a
;

455 
	`¢d_ouçut_¥ötf
(
out
, "Direct Snoop PCM\n");

456 i‡(
pcm
->
£tup
) {

457 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

458 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

460 i‡(
d¢o›
->
•cm
)

461 
	`¢d_pcm_dump
(
d¢o›
->
•cm
, 
out
);

462 
	}
}

464 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_d¢o›_›s
 = {

465 .
˛o£
 = 
¢d_pcm_d¢o›_˛o£
,

466 .
	göfo
 = 
¢d_pcm_dúe˘_öfo
,

467 .
	ghw_ªföe
 = 
¢d_pcm_dúe˘_hw_ªföe
,

468 .
	ghw_∑øms
 = 
¢d_pcm_dúe˘_hw_∑øms
,

469 .
	ghw_‰ì
 = 
¢d_pcm_dúe˘_hw_‰ì
,

470 .
	gsw_∑øms
 = 
¢d_pcm_dúe˘_sw_∑øms
,

471 .
	gch™√l_öfo
 = 
¢d_pcm_dúe˘_ch™√l_öfo
,

472 .
	gdump
 = 
¢d_pcm_d¢o›_dump
,

473 .
	gn⁄block
 = 
¢d_pcm_dúe˘_n⁄block
,

474 .
	gasync
 = 
¢d_pcm_dúe˘_async
,

475 .
	gmm≠
 = 
¢d_pcm_dúe˘_mm≠
,

476 .
	gmunm≠
 = 
¢d_pcm_dúe˘_munm≠
,

477 .
	gquîy_chm≠s
 = 
¢d_pcm_dúe˘_quîy_chm≠s
,

478 .
	ggë_chm≠
 = 
¢d_pcm_dúe˘_gë_chm≠
,

479 .
	g£t_chm≠
 = 
¢d_pcm_dúe˘_£t_chm≠
,

482 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_d¢o›_Á°_›s
 = {

483 .
°©us
 = 
¢d_pcm_d¢o›_°©us
,

484 .
	g°©e
 = 
¢d_pcm_d¢o›_°©e
,

485 .
	ghwsync
 = 
¢d_pcm_d¢o›_hwsync
,

486 .
	gdñay
 = 
¢d_pcm_d¢o›_dñay
,

487 .
	g¥ï¨e
 = 
¢d_pcm_dúe˘_¥ï¨e
,

488 .
	gª£t
 = 
¢d_pcm_d¢o›_ª£t
,

489 .
	g°¨t
 = 
¢d_pcm_d¢o›_°¨t
,

490 .
	gdr›
 = 
¢d_pcm_d¢o›_dr›
,

491 .
	gdøö
 = 
¢d_pcm_d¢o›_døö
,

492 .
	g∑u£
 = 
¢d_pcm_d¢o›_∑u£
,

493 .
	gªwödabÀ
 = 
¢d_pcm_d¢o›_ªwödabÀ
,

494 .
	gªwöd
 = 
¢d_pcm_d¢o›_ªwöd
,

495 .
	gf‹w¨dabÀ
 = 
¢d_pcm_d¢o›_f‹w¨dabÀ
,

496 .
	gf‹w¨d
 = 
¢d_pcm_d¢o›_f‹w¨d
,

497 .
	gªsume
 = 
¢d_pcm_dúe˘_ªsume
,

498 .
	glök
 = 
NULL
,

499 .
	glök_¶aves
 = 
NULL
,

500 .
	gu∆ök
 = 
NULL
,

501 .
	gwrôei
 = 
¢d_pcm_d¢o›_wrôei
,

502 .
	gwrôí
 = 
¢d_pcm_d¢o›_wrôí
,

503 .
	gªadi
 = 
¢d_pcm_mm≠_ªadi
,

504 .
	gªadn
 = 
¢d_pcm_mm≠_ªadn
,

505 .
	gavaû_upd©e
 = 
¢d_pcm_d¢o›_avaû_upd©e
,

506 .
	gmm≠_commô
 = 
¢d_pcm_d¢o›_mm≠_commô
,

507 .
	ghtime°amp
 = 
¢d_pcm_d¢o›_htime°amp
,

508 .
	gpﬁl_des¸ùt‹s
 = 
¢d_pcm_dúe˘_pﬁl_des¸ùt‹s
,

509 .
	gpﬁl_des¸ùt‹s_cou¡
 = 
NULL
,

510 .
	gpﬁl_ªvíts
 = 
¢d_pcm_dúe˘_pﬁl_ªvíts
,

528 
	$¢d_pcm_d¢o›_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

529 
¢d_pcm_dúe˘_›í_c⁄f
 *
›ts
,

530 
¶ave_∑øms
 *
∑øms
,

531 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
sc⁄f
,

532 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

534 
¢d_pcm_t
 *
pcm
, *
•cm
 = 
NULL
;

535 
¢d_pcm_dúe˘_t
 *
d¢o›
;

536 
ªt
, 
fú°_ö°™˚
;

538 
	`as£π
(
pcmp
);

540 i‡(
°ªam
 !
SND_PCM_STREAM_CAPTURE
) {

541 
	`SNDERR
("The dsnoopÖlugin supports only capture stream");

542  -
EINVAL
;

545 
ªt
 = 
	`_¢d_pcm_dúe˘_√w
(&
pcm
, &
d¢o›
, 
SND_PCM_TYPE_DSNOOP
, 
«me
, 
›ts
, 
∑øms
, 
°ªam
, 
mode
);

546 i‡(
ªt
 < 0)

547  
ªt
;

548 
fú°_ö°™˚
 = 
ªt
;

550 
pcm
->
›s
 = &
¢d_pcm_d¢o›_›s
;

551 
pcm
->
Á°_›s
 = &
¢d_pcm_d¢o›_Á°_›s
;

552 
pcm
->
¥iv©e_d©a
 = 
d¢o›
;

553 
d¢o›
->
°©e
 = 
SND_PCM_STATE_OPEN
;

554 
d¢o›
->
¶ow±r
 = 
›ts
->slowptr;

555 
d¢o›
->
max_≥riods
 = 
›ts
->max_periods;

556 
d¢o›
->
v¨_≥riodsize
 = 
›ts
->var_periodsize;

557 
d¢o›
->
sync_±r
 = 
¢d_pcm_d¢o›_sync_±r
;

558 
d¢o›
->
hw_±r_Æignmít
 = 
›ts
->hw_ptr_alignment;

560 
ªåy
:

561 i‡(
fú°_ö°™˚
) {

564 
ªt
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
,

565 
mode
 | 
SND_PCM_NONBLOCK
, 
NULL
);

566 i‡(
ªt
 < 0) {

567 
	`SNDERR
("unableÅo open slave");

568 
_îr
;

571 i‡(
	`¢d_pcm_ty≥
(
•cm
Ë!
SND_PCM_TYPE_HW
) {

572 
	`SNDERR
("dsnoopÖlugin can be only connectedÅo hwÖlugin");

573 
_îr
;

576 
ªt
 = 
	`¢d_pcm_dúe˘_öôülize_¶ave
(
d¢o›
, 
•cm
, 
∑øms
);

577 i‡(
ªt
 < 0) {

578 
	`SNDERR
("unableÅo initialize slave");

579 
_îr
;

582 
d¢o›
->
•cm
 = spcm;

584 i‡(
d¢o›
->
shm±r
->
u£_£rvî
) {

585 
ªt
 = 
	`¢d_pcm_dúe˘_£rvî_¸óã
(
d¢o›
);

586 i‡(
ªt
 < 0) {

587 
	`SNDERR
("unableÅo create server");

588 
_îr
;

592 
d¢o›
->
shm±r
->
ty≥
 = 
•cm
->type;

594 i‡(
d¢o›
->
shm±r
->
u£_£rvî
) {

596 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
d¢o›
, 
DIRECT_IPC_SEM_CLIENT
);

597 
ªt
 = 
	`¢d_pcm_dúe˘_˛õ¡_c⁄√˘
(
d¢o›
);

598 i‡(
ªt
 < 0) {

599 
	`SNDERR
("unableÅo connect client");

600 
_îr_no£m
;

603 
	`¢d_pcm_dúe˘_£m≠h‹e_down
(
d¢o›
, 
DIRECT_IPC_SEM_CLIENT
);

605 
ªt
 = 
	`¢d_pcm_dúe˘_›í_£c⁄d¨y_˛õ¡
(&
•cm
, 
d¢o›
, "dsnoop_client");

606 i‡(
ªt
 < 0)

607 
_îr
;

610 
ªt
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
,

611 
mode
 | 
SND_PCM_NONBLOCK
 |

612 
SND_PCM_APPEND
,

613 
NULL
);

614 i‡(
ªt
 < 0) {

618 i‡(
ªt
 =-
EBADFD
) {

619 
fú°_ö°™˚
 = 1;

620 
ªåy
;

622 
	`SNDERR
("unableÅo open slave");

623 
_îr
;

625 i‡(
	`¢d_pcm_ty≥
(
•cm
Ë!
SND_PCM_TYPE_HW
) {

626 
	`SNDERR
("dsnoopÖlugin can be only connectedÅo hwÖlugin");

627 
ªt
 = -
EINVAL
;

628 
_îr
;

631 
ªt
 = 
	`¢d_pcm_dúe˘_öôülize_£c⁄d¨y_¶ave
(
d¢o›
, 
•cm
, 
∑øms
);

632 i‡(
ªt
 < 0) {

633 
	`SNDERR
("unableÅo initialize slave");

634 
_îr
;

638 
d¢o›
->
•cm
 = spcm;

641 
ªt
 = 
	`¢d_pcm_dúe˘_öôülize_pﬁl_fd
(
d¢o›
);

642 i‡(
ªt
 < 0) {

643 
	`SNDERR
("unableÅo initializeÖoll_fd");

644 
_îr
;

647 
pcm
->
pﬁl_fd
 = 
d¢o›
->poll_fd;

648 
pcm
->
pﬁl_evíts
 = 
POLLIN
;

649 
pcm
->
t°amp_ty≥
 = 
•cm
->tstamp_type;

650 
pcm
->
mm≠_rw
 = 1;

651 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
d¢o›
->
hw_±r
, -1, 0);

652 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
d¢o›
->
≠∂_±r
, -1, 0);

654 i‡(
d¢o›
->
ch™√ls
 =
UINT_MAX
)

655 
d¢o›
->
ch™√ls
 = d¢o›->
shm±r
->
s
.channels;

657 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
d¢o›
, 
DIRECT_IPC_SEM_CLIENT
);

659 *
pcmp
 = 
pcm
;

662 
_îr
:

663 i‡(
d¢o›
->
timî
)

664 
	`¢d_timî_˛o£
(
d¢o›
->
timî
);

665 i‡(
d¢o›
->
£rvî
)

666 
	`¢d_pcm_dúe˘_£rvî_disˇrd
(
d¢o›
);

667 i‡(
d¢o›
->
˛õ¡
)

668 
	`¢d_pcm_dúe˘_˛õ¡_disˇrd
(
d¢o›
);

669 i‡(
•cm
)

670 
	`¢d_pcm_˛o£
(
•cm
);

671 i‡((
d¢o›
->
shmid
 >0Ë&& (
	`¢d_pcm_dúe˘_shm_disˇrd
(dsnoop))) {

672 i‡(
	`¢d_pcm_dúe˘_£m≠h‹e_disˇrd
(
d¢o›
))

673 
	`¢d_pcm_dúe˘_£m≠h‹e_föÆ
(
d¢o›
, 
DIRECT_IPC_SEM_CLIENT
);

675 
	`¢d_pcm_dúe˘_£m≠h‹e_up
(
d¢o›
, 
DIRECT_IPC_SEM_CLIENT
);

677 
_îr_no£m
:

678 
	`‰ì
(
d¢o›
->
bödögs
);

679 
	`‰ì
(
d¢o›
);

680 
	`¢d_pcm_‰ì
(
pcm
);

681  
ªt
;

682 
	}
}

773 
	$_¢d_pcm_d¢o›_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

774 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

775 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

777 
¢d_c⁄fig_t
 *
sc⁄f
;

778 
¶ave_∑øms
 
∑øms
;

779 
¢d_pcm_dúe˘_›í_c⁄f
 
d›í
;

780 
bsize
, 
psize
;

781 
îr
;

783 
îr
 = 
	`¢d_pcm_dúe˘_∑r£_›í_c⁄f
(
roŸ
, 
c⁄f
, 
°ªam
, &
d›í
);

784 i‡(
îr
 < 0)

785  
îr
;

788 
∑øms
.
f‹m©
 = 
SND_PCM_FORMAT_S16
;

789 
∑øms
.
øã
 = 48000;

790 
∑øms
.
ch™√ls
 = 2;

791 
∑øms
.
≥riod_time
 = -1;

792 
∑øms
.
buf„r_time
 = -1;

793 
bsize
 = 
psize
 = -1;

794 
∑øms
.
≥riods
 = 3;

795 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
d›í
.
¶ave
, &
sc⁄f
, 8,

796 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_UNCHANGED
, &
∑øms
.
f‹m©
,

797 
SND_PCM_HW_PARAM_RATE
, 0, &
∑øms
.
øã
,

798 
SND_PCM_HW_PARAM_CHANNELS
, 0, &
∑øms
.
ch™√ls
,

799 
SND_PCM_HW_PARAM_PERIOD_TIME
, 0, &
∑øms
.
≥riod_time
,

800 
SND_PCM_HW_PARAM_BUFFER_TIME
, 0, &
∑øms
.
buf„r_time
,

801 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 0, &
psize
,

802 
SND_PCM_HW_PARAM_BUFFER_SIZE
, 0, &
bsize
,

803 
SND_PCM_HW_PARAM_PERIODS
, 0, &
∑øms
.
≥riods
);

804 i‡(
îr
 < 0)

805  
îr
;

808 i‡(
psize
 =-1 && 
∑øms
.
≥riod_time
 == -1)

809 
∑øms
.
≥riod_time
 = 125000;

811 i‡(
∑øms
.
f‹m©
 == -2)

812 
∑øms
.
f‹m©
 = 
SND_PCM_FORMAT_UNKNOWN
;

814 
∑øms
.
≥riod_size
 = 
psize
;

815 
∑øms
.
buf„r_size
 = 
bsize
;

817 
îr
 = 
	`¢d_pcm_d¢o›_›í
(
pcmp
, 
«me
, &
d›í
, &
∑øms
,

818 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
);

819 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

820  
îr
;

821 
	}
}

822 #i‚de‡
DOC_HIDDEN


823 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_d¢o›_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_empty.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_∂ugö.h
"

32 #i‚de‡
PIC


34 c⁄° *
	g_¢d_moduÀ_pcm_em±y
 = "";

79 
	$_¢d_pcm_em±y_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
 
ATTRIBUTE_UNUSED
,

80 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

81 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

83 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

84 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

85 
îr
;

87 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

88 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

89 c⁄° *
id
;

90 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

92 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

94 i‡(
	`°rcmp
(
id
, "slave") == 0) {

95 
¶ave
 = 
n
;

98 
	`SNDERR
("Unknow¿fõld %s", 
id
);

99  -
EINVAL
;

101 i‡(!
¶ave
) {

102 
	`SNDERR
("slave isÇot defined");

103  -
EINVAL
;

105 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 0);

106 i‡(
îr
 < 0)

107  
îr
;

108 
îr
 = 
	`¢d_pcm_›í_«med_¶ave
(
pcmp
, 
«me
, 
roŸ
, 
sc⁄f
, 
°ªam
,

109 
mode
, 
c⁄f
);

110 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

111  
îr
;

112 
	}
}

113 #i‚de‡
DOC_HIDDEN


114 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_em±y_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_ext_parm.h

2 
	s¢d_ext_∑rm
 {

3 
	mmö
, 
	mmax
;

4 
	mnum_li°
;

5 *
	mli°
;

6 
	ma˘ive
: 1;

7 
	möãgî
: 1;

8 
	mkìp_lök
: 1;

11 
ölöe
 
¢d_mask_t
 *
	$hw_∑øm_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

12 
¢d_pcm_hw_∑øm_t
 
v¨
)

14  &
∑øms
->
masks
[
v¨
 - 
SND_PCM_HW_PARAM_FIRST_MASK
];

15 
	}
}

17 
ölöe
 
¢d_öãrvÆ_t
 *
	$hw_∑øm_öãrvÆ
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

18 
¢d_pcm_hw_∑øm_t
 
v¨
)

20  &
∑øms
->
öãrvÆs
[
v¨
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
];

21 
	}
}

24 
	#¢d_ext_∑rm_£t_mömax
 \

25 
¢d1_ext_∑rm_£t_mömax


	)

26 
	#¢d_ext_∑rm_£t_li°
 \

27 
¢d1_ext_∑rm_£t_li°


	)

28 
	#¢d_ext_∑rm_˛ór
 \

29 
¢d1_ext_∑rm_˛ór


	)

30 
	#¢d_öãrvÆ_li°
 \

31 
¢d1_öãrvÆ_li°


	)

32 
	#¢d_ext_∑rm_öãrvÆ_ªföe
 \

33 
¢d1_ext_∑rm_öãrvÆ_ªföe


	)

34 
	#¢d_ext_∑rm_mask_ªföe
 \

35 
¢d1_ext_∑rm_mask_ªföe


	)

37 
¢d_ext_∑rm_£t_mömax
(
¢d_ext_∑rm
 *
∑rm
, 
mö
, 
max
);

38 
¢d_ext_∑rm_£t_li°
(
¢d_ext_∑rm
 *
∑rm
, 
num_li°
, c⁄° *
li°
);

39 
¢d_ext_∑rm_˛ór
(
¢d_ext_∑rm
 *
∑rm
);

40 
¢d_öãrvÆ_li°
(
¢d_öãrvÆ_t
 *
ivÆ
, 
num_li°
, *
li°
);

41 
¢d_ext_∑rm_öãrvÆ_ªföe
(
¢d_öãrvÆ_t
 *
ivÆ
, 
¢d_ext_∑rm
 *
∑rm
, 
ty≥
);

42 
¢d_ext_∑rm_mask_ªföe
(
¢d_mask_t
 *
mask
, 
¢d_ext_∑rm
 *
∑rm
, 
ty≥
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_extplug.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_∂ugö.h
"

31 
	~"pcm_exçlug.h
"

32 
	~"pcm_ext_∑rm.h
"

34 #i‚de‡
PIC


36 c⁄° *
	g_¢d_moduÀ_pcm_exçlug
 = "";

39 #i‚de‡
DOC_HIDDEN


41 
	s¢d_pcm_exçlug_¥iv
 {

42 
¢d_pcm_∂ugö_t
 
	m∂ug
;

43 
¢d_pcm_exçlug_t
 *
	md©a
;

44 
¢d_ext_∑rm
 
	m∑øms
[
SND_PCM_EXTPLUG_HW_PARAMS
];

45 
¢d_ext_∑rm
 
	m•¨ams
[
SND_PCM_EXTPLUG_HW_PARAMS
];

46 } 
	texçlug_¥iv_t
;

48 c⁄° 
	ghw_∑øms_ty≥
[
SND_PCM_EXTPLUG_HW_PARAMS
] = {

49 [
SND_PCM_EXTPLUG_HW_FORMAT
] = 
SND_PCM_HW_PARAM_FORMAT
,

50 [
SND_PCM_EXTPLUG_HW_CHANNELS
] = 
SND_PCM_HW_PARAM_CHANNELS


53 
	#is_mask_ty≥
(
i
Ë(
hw_∑øms_ty≥
[i] < 
SND_PCM_HW_PARAM_FIRST_INTERVAL
)

	)

55 c⁄° 
	gex˛_∑rbôs
[
SND_PCM_EXTPLUG_HW_PARAMS
] = {

56 [
SND_PCM_EXTPLUG_HW_FORMAT
] = (
SND_PCM_HW_PARBIT_FORMAT
|

57 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

58 
SND_PCM_HW_PARBIT_SAMPLE_BITS
),

59 [
SND_PCM_EXTPLUG_HW_CHANNELS
] = (
SND_PCM_HW_PARBIT_CHANNELS
|

60 
SND_PCM_HW_PARBIT_FRAME_BITS
),

66 
	$¢d_ext_∑rm_£t_mömax
(
¢d_ext_∑rm
 *
∑rm
, 
mö
, 
max
)

68 
∑rm
->
num_li°
 = 0;

69 
	`‰ì
(
∑rm
->
li°
);

70 
∑rm
->
li°
 = 
NULL
;

71 
∑rm
->
mö
 = min;

72 
∑rm
->
max
 = max;

73 
∑rm
->
a˘ive
 = 1;

75 
	}
}

80 
	$vÆ_com∑r
(c⁄° *
≠
, c⁄° *
bp
)

82  *(c⁄° *)
≠
 - *(c⁄° *)
bp
;

83 
	}
}

85 
	$¢d_ext_∑rm_£t_li°
(
¢d_ext_∑rm
 *
∑rm
, 
num_li°
, c⁄° *
li°
)

87 *
√w_li°
;

89 
√w_li°
 = 
	`mÆloc
((*√w_li°Ë* 
num_li°
);

90 i‡(
√w_li°
 =
NULL
)

91  -
ENOMEM
;

92 
	`mem˝y
(
√w_li°
, 
li°
, (*√w_li°Ë* 
num_li°
);

93 
	`qs‹t
(
√w_li°
, 
num_li°
, (*√w_li°), 
vÆ_com∑r
);

95 
	`‰ì
(
∑rm
->
li°
);

96 
∑rm
->
num_li°
 =Çum_list;

97 
∑rm
->
li°
 = 
√w_li°
;

98 
∑rm
->
a˘ive
 = 1;

100 
	}
}

102 
	$¢d_ext_∑rm_˛ór
(
¢d_ext_∑rm
 *
∑rm
)

104 
	`‰ì
(
∑rm
->
li°
);

105 
	`mem£t
(
∑rm
, 0, (*parm));

106 
	}
}

111 
	$¢d_öãrvÆ_li°
(
¢d_öãrvÆ_t
 *
ivÆ
, 
num_li°
, *
li°
)

113 
imö
, 
imax
;

114 
ch™ged
 = 0;

116 i‡(
	`¢d_öãrvÆ_em±y
(
ivÆ
))

117  -
ENOENT
;

118 
imö
 = 0; imö < 
num_li°
; imin++) {

119 i‡(
ivÆ
->
mö
 =
li°
[
imö
] && ! ivÆ->
›ímö
)

121 i‡(
ivÆ
->
mö
 <
li°
[
imö
]) {

122 
ivÆ
->
mö
 = 
li°
[
imö
];

123 
ivÆ
->
›ímö
 = 0;

124 
ch™ged
 = 1;

128 i‡(
imö
 >
num_li°
)

129  -
EINVAL
;

130 
imax
 = 
num_li°
 - 1; imax >
imö
; imax--) {

131 i‡(
ivÆ
->
max
 =
li°
[
imax
] && ! ivÆ->
›ímax
)

133 i‡(
ivÆ
->
max
 >
li°
[
imax
]) {

134 
ivÆ
->
max
 = 
li°
[
imax
];

135 
ivÆ
->
›ímax
 = 0;

136 
ch™ged
 = 1;

140 i‡(
imax
 < 
imö
)

141  -
EINVAL
;

142  
ch™ged
;

143 
	}
}

148 
	$¢d_ext_∑rm_öãrvÆ_ªföe
(
¢d_öãrvÆ_t
 *
ivÆ
, 
¢d_ext_∑rm
 *
∑rm
, 
ty≥
)

150 
∑rm
 +
ty≥
;

151 i‡(! 
∑rm
->
a˘ive
)

153 
ivÆ
->
öãgî
 |
∑rm
->integer;

154 i‡(
∑rm
->
num_li°
) {

155  
	`¢d_öãrvÆ_li°
(
ivÆ
, 
∑rm
->
num_li°
,Ö¨m->
li°
);

156 } i‡(
∑rm
->
mö
 ||Ö¨m->
max
) {

157 
¢d_öãrvÆ_t
 
t
;

158 
	`mem£t
(&
t
, 0, (t));

159 
	`¢d_öãrvÆ_£t_mömax
(&
t
, 
∑rm
->
mö
,Ö¨m->
max
);

160 
t
.
öãgî
 = 
ivÆ
->integer;

161  
	`¢d_öãrvÆ_ªföe
(
ivÆ
, &
t
);

164 
	}
}

169 
	$¢d_ext_∑rm_mask_ªföe
(
¢d_mask_t
 *
mask
, 
¢d_ext_∑rm
 *
∑rm
, 
ty≥
)

171 
¢d_mask_t
 
bôs
;

172 
i
;

174 
∑rm
 +
ty≥
;

175 i‡(!
∑rm
->
a˘ive
)

177 
	`mem£t
(&
bôs
, 0, (bits));

178 
i
 = 0; i < 
∑rm
->
num_li°
; i++)

179 
bôs
.bôs[
∑rm
->
li°
[
i
] / 32] |= 1U << (parm->list[i] % 32);

180  
	`¢d_mask_ªföe
(
mask
, &
bôs
);

181 
	}
}

187 
	$exçlug_hw_ªföe
(
¢d_pcm_hw_∑øms_t
 *
hw_∑øms
,

188 
¢d_ext_∑rm
 *
∑rm
)

190 
i
, 
îr
, 
ch™ge
 = 0;

191 
i
 = 0; i < 
SND_PCM_EXTPLUG_HW_PARAMS
; i++) {

192 
ty≥
 = 
hw_∑øms_ty≥
[
i
];

193 i‡(
	`is_mask_ty≥
(
i
))

194 
îr
 = 
	`¢d_ext_∑rm_mask_ªföe
(
	`hw_∑øm_mask
(
hw_∑øms
, 
ty≥
),

195 
∑rm
, 
i
);

197 
îr
 = 
	`¢d_ext_∑rm_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
hw_∑øms
, 
ty≥
),

198 
∑rm
, 
i
);

199 i‡(
îr
 < 0)

200  
îr
;

201 
ch™ge
 |
îr
;

203  
ch™ge
;

204 
	}
}

206 
	$¢d_pcm_exçlug_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
,

207 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

209 
exçlug_¥iv_t
 *
ext
 = 
pcm
->
¥iv©e_d©a
;

210 
îr
;

211 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

212 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

213 &
ac˚ss_mask
);

214 i‡(
îr
 < 0)

215  
îr
;

216 
îr
 = 
	`exçlug_hw_ªföe
(
∑øms
, 
ext
->params);

217 i‡(
îr
 < 0)

218  
îr
;

219 
∑øms
->
öfo
 &~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

221 
	}
}

223 
	$¢d_pcm_exçlug_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
,

224 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

226 
exçlug_¥iv_t
 *
ext
 = 
pcm
->
¥iv©e_d©a
;

227 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

228 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

229 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

230 &
ßc˚ss_mask
);

231 
	`exçlug_hw_ªföe
(
•¨ams
, 
ext
->sparams);

233 
	}
}

235 
	$gë_löks
(
¢d_ext_∑rm
 *
∑øms
)

237 
i
;

238 
löks
 = (
SND_PCM_HW_PARBIT_FORMAT
 |

239 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

240 
SND_PCM_HW_PARBIT_SAMPLE_BITS
 |

241 
SND_PCM_HW_PARBIT_CHANNELS
 |

242 
SND_PCM_HW_PARBIT_FRAME_BITS
 |

243 
SND_PCM_HW_PARBIT_RATE
 |

244 
SND_PCM_HW_PARBIT_PERIODS
 |

245 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

246 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

247 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

248 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

249 
SND_PCM_HW_PARBIT_TICK_TIME
);

251 
i
 = 0; i < 
SND_PCM_EXTPLUG_HW_PARAMS
; i++) {

252 i‡(
∑øms
[
i
].
a˘ive
 && !∑øms[i].
kìp_lök
)

253 
löks
 &~
ex˛_∑rbôs
[
i
];

255  
löks
;

256 
	}
}

258 
	$¢d_pcm_exçlug_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
,

259 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

260 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

262 
exçlug_¥iv_t
 *
ext
 = 
pcm
->
¥iv©e_d©a
;

263 
löks
 = 
	`gë_löks
(
ext
->
•¨ams
);

265  
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

266 
	}
}

268 
	$¢d_pcm_exçlug_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
,

269 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

270 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

272 
exçlug_¥iv_t
 *
ext
 = 
pcm
->
¥iv©e_d©a
;

273 
löks
 = 
	`gë_löks
(
ext
->
∑øms
);

275  
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

276 
	}
}

278 
	$¢d_pcm_exçlug_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

280 
îr
 = 
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

281 
¢d_pcm_exçlug_hw_ªföe_˝ª∑ª
,

282 
¢d_pcm_exçlug_hw_ªföe_cch™ge
,

283 
¢d_pcm_exçlug_hw_ªföe_•ª∑ª
,

284 
¢d_pcm_exçlug_hw_ªföe_sch™ge
,

285 
¢d_pcm_gíîic_hw_ªföe
);

286  
îr
;

287 
	}
}

292 
	$¢d_pcm_exçlug_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

295 
exçlug_¥iv_t
 *
ext
 = 
pcm
->
¥iv©e_d©a
;

296 
¢d_pcm_t
 *
¶ave
 = 
ext
->
∂ug
.
gí
.slave;

297 
îr
 = 
	`¢d_pcm_hw_∑øms_¶ave
(
pcm
, 
∑øms
,

298 
¢d_pcm_exçlug_hw_ªföe_cch™ge
,

299 
¢d_pcm_exçlug_hw_ªföe_•ª∑ª
,

300 
¢d_pcm_exçlug_hw_ªföe_sch™ge
,

301 
¢d_pcm_gíîic_hw_∑øms
);

302 i‡(
îr
 < 0)

303  
îr
;

304 
ext
->
d©a
->
¶ave_f‹m©
 = 
¶ave
->
f‹m©
;

305 
ext
->
d©a
->
¶ave_subf‹m©
 = 
¶ave
->
subf‹m©
;

306 
ext
->
d©a
->
¶ave_ch™√ls
 = 
¶ave
->
ch™√ls
;

307 
ext
->
d©a
->
øã
 = 
¶ave
->rate;

308 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(
∑øms
, &
ext
->
d©a
->
f‹m©
);

309 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_subf‹m©
)(
∑øms
, &
ext
->
d©a
->
subf‹m©
);

310 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_ch™√ls
)(
∑øms
, &
ext
->
d©a
->
ch™√ls
);

312 i‡(
ext
->
d©a
->
ˇŒback
->
hw_∑øms
) {

313 
îr
 = 
ext
->
d©a
->
ˇŒback
->
	`hw_∑øms
”xt->d©a, 
∑øms
);

314 i‡(
îr
 < 0)

315  
îr
;

318 
	}
}

323 
	$¢d_pcm_exçlug_hw_‰ì
(
¢d_pcm_t
 *
pcm
)

325 
exçlug_¥iv_t
 *
ext
 = 
pcm
->
¥iv©e_d©a
;

327 
	`¢d_pcm_hw_‰ì
(
ext
->
∂ug
.
gí
.
¶ave
);

328 i‡(
ext
->
d©a
->
ˇŒback
->
hw_‰ì
)

329  
ext
->
d©a
->
ˇŒback
->
	`hw_‰ì
(ext->data);

331 
	}
}

336 
¢d_pcm_u‰ames_t


337 
	$¢d_pcm_exçlug_wrôe_¨ós
(
¢d_pcm_t
 *
pcm
,

338 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

339 
¢d_pcm_u‰ames_t
 
off£t
,

340 
¢d_pcm_u‰ames_t
 
size
,

341 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

342 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

343 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

345 
exçlug_¥iv_t
 *
ext
 = 
pcm
->
¥iv©e_d©a
;

347 i‡(
size
 > *
¶ave_sizï
)

348 
size
 = *
¶ave_sizï
;

349 
size
 = 
ext
->
d©a
->
ˇŒback
->
	`å™s„r
”xt->d©a, 
¶ave_¨ós
, 
¶ave_off£t
,

350 
¨ós
, 
off£t
, 
size
);

351 *
¶ave_sizï
 = 
size
;

352  
size
;

353 
	}
}

358 
¢d_pcm_u‰ames_t


359 
	$¢d_pcm_exçlug_ªad_¨ós
(
¢d_pcm_t
 *
pcm
,

360 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

361 
¢d_pcm_u‰ames_t
 
off£t
,

362 
¢d_pcm_u‰ames_t
 
size
,

363 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

364 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

365 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

367 
exçlug_¥iv_t
 *
ext
 = 
pcm
->
¥iv©e_d©a
;

369 i‡(
size
 > *
¶ave_sizï
)

370 
size
 = *
¶ave_sizï
;

371 
size
 = 
ext
->
d©a
->
ˇŒback
->
	`å™s„r
”xt->d©a, 
¨ós
, 
off£t
,

372 
¶ave_¨ós
, 
¶ave_off£t
, 
size
);

373 *
¶ave_sizï
 = 
size
;

374  
size
;

375 
	}
}

380 
	$¢d_pcm_exçlug_öô
(
¢d_pcm_t
 *
pcm
)

382 
exçlug_¥iv_t
 *
ext
 = 
pcm
->
¥iv©e_d©a
;

383  
ext
->
d©a
->
ˇŒback
->
	`öô
(ext->data);

384 
	}
}

389 
	$¢d_pcm_exçlug_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

391 
exçlug_¥iv_t
 *
ext
 = 
pcm
->
¥iv©e_d©a
;

393 i‡(
ext
->
d©a
->
ˇŒback
->
dump
)

394 
ext
->
d©a
->
ˇŒback
->
	`dump
”xt->d©a, 
out
);

396 i‡(
ext
->
d©a
->
«me
)

397 
	`¢d_ouçut_¥ötf
(
out
, "%s\n", 
ext
->
d©a
->
«me
);

399 
	`¢d_ouçut_¥ötf
(
out
, "External PCM Plugin\n");

400 i‡(
pcm
->
£tup
) {

401 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

402 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

405 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

406 
	`¢d_pcm_dump
(
ext
->
∂ug
.
gí
.
¶ave
, 
out
);

407 
	}
}

409 
	$˛ór_ext_∑øms
(
exçlug_¥iv_t
 *
ext
)

411 
i
;

412 
i
 = 0; i < 
SND_PCM_EXTPLUG_HW_PARAMS
; i++) {

413 
	`¢d_ext_∑rm_˛ór
(&
ext
->
∑øms
[
i
]);

414 
	`¢d_ext_∑rm_˛ór
(&
ext
->
•¨ams
[
i
]);

416 
	}
}

418 
	$¢d_pcm_exçlug_˛o£
(
¢d_pcm_t
 *
pcm
)

420 
exçlug_¥iv_t
 *
ext
 = 
pcm
->
¥iv©e_d©a
;

422 
	`¢d_pcm_˛o£
(
ext
->
∂ug
.
gí
.
¶ave
);

423 
	`˛ór_ext_∑øms
(
ext
);

424 i‡(
ext
->
d©a
->
ˇŒback
->
˛o£
)

425 
ext
->
d©a
->
ˇŒback
->
	`˛o£
(ext->data);

426 
	`‰ì
(
ext
);

428 
	}
}

430 
¢d_pcm_chm≠_quîy_t
 **
	$¢d_pcm_exçlug_quîy_chm≠s
(
¢d_pcm_t
 *
pcm
)

432 
exçlug_¥iv_t
 *
ext
 = 
pcm
->
¥iv©e_d©a
;

434 i‡(
ext
->
d©a
->
vîsi⁄
 >= 0x010002 &&

435 
ext
->
d©a
->
ˇŒback
->
quîy_chm≠s
)

436  
ext
->
d©a
->
ˇŒback
->
	`quîy_chm≠s
(ext->data);

437  
	`¢d_pcm_gíîic_quîy_chm≠s
(
pcm
);

438 
	}
}

440 
¢d_pcm_chm≠_t
 *
	$¢d_pcm_exçlug_gë_chm≠
(
¢d_pcm_t
 *
pcm
)

442 
exçlug_¥iv_t
 *
ext
 = 
pcm
->
¥iv©e_d©a
;

444 i‡(
ext
->
d©a
->
vîsi⁄
 >= 0x010002 &&

445 
ext
->
d©a
->
ˇŒback
->
gë_chm≠
)

446  
ext
->
d©a
->
ˇŒback
->
	`gë_chm≠
(ext->data);

447  
	`¢d_pcm_gíîic_gë_chm≠
(
pcm
);

448 
	}
}

450 
	$¢d_pcm_exçlug_£t_chm≠
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_chm≠_t
 *
m≠
)

452 
exçlug_¥iv_t
 *
ext
 = 
pcm
->
¥iv©e_d©a
;

454 i‡(
ext
->
d©a
->
vîsi⁄
 >= 0x010002 &&

455 
ext
->
d©a
->
ˇŒback
->
£t_chm≠
)

456  
ext
->
d©a
->
ˇŒback
->
	`£t_chm≠
”xt->d©a, 
m≠
);

457  
	`¢d_pcm_gíîic_£t_chm≠
(
pcm
, 
m≠
);

458 
	}
}

460 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_exçlug_›s
 = {

461 .
˛o£
 = 
¢d_pcm_exçlug_˛o£
,

462 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

463 .
	ghw_ªföe
 = 
¢d_pcm_exçlug_hw_ªföe
,

464 .
	ghw_∑øms
 = 
¢d_pcm_exçlug_hw_∑øms
,

465 .
	ghw_‰ì
 = 
¢d_pcm_exçlug_hw_‰ì
,

466 .
	gsw_∑øms
 = 
¢d_pcm_gíîic_sw_∑øms
,

467 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

468 .
	gdump
 = 
¢d_pcm_exçlug_dump
,

469 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

470 .
	gasync
 = 
¢d_pcm_gíîic_async
,

471 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

472 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

473 .
	gquîy_chm≠s
 = 
¢d_pcm_exçlug_quîy_chm≠s
,

474 .
	ggë_chm≠
 = 
¢d_pcm_exçlug_gë_chm≠
,

475 .
	g£t_chm≠
 = 
¢d_pcm_exçlug_£t_chm≠
,

676 
	$¢d_pcm_exçlug_¸óã
(
¢d_pcm_exçlug_t
 *
exçlug
, c⁄° *
«me
,

677 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
¶ave_c⁄f
,

678 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

680 
exçlug_¥iv_t
 *
ext
;

681 
îr
;

682 
¢d_pcm_t
 *
•cm
, *
pcm
;

683 
¢d_c⁄fig_t
 *
sc⁄f
;

685 
	`as£π
(
roŸ
);

686 
	`as£π
(
exçlug
 &&Éxçlug->
ˇŒback
);

687 
	`as£π
(
exçlug
->
ˇŒback
->
å™s„r
);

688 
	`as£π
(
¶ave_c⁄f
);

691 i‡(
exçlug
->
vîsi⁄
 < 0x010000 ||

692 
exçlug
->
vîsi⁄
 > 
SND_PCM_EXTPLUG_VERSION
) {

693 
	`SNDERR
("extplug: Plugin version mismatch: 0x%x",

694 
exçlug
->
vîsi⁄
);

695  -
ENXIO
;

698 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave_c⁄f
, &
sc⁄f
, 0);

699 i‡(
îr
 < 0)

700  
îr
;

701 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
NULL
);

702 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

703 i‡(
îr
 < 0)

704  
îr
;

706 
ext
 = 
	`ˇŒoc
(1, (*ext));

707 i‡(! 
ext
)

708  -
ENOMEM
;

710 
ext
->
d©a
 = 
exçlug
;

711 
exçlug
->
°ªam
 = stream;

713 
	`¢d_pcm_∂ugö_öô
(&
ext
->
∂ug
);

714 
ext
->
∂ug
.
ªad
 = 
¢d_pcm_exçlug_ªad_¨ós
;

715 
ext
->
∂ug
.
wrôe
 = 
¢d_pcm_exçlug_wrôe_¨ós
;

716 
ext
->
∂ug
.
undo_ªad
 = 
¢d_pcm_∂ugö_undo_ªad_gíîic
;

717 
ext
->
∂ug
.
undo_wrôe
 = 
¢d_pcm_∂ugö_undo_wrôe_gíîic
;

718 
ext
->
∂ug
.
gí
.
¶ave
 = 
•cm
;

719 
ext
->
∂ug
.
gí
.
˛o£_¶ave
 = 1;

720 i‡(
exçlug
->
vîsi⁄
 >0x010001 &&Éxçlug->
ˇŒback
->
öô
)

721 
ext
->
∂ug
.
öô
 = 
¢d_pcm_exçlug_öô
;

723 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_EXTPLUG
, 
«me
, 
°ªam
, 
mode
);

724 i‡(
îr
 < 0) {

725 
	`‰ì
(
ext
);

726  
îr
;

729 
exçlug
->
pcm
 =Öcm;

730 
pcm
->
›s
 = &
¢d_pcm_exçlug_›s
;

731 
pcm
->
Á°_›s
 = &
¢d_pcm_∂ugö_Á°_›s
;

732 
pcm
->
¥iv©e_d©a
 = 
ext
;

733 
pcm
->
pﬁl_fd
 = 
•cm
->poll_fd;

734 
pcm
->
pﬁl_evíts
 = 
•cm
->poll_events;

735 
pcm
->
t°amp_ty≥
 = 
•cm
->tstamp_type;

736 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
ext
->
∂ug
.
hw_±r
, -1, 0);

737 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
ext
->
∂ug
.
≠∂_±r
, -1, 0);

740 
	}
}

750 
	$¢d_pcm_exçlug_dñëe
(
¢d_pcm_exçlug_t
 *
exçlug
)

752  
	`¢d_pcm_˛o£
(
exçlug
->
pcm
);

753 
	}
}

762 
	$¢d_pcm_exçlug_∑øms_ª£t
(
¢d_pcm_exçlug_t
 *
exçlug
)

764 
exçlug_¥iv_t
 *
ext
 = 
exçlug
->
pcm
->
¥iv©e_d©a
;

765 
	`˛ór_ext_∑øms
(
ext
);

766 
	}
}

780 
	$¢d_pcm_exçlug_£t_¶ave_∑øm_li°
(
¢d_pcm_exçlug_t
 *
exçlug
, 
ty≥
, 
num_li°
, c⁄° *
li°
)

782 
exçlug_¥iv_t
 *
ext
 = 
exçlug
->
pcm
->
¥iv©e_d©a
;

783 i‡(
ty≥
 < 0 ||Åy≥ >
SND_PCM_EXTPLUG_HW_PARAMS
) {

784 
	`SNDERR
("EXTPLUG: invÆidÖ¨amëîÅy≥ %d", 
ty≥
);

785  -
EINVAL
;

787  
	`¢d_ext_∑rm_£t_li°
(&
ext
->
•¨ams
[
ty≥
], 
num_li°
, 
li°
);

788 
	}
}

802 
	$¢d_pcm_exçlug_£t_¶ave_∑øm_mömax
(
¢d_pcm_exçlug_t
 *
exçlug
, 
ty≥
, 
mö
, 
max
)

804 
exçlug_¥iv_t
 *
ext
 = 
exçlug
->
pcm
->
¥iv©e_d©a
;

805 i‡(
ty≥
 < 0 ||Åy≥ >
SND_PCM_EXTPLUG_HW_PARAMS
) {

806 
	`SNDERR
("EXTPLUG: invÆidÖ¨amëîÅy≥ %d", 
ty≥
);

807  -
EINVAL
;

809 i‡(
	`is_mask_ty≥
(
ty≥
)) {

810 
	`SNDERR
("EXTPLUG: invÆidÖ¨amëîÅy≥ %d", 
ty≥
);

811  -
EINVAL
;

813  
	`¢d_ext_∑rm_£t_mömax
(&
ext
->
•¨ams
[
ty≥
], 
mö
, 
max
);

814 
	}
}

828 
	$¢d_pcm_exçlug_£t_∑øm_li°
(
¢d_pcm_exçlug_t
 *
exçlug
, 
ty≥
, 
num_li°
, c⁄° *
li°
)

830 
exçlug_¥iv_t
 *
ext
 = 
exçlug
->
pcm
->
¥iv©e_d©a
;

831 i‡(
ty≥
 < 0 ||Åy≥ >
SND_PCM_EXTPLUG_HW_PARAMS
) {

832 
	`SNDERR
("EXTPLUG: invÆidÖ¨amëîÅy≥ %d", 
ty≥
);

833  -
EINVAL
;

835  
	`¢d_ext_∑rm_£t_li°
(&
ext
->
∑øms
[
ty≥
], 
num_li°
, 
li°
);

836 
	}
}

850 
	$¢d_pcm_exçlug_£t_∑øm_mömax
(
¢d_pcm_exçlug_t
 *
exçlug
, 
ty≥
, 
mö
, 
max
)

852 
exçlug_¥iv_t
 *
ext
 = 
exçlug
->
pcm
->
¥iv©e_d©a
;

853 i‡(
ty≥
 < 0 ||Åy≥ >
SND_PCM_EXTPLUG_HW_PARAMS
) {

854 
	`SNDERR
("EXTPLUG: invÆidÖ¨amëîÅy≥ %d", 
ty≥
);

855  -
EINVAL
;

857 i‡(
	`is_mask_ty≥
(
ty≥
)) {

858 
	`SNDERR
("EXTPLUG: invÆidÖ¨amëîÅy≥ %d", 
ty≥
);

859  -
EINVAL
;

861  
	`¢d_ext_∑rm_£t_mömax
(&
ext
->
∑øms
[
ty≥
], 
mö
, 
max
);

862 
	}
}

874 
	$¢d_pcm_exçlug_£t_∑øm_lök
(
¢d_pcm_exçlug_t
 *
exçlug
, 
ty≥
,

875 
kìp_lök
)

877 
exçlug_¥iv_t
 *
ext
 = 
exçlug
->
pcm
->
¥iv©e_d©a
;

879 i‡(
ty≥
 < 0 ||Åy≥ >
SND_PCM_EXTPLUG_HW_PARAMS
) {

880 
	`SNDERR
("EXTPLUG: invÆidÖ¨amëîÅy≥ %d", 
ty≥
);

881  -
EINVAL
;

883 
ext
->
∑øms
[
ty≥
].
kìp_lök
 = keep_link ? 1 : 0;

884 
ext
->
•¨ams
[
ty≥
].
kìp_lök
 = keep_link ? 1 : 0;

886 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_file.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_∂ugö.h
"

31 
	~"bsw≠.h
"

32 
	~<˘y≥.h
>

33 
	~<°rög.h
>

35 #i‚de‡
PIC


37 c⁄° *
	g_¢d_moduÀ_pcm_fûe
 = "";

40 #i‚de‡
DOC_HIDDEN


43 
	#LEADING_KEY
 '%'

	)

44 
	#RATE_KEY
 'r'

	)

45 
	#CHANNELS_KEY
 'c'

	)

46 
	#BWIDTH_KEY
 'b'

	)

47 
	#FORMAT_KEY
 'f'

	)

50 
	#VALUE_MAXLEN
 64

	)

52 
	e_¢d_pcm_fûe_f‹m©
 {

53 
	mSND_PCM_FILE_FORMAT_RAW
,

54 
	mSND_PCM_FILE_FORMAT_WAV


55 } 
	t¢d_pcm_fûe_f‹m©_t
;

58 
	swav_fmt
 {

59 
	mfmt
;

60 
	mch™
;

61 
	møã
;

62 
	mbps
;

63 
	mbwidth
;

64 
	mbôs
;

68 
¢d_pcm_gíîic_t
 
	mgí
;

69 *
	m‚ame
;

70 *
	mföÆ_‚ame
;

71 
	måunc
;

72 
	m≥rm
;

73 
	mfd
;

74 
FILE
 *
	mpùe
;

75 *
	mi‚ame
;

76 
	mifd
;

77 
	mf‹m©
;

78 
¢d_pcm_u‰ames_t
 
	m≠∂_±r
;

79 
¢d_pcm_u‰ames_t
 
	mfûe_±r_byãs
;

80 
¢d_pcm_u‰ames_t
 
	mwbuf_size
;

81 
¢d_pcm_u‰ames_t
 
	mrbuf_size
;

82 
size_t
 
	mwbuf_size_byãs
;

83 
size_t
 
	mwbuf_u£d_byãs
;

84 *
	mwbuf
;

85 
size_t
 
	mrbuf_size_byãs
;

86 
size_t
 
	mrbuf_u£d_byãs
;

87 *
	mrbuf
;

88 
¢d_pcm_ch™√l_¨ó_t
 *
	mwbuf_¨ós
;

89 
size_t
 
	mbuf„r_byãs
;

90 
wav_fmt
 
	mwav_hódî
;

91 
size_t
 
	mfûñí
;

92 
	mifmm≠_ovîwrôãn
;

93 } 
	t¢d_pcm_fûe_t
;

95 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


96 
	#TO_LE32
(
x
Ë(x)

	)

97 
	#TO_LE16
(
x
Ë(x)

	)

99 
	#TO_LE32
(
x
Ë
	`bsw≠_32
(x)

	)

100 
	#TO_LE16
(
x
Ë
	`bsw≠_16
(x)

	)

103 
ssize_t
 
	$ß„_wrôe
(
fd
, c⁄° *
buf
, 
size_t
 
Àn
)

106 
ssize_t
 
r
 = 
	`wrôe
(
fd
, 
buf
, 
Àn
);

107 i‡(
r
 < 0) {

108 i‡(
î∫o
 =
EINTR
)

110 i‡(
î∫o
 =
EPIPE
)

111  -
EIO
;

112  -
î∫o
;

114  
r
;

116 
	}
}

118 
	$¢d_pcm_fûe_≠≥nd_vÆue
(**
°rög_p
, **
ödex_ch_p
,

119 *
Àn_p
, c⁄° *
vÆue
)

121 *
°rög
, *
ödex_ch
;

122 
ödex
, 
Àn
, 
vÆue_Àn
;

124 
Àn
 = *(
Àn_p
);

125 
°rög
 = *(
°rög_p
);

126 
ödex_ch
 = *(
ödex_ch_p
);

128 
vÆue_Àn
 = 
	`°æí
(
vÆue
);

130 
ödex
 = 
ödex_ch
 - 
°rög
;

131 
Àn
 +
vÆue_Àn
;

132 
°rög
 = 
	`ªÆloc
(°rög, 
Àn
 + 1);

133 i‡(!
°rög
)

134  -
ENOMEM
;

135 
ödex_ch
 = 
°rög
 + 
ödex
;

137 
	`°r˝y
(
ödex_ch
, 
vÆue
);

138 
ödex_ch
 +
vÆue_Àn
;

140 *(
Àn_p
Ë
Àn
;

141 *(
°rög_p
Ë
°rög
;

142 *(
ödex_ch_p
Ë
ödex_ch
;

144 
	}
}

146 
	$¢d_pcm_fûe_ª∂a˚_‚ame
(
¢d_pcm_fûe_t
 *
fûe
, **
√w_‚ame_p
)

148 
vÆue
[
VALUE_MAXLEN
];

149 *
‚ame
 = 
fûe
->fname;

150 *
√w_‚ame
 = 
NULL
;

151 *
ﬁd_œ°_ch
, *
ﬁd_ödex_ch
, *
√w_ödex_ch
;

152 
ﬁd_Àn
, 
√w_Àn
, 
îr
;

154 
¢d_pcm_t
 *
pcm
 = 
fûe
->
gí
.
¶ave
;

157 
ﬁd_Àn
 = 
√w_Àn
 = 
	`°æí
(
‚ame
);

158 
ﬁd_œ°_ch
 = 
‚ame
 + 
ﬁd_Àn
 - 1;

159 
√w_‚ame
 = 
	`mÆloc
(
√w_Àn
 + 1);

160 i‡(!
√w_‚ame
)

161  -
ENOMEM
;

163 
ﬁd_ödex_ch
 = 
‚ame
;

164 
√w_ödex_ch
 = 
√w_‚ame
;

166 
ﬁd_ödex_ch
 <
ﬁd_œ°_ch
) {

167 i‡(*(
ﬁd_ödex_ch
Ë=
LEADING_KEY
 &&

168 
ﬁd_ödex_ch
 !
ﬁd_œ°_ch
) {

171 *(++
ﬁd_ödex_ch
)) {

172 
RATE_KEY
:

173 
	`¢¥ötf
(
vÆue
, (value), "%d",

174 
pcm
->
øã
);

175 
îr
 = 
	`¢d_pcm_fûe_≠≥nd_vÆue
(&
√w_‚ame
,

176 &
√w_ödex_ch
, &
√w_Àn
, 
vÆue
);

177 i‡(
îr
 < 0)

178  
îr
;

181 
CHANNELS_KEY
:

182 
	`¢¥ötf
(
vÆue
, (value), "%d",

183 
pcm
->
ch™√ls
);

184 
îr
 = 
	`¢d_pcm_fûe_≠≥nd_vÆue
(&
√w_‚ame
,

185 &
√w_ödex_ch
, &
√w_Àn
, 
vÆue
);

186 i‡(
îr
 < 0)

187  
îr
;

190 
BWIDTH_KEY
:

191 
	`¢¥ötf
(
vÆue
, (value), "%d",

192 
pcm
->
‰ame_bôs
/pcm->
ch™√ls
);

193 
îr
 = 
	`¢d_pcm_fûe_≠≥nd_vÆue
(&
√w_‚ame
,

194 &
√w_ödex_ch
, &
√w_Àn
, 
vÆue
);

195 i‡(
îr
 < 0)

196  
îr
;

199 
FORMAT_KEY
:

200 
îr
 = 
	`¢d_pcm_fûe_≠≥nd_vÆue
(&
√w_‚ame
,

201 &
√w_ödex_ch
, &
√w_Àn
,

202 
	`¢d_pcm_f‹m©_«me
(
pcm
->
f‹m©
));

203 i‡(
îr
 < 0)

204  
îr
;

209 *(
√w_ödex_ch
++Ë*(
ﬁd_ödex_ch
);

212 
ﬁd_ödex_ch
++;

215 *(
√w_ödex_ch
++Ë*(
ﬁd_ödex_ch
++);

219 *(
√w_ödex_ch
) = '\0';

220 *(
√w_‚ame_p
Ë
√w_‚ame
;

223 
	}
}

225 
	$¢d_pcm_fûe_›í_ouçut_fûe
(
¢d_pcm_fûe_t
 *
fûe
)

227 
îr
, 
fd
;

230 
îr
 = 
	`¢d_pcm_fûe_ª∂a˚_‚ame
(
fûe
, &(fûe->
föÆ_‚ame
));

231 i‡(
îr
 < 0)

232  
îr
;

236 i‡(
fûe
->
föÆ_‚ame
[0] == '|') {

238 
FILE
 *
pùe
;

240 
pùe
 = 
	`p›í
(
fûe
->
föÆ_‚ame
 + 1, "w");

241 i‡(!
pùe
) {

242 
	`SYSERR
("running %s for writing failed",

243 
fûe
->
föÆ_‚ame
);

244  -
î∫o
;

246 
fd
 = 
	`fûío
(
pùe
);

247 
fûe
->
pùe
 =Öipe;

249 
fûe
->
pùe
 = 
NULL
;

250 i‡(
fûe
->
åunc
)

251 
fd
 = 
	`›í
(
fûe
->
föÆ_‚ame
, 
O_WRONLY
|
O_CREAT
|
O_TRUNC
,

252 
fûe
->
≥rm
);

254 
fd
 = 
	`›í
(
fûe
->
föÆ_‚ame
, 
O_WRONLY
|
O_CREAT
|
O_EXCL
,

255 
fûe
->
≥rm
);

256 i‡(
fd
 < 0) {

257 *
tmp‚ame
 = 
NULL
;

258 
idx
, 
Àn
;

259 
Àn
 = 
	`°æí
(
fûe
->
föÆ_‚ame
) + 6;

260 
tmp‚ame
 = 
	`mÆloc
(
Àn
);

261 i‡(!
tmp‚ame
)

262  -
ENOMEM
;

263 
idx
 = 1; idx < 10000; idx++) {

264 
	`¢¥ötf
(
tmp‚ame
, 
Àn
,

265 "%s.%04d", 
fûe
->
föÆ_‚ame
,

266 
idx
);

267 
fd
 = 
	`›í
(
tmp‚ame
,

268 
O_WRONLY
|
O_CREAT
|
O_EXCL
,

269 
fûe
->
≥rm
);

270 i‡(
fd
 >= 0) {

271 
	`‰ì
(
fûe
->
föÆ_‚ame
);

272 
fûe
->
föÆ_‚ame
 = 
tmp‚ame
;

276 i‡(
fd
 < 0) {

277 
	`SYSERR
("open %s for writing failed",

278 
fûe
->
föÆ_‚ame
);

279 
	`‰ì
(
tmp‚ame
);

280  -
î∫o
;

285 
fûe
->
fd
 = fd;

287 
	}
}

290 
	$¢d_pcm_fûe_¨ós_ªad_öfûe
(
¢d_pcm_t
 *
pcm
,

291 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

292 
¢d_pcm_u‰ames_t
 
off£t
,

293 
¢d_pcm_u‰ames_t
 
‰ames
)

295 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

296 
¢d_pcm_ch™√l_¨ó_t
 
¨ós_if
[
pcm
->
ch™√ls
];

297 
ssize_t
 
byãs
;

299 i‡(
fûe
->
ifd
 < 0)

300  -
EBADF
;

302 i‡(
fûe
->
rbuf
 =
NULL
)

303  -
ENOMEM
;

305 i‡(
fûe
->
rbuf_size
 < 
‰ames
) {

306 
	`SYSERR
("requested more framesÅhanÖcm buffer");

307  -
ENOMEM
;

310 
byãs
 = 
	`¢d_pcm_‰ames_to_byãs
(
pcm
, 
‰ames
);

311 i‡(
byãs
 < 0)

312  
byãs
;

313 
byãs
 = 
	`ªad
(
fûe
->
ifd
, fûe->
rbuf
, bytes);

314 i‡(
byãs
 < 0) {

315 
	`SYSERR
("ªad from fûêÁûed,Éº‹: %d", 
byãs
);

316  
byãs
;

319 
	`¢d_pcm_¨ós_‰om_buf
(
pcm
, 
¨ós_if
, 
fûe
->
rbuf
);

320 
	`¢d_pcm_¨ós_c›y
(
¨ós
, 
off£t
, 
¨ós_if
, 0, 
pcm
->
ch™√ls
, 
	`¢d_pcm_byãs_to_‰ames
’cm, 
byãs
),Öcm->
f‹m©
);

322  
byãs
;

323 
	}
}

325 
	$£tup_wav_hódî
(
¢d_pcm_t
 *
pcm
, 
wav_fmt
 *
fmt
)

327 
fmt
->fmà
	`TO_LE16
(0x01);

328 
fmt
->
ch™
 = 
	`TO_LE16
(
pcm
->
ch™√ls
);

329 
fmt
->
øã
 = 
	`TO_LE32
(
pcm
->rate);

330 
fmt
->
bwidth
 = 
pcm
->
‰ame_bôs
 / 8;

331 
fmt
->
bps
 = fmt->
bwidth
 * 
pcm
->
øã
;

332 
fmt
->
bôs
 = 
	`¢d_pcm_f‹m©_width
(
pcm
->
f‹m©
);

333 
fmt
->
bps
 = 
	`TO_LE32
(fmt->bps);

334 
fmt
->
bwidth
 = 
	`TO_LE16
(fmt->bwidth);

335 
fmt
->
bôs
 = 
	`TO_LE16
(fmt->bits);

336 
	}
}

338 
	$wrôe_wav_hódî
(
¢d_pcm_t
 *
pcm
)

340 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

341 
ssize_t
 
ªs
;

343 c⁄° 
hódî
[] = {

350 c⁄° 
hódî2
[] = {

355 
	`£tup_wav_hódî
(
pcm
, &
fûe
->
wav_hódî
);

357 
ªs
 = 
	`ß„_wrôe
(
fûe
->
fd
, 
hódî
, (header));

358 i‡(
ªs
 !(
hódî
))

359 
wrôe_îr‹
;

361 
ªs
 = 
	`ß„_wrôe
(
fûe
->
fd
, &fûe->
wav_hódî
, (file->wav_header));

362 i‡(
ªs
 !(
fûe
->
wav_hódî
))

363 
wrôe_îr‹
;

365 
ªs
 = 
	`ß„_wrôe
(
fûe
->
fd
, 
hódî2
, (header2));

366 i‡(
ªs
 !(
hódî2
))

367 
wrôe_îr‹
;

371 
wrôe_îr‹
:

378 i‡(
ªs
 < 0)

379 
	`SYSERR
("%†wrôêhódî faûed, fûêd©®may bêc‹ru±", 
fûe
->
‚ame
);

381 
	`SNDERR
("%†wrôêhódî incom∂ëe, fûêd©®may bêc‹ru±", 
fûe
->
‚ame
);

383 
	`mem£t
(&
fûe
->
wav_hódî
, 0, (
wav_fmt
));

385  -
EIO
;

386 
	}
}

389 
	$fixup_wav_hódî
(
¢d_pcm_t
 *
pcm
)

391 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

392 
Àn
, 
ªt
;

395 i‡(
	`l£ek
(
fûe
->
fd
, 4, 
SEEK_SET
) == 4) {

396 
Àn
 = (
fûe
->
fûñí
 + 0x24) > 0x7fffffff ?

397 0x7ffffff‡: ()(
fûe
->
fûñí
 + 0x24);

398 
Àn
 = 
	`TO_LE32
(len);

399 
ªt
 = 
	`ß„_wrôe
(
fûe
->
fd
, &
Àn
, 4);

400 i‡(
ªt
 < 0)

404 i‡(
	`l£ek
(
fûe
->
fd
, 0x28, 
SEEK_SET
) == 0x28) {

405 
Àn
 = 
fûe
->
fûñí
 > 0x7fffffff ?

406 0x7ffffff‡: ()
fûe
->
fûñí
;

407 
Àn
 = 
	`TO_LE32
(len);

408 
ªt
 = 
	`ß„_wrôe
(
fûe
->
fd
, &
Àn
, 4);

409 i‡(
ªt
 < 0)

412 
	}
}

418 
	$¢d_pcm_fûe_wrôe_byãs
(
¢d_pcm_t
 *
pcm
, 
size_t
 
byãs
)

420 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

421 
¢d_pcm_s‰ames_t
 
îr
 = 0;

422 
	`as£π
(
byãs
 <
fûe
->
wbuf_u£d_byãs
);

424 i‡(
fûe
->
f‹m©
 =
SND_PCM_FILE_FORMAT_WAV
 &&

425 !
fûe
->
wav_hódî
.
fmt
) {

426 
îr
 = 
	`wrôe_wav_hódî
(
pcm
);

427 i‡(
îr
 < 0) {

428 
fûe
->
wbuf_u£d_byãs
 = 0;

429 
fûe
->
fûe_±r_byãs
 = 0;

430  
îr
;

434 
byãs
 > 0) {

435 
size_t
 
n
 = 
byãs
;

436 
size_t
 
c⁄t
 = 
fûe
->
wbuf_size_byãs
 - fûe->
fûe_±r_byãs
;

437 i‡(
n
 > 
c⁄t
)

438 
n
 = 
c⁄t
;

439 
îr
 = 
	`ß„_wrôe
(
fûe
->
fd
, fûe->
wbuf
 + fûe->
fûe_±r_byãs
, 
n
);

440 i‡(
îr
 < 0) {

441 
fûe
->
wbuf_u£d_byãs
 = 0;

442 
fûe
->
fûe_±r_byãs
 = 0;

443 
	`SYSERR
("%†wrôêÁûed, fûêd©®may bêc‹ru±", 
fûe
->
‚ame
);

444  
îr
;

446 
byãs
 -
îr
;

447 
fûe
->
wbuf_u£d_byãs
 -
îr
;

448 
fûe
->
fûe_±r_byãs
 +
îr
;

449 i‡(
fûe
->
fûe_±r_byãs
 =fûe->
wbuf_size_byãs
)

450 
fûe
->
fûe_±r_byãs
 = 0;

451 
fûe
->
fûñí
 +
îr
;

452 i‡((
¢d_pcm_u‰ames_t
)
îr
 !
n
)

456 
	}
}

458 
	$¢d_pcm_fûe_add_‰ames
(
¢d_pcm_t
 *
pcm
,

459 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

460 
¢d_pcm_u‰ames_t
 
off£t
,

461 
¢d_pcm_u‰ames_t
 
‰ames
)

463 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

464 
‰ames
 > 0) {

465 
îr
 = 0;

466 
¢d_pcm_u‰ames_t
 
n
 = 
‰ames
;

467 
¢d_pcm_u‰ames_t
 
c⁄t
 = 
fûe
->
wbuf_size
 - fûe->
≠∂_±r
;

468 
¢d_pcm_u‰ames_t
 
avaû
 = 
fûe
->
wbuf_size
 - 
	`¢d_pcm_byãs_to_‰ames
(
pcm
, fûe->
wbuf_u£d_byãs
);

469 i‡(
n
 > 
c⁄t
)

470 
n
 = 
c⁄t
;

471 i‡(
n
 > 
avaû
)

472 
n
 = 
avaû
;

473 
	`¢d_pcm_¨ós_c›y
(
fûe
->
wbuf_¨ós
, fûe->
≠∂_±r
,

474 
¨ós
, 
off£t
,

475 
pcm
->
ch™√ls
, 
n
,Öcm->
f‹m©
);

476 
‰ames
 -
n
;

477 
off£t
 +
n
;

478 
fûe
->
≠∂_±r
 +
n
;

479 i‡(
fûe
->
≠∂_±r
 =fûe->
wbuf_size
)

480 
fûe
->
≠∂_±r
 = 0;

481 
fûe
->
wbuf_u£d_byãs
 +
	`¢d_pcm_‰ames_to_byãs
(
pcm
, 
n
);

482 i‡(
fûe
->
wbuf_u£d_byãs
 > fûe->
buf„r_byãs
) {

483 
îr
 = 
	`¢d_pcm_fûe_wrôe_byãs
(
pcm
, 
fûe
->
wbuf_u£d_byãs
 - fûe->
buf„r_byãs
);

484 i‡(
îr
 < 0)

485  
îr
;

487 
	`as£π
(
fûe
->
wbuf_u£d_byãs
 < fûe->
wbuf_size_byãs
);

490 
	}
}

492 
	$¢d_pcm_fûe_˛o£
(
¢d_pcm_t
 *
pcm
)

494 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

495 i‡(
fûe
->
‚ame
) {

496 i‡(
fûe
->
wav_hódî
.
fmt
)

497 
	`fixup_wav_hódî
(
pcm
);

498 
	`‰ì
((*)
fûe
->
‚ame
);

499 i‡(
fûe
->
pùe
) {

500 
	`p˛o£
(
fûe
->
pùe
);

501 } i‡(
fûe
->
fd
 >= 0) {

502 
	`˛o£
(
fûe
->
fd
);

505 i‡(
fûe
->
i‚ame
) {

506 
	`‰ì
((*)
fûe
->
i‚ame
);

507 
	`˛o£
(
fûe
->
ifd
);

509  
	`¢d_pcm_gíîic_˛o£
(
pcm
);

510 
	}
}

512 
	$¢d_pcm_fûe_ª£t
(
¢d_pcm_t
 *
pcm
)

514 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

515 
îr
 = 
	`¢d_pcm_ª£t
(
fûe
->
gí
.
¶ave
);

516 i‡(
îr
 >= 0) {

518 
	`¢d_pcm_fûe_wrôe_byãs
(
pcm
, 
fûe
->
wbuf_u£d_byãs
);

519 
	`as£π
(
fûe
->
wbuf_u£d_byãs
 == 0);

521  
îr
;

522 
	}
}

524 
	$¢d_pcm_fûe_dr›
(
¢d_pcm_t
 *
pcm
)

526 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

527 
îr
 = 
	`¢d_pcm_dr›
(
fûe
->
gí
.
¶ave
);

528 i‡(
îr
 >= 0) {

530 
	`¢d_pcm_fûe_wrôe_byãs
(
pcm
, 
fûe
->
wbuf_u£d_byãs
);

531 
	`as£π
(
fûe
->
wbuf_u£d_byãs
 == 0);

533  
îr
;

534 
	}
}

537 
	$¢d_pcm_fûe_døö
(
¢d_pcm_t
 *
pcm
)

539 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

540 
îr
 = 
	`¢d_pcm_døö
(
fûe
->
gí
.
¶ave
);

541 i‡(
îr
 >= 0) {

542 
	`__¢d_pcm_lock
(
pcm
);

543 
	`¢d_pcm_fûe_wrôe_byãs
(
pcm
, 
fûe
->
wbuf_u£d_byãs
);

544 
	`as£π
(
fûe
->
wbuf_u£d_byãs
 == 0);

545 
	`__¢d_pcm_u∆ock
(
pcm
);

547  
îr
;

548 
	}
}

550 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_fûe_ªwödabÀ
(
¢d_pcm_t
 *
pcm
)

552 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

553 
¢d_pcm_s‰ames_t
 
ªs
 = 
	`¢d_pcm_ªwödabÀ
(
fûe
->
gí
.
¶ave
);

554 
¢d_pcm_s‰ames_t
 
n
 = 
	`¢d_pcm_byãs_to_‰ames
(
pcm
, 
fûe
->
wbuf_u£d_byãs
);

555 i‡(
ªs
 > 
n
)

556 
ªs
 = 
n
;

557  
ªs
;

558 
	}
}

560 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_fûe_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

562 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

563 
¢d_pcm_s‰ames_t
 
îr
;

564 
¢d_pcm_u‰ames_t
 
n
;

566 
n
 = 
	`¢d_pcm_‰ames_to_byãs
(
pcm
, 
‰ames
);

567 i‡(
n
 > 
fûe
->
wbuf_u£d_byãs
)

568 
‰ames
 = 
	`¢d_pcm_byãs_to_‰ames
(
pcm
, 
fûe
->
wbuf_u£d_byãs
);

569 
îr
 = 
	`¢d_pcm_ªwöd
(
fûe
->
gí
.
¶ave
, 
‰ames
);

570 i‡(
îr
 > 0) {

571 
fûe
->
≠∂_±r
 = (fûe->≠∂_±∏- 
îr
 + fûe->
wbuf_size
) % file->wbuf_size;

572 
n
 = 
	`¢d_pcm_‰ames_to_byãs
(
pcm
, 
îr
);

573 
fûe
->
wbuf_u£d_byãs
 -
n
;

575  
îr
;

576 
	}
}

578 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_fûe_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
)

580 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

581 
¢d_pcm_s‰ames_t
 
ªs
 = 
	`¢d_pcm_f‹w¨dabÀ
(
fûe
->
gí
.
¶ave
);

582 
¢d_pcm_s‰ames_t
 
n
 = 
	`¢d_pcm_byãs_to_‰ames
(
pcm
, 
fûe
->
wbuf_size_byãs
 - fûe->
wbuf_u£d_byãs
);

583 i‡(
ªs
 > 
n
)

584 
ªs
 = 
n
;

585  
ªs
;

586 
	}
}

588 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_fûe_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

590 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

591 
¢d_pcm_s‰ames_t
 
îr
;

592 
¢d_pcm_u‰ames_t
 
n
;

594 
n
 = 
	`¢d_pcm_‰ames_to_byãs
(
pcm
, 
‰ames
);

595 i‡(
fûe
->
wbuf_u£d_byãs
 + 
n
 > fûe->
wbuf_size_byãs
)

596 
‰ames
 = 
	`¢d_pcm_byãs_to_‰ames
(
pcm
, 
fûe
->
wbuf_size_byãs
 - fûe->
wbuf_u£d_byãs
);

597 
îr
 = 
	`INTERNAL
(
¢d_pcm_f‹w¨d
)(
fûe
->
gí
.
¶ave
, 
‰ames
);

598 i‡(
îr
 > 0) {

599 
fûe
->
≠∂_±r
 = (fûe->≠∂_±∏+ 
îr
Ë% fûe->
wbuf_size
;

600 
n
 = 
	`¢d_pcm_‰ames_to_byãs
(
pcm
, 
îr
);

601 
fûe
->
wbuf_u£d_byãs
 +
n
;

603  
îr
;

604 
	}
}

607 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_fûe_wrôei
(
¢d_pcm_t
 *
pcm
, c⁄° *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

609 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

610 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

611 
¢d_pcm_s‰ames_t
 
n
 = 
	`_¢d_pcm_wrôei
(
fûe
->
gí
.
¶ave
, 
buf„r
, 
size
);

612 i‡(
n
 > 0) {

613 
	`¢d_pcm_¨ós_‰om_buf
(
pcm
, 
¨ós
, (*Ë
buf„r
);

614 
	`__¢d_pcm_lock
(
pcm
);

615 i‡(
	`¢d_pcm_fûe_add_‰ames
(
pcm
, 
¨ós
, 0, 
n
) < 0) {

616 
	`__¢d_pcm_u∆ock
(
pcm
);

617  -
EIO
;

619 
	`__¢d_pcm_u∆ock
(
pcm
);

621  
n
;

622 
	}
}

625 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_fûe_wrôí
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

627 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

628 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

629 
¢d_pcm_s‰ames_t
 
n
 = 
	`_¢d_pcm_wrôí
(
fûe
->
gí
.
¶ave
, 
bufs
, 
size
);

630 i‡(
n
 > 0) {

631 
	`¢d_pcm_¨ós_‰om_bufs
(
pcm
, 
¨ós
, 
bufs
);

632 
	`__¢d_pcm_lock
(
pcm
);

633 i‡(
	`¢d_pcm_fûe_add_‰ames
(
pcm
, 
¨ós
, 0, 
n
) < 0) {

634 
	`__¢d_pcm_u∆ock
(
pcm
);

635  -
EIO
;

637 
	`__¢d_pcm_u∆ock
(
pcm
);

639  
n
;

640 
	}
}

643 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_fûe_ªadi
(
¢d_pcm_t
 *
pcm
, *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

645 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

646 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

647 
¢d_pcm_s‰ames_t
 
‰ames
;

649 
‰ames
 = 
	`_¢d_pcm_ªadi
(
fûe
->
gí
.
¶ave
, 
buf„r
, 
size
);

650 i‡(
‰ames
 <= 0)

651  
‰ames
;

653 
	`¢d_pcm_¨ós_‰om_buf
(
pcm
, 
¨ós
, 
buf„r
);

654 
	`¢d_pcm_fûe_¨ós_ªad_öfûe
(
pcm
, 
¨ós
, 0, 
‰ames
);

655 
	`__¢d_pcm_lock
(
pcm
);

656 i‡(
	`¢d_pcm_fûe_add_‰ames
(
pcm
, 
¨ós
, 0, 
‰ames
) < 0) {

657 
	`__¢d_pcm_u∆ock
(
pcm
);

658  -
EIO
;

661 
	`__¢d_pcm_u∆ock
(
pcm
);

663  
‰ames
;

664 
	}
}

667 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_fûe_ªadn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

669 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

670 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

671 
¢d_pcm_s‰ames_t
 
‰ames
;

673 
‰ames
 = 
	`_¢d_pcm_ªadn
(
fûe
->
gí
.
¶ave
, 
bufs
, 
size
);

674 i‡(
‰ames
 <= 0)

675  
‰ames
;

677 
	`¢d_pcm_¨ós_‰om_bufs
(
pcm
, 
¨ós
, 
bufs
);

678 
	`¢d_pcm_fûe_¨ós_ªad_öfûe
(
pcm
, 
¨ós
, 0, 
‰ames
);

679 
	`__¢d_pcm_lock
(
pcm
);

680 i‡(
	`¢d_pcm_fûe_add_‰ames
(
pcm
, 
¨ós
, 0, 
‰ames
) < 0) {

681 
	`__¢d_pcm_u∆ock
(
pcm
);

682  -
EIO
;

685 
	`__¢d_pcm_u∆ock
(
pcm
);

687  
‰ames
;

688 
	}
}

690 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_fûe_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

691 
¢d_pcm_u‰ames_t
 
off£t
,

692 
¢d_pcm_u‰ames_t
 
size
)

694 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

695 
¢d_pcm_u‰ames_t
 
ofs
;

696 
¢d_pcm_u‰ames_t
 
siz
 = 
size
;

697 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
;

698 
¢d_pcm_s‰ames_t
 
ªsu…
;

700 
fûe
->
ifmm≠_ovîwrôãn
 = 0;

702 
ªsu…
 = 
	`¢d_pcm_mm≠_begö
(
fûe
->
gí
.
¶ave
, &
¨ós
, &
ofs
, &
siz
);

703 i‡(
ªsu…
 >= 0) {

704 
	`as£π
(
ofs
 =
off£t
 && 
siz
 =
size
);

705 
ªsu…
 = 
	`¢d_pcm_mm≠_commô
(
fûe
->
gí
.
¶ave
, 
ofs
, 
siz
);

706 i‡(
ªsu…
 > 0) {

707 i‡(
	`¢d_pcm_fûe_add_‰ames
(
pcm
, 
¨ós
, 
ofs
, 
ªsu…
) < 0)

708  -
EIO
;

711  
ªsu…
;

712 
	}
}

714 
	$¢d_pcm_fûe_mm≠_begö
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_ch™√l_¨ó_t
 **
¨ós
,

715 
¢d_pcm_u‰ames_t
 *
off£t
, snd_pcm_u‰ames_à*
‰ames
)

717 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

718 
ªsu…
;

720 
ªsu…
 = 
	`¢d_pcm_mm≠_begö
(
fûe
->
gí
.
¶ave
, 
¨ós
, 
off£t
, 
‰ames
);

721 i‡(
ªsu…
 < 0)

722  
ªsu…
;

724 i‡(
pcm
->
°ªam
 !
SND_PCM_STREAM_CAPTURE
)

725  
ªsu…
;

728 i‡(
fûe
->
ifmm≠_ovîwrôãn
)

729  
ªsu…
;

730 
fûe
->
ifmm≠_ovîwrôãn
 = 1;

732 
	`¢d_pcm_fûe_¨ós_ªad_öfûe
(
pcm
, *
¨ós
, *
off£t
, *
‰ames
);

734  
ªsu…
;

735 
	}
}

737 
	$¢d_pcm_fûe_hw_‰ì
(
¢d_pcm_t
 *
pcm
)

739 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

740 
	`‰ì
(
fûe
->
wbuf
);

741 
	`‰ì
(
fûe
->
wbuf_¨ós
);

742 
	`‰ì
(
fûe
->
föÆ_‚ame
);

743 
	`‰ì
(
fûe
->
rbuf
);

744 
fûe
->
wbuf
 = 
NULL
;

745 
fûe
->
wbuf_¨ós
 = 
NULL
;

746 
fûe
->
föÆ_‚ame
 = 
NULL
;

747 
fûe
->
rbuf
 = 
NULL
;

748  
	`¢d_pcm_hw_‰ì
(
fûe
->
gí
.
¶ave
);

749 
	}
}

751 
	$¢d_pcm_fûe_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 * 
∑øms
)

753 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

754 
ch™√l
;

755 
¢d_pcm_t
 *
¶ave
 = 
fûe
->
gí
.slave;

756 
îr
 = 
	`_¢d_pcm_hw_∑øms_öã∫Æ
(
¶ave
, 
∑øms
);

757 i‡(
îr
 < 0)

758  
îr
;

759 
fûe
->
buf„r_byãs
 = 
	`¢d_pcm_‰ames_to_byãs
(
¶ave
, sœve->
buf„r_size
);

760 
fûe
->
wbuf_size
 = 
¶ave
->
buf„r_size
 * 2;

761 
fûe
->
wbuf_size_byãs
 = 
	`¢d_pcm_‰ames_to_byãs
(
¶ave
, fûe->
wbuf_size
);

762 
fûe
->
wbuf_u£d_byãs
 = 0;

763 
fûe
->
ifmm≠_ovîwrôãn
 = 0;

764 
	`as£π
(!
fûe
->
wbuf
);

765 
fûe
->
wbuf
 = 
	`mÆloc
(fûe->
wbuf_size_byãs
);

766 i‡(
fûe
->
wbuf
 =
NULL
) {

767 
	`¢d_pcm_fûe_hw_‰ì
(
pcm
);

768  -
ENOMEM
;

770 
fûe
->
wbuf_¨ós
 = 
	`mÆloc
((*fûe->wbuf_¨ósË* 
¶ave
->
ch™√ls
);

771 i‡(
fûe
->
wbuf_¨ós
 =
NULL
) {

772 
	`¢d_pcm_fûe_hw_‰ì
(
pcm
);

773  -
ENOMEM
;

775 
	`as£π
(!
fûe
->
rbuf
);

776 
fûe
->
rbuf_size
 = 
¶ave
->
buf„r_size
;

777 
fûe
->
rbuf_size_byãs
 = 
	`¢d_pcm_‰ames_to_byãs
(
¶ave
, fûe->
rbuf_size
);

778 
fûe
->
rbuf_u£d_byãs
 = 0;

779 
fûe
->
rbuf
 = 
	`mÆloc
(fûe->
rbuf_size_byãs
);

780 i‡(
fûe
->
rbuf
 =
NULL
) {

781 
	`¢d_pcm_fûe_hw_‰ì
(
pcm
);

782  -
ENOMEM
;

784 
fûe
->
≠∂_±r
 = fûe->
fûe_±r_byãs
 = 0;

785 
ch™√l
 = 0; ch™√»< 
¶ave
->
ch™√ls
; ++channel) {

786 
¢d_pcm_ch™√l_¨ó_t
 *
a
 = &
fûe
->
wbuf_¨ós
[
ch™√l
];

787 
a
->
addr
 = 
fûe
->
wbuf
;

788 
a
->
fú°
 = 
¶ave
->
ßm∂e_bôs
 * 
ch™√l
;

789 
a
->
°ï
 = 
¶ave
->
‰ame_bôs
;

791 i‡(
fûe
->
fd
 < 0) {

792 
îr
 = 
	`¢d_pcm_fûe_›í_ouçut_fûe
(
fûe
);

793 i‡(
îr
 < 0) {

794 
	`SYSERR
("Áûed o≥nög ouçuàfûê%s", 
fûe
->
‚ame
);

795  
îr
;

800 
	`¢d_pcm_u∆ök_hw_±r
(
pcm
, 
fûe
->
gí
.
¶ave
);

801 
	`¢d_pcm_u∆ök_≠∂_±r
(
pcm
, 
fûe
->
gí
.
¶ave
);

803 
	`¢d_pcm_lök_hw_±r
(
pcm
, 
fûe
->
gí
.
¶ave
);

804 
	`¢d_pcm_lök_≠∂_±r
(
pcm
, 
fûe
->
gí
.
¶ave
);

807 
	}
}

809 
	$¢d_pcm_fûe_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

811 
¢d_pcm_fûe_t
 *
fûe
 = 
pcm
->
¥iv©e_d©a
;

812 i‡(
fûe
->
‚ame
)

813 
	`¢d_ouçut_¥ötf
(
out
, "FûêPCM (fûe=%s)\n", 
fûe
->
‚ame
);

815 
	`¢d_ouçut_¥ötf
(
out
, "FûêPCM (fd=%d)\n", 
fûe
->
fd
);

816 i‡(
fûe
->
föÆ_‚ame
)

817 
	`¢d_ouçut_¥ötf
(
out
, "Final file PCM (file=%s)\n",

818 
fûe
->
föÆ_‚ame
);

820 i‡(
pcm
->
£tup
) {

821 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

822 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

824 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

825 
	`¢d_pcm_dump
(
fûe
->
gí
.
¶ave
, 
out
);

826 
	}
}

828 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_fûe_›s
 = {

829 .
˛o£
 = 
¢d_pcm_fûe_˛o£
,

830 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

831 .
	ghw_ªföe
 = 
¢d_pcm_gíîic_hw_ªföe
,

832 .
	ghw_∑øms
 = 
¢d_pcm_fûe_hw_∑øms
,

833 .
	ghw_‰ì
 = 
¢d_pcm_fûe_hw_‰ì
,

834 .
	gsw_∑øms
 = 
¢d_pcm_gíîic_sw_∑øms
,

835 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

836 .
	gdump
 = 
¢d_pcm_fûe_dump
,

837 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

838 .
	gasync
 = 
¢d_pcm_gíîic_async
,

839 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

840 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

841 .
	gquîy_chm≠s
 = 
¢d_pcm_gíîic_quîy_chm≠s
,

842 .
	ggë_chm≠
 = 
¢d_pcm_gíîic_gë_chm≠
,

843 .
	g£t_chm≠
 = 
¢d_pcm_gíîic_£t_chm≠
,

846 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_fûe_Á°_›s
 = {

847 .
°©us
 = 
¢d_pcm_gíîic_°©us
,

848 .
	g°©e
 = 
¢d_pcm_gíîic_°©e
,

849 .
	ghwsync
 = 
¢d_pcm_gíîic_hwsync
,

850 .
	gdñay
 = 
¢d_pcm_gíîic_dñay
,

851 .
	g¥ï¨e
 = 
¢d_pcm_gíîic_¥ï¨e
,

852 .
	gª£t
 = 
¢d_pcm_fûe_ª£t
,

853 .
	g°¨t
 = 
¢d_pcm_gíîic_°¨t
,

854 .
	gdr›
 = 
¢d_pcm_fûe_dr›
,

855 .
	gdøö
 = 
¢d_pcm_fûe_døö
,

856 .
	g∑u£
 = 
¢d_pcm_gíîic_∑u£
,

857 .
	gªwödabÀ
 = 
¢d_pcm_fûe_ªwödabÀ
,

858 .
	gªwöd
 = 
¢d_pcm_fûe_ªwöd
,

859 .
	gf‹w¨dabÀ
 = 
¢d_pcm_fûe_f‹w¨dabÀ
,

860 .
	gf‹w¨d
 = 
¢d_pcm_fûe_f‹w¨d
,

861 .
	gªsume
 = 
¢d_pcm_gíîic_ªsume
,

862 .
	glök
 = 
¢d_pcm_gíîic_lök
,

863 .
	glök_¶aves
 = 
¢d_pcm_gíîic_lök_¶aves
,

864 .
	gu∆ök
 = 
¢d_pcm_gíîic_u∆ök
,

865 .
	gwrôei
 = 
¢d_pcm_fûe_wrôei
,

866 .
	gwrôí
 = 
¢d_pcm_fûe_wrôí
,

867 .
	gªadi
 = 
¢d_pcm_fûe_ªadi
,

868 .
	gªadn
 = 
¢d_pcm_fûe_ªadn
,

869 .
	gavaû_upd©e
 = 
¢d_pcm_gíîic_avaû_upd©e
,

870 .
	gmm≠_commô
 = 
¢d_pcm_fûe_mm≠_commô
,

871 .
	gpﬁl_des¸ùt‹s_cou¡
 = 
¢d_pcm_gíîic_pﬁl_des¸ùt‹s_cou¡
,

872 .
	gpﬁl_des¸ùt‹s
 = 
¢d_pcm_gíîic_pﬁl_des¸ùt‹s
,

873 .
	gpﬁl_ªvíts
 = 
¢d_pcm_gíîic_pﬁl_ªvíts
,

874 .
	ghtime°amp
 = 
¢d_pcm_gíîic_htime°amp
,

875 .
	gmm≠_begö
 = 
¢d_pcm_fûe_mm≠_begö
,

898 
	$¢d_pcm_fûe_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

899 c⁄° *
‚ame
, 
fd
, c⁄° *
i‚ame
, 
ifd
,

900 
åunc
,

901 c⁄° *
fmt
, 
≥rm
, 
¢d_pcm_t
 *
¶ave
, 
˛o£_¶ave
,

902 
¢d_pcm_°ªam_t
 
°ªam
)

904 
¢d_pcm_t
 *
pcm
;

905 
¢d_pcm_fûe_t
 *
fûe
;

906 
¢d_pcm_fûe_f‹m©_t
 
f‹m©
;

907 
time•ec
Åimespec;

908 
îr
;

910 
	`as£π
(
pcmp
);

911 i‡(
fmt
 =
NULL
 ||

912 
	`°rcmp
(
fmt
, "raw") == 0)

913 
f‹m©
 = 
SND_PCM_FILE_FORMAT_RAW
;

914 i‡(!
	`°rcmp
(
fmt
, "wav"))

915 
f‹m©
 = 
SND_PCM_FILE_FORMAT_WAV
;

917 
	`SNDERR
("fûêf‹m© %†i†unknown", 
fmt
);

918  -
EINVAL
;

920 
fûe
 = 
	`ˇŒoc
(1, (
¢d_pcm_fûe_t
));

921 i‡(!
fûe
) {

922  -
ENOMEM
;

927 i‡(
‚ame
)

928 
fûe
->
‚ame
 = 
	`°rdup
(fname);

929 
fûe
->
åunc
 =Årunc;

930 
fûe
->
≥rm
 =Öerm;

932 i‡(
i‚ame
 && (
°ªam
 =
SND_PCM_STREAM_CAPTURE
)) {

933 
ifd
 = 
	`›í
(
i‚ame
, 
O_RDONLY
);

934 i‡(
ifd
 < 0) {

935 
	`SYSERR
("›í %†f‹Ñódög faûed", 
i‚ame
);

936 
	`‰ì
(
fûe
->
‚ame
);

937 
	`‰ì
(
fûe
);

938  -
î∫o
;

940 
fûe
->
i‚ame
 = 
	`°rdup
(ifname);

942 
fûe
->
fd
 = fd;

943 
fûe
->
ifd
 = ifd;

944 
fûe
->
f‹m©
 = format;

945 
fûe
->
gí
.
¶ave
 = slave;

946 
fûe
->
gí
.
˛o£_¶ave
 = close_slave;

948 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_FILE
, 
«me
, 
¶ave
->
°ªam
, sœve->
mode
);

949 i‡(
îr
 < 0) {

950 
	`‰ì
(
fûe
->
‚ame
);

951 
	`‰ì
(
fûe
->
i‚ame
);

952 
	`‰ì
(
fûe
);

953  
îr
;

955 
pcm
->
›s
 = &
¢d_pcm_fûe_›s
;

956 
pcm
->
Á°_›s
 = &
¢d_pcm_fûe_Á°_›s
;

957 
pcm
->
¥iv©e_d©a
 = 
fûe
;

958 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

959 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

960 
pcm
->
mm≠_shadow
 = 1;

961 
pcm
->
t°amp_ty≥
 = 
SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY
;

962 #i‡
	`deföed
(
HAVE_CLOCK_GETTIME
Ë&& deföed(
CLOCK_MONOTONIC
)

963 i‡(
	`˛ock_gëtime
(
CLOCK_MONOTONIC
, &
time•ec
) == 0)

964 
pcm
->
t°amp_ty≥
 = 
SND_PCM_TSTAMP_TYPE_MONOTONIC
;

966 
pcm
->
°ªam
 = stream;

967 
	`¢d_pcm_lök_hw_±r
(
pcm
, 
¶ave
);

968 
	`¢d_pcm_lök_≠∂_±r
(
pcm
, 
¶ave
);

969 *
pcmp
 = 
pcm
;

971 
	}
}

1034 
	$_¢d_pcm_fûe_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1035 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

1036 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

1038 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1039 
îr
;

1040 
¢d_pcm_t
 *
•cm
;

1041 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

1042 c⁄° *
‚ame
 = 
NULL
, *
i‚ame
 = NULL;

1043 c⁄° *
f‹m©
 = 
NULL
;

1044 
fd
 = -1, 
ifd
 = -1, 
åunc
 = 1;

1045 
≥rm
 = 0600;

1046 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1047 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1048 c⁄° *
id
;

1049 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1051 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

1053 i‡(
	`°rcmp
(
id
, "slave") == 0) {

1054 
¶ave
 = 
n
;

1057 i‡(
	`°rcmp
(
id
, "format") == 0) {

1058 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
f‹m©
);

1059 i‡(
îr
 < 0) {

1060 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1061  -
EINVAL
;

1065 i‡(
	`°rcmp
(
id
, "file") == 0) {

1066 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
‚ame
);

1067 i‡(
îr
 < 0) {

1068 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
fd
);

1069 i‡(
îr
 < 0) {

1070 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1071  -
EINVAL
;

1076 i‡(
	`°rcmp
(
id
, "infile") == 0) {

1077 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
i‚ame
);

1078 i‡(
îr
 < 0) {

1079 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
ifd
);

1080 i‡(
îr
 < 0) {

1081 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1082  -
EINVAL
;

1087 i‡(
	`°rcmp
(
id
, "perm") == 0) {

1088 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
≥rm
);

1089 i‡(
îr
 < 0) {

1090 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1091  
îr
;

1093 i‡((
≥rm
 & ~0777) != 0) {

1094 
	`SNDERR
("The fieldÖerm must beá valid fileÖermission");

1095  -
EINVAL
;

1099 i‡(
	`°rcmp
(
id
, "truncate") == 0) {

1100 
îr
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

1101 i‡(
îr
 < 0)

1102  -
EINVAL
;

1103 
åunc
 = 
îr
;

1106 
	`SNDERR
("Unknow¿fõld %s", 
id
);

1107  -
EINVAL
;

1109 i‡(!
f‹m©
) {

1110 
¢d_c⁄fig_t
 *
n
;

1112 i‡(
	`¢d_c⁄fig_£¨ch
(
roŸ
, "deÁu…s.pcm.fûe_f‹m©", &
n
) >= 0) {

1113 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
f‹m©
);

1114 i‡(
îr
 < 0) {

1115 
	`SNDERR
("Invalid file format");

1116  -
EINVAL
;

1120 i‡(!
¶ave
) {

1121 
	`SNDERR
("slave isÇot defined");

1122  -
EINVAL
;

1124 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 0);

1125 i‡(
îr
 < 0)

1126  
îr
;

1127 i‡((!
‚ame
 || 
	`°æí
(‚ameË=0Ë&& 
fd
 < 0) {

1128 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1129 
	`SNDERR
("file isÇot defined");

1130  -
EINVAL
;

1132 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

1133 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1134 i‡(
îr
 < 0)

1135  
îr
;

1136 
îr
 = 
	`¢d_pcm_fûe_›í
(
pcmp
, 
«me
, 
‚ame
, 
fd
, 
i‚ame
, 
ifd
,

1137 
åunc
, 
f‹m©
, 
≥rm
, 
•cm
, 1, 
°ªam
);

1138 i‡(
îr
 < 0)

1139 
	`¢d_pcm_˛o£
(
•cm
);

1140  
îr
;

1141 
	}
}

1142 #i‚de‡
DOC_HIDDEN


1143 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_fûe_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_generic.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_gíîic.h
"

31 
	~<sys/io˘l.h
>

32 
	~<limôs.h
>

34 #i‚de‡
DOC_HIDDEN


36 
	$¢d_pcm_gíîic_˛o£
(
¢d_pcm_t
 *
pcm
)

38 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

39 
îr
 = 0;

40 i‡(
gíîic
->
˛o£_¶ave
)

41 
îr
 = 
	`¢d_pcm_˛o£
(
gíîic
->
¶ave
);

42 
	`‰ì
(
gíîic
);

43  
îr
;

44 
	}
}

46 
	$¢d_pcm_gíîic_n⁄block
(
¢d_pcm_t
 *
pcm
, 
n⁄block
)

48 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

49  
	`¢d_pcm_n⁄block
(
gíîic
->
¶ave
, 
n⁄block
);

50 
	}
}

52 
	$¢d_pcm_gíîic_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
)

54 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

55  
	`¢d_pcm_async
(
gíîic
->
¶ave
, 
sig
, 
pid
);

56 
	}
}

58 
	$¢d_pcm_gíîic_pﬁl_des¸ùt‹s_cou¡
(
¢d_pcm_t
 *
pcm
)

60 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

61  
	`¢d_pcm_pﬁl_des¸ùt‹s_cou¡
(
gíîic
->
¶ave
);

62 
	}
}

64 
	$¢d_pcm_gíîic_pﬁl_des¸ùt‹s
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
•a˚
)

66 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

67  
	`¢d_pcm_pﬁl_des¸ùt‹s
(
gíîic
->
¶ave
, 
pfds
, 
•a˚
);

68 
	}
}

70 
	$¢d_pcm_gíîic_pﬁl_ªvíts
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

72 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

73  
	`¢d_pcm_pﬁl_des¸ùt‹s_ªvíts
(
gíîic
->
¶ave
, 
pfds
, 
nfds
, 
ªvíts
);

74 
	}
}

76 
	$¢d_pcm_gíîic_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_öfo_t
 * 
öfo
)

78 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

79  
	`¢d_pcm_öfo
(
gíîic
->
¶ave
, 
öfo
);

80 
	}
}

82 
	$¢d_pcm_gíîic_hw_‰ì
(
¢d_pcm_t
 *
pcm
)

84 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

85  
	`¢d_pcm_hw_‰ì
(
gíîic
->
¶ave
);

86 
	}
}

88 
	$¢d_pcm_gíîic_sw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
)

90 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

91  
	`¢d_pcm_sw_∑øms
(
gíîic
->
¶ave
, 
∑øms
);

92 
	}
}

94 
	$¢d_pcm_gíîic_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

96 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

97  
	`¢d_pcm_hw_ªföe
(
gíîic
->
¶ave
, 
∑øms
);

98 
	}
}

100 
	$¢d_pcm_gíîic_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

102 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

103  
	`_¢d_pcm_hw_∑øms_öã∫Æ
(
gíîic
->
¶ave
, 
∑øms
);

104 
	}
}

106 
	$¢d_pcm_gíîic_¥ï¨e
(
¢d_pcm_t
 *
pcm
)

108 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

109  
	`¢d_pcm_¥ï¨e
(
gíîic
->
¶ave
);

110 
	}
}

112 
	$¢d_pcm_gíîic_ch™√l_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_öfo_t
 *
öfo
)

114 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

115 i‡(
pcm
->
mm≠_shadow
) {

120  
	`¢d_pcm_ch™√l_öfo
(
gíîic
->
¶ave
, 
öfo
);

123  
	`¢d_pcm_ch™√l_öfo_shm
(
pcm
, 
öfo
, -1);

125 
	}
}

127 
	$¢d_pcm_gíîic_°©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©us_t
 * 
°©us
)

129 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

130  
	`¢d_pcm_°©us
(
gíîic
->
¶ave
, 
°©us
);

131 
	}
}

133 
¢d_pcm_°©e_t
 
	$¢d_pcm_gíîic_°©e
(
¢d_pcm_t
 *
pcm
)

135 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

136  
	`¢d_pcm_°©e
(
gíîic
->
¶ave
);

137 
	}
}

139 
	$¢d_pcm_gíîic_hwsync
(
¢d_pcm_t
 *
pcm
)

141 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

142  
	`¢d_pcm_hwsync
(
gíîic
->
¶ave
);

143 
	}
}

145 
	$¢d_pcm_gíîic_ª£t
(
¢d_pcm_t
 *
pcm
)

147 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

148  
	`¢d_pcm_ª£t
(
gíîic
->
¶ave
);

149 
	}
}

151 
	$¢d_pcm_gíîic_°¨t
(
¢d_pcm_t
 *
pcm
)

153 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

154  
	`¢d_pcm_°¨t
(
gíîic
->
¶ave
);

155 
	}
}

157 
	$¢d_pcm_gíîic_dr›
(
¢d_pcm_t
 *
pcm
)

159 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

160  
	`¢d_pcm_dr›
(
gíîic
->
¶ave
);

161 
	}
}

163 
	$¢d_pcm_gíîic_døö
(
¢d_pcm_t
 *
pcm
)

165 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

166  
	`¢d_pcm_døö
(
gíîic
->
¶ave
);

167 
	}
}

169 
	$¢d_pcm_gíîic_∑u£
(
¢d_pcm_t
 *
pcm
, 
íabÀ
)

171 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

172  
	`¢d_pcm_∑u£
(
gíîic
->
¶ave
, 
íabÀ
);

173 
	}
}

175 
	$¢d_pcm_gíîic_ªsume
(
¢d_pcm_t
 *
pcm
)

177 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

178  
	`¢d_pcm_ªsume
(
gíîic
->
¶ave
);

179 
	}
}

181 
	$¢d_pcm_gíîic_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
)

183 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

184  
	`¢d_pcm_dñay
(
gíîic
->
¶ave
, 
dñayp
);

185 
	}
}

187 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_gíîic_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
)

189 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

190  
	`¢d_pcm_f‹w¨dabÀ
(
gíîic
->
¶ave
);

191 
	}
}

193 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_gíîic_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

195 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

196  
	`INTERNAL
(
¢d_pcm_f‹w¨d
)(
gíîic
->
¶ave
, 
‰ames
);

197 
	}
}

199 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_gíîic_ªwödabÀ
(
¢d_pcm_t
 *
pcm
)

201 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

202  
	`¢d_pcm_ªwödabÀ
(
gíîic
->
¶ave
);

203 
	}
}

205 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_gíîic_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

207 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

208  
	`¢d_pcm_ªwöd
(
gíîic
->
¶ave
, 
‰ames
);

209 
	}
}

211 
	$¢d_pcm_gíîic_lök
(
¢d_pcm_t
 *
pcm1
, snd_pcm_à*
pcm2
)

213 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm1
->
¥iv©e_d©a
;

214 i‡(
gíîic
->
¶ave
->
Á°_›s
->
lök
)

215  
gíîic
->
¶ave
->
Á°_›s
->
	`lök
(gíîic->¶ave->
Á°_›_¨g
, 
pcm2
);

216  -
ENOSYS
;

217 
	}
}

219 
	$¢d_pcm_gíîic_lök_¶aves
(
¢d_pcm_t
 *
pcm
, snd_pcm_à*
ma°î
)

221 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

222 i‡(
gíîic
->
¶ave
->
Á°_›s
->
lök_¶aves
)

223  
gíîic
->
¶ave
->
Á°_›s
->
	`lök_¶aves
(gíîic->¶ave->
Á°_›_¨g
, 
ma°î
);

224  -
ENOSYS
;

225 
	}
}

227 
	$¢d_pcm_gíîic_u∆ök
(
¢d_pcm_t
 *
pcm
)

229 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

230 i‡(
gíîic
->
¶ave
->
Á°_›s
->
u∆ök
)

231  
gíîic
->
¶ave
->
Á°_›s
->
	`u∆ök
(gíîic->¶ave->
Á°_›_¨g
);

232  -
ENOSYS
;

233 
	}
}

235 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_gíîic_wrôei
(
¢d_pcm_t
 *
pcm
, c⁄° *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

237 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

238  
	`_¢d_pcm_wrôei
(
gíîic
->
¶ave
, 
buf„r
, 
size
);

239 
	}
}

241 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_gíîic_wrôí
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

243 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

244  
	`_¢d_pcm_wrôí
(
gíîic
->
¶ave
, 
bufs
, 
size
);

245 
	}
}

247 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_gíîic_ªadi
(
¢d_pcm_t
 *
pcm
, *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

249 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

250  
	`_¢d_pcm_ªadi
(
gíîic
->
¶ave
, 
buf„r
, 
size
);

251 
	}
}

253 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_gíîic_ªadn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

255 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

256  
	`_¢d_pcm_ªadn
(
gíîic
->
¶ave
, 
bufs
, 
size
);

257 
	}
}

259 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_gíîic_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

260 
¢d_pcm_u‰ames_t
 
off£t
,

261 
¢d_pcm_u‰ames_t
 
size
)

263 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

264  
	`¢d_pcm_mm≠_commô
(
gíîic
->
¶ave
, 
off£t
, 
size
);

265 
	}
}

267 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_gíîic_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

269 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

270  
	`¢d_pcm_avaû_upd©e
(
gíîic
->
¶ave
);

271 
	}
}

273 
	$¢d_pcm_gíîic_htime°amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 *
avaû
,

274 
¢d_htime°amp_t
 *
t°amp
)

276 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

277  
	`¢d_pcm_htime°amp
(
gíîic
->
¶ave
, 
avaû
, 
t°amp
);

278 
	}
}

283 
	$¢d_pcm_gíîic_ªÆ_htime°amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 *
avaû
,

284 
¢d_htime°amp_t
 *
t°amp
)

286 
¢d_pcm_s‰ames_t
 
avaû1
;

287 
ok
 = 0;

290 
avaû1
 = 
	`__¢d_pcm_avaû_upd©e
(
pcm
);

291 i‡(
avaû1
 < 0)

292  
avaû1
;

293 i‡(
ok
 && (
¢d_pcm_u‰ames_t
)
avaû1
 =*
avaû
)

295 *
avaû
 = 
avaû1
;

296 
	`gëtime°amp
(
t°amp
, 
pcm
->
t°amp_ty≥
);

297 
ok
 = 1;

300 
	}
}

302 
	$¢d_pcm_gíîic_mm≠
(
¢d_pcm_t
 *
pcm
)

304 i‡(
pcm
->
mm≠_shadow
) {

306 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

307 
pcm
->
mm≠_ch™√ls
 = 
gíîic
->
¶ave
->mmap_channels;

308 
pcm
->
ru¬ög_¨ós
 = 
gíîic
->
¶ave
->running_areas;

309 
pcm
->
°›≥d_¨ós
 = 
gíîic
->
¶ave
->stopped_areas;

312 
	}
}

314 
	$¢d_pcm_gíîic_munm≠
(
¢d_pcm_t
 *
pcm
)

316 i‡(
pcm
->
mm≠_shadow
) {

318 
pcm
->
mm≠_ch™√ls
 = 
NULL
;

319 
pcm
->
ru¬ög_¨ós
 = 
NULL
;

320 
pcm
->
°›≥d_¨ós
 = 
NULL
;

323 
	}
}

325 
¢d_pcm_chm≠_quîy_t
 **
	$¢d_pcm_gíîic_quîy_chm≠s
(
¢d_pcm_t
 *
pcm
)

327 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

328  
	`¢d_pcm_quîy_chm≠s
(
gíîic
->
¶ave
);

329 
	}
}

331 
¢d_pcm_chm≠_t
 *
	$¢d_pcm_gíîic_gë_chm≠
(
¢d_pcm_t
 *
pcm
)

333 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

334  
	`¢d_pcm_gë_chm≠
(
gíîic
->
¶ave
);

335 
	}
}

337 
	$¢d_pcm_gíîic_£t_chm≠
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_chm≠_t
 *
m≠
)

339 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

340  
	`¢d_pcm_£t_chm≠
(
gíîic
->
¶ave
, 
m≠
);

341 
	}
}

343 
	$¢d_pcm_gíîic_may_waô_f‹_avaû_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
avaû
 
ATTRIBUTE_UNUSED
)

345 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

346  
	`¢d_pcm_may_waô_f‹_avaû_mö
(
gíîic
->
¶ave
, 
	`¢d_pcm_mm≠_avaû
(generic->slave));

347 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_generic.h

23 
¢d_pcm_t
 *
	m¶ave
;

24 
	m˛o£_¶ave
;

25 } 
	t¢d_pcm_gíîic_t
;

28 
	#¢d_pcm_gíîic_˛o£
 \

29 
¢d1_pcm_gíîic_˛o£


	)

30 
	#¢d_pcm_gíîic_n⁄block
 \

31 
¢d1_pcm_gíîic_n⁄block


	)

32 
	#¢d_pcm_gíîic_async
 \

33 
¢d1_pcm_gíîic_async


	)

34 
	#¢d_pcm_gíîic_pﬁl_des¸ùt‹s_cou¡
 \

35 
¢d1_pcm_gíîic_pﬁl_des¸ùt‹s_cou¡


	)

36 
	#¢d_pcm_gíîic_pﬁl_des¸ùt‹s
 \

37 
¢d1_pcm_gíîic_pﬁl_des¸ùt‹s


	)

38 
	#¢d_pcm_gíîic_pﬁl_ªvíts
 \

39 
¢d1_pcm_gíîic_pﬁl_ªvíts


	)

40 
	#¢d_pcm_gíîic_öfo
 \

41 
¢d1_pcm_gíîic_öfo


	)

42 
	#¢d_pcm_gíîic_hw_‰ì
 \

43 
¢d1_pcm_gíîic_hw_‰ì


	)

44 
	#¢d_pcm_gíîic_sw_∑øms
 \

45 
¢d1_pcm_gíîic_sw_∑øms


	)

46 
	#¢d_pcm_gíîic_hw_ªföe
 \

47 
¢d1_pcm_gíîic_hw_ªföe


	)

48 
	#¢d_pcm_gíîic_hw_∑øms
 \

49 
¢d1_pcm_gíîic_hw_∑øms


	)

50 
	#¢d_pcm_gíîic_ch™√l_öfo
 \

51 
¢d1_pcm_gíîic_ch™√l_öfo


	)

52 
	#¢d_pcm_gíîic_ch™√l_öfo_no_buf„r
 \

53 
¢d1_pcm_gíîic_ch™√l_öfo_no_buf„r


	)

54 
	#¢d_pcm_gíîic_°©us
 \

55 
¢d1_pcm_gíîic_°©us


	)

56 
	#¢d_pcm_gíîic_°©e
 \

57 
¢d1_pcm_gíîic_°©e


	)

58 
	#¢d_pcm_gíîic_¥ï¨e
 \

59 
¢d1_pcm_gíîic_¥ï¨e


	)

60 
	#¢d_pcm_gíîic_hwsync
 \

61 
¢d1_pcm_gíîic_hwsync


	)

62 
	#¢d_pcm_gíîic_ª£t
 \

63 
¢d1_pcm_gíîic_ª£t


	)

64 
	#¢d_pcm_gíîic_°¨t
 \

65 
¢d1_pcm_gíîic_°¨t


	)

66 
	#¢d_pcm_gíîic_dr›
 \

67 
¢d1_pcm_gíîic_dr›


	)

68 
	#¢d_pcm_gíîic_døö
 \

69 
¢d1_pcm_gíîic_døö


	)

70 
	#¢d_pcm_gíîic_∑u£
 \

71 
¢d1_pcm_gíîic_∑u£


	)

72 
	#¢d_pcm_gíîic_ªsume
 \

73 
¢d1_pcm_gíîic_ªsume


	)

74 
	#¢d_pcm_gíîic_dñay
 \

75 
¢d1_pcm_gíîic_dñay


	)

76 
	#¢d_pcm_gíîic_f‹w¨dabÀ
 \

77 
¢d1_pcm_gíîic_f‹w¨dabÀ


	)

78 
	#¢d_pcm_gíîic_f‹w¨d
 \

79 
¢d1_pcm_gíîic_f‹w¨d


	)

80 
	#¢d_pcm_gíîic_ªwödabÀ
 \

81 
¢d1_pcm_gíîic_ªwödabÀ


	)

82 
	#¢d_pcm_gíîic_ªwöd
 \

83 
¢d1_pcm_gíîic_ªwöd


	)

84 
	#¢d_pcm_gíîic_lök
 \

85 
¢d1_pcm_gíîic_lök


	)

86 
	#¢d_pcm_gíîic_lök_¶aves
 \

87 
¢d1_pcm_gíîic_lök_¶aves


	)

88 
	#¢d_pcm_gíîic_u∆ök
 \

89 
¢d1_pcm_gíîic_u∆ök


	)

90 
	#¢d_pcm_gíîic_wrôei
 \

91 
¢d1_pcm_gíîic_wrôei


	)

92 
	#¢d_pcm_gíîic_wrôí
 \

93 
¢d1_pcm_gíîic_wrôí


	)

94 
	#¢d_pcm_gíîic_ªadi
 \

95 
¢d1_pcm_gíîic_ªadi


	)

96 
	#¢d_pcm_gíîic_ªadn
 \

97 
¢d1_pcm_gíîic_ªadn


	)

98 
	#¢d_pcm_gíîic_mm≠_commô
 \

99 
¢d1_pcm_gíîic_mm≠_commô


	)

100 
	#¢d_pcm_gíîic_avaû_upd©e
 \

101 
¢d1_pcm_gíîic_avaû_upd©e


	)

102 
	#¢d_pcm_gíîic_mm≠
 \

103 
¢d1_pcm_gíîic_mm≠


	)

104 
	#¢d_pcm_gíîic_munm≠
 \

105 
¢d1_pcm_gíîic_munm≠


	)

106 
	#¢d_pcm_gíîic_quîy_chm≠s
 \

107 
¢d1_pcm_gíîic_quîy_chm≠s


	)

108 
	#¢d_pcm_gíîic_gë_chm≠
 \

109 
¢d1_pcm_gíîic_gë_chm≠


	)

110 
	#¢d_pcm_gíîic_£t_chm≠
 \

111 
¢d1_pcm_gíîic_£t_chm≠


	)

112 
	#¢d_pcm_gíîic_may_waô_f‹_avaû_mö
 \

113 
¢d1_pcm_gíîic_may_waô_f‹_avaû_mö


	)

115 
¢d_pcm_gíîic_˛o£
(
¢d_pcm_t
 *
pcm
);

116 
¢d_pcm_gíîic_n⁄block
(
¢d_pcm_t
 *
pcm
, 
n⁄block
);

117 
¢d_pcm_gíîic_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
);

118 
¢d_pcm_gíîic_pﬁl_des¸ùt‹s_cou¡
(
¢d_pcm_t
 *
pcm
);

119 
¢d_pcm_gíîic_pﬁl_des¸ùt‹s
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
•a˚
);

120 
¢d_pcm_gíîic_pﬁl_ªvíts
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
);

121 
¢d_pcm_gíîic_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_öfo_t
 * 
öfo
);

122 
¢d_pcm_gíîic_hw_‰ì
(
¢d_pcm_t
 *
pcm
);

123 
¢d_pcm_gíîic_sw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
);

124 
¢d_pcm_gíîic_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

125 
¢d_pcm_gíîic_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

126 
¢d_pcm_gíîic_ch™√l_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_öfo_t
 * 
öfo
);

127 
¢d_pcm_gíîic_ch™√l_öfo_no_buf„r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_öfo_t
 * 
öfo
);

128 
¢d_pcm_gíîic_°©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©us_t
 * 
°©us
);

129 
¢d_pcm_°©e_t
 
¢d_pcm_gíîic_°©e
(
¢d_pcm_t
 *
pcm
);

130 
¢d_pcm_gíîic_¥ï¨e
(
¢d_pcm_t
 *
pcm
);

131 
¢d_pcm_gíîic_hwsync
(
¢d_pcm_t
 *
pcm
);

132 
¢d_pcm_gíîic_ª£t
(
¢d_pcm_t
 *
pcm
);

133 
¢d_pcm_gíîic_°¨t
(
¢d_pcm_t
 *
pcm
);

134 
¢d_pcm_gíîic_dr›
(
¢d_pcm_t
 *
pcm
);

135 
¢d_pcm_gíîic_døö
(
¢d_pcm_t
 *
pcm
);

136 
¢d_pcm_gíîic_∑u£
(
¢d_pcm_t
 *
pcm
, 
íabÀ
);

137 
¢d_pcm_gíîic_ªsume
(
¢d_pcm_t
 *
pcm
);

138 
¢d_pcm_gíîic_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
);

139 
¢d_pcm_s‰ames_t
 
¢d_pcm_gíîic_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
);

140 
¢d_pcm_s‰ames_t
 
¢d_pcm_gíîic_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
);

141 
¢d_pcm_s‰ames_t
 
¢d_pcm_gíîic_ªwödabÀ
(
¢d_pcm_t
 *
pcm
);

142 
¢d_pcm_s‰ames_t
 
¢d_pcm_gíîic_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
);

143 
¢d_pcm_gíîic_lök
(
¢d_pcm_t
 *
pcm1
, snd_pcm_à*
pcm2
);

144 
¢d_pcm_gíîic_lök_¶aves
(
¢d_pcm_t
 *
pcm
, snd_pcm_à*
ma°î
);

145 
¢d_pcm_gíîic_u∆ök
(
¢d_pcm_t
 *
pcm
);

146 
¢d_pcm_s‰ames_t
 
¢d_pcm_gíîic_wrôei
(
¢d_pcm_t
 *
pcm
, c⁄° *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
);

147 
¢d_pcm_s‰ames_t
 
¢d_pcm_gíîic_wrôí
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
);

148 
¢d_pcm_s‰ames_t
 
¢d_pcm_gíîic_ªadi
(
¢d_pcm_t
 *
pcm
, *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
);

149 
¢d_pcm_s‰ames_t
 
¢d_pcm_gíîic_ªadn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
);

150 
¢d_pcm_s‰ames_t
 
¢d_pcm_gíîic_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

151 
¢d_pcm_u‰ames_t
 
off£t
,

152 
¢d_pcm_u‰ames_t
 
size
);

153 
¢d_pcm_s‰ames_t
 
¢d_pcm_gíîic_avaû_upd©e
(
¢d_pcm_t
 *
pcm
);

154 
¢d_pcm_gíîic_htime°amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 *
avaû
,

155 
¢d_htime°amp_t
 *
time°amp
);

156 
¢d_pcm_gíîic_ªÆ_htime°amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 *
avaû
,

157 
¢d_htime°amp_t
 *
t°amp
);

158 
¢d_pcm_gíîic_mm≠
(
¢d_pcm_t
 *
pcm
);

159 
¢d_pcm_gíîic_munm≠
(
¢d_pcm_t
 *
pcm
);

160 
¢d_pcm_chm≠_quîy_t
 **
¢d_pcm_gíîic_quîy_chm≠s
(
¢d_pcm_t
 *
pcm
);

161 
¢d_pcm_chm≠_t
 *
¢d_pcm_gíîic_gë_chm≠
(
¢d_pcm_t
 *
pcm
);

162 
¢d_pcm_gíîic_£t_chm≠
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_chm≠_t
 *
m≠
);

163 
¢d_pcm_gíîic_may_waô_f‹_avaû_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
avaû
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_hooks.c

30 
	~"pcm_loˇl.h
"

31 
	~"pcm_gíîic.h
"

33 #i‚de‡
PIC


35 c⁄° *
	g_¢d_moduÀ_pcm_hooks
 = "";

38 #i‚de‡
DOC_HIDDEN


39 
	s_¢d_pcm_hook
 {

40 
¢d_pcm_t
 *
	mpcm
;

41 
¢d_pcm_hook_func_t
 
	mfunc
;

42 *
	m¥iv©e_d©a
;

43 
li°_hód
 
	mli°
;

46 
	s¢d_pcm_hook_dŒi°
 {

47 *
	mdlobj
;

48 
li°_hód
 
	mli°
;

52 
¢d_pcm_gíîic_t
 
	mgí
;

53 
li°_hód
 
	mhooks
[
SND_PCM_HOOK_TYPE_LAST
 + 1];

54 
li°_hód
 
	mdŒi°
;

55 } 
	t¢d_pcm_hooks_t
;

58 
	$hook_add_dlobj
(
¢d_pcm_t
 *
pcm
, *
dlobj
)

60 
¢d_pcm_hooks_t
 *
h
 = 
pcm
->
¥iv©e_d©a
;

61 
¢d_pcm_hook_dŒi°
 *
dl
;

63 
dl
 = 
	`mÆloc
((*dl));

64 i‡(!
dl
)

65  -
ENOMEM
;

67 
dl
->
dlobj
 = dlobj;

68 
	`li°_add_èû
(&
dl
->
li°
, &
h
->
dŒi°
);

70 
	}
}

72 
	$hook_ªmove_dlobj
(
¢d_pcm_hook_dŒi°
 *
dl
)

74 
	`li°_dñ
(&
dl
->
li°
);

75 
	`¢d_dl˛o£
(
dl
->
dlobj
);

76 
	`‰ì
(
dl
);

77 
	}
}

79 
	$¢d_pcm_hooks_˛o£
(
¢d_pcm_t
 *
pcm
)

81 
¢d_pcm_hooks_t
 *
h
 = 
pcm
->
¥iv©e_d©a
;

82 
li°_hód
 *
pos
, *
√xt
;

83 
k
;

84 
ªs
 = 0, 
îr
;

86 
	`li°_f‹_óch_ß„
(
pos
, 
√xt
, &
h
->
hooks
[
SND_PCM_HOOK_TYPE_CLOSE
]) {

87 
¢d_pcm_hook_t
 *
hook
 = 
	`li°_íåy
(
pos
, snd_pcm_hook_t, 
li°
);

88 
îr
 = 
hook
->
	`func
(hook);

89 i‡(
îr
 < 0)

90 
ªs
 = 
îr
;

92 
k
 = 0; k <
SND_PCM_HOOK_TYPE_LAST
; ++k) {

93 
li°_hód
 *
hooks
 = &
h
->hooks[
k
];

94 !
	`li°_em±y
(
hooks
)) {

95 
¢d_pcm_hook_t
 *
hook
;

96 
pos
 = 
hooks
->
√xt
;

97 
hook
 = 
	`li°_íåy
(
pos
, 
¢d_pcm_hook_t
, 
li°
);

98 
	`¢d_pcm_hook_ªmove
(
hook
);

101 !
	`li°_em±y
(&
h
->
dŒi°
)) {

102 
pos
 = 
h
->
dŒi°
.
√xt
;

103 
	`hook_ªmove_dlobj
(
	`li°_íåy
(
pos
, 
¢d_pcm_hook_dŒi°
, 
li°
));

105 
îr
 = 
	`¢d_pcm_gíîic_˛o£
(
pcm
);

106 i‡(
îr
 < 0)

107 
ªs
 = 
îr
;

108  
ªs
;

109 
	}
}

111 
	$¢d_pcm_hooks_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

113 
¢d_pcm_hooks_t
 *
h
 = 
pcm
->
¥iv©e_d©a
;

114 
li°_hód
 *
pos
, *
√xt
;

115 
îr
 = 
	`¢d_pcm_gíîic_hw_∑øms
(
pcm
, 
∑øms
);

116 i‡(
îr
 < 0)

117  
îr
;

118 
	`li°_f‹_óch_ß„
(
pos
, 
√xt
, &
h
->
hooks
[
SND_PCM_HOOK_TYPE_HW_PARAMS
]) {

119 
¢d_pcm_hook_t
 *
hook
 = 
	`li°_íåy
(
pos
, snd_pcm_hook_t, 
li°
);

120 
îr
 = 
hook
->
	`func
(hook);

121 i‡(
îr
 < 0)

122  
îr
;

125 
	}
}

127 
	$¢d_pcm_hooks_hw_‰ì
(
¢d_pcm_t
 *
pcm
)

129 
¢d_pcm_hooks_t
 *
h
 = 
pcm
->
¥iv©e_d©a
;

130 
li°_hód
 *
pos
, *
√xt
;

131 
îr
 = 
	`¢d_pcm_gíîic_hw_‰ì
(
pcm
);

132 i‡(
îr
 < 0)

133  
îr
;

134 
	`li°_f‹_óch_ß„
(
pos
, 
√xt
, &
h
->
hooks
[
SND_PCM_HOOK_TYPE_HW_FREE
]) {

135 
¢d_pcm_hook_t
 *
hook
 = 
	`li°_íåy
(
pos
, snd_pcm_hook_t, 
li°
);

136 
îr
 = 
hook
->
	`func
(hook);

137 i‡(
îr
 < 0)

138  
îr
;

141 
	}
}

143 
	$¢d_pcm_hooks_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

145 
¢d_pcm_hooks_t
 *
h
 = 
pcm
->
¥iv©e_d©a
;

146 
	`¢d_ouçut_¥ötf
(
out
, "Hooks PCM\n");

147 i‡(
pcm
->
£tup
) {

148 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

149 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

151 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

152 
	`¢d_pcm_dump
(
h
->
gí
.
¶ave
, 
out
);

153 
	}
}

155 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_hooks_›s
 = {

156 .
˛o£
 = 
¢d_pcm_hooks_˛o£
,

157 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

158 .
	ghw_ªföe
 = 
¢d_pcm_gíîic_hw_ªföe
,

159 .
	ghw_∑øms
 = 
¢d_pcm_hooks_hw_∑øms
,

160 .
	ghw_‰ì
 = 
¢d_pcm_hooks_hw_‰ì
,

161 .
	gsw_∑øms
 = 
¢d_pcm_gíîic_sw_∑øms
,

162 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

163 .
	gdump
 = 
¢d_pcm_hooks_dump
,

164 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

165 .
	gasync
 = 
¢d_pcm_gíîic_async
,

166 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

167 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

168 .
	gquîy_chm≠s
 = 
¢d_pcm_gíîic_quîy_chm≠s
,

169 .
	ggë_chm≠
 = 
¢d_pcm_gíîic_gë_chm≠
,

170 .
	g£t_chm≠
 = 
¢d_pcm_gíîic_£t_chm≠
,

173 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_hooks_Á°_›s
 = {

174 .
°©us
 = 
¢d_pcm_gíîic_°©us
,

175 .
	g°©e
 = 
¢d_pcm_gíîic_°©e
,

176 .
	ghwsync
 = 
¢d_pcm_gíîic_hwsync
,

177 .
	gdñay
 = 
¢d_pcm_gíîic_dñay
,

178 .
	g¥ï¨e
 = 
¢d_pcm_gíîic_¥ï¨e
,

179 .
	gª£t
 = 
¢d_pcm_gíîic_ª£t
,

180 .
	g°¨t
 = 
¢d_pcm_gíîic_°¨t
,

181 .
	gdr›
 = 
¢d_pcm_gíîic_dr›
,

182 .
	gdøö
 = 
¢d_pcm_gíîic_døö
,

183 .
	g∑u£
 = 
¢d_pcm_gíîic_∑u£
,

184 .
	gªwödabÀ
 = 
¢d_pcm_gíîic_ªwödabÀ
,

185 .
	gªwöd
 = 
¢d_pcm_gíîic_ªwöd
,

186 .
	gf‹w¨dabÀ
 = 
¢d_pcm_gíîic_f‹w¨dabÀ
,

187 .
	gf‹w¨d
 = 
¢d_pcm_gíîic_f‹w¨d
,

188 .
	gªsume
 = 
¢d_pcm_gíîic_ªsume
,

189 .
	glök
 = 
¢d_pcm_gíîic_lök
,

190 .
	glök_¶aves
 = 
¢d_pcm_gíîic_lök_¶aves
,

191 .
	gu∆ök
 = 
¢d_pcm_gíîic_u∆ök
,

192 .
	gwrôei
 = 
¢d_pcm_gíîic_wrôei
,

193 .
	gwrôí
 = 
¢d_pcm_gíîic_wrôí
,

194 .
	gªadi
 = 
¢d_pcm_gíîic_ªadi
,

195 .
	gªadn
 = 
¢d_pcm_gíîic_ªadn
,

196 .
	gavaû_upd©e
 = 
¢d_pcm_gíîic_avaû_upd©e
,

197 .
	gmm≠_commô
 = 
¢d_pcm_gíîic_mm≠_commô
,

198 .
	ghtime°amp
 = 
¢d_pcm_gíîic_htime°amp
,

199 .
	gpﬁl_des¸ùt‹s_cou¡
 = 
¢d_pcm_gíîic_pﬁl_des¸ùt‹s_cou¡
,

200 .
	gpﬁl_des¸ùt‹s
 = 
¢d_pcm_gíîic_pﬁl_des¸ùt‹s
,

201 .
	gpﬁl_ªvíts
 = 
¢d_pcm_gíîic_pﬁl_ªvíts
,

202 .
	gmay_waô_f‹_avaû_mö
 = 
¢d_pcm_gíîic_may_waô_f‹_avaû_mö
,

216 
	$¢d_pcm_hooks_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
, snd_pcm_à*
¶ave
, 
˛o£_¶ave
)

218 
¢d_pcm_t
 *
pcm
;

219 
¢d_pcm_hooks_t
 *
h
;

220 
k
;

221 
îr
;

222 
	`as£π
(
pcmp
 && 
¶ave
);

223 
h
 = 
	`ˇŒoc
(1, (
¢d_pcm_hooks_t
));

224 i‡(!
h
)

225  -
ENOMEM
;

226 
h
->
gí
.
¶ave
 = slave;

227 
h
->
gí
.
˛o£_¶ave
 = close_slave;

228 
k
 = 0; k <
SND_PCM_HOOK_TYPE_LAST
; ++k) {

229 
	`INIT_LIST_HEAD
(&
h
->
hooks
[
k
]);

231 
	`INIT_LIST_HEAD
(&
h
->
dŒi°
);

232 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_HOOKS
, 
«me
, 
¶ave
->
°ªam
, sœve->
mode
);

233 i‡(
îr
 < 0) {

234 
	`‰ì
(
h
);

235  
îr
;

237 
pcm
->
›s
 = &
¢d_pcm_hooks_›s
;

238 
pcm
->
Á°_›s
 = &
¢d_pcm_hooks_Á°_›s
;

239 
pcm
->
¥iv©e_d©a
 = 
h
;

240 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

241 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

242 
pcm
->
mm≠_shadow
 = 1;

243 
pcm
->
t°amp_ty≥
 = 
¶ave
->tstamp_type;

244 
	`¢d_pcm_lök_hw_±r
(
pcm
, 
¶ave
);

245 
	`¢d_pcm_lök_≠∂_±r
(
pcm
, 
¶ave
);

246 *
pcmp
 = 
pcm
;

249 
	}
}

341 
	$¢d_pcm_hook_add_c⁄f
(
¢d_pcm_t
 *
pcm
, 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
)

343 
îr
;

344 
buf
[256], 
îrbuf
[256];

345 c⁄° *
°r
, *
id
;

346 c⁄° *
lib
 = 
NULL
, *
ö°Æl
 = NULL;

347 
¢d_c⁄fig_t
 *
ty≥
 = 
NULL
, *
¨gs
 = NULL;

348 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

349 (*
ö°Æl_func
)(
¢d_pcm_t
 *
pcm
, 
¢d_c⁄fig_t
 *
¨gs
Ë
NULL
;

350 *
h
 = 
NULL
;

352 i‡(
	`¢d_c⁄fig_gë_ty≥
(
c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

353 
	`SNDERR
("Invalid hook definition");

354  -
EINVAL
;

356 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

357 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

358 c⁄° *
id
;

359 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

361 i‡(
	`°rcmp
(
id
, "comment") == 0)

363 i‡(
	`°rcmp
(
id
, "type") == 0) {

364 
ty≥
 = 
n
;

367 i‡(
	`°rcmp
(
id
, "hook_args") == 0) {

368 
¨gs
 = 
n
;

371 
	`SNDERR
("Unknow¿fõld %s", 
id
);

372  -
EINVAL
;

374 i‡(!
ty≥
) {

375 
	`SNDERR
("type isÇot defined");

376  -
EINVAL
;

378 
îr
 = 
	`¢d_c⁄fig_gë_id
(
ty≥
, &
id
);

379 i‡(
îr
 < 0) {

380 
	`SNDERR
("unableÅo get id");

381  
îr
;

383 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
ty≥
, &
°r
);

384 i‡(
îr
 < 0) {

385 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

386  
îr
;

388 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "pcm_hook_ty≥", 
°r
, &
ty≥
);

389 i‡(
îr
 >= 0) {

390 i‡(
	`¢d_c⁄fig_gë_ty≥
(
ty≥
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

391 
	`SNDERR
("InvÆidÅy≥ f‹ PCMÅy≥ %†deföôi⁄", 
°r
);

392 
îr
 = -
EINVAL
;

393 
_îr
;

395 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
ty≥
) {

396 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

397 c⁄° *
id
;

398 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

400 i‡(
	`°rcmp
(
id
, "comment") == 0)

402 i‡(
	`°rcmp
(
id
, "lib") == 0) {

403 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
lib
);

404 i‡(
îr
 < 0) {

405 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

406 
_îr
;

410 i‡(
	`°rcmp
(
id
, "install") == 0) {

411 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
ö°Æl
);

412 i‡(
îr
 < 0) {

413 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

414 
_îr
;

418 
	`SNDERR
("Unknow¿fõld %s", 
id
);

419 
îr
 = -
EINVAL
;

420 
_îr
;

423 i‡(!
ö°Æl
) {

424 
ö°Æl
 = 
buf
;

425 
	`¢¥ötf
(
buf
, (buf), "_¢d_pcm_hook_%s_ö°Æl", 
°r
);

427 
h
 = 
	`INTERNAL
(
¢d_dl›í
)(
lib
, 
RTLD_NOW
, 
îrbuf
, (errbuf));

428 
ö°Æl_func
 = 
h
 ? 
	`¢d_dlsym
(h, 
ö°Æl
, 
	`SND_DLSYM_VERSION
(
SND_PCM_DLSYM_VERSION
)Ë: 
NULL
;

429 
îr
 = 0;

430 i‡(!
h
) {

431 
	`SNDERR
("Cannot open sharedÜibrary %s (%s)",

432 
lib
 ?Üib : "[buûtö]", 
îrbuf
);

433 
îr
 = -
ENOENT
;

434 } i‡(!
ö°Æl_func
) {

435 
	`SNDERR
("symbﬁ %†i†nŸ deföed insidê%s", 
ö°Æl
,

436 
lib
 ?Üib : "[builtin]");

437 
	`¢d_dl˛o£
(
h
);

438 
îr
 = -
ENXIO
;

440 
_îr
:

441 i‡(
ty≥
)

442 
	`¢d_c⁄fig_dñëe
(
ty≥
);

443 i‡(
îr
 < 0)

444  
îr
;

446 i‡(
¨gs
 && 
	`¢d_c⁄fig_gë_°rög
◊rgs, &
°r
) >= 0) {

447 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "hook_¨gs", 
°r
, &
¨gs
);

448 i‡(
îr
 < 0)

449 
	`SNDERR
("unknow¿hook_¨g†%s", 
°r
);

451 
îr
 = 
	`ö°Æl_func
(
pcm
, 
¨gs
);

452 
	`¢d_c⁄fig_dñëe
(
¨gs
);

454 
îr
 = 
	`ö°Æl_func
(
pcm
, 
¨gs
);

456 i‡(
îr
 >= 0)

457 
îr
 = 
	`hook_add_dlobj
(
pcm
, 
h
);

459 i‡(
îr
 < 0) {

460 if(
h
)

461 
	`¢d_dl˛o£
(
h
);

462  
îr
;

465 
	}
}

480 
	$_¢d_pcm_hooks_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

481 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

482 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

484 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

485 
îr
;

486 
¢d_pcm_t
 *
Ωcm
 = 
NULL
, *
•cm
;

487 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

488 
¢d_c⁄fig_t
 *
hooks
 = 
NULL
;

489 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

490 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

491 c⁄° *
id
;

492 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

494 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

496 i‡(
	`°rcmp
(
id
, "slave") == 0) {

497 
¶ave
 = 
n
;

500 i‡(
	`°rcmp
(
id
, "hooks") == 0) {

501 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

502 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

503  -
EINVAL
;

505 
hooks
 = 
n
;

508 
	`SNDERR
("Unknow¿fõld %s", 
id
);

509  -
EINVAL
;

511 i‡(!
¶ave
) {

512 
	`SNDERR
("slave isÇot defined");

513  -
EINVAL
;

515 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 0);

516 i‡(
îr
 < 0)

517  
îr
;

518 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

519 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

520 i‡(
îr
 < 0)

521  
îr
;

522 
îr
 = 
	`¢d_pcm_hooks_›í
(&
Ωcm
, 
«me
, 
•cm
, 1);

523 i‡(
îr
 < 0) {

524 
	`¢d_pcm_˛o£
(
•cm
);

525  
îr
;

527 i‡(!
hooks
)

528 
_d⁄e
;

529 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
hooks
) {

530 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

531 c⁄° *
°r
;

532 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
) >= 0) {

533 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "pcm_hook", 
°r
, &
n
);

534 i‡(
îr
 < 0) {

535 
	`SNDERR
("unknow¿pcm_hook %s", 
°r
);

537 
îr
 = 
	`¢d_pcm_hook_add_c⁄f
(
Ωcm
, 
roŸ
, 
n
);

538 
	`¢d_c⁄fig_dñëe
(
n
);

541 
îr
 = 
	`¢d_pcm_hook_add_c⁄f
(
Ωcm
, 
roŸ
, 
n
);

542 i‡(
îr
 < 0) {

543 
	`¢d_pcm_˛o£
(
Ωcm
);

544  
îr
;

547 
_d⁄e
:

548 *
pcmp
 = 
Ωcm
;

550 
	}
}

551 #i‚de‡
DOC_HIDDEN


552 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_hooks_›í
, 
SND_PCM_DLSYM_VERSION
);

560 
¢d_pcm_t
 *
	$¢d_pcm_hook_gë_pcm
(
¢d_pcm_hook_t
 *
hook
)

562 
	`as£π
(
hook
);

563  
hook
->
pcm
;

564 
	}
}

571 *
	$¢d_pcm_hook_gë_¥iv©e
(
¢d_pcm_hook_t
 *
hook
)

573 
	`as£π
(
hook
);

574  
hook
->
¥iv©e_d©a
;

575 
	}
}

582 
	$¢d_pcm_hook_£t_¥iv©e
(
¢d_pcm_hook_t
 *
hook
, *
¥iv©e_d©a
)

584 
	`as£π
(
hook
);

585 
hook
->
¥iv©e_d©a
 =Örivate_data;

586 
	}
}

600 
	$¢d_pcm_hook_add
(
¢d_pcm_hook_t
 **
hookp
, 
¢d_pcm_t
 *
pcm
,

601 
¢d_pcm_hook_ty≥_t
 
ty≥
,

602 
¢d_pcm_hook_func_t
 
func
, *
¥iv©e_d©a
)

604 
¢d_pcm_hook_t
 *
h
;

605 
¢d_pcm_hooks_t
 *
hooks
;

606 
	`as£π
(
hookp
 && 
func
);

607 
	`as£π
(
	`¢d_pcm_ty≥
(
pcm
Ë=
SND_PCM_TYPE_HOOKS
);

608 
h
 = 
	`ˇŒoc
(1, (*h));

609 i‡(!
h
)

610  -
ENOMEM
;

611 
h
->
pcm
 =Öcm;

612 
h
->
func
 = func;

613 
h
->
¥iv©e_d©a
 =Örivate_data;

614 
hooks
 = 
pcm
->
¥iv©e_d©a
;

615 
	`li°_add_èû
(&
h
->
li°
, &
hooks
->hooks[
ty≥
]);

616 *
hookp
 = 
h
;

618 
	}
}

628 
	$¢d_pcm_hook_ªmove
(
¢d_pcm_hook_t
 *
hook
)

630 
	`as£π
(
hook
);

631 
	`li°_dñ
(&
hook
->
li°
);

632 
	`‰ì
(
hook
);

634 
	}
}

640 
	$¢d_pcm_hook_˘l_ñems_hw_∑øms
(
¢d_pcm_hook_t
 *
hook
)

642 
¢d_s˘l_t
 *
h
 = 
	`¢d_pcm_hook_gë_¥iv©e
(
hook
);

643  
	`¢d_s˘l_ö°Æl
(
h
);

644 
	}
}

646 
	$¢d_pcm_hook_˘l_ñems_hw_‰ì
(
¢d_pcm_hook_t
 *
hook
)

648 
¢d_s˘l_t
 *
h
 = 
	`¢d_pcm_hook_gë_¥iv©e
(
hook
);

649  
	`¢d_s˘l_ªmove
(
h
);

650 
	}
}

652 
	$¢d_pcm_hook_˘l_ñems_˛o£
(
¢d_pcm_hook_t
 *
hook
)

654 
¢d_s˘l_t
 *
h
 = 
	`¢d_pcm_hook_gë_¥iv©e
(
hook
);

655 
îr
 = 
	`¢d_s˘l_‰ì
(
h
);

656 
	`¢d_pcm_hook_£t_¥iv©e
(
hook
, 
NULL
);

657  
îr
;

658 
	}
}

666 
	$_¢d_pcm_hook_˘l_ñems_ö°Æl
(
¢d_pcm_t
 *
pcm
, 
¢d_c⁄fig_t
 *
c⁄f
)

668 
îr
;

669 
ˇrd
;

670 
¢d_pcm_öfo_t
 
öfo
 = {0};

671 
˘l_«me
[16];

672 
¢d_˘l_t
 *
˘l
;

673 
¢d_s˘l_t
 *
s˘l
 = 
NULL
;

674 
¢d_c⁄fig_t
 *
pcm_c⁄f
 = 
NULL
;

675 
¢d_pcm_hook_t
 *
h_hw_∑øms
 = 
NULL
, *
h_hw_‰ì
 = NULL, *
h_˛o£
 = NULL;

676 
	`as£π
(
c⁄f
);

677 
	`as£π
(
	`¢d_c⁄fig_gë_ty≥
(
c⁄f
Ë=
SND_CONFIG_TYPE_COMPOUND
);

679 
îr
 = 
	`¢d_pcm_öfo
(
pcm
, &
öfo
);

680 i‡(
îr
 < 0)

681  
îr
;

682 
ˇrd
 = 
	`¢d_pcm_öfo_gë_ˇrd
(&
öfo
);

683 i‡(
ˇrd
 < 0) {

684 
	`SNDERR
("No card forÅhis PCM");

685  -
EINVAL
;

687 
	`•rötf
(
˘l_«me
, "hw:%d", 
ˇrd
);

688 
îr
 = 
	`¢d_˘l_›í
(&
˘l
, 
˘l_«me
, 0);

689 i‡(
îr
 < 0) {

690 
	`SNDERR
("C™nŸ o≥¿CTL %s", 
˘l_«me
);

691  
îr
;

693 
îr
 = 
	`¢d_c⁄fig_imake_poöãr
(&
pcm_c⁄f
, "pcm_h™dÀ", 
pcm
);

694 i‡(
îr
 < 0)

695 
_îr
;

696 
îr
 = 
	`¢d_s˘l_buûd
(&
s˘l
, 
˘l
, 
c⁄f
, 
pcm_c⁄f
, 0);

697 i‡(
îr
 < 0)

698 
_îr
;

699 
îr
 = 
	`¢d_pcm_hook_add
(&
h_hw_∑øms
, 
pcm
, 
SND_PCM_HOOK_TYPE_HW_PARAMS
,

700 
¢d_pcm_hook_˘l_ñems_hw_∑øms
, 
s˘l
);

701 i‡(
îr
 < 0)

702 
_îr
;

703 
îr
 = 
	`¢d_pcm_hook_add
(&
h_hw_‰ì
, 
pcm
, 
SND_PCM_HOOK_TYPE_HW_FREE
,

704 
¢d_pcm_hook_˘l_ñems_hw_‰ì
, 
s˘l
);

705 i‡(
îr
 < 0)

706 
_îr
;

707 
îr
 = 
	`¢d_pcm_hook_add
(&
h_˛o£
, 
pcm
, 
SND_PCM_HOOK_TYPE_CLOSE
,

708 
¢d_pcm_hook_˘l_ñems_˛o£
, 
s˘l
);

709 i‡(
îr
 < 0)

710 
_îr
;

711 
	`¢d_c⁄fig_dñëe
(
pcm_c⁄f
);

713 
_îr
:

714 i‡(
h_hw_∑øms
)

715 
	`¢d_pcm_hook_ªmove
(
h_hw_∑øms
);

716 i‡(
h_hw_‰ì
)

717 
	`¢d_pcm_hook_ªmove
(
h_hw_‰ì
);

718 i‡(
h_˛o£
)

719 
	`¢d_pcm_hook_ªmove
(
h_˛o£
);

720 i‡(
s˘l
)

721 
	`¢d_s˘l_‰ì
(
s˘l
);

722 i‡(
pcm_c⁄f
)

723 
	`¢d_c⁄fig_dñëe
(
pcm_c⁄f
);

724  
îr
;

725 
	}
}

726 #i‚de‡
DOC_HIDDEN


727 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_hook_˘l_ñems_ö°Æl
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_hw.c

30 
	~"pcm_loˇl.h
"

31 
	~"../c⁄åﬁ/c⁄åﬁ_loˇl.h
"

32 
	~"../timî/timî_loˇl.h
"

33 
	~<°dio.h
>

34 
	~<°dlib.h
>

35 
	~<°ddef.h
>

36 
	~<uni°d.h
>

37 
	~<°dboﬁ.h
>

38 
	~<sig«l.h
>

39 
	~<°rög.h
>

40 
	~<f˙é.h
>

41 
	~<sys/io˘l.h
>

42 
	~<sys/mm™.h
>

47 #i‚de‡
PIC


49 c⁄° *
	g_¢d_moduÀ_pcm_hw
 = "";

52 #i‚de‡
DOC_HIDDEN


54 #i‚de‡
F_SETSIG


55 
	#F_SETSIG
 10

	)

62 
	s¢drv_pcm_hw_∑øms_ﬁd
 {

63 
	mÊags
;

64 
	mmasks
[
SNDRV_PCM_HW_PARAM_SUBFORMAT
 -

65 
SNDRV_PCM_HW_PARAM_ACCESS
 + 1];

66 
¢d_öãrvÆ
 
	möãrvÆs
[
SNDRV_PCM_HW_PARAM_TICK_TIME
 -

67 
SNDRV_PCM_HW_PARAM_SAMPLE_BITS
 + 1];

68 
	mrmask
;

69 
	mcmask
;

70 
	möfo
;

71 
	mmsbôs
;

72 
	møã_num
;

73 
	møã_dí
;

74 
¢drv_pcm_u‰ames_t
 
	mfifo_size
;

75 
	mª£rved
[64];

78 
	#SND_PCM_IOCTL_HW_REFINE_OLD
 
	`_IOWR
('A', 0x10, 
¢drv_pcm_hw_∑øms_ﬁd
)

	)

79 
	#SND_PCM_IOCTL_HW_PARAMS_OLD
 
	`_IOWR
('A', 0x11, 
¢drv_pcm_hw_∑øms_ﬁd
)

	)

81 
u£_ﬁd_hw_∑øms_io˘l
(
fd
, 
cmd
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

82 
¢d_pcm_s‰ames_t
 
¢d_pcm_hw_avaû_upd©e
(
¢d_pcm_t
 *
pcm
);

83 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_hw_Á°_›s
;

84 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_hw_Á°_›s_timî
;

91 
	mvîsi⁄
;

92 
	mfd
;

93 
	mˇrd
, 
	mdevi˚
, 
	msubdevi˚
;

95 vﬁ©ûê
¢d_pcm_mm≠_°©us
 * 
	mmm≠_°©us
;

96 
¢d_pcm_mm≠_c⁄åﬁ
 *
	mmm≠_c⁄åﬁ
;

97 
boﬁ
 
	mmm≠_°©us_ÁŒbacked
;

98 
boﬁ
 
	mmm≠_c⁄åﬁ_ÁŒbacked
;

99 
¢d_pcm_sync_±r
 *
	msync_±r
;

101 
boﬁ
 
	m¥ï¨e_ª£t_sw_∑øms
;

102 
boﬁ
 
	m≥r„˘_døö
;

104 
	m≥riod_evít
;

105 
¢d_timî_t
 *
	m≥riod_timî
;

106 
pﬁlfd
 
	m≥riod_timî_pfd
;

107 
	m≥riod_timî_√ed_pﬁl
;

109 
¢d_pcm_f‹m©_t
 
	mf‹m©
;

111 
	mmö
;

112 
	mmax
;

113 } 
	møãs
;

114 
	mch™√ls
;

115 
	mdøö_sûí˚
;

117 
	mchm≠_ˇps
;

118 
¢d_pcm_chm≠_quîy_t
 **
	mchm≠_ovîride
;

119 } 
	t¢d_pcm_hw_t
;

121 
	#SNDRV_FILE_PCM_STREAM_PLAYBACK
 
ALSA_DEVICE_DIRECTORY
 "pcmC%iD%ù"

	)

122 
	#SNDRV_FILE_PCM_STREAM_CAPTURE
 
ALSA_DEVICE_DIRECTORY
 "pcmC%iD%ic"

	)

123 
	#SNDRV_PCM_VERSION_MAX
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 9)

	)

126 
	#FAST_PCM_STATE
(
hw
) \

127 ((
¢d_pcm_°©e_t
Ë(
hw
)->
mm≠_°©us
->
°©e
)

	)

128 
	#FAST_PCM_TSTAMP
(
hw
) \

129 ((
hw
)->
mm≠_°©us
->
t°amp
)

	)

131 
time•ec
 
	$¢d_pcm_hw_Á°_t°amp
(
¢d_pcm_t
 *
pcm
)

133 
time•ec
 
ªs
;

134 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

135 
ªs
 = 
	`FAST_PCM_TSTAMP
(
hw
);

136 i‡(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 5Ë> 
hw
->
vîsi⁄
)

137 
ªs
.
tv_n£c
 *= 1000L;

138  
ªs
;

139 
	}
}

142 
	$sync_±r1
(
¢d_pcm_hw_t
 *
hw
, 
Êags
)

144 
îr
;

145 
hw
->
sync_±r
->
Êags
 = flags;

146 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_SYNC_PTR
, hw->
sync_±r
) < 0) {

147 
îr
 = -
î∫o
;

148 
	`SYSMSG
("SNDRV_PCM_IOCTL_SYNC_PTR faûed (%i)", 
îr
);

149  
îr
;

152 
	}
}

154 
	$issue_avaû_mö
(
¢d_pcm_hw_t
 *
hw
)

156 i‡(!
hw
->
mm≠_c⁄åﬁ_ÁŒbacked
)

160  
	`sync_±r1
(
hw
, 
SNDRV_PCM_SYNC_PTR_APPL
);

161 
	}
}

163 
	$issue_≠∂±r
(
¢d_pcm_hw_t
 *
hw
)

165 i‡(!
hw
->
mm≠_c⁄åﬁ_ÁŒbacked
)

169  
	`sync_±r1
(
hw
, 
SNDRV_PCM_SYNC_PTR_AVAIL_MIN
);

170 
	}
}

172 
	$ªque°_hwsync
(
¢d_pcm_hw_t
 *
hw
)

174 i‡(!
hw
->
mm≠_°©us_ÁŒbacked
)

181  
	`sync_±r1
(
hw
,

182 
SNDRV_PCM_SYNC_PTR_HWSYNC
 |

183 
SNDRV_PCM_SYNC_PTR_APPL
 |

184 
SNDRV_PCM_SYNC_PTR_AVAIL_MIN
);

185 
	}
}

187 
	$quîy_°©us_™d_c⁄åﬁ_d©a
(
¢d_pcm_hw_t
 *
hw
)

189 i‡(!
hw
->
mm≠_c⁄åﬁ_ÁŒbacked
)

196  
	`sync_±r1
(
hw
,

197 
SNDRV_PCM_SYNC_PTR_APPL
 |

198 
SNDRV_PCM_SYNC_PTR_AVAIL_MIN
);

199 
	}
}

201 
	$quîy_°©us_d©a
(
¢d_pcm_hw_t
 *
hw
)

203 i‡(!
hw
->
mm≠_°©us_ÁŒbacked
)

210  
	`sync_±r1
(
hw
,

211 
SNDRV_PCM_SYNC_PTR_APPL
 |

212 
SNDRV_PCM_SYNC_PTR_AVAIL_MIN
);

213 
	}
}

215 
	$¢d_pcm_hw_˛ór_timî_queue
(
¢d_pcm_hw_t
 *
hw
)

217 i‡(
hw
->
≥riod_timî_√ed_pﬁl
) {

218 
	`pﬁl
(&
hw
->
≥riod_timî_pfd
, 1, 0) > 0) {

219 
¢d_timî_åód_t
 
rbuf
[4];

220 
	`¢d_timî_ªad
(
hw
->
≥riod_timî
, 
rbuf
, (rbuf));

223 
¢d_timî_åód_t
 
rbuf
[4];

224 
	`¢d_timî_ªad
(
hw
->
≥riod_timî
, 
rbuf
, (rbuf));

227 
	}
}

229 
	$¢d_pcm_hw_pﬁl_des¸ùt‹s_cou¡
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

232 
	}
}

234 
	$¢d_pcm_hw_pﬁl_des¸ùt‹s
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
•a˚
)

236 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

238 i‡(
•a˚
 < 2)

239  -
ENOMEM
;

240 
pfds
[0].
fd
 = 
hw
->fd;

241 
pfds
[0].
evíts
 = 
pcm
->
pﬁl_evíts
 | 
POLLERR
 | 
POLLNVAL
;

242 
pfds
[1].
fd
 = 
hw
->
≥riod_timî_pfd
.fd;

243 
pfds
[1].
evíts
 = 
POLLIN
 | 
POLLERR
 | 
POLLNVAL
;

245 
	}
}

247 
	$¢d_pcm_hw_pﬁl_ªvíts
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

249 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

250 
evíts
;

252 i‡(
nfds
 !2 || 
pfds
[0].
fd
 !
hw
->fd ||Öfds[1].fd !hw->
≥riod_timî_pfd
.fd)

253  -
EINVAL
;

254 
evíts
 = 
pfds
[0].
ªvíts
;

255 i‡(
pfds
[1].
ªvíts
 & 
POLLIN
) {

256 
	`¢d_pcm_hw_˛ór_timî_queue
(
hw
);

257 
evíts
 |
pcm
->
pﬁl_evíts
 & ~(
POLLERR
|
POLLNVAL
);

259 *
ªvíts
 = 
evíts
;

261 
	}
}

263 
	$¢d_pcm_hw_n⁄block
(
¢d_pcm_t
 *
pcm
, 
n⁄block
)

265 
Êags
;

266 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

267 
fd
 = 
hw
->fd, 
îr
;

269 i‡((
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
)) < 0) {

270 
îr
 = -
î∫o
;

271 
	`SYSMSG
("F_GETFL faûed (%i)", 
îr
);

272  
îr
;

274 i‡(
n⁄block
)

275 
Êags
 |
O_NONBLOCK
;

277 
Êags
 &~
O_NONBLOCK
;

278 i‡(
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
) < 0) {

279 
îr
 = -
î∫o
;

280 
	`SYSMSG
("F_SETFL f‹ O_NONBLOCK faûed (%i)", 
îr
);

281  
îr
;

284 
	}
}

286 
	$¢d_pcm_hw_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
)

288 
Êags
;

289 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

290 
fd
 = 
hw
->fd, 
îr
;

292 i‡((
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
)) < 0) {

293 
îr
 = -
î∫o
;

294 
	`SYSMSG
("F_GETFL faûed (%i)", 
îr
);

295  
îr
;

297 i‡(
sig
 >= 0)

298 
Êags
 |
O_ASYNC
;

300 
Êags
 &~
O_ASYNC
;

301 i‡(
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
) < 0) {

302 
îr
 = -
î∫o
;

303 
	`SYSMSG
("F_SETFL f‹ O_ASYNC faûed (%i)", 
îr
);

304  
îr
;

306 i‡(
sig
 < 0)

308 i‡(
	`f˙é
(
fd
, 
F_SETSIG
, ()
sig
) < 0) {

309 
îr
 = -
î∫o
;

310 
	`SYSMSG
("F_SETSIG faûed (%i)", 
îr
);

311  
îr
;

313 i‡(
	`f˙é
(
fd
, 
F_SETOWN
, ()
pid
) < 0) {

314 
îr
 = -
î∫o
;

315 
	`SYSMSG
("F_SETOWN faûed (%i)", 
îr
);

316  
îr
;

319 
	}
}

321 
	$¢d_pcm_hw_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_öfo_t
 * 
öfo
)

323 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

324 
fd
 = 
hw
->fd, 
îr
;

325 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_INFO
, 
öfo
) < 0) {

326 
îr
 = -
î∫o
;

327 
	`SYSMSG
("SNDRV_PCM_IOCTL_INFO faûed (%i)", 
îr
);

328  
îr
;

331 i‡(
	`__¢d_pcm_öfo_ñd_fixup_check
(
öfo
))

332  
	`__¢d_pcm_öfo_ñd_fixup
(
öfo
);

334 
	}
}

336 
ölöe
 
	$hw_ªföe_ˇŒ
(
¢d_pcm_hw_t
 *
pcm_hw
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

339 i‡(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 2Ë<
pcm_hw
->
vîsi⁄
)

340  
	`io˘l
(
pcm_hw
->
fd
, 
SNDRV_PCM_IOCTL_HW_REFINE
, 
∑øms
);

341  
	`u£_ﬁd_hw_∑øms_io˘l
(
pcm_hw
->
fd
, 
SND_PCM_IOCTL_HW_REFINE_OLD
, 
∑øms
);

342 
	}
}

344 
	$¢d_pcm_hw_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

346 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

347 
îr
;

349 i‡(
hw
->
f‹m©
 !
SND_PCM_FORMAT_UNKNOWN
) {

350 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
∑øms
, 
hw
->
f‹m©
);

351 i‡(
îr
 < 0)

352  
îr
;

354 i‡(
hw
->
ch™√ls
 > 0) {

355 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t
(
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
,

356 
hw
->
ch™√ls
, 0);

357 i‡(
îr
 < 0)

358  
îr
;

360 i‡(
hw
->
øãs
.
mö
 > 0) {

361 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mömax
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
,

362 
hw
->
øãs
.
mö
, 0, hw->øãs.
max
 + 1, -1);

363 i‡(
îr
 < 0)

364  
îr
;

367 i‡(
	`hw_ªföe_ˇŒ
(
hw
, 
∑øms
) < 0) {

368 
îr
 = -
î∫o
;

370  
îr
;

373 i‡(
∑øms
->
öfo
 != ~0U) {

374 
∑øms
->
öfo
 &= ~0xf0000000;

375 i‡(
pcm
->
t°amp_ty≥
 !
SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY
)

376 
∑øms
->
öfo
 |
SND_PCM_INFO_MONOTONIC
;

380 
	}
}

382 
	#hw_∑øm_mask
(
∑øms
,
v¨
) \

383 &((
∑øms
)->
masks
[(
v¨
Ë- 
SND_PCM_HW_PARAM_FIRST_MASK
])

	)

385 
	$hw_∑øms_ˇŒ
(
¢d_pcm_hw_t
 *
pcm_hw
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

387 
îr
;

390 i‡(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 2Ë<
pcm_hw
->
vîsi⁄
)

391 
îr
 = 
	`io˘l
(
pcm_hw
->
fd
, 
SNDRV_PCM_IOCTL_HW_PARAMS
, 
∑øms
);

393 
îr
 = 
	`u£_ﬁd_hw_∑øms_io˘l
(
pcm_hw
->
fd
, 
SND_PCM_IOCTL_HW_PARAMS_OLD
, 
∑øms
);

394 i‡(
îr
 >0 && 
pcm_hw
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 17Ë&& 
∑øms
->
msbôs
 > 0) {

395 
¢d_mask_t
 *
m
 = 
	`hw_∑øm_mask
(
∑øms
, 
SNDRV_PCM_HW_PARAM_FORMAT
);

396 i‡(
	`¢d_mask_sögÀ
(
m
)) {

397 
¢d_pcm_f‹m©_t
 
f‹m©
 = 
	`¢d_mask_mö
(
m
);

398 
width
 = 
	`¢d_pcm_f‹m©_width
(
f‹m©
);

399 i‡(
width
 > 0 && 
∑øms
->
msbôs
 > ()width)

400 
∑øms
->
msbôs
 = 
width
;

403  
îr
;

404 
	}
}

406 
	$¢d_pcm_hw_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 * 
∑øms
)

408 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

409 
îr
;

410 i‡(
	`hw_∑øms_ˇŒ
(
hw
, 
∑øms
) < 0) {

411 
îr
 = -
î∫o
;

412 
	`SYSMSG
("SNDRV_PCM_IOCTL_HW_PARAMS faûed (%i)", 
îr
);

413  
îr
;

415 
∑øms
->
öfo
 &= ~0xf0000000;

416 i‡(
pcm
->
t°amp_ty≥
 !
SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY
)

417 
∑øms
->
öfo
 |
SND_PCM_INFO_MONOTONIC
;

418 
hw
->
≥r„˘_døö
 = !!(
∑øms
->
öfo
 & 
SND_PCM_INFO_PERFECT_DRAIN
) ||

419 !!(
∑øms
->
Êags
 & 
SND_PCM_HW_PARAMS_NO_DRAIN_SILENCE
);

420  
	`quîy_°©us_d©a
(
hw
);

421 
	}
}

423 
	$¢d_pcm_hw_˛o£_timî
(
¢d_pcm_hw_t
 *
hw
)

425 i‡(
hw
->
≥riod_timî
) {

426 
	`¢d_timî_˛o£
(
hw
->
≥riod_timî
);

427 
hw
->
≥riod_timî
 = 
NULL
;

429 
	}
}

431 
	$¢d_pcm_hw_ch™ge_timî
(
¢d_pcm_t
 *
pcm
, 
íabÀ
)

433 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

434 
¢d_timî_∑øms_t
 
∑øms
 = {0};

435 
su•íd
, 
ªsume
;

436 
îr
;

438 i‡(
íabÀ
) {

439 
îr
 = 
	`¢d_timî_hw_›í
(&
hw
->
≥riod_timî
,

441 
SND_TIMER_CLASS_PCM
, 
SND_TIMER_SCLASS_NONE
,

442 
hw
->
ˇrd
, hw->
devi˚
,

443 (
hw
->
subdevi˚
 << 1Ë| (
pcm
->
°ªam
 & 1),

444 
SND_TIMER_OPEN_NONBLOCK
 | 
SND_TIMER_OPEN_TREAD
);

445 i‡(
îr
 < 0) {

446 
îr
 = 
	`¢d_timî_hw_›í
(&
hw
->
≥riod_timî
,

448 
SND_TIMER_CLASS_PCM
, 
SND_TIMER_SCLASS_NONE
,

449 
hw
->
ˇrd
, hw->
devi˚
,

450 (
hw
->
subdevi˚
 << 1Ë| (
pcm
->
°ªam
 & 1),

451 
SND_TIMER_OPEN_NONBLOCK
);

452  
îr
;

454 i‡(
	`¢d_timî_pﬁl_des¸ùt‹s_cou¡
(
hw
->
≥riod_timî
) != 1) {

455 
	`¢d_pcm_hw_˛o£_timî
(
hw
);

456  -
EINVAL
;

458 
hw
->
≥riod_timî_pfd
.
evíts
 = 
POLLIN
;

459 
hw
->
≥riod_timî_pfd
.
ªvíts
 = 0;

460 
	`¢d_timî_pﬁl_des¸ùt‹s
(
hw
->
≥riod_timî
,

461 &
hw
->
≥riod_timî_pfd
, 1);

462 
hw
->
≥riod_timî_√ed_pﬁl
 = 0;

463 
su•íd
 = 1<<
SND_TIMER_EVENT_MSUSPEND
;

464 
ªsume
 = 1<<
SND_TIMER_EVENT_MRESUME
;

469 
vî
 = 0;

470 
	`io˘l
(
hw
->
≥riod_timî_pfd
.
fd
,

471 
SNDRV_TIMER_IOCTL_PVERSION
, &
vî
);

477 i‡(
vî
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4))

478 
hw
->
≥riod_timî_√ed_pﬁl
 = 1;

483 i‡(
vî
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 5)) {

484 
su•íd
 = 1<<
SND_TIMER_EVENT_MPAUSE
;

485 
ªsume
 = 1<<
SND_TIMER_EVENT_MCONTINUE
;

488 
	`¢d_timî_∑øms_£t_auto_°¨t
(&
∑øms
, 1);

489 
	`¢d_timî_∑øms_£t_ticks
(&
∑øms
, 1);

490 
	`INTERNAL
(
¢d_timî_∑øms_£t_fûãr
)(&
∑øms
, (1<<
SND_TIMER_EVENT_TICK
) |

491 
su•íd
 | 
ªsume
);

492 
îr
 = 
	`¢d_timî_∑øms
(
hw
->
≥riod_timî
, &
∑øms
);

493 i‡(
îr
 < 0) {

494 
	`¢d_pcm_hw_˛o£_timî
(
hw
);

495  
îr
;

497 
îr
 = 
	`¢d_timî_°¨t
(
hw
->
≥riod_timî
);

498 i‡(
îr
 < 0) {

499 
	`¢d_pcm_hw_˛o£_timî
(
hw
);

500  
îr
;

502 
pcm
->
Á°_›s
 = &
¢d_pcm_hw_Á°_›s_timî
;

504 
	`¢d_pcm_hw_˛o£_timî
(
hw
);

505 
pcm
->
Á°_›s
 = &
¢d_pcm_hw_Á°_›s
;

506 
hw
->
≥riod_evít
 = 0;

509 
	}
}

511 
	$¢d_pcm_hw_hw_‰ì
(
¢d_pcm_t
 *
pcm
)

513 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

514 
fd
 = 
hw
->fd, 
îr
;

515 
	`¢d_pcm_hw_ch™ge_timî
(
pcm
, 0);

516 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_HW_FREE
) < 0) {

517 
îr
 = -
î∫o
;

518 
	`SYSMSG
("SNDRV_PCM_IOCTL_HW_FREE faûed (%i)", 
îr
);

519  
îr
;

522 
	}
}

524 
	$¢d_pcm_hw_sw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 * 
∑øms
)

526 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

527 
fd
 = 
hw
->fd, 
îr
 = 0;

528 
ﬁd_≥riod_evít
 = 
	`sw_gë_≥riod_evít
(
∑øms
);

529 
	`sw_£t_≥riod_evít
(
∑øms
, 0);

530 i‡((
¢d_pcm_t°amp_t
Ë
∑øms
->
t°amp_mode
 =
pcm
->tstamp_mode &&

531 (
¢d_pcm_t°amp_ty≥_t
Ë
∑øms
->
t°amp_ty≥
 =
pcm
->tstamp_type &&

532 
∑øms
->
≥riod_°ï
 =
pcm
->period_step &&

533 
∑øms
->
°¨t_thªshﬁd
 =
pcm
->start_threshold &&

534 
∑øms
->
°›_thªshﬁd
 =
pcm
->stop_threshold &&

535 
∑øms
->
sûí˚_thªshﬁd
 =
pcm
->silence_threshold &&

536 
∑øms
->
sûí˚_size
 =
pcm
->silence_size &&

537 
ﬁd_≥riod_evít
 =
hw
->
≥riod_evít
) {

538 
hw
->
mm≠_c⁄åﬁ
->
avaû_mö
 = 
∑øms
->avail_min;

539 
îr
 = 
	`issue_avaû_mö
(
hw
);

540 
out
;

542 i‡(
∑øms
->
t°amp_ty≥
 =
SND_PCM_TSTAMP_TYPE_MONOTONIC_RAW
 &&

543 
hw
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 12)) {

544 
	`SYSMSG
("Kernel doesn't support SND_PCM_TSTAMP_TYPE_MONOTONIC_RAW");

545 
îr
 = -
EINVAL
;

546 
out
;

548 i‡(
∑øms
->
t°amp_ty≥
 =
SND_PCM_TSTAMP_TYPE_MONOTONIC
 &&

549 
hw
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 5)) {

550 
	`SYSMSG
("Kernel doesn't support SND_PCM_TSTAMP_TYPE_MONOTONIC");

551 
îr
 = -
EINVAL
;

552 
out
;

554 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_SW_PARAMS
, 
∑øms
) < 0) {

555 
îr
 = -
î∫o
;

556 
	`SYSMSG
("SNDRV_PCM_IOCTL_SW_PARAMS faûed (%i)", 
îr
);

557 
out
;

559 
hw
->
¥ï¨e_ª£t_sw_∑øms
 = 
Ál£
;

560 i‡((
¢d_pcm_t°amp_ty≥_t
Ë
∑øms
->
t°amp_ty≥
 !
pcm
->tstamp_type) {

561 i‡(
hw
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 12)) {

562 
⁄
 = (
¢d_pcm_t°amp_ty≥_t
Ë
∑øms
->
t°amp_ty≥
 ==

563 
SND_PCM_TSTAMP_TYPE_MONOTONIC
;

564 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_TSTAMP
, &
⁄
) < 0) {

565 
îr
 = -
î∫o
;

566 
	`SNDMSG
("TSTAMP failed");

567 
out
;

570 
pcm
->
t°amp_ty≥
 = 
∑øms
->tstamp_type;

572 
hw
->
mm≠_c⁄åﬁ
->
avaû_mö
 = 
∑øms
->avail_min;

573 i‡(
hw
->
≥riod_evít
 !
ﬁd_≥riod_evít
) {

574 
îr
 = 
	`¢d_pcm_hw_ch™ge_timî
(
pcm
, 
ﬁd_≥riod_evít
);

575 i‡(
îr
 < 0)

576 
out
;

577 
hw
->
≥riod_evít
 = 
ﬁd_≥riod_evít
;

579 
out
:

580 
	`sw_£t_≥riod_evít
(
∑øms
, 
ﬁd_≥riod_evít
);

581  
îr
;

582 
	}
}

584 
	$¢d_pcm_hw_ch™√l_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_öfo_t
 * 
öfo
)

586 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

587 
¢d_pcm_ch™√l_öfo
 
i
;

588 
fd
 = 
hw
->fd, 
îr
;

589 
i
.
ch™√l
 = 
öfo
->channel;

590 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_CHANNEL_INFO
, &
i
) < 0) {

591 
îr
 = -
î∫o
;

592 
	`SYSMSG
("SNDRV_PCM_IOCTL_CHANNEL_INFO faûed (%i)", 
îr
);

593  
îr
;

595 
öfo
->
ch™√l
 = 
i
.channel;

596 
öfo
->
addr
 = 0;

597 
öfo
->
fú°
 = 
i
.first;

598 
öfo
->
°ï
 = 
i
.step;

599 
öfo
->
ty≥
 = 
SND_PCM_AREA_MMAP
;

600 
öfo
->
u
.
mm≠
.
fd
 = fd;

601 
öfo
->
u
.
mm≠
.
off£t
 = 
i
.offset;

603 
	}
}

605 
	$¢d_pcm_hw_°©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©us_t
 * 
°©us
)

607 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

608 
fd
 = 
hw
->fd, 
îr
;

609 i‡(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 13Ë> 
hw
->
vîsi⁄
) {

610 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_STATUS
, 
°©us
) < 0) {

611 
îr
 = -
î∫o
;

612 
	`SYSMSG
("SNDRV_PCM_IOCTL_STATUS faûed (%i)", 
îr
);

613  
îr
;

616 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_STATUS_EXT
, 
°©us
) < 0) {

617 
îr
 = -
î∫o
;

618 
	`SYSMSG
("SNDRV_PCM_IOCTL_STATUS_EXT faûed (%i)", 
îr
);

619  
îr
;

622 i‡(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 5Ë> 
hw
->
vîsi⁄
) {

623 
°©us
->
t°amp
.
tv_n£c
 *= 1000L;

624 
°©us
->
åiggî_t°amp
.
tv_n£c
 *= 1000L;

627 
	}
}

629 
¢d_pcm_°©e_t
 
	$¢d_pcm_hw_°©e
(
¢d_pcm_t
 *
pcm
)

631 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

634 i‡(
	`quîy_°©us_d©a
(
hw
Ë=-
ENODEV
)

635  
SND_PCM_STATE_DISCONNECTED
;

636  (
¢d_pcm_°©e_t
Ë
hw
->
mm≠_°©us
->
°©e
;

637 
	}
}

639 
	$¢d_pcm_hw_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
)

641 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

642 
fd
 = 
hw
->fd, 
îr
;

643 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_DELAY
, 
dñayp
) < 0) {

644 
îr
 = -
î∫o
;

645 
	`SYSMSG
("SNDRV_PCM_IOCTL_DELAY faûed (%i)", 
îr
);

646  
îr
;

649 
	}
}

651 
	$¢d_pcm_hw_hwsync
(
¢d_pcm_t
 *
pcm
)

653 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

654 
fd
 = 
hw
->fd, 
îr
;

655 i‡(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 3Ë<
hw
->
vîsi⁄
) {

656 i‡(
hw
->
mm≠_°©us_ÁŒbacked
) {

657 
îr
 = 
	`ªque°_hwsync
(
hw
);

658 i‡(
îr
 < 0)

659  
îr
;

661 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_HWSYNC
) < 0) {

662 
îr
 = -
î∫o
;

663 
	`SYSMSG
("SNDRV_PCM_IOCTL_HWSYNC faûed (%i)", 
îr
);

664  
îr
;

668 
¢d_pcm_s‰ames_t
 
dñay
;

669 
îr
 = 
	`¢d_pcm_hw_dñay
(
pcm
, &
dñay
);

670 i‡(
îr
 < 0) {

671 
	`FAST_PCM_STATE
(
hw
)) {

672 
SND_PCM_STATE_PREPARED
:

673 
SND_PCM_STATE_SUSPENDED
:

676  
îr
;

681 
	}
}

683 
	$¢d_pcm_hw_¥ï¨e
(
¢d_pcm_t
 *
pcm
)

685 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

686 
¢d_pcm_sw_∑øms_t
 
sw_∑øms
;

687 
fd
 = 
hw
->fd, 
îr
;

689 i‡(
hw
->
¥ï¨e_ª£t_sw_∑øms
) {

690 
	`¢d_pcm_sw_∑øms_cuºít_no_lock
(
pcm
, &
sw_∑øms
);

691 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_SW_PARAMS
, &
sw_∑øms
) < 0) {

692 
îr
 = -
î∫o
;

693 
	`SYSMSG
("SNDRV_PCM_IOCTL_SW_PARAMS faûed (%i)", 
îr
);

694  
îr
;

696 
hw
->
¥ï¨e_ª£t_sw_∑øms
 = 
Ál£
;

698 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_PREPARE
) < 0) {

699 
îr
 = -
î∫o
;

700 
	`SYSMSG
("SNDRV_PCM_IOCTL_PREPARE faûed (%i)", 
îr
);

701  
îr
;

703  
	`quîy_°©us_™d_c⁄åﬁ_d©a
(
hw
);

704 
	}
}

706 
	$¢d_pcm_hw_ª£t
(
¢d_pcm_t
 *
pcm
)

708 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

709 
fd
 = 
hw
->fd, 
îr
;

710 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_RESET
) < 0) {

711 
îr
 = -
î∫o
;

712 
	`SYSMSG
("SNDRV_PCM_IOCTL_RESET faûed (%i)", 
îr
);

713  
îr
;

715  
	`quîy_°©us_™d_c⁄åﬁ_d©a
(
hw
);

716 
	}
}

718 
	$¢d_pcm_hw_°¨t
(
¢d_pcm_t
 *
pcm
)

720 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

721 
îr
;

723 
	`as£π
(
pcm
->
°ªam
 !
SND_PCM_STREAM_PLAYBACK
 ||

724 
	`¢d_pcm_mm≠_∂ayback_hw_avaû
(
pcm
) > 0);

726 
	`issue_≠∂±r
(
hw
);

727 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_START
) < 0) {

728 
îr
 = -
î∫o
;

729 
	`SYSMSG
("SNDRV_PCM_IOCTL_START faûed (%i)", 
îr
);

731 i‡(
îr
 =-
EBADFD
)

732 
	`SNDERR
("PCM sèã = %s", 
	`¢d_pcm_°©e_«me
(
	`¢d_pcm_hw_°©e
(
pcm
)));

734  
îr
;

737 
	}
}

739 
	$¢d_pcm_hw_dr›
(
¢d_pcm_t
 *
pcm
)

741 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

742 
îr
;

743 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_DROP
) < 0) {

744 
îr
 = -
î∫o
;

745 
	`SYSMSG
("SNDRV_PCM_IOCTL_DROP faûed (%i)", 
îr
);

746  
îr
;

750 
	}
}

752 
	$¢d_pcm_hw_døö
(
¢d_pcm_t
 *
pcm
)

754 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

755 
¢d_pcm_sw_∑øms_t
 
sw_∑øms
;

756 
¢d_pcm_u‰ames_t
 
sûí˚_size
;

757 
îr
;

759 i‡(
pcm
->
°ªam
 !
SND_PCM_STREAM_PLAYBACK
)

760 
__skù_sûí˚
;

762 i‡(
pcm
->
≥riod_size
 == 0)

763 
__skù_sûí˚
;

764 i‡(
hw
->
døö_sûí˚
 =0 || hw->
≥r„˘_døö
)

765 
__skù_sûí˚
;

766 
	`¢d_pcm_sw_∑øms_cuºít_no_lock
(
pcm
, &
sw_∑øms
);

767 i‡(
hw
->
døö_sûí˚
 > 0) {

768 
sûí˚_size
 = (
pcm
->
øã
 * 
hw
->
døö_sûí˚
) / 1000;

769 
__m™uÆ_sûí˚
;

772 i‡((
pcm
->
bound¨y
 %Öcm->
≥riod_size
) == 0) {

773 
sûí˚_size
 = 
pcm
->
≥riod_size
 - (*pcm->
≠∂
.
±r
 %Öcm->period_size);

774 i‡(
sûí˚_size
 =
pcm
->
≥riod_size
)

775 
sûí˚_size
 = 0;

781 
sûí˚_size
 = 
pcm
->
≥riod_size
;

783 
sûí˚_size
 +
pcm
->
øã
 / 10;

784 
__m™uÆ_sûí˚
:

785 i‡(
sw_∑øms
.
sûí˚_size
 < silence_size) {

789 
sw_∑øms
.
sûí˚_thªshﬁd
 = 
pcm
->
buf„r_size
;

790 i‡(
sûí˚_size
 > 
pcm
->
buf„r_size
)

791 
sûí˚_size
 = 
pcm
->
buf„r_size
;

792 
sw_∑øms
.
sûí˚_size
 = silence_size;

793 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_SW_PARAMS
, &
sw_∑øms
) < 0) {

794 
îr
 = -
î∫o
;

795 
	`SYSMSG
("SNDRV_PCM_IOCTL_SW_PARAMS faûed (%i)", 
îr
);

796  
îr
;

798 
hw
->
¥ï¨e_ª£t_sw_∑øms
 = 
åue
;

800 
__skù_sûí˚
:

801 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_DRAIN
) < 0) {

802 
îr
 = -
î∫o
;

803 
	`SYSMSG
("SNDRV_PCM_IOCTL_DRAIN faûed (%i)", 
îr
);

804  
îr
;

807 
	}
}

809 
	$¢d_pcm_hw_∑u£
(
¢d_pcm_t
 *
pcm
, 
íabÀ
)

811 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

812 
îr
;

813 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_PAUSE
, 
íabÀ
) < 0) {

814 
îr
 = -
î∫o
;

815 
	`SYSMSG
("SNDRV_PCM_IOCTL_PAUSE faûed (%i)", 
îr
);

816  
îr
;

819 
	}
}

821 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_hw_ªwödabÀ
(
¢d_pcm_t
 *
pcm
)

823  
	`¢d_pcm_mm≠_hw_ªwödabÀ
(
pcm
);

824 
	}
}

826 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_hw_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

828 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

829 
îr
;

830 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_REWIND
, &
‰ames
) < 0) {

831 
îr
 = -
î∫o
;

832 
	`SYSMSG
("SNDRV_PCM_IOCTL_REWIND faûed (%i)", 
îr
);

833  
îr
;

835 
îr
 = 
	`quîy_°©us_™d_c⁄åﬁ_d©a
(
hw
);

836 i‡(
îr
 < 0)

837  
îr
;

838  
‰ames
;

839 
	}
}

841 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_hw_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
)

843  
	`¢d_pcm_mm≠_avaû
(
pcm
);

844 
	}
}

846 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_hw_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

848 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

849 
îr
;

850 i‡(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4Ë<
hw
->
vîsi⁄
) {

851 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_FORWARD
, &
‰ames
) < 0) {

852 
îr
 = -
î∫o
;

853 
	`SYSMSG
("SNDRV_PCM_IOCTL_FORWARD faûed (%i)", 
îr
);

854  
îr
;

856 
îr
 = 
	`quîy_°©us_™d_c⁄åﬁ_d©a
(
hw
);

857 i‡(
îr
 < 0)

858  
îr
;

859  
‰ames
;

861 
¢d_pcm_s‰ames_t
 
avaû
;

863 
	`FAST_PCM_STATE
(
hw
)) {

864 
SNDRV_PCM_STATE_RUNNING
:

865 
SNDRV_PCM_STATE_DRAINING
:

866 
SNDRV_PCM_STATE_PAUSED
:

867 
SNDRV_PCM_STATE_PREPARED
:

869 
SNDRV_PCM_STATE_XRUN
:

870  -
EPIPE
;

872  -
EBADFD
;

874 
avaû
 = 
	`¢d_pcm_mm≠_avaû
(
pcm
);

875 i‡(
avaû
 < 0)

877 i‡(
‰ames
 > (
¢d_pcm_u‰ames_t
)
avaû
)

878 
‰ames
 = 
avaû
;

879 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
‰ames
);

880  
‰ames
;

882 
	}
}

884 
	$¢d_pcm_hw_ªsume
(
¢d_pcm_t
 *
pcm
)

886 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

887 
fd
 = 
hw
->fd, 
îr
;

888 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_RESUME
) < 0) {

889 
îr
 = -
î∫o
;

890 
	`SYSMSG
("SNDRV_PCM_IOCTL_RESUME faûed (%i)", 
îr
);

891  
îr
;

894 
	}
}

896 
	$hw_lök
(
¢d_pcm_t
 *
pcm1
, snd_pcm_à*
pcm2
)

898 
¢d_pcm_hw_t
 *
hw1
 = 
pcm1
->
¥iv©e_d©a
;

899 
¢d_pcm_hw_t
 *
hw2
 = 
pcm2
->
¥iv©e_d©a
;

900 i‡(
	`io˘l
(
hw1
->
fd
, 
SNDRV_PCM_IOCTL_LINK
, 
hw2
->fd) < 0) {

901 
	`SYSMSG
("SNDRV_PCM_IOCTL_LINK faûed (%i)", -
î∫o
);

902  -
î∫o
;

905 
	}
}

907 
	$¢d_pcm_hw_lök_¶aves
(
¢d_pcm_t
 *
pcm
, snd_pcm_à*
ma°î
)

909 i‡(
ma°î
->
ty≥
 !
SND_PCM_TYPE_HW
) {

910 
	`SYSMSG
("InvÆidÅy≥ f‹ SNDRV_PCM_IOCTL_LINK (%i)", 
ma°î
->
ty≥
);

911  -
EINVAL
;

913  
	`hw_lök
(
ma°î
, 
pcm
);

914 
	}
}

916 
	$¢d_pcm_hw_lök
(
¢d_pcm_t
 *
pcm1
, snd_pcm_à*
pcm2
)

918 i‡(
pcm2
->
ty≥
 !
SND_PCM_TYPE_HW
) {

919 i‡(
pcm2
->
Á°_›s
->
lök_¶aves
)

920  
pcm2
->
Á°_›s
->
	`lök_¶aves
’cm2->
Á°_›_¨g
, 
pcm1
);

921  -
ENOSYS
;

923  
	`hw_lök
(
pcm1
, 
pcm2
);

924 
	}
}

926 
	$¢d_pcm_hw_u∆ök
(
¢d_pcm_t
 *
pcm
)

928 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

930 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_UNLINK
) < 0) {

931 
	`SYSMSG
("SNDRV_PCM_IOCTL_UNLINK faûed (%i)", -
î∫o
);

932  -
î∫o
;

935 
	}
}

937 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_hw_wrôei
(
¢d_pcm_t
 *
pcm
, c⁄° *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

939 
îr
;

940 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

941 
fd
 = 
hw
->fd;

942 
¢d_x„ri
 
x„ri
;

943 
x„ri
.
buf
 = (*Ë
buf„r
;

944 
x„ri
.
‰ames
 = 
size
;

945 
x„ri
.
ªsu…
 = 0;

946 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_WRITEI_FRAMES
, &
x„ri
) < 0)

947 
îr
 = -
î∫o
;

949 
îr
 = 
	`quîy_°©us_™d_c⁄åﬁ_d©a
(
hw
);

950 #ifde‡
DEBUG_RW


951 
	`Ârötf
(
°dîr
, "hw_wrôei: føme†%li, x„ri.ªsu… = %li,Éº = %i\n", 
size
, 
x„ri
.
ªsu…
, 
îr
);

953 i‡(
îr
 < 0)

954  
	`¢d_pcm_check_îr‹
(
pcm
, 
îr
);

955  
x„ri
.
ªsu…
;

956 
	}
}

958 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_hw_wrôí
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

960 
îr
;

961 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

962 
fd
 = 
hw
->fd;

963 
¢d_x„∫
 
x„∫
;

964 
	`mem£t
(&
x„∫
, 0, (xfern));

965 
x„∫
.
bufs
 = bufs;

966 
x„∫
.
‰ames
 = 
size
;

967 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_WRITEN_FRAMES
, &
x„∫
) < 0)

968 
îr
 = -
î∫o
;

970 
îr
 = 
	`quîy_°©us_™d_c⁄åﬁ_d©a
(
hw
);

971 #ifde‡
DEBUG_RW


972 
	`Ârötf
(
°dîr
, "hw_wrôí: føme†%li,Ñesu… = %li,Éº = %i\n", 
size
, 
x„∫
.
ªsu…
, 
îr
);

974 i‡(
îr
 < 0)

975  
	`¢d_pcm_check_îr‹
(
pcm
, 
îr
);

976  
x„∫
.
ªsu…
;

977 
	}
}

979 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_hw_ªadi
(
¢d_pcm_t
 *
pcm
, *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

981 
îr
;

982 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

983 
fd
 = 
hw
->fd;

984 
¢d_x„ri
 
x„ri
;

985 
x„ri
.
buf
 = 
buf„r
;

986 
x„ri
.
‰ames
 = 
size
;

987 
x„ri
.
ªsu…
 = 0;

988 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_READI_FRAMES
, &
x„ri
) < 0)

989 
îr
 = -
î∫o
;

991 
îr
 = 
	`quîy_°©us_™d_c⁄åﬁ_d©a
(
hw
);

992 #ifde‡
DEBUG_RW


993 
	`Ârötf
(
°dîr
, "hw_ªadi: føme†%li,Ñesu… = %li,Éº = %i\n", 
size
, 
x„ri
.
ªsu…
, 
îr
);

995 i‡(
îr
 < 0)

996  
	`¢d_pcm_check_îr‹
(
pcm
, 
îr
);

997  
x„ri
.
ªsu…
;

998 
	}
}

1000 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_hw_ªadn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

1002 
îr
;

1003 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

1004 
fd
 = 
hw
->fd;

1005 
¢d_x„∫
 
x„∫
;

1006 
	`mem£t
(&
x„∫
, 0, (xfern));

1007 
x„∫
.
bufs
 = bufs;

1008 
x„∫
.
‰ames
 = 
size
;

1009 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_READN_FRAMES
, &
x„∫
) < 0)

1010 
îr
 = -
î∫o
;

1012 
îr
 = 
	`quîy_°©us_™d_c⁄åﬁ_d©a
(
hw
);

1013 #ifde‡
DEBUG_RW


1014 
	`Ârötf
(
°dîr
, "hw_ªadn: føme†%li,Ñesu… = %li,Éº = %i\n", 
size
, 
x„∫
.
ªsu…
, 
îr
);

1016 i‡(
îr
 < 0)

1017  
	`¢d_pcm_check_îr‹
(
pcm
, 
îr
);

1018  
x„∫
.
ªsu…
;

1019 
	}
}

1021 
boﬁ
 
	$m≠_°©us_d©a
(
¢d_pcm_hw_t
 *
hw
, 
¢d_pcm_sync_±r
 *
sync_±r
,

1022 
boﬁ
 
f‹˚_ÁŒback
)

1024 
¢d_pcm_mm≠_°©us
 *
mm≠_°©us
;

1025 
boﬁ
 
ÁŒbacked
;

1027 
mm≠_°©us
 = 
MAP_FAILED
;

1028 i‡(!
f‹˚_ÁŒback
) {

1029 
mm≠_°©us
 = 
	`mm≠
(
NULL
, 
	`∑ge_Æign
((*mmap_status)),

1030 
PROT_READ
, 
MAP_FILE
|
MAP_SHARED
,

1031 
hw
->
fd
, 
SNDRV_PCM_MMAP_OFFSET_STATUS
);

1034 i‡(
mm≠_°©us
 =
MAP_FAILED
 || mm≠_°©u†=
NULL
) {

1035 
mm≠_°©us
 = &
sync_±r
->
s
.
°©us
;

1036 
ÁŒbacked
 = 
åue
;

1038 
ÁŒbacked
 = 
Ál£
;

1041 
hw
->
mm≠_°©us
 = mmap_status;

1043  
ÁŒbacked
;

1044 
	}
}

1046 
boﬁ
 
	$m≠_c⁄åﬁ_d©a
(
¢d_pcm_hw_t
 *
hw
,

1047 
¢d_pcm_sync_±r
 *
sync_±r
,

1048 
boﬁ
 
f‹˚_ÁŒback
)

1050 
¢d_pcm_mm≠_c⁄åﬁ
 *
mm≠_c⁄åﬁ
;

1051 
boﬁ
 
ÁŒbacked
;

1053 
mm≠_c⁄åﬁ
 = 
MAP_FAILED
;

1054 i‡(!
f‹˚_ÁŒback
) {

1055 
mm≠_c⁄åﬁ
 = 
	`mm≠
(
NULL
, 
	`∑ge_Æign
((*mmap_control)),

1056 
PROT_READ
|
PROT_WRITE
, 
MAP_FILE
|
MAP_SHARED
,

1057 
hw
->
fd
, 
SNDRV_PCM_MMAP_OFFSET_CONTROL
);

1060 i‡(
mm≠_c⁄åﬁ
 =
MAP_FAILED
 || mm≠_c⁄åﬁ =
NULL
) {

1061 
mm≠_c⁄åﬁ
 = &
sync_±r
->
c
.
c⁄åﬁ
;

1062 
ÁŒbacked
 = 
åue
;

1064 
ÁŒbacked
 = 
Ál£
;

1067 
hw
->
mm≠_c⁄åﬁ
 = mmap_control;

1069  
ÁŒbacked
;

1070 
	}
}

1072 
	$m≠_°©us_™d_c⁄åﬁ_d©a
(
¢d_pcm_t
 *
pcm
, 
boﬁ
 
f‹˚_ÁŒback
)

1074 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

1075 
¢d_pcm_sync_±r
 *
sync_±r
;

1076 
îr
;

1079 
sync_±r
 = 
	`mÆloc
((*sync_ptr));

1080 i‡(
sync_±r
 =
NULL
)

1081  -
ENOMEM
;

1082 
	`mem£t
(
sync_±r
, 0, (*sync_ptr));

1084 
hw
->
mm≠_°©us_ÁŒbacked
 =

1085 
	`m≠_°©us_d©a
(
hw
, 
sync_±r
, 
f‹˚_ÁŒback
);

1086 
hw
->
mm≠_c⁄åﬁ_ÁŒbacked
 =

1087 
	`m≠_c⁄åﬁ_d©a
(
hw
, 
sync_±r
, 
f‹˚_ÁŒback
);

1090 i‡(
hw
->
mm≠_°©us_ÁŒbacked
 || hw->
mm≠_c⁄åﬁ_ÁŒbacked
) {

1091 
hw
->
sync_±r
 = sync_ptr;

1093 
	`‰ì
(
sync_±r
);

1094 
hw
->
sync_±r
 = 
NULL
;

1100 i‡(!(
pcm
->
mode
 & 
SND_PCM_APPEND
)) {

1102 
hw
->
mm≠_c⁄åﬁ
->
≠∂_±r
 = 0;

1103 
hw
->
mm≠_c⁄åﬁ
->
avaû_mö
 = 1;

1105 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
hw
->
mm≠_°©us
->
hw_±r
, hw->
fd
,

1106 
SNDRV_PCM_MMAP_OFFSET_STATUS
 +

1107 
	`off£tof
(
¢d_pcm_mm≠_°©us
, 
hw_±r
));

1108 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
hw
->
mm≠_c⁄åﬁ
->
≠∂_±r
, hw->
fd
,

1109 
SNDRV_PCM_MMAP_OFFSET_CONTROL
);

1110 i‡(
hw
->
mm≠_c⁄åﬁ_ÁŒbacked
) {

1111 
Êags
 = 0;

1115 i‡(
pcm
->
mode
 & 
SND_PCM_APPEND
)

1116 
Êags
 = 
SNDRV_PCM_SYNC_PTR_APPL
 |

1117 
SNDRV_PCM_SYNC_PTR_AVAIL_MIN
;

1118 
îr
 = 
	`sync_±r1
(
hw
, 
Êags
);

1119 i‡(
îr
 < 0)

1120  
îr
;

1124 
	}
}

1126 
	$unm≠_°©us_d©a
(
¢d_pcm_hw_t
 *
hw
)

1128 i‡(!
hw
->
mm≠_°©us_ÁŒbacked
) {

1129 i‡(
	`munm≠
((*)
hw
->
mm≠_°©us
,

1130 
	`∑ge_Æign
((*
hw
->
mm≠_°©us
))) < 0)

1131 
	`SYSMSG
("°©u†munm≠ faûed (%u)", 
î∫o
);

1133 
	}
}

1135 
	$unm≠_c⁄åﬁ_d©a
(
¢d_pcm_hw_t
 *
hw
)

1137 i‡(!
hw
->
mm≠_c⁄åﬁ_ÁŒbacked
) {

1138 i‡(
	`munm≠
((*)
hw
->
mm≠_c⁄åﬁ
,

1139 
	`∑ge_Æign
((*
hw
->
mm≠_c⁄åﬁ
))) < 0)

1140 
	`SYSMSG
("c⁄åﬁ munm≠ faûed (%u)", 
î∫o
);

1142 
	}
}

1144 
	$unm≠_°©us_™d_c⁄åﬁ_d©a
(
¢d_pcm_hw_t
 *
hw
)

1146 
	`unm≠_°©us_d©a
(
hw
);

1147 
	`unm≠_c⁄åﬁ_d©a
(
hw
);

1149 i‡(
hw
->
mm≠_°©us_ÁŒbacked
 || hw->
mm≠_c⁄åﬁ_ÁŒbacked
)

1150 
	`‰ì
(
hw
->
sync_±r
);

1152 
hw
->
mm≠_°©us
 = 
NULL
;

1153 
hw
->
mm≠_c⁄åﬁ
 = 
NULL
;

1154 
hw
->
mm≠_°©us_ÁŒbacked
 = 
Ál£
;

1155 
hw
->
mm≠_c⁄åﬁ_ÁŒbacked
 = 
Ál£
;

1156 
hw
->
sync_±r
 = 
NULL
;

1157 
	}
}

1159 
	$¢d_pcm_hw_mm≠
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1162 
	}
}

1164 
	$¢d_pcm_hw_munm≠
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1167 
	}
}

1169 
	$¢d_pcm_hw_˛o£
(
¢d_pcm_t
 *
pcm
)

1171 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

1172 
îr
 = 0;

1173 i‡(
	`˛o£
(
hw
->
fd
)) {

1174 
îr
 = -
î∫o
;

1175 
	`SYSMSG
("˛o£ faûed (%i)", 
îr
);

1178 
	`unm≠_°©us_™d_c⁄åﬁ_d©a
(
hw
);

1180 
	`‰ì
(
hw
);

1181  
îr
;

1182 
	}
}

1184 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_hw_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

1185 
¢d_pcm_u‰ames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

1186 
¢d_pcm_u‰ames_t
 
size
)

1188 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

1190 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
size
);

1191 
	`issue_≠∂±r
(
hw
);

1192 #ifde‡
DEBUG_MMAP


1193 
	`Ârötf
(
°dîr
, "≠∂_f‹w¨d: hw_±∏%li,áµl_±∏%li, sizê%li\n", *
pcm
->
hw
.
±r
, *pcm->
≠∂
.±r, 
size
);

1195  
size
;

1196 
	}
}

1198 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_hw_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

1200 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

1201 
¢d_pcm_u‰ames_t
 
avaû
;

1203 
	`quîy_°©us_d©a
(
hw
);

1204 
avaû
 = 
	`¢d_pcm_mm≠_avaû
(
pcm
);

1205 
	`FAST_PCM_STATE
(
hw
)) {

1206 
SNDRV_PCM_STATE_RUNNING
:

1207 i‡(
avaû
 >
pcm
->
°›_thªshﬁd
) {

1209 i‡(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 1Ë<
hw
->
vîsi⁄
) {

1210 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_PCM_IOCTL_XRUN
) < 0)

1211  -
î∫o
;

1214  -
EPIPE
;

1217 
SNDRV_PCM_STATE_XRUN
:

1218  -
EPIPE
;

1222  
avaû
;

1223 
	}
}

1225 
	$¢d_pcm_hw_htime°amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 *
avaû
,

1226 
¢d_htime°amp_t
 *
t°amp
)

1228 
¢d_pcm_s‰ames_t
 
avaû1
;

1229 
ok
 = 0;

1233 
avaû1
 = 
	`¢d_pcm_hw_avaû_upd©e
(
pcm
);

1234 i‡(
avaû1
 < 0)

1235  
avaû1
;

1236 i‡(
ok
 && (
¢d_pcm_u‰ames_t
)
avaû1
 =*
avaû
)

1238 *
avaû
 = 
avaû1
;

1239 *
t°amp
 = 
	`¢d_pcm_hw_Á°_t°amp
(
pcm
);

1240 
ok
 = 1;

1243 
	}
}

1245 
	$__fûl_chm≠_˘l_id
(
¢d_˘l_ñem_id_t
 *
id
, 
dev
, 
subdev
,

1246 
°ªam
)

1248 
	`¢d_˘l_ñem_id_£t_öãrÁ˚
(
id
, 
SND_CTL_ELEM_IFACE_PCM
);

1249 i‡(
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

1250 
	`¢d_˘l_ñem_id_£t_«me
(
id
, "Playback Channel Map");

1252 
	`¢d_˘l_ñem_id_£t_«me
(
id
, "Capture Channel Map");

1253 
	`¢d_˘l_ñem_id_£t_devi˚
(
id
, 
dev
);

1254 
	`¢d_˘l_ñem_id_£t_ödex
(
id
, 
subdev
);

1255 
	}
}

1257 
	$fûl_chm≠_˘l_id
(
¢d_pcm_t
 *
pcm
, 
¢d_˘l_ñem_id_t
 *
id
)

1259 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

1260 
	`__fûl_chm≠_˘l_id
(
id
, 
hw
->
devi˚
, hw->
subdevi˚
, 
pcm
->
°ªam
);

1261 
	}
}

1263 
	$is_chm≠_ty≥
(
ty≥
)

1265  (
ty≥
 >
SND_CTL_TLVT_CHMAP_FIXED
 &&

1266 
ty≥
 <
SND_CTL_TLVT_CHMAP_PAIRED
);

1267 
	}
}

1285 
¢d_pcm_chm≠_quîy_t
 **

1286 
	$¢d_pcm_quîy_chm≠s_‰om_hw
(
ˇrd
, 
dev
, 
subdev
,

1287 
¢d_pcm_°ªam_t
 
°ªam
)

1289 
¢d_˘l_t
 *
˘l
;

1290 
¢d_˘l_ñem_id_t
 
id
 = {0};

1291 
év
[2048], *
°¨t
;

1292 
ty≥
;

1293 
¢d_pcm_chm≠_quîy_t
 **
m≠
;

1294 
i
, 
ªt
, 
nums
;

1296 
ªt
 = 
	`¢d_˘l_hw_›í
(&
˘l
, 
NULL
, 
ˇrd
, 0);

1297 i‡(
ªt
 < 0) {

1298 
	`SYSMSG
("Cannot openÅheássociated CTL");

1299  
NULL
;

1302 
	`__fûl_chm≠_˘l_id
(&
id
, 
dev
, 
subdev
, 
°ªam
);

1303 
ªt
 = 
	`¢d_˘l_ñem_év_ªad
(
˘l
, &
id
, 
év
, (tlv));

1304 
	`¢d_˘l_˛o£
(
˘l
);

1305 i‡(
ªt
 < 0) {

1306 
	`SYSMSG
("CannotÑead Channel Map TLV");

1307  
NULL
;

1311 
i
 = 0; i < 32; i++)

1312 
	`Ârötf
(
°dîr
, "%02x: %08x\n", 
i
, 
év
[i]);

1317 
ty≥
 = 
év
[
SNDRV_CTL_TLVO_TYPE
];

1318 i‡(
ty≥
 !
SND_CTL_TLVT_CONTAINER
) {

1319 i‡(!
	`is_chm≠_ty≥
(
ty≥
)) {

1320 
	`SYSMSG
("InvÆid TLVÅy≥ %d", 
ty≥
);

1321  
NULL
;

1323 
°¨t
 = 
év
;

1324 
nums
 = 1;

1326 *
p
;

1327 
size
;

1328 
°¨t
 = 
év
 + 2;

1329 
size
 = 
év
[
SNDRV_CTL_TLVO_LEN
];

1330 
nums
 = 0;

1331 
p
 = 
°¨t
; 
size
 > 0; ) {

1332 i‡(!
	`is_chm≠_ty≥
(
p
[0])) {

1333 
	`SYSMSG
("InvÆid TLVÅy≥ %d", 
p
[0]);

1334  
NULL
;

1336 
nums
++;

1337 
size
 -
p
[1] + 8;

1338 
p
 +=Ö[1] / 4 + 2;

1341 
m≠
 = 
	`ˇŒoc
(
nums
 + 1, (*));

1342 i‡(!
m≠
)

1343  
NULL
;

1344 
i
 = 0; i < 
nums
; i++) {

1345 
m≠
[
i
] = 
	`mÆloc
(
°¨t
[1] + 8);

1346 i‡(!
m≠
[
i
]) {

1347 
	`¢d_pcm_‰ì_chm≠s
(
m≠
);

1348  
NULL
;

1350 
m≠
[
i
]->
ty≥
 = 
°¨t
[0] - 0x100;

1351 
m≠
[
i
]->m≠.
ch™√ls
 = 
°¨t
[1] / 4;

1352 
	`mem˝y
(
m≠
[
i
]->m≠.
pos
, 
°¨t
 + 2, start[1]);

1353 
°¨t
 += start[1] / 4 + 2;

1355  
m≠
;

1356 
	}
}

1358 íum { 
	mCHMAP_CTL_QUERY
, 
	mCHMAP_CTL_GET
, 
	mCHMAP_CTL_SET
 };

1360 
	$chm≠_ˇps
(
¢d_pcm_hw_t
 *
hw
, 
ty≥
)

1362 i‡(
hw
->
chm≠_ˇps
 & (1 << 
ty≥
))

1364 i‡(
hw
->
chm≠_ˇps
 & (1 << (
ty≥
 + 8)))

1367 
	}
}

1369 
	$chm≠_ˇps_£t_ok
(
¢d_pcm_hw_t
 *
hw
, 
ty≥
)

1371 
hw
->
chm≠_ˇps
 |(1 << 
ty≥
);

1372 
	}
}

1374 
	$chm≠_ˇps_£t_îr‹
(
¢d_pcm_hw_t
 *
hw
, 
ty≥
)

1376 
hw
->
chm≠_ˇps
 |(1 << (
ty≥
 + 8));

1377 
	}
}

1379 
¢d_pcm_chm≠_quîy_t
 **
	$¢d_pcm_hw_quîy_chm≠s
(
¢d_pcm_t
 *
pcm
)

1381 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

1382 
¢d_pcm_chm≠_quîy_t
 **
m≠
;

1384 i‡(
hw
->
chm≠_ovîride
)

1385  
	`_¢d_pcm_c›y_chm≠_quîy
(
hw
->
chm≠_ovîride
);

1387 i‡(!
	`chm≠_ˇps
(
hw
, 
CHMAP_CTL_QUERY
))

1388  
NULL
;

1390 
m≠
 = 
	`¢d_pcm_quîy_chm≠s_‰om_hw
(
hw
->
ˇrd
, hw->
devi˚
,

1391 
hw
->
subdevi˚
, 
pcm
->
°ªam
);

1392 i‡(
m≠
)

1393 
	`chm≠_ˇps_£t_ok
(
hw
, 
CHMAP_CTL_QUERY
);

1395 
	`chm≠_ˇps_£t_îr‹
(
hw
, 
CHMAP_CTL_QUERY
);

1396  
m≠
;

1397 
	}
}

1399 
¢d_pcm_chm≠_t
 *
	$¢d_pcm_hw_gë_chm≠
(
¢d_pcm_t
 *
pcm
)

1401 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

1402 
¢d_pcm_chm≠_t
 *
m≠
;

1403 
¢d_˘l_t
 *
˘l
;

1404 
¢d_˘l_ñem_id_t
 
id
 = {0};

1405 
¢d_˘l_ñem_vÆue_t
 
vÆ
 = {0};

1406 
i
;

1407 
ªt
;

1409 i‡(
hw
->
chm≠_ovîride
)

1410  
	`_¢d_pcm_choo£_fixed_chm≠
(
pcm
, 
hw
->
chm≠_ovîride
);

1412 i‡(!
	`chm≠_ˇps
(
hw
, 
CHMAP_CTL_GET
))

1413  
NULL
;

1415 
	`FAST_PCM_STATE
(
hw
)) {

1416 
SNDRV_PCM_STATE_PREPARED
:

1417 
SNDRV_PCM_STATE_RUNNING
:

1418 
SNDRV_PCM_STATE_XRUN
:

1419 
SNDRV_PCM_STATE_DRAINING
:

1420 
SNDRV_PCM_STATE_PAUSED
:

1421 
SNDRV_PCM_STATE_SUSPENDED
:

1424 
	`SYSMSG
("Invalid PCM state for chmap_get: %s",

1425 
	`¢d_pcm_°©e_«me
(
	`FAST_PCM_STATE
(
hw
)));

1426  
NULL
;

1428 
m≠
 = 
	`mÆloc
(
pcm
->
ch™√ls
 * (m≠->
pos
[0]) + (*map));

1429 i‡(!
m≠
)

1430  
NULL
;

1431 
m≠
->
ch™√ls
 = 
pcm
->channels;

1432 
ªt
 = 
	`¢d_˘l_hw_›í
(&
˘l
, 
NULL
, 
hw
->
ˇrd
, 0);

1433 i‡(
ªt
 < 0) {

1434 
	`‰ì
(
m≠
);

1435 
	`SYSMSG
("Cannot openÅheássociated CTL");

1436 
	`chm≠_ˇps_£t_îr‹
(
hw
, 
CHMAP_CTL_GET
);

1437  
NULL
;

1439 
	`fûl_chm≠_˘l_id
(
pcm
, &
id
);

1440 
	`¢d_˘l_ñem_vÆue_£t_id
(&
vÆ
, &
id
);

1441 
ªt
 = 
	`¢d_˘l_ñem_ªad
(
˘l
, &
vÆ
);

1442 
	`¢d_˘l_˛o£
(
˘l
);

1443 i‡(
ªt
 < 0) {

1444 
	`‰ì
(
m≠
);

1445 
	`SYSMSG
("CannotÑead Channel Map ctl");

1446 
	`chm≠_ˇps_£t_îr‹
(
hw
, 
CHMAP_CTL_GET
);

1447  
NULL
;

1449 
i
 = 0; i < 
pcm
->
ch™√ls
; i++)

1450 
m≠
->
pos
[
i
] = 
	`¢d_˘l_ñem_vÆue_gë_öãgî
(&
vÆ
, i);

1451 
	`chm≠_ˇps_£t_ok
(
hw
, 
CHMAP_CTL_GET
);

1452  
m≠
;

1453 
	}
}

1455 
	$¢d_pcm_hw_£t_chm≠
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_chm≠_t
 *
m≠
)

1457 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

1458 
¢d_˘l_t
 *
˘l
;

1459 
¢d_˘l_ñem_id_t
 
id
 = {0};

1460 
¢d_˘l_ñem_vÆue_t
 
vÆ
 = {0};

1461 
i
;

1462 
ªt
;

1464 i‡(
hw
->
chm≠_ovîride
)

1465  -
ENXIO
;

1467 i‡(!
	`chm≠_ˇps
(
hw
, 
CHMAP_CTL_SET
))

1468  -
ENXIO
;

1470 i‡(
m≠
->
ch™√ls
 > 128) {

1471 
	`SYSMSG
("InvÆidÇumbî o‡ch™√l†%d", 
m≠
->
ch™√ls
);

1472  -
EINVAL
;

1474 i‡(
	`FAST_PCM_STATE
(
hw
Ë!
SNDRV_PCM_STATE_PREPARED
) {

1475 
	`SYSMSG
("Invalid PCM state for chmap_set: %s",

1476 
	`¢d_pcm_°©e_«me
(
	`FAST_PCM_STATE
(
hw
)));

1477  -
EBADFD
;

1479 
ªt
 = 
	`¢d_˘l_hw_›í
(&
˘l
, 
NULL
, 
hw
->
ˇrd
, 0);

1480 i‡(
ªt
 < 0) {

1481 
	`SYSMSG
("Cannot openÅheássociated CTL");

1482 
	`chm≠_ˇps_£t_îr‹
(
hw
, 
CHMAP_CTL_SET
);

1483  
ªt
;

1486 
	`fûl_chm≠_˘l_id
(
pcm
, &
id
);

1487 
	`¢d_˘l_ñem_vÆue_£t_id
(&
vÆ
, &
id
);

1488 
i
 = 0; i < 
m≠
->
ch™√ls
; i++)

1489 
	`¢d_˘l_ñem_vÆue_£t_öãgî
(&
vÆ
, 
i
, 
m≠
->
pos
[i]);

1490 
ªt
 = 
	`¢d_˘l_ñem_wrôe
(
˘l
, &
vÆ
);

1491 
	`¢d_˘l_˛o£
(
˘l
);

1492 i‡(
ªt
 >= 0)

1493 
	`chm≠_ˇps_£t_ok
(
hw
, 
CHMAP_CTL_SET
);

1494 i‡(
ªt
 =-
ENOENT
 ||Ñë =-
EPERM
 ||Ñë =-
ENXIO
) {

1495 
	`chm≠_ˇps_£t_îr‹
(
hw
, 
CHMAP_CTL_SET
);

1496 
ªt
 = -
ENXIO
;

1498 i‡(
ªt
 < 0)

1499 
	`SYSMSG
("Cannot write Channel Map ctl");

1500  
ªt
;

1501 
	}
}

1503 
	$¢d_pcm_hw_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

1505 
¢d_pcm_hw_t
 *
hw
 = 
pcm
->
¥iv©e_d©a
;

1506 *
«me
;

1507 
îr
 = 
	`¢d_ˇrd_gë_«me
(
hw
->
ˇrd
, &
«me
);

1508 i‡(
îr
 < 0) {

1509 
	`SNDERR
("cannot get cardÇame");

1512 
	`¢d_ouçut_¥ötf
(
out
, "Hardware PCM card %d '%s' device %d subdevice %d\n",

1513 
hw
->
ˇrd
, 
«me
, hw->
devi˚
, hw->
subdevi˚
);

1514 
	`‰ì
(
«me
);

1515 i‡(
pcm
->
£tup
) {

1516 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

1517 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

1518 
	`¢d_ouçut_¥ötf
(
out
, "áµl_±∏ : %li\n", 
hw
->
mm≠_c⁄åﬁ
->
≠∂_±r
);

1519 
	`¢d_ouçut_¥ötf
(
out
, " hw_±∏ : %li\n", 
hw
->
mm≠_°©us
->
hw_±r
);

1521 
	}
}

1523 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_hw_›s
 = {

1524 .
˛o£
 = 
¢d_pcm_hw_˛o£
,

1525 .
	göfo
 = 
¢d_pcm_hw_öfo
,

1526 .
	ghw_ªföe
 = 
¢d_pcm_hw_hw_ªföe
,

1527 .
	ghw_∑øms
 = 
¢d_pcm_hw_hw_∑øms
,

1528 .
	ghw_‰ì
 = 
¢d_pcm_hw_hw_‰ì
,

1529 .
	gsw_∑øms
 = 
¢d_pcm_hw_sw_∑øms
,

1530 .
	gch™√l_öfo
 = 
¢d_pcm_hw_ch™√l_öfo
,

1531 .
	gdump
 = 
¢d_pcm_hw_dump
,

1532 .
	gn⁄block
 = 
¢d_pcm_hw_n⁄block
,

1533 .
	gasync
 = 
¢d_pcm_hw_async
,

1534 .
	gmm≠
 = 
¢d_pcm_hw_mm≠
,

1535 .
	gmunm≠
 = 
¢d_pcm_hw_munm≠
,

1536 .
	gquîy_chm≠s
 = 
¢d_pcm_hw_quîy_chm≠s
,

1537 .
	ggë_chm≠
 = 
¢d_pcm_hw_gë_chm≠
,

1538 .
	g£t_chm≠
 = 
¢d_pcm_hw_£t_chm≠
,

1541 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_hw_Á°_›s
 = {

1542 .
°©us
 = 
¢d_pcm_hw_°©us
,

1543 .
	g°©e
 = 
¢d_pcm_hw_°©e
,

1544 .
	ghwsync
 = 
¢d_pcm_hw_hwsync
,

1545 .
	gdñay
 = 
¢d_pcm_hw_dñay
,

1546 .
	g¥ï¨e
 = 
¢d_pcm_hw_¥ï¨e
,

1547 .
	gª£t
 = 
¢d_pcm_hw_ª£t
,

1548 .
	g°¨t
 = 
¢d_pcm_hw_°¨t
,

1549 .
	gdr›
 = 
¢d_pcm_hw_dr›
,

1550 .
	gdøö
 = 
¢d_pcm_hw_døö
,

1551 .
	g∑u£
 = 
¢d_pcm_hw_∑u£
,

1552 .
	gªwödabÀ
 = 
¢d_pcm_hw_ªwödabÀ
,

1553 .
	gªwöd
 = 
¢d_pcm_hw_ªwöd
,

1554 .
	gf‹w¨dabÀ
 = 
¢d_pcm_hw_f‹w¨dabÀ
,

1555 .
	gf‹w¨d
 = 
¢d_pcm_hw_f‹w¨d
,

1556 .
	gªsume
 = 
¢d_pcm_hw_ªsume
,

1557 .
	glök
 = 
¢d_pcm_hw_lök
,

1558 .
	glök_¶aves
 = 
¢d_pcm_hw_lök_¶aves
,

1559 .
	gu∆ök
 = 
¢d_pcm_hw_u∆ök
,

1560 .
	gwrôei
 = 
¢d_pcm_hw_wrôei
,

1561 .
	gwrôí
 = 
¢d_pcm_hw_wrôí
,

1562 .
	gªadi
 = 
¢d_pcm_hw_ªadi
,

1563 .
	gªadn
 = 
¢d_pcm_hw_ªadn
,

1564 .
	gavaû_upd©e
 = 
¢d_pcm_hw_avaû_upd©e
,

1565 .
	gmm≠_commô
 = 
¢d_pcm_hw_mm≠_commô
,

1566 .
	ghtime°amp
 = 
¢d_pcm_hw_htime°amp
,

1567 .
	gpﬁl_des¸ùt‹s
 = 
NULL
,

1568 .
	gpﬁl_des¸ùt‹s_cou¡
 = 
NULL
,

1569 .
	gpﬁl_ªvíts
 = 
NULL
,

1572 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_hw_Á°_›s_timî
 = {

1573 .
°©us
 = 
¢d_pcm_hw_°©us
,

1574 .
	g°©e
 = 
¢d_pcm_hw_°©e
,

1575 .
	ghwsync
 = 
¢d_pcm_hw_hwsync
,

1576 .
	gdñay
 = 
¢d_pcm_hw_dñay
,

1577 .
	g¥ï¨e
 = 
¢d_pcm_hw_¥ï¨e
,

1578 .
	gª£t
 = 
¢d_pcm_hw_ª£t
,

1579 .
	g°¨t
 = 
¢d_pcm_hw_°¨t
,

1580 .
	gdr›
 = 
¢d_pcm_hw_dr›
,

1581 .
	gdøö
 = 
¢d_pcm_hw_døö
,

1582 .
	g∑u£
 = 
¢d_pcm_hw_∑u£
,

1583 .
	gªwödabÀ
 = 
¢d_pcm_hw_ªwödabÀ
,

1584 .
	gªwöd
 = 
¢d_pcm_hw_ªwöd
,

1585 .
	gf‹w¨dabÀ
 = 
¢d_pcm_hw_f‹w¨dabÀ
,

1586 .
	gf‹w¨d
 = 
¢d_pcm_hw_f‹w¨d
,

1587 .
	gªsume
 = 
¢d_pcm_hw_ªsume
,

1588 .
	glök
 = 
¢d_pcm_hw_lök
,

1589 .
	glök_¶aves
 = 
¢d_pcm_hw_lök_¶aves
,

1590 .
	gu∆ök
 = 
¢d_pcm_hw_u∆ök
,

1591 .
	gwrôei
 = 
¢d_pcm_hw_wrôei
,

1592 .
	gwrôí
 = 
¢d_pcm_hw_wrôí
,

1593 .
	gªadi
 = 
¢d_pcm_hw_ªadi
,

1594 .
	gªadn
 = 
¢d_pcm_hw_ªadn
,

1595 .
	gavaû_upd©e
 = 
¢d_pcm_hw_avaû_upd©e
,

1596 .
	gmm≠_commô
 = 
¢d_pcm_hw_mm≠_commô
,

1597 .
	ghtime°amp
 = 
¢d_pcm_hw_htime°amp
,

1598 .
	gpﬁl_des¸ùt‹s
 = 
¢d_pcm_hw_pﬁl_des¸ùt‹s
,

1599 .
	gpﬁl_des¸ùt‹s_cou¡
 = 
¢d_pcm_hw_pﬁl_des¸ùt‹s_cou¡
,

1600 .
	gpﬁl_ªvíts
 = 
¢d_pcm_hw_pﬁl_ªvíts
,

1614 
	$¢d_pcm_hw_›í_fd
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
, 
fd
,

1615 
sync_±r_io˘l
)

1617 
vî
, 
mode
;

1618 
¢d_pcm_t°amp_ty≥_t
 
t°amp_ty≥
 = 
SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY
;

1619 
fmode
;

1620 
¢d_pcm_t
 *
pcm
 = 
NULL
;

1621 
¢d_pcm_hw_t
 *
hw
 = 
NULL
;

1622 
¢d_pcm_öfo_t
 
öfo
;

1623 
ªt
;

1625 
	`as£π
(
pcmp
);

1627 
	`mem£t
(&
öfo
, 0, (info));

1628 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_INFO
, &
öfo
) < 0) {

1629 
ªt
 = -
î∫o
;

1630 
	`SYSMSG
("SNDRV_PCM_IOCTL_INFO faûed (%i)", 
ªt
);

1631 
	`˛o£
(
fd
);

1632  
ªt
;

1636 i‡((
fmode
 = 
	`f˙é
(
fd
, 
F_GETFL
)) < 0) {

1637 
ªt
 = -
î∫o
;

1638 
	`˛o£
(
fd
);

1639  
ªt
;

1641 
mode
 = 0;

1642 i‡(
fmode
 & 
O_NONBLOCK
)

1643 
mode
 |
SND_PCM_NONBLOCK
;

1644 i‡(
fmode
 & 
O_ASYNC
)

1645 
mode
 |
SND_PCM_ASYNC
;

1646 i‡(
fmode
 & 
O_APPEND
)

1647 
mode
 |
SND_PCM_APPEND
;

1649 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_PVERSION
, &
vî
) < 0) {

1650 
ªt
 = -
î∫o
;

1651 
	`SYSMSG
("SNDRV_PCM_IOCTL_PVERSION faûed (%i)", 
ªt
);

1652 
	`˛o£
(
fd
);

1653  
ªt
;

1655 i‡(
	`SNDRV_PROTOCOL_INCOMPATIBLE
(
vî
, 
SNDRV_PCM_VERSION_MAX
))

1656  -
SND_ERROR_INCOMPATIBLE_VERSION
;

1658 i‡(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 14Ë<
vî
) {

1660 
u£r_vî
 = 
SNDRV_PCM_VERSION
;

1661 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_USER_PVERSION
, &
u£r_vî
) < 0) {

1662 
ªt
 = -
î∫o
;

1663 
	`SNDMSG
("USER_PVERSION failed");

1664  
ªt
;

1668 #i‡
	`deföed
(
HAVE_CLOCK_GETTIME
Ë&& deföed(
CLOCK_MONOTONIC
)

1669 i‡(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 9Ë<
vî
) {

1670 
time•ec
Åimespec;

1671 i‡(
	`˛ock_gëtime
(
CLOCK_MONOTONIC
, &
time•ec
) == 0) {

1672 
⁄
 = 
SNDRV_PCM_TSTAMP_TYPE_MONOTONIC
;

1673 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_TTSTAMP
, &
⁄
) < 0) {

1674 
ªt
 = -
î∫o
;

1675 
	`SNDMSG
("TTSTAMP failed");

1676  
ªt
;

1678 
t°amp_ty≥
 = 
SND_PCM_TSTAMP_TYPE_MONOTONIC
;

1682 i‡(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 5Ë<
vî
) {

1683 
⁄
 = 1;

1684 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_TSTAMP
, &
⁄
) < 0) {

1685 
ªt
 = -
î∫o
;

1686 
	`SNDMSG
("TSTAMP failed");

1687  
ªt
;

1691 
hw
 = 
	`ˇŒoc
(1, (
¢d_pcm_hw_t
));

1692 i‡(!
hw
) {

1693 
	`˛o£
(
fd
);

1694  -
ENOMEM
;

1697 
hw
->
vîsi⁄
 = 
vî
;

1698 
hw
->
ˇrd
 = 
öfo
.card;

1699 
hw
->
devi˚
 = 
öfo
.device;

1700 
hw
->
subdevi˚
 = 
öfo
.subdevice;

1701 
hw
->
fd
 = fd;

1703 
hw
->
f‹m©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1704 
hw
->
øãs
.
mö
 = hw->øãs.
max
 = 0;

1705 
hw
->
ch™√ls
 = 0;

1707 
ªt
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_HW
, 
«me
, 
öfo
.
°ªam
, 
mode
);

1708 i‡(
ªt
 < 0) {

1709 
	`‰ì
(
hw
);

1710 
	`˛o£
(
fd
);

1711  
ªt
;

1714 
pcm
->
›s
 = &
¢d_pcm_hw_›s
;

1715 
pcm
->
Á°_›s
 = &
¢d_pcm_hw_Á°_›s
;

1716 
pcm
->
¥iv©e_d©a
 = 
hw
;

1717 
pcm
->
pﬁl_fd
 = 
fd
;

1718 
pcm
->
pﬁl_evíts
 = 
öfo
.
°ªam
 =
SND_PCM_STREAM_PLAYBACK
 ? 
POLLOUT
 : 
POLLIN
;

1719 
pcm
->
t°amp_ty≥
 =Åstamp_type;

1720 #ifde‡
THREAD_SAFE_API


1721 
pcm
->
√ed_lock
 = 0;

1723 
pcm
->
own_°©e_check
 = 1;

1725 
ªt
 = 
	`m≠_°©us_™d_c⁄åﬁ_d©a
(
pcm
, !!
sync_±r_io˘l
);

1726 i‡(
ªt
 < 0) {

1727 
	`¢d_pcm_˛o£
(
pcm
);

1728  
ªt
;

1731 *
pcmp
 = 
pcm
;

1733 
	}
}

1751 
	$¢d_pcm_hw_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1752 
ˇrd
, 
devi˚
, 
subdevi˚
,

1753 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
,

1754 
mm≠_emuœti⁄
 
ATTRIBUTE_UNUSED
,

1755 
sync_±r_io˘l
)

1757 
fûíame
[(
SNDRV_FILE_PCM_STREAM_PLAYBACK
) + 20];

1758 c⁄° *
fûefmt
;

1759 
ªt
 = 0, 
fd
 = -1;

1760 
©ãm±
 = 0;

1761 
¢d_pcm_öfo_t
 
öfo
;

1762 
fmode
;

1763 
¢d_˘l_t
 *
˘l
;

1765 
	`as£π
(
pcmp
);

1767 i‡((
ªt
 = 
	`¢d_˘l_hw_›í
(&
˘l
, 
NULL
, 
ˇrd
, 0)) < 0)

1768  
ªt
;

1770 
°ªam
) {

1771 
SND_PCM_STREAM_PLAYBACK
:

1772 
fûefmt
 = 
SNDRV_FILE_PCM_STREAM_PLAYBACK
;

1774 
SND_PCM_STREAM_CAPTURE
:

1775 
fûefmt
 = 
SNDRV_FILE_PCM_STREAM_CAPTURE
;

1778 
	`SNDERR
("övÆid såóm %d", 
°ªam
);

1779  -
EINVAL
;

1781 
	`•rötf
(
fûíame
, 
fûefmt
, 
ˇrd
, 
devi˚
);

1783 
__agaö
:

1784 i‡(
©ãm±
++ > 3) {

1785 
ªt
 = -
EBUSY
;

1786 
_îr
;

1788 
ªt
 = 
	`¢d_˘l_pcm_¥e„r_subdevi˚
(
˘l
, 
subdevi˚
);

1789 i‡(
ªt
 < 0)

1790 
_îr
;

1791 
fmode
 = 
O_RDWR
;

1792 i‡(
mode
 & 
SND_PCM_NONBLOCK
)

1793 
fmode
 |
O_NONBLOCK
;

1794 i‡(
mode
 & 
SND_PCM_ASYNC
)

1795 
fmode
 |
O_ASYNC
;

1796 i‡(
mode
 & 
SND_PCM_APPEND
)

1797 
fmode
 |
O_APPEND
;

1798 
fd
 = 
	`¢d_›í_devi˚
(
fûíame
, 
fmode
);

1799 i‡(
fd
 < 0) {

1800 
ªt
 = -
î∫o
;

1801 
	`SYSMSG
("›í '%s' faûed (%i)", 
fûíame
, 
ªt
);

1802 
_îr
;

1804 i‡(
subdevi˚
 >= 0) {

1805 
	`mem£t
(&
öfo
, 0, (info));

1806 i‡(
	`io˘l
(
fd
, 
SNDRV_PCM_IOCTL_INFO
, &
öfo
) < 0) {

1807 
ªt
 = -
î∫o
;

1808 
	`SYSMSG
("SNDRV_PCM_IOCTL_INFO faûed (%i)", 
ªt
);

1809 
_îr
;

1811 i‡(
öfo
.
subdevi˚
 != () subdevice) {

1812 
	`˛o£
(
fd
);

1813 
fd
 = -1;

1814 
__agaö
;

1817 
	`¢d_˘l_˛o£
(
˘l
);

1818  
	`¢d_pcm_hw_›í_fd
(
pcmp
, 
«me
, 
fd
, 
sync_±r_io˘l
);

1819 
_îr
:

1820 i‡(
fd
 >= 0)

1821 
	`˛o£
(
fd
);

1822 
	`¢d_˘l_˛o£
(
˘l
);

1823  
ªt
;

1824 
	}
}

1878 
	$_¢d_pcm_hw_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1879 
¢d_c⁄fig_t
 *
roŸ
 
ATTRIBUTE_UNUSED
, snd_c⁄fig_à*
c⁄f
,

1880 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

1882 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1883 
ˇrd
 = -1, 
devi˚
 = 0, 
subdevi˚
 = -1;

1884 c⁄° *
°r
;

1885 
îr
, 
sync_±r_io˘l
 = 0;

1886 
mö_øã
 = 0, 
max_øã
 = 0, 
ch™√ls
 = 0, 
døö_sûí˚
 = -1;

1887 
¢d_pcm_f‹m©_t
 
f‹m©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1888 
¢d_c⁄fig_t
 *
n
;

1889 
n⁄block
 = 1;

1890 
¢d_pcm_chm≠_quîy_t
 **
chm≠
 = 
NULL
;

1891 
¢d_pcm_hw_t
 *
hw
;

1894 i‡(
	`¢d_c⁄fig_£¨ch
(
roŸ
, "deÁu…s.pcm.n⁄block", &
n
) >= 0) {

1895 
îr
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

1896 i‡(
îr
 >= 0)

1897 
n⁄block
 = 
îr
;

1899 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1900 c⁄° *
id
;

1901 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1902 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1904 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

1906 i‡(
	`°rcmp
(
id
, "card") == 0) {

1907 
îr
 = 
	`¢d_c⁄fig_gë_ˇrd
(
n
);

1908 i‡(
îr
 < 0)

1909 
Áû
;

1910 
ˇrd
 = 
îr
;

1913 i‡(
	`°rcmp
(
id
, "device") == 0) {

1914 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
devi˚
);

1915 i‡(
îr
 < 0) {

1916 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1917 
Áû
;

1921 i‡(
	`°rcmp
(
id
, "subdevice") == 0) {

1922 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
subdevi˚
);

1923 i‡(
îr
 < 0) {

1924 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1925 
Áû
;

1929 i‡(
	`°rcmp
(
id
, "sync_ptr_ioctl") == 0) {

1930 
îr
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

1931 i‡(
îr
 < 0)

1933 
sync_±r_io˘l
 = 
îr
;

1936 i‡(
	`°rcmp
(
id
, "nonblock") == 0) {

1937 
îr
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

1938 i‡(
îr
 < 0)

1940 
n⁄block
 = 
îr
;

1943 i‡(
	`°rcmp
(
id
, "rate") == 0) {

1944 
vÆ
;

1945 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë=
SND_CONFIG_TYPE_COMPOUND
 &&

1946 
	`¢d_c⁄fig_is_¨øy
(
n
)) {

1947 
¢d_c⁄fig_t
 *
m
;

1948 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
n
, "0", &
m
);

1949 i‡(
îr
 < 0) {

1950 
	`SNDERR
("arrayÉxpected forÑate compound");

1951 
Áû
;

1953 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
m
, &
vÆ
);

1954 i‡(
îr
 < 0) {

1955 
	`SNDERR
("InvalidÅype forÑate.0");

1956 
Áû
;

1958 
mö_øã
 = 
max_øã
 = 
vÆ
;

1959 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
n
, "1", &
m
);

1960 i‡(
îr
 >= 0) {

1961 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
m
, &
vÆ
);

1962 i‡(
îr
 < 0) {

1963 
	`SNDERR
("InvalidÅype forÑate.0");

1964 
Áû
;

1966 
max_øã
 = 
vÆ
;

1969 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
vÆ
);

1970 i‡(
îr
 < 0) {

1971 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1972 
Áû
;

1974 
mö_øã
 = 
max_øã
 = 
vÆ
;

1978 i‡(
	`°rcmp
(
id
, "min_rate") == 0) {

1979 
vÆ
;

1980 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
vÆ
);

1981 i‡(
îr
 < 0) {

1982 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1983 
Áû
;

1985 
mö_øã
 = 
vÆ
;

1988 i‡(
	`°rcmp
(
id
, "max_rate") == 0) {

1989 
vÆ
;

1990 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
vÆ
);

1991 i‡(
îr
 < 0) {

1992 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1993 
Áû
;

1995 
max_øã
 = 
vÆ
;

1998 i‡(
	`°rcmp
(
id
, "format") == 0) {

1999 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
);

2000 i‡(
îr
 < 0) {

2001 
	`SNDERR
("övÆidÅy≥ f‹ %s", 
id
);

2002 
Áû
;

2004 
f‹m©
 = 
	`¢d_pcm_f‹m©_vÆue
(
°r
);

2007 i‡(
	`°rcmp
(
id
, "channels") == 0) {

2008 
vÆ
;

2009 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
vÆ
);

2010 i‡(
îr
 < 0) {

2011 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

2012 
Áû
;

2014 
ch™√ls
 = 
vÆ
;

2017 i‡(
	`°rcmp
(
id
, "chmap") == 0) {

2018 
	`¢d_pcm_‰ì_chm≠s
(
chm≠
);

2019 
chm≠
 = 
	`_¢d_pcm_∑r£_c⁄fig_chm≠s
(
n
);

2020 i‡(!
chm≠
) {

2021 
	`SNDERR
("InvÆid ch™√»m≠ f‹ %s", 
id
);

2022 
îr
 = -
EINVAL
;

2023 
Áû
;

2027 i‡(
	`°rcmp
(
id
, "drain_silence") == 0) {

2028 
vÆ
;

2029 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
vÆ
);

2030 i‡(
îr
 < 0) {

2031 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

2032 
Áû
;

2034 
døö_sûí˚
 = 
vÆ
;

2037 
	`SNDERR
("Unknow¿fõld %s", 
id
);

2038 
îr
 = -
EINVAL
;

2039 
Áû
;

2041 i‡(
ˇrd
 < 0) {

2042 
	`SNDERR
("card isÇot defined");

2043 
îr
 = -
EINVAL
;

2044 
Áû
;

2046 i‡((
mö_øã
 < 0Ë|| (
max_øã
 < min_rate)) {

2047 
	`SNDERR
("min_rate - max_rate configuration invalid");

2048 
îr
 = -
EINVAL
;

2049 
Áû
;

2051 
îr
 = 
	`¢d_pcm_hw_›í
(
pcmp
, 
«me
, 
ˇrd
, 
devi˚
, 
subdevi˚
, 
°ªam
,

2052 
mode
 | (
n⁄block
 ? 
SND_PCM_NONBLOCK
 : 0),

2053 0, 
sync_±r_io˘l
);

2054 i‡(
îr
 < 0)

2055 
Áû
;

2056 i‡(
n⁄block
 && ! (
mode
 & 
SND_PCM_NONBLOCK
)) {

2058 
	`¢d_pcm_hw_n⁄block
(*
pcmp
, 0);

2059 (*
pcmp
)->
mode
 = mode;

2063 (*
pcmp
)->
mode
 |modê& (
SND_PCM_NO_AUTO_RESAMPLE
|

2064 
SND_PCM_NO_AUTO_CHANNELS
|

2065 
SND_PCM_NO_AUTO_FORMAT
|

2066 
SND_PCM_NO_SOFTVOL
);

2068 
hw
 = (*
pcmp
)->
¥iv©e_d©a
;

2069 i‡(
f‹m©
 !
SND_PCM_FORMAT_UNKNOWN
)

2070 
hw
->
f‹m©
 = format;

2071 i‡(
ch™√ls
 > 0)

2072 
hw
->
ch™√ls
 = channels;

2073 i‡(
mö_øã
 > 0) {

2074 
hw
->
øãs
.
mö
 = 
mö_øã
;

2075 
hw
->
øãs
.
max
 = 
max_øã
;

2077 i‡(
chm≠
)

2078 
hw
->
chm≠_ovîride
 = 
chm≠
;

2079 
hw
->
døö_sûí˚
 = drain_silence;

2083 
Áû
:

2084 
	`¢d_pcm_‰ì_chm≠s
(
chm≠
);

2085  
îr
;

2086 
	}
}

2088 #i‚de‡
DOC_HIDDEN


2089 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_hw_›í
, 
SND_PCM_DLSYM_VERSION
);

2096 #i‚de‡
DOC_HIDDEN


2097 
	#__OLD_TO_NEW_MASK
(
x
Ë((x&7)|((x&0x07fffff8)<<5))

	)

2098 
	#__NEW_TO_OLD_MASK
(
x
Ë((x&7)|((x&0xffffff00)>>5))

	)

2101 
	$¢d_pcm_hw_c⁄vît_‰om_ﬁd_∑øms
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

2102 
¢drv_pcm_hw_∑øms_ﬁd
 *
›¨ams
)

2104 
i
;

2106 
	`mem£t
(
∑øms
, 0, (*params));

2107 
∑øms
->
Êags
 = 
›¨ams
->flags;

2108 
i
 = 0; i < (
›¨ams
->
masks
) / (); i++)

2109 
∑øms
->
masks
[
i
].
bôs
[0] = 
›¨ams
->masks[i];

2110 
	`mem˝y
(
∑øms
->
öãrvÆs
, 
›¨ams
->intervals, (oparams->intervals));

2111 
∑øms
->
rmask
 = 
	`__OLD_TO_NEW_MASK
(
›¨ams
->rmask);

2112 
∑øms
->
cmask
 = 
	`__OLD_TO_NEW_MASK
(
›¨ams
->cmask);

2113 
∑øms
->
öfo
 = 
›¨ams
->info;

2114 
∑øms
->
msbôs
 = 
›¨ams
->msbits;

2115 
∑øms
->
øã_num
 = 
›¨ams
->rate_num;

2116 
∑øms
->
øã_dí
 = 
›¨ams
->rate_den;

2117 
∑øms
->
fifo_size
 = 
›¨ams
->fifo_size;

2118 
	}
}

2120 
	$¢d_pcm_hw_c⁄vît_to_ﬁd_∑øms
(
¢drv_pcm_hw_∑øms_ﬁd
 *
›¨ams
,

2121 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

2122 *
cmask
)

2124 
i
, 
j
;

2126 
	`mem£t
(
›¨ams
, 0, (*oparams));

2127 
›¨ams
->
Êags
 = 
∑øms
->flags;

2128 
i
 = 0; i < (
›¨ams
->
masks
) / (); i++) {

2129 
›¨ams
->
masks
[
i
] = 
∑øms
->masks[i].
bôs
[0];

2130 
j
 = 1; j < (
∑øms
->
masks
[
i
].
bôs
) / (); j++)

2131 i‡(
∑øms
->
masks
[
i
].
bôs
[
j
]) {

2132 *
cmask
 |1 << 
i
;

2136 
	`mem˝y
(
›¨ams
->
öãrvÆs
, 
∑øms
->intervals, (oparams->intervals));

2137 
›¨ams
->
rmask
 = 
	`__NEW_TO_OLD_MASK
(
∑øms
->rmask);

2138 
›¨ams
->
cmask
 = 
	`__NEW_TO_OLD_MASK
(
∑øms
->cmask);

2139 
›¨ams
->
öfo
 = 
∑øms
->info;

2140 
›¨ams
->
msbôs
 = 
∑øms
->msbits;

2141 
›¨ams
->
øã_num
 = 
∑øms
->rate_num;

2142 
›¨ams
->
øã_dí
 = 
∑øms
->rate_den;

2143 
›¨ams
->
fifo_size
 = 
∑øms
->fifo_size;

2144 
	}
}

2146 
	$u£_ﬁd_hw_∑øms_io˘l
(
fd
, 
cmd
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

2148 
¢drv_pcm_hw_∑øms_ﬁd
 
›¨ams
;

2149 
cmask
 = 0;

2150 
ªs
;

2152 
	`¢d_pcm_hw_c⁄vît_to_ﬁd_∑øms
(&
›¨ams
, 
∑øms
, &
cmask
);

2153 
ªs
 = 
	`io˘l
(
fd
, 
cmd
, &
›¨ams
);

2154 
	`¢d_pcm_hw_c⁄vît_‰om_ﬁd_∑øms
(
∑øms
, &
›¨ams
);

2155 
∑øms
->
cmask
 |= cmask;

2156  
ªs
;

2157 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_iec958.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_∂ugö.h
"

31 
	~"∂ugö_›s.h
"

32 
	~"bsw≠.h
"

34 #i‚de‡
PIC


36 c⁄° *
	g_¢d_moduÀ_pcm_õc958
 = "";

42 #i‚de‡
DOC_HIDDEN


44 
¢d_pcm_õc958
 
	t¢d_pcm_õc958_t
;

46 (*
	tõc958_f
)(
	t¢d_pcm_õc958_t
 *
	tõc
,

47 c⁄° 
	t¢d_pcm_ch™√l_¨ó_t
 *
	td°_¨ós
,

48 
	t¢d_pcm_u‰ames_t
 
	td°_off£t
,

49 c⁄° 
	t¢d_pcm_ch™√l_¨ó_t
 *
	t§c_¨ós
,

50 
	t¢d_pcm_u‰ames_t
 
	t§c_off£t
,

51 
	tch™√ls
, 
	t¢d_pcm_u‰ames_t
 
	t‰ames
);

53 
	s¢d_pcm_õc958
 {

55 
¢d_pcm_∂ugö_t
 
∂ug
;

56 
gëput_idx
;

57 
õc958_f
 
func
;

58 
¢d_pcm_f‹m©_t
 
sf‹m©
;

59 
¢d_pcm_f‹m©_t
 
f‹m©
;

60 
cou¡î
;

61 
°©us
[24];

62 
byãsw≠
;

63 
¥ómbÀ
[3];

64 
¢d_pcm_Á°_›s_t
 
f›s
;

65 
hdmi_mode
;

68 íum { 
PREAMBLE_Z
, 
PREAMBLE_X
, 
PREAMBLE_Y
 };

77 
	$õc958_∑rôy
(
d©a
)

79 
∑rôy
;

80 
bô
;

82 
d©a
 >>= 4;

83 
∑rôy
 = 0;

84 
bô
 = 4; bit <= 30; bit++) {

85 i‡(
d©a
 & 1)

86 
∑rôy
++;

87 
d©a
 >>= 1;

89  (
∑rôy
 & 1);

90 
	}
}

105 
ölöe
 
uöt32_t
 
	$õc958_sub‰ame
(
¢d_pcm_õc958_t
 *
õc
, 
uöt32_t
 
d©a
, 
ch™√l
)

107 
byã
 = 
õc
->
cou¡î
 >> 3;

108 
mask
 = 1 << (
õc
->
cou¡î
 - (
byã
 << 3));

111 
d©a
 >>= 4;

112 
d©a
 &= ~0xf;

115 i‡(
õc
->
°©us
[
byã
] & 
mask
)

116 
d©a
 |= 0x40000000;

118 i‡(
	`õc958_∑rôy
(
d©a
))

119 
d©a
 |= 0x80000000;

122 i‡(
ch™√l
)

123 
d©a
 |
õc
->
¥ómbÀ
[
PREAMBLE_Y
];

124 i‡(! 
õc
->
cou¡î
)

125 
d©a
 |
õc
->
¥ómbÀ
[
PREAMBLE_Z
];

127 
d©a
 |
õc
->
¥ómbÀ
[
PREAMBLE_X
];

129 i‡(
õc
->
byãsw≠
)

130 
d©a
 = 
	`bsw≠_32
(data);

132  
d©a
;

133 
	}
}

135 
ölöe
 
öt32_t
 
	$õc958_to_s32
(
¢d_pcm_õc958_t
 *
õc
, 
uöt32_t
 
d©a
)

137 i‡(
õc
->
byãsw≠
)

138 
d©a
 = 
	`bsw≠_32
(data);

139 
d©a
 &= ~0xf;

140 
d©a
 <<= 4;

141  (
öt32_t
)
d©a
;

142 
	}
}

144 #i‚de‡
DOC_HIDDEN


145 
	$¢d_pcm_õc958_decode
(
¢d_pcm_õc958_t
 *
õc
,

146 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

147 
¢d_pcm_u‰ames_t
 
d°_off£t
,

148 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

149 
¢d_pcm_u‰ames_t
 
§c_off£t
,

150 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
)

152 
	#PUT32_LABELS


	)

153 
	~"∂ugö_›s.h
"

154 #unde‡
PUT32_LABELS


155 *
put
 = 
put32_œbñs
[
õc
->
gëput_idx
];

156 
ch™√l
;

157 
ch™√l
 = 0; ch™√»< 
ch™√ls
; ++channel) {

158 c⁄° 
uöt32_t
 *
§c
;

159 *
d°
;

160 
§c_°ï
, 
d°_°ï
;

161 
¢d_pcm_u‰ames_t
 
‰ames1
;

162 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

163 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

164 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

165 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

166 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
Ë/ (
uöt32_t
);

167 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
);

168 
‰ames1
 = 
‰ames
;

169 
‰ames1
-- > 0) {

170 
öt32_t
 
ßm∂e
 = 
	`õc958_to_s32
(
õc
, *
§c
);

171 *
put
;

172 
	#PUT32_END
 
a·î


	)

173 
	~"∂ugö_›s.h
"

174 #unde‡
PUT32_END


175 
a·î
:

176 
§c
 +
§c_°ï
;

177 
d°
 +
d°_°ï
;

180 
	}
}

182 
	$¢d_pcm_õc958_ícode
(
¢d_pcm_õc958_t
 *
õc
,

183 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

184 
¢d_pcm_u‰ames_t
 
d°_off£t
,

185 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

186 
¢d_pcm_u‰ames_t
 
§c_off£t
,

187 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
)

189 
	#GET32_LABELS


	)

190 
	~"∂ugö_›s.h
"

191 #unde‡
GET32_LABELS


192 *
gë
 = 
gë32_œbñs
[
õc
->
gëput_idx
];

193 
ch™√l
;

194 
öt32_t
 
ßm∂e
 = 0;

195 
cou¡î
 = 
õc
->counter;

196 
sögÀ_°ªam
 = 
õc
->
hdmi_mode
 &&

197 (
õc
->
°©us
[0] & 
IEC958_AES0_NONAUDIO
) &&

198 (
ch™√ls
 == 8);

199 
cou¡î_°ï
 = 
sögÀ_°ªam
 ? ((
ch™√ls
 + 1) >> 1) : 1;

200 
ch™√l
 = 0; ch™√»< 
ch™√ls
; ++channel) {

201 c⁄° *
§c
;

202 
uöt32_t
 *
d°
;

203 
§c_°ï
, 
d°_°ï
;

204 
¢d_pcm_u‰ames_t
 
‰ames1
;

205 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

206 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

207 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

208 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

209 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
);

210 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
Ë/ (
uöt32_t
);

211 
‰ames1
 = 
‰ames
;

213 i‡(
sögÀ_°ªam
)

214 
õc
->
cou¡î
 = (cou¡î + (
ch™√l
 >> 1)) % 192;

216 
õc
->
cou¡î
 = counter;

218 
‰ames1
-- > 0) {

219 *
gë
;

220 
	#GET32_END
 
a·î


	)

221 
	~"∂ugö_›s.h
"

222 #unde‡
GET32_END


223 
a·î
:

224 
ßm∂e
 = 
	`õc958_sub‰ame
(
õc
, sam∂e, 
ch™√l
);

226 *
d°
 = 
ßm∂e
;

227 
§c
 +
§c_°ï
;

228 
d°
 +
d°_°ï
;

229 
õc
->
cou¡î
 +
cou¡î_°ï
;

230 
õc
->
cou¡î
 %= 192;

232 i‡(
sögÀ_°ªam
)

233 
õc
->
cou¡î
 = (cou¡î + 
‰ames
 * 
cou¡î_°ï
) % 192;

235 
	}
}

238 
	$¢d_pcm_õc958_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

240 
¢d_pcm_õc958_t
 *
õc
 = 
pcm
->
¥iv©e_d©a
;

241 
îr
;

242 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

243 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

244 &
ac˚ss_mask
);

245 i‡(
îr
 < 0)

246  
îr
;

247 i‡(
õc
->
sf‹m©
 =
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
 ||

248 
õc
->
sf‹m©
 =
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
) {

249 
¢d_pcm_f‹m©_mask_t
 
f‹m©_mask
 = { 
SND_PCM_FMTBIT_LINEAR
 };

250 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
,

251 &
f‹m©_mask
);

253 
¢d_pcm_f‹m©_mask_t
 
f‹m©_mask
 = {

254 { (1U << 
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
) |

255 (1U << 
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
) }

257 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
,

258 &
f‹m©_mask
);

260 i‡(
îr
 < 0)

261  
îr
;

262 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
∑øms
, 
SND_PCM_SUBFORMAT_STD
);

263 i‡(
îr
 < 0)

264  
îr
;

265 
∑øms
->
öfo
 &~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

267 
	}
}

269 
	$¢d_pcm_õc958_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

271 
¢d_pcm_õc958_t
 *
õc
 = 
pcm
->
¥iv©e_d©a
;

272 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

273 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

274 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

275 &
ßc˚ss_mask
);

276 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
•¨ams
, 
õc
->
sf‹m©
);

277 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
•¨ams
, 
SND_PCM_SUBFORMAT_STD
);

279 
	}
}

281 
	$¢d_pcm_õc958_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

282 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

284 
îr
;

285 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

286 
SND_PCM_HW_PARBIT_RATE
 |

287 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

288 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

289 
SND_PCM_HW_PARBIT_PERIODS
 |

290 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

291 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

292 
SND_PCM_HW_PARBIT_TICK_TIME
);

293 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

294 i‡(
îr
 < 0)

295  
îr
;

297 
	}
}

299 
	$¢d_pcm_õc958_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

300 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

302 
îr
;

303 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

304 
SND_PCM_HW_PARBIT_RATE
 |

305 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

306 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

307 
SND_PCM_HW_PARBIT_PERIODS
 |

308 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

309 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

310 
SND_PCM_HW_PARBIT_TICK_TIME
);

311 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

312 i‡(
îr
 < 0)

313  
îr
;

315 
	}
}

317 
	$¢d_pcm_õc958_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

319  
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

320 
¢d_pcm_õc958_hw_ªföe_˝ª∑ª
,

321 
¢d_pcm_õc958_hw_ªföe_cch™ge
,

322 
¢d_pcm_õc958_hw_ªföe_•ª∑ª
,

323 
¢d_pcm_õc958_hw_ªföe_sch™ge
,

324 
¢d_pcm_gíîic_hw_ªföe
);

325 
	}
}

327 
	$¢d_pcm_õc958_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 * 
∑øms
)

329 
¢d_pcm_õc958_t
 *
õc
 = 
pcm
->
¥iv©e_d©a
;

330 
¢d_pcm_f‹m©_t
 
f‹m©
;

331 
îr
 = 
	`¢d_pcm_hw_∑øms_¶ave
(
pcm
, 
∑øms
,

332 
¢d_pcm_õc958_hw_ªföe_cch™ge
,

333 
¢d_pcm_õc958_hw_ªföe_•ª∑ª
,

334 
¢d_pcm_õc958_hw_ªföe_sch™ge
,

335 
¢d_pcm_gíîic_hw_∑øms
);

336 i‡(
îr
 < 0)

337  
îr
;

339 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(
∑øms
, &
f‹m©
);

340 i‡(
îr
 < 0)

341  
îr
;

343 
õc
->
f‹m©
 = format;

344 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

345 i‡(
õc
->
sf‹m©
 =
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
 ||

346 
õc
->
sf‹m©
 =
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
) {

347 
õc
->
gëput_idx
 = 
	`¢d_pcm_löór_gë_ödex
(
f‹m©
, 
SND_PCM_FORMAT_S32
);

348 
õc
->
func
 = 
¢d_pcm_õc958_ícode
;

349 
õc
->
byãsw≠
 = iec->
sf‹m©
 !
SND_PCM_FORMAT_IEC958_SUBFRAME
;

351 
õc
->
gëput_idx
 = 
	`¢d_pcm_löór_put_ödex
(
SND_PCM_FORMAT_S32
, iec->
sf‹m©
);

352 
õc
->
func
 = 
¢d_pcm_õc958_decode
;

353 
õc
->
byãsw≠
 = 
f‹m©
 !
SND_PCM_FORMAT_IEC958_SUBFRAME
;

356 i‡(
õc
->
sf‹m©
 =
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
 ||

357 
õc
->
sf‹m©
 =
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
) {

358 
õc
->
gëput_idx
 = 
	`¢d_pcm_löór_put_ödex
(
SND_PCM_FORMAT_S32
, 
f‹m©
);

359 
õc
->
func
 = 
¢d_pcm_õc958_decode
;

360 
õc
->
byãsw≠
 = iec->
sf‹m©
 !
SND_PCM_FORMAT_IEC958_SUBFRAME
;

362 
õc
->
gëput_idx
 = 
	`¢d_pcm_löór_gë_ödex
(õc->
sf‹m©
, 
SND_PCM_FORMAT_S32
);

363 
õc
->
func
 = 
¢d_pcm_õc958_ícode
;

364 
õc
->
byãsw≠
 = 
f‹m©
 !
SND_PCM_FORMAT_IEC958_SUBFRAME
;

368 i‡((
õc
->
°©us
[0] & 
IEC958_AES0_PROFESSIONAL
) == 0) {

369 i‡((
õc
->
°©us
[3] & 
IEC958_AES3_CON_FS
Ë=
IEC958_AES3_CON_FS_NOTID
) {

370 
øã
 = 0;

371 
fs
;

373 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_øã
)(
∑øms
, &
øã
, 0);

374 i‡(
îr
 < 0)

375 
øã
 = 0;

377 
øã
) {

379 
fs
 = 
IEC958_AES3_CON_FS_22050
;

382 
fs
 = 
IEC958_AES3_CON_FS_24000
;

385 
fs
 = 
IEC958_AES3_CON_FS_32000
;

388 
fs
 = 
IEC958_AES3_CON_FS_44100
;

391 
fs
 = 
IEC958_AES3_CON_FS_48000
;

394 
fs
 = 
IEC958_AES3_CON_FS_88200
;

397 
fs
 = 
IEC958_AES3_CON_FS_96000
;

400 
fs
 = 
IEC958_AES3_CON_FS_176400
;

403 
fs
 = 
IEC958_AES3_CON_FS_192000
;

406 
fs
 = 
IEC958_AES3_CON_FS_768000
;

409 
fs
 = 
IEC958_AES3_CON_FS_NOTID
;

413 
õc
->
°©us
[3] &~
IEC958_AES3_CON_FS
;

414 
õc
->
°©us
[3] |
fs
;

417 i‡((
õc
->
°©us
[4] & 
IEC958_AES4_CON_WORDLEN
Ë=
IEC958_AES4_CON_WORDLEN_NOTID
) {

418 
ws
;

419 
	`¢d_pcm_f‹m©_width
(
f‹m©
)) {

421 
ws
 = 
IEC958_AES4_CON_WORDLEN_20_16
;

424 
ws
 = 
IEC958_AES4_CON_WORDLEN_22_18
;

427 
ws
 = 
IEC958_AES4_CON_WORDLEN_20_16
 | 
IEC958_AES4_CON_MAX_WORDLEN_24
;

431 
ws
 = 
IEC958_AES4_CON_WORDLEN_24_20
 | 
IEC958_AES4_CON_MAX_WORDLEN_24
;

434 
ws
 = 
IEC958_AES4_CON_WORDLEN_NOTID
;

437 
õc
->
°©us
[4] &~(
IEC958_AES4_CON_MAX_WORDLEN_24
 | 
IEC958_AES4_CON_WORDLEN
);

438 
õc
->
°©us
[4] |
ws
;

442 
	}
}

444 
¢d_pcm_u‰ames_t


445 
	$¢d_pcm_õc958_wrôe_¨ós
(
¢d_pcm_t
 *
pcm
,

446 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

447 
¢d_pcm_u‰ames_t
 
off£t
,

448 
¢d_pcm_u‰ames_t
 
size
,

449 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

450 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

451 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

453 
¢d_pcm_õc958_t
 *
õc
 = 
pcm
->
¥iv©e_d©a
;

454 i‡(
size
 > *
¶ave_sizï
)

455 
size
 = *
¶ave_sizï
;

456 
õc
->
	`func
(õc, 
¶ave_¨ós
, 
¶ave_off£t
,

457 
¨ós
, 
off£t
,

458 
pcm
->
ch™√ls
, 
size
);

459 *
¶ave_sizï
 = 
size
;

460  
size
;

461 
	}
}

463 
¢d_pcm_u‰ames_t


464 
	$¢d_pcm_õc958_ªad_¨ós
(
¢d_pcm_t
 *
pcm
,

465 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

466 
¢d_pcm_u‰ames_t
 
off£t
,

467 
¢d_pcm_u‰ames_t
 
size
,

468 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

469 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

470 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

472 
¢d_pcm_õc958_t
 *
õc
 = 
pcm
->
¥iv©e_d©a
;

473 i‡(
size
 > *
¶ave_sizï
)

474 
size
 = *
¶ave_sizï
;

475 
õc
->
	`func
(õc, 
¨ós
, 
off£t
,

476 
¶ave_¨ós
, 
¶ave_off£t
,

477 
pcm
->
ch™√ls
, 
size
);

478 *
¶ave_sizï
 = 
size
;

479  
size
;

480 
	}
}

482 
	$¢d_pcm_õc958_öô
(
¢d_pcm_t
 *
pcm
)

484 
¢d_pcm_õc958_t
 *
õc
 = 
pcm
->
¥iv©e_d©a
;

485 
õc
->
cou¡î
 = 0;

487 
	}
}

489 
	$¢d_pcm_õc958_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

491 
¢d_pcm_õc958_t
 *
õc
 = 
pcm
->
¥iv©e_d©a
;

492 
	`¢d_ouçut_¥ötf
(
out
, "IEC958 subframe conversion PCM (%s)\n",

493 
	`¢d_pcm_f‹m©_«me
(
õc
->
sf‹m©
));

494 i‡(
pcm
->
£tup
) {

495 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

496 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

498 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

499 
	`¢d_pcm_dump
(
õc
->
∂ug
.
gí
.
¶ave
, 
out
);

500 
	}
}

502 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_õc958_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

504 
cou¡î_de¸emít
;

505 
¢d_pcm_õc958_t
 *
õc
 = 
pcm
->
¥iv©e_d©a
;

506 
¢d_pcm_s‰ames_t
 
ªsu…
 = 
	`¢d_pcm_∂ugö_ªwöd
(
pcm
, 
‰ames
);

507 i‡(
ªsu…
 <= 0)

508  
ªsu…
;

510 
cou¡î_de¸emít
 = 
ªsu…
 % 192;

511 
õc
->
cou¡î
 +192 - 
cou¡î_de¸emít
;

512 
õc
->
cou¡î
 %= 192;

513  
ªsu…
;

514 
	}
}

516 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_õc958_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

519 
cou¡î_ö¸emít
;

520 
¢d_pcm_õc958_t
 *
õc
 = 
pcm
->
¥iv©e_d©a
;

521 
¢d_pcm_s‰ames_t
 
ªsu…
 = 
	`¢d_pcm_∂ugö_ªwöd
(
pcm
, 
‰ames
);

522 i‡(
ªsu…
 <= 0)

523  
ªsu…
;

525 
cou¡î_ö¸emít
 = 
ªsu…
 % 192;

526 
õc
->
cou¡î
 +
cou¡î_ö¸emít
;

527 
õc
->
cou¡î
 %= 192;

528  
ªsu…
;

529 
	}
}

531 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_õc958_›s
 = {

532 .
˛o£
 = 
¢d_pcm_gíîic_˛o£
,

533 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

534 .
	ghw_ªföe
 = 
¢d_pcm_õc958_hw_ªföe
,

535 .
	ghw_∑øms
 = 
¢d_pcm_õc958_hw_∑øms
,

536 .
	ghw_‰ì
 = 
¢d_pcm_gíîic_hw_‰ì
,

537 .
	gsw_∑øms
 = 
¢d_pcm_gíîic_sw_∑øms
,

538 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

539 .
	gdump
 = 
¢d_pcm_õc958_dump
,

540 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

541 .
	gasync
 = 
¢d_pcm_gíîic_async
,

542 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

543 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

544 .
	gquîy_chm≠s
 = 
¢d_pcm_gíîic_quîy_chm≠s
,

545 .
	ggë_chm≠
 = 
¢d_pcm_gíîic_gë_chm≠
,

546 .
	g£t_chm≠
 = 
¢d_pcm_gíîic_£t_chm≠
,

564 
	$¢d_pcm_õc958_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
, 
¢d_pcm_f‹m©_t
 
sf‹m©
,

565 
¢d_pcm_t
 *
¶ave
, 
˛o£_¶ave
,

566 c⁄° *
°©us_bôs
,

567 c⁄° *
¥ómbÀ_vÆs
,

568 
hdmi_mode
)

570 
¢d_pcm_t
 *
pcm
;

571 
¢d_pcm_õc958_t
 *
õc
;

572 
îr
;

573 c⁄° 
deÁu…_°©us_bôs
[] = {

574 
IEC958_AES0_CON_EMPHASIS_NONE
,

575 
IEC958_AES1_CON_ORIGINAL
 | 
IEC958_AES1_CON_PCM_CODER
,

577 
IEC958_AES3_CON_FS_NOTID
,

578 
IEC958_AES4_CON_WORDLEN_NOTID


581 
	`as£π
(
pcmp
 && 
¶ave
);

582 i‡(
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1 &&

583 
sf‹m©
 !
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
 &&

584 
sf‹m©
 !
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
)

585  -
EINVAL
;

586 
õc
 = 
	`ˇŒoc
(1, (
¢d_pcm_õc958_t
));

587 i‡(!
õc
) {

588  -
ENOMEM
;

590 
	`¢d_pcm_∂ugö_öô
(&
õc
->
∂ug
);

591 
õc
->
sf‹m©
 = sformat;

592 
õc
->
∂ug
.
ªad
 = 
¢d_pcm_õc958_ªad_¨ós
;

593 
õc
->
∂ug
.
wrôe
 = 
¢d_pcm_õc958_wrôe_¨ós
;

594 
õc
->
∂ug
.
öô
 = 
¢d_pcm_õc958_öô
;

595 
õc
->
∂ug
.
undo_ªad
 = 
¢d_pcm_∂ugö_undo_ªad_gíîic
;

596 
õc
->
∂ug
.
undo_wrôe
 = 
¢d_pcm_∂ugö_undo_wrôe_gíîic
;

597 
õc
->
∂ug
.
gí
.
¶ave
 = slave;

598 
õc
->
∂ug
.
gí
.
˛o£_¶ave
 = close_slave;

600 i‡(
°©us_bôs
)

601 
	`mem˝y
(
õc
->
°©us
, 
°©us_bôs
, (iec->status));

603 
	`mem˝y
(
õc
->
°©us
, 
deÁu…_°©us_bôs
, (default_status_bits));

605 
	`mem˝y
(
õc
->
¥ómbÀ
, 
¥ómbÀ_vÆs
, 3);

607 
õc
->
hdmi_mode
 = hdmi_mode;

609 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_IEC958
, 
«me
, 
¶ave
->
°ªam
, sœve->
mode
);

610 i‡(
îr
 < 0) {

611 
	`‰ì
(
õc
);

612  
îr
;

614 
pcm
->
›s
 = &
¢d_pcm_õc958_›s
;

616 
õc
->
f›s
 = 
¢d_pcm_∂ugö_Á°_›s
;

617 
õc
->
f›s
.
ªwöd
 = 
¢d_pcm_õc958_ªwöd
;

618 
õc
->
f›s
.
f‹w¨d
 = 
¢d_pcm_õc958_f‹w¨d
;

619 
pcm
->
Á°_›s
 = &
õc
->
f›s
;

621 
pcm
->
¥iv©e_d©a
 = 
õc
;

622 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

623 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

624 
pcm
->
t°amp_ty≥
 = 
¶ave
->tstamp_type;

625 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
õc
->
∂ug
.
hw_±r
, -1, 0);

626 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
õc
->
∂ug
.
≠∂_±r
, -1, 0);

627 *
pcmp
 = 
pcm
;

630 
	}
}

686 
	$_¢d_pcm_õc958_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

687 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

688 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

690 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

691 
îr
;

692 
¢d_pcm_t
 *
•cm
;

693 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

694 
¢d_c⁄fig_t
 *
°©us
 = 
NULL
, *
¥ómbÀ
 = NULL;

695 
¢d_pcm_f‹m©_t
 
sf‹m©
;

696 
°©us_bôs
[24];

697 
¥ómbÀ_vÆs
[3] = {

700 
hdmi_mode
 = 0;

702 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

703 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

704 c⁄° *
id
;

705 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

707 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

709 i‡(
	`°rcmp
(
id
, "slave") == 0) {

710 
¶ave
 = 
n
;

713 i‡(
	`°rcmp
(
id
, "status") == 0) {

714 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

715 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

716  -
EINVAL
;

718 
°©us
 = 
n
;

721 i‡(
	`°rcmp
(
id
, "preamble") == 0) {

722 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

723 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

724  -
EINVAL
;

726 
¥ómbÀ
 = 
n
;

729 i‡(
	`°rcmp
(
id
, "hdmi_mode") == 0) {

730 
îr
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

731 i‡(
îr
 < 0)

733 
hdmi_mode
 = 
îr
;

736 
	`SNDERR
("Unknow¿fõld %s", 
id
);

737  -
EINVAL
;

739 
	`mem£t
(
°©us_bôs
, 0, (status_bits));

740 i‡(
°©us
) {

741 
¢d_c⁄fig_ôî©‹_t
 
i
, 
öext
;

742 
byãs
 = 0;

743 
	`¢d_c⁄fig_f‹_óch
(
i
, 
öext
, 
°©us
) {

744 
vÆ
;

745 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

746 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_INTEGER
) {

747 
	`SNDERR
("invalid IEC958 status bits");

748  -
EINVAL
;

750 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
vÆ
);

751 i‡(
îr
 < 0) {

752 
	`SNDERR
("invalid IEC958 status bits");

753  
îr
;

755 
°©us_bôs
[
byãs
] = 
vÆ
;

756 
byãs
++;

757 i‡(
byãs
 >()(
°©us_bôs
))

762 i‡(
¥ómbÀ
) {

763 
¢d_c⁄fig_ôî©‹_t
 
i
, 
öext
;

764 
	`¢d_c⁄fig_f‹_óch
(
i
, 
öext
, 
¥ómbÀ
) {

765 
vÆ
;

766 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

767 c⁄° *
id
;

768 
idx
;

769 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

771 i‡(
	`°rcmp
(
id
, "b") == 0 || strcmp(id, "z") == 0)

772 
idx
 = 
PREAMBLE_Z
;

773 i‡(
	`°rcmp
(
id
, "m") == 0 || strcmp(id, "x") == 0)

774 
idx
 = 
PREAMBLE_X
;

775 i‡(
	`°rcmp
(
id
, "w") == 0 || strcmp(id, "y") == 0)

776 
idx
 = 
PREAMBLE_Y
;

778 
	`SNDERR
("övÆid IEC958ÖªambÀÅy≥ %s", 
id
);

779  -
EINVAL
;

781 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
vÆ
);

782 i‡(
îr
 < 0) {

783 
	`SNDERR
("invalid IEC958Öreamble value");

784  
îr
;

786 
¥ómbÀ_vÆs
[
idx
] = 
vÆ
;

789 i‡(!
¶ave
) {

790 
	`SNDERR
("slave isÇot defined");

791  -
EINVAL
;

793 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 1,

794 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_MANDATORY
, &
sf‹m©
);

795 i‡(
îr
 < 0)

796  
îr
;

797 i‡(
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1 &&

798 
sf‹m©
 !
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
 &&

799 
sf‹m©
 !
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
) {

800 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

801 
	`SNDERR
("invalid slave format");

802  -
EINVAL
;

804 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

805 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

806 i‡(
îr
 < 0)

807  
îr
;

808 
îr
 = 
	`¢d_pcm_õc958_›í
(
pcmp
, 
«me
, 
sf‹m©
, 
•cm
, 1,

809 
°©us
 ? 
°©us_bôs
 : 
NULL
,

810 
¥ómbÀ_vÆs
, 
hdmi_mode
);

811 i‡(
îr
 < 0)

812 
	`¢d_pcm_˛o£
(
•cm
);

813  
îr
;

814 
	}
}

815 #i‚de‡
DOC_HIDDEN


816 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_õc958_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_ioplug.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_i›lug.h
"

31 
	~"pcm_ext_∑rm.h
"

32 
	~"pcm_gíîic.h
"

34 #i‚de‡
PIC


36 c⁄° *
	g_¢d_moduÀ_pcm_i›lug
 = "";

39 #i‚de‡
DOC_HIDDEN


42 
	s¢d_pcm_i›lug_¥iv
 {

43 
¢d_pcm_i›lug_t
 *
	md©a
;

44 
¢d_ext_∑rm
 
	m∑øms
[
SND_PCM_IOPLUG_HW_PARAMS
];

45 
¢d_pcm_u‰ames_t
 
	mœ°_hw
;

46 
¢d_pcm_u‰ames_t
 
	mavaû_max
;

47 
¢d_htime°amp_t
 
	måiggî_t°amp
;

48 } 
	ti›lug_¥iv_t
;

50 
¢d_pcm_i›lug_dr›
(
¢d_pcm_t
 *
pcm
);

51 
¢d_pcm_i›lug_pﬁl_des¸ùt‹s_cou¡
(
¢d_pcm_t
 *
pcm
);

52 
¢d_pcm_i›lug_pﬁl_des¸ùt‹s
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
•a˚
);

53 
¢d_pcm_i›lug_pﬁl_ªvíts
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
);

57 
	$¢d_pcm_i›lug_hw_±r_upd©e
(
¢d_pcm_t
 *
pcm
)

59 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

60 
¢d_pcm_s‰ames_t
 
hw
;

62 
hw
 = 
io
->
d©a
->
ˇŒback
->
	`poöãr
(io->data);

63 i‡(
hw
 >= 0) {

64 
¢d_pcm_u‰ames_t
 
dñè
;

65 
¢d_pcm_u‰ames_t
 
avaû
;

67 i‡((
¢d_pcm_u‰ames_t
)
hw
 >
io
->
œ°_hw
)

68 
dñè
 = 
hw
 - 
io
->
œ°_hw
;

70 c⁄° 
¢d_pcm_u‰ames_t
 
wøp_poöt
 =

71 (
io
->
d©a
->
Êags
 & 
SND_PCM_IOPLUG_FLAG_BOUNDARY_WA
) ?

72 
pcm
->
bound¨y
 :Öcm->
buf„r_size
;

73 
dñè
 = 
wøp_poöt
 + 
hw
 - 
io
->
œ°_hw
;

75 
	`¢d_pcm_mm≠_hw_f‹w¨d
(
io
->
d©a
->
pcm
, 
dñè
);

77 i‡(
io
->
d©a
->
°©e
 =
SND_PCM_STATE_DRAINING
) {

78 
avaû
 = 
	`¢d_pcm_mm≠_avaû
(
pcm
);

79 i‡(
avaû
 >
pcm
->
buf„r_size
)

80 
	`¢d_pcm_i›lug_dr›
(
pcm
);

82 
io
->
œ°_hw
 = (
¢d_pcm_u‰ames_t
)
hw
;

84 i‡(
io
->
d©a
->
°©e
 =
SND_PCM_STATE_DRAINING
)

85 
	`¢d_pcm_i›lug_dr›
(
pcm
);

87 
io
->
d©a
->
°©e
 = 
SNDRV_PCM_STATE_XRUN
;

89 
	}
}

91 
	$¢d_pcm_i›lug_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_öfo_t
 *
öfo
)

93 
	`mem£t
(
öfo
, 0, (*info));

94 
öfo
->
°ªam
 = 
pcm
->stream;

95 
öfo
->
ˇrd
 = -1;

96 i‡(
pcm
->
«me
) {

97 
	`¢d_°æ˝y
((*)
öfo
->
id
, 
pcm
->
«me
, (info->id));

98 
	`¢d_°æ˝y
((*)
öfo
->
«me
, 
pcm
->name, (info->name));

99 
	`¢d_°æ˝y
((*)
öfo
->
sub«me
, 
pcm
->
«me
, (info->subname));

101 
öfo
->
subdevi˚s_cou¡
 = 1;

103 
	}
}

105 
	$¢d_pcm_i›lug_ch™√l_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_öfo_t
 *
öfo
)

107  
	`¢d_pcm_ch™√l_öfo_shm
(
pcm
, 
öfo
, -1);

108 
	}
}

110 
	$¢d_pcm_i›lug_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
)

112 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

114 i‡(
io
->
d©a
->
vîsi⁄
 >= 0x010001 &&

115 
io
->
d©a
->
ˇŒback
->
dñay
)

116  
io
->
d©a
->
ˇŒback
->
	`dñay
(io->d©a, 
dñayp
);

118 
	`¢d_pcm_i›lug_hw_±r_upd©e
(
pcm
);

119 *
dñayp
 = 
	`¢d_pcm_mm≠_dñay
(
pcm
);

122 
	}
}

124 
	$¢d_pcm_i›lug_°©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©us_t
 * 
°©us
)

126 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

127 
¢d_pcm_s‰ames_t
 
sd
;

129 
	`mem£t
(
°©us
, 0, (*status));

130 
	`¢d_pcm_i›lug_hw_±r_upd©e
(
pcm
);

131 
°©us
->
°©e
 = 
io
->
d©a
->state;

132 
°©us
->
åiggî_t°amp
 = 
io
->trigger_tstamp;

133 
	`gëtime°amp
(&
°©us
->
t°amp
, 
pcm
->
t°amp_ty≥
);

134 
°©us
->
avaû
 = 
	`¢d_pcm_mm≠_avaû
(
pcm
);

135 
°©us
->
avaû_max
 = 
io
->avail_max;

136 
°©us
->
≠∂_±r
 = *
pcm
->
≠∂
.
±r
;

137 
°©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

138 i‡(
	`¢d_pcm_i›lug_dñay
(
pcm
, &
sd
) < 0)

139 
sd
 = 
	`¢d_pcm_mm≠_dñay
(
pcm
);

140 
°©us
->
dñay
 = 
sd
;

142 
	}
}

144 
¢d_pcm_°©e_t
 
	$¢d_pcm_i›lug_°©e
(
¢d_pcm_t
 *
pcm
)

146 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

147  
io
->
d©a
->
°©e
;

148 
	}
}

150 
	$¢d_pcm_i›lug_hwsync
(
¢d_pcm_t
 *
pcm
)

152 
	`¢d_pcm_i›lug_hw_±r_upd©e
(
pcm
);

154 
	}
}

156 
	$¢d_pcm_i›lug_ª£t
(
¢d_pcm_t
 *
pcm
)

158 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

160 
io
->
d©a
->
≠∂_±r
 = 0;

161 
io
->
d©a
->
hw_±r
 = 0;

162 
io
->
œ°_hw
 = 0;

163 
io
->
avaû_max
 = 0;

165 
	}
}

167 
	$¢d_pcm_i›lug_¥ï¨e
(
¢d_pcm_t
 *
pcm
)

169 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

170 
îr
 = 0;

172 
	`¢d_pcm_i›lug_ª£t
(
pcm
);

173 i‡(
io
->
d©a
->
ˇŒback
->
¥ï¨e
) {

174 
	`¢d_pcm_u∆ock
(
pcm
);

175 
îr
 = 
io
->
d©a
->
ˇŒback
->
	`¥ï¨e
(io->data);

176 
	`¢d_pcm_lock
(
pcm
);

178 i‡(
îr
 < 0)

179  
îr
;

181 
io
->
d©a
->
°©e
 = 
SND_PCM_STATE_PREPARED
;

182  
îr
;

183 
	}
}

185 c⁄° 
	ghw_∑øms_ty≥
[
SND_PCM_IOPLUG_HW_PARAMS
] = {

186 [
SND_PCM_IOPLUG_HW_ACCESS
] = 
SND_PCM_HW_PARAM_ACCESS
,

187 [
SND_PCM_IOPLUG_HW_FORMAT
] = 
SND_PCM_HW_PARAM_FORMAT
,

188 [
SND_PCM_IOPLUG_HW_CHANNELS
] = 
SND_PCM_HW_PARAM_CHANNELS
,

189 [
SND_PCM_IOPLUG_HW_RATE
] = 
SND_PCM_HW_PARAM_RATE
,

190 [
SND_PCM_IOPLUG_HW_PERIOD_BYTES
] = 
SND_PCM_HW_PARAM_PERIOD_BYTES
,

191 [
SND_PCM_IOPLUG_HW_BUFFER_BYTES
] = 
SND_PCM_HW_PARAM_BUFFER_BYTES
,

192 [
SND_PCM_IOPLUG_HW_PERIODS
] = 
SND_PCM_HW_PARAM_PERIODS
,

196 
	$ruÀ_mul
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
x
, 
a
, 
b
)

198 
¢d_öãrvÆ_t
 
t
;

200 
	`¢d_öãrvÆ_mul
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
a
),

201 
	`hw_∑øm_öãrvÆ
(
∑øms
, 
b
), &
t
);

202  
	`¢d_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
x
), &
t
);

203 
	}
}

206 
	$ruÀ_div
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
x
, 
a
, 
b
)

208 
¢d_öãrvÆ_t
 
t
;

210 
	`¢d_öãrvÆ_div
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
a
),

211 
	`hw_∑øm_öãrvÆ
(
∑øms
, 
b
), &
t
);

212  
	`¢d_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
x
), &
t
);

213 
	}
}

216 
	$ruÀ_muldivk
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
x
, 
a
, 
b
, 
k
)

218 
¢d_öãrvÆ_t
 
t
;

220 
	`¢d_öãrvÆ_muldivk
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
a
),

221 
	`hw_∑øm_öãrvÆ
(
∑øms
, 
b
), 
k
, &
t
);

222  
	`¢d_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
x
), &
t
);

223 
	}
}

226 
	$ruÀ_mulkdiv
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
x
, 
a
, 
k
, 
b
)

228 
¢d_öãrvÆ_t
 
t
;

230 
	`¢d_öãrvÆ_mulkdiv
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
a
), 
k
,

231 
	`hw_∑øm_öãrvÆ
(
∑øms
, 
b
), &
t
);

232  
	`¢d_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
x
), &
t
);

233 
	}
}

236 
	$dump_∑rm
(
¢d_pcm_hw_∑øms_t
 *
∑øms
)

238 
¢d_ouçut_t
 *
log
;

239 
	`¢d_ouçut_°dio_©èch
(&
log
, 
°dîr
, 0);

240 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
log
);

241 
	`¢d_ouçut_˛o£
(
log
);

242 
	}
}

246 
	$ªföe_time_™d_size
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

247 
time
, 
size
, 
byãs
)

249 
îr
, 
ch™ge1
 = 0;

252 
îr
 = 
	`ruÀ_muldivk
(
∑øms
, 
size
, 
time
,

253 
SND_PCM_HW_PARAM_RATE
, 1000000);

254 i‡(
îr
 < 0)

255  
îr
;

256 
ch™ge1
 |
îr
;

259 
îr
 = 
	`ruÀ_muldivk
(
∑øms
, 
byãs
, 
size
,

260 
SND_PCM_HW_PARAM_FRAME_BITS
, 8);

261 i‡(
îr
 < 0)

262  
îr
;

263 
ch™ge1
 |
îr
;

264  
ch™ge1
;

265 
	}
}

268 
	$ªföe_back_time_™d_size
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

269 
time
, 
size
, 
byãs
)

271 
îr
;

274 
îr
 = 
	`ruÀ_mulkdiv
(
∑øms
, 
size
, 
byãs
, 8, 
SND_PCM_HW_PARAM_FRAME_BITS
);

275 i‡(
îr
 < 0)

276  
îr
;

278 
îr
 = 
	`ruÀ_mulkdiv
(
∑øms
, 
time
, 
size
, 1000000, 
SND_PCM_HW_PARAM_RATE
);

279 i‡(
îr
 < 0)

280  
îr
;

282 
	}
}

285 
	$¢d_pcm_i›lug_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

287 
ch™ge
 = 0, 
ch™ge1
, 
ch™ge2
, 
îr
;

288 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

289 
¢d_ext_∑rm
 *
p
;

290 
i
;

293 
i
 = 
SND_PCM_IOPLUG_HW_ACCESS
; i <
SND_PCM_IOPLUG_HW_FORMAT
; i++) {

294 
îr
 = 
	`¢d_ext_∑rm_mask_ªföe
(
	`hw_∑øm_mask
(
∑øms
, 
hw_∑øms_ty≥
[
i
]),

295 
io
->
∑øms
, 
i
);

296 i‡(
îr
 < 0)

297  
îr
;

298 
ch™ge
 |
îr
;

301 ; 
i
 <
SND_PCM_IOPLUG_HW_RATE
; i++) {

302 
îr
 = 
	`¢d_ext_∑rm_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
hw_∑øms_ty≥
[
i
]),

303 
io
->
∑øms
, 
i
);

304 i‡(
îr
 < 0)

305  
îr
;

306 
ch™ge
 |
îr
;

309 i‡(
∑øms
->
rmask
 & ((1 << 
SND_PCM_HW_PARAM_ACCESS
) |

310 (1 << 
SND_PCM_HW_PARAM_FORMAT
) |

311 (1 << 
SND_PCM_HW_PARAM_SUBFORMAT
) |

312 (1 << 
SND_PCM_HW_PARAM_CHANNELS
) |

313 (1 << 
SND_PCM_HW_PARAM_RATE
))) {

314 
îr
 = 
	`¢d_pcm_hw_ªföe_so·
(
pcm
, 
∑øms
);

315 i‡(
îr
 < 0)

316  
îr
;

317 
ch™ge
 |
îr
;

320 
ch™ge1
 = 
	`ªföe_time_™d_size
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
,

321 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

322 
SND_PCM_HW_PARAM_PERIOD_BYTES
);

323 i‡(
ch™ge1
 < 0)

324  
ch™ge1
;

325 
îr
 = 
	`¢d_ext_∑rm_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_BYTES
),

326 
io
->
∑øms
, 
SND_PCM_IOPLUG_HW_PERIOD_BYTES
);

327 i‡(
îr
 < 0)

328  
îr
;

329 
ch™ge1
 |
îr
;

330 i‡(
ch™ge1
) {

331 
ch™ge
 |
ch™ge1
;

332 
îr
 = 
	`ªföe_back_time_™d_size
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
,

333 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

334 
SND_PCM_HW_PARAM_PERIOD_BYTES
);

335 i‡(
îr
 < 0)

336  
îr
;

339 
ch™ge1
 = 
	`ªföe_time_™d_size
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
,

340 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

341 
SND_PCM_HW_PARAM_BUFFER_BYTES
);

342 i‡(
ch™ge1
 < 0)

343  
ch™ge1
;

344 
ch™ge
 |
ch™ge1
;

347 
ch™ge2
 = 0;

348 
îr
 = 
	`¢d_ext_∑rm_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_BYTES
),

349 
io
->
∑øms
, 
SND_PCM_IOPLUG_HW_BUFFER_BYTES
);

350 i‡(
îr
 < 0)

351  
îr
;

352 
ch™ge2
 |
îr
;

354 
îr
 = 
	`ruÀ_div
(
∑øms
, 
SND_PCM_HW_PARAM_PERIODS
,

355 
SND_PCM_HW_PARAM_BUFFER_BYTES
,

356 
SND_PCM_HW_PARAM_PERIOD_BYTES
);

357 i‡(
îr
 < 0)

358  
îr
;

359 
ch™ge2
 |
îr
;

360 
îr
 = 
	`¢d_ext_∑rm_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_PERIODS
),

361 
io
->
∑øms
, 
SND_PCM_IOPLUG_HW_PERIODS
);

362 i‡(
îr
 < 0)

363  
îr
;

364 
ch™ge2
 |
îr
;

366 
îr
 = 
	`ruÀ_mul
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_BYTES
,

367 
SND_PCM_HW_PARAM_PERIOD_BYTES
,

368 
SND_PCM_HW_PARAM_PERIODS
);

369 i‡(
îr
 < 0)

370  
îr
;

371 
ch™ge2
 |
îr
;

372 
ch™ge1
 |
ch™ge2
;

373 } 
ch™ge2
);

374 
ch™ge
 |
ch™ge1
;

376 i‡(
ch™ge1
) {

377 
îr
 = 
	`ªföe_back_time_™d_size
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
,

378 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

379 
SND_PCM_HW_PARAM_BUFFER_BYTES
);

380 i‡(
îr
 < 0)

381  
îr
;

385 
îr
 = 
	`ruÀ_div
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_BYTES
,

386 
SND_PCM_HW_PARAM_BUFFER_BYTES
,

387 
SND_PCM_HW_PARAM_PERIODS
);

388 i‡(
îr
 < 0)

389  
îr
;

390 i‡(
îr
) {

392 
ch™ge
 |
îr
;

393 
îr
 = 
	`¢d_ext_∑rm_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_BYTES
),

394 
io
->
∑øms
, 
SND_PCM_IOPLUG_HW_PERIOD_BYTES
);

395 i‡(
îr
 < 0)

396  
îr
;

397 
îr
 = 
	`ªföe_back_time_™d_size
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
,

398 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

399 
SND_PCM_HW_PARAM_PERIOD_BYTES
);

400 i‡(
îr
 < 0)

401  
îr
;

404 
∑øms
->
öfo
 = 
SND_PCM_INFO_BLOCK_TRANSFER
;

405 
p
 = &
io
->
∑øms
[
SND_PCM_IOPLUG_HW_ACCESS
];

406 i‡(
p
->
a˘ive
) {

407 
i
 = 0; i < 
p
->
num_li°
; i++)

408 
p
->
li°
[
i
]) {

409 
SND_PCM_ACCESS_MMAP_INTERLEAVED
:

410 
SND_PCM_ACCESS_RW_INTERLEAVED
:

411 
∑øms
->
öfo
 |
SND_PCM_INFO_INTERLEAVED
;

413 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
:

414 
SND_PCM_ACCESS_RW_NONINTERLEAVED
:

415 
∑øms
->
öfo
 |
SND_PCM_INFO_NONINTERLEAVED
;

419 i‡(
io
->
d©a
->
ˇŒback
->
∑u£
)

420 
∑øms
->
öfo
 |
SND_PCM_INFO_PAUSE
;

421 i‡(
io
->
d©a
->
ˇŒback
->
ªsume
)

422 
∑øms
->
öfo
 |
SND_PCM_INFO_RESUME
;

425 
	`Ârötf
(
°dîr
, "XXX\n");

426 
	`dump_∑rm
(
∑øms
);

428  
ch™ge
;

429 
	}
}

431 
	$¢d_pcm_i›lug_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

433 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

434 
îr
;

436 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_ac˚ss
)(
∑øms
, &
io
->
d©a
->
ac˚ss
);

437 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(
∑øms
, &
io
->
d©a
->
f‹m©
);

438 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_ch™√ls
)(
∑øms
, &
io
->
d©a
->
ch™√ls
);

439 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_øã
)(
∑øms
, &
io
->
d©a
->
øã
, 0);

440 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_size
)(
∑øms
, &
io
->
d©a
->
≥riod_size
, 0);

441 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_size
)(
∑øms
, &
io
->
d©a
->
buf„r_size
);

442 i‡(
io
->
d©a
->
ˇŒback
->
hw_∑øms
) {

443 
îr
 = 
io
->
d©a
->
ˇŒback
->
	`hw_∑øms
(io->d©a, 
∑øms
);

444 i‡(
îr
 < 0)

445  
îr
;

446 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_ac˚ss
)(
∑øms
, &
io
->
d©a
->
ac˚ss
);

447 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(
∑øms
, &
io
->
d©a
->
f‹m©
);

448 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_ch™√ls
)(
∑øms
, &
io
->
d©a
->
ch™√ls
);

449 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_øã
)(
∑øms
, &
io
->
d©a
->
øã
, 0);

450 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_size
)(
∑øms
, &
io
->
d©a
->
≥riod_size
, 0);

451 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_size
)(
∑øms
, &
io
->
d©a
->
buf„r_size
);

454 
	}
}

456 
	$¢d_pcm_i›lug_hw_‰ì
(
¢d_pcm_t
 *
pcm
)

458 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

460 i‡(
io
->
d©a
->
ˇŒback
->
hw_‰ì
)

461  
io
->
d©a
->
ˇŒback
->
	`hw_‰ì
(io->data);

463 
	}
}

465 
	$¢d_pcm_i›lug_sw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
)

467 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

468 
îr
;

470 i‡(!
io
->
d©a
->
ˇŒback
->
sw_∑øms
)

473 
	`¢d_pcm_u∆ock
(
pcm
);

474 
îr
 = 
io
->
d©a
->
ˇŒback
->
	`sw_∑øms
(io->d©a, 
∑øms
);

475 
	`¢d_pcm_lock
(
pcm
);

477  
îr
;

478 
	}
}

481 
	$¢d_pcm_i›lug_°¨t
(
¢d_pcm_t
 *
pcm
)

483 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

484 
îr
;

486 i‡(
io
->
d©a
->
°©e
 !
SND_PCM_STATE_PREPARED
)

487  -
EBADFD
;

489 
îr
 = 
io
->
d©a
->
ˇŒback
->
	`°¨t
(io->data);

490 i‡(
îr
 < 0)

491  
îr
;

493 
	`gëtime°amp
(&
io
->
åiggî_t°amp
, 
pcm
->
t°amp_ty≥
);

494 
io
->
d©a
->
°©e
 = 
SND_PCM_STATE_RUNNING
;

497 
	}
}

499 
	$¢d_pcm_i›lug_dr›
(
¢d_pcm_t
 *
pcm
)

501 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

503 i‡(
io
->
d©a
->
°©e
 =
SND_PCM_STATE_OPEN
)

504  -
EBADFD
;

506 
io
->
d©a
->
ˇŒback
->
	`°›
(io->data);

508 
	`gëtime°amp
(&
io
->
åiggî_t°amp
, 
pcm
->
t°amp_ty≥
);

509 
io
->
d©a
->
°©e
 = 
SND_PCM_STATE_SETUP
;

512 
	}
}

514 
	$i›lug_døö_vü_pﬁl
(
¢d_pcm_t
 *
pcm
)

516 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

518 
io
->
d©a
->
°©e
 =
SND_PCM_STATE_DRAINING
) {

519 
	`¢d_pcm_i›lug_hw_±r_upd©e
(
pcm
);

520 i‡(
io
->
d©a
->
°©e
 !
SND_PCM_STATE_DRAINING
)

523 i‡(
io
->
d©a
->
n⁄block
)

524  -
EAGAIN
;

525 i‡(
	`¢d_pcm_waô_nocheck
(
pcm
, 
SND_PCM_WAIT_DRAIN
) < 0)

530 
	}
}

533 
	$¢d_pcm_i›lug_døö
(
¢d_pcm_t
 *
pcm
)

535 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

536 
îr
 = 0;

538 
	`¢d_pcm_lock
(
pcm
);

539 
io
->
d©a
->
°©e
) {

540 
SND_PCM_STATE_OPEN
:

541 
SND_PCM_STATE_DISCONNECTED
:

542 
SND_PCM_STATE_SUSPENDED
:

543 
	`¢d_pcm_u∆ock
(
pcm
);

544  -
EBADFD
;

545 
SND_PCM_STATE_PREPARED
:

546 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

547 i‡(!
io
->
d©a
->
ˇŒback
->
døö
) {

548 
îr
 = 
	`¢d_pcm_i›lug_°¨t
(
pcm
);

549 i‡(
îr
 < 0)

550 
u∆ock
;

552 
io
->
d©a
->
°©e
 = 
SND_PCM_STATE_DRAINING
;

555 
SND_PCM_STATE_RUNNING
:

556 
io
->
d©a
->
°©e
 = 
SND_PCM_STATE_DRAINING
;

562 i‡(
io
->
d©a
->
°©e
 =
SND_PCM_STATE_DRAINING
) {

563 i‡(
io
->
d©a
->
ˇŒback
->
døö
) {

564 
	`¢d_pcm_u∆ock
(
pcm
);

565 
îr
 = 
io
->
d©a
->
ˇŒback
->
	`døö
(io->data);

566 
	`¢d_pcm_lock
(
pcm
);

568 
îr
 = 
	`i›lug_døö_vü_pﬁl
(
pcm
);

572 
u∆ock
:

573 i‡(!
îr
 && 
io
->
d©a
->
°©e
 !
SND_PCM_STATE_SETUP
)

574 
	`¢d_pcm_i›lug_dr›
(
pcm
);

575 
	`¢d_pcm_u∆ock
(
pcm
);

576  
îr
;

577 
	}
}

579 
	$¢d_pcm_i›lug_∑u£
(
¢d_pcm_t
 *
pcm
, 
íabÀ
)

581 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

582 c⁄° 
¢d_pcm_°©e_t
 
°©es
[2] = {

583 
SND_PCM_STATE_RUNNING
, 
SND_PCM_STATE_PAUSED


585 
¥ev
, 
îr
;

587 
¥ev
 = !
íabÀ
;

588 
íabÀ
 = !
¥ev
;

589 i‡(
io
->
d©a
->
°©e
 !
°©es
[
¥ev
])

590  -
EBADFD
;

591 i‡(
io
->
d©a
->
ˇŒback
->
∑u£
) {

592 
îr
 = 
io
->
d©a
->
ˇŒback
->
	`∑u£
(io->d©a, 
íabÀ
);

593 i‡(
îr
 < 0)

594  
îr
;

596 
io
->
d©a
->
°©e
 = 
°©es
[
íabÀ
];

598 
	}
}

600 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_i›lug_ªwödabÀ
(
¢d_pcm_t
 *
pcm
)

602  
	`¢d_pcm_mm≠_hw_ªwödabÀ
(
pcm
);

603 
	}
}

605 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_i›lug_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

607 
	`¢d_pcm_mm≠_≠∂_backw¨d
(
pcm
, 
‰ames
);

608  
‰ames
;

609 
	}
}

611 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_i›lug_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
)

613  
	`¢d_pcm_mm≠_avaû
(
pcm
);

614 
	}
}

616 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_i›lug_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

618 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
‰ames
);

619  
‰ames
;

620 
	}
}

623 
	$¢d_pcm_i›lug_ªsume
(
¢d_pcm_t
 *
pcm
)

625 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

627 i‡(
io
->
d©a
->
ˇŒback
->
ªsume
)

628 
io
->
d©a
->
ˇŒback
->
	`ªsume
(io->data);

630 
	}
}

633 
¢d_pcm_s‰ames_t
 
	$i›lug_¥iv_å™s„r_¨ós
(
¢d_pcm_t
 *
pcm
,

634 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

635 
¢d_pcm_u‰ames_t
 
off£t
,

636 
¢d_pcm_u‰ames_t
 
size
)

638 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

639 
¢d_pcm_s‰ames_t
 
ªsu…
;

641 i‡(! 
size
)

643 i‡(
io
->
d©a
->
ˇŒback
->
å™s„r
)

644 
ªsu…
 = 
io
->
d©a
->
ˇŒback
->
	`å™s„r
(io->d©a, 
¨ós
, 
off£t
, 
size
);

646 
ªsu…
 = 
size
;

647 i‡(
ªsu…
 > 0)

648 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
ªsu…
);

649  
ªsu…
;

650 
	}
}

652 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_i›lug_wrôei
(
¢d_pcm_t
 *
pcm
, c⁄° *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

654 i‡(
pcm
->
mm≠_rw
)

655  
	`¢d_pcm_mm≠_wrôei
(
pcm
, 
buf„r
, 
size
);

657 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

658 
	`¢d_pcm_¨ós_‰om_buf
(
pcm
, 
¨ós
, (*)
buf„r
);

659  
	`¢d_pcm_wrôe_¨ós
(
pcm
, 
¨ós
, 0, 
size
,

660 
i›lug_¥iv_å™s„r_¨ós
);

662 
	}
}

664 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_i›lug_wrôí
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

666 i‡(
pcm
->
mm≠_rw
)

667  
	`¢d_pcm_mm≠_wrôí
(
pcm
, 
bufs
, 
size
);

669 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

670 
	`¢d_pcm_¨ós_‰om_bufs
(
pcm
, 
¨ós
, 
bufs
);

671  
	`¢d_pcm_wrôe_¨ós
(
pcm
, 
¨ós
, 0, 
size
,

672 
i›lug_¥iv_å™s„r_¨ós
);

674 
	}
}

676 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_i›lug_ªadi
(
¢d_pcm_t
 *
pcm
, *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

678 i‡(
pcm
->
mm≠_rw
)

679  
	`¢d_pcm_mm≠_ªadi
(
pcm
, 
buf„r
, 
size
);

681 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

682 
	`¢d_pcm_¨ós_‰om_buf
(
pcm
, 
¨ós
, 
buf„r
);

683  
	`¢d_pcm_ªad_¨ós
(
pcm
, 
¨ós
, 0, 
size
,

684 
i›lug_¥iv_å™s„r_¨ós
);

686 
	}
}

688 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_i›lug_ªadn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

690 i‡(
pcm
->
mm≠_rw
)

691  
	`¢d_pcm_mm≠_ªadn
(
pcm
, 
bufs
, 
size
);

693 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

694 
	`¢d_pcm_¨ós_‰om_bufs
(
pcm
, 
¨ós
, 
bufs
);

695  
	`¢d_pcm_ªad_¨ós
(
pcm
, 
¨ós
, 0, 
size
,

696 
i›lug_¥iv_å™s„r_¨ós
);

698 
	}
}

700 
	$¢d_pcm_i›lug_mm≠_begö_ˇ±uª
(
¢d_pcm_t
 *
pcm
,

701 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 **
¨ós
,

702 
¢d_pcm_u‰ames_t
 *
off£t
,

703 
¢d_pcm_u‰ames_t
 *
‰ames
)

705 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

706 
îr
;

708 
îr
 = 
	`__¢d_pcm_mm≠_begö_gíîic
(
pcm
, 
¨ós
, 
off£t
, 
‰ames
);

709 i‡(
îr
 < 0)

710  
îr
;

712 i‡(
io
->
d©a
->
ˇŒback
->
å™s„r
 &&

713 
pcm
->
ac˚ss
 !
SND_PCM_ACCESS_RW_INTERLEAVED
 &&

714 
pcm
->
ac˚ss
 !
SND_PCM_ACCESS_RW_NONINTERLEAVED
) {

715 
¢d_pcm_s‰ames_t
 
ªsu…
;

716 
ªsu…
 = 
io
->
d©a
->
ˇŒback
->
	`å™s„r
(io->d©a, *
¨ós
, *
off£t
, *
‰ames
);

717 i‡(
ªsu…
 < 0)

718  
ªsu…
;

721  
îr
;

722 
	}
}

724 
	$¢d_pcm_i›lug_mm≠_begö
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_ch™√l_¨ó_t
 **
¨ós
,

725 
¢d_pcm_u‰ames_t
 *
off£t
, snd_pcm_u‰ames_à*
‰ames
)

727 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

728  
	`__¢d_pcm_mm≠_begö_gíîic
(
pcm
, 
¨ós
, 
off£t
, 
‰ames
);

729  
	`¢d_pcm_i›lug_mm≠_begö_ˇ±uª
(
pcm
, 
¨ós
, 
off£t
, 
‰ames
);

730 
	}
}

732 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_i›lug_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

733 
¢d_pcm_u‰ames_t
 
off£t
,

734 
¢d_pcm_u‰ames_t
 
size
)

736 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
 &&

737 
pcm
->
ac˚ss
 !
SND_PCM_ACCESS_RW_INTERLEAVED
 &&

738 
pcm
->
ac˚ss
 !
SND_PCM_ACCESS_RW_NONINTERLEAVED
) {

739 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
;

740 
¢d_pcm_u‰ames_t
 
ofs
, 
‰ames
 = 
size
;

742 
	`__¢d_pcm_mm≠_begö_gíîic
(
pcm
, &
¨ós
, &
ofs
, &
‰ames
);

743 i‡(
ofs
 !
off£t
)

744  -
EIO
;

745  
	`i›lug_¥iv_å™s„r_¨ós
(
pcm
, 
¨ós
, 
off£t
, 
‰ames
);

748 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
size
);

749  
size
;

750 
	}
}

752 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_i›lug_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

754 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

755 
¢d_pcm_u‰ames_t
 
avaû
;

757 
	`¢d_pcm_i›lug_hw_±r_upd©e
(
pcm
);

758 i‡(
io
->
d©a
->
°©e
 =
SND_PCM_STATE_XRUN
)

759  -
EPIPE
;

761 
avaû
 = 
	`¢d_pcm_mm≠_avaû
(
pcm
);

762 i‡(
avaû
 > 
io
->
avaû_max
)

763 
io
->
avaû_max
 = 
avaû
;

764  (
¢d_pcm_s‰ames_t
)
avaû
;

765 
	}
}

767 
	$¢d_pcm_i›lug_n⁄block
(
¢d_pcm_t
 *
pcm
, 
n⁄block
)

769 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

771 
io
->
d©a
->
n⁄block
 =Çonblock;

773 
	}
}

775 
	$¢d_pcm_i›lug_pﬁl_des¸ùt‹s_cou¡
(
¢d_pcm_t
 *
pcm
)

777 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

778 
îr
 = 1;

780 i‡(
io
->
d©a
->
ˇŒback
->
pﬁl_des¸ùt‹s_cou¡
) {

781 
	`¢d_pcm_u∆ock
(
pcm
);

782 
îr
 = 
io
->
d©a
->
ˇŒback
->
	`pﬁl_des¸ùt‹s_cou¡
(io->data);

783 
	`¢d_pcm_lock
(
pcm
);

785  
îr
;

786 
	}
}

788 
	$¢d_pcm_i›lug_pﬁl_des¸ùt‹s
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
•a˚
)

790 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

791 
îr
;

793 i‡(
io
->
d©a
->
ˇŒback
->
pﬁl_des¸ùt‹s
) {

794 
	`¢d_pcm_u∆ock
(
pcm
);

795 
îr
 = 
io
->
d©a
->
ˇŒback
->
	`pﬁl_des¸ùt‹s
(io->d©a, 
pfds
, 
•a˚
);

796 
	`¢d_pcm_lock
(
pcm
);

797  
îr
;

799 i‡(
pcm
->
pﬁl_fd
 < 0)

800  -
EIO
;

801 i‡(
•a˚
 >1 && 
pfds
) {

802 
pfds
->
fd
 = 
pcm
->
pﬁl_fd
;

803 
pfds
->
evíts
 = 
pcm
->
pﬁl_evíts
 | 
POLLERR
 | 
POLLNVAL
;

808 
	}
}

810 
	$¢d_pcm_i›lug_pﬁl_ªvíts
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

812 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

813 
îr
;

815 i‡(
io
->
d©a
->
ˇŒback
->
pﬁl_ªvíts
) {

816 
	`¢d_pcm_u∆ock
(
pcm
);

817 
îr
 = 
io
->
d©a
->
ˇŒback
->
	`pﬁl_ªvíts
(io->d©a, 
pfds
, 
nfds
, 
ªvíts
);

818 
	`¢d_pcm_lock
(
pcm
);

820 *
ªvíts
 = 
pfds
->revents;

821 
îr
 = 0;

823  
îr
;

824 
	}
}

826 
	$¢d_pcm_i›lug_mm≠
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

829 
	}
}

831 
	$¢d_pcm_i›lug_async
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

832 
sig
 
ATTRIBUTE_UNUSED
,

833 
pid_t
 
pid
 
ATTRIBUTE_UNUSED
)

835  -
ENOSYS
;

836 
	}
}

838 
	$¢d_pcm_i›lug_munm≠
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

841 
	}
}

843 
¢d_pcm_chm≠_quîy_t
 **
	$¢d_pcm_i›lug_quîy_chm≠s
(
¢d_pcm_t
 *
pcm
)

845 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

847 i‡(
io
->
d©a
->
vîsi⁄
 >= 0x010002 &&

848 
io
->
d©a
->
ˇŒback
->
quîy_chm≠s
)

849  
io
->
d©a
->
ˇŒback
->
	`quîy_chm≠s
(io->data);

850  
NULL
;

851 
	}
}

853 
¢d_pcm_chm≠_t
 *
	$¢d_pcm_i›lug_gë_chm≠
(
¢d_pcm_t
 *
pcm
)

855 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

857 i‡(
io
->
d©a
->
vîsi⁄
 >= 0x010002 &&

858 
io
->
d©a
->
ˇŒback
->
gë_chm≠
)

859  
io
->
d©a
->
ˇŒback
->
	`gë_chm≠
(io->data);

860  
NULL
;

861 
	}
}

863 
	$¢d_pcm_i›lug_£t_chm≠
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_chm≠_t
 *
m≠
)

865 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

867 i‡(
io
->
d©a
->
vîsi⁄
 >= 0x010002 &&

868 
io
->
d©a
->
ˇŒback
->
£t_chm≠
)

869  
io
->
d©a
->
ˇŒback
->
	`£t_chm≠
(io->d©a, 
m≠
);

870  -
ENXIO
;

871 
	}
}

873 
	$¢d_pcm_i›lug_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

875 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

877 i‡(
io
->
d©a
->
ˇŒback
->
dump
)

878 
io
->
d©a
->
ˇŒback
->
	`dump
(io->d©a, 
out
);

880 i‡(
io
->
d©a
->
«me
)

881 
	`¢d_ouçut_¥ötf
(
out
, "%s\n", 
io
->
d©a
->
«me
);

883 
	`¢d_ouçut_¥ötf
(
out
, "IO-PCM Plugin\n");

884 i‡(
pcm
->
£tup
) {

885 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

886 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

889 
	}
}

891 
	$˛ór_io_∑øms
(
i›lug_¥iv_t
 *
io
)

893 
i
;

894 
i
 = 0; i < 
SND_PCM_IOPLUG_HW_PARAMS
; i++)

895 
	`¢d_ext_∑rm_˛ór
(&
io
->
∑øms
[
i
]);

896 
	}
}

898 
	$¢d_pcm_i›lug_˛o£
(
¢d_pcm_t
 *
pcm
)

900 
i›lug_¥iv_t
 *
io
 = 
pcm
->
¥iv©e_d©a
;

902 
	`˛ór_io_∑øms
(
io
);

903 i‡(
io
->
d©a
->
ˇŒback
->
˛o£
)

904 
io
->
d©a
->
ˇŒback
->
	`˛o£
(io->data);

905 
	`‰ì
(
io
);

908 
	}
}

910 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_i›lug_›s
 = {

911 .
˛o£
 = 
¢d_pcm_i›lug_˛o£
,

912 .
	gn⁄block
 = 
¢d_pcm_i›lug_n⁄block
,

913 .
	gasync
 = 
¢d_pcm_i›lug_async
,

914 .
	göfo
 = 
¢d_pcm_i›lug_öfo
,

915 .
	ghw_ªföe
 = 
¢d_pcm_i›lug_hw_ªföe
,

916 .
	ghw_∑øms
 = 
¢d_pcm_i›lug_hw_∑øms
,

917 .
	ghw_‰ì
 = 
¢d_pcm_i›lug_hw_‰ì
,

918 .
	gsw_∑øms
 = 
¢d_pcm_i›lug_sw_∑øms
,

919 .
	gch™√l_öfo
 = 
¢d_pcm_i›lug_ch™√l_öfo
,

920 .
	gdump
 = 
¢d_pcm_i›lug_dump
,

921 .
	gmm≠
 = 
¢d_pcm_i›lug_mm≠
,

922 .
	gmunm≠
 = 
¢d_pcm_i›lug_munm≠
,

923 .
	gquîy_chm≠s
 = 
¢d_pcm_i›lug_quîy_chm≠s
,

924 .
	ggë_chm≠
 = 
¢d_pcm_i›lug_gë_chm≠
,

925 .
	g£t_chm≠
 = 
¢d_pcm_i›lug_£t_chm≠
,

928 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_i›lug_Á°_›s
 = {

929 .
°©us
 = 
¢d_pcm_i›lug_°©us
,

930 .
	g¥ï¨e
 = 
¢d_pcm_i›lug_¥ï¨e
,

931 .
	gª£t
 = 
¢d_pcm_i›lug_ª£t
,

932 .
	g°¨t
 = 
¢d_pcm_i›lug_°¨t
,

933 .
	gdr›
 = 
¢d_pcm_i›lug_dr›
,

934 .
	gdøö
 = 
¢d_pcm_i›lug_døö
,

935 .
	g∑u£
 = 
¢d_pcm_i›lug_∑u£
,

936 .
	g°©e
 = 
¢d_pcm_i›lug_°©e
,

937 .
	ghwsync
 = 
¢d_pcm_i›lug_hwsync
,

938 .
	gdñay
 = 
¢d_pcm_i›lug_dñay
,

939 .
	gªsume
 = 
¢d_pcm_i›lug_ªsume
,

940 .
	glök
 = 
NULL
,

941 .
	glök_¶aves
 = 
NULL
,

942 .
	gu∆ök
 = 
NULL
,

943 .
	gªwödabÀ
 = 
¢d_pcm_i›lug_ªwödabÀ
,

944 .
	gªwöd
 = 
¢d_pcm_i›lug_ªwöd
,

945 .
	gf‹w¨dabÀ
 = 
¢d_pcm_i›lug_f‹w¨dabÀ
,

946 .
	gf‹w¨d
 = 
¢d_pcm_i›lug_f‹w¨d
,

947 .
	gwrôei
 = 
¢d_pcm_i›lug_wrôei
,

948 .
	gwrôí
 = 
¢d_pcm_i›lug_wrôí
,

949 .
	gªadi
 = 
¢d_pcm_i›lug_ªadi
,

950 .
	gªadn
 = 
¢d_pcm_i›lug_ªadn
,

951 .
	gavaû_upd©e
 = 
¢d_pcm_i›lug_avaû_upd©e
,

952 .
	gmm≠_commô
 = 
¢d_pcm_i›lug_mm≠_commô
,

953 .
	ghtime°amp
 = 
¢d_pcm_gíîic_ªÆ_htime°amp
,

954 .
	gpﬁl_des¸ùt‹s_cou¡
 = 
¢d_pcm_i›lug_pﬁl_des¸ùt‹s_cou¡
,

955 .
	gpﬁl_des¸ùt‹s
 = 
¢d_pcm_i›lug_pﬁl_des¸ùt‹s
,

956 .
	gpﬁl_ªvíts
 = 
¢d_pcm_i›lug_pﬁl_ªvíts
,

957 .
	gmm≠_begö
 = 
¢d_pcm_i›lug_mm≠_begö
,

1074 
	$¢d_pcm_i›lug_¸óã
(
¢d_pcm_i›lug_t
 *
i›lug
, c⁄° *
«me
,

1075 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

1077 
i›lug_¥iv_t
 *
io
;

1078 
îr
;

1079 
¢d_pcm_t
 *
pcm
;

1081 
	`as£π
(
i›lug
 && i›lug->
ˇŒback
);

1082 
	`as£π
(
i›lug
->
ˇŒback
->
°¨t
 &&

1083 
i›lug
->
ˇŒback
->
°›
 &&

1084 
i›lug
->
ˇŒback
->
poöãr
);

1087 i‡(
i›lug
->
vîsi⁄
 < 0x010000 ||

1088 
i›lug
->
vîsi⁄
 > 
SND_PCM_IOPLUG_VERSION
) {

1089 
	`SNDERR
("ioplug: Plugin version mismatch: 0x%x",

1090 
i›lug
->
vîsi⁄
);

1091  -
ENXIO
;

1094 
io
 = 
	`ˇŒoc
(1, (*io));

1095 i‡(! 
io
)

1096  -
ENOMEM
;

1098 
io
->
d©a
 = 
i›lug
;

1099 
i›lug
->
°©e
 = 
SND_PCM_STATE_OPEN
;

1100 
i›lug
->
°ªam
 = stream;

1102 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_IOPLUG
, 
«me
, 
°ªam
, 
mode
);

1103 i‡(
îr
 < 0) {

1104 
	`‰ì
(
io
);

1105  
îr
;

1108 
i›lug
->
pcm
 =Öcm;

1109 
pcm
->
›s
 = &
¢d_pcm_i›lug_›s
;

1110 
pcm
->
Á°_›s
 = &
¢d_pcm_i›lug_Á°_›s
;

1111 
pcm
->
¥iv©e_d©a
 = 
io
;

1113 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
i›lug
->
hw_±r
, -1, 0);

1114 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
i›lug
->
≠∂_±r
, -1, 0);

1116 
	`¢d_pcm_i›lug_ªöô_°©us
(
i›lug
);

1119 
	}
}

1126 
	$¢d_pcm_i›lug_dñëe
(
¢d_pcm_i›lug_t
 *
i›lug
)

1128  
	`¢d_pcm_˛o£
(
i›lug
->
pcm
);

1129 
	}
}

1138 
	$¢d_pcm_i›lug_∑øms_ª£t
(
¢d_pcm_i›lug_t
 *
i›lug
)

1140 
i›lug_¥iv_t
 *
io
 = 
i›lug
->
pcm
->
¥iv©e_d©a
;

1141 
	`˛ór_io_∑øms
(
io
);

1142 
	}
}

1155 
	$¢d_pcm_i›lug_£t_∑øm_li°
(
¢d_pcm_i›lug_t
 *
i›lug
, 
ty≥
, 
num_li°
, c⁄° *
li°
)

1157 
i›lug_¥iv_t
 *
io
 = 
i›lug
->
pcm
->
¥iv©e_d©a
;

1158 i‡(
ty≥
 < 0 ||Åy≥ >
SND_PCM_IOPLUG_HW_PARAMS
) {

1159 
	`SNDERR
("IOPLUG: invÆidÖ¨amëîÅy≥ %d", 
ty≥
);

1160  -
EINVAL
;

1162 i‡(
ty≥
 =
SND_PCM_IOPLUG_HW_PERIODS
)

1163 
io
->
∑øms
[
ty≥
].
öãgî
 = 1;

1164  
	`¢d_ext_∑rm_£t_li°
(&
io
->
∑øms
[
ty≥
], 
num_li°
, 
li°
);

1165 
	}
}

1179 
	$¢d_pcm_i›lug_£t_∑øm_mömax
(
¢d_pcm_i›lug_t
 *
i›lug
, 
ty≥
, 
mö
, 
max
)

1181 
i›lug_¥iv_t
 *
io
 = 
i›lug
->
pcm
->
¥iv©e_d©a
;

1182 i‡(
ty≥
 < 0 ||Åy≥ >
SND_PCM_IOPLUG_HW_PARAMS
) {

1183 
	`SNDERR
("IOPLUG: invÆidÖ¨amëîÅy≥ %d", 
ty≥
);

1184  -
EINVAL
;

1186 i‡(
ty≥
 =
SND_PCM_IOPLUG_HW_ACCESS
 ||Åy≥ =
SND_PCM_IOPLUG_HW_FORMAT
) {

1187 
	`SNDERR
("IOPLUG: invÆidÖ¨amëîÅy≥ %d", 
ty≥
);

1188  -
EINVAL
;

1190 i‡(
ty≥
 =
SND_PCM_IOPLUG_HW_PERIODS
)

1191 
io
->
∑øms
[
ty≥
].
öãgî
 = 1;

1192  
	`¢d_ext_∑rm_£t_mömax
(&
io
->
∑øms
[
ty≥
], 
mö
, 
max
);

1193 
	}
}

1204 
	$¢d_pcm_i›lug_ªöô_°©us
(
¢d_pcm_i›lug_t
 *
i›lug
)

1206 
i›lug
->
pcm
->
pﬁl_fd
 = ioplug->poll_fd;

1207 
i›lug
->
pcm
->
pﬁl_evíts
 = ioplug->poll_events;

1208 i‡(
i›lug
->
Êags
 & 
SND_PCM_IOPLUG_FLAG_MONOTONIC
)

1209 
i›lug
->
pcm
->
t°amp_ty≥
 = 
SND_PCM_TSTAMP_TYPE_MONOTONIC
;

1211 
i›lug
->
pcm
->
t°amp_ty≥
 = 
SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY
;

1212 
i›lug
->
pcm
->
mm≠_rw
 = ioplug->mmap_rw;

1214 
	}
}

1224 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
	$¢d_pcm_i›lug_mm≠_¨ós
(
¢d_pcm_i›lug_t
 *
i›lug
)

1226 i‡(
i›lug
->
mm≠_rw
)

1227  
	`¢d_pcm_mm≠_¨ós
(
i›lug
->
pcm
);

1228  
NULL
;

1229 
	}
}

1241 
	$¢d_pcm_i›lug_£t_°©e
(
¢d_pcm_i›lug_t
 *
i›lug
, 
¢d_pcm_°©e_t
 
°©e
)

1243 
i›lug
->
°©e
 = state;

1245 
	}
}

1255 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_i›lug_avaû
(c⁄° 
¢d_pcm_i›lug_t
 * c⁄° 
i›lug
,

1256 c⁄° 
¢d_pcm_u‰ames_t
 
hw_±r
,

1257 c⁄° 
¢d_pcm_u‰ames_t
 
≠∂_±r
)

1259  
	`__¢d_pcm_avaû
(
i›lug
->
pcm
, 
hw_±r
, 
≠∂_±r
);

1260 
	}
}

1270 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_i›lug_hw_avaû
(c⁄° 
¢d_pcm_i›lug_t
 * c⁄° 
i›lug
,

1271 c⁄° 
¢d_pcm_u‰ames_t
 
hw_±r
,

1272 c⁄° 
¢d_pcm_u‰ames_t
 
≠∂_±r
)

1277 c⁄° 
¢d_pcm_u‰ames_t
 
u£r_avaû
 = 
	`¢d_pcm_i›lug_avaû
(
i›lug
,

1278 
hw_±r
,

1279 
≠∂_±r
);

1281 i‡(
u£r_avaû
 > 
i›lug
->
pcm
->
buf„r_size
) {

1286  
i›lug
->
pcm
->
buf„r_size
 - 
u£r_avaû
;

1287 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_ladspa.c

35 
	~"pcm_loˇl.h
"

36 
	~"pcm_∂ugö.h
"

37 
	~<dúít.h
>

38 
	~<loˇÀ.h
>

39 
	~<m©h.h
>

41 
	~"œd•a.h
"

43 #i‚de‡
PIC


45 c⁄° *
	g_¢d_moduÀ_pcm_œd•a
 = "";

48 #i‚de‡
DOC_HIDDEN


50 
	#NO_ASSIGN
 0xffffffff

	)

52 
	e_¢d_pcm_œd•a_pﬁicy
 {

53 
	mSND_PCM_LADSPA_POLICY_NONE
,

54 
	mSND_PCM_LADSPA_POLICY_DUPLICATE


55 } 
	t¢d_pcm_œd•a_pﬁicy_t
;

59 
¢d_pcm_∂ugö_t
 
	m∂ug
;

61 
li°_hód
 
	mµlugös
;

62 
li°_hód
 
	m˝lugös
;

63 
	mch™√ls
;

64 
	mÆloˇãd
;

65 
LADSPA_D©a
 *
	mzîo
[2];

66 } 
	t¢d_pcm_œd•a_t
;

69 
	msize
;

70 *
	m¨øy
;

71 } 
	t¢d_pcm_œd•a_¨øy_t
;

74 
¢d_pcm_œd•a_¨øy_t
 
	mch™√ls
;

75 
¢d_pcm_œd•a_¨øy_t
 
	mp‹ts
;

76 
LADSPA_D©a
 **
	mm_d©a
;

77 
LADSPA_D©a
 **
	md©a
;

78 } 
	t¢d_pcm_œd•a_ïs_t
;

80 
	s¢d_pcm_œd•a_ö°™˚
 {

81 
li°_hód
 
	mli°
;

82 c⁄° 
LADSPA_Des¸ùt‹
 *
	mdesc
;

83 
LADSPA_H™dÀ
 *
	mh™dÀ
;

84 
	mdïth
;

85 
¢d_pcm_œd•a_ïs_t
 
	möput
;

86 
¢d_pcm_œd•a_ïs_t
 
	mouçut
;

87 
¢d_pcm_œd•a_ö°™˚
 *
	m¥ev
;

88 
¢d_pcm_œd•a_ö°™˚
 *
	m√xt
;

89 } 
	t¢d_pcm_œd•a_ö°™˚_t
;

92 
LADSPA_P‹tDes¸ùt‹
 
	mpdesc
;

93 
	mp‹t_bödögs_size
;

94 *
	mp‹t_bödögs
;

95 
	mc⁄åﬁs_size
;

96 *
	mc⁄åﬁs_öôülized
;

97 
LADSPA_D©a
 *
	mc⁄åﬁs
;

98 } 
	t¢d_pcm_œd•a_∂ugö_io_t
;

101 
li°_hód
 
	mli°
;

102 
¢d_pcm_œd•a_pﬁicy_t
 
	mpﬁicy
;

103 *
	mfûíame
;

104 *
	mdl_h™dÀ
;

105 c⁄° 
LADSPA_Des¸ùt‹
 *
	mdesc
;

106 
¢d_pcm_œd•a_∂ugö_io_t
 
	möput
;

107 
¢d_pcm_œd•a_∂ugö_io_t
 
	mouçut
;

108 
li°_hód
 
	mö°™˚s
;

109 } 
	t¢d_pcm_œd•a_∂ugö_t
;

113 
	$¢d_pcm_œd•a_cou¡_p‹ts
(
¢d_pcm_œd•a_∂ugö_t
 *
Õlug
,

114 
LADSPA_P‹tDes¸ùt‹
 
pdesc
)

116 
ªs
 = 0, 
idx
;

117 
idx
 = 0; idx < 
Õlug
->
desc
->
P‹tCou¡
; idx++) {

118 i‡((
Õlug
->
desc
->
P‹tDes¸ùt‹s
[
idx
] & 
pdesc
) ==Ödesc)

119 
ªs
++;

121  
ªs
;

122 
	}
}

124 
	$¢d_pcm_œd•a_föd_p‹t
(*
ªs
,

125 
¢d_pcm_œd•a_∂ugö_t
 *
Õlug
,

126 
LADSPA_P‹tDes¸ùt‹
 
pdesc
,

127 
p‹t_idx
)

129 
idx
;

131 
idx
 = 0; idx < 
Õlug
->
desc
->
P‹tCou¡
; idx++)

132 i‡((
Õlug
->
desc
->
P‹tDes¸ùt‹s
[
idx
] & 
pdesc
) ==Ödesc) {

133 i‡(
p‹t_idx
 == 0) {

134 *
ªs
 = 
idx
;

137 
p‹t_idx
--;

139  -
EINVAL
;

140 
	}
}

142 
	$¢d_pcm_œd•a_föd_•‹t
(*
ªs
,

143 
¢d_pcm_œd•a_∂ugö_t
 *
Õlug
,

144 
LADSPA_P‹tDes¸ùt‹
 
pdesc
,

145 c⁄° *
p‹t_«me
)

147 
idx
;

149 
idx
 = 0; idx < 
Õlug
->
desc
->
P‹tCou¡
; idx++)

150 i‡((
Õlug
->
desc
->
P‹tDes¸ùt‹s
[
idx
] & 
pdesc
) ==Ödesc &&

151 !
	`°rcmp
(
Õlug
->
desc
->
P‹tNames
[
idx
], 
p‹t_«me
)) {

152 *
ªs
 = 
idx
;

155  -
EINVAL
;

156 
	}
}

158 
	$¢d_pcm_œd•a_föd_p‹t_idx
(*
ªs
,

159 
¢d_pcm_œd•a_∂ugö_t
 *
Õlug
,

160 
LADSPA_P‹tDes¸ùt‹
 
pdesc
,

161 
p‹t
)

163 
idx
;

164 
r
 = 0;

166 i‡(
p‹t
 >
Õlug
->
desc
->
P‹tCou¡
)

167  -
EINVAL
;

168 
idx
 = 0; idx < 
p‹t
; idx++)

169 i‡((
Õlug
->
desc
->
P‹tDes¸ùt‹s
[
idx
] & 
pdesc
) ==Ödesc)

170 
r
++;

171 *
ªs
 = 
r
;

173 
	}
}

175 
	$¢d_pcm_œd•a_‰ì_io
(
¢d_pcm_œd•a_∂ugö_io_t
 *
io
)

177 
	`‰ì
(
io
->
c⁄åﬁs
);

178 
	`‰ì
(
io
->
c⁄åﬁs_öôülized
);

179 
	}
}

181 
	$¢d_pcm_œd•a_‰ì_∂ugös
(
li°_hód
 *
∂ugös
)

183 !
	`li°_em±y
(
∂ugös
)) {

184 
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
 = 
	`li°_íåy
(
∂ugös
->
√xt
, snd_pcm_œd•a_∂ugö_t, 
li°
);

185 
	`¢d_pcm_œd•a_‰ì_io
(&
∂ugö
->
öput
);

186 
	`¢d_pcm_œd•a_‰ì_io
(&
∂ugö
->
ouçut
);

187 i‡(
∂ugö
->
dl_h™dÀ
)

188 
	`dl˛o£
(
∂ugö
->
dl_h™dÀ
);

189 
	`‰ì
(
∂ugö
->
fûíame
);

190 
	`li°_dñ
(&
∂ugö
->
li°
);

191 
	`‰ì
(
∂ugö
);

193 
	}
}

195 
	$¢d_pcm_œd•a_‰ì
(
¢d_pcm_œd•a_t
 *
œd•a
)

197 
idx
;

199 
	`¢d_pcm_œd•a_‰ì_∂ugös
(&
œd•a
->
µlugös
);

200 
	`¢d_pcm_œd•a_‰ì_∂ugös
(&
œd•a
->
˝lugös
);

201 
idx
 = 0; idx < 2; idx++) {

202 
	`‰ì
(
œd•a
->
zîo
[
idx
]);

203 
œd•a
->
zîo
[
idx
] = 
NULL
;

205 
œd•a
->
Æloˇãd
 = 0;

206 
	}
}

208 
	$¢d_pcm_œd•a_˛o£
(
¢d_pcm_t
 *
pcm
)

210 
¢d_pcm_œd•a_t
 *
œd•a
 = 
pcm
->
¥iv©e_d©a
;

212 
	`¢d_pcm_œd•a_‰ì
(
œd•a
);

213  
	`¢d_pcm_gíîic_˛o£
(
pcm
);

214 
	}
}

216 
	$¢d_pcm_œd•a_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

218 
¢d_pcm_œd•a_t
 *
œd•a
 = 
pcm
->
¥iv©e_d©a
;

219 
îr
;

220 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
 = { 
SND_PCM_ACCBIT_SHMN
 };

221 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

222 &
ac˚ss_mask
);

223 i‡(
îr
 < 0)

224  
îr
;

225 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
∑øms
, 
SND_PCM_FORMAT_FLOAT
);

226 i‡(
îr
 < 0)

227  
îr
;

228 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
∑øms
, 
SND_PCM_SUBFORMAT_STD
);

229 i‡(
îr
 < 0)

230  
îr
;

231 i‡(
œd•a
->
ch™√ls
 > 0 && 
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

232 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t
(
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
œd•a
->
ch™√ls
, 0);

233 i‡(
îr
 < 0)

234  
îr
;

236 
∑øms
->
öfo
 &~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

238 
	}
}

240 
	$¢d_pcm_œd•a_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

242 
¢d_pcm_œd•a_t
 *
œd•a
 = 
pcm
->
¥iv©e_d©a
;

243 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAPN
 };

244 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

245 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

246 &
ßc˚ss_mask
);

247 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
•¨ams
, 
SND_PCM_FORMAT_FLOAT
);

248 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
•¨ams
, 
SND_PCM_SUBFORMAT_STD
);

249 i‡(
œd•a
->
ch™√ls
 > 0 && 
pcm
->
°ªam
 =
SND_PCM_STREAM_CAPTURE
)

250 
	`_¢d_pcm_hw_∑øm_£t
(
•¨ams
, 
SND_PCM_HW_PARAM_CHANNELS
, 
œd•a
->
ch™√ls
, 0);

252 
	}
}

254 
	$¢d_pcm_œd•a_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

255 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

257 
îr
;

258 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

259 
SND_PCM_HW_PARBIT_RATE
 |

260 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

261 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

262 
SND_PCM_HW_PARBIT_PERIODS
 |

263 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

264 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

265 
SND_PCM_HW_PARBIT_TICK_TIME
);

266 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

267 i‡(
îr
 < 0)

268  
îr
;

270 
	}
}

272 
	$¢d_pcm_œd•a_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

273 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

275 
îr
;

276 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

277 
SND_PCM_HW_PARBIT_RATE
 |

278 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

279 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

280 
SND_PCM_HW_PARBIT_PERIODS
 |

281 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

282 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

283 
SND_PCM_HW_PARBIT_TICK_TIME
);

284 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

285 i‡(
îr
 < 0)

286  
îr
;

288 
	}
}

290 
	$¢d_pcm_œd•a_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

292  
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

293 
¢d_pcm_œd•a_hw_ªföe_˝ª∑ª
,

294 
¢d_pcm_œd•a_hw_ªföe_cch™ge
,

295 
¢d_pcm_œd•a_hw_ªföe_•ª∑ª
,

296 
¢d_pcm_œd•a_hw_ªföe_sch™ge
,

297 
¢d_pcm_gíîic_hw_ªföe
);

298 
	}
}

300 
	$¢d_pcm_œd•a_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 * 
∑øms
)

303 
îr
 = 
	`¢d_pcm_hw_∑øms_¶ave
(
pcm
, 
∑øms
,

304 
¢d_pcm_œd•a_hw_ªföe_cch™ge
,

305 
¢d_pcm_œd•a_hw_ªföe_•ª∑ª
,

306 
¢d_pcm_œd•a_hw_ªföe_sch™ge
,

307 
¢d_pcm_gíîic_hw_∑øms
);

308 i‡(
îr
 < 0)

309  
îr
;

311 
	}
}

313 
	$¢d_pcm_œd•a_‰ì_ïs
(
¢d_pcm_œd•a_ïs_t
 *
ïs
)

315 
	`‰ì
(
ïs
->
ch™√ls
.
¨øy
);

316 
	`‰ì
(
ïs
->
p‹ts
.
¨øy
);

317 
	}
}

319 
	$¢d_pcm_œd•a_‰ì_ö°™˚s
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_œd•a_t
 *
œd•a
, 
˛ónup
)

321 
li°_hód
 *
li°
, *
pos
, *
pos1
, *
√xt1
;

322 
idx
;

324 
li°
 = 
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
 ? &
œd•a
->
µlugös
 : &œd•a->
˝lugös
;

325 
	`li°_f‹_óch
(
pos
, 
li°
) {

326 
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
 = 
	`li°_íåy
(
pos
, snd_pcm_œd•a_∂ugö_t, 
li°
);

327 
	`li°_f‹_óch_ß„
(
pos1
, 
√xt1
, &
∂ugö
->
ö°™˚s
) {

328 
¢d_pcm_œd•a_ö°™˚_t
 *
ö°™˚
 = 
	`li°_íåy
(
pos1
, snd_pcm_œd•a_ö°™˚_t, 
li°
);

329 i‡(
∂ugö
->
desc
->
dó˘iv©e
)

330 
∂ugö
->
desc
->
	`dó˘iv©e
(
ö°™˚
->
h™dÀ
);

331 i‡(
˛ónup
) {

332 i‡(
∂ugö
->
desc
->
˛ónup
)

333 
∂ugö
->
desc
->
	`˛ónup
(
ö°™˚
->
h™dÀ
);

334 i‡(
ö°™˚
->
öput
.
m_d©a
) {

335 
idx
 = 0; idx < 
ö°™˚
->
öput
.
ch™√ls
.
size
; idx++)

336 
	`‰ì
(
ö°™˚
->
öput
.
m_d©a
[
idx
]);

337 
	`‰ì
(
ö°™˚
->
öput
.
m_d©a
);

339 i‡(
ö°™˚
->
ouçut
.
m_d©a
) {

340 
idx
 = 0; idx < 
ö°™˚
->
ouçut
.
ch™√ls
.
size
; idx++)

341 
	`‰ì
(
ö°™˚
->
ouçut
.
m_d©a
[
idx
]);

342 
	`‰ì
(
ö°™˚
->
ouçut
.
m_d©a
);

344 
	`‰ì
(
ö°™˚
->
öput
.
d©a
);

345 
	`‰ì
(
ö°™˚
->
ouçut
.
d©a
);

346 
	`li°_dñ
(&(
ö°™˚
->
li°
));

347 
	`¢d_pcm_œd•a_‰ì_ïs
(&
ö°™˚
->
öput
);

348 
	`¢d_pcm_œd•a_‰ì_ïs
(&
ö°™˚
->
ouçut
);

349 
	`‰ì
(
ö°™˚
);

351 i‡(
∂ugö
->
desc
->
a˘iv©e
)

352 
∂ugö
->
desc
->
	`a˘iv©e
(
ö°™˚
->
h™dÀ
);

355 i‡(
˛ónup
) {

356 
	`as£π
(
	`li°_em±y
(&
∂ugö
->
ö°™˚s
));

359 
	}
}

361 
	$¢d_pcm_œd•a_add_to_ˇºay
(
¢d_pcm_œd•a_¨øy_t
 *
¨øy
,

362 
idx
,

363 
vÆ
)

365 *
«ºay
;

366 
idx1
;

368 i‡(
idx
 >
¨øy
->
size
) {

369 
«ºay
 = 
	`ªÆloc
(
¨øy
->¨øy, (Ë* (
idx
 + 1));

370 i‡(
«ºay
 =
NULL
)

371  -
ENOMEM
;

372 
idx1
 = 
¨øy
->
size
; idx1 < 
idx
; idx1++)

373 
«ºay
[
idx1
] = 
NO_ASSIGN
;

374 
¨øy
->¨øy = 
«ºay
;

375 
¨øy
->
size
 = 
idx
 + 1;

376 
¨øy
->¨øy[
idx
] = 
vÆ
;

379 i‡(
¨øy
->¨øy[
idx
] =
NO_ASSIGN
)

380 
¨øy
->¨øy[
idx
] = 
vÆ
;

382  -
EINVAL
;

384 
	}
}

386 
	$¢d_pcm_œd•a_add_to_¨øy
(
¢d_pcm_œd•a_¨øy_t
 *
¨øy
,

387 
idx
,

388 
vÆ
)

390 *
«ºay
;

391 
idx1
;

393 i‡(
idx
 >
¨øy
->
size
) {

394 
«ºay
 = 
	`ªÆloc
(
¨øy
->¨øy, (Ë* (
idx
 + 1));

395 i‡(
«ºay
 =
NULL
)

396  -
ENOMEM
;

397 
idx1
 = 
¨øy
->
size
; idx1 < 
idx
; idx1++)

398 
«ºay
[
idx1
] = 
NO_ASSIGN
;

399 
¨øy
->¨øy = 
«ºay
;

400 
¨øy
->
size
 = 
idx
 + 1;

402 
¨øy
->¨øy[
idx
] = 
vÆ
;

404 
	}
}

406 
	$¢d_pcm_œd•a_c⁄√˘_∂ugö1
(
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
,

407 
¢d_pcm_œd•a_∂ugö_io_t
 *
io
,

408 
¢d_pcm_œd•a_ïs_t
 *
ïs
)

410 
p‹t
, 
ch™√ls
, 
idx
, 
idx1
;

411 
îr
;

413 
	`as£π
(
∂ugö
->
pﬁicy
 =
SND_PCM_LADSPA_POLICY_NONE
);

414 
ch™√ls
 = 
io
->
p‹t_bödögs_size
 > 0 ?

415 
io
->
p‹t_bödögs_size
 :

416 
	`¢d_pcm_œd•a_cou¡_p‹ts
(
∂ugö
, 
io
->
pdesc
 | 
LADSPA_PORT_AUDIO
);

417 
idx
 = 
idx1
 = 0; idx < 
ch™√ls
; idx++) {

418 i‡(
io
->
p‹t_bödögs_size
 > 0)

419 
p‹t
 = 
io
->
p‹t_bödögs
[
idx
];

421 
îr
 = 
	`¢d_pcm_œd•a_föd_p‹t
(&
p‹t
, 
∂ugö
, 
io
->
pdesc
 | 
LADSPA_PORT_AUDIO
, 
idx
);

422 i‡(
îr
 < 0) {

423 
	`SNDERR
("u«bÀÅÿfödáudiÿ%†p‹à%uÖlugö '%s'", 
io
->
pdesc
 & 
LADSPA_PORT_INPUT
 ? "öput" : "ouçut", 
idx
, 
∂ugö
->
desc
->
Name
);

424  
îr
;

427 i‡(
p‹t
 =
NO_ASSIGN
)

429 
îr
 = 
	`¢d_pcm_œd•a_add_to_ˇºay
(&
ïs
->
ch™√ls
, 
idx1
, 
idx
);

430 i‡(
îr
 < 0) {

431 
	`SNDERR
("u«bÀÅÿadd ch™√»%u f‹áudiÿ%†∂ugö '%s'", 
idx
, 
io
->
pdesc
 & 
LADSPA_PORT_INPUT
 ? "öput" : "ouçut", 
∂ugö
->
desc
->
Name
);

432  
îr
;

434 
îr
 = 
	`¢d_pcm_œd•a_add_to_¨øy
(&
ïs
->
p‹ts
, 
idx1
, 
p‹t
);

435 i‡(
îr
 < 0) {

436 
	`SNDERR
("u«bÀÅÿaddÖ‹à%u f‹áudiÿ%†∂ugö '%s'", 
p‹t
, 
io
->
pdesc
 & 
LADSPA_PORT_INPUT
 ? "öput" : "ouçut", 
∂ugö
->
desc
->
Name
);

437  
îr
;

439 
idx1
++;

442 
	}
}

444 
	$¢d_pcm_œd•a_c⁄√˘_∂ugö
(
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
,

445 
¢d_pcm_œd•a_ö°™˚_t
 *
ö°™˚
)

447 
îr
;

449 
îr
 = 
	`¢d_pcm_œd•a_c⁄√˘_∂ugö1
(
∂ugö
, &∂ugö->
öput
, &
ö°™˚
->input);

450 i‡(
îr
 < 0)

451  
îr
;

452 
îr
 = 
	`¢d_pcm_œd•a_c⁄√˘_∂ugö1
(
∂ugö
, &∂ugö->
ouçut
, &
ö°™˚
->output);

453 i‡(
îr
 < 0)

454  
îr
;

456 
	}
}

458 
	$¢d_pcm_œd•a_c⁄√˘_∂ugö_du∂iˇã1
(
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
,

459 
¢d_pcm_œd•a_∂ugö_io_t
 *
io
,

460 
¢d_pcm_œd•a_ïs_t
 *
ïs
,

461 
idx
)

463 
p‹t
;

464 
îr
;

466 
	`as£π
(
∂ugö
->
pﬁicy
 =
SND_PCM_LADSPA_POLICY_DUPLICATE
);

467 i‡(
io
->
p‹t_bödögs_size
 > 0) {

468 
p‹t
 = 
io
->
p‹t_bödögs
[0];

470 
îr
 = 
	`¢d_pcm_œd•a_föd_p‹t
(&
p‹t
, 
∂ugö
, 
io
->
pdesc
 | 
LADSPA_PORT_AUDIO
, 0);

471 i‡(
îr
 < 0) {

472 
	`SNDERR
("u«bÀÅÿfödáudiÿ%†p‹à%uÖlugö '%s'", 
io
->
pdesc
 & 
LADSPA_PORT_INPUT
 ? "öput" : "ouçut", ()0, 
∂ugö
->
desc
->
Name
);

473  
îr
;

476 
îr
 = 
	`¢d_pcm_œd•a_add_to_ˇºay
(&
ïs
->
ch™√ls
, 0, 
idx
);

477 i‡(
îr
 < 0) {

478 
	`SNDERR
("u«bÀÅÿadd ch™√»%u f‹áudiÿ%†∂ugö '%s'", 
idx
, 
io
->
pdesc
 & 
LADSPA_PORT_INPUT
 ? "öput" : "ouçut", 
∂ugö
->
desc
->
Name
);

479  
îr
;

481 
îr
 = 
	`¢d_pcm_œd•a_add_to_¨øy
(&
ïs
->
p‹ts
, 0, 
p‹t
);

482 i‡(
îr
 < 0) {

483 
	`SNDERR
("u«bÀÅÿaddÖ‹à%u f‹áudiÿ%†∂ugö '%s'", 
p‹t
, 
io
->
pdesc
 & 
LADSPA_PORT_INPUT
 ? "öput" : "ouçut", 
∂ugö
->
desc
->
Name
);

484  
îr
;

487 
	}
}

489 
	$¢d_pcm_œd•a_c⁄√˘_∂ugö_du∂iˇã
(
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
,

490 
¢d_pcm_œd•a_∂ugö_io_t
 *
ö_io
,

491 
¢d_pcm_œd•a_∂ugö_io_t
 *
out_io
,

492 
¢d_pcm_œd•a_ö°™˚_t
 *
ö°™˚
,

493 
idx
)

495 
îr
;

497 
îr
 = 
	`¢d_pcm_œd•a_c⁄√˘_∂ugö_du∂iˇã1
(
∂ugö
, 
ö_io
, &
ö°™˚
->
öput
, 
idx
);

498 i‡(
îr
 < 0)

499  
îr
;

500 
îr
 = 
	`¢d_pcm_œd•a_c⁄√˘_∂ugö_du∂iˇã1
(
∂ugö
, 
out_io
, &
ö°™˚
->
ouçut
, 
idx
);

501 i‡(
îr
 < 0)

502  
îr
;

504 
	}
}

506 
	$¢d_pcm_œd•a_gë_deÁu…_cvÆue
(c⁄° 
LADSPA_Des¸ùt‹
 * 
desc
, 
p‹t
, 
LADSPA_D©a
 *
vÆ
)

508 
LADSPA_P‹tR™geHötDes¸ùt‹
 
hdesc
;

510 
hdesc
 = 
desc
->
P‹tR™geHöts
[
p‹t
].
HötDes¸ùt‹
;

511 
hdesc
 & 
LADSPA_HINT_DEFAULT_MASK
) {

512 
LADSPA_HINT_DEFAULT_MINIMUM
:

513 *
vÆ
 = 
desc
->
P‹tR™geHöts
[
p‹t
].
LowîBound
;

515 
LADSPA_HINT_DEFAULT_LOW
:

516 i‡(
	`LADSPA_IS_HINT_LOGARITHMIC
(
hdesc
)) {

517 *
vÆ
 = 
	`exp
(
	`log
(
desc
->
P‹tR™geHöts
[
p‹t
].
LowîBound
)

519 + 
	`log
(
desc
->
P‹tR™geHöts
[
p‹t
].
UµîBound
)

522 *
vÆ
 = (
desc
->
P‹tR™geHöts
[
p‹t
].
LowîBound
 * 0.75) +

523 (
desc
->
P‹tR™geHöts
[
p‹t
].
UµîBound
 * 0.25);

526 
LADSPA_HINT_DEFAULT_MIDDLE
:

527 i‡(
	`LADSPA_IS_HINT_LOGARITHMIC
(
hdesc
)) {

528 *
vÆ
 = 
	`sqπ
(
desc
->
P‹tR™geHöts
[
p‹t
].
LowîBound
 *

529 
desc
->
P‹tR™geHöts
[
p‹t
].
UµîBound
);

531 *
vÆ
 = 0.5 *

532 (
desc
->
P‹tR™geHöts
[
p‹t
].
LowîBound
 +

533 
desc
->
P‹tR™geHöts
[
p‹t
].
UµîBound
);

536 
LADSPA_HINT_DEFAULT_HIGH
:

537 i‡(
	`LADSPA_IS_HINT_LOGARITHMIC
(
hdesc
)) {

538 *
vÆ
 = 
	`exp
(
	`log
(
desc
->
P‹tR™geHöts
[
p‹t
].
LowîBound
)

540 + 
	`log
(
desc
->
P‹tR™geHöts
[
p‹t
].
UµîBound
)

543 *
vÆ
 = (
desc
->
P‹tR™geHöts
[
p‹t
].
LowîBound
 * 0.25) +

544 (
desc
->
P‹tR™geHöts
[
p‹t
].
UµîBound
 * 0.75);

547 
LADSPA_HINT_DEFAULT_MAXIMUM
:

548 *
vÆ
 = 
desc
->
P‹tR™geHöts
[
p‹t
].
UµîBound
;

550 
LADSPA_HINT_DEFAULT_0
:

551 *
vÆ
 = 0;

553 
LADSPA_HINT_DEFAULT_1
:

554 *
vÆ
 = 1;

556 
LADSPA_HINT_DEFAULT_100
:

557 *
vÆ
 = 100;

559 
LADSPA_HINT_DEFAULT_440
:

560 *
vÆ
 = 440;

563 *
vÆ
 = 0;

566 
	}
}

568 
	$¢d_pcm_œd•a_c⁄√˘_c⁄åﬁs
(
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
,

569 
¢d_pcm_œd•a_∂ugö_io_t
 *
io
,

570 
¢d_pcm_œd•a_ö°™˚_t
 *
ö°™˚
)

572 
idx
, 
midx
;

574 
idx
 = 
midx
 = 0; idx < 
∂ugö
->
desc
->
P‹tCou¡
; idx++)

575 i‡((
∂ugö
->
desc
->
P‹tDes¸ùt‹s
[
idx
] & (
io
->
pdesc
 | 
LADSPA_PORT_CONTROL
)) == (io->pdesc | LADSPA_PORT_CONTROL)) {

576 i‡(
io
->
c⁄åﬁs_size
 > 
midx
) {

577 i‡(!
io
->
c⁄åﬁs_öôülized
[
midx
])

578 
	`¢d_pcm_œd•a_gë_deÁu…_cvÆue
(
∂ugö
->
desc
, 
idx
, &
io
->
c⁄åﬁs
[
midx
]);

579 
∂ugö
->
desc
->
	`c⁄√˘_p‹t
(
ö°™˚
->
h™dÀ
, 
idx
, &
io
->
c⁄åﬁs
[
midx
]);

581  -
EINVAL
;

583 
midx
++;

586 
	}
}

588 
	$¢d_pcm_œd•a_check_c⁄√˘
(
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
,

589 
¢d_pcm_œd•a_∂ugö_io_t
 *
io
,

590 
¢d_pcm_œd•a_ïs_t
 *
ïs
,

591 
dïth
)

593 
idx
, 
midx
;

594 
îr
 = 0;

596 
idx
 = 
midx
 = 0; idx < 
∂ugö
->
desc
->
P‹tCou¡
; idx++)

597 i‡((
∂ugö
->
desc
->
P‹tDes¸ùt‹s
[
idx
] & (
io
->
pdesc
 | 
LADSPA_PORT_AUDIO
)) == (io->pdesc | LADSPA_PORT_AUDIO)) {

598 i‡(
ïs
->
ch™√ls
.
¨øy
[
midx
] =
NO_ASSIGN
) {

599 
	`SNDERR
("%†p‹àf‹Ölugö %†dïth %u i†nŸ c⁄√˘ed", 
io
->
pdesc
 & 
LADSPA_PORT_INPUT
 ? "öput" : "ouçut", 
∂ugö
->
desc
->
Name
, 
dïth
);

600 
îr
++;

602 
midx
++;

604 i‡(
îr
 > 0) {

605 
	`SNDERR
("%òc⁄√˘i⁄Éº‹†tŸÆ", 
îr
);

606  -
EINVAL
;

609 
	}
}

611 
	$¢d_pcm_œd•a_Æloˇã_ö°™˚s
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_œd•a_t
 *
œd•a
)

613 
li°_hód
 *
li°
, *
pos
;

614 
dïth
, 
idx
, 
cou¡
;

615 
ö_ch™√ls
;

616 
ö_p‹ts
, 
out_p‹ts
;

617 
¢d_pcm_œd•a_ö°™˚_t
 *
ö°™˚
 = 
NULL
;

618 
îr
;

620 
li°
 = 
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
 ? &
œd•a
->
µlugös
 : &œd•a->
˝lugös
;

621 
ö_ch™√ls
 = 
œd•a
->
ch™√ls
 > 0 ?Üadspa->channels :

622 (
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
 ?Öcm->
ch™√ls
 : 
œd•a
->
∂ug
.
gí
.
¶ave
->channels);

623 
dïth
 = 0;

624 
	`li°_f‹_óch
(
pos
, 
li°
) {

625 
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
 = 
	`li°_íåy
(
pos
, snd_pcm_œd•a_∂ugö_t, 
li°
);

626 
ö_p‹ts
 = 
	`¢d_pcm_œd•a_cou¡_p‹ts
(
∂ugö
, 
LADSPA_PORT_INPUT
 | 
LADSPA_PORT_AUDIO
);

627 
out_p‹ts
 = 
	`¢d_pcm_œd•a_cou¡_p‹ts
(
∂ugö
, 
LADSPA_PORT_OUTPUT
 | 
LADSPA_PORT_AUDIO
);

628 
cou¡
 = 1;

629 i‡(
∂ugö
->
pﬁicy
 =
SND_PCM_LADSPA_POLICY_DUPLICATE
) {

630 i‡(
ö_p‹ts
 =1 && 
out_p‹ts
 == 1)

631 
cou¡
 = 
ö_ch™√ls
;

633 
∂ugö
->
pﬁicy
 = 
SND_PCM_LADSPA_POLICY_NONE
;

635 
idx
 = 0; idx < 
cou¡
; idx++) {

636 
ö°™˚
 = (
¢d_pcm_œd•a_ö°™˚_t
 *)
	`ˇŒoc
(1, (snd_pcm_ladspa_instance_t));

637 i‡(
ö°™˚
 =
NULL
)

638  -
ENOMEM
;

639 
ö°™˚
->
desc
 = 
∂ugö
->desc;

640 
ö°™˚
->
h™dÀ
 = 
∂ugö
->
desc
->
	`ö°™tüã
’lugö->desc, 
pcm
->
øã
);

641 
ö°™˚
->
dïth
 = depth;

642 i‡(
ö°™˚
->
h™dÀ
 =
NULL
) {

643 
	`SNDERR
("U«bÀÅÿ¸óã in°™˚ o‡LADSPAÖlugö '%s'", 
∂ugö
->
desc
->
Name
);

644 
	`‰ì
(
ö°™˚
);

645  -
EINVAL
;

647 
	`li°_add_èû
(&
ö°™˚
->
li°
, &
∂ugö
->
ö°™˚s
);

648 i‡(
∂ugö
->
pﬁicy
 =
SND_PCM_LADSPA_POLICY_DUPLICATE
) {

649 
îr
 = 
	`¢d_pcm_œd•a_c⁄√˘_∂ugö_du∂iˇã
(
∂ugö
, &∂ugö->
öput
, &∂ugö->
ouçut
, 
ö°™˚
, 
idx
);

650 i‡(
îr
 < 0) {

651 
	`SNDERR
("U«bÀÅÿc⁄√˘ du∂iˇãÖ‹ào‡∂ugö '%s' ch™√»%u dïth %u", 
∂ugö
->
desc
->
Name
, 
idx
, 
ö°™˚
->
dïth
);

652  
îr
;

655 
îr
 = 
	`¢d_pcm_œd•a_c⁄√˘_∂ugö
(
∂ugö
, 
ö°™˚
);

656 i‡(
îr
 < 0) {

657 
	`SNDERR
("U«bÀÅÿc⁄√˘Ölugö '%s' dïth %u", 
∂ugö
->
desc
->
Name
, 
dïth
);

658  
îr
;

661 
îr
 = 
	`¢d_pcm_œd•a_c⁄√˘_c⁄åﬁs
(
∂ugö
, &∂ugö->
öput
, 
ö°™˚
);

662 
	`as£π
(
îr
 >= 0);

663 
îr
 = 
	`¢d_pcm_œd•a_c⁄√˘_c⁄åﬁs
(
∂ugö
, &∂ugö->
ouçut
, 
ö°™˚
);

664 
	`as£π
(
îr
 >= 0);

665 i‡(
∂ugö
->
desc
->
a˘iv©e
)

666 
∂ugö
->
desc
->
	`a˘iv©e
(
ö°™˚
->
h™dÀ
);

668 
îr
 = 
	`¢d_pcm_œd•a_check_c⁄√˘
(
∂ugö
, &∂ugö->
öput
, &
ö°™˚
->öput, 
dïth
);

669 i‡(
îr
 < 0)

670  
îr
;

671 
îr
 = 
	`¢d_pcm_œd•a_check_c⁄√˘
(
∂ugö
, &∂ugö->
ouçut
, &
ö°™˚
->ouçut, 
dïth
);

672 i‡(
îr
 < 0)

673  
îr
;

674 
dïth
++;

677 
	}
}

679 
LADSPA_D©a
 *
	$¢d_pcm_œd•a_Æloˇã_zîo
(
¢d_pcm_œd•a_t
 *
œd•a
, 
idx
)

681 i‡(
œd•a
->
zîo
[
idx
] =
NULL
)

682 
œd•a
->
zîo
[
idx
] = 
	`ˇŒoc
÷ad•a->
Æloˇãd
, (
LADSPA_D©a
));

683  
œd•a
->
zîo
[
idx
];

684 
	}
}

686 
	$¢d_pcm_œd•a_Æloˇã_mem‹y
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_œd•a_t
 *
œd•a
)

688 
li°_hód
 *
li°
, *
pos
, *
pos1
;

689 
¢d_pcm_œd•a_ö°™˚_t
 *
ö°™˚
;

690 
ch™√ls
 = 16, 
nch™√ls
;

691 
ich™√ls
, 
och™√ls
;

692 **
pch™√ls
, **
≈ch™√ls
;

693 
idx
, 
chn
;

695 
œd•a
->
Æloˇãd
 = 2048;

696 i‡(
pcm
->
buf„r_size
 > 
œd•a
->
Æloˇãd
)

697 
œd•a
->
Æloˇãd
 = 
pcm
->
buf„r_size
;

698 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

699 
ich™√ls
 = 
pcm
->
ch™√ls
;

700 
och™√ls
 = 
œd•a
->
∂ug
.
gí
.
¶ave
->
ch™√ls
;

702 
ich™√ls
 = 
œd•a
->
∂ug
.
gí
.
¶ave
->
ch™√ls
;

703 
och™√ls
 = 
pcm
->
ch™√ls
;

705 
pch™√ls
 = 
	`ˇŒoc
(1, (*Ë* 
ch™√ls
);

706 i‡(
pch™√ls
 =
NULL
)

707  -
ENOMEM
;

708 
li°
 = 
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
 ? &
œd•a
->
µlugös
 : &œd•a->
˝lugös
;

709 
	`li°_f‹_óch
(
pos
, 
li°
) {

710 
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
 = 
	`li°_íåy
(
pos
, snd_pcm_œd•a_∂ugö_t, 
li°
);

711 
	`li°_f‹_óch
(
pos1
, &
∂ugö
->
ö°™˚s
) {

712 
ö°™˚
 = 
	`li°_íåy
(
pos1
, 
¢d_pcm_œd•a_ö°™˚_t
, 
li°
);

713 
nch™√ls
 = 
ch™√ls
;

714 
idx
 = 0; idx < 
ö°™˚
->
öput
.
ch™√ls
.
size
; idx++) {

715 
chn
 = 
ö°™˚
->
öput
.
ch™√ls
.
¨øy
[
idx
];

716 
	`as£π
(
ö°™˚
->
öput
.
p‹ts
.
¨øy
[
idx
] !
NO_ASSIGN
);

717 i‡(
chn
 >
nch™√ls
)

718 
nch™√ls
 = 
chn
 + 1;

720 
idx
 = 0; idx < 
ö°™˚
->
ouçut
.
ch™√ls
.
size
; idx++) {

721 
chn
 = 
ö°™˚
->
ouçut
.
ch™√ls
.
¨øy
[
idx
];

722 
	`as£π
(
ö°™˚
->
ouçut
.
p‹ts
.
¨øy
[
idx
] !
NO_ASSIGN
);

723 i‡(
chn
 >
nch™√ls
)

724 
nch™√ls
 = 
chn
 + 1;

726 i‡(
nch™√ls
 !
ch™√ls
) {

727 
≈ch™√ls
 = 
	`ªÆloc
(
pch™√ls
, 
nch™√ls
 * (*));

728 i‡(
≈ch™√ls
 =
NULL
) {

729 
	`‰ì
(
pch™√ls
);

730  -
ENOMEM
;

732 
idx
 = 
ch™√ls
; idx < 
nch™√ls
; idx++)

733 
≈ch™√ls
[
idx
] = 
NULL
;

734 
pch™√ls
 = 
≈ch™√ls
;

736 
	`as£π
(
ö°™˚
->
öput
.
d©a
 =
NULL
);

737 
	`as£π
(
ö°™˚
->
öput
.
m_d©a
 =
NULL
);

738 
	`as£π
(
ö°™˚
->
ouçut
.
d©a
 =
NULL
);

739 
	`as£π
(
ö°™˚
->
ouçut
.
m_d©a
 =
NULL
);

740 
ö°™˚
->
öput
.
d©a
 = 
	`ˇŒoc
(ö°™˚->öput.
ch™√ls
.
size
, (*));

741 
ö°™˚
->
öput
.
m_d©a
 = 
	`ˇŒoc
(ö°™˚->öput.
ch™√ls
.
size
, (*));

742 
ö°™˚
->
ouçut
.
d©a
 = 
	`ˇŒoc
(ö°™˚->ouçut.
ch™√ls
.
size
, (*));

743 
ö°™˚
->
ouçut
.
m_d©a
 = 
	`ˇŒoc
(ö°™˚->ouçut.
ch™√ls
.
size
, (*));

744 i‡(
ö°™˚
->
öput
.
d©a
 =
NULL
 ||

745 
ö°™˚
->
öput
.
m_d©a
 =
NULL
 ||

746 
ö°™˚
->
ouçut
.
d©a
 =
NULL
 ||

747 
ö°™˚
->
ouçut
.
m_d©a
 =
NULL
) {

748 
	`‰ì
(
pch™√ls
);

749  -
ENOMEM
;

751 
idx
 = 0; idx < 
ö°™˚
->
öput
.
ch™√ls
.
size
; idx++) {

752 
chn
 = 
ö°™˚
->
öput
.
ch™√ls
.
¨øy
[
idx
];

753 i‡(
pch™√ls
[
chn
] =
NULL
 && ch¿< 
ich™√ls
) {

754 
ö°™˚
->
öput
.
d©a
[
idx
] = 
NULL
;

757 
ö°™˚
->
öput
.
d©a
[
idx
] = 
pch™√ls
[
chn
];

758 i‡(
ö°™˚
->
öput
.
d©a
[
idx
] =
NULL
) {

759 
ö°™˚
->
öput
.
d©a
[
idx
] = 
	`¢d_pcm_œd•a_Æloˇã_zîo
(
œd•a
, 0);

760 i‡(
ö°™˚
->
öput
.
d©a
[
idx
] =
NULL
) {

761 
	`‰ì
(
pch™√ls
);

762  -
ENOMEM
;

766 
idx
 = 0; idx < 
ö°™˚
->
ouçut
.
ch™√ls
.
size
; idx++) {

767 
chn
 = 
ö°™˚
->
ouçut
.
ch™√ls
.
¨øy
[
idx
];

770 
ö°™˚
->
ouçut
.
d©a
[
idx
] = 
	`mÆloc
((
LADSPA_D©a
Ë* 
œd•a
->
Æloˇãd
);

771 i‡(
ö°™˚
->
ouçut
.
d©a
[
idx
] =
NULL
) {

772 
	`‰ì
(
pch™√ls
);

773  -
ENOMEM
;

775 
pch™√ls
[
chn
] = 
ö°™˚
->
ouçut
.
m_d©a
[
idx
] = in°™˚->ouçut.
d©a
[idx];

783 
	`li°_f‹_óch
(
pos
, 
li°
) {

784 
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
 = 
	`li°_íåy
(
pos
, snd_pcm_œd•a_∂ugö_t, 
li°
);

785 
	`li°_f‹_óch
(
pos1
, &
∂ugö
->
ö°™˚s
) {

786 
ö°™˚
 = 
	`li°_íåy
(
pos1
, 
¢d_pcm_œd•a_ö°™˚_t
, 
li°
);

787 
idx
 = 0; idx < 
ö°™˚
->
ouçut
.
ch™√ls
.
size
; idx++) {

788 
chn
 = 
ö°™˚
->
ouçut
.
ch™√ls
.
¨øy
[
idx
];

789 i‡(
ö°™˚
->
ouçut
.
d©a
[
idx
] =
pch™√ls
[
chn
]) {

790 
	`‰ì
(
ö°™˚
->
ouçut
.
m_d©a
[
idx
]);

791 
ö°™˚
->
ouçut
.
m_d©a
[
idx
] = 
NULL
;

792 i‡(
chn
 < 
och™√ls
) {

793 
ö°™˚
->
ouçut
.
d©a
[
idx
] = 
NULL
;

795 
ö°™˚
->
ouçut
.
d©a
[
idx
] = 
	`¢d_pcm_œd•a_Æloˇã_zîo
(
œd•a
, 1);

796 i‡(
ö°™˚
->
ouçut
.
d©a
[
idx
] =
NULL
) {

797 
	`‰ì
(
pch™√ls
);

798  -
ENOMEM
;

806 
	`¥ötf
("zîo[0] = %p\n", 
œd•a
->
zîo
[0]);

807 
	`¥ötf
("zîo[1] = %p\n", 
œd•a
->
zîo
[1]);

808 
	`li°_f‹_óch
(
pos
, 
li°
) {

809 
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
 = 
	`li°_íåy
(
pos
, snd_pcm_œd•a_∂ugö_t, 
li°
);

810 
	`li°_f‹_óch
(
pos1
, &
∂ugö
->
ö°™˚s
) {

811 
ö°™˚
 = 
	`li°_íåy
(
pos1
, 
¢d_pcm_œd•a_ö°™˚_t
, 
li°
);

812 
idx
 = 0; idx < 
ö°™˚
->
öput
.
ch™√ls
.
size
; idx++)

813 
	`¥ötf
("%i:Æloc-öput%i: d©®%p, m_d©®%p\n", 
ö°™˚
->
dïth
, 
idx
, in°™˚->
öput
.
d©a
[idx], in°™˚->öput.
m_d©a
[idx]);

814 
idx
 = 0; idx < 
ö°™˚
->
ouçut
.
ch™√ls
.
size
; idx++)

815 
	`¥ötf
("%i:Æloc-ouçut%i: d©®%p, m_d©®%p\n", 
ö°™˚
->
dïth
, 
idx
, in°™˚->
ouçut
.
d©a
[idx], in°™˚->ouçut.
m_d©a
[idx]);

819 
	`‰ì
(
pch™√ls
);

821 
	}
}

823 
	$¢d_pcm_œd•a_öô
(
¢d_pcm_t
 *
pcm
)

825 
¢d_pcm_œd•a_t
 *
œd•a
 = 
pcm
->
¥iv©e_d©a
;

826 
îr
;

828 
	`¢d_pcm_œd•a_‰ì_ö°™˚s
(
pcm
, 
œd•a
, 1);

829 
îr
 = 
	`¢d_pcm_œd•a_Æloˇã_ö°™˚s
(
pcm
, 
œd•a
);

830 i‡(
îr
 < 0) {

831 
	`¢d_pcm_œd•a_‰ì_ö°™˚s
(
pcm
, 
œd•a
, 1);

832  
îr
;

834 
îr
 = 
	`¢d_pcm_œd•a_Æloˇã_mem‹y
(
pcm
, 
œd•a
);

835 i‡(
îr
 < 0) {

836 
	`¢d_pcm_œd•a_‰ì_ö°™˚s
(
pcm
, 
œd•a
, 1);

837  
îr
;

840 
	}
}

842 
	$¢d_pcm_œd•a_hw_‰ì
(
¢d_pcm_t
 *
pcm
)

844 
¢d_pcm_œd•a_t
 *
œd•a
 = 
pcm
->
¥iv©e_d©a
;

846 
	`¢d_pcm_œd•a_‰ì_ö°™˚s
(
pcm
, 
œd•a
, 1);

847  
	`¢d_pcm_gíîic_hw_‰ì
(
pcm
);

848 
	}
}

850 
¢d_pcm_u‰ames_t


851 
	$¢d_pcm_œd•a_wrôe_¨ós
(
¢d_pcm_t
 *
pcm
,

852 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

853 
¢d_pcm_u‰ames_t
 
off£t
,

854 
¢d_pcm_u‰ames_t
 
size
,

855 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

856 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

857 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

859 
¢d_pcm_œd•a_t
 *
œd•a
 = 
pcm
->
¥iv©e_d©a
;

860 
¢d_pcm_œd•a_ö°™˚_t
 *
ö°™˚
;

861 
li°_hód
 *
pos
, *
pos1
;

862 
LADSPA_D©a
 *
d©a
;

863 
idx
, 
chn
, 
size1
, 
size2
;

865 i‡(
size
 > *
¶ave_sizï
)

866 
size
 = *
¶ave_sizï
;

867 
size2
 = 
size
;

869 
	`¢d_pcm_¨ós_c›y
(
¶ave_¨ós
, 
¶ave_off£t
,

870 
¨ós
, 
off£t
,

871 
pcm
->
ch™√ls
, 
size
,Öcm->
f‹m©
);

873 
size
 > 0) {

874 
size1
 = 
size
;

875 i‡(
size1
 > 
œd•a
->
Æloˇãd
)

876 
size1
 = 
œd•a
->
Æloˇãd
;

877 
	`li°_f‹_óch
(
pos
, &
œd•a
->
µlugös
) {

878 
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
 = 
	`li°_íåy
(
pos
, snd_pcm_œd•a_∂ugö_t, 
li°
);

879 
	`li°_f‹_óch
(
pos1
, &
∂ugö
->
ö°™˚s
) {

880 
ö°™˚
 = 
	`li°_íåy
(
pos1
, 
¢d_pcm_œd•a_ö°™˚_t
, 
li°
);

881 
idx
 = 0; idx < 
ö°™˚
->
öput
.
ch™√ls
.
size
; idx++) {

882 
chn
 = 
ö°™˚
->
öput
.
ch™√ls
.
¨øy
[
idx
];

883 
d©a
 = 
ö°™˚
->
öput
.d©a[
idx
];

884 i‡(
d©a
 =
NULL
) {

885 
d©a
 = (
LADSPA_D©a
 *)((*)
¨ós
[
chn
].
addr
 + (¨ós[chn].
fú°
 / 8));

886 
d©a
 +
off£t
;

888 
ö°™˚
->
desc
->
	`c⁄√˘_p‹t
(ö°™˚->
h™dÀ
, in°™˚->
öput
.
p‹ts
.
¨øy
[
idx
], 
d©a
);

890 
idx
 = 0; idx < 
ö°™˚
->
ouçut
.
ch™√ls
.
size
; idx++) {

891 
chn
 = 
ö°™˚
->
ouçut
.
ch™√ls
.
¨øy
[
idx
];

892 
d©a
 = 
ö°™˚
->
ouçut
.d©a[
idx
];

893 i‡(
d©a
 =
NULL
) {

894 
d©a
 = (
LADSPA_D©a
 *)((*)
¶ave_¨ós
[
chn
].
addr
 + (
¨ós
[chn].
fú°
 / 8));

895 
d©a
 +
¶ave_off£t
;

897 
ö°™˚
->
desc
->
	`c⁄√˘_p‹t
(ö°™˚->
h™dÀ
, in°™˚->
ouçut
.
p‹ts
.
¨øy
[
idx
], 
d©a
);

899 
ö°™˚
->
desc
->
	`run
(ö°™˚->
h™dÀ
, 
size1
);

902 
off£t
 +
size1
;

903 
¶ave_off£t
 +
size1
;

904 
size
 -
size1
;

907 *
¶ave_sizï
 = 
size2
;

908  
size2
;

909 
	}
}

911 
¢d_pcm_u‰ames_t


912 
	$¢d_pcm_œd•a_ªad_¨ós
(
¢d_pcm_t
 *
pcm
,

913 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

914 
¢d_pcm_u‰ames_t
 
off£t
,

915 
¢d_pcm_u‰ames_t
 
size
,

916 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

917 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

918 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

920 
¢d_pcm_œd•a_t
 *
œd•a
 = 
pcm
->
¥iv©e_d©a
;

921 
¢d_pcm_œd•a_ö°™˚_t
 *
ö°™˚
;

922 
li°_hód
 *
pos
, *
pos1
;

923 
LADSPA_D©a
 *
d©a
;

924 
idx
, 
chn
, 
size1
, 
size2
;;

926 i‡(
size
 > *
¶ave_sizï
)

927 
size
 = *
¶ave_sizï
;

928 
size2
 = 
size
;

930 
	`¢d_pcm_¨ós_c›y
(
¨ós
, 
off£t
,

931 
¶ave_¨ós
, 
¶ave_off£t
,

932 
pcm
->
ch™√ls
, 
size
,Öcm->
f‹m©
);

934 
size
 > 0) {

935 
size1
 = 
size
;

936 i‡(
size1
 > 
œd•a
->
Æloˇãd
)

937 
size1
 = 
œd•a
->
Æloˇãd
;

938 
	`li°_f‹_óch
(
pos
, &
œd•a
->
˝lugös
) {

939 
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
 = 
	`li°_íåy
(
pos
, snd_pcm_œd•a_∂ugö_t, 
li°
);

940 
	`li°_f‹_óch
(
pos1
, &
∂ugö
->
ö°™˚s
) {

941 
ö°™˚
 = 
	`li°_íåy
(
pos1
, 
¢d_pcm_œd•a_ö°™˚_t
, 
li°
);

942 
idx
 = 0; idx < 
ö°™˚
->
öput
.
ch™√ls
.
size
; idx++) {

943 
chn
 = 
ö°™˚
->
öput
.
ch™√ls
.
¨øy
[
idx
];

944 
d©a
 = 
ö°™˚
->
öput
.d©a[
idx
];

945 i‡(
d©a
 =
NULL
) {

946 
d©a
 = (
LADSPA_D©a
 *)((*)
¶ave_¨ós
[
chn
].
addr
 + (
¨ós
[chn].
fú°
 / 8));

947 
d©a
 +
¶ave_off£t
;

949 
ö°™˚
->
desc
->
	`c⁄√˘_p‹t
(ö°™˚->
h™dÀ
, in°™˚->
öput
.
p‹ts
.
¨øy
[
idx
], 
d©a
);

951 
idx
 = 0; idx < 
ö°™˚
->
ouçut
.
ch™√ls
.
size
; idx++) {

952 
chn
 = 
ö°™˚
->
ouçut
.
ch™√ls
.
¨øy
[
idx
];

953 
d©a
 = 
ö°™˚
->
ouçut
.d©a[
idx
];

954 i‡(
d©a
 =
NULL
) {

955 
d©a
 = (
LADSPA_D©a
 *)((*)
¨ós
[
chn
].
addr
 + (¨ós[chn].
fú°
 / 8));

956 
d©a
 +
off£t
;

958 
ö°™˚
->
desc
->
	`c⁄√˘_p‹t
(ö°™˚->
h™dÀ
, in°™˚->
ouçut
.
p‹ts
.
¨øy
[
idx
], 
d©a
);

960 
ö°™˚
->
desc
->
	`run
(ö°™˚->
h™dÀ
, 
size1
);

963 
off£t
 +
size1
;

964 
¶ave_off£t
 +
size1
;

965 
size
 -
size1
;

968 *
¶ave_sizï
 = 
size2
;

969  
size2
;

970 
	}
}

972 
	$¢d_pcm_œd•a_dump_dúe˘i⁄
(
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
,

973 
¢d_pcm_œd•a_∂ugö_io_t
 *
io
,

974 
¢d_ouçut_t
 *
out
)

976 
idx
, 
midx
;

978 i‡(
io
->
p‹t_bödögs_size
 == 0)

979 
__c⁄åﬁ
;

980 
	`¢d_ouçut_¥ötf
(
out
, " Audiÿ%†p‹àbödögs:\n", 
io
->
pdesc
 =
LADSPA_PORT_INPUT
 ? "input" : "output");

981 
idx
 = 0; idx < 
io
->
p‹t_bödögs_size
; idx++) {

982 i‡(
io
->
p‹t_bödögs
[
idx
] =
NO_ASSIGN
)

983 
	`¢d_ouçut_¥ötf
(
out
, " %ò-> NONE\n", 
idx
);

985 
	`¢d_ouçut_¥ötf
(
out
, " %ò-> %i\n", 
idx
, 
io
->
p‹t_bödögs
[idx]);

987 
__c⁄åﬁ
:

988 i‡(
io
->
c⁄åﬁs_size
 == 0)

990 
	`¢d_ouçut_¥ötf
(
out
, " C⁄åﬁ %†p‹àöôü»vÆues:\n", 
io
->
pdesc
 =
LADSPA_PORT_INPUT
 ? "input" : "output");

991 
idx
 = 
midx
 = 0; idx < 
∂ugö
->
desc
->
P‹tCou¡
; idx++) {

992 i‡((
∂ugö
->
desc
->
P‹tDes¸ùt‹s
[
idx
] & (
io
->
pdesc
 | 
LADSPA_PORT_CONTROL
)) == (io->pdesc | LADSPA_PORT_CONTROL)) {

993 
	`¢d_ouçut_¥ötf
(
out
, " %ò\"%s\" = %.8f\n", 
idx
, 
∂ugö
->
desc
->
P‹tNames
[idx], 
io
->
c⁄åﬁs
[
midx
]);

994 
midx
++;

997 
	}
}

999 
	$¢d_pcm_œd•a_dump_¨øy
(
¢d_ouçut_t
 *
out
,

1000 
¢d_pcm_œd•a_¨øy_t
 *
¨øy
,

1001 
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
)

1003 
size
 = 
¨øy
->size;

1004 
vÆ
, 
idx
 = 0;

1006 
size
-- > 0) {

1007 i‡(
idx
 > 0) {

1008 
	`¢d_ouçut_putc
(
out
, ',');

1009 
	`¢d_ouçut_putc
(
out
, ' ');

1011 
vÆ
 = 
¨øy
->¨øy[
idx
++];

1012 i‡(
vÆ
 =
NO_ASSIGN
)

1013 
	`¢d_ouçut_putc
(
out
, '-');

1015 
	`¢d_ouçut_¥ötf
(
out
, "%u", 
vÆ
);

1016 i‡(
∂ugö
 && 
vÆ
 !
NO_ASSIGN
)

1017 
	`¢d_ouçut_¥ötf
(
out
, " \"%s\"", 
∂ugö
->
desc
->
P‹tNames
[
vÆ
]);

1019 
	}
}

1021 
	$¢d_pcm_œd•a_∂ugös_dump
(
li°_hód
 *
li°
, 
¢d_ouçut_t
 *
out
)

1023 
li°_hód
 *
pos
, *
pos2
;

1025 
	`li°_f‹_óch
(
pos
, 
li°
) {

1026 
¢d_pcm_œd•a_∂ugö_t
 *
∂ugö
 = 
	`li°_íåy
(
pos
, snd_pcm_œd•a_∂ugö_t, 
li°
);

1027 
	`¢d_ouçut_¥ötf
(
out
, " Pﬁicy: %s\n", 
∂ugö
->
pﬁicy
 =
SND_PCM_LADSPA_POLICY_NONE
 ? "none" : "duplicate");

1028 
	`¢d_ouçut_¥ötf
(
out
, " Fûíame: %s\n", 
∂ugö
->
fûíame
);

1029 
	`¢d_ouçut_¥ötf
(
out
, " Plugö Name: %s\n", 
∂ugö
->
desc
->
Name
);

1030 
	`¢d_ouçut_¥ötf
(
out
, " Plugö Labñ: %s\n", 
∂ugö
->
desc
->
Labñ
);

1031 
	`¢d_ouçut_¥ötf
(
out
, " Plugö UniquêID: %lu\n", 
∂ugö
->
desc
->
UniqueID
);

1032 
	`¢d_ouçut_¥ötf
(
out
, " Instances:\n");

1033 
	`li°_f‹_óch
(
pos2
, &
∂ugö
->
ö°™˚s
) {

1034 
¢d_pcm_œd•a_ö°™˚_t
 *
ö
 = (¢d_pcm_œd•a_ö°™˚_à*Ë
pos2
;

1035 
	`¢d_ouçut_¥ötf
(
out
, " Dïth: %i\n", 
ö
->
dïth
);

1036 
	`¢d_ouçut_¥ötf
(
out
, " InChannels: ");

1037 
	`¢d_pcm_œd•a_dump_¨øy
(
out
, &
ö
->
öput
.
ch™√ls
, 
NULL
);

1038 
	`¢d_ouçut_¥ötf
(
out
, "\n InPorts: ");

1039 
	`¢d_pcm_œd•a_dump_¨øy
(
out
, &
ö
->
öput
.
p‹ts
, 
∂ugö
);

1040 
	`¢d_ouçut_¥ötf
(
out
, "\n OutChannels: ");

1041 
	`¢d_pcm_œd•a_dump_¨øy
(
out
, &
ö
->
ouçut
.
ch™√ls
, 
NULL
);

1042 
	`¢d_ouçut_¥ötf
(
out
, "\n OutPorts: ");

1043 
	`¢d_pcm_œd•a_dump_¨øy
(
out
, &
ö
->
ouçut
.
p‹ts
, 
∂ugö
);

1044 
	`¢d_ouçut_¥ötf
(
out
, "\n");

1046 
	`¢d_pcm_œd•a_dump_dúe˘i⁄
(
∂ugö
, &∂ugö->
öput
, 
out
);

1047 
	`¢d_pcm_œd•a_dump_dúe˘i⁄
(
∂ugö
, &∂ugö->
ouçut
, 
out
);

1049 
	}
}

1051 
	$¢d_pcm_œd•a_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

1053 
¢d_pcm_œd•a_t
 *
œd•a
 = 
pcm
->
¥iv©e_d©a
;

1055 
	`¢d_ouçut_¥ötf
(
out
, "LADSPA PCM\n");

1056 
	`¢d_ouçut_¥ötf
(
out
, " Playback:\n");

1057 
	`¢d_pcm_œd•a_∂ugös_dump
(&
œd•a
->
µlugös
, 
out
);

1058 
	`¢d_ouçut_¥ötf
(
out
, " Capture:\n");

1059 
	`¢d_pcm_œd•a_∂ugös_dump
(&
œd•a
->
˝lugös
, 
out
);

1060 i‡(
pcm
->
£tup
) {

1061 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

1062 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

1064 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

1065 
	`¢d_pcm_dump
(
œd•a
->
∂ug
.
gí
.
¶ave
, 
out
);

1066 
	}
}

1068 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_œd•a_›s
 = {

1069 .
˛o£
 = 
¢d_pcm_œd•a_˛o£
,

1070 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

1071 .
	ghw_ªföe
 = 
¢d_pcm_œd•a_hw_ªföe
,

1072 .
	ghw_∑øms
 = 
¢d_pcm_œd•a_hw_∑øms
,

1073 .
	ghw_‰ì
 = 
¢d_pcm_œd•a_hw_‰ì
,

1074 .
	gsw_∑øms
 = 
¢d_pcm_gíîic_sw_∑øms
,

1075 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

1076 .
	gdump
 = 
¢d_pcm_œd•a_dump
,

1077 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

1078 .
	gasync
 = 
¢d_pcm_gíîic_async
,

1079 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

1080 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

1081 .
	gquîy_chm≠s
 = 
¢d_pcm_gíîic_quîy_chm≠s
,

1082 .
	ggë_chm≠
 = 
¢d_pcm_gíîic_gë_chm≠
,

1083 .
	g£t_chm≠
 = 
¢d_pcm_gíîic_£t_chm≠
,

1086 
	$¢d_pcm_œd•a_check_fûe
(
¢d_pcm_œd•a_∂ugö_t
 * c⁄° 
∂ugö
,

1087 c⁄° *
fûíame
,

1088 c⁄° *
œbñ
,

1089 c⁄° 
œd•a_id
)

1091 *
h™dÀ
;

1093 
	`as£π
(
fûíame
);

1094 
h™dÀ
 = 
	`dl›í
(
fûíame
, 
RTLD_LAZY
);

1095 i‡(
h™dÀ
) {

1096 
LADSPA_Des¸ùt‹_Fun˘i⁄
 
f˙
 = (LADSPA_Des¸ùt‹_Fun˘i⁄)
	`dlsym
(
h™dÀ
, "ladspa_descriptor");

1097 i‡(
f˙
) {

1098 
idx
;

1099 c⁄° 
LADSPA_Des¸ùt‹
 *
d
;

1100 
idx
 = 0; (
d
 = 
	`f˙
(idx)Ë!
NULL
; idx++) {

1105 i‡(
	`°rcmp
(
œbñ
, 
d
->
Labñ
))

1108 *
œbñloˇÀ
;

1109 
lc⁄v
 *
lc
;

1110 i‡(
œbñ
 !
NULL
) {

1111 
lc
 = 
	`loˇÀc⁄v
 ();

1112 
œbñloˇÀ
 = 
	`mÆloc
 (
	`°æí
 (
œbñ
) + 1);

1113 i‡(
œbñloˇÀ
 =
NULL
) {

1114 
	`dl˛o£
(
h™dÀ
);

1115  -
ENOMEM
;

1117 
	`°r˝y
 (
œbñloˇÀ
, 
œbñ
);

1118 i‡(
	`°ºchr
(
œbñloˇÀ
, '.'))

1119 *
	`°ºchr
 (
œbñloˇÀ
, '.'Ë*
lc
->
decimÆ_poöt
;

1120 i‡(
	`°rcmp
(
œbñ
, 
d
->
Labñ
Ë&& såcmp(
œbñloˇÀ
, d->Label)) {

1121 
	`‰ì
(
œbñloˇÀ
);

1124 
	`‰ì
 (
œbñloˇÀ
);

1127 i‡(
œd•a_id
 > 0 && 
d
->
UniqueID
 !=Üadspa_id)

1129 
∂ugö
->
fûíame
 = 
	`°rdup
(filename);

1130 i‡(
∂ugö
->
fûíame
 =
NULL
) {

1131 
	`dl˛o£
(
h™dÀ
);

1132  -
ENOMEM
;

1134 
∂ugö
->
dl_h™dÀ
 = 
h™dÀ
;

1135 
∂ugö
->
desc
 = 
d
;

1139 
	`dl˛o£
(
h™dÀ
);

1141  -
ENOENT
;

1142 
	}
}

1144 
	$¢d_pcm_œd•a_check_dú
(
¢d_pcm_œd•a_∂ugö_t
 * c⁄° 
∂ugö
,

1145 c⁄° *
∑th
,

1146 c⁄° *
œbñ
,

1147 c⁄° 
œd•a_id
)

1149 
DIR
 *
dú
;

1150 
dúít64
 * 
dúít
;

1151 
Àn
 = 
	`°æí
(
∑th
), 
îr
;

1152 
√ed_¶ash
;

1153 *
fûíame
;

1155 i‡(
Àn
 < 1)

1157 
√ed_¶ash
 = 
∑th
[
Àn
 - 1] != '/';

1159 
dú
 = 
	`›ídú
(
∑th
);

1160 i‡(!
dú
)

1161  -
ENOENT
;

1164 
dúít
 = 
	`ªaddú64
(
dú
);

1165 i‡(!
dúít
) {

1166 
	`˛o£dú
(
dú
);

1170 
fûíame
 = 
	`mÆloc
(
Àn
 + 
	`°æí
(
dúít
->
d_«me
Ë+ 1 + 
√ed_¶ash
);

1171 i‡(
fûíame
 =
NULL
) {

1172 
	`˛o£dú
(
dú
);

1173  -
ENOMEM
;

1175 
	`°r˝y
(
fûíame
, 
∑th
);

1176 i‡(
√ed_¶ash
)

1177 
	`°rˇt
(
fûíame
, "/");

1178 
	`°rˇt
(
fûíame
, 
dúít
->
d_«me
);

1179 
îr
 = 
	`¢d_pcm_œd•a_check_fûe
(
∂ugö
, 
fûíame
, 
œbñ
, 
œd•a_id
);

1180 
	`‰ì
(
fûíame
);

1181 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

1182 
	`˛o£dú
(
dú
);

1183  
îr
;

1185 i‡(
îr
 > 0) {

1186 
	`˛o£dú
(
dú
);

1192 
	}
}

1194 
	$¢d_pcm_œd•a_look_f‹_∂ugö
(
¢d_pcm_œd•a_∂ugö_t
 * c⁄° 
∂ugö
,

1195 c⁄° *
∑th
,

1196 c⁄° *
œbñ
,

1197 c⁄° 
œd•a_id
)

1199 c⁄° *
c
;

1200 
size_t
 
l
;

1201 
îr
;

1203 
c
 = 
∑th
; (
l
 = 
	`°rc•n
(c, ": ")) > 0; ) {

1204 
«me
[
l
 + 1];

1205 *
fuŒ∑th
;

1206 
	`mem˝y
(
«me
, 
c
, 
l
);

1207 
«me
[
l
] = 0;

1208 
îr
 = 
	`¢d_u£r_fûe
(
«me
, &
fuŒ∑th
);

1209 i‡(
îr
 < 0)

1210  
îr
;

1211 
îr
 = 
	`¢d_pcm_œd•a_check_dú
(
∂ugö
, 
fuŒ∑th
, 
œbñ
, 
œd•a_id
);

1212 
	`‰ì
(
fuŒ∑th
);

1213 i‡(
îr
 < 0 &&Éº !-
ENOENT
)

1214  
îr
;

1215 i‡(
îr
 > 0)

1217 
c
 +
l
;

1218 i‡(!*
c
)

1220 
c
++;

1222  -
ENOENT
;

1223 
	}
}

1225 
	$¢d_pcm_œd•a_add_deÁu…_c⁄åﬁs
(
¢d_pcm_œd•a_∂ugö_t
 *
Õlug
,

1226 
¢d_pcm_œd•a_∂ugö_io_t
 *
io
)

1228 
cou¡
 = 0;

1229 
LADSPA_D©a
 *
¨øy
;

1230 *
öôülized
;

1231 
idx
;

1233 
idx
 = 0; idx < 
Õlug
->
desc
->
P‹tCou¡
; idx++)

1234 i‡((
Õlug
->
desc
->
P‹tDes¸ùt‹s
[
idx
] & (
io
->
pdesc
 | 
LADSPA_PORT_CONTROL
)) == (io->pdesc | LADSPA_PORT_CONTROL))

1235 
cou¡
++;

1236 
¨øy
 = (
LADSPA_D©a
 *)
	`ˇŒoc
(
cou¡
, (LADSPA_Data));

1237 i‡(!
¨øy
)

1238  -
ENOMEM
;

1239 
öôülized
 = (*)
	`ˇŒoc
(
cou¡
, ());

1240 i‡(!
öôülized
) {

1241 
	`‰ì
(
¨øy
);

1242  -
ENOMEM
;

1244 
io
->
c⁄åﬁs_size
 = 
cou¡
;

1245 
io
->
c⁄åﬁs_öôülized
 = 
öôülized
;

1246 
io
->
c⁄åﬁs
 = 
¨øy
;

1249 
	}
}

1251 
	$¢d_pcm_œd•a_∑r£_c⁄åﬁs
(
¢d_pcm_œd•a_∂ugö_t
 *
Õlug
,

1252 
¢d_pcm_œd•a_∂ugö_io_t
 *
io
,

1253 
¢d_c⁄fig_t
 *
c⁄åﬁs
)

1255 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1256 
îr
;

1258 i‡(
	`¢d_c⁄fig_gë_ty≥
(
c⁄åﬁs
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1259 
	`SNDERR
("controls definition must beá compound");

1260  -
EINVAL
;

1263 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄åﬁs
) {

1264 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1265 c⁄° *
id
;

1266 
lvÆ
;

1267 
p‹t
, 
uvÆ
;

1268 
dvÆ
;

1269 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1271 
îr
 = 
	`ß„_°πﬁ
(
id
, &
lvÆ
);

1272 i‡(
îr
 >= 0) {

1273 
îr
 = 
	`¢d_pcm_œd•a_föd_p‹t
(&
p‹t
, 
Õlug
, 
io
->
pdesc
 | 
LADSPA_PORT_CONTROL
, 
lvÆ
);

1275 
îr
 = 
	`¢d_pcm_œd•a_föd_•‹t
(&
p‹t
, 
Õlug
, 
io
->
pdesc
 | 
LADSPA_PORT_CONTROL
, 
id
);

1277 i‡(
îr
 < 0) {

1278 
	`SNDERR
("U«bÀÅÿfödá¿c⁄åﬁÖ‹à(%s)", 
id
);

1279  
îr
;

1281 i‡(
	`¢d_c⁄fig_gë_úól
(
n
, &
dvÆ
) < 0) {

1282 
	`SNDERR
("C⁄åﬁÖ‹à%†ha†nŸá¿Êﬂà‹ i¡egî vÆue", 
id
);

1283  
îr
;

1285 
îr
 = 
	`¢d_pcm_œd•a_föd_p‹t_idx
(&
uvÆ
, 
Õlug
, 
io
->
pdesc
 | 
LADSPA_PORT_CONTROL
, 
p‹t
);

1286 i‡(
îr
 < 0) {

1287 
	`SNDERR
("internalÉrror");

1288  
îr
;

1290 
io
->
c⁄åﬁs_öôülized
[
uvÆ
] = 1;

1291 
io
->
c⁄åﬁs
[
uvÆ
] = (
LADSPA_D©a
)
dvÆ
;

1295 
	}
}

1297 
	$¢d_pcm_œd•a_∑r£_bödögs
(
¢d_pcm_œd•a_∂ugö_t
 *
Õlug
,

1298 
¢d_pcm_œd•a_∂ugö_io_t
 *
io
,

1299 
¢d_c⁄fig_t
 *
bödögs
)

1301 
cou¡
 = 0;

1302 *
¨øy
;

1303 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1304 
îr
;

1306 i‡(
	`¢d_c⁄fig_gë_ty≥
(
bödögs
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1307 
	`SNDERR
("bindings definition must beá compound");

1308  -
EINVAL
;

1310 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
bödögs
) {

1311 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1312 c⁄° *
id
;

1313 
ch™√l
;

1314 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1316 
îr
 = 
	`ß„_°πﬁ
(
id
, &
ch™√l
);

1317 i‡(
îr
 < 0 || 
ch™√l
 < 0) {

1318 
	`SNDERR
("InvÆid ch™√»numbî: %s", 
id
);

1319  -
EINVAL
;

1321 i‡(
Õlug
->
pﬁicy
 =
SND_PCM_LADSPA_POLICY_DUPLICATE
 && 
ch™√l
 > 0) {

1322 
	`SNDERR
("Wrong channel specification for duplicateÖolicy");

1323  -
EINVAL
;

1325 i‡(
cou¡
 < ()(
ch™√l
 + 1))

1326 
cou¡
 = ()(
ch™√l
 + 1);

1328 i‡(
cou¡
 > 0) {

1329 
¨øy
 = (*)
	`mÆloc
(
cou¡
 * ());

1330 i‡(! 
¨øy
)

1331  -
ENOMEM
;

1332 
	`mem£t
(
¨øy
, 0xff, 
cou¡
 * ());

1333 
io
->
p‹t_bödögs_size
 = 
cou¡
;

1334 
io
->
p‹t_bödögs
 = 
¨øy
;

1335 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
bödögs
) {

1336 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1337 c⁄° *
id
, *
•‹t
;

1338 
ch™√l
, 
p‹t
;

1339 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1341 
îr
 = 
	`ß„_°πﬁ
(
id
, &
ch™√l
);

1342 i‡(
îr
 < 0 || 
ch™√l
 < 0) {

1343 
	`as£π
(0);

1344  -
EINVAL
;

1346 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
p‹t
);

1347 i‡(
îr
 >= 0) {

1348 
îr
 = 
	`¢d_pcm_œd•a_föd_p‹t
(&
¨øy
[
ch™√l
], 
Õlug
, 
io
->
pdesc
 | 
LADSPA_PORT_AUDIO
, 
p‹t
);

1349 i‡(
îr
 < 0) {

1350 
	`SNDERR
("U«bÀÅÿfödá¿audiÿp‹à(%liËf‹ ch™√»%s", 
p‹t
, 
id
);

1351  
îr
;

1355 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
•‹t
);

1356 i‡(
îr
 < 0) {

1357 
	`SNDERR
("InvÆid LADSPAÖ‹àfõldÅy≥ f‹ %s", 
id
);

1358  -
EINVAL
;

1360 
îr
 = 
	`¢d_pcm_œd•a_föd_•‹t
(&
¨øy
[
ch™√l
], 
Õlug
, 
io
->
pdesc
 | 
LADSPA_PORT_AUDIO
, 
•‹t
);

1361 i‡(
îr
 < 0) {

1362 
	`SNDERR
("U«bÀÅÿfödá¿audiÿp‹à(%sËf‹ ch™√»%s", 
•‹t
, 
id
);

1363  
îr
;

1369 
	}
}

1371 
	$¢d_pcm_œd•a_∑r£_ioc⁄fig
(
¢d_pcm_œd•a_∂ugö_t
 *
Õlug
,

1372 
¢d_pcm_œd•a_∂ugö_io_t
 *
io
,

1373 
¢d_c⁄fig_t
 *
c⁄f
)

1375 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1376 
¢d_c⁄fig_t
 *
bödögs
 = 
NULL
, *
c⁄åﬁs
 = NULL;

1377 
îr
;

1380 
îr
 = 
	`¢d_pcm_œd•a_add_deÁu…_c⁄åﬁs
(
Õlug
, 
io
);

1381 i‡(
îr
 < 0) {

1382 
	`SNDERR
("errorádding default controls");

1383  
îr
;

1386 i‡(
c⁄f
 =
NULL
) {

1390 i‡(
	`¢d_c⁄fig_gë_ty≥
(
c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1391 
	`SNDERR
("input or output definition must beá compound");

1392  -
EINVAL
;

1394 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1395 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1396 c⁄° *
id
;

1397 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1399 i‡(
	`°rcmp
(
id
, "bindings") == 0) {

1400 
bödögs
 = 
n
;

1403 i‡(
	`°rcmp
(
id
, "controls") == 0) {

1404 
c⁄åﬁs
 = 
n
;

1410 i‡(
c⁄åﬁs
 && !(
io
->
pdesc
 & 
LADSPA_PORT_OUTPUT
)) {

1411 
îr
 = 
	`¢d_pcm_œd•a_∑r£_c⁄åﬁs
(
Õlug
, 
io
, 
c⁄åﬁs
);

1412 i‡(
îr
 < 0)

1413  
îr
;

1416 i‡(
bödögs
) {

1417 
îr
 = 
	`¢d_pcm_œd•a_∑r£_bödögs
(
Õlug
, 
io
, 
bödögs
);

1418 i‡(
îr
 < 0)

1419  
îr
;

1424 
	}
}

1426 
	$¢d_pcm_œd•a_add_∂ugö
(
li°_hód
 *
li°
,

1427 c⁄° *
∑th
,

1428 
¢d_c⁄fig_t
 *
∂ugö
,

1429 
ªvî£
)

1431 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1432 c⁄° *
œbñ
 = 
NULL
, *
fûíame
 = NULL;

1433 
œd•a_id
 = 0;

1434 
îr
;

1435 
¢d_pcm_œd•a_∂ugö_t
 *
Õlug
;

1436 
¢d_pcm_œd•a_pﬁicy_t
 
pﬁicy
 = 
SND_PCM_LADSPA_POLICY_DUPLICATE
;

1437 
¢d_c⁄fig_t
 *
öput
 = 
NULL
, *
ouçut
 = NULL;

1439 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
∂ugö
) {

1440 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1441 c⁄° *
id
;

1442 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1444 i‡(
	`°rcmp
(
id
, "label") == 0) {

1445 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
œbñ
);

1446 i‡(
îr
 < 0)

1447  
îr
;

1450 i‡(
	`°rcmp
(
id
, "id") == 0) {

1451 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
œd•a_id
);

1452 i‡(
îr
 < 0)

1453  
îr
;

1456 i‡(
	`°rcmp
(
id
, "filename") == 0) {

1457 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
fûíame
);

1458 i‡(
îr
 < 0)

1459  
îr
;

1462 i‡(
	`°rcmp
(
id
, "input") == 0) {

1463 
öput
 = 
n
;

1466 i‡(
	`°rcmp
(
id
, "output") == 0) {

1467 
ouçut
 = 
n
;

1470 i‡(
	`°rcmp
(
id
, "policy") == 0) {

1471 c⁄° *
°r
;

1472 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
);

1473 i‡(
îr
 < 0) {

1474 
	`SNDERR
("policy field must beá string");

1475  
îr
;

1477 i‡(
	`°rcmp
(
°r
, "none") == 0)

1478 
pﬁicy
 = 
SND_PCM_LADSPA_POLICY_NONE
;

1479 i‡(
	`°rcmp
(
°r
, "duplicate") == 0)

1480 
pﬁicy
 = 
SND_PCM_LADSPA_POLICY_DUPLICATE
;

1482 
	`SNDERR
("unknownÖolicy definition");

1483  -
EINVAL
;

1488 i‡(
œbñ
 =
NULL
 && 
œd•a_id
 <= 0) {

1489 
	`SNDERR
("noÖluginÜabel or id");

1490  -
EINVAL
;

1492 
Õlug
 = (
¢d_pcm_œd•a_∂ugö_t
 *)
	`ˇŒoc
(1, (snd_pcm_ladspa_plugin_t));

1493 i‡(
Õlug
 =
NULL
)

1494  -
ENOMEM
;

1495 
Õlug
->
pﬁicy
 =Öolicy;

1496 
Õlug
->
öput
.
pdesc
 = 
LADSPA_PORT_INPUT
;

1497 
Õlug
->
ouçut
.
pdesc
 = 
LADSPA_PORT_OUTPUT
;

1498 
	`INIT_LIST_HEAD
(&
Õlug
->
ö°™˚s
);

1499 i‡(
fûíame
) {

1500 
îr
 = 
	`¢d_pcm_œd•a_check_fûe
(
Õlug
, 
fûíame
, 
œbñ
, 
œd•a_id
);

1501 i‡(
îr
 < 0) {

1502 
	`SNDERR
("U«bÀÅÿlﬂdÖlugö '%s' ID %li, fûíamê'%s'", 
œbñ
, 
œd•a_id
, 
fûíame
);

1503 
	`‰ì
(
Õlug
);

1504  
îr
;

1507 
îr
 = 
	`¢d_pcm_œd•a_look_f‹_∂ugö
(
Õlug
, 
∑th
, 
œbñ
, 
œd•a_id
);

1508 i‡(
îr
 < 0) {

1509 
	`SNDERR
("U«bÀÅÿföd o∏lﬂdÖlugö '%s' ID %li,Ö©h '%s'", 
œbñ
, 
œd•a_id
, 
∑th
);

1510 
	`‰ì
(
Õlug
);

1511  
îr
;

1514 i‡(!
ªvî£
) {

1515 
	`li°_add_èû
(&
Õlug
->
li°
,Üist);

1517 
	`li°_add
(&
Õlug
->
li°
,Üist);

1519 
îr
 = 
	`¢d_pcm_œd•a_∑r£_ioc⁄fig
(
Õlug
, &Õlug->
öput
, input);

1520 i‡(
îr
 < 0)

1521  
îr
;

1522 
îr
 = 
	`¢d_pcm_œd•a_∑r£_ioc⁄fig
(
Õlug
, &Õlug->
ouçut
, output);

1523 i‡(
îr
 < 0)

1524  
îr
;

1526 
	}
}

1528 
	$¢d_pcm_œd•a_buûd_∂ugös
(
li°_hód
 *
li°
,

1529 c⁄° *
∑th
,

1530 
¢d_c⁄fig_t
 *
∂ugös
,

1531 
ªvî£
)

1533 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1534 
idx
 = 0, 
hô
, 
îr
;

1536 i‡(
∂ugös
 =
NULL
)

1538 i‡(
	`¢d_c⁄fig_gë_ty≥
(
∂ugös
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1539 
	`SNDERR
("plugins must be defined insideá compound");

1540  -
EINVAL
;

1543 
hô
 = 0;

1544 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
∂ugös
) {

1545 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1546 c⁄° *
id
;

1547 
i
;

1548 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1550 
îr
 = 
	`ß„_°πﬁ
(
id
, &
i
);

1551 i‡(
îr
 < 0) {

1552 
	`SNDERR
("id o‡fõld %†i†nŸá¿öãgî", 
id
);

1553  
îr
;

1555 i‡(
i
 =
idx
) {

1556 
idx
++;

1557 
îr
 = 
	`¢d_pcm_œd•a_add_∂ugö
(
li°
, 
∑th
, 
n
, 
ªvî£
);

1558 i‡(
îr
 < 0)

1559  
îr
;

1560 
hô
 = 1;

1563 } 
hô
);

1564 i‡(
	`li°_em±y
(
li°
)) {

1565 
	`SNDERR
("emptyÖluginÜist isÇotáccepted");

1566  -
EINVAL
;

1569 
	}
}

1586 
	$¢d_pcm_œd•a_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1587 c⁄° *
œd•a_∑th
,

1588 
ch™√ls
,

1589 
¢d_c⁄fig_t
 *
œd•a_µlugös
,

1590 
¢d_c⁄fig_t
 *
œd•a_˝lugös
,

1591 
¢d_pcm_t
 *
¶ave
, 
˛o£_¶ave
)

1593 
¢d_pcm_t
 *
pcm
;

1594 
¢d_pcm_œd•a_t
 *
œd•a
;

1595 
îr
, 
ªvî£
 = 0;

1597 
	`as£π
(
pcmp
 && (
œd•a_µlugös
 || 
œd•a_˝lugös
Ë&& 
¶ave
);

1599 i‡(!
œd•a_∑th
 && !÷ad•a_∑th = 
	`gëív
("LADSPA_PATH")))

1600  -
ENOENT
;

1601 
œd•a
 = 
	`ˇŒoc
(1, (
¢d_pcm_œd•a_t
));

1602 i‡(!
œd•a
)

1603  -
ENOMEM
;

1604 
	`¢d_pcm_∂ugö_öô
(&
œd•a
->
∂ug
);

1605 
œd•a
->
∂ug
.
öô
 = 
¢d_pcm_œd•a_öô
;

1606 
œd•a
->
∂ug
.
ªad
 = 
¢d_pcm_œd•a_ªad_¨ós
;

1607 
œd•a
->
∂ug
.
wrôe
 = 
¢d_pcm_œd•a_wrôe_¨ós
;

1608 
œd•a
->
∂ug
.
undo_ªad
 = 
¢d_pcm_∂ugö_undo_ªad_gíîic
;

1609 
œd•a
->
∂ug
.
undo_wrôe
 = 
¢d_pcm_∂ugö_undo_wrôe_gíîic
;

1610 
œd•a
->
∂ug
.
gí
.
¶ave
 = slave;

1611 
œd•a
->
∂ug
.
gí
.
˛o£_¶ave
 = close_slave;

1613 
	`INIT_LIST_HEAD
(&
œd•a
->
µlugös
);

1614 
	`INIT_LIST_HEAD
(&
œd•a
->
˝lugös
);

1615 
œd•a
->
ch™√ls
 = channels;

1617 i‡(
¶ave
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

1618 
îr
 = 
	`¢d_pcm_œd•a_buûd_∂ugös
(&
œd•a
->
µlugös
, 
œd•a_∑th
, 
œd•a_µlugös
, 
ªvî£
);

1619 i‡(
îr
 < 0) {

1620 
	`¢d_pcm_œd•a_‰ì
(
œd•a
);

1621  
îr
;

1624 i‡(
¶ave
->
°ªam
 =
SND_PCM_STREAM_CAPTURE
) {

1625 i‡(
œd•a_˝lugös
 =
œd•a_µlugös
)

1626 
ªvî£
 = 1;

1627 
îr
 = 
	`¢d_pcm_œd•a_buûd_∂ugös
(&
œd•a
->
˝lugös
, 
œd•a_∑th
, 
œd•a_˝lugös
, 
ªvî£
);

1628 i‡(
îr
 < 0) {

1629 
	`¢d_pcm_œd•a_‰ì
(
œd•a
);

1630  
îr
;

1634 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_LADSPA
, 
«me
, 
¶ave
->
°ªam
, sœve->
mode
);

1635 i‡(
îr
 < 0) {

1636 
	`¢d_pcm_œd•a_‰ì
(
œd•a
);

1637  
îr
;

1639 
pcm
->
›s
 = &
¢d_pcm_œd•a_›s
;

1640 
pcm
->
Á°_›s
 = &
¢d_pcm_∂ugö_Á°_›s
;

1641 
pcm
->
¥iv©e_d©a
 = 
œd•a
;

1642 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

1643 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

1644 
pcm
->
t°amp_ty≥
 = 
¶ave
->tstamp_type;

1645 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
œd•a
->
∂ug
.
hw_±r
, -1, 0);

1646 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
œd•a
->
∂ug
.
≠∂_±r
, -1, 0);

1647 *
pcmp
 = 
pcm
;

1650 
	}
}

1733 
	$_¢d_pcm_œd•a_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1734 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

1735 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

1737 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1738 
îr
;

1739 
¢d_pcm_t
 *
•cm
;

1740 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

1741 c⁄° *
∑th
 = 
NULL
;

1742 
ch™√ls
 = 0;

1743 
¢d_c⁄fig_t
 *
∂ugös
 = 
NULL
, *
µlugös
 = NULL, *
˝lugös
 = NULL;

1744 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1745 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1746 c⁄° *
id
;

1747 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1749 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

1751 i‡(
	`°rcmp
(
id
, "slave") == 0) {

1752 
¶ave
 = 
n
;

1755 i‡(
	`°rcmp
(
id
, "path") == 0) {

1756 
	`¢d_c⁄fig_gë_°rög
(
n
, &
∑th
);

1759 i‡(
	`°rcmp
(
id
, "channels") == 0) {

1760 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
ch™√ls
);

1761 i‡(
ch™√ls
 > 1024)

1762 
ch™√ls
 = 1024;

1763 i‡(
ch™√ls
 < 0)

1764 
ch™√ls
 = 0;

1767 i‡(
	`°rcmp
(
id
, "plugins") == 0) {

1768 
∂ugös
 = 
n
;

1771 i‡(
	`°rcmp
(
id
, "playback_plugins") == 0) {

1772 
µlugös
 = 
n
;

1775 i‡(
	`°rcmp
(
id
, "capture_plugins") == 0) {

1776 
˝lugös
 = 
n
;

1779 
	`SNDERR
("Unknow¿fõld %s", 
id
);

1780  -
EINVAL
;

1782 i‡(!
¶ave
) {

1783 
	`SNDERR
("slave isÇot defined");

1784  -
EINVAL
;

1786 i‡(
∂ugös
) {

1787 i‡(
µlugös
 || 
˝lugös
) {

1788 
	`SNDERR
("'plugins' definition cannot be combined with 'playback_plugins' or 'capture_plugins'");

1789  -
EINVAL
;

1791 
µlugös
 = 
∂ugös
;

1792 
˝lugös
 = 
∂ugös
;

1794 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 0);

1795 i‡(
îr
 < 0)

1796  
îr
;

1797 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

1798 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1799 i‡(
îr
 < 0)

1800  
îr
;

1801 
îr
 = 
	`¢d_pcm_œd•a_›í
(
pcmp
, 
«me
, 
∑th
, 
ch™√ls
, 
µlugös
, 
˝lugös
, 
•cm
, 1);

1802 i‡(
îr
 < 0)

1803 
	`¢d_pcm_˛o£
(
•cm
);

1804  
îr
;

1805 
	}
}

1806 #i‚de‡
DOC_HIDDEN


1807 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_œd•a_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_lfloat.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_∂ugö.h
"

31 
	~"∂ugö_›s.h
"

32 
	~"bsw≠.h
"

34 #i‚de‡
DOC_HIDDEN


36 
	tÊﬂt_t
;

37 
	tdoubÀ_t
;

39 #i‡
__GNUC__
 < 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 <= 91)

40 
	#BUGGY_GCC


	)

43 #i‚de‡
PIC


45 c⁄° *
	g_¢d_moduÀ_pcm_lÊﬂt
 = "";

50 
¢d_pcm_∂ugö_t
 
	m∂ug
;

51 
	möt32_idx
;

52 
	mÊﬂt32_idx
;

53 
¢d_pcm_f‹m©_t
 
	msf‹m©
;

54 (*
	mfunc
)(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
	md°_¨ós
, 
¢d_pcm_u‰ames_t
 
	md°_off£t
,

55 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
	m§c_¨ós
, 
¢d_pcm_u‰ames_t
 
	m§c_off£t
,

56 
	mch™√ls
, 
¢d_pcm_u‰ames_t
 
	m‰ames
,

57 
	mgë32idx
, 
	mput32Êﬂtidx
);

58 } 
	t¢d_pcm_lÊﬂt_t
;

60 
	$¢d_pcm_lÊﬂt_gë_s32_ödex
(
¢d_pcm_f‹m©_t
 
f‹m©
)

62 
width
, 
ídün
;

64 
f‹m©
) {

65 
SND_PCM_FORMAT_FLOAT_LE
:

66 
SND_PCM_FORMAT_FLOAT_BE
:

67 
width
 = 32;

69 
SND_PCM_FORMAT_FLOAT64_LE
:

70 
SND_PCM_FORMAT_FLOAT64_BE
:

71 
width
 = 64;

74  -
EINVAL
;

76 #ifde‡
SND_LITTLE_ENDIAN


77 
ídün
 = 
	`¢d_pcm_f‹m©_big_ídün
(
f‹m©
);

79 
ídün
 = 
	`¢d_pcm_f‹m©_lôée_ídün
(
f‹m©
);

81  ((
width
 / 32)-1Ë* 2 + 
ídün
;

82 
	}
}

84 
	$¢d_pcm_lÊﬂt_put_s32_ödex
(
¢d_pcm_f‹m©_t
 
f‹m©
)

86  
	`¢d_pcm_lÊﬂt_gë_s32_ödex
(
f‹m©
);

87 
	}
}

91 #i‚de‡
BUGGY_GCC


93 #i‚de‡
DOC_HIDDEN


95 
	$¢d_pcm_lÊﬂt_c⁄vît_öãgî_Êﬂt
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
, 
¢d_pcm_u‰ames_t
 
d°_off£t
,

96 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
, 
¢d_pcm_u‰ames_t
 
§c_off£t
,

97 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

98 
gë32idx
, 
put32Êﬂtidx
)

100 
	#GET32_LABELS


	)

101 
	#PUT32F_LABELS


	)

102 
	~"∂ugö_›s.h
"

103 #unde‡
PUT32F_LABELS


104 #unde‡
GET32_LABELS


105 *
gë32
 = 
gë32_œbñs
[
gë32idx
];

106 *
put32Êﬂt
 = 
put32Êﬂt_œbñs
[
put32Êﬂtidx
];

107 
ch™√l
;

108 
ch™√l
 = 0; ch™√»< 
ch™√ls
; ++channel) {

109 c⁄° *
§c
;

110 *
d°
;

111 
§c_°ï
, 
d°_°ï
;

112 
¢d_pcm_u‰ames_t
 
‰ames1
;

113 
öt32_t
 
ßm∂e
 = 0;

114 
¢d_tmp_Êﬂt_t
 
tmp_Êﬂt
;

115 
¢d_tmp_doubÀ_t
 
tmp_doubÀ
;

116 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

117 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

118 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

119 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

120 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
);

121 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
);

122 
‰ames1
 = 
‰ames
;

123 
‰ames1
-- > 0) {

124 *
gë32
;

125 
	#GET32_END
 
ßm∂e_lﬂded


	)

126 
	~"∂ugö_›s.h
"

127 #unde‡
GET32_END


128 
ßm∂e_lﬂded
:

129 *
put32Êﬂt
;

130 
	#PUT32F_END
 
ßm∂e_put


	)

131 
	~"∂ugö_›s.h
"

132 #unde‡
PUT32F_END


133 
ßm∂e_put
:

134 
§c
 +
§c_°ï
;

135 
d°
 +
d°_°ï
;

138 
	}
}

140 
	$¢d_pcm_lÊﬂt_c⁄vît_Êﬂt_öãgî
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
, 
¢d_pcm_u‰ames_t
 
d°_off£t
,

141 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
, 
¢d_pcm_u‰ames_t
 
§c_off£t
,

142 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

143 
put32idx
, 
gë32Êﬂtidx
)

145 
	#PUT32_LABELS


	)

146 
	#GET32F_LABELS


	)

147 
	~"∂ugö_›s.h
"

148 #unde‡
GET32F_LABELS


149 #unde‡
PUT32_LABELS


150 *
put32
 = 
put32_œbñs
[
put32idx
];

151 *
gë32Êﬂt
 = 
gë32Êﬂt_œbñs
[
gë32Êﬂtidx
];

152 
ch™√l
;

153 
ch™√l
 = 0; ch™√»< 
ch™√ls
; ++channel) {

154 c⁄° *
§c
;

155 *
d°
;

156 
§c_°ï
, 
d°_°ï
;

157 
¢d_pcm_u‰ames_t
 
‰ames1
;

158 
öt32_t
 
ßm∂e
 = 0;

159 
¢d_tmp_Êﬂt_t
 
tmp_Êﬂt
;

160 
¢d_tmp_doubÀ_t
 
tmp_doubÀ
;

161 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

162 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

163 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

164 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

165 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
);

166 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
);

167 
‰ames1
 = 
‰ames
;

168 
‰ames1
-- > 0) {

169 *
gë32Êﬂt
;

170 
	#GET32F_END
 
ßm∂e_lﬂded


	)

171 
	~"∂ugö_›s.h
"

172 #unde‡
GET32F_END


173 
ßm∂e_lﬂded
:

174 *
put32
;

175 
	#PUT32_END
 
ßm∂e_put


	)

176 
	~"∂ugö_›s.h
"

177 #unde‡
PUT32_END


178 
ßm∂e_put
:

179 
§c
 +
§c_°ï
;

180 
d°
 +
d°_°ï
;

183 
	}
}

187 
	$¢d_pcm_lÊﬂt_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

189 
¢d_pcm_lÊﬂt_t
 *
lÊﬂt
 = 
pcm
->
¥iv©e_d©a
;

190 
îr
;

191 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

192 
¢d_pcm_f‹m©_mask_t
 
lf‹m©_mask
 = { 
SND_PCM_FMTBIT_LINEAR
 };

193 
¢d_pcm_f‹m©_mask_t
 
ff‹m©_mask
 = { 
SND_PCM_FMTBIT_FLOAT
 };

194 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

195 &
ac˚ss_mask
);

196 i‡(
îr
 < 0)

197  
îr
;

198 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
,

199 
	`¢d_pcm_f‹m©_löór
(
lÊﬂt
->
sf‹m©
) ?

200 &
ff‹m©_mask
 : &
lf‹m©_mask
);

201 i‡(
îr
 < 0)

202  
îr
;

203 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
∑øms
, 
SND_PCM_SUBFORMAT_STD
);

204 i‡(
îr
 < 0)

205  
îr
;

206 
∑øms
->
öfo
 &~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

208 
	}
}

210 
	$¢d_pcm_lÊﬂt_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

212 
¢d_pcm_lÊﬂt_t
 *
lÊﬂt
 = 
pcm
->
¥iv©e_d©a
;

213 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

214 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

215 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

216 &
ßc˚ss_mask
);

217 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
•¨ams
, 
lÊﬂt
->
sf‹m©
);

218 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
•¨ams
, 
SND_PCM_SUBFORMAT_STD
);

220 
	}
}

222 
	$¢d_pcm_lÊﬂt_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

223 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

225 
îr
;

226 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

227 
SND_PCM_HW_PARBIT_RATE
 |

228 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

229 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

230 
SND_PCM_HW_PARBIT_PERIODS
 |

231 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

232 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

233 
SND_PCM_HW_PARBIT_TICK_TIME
);

234 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

235 i‡(
îr
 < 0)

236  
îr
;

238 
	}
}

240 
	$¢d_pcm_lÊﬂt_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

241 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

243 
îr
;

244 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

245 
SND_PCM_HW_PARBIT_RATE
 |

246 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

247 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

248 
SND_PCM_HW_PARBIT_PERIODS
 |

249 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

250 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

251 
SND_PCM_HW_PARBIT_TICK_TIME
);

252 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

253 i‡(
îr
 < 0)

254  
îr
;

256 
	}
}

258 
	$¢d_pcm_lÊﬂt_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

260  
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

261 
¢d_pcm_lÊﬂt_hw_ªföe_˝ª∑ª
,

262 
¢d_pcm_lÊﬂt_hw_ªföe_cch™ge
,

263 
¢d_pcm_lÊﬂt_hw_ªföe_•ª∑ª
,

264 
¢d_pcm_lÊﬂt_hw_ªföe_sch™ge
,

265 
¢d_pcm_gíîic_hw_ªföe
);

266 
	}
}

268 
	$¢d_pcm_lÊﬂt_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

270 
¢d_pcm_lÊﬂt_t
 *
lÊﬂt
 = 
pcm
->
¥iv©e_d©a
;

271 
¢d_pcm_t
 *
¶ave
 = 
lÊﬂt
->
∂ug
.
gí
.slave;

272 
¢d_pcm_f‹m©_t
 
§c_f‹m©
, 
d°_f‹m©
;

273 
îr
 = 
	`¢d_pcm_hw_∑øms_¶ave
(
pcm
, 
∑øms
,

274 
¢d_pcm_lÊﬂt_hw_ªföe_cch™ge
,

275 
¢d_pcm_lÊﬂt_hw_ªföe_•ª∑ª
,

276 
¢d_pcm_lÊﬂt_hw_ªföe_sch™ge
,

277 
¢d_pcm_gíîic_hw_∑øms
);

278 i‡(
îr
 < 0)

279  
îr
;

280 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

281 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(
∑øms
, &
§c_f‹m©
);

282 
d°_f‹m©
 = 
¶ave
->
f‹m©
;

284 
§c_f‹m©
 = 
¶ave
->
f‹m©
;

285 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(
∑øms
, &
d°_f‹m©
);

287 i‡(
	`¢d_pcm_f‹m©_löór
(
§c_f‹m©
)) {

288 
lÊﬂt
->
öt32_idx
 = 
	`¢d_pcm_löór_gë_ödex
(
§c_f‹m©
, 
SND_PCM_FORMAT_S32
);

289 
lÊﬂt
->
Êﬂt32_idx
 = 
	`¢d_pcm_lÊﬂt_put_s32_ödex
(
d°_f‹m©
);

290 
lÊﬂt
->
func
 = 
¢d_pcm_lÊﬂt_c⁄vît_öãgî_Êﬂt
;

292 
lÊﬂt
->
öt32_idx
 = 
	`¢d_pcm_löór_put_ödex
(
SND_PCM_FORMAT_S32
, 
d°_f‹m©
);

293 
lÊﬂt
->
Êﬂt32_idx
 = 
	`¢d_pcm_lÊﬂt_gë_s32_ödex
(
§c_f‹m©
);

294 
lÊﬂt
->
func
 = 
¢d_pcm_lÊﬂt_c⁄vît_Êﬂt_öãgî
;

297 
	}
}

299 
¢d_pcm_u‰ames_t


300 
	$¢d_pcm_lÊﬂt_wrôe_¨ós
(
¢d_pcm_t
 *
pcm
,

301 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

302 
¢d_pcm_u‰ames_t
 
off£t
,

303 
¢d_pcm_u‰ames_t
 
size
,

304 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

305 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

306 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

308 
¢d_pcm_lÊﬂt_t
 *
lÊﬂt
 = 
pcm
->
¥iv©e_d©a
;

309 i‡(
size
 > *
¶ave_sizï
)

310 
size
 = *
¶ave_sizï
;

311 
lÊﬂt
->
	`func
(
¶ave_¨ós
, 
¶ave_off£t
,

312 
¨ós
, 
off£t
,

313 
pcm
->
ch™√ls
, 
size
,

314 
lÊﬂt
->
öt32_idx
,ÜÊﬂt->
Êﬂt32_idx
);

315 *
¶ave_sizï
 = 
size
;

316  
size
;

317 
	}
}

319 
¢d_pcm_u‰ames_t


320 
	$¢d_pcm_lÊﬂt_ªad_¨ós
(
¢d_pcm_t
 *
pcm
,

321 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

322 
¢d_pcm_u‰ames_t
 
off£t
,

323 
¢d_pcm_u‰ames_t
 
size
,

324 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

325 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

326 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

328 
¢d_pcm_lÊﬂt_t
 *
lÊﬂt
 = 
pcm
->
¥iv©e_d©a
;

329 i‡(
size
 > *
¶ave_sizï
)

330 
size
 = *
¶ave_sizï
;

331 
lÊﬂt
->
	`func
(
¨ós
, 
off£t
,

332 
¶ave_¨ós
, 
¶ave_off£t
,

333 
pcm
->
ch™√ls
, 
size
,

334 
lÊﬂt
->
öt32_idx
,ÜÊﬂt->
Êﬂt32_idx
);

335 *
¶ave_sizï
 = 
size
;

336  
size
;

337 
	}
}

339 
	$¢d_pcm_lÊﬂt_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

341 
¢d_pcm_lÊﬂt_t
 *
lÊﬂt
 = 
pcm
->
¥iv©e_d©a
;

342 
	`¢d_ouçut_¥ötf
(
out
, "Linear Integer <-> Linear Float conversion PCM (%s)\n",

343 
	`¢d_pcm_f‹m©_«me
(
lÊﬂt
->
sf‹m©
));

344 i‡(
pcm
->
£tup
) {

345 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

346 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

348 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

349 
	`¢d_pcm_dump
(
lÊﬂt
->
∂ug
.
gí
.
¶ave
, 
out
);

350 
	}
}

352 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_lÊﬂt_›s
 = {

353 .
˛o£
 = 
¢d_pcm_gíîic_˛o£
,

354 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

355 .
	ghw_ªföe
 = 
¢d_pcm_lÊﬂt_hw_ªföe
,

356 .
	ghw_∑øms
 = 
¢d_pcm_lÊﬂt_hw_∑øms
,

357 .
	ghw_‰ì
 = 
¢d_pcm_gíîic_hw_‰ì
,

358 .
	gsw_∑øms
 = 
¢d_pcm_gíîic_sw_∑øms
,

359 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

360 .
	gdump
 = 
¢d_pcm_lÊﬂt_dump
,

361 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

362 .
	gasync
 = 
¢d_pcm_gíîic_async
,

363 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

364 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

365 .
	gquîy_chm≠s
 = 
¢d_pcm_gíîic_quîy_chm≠s
,

366 .
	ggë_chm≠
 = 
¢d_pcm_gíîic_gë_chm≠
,

367 .
	g£t_chm≠
 = 
¢d_pcm_gíîic_£t_chm≠
,

382 
	$¢d_pcm_lÊﬂt_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
, 
¢d_pcm_f‹m©_t
 
sf‹m©
, snd_pcm_à*
¶ave
, 
˛o£_¶ave
)

384 
¢d_pcm_t
 *
pcm
;

385 
¢d_pcm_lÊﬂt_t
 *
lÊﬂt
;

386 
îr
;

387 
	`as£π
(
pcmp
 && 
¶ave
);

388 i‡(
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1 &&

389 
	`¢d_pcm_f‹m©_Êﬂt
(
sf‹m©
) != 1)

390  -
EINVAL
;

391 
lÊﬂt
 = 
	`ˇŒoc
(1, (
¢d_pcm_lÊﬂt_t
));

392 i‡(!
lÊﬂt
) {

393  -
ENOMEM
;

395 
	`¢d_pcm_∂ugö_öô
(&
lÊﬂt
->
∂ug
);

396 
lÊﬂt
->
sf‹m©
 = sformat;

397 
lÊﬂt
->
∂ug
.
ªad
 = 
¢d_pcm_lÊﬂt_ªad_¨ós
;

398 
lÊﬂt
->
∂ug
.
wrôe
 = 
¢d_pcm_lÊﬂt_wrôe_¨ós
;

399 
lÊﬂt
->
∂ug
.
undo_ªad
 = 
¢d_pcm_∂ugö_undo_ªad_gíîic
;

400 
lÊﬂt
->
∂ug
.
undo_wrôe
 = 
¢d_pcm_∂ugö_undo_wrôe_gíîic
;

401 
lÊﬂt
->
∂ug
.
gí
.
¶ave
 = slave;

402 
lÊﬂt
->
∂ug
.
gí
.
˛o£_¶ave
 = close_slave;

404 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_LINEAR_FLOAT
, 
«me
, 
¶ave
->
°ªam
, sœve->
mode
);

405 i‡(
îr
 < 0) {

406 
	`‰ì
(
lÊﬂt
);

407  
îr
;

409 
pcm
->
›s
 = &
¢d_pcm_lÊﬂt_›s
;

410 
pcm
->
Á°_›s
 = &
¢d_pcm_∂ugö_Á°_›s
;

411 
pcm
->
¥iv©e_d©a
 = 
lÊﬂt
;

412 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

413 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

414 
pcm
->
t°amp_ty≥
 = 
¶ave
->tstamp_type;

415 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
lÊﬂt
->
∂ug
.
hw_±r
, -1, 0);

416 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
lÊﬂt
->
∂ug
.
≠∂_±r
, -1, 0);

417 *
pcmp
 = 
pcm
;

420 
	}
}

466 
	$_¢d_pcm_lÊﬂt_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

467 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

468 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

470 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

471 
îr
;

472 
¢d_pcm_t
 *
•cm
;

473 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

474 
¢d_pcm_f‹m©_t
 
sf‹m©
;

475 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

476 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

477 c⁄° *
id
;

478 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

480 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

482 i‡(
	`°rcmp
(
id
, "slave") == 0) {

483 
¶ave
 = 
n
;

486 
	`SNDERR
("Unknow¿fõld %s", 
id
);

487  -
EINVAL
;

489 i‡(!
¶ave
) {

490 
	`SNDERR
("slave isÇot defined");

491  -
EINVAL
;

493 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 1,

494 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_MANDATORY
, &
sf‹m©
);

495 i‡(
îr
 < 0)

496  
îr
;

497 i‡(
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1 &&

498 
	`¢d_pcm_f‹m©_Êﬂt
(
sf‹m©
) != 1) {

499 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

500 
	`SNDERR
("slave format isÇotÜinear integer orÜinear float");

501  -
EINVAL
;

503 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

504 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

505 i‡(
îr
 < 0)

506  
îr
;

507 
îr
 = 
	`¢d_pcm_lÊﬂt_›í
(
pcmp
, 
«me
, 
sf‹m©
, 
•cm
, 1);

508 i‡(
îr
 < 0)

509 
	`¢d_pcm_˛o£
(
•cm
);

510  
îr
;

511 
	}
}

512 #i‚de‡
DOC_HIDDEN


513 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_lÊﬂt_›í
, 
SND_PCM_DLSYM_VERSION
);

518 
	$¢d_pcm_lÊﬂt_›í
(
¢d_pcm_t
 **
pcmp
 
ATTRIBUTE_UNUSED
,

519 c⁄° *
«me
 
ATTRIBUTE_UNUSED
,

520 
¢d_pcm_f‹m©_t
 
sf‹m©
 
ATTRIBUTE_UNUSED
,

521 
¢d_pcm_t
 *
¶ave
 
ATTRIBUTE_UNUSED
,

522 
˛o£_¶ave
 
ATTRIBUTE_UNUSED
)

524 
	`SNDERR
("please, upgrade your GCCÅo useÜfloatÖlugin");

525  -
EINVAL
;

526 
	}
}

528 
	$_¢d_pcm_lÊﬂt_›í
(
¢d_pcm_t
 **
pcmp
 
ATTRIBUTE_UNUSED
,

529 c⁄° *
«me
 
ATTRIBUTE_UNUSED
,

530 
¢d_c⁄fig_t
 *
roŸ
 
ATTRIBUTE_UNUSED
,

531 
¢d_c⁄fig_t
 *
c⁄f
 
ATTRIBUTE_UNUSED
,

532 
¢d_pcm_°ªam_t
 
°ªam
 
ATTRIBUTE_UNUSED
,

533 
mode
 
ATTRIBUTE_UNUSED
)

535 
	`SNDERR
("please, upgrade your GCCÅo useÜfloatÖlugin");

536  -
EINVAL
;

537 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_linear.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_∂ugö.h
"

31 
	~"∂ugö_›s.h
"

32 
	~"bsw≠.h
"

34 #i‚de‡
PIC


36 c⁄° *
	g_¢d_moduÀ_pcm_löór
 = "";

39 #i‚de‡
DOC_HIDDEN


42 
¢d_pcm_∂ugö_t
 
	m∂ug
;

43 
	mu£_gëput
;

44 
	mc⁄v_idx
;

45 
	mgë_idx
, 
	mput_idx
;

46 
¢d_pcm_f‹m©_t
 
	msf‹m©
;

47 } 
	t¢d_pcm_löór_t
;

50 #i‚de‡
DOC_HIDDEN


52 
	$¢d_pcm_löór_c⁄vît_ödex
(
¢d_pcm_f‹m©_t
 
§c_f‹m©
,

53 
¢d_pcm_f‹m©_t
 
d°_f‹m©
)

55 
§c_ídün
, 
d°_ídün
, 
sign
, 
§c_width
, 
d°_width
;

57 
sign
 = (
	`¢d_pcm_f‹m©_sig√d
(
§c_f‹m©
) !=

58 
	`¢d_pcm_f‹m©_sig√d
(
d°_f‹m©
));

59 #ifde‡
SND_LITTLE_ENDIAN


60 
§c_ídün
 = 
	`¢d_pcm_f‹m©_big_ídün
(
§c_f‹m©
);

61 
d°_ídün
 = 
	`¢d_pcm_f‹m©_big_ídün
(
d°_f‹m©
);

63 
§c_ídün
 = 
	`¢d_pcm_f‹m©_lôée_ídün
(
§c_f‹m©
);

64 
d°_ídün
 = 
	`¢d_pcm_f‹m©_lôée_ídün
(
d°_f‹m©
);

67 i‡(
§c_ídün
 < 0)

68 
§c_ídün
 = 0;

69 i‡(
d°_ídün
 < 0)

70 
d°_ídün
 = 0;

72 
§c_width
 = 
	`¢d_pcm_f‹m©_width
(
§c_f‹m©
) / 8 - 1;

73 
d°_width
 = 
	`¢d_pcm_f‹m©_width
(
d°_f‹m©
) / 8 - 1;

75  
§c_width
 * 32 + 
§c_ídün
 * 16 + 
sign
 * 8 + 
d°_width
 * 2 + 
d°_ídün
;

76 
	}
}

78 
	$¢d_pcm_löór_gë_ödex
(
¢d_pcm_f‹m©_t
 
§c_f‹m©
, snd_pcm_f‹m©_à
d°_f‹m©
)

80 
sign
, 
width
, 
pwidth
, 
ídün
;

81 
sign
 = (
	`¢d_pcm_f‹m©_sig√d
(
§c_f‹m©
) !=

82 
	`¢d_pcm_f‹m©_sig√d
(
d°_f‹m©
));

83 #ifde‡
SND_LITTLE_ENDIAN


84 
ídün
 = 
	`¢d_pcm_f‹m©_big_ídün
(
§c_f‹m©
);

86 
ídün
 = 
	`¢d_pcm_f‹m©_lôée_ídün
(
§c_f‹m©
);

88 i‡(
ídün
 < 0)

89 
ídün
 = 0;

90 
pwidth
 = 
	`¢d_pcm_f‹m©_physiˇl_width
(
§c_f‹m©
);

91 
width
 = 
	`¢d_pcm_f‹m©_width
(
§c_f‹m©
);

92 i‡(
pwidth
 == 24) {

93 
width
) {

95 
width
 = 0; ;

97 
width
 = 1; ;

100 
width
 = 2; ;

102  
width
 * 4 + 
ídün
 * 2 + 
sign
 + 20;

104 i‡(
width
 == 20)

105 
width
 = 40;

107 
width
 = width / 8 - 1;

108  
width
 * 4 + 
ídün
 * 2 + 
sign
;

110 
	}
}

112 
	$¢d_pcm_löór_put_ödex
(
¢d_pcm_f‹m©_t
 
§c_f‹m©
, snd_pcm_f‹m©_à
d°_f‹m©
)

114 
sign
, 
width
, 
pwidth
, 
ídün
;

115 
sign
 = (
	`¢d_pcm_f‹m©_sig√d
(
§c_f‹m©
) !=

116 
	`¢d_pcm_f‹m©_sig√d
(
d°_f‹m©
));

117 #ifde‡
SND_LITTLE_ENDIAN


118 
ídün
 = 
	`¢d_pcm_f‹m©_big_ídün
(
d°_f‹m©
);

120 
ídün
 = 
	`¢d_pcm_f‹m©_lôée_ídün
(
d°_f‹m©
);

122 i‡(
ídün
 < 0)

123 
ídün
 = 0;

124 
pwidth
 = 
	`¢d_pcm_f‹m©_physiˇl_width
(
d°_f‹m©
);

125 
width
 = 
	`¢d_pcm_f‹m©_width
(
d°_f‹m©
);

126 i‡(
pwidth
 == 24) {

127 
width
) {

129 
width
 = 0; ;

131 
width
 = 1; ;

134 
width
 = 2; ;

136  
width
 * 4 + 
ídün
 * 2 + 
sign
 + 20;

138 i‡(
width
 == 20)

139 
width
 = 40;

141 
width
 = width / 8 - 1;

142  
width
 * 4 + 
ídün
 * 2 + 
sign
;

144 
	}
}

146 
	$¢d_pcm_löór_c⁄vît
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
, 
¢d_pcm_u‰ames_t
 
d°_off£t
,

147 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
, 
¢d_pcm_u‰ames_t
 
§c_off£t
,

148 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

149 
c⁄vidx
)

151 
	#CONV_LABELS


	)

152 
	~"∂ugö_›s.h
"

153 #unde‡
CONV_LABELS


154 *
c⁄v
 = 
c⁄v_œbñs
[
c⁄vidx
];

155 
ch™√l
;

156 
ch™√l
 = 0; ch™√»< 
ch™√ls
; ++channel) {

157 c⁄° *
§c
;

158 *
d°
;

159 
§c_°ï
, 
d°_°ï
;

160 
¢d_pcm_u‰ames_t
 
‰ames1
;

161 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

162 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

163 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

164 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

165 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
);

166 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
);

167 
‰ames1
 = 
‰ames
;

168 
‰ames1
-- > 0) {

169 *
c⁄v
;

170 
	#CONV_END
 
a·î


	)

171 
	~"∂ugö_›s.h
"

172 #unde‡
CONV_END


173 
a·î
:

174 
§c
 +
§c_°ï
;

175 
d°
 +
d°_°ï
;

178 
	}
}

180 
	$¢d_pcm_löór_gëput
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
, 
¢d_pcm_u‰ames_t
 
d°_off£t
,

181 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
, 
¢d_pcm_u‰ames_t
 
§c_off£t
,

182 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

183 
gë_idx
, 
put_idx
)

185 
	#CONV24_LABELS


	)

186 
	~"∂ugö_›s.h
"

187 #unde‡
CONV24_LABELS


188 *
gë
 = 
gë32_œbñs
[
gë_idx
];

189 *
put
 = 
put32_œbñs
[
put_idx
];

190 
ch™√l
;

191 
uöt32_t
 
ßm∂e
 = 0;

192 
ch™√l
 = 0; ch™√»< 
ch™√ls
; ++channel) {

193 c⁄° *
§c
;

194 *
d°
;

195 
§c_°ï
, 
d°_°ï
;

196 
¢d_pcm_u‰ames_t
 
‰ames1
;

197 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

198 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

199 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

200 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

201 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
);

202 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
);

203 
‰ames1
 = 
‰ames
;

204 
‰ames1
-- > 0) {

205 *
gë
;

206 
	#CONV24_END
 
a·î


	)

207 
	~"∂ugö_›s.h
"

208 #unde‡
CONV24_END


209 
a·î
:

210 
§c
 +
§c_°ï
;

211 
d°
 +
d°_°ï
;

214 
	}
}

218 
	$¢d_pcm_löór_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

220 
îr
;

221 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

222 
¢d_pcm_f‹m©_mask_t
 
f‹m©_mask
 = { 
SND_PCM_FMTBIT_LINEAR
 };

223 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

224 &
ac˚ss_mask
);

225 i‡(
îr
 < 0)

226  
îr
;

227 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
,

228 &
f‹m©_mask
);

229 i‡(
îr
 < 0)

230  
îr
;

231 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
∑øms
, 
SND_PCM_SUBFORMAT_STD
);

232 i‡(
îr
 < 0)

233  
îr
;

234 
∑øms
->
öfo
 &~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

236 
	}
}

238 
	$¢d_pcm_löór_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

240 
¢d_pcm_löór_t
 *
löór
 = 
pcm
->
¥iv©e_d©a
;

241 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

242 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

243 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

244 &
ßc˚ss_mask
);

245 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
•¨ams
, 
löór
->
sf‹m©
);

246 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
•¨ams
, 
SND_PCM_SUBFORMAT_STD
);

248 
	}
}

250 
	$¢d_pcm_löór_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

251 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

253 
îr
;

254 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

255 
SND_PCM_HW_PARBIT_RATE
 |

256 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

257 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

258 
SND_PCM_HW_PARBIT_PERIODS
 |

259 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

260 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

261 
SND_PCM_HW_PARBIT_TICK_TIME
);

262 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

263 i‡(
îr
 < 0)

264  
îr
;

266 
	}
}

268 
	$¢d_pcm_löór_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

269 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

271 
îr
;

272 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

273 
SND_PCM_HW_PARBIT_RATE
 |

274 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

275 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

276 
SND_PCM_HW_PARBIT_PERIODS
 |

277 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

278 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

279 
SND_PCM_HW_PARBIT_TICK_TIME
);

280 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

281 i‡(
îr
 < 0)

282  
îr
;

284 
	}
}

286 
	$¢d_pcm_löór_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

288  
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

289 
¢d_pcm_löór_hw_ªföe_˝ª∑ª
,

290 
¢d_pcm_löór_hw_ªföe_cch™ge
,

291 
¢d_pcm_löór_hw_ªföe_•ª∑ª
,

292 
¢d_pcm_löór_hw_ªföe_sch™ge
,

293 
¢d_pcm_gíîic_hw_ªföe
);

294 
	}
}

296 
	$¢d_pcm_löór_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

298 
¢d_pcm_löór_t
 *
löór
 = 
pcm
->
¥iv©e_d©a
;

299 
¢d_pcm_f‹m©_t
 
f‹m©
;

300 
îr
 = 
	`¢d_pcm_hw_∑øms_¶ave
(
pcm
, 
∑øms
,

301 
¢d_pcm_löór_hw_ªföe_cch™ge
,

302 
¢d_pcm_löór_hw_ªföe_•ª∑ª
,

303 
¢d_pcm_löór_hw_ªföe_sch™ge
,

304 
¢d_pcm_gíîic_hw_∑øms
);

305 i‡(
îr
 < 0)

306  
îr
;

307 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(
∑øms
, &
f‹m©
);

308 i‡(
îr
 < 0)

309  
îr
;

310 
löór
->
u£_gëput
 = (
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
) == 24 ||

311 
	`¢d_pcm_f‹m©_physiˇl_width
(
löór
->
sf‹m©
) == 24 ||

312 
	`¢d_pcm_f‹m©_width
(
f‹m©
) == 20 ||

313 
	`¢d_pcm_f‹m©_width
(
löór
->
sf‹m©
) == 20);

314 i‡(
löór
->
u£_gëput
) {

315 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

316 
löór
->
gë_idx
 = 
	`¢d_pcm_löór_gë_ödex
(
f‹m©
, 
SND_PCM_FORMAT_S32
);

317 
löór
->
put_idx
 = 
	`¢d_pcm_löór_put_ödex
(
SND_PCM_FORMAT_S32
,Üöór->
sf‹m©
);

319 
löór
->
gë_idx
 = 
	`¢d_pcm_löór_gë_ödex
÷öór->
sf‹m©
, 
SND_PCM_FORMAT_S32
);

320 
löór
->
put_idx
 = 
	`¢d_pcm_löór_put_ödex
(
SND_PCM_FORMAT_S32
, 
f‹m©
);

323 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

324 
löór
->
c⁄v_idx
 = 
	`¢d_pcm_löór_c⁄vît_ödex
(
f‹m©
,

325 
löór
->
sf‹m©
);

327 
löór
->
c⁄v_idx
 = 
	`¢d_pcm_löór_c⁄vît_ödex
÷öór->
sf‹m©
,

328 
f‹m©
);

331 
	}
}

333 
¢d_pcm_u‰ames_t


334 
	$¢d_pcm_löór_wrôe_¨ós
(
¢d_pcm_t
 *
pcm
,

335 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

336 
¢d_pcm_u‰ames_t
 
off£t
,

337 
¢d_pcm_u‰ames_t
 
size
,

338 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

339 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

340 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

342 
¢d_pcm_löór_t
 *
löór
 = 
pcm
->
¥iv©e_d©a
;

343 i‡(
size
 > *
¶ave_sizï
)

344 
size
 = *
¶ave_sizï
;

345 i‡(
löór
->
u£_gëput
)

346 
	`¢d_pcm_löór_gëput
(
¶ave_¨ós
, 
¶ave_off£t
,

347 
¨ós
, 
off£t
,

348 
pcm
->
ch™√ls
, 
size
,

349 
löór
->
gë_idx
,Üöór->
put_idx
);

351 
	`¢d_pcm_löór_c⁄vît
(
¶ave_¨ós
, 
¶ave_off£t
,

352 
¨ós
, 
off£t
,

353 
pcm
->
ch™√ls
, 
size
, 
löór
->
c⁄v_idx
);

354 *
¶ave_sizï
 = 
size
;

355  
size
;

356 
	}
}

358 
¢d_pcm_u‰ames_t


359 
	$¢d_pcm_löór_ªad_¨ós
(
¢d_pcm_t
 *
pcm
,

360 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

361 
¢d_pcm_u‰ames_t
 
off£t
,

362 
¢d_pcm_u‰ames_t
 
size
,

363 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

364 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

365 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

367 
¢d_pcm_löór_t
 *
löór
 = 
pcm
->
¥iv©e_d©a
;

368 i‡(
size
 > *
¶ave_sizï
)

369 
size
 = *
¶ave_sizï
;

370 i‡(
löór
->
u£_gëput
)

371 
	`¢d_pcm_löór_gëput
(
¨ós
, 
off£t
,

372 
¶ave_¨ós
, 
¶ave_off£t
,

373 
pcm
->
ch™√ls
, 
size
,

374 
löór
->
gë_idx
,Üöór->
put_idx
);

376 
	`¢d_pcm_löór_c⁄vît
(
¨ós
, 
off£t
,

377 
¶ave_¨ós
, 
¶ave_off£t
,

378 
pcm
->
ch™√ls
, 
size
, 
löór
->
c⁄v_idx
);

379 *
¶ave_sizï
 = 
size
;

380  
size
;

381 
	}
}

383 
	$¢d_pcm_löór_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

385 
¢d_pcm_löór_t
 *
löór
 = 
pcm
->
¥iv©e_d©a
;

386 
	`¢d_ouçut_¥ötf
(
out
, "Linear conversion PCM (%s)\n",

387 
	`¢d_pcm_f‹m©_«me
(
löór
->
sf‹m©
));

388 i‡(
pcm
->
£tup
) {

389 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

390 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

392 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

393 
	`¢d_pcm_dump
(
löór
->
∂ug
.
gí
.
¶ave
, 
out
);

394 
	}
}

396 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_löór_›s
 = {

397 .
˛o£
 = 
¢d_pcm_gíîic_˛o£
,

398 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

399 .
	ghw_ªföe
 = 
¢d_pcm_löór_hw_ªföe
,

400 .
	ghw_∑øms
 = 
¢d_pcm_löór_hw_∑øms
,

401 .
	ghw_‰ì
 = 
¢d_pcm_gíîic_hw_‰ì
,

402 .
	gsw_∑øms
 = 
¢d_pcm_gíîic_sw_∑øms
,

403 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

404 .
	gdump
 = 
¢d_pcm_löór_dump
,

405 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

406 .
	gasync
 = 
¢d_pcm_gíîic_async
,

407 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

408 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

409 .
	gquîy_chm≠s
 = 
¢d_pcm_gíîic_quîy_chm≠s
,

410 .
	ggë_chm≠
 = 
¢d_pcm_gíîic_gë_chm≠
,

411 .
	g£t_chm≠
 = 
¢d_pcm_gíîic_£t_chm≠
,

427 
	$¢d_pcm_löór_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
, 
¢d_pcm_f‹m©_t
 
sf‹m©
, snd_pcm_à*
¶ave
, 
˛o£_¶ave
)

429 
¢d_pcm_t
 *
pcm
;

430 
¢d_pcm_löór_t
 *
löór
;

431 
îr
;

432 
	`as£π
(
pcmp
 && 
¶ave
);

433 i‡(
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1)

434  -
EINVAL
;

435 
löór
 = 
	`ˇŒoc
(1, (
¢d_pcm_löór_t
));

436 i‡(!
löór
) {

437  -
ENOMEM
;

439 
	`¢d_pcm_∂ugö_öô
(&
löór
->
∂ug
);

440 
löór
->
sf‹m©
 = sformat;

441 
löór
->
∂ug
.
ªad
 = 
¢d_pcm_löór_ªad_¨ós
;

442 
löór
->
∂ug
.
wrôe
 = 
¢d_pcm_löór_wrôe_¨ós
;

443 
löór
->
∂ug
.
undo_ªad
 = 
¢d_pcm_∂ugö_undo_ªad_gíîic
;

444 
löór
->
∂ug
.
undo_wrôe
 = 
¢d_pcm_∂ugö_undo_wrôe_gíîic
;

445 
löór
->
∂ug
.
gí
.
¶ave
 = slave;

446 
löór
->
∂ug
.
gí
.
˛o£_¶ave
 = close_slave;

448 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_LINEAR
, 
«me
, 
¶ave
->
°ªam
, sœve->
mode
);

449 i‡(
îr
 < 0) {

450 
	`‰ì
(
löór
);

451  
îr
;

453 
pcm
->
›s
 = &
¢d_pcm_löór_›s
;

454 
pcm
->
Á°_›s
 = &
¢d_pcm_∂ugö_Á°_›s
;

455 
pcm
->
¥iv©e_d©a
 = 
löór
;

456 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

457 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

458 
pcm
->
t°amp_ty≥
 = 
¶ave
->tstamp_type;

459 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
löór
->
∂ug
.
hw_±r
, -1, 0);

460 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
löór
->
∂ug
.
≠∂_±r
, -1, 0);

461 *
pcmp
 = 
pcm
;

464 
	}
}

509 
	$_¢d_pcm_löór_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

510 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

511 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

513 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

514 
îr
;

515 
¢d_pcm_t
 *
•cm
;

516 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

517 
¢d_pcm_f‹m©_t
 
sf‹m©
;

518 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

519 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

520 c⁄° *
id
;

521 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

523 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

525 i‡(
	`°rcmp
(
id
, "slave") == 0) {

526 
¶ave
 = 
n
;

529 
	`SNDERR
("Unknow¿fõld %s", 
id
);

530  -
EINVAL
;

532 i‡(!
¶ave
) {

533 
	`SNDERR
("slave isÇot defined");

534  -
EINVAL
;

536 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 1,

537 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_MANDATORY
, &
sf‹m©
);

538 i‡(
îr
 < 0)

539  
îr
;

540 i‡(
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1) {

541 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

542 
	`SNDERR
("slave format isÇotÜinear");

543  -
EINVAL
;

545 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

546 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

547 i‡(
îr
 < 0)

548  
îr
;

549 
îr
 = 
	`¢d_pcm_löór_›í
(
pcmp
, 
«me
, 
sf‹m©
, 
•cm
, 1);

550 i‡(
îr
 < 0)

551 
	`¢d_pcm_˛o£
(
•cm
);

552  
îr
;

553 
	}
}

554 #i‚de‡
DOC_HIDDEN


555 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_löór_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_local.h

23 #i‚de‡
__PCM_LOCAL_H


24 
	#__PCM_LOCAL_H


	)

26 
	~"c⁄fig.h
"

28 
	~<°dio.h
>

29 
	~<°dlib.h
>

30 
	~<limôs.h
>

31 
	~<sys/uio.h
>

32 
	~<time.h
>

33 
	~<sys/time.h
>

35 
	#_¢d_mask
 
¢drv_mask


	)

36 
	#_¢d_pcm_ac˚ss_mask
 
_¢d_mask


	)

37 
	#_¢d_pcm_f‹m©_mask
 
_¢d_mask


	)

38 
	#_¢d_pcm_subf‹m©_mask
 
_¢d_mask


	)

40 
	~"loˇl.h
"

42 #ifde‡
THREAD_SAFE_API


43 
	#__USE_UNIX98
 1

	)

44 
	~<±hªad.h
>

47 
	#SND_INTERVAL_INLINE


	)

48 
	~"öãrvÆ.h
"

50 
	#SND_MASK_INLINE


	)

51 
	~"mask.h
"

53 
	#SND_PCM_HW_PARAM_ACCESS
 
SNDRV_PCM_HW_PARAM_ACCESS


	)

54 
	#SND_PCM_HW_PARAM_FORMAT
 
SNDRV_PCM_HW_PARAM_FORMAT


	)

55 
	#SND_PCM_HW_PARAM_SUBFORMAT
 
SNDRV_PCM_HW_PARAM_SUBFORMAT


	)

56 
	#SND_PCM_HW_PARAM_SAMPLE_BITS
 
SNDRV_PCM_HW_PARAM_SAMPLE_BITS


	)

57 
	#SND_PCM_HW_PARAM_FRAME_BITS
 
SNDRV_PCM_HW_PARAM_FRAME_BITS


	)

58 
	#SND_PCM_HW_PARAM_CHANNELS
 
SNDRV_PCM_HW_PARAM_CHANNELS


	)

59 
	#SND_PCM_HW_PARAM_RATE
 
SNDRV_PCM_HW_PARAM_RATE


	)

60 
	#SND_PCM_HW_PARAM_PERIOD_TIME
 
SNDRV_PCM_HW_PARAM_PERIOD_TIME


	)

61 
	#SND_PCM_HW_PARAM_PERIOD_SIZE
 
SNDRV_PCM_HW_PARAM_PERIOD_SIZE


	)

62 
	#SND_PCM_HW_PARAM_PERIOD_BYTES
 
SNDRV_PCM_HW_PARAM_PERIOD_BYTES


	)

63 
	#SND_PCM_HW_PARAM_PERIODS
 
SNDRV_PCM_HW_PARAM_PERIODS


	)

64 
	#SND_PCM_HW_PARAM_BUFFER_TIME
 
SNDRV_PCM_HW_PARAM_BUFFER_TIME


	)

65 
	#SND_PCM_HW_PARAM_BUFFER_SIZE
 
SNDRV_PCM_HW_PARAM_BUFFER_SIZE


	)

66 
	#SND_PCM_HW_PARAM_BUFFER_BYTES
 
SNDRV_PCM_HW_PARAM_BUFFER_BYTES


	)

67 
	#SND_PCM_HW_PARAM_TICK_TIME
 
SNDRV_PCM_HW_PARAM_TICK_TIME


	)

68 
	#SND_PCM_HW_PARAM_LAST_MASK
 
SNDRV_PCM_HW_PARAM_LAST_MASK


	)

69 
	#SND_PCM_HW_PARAM_FIRST_MASK
 
SNDRV_PCM_HW_PARAM_FIRST_MASK


	)

70 
	#SND_PCM_HW_PARAM_LAST_INTERVAL
 
SNDRV_PCM_HW_PARAM_LAST_INTERVAL


	)

71 
	#SND_PCM_HW_PARAM_FIRST_INTERVAL
 
SNDRV_PCM_HW_PARAM_FIRST_INTERVAL


	)

74 
	#SND_PCM_INFO_MMAP
 
SNDRV_PCM_INFO_MMAP


	)

76 
	#SND_PCM_INFO_MMAP_VALID
 
SNDRV_PCM_INFO_MMAP_VALID


	)

78 
	#SND_PCM_INFO_DOUBLE
 
SNDRV_PCM_INFO_DOUBLE


	)

80 
	#SND_PCM_INFO_BATCH
 
SNDRV_PCM_INFO_BATCH


	)

82 
	#SND_PCM_INFO_PERFECT_DRAIN
 
SNDRV_PCM_INFO_PERFECT_DRAIN


	)

84 
	#SND_PCM_INFO_INTERLEAVED
 
SNDRV_PCM_INFO_INTERLEAVED


	)

86 
	#SND_PCM_INFO_NONINTERLEAVED
 
SNDRV_PCM_INFO_NONINTERLEAVED


	)

88 
	#SND_PCM_INFO_COMPLEX
 
SNDRV_PCM_INFO_COMPLEX


	)

90 
	#SND_PCM_INFO_BLOCK_TRANSFER
 
SNDRV_PCM_INFO_BLOCK_TRANSFER


	)

92 
	#SND_PCM_INFO_OVERRANGE
 
SNDRV_PCM_INFO_OVERRANGE


	)

94 
	#SND_PCM_INFO_RESUME
 
SNDRV_PCM_INFO_RESUME


	)

96 
	#SND_PCM_INFO_PAUSE
 
SNDRV_PCM_INFO_PAUSE


	)

98 
	#SND_PCM_INFO_HALF_DUPLEX
 
SNDRV_PCM_INFO_HALF_DUPLEX


	)

100 
	#SND_PCM_INFO_JOINT_DUPLEX
 
SNDRV_PCM_INFO_JOINT_DUPLEX


	)

102 
	#SND_PCM_INFO_SYNC_START
 
SNDRV_PCM_INFO_SYNC_START


	)

104 
	#SND_PCM_INFO_NO_PERIOD_WAKEUP
 
SNDRV_PCM_INFO_NO_PERIOD_WAKEUP


	)

106 
	#SND_PCM_HW_PARAMS_NORESAMPLE
 
SNDRV_PCM_HW_PARAMS_NORESAMPLE


	)

107 
	#SND_PCM_HW_PARAMS_EXPORT_BUFFER
 
SNDRV_PCM_HW_PARAMS_EXPORT_BUFFER


	)

108 
	#SND_PCM_HW_PARAMS_NO_PERIOD_WAKEUP
 
SNDRV_PCM_HW_PARAMS_NO_PERIOD_WAKEUP


	)

109 
	#SND_PCM_HW_PARAMS_NO_DRAIN_SILENCE
 
SNDRV_PCM_HW_PARAMS_NO_DRAIN_SILENCE


	)

111 
	#SND_PCM_INFO_MONOTONIC
 0x80000000

	)

113 
	s_¢d_pcm_rb±r
 {

114 
¢d_pcm_t
 *
	mma°î
;

115 vﬁ©ûê
¢d_pcm_u‰ames_t
 *
	m±r
;

116 
	mfd
;

117 
off_t
 
	moff£t
;

118 
	mlök_d°_cou¡
;

119 
¢d_pcm_t
 **
	mlök_d°
;

120 *
	m¥iv©e_d©a
;

121 (*
	mch™ged
)(
¢d_pcm_t
 *
	mpcm
, snd_pcm_à*
	m§c
);

122 } 
	t¢d_pcm_rb±r_t
;

124 
	s_¢d_pcm_ch™√l_öfo
 {

125 
	mch™√l
;

126 *
	maddr
;

127 
	mfú°
;

128 
	m°ï
;

129 íum { 
	mSND_PCM_AREA_SHM
, 
	mSND_PCM_AREA_MMAP
, 
	mSND_PCM_AREA_LOCAL
 } 
	mty≥
;

132 
¢d_shm_¨ó
 *
	m¨ó
;

133 
	mshmid
;

134 } 
	mshm
;

136 
	mfd
;

137 
off_t
 
	moff£t
;

138 } 
	mmm≠
;

139 } 
	mu
;

140 
	mª£rved
[64];

141 } 
	t¢d_pcm_ch™√l_öfo_t
;

144 (*
	m˛o£
)(
¢d_pcm_t
 *
	mpcm
);

145 (*
	mn⁄block
)(
¢d_pcm_t
 *
	mpcm
, nonblock);

146 (*
	masync
)(
¢d_pcm_t
 *
	mpcm
, 
	msig
, 
pid_t
 
	mpid
);

147 (*
	möfo
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_öfo_t
 *info);

148 (*
	mhw_ªföe
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_hw_∑øms_t
 *
	m∑øms
);

149 (*
	mhw_∑øms
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_hw_∑øms_t
 *
	m∑øms
);

150 (*
	mhw_‰ì
)(
¢d_pcm_t
 *
	mpcm
);

151 (*
	msw_∑øms
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_sw_∑øms_t
 *
	m∑øms
);

152 (*
	mch™√l_öfo
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_ch™√l_öfo_t
 *
	möfo
);

153 (*
	mdump
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_ouçut_t
 *
	mout
);

154 (*
	mmm≠
)(
¢d_pcm_t
 *
	mpcm
);

155 (*
	mmunm≠
)(
¢d_pcm_t
 *
	mpcm
);

156 
	m¢d_pcm_chm≠_quîy_t
 **(*
	mquîy_chm≠s
)(
¢d_pcm_t
 *
	mpcm
);

157 
	m¢d_pcm_chm≠_t
 *(*
	mgë_chm≠
)(
¢d_pcm_t
 *
	mpcm
);

158 (*
	m£t_chm≠
)(
¢d_pcm_t
 *
	mpcm
, c⁄° 
¢d_pcm_chm≠_t
 *
	mm≠
);

159 } 
	t¢d_pcm_›s_t
;

162 (*
	m°©us
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_°©us_t
 *status);

163 (*
	m¥ï¨e
)(
¢d_pcm_t
 *
	mpcm
);

164 (*
	mª£t
)(
¢d_pcm_t
 *
	mpcm
);

165 (*
	m°¨t
)(
¢d_pcm_t
 *
	mpcm
);

166 (*
	mdr›
)(
¢d_pcm_t
 *
	mpcm
);

167 (*
	mdøö
)(
¢d_pcm_t
 *
	mpcm
);

168 (*
	m∑u£
)(
¢d_pcm_t
 *
	mpcm
, 
	míabÀ
);

169 
¢d_pcm_°©e_t
 (*
°©e
)(
¢d_pcm_t
 *
	mpcm
);

170 (*
	mhwsync
)(
¢d_pcm_t
 *
	mpcm
);

171 (*
	mdñay
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_s‰ames_t
 *
	mdñayp
);

172 (*
	mªsume
)(
¢d_pcm_t
 *
	mpcm
);

173 (*
	mlök
)(
¢d_pcm_t
 *
	mpcm1
, snd_pcm_à*
	mpcm2
);

174 (*
	mlök_¶aves
)(
¢d_pcm_t
 *
	mpcm
, snd_pcm_à*
	mma°î
);

175 (*
	mu∆ök
)(
¢d_pcm_t
 *
	mpcm
);

176 
¢d_pcm_s‰ames_t
 (*
ªwödabÀ
)(
¢d_pcm_t
 *
	mpcm
);

177 
¢d_pcm_s‰ames_t
 (*
ªwöd
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_u‰ames_t
 
	m‰ames
);

178 
¢d_pcm_s‰ames_t
 (*
f‹w¨dabÀ
)(
¢d_pcm_t
 *
	mpcm
);

179 
¢d_pcm_s‰ames_t
 (*
f‹w¨d
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_u‰ames_t
 
	m‰ames
);

180 
¢d_pcm_s‰ames_t
 (*
wrôei
)(
¢d_pcm_t
 *
	mpcm
, c⁄° *
	mbuf„r
, 
¢d_pcm_u‰ames_t
 
	msize
);

181 
¢d_pcm_s‰ames_t
 (*
wrôí
)(
¢d_pcm_t
 *
	mpcm
, **
	mbufs
, 
¢d_pcm_u‰ames_t
 
	msize
);

182 
¢d_pcm_s‰ames_t
 (*
ªadi
)(
¢d_pcm_t
 *
	mpcm
, *
	mbuf„r
, 
¢d_pcm_u‰ames_t
 
	msize
);

183 
¢d_pcm_s‰ames_t
 (*
ªadn
)(
¢d_pcm_t
 *
	mpcm
, **
	mbufs
, 
¢d_pcm_u‰ames_t
 
	msize
);

184 
¢d_pcm_s‰ames_t
 (*
avaû_upd©e
)(
¢d_pcm_t
 *
	mpcm
);

185 
¢d_pcm_s‰ames_t
 (*
mm≠_commô
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_u‰ames_t
 
	moff£t
, snd_pcm_u‰ames_à
	msize
);

186 (*
	mhtime°amp
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_u‰ames_t
 *
	mavaû
, 
¢d_htime°amp_t
 *
	mt°amp
);

187 (*
	mpﬁl_des¸ùt‹s_cou¡
)(
¢d_pcm_t
 *
	mpcm
);

188 (*
	mpﬁl_des¸ùt‹s
)(
¢d_pcm_t
 *
	mpcm
, 
pﬁlfd
 *
	mpfds
, 
	m•a˚
);

189 (*
	mpﬁl_ªvíts
)(
¢d_pcm_t
 *
	mpcm
, 
pﬁlfd
 *
	mpfds
, 
	mnfds
, *
	mªvíts
);

190 (*
	mmay_waô_f‹_avaû_mö
)(
¢d_pcm_t
 *
	mpcm
, 
¢d_pcm_u‰ames_t
 
	mavaû
);

191 (*
	mmm≠_begö
)(
¢d_pcm_t
 *
	mpcm
, c⁄° 
¢d_pcm_ch™√l_¨ó_t
 **
	m¨ós
, 
¢d_pcm_u‰ames_t
 *
	moff£t
, snd_pcm_u‰ames_à*
	m‰ames
);

192 } 
	t¢d_pcm_Á°_›s_t
;

194 
	s_¢d_pcm
 {

195 *
	m›í_func
;

196 *
	m«me
;

197 
¢d_pcm_ty≥_t
 
	mty≥
;

198 
¢d_pcm_°ªam_t
 
	m°ªam
;

199 
	mmode
;

200 
	mmö≥riodtime
;

201 
	mpﬁl_fd_cou¡
;

202 
	mpﬁl_fd
;

203 
	mpﬁl_evíts
;

204 
	m£tup
: 1,

205 
	mcom∑t
: 1;

206 
¢d_pcm_ac˚ss_t
 
	mac˚ss
;

207 
¢d_pcm_f‹m©_t
 
	mf‹m©
;

208 
¢d_pcm_subf‹m©_t
 
	msubf‹m©
;

209 
	mch™√ls
;

210 
	møã
;

211 
¢d_pcm_u‰ames_t
 
	m≥riod_size
;

212 
	m≥riod_time
;

213 
¢d_öãrvÆ_t
 
	m≥riods
;

214 
¢d_pcm_t°amp_t
 
	mt°amp_mode
;

215 
¢d_pcm_t°amp_ty≥_t
 
	mt°amp_ty≥
;

216 
	m≥riod_°ï
;

217 
¢d_pcm_u‰ames_t
 
	mavaû_mö
;

218 
	m≥riod_evít
;

219 
¢d_pcm_u‰ames_t
 
	m°¨t_thªshﬁd
;

220 
¢d_pcm_u‰ames_t
 
	m°›_thªshﬁd
;

221 
¢d_pcm_u‰ames_t
 
	msûí˚_thªshﬁd
;

223 
¢d_pcm_u‰ames_t
 
	msûí˚_size
;

224 
¢d_pcm_u‰ames_t
 
	mbound¨y
;

225 
	möfo
;

226 
	mmsbôs
;

227 
	møã_num
;

228 
	møã_dí
;

229 
	mhw_Êags
;

230 
¢d_pcm_u‰ames_t
 
	mfifo_size
;

231 
¢d_pcm_u‰ames_t
 
	mbuf„r_size
;

232 
¢d_öãrvÆ_t
 
	mbuf„r_time
;

233 
	mßm∂e_bôs
;

234 
	m‰ame_bôs
;

235 
¢d_pcm_rb±r_t
 
	m≠∂
;

236 
¢d_pcm_rb±r_t
 
	mhw
;

237 
¢d_pcm_u‰ames_t
 
	mmö_Æign
;

238 
	mmm≠_rw
: 1;

239 
	mmm≠_shadow
: 1;

242 
	md⁄Ÿ_˛o£
: 1;

243 
	mown_°©e_check
:1;

244 
¢d_pcm_ch™√l_öfo_t
 *
	mmm≠_ch™√ls
;

245 
¢d_pcm_ch™√l_¨ó_t
 *
	mru¬ög_¨ós
;

246 
¢d_pcm_ch™√l_¨ó_t
 *
	m°›≥d_¨ós
;

247 c⁄° 
¢d_pcm_›s_t
 *
	m›s
;

248 c⁄° 
¢d_pcm_Á°_›s_t
 *
	mÁ°_›s
;

249 
¢d_pcm_t
 *
	m›_¨g
;

250 
¢d_pcm_t
 *
	mÁ°_›_¨g
;

251 *
	m¥iv©e_d©a
;

252 
li°_hód
 
	masync_h™dÀrs
;

253 #ifde‡
THREAD_SAFE_API


254 
	m√ed_lock
;

257 
	mlock_íabÀd
;

260 
±hªad_muãx_t
 
	mlock
;

275 
	#¢d_pcm_√w
 \

276 
¢d1_pcm_√w


	)

277 
	#¢d_pcm_‰ì
 \

278 
¢d1_pcm_‰ì


	)

279 
	#¢d_pcm_¨ós_‰om_buf
 \

280 
¢d1_pcm_¨ós_‰om_buf


	)

281 
	#¢d_pcm_¨ós_‰om_bufs
 \

282 
¢d1_pcm_¨ós_‰om_bufs


	)

283 
	#¢d_pcm_›í_«med_¶ave
 \

284 
¢d1_pcm_›í_«med_¶ave


	)

285 
	#¢d_pcm_hw_›í_fd
 \

286 
¢d1_pcm_hw_›í_fd


	)

287 
	#¢d_pcm_waô_nocheck
 \

288 
¢d1_pcm_waô_nocheck


	)

289 
	#¢d_pcm_øã_gë_deÁu…_c⁄vîãr
 \

290 
¢d1_pcm_øã_gë_deÁu…_c⁄vîãr


	)

291 
	#¢d_pcm_£t_hw_±r
 \

292 
¢d1_pcm_£t_hw_±r


	)

293 
	#¢d_pcm_£t_≠∂_±r
 \

294 
¢d1_pcm_£t_≠∂_±r


	)

295 
	#¢d_pcm_lök_hw_±r
 \

296 
¢d1_pcm_lök_hw_±r


	)

297 
	#¢d_pcm_lök_≠∂_±r
 \

298 
¢d1_pcm_lök_≠∂_±r


	)

299 
	#¢d_pcm_u∆ök_hw_±r
 \

300 
¢d1_pcm_u∆ök_hw_±r


	)

301 
	#¢d_pcm_u∆ök_≠∂_±r
 \

302 
¢d1_pcm_u∆ök_≠∂_±r


	)

303 
	#¢d_pcm_mm≠_≠∂_±r
 \

304 
¢d1_pcm_mm≠_≠∂_±r


	)

305 
	#¢d_pcm_mm≠_≠∂_backw¨d
 \

306 
¢d1_pcm_mm≠_≠∂_backw¨d


	)

307 
	#¢d_pcm_mm≠_≠∂_f‹w¨d
 \

308 
¢d1_pcm_mm≠_≠∂_f‹w¨d


	)

309 
	#¢d_pcm_mm≠_hw_backw¨d
 \

310 
¢d1_pcm_mm≠_hw_backw¨d


	)

311 
	#¢d_pcm_mm≠_hw_f‹w¨d
 \

312 
¢d1_pcm_mm≠_hw_f‹w¨d


	)

313 
	#¢d_pcm_ªad_¨ós
 \

314 
¢d1_pcm_ªad_¨ós


	)

315 
	#¢d_pcm_wrôe_¨ós
 \

316 
¢d1_pcm_wrôe_¨ós


	)

317 
	#¢d_pcm_ªad_mm≠
 \

318 
¢d1_pcm_ªad_mm≠


	)

319 
	#¢d_pcm_wrôe_mm≠
 \

320 
¢d1_pcm_wrôe_mm≠


	)

321 
	#¢d_pcm_ch™√l_öfo_shm
 \

322 
¢d1_pcm_ch™√l_öfo_shm


	)

323 
	#¢d_pcm_hw_ªföe_so·
 \

324 
¢d1_pcm_hw_ªföe_so·


	)

325 
	#¢d_pcm_hw_ªföe_¶ave
 \

326 
¢d1_pcm_hw_ªföe_¶ave


	)

327 
	#¢d_pcm_hw_∑øms_¶ave
 \

328 
¢d1_pcm_hw_∑øms_¶ave


	)

329 
	#¢d_pcm_hw_∑øm_ªföe_√¨
 \

330 
¢d1_pcm_hw_∑øm_ªföe_√¨


	)

331 
	#¢d_pcm_hw_∑øm_ªföe_mu…ùÀ
 \

332 
¢d1_pcm_hw_∑øm_ªföe_mu…ùÀ


	)

333 
	#¢d_pcm_hw_∑øm_em±y
 \

334 
¢d1_pcm_hw_∑øm_em±y


	)

335 
	#¢d_pcm_hw_∑øm_Æways_eq
 \

336 
¢d1_pcm_hw_∑øm_Æways_eq


	)

337 
	#¢d_pcm_hw_∑øm_√vî_eq
 \

338 
¢d1_pcm_hw_∑øm_√vî_eq


	)

339 
	#¢d_pcm_hw_∑øm_gë_mask
 \

340 
¢d1_pcm_hw_∑øm_gë_mask


	)

341 
	#¢d_pcm_hw_∑øm_gë_öãrvÆ
 \

342 
¢d1_pcm_hw_∑øm_gë_öãrvÆ


	)

343 
	#¢d_pcm_hw_∑øm_™y
 \

344 
¢d1_pcm_hw_∑øm_™y


	)

345 
	#¢d_pcm_hw_∑øm_£t_öãgî
 \

346 
¢d1_pcm_hw_∑øm_£t_öãgî


	)

347 
	#¢d_pcm_hw_∑øm_£t_fú°
 \

348 
¢d1_pcm_hw_∑øm_£t_fú°


	)

349 
	#¢d_pcm_hw_∑øm_£t_œ°
 \

350 
¢d1_pcm_hw_∑øm_£t_œ°


	)

351 
	#¢d_pcm_hw_∑øm_£t_√¨
 \

352 
¢d1_pcm_hw_∑øm_£t_√¨


	)

353 
	#¢d_pcm_hw_∑øm_£t_mö
 \

354 
¢d1_pcm_hw_∑øm_£t_mö


	)

355 
	#¢d_pcm_hw_∑øm_£t_max
 \

356 
¢d1_pcm_hw_∑øm_£t_max


	)

357 
	#¢d_pcm_hw_∑øm_£t_mömax
 \

358 
¢d1_pcm_hw_∑øm_£t_mömax


	)

359 
	#¢d_pcm_hw_∑øm_£t
 \

360 
¢d1_pcm_hw_∑øm_£t


	)

361 
	#¢d_pcm_hw_∑øm_£t_mask
 \

362 
¢d1_pcm_hw_∑øm_£t_mask


	)

363 
	#¢d_pcm_hw_∑øm_gë
 \

364 
¢d1_pcm_hw_∑øm_gë


	)

365 
	#¢d_pcm_hw_∑øm_gë_mö
 \

366 
¢d1_pcm_hw_∑øm_gë_mö


	)

367 
	#¢d_pcm_hw_∑øm_gë_max
 \

368 
¢d1_pcm_hw_∑øm_gë_max


	)

369 
	#¢d_pcm_hw_∑øm_«me
 \

370 
¢d1_pcm_hw_∑øm_«me


	)

371 
	#¢d_pcm_sw_∑øms_cuºít_no_lock
 \

372 
¢d1_pcm_sw_∑øms_cuºít_no_lock


	)

374 
¢d_pcm_√w
(
¢d_pcm_t
 **
pcmp
, 
¢d_pcm_ty≥_t
 
ty≥
, c⁄° *
«me
,

375 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
);

376 
¢d_pcm_‰ì
(
¢d_pcm_t
 *
pcm
);

378 
¢d_pcm_¨ós_‰om_buf
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
, *
buf
);

379 
¢d_pcm_¨ós_‰om_bufs
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
, **
bufs
);

381 
¢d_pcm_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
);

382 
¢d_pcm_mm≠
(
¢d_pcm_t
 *
pcm
);

383 
¢d_pcm_munm≠
(
¢d_pcm_t
 *
pcm
);

384 
¢d_pcm_mm≠_ªady
(
¢d_pcm_t
 *
pcm
);

385 
¢d_pcm_£t_hw_±r
(
¢d_pcm_t
 *
pcm
, vﬁ©ûê
¢d_pcm_u‰ames_t
 *
hw_±r
, 
fd
, 
off_t
 
off£t
);

386 
¢d_pcm_£t_≠∂_±r
(
¢d_pcm_t
 *
pcm
, vﬁ©ûê
¢d_pcm_u‰ames_t
 *
≠∂_±r
, 
fd
, 
off_t
 
off£t
);

387 
¢d_pcm_lök_hw_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_à*
¶ave
);

388 
¢d_pcm_lök_≠∂_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_à*
¶ave
);

389 
¢d_pcm_u∆ök_hw_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_à*
¶ave
);

390 
¢d_pcm_u∆ök_≠∂_±r
(
¢d_pcm_t
 *
pcm
, snd_pcm_à*
¶ave
);

391 
¢d_pcm_s‰ames_t
 
¢d_pcm_mm≠_≠∂_±r
(
¢d_pcm_t
 *
pcm
, 
off_t
 
off£t
);

392 
¢d_pcm_mm≠_≠∂_backw¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
);

393 
¢d_pcm_mm≠_≠∂_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
);

394 
¢d_pcm_mm≠_hw_backw¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
);

395 
¢d_pcm_mm≠_hw_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
);

397 
¢d_pcm_sw_∑øms_cuºít_no_lock
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
);

399 
¢d_pcm_s‰ames_t
 
¢d_pcm_mm≠_wrôei
(
¢d_pcm_t
 *
pcm
, c⁄° *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
);

400 
¢d_pcm_s‰ames_t
 
¢d_pcm_mm≠_ªadi
(
¢d_pcm_t
 *
pcm
, *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
);

401 
¢d_pcm_s‰ames_t
 
¢d_pcm_mm≠_wrôí
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
);

402 
¢d_pcm_s‰ames_t
 
¢d_pcm_mm≠_ªadn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
);

404 
	$¢d_pcm_s‰ames_t
 (*
	t¢d_pcm_x„r_¨ós_func_t
)(
	t¢d_pcm_t
 *
	tpcm
,

405 c⁄° 
	t¢d_pcm_ch™√l_¨ó_t
 *
	t¨ós
,

406 
	t¢d_pcm_u‰ames_t
 
	toff£t
,

407 
	t¢d_pcm_u‰ames_t
 
	tsize
);

409 
¢d_pcm_s‰ames_t
 
	`¢d_pcm_ªad_¨ós
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

410 
¢d_pcm_u‰ames_t
 
off£t
, snd_pcm_u‰ames_à
size
,

411 
¢d_pcm_x„r_¨ós_func_t
 
func
);

412 
¢d_pcm_s‰ames_t
 
	`¢d_pcm_wrôe_¨ós
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

413 
¢d_pcm_u‰ames_t
 
off£t
, snd_pcm_u‰ames_à
size
,

414 
¢d_pcm_x„r_¨ós_func_t
 
func
);

415 
¢d_pcm_s‰ames_t
 
	`¢d_pcm_ªad_mm≠
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
off£t
,

416 
¢d_pcm_u‰ames_t
 
size
);

417 
¢d_pcm_s‰ames_t
 
	`¢d_pcm_wrôe_mm≠
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
off£t
,

418 
¢d_pcm_u‰ames_t
 
size
);

419 
ölöe
 
	$¢d_pcm_ch™√l_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_öfo_t
 *
öfo
)

421 i‡(!
pcm
->
›s
->
ch™√l_öfo
)

422  -
ENOSYS
;

423  
pcm
->
›s
->
	`ch™√l_öfo
’cm, 
öfo
);

424 
	}
}

425 
¢d_pcm_ch™√l_öfo_shm
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_öfo_t
 *
öfo
, 
shmid
);

426 
_¢d_pcm_pﬁl_des¸ùt‹
(
¢d_pcm_t
 *
pcm
);

427 
	#_¢d_pcm_lök_des¸ùt‹
 
_¢d_pcm_pﬁl_des¸ùt‹


	)

428 
	#_¢d_pcm_async_des¸ùt‹
 
_¢d_pcm_pﬁl_des¸ùt‹


	)

431 
__¢d_pcm_mm≠_begö_gíîic
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_ch™√l_¨ó_t
 **
¨ós
,

432 
¢d_pcm_u‰ames_t
 *
off£t
, snd_pcm_u‰ames_à*
‰ames
);

433 
__¢d_pcm_mm≠_begö
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_ch™√l_¨ó_t
 **
¨ós
,

434 
¢d_pcm_u‰ames_t
 *
off£t
, snd_pcm_u‰ames_à*
‰ames
);

435 
¢d_pcm_s‰ames_t
 
__¢d_pcm_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

436 
¢d_pcm_u‰ames_t
 
off£t
,

437 
¢d_pcm_u‰ames_t
 
‰ames
);

438 
__¢d_pcm_waô_ö_lock
(
¢d_pcm_t
 *
pcm
, 
timeout
);

440 
ölöe
 
¢d_pcm_s‰ames_t
 
	$__¢d_pcm_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

442 i‡(!
pcm
->
Á°_›s
->
avaû_upd©e
)

443  -
ENOSYS
;

444  
pcm
->
Á°_›s
->
	`avaû_upd©e
’cm->
Á°_›_¨g
);

445 
	}
}

447 
ölöe
 
	$__¢d_pcm_°¨t
(
¢d_pcm_t
 *
pcm
)

449 i‡(!
pcm
->
Á°_›s
->
°¨t
)

450  -
ENOSYS
;

451  
pcm
->
Á°_›s
->
	`°¨t
’cm->
Á°_›_¨g
);

452 
	}
}

454 
ölöe
 
¢d_pcm_°©e_t
 
	$__¢d_pcm_°©e
(
¢d_pcm_t
 *
pcm
)

456 i‡(!
pcm
->
Á°_›s
->
°©e
)

457  
SND_PCM_STATE_OPEN
;

458  
pcm
->
Á°_›s
->
	`°©e
’cm->
Á°_›_¨g
);

459 
	}
}

461 
ölöe
 
	$__¢d_pcm_hwsync
(
¢d_pcm_t
 *
pcm
)

463 i‡(!
pcm
->
Á°_›s
->
hwsync
)

464  -
ENOSYS
;

465  
pcm
->
Á°_›s
->
	`hwsync
’cm->
Á°_›_¨g
);

466 
	}
}

468 
ölöe
 
	$__¢d_pcm_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
)

470 i‡(!
pcm
->
Á°_›s
->
dñay
)

471  -
ENOSYS
;

472  
pcm
->
Á°_›s
->
	`dñay
’cm->
Á°_›_¨g
, 
dñayp
);

473 
	}
}

476 
ölöe
 
	$¢d_pcm_check_îr‹
(
¢d_pcm_t
 *
pcm
, 
îr
)

478 i‡(
îr
 =-
EINTR
) {

479 
	`__¢d_pcm_°©e
(
pcm
)) {

480 
SND_PCM_STATE_XRUN
:

481  -
EPIPE
;

482 
SND_PCM_STATE_SUSPENDED
:

483  -
ESTRPIPE
;

484 
SND_PCM_STATE_DISCONNECTED
:

485  -
ENODEV
;

490  
îr
;

491 
	}
}

500 
ölöe
 
¢d_pcm_u‰ames_t
 
	$__¢d_pcm_∂ayback_avaû
(
¢d_pcm_t
 *
pcm
,

501 c⁄° 
¢d_pcm_u‰ames_t
 
hw_±r
,

502 c⁄° 
¢d_pcm_u‰ames_t
 
≠∂_±r
)

504 
¢d_pcm_s‰ames_t
 
avaû
;

505 
avaû
 = 
hw_±r
 + 
pcm
->
buf„r_size
 - 
≠∂_±r
;

506 i‡(
avaû
 < 0)

507 
avaû
 +
pcm
->
bound¨y
;

508 i‡((
¢d_pcm_u‰ames_t
Ë
avaû
 >
pcm
->
bound¨y
)

509 
avaû
 -
pcm
->
bound¨y
;

510  
avaû
;

511 
	}
}

513 
ölöe
 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_mm≠_∂ayback_avaû
(
¢d_pcm_t
 *
pcm
)

515  
	`__¢d_pcm_∂ayback_avaû
(
pcm
, *pcm->
hw
.
±r
, *pcm->
≠∂
.ptr);

516 
	}
}

525 
ölöe
 
¢d_pcm_u‰ames_t
 
	$__¢d_pcm_ˇ±uª_avaû
(
¢d_pcm_t
 *
pcm
,

526 c⁄° 
¢d_pcm_u‰ames_t
 
hw_±r
,

527 c⁄° 
¢d_pcm_u‰ames_t
 
≠∂_±r
)

529 
¢d_pcm_s‰ames_t
 
avaû
;

530 
avaû
 = 
hw_±r
 - 
≠∂_±r
;

531 i‡(
avaû
 < 0)

532 
avaû
 +
pcm
->
bound¨y
;

533  
avaû
;

534 
	}
}

536 
ölöe
 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_mm≠_ˇ±uª_avaû
(
¢d_pcm_t
 *
pcm
)

538  
	`__¢d_pcm_ˇ±uª_avaû
(
pcm
, *pcm->
hw
.
±r
, *pcm->
≠∂
.ptr);

539 
	}
}

541 
ölöe
 
¢d_pcm_u‰ames_t
 
	$__¢d_pcm_avaû
(
¢d_pcm_t
 *
pcm
,

542 c⁄° 
¢d_pcm_u‰ames_t
 
hw_±r
,

543 c⁄° 
¢d_pcm_u‰ames_t
 
≠∂_±r
)

545 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

546  
	`__¢d_pcm_∂ayback_avaû
(
pcm
, 
hw_±r
, 
≠∂_±r
);

548  
	`__¢d_pcm_ˇ±uª_avaû
(
pcm
, 
hw_±r
, 
≠∂_±r
);

549 
	}
}

551 
ölöe
 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_mm≠_avaû
(
¢d_pcm_t
 *
pcm
)

553  
	`__¢d_pcm_avaû
(
pcm
, *pcm->
hw
.
±r
, *pcm->
≠∂
.ptr);

554 
	}
}

561 
ölöe
 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mm≠_∂ayback_hw_avaû
(
¢d_pcm_t
 *
pcm
)

563  
pcm
->
buf„r_size
 - 
	`¢d_pcm_mm≠_∂ayback_avaû
(pcm);

564 
	}
}

571 
ölöe
 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mm≠_ˇ±uª_hw_avaû
(
¢d_pcm_t
 *
pcm
)

573  
pcm
->
buf„r_size
 - 
	`¢d_pcm_mm≠_ˇ±uª_avaû
(pcm);

574 
	}
}

576 
ölöe
 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mm≠_hw_avaû
(
¢d_pcm_t
 *
pcm
)

578  
pcm
->
buf„r_size
 - 
	`¢d_pcm_mm≠_avaû
(pcm);

579 
	}
}

581 
ölöe
 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mm≠_∂ayback_hw_ªwödabÀ
(
¢d_pcm_t
 *
pcm
)

583 
¢d_pcm_s‰ames_t
 
ªt
 = 
	`¢d_pcm_mm≠_∂ayback_hw_avaû
(
pcm
);

584  (
ªt
 >= 0) ?Ñet : 0;

585 
	}
}

587 
ölöe
 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mm≠_ˇ±uª_hw_ªwödabÀ
(
¢d_pcm_t
 *
pcm
)

589 
¢d_pcm_s‰ames_t
 
ªt
 = 
	`¢d_pcm_mm≠_ˇ±uª_hw_avaû
(
pcm
);

590  (
ªt
 >= 0) ?Ñet : 0;

591 
	}
}

593 
ölöe
 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_mm≠_hw_ªwödabÀ
(
¢d_pcm_t
 *
pcm
)

595 
¢d_pcm_s‰ames_t
 
ªt
 = 
	`¢d_pcm_mm≠_hw_avaû
(
pcm
);

596  (
ªt
 >= 0) ?Ñet : 0;

597 
	}
}

599 
ölöe
 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
	$¢d_pcm_mm≠_¨ós
(
¢d_pcm_t
 *
pcm
)

601 i‡(
pcm
->
°›≥d_¨ós
 &&

602 
	`__¢d_pcm_°©e
(
pcm
Ë!
SND_PCM_STATE_RUNNING
)

603  
pcm
->
°›≥d_¨ós
;

604  
pcm
->
ru¬ög_¨ós
;

605 
	}
}

607 
ölöe
 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_mm≠_off£t
(
¢d_pcm_t
 *
pcm
)

609 
	`as£π
(
pcm
);

610  *
pcm
->
≠∂
.
±r
 %Öcm->
buf„r_size
;

611 
	}
}

613 
ölöe
 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_mm≠_hw_off£t
(
¢d_pcm_t
 *
pcm
)

615 
	`as£π
(
pcm
);

616  *
pcm
->
hw
.
±r
 %Öcm->
buf„r_size
;

617 
	}
}

622 
ölöe
 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_mm≠_∂ayback_dñay
(
¢d_pcm_t
 *
pcm
)

624  
	`¢d_pcm_mm≠_∂ayback_hw_avaû
(
pcm
);

625 
	}
}

630 
ölöe
 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_mm≠_ˇ±uª_dñay
(
¢d_pcm_t
 *
pcm
)

632  
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
pcm
);

633 
	}
}

635 
ölöe
 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mm≠_dñay
(
¢d_pcm_t
 *
pcm
)

637 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

638  
	`¢d_pcm_mm≠_∂ayback_dñay
(
pcm
);

640  
	`¢d_pcm_mm≠_ˇ±uª_dñay
(
pcm
);

641 
	}
}

643 
ölöe
 
¢d_pcm_s‰ames_t
 
	$_¢d_pcm_wrôei
(
¢d_pcm_t
 *
pcm
, c⁄° *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

646 i‡(!
pcm
->
Á°_›s
->
wrôei
)

647  -
ENOSYS
;

648  
pcm
->
Á°_›s
->
	`wrôei
’cm->
Á°_›_¨g
, 
buf„r
, 
size
);

649 
	}
}

651 
ölöe
 
¢d_pcm_s‰ames_t
 
	$_¢d_pcm_wrôí
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

654 i‡(!
pcm
->
Á°_›s
->
wrôí
)

655  -
ENOSYS
;

656  
pcm
->
Á°_›s
->
	`wrôí
’cm->
Á°_›_¨g
, 
bufs
, 
size
);

657 
	}
}

659 
ölöe
 
¢d_pcm_s‰ames_t
 
	$_¢d_pcm_ªadi
(
¢d_pcm_t
 *
pcm
, *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

662 i‡(!
pcm
->
Á°_›s
->
ªadi
)

663  -
ENOSYS
;

664  
pcm
->
Á°_›s
->
	`ªadi
’cm->
Á°_›_¨g
, 
buf„r
, 
size
);

665 
	}
}

667 
ölöe
 
¢d_pcm_s‰ames_t
 
	$_¢d_pcm_ªadn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

670 i‡(!
pcm
->
Á°_›s
->
ªadn
)

671  -
ENOSYS
;

672  
pcm
->
Á°_›s
->
	`ªadn
’cm->
Á°_›_¨g
, 
bufs
, 
size
);

673 
	}
}

675 
ölöe
 
	$muldiv
(
a
, 
b
, 
c
, *
r
)

677 
öt64_t
 
n
 = (öt64_t)
a
 * 
b
;

678 
öt64_t
 
v
 = 
n
 / 
c
;

679 i‡(
v
 > 
INT_MAX
) {

680 *
r
 = 0;

681  
INT_MAX
;

683 i‡(
v
 < 
INT_MIN
) {

684 *
r
 = 0;

685  
INT_MIN
;

687 *
r
 = 
n
 % 
c
;

688  
v
;

689 
	}
}

691 
ölöe
 
	$muldiv_down
(
a
, 
b
, 
c
)

693 
öt64_t
 
v
 = (öt64_t)
a
 * 
b
 / 
c
;

694 i‡(
v
 > 
INT_MAX
) {

695  
INT_MAX
;

697 i‡(
v
 < 
INT_MIN
) {

698  
INT_MIN
;

700  
v
;

701 
	}
}

703 
ölöe
 
	$muldiv_√¨
(
a
, 
b
, 
c
)

705 
r
;

706 
n
 = 
	`muldiv
(
a
, 
b
, 
c
, &
r
);

707 i‡(
r
 >(
c
 + 1) / 2)

708 
n
++;

709  
n
;

710 
	}
}

712 
¢d_pcm_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

713 
_¢d_pcm_hw_∑øms_öã∫Æ
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

714 #unde‡
_¢d_pcm_hw_∑øms


715 
¢d_pcm_hw_ªföe_so·
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

716 
¢d_pcm_hw_ªföe_¶ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

717 (*
˝ª∑ª
)(
¢d_pcm_t
 *
pcm
,

718 
¢d_pcm_hw_∑øms_t
 *
∑øms
),

719 (*
cch™ge
)(
¢d_pcm_t
 *
pcm
,

720 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

721 
¢d_pcm_hw_∑øms_t
 *
•¨ams
),

722 (*
•ª∑ª
)(
¢d_pcm_t
 *
pcm
,

723 
¢d_pcm_hw_∑øms_t
 *
∑øms
),

724 (*
sch™ge
)(
¢d_pcm_t
 *
pcm
,

725 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

726 
¢d_pcm_hw_∑øms_t
 *
•¨ams
),

727 (*
§eföe
)(
¢d_pcm_t
 *
pcm
,

728 
¢d_pcm_hw_∑øms_t
 *
•¨ams
));

729 
	`¢d_pcm_hw_∑øms_¶ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

730 (*
cch™ge
)(
¢d_pcm_t
 *
pcm
,

731 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

732 
¢d_pcm_hw_∑øms_t
 *
•¨ams
),

733 (*
•ª∑ª
)(
¢d_pcm_t
 *
pcm
,

734 
¢d_pcm_hw_∑øms_t
 *
∑øms
),

735 (*
sch™ge
)(
¢d_pcm_t
 *
pcm
,

736 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

737 
¢d_pcm_hw_∑øms_t
 *
•¨ams
),

738 (*
•¨ams
)(
¢d_pcm_t
 *
pcm
,

739 
¢d_pcm_hw_∑øms_t
 *
•¨ams
));

742 
	`_¢d_pcm_hw_∑øms_™y
(
¢d_pcm_hw_∑øms_t
 *
∑øms
);

743 
	`_¢d_pcm_hw_∑øm_£t_em±y
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

744 
¢d_pcm_hw_∑øm_t
 
v¨
);

745 
	`_¢d_pcm_hw_∑øm_£t_öãrvÆ
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

746 
¢d_pcm_hw_∑øm_t
 
v¨
,

747 c⁄° 
¢d_öãrvÆ_t
 *
vÆ
);

748 
	`_¢d_pcm_hw_∑øm_£t_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

749 
¢d_pcm_hw_∑øm_t
 
v¨
, c⁄° 
¢d_mask_t
 *
mask
);

750 
	`_¢d_pcm_hw_∑øm_fú°
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

751 
¢d_pcm_hw_∑øm_t
 
v¨
);

752 
	`_¢d_pcm_hw_∑øm_œ°
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

753 
¢d_pcm_hw_∑øm_t
 
v¨
);

754 
	`_¢d_pcm_hw_∑øm_£t
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

755 
¢d_pcm_hw_∑øm_t
 
v¨
, 
vÆ
, 
dú
);

756 
ölöe
 
	$_¢d_pcm_hw_∑øms_£t_f‹m©
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

757 
¢d_pcm_f‹m©_t
 
vÆ
)

759  
	`_¢d_pcm_hw_∑øm_£t
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
,

760 (Ë
vÆ
, 0);

761 
	}
}

763 
ölöe
 
	$_¢d_pcm_hw_∑øms_£t_subf‹m©
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

764 
¢d_pcm_subf‹m©_t
 
vÆ
)

766  
	`_¢d_pcm_hw_∑øm_£t
(
∑øms
, 
SND_PCM_HW_PARAM_SUBFORMAT
,

767 (Ë
vÆ
, 0);

768 
	}
}

770 
_¢d_pcm_hw_∑øm_£t_mö
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

771 
¢d_pcm_hw_∑øm_t
 
v¨
, 
vÆ
, 
dú
);

772 
_¢d_pcm_hw_∑øm_£t_max
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

773 
¢d_pcm_hw_∑øm_t
 
v¨
, 
vÆ
, 
dú
);

774 
_¢d_pcm_hw_∑øm_£t_mömax
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

775 
¢d_pcm_hw_∑øm_t
 
v¨
,

776 
mö
, 
mödú
,

777 
max
, 
maxdú
);

778 
_¢d_pcm_hw_∑øm_ªföe
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

779 
¢d_pcm_hw_∑øm_t
 
v¨
,

780 c⁄° 
¢d_pcm_hw_∑øms_t
 *
§c
);

781 
_¢d_pcm_hw_∑øms_ªföe
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

782 
v¨s
,

783 c⁄° 
¢d_pcm_hw_∑øms_t
 *
§c
);

784 
¢d_pcm_hw_∑øm_ªföe_√¨
(
¢d_pcm_t
 *
pcm
,

785 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

786 
¢d_pcm_hw_∑øm_t
 
v¨
,

787 c⁄° 
¢d_pcm_hw_∑øms_t
 *
§c
);

788 
¢d_pcm_hw_∑øm_ªföe_mu…ùÀ
(
¢d_pcm_t
 *
pcm
,

789 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

790 
¢d_pcm_hw_∑øm_t
 
v¨
,

791 c⁄° 
¢d_pcm_hw_∑øms_t
 *
§c
);

792 
¢d_pcm_hw_∑øm_em±y
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

793 
¢d_pcm_hw_∑øm_t
 
v¨
);

794 
¢d_pcm_hw_∑øm_Æways_eq
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

795 
¢d_pcm_hw_∑øm_t
 
v¨
,

796 c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms1
);

797 
¢d_pcm_hw_∑øm_√vî_eq
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

798 
¢d_pcm_hw_∑øm_t
 
v¨
,

799 c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms1
);

800 c⁄° 
¢d_mask_t
 *
¢d_pcm_hw_∑øm_gë_mask
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

801 
¢d_pcm_hw_∑øm_t
 
v¨
);

802 c⁄° 
¢d_öãrvÆ_t
 *
¢d_pcm_hw_∑øm_gë_öãrvÆ
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

803 
¢d_pcm_hw_∑øm_t
 
v¨
);

805 
¢d_pcm_hw_∑øm_™y
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

806 
¢d_pcm_hw_∑øm_t
 
v¨
);

807 
¢d_pcm_hw_∑øm_£t_öãgî
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

808 
¢d_£t_mode_t
 
mode
,

809 
¢d_pcm_hw_∑øm_t
 
v¨
);

810 
¢d_pcm_hw_∑øm_£t_fú°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

811 
¢d_pcm_hw_∑øm_t
 
v¨
, *
rvÆ
, *
dú
);

812 
¢d_pcm_hw_∑øm_£t_œ°
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

813 
¢d_pcm_hw_∑øm_t
 
v¨
, *
rvÆ
, *
dú
);

814 
¢d_pcm_hw_∑øm_£t_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

815 
¢d_pcm_hw_∑øm_t
 
v¨
, *
vÆ
, *
dú
);

816 
¢d_pcm_hw_∑øm_£t_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

817 
¢d_£t_mode_t
 
mode
,

818 
¢d_pcm_hw_∑øm_t
 
v¨
,

819 *
vÆ
, *
dú
);

820 
¢d_pcm_hw_∑øm_£t_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

821 
¢d_£t_mode_t
 
mode
,

822 
¢d_pcm_hw_∑øm_t
 
v¨
, *
vÆ
, *
dú
);

823 
¢d_pcm_hw_∑øm_£t_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

824 
¢d_£t_mode_t
 
mode
,

825 
¢d_pcm_hw_∑øm_t
 
v¨
,

826 *
mö
, *
mödú
,

827 *
max
, *
maxdú
);

828 
¢d_pcm_hw_∑øm_£t
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

829 
¢d_£t_mode_t
 
mode
,

830 
¢d_pcm_hw_∑øm_t
 
v¨
, 
vÆ
, 
dú
);

831 
¢d_pcm_hw_∑øm_£t_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

832 
¢d_£t_mode_t
 
mode
,

833 
¢d_pcm_hw_∑øm_t
 
v¨
, c⁄° 
¢d_mask_t
 *
mask
);

834 
¢d_pcm_hw_∑øm_gë
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_hw_∑øm_t
 
v¨
,

835 *
vÆ
, *
dú
);

836 
¢d_pcm_hw_∑øm_gë_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

837 
¢d_pcm_hw_∑øm_t
 
v¨
,

838 *
vÆ
, *
dú
);

839 
¢d_pcm_hw_∑øm_gë_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

840 
¢d_pcm_hw_∑øm_t
 
v¨
,

841 *
vÆ
, *
dú
);

843 #ifde‡
INTERNAL


844 
¢d_pcm_s‰ames_t
 
	$INTERNAL
(
¢d_pcm_f‹w¨d
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
);

846 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_ac˚ss
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 *
ac˚ss
);

847 
	`¢d_pcm_hw_∑øms_ã°_ac˚ss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 
ac˚ss
);

848 
	`¢d_pcm_hw_∑øms_£t_ac˚ss
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 
ac˚ss
);

849 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_ac˚ss_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 *
ac˚ss
);

850 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_ac˚ss_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_t
 *
ac˚ss
);

851 
	`¢d_pcm_hw_∑øms_£t_ac˚ss_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_mask_t
 *
mask
);

852 
	`¢d_pcm_hw_∑øms_gë_ac˚ss_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_ac˚ss_mask_t
 *
mask
);

854 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 *
vÆ
);

855 
	`¢d_pcm_hw_∑øms_ã°_f‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 
vÆ
);

856 
	`¢d_pcm_hw_∑øms_£t_f‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 
vÆ
);

857 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_f‹m©_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 *
f‹m©
);

858 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_f‹m©_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_t
 *
f‹m©
);

859 
	`¢d_pcm_hw_∑øms_£t_f‹m©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_mask_t
 *
mask
);

860 
	`¢d_pcm_hw_∑øms_gë_f‹m©_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_f‹m©_mask_t
 *
mask
);

862 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_subf‹m©
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 *
subf‹m©
);

863 
	`¢d_pcm_hw_∑øms_ã°_subf‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 
subf‹m©
);

864 
	`¢d_pcm_hw_∑øms_£t_subf‹m©
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 
subf‹m©
);

865 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_subf‹m©_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 *
subf‹m©
);

866 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_subf‹m©_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_t
 *
subf‹m©
);

867 
	`¢d_pcm_hw_∑øms_£t_subf‹m©_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_mask_t
 *
mask
);

868 
	`¢d_pcm_hw_∑øms_gë_subf‹m©_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_subf‹m©_mask_t
 *
mask
);

870 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_ch™√ls
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

871 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_ch™√ls_mö
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

872 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_ch™√ls_max
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

873 
	`¢d_pcm_hw_∑øms_ã°_ch™√ls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
);

874 
	`¢d_pcm_hw_∑øms_£t_ch™√ls
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
);

875 
	`¢d_pcm_hw_∑øms_£t_ch™√ls_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

876 
	`¢d_pcm_hw_∑øms_£t_ch™√ls_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

877 
	`¢d_pcm_hw_∑øms_£t_ch™√ls_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
max
);

878 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_ch™√ls_√¨
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

879 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_ch™√ls_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

880 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_ch™√ls_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
);

882 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_øã
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

883 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_øã_mö
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

884 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_øã_max
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

885 
	`¢d_pcm_hw_∑øms_ã°_øã
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

886 
	`¢d_pcm_hw_∑øms_£t_øã
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

887 
	`¢d_pcm_hw_∑øms_£t_øã_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

888 
	`¢d_pcm_hw_∑øms_£t_øã_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

889 
	`¢d_pcm_hw_∑øms_£t_øã_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
);

890 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_øã_√¨
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

891 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_øã_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

892 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_øã_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

894 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_time
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

895 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_time_mö
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

896 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_time_max
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

897 
	`¢d_pcm_hw_∑øms_ã°_≥riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

898 
	`¢d_pcm_hw_∑øms_£t_≥riod_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

899 
	`¢d_pcm_hw_∑øms_£t_≥riod_time_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

900 
	`¢d_pcm_hw_∑øms_£t_≥riod_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

901 
	`¢d_pcm_hw_∑øms_£t_≥riod_time_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
);

902 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_time_√¨
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

903 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_time_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

904 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_time_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

906 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_size
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
‰ames
, *
dú
);

907 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_size_mö
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
‰ames
, *
dú
);

908 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_size_max
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
‰ames
, *
dú
);

909 
	`¢d_pcm_hw_∑øms_ã°_≥riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
, 
dú
);

910 
	`¢d_pcm_hw_∑øms_£t_≥riod_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
, 
dú
);

911 
	`¢d_pcm_hw_∑øms_£t_≥riod_size_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
);

912 
	`¢d_pcm_hw_∑øms_£t_≥riod_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
);

913 
	`¢d_pcm_hw_∑øms_£t_≥riod_size_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
mö
, *
mödú
, snd_pcm_u‰ames_à*
max
, *
maxdú
);

914 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_size_√¨
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
);

915 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_size_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
);

916 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riod_size_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
, *
dú
);

917 
	`¢d_pcm_hw_∑øms_£t_≥riod_size_öãgî
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

919 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riods
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

920 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riods_mö
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

921 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riods_max
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

922 
	`¢d_pcm_hw_∑øms_ã°_≥riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

923 
	`¢d_pcm_hw_∑øms_£t_≥riods
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

924 
	`¢d_pcm_hw_∑øms_£t_≥riods_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

925 
	`¢d_pcm_hw_∑øms_£t_≥riods_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

926 
	`¢d_pcm_hw_∑øms_£t_≥riods_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
);

927 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riods_√¨
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

928 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riods_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

929 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riods_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

930 
	`¢d_pcm_hw_∑øms_£t_≥riods_öãgî
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
);

932 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_time
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

933 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_time_mö
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

934 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_time_max
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

935 
	`¢d_pcm_hw_∑øms_ã°_buf„r_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

936 
	`¢d_pcm_hw_∑øms_£t_buf„r_time
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
vÆ
, 
dú
);

937 
	`¢d_pcm_hw_∑øms_£t_buf„r_time_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

938 
	`¢d_pcm_hw_∑øms_£t_buf„r_time_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

939 
	`¢d_pcm_hw_∑øms_£t_buf„r_time_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
mö
, *
mödú
, *
max
, *
maxdú
);

940 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_time_√¨
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

941 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_time_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

942 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_time_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, *
vÆ
, *
dú
);

944 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_size
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

945 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_size_mö
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

946 
	$INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_size_max
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

947 
	`¢d_pcm_hw_∑øms_ã°_buf„r_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

948 
	`¢d_pcm_hw_∑øms_£t_buf„r_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

949 
	`¢d_pcm_hw_∑øms_£t_buf„r_size_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

950 
	`¢d_pcm_hw_∑øms_£t_buf„r_size_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

951 
	`¢d_pcm_hw_∑øms_£t_buf„r_size_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
mö
, snd_pcm_u‰ames_à*
max
);

952 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_size_√¨
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

953 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_size_fú°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

954 
	$INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_size_œ°
)(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

956 
	`¢d_pcm_sw_∑øms_£t_t°amp_mode
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_t°amp_t
 
vÆ
);

957 
	$INTERNAL
(
¢d_pcm_sw_∑øms_gë_t°amp_mode
)(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_t°amp_t
 *
vÆ
);

958 
	`¢d_pcm_sw_∑øms_£t_t°amp_ty≥
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_t°amp_ty≥_t
 
vÆ
);

959 
	`¢d_pcm_sw_∑øms_gë_t°amp_ty≥
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_t°amp_ty≥_t
 *
vÆ
);

960 
	`¢d_pcm_sw_∑øms_£t_avaû_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

961 
	$INTERNAL
(
¢d_pcm_sw_∑øms_gë_avaû_mö
)(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

962 
	`¢d_pcm_sw_∑øms_£t_°¨t_thªshﬁd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

963 
	$INTERNAL
(
¢d_pcm_sw_∑øms_gë_°¨t_thªshﬁd
)(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑ømsm
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

964 
	`¢d_pcm_sw_∑øms_£t_°›_thªshﬁd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

965 
	$INTERNAL
(
¢d_pcm_sw_∑øms_gë_°›_thªshﬁd
)(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

966 
	`¢d_pcm_sw_∑øms_£t_sûí˚_thªshﬁd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

967 
	$INTERNAL
(
¢d_pcm_sw_∑øms_gë_sûí˚_thªshﬁd
)(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

968 
	`¢d_pcm_sw_∑øms_£t_sûí˚_size
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 
vÆ
);

969 
	$INTERNAL
(
¢d_pcm_sw_∑øms_gë_sûí˚_size
)(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
¢d_pcm_u‰ames_t
 *
vÆ
);

972 c⁄° *
	`¢d_pcm_hw_∑øm_«me
(
¢d_pcm_hw_∑øm_t
 
∑øm
);

973 
	`¢d_pcm_hw_∑øm_dump
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

974 
¢d_pcm_hw_∑øm_t
 
v¨
, 
¢d_ouçut_t
 *
out
);

976 
	`¢d_pcm_hw_°øãgy_sim∂e_√¨
(
¢d_pcm_hw_°øãgy_t
 *
°øãgy
, 
‹dî
,

977 
¢d_pcm_hw_∑øm_t
 
v¨
,

978 
be°
,

979 
mul
);

980 
	`¢d_pcm_hw_°øãgy_sim∂e_choi˚s
(
¢d_pcm_hw_°øãgy_t
 *
°øãgy
, 
‹dî
,

981 
¢d_pcm_hw_∑øm_t
 
v¨
,

982 
cou¡
,

983 
¢d_pcm_hw_°øãgy_sim∂e_choi˚s_li°_t
 *
choi˚s
);

986 
	#SCONF_MANDATORY
 1

	)

987 
	#SCONF_UNCHANGED
 2

	)

989 
	`¢d_pcm_¶ave_c⁄f
(
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

990 
¢d_c⁄fig_t
 **
pcm_c⁄f
, 
cou¡
, ...);

992 
	#SND_PCM_APPEND
 (1<<8)

	)

994 
	`¢d_pcm_›í_«med_¶ave
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

995 
¢d_c⁄fig_t
 *
roŸ
,

996 
¢d_c⁄fig_t
 *
c⁄f
, 
¢d_pcm_°ªam_t
 
°ªam
,

997 
mode
, 
¢d_c⁄fig_t
 *
∑ª¡_c⁄f
);

998 
ölöe
 

999 
	$¢d_pcm_›í_¶ave
(
¢d_pcm_t
 **
pcmp
, 
¢d_c⁄fig_t
 *
roŸ
,

1000 
¢d_c⁄fig_t
 *
c⁄f
, 
¢d_pcm_°ªam_t
 
°ªam
,

1001 
mode
, 
¢d_c⁄fig_t
 *
∑ª¡_c⁄f
)

1003  
	`¢d_pcm_›í_«med_¶ave
(
pcmp
, 
NULL
, 
roŸ
, 
c⁄f
, 
°ªam
,

1004 
mode
, 
∑ª¡_c⁄f
);

1005 
	}
}

1007 
	#¢d_pcm_c⁄f_gíîic_id
(
id
Ë
	`_¢d_c⁄f_gíîic_id
(id)

	)

1009 
¢d_pcm_hw_›í_fd
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
, 
fd
,

1010 
sync_±r_io˘l
);

1011 
__¢d_pcm_mm≠_emul_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1012 
¢d_pcm_t
 *
¶ave
, 
˛o£_¶ave
);

1014 
¢d_pcm_waô_nocheck
(
¢d_pcm_t
 *
pcm
, 
timeout
);

1016 c⁄° 
¢d_c⁄fig_t
 *
¢d_pcm_øã_gë_deÁu…_c⁄vîãr
(¢d_c⁄fig_à*
roŸ
);

1018 
	#SND_PCM_HW_PARBIT_ACCESS
 (1U << 
SND_PCM_HW_PARAM_ACCESS
)

	)

1019 
	#SND_PCM_HW_PARBIT_FORMAT
 (1U << 
SND_PCM_HW_PARAM_FORMAT
)

	)

1020 
	#SND_PCM_HW_PARBIT_SUBFORMAT
 (1U << 
SND_PCM_HW_PARAM_SUBFORMAT
)

	)

1021 
	#SND_PCM_HW_PARBIT_CHANNELS
 (1U << 
SND_PCM_HW_PARAM_CHANNELS
)

	)

1022 
	#SND_PCM_HW_PARBIT_RATE
 (1U << 
SND_PCM_HW_PARAM_RATE
)

	)

1023 
	#SND_PCM_HW_PARBIT_PERIOD_TIME
 (1U << 
SND_PCM_HW_PARAM_PERIOD_TIME
)

	)

1024 
	#SND_PCM_HW_PARBIT_PERIOD_SIZE
 (1U << 
SND_PCM_HW_PARAM_PERIOD_SIZE
)

	)

1025 
	#SND_PCM_HW_PARBIT_PERIODS
 (1U << 
SND_PCM_HW_PARAM_PERIODS
)

	)

1026 
	#SND_PCM_HW_PARBIT_BUFFER_TIME
 (1U << 
SND_PCM_HW_PARAM_BUFFER_TIME
)

	)

1027 
	#SND_PCM_HW_PARBIT_BUFFER_SIZE
 (1U << 
SND_PCM_HW_PARAM_BUFFER_SIZE
)

	)

1028 
	#SND_PCM_HW_PARBIT_SAMPLE_BITS
 (1U << 
SND_PCM_HW_PARAM_SAMPLE_BITS
)

	)

1029 
	#SND_PCM_HW_PARBIT_FRAME_BITS
 (1U << 
SND_PCM_HW_PARAM_FRAME_BITS
)

	)

1030 
	#SND_PCM_HW_PARBIT_PERIOD_BYTES
 (1U << 
SND_PCM_HW_PARAM_PERIOD_BYTES
)

	)

1031 
	#SND_PCM_HW_PARBIT_BUFFER_BYTES
 (1U << 
SND_PCM_HW_PARAM_BUFFER_BYTES
)

	)

1032 
	#SND_PCM_HW_PARBIT_TICK_TIME
 (1U << 
SND_PCM_HW_PARAM_TICK_TIME
)

	)

1035 
	#SND_PCM_ACCBIT_MMAP
 { ((1U << 
SND_PCM_ACCESS_MMAP_INTERLEAVED
) | \

1036 (1U << 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
) | \

1037 (1U << 
SND_PCM_ACCESS_MMAP_COMPLEX
)Ë}

	)

1038 
	#SND_PCM_ACCBIT_MMAPI
 { (1U << 
SND_PCM_ACCESS_MMAP_INTERLEAVED
Ë}

	)

1039 
	#SND_PCM_ACCBIT_MMAPN
 { (1U << 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
Ë}

	)

1040 
	#SND_PCM_ACCBIT_MMAPC
 { (1U << 
SND_PCM_ACCESS_MMAP_COMPLEX
Ë}

	)

1042 
	#SND_PCM_ACCBIT_SHM
 { ((1U << 
SND_PCM_ACCESS_MMAP_INTERLEAVED
) | \

1043 (1U << 
SND_PCM_ACCESS_RW_INTERLEAVED
) | \

1044 (1U << 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
) | \

1045 (1U << 
SND_PCM_ACCESS_RW_NONINTERLEAVED
)Ë}

	)

1046 
	#SND_PCM_ACCBIT_SHMI
 { ((1U << 
SND_PCM_ACCESS_MMAP_INTERLEAVED
) | \

1047 (1U << 
SND_PCM_ACCESS_RW_INTERLEAVED
)Ë}

	)

1048 
	#SND_PCM_ACCBIT_SHMN
 { ((1U << 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
) | \

1049 (1U << 
SND_PCM_ACCESS_RW_NONINTERLEAVED
)Ë}

	)

1051 
	#SND_PCM_FMTBIT_LINEAR
 \

1052 { ((1U << 
SND_PCM_FORMAT_S8
) | \

1053 (1U << 
SND_PCM_FORMAT_U8
) | \

1054 (1U << 
SND_PCM_FORMAT_S16_LE
) | \

1055 (1U << 
SND_PCM_FORMAT_S16_BE
) | \

1056 (1U << 
SND_PCM_FORMAT_U16_LE
) | \

1057 (1U << 
SND_PCM_FORMAT_U16_BE
) | \

1058 (1U << 
SND_PCM_FORMAT_S20_LE
) | \

1059 (1U << 
SND_PCM_FORMAT_S20_BE
) | \

1060 (1U << 
SND_PCM_FORMAT_U20_LE
) | \

1061 (1U << 
SND_PCM_FORMAT_U20_BE
) | \

1062 (1U << 
SND_PCM_FORMAT_S24_LE
) | \

1063 (1U << 
SND_PCM_FORMAT_S24_BE
) | \

1064 (1U << 
SND_PCM_FORMAT_U24_LE
) | \

1065 (1U << 
SND_PCM_FORMAT_U24_BE
) | \

1066 (1U << 
SND_PCM_FORMAT_S32_LE
) | \

1067 (1U << 
SND_PCM_FORMAT_S32_BE
) | \

1068 (1U << 
SND_PCM_FORMAT_U32_LE
) | \

1069 (1U << 
SND_PCM_FORMAT_U32_BE
)), \

1070 ((1U << (
SND_PCM_FORMAT_S24_3LE
 - 32)) | \

1071 (1U << (
SND_PCM_FORMAT_U24_3LE
 - 32)) | \

1072 (1U << (
SND_PCM_FORMAT_S24_3BE
 - 32)) | \

1073 (1U << (
SND_PCM_FORMAT_U24_3BE
 - 32)) | \

1074 (1U << (
SND_PCM_FORMAT_S20_3LE
 - 32)) | \

1075 (1U << (
SND_PCM_FORMAT_U20_3LE
 - 32)) | \

1076 (1U << (
SND_PCM_FORMAT_S20_3BE
 - 32)) | \

1077 (1U << (
SND_PCM_FORMAT_U20_3BE
 - 32)) | \

1078 (1U << (
SND_PCM_FORMAT_S18_3LE
 - 32)) | \

1079 (1U << (
SND_PCM_FORMAT_U18_3LE
 - 32)) | \

1080 (1U << (
SND_PCM_FORMAT_S18_3BE
 - 32)) | \

1081 (1U << (
SND_PCM_FORMAT_U18_3BE
 - 32))Ë}

	)

1084 
	#SND_PCM_FMTBIT_FLOAT
 \

1085 { ((1U << 
SND_PCM_FORMAT_FLOAT_LE
) | \

1086 (1U << 
SND_PCM_FORMAT_FLOAT_BE
) | \

1087 (1U << 
SND_PCM_FORMAT_FLOAT64_LE
) | \

1088 (1U << 
SND_PCM_FORMAT_FLOAT64_BE
)Ë}

	)

1091 
	u¢d_tmp_Êﬂt
 {

1092 
	mf
;

1093 
öt32_t
 
	mi
;

1094 } 
	t¢d_tmp_Êﬂt_t
;

1096 
	u¢d_tmp_doubÀ
 {

1097 
	md
;

1098 
öt64_t
 
	ml
;

1099 } 
	t¢d_tmp_doubÀ_t
;

1102 #ifde‡
HAVE_CLOCK_GETTIME


1103 
ölöe
 
	$gëtime°amp
(
¢d_htime°amp_t
 *
t°amp
,

1104 
¢d_pcm_t°amp_ty≥_t
 
t°amp_ty≥
)

1106 
˛ockid_t
 
id
;

1108 
t°amp_ty≥
) {

1109 #ifde‡
CLOCK_MONOTONIC_RAW


1110 
SND_PCM_TSTAMP_TYPE_MONOTONIC_RAW
:

1111 
id
 = 
CLOCK_MONOTONIC_RAW
;

1114 #ifde‡
CLOCK_MONOTONIC


1115 
SND_PCM_TSTAMP_TYPE_MONOTONIC
:

1116 
id
 = 
CLOCK_MONOTONIC
;

1120 
id
 = 
CLOCK_REALTIME
;

1123 
	`˛ock_gëtime
(
id
, 
t°amp
);

1124 
	}
}

1126 
ölöe
 
	$gëtime°amp
(
¢d_htime°amp_t
 *
t°amp
,

1127 
¢d_pcm_t°amp_ty≥_t
 
t°amp_ty≥
)

1129 
timevÆ
 
tv
;

1131 
	`gëtimeofday
(&
tv
, 0);

1132 
t°amp
->
tv_£c
 = 
tv
.tv_sec;

1133 
t°amp
->
tv_n£c
 = 
tv
.
tv_u£c
 * 1000L;

1134 
	}
}

1137 
¢d_pcm_chm≠_quîy_t
 **

1138 
_¢d_pcm_make_sögÀ_quîy_chm≠s
(c⁄° 
¢d_pcm_chm≠_t
 *
§c
);

1139 
¢d_pcm_chm≠_t
 *
_¢d_pcm_c›y_chm≠
(c⁄° snd_pcm_chm≠_à*
§c
);

1140 
¢d_pcm_chm≠_quîy_t
 **

1141 
_¢d_pcm_c›y_chm≠_quîy
(
¢d_pcm_chm≠_quîy_t
 * c⁄° *
§c
);

1142 
¢d_pcm_chm≠_quîy_t
 **

1143 
_¢d_pcm_∑r£_c⁄fig_chm≠s
(
¢d_c⁄fig_t
 *
c⁄f
);

1144 
¢d_pcm_chm≠_t
 *

1145 
_¢d_pcm_choo£_fixed_chm≠
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_chm≠_quîy_t
 * c⁄° *
m≠s
);

1148 
ölöe
 
	$¢d_pcm_may_waô_f‹_avaû_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
avaû
)

1150 i‡(
avaû
 >
pcm
->
avaû_mö
)

1152 i‡(
pcm
->
Á°_›s
->
may_waô_f‹_avaû_mö
)

1153  
pcm
->
Á°_›s
->
	`may_waô_f‹_avaû_mö
’cm->
Á°_›_¨g
, 
avaû
);

1155 
	}
}

1158 
ölöe
 
	$sw_gë_≥riod_evít
(c⁄° 
¢d_pcm_sw_∑øms_t
 *
∑øms
)

1160  
∑øms
->
ª£rved
[(params->reserved) / (params->reserved[0])- 1];

1161 
	}
}

1163 
ölöe
 
	$sw_£t_≥riod_evít
(
¢d_pcm_sw_∑øms_t
 *
∑øms
, 
vÆ
)

1165 
∑øms
->
ª£rved
[’¨ams->ª£rvedË/ ’¨ams->ª£rved[0]Ë- 1] = 
vÆ
;

1166 
	}
}

1168 
	#PCMINABORT
(
pcm
Ë((’cm)->
mode
 & 
SND_PCM_ABORT
Ë!0)

	)

1170 
ölöe
 
¢d_pcm_s‰ames_t
 
	$pcm_‰ame_diff
(
¢d_pcm_u‰ames_t
 
±r1
,

1171 
¢d_pcm_u‰ames_t
 
±r2
,

1172 
¢d_pcm_u‰ames_t
 
bound¨y
)

1174 i‡(
±r1
 < 
±r2
)

1175  
±r1
 + (
bound¨y
 - 
±r2
);

1177  
±r1
 - 
±r2
;

1178 
	}
}

1180 
ölöe
 
¢d_pcm_s‰ames_t
 
	$pcm_‰ame_diff2
(
¢d_pcm_u‰ames_t
 
±r1
,

1181 
¢d_pcm_u‰ames_t
 
±r2
,

1182 
¢d_pcm_u‰ames_t
 
bound¨y
)

1184 
¢d_pcm_s‰ames_t
 
r
 = 
±r1
 - 
±r2
;

1185 i‡(
r
 >(
¢d_pcm_s‰ames_t
)
bound¨y
 / 2)

1186  
bound¨y
 - 
r
;

1187  
r
;

1188 
	}
}

1190 #ifde‡
THREAD_SAFE_API


1203 
ölöe
 
	$__¢d_pcm_lock
(
¢d_pcm_t
 *
pcm
)

1205 i‡(
pcm
->
lock_íabÀd
)

1206 
	`±hªad_muãx_lock
(&
pcm
->
lock
);

1207 
	}
}

1208 
ölöe
 
	$__¢d_pcm_u∆ock
(
¢d_pcm_t
 *
pcm
)

1210 i‡(
pcm
->
lock_íabÀd
)

1211 
	`±hªad_muãx_u∆ock
(&
pcm
->
lock
);

1212 
	}
}

1213 
ölöe
 
	$¢d_pcm_lock
(
¢d_pcm_t
 *
pcm
)

1215 i‡(
pcm
->
lock_íabÀd
 &&Öcm->
√ed_lock
)

1216 
	`±hªad_muãx_lock
(&
pcm
->
lock
);

1217 
	}
}

1218 
ölöe
 
	$¢d_pcm_u∆ock
(
¢d_pcm_t
 *
pcm
)

1220 i‡(
pcm
->
lock_íabÀd
 &&Öcm->
√ed_lock
)

1221 
	`±hªad_muãx_u∆ock
(&
pcm
->
lock
);

1222 
	}
}

1224 
	#__¢d_pcm_lock
(
pcm
Ëdÿ{} 0)

	)

1225 
	#__¢d_pcm_u∆ock
(
pcm
Ëdÿ{} 0)

	)

1226 
	#¢d_pcm_lock
(
pcm
Ëdÿ{} 0)

	)

1227 
	#¢d_pcm_u∆ock
(
pcm
Ëdÿ{} 0)

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_meter.c

30 
	~"pcm_loˇl.h
"

31 
	~"pcm_∂ugö.h
"

32 
	~"bsw≠.h
"

33 
	~<time.h
>

34 
	~<±hªad.h
>

35 
	~<dlf˙.h
>

37 #i‚de‡
DOC_HIDDEN


38 
	#©omic_ªad
(
±r
Ë
	`__©omic_lﬂd_n
’å, 
__ATOMIC_SEQ_CST
 )

	)

39 
	#©omic_add
(
±r
, 
n
Ë
	`__©omic_add_„tch
’å,Ç, 
__ATOMIC_SEQ_CST
)

	)

40 
	#©omic_dec
(
±r
Ë
	`__©omic_sub_„tch
’å, 1, 
__ATOMIC_SEQ_CST
)

	)

43 #i‚de‡
PIC


45 c⁄° *
	g_¢d_moduÀ_pcm_mëî
 = "";

48 #i‚de‡
DOC_HIDDEN


49 
	#FREQUENCY
 50

	)

51 
	s_¢d_pcm_sc›e
 {

52 
	míabÀd
;

53 *
	m«me
;

54 c⁄° 
¢d_pcm_sc›e_›s_t
 *
	m›s
;

55 *
	m¥iv©e_d©a
;

56 
li°_hód
 
	mli°
;

59 
	s_¢d_pcm_mëî
 {

60 
¢d_pcm_gíîic_t
 
	mgí
;

61 
¢d_pcm_u‰ames_t
 
	mΩå
;

62 
¢d_pcm_u‰ames_t
 
	mbuf_size
;

63 
¢d_pcm_ch™√l_¨ó_t
 *
	mbuf_¨ós
;

64 
¢d_pcm_u‰ames_t
 
	mnow
;

65 *
	mbuf
;

66 
li°_hód
 
	msc›es
;

67 
	m˛o£d
;

68 
	mru¬ög
;

69 
	mª£t
;

70 
±hªad_t
 
	mthªad
;

71 
±hªad_muãx_t
 
	mupd©e_muãx
;

72 
±hªad_muãx_t
 
	mru¬ög_muãx
;

73 
±hªad_c⁄d_t
 
	mru¬ög_c⁄d
;

74 
time•ec
 
	mdñay
;

75 *
	mdl_h™dÀ
;

76 } 
	t¢d_pcm_mëî_t
;

78 
	$¢d_pcm_mëî_add_‰ames
(
¢d_pcm_t
 *
pcm
,

79 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

80 
¢d_pcm_u‰ames_t
 
±r
,

81 
¢d_pcm_u‰ames_t
 
‰ames
)

83 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

84 i‡(
‰ames
 > 
pcm
->
buf„r_size
)

85 
‰ames
 = 
pcm
->
buf„r_size
;

86 
‰ames
 > 0) {

87 
¢d_pcm_u‰ames_t
 
n
 = 
‰ames
;

88 
¢d_pcm_u‰ames_t
 
d°_off£t
 = 
±r
 % 
mëî
->
buf_size
;

89 
¢d_pcm_u‰ames_t
 
§c_off£t
 = 
±r
 % 
pcm
->
buf„r_size
;

90 
¢d_pcm_u‰ames_t
 
d°_c⁄t
 = 
mëî
->
buf_size
 - 
d°_off£t
;

91 
¢d_pcm_u‰ames_t
 
§c_c⁄t
 = 
pcm
->
buf„r_size
 - 
§c_off£t
;

92 i‡(
n
 > 
d°_c⁄t
)

93 
n
 = 
d°_c⁄t
;

94 i‡(
n
 > 
§c_c⁄t
)

95 
n
 = 
§c_c⁄t
;

96 
	`¢d_pcm_¨ós_c›y
(
mëî
->
buf_¨ós
, 
d°_off£t
,

97 
¨ós
, 
§c_off£t
,

98 
pcm
->
ch™√ls
, 
n
,Öcm->
f‹m©
);

99 
‰ames
 -
n
;

100 
±r
 +
n
;

101 i‡(
±r
 =
pcm
->
bound¨y
)

102 
±r
 = 0;

104 
	}
}

106 
	$¢d_pcm_mëî_upd©e_maö
(
¢d_pcm_t
 *
pcm
)

108 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

109 
¢d_pcm_s‰ames_t
 
‰ames
;

110 
¢d_pcm_u‰ames_t
 
Ωå
, 
ﬁd_Ωå
;

111 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
;

112 
locked
;

113 
locked
 = (
	`±hªad_muãx_åylock
(&
mëî
->
upd©e_muãx
) >= 0);

114 
¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

115 
Ωå
 = *
pcm
->
hw
.
±r
;

116 
ﬁd_Ωå
 = 
mëî
->
Ωå
;

117 
mëî
->
Ωå
 =Ñptr;

118 
‰ames
 = 
Ωå
 - 
ﬁd_Ωå
;

119 i‡(
‰ames
 < 0)

120 
‰ames
 +
pcm
->
bound¨y
;

121 i‡(
‰ames
 > 0) {

122 
	`as£π
((
¢d_pcm_u‰ames_t
Ë
‰ames
 <
pcm
->
buf„r_size
);

123 
	`¢d_pcm_mëî_add_‰ames
(
pcm
, 
¨ós
, 
ﬁd_Ωå
,

124 (
¢d_pcm_u‰ames_t
Ë
‰ames
);

126 i‡(
locked
)

127 
	`±hªad_muãx_u∆ock
(&
mëî
->
upd©e_muãx
);

128 
	}
}

130 
	$¢d_pcm_mëî_upd©e_sc›e
(
¢d_pcm_t
 *
pcm
)

132 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

133 
¢d_pcm_s‰ames_t
 
‰ames
;

134 
¢d_pcm_u‰ames_t
 
Ωå
, 
ﬁd_Ωå
;

135 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
;

136 
ª£t
 = 0;

138 
	`±hªad_muãx_lock
(&
mëî
->
upd©e_muãx
);

139 
¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

140 
_agaö
:

141 
Ωå
 = *
pcm
->
hw
.
±r
;

142 
ﬁd_Ωå
 = 
mëî
->
Ωå
;

143 i‡(
	`©omic_ªad
(&
mëî
->
ª£t
)) {

144 
ª£t
 = 1;

145 
	`©omic_dec
(&
mëî
->
ª£t
);

146 
_agaö
;

148 
mëî
->
Ωå
 =Ñptr;

149 
‰ames
 = 
Ωå
 - 
ﬁd_Ωå
;

150 i‡(
‰ames
 < 0)

151 
‰ames
 +
pcm
->
bound¨y
;

152 i‡(
‰ames
 > 0) {

153 
	`as£π
((
¢d_pcm_u‰ames_t
Ë
‰ames
 <
pcm
->
buf„r_size
);

154 
	`¢d_pcm_mëî_add_‰ames
(
pcm
, 
¨ós
, 
ﬁd_Ωå
,

155 (
¢d_pcm_u‰ames_t
Ë
‰ames
);

157 
	`±hªad_muãx_u∆ock
(&
mëî
->
upd©e_muãx
);

158  
ª£t
;

159 
	}
}

161 
	$¢d_pcm_sc›e_ªmove
(
¢d_pcm_sc›e_t
 *
sc›e
)

163 
	`‰ì
(
sc›e
->
«me
);

164 
sc›e
->
›s
->
	`˛o£
(scope);

165 
	`li°_dñ
(&
sc›e
->
li°
);

166 
	`‰ì
(
sc›e
);

168 
	}
}

170 
	$¢d_pcm_sc›e_íabÀ
(
¢d_pcm_sc›e_t
 *
sc›e
)

172 
îr
;

173 
	`as£π
(!
sc›e
->
íabÀd
);

174 
îr
 = 
sc›e
->
›s
->
	`íabÀ
(scope);

175 
sc›e
->
íabÀd
 = (
îr
 >= 0);

176  
îr
;

177 
	}
}

179 
	$¢d_pcm_sc›e_dißbÀ
(
¢d_pcm_sc›e_t
 *
sc›e
)

181 
	`as£π
(
sc›e
->
íabÀd
);

182 
sc›e
->
›s
->
	`dißbÀ
(scope);

183 
sc›e
->
íabÀd
 = 0;

185 
	}
}

187 *
	$¢d_pcm_mëî_thªad
(*
d©a
)

189 
¢d_pcm_t
 *
pcm
 = 
d©a
;

190 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

191 
¢d_pcm_t
 *
•cm
 = 
mëî
->
gí
.
¶ave
;

192 
li°_hód
 *
pos
;

193 
¢d_pcm_sc›e_t
 *
sc›e
;

194 
ª£t
;

195 
	`li°_f‹_óch
(
pos
, &
mëî
->
sc›es
) {

196 
sc›e
 = 
	`li°_íåy
(
pos
, 
¢d_pcm_sc›e_t
, 
li°
);

197 
	`¢d_pcm_sc›e_íabÀ
(
sc›e
);

199 !
mëî
->
˛o£d
) {

200 
¢d_pcm_s‰ames_t
 
now
;

201 
¢d_pcm_°©us_t
 
°©us
;

202 
îr
;

203 
	`±hªad_muãx_lock
(&
mëî
->
ru¬ög_muãx
);

204 
îr
 = 
	`¢d_pcm_°©us
(
•cm
, &
°©us
);

205 
	`as£π
(
îr
 >= 0);

206 i‡(
°©us
.
°©e
 !
SND_PCM_STATE_RUNNING
 &&

207 (
°©us
.
°©e
 !
SND_PCM_STATE_DRAINING
 ||

208 
•cm
->
°ªam
 !
SND_PCM_STREAM_PLAYBACK
)) {

209 i‡(
mëî
->
ru¬ög
) {

210 
	`li°_f‹_óch
(
pos
, &
mëî
->
sc›es
) {

211 
sc›e
 = 
	`li°_íåy
(
pos
, 
¢d_pcm_sc›e_t
, 
li°
);

212 
sc›e
->
›s
->
	`°›
(scope);

214 
mëî
->
ru¬ög
 = 0;

216 
	`±hªad_c⁄d_waô
(&
mëî
->
ru¬ög_c⁄d
,

217 &
mëî
->
ru¬ög_muãx
);

218 
	`±hªad_muãx_u∆ock
(&
mëî
->
ru¬ög_muãx
);

221 
	`±hªad_muãx_u∆ock
(&
mëî
->
ru¬ög_muãx
);

222 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

223 
now
 = 
°©us
.
≠∂_±r
 - sètus.
dñay
;

224 i‡(
now
 < 0)

225 
now
 +
pcm
->
bound¨y
;

227 
now
 = 
°©us
.
≠∂_±r
 + sètus.
dñay
;

228 i‡((
¢d_pcm_u‰ames_t
Ë
now
 >
pcm
->
bound¨y
)

229 
now
 -
pcm
->
bound¨y
;

231 
mëî
->
now
 =Çow;

232 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_CAPTURE
)

233 
ª£t
 = 
	`¢d_pcm_mëî_upd©e_sc›e
(
pcm
);

235 
ª£t
 = 0;

236 
	`©omic_ªad
(&
mëî
->
ª£t
)) {

237 
ª£t
 = 1;

238 
	`©omic_dec
(&
mëî
->
ª£t
);

241 i‡(
ª£t
) {

242 
	`li°_f‹_óch
(
pos
, &
mëî
->
sc›es
) {

243 
sc›e
 = 
	`li°_íåy
(
pos
, 
¢d_pcm_sc›e_t
, 
li°
);

244 i‡(
sc›e
->
íabÀd
)

245 
sc›e
->
›s
->
	`ª£t
(scope);

249 i‡(!
mëî
->
ru¬ög
) {

250 
	`li°_f‹_óch
(
pos
, &
mëî
->
sc›es
) {

251 
sc›e
 = 
	`li°_íåy
(
pos
, 
¢d_pcm_sc›e_t
, 
li°
);

252 i‡(
sc›e
->
íabÀd
)

253 
sc›e
->
›s
->
	`°¨t
(scope);

255 
mëî
->
ru¬ög
 = 1;

257 
	`li°_f‹_óch
(
pos
, &
mëî
->
sc›es
) {

258 
sc›e
 = 
	`li°_íåy
(
pos
, 
¢d_pcm_sc›e_t
, 
li°
);

259 i‡(
sc›e
->
íabÀd
)

260 
sc›e
->
›s
->
	`upd©e
(scope);

262 
	`«no¶ìp
(&
mëî
->
dñay
, 
NULL
);

264 
	`li°_f‹_óch
(
pos
, &
mëî
->
sc›es
) {

265 
sc›e
 = 
	`li°_íåy
(
pos
, 
¢d_pcm_sc›e_t
, 
li°
);

266 i‡(
sc›e
->
íabÀd
)

267 
	`¢d_pcm_sc›e_dißbÀ
(
sc›e
);

269  
NULL
;

270 
	}
}

272 
	$¢d_pcm_mëî_˛o£
(
¢d_pcm_t
 *
pcm
)

274 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

275 
li°_hód
 *
pos
, *
≈os
;

276 
îr
 = 0;

277 
	`±hªad_muãx_de°roy
(&
mëî
->
upd©e_muãx
);

278 
	`±hªad_muãx_de°roy
(&
mëî
->
ru¬ög_muãx
);

279 
	`±hªad_c⁄d_de°roy
(&
mëî
->
ru¬ög_c⁄d
);

280 i‡(
mëî
->
gí
.
˛o£_¶ave
)

281 
îr
 = 
	`¢d_pcm_˛o£
(
mëî
->
gí
.
¶ave
);

282 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, &
mëî
->
sc›es
) {

283 
¢d_pcm_sc›e_t
 *
sc›e
;

284 
sc›e
 = 
	`li°_íåy
(
pos
, 
¢d_pcm_sc›e_t
, 
li°
);

285 
	`¢d_pcm_sc›e_ªmove
(
sc›e
);

287 i‡(
mëî
->
dl_h™dÀ
)

288 
	`¢d_dl˛o£
(
mëî
->
dl_h™dÀ
);

289 
	`‰ì
(
mëî
);

290  
îr
;

291 
	}
}

293 
	$¢d_pcm_mëî_¥ï¨e
(
¢d_pcm_t
 *
pcm
)

295 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

296 
îr
;

297 
	`©omic_add
(&
mëî
->
ª£t
, 1);

298 
îr
 = 
	`¢d_pcm_¥ï¨e
(
mëî
->
gí
.
¶ave
);

299 i‡(
îr
 >= 0) {

300 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

301 
mëî
->
Ωå
 = *
pcm
->
≠∂
.
±r
;

303 
mëî
->
Ωå
 = *
pcm
->
hw
.
±r
;

305  
îr
;

306 
	}
}

308 
	$¢d_pcm_mëî_ª£t
(
¢d_pcm_t
 *
pcm
)

310 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

311 
îr
 = 
	`¢d_pcm_ª£t
(
mëî
->
gí
.
¶ave
);

312 i‡(
îr
 >= 0) {

313 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

314 
mëî
->
Ωå
 = *
pcm
->
≠∂
.
±r
;

316  
îr
;

317 
	}
}

319 
	$¢d_pcm_mëî_°¨t
(
¢d_pcm_t
 *
pcm
)

321 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

322 
îr
;

323 
	`±hªad_muãx_lock
(&
mëî
->
ru¬ög_muãx
);

324 
îr
 = 
	`¢d_pcm_°¨t
(
mëî
->
gí
.
¶ave
);

325 i‡(
îr
 >= 0)

326 
	`±hªad_c⁄d_sig«l
(&
mëî
->
ru¬ög_c⁄d
);

327 
	`±hªad_muãx_u∆ock
(&
mëî
->
ru¬ög_muãx
);

328  
îr
;

329 
	}
}

331 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mëî_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

333 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

334 
¢d_pcm_s‰ames_t
 
îr
 = 
	`¢d_pcm_ªwöd
(
mëî
->
gí
.
¶ave
, 
‰ames
);

335 i‡(
îr
 > 0 && 
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

336 
mëî
->
Ωå
 = *
pcm
->
≠∂
.
±r
;

337  
îr
;

338 
	}
}

340 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mëî_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

342 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

343 
¢d_pcm_s‰ames_t
 
îr
 = 
	`INTERNAL
(
¢d_pcm_f‹w¨d
)(
mëî
->
gí
.
¶ave
, 
‰ames
);

344 i‡(
îr
 > 0 && 
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

345 
mëî
->
Ωå
 = *
pcm
->
≠∂
.
±r
;

346  
îr
;

347 
	}
}

349 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mëî_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

350 
¢d_pcm_u‰ames_t
 
off£t
,

351 
¢d_pcm_u‰ames_t
 
size
)

353 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

354 
¢d_pcm_u‰ames_t
 
ﬁd_Ωå
 = *
pcm
->
≠∂
.
±r
;

355 
¢d_pcm_s‰ames_t
 
ªsu…
 = 
	`¢d_pcm_mm≠_commô
(
mëî
->
gí
.
¶ave
, 
off£t
, 
size
);

356 i‡(
ªsu…
 <= 0)

357  
ªsu…
;

358 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

359 
	`¢d_pcm_mëî_add_‰ames
(
pcm
, 
	`¢d_pcm_mm≠_¨ós
’cm), 
ﬁd_Ωå
, 
ªsu…
);

360 
mëî
->
Ωå
 = *
pcm
->
≠∂
.
±r
;

362  
ªsu…
;

363 
	}
}

365 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mëî_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

367 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

368 
¢d_pcm_s‰ames_t
 
ªsu…
 = 
	`¢d_pcm_avaû_upd©e
(
mëî
->
gí
.
¶ave
);

369 i‡(
ªsu…
 <= 0)

370  
ªsu…
;

371 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_CAPTURE
)

372 
	`¢d_pcm_mëî_upd©e_maö
(
pcm
);

373  
ªsu…
;

374 
	}
}

376 
	$¢d_pcm_mëî_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

378 
îr
;

379 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

380 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

381 &
ac˚ss_mask
);

382 i‡(
îr
 < 0)

383  
îr
;

384 
∑øms
->
öfo
 &~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

386 
	}
}

388 
	$¢d_pcm_mëî_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

390 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

391 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

392 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

393 &
ßc˚ss_mask
);

395 
	}
}

397 
	$¢d_pcm_mëî_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

398 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

400 
îr
;

401 
löks
 = ~
SND_PCM_HW_PARBIT_ACCESS
;

402 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

403 i‡(
îr
 < 0)

404  
îr
;

406 
	}
}

408 
	$¢d_pcm_mëî_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

409 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

411 
îr
;

412 
löks
 = ~
SND_PCM_HW_PARBIT_ACCESS
;

413 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

414 i‡(
îr
 < 0)

415  
îr
;

417 
	}
}

419 
	$¢d_pcm_mëî_hw_ªföe_¶ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

421 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

422  
	`¢d_pcm_hw_ªföe
(
mëî
->
gí
.
¶ave
, 
∑øms
);

423 
	}
}

425 
	$¢d_pcm_mëî_hw_∑øms_¶ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

427 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

428  
	`_¢d_pcm_hw_∑øms_öã∫Æ
(
mëî
->
gí
.
¶ave
, 
∑øms
);

429 
	}
}

431 
	$¢d_pcm_mëî_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

433  
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

434 
¢d_pcm_mëî_hw_ªföe_˝ª∑ª
,

435 
¢d_pcm_mëî_hw_ªföe_cch™ge
,

436 
¢d_pcm_mëî_hw_ªföe_•ª∑ª
,

437 
¢d_pcm_mëî_hw_ªföe_sch™ge
,

438 
¢d_pcm_mëî_hw_ªföe_¶ave
);

439 
	}
}

441 
	$¢d_pcm_mëî_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 * 
∑øms
)

443 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

444 
ch™√l
;

445 
¢d_pcm_t
 *
¶ave
 = 
mëî
->
gí
.slave;

446 
size_t
 
buf_size_byãs
;

447 
îr
;

448 
îr
 = 
	`¢d_pcm_hw_∑øms_¶ave
(
pcm
, 
∑øms
,

449 
¢d_pcm_mëî_hw_ªföe_cch™ge
,

450 
¢d_pcm_mëî_hw_ªföe_•ª∑ª
,

451 
¢d_pcm_mëî_hw_ªföe_sch™ge
,

452 
¢d_pcm_mëî_hw_∑øms_¶ave
);

453 i‡(
îr
 < 0)

454  
îr
;

456 
mëî
->
buf_size
 = 
¶ave
->
buf„r_size
;

457 
mëî
->
buf_size
 < 
¶ave
->
øã
)

458 
mëî
->
buf_size
 *= 2;

459 
buf_size_byãs
 = 
	`¢d_pcm_‰ames_to_byãs
(
¶ave
, 
mëî
->
buf_size
);

460 
	`as£π
(!
mëî
->
buf
);

461 
mëî
->
buf
 = 
	`mÆloc
(
buf_size_byãs
);

462 i‡(!
mëî
->
buf
)

463  -
ENOMEM
;

464 
mëî
->
buf_¨ós
 = 
	`mÆloc
((*mëî->buf_¨ósË* 
¶ave
->
ch™√ls
);

465 i‡(!
mëî
->
buf_¨ós
) {

466 
	`‰ì
(
mëî
->
buf
);

467  -
ENOMEM
;

469 
ch™√l
 = 0; ch™√»< 
¶ave
->
ch™√ls
; ++channel) {

470 
¢d_pcm_ch™√l_¨ó_t
 *
a
 = &
mëî
->
buf_¨ós
[
ch™√l
];

471 
a
->
addr
 = 
mëî
->
buf
 + 
buf_size_byãs
 / 
¶ave
->
ch™√ls
 * 
ch™√l
;

472 
a
->
fú°
 = 0;

473 
a
->
°ï
 = 
¶ave
->
ßm∂e_bôs
;

475 
mëî
->
˛o£d
 = 0;

476 
îr
 = 
	`±hªad_¸óã
(&
mëî
->
thªad
, 
NULL
, 
¢d_pcm_mëî_thªad
, 
pcm
);

477 
	`as£π
(
îr
 == 0);

479 
	}
}

481 
	$¢d_pcm_mëî_hw_‰ì
(
¢d_pcm_t
 *
pcm
)

483 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

484 
îr
;

485 
mëî
->
˛o£d
 = 1;

486 
	`±hªad_muãx_lock
(&
mëî
->
ru¬ög_muãx
);

487 
	`±hªad_c⁄d_sig«l
(&
mëî
->
ru¬ög_c⁄d
);

488 
	`±hªad_muãx_u∆ock
(&
mëî
->
ru¬ög_muãx
);

489 
îr
 = 
	`±hªad_joö
(
mëî
->
thªad
, 0);

490 
	`as£π
(
îr
 == 0);

491 
	`‰ì
(
mëî
->
buf
);

492 
	`‰ì
(
mëî
->
buf_¨ós
);

493 
mëî
->
buf
 = 
NULL
;

494 
mëî
->
buf_¨ós
 = 
NULL
;

495  
	`¢d_pcm_hw_‰ì
(
mëî
->
gí
.
¶ave
);

496 
	}
}

498 
	$¢d_pcm_mëî_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

500 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

501 
	`¢d_ouçut_¥ötf
(
out
, "Meter PCM\n");

502 i‡(
pcm
->
£tup
) {

503 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

504 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

506 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

507 
	`¢d_pcm_dump
(
mëî
->
gí
.
¶ave
, 
out
);

508 
	}
}

510 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_mëî_›s
 = {

511 .
˛o£
 = 
¢d_pcm_mëî_˛o£
,

512 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

513 .
	ghw_ªföe
 = 
¢d_pcm_mëî_hw_ªföe
,

514 .
	ghw_∑øms
 = 
¢d_pcm_mëî_hw_∑øms
,

515 .
	ghw_‰ì
 = 
¢d_pcm_mëî_hw_‰ì
,

516 .
	gsw_∑øms
 = 
¢d_pcm_gíîic_sw_∑øms
,

517 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

518 .
	gdump
 = 
¢d_pcm_mëî_dump
,

519 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

520 .
	gasync
 = 
¢d_pcm_gíîic_async
,

521 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

522 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

523 .
	gquîy_chm≠s
 = 
¢d_pcm_gíîic_quîy_chm≠s
,

524 .
	ggë_chm≠
 = 
¢d_pcm_gíîic_gë_chm≠
,

525 .
	g£t_chm≠
 = 
¢d_pcm_gíîic_£t_chm≠
,

528 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_mëî_Á°_›s
 = {

529 .
°©us
 = 
¢d_pcm_gíîic_°©us
,

530 .
	g°©e
 = 
¢d_pcm_gíîic_°©e
,

531 .
	ghwsync
 = 
¢d_pcm_gíîic_hwsync
,

532 .
	gdñay
 = 
¢d_pcm_gíîic_dñay
,

533 .
	g¥ï¨e
 = 
¢d_pcm_mëî_¥ï¨e
,

534 .
	gª£t
 = 
¢d_pcm_mëî_ª£t
,

535 .
	g°¨t
 = 
¢d_pcm_mëî_°¨t
,

536 .
	gdr›
 = 
¢d_pcm_gíîic_dr›
,

537 .
	gdøö
 = 
¢d_pcm_gíîic_døö
,

538 .
	g∑u£
 = 
¢d_pcm_gíîic_∑u£
,

539 .
	gªwödabÀ
 = 
¢d_pcm_gíîic_ªwödabÀ
,

540 .
	gªwöd
 = 
¢d_pcm_mëî_ªwöd
,

541 .
	gf‹w¨dabÀ
 = 
¢d_pcm_gíîic_f‹w¨dabÀ
,

542 .
	gf‹w¨d
 = 
¢d_pcm_mëî_f‹w¨d
,

543 .
	gªsume
 = 
¢d_pcm_gíîic_ªsume
,

544 .
	gwrôei
 = 
¢d_pcm_mm≠_wrôei
,

545 .
	gwrôí
 = 
¢d_pcm_mm≠_wrôí
,

546 .
	gªadi
 = 
¢d_pcm_mm≠_ªadi
,

547 .
	gªadn
 = 
¢d_pcm_mm≠_ªadn
,

548 .
	gavaû_upd©e
 = 
¢d_pcm_mëî_avaû_upd©e
,

549 .
	gmm≠_commô
 = 
¢d_pcm_mëî_mm≠_commô
,

550 .
	ghtime°amp
 = 
¢d_pcm_gíîic_htime°amp
,

551 .
	gpﬁl_des¸ùt‹s_cou¡
 = 
¢d_pcm_gíîic_pﬁl_des¸ùt‹s_cou¡
,

552 .
	gpﬁl_des¸ùt‹s
 = 
¢d_pcm_gíîic_pﬁl_des¸ùt‹s
,

553 .
	gpﬁl_ªvíts
 = 
¢d_pcm_gíîic_pﬁl_ªvíts
,

554 .
	gmay_waô_f‹_avaû_mö
 = 
¢d_pcm_gíîic_may_waô_f‹_avaû_mö
,

569 
	$¢d_pcm_mëî_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
, 
‰equícy
,

570 
¢d_pcm_t
 *
¶ave
, 
˛o£_¶ave
)

572 
¢d_pcm_t
 *
pcm
;

573 
¢d_pcm_mëî_t
 *
mëî
;

574 
îr
;

575 
	`as£π
(
pcmp
);

576 
mëî
 = 
	`ˇŒoc
(1, (
¢d_pcm_mëî_t
));

577 i‡(!
mëî
)

578  -
ENOMEM
;

579 
mëî
->
gí
.
¶ave
 = slave;

580 
mëî
->
gí
.
˛o£_¶ave
 = close_slave;

581 
mëî
->
dñay
.
tv_£c
 = 0;

582 
mëî
->
dñay
.
tv_n£c
 = 1000000000 / 
‰equícy
;

583 
	`INIT_LIST_HEAD
(&
mëî
->
sc›es
);

585 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_METER
, 
«me
, 
¶ave
->
°ªam
, sœve->
mode
);

586 i‡(
îr
 < 0) {

587 
	`‰ì
(
mëî
);

588  
îr
;

590 
pcm
->
mm≠_rw
 = 1;

591 
pcm
->
mm≠_shadow
 = 1;

592 
pcm
->
›s
 = &
¢d_pcm_mëî_›s
;

593 
pcm
->
Á°_›s
 = &
¢d_pcm_mëî_Á°_›s
;

594 
pcm
->
¥iv©e_d©a
 = 
mëî
;

595 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

596 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

597 
pcm
->
t°amp_ty≥
 = 
¶ave
->tstamp_type;

598 
	`¢d_pcm_lök_hw_±r
(
pcm
, 
¶ave
);

599 
	`¢d_pcm_lök_≠∂_±r
(
pcm
, 
¶ave
);

600 *
pcmp
 = 
pcm
;

602 
	`±hªad_muãx_öô
(&
mëî
->
upd©e_muãx
, 
NULL
);

603 
	`±hªad_muãx_öô
(&
mëî
->
ru¬ög_muãx
, 
NULL
);

604 
	`±hªad_c⁄d_öô
(&
mëî
->
ru¬ög_c⁄d
, 
NULL
);

606 
	}
}

609 
	$¢d_pcm_mëî_add_sc›e_c⁄f
(
¢d_pcm_t
 *
pcm
, c⁄° *
«me
,

610 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
)

612 
buf
[256], 
îrbuf
[256];

613 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

614 c⁄° *
id
;

615 c⁄° *
lib
 = 
NULL
, *
›í_«me
 = NULL, *
°r
 = NULL;

616 
¢d_c⁄fig_t
 *
c
, *
ty≥_c⁄f
 = 
NULL
;

617 (*
›í_func
)(
¢d_pcm_t
 *, const *,

618 
¢d_c⁄fig_t
 *, snd_c⁄fig_à*Ë
NULL
;

619 
¢d_pcm_mëî_t
 *
mëî
 = 
pcm
->
¥iv©e_d©a
;

620 *
h
 = 
NULL
;

621 
îr
;

623 i‡(
	`¢d_c⁄fig_gë_ty≥
(
c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

624 
	`SNDERR
("InvÆidÅy≥ f‹ sc›ê%s", 
°r
);

625 
îr
 = -
EINVAL
;

626 
_îr
;

628 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
c⁄f
, "ty≥", &
c
);

629 i‡(
îr
 < 0) {

630 
	`SNDERR
("type isÇot defined");

631 
_îr
;

633 
îr
 = 
	`¢d_c⁄fig_gë_id
(
c
, &
id
);

634 i‡(
îr
 < 0) {

635 
	`SNDERR
("unableÅo get id");

636 
_îr
;

638 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
c
, &
°r
);

639 i‡(
îr
 < 0) {

640 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

641 
_îr
;

643 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "pcm_sc›e_ty≥", 
°r
, &
ty≥_c⁄f
);

644 i‡(
îr
 >= 0) {

645 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
ty≥_c⁄f
) {

646 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

647 c⁄° *
id
;

648 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

650 i‡(
	`°rcmp
(
id
, "comment") == 0)

652 i‡(
	`°rcmp
(
id
, "lib") == 0) {

653 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
lib
);

654 i‡(
îr
 < 0) {

655 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

656 
_îr
;

660 i‡(
	`°rcmp
(
id
, "open") == 0) {

661 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
›í_«me
);

662 i‡(
îr
 < 0) {

663 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

664 
_îr
;

668 
	`SNDERR
("Unknow¿fõld %s", 
id
);

669 
îr
 = -
EINVAL
;

670 
_îr
;

673 i‡(!
›í_«me
) {

674 
›í_«me
 = 
buf
;

675 
	`¢¥ötf
(
buf
, (buf), "_¢d_pcm_sc›e_%s_›í", 
°r
);

677 
h
 = 
	`INTERNAL
(
¢d_dl›í
)(
lib
, 
RTLD_NOW
, 
îrbuf
, (errbuf));

678 
›í_func
 = 
h
 ? 
	`dlsym
(h, 
›í_«me
Ë: 
NULL
;

679 
îr
 = 0;

680 i‡(!
h
) {

681 
	`SNDERR
("C™nŸ o≥¿sh¨edÜibøry %†(%s)", 
lib
, 
îrbuf
);

682 
îr
 = -
ENOENT
;

683 } i‡(!
›í_func
) {

684 
	`SNDERR
("symbﬁ %†i†nŸ deföed insidê%s", 
›í_«me
, 
lib
);

685 
	`¢d_dl˛o£
(
h
);

686 
îr
 = -
ENXIO
;

688 
_îr
:

689 i‡(
ty≥_c⁄f
)

690 
	`¢d_c⁄fig_dñëe
(
ty≥_c⁄f
);

691 i‡(! 
îr
) {

692 
îr
 = 
	`›í_func
(
pcm
, 
«me
, 
roŸ
, 
c⁄f
);

693 i‡(
îr
 < 0)

694 
	`¢d_dl˛o£
(
h
);

696 
mëî
->
dl_h™dÀ
 = 
h
;

698  
îr
;

699 
	}
}

758 
	$_¢d_pcm_mëî_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

759 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

760 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

762 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

763 
îr
;

764 
¢d_pcm_t
 *
•cm
;

765 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

766 
‰equícy
 = -1;

767 
¢d_c⁄fig_t
 *
sc›es
 = 
NULL
;

768 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

769 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

770 c⁄° *
id
;

771 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

773 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

775 i‡(
	`°rcmp
(
id
, "slave") == 0) {

776 
¶ave
 = 
n
;

779 i‡(
	`°rcmp
(
id
, "frequency") == 0) {

780 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
‰equícy
);

781 i‡(
îr
 < 0) {

782 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

783  -
EINVAL
;

787 i‡(
	`°rcmp
(
id
, "scopes") == 0) {

788 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

789 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

790  -
EINVAL
;

792 
sc›es
 = 
n
;

795 
	`SNDERR
("Unknow¿fõld %s", 
id
);

796  -
EINVAL
;

798 i‡(!
¶ave
) {

799 
	`SNDERR
("slave isÇot defined");

800  -
EINVAL
;

802 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 0);

803 i‡(
îr
 < 0)

804  
îr
;

805 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

806 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

807 i‡(
îr
 < 0)

808  
îr
;

809 
îr
 = 
	`¢d_pcm_mëî_›í
(
pcmp
, 
«me
, 
‰equícy
 > 0 ? (Ë‰equícy : 
FREQUENCY
, 
•cm
, 1);

810 i‡(
îr
 < 0) {

811 
	`¢d_pcm_˛o£
(
•cm
);

812  
îr
;

814 i‡(!
sc›es
)

816 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
sc›es
) {

817 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

818 c⁄° *
id
, *
°r
;

819 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

821 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
) >= 0) {

822 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "pcm_sc›e", 
°r
, &
n
);

823 i‡(
îr
 < 0) {

824 
	`SNDERR
("unknow¿pcm_sc›ê%s", 
°r
);

826 
îr
 = 
	`¢d_pcm_mëî_add_sc›e_c⁄f
(*
pcmp
, 
id
, 
roŸ
, 
n
);

827 
	`¢d_c⁄fig_dñëe
(
n
);

830 
îr
 = 
	`¢d_pcm_mëî_add_sc›e_c⁄f
(*
pcmp
, 
id
, 
roŸ
, 
n
);

831 i‡(
îr
 < 0) {

832 
	`¢d_pcm_˛o£
(*
pcmp
);

833  
îr
;

837 
	}
}

838 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_mëî_›í
, 
SND_PCM_DLSYM_VERSION
);

848 
	$¢d_pcm_mëî_add_sc›e
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sc›e_t
 *
sc›e
)

850 
¢d_pcm_mëî_t
 *
mëî
;

851 
	`as£π
(
pcm
->
ty≥
 =
SND_PCM_TYPE_METER
);

852 
mëî
 = 
pcm
->
¥iv©e_d©a
;

853 
	`li°_add_èû
(&
sc›e
->
li°
, &
mëî
->
sc›es
);

855 
	}
}

863 
¢d_pcm_sc›e_t
 *
	$¢d_pcm_mëî_£¨ch_sc›e
(
¢d_pcm_t
 *
pcm
, c⁄° *
«me
)

865 
¢d_pcm_mëî_t
 *
mëî
;

866 
li°_hód
 *
pos
;

867 
	`as£π
(
pcm
->
ty≥
 =
SND_PCM_TYPE_METER
);

868 
mëî
 = 
pcm
->
¥iv©e_d©a
;

869 
	`li°_f‹_óch
(
pos
, &
mëî
->
sc›es
) {

870 
¢d_pcm_sc›e_t
 *
sc›e
;

871 
sc›e
 = 
	`li°_íåy
(
pos
, 
¢d_pcm_sc›e_t
, 
li°
);

872 i‡(
sc›e
->
«me
 && 
	`°rcmp
(scope->name,Çame) == 0)

873  
sc›e
;

875  
NULL
;

876 
	}
}

883 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_mëî_gë_bufsize
(
¢d_pcm_t
 *
pcm
)

885 
¢d_pcm_mëî_t
 *
mëî
;

886 
	`as£π
(
pcm
->
ty≥
 =
SND_PCM_TYPE_METER
);

887 
mëî
 = 
pcm
->
¥iv©e_d©a
;

888 
	`as£π
(
mëî
->
gí
.
¶ave
->
£tup
);

889  
mëî
->
buf_size
;

890 
	}
}

897 
	$¢d_pcm_mëî_gë_ch™√ls
(
¢d_pcm_t
 *
pcm
)

899 
¢d_pcm_mëî_t
 *
mëî
;

900 
	`as£π
(
pcm
->
ty≥
 =
SND_PCM_TYPE_METER
);

901 
mëî
 = 
pcm
->
¥iv©e_d©a
;

902 
	`as£π
(
mëî
->
gí
.
¶ave
->
£tup
);

903  
mëî
->
gí
.
¶ave
->
ch™√ls
;

904 
	}
}

911 
	$¢d_pcm_mëî_gë_øã
(
¢d_pcm_t
 *
pcm
)

913 
¢d_pcm_mëî_t
 *
mëî
;

914 
	`as£π
(
pcm
->
ty≥
 =
SND_PCM_TYPE_METER
);

915 
mëî
 = 
pcm
->
¥iv©e_d©a
;

916 
	`as£π
(
mëî
->
gí
.
¶ave
->
£tup
);

917  
mëî
->
gí
.
¶ave
->
øã
;

918 
	}
}

925 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_mëî_gë_now
(
¢d_pcm_t
 *
pcm
)

927 
¢d_pcm_mëî_t
 *
mëî
;

928 
	`as£π
(
pcm
->
ty≥
 =
SND_PCM_TYPE_METER
);

929 
mëî
 = 
pcm
->
¥iv©e_d©a
;

930 
	`as£π
(
mëî
->
gí
.
¶ave
->
£tup
);

931  
mëî
->
now
;

932 
	}
}

939 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_mëî_gë_bound¨y
(
¢d_pcm_t
 *
pcm
)

941 
¢d_pcm_mëî_t
 *
mëî
;

942 
	`as£π
(
pcm
->
ty≥
 =
SND_PCM_TYPE_METER
);

943 
mëî
 = 
pcm
->
¥iv©e_d©a
;

944 
	`as£π
(
mëî
->
gí
.
¶ave
->
£tup
);

945  
mëî
->
gí
.
¶ave
->
bound¨y
;

946 
	}
}

953 
	$¢d_pcm_sc›e_£t_«me
(
¢d_pcm_sc›e_t
 *
sc›e
, c⁄° *
vÆ
)

955 
sc›e
->
«me
 = 
	`°rdup
(
vÆ
);

956 
	}
}

963 c⁄° *
	$¢d_pcm_sc›e_gë_«me
(
¢d_pcm_sc›e_t
 *
sc›e
)

965  
sc›e
->
«me
;

966 
	}
}

973 
	$¢d_pcm_sc›e_£t_›s
(
¢d_pcm_sc›e_t
 *
sc›e
, c⁄° 
¢d_pcm_sc›e_›s_t
 *
vÆ
)

975 
sc›e
->
›s
 = 
vÆ
;

976 
	}
}

983 *
	$¢d_pcm_sc›e_gë_ˇŒback_¥iv©e
(
¢d_pcm_sc›e_t
 *
sc›e
)

985  
sc›e
->
¥iv©e_d©a
;

986 
	}
}

993 
	$¢d_pcm_sc›e_£t_ˇŒback_¥iv©e
(
¢d_pcm_sc›e_t
 *
sc›e
, *
vÆ
)

995 
sc›e
->
¥iv©e_d©a
 = 
vÆ
;

996 
	}
}

998 #i‚de‡
DOC_HIDDEN


999 
	s_¢d_pcm_sc›e_s16
 {

1000 
¢d_pcm_t
 *
	mpcm
;

1001 
¢d_pcm_adpcm_°©e_t
 *
	madpcm_°©es
;

1002 
	mödex
;

1003 
¢d_pcm_u‰ames_t
 
	mﬁd
;

1004 
öt16_t
 *
	mbuf
;

1005 
¢d_pcm_ch™√l_¨ó_t
 *
	mbuf_¨ós
;

1006 } 
	t¢d_pcm_sc›e_s16_t
;

1008 
	$s16_íabÀ
(
¢d_pcm_sc›e_t
 *
sc›e
)

1010 
¢d_pcm_sc›e_s16_t
 *
s16
 = 
sc›e
->
¥iv©e_d©a
;

1011 
¢d_pcm_mëî_t
 *
mëî
 = 
s16
->
pcm
->
¥iv©e_d©a
;

1012 
¢d_pcm_t
 *
•cm
 = 
mëî
->
gí
.
¶ave
;

1013 
¢d_pcm_ch™√l_¨ó_t
 *
a
;

1014 
c
;

1015 
idx
;

1016 i‡(
•cm
->
f‹m©
 =
SND_PCM_FORMAT_S16
 &&

1017 
•cm
->
ac˚ss
 =
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
) {

1018 
s16
->
buf
 = (
öt16_t
 *Ë
mëî
->buf;

1019  -
EINVAL
;

1021 
•cm
->
f‹m©
) {

1022 
SND_PCM_FORMAT_A_LAW
:

1023 
SND_PCM_FORMAT_MU_LAW
:

1024 
SND_PCM_FORMAT_IMA_ADPCM
:

1025 
idx
 = 
	`¢d_pcm_löór_put_ödex
(
SND_PCM_FORMAT_S16
, SND_PCM_FORMAT_S16);

1027 
SND_PCM_FORMAT_S8
:

1028 
SND_PCM_FORMAT_S16_LE
:

1029 
SND_PCM_FORMAT_S16_BE
:

1030 
SND_PCM_FORMAT_S24_LE
:

1031 
SND_PCM_FORMAT_S24_BE
:

1032 
SND_PCM_FORMAT_S32_LE
:

1033 
SND_PCM_FORMAT_S32_BE
:

1034 
SND_PCM_FORMAT_U8
:

1035 
SND_PCM_FORMAT_U16_LE
:

1036 
SND_PCM_FORMAT_U16_BE
:

1037 
SND_PCM_FORMAT_U24_LE
:

1038 
SND_PCM_FORMAT_U24_BE
:

1039 
SND_PCM_FORMAT_U32_LE
:

1040 
SND_PCM_FORMAT_U32_BE
:

1041 
idx
 = 
	`¢d_pcm_löór_c⁄vît_ödex
(
•cm
->
f‹m©
, 
SND_PCM_FORMAT_S16
);

1044  -
EINVAL
;

1046 
s16
->
ödex
 = 
idx
;

1047 i‡(
•cm
->
f‹m©
 =
SND_PCM_FORMAT_IMA_ADPCM
) {

1048 
s16
->
adpcm_°©es
 = 
	`ˇŒoc
(
•cm
->
ch™√ls
, (*s16->adpcm_states));

1049 i‡(!
s16
->
adpcm_°©es
)

1050  -
ENOMEM
;

1052 
s16
->
buf
 = 
	`mÆloc
(
mëî
->
buf_size
 * 2 * 
•cm
->
ch™√ls
);

1053 i‡(!
s16
->
buf
) {

1054 
	`‰ì
(
s16
->
adpcm_°©es
);

1055  -
ENOMEM
;

1057 
a
 = 
	`ˇŒoc
(
•cm
->
ch™√ls
, (*a));

1058 i‡(!
a
) {

1059 
	`‰ì
(
s16
->
buf
);

1060 
	`‰ì
(
s16
->
adpcm_°©es
);

1061  -
ENOMEM
;

1063 
s16
->
buf_¨ós
 = 
a
;

1064 
c
 = 0; c < 
•cm
->
ch™√ls
; c++, 
a
++) {

1065 
a
->
addr
 = 
s16
->
buf
 + 
c
 * 
mëî
->
buf_size
;

1066 
a
->
fú°
 = 0;

1067 
a
->
°ï
 = 16;

1070 
	}
}

1072 
	$s16_dißbÀ
(
¢d_pcm_sc›e_t
 *
sc›e
)

1074 
¢d_pcm_sc›e_s16_t
 *
s16
 = 
sc›e
->
¥iv©e_d©a
;

1075 
	`‰ì
(
s16
->
adpcm_°©es
);

1076 
s16
->
adpcm_°©es
 = 
NULL
;

1077 
	`‰ì
(
s16
->
buf
);

1078 
s16
->
buf
 = 
NULL
;

1079 
	`‰ì
(
s16
->
buf_¨ós
);

1080 
s16
->
buf_¨ós
 = 0;

1081 
	}
}

1083 
	$s16_˛o£
(
¢d_pcm_sc›e_t
 *
sc›e
)

1085 
¢d_pcm_sc›e_s16_t
 *
s16
 = 
sc›e
->
¥iv©e_d©a
;

1086 
	`‰ì
(
s16
);

1087 
	}
}

1089 
	$s16_°¨t
(
¢d_pcm_sc›e_t
 *
sc›e
 
ATTRIBUTE_UNUSED
)

1091 
	}
}

1093 
	$s16_°›
(
¢d_pcm_sc›e_t
 *
sc›e
 
ATTRIBUTE_UNUSED
)

1095 
	}
}

1097 
	$s16_upd©e
(
¢d_pcm_sc›e_t
 *
sc›e
)

1099 
¢d_pcm_sc›e_s16_t
 *
s16
 = 
sc›e
->
¥iv©e_d©a
;

1100 
¢d_pcm_mëî_t
 *
mëî
 = 
s16
->
pcm
->
¥iv©e_d©a
;

1101 
¢d_pcm_t
 *
•cm
 = 
mëî
->
gí
.
¶ave
;

1102 
¢d_pcm_s‰ames_t
 
size
;

1103 
¢d_pcm_u‰ames_t
 
off£t
;

1104 
size
 = 
mëî
->
now
 - 
s16
->
ﬁd
;

1105 i‡(
size
 < 0)

1106 
size
 +
•cm
->
bound¨y
;

1107 i‡(
size
 > (
¢d_pcm_s‰ames_t
)
s16
->
pcm
->
buf„r_size
)

1108 
size
 = 
s16
->
pcm
->
buf„r_size
;

1109 
off£t
 = 
s16
->
ﬁd
 % 
mëî
->
buf_size
;

1110 
size
 > 0) {

1111 
¢d_pcm_u‰ames_t
 
‰ames
 = 
size
;

1112 
¢d_pcm_u‰ames_t
 
c⁄t
 = 
mëî
->
buf_size
 - 
off£t
;

1113 i‡(
‰ames
 > 
c⁄t
)

1114 
‰ames
 = 
c⁄t
;

1115 
•cm
->
f‹m©
) {

1116 
SND_PCM_FORMAT_A_LAW
:

1117 
	`¢d_pcm_Æaw_decode
(
s16
->
buf_¨ós
, 
off£t
,

1118 
mëî
->
buf_¨ós
, 
off£t
,

1119 
•cm
->
ch™√ls
, 
‰ames
,

1120 
s16
->
ödex
);

1122 
SND_PCM_FORMAT_MU_LAW
:

1123 
	`¢d_pcm_muœw_decode
(
s16
->
buf_¨ós
, 
off£t
,

1124 
mëî
->
buf_¨ós
, 
off£t
,

1125 
•cm
->
ch™√ls
, 
‰ames
,

1126 
s16
->
ödex
);

1128 
SND_PCM_FORMAT_IMA_ADPCM
:

1129 
	`¢d_pcm_adpcm_decode
(
s16
->
buf_¨ós
, 
off£t
,

1130 
mëî
->
buf_¨ós
, 
off£t
,

1131 
•cm
->
ch™√ls
, 
‰ames
,

1132 
s16
->
ödex
,

1133 
s16
->
adpcm_°©es
);

1136 
	`¢d_pcm_löór_c⁄vît
(
s16
->
buf_¨ós
, 
off£t
,

1137 
mëî
->
buf_¨ós
, 
off£t
,

1138 
•cm
->
ch™√ls
, 
‰ames
,

1139 
s16
->
ödex
);

1142 i‡(
‰ames
 =
c⁄t
)

1143 
off£t
 = 0;

1145 
off£t
 +
‰ames
;

1146 
size
 -
‰ames
;

1148 
s16
->
ﬁd
 = 
mëî
->
now
;

1149 
	}
}

1151 
	$s16_ª£t
(
¢d_pcm_sc›e_t
 *
sc›e
)

1153 
¢d_pcm_sc›e_s16_t
 *
s16
 = 
sc›e
->
¥iv©e_d©a
;

1154 
¢d_pcm_mëî_t
 *
mëî
 = 
s16
->
pcm
->
¥iv©e_d©a
;

1155 
s16
->
ﬁd
 = 
mëî
->
now
;

1156 
	}
}

1158 c⁄° 
¢d_pcm_sc›e_›s_t
 
	gs16_›s
 = {

1159 .
íabÀ
 = 
s16_íabÀ
,

1160 .
	gdißbÀ
 = 
s16_dißbÀ
,

1161 .
	g˛o£
 = 
s16_˛o£
,

1162 .
	g°¨t
 = 
s16_°¨t
,

1163 .
	g°›
 = 
s16_°›
,

1164 .
	gupd©e
 = 
s16_upd©e
,

1165 .
	gª£t
 = 
s16_ª£t
,

1181 
	$¢d_pcm_sc›e_s16_›í
(
¢d_pcm_t
 *
pcm
, c⁄° *
«me
,

1182 
¢d_pcm_sc›e_t
 **
sc›ï
)

1184 
¢d_pcm_mëî_t
 *
mëî
;

1185 
¢d_pcm_sc›e_t
 *
sc›e
;

1186 
¢d_pcm_sc›e_s16_t
 *
s16
;

1187 
	`as£π
(
pcm
->
ty≥
 =
SND_PCM_TYPE_METER
);

1188 
mëî
 = 
pcm
->
¥iv©e_d©a
;

1189 
sc›e
 = 
	`ˇŒoc
(1, (*scope));

1190 i‡(!
sc›e
)

1191  -
ENOMEM
;

1192 
s16
 = 
	`ˇŒoc
(1, (*s16));

1193 i‡(!
s16
) {

1194 
	`‰ì
(
sc›e
);

1195  -
ENOMEM
;

1197 i‡(
«me
)

1198 
sc›e
->
«me
 = 
	`°rdup
(name);

1199 
s16
->
pcm
 =Öcm;

1200 
sc›e
->
›s
 = &
s16_›s
;

1201 
sc›e
->
¥iv©e_d©a
 = 
s16
;

1202 
	`li°_add_èû
(&
sc›e
->
li°
, &
mëî
->
sc›es
);

1203 *
sc›ï
 = 
sc›e
;

1205 
	}
}

1213 
öt16_t
 *
	$¢d_pcm_sc›e_s16_gë_ch™√l_buf„r
(
¢d_pcm_sc›e_t
 *
sc›e
,

1214 
ch™√l
)

1216 
¢d_pcm_sc›e_s16_t
 *
s16
;

1217 
¢d_pcm_mëî_t
 *
mëî
;

1218 
	`as£π
(
sc›e
->
›s
 =&
s16_›s
);

1219 
s16
 = 
sc›e
->
¥iv©e_d©a
;

1220 
mëî
 = 
s16
->
pcm
->
¥iv©e_d©a
;

1221 
	`as£π
(
mëî
->
gí
.
¶ave
->
£tup
);

1222 
	`as£π
(
s16
->
buf_¨ós
);

1223 
	`as£π
(
ch™√l
 < 
mëî
->
gí
.
¶ave
->
ch™√ls
);

1224  
s16
->
buf_¨ós
[
ch™√l
].
addr
;

1225 
	}
}

1232 
	$¢d_pcm_sc›e_mÆloc
(
¢d_pcm_sc›e_t
 **
±r
)

1234 
	`as£π
(
±r
);

1235 *
±r
 = 
	`ˇŒoc
(1, (
¢d_pcm_sc›e_t
));

1236 i‡(!*
±r
)

1237  -
ENOMEM
;

1239 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_misc.c

22 
	~"pcm_loˇl.h
"

23 
	~"bsw≠.h
"

24 
	~<°dio.h
>

25 
	~<°dlib.h
>

26 
	~<uni°d.h
>

27 
	~<°rög.h
>

35 
	$¢d_pcm_f‹m©_sig√d
(
¢d_pcm_f‹m©_t
 
f‹m©
)

37 
f‹m©
) {

38 
SNDRV_PCM_FORMAT_S8
:

39 
SNDRV_PCM_FORMAT_S16_LE
:

40 
SNDRV_PCM_FORMAT_S16_BE
:

41 
SNDRV_PCM_FORMAT_S20_LE
:

42 
SNDRV_PCM_FORMAT_S20_BE
:

43 
SNDRV_PCM_FORMAT_S24_LE
:

44 
SNDRV_PCM_FORMAT_S24_BE
:

45 
SNDRV_PCM_FORMAT_S32_LE
:

46 
SNDRV_PCM_FORMAT_S32_BE
:

47 
SNDRV_PCM_FORMAT_S24_3LE
:

48 
SNDRV_PCM_FORMAT_S24_3BE
:

49 
SNDRV_PCM_FORMAT_S20_3LE
:

50 
SNDRV_PCM_FORMAT_S20_3BE
:

51 
SNDRV_PCM_FORMAT_S18_3LE
:

52 
SNDRV_PCM_FORMAT_S18_3BE
:

54 
SNDRV_PCM_FORMAT_U8
:

55 
SNDRV_PCM_FORMAT_U16_LE
:

56 
SNDRV_PCM_FORMAT_U16_BE
:

57 
SNDRV_PCM_FORMAT_U20_LE
:

58 
SNDRV_PCM_FORMAT_U20_BE
:

59 
SNDRV_PCM_FORMAT_U24_LE
:

60 
SNDRV_PCM_FORMAT_U24_BE
:

61 
SNDRV_PCM_FORMAT_U32_LE
:

62 
SNDRV_PCM_FORMAT_U32_BE
:

63 
SNDRV_PCM_FORMAT_U24_3LE
:

64 
SNDRV_PCM_FORMAT_U24_3BE
:

65 
SNDRV_PCM_FORMAT_U20_3LE
:

66 
SNDRV_PCM_FORMAT_U20_3BE
:

67 
SNDRV_PCM_FORMAT_U18_3LE
:

68 
SNDRV_PCM_FORMAT_U18_3BE
:

69 
SNDRV_PCM_FORMAT_DSD_U8
:

70 
SNDRV_PCM_FORMAT_DSD_U16_LE
:

71 
SNDRV_PCM_FORMAT_DSD_U32_LE
:

72 
SNDRV_PCM_FORMAT_DSD_U16_BE
:

73 
SNDRV_PCM_FORMAT_DSD_U32_BE
:

76  -
EINVAL
;

78 
	}
}

85 
	$¢d_pcm_f‹m©_unsig√d
(
¢d_pcm_f‹m©_t
 
f‹m©
)

87 
vÆ
;

89 
vÆ
 = 
	`¢d_pcm_f‹m©_sig√d
(
f‹m©
);

90 i‡(
vÆ
 < 0)

91  
vÆ
;

92  !
vÆ
;

93 
	}
}

100 
	$¢d_pcm_f‹m©_löór
(
¢d_pcm_f‹m©_t
 
f‹m©
)

102  
	`¢d_pcm_f‹m©_sig√d
(
f‹m©
) >= 0;

103 
	}
}

110 
	$¢d_pcm_f‹m©_Êﬂt
(
¢d_pcm_f‹m©_t
 
f‹m©
)

112 
f‹m©
) {

113 
SNDRV_PCM_FORMAT_FLOAT_LE
:

114 
SNDRV_PCM_FORMAT_FLOAT_BE
:

115 
SNDRV_PCM_FORMAT_FLOAT64_LE
:

116 
SNDRV_PCM_FORMAT_FLOAT64_BE
:

121 
	}
}

128 
	$¢d_pcm_f‹m©_lôée_ídün
(
¢d_pcm_f‹m©_t
 
f‹m©
)

130 
f‹m©
) {

131 
SNDRV_PCM_FORMAT_S16_LE
:

132 
SNDRV_PCM_FORMAT_U16_LE
:

133 
SNDRV_PCM_FORMAT_S20_LE
:

134 
SNDRV_PCM_FORMAT_U20_LE
:

135 
SNDRV_PCM_FORMAT_S24_LE
:

136 
SNDRV_PCM_FORMAT_U24_LE
:

137 
SNDRV_PCM_FORMAT_S32_LE
:

138 
SNDRV_PCM_FORMAT_U32_LE
:

139 
SNDRV_PCM_FORMAT_FLOAT_LE
:

140 
SNDRV_PCM_FORMAT_FLOAT64_LE
:

141 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_LE
:

142 
SNDRV_PCM_FORMAT_S24_3LE
:

143 
SNDRV_PCM_FORMAT_S20_3LE
:

144 
SNDRV_PCM_FORMAT_S18_3LE
:

145 
SNDRV_PCM_FORMAT_U24_3LE
:

146 
SNDRV_PCM_FORMAT_U20_3LE
:

147 
SNDRV_PCM_FORMAT_U18_3LE
:

148 
SNDRV_PCM_FORMAT_DSD_U16_LE
:

149 
SNDRV_PCM_FORMAT_DSD_U32_LE
:

151 
SNDRV_PCM_FORMAT_S16_BE
:

152 
SNDRV_PCM_FORMAT_U16_BE
:

153 
SNDRV_PCM_FORMAT_S20_BE
:

154 
SNDRV_PCM_FORMAT_U20_BE
:

155 
SNDRV_PCM_FORMAT_S24_BE
:

156 
SNDRV_PCM_FORMAT_U24_BE
:

157 
SNDRV_PCM_FORMAT_S32_BE
:

158 
SNDRV_PCM_FORMAT_U32_BE
:

159 
SNDRV_PCM_FORMAT_FLOAT_BE
:

160 
SNDRV_PCM_FORMAT_FLOAT64_BE
:

161 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_BE
:

162 
SNDRV_PCM_FORMAT_S24_3BE
:

163 
SNDRV_PCM_FORMAT_S20_3BE
:

164 
SNDRV_PCM_FORMAT_S18_3BE
:

165 
SNDRV_PCM_FORMAT_U24_3BE
:

166 
SNDRV_PCM_FORMAT_U20_3BE
:

167 
SNDRV_PCM_FORMAT_U18_3BE
:

168 
SNDRV_PCM_FORMAT_DSD_U16_BE
:

169 
SNDRV_PCM_FORMAT_DSD_U32_BE
:

172  -
EINVAL
;

174 
	}
}

181 
	$¢d_pcm_f‹m©_big_ídün
(
¢d_pcm_f‹m©_t
 
f‹m©
)

183 
vÆ
;

185 
vÆ
 = 
	`¢d_pcm_f‹m©_lôée_ídün
(
f‹m©
);

186 i‡(
vÆ
 < 0)

187  
vÆ
;

188  !
vÆ
;

189 
	}
}

196 
	$¢d_pcm_f‹m©_˝u_ídün
(
¢d_pcm_f‹m©_t
 
f‹m©
)

198 #ifde‡
SNDRV_LITTLE_ENDIAN


199  
	`¢d_pcm_f‹m©_lôée_ídün
(
f‹m©
);

201  
	`¢d_pcm_f‹m©_big_ídün
(
f‹m©
);

203 
	}
}

210 
	$¢d_pcm_f‹m©_width
(
¢d_pcm_f‹m©_t
 
f‹m©
)

212 
f‹m©
) {

213 
SNDRV_PCM_FORMAT_S8
:

214 
SNDRV_PCM_FORMAT_U8
:

215 
SNDRV_PCM_FORMAT_DSD_U8
:

217 
SNDRV_PCM_FORMAT_S16_LE
:

218 
SNDRV_PCM_FORMAT_S16_BE
:

219 
SNDRV_PCM_FORMAT_U16_LE
:

220 
SNDRV_PCM_FORMAT_U16_BE
:

221 
SNDRV_PCM_FORMAT_DSD_U16_LE
:

222 
SNDRV_PCM_FORMAT_DSD_U16_BE
:

224 
SNDRV_PCM_FORMAT_S18_3LE
:

225 
SNDRV_PCM_FORMAT_S18_3BE
:

226 
SNDRV_PCM_FORMAT_U18_3LE
:

227 
SNDRV_PCM_FORMAT_U18_3BE
:

229 
SNDRV_PCM_FORMAT_S20_LE
:

230 
SNDRV_PCM_FORMAT_S20_BE
:

231 
SNDRV_PCM_FORMAT_U20_LE
:

232 
SNDRV_PCM_FORMAT_U20_BE
:

233 
SNDRV_PCM_FORMAT_S20_3LE
:

234 
SNDRV_PCM_FORMAT_S20_3BE
:

235 
SNDRV_PCM_FORMAT_U20_3LE
:

236 
SNDRV_PCM_FORMAT_U20_3BE
:

238 
SNDRV_PCM_FORMAT_S24_LE
:

239 
SNDRV_PCM_FORMAT_S24_BE
:

240 
SNDRV_PCM_FORMAT_U24_LE
:

241 
SNDRV_PCM_FORMAT_U24_BE
:

242 
SNDRV_PCM_FORMAT_S24_3LE
:

243 
SNDRV_PCM_FORMAT_S24_3BE
:

244 
SNDRV_PCM_FORMAT_U24_3LE
:

245 
SNDRV_PCM_FORMAT_U24_3BE
:

247 
SNDRV_PCM_FORMAT_S32_LE
:

248 
SNDRV_PCM_FORMAT_S32_BE
:

249 
SNDRV_PCM_FORMAT_U32_LE
:

250 
SNDRV_PCM_FORMAT_U32_BE
:

251 
SNDRV_PCM_FORMAT_FLOAT_LE
:

252 
SNDRV_PCM_FORMAT_FLOAT_BE
:

253 
SNDRV_PCM_FORMAT_DSD_U32_LE
:

254 
SNDRV_PCM_FORMAT_DSD_U32_BE
:

256 
SNDRV_PCM_FORMAT_FLOAT64_LE
:

257 
SNDRV_PCM_FORMAT_FLOAT64_BE
:

259 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_LE
:

260 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_BE
:

262 
SNDRV_PCM_FORMAT_MU_LAW
:

263 
SNDRV_PCM_FORMAT_A_LAW
:

265 
SNDRV_PCM_FORMAT_IMA_ADPCM
:

268  -
EINVAL
;

270 
	}
}

277 
	$¢d_pcm_f‹m©_physiˇl_width
(
¢d_pcm_f‹m©_t
 
f‹m©
)

279 
f‹m©
) {

280 
SNDRV_PCM_FORMAT_S8
:

281 
SNDRV_PCM_FORMAT_U8
:

282 
SNDRV_PCM_FORMAT_DSD_U8
:

284 
SNDRV_PCM_FORMAT_S16_LE
:

285 
SNDRV_PCM_FORMAT_S16_BE
:

286 
SNDRV_PCM_FORMAT_U16_LE
:

287 
SNDRV_PCM_FORMAT_U16_BE
:

288 
SNDRV_PCM_FORMAT_DSD_U16_LE
:

289 
SNDRV_PCM_FORMAT_DSD_U16_BE
:

291 
SNDRV_PCM_FORMAT_S18_3LE
:

292 
SNDRV_PCM_FORMAT_S18_3BE
:

293 
SNDRV_PCM_FORMAT_U18_3LE
:

294 
SNDRV_PCM_FORMAT_U18_3BE
:

295 
SNDRV_PCM_FORMAT_S20_3LE
:

296 
SNDRV_PCM_FORMAT_S20_3BE
:

297 
SNDRV_PCM_FORMAT_U20_3LE
:

298 
SNDRV_PCM_FORMAT_U20_3BE
:

299 
SNDRV_PCM_FORMAT_S24_3LE
:

300 
SNDRV_PCM_FORMAT_S24_3BE
:

301 
SNDRV_PCM_FORMAT_U24_3LE
:

302 
SNDRV_PCM_FORMAT_U24_3BE
:

304 
SNDRV_PCM_FORMAT_S20_LE
:

305 
SNDRV_PCM_FORMAT_S20_BE
:

306 
SNDRV_PCM_FORMAT_U20_LE
:

307 
SNDRV_PCM_FORMAT_U20_BE
:

308 
SNDRV_PCM_FORMAT_S24_LE
:

309 
SNDRV_PCM_FORMAT_S24_BE
:

310 
SNDRV_PCM_FORMAT_U24_LE
:

311 
SNDRV_PCM_FORMAT_U24_BE
:

312 
SNDRV_PCM_FORMAT_S32_LE
:

313 
SNDRV_PCM_FORMAT_S32_BE
:

314 
SNDRV_PCM_FORMAT_U32_LE
:

315 
SNDRV_PCM_FORMAT_U32_BE
:

316 
SNDRV_PCM_FORMAT_FLOAT_LE
:

317 
SNDRV_PCM_FORMAT_FLOAT_BE
:

318 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_LE
:

319 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_BE
:

320 
SNDRV_PCM_FORMAT_DSD_U32_LE
:

321 
SNDRV_PCM_FORMAT_DSD_U32_BE
:

323 
SNDRV_PCM_FORMAT_FLOAT64_LE
:

324 
SNDRV_PCM_FORMAT_FLOAT64_BE
:

326 
SNDRV_PCM_FORMAT_MU_LAW
:

327 
SNDRV_PCM_FORMAT_A_LAW
:

329 
SNDRV_PCM_FORMAT_IMA_ADPCM
:

332  -
EINVAL
;

334 
	}
}

342 
ssize_t
 
	$¢d_pcm_f‹m©_size
(
¢d_pcm_f‹m©_t
 
f‹m©
, 
size_t
 
ßm∂es
)

344 
f‹m©
) {

345 
SNDRV_PCM_FORMAT_S8
:

346 
SNDRV_PCM_FORMAT_U8
:

347 
SNDRV_PCM_FORMAT_DSD_U8
:

348  
ßm∂es
;

349 
SNDRV_PCM_FORMAT_S16_LE
:

350 
SNDRV_PCM_FORMAT_S16_BE
:

351 
SNDRV_PCM_FORMAT_U16_LE
:

352 
SNDRV_PCM_FORMAT_U16_BE
:

353 
SNDRV_PCM_FORMAT_DSD_U16_LE
:

354 
SNDRV_PCM_FORMAT_DSD_U16_BE
:

355  
ßm∂es
 * 2;

356 
SNDRV_PCM_FORMAT_S18_3LE
:

357 
SNDRV_PCM_FORMAT_S18_3BE
:

358 
SNDRV_PCM_FORMAT_U18_3LE
:

359 
SNDRV_PCM_FORMAT_U18_3BE
:

360 
SNDRV_PCM_FORMAT_S20_3LE
:

361 
SNDRV_PCM_FORMAT_S20_3BE
:

362 
SNDRV_PCM_FORMAT_U20_3LE
:

363 
SNDRV_PCM_FORMAT_U20_3BE
:

364 
SNDRV_PCM_FORMAT_S24_3LE
:

365 
SNDRV_PCM_FORMAT_S24_3BE
:

366 
SNDRV_PCM_FORMAT_U24_3LE
:

367 
SNDRV_PCM_FORMAT_U24_3BE
:

368  
ßm∂es
 * 3;

369 
SNDRV_PCM_FORMAT_S20_LE
:

370 
SNDRV_PCM_FORMAT_S20_BE
:

371 
SNDRV_PCM_FORMAT_U20_LE
:

372 
SNDRV_PCM_FORMAT_U20_BE
:

373 
SNDRV_PCM_FORMAT_S24_LE
:

374 
SNDRV_PCM_FORMAT_S24_BE
:

375 
SNDRV_PCM_FORMAT_U24_LE
:

376 
SNDRV_PCM_FORMAT_U24_BE
:

377 
SNDRV_PCM_FORMAT_S32_LE
:

378 
SNDRV_PCM_FORMAT_S32_BE
:

379 
SNDRV_PCM_FORMAT_U32_LE
:

380 
SNDRV_PCM_FORMAT_U32_BE
:

381 
SNDRV_PCM_FORMAT_FLOAT_LE
:

382 
SNDRV_PCM_FORMAT_FLOAT_BE
:

383 
SNDRV_PCM_FORMAT_DSD_U32_LE
:

384 
SNDRV_PCM_FORMAT_DSD_U32_BE
:

385  
ßm∂es
 * 4;

386 
SNDRV_PCM_FORMAT_FLOAT64_LE
:

387 
SNDRV_PCM_FORMAT_FLOAT64_BE
:

388  
ßm∂es
 * 8;

389 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_LE
:

390 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_BE
:

391  
ßm∂es
 * 4;

392 
SNDRV_PCM_FORMAT_MU_LAW
:

393 
SNDRV_PCM_FORMAT_A_LAW
:

394  
ßm∂es
;

395 
SNDRV_PCM_FORMAT_IMA_ADPCM
:

396 i‡(
ßm∂es
 & 1)

397  -
EINVAL
;

398  
ßm∂es
 / 2;

400 
	`as£π
(0);

401  -
EINVAL
;

403 
	}
}

410 
uöt64_t
 
	$¢d_pcm_f‹m©_sûí˚_64
(
¢d_pcm_f‹m©_t
 
f‹m©
)

412 
f‹m©
) {

413 
SNDRV_PCM_FORMAT_S8
:

414 
SNDRV_PCM_FORMAT_S16_LE
:

415 
SNDRV_PCM_FORMAT_S16_BE
:

416 
SNDRV_PCM_FORMAT_S20_LE
:

417 
SNDRV_PCM_FORMAT_S20_BE
:

418 
SNDRV_PCM_FORMAT_S24_LE
:

419 
SNDRV_PCM_FORMAT_S24_BE
:

420 
SNDRV_PCM_FORMAT_S32_LE
:

421 
SNDRV_PCM_FORMAT_S32_BE
:

422 
SNDRV_PCM_FORMAT_S24_3LE
:

423 
SNDRV_PCM_FORMAT_S24_3BE
:

424 
SNDRV_PCM_FORMAT_S20_3LE
:

425 
SNDRV_PCM_FORMAT_S20_3BE
:

426 
SNDRV_PCM_FORMAT_S18_3LE
:

427 
SNDRV_PCM_FORMAT_S18_3BE
:

429 
SNDRV_PCM_FORMAT_U8
:

431 
SNDRV_PCM_FORMAT_DSD_U8
:

432 
SNDRV_PCM_FORMAT_DSD_U16_LE
:

433 
SNDRV_PCM_FORMAT_DSD_U32_LE
:

434 
SNDRV_PCM_FORMAT_DSD_U16_BE
:

435 
SNDRV_PCM_FORMAT_DSD_U32_BE
:

437 #ifde‡
SNDRV_LITTLE_ENDIAN


438 
SNDRV_PCM_FORMAT_U16_LE
:

440 
SNDRV_PCM_FORMAT_U20_LE
:

442 
SNDRV_PCM_FORMAT_U24_LE
:

444 
SNDRV_PCM_FORMAT_U32_LE
:

446 
SNDRV_PCM_FORMAT_U16_BE
:

448 
SNDRV_PCM_FORMAT_U20_BE
:

450 
SNDRV_PCM_FORMAT_U24_BE
:

452 
SNDRV_PCM_FORMAT_U32_BE
:

454 
SNDRV_PCM_FORMAT_U24_3LE
:

456 
SNDRV_PCM_FORMAT_U24_3BE
:

458 
SNDRV_PCM_FORMAT_U20_3LE
:

460 
SNDRV_PCM_FORMAT_U20_3BE
:

462 
SNDRV_PCM_FORMAT_U18_3LE
:

464 
SNDRV_PCM_FORMAT_U18_3BE
:

467 
SNDRV_PCM_FORMAT_U16_LE
:

469 
SNDRV_PCM_FORMAT_U20_LE
:

471 
SNDRV_PCM_FORMAT_U24_LE
:

473 
SNDRV_PCM_FORMAT_U32_LE
:

475 
SNDRV_PCM_FORMAT_U16_BE
:

477 
SNDRV_PCM_FORMAT_U20_BE
:

479 
SNDRV_PCM_FORMAT_U24_BE
:

481 
SNDRV_PCM_FORMAT_U32_BE
:

483 
SNDRV_PCM_FORMAT_U24_3LE
:

485 
SNDRV_PCM_FORMAT_U24_3BE
:

487 
SNDRV_PCM_FORMAT_U20_3LE
:

489 
SNDRV_PCM_FORMAT_U20_3BE
:

491 
SNDRV_PCM_FORMAT_U18_3LE
:

493 
SNDRV_PCM_FORMAT_U18_3BE
:

496 
SNDRV_PCM_FORMAT_FLOAT_LE
:

499 
f
[2];

500 
uöt64_t
 
i
;

501 } 
u
;

502 
u
.
f
[0] = u.f[1] = 0.0;

503 #ifde‡
SNDRV_LITTLE_ENDIAN


504  
u
.
i
;

506  
	`bsw≠_64
(
u
.
i
);

509 
SNDRV_PCM_FORMAT_FLOAT64_LE
:

512 
f
;

513 
uöt64_t
 
i
;

514 } 
u
;

515 
u
.
f
 = 0.0;

516 #ifde‡
SNDRV_LITTLE_ENDIAN


517  
u
.
i
;

519  
	`bsw≠_64
(
u
.
i
);

522 
SNDRV_PCM_FORMAT_FLOAT_BE
:

525 
f
[2];

526 
uöt64_t
 
i
;

527 } 
u
;

528 
u
.
f
[0] = u.f[1] = 0.0;

529 #ifde‡
SNDRV_LITTLE_ENDIAN


530  
	`bsw≠_64
(
u
.
i
);

532  
u
.
i
;

535 
SNDRV_PCM_FORMAT_FLOAT64_BE
:

538 
f
;

539 
uöt64_t
 
i
;

540 } 
u
;

541 
u
.
f
 = 0.0;

542 #ifde‡
SNDRV_LITTLE_ENDIAN


543  
	`bsw≠_64
(
u
.
i
);

545  
u
.
i
;

548 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_LE
:

549 
SNDRV_PCM_FORMAT_IEC958_SUBFRAME_BE
:

551 
SNDRV_PCM_FORMAT_MU_LAW
:

553 
SNDRV_PCM_FORMAT_A_LAW
:

555 
SNDRV_PCM_FORMAT_IMA_ADPCM
:

556 
SNDRV_PCM_FORMAT_MPEG
:

557 
SNDRV_PCM_FORMAT_GSM
:

558 
SNDRV_PCM_FORMAT_SPECIAL
:

561 
	`as£π
(0);

565 
	}
}

572 
uöt32_t
 
	$¢d_pcm_f‹m©_sûí˚_32
(
¢d_pcm_f‹m©_t
 
f‹m©
)

574 
	`as£π
(
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
) <= 32);

575  (
uöt32_t
)
	`¢d_pcm_f‹m©_sûí˚_64
(
f‹m©
);

576 
	}
}

583 
uöt16_t
 
	$¢d_pcm_f‹m©_sûí˚_16
(
¢d_pcm_f‹m©_t
 
f‹m©
)

585 
	`as£π
(
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
) <= 16);

586  (
uöt16_t
)
	`¢d_pcm_f‹m©_sûí˚_64
(
f‹m©
);

587 
	}
}

594 
uöt8_t
 
	$¢d_pcm_f‹m©_sûí˚
(
¢d_pcm_f‹m©_t
 
f‹m©
)

596 
	`as£π
(
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
) <= 8);

597  (
uöt8_t
)
	`¢d_pcm_f‹m©_sûí˚_64
(
f‹m©
);

598 
	}
}

607 
	$¢d_pcm_f‹m©_£t_sûí˚
(
¢d_pcm_f‹m©_t
 
f‹m©
, *
d©a
, 
ßm∂es
)

609 i‡(
ßm∂es
 == 0)

611 
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
)) {

613 
uöt8_t
 
sûí˚
 = 
	`¢d_pcm_f‹m©_sûí˚_64
(
f‹m©
);

614 
ßm∂es1
;

615 i‡(
ßm∂es
 % 2 != 0)

616  -
EINVAL
;

617 
ßm∂es1
 = 
ßm∂es
 / 2;

618 
	`mem£t
(
d©a
, 
sûí˚
, 
ßm∂es1
);

622 
uöt8_t
 
sûí˚
 = 
	`¢d_pcm_f‹m©_sûí˚_64
(
f‹m©
);

623 
	`mem£t
(
d©a
, 
sûí˚
, 
ßm∂es
);

627 
uöt16_t
 
sûí˚
 = 
	`¢d_pcm_f‹m©_sûí˚_64
(
f‹m©
);

628 
uöt16_t
 *
pd©a
 = (uöt16_à*)
d©a
;

629 i‡(! 
sûí˚
)

630 
	`mem£t
(
d©a
, 0, 
ßm∂es
 * 2);

632 
ßm∂es
-- > 0)

633 *
pd©a
++ = 
sûí˚
;

638 
uöt32_t
 
sûí˚
 = 
	`¢d_pcm_f‹m©_sûí˚_64
(
f‹m©
);

639 
uöt8_t
 *
pd©a
 = (uöt8_à*)
d©a
;

640 i‡(! 
sûí˚
)

641 
	`mem£t
(
d©a
, 0, 
ßm∂es
 * 3);

643 
ßm∂es
-- > 0) {

644 #ifde‡
SNDRV_LITTLE_ENDIAN


645 *
pd©a
++ = 
sûí˚
 >> 0;

646 *
pd©a
++ = 
sûí˚
 >> 8;

647 *
pd©a
++ = 
sûí˚
 >> 16;

649 *
pd©a
++ = 
sûí˚
 >> 16;

650 *
pd©a
++ = 
sûí˚
 >> 8;

651 *
pd©a
++ = 
sûí˚
 >> 0;

658 
uöt32_t
 
sûí˚
 = 
	`¢d_pcm_f‹m©_sûí˚_64
(
f‹m©
);

659 
uöt32_t
 *
pd©a
 = (uöt32_à*)
d©a
;

660 i‡(! 
sûí˚
)

661 
	`mem£t
(
d©a
, 0, 
ßm∂es
 * 4);

663 
ßm∂es
-- > 0)

664 *
pd©a
++ = 
sûí˚
;

669 
uöt64_t
 
sûí˚
 = 
	`¢d_pcm_f‹m©_sûí˚_64
(
f‹m©
);

670 
uöt64_t
 *
pd©a
 = (uöt64_à*)
d©a
;

671 i‡(! 
sûí˚
)

672 
	`mem£t
(
d©a
, 0, 
ßm∂es
 * 8);

674 
ßm∂es
-- > 0)

675 *
pd©a
++ = 
sûí˚
;

680 
	`as£π
(0);

681  -
EINVAL
;

684 
	}
}

686 c⁄° 
	glöór_f‹m©s
[5][2][2] = {

687 { { 
SNDRV_PCM_FORMAT_S8
, SNDRV_PCM_FORMAT_S8 },

688 { 
SNDRV_PCM_FORMAT_U8
, SNDRV_PCM_FORMAT_U8 } },

689 { { 
SNDRV_PCM_FORMAT_S16_LE
, 
SNDRV_PCM_FORMAT_S16_BE
 },

690 { 
SNDRV_PCM_FORMAT_U16_LE
, 
SNDRV_PCM_FORMAT_U16_BE
 } },

691 { { 
SNDRV_PCM_FORMAT_S20_LE
, 
SNDRV_PCM_FORMAT_S20_BE
 },

692 { 
SNDRV_PCM_FORMAT_U20_LE
, 
SNDRV_PCM_FORMAT_U20_BE
 } },

693 { { 
SNDRV_PCM_FORMAT_S24_LE
, 
SNDRV_PCM_FORMAT_S24_BE
 },

694 { 
SNDRV_PCM_FORMAT_U24_LE
, 
SNDRV_PCM_FORMAT_U24_BE
 } },

695 { { 
SNDRV_PCM_FORMAT_S32_LE
, 
SNDRV_PCM_FORMAT_S32_BE
 },

696 { 
SNDRV_PCM_FORMAT_U32_LE
, 
SNDRV_PCM_FORMAT_U32_BE
 } }

699 c⁄° 
	glöór24_f‹m©s
[3][2][2] = {

700 { { 
SNDRV_PCM_FORMAT_S24_3LE
, 
SNDRV_PCM_FORMAT_S24_3BE
 },

701 { 
SNDRV_PCM_FORMAT_U24_3LE
, 
SNDRV_PCM_FORMAT_U24_3BE
 } },

702 { { 
SNDRV_PCM_FORMAT_S20_3LE
, 
SNDRV_PCM_FORMAT_S20_3BE
 },

703 { 
SNDRV_PCM_FORMAT_U20_3LE
, 
SNDRV_PCM_FORMAT_U20_3BE
 } },

704 { { 
SNDRV_PCM_FORMAT_S18_3LE
, 
SNDRV_PCM_FORMAT_S18_3BE
 },

705 { 
SNDRV_PCM_FORMAT_U18_3LE
, 
SNDRV_PCM_FORMAT_U18_3BE
 } },

716 
¢d_pcm_f‹m©_t
 
	$¢d_pcm_buûd_löór_f‹m©
(
width
, 
pwidth
, 
unsignd
, 
big_ídün
)

718 i‡(
pwidth
 == 24) {

719 
width
) {

721 
width
 = 0;

724 
width
 = 1;

727 
width
 = 2;

730  
SND_PCM_FORMAT_UNKNOWN
;

732  
löór24_f‹m©s
[
width
][!!
unsignd
][!!
big_ídün
];

734 
width
) {

736 
width
 = 0;

739 
width
 = 1;

742 
width
 = 2;

745 
width
 = 3;

748 
width
 = 4;

751  
SND_PCM_FORMAT_UNKNOWN
;

753  
löór_f‹m©s
[
width
][!!
unsignd
][!!
big_ídün
];

755 
	}
}

773 
	$¢d_pcm_∑r£_c⁄åﬁ_id
(
¢d_c⁄fig_t
 *
c⁄f
, 
¢d_˘l_ñem_id_t
 *
˘l_id
, *
ˇrdp
,

774 *
cch™√l•
, *
hw˘Õ
)

776 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

777 
iÁ˚
 = 
SND_CTL_ELEM_IFACE_MIXER
;

778 c⁄° *
«me
 = 
NULL
;

779 
ödex
 = 0;

780 
devi˚
 = -1;

781 
subdevi˚
 = -1;

782 
îr
;

784 
	`as£π
(
˘l_id
 && 
ˇrdp
);

786 *
ˇrdp
 = -1;

787 i‡(
cch™√l•
)

788 *
cch™√l•
 = 2;

789 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

790 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

791 c⁄° *
id
;

792 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

794 i‡(
	`°rcmp
(
id
, "comment") == 0)

796 i‡(
	`°rcmp
(
id
, "card") == 0) {

797 
îr
 = 
	`¢d_c⁄fig_gë_ˇrd
(
n
);

798 i‡(
îr
 < 0)

799 
_îr
;

800 *
ˇrdp
 = 
îr
;

803 i‡(
	`°rcmp
(
id
, "iface") == 0 || strcmp(id, "interface") == 0) {

804 c⁄° *
±r
;

805 i‡((
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
±r
)) < 0) {

806 
	`SNDERR
("fõld %†i†nŸá såög", 
id
);

807 
_îr
;

809 i‡((
îr
 = 
	`¢d_c⁄fig_gë_˘l_iÁ˚_ascii
(
±r
)) < 0) {

810 
	`SNDERR
("InvÆid vÆuêf‹ '%s'", 
id
);

811 
_îr
;

813 
iÁ˚
 = 
îr
;

816 i‡(
	`°rcmp
(
id
, "name") == 0) {

817 i‡((
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
«me
)) < 0) {

818 
	`SNDERR
("fõld %†i†nŸá såög", 
id
);

819 
_îr
;

823 i‡(
	`°rcmp
(
id
, "index") == 0) {

824 i‡((
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
ödex
)) < 0) {

825 
	`SNDERR
("fõld %†i†nŸá¿öãgî", 
id
);

826 
_îr
;

830 i‡(
	`°rcmp
(
id
, "device") == 0) {

831 i‡((
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
devi˚
)) < 0) {

832 
	`SNDERR
("fõld %†i†nŸá¿öãgî", 
id
);

833 
_îr
;

837 i‡(
	`°rcmp
(
id
, "subdevice") == 0) {

838 i‡((
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
subdevi˚
)) < 0) {

839 
	`SNDERR
("fõld %†i†nŸá¿öãgî", 
id
);

840 
_îr
;

844 i‡(
cch™√l•
 && 
	`°rcmp
(
id
, "count") == 0) {

845 
v
;

846 i‡((
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
v
)) < 0) {

847 
	`SNDERR
("fõld %†i†nŸá¿öãgî", 
id
);

848 
_îr
;

850 i‡(
v
 < 1 || v > 2) {

851 
	`SNDERR
("InvÆid cou¡ %ld", 
v
);

852 
_îr
;

854 *
cch™√l•
 = 
v
;

857 i‡(
hw˘Õ
 && 
	`°rcmp
(
id
, "hwctl") == 0) {

858 i‡((
îr
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
)) < 0) {

859 
	`SNDERR
("Thêfõld %†mu° bê®boﬁó¿ty≥", 
id
);

860  
îr
;

862 *
hw˘Õ
 = 
îr
;

865 
	`SNDERR
("Unknow¿fõld %s", 
id
);

866  -
EINVAL
;

868 i‡(
«me
 =
NULL
) {

869 
	`SNDERR
("Missing controlÇame");

870 
îr
 = -
EINVAL
;

871 
_îr
;

873 i‡(
devi˚
 < 0)

874 
devi˚
 = 0;

875 i‡(
subdevi˚
 < 0)

876 
subdevi˚
 = 0;

878 
	`¢d_˘l_ñem_id_£t_öãrÁ˚
(
˘l_id
, 
iÁ˚
);

879 
	`¢d_˘l_ñem_id_£t_«me
(
˘l_id
, 
«me
);

880 
	`¢d_˘l_ñem_id_£t_ödex
(
˘l_id
, 
ödex
);

881 
	`¢d_˘l_ñem_id_£t_devi˚
(
˘l_id
, 
devi˚
);

882 
	`¢d_˘l_ñem_id_£t_subdevi˚
(
˘l_id
, 
subdevi˚
);

886 
_îr
:

887  
îr
;

888 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_mmap.c

21 
	~"pcm_loˇl.h
"

22 
	~<°dio.h
>

23 #i‡
HAVE_MALLOC_H


24 
	~<mÆloc.h
>

26 
	~<°rög.h
>

27 
	~<pﬁl.h
>

28 
	~<sys/mm™.h
>

29 #ifde‡
HAVE_SYS_SHM_H


30 
	~<sys/shm.h
>

33 
	$¢d_pcm_mm≠_≠∂_backw¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

35 
¢d_pcm_s‰ames_t
 
≠∂_±r
 = *
pcm
->
≠∂
.
±r
;

36 
≠∂_±r
 -
‰ames
;

37 i‡(
≠∂_±r
 < 0)

38 
≠∂_±r
 +
pcm
->
bound¨y
;

39 *
pcm
->
≠∂
.
±r
 = 
≠∂_±r
;

40 
	}
}

42 
	$¢d_pcm_mm≠_≠∂_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

44 
¢d_pcm_u‰ames_t
 
≠∂_±r
 = *
pcm
->
≠∂
.
±r
;

45 
≠∂_±r
 +
‰ames
;

46 i‡(
≠∂_±r
 >
pcm
->
bound¨y
)

47 
≠∂_±r
 -
pcm
->
bound¨y
;

48 *
pcm
->
≠∂
.
±r
 = 
≠∂_±r
;

49 
	}
}

51 
	$¢d_pcm_mm≠_hw_backw¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

53 
¢d_pcm_s‰ames_t
 
hw_±r
 = *
pcm
->
hw
.
±r
;

54 
hw_±r
 -
‰ames
;

55 i‡(
hw_±r
 < 0)

56 
hw_±r
 +
pcm
->
bound¨y
;

57 *
pcm
->
hw
.
±r
 = 
hw_±r
;

58 
	}
}

60 
	$¢d_pcm_mm≠_hw_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

62 
¢d_pcm_u‰ames_t
 
hw_±r
 = *
pcm
->
hw
.
±r
;

63 
hw_±r
 +
‰ames
;

64 i‡(
hw_±r
 >
pcm
->
bound¨y
)

65 
hw_±r
 -
pcm
->
bound¨y
;

66 *
pcm
->
hw
.
±r
 = 
hw_±r
;

67 
	}
}

69 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mm≠_wrôe_¨ós
(
¢d_pcm_t
 *
pcm
,

70 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

71 
¢d_pcm_u‰ames_t
 
off£t
,

72 
¢d_pcm_u‰ames_t
 
size
)

74 
¢d_pcm_u‰ames_t
 
x„r
 = 0;

76 i‡(
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
Ë< 
size
) {

77 
	`SNDMSG
("toÿsh‹àavaû %ldÅÿsizê%ld", 
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
), 
size
);

78  -
EPIPE
;

80 
size
 > 0) {

81 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
pcm_¨ós
;

82 
¢d_pcm_u‰ames_t
 
pcm_off£t
;

83 
¢d_pcm_u‰ames_t
 
‰ames
 = 
size
;

84 
¢d_pcm_s‰ames_t
 
ªsu…
;

86 
	`__¢d_pcm_mm≠_begö
(
pcm
, &
pcm_¨ós
, &
pcm_off£t
, &
‰ames
);

87 
	`¢d_pcm_¨ós_c›y
(
pcm_¨ós
, 
pcm_off£t
,

88 
¨ós
, 
off£t
,

89 
pcm
->
ch™√ls
,

90 
‰ames
, 
pcm
->
f‹m©
);

91 
ªsu…
 = 
	`__¢d_pcm_mm≠_commô
(
pcm
, 
pcm_off£t
, 
‰ames
);

92 i‡(
ªsu…
 < 0)

93  
x„r
 > 0 ? (
¢d_pcm_s‰ames_t
)x„∏: 
ªsu…
;

94 
off£t
 +
ªsu…
;

95 
x„r
 +
ªsu…
;

96 
size
 -
ªsu…
;

98  (
¢d_pcm_s‰ames_t
)
x„r
;

99 
	}
}

101 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mm≠_ªad_¨ós
(
¢d_pcm_t
 *
pcm
,

102 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

103 
¢d_pcm_u‰ames_t
 
off£t
,

104 
¢d_pcm_u‰ames_t
 
size
)

106 
¢d_pcm_u‰ames_t
 
x„r
 = 0;

108 i‡(
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
pcm
Ë< 
size
) {

109 
	`SNDMSG
("toÿsh‹àavaû %ldÅÿsizê%ld", 
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
pcm
), 
size
);

110  -
EPIPE
;

112 
size
 > 0) {

113 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
pcm_¨ós
;

114 
¢d_pcm_u‰ames_t
 
pcm_off£t
;

115 
¢d_pcm_u‰ames_t
 
‰ames
 = 
size
;

116 
¢d_pcm_s‰ames_t
 
ªsu…
;

118 
	`__¢d_pcm_mm≠_begö
(
pcm
, &
pcm_¨ós
, &
pcm_off£t
, &
‰ames
);

119 
	`¢d_pcm_¨ós_c›y
(
¨ós
, 
off£t
,

120 
pcm_¨ós
, 
pcm_off£t
,

121 
pcm
->
ch™√ls
,

122 
‰ames
, 
pcm
->
f‹m©
);

123 
ªsu…
 = 
	`__¢d_pcm_mm≠_commô
(
pcm
, 
pcm_off£t
, 
‰ames
);

124 i‡(
ªsu…
 < 0)

125  
x„r
 > 0 ? (
¢d_pcm_s‰ames_t
)x„∏: 
ªsu…
;

126 
off£t
 +
ªsu…
;

127 
x„r
 +
ªsu…
;

128 
size
 -
ªsu…
;

130  (
¢d_pcm_s‰ames_t
)
x„r
;

131 
	}
}

150 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mm≠_wrôei
(
¢d_pcm_t
 *
pcm
, c⁄° *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

152 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

153 
	`¢d_pcm_¨ós_‰om_buf
(
pcm
, 
¨ós
, (*)
buf„r
);

154  
	`¢d_pcm_wrôe_¨ós
(
pcm
, 
¨ós
, 0, 
size
,

155 
¢d_pcm_mm≠_wrôe_¨ós
);

156 
	}
}

175 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mm≠_wrôí
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

177 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

178 
	`¢d_pcm_¨ós_‰om_bufs
(
pcm
, 
¨ós
, 
bufs
);

179  
	`¢d_pcm_wrôe_¨ós
(
pcm
, 
¨ós
, 0, 
size
,

180 
¢d_pcm_mm≠_wrôe_¨ós
);

181 
	}
}

200 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mm≠_ªadi
(
¢d_pcm_t
 *
pcm
, *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

202 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

203 
	`¢d_pcm_¨ós_‰om_buf
(
pcm
, 
¨ós
, 
buf„r
);

204  
	`¢d_pcm_ªad_¨ós
(
pcm
, 
¨ós
, 0, 
size
,

205 
¢d_pcm_mm≠_ªad_¨ós
);

206 
	}
}

225 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mm≠_ªadn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

227 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

228 
	`¢d_pcm_¨ós_‰om_bufs
(
pcm
, 
¨ós
, 
bufs
);

229  
	`¢d_pcm_ªad_¨ós
(
pcm
, 
¨ós
, 0, 
size
,

230 
¢d_pcm_mm≠_ªad_¨ós
);

231 
	}
}

233 
	$¢d_pcm_ch™√l_öfo_shm
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_öfo_t
 *
öfo
, 
shmid
)

235 
pcm
->
ac˚ss
) {

236 
SND_PCM_ACCESS_MMAP_INTERLEAVED
:

237 
SND_PCM_ACCESS_RW_INTERLEAVED
:

238 
öfo
->
fú°
 = info->
ch™√l
 * 
pcm
->
ßm∂e_bôs
;

239 
öfo
->
°ï
 = 
pcm
->
‰ame_bôs
;

241 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
:

242 
SND_PCM_ACCESS_RW_NONINTERLEAVED
:

243 
öfo
->
fú°
 = 0;

244 
öfo
->
°ï
 = 
pcm
->
ßm∂e_bôs
;

247 
	`SNDMSG
("övÆidác˚s†ty≥ %d", 
pcm
->
ac˚ss
);

248  -
EINVAL
;

250 
öfo
->
addr
 = 0;

251 i‡(
pcm
->
hw_Êags
 & 
SND_PCM_HW_PARAMS_EXPORT_BUFFER
) {

252 
öfo
->
ty≥
 = 
SND_PCM_AREA_SHM
;

253 
öfo
->
u
.
shm
.
shmid
 = shmid;

254 
öfo
->
u
.
shm
.
¨ó
 = 
NULL
;

256 
öfo
->
ty≥
 = 
SND_PCM_AREA_LOCAL
;

258 
	}
}

260 
	$¢d_pcm_mm≠
(
¢d_pcm_t
 *
pcm
)

262 
îr
;

263 
c
;

264 
	`as£π
(
pcm
);

265 i‡(
	`CHECK_SANITY
(! 
pcm
->
£tup
)) {

266 
	`SNDMSG
("PCMÇot set up");

267  -
EIO
;

269 i‡(
	`CHECK_SANITY
(
pcm
->
mm≠_ch™√ls
 ||Öcm->
ru¬ög_¨ós
)) {

270 
	`SNDMSG
("Already mmapped");

271  -
EBUSY
;

273 i‡(
pcm
->
›s
->
mm≠
)

274 
îr
 = 
pcm
->
›s
->
	`mm≠
(pcm);

276 
îr
 = -
ENOSYS
;

277 i‡(
îr
 < 0)

278  
îr
;

279 i‡(
pcm
->
mm≠_shadow
)

281 
pcm
->
mm≠_ch™√ls
 = 
	`ˇŒoc
’cm->
ch™√ls
, (pcm->mmap_channels[0]));

282 i‡(!
pcm
->
mm≠_ch™√ls
)

283  -
ENOMEM
;

284 
pcm
->
ru¬ög_¨ós
 = 
	`ˇŒoc
’cm->
ch™√ls
, (pcm->running_areas[0]));

285 i‡(!
pcm
->
ru¬ög_¨ós
) {

286 
	`‰ì
(
pcm
->
mm≠_ch™√ls
);

287 
pcm
->
mm≠_ch™√ls
 = 
NULL
;

288  -
ENOMEM
;

290 
c
 = 0; c < 
pcm
->
ch™√ls
; ++c) {

291 
¢d_pcm_ch™√l_öfo_t
 *
i
 = &
pcm
->
mm≠_ch™√ls
[
c
];

292 
i
->
ch™√l
 = 
c
;

293 
îr
 = 
	`¢d_pcm_ch™√l_öfo
(
pcm
, 
i
);

294 i‡(
îr
 < 0) {

295 
	`‰ì
(
pcm
->
mm≠_ch™√ls
);

296 
	`‰ì
(
pcm
->
ru¬ög_¨ós
);

297 
pcm
->
mm≠_ch™√ls
 = 
NULL
;

298 
pcm
->
ru¬ög_¨ós
 = 
NULL
;

299  
îr
;

302 
c
 = 0; c < 
pcm
->
ch™√ls
; ++c) {

303 
¢d_pcm_ch™√l_öfo_t
 *
i
 = &
pcm
->
mm≠_ch™√ls
[
c
];

304 
¢d_pcm_ch™√l_¨ó_t
 *
a
 = &
pcm
->
ru¬ög_¨ós
[
c
];

305 *
±r
;

306 
size_t
 
size
;

307 
c1
;

308 i‡(
i
->
addr
) {

309 
a
->
addr
 = 
i
->addr;

310 
a
->
fú°
 = 
i
->first;

311 
a
->
°ï
 = 
i
->step;

314 
size
 = 
i
->
fú°
 + i->
°ï
 * (
pcm
->
buf„r_size
 - 1Ë+Öcm->
ßm∂e_bôs
;

315 
c1
 = 
c
 + 1; c1 < 
pcm
->
ch™√ls
; ++c1) {

316 
¢d_pcm_ch™√l_öfo_t
 *
i1
 = &
pcm
->
mm≠_ch™√ls
[
c1
];

317 
size_t
 
s
;

318 i‡(
i1
->
ty≥
 !
i
->type)

320 
i1
->
ty≥
) {

321 
SND_PCM_AREA_MMAP
:

322 i‡(
i1
->
u
.
mm≠
.
fd
 !
i
->u.mmap.fd ||

323 
i1
->
u
.
mm≠
.
off£t
 !
i
->u.mmap.offset)

326 
SND_PCM_AREA_SHM
:

327 i‡(
i1
->
u
.
shm
.
shmid
 !
i
->u.shm.shmid)

330 
SND_PCM_AREA_LOCAL
:

333 
	`as£π
(0);

335 
s
 = 
i1
->
fú°
 + i1->
°ï
 * (
pcm
->
buf„r_size
 - 1Ë+Öcm->
ßm∂e_bôs
;

336 i‡(
s
 > 
size
)

337 
size
 = 
s
;

339 
size
 = (size + 7) / 8;

340 
size
 = 
	`∑ge_Æign
(size);

341 
i
->
ty≥
) {

342 
SND_PCM_AREA_MMAP
:

343 
±r
 = 
	`mm≠
(
NULL
, 
size
, 
PROT_READ
|
PROT_WRITE
, 
MAP_FILE
|
MAP_SHARED
, 
i
->
u
.
mm≠
.
fd
, i->u.mm≠.
off£t
);

344 i‡(
±r
 =
MAP_FAILED
) {

345 
	`SYSERR
("mmap failed");

346  -
î∫o
;

348 
i
->
addr
 = 
±r
;

350 
SND_PCM_AREA_SHM
:

351 #ifde‡
HAVE_SYS_SHM_H


352 i‡(
i
->
u
.
shm
.
shmid
 < 0) {

353 
id
;

355 
id
 = 
	`shmgë
(
IPC_PRIVATE
, 
size
, 0666);

356 i‡(
id
 < 0) {

357 
	`SYSERR
("shmget failed");

358  -
î∫o
;

360 
i
->
u
.
shm
.
shmid
 = 
id
;

361 
±r
 = 
	`shm©
(
i
->
u
.
shm
.
shmid
, 0, 0);

362 i‡(
±r
 == (*) -1) {

363 
	`SYSERR
("shmat failed");

364  -
î∫o
;

367 i‡(
	`shm˘l
(
id
, 
IPC_RMID
, 
NULL
) < 0){

368 
	`SYSERR
("shmctl markÑemove failed");

369  -
î∫o
;

371 
i
->
u
.
shm
.
¨ó
 = 
	`¢d_shm_¨ó_¸óã
(
id
, 
±r
);

372 i‡(
i
->
u
.
shm
.
¨ó
 =
NULL
) {

373 
	`SYSERR
("snd_shm_area_create failed");

374  -
ENOMEM
;

376 i‡(
pcm
->
ac˚ss
 =
SND_PCM_ACCESS_MMAP_INTERLEAVED
 ||

377 
pcm
->
ac˚ss
 =
SND_PCM_ACCESS_RW_INTERLEAVED
) {

378 
c1
;

379 
c1
 = 
c
 + 1; c1 < 
pcm
->
ch™√ls
; c1++) {

380 
¢d_pcm_ch™√l_öfo_t
 *
i1
 = &
pcm
->
mm≠_ch™√ls
[
c1
];

381 i‡(
i1
->
u
.
shm
.
shmid
 < 0) {

382 
i1
->
u
.
shm
.
shmid
 = 
id
;

383 
i1
->
u
.
shm
.
¨ó
 = 
	`¢d_shm_¨ó_sh¨e
(
i
->u.shm.area);

388 
±r
 = 
	`shm©
(
i
->
u
.
shm
.
shmid
, 0, 0);

389 i‡(
±r
 == (*) -1) {

390 
	`SYSERR
("shmat failed");

391  -
î∫o
;

394 
i
->
addr
 = 
±r
;

397 
	`SYSERR
("shm supportÇotávailable");

398  -
ENOSYS
;

400 
SND_PCM_AREA_LOCAL
:

401 
±r
 = 
	`mÆloc
(
size
);

402 i‡(
±r
 =
NULL
) {

403 
	`SYSERR
("malloc failed");

404  -
î∫o
;

406 
i
->
addr
 = 
±r
;

409 
	`as£π
(0);

411 
c1
 = 
c
 + 1; c1 < 
pcm
->
ch™√ls
; ++c1) {

412 
¢d_pcm_ch™√l_öfo_t
 *
i1
 = &
pcm
->
mm≠_ch™√ls
[
c1
];

413 i‡(
i1
->
ty≥
 !
i
->type)

415 
i1
->
ty≥
) {

416 
SND_PCM_AREA_MMAP
:

417 i‡(
i1
->
u
.
mm≠
.
fd
 !
i
->u.mmap.fd ||

418 
i1
->
u
.
mm≠
.
off£t
 !
i
->u.mmap.offset)

421 
SND_PCM_AREA_SHM
:

422 i‡(
i1
->
u
.
shm
.
shmid
 !
i
->u.shm.shmid)

425 
SND_PCM_AREA_LOCAL
:

426 i‡(
pcm
->
ac˚ss
 !
SND_PCM_ACCESS_MMAP_INTERLEAVED
 &&

427 
pcm
->
ac˚ss
 !
SND_PCM_ACCESS_RW_INTERLEAVED
)

431 
	`as£π
(0);

433 
i1
->
addr
 = 
i
->addr;

435 
a
->
addr
 = 
i
->addr;

436 
a
->
fú°
 = 
i
->first;

437 
a
->
°ï
 = 
i
->step;

440 
	}
}

442 
	$¢d_pcm_munm≠
(
¢d_pcm_t
 *
pcm
)

444 
îr
;

445 
c
;

446 
	`as£π
(
pcm
);

447 i‡(
	`CHECK_SANITY
(! 
pcm
->
mm≠_ch™√ls
)) {

448 
	`SNDMSG
("Not mmapped");

449  -
ENXIO
;

451 i‡(
pcm
->
mm≠_shadow
) {

452 i‡(
pcm
->
›s
->
munm≠
)

453  
pcm
->
›s
->
	`munm≠
(pcm);

455  -
ENOSYS
;

457 
c
 = 0; c < 
pcm
->
ch™√ls
; ++c) {

458 
¢d_pcm_ch™√l_öfo_t
 *
i
 = &
pcm
->
mm≠_ch™√ls
[
c
];

459 
c1
;

460 
size_t
 
size
 = 
i
->
fú°
 + i->
°ï
 * (
pcm
->
buf„r_size
 - 1Ë+Öcm->
ßm∂e_bôs
;

461 i‡(!
i
->
addr
)

463 
c1
 = 
c
 + 1; c1 < 
pcm
->
ch™√ls
; ++c1) {

464 
¢d_pcm_ch™√l_öfo_t
 *
i1
 = &
pcm
->
mm≠_ch™√ls
[
c1
];

465 
size_t
 
s
;

466 i‡(
i1
->
addr
 !
i
->addr)

468 
i1
->
addr
 = 
NULL
;

469 
s
 = 
i1
->
fú°
 + i1->
°ï
 * (
pcm
->
buf„r_size
 - 1Ë+Öcm->
ßm∂e_bôs
;

470 i‡(
s
 > 
size
)

471 
size
 = 
s
;

473 
size
 = (size + 7) / 8;

474 
size
 = 
	`∑ge_Æign
(size);

475 
i
->
ty≥
) {

476 
SND_PCM_AREA_MMAP
:

477 
îr
 = 
	`munm≠
(
i
->
addr
, 
size
);

478 i‡(
îr
 < 0) {

479 
	`SYSERR
("mmap failed");

480  -
î∫o
;

482 
î∫o
 = 0;

484 
SND_PCM_AREA_SHM
:

485 #ifde‡
HAVE_SYS_SHM_H


486 i‡(
i
->
u
.
shm
.
¨ó
) {

487 
	`¢d_shm_¨ó_de°roy
(
i
->
u
.
shm
.
¨ó
);

488 
i
->
u
.
shm
.
¨ó
 = 
NULL
;

489 i‡(
pcm
->
ac˚ss
 =
SND_PCM_ACCESS_MMAP_INTERLEAVED
 ||

490 
pcm
->
ac˚ss
 =
SND_PCM_ACCESS_RW_INTERLEAVED
) {

491 
c1
;

492 
c1
 = 
c
 + 1; c1 < 
pcm
->
ch™√ls
; c1++) {

493 
¢d_pcm_ch™√l_öfo_t
 *
i1
 = &
pcm
->
mm≠_ch™√ls
[
c1
];

494 i‡(
i1
->
u
.
shm
.
¨ó
) {

495 
	`¢d_shm_¨ó_de°roy
(
i1
->
u
.
shm
.
¨ó
);

496 
i1
->
u
.
shm
.
¨ó
 = 
NULL
;

503 
	`SYSERR
("shm supportÇotávailable");

504  -
ENOSYS
;

506 
SND_PCM_AREA_LOCAL
:

507 
	`‰ì
(
i
->
addr
);

510 
	`as£π
(0);

512 
i
->
addr
 = 
NULL
;

514 i‡(
pcm
->
›s
->
munm≠
)

515 
îr
 = 
pcm
->
›s
->
	`munm≠
(pcm);

517 
îr
 = -
ENOSYS
;

518 i‡(
îr
 < 0)

519  
îr
;

520 
	`‰ì
(
pcm
->
mm≠_ch™√ls
);

521 
	`‰ì
(
pcm
->
ru¬ög_¨ós
);

522 
pcm
->
mm≠_ch™√ls
 = 
NULL
;

523 
pcm
->
ru¬ög_¨ós
 = 
NULL
;

525 
	}
}

528 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_wrôe_mm≠
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
off£t
,

529 
¢d_pcm_u‰ames_t
 
size
)

531 
¢d_pcm_u‰ames_t
 
x„r
 = 0;

532 
¢d_pcm_s‰ames_t
 
îr
 = 0;

533 i‡(! 
size
)

535 
x„r
 < 
size
) {

536 
¢d_pcm_u‰ames_t
 
‰ames
 = 
size
 - 
x„r
;

537 
¢d_pcm_u‰ames_t
 
c⁄t
 = 
pcm
->
buf„r_size
 - 
off£t
;

538 i‡(
c⁄t
 < 
‰ames
)

539 
‰ames
 = 
c⁄t
;

540 
pcm
->
ac˚ss
) {

541 
SND_PCM_ACCESS_MMAP_INTERLEAVED
:

543 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
a
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

544 c⁄° *
buf
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
a
, 
off£t
);

545 
	`¢d_pcm_u∆ock
(
pcm
);

546 
îr
 = 
	`_¢d_pcm_wrôei
(
pcm
, 
buf
, 
‰ames
);

547 
	`¢d_pcm_lock
(
pcm
);

548 i‡(
îr
 >= 0)

549 
‰ames
 = 
îr
;

552 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
:

554 
ch™√ls
 = 
pcm
->channels;

555 
c
;

556 *
bufs
[
ch™√ls
];

557 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

558 
c
 = 0; c < 
ch™√ls
; ++c) {

559 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
a
 = &
¨ós
[
c
];

560 
bufs
[
c
] = 
	`¢d_pcm_ch™√l_¨ó_addr
(
a
, 
off£t
);

562 
	`¢d_pcm_u∆ock
(
pcm
);

563 
îr
 = 
	`_¢d_pcm_wrôí
(
pcm
, 
bufs
, 
‰ames
);

564 
	`¢d_pcm_lock
(
pcm
);

565 i‡(
îr
 >= 0)

566 
‰ames
 = 
îr
;

570 
	`SNDMSG
("övÆidác˚s†ty≥ %d", 
pcm
->
ac˚ss
);

571  -
EINVAL
;

573 i‡(
îr
 < 0)

575 
x„r
 +
‰ames
;

576 
off£t
 = (off£à+ 
‰ames
Ë% 
pcm
->
buf„r_size
;

578 i‡(
x„r
 > 0)

579  
x„r
;

580  
îr
;

581 
	}
}

584 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_ªad_mm≠
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
off£t
,

585 
¢d_pcm_u‰ames_t
 
size
)

587 
¢d_pcm_u‰ames_t
 
x„r
 = 0;

588 
¢d_pcm_s‰ames_t
 
îr
 = 0;

589 i‡(! 
size
)

591 
x„r
 < 
size
) {

592 
¢d_pcm_u‰ames_t
 
‰ames
 = 
size
 - 
x„r
;

593 
¢d_pcm_u‰ames_t
 
c⁄t
 = 
pcm
->
buf„r_size
 - 
off£t
;

594 i‡(
c⁄t
 < 
‰ames
)

595 
‰ames
 = 
c⁄t
;

596 
pcm
->
ac˚ss
) {

597 
SND_PCM_ACCESS_MMAP_INTERLEAVED
:

599 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
a
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

600 *
buf
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
a
, 
off£t
);

601 
	`¢d_pcm_u∆ock
(
pcm
);

602 
îr
 = 
	`_¢d_pcm_ªadi
(
pcm
, 
buf
, 
‰ames
);

603 
	`¢d_pcm_lock
(
pcm
);

604 i‡(
îr
 >= 0)

605 
‰ames
 = 
îr
;

608 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
:

610 
¢d_pcm_u‰ames_t
 
ch™√ls
 = 
pcm
->channels;

611 
c
;

612 *
bufs
[
ch™√ls
];

613 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

614 
c
 = 0; c < 
ch™√ls
; ++c) {

615 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
a
 = &
¨ós
[
c
];

616 
bufs
[
c
] = 
	`¢d_pcm_ch™√l_¨ó_addr
(
a
, 
off£t
);

618 
	`¢d_pcm_u∆ock
(
pcm
);

619 
îr
 = 
	`_¢d_pcm_ªadn
(
pcm
->
Á°_›_¨g
, 
bufs
, 
‰ames
);

620 
	`¢d_pcm_lock
(
pcm
);

621 i‡(
îr
 >= 0)

622 
‰ames
 = 
îr
;

626 
	`SNDMSG
("övÆidác˚s†ty≥ %d", 
pcm
->
ac˚ss
);

627  -
EINVAL
;

629 i‡(
îr
 < 0)

631 
x„r
 +
‰ames
;

632 
off£t
 = (off£à+ 
‰ames
Ë% 
pcm
->
buf„r_size
;

634 i‡(
x„r
 > 0)

635  
x„r
;

636  
îr
;

637 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_mmap_emul.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_gíîic.h
"

32 #i‚de‡
PIC


34 c⁄° *
	g_¢d_moduÀ_pcm_mm≠_emul
 = "";

37 #i‚de‡
DOC_HIDDEN


43 
¢d_pcm_gíîic_t
 
	mgí
;

44 
	mmm≠_emul
 :1;

45 
¢d_pcm_u‰ames_t
 
	mhw_±r
;

46 
¢d_pcm_u‰ames_t
 
	m≠∂_±r
;

47 
¢d_pcm_u‰ames_t
 
	m°¨t_thªshﬁd
;

48 } 
	tmm≠_emul_t
;

55 
	$¢d_pcm_mm≠_emul_hw_ªföe
(
¢d_pcm_t
 *
pcm
,

56 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

58 
mm≠_emul_t
 *
m≠
 = 
pcm
->
¥iv©e_d©a
;

59 
îr
 = 0;

60 
¢d_pcm_ac˚ss_mask_t
 
ﬁdmask
 =

61 *
	`¢d_pcm_hw_∑øm_gë_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
);

62 
¢d_pcm_ac˚ss_mask_t
 
mask
;

63 c⁄° 
¢d_mask_t
 *
pmask
;

65 
	`¢d_mask_n⁄e
(&
mask
);

66 
îr
 = 
	`¢d_pcm_hw_ªföe
(
m≠
->
gí
.
¶ave
, 
∑øms
);

67 i‡(
îr
 < 0) {

68 
¢d_pcm_hw_∑øms_t
 
√w
 = *
∑øms
;

71 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(&
ﬁdmask
,

72 
SND_PCM_ACCESS_MMAP_INTERLEAVED
) &&

73 !
	`¢d_pcm_ac˚ss_mask_ã°
(&
ﬁdmask
,

74 
SND_PCM_ACCESS_RW_INTERLEAVED
))

75 
	`¢d_pcm_ac˚ss_mask_£t
(&
mask
,

76 
SND_PCM_ACCESS_RW_INTERLEAVED
);

77 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(&
ﬁdmask
,

78 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
) &&

79 !
	`¢d_pcm_ac˚ss_mask_ã°
(&
ﬁdmask
,

80 
SND_PCM_ACCESS_RW_NONINTERLEAVED
))

81 
	`¢d_pcm_ac˚ss_mask_£t
(&
mask
,

82 
SND_PCM_ACCESS_RW_NONINTERLEAVED
);

83 i‡(
	`¢d_pcm_ac˚ss_mask_em±y
(&
mask
))

84  
îr
;

85 
pmask
 = 
	`¢d_pcm_hw_∑øm_gë_mask
(&
√w
,

86 
SND_PCM_HW_PARAM_ACCESS
);

87 *(
¢d_mask_t
 *)
pmask
 = 
mask
;

88 
îr
 = 
	`¢d_pcm_hw_ªföe
(
m≠
->
gí
.
¶ave
, &
√w
);

89 i‡(
îr
 < 0)

90  
îr
;

91 *
∑øms
 = 
√w
;

94 
pmask
 = 
	`¢d_pcm_hw_∑øm_gë_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
);

95 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(
pmask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
) ||

96 
	`¢d_pcm_ac˚ss_mask_ã°
(
pmask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
) ||

97 
	`¢d_pcm_ac˚ss_mask_ã°
(
pmask
, 
SND_PCM_ACCESS_MMAP_COMPLEX
))

99 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(&
mask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
)) {

100 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(
pmask
,

101 
SND_PCM_ACCESS_RW_INTERLEAVED
))

102 
	`¢d_pcm_ac˚ss_mask_£t
((
¢d_pcm_ac˚ss_mask_t
 *)
pmask
,

103 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

104 
	`¢d_pcm_ac˚ss_mask_ª£t
((
¢d_pcm_ac˚ss_mask_t
 *)
pmask
,

105 
SND_PCM_ACCESS_RW_INTERLEAVED
);

106 
∑øms
->
cmask
 |1<<
SND_PCM_HW_PARAM_ACCESS
;

108 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(&
mask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
)) {

109 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(
pmask
,

110 
SND_PCM_ACCESS_RW_NONINTERLEAVED
))

111 
	`¢d_pcm_ac˚ss_mask_£t
((
¢d_pcm_ac˚ss_mask_t
 *)
pmask
,

112 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

113 
	`¢d_pcm_ac˚ss_mask_ª£t
((
¢d_pcm_ac˚ss_mask_t
 *)
pmask
,

114 
SND_PCM_ACCESS_RW_NONINTERLEAVED
);

115 
∑øms
->
cmask
 |1<<
SND_PCM_HW_PARAM_ACCESS
;

117 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(&
ﬁdmask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
)) {

118 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(&
ﬁdmask
,

119 
SND_PCM_ACCESS_RW_INTERLEAVED
)) {

120 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(
pmask
,

121 
SND_PCM_ACCESS_RW_INTERLEAVED
)) {

122 
	`¢d_pcm_ac˚ss_mask_£t
((
¢d_pcm_ac˚ss_mask_t
 *)
pmask
,

123 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

124 
∑øms
->
cmask
 |1<<
SND_PCM_HW_PARAM_ACCESS
;

128 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(&
ﬁdmask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
)) {

129 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(&
ﬁdmask
,

130 
SND_PCM_ACCESS_RW_NONINTERLEAVED
)) {

131 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(
pmask
,

132 
SND_PCM_ACCESS_RW_NONINTERLEAVED
)) {

133 
	`¢d_pcm_ac˚ss_mask_£t
((
¢d_pcm_ac˚ss_mask_t
 *)
pmask
,

134 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

135 
∑øms
->
cmask
 |1<<
SND_PCM_HW_PARAM_ACCESS
;

140 
	}
}

153 
	$¢d_pcm_mm≠_emul_hw_∑øms
(
¢d_pcm_t
 *
pcm
,

154 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

156 
mm≠_emul_t
 *
m≠
 = 
pcm
->
¥iv©e_d©a
;

157 
¢d_pcm_hw_∑øms_t
 
ﬁd
 = *
∑øms
;

158 
¢d_pcm_ac˚ss_t
 
ac˚ss
;

159 
¢d_pcm_ac˚ss_mask_t
 
ﬁdmask
;

160 
¢d_pcm_ac˚ss_mask_t
 *
pmask
;

161 
îr
;

163 
îr
 = 
	`_¢d_pcm_hw_∑øms_öã∫Æ
(
m≠
->
gí
.
¶ave
, 
∑øms
);

164 i‡(
îr
 >= 0) {

165 
m≠
->
mm≠_emul
 = 0;

166  
îr
;

169 *
∑øms
 = 
ﬁd
;

170 
pmask
 = (
¢d_pcm_ac˚ss_mask_t
 *)
	`¢d_pcm_hw_∑øm_gë_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
);

171 
ﬁdmask
 = *
pmask
;

172 i‡(
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_ac˚ss
)(
∑øms
, &
ac˚ss
) < 0)

173 
_îr
;

174 
ac˚ss
) {

175 
SND_PCM_ACCESS_MMAP_INTERLEAVED
:

176 
	`¢d_pcm_ac˚ss_mask_ª£t
(
pmask
,

177 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

178 
	`¢d_pcm_ac˚ss_mask_£t
(
pmask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
);

180 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
:

181 
	`¢d_pcm_ac˚ss_mask_ª£t
(
pmask
,

182 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

183 
	`¢d_pcm_ac˚ss_mask_£t
(
pmask
,

184 
SND_PCM_ACCESS_RW_NONINTERLEAVED
);

187 
_îr
;

189 
îr
 = 
	`_¢d_pcm_hw_∑øms_öã∫Æ
(
m≠
->
gí
.
¶ave
, 
∑øms
);

190 i‡(
îr
 < 0)

191 
_îr
;

194 *
pmask
 = 
ﬁdmask
;

197 
m≠
->
mm≠_emul
 = 1;

198 
m≠
->
≠∂_±r
 = 0;

199 
m≠
->
hw_±r
 = 0;

200 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
m≠
->
hw_±r
, -1, 0);

201 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
m≠
->
≠∂_±r
, -1, 0);

204 
_îr
:

205 
îr
 = -
î∫o
;

206  
îr
;

207 
	}
}

209 
	$¢d_pcm_mm≠_emul_sw_∑øms
(
¢d_pcm_t
 *
pcm
,

210 
¢d_pcm_sw_∑øms_t
 *
∑øms
)

212 
mm≠_emul_t
 *
m≠
 = 
pcm
->
¥iv©e_d©a
;

213 
îr
;

215 i‡(!
m≠
->
mm≠_emul
)

216  
	`¢d_pcm_gíîic_sw_∑øms
(
pcm
, 
∑øms
);

218 
m≠
->
°¨t_thªshﬁd
 = 
∑øms
->start_threshold;

221 
∑øms
->
°¨t_thªshﬁd
 = 
pcm
->
bound¨y
;

222 
îr
 = 
	`¢d_pcm_gíîic_sw_∑øms
(
pcm
, 
∑øms
);

223 i‡(
îr
 < 0)

224  
îr
;

226 
∑øms
->
°¨t_thªshﬁd
 = 
m≠
->start_threshold;

227  
îr
;

228 
	}
}

230 
	$¢d_pcm_mm≠_emul_¥ï¨e
(
¢d_pcm_t
 *
pcm
)

232 
mm≠_emul_t
 *
m≠
 = 
pcm
->
¥iv©e_d©a
;

233 
îr
;

235 
îr
 = 
	`¢d_pcm_gíîic_¥ï¨e
(
pcm
);

236 i‡(
îr
 < 0)

237  
îr
;

238 
m≠
->
hw_±r
 = m≠->
≠∂_±r
 = 0;

239  
îr
;

240 
	}
}

242 
	$¢d_pcm_mm≠_emul_ª£t
(
¢d_pcm_t
 *
pcm
)

244 
mm≠_emul_t
 *
m≠
 = 
pcm
->
¥iv©e_d©a
;

245 
îr
;

247 
îr
 = 
	`¢d_pcm_gíîic_ª£t
(
pcm
);

248 i‡(
îr
 < 0)

249  
îr
;

250 
m≠
->
hw_±r
 = m≠->
≠∂_±r
 = 0;

251  
îr
;

252 
	}
}

254 
¢d_pcm_s‰ames_t


255 
	$¢d_pcm_mm≠_emul_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

257 
‰ames
 = 
	`¢d_pcm_gíîic_ªwöd
(
pcm
, frames);

258 i‡(
‰ames
 > 0)

259 
	`¢d_pcm_mm≠_≠∂_backw¨d
(
pcm
, 
‰ames
);

260  
‰ames
;

261 
	}
}

263 
¢d_pcm_s‰ames_t


264 
	$¢d_pcm_mm≠_emul_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

266 
‰ames
 = 
	`¢d_pcm_gíîic_f‹w¨d
(
pcm
, frames);

267 i‡(
‰ames
 > 0)

268 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
‰ames
);

269  
‰ames
;

270 
	}
}

273 
¢d_pcm_s‰ames_t


274 
	$sync_¶ave_wrôe
(
¢d_pcm_t
 *
pcm
)

276 
mm≠_emul_t
 *
m≠
 = 
pcm
->
¥iv©e_d©a
;

277 
¢d_pcm_t
 *
¶ave
 = 
m≠
->
gí
.slave;

278 
¢d_pcm_u‰ames_t
 
off£t
;

279 
¢d_pcm_s‰ames_t
 
size
;

282 
pcm
->
°¨t_thªshﬁd
 =Öcm->
bound¨y
;

284 
size
 = 
m≠
->
≠∂_±r
 - *
¶ave
->
≠∂
.
±r
;

285 i‡(
size
 < 0)

286 
size
 +
pcm
->
bound¨y
;

287 i‡(
size
) {

288 
off£t
 = *
¶ave
->
≠∂
.
±r
 % 
pcm
->
buf„r_size
;

289 
size
 = 
	`¢d_pcm_wrôe_mm≠
(
pcm
, 
off£t
, size);

291 
pcm
->
°¨t_thªshﬁd
 = 
m≠
->start_threshold;

292  
size
;

293 
	}
}

296 
¢d_pcm_s‰ames_t


297 
	$sync_¶ave_ªad
(
¢d_pcm_t
 *
pcm
)

299 
mm≠_emul_t
 *
m≠
 = 
pcm
->
¥iv©e_d©a
;

300 
¢d_pcm_t
 *
¶ave
 = 
m≠
->
gí
.slave;

301 
¢d_pcm_u‰ames_t
 
off£t
;

302 
¢d_pcm_s‰ames_t
 
size
;

304 
size
 = *
¶ave
->
hw
.
±r
 - 
m≠
->
hw_±r
;

305 i‡(
size
 < 0)

306 
size
 +
pcm
->
bound¨y
;

307 i‡(!
size
)

309 
off£t
 = 
m≠
->
hw_±r
 % 
pcm
->
buf„r_size
;

310 
size
 = 
	`¢d_pcm_ªad_mm≠
(
pcm
, 
off£t
, size);

311 i‡(
size
 > 0)

312 
	`¢d_pcm_mm≠_hw_f‹w¨d
(
pcm
, 
size
);

314 
	}
}

316 
¢d_pcm_s‰ames_t


317 
	$¢d_pcm_mm≠_emul_mm≠_commô
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
off£t
,

318 
¢d_pcm_u‰ames_t
 
size
)

320 
mm≠_emul_t
 *
m≠
 = 
pcm
->
¥iv©e_d©a
;

321 
¢d_pcm_t
 *
¶ave
 = 
m≠
->
gí
.slave;

323 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
size
);

324 i‡(!
m≠
->
mm≠_emul
)

325  
	`¢d_pcm_mm≠_commô
(
¶ave
, 
off£t
, 
size
);

326 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

327 
	`sync_¶ave_wrôe
(
pcm
);

328  
size
;

329 
	}
}

331 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mm≠_emul_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

333 
mm≠_emul_t
 *
m≠
 = 
pcm
->
¥iv©e_d©a
;

334 
¢d_pcm_t
 *
¶ave
 = 
m≠
->
gí
.slave;

336 i‡(!
m≠
->
mm≠_emul
 || 
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

337 
m≠
->
hw_±r
 = *
¶ave
->
hw
.
±r
;

339 
	`sync_¶ave_ªad
(
pcm
);

340  
	`¢d_pcm_mm≠_avaû
(
pcm
);

341 
	}
}

343 
	$¢d_pcm_mm≠_emul_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

345 
mm≠_emul_t
 *
m≠
 = 
pcm
->
¥iv©e_d©a
;

347 
	`¢d_ouçut_¥ötf
(
out
, "MmapÉmulation PCM\n");

348 i‡(
pcm
->
£tup
) {

349 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

350 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

352 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

353 
	`¢d_pcm_dump
(
m≠
->
gí
.
¶ave
, 
out
);

354 
	}
}

356 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_mm≠_emul_›s
 = {

357 .
˛o£
 = 
¢d_pcm_gíîic_˛o£
,

358 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

359 .
	ghw_ªföe
 = 
¢d_pcm_mm≠_emul_hw_ªföe
,

360 .
	ghw_∑øms
 = 
¢d_pcm_mm≠_emul_hw_∑øms
,

361 .
	ghw_‰ì
 = 
¢d_pcm_gíîic_hw_‰ì
,

362 .
	gsw_∑øms
 = 
¢d_pcm_mm≠_emul_sw_∑øms
,

363 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

364 .
	gdump
 = 
¢d_pcm_mm≠_emul_dump
,

365 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

366 .
	gasync
 = 
¢d_pcm_gíîic_async
,

367 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

368 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

369 .
	gquîy_chm≠s
 = 
¢d_pcm_gíîic_quîy_chm≠s
,

370 .
	ggë_chm≠
 = 
¢d_pcm_gíîic_gë_chm≠
,

371 .
	g£t_chm≠
 = 
¢d_pcm_gíîic_£t_chm≠
,

374 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_mm≠_emul_Á°_›s
 = {

375 .
°©us
 = 
¢d_pcm_gíîic_°©us
,

376 .
	g°©e
 = 
¢d_pcm_gíîic_°©e
,

377 .
	ghwsync
 = 
¢d_pcm_gíîic_hwsync
,

378 .
	gdñay
 = 
¢d_pcm_gíîic_dñay
,

379 .
	g¥ï¨e
 = 
¢d_pcm_mm≠_emul_¥ï¨e
,

380 .
	gª£t
 = 
¢d_pcm_mm≠_emul_ª£t
,

381 .
	g°¨t
 = 
¢d_pcm_gíîic_°¨t
,

382 .
	gdr›
 = 
¢d_pcm_gíîic_dr›
,

383 .
	gdøö
 = 
¢d_pcm_gíîic_døö
,

384 .
	g∑u£
 = 
¢d_pcm_gíîic_∑u£
,

385 .
	gªwödabÀ
 = 
¢d_pcm_gíîic_ªwödabÀ
,

386 .
	gªwöd
 = 
¢d_pcm_mm≠_emul_ªwöd
,

387 .
	gf‹w¨dabÀ
 = 
¢d_pcm_gíîic_f‹w¨dabÀ
,

388 .
	gf‹w¨d
 = 
¢d_pcm_mm≠_emul_f‹w¨d
,

389 .
	gªsume
 = 
¢d_pcm_gíîic_ªsume
,

390 .
	glök
 = 
¢d_pcm_gíîic_lök
,

391 .
	glök_¶aves
 = 
¢d_pcm_gíîic_lök_¶aves
,

392 .
	gu∆ök
 = 
¢d_pcm_gíîic_u∆ök
,

393 .
	gwrôei
 = 
¢d_pcm_gíîic_wrôei
,

394 .
	gwrôí
 = 
¢d_pcm_gíîic_wrôí
,

395 .
	gªadi
 = 
¢d_pcm_gíîic_ªadi
,

396 .
	gªadn
 = 
¢d_pcm_gíîic_ªadn
,

397 .
	gavaû_upd©e
 = 
¢d_pcm_mm≠_emul_avaû_upd©e
,

398 .
	gmm≠_commô
 = 
¢d_pcm_mm≠_emul_mm≠_commô
,

399 .
	ghtime°amp
 = 
¢d_pcm_gíîic_htime°amp
,

400 .
	gpﬁl_des¸ùt‹s
 = 
¢d_pcm_gíîic_pﬁl_des¸ùt‹s
,

401 .
	gpﬁl_des¸ùt‹s_cou¡
 = 
¢d_pcm_gíîic_pﬁl_des¸ùt‹s_cou¡
,

402 .
	gpﬁl_ªvíts
 = 
¢d_pcm_gíîic_pﬁl_ªvíts
,

403 .
	gmay_waô_f‹_avaû_mö
 = 
¢d_pcm_gíîic_may_waô_f‹_avaû_mö
,

406 #i‚de‡
DOC_HIDDEN


407 
	$__¢d_pcm_mm≠_emul_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

408 
¢d_pcm_t
 *
¶ave
, 
˛o£_¶ave
)

410 
¢d_pcm_t
 *
pcm
;

411 
mm≠_emul_t
 *
m≠
;

412 
îr
;

414 
m≠
 = 
	`ˇŒoc
(1, (*map));

415 i‡(!
m≠
)

416  -
ENOMEM
;

417 
m≠
->
gí
.
¶ave
 = slave;

418 
m≠
->
gí
.
˛o£_¶ave
 = close_slave;

420 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_MMAP_EMUL
, 
«me
,

421 
¶ave
->
°ªam
, sœve->
mode
);

422 i‡(
îr
 < 0) {

423 
	`‰ì
(
m≠
);

424  
îr
;

426 
pcm
->
›s
 = &
¢d_pcm_mm≠_emul_›s
;

427 
pcm
->
Á°_›s
 = &
¢d_pcm_mm≠_emul_Á°_›s
;

428 
pcm
->
¥iv©e_d©a
 = 
m≠
;

429 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

430 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

431 
pcm
->
t°amp_ty≥
 = 
¶ave
->tstamp_type;

432 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
m≠
->
hw_±r
, -1, 0);

433 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
m≠
->
≠∂_±r
, -1, 0);

434 *
pcmp
 = 
pcm
;

437 
	}
}

471 
	$_¢d_pcm_mm≠_emul_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

472 
¢d_c⁄fig_t
 *
roŸ
 
ATTRIBUTE_UNUSED
,

473 
¢d_c⁄fig_t
 *
c⁄f
,

474 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

476 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

477 
îr
;

478 
¢d_pcm_t
 *
•cm
;

479 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

481 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

482 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

483 c⁄° *
id
;

484 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

486 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

488 i‡(
	`°rcmp
(
id
, "slave") == 0) {

489 
¶ave
 = 
n
;

492 
	`SNDERR
("Unknow¿fõld %s", 
id
);

493  -
EINVAL
;

495 i‡(!
¶ave
) {

496 
	`SNDERR
("slave isÇot defined");

497  -
EINVAL
;

499 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 0);

500 i‡(
îr
 < 0)

501  
îr
;

502 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

503 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

504 i‡(
îr
 < 0)

505  
îr
;

506 
îr
 = 
	`__¢d_pcm_mm≠_emul_›í
(
pcmp
, 
«me
, 
•cm
, 1);

507 i‡(
îr
 < 0)

508 
	`¢d_pcm_˛o£
(
•cm
);

509  
îr
;

510 
	}
}

512 #i‚de‡
DOC_HIDDEN


513 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_mm≠_emul_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_mulaw.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_∂ugö.h
"

31 
	~"∂ugö_›s.h
"

32 
	~"bsw≠.h
"

34 #i‚de‡
PIC


36 c⁄° *
	g_¢d_moduÀ_pcm_muœw
 = "";

39 #i‚de‡
DOC_HIDDEN


41 (*
	tmuœw_f
)(c⁄° 
	t¢d_pcm_ch™√l_¨ó_t
 *
	t§c_¨ós
,

42 
	t¢d_pcm_u‰ames_t
 
	t§c_off£t
,

43 c⁄° 
	t¢d_pcm_ch™√l_¨ó_t
 *
	td°_¨ós
,

44 
	t¢d_pcm_u‰ames_t
 
	td°_off£t
,

45 
	tch™√ls
, 
	t¢d_pcm_u‰ames_t
 
	t‰ames
,

46 
	tgëputidx
);

50 
¢d_pcm_∂ugö_t
 
∂ug
;

51 
gëput_idx
;

52 
muœw_f
 
func
;

53 
¢d_pcm_f‹m©_t
 
sf‹m©
;

54 } 
	t¢d_pcm_muœw_t
;

58 
ölöe
 
	$vÆ_£g
(
vÆ
)

60 
r
 = 0;

61 
vÆ
 >>= 7;

62 i‡(
vÆ
 & 0xf0) {

63 
vÆ
 >>= 4;

64 
r
 += 4;

66 i‡(
vÆ
 & 0x0c) {

67 
vÆ
 >>= 2;

68 
r
 += 2;

70 i‡(
vÆ
 & 0x02)

71 
r
 += 1;

72  
r
;

73 
	}
}

105 
	$s16_to_uœw
(
pcm_vÆ
)

107 
mask
;

108 
£g
;

109 
uvÆ
;

111 i‡(
pcm_vÆ
 < 0) {

112 
pcm_vÆ
 = 0x84 -Öcm_val;

113 
mask
 = 0x7f;

115 
pcm_vÆ
 += 0x84;

116 
mask
 = 0xff;

118 i‡(
pcm_vÆ
 > 0x7fff)

119 
pcm_vÆ
 = 0x7fff;

122 
£g
 = 
	`vÆ_£g
(
pcm_vÆ
);

128 
uvÆ
 = (
£g
 << 4Ë| ((
pcm_vÆ
 >> (seg + 3)) & 0x0f);

129  
uvÆ
 ^ 
mask
;

130 
	}
}

141 
	$uœw_to_s16
(
u_vÆ
)

143 
t
;

146 
u_vÆ
 = ~u_val;

152 
t
 = ((
u_vÆ
 & 0x0f) << 3) + 0x84;

153 
t
 <<(
u_vÆ
 & 0x70) >> 4;

155  ((
u_vÆ
 & 0x80Ë? (0x84 - 
t
) : (t - 0x84));

156 
	}
}

158 #i‚de‡
DOC_HIDDEN


160 
	$¢d_pcm_muœw_decode
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

161 
¢d_pcm_u‰ames_t
 
d°_off£t
,

162 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

163 
¢d_pcm_u‰ames_t
 
§c_off£t
,

164 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

165 
putidx
)

167 
	#PUT16_LABELS


	)

168 
	~"∂ugö_›s.h
"

169 #unde‡
PUT16_LABELS


170 *
put
 = 
put16_œbñs
[
putidx
];

171 
ch™√l
;

172 
ch™√l
 = 0; ch™√»< 
ch™√ls
; ++channel) {

173 c⁄° *
§c
;

174 *
d°
;

175 
§c_°ï
, 
d°_°ï
;

176 
¢d_pcm_u‰ames_t
 
‰ames1
;

177 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

178 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

179 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

180 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

181 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
);

182 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
);

183 
‰ames1
 = 
‰ames
;

184 
‰ames1
-- > 0) {

185 
öt16_t
 
ßm∂e
 = 
	`uœw_to_s16
(*
§c
);

186 *
put
;

187 
	#PUT16_END
 
a·î


	)

188 
	~"∂ugö_›s.h
"

189 #unde‡
PUT16_END


190 
a·î
:

191 
§c
 +
§c_°ï
;

192 
d°
 +
d°_°ï
;

195 
	}
}

197 
	$¢d_pcm_muœw_ícode
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

198 
¢d_pcm_u‰ames_t
 
d°_off£t
,

199 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

200 
¢d_pcm_u‰ames_t
 
§c_off£t
,

201 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

202 
gëidx
)

204 
	#GET16_LABELS


	)

205 
	~"∂ugö_›s.h
"

206 #unde‡
GET16_LABELS


207 *
gë
 = 
gë16_œbñs
[
gëidx
];

208 
ch™√l
;

209 
öt16_t
 
ßm∂e
 = 0;

210 
ch™√l
 = 0; ch™√»< 
ch™√ls
; ++channel) {

211 c⁄° *
§c
;

212 *
d°
;

213 
§c_°ï
, 
d°_°ï
;

214 
¢d_pcm_u‰ames_t
 
‰ames1
;

215 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

216 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

217 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

218 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

219 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
);

220 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
);

221 
‰ames1
 = 
‰ames
;

222 
‰ames1
-- > 0) {

223 *
gë
;

224 
	#GET16_END
 
a·î


	)

225 
	~"∂ugö_›s.h
"

226 #unde‡
GET16_END


227 
a·î
:

228 *
d°
 = 
	`s16_to_uœw
(
ßm∂e
);

229 
§c
 +
§c_°ï
;

230 
d°
 +
d°_°ï
;

233 
	}
}

237 
	$¢d_pcm_muœw_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

239 
¢d_pcm_muœw_t
 *
muœw
 = 
pcm
->
¥iv©e_d©a
;

240 
îr
;

241 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

242 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

243 &
ac˚ss_mask
);

244 i‡(
îr
 < 0)

245  
îr
;

246 i‡(
muœw
->
sf‹m©
 =
SND_PCM_FORMAT_MU_LAW
) {

247 
¢d_pcm_f‹m©_mask_t
 
f‹m©_mask
{ 
SND_PCM_FMTBIT_LINEAR
 };

248 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
,

249 &
f‹m©_mask
);

251 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
∑øms
,

252 
SND_PCM_FORMAT_MU_LAW
);

254 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
∑øms
, 
SND_PCM_SUBFORMAT_STD
);

255 i‡(
îr
 < 0)

256  
îr
;

257 
∑øms
->
öfo
 &~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

259 
	}
}

261 
	$¢d_pcm_muœw_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

263 
¢d_pcm_muœw_t
 *
muœw
 = 
pcm
->
¥iv©e_d©a
;

264 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

265 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

266 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

267 &
ßc˚ss_mask
);

268 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
•¨ams
, 
muœw
->
sf‹m©
);

269 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
•¨ams
, 
SND_PCM_SUBFORMAT_STD
);

271 
	}
}

273 
	$¢d_pcm_muœw_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

274 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

276 
îr
;

277 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

278 
SND_PCM_HW_PARBIT_RATE
 |

279 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

280 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

281 
SND_PCM_HW_PARBIT_PERIODS
 |

282 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

283 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

284 
SND_PCM_HW_PARBIT_TICK_TIME
);

285 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

286 i‡(
îr
 < 0)

287  
îr
;

289 
	}
}

291 
	$¢d_pcm_muœw_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

292 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

294 
îr
;

295 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

296 
SND_PCM_HW_PARBIT_RATE
 |

297 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

298 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

299 
SND_PCM_HW_PARBIT_PERIODS
 |

300 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

301 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

302 
SND_PCM_HW_PARBIT_TICK_TIME
);

303 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

304 i‡(
îr
 < 0)

305  
îr
;

307 
	}
}

309 
	$¢d_pcm_muœw_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

311  
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

312 
¢d_pcm_muœw_hw_ªföe_˝ª∑ª
,

313 
¢d_pcm_muœw_hw_ªföe_cch™ge
,

314 
¢d_pcm_muœw_hw_ªföe_•ª∑ª
,

315 
¢d_pcm_muœw_hw_ªföe_sch™ge
,

316 
¢d_pcm_gíîic_hw_ªföe
);

317 
	}
}

319 
	$¢d_pcm_muœw_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 * 
∑øms
)

321 
¢d_pcm_muœw_t
 *
muœw
 = 
pcm
->
¥iv©e_d©a
;

322 
¢d_pcm_f‹m©_t
 
f‹m©
;

323 
îr
 = 
	`¢d_pcm_hw_∑øms_¶ave
(
pcm
, 
∑øms
,

324 
¢d_pcm_muœw_hw_ªföe_cch™ge
,

325 
¢d_pcm_muœw_hw_ªföe_•ª∑ª
,

326 
¢d_pcm_muœw_hw_ªföe_sch™ge
,

327 
¢d_pcm_gíîic_hw_∑øms
);

328 i‡(
îr
 < 0)

329  
îr
;

331 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(
∑øms
, &
f‹m©
);

332 i‡(
îr
 < 0)

333  
îr
;

335 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

336 i‡(
muœw
->
sf‹m©
 =
SND_PCM_FORMAT_MU_LAW
) {

337 
muœw
->
gëput_idx
 = 
	`¢d_pcm_löór_gë_ödex
(
f‹m©
, 
SND_PCM_FORMAT_S16
);

338 
muœw
->
func
 = 
¢d_pcm_muœw_ícode
;

340 
muœw
->
gëput_idx
 = 
	`¢d_pcm_löór_put_ödex
(
SND_PCM_FORMAT_S16
, muœw->
sf‹m©
);

341 
muœw
->
func
 = 
¢d_pcm_muœw_decode
;

344 i‡(
muœw
->
sf‹m©
 =
SND_PCM_FORMAT_MU_LAW
) {

345 
muœw
->
gëput_idx
 = 
	`¢d_pcm_löór_put_ödex
(
SND_PCM_FORMAT_S16
, 
f‹m©
);

346 
muœw
->
func
 = 
¢d_pcm_muœw_decode
;

348 
muœw
->
gëput_idx
 = 
	`¢d_pcm_löór_gë_ödex
(muœw->
sf‹m©
, 
SND_PCM_FORMAT_S16
);

349 
muœw
->
func
 = 
¢d_pcm_muœw_ícode
;

353 
	}
}

355 
¢d_pcm_u‰ames_t


356 
	$¢d_pcm_muœw_wrôe_¨ós
(
¢d_pcm_t
 *
pcm
,

357 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

358 
¢d_pcm_u‰ames_t
 
off£t
,

359 
¢d_pcm_u‰ames_t
 
size
,

360 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

361 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

362 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

364 
¢d_pcm_muœw_t
 *
muœw
 = 
pcm
->
¥iv©e_d©a
;

365 i‡(
size
 > *
¶ave_sizï
)

366 
size
 = *
¶ave_sizï
;

367 
muœw
->
	`func
(
¶ave_¨ós
, 
¶ave_off£t
,

368 
¨ós
, 
off£t
,

369 
pcm
->
ch™√ls
, 
size
,

370 
muœw
->
gëput_idx
);

371 *
¶ave_sizï
 = 
size
;

372  
size
;

373 
	}
}

375 
¢d_pcm_u‰ames_t


376 
	$¢d_pcm_muœw_ªad_¨ós
(
¢d_pcm_t
 *
pcm
,

377 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

378 
¢d_pcm_u‰ames_t
 
off£t
,

379 
¢d_pcm_u‰ames_t
 
size
,

380 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

381 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

382 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

384 
¢d_pcm_muœw_t
 *
muœw
 = 
pcm
->
¥iv©e_d©a
;

385 i‡(
size
 > *
¶ave_sizï
)

386 
size
 = *
¶ave_sizï
;

387 
muœw
->
	`func
(
¨ós
, 
off£t
,

388 
¶ave_¨ós
, 
¶ave_off£t
,

389 
pcm
->
ch™√ls
, 
size
,

390 
muœw
->
gëput_idx
);

391 *
¶ave_sizï
 = 
size
;

392  
size
;

393 
	}
}

395 
	$¢d_pcm_muœw_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

397 
¢d_pcm_muœw_t
 *
muœw
 = 
pcm
->
¥iv©e_d©a
;

398 
	`¢d_ouçut_¥ötf
(
out
, "Mu-Law conversion PCM (%s)\n",

399 
	`¢d_pcm_f‹m©_«me
(
muœw
->
sf‹m©
));

400 i‡(
pcm
->
£tup
) {

401 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

402 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

404 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

405 
	`¢d_pcm_dump
(
muœw
->
∂ug
.
gí
.
¶ave
, 
out
);

406 
	}
}

408 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_muœw_›s
 = {

409 .
˛o£
 = 
¢d_pcm_gíîic_˛o£
,

410 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

411 .
	ghw_ªföe
 = 
¢d_pcm_muœw_hw_ªföe
,

412 .
	ghw_∑øms
 = 
¢d_pcm_muœw_hw_∑øms
,

413 .
	ghw_‰ì
 = 
¢d_pcm_gíîic_hw_‰ì
,

414 .
	gsw_∑øms
 = 
¢d_pcm_gíîic_sw_∑øms
,

415 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

416 .
	gdump
 = 
¢d_pcm_muœw_dump
,

417 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

418 .
	gasync
 = 
¢d_pcm_gíîic_async
,

419 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

420 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

421 .
	ggë_chm≠
 = 
¢d_pcm_gíîic_gë_chm≠
,

422 .
	g£t_chm≠
 = 
¢d_pcm_gíîic_£t_chm≠
,

437 
	$¢d_pcm_muœw_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
, 
¢d_pcm_f‹m©_t
 
sf‹m©
, snd_pcm_à*
¶ave
, 
˛o£_¶ave
)

439 
¢d_pcm_t
 *
pcm
;

440 
¢d_pcm_muœw_t
 *
muœw
;

441 
îr
;

442 
	`as£π
(
pcmp
 && 
¶ave
);

443 i‡(
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1 &&

444 
sf‹m©
 !
SND_PCM_FORMAT_MU_LAW
)

445  -
EINVAL
;

446 
muœw
 = 
	`ˇŒoc
(1, (
¢d_pcm_muœw_t
));

447 i‡(!
muœw
) {

448  -
ENOMEM
;

450 
	`¢d_pcm_∂ugö_öô
(&
muœw
->
∂ug
);

451 
muœw
->
sf‹m©
 = sformat;

452 
muœw
->
∂ug
.
ªad
 = 
¢d_pcm_muœw_ªad_¨ós
;

453 
muœw
->
∂ug
.
wrôe
 = 
¢d_pcm_muœw_wrôe_¨ós
;

454 
muœw
->
∂ug
.
undo_ªad
 = 
¢d_pcm_∂ugö_undo_ªad_gíîic
;

455 
muœw
->
∂ug
.
undo_wrôe
 = 
¢d_pcm_∂ugö_undo_wrôe_gíîic
;

456 
muœw
->
∂ug
.
gí
.
¶ave
 = slave;

457 
muœw
->
∂ug
.
gí
.
˛o£_¶ave
 = close_slave;

459 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_MULAW
, 
«me
, 
¶ave
->
°ªam
, sœve->
mode
);

460 i‡(
îr
 < 0) {

461 
	`‰ì
(
muœw
);

462  
îr
;

464 
pcm
->
›s
 = &
¢d_pcm_muœw_›s
;

465 
pcm
->
Á°_›s
 = &
¢d_pcm_∂ugö_Á°_›s
;

466 
pcm
->
¥iv©e_d©a
 = 
muœw
;

467 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

468 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

469 
pcm
->
t°amp_ty≥
 = 
¶ave
->tstamp_type;

470 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
muœw
->
∂ug
.
hw_±r
, -1, 0);

471 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
muœw
->
∂ug
.
≠∂_±r
, -1, 0);

472 *
pcmp
 = 
pcm
;

475 
	}
}

521 
	$_¢d_pcm_muœw_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

522 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

523 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

525 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

526 
îr
;

527 
¢d_pcm_t
 *
•cm
;

528 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

529 
¢d_pcm_f‹m©_t
 
sf‹m©
;

530 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

531 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

532 c⁄° *
id
;

533 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

535 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

537 i‡(
	`°rcmp
(
id
, "slave") == 0) {

538 
¶ave
 = 
n
;

541 
	`SNDERR
("Unknow¿fõld %s", 
id
);

542  -
EINVAL
;

544 i‡(!
¶ave
) {

545 
	`SNDERR
("slave isÇot defined");

546  -
EINVAL
;

548 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 1,

549 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_MANDATORY
, &
sf‹m©
);

550 i‡(
îr
 < 0)

551  
îr
;

552 i‡(
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1 &&

553 
sf‹m©
 !
SND_PCM_FORMAT_MU_LAW
) {

554 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

555 
	`SNDERR
("invalid slave format");

556  -
EINVAL
;

558 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

559 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

560 i‡(
îr
 < 0)

561  
îr
;

562 
îr
 = 
	`¢d_pcm_muœw_›í
(
pcmp
, 
«me
, 
sf‹m©
, 
•cm
, 1);

563 i‡(
îr
 < 0)

564 
	`¢d_pcm_˛o£
(
•cm
);

565  
îr
;

566 
	}
}

567 #i‚de‡
DOC_HIDDEN


568 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_muœw_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_multi.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_gíîic.h
"

31 
	~<°dio.h
>

32 
	~<°dlib.h
>

33 
	~<uni°d.h
>

34 
	~<°rög.h
>

35 
	~<m©h.h
>

37 #i‚de‡
PIC


39 c⁄° *
	g_¢d_moduÀ_pcm_mu…i
 = "";

42 #i‚de‡
DOC_HIDDEN


45 
¢d_pcm_t
 *
	mpcm
;

46 
	mch™√ls_cou¡
;

47 
	m˛o£_¶ave
;

48 
¢d_pcm_t
 *
	mlöked
;

49 } 
	t¢d_pcm_mu…i_¶ave_t
;

52 
	m¶ave_idx
;

53 
	m¶ave_ch™√l
;

54 } 
	t¢d_pcm_mu…i_ch™√l_t
;

57 
¢d_pcm_u‰ames_t
 
	m≠∂_±r
, 
	mhw_±r
;

58 
	m¶aves_cou¡
;

59 
	mma°î_¶ave
;

60 
¢d_pcm_mu…i_¶ave_t
 *
	m¶aves
;

61 
	mch™√ls_cou¡
;

62 
¢d_pcm_mu…i_ch™√l_t
 *
	mch™√ls
;

63 } 
	t¢d_pcm_mu…i_t
;

67 
	$¢d_pcm_mu…i_˛o£
(
¢d_pcm_t
 *
pcm
)

69 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

70 
i
;

71 
ªt
 = 0;

72 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

73 
¢d_pcm_mu…i_¶ave_t
 *
¶ave
 = &
mu…i
->
¶aves
[
i
];

74 i‡(
¶ave
->
˛o£_¶ave
) {

75 
îr
 = 
	`¢d_pcm_˛o£
(
¶ave
->
pcm
);

76 i‡(
îr
 < 0)

77 
ªt
 = 
îr
;

80 
	`‰ì
(
mu…i
->
¶aves
);

81 
	`‰ì
(
mu…i
->
ch™√ls
);

82 
	`‰ì
(
mu…i
);

83  
ªt
;

84 
	}
}

86 
	$¢d_pcm_mu…i_n⁄block
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
n⁄block
 ATTRIBUTE_UNUSED)

89 
	}
}

91 
	$¢d_pcm_mu…i_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
)

93 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

94 
¢d_pcm_t
 *
¶ave_0
 = 
mu…i
->
¶aves
[mu…i->
ma°î_¶ave
].
pcm
;

95  
	`¢d_pcm_async
(
¶ave_0
, 
sig
, 
pid
);

96 
	}
}

98 
	$¢d_pcm_mu…i_pﬁl_des¸ùt‹s_cou¡
(
¢d_pcm_t
 *
pcm
)

100 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

101 
¢d_pcm_t
 *
¶ave_0
 = 
mu…i
->
¶aves
[mu…i->
ma°î_¶ave
].
pcm
;

102  
	`¢d_pcm_pﬁl_des¸ùt‹s_cou¡
(
¶ave_0
);

103 
	}
}

105 
	$¢d_pcm_mu…i_pﬁl_des¸ùt‹s
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
•a˚
)

107 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

108 
¢d_pcm_t
 *
¶ave
;

109 
¢d_pcm_t
 *
¶ave_0
 = 
mu…i
->
¶aves
[mu…i->
ma°î_¶ave
].
pcm
;

110 
îr
;

111 
i
;

113 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

114 
¶ave
 = 
mu…i
->
¶aves
[
i
].
pcm
;

115 i‡(
¶ave
 =
¶ave_0
)

117 
îr
 = 
	`¢d_pcm_pﬁl_des¸ùt‹s
(
¶ave
, 
pfds
, 
•a˚
);

118 i‡(
îr
 < 0)

119  
îr
;

122  
	`¢d_pcm_pﬁl_des¸ùt‹s
(
¶ave_0
, 
pfds
, 
•a˚
);

123 
	}
}

125 
	$¢d_pcm_mu…i_pﬁl_ªvíts
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

127 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

128 
¢d_pcm_t
 *
¶ave_0
 = 
mu…i
->
¶aves
[mu…i->
ma°î_¶ave
].
pcm
;

129  
	`¢d_pcm_pﬁl_des¸ùt‹s_ªvíts
(
¶ave_0
, 
pfds
, 
nfds
, 
ªvíts
);

130 
	}
}

132 
	$¢d_pcm_mu…i_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_öfo_t
 *
öfo
)

134 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

135 
îr
, 
n
;

136 
	`as£π
(
öfo
->
subdevi˚
 < 
mu…i
->
¶aves_cou¡
);

137 
n
 = 
öfo
->
subdevi˚
;

138 
öfo
->
subdevi˚
 = 0;

139 
îr
 = 
	`¢d_pcm_öfo
(
mu…i
->
¶aves
[
n
].
pcm
, 
öfo
);

140 i‡(
îr
 < 0)

141  
îr
;

142 
öfo
->
subdevi˚s_cou¡
 = 
mu…i
->
¶aves_cou¡
;

144 
	}
}

146 
	$¢d_pcm_mu…i_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

148 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

149 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
;

150 
îr
;

151 
	`¢d_pcm_ac˚ss_mask_™y
(&
ac˚ss_mask
);

152 
	`¢d_pcm_ac˚ss_mask_ª£t
(&
ac˚ss_mask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

153 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

154 &
ac˚ss_mask
);

155 i‡(
îr
 < 0)

156  
îr
;

157 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t
(
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
,

158 
mu…i
->
ch™√ls_cou¡
, 0);

159 i‡(
îr
 < 0)

160  
îr
;

161 
∑øms
->
öfo
 = ~0U;

163 
	}
}

165 
	$¢d_pcm_mu…i_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¶ave_idx
,

166 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

168 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

169 
¢d_pcm_mu…i_¶ave_t
 *
¶ave
 = &
mu…i
->
¶aves
[
¶ave_idx
];

170 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

171 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

172 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

173 &
ßc˚ss_mask
);

174 
	`_¢d_pcm_hw_∑øm_£t
(
•¨ams
, 
SND_PCM_HW_PARAM_CHANNELS
,

175 
¶ave
->
ch™√ls_cou¡
, 0);

177 
	}
}

179 
	$¢d_pcm_mu…i_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

180 
¶ave_idx
 
ATTRIBUTE_UNUSED
,

181 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

182 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

184 
îr
;

185 
löks
 = (
SND_PCM_HW_PARBIT_FORMAT
 |

186 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

187 
SND_PCM_HW_PARBIT_RATE
 |

188 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

189 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

190 
SND_PCM_HW_PARBIT_PERIODS
 |

191 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

192 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

193 
SND_PCM_HW_PARBIT_TICK_TIME
);

194 c⁄° 
¢d_pcm_ac˚ss_mask_t
 *
ac˚ss_mask
 = 
	`¢d_pcm_hw_∑øm_gë_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
);

195 i‡(!
	`¢d_pcm_ac˚ss_mask_ã°
(
ac˚ss_mask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
) &&

196 !
	`¢d_pcm_ac˚ss_mask_ã°
(
ac˚ss_mask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
) &&

197 !
	`¢d_pcm_ac˚ss_mask_ã°
(
ac˚ss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
)) {

198 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
;

199 
	`¢d_pcm_ac˚ss_mask_™y
(&
ßc˚ss_mask
);

200 
	`¢d_pcm_ac˚ss_mask_ª£t
(&
ßc˚ss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

201 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

202 &
ßc˚ss_mask
);

203 i‡(
îr
 < 0)

204  
îr
;

206 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

207 i‡(
îr
 < 0)

208  
îr
;

210 
	}
}

212 
	$¢d_pcm_mu…i_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

213 
¶ave_idx
 
ATTRIBUTE_UNUSED
,

214 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

215 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

217 
îr
;

218 
löks
 = (
SND_PCM_HW_PARBIT_FORMAT
 |

219 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

220 
SND_PCM_HW_PARBIT_RATE
 |

221 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

222 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

223 
SND_PCM_HW_PARBIT_PERIODS
 |

224 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

225 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

226 
SND_PCM_HW_PARBIT_TICK_TIME
);

227 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
;

228 c⁄° 
¢d_pcm_ac˚ss_mask_t
 *
ßc˚ss_mask
 = 
	`¢d_pcm_hw_∑øm_gë_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
);

229 
	`¢d_pcm_ac˚ss_mask_™y
(&
ac˚ss_mask
);

230 
	`¢d_pcm_ac˚ss_mask_ª£t
(&
ac˚ss_mask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

231 i‡(!
	`¢d_pcm_ac˚ss_mask_ã°
(
ßc˚ss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
))

232 
	`¢d_pcm_ac˚ss_mask_ª£t
(&
ac˚ss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

233 i‡(!
	`¢d_pcm_ac˚ss_mask_ã°
(
ßc˚ss_mask
, 
SND_PCM_ACCESS_MMAP_COMPLEX
) &&

234 !
	`¢d_pcm_ac˚ss_mask_ã°
(
ßc˚ss_mask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
))

235 
	`¢d_pcm_ac˚ss_mask_ª£t
(&
ac˚ss_mask
, 
SND_PCM_ACCESS_MMAP_COMPLEX
);

236 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

237 &
ac˚ss_mask
);

238 i‡(
îr
 < 0)

239  
îr
;

240 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

241 i‡(
îr
 < 0)

242  
îr
;

243 
∑øms
->
öfo
 &
•¨ams
->info;

245 
	}
}

247 
	$¢d_pcm_mu…i_hw_ªföe_¶ave
(
¢d_pcm_t
 *
pcm
,

248 
¶ave_idx
,

249 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

251 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

252 
¢d_pcm_t
 *
¶ave
 = 
mu…i
->
¶aves
[
¶ave_idx
].
pcm
;

253  
	`¢d_pcm_hw_ªföe
(
¶ave
, 
•¨ams
);

254 
	}
}

256 
	$¢d_pcm_mu…i_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

258 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

259 
k
;

260 
¢d_pcm_hw_∑øms_t
 
•¨ams
[
mu…i
->
¶aves_cou¡
];

261 
îr
;

262 
cmask
, 
ch™ged
;

263 
îr
 = 
	`¢d_pcm_mu…i_hw_ªföe_˝ª∑ª
(
pcm
, 
∑øms
);

264 i‡(
îr
 < 0)

265  
îr
;

266 
k
 = 0; k < 
mu…i
->
¶aves_cou¡
; ++k) {

267 
îr
 = 
	`¢d_pcm_mu…i_hw_ªföe_•ª∑ª
(
pcm
, 
k
, &
•¨ams
[k]);

268 i‡(
îr
 < 0) {

269 
	`SNDERR
("SœvêPCM #%dÇŸ ußbÀ", 
k
);

270  
îr
;

274 
cmask
 = 
∑øms
->cmask;

275 
∑øms
->
cmask
 = 0;

276 
k
 = 0; k < 
mu…i
->
¶aves_cou¡
; ++k) {

277 
îr
 = 
	`¢d_pcm_mu…i_hw_ªföe_sch™ge
(
pcm
, 
k
, 
∑øms
, &
•¨ams
[k]);

278 i‡(
îr
 >= 0)

279 
îr
 = 
	`¢d_pcm_mu…i_hw_ªföe_¶ave
(
pcm
, 
k
, &
•¨ams
[k]);

280 i‡(
îr
 < 0) {

281 
	`¢d_pcm_mu…i_hw_ªföe_cch™ge
(
pcm
, 
k
, 
∑øms
, &
•¨ams
[k]);

282  
îr
;

284 
îr
 = 
	`¢d_pcm_mu…i_hw_ªföe_cch™ge
(
pcm
, 
k
, 
∑øms
, &
•¨ams
[k]);

285 i‡(
îr
 < 0)

286  
îr
;

288 
îr
 = 
	`¢d_pcm_hw_ªföe_so·
(
pcm
, 
∑øms
);

289 
ch™ged
 = 
∑øms
->
cmask
;

290 
∑øms
->
cmask
 |= cmask;

291 i‡(
îr
 < 0)

292  
îr
;

293 } 
ch™ged
);

295 
	}
}

297 
	$¢d_pcm_mu…i_hw_∑øms_¶ave
(
¢d_pcm_t
 *
pcm
,

298 
¶ave_idx
,

299 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

301 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

302 
¢d_pcm_t
 *
¶ave
 = 
mu…i
->
¶aves
[
¶ave_idx
].
pcm
;

303 
îr
 = 
	`¢d_pcm_hw_∑øms
(
¶ave
, 
•¨ams
);

304 i‡(
îr
 < 0)

305  
îr
;

306 
îr
 = 
	`¢d_pcm_¨ós_sûí˚
(
¶ave
->
ru¬ög_¨ós
, 0, sœve->
ch™√ls
, sœve->
buf„r_size
, sœve->
f‹m©
);

307 i‡(
îr
 < 0)

308  
îr
;

309 i‡(
¶ave
->
°›≥d_¨ós
) {

310 
îr
 = 
	`¢d_pcm_¨ós_sûí˚
(
¶ave
->
°›≥d_¨ós
, 0, sœve->
ch™√ls
, sœve->
buf„r_size
, sœve->
f‹m©
);

311 i‡(
îr
 < 0)

312  
îr
;

315 
	}
}

321 
	$ª£t_löks
(
¢d_pcm_mu…i_t
 *
mu…i
)

323 
i
;

325 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

326 i‡(
mu…i
->
¶aves
[
i
].
löked
)

327 
	`¢d_pcm_u∆ök
(
mu…i
->
¶aves
[
i
].
löked
);

328 
mu…i
->
¶aves
[0].
löked
 = 
NULL
;

329 i‡(! 
i
)

331 i‡(
	`¢d_pcm_lök
(
mu…i
->
¶aves
[0].
pcm
, mu…i->¶aves[
i
].pcm) >= 0)

332 
mu…i
->
¶aves
[
i
].
löked
 = mu…i->¶aves[0].
pcm
;

334 
	}
}

336 
	$¢d_pcm_mu…i_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

338 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

339 
i
;

340 
¢d_pcm_hw_∑øms_t
 
•¨ams
[
mu…i
->
¶aves_cou¡
];

341 
îr
;

342 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

343 
îr
 = 
	`¢d_pcm_mu…i_hw_ªföe_•ª∑ª
(
pcm
, 
i
, &
•¨ams
[i]);

344 
	`as£π
(
îr
 >= 0);

345 
îr
 = 
	`¢d_pcm_mu…i_hw_ªföe_sch™ge
(
pcm
, 
i
, 
∑øms
, &
•¨ams
[i]);

346 
	`as£π
(
îr
 >= 0);

347 
îr
 = 
	`¢d_pcm_mu…i_hw_∑øms_¶ave
(
pcm
, 
i
, &
•¨ams
[i]);

348 i‡(
îr
 < 0) {

349 
	`¢d_pcm_mu…i_hw_ªföe_cch™ge
(
pcm
, 
i
, 
∑øms
, &
•¨ams
[i]);

350  
îr
;

353 
	`ª£t_löks
(
mu…i
);

355 
	}
}

357 
	$¢d_pcm_mu…i_hw_‰ì
(
¢d_pcm_t
 *
pcm
)

359 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

360 
i
;

361 
îr
 = 0;

362 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

363 
¢d_pcm_t
 *
¶ave
 = 
mu…i
->
¶aves
[
i
].
pcm
;

364 
e
 = 
	`¢d_pcm_hw_‰ì
(
¶ave
);

365 i‡(
e
 < 0)

366 
îr
 = 
e
;

367 i‡(!
mu…i
->
¶aves
[
i
].
löked
)

369 
e
 = 
	`¢d_pcm_u∆ök
(
¶ave
);

370 i‡(
e
 < 0)

371 
îr
 = 
e
;

372 
mu…i
->
¶aves
[
i
].
löked
 = 
NULL
;

374  
îr
;

375 
	}
}

377 
	$¢d_pcm_mu…i_sw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
)

379 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

380 
i
;

381 
îr
;

382 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

383 
¢d_pcm_t
 *
¶ave
 = 
mu…i
->
¶aves
[
i
].
pcm
;

384 
îr
 = 
	`¢d_pcm_sw_∑øms
(
¶ave
, 
∑øms
);

385 i‡(
îr
 < 0)

386  
îr
;

389 
	}
}

391 
¢d_pcm_s‰ames_t
 
¢d_pcm_mu…i_avaû_upd©e
(
¢d_pcm_t
 *
pcm
);

392 
	$¢d_pcm_mu…i_°©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©us_t
 *
°©us
)

394 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

395 
¢d_pcm_t
 *
¶ave
 = 
mu…i
->
¶aves
[mu…i->
ma°î_¶ave
].
pcm
;

397 
îr
 = 
	`¢d_pcm_°©us
(
¶ave
, 
°©us
);

398 i‡(
îr
 < 0)

399  
îr
;

400 
¢d_pcm_s‰ames_t
 
avaû
 = 
	`¢d_pcm_mu…i_avaû_upd©e
(
pcm
);

401 i‡(
avaû
 < 0)

402  
avaû
;

403 
°©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

404 
°©us
->
avaû
 =ávail;

406 
	}
}

408 
¢d_pcm_°©e_t
 
	$¢d_pcm_mu…i_°©e
(
¢d_pcm_t
 *
pcm
)

410 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

411 
¢d_pcm_t
 *
¶ave
 = 
mu…i
->
¶aves
[mu…i->
ma°î_¶ave
].
pcm
;

412  
	`¢d_pcm_°©e
(
¶ave
);

413 
	}
}

415 
	$¢d_pcm_mu…i_hw±r_upd©e
(
¢d_pcm_t
 *
pcm
)

417 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

418 
¢d_pcm_u‰ames_t
 
hw_±r
 = 0, 
¶ave_hw_±r
, 
avaû
, 
œ°_avaû
;

419 
i
;

421 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

422 
œ°_avaû
 = 0;

423 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

424 
¶ave_hw_±r
 = *
mu…i
->
¶aves
[
i
].
pcm
->
hw
.
±r
;

425 
avaû
 = 
	`__¢d_pcm_∂ayback_avaû
(
pcm
, 
mu…i
->
hw_±r
, 
¶ave_hw_±r
);

426 i‡(
avaû
 > 
œ°_avaû
) {

427 
hw_±r
 = 
¶ave_hw_±r
;

428 
œ°_avaû
 = 
avaû
;

432 
œ°_avaû
 = 
LONG_MAX
;

433 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

434 
¶ave_hw_±r
 = *
mu…i
->
¶aves
[
i
].
pcm
->
hw
.
±r
;

435 
avaû
 = 
	`__¢d_pcm_ˇ±uª_avaû
(
pcm
, 
mu…i
->
hw_±r
, 
¶ave_hw_±r
);

436 i‡(
avaû
 < 
œ°_avaû
) {

437 
hw_±r
 = 
¶ave_hw_±r
;

438 
œ°_avaû
 = 
avaû
;

442 
mu…i
->
hw_±r
 = hw_ptr;

443 
	}
}

445 
	$¢d_pcm_mu…i_hwsync
(
¢d_pcm_t
 *
pcm
)

447 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

448 
i
;

449 
îr
;

450 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

451 
îr
 = 
	`¢d_pcm_hwsync
(
mu…i
->
¶aves
[
i
].
pcm
);

452 i‡(
îr
 < 0)

453  
îr
;

455 
	`¢d_pcm_mu…i_hw±r_upd©e
(
pcm
);

457 
	}
}

459 
	$¢d_pcm_mu…i_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
)

461 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

462 
¢d_pcm_s‰ames_t
 
d
, 
dr
 = 0;

463 
i
;

464 
îr
;

465 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

466 
îr
 = 
	`¢d_pcm_dñay
(
mu…i
->
¶aves
[
i
].
pcm
, &
d
);

467 i‡(
îr
 < 0)

468  
îr
;

469 i‡(
dr
 < 
d
)

470 
dr
 = 
d
;

472 *
dñayp
 = 
dr
;

474 
	}
}

476 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mu…i_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

478 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

479 
¢d_pcm_s‰ames_t
 
ªt
 = 
LONG_MAX
;

480 
i
;

481 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

482 
¢d_pcm_s‰ames_t
 
avaû
;

483 
avaû
 = 
	`¢d_pcm_avaû_upd©e
(
mu…i
->
¶aves
[
i
].
pcm
);

484 i‡(
avaû
 < 0)

485  
avaû
;

486 i‡(
ªt
 > 
avaû
)

487 
ªt
 = 
avaû
;

489 
	`¢d_pcm_mu…i_hw±r_upd©e
(
pcm
);

490  
ªt
;

491 
	}
}

493 
	$¢d_pcm_mu…i_htime°amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 *
avaû
,

494 
¢d_htime°amp_t
 *
t°amp
)

496 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

497 
¢d_pcm_t
 *
¶ave
 = 
mu…i
->
¶aves
[mu…i->
ma°î_¶ave
].
pcm
;

498  
	`¢d_pcm_htime°amp
(
¶ave
, 
avaû
, 
t°amp
);

499 
	}
}

501 
	$¢d_pcm_mu…i_¥ï¨e
(
¢d_pcm_t
 *
pcm
)

503 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

504 
ªsu…
 = 0, 
îr
;

505 
i
;

506 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

510 
îr
 = 
	`¢d_pcm_¥ï¨e
(
mu…i
->
¶aves
[
i
].
pcm
);

511 i‡(
îr
 < 0)

512 
ªsu…
 = 
îr
;

514 
mu…i
->
hw_±r
 = mu…i->
≠∂_±r
 = 0;

515  
ªsu…
;

516 
	}
}

518 
	$¢d_pcm_mu…i_ª£t
(
¢d_pcm_t
 *
pcm
)

520 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

521 
ªsu…
 = 0, 
îr
;

522 
i
;

523 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

525 
îr
 = 
	`¢d_pcm_ª£t
(
mu…i
->
¶aves
[
i
].
pcm
);

526 i‡(
îr
 < 0)

527 
ªsu…
 = 
îr
;

529 
mu…i
->
hw_±r
 = mu…i->
≠∂_±r
 = 0;

530  
ªsu…
;

531 
	}
}

537 
	$¢d_pcm_mu…i_°¨t
(
¢d_pcm_t
 *
pcm
)

539 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

540 
îr
 = 0;

541 
i
;

542 i‡(
mu…i
->
¶aves
[0].
löked
)

543  
	`¢d_pcm_°¨t
(
mu…i
->
¶aves
[0].
löked
);

544 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

545 i‡(
mu…i
->
¶aves
[
i
].
löked
)

547 
îr
 = 
	`¢d_pcm_°¨t
(
mu…i
->
¶aves
[
i
].
pcm
);

548 i‡(
îr
 < 0)

549  
îr
;

551  
îr
;

552 
	}
}

554 
	$¢d_pcm_mu…i_dr›
(
¢d_pcm_t
 *
pcm
)

556 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

557 
îr
 = 0;

558 
i
;

559 i‡(
mu…i
->
¶aves
[0].
löked
)

560  
	`¢d_pcm_dr›
(
mu…i
->
¶aves
[0].
löked
);

561 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

562 i‡(
mu…i
->
¶aves
[
i
].
löked
)

564 
îr
 = 
	`¢d_pcm_dr›
(
mu…i
->
¶aves
[
i
].
pcm
);

565 i‡(
îr
 < 0)

566  
îr
;

568  
îr
;

569 
	}
}

571 
	$¢d_pcm_mu…i_døö
(
¢d_pcm_t
 *
pcm
)

573 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

574 
îr
 = 0;

575 
i
;

576 i‡(
mu…i
->
¶aves
[0].
löked
)

577  
	`¢d_pcm_døö
(
mu…i
->
¶aves
[0].
löked
);

578 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

579 i‡(
mu…i
->
¶aves
[
i
].
löked
)

581 
îr
 = 
	`¢d_pcm_døö
(
mu…i
->
¶aves
[
i
].
pcm
);

582 i‡(
îr
 < 0)

583  
îr
;

585  
îr
;

586 
	}
}

588 
	$¢d_pcm_mu…i_∑u£
(
¢d_pcm_t
 *
pcm
, 
íabÀ
)

590 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

591 
îr
 = 0;

592 
i
;

593 i‡(
mu…i
->
¶aves
[0].
löked
)

594  
	`¢d_pcm_∑u£
(
mu…i
->
¶aves
[0].
löked
, 
íabÀ
);

595 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

596 i‡(
mu…i
->
¶aves
[
i
].
löked
)

598 
îr
 = 
	`¢d_pcm_∑u£
(
mu…i
->
¶aves
[
i
].
pcm
, 
íabÀ
);

599 i‡(
îr
 < 0)

600  
îr
;

602  
îr
;

603 
	}
}

605 
	$¢d_pcm_mu…i_ch™√l_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_öfo_t
 *
öfo
)

607 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

608 
ch™√l
 = 
öfo
->channel;

609 
¢d_pcm_mu…i_ch™√l_t
 *
c
 = &
mu…i
->
ch™√ls
[
ch™√l
];

610 
îr
;

611 i‡(
c
->
¶ave_idx
 < 0)

612  -
ENXIO
;

613 
öfo
->
ch™√l
 = 
c
->
¶ave_ch™√l
;

614 
îr
 = 
	`¢d_pcm_ch™√l_öfo
(
mu…i
->
¶aves
[
c
->
¶ave_idx
].
pcm
, 
öfo
);

615 
öfo
->
ch™√l
 = channel;

616  
îr
;

617 
	}
}

619 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mu…i_ªwödabÀ
(
¢d_pcm_t
 *
pcm
)

621 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

622 
i
;

623 
¢d_pcm_s‰ames_t
 
‰ames
 = 
LONG_MAX
;

625 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

626 
¢d_pcm_s‰ames_t
 
f
 = 
	`¢d_pcm_ªwödabÀ
(
mu…i
->
¶aves
[
i
].
pcm
);

627 i‡(
f
 <= 0)

628  
f
;

629 i‡(
f
 < 
‰ames
)

630 
‰ames
 = 
f
;

633  
‰ames
;

635 
	}
}

637 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mu…i_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
)

639 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

640 
i
;

641 
¢d_pcm_s‰ames_t
 
‰ames
 = 
LONG_MAX
;

643 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

644 
¢d_pcm_s‰ames_t
 
f
 = 
	`¢d_pcm_f‹w¨dabÀ
(
mu…i
->
¶aves
[
i
].
pcm
);

645 i‡(
f
 <= 0)

646  
f
;

647 i‡(
f
 < 
‰ames
)

648 
‰ames
 = 
f
;

651  
‰ames
;

653 
	}
}

655 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mu…i_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

657 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

658 
i
;

659 
¢d_pcm_u‰ames_t
 
pos
[
mu…i
->
¶aves_cou¡
];

660 
	`mem£t
(
pos
, 0, (pos));

661 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

662 
¢d_pcm_t
 *
¶ave_i
 = 
mu…i
->
¶aves
[
i
].
pcm
;

663 
¢d_pcm_s‰ames_t
 
f
 = 
	`¢d_pcm_ªwöd
(
¶ave_i
, 
‰ames
);

664 i‡(
f
 < 0)

665  
f
;

666 
pos
[
i
] = 
f
;

667 
‰ames
 = 
f
;

670 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

671 
¢d_pcm_t
 *
¶ave_i
 = 
mu…i
->
¶aves
[
i
].
pcm
;

672 
¢d_pcm_u‰ames_t
 
f
 = 
pos
[
i
] - 
‰ames
;

673 
¢d_pcm_s‰ames_t
 
ªsu…
;

674 i‡(
f
 > 0) {

675 
ªsu…
 = 
	`INTERNAL
(
¢d_pcm_f‹w¨d
)(
¶ave_i
, 
f
);

676 i‡(
ªsu…
 < 0)

677  
ªsu…
;

678 i‡((
¢d_pcm_u‰ames_t
)
ªsu…
 !
f
)

679  -
EIO
;

682 
	`¢d_pcm_mm≠_≠∂_backw¨d
(
pcm
, 
‰ames
);

683  
‰ames
;

684 
	}
}

686 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mu…i_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

688 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

689 
i
;

690 
¢d_pcm_u‰ames_t
 
pos
[
mu…i
->
¶aves_cou¡
];

691 
	`mem£t
(
pos
, 0, (pos));

692 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

693 
¢d_pcm_t
 *
¶ave_i
 = 
mu…i
->
¶aves
[
i
].
pcm
;

694 
¢d_pcm_s‰ames_t
 
f
 = 
	`INTERNAL
(
¢d_pcm_f‹w¨d
)(
¶ave_i
, 
‰ames
);

695 i‡(
f
 < 0)

696  
f
;

697 
pos
[
i
] = 
f
;

698 
‰ames
 = 
f
;

701 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

702 
¢d_pcm_t
 *
¶ave_i
 = 
mu…i
->
¶aves
[
i
].
pcm
;

703 
¢d_pcm_u‰ames_t
 
f
 = 
pos
[
i
] - 
‰ames
;

704 
¢d_pcm_s‰ames_t
 
ªsu…
;

705 i‡(
f
 > 0) {

706 
ªsu…
 = 
	`¢d_pcm_ªwöd
(
¶ave_i
, 
f
);

707 i‡(
ªsu…
 < 0)

708  
ªsu…
;

709 i‡((
¢d_pcm_u‰ames_t
)
ªsu…
 !
f
)

710  -
EIO
;

713 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
‰ames
);

714  
‰ames
;

715 
	}
}

717 
	$¢d_pcm_mu…i_ªsume
(
¢d_pcm_t
 *
pcm
)

719 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

720 
îr
 = 0;

721 
i
;

722 i‡(
mu…i
->
¶aves
[0].
löked
)

723  
	`¢d_pcm_ªsume
(
mu…i
->
¶aves
[0].
löked
);

724 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

725 i‡(
mu…i
->
¶aves
[
i
].
löked
)

727 
îr
 = 
	`¢d_pcm_ªsume
(
mu…i
->
¶aves
[
i
].
pcm
);

728 i‡(
îr
 < 0)

729  
îr
;

731  
îr
;

732 
	}
}

737 
	$¢d_pcm_mu…i_lök_¶aves
(
¢d_pcm_t
 *
pcm
, snd_pcm_à*
ma°î
)

739 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

740 
i
;

741 
îr
;

743 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

744 
	`¢d_pcm_u∆ök
(
mu…i
->
¶aves
[
i
].
pcm
);

745 
mu…i
->
¶aves
[
i
].
löked
 = 
NULL
;

746 
îr
 = 
	`¢d_pcm_lök
(
ma°î
, 
mu…i
->
¶aves
[
i
].
pcm
);

747 i‡(
îr
 < 0) {

748 
	`ª£t_löks
(
mu…i
);

749  
îr
;

751 
mu…i
->
¶aves
[
i
].
löked
 = 
ma°î
;

754 
	}
}

759 
	$¢d_pcm_mu…i_lök
(
¢d_pcm_t
 *
pcm1
, snd_pcm_à*
pcm2
)

761 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm1
->
¥iv©e_d©a
;

762 
¢d_pcm_t
 *
maö_pcm
 = 
mu…i
->
¶aves
[0].
pcm
;

763 i‡(
maö_pcm
->
Á°_›s
->
lök
)

764  
maö_pcm
->
Á°_›s
->
	`lök
(maö_pcm->
Á°_›_¨g
, 
pcm2
);

765  -
ENOSYS
;

766 
	}
}

768 
	$¢d_pcm_mu…i_u∆ök
(
¢d_pcm_t
 *
pcm
)

770 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

771 
i
;

773 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

774 i‡(
mu…i
->
¶aves
[
i
].
löked
)

775 
	`¢d_pcm_u∆ök
(
mu…i
->
¶aves
[
i
].
löked
);

776 
mu…i
->
¶aves
[0].
löked
 = 
NULL
;

779 
	}
}

781 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_mu…i_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

782 
¢d_pcm_u‰ames_t
 
off£t
,

783 
¢d_pcm_u‰ames_t
 
size
)

785 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

786 
¢d_pcm_t
 *
¶ave
;

787 
i
;

788 
¢d_pcm_s‰ames_t
 
ªsu…
;

790 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

791 
¶ave
 = 
mu…i
->
¶aves
[
i
].
pcm
;

792 
ªsu…
 = 
	`¢d_pcm_mm≠_commô
(
¶ave
, 
off£t
, 
size
);

793 i‡(
ªsu…
 < 0)

794  
ªsu…
;

795 i‡((
¢d_pcm_u‰ames_t
)
ªsu…
 !
size
)

796  -
EIO
;

798 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
size
);

799  
size
;

800 
	}
}

802 
	$¢d_pcm_mu…i_munm≠
(
¢d_pcm_t
 *
pcm
)

804 
	`‰ì
(
pcm
->
mm≠_ch™√ls
);

805 
	`‰ì
(
pcm
->
ru¬ög_¨ós
);

806 
pcm
->
mm≠_ch™√ls
 = 
NULL
;

807 
pcm
->
ru¬ög_¨ós
 = 
NULL
;

809 
	}
}

811 
	$¢d_pcm_mu…i_mm≠
(
¢d_pcm_t
 *
pcm
)

813 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

814 
c
;

816 
pcm
->
mm≠_ch™√ls
 = 
	`ˇŒoc
’cm->
ch™√ls
,

817 (
pcm
->
mm≠_ch™√ls
[0]));

818 
pcm
->
ru¬ög_¨ós
 = 
	`ˇŒoc
’cm->
ch™√ls
,

819 (
pcm
->
ru¬ög_¨ós
[0]));

820 i‡(!
pcm
->
mm≠_ch™√ls
 || !pcm->
ru¬ög_¨ós
) {

821 
	`¢d_pcm_mu…i_munm≠
(
pcm
);

822  -
ENOMEM
;

826 
c
 = 0; c < 
pcm
->
ch™√ls
; c++) {

827 
¢d_pcm_mu…i_ch™√l_t
 *
ch™
 = &
mu…i
->
ch™√ls
[
c
];

828 
¢d_pcm_t
 *
¶ave
;

829 i‡(
ch™
->
¶ave_idx
 < 0) {

830 
	`¢d_pcm_mu…i_munm≠
(
pcm
);

831  -
ENXIO
;

833 
¶ave
 = 
mu…i
->
¶aves
[
ch™
->
¶ave_idx
].
pcm
;

834 
pcm
->
mm≠_ch™√ls
[
c
] =

835 
¶ave
->
mm≠_ch™√ls
[
ch™
->
¶ave_ch™√l
];

836 
pcm
->
mm≠_ch™√ls
[
c
].
ch™√l
 = c;

837 
pcm
->
ru¬ög_¨ós
[
c
] =

838 
¶ave
->
ru¬ög_¨ós
[
ch™
->
¶ave_ch™√l
];

841 
	}
}

843 
	$¢d_pcm_mu…i_may_waô_f‹_avaû_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
avaû
)

845 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

846 
i
;

847 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; ++i) {

848 i‡(
	`¢d_pcm_may_waô_f‹_avaû_mö
(
mu…i
->
¶aves
[
i
].
pcm
, 
avaû
))

852 
	}
}

854 
¢d_pcm_chm≠_quîy_t
 **
	$¢d_pcm_mu…i_quîy_chm≠s
(
¢d_pcm_t
 *
pcm
)

856 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

857 
¢d_pcm_chm≠_quîy_t
 **
¶ave_m≠s
[
mu…i
->
¶aves_cou¡
];

858 
¢d_pcm_chm≠_quîy_t
 **
m≠s
;

859 
i
;

860 
îr
 = -
ENOMEM
;

862 
	`mem£t
(
¶ave_m≠s
, 0, (slave_maps));

863 
m≠s
 = 
	`ˇŒoc
(2, (*maps));

864 i‡(!
m≠s
)

865  
NULL
;

866 
m≠s
[0] = 
	`ˇŒoc
(
mu…i
->
ch™√ls_cou¡
 + 2, (*));

867 i‡(!
m≠s
[0])

868 
îr‹
;

869 
m≠s
[0]->
ty≥
 = 
SND_CHMAP_TYPE_FIXED
;

870 
m≠s
[0]->
m≠
.
ch™√ls
 = 
mu…i
->
ch™√ls_cou¡
;

872 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; i++) {

873 
¶ave_m≠s
[
i
] = 
	`¢d_pcm_quîy_chm≠s
(
mu…i
->
¶aves
[i].
pcm
);

874 i‡(!
¶ave_m≠s
[
i
])

875 
îr‹
;

878 
i
 = 0; i < 
mu…i
->
ch™√ls_cou¡
; i++) {

879 
¢d_pcm_mu…i_ch™√l_t
 *
böd
 = &
mu…i
->
ch™√ls
[
i
];

880 
¶ave_ch™√ls
 =

881 
mu…i
->
¶aves
[
böd
->
¶ave_idx
].
ch™√ls_cou¡
;

882 
¢d_pcm_chm≠_quîy_t
 **
p
;

884 
p
 = 
¶ave_m≠s
[
böd
->
¶ave_idx
]; *p;Ö++) {

885 i‡((*
p
)->
m≠
.
ch™√ls
 =
¶ave_ch™√ls
) {

886 
m≠s
[0]->
m≠
.
pos
[
i
] =

887 (*
p
)->
m≠
.
pos
[
böd
->
¶ave_ch™√l
];

892 
îr
 = 0;

894 
îr‹
:

895 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; i++) {

896 i‡(
¶ave_m≠s
[
i
])

897 
	`¢d_pcm_‰ì_chm≠s
(
¶ave_m≠s
[
i
]);

900 i‡(
îr
) {

901 
	`¢d_pcm_‰ì_chm≠s
(
m≠s
);

902  
NULL
;

905  
m≠s
;

906 
	}
}

908 
¢d_pcm_chm≠_t
 *
	$¢d_pcm_mu…i_gë_chm≠
(
¢d_pcm_t
 *
pcm
)

910 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

911 
¢d_pcm_chm≠_t
 *
m≠
;

912 
¢d_pcm_chm≠_t
 *
¶ave_m≠s
[
mu…i
->
¶aves_cou¡
];

913 
i
;

914 
îr
 = -
ENOMEM
;

916 
	`mem£t
(
¶ave_m≠s
, 0, (slave_maps));

917 
m≠
 = 
	`ˇŒoc
(
mu…i
->
ch™√ls_cou¡
 + 1, ());

918 i‡(!
m≠
)

919  
NULL
;

921 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; i++) {

922 
¶ave_m≠s
[
i
] = 
	`¢d_pcm_gë_chm≠
(
mu…i
->
¶aves
[i].
pcm
);

923 i‡(!
¶ave_m≠s
[
i
])

924 
îr‹
;

927 
m≠
->
ch™√ls
 = 
mu…i
->
ch™√ls_cou¡
;

928 
i
 = 0; i < 
mu…i
->
ch™√ls_cou¡
; i++) {

929 
¢d_pcm_mu…i_ch™√l_t
 *
böd
 = &
mu…i
->
ch™√ls
[
i
];

930 
m≠
->
pos
[
i
] = 
¶ave_m≠s
[
böd
->
¶ave_idx
]->pos[böd->
¶ave_ch™√l
];

932 
îr
 = 0;

934 
îr‹
:

935 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; i++)

936 
	`‰ì
(
¶ave_m≠s
[
i
]);

938 i‡(
îr
) {

939 
	`‰ì
(
m≠
);

940  
NULL
;

943  
m≠
;

944 
	}
}

946 
	$¢d_pcm_mu…i_£t_chm≠
(
¢d_pcm_t
 *
pcm
, c⁄° 
¢d_pcm_chm≠_t
 *
m≠
)

948 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

949 
¢d_pcm_chm≠_t
 *
¶ave_m≠s
[
mu…i
->
¶aves_cou¡
];

950 
i
;

951 
îr
 = 0;

953 i‡(
m≠
->
ch™√ls
 !
mu…i
->
ch™√ls_cou¡
)

954  -
EINVAL
;

956 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; i++) {

957 
¶ave_m≠s
[
i
] = 
	`ˇŒoc
(
mu…i
->
¶aves
[i].
ch™√ls_cou¡
 + 1,

959 i‡(!
¶ave_m≠s
[
i
]) {

960 
i
++; i < 
mu…i
->
¶aves_cou¡
; i++)

961 
¶ave_m≠s
[
i
] = 
NULL
;

962 
îr
 = -
ENOMEM
;

963 
îr‹
;

967 
i
 = 0; i < 
mu…i
->
ch™√ls_cou¡
; i++) {

968 
¢d_pcm_mu…i_ch™√l_t
 *
böd
 = &
mu…i
->
ch™√ls
[
i
];

969 
¶ave_m≠s
[
böd
->
¶ave_idx
]->
pos
[böd->
¶ave_ch™√l
] =

970 
m≠
->
pos
[
i
];

973 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; i++) {

974 
îr
 = 
	`¢d_pcm_£t_chm≠
(
mu…i
->
¶aves
[
i
].
pcm
, 
¶ave_m≠s
[i]);

975 i‡(
îr
 < 0)

976 
îr‹
;

979 
îr‹
:

980 
i
 = 0; i < 
mu…i
->
¶aves_cou¡
; i++)

981 
	`‰ì
(
¶ave_m≠s
[
i
]);

983  
îr
;

984 
	}
}

986 
	$¢d_pcm_mu…i_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

988 
¢d_pcm_mu…i_t
 *
mu…i
 = 
pcm
->
¥iv©e_d©a
;

989 
k
;

990 
	`¢d_ouçut_¥ötf
(
out
, "Multi PCM\n");

991 
	`¢d_ouçut_¥ötf
(
out
, " Channel bindings:\n");

992 
k
 = 0; k < 
mu…i
->
ch™√ls_cou¡
; ++k) {

993 
¢d_pcm_mu…i_ch™√l_t
 *
c
 = &
mu…i
->
ch™√ls
[
k
];

994 i‡(
c
->
¶ave_idx
 < 0)

996 
	`¢d_ouçut_¥ötf
(
out
, " %d: slave %d, channel %d\n",

997 
k
, 
c
->
¶ave_idx
, c->
¶ave_ch™√l
);

999 i‡(
pcm
->
£tup
) {

1000 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

1001 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

1003 
k
 = 0; k < 
mu…i
->
¶aves_cou¡
; ++k) {

1004 
	`¢d_ouçut_¥ötf
(
out
, "Sœvê#%d: ", 
k
);

1005 
	`¢d_pcm_dump
(
mu…i
->
¶aves
[
k
].
pcm
, 
out
);

1007 
	}
}

1009 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_mu…i_›s
 = {

1010 .
˛o£
 = 
¢d_pcm_mu…i_˛o£
,

1011 .
	göfo
 = 
¢d_pcm_mu…i_öfo
,

1012 .
	ghw_ªföe
 = 
¢d_pcm_mu…i_hw_ªföe
,

1013 .
	ghw_∑øms
 = 
¢d_pcm_mu…i_hw_∑øms
,

1014 .
	ghw_‰ì
 = 
¢d_pcm_mu…i_hw_‰ì
,

1015 .
	gsw_∑øms
 = 
¢d_pcm_mu…i_sw_∑øms
,

1016 .
	gch™√l_öfo
 = 
¢d_pcm_mu…i_ch™√l_öfo
,

1017 .
	gdump
 = 
¢d_pcm_mu…i_dump
,

1018 .
	gn⁄block
 = 
¢d_pcm_mu…i_n⁄block
,

1019 .
	gasync
 = 
¢d_pcm_mu…i_async
,

1020 .
	gmm≠
 = 
¢d_pcm_mu…i_mm≠
,

1021 .
	gmunm≠
 = 
¢d_pcm_mu…i_munm≠
,

1022 .
	gquîy_chm≠s
 = 
¢d_pcm_mu…i_quîy_chm≠s
,

1023 .
	ggë_chm≠
 = 
¢d_pcm_mu…i_gë_chm≠
,

1024 .
	g£t_chm≠
 = 
¢d_pcm_mu…i_£t_chm≠
,

1027 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_mu…i_Á°_›s
 = {

1028 .
°©us
 = 
¢d_pcm_mu…i_°©us
,

1029 .
	g°©e
 = 
¢d_pcm_mu…i_°©e
,

1030 .
	ghwsync
 = 
¢d_pcm_mu…i_hwsync
,

1031 .
	gdñay
 = 
¢d_pcm_mu…i_dñay
,

1032 .
	g¥ï¨e
 = 
¢d_pcm_mu…i_¥ï¨e
,

1033 .
	gª£t
 = 
¢d_pcm_mu…i_ª£t
,

1034 .
	g°¨t
 = 
¢d_pcm_mu…i_°¨t
,

1035 .
	gdr›
 = 
¢d_pcm_mu…i_dr›
,

1036 .
	gdøö
 = 
¢d_pcm_mu…i_døö
,

1037 .
	g∑u£
 = 
¢d_pcm_mu…i_∑u£
,

1038 .
	gwrôei
 = 
¢d_pcm_mm≠_wrôei
,

1039 .
	gwrôí
 = 
¢d_pcm_mm≠_wrôí
,

1040 .
	gªadi
 = 
¢d_pcm_mm≠_ªadi
,

1041 .
	gªadn
 = 
¢d_pcm_mm≠_ªadn
,

1042 .
	gªwödabÀ
 = 
¢d_pcm_mu…i_ªwödabÀ
,

1043 .
	gªwöd
 = 
¢d_pcm_mu…i_ªwöd
,

1044 .
	gf‹w¨dabÀ
 = 
¢d_pcm_mu…i_f‹w¨dabÀ
,

1045 .
	gf‹w¨d
 = 
¢d_pcm_mu…i_f‹w¨d
,

1046 .
	gªsume
 = 
¢d_pcm_mu…i_ªsume
,

1047 .
	glök
 = 
¢d_pcm_mu…i_lök
,

1048 .
	glök_¶aves
 = 
¢d_pcm_mu…i_lök_¶aves
,

1049 .
	gu∆ök
 = 
¢d_pcm_mu…i_u∆ök
,

1050 .
	gavaû_upd©e
 = 
¢d_pcm_mu…i_avaû_upd©e
,

1051 .
	gmm≠_commô
 = 
¢d_pcm_mu…i_mm≠_commô
,

1052 .
	ghtime°amp
 = 
¢d_pcm_mu…i_htime°amp
,

1053 .
	gpﬁl_des¸ùt‹s_cou¡
 = 
¢d_pcm_mu…i_pﬁl_des¸ùt‹s_cou¡
,

1054 .
	gpﬁl_des¸ùt‹s
 = 
¢d_pcm_mu…i_pﬁl_des¸ùt‹s
,

1055 .
	gpﬁl_ªvíts
 = 
¢d_pcm_mu…i_pﬁl_ªvíts
,

1056 .
	gmay_waô_f‹_avaû_mö
 = 
¢d_pcm_mu…i_may_waô_f‹_avaû_mö
,

1076 
	$¢d_pcm_mu…i_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1077 
¶aves_cou¡
, 
ma°î_¶ave
,

1078 
¢d_pcm_t
 **
¶aves_pcm
, *
sch™√ls_cou¡
,

1079 
ch™√ls_cou¡
,

1080 *
sidxs
, *
sch™√ls
,

1081 
˛o£_¶aves
)

1083 
¢d_pcm_t
 *
pcm
;

1084 
¢d_pcm_mu…i_t
 *
mu…i
;

1085 
i
;

1086 
¢d_pcm_°ªam_t
 
°ªam
;

1087 
îr
;

1089 
	`as£π
(
pcmp
);

1090 
	`as£π
(
¶aves_cou¡
 > 0 && 
¶aves_pcm
 && 
sch™√ls_cou¡
);

1091 
	`as£π
(
ch™√ls_cou¡
 > 0 && 
sidxs
 && 
sch™√ls
);

1092 
	`as£π
(
ma°î_¶ave
 < 
¶aves_cou¡
);

1094 
mu…i
 = 
	`ˇŒoc
(1, (
¢d_pcm_mu…i_t
));

1095 i‡(!
mu…i
) {

1096  -
ENOMEM
;

1099 
°ªam
 = 
¶aves_pcm
[0]->stream;

1101 
mu…i
->
¶aves_cou¡
 = slaves_count;

1102 
mu…i
->
ma°î_¶ave
 = master_slave;

1103 
mu…i
->
¶aves
 = 
	`ˇŒoc
(
¶aves_cou¡
, (*multi->slaves));

1104 i‡(!
mu…i
->
¶aves
) {

1105 
	`‰ì
(
mu…i
);

1106  -
ENOMEM
;

1108 
mu…i
->
ch™√ls_cou¡
 = channels_count;

1109 
mu…i
->
ch™√ls
 = 
	`ˇŒoc
(
ch™√ls_cou¡
, (*multi->channels));

1110 i‡(!
mu…i
->
ch™√ls
) {

1111 
	`‰ì
(
mu…i
->
¶aves
);

1112 
	`‰ì
(
mu…i
);

1113  -
ENOMEM
;

1115 
i
 = 0; i < 
¶aves_cou¡
; ++i) {

1116 
¢d_pcm_mu…i_¶ave_t
 *
¶ave
 = &
mu…i
->
¶aves
[
i
];

1117 
	`as£π
(
¶aves_pcm
[
i
]->
°ªam
 == stream);

1118 
¶ave
->
pcm
 = 
¶aves_pcm
[
i
];

1119 
¶ave
->
ch™√ls_cou¡
 = 
sch™√ls_cou¡
[
i
];

1120 
¶ave
->
˛o£_¶ave
 = 
˛o£_¶aves
;

1122 
i
 = 0; i < 
ch™√ls_cou¡
; ++i) {

1123 
¢d_pcm_mu…i_ch™√l_t
 *
böd
 = &
mu…i
->
ch™√ls
[
i
];

1124 
	`as£π
(
sidxs
[
i
] < ()
¶aves_cou¡
);

1125 
	`as£π
(
sch™√ls
[
i
] < 
sch™√ls_cou¡
[
sidxs
[i]]);

1126 
böd
->
¶ave_idx
 = 
sidxs
[
i
];

1127 
böd
->
¶ave_ch™√l
 = 
sch™√ls
[
i
];

1128 i‡(
sidxs
[
i
] < 0)

1131 
mu…i
->
ch™√ls_cou¡
 = channels_count;

1133 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_MULTI
, 
«me
, 
°ªam
,

1134 
mu…i
->
¶aves
[0].
pcm
->
mode
);

1135 i‡(
îr
 < 0) {

1136 
	`‰ì
(
mu…i
->
¶aves
);

1137 
	`‰ì
(
mu…i
->
ch™√ls
);

1138 
	`‰ì
(
mu…i
);

1139  
îr
;

1141 
pcm
->
mm≠_rw
 = 1;

1142 
pcm
->
mm≠_shadow
 = 1;

1143 
pcm
->
›s
 = &
¢d_pcm_mu…i_›s
;

1144 
pcm
->
Á°_›s
 = &
¢d_pcm_mu…i_Á°_›s
;

1145 
pcm
->
¥iv©e_d©a
 = 
mu…i
;

1146 
pcm
->
pﬁl_fd
 = 
mu…i
->
¶aves
[
ma°î_¶ave
].pcm->poll_fd;

1147 
pcm
->
pﬁl_evíts
 = 
mu…i
->
¶aves
[
ma°î_¶ave
].pcm->poll_events;

1148 
pcm
->
t°amp_ty≥
 = 
mu…i
->
¶aves
[
ma°î_¶ave
].pcm->tstamp_type;

1149 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
mu…i
->
hw_±r
, -1, 0);

1150 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
mu…i
->
≠∂_±r
, -1, 0);

1151 *
pcmp
 = 
pcm
;

1153 
	}
}

1243 
	$_¢d_pcm_mu…i_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1244 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

1245 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

1247 
¢d_c⁄fig_ôî©‹_t
 
i
, 
öext
, 
j
, 
j√xt
;

1248 
¢d_c⁄fig_t
 *
¶aves
 = 
NULL
;

1249 
¢d_c⁄fig_t
 *
bödögs
 = 
NULL
;

1250 
îr
;

1251 
idx
;

1252 c⁄° **
¶aves_id
 = 
NULL
;

1253 
¢d_c⁄fig_t
 **
¶aves_c⁄f
 = 
NULL
;

1254 
¢d_pcm_t
 **
¶aves_pcm
 = 
NULL
;

1255 *
¶aves_ch™√ls
 = 
NULL
;

1256 *
ch™√ls_sidx
 = 
NULL
;

1257 *
ch™√ls_sch™√l
 = 
NULL
;

1258 
¶aves_cou¡
 = 0;

1259 
ma°î_¶ave
 = 0;

1260 
ch™√ls_cou¡
 = 0;

1261 
	`¢d_c⁄fig_f‹_óch
(
i
, 
öext
, 
c⁄f
) {

1262 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1263 c⁄° *
id
;

1264 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1266 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

1268 i‡(
	`°rcmp
(
id
, "slaves") == 0) {

1269 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1270 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1271  -
EINVAL
;

1273 
¶aves
 = 
n
;

1276 i‡(
	`°rcmp
(
id
, "bindings") == 0) {

1277 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1278 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1279  -
EINVAL
;

1281 
bödögs
 = 
n
;

1284 i‡(
	`°rcmp
(
id
, "master") == 0) {

1285 i‡(
	`¢d_c⁄fig_gë_öãgî
(
n
, &
ma°î_¶ave
) < 0) {

1286 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1287  -
EINVAL
;

1291 
	`SNDERR
("Unknow¿fõld %s", 
id
);

1292  -
EINVAL
;

1294 i‡(!
¶aves
) {

1295 
	`SNDERR
("slaves isÇot defined");

1296  -
EINVAL
;

1298 i‡(!
bödögs
) {

1299 
	`SNDERR
("bindings isÇot defined");

1300  -
EINVAL
;

1302 
	`¢d_c⁄fig_f‹_óch
(
i
, 
öext
, 
¶aves
) {

1303 ++
¶aves_cou¡
;

1305 i‡(
ma°î_¶ave
 < 0 || ma°î_¶avê>()
¶aves_cou¡
) {

1306 
	`SNDERR
("Ma°î sœvêi†ouào‡øngê(0-%u)", 
¶aves_cou¡
-1);

1307  -
EINVAL
;

1309 
	`¢d_c⁄fig_f‹_óch
(
i
, 
öext
, 
bödögs
) {

1310 
cch™√l
;

1311 
¢d_c⁄fig_t
 *
m
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1312 c⁄° *
id
;

1313 i‡(
	`¢d_c⁄fig_gë_id
(
m
, &
id
) < 0)

1315 
îr
 = 
	`ß„_°πﬁ
(
id
, &
cch™√l
);

1316 i‡(
îr
 < 0 || 
cch™√l
 < 0) {

1317 
	`SNDERR
("InvÆid ch™√»numbî: %s", 
id
);

1318  -
EINVAL
;

1320 i‡(()
cch™√l
 >
ch™√ls_cou¡
)

1321 
ch™√ls_cou¡
 = 
cch™√l
 + 1;

1323 i‡(
ch™√ls_cou¡
 == 0) {

1324 
	`SNDERR
("No channels defined");

1325  -
EINVAL
;

1327 
¶aves_id
 = 
	`ˇŒoc
(
¶aves_cou¡
, (*slaves_id));

1328 
¶aves_c⁄f
 = 
	`ˇŒoc
(
¶aves_cou¡
, (*slaves_conf));

1329 
¶aves_pcm
 = 
	`ˇŒoc
(
¶aves_cou¡
, (*slaves_pcm));

1330 
¶aves_ch™√ls
 = 
	`ˇŒoc
(
¶aves_cou¡
, (*slaves_channels));

1331 
ch™√ls_sidx
 = 
	`ˇŒoc
(
ch™√ls_cou¡
, (*channels_sidx));

1332 
ch™√ls_sch™√l
 = 
	`ˇŒoc
(
ch™√ls_cou¡
, (*channels_schannel));

1333 i‡(!
¶aves_id
 || !
¶aves_c⁄f
 || !
¶aves_pcm
 || !
¶aves_ch™√ls
 ||

1334 !
ch™√ls_sidx
 || !
ch™√ls_sch™√l
) {

1335 
îr
 = -
ENOMEM
;

1336 
_‰ì
;

1338 
idx
 = 0; idx < 
ch™√ls_cou¡
; ++idx)

1339 
ch™√ls_sidx
[
idx
] = -1;

1340 
idx
 = 0;

1341 
	`¢d_c⁄fig_f‹_óch
(
i
, 
öext
, 
¶aves
) {

1342 
¢d_c⁄fig_t
 *
m
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1343 c⁄° *
id
;

1344 
ch™√ls
;

1345 i‡(
	`¢d_c⁄fig_gë_id
(
m
, &
id
) < 0)

1347 
¶aves_id
[
idx
] = 
id
;

1348 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
m
, &
¶aves_c⁄f
[
idx
], 1,

1349 
SND_PCM_HW_PARAM_CHANNELS
, 
SCONF_MANDATORY
, &
ch™√ls
);

1350 i‡(
îr
 < 0)

1351 
_‰ì
;

1352 
¶aves_ch™√ls
[
idx
] = 
ch™√ls
;

1353 ++
idx
;

1356 
	`¢d_c⁄fig_f‹_óch
(
i
, 
öext
, 
bödögs
) {

1357 
¢d_c⁄fig_t
 *
m
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1358 
cch™√l
 = -1;

1359 
sch™√l
 = -1;

1360 
¶ave
 = -1;

1361 
vÆ
;

1362 c⁄° *
°r
;

1363 c⁄° *
id
;

1364 i‡(
	`¢d_c⁄fig_gë_id
(
m
, &
id
) < 0)

1366 
îr
 = 
	`ß„_°πﬁ
(
id
, &
cch™√l
);

1367 i‡(
îr
 < 0 || 
cch™√l
 < 0) {

1368 
	`SNDERR
("InvÆid ch™√»numbî: %s", 
id
);

1369 
îr
 = -
EINVAL
;

1370 
_‰ì
;

1372 
	`¢d_c⁄fig_f‹_óch
(
j
, 
j√xt
, 
m
) {

1373 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
j
);

1374 c⁄° *
id
;

1375 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1377 i‡(
	`°rcmp
(
id
, "comment") == 0)

1379 i‡(
	`°rcmp
(
id
, "slave") == 0) {

1380 
buf
[32];

1381 
k
;

1382 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
);

1383 i‡(
îr
 < 0) {

1384 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
vÆ
);

1385 i‡(
îr
 < 0) {

1386 
	`SNDERR
("InvÆid vÆuêf‹ %s", 
id
);

1387 
_‰ì
;

1389 
	`•rötf
(
buf
, "%ld", 
vÆ
);

1390 
°r
 = 
buf
;

1392 
k
 = 0; k < 
¶aves_cou¡
; ++k) {

1393 i‡(
	`°rcmp
(
¶aves_id
[
k
], 
°r
) == 0)

1394 
¶ave
 = 
k
;

1398 i‡(
	`°rcmp
(
id
, "channel") == 0) {

1399 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
sch™√l
);

1400 i‡(
îr
 < 0) {

1401 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1402 
_‰ì
;

1406 
	`SNDERR
("Unknow¿fõld %s", 
id
);

1407 
îr
 = -
EINVAL
;

1408 
_‰ì
;

1410 i‡(
¶ave
 < 0 || ()¶avê>
¶aves_cou¡
) {

1411 
	`SNDERR
("InvÆid o∏missög sidx f‹ ch™√»%s", 
id
);

1412 
îr
 = -
EINVAL
;

1413 
_‰ì
;

1415 i‡(
sch™√l
 < 0 ||

1416 (Ë
sch™√l
 >
¶aves_ch™√ls
[
¶ave
]) {

1417 
	`SNDERR
("InvÆid o∏missög sch™√»f‹ ch™√»%s", 
id
);

1418 
îr
 = -
EINVAL
;

1419 
_‰ì
;

1421 
ch™√ls_sidx
[
cch™√l
] = 
¶ave
;

1422 
ch™√ls_sch™√l
[
cch™√l
] = 
sch™√l
;

1425 
idx
 = 0; idx < 
¶aves_cou¡
; ++idx) {

1426 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
¶aves_pcm
[
idx
], 
roŸ
,

1427 
¶aves_c⁄f
[
idx
], 
°ªam
, 
mode
,

1428 
c⁄f
);

1429 i‡(
îr
 < 0)

1430 
_‰ì
;

1431 
	`¢d_c⁄fig_dñëe
(
¶aves_c⁄f
[
idx
]);

1432 
¶aves_c⁄f
[
idx
] = 
NULL
;

1434 
îr
 = 
	`¢d_pcm_mu…i_›í
(
pcmp
, 
«me
, 
¶aves_cou¡
, 
ma°î_¶ave
,

1435 
¶aves_pcm
, 
¶aves_ch™√ls
,

1436 
ch™√ls_cou¡
,

1437 
ch™√ls_sidx
, 
ch™√ls_sch™√l
,

1439 
_‰ì
:

1440 i‡(
îr
 < 0) {

1441 
idx
 = 0; idx < 
¶aves_cou¡
; ++idx) {

1442 i‡(
¶aves_pcm
[
idx
])

1443 
	`¢d_pcm_˛o£
(
¶aves_pcm
[
idx
]);

1446 i‡(
¶aves_c⁄f
) {

1447 
idx
 = 0; idx < 
¶aves_cou¡
; ++idx) {

1448 i‡(
¶aves_c⁄f
[
idx
])

1449 
	`¢d_c⁄fig_dñëe
(
¶aves_c⁄f
[
idx
]);

1451 
	`‰ì
(
¶aves_c⁄f
);

1453 
	`‰ì
(
¶aves_pcm
);

1454 
	`‰ì
(
¶aves_ch™√ls
);

1455 
	`‰ì
(
ch™√ls_sidx
);

1456 
	`‰ì
(
ch™√ls_sch™√l
);

1457 
	`‰ì
(
¶aves_id
);

1458  
îr
;

1459 
	}
}

1460 #i‚de‡
DOC_HIDDEN


1461 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_mu…i_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_null.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_∂ugö.h
"

31 
	~"bsw≠.h
"

32 
	~<limôs.h
>

34 #i‚de‡
PIC


36 c⁄° *
	g_¢d_moduÀ_pcm_nuŒ
 = "";

39 #i‚de‡
DOC_HIDDEN


41 
¢d_htime°amp_t
 
	måiggî_t°amp
;

42 
¢d_pcm_°©e_t
 
	m°©e
;

43 
¢d_pcm_u‰ames_t
 
	m≠∂_±r
;

44 
¢d_pcm_u‰ames_t
 
	mhw_±r
;

45 
	mpﬁl_fd
;

46 
¢d_pcm_chm≠_quîy_t
 **
	mchm≠
;

47 } 
	t¢d_pcm_nuŒ_t
;

50 
	$¢d_pcm_nuŒ_˛o£
(
¢d_pcm_t
 *
pcm
)

52 
¢d_pcm_nuŒ_t
 *
nuŒ
 = 
pcm
->
¥iv©e_d©a
;

53 
	`˛o£
(
nuŒ
->
pﬁl_fd
);

54 
	`‰ì
(
nuŒ
);

56 
	}
}

58 
	$¢d_pcm_nuŒ_n⁄block
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
n⁄block
 ATTRIBUTE_UNUSED)

61 
	}
}

63 
	$¢d_pcm_nuŒ_async
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
sig
 ATTRIBUTE_UNUSED, 
pid_t
 
pid
 ATTRIBUTE_UNUSED)

65  -
ENOSYS
;

66 
	}
}

68 
	$¢d_pcm_nuŒ_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_öfo_t
 * 
öfo
)

70 
	`mem£t
(
öfo
, 0, (*info));

71 
öfo
->
°ªam
 = 
pcm
->stream;

72 
öfo
->
ˇrd
 = -1;

73 i‡(
pcm
->
«me
) {

74 
	`¢d_°æ˝y
((*)
öfo
->
id
, 
pcm
->
«me
, (info->id));

75 
	`¢d_°æ˝y
((*)
öfo
->
«me
, 
pcm
->name, (info->name));

76 
	`¢d_°æ˝y
((*)
öfo
->
sub«me
, 
pcm
->
«me
, (info->subname));

78 
öfo
->
subdevi˚s_cou¡
 = 1;

80 
	}
}

82 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_nuŒ_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

84 
¢d_pcm_nuŒ_t
 *
nuŒ
 = 
pcm
->
¥iv©e_d©a
;

85 i‡(
nuŒ
->
°©e
 =
SND_PCM_STATE_PREPARED
) {

88  
	`¢d_pcm_mm≠_avaû
(
pcm
);

90  
pcm
->
buf„r_size
;

91 
	}
}

93 
	$¢d_pcm_nuŒ_°©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©us_t
 * 
°©us
)

95 
¢d_pcm_nuŒ_t
 *
nuŒ
 = 
pcm
->
¥iv©e_d©a
;

96 
	`mem£t
(
°©us
, 0, (*status));

97 
°©us
->
°©e
 = 
nuŒ
->state;

98 
°©us
->
åiggî_t°amp
 = 
nuŒ
->trigger_tstamp;

99 
°©us
->
≠∂_±r
 = *
pcm
->
≠∂
.
±r
;

100 
°©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

101 
	`gëtime°amp
(&
°©us
->
t°amp
, 
pcm
->
t°amp_ty≥
);

102 
°©us
->
avaû
 = 
	`¢d_pcm_nuŒ_avaû_upd©e
(
pcm
);

103 
°©us
->
avaû_max
 = 
pcm
->
buf„r_size
;

105 
	}
}

107 
¢d_pcm_°©e_t
 
	$¢d_pcm_nuŒ_°©e
(
¢d_pcm_t
 *
pcm
)

109 
¢d_pcm_nuŒ_t
 *
nuŒ
 = 
pcm
->
¥iv©e_d©a
;

110  
nuŒ
->
°©e
;

111 
	}
}

113 
	$¢d_pcm_nuŒ_hwsync
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

116 
	}
}

118 
	$¢d_pcm_nuŒ_dñay
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_s‰ames_t
 *
dñayp
)

120 *
dñayp
 = 0;

122 
	}
}

124 
	$¢d_pcm_nuŒ_ª£t
(
¢d_pcm_t
 *
pcm
)

126 *
pcm
->
≠∂
.
±r
 = 0;

127 *
pcm
->
hw
.
±r
 = 0;

129 
	}
}

131 
	$¢d_pcm_nuŒ_¥ï¨e
(
¢d_pcm_t
 *
pcm
)

133 
¢d_pcm_nuŒ_t
 *
nuŒ
 = 
pcm
->
¥iv©e_d©a
;

134 
nuŒ
->
°©e
 = 
SND_PCM_STATE_PREPARED
;

135  
	`¢d_pcm_nuŒ_ª£t
(
pcm
);

136 
	}
}

138 
	$¢d_pcm_nuŒ_°¨t
(
¢d_pcm_t
 *
pcm
)

140 
¢d_pcm_nuŒ_t
 *
nuŒ
 = 
pcm
->
¥iv©e_d©a
;

141 
	`as£π
(
nuŒ
->
°©e
 =
SND_PCM_STATE_PREPARED
);

142 
nuŒ
->
°©e
 = 
SND_PCM_STATE_RUNNING
;

143 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_CAPTURE
)

144 *
pcm
->
hw
.
±r
 = *pcm->
≠∂
.±∏+Öcm->
buf„r_size
;

146 *
pcm
->
hw
.
±r
 = *pcm->
≠∂
.ptr;

148 
	}
}

150 
	$¢d_pcm_nuŒ_dr›
(
¢d_pcm_t
 *
pcm
)

152 
¢d_pcm_nuŒ_t
 *
nuŒ
 = 
pcm
->
¥iv©e_d©a
;

153 
	`as£π
(
nuŒ
->
°©e
 !
SND_PCM_STATE_OPEN
);

154 
nuŒ
->
°©e
 = 
SND_PCM_STATE_SETUP
;

156 
	}
}

158 
	$¢d_pcm_nuŒ_døö
(
¢d_pcm_t
 *
pcm
)

160 
¢d_pcm_nuŒ_t
 *
nuŒ
 = 
pcm
->
¥iv©e_d©a
;

161 
	`as£π
(
nuŒ
->
°©e
 !
SND_PCM_STATE_OPEN
);

162 
nuŒ
->
°©e
 = 
SND_PCM_STATE_SETUP
;

164 
	}
}

166 
	$¢d_pcm_nuŒ_∑u£
(
¢d_pcm_t
 *
pcm
, 
íabÀ
)

168 
¢d_pcm_nuŒ_t
 *
nuŒ
 = 
pcm
->
¥iv©e_d©a
;

169 i‡(
íabÀ
) {

170 i‡(
nuŒ
->
°©e
 !
SND_PCM_STATE_RUNNING
)

171  -
EBADFD
;

172 
nuŒ
->
°©e
 = 
SND_PCM_STATE_PAUSED
;

174 i‡(
nuŒ
->
°©e
 !
SND_PCM_STATE_PAUSED
)

175  -
EBADFD
;

176 
nuŒ
->
°©e
 = 
SND_PCM_STATE_RUNNING
;

179 
	}
}

181 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_nuŒ_ªwödabÀ
(
¢d_pcm_t
 *
pcm
)

183  
pcm
->
buf„r_size
;

184 
	}
}

186 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_nuŒ_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

189 
	}
}

192 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_nuŒ_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

194 
¢d_pcm_nuŒ_t
 *
nuŒ
 = 
pcm
->
¥iv©e_d©a
;

195 
nuŒ
->
°©e
) {

196 
SND_PCM_STATE_RUNNING
:

197 
	`¢d_pcm_mm≠_hw_backw¨d
(
pcm
, 
‰ames
);

199 
SND_PCM_STATE_PREPARED
:

200 
	`¢d_pcm_mm≠_≠∂_backw¨d
(
pcm
, 
‰ames
);

201  
‰ames
;

203  -
EBADFD
;

205 
	}
}

207 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_nuŒ_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

209 
¢d_pcm_nuŒ_t
 *
nuŒ
 = 
pcm
->
¥iv©e_d©a
;

210 
nuŒ
->
°©e
) {

211 
SND_PCM_STATE_RUNNING
:

212 
	`¢d_pcm_mm≠_hw_f‹w¨d
(
pcm
, 
‰ames
);

214 
SND_PCM_STATE_PREPARED
:

215 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
‰ames
);

216  
‰ames
;

218  -
EBADFD
;

220 
	}
}

222 
	$¢d_pcm_nuŒ_ªsume
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

225 
	}
}

227 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_nuŒ_x„r_¨ós
(
¢d_pcm_t
 *
pcm
,

228 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
 
ATTRIBUTE_UNUSED
,

229 
¢d_pcm_u‰ames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

230 
¢d_pcm_u‰ames_t
 
size
)

232 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
size
);

233 
	`¢d_pcm_mm≠_hw_f‹w¨d
(
pcm
, 
size
);

234  
size
;

235 
	}
}

237 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_nuŒ_wrôei
(
¢d_pcm_t
 *
pcm
, c⁄° *
buf„r
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_u‰ames_t
 
size
)

239  
	`¢d_pcm_wrôe_¨ós
(
pcm
, 
NULL
, 0, 
size
, 
¢d_pcm_nuŒ_x„r_¨ós
);

240 
	}
}

242 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_nuŒ_wrôí
(
¢d_pcm_t
 *
pcm
, **
bufs
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_u‰ames_t
 
size
)

244  
	`¢d_pcm_wrôe_¨ós
(
pcm
, 
NULL
, 0, 
size
, 
¢d_pcm_nuŒ_x„r_¨ós
);

245 
	}
}

247 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_nuŒ_ªadi
(
¢d_pcm_t
 *
pcm
, *
buf„r
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_u‰ames_t
 
size
)

249  
	`¢d_pcm_ªad_¨ós
(
pcm
, 
NULL
, 0, 
size
, 
¢d_pcm_nuŒ_x„r_¨ós
);

250 
	}
}

252 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_nuŒ_ªadn
(
¢d_pcm_t
 *
pcm
, **
bufs
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_u‰ames_t
 
size
)

254  
	`¢d_pcm_ªad_¨ós
(
pcm
, 
NULL
, 0, 
size
, 
¢d_pcm_nuŒ_x„r_¨ós
);

255 
	}
}

257 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_nuŒ_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

258 
¢d_pcm_u‰ames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

259 
¢d_pcm_u‰ames_t
 
size
)

261  
	`¢d_pcm_nuŒ_f‹w¨d
(
pcm
, 
size
);

262 
	}
}

264 
	$¢d_pcm_nuŒ_hw_ªföe
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

266 
îr
;

271 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mö
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 1,

273 i‡(
îr
 < 0)

274  
îr
;

276 
îr
 = 
	`¢d_pcm_hw_ªföe_so·
(
pcm
, 
∑øms
);

277 
∑øms
->
öfo
 = 
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
 |

278 
SND_PCM_INFO_RESUME
 | 
SND_PCM_INFO_PAUSE
;

279 
∑øms
->
fifo_size
 = 0;

280  
îr
;

281 
	}
}

283 
	$¢d_pcm_nuŒ_hw_∑øms
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 * 
∑øms
 ATTRIBUTE_UNUSED)

286 
	}
}

288 
	$¢d_pcm_nuŒ_hw_‰ì
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

291 
	}
}

293 
	$¢d_pcm_nuŒ_sw_∑øms
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_∑øms_t
 * 
∑øms
 ATTRIBUTE_UNUSED)

296 
	}
}

298 
¢d_pcm_chm≠_quîy_t
 **
	$¢d_pcm_nuŒ_quîy_chm≠s
(
¢d_pcm_t
 *
pcm
)

300 
¢d_pcm_nuŒ_t
 *
nuŒ
 = 
pcm
->
¥iv©e_d©a
;

302 i‡(
nuŒ
->
chm≠
)

303  
	`_¢d_pcm_c›y_chm≠_quîy
(
nuŒ
->
chm≠
);

304  
NULL
;

305 
	}
}

307 
¢d_pcm_chm≠_t
 *
	$¢d_pcm_nuŒ_gë_chm≠
(
¢d_pcm_t
 *
pcm
)

309 
¢d_pcm_nuŒ_t
 *
nuŒ
 = 
pcm
->
¥iv©e_d©a
;

311 i‡(
nuŒ
->
chm≠
)

312  
	`_¢d_pcm_choo£_fixed_chm≠
(
pcm
, 
nuŒ
->
chm≠
);

313  
NULL
;

314 
	}
}

316 
	$¢d_pcm_nuŒ_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

318 
	`¢d_ouçut_¥ötf
(
out
, "Null PCM\n");

319 i‡(
pcm
->
£tup
) {

320 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

321 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

323 
	}
}

325 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_nuŒ_›s
 = {

326 .
˛o£
 = 
¢d_pcm_nuŒ_˛o£
,

327 .
	göfo
 = 
¢d_pcm_nuŒ_öfo
,

328 .
	ghw_ªföe
 = 
¢d_pcm_nuŒ_hw_ªföe
,

329 .
	ghw_∑øms
 = 
¢d_pcm_nuŒ_hw_∑øms
,

330 .
	ghw_‰ì
 = 
¢d_pcm_nuŒ_hw_‰ì
,

331 .
	gsw_∑øms
 = 
¢d_pcm_nuŒ_sw_∑øms
,

332 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

333 .
	gdump
 = 
¢d_pcm_nuŒ_dump
,

334 .
	gn⁄block
 = 
¢d_pcm_nuŒ_n⁄block
,

335 .
	gasync
 = 
¢d_pcm_nuŒ_async
,

336 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

337 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

338 .
	gquîy_chm≠s
 = 
¢d_pcm_nuŒ_quîy_chm≠s
,

339 .
	ggë_chm≠
 = 
¢d_pcm_nuŒ_gë_chm≠
,

340 .
	g£t_chm≠
 = 
NULL
,

343 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_nuŒ_Á°_›s
 = {

344 .
°©us
 = 
¢d_pcm_nuŒ_°©us
,

345 .
	g°©e
 = 
¢d_pcm_nuŒ_°©e
,

346 .
	ghwsync
 = 
¢d_pcm_nuŒ_hwsync
,

347 .
	gdñay
 = 
¢d_pcm_nuŒ_dñay
,

348 .
	g¥ï¨e
 = 
¢d_pcm_nuŒ_¥ï¨e
,

349 .
	gª£t
 = 
¢d_pcm_nuŒ_ª£t
,

350 .
	g°¨t
 = 
¢d_pcm_nuŒ_°¨t
,

351 .
	gdr›
 = 
¢d_pcm_nuŒ_dr›
,

352 .
	gdøö
 = 
¢d_pcm_nuŒ_døö
,

353 .
	g∑u£
 = 
¢d_pcm_nuŒ_∑u£
,

354 .
	gªwödabÀ
 = 
¢d_pcm_nuŒ_ªwödabÀ
,

355 .
	gªwöd
 = 
¢d_pcm_nuŒ_ªwöd
,

356 .
	gf‹w¨dabÀ
 = 
¢d_pcm_nuŒ_f‹w¨dabÀ
,

357 .
	gf‹w¨d
 = 
¢d_pcm_nuŒ_f‹w¨d
,

358 .
	gªsume
 = 
¢d_pcm_nuŒ_ªsume
,

359 .
	gwrôei
 = 
¢d_pcm_nuŒ_wrôei
,

360 .
	gwrôí
 = 
¢d_pcm_nuŒ_wrôí
,

361 .
	gªadi
 = 
¢d_pcm_nuŒ_ªadi
,

362 .
	gªadn
 = 
¢d_pcm_nuŒ_ªadn
,

363 .
	gavaû_upd©e
 = 
¢d_pcm_nuŒ_avaû_upd©e
,

364 .
	gmm≠_commô
 = 
¢d_pcm_nuŒ_mm≠_commô
,

365 .
	ghtime°amp
 = 
¢d_pcm_gíîic_ªÆ_htime°amp
,

379 
	$¢d_pcm_nuŒ_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
, 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

381 
¢d_pcm_t
 *
pcm
;

382 
¢d_pcm_nuŒ_t
 *
nuŒ
;

383 
fd
;

384 
îr
;

385 
	`as£π
(
pcmp
);

386 i‡(
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

387 
fd
 = 
	`›í
("/dev/nuŒ", 
O_WRONLY
);

388 i‡(
fd
 < 0) {

389 
	`SYSERR
("Cannot open /dev/null");

390  -
î∫o
;

393 
fd
 = 
	`›í
("/dev/fuŒ", 
O_RDONLY
);

394 i‡(
fd
 < 0) {

395 
	`SYSERR
("Cannot open /dev/full");

396  -
î∫o
;

399 
nuŒ
 = 
	`ˇŒoc
(1, (
¢d_pcm_nuŒ_t
));

400 i‡(!
nuŒ
) {

401 
	`˛o£
(
fd
);

402  -
ENOMEM
;

404 
nuŒ
->
pﬁl_fd
 = 
fd
;

405 
nuŒ
->
°©e
 = 
SND_PCM_STATE_OPEN
;

407 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_NULL
, 
«me
, 
°ªam
, 
mode
);

408 i‡(
îr
 < 0) {

409 
	`˛o£
(
fd
);

410 
	`‰ì
(
nuŒ
);

411  
îr
;

413 
pcm
->
›s
 = &
¢d_pcm_nuŒ_›s
;

414 
pcm
->
Á°_›s
 = &
¢d_pcm_nuŒ_Á°_›s
;

415 
pcm
->
¥iv©e_d©a
 = 
nuŒ
;

416 
pcm
->
pﬁl_fd
 = 
fd
;

417 
pcm
->
pﬁl_evíts
 = 
°ªam
 =
SND_PCM_STREAM_PLAYBACK
 ? 
POLLOUT
 : 
POLLIN
;

418 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
nuŒ
->
hw_±r
, -1, 0);

419 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
nuŒ
->
≠∂_±r
, -1, 0);

420 *
pcmp
 = 
pcm
;

423 
	}
}

464 
	$_¢d_pcm_nuŒ_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

465 
¢d_c⁄fig_t
 *
roŸ
 
ATTRIBUTE_UNUSED
, snd_c⁄fig_à*
c⁄f
,

466 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

468 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

469 
¢d_pcm_nuŒ_t
 *
nuŒ
;

470 
¢d_pcm_chm≠_quîy_t
 **
chm≠
 = 
NULL
;

471 
îr
;

473 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

474 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

475 c⁄° *
id
;

476 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

478 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

480 i‡(
	`°rcmp
(
id
, "chmap") == 0) {

481 
	`¢d_pcm_‰ì_chm≠s
(
chm≠
);

482 
chm≠
 = 
	`_¢d_pcm_∑r£_c⁄fig_chm≠s
(
n
);

483 i‡(!
chm≠
) {

484 
	`SNDERR
("InvÆid ch™√»m≠ f‹ %s", 
id
);

485  -
EINVAL
;

489 
	`SNDERR
("Unknow¿fõld %s", 
id
);

490 
	`¢d_pcm_‰ì_chm≠s
(
chm≠
);

491  -
EINVAL
;

493 
îr
 = 
	`¢d_pcm_nuŒ_›í
(
pcmp
, 
«me
, 
°ªam
, 
mode
);

494 i‡(
îr
 < 0) {

495 
	`¢d_pcm_‰ì_chm≠s
(
chm≠
);

496  
îr
;

499 
nuŒ
 = (*
pcmp
)->
¥iv©e_d©a
;

500 
nuŒ
->
chm≠
 = chmap;

502 
	}
}

503 #i‚de‡
DOC_HIDDEN


504 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_nuŒ_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_params.c

22 
	~"pcm_loˇl.h
"

24 #i‚de‡
NDEBUG


28 
	$dump_hw_∑øms
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, c⁄° *
ty≥
,

29 
¢d_pcm_hw_∑øm_t
 
v¨
, 
vÆ
, 
îr
)

31 c⁄° *
vîbo£
 = 
	`gëív
("LIBASOUND_DEBUG");

32 
¢d_ouçut_t
 *
out
;

34 i‡(! 
vîbo£
 || ! *vîbo£ || 
	`©oi
(verbose) < 1)

36 i‡(
	`¢d_ouçut_°dio_©èch
(&
out
, 
°dîr
, 0) < 0)

38 
	`Ârötf
(
°dîr
, "ALSA ERROR hw_params: %s (%s)\n",

39 
ty≥
, 
	`¢d_pcm_hw_∑øm_«me
(
v¨
));

40 
	`Ârötf
(
°dîr
, " value = ");

41 
v¨
) {

42 
SND_PCM_HW_PARAM_ACCESS
:

43 
	`Ârötf
(
°dîr
, "%s", 
	`¢d_pcm_ac˚ss_«me
(
vÆ
));

45 
SND_PCM_HW_PARAM_FORMAT
:

46 
	`Ârötf
(
°dîr
, "%s", 
	`¢d_pcm_f‹m©_«me
(
vÆ
));

48 
SND_PCM_HW_PARAM_SUBFORMAT
:

49 
	`Ârötf
(
°dîr
, "%s", 
	`¢d_pcm_subf‹m©_«me
(
vÆ
));

52 
	`Ârötf
(
°dîr
, "%u", 
vÆ
);

54 
	`Ârötf
(
°dîr
, " : %s\n", 
	`¢d_°ªº‹
(
îr
));

55 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
out
);

56 
	`¢d_ouçut_˛o£
(
out
);

57 
	}
}

59 
ölöe
 
	$dump_hw_∑øms
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, c⁄° *
ty≥
,

60 
¢d_pcm_hw_∑øm_t
 
v¨
, 
vÆ
, 
îr
)

62 
	}
}

65 
ölöe
 
	$hw_is_mask
(
¢d_pcm_hw_∑øm_t
 
v¨
)

67 #i‡
SND_PCM_HW_PARAM_FIRST_MASK
 == 0

68  
v¨
 <
SND_PCM_HW_PARAM_LAST_MASK
;

70  
v¨
 >
SND_PCM_HW_PARAM_FIRST_MASK
 &&

71 
v¨
 <
SND_PCM_HW_PARAM_LAST_MASK
;

73 
	}
}

75 
ölöe
 
	$hw_is_öãrvÆ
(
¢d_pcm_hw_∑øm_t
 
v¨
)

77  
v¨
 >
SND_PCM_HW_PARAM_FIRST_INTERVAL
 &&

78 
v¨
 <
SND_PCM_HW_PARAM_LAST_INTERVAL
;

79 
	}
}

81 
	#hw_∑øm_mask
(
∑øms
,
v¨
) \

82 &((
∑øms
)->
masks
[(
v¨
Ë- 
SND_PCM_HW_PARAM_FIRST_MASK
])

	)

84 
	#hw_∑øm_öãrvÆ
(
∑øms
,
v¨
) \

85 &((
∑øms
)->
öãrvÆs
[(
v¨
Ë- 
SND_PCM_HW_PARAM_FIRST_INTERVAL
])

	)

87 
	#hw_∑øm_mask_c
 
hw_∑øm_mask


	)

88 
	#hw_∑øm_öãrvÆ_c
 
hw_∑øm_öãrvÆ


	)

90 
	$_¢d_pcm_hw_∑øm_™y
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_hw_∑øm_t
 
v¨
)

92 i‡(
	`hw_is_mask
(
v¨
)) {

93 
	`¢d_mask_™y
(
	`hw_∑øm_mask
(
∑øms
, 
v¨
));

94 
∑øms
->
cmask
 |1 << 
v¨
;

95 
∑øms
->
rmask
 |1 << 
v¨
;

98 i‡(
	`hw_is_öãrvÆ
(
v¨
)) {

99 
	`¢d_öãrvÆ_™y
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
v¨
));

100 
∑øms
->
cmask
 |1 << 
v¨
;

101 
∑øms
->
rmask
 |1 << 
v¨
;

104 
	`as£π
(0);

105 
	}
}

107 
	$¢d_pcm_hw_∑øm_™y
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

108 
¢d_pcm_hw_∑øm_t
 
v¨
)

110 
	`_¢d_pcm_hw_∑øm_™y
(
∑øms
, 
v¨
);

111  
	`¢d_pcm_hw_ªföe
(
pcm
, 
∑øms
);

112 
	}
}

114 
	$_¢d_pcm_hw_∑øms_™y
(
¢d_pcm_hw_∑øms_t
 *
∑øms
)

116 
k
;

117 
	`mem£t
(
∑øms
, 0, (*params));

118 
k
 = 
SND_PCM_HW_PARAM_FIRST_MASK
; k <
SND_PCM_HW_PARAM_LAST_MASK
; k++)

119 
	`_¢d_pcm_hw_∑øm_™y
(
∑øms
, 
k
);

120 
k
 = 
SND_PCM_HW_PARAM_FIRST_INTERVAL
; k <
SND_PCM_HW_PARAM_LAST_INTERVAL
; k++)

121 
	`_¢d_pcm_hw_∑øm_™y
(
∑øms
, 
k
);

122 
∑øms
->
rmask
 = ~0U;

123 
∑øms
->
cmask
 = 0;

124 
∑øms
->
öfo
 = ~0U;

125 
	}
}

130 
	$¢d_pcm_hw_∑øm_gë
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_hw_∑øm_t
 
v¨
,

131 *
vÆ
, *
dú
)

133 i‡(
	`hw_is_mask
(
v¨
)) {

134 c⁄° 
¢d_mask_t
 *
mask
 = 
	`hw_∑øm_mask_c
(
∑øms
, 
v¨
);

135 i‡(
	`¢d_mask_em±y
(
mask
Ë|| !
	`¢d_mask_sögÀ
(mask))

136  -
EINVAL
;

137 i‡(
dú
)

138 *
dú
 = 0;

139 i‡(
vÆ
)

140 *
vÆ
 = 
	`¢d_mask_vÆue
(
mask
);

142 } i‡(
	`hw_is_öãrvÆ
(
v¨
)) {

143 c⁄° 
¢d_öãrvÆ_t
 *
i
 = 
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
v¨
);

144 i‡(
	`¢d_öãrvÆ_em±y
(
i
Ë|| !
	`¢d_öãrvÆ_sögÀ
(i))

145  -
EINVAL
;

146 i‡(
dú
)

147 *
dú
 = 
i
->
›ímö
;

148 i‡(
vÆ
)

149 *
vÆ
 = 
	`¢d_öãrvÆ_vÆue
(
i
);

152 
	`as£π
(0);

153  -
EINVAL
;

154 
	}
}

157 
	$¢d_pcm_hw_∑øm_gë_mö
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_hw_∑øm_t
 
v¨
,

158 *
vÆ
, *
dú
)

160 i‡(
	`hw_is_mask
(
v¨
)) {

161 c⁄° 
¢d_mask_t
 *
m
 = 
	`hw_∑øm_mask_c
(
∑øms
, 
v¨
);

162 
	`as£π
(!
	`¢d_mask_em±y
(
m
));

163 i‡(
dú
)

164 *
dú
 = 0;

165 i‡(
vÆ
)

166 *
vÆ
 = 
	`¢d_mask_mö
(
m
);

168 } i‡(
	`hw_is_öãrvÆ
(
v¨
)) {

169 c⁄° 
¢d_öãrvÆ_t
 *
i
 = 
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
v¨
);

170 
	`as£π
(!
	`¢d_öãrvÆ_em±y
(
i
));

171 i‡(
dú
)

172 *
dú
 = 
i
->
›ímö
;

173 i‡(
vÆ
)

174 *
vÆ
 = 
	`¢d_öãrvÆ_mö
(
i
);

177 
	`as£π
(0);

179 
	}
}

182 
	$¢d_pcm_hw_∑øm_gë_max
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_hw_∑øm_t
 
v¨
,

183 *
vÆ
, *
dú
)

185 i‡(
	`hw_is_mask
(
v¨
)) {

186 c⁄° 
¢d_mask_t
 *
m
 = 
	`hw_∑øm_mask_c
(
∑øms
, 
v¨
);

187 
	`as£π
(!
	`¢d_mask_em±y
(
m
));

188 i‡(
dú
)

189 *
dú
 = 0;

190 i‡(
vÆ
)

191 *
vÆ
 = 
	`¢d_mask_max
(
m
);

193 } i‡(
	`hw_is_öãrvÆ
(
v¨
)) {

194 c⁄° 
¢d_öãrvÆ_t
 *
i
 = 
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
v¨
);

195 
	`as£π
(!
	`¢d_öãrvÆ_em±y
(
i
));

196 i‡(
dú
)

197 *
dú
 = - (Ë
i
->
›ímax
;

198 i‡(
vÆ
)

199 *
vÆ
 = 
	`¢d_öãrvÆ_max
(
i
);

202 
	`as£π
(0);

204 
	}
}

209 c⁄° 
¢d_mask_t
 *
	$¢d_pcm_hw_∑øm_gë_mask
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

210 
¢d_pcm_hw_∑øm_t
 
v¨
)

212 
	`as£π
(
	`hw_is_mask
(
v¨
));

213  
	`hw_∑øm_mask_c
(
∑øms
, 
v¨
);

214 
	}
}

219 c⁄° 
¢d_öãrvÆ_t
 *
	$¢d_pcm_hw_∑øm_gë_öãrvÆ
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

220 
¢d_pcm_hw_∑øm_t
 
v¨
)

222 
	`as£π
(
	`hw_is_öãrvÆ
(
v¨
));

223  
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
v¨
);

224 
	}
}

228 
	$_¢d_pcm_hw_∑øm_£t_öãrvÆ
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

229 
¢d_pcm_hw_∑øm_t
 
v¨
,

230 c⁄° 
¢d_öãrvÆ_t
 *
vÆ
)

232 
ch™ged
;

233 
	`as£π
(
	`hw_is_öãrvÆ
(
v¨
));

234 
ch™ged
 = 
	`¢d_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
v¨
), 
vÆ
);

235 i‡(
ch™ged
) {

236 
∑øms
->
cmask
 |1 << 
v¨
;

237 
∑øms
->
rmask
 |1 << 
v¨
;

239  
ch™ged
;

240 
	}
}

242 
	$_¢d_pcm_hw_∑øm_£t_em±y
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

243 
¢d_pcm_hw_∑øm_t
 
v¨
)

245 i‡(
	`hw_is_mask
(
v¨
)) {

246 
	`¢d_mask_n⁄e
(
	`hw_∑øm_mask
(
∑øms
, 
v¨
));

247 
∑øms
->
cmask
 |1 << 
v¨
;

248 
∑øms
->
rmask
 |1 << 
v¨
;

249 } i‡(
	`hw_is_öãrvÆ
(
v¨
)) {

250 
	`¢d_öãrvÆ_n⁄e
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
v¨
));

251 
∑øms
->
cmask
 |1 << 
v¨
;

252 
∑øms
->
rmask
 |1 << 
v¨
;

254 
	`as£π
(0);

256 
	}
}

258 
	$_¢d_pcm_hw_∑øm_£t_öãgî
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

259 
¢d_pcm_hw_∑øm_t
 
v¨
)

261 
ch™ged
;

262 
	`as£π
(
	`hw_is_öãrvÆ
(
v¨
));

263 
ch™ged
 = 
	`¢d_öãrvÆ_£töãgî
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
v¨
));

264 i‡(
ch™ged
) {

265 
∑øms
->
cmask
 |1 << 
v¨
;

266 
∑øms
->
rmask
 |1 << 
v¨
;

268  
ch™ged
;

269 
	}
}

275 
	$¢d_pcm_hw_∑øm_£t_öãgî
(
¢d_pcm_t
 *
pcm
,

276 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

277 
¢d_£t_mode_t
 
mode
,

278 
¢d_pcm_hw_∑øm_t
 
v¨
)

280 
¢d_pcm_hw_∑øms_t
 
ßve
;

281 
îr
;

282 
mode
) {

283 
SND_CHANGE
:

285 
SND_TRY
:

286 
ßve
 = *
∑øms
;

288 
SND_TEST
:

289 
ßve
 = *
∑øms
;

290 
∑øms
 = &
ßve
;

293 
	`as£π
(0);

294  -
EINVAL
;

296 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_öãgî
(
∑øms
, 
v¨
);

297 i‡(
îr
 < 0)

298 
_Áû
;

299 i‡(
∑øms
->
rmask
) {

300 
îr
 = 
	`¢d_pcm_hw_ªföe
(
pcm
, 
∑øms
);

301 i‡(
îr
 < 0)

302 
_Áû
;

305 
_Áû
:

306 i‡(
mode
 =
SND_TRY
)

307 *
∑øms
 = 
ßve
;

308  
îr
;

309 
	}
}

311 
	$_¢d_pcm_hw_∑øm_£t_fú°
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

312 
¢d_pcm_hw_∑øm_t
 
v¨
)

314 
ch™ged
;

315 i‡(
	`hw_is_mask
(
v¨
))

316 
ch™ged
 = 
	`¢d_mask_ªföe_fú°
(
	`hw_∑øm_mask
(
∑øms
, 
v¨
));

317 i‡(
	`hw_is_öãrvÆ
(
v¨
))

318 
ch™ged
 = 
	`¢d_öãrvÆ_ªföe_fú°
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
v¨
));

320 
	`as£π
(0);

321  -
EINVAL
;

323 i‡(
ch™ged
 > 0) {

324 
∑øms
->
cmask
 |1 << 
v¨
;

325 
∑øms
->
rmask
 |1 << 
v¨
;

327  
ch™ged
;

328 
	}
}

335 
	$¢d_pcm_hw_∑øm_£t_fú°
(
¢d_pcm_t
 *
pcm
,

336 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

337 
¢d_pcm_hw_∑øm_t
 
v¨
,

338 *
rvÆ
, *
dú
)

340 
îr
;

342 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_fú°
(
∑øms
, 
v¨
);

343 i‡(
îr
 < 0)

344  
îr
;

345 i‡(
∑øms
->
rmask
) {

346 
îr
 = 
	`¢d_pcm_hw_ªföe
(
pcm
, 
∑øms
);

347 i‡(
îr
 < 0)

348  
îr
;

350  
	`¢d_pcm_hw_∑øm_gë
(
∑øms
, 
v¨
, 
rvÆ
, 
dú
);

351 
	}
}

353 
	$_¢d_pcm_hw_∑øm_£t_œ°
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

354 
¢d_pcm_hw_∑øm_t
 
v¨
)

356 
ch™ged
;

357 i‡(
	`hw_is_mask
(
v¨
))

358 
ch™ged
 = 
	`¢d_mask_ªföe_œ°
(
	`hw_∑øm_mask
(
∑øms
, 
v¨
));

359 i‡(
	`hw_is_öãrvÆ
(
v¨
))

360 
ch™ged
 = 
	`¢d_öãrvÆ_ªföe_œ°
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
v¨
));

362 
	`as£π
(0);

363  -
EINVAL
;

365 i‡(
ch™ged
 > 0) {

366 
∑øms
->
cmask
 |1 << 
v¨
;

367 
∑øms
->
rmask
 |1 << 
v¨
;

369  
ch™ged
;

370 
	}
}

377 
	$¢d_pcm_hw_∑øm_£t_œ°
(
¢d_pcm_t
 *
pcm
,

378 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

379 
¢d_pcm_hw_∑øm_t
 
v¨
,

380 *
rvÆ
, *
dú
)

382 
îr
;

384 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_œ°
(
∑øms
, 
v¨
);

385 i‡(
îr
 < 0)

386  
îr
;

387 i‡(
∑øms
->
rmask
) {

388 
îr
 = 
	`¢d_pcm_hw_ªföe
(
pcm
, 
∑øms
);

389 i‡(
îr
 < 0)

390  
îr
;

392  
	`¢d_pcm_hw_∑øm_gë
(
∑øms
, 
v¨
, 
rvÆ
, 
dú
);

393 
	}
}

395 
	$_¢d_pcm_hw_∑øm_£t_mö
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

396 
¢d_pcm_hw_∑øm_t
 
v¨
, 
vÆ
, 
dú
)

398 
ch™ged
;

399 
›ímö
 = 0;

400 i‡(
dú
) {

401 i‡(
dú
 > 0) {

402 
›ímö
 = 1;

403 } i‡(
dú
 < 0) {

404 i‡(
vÆ
 > 0) {

405 
›ímö
 = 1;

406 
vÆ
--;

410 i‡(
	`hw_is_mask
(
v¨
))

411 
ch™ged
 = 
	`¢d_mask_ªföe_mö
(
	`hw_∑øm_mask
(
∑øms
, 
v¨
), 
vÆ
 + !!
›ímö
);

412 i‡(
	`hw_is_öãrvÆ
(
v¨
))

413 
ch™ged
 = 
	`¢d_öãrvÆ_ªföe_mö
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
v¨
), 
vÆ
, 
›ímö
);

415 
	`as£π
(0);

416  -
EINVAL
;

418 i‡(
ch™ged
) {

419 
∑øms
->
cmask
 |1 << 
v¨
;

420 
∑øms
->
rmask
 |1 << 
v¨
;

422  
ch™ged
;

423 
	}
}

429 
	$¢d_pcm_hw_∑øm_£t_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

430 
¢d_£t_mode_t
 
mode
,

431 
¢d_pcm_hw_∑øm_t
 
v¨
, *
vÆ
, *
dú
)

433 
¢d_pcm_hw_∑øms_t
 
ßve
;

434 
îr
;

435 
mode
) {

436 
SND_CHANGE
:

438 
SND_TRY
:

439 
ßve
 = *
∑øms
;

441 
SND_TEST
:

442 
ßve
 = *
∑øms
;

443 
∑øms
 = &
ßve
;

446 
	`as£π
(0);

447  -
EINVAL
;

449 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mö
(
∑øms
, 
v¨
, *
vÆ
, 
dú
 ? *dir : 0);

450 i‡(
îr
 < 0)

451 
_Áû
;

452 i‡((
mode
 !
SND_TEST
 || 
	`hw_is_öãrvÆ
(
v¨
)Ë&& 
∑øms
->
rmask
) {

453 
îr
 = 
	`¢d_pcm_hw_ªföe
(
pcm
, 
∑øms
);

454 i‡(
îr
 < 0)

455 
_Áû
;

456 i‡(
	`¢d_pcm_hw_∑øm_em±y
(
∑øms
, 
v¨
)) {

457 
îr
 = -
ENOENT
;

458 
_Áû
;

461  
	`¢d_pcm_hw_∑øm_gë_mö
(
∑øms
, 
v¨
, 
vÆ
, 
dú
);

462 
_Áû
:

463 i‡(
mode
 =
SND_TRY
)

464 *
∑øms
 = 
ßve
;

465 i‡(
îr
 < 0 && 
mode
 =
SND_TRY
)

466 
	`dump_hw_∑øms
(
∑øms
, "£t_mö", 
v¨
, *
vÆ
, 
îr
);

467  
îr
;

468 
	}
}

470 
	$_¢d_pcm_hw_∑øm_£t_max
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

471 
¢d_pcm_hw_∑øm_t
 
v¨
, 
vÆ
, 
dú
)

473 
ch™ged
;

474 
›ímax
 = 0;

475 i‡(
dú
) {

476 i‡(
dú
 < 0) {

477 
›ímax
 = 1;

478 } i‡(
dú
 > 0) {

479 
›ímax
 = 1;

480 
vÆ
++;

483 i‡(
	`hw_is_mask
(
v¨
)) {

484 i‡(
vÆ
 =0 && 
›ímax
) {

485 
	`¢d_mask_n⁄e
(
	`hw_∑øm_mask
(
∑øms
, 
v¨
));

486 
ch™ged
 = -
EINVAL
;

488 
ch™ged
 = 
	`¢d_mask_ªföe_max
(
	`hw_∑øm_mask
(
∑øms
, 
v¨
), 
vÆ
 - !!
›ímax
);

489 } i‡(
	`hw_is_öãrvÆ
(
v¨
))

490 
ch™ged
 = 
	`¢d_öãrvÆ_ªföe_max
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
v¨
), 
vÆ
, 
›ímax
);

492 
	`as£π
(0);

493  -
EINVAL
;

495 i‡(
ch™ged
) {

496 
∑øms
->
cmask
 |1 << 
v¨
;

497 
∑øms
->
rmask
 |1 << 
v¨
;

499  
ch™ged
;

500 
	}
}

506 
	$¢d_pcm_hw_∑øm_£t_max
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

507 
¢d_£t_mode_t
 
mode
,

508 
¢d_pcm_hw_∑øm_t
 
v¨
, *
vÆ
, *
dú
)

510 
¢d_pcm_hw_∑øms_t
 
ßve
;

511 
îr
;

512 
mode
) {

513 
SND_CHANGE
:

515 
SND_TRY
:

516 
ßve
 = *
∑øms
;

518 
SND_TEST
:

519 
ßve
 = *
∑øms
;

520 
∑øms
 = &
ßve
;

523 
	`as£π
(0);

524  -
EINVAL
;

526 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_max
(
∑øms
, 
v¨
, *
vÆ
, 
dú
 ? *dir : 0);

527 i‡(
îr
 < 0)

528 
_Áû
;

529 i‡((
mode
 !
SND_TEST
 || 
	`hw_is_öãrvÆ
(
v¨
)Ë&& 
∑øms
->
rmask
) {

530 
îr
 = 
	`¢d_pcm_hw_ªföe
(
pcm
, 
∑øms
);

531 i‡(
îr
 < 0)

532 
_Áû
;

533 i‡(
	`¢d_pcm_hw_∑øm_em±y
(
∑øms
, 
v¨
)) {

534 
îr
 = -
ENOENT
;

535 
_Áû
;

538  
	`¢d_pcm_hw_∑øm_gë_max
(
∑øms
, 
v¨
, 
vÆ
, 
dú
);

539 
_Áû
:

540 i‡(
mode
 =
SND_TRY
)

541 *
∑øms
 = 
ßve
;

542 i‡(
îr
 < 0 && 
mode
 =
SND_TRY
)

543 
	`dump_hw_∑øms
(
∑øms
, "£t_max", 
v¨
, *
vÆ
, 
îr
);

544  
îr
;

545 
	}
}

547 
	$_¢d_pcm_hw_∑øm_£t_mömax
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

548 
¢d_pcm_hw_∑øm_t
 
v¨
,

549 
mö
, 
mödú
,

550 
max
, 
maxdú
)

552 
ch™ged
, 
c1
, 
c2
;

553 
›ímö
 = 0, 
›ímax
 = 0;

554 i‡(
mödú
) {

555 i‡(
mödú
 > 0) {

556 
›ímö
 = 1;

557 } i‡(
mödú
 < 0) {

558 i‡(
mö
 > 0) {

559 
›ímö
 = 1;

560 
mö
--;

564 i‡(
maxdú
) {

565 i‡(
maxdú
 < 0) {

566 
›ímax
 = 1;

567 } i‡(
maxdú
 > 0) {

568 
›ímax
 = 1;

569 
max
++;

572 i‡(
	`hw_is_mask
(
v¨
)) {

573 
¢d_mask_t
 *
mask
 = 
	`hw_∑øm_mask
(
∑øms
, 
v¨
);

574 i‡(
max
 =0 && 
›ímax
) {

575 
	`¢d_mask_n⁄e
(
mask
);

576 
ch™ged
 = -
EINVAL
;

578 
c1
 = 
	`¢d_mask_ªföe_mö
(
mask
, 
mö
 + !!
›ímö
);

579 i‡(
c1
 < 0)

580 
ch™ged
 = 
c1
;

582 
c2
 = 
	`¢d_mask_ªföe_max
(
mask
, 
max
 - !!
›ímax
);

583 i‡(
c2
 < 0)

584 
ch™ged
 = 
c2
;

586 
ch™ged
 = (
c1
 || 
c2
);

590 i‡(
	`hw_is_öãrvÆ
(
v¨
)) {

591 
¢d_öãrvÆ_t
 *
i
 = 
	`hw_∑øm_öãrvÆ
(
∑øms
, 
v¨
);

592 
c1
 = 
	`¢d_öãrvÆ_ªföe_mö
(
i
, 
mö
, 
›ímö
);

593 i‡(
c1
 < 0)

594 
ch™ged
 = 
c1
;

596 
c2
 = 
	`¢d_öãrvÆ_ªföe_max
(
i
, 
max
, 
›ímax
);

597 i‡(
c2
 < 0)

598 
ch™ged
 = 
c2
;

600 
ch™ged
 = (
c1
 || 
c2
);

603 
	`as£π
(0);

604  -
EINVAL
;

606 i‡(
ch™ged
) {

607 
∑øms
->
cmask
 |1 << 
v¨
;

608 
∑øms
->
rmask
 |1 << 
v¨
;

610  
ch™ged
;

611 
	}
}

617 
	$¢d_pcm_hw_∑øm_£t_mömax
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

618 
¢d_£t_mode_t
 
mode
,

619 
¢d_pcm_hw_∑øm_t
 
v¨
,

620 *
mö
, *
mödú
,

621 *
max
, *
maxdú
)

623 
¢d_pcm_hw_∑øms_t
 
ßve
;

624 
îr
;

625 
mode
) {

626 
SND_CHANGE
:

628 
SND_TRY
:

629 
ßve
 = *
∑øms
;

631 
SND_TEST
:

632 
ßve
 = *
∑øms
;

633 
∑øms
 = &
ßve
;

636 
	`as£π
(0);

637  -
EINVAL
;

639 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mömax
(
∑øms
, 
v¨
,

640 *
mö
, 
mödú
 ? *mindir : 0,

641 *
max
, 
maxdú
 ? *maxdir : 0);

642 i‡(
îr
 < 0)

643 
_Áû
;

644 i‡((
mode
 !
SND_TEST
 || 
	`hw_is_öãrvÆ
(
v¨
)Ë&& 
∑øms
->
rmask
) {

645 
îr
 = 
	`¢d_pcm_hw_ªföe
(
pcm
, 
∑øms
);

646 i‡(
îr
 < 0)

647 
_Áû
;

649 
îr
 = 
	`¢d_pcm_hw_∑øm_gë_mö
(
∑øms
, 
v¨
, 
mö
, 
mödú
);

650 i‡(
îr
 < 0)

651  
îr
;

652  
	`¢d_pcm_hw_∑øm_gë_max
(
∑øms
, 
v¨
, 
max
, 
maxdú
);

653 
_Áû
:

654 i‡(
mode
 =
SND_TRY
)

655 *
∑øms
 = 
ßve
;

656 i‡(
îr
 < 0)

657 
	`dump_hw_∑øms
(
∑øms
, "£t_mömax", 
v¨
, *
mö
, 
îr
);

658  
îr
;

659 
	}
}

661 
	$_¢d_pcm_hw_∑øm_£t
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

662 
¢d_pcm_hw_∑øm_t
 
v¨
, 
vÆ
, 
dú
)

664 
ch™ged
;

665 i‡(
	`hw_is_mask
(
v¨
)) {

666 
¢d_mask_t
 *
m
 = 
	`hw_∑øm_mask
(
∑øms
, 
v¨
);

667 i‡(
vÆ
 =0 && 
dú
 < 0) {

668 
ch™ged
 = -
EINVAL
;

669 
	`¢d_mask_n⁄e
(
m
);

671 i‡(
dú
 > 0)

672 
vÆ
++;

673 i‡(
dú
 < 0)

674 
vÆ
--;

675 
ch™ged
 = 
	`¢d_mask_ªföe_£t
(
	`hw_∑øm_mask
(
∑øms
, 
v¨
), 
vÆ
);

677 } i‡(
	`hw_is_öãrvÆ
(
v¨
)) {

678 
¢d_öãrvÆ_t
 *
i
 = 
	`hw_∑øm_öãrvÆ
(
∑øms
, 
v¨
);

679 i‡(
vÆ
 =0 && 
dú
 < 0) {

680 
ch™ged
 = -
EINVAL
;

681 
	`¢d_öãrvÆ_n⁄e
(
i
);

682 } i‡(
dú
 == 0)

683 
ch™ged
 = 
	`¢d_öãrvÆ_ªföe_£t
(
i
, 
vÆ
);

685 
¢d_öãrvÆ_t
 
t
;

686 
t
.
›ímö
 = 1;

687 
t
.
›ímax
 = 1;

688 
t
.
em±y
 = 0;

689 
t
.
öãgî
 = 0;

690 i‡(
dú
 < 0) {

691 
t
.
mö
 = 
vÆ
 - 1;

692 
t
.
max
 = 
vÆ
;

694 
t
.
mö
 = 
vÆ
;

695 
t
.
max
 = 
vÆ
+1;

697 
ch™ged
 = 
	`¢d_öãrvÆ_ªföe
(
i
, &
t
);

700 
	`as£π
(0);

701  -
EINVAL
;

703 i‡(
ch™ged
) {

704 
∑øms
->
cmask
 |1 << 
v¨
;

705 
∑øms
->
rmask
 |1 << 
v¨
;

707  
ch™ged
;

708 
	}
}

714 
	$¢d_pcm_hw_∑øm_£t
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

715 
¢d_£t_mode_t
 
mode
,

716 
¢d_pcm_hw_∑øm_t
 
v¨
, 
vÆ
, 
dú
)

718 
¢d_pcm_hw_∑øms_t
 
ßve
;

719 
îr
;

720 
mode
) {

721 
SND_CHANGE
:

723 
SND_TRY
:

724 
ßve
 = *
∑øms
;

726 
SND_TEST
:

727 
ßve
 = *
∑øms
;

728 
∑øms
 = &
ßve
;

731 
	`as£π
(0);

732  -
EINVAL
;

734 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t
(
∑øms
, 
v¨
, 
vÆ
, 
dú
);

735 i‡(
îr
 < 0)

736 
_Áû
;

737 i‡((
mode
 !
SND_TEST
 || 
	`hw_is_öãrvÆ
(
v¨
)Ë&& 
∑øms
->
rmask
) {

738 
îr
 = 
	`¢d_pcm_hw_ªföe
(
pcm
, 
∑øms
);

739 i‡(
îr
 < 0)

740 
_Áû
;

743 
_Áû
:

744 i‡(
mode
 =
SND_TRY
)

745 *
∑øms
 = 
ßve
;

746 i‡(
îr
 < 0 && 
mode
 =
SND_TRY
)

747 
	`dump_hw_∑øms
(
∑øms
, "£t", 
v¨
, 
vÆ
, 
îr
);

748  
îr
;

749 
	}
}

751 
	$_¢d_pcm_hw_∑øm_£t_mask
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

752 
¢d_pcm_hw_∑øm_t
 
v¨
, c⁄° 
¢d_mask_t
 *
vÆ
)

754 
ch™ged
;

755 
	`as£π
(
	`hw_is_mask
(
v¨
));

756 
ch™ged
 = 
	`¢d_mask_ªföe
(
	`hw_∑øm_mask
(
∑øms
, 
v¨
), 
vÆ
);

757 i‡(
ch™ged
) {

758 
∑øms
->
cmask
 |1 << 
v¨
;

759 
∑øms
->
rmask
 |1 << 
v¨
;

761  
ch™ged
;

762 
	}
}

771 
	$¢d_pcm_hw_∑øm_£t_mask
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

772 
¢d_£t_mode_t
 
mode
,

773 
¢d_pcm_hw_∑øm_t
 
v¨
, c⁄° 
¢d_mask_t
 *
vÆ
)

775 
¢d_pcm_hw_∑øms_t
 
ßve
;

776 
îr
;

777 
mode
) {

778 
SND_CHANGE
:

780 
SND_TRY
:

781 
ßve
 = *
∑øms
;

783 
SND_TEST
:

784 
ßve
 = *
∑øms
;

785 
∑øms
 = &
ßve
;

788 
	`as£π
(0);

789  -
EINVAL
;

791 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
v¨
, 
vÆ
);

792 i‡(
îr
 < 0)

793 
_Áû
;

794 i‡(
mode
 !
SND_TEST
 && 
∑øms
->
rmask
) {

795 
îr
 = 
	`¢d_pcm_hw_ªföe
(
pcm
, 
∑øms
);

796 i‡(
îr
 < 0)

797 
_Áû
;

800 
_Áû
:

801 i‡(
mode
 =
SND_TRY
)

802 *
∑øms
 = 
ßve
;

803  
îr
;

804 
	}
}

812 
	$¢d_pcm_hw_∑øm_£t_√¨
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

813 
¢d_pcm_hw_∑øm_t
 
v¨
,

814 *
vÆ
, *
dú
)

816 
¢d_pcm_hw_∑øms_t
 
ßve
;

817 
îr
;

818 
be°
 = *
vÆ
, 
ßved_mö
;

819 
œ°
 = 0;

820 
mö
, 
max
;

821 
mödú
, 
maxdú
;

822 
vÆdú
 = 
dú
 ? *dir : 0;

823 
¢d_öãrvÆ_t
 *
i
;

825 i‡(
be°
 > 
INT_MAX
)

826 
be°
 = 
INT_MAX
;

827 
mö
 = 
max
 = 
be°
;

828 
mödú
 = 
maxdú
 = 
vÆdú
;

829 i‡(
maxdú
 > 0)

830 
maxdú
 = 0;

831 i‡(
maxdú
 == 0)

832 
maxdú
 = -1;

834 
maxdú
 = 1;

835 
max
--;

837 
ßve
 = *
∑øms
;

838 
ßved_mö
 = 
mö
;

839 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_mö
(
pcm
, 
∑øms
, 
SND_CHANGE
, 
v¨
, &
mö
, &
mödú
);

841 
i
 = 
	`hw_∑øm_öãrvÆ
(
∑øms
, 
v¨
);

842 i‡(!
	`¢d_öãrvÆ_em±y
(
i
Ë&& 
	`¢d_öãrvÆ_sögÀ
(i)) {

843 
îr
 = 
	`¢d_pcm_hw_∑øm_gë_mö
(
∑øms
, 
v¨
, 
vÆ
, 
dú
);

844 i‡(
îr
 < 0)

845 
	`dump_hw_∑øms
(
∑øms
, "£t_√¨", 
v¨
, *
vÆ
, 
îr
);

846  
îr
;

849 i‡(
îr
 >= 0) {

850 
¢d_pcm_hw_∑øms_t
 
∑øms1
;

851 i‡(
mö
 =
ßved_mö
 && 
mödú
 =
vÆdú
)

852 
_íd
;

853 
∑øms1
 = 
ßve
;

854 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_max
(
pcm
, &
∑øms1
, 
SND_CHANGE
, 
v¨
, &
max
, &
maxdú
);

855 i‡(
îr
 < 0)

856 
_íd
;

857 i‡(
	`bound¨y_√¨î
(
max
, 
maxdú
, 
be°
, 
vÆdú
, 
mö
, 
mödú
)) {

858 *
∑øms
 = 
∑øms1
;

859 
œ°
 = 1;

862 *
∑øms
 = 
ßve
;

863 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_max
(
pcm
, 
∑øms
, 
SND_CHANGE
, 
v¨
, &
max
, &
maxdú
);

864 i‡(
îr
 < 0) {

865 
	`dump_hw_∑øms
(
∑øms
, "£t_√¨", 
v¨
, *
vÆ
, 
îr
);

866  
îr
;

868 
œ°
 = 1;

870 
_íd
:

871 i‡(
œ°
)

872 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_œ°
(
pcm
, 
∑øms
, 
v¨
, 
vÆ
, 
dú
);

874 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
v¨
, 
vÆ
, 
dú
);

875 i‡(
îr
 < 0)

876 
	`dump_hw_∑øms
(
∑øms
, "£t_√¨", 
v¨
, *
vÆ
, 
îr
);

877  
îr
;

878 
	}
}

889 
	$¢d_pcm_hw_∑øm_£t_√xt
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

890 
¢d_pcm_hw_∑øm_t
 
v¨
,

891 
be°
, 
be°dú
,

892 
vÆ
, *
dú
)

894 
¢d_pcm_hw_∑øms_t
 
ßve
;

895 
v
, 
îr
;

896 
œ°
 = 0;

897 
mö
, 
max
;

898 
mödú
, 
maxdú
;

899 
diff
, 
diffdú
;

900 
vÆdú
 = 
dú
 ? *dir : 0;

902 i‡(
be°
 > 
INT_MAX
)

903 
be°
 = 
INT_MAX
;

904 
	`bound¨y_sub
(
vÆ
, 
vÆdú
, 
be°
, 
be°dú
, &
diff
, &
diffdú
);

905 i‡(
diff
 < 0 || (dif‡=0 && 
diffdú
 < 0)) {

906 
mö
 = 
be°
 - 
diff
;

907 
mödú
 = 
be°dú
 - 
diffdú
;

908 
max
 = 
vÆ
;

909 
maxdú
 = 
be°dú
 - 1;

911 
mö
 = 
vÆ
;

912 
mödú
 = 
be°dú
 + 1;

913 
max
 = 
be°
 + 
diff
;

914 
maxdú
 = 
be°dú
 + 
diffdú
 + 1;

916 
mö
 +
mödú
 / 2;

917 
mödú
 %= 2;

918 
max
 +
maxdú
 / 2;

919 
maxdú
 %= 2;

920 
ßve
 = *
∑øms
;

921 i‡(
mö
 >= 0 &&

922 (
îr
 = 
	`¢d_pcm_hw_∑øm_£t_mö
(
pcm
, 
∑øms
, 
SND_CHANGE
, 
v¨
, &
mö
, &
mödú
)) >= 0) {

923 
¢d_pcm_hw_∑øms_t
 
∑øms1
;

924 i‡(
max
 < 0)

925 
_íd
;

926 
∑øms1
 = 
ßve
;

927 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_max
(
pcm
, &
∑øms1
, 
SND_CHANGE
, 
v¨
, &
max
, &
maxdú
);

928 i‡(
îr
 < 0)

929 
_íd
;

930 i‡(
	`bound¨y_√¨î
(
max
, 
maxdú
, 
be°
, 
be°dú
, 
mö
, 
mödú
)) {

931 *
∑øms
 = 
∑øms1
;

932 
œ°
 = 1;

935 i‡(
max
 < 0)

936  -
EINVAL
;

937 *
∑øms
 = 
ßve
;

938 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_max
(
pcm
, 
∑øms
, 
SND_CHANGE
, 
v¨
, &
max
, &
maxdú
);

939 i‡(
îr
 < 0)

940  
max
;

941 
œ°
 = 1;

943 
_íd
:

944 i‡(
œ°
)

945 
v
 = 
	`¢d_pcm_hw_∑øm_£t_œ°
(
pcm
, 
∑øms
, 
v¨
, 
dú
);

947 
v
 = 
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
v¨
, 
dú
);

948 
	`as£π
(
v
 >= 0);

949  
v
;

950 
	}
}

953 
	$¢d_pcm_hw_∑øm_£t_√¨_mömax
(
¢d_pcm_t
 *
pcm
,

954 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

955 
¢d_pcm_hw_∑øm_t
 
v¨
,

956 
mö
, *
mödú
,

957 
max
, *
maxdú
)

959 
¢d_pcm_hw_∑øms_t
 
tmp
;

960 
îr
;

961 i‡(!
	`bound¨y_…
(
mö
, *
mödú
, 
max
, *
maxdú
))

962  
	`¢d_pcm_hw_∑øm_£t_√¨
(
pcm
, 
∑øms
, 
v¨
, &
mö
, 
mödú
);

963 
tmp
 = *
∑øms
;

964 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_√¨
(
pcm
, &
tmp
, 
v¨
, &
mö
, 
mödú
);

965 i‡(
îr
 < 0)

966  
îr
;

967 i‡(
	`bound¨y_…
(
mö
, *
mödú
, 
max
, *
maxdú
)) {

968 
tmp
 = *
∑øms
;

969 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_√¨
(
pcm
, &
tmp
, 
v¨
, &
max
, 
maxdú
);

971 
max
 = 
mö
;

972 *
maxdú
 = *
mödú
;

974 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_mömax
(
pcm
, 
∑øms
, 
SND_CHANGE
, 
v¨
, &
mö
, 
mödú
,

975 &
max
, 
maxdú
);

976 i‡(
îr
 < 0)

977  
îr
;

979 
	}
}

981 
	$¢d_pcm_hw_∑øm_ªföe_√¨
(
¢d_pcm_t
 *
pcm
,

982 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

983 
¢d_pcm_hw_∑øm_t
 
v¨
,

984 c⁄° 
¢d_pcm_hw_∑øms_t
 *
§c
)

986 
mö
, 
max
;

987 
mödú
, 
maxdú
, 
îr
;

989 i‡((
îr
 = 
	`¢d_pcm_hw_∑øm_gë_mö
(
§c
, 
v¨
, &
mö
, &
mödú
)) < 0)

990  
îr
;

991 i‡((
îr
 = 
	`¢d_pcm_hw_∑øm_gë_max
(
§c
, 
v¨
, &
max
, &
maxdú
)) < 0)

992  
îr
;

993 i‡((
îr
 = 
	`¢d_pcm_hw_∑øm_£t_√¨_mömax
(
pcm
, 
∑øms
, 
v¨
,

994 
mö
, &
mödú
, 
max
, &
maxdú
)) < 0)

995  
îr
;

997 
	}
}

999 
	$¢d_pcm_hw_∑øm_ªföe_mu…ùÀ
(
¢d_pcm_t
 *
pcm
,

1000 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1001 
¢d_pcm_hw_∑øm_t
 
v¨
,

1002 c⁄° 
¢d_pcm_hw_∑øms_t
 *
§c
)

1004 c⁄° 
¢d_öãrvÆ_t
 *
ô
 = 
	`hw_∑øm_öãrvÆ_c
(
§c
, 
v¨
);

1005 c⁄° 
¢d_öãrvÆ_t
 *
°
 = 
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
v¨
);

1006 i‡(
	`¢d_öãrvÆ_sögÀ
(
ô
)) {

1007 
be°
 = 
	`¢d_öãrvÆ_mö
(
ô
), 
cur
, 
¥ev
;

1008 
cur
 = 
be°
;

1010 i‡(
°
->
max
 < 
cur
 || (°->max =cu∏&& st->
›ímax
))

1012 i‡(
ô
->
mö
 <
cur
 && ! (ô->mö =cu∏&& 
°
->
›ímö
)) {

1013 i‡(! 
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TRY
, 
v¨
, 
cur
, 0))

1016 
¥ev
 = 
cur
;

1017 
cur
 +
be°
;

1018 i‡(
cur
 <
¥ev
)

1022  
	`¢d_pcm_hw_∑øm_ªföe_√¨
(
pcm
, 
∑øms
, 
v¨
, 
§c
);

1023 
	}
}

1027 
	$¢d_pcm_hw_∑øm_em±y
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1028 
¢d_pcm_hw_∑øm_t
 
v¨
)

1030 i‡(
	`hw_is_mask
(
v¨
))

1031  
	`¢d_mask_em±y
(
	`hw_∑øm_mask_c
(
∑øms
, 
v¨
));

1032 i‡(
	`hw_is_öãrvÆ
(
v¨
))

1033  
	`¢d_öãrvÆ_em±y
(
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
v¨
));

1034 
	`as£π
(0);

1035  -
EINVAL
;

1036 
	}
}

1038 
	$¢d_pcm_hw_∑øm_Æways_eq
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1039 
¢d_pcm_hw_∑øm_t
 
v¨
,

1040 c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms1
)

1042 i‡(
	`hw_is_mask
(
v¨
))

1043  
	`¢d_mask_Æways_eq
(
	`hw_∑øm_mask_c
(
∑øms
, 
v¨
),

1044 
	`hw_∑øm_mask_c
(
∑øms1
, 
v¨
));

1045 i‡(
	`hw_is_öãrvÆ
(
v¨
))

1046  
	`¢d_öãrvÆ_Æways_eq
(
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
v¨
),

1047 
	`hw_∑øm_öãrvÆ_c
(
∑øms1
, 
v¨
));

1048 
	`as£π
(0);

1049  -
EINVAL
;

1050 
	}
}

1052 
	$¢d_pcm_hw_∑øm_√vî_eq
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1053 
¢d_pcm_hw_∑øm_t
 
v¨
,

1054 c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms1
)

1056 i‡(
	`hw_is_mask
(
v¨
))

1057  
	`¢d_mask_√vî_eq
(
	`hw_∑øm_mask_c
(
∑øms
, 
v¨
),

1058 
	`hw_∑øm_mask_c
(
∑øms1
, 
v¨
));

1059 i‡(
	`hw_is_öãrvÆ
(
v¨
))

1060  
	`¢d_öãrvÆ_√vî_eq
(
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
v¨
),

1061 
	`hw_∑øm_öãrvÆ_c
(
∑øms1
, 
v¨
));

1062 
	`as£π
(0);

1063  -
EINVAL
;

1064 
	}
}

1067 
	#CHOOSE_DEBUG


	)

1081 
	$¢d_pcm_hw_∑øms_choo£
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

1083 
îr
;

1084 #ifde‡
CHOOSE_DEBUG


1085 
¢d_ouçut_t
 *
log
;

1086 
	`¢d_ouçut_°dio_©èch
(&
log
, 
°dîr
, 0);

1087 
	`¢d_ouçut_¥ötf
(
log
, "CHOOSE called:\n");

1088 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
log
);

1091 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
, 
NULL
, 0);

1092 i‡(
îr
 < 0)

1093  
îr
;

1094 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
, 
NULL
, 0);

1095 i‡(
îr
 < 0)

1096  
îr
;

1097 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_SUBFORMAT
, 
NULL
, 0);

1098 i‡(
îr
 < 0)

1099  
îr
;

1100 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
, 
NULL
, 0);

1101 i‡(
îr
 < 0)

1102  
îr
;

1103 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_RATE
, 
NULL
, 0);

1104 i‡(
îr
 < 0)

1105  
îr
;

1106 i‡(
pcm
->
mö≥riodtime
 > 0) {

1107 
mö
, 
max
;

1108 
dú
 = 1;

1109 
îr
 = 
	`¢d_pcm_hw_∑øm_gë_mö
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, &
mö
, &
dú
);

1110 i‡(
îr
 >= 0)

1111 
îr
 = 
	`¢d_pcm_hw_∑øm_gë_max
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, &
max
, &
dú
);

1112 i‡(
îr
 >0 && ()
mö
 < 
pcm
->
mö≥riodtime
 &&

1113 ()
max
 > 
pcm
->
mö≥riodtime
) {

1114 
mö
 = 
pcm
->
mö≥riodtime
; 
dú
 = 1;

1115 
	`¢d_pcm_hw_∑øm_£t_mö
(
pcm
, 
∑øms
, 
SND_CHANGE
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, &
mö
, &
dú
);

1118 i‡(
pcm
->
com∑t
) {

1120 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
NULL
, 0);

1121 i‡(
îr
 < 0)

1122  
îr
;

1123 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 
NULL
, 0);

1124 i‡(
îr
 < 0)

1125  
îr
;

1126 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_œ°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, 
NULL
, 0);

1127 i‡(
îr
 < 0)

1128  
îr
;

1131 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_œ°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, 
NULL
, 0);

1132 i‡(
îr
 < 0)

1133  
îr
;

1134 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
, 
NULL
, 0);

1135 i‡(
îr
 < 0)

1136  
îr
;

1137 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
, 
NULL
, 0);

1138 i‡(
îr
 < 0)

1139  
îr
;

1141 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_fú°
(
pcm
, 
∑øms
, 
SND_PCM_HW_PARAM_TICK_TIME
, 
NULL
, 0);

1142 i‡(
îr
 < 0)

1143  
îr
;

1144 #ifde‡
CHOOSE_DEBUG


1145 
	`¢d_ouçut_¥ötf
(
log
, "choose done\n");

1146 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
log
);

1147 
	`¢d_ouçut_˛o£
(
log
);

1150 
	}
}

1153 
	$¢d_pcm_hw_∑øm_cou¡
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1154 
¢d_pcm_hw_∑øm_t
 
v¨
)

1156 i‡(
	`hw_is_mask
(
v¨
)) {

1157 c⁄° 
¢d_mask_t
 *
mask
 = 
	`hw_∑øm_mask_c
(
∑øms
, 
v¨
);

1158  
	`¢d_mask_cou¡
(
mask
);

1160 i‡(
	`hw_is_öãrvÆ
(
v¨
)) {

1161 c⁄° 
¢d_öãrvÆ_t
 *
i
 = 
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
v¨
);

1162  
	`¢d_öãrvÆ_max
(
i
Ë- 
	`¢d_öãrvÆ_mö
(i) + 1;

1164 
	`as£π
(0);

1166 
	}
}

1169 
	$_¢d_pcm_hw_∑øm_ªföe
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1170 
¢d_pcm_hw_∑øm_t
 
v¨
,

1171 c⁄° 
¢d_pcm_hw_∑øms_t
 *
§c
)

1173 
ch™ged
 = 0;

1174 i‡(
	`hw_is_mask
(
v¨
)) {

1175 
¢d_mask_t
 *
d
 = 
	`hw_∑øm_mask
(
∑øms
, 
v¨
);

1176 c⁄° 
¢d_mask_t
 *
s
 = 
	`hw_∑øm_mask_c
(
§c
, 
v¨
);

1177 
ch™ged
 = 
	`¢d_mask_ªföe
(
d
, 
s
);

1178 } i‡(
	`hw_is_öãrvÆ
(
v¨
)) {

1179 
¢d_öãrvÆ_t
 *
d
 = 
	`hw_∑øm_öãrvÆ
(
∑øms
, 
v¨
);

1180 c⁄° 
¢d_öãrvÆ_t
 *
s
 = 
	`hw_∑øm_öãrvÆ_c
(
§c
, 
v¨
);

1181 
ch™ged
 = 
	`¢d_öãrvÆ_ªföe
(
d
, 
s
);

1184 i‡(
ch™ged
) {

1185 
∑øms
->
cmask
 |1 << 
v¨
;

1186 
∑øms
->
rmask
 |1 << 
v¨
;

1188  
ch™ged
;

1189 
	}
}

1192 
	$_¢d_pcm_hw_∑øm_c›y
(
¢d_pcm_hw_∑øms_t
 *
∑øms
, 
¢d_pcm_hw_∑øm_t
 
v¨
,

1193 c⁄° 
¢d_pcm_hw_∑øms_t
 *
§c
)

1195 i‡(
	`hw_is_mask
(
v¨
)) {

1196 
¢d_mask_t
 *
d
 = 
	`hw_∑øm_mask
(
∑øms
, 
v¨
);

1197 c⁄° 
¢d_mask_t
 *
s
 = 
	`hw_∑øm_mask_c
(
§c
, 
v¨
);

1198 
	`¢d_mask_c›y
(
d
, 
s
);

1199 
∑øms
->
cmask
 |1 << 
v¨
;

1200 
∑øms
->
rmask
 |1 << 
v¨
;

1203 i‡(
	`hw_is_öãrvÆ
(
v¨
)) {

1204 
¢d_öãrvÆ_t
 *
d
 = 
	`hw_∑øm_öãrvÆ
(
∑øms
, 
v¨
);

1205 c⁄° 
¢d_öãrvÆ_t
 *
s
 = 
	`hw_∑øm_öãrvÆ_c
(
§c
, 
v¨
);

1206 
	`¢d_öãrvÆ_c›y
(
d
, 
s
);

1207 
∑øms
->
cmask
 |1 << 
v¨
;

1208 
∑øms
->
rmask
 |1 << 
v¨
;

1211 
	`as£π
(0);

1212 
	}
}

1215 
	$¢d_pcm_hw_∑øm_dump
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1216 
¢d_pcm_hw_∑øm_t
 
v¨
, 
¢d_ouçut_t
 *
out
)

1218 i‡(
	`hw_is_mask
(
v¨
)) {

1219 c⁄° 
¢d_mask_t
 *
mask
 = 
	`hw_∑øm_mask_c
(
∑øms
, 
v¨
);

1220 i‡(
	`¢d_mask_em±y
(
mask
))

1221 
	`¢d_ouçut_puts
(
out
, " NONE");

1222 i‡(
	`¢d_mask_fuŒ
(
mask
))

1223 
	`¢d_ouçut_puts
(
out
, " ALL");

1225 
k
;

1226 
k
 = 0; k <
SND_MASK_MAX
; ++k) {

1227 i‡(
	`¢d_mask_ã°
(
mask
, 
k
)) {

1228 c⁄° *
s
;

1229 
v¨
) {

1230 
SND_PCM_HW_PARAM_ACCESS
:

1231 
s
 = 
	`¢d_pcm_ac˚ss_«me
(
k
);

1233 
SND_PCM_HW_PARAM_FORMAT
:

1234 
s
 = 
	`¢d_pcm_f‹m©_«me
(
k
);

1236 
SND_PCM_HW_PARAM_SUBFORMAT
:

1237 
s
 = 
	`¢d_pcm_subf‹m©_«me
(
k
);

1240 
	`as£π
(0);

1241 
s
 = 
NULL
;

1243 i‡(
s
) {

1244 
	`¢d_ouçut_putc
(
out
, ' ');

1245 
	`¢d_ouçut_puts
(
out
, 
s
);

1252 i‡(
	`hw_is_öãrvÆ
(
v¨
)) {

1253 
	`¢d_öãrvÆ_¥öt
(
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
v¨
), 
out
);

1256 
	`as£π
(0);

1257 
	}
}

1259 
	#HW_PARAM
(
v
Ë[
SND_PCM_HW_PARAM_
##v] = #v

	)

1261 c⁄° *c⁄° 
	g¢d_pcm_hw_∑øm_«mes
[] = {

1262 
HW_PARAM
(
ACCESS
),

1263 
HW_PARAM
(
FORMAT
),

1264 
HW_PARAM
(
SUBFORMAT
),

1265 
HW_PARAM
(
SAMPLE_BITS
),

1266 
HW_PARAM
(
FRAME_BITS
),

1267 
HW_PARAM
(
CHANNELS
),

1268 
HW_PARAM
(
RATE
),

1269 
HW_PARAM
(
PERIOD_TIME
),

1270 
HW_PARAM
(
PERIOD_SIZE
),

1271 
HW_PARAM
(
PERIOD_BYTES
),

1272 
HW_PARAM
(
PERIODS
),

1273 
HW_PARAM
(
BUFFER_TIME
),

1274 
HW_PARAM
(
BUFFER_SIZE
),

1275 
HW_PARAM
(
BUFFER_BYTES
),

1276 
HW_PARAM
(
TICK_TIME
),

1279 c⁄° *
	$¢d_pcm_hw_∑øm_«me
(
¢d_pcm_hw_∑øm_t
 
∑øm
)

1281 
	`as£π
(
∑øm
 <
SND_PCM_HW_PARAM_LAST_INTERVAL
);

1282  
¢d_pcm_hw_∑øm_«mes
[
∑øm
];

1283 
	}
}

1288 
	s_¢d_pcm_hw_°øãgy
 {

1289 
	mbad√ss_mö
, 
	mbad√ss_max
;

1290 (*
	mchoo£_∑øm
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
	m∑øms
,

1291 
¢d_pcm_t
 *
	mpcm
,

1292 c⁄° 
¢d_pcm_hw_°øãgy_t
 *
	m°øãgy
);

1293 (*
	m√xt_vÆue
)(
¢d_pcm_hw_∑øms_t
 *
	m∑øms
,

1294 
	m∑øm
,

1295 
	mvÆue
, *
	mdú
,

1296 
¢d_pcm_t
 *
	mpcm
,

1297 c⁄° 
¢d_pcm_hw_°øãgy_t
 *
	m°øãgy
);

1298 (*
	mmö_bad√ss
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
	m∑øms
,

1299 
	mmax_bad√ss
,

1300 
¢d_pcm_t
 *
	mpcm
,

1301 c⁄° 
¢d_pcm_hw_°øãgy_t
 *
	m°øãgy
);

1302 *
	m¥iv©e_d©a
;

1303 (*
	m‰ì
)(
¢d_pcm_hw_°øãgy_t
 *
	m°øãgy
);

1307 
_¢d_pcm_hw_°øãgy_sim∂e
 
	t¢d_pcm_hw_°øãgy_sim∂e_t
;

1309 
	s_¢d_pcm_hw_°øãgy_sim∂e
 {

1310 
	mvÆid
;

1311 
	m‹dî
;

1312 (*
	m√xt_vÆue
)(
¢d_pcm_hw_∑øms_t
 *
	m∑øms
,

1313 
	m∑øm
,

1314 
	mvÆue
, *
	mdú
,

1315 
¢d_pcm_t
 *
	mpcm
,

1316 c⁄° 
¢d_pcm_hw_°øãgy_sim∂e_t
 *
	m∑r
);

1317 (*
	mmö_bad√ss
)(c⁄° 
¢d_pcm_hw_∑øms_t
 *
	m∑øms
,

1318 
	m∑øm
,

1319 
¢d_pcm_t
 *
	mpcm
,

1320 c⁄° 
¢d_pcm_hw_°øãgy_sim∂e_t
 *
	m∑r
);

1321 *
	m¥iv©e_d©a
;

1322 (*
	m‰ì
)(
¢d_pcm_hw_°øãgy_sim∂e_t
 *
	m°øãgy
);

1325 
	s_¢d_pcm_hw_°øãgy_sim∂e_√¨
 {

1326 
	mbe°
;

1327 
	mmul
;

1328 } 
	t¢d_pcm_hw_°øãgy_sim∂e_√¨_t
;

1330 
	s_¢d_pcm_hw_°øãgy_sim∂e_choi˚s
 {

1331 
	mcou¡
;

1333 
¢d_pcm_hw_°øãgy_sim∂e_choi˚s_li°_t
 *
	mchoi˚s
;

1334 } 
	t¢d_pcm_hw_°øãgy_sim∂e_choi˚s_t
;

1336 
	$¢d_pcm_hw_∑øms_°øãgy
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1337 c⁄° 
¢d_pcm_hw_°øãgy_t
 *
°øãgy
,

1338 
bad√ss_mö
,

1339 
bad√ss_max
)

1341 
¢d_pcm_hw_∑øms_t
 
be°_∑øms
;

1342 
v¨
;

1343 
vÆue
, 
dú
;

1344 
be°_bad√ss
;

1345 
bad√ss
 = 
°øãgy
->
	`mö_bad√ss
(
∑øms
, 
bad√ss_max
, 
pcm
, strategy);

1346 
¢d_pcm_hw_∑øms_t
 
∑øms1
;

1348 
	`¥ötf
("\nBad√ss: %d\n", 
bad√ss
);

1349 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
°dout
);

1351 i‡(
bad√ss
 < 0)

1352  
bad√ss
;

1353 i‡(()
bad√ss
 > 
bad√ss_mö
)

1354 
bad√ss_mö
 = badness_min;

1355 
v¨
 = 
°øãgy
->
	`choo£_∑øm
(
∑øms
, 
pcm
, strategy);

1356 i‡(
v¨
 < 0)

1357  
bad√ss
;

1358 
be°_bad√ss
 = 
UINT_MAX
;

1359 
vÆue
 = -1;

1361 
∑øms1
 = *
∑øms
;

1362 
vÆue
 = 
°øãgy
->
	`√xt_vÆue
(&
∑øms1
, 
v¨
, vÆue, &
dú
, 
pcm
, strategy);

1363 i‡(
vÆue
 < 0)

1365 
bad√ss
 = 
	`¢d_pcm_hw_∑øms_°øãgy
(
pcm
, &
∑øms1
, 
°øãgy
, 
bad√ss_mö
, 
bad√ss_max
);

1366 i‡(
bad√ss
 >= 0) {

1367 i‡((Ë
bad√ss
 <
bad√ss_mö
) {

1368 *
∑øms
 = 
∑øms1
;

1369  
bad√ss
;

1371 
be°_bad√ss
 = 
bad√ss
;

1372 
be°_∑øms
 = 
∑øms1
;

1373 
bad√ss_max
 = 
bad√ss
 - 1;

1376 i‡(
be°_bad√ss
 =
UINT_MAX
) {

1377  -
EINVAL
;

1379 *
∑øms
 = 
be°_∑øms
;

1380  
be°_bad√ss
;

1381 
	}
}

1383 
	$¢d_pcm_hw_°øãgy_sim∂e_‰ì
(
¢d_pcm_hw_°øãgy_t
 *
°øãgy
)

1385 
¢d_pcm_hw_°øãgy_sim∂e_t
 *
∑rs
 = 
°øãgy
->
¥iv©e_d©a
;

1386 
k
;

1387 
k
 = 0; k <
SND_PCM_HW_PARAM_LAST_INTERVAL
; ++k) {

1388 i‡(
∑rs
[
k
].
vÆid
 &&Ö¨s[k].
‰ì
)

1389 
∑rs
[
k
].
	`‰ì
(&pars[k]);

1391 
	`‰ì
(
∑rs
);

1392 
	}
}

1394 
	$¢d_pcm_hw_°øãgy_sim∂e_choo£_∑øm
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1395 
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

1396 c⁄° 
¢d_pcm_hw_°øãgy_t
 *
°øãgy
)

1398 
¢d_pcm_hw_∑øm_t
 
v¨
;

1399 
be°_v¨
 = -1;

1400 c⁄° 
¢d_pcm_hw_°øãgy_sim∂e_t
 *
∑rs
 = 
°øãgy
->
¥iv©e_d©a
;

1401 
mö_choi˚s
 = 
UINT_MAX
;

1402 
mö_‹dî
 = 
UINT_MAX
;

1403 
v¨
 = 0; v¨ <
SND_PCM_HW_PARAM_LAST_INTERVAL
; ++var) {

1404 c⁄° 
¢d_pcm_hw_°øãgy_sim∂e_t
 *
p
 = &
∑rs
[
v¨
];

1405 
choi˚s
;

1406 i‡(!
p
->
vÆid
)

1408 
choi˚s
 = 
	`¢d_pcm_hw_∑øm_cou¡
(
∑øms
, 
v¨
);

1409 i‡(
choi˚s
 == 1)

1411 
	`as£π
(
choi˚s
 != 0);

1412 i‡(
p
->
‹dî
 < 
mö_‹dî
 ||

1413 (
p
->
‹dî
 =
mö_‹dî
 &&

1414 
choi˚s
 < 
mö_choi˚s
)) {

1415 
mö_‹dî
 = 
p
->
‹dî
;

1416 
mö_choi˚s
 = 
choi˚s
;

1417 
be°_v¨
 = 
v¨
;

1420  
be°_v¨
;

1421 
	}
}

1423 
	$¢d_pcm_hw_°øãgy_sim∂e_√xt_vÆue
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1424 
¢d_pcm_hw_∑øm_t
 
v¨
,

1425 
vÆue
, *
dú
,

1426 
¢d_pcm_t
 *
pcm
,

1427 c⁄° 
¢d_pcm_hw_°øãgy_t
 *
°øãgy
)

1429 c⁄° 
¢d_pcm_hw_°øãgy_sim∂e_t
 *
∑rs
 = 
°øãgy
->
¥iv©e_d©a
;

1430 
	`as£π
(
∑rs
[
v¨
].
vÆid
);

1431  
∑rs
[
v¨
].
	`√xt_vÆue
(
∑øms
, v¨, 
vÆue
, 
dú
, 
pcm
, &pars[var]);

1432 
	}
}

1435 
	$¢d_pcm_hw_°øãgy_sim∂e_mö_bad√ss
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1436 
max_bad√ss
,

1437 
¢d_pcm_t
 *
pcm
,

1438 c⁄° 
¢d_pcm_hw_°øãgy_t
 *
°øãgy
)

1440 
¢d_pcm_hw_∑øm_t
 
v¨
;

1441 
bad√ss
 = 0;

1442 c⁄° 
¢d_pcm_hw_°øãgy_sim∂e_t
 *
∑rs
 = 
°øãgy
->
¥iv©e_d©a
;

1443 
v¨
 = 0; v¨ <
SND_PCM_HW_PARAM_LAST_INTERVAL
; ++var) {

1444 
b
;

1445 i‡(!
∑rs
[
v¨
].
vÆid
)

1447 
b
 = 
∑rs
[
v¨
].
	`mö_bad√ss
(
∑øms
, v¨, 
pcm
, &pars[var]);

1448 i‡(
b
 > 
max_bad√ss
 || max_bad√s†- b < 
bad√ss
)

1449  -
E2BIG
;

1450 
bad√ss
 +
b
;

1452  
bad√ss
;

1453 
	}
}

1456 
	$¢d_pcm_hw_°øãgy_sim∂e_√¨_‰ì
(
¢d_pcm_hw_°øãgy_sim∂e_t
 *
∑r
)

1458 
¢d_pcm_hw_°øãgy_sim∂e_√¨_t
 *
p
 = 
∑r
->
¥iv©e_d©a
;

1459 
	`‰ì
(
p
);

1460 
	}
}

1462 
	$¢d_pcm_hw_°øãgy_sim∂e_√¨_mö_bad√ss
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1463 
¢d_pcm_hw_∑øm_t
 
v¨
,

1464 
¢d_pcm_t
 *
pcm
,

1465 c⁄° 
¢d_pcm_hw_°øãgy_sim∂e_t
 *
∑r
)

1467 c⁄° 
¢d_pcm_hw_°øãgy_sim∂e_√¨_t
 *
p
 = 
∑r
->
¥iv©e_d©a
;

1468 
¢d_pcm_hw_∑øms_t
 
∑øms1
 = *
∑øms
;

1469 
vÆue
 = 
	`¢d_pcm_hw_∑øm_£t_√¨
(
pcm
, &
∑øms1
, 
v¨
, 
p
->
be°
, 0);

1470 
diff
;

1471 
	`as£π
(
vÆue
 >= 0);

1472 
diff
 = 
p
->
be°
 - 
vÆue
;

1473 i‡(
diff
 < 0)

1474 
diff
 = -diff;

1475  
diff
 * 
p
->
mul
;

1476 
	}
}

1478 
	$¢d_pcm_hw_°øãgy_sim∂e_√¨_√xt_vÆue
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1479 
¢d_pcm_hw_∑øm_t
 
v¨
,

1480 
vÆue
, *
dú
,

1481 
¢d_pcm_t
 *
pcm
,

1482 c⁄° 
¢d_pcm_hw_°øãgy_sim∂e_t
 *
∑r
)

1484 c⁄° 
¢d_pcm_hw_°øãgy_sim∂e_√¨_t
 *
p
 = 
∑r
->
¥iv©e_d©a
;

1485 i‡(
vÆue
 < 0) {

1486 *
dú
 = 0;

1487  
	`¢d_pcm_hw_∑øm_£t_√¨
(
pcm
, 
∑øms
, 
v¨
, 
p
->
be°
, 
dú
);

1489  
	`¢d_pcm_hw_∑øm_£t_√xt
(
pcm
, 
∑øms
, 
v¨
, 
p
->
be°
, 0, 
vÆue
, 
dú
);

1490 
	}
}

1492 
	$¢d_pcm_hw_°øãgy_sim∂e_choi˚s_‰ì
(
¢d_pcm_hw_°øãgy_sim∂e_t
 *
∑r
)

1494 
¢d_pcm_hw_°øãgy_sim∂e_choi˚s_t
 *
p
 = 
∑r
->
¥iv©e_d©a
;

1496 
	`‰ì
(
p
);

1497 
	}
}

1499 
	$¢d_pcm_hw_°øãgy_sim∂e_choi˚s_mö_bad√ss
(c⁄° 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1500 
¢d_pcm_hw_∑øm_t
 
v¨
,

1501 
¢d_pcm_t
 *
pcm
,

1502 c⁄° 
¢d_pcm_hw_°øãgy_sim∂e_t
 *
∑r
)

1504 c⁄° 
¢d_pcm_hw_°øãgy_sim∂e_choi˚s_t
 *
p
 = 
∑r
->
¥iv©e_d©a
;

1505 
k
;

1506 
k
 = 0; k < 
p
->
cou¡
; ++k) {

1507 i‡(
	`¢d_pcm_hw_∑øm_£t
(
pcm
, (
¢d_pcm_hw_∑øms_t
 *Ë
∑øms
, 
SND_TEST
, 
v¨
, 
p
->
choi˚s
[
k
].
vÆue
, 0))

1508  
p
->
choi˚s
[
k
].
bad√ss
;

1510 
	`as£π
(0);

1511  
UINT_MAX
;

1512 
	}
}

1514 
	$¢d_pcm_hw_°øãgy_sim∂e_choi˚s_√xt_vÆue
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1515 
¢d_pcm_hw_∑øm_t
 
v¨
,

1516 
vÆue
, *
dú
,

1517 
¢d_pcm_t
 *
pcm
,

1518 c⁄° 
¢d_pcm_hw_°øãgy_sim∂e_t
 *
∑r
)

1520 c⁄° 
¢d_pcm_hw_°øãgy_sim∂e_choi˚s_t
 *
p
 = 
∑r
->
¥iv©e_d©a
;

1521 
k
 = 0;

1522 i‡(
vÆue
 >= 0) {

1523 ; 
k
 < 
p
->
cou¡
; ++k) {

1524 i‡(
p
->
choi˚s
[
k
].
vÆue
 == () value) {

1525 
k
++;

1530 ; 
k
 < 
p
->
cou¡
; ++k) {

1531 
v
 = 
p
->
choi˚s
[
k
].
vÆue
;

1532 
îr
 = 
	`¢d_pcm_hw_∑øm_£t
(
pcm
, 
∑øms
, 
SND_TRY
, 
v¨
, 
v
, 0);

1533 i‡(
îr
 < 0)

1535 *
dú
 = 0;

1536  
v
;

1539 
	}
}

1541 
	$¢d_pcm_hw_°øãgy_‰ì
(
¢d_pcm_hw_°øãgy_t
 *
°øãgy
)

1543 i‡(
°øãgy
->
‰ì
)

1544 
°øãgy
->
	`‰ì
(strategy);

1545 
	`‰ì
(
°øãgy
);

1546 
	}
}

1548 
	$¢d_pcm_hw_°øãgy_sim∂e
(
¢d_pcm_hw_°øãgy_t
 **
°øãgyp
,

1549 
bad√ss_mö
,

1550 
bad√ss_max
)

1552 
¢d_pcm_hw_°øãgy_sim∂e_t
 *
d©a
;

1553 
¢d_pcm_hw_°øãgy_t
 *
s
;

1554 
	`as£π
(
°øãgyp
);

1555 
d©a
 = 
	`ˇŒoc
(
SND_PCM_HW_PARAM_LAST_INTERVAL
 + 1, (*data));

1556 i‡(!
d©a
)

1557  -
ENOMEM
;

1558 
s
 = 
	`ˇŒoc
(1, (*s));

1559 i‡(!
s
) {

1560 
	`‰ì
(
d©a
);

1561  -
ENOMEM
;

1563 
s
->
choo£_∑øm
 = 
¢d_pcm_hw_°øãgy_sim∂e_choo£_∑øm
;

1564 
s
->
√xt_vÆue
 = 
¢d_pcm_hw_°øãgy_sim∂e_√xt_vÆue
;

1565 
s
->
mö_bad√ss
 = 
¢d_pcm_hw_°øãgy_sim∂e_mö_bad√ss
;

1566 
s
->
bad√ss_mö
 = badness_min;

1567 
s
->
bad√ss_max
 = badness_max;

1568 
s
->
¥iv©e_d©a
 = 
d©a
;

1569 
s
->
‰ì
 = 
¢d_pcm_hw_°øãgy_sim∂e_‰ì
;

1570 *
°øãgyp
 = 
s
;

1572 
	}
}

1574 
	$¢d_pcm_hw_°øãgy_sim∂e_√¨
(
¢d_pcm_hw_°øãgy_t
 *
°øãgy
,

1575 
‹dî
,

1576 
¢d_pcm_hw_∑øm_t
 
v¨
,

1577 
be°
,

1578 
mul
)

1580 
¢d_pcm_hw_°øãgy_sim∂e_t
 *
s
 = 
°øãgy
->
¥iv©e_d©a
;

1581 
¢d_pcm_hw_°øãgy_sim∂e_√¨_t
 *
d©a
;

1582 
	`as£π
(
°øãgy
);

1583 
	`as£π
(
v¨
 <
SND_PCM_HW_PARAM_LAST_INTERVAL
);

1584 
	`as£π
(!
s
->
vÆid
);

1585 
d©a
 = 
	`ˇŒoc
(1, (*data));

1586 i‡(!
d©a
)

1587  -
ENOMEM
;

1588 
d©a
->
be°
 = best;

1589 
d©a
->
mul
 = mul;

1590 
s
 +
v¨
;

1591 
s
->
‹dî
 = order;

1592 
s
->
vÆid
 = 1;

1593 
s
->
√xt_vÆue
 = 
¢d_pcm_hw_°øãgy_sim∂e_√¨_√xt_vÆue
;

1594 
s
->
mö_bad√ss
 = 
¢d_pcm_hw_°øãgy_sim∂e_√¨_mö_bad√ss
;

1595 
s
->
¥iv©e_d©a
 = 
d©a
;

1596 
s
->
‰ì
 = 
¢d_pcm_hw_°øãgy_sim∂e_√¨_‰ì
;

1598 
	}
}

1600 
	$¢d_pcm_hw_°øãgy_sim∂e_choi˚s
(
¢d_pcm_hw_°øãgy_t
 *
°øãgy
,

1601 
‹dî
,

1602 
¢d_pcm_hw_∑øm_t
 
v¨
,

1603 
cou¡
,

1604 
¢d_pcm_hw_°øãgy_sim∂e_choi˚s_li°_t
 *
choi˚s
)

1606 
¢d_pcm_hw_°øãgy_sim∂e_t
 *
s
 = 
°øãgy
->
¥iv©e_d©a
;

1607 
¢d_pcm_hw_°øãgy_sim∂e_choi˚s_t
 *
d©a
;

1608 
	`as£π
(
°øãgy
);

1609 
	`as£π
(
v¨
 <
SND_PCM_HW_PARAM_LAST_INTERVAL
);

1610 
	`as£π
(!
s
->
vÆid
);

1611 
d©a
 = 
	`ˇŒoc
(1, (*data));

1612 i‡(!
d©a
)

1613  -
ENOMEM
;

1614 
d©a
->
cou¡
 = count;

1615 
d©a
->
choi˚s
 = choices;

1616 
s
 +
v¨
;

1617 
s
->
vÆid
 = 1;

1618 
s
->
‹dî
 = order;

1619 
s
->
√xt_vÆue
 = 
¢d_pcm_hw_°øãgy_sim∂e_choi˚s_√xt_vÆue
;

1620 
s
->
mö_bad√ss
 = 
¢d_pcm_hw_°øãgy_sim∂e_choi˚s_mö_bad√ss
;

1621 
s
->
¥iv©e_d©a
 = 
d©a
;

1622 
s
->
‰ì
 = 
¢d_pcm_hw_°øãgy_sim∂e_choi˚s_‰ì
;

1624 
	}
}

1626 
	$¢d_pcm_hw_∑øms_åy_ex∂aö_Áûuª1
(
¢d_pcm_t
 *
pcm
,

1627 
¢d_pcm_hw_∑øms_t
 *
Áû
,

1628 
¢d_pcm_hw_∑øms_t
 *
suc˚ss
,

1629 
dïth
,

1630 
¢d_ouçut_t
 *
out
)

1632 
¢d_pcm_hw_∑øm_t
 
v¨
;

1633 
¢d_pcm_hw_∑øms_t
 
i
;

1634 i‡(
dïth
 < 1)

1635  -
ENOENT
;

1636 
v¨
 = 0; v¨ <
SND_PCM_HW_PARAM_LAST_INTERVAL
; var++) {

1637 
îr
;

1638 
i
 = *
suc˚ss
;

1639 
	`_¢d_pcm_hw_∑øm_c›y
(&
i
, 
v¨
, 
Áû
);

1640 
îr
 = 
	`¢d_pcm_hw_ªföe
(
pcm
, &
i
);

1641 i‡(
îr
 == 0 &&

1642 
	`¢d_pcm_hw_∑øms_åy_ex∂aö_Áûuª1
(
pcm
, 
Áû
, &
i
, 
dïth
 - 1, 
out
) < 0)

1644 
	`¢d_ouçut_¥ötf
(
out
, "%s: ", 
	`¢d_pcm_hw_∑øm_«me
(
v¨
));

1645 
	`¢d_pcm_hw_∑øm_dump
(
Áû
, 
v¨
, 
out
);

1646 
	`¢d_ouçut_putc
(
out
, '\n');

1649  -
ENOENT
;

1650 
	}
}

1652 
	$¢d_pcm_hw_∑øms_åy_ex∂aö_Áûuª
(
¢d_pcm_t
 *
pcm
,

1653 
¢d_pcm_hw_∑øms_t
 *
Áû
,

1654 
¢d_pcm_hw_∑øms_t
 *
suc˚ss
,

1655 
dïth
,

1656 
¢d_ouçut_t
 *
out
)

1658 
¢d_pcm_hw_∑øms_t
 
i
, 
™y
;

1659 
îr
;

1660 
¢d_pcm_hw_∑øm_t
 
v¨
;

1661 
d⁄e
 = 0;

1662 
	`as£π
(
pcm
 && 
Áû
);

1663 
v¨
 = 0; v¨ <
SND_PCM_HW_PARAM_LAST_INTERVAL
; var++) {

1664 i‡(!
	`¢d_pcm_hw_∑øm_em±y
(
Áû
, 
v¨
))

1666 
	`¢d_ouçut_¥ötf
(
out
, "%†i†em±y\n", 
	`¢d_pcm_hw_∑øm_«me
(
v¨
));

1667 
d⁄e
 = 1;

1669 i‡(
d⁄e
)

1671 
i
 = *
Áû
;

1672 
îr
 = 
	`¢d_pcm_hw_ªföe
(
pcm
, &
i
);

1673 i‡(
îr
 == 0) {

1674 
	`¢d_ouçut_¥ötf
(
out
, "Configuration is virtually correct\n");

1677 i‡(!
suc˚ss
) {

1678 
	`¢d_pcm_hw_∑øms_™y
(
pcm
, &
™y
);

1679 
suc˚ss
 = &
™y
;

1681  
	`¢d_pcm_hw_∑øms_åy_ex∂aö_Áûuª1
(
pcm
, 
Áû
, 
suc˚ss
, 
dïth
, 
out
);

1682 
	}
}

1686 
_¢d_pcm_hw_ruÀ
 
	t¢d_pcm_hw_ruÀ_t
;

1688 (*
	t¢d_pcm_hw_ruÀ_func_t
)(
	t¢d_pcm_hw_∑øms_t
 *
	t∑øms
,

1689 c⁄° 
	t¢d_pcm_hw_ruÀ_t
 *
	truÀ
);

1691 
	s_¢d_pcm_hw_ruÀ
 {

1692 
v¨
;

1693 
¢d_pcm_hw_ruÀ_func_t
 
func
;

1694 
dïs
[4];

1695 *
¥iv©e_d©a
;

1698 
	$¢d_pcm_hw_ruÀ_mul
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1699 c⁄° 
¢d_pcm_hw_ruÀ_t
 *
ruÀ
)

1701 
¢d_öãrvÆ_t
 
t
;

1702 
	`¢d_öãrvÆ_mul
(
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
ruÀ
->
dïs
[0]),

1703 
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
ruÀ
->
dïs
[1]), &
t
);

1704  
	`¢d_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
ruÀ
->
v¨
), &
t
);

1705 
	}
}

1707 
	$¢d_pcm_hw_ruÀ_div
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1708 c⁄° 
¢d_pcm_hw_ruÀ_t
 *
ruÀ
)

1710 
¢d_öãrvÆ_t
 
t
;

1711 
	`¢d_öãrvÆ_div
(
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
ruÀ
->
dïs
[0]),

1712 
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
ruÀ
->
dïs
[1]), &
t
);

1713  
	`¢d_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
ruÀ
->
v¨
), &
t
);

1714 
	}
}

1716 
	$¢d_pcm_hw_ruÀ_muldivk
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1717 c⁄° 
¢d_pcm_hw_ruÀ_t
 *
ruÀ
)

1719 
¢d_öãrvÆ_t
 
t
;

1720 
	`¢d_öãrvÆ_muldivk
(
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
ruÀ
->
dïs
[0]),

1721 
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
ruÀ
->
dïs
[1]),

1722 (Ë
ruÀ
->
¥iv©e_d©a
, &
t
);

1723  
	`¢d_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
ruÀ
->
v¨
), &
t
);

1724 
	}
}

1726 
	$¢d_pcm_hw_ruÀ_mulkdiv
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1727 c⁄° 
¢d_pcm_hw_ruÀ_t
 *
ruÀ
)

1729 
¢d_öãrvÆ_t
 
t
;

1730 
	`¢d_öãrvÆ_mulkdiv
(
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
ruÀ
->
dïs
[0]),

1731 (Ë
ruÀ
->
¥iv©e_d©a
,

1732 
	`hw_∑øm_öãrvÆ_c
(
∑øms
, 
ruÀ
->
dïs
[1]), &
t
);

1733  
	`¢d_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
ruÀ
->
v¨
), &
t
);

1734 
	}
}

1736 
	$¢d_pcm_hw_ruÀ_f‹m©
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1737 c⁄° 
¢d_pcm_hw_ruÀ_t
 *
ruÀ
)

1739 
ch™ged
 = 0;

1740 
¢d_pcm_f‹m©_t
 
k
;

1741 
¢d_mask_t
 *
mask
 = 
	`hw_∑øm_mask
(
∑øms
, 
ruÀ
->
v¨
);

1742 
¢d_öãrvÆ_t
 *
i
 = 
	`hw_∑øm_öãrvÆ
(
∑øms
, 
ruÀ
->
dïs
[0]);

1743 
k
 = 0; k <
SND_PCM_FORMAT_LAST
; k++) {

1744 
bôs
;

1745 i‡(!
	`¢d_pcm_f‹m©_mask_ã°
(
mask
, 
k
))

1747 
bôs
 = 
	`¢d_pcm_f‹m©_physiˇl_width
(
k
);

1748 i‡(
bôs
 < 0)

1750 i‡(!
	`¢d_öãrvÆ_ã°
(
i
, (Ë
bôs
)) {

1751 
	`¢d_pcm_f‹m©_mask_ª£t
(
mask
, 
k
);

1752 i‡(
	`¢d_mask_em±y
(
mask
))

1753  -
EINVAL
;

1754 
ch™ged
 = 1;

1757  
ch™ged
;

1758 
	}
}

1761 
	$¢d_pcm_hw_ruÀ_ßm∂e_bôs
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

1762 c⁄° 
¢d_pcm_hw_ruÀ_t
 *
ruÀ
)

1764 
mö
, 
max
;

1765 
¢d_pcm_f‹m©_t
 
k
;

1766 
¢d_öãrvÆ_t
 *
i
 = 
	`hw_∑øm_öãrvÆ
(
∑øms
, 
ruÀ
->
v¨
);

1767 
¢d_mask_t
 *
mask
 = 
	`hw_∑øm_mask
(
∑øms
, 
ruÀ
->
dïs
[0]);

1768 
c
, 
ch™ged
 = 0;

1769 
mö
 = 
UINT_MAX
;

1770 
max
 = 0;

1771 
k
 = 0; k <
SND_PCM_FORMAT_LAST
; k++) {

1772 
bôs
;

1773 i‡(!
	`¢d_pcm_f‹m©_mask_ã°
(
mask
, 
k
))

1775 
bôs
 = 
	`¢d_pcm_f‹m©_physiˇl_width
(
k
);

1776 i‡(
bôs
 < 0)

1778 i‡(
mö
 > ()
bôs
)

1779 
mö
 = 
bôs
;

1780 i‡(
max
 < ()
bôs
)

1781 
max
 = 
bôs
;

1783 
c
 = 
	`¢d_öãrvÆ_ªföe_mö
(
i
, 
mö
, 0);

1784 i‡(
c
 < 0)

1785  
c
;

1786 i‡(
c
)

1787 
ch™ged
 = 1;

1788 
c
 = 
	`¢d_öãrvÆ_ªföe_max
(
i
, 
max
, 0);

1789 i‡(
c
 < 0)

1790  
c
;

1791 i‡(
c
)

1792 
ch™ged
 = 1;

1793  
ch™ged
;

1794 
	}
}

1796 c⁄° 
¢d_pcm_hw_ruÀ_t
 
	gªföe_ruÀs
[] = {

1798 .
v¨
 = 
SND_PCM_HW_PARAM_FORMAT
,

1799 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_f‹m©
,

1800 .
	gdïs
 = { 
SND_PCM_HW_PARAM_SAMPLE_BITS
, -1 },

1801 .
	g¥iv©e_d©a
 = 0,

1804 .
	gv¨
 = 
SND_PCM_HW_PARAM_SAMPLE_BITS
,

1805 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_ßm∂e_bôs
,

1806 .
	gdïs
 = { 
SND_PCM_HW_PARAM_FORMAT
,

1807 
SND_PCM_HW_PARAM_SAMPLE_BITS
, -1 },

1808 .
	g¥iv©e_d©a
 = 0,

1811 .
	gv¨
 = 
SND_PCM_HW_PARAM_SAMPLE_BITS
,

1812 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_div
,

1813 .
	gdïs
 = { 
SND_PCM_HW_PARAM_FRAME_BITS
,

1814 
SND_PCM_HW_PARAM_CHANNELS
, -1 },

1815 .
	g¥iv©e_d©a
 = 0,

1818 .
	gv¨
 = 
SND_PCM_HW_PARAM_FRAME_BITS
,

1819 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_mul
,

1820 .
	gdïs
 = { 
SND_PCM_HW_PARAM_SAMPLE_BITS
,

1821 
SND_PCM_HW_PARAM_CHANNELS
, -1 },

1822 .
	g¥iv©e_d©a
 = 0,

1825 .
	gv¨
 = 
SND_PCM_HW_PARAM_FRAME_BITS
,

1826 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_mulkdiv
,

1827 .
	gdïs
 = { 
SND_PCM_HW_PARAM_PERIOD_BYTES
,

1828 
SND_PCM_HW_PARAM_PERIOD_SIZE
, -1 },

1829 .
	g¥iv©e_d©a
 = (*) 8,

1832 .
	gv¨
 = 
SND_PCM_HW_PARAM_FRAME_BITS
,

1833 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_mulkdiv
,

1834 .
	gdïs
 = { 
SND_PCM_HW_PARAM_BUFFER_BYTES
,

1835 
SND_PCM_HW_PARAM_BUFFER_SIZE
, -1 },

1836 .
	g¥iv©e_d©a
 = (*) 8,

1839 .
	gv¨
 = 
SND_PCM_HW_PARAM_CHANNELS
,

1840 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_div
,

1841 .
	gdïs
 = { 
SND_PCM_HW_PARAM_FRAME_BITS
,

1842 
SND_PCM_HW_PARAM_SAMPLE_BITS
, -1 },

1843 .
	g¥iv©e_d©a
 = 0,

1846 .
	gv¨
 = 
SND_PCM_HW_PARAM_RATE
,

1847 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_mulkdiv
,

1848 .
	gdïs
 = { 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

1849 
SND_PCM_HW_PARAM_PERIOD_TIME
, -1 },

1850 .
	g¥iv©e_d©a
 = (*) 1000000,

1853 .
	gv¨
 = 
SND_PCM_HW_PARAM_RATE
,

1854 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_mulkdiv
,

1855 .
	gdïs
 = { 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1856 
SND_PCM_HW_PARAM_BUFFER_TIME
, -1 },

1857 .
	g¥iv©e_d©a
 = (*) 1000000,

1860 .
	gv¨
 = 
SND_PCM_HW_PARAM_PERIODS
,

1861 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_div
,

1862 .
	gdïs
 = { 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1863 
SND_PCM_HW_PARAM_PERIOD_SIZE
, -1 },

1864 .
	g¥iv©e_d©a
 = 0,

1867 .
	gv¨
 = 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

1868 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_div
,

1869 .
	gdïs
 = { 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1870 
SND_PCM_HW_PARAM_PERIODS
, -1 },

1871 .
	g¥iv©e_d©a
 = 0,

1874 .
	gv¨
 = 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

1875 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_mulkdiv
,

1876 .
	gdïs
 = { 
SND_PCM_HW_PARAM_PERIOD_BYTES
,

1877 
SND_PCM_HW_PARAM_FRAME_BITS
, -1 },

1878 .
	g¥iv©e_d©a
 = (*) 8,

1881 .
	gv¨
 = 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

1882 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_muldivk
,

1883 .
	gdïs
 = { 
SND_PCM_HW_PARAM_PERIOD_TIME
,

1884 
SND_PCM_HW_PARAM_RATE
, -1 },

1885 .
	g¥iv©e_d©a
 = (*) 1000000,

1888 .
	gv¨
 = 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1889 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_mul
,

1890 .
	gdïs
 = { 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

1891 
SND_PCM_HW_PARAM_PERIODS
, -1 },

1892 .
	g¥iv©e_d©a
 = 0,

1895 .
	gv¨
 = 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1896 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_mulkdiv
,

1897 .
	gdïs
 = { 
SND_PCM_HW_PARAM_BUFFER_BYTES
,

1898 
SND_PCM_HW_PARAM_FRAME_BITS
, -1 },

1899 .
	g¥iv©e_d©a
 = (*) 8,

1902 .
	gv¨
 = 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1903 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_muldivk
,

1904 .
	gdïs
 = { 
SND_PCM_HW_PARAM_BUFFER_TIME
,

1905 
SND_PCM_HW_PARAM_RATE
, -1 },

1906 .
	g¥iv©e_d©a
 = (*) 1000000,

1909 .
	gv¨
 = 
SND_PCM_HW_PARAM_PERIOD_BYTES
,

1910 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_muldivk
,

1911 .
	gdïs
 = { 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

1912 
SND_PCM_HW_PARAM_FRAME_BITS
, -1 },

1913 .
	g¥iv©e_d©a
 = (*) 8,

1916 .
	gv¨
 = 
SND_PCM_HW_PARAM_BUFFER_BYTES
,

1917 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_muldivk
,

1918 .
	gdïs
 = { 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1919 
SND_PCM_HW_PARAM_FRAME_BITS
, -1 },

1920 .
	g¥iv©e_d©a
 = (*) 8,

1923 .
	gv¨
 = 
SND_PCM_HW_PARAM_PERIOD_TIME
,

1924 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_mulkdiv
,

1925 .
	gdïs
 = { 
SND_PCM_HW_PARAM_PERIOD_SIZE
,

1926 
SND_PCM_HW_PARAM_RATE
, -1 },

1927 .
	g¥iv©e_d©a
 = (*) 1000000,

1930 .
	gv¨
 = 
SND_PCM_HW_PARAM_BUFFER_TIME
,

1931 .
	gfunc
 = 
¢d_pcm_hw_ruÀ_mulkdiv
,

1932 .
	gdïs
 = { 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

1933 
SND_PCM_HW_PARAM_RATE
, -1 },

1934 .
	g¥iv©e_d©a
 = (*) 1000000,

1938 
	#RULES
 ((
ªföe_ruÀs
Ë/ ‘eföe_ruÀs[0]))

	)

1939 
	#PCM_BIT
(
x
) \

1940 (1U << ((
x
Ë< 32 ? (xË: ((xË- 32)))

	)

1942 c⁄° 
¢d_mask_t
 
	gªföe_masks
[
SND_PCM_HW_PARAM_LAST_MASK
 - 
SND_PCM_HW_PARAM_FIRST_MASK
 + 1] = {

1943 [
SND_PCM_HW_PARAM_ACCESS
 - 
SND_PCM_HW_PARAM_FIRST_MASK
] = {

1944 .
bôs
 = {

1945 
PCM_BIT
(
SNDRV_PCM_ACCESS_MMAP_INTERLEAVED
) |

1946 
PCM_BIT
(
SNDRV_PCM_ACCESS_MMAP_NONINTERLEAVED
) |

1947 
PCM_BIT
(
SNDRV_PCM_ACCESS_MMAP_COMPLEX
) |

1948 
PCM_BIT
(
SNDRV_PCM_ACCESS_RW_INTERLEAVED
) |

1949 
PCM_BIT
(
SNDRV_PCM_ACCESS_RW_NONINTERLEAVED
)

1952 [
SND_PCM_HW_PARAM_FORMAT
 - 
SND_PCM_HW_PARAM_FIRST_MASK
] = {

1953 .
bôs
 = {

1955 
PCM_BIT
(
SNDRV_PCM_FORMAT_S8
) |

1956 
PCM_BIT
(
SNDRV_PCM_FORMAT_U8
) |

1957 
PCM_BIT
(
SNDRV_PCM_FORMAT_S16_LE
) |

1958 
PCM_BIT
(
SNDRV_PCM_FORMAT_S16_BE
) |

1959 
PCM_BIT
(
SNDRV_PCM_FORMAT_U16_LE
) |

1960 
PCM_BIT
(
SNDRV_PCM_FORMAT_U16_BE
) |

1961 
PCM_BIT
(
SNDRV_PCM_FORMAT_S24_LE
) |

1962 
PCM_BIT
(
SNDRV_PCM_FORMAT_S24_BE
) |

1963 
PCM_BIT
(
SNDRV_PCM_FORMAT_U24_LE
) |

1964 
PCM_BIT
(
SNDRV_PCM_FORMAT_U24_BE
) |

1965 
PCM_BIT
(
SNDRV_PCM_FORMAT_S32_LE
) |

1966 
PCM_BIT
(
SNDRV_PCM_FORMAT_S32_BE
) |

1967 
PCM_BIT
(
SNDRV_PCM_FORMAT_U32_LE
) |

1968 
PCM_BIT
(
SNDRV_PCM_FORMAT_U32_BE
) |

1969 
PCM_BIT
(
SNDRV_PCM_FORMAT_FLOAT_LE
) |

1970 
PCM_BIT
(
SNDRV_PCM_FORMAT_FLOAT_BE
) |

1971 
PCM_BIT
(
SNDRV_PCM_FORMAT_FLOAT64_LE
) |

1972 
PCM_BIT
(
SNDRV_PCM_FORMAT_FLOAT64_BE
) |

1973 
PCM_BIT
(
SNDRV_PCM_FORMAT_IEC958_SUBFRAME
) |

1974 
PCM_BIT
(
SNDRV_PCM_FORMAT_IEC958_SUBFRAME
) |

1975 
PCM_BIT
(
SNDRV_PCM_FORMAT_MU_LAW
) |

1976 
PCM_BIT
(
SNDRV_PCM_FORMAT_A_LAW
) |

1977 
PCM_BIT
(
SNDRV_PCM_FORMAT_IMA_ADPCM
) |

1978 
PCM_BIT
(
SNDRV_PCM_FORMAT_MPEG
) |

1979 
PCM_BIT
(
SNDRV_PCM_FORMAT_GSM
) |

1980 
PCM_BIT
(
SNDRV_PCM_FORMAT_S20_LE
) |

1981 
PCM_BIT
(
SNDRV_PCM_FORMAT_S20_BE
) |

1982 
PCM_BIT
(
SNDRV_PCM_FORMAT_U20_LE
) |

1983 
PCM_BIT
(
SNDRV_PCM_FORMAT_U20_BE
) |

1984 
PCM_BIT
(
SNDRV_PCM_FORMAT_SPECIAL
),

1986 
PCM_BIT
(
SNDRV_PCM_FORMAT_S24_3LE
) |

1987 
PCM_BIT
(
SNDRV_PCM_FORMAT_S24_3BE
) |

1988 
PCM_BIT
(
SNDRV_PCM_FORMAT_U24_3LE
) |

1989 
PCM_BIT
(
SNDRV_PCM_FORMAT_U24_3BE
) |

1990 
PCM_BIT
(
SNDRV_PCM_FORMAT_S20_3LE
) |

1991 
PCM_BIT
(
SNDRV_PCM_FORMAT_S20_3BE
) |

1992 
PCM_BIT
(
SNDRV_PCM_FORMAT_U20_3LE
) |

1993 
PCM_BIT
(
SNDRV_PCM_FORMAT_U20_3BE
) |

1994 
PCM_BIT
(
SNDRV_PCM_FORMAT_S18_3LE
) |

1995 
PCM_BIT
(
SNDRV_PCM_FORMAT_S18_3BE
) |

1996 
PCM_BIT
(
SNDRV_PCM_FORMAT_U18_3LE
) |

1997 
PCM_BIT
(
SNDRV_PCM_FORMAT_U18_3BE
) |

1998 
PCM_BIT
(
SNDRV_PCM_FORMAT_G723_24
) |

1999 
PCM_BIT
(
SNDRV_PCM_FORMAT_G723_24
) |

2000 
PCM_BIT
(
SNDRV_PCM_FORMAT_G723_40
) |

2001 
PCM_BIT
(
SNDRV_PCM_FORMAT_G723_40
) |

2002 
PCM_BIT
(
SNDRV_PCM_FORMAT_DSD_U8
) |

2003 
PCM_BIT
(
SNDRV_PCM_FORMAT_DSD_U16_LE
) |

2004 
PCM_BIT
(
SNDRV_PCM_FORMAT_DSD_U32_LE
) |

2005 
PCM_BIT
(
SNDRV_PCM_FORMAT_DSD_U16_BE
) |

2006 
PCM_BIT
(
SNDRV_PCM_FORMAT_DSD_U32_BE
)

2009 [
SND_PCM_HW_PARAM_SUBFORMAT
 - 
SND_PCM_HW_PARAM_FIRST_MASK
] = {

2010 .
bôs
 = {

2011 
PCM_BIT
(
SNDRV_PCM_SUBFORMAT_STD
) |

2012 
PCM_BIT
(
SNDRV_PCM_SUBFORMAT_MSBITS_MAX
) |

2013 
PCM_BIT
(
SNDRV_PCM_SUBFORMAT_MSBITS_20
) |

2014 
PCM_BIT
(
SNDRV_PCM_SUBFORMAT_MSBITS_24
),

2019 c⁄° 
¢d_öãrvÆ_t
 
	gªföe_öãrvÆs
[
SND_PCM_HW_PARAM_LAST_INTERVAL
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
 + 1] = {

2020 [
SND_PCM_HW_PARAM_SAMPLE_BITS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2021 .
mö
 = 1, .
	gmax
 = 
UINT_MAX
,

2022 .
	g›ímö
 = 0, .
	g›ímax
 = 0, .
	göãgî
 = 1, .
	gem±y
 = 0,

2024 [
SND_PCM_HW_PARAM_FRAME_BITS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2025 .
mö
 = 1, .
	gmax
 = 
UINT_MAX
,

2026 .
	g›ímö
 = 0, .
	g›ímax
 = 0, .
	göãgî
 = 1, .
	gem±y
 = 0,

2028 [
SND_PCM_HW_PARAM_CHANNELS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2029 .
mö
 = 1, .
	gmax
 = 
UINT_MAX
,

2030 .
	g›ímö
 = 0, .
	g›ímax
 = 0, .
	göãgî
 = 1, .
	gem±y
 = 0,

2032 [
SND_PCM_HW_PARAM_RATE
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2033 .
mö
 = 1, .
	gmax
 = 
UINT_MAX
,

2034 .
	g›ímö
 = 0, .
	g›ímax
 = 0, .
	göãgî
 = 0, .
	gem±y
 = 0,

2036 [
SND_PCM_HW_PARAM_PERIOD_TIME
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2037 .
mö
 = 0, .
	gmax
 = 
UINT_MAX
,

2038 .
	g›ímö
 = 0, .
	g›ímax
 = 0, .
	göãgî
 = 0, .
	gem±y
 = 0,

2040 [
SND_PCM_HW_PARAM_PERIOD_SIZE
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2041 .
mö
 = 0, .
	gmax
 = 
UINT_MAX
,

2042 .
	g›ímö
 = 0, .
	g›ímax
 = 0, .
	göãgî
 = 0, .
	gem±y
 = 0,

2044 [
SND_PCM_HW_PARAM_PERIOD_BYTES
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2045 .
mö
 = 0, .
	gmax
 = 
UINT_MAX
,

2046 .
	g›ímö
 = 0, .
	g›ímax
 = 0, .
	göãgî
 = 0, .
	gem±y
 = 0,

2048 [
SND_PCM_HW_PARAM_PERIODS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2049 .
mö
 = 0, .
	gmax
 = 
UINT_MAX
,

2050 .
	g›ímö
 = 0, .
	g›ímax
 = 0, .
	göãgî
 = 0, .
	gem±y
 = 0,

2052 [
SND_PCM_HW_PARAM_BUFFER_TIME
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2053 .
mö
 = 1, .
	gmax
 = 
UINT_MAX
,

2054 .
	g›ímö
 = 0, .
	g›ímax
 = 0, .
	göãgî
 = 0, .
	gem±y
 = 0,

2056 [
SND_PCM_HW_PARAM_BUFFER_SIZE
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2057 .
mö
 = 1, .
	gmax
 = 
UINT_MAX
,

2058 .
	g›ímö
 = 0, .
	g›ímax
 = 0, .
	göãgî
 = 1, .
	gem±y
 = 0,

2060 [
SND_PCM_HW_PARAM_BUFFER_BYTES
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2061 .
mö
 = 1, .
	gmax
 = 
UINT_MAX
,

2062 .
	g›ímö
 = 0, .
	g›ímax
 = 0, .
	göãgî
 = 1, .
	gem±y
 = 0,

2064 [
SND_PCM_HW_PARAM_TICK_TIME
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
] = {

2065 .
mö
 = 0, .
	gmax
 = 
UINT_MAX
,

2066 .
	g›ímö
 = 0, .
	g›ímax
 = 0, .
	göãgî
 = 0, .
	gem±y
 = 0,

2071 
	#RULES_DEBUG


	)

2074 
	$¢d_pcm_hw_ªföe_so·
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

2076 
k
;

2077 
¢d_öãrvÆ_t
 *
i
;

2078 
¢d_mask_t
 *
m
;

2079 
r°amps
[
RULES
];

2080 
v°amps
[
SND_PCM_HW_PARAM_LAST_INTERVAL
 + 1];

2081 
°amp
 = 2;

2082 
ch™ged
, 
agaö
;

2083 #ifde‡
RULES_DEBUG


2084 
¢d_ouçut_t
 *
log
;

2085 
	`¢d_ouçut_°dio_©èch
(&
log
, 
°dîr
, 0);

2086 
	`¢d_ouçut_¥ötf
(
log
, "ªföe_so· '%s' (begö)\n", 
pcm
->
«me
);

2087 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
log
);

2090 
k
 = 
SND_PCM_HW_PARAM_FIRST_MASK
; k <
SND_PCM_HW_PARAM_LAST_MASK
; k++) {

2091 i‡(!(
∑øms
->
rmask
 & (1 << 
k
)))

2093 
ch™ged
 = 
	`¢d_mask_ªföe
(
	`hw_∑øm_mask
(
∑øms
, 
k
),

2094 &
ªföe_masks
[
k
 - 
SND_PCM_HW_PARAM_FIRST_MASK
]);

2095 i‡(
ch™ged
)

2096 
∑øms
->
cmask
 |1 << 
k
;

2097 i‡(
ch™ged
 < 0)

2098 
_îr
;

2101 
k
 = 
SND_PCM_HW_PARAM_FIRST_INTERVAL
; k <
SND_PCM_HW_PARAM_LAST_INTERVAL
; k++) {

2102 i‡(!(
∑øms
->
rmask
 & (1 << 
k
)))

2104 
ch™ged
 = 
	`¢d_öãrvÆ_ªföe
(
	`hw_∑øm_öãrvÆ
(
∑øms
, 
k
),

2105 &
ªföe_öãrvÆs
[
k
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
]);

2106 i‡(
ch™ged
)

2107 
∑øms
->
cmask
 |1 << 
k
;

2108 i‡(
ch™ged
 < 0)

2109 
_îr
;

2112 
k
 = 0; k < 
RULES
; k++)

2113 
r°amps
[
k
] = 0;

2114 
k
 = 0; k <
SND_PCM_HW_PARAM_LAST_INTERVAL
; k++)

2115 
v°amps
[
k
] = (
∑øms
->
rmask
 & (1 << k)) ? 1 : 0;

2117 
agaö
 = 0;

2118 
k
 = 0; k < 
RULES
; k++) {

2119 c⁄° 
¢d_pcm_hw_ruÀ_t
 *
r
 = &
ªföe_ruÀs
[
k
];

2120 
d
;

2121 
doô
 = 0;

2122 
d
 = 0; 
r
->
dïs
[d] >= 0; d++) {

2123 i‡(
v°amps
[
r
->
dïs
[
d
]] > 
r°amps
[
k
]) {

2124 
doô
 = 1;

2128 i‡(!
doô
)

2130 #ifde‡
RULES_DEBUG


2131 
	`¢d_ouçut_¥ötf
(
log
, "RuÀ %d (%p): ", 
k
, 
r
->
func
);

2132 i‡(
r
->
v¨
 >= 0) {

2133 
	`¢d_ouçut_¥ötf
(
log
, "%s=", 
	`¢d_pcm_hw_∑øm_«me
(
r
->
v¨
));

2134 
	`¢d_pcm_hw_∑øm_dump
(
∑øms
, 
r
->
v¨
, 
log
);

2135 
	`¢d_ouçut_puts
(
log
, " -> ");

2138 
ch™ged
 = 
r
->
	`func
(
∑øms
,Ñ);

2139 #ifde‡
RULES_DEBUG


2140 i‡(
r
->
v¨
 >= 0)

2141 
	`¢d_pcm_hw_∑øm_dump
(
∑øms
, 
r
->
v¨
, 
log
);

2142 
d
 = 0; 
r
->
dïs
[d] >= 0; d++) {

2143 
	`¢d_ouçut_¥ötf
(
log
, " %s=", 
	`¢d_pcm_hw_∑øm_«me
(
r
->
dïs
[
d
]));

2144 
	`¢d_pcm_hw_∑øm_dump
(
∑øms
, 
r
->
dïs
[
d
], 
log
);

2146 
	`¢d_ouçut_putc
(
log
, '\n');

2148 
r°amps
[
k
] = 
°amp
;

2149 i‡(
ch™ged
 && 
r
->
v¨
 >= 0) {

2150 
∑øms
->
cmask
 |1 << 
r
->
v¨
;

2151 
v°amps
[
r
->
v¨
] = 
°amp
;

2152 
agaö
 = 1;

2154 i‡(
ch™ged
 < 0)

2155 
_îr
;

2156 
°amp
++;

2158 } 
agaö
);

2159 i‡(!
∑øms
->
msbôs
) {

2160 
i
 = 
	`hw_∑øm_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_SAMPLE_BITS
);

2161 i‡(
	`¢d_öãrvÆ_sögÀ
(
i
))

2162 
∑øms
->
msbôs
 = 
	`¢d_öãrvÆ_vÆue
(
i
);

2163 
m
 = 
	`hw_∑øm_mask_c
(
∑øms
, 
SNDRV_PCM_HW_PARAM_FORMAT
);

2164 i‡(
	`¢d_mask_sögÀ
(
m
)) {

2165 
¢d_pcm_f‹m©_t
 
f‹m©
 = 
	`¢d_mask_mö
(
m
);

2166 
∑øms
->
msbôs
 = 
	`¢d_pcm_f‹m©_width
(
f‹m©
);

2170 i‡(!
∑øms
->
øã_dí
) {

2171 
i
 = 
	`hw_∑øm_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
);

2172 i‡(
	`¢d_öãrvÆ_sögÀ
(
i
)) {

2173 
∑øms
->
øã_num
 = 
	`¢d_öãrvÆ_vÆue
(
i
);

2174 
∑øms
->
øã_dí
 = 1;

2177 
∑øms
->
rmask
 = 0;

2179 
_îr
:

2180 #ifde‡
RULES_DEBUG


2181 
	`¢d_ouçut_¥ötf
(
log
, "ªföe_so· '%s' (íd-%i)\n", 
pcm
->
«me
, 
ch™ged
);

2182 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
log
);

2183 
	`¢d_ouçut_˛o£
(
log
);

2185  
ch™ged
;

2186 
	}
}

2188 
	$_¢d_pcm_hw_∑øms_ªföe
(
¢d_pcm_hw_∑øms_t
 *
∑øms
,

2189 
v¨s
,

2190 c⁄° 
¢d_pcm_hw_∑øms_t
 *
§c
)

2192 
ch™ged
, 
îr
 = 0;

2193 
k
;

2194 
k
 = 0; k <
SND_PCM_HW_PARAM_LAST_INTERVAL
; ++k) {

2195 i‡(!(
v¨s
 & (1 << 
k
)))

2197 
ch™ged
 = 
	`_¢d_pcm_hw_∑øm_ªföe
(
∑øms
, 
k
, 
§c
);

2198 i‡(
ch™ged
 < 0)

2199 
îr
 = 
ch™ged
;

2201 
∑øms
->
öfo
 &
§c
->info;

2202 
∑øms
->
Êags
 = 
§c
->flags;

2203  
îr
;

2204 
	}
}

2206 
¢d_pcm_hw_ªföe_¶ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

2207 (*
˝ª∑ª
)(
¢d_pcm_t
 *
pcm
,

2208 
¢d_pcm_hw_∑øms_t
 *
∑øms
),

2209 (*
cch™ge
)(
¢d_pcm_t
 *
pcm
,

2210 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

2211 
¢d_pcm_hw_∑øms_t
 *
•¨ams
),

2212 (*
•ª∑ª
)(
¢d_pcm_t
 *
pcm
,

2213 
¢d_pcm_hw_∑øms_t
 *
∑øms
),

2214 (*
sch™ge
)(
¢d_pcm_t
 *
pcm
,

2215 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

2216 
¢d_pcm_hw_∑øms_t
 *
•¨ams
),

2217 (*
§eföe
)(
¢d_pcm_t
 *
pcm
,

2218 
¢d_pcm_hw_∑øms_t
 *
•¨ams
))

2221 #ifde‡
RULES_DEBUG


2222 
¢d_ouçut_t
 *
log
;

2224 
¢d_pcm_hw_∑øms_t
 
•¨ams
;

2225 
îr
;

2226 
cmask
, 
ch™ged
;

2227 #ifde‡
RULES_DEBUG


2228 
	`¢d_ouçut_°dio_©èch
(&
log
, 
°dîr
, 0);

2230 
îr
 = 
	`˝ª∑ª
(
pcm
, 
∑øms
);

2231 i‡(
îr
 < 0)

2232  
îr
;

2233 
îr
 = 
	`•ª∑ª
(
pcm
, &
•¨ams
);

2234 i‡(
îr
 < 0) {

2235 
	`SNDERR
("Slave PCMÇot usable");

2236  
îr
;

2238 #ifde‡
RULES_DEBUG


2239 
	`¢d_ouçut_¥ötf
(
log
, "hw_ªföe_¶avê-É¡î '%s'\n", 
pcm
->
«me
);

2242 
cmask
 = 
∑øms
->cmask;

2243 
∑øms
->
cmask
 = 0;

2244 #ifde‡
RULES_DEBUG


2245 
	`¢d_ouçut_¥ötf
(
log
, "sch™gê'%s' (˛õ¡)\n", 
pcm
->
«me
);

2246 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
log
);

2247 
	`¢d_ouçut_¥ötf
(
log
, "sch™gê'%s' (¶ave)\n", 
pcm
->
«me
);

2248 
	`¢d_pcm_hw_∑øms_dump
(&
•¨ams
, 
log
);

2250 
îr
 = 
	`sch™ge
(
pcm
, 
∑øms
, &
•¨ams
);

2251 i‡(
îr
 >= 0) {

2252 #ifde‡
RULES_DEBUG


2253 
	`¢d_ouçut_¥ötf
(
log
, "§eföê'%s' (˛õ¡)\n", 
pcm
->
«me
);

2254 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
log
);

2255 
	`¢d_ouçut_¥ötf
(
log
, "§eföê'%s' (¶ave)\n", 
pcm
->
«me
);

2256 
	`¢d_pcm_hw_∑øms_dump
(&
•¨ams
, 
log
);

2258 
îr
 = 
	`§eföe
(
pcm
, &
•¨ams
);

2259 i‡(
îr
 < 0) {

2260 #ifde‡
RULES_DEBUG


2261 
	`¢d_ouçut_¥ötf
(
log
, "§eföê'%s',Éº < 0 (%iË(˛õ¡)\n", 
pcm
->
«me
, 
îr
);

2262 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
log
);

2263 
	`¢d_ouçut_¥ötf
(
log
, "§eföê'%s',Éº < 0 (%iË(¶ave)\n", 
pcm
->
«me
, 
îr
);

2264 
	`¢d_pcm_hw_∑øms_dump
(&
•¨ams
, 
log
);

2266 
	`cch™ge
(
pcm
, 
∑øms
, &
•¨ams
);

2267  
îr
;

2270 #ifde‡
RULES_DEBUG


2271 
	`¢d_ouçut_¥ötf
(
log
, "sch™gê'%s',Éº < 0 (%iË(˛õ¡)\n", 
pcm
->
«me
, 
îr
);

2272 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
log
);

2273 
	`¢d_ouçut_¥ötf
(
log
, "sch™gê'%s',Éº < 0 (%iË(¶ave)\n", 
pcm
->
«me
, 
îr
);

2274 
	`¢d_pcm_hw_∑øms_dump
(&
•¨ams
, 
log
);

2276 
	`cch™ge
(
pcm
, 
∑øms
, &
•¨ams
);

2277  
îr
;

2279 #ifde‡
RULES_DEBUG


2280 
	`¢d_ouçut_¥ötf
(
log
, "cch™gê'%s'\n", 
pcm
->
«me
);

2282 
îr
 = 
	`cch™ge
(
pcm
, 
∑øms
, &
•¨ams
);

2283 i‡(
îr
 < 0)

2284  
îr
;

2285 #ifde‡
RULES_DEBUG


2286 
	`¢d_ouçut_¥ötf
(
log
, "ªföe_so· '%s'\n", 
pcm
->
«me
);

2288 
îr
 = 
	`¢d_pcm_hw_ªföe_so·
(
pcm
, 
∑øms
);

2289 
ch™ged
 = 
∑øms
->
cmask
;

2290 
∑øms
->
cmask
 |= cmask;

2291 i‡(
îr
 < 0)

2292  
îr
;

2293 #ifde‡
RULES_DEBUG


2294 
	`¢d_ouçut_¥ötf
(
log
, "ªföe_so· ok '%s'\n", 
pcm
->
«me
);

2296 } 
ch™ged
);

2297 #ifde‡
RULES_DEBUG


2298 
	`¢d_ouçut_¥ötf
(
log
, "ªföe_¶avê-Üóvê'%s'\n", 
pcm
->
«me
);

2299 
	`¢d_ouçut_˛o£
(
log
);

2302 
	}
}

2304 
¢d_pcm_hw_∑øms_¶ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

2305 (*
cch™ge
)(
¢d_pcm_t
 *
pcm
,

2306 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

2307 
¢d_pcm_hw_∑øms_t
 *
•¨ams
),

2308 (*
•ª∑ª
)(
¢d_pcm_t
 *
pcm
,

2309 
¢d_pcm_hw_∑øms_t
 *
∑øms
),

2310 (*
sch™ge
)(
¢d_pcm_t
 *
pcm
,

2311 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

2312 
¢d_pcm_hw_∑øms_t
 *
•¨ams
),

2313 (*
•¨ams
)(
¢d_pcm_t
 *
pcm
,

2314 
¢d_pcm_hw_∑øms_t
 *
•¨ams
))

2317 
¢d_pcm_hw_∑øms_t
 
¶ave_∑øms
;

2318 
îr
;

2319 
îr
 = 
	`•ª∑ª
(
pcm
, &
¶ave_∑øms
);

2320 i‡(
îr
 < 0)

2321  
îr
;

2322 
îr
 = 
	`sch™ge
(
pcm
, 
∑øms
, &
¶ave_∑øms
);

2323 i‡(
îr
 < 0)

2324  
îr
;

2325 
îr
 = 
	`•¨ams
(
pcm
, &
¶ave_∑øms
);

2326 i‡(
îr
 < 0)

2327 
	`cch™ge
(
pcm
, 
∑øms
, &
¶ave_∑øms
);

2328  
îr
;

2329 
	}
}

2331 
	$¢d_pcm_sw_∑øms_deÁu…
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
)

2333 
	`as£π
(
pcm
 && 
∑øms
);

2334 
	`as£π
(
pcm
->
£tup
);

2335 
∑øms
->
¥Ÿo
 = 
SNDRV_PCM_VERSION
;

2336 
∑øms
->
t°amp_mode
 = 
SND_PCM_TSTAMP_NONE
;

2337 
∑øms
->
t°amp_ty≥
 = 
pcm
->tstamp_type;

2338 
∑øms
->
≥riod_°ï
 = 1;

2339 
∑øms
->
¶ìp_mö
 = 0;

2340 
∑øms
->
avaû_mö
 = 
pcm
->
≥riod_size
;

2341 
∑øms
->
x„r_Æign
 = 1;

2342 
∑øms
->
°¨t_thªshﬁd
 = 1;

2343 
∑øms
->
°›_thªshﬁd
 = 
pcm
->
buf„r_size
;

2344 
∑øms
->
sûí˚_thªshﬁd
 = 0;

2345 
∑øms
->
sûí˚_size
 = 0;

2346 
∑øms
->
bound¨y
 = 
pcm
->
buf„r_size
;

2348 i‡(
∑øms
->
bound¨y
 == 0)

2349  -
EINVAL
;

2350 
∑øms
->
bound¨y
 * 2 <
LONG_MAX
 - 
pcm
->
buf„r_size
)

2351 
∑øms
->
bound¨y
 *= 2;

2353 
	}
}

2356 
	#REFINE_DEBUG


	)

2359 
	$¢d_pcm_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

2361 
ªs
;

2362 #ifde‡
REFINE_DEBUG


2363 
¢d_ouçut_t
 *
log
;

2364 
	`¢d_ouçut_°dio_©èch
(&
log
, 
°dîr
, 0);

2366 
	`as£π
(
pcm
 && 
∑øms
);

2367 #ifde‡
REFINE_DEBUG


2368 
	`¢d_ouçut_¥ötf
(
log
, "REFINE called:\n");

2369 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
log
);

2371 i‡(
pcm
->
›s
->
hw_ªföe
)

2372 
ªs
 = 
pcm
->
›s
->
	`hw_ªföe
’cm->
›_¨g
, 
∑øms
);

2374 
ªs
 = -
ENOSYS
;

2375 #ifde‡
REFINE_DEBUG


2376 
	`¢d_ouçut_¥ötf
(
log
, "ªföêd⁄ê-Ñesu… = %i\n", 
ªs
);

2377 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
log
);

2378 
	`¢d_ouçut_˛o£
(
log
);

2380  
ªs
;

2381 
	}
}

2395 
	$_¢d_pcm_hw_∑øms_öã∫Æ
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

2397 
îr
;

2398 
¢d_pcm_sw_∑øms_t
 
sw
;

2399 
fb
, 
mö_Æign
;

2400 
îr
 = 
	`¢d_pcm_hw_ªföe
(
pcm
, 
∑øms
);

2401 i‡(
îr
 < 0)

2402  
îr
;

2403 
	`¢d_pcm_hw_∑øms_choo£
(
pcm
, 
∑øms
);

2404 i‡(
pcm
->
£tup
) {

2405 
îr
 = 
	`¢d_pcm_hw_‰ì
(
pcm
);

2406 i‡(
îr
 < 0)

2407  
îr
;

2409 i‡(
pcm
->
›s
->
hw_∑øms
)

2410 
îr
 = 
pcm
->
›s
->
	`hw_∑øms
’cm->
›_¨g
, 
∑øms
);

2412 
îr
 = -
ENOSYS
;

2413 i‡(
îr
 < 0)

2414  
îr
;

2416 
pcm
->
£tup
 = 1;

2417 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_ac˚ss
)(
∑øms
, &
pcm
->
ac˚ss
);

2418 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(
∑øms
, &
pcm
->
f‹m©
);

2419 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_subf‹m©
)(
∑øms
, &
pcm
->
subf‹m©
);

2420 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_ch™√ls
)(
∑øms
, &
pcm
->
ch™√ls
);

2421 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_øã
)(
∑øms
, &
pcm
->
øã
, 0);

2422 
	`¢d_öãrvÆ_c›y
(&
pcm
->
≥riods
, &
∑øms
->
öãrvÆs
[
SND_PCM_HW_PARAM_PERIODS
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
]);

2423 
	`¢d_öãrvÆ_c›y
(&
pcm
->
buf„r_time
, &
∑øms
->
öãrvÆs
[
SND_PCM_HW_PARAM_BUFFER_TIME
 - 
SND_PCM_HW_PARAM_FIRST_INTERVAL
]);

2424 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_time
)(
∑øms
, &
pcm
->
≥riod_time
, 0);

2425 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_size
)(
∑øms
, &
pcm
->
≥riod_size
, 0);

2426 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_size
)(
∑øms
, &
pcm
->
buf„r_size
);

2427 
pcm
->
ßm∂e_bôs
 = 
	`¢d_pcm_f‹m©_physiˇl_width
’cm->
f‹m©
);

2428 
pcm
->
‰ame_bôs
 =Öcm->
ßm∂e_bôs
 *Öcm->
ch™√ls
;

2429 
fb
 = 
pcm
->
‰ame_bôs
;

2430 
mö_Æign
 = 1;

2431 
fb
 % 8) {

2432 
fb
 *= 2;

2433 
mö_Æign
 *= 2;

2435 
pcm
->
mö_Æign
 = min_align;

2437 
pcm
->
hw_Êags
 = 
∑øms
->
Êags
;

2438 
pcm
->
öfo
 = 
∑øms
->info;

2439 
pcm
->
msbôs
 = 
∑øms
->msbits;

2440 
pcm
->
øã_num
 = 
∑øms
->rate_num;

2441 
pcm
->
øã_dí
 = 
∑øms
->rate_den;

2442 
pcm
->
fifo_size
 = 
∑øms
->fifo_size;

2445 
	`mem£t
(&
sw
, 0, (sw));

2446 
îr
 = 
	`¢d_pcm_sw_∑øms_deÁu…
(
pcm
, &
sw
);

2447 i‡(
îr
 < 0)

2448  
îr
;

2449 
îr
 = 
	`¢d_pcm_sw_∑øms
(
pcm
, &
sw
);

2450 i‡(
îr
 < 0)

2451  
îr
;

2453 i‡(
pcm
->
mm≠_rw
 ||

2454 
pcm
->
ac˚ss
 =
SND_PCM_ACCESS_MMAP_INTERLEAVED
 ||

2455 
pcm
->
ac˚ss
 =
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
 ||

2456 
pcm
->
ac˚ss
 =
SND_PCM_ACCESS_MMAP_COMPLEX
) {

2457 
îr
 = 
	`¢d_pcm_mm≠
(
pcm
);

2459 i‡(
îr
 < 0)

2460  
îr
;

2462 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_plug.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_∂ugö.h
"

32 #i‚de‡
PIC


34 c⁄° *
	g_¢d_moduÀ_pcm_∂ug
 = "";

37 #i‚de‡
DOC_HIDDEN


39 
	e¢d_pcm_∂ug_rouã_pﬁicy
 {

40 
	mPLUG_ROUTE_POLICY_NONE
,

41 
	mPLUG_ROUTE_POLICY_DEFAULT
,

42 
	mPLUG_ROUTE_POLICY_COPY
,

43 
	mPLUG_ROUTE_POLICY_AVERAGE
,

44 
	mPLUG_ROUTE_POLICY_DUP
,

48 
¢d_pcm_gíîic_t
 
	mgí
;

49 
¢d_pcm_t
 *
	mªq_¶ave
;

50 
¢d_pcm_f‹m©_t
 
	msf‹m©
;

51 
	msch™√ls
;

52 
	m§©e
;

53 
¢d_c⁄fig_t
 *
	møã_c⁄vîãr
;

54 
¢d_pcm_∂ug_rouã_pﬁicy
 
	mrouã_pﬁicy
;

55 
¢d_pcm_rouã_âabÀ_íåy_t
 *
	mâabÀ
;

56 
	mâabÀ_ok
;

57 
	mâ_ssize
, 
	mâ_cu£d
, 
	mâ_su£d
;

58 } 
	t¢d_pcm_∂ug_t
;

62 
	$¢d_pcm_∂ug_˛o£
(
¢d_pcm_t
 *
pcm
)

64 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

65 
îr
, 
ªsu…
 = 0;

66 
	`‰ì
(
∂ug
->
âabÀ
);

67 i‡(
∂ug
->
øã_c⁄vîãr
) {

68 
	`¢d_c⁄fig_dñëe
(
∂ug
->
øã_c⁄vîãr
);

69 
∂ug
->
øã_c⁄vîãr
 = 
NULL
;

71 
	`as£π
(
∂ug
->
gí
.
¶ave
 =∂ug->
ªq_¶ave
);

72 i‡(
∂ug
->
gí
.
˛o£_¶ave
) {

73 
	`¢d_pcm_u∆ök_hw_±r
(
pcm
, 
∂ug
->
ªq_¶ave
);

74 
	`¢d_pcm_u∆ök_≠∂_±r
(
pcm
, 
∂ug
->
ªq_¶ave
);

75 
îr
 = 
	`¢d_pcm_˛o£
(
∂ug
->
ªq_¶ave
);

76 i‡(
îr
 < 0)

77 
ªsu…
 = 
îr
;

79 
	`‰ì
(
∂ug
);

80  
ªsu…
;

81 
	}
}

83 
	$¢d_pcm_∂ug_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_öfo_t
 *
öfo
)

85 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

86 
¢d_pcm_t
 *
¶ave
 = 
∂ug
->
ªq_¶ave
;

87 
îr
;

89 i‡((
îr
 = 
	`¢d_pcm_öfo
(
¶ave
, 
öfo
)) < 0)

90  
îr
;

92 
	}
}

94 c⁄° 
¢d_pcm_f‹m©_t
 
	glöór_¥e„ºed_f‹m©s
[] = {

95 #ifde‡
SND_LITTLE_ENDIAN


96 
SND_PCM_FORMAT_S16_LE
,

97 
SND_PCM_FORMAT_U16_LE
,

98 
SND_PCM_FORMAT_S16_BE
,

99 
SND_PCM_FORMAT_U16_BE
,

101 
SND_PCM_FORMAT_S16_BE
,

102 
SND_PCM_FORMAT_U16_BE
,

103 
SND_PCM_FORMAT_S16_LE
,

104 
SND_PCM_FORMAT_U16_LE
,

106 #ifde‡
SND_LITTLE_ENDIAN


107 
SND_PCM_FORMAT_S32_LE
,

108 
SND_PCM_FORMAT_U32_LE
,

109 
SND_PCM_FORMAT_S32_BE
,

110 
SND_PCM_FORMAT_U32_BE
,

112 
SND_PCM_FORMAT_S32_BE
,

113 
SND_PCM_FORMAT_U32_BE
,

114 
SND_PCM_FORMAT_S32_LE
,

115 
SND_PCM_FORMAT_U32_LE
,

117 
SND_PCM_FORMAT_S8
,

118 
SND_PCM_FORMAT_U8
,

119 #ifde‡
SND_LITTLE_ENDIAN


120 
SND_PCM_FORMAT_FLOAT_LE
,

121 
SND_PCM_FORMAT_FLOAT64_LE
,

122 
SND_PCM_FORMAT_FLOAT_BE
,

123 
SND_PCM_FORMAT_FLOAT64_BE
,

125 
SND_PCM_FORMAT_FLOAT_BE
,

126 
SND_PCM_FORMAT_FLOAT64_BE
,

127 
SND_PCM_FORMAT_FLOAT_LE
,

128 
SND_PCM_FORMAT_FLOAT64_LE
,

130 #ifde‡
SND_LITTLE_ENDIAN


131 
SND_PCM_FORMAT_S24_LE
,

132 
SND_PCM_FORMAT_U24_LE
,

133 
SND_PCM_FORMAT_S24_BE
,

134 
SND_PCM_FORMAT_U24_BE
,

136 
SND_PCM_FORMAT_S24_BE
,

137 
SND_PCM_FORMAT_U24_BE
,

138 
SND_PCM_FORMAT_S24_LE
,

139 
SND_PCM_FORMAT_U24_LE
,

141 #ifde‡
SND_LITTLE_ENDIAN


142 
SND_PCM_FORMAT_S20_LE
,

143 
SND_PCM_FORMAT_U20_LE
,

144 
SND_PCM_FORMAT_S20_BE
,

145 
SND_PCM_FORMAT_U20_BE
,

147 
SND_PCM_FORMAT_S20_BE
,

148 
SND_PCM_FORMAT_U20_BE
,

149 
SND_PCM_FORMAT_S20_LE
,

150 
SND_PCM_FORMAT_U20_LE
,

152 #ifde‡
SND_LITTLE_ENDIAN


153 
SND_PCM_FORMAT_S24_3LE
,

154 
SND_PCM_FORMAT_U24_3LE
,

155 
SND_PCM_FORMAT_S24_3BE
,

156 
SND_PCM_FORMAT_U24_3BE
,

158 
SND_PCM_FORMAT_S24_3BE
,

159 
SND_PCM_FORMAT_U24_3BE
,

160 
SND_PCM_FORMAT_S24_3LE
,

161 
SND_PCM_FORMAT_U24_3LE
,

163 #ifde‡
SND_LITTLE_ENDIAN


164 
SND_PCM_FORMAT_S20_3LE
,

165 
SND_PCM_FORMAT_U20_3LE
,

166 
SND_PCM_FORMAT_S20_3BE
,

167 
SND_PCM_FORMAT_U20_3BE
,

169 
SND_PCM_FORMAT_S20_3BE
,

170 
SND_PCM_FORMAT_U20_3BE
,

171 
SND_PCM_FORMAT_S20_3LE
,

172 
SND_PCM_FORMAT_U20_3LE
,

174 #ifde‡
SND_LITTLE_ENDIAN


175 
SND_PCM_FORMAT_S18_3LE
,

176 
SND_PCM_FORMAT_U18_3LE
,

177 
SND_PCM_FORMAT_S18_3BE
,

178 
SND_PCM_FORMAT_U18_3BE
,

180 
SND_PCM_FORMAT_S18_3BE
,

181 
SND_PCM_FORMAT_U18_3BE
,

182 
SND_PCM_FORMAT_S18_3LE
,

183 
SND_PCM_FORMAT_U18_3LE
,

187 #i‡
deföed
(
BUILD_PCM_PLUGIN_MULAW
) || \

188 
deföed
(
BUILD_PCM_PLUGIN_ALAW
) || \

189 
deföed
(
BUILD_PCM_PLUGIN_ADPCM
) || \

190 
	$deföed
(
BUILD_PCM_PLUGIN_IEC958
)

191 
	#BUILD_PCM_NONLINEAR


	)

194 #ifde‡
BUILD_PCM_NONLINEAR


195 c⁄° 
¢d_pcm_f‹m©_t
 
n⁄löór_¥e„ºed_f‹m©s
[] = {

196 #ifde‡
BUILD_PCM_PLUGIN_MULAW


197 
SND_PCM_FORMAT_MU_LAW
,

199 #ifde‡
BUILD_PCM_PLUGIN_ALAW


200 
SND_PCM_FORMAT_A_LAW
,

202 #ifde‡
BUILD_PCM_PLUGIN_ADPCM


203 
SND_PCM_FORMAT_IMA_ADPCM
,

205 #ifde‡
BUILD_PCM_PLUGIN_IEC958


206 
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
,

207 
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
,

209 
	}
};

212 #ifde‡
BUILD_PCM_PLUGIN_LFLOAT


213 c⁄° 
¢d_pcm_f‹m©_t
 
	gÊﬂt_¥e„ºed_f‹m©s
[] = {

214 #ifde‡
SND_LITTLE_ENDIAN


215 
SND_PCM_FORMAT_FLOAT_LE
,

216 
SND_PCM_FORMAT_FLOAT64_LE
,

217 
SND_PCM_FORMAT_FLOAT_BE
,

218 
SND_PCM_FORMAT_FLOAT64_BE
,

220 
SND_PCM_FORMAT_FLOAT_BE
,

221 
SND_PCM_FORMAT_FLOAT64_BE
,

222 
SND_PCM_FORMAT_FLOAT_LE
,

223 
SND_PCM_FORMAT_FLOAT64_LE
,

228 c⁄° 
	glöór_f‹m©_widths
[32] = {

235 
	$check_löór_f‹m©
(c⁄° 
¢d_pcm_f‹m©_mask_t
 *
f‹m©_mask
, 
wid
, 
sgn
, 
ed
)

237 
e
, 
s
;

238 i‡(! 
löór_f‹m©_widths
[
wid
 - 1])

239  
SND_PCM_FORMAT_UNKNOWN
;

240 
e
 = 0;É < 2;É++) {

241 
s
 = 0; s < 2; s++) {

242 
pw
 = ((
wid
 + 7) / 8) * 8;

243 ; 
pw
 <= 32;Öw += 8) {

244 
¢d_pcm_f‹m©_t
 
f
;

245 
f
 = 
	`¢d_pcm_buûd_löór_f‹m©
(
wid
, 
pw
, 
sgn
, 
ed
);

246 i‡(
f
 !
SND_PCM_FORMAT_UNKNOWN
 &&

247 
	`¢d_pcm_f‹m©_mask_ã°
(
f‹m©_mask
, 
f
))

248  
f
;

250 
sgn
 = !sgn;

252 
ed
 = !ed;

254  
SND_PCM_FORMAT_UNKNOWN
;

255 
	}
}

257 
¢d_pcm_f‹m©_t
 
	$¢d_pcm_∂ug_¶ave_f‹m©
(
¢d_pcm_f‹m©_t
 
f‹m©
, c⁄° 
¢d_pcm_f‹m©_mask_t
 *
f‹m©_mask
)

259 
w
, 
w1
, 
u
, 
e
;

260 
¢d_pcm_f‹m©_t
 
f
;

261 
¢d_pcm_f‹m©_mask_t
 
lö
 = { 
SND_PCM_FMTBIT_LINEAR
 };

262 
¢d_pcm_f‹m©_mask_t
 
Ê
 = {

263 #ifde‡
BUILD_PCM_PLUGIN_LFLOAT


264 
SND_PCM_FMTBIT_FLOAT


269 i‡(
	`¢d_pcm_f‹m©_mask_ã°
(
f‹m©_mask
, 
f‹m©
))

270  
f‹m©
;

271 i‡(!
	`¢d_pcm_f‹m©_mask_ã°
(&
lö
, 
f‹m©
) &&

272 !
	`¢d_pcm_f‹m©_mask_ã°
(&
Ê
, 
f‹m©
)) {

273 
i
;

274 
f‹m©
) {

275 #ifde‡
BUILD_PCM_PLUGIN_MULAW


276 
SND_PCM_FORMAT_MU_LAW
:

278 #ifde‡
BUILD_PCM_PLUGIN_ALAW


279 
SND_PCM_FORMAT_A_LAW
:

281 #ifde‡
BUILD_PCM_PLUGIN_ADPCM


282 
SND_PCM_FORMAT_IMA_ADPCM
:

284 
i
 = 0; i < (
löór_¥e„ºed_f‹m©s
) / (linear_preferred_formats[0]); ++i) {

285 
¢d_pcm_f‹m©_t
 
f
 = 
löór_¥e„ºed_f‹m©s
[
i
];

286 i‡(
	`¢d_pcm_f‹m©_mask_ã°
(
f‹m©_mask
, 
f
))

287  
f
;

291  
SND_PCM_FORMAT_UNKNOWN
;

295 
	`¢d_mask_öãr£˘
(&
lö
, 
f‹m©_mask
);

296 
	`¢d_mask_öãr£˘
(&
Ê
, 
f‹m©_mask
);

297 i‡(
	`¢d_mask_em±y
(&
lö
Ë&& snd_mask_em±y(&
Ê
)) {

298 #ifde‡
BUILD_PCM_NONLINEAR


299 
i
;

300 
i
 = 0; i < (
n⁄löór_¥e„ºed_f‹m©s
) / (nonlinear_preferred_formats[0]); ++i) {

301 
¢d_pcm_f‹m©_t
 
f
 = 
n⁄löór_¥e„ºed_f‹m©s
[
i
];

302 i‡(
	`¢d_pcm_f‹m©_mask_ã°
(
f‹m©_mask
, 
f
))

303  
f
;

306  
SND_PCM_FORMAT_UNKNOWN
;

308 #ifde‡
BUILD_PCM_PLUGIN_LFLOAT


309 i‡(
	`¢d_pcm_f‹m©_Êﬂt
(
f‹m©
)) {

310 i‡(
	`¢d_pcm_f‹m©_mask_ã°
(&
Ê
, 
f‹m©
)) {

311 
i
;

312 
i
 = 0; i < (
Êﬂt_¥e„ºed_f‹m©s
) / (float_preferred_formats[0]); ++i) {

313 
¢d_pcm_f‹m©_t
 
f
 = 
Êﬂt_¥e„ºed_f‹m©s
[
i
];

314 i‡(
	`¢d_pcm_f‹m©_mask_ã°
(
f‹m©_mask
, 
f
))

315  
f
;

318 
w
 = 32;

319 
u
 = 0;

320 
e
 = 
	`¢d_pcm_f‹m©_big_ídün
(
f‹m©
);

323 i‡(
	`¢d_mask_em±y
(&
lö
)) {

324 #ifde‡
BUILD_PCM_PLUGIN_LFLOAT


325 
i
;

326 
i
 = 0; i < (
Êﬂt_¥e„ºed_f‹m©s
) / (float_preferred_formats[0]); ++i) {

327 
¢d_pcm_f‹m©_t
 
f
 = 
Êﬂt_¥e„ºed_f‹m©s
[
i
];

328 i‡(
	`¢d_pcm_f‹m©_mask_ã°
(
f‹m©_mask
, 
f
))

329  
f
;

332  
SND_PCM_FORMAT_UNKNOWN
;

334 
w
 = 
	`¢d_pcm_f‹m©_width
(
f‹m©
);

335 
u
 = 
	`¢d_pcm_f‹m©_unsig√d
(
f‹m©
);

336 
e
 = 
	`¢d_pcm_f‹m©_big_ídün
(
f‹m©
);

338 
w1
 = 
w
; w1 <= 32; w1++) {

339 
f
 = 
	`check_löór_f‹m©
(
f‹m©_mask
, 
w1
, 
u
, 
e
);

340 i‡(
f
 !
SND_PCM_FORMAT_UNKNOWN
)

341  
f
;

343 
w1
 = 
w
 - 1; w1 > 0; w1--) {

344 
f
 = 
	`check_löór_f‹m©
(
f‹m©_mask
, 
w1
, 
u
, 
e
);

345 i‡(
f
 !
SND_PCM_FORMAT_UNKNOWN
)

346  
f
;

348  
SND_PCM_FORMAT_UNKNOWN
;

349 
	}
}

351 
	$¢d_pcm_∂ug_˛ór
(
¢d_pcm_t
 *
pcm
)

353 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

354 
¢d_pcm_t
 *
¶ave
 = 
∂ug
->
ªq_¶ave
;

356 i‡(
∂ug
->
gí
.
¶ave
 != slave) {

357 
	`¢d_pcm_u∆ök_hw_±r
(
pcm
, 
∂ug
->
gí
.
¶ave
);

358 
	`¢d_pcm_u∆ök_≠∂_±r
(
pcm
, 
∂ug
->
gí
.
¶ave
);

359 
	`¢d_pcm_˛o£
(
∂ug
->
gí
.
¶ave
);

360 
∂ug
->
gí
.
¶ave
 = slave;

361 
pcm
->
Á°_›s
 = 
¶ave
->fast_ops;

362 
pcm
->
Á°_›_¨g
 = 
¶ave
->fast_op_arg;

364 
	}
}

366 #i‚de‡
DOC_HIDDEN


368 
¢d_pcm_ac˚ss_t
 
	mac˚ss
;

369 
¢d_pcm_f‹m©_t
 
	mf‹m©
;

370 
	mch™√ls
;

371 
	møã
;

372 } 
	t¢d_pcm_∂ug_∑øms_t
;

375 #ifde‡
BUILD_PCM_PLUGIN_RATE


376 
	$¢d_pcm_∂ug_ch™ge_øã
(
¢d_pcm_t
 *
pcm
, snd_pcm_à**
√w
, 
¢d_pcm_∂ug_∑øms_t
 *
˛t
, snd_pcm_∂ug_∑øms_à*
¶v
)

378 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

379 
îr
;

380 i‡(
˛t
->
øã
 =
¶v
->rate)

382 
	`as£π
(
	`¢d_pcm_f‹m©_löór
(
¶v
->
f‹m©
));

383 
îr
 = 
	`¢d_pcm_øã_›í
(
√w
, 
NULL
, 
¶v
->
f‹m©
, slv->
øã
, 
∂ug
->
øã_c⁄vîãr
,

384 
∂ug
->
gí
.
¶ave
,Ölug->gí.¶avê!∂ug->
ªq_¶ave
);

385 i‡(
îr
 < 0)

386  
îr
;

387 
¶v
->
ac˚ss
 = 
˛t
->access;

388 
¶v
->
øã
 = 
˛t
->rate;

389 i‡(
	`¢d_pcm_f‹m©_löór
(
˛t
->
f‹m©
))

390 
¶v
->
f‹m©
 = 
˛t
->format;

392 
	}
}

395 #ifde‡
BUILD_PCM_PLUGIN_ROUTE


396 
	$¢d_pcm_∂ug_ch™ge_ch™√ls
(
¢d_pcm_t
 *
pcm
, snd_pcm_à**
√w
, 
¢d_pcm_∂ug_∑øms_t
 *
˛t
, snd_pcm_∂ug_∑øms_à*
¶v
)

398 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

399 
â_ssize
, 
â_cu£d
, 
â_su£d
;

400 
¢d_pcm_rouã_âabÀ_íåy_t
 *
âabÀ
;

401 
îr
;

402 i‡(
˛t
->
ch™√ls
 =
¶v
->channels &&

403 (!
∂ug
->
âabÀ
 ||Ölug->
âabÀ_ok
))

405 i‡(
˛t
->
øã
 !
¶v
->rate &&

406 
˛t
->
ch™√ls
 > 
¶v
->channels)

408 
	`as£π
(
	`¢d_pcm_f‹m©_löór
(
¶v
->
f‹m©
));

409 
â_ssize
 = 
¶v
->
ch™√ls
;

410 
â_cu£d
 = 
˛t
->
ch™√ls
;

411 
â_su£d
 = 
¶v
->
ch™√ls
;

412 
âabÀ
 = 
	`Æloˇ
(
â_cu£d
 * 
â_su£d
 * (*ttable));

413 i‡(
∂ug
->
âabÀ
) {

414 
c
 = 0, 
s
 = 0;

415 
c
 = 0; c < 
â_cu£d
; c++) {

416 
s
 = 0; s < 
â_su£d
; s++) {

417 
¢d_pcm_rouã_âabÀ_íåy_t
 
v
;

418 i‡(
c
 >
∂ug
->
â_cu£d
)

419 
v
 = 0;

420 i‡(
s
 >
∂ug
->
â_su£d
)

421 
v
 = 0;

423 
v
 = 
∂ug
->
âabÀ
[
c
 *Ölug->
â_ssize
 + 
s
];

424 
âabÀ
[
c
 * 
â_ssize
 + 
s
] = 
v
;

427 
∂ug
->
âabÀ_ok
 = 1;

429 
k
;

430 
c
 = 0, 
s
 = 0;

431 
¢d_pcm_∂ug_rouã_pﬁicy
 
Ωﬁicy
 = 
∂ug
->
rouã_pﬁicy
;

432 
n
;

433 
k
 = 0; k < 
â_cu£d
 * 
â_su£d
; ++k)

434 
âabÀ
[
k
] = 0;

435 i‡(
Ωﬁicy
 =
PLUG_ROUTE_POLICY_DEFAULT
) {

436 
Ωﬁicy
 = 
PLUG_ROUTE_POLICY_COPY
;

438 i‡(
˛t
->
ch™√ls
 =1 || 
¶v
->channels == 1)

439 
Ωﬁicy
 = 
PLUG_ROUTE_POLICY_AVERAGE
;

441 
Ωﬁicy
) {

442 
PLUG_ROUTE_POLICY_AVERAGE
:

443 
PLUG_ROUTE_POLICY_DUP
:

444 i‡(
˛t
->
ch™√ls
 > 
¶v
->channels) {

445 
n
 = 
˛t
->
ch™√ls
;

447 
n
 = 
¶v
->
ch™√ls
;

449 
n
-- > 0) {

450 
¢d_pcm_rouã_âabÀ_íåy_t
 
v
 = 
SND_PCM_PLUGIN_ROUTE_FULL
;

451 i‡(
Ωﬁicy
 =
PLUG_ROUTE_POLICY_AVERAGE
) {

452 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
 &&

453 
˛t
->
ch™√ls
 > 
¶v
->channels) {

454 
§cs
 = 
˛t
->
ch™√ls
 / 
¶v
->channels;

455 i‡(
s
 < 
˛t
->
ch™√ls
 % 
¶v
->channels)

456 
§cs
++;

457 
v
 /
§cs
;

458 } i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_CAPTURE
 &&

459 
¶v
->
ch™√ls
 > 
˛t
->channels) {

460 
§cs
 = 
¶v
->
ch™√ls
 / 
˛t
->channels;

461 i‡(
s
 < 
¶v
->
ch™√ls
 % 
˛t
->channels)

462 
§cs
++;

463 
v
 /
§cs
;

466 
âabÀ
[
c
 * 
â_ssize
 + 
s
] = 
v
;

467 i‡(++
c
 =
˛t
->
ch™√ls
)

468 
c
 = 0;

469 i‡(++
s
 =
¶v
->
ch™√ls
)

470 
s
 = 0;

473 
PLUG_ROUTE_POLICY_COPY
:

474 i‡(
˛t
->
ch™√ls
 < 
¶v
->channels) {

475 
n
 = 
˛t
->
ch™√ls
;

477 
n
 = 
¶v
->
ch™√ls
;

479 
c
 = 0; ()¯< 
n
; c++)

480 
âabÀ
[
c
 * 
â_ssize
 + c] = 
SND_PCM_PLUGIN_ROUTE_FULL
;

483 
	`SNDERR
("InvalidÑouteÖolicy");

487 
îr
 = 
	`¢d_pcm_rouã_›í
(
√w
, 
NULL
, 
¶v
->
f‹m©
, (Ë¶v->
ch™√ls
, 
âabÀ
, 
â_ssize
, 
â_cu£d
, 
â_su£d
, 
∂ug
->
gí
.
¶ave
,Ölug->gí.¶avê!∂ug->
ªq_¶ave
);

488 i‡(
îr
 < 0)

489  
îr
;

490 
¶v
->
ch™√ls
 = 
˛t
->channels;

491 
¶v
->
ac˚ss
 = 
˛t
->access;

492 i‡(
	`¢d_pcm_f‹m©_löór
(
˛t
->
f‹m©
))

493 
¶v
->
f‹m©
 = 
˛t
->format;

495 
	}
}

498 #ifde‡
BUILD_PCM_PLUGIN_IEC958


499 
	$õc958_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

500 
¢d_pcm_f‹m©_t
 
sf‹m©
, 
¢d_pcm_t
 *
¶ave
,

501 
˛o£_¶ave
)

503 
¥ómbÀ_vÆs
[3] = {

506  
	`¢d_pcm_õc958_›í
(
pcmp
, 
«me
, 
sf‹m©
, 
¶ave
, 
˛o£_¶ave
, 
NULL
, 
¥ómbÀ_vÆs
, 0);

507 
	}
}

510 
	$¢d_pcm_∂ug_ch™ge_f‹m©
(
¢d_pcm_t
 *
pcm
, snd_pcm_à**
√w
, 
¢d_pcm_∂ug_∑øms_t
 *
˛t
, snd_pcm_∂ug_∑øms_à*
¶v
)

512 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

513 
îr
;

514 
¢d_pcm_f‹m©_t
 
cfmt
;

515 (*
f
)(
¢d_pcm_t
 **
_pcm
, c⁄° *
«me
, 
¢d_pcm_f‹m©_t
 
sf‹m©
, snd_pcm_à*
¶ave
, 
˛o£_¶ave
);

518 i‡(
˛t
->
f‹m©
 =
¶v
->format &&

519 
˛t
->
øã
 =
¶v
->rate &&

520 
˛t
->
ch™√ls
 =
¶v
->channels &&

521 (!
∂ug
->
âabÀ
 ||Ölug->
âabÀ_ok
))

524 i‡(
	`¢d_pcm_f‹m©_löór
(
¶v
->
f‹m©
)) {

526 i‡(
˛t
->
øã
 !
¶v
->rate ||

527 
˛t
->
ch™√ls
 !
¶v
->channels ||

528 (
∂ug
->
âabÀ
 && !∂ug->
âabÀ_ok
))

530 
cfmt
 = 
˛t
->
f‹m©
;

531 
˛t
->
f‹m©
) {

532 #ifde‡
BUILD_PCM_PLUGIN_MULAW


533 
SND_PCM_FORMAT_MU_LAW
:

534 
f
 = 
¢d_pcm_muœw_›í
;

537 #ifde‡
BUILD_PCM_PLUGIN_ALAW


538 
SND_PCM_FORMAT_A_LAW
:

539 
f
 = 
¢d_pcm_Æaw_›í
;

542 #ifde‡
BUILD_PCM_PLUGIN_ADPCM


543 
SND_PCM_FORMAT_IMA_ADPCM
:

544 
f
 = 
¢d_pcm_adpcm_›í
;

547 #ifde‡
BUILD_PCM_PLUGIN_IEC958


548 
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
:

549 
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
:

550 
f
 = 
õc958_›í
;

554 #ifde‡
BUILD_PCM_PLUGIN_LFLOAT


555 i‡(
	`¢d_pcm_f‹m©_Êﬂt
(
˛t
->
f‹m©
))

556 
f
 = 
¢d_pcm_lÊﬂt_›í
;

560 
f
 = 
¢d_pcm_löór_›í
;

563 #ifde‡
BUILD_PCM_PLUGIN_LFLOAT


564 } i‡(
	`¢d_pcm_f‹m©_Êﬂt
(
¶v
->
f‹m©
)) {

565 i‡(
	`¢d_pcm_f‹m©_löór
(
˛t
->
f‹m©
)) {

566 
cfmt
 = 
˛t
->
f‹m©
;

567 
f
 = 
¢d_pcm_lÊﬂt_›í
;

568 } i‡(
˛t
->
øã
 !
¶v
->øã || c…->
ch™√ls
 != slv->channels ||

569 (
∂ug
->
âabÀ
 && !∂ug->
âabÀ_ok
)) {

570 
cfmt
 = 
SND_PCM_FORMAT_S16
;

571 
f
 = 
¢d_pcm_lÊﬂt_›í
;

573  -
EINVAL
;

575 #ifde‡
BUILD_PCM_NONLINEAR


577 
¶v
->
f‹m©
) {

578 #ifde‡
BUILD_PCM_PLUGIN_MULAW


579 
SND_PCM_FORMAT_MU_LAW
:

580 
f
 = 
¢d_pcm_muœw_›í
;

583 #ifde‡
BUILD_PCM_PLUGIN_ALAW


584 
SND_PCM_FORMAT_A_LAW
:

585 
f
 = 
¢d_pcm_Æaw_›í
;

588 #ifde‡
BUILD_PCM_PLUGIN_ADPCM


589 
SND_PCM_FORMAT_IMA_ADPCM
:

590 
f
 = 
¢d_pcm_adpcm_›í
;

593 #ifde‡
BUILD_PCM_PLUGIN_IEC958


594 
SND_PCM_FORMAT_IEC958_SUBFRAME_LE
:

595 
SND_PCM_FORMAT_IEC958_SUBFRAME_BE
:

596 
f
 = 
õc958_›í
;

600  -
EINVAL
;

602 i‡(
	`¢d_pcm_f‹m©_löór
(
˛t
->
f‹m©
))

603 
cfmt
 = 
˛t
->
f‹m©
;

605 
cfmt
 = 
SND_PCM_FORMAT_S16
;

608 
îr
 = 
	`f
(
√w
, 
NULL
, 
¶v
->
f‹m©
, 
∂ug
->
gí
.
¶ave
,Ölug->gí.¶avê!∂ug->
ªq_¶ave
);

609 i‡(
îr
 < 0)

610  
îr
;

611 
¶v
->
f‹m©
 = 
cfmt
;

612 
¶v
->
ac˚ss
 = 
˛t
->access;

614 
	}
}

616 
	$¢d_pcm_∂ug_ch™ge_ac˚ss
(
¢d_pcm_t
 *
pcm
, snd_pcm_à**
√w
, 
¢d_pcm_∂ug_∑øms_t
 *
˛t
, snd_pcm_∂ug_∑øms_à*
¶v
)

618 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

619 
îr
;

620 i‡(
˛t
->
ac˚ss
 =
¶v
->access)

622 
îr
 = 
	`¢d_pcm_c›y_›í
(
√w
, 
NULL
, 
∂ug
->
gí
.
¶ave
,Ölug->gí.¶avê!∂ug->
ªq_¶ave
);

623 i‡(
îr
 < 0)

624  
îr
;

625 
¶v
->
ac˚ss
 = 
˛t
->access;

627 
	}
}

629 #ifde‡
BUILD_PCM_PLUGIN_MMAP_EMUL


630 
	$¢d_pcm_∂ug_ch™ge_mm≠
(
¢d_pcm_t
 *
pcm
, snd_pcm_à**
√w
,

631 
¢d_pcm_∂ug_∑øms_t
 *
˛t
,

632 
¢d_pcm_∂ug_∑øms_t
 *
¶v
)

634 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

635 
îr
;

637 i‡(
˛t
->
ac˚ss
 =
¶v
->access)

640 
¶v
->
ac˚ss
) {

641 
SND_PCM_ACCESS_MMAP_INTERLEAVED
:

642 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
:

643 
SND_PCM_ACCESS_MMAP_COMPLEX
:

649 
îr
 = 
	`__¢d_pcm_mm≠_emul_›í
(
√w
, 
NULL
, 
∂ug
->
gí
.
¶ave
,

650 
∂ug
->
gí
.
¶ave
 !∂ug->
ªq_¶ave
);

651 i‡(
îr
 < 0)

652  
îr
;

653 
¶v
->
ac˚ss
) {

654 
SND_PCM_ACCESS_RW_INTERLEAVED
:

655 
¶v
->
ac˚ss
 = 
SND_PCM_ACCESS_MMAP_INTERLEAVED
;

657 
SND_PCM_ACCESS_RW_NONINTERLEAVED
:

658 
¶v
->
ac˚ss
 = 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
;

664 
	}
}

667 
	$¢d_pcm_∂ug_ö£π_∂ugös
(
¢d_pcm_t
 *
pcm
,

668 
¢d_pcm_∂ug_∑øms_t
 *
˛õ¡
,

669 
¢d_pcm_∂ug_∑øms_t
 *
¶ave
)

671 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

672 (*c⁄° 
funcs
[])(
¢d_pcm_t
 *
_pcm
, snd_pcm_à**
√w
, 
¢d_pcm_∂ug_∑øms_t
 *
s
, snd_pcm_∂ug_∑øms_à*
d
) = {

673 #ifde‡
BUILD_PCM_PLUGIN_MMAP_EMUL


674 
¢d_pcm_∂ug_ch™ge_mm≠
,

676 
¢d_pcm_∂ug_ch™ge_f‹m©
,

677 #ifde‡
BUILD_PCM_PLUGIN_ROUTE


678 
¢d_pcm_∂ug_ch™ge_ch™√ls
,

680 #ifde‡
BUILD_PCM_PLUGIN_RATE


681 
¢d_pcm_∂ug_ch™ge_øã
,

683 #ifde‡
BUILD_PCM_PLUGIN_ROUTE


684 
¢d_pcm_∂ug_ch™ge_ch™√ls
,

686 
¢d_pcm_∂ug_ch™ge_f‹m©
,

687 
¢d_pcm_∂ug_ch™ge_ac˚ss


689 
¢d_pcm_∂ug_∑øms_t
 
p
 = *
¶ave
;

690 
k
 = 0;

691 
∂ug
->
âabÀ_ok
 = 0;

692 
˛õ¡
->
f‹m©
 !
p
.format ||

693 
˛õ¡
->
ch™√ls
 !
p
.channels ||

694 
˛õ¡
->
øã
 !
p
.rate ||

695 
˛õ¡
->
ac˚ss
 !
p
.access ||

696 (
∂ug
->
âabÀ
 && !∂ug->
âabÀ_ok
)) {

697 
¢d_pcm_t
 *
√w
;

698 
îr
;

699 i‡(
k
 >(
funcs
)/(*funcs)) {

700 
	`¢d_pcm_∂ug_˛ór
(
pcm
);

701  -
EINVAL
;

703 
îr
 = 
funcs
[
k
](
pcm
, &
√w
, 
˛õ¡
, &
p
);

704 i‡(
îr
 < 0) {

705 
	`¢d_pcm_∂ug_˛ór
(
pcm
);

706  
îr
;

708 i‡(
îr
) {

709 
∂ug
->
gí
.
¶ave
 = 
√w
;

711 
k
++;

714 
	}
}

716 
	$¢d_pcm_∂ug_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

718 
øã_mö
, 
ch™√ls_max
;

719 
îr
;

722 
îr
 = 
	`¢d_pcm_hw_∑øm_gë_mö
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
, &
øã_mö
, 
NULL
);

723 i‡(
îr
 < 0)

724  
îr
;

725 i‡(
øã_mö
 < 4000) {

726 
	`_¢d_pcm_hw_∑øm_£t_mö
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
, 4000, 0);

727 i‡(
	`¢d_pcm_hw_∑øm_em±y
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
))

728  -
EINVAL
;

731 
îr
 = 
	`¢d_pcm_hw_∑øm_gë_max
(
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
, &
ch™√ls_max
, 
NULL
);

732 i‡(
îr
 < 0)

733  
îr
;

734 i‡(
ch™√ls_max
 > 10000) {

735 
	`_¢d_pcm_hw_∑øm_£t_max
(
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
, 10000, 0);

736 i‡(
	`¢d_pcm_hw_∑øm_em±y
(
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
))

737  -
EINVAL
;

740 
	}
}

742 
	$¢d_pcm_∂ug_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

744 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

745 
îr
;

747 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

748 i‡(
∂ug
->
sf‹m©
 >= 0) {

749 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
•¨ams
, 
∂ug
->
sf‹m©
);

750 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
•¨ams
, 
SND_PCM_SUBFORMAT_STD
);

752 i‡(
∂ug
->
sch™√ls
 > 0)

753 
	`_¢d_pcm_hw_∑øm_£t
(
•¨ams
, 
SND_PCM_HW_PARAM_CHANNELS
,

754 
∂ug
->
sch™√ls
, 0);

755 i‡(
∂ug
->
§©e
 > 0)

756 
	`_¢d_pcm_hw_∑øm_£t_mömax
(
•¨ams
, 
SND_PCM_HW_PARAM_RATE
,

757 
∂ug
->
§©e
, 0,Ölug->srate + 1, -1);

759 
îr
 = 
	`¢d_pcm_hw_ªföe
(
∂ug
->
ªq_¶ave
, 
•¨ams
);

760 i‡(
îr
 < 0)

761  
îr
;

763 
	}
}

765 
	$check_ac˚ss_ch™ge
(
¢d_pcm_hw_∑øms_t
 *
˝¨ams
,

766 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

768 
¢d_pcm_ac˚ss_mask_t
 *
smask
;

769 #ifde‡
BUILD_PCM_PLUGIN_MMAP_EMUL


770 c⁄° 
¢d_pcm_ac˚ss_mask_t
 *
cmask
;

771 
¢d_pcm_ac˚ss_mask_t
 
mask
;

774 
smask
 = (
¢d_pcm_ac˚ss_mask_t
 *)

775 
	`¢d_pcm_hw_∑øm_gë_mask
(
•¨ams
,

776 
SND_PCM_HW_PARAM_ACCESS
);

777 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(
smask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
) ||

778 
	`¢d_pcm_ac˚ss_mask_ã°
(
smask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
) ||

779 
	`¢d_pcm_ac˚ss_mask_ã°
(
smask
, 
SND_PCM_ACCESS_MMAP_COMPLEX
))

781 #ifde‡
BUILD_PCM_PLUGIN_MMAP_EMUL


784 i‡(!
	`¢d_pcm_ac˚ss_mask_ã°
(
smask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
) &&

785 !
	`¢d_pcm_ac˚ss_mask_ã°
(
smask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
))

786  -
EINVAL
;

788 
cmask
 = (c⁄° 
¢d_pcm_ac˚ss_mask_t
 *)

789 
	`¢d_pcm_hw_∑øm_gë_mask
(
˝¨ams
,

790 
SND_PCM_HW_PARAM_ACCESS
);

791 
	`¢d_mask_n⁄e
(&
mask
);

792 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(
cmask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
) ||

793 
	`¢d_pcm_ac˚ss_mask_ã°
(
cmask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
)) {

794 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(
smask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
))

795 
	`¢d_pcm_ac˚ss_mask_£t
(&
mask
,

796 
SND_PCM_ACCESS_RW_INTERLEAVED
);

798 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(
cmask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
) ||

799 
	`¢d_pcm_ac˚ss_mask_ã°
(
cmask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
)) {

800 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(
smask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
))

801 
	`¢d_pcm_ac˚ss_mask_£t
(&
mask
,

802 
SND_PCM_ACCESS_RW_NONINTERLEAVED
);

804 i‡(!
	`¢d_mask_em±y
(&
mask
))

805 *
smask
 = 
mask
;

808  -
EINVAL
;

810 
	}
}

812 
	$¢d_pcm_∂ug_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

813 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

815 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

816 
¢d_pcm_t
 *
¶ave
 = 
∂ug
->
ªq_¶ave
;

817 
löks
 = (
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

818 
SND_PCM_HW_PARBIT_TICK_TIME
);

819 c⁄° 
¢d_pcm_f‹m©_mask_t
 *
f‹m©_mask
, *
sf‹m©_mask
;

820 
¢d_pcm_f‹m©_mask_t
 
sfmt_mask
;

821 
îr
;

822 
¢d_pcm_f‹m©_t
 
f‹m©
;

823 
¢d_öãrvÆ_t
 
t
, 
buf„r_size
;

824 c⁄° 
¢d_öãrvÆ_t
 *
§©e
, *
¸©e
;

826 i‡(
∂ug
->
§©e
 == -2 ||

827 (
pcm
->
mode
 & 
SND_PCM_NO_AUTO_RESAMPLE
) ||

828 (
∑øms
->
Êags
 & 
SND_PCM_HW_PARAMS_NORESAMPLE
))

829 
löks
 |
SND_PCM_HW_PARBIT_RATE
;

831 
îr
 = 
	`¢d_pcm_hw_∑øm_ªföe_mu…ùÀ
(
¶ave
, 
•¨ams
, 
SND_PCM_HW_PARAM_RATE
, 
∑øms
);

832 i‡(
îr
 < 0)

833  
îr
;

836 i‡(
∂ug
->
sch™√ls
 =-2 || (
pcm
->
mode
 & 
SND_PCM_NO_AUTO_CHANNELS
))

837 
löks
 |
SND_PCM_HW_PARBIT_CHANNELS
;

839 
îr
 = 
	`¢d_pcm_hw_∑øm_ªföe_√¨
(
¶ave
, 
•¨ams
, 
SND_PCM_HW_PARAM_CHANNELS
, 
∑øms
);

840 i‡(
îr
 < 0)

841  
îr
;

843 i‡(
∂ug
->
sf‹m©
 =-2 || (
pcm
->
mode
 & 
SND_PCM_NO_AUTO_FORMAT
))

844 
löks
 |
SND_PCM_HW_PARBIT_FORMAT
;

846 
f‹m©_mask
 = 
	`¢d_pcm_hw_∑øm_gë_mask
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
);

847 
sf‹m©_mask
 = 
	`¢d_pcm_hw_∑øm_gë_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_FORMAT
);

848 
	`¢d_mask_n⁄e
(&
sfmt_mask
);

849 
f‹m©
 = 0; f‹m© <
SND_PCM_FORMAT_LAST
; format++) {

850 
¢d_pcm_f‹m©_t
 
f
;

851 i‡(!
	`¢d_pcm_f‹m©_mask_ã°
(
f‹m©_mask
, 
f‹m©
))

853 i‡(
	`¢d_pcm_f‹m©_mask_ã°
(
sf‹m©_mask
, 
f‹m©
))

854 
f
 = 
f‹m©
;

856 
f
 = 
	`¢d_pcm_∂ug_¶ave_f‹m©
(
f‹m©
, 
sf‹m©_mask
);

857 i‡(
f
 =
SND_PCM_FORMAT_UNKNOWN
)

860 
	`¢d_pcm_f‹m©_mask_£t
(&
sfmt_mask
, 
f
);

863 i‡(
	`¢d_pcm_f‹m©_mask_em±y
(&
sfmt_mask
)) {

864 
	`SNDERR
("U«bÀÅÿfödá¿ußbÀ sœvêf‹m© f‹ '%s'", 
pcm
->
«me
);

865 
f‹m©
 = 0; f‹m© <
SND_PCM_FORMAT_LAST
; format++) {

866 i‡(!
	`¢d_pcm_f‹m©_mask_ã°
(
f‹m©_mask
, 
f‹m©
))

868 
	`SNDERR
("F‹m©: %s", 
	`¢d_pcm_f‹m©_«me
(
f‹m©
));

870 
f‹m©
 = 0; f‹m© <
SND_PCM_FORMAT_LAST
; format++) {

871 i‡(!
	`¢d_pcm_f‹m©_mask_ã°
(
sf‹m©_mask
, 
f‹m©
))

873 
	`SNDERR
("Sœvêf‹m©: %s", 
	`¢d_pcm_f‹m©_«me
(
f‹m©
));

875  -
EINVAL
;

877 
îr
 = 
	`¢d_pcm_hw_∑øm_£t_mask
(
¶ave
, 
•¨ams
, 
SND_CHANGE
,

878 
SND_PCM_HW_PARAM_FORMAT
, &
sfmt_mask
);

879 i‡(
îr
 < 0)

880  -
EINVAL
;

883 i‡(
	`¢d_pcm_hw_∑øm_√vî_eq
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
, 
•¨ams
)) {

884 
îr
 = 
	`check_ac˚ss_ch™ge
(
∑øms
, 
•¨ams
);

885 i‡(
îr
 < 0) {

886 
	`SNDERR
("UnableÅo findán usableáccess for '%s'",

887 
pcm
->
«me
);

888  
îr
;

892 i‡((
löks
 & 
SND_PCM_HW_PARBIT_RATE
) ||

893 
	`¢d_pcm_hw_∑øm_Æways_eq
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
, 
•¨ams
))

894 
löks
 |(
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

895 
SND_PCM_HW_PARBIT_BUFFER_SIZE
);

897 
	`¢d_öãrvÆ_c›y
(&
buf„r_size
, 
	`¢d_pcm_hw_∑øm_gë_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
));

898 
	`¢d_öãrvÆ_unÊo‹
(&
buf„r_size
);

899 
¸©e
 = 
	`¢d_pcm_hw_∑øm_gë_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
);

900 
§©e
 = 
	`¢d_pcm_hw_∑øm_gë_öãrvÆ
(
•¨ams
, 
SND_PCM_HW_PARAM_RATE
);

901 
	`¢d_öãrvÆ_muldiv
(&
buf„r_size
, 
§©e
, 
¸©e
, &
t
);

902 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_öãrvÆ
(
•¨ams
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
t
);

903 i‡(
îr
 < 0)

904  
îr
;

906 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

907 i‡(
îr
 < 0)

908  
îr
;

910 
	}
}

912 
	$¢d_pcm_∂ug_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

913 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

914 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

916 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

917 
löks
 = (
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

918 
SND_PCM_HW_PARBIT_TICK_TIME
);

919 c⁄° 
¢d_pcm_f‹m©_mask_t
 *
f‹m©_mask
, *
sf‹m©_mask
;

920 
¢d_pcm_f‹m©_mask_t
 
fmt_mask
;

921 
îr
;

922 
¢d_pcm_f‹m©_t
 
f‹m©
;

923 
¢d_öãrvÆ_t
 
t
;

924 c⁄° 
¢d_öãrvÆ_t
 *
sbuf„r_size
;

925 c⁄° 
¢d_öãrvÆ_t
 *
§©e
, *
¸©e
;

927 i‡(
∂ug
->
sch™√ls
 =-2 || (
pcm
->
mode
 & 
SND_PCM_NO_AUTO_CHANNELS
))

928 
löks
 |
SND_PCM_HW_PARBIT_CHANNELS
;

930 i‡(
∂ug
->
sf‹m©
 =-2 || (
pcm
->
mode
 & 
SND_PCM_NO_AUTO_FORMAT
))

931 
löks
 |
SND_PCM_HW_PARBIT_FORMAT
;

933 
f‹m©_mask
 = 
	`¢d_pcm_hw_∑øm_gë_mask
(
∑øms
,

934 
SND_PCM_HW_PARAM_FORMAT
);

935 
sf‹m©_mask
 = 
	`¢d_pcm_hw_∑øm_gë_mask
(
•¨ams
,

936 
SND_PCM_HW_PARAM_FORMAT
);

937 
	`¢d_mask_n⁄e
(&
fmt_mask
);

938 
f‹m©
 = 0; f‹m© <
SND_PCM_FORMAT_LAST
; format++) {

939 
¢d_pcm_f‹m©_t
 
f
;

940 i‡(!
	`¢d_pcm_f‹m©_mask_ã°
(
f‹m©_mask
, 
f‹m©
))

942 i‡(
	`¢d_pcm_f‹m©_mask_ã°
(
sf‹m©_mask
, 
f‹m©
))

943 
f
 = 
f‹m©
;

945 
f
 = 
	`¢d_pcm_∂ug_¶ave_f‹m©
(
f‹m©
, 
sf‹m©_mask
);

946 i‡(
f
 =
SND_PCM_FORMAT_UNKNOWN
)

949 
	`¢d_pcm_f‹m©_mask_£t
(&
fmt_mask
, 
f‹m©
);

952 i‡(
	`¢d_pcm_f‹m©_mask_em±y
(&
fmt_mask
)) {

953 
	`SNDERR
("UnableÅo findán usable client format");

954 
f‹m©
 = 0; f‹m© <
SND_PCM_FORMAT_LAST
; format++) {

955 i‡(!
	`¢d_pcm_f‹m©_mask_ã°
(
f‹m©_mask
, 
f‹m©
))

957 
	`SNDERR
("F‹m©: %s", 
	`¢d_pcm_f‹m©_«me
(
f‹m©
));

959 
f‹m©
 = 0; f‹m© <
SND_PCM_FORMAT_LAST
; format++) {

960 i‡(!
	`¢d_pcm_f‹m©_mask_ã°
(
sf‹m©_mask
, 
f‹m©
))

962 
	`SNDERR
("Sœvêf‹m©: %s", 
	`¢d_pcm_f‹m©_«me
(
f‹m©
));

964  -
EINVAL
;

967 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
,

968 
SND_PCM_HW_PARAM_FORMAT
, &
fmt_mask
);

969 i‡(
îr
 < 0)

970  
îr
;

973 i‡(
∂ug
->
§©e
 == -2 ||

974 (
pcm
->
mode
 & 
SND_PCM_NO_AUTO_RESAMPLE
) ||

975 (
∑øms
->
Êags
 & 
SND_PCM_HW_PARAMS_NORESAMPLE
))

976 
löks
 |
SND_PCM_HW_PARBIT_RATE
;

978 
øã_mö
, 
§©e_mö
;

979 
øã_mödú
, 
§©e_mödú
;

982 
îr
 = 
	`¢d_pcm_hw_∑øm_gë_mö
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
, &
øã_mö
, &
øã_mödú
);

983 i‡(
îr
 < 0)

984  
îr
;

985 
îr
 = 
	`¢d_pcm_hw_∑øm_gë_mö
(
•¨ams
, 
SND_PCM_HW_PARAM_RATE
, &
§©e_mö
, &
§©e_mödú
);

986 i‡(
îr
 < 0)

987  
îr
;

988 i‡(
øã_mö
 =
§©e_mö
 && 
§©e_mödú
 > 
øã_mödú
) {

989 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mö
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
, 
§©e_mö
, 
§©e_mödú
);

990 i‡(
îr
 < 0)

991  
îr
;

994 i‡((
löks
 & 
SND_PCM_HW_PARBIT_RATE
) ||

995 
	`¢d_pcm_hw_∑øm_Æways_eq
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
, 
•¨ams
))

996 
löks
 |(
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

997 
SND_PCM_HW_PARBIT_BUFFER_SIZE
);

999 
sbuf„r_size
 = 
	`¢d_pcm_hw_∑øm_gë_öãrvÆ
(
•¨ams
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
);

1000 
¸©e
 = 
	`¢d_pcm_hw_∑øm_gë_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
);

1001 
§©e
 = 
	`¢d_pcm_hw_∑øm_gë_öãrvÆ
(
•¨ams
, 
SND_PCM_HW_PARAM_RATE
);

1002 
	`¢d_öãrvÆ_muldiv
(
sbuf„r_size
, 
¸©e
, 
§©e
, &
t
);

1003 
	`¢d_öãrvÆ_Êo‹
(&
t
);

1004 i‡(
	`¢d_öãrvÆ_em±y
(&
t
))

1005  -
EINVAL
;

1006 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
t
);

1007 i‡(
îr
 < 0)

1008  
îr
;

1010 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

1011 i‡(
îr
 < 0)

1012  
îr
;

1014 
∑øms
->
öfo
 &~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

1016 
	}
}

1018 
	$¢d_pcm_∂ug_hw_ªföe_¶ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

1020 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

1021  
	`¢d_pcm_hw_ªföe
(
∂ug
->
ªq_¶ave
, 
∑øms
);

1022 
	}
}

1024 
	$¢d_pcm_∂ug_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

1026  
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

1027 
¢d_pcm_∂ug_hw_ªföe_˝ª∑ª
,

1028 
¢d_pcm_∂ug_hw_ªföe_cch™ge
,

1029 
¢d_pcm_∂ug_hw_ªföe_•ª∑ª
,

1030 
¢d_pcm_∂ug_hw_ªföe_sch™ge
,

1031 
¢d_pcm_∂ug_hw_ªföe_¶ave
);

1032 
	}
}

1034 
	$¢d_pcm_∂ug_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

1036 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

1037 
¢d_pcm_t
 *
¶ave
 = 
∂ug
->
ªq_¶ave
;

1038 
¢d_pcm_∂ug_∑øms_t
 
˛t_∑øms
, 
¶v_∑øms
;

1039 
¢d_pcm_hw_∑øms_t
 
•¨ams
;

1040 
îr
;

1042 
îr
 = 
	`¢d_pcm_∂ug_hw_ªföe_•ª∑ª
(
pcm
, &
•¨ams
);

1043 i‡(
îr
 < 0)

1044  
îr
;

1045 
îr
 = 
	`¢d_pcm_∂ug_hw_ªföe_sch™ge
(
pcm
, 
∑øms
, &
•¨ams
);

1046 i‡(
îr
 < 0)

1047  
îr
;

1048 
îr
 = 
	`¢d_pcm_hw_ªföe_so·
(
¶ave
, &
•¨ams
);

1049 i‡(
îr
 < 0)

1050  
îr
;

1052 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_ac˚ss
)(
∑øms
, &
˛t_∑øms
.
ac˚ss
);

1053 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(
∑øms
, &
˛t_∑øms
.
f‹m©
);

1054 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_ch™√ls
)(
∑øms
, &
˛t_∑øms
.
ch™√ls
);

1055 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_øã
)(
∑øms
, &
˛t_∑øms
.
øã
, 0);

1057 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(&
•¨ams
, &
¶v_∑øms
.
f‹m©
);

1058 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_ch™√ls
)(&
•¨ams
, &
¶v_∑øms
.
ch™√ls
);

1059 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_øã
)(&
•¨ams
, &
¶v_∑øms
.
øã
, 0);

1060 
	`¢d_pcm_∂ug_˛ór
(
pcm
);

1061 i‡(!(
˛t_∑øms
.
f‹m©
 =
¶v_∑øms
.format &&

1062 
˛t_∑øms
.
ch™√ls
 =
¶v_∑øms
.channels &&

1063 
˛t_∑øms
.
øã
 =
¶v_∑øms
.rate &&

1064 !
∂ug
->
âabÀ
 &&

1065 
	`¢d_pcm_hw_∑øms_ã°_ac˚ss
(
¶ave
, &
•¨ams
,

1066 
˛t_∑øms
.
ac˚ss
) >= 0)) {

1067 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_ac˚ss_fú°
)(
¶ave
, &
•¨ams
, &
¶v_∑øms
.
ac˚ss
);

1068 
îr
 = 
	`¢d_pcm_∂ug_ö£π_∂ugös
(
pcm
, &
˛t_∑øms
, &
¶v_∑øms
);

1069 i‡(
îr
 < 0)

1070  
îr
;

1072 
¶ave
 = 
∂ug
->
gí
.slave;

1073 
îr
 = 
	`_¢d_pcm_hw_∑øms_öã∫Æ
(
¶ave
, 
∑øms
);

1074 i‡(
îr
 < 0) {

1075 
	`¢d_pcm_∂ug_˛ór
(
pcm
);

1076  
îr
;

1078 
	`¢d_pcm_u∆ök_hw_±r
(
pcm
, 
∂ug
->
ªq_¶ave
);

1079 
	`¢d_pcm_u∆ök_≠∂_±r
(
pcm
, 
∂ug
->
ªq_¶ave
);

1081 
pcm
->
Á°_›s
 = 
¶ave
->fast_ops;

1082 
pcm
->
Á°_›_¨g
 = 
¶ave
->fast_op_arg;

1083 
	`¢d_pcm_lök_hw_±r
(
pcm
, 
¶ave
);

1084 
	`¢d_pcm_lök_≠∂_±r
(
pcm
, 
¶ave
);

1086 
	}
}

1088 
	$¢d_pcm_∂ug_hw_‰ì
(
¢d_pcm_t
 *
pcm
)

1090 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

1091 
¢d_pcm_t
 *
¶ave
 = 
∂ug
->
gí
.slave;

1092 
îr
 = 
	`¢d_pcm_hw_‰ì
(
¶ave
);

1093 
	`¢d_pcm_∂ug_˛ór
(
pcm
);

1094  
îr
;

1095 
	}
}

1097 
	$¢d_pcm_∂ug_sw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 * 
∑øms
)

1099 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

1100 
¢d_pcm_t
 *
¶ave
 = 
∂ug
->
gí
.slave;

1101 
îr
 = 
	`¢d_pcm_sw_∑øms
(
¶ave
, 
∑øms
);

1102 i‡(
îr
 >= 0) {

1103 
pcm
->
Á°_›s
 = 
¶ave
->fast_ops;

1104 
pcm
->
Á°_›_¨g
 = 
¶ave
->fast_op_arg;

1106  
îr
;

1107 
	}
}

1109 
	$¢d_pcm_∂ug_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

1111 
¢d_pcm_∂ug_t
 *
∂ug
 = 
pcm
->
¥iv©e_d©a
;

1112 
	`¢d_ouçut_¥ötf
(
out
, "Plug PCM: ");

1113 
	`¢d_pcm_dump
(
∂ug
->
gí
.
¶ave
, 
out
);

1114 
	}
}

1116 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_∂ug_›s
 = {

1117 .
˛o£
 = 
¢d_pcm_∂ug_˛o£
,

1118 .
	göfo
 = 
¢d_pcm_∂ug_öfo
,

1119 .
	ghw_ªföe
 = 
¢d_pcm_∂ug_hw_ªföe
,

1120 .
	ghw_∑øms
 = 
¢d_pcm_∂ug_hw_∑øms
,

1121 .
	ghw_‰ì
 = 
¢d_pcm_∂ug_hw_‰ì
,

1122 .
	gsw_∑øms
 = 
¢d_pcm_∂ug_sw_∑øms
,

1123 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

1124 .
	gdump
 = 
¢d_pcm_∂ug_dump
,

1125 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

1126 .
	gasync
 = 
¢d_pcm_gíîic_async
,

1127 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

1128 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

1129 .
	gquîy_chm≠s
 = 
¢d_pcm_gíîic_quîy_chm≠s
,

1130 .
	ggë_chm≠
 = 
¢d_pcm_gíîic_gë_chm≠
,

1131 .
	g£t_chm≠
 = 
¢d_pcm_gíîic_£t_chm≠
,

1146 
	$¢d_pcm_∂ug_›í
(
¢d_pcm_t
 **
pcmp
,

1147 c⁄° *
«me
,

1148 
¢d_pcm_f‹m©_t
 
sf‹m©
, 
sch™√ls
, 
§©e
,

1149 c⁄° 
¢d_c⁄fig_t
 *
øã_c⁄vîãr
,

1150 
¢d_pcm_∂ug_rouã_pﬁicy
 
rouã_pﬁicy
,

1151 
¢d_pcm_rouã_âabÀ_íåy_t
 *
âabÀ
,

1152 
â_ssize
,

1153 
â_cu£d
, 
â_su£d
,

1154 
¢d_pcm_t
 *
¶ave
, 
˛o£_¶ave
)

1156 
¢d_pcm_t
 *
pcm
;

1157 
¢d_pcm_∂ug_t
 *
∂ug
;

1158 
îr
;

1159 
	`as£π
(
pcmp
 && 
¶ave
);

1161 
∂ug
 = 
	`ˇŒoc
(1, (
¢d_pcm_∂ug_t
));

1162 i‡(!
∂ug
)

1163  -
ENOMEM
;

1164 
∂ug
->
sf‹m©
 = sformat;

1165 
∂ug
->
sch™√ls
 = schannels;

1166 
∂ug
->
§©e
 = srate;

1167 
∂ug
->
gí
.
¶ave
 =Ölug->
ªq_¶ave
 = slave;

1168 
∂ug
->
gí
.
˛o£_¶ave
 = close_slave;

1169 
∂ug
->
rouã_pﬁicy
 =Ñoute_policy;

1170 
∂ug
->
âabÀ
 =Åtable;

1171 
∂ug
->
â_ssize
 =Åt_ssize;

1172 
∂ug
->
â_cu£d
 =Åt_cused;

1173 
∂ug
->
â_su£d
 =Åt_sused;

1175 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_PLUG
, 
«me
, 
¶ave
->
°ªam
, sœve->
mode
);

1176 i‡(
îr
 < 0) {

1177 
	`‰ì
(
∂ug
);

1178  
îr
;

1180 
pcm
->
›s
 = &
¢d_pcm_∂ug_›s
;

1181 
pcm
->
Á°_›s
 = 
¶ave
->fast_ops;

1182 
pcm
->
Á°_›_¨g
 = 
¶ave
->fast_op_arg;

1183 i‡(
øã_c⁄vîãr
) {

1184 
îr
 = 
	`¢d_c⁄fig_c›y
(&
∂ug
->
øã_c⁄vîãr
,

1185 (
¢d_c⁄fig_t
 *)
øã_c⁄vîãr
);

1186 i‡(
îr
 < 0) {

1187 
	`¢d_pcm_‰ì
(
pcm
);

1188 
	`‰ì
(
∂ug
);

1189  
îr
;

1192 
pcm
->
¥iv©e_d©a
 = 
∂ug
;

1193 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

1194 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

1195 
pcm
->
mm≠_shadow
 = 1;

1196 
pcm
->
t°amp_ty≥
 = 
¶ave
->tstamp_type;

1197 
	`¢d_pcm_lök_hw_±r
(
pcm
, 
¶ave
);

1198 
	`¢d_pcm_lök_≠∂_±r
(
pcm
, 
¶ave
);

1199 *
pcmp
 = 
pcm
;

1202 
	}
}

1264 
	$_¢d_pcm_∂ug_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1265 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

1266 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

1268 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1269 
îr
;

1270 
¢d_pcm_t
 *
•cm
;

1271 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

1272 
¢d_c⁄fig_t
 *
â
 = 
NULL
;

1273 
¢d_pcm_∂ug_rouã_pﬁicy
 
rouã_pﬁicy
 = 
PLUG_ROUTE_POLICY_DEFAULT
;

1274 
¢d_pcm_rouã_âabÀ_íåy_t
 *
âabÀ
 = 
NULL
;

1275 
csize
, 
ssize
;

1276 
cu£d
, 
su£d
;

1277 
¢d_pcm_f‹m©_t
 
sf‹m©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1278 
sch™√ls
 = -1, 
§©e
 = -1;

1279 c⁄° 
¢d_c⁄fig_t
 *
øã_c⁄vîãr
 = 
NULL
;

1281 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1282 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1283 c⁄° *
id
;

1284 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1286 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

1288 i‡(
	`°rcmp
(
id
, "slave") == 0) {

1289 
¶ave
 = 
n
;

1292 #ifde‡
BUILD_PCM_PLUGIN_ROUTE


1293 i‡(
	`°rcmp
(
id
, "ttable") == 0) {

1294 
rouã_pﬁicy
 = 
PLUG_ROUTE_POLICY_NONE
;

1295 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1296 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1297  -
EINVAL
;

1299 
â
 = 
n
;

1302 i‡(
	`°rcmp
(
id
, "route_policy") == 0) {

1303 c⁄° *
°r
;

1304 i‡((
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
)) < 0) {

1305 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1306  -
EINVAL
;

1308 i‡(
â
 !
NULL
)

1309 
	`SNDERR
("Table is defined,ÑouteÖolicy is ignored");

1310 i‡(!
	`°rcmp
(
°r
, "default"))

1311 
rouã_pﬁicy
 = 
PLUG_ROUTE_POLICY_DEFAULT
;

1312 i‡(!
	`°rcmp
(
°r
, "average"))

1313 
rouã_pﬁicy
 = 
PLUG_ROUTE_POLICY_AVERAGE
;

1314 i‡(!
	`°rcmp
(
°r
, "copy"))

1315 
rouã_pﬁicy
 = 
PLUG_ROUTE_POLICY_COPY
;

1316 i‡(!
	`°rcmp
(
°r
, "duplicate"))

1317 
rouã_pﬁicy
 = 
PLUG_ROUTE_POLICY_DUP
;

1321 #ifde‡
BUILD_PCM_PLUGIN_RATE


1322 i‡(
	`°rcmp
(
id
, "rate_converter") == 0) {

1323 
øã_c⁄vîãr
 = 
n
;

1327 
	`SNDERR
("Unknow¿fõld %s", 
id
);

1328  -
EINVAL
;

1330 i‡(!
¶ave
) {

1331 
	`SNDERR
("slave isÇot defined");

1332  -
EINVAL
;

1334 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 3,

1335 
SND_PCM_HW_PARAM_FORMAT
, 
SCONF_UNCHANGED
, &
sf‹m©
,

1336 
SND_PCM_HW_PARAM_CHANNELS
, 
SCONF_UNCHANGED
, &
sch™√ls
,

1337 
SND_PCM_HW_PARAM_RATE
, 
SCONF_UNCHANGED
, &
§©e
);

1338 i‡(
îr
 < 0)

1339  
îr
;

1340 #ifde‡
BUILD_PCM_PLUGIN_ROUTE


1341 i‡(
â
) {

1342 
îr
 = 
	`¢d_pcm_rouã_dëîmöe_âabÀ
(
â
, &
csize
, &
ssize
);

1343 i‡(
îr
 < 0) {

1344 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1345  
îr
;

1347 
âabÀ
 = 
	`mÆloc
(
csize
 * 
ssize
 * (*ttable));

1348 i‡(
âabÀ
 =
NULL
) {

1349 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1350  
îr
;

1352 
îr
 = 
	`¢d_pcm_rouã_lﬂd_âabÀ
(
â
, 
âabÀ
, 
csize
, 
ssize
, &
cu£d
, &
su£d
, -1);

1353 i‡(
îr
 < 0) {

1354 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1355  
îr
;

1360 #ifde‡
BUILD_PCM_PLUGIN_RATE


1361 i‡(! 
øã_c⁄vîãr
)

1362 
øã_c⁄vîãr
 = 
	`¢d_pcm_øã_gë_deÁu…_c⁄vîãr
(
roŸ
);

1365 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

1366 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1367 i‡(
îr
 < 0)

1368  
îr
;

1369 
îr
 = 
	`¢d_pcm_∂ug_›í
(
pcmp
, 
«me
, 
sf‹m©
, 
sch™√ls
, 
§©e
, 
øã_c⁄vîãr
,

1370 
rouã_pﬁicy
, 
âabÀ
, 
ssize
, 
cu£d
, 
su£d
, 
•cm
, 1);

1371 i‡(
îr
 < 0)

1372 
	`¢d_pcm_˛o£
(
•cm
);

1373  
îr
;

1374 
	}
}

1375 #i‚de‡
DOC_HIDDEN


1376 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_∂ug_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_plugin.c

85 
	~"pcm_loˇl.h
"

86 
	~"pcm_∂ugö.h
"

87 
	~<limôs.h
>

89 #i‚de‡
DOC_HIDDEN


91 
¢d_pcm_s‰ames_t


92 
	$¢d_pcm_∂ugö_undo_ªad
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

93 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
ªs_¨ós
 
ATTRIBUTE_UNUSED
,

94 
¢d_pcm_u‰ames_t
 
ªs_off£t
 
ATTRIBUTE_UNUSED
,

95 
¢d_pcm_u‰ames_t
 
ªs_size
 
ATTRIBUTE_UNUSED
,

96 
¢d_pcm_u‰ames_t
 
¶ave_undo_size
 
ATTRIBUTE_UNUSED
)

98  -
EIO
;

99 
	}
}

101 
¢d_pcm_s‰ames_t


102 
	$¢d_pcm_∂ugö_undo_wrôe
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

103 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
ªs_¨ós
 
ATTRIBUTE_UNUSED
,

104 
¢d_pcm_u‰ames_t
 
ªs_off£t
 
ATTRIBUTE_UNUSED
,

105 
¢d_pcm_u‰ames_t
 
ªs_size
 
ATTRIBUTE_UNUSED
,

106 
¢d_pcm_u‰ames_t
 
¶ave_undo_size
 
ATTRIBUTE_UNUSED
)

108  -
EIO
;

109 
	}
}

111 
¢d_pcm_s‰ames_t


112 
	$¢d_pcm_∂ugö_undo_ªad_gíîic
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

113 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
ªs_¨ós
 
ATTRIBUTE_UNUSED
,

114 
¢d_pcm_u‰ames_t
 
ªs_off£t
 
ATTRIBUTE_UNUSED
,

115 
¢d_pcm_u‰ames_t
 
ªs_size
 
ATTRIBUTE_UNUSED
,

116 
¢d_pcm_u‰ames_t
 
¶ave_undo_size
)

118  
¶ave_undo_size
;

119 
	}
}

121 
¢d_pcm_s‰ames_t


122 
	$¢d_pcm_∂ugö_undo_wrôe_gíîic
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

123 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
ªs_¨ós
 
ATTRIBUTE_UNUSED
,

124 
¢d_pcm_u‰ames_t
 
ªs_off£t
 
ATTRIBUTE_UNUSED
,

125 
¢d_pcm_u‰ames_t
 
ªs_size
 
ATTRIBUTE_UNUSED
,

126 
¢d_pcm_u‰ames_t
 
¶ave_undo_size
)

128  
¶ave_undo_size
;

129 
	}
}

131 
	$¢d_pcm_∂ugö_öô
(
¢d_pcm_∂ugö_t
 *
∂ugö
)

133 
	`mem£t
(
∂ugö
, 0, (
¢d_pcm_∂ugö_t
));

134 
∂ugö
->
undo_ªad
 = 
¢d_pcm_∂ugö_undo_ªad
;

135 
∂ugö
->
undo_wrôe
 = 
¢d_pcm_∂ugö_undo_wrôe
;

136 
	}
}

138 
	$¢d_pcm_∂ugö_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
)

140 
¢d_pcm_∂ugö_t
 *
∂ugö
 = 
pcm
->
¥iv©e_d©a
;

141 
¢d_pcm_s‰ames_t
 
sd
;

142 
îr
 = 
	`¢d_pcm_dñay
(
∂ugö
->
gí
.
¶ave
, &
sd
);

143 i‡(
îr
 < 0)

144  
îr
;

145 *
dñayp
 = 
sd
;

147 
	}
}

149 
	$¢d_pcm_∂ugö_ˇŒ_öô_cb
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_∂ugö_t
 *
∂ugö
)

151 
¢d_pcm_t
 *
¶ave
 = 
∂ugö
->
gí
.slave;

152 
îr
;

154 
	`as£π
(
pcm
->
bound¨y
 =
¶ave
->boundary);

155 *
pcm
->
hw
.
±r
 = *
¶ave
->hw.ptr;

156 *
pcm
->
≠∂
.
±r
 = *
¶ave
->appl.ptr;

157 i‡(
∂ugö
->
öô
) {

158 
îr
 = 
∂ugö
->
	`öô
(
pcm
);

159 i‡(
îr
 < 0)

160  
îr
;

163 
	}
}

165 
	$¢d_pcm_∂ugö_¥ï¨e
(
¢d_pcm_t
 *
pcm
)

167 
¢d_pcm_∂ugö_t
 *
∂ugö
 = 
pcm
->
¥iv©e_d©a
;

168 
îr
;

169 
îr
 = 
	`¢d_pcm_¥ï¨e
(
∂ugö
->
gí
.
¶ave
);

170 i‡(
îr
 < 0)

171  
îr
;

172  
	`¢d_pcm_∂ugö_ˇŒ_öô_cb
(
pcm
, 
∂ugö
);

173 
	}
}

175 
	$¢d_pcm_∂ugö_ª£t
(
¢d_pcm_t
 *
pcm
)

177 
¢d_pcm_∂ugö_t
 *
∂ugö
 = 
pcm
->
¥iv©e_d©a
;

178 
îr
;

179 
îr
 = 
	`¢d_pcm_ª£t
(
∂ugö
->
gí
.
¶ave
);

180 i‡(
îr
 < 0)

181  
îr
;

182  
	`¢d_pcm_∂ugö_ˇŒ_öô_cb
(
pcm
, 
∂ugö
);

183 
	}
}

185 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_∂ugö_ªwödabÀ
(
¢d_pcm_t
 *
pcm
)

187  
	`¢d_pcm_mm≠_hw_ªwödabÀ
(
pcm
);

188 
	}
}

190 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_∂ugö_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

192 
¢d_pcm_∂ugö_t
 *
∂ugö
 = 
pcm
->
¥iv©e_d©a
;

193 
¢d_pcm_s‰ames_t
 
n
 = 
	`¢d_pcm_∂ugö_ªwödabÀ
(
pcm
);

194 
¢d_pcm_s‰ames_t
 
s‰ames
;

196 i‡((
¢d_pcm_u‰ames_t
)
n
 < 
‰ames
)

197 
‰ames
 = 
n
;

198 i‡(
‰ames
 == 0)

201 
s‰ames
 = 
‰ames
;

202 
s‰ames
 = 
	`¢d_pcm_ªwöd
(
∂ugö
->
gí
.
¶ave
, sframes);

203 i‡(
s‰ames
 < 0)

204  
s‰ames
;

205 
	`¢d_pcm_mm≠_≠∂_backw¨d
(
pcm
, (
¢d_pcm_u‰ames_t
Ë
s‰ames
);

206  (
¢d_pcm_s‰ames_t
Ë
s‰ames
;

207 
	}
}

209 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_∂ugö_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
)

211  
	`¢d_pcm_mm≠_avaû
(
pcm
);

212 
	}
}

214 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_∂ugö_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

216 
¢d_pcm_∂ugö_t
 *
∂ugö
 = 
pcm
->
¥iv©e_d©a
;

217 
¢d_pcm_s‰ames_t
 
n
 = 
	`¢d_pcm_∂ugö_f‹w¨dabÀ
(
pcm
);

218 
¢d_pcm_s‰ames_t
 
s‰ames
;

220 i‡((
¢d_pcm_u‰ames_t
)
n
 < 
‰ames
)

221 
‰ames
 = 
n
;

222 i‡(
‰ames
 == 0)

225 
s‰ames
 = 
‰ames
;

226 
s‰ames
 = 
	`INTERNAL
(
¢d_pcm_f‹w¨d
)(
∂ugö
->
gí
.
¶ave
, sframes);

227 i‡(
s‰ames
 < 0)

228  
s‰ames
;

229 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, (
¢d_pcm_u‰ames_t
Ë
‰ames
);

230  (
¢d_pcm_s‰ames_t
Ë
‰ames
;

231 
	}
}

233 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_∂ugö_wrôe_¨ós
(
¢d_pcm_t
 *
pcm
,

234 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

235 
¢d_pcm_u‰ames_t
 
off£t
,

236 
¢d_pcm_u‰ames_t
 
size
)

238 
¢d_pcm_∂ugö_t
 *
∂ugö
 = 
pcm
->
¥iv©e_d©a
;

239 
¢d_pcm_t
 *
¶ave
 = 
∂ugö
->
gí
.slave;

240 
¢d_pcm_u‰ames_t
 
x„r
 = 0;

241 
¢d_pcm_s‰ames_t
 
ªsu…
;

242 
îr
;

244 
size
 > 0) {

245 
¢d_pcm_u‰ames_t
 
‰ames
 = 
size
;

246 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
;

247 
¢d_pcm_u‰ames_t
 
¶ave_off£t
;

248 
¢d_pcm_u‰ames_t
 
¶ave_‰ames
 = 
ULONG_MAX
;

250 
ªsu…
 = 
	`¢d_pcm_mm≠_begö
(
¶ave
, &
¶ave_¨ós
, &
¶ave_off£t
, &
¶ave_‰ames
);

251 i‡(
ªsu…
 < 0) {

252 
îr
 = 
ªsu…
;

253 
îr‹
;

255 i‡(
¶ave_‰ames
 == 0)

257 
‰ames
 = 
∂ugö
->
	`wrôe
(
pcm
, 
¨ós
, 
off£t
, frames,

258 
¶ave_¨ós
, 
¶ave_off£t
, &
¶ave_‰ames
);

259 i‡(
	`CHECK_SANITY
(
¶ave_‰ames
 > 
	`¢d_pcm_mm≠_∂ayback_avaû
(
¶ave
))) {

260 
	`SNDMSG
("wrôêovîÊow %ld > %ld", 
¶ave_‰ames
,

261 
	`¢d_pcm_mm≠_∂ayback_avaû
(
¶ave
));

262 
îr
 = -
EPIPE
;

263 
îr‹
;

265 
ªsu…
 = 
	`¢d_pcm_mm≠_commô
(
¶ave
, 
¶ave_off£t
, 
¶ave_‰ames
);

266 i‡(
ªsu…
 > 0 && (
¢d_pcm_u‰ames_t
Ïesu… !
¶ave_‰ames
) {

267 
¢d_pcm_s‰ames_t
 
ªs
;

268 
ªs
 = 
∂ugö
->
	`undo_wrôe
(
pcm
, 
¶ave_¨ós
, 
¶ave_off£t
 + 
ªsu…
, 
¶ave_‰ames
, slave_frames -Ñesult);

269 i‡(
ªs
 < 0) {

270 
îr
 = 
ªs
;

271 
îr‹
;

273 
‰ames
 -
ªs
;

275 i‡(
ªsu…
 <= 0) {

276 
îr
 = 
ªsu…
;

277 
îr‹
;

279 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
‰ames
);

280 
off£t
 +
‰ames
;

281 
x„r
 +
‰ames
;

282 
size
 -
‰ames
;

284  (
¢d_pcm_s‰ames_t
)
x„r
;

286 
îr‹
:

287  
x„r
 > 0 ? (
¢d_pcm_s‰ames_t
)x„∏: 
îr
;

288 
	}
}

290 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_∂ugö_ªad_¨ós
(
¢d_pcm_t
 *
pcm
,

291 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

292 
¢d_pcm_u‰ames_t
 
off£t
,

293 
¢d_pcm_u‰ames_t
 
size
)

295 
¢d_pcm_∂ugö_t
 *
∂ugö
 = 
pcm
->
¥iv©e_d©a
;

296 
¢d_pcm_t
 *
¶ave
 = 
∂ugö
->
gí
.slave;

297 
¢d_pcm_u‰ames_t
 
x„r
 = 0;

298 
¢d_pcm_s‰ames_t
 
ªsu…
;

299 
îr
;

301 
size
 > 0) {

302 
¢d_pcm_u‰ames_t
 
‰ames
 = 
size
;

303 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
;

304 
¢d_pcm_u‰ames_t
 
¶ave_off£t
;

305 
¢d_pcm_u‰ames_t
 
¶ave_‰ames
 = 
ULONG_MAX
;

307 
ªsu…
 = 
	`¢d_pcm_mm≠_begö
(
¶ave
, &
¶ave_¨ós
, &
¶ave_off£t
, &
¶ave_‰ames
);

308 i‡(
ªsu…
 < 0) {

309 
îr
 = 
ªsu…
;

310 
îr‹
;

312 i‡(
¶ave_‰ames
 == 0)

314 
‰ames
 = (
∂ugö
->
ªad
)(
pcm
, 
¨ós
, 
off£t
, frames,

315 
¶ave_¨ós
, 
¶ave_off£t
, &
¶ave_‰ames
);

316 i‡(
	`CHECK_SANITY
(
¶ave_‰ames
 > 
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
¶ave
))) {

317 
	`SNDMSG
("ªad ovîÊow %ld > %ld", 
¶ave_‰ames
,

318 
	`¢d_pcm_mm≠_∂ayback_avaû
(
¶ave
));

319 
îr
 = -
EPIPE
;

320 
îr‹
;

322 
ªsu…
 = 
	`¢d_pcm_mm≠_commô
(
¶ave
, 
¶ave_off£t
, 
¶ave_‰ames
);

323 i‡(
ªsu…
 > 0 && (
¢d_pcm_u‰ames_t
Ïesu… !
¶ave_‰ames
) {

324 
¢d_pcm_s‰ames_t
 
ªs
;

326 
ªs
 = 
∂ugö
->
	`undo_ªad
(
¶ave
, 
¨ós
, 
off£t
, 
‰ames
, 
¶ave_‰ames
 - 
ªsu…
);

327 i‡(
ªs
 < 0) {

328 
îr
 = 
ªs
;

329 
îr‹
;

331 
‰ames
 -
ªs
;

333 i‡(
ªsu…
 <= 0) {

334 
îr
 = 
ªsu…
;

335 
îr‹
;

337 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
‰ames
);

338 
off£t
 +
‰ames
;

339 
x„r
 +
‰ames
;

340 
size
 -
‰ames
;

342  (
¢d_pcm_s‰ames_t
)
x„r
;

344 
îr‹
:

345  
x„r
 > 0 ? (
¢d_pcm_s‰ames_t
)x„∏: 
îr
;

346 
	}
}

349 
¢d_pcm_s‰ames_t


350 
	$¢d_pcm_∂ugö_wrôei
(
¢d_pcm_t
 *
pcm
, c⁄° *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

352 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

353 
	`¢d_pcm_¨ós_‰om_buf
(
pcm
, 
¨ós
, (*)
buf„r
);

354  
	`¢d_pcm_wrôe_¨ós
(
pcm
, 
¨ós
, 0, 
size
,

355 
¢d_pcm_∂ugö_wrôe_¨ós
);

356 
	}
}

358 
¢d_pcm_s‰ames_t


359 
	$¢d_pcm_∂ugö_wrôí
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

361 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

362 
	`¢d_pcm_¨ós_‰om_bufs
(
pcm
, 
¨ós
, 
bufs
);

363  
	`¢d_pcm_wrôe_¨ós
(
pcm
, 
¨ós
, 0, 
size
,

364 
¢d_pcm_∂ugö_wrôe_¨ós
);

365 
	}
}

367 
¢d_pcm_s‰ames_t


368 
	$¢d_pcm_∂ugö_ªadi
(
¢d_pcm_t
 *
pcm
, *
buf„r
, 
¢d_pcm_u‰ames_t
 
size
)

370 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

371 
	`¢d_pcm_¨ós_‰om_buf
(
pcm
, 
¨ós
, 
buf„r
);

372  
	`¢d_pcm_ªad_¨ós
(
pcm
, 
¨ós
, 0, 
size
,

373 
¢d_pcm_∂ugö_ªad_¨ós
);

374 
	}
}

376 
¢d_pcm_s‰ames_t


377 
	$¢d_pcm_∂ugö_ªadn
(
¢d_pcm_t
 *
pcm
, **
bufs
, 
¢d_pcm_u‰ames_t
 
size
)

379 
¢d_pcm_ch™√l_¨ó_t
 
¨ós
[
pcm
->
ch™√ls
];

380 
	`¢d_pcm_¨ós_‰om_bufs
(
pcm
, 
¨ós
, 
bufs
);

381  
	`¢d_pcm_ªad_¨ós
(
pcm
, 
¨ós
, 0, 
size
,

382 
¢d_pcm_∂ugö_ªad_¨ós
);

383 
	}
}

385 
¢d_pcm_s‰ames_t


386 
	$¢d_pcm_∂ugö_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

387 
¢d_pcm_u‰ames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

388 
¢d_pcm_u‰ames_t
 
size
)

390 
¢d_pcm_∂ugö_t
 *
∂ugö
 = 
pcm
->
¥iv©e_d©a
;

391 
¢d_pcm_t
 *
¶ave
 = 
∂ugö
->
gí
.slave;

392 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
;

393 
¢d_pcm_u‰ames_t
 
≠∂_off£t
;

394 
¢d_pcm_s‰ames_t
 
¶ave_size
;

395 
¢d_pcm_s‰ames_t
 
x„r
;

396 
îr
;

398 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_CAPTURE
) {

399 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
size
);

400  
size
;

402 
¶ave_size
 = 
	`¢d_pcm_avaû_upd©e
(
¶ave
);

403 i‡(
¶ave_size
 < 0)

404  
¶ave_size
;

405 
¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

406 
≠∂_off£t
 = 
	`¢d_pcm_mm≠_off£t
(
pcm
);

407 
x„r
 = 0;

408 
size
 > 0 && 
¶ave_size
 > 0) {

409 
¢d_pcm_u‰ames_t
 
‰ames
 = 
size
;

410 
¢d_pcm_u‰ames_t
 
c⁄t
 = 
pcm
->
buf„r_size
 - 
≠∂_off£t
;

411 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
;

412 
¢d_pcm_u‰ames_t
 
¶ave_off£t
;

413 
¢d_pcm_u‰ames_t
 
¶ave_‰ames
 = 
ULONG_MAX
;

414 
¢d_pcm_s‰ames_t
 
ªsu…
;

416 
ªsu…
 = 
	`¢d_pcm_mm≠_begö
(
¶ave
, &
¶ave_¨ós
, &
¶ave_off£t
, &
¶ave_‰ames
);

417 i‡(
ªsu…
 < 0) {

418 
îr
 = 
ªsu…
;

419 
îr‹
;

421 i‡(
‰ames
 > 
c⁄t
)

422 
‰ames
 = 
c⁄t
;

423 
‰ames
 = 
∂ugö
->
	`wrôe
(
pcm
, 
¨ós
, 
≠∂_off£t
, frames,

424 
¶ave_¨ós
, 
¶ave_off£t
, &
¶ave_‰ames
);

425 
ªsu…
 = 
	`¢d_pcm_mm≠_commô
(
¶ave
, 
¶ave_off£t
, 
¶ave_‰ames
);

426 i‡(
ªsu…
 > 0 && (
¢d_pcm_u‰ames_t
Ïesu… !
¶ave_‰ames
) {

427 
¢d_pcm_s‰ames_t
 
ªs
;

429 
ªs
 = 
∂ugö
->
	`undo_wrôe
(
pcm
, 
¶ave_¨ós
, 
¶ave_off£t
 + 
ªsu…
, 
¶ave_‰ames
, slave_frames -Ñesult);

430 i‡(
ªs
 < 0) {

431 
îr
 = 
ªs
;

432 
îr‹
;

434 
‰ames
 -
ªs
;

436 i‡(
ªsu…
 <= 0) {

437 
îr
 = 
ªsu…
;

438 
îr‹
;

440 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
‰ames
);

441 i‡(
‰ames
 =
c⁄t
)

442 
≠∂_off£t
 = 0;

444 
≠∂_off£t
 +
ªsu…
;

445 
size
 -
‰ames
;

446 
¶ave_size
 -
‰ames
;

447 
x„r
 +
‰ames
;

449 i‡(
	`CHECK_SANITY
(
size
)) {

450 
	`SNDMSG
("sh‹àcommô: %ld", 
size
);

451  -
EPIPE
;

453  
x„r
;

455 
îr‹
:

456  
x„r
 > 0 ? x„∏: 
îr
;

457 
	}
}

459 
¢d_pcm_s‰ames_t


460 
	$¢d_pcm_∂ugö_sync_hw_±r_ˇ±uª
(
¢d_pcm_t
 *
pcm
,

461 
¢d_pcm_s‰ames_t
 
¶ave_size
)

463 
¢d_pcm_∂ugö_t
 *
∂ugö
 = 
pcm
->
¥iv©e_d©a
;

464 
¢d_pcm_t
 *
¶ave
 = 
∂ugö
->
gí
.slave;

465 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
;

466 
¢d_pcm_u‰ames_t
 
x„r
, 
hw_off£t
, 
size
;

467 
îr
;

469 
x„r
 = 
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
pcm
);

470 
size
 = 
pcm
->
buf„r_size
 - 
x„r
;

471 
¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

472 
hw_off£t
 = 
	`¢d_pcm_mm≠_hw_off£t
(
pcm
);

473 
size
 > 0 && 
¶ave_size
 > 0) {

474 
¢d_pcm_u‰ames_t
 
‰ames
 = 
size
;

475 
¢d_pcm_u‰ames_t
 
c⁄t
 = 
pcm
->
buf„r_size
 - 
hw_off£t
;

476 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
;

477 
¢d_pcm_u‰ames_t
 
¶ave_off£t
;

478 
¢d_pcm_u‰ames_t
 
¶ave_‰ames
 = 
ULONG_MAX
;

479 
¢d_pcm_s‰ames_t
 
ªsu…
;

487 
¶ave_size
 = 
	`¢d_pcm_avaû_upd©e
(
¶ave
);

488 
ªsu…
 = 
	`¢d_pcm_mm≠_begö
(
¶ave
, &
¶ave_¨ós
, &
¶ave_off£t
, &
¶ave_‰ames
);

489 i‡(
ªsu…
 < 0) {

490 
îr
 = 
ªsu…
;

491 
îr‹
;

493 i‡(
‰ames
 > 
c⁄t
)

494 
‰ames
 = 
c⁄t
;

495 
‰ames
 = (
∂ugö
->
ªad
)(
pcm
, 
¨ós
, 
hw_off£t
, frames,

496 
¶ave_¨ós
, 
¶ave_off£t
, &
¶ave_‰ames
);

497 
ªsu…
 = 
	`¢d_pcm_mm≠_commô
(
¶ave
, 
¶ave_off£t
, 
¶ave_‰ames
);

498 i‡(
ªsu…
 > 0 && (
¢d_pcm_u‰ames_t
Ïesu… !
¶ave_‰ames
) {

499 
¢d_pcm_s‰ames_t
 
ªs
;

500 
ªs
 = 
∂ugö
->
	`undo_ªad
(
¶ave
, 
¨ós
, 
hw_off£t
, 
‰ames
, 
¶ave_‰ames
 - 
ªsu…
);

501 i‡(
ªs
 < 0) {

502 
îr
 = 
ªs
;

503 
îr‹
;

505 
‰ames
 -
ªs
;

507 i‡(
ªsu…
 <= 0) {

508 
îr
 = 
ªsu…
;

509 
îr‹
;

511 
	`¢d_pcm_mm≠_hw_f‹w¨d
(
pcm
, 
‰ames
);

512 i‡(
‰ames
 =
c⁄t
)

513 
hw_off£t
 = 0;

515 
hw_off£t
 +
‰ames
;

516 
size
 -
‰ames
;

517 
¶ave_size
 -
¶ave_‰ames
;

518 
x„r
 +
‰ames
;

520  (
¢d_pcm_s‰ames_t
)
x„r
;

521 
îr‹
:

522  
x„r
 > 0 ? (
¢d_pcm_s‰ames_t
)x„∏: 
îr
;

523 
	}
}

525 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_∂ugö_sync_hw_±r
(
¢d_pcm_t
 *
pcm
,

526 
¢d_pcm_u‰ames_t
 
¶ave_hw_±r
,

527 
¢d_pcm_s‰ames_t
 
¶ave_size
)

529 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_CAPTURE
 &&

530 
pcm
->
ac˚ss
 !
SND_PCM_ACCESS_RW_INTERLEAVED
 &&

531 
pcm
->
ac˚ss
 !
SND_PCM_ACCESS_RW_NONINTERLEAVED
)

532  
	`¢d_pcm_∂ugö_sync_hw_±r_ˇ±uª
(
pcm
, 
¶ave_size
);

533 *
pcm
->
hw
.
±r
 = 
¶ave_hw_±r
;

534  
¶ave_size
;

535 
	}
}

537 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_∂ugö_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

539 
¢d_pcm_∂ugö_t
 *
∂ugö
 = 
pcm
->
¥iv©e_d©a
;

540 
¢d_pcm_t
 *
¶ave
 = 
∂ugö
->
gí
.slave;

541 
¢d_pcm_s‰ames_t
 
¶ave_size
;

543 
¶ave_size
 = 
	`¢d_pcm_avaû_upd©e
(
¶ave
);

544  
	`¢d_pcm_∂ugö_sync_hw_±r
(
pcm
, *
¶ave
->
hw
.
±r
, 
¶ave_size
);

545 
	}
}

547 
	$¢d_pcm_∂ugö_°©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©us_t
 * 
°©us
)

549 
¢d_pcm_∂ugö_t
 *
∂ugö
 = 
pcm
->
¥iv©e_d©a
;

550 
¢d_pcm_s‰ames_t
 
îr
, 
diff
;

552 
îr
 = 
	`¢d_pcm_°©us
(
∂ugö
->
gí
.
¶ave
, 
°©us
);

553 i‡(
îr
 < 0)

554  
îr
;

555 
	`¢d_pcm_∂ugö_sync_hw_±r
(
pcm
, 
°©us
->
hw_±r
, sètus->
avaû
);

566 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_CAPTURE
) {

567 
diff
 = 
	`pcm_‰ame_diff
(
°©us
->
≠∂_±r
, *
pcm
->
≠∂
.
±r
,Öcm->
bound¨y
);

568 
°©us
->
≠∂_±r
 = *
pcm
->
≠∂
.
±r
;

569 
°©us
->
avaû
 +
diff
;

570 
°©us
->
dñay
 +
diff
;

572 
	`as£π
(
°©us
->
≠∂_±r
 =*
pcm
->
≠∂
.
±r
);

575 
	}
}

577 
¢d_pcm_∂ugö_may_waô_f‹_avaû_mö_c⁄v
(

578 
¢d_pcm_t
 *
pcm
,

579 
¢d_pcm_u‰ames_t
 
avaû
,

580 
	$¢d_pcm_u‰ames_t
 (*
c⁄v
)(
¢d_pcm_t
 *, 
¢d_pcm_u‰ames_t
))

582 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_CAPTURE
 &&

583 
pcm
->
ac˚ss
 !
SND_PCM_ACCESS_RW_INTERLEAVED
 &&

584 
pcm
->
ac˚ss
 !
SND_PCM_ACCESS_RW_NONINTERLEAVED
) {

600 
¢d_pcm_gíîic_t
 *
gíîic
 = 
pcm
->
¥iv©e_d©a
;

605 
¢d_pcm_t
 *
¶ave
 = 
gíîic
->slave;

606 
¢d_pcm_u‰ames_t
 
√eded_¶ave_avaû_mö
;

607 
¢d_pcm_s‰ames_t
 
avaûabÀ
;

612 
avaûabÀ
 = 
	`¢d_pcm_avaû_upd©e
(
pcm
);

613 i‡(
avaûabÀ
 < 0)

616 i‡((
¢d_pcm_u‰ames_t
)
avaûabÀ
 >
pcm
->
avaû_mö
)

622 
√eded_¶ave_avaû_mö
 = 
pcm
->
avaû_mö
 - 
avaûabÀ
;

628 i‡(
c⁄v
)

629 
√eded_¶ave_avaû_mö
 = 
	`c⁄v
(
pcm
,Çeeded_slave_avail_min);

631 i‡(
¶ave
->
avaû_mö
 !
√eded_¶ave_avaû_mö
) {

632 
¢d_pcm_sw_∑øms_t
 *
sw∑øms
;

633 
	`¢d_pcm_sw_∑øms_Æloˇ
(&
sw∑øms
);

638 
	`¢d_pcm_sw_∑øms_cuºít
(
¶ave
, 
sw∑øms
);

645 
sw∑øms
->
avaû_mö
 = 
√eded_¶ave_avaû_mö
;

646 
	`¢d_pcm_sw_∑øms
(
¶ave
, 
sw∑øms
);

648 
avaû
 = 
avaûabÀ
;

650  
	`¢d_pcm_gíîic_may_waô_f‹_avaû_mö
(
pcm
, 
avaû
);

651 
	}
}

653 
	$¢d_pcm_∂ugö_may_waô_f‹_avaû_mö
(
¢d_pcm_t
 *
pcm
,

654 
¢d_pcm_u‰ames_t
 
avaû
)

656  
	`¢d_pcm_∂ugö_may_waô_f‹_avaû_mö_c⁄v
(
pcm
, 
avaû
, 
NULL
);

657 
	}
}

659 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_∂ugö_Á°_›s
 = {

660 .
°©us
 = 
¢d_pcm_∂ugö_°©us
,

661 .
	g°©e
 = 
¢d_pcm_gíîic_°©e
,

662 .
	ghwsync
 = 
¢d_pcm_gíîic_hwsync
,

663 .
	gdñay
 = 
¢d_pcm_∂ugö_dñay
,

664 .
	g¥ï¨e
 = 
¢d_pcm_∂ugö_¥ï¨e
,

665 .
	gª£t
 = 
¢d_pcm_∂ugö_ª£t
,

666 .
	g°¨t
 = 
¢d_pcm_gíîic_°¨t
,

667 .
	gdr›
 = 
¢d_pcm_gíîic_dr›
,

668 .
	gdøö
 = 
¢d_pcm_gíîic_døö
,

669 .
	g∑u£
 = 
¢d_pcm_gíîic_∑u£
,

670 .
	gªwödabÀ
 = 
¢d_pcm_∂ugö_ªwödabÀ
,

671 .
	gªwöd
 = 
¢d_pcm_∂ugö_ªwöd
,

672 .
	gf‹w¨dabÀ
 = 
¢d_pcm_∂ugö_f‹w¨dabÀ
,

673 .
	gf‹w¨d
 = 
¢d_pcm_∂ugö_f‹w¨d
,

674 .
	gªsume
 = 
¢d_pcm_gíîic_ªsume
,

675 .
	glök
 = 
¢d_pcm_gíîic_lök
,

676 .
	glök_¶aves
 = 
¢d_pcm_gíîic_lök_¶aves
,

677 .
	gu∆ök
 = 
¢d_pcm_gíîic_u∆ök
,

678 .
	gwrôei
 = 
¢d_pcm_∂ugö_wrôei
,

679 .
	gwrôí
 = 
¢d_pcm_∂ugö_wrôí
,

680 .
	gªadi
 = 
¢d_pcm_∂ugö_ªadi
,

681 .
	gªadn
 = 
¢d_pcm_∂ugö_ªadn
,

682 .
	gavaû_upd©e
 = 
¢d_pcm_∂ugö_avaû_upd©e
,

683 .
	gmm≠_commô
 = 
¢d_pcm_∂ugö_mm≠_commô
,

684 .
	ghtime°amp
 = 
¢d_pcm_gíîic_htime°amp
,

685 .
	gpﬁl_des¸ùt‹s_cou¡
 = 
¢d_pcm_gíîic_pﬁl_des¸ùt‹s_cou¡
,

686 .
	gpﬁl_des¸ùt‹s
 = 
¢d_pcm_gíîic_pﬁl_des¸ùt‹s
,

687 .
	gpﬁl_ªvíts
 = 
¢d_pcm_gíîic_pﬁl_ªvíts
,

688 .
	gmay_waô_f‹_avaû_mö
 = 
¢d_pcm_∂ugö_may_waô_f‹_avaû_mö
,

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_plugin.h

22 
	~"pcm_gíîic.h
"

24 
	$¢d_pcm_u‰ames_t
 (*
	t¢d_pcm_¶ave_x„r_¨ós_func_t
)

25 (
	t¢d_pcm_t
 *
	tpcm
,

26 c⁄° 
	t¢d_pcm_ch™√l_¨ó_t
 *
	t¨ós
,

27 
	t¢d_pcm_u‰ames_t
 
	toff£t
,

28 
	t¢d_pcm_u‰ames_t
 
	tsize
,

29 c⁄° 
	t¢d_pcm_ch™√l_¨ó_t
 *
	t¶ave_¨ós
,

30 
	t¢d_pcm_u‰ames_t
 
	t¶ave_off£t
,

31 
	t¢d_pcm_u‰ames_t
 *
	t¶ave_sizï
);

33 
	$¢d_pcm_s‰ames_t
 (*
	t¢d_pcm_¶ave_x„r_¨ós_undo_func_t
)

34 (
	t¢d_pcm_t
 *
	tpcm
,

35 c⁄° 
	t¢d_pcm_ch™√l_¨ó_t
 *
	tªs_¨ós
,

36 
	t¢d_pcm_u‰ames_t
 
	tªs_off£t
,

37 
	t¢d_pcm_u‰ames_t
 
	tªs_size
,

38 
	t¢d_pcm_u‰ames_t
 
	t¶ave_undo_size
);

41 
¢d_pcm_gíîic_t
 
gí
;

42 
¢d_pcm_¶ave_x„r_¨ós_func_t
 
ªad
;

43 
¢d_pcm_¶ave_x„r_¨ós_func_t
 
wrôe
;

44 
¢d_pcm_¶ave_x„r_¨ós_undo_func_t
 
undo_ªad
;

45 
¢d_pcm_¶ave_x„r_¨ós_undo_func_t
 
undo_wrôe
;

46 (*
öô
)(
¢d_pcm_t
 *
pcm
);

47 
¢d_pcm_u‰ames_t
 
≠∂_±r
, 
hw_±r
;

48 } 
	t¢d_pcm_∂ugö_t
;

51 
	#¢d_pcm_∂ugö_öô
 \

52 
¢d1_pcm_∂ugö_öô


	)

53 
	#¢d_pcm_∂ugö_may_waô_f‹_avaû_mö_c⁄v
 \

54 
¢d1_pcm_∂ugö_may_waô_f‹_avaû_mö_c⁄v


	)

55 
	#¢d_pcm_∂ugö_may_waô_f‹_avaû_mö
 \

56 
¢d1_pcm_∂ugö_may_waô_f‹_avaû_mö


	)

57 
	#¢d_pcm_∂ugö_Á°_›s
 \

58 
¢d1_pcm_∂ugö_Á°_›s


	)

59 
	#¢d_pcm_∂ugö_undo_ªad_gíîic
 \

60 
¢d1_pcm_∂ugö_undo_ªad_gíîic


	)

61 
	#¢d_pcm_∂ugö_undo_wrôe_gíîic
 \

62 
¢d1_pcm_∂ugö_undo_wrôe_gíîic


	)

63 
	#¢d_pcm_∂ugö_ªwöd
 \

64 
¢d1_pcm_∂ugö_ªwöd


	)

65 
	#¢d_pcm_∂ugö_f‹w¨d
 \

66 
¢d1_pcm_∂ugö_f‹w¨d


	)

68 
	`¢d_pcm_∂ugö_öô
(
¢d_pcm_∂ugö_t
 *
∂ugö
);

69 
¢d_pcm_s‰ames_t
 
	`¢d_pcm_∂ugö_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
);

70 
¢d_pcm_s‰ames_t
 
	`¢d_pcm_∂ugö_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
);

71 
	`¢d_pcm_∂ugö_may_waô_f‹_avaû_mö_c⁄v
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
avaû
,

72 
	$¢d_pcm_u‰ames_t
 (*
c⁄v
)(
¢d_pcm_t
 *, 
¢d_pcm_u‰ames_t
));

73 
	`¢d_pcm_∂ugö_may_waô_f‹_avaû_mö
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
avaû
);

75 c⁄° 
¢d_pcm_Á°_›s_t
 
¢d_pcm_∂ugö_Á°_›s
;

77 
¢d_pcm_s‰ames_t
 
¢d_pcm_∂ugö_undo_ªad_gíîic


78 (
¢d_pcm_t
 *
pcm
,

79 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
ªs_¨ós
,

80 
¢d_pcm_u‰ames_t
 
ªs_off£t
,

81 
¢d_pcm_u‰ames_t
 
ªs_size
,

82 
¢d_pcm_u‰ames_t
 
¶ave_undo_size
);

84 
¢d_pcm_s‰ames_t
 
¢d_pcm_∂ugö_undo_wrôe_gíîic


85 (
¢d_pcm_t
 *
pcm
,

86 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
ªs_¨ós
,

87 
¢d_pcm_u‰ames_t
 
ªs_off£t
,

88 
¢d_pcm_u‰ames_t
 
ªs_size
,

89 
¢d_pcm_u‰ames_t
 
¶ave_undo_size
);

92 
	#¢d_pcm_löór_gë_ödex
 
¢d1_pcm_löór_gë_ödex


	)

93 
	#¢d_pcm_löór_put_ödex
 
¢d1_pcm_löór_put_ödex


	)

94 
	#¢d_pcm_löór_c⁄vît_ödex
 
¢d1_pcm_löór_c⁄vît_ödex


	)

95 
	#¢d_pcm_löór_c⁄vît
 
¢d1_pcm_löór_c⁄vît


	)

96 
	#¢d_pcm_löór_gëput
 
¢d1_pcm_löór_gëput


	)

97 
	#¢d_pcm_Æaw_decode
 
¢d1_pcm_Æaw_decode


	)

98 
	#¢d_pcm_Æaw_ícode
 
¢d1_pcm_Æaw_ícode


	)

99 
	#¢d_pcm_muœw_decode
 
¢d1_pcm_muœw_decode


	)

100 
	#¢d_pcm_muœw_ícode
 
¢d1_pcm_muœw_ícode


	)

101 
	#¢d_pcm_adpcm_decode
 
¢d1_pcm_adpcm_decode


	)

102 
	#¢d_pcm_adpcm_ícode
 
¢d1_pcm_adpcm_ícode


	)

104 
	`¢d_pcm_löór_gë_ödex
(
¢d_pcm_f‹m©_t
 
§c_f‹m©
, snd_pcm_f‹m©_à
d°_f‹m©
);

105 
	`¢d_pcm_löór_put_ödex
(
¢d_pcm_f‹m©_t
 
§c_f‹m©
, snd_pcm_f‹m©_à
d°_f‹m©
);

106 
	`¢d_pcm_löór_c⁄vît_ödex
(
¢d_pcm_f‹m©_t
 
§c_f‹m©
, snd_pcm_f‹m©_à
d°_f‹m©
);

108 
	`¢d_pcm_löór_c⁄vît
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
, 
¢d_pcm_u‰ames_t
 
d°_off£t
,

109 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
, 
¢d_pcm_u‰ames_t
 
§c_off£t
,

110 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

111 
c⁄vidx
);

112 
	`¢d_pcm_löór_gëput
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
, 
¢d_pcm_u‰ames_t
 
d°_off£t
,

113 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
, 
¢d_pcm_u‰ames_t
 
§c_off£t
,

114 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

115 
gë_idx
, 
put_idx
);

116 
	`¢d_pcm_Æaw_decode
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

117 
¢d_pcm_u‰ames_t
 
d°_off£t
,

118 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

119 
¢d_pcm_u‰ames_t
 
§c_off£t
,

120 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

121 
putidx
);

122 
	`¢d_pcm_Æaw_ícode
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

123 
¢d_pcm_u‰ames_t
 
d°_off£t
,

124 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

125 
¢d_pcm_u‰ames_t
 
§c_off£t
,

126 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

127 
gëidx
);

128 
	`¢d_pcm_muœw_decode
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

129 
¢d_pcm_u‰ames_t
 
d°_off£t
,

130 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

131 
¢d_pcm_u‰ames_t
 
§c_off£t
,

132 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

133 
putidx
);

134 
	`¢d_pcm_muœw_ícode
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

135 
¢d_pcm_u‰ames_t
 
d°_off£t
,

136 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

137 
¢d_pcm_u‰ames_t
 
§c_off£t
,

138 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

139 
gëidx
);

141 
	s_¢d_pcm_adpcm_°©e
 {

142 
¥ed_vÆ
;

143 
°ï_idx
;

144 } 
	t¢d_pcm_adpcm_°©e_t
;

146 
	`¢d_pcm_adpcm_decode
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

147 
¢d_pcm_u‰ames_t
 
d°_off£t
,

148 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

149 
¢d_pcm_u‰ames_t
 
§c_off£t
,

150 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

151 
putidx
,

152 
¢d_pcm_adpcm_°©e_t
 *
°©es
);

153 
	`¢d_pcm_adpcm_ícode
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

154 
¢d_pcm_u‰ames_t
 
d°_off£t
,

155 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

156 
¢d_pcm_u‰ames_t
 
§c_off£t
,

157 
ch™√ls
, 
¢d_pcm_u‰ames_t
 
‰ames
,

158 
gëidx
,

159 
¢d_pcm_adpcm_°©e_t
 *
°©es
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_rate.c

30 
	~"pcm_loˇl.h
"

31 
	~"pcm_∂ugö.h
"

32 
	~"pcm_øã.h
"

33 
	~"∂ugö_›s.h
"

34 
	~"bsw≠.h
"

35 
	~<öây≥s.h
>

38 
	#DEBUG_REFINE


	)

41 #i‚de‡
PIC


43 c⁄° *
	g_¢d_moduÀ_pcm_øã
 = "";

46 #i‚de‡
DOC_HIDDEN


48 
_¢d_pcm_øã
 
	t¢d_pcm_øã_t
;

50 
	s_¢d_pcm_øã
 {

51 
¢d_pcm_gíîic_t
 
	mgí
;

52 
¢d_pcm_u‰ames_t
 
	m≠∂_±r
, 
	mhw_±r
, 
	mœ°_¶ave_hw_±r
;

53 
¢d_pcm_u‰ames_t
 
	mœ°_commô_±r
;

54 
¢d_pcm_u‰ames_t
 
	m‹ig_avaû_mö
;

55 
¢d_pcm_sw_∑øms_t
 
	msw_∑øms
;

56 
¢d_pcm_f‹m©_t
 
	msf‹m©
;

57 
	m§©e
;

58 
¢d_pcm_ch™√l_¨ó_t
 *
	m∑ªas
;

59 
¢d_pcm_ch™√l_¨ó_t
 *
	mßªas
;

60 
¢d_pcm_øã_öfo_t
 
	möfo
;

61 *
	m›í_func
;

62 *
	mobj
;

63 
¢d_pcm_øã_›s_t
 
	m›s
;

64 
	m§c_c⁄v_idx
;

65 
	md°_c⁄v_idx
;

66 
¢d_pcm_ch™√l_¨ó_t
 *
	m§c_buf
;

67 
¢d_pcm_ch™√l_¨ó_t
 *
	md°_buf
;

68 
	m°¨t_≥ndög
;

69 
¢d_htime°amp_t
 
	måiggî_t°amp
;

70 
	m∂ugö_vîsi⁄
;

71 
	møã_mö
, 
	møã_max
;

72 
¢d_pcm_f‹m©_t
 
	m‹ig_ö_f‹m©
;

73 
¢d_pcm_f‹m©_t
 
	m‹ig_out_f‹m©
;

74 
uöt64_t
 
	mö_f‹m©s
;

75 
uöt64_t
 
	mout_f‹m©s
;

76 
	mf‹m©_Êags
;

79 
	#SND_PCM_RATE_PLUGIN_VERSION_OLD
 0x010001

	)

83 
¢d_pcm_ch™√l_¨ó_t
 *

84 
	$øã_Æloc_tmp_buf
(
¢d_pcm_f‹m©_t
 
f‹m©
,

85 
ch™√ls
, 
‰ames
)

87 
¢d_pcm_ch™√l_¨ó_t
 *
≠
;

88 
width
 = 
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
);

89 
i
;

91 
≠
 = 
	`mÆloc
((*≠Ë* 
ch™√ls
);

92 i‡(!
≠
)

93  
NULL
;

94 
≠
->
addr
 = 
	`mÆloc
(
‰ames
 * 
ch™√ls
 * 
width
 / 8);

95 i‡(!
≠
->
addr
) {

96 
	`‰ì
(
≠
);

97  
NULL
;

101 
i
 = 0; i < 
ch™√ls
; i++) {

102 
≠
[
i
].
addr
 =áp[0].add∏+ (ò* 
width
) / 8;

103 
≠
[
i
].
fú°
 = 0;

104 
≠
[
i
].
°ï
 = 
width
 * 
ch™√ls
;

107  
≠
;

108 
	}
}

110 
	$øã_‰ì_tmp_buf
(
¢d_pcm_ch™√l_¨ó_t
 **
±r
)

112 
¢d_pcm_ch™√l_¨ó_t
 *
c
 = *
±r
;

114 i‡(
c
) {

115 
	`‰ì
(
c
->
addr
);

116 
	`‰ì
(
c
);

117 *
±r
 = 
NULL
;

119 
	}
}

121 
	$¢d_pcm_øã_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

123 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

124 
îr
;

125 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

126 
¢d_pcm_f‹m©_mask_t
 
f‹m©_mask
 = { 
SND_PCM_FMTBIT_LINEAR
 };

127 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

128 &
ac˚ss_mask
);

129 i‡(
îr
 < 0)

130  
îr
;

131 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
,

132 &
f‹m©_mask
);

133 i‡(
îr
 < 0)

134  
îr
;

135 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
∑øms
, 
SND_PCM_SUBFORMAT_STD
);

136 i‡(
îr
 < 0)

137  
îr
;

138 i‡(
øã
->
øã_mö
) {

139 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mö
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
,

140 
øã
->
øã_mö
, 0);

141 i‡(
îr
 < 0)

142  
îr
;

144 i‡(
øã
->
øã_max
) {

145 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_max
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
,

146 
øã
->
øã_max
, 0);

147 i‡(
îr
 < 0)

148  
îr
;

150 
∑øms
->
öfo
 &~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

152 
	}
}

154 
	$¢d_pcm_øã_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

156 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

157 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

158 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

159 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

160 &
ßc˚ss_mask
);

161 i‡(
øã
->
sf‹m©
 !
SND_PCM_FORMAT_UNKNOWN
) {

162 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
•¨ams
, 
øã
->
sf‹m©
);

163 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
•¨ams
, 
SND_PCM_SUBFORMAT_STD
);

165 
	`_¢d_pcm_hw_∑øm_£t_mömax
(
•¨ams
, 
SND_PCM_HW_PARAM_RATE
,

166 
øã
->
§©e
, 0,Ñate->srate + 1, -1);

168 
	}
}

170 
	$¢d_pcm_øã_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

171 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

173 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

174 
¢d_öãrvÆ_t
 
t
, 
buf„r_size
;

175 c⁄° 
¢d_öãrvÆ_t
 *
§©e
, *
¸©e
;

176 
îr
;

177 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

178 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

179 
SND_PCM_HW_PARBIT_TICK_TIME
);

180 i‡(
øã
->
sf‹m©
 =
SND_PCM_FORMAT_UNKNOWN
)

181 
löks
 |(
SND_PCM_HW_PARBIT_FORMAT
 |

182 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

183 
SND_PCM_HW_PARBIT_SAMPLE_BITS
 |

184 
SND_PCM_HW_PARBIT_FRAME_BITS
);

185 
	`¢d_öãrvÆ_c›y
(&
buf„r_size
, 
	`¢d_pcm_hw_∑øm_gë_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
));

186 
	`¢d_öãrvÆ_unÊo‹
(&
buf„r_size
);

187 
¸©e
 = 
	`¢d_pcm_hw_∑øm_gë_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
);

188 
§©e
 = 
	`¢d_pcm_hw_∑øm_gë_öãrvÆ
(
•¨ams
, 
SND_PCM_HW_PARAM_RATE
);

189 
	`¢d_öãrvÆ_muldiv
(&
buf„r_size
, 
§©e
, 
¸©e
, &
t
);

190 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_öãrvÆ
(
•¨ams
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
t
);

191 i‡(
îr
 < 0)

192  
îr
;

193 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

194 i‡(
îr
 < 0)

195  
îr
;

197 
	}
}

199 
	$¢d_pcm_øã_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

200 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

202 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

203 
¢d_öãrvÆ_t
 
t
;

204 #ifde‡
DEBUG_REFINE


205 
¢d_ouçut_t
 *
out
;

207 c⁄° 
¢d_öãrvÆ_t
 *
sbuf„r_size
, *
buf„r_size
;

208 c⁄° 
¢d_öãrvÆ_t
 *
§©e
, *
¸©e
;

209 
îr
;

210 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

211 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

212 
SND_PCM_HW_PARBIT_TICK_TIME
);

213 i‡(
øã
->
sf‹m©
 =
SND_PCM_FORMAT_UNKNOWN
)

214 
löks
 |(
SND_PCM_HW_PARBIT_FORMAT
 |

215 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

216 
SND_PCM_HW_PARBIT_SAMPLE_BITS
 |

217 
SND_PCM_HW_PARBIT_FRAME_BITS
);

218 
sbuf„r_size
 = 
	`¢d_pcm_hw_∑øm_gë_öãrvÆ
(
•¨ams
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
);

219 
¸©e
 = 
	`¢d_pcm_hw_∑øm_gë_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
);

220 
§©e
 = 
	`¢d_pcm_hw_∑øm_gë_öãrvÆ
(
•¨ams
, 
SND_PCM_HW_PARAM_RATE
);

221 
	`¢d_öãrvÆ_muldiv
(
sbuf„r_size
, 
¸©e
, 
§©e
, &
t
);

222 
	`¢d_öãrvÆ_Êo‹
(&
t
);

223 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
, &
t
);

224 i‡(
îr
 < 0)

225  
îr
;

226 
buf„r_size
 = 
	`¢d_pcm_hw_∑øm_gë_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
);

233 i‡(
	`¢d_öãrvÆ_sögÀ
(
buf„r_size
Ë&& buf„r_size->
öãgî
) {

234 
¢d_öãrvÆ_t
 *
≥riod_size
;

235 
≥riod_size
 = (
¢d_öãrvÆ_t
 *)
	`¢d_pcm_hw_∑øm_gë_öãrvÆ
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_SIZE
);

236 i‡(!
	`¢d_öãrvÆ_checkem±y
(
≥riod_size
) &&

237 
≥riod_size
->
›ímö
 &&Öîiod_size->
›ímax
 &&

238 
≥riod_size
->
mö
 + 1 =≥riod_size->
max
) {

239 i‡(
≥riod_size
->
mö
 > 0 && (
buf„r_size
->min /Öeriod_size->min) *Öeriod_size->min == buffer_size->min) {

240 
	`¢d_öãrvÆ_£t_vÆue
(
≥riod_size
,Öîiod_size->
mö
);

241 } i‡((
buf„r_size
->
max
 / 
≥riod_size
->max) *Öeriod_size->max == buffer_size->max) {

242 
	`¢d_öãrvÆ_£t_vÆue
(
≥riod_size
,Öîiod_size->
max
);

246 #ifde‡
DEBUG_REFINE


247 
	`¢d_ouçut_°dio_©èch
(&
out
, 
°dîr
, 0);

248 
	`¢d_ouçut_¥ötf
(
out
, "REFINE (params):\n");

249 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
out
);

250 
	`¢d_ouçut_¥ötf
(
out
, "REFINE (slaveÖarams):\n");

251 
	`¢d_pcm_hw_∑øms_dump
(
•¨ams
, 
out
);

252 
	`¢d_ouçut_˛o£
(
out
);

254 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

255 #ifde‡
DEBUG_REFINE


256 
	`¢d_ouçut_°dio_©èch
(&
out
, 
°dîr
, 0);

257 
	`¢d_ouçut_¥ötf
(
out
, "********************\n");

258 
	`¢d_ouçut_¥ötf
(
out
, "REFINE (∑ømsË(%i):\n", 
îr
);

259 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
out
);

260 
	`¢d_ouçut_¥ötf
(
out
, "REFINE (slaveÖarams):\n");

261 
	`¢d_pcm_hw_∑øms_dump
(
•¨ams
, 
out
);

262 
	`¢d_ouçut_˛o£
(
out
);

264 i‡(
îr
 < 0)

265  
îr
;

267 
	}
}

269 
	$¢d_pcm_øã_hw_ªföe
(
¢d_pcm_t
 *
pcm
,

270 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

272  
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

273 
¢d_pcm_øã_hw_ªföe_˝ª∑ª
,

274 
¢d_pcm_øã_hw_ªföe_cch™ge
,

275 
¢d_pcm_øã_hw_ªföe_•ª∑ª
,

276 
¢d_pcm_øã_hw_ªföe_sch™ge
,

277 
¢d_pcm_gíîic_hw_ªföe
);

278 
	}
}

281 
	$gë_be°_f‹m©
(
uöt64_t
 
mask
, 
¢d_pcm_f‹m©_t
 
‹ig
)

283 
pwidth
 = 
	`¢d_pcm_f‹m©_physiˇl_width
(
‹ig
);

284 
width
 = 
	`¢d_pcm_f‹m©_width
(
‹ig
);

285 
signd
 = 
	`¢d_pcm_f‹m©_sig√d
(
‹ig
);

286 
be°_sc‹e
 = -1;

287 
m©ch
 = -1;

288 
f
, 
sc‹e
;

290 
f
 = 0; f <
SND_PCM_FORMAT_LAST
; f++) {

291 i‡(!(
mask
 & (1ULL << 
f
)))

293 
sc‹e
 = 0;

294 i‡(
	`¢d_pcm_f‹m©_löór
(
f
)) {

295 i‡(
	`¢d_pcm_f‹m©_physiˇl_width
(
f
Ë=
pwidth
)

296 
sc‹e
++;

297 i‡(
	`¢d_pcm_f‹m©_physiˇl_width
(
f
Ë>
pwidth
)

298 
sc‹e
++;

299 i‡(
	`¢d_pcm_f‹m©_width
(
f
Ë=
width
)

300 
sc‹e
++;

301 i‡(
	`¢d_pcm_f‹m©_sig√d
(
f
Ë=
signd
)

302 
sc‹e
++;

304 i‡(
sc‹e
 > 
be°_sc‹e
) {

305 
m©ch
 = 
f
;

306 
be°_sc‹e
 = 
sc‹e
;

310  
m©ch
;

311 
	}
}

314 
	$choo£_¥e„ºed_f‹m©
(
¢d_pcm_øã_t
 *
øã
)

316 
uöt64_t
 
ö_mask
 = 
øã
->
ö_f‹m©s
;

317 
uöt64_t
 
out_mask
 = 
øã
->
out_f‹m©s
;

318 
ö
, 
out
;

320 i‡(!
ö_mask
 || !
out_mask
)

323 i‡(
øã
->
‹ig_ö_f‹m©
 =øã->
‹ig_out_f‹m©
)

324 i‡(
ö_mask
 & 
out_mask
 & (1ULL << 
øã
->
‹ig_ö_f‹m©
))

327 
ª≥©
:

328 
ö
 = 
	`gë_be°_f‹m©
(
ö_mask
, 
øã
->
‹ig_ö_f‹m©
);

329 
out
 = 
	`gë_be°_f‹m©
(
out_mask
, 
øã
->
‹ig_out_f‹m©
);

330 i‡(
ö
 < 0 || 
out
 < 0)

331  -
ENOENT
;

333 i‡((
øã
->
f‹m©_Êags
 & 
SND_PCM_RATE_FLAG_SYNC_FORMATS
) &&

334 
ö
 !
out
) {

335 i‡(
out_mask
 & (1ULL << 
ö
))

336 
out
 = 
ö
;

337 i‡(
ö_mask
 & (1ULL << 
out
))

338 
ö
 = 
out
;

340 
ö_mask
 &~(1ULL << 
ö
);

341 
out_mask
 &~(1ULL << 
out
);

342 
ª≥©
;

346 
øã
->
öfo
.
ö
.
f‹m©
 = in;

347 
øã
->
öfo
.
out
.
f‹m©
 = out;

349 
	}
}

351 
	$¢d_pcm_øã_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 * 
∑øms
)

353 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

354 
¢d_pcm_t
 *
¶ave
 = 
øã
->
gí
.slave;

355 
¢d_pcm_øã_side_öfo_t
 *
söfo
, *
cöfo
;

356 
ch™√ls
, 
acc
;

357 
√ed_§c_buf
, 
√ed_d°_buf
;

358 
îr
 = 
	`¢d_pcm_hw_∑øms_¶ave
(
pcm
, 
∑øms
,

359 
¢d_pcm_øã_hw_ªföe_cch™ge
,

360 
¢d_pcm_øã_hw_ªföe_•ª∑ª
,

361 
¢d_pcm_øã_hw_ªföe_sch™ge
,

362 
¢d_pcm_gíîic_hw_∑øms
);

363 i‡(
îr
 < 0)

364  
îr
;

366 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

367 
cöfo
 = &
øã
->
öfo
.
ö
;

368 
söfo
 = &
øã
->
öfo
.
out
;

370 
söfo
 = &
øã
->
öfo
.
ö
;

371 
cöfo
 = &
øã
->
öfo
.
out
;

373 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(
∑øms
, &
cöfo
->
f‹m©
);

374 i‡(
îr
 < 0)

375  
îr
;

376 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_øã
)(
∑øms
, &
cöfo
->
øã
, 0);

377 i‡(
îr
 < 0)

378  
îr
;

379 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_size
)(
∑øms
, &
cöfo
->
≥riod_size
, 0);

380 i‡(
îr
 < 0)

381  
îr
;

382 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_buf„r_size
)(
∑øms
, &
cöfo
->
buf„r_size
);

383 i‡(
îr
 < 0)

384  
îr
;

385 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_ch™√ls
)(
∑øms
, &
ch™√ls
);

386 i‡(
îr
 < 0)

387  
îr
;

388 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_ac˚ss
)(
∑øms
, &
acc
);

389 i‡(
îr
 < 0)

390  
îr
;

392 
øã
->
öfo
.
ch™√ls
 = channels;

393 
söfo
->
f‹m©
 = 
¶ave
->format;

394 
söfo
->
øã
 = 
¶ave
->rate;

395 
söfo
->
buf„r_size
 = 
¶ave
->buffer_size;

396 
söfo
->
≥riod_size
 = 
¶ave
->period_size;

398 i‡(
	`CHECK_SANITY
(
øã
->
∑ªas
)) {

399 
	`SNDMSG
("rateÖluginálready in use");

400  -
EBUSY
;

403 
øã
->
∑ªas
 = 
	`øã_Æloc_tmp_buf
(
cöfo
->
f‹m©
, 
ch™√ls
,

404 
cöfo
->
≥riod_size
);

405 
øã
->
ßªas
 = 
	`øã_Æloc_tmp_buf
(
söfo
->
f‹m©
, 
ch™√ls
,

406 
söfo
->
≥riod_size
);

407 i‡(!
øã
->
∑ªas
 || !øã->
ßªas
) {

408 
îr
 = -
ENOMEM
;

409 
îr‹_∑ªas
;

412 
øã
->
‹ig_ö_f‹m©
 =Ñ©e->
öfo
.
ö
.
f‹m©
;

413 
øã
->
‹ig_out_f‹m©
 =Ñ©e->
öfo
.
out
.
f‹m©
;

414 i‡(
	`choo£_¥e„ºed_f‹m©
(
øã
) < 0) {

415 
	`SNDERR
("No matching format inÑateÖlugin");

416 
îr
 = -
EINVAL
;

417 
îr‹_∑ªas
;

420 
îr
 = 
øã
->
›s
.
	`öô
‘©e->
obj
, &øã->
öfo
);

421 i‡(
îr
 < 0)

422 
îr‹_öô
;

424 
	`øã_‰ì_tmp_buf
(&
øã
->
§c_buf
);

425 
	`øã_‰ì_tmp_buf
(&
øã
->
d°_buf
);

427 
√ed_§c_buf
 = 
√ed_d°_buf
 = 0;

429 i‡((
øã
->
f‹m©_Êags
 & 
SND_PCM_RATE_FLAG_INTERLEAVED
) &&

430 !(
acc
 =
SND_PCM_ACCESS_MMAP_INTERLEAVED
 ||

431 
acc
 =
SND_PCM_ACCESS_RW_INTERLEAVED
)) {

432 
√ed_§c_buf
 = 
√ed_d°_buf
 = 1;

434 i‡(
øã
->
‹ig_ö_f‹m©
 !øã->
öfo
.
ö
.
f‹m©
)

435 
√ed_§c_buf
 = 1;

436 i‡(
øã
->
‹ig_out_f‹m©
 !øã->
öfo
.
out
.
f‹m©
)

437 
√ed_d°_buf
 = 1;

440 i‡(
√ed_§c_buf
) {

441 
øã
->
§c_c⁄v_idx
 =

442 
	`¢d_pcm_löór_c⁄vît_ödex
(
øã
->
‹ig_ö_f‹m©
,

443 
øã
->
öfo
.
ö
.
f‹m©
);

444 
øã
->
§c_buf
 = 
	`øã_Æloc_tmp_buf
‘©e->
öfo
.
ö
.
f‹m©
,

445 
ch™√ls
, 
øã
->
öfo
.
ö
.
≥riod_size
);

446 i‡(!
øã
->
§c_buf
) {

447 
îr
 = -
ENOMEM
;

448 
îr‹
;

452 i‡(
√ed_d°_buf
) {

453 
øã
->
d°_c⁄v_idx
 =

454 
	`¢d_pcm_löór_c⁄vît_ödex
(
øã
->
öfo
.
out
.
f‹m©
,

455 
øã
->
‹ig_out_f‹m©
);

456 
øã
->
d°_buf
 = 
	`øã_Æloc_tmp_buf
‘©e->
öfo
.
out
.
f‹m©
,

457 
ch™√ls
, 
øã
->
öfo
.
out
.
≥riod_size
);

458 i‡(!
øã
->
d°_buf
) {

459 
îr
 = -
ENOMEM
;

460 
îr‹
;

466 
îr‹
:

467 
	`øã_‰ì_tmp_buf
(&
øã
->
§c_buf
);

468 
	`øã_‰ì_tmp_buf
(&
øã
->
d°_buf
);

469 
îr‹_öô
:

470 i‡(
øã
->
›s
.
‰ì
)

471 
øã
->
›s
.
	`‰ì
‘©e->
obj
);

472 
îr‹_∑ªas
:

473 
	`øã_‰ì_tmp_buf
(&
øã
->
∑ªas
);

474 
	`øã_‰ì_tmp_buf
(&
øã
->
ßªas
);

475  
îr
;

476 
	}
}

478 
	$¢d_pcm_øã_hw_‰ì
(
¢d_pcm_t
 *
pcm
)

480 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

482 
	`øã_‰ì_tmp_buf
(&
øã
->
∑ªas
);

483 
	`øã_‰ì_tmp_buf
(&
øã
->
ßªas
);

484 i‡(
øã
->
›s
.
‰ì
)

485 
øã
->
›s
.
	`‰ì
‘©e->
obj
);

486 
	`øã_‰ì_tmp_buf
(&
øã
->
§c_buf
);

487 
	`øã_‰ì_tmp_buf
(&
øã
->
d°_buf
);

488  
	`¢d_pcm_hw_‰ì
(
øã
->
gí
.
¶ave
);

489 
	}
}

491 
	$ªˇlc
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 *
vÆ
)

493 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

494 
¢d_pcm_t
 *
¶ave
 = 
øã
->
gí
.slave;

495 
div
;

497 i‡(*
vÆ
 =
pcm
->
buf„r_size
) {

498 *
vÆ
 = 
¶ave
->
buf„r_size
;

500 
div
 = *
vÆ
 / 
pcm
->
≥riod_size
;

501 i‡(
div
 * 
pcm
->
≥riod_size
 =*
vÆ
)

502 *
vÆ
 = 
div
 * 
¶ave
->
≥riod_size
;

504 *
vÆ
 = 
	`muldiv_√¨
(*vÆ, 
¶ave
->
≥riod_size
, 
pcm
->period_size);

506 
	}
}

508 
	$¢d_pcm_øã_sw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 * 
∑øms
)

510 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

511 
¢d_pcm_t
 *
¶ave
 = 
øã
->
gí
.slave;

512 
¢d_pcm_sw_∑øms_t
 *
•¨ams
;

513 
¢d_pcm_u‰ames_t
 
bound¨y1
, 
bound¨y2
, 
sbound¨y
;

514 
îr
;

516 
•¨ams
 = &
øã
->
sw_∑øms
;

517 
îr
 = 
	`¢d_pcm_sw_∑øms_cuºít
(
¶ave
, 
•¨ams
);

518 i‡(
îr
 < 0)

519  
îr
;

520 
sbound¨y
 = 
•¨ams
->
bound¨y
;

521 *
•¨ams
 = *
∑øms
;

522 
bound¨y1
 = 
pcm
->
buf„r_size
;

523 
bound¨y2
 = 
¶ave
->
buf„r_size
;

524 
bound¨y1
 * 2 <
LONG_MAX
 - 
pcm
->
buf„r_size
 &&

525 
bound¨y2
 * 2 <
LONG_MAX
 - 
¶ave
->
buf„r_size
) {

526 
bound¨y1
 *= 2;

527 
bound¨y2
 *= 2;

529 
∑øms
->
bound¨y
 = 
bound¨y1
;

530 
•¨ams
->
bound¨y
 = 
sbound¨y
;

532 i‡(
øã
->
›s
.
adju°_pôch
)

533 
øã
->
›s
.
	`adju°_pôch
‘©e->
obj
, &øã->
öfo
);

535 
	`ªˇlc
(
pcm
, &
•¨ams
->
avaû_mö
);

536 
øã
->
‹ig_avaû_mö
 = 
•¨ams
->
avaû_mö
;

537 
	`ªˇlc
(
pcm
, &
•¨ams
->
°¨t_thªshﬁd
);

538 i‡(
•¨ams
->
avaû_mö
 < 1) sparams->avail_min = 1;

539 i‡(
•¨ams
->
°¨t_thªshﬁd
 <
¶ave
->
buf„r_size
) {

540 i‡(
•¨ams
->
°¨t_thªshﬁd
 > (
¶ave
->
buf„r_size
 / s∑øms->
avaû_mö
) * sparams->avail_min)

541 
•¨ams
->
°¨t_thªshﬁd
 = (
¶ave
->
buf„r_size
 / s∑øms->
avaû_mö
) * sparams->avail_min;

543 i‡(
•¨ams
->
°›_thªshﬁd
 >
∑øms
->
bound¨y
) {

544 
•¨ams
->
°›_thªshﬁd
 = s∑øms->
bound¨y
;

546 
	`ªˇlc
(
pcm
, &
•¨ams
->
°›_thªshﬁd
);

548 
	`ªˇlc
(
pcm
, &
•¨ams
->
sûí˚_thªshﬁd
);

549 i‡(
•¨ams
->
sûí˚_size
 >
∑øms
->
bound¨y
) {

550 
•¨ams
->
sûí˚_size
 = s∑øms->
bound¨y
;

552 
	`ªˇlc
(
pcm
, &
•¨ams
->
sûí˚_size
);

554  
	`¢d_pcm_sw_∑øms
(
¶ave
, 
•¨ams
);

555 
	}
}

557 
	$¢d_pcm_øã_öô
(
¢d_pcm_t
 *
pcm
)

559 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

561 i‡(
øã
->
›s
.
ª£t
)

562 
øã
->
›s
.
	`ª£t
‘©e->
obj
);

563 
øã
->
œ°_commô_±r
 = 0;

564 
øã
->
°¨t_≥ndög
 = 0;

566 
	}
}

568 
	$do_c⁄vît
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

569 
¢d_pcm_u‰ames_t
 
d°_off£t
, 
d°_‰ames
,

570 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

571 
¢d_pcm_u‰ames_t
 
§c_off£t
, 
§c_‰ames
,

572 
ch™√ls
,

573 
¢d_pcm_øã_t
 *
øã
)

575 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
out_¨ós
;

576 
¢d_pcm_u‰ames_t
 
out_off£t
;

578 i‡(
øã
->
d°_buf
) {

579 
out_¨ós
 = 
øã
->
d°_buf
;

580 
out_off£t
 = 0;

582 
out_¨ós
 = 
d°_¨ós
;

583 
out_off£t
 = 
d°_off£t
;

586 i‡(
øã
->
§c_buf
) {

587 
	`¢d_pcm_löór_c⁄vît
(
øã
->
§c_buf
, 0,

588 
§c_¨ós
, 
§c_off£t
,

589 
ch™√ls
, 
§c_‰ames
,

590 
øã
->
§c_c⁄v_idx
);

591 
§c_¨ós
 = 
øã
->
§c_buf
;

592 
§c_off£t
 = 0;

595 i‡(
øã
->
›s
.
c⁄vît
)

596 
øã
->
›s
.
	`c⁄vît
‘©e->
obj
, 
out_¨ós
, 
out_off£t
, 
d°_‰ames
,

597 
§c_¨ós
, 
§c_off£t
, 
§c_‰ames
);

599 
øã
->
›s
.
	`c⁄vît_s16
‘©e->
obj
,

600 
	`¢d_pcm_ch™√l_¨ó_addr
(
out_¨ós
, 
out_off£t
),

601 
d°_‰ames
,

602 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ós
, 
§c_off£t
),

603 
§c_‰ames
);

604 i‡(
øã
->
d°_buf
)

605 
	`¢d_pcm_löór_c⁄vît
(
d°_¨ós
, 
d°_off£t
,

606 
øã
->
d°_buf
, 0,

607 
ch™√ls
, 
d°_‰ames
,

608 
øã
->
d°_c⁄v_idx
);

609 
	}
}

611 
ölöe
 

612 
	$¢d_pcm_øã_wrôe_¨ós1
(
¢d_pcm_t
 *
pcm
,

613 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

614 
¢d_pcm_u‰ames_t
 
off£t
,

615 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

616 
¢d_pcm_u‰ames_t
 
¶ave_off£t
)

618 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

619 
	`do_c⁄vît
(
¶ave_¨ós
, 
¶ave_off£t
, 
øã
->
gí
.
¶ave
->
≥riod_size
,

620 
¨ós
, 
off£t
, 
pcm
->
≥riod_size
,

621 
pcm
->
ch™√ls
, 
øã
);

622 
	}
}

624 
ölöe
 

625 
	$¢d_pcm_øã_ªad_¨ós1
(
¢d_pcm_t
 *
pcm
,

626 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

627 
¢d_pcm_u‰ames_t
 
off£t
,

628 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

629 
¢d_pcm_u‰ames_t
 
¶ave_off£t
)

631 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

632 
	`do_c⁄vît
(
¨ós
, 
off£t
, 
pcm
->
≥riod_size
,

633 
¶ave_¨ós
, 
¶ave_off£t
, 
øã
->
gí
.
¶ave
->
≥riod_size
,

634 
pcm
->
ch™√ls
, 
øã
);

635 
	}
}

637 
ölöe
 
	$¢d_pcm_øã_sync_hw±r0
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
¶ave_hw_±r
)

639 
¢d_pcm_øã_t
 *
øã
;

640 
¢d_pcm_s‰ames_t
 
¶ave_hw_±r_diff
;

641 
¢d_pcm_s‰ames_t
 
œ°_¶ave_hw_±r_‰ac
;

643 i‡(
pcm
->
°ªam
 !
SND_PCM_STREAM_PLAYBACK
)

646 
øã
 = 
pcm
->
¥iv©e_d©a
;

647 
¶ave_hw_±r_diff
 = 
	`pcm_‰ame_diff
(
¶ave_hw_±r
, 
øã
->
œ°_¶ave_hw_±r
,Ñ©e->
gí
.
¶ave
->
bound¨y
);

648 i‡(
¶ave_hw_±r_diff
 == 0)

650 
œ°_¶ave_hw_±r_‰ac
 = 
øã
->
œ°_¶ave_hw_±r
 %Ñ©e->
gí
.
¶ave
->
≥riod_size
;

660 
øã
->
hw_±r
 += (

661 (((
œ°_¶ave_hw_±r_‰ac
 + 
¶ave_hw_±r_diff
Ë/ 
øã
->
gí
.
¶ave
->
≥riod_size
Ë* 
pcm
->period_size) -

662 
øã
->
›s
.
	`öput_‰ames
‘©e->
obj
, 
œ°_¶ave_hw_±r_‰ac
) +

663 
øã
->
›s
.
	`öput_‰ames
‘©e->
obj
, (
œ°_¶ave_hw_±r_‰ac
 + 
¶ave_hw_±r_diff
Ë%Ñ©e->
gí
.
¶ave
->
≥riod_size
));

664 
øã
->
œ°_¶ave_hw_±r
 = 
¶ave_hw_±r
;

666 
øã
->
hw_±r
 %
pcm
->
bound¨y
;

667 
	}
}

669 
ölöe
 
	$¢d_pcm_øã_sync_hw±r
(
¢d_pcm_t
 *
pcm
)

671 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

672 
	`¢d_pcm_øã_sync_hw±r0
(
pcm
, *
øã
->
gí
.
¶ave
->
hw
.
±r
);

673 
	}
}

675 
	$¢d_pcm_øã_hwsync
(
¢d_pcm_t
 *
pcm
)

677 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

678 
îr
 = 
	`¢d_pcm_hwsync
(
øã
->
gí
.
¶ave
);

679 i‡(
îr
 < 0)

680  
îr
;

681 
	`¢d_pcm_øã_sync_hw±r
(
pcm
);

683 
	}
}

685 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_øã_∂ayback_öã∫Æ_dñay
(
¢d_pcm_t
 *
pcm
)

687 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

689  
	`pcm_‰ame_diff
(
øã
->
≠∂_±r
,Ñ©e->
œ°_commô_±r
, 
pcm
->
bound¨y
);

690 
	}
}

692 
	$¢d_pcm_øã_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
)

694 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

695 
¢d_pcm_s‰ames_t
 
¶ave_dñay
;

696 
îr
;

698 
	`¢d_pcm_øã_hwsync
(
pcm
);

700 
îr
 = 
	`¢d_pcm_dñay
(
øã
->
gí
.
¶ave
, &
¶ave_dñay
);

701 i‡(
îr
 < 0) {

702  
îr
;

705 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

706 *
dñayp
 = 
øã
->
›s
.
	`öput_‰ames
‘©e->
obj
, 
¶ave_dñay
)

707 + 
	`¢d_pcm_øã_∂ayback_öã∫Æ_dñay
(
pcm
);

709 *
dñayp
 = 
øã
->
›s
.
	`ouçut_‰ames
‘©e->
obj
, 
¶ave_dñay
)

710 + 
	`¢d_pcm_mm≠_ˇ±uª_dñay
(
pcm
);

713 
	}
}

715 
	$¢d_pcm_øã_¥ï¨e
(
¢d_pcm_t
 *
pcm
)

717 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

718 
îr
;

720 
îr
 = 
	`¢d_pcm_¥ï¨e
(
øã
->
gí
.
¶ave
);

721 i‡(
îr
 < 0)

722  
îr
;

723 *
pcm
->
hw
.
±r
 = 0;

724 *
pcm
->
≠∂
.
±r
 = 0;

725 
øã
->
œ°_¶ave_hw_±r
 = 0;

726 
îr
 = 
	`¢d_pcm_øã_öô
(
pcm
);

727 i‡(
îr
 < 0)

728  
îr
;

730 
	}
}

732 
	$¢d_pcm_øã_ª£t
(
¢d_pcm_t
 *
pcm
)

734 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

735 
îr
;

736 
îr
 = 
	`¢d_pcm_ª£t
(
øã
->
gí
.
¶ave
);

737 i‡(
îr
 < 0)

738  
îr
;

739 *
pcm
->
hw
.
±r
 = 0;

740 *
pcm
->
≠∂
.
±r
 = 0;

741 
øã
->
œ°_¶ave_hw_±r
 = 0;

742 
îr
 = 
	`¢d_pcm_øã_öô
(
pcm
);

743 i‡(
îr
 < 0)

744  
îr
;

746 
	}
}

748 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_øã_ªwödabÀ
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

751 
	}
}

753 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_øã_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

756 
	}
}

758 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_øã_ªwöd
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

759 
¢d_pcm_u‰ames_t
 
‰ames
 
ATTRIBUTE_UNUSED
)

762 
	}
}

764 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_øã_f‹w¨d
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

765 
¢d_pcm_u‰ames_t
 
‰ames
 
ATTRIBUTE_UNUSED
)

768 
	}
}

770 
	$¢d_pcm_øã_commô_¨ó
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_øã_t
 *
øã
,

771 
¢d_pcm_u‰ames_t
 
≠∂_off£t
,

772 
¢d_pcm_u‰ames_t
 
size
 
ATTRIBUTE_UNUSED
,

773 
¢d_pcm_u‰ames_t
 
¶ave_size
)

775 
¢d_pcm_u‰ames_t
 
c⁄t
 = 
pcm
->
buf„r_size
 - 
≠∂_off£t
;

776 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
;

777 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
;

778 
¢d_pcm_u‰ames_t
 
¶ave_off£t
, 
x„r
;

779 
¢d_pcm_u‰ames_t
 
¶ave_‰ames
 = 
ULONG_MAX
;

780 
¢d_pcm_s‰ames_t
 
ªsu…
;

782 
¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

787 i‡(
c⁄t
 >
pcm
->
≥riod_size
) {

788 
ªsu…
 = 
	`¢d_pcm_mm≠_begö
(
øã
->
gí
.
¶ave
, &
¶ave_¨ós
, &
¶ave_off£t
, &
¶ave_‰ames
);

789 i‡(
ªsu…
 < 0)

790  
ªsu…
;

795 i‡(
¶ave_‰ames
 < 
øã
->
gí
.
¶ave
->
≥riod_size
) {

796 
	`¢d_pcm_øã_wrôe_¨ós1
(
pcm
, 
¨ós
, 
≠∂_off£t
, 
øã
->
ßªas
, 0);

797 
__∑πül
;

799 
	`¢d_pcm_øã_wrôe_¨ós1
(
pcm
, 
¨ós
, 
≠∂_off£t
,

800 
¶ave_¨ós
, 
¶ave_off£t
);

802 
ªsu…
 = 
	`¢d_pcm_mm≠_commô
(
øã
->
gí
.
¶ave
, 
¶ave_off£t
, 
¶ave_size
);

803 i‡(
ªsu…
 < (
¢d_pcm_s‰ames_t
)
¶ave_size
) {

804 i‡(
ªsu…
 < 0)

805  
ªsu…
;

806 
ªsu…
 = 
	`¢d_pcm_ªwöd
(
øã
->
gí
.
¶ave
,Ñesult);

807 i‡(
ªsu…
 < 0)

808  
ªsu…
;

812 
	`¢d_pcm_¨ós_c›y
(
øã
->
∑ªas
, 0,

813 
¨ós
, 
≠∂_off£t
,

814 
pcm
->
ch™√ls
, 
c⁄t
,

815 
pcm
->
f‹m©
);

816 
	`¢d_pcm_¨ós_c›y
(
øã
->
∑ªas
, 
c⁄t
,

817 
¨ós
, 0,

818 
pcm
->
ch™√ls
,Öcm->
≥riod_size
 - 
c⁄t
,

819 
pcm
->
f‹m©
);

821 
	`¢d_pcm_øã_wrôe_¨ós1
(
pcm
, 
øã
->
∑ªas
, 0,Ñ©e->
ßªas
, 0);

824 
ªsu…
 = 
	`¢d_pcm_mm≠_begö
(
øã
->
gí
.
¶ave
, &
¶ave_¨ós
, &
¶ave_off£t
, &
¶ave_‰ames
);

825 i‡(
ªsu…
 < 0)

826  
ªsu…
;

827 
__∑πül
:

828 
c⁄t
 = 
¶ave_‰ames
;

829 i‡(
c⁄t
 > 
¶ave_size
)

830 
c⁄t
 = 
¶ave_size
;

831 
	`¢d_pcm_¨ós_c›y
(
¶ave_¨ós
, 
¶ave_off£t
,

832 
øã
->
ßªas
, 0,

833 
pcm
->
ch™√ls
, 
c⁄t
,

834 
øã
->
gí
.
¶ave
->
f‹m©
);

835 
ªsu…
 = 
	`¢d_pcm_mm≠_commô
(
øã
->
gí
.
¶ave
, 
¶ave_off£t
, 
c⁄t
);

836 i‡(
ªsu…
 < (
¢d_pcm_s‰ames_t
)
c⁄t
) {

837 i‡(
ªsu…
 < 0)

838  
ªsu…
;

839 
ªsu…
 = 
	`¢d_pcm_ªwöd
(
øã
->
gí
.
¶ave
,Ñesult);

840 i‡(
ªsu…
 < 0)

841  
ªsu…
;

844 
x„r
 = 
c⁄t
;

846 i‡(
x„r
 =
¶ave_size
)

847 
commô_d⁄e
;

850 
c⁄t
 = 
¶ave_size
 - cont;

851 
¶ave_‰ames
 = 
c⁄t
;

852 
ªsu…
 = 
	`¢d_pcm_mm≠_begö
(
øã
->
gí
.
¶ave
, &
¶ave_¨ós
, &
¶ave_off£t
, &
¶ave_‰ames
);

853 i‡(
ªsu…
 < 0)

854  
ªsu…
;

856 i‡(
¶ave_off£t
) {

857 
	`SNDERR
("n⁄-zîÿ¶ave_off£à%ld", 
¶ave_off£t
);

858  -
EIO
;

861 
	`¢d_pcm_¨ós_c›y
(
¶ave_¨ós
, 
¶ave_off£t
,

862 
øã
->
ßªas
, 
x„r
,

863 
pcm
->
ch™√ls
, 
c⁄t
,

864 
øã
->
gí
.
¶ave
->
f‹m©
);

865 
ªsu…
 = 
	`¢d_pcm_mm≠_commô
(
øã
->
gí
.
¶ave
, 
¶ave_off£t
, 
c⁄t
);

866 i‡(
ªsu…
 < (
¢d_pcm_s‰ames_t
)
c⁄t
) {

867 i‡(
ªsu…
 < 0)

868  
ªsu…
;

869 
ªsu…
 = 
	`¢d_pcm_ªwöd
(
øã
->
gí
.
¶ave
,Ñesu… + 
x„r
);

870 i‡(
ªsu…
 < 0)

871  
ªsu…
;

876 
commô_d⁄e
:

877 i‡(
øã
->
°¨t_≥ndög
) {

879 
	`¢d_pcm_°¨t
(
øã
->
gí
.
¶ave
);

880 
øã
->
°¨t_≥ndög
 = 0;

883 
	}
}

885 
	$¢d_pcm_øã_commô_√xt_≥riod
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
≠∂_off£t
)

887 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

889  
	`¢d_pcm_øã_commô_¨ó
(
pcm
, 
øã
, 
≠∂_off£t
,Öcm->
≥riod_size
,

890 
øã
->
gí
.
¶ave
->
≥riod_size
);

891 
	}
}

893 
	$¢d_pcm_øã_gøb_√xt_≥riod
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
hw_off£t
)

895 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

896 
¢d_pcm_u‰ames_t
 
c⁄t
 = 
pcm
->
buf„r_size
 - 
hw_off£t
;

897 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
;

898 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
;

899 
¢d_pcm_u‰ames_t
 
¶ave_off£t
, 
x„r
;

900 
¢d_pcm_u‰ames_t
 
¶ave_‰ames
 = 
ULONG_MAX
;

901 
¢d_pcm_s‰ames_t
 
ªsu…
;

903 
¨ós
 = 
	`¢d_pcm_mm≠_¨ós
(
pcm
);

904 i‡(
c⁄t
 >
pcm
->
≥riod_size
) {

905 
ªsu…
 = 
	`¢d_pcm_mm≠_begö
(
øã
->
gí
.
¶ave
, &
¶ave_¨ós
, &
¶ave_off£t
, &
¶ave_‰ames
);

906 i‡(
ªsu…
 < 0)

907  
ªsu…
;

908 i‡(
¶ave_‰ames
 < 
øã
->
gí
.
¶ave
->
≥riod_size
)

909 
__∑πül
;

910 
	`¢d_pcm_øã_ªad_¨ós1
(
pcm
, 
¨ós
, 
hw_off£t
,

911 
¶ave_¨ós
, 
¶ave_off£t
);

912 
ªsu…
 = 
	`¢d_pcm_mm≠_commô
(
øã
->
gí
.
¶ave
, 
¶ave_off£t
,Ñ©e->gí.¶ave->
≥riod_size
);

913 i‡(
ªsu…
 < (
¢d_pcm_s‰ames_t
)
øã
->
gí
.
¶ave
->
≥riod_size
) {

914 i‡(
ªsu…
 < 0)

915  
ªsu…
;

916 
ªsu…
 = 
	`¢d_pcm_ªwöd
(
øã
->
gí
.
¶ave
,Ñesult);

917 i‡(
ªsu…
 < 0)

918  
ªsu…
;

923 
ªsu…
 = 
	`¢d_pcm_mm≠_begö
(
øã
->
gí
.
¶ave
, &
¶ave_¨ós
, &
¶ave_off£t
, &
¶ave_‰ames
);

924 i‡(
ªsu…
 < 0)

925  
ªsu…
;

926 
__∑πül
:

927 
c⁄t
 = 
¶ave_‰ames
;

928 i‡(
c⁄t
 > 
øã
->
gí
.
¶ave
->
≥riod_size
)

929 
c⁄t
 = 
øã
->
gí
.
¶ave
->
≥riod_size
;

930 
	`¢d_pcm_¨ós_c›y
(
øã
->
ßªas
, 0,

931 
¶ave_¨ós
, 
¶ave_off£t
,

932 
pcm
->
ch™√ls
, 
c⁄t
,

933 
øã
->
gí
.
¶ave
->
f‹m©
);

934 
ªsu…
 = 
	`¢d_pcm_mm≠_commô
(
øã
->
gí
.
¶ave
, 
¶ave_off£t
, 
c⁄t
);

935 i‡(
ªsu…
 < (
¢d_pcm_s‰ames_t
)
c⁄t
) {

936 i‡(
ªsu…
 < 0)

937  
ªsu…
;

938 
ªsu…
 = 
	`¢d_pcm_ªwöd
(
øã
->
gí
.
¶ave
,Ñesult);

939 i‡(
ªsu…
 < 0)

940  
ªsu…
;

943 
x„r
 = 
c⁄t
;

945 i‡(
x„r
 =
øã
->
gí
.
¶ave
->
≥riod_size
)

946 
__å™s„r
;

949 
c⁄t
 = 
øã
->
gí
.
¶ave
->
≥riod_size
 - cont;

950 
¶ave_‰ames
 = 
c⁄t
;

951 
ªsu…
 = 
	`¢d_pcm_mm≠_begö
(
øã
->
gí
.
¶ave
, &
¶ave_¨ós
, &
¶ave_off£t
, &
¶ave_‰ames
);

952 i‡(
ªsu…
 < 0)

953  
ªsu…
;

955 i‡(
¶ave_off£t
) {

956 
	`SNDERR
("n⁄-zîÿ¶ave_off£à%ld", 
¶ave_off£t
);

957  -
EIO
;

960 
	`¢d_pcm_¨ós_c›y
(
øã
->
ßªas
, 
x„r
,

961 
¶ave_¨ós
, 
¶ave_off£t
,

962 
pcm
->
ch™√ls
, 
c⁄t
,

963 
øã
->
gí
.
¶ave
->
f‹m©
);

964 
ªsu…
 = 
	`¢d_pcm_mm≠_commô
(
øã
->
gí
.
¶ave
, 
¶ave_off£t
, 
c⁄t
);

965 i‡(
ªsu…
 < (
¢d_pcm_s‰ames_t
)
c⁄t
) {

966 i‡(
ªsu…
 < 0)

967  
ªsu…
;

968 
ªsu…
 = 
	`¢d_pcm_ªwöd
(
øã
->
gí
.
¶ave
,Ñesu… + 
x„r
);

969 i‡(
ªsu…
 < 0)

970  
ªsu…
;

974 
__å™s„r
:

975 
c⁄t
 = 
pcm
->
buf„r_size
 - 
hw_off£t
;

976 i‡(
c⁄t
 >
pcm
->
≥riod_size
) {

977 
	`¢d_pcm_øã_ªad_¨ós1
(
pcm
, 
¨ós
, 
hw_off£t
,

978 
øã
->
ßªas
, 0);

980 
	`¢d_pcm_øã_ªad_¨ós1
(
pcm
,

981 
øã
->
∑ªas
, 0,

982 
øã
->
ßªas
, 0);

983 
	`¢d_pcm_¨ós_c›y
(
¨ós
, 
hw_off£t
,

984 
øã
->
∑ªas
, 0,

985 
pcm
->
ch™√ls
, 
c⁄t
,

986 
pcm
->
f‹m©
);

987 
	`¢d_pcm_¨ós_c›y
(
¨ós
, 0,

988 
øã
->
∑ªas
, 
c⁄t
,

989 
pcm
->
ch™√ls
,Öcm->
≥riod_size
 - 
c⁄t
,

990 
pcm
->
f‹m©
);

994 
	}
}

996 
	$¢d_pcm_øã_sync_∂ayback_¨ó
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
≠∂_±r
)

998 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

999 
¢d_pcm_t
 *
¶ave
 = 
øã
->
gí
.slave;

1000 
¢d_pcm_u‰ames_t
 
x„r
;

1001 
¢d_pcm_s‰ames_t
 
¶ave_size
;

1002 
îr
;

1004 
¶ave_size
 = 
	`¢d_pcm_avaû_upd©e
(
¶ave
);

1005 i‡(
¶ave_size
 < 0)

1006  
¶ave_size
;

1008 
x„r
 = 
	`pcm_‰ame_diff
(
≠∂_±r
, 
øã
->
œ°_commô_±r
, 
pcm
->
bound¨y
);

1009 
x„r
 >
pcm
->
≥riod_size
 &&

1010 (
¢d_pcm_u‰ames_t
)
¶ave_size
 >
øã
->
gí
.
¶ave
->
≥riod_size
) {

1011 
îr
 = 
	`¢d_pcm_øã_commô_√xt_≥riod
(
pcm
, 
øã
->
œ°_commô_±r
 %Öcm->
buf„r_size
);

1012 i‡(
îr
 == 0)

1014 i‡(
îr
 < 0)

1015  
îr
;

1016 
x„r
 -
pcm
->
≥riod_size
;

1017 
¶ave_size
 -
øã
->
gí
.
¶ave
->
≥riod_size
;

1018 
øã
->
œ°_commô_±r
 +
pcm
->
≥riod_size
;

1019 i‡(
øã
->
œ°_commô_±r
 >
pcm
->
bound¨y
)

1020 
øã
->
œ°_commô_±r
 -
pcm
->
bound¨y
;

1023 
	}
}

1025 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_øã_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

1026 
¢d_pcm_u‰ames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

1027 
¢d_pcm_u‰ames_t
 
size
)

1029 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

1030 
îr
;

1032 i‡(
size
 == 0)

1034 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

1035 
îr
 = 
	`¢d_pcm_øã_sync_∂ayback_¨ó
(
pcm
, 
øã
->
≠∂_±r
 + 
size
);

1036 i‡(
îr
 < 0)

1037  
îr
;

1039 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
size
);

1040  
size
;

1041 
	}
}

1043 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_øã_avaû_upd©e_ˇ±uª
(
¢d_pcm_t
 *
pcm
,

1044 
¢d_pcm_s‰ames_t
 
¶ave_size
)

1046 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

1047 
¢d_pcm_t
 *
¶ave
 = 
øã
->
gí
.slave;

1048 
¢d_pcm_u‰ames_t
 
x„r
, 
hw_off£t
, 
size
;

1050 
x„r
 = 
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
pcm
);

1051 
size
 = 
pcm
->
buf„r_size
 - 
x„r
;

1052 
hw_off£t
 = 
	`¢d_pcm_mm≠_hw_off£t
(
pcm
);

1053 
size
 >
pcm
->
≥riod_size
 &&

1054 (
¢d_pcm_u‰ames_t
)
¶ave_size
 >
¶ave
->
≥riod_size
) {

1055 
îr
 = 
	`¢d_pcm_øã_gøb_√xt_≥riod
(
pcm
, 
hw_off£t
);

1056 i‡(
îr
 < 0)

1057  
îr
;

1058 i‡(
îr
 == 0)

1059  (
¢d_pcm_s‰ames_t
)
x„r
;

1060 
x„r
 +
pcm
->
≥riod_size
;

1061 
size
 -
pcm
->
≥riod_size
;

1062 
¶ave_size
 -
¶ave
->
≥riod_size
;

1063 
hw_off£t
 +
pcm
->
≥riod_size
;

1064 
hw_off£t
 %
pcm
->
buf„r_size
;

1065 
	`¢d_pcm_mm≠_hw_f‹w¨d
(
pcm
,Öcm->
≥riod_size
);

1067  (
¢d_pcm_s‰ames_t
)
x„r
;

1068 
	}
}

1070 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_øã_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

1072 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

1073 
¢d_pcm_s‰ames_t
 
¶ave_size
;

1075 
¶ave_size
 = 
	`¢d_pcm_avaû_upd©e
(
øã
->
gí
.
¶ave
);

1076 i‡(
¶ave_size
 < 0)

1077  
¶ave_size
;

1079 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_CAPTURE
)

1080  
	`¢d_pcm_øã_avaû_upd©e_ˇ±uª
(
pcm
, 
¶ave_size
);

1082 
	`¢d_pcm_øã_sync_hw±r
(
pcm
);

1083 
	`¢d_pcm_øã_sync_∂ayback_¨ó
(
pcm
, 
øã
->
≠∂_±r
);

1084  
	`¢d_pcm_mm≠_avaû
(
pcm
);

1085 
	}
}

1087 
	$¢d_pcm_øã_htime°amp
(
¢d_pcm_t
 *
pcm
,

1088 
¢d_pcm_u‰ames_t
 *
avaû
,

1089 
¢d_htime°amp_t
 *
t°amp
)

1091 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

1092 
¢d_pcm_s‰ames_t
 
avaû1
;

1093 
¢d_pcm_u‰ames_t
 
tmp
;

1094 
ok
 = 0, 
îr
;

1098 
avaû1
 = 
	`¢d_pcm_avaû_upd©e
(
pcm
);

1099 i‡(
avaû1
 < 0)

1100  
avaû1
;

1101 i‡(
ok
 && (
¢d_pcm_u‰ames_t
)
avaû1
 =*
avaû
)

1103 *
avaû
 = 
avaû1
;

1105 
îr
 = 
	`¢d_pcm_htime°amp
(
øã
->
gí
.
¶ave
, &
tmp
, 
t°amp
);

1106 i‡(
îr
 < 0)

1107  
îr
;

1108 
ok
 = 1;

1111 
	}
}

1113 
	$¢d_pcm_øã_pﬁl_ªvíts
(
¢d_pcm_t
 *
pcm
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

1115 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

1116 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

1118 
	`¢d_pcm_øã_hwsync
(
pcm
);

1119 
	`¢d_pcm_øã_sync_∂ayback_¨ó
(
pcm
, 
øã
->
≠∂_±r
);

1121  
	`¢d_pcm_pﬁl_des¸ùt‹s_ªvíts
(
øã
->
gí
.
¶ave
, 
pfds
, 
nfds
, 
ªvíts
);

1122 
	}
}

1125 
	$¢d_pcm_øã_døö
(
¢d_pcm_t
 *
pcm
)

1127 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

1129 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

1131 
¢d_pcm_u‰ames_t
 
size
, 
ofs
, 
ßved_avaû_mö
;

1132 
¢d_pcm_sw_∑øms_t
 
sw_∑øms
;

1133 
commô_îr
 = 0;

1135 
	`__¢d_pcm_lock
(
pcm
);

1137 
sw_∑øms
 = 
øã
->sw_params;

1138 
ßved_avaû_mö
 = 
sw_∑øms
.
avaû_mö
;

1139 
sw_∑øms
.
avaû_mö
 = 1;

1140 
	`¢d_pcm_sw_∑øms
(
øã
->
gí
.
¶ave
, &
sw_∑øms
);

1142 
size
 = 
	`pcm_‰ame_diff
(
øã
->
≠∂_±r
,Ñ©e->
œ°_commô_±r
, 
pcm
->
bound¨y
);

1143 
ofs
 = 
øã
->
œ°_commô_±r
 % 
pcm
->
buf„r_size
;

1144 
size
 > 0) {

1145 
¢d_pcm_u‰ames_t
 
psize
, 
•size
;

1146 
îr
;

1148 
îr
 = 
	`__¢d_pcm_waô_ö_lock
(
øã
->
gí
.
¶ave
, 
SND_PCM_WAIT_DRAIN
);

1149 i‡(
îr
 < 0)

1151 i‡(
size
 > 
pcm
->
≥riod_size
) {

1152 
psize
 = 
pcm
->
≥riod_size
;

1153 
•size
 = 
øã
->
gí
.
¶ave
->
≥riod_size
;

1155 
psize
 = 
size
;

1156 
•size
 = 
øã
->
›s
.
	`ouçut_‰ames
‘©e->
obj
, 
size
);

1157 i‡(! 
•size
)

1160 
commô_îr
 = 
	`¢d_pcm_øã_commô_¨ó
(
pcm
, 
øã
, 
ofs
,

1161 
psize
, 
•size
);

1162 i‡(
commô_îr
 == 1) {

1163 
øã
->
œ°_commô_±r
 +
psize
;

1164 i‡(
øã
->
œ°_commô_±r
 >
pcm
->
bound¨y
)

1165 
øã
->
œ°_commô_±r
 -
pcm
->
bound¨y
;

1166 } i‡(
commô_îr
 == 0) {

1167 i‡(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
) {

1168 
commô_îr
 = -
EAGAIN
;

1175 
ofs
 = (of†+ 
psize
Ë% 
pcm
->
buf„r_size
;

1176 
size
 -
psize
;

1178 
sw_∑øms
.
avaû_mö
 = 
ßved_avaû_mö
;

1179 
	`¢d_pcm_sw_∑øms
(
øã
->
gí
.
¶ave
, &
sw_∑øms
);

1180 
	`__¢d_pcm_u∆ock
(
pcm
);

1181 i‡(
commô_îr
 < 0)

1182  
commô_îr
;

1184  
	`¢d_pcm_døö
(
øã
->
gí
.
¶ave
);

1185 
	}
}

1187 
¢d_pcm_°©e_t
 
	$¢d_pcm_øã_°©e
(
¢d_pcm_t
 *
pcm
)

1189 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

1190 i‡(
øã
->
°¨t_≥ndög
)

1191  
SND_PCM_STATE_RUNNING
;

1192  
	`¢d_pcm_°©e
(
øã
->
gí
.
¶ave
);

1193 
	}
}

1196 
	$¢d_pcm_øã_°¨t
(
¢d_pcm_t
 *
pcm
)

1198 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

1199 
¢d_pcm_s‰ames_t
 
avaû
;

1201 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_CAPTURE
)

1202  
	`¢d_pcm_°¨t
(
øã
->
gí
.
¶ave
);

1204 i‡(
	`¢d_pcm_°©e
(
øã
->
gí
.
¶ave
Ë!
SND_PCM_STATE_PREPARED
)

1205  -
EBADFD
;

1207 
	`gëtime°amp
(&
øã
->
åiggî_t°amp
, 
pcm
->
t°amp_ty≥
);

1209 
avaû
 = 
	`¢d_pcm_mm≠_∂ayback_hw_avaû
(
øã
->
gí
.
¶ave
);

1210 i‡(
avaû
 < 0)

1211  -
EBADFD
;

1213 i‡(
avaû
 == 0) {

1215 
øã
->
°¨t_≥ndög
 = 1;

1218 
øã
->
°¨t_≥ndög
 = 0;

1219  
	`¢d_pcm_°¨t
(
øã
->
gí
.
¶ave
);

1220 
	}
}

1222 
	$¢d_pcm_øã_°©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©us_t
 * 
°©us
)

1224 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

1225 
¢d_pcm_s‰ames_t
 
îr
;

1227 
îr
 = 
	`¢d_pcm_°©us
(
øã
->
gí
.
¶ave
, 
°©us
);

1228 i‡(
îr
 < 0)

1229  
îr
;

1230 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

1231 i‡(
øã
->
°¨t_≥ndög
)

1232 
°©us
->
°©e
 = 
SND_PCM_STATE_RUNNING
;

1233 
°©us
->
åiggî_t°amp
 = 
øã
->trigger_tstamp;

1235 
	`¢d_pcm_øã_sync_hw±r0
(
pcm
, 
°©us
->
hw_±r
);

1236 
°©us
->
≠∂_±r
 = *
pcm
->
≠∂
.
±r
;

1237 
°©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

1238 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

1239 
°©us
->
dñay
 = 
øã
->
›s
.
	`öput_‰ames
‘©e->
obj
, status->delay)

1240 + 
	`¢d_pcm_øã_∂ayback_öã∫Æ_dñay
(
pcm
);

1241 
°©us
->
avaû
 = 
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
);

1242 
°©us
->
avaû_max
 = 
øã
->
›s
.
	`öput_‰ames
‘©e->
obj
, status->avail_max);

1244 
°©us
->
dñay
 = 
øã
->
›s
.
	`ouçut_‰ames
‘©e->
obj
, status->delay)

1245 + 
	`¢d_pcm_mm≠_ˇ±uª_dñay
(
pcm
);

1246 
°©us
->
avaû
 = 
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
pcm
);

1247 
°©us
->
avaû_max
 = 
øã
->
›s
.
	`ouçut_‰ames
‘©e->
obj
, status->avail_max);

1250 
	}
}

1252 
	$¢d_pcm_øã_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

1254 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

1255 i‡(
øã
->
sf‹m©
 =
SND_PCM_FORMAT_UNKNOWN
)

1256 
	`¢d_ouçut_¥ötf
(
out
, "Rate conversion PCM (%d)\n",

1257 
øã
->
§©e
);

1259 
	`¢d_ouçut_¥ötf
(
out
, "Rate conversion PCM (%d, sformat=%s)\n",

1260 
øã
->
§©e
,

1261 
	`¢d_pcm_f‹m©_«me
(
øã
->
sf‹m©
));

1262 i‡(
øã
->
›s
.
dump
)

1263 
øã
->
›s
.
	`dump
‘©e->
obj
, 
out
);

1264 
	`¢d_ouçut_¥ötf
(
out
, "PrŸocﬁ vîsi⁄: %x\n", 
øã
->
∂ugö_vîsi⁄
);

1265 i‡(
pcm
->
£tup
) {

1266 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

1267 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

1269 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

1270 
	`¢d_pcm_dump
(
øã
->
gí
.
¶ave
, 
out
);

1271 
	}
}

1273 
	$¢d_pcm_øã_˛o£
(
¢d_pcm_t
 *
pcm
)

1275 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

1277 i‡(
øã
->
›s
.
˛o£
)

1278 
øã
->
›s
.
	`˛o£
‘©e->
obj
);

1279 i‡(
øã
->
›í_func
)

1280 
	`¢d_dlobj_ˇche_put
(
øã
->
›í_func
);

1281  
	`¢d_pcm_gíîic_˛o£
(
pcm
);

1282 
	}
}

1290 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_øã_¶ave_‰ames
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

1292 
¢d_pcm_u‰ames_t
 
s‰ames
;

1293 
¢d_pcm_øã_t
 *
øã
 = 
pcm
->
¥iv©e_d©a
;

1295 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

1296 
s‰ames
 = 
øã
->
›s
.
	`ouçut_‰ames
‘©e->
obj
, 
‰ames
);

1298 
s‰ames
 = 
øã
->
›s
.
	`öput_‰ames
‘©e->
obj
, 
‰ames
);

1300  
s‰ames
;

1301 
	}
}

1303 
	$¢d_pcm_øã_may_waô_f‹_avaû_mö
(
¢d_pcm_t
 *
pcm
,

1304 
¢d_pcm_u‰ames_t
 
avaû
)

1306  
	`¢d_pcm_∂ugö_may_waô_f‹_avaû_mö_c⁄v
(
pcm
, 
avaû
,

1307 
¢d_pcm_øã_¶ave_‰ames
);

1308 
	}
}

1310 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_øã_Á°_›s
 = {

1311 .
°©us
 = 
¢d_pcm_øã_°©us
,

1312 .
	g°©e
 = 
¢d_pcm_øã_°©e
,

1313 .
	ghwsync
 = 
¢d_pcm_øã_hwsync
,

1314 .
	gdñay
 = 
¢d_pcm_øã_dñay
,

1315 .
	g¥ï¨e
 = 
¢d_pcm_øã_¥ï¨e
,

1316 .
	gª£t
 = 
¢d_pcm_øã_ª£t
,

1317 .
	g°¨t
 = 
¢d_pcm_øã_°¨t
,

1318 .
	gdr›
 = 
¢d_pcm_gíîic_dr›
,

1319 .
	gdøö
 = 
¢d_pcm_øã_døö
,

1320 .
	g∑u£
 = 
¢d_pcm_gíîic_∑u£
,

1321 .
	gªwödabÀ
 = 
¢d_pcm_øã_ªwödabÀ
,

1322 .
	gªwöd
 = 
¢d_pcm_øã_ªwöd
,

1323 .
	gf‹w¨dabÀ
 = 
¢d_pcm_øã_f‹w¨dabÀ
,

1324 .
	gf‹w¨d
 = 
¢d_pcm_øã_f‹w¨d
,

1325 .
	gªsume
 = 
¢d_pcm_gíîic_ªsume
,

1326 .
	gwrôei
 = 
¢d_pcm_mm≠_wrôei
,

1327 .
	gwrôí
 = 
¢d_pcm_mm≠_wrôí
,

1328 .
	gªadi
 = 
¢d_pcm_mm≠_ªadi
,

1329 .
	gªadn
 = 
¢d_pcm_mm≠_ªadn
,

1330 .
	gavaû_upd©e
 = 
¢d_pcm_øã_avaû_upd©e
,

1331 .
	gmm≠_commô
 = 
¢d_pcm_øã_mm≠_commô
,

1332 .
	ghtime°amp
 = 
¢d_pcm_øã_htime°amp
,

1333 .
	gpﬁl_des¸ùt‹s_cou¡
 = 
¢d_pcm_gíîic_pﬁl_des¸ùt‹s_cou¡
,

1334 .
	gpﬁl_des¸ùt‹s
 = 
¢d_pcm_gíîic_pﬁl_des¸ùt‹s
,

1335 .
	gpﬁl_ªvíts
 = 
¢d_pcm_øã_pﬁl_ªvíts
,

1336 .
	gmay_waô_f‹_avaû_mö
 = 
¢d_pcm_øã_may_waô_f‹_avaû_mö
,

1339 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_øã_›s
 = {

1340 .
˛o£
 = 
¢d_pcm_øã_˛o£
,

1341 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

1342 .
	ghw_ªföe
 = 
¢d_pcm_øã_hw_ªföe
,

1343 .
	ghw_∑øms
 = 
¢d_pcm_øã_hw_∑øms
,

1344 .
	ghw_‰ì
 = 
¢d_pcm_øã_hw_‰ì
,

1345 .
	gsw_∑øms
 = 
¢d_pcm_øã_sw_∑øms
,

1346 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

1347 .
	gdump
 = 
¢d_pcm_øã_dump
,

1348 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

1349 .
	gasync
 = 
¢d_pcm_gíîic_async
,

1350 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

1351 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

1352 .
	gquîy_chm≠s
 = 
¢d_pcm_gíîic_quîy_chm≠s
,

1353 .
	ggë_chm≠
 = 
¢d_pcm_gíîic_gë_chm≠
,

1354 .
	g£t_chm≠
 = 
¢d_pcm_gíîic_£t_chm≠
,

1362 c⁄° 
¢d_c⁄fig_t
 *
	$¢d_pcm_øã_gë_deÁu…_c⁄vîãr
(
¢d_c⁄fig_t
 *
roŸ
)

1364 
¢d_c⁄fig_t
 *
n
;

1366 i‡(
	`¢d_c⁄fig_£¨ch
(
roŸ
, "deÁu…s.pcm.øã_c⁄vîãr", &
n
) >= 0)

1367  
n
;

1368  
NULL
;

1369 
	}
}

1371 
	$øã_öôül_£tup
(
¢d_pcm_øã_t
 *
øã
)

1373 i‡(
øã
->
∂ugö_vîsi⁄
 =
SND_PCM_RATE_PLUGIN_VERSION
)

1374 
øã
->
∂ugö_vîsi⁄
 =Ñ©e->
›s
.
vîsi⁄
;

1376 i‡(
øã
->
∂ugö_vîsi⁄
 >= 0x010002 &&

1377 
øã
->
›s
.
gë_suµ‹ãd_øãs
)

1378 
øã
->
›s
.
	`gë_suµ‹ãd_øãs
‘©e->
obj
,

1379 &
øã
->
øã_mö
,

1380 &
øã
->
øã_max
);

1382 i‡(
øã
->
∂ugö_vîsi⁄
 >= 0x010003 &&

1383 
øã
->
›s
.
gë_suµ‹ãd_f‹m©s
) {

1384 
øã
->
›s
.
	`gë_suµ‹ãd_f‹m©s
‘©e->
obj
,

1385 &
øã
->
ö_f‹m©s
,

1386 &
øã
->
out_f‹m©s
,

1387 &
øã
->
f‹m©_Êags
);

1388 } i‡(!
øã
->
›s
.
c⁄vît
 &&Ñ©e->›s.
c⁄vît_s16
) {

1389 
øã
->
ö_f‹m©s
 =Ñ©e->
out_f‹m©s
 =

1390 1ULL << 
SND_PCM_FORMAT_S16
;

1391 
øã
->
f‹m©_Êags
 = 
SND_PCM_RATE_FLAG_INTERLEAVED
;

1393 
	}
}

1395 #ifde‡
PIC


1396 
	$is_buûtö_∂ugö
(c⁄° *
ty≥
)

1398  
	`°rcmp
(
ty≥
, "linear") == 0;

1399 
	}
}

1401 c⁄° *c⁄° 
	gdeÁu…_øã_∂ugös
[] = {

1402 "•ìxøã", "löór", 
NULL


1405 
	$øã_›í_func
(
¢d_pcm_øã_t
 *
øã
, c⁄° *
ty≥
, c⁄° 
¢d_c⁄fig_t
 *
c⁄vîãr_c⁄f
, 
vîbo£
)

1407 
›í_«me
[64], 
›í_c⁄f_«me
[64], 
lib_«me
[64], *
lib
 = 
NULL
;

1408 
¢d_pcm_øã_›í_func_t
 
›í_func
;

1409 
¢d_pcm_øã_›í_c⁄f_func_t
 
›í_c⁄f_func
;

1410 
îr
;

1412 
	`¢¥ötf
(
›í_«me
, (›í_«me), "_¢d_pcm_øã_%s_›í", 
ty≥
);

1413 
	`¢¥ötf
(
›í_c⁄f_«me
, (›í_c⁄f_«me), "_¢d_pcm_øã_%s_›í_c⁄f", 
ty≥
);

1414 i‡(!
	`is_buûtö_∂ugö
(
ty≥
)) {

1415 
	`¢¥ötf
(
lib_«me
, (lib_name),

1416 "libasound_moduÀ_øã_%s.so", 
ty≥
);

1417 
lib
 = 
lib_«me
;

1420 
›í_c⁄f_func
 = 
	`¢d_dlobj_ˇche_gë
(
lib
, 
›í_c⁄f_«me
, 
NULL
, 
vîbo£
 && 
c⁄vîãr_c⁄f
 != NULL);

1421 i‡(
›í_c⁄f_func
) {

1422 
îr
 = 
	`›í_c⁄f_func
(
SND_PCM_RATE_PLUGIN_VERSION
,

1423 &
øã
->
obj
, &øã->
›s
, 
c⁄vîãr_c⁄f
);

1424 i‡(!
îr
) {

1425 
øã
->
›í_func
 = 
›í_c⁄f_func
;

1428 
	`¢d_dlobj_ˇche_put
(
›í_c⁄f_func
);

1429  
îr
;

1433 
›í_func
 = 
	`¢d_dlobj_ˇche_gë
(
lib
, 
›í_«me
, 
NULL
, 
vîbo£
);

1434 i‡(!
›í_func
)

1435  -
ENOENT
;

1437 
øã
->
›í_func
 = open_func;

1439 
îr
 = 
	`›í_func
(
SND_PCM_RATE_PLUGIN_VERSION
, &
øã
->
obj
, &øã->
›s
);

1440 i‡(!
îr
)

1444 
øã
->
∂ugö_vîsi⁄
 = 
SND_PCM_RATE_PLUGIN_VERSION_OLD
;

1445 
îr
 = 
	`›í_func
(
SND_PCM_RATE_PLUGIN_VERSION_OLD
,

1446 &
øã
->
obj
, &øã->
›s
);

1447 i‡(!
îr
)

1450 
	`¢d_dlobj_ˇche_put
(
›í_func
);

1451 
øã
->
›í_func
 = 
NULL
;

1452  
îr
;

1453 
	}
}

1461 
	$is_°rög_¨øy
(c⁄° 
¢d_c⁄fig_t
 *
c⁄f
)

1463 
¢d_c⁄fig_ôî©‹_t
 
i
;

1465 i‡(
	`¢d_c⁄fig_gë_ty≥
(
c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
)

1468 
i
 = 
	`¢d_c⁄fig_ôî©‹_fú°
(
c⁄f
);

1469 i‡(
i
 && i !
	`¢d_c⁄fig_ôî©‹_íd
(
c⁄f
)) {

1470 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1471 c⁄° *
id
;

1472 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1474 i‡(
id
 && 
	`°rcmp
(id, "0") != 0)

1479 
	}
}

1495 
	$¢d_pcm_øã_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1496 
¢d_pcm_f‹m©_t
 
sf‹m©
, 
§©e
,

1497 c⁄° 
¢d_c⁄fig_t
 *
c⁄vîãr
,

1498 
¢d_pcm_t
 *
¶ave
, 
˛o£_¶ave
)

1500 
¢d_pcm_t
 *
pcm
;

1501 
¢d_pcm_øã_t
 *
øã
;

1502 c⁄° *
ty≥
 = 
NULL
;

1503 
îr
;

1504 #i‚de‡
PIC


1505 
¢d_pcm_øã_›í_func_t
 
›í_func
;

1506 
	`SND_PCM_RATE_PLUGIN_ENTRY
(
löór
Ë(
vîsi⁄
, **
objp
, 
¢d_pcm_øã_›s_t
 *
›s
);

1509 
	`as£π
(
pcmp
 && 
¶ave
);

1510 i‡(
sf‹m©
 !
SND_PCM_FORMAT_UNKNOWN
 &&

1511 
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1)

1512  -
EINVAL
;

1513 
øã
 = 
	`ˇŒoc
(1, (
¢d_pcm_øã_t
));

1514 i‡(!
øã
) {

1515  -
ENOMEM
;

1517 
øã
->
gí
.
¶ave
 = slave;

1518 
øã
->
gí
.
˛o£_¶ave
 = close_slave;

1519 
øã
->
§©e
 = srate;

1520 
øã
->
sf‹m©
 = sformat;

1522 
øã
->
øã_mö
 = 
SND_PCM_PLUGIN_RATE_MIN
;

1523 
øã
->
øã_max
 = 
SND_PCM_PLUGIN_RATE_MAX
;

1524 
øã
->
∂ugö_vîsi⁄
 = 
SND_PCM_RATE_PLUGIN_VERSION
;

1526 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_RATE
, 
«me
, 
¶ave
->
°ªam
, sœve->
mode
);

1527 i‡(
îr
 < 0) {

1528 
	`‰ì
(
øã
);

1529  
îr
;

1532 #ifde‡
PIC


1533 
îr
 = -
ENOENT
;

1534 i‡(!
c⁄vîãr
) {

1535 c⁄° *c⁄° *
ty≥s
;

1536 
ty≥s
 = 
deÁu…_øã_∂ugös
; *types;Åypes++) {

1537 
îr
 = 
	`øã_›í_func
(
øã
, *
ty≥s
, 
NULL
, 0);

1538 i‡(!
îr
) {

1539 
ty≥
 = *
ty≥s
;

1543 } i‡(!
	`¢d_c⁄fig_gë_°rög
(
c⁄vîãr
, &
ty≥
))

1544 
îr
 = 
	`øã_›í_func
(
øã
, 
ty≥
, 
NULL
, 1);

1545 i‡(
	`is_°rög_¨øy
(
c⁄vîãr
)) {

1546 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1547 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄vîãr
) {

1548 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1549 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
ty≥
) < 0)

1551 
îr
 = 
	`øã_›í_func
(
øã
, 
ty≥
, 
NULL
, 0);

1552 i‡(!
îr
)

1555 } i‡(
	`¢d_c⁄fig_gë_ty≥
(
c⁄vîãr
Ë=
SND_CONFIG_TYPE_COMPOUND
) {

1556 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1557 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄vîãr
) {

1558 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1559 c⁄° *
id
;

1560 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1562 i‡(
	`°rcmp
(
id
, "name") != 0)

1564 
	`¢d_c⁄fig_gë_°rög
(
n
, &
ty≥
);

1567 i‡(!
ty≥
) {

1568 
	`SNDERR
("NoÇame given forÑate converter");

1569 
	`¢d_pcm_‰ì
(
pcm
);

1570 
	`‰ì
(
øã
);

1571  -
EINVAL
;

1573 
îr
 = 
	`øã_›í_func
(
øã
, 
ty≥
, 
c⁄vîãr
, 1);

1575 
	`SNDERR
("InvalidÅype forÑate converter");

1576 
	`¢d_pcm_‰ì
(
pcm
);

1577 
	`‰ì
(
øã
);

1578  -
EINVAL
;

1580 i‡(
îr
 < 0) {

1581 
	`SNDERR
("Cannot findÑate converter");

1582 
	`¢d_pcm_‰ì
(
pcm
);

1583 
	`‰ì
(
øã
);

1584  -
ENOENT
;

1587 
ty≥
 = "linear";

1588 
›í_func
 = 
	`SND_PCM_RATE_PLUGIN_ENTRY
(
löór
);

1589 
îr
 = 
	`›í_func
(
SND_PCM_RATE_PLUGIN_VERSION
, &
øã
->
obj
, &øã->
›s
);

1590 i‡(
îr
 < 0) {

1591 
	`¢d_pcm_‰ì
(
pcm
);

1592 
	`‰ì
(
øã
);

1593  
îr
;

1597 i‡(! 
øã
->
›s
.
öô
 || ! (øã->›s.
c⁄vît
 ||Ñ©e->›s.
c⁄vît_s16
) ||

1598 ! 
øã
->
›s
.
öput_‰ames
 || !Ñ©e->›s.
ouçut_‰ames
) {

1599 
	`SNDERR
("I≈r›îÑ©ê∂ugö %†öôüliz©i⁄", 
ty≥
);

1600 
	`¢d_pcm_‰ì
(
pcm
);

1601 
	`‰ì
(
øã
);

1602  
îr
;

1605 
	`øã_öôül_£tup
(
øã
);

1607 
pcm
->
›s
 = &
¢d_pcm_øã_›s
;

1608 
pcm
->
Á°_›s
 = &
¢d_pcm_øã_Á°_›s
;

1609 
pcm
->
¥iv©e_d©a
 = 
øã
;

1610 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

1611 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

1612 
pcm
->
mm≠_rw
 = 1;

1613 
pcm
->
t°amp_ty≥
 = 
¶ave
->tstamp_type;

1614 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
øã
->
hw_±r
, -1, 0);

1615 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
øã
->
≠∂_±r
, -1, 0);

1616 *
pcmp
 = 
pcm
;

1619 
	}
}

1674 
	$_¢d_pcm_øã_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1675 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

1676 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

1678 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1679 
îr
;

1680 
¢d_pcm_t
 *
•cm
;

1681 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

1682 
¢d_pcm_f‹m©_t
 
sf‹m©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1683 
§©e
 = -1;

1684 c⁄° 
¢d_c⁄fig_t
 *
c⁄vîãr
 = 
NULL
;

1686 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1687 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1688 c⁄° *
id
;

1689 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1691 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

1693 i‡(
	`°rcmp
(
id
, "slave") == 0) {

1694 
¶ave
 = 
n
;

1697 i‡(
	`°rcmp
(
id
, "converter") == 0) {

1698 
c⁄vîãr
 = 
n
;

1701 
	`SNDERR
("Unknow¿fõld %s", 
id
);

1702  -
EINVAL
;

1704 i‡(!
¶ave
) {

1705 
	`SNDERR
("slave isÇot defined");

1706  -
EINVAL
;

1709 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 2,

1710 
SND_PCM_HW_PARAM_FORMAT
, 0, &
sf‹m©
,

1711 
SND_PCM_HW_PARAM_RATE
, 
SCONF_MANDATORY
, &
§©e
);

1712 i‡(
îr
 < 0)

1713  
îr
;

1714 i‡(
sf‹m©
 !
SND_PCM_FORMAT_UNKNOWN
 &&

1715 
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1) {

1716 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1717 
	`SNDERR
("slave format isÇotÜinear");

1718  -
EINVAL
;

1720 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

1721 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1722 i‡(
îr
 < 0)

1723  
îr
;

1724 
îr
 = 
	`¢d_pcm_øã_›í
(
pcmp
, 
«me
, 
sf‹m©
, (Ë
§©e
,

1725 
c⁄vîãr
, 
•cm
, 1);

1726 i‡(
îr
 < 0)

1727 
	`¢d_pcm_˛o£
(
•cm
);

1728  
îr
;

1729 
	}
}

1730 #i‚de‡
DOC_HIDDEN


1731 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_øã_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_rate_linear.c

23 
	~"pcm_loˇl.h
"

24 
	~"pcm_∂ugö.h
"

25 
	~"pcm_øã.h
"

26 
	~"∂ugö_›s.h
"

27 
	~"bsw≠.h
"

28 
	~<öây≥s.h
>

32 
	#LINEAR_DIV_SHIFT
 19

	)

33 
	#LINEAR_DIV
 (1<<
LINEAR_DIV_SHIFT
)

	)

35 
	søã_löór
 {

36 
	mgë_idx
;

37 
	mput_idx
;

38 
	mpôch
;

39 
	mpôch_shi·
;

40 
	mch™√ls
;

41 
öt16_t
 *
	mﬁd_ßm∂e
;

42 (*
	mfunc
)(
øã_löór
 *
	møã
,

43 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
	md°_¨ós
,

44 
¢d_pcm_u‰ames_t
 
	md°_off£t
, 
	md°_‰ames
,

45 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
	m§c_¨ós
,

46 
¢d_pcm_u‰ames_t
 
	m§c_off£t
, 
	m§c_‰ames
);

49 
¢d_pcm_u‰ames_t
 
	$öput_‰ames
(*
obj
, 
¢d_pcm_u‰ames_t
 
‰ames
)

51 
øã_löór
 *
øã
 = 
obj
;

52 i‡(
‰ames
 == 0)

55  
	`muldiv_√¨
(
‰ames
, 
LINEAR_DIV
, 
øã
->
pôch
);

56 
	}
}

58 
¢d_pcm_u‰ames_t
 
	$ouçut_‰ames
(*
obj
, 
¢d_pcm_u‰ames_t
 
‰ames
)

60 
øã_löór
 *
øã
 = 
obj
;

61 i‡(
‰ames
 == 0)

64  
	`muldiv_√¨
(
‰ames
, 
øã
->
pôch
, 
LINEAR_DIV
);

65 
	}
}

67 
	$löór_ex∑nd
(
øã_löór
 *
øã
,

68 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

69 
¢d_pcm_u‰ames_t
 
d°_off£t
, 
d°_‰ames
,

70 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

71 
¢d_pcm_u‰ames_t
 
§c_off£t
, 
§c_‰ames
)

73 
	#GET16_LABELS


	)

74 
	#PUT16_LABELS


	)

75 
	~"∂ugö_›s.h
"

76 #unde‡
GET16_LABELS


77 #unde‡
PUT16_LABELS


78 *
gë
 = 
gë16_œbñs
[
øã
->
gë_idx
];

79 *
put
 = 
put16_œbñs
[
øã
->
put_idx
];

80 
gë_thªshﬁd
 = 
øã
->
pôch
;

81 
ch™√l
;

82 
§c_‰ames1
;

83 
d°_‰ames1
;

84 
öt16_t
 
ßm∂e
 = 0;

85 
pos
;

87 
ch™√l
 = 0; ch™√»< 
øã
->
ch™√ls
; ++channel) {

88 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

89 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

90 c⁄° *
§c
;

91 *
d°
;

92 
§c_°ï
, 
d°_°ï
;

93 
öt16_t
 
ﬁd_ßm∂e
 = 0;

94 
öt16_t
 
√w_ßm∂e
;

95 
ﬁd_weight
, 
√w_weight
;

96 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

97 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

98 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
);

99 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
);

100 
§c_‰ames1
 = 0;

101 
d°_‰ames1
 = 0;

102 
√w_ßm∂e
 = 
øã
->
ﬁd_ßm∂e
[
ch™√l
];

103 
pos
 = 
gë_thªshﬁd
;

104 
d°_‰ames1
 < 
d°_‰ames
) {

105 i‡(
pos
 >
gë_thªshﬁd
) {

106 
pos
 -
gë_thªshﬁd
;

107 
ﬁd_ßm∂e
 = 
√w_ßm∂e
;

108 i‡(
§c_‰ames1
 < 
§c_‰ames
) {

109 *
gë
;

110 
	#GET16_END
 
a·î_gë


	)

111 
	~"∂ugö_›s.h
"

112 #unde‡
GET16_END


113 
a·î_gë
:

114 
√w_ßm∂e
 = 
ßm∂e
;

117 
√w_weight
 = (
pos
 << (16 - 
øã
->
pôch_shi·
)Ë/ (
gë_thªshﬁd
 >>Ñate->pitch_shift);

118 
ﬁd_weight
 = 0x10000 - 
√w_weight
;

119 
ßm∂e
 = (
ﬁd_ßm∂e
 * 
ﬁd_weight
 + 
√w_ßm∂e
 * 
√w_weight
) >> 16;

120 *
put
;

121 
	#PUT16_END
 
a·î_put


	)

122 
	~"∂ugö_›s.h
"

123 #unde‡
PUT16_END


124 
a·î_put
:

125 
d°
 +
d°_°ï
;

126 
d°_‰ames1
++;

127 
pos
 +
LINEAR_DIV
;

128 i‡(
pos
 >
gë_thªshﬁd
) {

129 
§c
 +
§c_°ï
;

130 
§c_‰ames1
++;

133 
øã
->
ﬁd_ßm∂e
[
ch™√l
] = 
√w_ßm∂e
;

135 
	}
}

138 
	$löór_ex∑nd_s16
(
øã_löór
 *
øã
,

139 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

140 
¢d_pcm_u‰ames_t
 
d°_off£t
, 
d°_‰ames
,

141 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

142 
¢d_pcm_u‰ames_t
 
§c_off£t
, 
§c_‰ames
)

144 
ch™√l
;

145 
§c_‰ames1
;

146 
d°_‰ames1
;

147 
gë_thªshﬁd
 = 
øã
->
pôch
;

148 
pos
;

150 
ch™√l
 = 0; ch™√»< 
øã
->
ch™√ls
; ++channel) {

151 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

152 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

153 c⁄° 
öt16_t
 *
§c
;

154 
öt16_t
 *
d°
;

155 
§c_°ï
, 
d°_°ï
;

156 
öt16_t
 
ﬁd_ßm∂e
 = 0;

157 
öt16_t
 
√w_ßm∂e
;

158 
ﬁd_weight
, 
√w_weight
;

159 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

160 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

161 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
) >> 1;

162 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
) >> 1;

163 
§c_‰ames1
 = 0;

164 
d°_‰ames1
 = 0;

165 
√w_ßm∂e
 = 
øã
->
ﬁd_ßm∂e
[
ch™√l
];

166 
pos
 = 
gë_thªshﬁd
;

167 
d°_‰ames1
 < 
d°_‰ames
) {

168 i‡(
pos
 >
gë_thªshﬁd
) {

169 
pos
 -
gë_thªshﬁd
;

170 
ﬁd_ßm∂e
 = 
√w_ßm∂e
;

171 i‡(
§c_‰ames1
 < 
§c_‰ames
)

172 
√w_ßm∂e
 = *
§c
;

174 
√w_weight
 = (
pos
 << (16 - 
øã
->
pôch_shi·
)Ë/ (
gë_thªshﬁd
 >>Ñate->pitch_shift);

175 
ﬁd_weight
 = 0x10000 - 
√w_weight
;

176 *
d°
 = (
ﬁd_ßm∂e
 * 
ﬁd_weight
 + 
√w_ßm∂e
 * 
√w_weight
) >> 16;

177 
d°
 +
d°_°ï
;

178 
d°_‰ames1
++;

179 
pos
 +
LINEAR_DIV
;

180 i‡(
pos
 >
gë_thªshﬁd
) {

181 
§c
 +
§c_°ï
;

182 
§c_‰ames1
++;

185 
øã
->
ﬁd_ßm∂e
[
ch™√l
] = 
√w_ßm∂e
;

187 
	}
}

189 
	$löór_shrök
(
øã_löór
 *
øã
,

190 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

191 
¢d_pcm_u‰ames_t
 
d°_off£t
, 
d°_‰ames
,

192 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

193 
¢d_pcm_u‰ames_t
 
§c_off£t
, 
§c_‰ames
)

195 
	#GET16_LABELS


	)

196 
	#PUT16_LABELS


	)

197 
	~"∂ugö_›s.h
"

198 #unde‡
GET16_LABELS


199 #unde‡
PUT16_LABELS


200 *
gë
 = 
gë16_œbñs
[
øã
->
gë_idx
];

201 *
put
 = 
put16_œbñs
[
øã
->
put_idx
];

202 
gë_ö¸emít
 = 
øã
->
pôch
;

203 
ch™√l
;

204 
§c_‰ames1
;

205 
d°_‰ames1
;

206 
öt16_t
 
ßm∂e
 = 0;

207 
pos
;

209 
ch™√l
 = 0; ch™√»< 
øã
->
ch™√ls
; ++channel) {

210 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

211 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

212 c⁄° *
§c
;

213 *
d°
;

214 
§c_°ï
, 
d°_°ï
;

215 
öt16_t
 
ﬁd_ßm∂e
 = 0;

216 
öt16_t
 
√w_ßm∂e
 = 0;

217 
ﬁd_weight
, 
√w_weight
;

218 
pos
 = 
LINEAR_DIV
 - 
gë_ö¸emít
;

219 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

220 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

221 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
);

222 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
);

223 
§c_‰ames1
 = 0;

224 
d°_‰ames1
 = 0;

225 
§c_‰ames1
 < 
§c_‰ames
) {

227 *
gë
;

228 
	#GET16_END
 
a·î_gë


	)

229 
	~"∂ugö_›s.h
"

230 #unde‡
GET16_END


231 
a·î_gë
:

232 
√w_ßm∂e
 = 
ßm∂e
;

233 
§c
 +
§c_°ï
;

234 
§c_‰ames1
++;

235 
pos
 +
gë_ö¸emít
;

236 i‡(
pos
 >
LINEAR_DIV
) {

237 
pos
 -
LINEAR_DIV
;

238 
ﬁd_weight
 = (
pos
 << (32 - 
LINEAR_DIV_SHIFT
)Ë/ (
gë_ö¸emít
 >> (LINEAR_DIV_SHIFT - 16));

239 
√w_weight
 = 0x10000 - 
ﬁd_weight
;

240 
ßm∂e
 = (
ﬁd_ßm∂e
 * 
ﬁd_weight
 + 
√w_ßm∂e
 * 
√w_weight
) >> 16;

241 *
put
;

242 
	#PUT16_END
 
a·î_put


	)

243 
	~"∂ugö_›s.h
"

244 #unde‡
PUT16_END


245 
a·î_put
:

246 
d°
 +
d°_°ï
;

247 
d°_‰ames1
++;

248 i‡(
	`CHECK_SANITY
(
d°_‰ames1
 > 
d°_‰ames
)) {

249 
	`SNDERR
("dst_frames overflow");

253 
ﬁd_ßm∂e
 = 
√w_ßm∂e
;

256 
	}
}

259 
	$löór_shrök_s16
(
øã_löór
 *
øã
,

260 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

261 
¢d_pcm_u‰ames_t
 
d°_off£t
, 
d°_‰ames
,

262 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

263 
¢d_pcm_u‰ames_t
 
§c_off£t
, 
§c_‰ames
)

265 
gë_ö¸emít
 = 
øã
->
pôch
;

266 
ch™√l
;

267 
§c_‰ames1
;

268 
d°_‰ames1
;

269 
pos
 = 0;

271 
ch™√l
 = 0; ch™√»< 
øã
->
ch™√ls
; ++channel) {

272 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

273 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
 = &
d°_¨ós
[
ch™√l
];

274 c⁄° 
öt16_t
 *
§c
;

275 
öt16_t
 *
d°
;

276 
§c_°ï
, 
d°_°ï
;

277 
öt16_t
 
ﬁd_ßm∂e
 = 0;

278 
öt16_t
 
√w_ßm∂e
 = 0;

279 
ﬁd_weight
, 
√w_weight
;

280 
pos
 = 
LINEAR_DIV
 - 
gë_ö¸emít
;

281 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

282 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

283 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
) >> 1;

284 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
) >> 1 ;

285 
§c_‰ames1
 = 0;

286 
d°_‰ames1
 = 0;

287 
§c_‰ames1
 < 
§c_‰ames
) {

289 
√w_ßm∂e
 = *
§c
;

290 
§c
 +
§c_°ï
;

291 
§c_‰ames1
++;

292 
pos
 +
gë_ö¸emít
;

293 i‡(
pos
 >
LINEAR_DIV
) {

294 
pos
 -
LINEAR_DIV
;

295 
ﬁd_weight
 = (
pos
 << (32 - 
LINEAR_DIV_SHIFT
)Ë/ (
gë_ö¸emít
 >> (LINEAR_DIV_SHIFT - 16));

296 
√w_weight
 = 0x10000 - 
ﬁd_weight
;

297 *
d°
 = (
ﬁd_ßm∂e
 * 
ﬁd_weight
 + 
√w_ßm∂e
 * 
√w_weight
) >> 16;

298 
d°
 +
d°_°ï
;

299 
d°_‰ames1
++;

300 i‡(
	`CHECK_SANITY
(
d°_‰ames1
 > 
d°_‰ames
)) {

301 
	`SNDERR
("dst_frames overflow");

305 
ﬁd_ßm∂e
 = 
√w_ßm∂e
;

308 
	}
}

310 
	$löór_c⁄vît
(*
obj
,

311 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

312 
¢d_pcm_u‰ames_t
 
d°_off£t
, 
d°_‰ames
,

313 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

314 
¢d_pcm_u‰ames_t
 
§c_off£t
, 
§c_‰ames
)

316 
øã_löór
 *
øã
 = 
obj
;

317 
øã
->
	`func
‘©e, 
d°_¨ós
, 
d°_off£t
, 
d°_‰ames
,

318 
§c_¨ós
, 
§c_off£t
, 
§c_‰ames
);

319 
	}
}

321 
	$löór_‰ì
(*
obj
)

323 
øã_löór
 *
øã
 = 
obj
;

325 
	`‰ì
(
øã
->
ﬁd_ßm∂e
);

326 
øã
->
ﬁd_ßm∂e
 = 
NULL
;

327 
	}
}

329 
	$löór_öô
(*
obj
, 
¢d_pcm_øã_öfo_t
 *
öfo
)

331 
øã_löór
 *
øã
 = 
obj
;

333 
øã
->
gë_idx
 = 
	`¢d_pcm_löór_gë_ödex
(
öfo
->
ö
.
f‹m©
, 
SND_PCM_FORMAT_S16
);

334 
øã
->
put_idx
 = 
	`¢d_pcm_löór_put_ödex
(
SND_PCM_FORMAT_S16
, 
öfo
->
out
.
f‹m©
);

335 i‡(
öfo
->
ö
.
øã
 < info->
out
.rate) {

336 i‡(
öfo
->
ö
.
f‹m©
 =öfo->
out
.f‹m© && info->ö.f‹m© =
SND_PCM_FORMAT_S16
)

337 
øã
->
func
 = 
löór_ex∑nd_s16
;

339 
øã
->
func
 = 
löór_ex∑nd
;

342 i‡(
öfo
->
ö
.
f‹m©
 =öfo->
out
.f‹m© && info->ö.f‹m© =
SND_PCM_FORMAT_S16
)

343 
øã
->
func
 = 
löór_shrök_s16
;

345 
øã
->
func
 = 
löór_shrök
;

348 
øã
->
pôch
 = (((
uöt64_t
)
öfo
->
out
.øã * 
LINEAR_DIV
) +

349 (
öfo
->
ö
.
øã
 / 2)) / info->in.rate;

350 
øã
->
ch™√ls
 = 
öfo
->channels;

352 
	`‰ì
(
øã
->
ﬁd_ßm∂e
);

353 
øã
->
ﬁd_ßm∂e
 = 
	`mÆloc
((*øã->ﬁd_ßm∂eË*Ñ©e->
ch™√ls
);

354 i‡(! 
øã
->
ﬁd_ßm∂e
)

355  -
ENOMEM
;

358 
	}
}

360 
	$löór_adju°_pôch
(*
obj
, 
¢d_pcm_øã_öfo_t
 *
öfo
)

362 
øã_löór
 *
øã
 = 
obj
;

363 
¢d_pcm_u‰ames_t
 
c‰ames
;

365 
øã
->
pôch
 = (((
uöt64_t
)
öfo
->
out
.
≥riod_size
 * 
LINEAR_DIV
) +

366 (
öfo
->
ö
.
≥riod_size
/2) ) / info->in.period_size;

368 
c‰ames
 = 
	`öput_‰ames
(
øã
, 
öfo
->
out
.
≥riod_size
);

369 
c‰ames
 !
öfo
->
ö
.
≥riod_size
) {

370 
¢d_pcm_u‰ames_t
 
c‰ames_√w
;

371 i‡(
c‰ames
 > 
öfo
->
ö
.
≥riod_size
)

372 
øã
->
pôch
++;

374 
øã
->
pôch
--;

375 
c‰ames_√w
 = 
	`öput_‰ames
(
øã
, 
öfo
->
out
.
≥riod_size
);

376 i‡((
c‰ames
 > 
öfo
->
ö
.
≥riod_size
 && 
c‰ames_√w
 < info->in.period_size) ||

377 (
c‰ames
 < 
öfo
->
ö
.
≥riod_size
 && 
c‰ames_√w
 > info->in.period_size)) {

378 
	`SNDERR
("invalidÖcmÖeriod_size %ld -> %ld",

379 
öfo
->
ö
.
≥riod_size
, info->
out
.period_size);

380  -
EIO
;

382 
c‰ames
 = 
c‰ames_√w
;

384 i‡(
øã
->
pôch
 >
LINEAR_DIV
) {

386 
øã
->
pôch_shi·
 = 0;

387 (
øã
->
pôch
 >>Ñ©e->
pôch_shi·
) >= (1 << 16))

388 
øã
->
pôch_shi·
++;

391 
	}
}

393 
	$löór_ª£t
(*
obj
)

395 
øã_löór
 *
øã
 = 
obj
;

398 i‡(
øã
->
ﬁd_ßm∂e
)

399 
	`mem£t
(
øã
->
ﬁd_ßm∂e
, 0, (*øã->ﬁd_ßm∂eË*Ñ©e->
ch™√ls
);

400 
	}
}

402 
	$löór_˛o£
(*
obj
)

404 
	`‰ì
(
obj
);

405 
	}
}

407 
	$gë_suµ‹ãd_øãs
(
ATTRIBUTE_UNUSED
 *
øã
,

408 *
øã_mö
, *
øã_max
)

410 *
øã_mö
 = 
SND_PCM_PLUGIN_RATE_MIN
;

411 *
øã_max
 = 
SND_PCM_PLUGIN_RATE_MAX
;

413 
	}
}

415 
	$löór_dump
(
ATTRIBUTE_UNUSED
 *
øã
, 
¢d_ouçut_t
 *
out
)

417 
	`¢d_ouçut_¥ötf
(
out
, "Converter:Üinear-interpolation\n");

418 
	}
}

420 c⁄° 
¢d_pcm_øã_›s_t
 
	glöór_›s
 = {

421 .
˛o£
 = 
löór_˛o£
,

422 .
	göô
 = 
löór_öô
,

423 .
	g‰ì
 = 
löór_‰ì
,

424 .
	gª£t
 = 
löór_ª£t
,

425 .
	gadju°_pôch
 = 
löór_adju°_pôch
,

426 .
	gc⁄vît
 = 
löór_c⁄vît
,

427 .
	göput_‰ames
 = 
öput_‰ames
,

428 .
	gouçut_‰ames
 = 
ouçut_‰ames
,

429 .
	gvîsi⁄
 = 
SND_PCM_RATE_PLUGIN_VERSION
,

430 .
	ggë_suµ‹ãd_øãs
 = 
gë_suµ‹ãd_øãs
,

431 .
	gdump
 = 
löór_dump
,

434 
	$SND_PCM_RATE_PLUGIN_ENTRY
(
löór
Ë(
ATTRIBUTE_UNUSED
 
vîsi⁄
,

435 **
objp
, 
¢d_pcm_øã_›s_t
 *
›s
)

437 
øã_löór
 *
øã
;

439 
øã
 = 
	`ˇŒoc
(1, (*rate));

440 i‡(! 
øã
)

441  -
ENOMEM
;

443 *
objp
 = 
øã
;

444 *
›s
 = 
löór_›s
;

446 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_route.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_∂ugö.h
"

31 
	~"∂ugö_›s.h
"

32 
	~"bsw≠.h
"

33 
	~<m©h.h
>

35 #i‚de‡
PIC


37 c⁄° *
	g_¢d_moduÀ_pcm_rouã
 = "";

40 #i‚de‡
DOC_HIDDEN


43 #i‡
SND_PCM_PLUGIN_ROUTE_RESOLUTION
 & (SND_PCM_PLUGIN_ROUTE_RESOLUTION - 1) != 0

44 
	#div
(
a
Ë®/
SND_PCM_PLUGIN_ROUTE_RESOLUTION


	)

45 #ñi‡
SND_PCM_PLUGIN_ROUTE_RESOLUTION
 == 16

46 
	#div
(
a
Ë®>>4

	)

52 
	mch™√l
;

53 
	mas_öt
;

54 #i‡
SND_PCM_PLUGIN_ROUTE_FLOAT


55 
	mas_Êﬂt
;

57 } 
	t¢d_pcm_rouã_âabÀ_§c_t
;

59 
¢d_pcm_rouã_âabÀ_d°
 
	t¢d_pcm_rouã_âabÀ_d°_t
;

62 íum {
	mUINT64
, 
	mFLOAT
} 
	msum_idx
;

63 
	mgë_idx
;

64 
	mput_idx
;

65 
	mc⁄v_idx
;

66 
	mu£_gëput
;

67 
	m§c_size
;

68 
¢d_pcm_f‹m©_t
 
	md°_sfmt
;

69 
	mn§cs
;

70 
	mnd°s
;

71 
¢d_pcm_rouã_âabÀ_d°_t
 *
	md°s
;

72 } 
	t¢d_pcm_rouã_∑øms_t
;

75 (*
	trouã_f
)(c⁄° 
	t¢d_pcm_ch™√l_¨ó_t
 *
	td°_¨ó
,

76 
	t¢d_pcm_u‰ames_t
 
	td°_off£t
,

77 c⁄° 
	t¢d_pcm_ch™√l_¨ó_t
 *
	t§c_¨ós
,

78 
	t¢d_pcm_u‰ames_t
 
	t§c_off£t
,

79 
	t§c_ch™√ls
,

80 
	t¢d_pcm_u‰ames_t
 
	t‰ames
,

81 c⁄° 
	t¢d_pcm_rouã_âabÀ_d°_t
 *
	tâabÀ
,

82 c⁄° 
	t¢d_pcm_rouã_∑øms_t
 *
	t∑øms
);

84 
	s¢d_pcm_rouã_âabÀ_d°
 {

85 
©t
;

86 
n§cs
;

87 
¢d_pcm_rouã_âabÀ_§c_t
* 
§cs
;

88 
rouã_f
 
func
;

92 
öt32_t
 
as_söt32
;

93 
öt64_t
 
as_söt64
;

94 #i‡
SND_PCM_PLUGIN_ROUTE_FLOAT


95 
as_Êﬂt
;

97 } 
	tsum_t
;

101 
¢d_pcm_∂ugö_t
 
∂ug
;

102 
¢d_pcm_f‹m©_t
 
sf‹m©
;

103 
sch™√ls
;

104 
¢d_pcm_rouã_∑øms_t
 
∑øms
;

105 
¢d_pcm_chm≠_t
 *
chm≠
;

106 
¢d_pcm_chm≠_quîy_t
 **
chm≠_ovîride
;

107 } 
	t¢d_pcm_rouã_t
;

111 
	$¢d_pcm_rouã_c⁄vît1_zîo
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
,

112 
¢d_pcm_u‰ames_t
 
d°_off£t
,

113 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
 
ATTRIBUTE_UNUSED
,

114 
¢d_pcm_u‰ames_t
 
§c_off£t
 
ATTRIBUTE_UNUSED
,

115 
§c_ch™√ls
 
ATTRIBUTE_UNUSED
,

116 
¢d_pcm_u‰ames_t
 
‰ames
,

117 c⁄° 
¢d_pcm_rouã_âabÀ_d°_t
* 
âabÀ
 
ATTRIBUTE_UNUSED
,

118 c⁄° 
¢d_pcm_rouã_∑øms_t
 *
∑øms
)

120 
	`¢d_pcm_¨ó_sûí˚
(
d°_¨ó
, 
d°_off£t
, 
‰ames
, 
∑øms
->
d°_sfmt
);

121 
	}
}

123 #i‚de‡
DOC_HIDDEN


125 
	$¢d_pcm_rouã_c⁄vît1_⁄e
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
,

126 
¢d_pcm_u‰ames_t
 
d°_off£t
,

127 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

128 
¢d_pcm_u‰ames_t
 
§c_off£t
,

129 
§c_ch™√ls
,

130 
¢d_pcm_u‰ames_t
 
‰ames
,

131 c⁄° 
¢d_pcm_rouã_âabÀ_d°_t
* 
âabÀ
,

132 c⁄° 
¢d_pcm_rouã_∑øms_t
 *
∑øms
)

134 
	#CONV_LABELS


	)

135 
	~"∂ugö_›s.h
"

136 #unde‡
CONV_LABELS


137 *
c⁄v
;

138 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = 0;

139 
§cidx
;

140 c⁄° *
§c
;

141 *
d°
;

142 
§c_°ï
, 
d°_°ï
;

143 
§cidx
 = 0; srcidx < 
âabÀ
->
n§cs
 && srcidx < 
§c_ch™√ls
; ++srcidx) {

144 
ch™√l
 = 
âabÀ
->
§cs
[
§cidx
].channel;

145 i‡(
ch™√l
 >
§c_ch™√ls
)

147 
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

148 i‡(
§c_¨ó
->
addr
 !
NULL
)

151 i‡(
§cidx
 =
âabÀ
->
n§cs
 || srcidx =
§c_ch™√ls
) {

152 
	`¢d_pcm_rouã_c⁄vît1_zîo
(
d°_¨ó
, 
d°_off£t
,

153 
§c_¨ós
, 
§c_off£t
,

154 
§c_ch™√ls
,

155 
‰ames
, 
âabÀ
, 
∑øms
);

159 
c⁄v
 = 
c⁄v_œbñs
[
∑øms
->
c⁄v_idx
];

160 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

161 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

162 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
);

163 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
);

164 
‰ames
-- > 0) {

165 *
c⁄v
;

166 
	#CONV_END
 
a·î


	)

167 
	~"∂ugö_›s.h
"

168 #unde‡
CONV_END


169 
a·î
:

170 
§c
 +
§c_°ï
;

171 
d°
 +
d°_°ï
;

173 
	}
}

175 
	$¢d_pcm_rouã_c⁄vît1_⁄e_gëput
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
,

176 
¢d_pcm_u‰ames_t
 
d°_off£t
,

177 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

178 
¢d_pcm_u‰ames_t
 
§c_off£t
,

179 
§c_ch™√ls
,

180 
¢d_pcm_u‰ames_t
 
‰ames
,

181 c⁄° 
¢d_pcm_rouã_âabÀ_d°_t
* 
âabÀ
,

182 c⁄° 
¢d_pcm_rouã_∑øms_t
 *
∑øms
)

184 
	#CONV24_LABELS


	)

185 
	~"∂ugö_›s.h
"

186 #unde‡
CONV24_LABELS


187 *
gë
, *
put
;

188 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
 = 0;

189 
§cidx
;

190 c⁄° *
§c
;

191 *
d°
;

192 
§c_°ï
, 
d°_°ï
;

193 
uöt32_t
 
ßm∂e
 = 0;

194 
§cidx
 = 0; srcidx < 
âabÀ
->
n§cs
 && srcidx < 
§c_ch™√ls
; ++srcidx) {

195 
ch™√l
 = 
âabÀ
->
§cs
[
§cidx
].channel;

196 i‡(
ch™√l
 >
§c_ch™√ls
)

198 
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

199 i‡(
§c_¨ó
->
addr
 !
NULL
)

202 i‡(
§cidx
 =
âabÀ
->
n§cs
 || srcidx =
§c_ch™√ls
) {

203 
	`¢d_pcm_rouã_c⁄vît1_zîo
(
d°_¨ó
, 
d°_off£t
,

204 
§c_¨ós
, 
§c_off£t
,

205 
§c_ch™√ls
,

206 
‰ames
, 
âabÀ
, 
∑øms
);

210 
gë
 = 
gë32_œbñs
[
∑øms
->
gë_idx
];

211 
put
 = 
put32_œbñs
[
∑øms
->
put_idx
];

212 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

213 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

214 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
);

215 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
);

216 
‰ames
-- > 0) {

217 *
gë
;

218 
	#CONV24_END
 
a·î


	)

219 
	~"∂ugö_›s.h
"

220 #unde‡
CONV24_END


221 
a·î
:

222 
§c
 +
§c_°ï
;

223 
d°
 +
d°_°ï
;

225 
	}
}

227 
	$¢d_pcm_rouã_c⁄vît1_m™y
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
,

228 
¢d_pcm_u‰ames_t
 
d°_off£t
,

229 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

230 
¢d_pcm_u‰ames_t
 
§c_off£t
,

231 
§c_ch™√ls
,

232 
¢d_pcm_u‰ames_t
 
‰ames
,

233 c⁄° 
¢d_pcm_rouã_âabÀ_d°_t
* 
âabÀ
,

234 c⁄° 
¢d_pcm_rouã_∑øms_t
 *
∑øms
)

236 
	#GET32_LABELS


	)

237 
	#PUT32_LABELS


	)

238 
	~"∂ugö_›s.h
"

239 #unde‡
GET32_LABELS


240 #unde‡
PUT32_LABELS


241 *c⁄° 
zîo_œbñs
[2] = {

242 &&
zîo_öt64
,

243 #i‡
SND_PCM_PLUGIN_ROUTE_FLOAT


244 &&
zîo_Êﬂt


248 *c⁄° 
add_œbñs
[2 * 2] = {

249 &&
add_öt64_nﬂâ
, &&
add_öt64_©t
,

250 #i‡
SND_PCM_PLUGIN_ROUTE_FLOAT


251 &&
add_Êﬂt_nﬂâ
, &&
add_Êﬂt_©t


255 *c⁄° 
n‹m_œbñs
[2 * 2] = {

256 &&
n‹m_öt64_nﬂâ
,

257 &&
n‹m_öt64_©t
,

258 #i‡
SND_PCM_PLUGIN_ROUTE_FLOAT


259 &&
n‹m_Êﬂt
,

260 &&
n‹m_Êﬂt
,

263 *
zîo
, *
gë32
, *
add
, *
n‹m
, *
put32
;

264 
n§cs
 = 
âabÀ
->nsrcs;

265 *
d°
;

266 
d°_°ï
;

267 c⁄° *
§cs
[
n§cs
];

268 
§c_°ïs
[
n§cs
];

269 
¢d_pcm_rouã_âabÀ_§c_t
 
§c_â
[
n§cs
];

270 
öt32_t
 
ßm∂e
 = 0;

271 
§cidx
, 
§cidx1
 = 0;

272 
§cidx
 = 0; srcidx < 
n§cs
 && ()§cidx < 
§c_ch™√ls
; ++srcidx) {

273 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ó
;

274 
ch™√l
 = 
âabÀ
->
§cs
[
§cidx
].channel;

275 i‡(
ch™√l
 >
§c_ch™√ls
)

277 
§c_¨ó
 = &
§c_¨ós
[
ch™√l
];

278 
§cs
[
§cidx1
] = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
);

279 
§c_°ïs
[
§cidx1
] = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
);

280 
§c_â
[
§cidx1
] = 
âabÀ
->
§cs
[
§cidx
];

281 
§cidx1
++;

283 
n§cs
 = 
§cidx1
;

284 i‡(
n§cs
 == 0) {

285 
	`¢d_pcm_rouã_c⁄vît1_zîo
(
d°_¨ó
, 
d°_off£t
,

286 
§c_¨ós
, 
§c_off£t
,

287 
§c_ch™√ls
,

288 
‰ames
, 
âabÀ
, 
∑øms
);

290 } i‡(
n§cs
 =1 && 
§c_â
[0].
as_öt
 =
SND_PCM_PLUGIN_ROUTE_RESOLUTION
) {

291 i‡(
∑øms
->
u£_gëput
)

292 
	`¢d_pcm_rouã_c⁄vît1_⁄e_gëput
(
d°_¨ó
, 
d°_off£t
,

293 
§c_¨ós
, 
§c_off£t
,

294 
§c_ch™√ls
,

295 
‰ames
, 
âabÀ
, 
∑øms
);

297 
	`¢d_pcm_rouã_c⁄vît1_⁄e
(
d°_¨ó
, 
d°_off£t
,

298 
§c_¨ós
, 
§c_off£t
,

299 
§c_ch™√ls
,

300 
‰ames
, 
âabÀ
, 
∑øms
);

304 
zîo
 = 
zîo_œbñs
[
∑øms
->
sum_idx
];

305 
gë32
 = 
gë32_œbñs
[
∑øms
->
gë_idx
];

306 
add
 = 
add_œbñs
[
∑øms
->
sum_idx
 * 2 + 
âabÀ
->
©t
];

307 
n‹m
 = 
n‹m_œbñs
[
∑øms
->
sum_idx
 * 2 + 
âabÀ
->
©t
];

308 
put32
 = 
put32_œbñs
[
∑øms
->
put_idx
];

309 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
);

310 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
);

312 
‰ames
-- > 0) {

313 
¢d_pcm_rouã_âabÀ_§c_t
 *
âp
 = 
§c_â
;

314 
sum_t
 
sum
;

317 *
zîo
;

318 
zîo_öt64
:

319 
sum
.
as_söt64
 = 0;

320 
zîo_íd
;

321 #i‡
SND_PCM_PLUGIN_ROUTE_FLOAT


322 
zîo_Êﬂt
:

323 
sum
.
as_Êﬂt
 = 0.0;

324 
zîo_íd
;

326 
zîo_íd
:

327 
§cidx
 = 0; srcidx < 
n§cs
; ++srcidx) {

328 c⁄° *
§c
 = 
§cs
[
§cidx
];

331 *
gë32
;

332 
	#GET32_END
 
a·î_gë


	)

333 
	~"∂ugö_›s.h
"

334 #unde‡
GET32_END


335 
a·î_gë
:

338 *
add
;

339 
add_öt64_©t
:

340 
sum
.
as_söt64
 +(
öt64_t
Ë
ßm∂e
 * 
âp
->
as_öt
;

341 
a·î_sum
;

342 
add_öt64_nﬂâ
:

343 i‡(
âp
->
as_öt
)

344 
sum
.
as_söt64
 +
ßm∂e
;

345 
a·î_sum
;

346 #i‡
SND_PCM_PLUGIN_ROUTE_FLOAT


347 
add_Êﬂt_©t
:

348 
sum
.
as_Êﬂt
 +
ßm∂e
 * 
âp
->as_float;

349 
a·î_sum
;

350 
add_Êﬂt_nﬂâ
:

351 i‡(
âp
->
as_öt
)

352 
sum
.
as_Êﬂt
 +
ßm∂e
;

353 
a·î_sum
;

355 
a·î_sum
:

356 
§cs
[
§cidx
] +
§c_°ïs
[srcidx];

357 
âp
++;

361 *
n‹m
;

362 
n‹m_öt64_©t
:

363 
	`div
(
sum
.
as_söt64
);

365 
n‹m_öt64_nﬂâ
:

366 i‡(
sum
.
as_söt64
 > (
öt64_t
)0x7fffffff)

367 
ßm∂e
 = 0x7fffffff;

368 i‡(
sum
.
as_söt64
 < -(
öt64_t
)0x80000000)

369 
ßm∂e
 = 0x80000000;

371 
ßm∂e
 = 
sum
.
as_söt64
;

372 
a·î_n‹m
;

374 #i‡
SND_PCM_PLUGIN_ROUTE_FLOAT


375 
n‹m_Êﬂt
:

376 
sum
.
as_Êﬂt
 = 
	`röt
(sum.as_float);

377 i‡(
sum
.
as_Êﬂt
 > (
öt64_t
)0x7fffffff)

378 
ßm∂e
 = 0x7fffffff;

379 i‡(
sum
.
as_Êﬂt
 < -(
öt64_t
)0x80000000)

380 
ßm∂e
 = 0x80000000;

382 
ßm∂e
 = 
sum
.
as_Êﬂt
;

383 
a·î_n‹m
;

385 
a·î_n‹m
:

388 *
put32
;

389 
	#PUT32_END
 
a·î_put32


	)

390 
	~"∂ugö_›s.h
"

391 #unde‡
PUT32_END


392 
a·î_put32
:

394 
d°
 +
d°_°ï
;

396 
	}
}

400 
	$¢d_pcm_rouã_c⁄vît
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

401 
¢d_pcm_u‰ames_t
 
d°_off£t
,

402 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

403 
¢d_pcm_u‰ames_t
 
§c_off£t
,

404 
§c_ch™√ls
,

405 
d°_ch™√ls
,

406 
¢d_pcm_u‰ames_t
 
‰ames
,

407 
¢d_pcm_rouã_∑øms_t
 *
∑øms
)

409 
d°_ch™√l
;

410 
¢d_pcm_rouã_âabÀ_d°_t
 *
d°p
;

411 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
;

413 
d°p
 = 
∑øms
->
d°s
;

414 
d°_¨ó
 = 
d°_¨ós
;

415 
d°_ch™√l
 = 0; d°_ch™√»< 
d°_ch™√ls
; ++dst_channel) {

416 i‡(
d°_ch™√l
 >
∑øms
->
nd°s
)

417 
	`¢d_pcm_rouã_c⁄vît1_zîo
(
d°_¨ó
, 
d°_off£t
,

418 
§c_¨ós
, 
§c_off£t
,

419 
§c_ch™√ls
,

420 
‰ames
, 
d°p
, 
∑øms
);

422 
d°p
->
	`func
(
d°_¨ó
, 
d°_off£t
,

423 
§c_¨ós
, 
§c_off£t
,

424 
§c_ch™√ls
,

425 
‰ames
, 
d°p
, 
∑øms
);

426 
d°p
++;

427 
d°_¨ó
++;

429 
	}
}

431 
	$¢d_pcm_rouã_˛o£
(
¢d_pcm_t
 *
pcm
)

433 
¢d_pcm_rouã_t
 *
rouã
 = 
pcm
->
¥iv©e_d©a
;

434 
¢d_pcm_rouã_∑øms_t
 *
∑øms
 = &
rouã
->params;

435 
d°_ch™√l
;

437 i‡(
∑øms
->
d°s
) {

438 
d°_ch™√l
 = 0; d°_ch™√»< 
∑øms
->
nd°s
; ++dst_channel) {

439 
	`‰ì
(
∑øms
->
d°s
[
d°_ch™√l
].
§cs
);

441 
	`‰ì
(
∑øms
->
d°s
);

443 
	`‰ì
(
rouã
->
chm≠
);

444 
	`¢d_pcm_‰ì_chm≠s
(
rouã
->
chm≠_ovîride
);

445  
	`¢d_pcm_gíîic_˛o£
(
pcm
);

446 
	}
}

448 
	$¢d_pcm_rouã_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

450 
îr
;

451 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

452 
¢d_pcm_f‹m©_mask_t
 
f‹m©_mask
 = { 
SND_PCM_FMTBIT_LINEAR
 };

453 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

454 &
ac˚ss_mask
);

455 i‡(
îr
 < 0)

456  
îr
;

457 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
,

458 &
f‹m©_mask
);

459 i‡(
îr
 < 0)

460  
îr
;

461 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
∑øms
, 
SND_PCM_SUBFORMAT_STD
);

462 i‡(
îr
 < 0)

463  
îr
;

464 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mö
(
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
, 1, 0);

465 i‡(
îr
 < 0)

466  
îr
;

467 
∑øms
->
öfo
 &~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

469 
	}
}

471 
	$¢d_pcm_rouã_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

473 
¢d_pcm_rouã_t
 *
rouã
 = 
pcm
->
¥iv©e_d©a
;

474 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

475 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

476 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

477 &
ßc˚ss_mask
);

478 i‡(
rouã
->
sf‹m©
 !
SND_PCM_FORMAT_UNKNOWN
) {

479 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
•¨ams
, 
rouã
->
sf‹m©
);

480 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
•¨ams
, 
SND_PCM_SUBFORMAT_STD
);

482 i‡(
rouã
->
sch™√ls
 >= 0) {

483 
	`_¢d_pcm_hw_∑øm_£t
(
•¨ams
, 
SND_PCM_HW_PARAM_CHANNELS
,

484 (Ë
rouã
->
sch™√ls
, 0);

487 
	}
}

489 
	$¢d_pcm_rouã_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

490 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

492 
¢d_pcm_rouã_t
 *
rouã
 = 
pcm
->
¥iv©e_d©a
;

493 
îr
;

494 
löks
 = (
SND_PCM_HW_PARBIT_RATE
 |

495 
SND_PCM_HW_PARBIT_PERIODS
 |

496 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

497 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

498 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

499 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

500 
SND_PCM_HW_PARBIT_TICK_TIME
);

501 i‡(
rouã
->
sf‹m©
 =
SND_PCM_FORMAT_UNKNOWN
)

502 
löks
 |(
SND_PCM_HW_PARBIT_FORMAT
 |

503 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

504 
SND_PCM_HW_PARBIT_SAMPLE_BITS
);

505 i‡(
rouã
->
sch™√ls
 < 0)

506 
löks
 |
SND_PCM_HW_PARBIT_CHANNELS
;

507 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

508 i‡(
îr
 < 0)

509  
îr
;

511 
	}
}

513 
	$¢d_pcm_rouã_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

514 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

516 
¢d_pcm_rouã_t
 *
rouã
 = 
pcm
->
¥iv©e_d©a
;

517 
îr
;

518 
löks
 = (
SND_PCM_HW_PARBIT_RATE
 |

519 
SND_PCM_HW_PARBIT_PERIODS
 |

520 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

521 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

522 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

523 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

524 
SND_PCM_HW_PARBIT_TICK_TIME
);

525 i‡(
rouã
->
sf‹m©
 =
SND_PCM_FORMAT_UNKNOWN
)

526 
löks
 |(
SND_PCM_HW_PARBIT_FORMAT
 |

527 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

528 
SND_PCM_HW_PARBIT_SAMPLE_BITS
);

529 i‡(
rouã
->
sch™√ls
 < 0)

530 
löks
 |
SND_PCM_HW_PARBIT_CHANNELS
;

531 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

532 i‡(
îr
 < 0)

533  
îr
;

535 
	}
}

537 
	$¢d_pcm_rouã_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

539  
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

540 
¢d_pcm_rouã_hw_ªföe_˝ª∑ª
,

541 
¢d_pcm_rouã_hw_ªföe_cch™ge
,

542 
¢d_pcm_rouã_hw_ªföe_•ª∑ª
,

543 
¢d_pcm_rouã_hw_ªföe_sch™ge
,

544 
¢d_pcm_gíîic_hw_ªföe
);

545 
	}
}

547 
	$¢d_pcm_rouã_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 * 
∑øms
)

549 
¢d_pcm_rouã_t
 *
rouã
 = 
pcm
->
¥iv©e_d©a
;

550 
¢d_pcm_t
 *
¶ave
 = 
rouã
->
∂ug
.
gí
.slave;

551 
¢d_pcm_f‹m©_t
 
§c_f‹m©
, 
d°_f‹m©
;

552 
îr
 = 
	`¢d_pcm_hw_∑øms_¶ave
(
pcm
, 
∑øms
,

553 
¢d_pcm_rouã_hw_ªföe_cch™ge
,

554 
¢d_pcm_rouã_hw_ªföe_•ª∑ª
,

555 
¢d_pcm_rouã_hw_ªföe_sch™ge
,

556 
¢d_pcm_gíîic_hw_∑øms
);

557 i‡(
îr
 < 0)

558  
îr
;

560 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

561 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(
∑øms
, &
§c_f‹m©
);

562 
d°_f‹m©
 = 
¶ave
->
f‹m©
;

564 
§c_f‹m©
 = 
¶ave
->
f‹m©
;

565 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_f‹m©
)(
∑øms
, &
d°_f‹m©
);

567 i‡(
îr
 < 0)

568  
îr
;

570 
rouã
->
∑øms
.
u£_gëput
 =

571 (
	`¢d_pcm_f‹m©_physiˇl_width
(
§c_f‹m©
) + 7) / 8 == 3 ||

572 (
	`¢d_pcm_f‹m©_physiˇl_width
(
d°_f‹m©
) + 7) / 8 == 3 ||

573 
	`¢d_pcm_f‹m©_width
(
§c_f‹m©
) == 20 ||

574 
	`¢d_pcm_f‹m©_width
(
d°_f‹m©
) == 20;

575 
rouã
->
∑øms
.
gë_idx
 = 
	`¢d_pcm_löór_gë_ödex
(
§c_f‹m©
, 
SND_PCM_FORMAT_S32
);

576 
rouã
->
∑øms
.
put_idx
 = 
	`¢d_pcm_löór_put_ödex
(
SND_PCM_FORMAT_S32
, 
d°_f‹m©
);

577 
rouã
->
∑øms
.
c⁄v_idx
 = 
	`¢d_pcm_löór_c⁄vît_ödex
(
§c_f‹m©
, 
d°_f‹m©
);

578 
rouã
->
∑øms
.
§c_size
 = 
	`¢d_pcm_f‹m©_width
(
§c_f‹m©
) / 8;

579 
rouã
->
∑øms
.
d°_sfmt
 = 
d°_f‹m©
;

580 #i‡
SND_PCM_PLUGIN_ROUTE_FLOAT


581 
rouã
->
∑øms
.
sum_idx
 = 
FLOAT
;

583 
rouã
->
∑øms
.
sum_idx
 = 
UINT64
;

586 
	}
}

588 
¢d_pcm_u‰ames_t


589 
	$¢d_pcm_rouã_wrôe_¨ós
(
¢d_pcm_t
 *
pcm
,

590 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

591 
¢d_pcm_u‰ames_t
 
off£t
,

592 
¢d_pcm_u‰ames_t
 
size
,

593 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

594 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

595 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

597 
¢d_pcm_rouã_t
 *
rouã
 = 
pcm
->
¥iv©e_d©a
;

598 
¢d_pcm_t
 *
¶ave
 = 
rouã
->
∂ug
.
gí
.slave;

599 i‡(
size
 > *
¶ave_sizï
)

600 
size
 = *
¶ave_sizï
;

601 
	`¢d_pcm_rouã_c⁄vît
(
¶ave_¨ós
, 
¶ave_off£t
,

602 
¨ós
, 
off£t
,

603 
pcm
->
ch™√ls
,

604 
¶ave
->
ch™√ls
,

605 
size
, &
rouã
->
∑øms
);

606 *
¶ave_sizï
 = 
size
;

607  
size
;

608 
	}
}

610 
¢d_pcm_u‰ames_t


611 
	$¢d_pcm_rouã_ªad_¨ós
(
¢d_pcm_t
 *
pcm
,

612 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

613 
¢d_pcm_u‰ames_t
 
off£t
,

614 
¢d_pcm_u‰ames_t
 
size
,

615 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

616 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

617 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

619 
¢d_pcm_rouã_t
 *
rouã
 = 
pcm
->
¥iv©e_d©a
;

620 
¢d_pcm_t
 *
¶ave
 = 
rouã
->
∂ug
.
gí
.slave;

621 i‡(
size
 > *
¶ave_sizï
)

622 
size
 = *
¶ave_sizï
;

623 
	`¢d_pcm_rouã_c⁄vît
(
¨ós
, 
off£t
,

624 
¶ave_¨ós
, 
¶ave_off£t
,

625 
¶ave
->
ch™√ls
,

626 
pcm
->
ch™√ls
,

627 
size
, &
rouã
->
∑øms
);

628 *
¶ave_sizï
 = 
size
;

629  
size
;

630 
	}
}

632 
¢d_pcm_chm≠_t
 *
	$¢d_pcm_rouã_gë_chm≠
(
¢d_pcm_t
 *
pcm
)

634 
¢d_pcm_rouã_t
 *
rouã
 = 
pcm
->
¥iv©e_d©a
;

635 
¢d_pcm_chm≠_t
 *
m≠
, *
¶ave_m≠
;

636 
§c
, 
d°
, 
n§cs
;

638 i‡(
rouã
->
chm≠_ovîride
)

639  
	`_¢d_pcm_choo£_fixed_chm≠
(
pcm
, 
rouã
->
chm≠_ovîride
);

641 
¶ave_m≠
 = 
	`¢d_pcm_gíîic_gë_chm≠
(
pcm
);

642 i‡(!
¶ave_m≠
)

643  
NULL
;

644 
n§cs
 = 
rouã
->
∑øms
.nsrcs;

645 
m≠
 = 
	`ˇŒoc
(4, 
n§cs
 + 1);

646 i‡(!
m≠
) {

647 
	`‰ì
(
¶ave_m≠
);

648  
NULL
;

650 
m≠
->
ch™√ls
 = 
n§cs
;

651 
§c
 = 0; sr¯< 
n§cs
; src++)

652 
m≠
->
pos
[
§c
] = 
SND_CHMAP_NA
;

653 
d°
 = 0; d° < 
rouã
->
∑øms
.
nd°s
; dst++) {

654 
¢d_pcm_rouã_âabÀ_d°_t
 *
d
 = &
rouã
->
∑øms
.
d°s
[
d°
];

655 
§c
 = 0; sr¯< 
d
->
n§cs
; src++) {

656 
c
 = 
d
->
§cs
[
§c
].
ch™√l
;

657 i‡(
c
 < 
n§cs
 && 
m≠
->
pos
[c] =
SND_CHMAP_NA
)

658 
m≠
->
pos
[
c
] = 
¶ave_m≠
->pos[
d°
];

661 
	`‰ì
(
¶ave_m≠
);

662  
m≠
;

663 
	}
}

665 
¢d_pcm_chm≠_quîy_t
 **
	$¢d_pcm_rouã_quîy_chm≠s
(
¢d_pcm_t
 *
pcm
)

667 
¢d_pcm_rouã_t
 *
rouã
 = 
pcm
->
¥iv©e_d©a
;

668 
¢d_pcm_chm≠_quîy_t
 **
m≠s
;

669 
¢d_pcm_chm≠_t
 *
m≠
;

671 i‡(
rouã
->
chm≠_ovîride
)

672  
	`_¢d_pcm_c›y_chm≠_quîy
(
rouã
->
chm≠_ovîride
);

674 
m≠
 = 
	`¢d_pcm_rouã_gë_chm≠
(
pcm
);

675 i‡(!
m≠
)

676  
NULL
;

677 
m≠s
 = 
	`_¢d_pcm_make_sögÀ_quîy_chm≠s
(
m≠
);

678 
	`‰ì
(
m≠
);

679  
m≠s
;

680 
	}
}

682 
	$¢d_pcm_rouã_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

684 
¢d_pcm_rouã_t
 *
rouã
 = 
pcm
->
¥iv©e_d©a
;

685 
d°
;

686 i‡(
rouã
->
sf‹m©
 =
SND_PCM_FORMAT_UNKNOWN
)

687 
	`¢d_ouçut_¥ötf
(
out
, "Route conversion PCM\n");

689 
	`¢d_ouçut_¥ötf
(
out
, "Route conversion PCM (sformat=%s)\n",

690 
	`¢d_pcm_f‹m©_«me
(
rouã
->
sf‹m©
));

691 
	`¢d_ouçut_puts
(
out
, " TransformationÅable:\n");

692 
d°
 = 0; d° < 
rouã
->
∑øms
.
nd°s
; dst++) {

693 
¢d_pcm_rouã_âabÀ_d°_t
 *
d
 = &
rouã
->
∑øms
.
d°s
[
d°
];

694 
§c
;

695 
	`¢d_ouçut_¥ötf
(
out
, " %d <- ", 
d°
);

696 i‡(
d
->
n§cs
 == 0) {

697 
	`¢d_ouçut_¥ötf
(
out
, "none\n");

700 
§c
 = 0;

702 
¢d_pcm_rouã_âabÀ_§c_t
 *
s
 = &
d
->
§cs
[
§c
];

703 i‡(
d
->
©t
)

704 #i‡
SND_PCM_PLUGIN_ROUTE_FLOAT


705 
	`¢d_ouçut_¥ötf
(
out
, "%d*%g", 
s
->
ch™√l
, s->
as_Êﬂt
);

707 
	`¢d_ouçut_¥ötf
(
out
, "%d*%g", 
s
->
ch™√l
, ()s->
as_öt
 / ()
SND_PCM_PLUGIN_ROUTE_RESOLUTION
);

710 
	`¢d_ouçut_¥ötf
(
out
, "%d", 
s
->
ch™√l
);

711 
§c
++;

712 i‡(
§c
 =
d
->
n§cs
)

714 
	`¢d_ouçut_puts
(
out
, " + ");

716 
	`¢d_ouçut_putc
(
out
, '\n');

718 i‡(
pcm
->
£tup
) {

719 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

720 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

722 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

723 
	`¢d_pcm_dump
(
rouã
->
∂ug
.
gí
.
¶ave
, 
out
);

724 
	}
}

737 
	$°πoch™√l
(c⁄° *
id
, 
¢d_pcm_chm≠_t
 *
chm≠
,

738 *
ch™√l
, 
ch™√l_size
)

740 
ch
;

741 i‡(
	`ß„_°πﬁ
(
id
, 
ch™√l
) >= 0)

744 
ch
 = (Ë
	`¢d_pcm_chm≠_‰om_°rög
(
id
);

745 i‡(
ch
 == -1)

746  -
EINVAL
;

748 i‡(
chm≠
) {

749 
i
, 
r
 = 0;

752 
i
 = 
chm≠
->
ch™√ls
 - 1; i >= 0; i--) {

753 i‡((Ë
chm≠
->
pos
[
i
] !
ch
)

755 i‡(
r
 >
ch™√l_size
)

757 
ch™√l
[
r
++] = 
i
;

759  
r
;

763 *
ch™√l
 = 
ch
 - 
SND_CHMAP_FL
;

766 
	}
}

768 #i‚de‡
DOC_HIDDEN


769 
	#MAX_CHMAP_CHANNELS
 256

	)

772 
	$dëîmöe_chm≠
(
¢d_c⁄fig_t
 *
â
, 
¢d_pcm_chm≠_t
 **
â_chm≠
)

774 
¢d_c⁄fig_ôî©‹_t
 
i
, 
öext
;

775 
¢d_pcm_chm≠_t
 *
chm≠
;

777 
	`as£π
(
â
 && 
â_chm≠
);

778 
chm≠
 = 
	`mÆloc
((
¢d_pcm_chm≠_t
) +

779 
MAX_CHMAP_CHANNELS
 * ());

781 
chm≠
->
ch™√ls
 = 0;

782 
	`¢d_c⁄fig_f‹_óch
(
i
, 
öext
, 
â
) {

783 c⁄° *
id
;

784 
¢d_c⁄fig_ôî©‹_t
 
j
, 
j√xt
;

785 
¢d_c⁄fig_t
 *
ö
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

787 i‡(
	`¢d_c⁄fig_gë_id
(
ö
, &
id
) < 0)

789 i‡(
	`¢d_c⁄fig_gë_ty≥
(
ö
Ë!
SND_CONFIG_TYPE_COMPOUND
)

790 
îr
;

791 
	`¢d_c⁄fig_f‹_óch
(
j
, 
j√xt
, 
ö
) {

792 
ch
, 
k
, 
found
;

793 
sch™√l
;

794 
¢d_c⁄fig_t
 *
jnode
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
j
);

795 i‡(
	`¢d_c⁄fig_gë_id
(
jnode
, &
id
) < 0)

797 i‡(
	`ß„_°πﬁ
(
id
, &
sch™√l
) >= 0)

799 
ch
 = (Ë
	`¢d_pcm_chm≠_‰om_°rög
(
id
);

800 i‡(
ch
 == -1)

801 
îr
;

803 
found
 = 0;

804 
k
 = 0; k < (Ë
chm≠
->
ch™√ls
; k++)

805 i‡(
ch
 =(Ë
chm≠
->
pos
[
k
]) {

806 
found
 = 1;

809 i‡(
found
)

812 i‡(
chm≠
->
ch™√ls
 >
MAX_CHMAP_CHANNELS
) {

813 
	`SNDERR
("Too many channels inÅtable chmap");

814 
îr
;

816 
chm≠
->
pos
[chm≠->
ch™√ls
++] = 
ch
;

820 i‡(
chm≠
->
ch™√ls
 == 0) {

821 
	`‰ì
(
chm≠
);

822 
chm≠
 = 
NULL
;

824 *
â_chm≠
 = 
chm≠
;

827 
îr
:

828 *
â_chm≠
 = 
NULL
;

829 
	`‰ì
(
chm≠
);

830  -
EINVAL
;

831 
	}
}

833 
	$föd_m©chög_chm≠
(
¢d_pcm_chm≠_quîy_t
 **
chm≠s
,

834 
¢d_pcm_chm≠_t
 *
â_chm≠
,

835 
¢d_pcm_chm≠_t
 **
found_chm≠
, *
sch™√ls
)

837 
i
;

839 *
found_chm≠
 = 
NULL
;

841 i‡(
chm≠s
 =
NULL
)

844 
i
 = 0; 
chm≠s
[i]; i++) {

845 
j
, 
k
;

846 
m©ch
 = 1;

847 
¢d_pcm_chm≠_t
 *
c
 = &
chm≠s
[
i
]->
m≠
;

848 i‡(*
sch™√ls
 >0 && (Ë
c
->
ch™√ls
 != *schannels)

851 
j
 = 0; j < 
â_chm≠
->
ch™√ls
; j++) {

852 
found
 = 0;

853 
ch
 = 
â_chm≠
->
pos
[
j
];

854 
k
 = 0; k < 
c
->
ch™√ls
; k++)

855 i‡(
c
->
pos
[
k
] =
ch
) {

856 
found
 = 1;

859 i‡(!
found
) {

860 
m©ch
 = 0;

865 i‡(
m©ch
) {

866 
size
 = (
¢d_pcm_chm≠_t
Ë+ 
c
->
ch™√ls
 * ();

867 *
found_chm≠
 = 
	`mÆloc
(
size
);

868 i‡(!*
found_chm≠
) {

869  -
ENOMEM
;

871 
	`mem˝y
(*
found_chm≠
, 
c
, 
size
);

872 *
sch™√ls
 = 
c
->
ch™√ls
;

877 i‡(*
found_chm≠
 =
NULL
) {

878 
	`SNDERR
("FoundÇo matching channel map");

879  -
EINVAL
;

882 
	}
}

884 
	$rouã_chm≠_öô
(
¢d_pcm_t
 *
pcm
)

886 
£t_m≠
 = 0;

887 
¢d_pcm_chm≠_t
 *
cuºít
;

888 
¢d_pcm_rouã_t
 *
rouã
 = 
pcm
->
¥iv©e_d©a
;

889 i‡(!
rouã
->
chm≠
)

891 i‡(
	`__¢d_pcm_°©e
(
pcm
Ë!
SND_PCM_STATE_PREPARED
)

896 
cuºít
 = 
	`¢d_pcm_gë_chm≠
(
rouã
->
∂ug
.
gí
.
¶ave
);

897 i‡(!
cuºít
)

898  -
ENOSYS
;

899 i‡(
cuºít
->
ch™√ls
 !
rouã
->
chm≠
->channels)

900 
£t_m≠
 = 1;

902 
£t_m≠
 = 
	`memcmp
(
cuºít
->
pos
, 
rouã
->
chm≠
->pos,

903 
cuºít
->
ch™√ls
);

904 
	`‰ì
(
cuºít
);

905 i‡(!
£t_m≠
)

908  
	`¢d_pcm_£t_chm≠
(
rouã
->
∂ug
.
gí
.
¶ave
,Ñouã->
chm≠
);

909 
	}
}

912 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_rouã_›s
 = {

913 .
˛o£
 = 
¢d_pcm_rouã_˛o£
,

914 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

915 .
	ghw_ªföe
 = 
¢d_pcm_rouã_hw_ªföe
,

916 .
	ghw_∑øms
 = 
¢d_pcm_rouã_hw_∑øms
,

917 .
	ghw_‰ì
 = 
¢d_pcm_gíîic_hw_‰ì
,

918 .
	gsw_∑øms
 = 
¢d_pcm_gíîic_sw_∑øms
,

919 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

920 .
	gdump
 = 
¢d_pcm_rouã_dump
,

921 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

922 .
	gasync
 = 
¢d_pcm_gíîic_async
,

923 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

924 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

925 .
	gquîy_chm≠s
 = 
¢d_pcm_rouã_quîy_chm≠s
,

926 .
	ggë_chm≠
 = 
¢d_pcm_rouã_gë_chm≠
,

927 .
	g£t_chm≠
 = 
NULL
,

930 
	$rouã_lﬂd_âabÀ
(
¢d_pcm_rouã_∑øms_t
 *
∑øms
, 
¢d_pcm_°ªam_t
 
°ªam
,

931 
â_ssize
,

932 
¢d_pcm_rouã_âabÀ_íåy_t
 *
âabÀ
,

933 
â_cu£d
, 
â_su£d
)

935 
§c_ch™√l
, 
d°_ch™√l
;

936 
¢d_pcm_rouã_âabÀ_d°_t
 *
d±r
;

937 
su£d
, 
du£d
, 
smul
, 
dmul
;

938 i‡(
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

939 
su£d
 = 
â_cu£d
;

940 
du£d
 = 
â_su£d
;

941 
smul
 = 
â_ssize
;

942 
dmul
 = 1;

944 
su£d
 = 
â_su£d
;

945 
du£d
 = 
â_cu£d
;

946 
smul
 = 1;

947 
dmul
 = 
â_ssize
;

949 
∑øms
->
nd°s
 = 
du£d
;

950 
∑øms
->
n§cs
 = 
su£d
;

951 
d±r
 = 
	`ˇŒoc
(
du£d
, (*
∑øms
->
d°s
));

952 i‡(!
d±r
)

953  -
ENOMEM
;

954 
∑øms
->
d°s
 = 
d±r
;

955 
d°_ch™√l
 = 0; d°_ch™√»< 
du£d
; ++dst_channel) {

956 
¢d_pcm_rouã_âabÀ_íåy_t
 
t
 = 0;

957 
©t
 = 0;

958 
n§cs
 = 0;

959 
¢d_pcm_rouã_âabÀ_§c_t
 
§cs
[
su£d
];

960 
§c_ch™√l
 = 0; src_ch™√»< 
su£d
; ++src_channel) {

961 
¢d_pcm_rouã_âabÀ_íåy_t
 
v
;

962 
v
 = 
âabÀ
[
§c_ch™√l
 * 
smul
 + 
d°_ch™√l
 * 
dmul
];

963 i‡(
v
 != 0) {

964 
§cs
[
n§cs
].
ch™√l
 = 
§c_ch™√l
;

965 #i‡
SND_PCM_PLUGIN_ROUTE_FLOAT


967 
§cs
[
n§cs
].
as_öt
 = (
v
 =
SND_PCM_PLUGIN_ROUTE_FULL
 ? 
SND_PCM_PLUGIN_ROUTE_RESOLUTION
 : 0);

968 
§cs
[
n§cs
].
as_Êﬂt
 = 
v
;

970 
	`as£π
(
v
 >0 && v <
SND_PCM_PLUGIN_ROUTE_FULL
);

971 
§cs
[
n§cs
].
as_öt
 = 
v
;

973 i‡(
v
 !
SND_PCM_PLUGIN_ROUTE_FULL
)

974 
©t
 = 1;

975 
t
 +
v
;

976 
n§cs
++;

980 
	`as£π
(
t
 <
SND_PCM_PLUGIN_ROUTE_FULL
);

982 
d±r
->
©t
 =átt;

983 
d±r
->
n§cs
 =Çsrcs;

984 i‡(
n§cs
 == 0)

985 
d±r
->
func
 = 
¢d_pcm_rouã_c⁄vît1_zîo
;

987 
d±r
->
func
 = 
¢d_pcm_rouã_c⁄vît1_m™y
;

988 i‡(
n§cs
 > 0) {

989 
d±r
->
§cs
 = 
	`ˇŒoc
((Ë
n§cs
, (*srcs));

990 i‡(!
d±r
->
§cs
)

991  -
ENOMEM
;

992 
	`mem˝y
(
d±r
->
§cs
, srcs, (*§csË* 
n§cs
);

994 
d±r
->
§cs
 = 0;

995 
d±r
++;

998 
	}
}

1017 
	$¢d_pcm_rouã_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1018 
¢d_pcm_f‹m©_t
 
sf‹m©
, 
sch™√ls
,

1019 
¢d_pcm_rouã_âabÀ_íåy_t
 *
âabÀ
,

1020 
â_ssize
,

1021 
â_cu£d
, 
â_su£d
,

1022 
¢d_pcm_t
 *
¶ave
, 
˛o£_¶ave
)

1024 
¢d_pcm_t
 *
pcm
;

1025 
¢d_pcm_rouã_t
 *
rouã
;

1026 
îr
;

1027 
	`as£π
(
pcmp
 && 
¶ave
 && 
âabÀ
);

1028 i‡(
sf‹m©
 !
SND_PCM_FORMAT_UNKNOWN
 &&

1029 
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1)

1030  -
EINVAL
;

1031 
rouã
 = 
	`ˇŒoc
(1, (
¢d_pcm_rouã_t
));

1032 i‡(!
rouã
) {

1033  -
ENOMEM
;

1035 
	`¢d_pcm_∂ugö_öô
(&
rouã
->
∂ug
);

1036 
rouã
->
sf‹m©
 = sformat;

1037 
rouã
->
sch™√ls
 = schannels;

1038 
rouã
->
∂ug
.
ªad
 = 
¢d_pcm_rouã_ªad_¨ós
;

1039 
rouã
->
∂ug
.
wrôe
 = 
¢d_pcm_rouã_wrôe_¨ós
;

1040 
rouã
->
∂ug
.
undo_ªad
 = 
¢d_pcm_∂ugö_undo_ªad_gíîic
;

1041 
rouã
->
∂ug
.
undo_wrôe
 = 
¢d_pcm_∂ugö_undo_wrôe_gíîic
;

1042 
rouã
->
∂ug
.
gí
.
¶ave
 = slave;

1043 
rouã
->
∂ug
.
gí
.
˛o£_¶ave
 = close_slave;

1044 
rouã
->
∂ug
.
öô
 = 
rouã_chm≠_öô
;

1046 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_ROUTE
, 
«me
, 
¶ave
->
°ªam
, sœve->
mode
);

1047 i‡(
îr
 < 0) {

1048 
	`‰ì
(
rouã
);

1049  
îr
;

1051 
pcm
->
›s
 = &
¢d_pcm_rouã_›s
;

1052 
pcm
->
Á°_›s
 = &
¢d_pcm_∂ugö_Á°_›s
;

1053 
pcm
->
¥iv©e_d©a
 = 
rouã
;

1054 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

1055 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

1056 
pcm
->
t°amp_ty≥
 = 
¶ave
->tstamp_type;

1057 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
rouã
->
∂ug
.
hw_±r
, -1, 0);

1058 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
rouã
->
∂ug
.
≠∂_±r
, -1, 0);

1059 
îr
 = 
	`rouã_lﬂd_âabÀ
(&
rouã
->
∑øms
, 
pcm
->
°ªam
, 
â_ssize
, 
âabÀ
, 
â_cu£d
, 
â_su£d
);

1060 i‡(
îr
 < 0) {

1061 
	`¢d_pcm_˛o£
(
pcm
);

1062  
îr
;

1064 *
pcmp
 = 
pcm
;

1067 
	}
}

1069 
	$_¢d_pcm_rouã_dëîmöe_âabÀ
(
¢d_c⁄fig_t
 *
â
,

1070 *
â_csize
,

1071 *
â_ssize
,

1072 
¢d_pcm_chm≠_t
 *
chm≠
)

1074 
¢d_c⁄fig_ôî©‹_t
 
i
, 
öext
;

1075 
csize
 = 0, 
ssize
 = 0;

1076 
îr
;

1078 
	`as£π
(
â
 && 
â_csize
 && 
â_ssize
);

1079 
	`¢d_c⁄fig_f‹_óch
(
i
, 
öext
, 
â
) {

1080 
¢d_c⁄fig_t
 *
ö
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1081 
¢d_c⁄fig_ôî©‹_t
 
j
, 
j√xt
;

1082 
cch™√l
;

1083 c⁄° *
id
;

1084 i‡(
	`¢d_c⁄fig_gë_id
(
ö
, &
id
) < 0)

1086 
îr
 = 
	`ß„_°πﬁ
(
id
, &
cch™√l
);

1087 i‡(
îr
 < 0) {

1088 
	`SNDERR
("InvÆid clõ¡ ch™√l: %s", 
id
);

1089  -
EINVAL
;

1091 i‡(
cch™√l
 + 1 > 
csize
)

1092 
csize
 = 
cch™√l
 + 1;

1093 i‡(
	`¢d_c⁄fig_gë_ty≥
(
ö
Ë!
SND_CONFIG_TYPE_COMPOUND
)

1094  -
EINVAL
;

1095 
	`¢d_c⁄fig_f‹_óch
(
j
, 
j√xt
, 
ö
) {

1096 
¢d_c⁄fig_t
 *
jnode
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
j
);

1097 
sch™√l
;

1098 c⁄° *
id
;

1099 i‡(
	`¢d_c⁄fig_gë_id
(
jnode
, &
id
) < 0)

1101 
îr
 = 
	`°πoch™√l
(
id
, 
chm≠
, &
sch™√l
, 1);

1102 i‡(
îr
 < 0) {

1103 
	`SNDERR
("InvÆid sœvêch™√l: %s", 
id
);

1104  -
EINVAL
;

1106 i‡(
sch™√l
 + 1 > 
ssize
)

1107 
ssize
 = 
sch™√l
 + 1;

1110 i‡(
csize
 =0 || 
ssize
 == 0) {

1111 
	`SNDERR
("InvalidÇullÅtable configuration");

1112  -
EINVAL
;

1114 *
â_csize
 = 
csize
;

1115 *
â_ssize
 = 
ssize
;

1117 
	}
}

1126 
	$¢d_pcm_rouã_dëîmöe_âabÀ
(
¢d_c⁄fig_t
 *
â
,

1127 *
â_csize
,

1128 *
â_ssize
)

1130  
	`_¢d_pcm_rouã_dëîmöe_âabÀ
(
â
, 
â_csize
, 
â_ssize
, 
NULL
);

1131 
	}
}

1144 
	$_¢d_pcm_rouã_lﬂd_âabÀ
(
¢d_c⁄fig_t
 *
â
, 
¢d_pcm_rouã_âabÀ_íåy_t
 *
âabÀ
,

1145 
â_csize
, 
â_ssize
,

1146 *
â_cu£d
, *
â_su£d
,

1147 
sch™√ls
, 
¢d_pcm_chm≠_t
 *
chm≠
)

1149 
cu£d
 = -1;

1150 
su£d
 = -1;

1151 
¢d_c⁄fig_ôî©‹_t
 
i
, 
öext
;

1152 
k
;

1153 
îr
;

1155 *
scha
 = 
	`Æloˇ
(
â_ssize
 * ());

1156 i‡(
scha
 =
NULL
)

1157  -
ENOMEM
;

1159 
k
 = 0; k < 
â_csize
 * 
â_ssize
; ++k)

1160 
âabÀ
[
k
] = 0.0;

1161 
	`¢d_c⁄fig_f‹_óch
(
i
, 
öext
, 
â
) {

1162 
¢d_c⁄fig_t
 *
ö
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1163 
¢d_c⁄fig_ôî©‹_t
 
j
, 
j√xt
;

1164 
cch™√l
;

1165 c⁄° *
id
;

1166 i‡(
	`¢d_c⁄fig_gë_id
(
ö
, &
id
) < 0)

1168 
îr
 = 
	`ß„_°πﬁ
(
id
, &
cch™√l
);

1169 i‡(
îr
 < 0 ||

1170 
cch™√l
 < 0 || (Ëcch™√»> 
â_csize
) {

1171 
	`SNDERR
("InvÆid clõ¡ ch™√l: %s", 
id
);

1172  -
EINVAL
;

1174 i‡(
	`¢d_c⁄fig_gë_ty≥
(
ö
Ë!
SND_CONFIG_TYPE_COMPOUND
)

1175  -
EINVAL
;

1176 
	`¢d_c⁄fig_f‹_óch
(
j
, 
j√xt
, 
ö
) {

1177 
¢d_c⁄fig_t
 *
jnode
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
j
);

1178 
vÆue
;

1179 
ss
;

1180 c⁄° *
id
;

1181 i‡(
	`¢d_c⁄fig_gë_id
(
jnode
, &
id
) < 0)

1184 
ss
 = 
	`°πoch™√l
(
id
, 
chm≠
, 
scha
, 
â_ssize
);

1185 i‡(
ss
 < 0) {

1186 
	`SNDERR
("InvÆid sœvêch™√l: %s", 
id
);

1187  -
EINVAL
;

1190 
îr
 = 
	`¢d_c⁄fig_gë_úól
(
jnode
, &
vÆue
);

1191 i‡(
îr
 < 0) {

1192 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1193  -
EINVAL
;

1196 
k
 = 0; (Ëk < 
ss
; k++) {

1197 
sch™√l
 = 
scha
[
k
];

1198 i‡(
sch™√l
 < 0 || (Ësch™√»> 
â_ssize
 ||

1199 (
sch™√ls
 > 0 && 
sch™√l
 >= schannels)) {

1200 
	`SNDERR
("InvÆid sœvêch™√l: %s", 
id
);

1201  -
EINVAL
;

1203 
âabÀ
[
cch™√l
 * 
â_ssize
 + 
sch™√l
] = 
vÆue
;

1204 i‡(
sch™√l
 > 
su£d
)

1205 
su£d
 = 
sch™√l
;

1208 i‡(
cch™√l
 > 
cu£d
)

1209 
cu£d
 = 
cch™√l
;

1211 *
â_su£d
 = 
su£d
 + 1;

1212 *
â_cu£d
 = 
cu£d
 + 1;

1214 
	}
}

1227 
	$¢d_pcm_rouã_lﬂd_âabÀ
(
¢d_c⁄fig_t
 *
â
, 
¢d_pcm_rouã_âabÀ_íåy_t
 *
âabÀ
,

1228 
â_csize
, 
â_ssize
,

1229 *
â_cu£d
, *
â_su£d
,

1230 
sch™√ls
)

1232  
	`_¢d_pcm_rouã_lﬂd_âabÀ
(
â
, 
âabÀ
, 
â_csize
, 
â_ssize
,

1233 
â_cu£d
, 
â_su£d
, 
sch™√ls
, 
NULL
);

1234 
	}
}

1289 
	$_¢d_pcm_rouã_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1290 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

1291 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

1293 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1294 
îr
;

1295 
¢d_pcm_t
 *
•cm
;

1296 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

1297 
¢d_pcm_chm≠_t
 *
â_chm≠
 = 
NULL
, *
chm≠
 = NULL;

1298 
¢d_pcm_f‹m©_t
 
sf‹m©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1299 
sch™√ls
 = -1;

1300 
¢d_c⁄fig_t
 *
â
 = 
NULL
;

1301 
¢d_pcm_rouã_âabÀ_íåy_t
 *
âabÀ
 = 
NULL
;

1302 
csize
, 
ssize
;

1303 
cu£d
, 
su£d
;

1304 
¢d_pcm_chm≠_quîy_t
 **
chm≠s
 = 
NULL
;

1305 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1306 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1307 c⁄° *
id
;

1308 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1310 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

1312 i‡(
	`°rcmp
(
id
, "slave") == 0) {

1313 
¶ave
 = 
n
;

1316 i‡(
	`°rcmp
(
id
, "ttable") == 0) {

1317 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1318 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1319 
	`¢d_pcm_‰ì_chm≠s
(
chm≠s
);

1320  -
EINVAL
;

1322 
â
 = 
n
;

1325 i‡(
	`°rcmp
(
id
, "chmap") == 0) {

1326 
chm≠s
 = 
	`_¢d_pcm_∑r£_c⁄fig_chm≠s
(
n
);

1327 i‡(!
chm≠s
) {

1328 
	`SNDERR
("InvÆid ch™√»m≠ f‹ %s", 
id
);

1329  -
EINVAL
;

1333 
	`SNDERR
("Unknow¿fõld %s", 
id
);

1334  -
EINVAL
;

1336 i‡(!
¶ave
) {

1337 
	`SNDERR
("slave isÇot defined");

1338 
	`¢d_pcm_‰ì_chm≠s
(
chm≠s
);

1339  -
EINVAL
;

1341 i‡(!
â
) {

1342 
	`SNDERR
("ttable isÇot defined");

1343 
	`¢d_pcm_‰ì_chm≠s
(
chm≠s
);

1344  -
EINVAL
;

1346 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 2,

1347 
SND_PCM_HW_PARAM_FORMAT
, 0, &
sf‹m©
,

1348 
SND_PCM_HW_PARAM_CHANNELS
, 0, &
sch™√ls
);

1349 i‡(
îr
 < 0) {

1350 
	`¢d_pcm_‰ì_chm≠s
(
chm≠s
);

1351  
îr
;

1353 i‡(
sf‹m©
 !
SND_PCM_FORMAT_UNKNOWN
 &&

1354 
	`¢d_pcm_f‹m©_löór
(
sf‹m©
) != 1) {

1355 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1356 
	`SNDERR
("slave format isÇotÜinear");

1357 
	`¢d_pcm_‰ì_chm≠s
(
chm≠s
);

1358  -
EINVAL
;

1361 
îr
 = 
	`dëîmöe_chm≠
(
â
, &
â_chm≠
);

1362 i‡(
îr
 < 0) {

1363 
	`‰ì
(
âabÀ
);

1364  
îr
;

1367 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

1368 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1369 i‡(
îr
 < 0) {

1370 
	`‰ì
(
â_chm≠
);

1371 
	`‰ì
(
âabÀ
);

1372 
	`¢d_pcm_‰ì_chm≠s
(
chm≠s
);

1373  
îr
;

1376 i‡(
â_chm≠
) {

1377 i‡(!
chm≠s
)

1378 
chm≠s
 = 
	`¢d_pcm_quîy_chm≠s
(
•cm
);

1379 i‡(
chm≠s
)

1380 
îr
 = 
	`föd_m©chög_chm≠
(
chm≠s
, 
â_chm≠
, &
chm≠
,

1381 &
sch™√ls
);

1382 
	`‰ì
(
â_chm≠
);

1383 i‡(
chm≠s
 && 
îr
 < 0) {

1384 
	`¢d_pcm_‰ì_chm≠s
(
chm≠s
);

1385 
	`¢d_pcm_˛o£
(
•cm
);

1386  
îr
;

1390 
îr
 = 
	`_¢d_pcm_rouã_dëîmöe_âabÀ
(
â
, &
csize
, &
ssize
, 
chm≠
);

1391 i‡(
îr
 < 0) {

1392 
	`‰ì
(
chm≠
);

1393 
	`¢d_pcm_‰ì_chm≠s
(
chm≠s
);

1394 
	`¢d_pcm_˛o£
(
•cm
);

1395  
îr
;

1397 
âabÀ
 = 
	`mÆloc
(
csize
 * 
ssize
 * (
¢d_pcm_rouã_âabÀ_íåy_t
));

1398 i‡(
âabÀ
 =
NULL
) {

1399 
	`‰ì
(
chm≠
);

1400 
	`¢d_pcm_‰ì_chm≠s
(
chm≠s
);

1401 
	`¢d_pcm_˛o£
(
•cm
);

1402  -
ENOMEM
;

1404 
îr
 = 
	`_¢d_pcm_rouã_lﬂd_âabÀ
(
â
, 
âabÀ
, 
csize
, 
ssize
,

1405 &
cu£d
, &
su£d
, 
sch™√ls
, 
chm≠
);

1406 i‡(
îr
 < 0) {

1407 
	`‰ì
(
chm≠
);

1408 
	`‰ì
(
âabÀ
);

1409 
	`¢d_pcm_‰ì_chm≠s
(
chm≠s
);

1410 
	`¢d_pcm_˛o£
(
•cm
);

1411  
îr
;

1414 
îr
 = 
	`¢d_pcm_rouã_›í
(
pcmp
, 
«me
, 
sf‹m©
, 
sch™√ls
,

1415 
âabÀ
, 
ssize
,

1416 
cu£d
, 
su£d
,

1417 
•cm
, 1);

1418 
	`‰ì
(
âabÀ
);

1419 i‡(
îr
 < 0) {

1420 
	`‰ì
(
chm≠
);

1421 
	`¢d_pcm_‰ì_chm≠s
(
chm≠s
);

1422 
	`¢d_pcm_˛o£
(
•cm
);

1424 
¢d_pcm_rouã_t
 *
rouã
 = (*
pcmp
)->
¥iv©e_d©a
;

1426 
rouã
->
chm≠
 = chmap;

1427 
rouã
->
chm≠_ovîride
 = 
chm≠s
;

1430  
îr
;

1431 
	}
}

1432 #i‚de‡
DOC_HIDDEN


1433 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_rouã_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_share.c

29 
	~"pcm_loˇl.h
"

30 
	~<°dio.h
>

31 
	~<°dlib.h
>

32 
	~<limôs.h
>

33 
	~<uni°d.h
>

34 
	~<°rög.h
>

35 
	~<sig«l.h
>

36 
	~<m©h.h
>

37 
	~<sys/sockë.h
>

38 
	~<pﬁl.h
>

39 
	~<±hªad.h
>

41 #i‚de‡
PIC


43 c⁄° *
	g_¢d_moduÀ_pcm_sh¨e
 = "";

46 #i‚de‡
DOC_HIDDEN


48 
LIST_HEAD
(
¢d_pcm_sh¨e_¶aves
);

49 
±hªad_muãx_t
 
	g¢d_pcm_sh¨e_¶aves_muãx
 = 
PTHREAD_MUTEX_INITIALIZER
;

51 #ifde‡
MUTEX_DEBUG


52 
	#Pthªad_muãx_lock
(
muãx
) \

53 *
¢d_pcm_sh¨e_¶aves_muãx_hﬁdî
;

	)

55 
	gîr
 = 
±hªad_muãx_åylock
(
muãx
); \

56 i‡(
	gîr
 < 0) { \

57 
Ârötf
(
°dîr
, "lock " #muãx " i†busy (%s): waôög i¿" 
__func__
 "\n", *(
muãx
##
_hﬁdî
)); \

58 
±hªad_muãx_lock
(
muãx
); \

59 
Ârötf
(
°dîr
, "... got\n"); \

61 *(
	gmuãx
##
	g_hﬁdî
Ë
__func__
; \

64 
	#Pthªad_muãx_u∆ock
(
muãx
) \

66 *(
muãx
##
_hﬁdî
) = 0; \

67 
	`±hªad_muãx_u∆ock
(
muãx
); \

68 
	}
} 0)

	)

70 
	#Pthªad_muãx_lock
(
muãx
Ë
	`±hªad_muãx_lock
(muãx)

	)

71 
	#Pthªad_muãx_u∆ock
(
muãx
Ë
	`±hªad_muãx_u∆ock
(muãx)

	)

75 
li°_hód
 
	m˛õ¡s
;

76 
li°_hód
 
	mli°
;

77 
¢d_pcm_t
 *
	mpcm
;

78 
¢d_pcm_f‹m©_t
 
	mf‹m©
;

79 
	møã
;

80 
	mch™√ls
;

81 
¢d_pcm_s‰ames_t
 
	m≥riod_time
;

82 
¢d_pcm_s‰ames_t
 
	mbuf„r_time
;

83 
	m›í_cou¡
;

84 
	m£tup_cou¡
;

85 
	m¥ï¨ed_cou¡
;

86 
	mru¬ög_cou¡
;

87 
¢d_pcm_u‰ames_t
 
	mß„ty_thªshﬁd
;

88 
¢d_pcm_u‰ames_t
 
	msûí˚_‰ames
;

89 
¢d_pcm_sw_∑øms_t
 
	msw_∑øms
;

90 
¢d_pcm_u‰ames_t
 
	mhw_±r
;

91 
	mpﬁl
[2];

92 
	mpﬁlög
;

93 
±hªad_t
 
	mthªad
;

94 
±hªad_muãx_t
 
	mmuãx
;

95 #ifde‡
MUTEX_DEBUG


96 *
	mmuãx_hﬁdî
;

98 
±hªad_c⁄d_t
 
	mpﬁl_c⁄d
;

99 } 
	t¢d_pcm_sh¨e_¶ave_t
;

102 
li°_hód
 
	mli°
;

103 
¢d_pcm_t
 *
	mpcm
;

104 
¢d_pcm_sh¨e_¶ave_t
 *
	m¶ave
;

105 
	mch™√ls
;

106 *
	m¶ave_ch™√ls
;

107 
	mdøö_sûí˚d
;

108 
¢d_htime°amp_t
 
	måiggî_t°amp
;

109 
¢d_pcm_°©e_t
 
	m°©e
;

110 
¢d_pcm_u‰ames_t
 
	mhw_±r
;

111 
¢d_pcm_u‰ames_t
 
	m≠∂_±r
;

112 
	mªady
;

113 
	m˛õ¡_sockë
;

114 
	m¶ave_sockë
;

115 } 
	t¢d_pcm_sh¨e_t
;

119 
_¢d_pcm_sh¨e_°›
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©e_t
 
°©e
);

121 
¢d_pcm_u‰ames_t
 
	$¢d_pcm_sh¨e_¶ave_avaû
(
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
)

123 
¢d_pcm_s‰ames_t
 
avaû
;

124 
¢d_pcm_t
 *
pcm
 = 
¶ave
->pcm;

125 
avaû
 = 
¶ave
->
hw_±r
 - *
pcm
->
≠∂
.
±r
;

126 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

127 
avaû
 +
pcm
->
buf„r_size
;

128 i‡(
avaû
 < 0)

129 
avaû
 +
pcm
->
bound¨y
;

130 i‡((
¢d_pcm_u‰ames_t
Ë
avaû
 >
pcm
->
bound¨y
)

131 
avaû
 -
pcm
->
bound¨y
;

132  
avaû
;

133 
	}
}

137 
¢d_pcm_u‰ames_t
 
	$_¢d_pcm_sh¨e_¶ave_f‹w¨d
(
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
)

139 
li°_hód
 *
i
;

140 
¢d_pcm_u‰ames_t
 
buf„r_size
;

141 
¢d_pcm_s‰ames_t
 
‰ames
, 
ß„ty_‰ames
;

142 
¢d_pcm_s‰ames_t
 
mö_‰ames
, 
max_‰ames
;

143 
¢d_pcm_u‰ames_t
 
avaû
, 
¶ave_avaû
;

144 
¢d_pcm_u‰ames_t
 
¶ave_hw_avaû
;

145 
¶ave_avaû
 = 
	`¢d_pcm_sh¨e_¶ave_avaû
(
¶ave
);

146 
buf„r_size
 = 
¶ave
->
pcm
->buffer_size;

147 
mö_‰ames
 = 
¶ave_avaû
;

148 
max_‰ames
 = 0;

149 
	`li°_f‹_óch
(
i
, &
¶ave
->
˛õ¡s
) {

150 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
	`li°_íåy
(
i
, snd_pcm_sh¨e_t, 
li°
);

151 
¢d_pcm_t
 *
pcm
 = 
sh¨e
->pcm;

152 
sh¨e
->
°©e
) {

153 
SND_PCM_STATE_RUNNING
:

155 
SND_PCM_STATE_DRAINING
:

156 i‡(
pcm
->
°ªam
 !
SND_PCM_STREAM_PLAYBACK
)

162 
avaû
 = 
	`¢d_pcm_mm≠_avaû
(
pcm
);

163 
‰ames
 = 
¶ave_avaû
 - 
avaû
;

164 i‡(
‰ames
 > 
max_‰ames
)

165 
max_‰ames
 = 
‰ames
;

166 i‡(
sh¨e
->
°©e
 !
SND_PCM_STATE_RUNNING
)

168 i‡(
‰ames
 < 
mö_‰ames
)

169 
mö_‰ames
 = 
‰ames
;

171 i‡(
max_‰ames
 == 0)

173 
‰ames
 = 
mö_‰ames
;

175 
¶ave_hw_avaû
 = 
buf„r_size
 - 
¶ave_avaû
;

176 
ß„ty_‰ames
 = 
¶ave
->
ß„ty_thªshﬁd
 - 
¶ave_hw_avaû
;

177 i‡(
ß„ty_‰ames
 > 0 &&

178 
‰ames
 < 
ß„ty_‰ames
) {

180 i‡(
max_‰ames
 < 
ß„ty_‰ames
)

181 
‰ames
 = 
max_‰ames
;

183 
‰ames
 = 
ß„ty_‰ames
;

185 i‡(
‰ames
 < 0)

187  
‰ames
;

188 
	}
}

197 
¢d_pcm_u‰ames_t
 
	$_¢d_pcm_sh¨e_missög
(
¢d_pcm_t
 *
pcm
)

199 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

200 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

201 
¢d_pcm_t
 *
•cm
 = 
¶ave
->
pcm
;

202 
¢d_pcm_u‰ames_t
 
buf„r_size
 = 
•cm
->buffer_size;

203 
ªady
 = 1, 
ru¬ög
 = 0;

204 
¢d_pcm_u‰ames_t
 
avaû
 = 0, 
¶ave_avaû
;

205 
¢d_pcm_s‰ames_t
 
hw_avaû
;

206 
¢d_pcm_u‰ames_t
 
missög
 = 
INT_MAX
;

207 
¢d_pcm_s‰ames_t
 
ªady_missög
;

208 
ssize_t
 
s
;

210 
sh¨e
->
°©e
) {

211 
SND_PCM_STATE_RUNNING
:

213 
SND_PCM_STATE_DRAINING
:

214 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

218  
INT_MAX
;

220 
sh¨e
->
hw_±r
 = 
¶ave
->hw_ptr;

221 
avaû
 = 
	`¢d_pcm_mm≠_avaû
(
pcm
);

222 i‡(
avaû
 >
pcm
->
°›_thªshﬁd
) {

223 
	`_¢d_pcm_sh¨e_°›
(
pcm
, 
sh¨e
->
°©e
 =
SND_PCM_STATE_DRAINING
 ? 
SND_PCM_STATE_SETUP
 : 
SND_PCM_STATE_XRUN
);

224 
upd©e_pﬁl
;

226 
hw_avaû
 = 
buf„r_size
 - 
avaû
;

227 
¶ave_avaû
 = 
	`¢d_pcm_sh¨e_¶ave_avaû
(
¶ave
);

228 i‡(
avaû
 < 
¶ave_avaû
) {

230 
¢d_pcm_s‰ames_t
 
¶ave_hw_avaû
 = 
buf„r_size
 - 
¶ave_avaû
;

231 
¢d_pcm_s‰ames_t
 
ß„ty_missög
 = 
¶ave_hw_avaû
 - 
¶ave
->
ß„ty_thªshﬁd
;

232 i‡(
ß„ty_missög
 < 0) {

233 
¢d_pcm_s‰ames_t
 
îr
;

234 
¢d_pcm_s‰ames_t
 
‰ames
 = 
¶ave_avaû
 - 
avaû
;

235 i‡(-
ß„ty_missög
 <
‰ames
) {

236 
‰ames
 = -
ß„ty_missög
;

237 
missög
 = 1;

239 
îr
 = 
	`¢d_pcm_mm≠_commô
(
•cm
, 
	`¢d_pcm_mm≠_off£t
(•cm), 
‰ames
);

240 i‡(
îr
 < 0) {

241 
	`SYSMSG
("snd_pcm_mmap_commitÉrror");

242  
INT_MAX
;

244 i‡(
îr
 !
‰ames
)

245 
	`SYSMSG
("commôÑëu∫†%ld f‹ sizê%ld", 
îr
, 
‰ames
);

246 
¶ave_avaû
 -
îr
;

248 i‡(
ß„ty_missög
 == 0)

249 
missög
 = 1;

251 
missög
 = 
ß„ty_missög
;

254 
sh¨e
->
°©e
) {

255 
SND_PCM_STATE_DRAINING
:

256 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

257 i‡(
hw_avaû
 <= 0) {

258 
	`_¢d_pcm_sh¨e_°›
(
pcm
, 
SND_PCM_STATE_SETUP
);

261 i‡((
¢d_pcm_u‰ames_t
)
hw_avaû
 < 
missög
)

262 
missög
 = 
hw_avaû
;

263 
ru¬ög
 = 1;

264 
ªady
 = 0;

267 
SND_PCM_STATE_RUNNING
:

268 i‡(
avaû
 >
pcm
->
°›_thªshﬁd
) {

269 
	`_¢d_pcm_sh¨e_°›
(
pcm
, 
SND_PCM_STATE_XRUN
);

272 
¢d_pcm_u‰ames_t
 
xrun_missög
 = 
pcm
->
°›_thªshﬁd
 - 
avaû
;

273 i‡(
missög
 > 
xrun_missög
)

274 
missög
 = 
xrun_missög
;

276 
ªady_missög
 = 
pcm
->
avaû_mö
 - 
avaû
;

277 i‡(
ªady_missög
 > 0) {

278 
ªady
 = 0;

279 i‡(
missög
 > (
¢d_pcm_u‰ames_t
)
ªady_missög
)

280 
missög
 = 
ªady_missög
;

282 
ru¬ög
 = 1;

285 
	`SNDERR
("övÆid sh¨ed PCM sèã %d", 
sh¨e
->
°©e
);

286  
INT_MAX
;

289 
upd©e_pﬁl
:

290 i‡(
ªady
 !
sh¨e
->ready) {

291 
buf
[1];

293 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

294 i‡(
ªady
)

295 
s
 = 
	`ªad
(
sh¨e
->
¶ave_sockë
, 
buf
, 1);

297 
s
 = 
	`wrôe
(
sh¨e
->
˛õ¡_sockë
, 
buf
, 1);

299 i‡(
ªady
)

300 
s
 = 
	`wrôe
(
sh¨e
->
¶ave_sockë
, 
buf
, 1);

302 
s
 = 
	`ªad
(
sh¨e
->
˛õ¡_sockë
, 
buf
, 1);

304 i‡(
s
 < 0) {

305 i‡(
î∫o
 =
EINTR
)

307  
INT_MAX
;

311 
sh¨e
->
ªady
 =Ñeady;

313 i‡(!
ru¬ög
)

314  
INT_MAX
;

315 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
 &&

316 
sh¨e
->
°©e
 =
SND_PCM_STATE_DRAINING
 &&

317 !
sh¨e
->
døö_sûí˚d
) {

319 i‡(
avaû
 >
¶ave
->
sûí˚_‰ames
) {

320 
¢d_pcm_u‰ames_t
 
off£t
 = 
sh¨e
->
≠∂_±r
 % 
buf„r_size
;

321 
¢d_pcm_u‰ames_t
 
x„r
 = 0;

322 
¢d_pcm_u‰ames_t
 
size
 = 
¶ave
->
sûí˚_‰ames
;

323 
x„r
 < 
size
) {

324 
¢d_pcm_u‰ames_t
 
‰ames
 = 
size
 - 
x„r
;

325 
¢d_pcm_u‰ames_t
 
c⁄t
 = 
buf„r_size
 - 
off£t
;

326 i‡(
c⁄t
 < 
‰ames
)

327 
‰ames
 = 
c⁄t
;

328 
	`¢d_pcm_¨ós_sûí˚
(
pcm
->
ru¬ög_¨ós
, 
off£t
,Öcm->
ch™√ls
, 
‰ames
,Öcm->
f‹m©
);

329 
off£t
 +
‰ames
;

330 i‡(
off£t
 >
buf„r_size
)

331 
off£t
 = 0;

332 
x„r
 +
‰ames
;

334 
sh¨e
->
døö_sûí˚d
 = 1;

336 
¢d_pcm_u‰ames_t
 
sûí˚_missög
;

337 
sûí˚_missög
 = 
¶ave
->
sûí˚_‰ames
 - 
avaû
;

338 i‡(
sûí˚_missög
 < 
missög
)

339 
missög
 = 
sûí˚_missög
;

343  
missög
;

344 
	}
}

346 
¢d_pcm_u‰ames_t
 
	$_¢d_pcm_sh¨e_¶ave_missög
(
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
)

348 
¢d_pcm_u‰ames_t
 
missög
 = 
INT_MAX
;

349 
li°_hód
 *
i
;

350  
	`¢d_pcm_avaû_upd©e
(
¶ave
->
pcm
);

351 
¶ave
->
hw_±r
 = *¶ave->
pcm
->
hw
.
±r
;

352 
	`li°_f‹_óch
(
i
, &
¶ave
->
˛õ¡s
) {

353 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
	`li°_íåy
(
i
, snd_pcm_sh¨e_t, 
li°
);

354 
¢d_pcm_t
 *
pcm
 = 
sh¨e
->pcm;

355 
¢d_pcm_u‰ames_t
 
m
 = 
	`_¢d_pcm_sh¨e_missög
(
pcm
);

356 i‡(
m
 < 
missög
)

357 
missög
 = 
m
;

359  
missög
;

360 
	}
}

362 *
	$¢d_pcm_sh¨e_thªad
(*
d©a
)

364 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
d©a
;

365 
¢d_pcm_t
 *
•cm
 = 
¶ave
->
pcm
;

366 
pﬁlfd
 
pfd
[2];

367 
îr
;

369 
pfd
[0].
fd
 = 
¶ave
->
pﬁl
[0];

370 
pfd
[0].
evíts
 = 
POLLIN
;

371 
îr
 = 
	`¢d_pcm_pﬁl_des¸ùt‹s
(
•cm
, &
pfd
[1], 1);

372 i‡(
îr
 != 1) {

373 
	`SNDERR
("övÆidÖﬁ»des¸ùt‹†%d", 
îr
);

374  
NULL
;

376 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

377 
îr
 = 
	`pùe
(
¶ave
->
pﬁl
);

378 i‡(
îr
 < 0) {

379 
	`SYSERR
("can't createáÖipe");

380 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

381  
NULL
;

383 
¶ave
->
›í_cou¡
 > 0) {

384 
¢d_pcm_u‰ames_t
 
missög
;

386 
missög
 = 
	`_¢d_pcm_sh¨e_¶ave_missög
(
¶ave
);

388 i‡(
missög
 < 
INT_MAX
) {

389 
¢d_pcm_u‰ames_t
 
hw_±r
;

390 
¢d_pcm_s‰ames_t
 
avaû_mö
;

391 
hw_±r
 = 
¶ave
->hw_±∏+ 
missög
;

392 
hw_±r
 +
•cm
->
≥riod_size
 - 1;

393 i‡(
hw_±r
 >
•cm
->
bound¨y
)

394 
hw_±r
 -
•cm
->
bound¨y
;

395 
hw_±r
 -hw_±∏% 
•cm
->
≥riod_size
;

396 
avaû_mö
 = 
hw_±r
 - *
•cm
->
≠∂
.
±r
;

397 i‡(
•cm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

398 
avaû_mö
 +
•cm
->
buf„r_size
;

399 i‡(
avaû_mö
 < 0)

400 
avaû_mö
 +
•cm
->
bound¨y
;

402 i‡((
¢d_pcm_u‰ames_t
)
avaû_mö
 !
•cm
->avail_min) {

403 
	`¢d_pcm_sw_∑øms_£t_avaû_mö
(
•cm
, &
¶ave
->
sw_∑øms
, 
avaû_mö
);

404 
îr
 = 
	`¢d_pcm_sw_∑øms
(
•cm
, &
¶ave
->
sw_∑øms
);

405 i‡(
îr
 < 0) {

406 
	`SYSERR
("snd_pcm_sw_paramsÉrror");

407 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

408  
NULL
;

411 
¶ave
->
pﬁlög
 = 1;

412 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

413 
îr
 = 
	`pﬁl
(
pfd
, 2, -1);

414 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

415 i‡(
pfd
[0].
ªvíts
 & 
POLLIN
) {

416 
buf
[1];

417 
	`ªad
(
pfd
[0].
fd
, 
buf
, 1);

420 
¶ave
->
pﬁlög
 = 0;

421 
	`±hªad_c⁄d_waô
(&
¶ave
->
pﬁl_c⁄d
, &¶ave->
muãx
);

424 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

425  
NULL
;

426 
	}
}

428 
	$_¢d_pcm_sh¨e_upd©e
(
¢d_pcm_t
 *
pcm
)

430 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

431 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

432 
¢d_pcm_t
 *
•cm
 = 
¶ave
->
pcm
;

433 
¢d_pcm_u‰ames_t
 
missög
;

434  
	`¢d_pcm_avaû_upd©e
(
•cm
);

435 
¶ave
->
hw_±r
 = *¶ave->
pcm
->
hw
.
±r
;

436 
missög
 = 
	`_¢d_pcm_sh¨e_missög
(
pcm
);

438 i‡(!
¶ave
->
pﬁlög
) {

439 
	`±hªad_c⁄d_sig«l
(&
¶ave
->
pﬁl_c⁄d
);

442 i‡(
missög
 < 
INT_MAX
) {

443 
¢d_pcm_u‰ames_t
 
hw_±r
;

444 
¢d_pcm_s‰ames_t
 
avaû_mö
;

445 
hw_±r
 = 
¶ave
->hw_±∏+ 
missög
;

446 
hw_±r
 +
•cm
->
≥riod_size
 - 1;

447 i‡(
hw_±r
 >
•cm
->
bound¨y
)

448 
hw_±r
 -
•cm
->
bound¨y
;

449 
hw_±r
 -hw_±∏% 
•cm
->
≥riod_size
;

450 
avaû_mö
 = 
hw_±r
 - *
•cm
->
≠∂
.
±r
;

451 i‡(
•cm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

452 
avaû_mö
 +
•cm
->
buf„r_size
;

453 i‡(
avaû_mö
 < 0)

454 
avaû_mö
 +
•cm
->
bound¨y
;

455 i‡((
¢d_pcm_u‰ames_t
)
avaû_mö
 < 
•cm
->avail_min) {

456 
îr
;

457 
	`¢d_pcm_sw_∑øms_£t_avaû_mö
(
•cm
, &
¶ave
->
sw_∑øms
, 
avaû_mö
);

458 
îr
 = 
	`¢d_pcm_sw_∑øms
(
•cm
, &
¶ave
->
sw_∑øms
);

459 i‡(
îr
 < 0) {

460 
	`SYSERR
("snd_pcm_sw_paramsÉrror");

465 
	}
}

467 
	$¢d_pcm_sh¨e_n⁄block
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
n⁄block
 ATTRIBUTE_UNUSED)

470 
	}
}

472 
	$¢d_pcm_sh¨e_async
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
sig
 ATTRIBUTE_UNUSED, 
pid_t
 
pid
 ATTRIBUTE_UNUSED)

474  -
ENOSYS
;

475 
	}
}

477 
	$¢d_pcm_sh¨e_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_öfo_t
 *
öfo
)

479 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

480  
	`¢d_pcm_öfo
(
sh¨e
->
¶ave
->
pcm
, 
öfo
);

481 
	}
}

483 
	$¢d_pcm_sh¨e_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

485 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

486 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

487 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
;

488 
îr
;

489 
	`¢d_pcm_ac˚ss_mask_™y
(&
ac˚ss_mask
);

490 
	`¢d_pcm_ac˚ss_mask_ª£t
(&
ac˚ss_mask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

491 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

492 &
ac˚ss_mask
);

493 i‡(
îr
 < 0)

494  
îr
;

495 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t
(
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
,

496 
sh¨e
->
ch™√ls
, 0);

497 i‡(
îr
 < 0)

498  
îr
;

499 i‡(
¶ave
->
f‹m©
 !
SND_PCM_FORMAT_UNKNOWN
) {

500 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
∑øms
, 
¶ave
->
f‹m©
);

501 i‡(
îr
 < 0)

502  
îr
;

505 i‡(
¶ave
->
øã
 >= 0) {

506 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
,

507 
¶ave
->
øã
, 0);

508 i‡(
îr
 < 0)

509  
îr
;

511 i‡(
¶ave
->
≥riod_time
 >= 0) {

512 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
,

513 
¶ave
->
≥riod_time
, 0);

514 i‡(
îr
 < 0)

515  
îr
;

517 i‡(
¶ave
->
buf„r_time
 >= 0) {

518 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_TIME
,

519 
¶ave
->
buf„r_time
, 0);

520 i‡(
îr
 < 0)

521  
îr
;

523 
∑øms
->
öfo
 |
SND_PCM_INFO_DOUBLE
;

525 
	}
}

527 
	$¢d_pcm_sh¨e_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

529 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

530 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

531 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

532 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

533 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

534 &
ßc˚ss_mask
);

535 
	`_¢d_pcm_hw_∑øm_£t
(
•¨ams
, 
SND_PCM_HW_PARAM_CHANNELS
,

536 
¶ave
->
ch™√ls
, 0);

538 
	}
}

540 
	$¢d_pcm_sh¨e_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

541 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

543 
îr
;

544 
löks
 = (
SND_PCM_HW_PARBIT_FORMAT
 |

545 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

546 
SND_PCM_HW_PARBIT_RATE
 |

547 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

548 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

549 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

550 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

551 
SND_PCM_HW_PARBIT_PERIODS
);

552 c⁄° 
¢d_pcm_ac˚ss_mask_t
 *
ac˚ss_mask
 = 
	`¢d_pcm_hw_∑øm_gë_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
);

553 i‡(!
	`¢d_pcm_ac˚ss_mask_ã°
(
ac˚ss_mask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
) &&

554 !
	`¢d_pcm_ac˚ss_mask_ã°
(
ac˚ss_mask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
) &&

555 !
	`¢d_pcm_ac˚ss_mask_ã°
(
ac˚ss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
)) {

556 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
;

557 
	`¢d_pcm_ac˚ss_mask_™y
(&
ßc˚ss_mask
);

558 
	`¢d_pcm_ac˚ss_mask_ª£t
(&
ßc˚ss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

559 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

560 &
ßc˚ss_mask
);

561 i‡(
îr
 < 0)

562  
îr
;

564 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

565 i‡(
îr
 < 0)

566  
îr
;

568 
	}
}

570 
	$¢d_pcm_sh¨e_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

571 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

573 
îr
;

574 
löks
 = (
SND_PCM_HW_PARBIT_FORMAT
 |

575 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

576 
SND_PCM_HW_PARBIT_RATE
 |

577 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

578 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

579 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

580 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

581 
SND_PCM_HW_PARBIT_PERIODS
);

582 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
;

583 c⁄° 
¢d_pcm_ac˚ss_mask_t
 *
ßc˚ss_mask
 = 
	`¢d_pcm_hw_∑øm_gë_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
);

584 
	`¢d_pcm_ac˚ss_mask_™y
(&
ac˚ss_mask
);

585 
	`¢d_pcm_ac˚ss_mask_ª£t
(&
ac˚ss_mask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

586 i‡(!
	`¢d_pcm_ac˚ss_mask_ã°
(
ßc˚ss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
))

587 
	`¢d_pcm_ac˚ss_mask_ª£t
(&
ac˚ss_mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

588 i‡(!
	`¢d_pcm_ac˚ss_mask_ã°
(
ßc˚ss_mask
, 
SND_PCM_ACCESS_MMAP_COMPLEX
) &&

589 !
	`¢d_pcm_ac˚ss_mask_ã°
(
ßc˚ss_mask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
))

590 
	`¢d_pcm_ac˚ss_mask_ª£t
(&
ac˚ss_mask
, 
SND_PCM_ACCESS_MMAP_COMPLEX
);

591 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

592 &
ac˚ss_mask
);

593 i‡(
îr
 < 0)

594  
îr
;

595 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

596 i‡(
îr
 < 0)

597  
îr
;

599 
	}
}

601 
	$¢d_pcm_sh¨e_hw_ªföe_¶ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

603 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

604  
	`¢d_pcm_hw_ªföe
(
sh¨e
->
¶ave
->
pcm
, 
∑øms
);

605 
	}
}

607 
	$¢d_pcm_sh¨e_hw_∑øms_¶ave
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

609 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

610  
	`_¢d_pcm_hw_∑øms_öã∫Æ
(
sh¨e
->
¶ave
->
pcm
, 
∑øms
);

611 
	}
}

613 
	$¢d_pcm_sh¨e_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

615  
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

616 
¢d_pcm_sh¨e_hw_ªföe_˝ª∑ª
,

617 
¢d_pcm_sh¨e_hw_ªföe_cch™ge
,

618 
¢d_pcm_sh¨e_hw_ªföe_•ª∑ª
,

619 
¢d_pcm_sh¨e_hw_ªföe_sch™ge
,

620 
¢d_pcm_sh¨e_hw_ªföe_¶ave
);

621 
	}
}

623 
	$¢d_pcm_sh¨e_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

625 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

626 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

627 
¢d_pcm_t
 *
•cm
 = 
¶ave
->
pcm
;

628 
îr
 = 0;

629 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

630 i‡(
¶ave
->
£tup_cou¡
) {

631 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
∑øms
, 
•cm
->
f‹m©
);

632 i‡(
îr
 < 0)

633 
_îr
;

634 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
∑øms
, 
•cm
->
subf‹m©
);

635 i‡(
îr
 < 0)

636 
_îr
;

637 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mömax
(
∑øms
, 
SND_PCM_HW_PARAM_RATE
,

638 
•cm
->
øã
, 0,

639 
•cm
->
øã
, 1);

640 i‡(
îr
 < 0)

641 
_îr
;

642 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mömax
(
∑øms
, 
SND_PCM_HW_PARAM_PERIOD_TIME
,

643 
•cm
->
≥riod_time
, 0,

644 
•cm
->
≥riod_time
, 1);

645 i‡(
îr
 < 0)

646 
_îr
;

647 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t
(
∑øms
, 
SND_PCM_HW_PARAM_BUFFER_SIZE
,

648 
•cm
->
buf„r_size
, 0);

649 
_îr
:

650 i‡(
îr
 < 0) {

651 
	`SNDERR
("slave isálreadyÑunning with incompatible setup");

652 
îr
 = -
EBUSY
;

653 
_íd
;

656 
îr
 = 
	`¢d_pcm_hw_∑øms_¶ave
(
pcm
, 
∑øms
,

657 
¢d_pcm_sh¨e_hw_ªföe_cch™ge
,

658 
¢d_pcm_sh¨e_hw_ªföe_•ª∑ª
,

659 
¢d_pcm_sh¨e_hw_ªföe_sch™ge
,

660 
¢d_pcm_sh¨e_hw_∑øms_¶ave
);

661 i‡(
îr
 < 0)

662 
_íd
;

663 
	`¢d_pcm_sw_∑øms_cuºít
(
¶ave
->
pcm
, &¶ave->
sw_∑øms
);

665 
¶ave
->
ß„ty_thªshﬁd
 = sœve->
pcm
->
øã
 * 30 / 1000;

666 
¶ave
->
ß„ty_thªshﬁd
 +¶ave->
pcm
->
≥riod_size
 - 1;

667 
¶ave
->
ß„ty_thªshﬁd
 -¶ave->ß„ty_thªshﬁd % sœve->
pcm
->
≥riod_size
;

668 
¶ave
->
sûí˚_‰ames
 = sœve->
ß„ty_thªshﬁd
;

669 i‡(
¶ave
->
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

670 
	`¢d_pcm_¨ós_sûí˚
(
¶ave
->
pcm
->
ru¬ög_¨ós
, 0, sœve->pcm->
ch™√ls
, sœve->pcm->
buf„r_size
, sœve->pcm->
f‹m©
);

672 
sh¨e
->
°©e
 = 
SND_PCM_STATE_SETUP
;

673 
¶ave
->
£tup_cou¡
++;

674 
_íd
:

675 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

676  
îr
;

677 
	}
}

679 
	$¢d_pcm_sh¨e_hw_‰ì
(
¢d_pcm_t
 *
pcm
)

681 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

682 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

683 
îr
 = 0;

684 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

685 
¶ave
->
£tup_cou¡
--;

686 i‡(
¶ave
->
£tup_cou¡
 == 0)

687 
îr
 = 
	`¢d_pcm_hw_‰ì
(
¶ave
->
pcm
);

688 
sh¨e
->
°©e
 = 
SND_PCM_STATE_OPEN
;

689 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

690  
îr
;

691 
	}
}

693 
	$¢d_pcm_sh¨e_sw_∑øms
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_sw_∑øms_t
 *
∑øms
 ATTRIBUTE_UNUSED)

696 
	}
}

698 
	$¢d_pcm_sh¨e_°©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©us_t
 *
°©us
)

700 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

701 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

702 
îr
 = 0;

703 
¢d_pcm_s‰ames_t
 
sd
 = 0, 
d
 = 0;

704 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

705 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

706 
°©us
->
avaû
 = 
	`¢d_pcm_mm≠_∂ayback_avaû
(
pcm
);

707 i‡(
sh¨e
->
°©e
 !
SND_PCM_STATE_RUNNING
 &&

708 
sh¨e
->
°©e
 !
SND_PCM_STATE_DRAINING
)

709 
_nŸru¬ög
;

710 
d
 = 
pcm
->
buf„r_size
 - 
°©us
->
avaû
;

712 
°©us
->
avaû
 = 
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
pcm
);

713 i‡(
sh¨e
->
°©e
 !
SND_PCM_STATE_RUNNING
)

714 
_nŸru¬ög
;

715 
d
 = 
°©us
->
avaû
;

717 
îr
 = 
	`¢d_pcm_dñay
(
¶ave
->
pcm
, &
sd
);

718 i‡(
îr
 < 0)

719 
_íd
;

720 
_nŸru¬ög
:

721 
°©us
->
dñay
 = 
sd
 + 
d
;

722 
°©us
->
°©e
 = 
sh¨e
->state;

723 
°©us
->
≠∂_±r
 = *
pcm
->
≠∂
.
±r
;

724 
°©us
->
hw_±r
 = *
pcm
->
hw
.
±r
;

725 
°©us
->
åiggî_t°amp
 = 
sh¨e
->trigger_tstamp;

726 
_íd
:

727 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

728  
îr
;

729 
	}
}

731 
¢d_pcm_°©e_t
 
	$¢d_pcm_sh¨e_°©e
(
¢d_pcm_t
 *
pcm
)

733 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

734  
sh¨e
->
°©e
;

735 
	}
}

737 
	$_¢d_pcm_sh¨e_hwsync
(
¢d_pcm_t
 *
pcm
)

739 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

740 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

741 
sh¨e
->
°©e
) {

742 
SND_PCM_STATE_XRUN
:

743  -
EPIPE
;

747  
	`¢d_pcm_hwsync
(
¶ave
->
pcm
);

748 
	}
}

750 
	$¢d_pcm_sh¨e_hwsync
(
¢d_pcm_t
 *
pcm
)

752 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

753 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

754 
îr
;

755 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

756 
îr
 = 
	`_¢d_pcm_sh¨e_hwsync
(
pcm
);

757 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

758  
îr
;

759 
	}
}

761 
	$_¢d_pcm_sh¨e_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
)

763 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

764 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

765 
sh¨e
->
°©e
) {

766 
SND_PCM_STATE_XRUN
:

767  -
EPIPE
;

768 
SND_PCM_STATE_RUNNING
:

770 
SND_PCM_STATE_DRAINING
:

771 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

775  -
EBADFD
;

777  
	`¢d_pcm_dñay
(
¶ave
->
pcm
, 
dñayp
);

778 
	}
}

780 
	$¢d_pcm_sh¨e_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
)

782 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

783 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

784 
îr
;

785 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

786 
îr
 = 
	`_¢d_pcm_sh¨e_dñay
(
pcm
, 
dñayp
);

787 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

788  
îr
;

789 
	}
}

791 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_sh¨e_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

793 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

794 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

795 
¢d_pcm_s‰ames_t
 
avaû
;

796 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

797 i‡(
sh¨e
->
°©e
 =
SND_PCM_STATE_RUNNING
) {

798 
avaû
 = 
	`¢d_pcm_avaû_upd©e
(
¶ave
->
pcm
);

799 i‡(
avaû
 < 0) {

800 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

801  
avaû
;

803 
sh¨e
->
hw_±r
 = *
¶ave
->
pcm
->
hw
.
±r
;

805 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

806 
avaû
 = 
	`¢d_pcm_mm≠_avaû
(
pcm
);

807 i‡((
¢d_pcm_u‰ames_t
)
avaû
 > 
pcm
->
buf„r_size
)

808  -
EPIPE
;

809  
avaû
;

810 
	}
}

812 
	$¢d_pcm_sh¨e_htime°amp
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 *
avaû
,

813 
¢d_htime°amp_t
 *
t°amp
)

815 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

816 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

817 
îr
;

818 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

819 
îr
 = 
	`¢d_pcm_htime°amp
(
¶ave
->
pcm
, 
avaû
, 
t°amp
);

820 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

821  
îr
;

822 
	}
}

825 
¢d_pcm_s‰ames_t
 
	$_¢d_pcm_sh¨e_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

826 
¢d_pcm_u‰ames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

827 
¢d_pcm_u‰ames_t
 
size
)

829 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

830 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

831 
¢d_pcm_t
 *
•cm
 = 
¶ave
->
pcm
;

832 
¢d_pcm_s‰ames_t
 
ªt
;

833 
¢d_pcm_s‰ames_t
 
‰ames
;

834 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
 &&

835 
sh¨e
->
°©e
 =
SND_PCM_STATE_RUNNING
) {

836 
‰ames
 = *
•cm
->
≠∂
.
±r
 - 
sh¨e
->
≠∂_±r
;

837 i‡(
‰ames
 > (
¢d_pcm_s‰ames_t
)
pcm
->
buf„r_size
)

838 
‰ames
 -
pcm
->
bound¨y
;

839 i‡(
‰ames
 < -(
¢d_pcm_s‰ames_t
)
pcm
->
buf„r_size
)

840 
‰ames
 +
pcm
->
bound¨y
;

841 i‡(
‰ames
 > 0) {

843 
ªt
 = 
	`¢d_pcm_ªwöd
(
•cm
, 
‰ames
);

844 i‡(
ªt
 < 0)

845  
ªt
;

848 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
size
);

849 i‡(
sh¨e
->
°©e
 =
SND_PCM_STATE_RUNNING
) {

850 
‰ames
 = 
	`_¢d_pcm_sh¨e_¶ave_f‹w¨d
(
¶ave
);

851 i‡(
‰ames
 > 0) {

852 
¢d_pcm_s‰ames_t
 
îr
;

853 
îr
 = 
	`¢d_pcm_mm≠_commô
(
•cm
, 
	`¢d_pcm_mm≠_off£t
(•cm), 
‰ames
);

854 i‡(
îr
 < 0) {

855 
	`SYSMSG
("snd_pcm_mmap_commitÉrror");

856  
îr
;

858 i‡(
îr
 !
‰ames
) {

859 
	`SYSMSG
("commôÑëu∫†%ld f‹ sizê%ld", 
îr
, 
‰ames
);

860  
îr
;

863 
	`_¢d_pcm_sh¨e_upd©e
(
pcm
);

865  
size
;

866 
	}
}

868 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_sh¨e_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

869 
¢d_pcm_u‰ames_t
 
off£t
,

870 
¢d_pcm_u‰ames_t
 
size
)

872 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

873 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

874 
¢d_pcm_s‰ames_t
 
ªt
;

875 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

876 
ªt
 = 
	`_¢d_pcm_sh¨e_mm≠_commô
(
pcm
, 
off£t
, 
size
);

877 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

878  
ªt
;

879 
	}
}

881 
	$¢d_pcm_sh¨e_¥ï¨e
(
¢d_pcm_t
 *
pcm
)

883 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

884 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

885 
îr
 = 0;

886 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

887 
sh¨e
->
°©e
) {

888 
SND_PCM_STATE_OPEN
:

889 
îr
 = -
EBADFD
;

890 
_íd
;

891 
SND_PCM_STATE_RUNNING
:

892 
îr
 = -
EBUSY
;

893 
_íd
;

894 
SND_PCM_STATE_PREPARED
:

895 
îr
 = 0;

896 
_íd
;

900 i‡(
¶ave
->
¥ï¨ed_cou¡
 == 0) {

901 
îr
 = 
	`¢d_pcm_¥ï¨e
(
¶ave
->
pcm
);

902 i‡(
îr
 < 0)

903 
_íd
;

905 
¶ave
->
¥ï¨ed_cou¡
++;

906 
sh¨e
->
hw_±r
 = 0;

907 
sh¨e
->
≠∂_±r
 = 0;

908 
sh¨e
->
°©e
 = 
SND_PCM_STATE_PREPARED
;

909 
_íd
:

910 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

911  
îr
;

912 
	}
}

914 
	$¢d_pcm_sh¨e_ª£t
(
¢d_pcm_t
 *
pcm
)

916 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

917 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

918 
îr
 = 0;

920 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

921 
	`¢d_pcm_¨ós_sûí˚
(
pcm
->
ru¬ög_¨ós
, 0,Öcm->
ch™√ls
,Öcm->
buf„r_size
,Öcm->
f‹m©
);

922 
sh¨e
->
hw_±r
 = *
¶ave
->
pcm
->
hw
.
±r
;

923 
sh¨e
->
≠∂_±r
 = sh¨e->
hw_±r
;

924 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

925  
îr
;

926 
	}
}

928 
	$¢d_pcm_sh¨e_°¨t
(
¢d_pcm_t
 *
pcm
)

930 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

931 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

932 
¢d_pcm_t
 *
•cm
 = 
¶ave
->
pcm
;

933 
îr
 = 0;

934 i‡(
sh¨e
->
°©e
 !
SND_PCM_STATE_PREPARED
)

935  -
EBADFD
;

936 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

937 
sh¨e
->
°©e
 = 
SND_PCM_STATE_RUNNING
;

938 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

939 
¢d_pcm_u‰ames_t
 
hw_avaû
 = 
	`¢d_pcm_mm≠_∂ayback_hw_avaû
(
pcm
);

940 
¢d_pcm_u‰ames_t
 
x„r
 = 0;

941 i‡(
hw_avaû
 == 0) {

942 
îr
 = -
EPIPE
;

943 
_íd
;

945 i‡(
¶ave
->
ru¬ög_cou¡
) {

946 
¢d_pcm_s‰ames_t
 
sd
;

947 
îr
 = 
	`¢d_pcm_dñay
(
•cm
, &
sd
);

948 i‡(
îr
 < 0)

949 
_íd
;

950 
îr
 = 
	`¢d_pcm_ªwöd
(
•cm
, 
sd
);

951 i‡(
îr
 < 0)

952 
_íd
;

954 
	`as£π
(
sh¨e
->
hw_±r
 == 0);

955 
sh¨e
->
hw_±r
 = *
•cm
->
hw
.
±r
;

956 
sh¨e
->
≠∂_±r
 = *
•cm
->
≠∂
.
±r
;

957 
x„r
 < 
hw_avaû
) {

958 
¢d_pcm_u‰ames_t
 
‰ames
 = 
hw_avaû
 - 
x„r
;

959 
¢d_pcm_u‰ames_t
 
off£t
 = 
	`¢d_pcm_mm≠_off£t
(
pcm
);

960 
¢d_pcm_u‰ames_t
 
c⁄t
 = 
pcm
->
buf„r_size
 - 
off£t
;

961 i‡(
c⁄t
 < 
‰ames
)

962 
‰ames
 = 
c⁄t
;

963 i‡(
pcm
->
°›≥d_¨ós
 !
NULL
)

964 
	`¢d_pcm_¨ós_c›y
(
pcm
->
ru¬ög_¨ós
, 
off£t
,

965 
pcm
->
°›≥d_¨ós
, 
x„r
,

966 
pcm
->
ch™√ls
, 
‰ames
,

967 
pcm
->
f‹m©
);

968 
x„r
 +
‰ames
;

970 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
hw_avaû
);

971 i‡(
¶ave
->
ru¬ög_cou¡
 == 0) {

972 
¢d_pcm_s‰ames_t
 
ªs
;

973 
ªs
 = 
	`¢d_pcm_mm≠_commô
(
•cm
, 
	`¢d_pcm_mm≠_off£t
(•cm), 
hw_avaû
);

974 i‡(
ªs
 < 0) {

975 
îr
 = 
ªs
;

976 
_íd
;

978 
	`as£π
((
¢d_pcm_u‰ames_t
)
ªs
 =
hw_avaû
);

981 i‡(
¶ave
->
ru¬ög_cou¡
 == 0) {

982 
îr
 = 
	`¢d_pcm_°¨t
(
•cm
);

983 i‡(
îr
 < 0)

984 
_íd
;

986 
¶ave
->
ru¬ög_cou¡
++;

987 
	`_¢d_pcm_sh¨e_upd©e
(
pcm
);

988 
	`gëtime°amp
(&
sh¨e
->
åiggî_t°amp
, 
pcm
->
t°amp_ty≥
);

989 
_íd
:

990 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

991  
îr
;

992 
	}
}

994 
	$¢d_pcm_sh¨e_∑u£
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
íabÀ
 ATTRIBUTE_UNUSED)

996  -
ENOSYS
;

997 
	}
}

999 
	$¢d_pcm_sh¨e_ªsume
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1001  -
ENXIO
;

1002 
	}
}

1004 
	$¢d_pcm_sh¨e_ch™√l_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_öfo_t
 *
öfo
)

1006 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

1007 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

1008 
ch™√l
 = 
öfo
->channel;

1009 
c
 = 
sh¨e
->
¶ave_ch™√ls
[
ch™√l
];

1010 
îr
;

1011 
öfo
->
ch™√l
 = 
c
;

1012 
îr
 = 
	`¢d_pcm_ch™√l_öfo
(
¶ave
->
pcm
, 
öfo
);

1013 
öfo
->
ch™√l
 = channel;

1014  
îr
;

1015 
	}
}

1017 
¢d_pcm_s‰ames_t
 
	$_¢d_pcm_sh¨e_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

1019 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

1020 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

1021 
¢d_pcm_s‰ames_t
 
n
;

1022 
sh¨e
->
°©e
) {

1023 
SND_PCM_STATE_RUNNING
:

1025 
SND_PCM_STATE_PREPARED
:

1026 i‡(
pcm
->
°ªam
 !
SND_PCM_STREAM_PLAYBACK
)

1027  -
EBADFD
;

1029 
SND_PCM_STATE_DRAINING
:

1030 i‡(
pcm
->
°ªam
 !
SND_PCM_STREAM_CAPTURE
)

1031  -
EBADFD
;

1033 
SND_PCM_STATE_XRUN
:

1034  -
EPIPE
;

1036  -
EBADFD
;

1038 
n
 = 
	`¢d_pcm_mm≠_hw_avaû
(
pcm
);

1039 
	`as£π
(
n
 >= 0);

1040 i‡((
¢d_pcm_u‰ames_t
)
n
 > 
‰ames
)

1041 
‰ames
 = 
n
;

1042 i‡(
sh¨e
->
°©e
 =
SND_PCM_STATE_RUNNING
 && 
‰ames
 > 0) {

1043 
¢d_pcm_s‰ames_t
 
ªt
 = 
	`¢d_pcm_ªwöd
(
¶ave
->
pcm
, 
‰ames
);

1044 i‡(
ªt
 < 0)

1045  
ªt
;

1046 
‰ames
 = 
ªt
;

1048 
	`¢d_pcm_mm≠_≠∂_backw¨d
(
pcm
, 
‰ames
);

1049 
	`_¢d_pcm_sh¨e_upd©e
(
pcm
);

1050  
n
;

1051 
	}
}

1053 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_sh¨e_ªwödabÀ
(
¢d_pcm_t
 *
pcm
)

1055 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

1056 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

1057 
¢d_pcm_s‰ames_t
 
ªt
;

1058 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

1059 
ªt
 = 
	`¢d_pcm_ªwödabÀ
(
¶ave
->
pcm
);

1060 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

1061  
ªt
;

1062 
	}
}

1064 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_sh¨e_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

1066 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

1067 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

1068 
¢d_pcm_s‰ames_t
 
ªt
;

1069 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

1070 
ªt
 = 
	`_¢d_pcm_sh¨e_ªwöd
(
pcm
, 
‰ames
);

1071 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

1072  
ªt
;

1073 
	}
}

1075 
¢d_pcm_s‰ames_t
 
	$_¢d_pcm_sh¨e_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

1077 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

1078 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

1079 
¢d_pcm_s‰ames_t
 
n
;

1080 
sh¨e
->
°©e
) {

1081 
SND_PCM_STATE_RUNNING
:

1083 
SND_PCM_STATE_PREPARED
:

1084 i‡(
pcm
->
°ªam
 !
SND_PCM_STREAM_PLAYBACK
)

1085  -
EBADFD
;

1087 
SND_PCM_STATE_DRAINING
:

1088 i‡(
pcm
->
°ªam
 !
SND_PCM_STREAM_CAPTURE
)

1089  -
EBADFD
;

1091 
SND_PCM_STATE_XRUN
:

1092  -
EPIPE
;

1094  -
EBADFD
;

1096 
n
 = 
	`¢d_pcm_mm≠_avaû
(
pcm
);

1097 i‡((
¢d_pcm_u‰ames_t
)
n
 > 
‰ames
)

1098 
‰ames
 = 
n
;

1099 i‡(
sh¨e
->
°©e
 =
SND_PCM_STATE_RUNNING
 && 
‰ames
 > 0) {

1100 
¢d_pcm_s‰ames_t
 
ªt
 = 
	`INTERNAL
(
¢d_pcm_f‹w¨d
)(
¶ave
->
pcm
, 
‰ames
);

1101 i‡(
ªt
 < 0)

1102  
ªt
;

1103 
‰ames
 = 
ªt
;

1105 
	`¢d_pcm_mm≠_≠∂_f‹w¨d
(
pcm
, 
‰ames
);

1106 
	`_¢d_pcm_sh¨e_upd©e
(
pcm
);

1107  
n
;

1108 
	}
}

1110 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_sh¨e_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
)

1112 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

1113 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

1114 
¢d_pcm_s‰ames_t
 
ªt
;

1115 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

1116 
ªt
 = 
	`¢d_pcm_f‹w¨dabÀ
(
¶ave
->
pcm
);

1117 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

1118  
ªt
;

1119 
	}
}

1121 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_sh¨e_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

1123 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

1124 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

1125 
¢d_pcm_s‰ames_t
 
ªt
;

1126 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

1127 
ªt
 = 
	`_¢d_pcm_sh¨e_f‹w¨d
(
pcm
, 
‰ames
);

1128 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

1129  
ªt
;

1130 
	}
}

1133 
	$_¢d_pcm_sh¨e_°›
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©e_t
 
°©e
)

1135 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

1136 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

1138 i‡(!
pcm
->
mm≠_ch™√ls
) {

1143 
	`gëtime°amp
(&
sh¨e
->
åiggî_t°amp
, 
pcm
->
t°amp_ty≥
);

1144 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_CAPTURE
) {

1145 
	`¢d_pcm_¨ós_c›y
(
pcm
->
°›≥d_¨ós
, 0,

1146 
pcm
->
ru¬ög_¨ós
, 0,

1147 
pcm
->
ch™√ls
,Öcm->
buf„r_size
,

1148 
pcm
->
f‹m©
);

1149 } i‡(
¶ave
->
ru¬ög_cou¡
 > 1) {

1150 
îr
;

1151 
¢d_pcm_s‰ames_t
 
dñay
;

1152 
	`¢d_pcm_¨ós_sûí˚
(
pcm
->
ru¬ög_¨ós
, 0,Öcm->
ch™√ls
,

1153 
pcm
->
buf„r_size
,Öcm->
f‹m©
);

1154 
îr
 = 
	`¢d_pcm_dñay
(
¶ave
->
pcm
, &
dñay
);

1155 i‡(
îr
 >0 && 
dñay
 > 0)

1156 
	`¢d_pcm_ªwöd
(
¶ave
->
pcm
, 
dñay
);

1157 
sh¨e
->
døö_sûí˚d
 = 0;

1159 
sh¨e
->
°©e
 = state;

1160 
¶ave
->
¥ï¨ed_cou¡
--;

1161 
¶ave
->
ru¬ög_cou¡
--;

1162 i‡(
¶ave
->
ru¬ög_cou¡
 == 0) {

1163 
îr
 = 
	`¢d_pcm_dr›
(
¶ave
->
pcm
);

1164 
	`as£π
(
îr
 >= 0);

1166 
	}
}

1168 
	$¢d_pcm_sh¨e_døö
(
¢d_pcm_t
 *
pcm
)

1170 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

1171 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

1172 
îr
 = 0;

1173 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

1174 
sh¨e
->
°©e
) {

1175 
SND_PCM_STATE_OPEN
:

1176 
îr
 = -
EBADFD
;

1177 
_íd
;

1178 
SND_PCM_STATE_PREPARED
:

1179 
sh¨e
->
°©e
 = 
SND_PCM_STATE_SETUP
;

1180 
_íd
;

1181 
SND_PCM_STATE_SETUP
:

1182 
_íd
;

1186 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

1187 
sh¨e
->
°©e
) {

1188 
SND_PCM_STATE_XRUN
:

1189 
sh¨e
->
°©e
 = 
SND_PCM_STATE_SETUP
;

1190 
_íd
;

1191 
SND_PCM_STATE_DRAINING
:

1192 
SND_PCM_STATE_RUNNING
:

1193 
sh¨e
->
°©e
 = 
SND_PCM_STATE_DRAINING
;

1194 
	`_¢d_pcm_sh¨e_upd©e
(
pcm
);

1195 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

1196 i‡(!(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
))

1197 
	`¢d_pcm_waô
(
pcm
, 
SND_PCM_WAIT_DRAIN
);

1200 
	`as£π
(0);

1204 
sh¨e
->
°©e
) {

1205 
SND_PCM_STATE_RUNNING
:

1206 
	`_¢d_pcm_sh¨e_°›
(
pcm
, 
SND_PCM_STATE_DRAINING
);

1207 
	`_¢d_pcm_sh¨e_upd©e
(
pcm
);

1209 
SND_PCM_STATE_XRUN
:

1210 
SND_PCM_STATE_DRAINING
:

1211 i‡(
	`¢d_pcm_mm≠_ˇ±uª_avaû
(
pcm
) <= 0)

1212 
sh¨e
->
°©e
 = 
SND_PCM_STATE_SETUP
;

1214 
sh¨e
->
°©e
 = 
SND_PCM_STATE_DRAINING
;

1217 
	`as£π
(0);

1221 
_íd
:

1222 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

1223  
îr
;

1224 
	}
}

1226 
	$¢d_pcm_sh¨e_dr›
(
¢d_pcm_t
 *
pcm
)

1228 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

1229 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

1230 
îr
 = 0;

1231 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

1232 
sh¨e
->
°©e
) {

1233 
SND_PCM_STATE_OPEN
:

1234 
îr
 = -
EBADFD
;

1235 
_íd
;

1236 
SND_PCM_STATE_SETUP
:

1238 
SND_PCM_STATE_DRAINING
:

1239 i‡(
pcm
->
°ªam
 =
SND_PCM_STREAM_CAPTURE
) {

1240 
sh¨e
->
°©e
 = 
SND_PCM_STATE_SETUP
;

1244 
SND_PCM_STATE_RUNNING
:

1245 
	`_¢d_pcm_sh¨e_°›
(
pcm
, 
SND_PCM_STATE_SETUP
);

1246 
	`_¢d_pcm_sh¨e_upd©e
(
pcm
);

1248 
SND_PCM_STATE_PREPARED
:

1249 
SND_PCM_STATE_XRUN
:

1250 
sh¨e
->
°©e
 = 
SND_PCM_STATE_SETUP
;

1253 
	`as£π
(0);

1257 
sh¨e
->
≠∂_±r
 = sh¨e->
hw_±r
 = 0;

1258 
_íd
:

1259 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

1260  
îr
;

1261 
	}
}

1263 
	$¢d_pcm_sh¨e_˛o£
(
¢d_pcm_t
 *
pcm
)

1265 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

1266 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

1267 
îr
 = 0;

1269 
	`Pthªad_muãx_lock
(&
¢d_pcm_sh¨e_¶aves_muãx
);

1270 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

1271 
¶ave
->
›í_cou¡
--;

1272 i‡(
¶ave
->
›í_cou¡
 == 0) {

1273 
	`±hªad_c⁄d_sig«l
(&
¶ave
->
pﬁl_c⁄d
);

1274 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

1275 
îr
 = 
	`±hªad_joö
(
¶ave
->
thªad
, 0);

1276 
	`as£π
(
îr
 == 0);

1277 
îr
 = 
	`¢d_pcm_˛o£
(
¶ave
->
pcm
);

1278 
	`±hªad_muãx_de°roy
(&
¶ave
->
muãx
);

1279 
	`±hªad_c⁄d_de°roy
(&
¶ave
->
pﬁl_c⁄d
);

1280 
	`li°_dñ
(&
¶ave
->
li°
);

1281 
	`‰ì
(
¶ave
);

1282 
	`li°_dñ
(&
sh¨e
->
li°
);

1284 
	`li°_dñ
(&
sh¨e
->
li°
);

1285 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

1287 
	`Pthªad_muãx_u∆ock
(&
¢d_pcm_sh¨e_¶aves_muãx
);

1288 
	`˛o£
(
sh¨e
->
˛õ¡_sockë
);

1289 
	`˛o£
(
sh¨e
->
¶ave_sockë
);

1290 
	`‰ì
(
sh¨e
->
¶ave_ch™√ls
);

1291 
	`‰ì
(
sh¨e
);

1292  
îr
;

1293 
	}
}

1295 
	$¢d_pcm_sh¨e_mm≠
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1298 
	}
}

1300 
	$¢d_pcm_sh¨e_munm≠
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

1303 
	}
}

1305 
	$¢d_pcm_sh¨e_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

1307 
¢d_pcm_sh¨e_t
 *
sh¨e
 = 
pcm
->
¥iv©e_d©a
;

1308 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
sh¨e
->slave;

1309 
k
;

1310 
	`¢d_ouçut_¥ötf
(
out
, "Share PCM\n");

1311 
	`¢d_ouçut_¥ötf
(
out
, " Channel bindings:\n");

1312 
k
 = 0; k < 
sh¨e
->
ch™√ls
; ++k)

1313 
	`¢d_ouçut_¥ötf
(
out
, " %d: %d\n", 
k
, 
sh¨e
->
¶ave_ch™√ls
[k]);

1314 i‡(
pcm
->
£tup
) {

1315 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

1316 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

1318 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

1319 
	`¢d_pcm_dump
(
¶ave
->
pcm
, 
out
);

1320 
	}
}

1322 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_sh¨e_›s
 = {

1323 .
˛o£
 = 
¢d_pcm_sh¨e_˛o£
,

1324 .
	göfo
 = 
¢d_pcm_sh¨e_öfo
,

1325 .
	ghw_ªföe
 = 
¢d_pcm_sh¨e_hw_ªföe
,

1326 .
	ghw_∑øms
 = 
¢d_pcm_sh¨e_hw_∑øms
,

1327 .
	ghw_‰ì
 = 
¢d_pcm_sh¨e_hw_‰ì
,

1328 .
	gsw_∑øms
 = 
¢d_pcm_sh¨e_sw_∑øms
,

1329 .
	gch™√l_öfo
 = 
¢d_pcm_sh¨e_ch™√l_öfo
,

1330 .
	gdump
 = 
¢d_pcm_sh¨e_dump
,

1331 .
	gn⁄block
 = 
¢d_pcm_sh¨e_n⁄block
,

1332 .
	gasync
 = 
¢d_pcm_sh¨e_async
,

1333 .
	gmm≠
 = 
¢d_pcm_sh¨e_mm≠
,

1334 .
	gmunm≠
 = 
¢d_pcm_sh¨e_munm≠
,

1337 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_sh¨e_Á°_›s
 = {

1338 .
°©us
 = 
¢d_pcm_sh¨e_°©us
,

1339 .
	g°©e
 = 
¢d_pcm_sh¨e_°©e
,

1340 .
	ghwsync
 = 
¢d_pcm_sh¨e_hwsync
,

1341 .
	gdñay
 = 
¢d_pcm_sh¨e_dñay
,

1342 .
	g¥ï¨e
 = 
¢d_pcm_sh¨e_¥ï¨e
,

1343 .
	gª£t
 = 
¢d_pcm_sh¨e_ª£t
,

1344 .
	g°¨t
 = 
¢d_pcm_sh¨e_°¨t
,

1345 .
	gdr›
 = 
¢d_pcm_sh¨e_dr›
,

1346 .
	gdøö
 = 
¢d_pcm_sh¨e_døö
,

1347 .
	g∑u£
 = 
¢d_pcm_sh¨e_∑u£
,

1348 .
	gwrôei
 = 
¢d_pcm_mm≠_wrôei
,

1349 .
	gwrôí
 = 
¢d_pcm_mm≠_wrôí
,

1350 .
	gªadi
 = 
¢d_pcm_mm≠_ªadi
,

1351 .
	gªadn
 = 
¢d_pcm_mm≠_ªadn
,

1352 .
	gªwödabÀ
 = 
¢d_pcm_sh¨e_ªwödabÀ
,

1353 .
	gªwöd
 = 
¢d_pcm_sh¨e_ªwöd
,

1354 .
	gf‹w¨dabÀ
 = 
¢d_pcm_sh¨e_f‹w¨dabÀ
,

1355 .
	gf‹w¨d
 = 
¢d_pcm_sh¨e_f‹w¨d
,

1356 .
	gªsume
 = 
¢d_pcm_sh¨e_ªsume
,

1357 .
	gavaû_upd©e
 = 
¢d_pcm_sh¨e_avaû_upd©e
,

1358 .
	ghtime°amp
 = 
¢d_pcm_sh¨e_htime°amp
,

1359 .
	gmm≠_commô
 = 
¢d_pcm_sh¨e_mm≠_commô
,

1381 
	$¢d_pcm_sh¨e_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
, c⁄° *
¢ame
,

1382 
¢d_pcm_f‹m©_t
 
sf‹m©
, 
§©e
,

1383 
sch™√ls
,

1384 
•îiod_time
, 
sbuf„r_time
,

1385 
ch™√ls
, *
ch™√ls_m≠
,

1386 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

1388 
¢d_pcm_t
 *
pcm
;

1389 
¢d_pcm_sh¨e_t
 *
sh¨e
;

1390 
îr
;

1391 
li°_hód
 *
i
;

1392 
¶ave_m≠
[32] = { 0 };

1393 
k
;

1394 
¢d_pcm_sh¨e_¶ave_t
 *
¶ave
 = 
NULL
;

1395 
sd
[2];

1397 
	`as£π
(
pcmp
);

1398 
	`as£π
(
ch™√ls
 > 0 && 
¢ame
 && 
ch™√ls_m≠
);

1400 
k
 = 0; k < 
ch™√ls
; ++k) {

1401 i‡(
ch™√ls_m≠
[
k
] >(
¶ave_m≠
) / (slave_map[0])) {

1402 
	`SNDERR
("InvÆid sœvêch™√»(%dËö bödög", 
ch™√ls_m≠
[
k
]);

1403  -
EINVAL
;

1405 i‡(
¶ave_m≠
[
ch™√ls_m≠
[
k
]]) {

1406 
	`SNDERR
("Rïóãd sœvêch™√»(%dËö bödög", 
ch™√ls_m≠
[
k
]);

1407  -
EINVAL
;

1409 
¶ave_m≠
[
ch™√ls_m≠
[
k
]] = 1;

1410 
	`as£π
(()
ch™√ls_m≠
[
k
] < 
sch™√ls
);

1413 
sh¨e
 = 
	`ˇŒoc
(1, (
¢d_pcm_sh¨e_t
));

1414 i‡(!
sh¨e
)

1415  -
ENOMEM
;

1417 
sh¨e
->
ch™√ls
 = channels;

1418 
sh¨e
->
¶ave_ch™√ls
 = 
	`ˇŒoc
(
ch™√ls
, (*share->slave_channels));

1419 i‡(!
sh¨e
->
¶ave_ch™√ls
) {

1420 
	`‰ì
(
sh¨e
);

1421  -
ENOMEM
;

1423 
	`mem˝y
(
sh¨e
->
¶ave_ch™√ls
, 
ch™√ls_m≠
, 
ch™√ls
 * (*share->slave_channels));

1425 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_SHARE
, 
«me
, 
°ªam
, 
mode
);

1426 i‡(
îr
 < 0) {

1427 
	`‰ì
(
sh¨e
->
¶ave_ch™√ls
);

1428 
	`‰ì
(
sh¨e
);

1429  
îr
;

1431 
îr
 = 
	`sockë∑ú
(
AF_LOCAL
, 
SOCK_STREAM
, 0, 
sd
);

1432 i‡(
îr
 < 0) {

1433 
	`¢d_pcm_‰ì
(
pcm
);

1434 
	`‰ì
(
sh¨e
->
¶ave_ch™√ls
);

1435 
	`‰ì
(
sh¨e
);

1436  -
î∫o
;

1439 i‡(
°ªam
 =
SND_PCM_STREAM_PLAYBACK
) {

1440 
bufsize
 = 1;

1441 
îr
 = 
	`£tsock›t
(
sd
[0], 
SOL_SOCKET
, 
SO_SNDBUF
, &
bufsize
, (bufsize));

1442 i‡(
îr
 >= 0) {

1443 
pﬁlfd
 
pfd
;

1444 
pfd
.
fd
 = 
sd
[0];

1445 
pfd
.
evíts
 = 
POLLOUT
;

1446 (
îr
 = 
	`pﬁl
(&
pfd
, 1, 0)) == 1) {

1447 
buf
[1];

1448 
îr
 = 
	`wrôe
(
sd
[0], 
buf
, 1);

1449 
	`as£π
(
îr
 != 0);

1450 i‡(
îr
 != 1)

1455 i‡(
îr
 < 0) {

1456 
îr
 = -
î∫o
;

1457 
	`˛o£
(
sd
[0]);

1458 
	`˛o£
(
sd
[1]);

1459 
	`¢d_pcm_‰ì
(
pcm
);

1460 
	`‰ì
(
sh¨e
->
¶ave_ch™√ls
);

1461 
	`‰ì
(
sh¨e
);

1462  
îr
;

1465 
	`Pthªad_muãx_lock
(&
¢d_pcm_sh¨e_¶aves_muãx
);

1466 
	`li°_f‹_óch
(
i
, &
¢d_pcm_sh¨e_¶aves
) {

1467 
¢d_pcm_sh¨e_¶ave_t
 *
s
 = 
	`li°_íåy
(
i
, snd_pcm_sh¨e_¶ave_t, 
li°
);

1468 i‡(
s
->
pcm
->
«me
 && 
	`°rcmp
(s->pcm->«me, 
¢ame
) == 0) {

1469 
¶ave
 = 
s
;

1473 i‡(!
¶ave
) {

1474 
¢d_pcm_t
 *
•cm
;

1475 
îr
 = 
	`¢d_pcm_›í
(&
•cm
, 
¢ame
, 
°ªam
, 
mode
);

1476 i‡(
îr
 < 0) {

1477 
	`Pthªad_muãx_u∆ock
(&
¢d_pcm_sh¨e_¶aves_muãx
);

1478 
	`˛o£
(
sd
[0]);

1479 
	`˛o£
(
sd
[1]);

1480 
	`¢d_pcm_‰ì
(
pcm
);

1481 
	`‰ì
(
sh¨e
->
¶ave_ch™√ls
);

1482 
	`‰ì
(
sh¨e
);

1483  
îr
;

1487 
¶ave
 = 
	`ˇŒoc
(1, (
¢d_pcm_sh¨e_¶ave_t
) * 8);

1488 i‡(!
¶ave
) {

1489 
	`Pthªad_muãx_u∆ock
(&
¢d_pcm_sh¨e_¶aves_muãx
);

1490 
	`¢d_pcm_˛o£
(
•cm
);

1491 
	`˛o£
(
sd
[0]);

1492 
	`˛o£
(
sd
[1]);

1493 
	`¢d_pcm_‰ì
(
pcm
);

1494 
	`‰ì
(
sh¨e
->
¶ave_ch™√ls
);

1495 
	`‰ì
(
sh¨e
);

1496  
îr
;

1498 
	`INIT_LIST_HEAD
(&
¶ave
->
˛õ¡s
);

1499 
¶ave
->
pcm
 = 
•cm
;

1500 
¶ave
->
ch™√ls
 = 
sch™√ls
;

1501 
¶ave
->
f‹m©
 = 
sf‹m©
;

1502 
¶ave
->
øã
 = 
§©e
;

1503 
¶ave
->
≥riod_time
 = 
•îiod_time
;

1504 
¶ave
->
buf„r_time
 = 
sbuf„r_time
;

1505 
	`±hªad_muãx_öô
(&
¶ave
->
muãx
, 
NULL
);

1506 
	`±hªad_c⁄d_öô
(&
¶ave
->
pﬁl_c⁄d
, 
NULL
);

1507 
	`li°_add_èû
(&
¶ave
->
li°
, &
¢d_pcm_sh¨e_¶aves
);

1508 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

1509 
îr
 = 
	`±hªad_¸óã
(&
¶ave
->
thªad
, 
NULL
, 
¢d_pcm_sh¨e_thªad
, slave);

1510 
	`as£π
(
îr
 == 0);

1511 
	`Pthªad_muãx_u∆ock
(&
¢d_pcm_sh¨e_¶aves_muãx
);

1513 
	`Pthªad_muãx_lock
(&
¶ave
->
muãx
);

1514 
	`Pthªad_muãx_u∆ock
(&
¢d_pcm_sh¨e_¶aves_muãx
);

1515 
	`li°_f‹_óch
(
i
, &
¶ave
->
˛õ¡s
) {

1516 
¢d_pcm_sh¨e_t
 *
sh
 = 
	`li°_íåy
(
i
, snd_pcm_sh¨e_t, 
li°
);

1517 
k
 = 0; k < 
sh
->
ch™√ls
; ++k) {

1518 i‡(
¶ave_m≠
[
sh
->
¶ave_ch™√ls
[
k
]]) {

1519 
	`SNDERR
("Sœvêch™√»%d i†Æªady i¿u£", 
sh
->
¶ave_ch™√ls
[
k
]);

1520 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

1521 
	`˛o£
(
sd
[0]);

1522 
	`˛o£
(
sd
[1]);

1523 
	`¢d_pcm_‰ì
(
pcm
);

1524 
	`‰ì
(
sh¨e
->
¶ave_ch™√ls
);

1525 
	`‰ì
(
sh¨e
);

1526  -
EBUSY
;

1532 
sh¨e
->
¶ave
 = slave;

1533 
sh¨e
->
pcm
 =Öcm;

1534 
sh¨e
->
˛õ¡_sockë
 = 
sd
[0];

1535 
sh¨e
->
¶ave_sockë
 = 
sd
[1];

1537 
pcm
->
mm≠_rw
 = 1;

1538 
pcm
->
›s
 = &
¢d_pcm_sh¨e_›s
;

1539 
pcm
->
Á°_›s
 = &
¢d_pcm_sh¨e_Á°_›s
;

1540 
pcm
->
¥iv©e_d©a
 = 
sh¨e
;

1541 
pcm
->
pﬁl_fd
 = 
sh¨e
->
˛õ¡_sockë
;

1542 
pcm
->
pﬁl_evíts
 = 
°ªam
 =
SND_PCM_STREAM_PLAYBACK
 ? 
POLLOUT
 : 
POLLIN
;

1543 
pcm
->
t°amp_ty≥
 = 
¶ave
->pcm->tstamp_type;

1544 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
sh¨e
->
hw_±r
, -1, 0);

1545 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
sh¨e
->
≠∂_±r
, -1, 0);

1547 
¶ave
->
›í_cou¡
++;

1548 
	`li°_add_èû
(&
sh¨e
->
li°
, &
¶ave
->
˛õ¡s
);

1550 
	`Pthªad_muãx_u∆ock
(&
¶ave
->
muãx
);

1552 *
pcmp
 = 
pcm
;

1554 
	}
}

1611 
	$_¢d_pcm_sh¨e_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1612 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

1613 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

1615 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1616 c⁄° *
¢ame
 = 
NULL
;

1617 
¢d_c⁄fig_t
 *
bödögs
 = 
NULL
;

1618 
îr
;

1619 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

1620 *
ch™√ls_m≠
 = 
NULL
;

1621 
ch™√ls
 = 0;

1622 
¢d_pcm_f‹m©_t
 
sf‹m©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1623 
sch™√ls
 = -1;

1624 
§©e
 = -1;

1625 
•îiod_time
-1, 
sbuf„r_time
 = -1;

1626 
sch™√l_max
 = 0;

1628 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1629 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1630 c⁄° *
id
;

1631 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1633 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

1635 i‡(
	`°rcmp
(
id
, "slave") == 0) {

1636 
¶ave
 = 
n
;

1639 i‡(
	`°rcmp
(
id
, "bindings") == 0) {

1640 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1641 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

1642  -
EINVAL
;

1644 
bödögs
 = 
n
;

1647 
	`SNDERR
("Unknow¿fõld %s", 
id
);

1648  -
EINVAL
;

1650 i‡(!
¶ave
) {

1651 
	`SNDERR
("slave isÇot defined");

1652  -
EINVAL
;

1654 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 5,

1655 
SND_PCM_HW_PARAM_FORMAT
, 0, &
sf‹m©
,

1656 
SND_PCM_HW_PARAM_CHANNELS
, 0, &
sch™√ls
,

1657 
SND_PCM_HW_PARAM_RATE
, 0, &
§©e
,

1658 
SND_PCM_HW_PARAM_PERIOD_TIME
, 0, &
•îiod_time
,

1659 
SND_PCM_HW_PARAM_BUFFER_TIME
, 0, &
sbuf„r_time
);

1660 i‡(
îr
 < 0)

1661  
îr
;

1664 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
sc⁄f
, &
¢ame
);

1665 
¢ame
 = 
îr
 >0 && s«mê? 
	`°rdup
(¢ameË: 
NULL
;

1666 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1667 i‡(
¢ame
 =
NULL
) {

1668 
	`SNDERR
("slave.pcm isÇotá string");

1669  
îr
;

1672 i‡(!
bödögs
) {

1673 
	`SNDERR
("bindings isÇot defined");

1674 
îr
 = -
EINVAL
;

1675 
_‰ì
;

1677 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
bödögs
) {

1678 
cch™√l
 = -1;

1679 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1680 c⁄° *
id
;

1681 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1683 
îr
 = 
	`ß„_°πﬁ
(
id
, &
cch™√l
);

1684 i‡(
îr
 < 0 || 
cch™√l
 < 0) {

1685 
	`SNDERR
("InvÆid clõ¡ ch™√»ö bödög: %s", 
id
);

1686 
îr
 = -
EINVAL
;

1687 
_‰ì
;

1689 i‡(()
cch™√l
 >
ch™√ls
)

1690 
ch™√ls
 = 
cch™√l
 + 1;

1692 i‡(
ch™√ls
 == 0) {

1693 
	`SNDERR
("No bindings defined");

1694 
îr
 = -
EINVAL
;

1695 
_‰ì
;

1697 
ch™√ls_m≠
 = 
	`ˇŒoc
(
ch™√ls
, (*channels_map));

1698 i‡(! 
ch™√ls_m≠
) {

1699 
îr
 = -
ENOMEM
;

1700 
_‰ì
;

1703 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
bödögs
) {

1704 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1705 c⁄° *
id
;

1706 
cch™√l
;

1707 
sch™√l
 = -1;

1708 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1710 
cch™√l
 = 
	`©oi
(
id
);

1711 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
sch™√l
);

1712 i‡(
îr
 < 0) {

1713 
_‰ì
;

1715 
	`as£π
(
sch™√l
 >= 0);

1716 
	`as£π
(
sch™√ls
 <0 || 
sch™√l
 < schannels);

1717 
ch™√ls_m≠
[
cch™√l
] = 
sch™√l
;

1718 i‡(()
sch™√l
 > 
sch™√l_max
)

1719 
sch™√l_max
 = 
sch™√l
;

1721 i‡(
sch™√ls
 <= 0)

1722 
sch™√ls
 = 
sch™√l_max
 + 1;

1723 
îr
 = 
	`¢d_pcm_sh¨e_›í
(
pcmp
, 
«me
, 
¢ame
, 
sf‹m©
, 
§©e
,

1724 (Ë
sch™√ls
,

1725 
•îiod_time
, 
sbuf„r_time
,

1726 
ch™√ls
, 
ch™√ls_m≠
, 
°ªam
, 
mode
);

1727 
_‰ì
:

1728 
	`‰ì
(
ch™√ls_m≠
);

1729 
	`‰ì
((*)
¢ame
);

1730  
îr
;

1731 
	}
}

1732 #i‚de‡
DOC_HIDDEN


1733 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_sh¨e_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_shm.c

29 
	~"pcm_loˇl.h
"

30 
	~<°dio.h
>

31 
	~<°dlib.h
>

32 
	~<°ddef.h
>

33 
	~<limôs.h
>

34 
	~<uni°d.h
>

35 
	~<°rög.h
>

36 
	~<f˙é.h
>

37 
	~<sys/io˘l.h
>

38 
	~<sys/shm.h
>

39 
	~<sys/sockë.h
>

40 
	~<pﬁl.h
>

41 
	~<sys/un.h
>

42 
	~<sys/mm™.h
>

43 
	~<√töë/ö.h
>

44 
	~<¨∑/öë.h
>

45 
	~<√t/if.h
>

46 
	~<√tdb.h
>

47 
	~"a£rvî.h
"

49 #i‚de‡
PIC


51 c⁄° *
	g_¢d_moduÀ_pcm_shm
 = "";

54 #i‚de‡
DOC_HIDDEN


56 
	msockë
;

57 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
	m˘æ
;

58 } 
	t¢d_pcm_shm_t
;

61 
	$¢d_pcm_shm_a˘i⁄_fd0
(
¢d_pcm_t
 *
pcm
, *
fd
)

63 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

64 
îr
;

65 
buf
[1] = "";

66 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

68 
îr
 = 
	`wrôe
(
shm
->
sockë
, 
buf
, 1);

69 i‡(
îr
 != 1)

70  -
EBADFD
;

71 
îr
 = 
	`¢d_ª˚ive_fd
(
shm
->
sockë
, 
buf
, 1, 
fd
);

72 i‡(
îr
 != 1)

73  -
EBADFD
;

74 i‡(
˘æ
->
cmd
) {

75 
	`SNDERR
("Server hasÇot doneÅhe cmd");

76  -
EBADFD
;

78  
˘æ
->
ªsu…
;

79 
	}
}

81 
	$¢d_pcm_shm_√w_rb±r
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_shm_t
 *
shm
,

82 
¢d_pcm_rb±r_t
 *
rb±r
, vﬁ©ûê
¢d_pcm_shm_rb±r_t
 *
shm_rb±r
)

84 i‡(!
shm_rb±r
->
u£_mm≠
) {

85 i‡(&
pcm
->
hw
 =
rb±r
)

86 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
shm_rb±r
->
±r
, -1, 0);

88 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
shm_rb±r
->
±r
, -1, 0);

90 *
±r
;

91 
size_t
 
mm≠_size
, 
mm≠_off£t
, 
off£t
;

92 
fd
;

93 
ªsu…
;

95 
shm
->
˘æ
->
cmd
 = &
pcm
->
hw
 =
rb±r
 ? 
SND_PCM_IOCTL_HW_PTR_FD
 : 
SND_PCM_IOCTL_APPL_PTR_FD
;

96 
ªsu…
 = 
	`¢d_pcm_shm_a˘i⁄_fd0
(
pcm
, &
fd
);

97 i‡(
ªsu…
 < 0)

98  
ªsu…
;

99 
mm≠_size
 = 
	`∑ge_±r
(
shm_rb±r
->
off£t
, (
¢d_pcm_u‰ames_t
), &off£t, &
mm≠_off£t
);

100 
±r
 = 
	`mm≠
(
NULL
, 
mm≠_size
, 
PROT_READ
|
PROT_WRITE
, 
MAP_FILE
|
MAP_SHARED
, 
fd
, 
mm≠_off£t
);

101 i‡(
±r
 =
MAP_FAILED
 ||Öå =
NULL
) {

102 
	`SYSERR
("shmÑbptr mmap failed");

103  -
î∫o
;

105 i‡(&
pcm
->
hw
 =
rb±r
)

106 
	`¢d_pcm_£t_hw_±r
(
pcm
, (
¢d_pcm_u‰ames_t
 *)((*)
±r
 + 
off£t
), 
fd
, 
shm_rb±r
->offset);

108 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, (
¢d_pcm_u‰ames_t
 *)((*)
±r
 + 
off£t
), 
fd
, 
shm_rb±r
->offset);

111 
	}
}

113 
	$¢d_pcm_shm_a˘i⁄
(
¢d_pcm_t
 *
pcm
)

115 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

116 
îr
, 
ªsu…
;

117 
buf
[1] = "";

118 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

120 i‡(
˘æ
->
hw
.
ch™ged
 || cål->
≠∂
.changed)

121  -
EBADFD
;

122 
îr
 = 
	`wrôe
(
shm
->
sockë
, 
buf
, 1);

123 i‡(
îr
 != 1)

124  -
EBADFD
;

125 
îr
 = 
	`ªad
(
shm
->
sockë
, 
buf
, 1);

126 i‡(
îr
 != 1)

127  -
EBADFD
;

128 i‡(
˘æ
->
cmd
) {

129 
	`SNDERR
("Server hasÇot doneÅhe cmd");

130  -
EBADFD
;

132 
ªsu…
 = 
˘æ
->result;

133 i‡(
˘æ
->
hw
.
ch™ged
) {

134 
îr
 = 
	`¢d_pcm_shm_√w_rb±r
(
pcm
, 
shm
, &pcm->
hw
, &
˘æ
->hw);

135 i‡(
îr
 < 0)

136  
îr
;

137 
˘æ
->
hw
.
ch™ged
 = 0;

139 i‡(
˘æ
->
≠∂
.
ch™ged
) {

140 
îr
 = 
	`¢d_pcm_shm_√w_rb±r
(
pcm
, 
shm
, &pcm->
≠∂
, &
˘æ
->appl);

141 i‡(
îr
 < 0)

142  
îr
;

143 
˘æ
->
≠∂
.
ch™ged
 = 0;

145  
ªsu…
;

146 
	}
}

148 
	$¢d_pcm_shm_a˘i⁄_fd
(
¢d_pcm_t
 *
pcm
, *
fd
)

150 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

151 
îr
;

152 
buf
[1] = "";

153 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

155 i‡(
˘æ
->
hw
.
ch™ged
 || cål->
≠∂
.changed)

156  -
EBADFD
;

157 
îr
 = 
	`wrôe
(
shm
->
sockë
, 
buf
, 1);

158 i‡(
îr
 != 1)

159  -
EBADFD
;

160 
îr
 = 
	`¢d_ª˚ive_fd
(
shm
->
sockë
, 
buf
, 1, 
fd
);

161 i‡(
îr
 != 1)

162  -
EBADFD
;

163 i‡(
˘æ
->
cmd
) {

164 
	`SNDERR
("Server hasÇot doneÅhe cmd");

165  -
EBADFD
;

167 i‡(
˘æ
->
hw
.
ch™ged
) {

168 
îr
 = 
	`¢d_pcm_shm_√w_rb±r
(
pcm
, 
shm
, &pcm->
hw
, &
˘æ
->hw);

169 i‡(
îr
 < 0)

170  
îr
;

171 
˘æ
->
hw
.
ch™ged
 = 0;

173 i‡(
˘æ
->
≠∂
.
ch™ged
) {

174 
îr
 = 
	`¢d_pcm_shm_√w_rb±r
(
pcm
, 
shm
, &pcm->
≠∂
, &
˘æ
->appl);

175 i‡(
îr
 < 0)

176  
îr
;

177 
˘æ
->
≠∂
.
ch™ged
 = 0;

179  
˘æ
->
ªsu…
;

180 
	}
}

182 
	$¢d_pcm_shm_n⁄block
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
n⁄block
 ATTRIBUTE_UNUSED)

185 
	}
}

187 
	$¢d_pcm_shm_async
(
¢d_pcm_t
 *
pcm
, 
sig
, 
pid_t
 
pid
)

189 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

190 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

191 
˘æ
->
cmd
 = 
SND_PCM_IOCTL_ASYNC
;

192 
˘æ
->
u
.
async
.
sig
 = sig;

193 
˘æ
->
u
.
async
.
pid
 =Öid;

194  
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

195 
	}
}

197 
	$¢d_pcm_shm_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_öfo_t
 * 
öfo
)

199 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

200 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

201 
îr
;

203 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_INFO
;

204 
îr
 = 
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

205 i‡(
îr
 < 0)

206  
îr
;

207 *
öfo
 = 
˘æ
->
u
.info;

208  
îr
;

209 
	}
}

211 
	$¢d_pcm_shm_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
 ATTRIBUTE_UNUSED)

214 
	}
}

216 
	$¢d_pcm_shm_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

218 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

219 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

220 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

221 &
ßc˚ss_mask
);

223 
	}
}

225 
	$¢d_pcm_shm_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

226 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

228 
îr
;

229 
löks
 = ~
SND_PCM_HW_PARBIT_ACCESS
;

230 c⁄° 
¢d_pcm_ac˚ss_mask_t
 *
ac˚ss_mask
 = 
	`¢d_pcm_hw_∑øm_gë_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
);

231 i‡(!
	`¢d_pcm_ac˚ss_mask_ã°
(
ac˚ss_mask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
) &&

232 !
	`¢d_pcm_ac˚ss_mask_ã°
(
ac˚ss_mask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
)) {

233 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

234 
ac˚ss_mask
);

235 i‡(
îr
 < 0)

236  
îr
;

238 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

239 i‡(
îr
 < 0)

240  
îr
;

242 
	}
}

244 
	$¢d_pcm_shm_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

245 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

247 
îr
;

248 
löks
 = ~
SND_PCM_HW_PARBIT_ACCESS
;

249 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
;

250 
	`¢d_mask_c›y
(&
ac˚ss_mask
, 
	`¢d_pcm_hw_∑øm_gë_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
));

251 
	`¢d_pcm_ac˚ss_mask_£t
(&
ac˚ss_mask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
);

252 
	`¢d_pcm_ac˚ss_mask_£t
(&
ac˚ss_mask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
);

253 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

254 &
ac˚ss_mask
);

255 i‡(
îr
 < 0)

256  
îr
;

257 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

258 i‡(
îr
 < 0)

259  
îr
;

261 
	}
}

263 
	$¢d_pcm_shm_hw_ªföe_¶ave
(
¢d_pcm_t
 *
pcm
,

264 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

266 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

267 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

268 
îr
;

269 
˘æ
->
u
.
hw_ªföe
 = *
∑øms
;

270 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_HW_REFINE
;

271 
îr
 = 
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

272 *
∑øms
 = 
˘æ
->
u
.
hw_ªföe
;

273  
îr
;

274 
	}
}

276 
	$¢d_pcm_shm_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

278  
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

279 
¢d_pcm_shm_hw_ªföe_˝ª∑ª
,

280 
¢d_pcm_shm_hw_ªföe_cch™ge
,

281 
¢d_pcm_shm_hw_ªföe_•ª∑ª
,

282 
¢d_pcm_shm_hw_ªföe_sch™ge
,

283 
¢d_pcm_shm_hw_ªföe_¶ave
);

284 
	}
}

286 
	$¢d_pcm_shm_hw_∑øms_¶ave
(
¢d_pcm_t
 *
pcm
,

287 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

289 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

290 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

291 
îr
;

292 
∑øms
->
Êags
 |
SND_PCM_HW_PARAMS_EXPORT_BUFFER
;

293 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_HW_PARAMS
;

294 
˘æ
->
u
.
hw_∑øms
 = *
∑øms
;

295 
îr
 = 
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

296 *
∑øms
 = 
˘æ
->
u
.
hw_∑øms
;

297  
îr
;

298 
	}
}

300 
	$¢d_pcm_shm_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 * 
∑øms
)

302  
	`¢d_pcm_hw_∑øms_¶ave
(
pcm
, 
∑øms
,

303 
¢d_pcm_shm_hw_ªföe_cch™ge
,

304 
¢d_pcm_shm_hw_ªföe_•ª∑ª
,

305 
¢d_pcm_shm_hw_ªföe_sch™ge
,

306 
¢d_pcm_shm_hw_∑øms_¶ave
);

307 
	}
}

309 
	$¢d_pcm_shm_hw_‰ì
(
¢d_pcm_t
 *
pcm
)

311 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

312 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

313 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_HW_FREE
;

314  
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

315 
	}
}

317 
	$¢d_pcm_shm_sw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_sw_∑øms_t
 * 
∑øms
)

319 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

320 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

321 
îr
;

322 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_SW_PARAMS
;

323 
˘æ
->
u
.
sw_∑øms
 = *
∑øms
;

324 
îr
 = 
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

325 *
∑øms
 = 
˘æ
->
u
.
sw_∑øms
;

326 i‡(
îr
 < 0)

327  
îr
;

328  
îr
;

329 
	}
}

331 
	$¢d_pcm_shm_mm≠
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

334 
	}
}

336 
	$¢d_pcm_shm_munm≠
(
¢d_pcm_t
 *
pcm
)

338 
c
;

339 
c
 = 0; c < 
pcm
->
ch™√ls
; ++c) {

340 
¢d_pcm_ch™√l_öfo_t
 *
i
 = &
pcm
->
mm≠_ch™√ls
[
c
];

341 
c1
;

342 
îr
;

343 i‡(
i
->
ty≥
 !
SND_PCM_AREA_MMAP
)

345 i‡(
i
->
u
.
mm≠
.
fd
 < 0)

347 
c1
 = 
c
 + 1; c1 < 
pcm
->
ch™√ls
; ++c1) {

348 
¢d_pcm_ch™√l_öfo_t
 *
i1
 = &
pcm
->
mm≠_ch™√ls
[
c1
];

349 i‡(
i1
->
ty≥
 !
SND_PCM_AREA_MMAP
)

351 i‡(
i1
->
u
.
mm≠
.
fd
 !
i
->u.mmap.fd)

353 
i1
->
u
.
mm≠
.
fd
 = -1;

355 
îr
 = 
	`˛o£
(
i
->
u
.
mm≠
.
fd
);

356 i‡(
îr
 < 0) {

357 
	`SYSERR
("close failed");

358  -
î∫o
;

362 
	}
}

364 
	$¢d_pcm_shm_ch™√l_öfo
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_ch™√l_öfo_t
 * 
öfo
)

366 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

367 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

368 
îr
;

369 
fd
;

370 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_CHANNEL_INFO
;

371 
˘æ
->
u
.
ch™√l_öfo
 = *
öfo
;

372 
îr
 = 
	`¢d_pcm_shm_a˘i⁄_fd
(
pcm
, &
fd
);

373 i‡(
îr
 < 0)

374  
îr
;

375 *
öfo
 = 
˘æ
->
u
.
ch™√l_öfo
;

376 
öfo
->
addr
 = 0;

377 
öfo
->
ty≥
) {

378 
SND_PCM_AREA_MMAP
:

379 
öfo
->
u
.
mm≠
.
fd
 = fd;

381 
SND_PCM_AREA_SHM
:

384 
	`as£π
(0);

387  
îr
;

388 
	}
}

390 
	$¢d_pcm_shm_°©us
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_°©us_t
 * 
°©us
)

392 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

393 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

394 
îr
;

395 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_STATUS
;

397 
îr
 = 
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

398 i‡(
îr
 < 0)

399  
îr
;

400 *
°©us
 = 
˘æ
->
u
.status;

401  
îr
;

402 
	}
}

404 
¢d_pcm_°©e_t
 
	$¢d_pcm_shm_°©e
(
¢d_pcm_t
 *
pcm
)

406 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

407 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

408 
˘æ
->
cmd
 = 
SND_PCM_IOCTL_STATE
;

409  
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

410 
	}
}

412 
	$¢d_pcm_shm_hwsync
(
¢d_pcm_t
 *
pcm
)

414 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

415 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

416 
˘æ
->
cmd
 = 
SND_PCM_IOCTL_HWSYNC
;

417  
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

418 
	}
}

420 
	$¢d_pcm_shm_dñay
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_s‰ames_t
 *
dñayp
)

422 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

423 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

424 
îr
;

425 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_DELAY
;

426 
îr
 = 
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

427 i‡(
îr
 < 0)

428  
îr
;

429 *
dñayp
 = 
˘æ
->
u
.
dñay
.
‰ames
;

430  
îr
;

431 
	}
}

433 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_shm_avaû_upd©e
(
¢d_pcm_t
 *
pcm
)

435 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

436 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

437 
îr
;

438 
˘æ
->
cmd
 = 
SND_PCM_IOCTL_AVAIL_UPDATE
;

439 
îr
 = 
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

440 i‡(
îr
 < 0)

441  
îr
;

442  
îr
;

443 
	}
}

445 
	$¢d_pcm_shm_htime°amp
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
,

446 
¢d_pcm_u‰ames_t
 *
avaû
 
ATTRIBUTE_UNUSED
,

447 
¢d_htime°amp_t
 *
t°amp
 
ATTRIBUTE_UNUSED
)

449  -
EIO
;

450 
	}
}

452 
	$¢d_pcm_shm_¥ï¨e
(
¢d_pcm_t
 *
pcm
)

454 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

455 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

456 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_PREPARE
;

457  
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

458 
	}
}

460 
	$¢d_pcm_shm_ª£t
(
¢d_pcm_t
 *
pcm
)

462 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

463 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

464 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_RESET
;

465  
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

466 
	}
}

468 
	$¢d_pcm_shm_°¨t
(
¢d_pcm_t
 *
pcm
)

470 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

471 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

472 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_START
;

473  
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

474 
	}
}

476 
	$¢d_pcm_shm_dr›
(
¢d_pcm_t
 *
pcm
)

478 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

479 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

480 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_DROP
;

481  
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

482 
	}
}

484 
	$¢d_pcm_shm_døö
(
¢d_pcm_t
 *
pcm
)

486 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

487 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

488 
îr
;

490 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_DRAIN
;

491 
îr
 = 
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

492 i‡(
îr
 !-
EAGAIN
)

494 
	`u¶ìp
(10000);

496 i‡(
îr
 < 0)

497  
îr
;

498 i‡(!(
pcm
->
mode
 & 
SND_PCM_NONBLOCK
))

499 
	`¢d_pcm_waô
(
pcm
, 
SND_PCM_WAIT_DRAIN
);

500  
îr
;

501 
	}
}

503 
	$¢d_pcm_shm_∑u£
(
¢d_pcm_t
 *
pcm
, 
íabÀ
)

505 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

506 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

507 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_PAUSE
;

508 
˘æ
->
u
.
∑u£
.
íabÀ
 =Énable;

509  
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

510 
	}
}

512 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_shm_ªwödabÀ
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

515 
	}
}

517 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_shm_ªwöd
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

519 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

520 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

521 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_REWIND
;

522 
˘æ
->
u
.
ªwöd
.
‰ames
 = frames;

523  
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

524 
	}
}

526 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_shm_f‹w¨dabÀ
(
¢d_pcm_t
 *
pcm
 
ATTRIBUTE_UNUSED
)

529 
	}
}

531 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_shm_f‹w¨d
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_u‰ames_t
 
‰ames
)

533 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

534 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

535 
˘æ
->
cmd
 = 
SND_PCM_IOCTL_FORWARD
;

536 
˘æ
->
u
.
f‹w¨d
.
‰ames
 = frames;

537  
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

538 
	}
}

540 
	$¢d_pcm_shm_ªsume
(
¢d_pcm_t
 *
pcm
)

542 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

543 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

544 
˘æ
->
cmd
 = 
SNDRV_PCM_IOCTL_RESUME
;

545  
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

546 
	}
}

548 
¢d_pcm_s‰ames_t
 
	$¢d_pcm_shm_mm≠_commô
(
¢d_pcm_t
 *
pcm
,

549 
¢d_pcm_u‰ames_t
 
off£t
 
ATTRIBUTE_UNUSED
,

550 
¢d_pcm_u‰ames_t
 
size
)

552 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

553 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

554 
˘æ
->
cmd
 = 
SND_PCM_IOCTL_MMAP_COMMIT
;

555 
˘æ
->
u
.
mm≠_commô
.
off£t
 = offset;

556 
˘æ
->
u
.
mm≠_commô
.
‰ames
 = 
size
;

557  
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

558 
	}
}

560 
	$¢d_pcm_shm_pﬁl_des¸ùt‹
(
¢d_pcm_t
 *
pcm
)

562 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

563 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

564 
fd
, 
îr
;

565 
˘æ
->
cmd
 = 
SND_PCM_IOCTL_POLL_DESCRIPTOR
;

566 
îr
 = 
	`¢d_pcm_shm_a˘i⁄_fd
(
pcm
, &
fd
);

567 i‡(
îr
 < 0)

568  
îr
;

569  
fd
;

570 
	}
}

572 
	$¢d_pcm_shm_˛o£
(
¢d_pcm_t
 *
pcm
)

574 
¢d_pcm_shm_t
 *
shm
 = 
pcm
->
¥iv©e_d©a
;

575 vﬁ©ûê
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
shm
->ctrl;

576 
ªsu…
;

577 
˘æ
->
cmd
 = 
SND_PCM_IOCTL_CLOSE
;

578 
ªsu…
 = 
	`¢d_pcm_shm_a˘i⁄
(
pcm
);

579 
	`shmdt
((*)
˘æ
);

580 
	`˛o£
(
shm
->
sockë
);

581 
	`˛o£
(
pcm
->
pﬁl_fd
);

582 
	`‰ì
(
shm
);

583  
ªsu…
;

584 
	}
}

586 
	$¢d_pcm_shm_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

588 
	`¢d_ouçut_¥ötf
(
out
, "Shm PCM\n");

589 i‡(
pcm
->
£tup
) {

590 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

591 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

593 
	}
}

595 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_shm_›s
 = {

596 .
˛o£
 = 
¢d_pcm_shm_˛o£
,

597 .
	göfo
 = 
¢d_pcm_shm_öfo
,

598 .
	ghw_ªföe
 = 
¢d_pcm_shm_hw_ªföe
,

599 .
	ghw_∑øms
 = 
¢d_pcm_shm_hw_∑øms
,

600 .
	ghw_‰ì
 = 
¢d_pcm_shm_hw_‰ì
,

601 .
	gsw_∑øms
 = 
¢d_pcm_shm_sw_∑øms
,

602 .
	gch™√l_öfo
 = 
¢d_pcm_shm_ch™√l_öfo
,

603 .
	gdump
 = 
¢d_pcm_shm_dump
,

604 .
	gn⁄block
 = 
¢d_pcm_shm_n⁄block
,

605 .
	gasync
 = 
¢d_pcm_shm_async
,

606 .
	gmm≠
 = 
¢d_pcm_shm_mm≠
,

607 .
	gmunm≠
 = 
¢d_pcm_shm_munm≠
,

610 c⁄° 
¢d_pcm_Á°_›s_t
 
	g¢d_pcm_shm_Á°_›s
 = {

611 .
°©us
 = 
¢d_pcm_shm_°©us
,

612 .
	g°©e
 = 
¢d_pcm_shm_°©e
,

613 .
	ghwsync
 = 
¢d_pcm_shm_hwsync
,

614 .
	gdñay
 = 
¢d_pcm_shm_dñay
,

615 .
	g¥ï¨e
 = 
¢d_pcm_shm_¥ï¨e
,

616 .
	gª£t
 = 
¢d_pcm_shm_ª£t
,

617 .
	g°¨t
 = 
¢d_pcm_shm_°¨t
,

618 .
	gdr›
 = 
¢d_pcm_shm_dr›
,

619 .
	gdøö
 = 
¢d_pcm_shm_døö
,

620 .
	g∑u£
 = 
¢d_pcm_shm_∑u£
,

621 .
	gªwödabÀ
 = 
¢d_pcm_shm_ªwödabÀ
,

622 .
	gªwöd
 = 
¢d_pcm_shm_ªwöd
,

623 .
	gf‹w¨dabÀ
 = 
¢d_pcm_shm_f‹w¨dabÀ
,

624 .
	gf‹w¨d
 = 
¢d_pcm_shm_f‹w¨d
,

625 .
	gªsume
 = 
¢d_pcm_shm_ªsume
,

626 .
	gwrôei
 = 
¢d_pcm_mm≠_wrôei
,

627 .
	gwrôí
 = 
¢d_pcm_mm≠_wrôí
,

628 .
	gªadi
 = 
¢d_pcm_mm≠_ªadi
,

629 .
	gªadn
 = 
¢d_pcm_mm≠_ªadn
,

630 .
	gavaû_upd©e
 = 
¢d_pcm_shm_avaû_upd©e
,

631 .
	gmm≠_commô
 = 
¢d_pcm_shm_mm≠_commô
,

632 .
	ghtime°amp
 = 
¢d_pcm_shm_htime°amp
,

635 
	$make_loˇl_sockë
(c⁄° *
fûíame
)

637 
size_t
 
l
 = 
	`°æí
(
fûíame
);

638 
size_t
 
size
 = 
	`off£tof
(
sockaddr_un
, 
sun_∑th
Ë+ 
l
;

639 
sockaddr_un
 *
addr
 = 
	`Æloˇ
(
size
);

640 
sock
;

642 
sock
 = 
	`sockë
(
PF_LOCAL
, 
SOCK_STREAM
, 0);

643 i‡(
sock
 < 0) {

644 
	`SYSERR
("socket failed");

645  -
î∫o
;

648 
addr
->
sun_Ámûy
 = 
AF_LOCAL
;

649 
	`mem˝y
(
addr
->
sun_∑th
, 
fûíame
, 
l
);

651 i‡(
	`c⁄√˘
(
sock
, (
sockaddr
 *Ë
addr
, 
size
) < 0) {

652 
	`SYSERR
("connect failed");

653  -
î∫o
;

655  
sock
;

656 
	}
}

671 
	$¢d_pcm_shm_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

672 c⁄° *
sock«me
, c⁄° *
¢ame
,

673 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

675 
¢d_pcm_t
 *
pcm
;

676 
¢d_pcm_shm_t
 *
shm
 = 
NULL
;

677 
¢d_˛õ¡_›í_ªque°_t
 *
ªq
;

678 
¢d_˛õ¡_›í_™swî_t
 
™s
;

679 
size_t
 
¢amñí
, 
ªqÀn
;

680 
îr
;

681 
ªsu…
;

682 
¢d_pcm_shm_˘æ_t
 *
˘æ
 = 
NULL
;

683 
sock
 = -1;

684 
¢amñí
 = 
	`°æí
(
¢ame
);

685 i‡(
¢amñí
 > 255)

686  -
EINVAL
;

688 
ªsu…
 = 
	`make_loˇl_sockë
(
sock«me
);

689 i‡(
ªsu…
 < 0) {

690 
	`SNDERR
("£rvî f‹ sockë %†i†nŸÑu¬ög", 
sock«me
);

691 
_îr
;

693 
sock
 = 
ªsu…
;

695 
ªqÀn
 = (*
ªq
Ë+ 
¢amñí
;

696 
ªq
 = 
	`Æloˇ
(
ªqÀn
);

697 
	`mem˝y
(
ªq
->
«me
, 
¢ame
, 
¢amñí
);

698 
ªq
->
dev_ty≥
 = 
SND_DEV_TYPE_PCM
;

699 
ªq
->
å™•‹t_ty≥
 = 
SND_TRANSPORT_TYPE_SHM
;

700 
ªq
->
°ªam
 = stream;

701 
ªq
->
mode
 = mode;

702 
ªq
->
«mñí
 = 
¢amñí
;

703 
îr
 = 
	`wrôe
(
sock
, 
ªq
, 
ªqÀn
);

704 i‡(
îr
 < 0) {

705 
	`SYSERR
("writeÉrror");

706 
ªsu…
 = -
î∫o
;

707 
_îr
;

709 i‡((
size_t
Ë
îr
 !
ªqÀn
) {

710 
	`SNDERR
("write sizeÉrror");

711 
ªsu…
 = -
EINVAL
;

712 
_îr
;

714 
îr
 = 
	`ªad
(
sock
, &
™s
, (ans));

715 i‡(
îr
 < 0) {

716 
	`SYSERR
("readÉrror");

717 
ªsu…
 = -
î∫o
;

718 
_îr
;

720 i‡(
îr
 !(
™s
)) {

721 
	`SNDERR
("read sizeÉrror");

722 
ªsu…
 = -
EINVAL
;

723 
_îr
;

725 
ªsu…
 = 
™s
.result;

726 i‡(
ªsu…
 < 0)

727 
_îr
;

729 
˘æ
 = 
	`shm©
(
™s
.
cookõ
, 0, 0);

730 i‡(!
˘æ
) {

731 
	`SYSERR
("shmatÉrror");

732 
ªsu…
 = -
î∫o
;

733 
_îr
;

736 
shm
 = 
	`ˇŒoc
(1, (
¢d_pcm_shm_t
));

737 i‡(!
shm
) {

738 
ªsu…
 = -
ENOMEM
;

739 
_îr
;

742 
shm
->
sockë
 = 
sock
;

743 
shm
->
˘æ
 = ctrl;

745 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_SHM
, 
«me
, 
°ªam
, 
mode
);

746 i‡(
îr
 < 0) {

747 
ªsu…
 = 
îr
;

748 
_îr
;

750 
pcm
->
mm≠_rw
 = 1;

751 
pcm
->
›s
 = &
¢d_pcm_shm_›s
;

752 
pcm
->
Á°_›s
 = &
¢d_pcm_shm_Á°_›s
;

753 
pcm
->
¥iv©e_d©a
 = 
shm
;

754 
îr
 = 
	`¢d_pcm_shm_pﬁl_des¸ùt‹
(
pcm
);

755 i‡(
îr
 < 0) {

756 
	`¢d_pcm_˛o£
(
pcm
);

757  
îr
;

759 
pcm
->
pﬁl_fd
 = 
îr
;

760 
pcm
->
pﬁl_evíts
 = 
°ªam
 =
SND_PCM_STREAM_PLAYBACK
 ? 
POLLOUT
 : 
POLLIN
;

761 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
˘æ
->
hw
.
±r
, -1, 0);

762 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
˘æ
->
≠∂
.
±r
, -1, 0);

763 *
pcmp
 = 
pcm
;

766 
_îr
:

767 
	`˛o£
(
sock
);

768 i‡(
˘æ
)

769 
	`shmdt
(
˘æ
);

770 
	`‰ì
(
shm
);

771  
ªsu…
;

772 
	}
}

811 
	$_¢d_pcm_shm_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

812 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

813 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

815 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

816 c⁄° *
£rvî
 = 
NULL
;

817 c⁄° *
pcm_«me
 = 
NULL
;

818 
¢d_c⁄fig_t
 *
sc⁄fig
;

819 c⁄° *
sock«me
 = 
NULL
;

820 
p‹t
 = -1;

821 
îr
;

823 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

824 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

825 c⁄° *
id
;

826 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

828 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

830 i‡(
	`°rcmp
(
id
, "server") == 0) {

831 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
£rvî
);

832 i‡(
îr
 < 0) {

833 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

834  -
EINVAL
;

838 i‡(
	`°rcmp
(
id
, "pcm") == 0) {

839 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
pcm_«me
);

840 i‡(
îr
 < 0) {

841 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

842  -
EINVAL
;

846 
	`SNDERR
("Unknow¿fõld %s", 
id
);

847  -
EINVAL
;

849 i‡(!
pcm_«me
) {

850 
	`SNDERR
("pcm isÇot defined");

851  -
EINVAL
;

853 i‡(!
£rvî
) {

854 
	`SNDERR
("server isÇot defined");

855  -
EINVAL
;

857 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "£rvî", 
£rvî
, &
sc⁄fig
);

858 i‡(
îr
 < 0) {

859 
	`SNDERR
("Unknow¿£rvî %s", 
£rvî
);

860  -
EINVAL
;

862 i‡(
	`¢d_c⁄fig_gë_ty≥
(
sc⁄fig
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

863 
	`SNDERR
("InvÆidÅy≥ f‹ sîvî %†deföôi⁄", 
£rvî
);

864 
_îr
;

866 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
sc⁄fig
) {

867 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

868 c⁄° *
id
;

869 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

871 i‡(
	`°rcmp
(
id
, "comment") == 0)

873 i‡(
	`°rcmp
(
id
, "host") == 0)

875 i‡(
	`°rcmp
(
id
, "socket") == 0) {

876 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
sock«me
);

877 i‡(
îr
 < 0) {

878 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

879 
_îr
;

883 i‡(
	`°rcmp
(
id
, "port") == 0) {

884 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
p‹t
);

885 i‡(
îr
 < 0) {

886 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

887 
_îr
;

891 
	`SNDERR
("Unknow¿fõld %s", 
id
);

892 
_îr
:

893 
îr
 = -
EINVAL
;

894 
__îr‹
;

897 i‡(!
sock«me
) {

898 
	`SNDERR
("socket isÇot defined");

899 
_îr
;

901 
îr
 = 
	`¢d_pcm_shm_›í
(
pcmp
, 
«me
, 
sock«me
, 
pcm_«me
, 
°ªam
, 
mode
);

902 
__îr‹
:

903 
	`¢d_c⁄fig_dñëe
(
sc⁄fig
);

904  
îr
;

905 
	}
}

906 #i‚de‡
DOC_HIDDEN


907 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_shm_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_simple.c

26 
	~"pcm_loˇl.h
"

28 
	$£t_buf„r_time
(
¢d_•cm_œãncy_t
 
œãncy
,

29 *
buf„r_time
)

31 
œãncy
) {

32 
SND_SPCM_LATENCY_STANDARD
:

33 *
buf„r_time
 = 350000;

35 
SND_SPCM_LATENCY_MEDIUM
:

36 *
buf„r_time
 = 25000;

38 
SND_SPCM_LATENCY_REALTIME
:

39 *
buf„r_time
 = 2500;

42  -
EINVAL
;

45 
	}
}

47 
	$£t_hw_∑øms
(
¢d_pcm_t
 *
pcm
,

48 
¢d_pcm_hw_∑øms_t
 *
hw_∑øms
,

49 *
øã
,

50 
ch™√ls
,

51 
¢d_pcm_f‹m©_t
 
f‹m©
,

52 
¢d_pcm_subf‹m©_t
 
subf‹m©
,

53 *
buf„r_time
,

54 *
≥riod_time
,

55 
¢d_pcm_ac˚ss_t
 
ac˚ss
)

57 
îr
;

62 
îr
 = 
	`¢d_pcm_hw_∑øms_™y
(
pcm
, 
hw_∑øms
);

63 i‡(
îr
 < 0)

64  
îr
;

65 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_ac˚ss
(
pcm
, 
hw_∑øms
, 
ac˚ss
);

66 i‡(
îr
 < 0)

67  
îr
;

68 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_f‹m©
(
pcm
, 
hw_∑øms
, 
f‹m©
);

69 i‡(
îr
 < 0)

70  
îr
;

71 i‡(
subf‹m©
 !
SND_PCM_SUBFORMAT_STD
) {

72 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_subf‹m©
(
pcm
, 
hw_∑øms
, 
subf‹m©
);

73 i‡(
îr
 < 0)

74  
îr
;

76 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_ch™√ls
(
pcm
, 
hw_∑øms
, 
ch™√ls
);

77 i‡(
îr
 < 0)

78  
îr
;

79 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_øã_√¨
)(
pcm
, 
hw_∑øms
, 
øã
, 0);

80 i‡(
îr
 < 0)

81  
îr
;

82 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_buf„r_time_√¨
)(
pcm
, 
hw_∑øms
, 
buf„r_time
, 
NULL
);

83 i‡(
îr
 < 0)

84  
îr
;

85 i‡(
≥riod_time
 =
NULL
 || *period_time == 0) {

86 
≥riods
 = 3;

87 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_£t_≥riods_√¨
)(
pcm
, 
hw_∑øms
, &
≥riods
, 
NULL
);

88 i‡(
îr
 < 0)

89  
îr
;

90 i‡(
≥riods
 == 1)

91  -
EINVAL
;

92 i‡(
≥riod_time
) {

93 
îr
 = 
	`INTERNAL
(
¢d_pcm_hw_∑øms_gë_≥riod_time
)(
hw_∑øms
, 
≥riod_time
, 
NULL
);

94 i‡(
îr
 < 0)

95  
îr
;

98 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_≥riod_time
(
pcm
, 
hw_∑øms
, *
≥riod_time
, 0);

99 i‡(
îr
 < 0)

100  
îr
;

101 i‡(*
buf„r_time
 =*
≥riod_time
)

102  -
EINVAL
;

104 
îr
 = 
	`¢d_pcm_hw_∑øms
(
pcm
, 
hw_∑øms
);

105 i‡(
îr
 < 0)

106  
îr
;

108 
	}
}

110 
	$£t_sw_∑øms
(
¢d_pcm_t
 *
pcm
,

111 
¢d_pcm_sw_∑øms_t
 *
sw_∑øms
,

112 
¢d_•cm_xrun_ty≥_t
 
xrun_ty≥
)

114 
îr
;

116 
îr
 = 
	`¢d_pcm_sw_∑øms_cuºít
(
pcm
, 
sw_∑øms
);

117 i‡(
îr
 < 0)

118  
îr
;

119 
îr
 = 
	`¢d_pcm_sw_∑øms_£t_°¨t_thªshﬁd
(
pcm
, 
sw_∑øms
, (pcm->
buf„r_size
 /Öcm->
≥riod_size
) *Öcm->period_size);

120 i‡(
îr
 < 0)

121  
îr
;

122 
îr
 = 
	`¢d_pcm_sw_∑øms_£t_avaû_mö
(
pcm
, 
sw_∑øms
,Öcm->
≥riod_size
);

123 i‡(
îr
 < 0)

124  
îr
;

125 
xrun_ty≥
) {

126 
SND_SPCM_XRUN_STOP
:

127 
îr
 = 
	`¢d_pcm_sw_∑øms_£t_°›_thªshﬁd
(
pcm
, 
sw_∑øms
,Öcm->
buf„r_size
);

129 
SND_SPCM_XRUN_IGNORE
:

130 
îr
 = 
	`¢d_pcm_sw_∑øms_£t_°›_thªshﬁd
(
pcm
, 
sw_∑øms
,Öcm->
bound¨y
);

133  -
EINVAL
;

135 i‡(
îr
 < 0)

136  
îr
;

137 
îr
 = 
	`¢d_pcm_sw_∑øms
(
pcm
, 
sw_∑øms
);

138 i‡(
îr
 < 0)

139  
îr
;

141 
	}
}

157 
	$¢d_•cm_öô
(
¢d_pcm_t
 *
pcm
,

158 
øã
,

159 
ch™√ls
,

160 
¢d_pcm_f‹m©_t
 
f‹m©
,

161 
¢d_pcm_subf‹m©_t
 
subf‹m©
,

162 
¢d_•cm_œãncy_t
 
œãncy
,

163 
¢d_pcm_ac˚ss_t
 
ac˚ss
,

164 
¢d_•cm_xrun_ty≥_t
 
xrun_ty≥
)

166 
îr
;

167 
¢d_pcm_hw_∑øms_t
 
hw_∑øms
 = {0};

168 
¢d_pcm_sw_∑øms_t
 
sw_∑øms
 = {0};

169 
º©e
;

170 
buf„r_time
;

172 
	`as£π
(
pcm
);

173 
	`as£π
(
øã
 >= 5000 &&Ñate <= 786000);

174 
	`as£π
(
ch™√ls
 >= 1 && channels <= 512);

176 
º©e
 = 
øã
;

177 
îr
 = 
	`£t_buf„r_time
(
œãncy
, &
buf„r_time
);

178 i‡(
îr
 < 0)

179  
îr
;

180 
îr
 = 
	`£t_hw_∑øms
(
pcm
, &
hw_∑øms
,

181 &
º©e
, 
ch™√ls
, 
f‹m©
, 
subf‹m©
,

182 &
buf„r_time
, 
NULL
, 
ac˚ss
);

183 i‡(
îr
 < 0)

184  
îr
;

186 
îr
 = 
	`£t_sw_∑øms
(
pcm
, &
sw_∑øms
, 
xrun_ty≥
);

187 i‡(
îr
 < 0)

188  
îr
;

191 
	}
}

209 
	$¢d_•cm_öô_du∂ex
(
¢d_pcm_t
 *
∂ayback_pcm
,

210 
¢d_pcm_t
 *
ˇ±uª_pcm
,

211 
øã
,

212 
ch™√ls
,

213 
¢d_pcm_f‹m©_t
 
f‹m©
,

214 
¢d_pcm_subf‹m©_t
 
subf‹m©
,

215 
¢d_•cm_œãncy_t
 
œãncy
,

216 
¢d_pcm_ac˚ss_t
 
ac˚ss
,

217 
¢d_•cm_xrun_ty≥_t
 
xrun_ty≥
,

218 
¢d_•cm_du∂ex_ty≥_t
 
du∂ex_ty≥
)

220 
îr
, 
i
;

221 
¢d_pcm_hw_∑øms_t
 
hw_∑øms
 = {0};

222 
¢d_pcm_sw_∑øms_t
 
sw_∑øms
 = {0};

223 
º©e
;

224 
xbuf„r_time
, 
buf„r_time
[2];

225 
≥riod_time
[2];

226 
¢d_pcm_t
 *
pcms
[2];

228 
	`as£π
(
∂ayback_pcm
);

229 
	`as£π
(
ˇ±uª_pcm
);

230 
	`as£π
(
øã
 >= 5000 &&Ñate <= 768000);

231 
	`as£π
(
ch™√ls
 >= 1 && channels <= 512);

233 
pcms
[0] = 
∂ayback_pcm
;

234 
pcms
[1] = 
ˇ±uª_pcm
;

239 
îr
 = 
	`£t_buf„r_time
(
œãncy
, &
xbuf„r_time
);

240 i‡(
îr
 < 0)

241  
îr
;

243 
i
 = 0; i < 2; i++) {

244 
buf„r_time
[
i
] = 
xbuf„r_time
;

245 
≥riod_time
[
i
] = i > 0 ?Öeriod_time[0] : 0;

246 
º©e
 = 
øã
;

247 
îr
 = 
	`£t_hw_∑øms
(
pcms
[
i
], &
hw_∑øms
,

248 &
º©e
, 
ch™√ls
, 
f‹m©
, 
subf‹m©
,

249 &
buf„r_time
[
i
], &
≥riod_time
[i], 
ac˚ss
);

250 i‡(
îr
 < 0)

251  
îr
;

253 i‡(
buf„r_time
[0] == buffer_time[1] &&

254 
≥riod_time
[0] ==Öeriod_time[1])

255 
__sw_∑øms
;

256 i‡(
du∂ex_ty≥
 =
SND_SPCM_DUPLEX_LIBERAL
)

257 
__sw_∑øms
;

259  -
EINVAL
;

264 
__sw_∑øms
:

265 
i
 = 0; i < 2; i++) {

266 
îr
 = 
	`£t_sw_∑øms
(
pcms
[
i
], &
sw_∑øms
, 
xrun_ty≥
);

267 i‡(
îr
 < 0)

268  
îr
;

272 
	}
}

284 
	$¢d_•cm_öô_gë_∑øms
(
¢d_pcm_t
 *
pcm
,

285 *
øã
,

286 
¢d_pcm_u‰ames_t
 *
buf„r_size
,

287 
¢d_pcm_u‰ames_t
 *
≥riod_size
)

289 
	`as£π
(
pcm
);

290 i‡(!
pcm
->
£tup
)

291  -
EBADFD
;

292 i‡(
øã
)

293 *
øã
 = 
pcm
->rate;

294 i‡(
buf„r_size
)

295 *
buf„r_size
 = 
pcm
->buffer_size;

296 i‡(
≥riod_size
)

297 *
≥riod_size
 = 
pcm
->period_size;

299 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_softvol.c

29 
	~"pcm_loˇl.h
"

30 
	~"pcm_∂ugö.h
"

31 
	~"bsw≠.h
"

32 
	~<m©h.h
>

33 
	~<sound/év.h
>

35 #i‚de‡
PIC


37 c⁄° *
	g_¢d_moduÀ_pcm_so·vﬁ
 = "";

40 #i‚de‡
DOC_HIDDEN


44 
¢d_pcm_∂ugö_t
 
	m∂ug
;

45 
¢d_pcm_f‹m©_t
 
	msf‹m©
;

46 
	mcch™√ls
;

47 
¢d_˘l_t
 *
	m˘l
;

48 
¢d_˘l_ñem_vÆue_t
 
	mñem
;

49 
	mcur_vﬁ
[2];

50 
	mmax_vÆ
;

51 
	mzîo_dB_vÆ
;

52 
	mmö_dB
;

53 
	mmax_dB
;

54 *
	mdB_vÆue
;

55 } 
	t¢d_pcm_so·vﬁ_t
;

57 
	#VOL_SCALE_SHIFT
 16

	)

58 
	#VOL_SCALE_MASK
 ((1 << 
VOL_SCALE_SHIFT
Ë- 1)

	)

60 
	#PRESET_RESOLUTION
 256

	)

61 
	#PRESET_MIN_DB
 -51.0

	)

62 
	#ZERO_DB
 0.0

	)

67 
	#MAX_DB_UPPER_LIMIT
 90

	)

69 c⁄° 
	g¥e£t_dB_vÆue
[
PRESET_RESOLUTION
] = {

106 
	mi
;

107 
	ms
[2];

108 } 
	tvÆ_t
;

109 
ölöe
 
	$MULTI_DIV_32x16
(
a
, 
b
)

111 
vÆ_t
 
v
, 
x
, 
y
;

112 
v
.
i
 = 
a
;

113 
y
.
i
 = 0;

114 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


115 
x
.
i
 = ()
v
.
s
[0];

116 
x
.
i
 *()
b
;

117 
y
.
s
[0] = 
x
.s[1];

118 
y
.
i
 +()
v
.
s
[1] * 
b
;

120 
x
.
i
 = ()
v
.
s
[1] * 
b
;

121 
y
.
s
[1] = 
x
.s[0];

122 
y
.
i
 +()
v
.
s
[0] * 
b
;

124  
y
.
i
;

125 
	}
}

127 
ölöe
 
	$MULTI_DIV_öt
(
a
, 
b
, 
sw≠
)

129 
gaö
 = (
b
 >> 
VOL_SCALE_SHIFT
);

130 
‰a˘i⁄
;

131 
a
 = 
sw≠
 ? ()
	`bsw≠_32
(a) :á;

132 
‰a˘i⁄
 = 
	`MULTI_DIV_32x16
(
a
, 
b
 & 
VOL_SCALE_MASK
);

133 i‡(
gaö
) {

134 
amp
 = ()
a
 * 
gaö
 + 
‰a˘i⁄
;

135 i‡(
amp
 > ()0x7fffffff)

136 
amp
 = ()0x7fffffff;

137 i‡(
amp
 < ()0x80000000)

138 
amp
 = ()0x80000000;

139  
sw≠
 ? ()
	`bsw≠_32
(()
amp
) : ()amp;

141  
sw≠
 ? ()
	`bsw≠_32
(
‰a˘i⁄
) : fraction;

142 
	}
}

145 
ölöe
 
	$MULTI_DIV_24
(
a
, 
b
)

147 
gaö
 = 
b
 >> 
VOL_SCALE_SHIFT
;

148 
‰a˘i⁄
;

149 
‰a˘i⁄
 = 
	`MULTI_DIV_32x16
(
a
, 
b
 & 
VOL_SCALE_MASK
);

150 i‡(
gaö
) {

151 
amp
 = ()
a
 * 
gaö
 + 
‰a˘i⁄
;

152 i‡(
amp
 > ()0x7fffff)

153 
amp
 = ()0x7fffff;

154 i‡(
amp
 < ()0x800000)

155 
amp
 = ()0x800000;

156  ()
amp
;

158  
‰a˘i⁄
;

159 
	}
}

161 
ölöe
 
	$MULTI_DIV_sh‹t
(
a
, 
b
, 
sw≠
)

163 
gaö
 = 
b
 >> 
VOL_SCALE_SHIFT
;

164 
‰a˘i⁄
;

165 
a
 = 
sw≠
 ? ()
	`bsw≠_16
(a) :á;

166 
‰a˘i⁄
 = ()(
a
 * (
b
 & 
VOL_SCALE_MASK
)Ë>> 
VOL_SCALE_SHIFT
;

167 i‡(
gaö
) {

168 
amp
 = 
a
 * 
gaö
 + 
‰a˘i⁄
;

169 i‡(
	`abs
(
amp
) > 0x7fff)

170 
amp
 = (
a
<0) ? ()0x8000 : ()0x7fff;

171  
sw≠
 ? ()
	`bsw≠_16
(()
amp
) : ()amp;

173  
sw≠
 ? ()
	`bsw≠_16
(()
‰a˘i⁄
) : ()fraction;

174 
	}
}

184 #i‚de‡
DOC_HIDDEN


185 
	#CONVERT_AREA
(
TYPE
, 
sw≠
) do { \

186 
ch
, 
‰
; \

187 
TYPE
 *
§c
, *
d°
; \

188 
ch
 = 0; ch < 
ch™√ls
; ch++) { \

189 
§c_¨ó
 = &
§c_¨ós
[
ch
]; \

190 
d°_¨ó
 = &
d°_¨ós
[
ch
]; \

191 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
); \

192 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
); \

193 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
Ë/ (
TYPE
); \

194 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
Ë/ (
TYPE
); \

195 
GET_VOL_SCALE
; \

196 
‰
 = 
‰ames
; \

197 i‡(! 
vﬁ_sˇÀ
) { \

198 
‰
--) { \

199 *
d°
 = 0; \

200 
d°
 +
d°_°ï
; \

202 } i‡(
vﬁ_sˇÀ
 == 0xffff) { \

203 
‰
--) { \

204 *
d°
 = *
§c
; \

205 
§c
 +
§c_°ï
; \

206 
d°
 +
d°_°ï
; \

209 
‰
--) { \

210 *
d°
 = (
TYPE
Ë
MULTI_DIV_
##
	`TYPE
(*
§c
, 
vﬁ_sˇÀ
, 
sw≠
); \

211 
§c
 +
§c_°ï
; \

212 
d°
 +
d°_°ï
; \

216 } 0)

	)

218 
	#CONVERT_AREA_S24_3LE
() do { \

219 
ch
, 
‰
; \

220 *
§c
, *
d°
; \

221 
tmp
; \

222 
ch
 = 0; ch < 
ch™√ls
; ch++) { \

223 
§c_¨ó
 = &
§c_¨ós
[
ch
]; \

224 
d°_¨ó
 = &
d°_¨ós
[
ch
]; \

225 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
); \

226 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
); \

227 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
); \

228 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
); \

229 
GET_VOL_SCALE
; \

230 
‰
 = 
‰ames
; \

231 i‡(! 
vﬁ_sˇÀ
) { \

232 
‰
--) { \

233 
d°
[0] = dst[1] = dst[2] = 0; \

234 
d°
 +
d°_°ï
; \

236 } i‡(
vﬁ_sˇÀ
 == 0xffff) { \

237 
‰
--) { \

238 
d°
[0] = 
§c
[0]; \

239 
d°
[1] = 
§c
[1]; \

240 
d°
[2] = 
§c
[2]; \

241 
§c
 +
d°_°ï
; \

242 
d°
 +
§c_°ï
; \

245 
‰
--) { \

246 
tmp
 = 
§c
[0] | \

247 (
§c
[1] << 8) | \

248 (((sig√d *Ë
§c
)[2] << 16); \

249 
tmp
 = 
	`MULTI_DIV_24
—mp, 
vﬁ_sˇÀ
); \

250 
d°
[0] = 
tmp
; \

251 
d°
[1] = 
tmp
 >> 8; \

252 
d°
[2] = 
tmp
 >> 16; \

253 
§c
 +
d°_°ï
; \

254 
d°
 +
§c_°ï
; \

258 } 0)

	)

260 
	#CONVERT_AREA_S24_LE
() do { \

261 
ch
, 
‰
; \

262 *
§c
, *
d°
; \

263 
tmp
; \

264 
ch
 = 0; ch < 
ch™√ls
; ch++) { \

265 
§c_¨ó
 = &
§c_¨ós
[
ch
]; \

266 
d°_¨ó
 = &
d°_¨ós
[
ch
]; \

267 
§c
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
§c_¨ó
, 
§c_off£t
); \

268 
d°
 = 
	`¢d_pcm_ch™√l_¨ó_addr
(
d°_¨ó
, 
d°_off£t
); \

269 
§c_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
§c_¨ó
) \

271 
d°_°ï
 = 
	`¢d_pcm_ch™√l_¨ó_°ï
(
d°_¨ó
) \

273 
GET_VOL_SCALE
; \

274 
‰
 = 
‰ames
; \

275 i‡(! 
vﬁ_sˇÀ
) { \

276 
‰
--) { \

277 *
d°
 = 0; \

278 
d°
 +
d°_°ï
; \

280 } i‡(
vﬁ_sˇÀ
 == 0xffff) { \

281 
‰
--) { \

282 *
d°
 = *
§c
; \

283 
§c
 +
d°_°ï
; \

284 
d°
 +
§c_°ï
; \

287 
‰
--) { \

288 
tmp
 = *
§c
 << 8; \

289 
tmp
 = (signed )Åmp >> 8; \

290 *
d°
 = 
	`MULTI_DIV_24
(
tmp
, 
vﬁ_sˇÀ
); \

291 
§c
 +
d°_°ï
; \

292 
d°
 +
§c_°ï
; \

296 } 0)

	)

298 
	#GET_VOL_SCALE
 \

299 
ch
) { \

302 
vﬁ_sˇÀ
 = (
ch™√ls
 =
ch
 + 1Ë? 
vﬁ_c
 : 
vﬁ
[0]; \

306 
vﬁ_sˇÀ
 = 
vﬁ_c
; \

309 
vﬁ_sˇÀ
 = 
vﬁ
[
ch
 & 1]; \

311 }

	)

316 
	$so·vﬁ_c⁄vît_°îeo_vﬁ
(
¢d_pcm_so·vﬁ_t
 *
svﬁ
,

317 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

318 
¢d_pcm_u‰ames_t
 
d°_off£t
,

319 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

320 
¢d_pcm_u‰ames_t
 
§c_off£t
,

321 
ch™√ls
,

322 
¢d_pcm_u‰ames_t
 
‰ames
)

324 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
, *
§c_¨ó
;

325 
§c_°ï
, 
d°_°ï
;

326 
vﬁ_sˇÀ
, 
vﬁ
[2], 
vﬁ_c
;

328 i‡(
svﬁ
->
cur_vﬁ
[0] == 0 && svol->cur_vol[1] == 0) {

329 
	`¢d_pcm_¨ós_sûí˚
(
d°_¨ós
, 
d°_off£t
, 
ch™√ls
, 
‰ames
,

330 
svﬁ
->
sf‹m©
);

332 } i‡(
svﬁ
->
zîo_dB_vÆ
 && svﬁ->
cur_vﬁ
[0] == svol->zero_dB_val &&

333 
svﬁ
->
cur_vﬁ
[1] =svﬁ->
zîo_dB_vÆ
) {

334 
	`¢d_pcm_¨ós_c›y
(
d°_¨ós
, 
d°_off£t
, 
§c_¨ós
, 
§c_off£t
,

335 
ch™√ls
, 
‰ames
, 
svﬁ
->
sf‹m©
);

339 i‡(
svﬁ
->
max_vÆ
 == 1) {

340 
vﬁ
[0] = 
svﬁ
->
cur_vﬁ
[0] ? 0xffff : 0;

341 
vﬁ
[1] = 
svﬁ
->
cur_vﬁ
[1] ? 0xffff : 0;

342 
vﬁ_c
 = 
vﬁ
[0] | vol[1];

344 
vﬁ
[0] = 
svﬁ
->
dB_vÆue
[svﬁ->
cur_vﬁ
[0]];

345 
vﬁ
[1] = 
svﬁ
->
dB_vÆue
[svﬁ->
cur_vﬁ
[1]];

346 
vﬁ_c
 = 
svﬁ
->
dB_vÆue
[(svﬁ->
cur_vﬁ
[0] + svol->cur_vol[1]) / 2];

348 
svﬁ
->
sf‹m©
) {

349 
SND_PCM_FORMAT_S16_LE
:

350 
SND_PCM_FORMAT_S16_BE
:

352 
	`CONVERT_AREA
(,

353 !
	`¢d_pcm_f‹m©_˝u_ídün
(
svﬁ
->
sf‹m©
));

355 
SND_PCM_FORMAT_S32_LE
:

356 
SND_PCM_FORMAT_S32_BE
:

358 
	`CONVERT_AREA
(,

359 !
	`¢d_pcm_f‹m©_˝u_ídün
(
svﬁ
->
sf‹m©
));

361 
SND_PCM_FORMAT_S24_LE
:

363 
	`CONVERT_AREA_S24_LE
();

365 
SND_PCM_FORMAT_S24_3LE
:

366 
	`CONVERT_AREA_S24_3LE
();

371 
	}
}

373 #unde‡
GET_VOL_SCALE


374 
	#GET_VOL_SCALE


	)

377 
	$so·vﬁ_c⁄vît_m⁄o_vﬁ
(
¢d_pcm_so·vﬁ_t
 *
svﬁ
,

378 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ós
,

379 
¢d_pcm_u‰ames_t
 
d°_off£t
,

380 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
§c_¨ós
,

381 
¢d_pcm_u‰ames_t
 
§c_off£t
,

382 
ch™√ls
,

383 
¢d_pcm_u‰ames_t
 
‰ames
)

385 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
d°_¨ó
, *
§c_¨ó
;

386 
§c_°ï
, 
d°_°ï
;

387 
vﬁ_sˇÀ
;

389 i‡(
svﬁ
->
cur_vﬁ
[0] == 0) {

390 
	`¢d_pcm_¨ós_sûí˚
(
d°_¨ós
, 
d°_off£t
, 
ch™√ls
, 
‰ames
,

391 
svﬁ
->
sf‹m©
);

393 } i‡(
svﬁ
->
zîo_dB_vÆ
 && svﬁ->
cur_vﬁ
[0] == svol->zero_dB_val) {

394 
	`¢d_pcm_¨ós_c›y
(
d°_¨ós
, 
d°_off£t
, 
§c_¨ós
, 
§c_off£t
,

395 
ch™√ls
, 
‰ames
, 
svﬁ
->
sf‹m©
);

399 i‡(
svﬁ
->
max_vÆ
 == 1)

400 
vﬁ_sˇÀ
 = 
svﬁ
->
cur_vﬁ
[0] ? 0xffff : 0;

402 
vﬁ_sˇÀ
 = 
svﬁ
->
dB_vÆue
[svﬁ->
cur_vﬁ
[0]];

403 
svﬁ
->
sf‹m©
) {

404 
SND_PCM_FORMAT_S16_LE
:

405 
SND_PCM_FORMAT_S16_BE
:

407 
	`CONVERT_AREA
(,

408 !
	`¢d_pcm_f‹m©_˝u_ídün
(
svﬁ
->
sf‹m©
));

410 
SND_PCM_FORMAT_S32_LE
:

411 
SND_PCM_FORMAT_S32_BE
:

413 
	`CONVERT_AREA
(,

414 !
	`¢d_pcm_f‹m©_˝u_ídün
(
svﬁ
->
sf‹m©
));

416 
SND_PCM_FORMAT_S24_LE
:

418 
	`CONVERT_AREA_S24_LE
();

420 
SND_PCM_FORMAT_S24_3LE
:

421 
	`CONVERT_AREA_S24_3LE
();

426 
	}
}

433 
	$gë_cuºít_vﬁume
(
¢d_pcm_so·vﬁ_t
 *
svﬁ
)

435 
vÆ
;

436 
i
;

438 i‡(
	`¢d_˘l_ñem_ªad
(
svﬁ
->
˘l
, &svﬁ->
ñem
) < 0)

440 
i
 = 0; i < 
svﬁ
->
cch™√ls
; i++) {

441 
vÆ
 = 
svﬁ
->
ñem
.
vÆue
.
öãgî
.vÆue[
i
];

442 i‡(
vÆ
 > 
svﬁ
->
max_vÆ
)

443 
vÆ
 = 
svﬁ
->
max_vÆ
;

444 
svﬁ
->
cur_vﬁ
[
i
] = 
vÆ
;

446 
	}
}

448 
	$so·vﬁ_‰ì
(
¢d_pcm_so·vﬁ_t
 *
svﬁ
)

450 i‡(
svﬁ
->
∂ug
.
gí
.
˛o£_¶ave
)

451 
	`¢d_pcm_˛o£
(
svﬁ
->
∂ug
.
gí
.
¶ave
);

452 i‡(
svﬁ
->
˘l
)

453 
	`¢d_˘l_˛o£
(
svﬁ
->
˘l
);

454 i‡(
svﬁ
->
dB_vÆue
 && svﬁ->dB_vÆuê!
¥e£t_dB_vÆue
)

455 
	`‰ì
(
svﬁ
->
dB_vÆue
);

456 
	`‰ì
(
svﬁ
);

457 
	}
}

459 
	$¢d_pcm_so·vﬁ_˛o£
(
¢d_pcm_t
 *
pcm
)

461 
¢d_pcm_so·vﬁ_t
 *
svﬁ
 = 
pcm
->
¥iv©e_d©a
;

462 
	`so·vﬁ_‰ì
(
svﬁ
);

464 
	}
}

466 
	$¢d_pcm_so·vﬁ_hw_ªföe_˝ª∑ª
(
¢d_pcm_t
 *
pcm
,

467 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

469 
îr
;

470 
¢d_pcm_so·vﬁ_t
 *
svﬁ
 = 
pcm
->
¥iv©e_d©a
;

471 
¢d_pcm_ac˚ss_mask_t
 
ac˚ss_mask
 = { 
SND_PCM_ACCBIT_SHM
 };

472 
¢d_pcm_f‹m©_mask_t
 
f‹m©_mask
 = {

474 (1ULL << 
SND_PCM_FORMAT_S16_LE
) |

475 (1ULL << 
SND_PCM_FORMAT_S16_BE
) |

476 (1ULL << 
SND_PCM_FORMAT_S24_LE
) |

477 (1ULL << 
SND_PCM_FORMAT_S32_LE
) |

478 (1ULL << 
SND_PCM_FORMAT_S32_BE
),

479 (1ULL << (
SND_PCM_FORMAT_S24_3LE
 - 32))

482 i‡(
svﬁ
->
sf‹m©
 !
SND_PCM_FORMAT_UNKNOWN
) {

483 
	`¢d_pcm_f‹m©_mask_n⁄e
(&
f‹m©_mask
);

484 
	`¢d_pcm_f‹m©_mask_£t
(&
f‹m©_mask
, 
svﬁ
->
sf‹m©
);

486 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_ACCESS
,

487 &
ac˚ss_mask
);

488 i‡(
îr
 < 0)

489  
îr
;

490 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mask
(
∑øms
, 
SND_PCM_HW_PARAM_FORMAT
,

491 &
f‹m©_mask
);

492 i‡(
îr
 < 0)

493  
îr
;

494 
îr
 = 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
∑øms
, 
SND_PCM_SUBFORMAT_STD
);

495 i‡(
îr
 < 0)

496  
îr
;

497 
îr
 = 
	`_¢d_pcm_hw_∑øm_£t_mö
(
∑øms
, 
SND_PCM_HW_PARAM_CHANNELS
, 1, 0);

498 i‡(
îr
 < 0)

499  
îr
;

500 
∑øms
->
öfo
 &~(
SND_PCM_INFO_MMAP
 | 
SND_PCM_INFO_MMAP_VALID
);

502 
	}
}

504 
	$¢d_pcm_so·vﬁ_hw_ªföe_•ª∑ª
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

506 
¢d_pcm_so·vﬁ_t
 *
svﬁ
 = 
pcm
->
¥iv©e_d©a
;

507 
¢d_pcm_ac˚ss_mask_t
 
ßc˚ss_mask
 = { 
SND_PCM_ACCBIT_MMAP
 };

508 
	`_¢d_pcm_hw_∑øms_™y
(
•¨ams
);

509 
	`_¢d_pcm_hw_∑øm_£t_mask
(
•¨ams
, 
SND_PCM_HW_PARAM_ACCESS
,

510 &
ßc˚ss_mask
);

511 i‡(
svﬁ
->
sf‹m©
 !
SND_PCM_FORMAT_UNKNOWN
) {

512 
	`_¢d_pcm_hw_∑øms_£t_f‹m©
(
•¨ams
, 
svﬁ
->
sf‹m©
);

513 
	`_¢d_pcm_hw_∑øms_£t_subf‹m©
(
•¨ams
, 
SND_PCM_SUBFORMAT_STD
);

516 
	}
}

521 
	$check_ac˚ss_mask
(
¢d_pcm_hw_∑øms_t
 *
§c
,

522 
¢d_pcm_hw_∑øms_t
 *
d°
)

524 c⁄° 
¢d_pcm_ac˚ss_mask_t
 *
mask
;

525 
¢d_pcm_ac˚ss_mask_t
 
smask
;

527 
mask
 = 
	`¢d_pcm_hw_∑øm_gë_mask
(
§c
, 
SND_PCM_HW_PARAM_ACCESS
);

528 
	`¢d_mask_n⁄e
(&
smask
);

529 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(
mask
, 
SND_PCM_ACCESS_RW_INTERLEAVED
) ||

530 
	`¢d_pcm_ac˚ss_mask_ã°
(
mask
, 
SND_PCM_ACCESS_MMAP_INTERLEAVED
)) {

531 
	`¢d_pcm_ac˚ss_mask_£t
(&
smask
,

532 
SND_PCM_ACCESS_RW_INTERLEAVED
);

533 
	`¢d_pcm_ac˚ss_mask_£t
(&
smask
,

534 
SND_PCM_ACCESS_MMAP_INTERLEAVED
);

536 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(
mask
, 
SND_PCM_ACCESS_RW_NONINTERLEAVED
) ||

537 
	`¢d_pcm_ac˚ss_mask_ã°
(
mask
, 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
)) {

538 
	`¢d_pcm_ac˚ss_mask_£t
(&
smask
,

539 
SND_PCM_ACCESS_RW_NONINTERLEAVED
);

540 
	`¢d_pcm_ac˚ss_mask_£t
(&
smask
,

541 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
);

543 i‡(
	`¢d_pcm_ac˚ss_mask_ã°
(
mask
, 
SND_PCM_ACCESS_MMAP_COMPLEX
))

544 
	`¢d_pcm_ac˚ss_mask_£t
(&
smask
,

545 
SND_PCM_ACCESS_MMAP_COMPLEX
);

547  
	`_¢d_pcm_hw_∑øm_£t_mask
(
d°
, 
SND_PCM_HW_PARAM_ACCESS
, &
smask
);

548 
	}
}

550 
	$¢d_pcm_so·vﬁ_hw_ªföe_sch™ge
(
¢d_pcm_t
 *
pcm
,

551 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

552 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

554 
¢d_pcm_so·vﬁ_t
 *
svﬁ
 = 
pcm
->
¥iv©e_d©a
;

555 
îr
;

556 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

557 
SND_PCM_HW_PARBIT_RATE
 |

558 
SND_PCM_HW_PARBIT_PERIODS
 |

559 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

560 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

561 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

562 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

563 
SND_PCM_HW_PARBIT_TICK_TIME
);

564 i‡(
svﬁ
->
sf‹m©
 =
SND_PCM_FORMAT_UNKNOWN
)

565 
löks
 |(
SND_PCM_HW_PARBIT_FORMAT
 |

566 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

567 
SND_PCM_HW_PARBIT_SAMPLE_BITS
);

568 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
•¨ams
, 
löks
, 
∑øms
);

569 i‡(
îr
 < 0)

570  
îr
;

572 
îr
 = 
	`check_ac˚ss_mask
(
∑øms
, 
•¨ams
);

573 i‡(
îr
 < 0)

574  
îr
;

577 
	}
}

579 
	$¢d_pcm_so·vﬁ_hw_ªföe_cch™ge
(
¢d_pcm_t
 *
pcm
,

580 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

581 
¢d_pcm_hw_∑øms_t
 *
•¨ams
)

583 
¢d_pcm_so·vﬁ_t
 *
svﬁ
 = 
pcm
->
¥iv©e_d©a
;

584 
îr
;

585 
löks
 = (
SND_PCM_HW_PARBIT_CHANNELS
 |

586 
SND_PCM_HW_PARBIT_RATE
 |

587 
SND_PCM_HW_PARBIT_PERIODS
 |

588 
SND_PCM_HW_PARBIT_PERIOD_SIZE
 |

589 
SND_PCM_HW_PARBIT_PERIOD_TIME
 |

590 
SND_PCM_HW_PARBIT_BUFFER_SIZE
 |

591 
SND_PCM_HW_PARBIT_BUFFER_TIME
 |

592 
SND_PCM_HW_PARBIT_TICK_TIME
);

593 i‡(
svﬁ
->
sf‹m©
 =
SND_PCM_FORMAT_UNKNOWN
)

594 
löks
 |(
SND_PCM_HW_PARBIT_FORMAT
 |

595 
SND_PCM_HW_PARBIT_SUBFORMAT
 |

596 
SND_PCM_HW_PARBIT_SAMPLE_BITS
);

597 
îr
 = 
	`_¢d_pcm_hw_∑øms_ªföe
(
∑øms
, 
löks
, 
•¨ams
);

598 i‡(
îr
 < 0)

599  
îr
;

601 
îr
 = 
	`check_ac˚ss_mask
(
•¨ams
, 
∑øms
);

602 i‡(
îr
 < 0)

603  
îr
;

606 
	}
}

608 
	$¢d_pcm_so·vﬁ_hw_ªföe
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 *
∑øms
)

610  
	`¢d_pcm_hw_ªföe_¶ave
(
pcm
, 
∑øms
,

611 
¢d_pcm_so·vﬁ_hw_ªföe_˝ª∑ª
,

612 
¢d_pcm_so·vﬁ_hw_ªföe_cch™ge
,

613 
¢d_pcm_so·vﬁ_hw_ªföe_•ª∑ª
,

614 
¢d_pcm_so·vﬁ_hw_ªföe_sch™ge
,

615 
¢d_pcm_gíîic_hw_ªföe
);

616 
	}
}

618 
	$¢d_pcm_so·vﬁ_hw_∑øms
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_hw_∑øms_t
 * 
∑øms
)

620 
¢d_pcm_so·vﬁ_t
 *
svﬁ
 = 
pcm
->
¥iv©e_d©a
;

621 
¢d_pcm_t
 *
¶ave
 = 
svﬁ
->
∂ug
.
gí
.slave;

622 
îr
 = 
	`¢d_pcm_hw_∑øms_¶ave
(
pcm
, 
∑øms
,

623 
¢d_pcm_so·vﬁ_hw_ªföe_cch™ge
,

624 
¢d_pcm_so·vﬁ_hw_ªföe_•ª∑ª
,

625 
¢d_pcm_so·vﬁ_hw_ªföe_sch™ge
,

626 
¢d_pcm_gíîic_hw_∑øms
);

627 i‡(
îr
 < 0)

628  
îr
;

629 i‡(
¶ave
->
f‹m©
 !
SND_PCM_FORMAT_S16_LE
 &&

630 
¶ave
->
f‹m©
 !
SND_PCM_FORMAT_S16_BE
 &&

631 
¶ave
->
f‹m©
 !
SND_PCM_FORMAT_S24_3LE
 &&

632 
¶ave
->
f‹m©
 !
SND_PCM_FORMAT_S24_LE
 &&

633 
¶ave
->
f‹m©
 !
SND_PCM_FORMAT_S32_LE
 &&

634 
¶ave
->
f‹m©
 !
SND_PCM_FORMAT_S32_BE
) {

635 
	`SNDERR
("softvol supports only S16_LE, S16_BE, S24_LE, S24_3LE, "

637  -
EINVAL
;

639 
svﬁ
->
sf‹m©
 = 
¶ave
->
f‹m©
;

641 
	}
}

643 
¢d_pcm_u‰ames_t


644 
	$¢d_pcm_so·vﬁ_wrôe_¨ós
(
¢d_pcm_t
 *
pcm
,

645 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

646 
¢d_pcm_u‰ames_t
 
off£t
,

647 
¢d_pcm_u‰ames_t
 
size
,

648 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

649 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

650 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

652 
¢d_pcm_so·vﬁ_t
 *
svﬁ
 = 
pcm
->
¥iv©e_d©a
;

653 i‡(
size
 > *
¶ave_sizï
)

654 
size
 = *
¶ave_sizï
;

655 
	`gë_cuºít_vﬁume
(
svﬁ
);

656 i‡(
svﬁ
->
cch™√ls
 == 1)

657 
	`so·vﬁ_c⁄vît_m⁄o_vﬁ
(
svﬁ
, 
¶ave_¨ós
, 
¶ave_off£t
,

658 
¨ós
, 
off£t
, 
pcm
->
ch™√ls
, 
size
);

660 
	`so·vﬁ_c⁄vît_°îeo_vﬁ
(
svﬁ
, 
¶ave_¨ós
, 
¶ave_off£t
,

661 
¨ós
, 
off£t
, 
pcm
->
ch™√ls
, 
size
);

662 *
¶ave_sizï
 = 
size
;

663  
size
;

664 
	}
}

666 
¢d_pcm_u‰ames_t


667 
	$¢d_pcm_so·vﬁ_ªad_¨ós
(
¢d_pcm_t
 *
pcm
,

668 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

669 
¢d_pcm_u‰ames_t
 
off£t
,

670 
¢d_pcm_u‰ames_t
 
size
,

671 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¶ave_¨ós
,

672 
¢d_pcm_u‰ames_t
 
¶ave_off£t
,

673 
¢d_pcm_u‰ames_t
 *
¶ave_sizï
)

675 
¢d_pcm_so·vﬁ_t
 *
svﬁ
 = 
pcm
->
¥iv©e_d©a
;

676 i‡(
size
 > *
¶ave_sizï
)

677 
size
 = *
¶ave_sizï
;

678 
	`gë_cuºít_vﬁume
(
svﬁ
);

679 i‡(
svﬁ
->
cch™√ls
 == 1)

680 
	`so·vﬁ_c⁄vît_m⁄o_vﬁ
(
svﬁ
, 
¨ós
, 
off£t
, 
¶ave_¨ós
,

681 
¶ave_off£t
, 
pcm
->
ch™√ls
, 
size
);

683 
	`so·vﬁ_c⁄vît_°îeo_vﬁ
(
svﬁ
, 
¨ós
, 
off£t
, 
¶ave_¨ós
,

684 
¶ave_off£t
, 
pcm
->
ch™√ls
, 
size
);

685 *
¶ave_sizï
 = 
size
;

686  
size
;

687 
	}
}

689 
	$¢d_pcm_so·vﬁ_dump
(
¢d_pcm_t
 *
pcm
, 
¢d_ouçut_t
 *
out
)

691 
¢d_pcm_so·vﬁ_t
 *
svﬁ
 = 
pcm
->
¥iv©e_d©a
;

692 
	`¢d_ouçut_¥ötf
(
out
, "Soft volume PCM\n");

693 
	`¢d_ouçut_¥ötf
(
out
, "C⁄åﬁ: %s\n", 
svﬁ
->
ñem
.
id
.
«me
);

694 i‡(
svﬁ
->
max_vÆ
 == 1)

695 
	`¢d_ouçut_¥ötf
(
out
, "boolean\n");

697 
	`¢d_ouçut_¥ötf
(
out
, "mö_dB: %g\n", 
svﬁ
->
mö_dB
);

698 
	`¢d_ouçut_¥ötf
(
out
, "max_dB: %g\n", 
svﬁ
->
max_dB
);

699 
	`¢d_ouçut_¥ötf
(
out
, "ªsﬁuti⁄: %d\n", 
svﬁ
->
max_vÆ
 + 1);

701 i‡(
pcm
->
£tup
) {

702 
	`¢d_ouçut_¥ötf
(
out
, "Its setup is:\n");

703 
	`¢d_pcm_dump_£tup
(
pcm
, 
out
);

705 
	`¢d_ouçut_¥ötf
(
out
, "Slave: ");

706 
	`¢d_pcm_dump
(
svﬁ
->
∂ug
.
gí
.
¶ave
, 
out
);

707 
	}
}

709 
	$add_év_öfo
(
¢d_pcm_so·vﬁ_t
 *
svﬁ
, 
¢d_˘l_ñem_öfo_t
 *
cöfo
,

710 *
ﬁd_év
, 
size_t
 
ﬁd_év_size
)

712 
év
[4];

713 
év
[
SNDRV_CTL_TLVO_TYPE
] = 
SND_CTL_TLVT_DB_SCALE
;

714 
év
[
SNDRV_CTL_TLVO_LEN
] = 2 * ();

715 
év
[
SNDRV_CTL_TLVO_DB_SCALE_MIN
] = ()(
svﬁ
->
mö_dB
 * 100);

716 
év
[
SNDRV_CTL_TLVO_DB_SCALE_MUTE_AND_STEP
] =

717 ()((
svﬁ
->
max_dB
 - svﬁ->
mö_dB
Ë* 100 / svﬁ->
max_vÆ
);

718 i‡((
év
Ë<
ﬁd_év_size
 && 
	`memcmp
—lv, 
ﬁd_év
, (tlv)) == 0)

720  
	`¢d_˘l_ñem_év_wrôe
(
svﬁ
->
˘l
, &
cöfo
->
id
, 
év
);

721 
	}
}

723 
	$add_u£r_˘l
(
¢d_pcm_so·vﬁ_t
 *
svﬁ
, 
¢d_˘l_ñem_öfo_t
 *
cöfo
,

724 
cou¡
)

726 
îr
;

727 
i
;

728 
def_vÆ
;

730 i‡(
svﬁ
->
max_vÆ
 == 1) {

731 
	`¢d_˘l_ñem_öfo_£t_ªad_wrôe
(
cöfo
, 1, 1);

732 
îr
 = 
	`¢d_˘l_add_boﬁón_ñem_£t
(
svﬁ
->
˘l
, 
cöfo
, 1, 
cou¡
);

734 
îr
 = 
	`¢d_˘l_add_öãgî_ñem_£t
(
svﬁ
->
˘l
, 
cöfo
, 1, 
cou¡
,

735 0, 
svﬁ
->
max_vÆ
, 0);

737 i‡(
îr
 < 0)

738  
îr
;

739 i‡(
svﬁ
->
max_vÆ
 == 1)

740 
def_vÆ
 = 1;

742 
	`add_év_öfo
(
svﬁ
, 
cöfo
, 
NULL
, 0);

745 
def_vÆ
 = 
svﬁ
->
zîo_dB_vÆ
 ? svﬁ->zîo_dB_vÆ : svﬁ->
max_vÆ
;

747 
i
 = 0; i < 
cou¡
; i++)

748 
svﬁ
->
ñem
.
vÆue
.
öãgî
.vÆue[
i
] = 
def_vÆ
;

749  
	`¢d_˘l_ñem_wrôe
(
svﬁ
->
˘l
, &svﬁ->
ñem
);

750 
	}
}

758 
	$so·vﬁ_lﬂd_c⁄åﬁ
(
¢d_pcm_t
 *
pcm
, 
¢d_pcm_so·vﬁ_t
 *
svﬁ
,

759 
˘l_ˇrd
, 
¢d_˘l_ñem_id_t
 *
˘l_id
,

760 
cch™√ls
, 
mö_dB
, 
max_dB
,

761 
ªsﬁuti⁄
)

763 
tmp_«me
[32];

764 
¢d_pcm_öfo_t
 
öfo
 = {0};

765 
¢d_˘l_ñem_öfo_t
 
cöfo
 = {0};

766 
îr
;

767 
i
;

769 i‡(
˘l_ˇrd
 < 0) {

770 
îr
 = 
	`¢d_pcm_öfo
(
pcm
, &
öfo
);

771 i‡(
îr
 < 0)

772  
îr
;

773 
˘l_ˇrd
 = 
	`¢d_pcm_öfo_gë_ˇrd
(&
öfo
);

774 i‡(
˘l_ˇrd
 < 0) {

775 
	`SNDERR
("No card defined for softvol control");

776  -
EINVAL
;

779 
	`•rötf
(
tmp_«me
, "hw:%d", 
˘l_ˇrd
);

780 
îr
 = 
	`¢d_˘l_›í
(&
svﬁ
->
˘l
, 
tmp_«me
, 0);

781 i‡(
îr
 < 0) {

782 
	`SNDERR
("C™nŸ o≥¿CTL %s", 
tmp_«me
);

783  
îr
;

786 
svﬁ
->
ñem
.
id
 = *
˘l_id
;

787 
svﬁ
->
max_vÆ
 = 
ªsﬁuti⁄
 - 1;

788 
svﬁ
->
mö_dB
 = min_dB;

789 
svﬁ
->
max_dB
 = max_dB;

790 i‡(
svﬁ
->
max_vÆ
 =1 || svﬁ->
max_dB
 =
ZERO_DB
)

791 
svﬁ
->
zîo_dB_vÆ
 = svﬁ->
max_vÆ
;

792 i‡(
svﬁ
->
max_dB
 < 0)

793 
svﬁ
->
zîo_dB_vÆ
 = 0;

795 
svﬁ
->
zîo_dB_vÆ
 = (
mö_dB
 / (mö_dB - 
max_dB
)) *

796 
svﬁ
->
max_vÆ
;

798 
	`¢d_˘l_ñem_öfo_£t_id
(&
cöfo
, 
˘l_id
);

799 i‡((
îr
 = 
	`¢d_˘l_ñem_öfo
(
svﬁ
->
˘l
, &
cöfo
)) < 0) {

800 i‡(
îr
 !-
ENOENT
) {

801 
	`SNDERR
("C™nŸ gë infÿf‹ CTL %s", 
tmp_«me
);

802  
îr
;

804 
îr
 = 
	`add_u£r_˘l
(
svﬁ
, &
cöfo
, 
cch™√ls
);

805 i‡(
îr
 < 0) {

806 
	`SNDERR
("Cannotáddá control");

807  
îr
;

810 i‡(! (
cöfo
.
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_USER
)) {

814 } i‡((
cöfo
.
ty≥
 !
SND_CTL_ELEM_TYPE_INTEGER
 &&

815 
cöfo
.
ty≥
 !
SND_CTL_ELEM_TYPE_BOOLEAN
) ||

816 
cöfo
.
cou¡
 !()
cch™√ls
 ||

817 
cöfo
.
vÆue
.
öãgî
.
mö
 != 0 ||

818 
cöfo
.
vÆue
.
öãgî
.
max
 !
svﬁ
->
max_vÆ
 ||

819 (
svﬁ
->
max_vÆ
 > 1 &&

820 (
cöfo
.
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_READ
) == 0) ||

821 (
svﬁ
->
max_vÆ
 < 2 &&

822 (
cöfo
.
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_READ
) != 0)) {

823 
îr
 = 
	`¢d_˘l_ñem_ªmove
(
svﬁ
->
˘l
, &
cöfo
.
id
);

824 i‡(
îr
 < 0) {

825 
	`SNDERR
("C⁄åﬁ %†mism©ch", 
tmp_«me
);

826  
îr
;

829 
	`¢d_˘l_ñem_öfo_˛ór
(&
cöfo
);

830 
	`¢d_˘l_ñem_öfo_£t_id
(&
cöfo
, 
˘l_id
);

831 i‡((
îr
 = 
	`add_u£r_˘l
(
svﬁ
, &
cöfo
, 
cch™√ls
)) < 0) {

832 
	`SNDERR
("Cannotáddá control");

833  
îr
;

835 } i‡(
svﬁ
->
max_vÆ
 > 1) {

837 
év
[4];

838 
îr
 = 
	`¢d_˘l_ñem_év_ªad
(
svﬁ
->
˘l
, &
cöfo
.
id
, 
év
,

839 (
év
));

840 
	`add_év_öfo
(
svﬁ
, &
cöfo
, 
év
, 
îr
 < 0 ? 0 : (tlv));

844 i‡(
svﬁ
->
max_vÆ
 == 1)

848 i‡(
mö_dB
 =
PRESET_MIN_DB
 && 
max_dB
 =
ZERO_DB
 &&

849 
ªsﬁuti⁄
 =
PRESET_RESOLUTION
)

850 
svﬁ
->
dB_vÆue
 = (*)
¥e£t_dB_vÆue
;

852 #i‚de‡
HAVE_SOFT_FLOAT


853 
svﬁ
->
dB_vÆue
 = 
	`ˇŒoc
(
ªsﬁuti⁄
, ());

854 i‡(! 
svﬁ
->
dB_vÆue
) {

855 
	`SNDERR
("cannotállocate dBÅable");

856  -
ENOMEM
;

858 
svﬁ
->
mö_dB
 = min_dB;

859 
svﬁ
->
max_dB
 = max_dB;

860 
i
 = 0; i <
svﬁ
->
max_vÆ
; i++) {

861 
db
 = 
svﬁ
->
mö_dB
 +

862 (
i
 * (
svﬁ
->
max_dB
 - svﬁ->
mö_dB
)) /

863 
svﬁ
->
max_vÆ
;

864 
v
 = (
	`pow
(10.0, 
db
 / 20.0) *

865 ()(1 << 
VOL_SCALE_SHIFT
));

866 
svﬁ
->
dB_vÆue
[
i
] = ()
v
;

868 i‡(
svﬁ
->
zîo_dB_vÆ
)

869 
svﬁ
->
dB_vÆue
[svﬁ->
zîo_dB_vÆ
] = 65535;

871 
	`SNDERR
("Cannot handleÅhe given dBÑangeándÑesolution");

872  -
EINVAL
;

876 
	}
}

878 c⁄° 
¢d_pcm_›s_t
 
	g¢d_pcm_so·vﬁ_›s
 = {

879 .
˛o£
 = 
¢d_pcm_so·vﬁ_˛o£
,

880 .
	göfo
 = 
¢d_pcm_gíîic_öfo
,

881 .
	ghw_ªföe
 = 
¢d_pcm_so·vﬁ_hw_ªföe
,

882 .
	ghw_∑øms
 = 
¢d_pcm_so·vﬁ_hw_∑øms
,

883 .
	ghw_‰ì
 = 
¢d_pcm_gíîic_hw_‰ì
,

884 .
	gsw_∑øms
 = 
¢d_pcm_gíîic_sw_∑øms
,

885 .
	gch™√l_öfo
 = 
¢d_pcm_gíîic_ch™√l_öfo
,

886 .
	gdump
 = 
¢d_pcm_so·vﬁ_dump
,

887 .
	gn⁄block
 = 
¢d_pcm_gíîic_n⁄block
,

888 .
	gasync
 = 
¢d_pcm_gíîic_async
,

889 .
	gmm≠
 = 
¢d_pcm_gíîic_mm≠
,

890 .
	gmunm≠
 = 
¢d_pcm_gíîic_munm≠
,

891 .
	gquîy_chm≠s
 = 
¢d_pcm_gíîic_quîy_chm≠s
,

892 .
	ggë_chm≠
 = 
¢d_pcm_gíîic_gë_chm≠
,

893 .
	g£t_chm≠
 = 
¢d_pcm_gíîic_£t_chm≠
,

914 
	$¢d_pcm_so·vﬁ_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

915 
¢d_pcm_f‹m©_t
 
sf‹m©
,

916 
˘l_ˇrd
, 
¢d_˘l_ñem_id_t
 *
˘l_id
,

917 
cch™√ls
,

918 
mö_dB
, 
max_dB
, 
ªsﬁuti⁄
,

919 
¢d_pcm_t
 *
¶ave
, 
˛o£_¶ave
)

921 
¢d_pcm_t
 *
pcm
;

922 
¢d_pcm_so·vﬁ_t
 *
svﬁ
;

923 
îr
;

924 
	`as£π
(
pcmp
 && 
¶ave
);

925 i‡(
sf‹m©
 !
SND_PCM_FORMAT_UNKNOWN
 &&

926 
sf‹m©
 !
SND_PCM_FORMAT_S16_LE
 &&

927 
sf‹m©
 !
SND_PCM_FORMAT_S16_BE
 &&

928 
sf‹m©
 !
SND_PCM_FORMAT_S24_3LE
 &&

929 
sf‹m©
 !
SND_PCM_FORMAT_S24_LE
 &&

930 
sf‹m©
 !
SND_PCM_FORMAT_S32_LE
 &&

931 
sf‹m©
 !
SND_PCM_FORMAT_S32_BE
)

932  -
EINVAL
;

933 
svﬁ
 = 
	`ˇŒoc
(1, (*svol));

934 i‡(! 
svﬁ
)

935  -
ENOMEM
;

936 
îr
 = 
	`so·vﬁ_lﬂd_c⁄åﬁ
(
¶ave
, 
svﬁ
, 
˘l_ˇrd
, 
˘l_id
, 
cch™√ls
,

937 
mö_dB
, 
max_dB
, 
ªsﬁuti⁄
);

938 i‡(
îr
 < 0) {

939 
	`so·vﬁ_‰ì
(
svﬁ
);

940  
îr
;

942 i‡(
îr
 > 0) {

943 
	`so·vﬁ_‰ì
(
svﬁ
);

944 *
pcmp
 = 
¶ave
;

945 i‡(!
¶ave
->
«me
 &&Çame)

946 
¶ave
->
«me
 = 
	`°rdup
(name);

951 
	`¢d_pcm_∂ugö_öô
(&
svﬁ
->
∂ug
);

952 
svﬁ
->
sf‹m©
 = sformat;

953 
svﬁ
->
cch™√ls
 = cchannels;

954 
svﬁ
->
∂ug
.
ªad
 = 
¢d_pcm_so·vﬁ_ªad_¨ós
;

955 
svﬁ
->
∂ug
.
wrôe
 = 
¢d_pcm_so·vﬁ_wrôe_¨ós
;

956 
svﬁ
->
∂ug
.
undo_ªad
 = 
¢d_pcm_∂ugö_undo_ªad_gíîic
;

957 
svﬁ
->
∂ug
.
undo_wrôe
 = 
¢d_pcm_∂ugö_undo_wrôe_gíîic
;

958 
svﬁ
->
∂ug
.
gí
.
¶ave
 = slave;

959 
svﬁ
->
∂ug
.
gí
.
˛o£_¶ave
 = close_slave;

961 
îr
 = 
	`¢d_pcm_√w
(&
pcm
, 
SND_PCM_TYPE_SOFTVOL
, 
«me
, 
¶ave
->
°ªam
, sœve->
mode
);

962 i‡(
îr
 < 0) {

963 
	`so·vﬁ_‰ì
(
svﬁ
);

964  
îr
;

966 
pcm
->
›s
 = &
¢d_pcm_so·vﬁ_›s
;

967 
pcm
->
Á°_›s
 = &
¢d_pcm_∂ugö_Á°_›s
;

968 
pcm
->
¥iv©e_d©a
 = 
svﬁ
;

969 
pcm
->
pﬁl_fd
 = 
¶ave
->poll_fd;

970 
pcm
->
pﬁl_evíts
 = 
¶ave
->poll_events;

976 
pcm
->
mm≠_shadow
 = 1;

977 
pcm
->
t°amp_ty≥
 = 
¶ave
->tstamp_type;

978 
	`¢d_pcm_£t_hw_±r
(
pcm
, &
svﬁ
->
∂ug
.
hw_±r
, -1, 0);

979 
	`¢d_pcm_£t_≠∂_±r
(
pcm
, &
svﬁ
->
∂ug
.
≠∂_±r
, -1, 0);

980 *
pcmp
 = 
pcm
;

983 
	}
}

985 
	$_¢d_pcm_∑r£_c⁄åﬁ_id
(
¢d_c⁄fig_t
 *
c⁄f
, 
¢d_˘l_ñem_id_t
 *
˘l_id
,

986 *
ˇrdp
, *
cch™√ls
)

988 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

989 
iÁ˚
 = 
SND_CTL_ELEM_IFACE_MIXER
;

990 c⁄° *
«me
 = 
NULL
;

991 
ödex
 = 0;

992 
devi˚
 = -1;

993 
subdevi˚
 = -1;

994 
îr
;

996 
	`as£π
(
˘l_id
 && 
ˇrdp
 && 
cch™√ls
);

998 *
ˇrdp
 = -1;

999 *
cch™√ls
 = 2;

1000 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1001 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1002 c⁄° *
id
;

1003 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1005 i‡(
	`°rcmp
(
id
, "comment") == 0)

1007 i‡(
	`°rcmp
(
id
, "card") == 0) {

1008 
îr
 = 
	`¢d_c⁄fig_gë_ˇrd
(
n
);

1009 i‡(
îr
 < 0)

1010 
_îr
;

1011 *
ˇrdp
 = 
îr
;

1014 i‡(
	`°rcmp
(
id
, "iface") == 0 || strcmp(id, "interface") == 0) {

1015 
îr
 = 
	`¢d_c⁄fig_gë_˘l_iÁ˚
(
n
);

1016 i‡(
îr
 < 0)

1017 
_îr
;

1018 
iÁ˚
 = 
îr
;

1021 i‡(
	`°rcmp
(
id
, "name") == 0) {

1022 i‡((
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
«me
)) < 0) {

1023 
	`SNDERR
("fõld %†i†nŸá såög", 
id
);

1024 
_îr
;

1028 i‡(
	`°rcmp
(
id
, "index") == 0) {

1029 i‡((
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
ödex
)) < 0) {

1030 
	`SNDERR
("fõld %†i†nŸá¿öãgî", 
id
);

1031 
_îr
;

1035 i‡(
	`°rcmp
(
id
, "device") == 0) {

1036 i‡((
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
devi˚
)) < 0) {

1037 
	`SNDERR
("fõld %†i†nŸá¿öãgî", 
id
);

1038 
_îr
;

1042 i‡(
	`°rcmp
(
id
, "subdevice") == 0) {

1043 i‡((
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
subdevi˚
)) < 0) {

1044 
	`SNDERR
("fõld %†i†nŸá¿öãgî", 
id
);

1045 
_îr
;

1049 i‡(
	`°rcmp
(
id
, "count") == 0) {

1050 
v
;

1051 i‡((
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
v
)) < 0) {

1052 
	`SNDERR
("fõld %†i†nŸá¿öãgî", 
id
);

1053 
_îr
;

1055 i‡(
v
 < 1 || v > 2) {

1056 
	`SNDERR
("InvÆid cou¡ %ld", 
v
);

1057 
_îr
;

1059 *
cch™√ls
 = 
v
;

1062 
	`SNDERR
("Unknow¿fõld %s", 
id
);

1063  -
EINVAL
;

1065 i‡(
«me
 =
NULL
) {

1066 
	`SNDERR
("Missing controlÇame");

1067 
îr
 = -
EINVAL
;

1068 
_îr
;

1070 i‡(
devi˚
 < 0)

1071 
devi˚
 = 0;

1072 i‡(
subdevi˚
 < 0)

1073 
subdevi˚
 = 0;

1075 
	`¢d_˘l_ñem_id_£t_öãrÁ˚
(
˘l_id
, 
iÁ˚
);

1076 
	`¢d_˘l_ñem_id_£t_«me
(
˘l_id
, 
«me
);

1077 
	`¢d_˘l_ñem_id_£t_ödex
(
˘l_id
, 
ödex
);

1078 
	`¢d_˘l_ñem_id_£t_devi˚
(
˘l_id
, 
devi˚
);

1079 
	`¢d_˘l_ñem_id_£t_subdevi˚
(
˘l_id
, 
subdevi˚
);

1083 
_îr
:

1084  
îr
;

1085 
	}
}

1150 
	$_¢d_pcm_so·vﬁ_›í
(
¢d_pcm_t
 **
pcmp
, c⁄° *
«me
,

1151 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
,

1152 
¢d_pcm_°ªam_t
 
°ªam
, 
mode
)

1154 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1155 
îr
;

1156 
¢d_pcm_t
 *
•cm
;

1157 
¢d_c⁄fig_t
 *
¶ave
 = 
NULL
, *
sc⁄f
;

1158 
¢d_c⁄fig_t
 *
c⁄åﬁ
 = 
NULL
;

1159 
¢d_pcm_f‹m©_t
 
sf‹m©
 = 
SND_PCM_FORMAT_UNKNOWN
;

1160 
¢d_˘l_ñem_id_t
 
˘l_id
 = {0};

1161 
ªsﬁuti⁄
 = 
PRESET_RESOLUTION
;

1162 
mö_dB
 = 
PRESET_MIN_DB
;

1163 
max_dB
 = 
ZERO_DB
;

1164 
ˇrd
 = -1, 
cch™√ls
 = 2;

1166 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

1167 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1168 c⁄° *
id
;

1169 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1171 i‡(
	`¢d_pcm_c⁄f_gíîic_id
(
id
))

1173 i‡(
	`°rcmp
(
id
, "slave") == 0) {

1174 
¶ave
 = 
n
;

1177 i‡(
	`°rcmp
(
id
, "control") == 0) {

1178 
c⁄åﬁ
 = 
n
;

1181 i‡(
	`°rcmp
(
id
, "resolution") == 0) {

1182 
v
;

1183 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
v
);

1184 i‡(
îr
 < 0) {

1185 
	`SNDERR
("InvalidÑesolution value");

1186  
îr
;

1188 
ªsﬁuti⁄
 = 
v
;

1191 i‡(
	`°rcmp
(
id
, "min_dB") == 0) {

1192 
îr
 = 
	`¢d_c⁄fig_gë_úól
(
n
, &
mö_dB
);

1193 i‡(
îr
 < 0) {

1194 
	`SNDERR
("Invalid min_dB value");

1195  
îr
;

1199 i‡(
	`°rcmp
(
id
, "max_dB") == 0) {

1200 
îr
 = 
	`¢d_c⁄fig_gë_úól
(
n
, &
max_dB
);

1201 i‡(
îr
 < 0) {

1202 
	`SNDERR
("Invalid max_dB value");

1203  
îr
;

1207 
	`SNDERR
("Unknow¿fõld %s", 
id
);

1208  -
EINVAL
;

1210 i‡(!
¶ave
) {

1211 
	`SNDERR
("slave isÇot defined");

1212  -
EINVAL
;

1214 i‡(!
c⁄åﬁ
) {

1215 
	`SNDERR
("control isÇot defined");

1216  -
EINVAL
;

1218 i‡(
mö_dB
 >= 0) {

1219 
	`SNDERR
("min_dB must beáÇegative value");

1220  -
EINVAL
;

1222 i‡(
max_dB
 <
mö_dB
 || max_dB > 
MAX_DB_UPPER_LIMIT
) {

1223 
	`SNDERR
("max_dB must beÜargerÅhan min_dBándÜessÅhan %d dB",

1224 
MAX_DB_UPPER_LIMIT
);

1225  -
EINVAL
;

1227 i‡(
ªsﬁuti⁄
 <= 1 ||Ñesolution > 1024) {

1228 
	`SNDERR
("InvÆidÑesﬁuti⁄ vÆuê%d", 
ªsﬁuti⁄
);

1229  -
EINVAL
;

1231 i‡(
mode
 & 
SND_PCM_NO_SOFTVOL
) {

1232 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 0);

1233 i‡(
îr
 < 0)

1234  
îr
;

1235 
îr
 = 
	`¢d_pcm_›í_«med_¶ave
(
pcmp
, 
«me
, 
roŸ
, 
sc⁄f
, 
°ªam
,

1236 
mode
, 
c⁄f
);

1237 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1239 
îr
 = 
	`¢d_pcm_¶ave_c⁄f
(
roŸ
, 
¶ave
, &
sc⁄f
, 1,

1240 
SND_PCM_HW_PARAM_FORMAT
, 0, &
sf‹m©
);

1241 i‡(
îr
 < 0)

1242  
îr
;

1243 i‡(
sf‹m©
 !
SND_PCM_FORMAT_UNKNOWN
 &&

1244 
sf‹m©
 !
SND_PCM_FORMAT_S16_LE
 &&

1245 
sf‹m©
 !
SND_PCM_FORMAT_S16_BE
 &&

1246 
sf‹m©
 !
SND_PCM_FORMAT_S24_3LE
 &&

1247 
sf‹m©
 !
SND_PCM_FORMAT_S24_LE
 &&

1248 
sf‹m©
 !
SND_PCM_FORMAT_S32_LE
 &&

1249 
sf‹m©
 !
SND_PCM_FORMAT_S32_BE
) {

1250 
	`SNDERR
("only S16_LE, S16_BE, S24_LE, S24_3LE, S32_LE or S32_BE format is supported");

1251 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1252  -
EINVAL
;

1254 
îr
 = 
	`¢d_pcm_›í_¶ave
(&
•cm
, 
roŸ
, 
sc⁄f
, 
°ªam
, 
mode
, 
c⁄f
);

1255 
	`¢d_c⁄fig_dñëe
(
sc⁄f
);

1256 i‡(
îr
 < 0)

1257  
îr
;

1258 
îr
 = 
	`_¢d_pcm_∑r£_c⁄åﬁ_id
(
c⁄åﬁ
, &
˘l_id
, &
ˇrd
, &
cch™√ls
);

1259 i‡(
îr
 < 0) {

1260 
	`¢d_pcm_˛o£
(
•cm
);

1261  
îr
;

1263 
îr
 = 
	`¢d_pcm_so·vﬁ_›í
(
pcmp
, 
«me
, 
sf‹m©
, 
ˇrd
, &
˘l_id
,

1264 
cch™√ls
, 
mö_dB
, 
max_dB
,

1265 
ªsﬁuti⁄
, 
•cm
, 1);

1266 i‡(
îr
 < 0)

1267 
	`¢d_pcm_˛o£
(
•cm
);

1269  
îr
;

1270 
	}
}

1271 #i‚de‡
DOC_HIDDEN


1272 
SND_DLSYM_BUILD_VERSION
(
_¢d_pcm_so·vﬁ_›í
, 
SND_PCM_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_symbols.c

21 #i‚de‡
PIC


23 
	~"c⁄fig.h
"

25 c⁄° *
_¢d_moduÀ_pcm_adpcm
;

26 c⁄° *
_¢d_moduÀ_pcm_Æaw
;

27 c⁄° *
_¢d_moduÀ_pcm_c›y
;

28 c⁄° *
_¢d_moduÀ_pcm_fûe
;

29 c⁄° *
_¢d_moduÀ_pcm_hooks
;

30 c⁄° *
_¢d_moduÀ_pcm_hw
;

31 c⁄° *
_¢d_moduÀ_pcm_löór
;

32 c⁄° *
_¢d_moduÀ_pcm_mëî
;

33 c⁄° *
_¢d_moduÀ_pcm_muœw
;

34 c⁄° *
_¢d_moduÀ_pcm_mu…i
;

35 c⁄° *
_¢d_moduÀ_pcm_nuŒ
;

36 c⁄° *
_¢d_moduÀ_pcm_em±y
;

37 c⁄° *
_¢d_moduÀ_pcm_∂ug
;

38 c⁄° *
_¢d_moduÀ_pcm_øã
;

39 c⁄° *
_¢d_moduÀ_pcm_rouã
;

40 c⁄° *
_¢d_moduÀ_pcm_sh¨e
;

41 c⁄° *
_¢d_moduÀ_pcm_shm
;

42 c⁄° *
_¢d_moduÀ_pcm_lÊﬂt
;

43 c⁄° *
_¢d_moduÀ_pcm_œd•a
;

44 c⁄° *
_¢d_moduÀ_pcm_dmix
;

45 c⁄° *
_¢d_moduÀ_pcm_d¢o›
;

46 c⁄° *
_¢d_moduÀ_pcm_dsh¨e
;

47 c⁄° *
_¢d_moduÀ_pcm_asym
;

48 c⁄° *
_¢d_moduÀ_pcm_õc958
;

49 c⁄° *
_¢d_moduÀ_pcm_so·vﬁ
;

50 c⁄° *
_¢d_moduÀ_pcm_exçlug
;

51 c⁄° *
_¢d_moduÀ_pcm_i›lug
;

52 c⁄° *
_¢d_moduÀ_pcm_mm≠_emul
;

54 c⁄° **
	g¢d_pcm_›í_obje˘s
[] = {

55 &
_¢d_moduÀ_pcm_hw
,

56 
	~"pcm_symbﬁs_li°.c
"

59 *
	$¢d_pcm_›í_symbﬁs
()

61  
¢d_pcm_›í_obje˘s
;

62 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/plugin_ops.h

22 #i‚de‡
SX_INLINES


23 
	#SX_INLINES


	)

24 
ölöe
 
uöt32_t
 
	$sx20
(
uöt32_t
 
x
)

26 if(
x
&0x00080000)

27  
x
|0xFFF00000;

28  
x
&0x000FFFFF;

29 
	}
}

30 
ölöe
 
uöt32_t
 
	$sx24
(
uöt32_t
 
x
)

32 if(
x
&0x00800000)

33  
x
|0xFF000000;

34  
x
&0x00FFFFFF;

35 
	}
}

36 
ölöe
 
uöt32_t
 
	$sx24s
(
uöt32_t
 
x
)

38 if(
x
&0x00008000)

39  
x
|0x000000FF;

40  
x
&0xFFFFFF00;

41 
	}
}

44 
	#as_u8
(
±r
Ë(*(
uöt8_t
*)’å))

	)

45 
	#as_u16
(
±r
Ë(*(
uöt16_t
*)’å))

	)

46 
	#as_u32
(
±r
Ë(*(
uöt32_t
*)’å))

	)

47 
	#as_u64
(
±r
Ë(*(
uöt64_t
*)’å))

	)

48 
	#as_s8
(
±r
Ë(*(
öt8_t
*)’å))

	)

49 
	#as_s16
(
±r
Ë(*(
öt16_t
*)’å))

	)

50 
	#as_s32
(
±r
Ë(*(
öt32_t
*)’å))

	)

51 
	#as_s64
(
±r
Ë(*(
öt64_t
*)’å))

	)

52 
	#as_Êﬂt
(
±r
Ë(*(
Êﬂt_t
*)’å))

	)

53 
	#as_doubÀ
(
±r
Ë(*(
doubÀ_t
*)’å))

	)

55 
	#as_u8c
(
±r
Ë(*(c⁄° 
uöt8_t
*)’å))

	)

56 
	#as_u16c
(
±r
Ë(*(c⁄° 
uöt16_t
*)’å))

	)

57 
	#as_u32c
(
±r
Ë(*(c⁄° 
uöt32_t
*)’å))

	)

58 
	#as_u64c
(
±r
Ë(*(c⁄° 
uöt64_t
*)’å))

	)

59 
	#as_s8c
(
±r
Ë(*(c⁄° 
öt8_t
*)’å))

	)

60 
	#as_s16c
(
±r
Ë(*(c⁄° 
öt16_t
*)’å))

	)

61 
	#as_s32c
(
±r
Ë(*(c⁄° 
öt32_t
*)’å))

	)

62 
	#as_s64c
(
±r
Ë(*(c⁄° 
öt64_t
*)’å))

	)

63 
	#as_Êﬂtc
(
±r
Ë(*(c⁄° 
Êﬂt_t
*)’å))

	)

64 
	#as_doubÀc
(
±r
Ë(*(c⁄° 
doubÀ_t
*)’å))

	)

66 
	#_gë_åùÀ_À
(
±r
Ë(*(
uöt8_t
*)’åË| (
uöt32_t
)*((uöt8_t*)’åË+ 1Ë<< 8 | (uöt32_t)*((uöt8_t*)’åË+ 2Ë<< 16)

	)

67 
	#_gë_åùÀ_be
(
±r
Ë((
uöt32_t
)*(
uöt8_t
*)’åË<< 16 | (uöt32_t)*((uöt8_t*)’åË+ 1Ë<< 8 | *((uöt8_t*)’åË+ 2))

	)

68 
	#_put_åùÀ_À
(
±r
,
vÆ
) do { \

69 
uöt8_t
 *
_tmp
 = (uöt8_à*)(
±r
); \

70 
uöt32_t
 
_vÆ
 = (
vÆ
); \

71 
_tmp
[0] = 
_vÆ
; \

72 
_tmp
[1] = 
_vÆ
 >> 8; \

73 
_tmp
[2] = 
_vÆ
 >> 16; \

74 } 0)

	)

75 
	#_put_åùÀ_be
(
±r
,
vÆ
) do { \

76 
uöt8_t
 *
_tmp
 = (uöt8_à*)(
±r
); \

77 
uöt32_t
 
_vÆ
 = (
vÆ
); \

78 
_tmp
[0] = 
_vÆ
 >> 16; \

79 
_tmp
[1] = 
_vÆ
 >> 8; \

80 
_tmp
[2] = 
_vÆ
; \

81 } 0)

	)

83 #ifde‡
SNDRV_LITTLE_ENDIAN


84 
	#_gë_åùÀ
(
±r
Ë
	`_gë_åùÀ_À
’å)

	)

85 
	#_gë_åùÀ_s
(
±r
Ë
	`_gë_åùÀ_be
’å)

	)

86 
	#_put_åùÀ
(
±r
,
vÆ
Ë
	`_put_åùÀ_À
’å,vÆ)

	)

87 
	#_put_åùÀ_s
(
±r
,
vÆ
Ë
	`_put_åùÀ_be
’å,vÆ)

	)

89 
	#_gë_åùÀ
(
±r
Ë
	`_gë_åùÀ_be
’å)

	)

90 
	#_gë_åùÀ_s
(
±r
Ë
	`_gë_åùÀ_À
’å)

	)

91 
	#_put_åùÀ
(
±r
,
vÆ
Ë
	`_put_åùÀ_be
’å,vÆ)

	)

92 
	#_put_åùÀ_s
(
±r
,
vÆ
Ë
	`_put_åùÀ_À
’å,vÆ)

	)

95 #ifde‡
CONV_LABELS


97 *c⁄° 
	gc⁄v_œbñs
[4 * 2 * 2 * 4 * 2] = {

98 &&
c⁄v_xxx1_xxx1
,

99 &&
c⁄v_xxx1_xxx1
,

100 &&
c⁄v_xxx1_xx10
,

101 &&
c⁄v_xxx1_xx01
,

102 &&
c⁄v_xxx1_x100
,

103 &&
c⁄v_xxx1_001x
,

104 &&
c⁄v_xxx1_1000
,

105 &&
c⁄v_xxx1_0001
,

106 &&
c⁄v_xxx1_xxx9
,

107 &&
c⁄v_xxx1_xxx9
,

108 &&
c⁄v_xxx1_xx90
,

109 &&
c⁄v_xxx1_xx09
,

110 &&
c⁄v_xxx1_x900
,

111 &&
c⁄v_xxx1_009x
,

112 &&
c⁄v_xxx1_9000
,

113 &&
c⁄v_xxx1_0009
,

114 &&
c⁄v_xxx1_xxx1
,

115 &&
c⁄v_xxx1_xxx1
,

116 &&
c⁄v_xxx1_xx10
,

117 &&
c⁄v_xxx1_xx01
,

118 &&
c⁄v_xxx1_x100
,

119 &&
c⁄v_xxx1_001x
,

120 &&
c⁄v_xxx1_1000
,

121 &&
c⁄v_xxx1_0001
,

122 &&
c⁄v_xxx1_xxx9
,

123 &&
c⁄v_xxx1_xxx9
,

124 &&
c⁄v_xxx1_xx90
,

125 &&
c⁄v_xxx1_xx09
,

126 &&
c⁄v_xxx1_x900
,

127 &&
c⁄v_xxx1_009x
,

128 &&
c⁄v_xxx1_9000
,

129 &&
c⁄v_xxx1_0009
,

130 &&
c⁄v_xx12_xxx1
,

131 &&
c⁄v_xx12_xxx1
,

132 &&
c⁄v_xx12_xx12
,

133 &&
c⁄v_xx12_xx21
,

134 &&
c⁄v_xx12_x120
,

135 &&
c⁄v_xx12_021x
,

136 &&
c⁄v_xx12_1200
,

137 &&
c⁄v_xx12_0021
,

138 &&
c⁄v_xx12_xxx9
,

139 &&
c⁄v_xx12_xxx9
,

140 &&
c⁄v_xx12_xx92
,

141 &&
c⁄v_xx12_xx29
,

142 &&
c⁄v_xx12_x920
,

143 &&
c⁄v_xx12_029x
,

144 &&
c⁄v_xx12_9200
,

145 &&
c⁄v_xx12_0029
,

146 &&
c⁄v_xx12_xxx2
,

147 &&
c⁄v_xx12_xxx2
,

148 &&
c⁄v_xx12_xx21
,

149 &&
c⁄v_xx12_xx12
,

150 &&
c⁄v_xx12_x210
,

151 &&
c⁄v_xx12_012x
,

152 &&
c⁄v_xx12_2100
,

153 &&
c⁄v_xx12_0012
,

154 &&
c⁄v_xx12_xxxA
,

155 &&
c⁄v_xx12_xxxA
,

156 &&
c⁄v_xx12_xxA1
,

157 &&
c⁄v_xx12_xx1A
,

158 &&
c⁄v_xx12_xA10
,

159 &&
c⁄v_xx12_01Ax
,

160 &&
c⁄v_xx12_A100
,

161 &&
c⁄v_xx12_001A
,

162 &&
c⁄v_x123_xxx1
,

163 &&
c⁄v_x123_xxx1
,

164 &&
c⁄v_x123_xx12
,

165 &&
c⁄v_x123_xx21
,

166 &&
c⁄v_x123_x123
,

167 &&
c⁄v_x123_321x
,

168 &&
c⁄v_x123_1230
,

169 &&
c⁄v_x123_0321
,

170 &&
c⁄v_x123_xxx9
,

171 &&
c⁄v_x123_xxx9
,

172 &&
c⁄v_x123_xx92
,

173 &&
c⁄v_x123_xx29
,

174 &&
c⁄v_x123_x923
,

175 &&
c⁄v_x123_329x
,

176 &&
c⁄v_x123_9230
,

177 &&
c⁄v_x123_0329
,

178 &&
c⁄v_123x_xxx3
,

179 &&
c⁄v_123x_xxx3
,

180 &&
c⁄v_123x_xx32
,

181 &&
c⁄v_123x_xx23
,

182 &&
c⁄v_123x_x321
,

183 &&
c⁄v_123x_123x
,

184 &&
c⁄v_123x_3210
,

185 &&
c⁄v_123x_0123
,

186 &&
c⁄v_123x_xxxB
,

187 &&
c⁄v_123x_xxxB
,

188 &&
c⁄v_123x_xxB2
,

189 &&
c⁄v_123x_xx2B
,

190 &&
c⁄v_123x_xB21
,

191 &&
c⁄v_123x_12Bx
,

192 &&
c⁄v_123x_B210
,

193 &&
c⁄v_123x_012B
,

194 &&
c⁄v_1234_xxx1
,

195 &&
c⁄v_1234_xxx1
,

196 &&
c⁄v_1234_xx12
,

197 &&
c⁄v_1234_xx21
,

198 &&
c⁄v_1234_x123
,

199 &&
c⁄v_1234_321x
,

200 &&
c⁄v_1234_1234
,

201 &&
c⁄v_1234_4321
,

202 &&
c⁄v_1234_xxx9
,

203 &&
c⁄v_1234_xxx9
,

204 &&
c⁄v_1234_xx92
,

205 &&
c⁄v_1234_xx29
,

206 &&
c⁄v_1234_x923
,

207 &&
c⁄v_1234_329x
,

208 &&
c⁄v_1234_9234
,

209 &&
c⁄v_1234_4329
,

210 &&
c⁄v_1234_xxx4
,

211 &&
c⁄v_1234_xxx4
,

212 &&
c⁄v_1234_xx43
,

213 &&
c⁄v_1234_xx34
,

214 &&
c⁄v_1234_x432
,

215 &&
c⁄v_1234_234x
,

216 &&
c⁄v_1234_4321
,

217 &&
c⁄v_1234_1234
,

218 &&
c⁄v_1234_xxxC
,

219 &&
c⁄v_1234_xxxC
,

220 &&
c⁄v_1234_xxC3
,

221 &&
c⁄v_1234_xx3C
,

222 &&
c⁄v_1234_xC32
,

223 &&
c⁄v_1234_23Cx
,

224 &&
c⁄v_1234_C321
,

225 &&
c⁄v_1234_123C
,

229 #ifde‡
CONV_END


231 
c⁄v_xxx1_xxx1
: 
	`as_u8
(
d°
Ë
	`as_u8c
(
§c
); 
CONV_END
;

232 
c⁄v_xxx1_xx10
: 
	`as_u16
(
d°
Ë(
uöt16_t
)
	`as_u8c
(
§c
Ë<< 8; 
CONV_END
;

233 
c⁄v_xxx1_xx01
: 
	`as_u16
(
d°
Ë(
uöt16_t
)
	`as_u8c
(
§c
); 
CONV_END
;

234 
c⁄v_xxx1_x100
: 
	`as_u32
(
d°
Ë
	`sx24
((
uöt32_t
)
	`as_u8c
(
§c
Ë<< 16); 
CONV_END
;

235 
c⁄v_xxx1_001x
: 
	`as_u32
(
d°
Ë
	`sx24s
((
uöt32_t
)
	`as_u8c
(
§c
Ë<< 8); 
CONV_END
;

236 
c⁄v_xxx1_1000
: 
	`as_u32
(
d°
Ë(
uöt32_t
)
	`as_u8c
(
§c
Ë<< 24; 
CONV_END
;

237 
c⁄v_xxx1_0001
: 
	`as_u32
(
d°
Ë(
uöt32_t
)
	`as_u8c
(
§c
); 
CONV_END
;

238 
c⁄v_xxx1_xxx9
: 
	`as_u8
(
d°
Ë
	`as_u8c
(
§c
Ë^ 0x80; 
CONV_END
;

239 
c⁄v_xxx1_xx90
: 
	`as_u16
(
d°
Ë(
uöt16_t
)(
	`as_u8c
(
§c
Ë^ 0x80Ë<< 8; 
CONV_END
;

240 
c⁄v_xxx1_xx09
: 
	`as_u16
(
d°
Ë(
uöt16_t
)(
	`as_u8c
(
§c
Ë^ 0x80); 
CONV_END
;

241 
c⁄v_xxx1_x900
: 
	`as_u32
(
d°
Ë
	`sx24
((
uöt32_t
)(
	`as_u8c
(
§c
Ë^ 0x80Ë<< 16); 
CONV_END
;

242 
c⁄v_xxx1_009x
: 
	`as_u32
(
d°
Ë
	`sx24s
((
uöt32_t
)(
	`as_u8c
(
§c
Ë^ 0x80Ë<< 8); 
CONV_END
;

243 
c⁄v_xxx1_9000
: 
	`as_u32
(
d°
Ë(
uöt32_t
)(
	`as_u8c
(
§c
Ë^ 0x80Ë<< 24; 
CONV_END
;

244 
c⁄v_xxx1_0009
: 
	`as_u32
(
d°
Ë(
uöt32_t
)(
	`as_u8c
(
§c
Ë^ 0x80); 
CONV_END
;

245 
c⁄v_xx12_xxx1
: 
	`as_u8
(
d°
Ë
	`as_u16c
(
§c
Ë>> 8; 
CONV_END
;

246 
c⁄v_xx12_xx12
: 
	`as_u16
(
d°
Ë
	`as_u16c
(
§c
); 
CONV_END
;

247 
c⁄v_xx12_xx21
: 
	`as_u16
(
d°
Ë
	`bsw≠_16
(
	`as_u16c
(
§c
)); 
CONV_END
;

248 
c⁄v_xx12_x120
: 
	`as_u32
(
d°
Ë
	`sx24
((
uöt32_t
)
	`as_u16c
(
§c
Ë<< 8); 
CONV_END
;

249 
c⁄v_xx12_021x
: 
	`as_u32
(
d°
Ë
	`sx24s
((
uöt32_t
)
	`bsw≠_16
(
	`as_u16c
(
§c
)Ë<< 8); 
CONV_END
;

250 
c⁄v_xx12_1200
: 
	`as_u32
(
d°
Ë(
uöt32_t
)
	`as_u16c
(
§c
Ë<< 16; 
CONV_END
;

251 
c⁄v_xx12_0021
: 
	`as_u32
(
d°
Ë(
uöt32_t
)
	`bsw≠_16
(
	`as_u16c
(
§c
)); 
CONV_END
;

252 
c⁄v_xx12_xxx9
: 
	`as_u8
(
d°
Ë(
	`as_u16c
(
§c
Ë>> 8Ë^ 0x80; 
CONV_END
;

253 
c⁄v_xx12_xx92
: 
	`as_u16
(
d°
Ë
	`as_u16c
(
§c
Ë^ 0x8000; 
CONV_END
;

254 
c⁄v_xx12_xx29
: 
	`as_u16
(
d°
Ë
	`bsw≠_16
(
	`as_u16c
(
§c
)Ë^ 0x80; 
CONV_END
;

255 
c⁄v_xx12_x920
: 
	`as_u32
(
d°
Ë
	`sx24
((
uöt32_t
)(
	`as_u16c
(
§c
Ë^ 0x8000Ë<< 8); 
CONV_END
;

256 
c⁄v_xx12_029x
: 
	`as_u32
(
d°
Ë
	`sx24s
((
uöt32_t
)(
	`bsw≠_16
(
	`as_u16c
(
§c
)Ë^ 0x80Ë<< 8); 
CONV_END
;

257 
c⁄v_xx12_9200
: 
	`as_u32
(
d°
Ë(
uöt32_t
)(
	`as_u16c
(
§c
Ë^ 0x8000Ë<< 16; 
CONV_END
;

258 
c⁄v_xx12_0029
: 
	`as_u32
(
d°
Ë(
uöt32_t
)(
	`bsw≠_16
(
	`as_u16c
(
§c
)Ë^ 0x80); 
CONV_END
;

259 
c⁄v_xx12_xxx2
: 
	`as_u8
(
d°
Ë
	`as_u16c
(
§c
Ë& 0xff; 
CONV_END
;

260 
c⁄v_xx12_x210
: 
	`as_u32
(
d°
Ë
	`sx24
((
uöt32_t
)
	`bsw≠_16
(
	`as_u16c
(
§c
)Ë<< 8); 
CONV_END
;

261 
c⁄v_xx12_012x
: 
	`as_u32
(
d°
Ë
	`sx24s
((
uöt32_t
)
	`as_u16c
(
§c
Ë<< 8); 
CONV_END
;

262 
c⁄v_xx12_2100
: 
	`as_u32
(
d°
Ë(
uöt32_t
)
	`bsw≠_16
(
	`as_u16c
(
§c
)Ë<< 16; 
CONV_END
;

263 
c⁄v_xx12_0012
: 
	`as_u32
(
d°
Ë(
uöt32_t
)
	`as_u16c
(
§c
); 
CONV_END
;

264 
c⁄v_xx12_xxxA
: 
	`as_u8
(
d°
Ë(
	`as_u16c
(
§c
Ë^ 0x80Ë& 0xff; 
CONV_END
;

265 
c⁄v_xx12_xxA1
: 
	`as_u16
(
d°
Ë
	`bsw≠_16
(
	`as_u16c
(
§c
Ë^ 0x80); 
CONV_END
;

266 
c⁄v_xx12_xx1A
: 
	`as_u16
(
d°
Ë
	`as_u16c
(
§c
Ë^ 0x80; 
CONV_END
;

267 
c⁄v_xx12_xA10
: 
	`as_u32
(
d°
Ë
	`sx24
((
uöt32_t
)
	`bsw≠_16
(
	`as_u16c
(
§c
Ë^ 0x80Ë<< 8); 
CONV_END
;

268 
c⁄v_xx12_01Ax
: 
	`as_u32
(
d°
Ë
	`sx24s
((
uöt32_t
)(
	`as_u16c
(
§c
Ë^ 0x80Ë<< 8); 
CONV_END
;

269 
c⁄v_xx12_A100
: 
	`as_u32
(
d°
Ë(
uöt32_t
)
	`bsw≠_16
(
	`as_u16c
(
§c
Ë^ 0x80Ë<< 16; 
CONV_END
;

270 
c⁄v_xx12_001A
: 
	`as_u32
(
d°
Ë(
uöt32_t
)(
	`as_u16c
(
§c
Ë^ 0x80); 
CONV_END
;

271 
c⁄v_x123_xxx1
: 
	`as_u8
(
d°
Ë
	`as_u32c
(
§c
Ë>> 16; 
CONV_END
;

272 
c⁄v_x123_xx12
: 
	`as_u16
(
d°
Ë
	`as_u32c
(
§c
Ë>> 8; 
CONV_END
;

273 
c⁄v_x123_xx21
: 
	`as_u16
(
d°
Ë
	`bsw≠_16
(
	`as_u32c
(
§c
Ë>> 8); 
CONV_END
;

274 
c⁄v_x123_x123
: 
	`as_u32
(
d°
Ë
	`sx24
(
	`as_u32c
(
§c
)); 
CONV_END
;

275 
c⁄v_x123_321x
: 
	`as_u32
(
d°
Ë
	`sx24s
(
	`bsw≠_32
(
	`as_u32c
(
§c
))); 
CONV_END
;

276 
c⁄v_x123_1230
: 
	`as_u32
(
d°
Ë
	`as_u32c
(
§c
Ë<< 8; 
CONV_END
;

277 
c⁄v_x123_0321
: 
	`as_u32
(
d°
Ë
	`bsw≠_32
(
	`as_u32c
(
§c
)Ë>> 8; 
CONV_END
;

278 
c⁄v_x123_xxx9
: 
	`as_u8
(
d°
Ë(
	`as_u32c
(
§c
Ë>> 16Ë^ 0x80; 
CONV_END
;

279 
c⁄v_x123_xx92
: 
	`as_u16
(
d°
Ë(
	`as_u32c
(
§c
Ë>> 8Ë^ 0x8000; 
CONV_END
;

280 
c⁄v_x123_xx29
: 
	`as_u16
(
d°
Ë
	`bsw≠_16
(
	`as_u32c
(
§c
Ë>> 8Ë^ 0x80; 
CONV_END
;

281 
c⁄v_x123_x923
: 
	`as_u32
(
d°
Ë
	`sx24
(
	`as_u32c
(
§c
Ë^ 0x800000); 
CONV_END
;

282 
c⁄v_x123_329x
: 
	`as_u32
(
d°
Ë
	`sx24s
(
	`bsw≠_32
(
	`as_u32c
(
§c
)Ë^ 0x8000); 
CONV_END
;

283 
c⁄v_x123_9230
: 
	`as_u32
(
d°
Ë(
	`as_u32c
(
§c
Ë^ 0x800000Ë<< 8; 
CONV_END
;

284 
c⁄v_x123_0329
: 
	`as_u32
(
d°
Ë(
	`bsw≠_32
(
	`as_u32c
(
§c
)Ë>> 8Ë^ 0x80; 
CONV_END
;

285 
c⁄v_123x_xxx3
: 
	`as_u8
(
d°
Ë(
	`as_u32c
(
§c
Ë>> 8Ë& 0xff; 
CONV_END
;

286 
c⁄v_123x_xx32
: 
	`as_u16
(
d°
Ë
	`bsw≠_16
(
	`as_u32c
(
§c
Ë>> 8); 
CONV_END
;

287 
c⁄v_123x_xx23
: 
	`as_u16
(
d°
Ë(
	`as_u32c
(
§c
Ë>> 8Ë& 0xffff; 
CONV_END
;

288 
c⁄v_123x_x321
: 
	`as_u32
(
d°
Ë
	`sx24
(
	`bsw≠_32
(
	`as_u32c
(
§c
))); 
CONV_END
;

289 
c⁄v_123x_123x
: 
	`as_u32
(
d°
Ë
	`sx24s
(
	`as_u32c
(
§c
)); 
CONV_END
;

290 
c⁄v_123x_3210
: 
	`as_u32
(
d°
Ë
	`bsw≠_32
(
	`as_u32c
(
§c
)Ë<< 8; 
CONV_END
;

291 
c⁄v_123x_0123
: 
	`as_u32
(
d°
Ë
	`as_u32c
(
§c
Ë>> 8; 
CONV_END
;

292 
c⁄v_123x_xxxB
: 
	`as_u8
(
d°
Ë((
	`as_u32c
(
§c
Ë>> 8Ë& 0xffË^ 0x80; 
CONV_END
;

293 
c⁄v_123x_xxB2
: 
	`as_u16
(
d°
Ë
	`bsw≠_16
((
	`as_u32c
(
§c
Ë>> 8Ë^ 0x80); 
CONV_END
;

294 
c⁄v_123x_xx2B
: 
	`as_u16
(
d°
Ë((
	`as_u32c
(
§c
Ë>> 8Ë& 0xffffË^ 0x80; 
CONV_END
;

295 
c⁄v_123x_xB21
: 
	`as_u32
(
d°
Ë
	`sx24
(
	`bsw≠_32
(
	`as_u32c
(
§c
)Ë^ 0x800000); 
CONV_END
;

296 
c⁄v_123x_12Bx
: 
	`as_u32
(
d°
Ë
	`sx24s
(
	`as_u32c
(
§c
Ë^ 0x8000); 
CONV_END
;

297 
c⁄v_123x_B210
: 
	`as_u32
(
d°
Ë
	`bsw≠_32
(
	`as_u32c
(
§c
Ë^ 0x8000Ë<< 8; 
CONV_END
;

298 
c⁄v_123x_012B
: 
	`as_u32
(
d°
Ë(
	`as_u32c
(
§c
Ë>> 8Ë^ 0x80; 
CONV_END
;

299 
c⁄v_1234_xxx1
: 
	`as_u8
(
d°
Ë
	`as_u32c
(
§c
Ë>> 24; 
CONV_END
;

300 
c⁄v_1234_xx12
: 
	`as_u16
(
d°
Ë
	`as_u32c
(
§c
Ë>> 16; 
CONV_END
;

301 
c⁄v_1234_xx21
: 
	`as_u16
(
d°
Ë
	`bsw≠_16
(
	`as_u32c
(
§c
Ë>> 16); 
CONV_END
;

302 
c⁄v_1234_x123
: 
	`as_u32
(
d°
Ë
	`sx24
(
	`as_u32c
(
§c
Ë>> 8); 
CONV_END
;

303 
c⁄v_1234_321x
: 
	`as_u32
(
d°
Ë
	`sx24s
(
	`bsw≠_32
(
	`as_u32c
(
§c
)Ë<< 8); 
CONV_END
;

304 
c⁄v_1234_1234
: 
	`as_u32
(
d°
Ë
	`as_u32c
(
§c
); 
CONV_END
;

305 
c⁄v_1234_4321
: 
	`as_u32
(
d°
Ë
	`bsw≠_32
(
	`as_u32c
(
§c
)); 
CONV_END
;

306 
c⁄v_1234_xxx9
: 
	`as_u8
(
d°
Ë(
	`as_u32c
(
§c
Ë>> 24Ë^ 0x80; 
CONV_END
;

307 
c⁄v_1234_xx92
: 
	`as_u16
(
d°
Ë(
	`as_u32c
(
§c
Ë>> 16Ë^ 0x8000; 
CONV_END
;

308 
c⁄v_1234_xx29
: 
	`as_u16
(
d°
Ë
	`bsw≠_16
(
	`as_u32c
(
§c
Ë>> 16Ë^ 0x80; 
CONV_END
;

309 
c⁄v_1234_x923
: 
	`as_u32
(
d°
Ë
	`sx24
((
	`as_u32c
(
§c
Ë>> 8Ë^ 0x800000); 
CONV_END
;

310 
c⁄v_1234_329x
: 
	`as_u32
(
d°
Ë
	`sx24s
((
	`bsw≠_32
(
	`as_u32c
(
§c
)Ë^ 0x80Ë<< 8); 
CONV_END
;

311 
c⁄v_1234_9234
: 
	`as_u32
(
d°
Ë
	`as_u32c
(
§c
Ë^ 0x80000000; 
CONV_END
;

312 
c⁄v_1234_4329
: 
	`as_u32
(
d°
Ë
	`bsw≠_32
(
	`as_u32c
(
§c
)Ë^ 0x80; 
CONV_END
;

313 
c⁄v_1234_xxx4
: 
	`as_u8
(
d°
Ë
	`as_u32c
(
§c
Ë& 0xff; 
CONV_END
;

314 
c⁄v_1234_xx43
: 
	`as_u16
(
d°
Ë
	`bsw≠_16
(
	`as_u32c
(
§c
)); 
CONV_END
;

315 
c⁄v_1234_xx34
: 
	`as_u16
(
d°
Ë
	`as_u32c
(
§c
Ë& 0xffff; 
CONV_END
;

316 
c⁄v_1234_x432
: 
	`as_u32
(
d°
Ë
	`sx24
(
	`bsw≠_32
(
	`as_u32c
(
§c
)Ë>> 8); 
CONV_END
;

317 
c⁄v_1234_234x
: 
	`as_u32
(
d°
Ë
	`sx24s
(
	`as_u32c
(
§c
Ë<< 8); 
CONV_END
;

318 
c⁄v_1234_xxxC
: 
	`as_u8
(
d°
Ë(
	`as_u32c
(
§c
Ë& 0xffË^ 0x80; 
CONV_END
;

319 
c⁄v_1234_xxC3
: 
	`as_u16
(
d°
Ë
	`bsw≠_16
(
	`as_u32c
(
§c
Ë^ 0x80); 
CONV_END
;

320 
c⁄v_1234_xx3C
: 
	`as_u16
(
d°
Ë(
	`as_u32c
(
§c
Ë& 0xffffË^ 0x80; 
CONV_END
;

321 
c⁄v_1234_xC32
: 
	`as_u32
(
d°
Ë
	`sx24
((
	`bsw≠_32
(
	`as_u32c
(
§c
)Ë>> 8Ë^ 0x800000); 
CONV_END
;

322 
c⁄v_1234_23Cx
: 
	`as_u32
(
d°
Ë
	`sx24s
((
	`as_u32c
(
§c
Ë^ 0x80Ë<< 8); 
CONV_END
;

323 
c⁄v_1234_C321
: 
	`as_u32
(
d°
Ë
	`bsw≠_32
(
	`as_u32c
(
§c
Ë^ 0x80); 
CONV_END
;

324 
c⁄v_1234_123C
: 
	`as_u32
(
d°
Ë
	`as_u32c
(
§c
Ë^ 0x80; 
CONV_END
;

325 
	}
}

328 #ifde‡
GET16_LABELS


330 *c⁄° 
	ggë16_œbñs
[5 * 2 * 2 + 4 * 3] = {

331 &&
gë16_1_10
,

332 &&
gë16_1_90
,

333 &&
gë16_1_10
,

334 &&
gë16_1_90
,

335 &&
gë16_12_12
,

336 &&
gë16_12_92
,

337 &&
gë16_12_21
,

338 &&
gë16_12_A1
,

340 &&
gë16_0123_12
,

341 &&
gë16_0123_92
,

342 &&
gë16_1230_32
,

343 &&
gë16_1230_B2
,

344 &&
gë16_1234_12
,

345 &&
gë16_1234_92
,

346 &&
gë16_1234_43
,

347 &&
gë16_1234_C3
,

348 &&
gë16_0123_12_20
,

349 &&
gë16_0123_92_20
,

350 &&
gë16_1230_32_20
,

351 &&
gë16_1230_B2_20
,

353 &&
gë16_123_12
,

354 &&
gë16_123_92
,

355 &&
gë16_123_32
,

356 &&
gë16_123_B2
,

357 &&
gë16_123_12_20
,

358 &&
gë16_123_92_20
,

359 &&
gë16_123_32_20
,

360 &&
gë16_123_B2_20
,

361 &&
gë16_123_12_18
,

362 &&
gë16_123_92_18
,

363 &&
gë16_123_32_18
,

364 &&
gë16_123_B2_18
,

368 #ifde‡
GET16_END


370 
gë16_1_10
: 
ßm∂e
 = (
uöt16_t
)
	`as_u8c
(
§c
Ë<< 8; 
GET16_END
;

371 
gë16_1_90
: 
ßm∂e
 = (
uöt16_t
)(
	`as_u8c
(
§c
Ë^ 0x80Ë<< 8; 
GET16_END
;

372 
gë16_12_12
: 
ßm∂e
 = 
	`as_u16c
(
§c
); 
GET16_END
;

373 
gë16_12_92
: 
ßm∂e
 = 
	`as_u16c
(
§c
Ë^ 0x8000; 
GET16_END
;

374 
gë16_12_21
: 
ßm∂e
 = 
	`bsw≠_16
(
	`as_u16c
(
§c
)); 
GET16_END
;

375 
gë16_12_A1
: 
ßm∂e
 = 
	`bsw≠_16
(
	`as_u16c
(
§c
Ë^ 0x80); 
GET16_END
;

376 
gë16_0123_12
: 
ßm∂e
 = 
	`as_u32c
(
§c
Ë>> 8; 
GET16_END
;

377 
gë16_0123_92
: 
ßm∂e
 = (
	`as_u32c
(
§c
Ë>> 8Ë^ 0x8000; 
GET16_END
;

378 
gë16_1230_32
: 
ßm∂e
 = 
	`bsw≠_16
(
	`as_u32c
(
§c
Ë>> 8); 
GET16_END
;

379 
gë16_1230_B2
: 
ßm∂e
 = 
	`bsw≠_16
((
	`as_u32c
(
§c
Ë>> 8Ë^ 0x80); 
GET16_END
;

380 
gë16_1234_12
: 
ßm∂e
 = 
	`as_u32c
(
§c
Ë>> 16; 
GET16_END
;

381 
gë16_1234_92
: 
ßm∂e
 = (
	`as_u32c
(
§c
Ë>> 16Ë^ 0x8000; 
GET16_END
;

382 
gë16_1234_43
: 
ßm∂e
 = 
	`bsw≠_16
(
	`as_u32c
(
§c
)); 
GET16_END
;

383 
gë16_1234_C3
: 
ßm∂e
 = 
	`bsw≠_16
(
	`as_u32c
(
§c
Ë^ 0x80); 
GET16_END
;

384 
gë16_0123_12_20
: 
ßm∂e
 = 
	`as_u32c
(
§c
Ë>> 4; 
GET16_END
;

385 
gë16_0123_92_20
: 
ßm∂e
 = (
	`as_u32c
(
§c
Ë>> 4Ë^ 0x8000; 
GET16_END
;

386 
gë16_1230_32_20
: 
ßm∂e
 = 
	`bsw≠_32
(
	`as_u32c
(
§c
)Ë>> 4; 
GET16_END
;

387 
gë16_1230_B2_20
: 
ßm∂e
 = (
	`bsw≠_32
(
	`as_u32c
(
§c
)Ë>> 4Ë^ 0x8000; 
GET16_END
;

388 
gë16_123_12
: 
ßm∂e
 = 
	`_gë_åùÀ
(
§c
Ë>> 8; 
GET16_END
;

389 
gë16_123_92
: 
ßm∂e
 = (
	`_gë_åùÀ
(
§c
Ë>> 8Ë^ 0x8000; 
GET16_END
;

390 
gë16_123_32
: 
ßm∂e
 = 
	`_gë_åùÀ_s
(
§c
Ë>> 8; 
GET16_END
;

391 
gë16_123_B2
: 
ßm∂e
 = (
	`_gë_åùÀ_s
(
§c
Ë>> 8Ë^ 0x8000; 
GET16_END
;

392 
gë16_123_12_20
: 
ßm∂e
 = 
	`_gë_åùÀ
(
§c
Ë>> 4; 
GET16_END
;

393 
gë16_123_92_20
: 
ßm∂e
 = (
	`_gë_åùÀ
(
§c
Ë>> 4Ë^ 0x8000; 
GET16_END
;

394 
gë16_123_32_20
: 
ßm∂e
 = 
	`_gë_åùÀ_s
(
§c
Ë>> 4; 
GET16_END
;

395 
gë16_123_B2_20
: 
ßm∂e
 = (
	`_gë_åùÀ_s
(
§c
Ë>> 4Ë^ 0x8000; 
GET16_END
;

396 
gë16_123_12_18
: 
ßm∂e
 = 
	`_gë_åùÀ
(
§c
Ë>> 2; 
GET16_END
;

397 
gë16_123_92_18
: 
ßm∂e
 = (
	`_gë_åùÀ
(
§c
Ë>> 2Ë^ 0x8000; 
GET16_END
;

398 
gë16_123_32_18
: 
ßm∂e
 = 
	`_gë_åùÀ_s
(
§c
Ë>> 2; 
GET16_END
;

399 
gë16_123_B2_18
: 
ßm∂e
 = (
	`_gë_åùÀ_s
(
§c
Ë>> 2Ë^ 0x8000; 
GET16_END
;

400 
	}
}

403 #ifde‡
PUT16_LABELS


405 *c⁄° 
	gput16_œbñs
[5 * 2 * 2 + 4 * 3] = {

406 &&
put16_12_1
,

407 &&
put16_12_9
,

408 &&
put16_12_1
,

409 &&
put16_12_9
,

410 &&
put16_12_12
,

411 &&
put16_12_92
,

412 &&
put16_12_21
,

413 &&
put16_12_29
,

415 &&
put16_12_0120
,

416 &&
put16_12_0920
,

417 &&
put16_12_0210
,

418 &&
put16_12_0290
,

419 &&
put16_12_1200
,

420 &&
put16_12_9200
,

421 &&
put16_12_0021
,

422 &&
put16_12_0029
,

423 &&
put16_12_0120_20
,

424 &&
put16_12_0920_20
,

425 &&
put16_12_0210_20
,

426 &&
put16_12_0290_20
,

428 &&
put16_12_120
,

429 &&
put16_12_920
,

430 &&
put16_12_021
,

431 &&
put16_12_029
,

432 &&
put16_12_120_20
,

433 &&
put16_12_920_20
,

434 &&
put16_12_021_20
,

435 &&
put16_12_029_20
,

436 &&
put16_12_120_18
,

437 &&
put16_12_920_18
,

438 &&
put16_12_021_18
,

439 &&
put16_12_029_18
,

443 #ifde‡
PUT16_END


445 
put16_12_1
: 
	`as_u8
(
d°
Ë
ßm∂e
 >> 8; 
PUT16_END
;

446 
put16_12_9
: 
	`as_u8
(
d°
Ë(
ßm∂e
 >> 8Ë^ 0x80; 
PUT16_END
;

447 
put16_12_12
: 
	`as_u16
(
d°
Ë
ßm∂e
; 
PUT16_END
;

448 
put16_12_92
: 
	`as_u16
(
d°
Ë
ßm∂e
 ^ 0x8000; 
PUT16_END
;

449 
put16_12_21
: 
	`as_u16
(
d°
Ë
	`bsw≠_16
(
ßm∂e
); 
PUT16_END
;

450 
put16_12_29
: 
	`as_u16
(
d°
Ë
	`bsw≠_16
(
ßm∂e
Ë^ 0x80; 
PUT16_END
;

451 
put16_12_0120
: 
	`as_u32
(
d°
Ë
	`sx24
((
uöt32_t
)
ßm∂e
 << 8); 
PUT16_END
;

452 
put16_12_0920
: 
	`as_u32
(
d°
Ë
	`sx24
((
uöt32_t
)(
ßm∂e
 ^ 0x8000Ë<< 8); 
PUT16_END
;

453 
put16_12_0210
: 
	`as_u32
(
d°
Ë
	`sx24s
((
uöt32_t
)
	`bsw≠_16
(
ßm∂e
Ë<< 8); 
PUT16_END
;

454 
put16_12_0290
: 
	`as_u32
(
d°
Ë
	`sx24s
((
uöt32_t
)(
	`bsw≠_16
(
ßm∂e
Ë^ 0x80Ë<< 8); 
PUT16_END
;

455 
put16_12_1200
: 
	`as_u32
(
d°
Ë(
uöt32_t
)
ßm∂e
 << 16; 
PUT16_END
;

456 
put16_12_9200
: 
	`as_u32
(
d°
Ë(
uöt32_t
)(
ßm∂e
 ^ 0x8000Ë<< 16; 
PUT16_END
;

457 
put16_12_0021
: 
	`as_u32
(
d°
Ë(
uöt32_t
)
	`bsw≠_16
(
ßm∂e
); 
PUT16_END
;

458 
put16_12_0029
: 
	`as_u32
(
d°
Ë(
uöt32_t
)
	`bsw≠_16
(
ßm∂e
Ë^ 0x80; 
PUT16_END
;

459 
put16_12_0120_20
: 
	`as_u32
(
d°
Ë
	`sx20
((
uöt32_t
)
ßm∂e
 << 4); 
PUT16_END
;

460 
put16_12_0920_20
: 
	`as_u32
(
d°
Ë
	`sx20
((
uöt32_t
)(
ßm∂e
 ^ 0x8000Ë<< 4); 
PUT16_END
;

461 
put16_12_0210_20
: 
	`as_u32
(
d°
Ë
	`bsw≠_32
(
	`sx20
((
uöt32_t
)
ßm∂e
 << 4)); 
PUT16_END
;

462 
put16_12_0290_20
: 
	`as_u32
(
d°
Ë
	`bsw≠_32
(
	`sx20
((
uöt32_t
)(
ßm∂e
 ^ 0x8000Ë<< 4)); 
PUT16_END
;

463 
put16_12_120
: 
	`_put_åùÀ
(
d°
, (
uöt32_t
)
ßm∂e
 << 8); 
PUT16_END
;

464 
put16_12_920
: 
	`_put_åùÀ
(
d°
, (
uöt32_t
)(
ßm∂e
 ^ 0x8000Ë<< 8); 
PUT16_END
;

465 
put16_12_021
: 
	`_put_åùÀ_s
(
d°
, (
uöt32_t
)
ßm∂e
 << 8); 
PUT16_END
;

466 
put16_12_029
: 
	`_put_åùÀ_s
(
d°
, (
uöt32_t
)(
ßm∂e
 ^ 0x8000Ë<< 8); 
PUT16_END
;

467 
put16_12_120_20
: 
	`_put_åùÀ
(
d°
, (
uöt32_t
)
ßm∂e
 << 4); 
PUT16_END
;

468 
put16_12_920_20
: 
	`_put_åùÀ
(
d°
, (
uöt32_t
)(
ßm∂e
 ^ 0x8000Ë<< 4); 
PUT16_END
;

469 
put16_12_021_20
: 
	`_put_åùÀ_s
(
d°
, (
uöt32_t
)
ßm∂e
 << 4); 
PUT16_END
;

470 
put16_12_029_20
: 
	`_put_åùÀ_s
(
d°
, (
uöt32_t
)(
ßm∂e
 ^ 0x8000Ë<< 4); 
PUT16_END
;

471 
put16_12_120_18
: 
	`_put_åùÀ
(
d°
, (
uöt32_t
)
ßm∂e
 << 2); 
PUT16_END
;

472 
put16_12_920_18
: 
	`_put_åùÀ
(
d°
, (
uöt32_t
)(
ßm∂e
 ^ 0x8000Ë<< 2); 
PUT16_END
;

473 
put16_12_021_18
: 
	`_put_åùÀ_s
(
d°
, (
uöt32_t
)
ßm∂e
 << 2); 
PUT16_END
;

474 
put16_12_029_18
: 
	`_put_åùÀ_s
(
d°
, (
uöt32_t
)(
ßm∂e
 ^ 0x8000Ë<< 2); 
PUT16_END
;

475 
	}
}

478 #ifde‡
CONV24_LABELS


479 
	#GET32_LABELS


	)

480 
	#PUT32_LABELS


	)

483 #ifde‡
GET32_LABELS


485 *c⁄° 
	ggë32_œbñs
[5 * 2 * 2 + 4 * 3] = {

486 &&
gë32_1_1000
,

487 &&
gë32_1_9000
,

488 &&
gë32_1_1000
,

489 &&
gë32_1_9000
,

490 &&
gë32_12_1200
,

491 &&
gë32_12_9200
,

492 &&
gë32_12_2100
,

493 &&
gë32_12_A100
,

495 &&
gë32_0123_1230
,

496 &&
gë32_0123_9230
,

497 &&
gë32_1230_3210
,

498 &&
gë32_1230_B210
,

499 &&
gë32_1234_1234
,

500 &&
gë32_1234_9234
,

501 &&
gë32_1234_4321
,

502 &&
gë32_1234_C321
,

503 &&
gë32_0123_1230_20
,

504 &&
gë32_0123_9230_20
,

505 &&
gë32_1230_3210_20
,

506 &&
gë32_1230_B210_20
,

508 &&
gë32_123_1230
,

509 &&
gë32_123_9230
,

510 &&
gë32_123_3210
,

511 &&
gë32_123_B210
,

512 &&
gë32_123_1230_20
,

513 &&
gë32_123_9230_20
,

514 &&
gë32_123_3210_20
,

515 &&
gë32_123_B210_20
,

516 &&
gë32_123_1230_18
,

517 &&
gë32_123_9230_18
,

518 &&
gë32_123_3210_18
,

519 &&
gë32_123_B210_18
,

523 #ifde‡
CONV24_END


524 
	#GET32_END
 
__c⁄v24_gë


	)

527 #ifde‡
GET32_END


529 
gë32_1_1000
: 
ßm∂e
 = (
uöt32_t
)
	`as_u8c
(
§c
Ë<< 24; 
GET32_END
;

530 
gë32_1_9000
: 
ßm∂e
 = (
uöt32_t
)(
	`as_u8c
(
§c
Ë^ 0x80Ë<< 24; 
GET32_END
;

531 
gë32_12_1200
: 
ßm∂e
 = (
uöt32_t
)
	`as_u16c
(
§c
Ë<< 16; 
GET32_END
;

532 
gë32_12_9200
: 
ßm∂e
 = (
uöt32_t
)(
	`as_u16c
(
§c
Ë^ 0x8000Ë<< 16; 
GET32_END
;

533 
gë32_12_2100
: 
ßm∂e
 = (
uöt32_t
)
	`bsw≠_16
(
	`as_u16c
(
§c
)Ë<< 16; 
GET32_END
;

534 
gë32_12_A100
: 
ßm∂e
 = (
uöt32_t
)
	`bsw≠_16
(
	`as_u16c
(
§c
Ë^ 0x80Ë<< 16; 
GET32_END
;

535 
gë32_0123_1230
: 
ßm∂e
 = 
	`as_u32c
(
§c
Ë<< 8; 
GET32_END
;

536 
gë32_0123_9230
: 
ßm∂e
 = (
	`as_u32c
(
§c
Ë<< 8Ë^ 0x80000000; 
GET32_END
;

537 
gë32_1230_3210
: 
ßm∂e
 = 
	`bsw≠_32
(
	`as_u32c
(
§c
Ë>> 8); 
GET32_END
;

538 
gë32_1230_B210
: 
ßm∂e
 = 
	`bsw≠_32
((
	`as_u32c
(
§c
Ë>> 8Ë^ 0x80); 
GET32_END
;

539 
gë32_1234_1234
: 
ßm∂e
 = 
	`as_u32c
(
§c
); 
GET32_END
;

540 
gë32_1234_9234
: 
ßm∂e
 = 
	`as_u32c
(
§c
Ë^ 0x80000000; 
GET32_END
;

541 
gë32_1234_4321
: 
ßm∂e
 = 
	`bsw≠_32
(
	`as_u32c
(
§c
)); 
GET32_END
;

542 
gë32_1234_C321
: 
ßm∂e
 = 
	`bsw≠_32
(
	`as_u32c
(
§c
Ë^ 0x80); 
GET32_END
;

543 
gë32_0123_1230_20
: 
ßm∂e
 = 
	`as_u32c
(
§c
Ë<< 12; 
GET32_END
;

544 
gë32_0123_9230_20
: 
ßm∂e
 = (
	`as_u32c
(
§c
Ë<< 12Ë^ 0x80000000; 
GET32_END
;

545 
gë32_1230_3210_20
: 
ßm∂e
 = 
	`bsw≠_32
(
	`as_u32c
(
§c
)Ë<< 12; 
GET32_END
;

546 
gë32_1230_B210_20
: 
ßm∂e
 = (
	`bsw≠_32
(
	`as_u32c
(
§c
)Ë<< 12Ë^ 0x80000000; 
GET32_END
;

547 
gë32_123_1230
: 
ßm∂e
 = 
	`_gë_åùÀ
(
§c
Ë<< 8; 
GET32_END
;

548 
gë32_123_9230
: 
ßm∂e
 = (
	`_gë_åùÀ
(
§c
Ë<< 8Ë^ 0x80000000; 
GET32_END
;

549 
gë32_123_3210
: 
ßm∂e
 = 
	`_gë_åùÀ_s
(
§c
Ë<< 8; 
GET32_END
;

550 
gë32_123_B210
: 
ßm∂e
 = (
	`_gë_åùÀ_s
(
§c
Ë<< 8Ë^ 0x80000000; 
GET32_END
;

551 
gë32_123_1230_20
: 
ßm∂e
 = 
	`_gë_åùÀ
(
§c
Ë<< 12; 
GET32_END
;

552 
gë32_123_9230_20
: 
ßm∂e
 = (
	`_gë_åùÀ
(
§c
Ë<< 12Ë^ 0x80000000; 
GET32_END
;

553 
gë32_123_3210_20
: 
ßm∂e
 = 
	`_gë_åùÀ_s
(
§c
Ë<< 12; 
GET32_END
;

554 
gë32_123_B210_20
: 
ßm∂e
 = (
	`_gë_åùÀ_s
(
§c
Ë<< 12Ë^ 0x80000000; 
GET32_END
;

555 
gë32_123_1230_18
: 
ßm∂e
 = 
	`_gë_åùÀ
(
§c
Ë<< 14; 
GET32_END
;

556 
gë32_123_9230_18
: 
ßm∂e
 = (
	`_gë_åùÀ
(
§c
Ë<< 14Ë^ 0x80000000; 
GET32_END
;

557 
gë32_123_3210_18
: 
ßm∂e
 = 
	`_gë_åùÀ_s
(
§c
Ë<< 14; 
GET32_END
;

558 
gë32_123_B210_18
: 
ßm∂e
 = (
	`_gë_åùÀ_s
(
§c
Ë<< 14Ë^ 0x80000000; 
GET32_END
;

559 
	}
}

562 #ifde‡
CONV24_END


563 
	g__c⁄v24_gë
: *
put
;

564 
	#PUT32_END
 
CONV24_END


	)

567 #ifde‡
PUT32_LABELS


569 *c⁄° 
	gput32_œbñs
[5 * 2 * 2 + 4 * 3] = {

570 &&
put32_1234_1
,

571 &&
put32_1234_9
,

572 &&
put32_1234_1
,

573 &&
put32_1234_9
,

574 &&
put32_1234_12
,

575 &&
put32_1234_92
,

576 &&
put32_1234_21
,

577 &&
put32_1234_29
,

579 &&
put32_1234_0123
,

580 &&
put32_1234_0923
,

581 &&
put32_1234_3210
,

582 &&
put32_1234_3290
,

583 &&
put32_1234_1234
,

584 &&
put32_1234_9234
,

585 &&
put32_1234_4321
,

586 &&
put32_1234_4329
,

587 &&
put32_1234_0123_20
,

588 &&
put32_1234_0923_20
,

589 &&
put32_1234_3210_20
,

590 &&
put32_1234_3290_20
,

592 &&
put32_1234_123
,

593 &&
put32_1234_923
,

594 &&
put32_1234_321
,

595 &&
put32_1234_329
,

596 &&
put32_1234_123_20
,

597 &&
put32_1234_923_20
,

598 &&
put32_1234_321_20
,

599 &&
put32_1234_329_20
,

600 &&
put32_1234_123_18
,

601 &&
put32_1234_923_18
,

602 &&
put32_1234_321_18
,

603 &&
put32_1234_329_18
,

607 #ifde‡
CONV24_LABELS


608 #unde‡
GET32_LABELS


609 #unde‡
PUT32_LABELS


612 #ifde‡
PUT32_END


614 
put32_1234_1
: 
	`as_u8
(
d°
Ë
ßm∂e
 >> 24; 
PUT32_END
;

615 
put32_1234_9
: 
	`as_u8
(
d°
Ë(
ßm∂e
 >> 24Ë^ 0x80; 
PUT32_END
;

616 
put32_1234_12
: 
	`as_u16
(
d°
Ë
ßm∂e
 >> 16; 
PUT32_END
;

617 
put32_1234_92
: 
	`as_u16
(
d°
Ë(
ßm∂e
 >> 16Ë^ 0x8000; 
PUT32_END
;

618 
put32_1234_21
: 
	`as_u16
(
d°
Ë
	`bsw≠_16
(
ßm∂e
 >> 16); 
PUT32_END
;

619 
put32_1234_29
: 
	`as_u16
(
d°
Ë
	`bsw≠_16
(
ßm∂e
 >> 16Ë^ 0x80; 
PUT32_END
;

620 
put32_1234_0123
: 
	`as_u32
(
d°
Ë
	`sx24
(
ßm∂e
 >> 8); 
PUT32_END
;

621 
put32_1234_0923
: 
	`as_u32
(
d°
Ë
	`sx24
((
ßm∂e
 >> 8Ë^ 0x800000); 
PUT32_END
;

622 
put32_1234_3210
: 
	`as_u32
(
d°
Ë
	`sx24s
(
	`bsw≠_32
(
ßm∂e
Ë<< 8); 
PUT32_END
;

623 
put32_1234_3290
: 
	`as_u32
(
d°
Ë
	`sx24s
((
	`bsw≠_32
(
ßm∂e
Ë^ 0x80Ë<< 8); 
PUT32_END
;

624 
put32_1234_1234
: 
	`as_u32
(
d°
Ë
ßm∂e
; 
PUT32_END
;

625 
put32_1234_9234
: 
	`as_u32
(
d°
Ë
ßm∂e
 ^ 0x80000000; 
PUT32_END
;

626 
put32_1234_4321
: 
	`as_u32
(
d°
Ë
	`bsw≠_32
(
ßm∂e
); 
PUT32_END
;

627 
put32_1234_4329
: 
	`as_u32
(
d°
Ë
	`bsw≠_32
(
ßm∂e
Ë^ 0x80; 
PUT32_END
;

628 
put32_1234_0123_20
: 
	`as_u32
(
d°
Ë
	`sx20
(
ßm∂e
 >> 12); 
PUT32_END
;

629 
put32_1234_0923_20
: 
	`as_u32
(
d°
Ë
	`sx20
((
ßm∂e
 ^ 0x80000000Ë>> 12); 
PUT32_END
;

630 
put32_1234_3210_20
: 
	`as_u32
(
d°
Ë
	`bsw≠_32
(
	`sx20
(
ßm∂e
 >> 12)); 
PUT32_END
;

631 
put32_1234_3290_20
: 
	`as_u32
(
d°
Ë
	`bsw≠_32
(
	`sx20
((
ßm∂e
 ^ 0x80000000Ë>> 12)); 
PUT32_END
;

632 
put32_1234_123
: 
	`_put_åùÀ
(
d°
, 
ßm∂e
 >> 8); 
PUT32_END
;

633 
put32_1234_923
: 
	`_put_åùÀ
(
d°
, (
ßm∂e
 ^ 0x80000000Ë>> 8); 
PUT32_END
;

634 
put32_1234_321
: 
	`_put_åùÀ_s
(
d°
, 
ßm∂e
 >> 8); 
PUT32_END
;

635 
put32_1234_329
: 
	`_put_åùÀ_s
(
d°
, (
ßm∂e
 ^ 0x80000000Ë>> 8); 
PUT32_END
;

636 
put32_1234_123_20
: 
	`_put_åùÀ
(
d°
, 
ßm∂e
 >> 12); 
PUT32_END
;

637 
put32_1234_923_20
: 
	`_put_åùÀ
(
d°
, (
ßm∂e
 ^ 0x80000000Ë>> 12); 
PUT32_END
;

638 
put32_1234_321_20
: 
	`_put_åùÀ_s
(
d°
, 
ßm∂e
 >> 12); 
PUT32_END
;

639 
put32_1234_329_20
: 
	`_put_åùÀ_s
(
d°
, (
ßm∂e
 ^ 0x80000000Ë>> 12); 
PUT32_END
;

640 
put32_1234_123_18
: 
	`_put_åùÀ
(
d°
, 
ßm∂e
 >> 14); 
PUT32_END
;

641 
put32_1234_923_18
: 
	`_put_åùÀ
(
d°
, (
ßm∂e
 ^ 0x80000000Ë>> 14); 
PUT32_END
;

642 
put32_1234_321_18
: 
	`_put_åùÀ_s
(
d°
, 
ßm∂e
 >> 14); 
PUT32_END
;

643 
put32_1234_329_18
: 
	`_put_åùÀ_s
(
d°
, (
ßm∂e
 ^ 0x80000000Ë>> 14); 
PUT32_END
;

644 
	}
}

647 #ifde‡
CONV24_END


648 #unde‡
GET32_END


649 #unde‡
PUT32_END


652 #ifde‡
PUT32F_LABELS


654 *c⁄° 
	gput32Êﬂt_œbñs
[2 * 2] = {

655 &&
put32f_1234_1234F
,

656 &&
put32f_1234_4321F
,

657 &&
put32f_1234_1234D
,

658 &&
put32f_1234_4321D
,

662 #ifde‡
PUT32F_END


663 
	gput32f_1234_1234F
: 
as_Êﬂt
(
d°
Ë(
Êﬂt_t
)((
öt32_t
)
ßm∂e
Ë/ (Êﬂt_t)0x80000000UL; 
	gPUT32F_END
;

664 
	gput32f_1234_4321F
: 
tmp_Êﬂt
.
f
 = (
Êﬂt_t
)((
öt32_t
)
ßm∂e
) / (float_t)0x80000000UL;

665 
as_u32
(
d°
Ë
bsw≠_32
(
tmp_Êﬂt
.
i
); 
	gPUT32F_END
;

666 
	gput32f_1234_1234D
: 
as_doubÀ
(
d°
Ë(
doubÀ_t
)((
öt32_t
)
ßm∂e
Ë/ (doubÀ_t)0x80000000UL; 
	gPUT32F_END
;

667 
	gput32f_1234_4321D
: 
tmp_doubÀ
.
d
 = (
doubÀ_t
)((
öt32_t
)
ßm∂e
) / (double_t)0x80000000UL;

668 
as_u64
(
d°
Ë
bsw≠_64
(
tmp_doubÀ
.
l
); 
	gPUT32F_END
;

671 #ifde‡
GET32F_LABELS


673 *c⁄° 
	ggë32Êﬂt_œbñs
[2 * 2] = {

674 &&
gë32f_1234F_1234
,

675 &&
gë32f_4321F_1234
,

676 &&
gë32f_1234D_1234
,

677 &&
gë32f_4321D_1234
,

681 #ifde‡
GET32F_END


682 
	ggë32f_1234F_1234
: 
tmp_Êﬂt
.
f
 = 
as_Êﬂtc
(
§c
);

683 i‡(
	gtmp_Êﬂt
.
	gf
 >= 1.0)

684 
ßm∂e
 = 0x7fffffff;

685 i‡(
	gtmp_Êﬂt
.
	gf
 <= -1.0)

686 
ßm∂e
 = 0x80000000;

688 
	gßm∂e
 = (
öt32_t
)(
tmp_Êﬂt
.
f
 * (
Êﬂt_t
)0x80000000UL);

689 
	gGET32F_END
;

690 
	ggë32f_4321F_1234
: 
tmp_Êﬂt
.
i
 = 
bsw≠_32
(
as_u32c
(
§c
));

691 i‡(
	gtmp_Êﬂt
.
	gf
 >= 1.0)

692 
ßm∂e
 = 0x7fffffff;

693 i‡(
	gtmp_Êﬂt
.
	gf
 <= -1.0)

694 
ßm∂e
 = 0x80000000;

696 
	gßm∂e
 = (
öt32_t
)(
tmp_Êﬂt
.
f
 * (
Êﬂt_t
)0x80000000UL);

697 
	gGET32F_END
;

698 
	ggë32f_1234D_1234
: 
tmp_doubÀ
.
d
 = 
as_doubÀc
(
§c
);

699 i‡(
	gtmp_doubÀ
.
	gd
 >= 1.0)

700 
ßm∂e
 = 0x7fffffff;

701 i‡(
	gtmp_doubÀ
.
	gd
 <= -1.0)

702 
ßm∂e
 = 0x80000000;

704 
	gßm∂e
 = (
öt32_t
)(
tmp_doubÀ
.
d
 * (
doubÀ_t
)0x80000000UL);

705 
	gGET32F_END
;

706 
	ggë32f_4321D_1234
: 
tmp_doubÀ
.
l
 = 
bsw≠_64
(
as_u64c
(
§c
));

707 i‡(
	gtmp_doubÀ
.
	gd
 >= 1.0)

708 
ßm∂e
 = 0x7fffffff;

709 i‡(
	gtmp_doubÀ
.
	gd
 <= -1.0)

710 
ßm∂e
 = 0x80000000;

712 
	gßm∂e
 = (
öt32_t
)(
tmp_doubÀ
.
d
 * (
doubÀ_t
)0x80000000UL);

713 
	gGET32F_END
;

716 #unde‡
as_u8


717 #unde‡
as_u16


718 #unde‡
as_u32


719 #unde‡
as_s8


720 #unde‡
as_s16


721 #unde‡
as_s32


722 #unde‡
as_Êﬂt


723 #unde‡
as_doubÀ


725 #unde‡
as_u8c


726 #unde‡
as_u16c


727 #unde‡
as_u32c


728 #unde‡
as_s8c


729 #unde‡
as_s16c


730 #unde‡
as_s32c


731 #unde‡
as_Êﬂtc


732 #unde‡
as_doubÀc


734 #unde‡
_gë_åùÀ


735 #unde‡
_gë_åùÀ_s


736 #unde‡
_gë_åùÀ_À


737 #unde‡
_gë_åùÀ_be


738 #unde‡
_put_åùÀ


739 #unde‡
_put_åùÀ_s


740 #unde‡
_put_åùÀ_À


741 #unde‡
_put_åùÀ_be


	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/scopes/level.c

21 
	~<cur£s.h
>

22 
	~<î∫o.h
>

23 
	~<Æß/asoundlib.h
>

25 
	#BAR_WIDTH
 70

	)

27 
	#DECAY_MS
 400

	)

29 
	#PEAK_MS
 800

	)

31 
	s_¢d_pcm_sc›e_Àvñ_ch™√l
 {

32 
öt16_t
 
	mÀvñ
;

33 
öt16_t
 
	m≥ak
;

34 
	m≥ak_age
;

35 } 
	t¢d_pcm_sc›e_Àvñ_ch™√l_t
;

37 
	s_¢d_pcm_sc›e_Àvñ
 {

38 
¢d_pcm_t
 *
	mpcm
;

39 
¢d_pcm_sc›e_t
 *
	ms16
;

40 
¢d_pcm_sc›e_Àvñ_ch™√l_t
 *
	mch™√ls
;

41 
¢d_pcm_u‰ames_t
 
	mﬁd
;

42 
	mt›
;

43 
WINDOW
 *
	mwö
;

44 
	mb¨_width
;

45 
	mdeˇy_ms
;

46 
	m≥ak_ms
;

47 } 
	t¢d_pcm_sc›e_Àvñ_t
;

49 
	$Àvñ_íabÀ
(
¢d_pcm_sc›e_t
 *
sc›e
)

51 
¢d_pcm_sc›e_Àvñ_t
 *
Àvñ
 = 
	`¢d_pcm_sc›e_gë_ˇŒback_¥iv©e
(
sc›e
);

52 
y
, 
x
;

53 
Àvñ
->
ch™√ls
 = 
	`ˇŒoc
(
	`¢d_pcm_mëî_gë_ch™√ls
÷evñ->
pcm
), (*level->channels));

54 i‡(!
Àvñ
->
ch™√ls
) {

55 
	`‰ì
(
Àvñ
);

56  -
ENOMEM
;

58 
	`¢d_pcm_sc›e_£t_ˇŒback_¥iv©e
(
sc›e
, 
Àvñ
);

59 
Àvñ
->
wö
 = 
	`öôs¸
();

60 
	`wösdñ 
(
Àvñ
->
wö
, 
	`¢d_pcm_mëî_gë_ch™√ls
÷evñ->
pcm
));

61 
	`gëyx
(
Àvñ
->
wö
, 
y
, 
x
);

62 
Àvñ
->
t›
 = 
y
;

64 
	}
}

66 
	$Àvñ_dißbÀ
(
¢d_pcm_sc›e_t
 *
sc›e
)

68 
¢d_pcm_sc›e_Àvñ_t
 *
Àvñ
 = 
	`¢d_pcm_sc›e_gë_ˇŒback_¥iv©e
(
sc›e
);

69 
	`ídwö
();

70 
	`‰ì
(
Àvñ
->
ch™√ls
);

71 
	}
}

73 
	$Àvñ_˛o£
(
¢d_pcm_sc›e_t
 *
sc›e
)

75 
¢d_pcm_sc›e_Àvñ_t
 *
Àvñ
 = 
	`¢d_pcm_sc›e_gë_ˇŒback_¥iv©e
(
sc›e
);

76 
	`‰ì
(
Àvñ
);

77 
	}
}

79 
	$Àvñ_°¨t
(
¢d_pcm_sc›e_t
 *
sc›e
 
ATTRIBUTE_UNUSED
)

81 
	}
}

83 
	$Àvñ_°›
(
¢d_pcm_sc›e_t
 *
sc›e
)

85 
¢d_pcm_sc›e_Àvñ_t
 *
Àvñ
 = 
	`¢d_pcm_sc›e_gë_ˇŒback_¥iv©e
(
sc›e
);

86 
c
;

87 
c
 = 0; c < 
	`¢d_pcm_mëî_gë_ch™√ls
(
Àvñ
->
pcm
); c++) {

88 
	`move
(
Àvñ
->
t›
 + 
c
, 0);

89 
	`˛π€ﬁ
();

91 
	`move
(
Àvñ
->
t›
, 0);

92 
	`ª‰esh
();

93 
	}
}

95 
	$Àvñ_upd©e
(
¢d_pcm_sc›e_t
 *
sc›e
)

97 
¢d_pcm_sc›e_Àvñ_t
 *
Àvñ
 = 
	`¢d_pcm_sc›e_gë_ˇŒback_¥iv©e
(
sc›e
);

98 
¢d_pcm_t
 *
pcm
 = 
Àvñ
->pcm;

99 
¢d_pcm_s‰ames_t
 
size
;

100 
¢d_pcm_u‰ames_t
 
size1
, 
size2
;

101 
¢d_pcm_u‰ames_t
 
off£t
, 
c⁄t
;

102 
c
, 
ch™√ls
;

103 
ms
;

104 
b¨
[256] = { [0 ... 255] = '#' };

105 
max_deˇy
;

106 
size
 = 
	`¢d_pcm_mëî_gë_now
(
pcm
Ë- 
Àvñ
->
ﬁd
;

107 i‡(
size
 < 0)

108 
size
 +
	`¢d_pcm_mëî_gë_bound¨y
(
pcm
);

109 
off£t
 = 
Àvñ
->
ﬁd
 % 
	`¢d_pcm_mëî_gë_bufsize
(
pcm
);

110 
c⁄t
 = 
	`¢d_pcm_mëî_gë_bufsize
(
pcm
Ë- 
off£t
;

111 
size1
 = 
size
;

112 i‡(
size1
 > 
c⁄t
)

113 
size1
 = 
c⁄t
;

114 
size2
 = 
size
 - 
size1
;

115 
ms
 = 
size
 * 1000 / 
	`¢d_pcm_mëî_gë_øã
(
pcm
);

116 
max_deˇy
 = 32768 * 
ms
 / 
Àvñ
->
deˇy_ms
;

117 
ch™√ls
 = 
	`¢d_pcm_mëî_gë_ch™√ls
(
pcm
);

118 
c
 = 0; c < 
ch™√ls
; c++) {

119 
öt16_t
 *
±r
;

120 
s
, 
Àv
 = 0;

121 
¢d_pcm_u‰ames_t
 
n
;

122 
¢d_pcm_sc›e_Àvñ_ch™√l_t
 *
l
;

123 
Àv_pos
, 
≥ak_pos
;

124 
l
 = &
Àvñ
->
ch™√ls
[
c
];

125 
±r
 = 
	`¢d_pcm_sc›e_s16_gë_ch™√l_buf„r
(
Àvñ
->
s16
, 
c
Ë+ 
off£t
;

126 
n
 = 
size1
;Ç > 0;Ç--) {

127 
s
 = *
±r
;

128 i‡(
s
 < 0)

129 
s
 = -s;

130 i‡(
s
 > 
Àv
)

131 
Àv
 = 
s
;

132 
±r
++;

134 
±r
 = 
	`¢d_pcm_sc›e_s16_gë_ch™√l_buf„r
(
Àvñ
->
s16
, 
c
);

135 
n
 = 
size2
;Ç > 0;Ç--) {

136 
s
 = *
±r
;

137 i‡(
s
 < 0)

138 
s
 = -s;

139 i‡(
s
 > 
Àv
)

140 
Àv
 = 
s
;

141 
±r
++;

143 
l
->
Àvñ
 = 
Àv
;

144 
l
->
≥ak_age
 +
ms
;

145 i‡(
l
->
≥ak_age
 >
Àvñ
->
≥ak_ms
 ||

146 
Àv
 >
l
->
≥ak
) {

147 
l
->
≥ak
 = 
Àv
;

148 
l
->
≥ak_age
 = 0;

150 i‡(
Àv
 < 
l
->
Àvñ
 - 
max_deˇy
)

151 
Àv
 = 
l
->
Àvñ
 - 
max_deˇy
;

152 
	`move
(
Àvñ
->
t›
 + 
c
, 0);

153 
Àv_pos
 = 
Àv
 * 
Àvñ
->
b¨_width
 / 32768;

154 
≥ak_pos
 = 
l
->
≥ak
 * 
Àvñ
->
b¨_width
 / 32768;

155 
	`addn°r
(
b¨
, 
Àv_pos
);

156 
	`˛π€ﬁ
();

157 
	`mvaddch
(
Àvñ
->
t›
 + 
c
, 
≥ak_pos
 - 1, '#');

159 
	`move
(
Àvñ
->
t›
, 0);

160 
	`ª‰esh
();

161 
Àvñ
->
ﬁd
 = 
	`¢d_pcm_mëî_gë_now
(
pcm
);

162 
	}
}

164 
	$Àvñ_ª£t
(
¢d_pcm_sc›e_t
 *
sc›e
)

166 
¢d_pcm_sc›e_Àvñ_t
 *
Àvñ
 = 
	`¢d_pcm_sc›e_gë_ˇŒback_¥iv©e
(
sc›e
);

167 
¢d_pcm_t
 *
pcm
 = 
Àvñ
->pcm;

168 
	`mem£t
(
Àvñ
->
ch™√ls
, 0, 
	`¢d_pcm_mëî_gë_ch™√ls
(
pcm
) * (*level->channels));

169 
Àvñ
->
ﬁd
 = 
	`¢d_pcm_mëî_gë_now
(
pcm
);

170 
	}
}

172 
¢d_pcm_sc›e_›s_t
 
	gÀvñ_›s
 = {

173 .
íabÀ
 = 
Àvñ_íabÀ
,

174 .
	gdißbÀ
 = 
Àvñ_dißbÀ
,

175 .
	g˛o£
 = 
Àvñ_˛o£
,

176 .
	g°¨t
 = 
Àvñ_°¨t
,

177 .
	g°›
 = 
Àvñ_°›
,

178 .
	gupd©e
 = 
Àvñ_upd©e
,

179 .
	gª£t
 = 
Àvñ_ª£t
,

182 
	$¢d_pcm_sc›e_Àvñ_›í
(
¢d_pcm_t
 *
pcm
, c⁄° *
«me
,

183 
b¨_width
, 
deˇy_ms
,

184 
≥ak_ms
,

185 
¢d_pcm_sc›e_t
 **
sc›ï
)

187 
¢d_pcm_sc›e_t
 *
sc›e
, *
s16
;

188 
¢d_pcm_sc›e_Àvñ_t
 *
Àvñ
;

189 
îr
 = 
	`¢d_pcm_sc›e_mÆloc
(&
sc›e
);

190 i‡(
îr
 < 0)

191  
îr
;

192 
Àvñ
 = 
	`ˇŒoc
(1, (*level));

193 i‡(!
Àvñ
) {

194 
	`‰ì
(
sc›e
);

195  -
ENOMEM
;

197 
Àvñ
->
pcm
 =Öcm;

198 
Àvñ
->
b¨_width
 = bar_width;

199 
Àvñ
->
deˇy_ms
 = decay_ms;

200 
Àvñ
->
≥ak_ms
 =Öeak_ms;

201 
s16
 = 
	`¢d_pcm_mëî_£¨ch_sc›e
(
pcm
, "s16");

202 i‡(!
s16
) {

203 
îr
 = 
	`¢d_pcm_sc›e_s16_›í
(
pcm
, "s16", &
s16
);

204 i‡(
îr
 < 0) {

205 
	`‰ì
(
sc›e
);

206 
	`‰ì
(
Àvñ
);

207  
îr
;

210 
Àvñ
->
s16
 = s16;

211 
	`¢d_pcm_sc›e_£t_›s
(
sc›e
, &
Àvñ_›s
);

212 
	`¢d_pcm_sc›e_£t_ˇŒback_¥iv©e
(
sc›e
, 
Àvñ
);

213 i‡(
«me
)

214 
	`¢d_pcm_sc›e_£t_«me
(
sc›e
, 
	`°rdup
(
«me
));

215 
	`¢d_pcm_mëî_add_sc›e
(
pcm
, 
sc›e
);

216 *
sc›ï
 = 
sc›e
;

218 
	}
}

220 
	$_¢d_pcm_sc›e_Àvñ_›í
(
¢d_pcm_t
 *
pcm
, c⁄° *
«me
,

221 
¢d_c⁄fig_t
 *
roŸ
, snd_c⁄fig_à*
c⁄f
)

223 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

224 
¢d_pcm_sc›e_t
 *
sc›e
;

225 
b¨_width
 = -1, 
deˇy_ms
 = -1, 
≥ak_ms
 = -1;

226 
îr
;

227 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

228 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

229 c⁄° *
id
;

230 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

232 i‡(
	`°rcmp
(
id
, "comment") == 0)

234 i‡(
	`°rcmp
(
id
, "type") == 0)

236 i‡(
	`°rcmp
(
id
, "bar_width") == 0) {

237 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
b¨_width
);

238 i‡(
îr
 < 0) {

239 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

240  -
EINVAL
;

244 i‡(
	`°rcmp
(
id
, "decay_ms") == 0) {

245 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
deˇy_ms
);

246 i‡(
îr
 < 0) {

247 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

248  -
EINVAL
;

252 i‡(
	`°rcmp
(
id
, "peak_ms") == 0) {

253 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
≥ak_ms
);

254 i‡(
îr
 < 0) {

255 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

256  -
EINVAL
;

260 
	`SNDERR
("Unknow¿fõld %s", 
id
);

261  -
EINVAL
;

263 i‡(
b¨_width
 < 0)

264 
b¨_width
 = 
BAR_WIDTH
;

265 i‡(
deˇy_ms
 < 0)

266 
deˇy_ms
 = 
DECAY_MS
;

267 i‡(
≥ak_ms
 < 0)

268 
≥ak_ms
 = 
PEAK_MS
;

269  
	`¢d_pcm_sc›e_Àvñ_›í
(
pcm
, 
«me
, 
b¨_width
, 
deˇy_ms
, 
≥ak_ms
,

270 &
sc›e
);

271 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi.c

147 
	~"øwmidi_loˇl.h
"

148 
	~<°dio.h
>

149 
	~<°dlib.h
>

150 
	~<°d¨g.h
>

151 
	~<uni°d.h
>

152 
	~<°rög.h
>

160 
	$¢d_øwmidi_∑øms_deÁu…
(
¢d_øwmidi_t
 *
øwmidi
, 
¢d_øwmidi_∑øms_t
 *
∑øms
)

162 
	`as£π
(
øwmidi
);

163 
	`as£π
(
∑øms
);

164 
∑øms
->
buf„r_size
 = 
	`∑ge_size
();

165 
∑øms
->
avaû_mö
 = 1;

166 
∑øms
->
no_a˘ive_£nsög
 = 1;

167 
∑øms
->
mode
 = 0;

168 
	`mem£t
(
∑øms
->
ª£rved
, 0, (params->reserved));

170 
	}
}

172 
	$¢d_øwmidi_›í_c⁄f
(
¢d_øwmidi_t
 **
öpuç
, snd_øwmidi_à**
ouçuç
,

173 c⁄° *
«me
, 
¢d_c⁄fig_t
 *
øwmidi_roŸ
,

174 
¢d_c⁄fig_t
 *
øwmidi_c⁄f
, 
mode
)

176 c⁄° *
°r
;

177 
buf
[256];

178 
îr
;

179 
¢d_c⁄fig_t
 *
c⁄f
, *
ty≥_c⁄f
 = 
NULL
;

180 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

181 
¢d_øwmidi_∑øms_t
 
∑øms
;

182 c⁄° *
id
;

183 c⁄° *
lib
 = 
NULL
, *
›í_«me
 = NULL;

184 (*
›í_func
)(
¢d_øwmidi_t
 **, snd_rawmidi_t **,

185 c⁄° *, 
¢d_c⁄fig_t
 *, snd_c⁄fig_à*, Ë
NULL
;

186 #i‚de‡
PIC


187 *
	`¢d_øwmidi_›í_symbﬁs
();

189 i‡(
	`¢d_c⁄fig_gë_ty≥
(
øwmidi_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

190 i‡(
«me
)

191 
	`SNDERR
("InvÆidÅy≥ f‹ RAWMIDI %†deföôi⁄", 
«me
);

193 
	`SNDERR
("InvalidÅype for RAWMIDI definition");

194  -
EINVAL
;

196 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
øwmidi_c⁄f
, "ty≥", &
c⁄f
);

197 i‡(
îr
 < 0) {

198 
	`SNDERR
("type isÇot defined");

199  
îr
;

201 
îr
 = 
	`¢d_c⁄fig_gë_id
(
c⁄f
, &
id
);

202 i‡(
îr
 < 0) {

203 
	`SNDERR
("unableÅo get id");

204  
îr
;

206 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
c⁄f
, &
°r
);

207 i‡(
îr
 < 0) {

208 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

209  
îr
;

211 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
øwmidi_roŸ
, "øwmidi_ty≥", 
°r
, &
ty≥_c⁄f
);

212 i‡(
îr
 >= 0) {

213 i‡(
	`¢d_c⁄fig_gë_ty≥
(
ty≥_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

214 
	`SNDERR
("InvÆidÅy≥ f‹ RAWMIDIÅy≥ %†deföôi⁄", 
°r
);

215 
îr
 = -
EINVAL
;

216 
_îr
;

218 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
ty≥_c⁄f
) {

219 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

220 c⁄° *
id
;

221 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

223 i‡(
	`°rcmp
(
id
, "comment") == 0)

225 i‡(
	`°rcmp
(
id
, "lib") == 0) {

226 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
lib
);

227 i‡(
îr
 < 0) {

228 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

229 
_îr
;

233 i‡(
	`°rcmp
(
id
, "open") == 0) {

234 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
›í_«me
);

235 i‡(
îr
 < 0) {

236 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

237 
_îr
;

241 
	`SNDERR
("Unknow¿fõld %s", 
id
);

242 
îr
 = -
EINVAL
;

243 
_îr
;

246 i‡(!
›í_«me
) {

247 
›í_«me
 = 
buf
;

248 
	`¢¥ötf
(
buf
, (buf), "_¢d_øwmidi_%s_›í", 
°r
);

250 #i‚de‡
PIC


251 
	`¢d_øwmidi_›í_symbﬁs
();

253 
›í_func
 = 
	`¢d_dlobj_ˇche_gë2
(
lib
, 
›í_«me
,

254 
	`SND_DLSYM_VERSION
(
SND_RAWMIDI_DLSYM_VERSION
), 1);

255 i‡(!
›í_func
) {

256 
îr
 = -
ENXIO
;

257 
_îr
;

259 i‡(
ty≥_c⁄f
)

260 
	`¢d_c⁄fig_dñëe
(
ty≥_c⁄f
);

261 
îr
 = 
	`›í_func
(
öpuç
, 
ouçuç
, 
«me
, 
øwmidi_roŸ
, 
øwmidi_c⁄f
, 
mode
);

262 i‡(
îr
 < 0)

263 
_îr
;

264 i‡(
öpuç
) {

265 (*
öpuç
)->
›í_func
 = open_func;

266 
	`¢d_øwmidi_∑øms_deÁu…
(*
öpuç
, &
∑øms
);

267 
îr
 = 
	`¢d_øwmidi_∑øms
(*
öpuç
, &
∑øms
);

268 
	`as£π
(
îr
 >= 0);

270 i‡(
ouçuç
) {

271 (*
ouçuç
)->
›í_func
 = open_func;

272 
	`¢d_øwmidi_∑øms_deÁu…
(*
ouçuç
, &
∑øms
);

273 
îr
 = 
	`¢d_øwmidi_∑øms
(*
ouçuç
, &
∑øms
);

274 
	`as£π
(
îr
 >= 0);

278 
_îr
:

279 i‡(
›í_func
)

280 
	`¢d_dlobj_ˇche_put
(
›í_func
);

281 i‡(
ty≥_c⁄f
)

282 
	`¢d_c⁄fig_dñëe
(
ty≥_c⁄f
);

283  
îr
;

284 
	}
}

286 
	$¢d_øwmidi_›í_noupd©e
(
¢d_øwmidi_t
 **
öpuç
, snd_øwmidi_à**
ouçuç
,

287 
¢d_c⁄fig_t
 *
roŸ
, c⁄° *
«me
, 
mode
)

289 
îr
;

290 
¢d_c⁄fig_t
 *
øwmidi_c⁄f
;

291 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "øwmidi", 
«me
, &
øwmidi_c⁄f
);

292 i‡(
îr
 < 0) {

293 
	`SNDERR
("Unknow¿RawMidò%s", 
«me
);

294  
îr
;

296 
îr
 = 
	`¢d_øwmidi_›í_c⁄f
(
öpuç
, 
ouçuç
, 
«me
, 
roŸ
, 
øwmidi_c⁄f
, 
mode
);

297 
	`¢d_c⁄fig_dñëe
(
øwmidi_c⁄f
);

298  
îr
;

299 
	}
}

312 
	$¢d_øwmidi_›í
(
¢d_øwmidi_t
 **
öpuç
, snd_øwmidi_à**
ouçuç
,

313 c⁄° *
«me
, 
mode
)

315 
¢d_c⁄fig_t
 *
t›
;

316 
îr
;

318 
	`as£π
((
öpuç
 || 
ouçuç
Ë&& 
«me
);

319 i‡(
	`_¢d_is_ucm_devi˚
(
«me
)) {

320 
«me
 = 
	`uc_mgr_Æibcfg_by_devi˚
(&
t›
,Çame);

321 i‡(
«me
 =
NULL
)

322  -
ENODEV
;

324 
îr
 = 
	`¢d_c⁄fig_upd©e_ªf
(&
t›
);

325 i‡(
îr
 < 0)

326  
îr
;

328 
îr
 = 
	`¢d_øwmidi_›í_noupd©e
(
öpuç
, 
ouçuç
, 
t›
, 
«me
, 
mode
);

329 
	`¢d_c⁄fig_uƒef
(
t›
);

330  
îr
;

331 
	}
}

345 
	$¢d_øwmidi_›í_lc⁄f
(
¢d_øwmidi_t
 **
öpuç
, snd_øwmidi_à**
ouçuç
,

346 c⁄° *
«me
, 
mode
, 
¢d_c⁄fig_t
 *
lc⁄f
)

348 
	`as£π
((
öpuç
 || 
ouçuç
Ë&& 
«me
 && 
lc⁄f
);

349  
	`¢d_øwmidi_›í_noupd©e
(
öpuç
, 
ouçuç
, 
lc⁄f
, 
«me
, 
mode
);

350 
	}
}

360 
	$¢d_øwmidi_˛o£
(
¢d_øwmidi_t
 *
øwmidi
)

362 
îr
;

363 
	`as£π
(
øwmidi
);

364 
îr
 = 
øwmidi
->
›s
->
	`˛o£
(rawmidi);

365 
	`‰ì
(
øwmidi
->
«me
);

366 i‡(
øwmidi
->
›í_func
)

367 
	`¢d_dlobj_ˇche_put
(
øwmidi
->
›í_func
);

368 
	`‰ì
(
øwmidi
);

369  
îr
;

370 
	}
}

380 c⁄° *
	$¢d_øwmidi_«me
(
¢d_øwmidi_t
 *
øwmidi
)

382 
	`as£π
(
øwmidi
);

383  
øwmidi
->
«me
;

384 
	}
}

393 
¢d_øwmidi_ty≥_t
 
	$¢d_øwmidi_ty≥
(
¢d_øwmidi_t
 *
øwmidi
)

395 
	`as£π
(
øwmidi
);

396  
øwmidi
->
ty≥
;

397 
	}
}

406 
¢d_øwmidi_°ªam_t
 
	$¢d_øwmidi_°ªam
(
¢d_øwmidi_t
 *
øwmidi
)

408 
	`as£π
(
øwmidi
);

409  
øwmidi
->
°ªam
;

410 
	}
}

417 
	$¢d_øwmidi_pﬁl_des¸ùt‹s_cou¡
(
¢d_øwmidi_t
 *
øwmidi
)

419 
	`as£π
(
øwmidi
);

421 
	}
}

430 
	$¢d_øwmidi_pﬁl_des¸ùt‹s
(
¢d_øwmidi_t
 *
øwmidi
, 
pﬁlfd
 *
pfds
, 
•a˚
)

432 
	`as£π
(
øwmidi
);

433 i‡(
•a˚
 >= 1) {

434 
pfds
->
fd
 = 
øwmidi
->
pﬁl_fd
;

435 
pfds
->
evíts
 = 
øwmidi
->
°ªam
 =
SND_RAWMIDI_STREAM_OUTPUT
 ? (
POLLOUT
|
POLLERR
|
POLLNVAL
Ë: (
POLLIN
|POLLERR|POLLNVAL);

439 
	}
}

449 
	$¢d_øwmidi_pﬁl_des¸ùt‹s_ªvíts
(
¢d_øwmidi_t
 *
øwmidi
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

451 
	`as£π
(
øwmidi
 && 
pfds
 && 
ªvíts
);

452 i‡(
nfds
 == 1) {

453 *
ªvíts
 = 
pfds
->revents;

456  -
EINVAL
;

457 
	}
}

468 
	$¢d_øwmidi_n⁄block
(
¢d_øwmidi_t
 *
øwmidi
, 
n⁄block
)

470 
îr
;

471 
	`as£π
(
øwmidi
);

472 
	`as£π
(!(
øwmidi
->
mode
 & 
SND_RAWMIDI_APPEND
));

473 i‡((
îr
 = 
øwmidi
->
›s
->
	`n⁄block
‘awmidi, 
n⁄block
)) < 0)

474  
îr
;

475 i‡(
n⁄block
)

476 
øwmidi
->
mode
 |
SND_RAWMIDI_NONBLOCK
;

478 
øwmidi
->
mode
 &~
SND_RAWMIDI_NONBLOCK
;

480 
	}
}

486 
size_t
 
	$¢d_øwmidi_öfo_sizeof
()

488  (
¢d_øwmidi_öfo_t
);

489 
	}
}

499 
	$¢d_øwmidi_öfo_mÆloc
(
¢d_øwmidi_öfo_t
 **
öfo
)

501 
	`as£π
(
öfo
);

502 *
öfo
 = 
	`ˇŒoc
(1, (
¢d_øwmidi_öfo_t
));

503 i‡(!*
öfo
)

504  -
ENOMEM
;

506 
	}
}

515 
	$¢d_øwmidi_öfo_‰ì
(
¢d_øwmidi_öfo_t
 *
öfo
)

517 
	`as£π
(
öfo
);

518 
	`‰ì
(
öfo
);

519 
	}
}

526 
	$¢d_øwmidi_öfo_c›y
(
¢d_øwmidi_öfo_t
 *
d°
, c⁄° snd_øwmidi_öfo_à*
§c
)

528 
	`as£π
(
d°
 && 
§c
);

529 *
d°
 = *
§c
;

530 
	}
}

537 
	$¢d_øwmidi_öfo_gë_devi˚
(c⁄° 
¢d_øwmidi_öfo_t
 *
öfo
)

539 
	`as£π
(
öfo
);

540  
öfo
->
devi˚
;

541 
	}
}

548 
	$¢d_øwmidi_öfo_gë_subdevi˚
(c⁄° 
¢d_øwmidi_öfo_t
 *
öfo
)

550 
	`as£π
(
öfo
);

551  
öfo
->
subdevi˚
;

552 
	}
}

559 
¢d_øwmidi_°ªam_t
 
	$¢d_øwmidi_öfo_gë_°ªam
(c⁄° 
¢d_øwmidi_öfo_t
 *
öfo
)

561 
	`as£π
(
öfo
);

562  
öfo
->
°ªam
;

563 
	}
}

570 
	$¢d_øwmidi_öfo_gë_ˇrd
(c⁄° 
¢d_øwmidi_öfo_t
 *
öfo
)

572 
	`as£π
(
öfo
);

573  
öfo
->
ˇrd
;

574 
	}
}

581 
	$¢d_øwmidi_öfo_gë_Êags
(c⁄° 
¢d_øwmidi_öfo_t
 *
öfo
)

583 
	`as£π
(
öfo
);

584  
öfo
->
Êags
;

585 
	}
}

592 c⁄° *
	$¢d_øwmidi_öfo_gë_id
(c⁄° 
¢d_øwmidi_öfo_t
 *
öfo
)

594 
	`as£π
(
öfo
);

595  (c⁄° *)
öfo
->
id
;

596 
	}
}

603 c⁄° *
	$¢d_øwmidi_öfo_gë_«me
(c⁄° 
¢d_øwmidi_öfo_t
 *
öfo
)

605 
	`as£π
(
öfo
);

606  (c⁄° *)
öfo
->
«me
;

607 
	}
}

614 c⁄° *
	$¢d_øwmidi_öfo_gë_subdevi˚_«me
(c⁄° 
¢d_øwmidi_öfo_t
 *
öfo
)

616 
	`as£π
(
öfo
);

617  (c⁄° *)
öfo
->
sub«me
;

618 
	}
}

625 
	$¢d_øwmidi_öfo_gë_subdevi˚s_cou¡
(c⁄° 
¢d_øwmidi_öfo_t
 *
öfo
)

627 
	`as£π
(
öfo
);

628  
öfo
->
subdevi˚s_cou¡
;

629 
	}
}

636 
	$¢d_øwmidi_öfo_gë_subdevi˚s_avaû
(c⁄° 
¢d_øwmidi_öfo_t
 *
öfo
)

638 
	`as£π
(
öfo
);

639  
öfo
->
subdevi˚s_avaû
;

640 
	}
}

647 
	$¢d_øwmidi_öfo_£t_devi˚
(
¢d_øwmidi_öfo_t
 *
öfo
, 
vÆ
)

649 
	`as£π
(
öfo
);

650 
öfo
->
devi˚
 = 
vÆ
;

651 
	}
}

658 
	$¢d_øwmidi_öfo_£t_subdevi˚
(
¢d_øwmidi_öfo_t
 *
öfo
, 
vÆ
)

660 
	`as£π
(
öfo
);

661 
öfo
->
subdevi˚
 = 
vÆ
;

662 
	}
}

669 
	$¢d_øwmidi_öfo_£t_°ªam
(
¢d_øwmidi_öfo_t
 *
öfo
, 
¢d_øwmidi_°ªam_t
 
vÆ
)

671 
	`as£π
(
öfo
);

672 
öfo
->
°ªam
 = 
vÆ
;

673 
	}
}

681 
	$¢d_øwmidi_öfo
(
¢d_øwmidi_t
 *
øwmidi
, 
¢d_øwmidi_öfo_t
 * 
öfo
)

683 
	`as£π
(
øwmidi
);

684 
	`as£π
(
öfo
);

685  
øwmidi
->
›s
->
	`öfo
‘awmidi, 
öfo
);

686 
	}
}

692 
size_t
 
	$¢d_øwmidi_∑øms_sizeof
()

694  (
¢d_øwmidi_∑øms_t
);

695 
	}
}

705 
	$¢d_øwmidi_∑øms_mÆloc
(
¢d_øwmidi_∑øms_t
 **
∑øms
)

707 
	`as£π
(
∑øms
);

708 *
∑øms
 = 
	`ˇŒoc
(1, (
¢d_øwmidi_∑øms_t
));

709 i‡(!*
∑øms
)

710  -
ENOMEM
;

712 
	}
}

721 
	$¢d_øwmidi_∑øms_‰ì
(
¢d_øwmidi_∑øms_t
 *
∑øms
)

723 
	`as£π
(
∑øms
);

724 
	`‰ì
(
∑øms
);

725 
	}
}

732 
	$¢d_øwmidi_∑øms_c›y
(
¢d_øwmidi_∑øms_t
 *
d°
, c⁄° snd_øwmidi_∑øms_à*
§c
)

734 
	`as£π
(
d°
 && 
§c
);

735 *
d°
 = *
§c
;

736 
	}
}

745 #i‚de‡
DOXYGEN


746 
	$¢d_øwmidi_∑øms_£t_buf„r_size
(
¢d_øwmidi_t
 *
øwmidi
 
ATTRIBUTE_UNUSED
, 
¢d_øwmidi_∑øms_t
 *
∑øms
, 
size_t
 
vÆ
)

748 
	$¢d_øwmidi_∑øms_£t_buf„r_size
(
¢d_øwmidi_t
 *
øwmidi
, 
¢d_øwmidi_∑øms_t
 *
∑øms
, 
size_t
 
vÆ
)

751 
	`as£π
(
øwmidi
 && 
∑øms
);

752 
	`as£π
(
vÆ
 > 
∑øms
->
avaû_mö
);

753 
∑øms
->
buf„r_size
 = 
vÆ
;

755 
	}
}

762 
size_t
 
	$¢d_øwmidi_∑øms_gë_buf„r_size
(c⁄° 
¢d_øwmidi_∑øms_t
 *
∑øms
)

764 
	`as£π
(
∑øms
);

765  
∑øms
->
buf„r_size
;

766 
	}
}

774 #i‚de‡
DOXYGEN


775 
	$¢d_øwmidi_∑øms_£t_avaû_mö
(
¢d_øwmidi_t
 *
øwmidi
 
ATTRIBUTE_UNUSED
, 
¢d_øwmidi_∑øms_t
 *
∑øms
, 
size_t
 
vÆ
)

777 
	$¢d_øwmidi_∑øms_£t_avaû_mö
(
¢d_øwmidi_t
 *
øwmidi
, 
¢d_øwmidi_∑øms_t
 *
∑øms
, 
size_t
 
vÆ
)

780 
	`as£π
(
øwmidi
 && 
∑øms
);

781 
	`as£π
(
vÆ
 < 
∑øms
->
buf„r_size
);

782 
∑øms
->
avaû_mö
 = 
vÆ
;

784 
	}
}

791 
size_t
 
	$¢d_øwmidi_∑øms_gë_avaû_mö
(c⁄° 
¢d_øwmidi_∑øms_t
 *
∑øms
)

793 
	`as£π
(
∑øms
);

794  
∑øms
->
avaû_mö
;

795 
	}
}

804 #i‚de‡
DOXYGEN


805 
	$¢d_øwmidi_∑øms_£t_no_a˘ive_£nsög
(
¢d_øwmidi_t
 *
øwmidi
 
ATTRIBUTE_UNUSED
, 
¢d_øwmidi_∑øms_t
 *
∑øms
, 
vÆ
)

807 
	$¢d_øwmidi_∑øms_£t_no_a˘ive_£nsög
(
¢d_øwmidi_t
 *
øwmidi
, 
¢d_øwmidi_∑øms_t
 *
∑øms
, 
vÆ
)

810 
	`as£π
(
øwmidi
 && 
∑øms
);

811 
∑øms
->
no_a˘ive_£nsög
 = 
vÆ
;

813 
	}
}

820 
	$¢d_øwmidi_∑øms_gë_no_a˘ive_£nsög
(c⁄° 
¢d_øwmidi_∑øms_t
 *
∑øms
)

822 
	`as£π
(
∑øms
);

823  
∑øms
->
no_a˘ive_£nsög
;

824 
	}
}

838 
	$¢d_øwmidi_∑øms_£t_ªad_mode
(c⁄° 
¢d_øwmidi_t
 *
øwmidi
, 
¢d_øwmidi_∑øms_t
 *
∑øms
, 
¢d_øwmidi_ªad_mode_t
 
vÆ
)

840 
‰amög
;

841 
	`as£π
(
øwmidi
 && 
∑øms
);

843 
vÆ
) {

844 
SND_RAWMIDI_READ_STANDARD
:

845 
‰amög
 = 
SNDRV_RAWMIDI_MODE_FRAMING_NONE
;

847 
SND_RAWMIDI_READ_TSTAMP
:

848 i‡(
øwmidi
->
›s
->
åód
 =
NULL
)

849  -
ENOTSUP
;

850 
‰amög
 = 
SNDRV_RAWMIDI_MODE_FRAMING_TSTAMP
;

853  -
EINVAL
;

856 i‡(
‰amög
 !
SNDRV_RAWMIDI_MODE_FRAMING_NONE
 &&

857 (
øwmidi
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 2Ë||Ñawmidi->
°ªam
 !
SND_RAWMIDI_STREAM_INPUT
))

858  -
ENOTSUP
;

859 
∑øms
->
mode
 = (∑øms->modê& ~
SNDRV_RAWMIDI_MODE_FRAMING_MASK
Ë| 
‰amög
;

861 
	}
}

868 
¢d_øwmidi_ªad_mode_t
 
	$¢d_øwmidi_∑øms_gë_ªad_mode
(c⁄° 
¢d_øwmidi_∑øms_t
 *
∑øms
)

870 
‰amög
;

872 
	`as£π
(
∑øms
);

873 
‰amög
 = 
∑øms
->
mode
 & 
SNDRV_RAWMIDI_MODE_FRAMING_MASK
;

874 i‡(
‰amög
 =
SNDRV_RAWMIDI_MODE_FRAMING_TSTAMP
)

875  
SND_RAWMIDI_READ_TSTAMP
;

876  
SND_RAWMIDI_READ_STANDARD
;

877 
	}
}

891 
	$¢d_øwmidi_∑øms_£t_˛ock_ty≥
(c⁄° 
¢d_øwmidi_t
 *
øwmidi
, 
¢d_øwmidi_∑øms_t
 *
∑øms
, 
¢d_øwmidi_˛ock_t
 
vÆ
)

893 
	`as£π
(
øwmidi
 && 
∑øms
);

894 i‡(
vÆ
 > 
SNDRV_RAWMIDI_MODE_CLOCK_MASK
 >> 
SNDRV_RAWMIDI_MODE_CLOCK_SHIFT
)

895  -
EINVAL
;

896 i‡(
vÆ
 !
SNDRV_RAWMIDI_MODE_CLOCK_NONE
 &&

897 (
øwmidi
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 2Ë||Ñawmidi->
°ªam
 !
SND_RAWMIDI_STREAM_INPUT
))

898  -
ENOTSUP
;

899 
∑øms
->
mode
 = (∑øms->modê& ~
SNDRV_RAWMIDI_MODE_CLOCK_MASK
Ë+ (
vÆ
 << 
SNDRV_RAWMIDI_MODE_CLOCK_SHIFT
);

901 
	}
}

908 
¢d_øwmidi_˛ock_t
 
	$¢d_øwmidi_∑øms_gë_˛ock_ty≥
(c⁄° 
¢d_øwmidi_∑øms_t
 *
∑øms
)

910 
	`as£π
(
∑øms
);

911  (
∑øms
->
mode
 & 
SNDRV_RAWMIDI_MODE_CLOCK_MASK
Ë>> 
SNDRV_RAWMIDI_MODE_CLOCK_SHIFT
;

912 
	}
}

921 
	$¢d_øwmidi_∑øms
(
¢d_øwmidi_t
 *
øwmidi
, 
¢d_øwmidi_∑øms_t
 * 
∑øms
)

923 
îr
;

924 
	`as£π
(
øwmidi
);

925 
	`as£π
(
∑øms
);

926 
îr
 = 
øwmidi
->
›s
->
	`∑øms
‘awmidi, 
∑øms
);

927 i‡(
îr
 < 0)

928  
îr
;

929 
øwmidi
->
buf„r_size
 = 
∑øms
->buffer_size;

930 
øwmidi
->
avaû_mö
 = 
∑øms
->avail_min;

931 
øwmidi
->
no_a˘ive_£nsög
 = 
∑øms
->no_active_sensing;

932 
øwmidi
->
∑øms_mode
 =Ñawmidi->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 2Ë? 0 : 
∑øms
->
mode
;

934 
	}
}

942 
	$¢d_øwmidi_∑øms_cuºít
(
¢d_øwmidi_t
 *
øwmidi
, 
¢d_øwmidi_∑øms_t
 *
∑øms
)

944 
	`as£π
(
øwmidi
);

945 
	`as£π
(
∑øms
);

946 
∑øms
->
buf„r_size
 = 
øwmidi
->buffer_size;

947 
∑øms
->
avaû_mö
 = 
øwmidi
->avail_min;

948 
∑øms
->
no_a˘ive_£nsög
 = 
øwmidi
->no_active_sensing;

949 
∑øms
->
mode
 = 
øwmidi
->
∑øms_mode
;

951 
	}
}

957 
size_t
 
	$¢d_øwmidi_°©us_sizeof
()

959  (
¢d_øwmidi_°©us_t
);

960 
	}
}

970 
	$¢d_øwmidi_°©us_mÆloc
(
¢d_øwmidi_°©us_t
 **
±r
)

972 
	`as£π
(
±r
);

973 *
±r
 = 
	`ˇŒoc
(1, (
¢d_øwmidi_°©us_t
));

974 i‡(!*
±r
)

975  -
ENOMEM
;

977 
	}
}

986 
	$¢d_øwmidi_°©us_‰ì
(
¢d_øwmidi_°©us_t
 *
°©us
)

988 
	`as£π
(
°©us
);

989 
	`‰ì
(
°©us
);

990 
	}
}

997 
	$¢d_øwmidi_°©us_c›y
(
¢d_øwmidi_°©us_t
 *
d°
, c⁄° snd_øwmidi_°©us_à*
§c
)

999 
	`as£π
(
d°
 && 
§c
);

1000 *
d°
 = *
§c
;

1001 
	}
}

1008 
	$¢d_øwmidi_°©us_gë_t°amp
(c⁄° 
¢d_øwmidi_°©us_t
 *
°©us
, 
¢d_htime°amp_t
 *
t°amp
)

1010 
	`as£π
(
°©us
 && 
t°amp
);

1011 *
t°amp
 = 
°©us
->tstamp;

1012 
	}
}

1019 
size_t
 
	$¢d_øwmidi_°©us_gë_avaû
(c⁄° 
¢d_øwmidi_°©us_t
 *
°©us
)

1021 
	`as£π
(
°©us
);

1022  
°©us
->
avaû
;

1023 
	}
}

1030 
size_t
 
	$¢d_øwmidi_°©us_gë_xruns
(c⁄° 
¢d_øwmidi_°©us_t
 *
°©us
)

1032 
	`as£π
(
°©us
);

1033  
°©us
->
xruns
;

1034 
	}
}

1042 
	$¢d_øwmidi_°©us
(
¢d_øwmidi_t
 *
øwmidi
, 
¢d_øwmidi_°©us_t
 * 
°©us
)

1044 
	`as£π
(
øwmidi
);

1045 
	`as£π
(
°©us
);

1046  
øwmidi
->
›s
->
	`°©us
‘awmidi, 
°©us
);

1047 
	}
}

1054 
	$¢d_øwmidi_dr›
(
¢d_øwmidi_t
 *
øwmidi
)

1056 
	`as£π
(
øwmidi
);

1057  
øwmidi
->
›s
->
	`dr›
(rawmidi);

1058 
	}
}

1068 
	$¢d_øwmidi_døö
(
¢d_øwmidi_t
 *
øwmidi
)

1070 
	`as£π
(
øwmidi
);

1071  
øwmidi
->
›s
->
	`døö
(rawmidi);

1072 
	}
}

1080 
ssize_t
 
	$¢d_øwmidi_wrôe
(
¢d_øwmidi_t
 *
øwmidi
, c⁄° *
buf„r
, 
size_t
 
size
)

1082 
	`as£π
(
øwmidi
);

1083 
	`as£π
(
øwmidi
->
°ªam
 =
SND_RAWMIDI_STREAM_OUTPUT
);

1084 
	`as£π
(
buf„r
 || 
size
 == 0);

1085  
øwmidi
->
›s
->
	`wrôe
‘awmidi, 
buf„r
, 
size
);

1086 
	}
}

1095 
ssize_t
 
	$¢d_øwmidi_ªad
(
¢d_øwmidi_t
 *
øwmidi
, *
buf„r
, 
size_t
 
size
)

1097 
	`as£π
(
øwmidi
);

1098 
	`as£π
(
øwmidi
->
°ªam
 =
SND_RAWMIDI_STREAM_INPUT
);

1099 i‡((
øwmidi
->
∑øms_mode
 & 
SNDRV_RAWMIDI_MODE_FRAMING_MASK
Ë=
SNDRV_RAWMIDI_MODE_FRAMING_TSTAMP
)

1100 
size
 &~((
¢d_øwmidi_‰amög_t°amp
) - 1);

1101 
	`as£π
(
buf„r
 || 
size
 == 0);

1102  (
øwmidi
->
›s
->
ªad
)‘awmidi, 
buf„r
, 
size
);

1103 
	}
}

1113 
ssize_t
 
	$¢d_øwmidi_åód
(
¢d_øwmidi_t
 *
øwmidi
, 
time•ec
 *
t°amp
, *
buf„r
, 
size_t
 
size
)

1115 
	`as£π
(
øwmidi
);

1116 
	`as£π
(
øwmidi
->
°ªam
 =
SND_RAWMIDI_STREAM_INPUT
);

1117 
	`as£π
(
buf„r
 || 
size
 == 0);

1118 i‡((
øwmidi
->
∑øms_mode
 & 
SNDRV_RAWMIDI_MODE_FRAMING_MASK
Ë!
SNDRV_RAWMIDI_MODE_FRAMING_TSTAMP
)

1119  -
EINVAL
;

1120 i‡(
øwmidi
->
›s
->
åód
 =
NULL
)

1121  -
ENOTSUP
;

1122  (
øwmidi
->
›s
->
åód
)‘awmidi, 
t°amp
, 
buf„r
, 
size
);

1123 
	}
}

1125 #i‚de‡
DOXYGEN


1129 
	$_¢d_øwmidi_ump_ídpoöt_öfo
(
¢d_øwmidi_t
 *
rmidi
, *
öfo
)

1131 i‡(!
rmidi
->
›s
->
ump_ídpoöt_öfo
)

1132  -
ENXIO
;

1133  
rmidi
->
›s
->
	`ump_ídpoöt_öfo
‘midi, 
öfo
);

1134 
	}
}

1136 
	$_¢d_øwmidi_ump_block_öfo
(
¢d_øwmidi_t
 *
rmidi
, *
öfo
)

1138 i‡(!
rmidi
->
›s
->
ump_block_öfo
)

1139  -
ENXIO
;

1140  
rmidi
->
›s
->
	`ump_block_öfo
‘midi, 
öfo
);

1141 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_hw.c

23 
	~"c⁄fig.h
"

24 
	~<°dio.h
>

25 
	~<°dlib.h
>

26 
	~<uni°d.h
>

27 
	~<°rög.h
>

28 
	~<f˙é.h
>

29 
	~<sys/io˘l.h
>

30 
	~"../c⁄åﬁ/c⁄åﬁ_loˇl.h
"

31 
	~"øwmidi_loˇl.h
"

33 #i‚de‡
PIC


35 c⁄° *
	g_¢d_moduÀ_øwmidi_hw
 = "";

38 
	#SNDRV_FILE_RAWMIDI
 
ALSA_DEVICE_DIRECTORY
 "midiC%iD%i"

	)

39 
	#SNDRV_FILE_UMP_RAWMIDI
 
ALSA_DEVICE_DIRECTORY
 "umpC%iD%i"

	)

40 
	#SNDRV_RAWMIDI_VERSION_MAX
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 0)

	)

42 #i‚de‡
DOC_HIDDEN


44 
	m›í
;

45 
	mfd
;

46 
	mˇrd
, 
	mdevi˚
, 
	msubdevi˚
;

47 *
	mbuf
;

48 
size_t
 
	mbuf_size
;

49 
size_t
 
	mbuf_fûl
;

50 
size_t
 
	mbuf_pos
;

51 
size_t
 
	mbuf_Âos
;

52 } 
	t¢d_øwmidi_hw_t
;

55 
	$buf_ª£t
(
¢d_øwmidi_hw_t
 *
hw
)

57 
hw
->
buf_fûl
 = 0;

58 
hw
->
buf_pos
 = 0;

59 
hw
->
buf_Âos
 = 0;

60 
	}
}

62 
	$¢d_øwmidi_hw_˛o£
(
¢d_øwmidi_t
 *
rmidi
)

64 
¢d_øwmidi_hw_t
 *
hw
 = 
rmidi
->
¥iv©e_d©a
;

65 
îr
 = 0;

67 
hw
->
›í
--;

68 i‡(
hw
->
›í
)

70 i‡(
	`˛o£
(
hw
->
fd
)) {

71 
îr
 = -
î∫o
;

72 
	`SYSMSG
("close failed");

74 
	`‰ì
(
hw
->
buf
);

75 
	`‰ì
(
hw
);

76  
îr
;

77 
	}
}

79 
	$¢d_øwmidi_hw_n⁄block
(
¢d_øwmidi_t
 *
rmidi
, 
n⁄block
)

81 
¢d_øwmidi_hw_t
 *
hw
 = 
rmidi
->
¥iv©e_d©a
;

82 
Êags
;

84 i‡((
Êags
 = 
	`f˙é
(
hw
->
fd
, 
F_GETFL
)) < 0) {

85 
	`SYSMSG
("F_GETFL failed");

86  -
î∫o
;

88 i‡(
n⁄block
)

89 
Êags
 |
O_NONBLOCK
;

91 
Êags
 &~
O_NONBLOCK
;

92 i‡(
	`f˙é
(
hw
->
fd
, 
F_SETFL
, 
Êags
) < 0) {

93 
	`SYSMSG
("F_SETFL for O_NONBLOCK failed");

94  -
î∫o
;

97 
	}
}

99 
	$¢d_øwmidi_hw_öfo
(
¢d_øwmidi_t
 *
rmidi
, 
¢d_øwmidi_öfo_t
 * 
öfo
)

101 
¢d_øwmidi_hw_t
 *
hw
 = 
rmidi
->
¥iv©e_d©a
;

102 
öfo
->
°ªam
 = 
rmidi
->stream;

103 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_RAWMIDI_IOCTL_INFO
, 
öfo
) < 0) {

104 
	`SYSMSG
("SNDRV_RAWMIDI_IOCTL_INFO failed");

105  -
î∫o
;

108 
	}
}

110 
	$¢d_øwmidi_hw_∑øms
(
¢d_øwmidi_t
 *
rmidi
, 
¢d_øwmidi_∑øms_t
 * 
∑øms
)

112 
¢d_øwmidi_hw_t
 *
hw
 = 
rmidi
->
¥iv©e_d©a
;

113 
t°amp
;

114 
∑øms
->
°ªam
 = 
rmidi
->stream;

115 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_RAWMIDI_IOCTL_PARAMS
, 
∑øms
) < 0) {

116 
	`SYSMSG
("SNDRV_RAWMIDI_IOCTL_PARAMS failed");

117  -
î∫o
;

119 
	`buf_ª£t
(
hw
);

120 
t°amp
 = (
∑øms
->
mode
 & 
SNDRV_RAWMIDI_MODE_FRAMING_MASK
Ë=
SNDRV_RAWMIDI_MODE_FRAMING_TSTAMP
;

121 i‡(
hw
->
buf
 && !
t°amp
) {

122 
	`‰ì
(
hw
->
buf
);

123 
hw
->
buf
 = 
NULL
;

124 
hw
->
buf_size
 = 0;

125 } i‡(
t°amp
) {

126 
size_t
 
Æloc_size
;

127 *
buf
;

129 
Æloc_size
 = 
	`∑ge_size
();

130 i‡(
∑øms
->
buf„r_size
 > 
Æloc_size
)

131 
Æloc_size
 = 
∑øms
->
buf„r_size
;

132 i‡(
Æloc_size
 !
hw
->
buf_size
) {

133 
buf
 = 
	`ªÆloc
(
hw
->buf, 
Æloc_size
);

134 i‡(
buf
 =
NULL
)

135  -
ENOMEM
;

136 
hw
->
buf
 = buf;

137 
hw
->
buf_size
 = 
Æloc_size
;

141 
	}
}

143 
	$¢d_øwmidi_hw_°©us
(
¢d_øwmidi_t
 *
rmidi
, 
¢d_øwmidi_°©us_t
 * 
°©us
)

145 
¢d_øwmidi_hw_t
 *
hw
 = 
rmidi
->
¥iv©e_d©a
;

146 
°©us
->
°ªam
 = 
rmidi
->stream;

147 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_RAWMIDI_IOCTL_STATUS
, 
°©us
) < 0) {

148 
	`SYSMSG
("SNDRV_RAWMIDI_IOCTL_STATUS failed");

149  -
î∫o
;

152 
	}
}

154 
	$¢d_øwmidi_hw_dr›
(
¢d_øwmidi_t
 *
rmidi
)

156 
¢d_øwmidi_hw_t
 *
hw
 = 
rmidi
->
¥iv©e_d©a
;

157 
°r
 = 
rmidi
->
°ªam
;

158 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_RAWMIDI_IOCTL_DROP
, &
°r
) < 0) {

159 
	`SYSMSG
("SNDRV_RAWMIDI_IOCTL_DROP failed");

160  -
î∫o
;

162 
	`buf_ª£t
(
hw
);

164 
	}
}

166 
	$¢d_øwmidi_hw_døö
(
¢d_øwmidi_t
 *
rmidi
)

168 
¢d_øwmidi_hw_t
 *
hw
 = 
rmidi
->
¥iv©e_d©a
;

169 
°r
 = 
rmidi
->
°ªam
;

170 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_RAWMIDI_IOCTL_DRAIN
, &
°r
) < 0) {

171 
	`SYSMSG
("SNDRV_RAWMIDI_IOCTL_DRAIN failed");

172  -
î∫o
;

175 
	}
}

177 
ssize_t
 
	$¢d_øwmidi_hw_wrôe
(
¢d_øwmidi_t
 *
rmidi
, c⁄° *
buf„r
, 
size_t
 
size
)

179 
¢d_øwmidi_hw_t
 *
hw
 = 
rmidi
->
¥iv©e_d©a
;

180 
ssize_t
 
ªsu…
;

181 
ªsu…
 = 
	`wrôe
(
hw
->
fd
, 
buf„r
, 
size
);

182 i‡(
ªsu…
 < 0)

183  -
î∫o
;

184  
ªsu…
;

185 
	}
}

187 
ssize_t
 
	$¢d_øwmidi_hw_ªad
(
¢d_øwmidi_t
 *
rmidi
, *
buf„r
, 
size_t
 
size
)

189 
¢d_øwmidi_hw_t
 *
hw
 = 
rmidi
->
¥iv©e_d©a
;

190 
ssize_t
 
ªsu…
;

191 
ªsu…
 = 
	`ªad
(
hw
->
fd
, 
buf„r
, 
size
);

192 i‡(
ªsu…
 < 0)

193  -
î∫o
;

194  
ªsu…
;

195 
	}
}

197 
ssize_t
 
	$ªad_‰om_ts_buf
(
¢d_øwmidi_hw_t
 *
hw
, 
time•ec
 *
t°amp
,

198 *
buf„r
, 
size_t
 
size
)

200 
¢d_øwmidi_‰amög_t°amp
 *
f
;

201 
size_t
 
Êí
;

202 
ssize_t
 
ªsu…
 = 0;

204 
f
 = (
¢d_øwmidi_‰amög_t°amp
 *)(
hw
->
buf
 + hw->
buf_pos
);

205 
hw
->
buf_fûl
 >(*
f
)) {

206 i‡(
f
->
‰ame_ty≥
 == 0) {

207 
t°amp
->
tv_£c
 = 
f
->tv_sec;

208 
t°amp
->
tv_n£c
 = 
f
->tv_nsec;

211 
hw
->
buf_pos
 +(*
f
);

212 
hw
->
buf_fûl
 -(*
f
);

213 
f
++;

215 
size
 > 0 && 
hw
->
buf_fûl
 >(*
f
)) {

217 i‡(
f
->
‰ame_ty≥
 != 0)

218 
__√xt
;

219 i‡(
f
->
Àngth
 =0 || f->Àngth > 
SNDRV_RAWMIDI_FRAMING_DATA_LENGTH
)

220  -
EINVAL
;

221 i‡(
t°amp
->
tv_£c
 !(
time_t
)
f
->tv_sec ||

222 
t°amp
->
tv_n£c
 !
f
->tv_nsec)

224 
Êí
 = 
f
->
Àngth
 - 
hw
->
buf_Âos
;

225 i‡(
size
 < 
Êí
) {

227 
	`mem˝y
(
buf„r
, 
f
->
d©a
 + 
hw
->
buf_Âos
, 
size
);

228 
hw
->
buf_Âos
 +
size
;

229 
ªsu…
 +
size
;

232 
	`mem˝y
(
buf„r
, 
f
->
d©a
 + 
hw
->
buf_Âos
, 
Êí
);

233 
hw
->
buf_Âos
 = 0;

234 
buf„r
 +
Êí
;

235 
size
 -
Êí
;

236 
ªsu…
 +
Êí
;

237 
__√xt
:

238 
hw
->
buf_pos
 +(*
f
);

239 
hw
->
buf_fûl
 -(*
f
);

240 
f
++;

242  
ªsu…
;

243 
	}
}

245 
ssize_t
 
	$¢d_øwmidi_hw_åód
(
¢d_øwmidi_t
 *
rmidi
, 
time•ec
 *
t°amp
,

246 *
buf„r
, 
size_t
 
size
)

248 
¢d_øwmidi_hw_t
 *
hw
 = 
rmidi
->
¥iv©e_d©a
;

249 
ssize_t
 
ªsu…
 = 0, 
ªt
;

252 
t°amp
->
tv_£c
 =Å°amp->
tv_n£c
 = 0;

255 i‡(
hw
->
buf_fûl
 > 0) {

256 
ªsu…
 = 
	`ªad_‰om_ts_buf
(
hw
, 
t°amp
, 
buf„r
, 
size
);

257 i‡(
ªsu…
 < 0 || 
size
 =(
size_t
)result ||

258 
hw
->
buf_fûl
 >(
¢d_øwmidi_‰amög_t°amp
))

259  
ªsu…
;

260 
buf„r
 +
ªsu…
;

261 
size
 -
ªsu…
;

264 
	`buf_ª£t
(
hw
);

265 
ªt
 = 
	`ªad
(
hw
->
fd
, hw->
buf
, hw->
buf_size
);

266 i‡(
ªt
 < 0)

267  
ªsu…
 > 0 ?Ñesu… : -
î∫o
;

268 i‡(
ªt
 < (
ssize_t
)(
¢d_øwmidi_‰amög_t°amp
))

269  
ªsu…
;

270 
hw
->
buf_fûl
 = 
ªt
;

271 
ªt
 = 
	`ªad_‰om_ts_buf
(
hw
, 
t°amp
, 
buf„r
, 
size
);

272 i‡(
ªt
 < 0 && 
ªsu…
 > 0)

273  
ªsu…
;

274  
ªt
 + 
ªsu…
;

275 
	}
}

277 
	$¢d_øwmidi_hw_ump_ídpoöt_öfo
(
¢d_øwmidi_t
 *
rmidi
, *
buf
)

279 
¢d_øwmidi_hw_t
 *
hw
 = 
rmidi
->
¥iv©e_d©a
;

281 i‡(
rmidi
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 3))

282  -
ENXIO
;

283 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_UMP_IOCTL_ENDPOINT_INFO
, 
buf
) < 0)

284  -
î∫o
;

286 
	}
}

288 
	$¢d_øwmidi_hw_ump_block_öfo
(
¢d_øwmidi_t
 *
rmidi
, *
buf
)

290 
¢d_øwmidi_hw_t
 *
hw
 = 
rmidi
->
¥iv©e_d©a
;

292 i‡(
rmidi
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 3))

293  -
ENXIO
;

294 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_UMP_IOCTL_BLOCK_INFO
, 
buf
) < 0)

295  -
î∫o
;

297 
	}
}

299 c⁄° 
¢d_øwmidi_›s_t
 
	g¢d_øwmidi_hw_›s
 = {

300 .
˛o£
 = 
¢d_øwmidi_hw_˛o£
,

301 .
	gn⁄block
 = 
¢d_øwmidi_hw_n⁄block
,

302 .
	göfo
 = 
¢d_øwmidi_hw_öfo
,

303 .
	g∑øms
 = 
¢d_øwmidi_hw_∑øms
,

304 .
	g°©us
 = 
¢d_øwmidi_hw_°©us
,

305 .
	gdr›
 = 
¢d_øwmidi_hw_dr›
,

306 .
	gdøö
 = 
¢d_øwmidi_hw_døö
,

307 .
	gwrôe
 = 
¢d_øwmidi_hw_wrôe
,

308 .
	gªad
 = 
¢d_øwmidi_hw_ªad
,

309 .
	gåód
 = 
¢d_øwmidi_hw_åód
,

310 .
	gump_ídpoöt_öfo
 = 
¢d_øwmidi_hw_ump_ídpoöt_öfo
,

311 .
	gump_block_öfo
 = 
¢d_øwmidi_hw_ump_block_öfo
,

315 
	$¢d_øwmidi_hw_›í
(
¢d_øwmidi_t
 **
öpuç
, snd_øwmidi_à**
ouçuç
,

316 c⁄° *
«me
, 
ˇrd
, 
devi˚
, 
subdevi˚
,

317 
mode
)

319 
fd
, 
vî
, 
ªt
;

320 
©ãm±
 = 0;

321 
fûíame
[(
SNDRV_FILE_RAWMIDI
) + 20];

322 
¢d_˘l_t
 *
˘l
;

323 
¢d_øwmidi_t
 *
rmidi
;

324 
¢d_øwmidi_hw_t
 *
hw
 = 
NULL
;

325 
¢d_øwmidi_öfo_t
 
öfo
;

326 
is_ump
;

327 
fmode
;

329 
is_ump
 = !!(
mode
 & 
_SND_RAWMIDI_OPEN_UMP
);

330 
mode
 &~
_SND_RAWMIDI_OPEN_UMP
;

332 i‡(
öpuç
)

333 *
öpuç
 = 
NULL
;

334 i‡(
ouçuç
)

335 *
ouçuç
 = 
NULL
;

336 i‡(!
öpuç
 && !
ouçuç
)

337  -
EINVAL
;

339 i‡((
ªt
 = 
	`¢d_˘l_hw_›í
(&
˘l
, 
NULL
, 
ˇrd
, 0)) < 0)

340  
ªt
;

341 i‡(
is_ump
)

342 
	`•rötf
(
fûíame
, 
SNDRV_FILE_UMP_RAWMIDI
, 
ˇrd
, 
devi˚
);

344 
	`•rötf
(
fûíame
, 
SNDRV_FILE_RAWMIDI
, 
ˇrd
, 
devi˚
);

346 
__agaö
:

347 i‡(
©ãm±
++ > 3) {

348 
	`¢d_˘l_˛o£
(
˘l
);

349  -
EBUSY
;

351 
ªt
 = 
	`¢d_˘l_øwmidi_¥e„r_subdevi˚
(
˘l
, 
subdevi˚
);

352 i‡(
ªt
 < 0) {

353 
	`¢d_˘l_˛o£
(
˘l
);

354  
ªt
;

357 i‡(!
öpuç
)

358 
fmode
 = 
O_WRONLY
;

359 i‡(!
ouçuç
)

360 
fmode
 = 
O_RDONLY
;

362 
fmode
 = 
O_RDWR
;

364 i‡(
mode
 & 
SND_RAWMIDI_APPEND
) {

365 
	`as£π
(
ouçuç
);

366 
fmode
 |
O_APPEND
;

369 i‡(
mode
 & 
SND_RAWMIDI_NONBLOCK
) {

370 
fmode
 |
O_NONBLOCK
;

373 i‡(
mode
 & 
SND_RAWMIDI_SYNC
) {

374 
fmode
 |
O_SYNC
;

377 
	`as£π
(!(
mode
 & ~(
SND_RAWMIDI_APPEND
|
SND_RAWMIDI_NONBLOCK
|
SND_RAWMIDI_SYNC
)));

379 
fd
 = 
	`¢d_›í_devi˚
(
fûíame
, 
fmode
);

380 i‡(
fd
 < 0) {

381 
	`¢d_ˇrd_lﬂd
(
ˇrd
);

382 
fd
 = 
	`¢d_›í_devi˚
(
fûíame
, 
fmode
);

383 i‡(
fd
 < 0) {

384 
	`¢d_˘l_˛o£
(
˘l
);

385 
	`SYSMSG
("›í %†Áûed", 
fûíame
);

386  -
î∫o
;

389 i‡(
	`io˘l
(
fd
, 
SNDRV_RAWMIDI_IOCTL_PVERSION
, &
vî
) < 0) {

390 
ªt
 = -
î∫o
;

391 
	`SYSMSG
("SNDRV_RAWMIDI_IOCTL_PVERSION failed");

392 
	`˛o£
(
fd
);

393 
	`¢d_˘l_˛o£
(
˘l
);

394  
ªt
;

396 i‡(
	`SNDRV_PROTOCOL_INCOMPATIBLE
(
vî
, 
SNDRV_RAWMIDI_VERSION_MAX
)) {

397 
	`˛o£
(
fd
);

398 
	`¢d_˘l_˛o£
(
˘l
);

399  -
SND_ERROR_INCOMPATIBLE_VERSION
;

401 i‡(
	`SNDRV_PROTOCOL_VERSION
(2, 0, 2Ë<
vî
) {

403 
u£r_vî
 = 
SNDRV_RAWMIDI_VERSION
;

404 
	`io˘l
(
fd
, 
SNDRV_RAWMIDI_IOCTL_USER_PVERSION
, &
u£r_vî
);

406 i‡(
subdevi˚
 >= 0) {

407 
	`mem£t
(&
öfo
, 0, (info));

408 
öfo
.
°ªam
 = 
ouçuç
 ? 
SNDRV_RAWMIDI_STREAM_OUTPUT
 : 
SNDRV_RAWMIDI_STREAM_INPUT
;

409 i‡(
	`io˘l
(
fd
, 
SNDRV_RAWMIDI_IOCTL_INFO
, &
öfo
) < 0) {

410 
	`SYSMSG
("SNDRV_RAWMIDI_IOCTL_INFO failed");

411 
ªt
 = -
î∫o
;

412 
	`˛o£
(
fd
);

413 
	`¢d_˘l_˛o£
(
˘l
);

414  
ªt
;

416 i‡(
öfo
.
subdevi˚
 != () subdevice) {

417 
	`˛o£
(
fd
);

418 
__agaö
;

421 
	`¢d_˘l_˛o£
(
˘l
);

423 
hw
 = 
	`ˇŒoc
(1, (
¢d_øwmidi_hw_t
));

424 i‡(
hw
 =
NULL
)

425 
_nomem
;

426 
hw
->
ˇrd
 = card;

427 
hw
->
devi˚
 = device;

428 
hw
->
subdevi˚
 = subdevice;

429 
hw
->
fd
 = fd;

431 i‡(
öpuç
) {

432 
rmidi
 = 
	`ˇŒoc
(1, (
¢d_øwmidi_t
));

433 i‡(
rmidi
 =
NULL
)

434 
_nomem
;

435 i‡(
«me
)

436 
rmidi
->
«me
 = 
	`°rdup
(name);

437 
rmidi
->
ty≥
 = 
SND_RAWMIDI_TYPE_HW
;

438 
rmidi
->
°ªam
 = 
SND_RAWMIDI_STREAM_INPUT
;

439 
rmidi
->
mode
 = mode;

440 
rmidi
->
pﬁl_fd
 = 
fd
;

441 
rmidi
->
›s
 = &
¢d_øwmidi_hw_›s
;

442 
rmidi
->
¥iv©e_d©a
 = 
hw
;

443 
rmidi
->
vîsi⁄
 = 
vî
;

444 
hw
->
›í
++;

445 *
öpuç
 = 
rmidi
;

447 i‡(
ouçuç
) {

448 
rmidi
 = 
	`ˇŒoc
(1, (
¢d_øwmidi_t
));

449 i‡(
rmidi
 =
NULL
)

450 
_nomem
;

451 i‡(
«me
)

452 
rmidi
->
«me
 = 
	`°rdup
(name);

453 
rmidi
->
ty≥
 = 
SND_RAWMIDI_TYPE_HW
;

454 
rmidi
->
°ªam
 = 
SND_RAWMIDI_STREAM_OUTPUT
;

455 
rmidi
->
mode
 = mode;

456 
rmidi
->
pﬁl_fd
 = 
fd
;

457 
rmidi
->
›s
 = &
¢d_øwmidi_hw_›s
;

458 
rmidi
->
¥iv©e_d©a
 = 
hw
;

459 
rmidi
->
vîsi⁄
 = 
vî
;

460 
hw
->
›í
++;

461 *
ouçuç
 = 
rmidi
;

465 
_nomem
:

466 
	`˛o£
(
fd
);

467 
	`‰ì
(
hw
);

468 i‡(
öpuç
)

469 
	`‰ì
(*
öpuç
);

470 i‡(
ouçuç
)

471 
	`‰ì
(*
ouçuç
);

472  -
ENOMEM
;

473 
	}
}

475 
	$_¢d_øwmidi_hw_›í
(
¢d_øwmidi_t
 **
öpuç
, snd_øwmidi_à**
ouçuç
,

476 *
«me
, 
¢d_c⁄fig_t
 *
roŸ
 
ATTRIBUTE_UNUSED
,

477 
¢d_c⁄fig_t
 *
c⁄f
, 
mode
)

479 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

480 
ˇrd
 = -1, 
devi˚
 = 0, 
subdevi˚
 = -1;

481 
îr
;

482 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

483 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

484 c⁄° *
id
;

485 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

487 i‡(
	`¢d_øwmidi_c⁄f_gíîic_id
(
id
))

489 i‡(
	`°rcmp
(
id
, "card") == 0) {

490 
îr
 = 
	`¢d_c⁄fig_gë_ˇrd
(
n
);

491 i‡(
îr
 < 0)

492  
îr
;

493 
ˇrd
 = 
îr
;

496 i‡(
	`°rcmp
(
id
, "device") == 0) {

497 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
devi˚
);

498 i‡(
îr
 < 0)

499  
îr
;

502 i‡(
	`°rcmp
(
id
, "subdevice") == 0) {

503 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
subdevi˚
);

504 i‡(
îr
 < 0)

505  
îr
;

508  -
EINVAL
;

510 i‡(
ˇrd
 < 0)

511  -
EINVAL
;

512  
	`¢d_øwmidi_hw_›í
(
öpuç
, 
ouçuç
, 
«me
, 
ˇrd
, 
devi˚
, 
subdevi˚
, 
mode
);

513 
	}
}

514 
SND_DLSYM_BUILD_VERSION
(
_¢d_øwmidi_hw_›í
, 
SND_RAWMIDI_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_local.h

22 
	~"loˇl.h
"

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~<limôs.h
>

28 (*
	m˛o£
)(
¢d_øwmidi_t
 *
	møwmidi
);

29 (*
	mn⁄block
)(
¢d_øwmidi_t
 *
	møwmidi
, nonblock);

30 (*
	möfo
)(
¢d_øwmidi_t
 *
	møwmidi
, 
¢d_øwmidi_öfo_t
 *info);

31 (*
	m∑øms
)(
¢d_øwmidi_t
 *
	møwmidi
, 
¢d_øwmidi_∑øms_t
 *params);

32 (*
	m°©us
)(
¢d_øwmidi_t
 *
	møwmidi
, 
¢d_øwmidi_°©us_t
 *status);

33 (*
	mdr›
)(
¢d_øwmidi_t
 *
	møwmidi
);

34 (*
	mdøö
)(
¢d_øwmidi_t
 *
	møwmidi
);

35 
ssize_t
 (*
wrôe
)(
¢d_øwmidi_t
 *
	møwmidi
, c⁄° *
	mbuf„r
, 
size_t
 
	msize
);

36 
ssize_t
 (*
ªad
)(
¢d_øwmidi_t
 *
	møwmidi
, *
	mbuf„r
, 
size_t
 
	msize
);

37 
ssize_t
 (*
åód
)(
¢d_øwmidi_t
 *
	møwmidi
, 
time•ec
 *
	mt°amp
, *
	mbuf„r
, 
size_t
 
	msize
);

38 (*
	mump_ídpoöt_öfo
)(
¢d_øwmidi_t
 *
	mrmidi
, *
	mbuf
);

39 (*
	mump_block_öfo
)(
¢d_øwmidi_t
 *
	mrmidi
, *
	mbuf
);

40 } 
	t¢d_øwmidi_›s_t
;

42 
	s_¢d_øwmidi
 {

43 *
	m›í_func
;

44 *
	m«me
;

45 
¢d_øwmidi_ty≥_t
 
	mty≥
;

46 
¢d_øwmidi_°ªam_t
 
	m°ªam
;

47 
	mmode
;

48 
	mvîsi⁄
;

49 
	mpﬁl_fd
;

50 c⁄° 
¢d_øwmidi_›s_t
 *
	m›s
;

51 *
	m¥iv©e_d©a
;

52 
size_t
 
	mbuf„r_size
;

53 
size_t
 
	mavaû_mö
;

54 
	mno_a˘ive_£nsög
: 1;

55 
	m∑øms_mode
;

58 
¢d_øwmidi_hw_›í
(
¢d_øwmidi_t
 **
öput
, snd_øwmidi_à**
ouçut
,

59 c⁄° *
«me
, 
ˇrd
, 
devi˚
, 
subdevi˚
,

60 
mode
);

62 
¢d_øwmidi_vútuÆ_›í
(
¢d_øwmidi_t
 **
öpuç
, snd_øwmidi_à**
ouçuç
,

63 c⁄° *
«me
, 
¢d_£q_t
 *
£q_h™dÀ
, 
p‹t
,

64 
mîge
, 
mode
);

66 
	#¢d_øwmidi_c⁄f_gíîic_id
(
id
Ë
	`_¢d_c⁄f_gíîic_id
(id)

	)

68 
_¢d_øwmidi_ump_ídpoöt_öfo
(
¢d_øwmidi_t
 *
rmidi
, *
öfo
);

69 
_¢d_øwmidi_ump_block_öfo
(
¢d_øwmidi_t
 *
rmidi
, *
öfo
);

71 
	#_SND_RAWMIDI_OPEN_UMP
 (1U << 16Ë

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_symbols.c

21 #i‚de‡
PIC


23 c⁄° *
_¢d_moduÀ_øwmidi_hw
;

24 #ifde‡
BUILD_SEQ


25 c⁄° *
_¢d_moduÀ_øwmidi_vút
;

28 c⁄° **
	g¢d_øwmidi_›í_obje˘s
[] = {

29 &
_¢d_moduÀ_øwmidi_hw
,

30 #ifde‡
BUILD_SEQ


31 &
_¢d_moduÀ_øwmidi_vút


35 *
	$¢d_øwmidi_›í_symbﬁs
()

37  
¢d_øwmidi_›í_obje˘s
;

38 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_virt.c

22 
	~"øwmidi_loˇl.h
"

23 
	~<uni°d.h
>

24 
	~<°rög.h
>

25 
	~<f˙é.h
>

26 
	~<sys/io˘l.h
>

27 
	~"£q.h
"

28 
	~"£q_midi_evít.h
"

30 #i‚de‡
PIC


32 c⁄° *
	g_¢d_moduÀ_øwmidi_vút
 = "";

36 #i‚de‡
DOC_HIDDEN


38 
	m›í
;

40 
¢d_£q_t
 *
	mh™dÀ
;

41 
	mp‹t
;

43 
¢d_midi_evít_t
 *
	mmidi_evít
;

45 
¢d_£q_evít_t
 *
	mö_evít
;

46 
	mö_buf_size
;

47 
	mö_buf_ofs
;

48 *
	mö_buf_±r
;

49 
	mö_tmp_buf
[16];

51 
¢d_£q_evít_t
 
	mout_evít
;

52 
	m≥ndög
;

53 } 
	t¢d_øwmidi_vútuÆ_t
;

55 
_¢d_£q_›í_lc⁄f
(
¢d_£q_t
 **
£qp
, c⁄° *
«me
,

56 
°ªams
, 
mode
, 
¢d_c⁄fig_t
 *
lc⁄f
,

57 
¢d_c⁄fig_t
 *
∑ª¡_c⁄f
);

60 
	$¢d_øwmidi_vútuÆ_˛o£
(
¢d_øwmidi_t
 *
rmidi
)

62 
¢d_øwmidi_vútuÆ_t
 *
vút
 = 
rmidi
->
¥iv©e_d©a
;

63 
vút
->
›í
--;

64 i‡(
vút
->
›í
)

66 
	`¢d_£q_˛o£
(
vút
->
h™dÀ
);

67 i‡(
vút
->
midi_evít
)

68 
	`¢d_midi_evít_‰ì
(
vút
->
midi_evít
);

69 
	`‰ì
(
vút
);

71 
	}
}

73 
	$¢d_øwmidi_vútuÆ_n⁄block
(
¢d_øwmidi_t
 *
rmidi
, 
n⁄block
)

75 
¢d_øwmidi_vútuÆ_t
 *
vút
 = 
rmidi
->
¥iv©e_d©a
;

77  
	`¢d_£q_n⁄block
(
vút
->
h™dÀ
, 
n⁄block
);

78 
	}
}

80 
	$¢d_øwmidi_vútuÆ_öfo
(
¢d_øwmidi_t
 *
rmidi
, 
¢d_øwmidi_öfo_t
 * 
öfo
)

84 
öfo
->
°ªam
 = 
rmidi
->stream;

86 
öfo
->
ˇrd
 = 0;

87 
öfo
->
devi˚
 = 0;

88 
öfo
->
subdevi˚
 = 0;

89 
öfo
->
Êags
 = 0;

90 
	`°r˝y
((*)
öfo
->
id
, "Virtual");

91 
	`°r˝y
((*)
öfo
->
«me
, "Virtual RawMIDI");

92 
	`°r˝y
((*)
öfo
->
sub«me
, "Virtual RawMIDI");

93 
öfo
->
subdevi˚s_cou¡
 = 1;

94 
öfo
->
subdevi˚s_avaû
 = 0;

96 
	}
}

98 
	$¢d_øwmidi_vútuÆ_öput_∑øms
(
¢d_øwmidi_vútuÆ_t
 *
vút
, 
¢d_øwmidi_∑øms_t
 *
∑øms
)

100 
îr
;

103 i‡(
∑øms
->
buf„r_size
 < (
¢d_£q_evít_t
) ||

104 
∑øms
->
buf„r_size
 > 1024L * 1024L) {

105  -
EINVAL
;

107 i‡(
∑øms
->
buf„r_size
 !
	`¢d_£q_gë_öput_buf„r_size
(
vút
->
h™dÀ
)) {

108 
îr
 = 
	`¢d_£q_£t_öput_buf„r_size
(
vút
->
h™dÀ
, 
∑øms
->
buf„r_size
);

109 i‡(
îr
 < 0)

110  
îr
;

111 
∑øms
->
buf„r_size
 = 
	`¢d_£q_gë_öput_buf„r_size
(
vút
->
h™dÀ
);

115 
	}
}

118 
	$¢d_øwmidi_vútuÆ_ouçut_∑øms
(
¢d_øwmidi_vútuÆ_t
 *
vút
, 
¢d_øwmidi_∑øms_t
 *
∑øms
)

120 
îr
;

123 i‡(
∑øms
->
buf„r_size
 < (
¢d_£q_evít_t
) ||

124 
∑øms
->
buf„r_size
 > 1024L * 1024L) {

125  -
EINVAL
;

127 i‡(
∑øms
->
buf„r_size
 !
	`¢d_£q_gë_ouçut_buf„r_size
(
vút
->
h™dÀ
)) {

128 
îr
 = 
	`¢d_£q_£t_ouçut_buf„r_size
(
vút
->
h™dÀ
, 
∑øms
->
buf„r_size
);

129 i‡(
îr
 < 0)

130  
îr
;

131 
∑øms
->
buf„r_size
 = 
	`¢d_£q_gë_ouçut_buf„r_size
(
vút
->
h™dÀ
);

134 
	}
}

137 
	$¢d_øwmidi_vútuÆ_∑øms
(
¢d_øwmidi_t
 *
rmidi
, 
¢d_øwmidi_∑øms_t
 * 
∑øms
)

139 
¢d_øwmidi_vútuÆ_t
 *
vút
 = 
rmidi
->
¥iv©e_d©a
;

140 
∑øms
->
°ªam
 = 
rmidi
->stream;

142 i‡(
rmidi
->
°ªam
 =
SND_RAWMIDI_STREAM_INPUT
)

143  
	`¢d_øwmidi_vútuÆ_öput_∑øms
(
vút
, 
∑øms
);

145  
	`¢d_øwmidi_vútuÆ_ouçut_∑øms
(
vút
, 
∑øms
);

146 
	}
}

148 
	$¢d_øwmidi_vútuÆ_°©us
(
¢d_øwmidi_t
 *
rmidi
, 
¢d_øwmidi_°©us_t
 * 
°©us
)

151 
	`mem£t
(
°©us
, 0, (*status));

152 
°©us
->
°ªam
 = 
rmidi
->stream;

154 
	}
}

156 
	$¢d_øwmidi_vútuÆ_dr›
(
¢d_øwmidi_t
 *
rmidi
)

158 
¢d_øwmidi_vútuÆ_t
 *
vút
 = 
rmidi
->
¥iv©e_d©a
;

159 i‡(
rmidi
->
°ªam
 =
SND_RAWMIDI_STREAM_OUTPUT
) {

160 
	`¢d_£q_dr›_ouçut
(
vút
->
h™dÀ
);

161 
	`¢d_midi_evít_ª£t_ícode
(
vút
->
midi_evít
);

162 
vút
->
≥ndög
 = 0;

164 
	`¢d_£q_dr›_öput
(
vút
->
h™dÀ
);

165 
	`¢d_midi_evít_ª£t_decode
(
vút
->
midi_evít
);

166 
vút
->
ö_buf_ofs
 = 0;

169 
	}
}

171 
	$¢d_øwmidi_vútuÆ_døö
(
¢d_øwmidi_t
 *
rmidi
)

173 
¢d_øwmidi_vútuÆ_t
 *
vút
 = 
rmidi
->
¥iv©e_d©a
;

174 
îr
;

176 i‡(
rmidi
->
°ªam
 =
SND_RAWMIDI_STREAM_OUTPUT
) {

177 i‡(
vút
->
≥ndög
) {

178 
îr
 = 
	`¢d_£q_evít_ouçut
(
vút
->
h™dÀ
, &vút->
out_evít
);

179 i‡(
îr
 < 0)

180  
îr
;

181 
vút
->
≥ndög
 = 0;

183 
	`¢d_£q_døö_ouçut
(
vút
->
h™dÀ
);

184 
	`¢d_£q_sync_ouçut_queue
(
vút
->
h™dÀ
);

186  
	`¢d_øwmidi_vútuÆ_dr›
(
rmidi
);

187 
	}
}

189 
ssize_t
 
	$¢d_øwmidi_vútuÆ_wrôe
(
¢d_øwmidi_t
 *
rmidi
, c⁄° *
buf„r
, 
size_t
 
size
)

191 
¢d_øwmidi_vútuÆ_t
 *
vút
 = 
rmidi
->
¥iv©e_d©a
;

192 
ssize_t
 
ªsu…
 = 0;

193 
ssize_t
 
size1
;

194 
îr
;

196 i‡(
vút
->
≥ndög
) {

197 
îr
 = 
	`¢d_£q_evít_ouçut
(
vút
->
h™dÀ
, &vút->
out_evít
);

198 i‡(
îr
 < 0) {

199 i‡(
îr
 !-
EAGAIN
)

203 
vút
->
≥ndög
 = 0;

204  
îr
;

206 
vút
->
≥ndög
 = 0;

209 
size
 > 0) {

210 
size1
 = 
	`¢d_midi_evít_ícode
(
vút
->
midi_evít
, 
buf„r
, 
size
, &vút->
out_evít
);

211 i‡(
size1
 <= 0)

213 
size
 -
size1
;

214 
ªsu…
 +
size1
;

215 
buf„r
 +
size1
;

216 i‡(
vút
->
out_evít
.
ty≥
 =
SND_SEQ_EVENT_NONE
)

218 
	`¢d_£q_ev_£t_subs
(&
vút
->
out_evít
);

219 
	`¢d_£q_ev_£t_sour˚
(&
vút
->
out_evít
, vút->
p‹t
);

220 
	`¢d_£q_ev_£t_dúe˘
(&
vút
->
out_evít
);

221 
îr
 = 
	`¢d_£q_evít_ouçut
(
vút
->
h™dÀ
, &vút->
out_evít
);

222 i‡(
îr
 < 0) {

223 
vút
->
≥ndög
 = 1;

224  
ªsu…
 > 0 ?Ñesu… : 
îr
;

228 i‡(
ªsu…
 > 0)

229 
	`¢d_£q_døö_ouçut
(
vút
->
h™dÀ
);

231  
ªsu…
;

232 
	}
}

234 
ssize_t
 
	$¢d_øwmidi_vútuÆ_ªad
(
¢d_øwmidi_t
 *
rmidi
, *
buf„r
, 
size_t
 
size
)

236 
¢d_øwmidi_vútuÆ_t
 *
vút
 = 
rmidi
->
¥iv©e_d©a
;

237 
ssize_t
 
ªsu…
 = 0;

238 
size1
, 
îr
;

240 
size
 > 0) {

241 i‡(! 
vút
->
ö_buf_ofs
) {

242 
îr
 = 
	`¢d_£q_evít_öput_≥ndög
(
vút
->
h™dÀ
, 1);

243 i‡(
îr
 <0 && 
ªsu…
 > 0)

244  
ªsu…
;

245 
îr
 = 
	`¢d_£q_evít_öput
(
vút
->
h™dÀ
, &vút->
ö_evít
);

246 i‡(
îr
 < 0)

247  
ªsu…
 > 0 ?Ñesu… : 
îr
;

249 i‡(
vút
->
ö_evít
->
ty≥
 =
SND_SEQ_EVENT_SYSEX
) {

250 
vút
->
ö_buf_±r
 = vút->
ö_evít
->
d©a
.
ext
.
±r
;

251 
vút
->
ö_buf_size
 = vút->
ö_evít
->
d©a
.
ext
.
Àn
;

253 
vút
->
ö_buf_±r
 = vút->
ö_tmp_buf
;

254 
vút
->
ö_buf_size
 = 
	`¢d_midi_evít_decode
(vút->
midi_evít
,

255 (*)
vút
->
ö_tmp_buf
,

256 (
vút
->
ö_tmp_buf
),

257 
vút
->
ö_evít
);

259 i‡(
vút
->
ö_buf_size
 <= 0)

262 
size1
 = 
vút
->
ö_buf_size
 - vút->
ö_buf_ofs
;

263 i‡((
size_t
)
size1
 > 
size
) {

264 
	`mem˝y
(
buf„r
, 
vút
->
ö_buf_±r
 + vút->
ö_buf_ofs
, 
size
);

265 
vút
->
ö_buf_ofs
 +
size
;

266 
ªsu…
 +
size
;

269 
	`mem˝y
(
buf„r
, 
vút
->
ö_buf_±r
 + vút->
ö_buf_ofs
, 
size1
);

270 
size
 -
size1
;

271 
ªsu…
 +
size1
;

272 
buf„r
 +
size1
;

273 
vút
->
ö_buf_ofs
 = 0;

276  
ªsu…
;

277 
	}
}

279 c⁄° 
¢d_øwmidi_›s_t
 
	g¢d_øwmidi_vútuÆ_›s
 = {

280 .
˛o£
 = 
¢d_øwmidi_vútuÆ_˛o£
,

281 .
	gn⁄block
 = 
¢d_øwmidi_vútuÆ_n⁄block
,

282 .
	göfo
 = 
¢d_øwmidi_vútuÆ_öfo
,

283 .
	g∑øms
 = 
¢d_øwmidi_vútuÆ_∑øms
,

284 .
	g°©us
 = 
¢d_øwmidi_vútuÆ_°©us
,

285 .
	gdr›
 = 
¢d_øwmidi_vútuÆ_dr›
,

286 .
	gdøö
 = 
¢d_øwmidi_vútuÆ_døö
,

287 .
	gwrôe
 = 
¢d_øwmidi_vútuÆ_wrôe
,

288 .
	gªad
 = 
¢d_øwmidi_vútuÆ_ªad
,

311 
	$¢d_øwmidi_vútuÆ_›í
(
¢d_øwmidi_t
 **
öpuç
, snd_øwmidi_à**
ouçuç
,

312 c⁄° *
«me
, 
¢d_£q_t
 *
£q_h™dÀ
, 
p‹t
,

313 
mîge
, 
mode
)

315 
îr
;

316 
¢d_øwmidi_t
 *
rmidi
 = 
NULL
;

317 
¢d_øwmidi_vútuÆ_t
 *
vút
 = 
NULL
;

318 
pﬁlfd
 
pfd
;

320 i‡(
öpuç
)

321 *
öpuç
 = 0;

322 i‡(
ouçuç
)

323 *
ouçuç
 = 0;

325 
vút
 = 
	`ˇŒoc
(1, (*virt));

326 i‡(
vút
 =
NULL
) {

327 
îr
 = -
ENOMEM
;

328 
_îr
;

330 
vút
->
h™dÀ
 = 
£q_h™dÀ
;

331 
vút
->
p‹t
 =Öort;

332 
îr
 = 
	`¢d_midi_evít_√w
(256, &
vút
->
midi_evít
);

333 i‡(
îr
 < 0)

334 
_îr
;

335 
	`¢d_midi_evít_öô
(
vút
->
midi_evít
);

336 
	`¢d_midi_evít_no_°©us
(
vút
->
midi_evít
, !
mîge
);

338 i‡(
öpuç
) {

339 
rmidi
 = 
	`ˇŒoc
(1, (*rmidi));

340 i‡(
rmidi
 =
NULL
) {

341 
îr
 = -
ENOMEM
;

342 
_îr
;

344 i‡(
«me
)

345 
rmidi
->
«me
 = 
	`°rdup
(name);

346 
rmidi
->
ty≥
 = 
SND_RAWMIDI_TYPE_VIRTUAL
;

347 
rmidi
->
°ªam
 = 
SND_RAWMIDI_STREAM_INPUT
;

348 
rmidi
->
mode
 = mode;

349 
îr
 = 
	`¢d_£q_pﬁl_des¸ùt‹s
(
£q_h™dÀ
, &
pfd
, 1, 
POLLIN
);

350 i‡(
îr
 < 0)

351 
_îr
;

352 
rmidi
->
pﬁl_fd
 = 
pfd
.
fd
;

353 
rmidi
->
›s
 = &
¢d_øwmidi_vútuÆ_›s
;

354 
rmidi
->
¥iv©e_d©a
 = 
vút
;

355 
vút
->
›í
++;

356 *
öpuç
 = 
rmidi
;

358 i‡(
ouçuç
) {

359 
rmidi
 = 
	`ˇŒoc
(1, (*rmidi));

360 i‡(
rmidi
 =
NULL
) {

361 
îr
 = -
ENOMEM
;

362 
_îr
;

364 i‡(
«me
)

365 
rmidi
->
«me
 = 
	`°rdup
(name);

366 
rmidi
->
ty≥
 = 
SND_RAWMIDI_TYPE_VIRTUAL
;

367 
rmidi
->
°ªam
 = 
SND_RAWMIDI_STREAM_OUTPUT
;

368 
rmidi
->
mode
 = mode;

369 
îr
 = 
	`¢d_£q_pﬁl_des¸ùt‹s
(
£q_h™dÀ
, &
pfd
, 1, 
POLLOUT
);

370 i‡(
îr
 < 0)

371 
_îr
;

372 
rmidi
->
pﬁl_fd
 = 
pfd
.
fd
;

373 
rmidi
->
›s
 = &
¢d_øwmidi_vútuÆ_›s
;

374 
rmidi
->
¥iv©e_d©a
 = 
vút
;

375 
vút
->
›í
++;

376 *
ouçuç
 = 
rmidi
;

381 
_îr
:

382 i‡(
£q_h™dÀ
)

383 
	`¢d_£q_˛o£
(
£q_h™dÀ
);

384 i‡(
vút
) {

385 i‡(
vút
->
midi_evít
)

386 
	`¢d_midi_evít_‰ì
(
vút
->
midi_evít
);

387 
	`‰ì
(
vút
);

389 i‡(
öpuç
)

390 
	`‰ì
(*
öpuç
);

391 i‡(
ouçuç
)

392 
	`‰ì
(*
ouçuç
);

393 
	`‰ì
(
rmidi
);

394  
îr
;

395 
	}
}

397 
	$_¢d_øwmidi_vútuÆ_›í
(
¢d_øwmidi_t
 **
öpuç
, snd_øwmidi_à**
ouçuç
,

398 *
«me
, 
¢d_c⁄fig_t
 *
roŸ
 
ATTRIBUTE_UNUSED
,

399 
¢d_c⁄fig_t
 *
c⁄f
, 
mode
)

401 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

402 c⁄° *
¶ave_°r
 = 
NULL
;

403 
îr
;

404 
°ªams
, 
£q_mode
;

405 
mîge
 = 1;

406 
p‹t
;

407 
ˇps
;

408 
¢d_£q_t
 *
£q_h™dÀ
;

410 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

411 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

412 c⁄° *
id
;

413 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

415 i‡(
	`¢d_øwmidi_c⁄f_gíîic_id
(
id
))

417 i‡(
	`°rcmp
(
id
, "slave") == 0) {

418 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
¶ave_°r
);

419 i‡(
îr
 < 0)

420  
îr
;

423 i‡(
	`°rcmp
(
id
, "merge") == 0) {

424 
mîge
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

427  -
EINVAL
;

430 
°ªams
 = 0;

431 i‡(
öpuç
)

432 
°ªams
 |
SND_SEQ_OPEN_INPUT
;

433 i‡(
ouçuç
)

434 
°ªams
 |
SND_SEQ_OPEN_OUTPUT
;

435 i‡(! 
°ªams
)

436  -
EINVAL
;

438 
£q_mode
 = 0;

439 i‡(
mode
 & 
SND_RAWMIDI_NONBLOCK
)

440 
£q_mode
 |
SND_SEQ_NONBLOCK
;

442 i‡(! 
¶ave_°r
)

443 
¶ave_°r
 = "default";

444 
îr
 = 
	`_¢d_£q_›í_lc⁄f
(&
£q_h™dÀ
, 
¶ave_°r
, 
°ªams
, 
£q_mode
,

445 
roŸ
, 
c⁄f
);

446 i‡(
îr
 < 0)

447  
îr
;

449 
ˇps
 = 0;

450 i‡(
öpuç
)

451 
ˇps
 |
SND_SEQ_PORT_CAP_WRITE
 | 
SND_SEQ_PORT_CAP_SYNC_WRITE
 | 
SND_SEQ_PORT_CAP_SUBS_WRITE
;

452 i‡(
ouçuç
)

453 
ˇps
 |
SND_SEQ_PORT_CAP_READ
 | 
SND_SEQ_PORT_CAP_SYNC_READ
 | 
SND_SEQ_PORT_CAP_SUBS_READ
;

454 i‡(
öpuç
 && 
ouçuç
)

455 
ˇps
 |
SNDRV_SEQ_PORT_CAP_DUPLEX
;

457 
p‹t
 = 
	`¢d_£q_¸óã_sim∂e_p‹t
(
£q_h™dÀ
, "Virtual RawMIDI",

458 
ˇps
, 
SNDRV_SEQ_PORT_TYPE_MIDI_GENERIC
);

459 i‡(
p‹t
 < 0) {

460 
	`¢d_£q_˛o£
(
£q_h™dÀ
);

461  
p‹t
;

464  
	`¢d_øwmidi_vútuÆ_›í
(
öpuç
, 
ouçuç
, 
«me
, 
£q_h™dÀ
, 
p‹t
,

465 
mîge
, 
mode
);

466 
	}
}

468 #i‚de‡
DOC_HIDDEN


469 
SND_DLSYM_BUILD_VERSION
(
_¢d_øwmidi_vútuÆ_›í
, 
SND_RAWMIDI_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/ump.c

7 
	~"øwmidi_loˇl.h
"

8 
	~"ump_loˇl.h
"

10 
	$gë_øwmidi_Êags
(
¢d_ump_t
 *
ump
)

12 
¢d_øwmidi_öfo_t
 
öfo
;

13 
îr
;

15 
îr
 = 
	`¢d_øwmidi_öfo
(
ump
->
øwmidi
, &
öfo
);

16 i‡(
îr
 < 0)

17  
îr
;

18 i‡(!(
öfo
.
Êags
 & 
SNDRV_RAWMIDI_INFO_UMP
))

19  -
EINVAL
;

20 
ump
->
Êags
 = 
öfo
.flags;

22 
	}
}

35 
	$¢d_ump_›í
(
¢d_ump_t
 **
öpuç
, snd_ump_à**
ouçuç
, c⁄° *
«me
,

36 
mode
)

38 
¢d_ump_t
 *
öput
 = 
NULL
, *
ouçut
 = NULL;

39 
îr
;

41 i‡(
öpuç
)

42 *
öpuç
 = 
NULL
;

43 i‡(
ouçuç
)

44 *
ouçuç
 = 
NULL
;

45 i‡(!
öpuç
 && !
ouçuç
)

46  -
EINVAL
;

48 
îr
 = -
ENOMEM
;

49 i‡(
öpuç
) {

50 
öput
 = 
	`ˇŒoc
(1, (*input));

51 i‡(!
öput
)

52 
îr‹
;

53 
öput
->
is_öput
 = 1;

55 i‡(
ouçuç
) {

56 
ouçut
 = 
	`ˇŒoc
(1, (*output));

57 i‡(!
ouçut
)

58 
îr‹
;

61 
îr
 = 
	`¢d_øwmidi_›í
(
öput
 ? &öput->
øwmidi
 : 
NULL
,

62 
ouçut
 ? &ouçut->
øwmidi
 : 
NULL
,

63 
«me
, 
mode
 | 
_SND_RAWMIDI_OPEN_UMP
);

64 i‡(
îr
 < 0)

65 
îr‹
;

67 i‡(
öput
) {

68 
îr
 = 
	`gë_øwmidi_Êags
(
öput
);

69 i‡(
îr
 < 0)

70 
îr‹
;

72 i‡(
ouçut
) {

73 
îr
 = 
	`gë_øwmidi_Êags
(
ouçut
);

74 i‡(
îr
 < 0)

75 
îr‹
;

78 i‡(
öpuç
)

79 *
öpuç
 = 
öput
;

80 i‡(
ouçuç
)

81 *
ouçuç
 = 
ouçut
;

85 
îr‹
:

86 i‡(
öput
) {

87 i‡(
öput
->
øwmidi
)

88 
	`¢d_øwmidi_˛o£
(
öput
->
øwmidi
);

89 
	`‰ì
(
öput
);

91 i‡(
ouçut
) {

92 i‡(
ouçut
->
øwmidi
)

93 
	`¢d_øwmidi_˛o£
(
ouçut
->
øwmidi
);

94 
	`‰ì
(
ouçut
);

96  
îr
;

97 
	}
}

107 
	$¢d_ump_˛o£
(
¢d_ump_t
 *
ump
)

109 
îr
;

111 
îr
 = 
	`¢d_øwmidi_˛o£
(
ump
->
øwmidi
);

112 
	`‰ì
(
ump
);

113  
îr
;

114 
	}
}

123 
¢d_øwmidi_t
 *
	$¢d_ump_øwmidi
(
¢d_ump_t
 *
ump
)

125  
ump
->
øwmidi
;

126 
	}
}

136 c⁄° *
	$¢d_ump_«me
(
¢d_ump_t
 *
ump
)

138  
	`¢d_øwmidi_«me
(
ump
->
øwmidi
);

139 
	}
}

146 
	$¢d_ump_pﬁl_des¸ùt‹s_cou¡
(
¢d_ump_t
 *
ump
)

148  
	`¢d_øwmidi_pﬁl_des¸ùt‹s_cou¡
(
ump
->
øwmidi
);

149 
	}
}

158 
	$¢d_ump_pﬁl_des¸ùt‹s
(
¢d_ump_t
 *
ump
, 
pﬁlfd
 *
pfds
,

159 
•a˚
)

161  
	`¢d_øwmidi_pﬁl_des¸ùt‹s
(
ump
->
øwmidi
, 
pfds
, 
•a˚
);

162 
	}
}

172 
	$¢d_ump_pﬁl_des¸ùt‹s_ªvíts
(
¢d_ump_t
 *
ump
, 
pﬁlfd
 *
pfds
,

173 
nfds
, *
ªvíts
)

175  
	`¢d_øwmidi_pﬁl_des¸ùt‹s_ªvíts
(
ump
->
øwmidi
, 
pfds
, 
nfds
,

176 
ªvíts
);

177 
	}
}

188 
	$¢d_ump_n⁄block
(
¢d_ump_t
 *
ump
, 
n⁄block
)

190  
	`¢d_øwmidi_n⁄block
(
ump
->
øwmidi
, 
n⁄block
);

191 
	}
}

199 
	$¢d_ump_øwmidi_öfo
(
¢d_ump_t
 *
ump
, 
¢d_øwmidi_öfo_t
 *
öfo
)

201  
	`¢d_øwmidi_öfo
(
ump
->
øwmidi
, 
öfo
);

202 
	}
}

210 
	$¢d_ump_øwmidi_∑øms
(
¢d_ump_t
 *
ump
, 
¢d_øwmidi_∑øms_t
 *
∑øms
)

212  
	`¢d_øwmidi_∑øms
(
ump
->
øwmidi
, 
∑øms
);

213 
	}
}

221 
	$¢d_ump_øwmidi_∑øms_cuºít
(
¢d_ump_t
 *
ump
, 
¢d_øwmidi_∑øms_t
 *
∑øms
)

223  
	`¢d_øwmidi_∑øms_cuºít
(
ump
->
øwmidi
, 
∑øms
);

224 
	}
}

232 
	$¢d_ump_øwmidi_°©us
(
¢d_ump_t
 *
ump
, 
¢d_øwmidi_°©us_t
 *
°©us
)

234  
	`¢d_øwmidi_°©us
(
ump
->
øwmidi
, 
°©us
);

235 
	}
}

242 
	$¢d_ump_dr›
(
¢d_ump_t
 *
ump
)

244  
	`¢d_øwmidi_dr›
(
ump
->
øwmidi
);

245 
	}
}

255 
	$¢d_ump_døö
(
¢d_ump_t
 *
ump
)

257  
	`¢d_øwmidi_døö
(
ump
->
øwmidi
);

258 
	}
}

266 
ssize_t
 
	$¢d_ump_wrôe
(
¢d_ump_t
 *
ump
, c⁄° *
buf„r
, 
size_t
 
size
)

268 i‡(
ump
->
is_öput
)

269  -
EINVAL
;

270  
	`¢d_øwmidi_wrôe
(
ump
->
øwmidi
, 
buf„r
, 
size
);

271 
	}
}

280 
ssize_t
 
	$¢d_ump_ªad
(
¢d_ump_t
 *
ump
, *
buf„r
, 
size_t
 
size
)

282 i‡(!
ump
->
is_öput
)

283  -
EINVAL
;

284  
	`¢d_øwmidi_ªad
(
ump
->
øwmidi
, 
buf„r
, 
size
);

285 
	}
}

295 
ssize_t
 
	$¢d_ump_åód
(
¢d_ump_t
 *
ump
, 
time•ec
 *
t°amp
, *
buf„r
,

296 
size_t
 
size
)

298 i‡(!
ump
->
is_öput
)

299  -
EINVAL
;

300  
	`¢d_øwmidi_åód
(
ump
->
øwmidi
, 
t°amp
, 
buf„r
, 
size
);

301 
	}
}

307 
size_t
 
	$¢d_ump_ídpoöt_öfo_sizeof
()

309  (
¢d_ump_ídpoöt_öfo_t
);

310 
	}
}

320 
	$¢d_ump_ídpoöt_öfo_mÆloc
(
¢d_ump_ídpoöt_öfo_t
 **
öfo
)

322 *
öfo
 = 
	`ˇŒoc
(1, (
¢d_ump_ídpoöt_öfo_t
));

323 i‡(!*
öfo
)

324  -
ENOMEM
;

326 
	}
}

335 
	$¢d_ump_ídpoöt_öfo_‰ì
(
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

337 
	`‰ì
(
öfo
);

338 
	}
}

345 
	$¢d_ump_ídpoöt_öfo_c›y
(
¢d_ump_ídpoöt_öfo_t
 *
d°
,

346 c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
§c
)

348 *
d°
 = *
§c
;

349 
	}
}

356 
	$¢d_ump_ídpoöt_öfo_gë_ˇrd
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

358  
öfo
->
ˇrd
;

359 
	}
}

366 
	$¢d_ump_ídpoöt_öfo_gë_devi˚
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

368  
öfo
->
devi˚
;

369 
	}
}

376 
	$¢d_ump_ídpoöt_öfo_gë_Êags
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

378  
öfo
->
Êags
;

379 
	}
}

386 
	$¢d_ump_ídpoöt_öfo_gë_¥Ÿocﬁ_ˇps
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

388  
öfo
->
¥Ÿocﬁ_ˇps
;

389 
	}
}

396 
	$¢d_ump_ídpoöt_öfo_gë_¥Ÿocﬁ
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

398  
öfo
->
¥Ÿocﬁ
;

399 
	}
}

406 
	$¢d_ump_ídpoöt_öfo_gë_num_blocks
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

408  
öfo
->
num_blocks
;

409 
	}
}

416 
	$¢d_ump_ídpoöt_öfo_gë_vîsi⁄
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

418  
öfo
->
vîsi⁄
;

419 
	}
}

426 
	$¢d_ump_ídpoöt_öfo_gë_m™uÁ˘uªr_id
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

428  
öfo
->
m™uÁ˘uªr_id
;

429 
	}
}

436 
	$¢d_ump_ídpoöt_öfo_gë_Ámûy_id
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

438  
öfo
->
Ámûy_id
;

439 
	}
}

446 
	$¢d_ump_ídpoöt_öfo_gë_modñ_id
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

448  
öfo
->
modñ_id
;

449 
	}
}

456 c⁄° *
	$¢d_ump_ídpoöt_öfo_gë_sw_ªvisi⁄
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

458  
öfo
->
sw_ªvisi⁄
;

459 
	}
}

466 c⁄° *
	$¢d_ump_ídpoöt_öfo_gë_«me
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

468  (c⁄° *)
öfo
->
«me
;

469 
	}
}

476 c⁄° *
	$¢d_ump_ídpoöt_öfo_gë_¥odu˘_id
(c⁄° 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

478  (c⁄° *)
öfo
->
¥odu˘_id
;

479 
	}
}

487 
	$¢d_ump_ídpoöt_öfo
(
¢d_ump_t
 *
ump
, 
¢d_ump_ídpoöt_öfo_t
 *
öfo
)

489  
	`_¢d_øwmidi_ump_ídpoöt_öfo
(
ump
->
øwmidi
, 
öfo
);

490 
	}
}

496 
size_t
 
	$¢d_ump_block_öfo_sizeof
()

498  (
¢d_ump_block_öfo_t
);

499 
	}
}

509 
	$¢d_ump_block_öfo_mÆloc
(
¢d_ump_block_öfo_t
 **
öfo
)

511 *
öfo
 = 
	`ˇŒoc
(1, (
¢d_ump_block_öfo_t
));

512 i‡(!*
öfo
)

513  -
ENOMEM
;

515 
	}
}

524 
	$¢d_ump_block_öfo_‰ì
(
¢d_ump_block_öfo_t
 *
öfo
)

526 
	`‰ì
(
öfo
);

527 
	}
}

534 
	$¢d_ump_block_öfo_c›y
(
¢d_ump_block_öfo_t
 *
d°
,

535 c⁄° 
¢d_ump_block_öfo_t
 *
§c
)

537 *
d°
 = *
§c
;

538 
	}
}

545 
	$¢d_ump_block_öfo_gë_ˇrd
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
)

547  
öfo
->
ˇrd
;

548 
	}
}

555 
	$¢d_ump_block_öfo_gë_devi˚
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
)

557  
öfo
->
devi˚
;

558 
	}
}

565 
	$¢d_ump_block_öfo_gë_block_id
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
)

567  
öfo
->
block_id
;

568 
	}
}

575 
	$¢d_ump_block_öfo_£t_block_id
(
¢d_ump_block_öfo_t
 *
öfo
,

576 
id
)

578 
öfo
->
block_id
 = 
id
;

579 
	}
}

586 
	$¢d_ump_block_öfo_gë_a˘ive
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
)

588  
öfo
->
a˘ive
;

589 
	}
}

596 
	$¢d_ump_block_öfo_gë_Êags
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
)

598  
öfo
->
Êags
;

599 
	}
}

606 
	$¢d_ump_block_öfo_gë_dúe˘i⁄
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
)

608  
öfo
->
dúe˘i⁄
;

609 
	}
}

616 
	$¢d_ump_block_öfo_gë_fú°_group
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
)

618  
öfo
->
fú°_group
;

619 
	}
}

626 
	$¢d_ump_block_öfo_gë_num_groups
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
)

628  
öfo
->
num_groups
;

629 
	}
}

636 
	$¢d_ump_block_öfo_gë_midi_ci_vîsi⁄
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
)

638  
öfo
->
midi_ci_vîsi⁄
;

639 
	}
}

646 
	$¢d_ump_block_öfo_gë_sy£x8_°ªams
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
)

648  
öfo
->
sy£x8_°ªams
;

649 
	}
}

656 
	$¢d_ump_block_öfo_gë_ui_höt
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
)

658  
öfo
->
ui_höt
;

659 
	}
}

666 c⁄° *
	$¢d_ump_block_öfo_gë_«me
(c⁄° 
¢d_ump_block_öfo_t
 *
öfo
)

668  (c⁄° *)
öfo
->
«me
;

669 
	}
}

680 
	$¢d_ump_block_öfo
(
¢d_ump_t
 *
ump
, 
¢d_ump_block_öfo_t
 *
öfo
)

682  
	`_¢d_øwmidi_ump_block_öfo
(
ump
->
øwmidi
, 
öfo
);

683 
	}
}

688 
	$ex∑nd_sy£x_d©a
(c⁄° 
uöt32_t
 *
d©a
, 
uöt8_t
 *
buf
,

689 
size_t
 
maxÀn
, 
byãs
, 
off£t
)

691 
size
 = 0;

693 ; 
byãs
; byãs--, 
size
++) {

694 i‡(!
maxÀn
)

696 
buf
[
size
] = (*
d©a
 >> 
off£t
) & 0x7f;

697 i‡(!
off£t
) {

698 
off£t
 = 24;

699 
d©a
++;

701 
off£t
 -= 8;

705  
size
;

706 
	}
}

708 
	$ex∑nd_sy£x7
(c⁄° 
uöt32_t
 *
ump
, 
uöt8_t
 *
buf
, 
size_t
 
maxÀn
,

709 
size_t
 *
fûÀd
)

711 
°©us
;

712 
byãs
;

714 *
fûÀd
 = 0;

715 i‡(!
maxÀn
)

718 
°©us
 = 
	`¢d_ump_sy£x_msg_°©us
(
ump
);

719 
byãs
 = 
	`¢d_ump_sy£x_msg_Àngth
(
ump
);

720 i‡(
byãs
 > 6)

723 *
fûÀd
 = 
	`ex∑nd_sy£x_d©a
(
ump
, 
buf
, 
maxÀn
, 
byãs
, 8);

724  (
°©us
 =
SND_UMP_SYSEX_STATUS_SINGLE
 ||

725 
°©us
 =
SND_UMP_SYSEX_STATUS_END
);

726 
	}
}

728 
	$ex∑nd_sy£x8
(c⁄° 
uöt32_t
 *
ump
, 
uöt8_t
 *
buf
, 
size_t
 
maxÀn
,

729 
size_t
 *
fûÀd
)

731 
°©us
;

732 
byãs
;

734 *
fûÀd
 = 0;

735 i‡(!
maxÀn
)

738 
°©us
 = 
	`¢d_ump_sy£x_msg_°©us
(
ump
);

739 i‡(
°©us
 > 
SND_UMP_SYSEX_STATUS_END
)

741 
byãs
 = 
	`¢d_ump_sy£x_msg_Àngth
(
ump
);

742 i‡(!
byãs
 || bytes > 14)

745 *
fûÀd
 = 
	`ex∑nd_sy£x_d©a
(
ump
, 
buf
, 
maxÀn
, 
byãs
 - 1, 0);

746  (
°©us
 =
SND_UMP_SYSEX_STATUS_SINGLE
 ||

747 
°©us
 =
SND_UMP_SYSEX_STATUS_END
);

748 
	}
}

758 
	$¢d_ump_msg_sy£x_ex∑nd
(c⁄° 
uöt32_t
 *
ump
, 
uöt8_t
 *
buf
, 
size_t
 
maxÀn
,

759 
size_t
 *
fûÀd
)

761 
	`¢d_ump_msg_ty≥
(
ump
)) {

762 
SND_UMP_MSG_TYPE_DATA
:

763  
	`ex∑nd_sy£x7
(
ump
, 
buf
, 
maxÀn
, 
fûÀd
);

764 
SND_UMP_MSG_TYPE_EXTENDED_DATA
:

765  
	`ex∑nd_sy£x8
(
ump
, 
buf
, 
maxÀn
, 
fûÀd
);

767  -
EINVAL
;

769 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/ump_local.h

2 
	~"øwmidi.h
"

3 
	~"ump.h
"

4 
	~"ump_msg.h
"

6 #i‚de‡
DOC_HIDDEN


7 
	s_¢d_ump
 {

8 
¢d_øwmidi_t
 *
	møwmidi
;

9 
	mÊags
;

10 
	mis_öput
;

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq.c

780 
	~"£q_loˇl.h
"

781 
	~<pﬁl.h
>

800 c⁄° *
	$¢d_£q_«me
(
¢d_£q_t
 *
£q
)

802 
	`as£π
(
£q
);

803  
£q
->
«me
;

804 
	}
}

815 
¢d_£q_ty≥_t
 
	$¢d_£q_ty≥
(
¢d_£q_t
 *
£q
)

817 
	`as£π
(
£q
);

818  
£q
->
ty≥
;

819 
	}
}

821 
	$¢d_£q_›í_c⁄f
(
¢d_£q_t
 **
£qp
, c⁄° *
«me
,

822 
¢d_c⁄fig_t
 *
£q_roŸ
, snd_c⁄fig_à*
£q_c⁄f
,

823 
°ªams
, 
mode
)

825 c⁄° *
°r
;

826 
buf
[256], 
îrbuf
[256];

827 
îr
;

828 
¢d_c⁄fig_t
 *
c⁄f
, *
ty≥_c⁄f
 = 
NULL
;

829 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

830 c⁄° *
id
;

831 c⁄° *
lib
 = 
NULL
, *
›í_«me
 = NULL;

832 (*
›í_func
)(
¢d_£q_t
 **, const *,

833 
¢d_c⁄fig_t
 *, snd_config_t *,

834 , Ë
NULL
;

835 #i‚de‡
PIC


836 *
	`¢d_£q_›í_symbﬁs
();

838 *
h
 = 
NULL
;

839 i‡(
	`¢d_c⁄fig_gë_ty≥
(
£q_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

840 i‡(
«me
)

841 
	`SNDERR
("InvÆidÅy≥ f‹ SEQ %†deföôi⁄", 
«me
);

843 
	`SNDERR
("InvalidÅype for SEQ definition");

844  -
EINVAL
;

846 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
£q_c⁄f
, "ty≥", &
c⁄f
);

847 i‡(
îr
 < 0) {

848 
	`SNDERR
("type isÇot defined");

849  
îr
;

851 
îr
 = 
	`¢d_c⁄fig_gë_id
(
c⁄f
, &
id
);

852 i‡(
îr
 < 0) {

853 
	`SNDERR
("unableÅo get id");

854  
îr
;

856 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
c⁄f
, &
°r
);

857 i‡(
îr
 < 0) {

858 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

859  
îr
;

861 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
£q_roŸ
, "£q_ty≥", 
°r
, &
ty≥_c⁄f
);

862 i‡(
îr
 >= 0) {

863 i‡(
	`¢d_c⁄fig_gë_ty≥
(
ty≥_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

864 
	`SNDERR
("InvÆidÅy≥ f‹ SEQÅy≥ %†deföôi⁄", 
°r
);

865 
_îr
;

867 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
ty≥_c⁄f
) {

868 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

869 c⁄° *
id
;

870 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

872 i‡(
	`°rcmp
(
id
, "comment") == 0)

874 i‡(
	`°rcmp
(
id
, "lib") == 0) {

875 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
lib
);

876 i‡(
îr
 < 0) {

877 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

878 
_îr
;

882 i‡(
	`°rcmp
(
id
, "open") == 0) {

883 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
›í_«me
);

884 i‡(
îr
 < 0) {

885 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

886 
_îr
;

890 
	`SNDERR
("Unknow¿fõld %s", 
id
);

891 
îr
 = -
EINVAL
;

892 
_îr
;

895 i‡(!
›í_«me
) {

896 
›í_«me
 = 
buf
;

897 
	`¢¥ötf
(
buf
, (buf), "_¢d_£q_%s_›í", 
°r
);

899 #i‚de‡
PIC


900 
	`¢d_£q_›í_symbﬁs
();

902 
h
 = 
	`INTERNAL
(
¢d_dl›í
)(
lib
, 
RTLD_NOW
, 
îrbuf
, (errbuf));

903 i‡(
h
)

904 
›í_func
 = 
	`¢d_dlsym
(
h
, 
›í_«me
, 
	`SND_DLSYM_VERSION
(
SND_SEQ_DLSYM_VERSION
));

905 
îr
 = 0;

906 i‡(!
h
) {

907 
	`SNDERR
("C™nŸ o≥¿sh¨edÜibøry %†(%s)", 
lib
, 
îrbuf
);

908 
îr
 = -
ENOENT
;

909 } i‡(!
›í_func
) {

910 
	`SNDERR
("symbﬁ %†i†nŸ deföed insidê%s", 
›í_«me
, 
lib
);

911 
	`¢d_dl˛o£
(
h
);

912 
îr
 = -
ENXIO
;

914 
_îr
:

915 i‡(
ty≥_c⁄f
)

916 
	`¢d_c⁄fig_dñëe
(
ty≥_c⁄f
);

917 i‡(! 
îr
) {

918 
îr
 = 
	`›í_func
(
£qp
, 
«me
, 
£q_roŸ
, 
£q_c⁄f
, 
°ªams
, 
mode
);

919 i‡(
îr
 < 0)

920 
	`¢d_dl˛o£
(
h
);

922 (*
£qp
)->
dl_h™dÀ
 = 
h
;

924  
îr
;

925 
	}
}

927 
	$¢d_£q_›í_noupd©e
(
¢d_£q_t
 **
£qp
, 
¢d_c⁄fig_t
 *
roŸ
,

928 c⁄° *
«me
, 
°ªams
, 
mode
,

929 
h›
)

931 
îr
;

932 
¢d_c⁄fig_t
 *
£q_c⁄f
;

933 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "£q", 
«me
, &
£q_c⁄f
);

934 i‡(
îr
 < 0) {

935 
	`SNDERR
("Unknow¿SEQ %s", 
«me
);

936  
îr
;

938 
	`¢d_c⁄fig_£t_h›
(
£q_c⁄f
, 
h›
);

939 
îr
 = 
	`¢d_£q_›í_c⁄f
(
£qp
, 
«me
, 
roŸ
, 
£q_c⁄f
, 
°ªams
, 
mode
);

940 
	`¢d_c⁄fig_dñëe
(
£q_c⁄f
);

941  
îr
;

942 
	}
}

974 
	$¢d_£q_›í
(
¢d_£q_t
 **
£qp
, c⁄° *
«me
,

975 
°ªams
, 
mode
)

977 
¢d_c⁄fig_t
 *
t›
;

978 
îr
;

980 
	`as£π
(
£qp
 && 
«me
);

981 i‡(
	`_¢d_is_ucm_devi˚
(
«me
)) {

982 
«me
 = 
	`uc_mgr_Æibcfg_by_devi˚
(&
t›
,Çame);

983 i‡(
«me
 =
NULL
)

984  -
ENODEV
;

986 
îr
 = 
	`¢d_c⁄fig_upd©e_ªf
(&
t›
);

987 i‡(
îr
 < 0)

988  
îr
;

990 
îr
 = 
	`¢d_£q_›í_noupd©e
(
£qp
, 
t›
, 
«me
, 
°ªams
, 
mode
, 0);

991 
	`¢d_c⁄fig_uƒef
(
t›
);

992  
îr
;

993 
	}
}

1010 
	$¢d_£q_›í_lc⁄f
(
¢d_£q_t
 **
£qp
, c⁄° *
«me
,

1011 
°ªams
, 
mode
, 
¢d_c⁄fig_t
 *
lc⁄f
)

1013 
	`as£π
(
£qp
 && 
«me
 && 
lc⁄f
);

1014  
	`¢d_£q_›í_noupd©e
(
£qp
, 
lc⁄f
, 
«me
, 
°ªams
, 
mode
, 0);

1015 
	}
}

1017 #i‚de‡
DOC_HIDDEN


1018 
	$_¢d_£q_›í_lc⁄f
(
¢d_£q_t
 **
£qp
, c⁄° *
«me
,

1019 
°ªams
, 
mode
, 
¢d_c⁄fig_t
 *
lc⁄f
,

1020 
¢d_c⁄fig_t
 *
∑ª¡_c⁄f
)

1022 
h›
;

1023 
	`as£π
(
£qp
 && 
«me
 && 
lc⁄f
);

1024 i‡((
h›
 = 
	`¢d_c⁄fig_check_h›
(
∑ª¡_c⁄f
)) < 0)

1025  
h›
;

1026  
	`¢d_£q_›í_noupd©e
(
£qp
, 
lc⁄f
, 
«me
, 
°ªams
, 
mode
, 
h›
 + 1);

1027 
	}
}

1043 
	$¢d_£q_˛o£
(
¢d_£q_t
 *
£q
)

1045 
îr
;

1046 
	`as£π
(
£q
);

1047 
îr
 = 
£q
->
›s
->
	`˛o£
(seq);

1048 i‡(
£q
->
dl_h™dÀ
)

1049 
	`¢d_dl˛o£
(
£q
->
dl_h™dÀ
);

1050 
	`‰ì
(
£q
->
obuf
);

1051 
	`‰ì
(
£q
->
ibuf
);

1052 
	`‰ì
(
£q
->
tmpbuf
);

1053 
	`‰ì
(
£q
->
«me
);

1054 
	`‰ì
(
£q
);

1055  
îr
;

1056 
	}
}

1070 
	$¢d_£q_pﬁl_des¸ùt‹s_cou¡
(
¢d_£q_t
 *
£q
, 
evíts
)

1072 
ªsu…
 = 0;

1073 
	`as£π
(
£q
);

1074 i‡(
evíts
 & 
POLLIN
) {

1075 
	`as£π
(
£q
->
°ªams
 & 
SND_SEQ_OPEN_INPUT
);

1076 
ªsu…
++;

1078 i‡(
evíts
 & 
POLLOUT
) {

1079 
	`as£π
(
£q
->
°ªams
 & 
SND_SEQ_OPEN_OUTPUT
);

1080 
ªsu…
++;

1082  
ªsu…
 ? 1 : 0;

1083 
	}
}

1103 
	$¢d_£q_pﬁl_des¸ùt‹s
(
¢d_£q_t
 *
£q
, 
pﬁlfd
 *
pfds
, 
•a˚
, 
evíts
)

1105 
ªvíts
 = 0;

1107 
	`as£π
(
£q
);

1108 i‡((
evíts
 & 
POLLIN
Ë&& 
•a˚
 >= 1) {

1109 
	`as£π
(
£q
->
°ªams
 & 
SND_SEQ_OPEN_INPUT
);

1110 
ªvíts
 |
POLLIN
|
POLLERR
|
POLLNVAL
;

1112 i‡((
evíts
 & 
POLLOUT
Ë&& 
•a˚
 >= 1) {

1113 
	`as£π
(
£q
->
°ªams
 & 
SND_SEQ_OPEN_OUTPUT
);

1114 
ªvíts
 |
POLLOUT
|
POLLERR
|
POLLNVAL
;

1116 i‡(!
ªvíts
)

1118 
pfds
->
fd
 = 
£q
->
pﬁl_fd
;

1119 
pfds
->
evíts
 = 
ªvíts
;

1121 
	}
}

1133 
	$¢d_£q_pﬁl_des¸ùt‹s_ªvíts
(
¢d_£q_t
 *
£q
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

1135 
	`as£π
(
£q
 && 
pfds
 && 
ªvíts
);

1136 i‡(
nfds
 == 1) {

1137 *
ªvíts
 = 
pfds
->revents;

1140  -
EINVAL
;

1141 
	}
}

1156 
	$¢d_£q_n⁄block
(
¢d_£q_t
 *
£q
, 
n⁄block
)

1158 
îr
;

1159 
	`as£π
(
£q
);

1160 
îr
 = 
£q
->
›s
->
	`n⁄block
(£q, 
n⁄block
);

1161 i‡(
îr
 < 0)

1162  
îr
;

1163 i‡(
n⁄block
)

1164 
£q
->
mode
 |
SND_SEQ_NONBLOCK
;

1166 
£q
->
mode
 &~
SND_SEQ_NONBLOCK
;

1168 
	}
}

1182 
	$¢d_£q_˛õ¡_id
(
¢d_£q_t
 *
£q
)

1184 
	`as£π
(
£q
);

1185  
£q
->
˛õ¡
;

1186 
	}
}

1199 
size_t
 
	$¢d_£q_gë_ouçut_buf„r_size
(
¢d_£q_t
 *
£q
)

1201 
	`as£π
(
£q
);

1202 i‡(!
£q
->
obuf
)

1204  
£q
->
obufsize
;

1205 
	}
}

1207 
ölöe
 
size_t
 
	$gë_∑ckë_size
(
¢d_£q_t
 *
£q
)

1209  
£q
->
∑ckë_size
 ? seq->∑ckë_sizê: (
¢d_£q_evít_t
);

1210 
	}
}

1222 
size_t
 
	$¢d_£q_gë_öput_buf„r_size
(
¢d_£q_t
 *
£q
)

1224 
	`as£π
(
£q
);

1225 i‡(!
£q
->
ibuf
)

1227  
£q
->
ibufsize
 * 
	`gë_∑ckë_size
(seq);

1228 
	}
}

1240 
	$¢d_£q_£t_ouçut_buf„r_size
(
¢d_£q_t
 *
£q
, 
size_t
 
size
)

1242 
	`as£π
(
£q
 && seq->
obuf
);

1243 
	`as£π
(
size
 >(
¢d_£q_evít_t
));

1244 
	`¢d_£q_dr›_ouçut
(
£q
);

1245 i‡(
size
 !
£q
->
obufsize
) {

1246 *
√wbuf
;

1247 
√wbuf
 = 
	`ˇŒoc
(1, 
size
);

1248 i‡(
√wbuf
 =
NULL
)

1249  -
ENOMEM
;

1250 
	`‰ì
(
£q
->
obuf
);

1251 
£q
->
obuf
 = 
√wbuf
;

1252 
£q
->
obufsize
 = 
size
;

1255 
	}
}

1267 
	$¢d_£q_£t_öput_buf„r_size
(
¢d_£q_t
 *
£q
, 
size_t
 
size
)

1269 
size_t
 
∑ckë_size
;

1271 
	`as£π
(
£q
 && seq->
ibuf
);

1272 
∑ckë_size
 = 
	`gë_∑ckë_size
(
£q
);

1273 
	`as£π
(
size
 >
∑ckë_size
);

1274 
	`¢d_£q_dr›_öput
(
£q
);

1275 
size
 = (sizê+ 
∑ckë_size
 - 1) /Öacket_size;

1276 i‡(
size
 !
£q
->
ibufsize
) {

1277 *
√wbuf
;

1279 
√wbuf
 = 
	`ˇŒoc
((
¢d_£q_ump_evít_t
), 
size
);

1280 i‡(
√wbuf
 =
NULL
)

1281  -
ENOMEM
;

1282 
	`‰ì
(
£q
->
ibuf
);

1283 
£q
->
ibuf
 = 
√wbuf
;

1284 
£q
->
ibufsize
 = 
size
;

1287 
	}
}

1294 
size_t
 
	$¢d_£q_sy°em_öfo_sizeof
()

1296  (
¢d_£q_sy°em_öfo_t
);

1297 
	}
}

1304 
	$¢d_£q_sy°em_öfo_mÆloc
(
¢d_£q_sy°em_öfo_t
 **
±r
)

1306 
	`as£π
(
±r
);

1307 *
±r
 = 
	`ˇŒoc
(1, (
¢d_£q_sy°em_öfo_t
));

1308 i‡(!*
±r
)

1309  -
ENOMEM
;

1311 
	}
}

1317 
	$¢d_£q_sy°em_öfo_‰ì
(
¢d_£q_sy°em_öfo_t
 *
obj
)

1319 
	`‰ì
(
obj
);

1320 
	}
}

1327 
	$¢d_£q_sy°em_öfo_c›y
(
¢d_£q_sy°em_öfo_t
 *
d°
, c⁄° snd_£q_sy°em_öfo_à*
§c
)

1329 
	`as£π
(
d°
 && 
§c
);

1330 *
d°
 = *
§c
;

1331 
	}
}

1341 
	$¢d_£q_sy°em_öfo_gë_queues
(c⁄° 
¢d_£q_sy°em_öfo_t
 *
öfo
)

1343 
	`as£π
(
öfo
);

1344  
öfo
->
queues
;

1345 
	}
}

1354 
	$¢d_£q_sy°em_öfo_gë_˛õ¡s
(c⁄° 
¢d_£q_sy°em_öfo_t
 *
öfo
)

1356 
	`as£π
(
öfo
);

1357  
öfo
->
˛õ¡s
;

1358 
	}
}

1367 
	$¢d_£q_sy°em_öfo_gë_p‹ts
(c⁄° 
¢d_£q_sy°em_öfo_t
 *
öfo
)

1369 
	`as£π
(
öfo
);

1370  
öfo
->
p‹ts
;

1371 
	}
}

1380 
	$¢d_£q_sy°em_öfo_gë_ch™√ls
(c⁄° 
¢d_£q_sy°em_öfo_t
 *
öfo
)

1382 
	`as£π
(
öfo
);

1383  
öfo
->
ch™√ls
;

1384 
	}
}

1393 
	$¢d_£q_sy°em_öfo_gë_cur_˛õ¡s
(c⁄° 
¢d_£q_sy°em_öfo_t
 *
öfo
)

1395 
	`as£π
(
öfo
);

1396  
öfo
->
cur_˛õ¡s
;

1397 
	}
}

1406 
	$¢d_£q_sy°em_öfo_gë_cur_queues
(c⁄° 
¢d_£q_sy°em_öfo_t
 *
öfo
)

1408 
	`as£π
(
öfo
);

1409  
öfo
->
cur_queues
;

1410 
	}
}

1422 
	$¢d_£q_sy°em_öfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_sy°em_öfo_t
 * 
öfo
)

1424 
	`as£π
(
£q
 && 
öfo
);

1425  
£q
->
›s
->
	`sy°em_öfo
(£q, 
öfo
);

1426 
	}
}

1435 
size_t
 
	$¢d_£q_˛õ¡_öfo_sizeof
()

1437  (
¢d_£q_˛õ¡_öfo_t
);

1438 
	}
}

1445 
	$¢d_£q_˛õ¡_öfo_mÆloc
(
¢d_£q_˛õ¡_öfo_t
 **
±r
)

1447 
	`as£π
(
±r
);

1448 *
±r
 = 
	`ˇŒoc
(1, (
¢d_£q_˛õ¡_öfo_t
));

1449 i‡(!*
±r
)

1450  -
ENOMEM
;

1452 
	}
}

1458 
	$¢d_£q_˛õ¡_öfo_‰ì
(
¢d_£q_˛õ¡_öfo_t
 *
obj
)

1460 
	`‰ì
(
obj
);

1461 
	}
}

1468 
	$¢d_£q_˛õ¡_öfo_c›y
(
¢d_£q_˛õ¡_öfo_t
 *
d°
, c⁄° snd_£q_˛õ¡_öfo_à*
§c
)

1470 
	`as£π
(
d°
 && 
§c
);

1471 *
d°
 = *
§c
;

1472 
	}
}

1482 
	$¢d_£q_˛õ¡_öfo_gë_˛õ¡
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1484 
	`as£π
(
öfo
);

1485  
öfo
->
˛õ¡
;

1486 
	}
}

1498 
¢d_£q_˛õ¡_ty≥_t
 
	$¢d_£q_˛õ¡_öfo_gë_ty≥
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1500 
	`as£π
(
öfo
);

1501  
öfo
->
ty≥
;

1502 
	}
}

1511 c⁄° *
	$¢d_£q_˛õ¡_öfo_gë_«me
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1513 
	`as£π
(
öfo
);

1514  
öfo
->
«me
;

1515 
	}
}

1524 
	$¢d_£q_˛õ¡_öfo_gë_brﬂdˇ°_fûãr
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1526 
	`as£π
(
öfo
);

1527  (
öfo
->
fûãr
 & 
SNDRV_SEQ_FILTER_BROADCAST
) ? 1 : 0;

1528 
	}
}

1537 
	$¢d_£q_˛õ¡_öfo_gë_îr‹_boun˚
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1539 
	`as£π
(
öfo
);

1540  (
öfo
->
fûãr
 & 
SNDRV_SEQ_FILTER_BOUNCE
) ? 1 : 0;

1541 
	}
}

1568 
	$¢d_£q_˛õ¡_öfo_gë_ˇrd
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1570 
	`as£π
(
öfo
);

1571  
öfo
->
ˇrd
;

1572 
	}
}

1603 
	$¢d_£q_˛õ¡_öfo_gë_pid
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1605 
	`as£π
(
öfo
);

1606  
öfo
->
pid
;

1607 
	}
}

1622 c⁄° *
	$¢d_£q_˛õ¡_öfo_gë_evít_fûãr
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1624 
	`as£π
(
öfo
);

1625 i‡(
öfo
->
fûãr
 & 
SNDRV_SEQ_FILTER_USE_EVENT
)

1626  
öfo
->
evít_fûãr
;

1628  
NULL
;

1629 
	}
}

1644 
	$¢d_£q_˛õ¡_öfo_evít_fûãr_˛ór
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1646 
	`as£π
(
öfo
);

1647 
öfo
->
fûãr
 &~
SNDRV_SEQ_FILTER_USE_EVENT
;

1648 
	`mem£t
(
öfo
->
evít_fûãr
, 0, (info->event_filter));

1649 
	}
}

1665 
	$¢d_£q_˛õ¡_öfo_evít_fûãr_add
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, 
evít_ty≥
)

1667 
	`as£π
(
öfo
);

1668 
öfo
->
fûãr
 |
SNDRV_SEQ_FILTER_USE_EVENT
;

1669 
	`¢d_£q_£t_bô
(
evít_ty≥
, 
öfo
->
evít_fûãr
);

1670 
	}
}

1686 
	$¢d_£q_˛õ¡_öfo_evít_fûãr_dñ
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, 
evít_ty≥
)

1688 
	`as£π
(
öfo
);

1689 
	`¢d_£q_un£t_bô
(
evít_ty≥
, 
öfo
->
evít_fûãr
);

1690 
	}
}

1706 
	$¢d_£q_˛õ¡_öfo_evít_fûãr_check
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, 
evít_ty≥
)

1708 
	`as£π
(
öfo
);

1709  
	`¢d_£q_gë_bô
(
evít_ty≥
, 
öfo
->
evít_fûãr
);

1710 
	}
}

1719 
	$¢d_£q_˛õ¡_öfo_gë_num_p‹ts
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1721 
	`as£π
(
öfo
);

1722  
öfo
->
num_p‹ts
;

1723 
	}
}

1732 
	$¢d_£q_˛õ¡_öfo_gë_evít_lo°
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1734 
	`as£π
(
öfo
);

1735  
öfo
->
evít_lo°
;

1736 
	}
}

1745 
	$¢d_£q_˛õ¡_öfo_gë_midi_vîsi⁄
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1747 
	`as£π
(
öfo
);

1748  
öfo
->
midi_vîsi⁄
;

1749 
	}
}

1759 
	$¢d_£q_˛õ¡_öfo_gë_ump_group_íabÀd
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
,

1760 
group
)

1762 
	`as£π
(
öfo
);

1763  !(
öfo
->
group_fûãr
 & (1U << 
group
));

1764 
	}
}

1766 #i‚de‡
DOC_HIDDEN


1767 
	#UMP_GROUPLESS_FILTER
 (1U << 0)

	)

1777 
	$¢d_£q_˛õ¡_öfo_gë_ump_grou∂ess_íabÀd
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1779 
	`as£π
(
öfo
);

1780  !(
öfo
->
group_fûãr
 & 
UMP_GROUPLESS_FILTER
);

1781 
	}
}

1790 
	$¢d_£q_˛õ¡_öfo_gë_ump_c⁄vîsi⁄
(c⁄° 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1792 
	`as£π
(
öfo
);

1793  
öfo
->
midi_vîsi⁄
;

1794 
	}
}

1803 
	$¢d_£q_˛õ¡_öfo_£t_˛õ¡
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, 
˛õ¡
)

1805 
	`as£π
(
öfo
);

1806 
öfo
->
˛õ¡
 = client;

1807 
	}
}

1817 
	$¢d_£q_˛õ¡_öfo_£t_«me
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, c⁄° *
«me
)

1819 
	`as£π
(
öfo
 && 
«me
);

1820 
	`¢d_°æ˝y
(
öfo
->
«me
,Çame, (info->name));

1821 
	}
}

1830 
	$¢d_£q_˛õ¡_öfo_£t_brﬂdˇ°_fûãr
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, 
vÆ
)

1832 
	`as£π
(
öfo
);

1833 i‡(
vÆ
)

1834 
öfo
->
fûãr
 |
SNDRV_SEQ_FILTER_BROADCAST
;

1836 
öfo
->
fûãr
 &~
SNDRV_SEQ_FILTER_BROADCAST
;

1837 
	}
}

1846 
	$¢d_£q_˛õ¡_öfo_£t_midi_vîsi⁄
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, 
midi_vîsi⁄
)

1848 
	`as£π
(
öfo
);

1849 
öfo
->
midi_vîsi⁄
 = midi_version;

1850 
	}
}

1860 
	$¢d_£q_˛õ¡_öfo_£t_ump_group_íabÀd
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
,

1861 
group
, 
íabÀ
)

1863 
	`as£π
(
öfo
);

1864 i‡(
íabÀ
)

1865 
öfo
->
group_fûãr
 &~(1U << 
group
);

1867 
öfo
->
group_fûãr
 |(1U << 
group
);

1868 
	}
}

1877 
	$¢d_£q_˛õ¡_öfo_£t_ump_grou∂ess_íabÀd
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
,

1878 
íabÀ
)

1880 
	`as£π
(
öfo
);

1881 i‡(
íabÀ
)

1882 
öfo
->
group_fûãr
 &~
UMP_GROUPLESS_FILTER
;

1884 
öfo
->
group_fûãr
 |
UMP_GROUPLESS_FILTER
;

1885 
	}
}

1894 
	$¢d_£q_˛õ¡_öfo_£t_ump_c⁄vîsi⁄
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
,

1895 
íabÀ
)

1897 
	`as£π
(
öfo
);

1898 i‡(
íabÀ
)

1899 
öfo
->
fûãr
 &~
SNDRV_SEQ_FILTER_NO_CONVERT
;

1901 
öfo
->
fûãr
 |
SNDRV_SEQ_FILTER_NO_CONVERT
;

1902 
	}
}

1911 
	$¢d_£q_˛õ¡_öfo_£t_îr‹_boun˚
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, 
vÆ
)

1913 
	`as£π
(
öfo
);

1914 i‡(
vÆ
)

1915 
öfo
->
fûãr
 |
SNDRV_SEQ_FILTER_BOUNCE
;

1917 
öfo
->
fûãr
 &~
SNDRV_SEQ_FILTER_BOUNCE
;

1918 
	}
}

1933 
	$¢d_£q_˛õ¡_öfo_£t_evít_fûãr
(
¢d_£q_˛õ¡_öfo_t
 *
öfo
, *
fûãr
)

1935 
	`as£π
(
öfo
);

1936 i‡(! 
fûãr
)

1937 
öfo
->
fûãr
 &~
SNDRV_SEQ_FILTER_USE_EVENT
;

1939 
öfo
->
fûãr
 |
SNDRV_SEQ_FILTER_USE_EVENT
;

1940 
	`mem˝y
(
öfo
->
evít_fûãr
, 
fûãr
, (info->event_filter));

1942 
	}
}

1958 
	$¢d_£q_gë_™y_˛õ¡_öfo
(
¢d_£q_t
 *
£q
, 
˛õ¡
, 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1960 
	`as£π
(
£q
 && 
öfo
 && 
˛õ¡
 >= 0);

1961 
	`mem£t
(
öfo
, 0, (
¢d_£q_˛õ¡_öfo_t
));

1962 
öfo
->
˛õ¡
 = client;

1963  
£q
->
›s
->
	`gë_˛õ¡_öfo
(£q, 
öfo
);

1964 
	}
}

1978 
	$¢d_£q_gë_˛õ¡_öfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1980  
	`¢d_£q_gë_™y_˛õ¡_öfo
(
£q
, seq->
˛õ¡
, 
öfo
);

1981 
	}
}

1994 
	$¢d_£q_£t_˛õ¡_öfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

1996 
	`as£π
(
£q
 && 
öfo
);

1997 
öfo
->
˛õ¡
 = 
£q
->client;

1998 
öfo
->
ty≥
 = 
USER_CLIENT
;

1999  
£q
->
›s
->
	`£t_˛õ¡_öfo
(£q, 
öfo
);

2000 
	}
}

2016 
	$¢d_£q_quîy_√xt_˛õ¡
(
¢d_£q_t
 *
£q
, 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

2018 
	`as£π
(
£q
 && 
öfo
);

2019  
£q
->
›s
->
	`quîy_√xt_˛õ¡
(£q, 
öfo
);

2020 
	}
}

2029 
	$¢d_£q_gë_ump_ídpoöt_öfo
(
¢d_£q_t
 *
£q
, 
˛õ¡
, *
öfo
)

2031 
	`as£π
(
£q
 && 
öfo
);

2032  
£q
->
›s
->
	`gë_ump_öfo
(£q, 
˛õ¡
,

2033 
SNDRV_SEQ_CLIENT_UMP_INFO_ENDPOINT
,

2034 
öfo
);

2035 
	}
}

2045 
	$¢d_£q_gë_ump_block_öfo
(
¢d_£q_t
 *
£q
, 
˛õ¡
, 
blk
, *
öfo
)

2047 
	`as£π
(
£q
 && 
öfo
);

2048  
£q
->
›s
->
	`gë_ump_öfo
(£q, 
˛õ¡
,

2049 
SNDRV_SEQ_CLIENT_UMP_INFO_BLOCK
 + 
blk
,

2050 
öfo
);

2051 
	}
}

2059 
	$¢d_£q_£t_ump_ídpoöt_öfo
(
¢d_£q_t
 *
£q
, c⁄° *
öfo
)

2061 
	`as£π
(
£q
 && 
öfo
);

2062  
£q
->
›s
->
	`£t_ump_öfo
(seq,

2063 
SNDRV_SEQ_CLIENT_UMP_INFO_ENDPOINT
,

2064 
öfo
);

2065 
	}
}

2074 
	$¢d_£q_£t_ump_block_öfo
(
¢d_£q_t
 *
£q
, 
blk
, c⁄° *
öfo
)

2076 
	`as£π
(
£q
 && 
öfo
);

2077  
£q
->
›s
->
	`£t_ump_öfo
(seq,

2078 
SNDRV_SEQ_CLIENT_UMP_INFO_BLOCK
 + 
blk
,

2079 
öfo
);

2080 
	}
}

2093 
size_t
 
	$¢d_£q_p‹t_öfo_sizeof
()

2095  (
¢d_£q_p‹t_öfo_t
);

2096 
	}
}

2103 
	$¢d_£q_p‹t_öfo_mÆloc
(
¢d_£q_p‹t_öfo_t
 **
±r
)

2105 
	`as£π
(
±r
);

2106 *
±r
 = 
	`ˇŒoc
(1, (
¢d_£q_p‹t_öfo_t
));

2107 i‡(!*
±r
)

2108  -
ENOMEM
;

2110 
	}
}

2116 
	$¢d_£q_p‹t_öfo_‰ì
(
¢d_£q_p‹t_öfo_t
 *
obj
)

2118 
	`‰ì
(
obj
);

2119 
	}
}

2126 
	$¢d_£q_p‹t_öfo_c›y
(
¢d_£q_p‹t_öfo_t
 *
d°
, c⁄° snd_£q_p‹t_öfo_à*
§c
)

2128 
	`as£π
(
d°
 && 
§c
);

2129 *
d°
 = *
§c
;

2130 
	}
}

2140 
	$¢d_£q_p‹t_öfo_gë_˛õ¡
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2142 
	`as£π
(
öfo
);

2143  
öfo
->
addr
.
˛õ¡
;

2144 
	}
}

2153 
	$¢d_£q_p‹t_öfo_gë_p‹t
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2155 
	`as£π
(
öfo
);

2156  
öfo
->
addr
.
p‹t
;

2157 
	}
}

2166 c⁄° 
¢d_£q_addr_t
 *
	$¢d_£q_p‹t_öfo_gë_addr
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2168 
	`as£π
(
öfo
);

2169  (c⁄° 
¢d_£q_addr_t
 *Ë&
öfo
->
addr
;

2170 
	}
}

2179 c⁄° *
	$¢d_£q_p‹t_öfo_gë_«me
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2181 
	`as£π
(
öfo
);

2182  
öfo
->
«me
;

2183 
	}
}

2192 
	$¢d_£q_p‹t_öfo_gë_ˇ∑bûôy
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2194 
	`as£π
(
öfo
);

2195  
öfo
->
ˇ∑bûôy
;

2196 
	}
}

2205 
	$¢d_£q_p‹t_öfo_gë_ty≥
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2207 
	`as£π
(
öfo
);

2208  
öfo
->
ty≥
;

2209 
	}
}

2218 
	$¢d_£q_p‹t_öfo_gë_ªad_u£
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2220 
	`as£π
(
öfo
);

2221  
öfo
->
ªad_u£
;

2222 
	}
}

2231 
	$¢d_£q_p‹t_öfo_gë_wrôe_u£
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2233 
	`as£π
(
öfo
);

2234  
öfo
->
wrôe_u£
;

2235 
	}
}

2244 
	$¢d_£q_p‹t_öfo_gë_midi_ch™√ls
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2246 
	`as£π
(
öfo
);

2247  
öfo
->
midi_ch™√ls
;

2248 
	}
}

2257 
	$¢d_£q_p‹t_öfo_gë_midi_voi˚s
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2259 
	`as£π
(
öfo
);

2260  
öfo
->
midi_voi˚s
;

2261 
	}
}

2270 
	$¢d_£q_p‹t_öfo_gë_sy¡h_voi˚s
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2272 
	`as£π
(
öfo
);

2273  
öfo
->
sy¡h_voi˚s
;

2274 
	}
}

2283 
	$¢d_£q_p‹t_öfo_gë_p‹t_•ecifõd
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2285 
	`as£π
(
öfo
);

2286  (
öfo
->
Êags
 & 
SNDRV_SEQ_PORT_FLG_GIVEN_PORT
) ? 1 : 0;

2287 
	}
}

2296 
	$¢d_£q_p‹t_öfo_gë_time°ampög
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2298 
	`as£π
(
öfo
);

2299  (
öfo
->
Êags
 & 
SNDRV_SEQ_PORT_FLG_TIMESTAMP
) ? 1 : 0;

2300 
	}
}

2309 
	$¢d_£q_p‹t_öfo_gë_time°amp_ªÆ
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2311 
	`as£π
(
öfo
);

2312  (
öfo
->
Êags
 & 
SNDRV_SEQ_PORT_FLG_TIME_REAL
) ? 1 : 0;

2313 
	}
}

2322 
	$¢d_£q_p‹t_öfo_gë_time°amp_queue
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2324 
	`as£π
(
öfo
);

2325  
öfo
->
time_queue
;

2326 
	}
}

2335 
	$¢d_£q_p‹t_öfo_gë_dúe˘i⁄
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2337 
	`as£π
(
öfo
);

2338  
öfo
->
dúe˘i⁄
;

2339 
	}
}

2348 
	$¢d_£q_p‹t_öfo_gë_ump_group
(c⁄° 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2350 
	`as£π
(
öfo
);

2351  
öfo
->
ump_group
;

2352 
	}
}

2361 
	$¢d_£q_p‹t_öfo_£t_˛õ¡
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
˛õ¡
)

2363 
	`as£π
(
öfo
);

2364 
öfo
->
addr
.
˛õ¡
 = client;

2365 
	}
}

2374 
	$¢d_£q_p‹t_öfo_£t_p‹t
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
p‹t
)

2376 
	`as£π
(
öfo
);

2377 
öfo
->
addr
.
p‹t
 =Öort;

2378 
	}
}

2387 
	$¢d_£q_p‹t_öfo_£t_addr
(
¢d_£q_p‹t_öfo_t
 *
öfo
, c⁄° 
¢d_£q_addr_t
 *
addr
)

2389 
	`as£π
(
öfo
);

2390 
öfo
->
addr
 = *(c⁄° 
¢drv_£q_addr
 *)addr;

2391 
	}
}

2400 
	$¢d_£q_p‹t_öfo_£t_«me
(
¢d_£q_p‹t_öfo_t
 *
öfo
, c⁄° *
«me
)

2402 
	`as£π
(
öfo
 && 
«me
);

2403 
	`¢d_°æ˝y
(
öfo
->
«me
,Çame, (info->name));

2404 
	}
}

2413 
	$¢d_£q_p‹t_öfo_£t_ˇ∑bûôy
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
ˇ∑bûôy
)

2415 
	`as£π
(
öfo
);

2416 
öfo
->
ˇ∑bûôy
 = capability;

2417 
	}
}

2426 
	$¢d_£q_p‹t_öfo_£t_ty≥
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
ty≥
)

2428 
	`as£π
(
öfo
);

2429 
öfo
->
ty≥
 =Åype;

2430 
	}
}

2439 
	$¢d_£q_p‹t_öfo_£t_midi_ch™√ls
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
ch™√ls
)

2441 
	`as£π
(
öfo
);

2442 
öfo
->
midi_ch™√ls
 = 
ch™√ls
;

2443 
	}
}

2452 
	$¢d_£q_p‹t_öfo_£t_midi_voi˚s
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
voi˚s
)

2454 
	`as£π
(
öfo
);

2455 
öfo
->
midi_voi˚s
 = 
voi˚s
;

2456 
	}
}

2465 
	$¢d_£q_p‹t_öfo_£t_sy¡h_voi˚s
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
voi˚s
)

2467 
	`as£π
(
öfo
);

2468 
öfo
->
sy¡h_voi˚s
 = 
voi˚s
;

2469 
	}
}

2478 
	$¢d_£q_p‹t_öfo_£t_p‹t_•ecifõd
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
vÆ
)

2480 
	`as£π
(
öfo
);

2481 i‡(
vÆ
)

2482 
öfo
->
Êags
 |
SNDRV_SEQ_PORT_FLG_GIVEN_PORT
;

2484 
öfo
->
Êags
 &~
SNDRV_SEQ_PORT_FLG_GIVEN_PORT
;

2485 
	}
}

2494 
	$¢d_£q_p‹t_öfo_£t_time°ampög
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
íabÀ
)

2496 
	`as£π
(
öfo
);

2497 i‡(
íabÀ
)

2498 
öfo
->
Êags
 |
SNDRV_SEQ_PORT_FLG_TIMESTAMP
;

2500 
öfo
->
Êags
 &~
SNDRV_SEQ_PORT_FLG_TIMESTAMP
;

2501 
	}
}

2510 
	$¢d_£q_p‹t_öfo_£t_time°amp_ªÆ
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
íabÀ
)

2512 
	`as£π
(
öfo
);

2513 i‡(
íabÀ
)

2514 
öfo
->
Êags
 |
SNDRV_SEQ_PORT_FLG_TIME_REAL
;

2516 
öfo
->
Êags
 &~
SNDRV_SEQ_PORT_FLG_TIME_REAL
;

2517 
	}
}

2526 
	$¢d_£q_p‹t_öfo_£t_time°amp_queue
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
queue
)

2528 
	`as£π
(
öfo
);

2529 
öfo
->
time_queue
 = 
queue
;

2530 
	}
}

2539 
	$¢d_£q_p‹t_öfo_£t_dúe˘i⁄
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
dúe˘i⁄
)

2541 
	`as£π
(
öfo
);

2542 
öfo
->
dúe˘i⁄
 = direction;

2543 
	}
}

2552 
	$¢d_£q_p‹t_öfo_£t_ump_group
(
¢d_£q_p‹t_öfo_t
 *
öfo
, 
ump_group
)

2554 
	`as£π
(
öfo
);

2555 
öfo
->
ump_group
 = ump_group;

2556 
	}
}

2603 
	$¢d_£q_¸óã_p‹t
(
¢d_£q_t
 *
£q
, 
¢d_£q_p‹t_öfo_t
 * 
p‹t
)

2605 
	`as£π
(
£q
 && 
p‹t
);

2606 
p‹t
->
addr
.
˛õ¡
 = 
£q
->client;

2607  
£q
->
›s
->
	`¸óã_p‹t
(£q, 
p‹t
);

2608 
	}
}

2620 
	$¢d_£q_dñëe_p‹t
(
¢d_£q_t
 *
£q
, 
p‹t
)

2622 
¢d_£q_p‹t_öfo_t
 
pöfo
;

2623 
	`as£π
(
£q
);

2624 
	`mem£t
(&
pöfo
, 0, (pinfo));

2625 
pöfo
.
addr
.
˛õ¡
 = 
£q
->client;

2626 
pöfo
.
addr
.
p‹t
 =Öort;

2627  
£q
->
›s
->
	`dñëe_p‹t
(£q, &
pöfo
);

2628 
	}
}

2640 
	$¢d_£q_gë_™y_p‹t_öfo
(
¢d_£q_t
 *
£q
, 
˛õ¡
, 
p‹t
, 
¢d_£q_p‹t_öfo_t
 * 
öfo
)

2642 
	`as£π
(
£q
 && 
öfo
 && 
˛õ¡
 >0 && 
p‹t
 >= 0);

2643 
	`mem£t
(
öfo
, 0, (
¢d_£q_p‹t_öfo_t
));

2644 
öfo
->
addr
.
˛õ¡
 = client;

2645 
öfo
->
addr
.
p‹t
 =Öort;

2646  
£q
->
›s
->
	`gë_p‹t_öfo
(£q, 
öfo
);

2647 
	}
}

2659 
	$¢d_£q_gë_p‹t_öfo
(
¢d_£q_t
 *
£q
, 
p‹t
, 
¢d_£q_p‹t_öfo_t
 * 
öfo
)

2661  
	`¢d_£q_gë_™y_p‹t_öfo
(
£q
, seq->
˛õ¡
, 
p‹t
, 
öfo
);

2662 
	}
}

2673 
	$¢d_£q_£t_p‹t_öfo
(
¢d_£q_t
 *
£q
, 
p‹t
, 
¢d_£q_p‹t_öfo_t
 * 
öfo
)

2675 
	`as£π
(
£q
 && 
öfo
 && 
p‹t
 >= 0);

2676 
öfo
->
addr
.
˛õ¡
 = 
£q
->client;

2677 
öfo
->
addr
.
p‹t
 =Öort;

2678  
£q
->
›s
->
	`£t_p‹t_öfo
(£q, 
öfo
);

2679 
	}
}

2698 
	$¢d_£q_quîy_√xt_p‹t
(
¢d_£q_t
 *
£q
, 
¢d_£q_p‹t_öfo_t
 *
öfo
)

2700 
	`as£π
(
£q
 && 
öfo
);

2701  
£q
->
›s
->
	`quîy_√xt_p‹t
(£q, 
öfo
);

2702 
	}
}

2716 
size_t
 
	$¢d_£q_p‹t_subs¸ibe_sizeof
()

2718  (
¢d_£q_p‹t_subs¸ibe_t
);

2719 
	}
}

2726 
	$¢d_£q_p‹t_subs¸ibe_mÆloc
(
¢d_£q_p‹t_subs¸ibe_t
 **
±r
)

2728 
	`as£π
(
±r
);

2729 *
±r
 = 
	`ˇŒoc
(1, (
¢d_£q_p‹t_subs¸ibe_t
));

2730 i‡(!*
±r
)

2731  -
ENOMEM
;

2733 
	}
}

2739 
	$¢d_£q_p‹t_subs¸ibe_‰ì
(
¢d_£q_p‹t_subs¸ibe_t
 *
obj
)

2741 
	`‰ì
(
obj
);

2742 
	}
}

2749 
	$¢d_£q_p‹t_subs¸ibe_c›y
(
¢d_£q_p‹t_subs¸ibe_t
 *
d°
, c⁄° snd_£q_p‹t_subs¸ibe_à*
§c
)

2751 
	`as£π
(
d°
 && 
§c
);

2752 *
d°
 = *
§c
;

2753 
	}
}

2762 c⁄° 
¢d_£q_addr_t
 *
	$¢d_£q_p‹t_subs¸ibe_gë_£ndî
(c⁄° 
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
)

2764 
	`as£π
(
öfo
);

2765  (c⁄° 
¢d_£q_addr_t
 *)&
öfo
->
£ndî
;

2766 
	}
}

2774 c⁄° 
¢d_£q_addr_t
 *
	$¢d_£q_p‹t_subs¸ibe_gë_de°
(c⁄° 
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
)

2776 
	`as£π
(
öfo
);

2777  (c⁄° 
¢d_£q_addr_t
 *)&
öfo
->
de°
;

2778 
	}
}

2787 
	$¢d_£q_p‹t_subs¸ibe_gë_queue
(c⁄° 
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
)

2789 
	`as£π
(
öfo
);

2790  
öfo
->
queue
;

2791 
	}
}

2800 
	$¢d_£q_p‹t_subs¸ibe_gë_ex˛usive
(c⁄° 
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
)

2802 
	`as£π
(
öfo
);

2803  (
öfo
->
Êags
 & 
SNDRV_SEQ_PORT_SUBS_EXCLUSIVE
) ? 1 : 0;

2804 
	}
}

2813 
	$¢d_£q_p‹t_subs¸ibe_gë_time_upd©e
(c⁄° 
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
)

2815 
	`as£π
(
öfo
);

2816  (
öfo
->
Êags
 & 
SNDRV_SEQ_PORT_SUBS_TIMESTAMP
) ? 1 : 0;

2817 
	}
}

2826 
	$¢d_£q_p‹t_subs¸ibe_gë_time_ªÆ
(c⁄° 
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
)

2828 
	`as£π
(
öfo
);

2829  (
öfo
->
Êags
 & 
SNDRV_SEQ_PORT_SUBS_TIME_REAL
) ? 1 : 0;

2830 
	}
}

2839 
	$¢d_£q_p‹t_subs¸ibe_£t_£ndî
(
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
, c⁄° 
¢d_£q_addr_t
 *
addr
)

2841 
	`as£π
(
öfo
);

2842 
	`mem˝y
(&
öfo
->
£ndî
, 
addr
, (*addr));

2843 
	}
}

2852 
	$¢d_£q_p‹t_subs¸ibe_£t_de°
(
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
, c⁄° 
¢d_£q_addr_t
 *
addr
)

2854 
	`as£π
(
öfo
);

2855 
	`mem˝y
(&
öfo
->
de°
, 
addr
, (*addr));

2856 
	}
}

2865 
	$¢d_£q_p‹t_subs¸ibe_£t_queue
(
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
, 
q
)

2867 
	`as£π
(
öfo
);

2868 
öfo
->
queue
 = 
q
;

2869 
	}
}

2878 
	$¢d_£q_p‹t_subs¸ibe_£t_ex˛usive
(
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
, 
vÆ
)

2880 
	`as£π
(
öfo
);

2881 i‡(
vÆ
)

2882 
öfo
->
Êags
 |
SNDRV_SEQ_PORT_SUBS_EXCLUSIVE
;

2884 
öfo
->
Êags
 &~
SNDRV_SEQ_PORT_SUBS_EXCLUSIVE
;

2885 
	}
}

2894 
	$¢d_£q_p‹t_subs¸ibe_£t_time_upd©e
(
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
, 
vÆ
)

2896 
	`as£π
(
öfo
);

2897 i‡(
vÆ
)

2898 
öfo
->
Êags
 |
SNDRV_SEQ_PORT_SUBS_TIMESTAMP
;

2900 
öfo
->
Êags
 &~
SNDRV_SEQ_PORT_SUBS_TIMESTAMP
;

2901 
	}
}

2910 
	$¢d_£q_p‹t_subs¸ibe_£t_time_ªÆ
(
¢d_£q_p‹t_subs¸ibe_t
 *
öfo
, 
vÆ
)

2912 
	`as£π
(
öfo
);

2913 i‡(
vÆ
)

2914 
öfo
->
Êags
 |
SNDRV_SEQ_PORT_SUBS_TIME_REAL
;

2916 
öfo
->
Êags
 &~
SNDRV_SEQ_PORT_SUBS_TIME_REAL
;

2917 
	}
}

2928 
	$¢d_£q_gë_p‹t_subs¸ùti⁄
(
¢d_£q_t
 *
£q
, 
¢d_£q_p‹t_subs¸ibe_t
 * 
sub
)

2930 
	`as£π
(
£q
 && 
sub
);

2931  
£q
->
›s
->
	`gë_p‹t_subs¸ùti⁄
(£q, 
sub
);

2932 
	}
}

2946 
	$¢d_£q_subs¸ibe_p‹t
(
¢d_£q_t
 *
£q
, 
¢d_£q_p‹t_subs¸ibe_t
 * 
sub
)

2948 
	`as£π
(
£q
 && 
sub
);

2949  
£q
->
›s
->
	`subs¸ibe_p‹t
(£q, 
sub
);

2950 
	}
}

2963 
	$¢d_£q_unsubs¸ibe_p‹t
(
¢d_£q_t
 *
£q
, 
¢d_£q_p‹t_subs¸ibe_t
 * 
sub
)

2965 
	`as£π
(
£q
 && 
sub
);

2966  
£q
->
›s
->
	`unsubs¸ibe_p‹t
(£q, 
sub
);

2967 
	}
}

2974 
size_t
 
	$¢d_£q_quîy_subs¸ibe_sizeof
()

2976  (
¢d_£q_quîy_subs¸ibe_t
);

2977 
	}
}

2984 
	$¢d_£q_quîy_subs¸ibe_mÆloc
(
¢d_£q_quîy_subs¸ibe_t
 **
±r
)

2986 
	`as£π
(
±r
);

2987 *
±r
 = 
	`ˇŒoc
(1, (
¢d_£q_quîy_subs¸ibe_t
));

2988 i‡(!*
±r
)

2989  -
ENOMEM
;

2991 
	}
}

2997 
	$¢d_£q_quîy_subs¸ibe_‰ì
(
¢d_£q_quîy_subs¸ibe_t
 *
obj
)

2999 
	`‰ì
(
obj
);

3000 
	}
}

3007 
	$¢d_£q_quîy_subs¸ibe_c›y
(
¢d_£q_quîy_subs¸ibe_t
 *
d°
, c⁄° snd_£q_quîy_subs¸ibe_à*
§c
)

3009 
	`as£π
(
d°
 && 
§c
);

3010 *
d°
 = *
§c
;

3011 
	}
}

3021 
	$¢d_£q_quîy_subs¸ibe_gë_˛õ¡
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
)

3023 
	`as£π
(
öfo
);

3024  
öfo
->
roŸ
.
˛õ¡
;

3025 
	}
}

3034 
	$¢d_£q_quîy_subs¸ibe_gë_p‹t
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
)

3036 
	`as£π
(
öfo
);

3037  
öfo
->
roŸ
.
p‹t
;

3038 
	}
}

3047 c⁄° 
¢d_£q_addr_t
 *
	$¢d_£q_quîy_subs¸ibe_gë_roŸ
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
)

3049 
	`as£π
(
öfo
);

3050  (c⁄° 
¢d_£q_addr_t
 *)&
öfo
->
roŸ
;

3051 
	}
}

3060 
¢d_£q_quîy_subs_ty≥_t
 
	$¢d_£q_quîy_subs¸ibe_gë_ty≥
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
)

3062 
	`as£π
(
öfo
);

3063  
öfo
->
ty≥
;

3064 
	}
}

3073 
	$¢d_£q_quîy_subs¸ibe_gë_ödex
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
)

3075 
	`as£π
(
öfo
);

3076  
öfo
->
ödex
;

3077 
	}
}

3086 
	$¢d_£q_quîy_subs¸ibe_gë_num_subs
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
)

3088 
	`as£π
(
öfo
);

3089  
öfo
->
num_subs
;

3090 
	}
}

3099 c⁄° 
¢d_£q_addr_t
 *
	$¢d_£q_quîy_subs¸ibe_gë_addr
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
)

3101 
	`as£π
(
öfo
);

3102  (c⁄° 
¢d_£q_addr_t
 *)&
öfo
->
addr
;

3103 
	}
}

3112 
	$¢d_£q_quîy_subs¸ibe_gë_queue
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
)

3114 
	`as£π
(
öfo
);

3115  
öfo
->
queue
;

3116 
	}
}

3125 
	$¢d_£q_quîy_subs¸ibe_gë_ex˛usive
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
)

3127 
	`as£π
(
öfo
);

3128  (
öfo
->
Êags
 & 
SNDRV_SEQ_PORT_SUBS_EXCLUSIVE
) ? 1 : 0;

3129 
	}
}

3138 
	$¢d_£q_quîy_subs¸ibe_gë_time_upd©e
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
)

3140 
	`as£π
(
öfo
);

3141  (
öfo
->
Êags
 & 
SNDRV_SEQ_PORT_SUBS_TIMESTAMP
) ? 1 : 0;

3142 
	}
}

3151 
	$¢d_£q_quîy_subs¸ibe_gë_time_ªÆ
(c⁄° 
¢d_£q_quîy_subs¸ibe_t
 *
öfo
)

3153 
	`as£π
(
öfo
);

3154  (
öfo
->
Êags
 & 
SNDRV_SEQ_PORT_SUBS_TIMESTAMP
) ? 1 : 0;

3155 
	}
}

3164 
	$¢d_£q_quîy_subs¸ibe_£t_˛õ¡
(
¢d_£q_quîy_subs¸ibe_t
 *
öfo
, 
˛õ¡
)

3166 
	`as£π
(
öfo
);

3167 
öfo
->
roŸ
.
˛õ¡
 = client;

3168 
	}
}

3177 
	$¢d_£q_quîy_subs¸ibe_£t_p‹t
(
¢d_£q_quîy_subs¸ibe_t
 *
öfo
, 
p‹t
)

3179 
	`as£π
(
öfo
);

3180 
öfo
->
roŸ
.
p‹t
 =Öort;

3181 
	}
}

3190 
	$¢d_£q_quîy_subs¸ibe_£t_roŸ
(
¢d_£q_quîy_subs¸ibe_t
 *
öfo
, c⁄° 
¢d_£q_addr_t
 *
addr
)

3192 
	`as£π
(
öfo
);

3193 
öfo
->
roŸ
 = *(c⁄° 
¢d_£q_addr
 *)
addr
;

3194 
	}
}

3203 
	$¢d_£q_quîy_subs¸ibe_£t_ty≥
(
¢d_£q_quîy_subs¸ibe_t
 *
öfo
, 
¢d_£q_quîy_subs_ty≥_t
 
ty≥
)

3205 
	`as£π
(
öfo
);

3206 
öfo
->
ty≥
 =Åype;

3207 
	}
}

3216 
	$¢d_£q_quîy_subs¸ibe_£t_ödex
(
¢d_£q_quîy_subs¸ibe_t
 *
öfo
, 
ödex
)

3218 
	`as£π
(
öfo
);

3219 
öfo
->
ödex
 = index;

3220 
	}
}

3242 
	$¢d_£q_quîy_p‹t_subs¸ibîs
(
¢d_£q_t
 *
£q
, 
¢d_£q_quîy_subs¸ibe_t
 * 
subs
)

3244 
	`as£π
(
£q
 && 
subs
);

3245  
£q
->
›s
->
	`quîy_p‹t_subs¸ibîs
(£q, 
subs
);

3246 
	}
}

3258 
size_t
 
	$¢d_£q_queue_öfo_sizeof
()

3260  (
¢d_£q_queue_öfo_t
);

3261 
	}
}

3268 
	$¢d_£q_queue_öfo_mÆloc
(
¢d_£q_queue_öfo_t
 **
±r
)

3270 
	`as£π
(
±r
);

3271 *
±r
 = 
	`ˇŒoc
(1, (
¢d_£q_queue_öfo_t
));

3272 i‡(!*
±r
)

3273  -
ENOMEM
;

3275 
	}
}

3281 
	$¢d_£q_queue_öfo_‰ì
(
¢d_£q_queue_öfo_t
 *
obj
)

3283 
	`‰ì
(
obj
);

3284 
	}
}

3291 
	$¢d_£q_queue_öfo_c›y
(
¢d_£q_queue_öfo_t
 *
d°
, c⁄° snd_£q_queue_öfo_à*
§c
)

3293 
	`as£π
(
d°
 && 
§c
);

3294 *
d°
 = *
§c
;

3295 
	}
}

3305 
	$¢d_£q_queue_öfo_gë_queue
(c⁄° 
¢d_£q_queue_öfo_t
 *
öfo
)

3307 
	`as£π
(
öfo
);

3308  
öfo
->
queue
;

3309 
	}
}

3318 c⁄° *
	$¢d_£q_queue_öfo_gë_«me
(c⁄° 
¢d_£q_queue_öfo_t
 *
öfo
)

3320 
	`as£π
(
öfo
);

3321  
öfo
->
«me
;

3322 
	}
}

3331 
	$¢d_£q_queue_öfo_gë_ow√r
(c⁄° 
¢d_£q_queue_öfo_t
 *
öfo
)

3333 
	`as£π
(
öfo
);

3334  
öfo
->
ow√r
;

3335 
	}
}

3344 
	$¢d_£q_queue_öfo_gë_locked
(c⁄° 
¢d_£q_queue_öfo_t
 *
öfo
)

3346 
	`as£π
(
öfo
);

3347  
öfo
->
locked
;

3348 
	}
}

3357 
	$¢d_£q_queue_öfo_gë_Êags
(c⁄° 
¢d_£q_queue_öfo_t
 *
öfo
)

3359 
	`as£π
(
öfo
);

3360  
öfo
->
Êags
;

3361 
	}
}

3370 
	$¢d_£q_queue_öfo_£t_«me
(
¢d_£q_queue_öfo_t
 *
öfo
, c⁄° *
«me
)

3372 
	`as£π
(
öfo
 && 
«me
);

3373 
	`¢d_°æ˝y
(
öfo
->
«me
,Çame, (info->name));

3374 
	}
}

3383 
	$¢d_£q_queue_öfo_£t_ow√r
(
¢d_£q_queue_öfo_t
 *
öfo
, 
ow√r
)

3385 
	`as£π
(
öfo
);

3386 
öfo
->
ow√r
 = owner;

3387 
	}
}

3396 
	$¢d_£q_queue_öfo_£t_locked
(
¢d_£q_queue_öfo_t
 *
öfo
, 
locked
)

3398 
	`as£π
(
öfo
);

3399 
öfo
->
locked
 =Üocked;

3400 
	}
}

3409 
	$¢d_£q_queue_öfo_£t_Êags
(
¢d_£q_queue_öfo_t
 *
öfo
, 
Êags
)

3411 
	`as£π
(
öfo
);

3412 
öfo
->
Êags
 = flags;

3413 
	}
}

3424 
	$¢d_£q_¸óã_queue
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_öfo_t
 *
öfo
)

3426 
îr
;

3427 
	`as£π
(
£q
 && 
öfo
);

3428 
öfo
->
ow√r
 = 
£q
->
˛õ¡
;

3429 
îr
 = 
£q
->
›s
->
	`¸óã_queue
(£q, 
öfo
);

3430 i‡(
îr
 < 0)

3431  
îr
;

3432  
öfo
->
queue
;

3433 
	}
}

3443 
	$¢d_£q_Æloc_«med_queue
(
¢d_£q_t
 *
£q
, c⁄° *
«me
)

3445 
¢d_£q_queue_öfo_t
 
öfo
;

3446 
	`mem£t
(&
öfo
, 0, (info));

3447 
öfo
.
locked
 = 1;

3448 i‡(
«me
)

3449 
	`¢d_°æ˝y
(
öfo
.
«me
,Çame, (info.name));

3450  
	`¢d_£q_¸óã_queue
(
£q
, &
öfo
);

3451 
	}
}

3461 
	$¢d_£q_Æloc_queue
(
¢d_£q_t
 *
£q
)

3463  
	`¢d_£q_Æloc_«med_queue
(
£q
, 
NULL
);

3464 
	}
}

3474 
	$¢d_£q_‰ì_queue
(
¢d_£q_t
 *
£q
, 
q
)

3476 
¢d_£q_queue_öfo_t
 
öfo
;

3477 
	`as£π
(
£q
);

3478 
	`mem£t
(&
öfo
, 0, (info));

3479 
öfo
.
queue
 = 
q
;

3480  
£q
->
›s
->
	`dñëe_queue
(£q, &
öfo
);

3481 
	}
}

3492 
	$¢d_£q_gë_queue_öfo
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_öfo_t
 *
öfo
)

3494 
	`as£π
(
£q
 && 
öfo
);

3495 
öfo
->
queue
 = 
q
;

3496  
£q
->
›s
->
	`gë_queue_öfo
(£q, 
öfo
);

3497 
	}
}

3508 
	$¢d_£q_£t_queue_öfo
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_öfo_t
 *
öfo
)

3510 
	`as£π
(
£q
 && 
öfo
);

3511 
öfo
->
queue
 = 
q
;

3512  
£q
->
›s
->
	`£t_queue_öfo
(£q, 
öfo
);

3513 
	}
}

3525 
	$¢d_£q_quîy_«med_queue
(
¢d_£q_t
 *
£q
, c⁄° *
«me
)

3527 
îr
;

3528 
¢d_£q_queue_öfo_t
 
öfo
;

3529 
	`as£π
(
£q
 && 
«me
);

3530 
	`¢d_°æ˝y
(
öfo
.
«me
,Çame, (info.name));

3531 
îr
 = 
£q
->
›s
->
	`gë_«med_queue
(£q, &
öfo
);

3532 i‡(
îr
 < 0)

3533  
îr
;

3534  
öfo
.
queue
;

3535 
	}
}

3546 
	$¢d_£q_gë_queue_ußge
(
¢d_£q_t
 *
£q
, 
q
)

3548 
¢d_£q_queue_˛õ¡
 
öfo
;

3549 
îr
;

3550 
	`as£π
(
£q
);

3551 
	`mem£t
(&
öfo
, 0, (info));

3552 
öfo
.
queue
 = 
q
;

3553 
öfo
.
˛õ¡
 = 
£q
->client;

3554 i‡((
îr
 = 
£q
->
›s
->
	`gë_queue_˛õ¡
(£q, &
öfo
)) < 0)

3555  
îr
;

3556  
öfo
.
u£d
;

3557 
	}
}

3568 
	$¢d_£q_£t_queue_ußge
(
¢d_£q_t
 *
£q
, 
q
, 
u£d
)

3570 
¢d_£q_queue_˛õ¡
 
öfo
;

3571 
	`as£π
(
£q
);

3572 
	`mem£t
(&
öfo
, 0, (info));

3573 
öfo
.
queue
 = 
q
;

3574 
öfo
.
˛õ¡
 = 
£q
->client;

3575 
öfo
.
u£d
 = used ? 1 : 0;

3576  
£q
->
›s
->
	`£t_queue_˛õ¡
(£q, &
öfo
);

3577 
	}
}

3584 
size_t
 
	$¢d_£q_queue_°©us_sizeof
()

3586  (
¢d_£q_queue_°©us_t
);

3587 
	}
}

3594 
	$¢d_£q_queue_°©us_mÆloc
(
¢d_£q_queue_°©us_t
 **
±r
)

3596 
	`as£π
(
±r
);

3597 *
±r
 = 
	`ˇŒoc
(1, (
¢d_£q_queue_°©us_t
));

3598 i‡(!*
±r
)

3599  -
ENOMEM
;

3601 
	}
}

3607 
	$¢d_£q_queue_°©us_‰ì
(
¢d_£q_queue_°©us_t
 *
obj
)

3609 
	`‰ì
(
obj
);

3610 
	}
}

3617 
	$¢d_£q_queue_°©us_c›y
(
¢d_£q_queue_°©us_t
 *
d°
, c⁄° snd_£q_queue_°©us_à*
§c
)

3619 
	`as£π
(
d°
 && 
§c
);

3620 *
d°
 = *
§c
;

3621 
	}
}

3631 
	$¢d_£q_queue_°©us_gë_queue
(c⁄° 
¢d_£q_queue_°©us_t
 *
öfo
)

3633 
	`as£π
(
öfo
);

3634  
öfo
->
queue
;

3635 
	}
}

3644 
	$¢d_£q_queue_°©us_gë_evíts
(c⁄° 
¢d_£q_queue_°©us_t
 *
öfo
)

3646 
	`as£π
(
öfo
);

3647  
öfo
->
evíts
;

3648 
	}
}

3657 
¢d_£q_tick_time_t
 
	$¢d_£q_queue_°©us_gë_tick_time
(c⁄° 
¢d_£q_queue_°©us_t
 *
öfo
)

3659 
	`as£π
(
öfo
);

3660  
öfo
->
tick
;

3661 
	}
}

3669 c⁄° 
¢d_£q_ªÆ_time_t
 *
	$¢d_£q_queue_°©us_gë_ªÆ_time
(c⁄° 
¢d_£q_queue_°©us_t
 *
öfo
)

3671 
	`as£π
(
öfo
);

3672  (c⁄° 
¢d_£q_ªÆ_time_t
 *)&
öfo
->
time
;

3673 
	}
}

3682 
	$¢d_£q_queue_°©us_gë_°©us
(c⁄° 
¢d_£q_queue_°©us_t
 *
öfo
)

3684 
	`as£π
(
öfo
);

3685  
öfo
->
ru¬ög
;

3686 
	}
}

3698 
	$¢d_£q_gë_queue_°©us
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_°©us_t
 * 
°©us
)

3700 
	`as£π
(
£q
 && 
°©us
);

3701 
	`mem£t
(
°©us
, 0, (
¢d_£q_queue_°©us_t
));

3702 
°©us
->
queue
 = 
q
;

3703  
£q
->
›s
->
	`gë_queue_°©us
(£q, 
°©us
);

3704 
	}
}

3711 
size_t
 
	$¢d_£q_queue_ãmpo_sizeof
()

3713  (
¢d_£q_queue_ãmpo_t
);

3714 
	}
}

3721 
	$¢d_£q_queue_ãmpo_mÆloc
(
¢d_£q_queue_ãmpo_t
 **
±r
)

3723 
	`as£π
(
±r
);

3724 *
±r
 = 
	`ˇŒoc
(1, (
¢d_£q_queue_ãmpo_t
));

3725 i‡(!*
±r
)

3726  -
ENOMEM
;

3728 
	}
}

3734 
	$¢d_£q_queue_ãmpo_‰ì
(
¢d_£q_queue_ãmpo_t
 *
obj
)

3736 
	`‰ì
(
obj
);

3737 
	}
}

3744 
	$¢d_£q_queue_ãmpo_c›y
(
¢d_£q_queue_ãmpo_t
 *
d°
, c⁄° snd_£q_queue_ãmpo_à*
§c
)

3746 
	`as£π
(
d°
 && 
§c
);

3747 *
d°
 = *
§c
;

3748 
	}
}

3758 
	$¢d_£q_queue_ãmpo_gë_queue
(c⁄° 
¢d_£q_queue_ãmpo_t
 *
öfo
)

3760 
	`as£π
(
öfo
);

3761  
öfo
->
queue
;

3762 
	}
}

3771 
	$¢d_£q_queue_ãmpo_gë_ãmpo
(c⁄° 
¢d_£q_queue_ãmpo_t
 *
öfo
)

3773 
	`as£π
(
öfo
);

3774  
öfo
->
ãmpo
;

3775 
	}
}

3784 
	$¢d_£q_queue_ãmpo_gë_µq
(c⁄° 
¢d_£q_queue_ãmpo_t
 *
öfo
)

3786 
	`as£π
(
öfo
);

3787  
öfo
->
µq
;

3788 
	}
}

3797 
	$¢d_£q_queue_ãmpo_gë_skew
(c⁄° 
¢d_£q_queue_ãmpo_t
 *
öfo
)

3799 
	`as£π
(
öfo
);

3800  
öfo
->
skew_vÆue
;

3801 
	}
}

3810 
	$¢d_£q_queue_ãmpo_gë_skew_ba£
(c⁄° 
¢d_£q_queue_ãmpo_t
 *
öfo
)

3812 
	`as£π
(
öfo
);

3813  
öfo
->
skew_ba£
;

3814 
	}
}

3823 
	$¢d_£q_queue_ãmpo_£t_ãmpo
(
¢d_£q_queue_ãmpo_t
 *
öfo
, 
ãmpo
)

3825 
	`as£π
(
öfo
);

3826 
öfo
->
ãmpo
 =Åempo;

3827 
	}
}

3836 
	$¢d_£q_queue_ãmpo_£t_µq
(
¢d_£q_queue_ãmpo_t
 *
öfo
, 
µq
)

3838 
	`as£π
(
öfo
);

3839 
öfo
->
µq
 =Öpq;

3840 
	}
}

3852 
	$¢d_£q_queue_ãmpo_£t_skew
(
¢d_£q_queue_ãmpo_t
 *
öfo
, 
skew
)

3854 
	`as£π
(
öfo
);

3855 
öfo
->
skew_vÆue
 = 
skew
;

3856 
	}
}

3865 
	$¢d_£q_queue_ãmpo_£t_skew_ba£
(
¢d_£q_queue_ãmpo_t
 *
öfo
, 
ba£
)

3867 
	`as£π
(
öfo
);

3868 
öfo
->
skew_ba£
 = 
ba£
;

3869 
	}
}

3880 
	$¢d_£q_gë_queue_ãmpo
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_ãmpo_t
 * 
ãmpo
)

3882 
	`as£π
(
£q
 && 
ãmpo
);

3883 
	`mem£t
(
ãmpo
, 0, (
¢d_£q_queue_ãmpo_t
));

3884 
ãmpo
->
queue
 = 
q
;

3885  
£q
->
›s
->
	`gë_queue_ãmpo
(£q, 
ãmpo
);

3886 
	}
}

3897 
	$¢d_£q_£t_queue_ãmpo
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_ãmpo_t
 * 
ãmpo
)

3899 
	`as£π
(
£q
 && 
ãmpo
);

3900 
ãmpo
->
queue
 = 
q
;

3901  
£q
->
›s
->
	`£t_queue_ãmpo
(£q, 
ãmpo
);

3902 
	}
}

3911 
size_t
 
	$¢d_£q_queue_timî_sizeof
()

3913  (
¢d_£q_queue_timî_t
);

3914 
	}
}

3921 
	$¢d_£q_queue_timî_mÆloc
(
¢d_£q_queue_timî_t
 **
±r
)

3923 
	`as£π
(
±r
);

3924 *
±r
 = 
	`ˇŒoc
(1, (
¢d_£q_queue_timî_t
));

3925 i‡(!*
±r
)

3926  -
ENOMEM
;

3928 
	}
}

3934 
	$¢d_£q_queue_timî_‰ì
(
¢d_£q_queue_timî_t
 *
obj
)

3936 
	`‰ì
(
obj
);

3937 
	}
}

3944 
	$¢d_£q_queue_timî_c›y
(
¢d_£q_queue_timî_t
 *
d°
, c⁄° snd_£q_queue_timî_à*
§c
)

3946 
	`as£π
(
d°
 && 
§c
);

3947 *
d°
 = *
§c
;

3948 
	}
}

3958 
	$¢d_£q_queue_timî_gë_queue
(c⁄° 
¢d_£q_queue_timî_t
 *
öfo
)

3960 
	`as£π
(
öfo
);

3961  
öfo
->
queue
;

3962 
	}
}

3971 
¢d_£q_queue_timî_ty≥_t
 
	$¢d_£q_queue_timî_gë_ty≥
(c⁄° 
¢d_£q_queue_timî_t
 *
öfo
)

3973 
	`as£π
(
öfo
);

3974  (
¢d_£q_queue_timî_ty≥_t
)
öfo
->
ty≥
;

3975 
	}
}

3984 c⁄° 
¢d_timî_id_t
 *
	$¢d_£q_queue_timî_gë_id
(c⁄° 
¢d_£q_queue_timî_t
 *
öfo
)

3986 
	`as£π
(
öfo
);

3987  &
öfo
->
u
.
Æß
.
id
;

3988 
	}
}

3997 
	$¢d_£q_queue_timî_gë_ªsﬁuti⁄
(c⁄° 
¢d_£q_queue_timî_t
 *
öfo
)

3999 
	`as£π
(
öfo
);

4000  
öfo
->
u
.
Æß
.
ªsﬁuti⁄
;

4001 
	}
}

4010 
	$¢d_£q_queue_timî_£t_ty≥
(
¢d_£q_queue_timî_t
 *
öfo
, 
¢d_£q_queue_timî_ty≥_t
 
ty≥
)

4012 
	`as£π
(
öfo
);

4013 
öfo
->
ty≥
 = ()type;

4014 
	}
}

4023 
	$¢d_£q_queue_timî_£t_id
(
¢d_£q_queue_timî_t
 *
öfo
, c⁄° 
¢d_timî_id_t
 *
id
)

4025 
	`as£π
(
öfo
 && 
id
);

4026 
öfo
->
u
.
Æß
.
id
 = *id;

4027 
	}
}

4036 
	$¢d_£q_queue_timî_£t_ªsﬁuti⁄
(
¢d_£q_queue_timî_t
 *
öfo
, 
ªsﬁuti⁄
)

4038 
	`as£π
(
öfo
);

4039 
öfo
->
u
.
Æß
.
ªsﬁuti⁄
 =Ñesolution;

4040 
	}
}

4052 
	$¢d_£q_gë_queue_timî
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_timî_t
 * 
timî
)

4054 
	`as£π
(
£q
 && 
timî
);

4055 
	`mem£t
(
timî
, 0, (
¢d_£q_queue_timî_t
));

4056 
timî
->
queue
 = 
q
;

4057  
£q
->
›s
->
	`gë_queue_timî
(£q, 
timî
);

4058 
	}
}

4069 
	$¢d_£q_£t_queue_timî
(
¢d_£q_t
 *
£q
, 
q
, 
¢d_£q_queue_timî_t
 * 
timî
)

4071 
	`as£π
(
£q
 && 
timî
);

4072 
timî
->
queue
 = 
q
;

4073  
£q
->
›s
->
	`£t_queue_timî
(£q, 
timî
);

4074 
	}
}

4078 #i‚de‡
DOC_HIDDEN


4087 
¢d_£q_evít_t
 *
	$¢d_£q_¸óã_evít
()

4089  (
¢d_£q_evít_t
 *Ë
	`ˇŒoc
(1, (snd_seq_event_t));

4090 
	}
}

4101 #i‚de‡
DOXYGEN


4102 
	$¢d_£q_‰ì_evít
(
¢d_£q_evít_t
 *
ev
 
ATTRIBUTE_UNUSED
)

4104 
	$¢d_£q_‰ì_evít
(
¢d_£q_evít_t
 *
ev
)

4108 
	}
}

4115 
ssize_t
 
	$¢d_£q_evít_Àngth
(
¢d_£q_evít_t
 *
ev
)

4117 
ssize_t
 
Àn
 = (
¢d_£q_evít_t
);

4118 
	`as£π
(
ev
);

4119 i‡(
	`¢d_£q_ev_is_ump
(
ev
))

4120 
Àn
 = (
¢d_£q_ump_evít_t
);

4121 i‡(
	`¢d_£q_ev_is_v¨übÀ
(
ev
))

4122 
Àn
 +
ev
->
d©a
.
ext
.len;

4123  
Àn
;

4124 
	}
}

4150 
	$¢d_£q_evít_ouçut
(
¢d_£q_t
 *
£q
, 
¢d_£q_evít_t
 *
ev
)

4152 
ªsu…
;

4154 
ªsu…
 = 
	`¢d_£q_evít_ouçut_buf„r
(
£q
, 
ev
);

4155 i‡(
ªsu…
 =-
EAGAIN
) {

4156 
ªsu…
 = 
	`¢d_£q_døö_ouçut
(
£q
);

4157 i‡(
ªsu…
 < 0)

4158  
ªsu…
;

4159  
	`¢d_£q_evít_ouçut_buf„r
(
£q
, 
ev
);

4161  
ªsu…
;

4162 
	}
}

4165 
	$˛ór_ump_f‹_Àgacy_≠ps
(
¢d_£q_t
 *
£q
, 
¢d_£q_evít_t
 *
ev
)

4167 i‡(!
£q
->
midi_vîsi⁄
 && 
	`¢d_£q_ev_is_ump
(
ev
))

4168 
ev
->
Êags
 &~
SNDRV_SEQ_EVENT_UMP
;

4169 
	}
}

4184 
	$¢d_£q_evít_ouçut_buf„r
(
¢d_£q_t
 *
£q
, 
¢d_£q_evít_t
 *
ev
)

4186 
Àn
;

4187 
	`as£π
(
£q
 && 
ev
);

4188 
	`˛ór_ump_f‹_Àgacy_≠ps
(
£q
, 
ev
);

4189 
Àn
 = 
	`¢d_£q_evít_Àngth
(
ev
);

4190 i‡(
Àn
 < 0)

4191  -
EINVAL
;

4192 i‡((
size_t
Ë
Àn
 >
£q
->
obufsize
)

4193  -
EINVAL
;

4194 i‡((
£q
->
obufsize
 - seq->
obufu£d
Ë< (
size_t
Ë
Àn
)

4195  -
EAGAIN
;

4196 i‡(
	`¢d_£q_ev_is_ump
(
ev
)) {

4197 
	`mem˝y
(
£q
->
obuf
 + seq->
obufu£d
, 
ev
, (
¢d_£q_ump_evít_t
));

4199 
	`mem˝y
(
£q
->
obuf
 + seq->
obufu£d
, 
ev
, (
¢d_£q_evít_t
));

4200 i‡(
	`¢d_£q_ev_is_v¨übÀ
(
ev
))

4201 
	`mem˝y
(
£q
->
obuf
 + seq->
obufu£d
 + (
¢d_£q_evít_t
),

4202 
ev
->
d©a
.
ext
.
±r
,Év->d©a.ext.
Àn
);

4204 
£q
->
obufu£d
 +
Àn
;

4205  
£q
->
obufu£d
;

4206 
	}
}

4211 
	$Æloc_tmpbuf
(
¢d_£q_t
 *
£q
, 
size_t
 
Àn
)

4213 
size_t
 
size
 = ((
Àn
 + (
¢d_£q_evít_t
) - 1) / (snd_seq_event_t));

4214 i‡(
£q
->
tmpbuf
 =
NULL
) {

4215 i‡(
size
 > 
DEFAULT_TMPBUF_SIZE
)

4216 
£q
->
tmpbufsize
 = 
size
;

4218 
£q
->
tmpbufsize
 = 
DEFAULT_TMPBUF_SIZE
;

4219 
£q
->
tmpbuf
 = 
	`mÆloc
(£q->
tmpbufsize
 * (
¢d_£q_evít_t
));

4220 i‡(
£q
->
tmpbuf
 =
NULL
)

4221  -
ENOMEM
;

4222 } i‡(
Àn
 > 
£q
->
tmpbufsize
) {

4223 
£q
->
tmpbuf
 = 
	`ªÆloc
(£q->tmpbuf, 
size
 * (
¢d_£q_evít_t
));

4224 i‡(
£q
->
tmpbuf
 =
NULL
)

4225  -
ENOMEM
;

4226 
£q
->
tmpbufsize
 = 
size
;

4229 
	}
}

4244 
	$¢d_£q_evít_ouçut_dúe˘
(
¢d_£q_t
 *
£q
, 
¢d_£q_evít_t
 *
ev
)

4246 
ssize_t
 
Àn
;

4247 *
buf
;

4249 
	`˛ór_ump_f‹_Àgacy_≠ps
(
£q
, 
ev
);

4250 
Àn
 = 
	`¢d_£q_evít_Àngth
(
ev
);

4251 i‡(
Àn
 < 0)

4252  
Àn
;

4253 i‡(
	`¢d_£q_ev_is_ump
(
ev
Ë|| !
	`¢d_£q_ev_is_v¨übÀ
(ev)) {

4254 
buf
 = 
ev
;

4256 i‡(
	`Æloc_tmpbuf
(
£q
, (
size_t
)
Àn
) < 0)

4257  -
ENOMEM
;

4258 *
£q
->
tmpbuf
 = *
ev
;

4259 
	`mem˝y
(
£q
->
tmpbuf
 + 1, 
ev
->
d©a
.
ext
.
±r
,Év->d©a.ext.
Àn
);

4260 
buf
 = 
£q
->
tmpbuf
;

4262  
£q
->
›s
->
	`wrôe
(£q, 
buf
, (
size_t
Ë
Àn
);

4263 
	}
}

4272 
	$¢d_£q_evít_ouçut_≥ndög
(
¢d_£q_t
 *
£q
)

4274 
	`as£π
(
£q
);

4275  
£q
->
obufu£d
;

4276 
	}
}

4293 
	$¢d_£q_døö_ouçut
(
¢d_£q_t
 *
£q
)

4295 
ssize_t
 
ªsu…
, 
¥o˚s£d
 = 0;

4296 
	`as£π
(
£q
);

4297 
£q
->
obufu£d
 > 0) {

4298 
ªsu…
 = 
£q
->
›s
->
	`wrôe
(£q, seq->
obuf
, seq->
obufu£d
);

4299 i‡(
ªsu…
 < 0) {

4300 i‡(
ªsu…
 =-
EAGAIN
 && 
¥o˚s£d
)

4301  
£q
->
obufu£d
;

4302  
ªsu…
;

4304 i‡((
size_t
)
ªsu…
 < 
£q
->
obufu£d
)

4305 
	`memmove
(
£q
->
obuf
, seq->obu‡+ 
ªsu…
, seq->
obufu£d
 -Ñesult);

4306 
£q
->
obufu£d
 -
ªsu…
;

4309 
	}
}

4322 
	$¢d_£q_exåa˘_ouçut
(
¢d_£q_t
 *
£q
, 
¢d_£q_evít_t
 **
ev_ªs
)

4324 
size_t
 
Àn
, 
ﬁí
;

4325 
	`as£π
(
£q
);

4326 i‡(
ev_ªs
)

4327 *
ev_ªs
 = 
NULL
;

4328 i‡((
ﬁí
 = 
£q
->
obufu£d
Ë< (
¢d_£q_evít_t
))

4329  -
ENOENT
;

4330 
Àn
 = 
	`¢d_£q_evít_Àngth
((
¢d_£q_evít_t
 *)
£q
->
obuf
);

4331 i‡(
ﬁí
 < 
Àn
)

4332  -
ENOENT
;

4333 i‡(
ev_ªs
) {

4335 i‡(
	`Æloc_tmpbuf
(
£q
, 
Àn
) < 0)

4336  -
ENOMEM
;

4337 
	`mem˝y
(
£q
->
tmpbuf
, seq->
obuf
, 
Àn
);

4338 *
ev_ªs
 = (
¢d_£q_evít_t
 *)
£q
->
tmpbuf
;

4340 
£q
->
obufu£d
 = 
ﬁí
 - 
Àn
;

4341 
	`memmove
(
£q
->
obuf
, seq->obu‡+ 
Àn
, seq->
obufu£d
);

4343 
	}
}

4354 
ssize_t
 
	$¢d_£q_evít_ªad_buf„r
(
¢d_£q_t
 *
£q
)

4356 
size_t
 
∑ckë_size
 = 
	`gë_∑ckë_size
(
£q
);

4357 
ssize_t
 
Àn
;

4359 
Àn
 = (
£q
->
›s
->
ªad
)(£q, seq->
ibuf
, seq->
ibufsize
 * 
∑ckë_size
);

4360 i‡(
Àn
 < 0)

4361  
Àn
;

4362 
£q
->
ibuÊí
 = 
Àn
 / 
∑ckë_size
;

4363 
£q
->
ibuÂå
 = 0;

4364  
£q
->
ibuÊí
;

4365 
	}
}

4367 
	$¢d_£q_evít_ªåõve_buf„r
(
¢d_£q_t
 *
£q
, 
¢d_£q_evít_t
 **
ªç
)

4369 
size_t
 
∑ckë_size
 = 
	`gë_∑ckë_size
(
£q
);

4370 
size_t
 
n˚Œs
;

4371 
¢d_£q_evít_t
 *
ev
;

4373 *
ªç
 = 
ev
 = (
¢d_£q_evít_t
 *)(
£q
->
ibuf
 + seq->
ibuÂå
 * 
∑ckë_size
);

4374 
	`˛ór_ump_f‹_Àgacy_≠ps
(
£q
, 
ev
);

4375 
£q
->
ibuÂå
++;

4376 
£q
->
ibuÊí
--;

4377 i‡(! 
	`¢d_£q_ev_is_v¨übÀ
(
ev
))

4379 
n˚Œs
 = (
ev
->
d©a
.
ext
.
Àn
 + 
∑ckë_size
 - 1) /Öacket_size;

4380 i‡(
£q
->
ibuÊí
 < 
n˚Œs
) {

4381 
£q
->
ibuÊí
 = 0;

4382 *
ªç
 = 
NULL
;

4383  -
EINVAL
;

4385 
ev
->
d©a
.
ext
.
±r
 = (*Îv + 
∑ckë_size
;

4386 
£q
->
ibuÊí
 -
n˚Œs
;

4387 
£q
->
ibuÂå
 +
n˚Œs
;

4389 
	}
}

4421 
	$¢d_£q_evít_öput
(
¢d_£q_t
 *
£q
, 
¢d_£q_evít_t
 **
ev
)

4423 
îr
;

4424 
	`as£π
(
£q
);

4425 *
ev
 = 
NULL
;

4426 i‡(
£q
->
ibuÊí
 <= 0) {

4427 i‡((
îr
 = 
	`¢d_£q_evít_ªad_buf„r
(
£q
)) < 0)

4428  
îr
;

4431  
	`¢d_£q_evít_ªåõve_buf„r
(
£q
, 
ev
);

4432 
	}
}

4437 
	$¢d_£q_evít_öput_„ed
(
¢d_£q_t
 *
£q
, 
timeout
)

4439 
pﬁlfd
 
pfd
;

4440 
îr
;

4441 
pfd
.
fd
 = 
£q
->
pﬁl_fd
;

4442 
pfd
.
evíts
 = 
POLLIN
;

4443 
îr
 = 
	`pﬁl
(&
pfd
, 1, 
timeout
);

4444 i‡(
îr
 < 0) {

4445 
	`SYSERR
("poll");

4446  -
î∫o
;

4448 i‡(
pfd
.
ªvíts
 & 
POLLIN
)

4449  
	`¢d_£q_evít_ªad_buf„r
(
£q
);

4450  
£q
->
ibuÊí
;

4451 
	}
}

4468 
	$¢d_£q_evít_öput_≥ndög
(
¢d_£q_t
 *
£q
, 
„tch_£quí˚r
)

4470 i‡(
£q
->
ibuÊí
 =0 && 
„tch_£quí˚r
) {

4471  
	`¢d_£q_evít_öput_„ed
(
£q
, 0);

4473  
£q
->
ibuÊí
;

4474 
	}
}

4500 
	$¢d_£q_ump_evít_ouçut
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_evít_t
 *
ev
)

4502 i‡(!
£q
->
midi_vîsi⁄
)

4503  -
EBADFD
;

4504  
	`¢d_£q_evít_ouçut
(
£q
, (
¢d_£q_evít_t
 *)
ev
);

4505 
	}
}

4517 
	$¢d_£q_ump_evít_ouçut_buf„r
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_evít_t
 *
ev
)

4519 i‡(!
£q
->
midi_vîsi⁄
)

4520  -
EBADFD
;

4521  
	`¢d_£q_evít_ouçut_buf„r
(
£q
, (
¢d_£q_evít_t
 *)
ev
);

4522 
	}
}

4534 
	$¢d_£q_ump_exåa˘_ouçut
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_evít_t
 **
ev_ªs
)

4536 i‡(!
£q
->
midi_vîsi⁄
)

4537  -
EBADFD
;

4538  
	`¢d_£q_exåa˘_ouçut
(
£q
, (
¢d_£q_evít_t
 **)
ev_ªs
);

4539 
	}
}

4551 
	$¢d_£q_ump_evít_ouçut_dúe˘
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_evít_t
 *
ev
)

4553 i‡(!
£q
->
midi_vîsi⁄
)

4554  -
EBADFD
;

4555  
	`¢d_£q_evít_ouçut_dúe˘
(
£q
, (
¢d_£q_evít_t
 *)
ev
);

4556 
	}
}

4574 
	$¢d_£q_ump_evít_öput
(
¢d_£q_t
 *
£q
, 
¢d_£q_ump_evít_t
 **
ev
)

4576 i‡(!
£q
->
midi_vîsi⁄
)

4577  -
EBADFD
;

4578  
	`¢d_£q_evít_öput
(
£q
, (
¢d_£q_evít_t
 **)
ev
);

4579 
	}
}

4597 
	$¢d_£q_dr›_ouçut_buf„r
(
¢d_£q_t
 *
£q
)

4599 
	`as£π
(
£q
);

4600 
£q
->
obufu£d
 = 0;

4602 
	}
}

4610 
	$¢d_£q_dr›_öput_buf„r
(
¢d_£q_t
 *
£q
)

4612 
	`as£π
(
£q
);

4613 
£q
->
ibuÂå
 = 0;

4614 
£q
->
ibuÊí
 = 0;

4616 
	}
}

4627 
	$¢d_£q_dr›_ouçut
(
¢d_£q_t
 *
£q
)

4629 
¢d_£q_ªmove_evíts_t
 
rmöfo
;

4630 
	`as£π
(
£q
);

4632 
	`mem£t
(&
rmöfo
, 0, (rminfo));

4633 
rmöfo
.
ªmove_mode
 = 
SNDRV_SEQ_REMOVE_OUTPUT
;

4635  
	`¢d_£q_ªmove_evíts
(
£q
, &
rmöfo
);

4636 
	}
}

4644 
	$¢d_£q_dr›_öput
(
¢d_£q_t
 *
£q
)

4646 
¢d_£q_ªmove_evíts_t
 
rmöfo
;

4647 
	`as£π
(
£q
);

4649 
	`mem£t
(&
rmöfo
, 0, (rminfo));

4650 
rmöfo
.
ªmove_mode
 = 
SNDRV_SEQ_REMOVE_INPUT
;

4652  
	`¢d_£q_ªmove_evíts
(
£q
, &
rmöfo
);

4653 
	}
}

4660 
size_t
 
	$¢d_£q_ªmove_evíts_sizeof
()

4662  (
¢d_£q_ªmove_evíts_t
);

4663 
	}
}

4670 
	$¢d_£q_ªmove_evíts_mÆloc
(
¢d_£q_ªmove_evíts_t
 **
±r
)

4672 
	`as£π
(
±r
);

4673 *
±r
 = 
	`ˇŒoc
(1, (
¢d_£q_ªmove_evíts_t
));

4674 i‡(!*
±r
)

4675  -
ENOMEM
;

4677 
	}
}

4683 
	$¢d_£q_ªmove_evíts_‰ì
(
¢d_£q_ªmove_evíts_t
 *
obj
)

4685 
	`‰ì
(
obj
);

4686 
	}
}

4693 
	$¢d_£q_ªmove_evíts_c›y
(
¢d_£q_ªmove_evíts_t
 *
d°
, c⁄° snd_£q_ªmove_evíts_à*
§c
)

4695 
	`as£π
(
d°
 && 
§c
);

4696 *
d°
 = *
§c
;

4697 
	}
}

4707 
	$¢d_£q_ªmove_evíts_gë_c⁄dôi⁄
(c⁄° 
¢d_£q_ªmove_evíts_t
 *
öfo
)

4709 
	`as£π
(
öfo
);

4710  
öfo
->
ªmove_mode
;

4711 
	}
}

4720 
	$¢d_£q_ªmove_evíts_gë_queue
(c⁄° 
¢d_£q_ªmove_evíts_t
 *
öfo
)

4722 
	`as£π
(
öfo
);

4723  
öfo
->
queue
;

4724 
	}
}

4733 c⁄° 
¢d_£q_time°amp_t
 *
	$¢d_£q_ªmove_evíts_gë_time
(c⁄° 
¢d_£q_ªmove_evíts_t
 *
öfo
)

4735 
	`as£π
(
öfo
);

4736  (c⁄° 
¢d_£q_time°amp_t
 *)&
öfo
->
time
;

4737 
	}
}

4746 c⁄° 
¢d_£q_addr_t
 *
	$¢d_£q_ªmove_evíts_gë_de°
(c⁄° 
¢d_£q_ªmove_evíts_t
 *
öfo
)

4748 
	`as£π
(
öfo
);

4749  (c⁄° 
¢d_£q_addr_t
 *)&
öfo
->
de°
;

4750 
	}
}

4759 
	$¢d_£q_ªmove_evíts_gë_ch™√l
(c⁄° 
¢d_£q_ªmove_evíts_t
 *
öfo
)

4761 
	`as£π
(
öfo
);

4762  
öfo
->
ch™√l
;

4763 
	}
}

4772 
	$¢d_£q_ªmove_evíts_gë_evít_ty≥
(c⁄° 
¢d_£q_ªmove_evíts_t
 *
öfo
)

4774 
	`as£π
(
öfo
);

4775  
öfo
->
ty≥
;

4776 
	}
}

4785 
	$¢d_£q_ªmove_evíts_gë_èg
(c⁄° 
¢d_£q_ªmove_evíts_t
 *
öfo
)

4787 
	`as£π
(
öfo
);

4788  
öfo
->
èg
;

4789 
	}
}

4798 
	$¢d_£q_ªmove_evíts_£t_c⁄dôi⁄
(
¢d_£q_ªmove_evíts_t
 *
öfo
, 
Êags
)

4800 
	`as£π
(
öfo
);

4801 
öfo
->
ªmove_mode
 = 
Êags
;

4802 
	}
}

4811 
	$¢d_£q_ªmove_evíts_£t_queue
(
¢d_£q_ªmove_evíts_t
 *
öfo
, 
queue
)

4813 
	`as£π
(
öfo
);

4814 
öfo
->
queue
 = queue;

4815 
	}
}

4824 
	$¢d_£q_ªmove_evíts_£t_time
(
¢d_£q_ªmove_evíts_t
 *
öfo
, c⁄° 
¢d_£q_time°amp_t
 *
time
)

4826 
	`as£π
(
öfo
);

4827 
öfo
->
time
 = *(c⁄° 
¢drv_£q_time°amp
 *)time;

4828 
	}
}

4837 
	$¢d_£q_ªmove_evíts_£t_de°
(
¢d_£q_ªmove_evíts_t
 *
öfo
, c⁄° 
¢d_£q_addr_t
 *
addr
)

4839 
	`as£π
(
öfo
);

4840 
öfo
->
de°
 = *(c⁄° 
¢drv_£q_addr
 *)
addr
;

4841 
	}
}

4850 
	$¢d_£q_ªmove_evíts_£t_ch™√l
(
¢d_£q_ªmove_evíts_t
 *
öfo
, 
ch™√l
)

4852 
	`as£π
(
öfo
);

4853 
öfo
->
ch™√l
 = channel;

4854 
	}
}

4863 
	$¢d_£q_ªmove_evíts_£t_evít_ty≥
(
¢d_£q_ªmove_evíts_t
 *
öfo
, 
ty≥
)

4865 
	`as£π
(
öfo
);

4866 
öfo
->
ty≥
 =Åype;

4867 
	}
}

4876 
	$¢d_£q_ªmove_evíts_£t_èg
(
¢d_£q_ªmove_evíts_t
 *
öfo
, 
èg
)

4878 
	`as£π
(
öfo
);

4879 
öfo
->
èg
 =Åag;

4880 
	}
}

4885 
ölöe
 
	$¢d_£q_com∑ª_tick_time
(
¢d_£q_tick_time_t
 *
a
, snd_£q_tick_time_à*
b
)

4888  (*
a
 >*
b
);

4889 
	}
}

4891 
ölöe
 
	$¢d_£q_com∑ª_ªÆ_time
(
¢d_£q_ªÆ_time_t
 *
a
, snd_£q_ªÆ_time_à*
b
)

4894 i‡(
a
->
tv_£c
 > 
b
->tv_sec)

4896 i‡((
a
->
tv_£c
 =
b
->tv_£cË&& (a->
tv_n£c
 >= b->tv_nsec))

4899 
	}
}

4902 
	$ªmove_m©ch
(
¢d_£q_ªmove_evíts_t
 *
öfo
, 
¢d_£q_evít_t
 *
ev
)

4904 
ªs
;

4906 i‡(
öfo
->
ªmove_mode
 & 
SNDRV_SEQ_REMOVE_DEST
) {

4907 i‡(
ev
->
de°
.
˛õ¡
 !
öfo
->dest.client ||

4908 
ev
->
de°
.
p‹t
 !
öfo
->dest.port)

4911 i‡(
öfo
->
ªmove_mode
 & 
SNDRV_SEQ_REMOVE_DEST_CHANNEL
) {

4912 i‡(! 
	`¢d_£q_ev_is_ch™√l_ty≥
(
ev
))

4915 i‡(
ev
->
d©a
.
nŸe
.
ch™√l
 !
öfo
->channel)

4918 i‡(
öfo
->
ªmove_mode
 & 
SNDRV_SEQ_REMOVE_TIME_AFTER
) {

4919 i‡(
öfo
->
ªmove_mode
 & 
SNDRV_SEQ_REMOVE_TIME_TICK
)

4920 
ªs
 = 
	`¢d_£q_com∑ª_tick_time
(&
ev
->
time
.
tick
, &
öfo
->time.tick);

4922 
ªs
 = 
	`¢d_£q_com∑ª_ªÆ_time
(&
ev
->
time
.time, (
¢d_£q_ªÆ_time_t
 *)&
öfo
->time.time);

4923 i‡(!
ªs
)

4926 i‡(
öfo
->
ªmove_mode
 & 
SNDRV_SEQ_REMOVE_TIME_BEFORE
) {

4927 i‡(
öfo
->
ªmove_mode
 & 
SNDRV_SEQ_REMOVE_TIME_TICK
)

4928 
ªs
 = 
	`¢d_£q_com∑ª_tick_time
(&
ev
->
time
.
tick
, &
öfo
->time.tick);

4930 
ªs
 = 
	`¢d_£q_com∑ª_ªÆ_time
(&
ev
->
time
.time, (
¢d_£q_ªÆ_time_t
 *)&
öfo
->time.time);

4931 i‡(
ªs
)

4934 i‡(
öfo
->
ªmove_mode
 & 
SNDRV_SEQ_REMOVE_EVENT_TYPE
) {

4935 i‡(
ev
->
ty≥
 !
öfo
->type)

4938 i‡(
öfo
->
ªmove_mode
 & 
SNDRV_SEQ_REMOVE_IGNORE_OFF
) {

4940 
ev
->
ty≥
) {

4941 
SND_SEQ_EVENT_NOTEOFF
:

4948 i‡(
öfo
->
ªmove_mode
 & 
SNDRV_SEQ_REMOVE_TAG_MATCH
) {

4949 i‡(
öfo
->
èg
 !
ev
->tag)

4954 
	}
}

4967 
	$¢d_£q_ªmove_evíts
(
¢d_£q_t
 *
£q
, 
¢d_£q_ªmove_evíts_t
 *
rmp
)

4969 i‡(
rmp
->
ªmove_mode
 & 
SNDRV_SEQ_REMOVE_INPUT
) {

4974 
	`¢d_£q_dr›_öput_buf„r
(
£q
);

4977 i‡(
rmp
->
ªmove_mode
 & 
SNDRV_SEQ_REMOVE_OUTPUT
) {

4982 i‡(! (
rmp
->
ªmove_mode
 & ~(
SNDRV_SEQ_REMOVE_INPUT
|
SNDRV_SEQ_REMOVE_OUTPUT
))) {

4984 
	`¢d_£q_dr›_ouçut_buf„r
(
£q
);

4986 *
ï
;

4987 
size_t
 
Àn
;

4988 
¢d_£q_evít_t
 *
ev
;

4990 
ï
 = 
£q
->
obuf
;

4991 
ï
 - 
£q
->
obuf
 < (
ssize_t
)£q->
obufu£d
) {

4993 
ev
 = (
¢d_£q_evít_t
 *)
ï
;

4994 
Àn
 = 
	`¢d_£q_evít_Àngth
(
ev
);

4996 i‡(
	`ªmove_m©ch
(
rmp
, 
ev
)) {

4998 
£q
->
obufu£d
 -
Àn
;

4999 
	`memmove
(
ï
,É∞+ 
Àn
, 
£q
->
obufu£d
 - (ï - seq->
obuf
));

5001 
ï
 +
Àn
;

5007  
£q
->
›s
->
	`ªmove_evíts
(£q, 
rmp
);

5008 
	}
}

5020 
size_t
 
	$¢d_£q_˛õ¡_poﬁ_sizeof
()

5022  (
¢d_£q_˛õ¡_poﬁ_t
);

5023 
	}
}

5030 
	$¢d_£q_˛õ¡_poﬁ_mÆloc
(
¢d_£q_˛õ¡_poﬁ_t
 **
±r
)

5032 
	`as£π
(
±r
);

5033 *
±r
 = 
	`ˇŒoc
(1, (
¢d_£q_˛õ¡_poﬁ_t
));

5034 i‡(!*
±r
)

5035  -
ENOMEM
;

5037 
	}
}

5043 
	$¢d_£q_˛õ¡_poﬁ_‰ì
(
¢d_£q_˛õ¡_poﬁ_t
 *
obj
)

5045 
	`‰ì
(
obj
);

5046 
	}
}

5053 
	$¢d_£q_˛õ¡_poﬁ_c›y
(
¢d_£q_˛õ¡_poﬁ_t
 *
d°
, c⁄° snd_£q_˛õ¡_poﬁ_à*
§c
)

5055 
	`as£π
(
d°
 && 
§c
);

5056 *
d°
 = *
§c
;

5057 
	}
}

5065 
	$¢d_£q_˛õ¡_poﬁ_gë_˛õ¡
(c⁄° 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
)

5067 
	`as£π
(
öfo
);

5068  
öfo
->
˛õ¡
;

5069 
	}
}

5076 
size_t
 
	$¢d_£q_˛õ¡_poﬁ_gë_ouçut_poﬁ
(c⁄° 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
)

5078 
	`as£π
(
öfo
);

5079  
öfo
->
ouçut_poﬁ
;

5080 
	}
}

5087 
size_t
 
	$¢d_£q_˛õ¡_poﬁ_gë_öput_poﬁ
(c⁄° 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
)

5089 
	`as£π
(
öfo
);

5090  
öfo
->
öput_poﬁ
;

5091 
	}
}

5098 
size_t
 
	$¢d_£q_˛õ¡_poﬁ_gë_ouçut_room
(c⁄° 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
)

5100 
	`as£π
(
öfo
);

5101  
öfo
->
ouçut_room
;

5102 
	}
}

5109 
size_t
 
	$¢d_£q_˛õ¡_poﬁ_gë_ouçut_‰ì
(c⁄° 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
)

5111 
	`as£π
(
öfo
);

5112  
öfo
->
ouçut_‰ì
;

5113 
	}
}

5120 
size_t
 
	$¢d_£q_˛õ¡_poﬁ_gë_öput_‰ì
(c⁄° 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
)

5122 
	`as£π
(
öfo
);

5123  
öfo
->
öput_‰ì
;

5124 
	}
}

5131 
	$¢d_£q_˛õ¡_poﬁ_£t_ouçut_poﬁ
(
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
, 
size_t
 
size
)

5133 
	`as£π
(
öfo
);

5134 
öfo
->
ouçut_poﬁ
 = 
size
;

5135 
	}
}

5142 
	$¢d_£q_˛õ¡_poﬁ_£t_öput_poﬁ
(
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
, 
size_t
 
size
)

5144 
	`as£π
(
öfo
);

5145 
öfo
->
öput_poﬁ
 = 
size
;

5146 
	}
}

5153 
	$¢d_£q_˛õ¡_poﬁ_£t_ouçut_room
(
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
, 
size_t
 
size
)

5155 
	`as£π
(
öfo
);

5156 
öfo
->
ouçut_room
 = 
size
;

5157 
	}
}

5165 
	$¢d_£q_gë_˛õ¡_poﬁ
(
¢d_£q_t
 *
£q
, 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
)

5167 
	`as£π
(
£q
 && 
öfo
);

5168 
öfo
->
˛õ¡
 = 
£q
->client;

5169  
£q
->
›s
->
	`gë_˛õ¡_poﬁ
(£q, 
öfo
);

5170 
	}
}

5180 
	$¢d_£q_£t_˛õ¡_poﬁ
(
¢d_£q_t
 *
£q
, 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
)

5182 
	`as£π
(
£q
 && 
öfo
);

5183 
öfo
->
˛õ¡
 = 
£q
->client;

5184  
£q
->
›s
->
	`£t_˛õ¡_poﬁ
(£q, 
öfo
);

5185 
	}
}

5196 
	$¢d_£q_£t_bô
(
ƒ
, *
¨øy
)

5198 ((*)
¨øy
)[
ƒ
 >> 5] |= 1UL << (nr & 31);

5199 
	}
}

5204 
	$¢d_£q_un£t_bô
(
ƒ
, *
¨øy
)

5206 ((*)
¨øy
)[
ƒ
 >> 5] &= ~(1UL << (nr & 31));

5207 
	}
}

5212 
	$¢d_£q_ch™ge_bô
(
ƒ
, *
¨øy
)

5214 
ªsu…
;

5216 
ªsu…
 = ((((*)
¨øy
)[
ƒ
 >> 5]) & (1UL << (nr & 31))) ? 1 : 0;

5217 ((*)
¨øy
)[
ƒ
 >> 5] ^= 1UL << (nr & 31);

5218  
ªsu…
;

5219 
	}
}

5224 
	$¢d_£q_gë_bô
(
ƒ
, *
¨øy
)

5226  ((((*)
¨øy
)[
ƒ
 >> 5]) & (1UL << (nr & 31))) ? 1 : 0;

5227 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_event.c

8 
	~"loˇl.h
"

10 #i‚de‡
DOC_HIDDEN


11 
	#FIXED_EV
(
x
Ë(
	`_SND_SEQ_TYPE
(
SND_SEQ_EVFLG_FIXED
Ë| _SND_SEQ_TYPE(x))

	)

15 c⁄° 
	g¢d_£q_evít_ty≥s
[256] = {

16 [
SND_SEQ_EVENT_SYSTEM
 ... 
SND_SEQ_EVENT_RESULT
]

17 
FIXED_EV
(
SND_SEQ_EVFLG_RESULT
),

18 [
SND_SEQ_EVENT_NOTE
]

19 
FIXED_EV
(
SND_SEQ_EVFLG_NOTE
Ë| 
_SND_SEQ_TYPE_OPT
(
SND_SEQ_EVFLG_NOTE_TWOARG
),

20 [
SND_SEQ_EVENT_NOTEON
 ... 
SND_SEQ_EVENT_KEYPRESS
]

21 
FIXED_EV
(
SND_SEQ_EVFLG_NOTE
),

22 [
SND_SEQ_EVENT_CONTROLLER
 ... 
SND_SEQ_EVENT_REGPARAM
]

23 
FIXED_EV
(
SND_SEQ_EVFLG_CONTROL
),

24 [
SND_SEQ_EVENT_START
 ... 
SND_SEQ_EVENT_STOP
]

25 
FIXED_EV
(
SND_SEQ_EVFLG_QUEUE
),

26 [
SND_SEQ_EVENT_SETPOS_TICK
]

27 
FIXED_EV
(
SND_SEQ_EVFLG_QUEUE
Ë| 
_SND_SEQ_TYPE_OPT
(
SND_SEQ_EVFLG_QUEUE_TICK
),

28 [
SND_SEQ_EVENT_SETPOS_TIME
]

29 
FIXED_EV
(
SND_SEQ_EVFLG_QUEUE
Ë| 
_SND_SEQ_TYPE_OPT
(
SND_SEQ_EVFLG_QUEUE_TIME
),

30 [
SND_SEQ_EVENT_TEMPO
 ... 
SND_SEQ_EVENT_SYNC_POS
]

31 
FIXED_EV
(
SND_SEQ_EVFLG_QUEUE
Ë| 
_SND_SEQ_TYPE_OPT
(
SND_SEQ_EVFLG_QUEUE_VALUE
),

32 [
SND_SEQ_EVENT_TUNE_REQUEST
 ... 
SND_SEQ_EVENT_SENSING
]

33 
FIXED_EV
(
SND_SEQ_EVFLG_NONE
),

34 [
SND_SEQ_EVENT_ECHO
 ... 
SND_SEQ_EVENT_OSS
]

35 
FIXED_EV
(
SND_SEQ_EVFLG_RAW
Ë| FIXED_EV(
SND_SEQ_EVFLG_SYSTEM
),

36 [
SND_SEQ_EVENT_CLIENT_START
 ... 
SND_SEQ_EVENT_PORT_CHANGE
]

37 
FIXED_EV
(
SND_SEQ_EVFLG_MESSAGE
),

38 [
SND_SEQ_EVENT_PORT_SUBSCRIBED
 ... 
SND_SEQ_EVENT_PORT_UNSUBSCRIBED
]

39 
FIXED_EV
(
SND_SEQ_EVFLG_CONNECTION
),

40 [
SND_SEQ_EVENT_USR0
 ... 
SND_SEQ_EVENT_USR9
]

41 
FIXED_EV
(
SND_SEQ_EVFLG_RAW
Ë| FIXED_EV(
SND_SEQ_EVFLG_USERS
),

42 [
SND_SEQ_EVENT_SYSEX
 ... 
SND_SEQ_EVENT_BOUNCE
]

43 
_SND_SEQ_TYPE
(
SND_SEQ_EVFLG_VARIABLE
),

44 [
SND_SEQ_EVENT_USR_VAR0
 ... 
SND_SEQ_EVENT_USR_VAR4
]

45 
_SND_SEQ_TYPE
(
SND_SEQ_EVFLG_VARIABLE
Ë| _SND_SEQ_TYPE(
SND_SEQ_EVFLG_USERS
),

46 [
SND_SEQ_EVENT_NONE
]

47 
FIXED_EV
(
SND_SEQ_EVFLG_NONE
),

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_hw.c

23 
	~"£q_loˇl.h
"

24 
	~<f˙é.h
>

25 
	~<sys/io˘l.h
>

27 #i‚de‡
PIC


29 c⁄° *
	g_¢d_moduÀ_£q_hw
 = "";

32 #i‚de‡
DOC_HIDDEN


33 
	#SNDRV_FILE_SEQ
 
ALSA_DEVICE_DIRECTORY
 "£q"

	)

34 
	#SNDRV_FILE_ALOADSEQ
 
ALOAD_DEVICE_DIRECTORY
 "ÆﬂdSEQ"

	)

37 
	mfd
;

38 
	mvîsi⁄
;

39 } 
	t¢d_£q_hw_t
;

42 
	$¢d_£q_hw_˛o£
(
¢d_£q_t
 *
£q
)

44 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

45 
îr
 = 0;

47 i‡(
	`˛o£
(
hw
->
fd
)) {

48 
îr
 = -
î∫o
;

49 
	`SYSERR
("close failed\n");

51 
	`‰ì
(
hw
);

52  
îr
;

53 
	}
}

55 
	$¢d_£q_hw_n⁄block
(
¢d_£q_t
 *
£q
, 
n⁄block
)

57 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

58 
Êags
;

60 i‡((
Êags
 = 
	`f˙é
(
hw
->
fd
, 
F_GETFL
)) < 0) {

61 
	`SYSERR
("F_GETFL failed");

62  -
î∫o
;

64 i‡(
n⁄block
)

65 
Êags
 |
O_NONBLOCK
;

67 
Êags
 &~
O_NONBLOCK
;

68 i‡(
	`f˙é
(
hw
->
fd
, 
F_SETFL
, 
Êags
) < 0) {

69 
	`SYSERR
("F_SETFL for O_NONBLOCK failed");

70  -
î∫o
;

73 
	}
}

75 
	$¢d_£q_hw_˛õ¡_id
(
¢d_£q_t
 *
£q
)

77 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

78 
˛õ¡
;

79 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_CLIENT_ID
, &
˛õ¡
) < 0) {

80 
	`SYSERR
("SNDRV_SEQ_IOCTL_CLIENT_ID failed");

81  -
î∫o
;

83  
˛õ¡
;

84 
	}
}

86 
	$¢d_£q_hw_sy°em_öfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_sy°em_öfo_t
 * 
öfo
)

88 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

89 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SYSTEM_INFO
, 
öfo
) < 0) {

90 
	`SYSERR
("SNDRV_SEQ_IOCTL_SYSTEM_INFO failed");

91  -
î∫o
;

94 
	}
}

96 
	$upd©e_midi_vîsi⁄
(
¢d_£q_t
 *
£q
, 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

98 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

100 i‡(
	`SNDRV_PROTOCOL_VERSION
(1, 0, 3Ë<
hw
->
vîsi⁄
 &&

101 
£q
->
midi_vîsi⁄
 !()
öfo
->midi_version) {

102 
£q
->
midi_vîsi⁄
 = 
öfo
->midi_version;

103 i‡(
öfo
->
midi_vîsi⁄
 > 0)

104 
£q
->
∑ckë_size
 = (
¢d_£q_ump_evít_t
);

106 
£q
->
∑ckë_size
 = (
¢d_£q_evít_t
);

108 
	}
}

110 
	$¢d_£q_hw_gë_˛õ¡_öfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_˛õ¡_öfo_t
 * 
öfo
)

112 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

113 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_CLIENT_INFO
, 
öfo
) < 0) {

115  -
î∫o
;

117 i‡(
hw
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 2)) {

118 
öfo
->
ˇrd
 = -1;

119 
öfo
->
pid
 = -1;

122 
	}
}

124 
	$¢d_£q_hw_£t_˛õ¡_öfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_˛õ¡_öfo_t
 * 
öfo
)

126 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

128 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_CLIENT_INFO
, 
öfo
) < 0) {

130  -
î∫o
;

132 
	`upd©e_midi_vîsi⁄
(
£q
, 
öfo
);

134 
	}
}

136 
	$¢d_£q_hw_gë_ump_öfo
(
¢d_£q_t
 *
£q
, 
˛õ¡
, 
ty≥
, *
öfo
)

138 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

139 
¢d_£q_˛õ¡_ump_öfo
 
buf
;

140 
size_t
 
size
;

142 i‡(
ty≥
 < 0 ||Åy≥ >
SNDRV_SEQ_CLIENT_UMP_INFO_BLOCK
 + 32)

143  -
EINVAL
;

144 i‡(
hw
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 3))

145  -
ENOTTY
;

146 i‡(
ty≥
 =
SNDRV_SEQ_CLIENT_UMP_INFO_ENDPOINT
)

147 
size
 = (
¢d_ump_ídpoöt_öfo
);

149 
size
 = (
¢d_ump_block_öfo
);

150 
buf
.
˛õ¡
 = client;

151 
buf
.
ty≥
 =Åype;

152 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_CLIENT_UMP_INFO
, &
buf
) < 0)

153  -
î∫o
;

154 
	`mem˝y
(
öfo
, 
buf
.öfo, 
size
);

156 
	}
}

158 
	$¢d_£q_hw_£t_ump_öfo
(
¢d_£q_t
 *
£q
, 
ty≥
, c⁄° *
öfo
)

160 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

161 
¢d_£q_˛õ¡_ump_öfo
 
buf
;

162 
size_t
 
size
;

164 i‡(
ty≥
 < 0 ||Åy≥ >
SNDRV_SEQ_CLIENT_UMP_INFO_BLOCK
 + 32)

165  -
EINVAL
;

166 i‡(
hw
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 3))

167  -
ENOTTY
;

168 i‡(
ty≥
 =
SNDRV_SEQ_CLIENT_UMP_INFO_ENDPOINT
)

169 
size
 = (
¢d_ump_ídpoöt_öfo
);

171 
size
 = (
¢d_ump_block_öfo
);

172 
buf
.
˛õ¡
 = 
£q
->client;

173 
buf
.
ty≥
 =Åype;

174 
	`mem˝y
(
buf
.
öfo
, info, 
size
);

175 *(*)
buf
.
öfo
 = -1;

176 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_CLIENT_UMP_INFO
, &
buf
) < 0)

177  -
î∫o
;

179 
	}
}

181 
	$¢d_£q_hw_¸óã_p‹t
(
¢d_£q_t
 *
£q
, 
¢d_£q_p‹t_öfo_t
 * 
p‹t
)

183 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

184 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_CREATE_PORT
, 
p‹t
) < 0) {

186  -
î∫o
;

189 
	}
}

191 
	$¢d_£q_hw_dñëe_p‹t
(
¢d_£q_t
 *
£q
, 
¢d_£q_p‹t_öfo_t
 * 
p‹t
)

193 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

194 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_DELETE_PORT
, 
p‹t
) < 0) {

196  -
î∫o
;

199 
	}
}

201 
	$¢d_£q_hw_gë_p‹t_öfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_p‹t_öfo_t
 * 
öfo
)

203 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

204 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_PORT_INFO
, 
öfo
) < 0) {

206  -
î∫o
;

209 
	}
}

211 
	$¢d_£q_hw_£t_p‹t_öfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_p‹t_öfo_t
 * 
öfo
)

213 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

214 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_PORT_INFO
, 
öfo
) < 0) {

216  -
î∫o
;

219 
	}
}

221 
	$¢d_£q_hw_gë_p‹t_subs¸ùti⁄
(
¢d_£q_t
 *
£q
, 
¢d_£q_p‹t_subs¸ibe_t
 * 
sub
)

223 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

224 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_SUBSCRIPTION
, 
sub
) < 0) {

226  -
î∫o
;

229 
	}
}

231 
	$¢d_£q_hw_subs¸ibe_p‹t
(
¢d_£q_t
 *
£q
, 
¢d_£q_p‹t_subs¸ibe_t
 * 
sub
)

233 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

234 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SUBSCRIBE_PORT
, 
sub
) < 0) {

236  -
î∫o
;

239 
	}
}

241 
	$¢d_£q_hw_unsubs¸ibe_p‹t
(
¢d_£q_t
 *
£q
, 
¢d_£q_p‹t_subs¸ibe_t
 * 
sub
)

243 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

244 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_UNSUBSCRIBE_PORT
, 
sub
) < 0) {

246  -
î∫o
;

249 
	}
}

251 
	$¢d_£q_hw_quîy_p‹t_subs¸ibîs
(
¢d_£q_t
 *
£q
, 
¢d_£q_quîy_subs¸ibe_t
 * 
subs
)

253 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

254 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_QUERY_SUBS
, 
subs
) < 0) {

256  -
î∫o
;

259 
	}
}

261 
	$¢d_£q_hw_gë_queue_°©us
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_°©us_t
 * 
°©us
)

263 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

264 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_QUEUE_STATUS
, 
°©us
) < 0) {

266  -
î∫o
;

269 
	}
}

271 
	$¢d_£q_hw_gë_queue_ãmpo
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_ãmpo_t
 * 
ãmpo
)

273 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

274 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_QUEUE_TEMPO
, 
ãmpo
) < 0) {

276  -
î∫o
;

279 
	}
}

281 
	$¢d_£q_hw_£t_queue_ãmpo
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_ãmpo_t
 * 
ãmpo
)

283 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

284 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_QUEUE_TEMPO
, 
ãmpo
) < 0) {

286  -
î∫o
;

289 
	}
}

291 
	$¢d_£q_hw_gë_queue_timî
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_timî_t
 * 
timî
)

293 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

294 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_QUEUE_TIMER
, 
timî
) < 0) {

296  -
î∫o
;

299 
	}
}

301 
	$¢d_£q_hw_£t_queue_timî
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_timî_t
 * 
timî
)

303 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

304 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_QUEUE_TIMER
, 
timî
) < 0) {

306  -
î∫o
;

309 
	}
}

311 
	$¢d_£q_hw_gë_queue_˛õ¡
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_˛õ¡_t
 * 
öfo
)

313 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

314 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_QUEUE_CLIENT
, 
öfo
) < 0) {

316  -
î∫o
;

319 
	}
}

321 
	$¢d_£q_hw_£t_queue_˛õ¡
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_˛õ¡_t
 * 
öfo
)

323 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

324 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_QUEUE_CLIENT
, 
öfo
) < 0) {

326  -
î∫o
;

329 
	}
}

331 
	$¢d_£q_hw_¸óã_queue
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_öfo_t
 *
öfo
)

333 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

334 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_CREATE_QUEUE
, 
öfo
) < 0) {

336  -
î∫o
;

339 
	}
}

341 
	$¢d_£q_hw_dñëe_queue
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_öfo_t
 *
öfo
)

343 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

344 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_DELETE_QUEUE
, 
öfo
) < 0) {

346  -
î∫o
;

349 
	}
}

351 
	$¢d_£q_hw_gë_queue_öfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_öfo_t
 *
öfo
)

353 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

354 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_QUEUE_INFO
, 
öfo
) < 0) {

356  -
î∫o
;

359 
	}
}

361 
	$¢d_£q_hw_£t_queue_öfo
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_öfo_t
 *
öfo
)

363 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

364 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_QUEUE_INFO
, 
öfo
) < 0) {

366  -
î∫o
;

369 
	}
}

371 
	$¢d_£q_hw_gë_«med_queue
(
¢d_£q_t
 *
£q
, 
¢d_£q_queue_öfo_t
 *
öfo
)

373 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

374 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_NAMED_QUEUE
, 
öfo
) < 0) {

376  -
î∫o
;

379 
	}
}

381 
ssize_t
 
	$¢d_£q_hw_wrôe
(
¢d_£q_t
 *
£q
, *
buf
, 
size_t
 
Àn
)

383 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

384 
ssize_t
 
ªsu…
 = 
	`wrôe
(
hw
->
fd
, 
buf
, 
Àn
);

385 i‡(
ªsu…
 < 0)

386  -
î∫o
;

387  
ªsu…
;

388 
	}
}

390 
ssize_t
 
	$¢d_£q_hw_ªad
(
¢d_£q_t
 *
£q
, *
buf
, 
size_t
 
Àn
)

392 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

393 
ssize_t
 
ªsu…
 = 
	`ªad
(
hw
->
fd
, 
buf
, 
Àn
);

394 i‡(
ªsu…
 < 0)

395  -
î∫o
;

396  
ªsu…
;

397 
	}
}

399 
	$¢d_£q_hw_ªmove_evíts
(
¢d_£q_t
 *
£q
, 
¢d_£q_ªmove_evíts_t
 *
rmp
)

401 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

402 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_REMOVE_EVENTS
, 
rmp
) < 0) {

404  -
î∫o
;

407 
	}
}

409 
	$¢d_£q_hw_gë_˛õ¡_poﬁ
(
¢d_£q_t
 *
£q
, 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
)

411 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

412 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_GET_CLIENT_POOL
, 
öfo
) < 0) {

414  -
î∫o
;

417 
	}
}

419 
	$¢d_£q_hw_£t_˛õ¡_poﬁ
(
¢d_£q_t
 *
£q
, 
¢d_£q_˛õ¡_poﬁ_t
 *
öfo
)

421 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

422 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_SET_CLIENT_POOL
, 
öfo
) < 0) {

424  -
î∫o
;

427 
	}
}

429 
	$¢d_£q_hw_quîy_√xt_˛õ¡
(
¢d_£q_t
 *
£q
, 
¢d_£q_˛õ¡_öfo_t
 *
öfo
)

431 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

432 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_QUERY_NEXT_CLIENT
, 
öfo
) < 0) {

434  -
î∫o
;

436 i‡(
hw
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(1, 0, 2)) {

437 
öfo
->
ˇrd
 = -1;

438 
öfo
->
pid
 = -1;

441 
	}
}

443 
	$¢d_£q_hw_quîy_√xt_p‹t
(
¢d_£q_t
 *
£q
, 
¢d_£q_p‹t_öfo_t
 *
öfo
)

445 
¢d_£q_hw_t
 *
hw
 = 
£q
->
¥iv©e_d©a
;

446 i‡(
	`io˘l
(
hw
->
fd
, 
SNDRV_SEQ_IOCTL_QUERY_NEXT_PORT
, 
öfo
) < 0) {

448  -
î∫o
;

451 
	}
}

453 c⁄° 
¢d_£q_›s_t
 
	g¢d_£q_hw_›s
 = {

454 .
˛o£
 = 
¢d_£q_hw_˛o£
,

455 .
	gn⁄block
 = 
¢d_£q_hw_n⁄block
,

456 .
	gsy°em_öfo
 = 
¢d_£q_hw_sy°em_öfo
,

457 .
	ggë_˛õ¡_öfo
 = 
¢d_£q_hw_gë_˛õ¡_öfo
,

458 .
	g£t_˛õ¡_öfo
 = 
¢d_£q_hw_£t_˛õ¡_öfo
,

459 .
	ggë_ump_öfo
 = 
¢d_£q_hw_gë_ump_öfo
,

460 .
	g£t_ump_öfo
 = 
¢d_£q_hw_£t_ump_öfo
,

461 .
	g¸óã_p‹t
 = 
¢d_£q_hw_¸óã_p‹t
,

462 .
	gdñëe_p‹t
 = 
¢d_£q_hw_dñëe_p‹t
,

463 .
	ggë_p‹t_öfo
 = 
¢d_£q_hw_gë_p‹t_öfo
,

464 .
	g£t_p‹t_öfo
 = 
¢d_£q_hw_£t_p‹t_öfo
,

465 .
	ggë_p‹t_subs¸ùti⁄
 = 
¢d_£q_hw_gë_p‹t_subs¸ùti⁄
,

466 .
	gsubs¸ibe_p‹t
 = 
¢d_£q_hw_subs¸ibe_p‹t
,

467 .
	gunsubs¸ibe_p‹t
 = 
¢d_£q_hw_unsubs¸ibe_p‹t
,

468 .
	gquîy_p‹t_subs¸ibîs
 = 
¢d_£q_hw_quîy_p‹t_subs¸ibîs
,

469 .
	ggë_queue_°©us
 = 
¢d_£q_hw_gë_queue_°©us
,

470 .
	ggë_queue_ãmpo
 = 
¢d_£q_hw_gë_queue_ãmpo
,

471 .
	g£t_queue_ãmpo
 = 
¢d_£q_hw_£t_queue_ãmpo
,

472 .
	ggë_queue_timî
 = 
¢d_£q_hw_gë_queue_timî
,

473 .
	g£t_queue_timî
 = 
¢d_£q_hw_£t_queue_timî
,

474 .
	ggë_queue_˛õ¡
 = 
¢d_£q_hw_gë_queue_˛õ¡
,

475 .
	g£t_queue_˛õ¡
 = 
¢d_£q_hw_£t_queue_˛õ¡
,

476 .
	g¸óã_queue
 = 
¢d_£q_hw_¸óã_queue
,

477 .
	gdñëe_queue
 = 
¢d_£q_hw_dñëe_queue
,

478 .
	ggë_queue_öfo
 = 
¢d_£q_hw_gë_queue_öfo
,

479 .
	g£t_queue_öfo
 = 
¢d_£q_hw_£t_queue_öfo
,

480 .
	ggë_«med_queue
 = 
¢d_£q_hw_gë_«med_queue
,

481 .
	gwrôe
 = 
¢d_£q_hw_wrôe
,

482 .
	gªad
 = 
¢d_£q_hw_ªad
,

483 .
	gªmove_evíts
 = 
¢d_£q_hw_ªmove_evíts
,

484 .
	ggë_˛õ¡_poﬁ
 = 
¢d_£q_hw_gë_˛õ¡_poﬁ
,

485 .
	g£t_˛õ¡_poﬁ
 = 
¢d_£q_hw_£t_˛õ¡_poﬁ
,

486 .
	gquîy_√xt_˛õ¡
 = 
¢d_£q_hw_quîy_√xt_˛õ¡
,

487 .
	gquîy_√xt_p‹t
 = 
¢d_£q_hw_quîy_√xt_p‹t
,

490 
	$¢d_£q_hw_›í
(
¢d_£q_t
 **
h™dÀ
, c⁄° *
«me
, 
°ªams
, 
mode
)

492 
fd
, 
vî
, 
˛õ¡
, 
fmode
, 
ªt
;

493 c⁄° *
fûíame
;

494 
¢d_£q_t
 *
£q
;

495 
¢d_£q_hw_t
 *
hw
;

497 *
h™dÀ
 = 
NULL
;

499 
°ªams
) {

500 
SND_SEQ_OPEN_OUTPUT
:

501 
fmode
 = 
O_WRONLY
;

503 
SND_SEQ_OPEN_INPUT
:

504 
fmode
 = 
O_RDONLY
;

506 
SND_SEQ_OPEN_DUPLEX
:

507 
fmode
 = 
O_RDWR
;

510 
	`as£π
(0);

511  -
EINVAL
;

514 i‡(
mode
 & 
SND_SEQ_NONBLOCK
)

515 
fmode
 |
O_NONBLOCK
;

517 
fûíame
 = 
SNDRV_FILE_SEQ
;

518 
fd
 = 
	`¢d_›í_devi˚
(
fûíame
, 
fmode
);

519 #ifde‡
SUPPORT_ALOAD


520 i‡(
fd
 < 0) {

521 
fd
 = 
	`¢d_›í_devi˚
(
SNDRV_FILE_ALOADSEQ
, 
fmode
);

522 i‡(
fd
 >= 0)

523 
	`˛o£
(
fd
);

524 
fd
 = 
	`¢d_›í_devi˚
(
fûíame
, 
fmode
);

527 i‡(
fd
 < 0) {

528 
	`SYSERR
("›í %†Áûed", 
fûíame
);

529  -
î∫o
;

531 i‡(
	`io˘l
(
fd
, 
SNDRV_SEQ_IOCTL_PVERSION
, &
vî
) < 0) {

532 
	`SYSERR
("SNDRV_SEQ_IOCTL_PVERSION failed");

533 
ªt
 = -
î∫o
;

534 
	`˛o£
(
fd
);

535  
ªt
;

537 i‡(
	`SNDRV_PROTOCOL_INCOMPATIBLE
(
vî
, 
SNDRV_SEQ_VERSION
)) {

538 
	`˛o£
(
fd
);

539  -
SND_ERROR_INCOMPATIBLE_VERSION
;

541 i‡(
	`SNDRV_PROTOCOL_VERSION
(1, 0, 3Ë<
vî
) {

543 
u£r_vî
 = 
SNDRV_SEQ_VERSION
;

544 
	`io˘l
(
fd
, 
SNDRV_SEQ_IOCTL_USER_PVERSION
, &
u£r_vî
);

546 
hw
 = 
	`ˇŒoc
(1, (
¢d_£q_hw_t
));

547 i‡(
hw
 =
NULL
) {

548 
	`˛o£
(
fd
);

549  -
ENOMEM
;

552 
£q
 = 
	`ˇŒoc
(1, (
¢d_£q_t
));

553 i‡(
£q
 =
NULL
) {

554 
	`‰ì
(
hw
);

555 
	`˛o£
(
fd
);

556  -
ENOMEM
;

558 
hw
->
fd
 = fd;

559 
hw
->
vîsi⁄
 = 
vî
;

560 i‡(
°ªams
 & 
SND_SEQ_OPEN_OUTPUT
) {

561 
£q
->
obuf
 = (*Ë
	`mÆloc
(£q->
obufsize
 = 
SND_SEQ_OBUF_SIZE
);

562 i‡(!
£q
->
obuf
) {

563 
	`‰ì
(
hw
);

564 
	`‰ì
(
£q
);

565 
	`˛o£
(
fd
);

566  -
ENOMEM
;

569 i‡(
°ªams
 & 
SND_SEQ_OPEN_INPUT
) {

570 
£q
->
ibuf
 = (*Ë
	`ˇŒoc
((
¢d_£q_ump_evít_t
), seq->
ibufsize
 = 
SND_SEQ_IBUF_SIZE
);

571 i‡(!
£q
->
ibuf
) {

572 
	`‰ì
(
£q
->
obuf
);

573 
	`‰ì
(
hw
);

574 
	`‰ì
(
£q
);

575 
	`˛o£
(
fd
);

576  -
ENOMEM
;

579 i‡(
«me
)

580 
£q
->
«me
 = 
	`°rdup
(name);

581 
£q
->
ty≥
 = 
SND_SEQ_TYPE_HW
;

582 
£q
->
°ªams
 = streams;

583 
£q
->
mode
 = mode;

584 
£q
->
tmpbuf
 = 
NULL
;

585 
£q
->
tmpbufsize
 = 0;

586 
£q
->
pﬁl_fd
 = 
fd
;

587 
£q
->
›s
 = &
¢d_£q_hw_›s
;

588 
£q
->
¥iv©e_d©a
 = 
hw
;

589 
£q
->
∑ckë_size
 = (
¢d_£q_evít_t
);

590 
˛õ¡
 = 
	`¢d_£q_hw_˛õ¡_id
(
£q
);

591 i‡(
˛õ¡
 < 0) {

592 
	`¢d_£q_˛o£
(
£q
);

593  
˛õ¡
;

595 
£q
->
˛õ¡
 = client;

597 #ifde‡
SNDRV_SEQ_IOCTL_RUNNING_MODE


599 
¢d_£q_ru¬ög_öfo
 
run_mode
;

601 
	`mem£t
(&
run_mode
, 0, (run_mode));

602 
run_mode
.
˛õ¡
 = client;

603 #ifde‡
SNDRV_BIG_ENDIAN


604 
run_mode
.
big_ídün
 = 1;

606 
run_mode
.
big_ídün
 = 0;

608 
run_mode
.
˝u_mode
 = ();

609 
	`io˘l
(
fd
, 
SNDRV_SEQ_IOCTL_RUNNING_MODE
, &
run_mode
);

613 *
h™dÀ
 = 
£q
;

615 
	}
}

617 
	$_¢d_£q_hw_›í
(
¢d_£q_t
 **
h™dÀp
, *
«me
,

618 
¢d_c⁄fig_t
 *
roŸ
 
ATTRIBUTE_UNUSED
, snd_c⁄fig_à*
c⁄f
,

619 
°ªams
, 
mode
)

621 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

622 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

623 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

624 c⁄° *
id
;

625 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

627 i‡(
	`_¢d_c⁄f_gíîic_id
(
id
))

629  -
EINVAL
;

631  
	`¢d_£q_hw_›í
(
h™dÀp
, 
«me
, 
°ªams
, 
mode
);

632 
	}
}

633 
SND_DLSYM_BUILD_VERSION
(
_¢d_£q_hw_›í
, 
SND_SEQ_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_local.h

23 #i‚de‡
__SEQ_LOCAL_H


24 
	#__SEQ_LOCAL_H


	)

26 
	~"loˇl.h
"

27 
	~<°dio.h
>

28 
	~<°dlib.h
>

29 
	~<limôs.h
>

31 
	#SND_SEQ_OBUF_SIZE
 (16*1024Ë

	)

32 
	#SND_SEQ_IBUF_SIZE
 500

	)

33 
	#DEFAULT_TMPBUF_SIZE
 20

	)

35 
¢d_£q_queue_˛õ¡
 
	t¢d_£q_queue_˛õ¡_t
;

39 (*
	m˛o£
)(
¢d_£q_t
 *
	m£q
);

40 (*
	mn⁄block
)(
¢d_£q_t
 *
	m£q
, nonblock);

41 (*
	msy°em_öfo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_sy°em_öfo_t
 * 
	möfo
);

42 (*
	mgë_˛õ¡_öfo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_˛õ¡_öfo_t
 * 
	möfo
);

43 (*
	m£t_˛õ¡_öfo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_˛õ¡_öfo_t
 * 
	möfo
);

44 (*
	mgë_ump_öfo
)(
¢d_£q_t
 *
	m£q
, 
	m˛õ¡
, 
	mty≥
, *
	möfo
);

45 (*
	m£t_ump_öfo
)(
¢d_£q_t
 *
	m£q
, 
	mty≥
, c⁄° *
	möfo
);

46 (*
	m¸óã_p‹t
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_p‹t_öfo_t
 * 
	mp‹t
);

47 (*
	mdñëe_p‹t
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_p‹t_öfo_t
 * 
	mp‹t
);

48 (*
	mgë_p‹t_öfo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_p‹t_öfo_t
 * 
	möfo
);

49 (*
	m£t_p‹t_öfo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_p‹t_öfo_t
 * 
	möfo
);

50 (*
	mgë_p‹t_subs¸ùti⁄
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_p‹t_subs¸ibe_t
 * 
	msub
);

51 (*
	msubs¸ibe_p‹t
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_p‹t_subs¸ibe_t
 * 
	msub
);

52 (*
	munsubs¸ibe_p‹t
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_p‹t_subs¸ibe_t
 * 
	msub
);

53 (*
	mquîy_p‹t_subs¸ibîs
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_quîy_subs¸ibe_t
 * 
	msubs
);

54 (*
	mgë_queue_°©us
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_°©us_t
 * 
	m°©us
);

55 (*
	mgë_queue_ãmpo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_ãmpo_t
 * 
	mãmpo
);

56 (*
	m£t_queue_ãmpo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_ãmpo_t
 * 
	mãmpo
);

57 (*
	mgë_queue_timî
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_timî_t
 * 
	mtimî
);

58 (*
	m£t_queue_timî
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_timî_t
 * 
	mtimî
);

59 (*
	mgë_queue_˛õ¡
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_˛õ¡_t
 * 
	m˛õ¡
);

60 (*
	m£t_queue_˛õ¡
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_˛õ¡_t
 * 
	m˛õ¡
);

61 (*
	m¸óã_queue
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_öfo_t
 *
	möfo
);

62 (*
	mdñëe_queue
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_öfo_t
 *
	möfo
);

63 (*
	mgë_queue_öfo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_öfo_t
 *
	möfo
);

64 (*
	m£t_queue_öfo
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_öfo_t
 *
	möfo
);

65 (*
	mgë_«med_queue
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_queue_öfo_t
 *
	möfo
);

66 
ssize_t
 (*
wrôe
)(
¢d_£q_t
 *
	m£q
, *
	mbuf
, 
size_t
 
	mÀn
);

67 
ssize_t
 (*
ªad
)(
¢d_£q_t
 *
	m£q
, *
	mbuf
, 
size_t
 
	mÀn
);

68 (*
	mªmove_evíts
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_ªmove_evíts_t
 *
	mrmp
);

69 (*
	mgë_˛õ¡_poﬁ
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_˛õ¡_poﬁ_t
 *
	möfo
);

70 (*
	m£t_˛õ¡_poﬁ
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_˛õ¡_poﬁ_t
 *
	möfo
);

71 (*
	mquîy_√xt_˛õ¡
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_˛õ¡_öfo_t
 *
	möfo
);

72 (*
	mquîy_√xt_p‹t
)(
¢d_£q_t
 *
	m£q
, 
¢d_£q_p‹t_öfo_t
 *
	möfo
);

73 } 
	t¢d_£q_›s_t
;

75 
	s_¢d_£q
 {

76 *
	m«me
;

77 
¢d_£q_ty≥_t
 
	mty≥
;

78 
	m°ªams
;

79 
	mmode
;

80 
	mpﬁl_fd
;

81 *
	mdl_h™dÀ
;

82 c⁄° 
¢d_£q_›s_t
 *
	m›s
;

83 *
	m¥iv©e_d©a
;

84 
	m˛õ¡
;

86 *
	mobuf
;

87 
size_t
 
	mobufsize
;

88 
size_t
 
	mobufu£d
;

89 *
	mibuf
;

90 
size_t
 
	mibuÂå
;

91 
size_t
 
	mibuÊí
;

92 
size_t
 
	mibufsize
;

93 
¢d_£q_evít_t
 *
	mtmpbuf
;

94 
size_t
 
	mtmpbufsize
;

95 
size_t
 
	m∑ckë_size
;

96 
	mmidi_vîsi⁄
;

99 
¢d_£q_hw_›í
(
¢d_£q_t
 **
h™dÀ
, c⁄° *
«me
, 
°ªams
, 
mode
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_midi_event.c

31 
	~"loˇl.h
"

32 #i‡
HAVE_MALLOC_H


33 
	~<mÆloc.h
>

36 #i‚de‡
DOC_HIDDEN


39 
	s¢d_midi_evít
 {

40 
ssize_t
 
	mqÀn
;

41 
size_t
 
	mªad
;

42 
	mty≥
;

43 
	mœ°cmd
;

44 
	mno°©
;

45 
size_t
 
	mbufsize
;

46 *
	mbuf
;

52 
	#ST_INVALID
 7

	)

53 
	#ST_SPECIAL
 8

	)

54 
	#ST_SYSEX
 
ST_SPECIAL


	)

59 (*
	tevít_ícode_t
)(
	t¢d_midi_evít_t
 *
	tdev
, 
	t¢d_£q_evít_t
 *
	tev
);

60 (*
	tevít_decode_t
)(c⁄° 
	t¢d_£q_evít_t
 *
	tev
, *
	tbuf
);

67 
	`nŸe_evít
(
¢d_midi_evít_t
 *
dev
, 
¢d_£q_evít_t
 *
ev
);

68 
	`⁄e_∑øm_˘æ_evít
(
¢d_midi_evít_t
 *
dev
, 
¢d_£q_evít_t
 *
ev
);

69 
	`pôchbíd_˘æ_evít
(
¢d_midi_evít_t
 *
dev
, 
¢d_£q_evít_t
 *
ev
);

70 
	`two_∑øm_˘æ_evít
(
¢d_midi_evít_t
 *
dev
, 
¢d_£q_evít_t
 *
ev
);

71 
	`⁄e_∑øm_evít
(
¢d_midi_evít_t
 *
dev
, 
¢d_£q_evít_t
 *
ev
);

72 
	`s⁄gpos_evít
(
¢d_midi_evít_t
 *
dev
, 
¢d_£q_evít_t
 *
ev
);

73 
	`nŸe_decode
(c⁄° 
¢d_£q_evít_t
 *
ev
, *
buf
);

74 
	`⁄e_∑øm_decode
(c⁄° 
¢d_£q_evít_t
 *
ev
, *
buf
);

75 
	`pôchbíd_decode
(c⁄° 
¢d_£q_evít_t
 *
ev
, *
buf
);

76 
	`two_∑øm_decode
(c⁄° 
¢d_£q_evít_t
 *
ev
, *
buf
);

77 
	`s⁄gpos_decode
(c⁄° 
¢d_£q_evít_t
 *
ev
, *
buf
);

82 #i‚de‡
DOC_HIDDEN


83 c⁄° 
	s°©us_evít_li°_t
 {

84 
evít
;

85 
qÀn
;

86 
evít_ícode_t
 
ícode
;

87 
evít_decode_t
 
decode
;

88 } 
°©us_evít
[] = {

90 {
SND_SEQ_EVENT_NOTEOFF
, 2, 
nŸe_evít
, 
nŸe_decode
},

91 {
SND_SEQ_EVENT_NOTEON
, 2, 
nŸe_evít
, 
nŸe_decode
},

92 {
SND_SEQ_EVENT_KEYPRESS
, 2, 
nŸe_evít
, 
nŸe_decode
},

93 {
SND_SEQ_EVENT_CONTROLLER
, 2, 
two_∑øm_˘æ_evít
, 
two_∑øm_decode
},

94 {
SND_SEQ_EVENT_PGMCHANGE
, 1, 
⁄e_∑øm_˘æ_evít
, 
⁄e_∑øm_decode
},

95 {
SND_SEQ_EVENT_CHANPRESS
, 1, 
⁄e_∑øm_˘æ_evít
, 
⁄e_∑øm_decode
},

96 {
SND_SEQ_EVENT_PITCHBEND
, 2, 
pôchbíd_˘æ_evít
, 
pôchbíd_decode
},

98 {
SND_SEQ_EVENT_NONE
, -1, 
NULL
, NULL},

100 {
SND_SEQ_EVENT_SYSEX
, 1, 
NULL
, NULL},

101 {
SND_SEQ_EVENT_QFRAME
, 1, 
⁄e_∑øm_evít
, 
⁄e_∑øm_decode
},

102 {
SND_SEQ_EVENT_SONGPOS
, 2, 
s⁄gpos_evít
, 
s⁄gpos_decode
},

103 {
SND_SEQ_EVENT_SONGSEL
, 1, 
⁄e_∑øm_evít
, 
⁄e_∑øm_decode
},

104 {
SND_SEQ_EVENT_NONE
, -1, 
NULL
, NULL},

105 {
SND_SEQ_EVENT_NONE
, -1, 
NULL
, NULL},

106 {
SND_SEQ_EVENT_TUNE_REQUEST
, 0, 
NULL
, NULL},

107 {
SND_SEQ_EVENT_NONE
, -1, 
NULL
, NULL},

108 {
SND_SEQ_EVENT_CLOCK
, 0, 
NULL
, NULL},

109 {
SND_SEQ_EVENT_NONE
, -1, 
NULL
, NULL},

110 {
SND_SEQ_EVENT_START
, 0, 
NULL
, NULL},

111 {
SND_SEQ_EVENT_CONTINUE
, 0, 
NULL
, NULL},

112 {
SND_SEQ_EVENT_STOP
, 0, 
NULL
, NULL},

113 {
SND_SEQ_EVENT_NONE
, -1, 
NULL
, NULL},

114 {
SND_SEQ_EVENT_SENSING
, 0, 
NULL
, NULL},

115 {
SND_SEQ_EVENT_RESET
, 0, 
NULL
, NULL},

116 
	}
};

118 
exåa_decode_˘æ14
(
¢d_midi_evít_t
 *
dev
, *
buf
, 
Àn
, c⁄° 
¢d_£q_evít_t
 *
ev
);

119 
exåa_decode_xΩn
(
¢d_midi_evít_t
 *
dev
, *
buf
, 
cou¡
, c⁄° 
¢d_£q_evít_t
 *
ev
);

121 c⁄° 
	sexåa_evít_li°_t
 {

122 
	mevít
;

123 (*
	mdecode
)(
¢d_midi_evít_t
 *
	mdev
, *
	mbuf
, 
	mÀn
, c⁄° 
¢d_£q_evít_t
 *
	mev
);

124 } 
	gexåa_evít
[] = {

125 {
SND_SEQ_EVENT_CONTROL14
, 
exåa_decode_˘æ14
},

126 {
SND_SEQ_EVENT_NONREGPARAM
, 
exåa_decode_xΩn
},

127 {
SND_SEQ_EVENT_REGPARAM
, 
exåa_decode_xΩn
},

130 
	#numbîof
(
¨y
Ë(◊ry)/◊ry[0]))

	)

152 
	$¢d_midi_evít_√w
(
size_t
 
bufsize
, 
¢d_midi_evít_t
 **
rdev
)

154 
¢d_midi_evít_t
 *
dev
;

156 *
rdev
 = 
NULL
;

157 
dev
 = (
¢d_midi_evít_t
 *)
	`ˇŒoc
(1, (snd_midi_event_t));

158 i‡(
dev
 =
NULL
)

159  -
ENOMEM
;

160 i‡(
bufsize
 > 0) {

161 
dev
->
buf
 = 
	`mÆloc
(
bufsize
);

162 i‡(
dev
->
buf
 =
NULL
) {

163 
	`‰ì
(
dev
);

164  -
ENOMEM
;

167 
dev
->
bufsize
 = bufsize;

168 
dev
->
œ°cmd
 = 0xff;

169 
dev
->
ty≥
 = 
ST_INVALID
;

170 *
rdev
 = 
dev
;

172 
	}
}

183 
	$¢d_midi_evít_‰ì
(
¢d_midi_evít_t
 *
dev
)

185 i‡(
dev
 !
NULL
) {

186 
	`‰ì
(
dev
->
buf
);

187 
	`‰ì
(
dev
);

189 
	}
}

202 
	$¢d_midi_evít_no_°©us
(
¢d_midi_evít_t
 *
dev
, 
⁄
)

204 
dev
->
no°©
 = 
⁄
 ? 1 : 0;

205 
	}
}

210 
ölöe
 
	$ª£t_ícode
(
¢d_midi_evít_t
 *
dev
)

212 
dev
->
ªad
 = 0;

213 
dev
->
qÀn
 = 0;

214 
dev
->
ty≥
 = 
ST_INVALID
;

215 
	}
}

228 
	$¢d_midi_evít_ª£t_ícode
(
¢d_midi_evít_t
 *
dev
)

230 
	`ª£t_ícode
(
dev
);

231 
	}
}

244 
	$¢d_midi_evít_ª£t_decode
(
¢d_midi_evít_t
 *
dev
)

246 
dev
->
œ°cmd
 = 0xff;

247 
	}
}

259 
	$¢d_midi_evít_öô
(
¢d_midi_evít_t
 *
dev
)

261 
	`¢d_midi_evít_ª£t_ícode
(
dev
);

262 
	`¢d_midi_evít_ª£t_decode
(
dev
);

263 
	}
}

282 
	$¢d_midi_evít_ªsize_buf„r
(
¢d_midi_evít_t
 *
dev
, 
size_t
 
bufsize
)

284 *
√w_buf
, *
ﬁd_buf
;

286 i‡(
bufsize
 =
dev
->bufsize)

288 
√w_buf
 = 
	`mÆloc
(
bufsize
);

289 i‡(
√w_buf
 =
NULL
)

290  -
ENOMEM
;

291 
ﬁd_buf
 = 
dev
->
buf
;

292 
dev
->
buf
 = 
√w_buf
;

293 
dev
->
bufsize
 = bufsize;

294 
	`ª£t_ícode
(
dev
);

295 
	`‰ì
(
ﬁd_buf
);

297 
	}
}

362 
	$¢d_midi_evít_ícode
(
¢d_midi_evít_t
 *
dev
, c⁄° *
buf
, 
cou¡
, 
¢d_£q_evít_t
 *
ev
)

364 
ªsu…
 = 0;

365 
rc
;

367 
ev
->
ty≥
 = 
SND_SEQ_EVENT_NONE
;

369 
cou¡
-- > 0) {

370 
rc
 = 
	`¢d_midi_evít_ícode_byã
(
dev
, *
buf
++, 
ev
);

371 
ªsu…
++;

372 i‡(
rc
 < 0)

373  
rc
;

374 i‡(
rc
 > 0)

375  
ªsu…
;

378  
ªsu…
;

379 
	}
}

400 
	$¢d_midi_evít_ícode_byã
(
¢d_midi_evít_t
 *
dev
, 
c
, 
¢d_£q_evít_t
 *
ev
)

402 
rc
 = 0;

404 
c
 &= 0xff;

406 i‡(
c
 >
MIDI_CMD_COMMON_CLOCK
) {

408 
ev
->
ty≥
 = 
°©us_evít
[
ST_SPECIAL
 + 
c
 - 0xf0].
evít
;

409 
ev
->
Êags
 &~
SND_SEQ_EVENT_LENGTH_MASK
;

410 
ev
->
Êags
 |
SND_SEQ_EVENT_LENGTH_FIXED
;

411  
ev
->
ty≥
 !
SND_SEQ_EVENT_NONE
;

414 i‡((
c
 & 0x80) &&

415 (
c
 !
MIDI_CMD_COMMON_SYSEX_END
 || 
dev
->
ty≥
 !
ST_SYSEX
)) {

417 
dev
->
buf
[0] = 
c
;

418 i‡((
c
 & 0xf0) == 0xf0)

419 
dev
->
ty≥
 = (
c
 & 0x0fË+ 
ST_SPECIAL
;

421 
dev
->
ty≥
 = (
c
 >> 4) & 0x07;

422 
dev
->
ªad
 = 1;

423 
dev
->
qÀn
 = 
°©us_evít
[dev->
ty≥
].qlen;

425 i‡(
dev
->
qÀn
 > 0) {

427 
dev
->
buf
[dev->
ªad
++] = 
c
;

428 i‡(
dev
->
ty≥
 !
ST_SYSEX
)

429 
dev
->
qÀn
--;

432 
dev
->
buf
[1] = 
c
;

433 
dev
->
qÀn
 = 
°©us_evít
[dev->
ty≥
].qlen - 1;

434 
dev
->
ªad
 = 2;

437 i‡(
dev
->
qÀn
 == 0) {

438 
ev
->
ty≥
 = 
°©us_evít
[
dev
->ty≥].
evít
;

439 
ev
->
Êags
 &~
SND_SEQ_EVENT_LENGTH_MASK
;

440 
ev
->
Êags
 |
SND_SEQ_EVENT_LENGTH_FIXED
;

441 i‡(
°©us_evít
[
dev
->
ty≥
].
ícode
)

442 
°©us_evít
[
dev
->
ty≥
].
	`ícode
(dev, 
ev
);

443 i‡(
dev
->
ty≥
 >
ST_SPECIAL
)

444 
dev
->
ty≥
 = 
ST_INVALID
;

445 
rc
 = 1;

446 } i‡(
dev
->
ty≥
 =
ST_SYSEX
) {

447 i‡(
c
 =
MIDI_CMD_COMMON_SYSEX_END
 ||

448 
dev
->
ªad
 >dev->
bufsize
) {

449 
ev
->
Êags
 &~
SND_SEQ_EVENT_LENGTH_MASK
;

450 
ev
->
Êags
 |
SND_SEQ_EVENT_LENGTH_VARIABLE
;

451 
ev
->
ty≥
 = 
SND_SEQ_EVENT_SYSEX
;

452 
ev
->
d©a
.
ext
.
Àn
 = 
dev
->
ªad
;

453 
ev
->
d©a
.
ext
.
±r
 = 
dev
->
buf
;

454 i‡(
c
 !
MIDI_CMD_COMMON_SYSEX_END
)

455 
dev
->
ªad
 = 0;

457 
	`ª£t_ícode
(
dev
);

458 
rc
 = 1;

462  
rc
;

463 
	}
}

466 
	$nŸe_evít
(
¢d_midi_evít_t
 *
dev
, 
¢d_£q_evít_t
 *
ev
)

468 
ev
->
d©a
.
nŸe
.
ch™√l
 = 
dev
->
buf
[0] & 0x0f;

469 
ev
->
d©a
.
nŸe
.nŸê
dev
->
buf
[1];

470 
ev
->
d©a
.
nŸe
.
vñocôy
 = 
dev
->
buf
[2];

471 
	}
}

474 
	$⁄e_∑øm_˘æ_evít
(
¢d_midi_evít_t
 *
dev
, 
¢d_£q_evít_t
 *
ev
)

476 
ev
->
d©a
.
c⁄åﬁ
.
ch™√l
 = 
dev
->
buf
[0] & 0x0f;

477 
ev
->
d©a
.
c⁄åﬁ
.
vÆue
 = 
dev
->
buf
[1];

478 
	}
}

481 
	$pôchbíd_˘æ_evít
(
¢d_midi_evít_t
 *
dev
, 
¢d_£q_evít_t
 *
ev
)

483 
ev
->
d©a
.
c⁄åﬁ
.
ch™√l
 = 
dev
->
buf
[0] & 0x0f;

484 
ev
->
d©a
.
c⁄åﬁ
.
vÆue
 = ()
dev
->
buf
[2] * 128 + ()dev->buf[1] - 8192;

485 
	}
}

488 
	$two_∑øm_˘æ_evít
(
¢d_midi_evít_t
 *
dev
, 
¢d_£q_evít_t
 *
ev
)

490 
ev
->
d©a
.
c⁄åﬁ
.
ch™√l
 = 
dev
->
buf
[0] & 0x0f;

491 
ev
->
d©a
.
c⁄åﬁ
.
∑øm
 = 
dev
->
buf
[1];

492 
ev
->
d©a
.
c⁄åﬁ
.
vÆue
 = 
dev
->
buf
[2];

493 
	}
}

496 
	$⁄e_∑øm_evít
(
¢d_midi_evít_t
 *
dev
, 
¢d_£q_evít_t
 *
ev
)

498 
ev
->
d©a
.
c⁄åﬁ
.
vÆue
 = 
dev
->
buf
[1];

499 
	}
}

502 
	$s⁄gpos_evít
(
¢d_midi_evít_t
 *
dev
, 
¢d_£q_evít_t
 *
ev
)

504 
ev
->
d©a
.
c⁄åﬁ
.
vÆue
 = ()
dev
->
buf
[2] * 128 + ()dev->buf[1];

505 
	}
}

559 
	$¢d_midi_evít_decode
(
¢d_midi_evít_t
 *
dev
, *
buf
, 
cou¡
, c⁄° 
¢d_£q_evít_t
 *
ev
)

561 
cmd
;

562 
qÀn
;

563 
ty≥
;

565 i‡(
ev
->
ty≥
 =
SND_SEQ_EVENT_NONE
)

566  -
ENOENT
;

568 
ty≥
 = 0;Åy≥ < 
	`numbîof
(
°©us_evít
);Åype++) {

569 i‡(
ev
->
ty≥
 =
°©us_evít
[ty≥].
evít
)

570 
__found
;

572 
ty≥
 = 0;Åy≥ < 
	`numbîof
(
exåa_evít
);Åype++) {

573 i‡(
ev
->
ty≥
 =
exåa_evít
[ty≥].
evít
)

574  
exåa_evít
[
ty≥
].
	`decode
(
dev
, 
buf
, 
cou¡
, 
ev
);

576  -
ENOENT
;

578 
__found
:

579 i‡(
ty≥
 >
ST_SPECIAL
)

580 
cmd
 = 0xf0 + (
ty≥
 - 
ST_SPECIAL
);

583 
cmd
 = 0x80 | (
ty≥
 << 4Ë| (
ev
->
d©a
.
nŸe
.
ch™√l
 & 0x0f);

586 i‡(
cmd
 =
MIDI_CMD_COMMON_SYSEX
) {

587 
	`¢d_midi_evít_ª£t_decode
(
dev
);

588 
qÀn
 = 
ev
->
d©a
.
ext
.
Àn
;

589 i‡(
cou¡
 < 
qÀn
)

590  -
ENOMEM
;

591 
ev
->
Êags
 & 
SND_SEQ_EVENT_LENGTH_MASK
) {

592 
SND_SEQ_EVENT_LENGTH_FIXED
:

593  -
EINVAL
;

595 
	`mem˝y
(
buf
, 
ev
->
d©a
.
ext
.
±r
, 
qÀn
);

596  
qÀn
;

598 
xbuf
[4];

600 i‡((
cmd
 & 0xf0Ë=0xf0 || 
dev
->
œ°cmd
 !cmd || dev->
no°©
) {

601 
dev
->
œ°cmd
 = 
cmd
;

602 
xbuf
[0] = 
cmd
;

603 i‡(
°©us_evít
[
ty≥
].
decode
)

604 
°©us_evít
[
ty≥
].
	`decode
(
ev
, 
xbuf
 + 1);

605 
qÀn
 = 
°©us_evít
[
ty≥
].qlen + 1;

607 i‡(
°©us_evít
[
ty≥
].
decode
)

608 
°©us_evít
[
ty≥
].
	`decode
(
ev
, 
xbuf
 + 0);

609 
qÀn
 = 
°©us_evít
[
ty≥
].qlen;

611 i‡(
qÀn
 <= 0)

613 i‡(
cou¡
 < 
qÀn
)

614  -
ENOMEM
;

615 
	`mem˝y
(
buf
, 
xbuf
, 
qÀn
);

616  
qÀn
;

618 
	}
}

622 
	$nŸe_decode
(c⁄° 
¢d_£q_evít_t
 *
ev
, *
buf
)

624 
buf
[0] = 
ev
->
d©a
.
nŸe
.note & 0x7f;

625 
buf
[1] = 
ev
->
d©a
.
nŸe
.
vñocôy
 & 0x7f;

626 
	}
}

629 
	$⁄e_∑øm_decode
(c⁄° 
¢d_£q_evít_t
 *
ev
, *
buf
)

631 
buf
[0] = 
ev
->
d©a
.
c⁄åﬁ
.
vÆue
 & 0x7f;

632 
	}
}

635 
	$pôchbíd_decode
(c⁄° 
¢d_£q_evít_t
 *
ev
, *
buf
)

637 
vÆue
 = 
ev
->
d©a
.
c⁄åﬁ
.value + 8192;

638 
buf
[0] = 
vÆue
 & 0x7f;

639 
buf
[1] = (
vÆue
 >> 7) & 0x7f;

640 
	}
}

643 
	$two_∑øm_decode
(c⁄° 
¢d_£q_evít_t
 *
ev
, *
buf
)

645 
buf
[0] = 
ev
->
d©a
.
c⁄åﬁ
.
∑øm
 & 0x7f;

646 
buf
[1] = 
ev
->
d©a
.
c⁄åﬁ
.
vÆue
 & 0x7f;

647 
	}
}

650 
	$s⁄gpos_decode
(c⁄° 
¢d_£q_evít_t
 *
ev
, *
buf
)

652 
buf
[0] = 
ev
->
d©a
.
c⁄åﬁ
.
vÆue
 & 0x7f;

653 
buf
[1] = (
ev
->
d©a
.
c⁄åﬁ
.
vÆue
 >> 7) & 0x7f;

654 
	}
}

657 
	$exåa_decode_˘æ14
(
¢d_midi_evít_t
 *
dev
, *
buf
, 
cou¡
, c⁄° 
¢d_£q_evít_t
 *
ev
)

659 
cmd
;

660 
idx
 = 0;

662 
cmd
 = 
MIDI_CMD_CONTROL
|(
ev
->
d©a
.
c⁄åﬁ
.
ch™√l
 & 0x0f);

663 i‡(
ev
->
d©a
.
c⁄åﬁ
.
∑øm
 < 32) {

664 i‡(
cou¡
 < 4)

665  -
ENOMEM
;

666 i‡(
dev
->
no°©
 && 
cou¡
 < 6)

667  -
ENOMEM
;

668 i‡(
cmd
 !
dev
->
œ°cmd
 || dev->
no°©
) {

669 i‡(
cou¡
 < 5)

670  -
ENOMEM
;

671 
buf
[
idx
++] = 
dev
->
œ°cmd
 = 
cmd
;

673 
buf
[
idx
++] = 
ev
->
d©a
.
c⁄åﬁ
.
∑øm
;

674 
buf
[
idx
++] = (
ev
->
d©a
.
c⁄åﬁ
.
vÆue
 >> 7) & 0x7f;

675 i‡(
dev
->
no°©
)

676 
buf
[
idx
++] = 
cmd
;

677 
buf
[
idx
++] = 
ev
->
d©a
.
c⁄åﬁ
.
∑øm
 + 32;

678 
buf
[
idx
++] = 
ev
->
d©a
.
c⁄åﬁ
.
vÆue
 & 0x7f;

680 i‡(
cou¡
 < 2)

681  -
ENOMEM
;

682 i‡(
cmd
 !
dev
->
œ°cmd
 || dev->
no°©
) {

683 i‡(
cou¡
 < 3)

684  -
ENOMEM
;

685 
buf
[
idx
++] = 
dev
->
œ°cmd
 = 
cmd
;

687 
buf
[
idx
++] = 
ev
->
d©a
.
c⁄åﬁ
.
∑øm
 & 0x7f;

688 
buf
[
idx
++] = 
ev
->
d©a
.
c⁄åﬁ
.
vÆue
 & 0x7f;

690  
idx
;

691 
	}
}

694 
	$exåa_decode_xΩn
(
¢d_midi_evít_t
 *
dev
, *
buf
, 
cou¡
, c⁄° 
¢d_£q_evít_t
 *
ev
)

696 
cmd
;

697 c⁄° *
cbyãs
;

698 c⁄° 
cbyãs_ƒ≤
[4] = { 
MIDI_CTL_NONREG_PARM_NUM_MSB
,

699 
MIDI_CTL_NONREG_PARM_NUM_LSB
,

700 
MIDI_CTL_MSB_DATA_ENTRY
,

701 
MIDI_CTL_LSB_DATA_ENTRY
 };

702 c⁄° 
cbyãs_Ωn
[4] = { 
MIDI_CTL_REGIST_PARM_NUM_MSB
,

703 
MIDI_CTL_REGIST_PARM_NUM_LSB
,

704 
MIDI_CTL_MSB_DATA_ENTRY
,

705 
MIDI_CTL_LSB_DATA_ENTRY
 };

706 
byãs
[4];

707 
idx
 = 0, 
i
;

709 i‡(
cou¡
 < 8)

710  -
ENOMEM
;

711 i‡(
dev
->
no°©
 && 
cou¡
 < 12)

712  -
ENOMEM
;

713 
cmd
 = 
MIDI_CMD_CONTROL
|(
ev
->
d©a
.
c⁄åﬁ
.
ch™√l
 & 0x0f);

714 
byãs
[0] = (
ev
->
d©a
.
c⁄åﬁ
.
∑øm
 & 0x3f80) >> 7;

715 
byãs
[1] = 
ev
->
d©a
.
c⁄åﬁ
.
∑øm
 & 0x007f;

716 
byãs
[2] = (
ev
->
d©a
.
c⁄åﬁ
.
vÆue
 & 0x3f80) >> 7;

717 
byãs
[3] = 
ev
->
d©a
.
c⁄åﬁ
.
vÆue
 & 0x007f;

718 i‡(
cmd
 !
dev
->
œ°cmd
 && !dev->
no°©
) {

719 i‡(
cou¡
 < 9)

720  -
ENOMEM
;

721 
buf
[
idx
++] = 
dev
->
œ°cmd
 = 
cmd
;

723 
cbyãs
 = 
ev
->
ty≥
 =
SND_SEQ_EVENT_NONREGPARAM
 ? 
cbyãs_ƒ≤
 : 
cbyãs_Ωn
;

724 
i
 = 0; i < 4; i++) {

725 i‡(
dev
->
no°©
)

726 
buf
[
idx
++] = 
dev
->
œ°cmd
 = 
cmd
;

727 
buf
[
idx
++] = 
cbyãs
[
i
];

728 
buf
[
idx
++] = 
byãs
[
i
];

730  
idx
;

731 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_old.c

5 #i‚de‡
DOXYGEN


7 
	~"loˇl.h
"

9 
size_t
 
	$¢d_ö°r_hódî_sizeof
()

12 
	}
}

14 
	$¢d_ö°r_hódî_mÆloc
(**
±r
 
ATTRIBUTE_UNUSED
,

15 
size_t
 
Àn
 
ATTRIBUTE_UNUSED
)

17  -
ENOMEM
;

18 
	}
}

20 
	$¢d_ö°r_hódî_‰ì
(*
obj
 
ATTRIBUTE_UNUSED
)

22 
	}
}

24 
	$¢d_ö°r_hódî_c›y
(*
d°
 
ATTRIBUTE_UNUSED
,

25 c⁄° *
§c
 
ATTRIBUTE_UNUSED
)

27 
	}
}

29 c⁄° *
	$¢d_ö°r_hódî_gë_id
(c⁄° *
öfo
 
ATTRIBUTE_UNUSED
)

31  
NULL
;

32 
	}
}

34 
	$¢d_ö°r_hódî_gë_˛u°î
(c⁄° *
öfo
 
ATTRIBUTE_UNUSED
)

37 
	}
}

39 
	$¢d_ö°r_hódî_gë_cmd
(c⁄° *
öfo
 
ATTRIBUTE_UNUSED
)

42 
	}
}

44 
size_t
 
	$¢d_ö°r_hódî_gë_Àn
(c⁄° *
öfo
 
ATTRIBUTE_UNUSED
)

47 
	}
}

49 c⁄° *
	$¢d_ö°r_hódî_gë_«me
(c⁄° *
öfo
 
ATTRIBUTE_UNUSED
)

51  
NULL
;

52 
	}
}

54 
	$¢d_ö°r_hódî_gë_ty≥
(c⁄° *
öfo
 
ATTRIBUTE_UNUSED
)

57 
	}
}

59 c⁄° *
	$¢d_ö°r_hódî_gë_f‹m©
(c⁄° *
öfo
 
ATTRIBUTE_UNUSED
)

61  
NULL
;

62 
	}
}

64 c⁄° *
	$¢d_ö°r_hódî_gë_Æüs
(c⁄° *
öfo
 
ATTRIBUTE_UNUSED
)

66  
NULL
;

67 
	}
}

69 *
	$¢d_ö°r_hódî_gë_d©a
(c⁄° *
öfo
 
ATTRIBUTE_UNUSED
)

71  
NULL
;

72 
	}
}

74 
	$¢d_ö°r_hódî_gë_fﬁlow_Æüs
(c⁄° *
öfo
 
ATTRIBUTE_UNUSED
)

77 
	}
}

79 
	$¢d_ö°r_hódî_£t_id
(*
öfo
 
ATTRIBUTE_UNUSED
,

80 c⁄° *
id
 
ATTRIBUTE_UNUSED
)

82 
	}
}

84 
	$¢d_ö°r_hódî_£t_˛u°î
(*
öfo
 
ATTRIBUTE_UNUSED
,

85 
˛u°î
 
ATTRIBUTE_UNUSED
)

87 
	}
}

89 
	$¢d_ö°r_hódî_£t_cmd
(*
öfo
 
ATTRIBUTE_UNUSED
,

90 
cmd
 
ATTRIBUTE_UNUSED
)

92 
	}
}

94 
	$¢d_ö°r_hódî_£t_Àn
(*
öfo
 
ATTRIBUTE_UNUSED
,

95 
size_t
 
Àn
 
ATTRIBUTE_UNUSED
)

97 
	}
}

99 
	$¢d_ö°r_hódî_£t_«me
(*
öfo
 
ATTRIBUTE_UNUSED
,

100 c⁄° *
«me
 
ATTRIBUTE_UNUSED
)

102 
	}
}

104 
	$¢d_ö°r_hódî_£t_ty≥
(*
öfo
 
ATTRIBUTE_UNUSED
,

105 
ty≥
 
ATTRIBUTE_UNUSED
)

107 
	}
}

109 
	$¢d_ö°r_hódî_£t_f‹m©
(*
öfo
 
ATTRIBUTE_UNUSED
,

110 c⁄° *
f‹m©
 
ATTRIBUTE_UNUSED
)

112 
	}
}

114 
	$¢d_ö°r_hódî_£t_Æüs
(*
öfo
 
ATTRIBUTE_UNUSED
,

115 c⁄° *
ö°r
 
ATTRIBUTE_UNUSED
)

117 
	}
}

119 
	$¢d_ö°r_hódî_£t_fﬁlow_Æüs
(*
öfo
 
ATTRIBUTE_UNUSED
,

120 
vÆ
 
ATTRIBUTE_UNUSED
)

122 
	}
}

124 
	$¢d_ö°r_fm_‰ì
(*
fm
 
ATTRIBUTE_UNUSED
)

127 
	}
}

129 
	$¢d_ö°r_fm_c⁄vît_to_°ªam
(*
fm
 
ATTRIBUTE_UNUSED
,

130 c⁄° *
«me
 
ATTRIBUTE_UNUSED
,

131 **
__d©a
 
ATTRIBUTE_UNUSED
,

132 
size_t
 *
__size
 
ATTRIBUTE_UNUSED
)

134  -
ENXIO
;

135 
	}
}

137 
	$¢d_ö°r_fm_c⁄vît_‰om_°ªam
(*
__d©a
 
ATTRIBUTE_UNUSED
,

138 
size_t
 
size
 
ATTRIBUTE_UNUSED
,

139 **
sim∂e
 
ATTRIBUTE_UNUSED
)

141  -
ENXIO
;

142 
	}
}

145 
	$¢d_ö°r_iwffff_›í
(**
h™dÀ
 
ATTRIBUTE_UNUSED
,

146 c⁄° *
«me_fff
 
ATTRIBUTE_UNUSED
,

147 c⁄° *
«me_d©
 
ATTRIBUTE_UNUSED
)

149  -
ENXIO
;

150 
	}
}

152 
	$¢d_ö°r_iwffff_›í_rom
(**
h™dÀ
 
ATTRIBUTE_UNUSED
,

153 
ˇrd
 
ATTRIBUTE_UNUSED
,

154 
b™k
 
ATTRIBUTE_UNUSED
,

155 
fûe
 
ATTRIBUTE_UNUSED
)

157  -
ENXIO
;

158 
	}
}

160 
	$¢d_ö°r_iwffff_›í_rom_fûe
(**
h™dÀ
 
ATTRIBUTE_UNUSED
,

161 c⁄° *
«me
 
ATTRIBUTE_UNUSED
,

162 
b™k
 
ATTRIBUTE_UNUSED
,

163 
fûe
 
ATTRIBUTE_UNUSED
)

165  -
ENXIO
;

166 
	}
}

168 
	$¢d_ö°r_iwffff_˛o£
(*
h™dÀ
 
ATTRIBUTE_UNUSED
)

171 
	}
}

173 
	$¢d_ö°r_iwffff_‰ì
(*
__ö°r
 
ATTRIBUTE_UNUSED
)

176 
	}
}

178 
	$¢d_ö°r_iwffff_lﬂd
(*
iwf
 
ATTRIBUTE_UNUSED
,

179 
b™k
 
ATTRIBUTE_UNUSED
,

180 
¥g
 
ATTRIBUTE_UNUSED
,

181 **
__iwffff
 
ATTRIBUTE_UNUSED
)

183  -
ENXIO
;

184 
	}
}

186 
	$¢d_ö°r_iwffff_c⁄vît_to_°ªam
(*
iwffff
 
ATTRIBUTE_UNUSED
,

187 c⁄° *
«me
 
ATTRIBUTE_UNUSED
,

188 **
__d©a
 
ATTRIBUTE_UNUSED
,

189 
size_t
 *
__size
 
ATTRIBUTE_UNUSED
)

191  -
ENXIO
;

192 
	}
}

194 
	$¢d_ö°r_iwffff_c⁄vît_‰om_°ªam
(*
d©a
 
ATTRIBUTE_UNUSED
,

195 
size_t
 
size
 
ATTRIBUTE_UNUSED
,

196 **
iwffff
 
ATTRIBUTE_UNUSED
)

198  -
ENXIO
;

199 
	}
}

202 
	$¢d_ö°r_sim∂e_‰ì
(*
sim∂e
 
ATTRIBUTE_UNUSED
)

205 
	}
}

207 
	$¢d_ö°r_sim∂e_c⁄vît_to_°ªam
(*
sim∂e
 
ATTRIBUTE_UNUSED
,

208 c⁄° *
«me
 
ATTRIBUTE_UNUSED
,

209 **
__d©a
 
ATTRIBUTE_UNUSED
,

210 
size_t
 *
__size
 
ATTRIBUTE_UNUSED
)

212  -
ENXIO
;

213 
	}
}

215 
	$¢d_ö°r_sim∂e_c⁄vît_‰om_°ªam
(*
__d©a
 
ATTRIBUTE_UNUSED
,

216 
size_t
 
size
 
ATTRIBUTE_UNUSED
,

217 **
sim∂e
 
ATTRIBUTE_UNUSED
)

219  -
ENXIO
;

220 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_symbols.c

21 #i‚de‡
PIC


23 c⁄° *
_¢d_moduÀ_£q_hw
;

25 c⁄° **
	g¢d_£q_›í_obje˘s
[] = {

26 &
_¢d_moduÀ_£q_hw


29 *
	$¢d_£q_›í_symbﬁs
()

31  
¢d_£q_›í_obje˘s
;

32 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seqmid.c

23 
	~"£q_loˇl.h
"

24 
	~<uni°d.h
>

25 
	~<°rög.h
>

26 
	~<f˙é.h
>

27 
	~<˘y≥.h
>

28 
	~<sys/io˘l.h
>

46 
	$¢d_£q_c⁄åﬁ_queue
(
¢d_£q_t
 *
£q
, 
q
, 
ty≥
, 
vÆue
, 
¢d_£q_evít_t
 *
ev
)

48 
¢d_£q_evít_t
 
tm≥v
;

49 i‡(
ev
 =
NULL
) {

50 
	`¢d_£q_ev_˛ór
(&
tm≥v
);

51 
ev
 = &
tm≥v
;

52 
	`¢d_£q_ev_£t_dúe˘
(
ev
);

54 
	`¢d_£q_ev_£t_queue_c⁄åﬁ
(
ev
, 
ty≥
, 
q
, 
vÆue
);

55  
	`¢d_£q_evít_ouçut
(
£q
, 
ev
);

56 
	}
}

71 
	$¢d_£q_¸óã_sim∂e_p‹t
(
¢d_£q_t
 *
£q
, c⁄° *
«me
,

72 
ˇps
, 
ty≥
)

74 
¢d_£q_p‹t_öfo_t
 
pöfo
;

75 
ªsu…
;

77 
	`mem£t
(&
pöfo
, 0, (pinfo));

78 i‡(
«me
)

79 
	`°∫˝y
(
pöfo
.
«me
,Çame, (pinfo.name) - 1);

80 
pöfo
.
ˇ∑bûôy
 = 
ˇps
;

81 
pöfo
.
ty≥
 =Åype;

82 
pöfo
.
midi_ch™√ls
 = 16;

83 
pöfo
.
midi_voi˚s
 = 64;

84 
pöfo
.
sy¡h_voi˚s
 = 0;

86 
ªsu…
 = 
	`¢d_£q_¸óã_p‹t
(
£q
, &
pöfo
);

87 i‡(
ªsu…
 < 0)

88  
ªsu…
;

90  
pöfo
.
addr
.
p‹t
;

91 
	}
}

101 
	$¢d_£q_dñëe_sim∂e_p‹t
(
¢d_£q_t
 *
£q
, 
p‹t
)

103  
	`¢d_£q_dñëe_p‹t
(
£q
, 
p‹t
);

104 
	}
}

119 
	$¢d_£q_c⁄√˘_‰om
(
¢d_£q_t
 *
£q
, 
myp‹t
, 
§c_˛õ¡
, 
§c_p‹t
)

121 
¢d_£q_p‹t_subs¸ibe_t
 
subs
;

123 
	`mem£t
(&
subs
, 0, (subs));

124 
subs
.
£ndî
.
˛õ¡
 = 
§c_˛õ¡
;

125 
subs
.
£ndî
.
p‹t
 = 
§c_p‹t
;

127 
subs
.
de°
.
˛õ¡
 = 
	`¢d_£q_˛õ¡_id
(
£q
);

128 
subs
.
de°
.
p‹t
 = 
myp‹t
;

130  
	`¢d_£q_subs¸ibe_p‹t
(
£q
, &
subs
);

131 
	}
}

146 
	$¢d_£q_c⁄√˘_to
(
¢d_£q_t
 *
£q
, 
myp‹t
, 
de°_˛õ¡
, 
de°_p‹t
)

148 
¢d_£q_p‹t_subs¸ibe_t
 
subs
;

150 
	`mem£t
(&
subs
, 0, (subs));

152 
subs
.
£ndî
.
˛õ¡
 = 
	`¢d_£q_˛õ¡_id
(
£q
);

153 
subs
.
£ndî
.
p‹t
 = 
myp‹t
;

154 
subs
.
de°
.
˛õ¡
 = 
de°_˛õ¡
;

155 
subs
.
de°
.
p‹t
 = 
de°_p‹t
;

157  
	`¢d_£q_subs¸ibe_p‹t
(
£q
, &
subs
);

158 
	}
}

173 
	$¢d_£q_disc⁄√˘_‰om
(
¢d_£q_t
 *
£q
, 
myp‹t
, 
§c_˛õ¡
, 
§c_p‹t
)

175 
¢d_£q_p‹t_subs¸ibe_t
 
subs
;

177 
	`mem£t
(&
subs
, 0, (subs));

178 
subs
.
£ndî
.
˛õ¡
 = 
§c_˛õ¡
;

179 
subs
.
£ndî
.
p‹t
 = 
§c_p‹t
;

181 
subs
.
de°
.
˛õ¡
 = 
	`¢d_£q_˛õ¡_id
(
£q
);

182 
subs
.
de°
.
p‹t
 = 
myp‹t
;

184  
	`¢d_£q_unsubs¸ibe_p‹t
(
£q
, &
subs
);

185 
	}
}

200 
	$¢d_£q_disc⁄√˘_to
(
¢d_£q_t
 *
£q
, 
myp‹t
, 
de°_˛õ¡
, 
de°_p‹t
)

202 
¢d_£q_p‹t_subs¸ibe_t
 
subs
;

204 
	`mem£t
(&
subs
, 0, (subs));

206 
subs
.
£ndî
.
˛õ¡
 = 
	`¢d_£q_˛õ¡_id
(
£q
);

207 
subs
.
£ndî
.
p‹t
 = 
myp‹t
;

208 
subs
.
de°
.
˛õ¡
 = 
de°_˛õ¡
;

209 
subs
.
de°
.
p‹t
 = 
de°_p‹t
;

211  
	`¢d_£q_unsubs¸ibe_p‹t
(
£q
, &
subs
);

212 
	}
}

226 
	$¢d_£q_£t_˛õ¡_«me
(
¢d_£q_t
 *
£q
, c⁄° *
«me
)

228 
¢d_£q_˛õ¡_öfo_t
 
öfo
;

229 
îr
;

231 i‡((
îr
 = 
	`¢d_£q_gë_˛õ¡_öfo
(
£q
, &
öfo
)) < 0)

232  
îr
;

233 
	`°∫˝y
(
öfo
.
«me
,Çame, (info.name) - 1);

234  
	`¢d_£q_£t_˛õ¡_öfo
(
£q
, &
öfo
);

235 
	}
}

245 
	$¢d_£q_£t_˛õ¡_evít_fûãr
(
¢d_£q_t
 *
£q
, 
evít_ty≥
)

247 
¢d_£q_˛õ¡_öfo_t
 
öfo
;

248 
îr
;

250 i‡((
îr
 = 
	`¢d_£q_gë_˛õ¡_öfo
(
£q
, &
öfo
)) < 0)

251  
îr
;

252 
	`¢d_£q_˛õ¡_öfo_evít_fûãr_add
(&
öfo
, 
evít_ty≥
);

253  
	`¢d_£q_£t_˛õ¡_öfo
(
£q
, &
öfo
);

254 
	}
}

264 
	$¢d_£q_£t_˛õ¡_midi_vîsi⁄
(
¢d_£q_t
 *
£q
, 
midi_vîsi⁄
)

266 
¢d_£q_˛õ¡_öfo_t
 
öfo
;

267 
îr
;

269 i‡((
îr
 = 
	`¢d_£q_gë_˛õ¡_öfo
(
£q
, &
öfo
)) < 0)

270  
îr
;

271 
	`¢d_£q_˛õ¡_öfo_£t_midi_vîsi⁄
(&
öfo
, 
midi_vîsi⁄
);

272  
	`¢d_£q_£t_˛õ¡_öfo
(
£q
, &
öfo
);

273 
	}
}

283 
	$¢d_£q_£t_˛õ¡_ump_c⁄vîsi⁄
(
¢d_£q_t
 *
£q
, 
íabÀ
)

285 
¢d_£q_˛õ¡_öfo_t
 
öfo
;

286 
îr
;

288 i‡((
îr
 = 
	`¢d_£q_gë_˛õ¡_öfo
(
£q
, &
öfo
)) < 0)

289  
îr
;

290 
	`¢d_£q_˛õ¡_öfo_£t_ump_c⁄vîsi⁄
(&
öfo
, 
íabÀ
);

291  
	`¢d_£q_£t_˛õ¡_öfo
(
£q
, &
öfo
);

292 
	}
}

302 
	$¢d_£q_£t_˛õ¡_poﬁ_ouçut
(
¢d_£q_t
 *
£q
, 
size_t
 
size
)

304 
¢d_£q_˛õ¡_poﬁ_t
 
öfo
;

305 
îr
;

307 i‡((
îr
 = 
	`¢d_£q_gë_˛õ¡_poﬁ
(
£q
, &
öfo
)) < 0)

308  
îr
;

309 
öfo
.
ouçut_poﬁ
 = 
size
;

310  
	`¢d_£q_£t_˛õ¡_poﬁ
(
£q
, &
öfo
);

311 
	}
}

321 
	$¢d_£q_£t_˛õ¡_poﬁ_ouçut_room
(
¢d_£q_t
 *
£q
, 
size_t
 
size
)

323 
¢d_£q_˛õ¡_poﬁ_t
 
öfo
;

324 
îr
;

326 i‡((
îr
 = 
	`¢d_£q_gë_˛õ¡_poﬁ
(
£q
, &
öfo
)) < 0)

327  
îr
;

328 
öfo
.
ouçut_room
 = 
size
;

329  
	`¢d_£q_£t_˛õ¡_poﬁ
(
£q
, &
öfo
);

330 
	}
}

340 
	$¢d_£q_£t_˛õ¡_poﬁ_öput
(
¢d_£q_t
 *
£q
, 
size_t
 
size
)

342 
¢d_£q_˛õ¡_poﬁ_t
 
öfo
;

343 
îr
;

345 i‡((
îr
 = 
	`¢d_£q_gë_˛õ¡_poﬁ
(
£q
, &
öfo
)) < 0)

346  
îr
;

347 
öfo
.
öput_poﬁ
 = 
size
;

348  
	`¢d_£q_£t_˛õ¡_poﬁ
(
£q
, &
öfo
);

349 
	}
}

358 
	$¢d_£q_ª£t_poﬁ_ouçut
(
¢d_£q_t
 *
£q
)

360  
	`¢d_£q_dr›_ouçut
(
£q
);

361 
	}
}

370 
	$¢d_£q_ª£t_poﬁ_öput
(
¢d_£q_t
 *
£q
)

372  
	`¢d_£q_dr›_öput
(
£q
);

373 
	}
}

384 
	$¢d_£q_sync_ouçut_queue
(
¢d_£q_t
 *
£q
)

386 
îr
;

387 
¢d_£q_˛õ¡_poﬁ_t
 
öfo
;

388 
ßved_room
;

389 
pﬁlfd
 
pfd
;

391 
	`as£π
(
£q
);

393 i‡((
îr
 = 
	`¢d_£q_gë_˛õ¡_poﬁ
(
£q
, &
öfo
)) < 0)

394  
îr
;

395 
ßved_room
 = 
öfo
.
ouçut_room
;

396 
öfo
.
ouçut_room
 = info.
ouçut_poﬁ
;

397 i‡((
îr
 = 
	`¢d_£q_£t_˛õ¡_poﬁ
(
£q
, &
öfo
)) < 0)

398  
îr
;

400 
pfd
.
fd
 = 
£q
->
pﬁl_fd
;

401 
pfd
.
evíts
 = 
POLLOUT
;

402 
îr
 = 
	`pﬁl
(&
pfd
, 1, -1);

404 
öfo
.
ouçut_room
 = 
ßved_room
;

405 
	`¢d_£q_£t_˛õ¡_poﬁ
(
£q
, &
öfo
);

406  
îr
;

407 
	}
}

425 
	$¢d_£q_∑r£_addªss
(
¢d_£q_t
 *
£q
, 
¢d_£q_addr_t
 *
addr
, c⁄° *
¨g
)

427 *
p
, *
buf
;

428 c⁄° *
s
;

429 
c
;

430 
˛õ¡
, 
p‹t
 = 0;

431 
Àn
;

433 
	`as£π
(
addr
 && 
¨g
);

435 
c
 = *
¨g
;

436 i‡(
c
 == '"' || c == '\'') {

437 
s
 = ++
¨g
;

438 *
s
 && *†!
c
) s++;

439 
Àn
 = 
s
 - 
¨g
;

440 i‡(*
s
)

441 
s
++;

442 i‡(*
s
) {

443 i‡(*
s
 != '.' && *s != ':')

444  -
EINVAL
;

445 i‡((
p‹t
 = 
	`©oi
(
s
 + 1)) < 0)

446  -
EINVAL
;

449 i‡((
p
 = 
	`°Ωbrk
(
¨g
, ":.")Ë!
NULL
) {

450 i‡((
p‹t
 = 
	`©oi
(
p
 + 1)) < 0)

451  -
EINVAL
;

452 
Àn
 = ()(
p
 - 
¨g
);

454 
Àn
 = 
	`°æí
(
¨g
);

457 i‡(
Àn
 == 0)

458  -
EINVAL
;

459 
buf
 = 
	`Æloˇ
(
Àn
 + 1);

460 
	`°∫˝y
(
buf
, 
¨g
, 
Àn
);

461 
buf
[
Àn
] = '\0';

462 
addr
->
p‹t
 =Öort;

463 i‡(
	`ß„_°πﬁ
(
buf
, &
˛õ¡
) == 0) {

464 
addr
->
˛õ¡
 = client;

467 
¢d_£q_˛õ¡_öfo_t
 
cöfo
;

469 i‡(! 
£q
)

470  -
EINVAL
;

471 i‡(
Àn
 <= 0)

472  -
EINVAL
;

473 
˛õ¡
 = -1;

474 
cöfo
.
˛õ¡
 = -1;

475 
	`¢d_£q_quîy_√xt_˛õ¡
(
£q
, &
cöfo
) >= 0) {

476 i‡(!
	`°∫cmp
(
¨g
, 
cöfo
.
«me
, 
Àn
)) {

477 i‡(
	`°æí
(
cöfo
.
«me
Ë=(
size_t
)
Àn
) {

479 
addr
->
˛õ¡
 = 
cöfo
.client;

482 i‡(
˛õ¡
 < 0)

483 
˛õ¡
 = 
cöfo
.client;

486 i‡(
˛õ¡
 >= 0) {

488 
addr
->
˛õ¡
 = client;

491  -
ENOENT
;

494 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/shmarea.c

31 
	~"c⁄fig.h
"

34 #ifde‡
HAVE_SYS_SHM_H


36 
	~<°dio.h
>

37 
	~<°dlib.h
>

38 #i‡
HAVE_MALLOC_H


39 
	~<mÆloc.h
>

41 
	~<°rög.h
>

42 
	~<î∫o.h
>

43 
	~<pﬁl.h
>

44 
	~<sys/mm™.h
>

45 
	~<sys/shm.h
>

46 
	~"li°.h
"

48 #i‚de‡
DOC_HIDDEN


49 
	s¢d_shm_¨ó
 {

50 
li°_hód
 
	mli°
;

51 
	mshmid
;

52 *
	m±r
;

53 
	msh¨e
;

57 
LIST_HEAD
(
shm_¨ós
);

68 
¢d_shm_¨ó
 *
	$¢d_shm_¨ó_¸óã
(
shmid
, *
±r
)

70 
¢d_shm_¨ó
 *
¨ó
 = 
	`mÆloc
((*area));

71 i‡(
¨ó
) {

72 
¨ó
->
shmid
 = shmid;

73 
¨ó
->
±r
 =Ötr;

74 
¨ó
->
sh¨e
 = 1;

75 
	`li°_add_èû
(&
¨ó
->
li°
, &
shm_¨ós
);

77  
¨ó
;

78 
	}
}

87 
¢d_shm_¨ó
 *
	$¢d_shm_¨ó_sh¨e
(
¢d_shm_¨ó
 *
¨ó
)

89 i‡(
¨ó
 =
NULL
)

90  
NULL
;

91 
¨ó
->
sh¨e
++;

92  
¨ó
;

93 
	}
}

103 
	$¢d_shm_¨ó_de°roy
(
¢d_shm_¨ó
 *
¨ó
)

105 i‡(
¨ó
 =
NULL
)

106  -
ENOENT
;

107 i‡(--
¨ó
->
sh¨e
)

109 
	`li°_dñ
(&
¨ó
->
li°
);

110 
	`shmdt
(
¨ó
->
±r
);

111 
	`‰ì
(
¨ó
);

113 
	}
}

115 #i‚de‡
DOC_HIDDEN


116 
	$¢d_shm_¨ó_de°ru˘‹
(Ë
	`__©åibuã__
 ((
de°ru˘‹
));

118 
	$¢d_shm_¨ó_de°ru˘‹
()

120 
li°_hód
 *
pos
;

121 
¢d_shm_¨ó
 *
¨ó
;

123 
	`li°_f‹_óch
(
pos
, &
shm_¨ós
) {

124 
¨ó
 = 
	`li°_íåy
(
pos
, 
¢d_shm_¨ó
, 
li°
);

125 
	`shmdt
(
¨ó
->
±r
);

127 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/socket.c

28 
	~"loˇl.h
"

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°ddef.h
>

32 
	~<uni°d.h
>

33 
	~<°rög.h
>

34 
	~<sys/sockë.h
>

35 
	~<sys/uio.h
>

36 
	~<sys/un.h
>

37 
	~<√töë/ö.h
>

38 
	~<sys/io˘l.h
>

39 
	~<√t/if.h
>

40 
	~<√tdb.h
>

42 #i‚de‡
DOC_HIDDEN


43 
	$¢d_£nd_fd
(
sock
, *
d©a
, 
size_t
 
Àn
, 
fd
)

45 
ªt
;

46 
size_t
 
cmsg_Àn
 = 
	`CMSG_LEN
(());

47 
cmsghdr
 *
cmsg
 = 
	`Æloˇ
(
cmsg_Àn
);

48 *
fds
 = (*Ë
	`CMSG_DATA
(
cmsg
);

49 
msghdr
 msghdr;

50 
iovec
 
vec
;

52 
vec
.
iov_ba£
 = (*)&
d©a
;

53 
vec
.
iov_Àn
 = 
Àn
;

55 
cmsg
->
cmsg_Àn
 = cmsg_len;

56 
cmsg
->
cmsg_Àvñ
 = 
SOL_SOCKET
;

57 
cmsg
->
cmsg_ty≥
 = 
SCM_RIGHTS
;

58 *
fds
 = 
fd
;

60 
msghdr
.
msg_«me
 = 
NULL
;

61 
msghdr
.
msg_«mñí
 = 0;

62 
msghdr
.
msg_iov
 = &
vec
;

63 
msghdr
.
msg_iovÀn
 = 1;

64 
msghdr
.
msg_c⁄åﬁ
 = 
cmsg
;

65 
msghdr
.
msg_c⁄åﬁÀn
 = 
cmsg_Àn
;

66 
msghdr
.
msg_Êags
 = 0;

68 
ªt
 = 
	`£ndmsg
(
sock
, &
msghdr
, 0 );

69 i‡(
ªt
 < 0) {

70 
	`SYSERR
("sendmsg failed");

71  -
î∫o
;

73  
ªt
;

74 
	}
}

76 
	$¢d_ª˚ive_fd
(
sock
, *
d©a
, 
size_t
 
Àn
, *
fd
)

78 
ªt
;

79 
size_t
 
cmsg_Àn
 = 
	`CMSG_LEN
(());

80 
cmsghdr
 *
cmsg
 = 
	`Æloˇ
(
cmsg_Àn
);

81 *
fds
 = (*Ë
	`CMSG_DATA
(
cmsg
);

82 
msghdr
 msghdr;

83 
iovec
 
vec
;

85 
vec
.
iov_ba£
 = (*)&
d©a
;

86 
vec
.
iov_Àn
 = 
Àn
;

88 
cmsg
->
cmsg_Àn
 = cmsg_len;

89 
cmsg
->
cmsg_Àvñ
 = 
SOL_SOCKET
;

90 
cmsg
->
cmsg_ty≥
 = 
SCM_RIGHTS
;

91 *
fds
 = -1;

93 
msghdr
.
msg_«me
 = 
NULL
;

94 
msghdr
.
msg_«mñí
 = 0;

95 
msghdr
.
msg_iov
 = &
vec
;

96 
msghdr
.
msg_iovÀn
 = 1;

97 
msghdr
.
msg_c⁄åﬁ
 = 
cmsg
;

98 
msghdr
.
msg_c⁄åﬁÀn
 = 
cmsg_Àn
;

99 
msghdr
.
msg_Êags
 = 0;

101 
ªt
 = 
	`ªcvmsg
(
sock
, &
msghdr
, 0);

102 i‡(
ªt
 < 0) {

103 
	`SYSERR
("recvmsg failed");

104  -
î∫o
;

106 *
fd
 = *
fds
;

107  
ªt
;

108 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer.c

70 
	~"timî_loˇl.h
"

72 
	~<sig«l.h
>

74 
	$¢d_timî_›í_c⁄f
(
¢d_timî_t
 **
timî
,

75 c⁄° *
«me
, 
¢d_c⁄fig_t
 *
timî_roŸ
,

76 
¢d_c⁄fig_t
 *
timî_c⁄f
, 
mode
)

78 c⁄° *
°r
;

79 
buf
[256], 
îrbuf
[256];

80 
îr
;

81 
¢d_c⁄fig_t
 *
c⁄f
, *
ty≥_c⁄f
 = 
NULL
;

82 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

83 c⁄° *
id
;

84 c⁄° *
lib
 = 
NULL
, *
›í_«me
 = NULL;

85 (*
›í_func
)(
¢d_timî_t
 **, c⁄° *, 
¢d_c⁄fig_t
 *, snd_c⁄fig_à*, Ë
NULL
;

86 #i‚de‡
PIC


87 *
	`¢d_timî_›í_symbﬁs
();

89 *
h
 = 
NULL
;

90 i‡(
	`¢d_c⁄fig_gë_ty≥
(
timî_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

91 i‡(
«me
)

92 
	`SNDERR
("InvÆidÅy≥ f‹ TIMER %†deföôi⁄", 
«me
);

94 
	`SNDERR
("InvalidÅype for TIMER definition");

95  -
EINVAL
;

97 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
timî_c⁄f
, "ty≥", &
c⁄f
);

98 i‡(
îr
 < 0) {

99 
	`SNDERR
("type isÇot defined");

100  
îr
;

102 
îr
 = 
	`¢d_c⁄fig_gë_id
(
c⁄f
, &
id
);

103 i‡(
îr
 < 0) {

104 
	`SNDERR
("unableÅo get id");

105  
îr
;

107 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
c⁄f
, &
°r
);

108 i‡(
îr
 < 0) {

109 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

110  
îr
;

112 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
timî_roŸ
, "timî_ty≥", 
°r
, &
ty≥_c⁄f
);

113 i‡(
îr
 >= 0) {

114 i‡(
	`¢d_c⁄fig_gë_ty≥
(
ty≥_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

115 
	`SNDERR
("InvÆidÅy≥ f‹ TIMERÅy≥ %†deföôi⁄", 
°r
);

116 
_îr
;

118 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
ty≥_c⁄f
) {

119 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

120 c⁄° *
id
;

121 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

123 i‡(
	`°rcmp
(
id
, "comment") == 0)

125 i‡(
	`°rcmp
(
id
, "lib") == 0) {

126 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
lib
);

127 i‡(
îr
 < 0) {

128 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

129 
_îr
;

133 i‡(
	`°rcmp
(
id
, "open") == 0) {

134 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
›í_«me
);

135 i‡(
îr
 < 0) {

136 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

137 
_îr
;

141 
	`SNDERR
("Unknow¿fõld %s", 
id
);

142 
îr
 = -
EINVAL
;

143 
_îr
;

146 i‡(!
›í_«me
) {

147 
›í_«me
 = 
buf
;

148 
	`¢¥ötf
(
buf
, (buf), "_¢d_timî_%s_›í", 
°r
);

150 #i‚de‡
PIC


151 
	`¢d_timî_›í_symbﬁs
();

153 
h
 = 
	`INTERNAL
(
¢d_dl›í
)(
lib
, 
RTLD_NOW
, 
îrbuf
, (errbuf));

154 i‡(
h
)

155 
›í_func
 = 
	`¢d_dlsym
(
h
, 
›í_«me
, 
	`SND_DLSYM_VERSION
(
SND_TIMER_DLSYM_VERSION
));

156 
îr
 = 0;

157 i‡(!
h
) {

158 
	`SNDERR
("C™nŸ o≥¿sh¨edÜibøry %†(%s)", 
lib
, 
îrbuf
);

159 
îr
 = -
ENOENT
;

160 } i‡(!
›í_func
) {

161 
	`SNDERR
("symbﬁ %†i†nŸ deföed insidê%s", 
›í_«me
, 
lib
);

162 
	`¢d_dl˛o£
(
h
);

163 
îr
 = -
ENXIO
;

165 
_îr
:

166 i‡(
ty≥_c⁄f
)

167 
	`¢d_c⁄fig_dñëe
(
ty≥_c⁄f
);

168 i‡(! 
îr
) {

169 
îr
 = 
	`›í_func
(
timî
, 
«me
, 
timî_roŸ
, 
timî_c⁄f
, 
mode
);

170 i‡(
îr
 < 0)

171 
	`¢d_dl˛o£
(
h
);

173 (*
timî
)->
dl_h™dÀ
 = 
h
;

175  
îr
;

176 
	}
}

178 
	$¢d_timî_›í_noupd©e
(
¢d_timî_t
 **
timî
, 
¢d_c⁄fig_t
 *
roŸ
, c⁄° *
«me
, 
mode
)

180 
îr
;

181 
¢d_c⁄fig_t
 *
timî_c⁄f
;

182 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "timî", 
«me
, &
timî_c⁄f
);

183 i‡(
îr
 < 0) {

184 
	`SNDERR
("Unknow¿timî %s", 
«me
);

185  
îr
;

187 
îr
 = 
	`¢d_timî_›í_c⁄f
(
timî
, 
«me
, 
roŸ
, 
timî_c⁄f
, 
mode
);

188 
	`¢d_c⁄fig_dñëe
(
timî_c⁄f
);

189  
îr
;

190 
	}
}

202 
	$¢d_timî_›í
(
¢d_timî_t
 **
timî
, c⁄° *
«me
, 
mode
)

204 
¢d_c⁄fig_t
 *
t›
;

205 
îr
;

207 
	`as£π
(
timî
 && 
«me
);

208 i‡(
	`_¢d_is_ucm_devi˚
(
«me
)) {

209 
«me
 = 
	`uc_mgr_Æibcfg_by_devi˚
(&
t›
,Çame);

210 i‡(
«me
 =
NULL
)

211  -
ENODEV
;

213 
îr
 = 
	`¢d_c⁄fig_upd©e_ªf
(&
t›
);

214 i‡(
îr
 < 0)

215  
îr
;

217 
îr
 = 
	`¢d_timî_›í_noupd©e
(
timî
, 
t›
, 
«me
, 
mode
);

218 
	`¢d_c⁄fig_uƒef
(
t›
);

219  
îr
;

220 
	}
}

233 
	$¢d_timî_›í_lc⁄f
(
¢d_timî_t
 **
timî
, c⁄° *
«me
,

234 
mode
, 
¢d_c⁄fig_t
 *
lc⁄f
)

236 
	`as£π
(
timî
 && 
«me
 && 
lc⁄f
);

237  
	`¢d_timî_›í_noupd©e
(
timî
, 
lc⁄f
, 
«me
, 
mode
);

238 
	}
}

248 
	$¢d_timî_˛o£
(
¢d_timî_t
 *
timî
)

250 
îr
;

251 
	`as£π
(
timî
);

252 !
	`li°_em±y
(&
timî
->
async_h™dÀrs
)) {

253 
¢d_async_h™dÀr_t
 *
h
 = 
	`li°_íåy
(
timî
->
async_h™dÀrs
.
√xt
, snd_async_h™dÀr_t, 
hli°
);

254 
	`¢d_async_dñ_h™dÀr
(
h
);

256 
îr
 = 
timî
->
›s
->
	`˛o£
(timer);

257 i‡(
timî
->
dl_h™dÀ
)

258 
	`¢d_dl˛o£
(
timî
->
dl_h™dÀ
);

259 
	`‰ì
(
timî
->
«me
);

260 
	`‰ì
(
timî
);

261  
îr
;

262 
	}
}

272 c⁄° *
	$¢d_timî_«me
(
¢d_timî_t
 *
timî
)

274 
	`as£π
(
timî
);

275  
timî
->
«me
;

276 
	}
}

285 
¢d_timî_ty≥_t
 
	$¢d_timî_ty≥
(
¢d_timî_t
 *
timî
)

287 
	`as£π
(
timî
);

288  
timî
->
ty≥
;

289 
	}
}

301 
	$¢d_async_add_timî_h™dÀr
(
¢d_async_h™dÀr_t
 **
h™dÀr
, 
¢d_timî_t
 *
timî
,

302 
¢d_async_ˇŒback_t
 
ˇŒback
, *
¥iv©e_d©a
)

304 
îr
;

305 
was_em±y
;

306 
¢d_async_h™dÀr_t
 *
h
;

307 
îr
 = 
	`¢d_async_add_h™dÀr
(&
h
, 
timî
->
pﬁl_fd
,

308 
ˇŒback
, 
¥iv©e_d©a
);

309 i‡(
îr
 < 0)

310  
îr
;

311 
h
->
ty≥
 = 
SND_ASYNC_HANDLER_TIMER
;

312 
h
->
u
.
timî
 =Åimer;

313 
was_em±y
 = 
	`li°_em±y
(&
timî
->
async_h™dÀrs
);

314 
	`li°_add_èû
(&
h
->
hli°
, &
timî
->
async_h™dÀrs
);

315 i‡(
was_em±y
) {

316 
îr
 = 
	`¢d_timî_async
(
timî
, 
	`¢d_async_h™dÀr_gë_signo
(
h
), 
	`gëpid
());

317 i‡(
îr
 < 0) {

318 
	`¢d_async_dñ_h™dÀr
(
h
);

319  
îr
;

322 *
h™dÀr
 = 
h
;

324 
	}
}

331 
¢d_timî_t
 *
	$¢d_async_h™dÀr_gë_timî
(
¢d_async_h™dÀr_t
 *
h™dÀr
)

333 i‡(
h™dÀr
->
ty≥
 !
SND_ASYNC_HANDLER_TIMER
) {

334 
	`SNDMSG
("övÆid h™dÀ∏ty≥ %d", 
h™dÀr
->
ty≥
);

335  
NULL
;

337  
h™dÀr
->
u
.
timî
;

338 
	}
}

345 
	$¢d_timî_pﬁl_des¸ùt‹s_cou¡
(
¢d_timî_t
 *
timî
)

347 
	`as£π
(
timî
);

349 
	}
}

358 
	$¢d_timî_pﬁl_des¸ùt‹s
(
¢d_timî_t
 *
timî
, 
pﬁlfd
 *
pfds
, 
•a˚
)

360 
	`as£π
(
timî
);

361 i‡(
•a˚
 >= 1) {

362 
pfds
->
fd
 = 
timî
->
pﬁl_fd
;

363 
timî
->
mode
 & 
O_ACCMODE
) {

364 
O_WRONLY
:

365 
pfds
->
evíts
 = 
POLLOUT
|
POLLERR
|
POLLNVAL
;

367 
O_RDONLY
:

368 
pfds
->
evíts
 = 
POLLIN
|
POLLERR
|
POLLNVAL
;

370 
O_RDWR
:

371 
pfds
->
evíts
 = 
POLLOUT
|
POLLIN
|
POLLERR
|
POLLNVAL
;

374  -
EIO
;

379 
	}
}

389 
	$¢d_timî_pﬁl_des¸ùt‹s_ªvíts
(
¢d_timî_t
 *
timî
, 
pﬁlfd
 *
pfds
, 
nfds
, *
ªvíts
)

391 
	`as£π
(
timî
 && 
pfds
 && 
ªvíts
);

392 i‡(
nfds
 == 1) {

393 *
ªvíts
 = 
pfds
->revents;

396  -
EINVAL
;

397 
	}
}

405 
	$¢d_timî_n⁄block
(
¢d_timî_t
 *
timî
, 
n⁄block
)

407 
îr
;

408 
	`as£π
(
timî
);

409 i‡((
îr
 = 
timî
->
›s
->
	`n⁄block
—imî, 
n⁄block
)) < 0)

410  
îr
;

411 i‡(
n⁄block
)

412 
timî
->
mode
 |
SND_TIMER_OPEN_NONBLOCK
;

414 
timî
->
mode
 &~
SND_TIMER_OPEN_NONBLOCK
;

416 
	}
}

418 #i‚de‡
DOC_HIDDEN


428 
	$¢d_timî_async
(
¢d_timî_t
 *
timî
, 
sig
, 
pid_t
 
pid
)

430 
	`as£π
(
timî
);

431 i‡(
sig
 == 0)

432 
sig
 = 
SIGIO
;

433 i‡(
pid
 == 0)

434 
pid
 = 
	`gëpid
();

435  
timî
->
›s
->
	`async
—imî, 
sig
, 
pid
);

436 
	}
}

443 
size_t
 
	$¢d_timî_öfo_sizeof
()

445  (
¢d_timî_öfo_t
);

446 
	}
}

456 
	$¢d_timî_öfo_mÆloc
(
¢d_timî_öfo_t
 **
öfo
)

458 
	`as£π
(
öfo
);

459 *
öfo
 = 
	`ˇŒoc
(1, (
¢d_timî_öfo_t
));

460 i‡(!*
öfo
)

461  -
ENOMEM
;

463 
	}
}

472 
	$¢d_timî_öfo_‰ì
(
¢d_timî_öfo_t
 *
öfo
)

474 
	`as£π
(
öfo
);

475 
	`‰ì
(
öfo
);

476 
	}
}

483 
	$¢d_timî_öfo_c›y
(
¢d_timî_öfo_t
 *
d°
, c⁄° snd_timî_öfo_à*
§c
)

485 
	`as£π
(
d°
 && 
§c
);

486 *
d°
 = *
§c
;

487 
	}
}

494 
	$¢d_timî_öfo_is_¶ave
(
¢d_timî_öfo_t
 * 
öfo
)

496 
	`as£π
(
öfo
);

497  
öfo
->
Êags
 & 
SNDRV_TIMER_FLG_SLAVE
 ? 1 : 0;

498 
	}
}

505 
	$¢d_timî_öfo_gë_ˇrd
(
¢d_timî_öfo_t
 * 
öfo
)

507 
	`as£π
(
öfo
);

508  
öfo
->
ˇrd
;

509 
	}
}

516 c⁄° *
	$¢d_timî_öfo_gë_id
(
¢d_timî_öfo_t
 * 
öfo
)

518 
	`as£π
(
öfo
);

519  (c⁄° *)
öfo
->
id
;

520 
	}
}

527 c⁄° *
	$¢d_timî_öfo_gë_«me
(
¢d_timî_öfo_t
 * 
öfo
)

529 
	`as£π
(
öfo
);

530  (c⁄° *)
öfo
->
«me
;

531 
	}
}

539 
	$¢d_timî_öfo_gë_ªsﬁuti⁄
(
¢d_timî_öfo_t
 * 
öfo
)

541 
	`as£π
(
öfo
);

542  
öfo
->
ªsﬁuti⁄
;

543 
	}
}

551 
	$¢d_timî_öfo
(
¢d_timî_t
 *
timî
, 
¢d_timî_öfo_t
 * 
öfo
)

553 
	`as£π
(
timî
);

554 
	`as£π
(
öfo
);

555  
timî
->
›s
->
	`öfo
—imî, 
öfo
);

556 
	}
}

562 
size_t
 
	$¢d_timî_∑øms_sizeof
()

564  (
¢d_timî_∑øms_t
);

565 
	}
}

575 
	$¢d_timî_∑øms_mÆloc
(
¢d_timî_∑øms_t
 **
∑øms
)

577 
	`as£π
(
∑øms
);

578 *
∑øms
 = 
	`ˇŒoc
(1, (
¢d_timî_∑øms_t
));

579 i‡(!*
∑øms
)

580  -
ENOMEM
;

582 
	}
}

591 
	$¢d_timî_∑øms_‰ì
(
¢d_timî_∑øms_t
 *
∑øms
)

593 
	`as£π
(
∑øms
);

594 
	`‰ì
(
∑øms
);

595 
	}
}

602 
	$¢d_timî_∑øms_c›y
(
¢d_timî_∑øms_t
 *
d°
, c⁄° snd_timî_∑øms_à*
§c
)

604 
	`as£π
(
d°
 && 
§c
);

605 *
d°
 = *
§c
;

606 
	}
}

613 
	$¢d_timî_∑øms_£t_auto_°¨t
(
¢d_timî_∑øms_t
 * 
∑øms
, 
auto_°¨t
)

615 
	`as£π
(
∑øms
);

616 i‡(
auto_°¨t
)

617 
∑øms
->
Êags
 |
SNDRV_TIMER_PSFLG_AUTO
;

619 
∑øms
->
Êags
 &~
SNDRV_TIMER_PSFLG_AUTO
;

621 
	}
}

628 
	$¢d_timî_∑øms_gë_auto_°¨t
(
¢d_timî_∑øms_t
 * 
∑øms
)

630 
	`as£π
(
∑øms
);

631  
∑øms
->
Êags
 & 
SNDRV_TIMER_PSFLG_AUTO
 ? 1 : 0;

632 
	}
}

639 #i‚de‡
DOXYGEN


640 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_timî_∑øms_£t_ex˛usive
)(
¢d_timî_∑øms_t
 * 
∑øms
, 
ex˛usive
)

642 
	$¢d_timî_∑øms_£t_ex˛usive
(
¢d_timî_∑øms_t
 * 
∑øms
, 
ex˛usive
)

645 
	`as£π
(
∑øms
);

646 i‡(
ex˛usive
)

647 
∑øms
->
Êags
 |
SNDRV_TIMER_PSFLG_EXCLUSIVE
;

649 
∑øms
->
Êags
 &~
SNDRV_TIMER_PSFLG_EXCLUSIVE
;

651 
	}
}

652 
u£_deÁu…_symbﬁ_vîsi⁄
(
__¢d_timî_∑øms_£t_ex˛usive
, 
¢d_timî_∑øms_£t_ex˛usive
, 
ALSA_0
.9.0);

659 #i‚de‡
DOXYGEN


660 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_timî_∑øms_gë_ex˛usive
)(
¢d_timî_∑øms_t
 * 
∑øms
)

662 
	$¢d_timî_∑øms_gë_ex˛usive
(
¢d_timî_∑øms_t
 * 
∑øms
)

665 
	`as£π
(
∑øms
);

666  
∑øms
->
Êags
 & 
SNDRV_TIMER_PSFLG_EXCLUSIVE
 ? 1 : 0;

667 
	}
}

668 
u£_deÁu…_symbﬁ_vîsi⁄
(
__¢d_timî_∑øms_gë_ex˛usive
, 
¢d_timî_∑øms_gë_ex˛usive
, 
ALSA_0
.9.0);

675 
	$¢d_timî_∑øms_£t_óæy_evít
(
¢d_timî_∑øms_t
 * 
∑øms
, 
óæy_evít
)

677 
	`as£π
(
∑øms
);

678 i‡(
óæy_evít
)

679 
∑øms
->
Êags
 |
SNDRV_TIMER_PSFLG_EARLY_EVENT
;

681 
∑øms
->
Êags
 &~
SNDRV_TIMER_PSFLG_EARLY_EVENT
;

683 
	}
}

690 
	$¢d_timî_∑øms_gë_óæy_evít
(
¢d_timî_∑øms_t
 * 
∑øms
)

692 
	`as£π
(
∑øms
);

693  
∑øms
->
Êags
 & 
SNDRV_TIMER_PSFLG_EARLY_EVENT
 ? 1 : 0;

694 
	}
}

701 
	$¢d_timî_∑øms_£t_ticks
(
¢d_timî_∑øms_t
 * 
∑øms
, 
ticks
)

703 
	`as£π
(
∑øms
);

704 
∑øms
->
ticks
 =Åicks;

705 
	}
}

712 
	$¢d_timî_∑øms_gë_ticks
(
¢d_timî_∑øms_t
 * 
∑øms
)

714 
	`as£π
(
∑øms
);

715  
∑øms
->
ticks
;

716 
	}
}

723 
	$¢d_timî_∑øms_£t_queue_size
(
¢d_timî_∑øms_t
 * 
∑øms
, 
queue_size
)

725 
	`as£π
(
∑øms
);

726 
∑øms
->
queue_size
 = queue_size;

727 
	}
}

734 
	$¢d_timî_∑øms_gë_queue_size
(
¢d_timî_∑øms_t
 * 
∑øms
)

736 
	`as£π
(
∑øms
);

737  
∑øms
->
queue_size
;

738 
	}
}

745 #i‚de‡
DOXYGEN


746 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_timî_∑øms_£t_fûãr
)(
¢d_timî_∑øms_t
 * 
∑øms
, 
fûãr
)

748 
	$¢d_timî_∑øms_£t_fûãr
(
¢d_timî_∑øms_t
 * 
∑øms
, 
fûãr
)

751 
	`as£π
(
∑øms
);

752 
∑øms
->
fûãr
 = filter;

753 
	}
}

754 
u£_deÁu…_symbﬁ_vîsi⁄
(
__¢d_timî_∑øms_£t_fûãr
, 
¢d_timî_∑øms_£t_fûãr
, 
ALSA_0
.9.0);

761 #i‚de‡
DOXYGEN


762 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_timî_∑øms_gë_fûãr
)(
¢d_timî_∑øms_t
 * 
∑øms
)

764 
	$¢d_timî_∑øms_gë_fûãr
(
¢d_timî_∑øms_t
 * 
∑øms
)

767 
	`as£π
(
∑øms
);

768  
∑øms
->
fûãr
;

769 
	}
}

770 
u£_deÁu…_symbﬁ_vîsi⁄
(
__¢d_timî_∑øms_gë_fûãr
, 
¢d_timî_∑øms_gë_fûãr
, 
ALSA_0
.9.0);

778 
	$¢d_timî_∑øms
(
¢d_timî_t
 *
timî
, 
¢d_timî_∑øms_t
 * 
∑øms
)

780 
	`as£π
(
timî
);

781 
	`as£π
(
∑øms
);

782  
timî
->
›s
->
	`∑øms
—imî, 
∑øms
);

783 
	}
}

789 
size_t
 
	$¢d_timî_°©us_sizeof
()

791  (
¢d_timî_°©us_t
);

792 
	}
}

802 
	$¢d_timî_°©us_mÆloc
(
¢d_timî_°©us_t
 **
°©us
)

804 
	`as£π
(
°©us
);

805 *
°©us
 = 
	`ˇŒoc
(1, (
¢d_timî_°©us_t
));

806 i‡(!*
°©us
)

807  -
ENOMEM
;

809 
	}
}

818 
	$¢d_timî_°©us_‰ì
(
¢d_timî_°©us_t
 *
°©us
)

820 
	`as£π
(
°©us
);

821 
	`‰ì
(
°©us
);

822 
	}
}

829 
	$¢d_timî_°©us_c›y
(
¢d_timî_°©us_t
 *
d°
, c⁄° snd_timî_°©us_à*
§c
)

831 
	`as£π
(
d°
 && 
§c
);

832 *
d°
 = *
§c
;

833 
	}
}

842 
¢d_htime°amp_t
 
	$¢d_timî_°©us_gë_time°amp
(
¢d_timî_°©us_t
 * 
°©us
)

844 
	`as£π
(
°©us
);

845  
°©us
->
t°amp
;

846 
	}
}

853 
	$¢d_timî_°©us_gë_ªsﬁuti⁄
(
¢d_timî_°©us_t
 * 
°©us
)

855 
	`as£π
(
°©us
);

856  
°©us
->
ªsﬁuti⁄
;

857 
	}
}

864 
	$¢d_timî_°©us_gë_lo°
(
¢d_timî_°©us_t
 * 
°©us
)

866 
	`as£π
(
°©us
);

867  
°©us
->
lo°
;

868 
	}
}

875 
	$¢d_timî_°©us_gë_ovîrun
(
¢d_timî_°©us_t
 * 
°©us
)

877 
	`as£π
(
°©us
);

878  
°©us
->
ovîrun
;

879 
	}
}

886 
	$¢d_timî_°©us_gë_queue
(
¢d_timî_°©us_t
 * 
°©us
)

888 
	`as£π
(
°©us
);

889  
°©us
->
queue
;

890 
	}
}

898 
	$¢d_timî_°©us
(
¢d_timî_t
 *
timî
, 
¢d_timî_°©us_t
 * 
°©us
)

900 
	`as£π
(
timî
);

901 
	`as£π
(
°©us
);

902  
timî
->
›s
->
	`°©us
—imî, 
°©us
);

903 
	}
}

910 
	$¢d_timî_°¨t
(
¢d_timî_t
 *
timî
)

912 
	`as£π
(
timî
);

913  
timî
->
›s
->
	`π_°¨t
(timer);

914 
	}
}

921 
	$¢d_timî_°›
(
¢d_timî_t
 *
timî
)

923 
	`as£π
(
timî
);

924  
timî
->
›s
->
	`π_°›
(timer);

925 
	}
}

932 
	$¢d_timî_c⁄töue
(
¢d_timî_t
 *
timî
)

934 
	`as£π
(
timî
);

935  
timî
->
›s
->
	`π_c⁄töue
(timer);

936 
	}
}

944 
ssize_t
 
	$¢d_timî_ªad
(
¢d_timî_t
 *
timî
, *
buf„r
, 
size_t
 
size
)

946 
	`as£π
(
timî
);

947 
	`as£π
(((
timî
->
mode
 & 
O_ACCMODE
Ë=
O_RDONLY
Ë|| (—imî->modê& O_ACCMODEË=
O_RDWR
));

948 
	`as£π
(
buf„r
 || 
size
 == 0);

949  (
timî
->
›s
->
ªad
)—imî, 
buf„r
, 
size
);

950 
	}
}

957 
	$¢d_timî_öfo_gë_ticks
(
¢d_timî_öfo_t
 * 
öfo
)

959 
	`as£π
(
öfo
);

961 
	}
}

962 #i‚de‡
DOC_HIDDEN


963 
lök_w¨nög
(
¢d_timî_öfo_gë_ticks
, "Warning: snd_timer_info_get_ticks is deprecated");

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_hw.c

22 
	~"timî_loˇl.h
"

24 #i‚de‡
PIC


26 c⁄° *
	g_¢d_moduÀ_timî_hw
 = "";

29 
	#SNDRV_FILE_TIMER
 
ALSA_DEVICE_DIRECTORY
 "timî"

	)

30 
	#SNDRV_TIMER_VERSION_MAX
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 5)

	)

32 
	#SNDRV_TIMER_IOCTL_STATUS_OLD
 
	`_IOW
('T', 0x14, 
¢d_timî_°©us
)

	)

35 
	mSNDRV_TIMER_IOCTL_START_OLD
 = 
_IO
('T', 0x20),

36 
	mSNDRV_TIMER_IOCTL_STOP_OLD
 = 
_IO
('T', 0x21),

37 
	mSNDRV_TIMER_IOCTL_CONTINUE_OLD
 = 
_IO
('T', 0x22),

38 
	mSNDRV_TIMER_IOCTL_PAUSE_OLD
 = 
_IO
('T', 0x23),

41 
	$¢d_timî_hw_˛o£
(
¢d_timî_t
 *
h™dÀ
)

43 
¢d_timî_t
 *
tmr
 = 
h™dÀ
;

44 
ªs
;

46 i‡(!
tmr
)

47  -
EINVAL
;

48 
ªs
 = 
	`˛o£
(
tmr
->
pﬁl_fd
Ë< 0 ? -
î∫o
 : 0;

49  
ªs
;

50 
	}
}

52 
	$¢d_timî_hw_n⁄block
(
¢d_timî_t
 *
timî
, 
n⁄block
)

54 
Êags
;

55 
	`as£π
(
timî
);

56 i‡((
Êags
 = 
	`f˙é
(
timî
->
pﬁl_fd
, 
F_GETFL
)) < 0)

57  -
î∫o
;

58 i‡(
n⁄block
)

59 
Êags
 |
O_NONBLOCK
;

61 
Êags
 &~
O_NONBLOCK
;

62 i‡(
	`f˙é
(
timî
->
pﬁl_fd
, 
F_SETFL
, 
Êags
) < 0)

63  -
î∫o
;

65 
	}
}

67 
	$¢d_timî_hw_async
(
¢d_timî_t
 *
timî
, 
sig
, 
pid_t
 
pid
)

69 
Êags
;

70 
fd
;

72 
	`as£π
(
timî
);

73 
fd
 = 
timî
->
pﬁl_fd
;

74 i‡((
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
)) < 0) {

75 
	`SYSERR
("F_GETFL failed");

76  -
î∫o
;

78 i‡(
sig
 >= 0)

79 
Êags
 |
O_ASYNC
;

81 
Êags
 &~
O_ASYNC
;

82 i‡(
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
) < 0) {

83 
	`SYSERR
("F_SETFL for O_ASYNC failed");

84  -
î∫o
;

86 i‡(
sig
 < 0)

88 #ifde‡
F_SETSIG


89 i‡(
	`f˙é
(
fd
, 
F_SETSIG
, ()
sig
) < 0) {

90 
	`SYSERR
("F_SETSIG failed");

91  -
î∫o
;

94 i‡(
	`f˙é
(
fd
, 
F_SETOWN
, ()
pid
) < 0) {

95 
	`SYSERR
("F_SETOWN failed");

96  -
î∫o
;

99 
	}
}

101 
	$¢d_timî_hw_öfo
(
¢d_timî_t
 *
h™dÀ
, 
¢d_timî_öfo_t
 * 
öfo
)

103 
¢d_timî_t
 *
tmr
;

105 
tmr
 = 
h™dÀ
;

106 i‡(!
tmr
 || !
öfo
)

107  -
EINVAL
;

108 i‡(
	`io˘l
(
tmr
->
pﬁl_fd
, 
SNDRV_TIMER_IOCTL_INFO
, 
öfo
) < 0)

109  -
î∫o
;

111 
	}
}

113 
	$¢d_timî_hw_∑øms
(
¢d_timî_t
 *
h™dÀ
, 
¢d_timî_∑øms_t
 * 
∑øms
)

115 
¢d_timî_t
 *
tmr
;

117 
tmr
 = 
h™dÀ
;

118 i‡(!
tmr
 || !
∑øms
)

119  -
EINVAL
;

120 i‡(
	`io˘l
(
tmr
->
pﬁl_fd
, 
SNDRV_TIMER_IOCTL_PARAMS
, 
∑øms
) < 0)

121  -
î∫o
;

123 
	}
}

125 
	$¢d_timî_hw_°©us
(
¢d_timî_t
 *
h™dÀ
, 
¢d_timî_°©us_t
 * 
°©us
)

127 
¢d_timî_t
 *
tmr
;

128 
cmd
;

130 
tmr
 = 
h™dÀ
;

131 i‡(!
tmr
 || !
°©us
)

132  -
EINVAL
;

133 i‡(
tmr
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 1))

134 
cmd
 = 
SNDRV_TIMER_IOCTL_STATUS_OLD
;

136 
cmd
 = 
SNDRV_TIMER_IOCTL_STATUS
;

137 i‡(
	`io˘l
(
tmr
->
pﬁl_fd
, 
cmd
, 
°©us
) < 0)

138  -
î∫o
;

140 
	}
}

142 
	$¢d_timî_hw_°¨t
(
¢d_timî_t
 *
h™dÀ
)

144 
¢d_timî_t
 *
tmr
;

145 
cmd
;

147 
tmr
 = 
h™dÀ
;

148 i‡(!
tmr
)

149  -
EINVAL
;

150 i‡(
tmr
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4))

151 
cmd
 = 
SNDRV_TIMER_IOCTL_START_OLD
;

153 
cmd
 = 
SNDRV_TIMER_IOCTL_START
;

154 i‡(
	`io˘l
(
tmr
->
pﬁl_fd
, 
cmd
) < 0)

155  -
î∫o
;

157 
	}
}

159 
	$¢d_timî_hw_°›
(
¢d_timî_t
 *
h™dÀ
)

161 
¢d_timî_t
 *
tmr
;

162 
cmd
;

164 
tmr
 = 
h™dÀ
;

165 i‡(!
tmr
)

166  -
EINVAL
;

167 i‡(
tmr
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4))

168 
cmd
 = 
SNDRV_TIMER_IOCTL_STOP_OLD
;

170 
cmd
 = 
SNDRV_TIMER_IOCTL_STOP
;

171 i‡(
	`io˘l
(
tmr
->
pﬁl_fd
, 
cmd
) < 0)

172  -
î∫o
;

174 
	}
}

176 
	$¢d_timî_hw_c⁄töue
(
¢d_timî_t
 *
h™dÀ
)

178 
¢d_timî_t
 *
tmr
;

179 
cmd
;

181 
tmr
 = 
h™dÀ
;

182 i‡(!
tmr
)

183  -
EINVAL
;

184 i‡(
tmr
->
vîsi⁄
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 4))

185 
cmd
 = 
SNDRV_TIMER_IOCTL_CONTINUE_OLD
;

187 
cmd
 = 
SNDRV_TIMER_IOCTL_CONTINUE
;

188 i‡(
	`io˘l
(
tmr
->
pﬁl_fd
, 
cmd
) < 0)

189  -
î∫o
;

191 
	}
}

193 
ssize_t
 
	$¢d_timî_hw_ªad
(
¢d_timî_t
 *
h™dÀ
, *
buf„r
, 
size_t
 
size
)

195 
¢d_timî_t
 *
tmr
;

196 
ssize_t
 
ªsu…
;

198 
tmr
 = 
h™dÀ
;

199 i‡(!
tmr
 || (!
buf„r
 && 
size
 > 0))

200  -
EINVAL
;

201 
ªsu…
 = 
	`ªad
(
tmr
->
pﬁl_fd
, 
buf„r
, 
size
);

202 i‡(
ªsu…
 < 0)

203  -
î∫o
;

204  
ªsu…
;

205 
	}
}

207 c⁄° 
¢d_timî_›s_t
 
	g¢d_timî_hw_›s
 = {

208 .
˛o£
 = 
¢d_timî_hw_˛o£
,

209 .
	gn⁄block
 = 
¢d_timî_hw_n⁄block
,

210 .
	gasync
 = 
¢d_timî_hw_async
,

211 .
	göfo
 = 
¢d_timî_hw_öfo
,

212 .
	g∑øms
 = 
¢d_timî_hw_∑øms
,

213 .
	g°©us
 = 
¢d_timî_hw_°©us
,

214 .
	gπ_°¨t
 = 
¢d_timî_hw_°¨t
,

215 .
	gπ_°›
 = 
¢d_timî_hw_°›
,

216 .
	gπ_c⁄töue
 = 
¢d_timî_hw_c⁄töue
,

217 .
	gªad
 = 
¢d_timî_hw_ªad
,

220 
	$¢d_timî_hw_›í
(
¢d_timî_t
 **
h™dÀ
, c⁄° *
«me
, 
dev_˛ass
, 
dev_s˛ass
, 
ˇrd
, 
devi˚
, 
subdevi˚
, 
mode
)

222 
fd
, 
vî
, 
tmode
, 
ªt
;

223 
¢d_timî_t
 *
tmr
;

224 
¢d_timî_£À˘
 
£l
;

226 *
h™dÀ
 = 
NULL
;

228 
tmode
 = 
O_RDONLY
;

229 i‡(
mode
 & 
SND_TIMER_OPEN_NONBLOCK
)

230 
tmode
 |
O_NONBLOCK
;

231 
fd
 = 
	`¢d_›í_devi˚
(
SNDRV_FILE_TIMER
, 
tmode
);

232 i‡(
fd
 < 0)

233  -
î∫o
;

234 i‡(
	`io˘l
(
fd
, 
SNDRV_TIMER_IOCTL_PVERSION
, &
vî
) < 0) {

235 
ªt
 = -
î∫o
;

236 
	`˛o£
(
fd
);

237  
ªt
;

239 i‡(
	`SNDRV_PROTOCOL_INCOMPATIBLE
(
vî
, 
SNDRV_TIMER_VERSION_MAX
)) {

240 
	`˛o£
(
fd
);

241  -
SND_ERROR_INCOMPATIBLE_VERSION
;

243 i‡(
mode
 & 
SND_TIMER_OPEN_TREAD
) {

244 
¨g
 = 1;

245 i‡(
vî
 < 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 3)) {

246 
ªt
 = -
ENOTTY
;

247 
__no_åód
;

249 i‡(
	`io˘l
(
fd
, 
SNDRV_TIMER_IOCTL_TREAD
, &
¨g
) < 0) {

250 
ªt
 = -
î∫o
;

251 
__no_åód
:

252 
	`˛o£
(
fd
);

253 
	`SNDMSG
("extendedÑead isÇot supported (SNDRV_TIMER_IOCTL_TREAD)");

254  
ªt
;

257 
	`mem£t
(&
£l
, 0, (sel));

258 
£l
.
id
.
dev_˛ass
 = dev_class;

259 
£l
.
id
.
dev_s˛ass
 = dev_sclass;

260 
£l
.
id
.
ˇrd
 = card;

261 
£l
.
id
.
devi˚
 = device;

262 
£l
.
id
.
subdevi˚
 = subdevice;

263 i‡(
	`io˘l
(
fd
, 
SNDRV_TIMER_IOCTL_SELECT
, &
£l
) < 0) {

264 
ªt
 = -
î∫o
;

265 
	`˛o£
(
fd
);

266  
ªt
;

268 
tmr
 = (
¢d_timî_t
 *Ë
	`ˇŒoc
(1, (snd_timer_t));

269 i‡(
tmr
 =
NULL
) {

270 
	`˛o£
(
fd
);

271  -
ENOMEM
;

273 
tmr
->
ty≥
 = 
SND_TIMER_TYPE_HW
;

274 
tmr
->
vîsi⁄
 = 
vî
;

275 
tmr
->
mode
 = 
tmode
;

276 
tmr
->
«me
 = 
	`°rdup
(name);

277 
tmr
->
pﬁl_fd
 = 
fd
;

278 
tmr
->
›s
 = &
¢d_timî_hw_›s
;

279 
	`INIT_LIST_HEAD
(&
tmr
->
async_h™dÀrs
);

280 *
h™dÀ
 = 
tmr
;

282 
	}
}

284 
	$_¢d_timî_hw_›í
(
¢d_timî_t
 **
timî
, *
«me
,

285 
¢d_c⁄fig_t
 *
roŸ
 
ATTRIBUTE_UNUSED
,

286 
¢d_c⁄fig_t
 *
c⁄f
, 
mode
)

288 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

289 
dev_˛ass
 = 
SND_TIMER_CLASS_GLOBAL
, 
dev_s˛ass
 = 
SND_TIMER_SCLASS_NONE
;

290 
ˇrd
 = 0, 
devi˚
 = 0, 
subdevi˚
 = 0;

291 
îr
;

292 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

293 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

294 c⁄° *
id
;

295 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

297 i‡(
	`_¢d_c⁄f_gíîic_id
(
id
))

299 i‡(
	`°rcmp
(
id
, "class") == 0) {

300 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
dev_˛ass
);

301 i‡(
îr
 < 0)

302  
îr
;

305 i‡(
	`°rcmp
(
id
, "sclass") == 0) {

306 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
dev_s˛ass
);

307 i‡(
îr
 < 0)

308  
îr
;

311 i‡(
	`°rcmp
(
id
, "card") == 0) {

312 
îr
 = 
	`¢d_c⁄fig_gë_ˇrd
(
n
);

313 i‡(
îr
 < 0)

314  
îr
;

315 
ˇrd
 = 
îr
;

318 i‡(
	`°rcmp
(
id
, "device") == 0) {

319 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
devi˚
);

320 i‡(
îr
 < 0)

321  
îr
;

324 i‡(
	`°rcmp
(
id
, "subdevice") == 0) {

325 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
subdevi˚
);

326 i‡(
îr
 < 0)

327  
îr
;

330 
	`SNDERR
("U√x≥˘ed fõld %s", 
id
);

331  -
EINVAL
;

333  
	`¢d_timî_hw_›í
(
timî
, 
«me
, 
dev_˛ass
, 
dev_s˛ass
, 
ˇrd
, 
devi˚
, 
subdevi˚
, 
mode
);

334 
	}
}

335 
SND_DLSYM_BUILD_VERSION
(
_¢d_timî_hw_›í
, 
SND_TIMER_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_local.h

22 
	~"loˇl.h
"

23 
	~<limôs.h
>

24 
	~<sys/io˘l.h
>

26 #i‚de‡
DOC_HIDDEN


28 (*
	m˛o£
)(
¢d_timî_t
 *
	mtimî
);

29 (*
	mn⁄block
)(
¢d_timî_t
 *
	mtimî
, nonblock);

30 (*
	masync
)(
¢d_timî_t
 *
	mtimî
, 
	msig
, 
pid_t
 
	mpid
);

31 (*
	möfo
)(
¢d_timî_t
 *
	mtimî
, 
¢d_timî_öfo_t
 *info);

32 (*
	m∑øms
)(
¢d_timî_t
 *
	mtimî
, 
¢d_timî_∑øms_t
 *params);

33 (*
	m°©us
)(
¢d_timî_t
 *
	mtimî
, 
¢d_timî_°©us_t
 *status);

34 (*
	mπ_°¨t
)(
¢d_timî_t
 *
	mtimî
);

35 (*
	mπ_°›
)(
¢d_timî_t
 *
	mtimî
);

36 (*
	mπ_c⁄töue
)(
¢d_timî_t
 *
	mtimî
);

37 
ssize_t
 (*
ªad
)(
¢d_timî_t
 *
	mtimî
, *
	mbuf„r
, 
size_t
 
	msize
);

38 } 
	t¢d_timî_›s_t
;

40 
	s_¢d_timî
 {

41 
	mvîsi⁄
;

42 *
	mdl_h™dÀ
;

43 *
	m«me
;

44 
¢d_timî_ty≥_t
 
	mty≥
;

45 
	mmode
;

46 
	mpﬁl_fd
;

47 c⁄° 
¢d_timî_›s_t
 *
	m›s
;

48 *
	m¥iv©e_d©a
;

49 
li°_hód
 
	masync_h™dÀrs
;

53 (*
	m˛o£
)(
¢d_timî_quîy_t
 *
	mtimî
);

54 (*
	m√xt_devi˚
)(
¢d_timî_quîy_t
 *
	mtimî
, 
¢d_timî_id_t
 *
	mtid
);

55 (*
	möfo
)(
¢d_timî_quîy_t
 *
	mtimî
, 
¢d_timî_göfo_t
 *info);

56 (*
	m∑øms
)(
¢d_timî_quîy_t
 *
	mtimî
, 
¢d_timî_g∑øms_t
 *
	möfo
);

57 (*
	m°©us
)(
¢d_timî_quîy_t
 *
	mtimî
, 
¢d_timî_g°©us_t
 *
	möfo
);

58 } 
	t¢d_timî_quîy_›s_t
;

60 
	s_¢d_timî_quîy
 {

61 *
	mdl_h™dÀ
;

62 *
	m«me
;

63 
¢d_timî_ty≥_t
 
	mty≥
;

64 
	mmode
;

65 
	mpﬁl_fd
;

66 c⁄° 
¢d_timî_quîy_›s_t
 *
	m›s
;

67 *
	m¥iv©e_d©a
;

71 
¢d_timî_hw_›í
(
¢d_timî_t
 **
h™dÀ
, c⁄° *
«me
, 
dev_˛ass
, 
dev_s˛ass
, 
ˇrd
, 
devi˚
, 
subdevi˚
, 
mode
);

73 
¢d_timî_quîy_hw_›í
(
¢d_timî_quîy_t
 **
h™dÀ
, c⁄° *
«me
, 
mode
);

75 
¢d_timî_async
(
¢d_timî_t
 *
timî
, 
sig
, 
pid_t
 
pid
);

77 #ifde‡
INTERNAL


78 
	$INTERNAL
(
¢d_timî_∑øms_£t_ex˛usive
)(
¢d_timî_∑øms_t
 * 
∑øms
, 
ex˛usive
);

79 
	$INTERNAL
(
¢d_timî_∑øms_gë_ex˛usive
)(
¢d_timî_∑øms_t
 * 
∑øms
);

80 
	$INTERNAL
(
¢d_timî_∑øms_£t_fûãr
)(
¢d_timî_∑øms_t
 * 
∑øms
, 
fûãr
);

81 
	$INTERNAL
(
¢d_timî_∑øms_gë_fûãr
)(
¢d_timî_∑øms_t
 * 
∑øms
);

82 
	$INTERNAL
(
¢d_timî_quîy_öfo
)(
¢d_timî_quîy_t
 *
timî
, 
¢d_timî_göfo_t
 *
öfo
);

83 
	$INTERNAL
(
¢d_timî_quîy_∑øms
)(
¢d_timî_quîy_t
 *
timî
, 
¢d_timî_g∑øms_t
 *
∑øms
);

84 
	$INTERNAL
(
¢d_timî_quîy_°©us
)(
¢d_timî_quîy_t
 *
timî
, 
¢d_timî_g°©us_t
 *
°©us
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_query.c

29 
	~"timî_loˇl.h
"

31 
	$¢d_timî_quîy_›í_c⁄f
(
¢d_timî_quîy_t
 **
timî
,

32 c⁄° *
«me
, 
¢d_c⁄fig_t
 *
timî_roŸ
,

33 
¢d_c⁄fig_t
 *
timî_c⁄f
, 
mode
)

35 c⁄° *
°r
;

36 
buf
[256], 
îrbuf
[256];

37 
îr
;

38 
¢d_c⁄fig_t
 *
c⁄f
, *
ty≥_c⁄f
 = 
NULL
;

39 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

40 c⁄° *
id
;

41 c⁄° *
lib
 = 
NULL
, *
›í_«me
 = NULL;

42 (*
›í_func
)(
¢d_timî_quîy_t
 **, c⁄° *, 
¢d_c⁄fig_t
 *, snd_c⁄fig_à*, Ë
NULL
;

43 #i‚de‡
PIC


44 *
	`¢d_timî_quîy_›í_symbﬁs
();

46 *
h
 = 
NULL
;

47 i‡(
	`¢d_c⁄fig_gë_ty≥
(
timî_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

48 i‡(
«me
)

49 
	`SNDERR
("InvÆidÅy≥ f‹ TIMER %†deföôi⁄", 
«me
);

51 
	`SNDERR
("InvalidÅype for TIMER definition");

52  -
EINVAL
;

54 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
timî_c⁄f
, "ty≥", &
c⁄f
);

55 i‡(
îr
 < 0) {

56 
	`SNDERR
("type isÇot defined");

57  
îr
;

59 
îr
 = 
	`¢d_c⁄fig_gë_id
(
c⁄f
, &
id
);

60 i‡(
îr
 < 0) {

61 
	`SNDERR
("unableÅo get id");

62  
îr
;

64 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
c⁄f
, &
°r
);

65 i‡(
îr
 < 0) {

66 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

67  
îr
;

69 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
timî_roŸ
, "timî_quîy_ty≥", 
°r
, &
ty≥_c⁄f
);

70 i‡(
îr
 >= 0) {

71 i‡(
	`¢d_c⁄fig_gë_ty≥
(
ty≥_c⁄f
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

72 
	`SNDERR
("InvÆidÅy≥ f‹ TIMERÅy≥ %†deföôi⁄", 
°r
);

73 
îr
 = -
EINVAL
;

74 
_îr
;

76 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
ty≥_c⁄f
) {

77 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

78 c⁄° *
id
;

79 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

81 i‡(
	`°rcmp
(
id
, "comment") == 0)

83 i‡(
	`°rcmp
(
id
, "lib") == 0) {

84 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
lib
);

85 i‡(
îr
 < 0) {

86 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

87 
_îr
;

91 i‡(
	`°rcmp
(
id
, "open") == 0) {

92 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
›í_«me
);

93 i‡(
îr
 < 0) {

94 
	`SNDERR
("InvÆidÅy≥ f‹ %s", 
id
);

95 
_îr
;

99 
	`SNDERR
("Unknow¿fõld %s", 
id
);

100 
îr
 = -
EINVAL
;

101 
_îr
;

104 i‡(!
›í_«me
) {

105 
›í_«me
 = 
buf
;

106 
	`¢¥ötf
(
buf
, (buf), "_¢d_timî_quîy_%s_›í", 
°r
);

108 #i‚de‡
PIC


109 
	`¢d_timî_quîy_›í_symbﬁs
();

111 
h
 = 
	`INTERNAL
(
¢d_dl›í
)(
lib
, 
RTLD_NOW
, 
îrbuf
, (errbuf));

112 i‡(
h
)

113 
›í_func
 = 
	`¢d_dlsym
(
h
, 
›í_«me
, 
	`SND_DLSYM_VERSION
(
SND_TIMER_QUERY_DLSYM_VERSION
));

114 
îr
 = 0;

115 i‡(!
h
) {

116 
	`SNDERR
("C™nŸ o≥¿sh¨edÜibøry %†(%s)", 
lib
, 
îrbuf
);

117 
îr
 = -
ENOENT
;

118 } i‡(!
›í_func
) {

119 
	`SNDERR
("symbﬁ %†i†nŸ deföed insidê%s", 
›í_«me
, 
lib
);

120 
	`¢d_dl˛o£
(
h
);

121 
îr
 = -
ENXIO
;

123 
_îr
:

124 i‡(
ty≥_c⁄f
)

125 
	`¢d_c⁄fig_dñëe
(
ty≥_c⁄f
);

126 i‡(! 
îr
) {

127 
îr
 = 
	`›í_func
(
timî
, 
«me
, 
timî_roŸ
, 
timî_c⁄f
, 
mode
);

128 i‡(
îr
 < 0)

129 
	`¢d_dl˛o£
(
h
);

131 (*
timî
)->
dl_h™dÀ
 = 
h
;

133  
îr
;

134 
	}
}

136 
	$¢d_timî_quîy_›í_noupd©e
(
¢d_timî_quîy_t
 **
timî
, 
¢d_c⁄fig_t
 *
roŸ
, c⁄° *
«me
, 
mode
)

138 
îr
;

139 
¢d_c⁄fig_t
 *
timî_c⁄f
;

140 
îr
 = 
	`¢d_c⁄fig_£¨ch_deföôi⁄
(
roŸ
, "timî_quîy", 
«me
, &
timî_c⁄f
);

141 i‡(
îr
 < 0) {

142 
	`SNDERR
("Unknow¿timî %s", 
«me
);

143  
îr
;

145 
îr
 = 
	`¢d_timî_quîy_›í_c⁄f
(
timî
, 
«me
, 
roŸ
, 
timî_c⁄f
, 
mode
);

146 
	`¢d_c⁄fig_dñëe
(
timî_c⁄f
);

147  
îr
;

148 
	}
}

160 
	$¢d_timî_quîy_›í
(
¢d_timî_quîy_t
 **
timî
, c⁄° *
«me
, 
mode
)

162 
¢d_c⁄fig_t
 *
t›
;

163 
îr
;

165 
	`as£π
(
timî
 && 
«me
);

166 
îr
 = 
	`¢d_c⁄fig_upd©e_ªf
(&
t›
);

167 i‡(
îr
 < 0)

168  
îr
;

169 
îr
 = 
	`¢d_timî_quîy_›í_noupd©e
(
timî
, 
t›
, 
«me
, 
mode
);

170 
	`¢d_c⁄fig_uƒef
(
t›
);

171  
îr
;

172 
	}
}

185 
	$¢d_timî_quîy_›í_lc⁄f
(
¢d_timî_quîy_t
 **
timî
, c⁄° *
«me
,

186 
mode
, 
¢d_c⁄fig_t
 *
lc⁄f
)

188 
	`as£π
(
timî
 && 
«me
 && 
lc⁄f
);

189  
	`¢d_timî_quîy_›í_noupd©e
(
timî
, 
lc⁄f
, 
«me
, 
mode
);

190 
	}
}

200 
	$¢d_timî_quîy_˛o£
(
¢d_timî_quîy_t
 *
timî
)

202 
îr
;

203 
	`as£π
(
timî
);

204 
îr
 = 
timî
->
›s
->
	`˛o£
(timer);

205 i‡(
timî
->
dl_h™dÀ
)

206 
	`¢d_dl˛o£
(
timî
->
dl_h™dÀ
);

207 
	`‰ì
(
timî
->
«me
);

208 
	`‰ì
(
timî
);

209  
îr
;

210 
	}
}

221 
	$¢d_timî_quîy_√xt_devi˚
(
¢d_timî_quîy_t
 *
timî
, 
¢d_timî_id_t
 *
tid
)

223 
	`as£π
(
timî
);

224 
	`as£π
(
tid
);

225  
timî
->
›s
->
	`√xt_devi˚
—imî, 
tid
);

226 
	}
}

232 
size_t
 
	$¢d_timî_göfo_sizeof
()

234  (
¢d_timî_göfo_t
);

235 
	}
}

245 
	$¢d_timî_göfo_mÆloc
(
¢d_timî_göfo_t
 **
öfo
)

247 
	`as£π
(
öfo
);

248 *
öfo
 = 
	`ˇŒoc
(1, (
¢d_timî_göfo_t
));

249 i‡(!*
öfo
)

250  -
ENOMEM
;

252 
	}
}

261 
	$¢d_timî_göfo_‰ì
(
¢d_timî_göfo_t
 *
öfo
)

263 
	`as£π
(
öfo
);

264 
	`‰ì
(
öfo
);

265 
	}
}

272 
	$¢d_timî_göfo_c›y
(
¢d_timî_göfo_t
 *
d°
, c⁄° snd_timî_göfo_à*
§c
)

274 
	`as£π
(
d°
 && 
§c
);

275 *
d°
 = *
§c
;

276 
	}
}

284 
	$¢d_timî_göfo_£t_tid
(
¢d_timî_göfo_t
 *
obj
, 
¢d_timî_id_t
 *
tid
)

286 
obj
->
tid
 = *((
¢d_timî_id_t
 *)tid);

288 
	}
}

295 
¢d_timî_id_t
 *
	$¢d_timî_göfo_gë_tid
(
¢d_timî_göfo_t
 *
obj
)

297  (
¢d_timî_id_t
 *)&
obj
->
tid
;

298 
	}
}

305 
	$¢d_timî_göfo_gë_Êags
(
¢d_timî_göfo_t
 *
obj
)

307  
obj
->
Êags
;

308 
	}
}

315 
	$¢d_timî_göfo_gë_ˇrd
(
¢d_timî_göfo_t
 *
obj
)

317  
obj
->
ˇrd
;

318 
	}
}

325 *
	$¢d_timî_göfo_gë_id
(
¢d_timî_göfo_t
 *
obj
)

327  (*)
obj
->
id
;

328 
	}
}

335 *
	$¢d_timî_göfo_gë_«me
(
¢d_timî_göfo_t
 *
obj
)

337  (*)
obj
->
«me
;

338 
	}
}

345 
	$¢d_timî_göfo_gë_ªsﬁuti⁄
(
¢d_timî_göfo_t
 *
obj
)

347  
obj
->
ªsﬁuti⁄
;

348 
	}
}

355 
	$¢d_timî_göfo_gë_ªsﬁuti⁄_mö
(
¢d_timî_göfo_t
 *
obj
)

357  
obj
->
ªsﬁuti⁄_mö
;

358 
	}
}

365 
	$¢d_timî_göfo_gë_ªsﬁuti⁄_max
(
¢d_timî_göfo_t
 *
obj
)

367  
obj
->
ªsﬁuti⁄_max
;

368 
	}
}

375 
	$¢d_timî_göfo_gë_˛õ¡s
(
¢d_timî_göfo_t
 *
obj
)

377  
obj
->
˛õ¡s
;

378 
	}
}

386 #i‚de‡
DOXYGEN


387 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_timî_quîy_öfo
)(
¢d_timî_quîy_t
 *
timî
, 
¢d_timî_göfo_t
 *
öfo
)

389 
	$¢d_timî_quîy_öfo
(
¢d_timî_quîy_t
 *
timî
, 
¢d_timî_göfo_t
 *
öfo
)

392 
	`as£π
(
timî
);

393 
	`as£π
(
öfo
);

394  
timî
->
›s
->
	`öfo
—imî, 
öfo
);

395 
	}
}

396 
u£_deÁu…_symbﬁ_vîsi⁄
(
__¢d_timî_quîy_öfo
, 
¢d_timî_quîy_öfo
, 
ALSA_0
.9.0);

404 #i‚de‡
DOXYGEN


405 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_timî_quîy_∑øms
)(
¢d_timî_quîy_t
 *
timî
, 
¢d_timî_g∑øms_t
 *
∑øms
)

407 
	$¢d_timî_quîy_∑øms
(
¢d_timî_quîy_t
 *
timî
, 
¢d_timî_g∑øms_t
 *
∑øms
)

410 
	`as£π
(
timî
);

411 
	`as£π
(
∑øms
);

412  
timî
->
›s
->
	`∑øms
—imî, 
∑øms
);

413 
	}
}

414 
u£_deÁu…_symbﬁ_vîsi⁄
(
__¢d_timî_quîy_∑øms
, 
¢d_timî_quîy_∑øms
, 
ALSA_0
.9.0);

422 #i‚de‡
DOXYGEN


423 
EXPORT_SYMBOL
 
	$INTERNAL
(
¢d_timî_quîy_°©us
)(
¢d_timî_quîy_t
 *
timî
, 
¢d_timî_g°©us_t
 *
°©us
)

425 
	$¢d_timî_quîy_°©us
(
¢d_timî_quîy_t
 *
timî
, 
¢d_timî_g°©us_t
 *
°©us
)

428 
	`as£π
(
timî
);

429 
	`as£π
(
°©us
);

430  
timî
->
›s
->
	`°©us
—imî, 
°©us
);

431 
	}
}

432 
u£_deÁu…_symbﬁ_vîsi⁄
(
__¢d_timî_quîy_°©us
, 
¢d_timî_quîy_°©us
, 
ALSA_0
.9.0);

438 
size_t
 
	$¢d_timî_id_sizeof
()

440  (
¢d_timî_id_t
);

441 
	}
}

451 
	$¢d_timî_id_mÆloc
(
¢d_timî_id_t
 **
öfo
)

453 
	`as£π
(
öfo
);

454 *
öfo
 = 
	`ˇŒoc
(1, (
¢d_timî_id_t
));

455 i‡(!*
öfo
)

456  -
ENOMEM
;

458 
	}
}

467 
	$¢d_timî_id_‰ì
(
¢d_timî_id_t
 *
öfo
)

469 
	`as£π
(
öfo
);

470 
	`‰ì
(
öfo
);

471 
	}
}

478 
	$¢d_timî_id_c›y
(
¢d_timî_id_t
 *
d°
, c⁄° snd_timî_id_à*
§c
)

480 
	`as£π
(
d°
 && 
§c
);

481 *
d°
 = *
§c
;

482 
	}
}

489 
	$¢d_timî_id_£t_˛ass
(
¢d_timî_id_t
 * 
tid
, 
dev_˛ass
)

491 
	`as£π
(
tid
);

492 
tid
->
dev_˛ass
 = dev_class;

493 
	}
}

500 
	$¢d_timî_id_gë_˛ass
(
¢d_timî_id_t
 * 
tid
)

502 
	`as£π
(
tid
);

503  
tid
->
dev_˛ass
;

504 
	}
}

511 
	$¢d_timî_id_£t_s˛ass
(
¢d_timî_id_t
 * 
tid
, 
dev_s˛ass
)

513 
	`as£π
(
tid
);

514 
tid
->
dev_s˛ass
 = dev_sclass;

515 
	}
}

522 
	$¢d_timî_id_gë_s˛ass
(
¢d_timî_id_t
 * 
tid
)

524 
	`as£π
(
tid
);

525  
tid
->
dev_s˛ass
;

526 
	}
}

533 
	$¢d_timî_id_£t_ˇrd
(
¢d_timî_id_t
 * 
tid
, 
ˇrd
)

535 
	`as£π
(
tid
);

536 
tid
->
ˇrd
 = card;

537 
	}
}

544 
	$¢d_timî_id_gë_ˇrd
(
¢d_timî_id_t
 * 
tid
)

546 
	`as£π
(
tid
);

547  
tid
->
ˇrd
;

548 
	}
}

555 
	$¢d_timî_id_£t_devi˚
(
¢d_timî_id_t
 * 
tid
, 
devi˚
)

557 
	`as£π
(
tid
);

558 
tid
->
devi˚
 = device;

559 
	}
}

566 
	$¢d_timî_id_gë_devi˚
(
¢d_timî_id_t
 * 
tid
)

568 
	`as£π
(
tid
);

569  
tid
->
devi˚
;

570 
	}
}

577 
	$¢d_timî_id_£t_subdevi˚
(
¢d_timî_id_t
 * 
tid
, 
subdevi˚
)

579 
	`as£π
(
tid
);

580 
tid
->
subdevi˚
 = subdevice;

581 
	}
}

588 
	$¢d_timî_id_gë_subdevi˚
(
¢d_timî_id_t
 * 
tid
)

590 
	`as£π
(
tid
);

591  
tid
->
subdevi˚
;

592 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_query_hw.c

22 
	~"timî_loˇl.h
"

24 #i‚de‡
PIC


26 c⁄° *
	g_¢d_moduÀ_timî_quîy_hw
 = "";

29 
	#SNDRV_FILE_TIMER
 
ALSA_DEVICE_DIRECTORY
 "timî"

	)

30 
	#SNDRV_TIMER_VERSION_MAX
 
	`SNDRV_PROTOCOL_VERSION
(2, 0, 0)

	)

32 
	$¢d_timî_quîy_hw_˛o£
(
¢d_timî_quîy_t
 *
h™dÀ
)

34 
ªs
;

36 i‡(!
h™dÀ
)

37  -
EINVAL
;

38 
ªs
 = 
	`˛o£
(
h™dÀ
->
pﬁl_fd
Ë< 0 ? -
î∫o
 : 0;

39  
ªs
;

40 
	}
}

42 
	$¢d_timî_quîy_hw_√xt_devi˚
(
¢d_timî_quîy_t
 *
h™dÀ
, 
¢d_timî_id_t
 * 
tid
)

44 i‡(!
h™dÀ
 || !
tid
)

45  -
EINVAL
;

46 i‡(
	`io˘l
(
h™dÀ
->
pﬁl_fd
, 
SNDRV_TIMER_IOCTL_NEXT_DEVICE
, 
tid
) < 0)

47  -
î∫o
;

49 
	}
}

51 
	$¢d_timî_quîy_hw_öfo
(
¢d_timî_quîy_t
 *
h™dÀ
, 
¢d_timî_göfo_t
 *
öfo
)

53 i‡(!
h™dÀ
 || !
öfo
)

54  -
EINVAL
;

55 i‡(
	`io˘l
(
h™dÀ
->
pﬁl_fd
, 
SNDRV_TIMER_IOCTL_GINFO
, 
öfo
) < 0)

56  -
î∫o
;

58 
	}
}

60 
	$¢d_timî_quîy_hw_∑øms
(
¢d_timî_quîy_t
 *
h™dÀ
, 
¢d_timî_g∑øms_t
 *
∑øms
)

62 i‡(!
h™dÀ
 || !
∑øms
)

63  -
EINVAL
;

64 i‡(
	`io˘l
(
h™dÀ
->
pﬁl_fd
, 
SNDRV_TIMER_IOCTL_GPARAMS
, 
∑øms
) < 0)

65  -
î∫o
;

67 
	}
}

69 
	$¢d_timî_quîy_hw_°©us
(
¢d_timî_quîy_t
 *
h™dÀ
, 
¢d_timî_g°©us_t
 *
°©us
)

71 i‡(!
h™dÀ
 || !
°©us
)

72  -
EINVAL
;

73 i‡(
	`io˘l
(
h™dÀ
->
pﬁl_fd
, 
SNDRV_TIMER_IOCTL_GSTATUS
, 
°©us
) < 0)

74  -
î∫o
;

76 
	}
}

78 c⁄° 
¢d_timî_quîy_›s_t
 
	g¢d_timî_quîy_hw_›s
 = {

79 .
˛o£
 = 
¢d_timî_quîy_hw_˛o£
,

80 .
	g√xt_devi˚
 = 
¢d_timî_quîy_hw_√xt_devi˚
,

81 .
	göfo
 = 
¢d_timî_quîy_hw_öfo
,

82 .
	g∑øms
 = 
¢d_timî_quîy_hw_∑øms
,

83 .
	g°©us
 = 
¢d_timî_quîy_hw_°©us


86 
	$¢d_timî_quîy_hw_›í
(
¢d_timî_quîy_t
 **
h™dÀ
, c⁄° *
«me
, 
mode
)

88 
fd
, 
vî
, 
tmode
;

89 
¢d_timî_quîy_t
 *
tmr
;

91 *
h™dÀ
 = 
NULL
;

93 
tmode
 = 
O_RDONLY
;

94 i‡(
mode
 & 
SND_TIMER_OPEN_NONBLOCK
)

95 
tmode
 |
O_NONBLOCK
;

96 
fd
 = 
	`¢d_›í_devi˚
(
SNDRV_FILE_TIMER
, 
tmode
);

97 i‡(
fd
 < 0)

98  -
î∫o
;

99 i‡(
	`io˘l
(
fd
, 
SNDRV_TIMER_IOCTL_PVERSION
, &
vî
) < 0) {

100 
	`˛o£
(
fd
);

101  -
î∫o
;

103 i‡(
	`SNDRV_PROTOCOL_INCOMPATIBLE
(
vî
, 
SNDRV_TIMER_VERSION_MAX
)) {

104 
	`˛o£
(
fd
);

105  -
SND_ERROR_INCOMPATIBLE_VERSION
;

107 
tmr
 = (
¢d_timî_quîy_t
 *Ë
	`ˇŒoc
(1, (snd_timer_query_t));

108 i‡(
tmr
 =
NULL
) {

109 
	`˛o£
(
fd
);

110  -
ENOMEM
;

112 
tmr
->
ty≥
 = 
SND_TIMER_TYPE_HW
;

113 
tmr
->
mode
 = 
tmode
;

114 
tmr
->
«me
 = 
	`°rdup
(name);

115 
tmr
->
pﬁl_fd
 = 
fd
;

116 
tmr
->
›s
 = &
¢d_timî_quîy_hw_›s
;

117 *
h™dÀ
 = 
tmr
;

119 
	}
}

121 
	$_¢d_timî_quîy_hw_›í
(
¢d_timî_quîy_t
 **
timî
, *
«me
,

122 
¢d_c⁄fig_t
 *
roŸ
 
ATTRIBUTE_UNUSED
,

123 
¢d_c⁄fig_t
 *
c⁄f
, 
mode
)

125 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

126 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄f
) {

127 
¢d_c⁄fig_t
 *
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

128 c⁄° *
id
;

129 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

131 i‡(
	`_¢d_c⁄f_gíîic_id
(
id
))

133 
	`SNDERR
("U√x≥˘ed fõld %s", 
id
);

134  -
EINVAL
;

136  
	`¢d_timî_quîy_hw_›í
(
timî
, 
«me
, 
mode
);

137 
	}
}

138 
SND_DLSYM_BUILD_VERSION
(
_¢d_timî_quîy_hw_›í
, 
SND_TIMER_QUERY_DLSYM_VERSION
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_symbols.c

21 #i‚de‡
PIC


23 c⁄° *
_¢d_moduÀ_timî_hw
;

25 c⁄° **
	g¢d_timî_›í_obje˘s
[] = {

26 &
_¢d_moduÀ_timî_hw


29 *
	$¢d_timî_›í_symbﬁs
()

31  (*)
¢d_timî_›í_obje˘s
[0];

32 
	}
}

35 c⁄° *
_¢d_moduÀ_timî_quîy_hw
;

37 c⁄° **
	g¢d_timî_quîy_›í_obje˘s
[] = {

38 &
_¢d_moduÀ_timî_quîy_hw


41 *
	$¢d_timî_quîy_›í_symbﬁs
()

43  
¢d_timî_quîy_›í_obje˘s
;

44 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/builder.c

20 
	~"çlg_loˇl.h
"

23 
ssize_t
 
	$twrôe
(
¢d_çlg_t
 *
çlg
, *
d©a
, 
size_t
 
d©a_size
)

25 i‡(
çlg
->
bö_pos
 + 
d©a_size
 >Å∂g->
bö_size
)

26  -
EIO
;

27 
	`mem˝y
(
çlg
->
bö
 +Å∂g->
bö_pos
, 
d©a
, 
d©a_size
);

28 
çlg
->
bö_pos
 +
d©a_size
;

29  
d©a_size
;

30 
	}
}

33 
ssize_t
 
	$wrôe_block_hódî
(
¢d_çlg_t
 *
çlg
, 
ty≥
,

34 
víd‹_ty≥
,

35 
vîsi⁄
, 
ödex
,

36 
size_t
 
∑ylﬂd_size
, 
cou¡
)

38 
¢d_soc_çlg_hdr
 
hdr
;

40 
	`mem£t
(&
hdr
, 0, (hdr));

41 
hdr
.
magic
 = 
SND_SOC_TPLG_MAGIC
;

42 
hdr
.
abi
 = 
SND_SOC_TPLG_ABI_VERSION
;

43 
hdr
.
ty≥
 =Åype;

44 
hdr
.
víd‹_ty≥
 = vendor_type;

45 
hdr
.
vîsi⁄
 = version;

46 
hdr
.
∑ylﬂd_size
 =Öayload_size;

47 
hdr
.
ödex
 = index;

48 
hdr
.
size
 = (hdr);

49 
hdr
.
cou¡
 = count;

52 i‡(
çlg
->
bö_pos
 !çlg->
√xt_hdr_pos
) {

53 
	`SNDERR
("New header isát offset 0x%zx but file"

55 
çlg
->
√xt_hdr_pos
,Å∂g->
bö_pos
,

56 
çlg
->
bö_pos
 >Å∂g->
√xt_hdr_pos
 ? "ahead" : "behind",

57 
çlg
->
bö_pos
 -Å∂g->
√xt_hdr_pos
);

58  -
EINVAL
;

61 
	`çlg_log
(
çlg
, 'B',Å∂g->
bö_pos
,

63 "vîsi⁄ %d", 
ödex
, 
ty≥
, 
cou¡
,

64 ()
∑ylﬂd_size
, ()payload_size,

65 
víd‹_ty≥
, 
vîsi⁄
);

67 
çlg
->
√xt_hdr_pos
 +
hdr
.
∑ylﬂd_size
 + (hdr);

69  
	`twrôe
(
çlg
, &
hdr
, (hdr));

70 
	}
}

72 
	$wrôe_ñem_block
(
¢d_çlg_t
 *
çlg
,

73 
li°_hód
 *
ba£
, 
size_t
 
size
,

74 
çlg_ty≥
, c⁄° *
obj_«me
)

76 
li°_hód
 *
pos
, *
sub_pos
, *
sub_ba£
;

77 
çlg_ñem
 *
ñem
, *
ñem_√xt
;

78 
size_t
 
tŸÆ_size
 = 0, 
cou¡
 = 0, 
block_size
 = 0;

79 
ssize_t
 
ªt
, 
wsize
;

81 
sub_ba£
 = 
ba£
;

82 
	`li°_f‹_óch
(
pos
, 
ba£
) {

84 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

86 i‡(
ñem
->
compound_ñem
)

89 
ñem_√xt
 = 
	`li°_íåy
(
pos
->
√xt
, 
çlg_ñem
, 
li°
);

90 
block_size
 +
ñem
->
size
;

91 
cou¡
++;

93 i‡((
pos
->
√xt
 =
ba£
Ë|| (
ñem_√xt
->
ödex
 !
ñem
->index)) {

95 
ªt
 = 
	`wrôe_block_hódî
(
çlg
, 
çlg_ty≥
, 
ñem
->
víd‹_ty≥
,

96 
çlg
->
vîsi⁄
, 
ñem
->
ödex
, 
block_size
, 
cou¡
);

97 i‡(
ªt
 < 0) {

98 
	`SNDERR
("failedÅo write %s block %d",

99 
obj_«me
, 
ªt
);

100  
ªt
;

104 
	`li°_f‹_óch
(
sub_pos
, 
sub_ba£
) {

105 
ñem
 = 
	`li°_íåy
(
sub_pos
, 
çlg_ñem
, 
li°
);

107 i‡(
ñem
->
compound_ñem
)

110 i‡(
ñem
->
ty≥
 !
SND_TPLG_TYPE_DAPM_GRAPH
)

111 
	`çlg_log
(
çlg
, 'B',Å∂g->
bö_pos
,

113 
obj_«me
, 
ñem
->
id
,ÉÀm->
size
);

115 
	`çlg_log
(
çlg
, 'B',Å∂g->
bö_pos
,

117 
obj_«me
, 
ñem
->
rouã
->
sour˚
,

118 
ñem
->
rouã
->
c⁄åﬁ
,

119 
ñem
->
rouã
->
sök
,ÉÀm->
size
);

121 
wsize
 = 
	`twrôe
(
çlg
, 
ñem
->
obj
,ÉÀm->
size
);

122 i‡(
wsize
 < 0)

123  
size
;

125 
tŸÆ_size
 +
wsize
;

127 i‡(
sub_pos
 =
pos
)

132 
sub_ba£
 = 
pos
;

133 
cou¡
 = 0;

134 
block_size
 = 0;

139 i‡(
tŸÆ_size
 !
size
) {

140 
	`SNDERR
("size mismatch. Expected %zu wrote %zu",

141 
size
, 
tŸÆ_size
);

142  -
EIO
;

146 
	}
}

148 
size_t
 
	$ˇlc_m™i„°_size
(
¢d_çlg_t
 *
çlg
)

150  (
¢d_soc_çlg_hdr
) +

151 (
çlg
->
m™i„°
) +

152 
çlg
->
m™i„°
.
¥iv
.
size
;

153 
	}
}

155 
size_t
 
	$ˇlc_ªÆ_size
(
li°_hód
 *
ba£
)

157 
li°_hód
 *
pos
;

158 
çlg_ñem
 *
ñem
, *
ñem_√xt
;

159 
size_t
 
size
 = 0;

161 
	`li°_f‹_óch
(
pos
, 
ba£
) {

163 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

166 i‡(
ñem
->
compound_ñem
)

169 i‡(
ñem
->
size
 <= 0)

172 
size
 +
ñem
->size;

174 
ñem_√xt
 = 
	`li°_íåy
(
pos
->
√xt
, 
çlg_ñem
, 
li°
);

176 i‡((
pos
->
√xt
 =
ba£
Ë|| (
ñem_√xt
->
ödex
 !
ñem
->index))

177 
size
 +(
¢d_soc_çlg_hdr
);

180  
size
;

181 
	}
}

183 
size_t
 
	$ˇlc_block_size
(
li°_hód
 *
ba£
)

185 
li°_hód
 *
pos
;

186 
çlg_ñem
 *
ñem
;

187 
size_t
 
size
 = 0;

189 
	`li°_f‹_óch
(
pos
, 
ba£
) {

191 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

194 i‡(
ñem
->
compound_ñem
)

197 
size
 +
ñem
->size;

200  
size
;

201 
	}
}

204 
ssize_t
 
	$wrôe_m™i„°_d©a
(
¢d_çlg_t
 *
çlg
)

206 
ssize_t
 
ªt
;

209 
ªt
 = 
	`wrôe_block_hódî
(
çlg
, 
SND_SOC_TPLG_TYPE_MANIFEST
, 0,

210 
çlg
->
vîsi⁄
, 0,

211 (
çlg
->
m™i„°
Ë+Å∂g->m™i„°.
¥iv
.
size
, 1);

212 i‡(
ªt
 < 0) {

213 
	`SNDERR
("failedÅo write manifest block");

214  
ªt
;

217 
	`çlg_log
(
çlg
, 'B',Å∂g->
bö_pos
, "manifest: write %d bytes",

218 (
çlg
->
m™i„°
));

219 
ªt
 = 
	`twrôe
(
çlg
, &çlg->
m™i„°
, (tplg->manifest));

220 i‡(
ªt
 >= 0) {

221 
	`çlg_log
(
çlg
, 'B',Å∂g->
bö_pos
,

223 
çlg
->
m™i„°
.
¥iv
.
size
);

224 
ªt
 = 
	`twrôe
(
çlg
,Å∂g->
m™i„°_pd©a
,Å∂g->
m™i„°
.
¥iv
.
size
);

226  
ªt
;

227 
	}
}

229 
	$çlg_wrôe_d©a
(
¢d_çlg_t
 *
çlg
)

231 
çlg_èbÀ
 *
çå
;

232 
li°_hód
 *
li°
;

233 
ssize_t
 
ªt
;

234 
size_t
 
tŸÆ_size
, 
size
;

235 
ödex
;

238 
tŸÆ_size
 = 
	`ˇlc_m™i„°_size
(
çlg
);

239 
ödex
 = 0; index < 
çlg_èbÀ_ôems
; index++) {

240 
çå
 = &
çlg_èbÀ
[
ödex
];

241 i‡(!
çå
->
buûd
)

243 
li°
 = (
li°_hód
 *)((*)
çlg
 + 
çå
->
loff
);

244 
size
 = 
	`ˇlc_ªÆ_size
(
li°
);

245 
tŸÆ_size
 +
size
;

249 
	`‰ì
(
çlg
->
bö
);

250 
çlg
->
bö
 = 
	`mÆloc
(
tŸÆ_size
);

251 
çlg
->
bö_pos
 = 0;

252 
çlg
->
bö_size
 = 
tŸÆ_size
;

253 i‡(
çlg
->
bö
 =
NULL
) {

254 
çlg
->
bö_size
 = 0;

255  -
ENOMEM
;

259 
ªt
 = 
	`wrôe_m™i„°_d©a
(
çlg
);

260 i‡(
ªt
 < 0) {

261 
	`SNDERR
("ÁûedÅÿwrôêm™i„° %d", 
ªt
);

262  
ªt
;

266 
ödex
 = 0; index < 
çlg_èbÀ_ôems
; index++) {

267 
çå
 = &
çlg_èbÀ
[
ödex
];

268 i‡(!
çå
->
buûd
)

270 
li°
 = (
li°_hód
 *)((*)
çlg
 + 
çå
->
loff
);

272 
size
 = 
	`ˇlc_block_size
(
li°
);

273 i‡(
size
 == 0)

275 
	`çlg_log
(
çlg
, 'B',Å∂g->
bö_pos
,

277 
çå
->
«me
,Å±r->
ty≥
,

278 
çå
->
tsoc
, 
size
, size);

279 
ªt
 = 
	`wrôe_ñem_block
(
çlg
, 
li°
, 
size
,

280 
çå
->
tsoc
,Å±r->
«me
);

281 i‡(
ªt
 < 0) {

282 
	`SNDERR
("failedÅo write %sÉlements: %s",

283 
çå
->
«me
, 
	`¢d_°ªº‹
(-
ªt
));

284  
ªt
;

288 
	`çlg_log
(
çlg
, 'B',Å∂g->
bö_pos
, "total size is 0x%zx/%zd",

289 
çlg
->
bö_pos
,Åplg->bin_pos);

291 i‡(
tŸÆ_size
 !
çlg
->
bö_pos
) {

292 
	`SNDERR
("total size mismatch (%zd != %zd)",

293 
tŸÆ_size
, 
çlg
->
bö_pos
);

294  -
EINVAL
;

298 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/channel.c

20 
	~"çlg_loˇl.h
"

23 c⁄° 
m≠_ñem
 
	gch™√l_m≠
[] = {

24 {"m⁄o", 
SNDRV_CHMAP_MONO
},

25 {"Ê", 
SNDRV_CHMAP_FL
},

26 {"‰", 
SNDRV_CHMAP_FR
},

27 {"æ", 
SNDRV_CHMAP_RL
},

28 {"º", 
SNDRV_CHMAP_RR
},

29 {"fc", 
SNDRV_CHMAP_FC
},

30 {"l„", 
SNDRV_CHMAP_LFE
},

31 {"¶", 
SNDRV_CHMAP_SL
},

32 {"§", 
SNDRV_CHMAP_SR
},

33 {"rc", 
SNDRV_CHMAP_RC
},

34 {"Êc", 
SNDRV_CHMAP_FLC
},

35 {"‰c", 
SNDRV_CHMAP_FRC
},

36 {"æc", 
SNDRV_CHMAP_RLC
},

37 {"ºc", 
SNDRV_CHMAP_RRC
},

38 {"Êw", 
SNDRV_CHMAP_FLW
},

39 {"‰w", 
SNDRV_CHMAP_FRW
},

40 {"Êh", 
SNDRV_CHMAP_FLH
},

41 {"fch", 
SNDRV_CHMAP_FCH
},

42 {"‰h", 
SNDRV_CHMAP_FRH
},

43 {"tc", 
SNDRV_CHMAP_TC
},

44 {"tÊ", 
SNDRV_CHMAP_TFL
},

45 {"t‰", 
SNDRV_CHMAP_TFR
},

46 {"tfc", 
SNDRV_CHMAP_TFC
},

47 {"ål", 
SNDRV_CHMAP_TRL
},

48 {"år", 
SNDRV_CHMAP_TRR
},

49 {"åc", 
SNDRV_CHMAP_TRC
},

50 {"tÊc", 
SNDRV_CHMAP_TFLC
},

51 {"t‰c", 
SNDRV_CHMAP_TFRC
},

52 {"t¶", 
SNDRV_CHMAP_TSL
},

53 {"t§", 
SNDRV_CHMAP_TSR
},

54 {"Œ„", 
SNDRV_CHMAP_LLFE
},

55 {"æ„", 
SNDRV_CHMAP_RLFE
},

56 {"bc", 
SNDRV_CHMAP_BC
},

57 {"blc", 
SNDRV_CHMAP_BLC
},

58 {"brc", 
SNDRV_CHMAP_BRC
},

62 
	$lookup_ch™√l
(c⁄° *
c
)

64 
i
;

66 
i
 = 0; i < 
	`ARRAY_SIZE
(
ch™√l_m≠
); i++) {

67 i‡(
	`°rˇ£cmp
(
ch™√l_m≠
[
i
].
«me
, 
c
) == 0) {

68  
ch™√l_m≠
[
i
].
id
;

72  -
EINVAL
;

73 
	}
}

75 c⁄° *
	$çlg_ch™√l_«me
(
ty≥
)

77 
i
;

79 
i
 = 0; i < 
	`ARRAY_SIZE
(
ch™√l_m≠
); i++) {

80 i‡(
ch™√l_m≠
[
i
].
id
 =
ty≥
)

81  
ch™√l_m≠
[
i
].
«me
;

84  
NULL
;

85 
	}
}

88 
	$çlg_∑r£_ch™√l
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

89 *
¥iv©e
)

91 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

92 
¢d_c⁄fig_t
 *
n
;

93 
¢d_soc_çlg_ch™√l
 *
ch™√l
 = 
¥iv©e
;

94 c⁄° *
id
;

95 
ch™√l_id
, 
vÆue
;

97 i‡(
çlg
->
ch™√l_idx
 >
SND_SOC_TPLG_MAX_CHAN
)

98  -
EINVAL
;

100 
ch™√l
 +
çlg
->
ch™√l_idx
;

101 
	`¢d_c⁄fig_gë_id
(
cfg
, &
id
);

102 
	`çlg_dbg
("\tCh™√»%†© index %d", 
id
, 
çlg
->
ch™√l_idx
);

104 
ch™√l_id
 = 
	`lookup_ch™√l
(
id
);

105 i‡(
ch™√l_id
 < 0) {

106 
	`SNDERR
("övÆid ch™√»%s", 
id
);

107  -
EINVAL
;

110 
ch™√l
->
id
 = 
ch™√l_id
;

111 
ch™√l
->
size
 = (*channel);

112 
	`çlg_dbg
("\tCh™ %†%d", 
id
, 
ch™√l
->id);

114 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

116 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

119 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

123 i‡(
	`çlg_gë_öãgî
(
n
, &
vÆue
, 0) < 0)

126 i‡(
	`°rcmp
(
id
, "reg") == 0)

127 
ch™√l
->
ªg
 = 
vÆue
;

128 i‡(
	`°rcmp
(
id
, "shift") == 0)

129 
ch™√l
->
shi·
 = 
vÆue
;

131 
	`çlg_dbg
("\t\t%†%d", 
id
, 
vÆue
);

134 
çlg
->
ch™√l_idx
++;

136 
	}
}

138 
	$çlg_ßve_ch™√ls
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

139 
¢d_soc_çlg_ch™√l
 *
ch™√l
,

140 
cou¡
, 
çlg_buf
 *
d°
,

141 c⁄° *
pfx
)

143 
¢d_soc_çlg_ch™√l
 *
c
;

144 c⁄° *
s
;

145 
ödex
;

146 
îr
;

148 i‡(
cou¡
 == 0)

150 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "channel {\n");

151 
ödex
 = 0; 
îr
 >0 && index < 
cou¡
; index++) {

152 
c
 = 
ch™√l
 + 
ödex
;

153 
s
 = 
	`çlg_ch™√l_«me
(
c
->
id
);

154 i‡(
s
 =
NULL
)

155 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t%u", 
c
->
id
);

157 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t%s", 
s
);

158 i‡(
îr
 >= 0)

159 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, " {\n");

160 i‡(
îr
 >= 0)

161 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t\åeg %d\n", 
c
->
ªg
);

162 i‡(
îr
 >0 && 
c
->
shi·
 > 0)

163 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t\tshi· %u\n", 
c
->
shi·
);

164 i‡(
îr
 >= 0)

165 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t}\n");

167 i‡(
îr
 >= 0)

168 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

169  
îr
;

170 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/ctl.c

20 
	~"çlg_loˇl.h
"

22 #i‚de‡
DOC_HIDDEN


23 
	#ENUM_VAL_SIZE
 (
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
 >> 2)

	)

25 
	s˘l_ac˚ss_ñem
 {

26 c⁄° *
	m«me
;

27 
	mvÆue
;

33 c⁄° 
˘l_ac˚ss_ñem
 
	g˘l_ac˚ss
[] = {

34 {"ªad_wrôe", 
SNDRV_CTL_ELEM_ACCESS_READWRITE
},

35 {"év_ªad_wrôe", 
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
},

36 {"ªad", 
SNDRV_CTL_ELEM_ACCESS_READ
},

37 {"wrôe", 
SNDRV_CTL_ELEM_ACCESS_WRITE
},

38 {"vﬁ©ûe", 
SNDRV_CTL_ELEM_ACCESS_VOLATILE
},

39 {"év_ªad", 
SNDRV_CTL_ELEM_ACCESS_TLV_READ
},

40 {"év_wrôe", 
SNDRV_CTL_ELEM_ACCESS_TLV_WRITE
},

41 {"év_comm™d", 
SNDRV_CTL_ELEM_ACCESS_TLV_COMMAND
},

42 {"öa˘ive", 
SNDRV_CTL_ELEM_ACCESS_INACTIVE
},

43 {"lock", 
SNDRV_CTL_ELEM_ACCESS_LOCK
},

44 {"ow√r", 
SNDRV_CTL_ELEM_ACCESS_OWNER
},

45 {"év_ˇŒback", 
SNDRV_CTL_ELEM_ACCESS_TLV_CALLBACK
},

49 
	$∑r£_ac˚ss_vÆues
(
¢d_c⁄fig_t
 *
cfg
,

50 
¢d_soc_çlg_˘l_hdr
 *
hdr
)

52 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

53 
¢d_c⁄fig_t
 *
n
;

54 c⁄° *
vÆue
 = 
NULL
;

55 
j
;

57 
	`çlg_dbg
(" Access:");

59 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

60 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

63 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆue
) < 0)

67 
j
 = 0; j < 
	`ARRAY_SIZE
(
˘l_ac˚ss
); j++) {

68 i‡(
	`°rcmp
(
vÆue
, 
˘l_ac˚ss
[
j
].
«me
) == 0) {

69 
hdr
->
ac˚ss
 |
˘l_ac˚ss
[
j
].
vÆue
;

70 
	`çlg_dbg
("\t%s", 
vÆue
);

77 
	}
}

80 
	$∑r£_ac˚ss
(
¢d_c⁄fig_t
 *
cfg
,

81 
¢d_soc_çlg_˘l_hdr
 *
hdr
)

83 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

84 
¢d_c⁄fig_t
 *
n
;

85 c⁄° *
id
;

86 
îr
 = 0;

88 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

90 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

91 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

94 i‡(
	`°rcmp
(
id
, "access") == 0) {

95 
îr
 = 
	`∑r£_ac˚ss_vÆues
(
n
, 
hdr
);

96 i‡(
îr
 < 0) {

97 
	`SNDERR
("failedÅoÖarseáccess");

98  
îr
;

104  
îr
;

105 
	}
}

108 
	$çlg_ßve_ac˚ss
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

109 
¢d_soc_çlg_˘l_hdr
 *
hdr
,

110 
çlg_buf
 *
d°
, c⁄° *
pfx
)

112 c⁄° *
œ°
;

113 
j
, 
cou¡
, 
ac˚ss
, 
cvÆ
;

114 
îr
;

116 i‡(
hdr
->
ac˚ss
 == 0)

119 
ac˚ss
 = 
hdr
->access;

120 
j
 = 0, 
cou¡
 = 0, 
œ°
 = 
NULL
; j < 
	`ARRAY_SIZE
(
˘l_ac˚ss
); j++) {

121 
cvÆ
 = 
˘l_ac˚ss
[
j
].
vÆue
;

122 i‡((
ac˚ss
 & 
cvÆ
) == cval) {

123 
ac˚ss
 &~
cvÆ
;

124 
œ°
 = 
˘l_ac˚ss
[
j
].
«me
;

125 
cou¡
++;

128 i‡(
cou¡
 == 1)

129  
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "ac˚ss.0 %s\n", 
œ°
);

130 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "access [\n");

131 i‡(
îr
 < 0)

132  
îr
;

133 
ac˚ss
 = 
hdr
->access;

134 
j
 = 0; j < 
	`ARRAY_SIZE
(
˘l_ac˚ss
); j++) {

135 
cvÆ
 = 
˘l_ac˚ss
[
j
].
vÆue
;

136 i‡((
ac˚ss
 & 
cvÆ
) == cval) {

137 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t%s\n",

138 
˘l_ac˚ss
[
j
].
«me
);

139 i‡(
îr
 < 0)

140  
îr
;

141 
ac˚ss
 &~
cvÆ
;

144  
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "]\n");

145 
	}
}

148 
	$c›y_év
(
çlg_ñem
 *
ñem
, çlg_ñem *
ªf
)

150 
¢d_soc_çlg_mixî_c⁄åﬁ
 *
mixî_˘æ
 = 
ñem
->mixer_ctrl;

151 
¢d_soc_çlg_˘l_év
 *
év
 = 
ªf
->tlv;

153 
	`çlg_dbg
("TLV '%s' u£d by '%s", 
ªf
->
id
, 
ñem
->id);

156 
mixî_˘æ
->
hdr
.
év
 = *tlv;

158 
	}
}

161 
	$çlg_buûd_mixî_c⁄åﬁ
(
¢d_çlg_t
 *
çlg
,

162 
çlg_ñem
 *
ñem
)

164 
çlg_ªf
 *
ªf
;

165 
li°_hód
 *
ba£
, *
pos
;

166 
îr
 = 0;

168 
ba£
 = &
ñem
->
ªf_li°
;

171 
	`li°_f‹_óch
(
pos
, 
ba£
) {

173 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

174 i‡(
ªf
->
ñem
)

177 i‡(
ªf
->
ty≥
 =
SND_TPLG_TYPE_TLV
) {

178 
ªf
->
ñem
 = 
	`çlg_ñem_lookup
(&
çlg
->
év_li°
,

179 
ªf
->
id
, 
SND_TPLG_TYPE_TLV
, 
ñem
->
ödex
);

180 i‡(
ªf
->
ñem
)

181 
îr
 = 
	`c›y_év
(
ñem
, 
ªf
->elem);

183 } i‡(
ªf
->
ty≥
 =
SND_TPLG_TYPE_DATA
) {

184 
îr
 = 
	`çlg_c›y_d©a
(
çlg
, 
ñem
, 
ªf
);

185 i‡(
îr
 < 0)

186  
îr
;

189 i‡(!
ªf
->
ñem
) {

190 
	`SNDERR
("cannot find '%s'Ñeferenced by"

191 " c⁄åﬁ '%s'", 
ªf
->
id
, 
ñem
->id);

192  -
EINVAL
;

193 } i‡(
îr
 < 0)

194  
îr
;

198 
	}
}

200 
	$c›y_íum_ãxts
(
çlg_ñem
 *
íum_ñem
,

201 
çlg_ñem
 *
ªf_ñem
)

203 
¢d_soc_çlg_íum_c⁄åﬁ
 *
ec
 = 
íum_ñem
->
íum_˘æ
;

204 
çlg_ãxts
 *
ãxts
 = 
ªf_ñem
->texts;

206 
	`mem˝y
(
ec
->
ãxts
,Åexts->
ôems
,

207 
SND_SOC_TPLG_NUM_TEXTS
 * 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

208 
ec
->
ôems
 +
ãxts
->
num_ôems
;

209 
	}
}

212 
	$çlg_buûd_íum_c⁄åﬁ
(
¢d_çlg_t
 *
çlg
,

213 
çlg_ñem
 *
ñem
)

215 
çlg_ªf
 *
ªf
;

216 
li°_hód
 *
ba£
, *
pos
;

217 
îr
;

219 
ba£
 = &
ñem
->
ªf_li°
;

221 
	`li°_f‹_óch
(
pos
, 
ba£
) {

223 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

224 i‡(
ªf
->
ñem
)

227 i‡(
ªf
->
ty≥
 =
SND_TPLG_TYPE_TEXT
) {

228 
ªf
->
ñem
 = 
	`çlg_ñem_lookup
(&
çlg
->
ãxt_li°
,

229 
ªf
->
id
, 
SND_TPLG_TYPE_TEXT
, 
ñem
->
ödex
);

230 i‡(
ªf
->
ñem
)

231 
	`c›y_íum_ãxts
(
ñem
, 
ªf
->elem);

233 } i‡(
ªf
->
ty≥
 =
SND_TPLG_TYPE_DATA
) {

234 
îr
 = 
	`çlg_c›y_d©a
(
çlg
, 
ñem
, 
ªf
);

235 i‡(
îr
 < 0)

236  
îr
;

238 i‡(!
ªf
->
ñem
) {

239 
	`SNDERR
("cannot find '%s'Ñeferenced by"

240 " c⁄åﬁ '%s'", 
ªf
->
id
, 
ñem
->id);

241  -
EINVAL
;

246 
	}
}

249 
	$çlg_buûd_byãs_c⁄åﬁ
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
)

251 
çlg_ªf
 *
ªf
;

252 
li°_hód
 *
ba£
, *
pos
;

253 
îr
;

255 
ba£
 = &
ñem
->
ªf_li°
;

257 
	`li°_f‹_óch
(
pos
, 
ba£
) {

259 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

260 i‡(
ªf
->
ñem
)

263 i‡(
ªf
->
ty≥
 =
SND_TPLG_TYPE_DATA
) {

264 
îr
 = 
	`çlg_c›y_d©a
(
çlg
, 
ñem
, 
ªf
);

265 i‡(
îr
 < 0)

266  
îr
;

271 
	}
}

273 
	$çlg_buûd_c⁄åﬁs
(
¢d_çlg_t
 *
çlg
)

275 
li°_hód
 *
ba£
, *
pos
;

276 
çlg_ñem
 *
ñem
;

277 
îr
 = 0;

279 
ba£
 = &
çlg
->
mixî_li°
;

280 
	`li°_f‹_óch
(
pos
, 
ba£
) {

282 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

283 
îr
 = 
	`çlg_buûd_mixî_c⁄åﬁ
(
çlg
, 
ñem
);

284 i‡(
îr
 < 0)

285  
îr
;

288 
çlg
->
m™i„°
.
c⁄åﬁ_ñems
++;

291 
ba£
 = &
çlg
->
íum_li°
;

292 
	`li°_f‹_óch
(
pos
, 
ba£
) {

294 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

295 
îr
 = 
	`çlg_buûd_íum_c⁄åﬁ
(
çlg
, 
ñem
);

296 i‡(
îr
 < 0)

297  
îr
;

300 
çlg
->
m™i„°
.
c⁄åﬁ_ñems
++;

303 
ba£
 = &
çlg
->
byãs_ext_li°
;

304 
	`li°_f‹_óch
(
pos
, 
ba£
) {

306 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

307 
îr
 = 
	`çlg_buûd_byãs_c⁄åﬁ
(
çlg
, 
ñem
);

308 i‡(
îr
 < 0)

309  
îr
;

312 
çlg
->
m™i„°
.
c⁄åﬁ_ñems
++;

316 
	}
}

324 
	$çlg_∑r£_év_dbsˇÀ
(
¢d_c⁄fig_t
 *
cfg
, 
çlg_ñem
 *
ñem
)

326 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

327 
¢d_c⁄fig_t
 *
n
;

328 
¢d_soc_çlg_˘l_év
 *
çlg_év
 = 
ñem
->
év
;

329 
¢d_soc_çlg_év_dbsˇÀ
 *
sˇÀ
;

330 c⁄° *
id
 = 
NULL
;

331 
vÆ
;

333 
	`çlg_dbg
(" sˇÀ: %s", 
ñem
->
id
);

335 
çlg_év
->
size
 = (
¢d_soc_çlg_˘l_év
);

336 
çlg_év
->
ty≥
 = 
SNDRV_CTL_TLVT_DB_SCALE
;

337 
sˇÀ
 = &
çlg_év
->scale;

339 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

341 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

344 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

345  -
EINVAL
;

348 i‡(
	`çlg_gë_öãgî
(
n
, &
vÆ
, 0))

351 
	`çlg_dbg
("\t%†%i", 
id
, 
vÆ
);

354 i‡(
	`°rcmp
(
id
, "min") == 0)

355 
sˇÀ
->
mö
 = 
vÆ
;

356 i‡(
	`°rcmp
(
id
, "step") == 0)

357 
sˇÀ
->
°ï
 = 
vÆ
;

358 i‡(
	`°rcmp
(
id
, "mute") == 0)

359 
sˇÀ
->
muã
 = 
vÆ
;

361 
	`SNDERR
("unknow¿id '%s'", 
id
);

365 
	}
}

368 
	$çlg_∑r£_év
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

369 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

371 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

372 
¢d_c⁄fig_t
 *
n
;

373 c⁄° *
id
;

374 
îr
 = 0;

375 
çlg_ñem
 *
ñem
;

377 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_TLV
);

378 i‡(!
ñem
)

379  -
ENOMEM
;

381 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

383 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

384 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

387 i‡(
	`°rcmp
(
id
, "scale") == 0) {

388 
îr
 = 
	`çlg_∑r£_év_dbsˇÀ
(
n
, 
ñem
);

389 i‡(
îr
 < 0) {

390 
	`SNDERR
("failedÅo DBScale");

391  
îr
;

397  
îr
;

398 
	}
}

401 
	$çlg_ßve_év
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

402 
çlg_ñem
 *
ñem
,

403 
çlg_buf
 *
d°
, c⁄° *
pfx
)

405 
¢d_soc_çlg_˘l_év
 *
év
 = 
ñem
->tlv;

406 
¢d_soc_çlg_év_dbsˇÀ
 *
sˇÀ
;

407 
îr
;

409 i‡(
év
->
ty≥
 !
SNDRV_CTL_TLVT_DB_SCALE
) {

410 
	`SNDERR
("unknown TLVÅype");

411  -
EINVAL
;

414 
sˇÀ
 = &
év
->scale;

415 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s' {\n", 
ñem
->
id
);

416 i‡(
îr
 >= 0)

417 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tscale {\n");

418 i‡(
îr
 >0 && 
sˇÀ
->
mö
)

419 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t\tmö %i\n", 
sˇÀ
->
mö
);

420 i‡(
îr
 >0 && 
sˇÀ
->
°ï
 > 0)

421 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t\t°ï %i\n", 
sˇÀ
->
°ï
);

422 i‡(
îr
 >0 && 
sˇÀ
->
muã
 > 0)

423 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t\tmuã %i\n", 
sˇÀ
->
muã
);

424 i‡(
îr
 >= 0)

425 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t}\n");

426 i‡(
îr
 >= 0)

427 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

428  
îr
;

429 
	}
}

432 
	$çlg_∑r£_c⁄åﬁ_byãs
(
¢d_çlg_t
 *
çlg
,

433 
¢d_c⁄fig_t
 *
cfg
,

434 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

436 
¢d_soc_çlg_byãs_c⁄åﬁ
 *
be
;

437 
çlg_ñem
 *
ñem
;

438 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

439 
¢d_c⁄fig_t
 *
n
;

440 c⁄° *
id
, *
vÆ
 = 
NULL
;

441 
îr
, 
ivÆ
;

442 
boﬁ
 
ac˚ss_£t
 = 
Ál£
, 
év_£t
 = false;

444 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_BYTES
);

445 i‡(!
ñem
)

446  -
ENOMEM
;

448 
be
 = 
ñem
->
byãs_ext
;

449 
be
->
size
 = 
ñem
->size;

450 
	`¢d_°æ˝y
(
be
->
hdr
.
«me
, 
ñem
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

451 
be
->
hdr
.
ty≥
 = 
SND_SOC_TPLG_TYPE_BYTES
;

453 
	`çlg_dbg
(" C⁄åﬁ Byãs: %s", 
ñem
->
id
);

455 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

456 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

457 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

461 i‡(
	`°rcmp
(
id
, "comment") == 0)

463 i‡(
id
[0] == '#')

466 i‡(
	`°rcmp
(
id
, "base") == 0) {

467 i‡(
	`çlg_gë_öãgî
(
n
, &
ivÆ
, 0))

468  -
EINVAL
;

470 
be
->
ba£
 = 
ivÆ
;

471 
	`çlg_dbg
("\t%s: %d", 
id
, 
be
->
ba£
);

475 i‡(
	`°rcmp
(
id
, "num_regs") == 0) {

476 i‡(
	`çlg_gë_öãgî
(
n
, &
ivÆ
, 0))

477  -
EINVAL
;

479 
be
->
num_ªgs
 = 
ivÆ
;

480 
	`çlg_dbg
("\t%s: %d", 
id
, 
be
->
num_ªgs
);

484 i‡(
	`°rcmp
(
id
, "max") == 0) {

485 i‡(
	`çlg_gë_öãgî
(
n
, &
ivÆ
, 0))

486  -
EINVAL
;

488 
be
->
max
 = 
ivÆ
;

489 
	`çlg_dbg
("\t%s: %d", 
id
, 
be
->
max
);

493 i‡(
	`°rcmp
(
id
, "mask") == 0) {

494 i‡(
	`çlg_gë_öãgî
(
n
, &
ivÆ
, 16))

495  -
EINVAL
;

497 
be
->
mask
 = 
ivÆ
;

498 
	`çlg_dbg
("\t%s: %d", 
id
, 
be
->
mask
);

502 i‡(
	`°rcmp
(
id
, "data") == 0) {

503 
îr
 = 
	`çlg_∑r£_ªfs
(
n
, 
ñem
, 
SND_TPLG_TYPE_DATA
);

504 i‡(
îr
 < 0)

505  
îr
;

509 i‡(
	`°rcmp
(
id
, "tlv") == 0) {

510 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆ
) < 0)

511  -
EINVAL
;

513 
îr
 = 
	`çlg_ªf_add
(
ñem
, 
SND_TPLG_TYPE_TLV
, 
vÆ
);

514 i‡(
îr
 < 0)

515  
îr
;

517 
év_£t
 = 
åue
;

518 
	`çlg_dbg
("\t%s: %s", 
id
, 
vÆ
);

522 i‡(
	`°rcmp
(
id
, "ops") == 0) {

523 
îr
 = 
	`çlg_∑r£_compound
(
çlg
, 
n
, 
çlg_∑r£_›s
,

524 &
be
->
hdr
);

525 i‡(
îr
 < 0)

526  
îr
;

530 i‡(
	`°rcmp
(
id
, "extops") == 0) {

531 
îr
 = 
	`çlg_∑r£_compound
(
çlg
, 
n
, 
çlg_∑r£_ext_›s
,

532 
be
);

533 i‡(
îr
 < 0)

534  
îr
;

538 i‡(
	`°rcmp
(
id
, "access") == 0) {

539 
îr
 = 
	`∑r£_ac˚ss
(
cfg
, &
be
->
hdr
);

540 i‡(
îr
 < 0)

541  
îr
;

542 
ac˚ss_£t
 = 
åue
;

548 i‡(!
ac˚ss_£t
) {

550 
be
->
hdr
.
ac˚ss
 = 
SNDRV_CTL_ELEM_ACCESS_READWRITE
;

551 i‡(
év_£t
)

552 
be
->
hdr
.
ac˚ss
 |
SNDRV_CTL_ELEM_ACCESS_TLV_READ
;

556 
	}
}

559 
	$çlg_ßve_c⁄åﬁ_byãs
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

560 
çlg_ñem
 *
ñem
,

561 
çlg_buf
 *
d°
, c⁄° *
pfx
)

563 
¢d_soc_çlg_byãs_c⁄åﬁ
 *
be
 = 
ñem
->
byãs_ext
;

564 
pfx2
[16];

565 
îr
;

567 i‡(!
be
)

570 
	`¢¥ötf
(
pfx2
, ’fx2), "%s\t", 
pfx
 ?: "");

571 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s' {\n", 
ñem
->
id
);

572 i‡(
îr
 < 0)

573  
îr
;

574 i‡(
îr
 >0 && 
ñem
->
ödex
 > 0)

575 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tödex %u\n", 
ñem
->
ödex
);

576 i‡(
îr
 >0 && 
be
->
ba£
 > 0)

577 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tba£ %u\n", 
be
->
ba£
);

578 i‡(
îr
 >0 && 
be
->
num_ªgs
 > 0)

579 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\äum_ªg†%u\n", 
be
->
num_ªgs
);

580 i‡(
îr
 >0 && 
be
->
max
 > 0)

581 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tmax %u\n", 
be
->
max
);

582 i‡(
îr
 >0 && 
be
->
mask
 > 0)

583 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tmask %u\n", 
be
->
mask
);

584 i‡(
îr
 >= 0)

585 
îr
 = 
	`çlg_ßve_›s
(
çlg
, &
be
->
hdr
, 
d°
, 
pfx2
);

586 i‡(
îr
 >= 0)

587 
îr
 = 
	`çlg_ßve_ext_›s
(
çlg
, 
be
, 
d°
, 
pfx2
);

588 i‡(
îr
 >= 0)

589 
îr
 = 
	`çlg_ßve_ac˚ss
(
çlg
, &
be
->
hdr
, 
d°
, 
pfx2
);

590 i‡(
îr
 >= 0)

591 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_TLV
,

592 "év", 
d°
, 
pfx2
);

593 i‡(
îr
 >= 0)

594 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_DATA
,

595 "d©a", 
d°
, 
pfx2
);

596 i‡(
îr
 >= 0)

597 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

598  
îr
;

599 
	}
}

602 
	$çlg_∑r£_c⁄åﬁ_íum
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

603 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

605 
¢d_soc_çlg_íum_c⁄åﬁ
 *
ec
;

606 
çlg_ñem
 *
ñem
;

607 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

608 
¢d_c⁄fig_t
 *
n
;

609 c⁄° *
id
, *
vÆ
 = 
NULL
;

610 
îr
, 
j
;

611 
boﬁ
 
ac˚ss_£t
 = 
Ál£
;

613 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_ENUM
);

614 i‡(!
ñem
)

615  -
ENOMEM
;

617 
ec
 = 
ñem
->
íum_˘æ
;

618 
	`¢d_°æ˝y
(
ec
->
hdr
.
«me
, 
ñem
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

619 
ec
->
hdr
.
ty≥
 = 
SND_SOC_TPLG_TYPE_ENUM
;

620 
ec
->
size
 = 
ñem
->size;

621 
çlg
->
ch™√l_idx
 = 0;

624 
j
 = 0; j < 
SND_SOC_TPLG_MAX_CHAN
; j++) {

625 
ec
->
ch™√l
[
j
].
ªg
 = -1;

628 
	`çlg_dbg
(" C⁄åﬁ Enum: %s", 
ñem
->
id
);

630 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

632 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

633 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

637 i‡(
	`°rcmp
(
id
, "comment") == 0)

639 i‡(
id
[0] == '#')

642 i‡(
	`°rcmp
(
id
, "texts") == 0) {

643 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆ
) < 0)

644  -
EINVAL
;

646 
	`çlg_ªf_add
(
ñem
, 
SND_TPLG_TYPE_TEXT
, 
vÆ
);

647 
	`çlg_dbg
("\t%s: %s", 
id
, 
vÆ
);

651 i‡(
	`°rcmp
(
id
, "channel") == 0) {

652 i‡(
ec
->
num_ch™√ls
 >
SND_SOC_TPLG_MAX_CHAN
) {

653 
	`SNDERR
("toÿm™y ch™√l†%s", 
ñem
->
id
);

654  -
EINVAL
;

657 
îr
 = 
	`çlg_∑r£_compound
(
çlg
, 
n
, 
çlg_∑r£_ch™√l
,

658 
ec
->
ch™√l
);

659 i‡(
îr
 < 0)

660  
îr
;

662 
ec
->
num_ch™√ls
 = 
çlg
->
ch™√l_idx
;

666 i‡(
	`°rcmp
(
id
, "ops") == 0) {

667 
îr
 = 
	`çlg_∑r£_compound
(
çlg
, 
n
, 
çlg_∑r£_›s
,

668 &
ec
->
hdr
);

669 i‡(
îr
 < 0)

670  
îr
;

674 i‡(
	`°rcmp
(
id
, "data") == 0) {

675 
îr
 = 
	`çlg_∑r£_ªfs
(
n
, 
ñem
, 
SND_TPLG_TYPE_DATA
);

676 i‡(
îr
 < 0)

677  
îr
;

681 i‡(
	`°rcmp
(
id
, "access") == 0) {

682 
îr
 = 
	`∑r£_ac˚ss
(
cfg
, &
ec
->
hdr
);

683 i‡(
îr
 < 0)

684  
îr
;

685 
ac˚ss_£t
 = 
åue
;

691 i‡(!
ac˚ss_£t
) {

692 
ec
->
hdr
.
ac˚ss
 = 
SNDRV_CTL_ELEM_ACCESS_READWRITE
;

696 
	}
}

699 
	$çlg_ßve_c⁄åﬁ_íum
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

700 
çlg_ñem
 *
ñem
,

701 
çlg_buf
 *
d°
, c⁄° *
pfx
)

703 
¢d_soc_çlg_íum_c⁄åﬁ
 *
ec
 = 
ñem
->
íum_˘æ
;

704 
pfx2
[16];

705 
îr
;

707 i‡(!
ec
)

710 
	`¢¥ötf
(
pfx2
, ’fx2), "%s\t", 
pfx
 ?: "");

711 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s' {\n", 
ñem
->
id
);

712 i‡(
îr
 < 0)

713  
îr
;

714 i‡(
îr
 >0 && 
ñem
->
ödex
 > 0)

715 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tödex %u\n", 
ñem
->
ödex
);

716 i‡(
îr
 >= 0)

717 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_TEXT
,

718 "ãxts", 
d°
, 
pfx2
);

719 i‡(
îr
 >= 0)

720 
îr
 = 
	`çlg_ßve_ch™√ls
(
çlg
, 
ec
->
ch™√l
,Éc->
num_ch™√ls
,

721 
d°
, 
pfx2
);

722 i‡(
îr
 >= 0)

723 
îr
 = 
	`çlg_ßve_›s
(
çlg
, &
ec
->
hdr
, 
d°
, 
pfx2
);

724 i‡(
îr
 >= 0)

725 
îr
 = 
	`çlg_ßve_ac˚ss
(
çlg
, &
ec
->
hdr
, 
d°
, 
pfx2
);

726 i‡(
îr
 >= 0)

727 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_DATA
,

728 "d©a", 
d°
, 
pfx2
);

729 i‡(
îr
 >= 0)

730 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

731  
îr
;

732 
	}
}

738 
	$çlg_∑r£_c⁄åﬁ_mixî
(
¢d_çlg_t
 *
çlg
,

739 
¢d_c⁄fig_t
 *
cfg
,

740 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

742 
¢d_soc_çlg_mixî_c⁄åﬁ
 *
mc
;

743 
çlg_ñem
 *
ñem
;

744 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

745 
¢d_c⁄fig_t
 *
n
;

746 c⁄° *
id
, *
vÆ
 = 
NULL
;

747 
îr
, 
j
, 
ivÆ
;

748 
boﬁ
 
ac˚ss_£t
 = 
Ál£
, 
év_£t
 = false;

750 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_MIXER
);

751 i‡(!
ñem
)

752  -
ENOMEM
;

755 
mc
 = 
ñem
->
mixî_˘æ
;

756 
	`¢d_°æ˝y
(
mc
->
hdr
.
«me
, 
ñem
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

757 
mc
->
hdr
.
ty≥
 = 
SND_SOC_TPLG_TYPE_MIXER
;

758 
mc
->
size
 = 
ñem
->size;

759 
çlg
->
ch™√l_idx
 = 0;

762 
j
 = 0; j < 
SND_SOC_TPLG_MAX_CHAN
; j++)

763 
mc
->
ch™√l
[
j
].
ªg
 = -1;

765 
	`çlg_dbg
(" C⁄åﬁ Mixî: %s", 
ñem
->
id
);

768 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

769 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

770 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

774 i‡(
	`°rcmp
(
id
, "comment") == 0)

776 i‡(
id
[0] == '#')

779 i‡(
	`°rcmp
(
id
, "channel") == 0) {

780 i‡(
mc
->
num_ch™√ls
 >
SND_SOC_TPLG_MAX_CHAN
) {

781 
	`SNDERR
("toÿm™y ch™√l†%s", 
ñem
->
id
);

782  -
EINVAL
;

785 
îr
 = 
	`çlg_∑r£_compound
(
çlg
, 
n
, 
çlg_∑r£_ch™√l
,

786 
mc
->
ch™√l
);

787 i‡(
îr
 < 0)

788  
îr
;

790 
mc
->
num_ch™√ls
 = 
çlg
->
ch™√l_idx
;

794 i‡(
	`°rcmp
(
id
, "max") == 0) {

795 i‡(
	`çlg_gë_öãgî
(
n
, &
ivÆ
, 0))

796  -
EINVAL
;

798 
mc
->
max
 = 
ivÆ
;

799 
	`çlg_dbg
("\t%s: %d", 
id
, 
mc
->
max
);

803 i‡(
	`°rcmp
(
id
, "invert") == 0) {

804 
ivÆ
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

805 i‡(
ivÆ
 < 0)

806  -
EINVAL
;

807 
mc
->
övît
 = 
ivÆ
;

809 
	`çlg_dbg
("\t%s: %d", 
id
, 
mc
->
övît
);

813 i‡(
	`°rcmp
(
id
, "ops") == 0) {

814 
îr
 = 
	`çlg_∑r£_compound
(
çlg
, 
n
, 
çlg_∑r£_›s
,

815 &
mc
->
hdr
);

816 i‡(
îr
 < 0)

817  
îr
;

821 i‡(
	`°rcmp
(
id
, "tlv") == 0) {

822 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆ
) < 0)

823  -
EINVAL
;

825 
îr
 = 
	`çlg_ªf_add
(
ñem
, 
SND_TPLG_TYPE_TLV
, 
vÆ
);

826 i‡(
îr
 < 0)

827  
îr
;

829 
év_£t
 = 
åue
;

830 
	`çlg_dbg
("\t%s: %s", 
id
, 
vÆ
);

834 i‡(
	`°rcmp
(
id
, "data") == 0) {

835 
îr
 = 
	`çlg_∑r£_ªfs
(
n
, 
ñem
, 
SND_TPLG_TYPE_DATA
);

836 i‡(
îr
 < 0)

837  
îr
;

841 i‡(
	`°rcmp
(
id
, "access") == 0) {

842 
îr
 = 
	`∑r£_ac˚ss
(
cfg
, &
mc
->
hdr
);

843 i‡(
îr
 < 0)

844  
îr
;

845 
ac˚ss_£t
 = 
åue
;

851 i‡(!
ac˚ss_£t
) {

853 
mc
->
hdr
.
ac˚ss
 = 
SNDRV_CTL_ELEM_ACCESS_READWRITE
;

854 i‡(
év_£t
)

855 
mc
->
hdr
.
ac˚ss
 |
SNDRV_CTL_ELEM_ACCESS_TLV_READ
;

859 
	}
}

861 
	$çlg_ßve_c⁄åﬁ_mixî
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

862 
çlg_ñem
 *
ñem
,

863 
çlg_buf
 *
d°
, c⁄° *
pfx
)

865 
¢d_soc_çlg_mixî_c⁄åﬁ
 *
mc
 = 
ñem
->
mixî_˘æ
;

866 
pfx2
[16];

867 
îr
;

869 i‡(!
mc
)

871 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s' {\n", 
ñem
->
id
);

872 i‡(
îr
 < 0)

873  
îr
;

874 
	`¢¥ötf
(
pfx2
, ’fx2), "%s\t", 
pfx
 ?: "");

875 i‡(
îr
 >0 && 
ñem
->
ödex
 > 0)

876 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tödex %u\n", 
ñem
->
ödex
);

877 i‡(
îr
 >= 0)

878 
îr
 = 
	`çlg_ßve_ch™√ls
(
çlg
, 
mc
->
ch™√l
, mc->
num_ch™√ls
,

879 
d°
, 
pfx2
);

880 i‡(
îr
 >0 && 
mc
->
max
 > 0)

881 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tmax %u\n", 
mc
->
max
);

882 i‡(
îr
 >0 && 
mc
->
övît
 > 0)

883 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tinvert 1\n");

884 i‡(
îr
 >0 && 
mc
->
övît
 > 0)

885 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tinvert 1\n");

886 i‡(
îr
 >= 0)

887 
îr
 = 
	`çlg_ßve_›s
(
çlg
, &
mc
->
hdr
, 
d°
, 
pfx2
);

888 i‡(
îr
 >= 0)

889 
îr
 = 
	`çlg_ßve_ac˚ss
(
çlg
, &
mc
->
hdr
, 
d°
, 
pfx2
);

890 i‡(
îr
 >= 0)

891 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_TLV
,

892 "év", 
d°
, 
pfx2
);

893 i‡(
îr
 >= 0)

894 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_DATA
,

895 "d©a", 
d°
, 
pfx2
);

896 i‡(
îr
 >= 0)

897 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

898  
îr
;

899 
	}
}

901 
	$öô_˘l_hdr
(
¢d_çlg_t
 *
çlg
,

902 
çlg_ñem
 *
∑ª¡
,

903 
¢d_soc_çlg_˘l_hdr
 *
hdr
,

904 
¢d_çlg_˘l_ãm∂©e
 *
t
)

906 
çlg_ñem
 *
ñem
;

907 
îr
;

909 
hdr
->
size
 = (
¢d_soc_çlg_˘l_hdr
);

910 
hdr
->
ty≥
 = 
t
->type;

912 
	`¢d_°æ˝y
(
hdr
->
«me
, 
t
->«me, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

915 i‡(
t
->
ac˚ss
 == 0)

916 
t
->
ac˚ss
 = 
SNDRV_CTL_ELEM_ACCESS_READWRITE
;

917 
t
->
ac˚ss
 &(
SNDRV_CTL_ELEM_ACCESS_READWRITE
 |

918 
SNDRV_CTL_ELEM_ACCESS_VOLATILE
 |

919 
SNDRV_CTL_ELEM_ACCESS_INACTIVE
 |

920 
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
 |

921 
SNDRV_CTL_ELEM_ACCESS_TLV_COMMAND
 |

922 
SNDRV_CTL_ELEM_ACCESS_TLV_CALLBACK
);

924 
hdr
->
ac˚ss
 = 
t
->access;

925 
hdr
->
›s
.
gë
 = 
t
->ops.get;

926 
hdr
->
›s
.
put
 = 
t
->ops.put;

927 
hdr
->
›s
.
öfo
 = 
t
->ops.info;

930 i‡(
hdr
->
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE


931 && !(
hdr
->
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_CALLBACK
)) {

933 
¢d_çlg_év_ãm∂©e
 *
évt
 = 
t
->
év
;

934 
¢d_soc_çlg_˘l_év
 *
év
;

935 
¢d_çlg_év_dbsˇÀ_ãm∂©e
 *
sˇÀt
;

936 
¢d_soc_çlg_év_dbsˇÀ
 *
sˇÀ
;

938 i‡(!
évt
) {

939 
	`SNDERR
("missing TLV data");

940  -
EINVAL
;

943 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
, 
∑ª¡
->
id
,

944 
SND_TPLG_TYPE_TLV
);

945 i‡(!
ñem
)

946  -
ENOMEM
;

948 
év
 = 
ñem
->tlv;

950 
îr
 = 
	`çlg_ªf_add
(
∑ª¡
, 
SND_TPLG_TYPE_TLV
,Ö¨ít->
id
);

951 i‡(
îr
 < 0)

952  
îr
;

954 
év
->
size
 = (
¢d_soc_çlg_˘l_év
);

955 
év
->
ty≥
 = 
évt
->type;

957 
évt
->
ty≥
) {

958 
SNDRV_CTL_TLVT_DB_SCALE
:

959 
sˇÀt
 = 
	`c⁄èöî_of
(
évt
,

960 
¢d_çlg_év_dbsˇÀ_ãm∂©e
, 
hdr
);

961 
sˇÀ
 = &
év
->scale;

962 
sˇÀ
->
mö
 = 
sˇÀt
->min;

963 
sˇÀ
->
°ï
 = 
sˇÀt
->step;

964 
sˇÀ
->
muã
 = 
sˇÀt
->mute;

969 
	`SNDERR
("unsuµ‹ãd TLVÅy≥ %d", 
év
->
ty≥
);

975 
	}
}

977 
	$çlg_add_mixî
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_mixî_ãm∂©e
 *
mixî
,

978 
çlg_ñem
 **
e
)

980 
¢d_soc_çlg_mixî_c⁄åﬁ
 *
mc
;

981 
¢d_soc_çlg_¥iv©e
 *
¥iv
;

982 
çlg_ñem
 *
ñem
;

983 
ªt
, 
i
, 
num_ch™√ls
;

985 
	`çlg_dbg
(" C⁄åﬁ Mixî: %s", 
mixî
->
hdr
.
«me
);

987 i‡(
mixî
->
hdr
.
ty≥
 !
SND_SOC_TPLG_TYPE_MIXER
) {

988 
	`SNDERR
("övÆid mixîÅy≥ %d", 
mixî
->
hdr
.
ty≥
);

989  -
EINVAL
;

992 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
, 
mixî
->
hdr
.
«me
,

993 
SND_TPLG_TYPE_MIXER
);

994 i‡(!
ñem
)

995  -
ENOMEM
;

998 
mc
 = 
ñem
->
mixî_˘æ
;

999 
mc
->
size
 = 
ñem
->size;

1000 
ªt
 = 
	`öô_˘l_hdr
(
çlg
, 
ñem
, &
mc
->
hdr
, &
mixî
->hdr);

1001 i‡(
ªt
 < 0) {

1002 
	`çlg_ñem_‰ì
(
ñem
);

1003  
ªt
;

1006 
mc
->
mö
 = 
mixî
->min;

1007 
mc
->
max
 = 
mixî
->max;

1008 
mc
->
∂©f‹m_max
 = 
mixî
->platform_max;

1009 
mc
->
övît
 = 
mixî
->invert;

1012 
i
 = 0; i < 
SND_SOC_TPLG_MAX_CHAN
; i++)

1013 
mc
->
ch™√l
[
i
].
ªg
 = -1;

1015 
num_ch™√ls
 = 
mixî
->
m≠
 ? mixer->map->num_channels : 0;

1016 
mc
->
num_ch™√ls
 =Çum_channels;

1018 
i
 = 0; i < 
num_ch™√ls
; i++) {

1019 
¢d_çlg_ch™√l_ñem
 *
ch™√l
 = &
mixî
->
m≠
->ch™√l[
i
];

1021 
mc
->
ch™√l
[
i
].
size
 = (mc->channel[0]);

1022 
mc
->
ch™√l
[
i
].
ªg
 = channel->reg;

1023 
mc
->
ch™√l
[
i
].
shi·
 = channel->shift;

1024 
mc
->
ch™√l
[
i
].
id
 = channel->id;

1028 
¥iv
 = 
mixî
->priv;

1029 i‡(
¥iv
 &&Öriv->
size
 > 0) {

1030 
ªt
 = 
	`çlg_add_d©a
(
çlg
, 
ñem
, 
¥iv
,

1031 (*
¥iv
Ë+Öriv->
size
);

1032 i‡(
ªt
 < 0)

1033  
ªt
;

1036 i‡(
e
)

1037 *
e
 = 
ñem
;

1039 
	}
}

1041 
	$çlg_add_íum
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_íum_ãm∂©e
 *
íum_˘l
,

1042 
çlg_ñem
 **
e
)

1044 
¢d_soc_çlg_íum_c⁄åﬁ
 *
ec
;

1045 
¢d_soc_çlg_¥iv©e
 *
¥iv
;

1046 
çlg_ñem
 *
ñem
;

1047 
ªt
, 
i
, 
num_ôems
, 
num_ch™√ls
;

1049 
	`çlg_dbg
(" C⁄åﬁ Enum: %s", 
íum_˘l
->
hdr
.
«me
);

1051 i‡(
íum_˘l
->
hdr
.
ty≥
 !
SND_SOC_TPLG_TYPE_ENUM
) {

1052 
	`SNDERR
("övÆidÉnumÅy≥ %d", 
íum_˘l
->
hdr
.
ty≥
);

1053  -
EINVAL
;

1056 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
, 
íum_˘l
->
hdr
.
«me
,

1057 
SND_TPLG_TYPE_ENUM
);

1058 i‡(!
ñem
)

1059  -
ENOMEM
;

1061 
ec
 = 
ñem
->
íum_˘æ
;

1062 
ec
->
size
 = 
ñem
->size;

1063 
ªt
 = 
	`öô_˘l_hdr
(
çlg
, 
ñem
, &
ec
->
hdr
, &
íum_˘l
->hdr);

1064 i‡(
ªt
 < 0) {

1065 
	`çlg_ñem_‰ì
(
ñem
);

1066  
ªt
;

1069 
num_ôems
 = 
íum_˘l
->
ôems
 < 
SND_SOC_TPLG_NUM_TEXTS
 ?

1070 
íum_˘l
->
ôems
 : 
SND_SOC_TPLG_NUM_TEXTS
;

1071 
ec
->
ôems
 = 
num_ôems
;

1072 
ec
->
mask
 = 
íum_˘l
->mask;

1073 
ec
->
cou¡
 = 
íum_˘l
->
ôems
;

1076 
i
 = 0; i < 
SND_SOC_TPLG_MAX_CHAN
; i++)

1077 
ec
->
ch™√l
[
i
].
ªg
 = -1;

1079 
num_ch™√ls
 = 
íum_˘l
->
m≠
 ?Énum_ctl->map->num_channels : 0;

1080 
ec
->
num_ch™√ls
 =Çum_channels;

1082 
i
 = 0; i < 
num_ch™√ls
; i++) {

1083 
¢d_çlg_ch™√l_ñem
 *
ch™√l
 = &
íum_˘l
->
m≠
->ch™√l[
i
];

1085 
ec
->
ch™√l
[
i
].
size
 = (ec->channel[0]);

1086 
ec
->
ch™√l
[
i
].
ªg
 = channel->reg;

1087 
ec
->
ch™√l
[
i
].
shi·
 = channel->shift;

1088 
ec
->
ch™√l
[
i
].
id
 = channel->id;

1091 i‡(
íum_˘l
->
ãxts
 !
NULL
) {

1092 
çlg_ñem
 *
ãxts
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
,

1093 
íum_˘l
->
hdr
.
«me
, 
SND_TPLG_TYPE_TEXT
);

1095 
ãxts
->ãxts->
num_ôems
 =Çum_items;

1096 
i
 = 0; i < 
num_ôems
; i++) {

1097 i‡(!
íum_˘l
->
ãxts
[
i
])

1099 
	`¢d_°æ˝y
(
ec
->
ãxts
[
i
], 
íum_˘l
->texts[i],

1100 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1101 
	`¢d_°æ˝y
(
ãxts
->ãxts->
ôems
[
i
], 
íum_˘l
->texts[i],

1102 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1104 
	`çlg_ªf_add
(
ñem
, 
SND_TPLG_TYPE_TEXT
, 
íum_˘l
->
hdr
.
«me
);

1107 i‡(
íum_˘l
->
vÆues
 !
NULL
) {

1108 
i
 = 0; i < 
num_ôems
; i++) {

1109 i‡(
íum_˘l
->
vÆues
[
i
] =
NULL
)

1112 
	`mem˝y
(&
ec
->
vÆues
[
i
 * (Ë* 
ENUM_VAL_SIZE
],

1113 
íum_˘l
->
vÆues
[
i
],

1114 (Ë* 
ENUM_VAL_SIZE
);

1119 
¥iv
 = 
íum_˘l
->priv;

1120 i‡(
¥iv
 &&Öriv->
size
 > 0) {

1121 
ªt
 = 
	`çlg_add_d©a
(
çlg
, 
ñem
, 
¥iv
,

1122 (*
¥iv
Ë+Öriv->
size
);

1123 i‡(
ªt
 < 0)

1124  
ªt
;

1127 i‡(
e
)

1128 *
e
 = 
ñem
;

1130 
	}
}

1132 
	$çlg_add_byãs
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_byãs_ãm∂©e
 *
byãs_˘l
,

1133 
çlg_ñem
 **
e
)

1135 
¢d_soc_çlg_byãs_c⁄åﬁ
 *
be
;

1136 
¢d_soc_çlg_¥iv©e
 *
¥iv
;

1137 
çlg_ñem
 *
ñem
;

1138 
ªt
;

1140 
	`çlg_dbg
(" C⁄åﬁ Byãs: %s", 
byãs_˘l
->
hdr
.
«me
);

1142 i‡(
byãs_˘l
->
hdr
.
ty≥
 !
SND_SOC_TPLG_TYPE_BYTES
) {

1143 
	`SNDERR
("övÆid byã†ty≥ %d", 
byãs_˘l
->
hdr
.
ty≥
);

1144  -
EINVAL
;

1147 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
, 
byãs_˘l
->
hdr
.
«me
,

1148 
SND_TPLG_TYPE_BYTES
);

1149 i‡(!
ñem
)

1150  -
ENOMEM
;

1152 
be
 = 
ñem
->
byãs_ext
;

1153 
be
->
size
 = 
ñem
->size;

1154 
ªt
 = 
	`öô_˘l_hdr
(
çlg
, 
ñem
, &
be
->
hdr
, &
byãs_˘l
->hdr);

1155 i‡(
ªt
 < 0) {

1156 
	`çlg_ñem_‰ì
(
ñem
);

1157  
ªt
;

1160 
be
->
max
 = 
byãs_˘l
->max;

1161 
be
->
mask
 = 
byãs_˘l
->mask;

1162 
be
->
ba£
 = 
byãs_˘l
->base;

1163 
be
->
num_ªgs
 = 
byãs_˘l
->num_regs;

1164 
be
->
ext_›s
.
put
 = 
byãs_˘l
->ext_ops.put;

1165 
be
->
ext_›s
.
gë
 = 
byãs_˘l
->ext_ops.get;

1168 
¥iv
 = 
byãs_˘l
->priv;

1169 i‡(
¥iv
 &&Öriv->
size
 > 0) {

1170 
ªt
 = 
	`çlg_add_d©a
(
çlg
, 
ñem
, 
¥iv
,

1171 (*
¥iv
Ë+Öriv->
size
);

1172 i‡(
ªt
 < 0)

1173  
ªt
;

1177 i‡(
be
->
hdr
.
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_CALLBACK
) {

1178 i‡((
be
->
hdr
.
ac˚ss
 & 
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
)

1179 !
SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE
) {

1180 
	`SNDERR
("Invalid TLV bytes controláccess 0x%x",

1181 
be
->
hdr
.
ac˚ss
);

1182 
	`çlg_ñem_‰ì
(
ñem
);

1183  -
EINVAL
;

1186 i‡(!
be
->
max
) {

1187 
	`çlg_ñem_‰ì
(
ñem
);

1188  -
EINVAL
;

1192 i‡(
e
)

1193 *
e
 = 
ñem
;

1195 
	}
}

1197 
	$çlg_add_mixî_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
)

1199  
	`çlg_add_mixî
(
çlg
, 
t
->
mixî
, 
NULL
);

1200 
	}
}

1202 
	$çlg_add_íum_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
)

1204  
	`çlg_add_íum
(
çlg
, 
t
->
íum_˘l
, 
NULL
);

1205 
	}
}

1207 
	$çlg_add_byãs_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
)

1209  
	`çlg_add_byãs
(
çlg
, 
t
->
byãs_˘l
, 
NULL
);

1210 
	}
}

1212 
	$çlg_decode_c⁄åﬁ_mixî1
(
¢d_çlg_t
 *
çlg
,

1213 
li°_hód
 *
hóp
,

1214 
¢d_çlg_mixî_ãm∂©e
 *
mt
,

1215 
size_t
 
pos
,

1216 *
bö
, 
size_t
 
size
)

1218 
¢d_soc_çlg_mixî_c⁄åﬁ
 *
mc
 = 
bö
;

1219 
¢d_çlg_ch™√l_m≠_ãm∂©e
 *
m≠
;

1220 
¢d_çlg_év_dbsˇÀ_ãm∂©e
 *
db
;

1221 
i
;

1223 i‡(
size
 < (*
mc
)) {

1224 
	`SNDERR
("mixî: smÆ»sizê%d", 
size
);

1225  -
EINVAL
;

1228 
	`çlg_log
(
çlg
, 'D', 
pos
, "mixer: size %d TLV size %dÖrivate size %d",

1229 
mc
->
size
, mc->
hdr
.
év
.size, mc->
¥iv
.size);

1230 i‡(
size
 !
mc
->sizê+ mc->
¥iv
.size) {

1231 
	`SNDERR
("mixî: u√x≥˘edÉÀmíàsizê%d", 
size
);

1232  -
EINVAL
;

1235 
	`mem£t
(
mt
, 0, (*mt));

1236 
mt
->
hdr
.
ty≥
 = 
mc
->hdr.type;

1237 
mt
->
hdr
.
«me
 = 
mc
->hdr.name;

1238 
mt
->
hdr
.
ac˚ss
 = 
mc
->hdr.access;

1239 
mt
->
hdr
.
›s
.
gë
 = 
mc
->hdr.ops.get;

1240 
mt
->
hdr
.
›s
.
put
 = 
mc
->hdr.ops.put;

1241 
mt
->
hdr
.
›s
.
öfo
 = 
mc
->hdr.ops.info;

1242 
mt
->
mö
 = 
mc
->min;

1243 
mt
->
max
 = 
mc
->max;

1244 
mt
->
∂©f‹m_max
 = 
mc
->platform_max;

1245 
	`çlg_log
(
çlg
, 'D', 
pos
, "mixer:Çame '%s'áccess 0x%x",

1246 
mt
->
hdr
.
«me
, mt->hdr.
ac˚ss
);

1247 i‡(
mc
->
num_ch™√ls
 > 0) {

1248 
m≠
 = 
	`çlg_ˇŒoc
(
hóp
, (*map));

1249 
m≠
->
num_ch™√ls
 = 
mc
->num_channels;

1250 
i
 = 0; i < 
m≠
->
num_ch™√ls
; i++) {

1251 
m≠
->
ch™√l
[
i
].
ªg
 = 
mc
->channel[i].reg;

1252 
m≠
->
ch™√l
[
i
].
shi·
 = 
mc
->channel[i].shift;

1253 
m≠
->
ch™√l
[
i
].
id
 = 
mc
->channel[i].id;

1255 
mt
->
m≠
 = map;

1257 i‡(
mc
->
hdr
.
év
.
size
 == 0) {

1259 } i‡(
mc
->
hdr
.
év
.
size
 =(
¢d_soc_çlg_˘l_év
)) {

1260 i‡(
mc
->
hdr
.
év
.
ty≥
 !
SNDRV_CTL_TLVT_DB_SCALE
) {

1261 
	`SNDERR
("mixer: unknown TLVÅype %d",

1262 
mc
->
hdr
.
év
.
ty≥
);

1263  -
EINVAL
;

1265 
db
 = 
	`çlg_ˇŒoc
(
hóp
, (*db));

1266 i‡(
db
 =
NULL
)

1267  -
ENOMEM
;

1268 
mt
->
hdr
.
év_sˇÀ
 = 
db
;

1269 
db
->
hdr
.
ty≥
 = 
mc
->hdr.
év
.type;

1270 
db
->
mö
 = 
mc
->
hdr
.
év
.
sˇÀ
.min;

1271 
db
->
°ï
 = 
mc
->
hdr
.
év
.
sˇÀ
.step;

1272 
db
->
muã
 = 
mc
->
hdr
.
év
.
sˇÀ
.mute;

1273 
	`çlg_log
(
çlg
, 'D', 
pos
, "mixer: dB scale TLV: min %d step %d mute %d",

1274 
db
->
mö
, db->
°ï
, db->
muã
);

1276 
	`SNDERR
("mixî: wr⁄g TLV sizê%d", 
mc
->
hdr
.
év
.
size
);

1277  -
EINVAL
;

1280 
mt
->
¥iv
 = &
mc
->priv;

1281 
	`çlg_log
(
çlg
, 'D', 
pos
 + 
	`off£tof
(
¢d_soc_çlg_mixî_c⁄åﬁ
, 
¥iv
),

1284 
	}
}

1286 
	$çlg_decode_c⁄åﬁ_mixî
(
¢d_çlg_t
 *
çlg
,

1287 
size_t
 
pos
,

1288 
¢d_soc_çlg_hdr
 *
hdr
,

1289 *
bö
, 
size_t
 
size
)

1291 
li°_hód
 
hóp
;

1292 
¢d_çlg_obj_ãm∂©e_t
 
t
;

1293 
¢d_çlg_mixî_ãm∂©e
 
mt
;

1294 
¢d_soc_çlg_mixî_c⁄åﬁ
 *
mc
;

1295 
size_t
 
size2
;

1296 
îr
;

1298 
îr
 = 
	`çlg_decode_ãm∂©e
(
çlg
, 
pos
, 
hdr
, &
t
);

1299 i‡(
îr
 < 0)

1300  
îr
;

1302 
√xt
:

1303 i‡(
size
 < (*
mc
)) {

1304 
	`SNDERR
("mixî: smÆ»sizê%d", 
size
);

1305  -
EINVAL
;

1307 
	`INIT_LIST_HEAD
(&
hóp
);

1308 
mc
 = 
bö
;

1309 
size2
 = 
mc
->
size
 + mc->
¥iv
.size;

1310 i‡(
size2
 > 
size
) {

1311 
	`SNDERR
("mixer: wrongÉlement size (%d,Öriv %d)",

1312 
mc
->
size
, mc->
¥iv
.size);

1313  -
EINVAL
;

1316 
îr
 = 
	`çlg_decode_c⁄åﬁ_mixî1
(
çlg
, &
hóp
, &
mt
, 
pos
, 
bö
, 
size2
);

1317 i‡(
îr
 >= 0) {

1318 
t
.
mixî
 = &
mt
;

1319 
îr
 = 
	`¢d_çlg_add_obje˘
(
çlg
, &
t
);

1321 
	`çlg_‰ì
(&
hóp
);

1322 i‡(
îr
 < 0)

1323  
îr
;

1325 
bö
 +
size2
;

1326 
size
 -
size2
;

1327 
pos
 +
size2
;

1329 i‡(
size
 > 0)

1330 
√xt
;

1333 
	}
}

1335 
	$çlg_decode_c⁄åﬁ_íum1
(
¢d_çlg_t
 *
çlg
,

1336 
li°_hód
 *
hóp
,

1337 
¢d_çlg_íum_ãm∂©e
 *
ë
,

1338 
size_t
 
pos
,

1339 
¢d_soc_çlg_íum_c⁄åﬁ
 *
ec
)

1341 
i
;

1343 i‡(
ec
->
num_ch™√ls
 > 
SND_TPLG_MAX_CHAN
 ||

1344 
ec
->
num_ch™√ls
 > 
SND_SOC_TPLG_MAX_CHAN
) {

1345 
	`SNDERR
("íum: u√x≥˘ed ch™√»cou¡ %d", 
ec
->
num_ch™√ls
);

1346  -
EINVAL
;

1348 i‡(
ec
->
ôems
 > 
SND_SOC_TPLG_NUM_TEXTS
) {

1349 
	`SNDERR
("íum: u√x≥˘edÅext†cou¡ %d", 
ec
->
ôems
);

1350  -
EINVAL
;

1353 
	`mem£t
(
ë
, 0, (*et));

1354 
ë
->
hdr
.
ty≥
 = 
ec
->hdr.type;

1355 
ë
->
hdr
.
«me
 = 
ec
->hdr.name;

1356 
ë
->
hdr
.
ac˚ss
 = 
ec
->hdr.access;

1357 
ë
->
hdr
.
›s
.
gë
 = 
ec
->hdr.ops.get;

1358 
ë
->
hdr
.
›s
.
put
 = 
ec
->hdr.ops.put;

1359 
ë
->
hdr
.
›s
.
öfo
 = 
ec
->hdr.ops.info;

1360 
ë
->
mask
 = 
ec
->mask;

1362 i‡(
ec
->
ôems
 > 0) {

1363 
ë
->
ôems
 = 
ec
->items;

1364 
ë
->
ãxts
 = 
	`çlg_ˇŒoc
(
hóp
, (*Ë* 
ec
->
ôems
);

1365 i‡(!
ë
->
ãxts
)

1366  -
ENOMEM
;

1367 
i
 = 0; ()ò< 
ec
->
ôems
; i++)

1368 
ë
->
ãxts
[
i
] = 
ec
->texts[i];

1371 
ë
->
m≠
 = 
	`çlg_ˇŒoc
(
hóp
, (
¢d_çlg_ch™√l_m≠_ãm∂©e
));

1372 i‡(!
ë
->
m≠
)

1373  -
ENOMEM
;

1374 
ë
->
m≠
->
num_ch™√ls
 = 
ec
->num_channels;

1375 
i
 = 0; i < 
ë
->
m≠
->
num_ch™√ls
; i++) {

1376 
¢d_çlg_ch™√l_ñem
 *
ch™√l
 = &
ë
->
m≠
->ch™√l[
i
];

1378 
	`çlg_log
(
çlg
, 'D', 
pos
 + ((*)&
ec
->
ch™√l
[
i
] - (*)ec),

1379 "íum: ch™√»sizê%d", 
ec
->
ch™√l
[
i
].
size
);

1380 
ch™√l
->
ªg
 = 
ec
->ch™√l[
i
].reg;

1381 
ch™√l
->
shi·
 = 
ec
->ch™√l[
i
].shift;

1382 
ch™√l
->
id
 = 
ec
->ch™√l[
i
].id;

1385 
ë
->
¥iv
 = &
ec
->priv;

1387 
	}
}

1389 
	$çlg_decode_c⁄åﬁ_íum
(
¢d_çlg_t
 *
çlg
,

1390 
size_t
 
pos
,

1391 
¢d_soc_çlg_hdr
 *
hdr
,

1392 *
bö
, 
size_t
 
size
)

1394 
li°_hód
 
hóp
;

1395 
¢d_çlg_obj_ãm∂©e_t
 
t
;

1396 
¢d_çlg_íum_ãm∂©e
 
ë
;

1397 
¢d_soc_çlg_íum_c⁄åﬁ
 *
ec
;

1398 
size_t
 
size2
;

1399 
îr
;

1401 
îr
 = 
	`çlg_decode_ãm∂©e
(
çlg
, 
pos
, 
hdr
, &
t
);

1402 i‡(
îr
 < 0)

1403  
îr
;

1405 
√xt
:

1406 i‡(
size
 < (*
ec
)) {

1407 
	`SNDERR
("íum: smÆ»sizê%d", 
size
);

1408  -
EINVAL
;

1410 
	`INIT_LIST_HEAD
(&
hóp
);

1411 
ec
 = 
bö
;

1412 
size2
 = 
ec
->
size
 +Éc->
¥iv
.size;

1413 i‡(
size2
 > 
size
) {

1414 
	`SNDERR
("enum: wrongÉlement size (%d,Öriv %d)",

1415 
ec
->
size
,Éc->
¥iv
.size);

1416  -
EINVAL
;

1419 
	`çlg_log
(
çlg
, 'D', 
pos
, "enum: size %dÖrivate size %d",

1420 
ec
->
size
,Éc->
¥iv
.size);

1422 
îr
 = 
	`çlg_decode_c⁄åﬁ_íum1
(
çlg
, &
hóp
, &
ë
, 
pos
, 
ec
);

1423 i‡(
îr
 >= 0) {

1424 
t
.
íum_˘l
 = &
ë
;

1425 
îr
 = 
	`¢d_çlg_add_obje˘
(
çlg
, &
t
);

1427 
	`çlg_‰ì
(&
hóp
);

1428 i‡(
îr
 < 0)

1429  
îr
;

1431 
bö
 +
size2
;

1432 
size
 -
size2
;

1433 
pos
 +
size2
;

1435 i‡(
size
 > 0)

1436 
√xt
;

1439 
	}
}

1441 
	$çlg_decode_c⁄åﬁ_byãs1
(
¢d_çlg_t
 *
çlg
,

1442 
¢d_çlg_byãs_ãm∂©e
 *
bt
,

1443 
size_t
 
pos
,

1444 *
bö
, 
size_t
 
size
)

1446 
¢d_soc_çlg_byãs_c⁄åﬁ
 *
bc
 = 
bö
;

1448 i‡(
size
 < (*
bc
)) {

1449 
	`SNDERR
("byãs: smÆ»sizê%d", 
size
);

1450  -
EINVAL
;

1453 
	`çlg_log
(
çlg
, 'D', 
pos
, "control bytes: size %dÖrivate size %d",

1454 
bc
->
size
, bc->
¥iv
.size);

1455 i‡(
size
 !
bc
->sizê+ bc->
¥iv
.size) {

1456 
	`SNDERR
("byãs: u√x≥˘edÉÀmíàsizê%d", 
size
);

1457  -
EINVAL
;

1460 
	`mem£t
(
bt
, 0, (*bt));

1461 
bt
->
hdr
.
ty≥
 = 
bc
->hdr.type;

1462 
bt
->
hdr
.
«me
 = 
bc
->hdr.name;

1463 
bt
->
hdr
.
ac˚ss
 = 
bc
->hdr.access;

1464 
bt
->
hdr
.
›s
.
gë
 = 
bc
->hdr.ops.get;

1465 
bt
->
hdr
.
›s
.
put
 = 
bc
->hdr.ops.put;

1466 
bt
->
hdr
.
›s
.
öfo
 = 
bc
->hdr.ops.info;

1467 
bt
->
max
 = 
bc
->max;

1468 
bt
->
mask
 = 
bc
->mask;

1469 
bt
->
ba£
 = 
bc
->base;

1470 
bt
->
num_ªgs
 = 
bc
->num_regs;

1471 
bt
->
ext_›s
.
gë
 = 
bc
->ext_ops.get;

1472 
bt
->
ext_›s
.
put
 = 
bc
->ext_ops.put;

1473 
bt
->
ext_›s
.
öfo
 = 
bc
->ext_ops.info;

1474 
	`çlg_log
(
çlg
, 'D', 
pos
, "control bytes:Çame '%s'áccess 0x%x",

1475 
bt
->
hdr
.
«me
, bt->hdr.
ac˚ss
);

1477 
bt
->
¥iv
 = &
bc
->priv;

1479 
	}
}

1481 
	$çlg_decode_c⁄åﬁ_byãs
(
¢d_çlg_t
 *
çlg
,

1482 
size_t
 
pos
,

1483 
¢d_soc_çlg_hdr
 *
hdr
,

1484 *
bö
, 
size_t
 
size
)

1486 
¢d_çlg_obj_ãm∂©e_t
 
t
;

1487 
¢d_çlg_byãs_ãm∂©e
 
bt
;

1488 
¢d_soc_çlg_byãs_c⁄åﬁ
 *
bc
;

1489 
size_t
 
size2
;

1490 
îr
;

1492 
îr
 = 
	`çlg_decode_ãm∂©e
(
çlg
, 
pos
, 
hdr
, &
t
);

1493 i‡(
îr
 < 0)

1494  
îr
;

1496 
√xt
:

1497 i‡(
size
 < (*
bc
)) {

1498 
	`SNDERR
("byãs: smÆ»sizê%d", 
size
);

1499  -
EINVAL
;

1501 
bc
 = 
bö
;

1502 
size2
 = 
bc
->
size
 + bc->
¥iv
.size;

1503 i‡(
size2
 > 
size
) {

1504 
	`SNDERR
("bytes: wrongÉlement size (%d,Öriv %d)",

1505 
bc
->
size
, bc->
¥iv
.size);

1506  -
EINVAL
;

1509 
îr
 = 
	`çlg_decode_c⁄åﬁ_byãs1
(
çlg
, &
bt
, 
pos
, 
bö
, 
size
);

1510 i‡(
îr
 < 0)

1511  
îr
;

1513 
t
.
byãs_˘l
 = &
bt
;

1514 
îr
 = 
	`¢d_çlg_add_obje˘
(
çlg
, &
t
);

1515 i‡(
îr
 < 0)

1516  
îr
;

1518 
bö
 +
size2
;

1519 
size
 -
size2
;

1520 
pos
 +
size2
;

1522 i‡(
size
 > 0)

1523 
√xt
;

1526 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/dapm.c

20 
	~"çlg_loˇl.h
"

23 c⁄° 
m≠_ñem
 
	gwidgë_m≠
[] = {

24 {"öput", 
SND_SOC_TPLG_DAPM_INPUT
},

25 {"ouçut", 
SND_SOC_TPLG_DAPM_OUTPUT
},

26 {"mux", 
SND_SOC_TPLG_DAPM_MUX
},

27 {"mixî", 
SND_SOC_TPLG_DAPM_MIXER
},

28 {"pga", 
SND_SOC_TPLG_DAPM_PGA
},

29 {"out_drv", 
SND_SOC_TPLG_DAPM_OUT_DRV
},

30 {"adc", 
SND_SOC_TPLG_DAPM_ADC
},

31 {"dac", 
SND_SOC_TPLG_DAPM_DAC
},

32 {"swôch", 
SND_SOC_TPLG_DAPM_SWITCH
},

33 {"¥e", 
SND_SOC_TPLG_DAPM_PRE
},

34 {"po°", 
SND_SOC_TPLG_DAPM_POST
},

35 {"aif_ö", 
SND_SOC_TPLG_DAPM_AIF_IN
},

36 {"aif_out", 
SND_SOC_TPLG_DAPM_AIF_OUT
},

37 {"dai_ö", 
SND_SOC_TPLG_DAPM_DAI_IN
},

38 {"dai_out", 
SND_SOC_TPLG_DAPM_DAI_OUT
},

39 {"dai_lök", 
SND_SOC_TPLG_DAPM_DAI_LINK
},

40 {"buf„r", 
SND_SOC_TPLG_DAPM_BUFFER
},

41 {"scheduÀr", 
SND_SOC_TPLG_DAPM_SCHEDULER
},

42 {"ef„˘", 
SND_SOC_TPLG_DAPM_EFFECT
},

43 {"siggí", 
SND_SOC_TPLG_DAPM_SIGGEN
},

44 {"§c", 
SND_SOC_TPLG_DAPM_SRC
},

45 {"a§c", 
SND_SOC_TPLG_DAPM_ASRC
},

46 {"ícodî", 
SND_SOC_TPLG_DAPM_ENCODER
},

47 {"decodî", 
SND_SOC_TPLG_DAPM_DECODER
},

50 
	$lookup_widgë
(c⁄° *
w
)

52 
i
;

54 
i
 = 0; i < 
	`ARRAY_SIZE
(
widgë_m≠
); i++) {

55 i‡(
	`°rcmp
(
widgë_m≠
[
i
].
«me
, 
w
) == 0)

56  
widgë_m≠
[
i
].
id
;

59  -
EINVAL
;

60 
	}
}

62 c⁄° *
	$gë_widgë_«me
(
ty≥
)

64 
i
;

66 
i
 = 0; i < 
	`ARRAY_SIZE
(
widgë_m≠
); i++) {

67 i‡(()
widgë_m≠
[
i
].
id
 =
ty≥
)

68  
widgë_m≠
[
i
].
«me
;

71  
NULL
;

72 
	}
}

75 
	$c›y_d≠m_c⁄åﬁ
(
çlg_ñem
 *
ñem
, çlg_ñem *
ªf
)

77 
¢d_soc_çlg_d≠m_widgë
 *
widgë
 = 
ñem
->widget;

79 
	`çlg_dbg
("C⁄åﬁ '%s' u£d by '%s'", 
ªf
->
id
, 
ñem
->id);

80 
	`çlg_dbg
("\tparent size: %d + %d -> %d,Öriv size -> %d",

81 
ñem
->
size
, 
ªf
->size,Élem->size +Ñef->size,

82 
widgë
->
¥iv
.
size
);

84 
widgë
 = 
	`ªÆloc
(widgë, 
ñem
->
size
 + 
ªf
->size);

85 i‡(!
widgë
)

86  -
ENOMEM
;

88 
ñem
->
widgë
 = widget;

91 
	`mem˝y
((*)
widgë
 + 
ñem
->
size
, 
ªf
->
obj
,Ñef->size);

92 
ñem
->
size
 +
ªf
->size;

94 
widgë
->
num_kc⁄åﬁs
++;

95 
ªf
->
compound_ñem
 = 1;

97 
	}
}

100 
	$çlg_buûd_widgë
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
)

102 
çlg_ªf
 *
ªf
;

103 
li°_hód
 *
ba£
, *
pos
;

104 
îr
 = 0;

106 
ba£
 = &
ñem
->
ªf_li°
;

111 
	`li°_f‹_óch
(
pos
, 
ba£
) {

112 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

114 i‡(
ªf
->
ty≥
 !
SND_TPLG_TYPE_DATA
)

117 
îr
 = 
	`çlg_c›y_d©a
(
çlg
, 
ñem
, 
ªf
);

118 i‡(
îr
 < 0)

119  
îr
;

123 
	`li°_f‹_óch
(
pos
, 
ba£
) {

125 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

127 
ªf
->
ty≥
) {

128 
SND_TPLG_TYPE_MIXER
:

129 i‡(!
ªf
->
ñem
)

130 
ªf
->
ñem
 = 
	`çlg_ñem_lookup
(&
çlg
->
mixî_li°
,

131 
ªf
->
id
, 
SND_TPLG_TYPE_MIXER
, 
ñem
->
ödex
);

132 i‡(
ªf
->
ñem
)

133 
îr
 = 
	`c›y_d≠m_c⁄åﬁ
(
ñem
, 
ªf
->elem);

136 
SND_TPLG_TYPE_ENUM
:

137 i‡(!
ªf
->
ñem
)

138 
ªf
->
ñem
 = 
	`çlg_ñem_lookup
(&
çlg
->
íum_li°
,

139 
ªf
->
id
, 
SND_TPLG_TYPE_ENUM
, 
ñem
->
ödex
);

140 i‡(
ªf
->
ñem
)

141 
îr
 = 
	`c›y_d≠m_c⁄åﬁ
(
ñem
, 
ªf
->elem);

144 
SND_TPLG_TYPE_BYTES
:

145 i‡(!
ªf
->
ñem
)

146 
ªf
->
ñem
 = 
	`çlg_ñem_lookup
(&
çlg
->
byãs_ext_li°
,

147 
ªf
->
id
, 
SND_TPLG_TYPE_BYTES
, 
ñem
->
ödex
);

148 i‡(
ªf
->
ñem
)

149 
îr
 = 
	`c›y_d≠m_c⁄åﬁ
(
ñem
, 
ªf
->elem);

156 i‡(!
ªf
->
ñem
) {

157 
	`SNDERR
("cannot find '%s'Ñeferenced by widget '%s'",

158 
ªf
->
id
, 
ñem
->id);

159  -
EINVAL
;

162 i‡(
îr
 < 0)

163  
îr
;

167 
	}
}

169 
	$çlg_buûd_widgës
(
¢d_çlg_t
 *
çlg
)

172 
li°_hód
 *
ba£
, *
pos
;

173 
çlg_ñem
 *
ñem
;

174 
îr
;

176 
ba£
 = &
çlg
->
widgë_li°
;

177 
	`li°_f‹_óch
(
pos
, 
ba£
) {

179 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

180 i‡(!
ñem
->
widgë
 ||ÉÀm->
ty≥
 !
SND_TPLG_TYPE_DAPM_WIDGET
) {

181 
	`SNDERR
("övÆid widgë '%s'", 
ñem
->
id
);

182  -
EINVAL
;

185 
îr
 = 
	`çlg_buûd_widgë
(
çlg
, 
ñem
);

186 i‡(
îr
 < 0)

187  
îr
;

190 
çlg
->
m™i„°
.
widgë_ñems
++;

194 
	}
}

196 
	$çlg_buûd_rouãs
(
¢d_çlg_t
 *
çlg
)

198 
li°_hód
 *
ba£
, *
pos
;

199 
çlg_ñem
 *
ñem
;

200 
¢d_soc_çlg_d≠m_gøph_ñem
 *
rouã
;

202 
ba£
 = &
çlg
->
rouã_li°
;

204 
	`li°_f‹_óch
(
pos
, 
ba£
) {

205 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

207 i‡(!
ñem
->
rouã
 ||ÉÀm->
ty≥
 !
SND_TPLG_TYPE_DAPM_GRAPH
) {

208 
	`SNDERR
("övÆidÑouã '%s'", 
ñem
->
id
);

209  -
EINVAL
;

212 
rouã
 = 
ñem
->route;

213 
	`çlg_dbg
("CheckÑoute: sink '%s', control '%s', source '%s'",

214 
rouã
->
sök
,Ñouã->
c⁄åﬁ
,Ñouã->
sour˚
);

217 i‡(
	`°æí
(
rouã
->
sök
) <= 0) {

218 
	`SNDERR
("no sink");

219  -
EINVAL
;

222 i‡(!
	`çlg_ñem_lookup
(&
çlg
->
widgë_li°
, 
rouã
->
sök
,

223 
SND_TPLG_TYPE_DAPM_WIDGET
, 
SND_TPLG_INDEX_ALL
)) {

224 
	`SNDERR
("undeföed sök widgë/°ªam '%s'", 
rouã
->
sök
);

228 i‡(
	`°æí
(
rouã
->
c⁄åﬁ
)) {

229 i‡(!
	`çlg_ñem_lookup
(&
çlg
->
mixî_li°
, 
rouã
->
c⁄åﬁ
,

230 
SND_TPLG_TYPE_MIXER
, 
ñem
->
ödex
) &&

231 !
	`çlg_ñem_lookup
(&
çlg
->
íum_li°
, 
rouã
->
c⁄åﬁ
,

232 
SND_TPLG_TYPE_ENUM
, 
ñem
->
ödex
)) {

233 
	`SNDERR
("undefined mixer/enum control '%s'",

234 
rouã
->
c⁄åﬁ
);

239 i‡(
	`°æí
(
rouã
->
sour˚
) <= 0) {

240 
	`SNDERR
("no source");

241  -
EINVAL
;

244 i‡(!
	`çlg_ñem_lookup
(&
çlg
->
widgë_li°
, 
rouã
->
sour˚
,

245 
SND_TPLG_TYPE_DAPM_WIDGET
, 
SND_TPLG_INDEX_ALL
)) {

246 
	`SNDERR
("undefined source widget/stream '%s'",

247 
rouã
->
sour˚
);

251 
çlg
->
m™i„°
.
gøph_ñems
++;

255 
	}
}

257 
çlg_ñem
 *
	$çlg_ñem_√w_rouã
(
¢d_çlg_t
 *
çlg
, 
ödex
)

259 
çlg_ñem
 *
ñem
;

260 
¢d_soc_çlg_d≠m_gøph_ñem
 *
löe
;

262 
ñem
 = 
	`çlg_ñem_√w
();

263 i‡(!
ñem
)

264  
NULL
;

266 
ñem
->
ödex
 = index;

267 i‡(
çlg
->
d≠m_s‹t
)

268 
	`çlg_ñem_ö£π
(
ñem
, &
çlg
->
rouã_li°
);

270 
	`li°_add_èû
(&
ñem
->
li°
, &
çlg
->
rouã_li°
);

271 
	`°r˝y
(
ñem
->
id
, "line");

272 
ñem
->
ty≥
 = 
SND_TPLG_TYPE_DAPM_GRAPH
;

273 
ñem
->
size
 = (*
löe
);

275 
löe
 = 
	`ˇŒoc
(1, (*line));

276 i‡(!
löe
) {

277 
	`çlg_ñem_‰ì
(
ñem
);

278  
NULL
;

280 
ñem
->
rouã
 = 
löe
;

282  
ñem
;

283 
	}
}

285 
	#LINE_SIZE
 1024

	)

288 
	$çlg_∑r£_löe
(c⁄° *
ãxt
,

289 
¢d_soc_çlg_d≠m_gøph_ñem
 *
löe
)

291 
buf
[
LINE_SIZE
];

292 
Àn
, 
i
;

293 c⁄° *
sour˚
 = 
NULL
, *
sök
 = NULL, *
c⁄åﬁ
 = NULL;

295 
	`¢d_°æ˝y
(
buf
, 
ãxt
, 
LINE_SIZE
);

297 
Àn
 = 
	`°æí
(
buf
);

298 i‡(
Àn
 <= 2) {

299 
	`SNDERR
("övÆidÑouã \"%s\"", 
buf
);

300  -
EINVAL
;

304 
i
 = 1; i < 
Àn
; i++) {

305 i‡(
buf
[
i
] == ',')

306 
£c⁄d
;

308 
	`SNDERR
("övÆidÑouã \"%s\"", 
buf
);

309  -
EINVAL
;

311 
£c⁄d
:

313 
sök
 = 
buf
;

314 
c⁄åﬁ
 = &
buf
[
i
 + 2];

315 
buf
[
i
] = 0;

317 ; 
i
 < 
Àn
; i++) {

318 i‡(
buf
[
i
] == ',')

319 
d⁄e
;

322 
	`SNDERR
("övÆidÑouã \"%s\"", 
buf
);

323  -
EINVAL
;

325 
d⁄e
:

326 
buf
[
i
] = 0;

327 
sour˚
 = &
buf
[
i
 + 2];

329 
	`°r˝y
(
löe
->
sour˚
, source);

330 
	`°r˝y
(
löe
->
c⁄åﬁ
, control);

331 
	`°r˝y
(
löe
->
sök
, sink);

333 
	}
}

336 
	$çlg_∑r£_rouãs
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, 
ödex
)

338 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

339 
¢d_c⁄fig_t
 *
n
;

340 
çlg_ñem
 *
ñem
;

341 
¢d_soc_çlg_d≠m_gøph_ñem
 *
löe
;

342 
îr
;

344 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

345 c⁄° *
vÆ
;

347 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

348 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆ
) < 0)

351 
ñem
 = 
	`çlg_ñem_√w_rouã
(
çlg
, 
ödex
);

352 i‡(!
ñem
)

353  -
ENOMEM
;

354 
löe
 = 
ñem
->
rouã
;

356 
îr
 = 
	`çlg_∑r£_löe
(
vÆ
, 
löe
);

357 i‡(
îr
 < 0)

358  
îr
;

360 
	`çlg_dbg
("route: sink '%s', control '%s', source '%s'",

361 
löe
->
sök
,Üöe->
c⁄åﬁ
,Üöe->
sour˚
);

365 
	}
}

367 
	$çlg_∑r£_d≠m_gøph
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

368 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

370 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

371 
¢d_c⁄fig_t
 *
n
;

372 
îr
;

373 c⁄° *
gøph_id
;

374 
ödex
 = -1;

376 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

377 
	`SNDERR
("compound isÉxpected for dapm graph definition");

378  -
EINVAL
;

381 
	`¢d_c⁄fig_gë_id
(
cfg
, &
gøph_id
);

383 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

384 c⁄° *
id
;

386 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

387 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0) {

391 i‡(
	`°rcmp
(
id
, "index") == 0) {

392 i‡(
	`çlg_gë_öãgî
(
n
, &
ödex
, 0))

393  -
EINVAL
;

394 i‡(
ödex
 < 0)

395  -
EINVAL
;

398 i‡(
	`°rcmp
(
id
, "lines") == 0) {

399 i‡(
ödex
 < 0) {

400 
	`SNDERR
("failedÅoÖarse dapm graph %s, missing index",

401 
gøph_id
);

402  -
EINVAL
;

404 
îr
 = 
	`çlg_∑r£_rouãs
(
çlg
, 
n
, 
ödex
);

405 i‡(
îr
 < 0) {

406 
	`SNDERR
("failedÅoÖarse dapm graph %s",

407 
gøph_id
);

408  
îr
;

415 
	}
}

418 
	$çlg_ßve_d≠m_gøph
(
¢d_çlg_t
 *
çlg
, 
ödex
,

419 
çlg_buf
 *
d°
, c⁄° *
pfx
)

421 
¢d_soc_çlg_d≠m_gøph_ñem
 *
rouã
;

422 
li°_hód
 *
pos
;

423 
çlg_ñem
 *
ñem
;

424 
îr
, 
fú°
, 
ﬁd_ödex
;

425 
block
, 
cou¡
;

426 c⁄° *
fmt
;

428 
ﬁd_ödex
 = -1;

429 
block
 = 0;

430 
cou¡
 = 0;

431 
	`li°_f‹_óch
(
pos
, &
çlg
->
rouã_li°
) {

432 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

433 i‡(!
ñem
->
rouã
 ||ÉÀm->
ty≥
 !
SND_TPLG_TYPE_DAPM_GRAPH
)

435 i‡(
ödex
 >0 && 
ñem
->index != index)

437 i‡(
ﬁd_ödex
 !
ñem
->
ödex
) {

438 
block
++;

439 
ﬁd_ödex
 = 
ñem
->
ödex
;

441 
cou¡
++;

443 i‡(
cou¡
 == 0)

445 i‡(
block
 < 10) {

446 
fmt
 = "\tset%u {\n";

447 } i‡(
block
 < 100) {

448 
fmt
 = "\tset%02u {\n";

449 } i‡(
block
 < 1000) {

450 
fmt
 = "\tset%03u {\n";

452  -
EINVAL
;

454 
ﬁd_ödex
 = -1;

455 
block
 = -1;

456 
fú°
 = 1;

457 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "SectionGraph {\n");

458 
	`li°_f‹_óch
(
pos
, &
çlg
->
rouã_li°
) {

459 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

460 i‡(!
ñem
->
rouã
 ||ÉÀm->
ty≥
 !
SND_TPLG_TYPE_DAPM_GRAPH
)

462 i‡(
ödex
 >0 && 
ñem
->index != index)

464 i‡(
ﬁd_ödex
 !
ñem
->
ödex
) {

465 i‡(
ﬁd_ödex
 >= 0) {

466 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t\t]\n");

467 i‡(
îr
 < 0)

468  
îr
;

469 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t}\n");

470 i‡(
îr
 < 0)

471  
îr
;

473 
ﬁd_ödex
 = 
ñem
->
ödex
;

474 
block
++;

475 
fú°
 = 1;

476 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, 
fmt
, 
block
);

477 i‡(
îr
 >= 0)

478 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t\tindex %u\n",

479 
ñem
->
ödex
);

480 i‡(
îr
 < 0)

481  
îr
;

483 i‡(
fú°
) {

484 
fú°
 = 0;

485 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t\tlines [\n");

486 i‡(
îr
 < 0)

487  
îr
;

489 
rouã
 = 
ñem
->route;

490 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t\t\t'%s, %s, %s'\n",

491 
rouã
->
sök
,Ñouã->
c⁄åﬁ
,

492 
rouã
->
sour˚
);

493 i‡(
îr
 < 0)

494  
îr
;

497 i‡(!
fú°
) {

498 i‡(
îr
 >= 0)

499 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t\t]\n");

500 i‡(
îr
 >= 0)

501 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t}\n");

504 i‡(
îr
 >= 0)

505 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

506  
îr
;

507 
	}
}

510 
	$çlg_∑r£_d≠m_widgë
(
¢d_çlg_t
 *
çlg
,

511 
¢d_c⁄fig_t
 *
cfg
, *
¥iv©e
 
ATTRIBUTE_UNUSED
)

513 
¢d_soc_çlg_d≠m_widgë
 *
widgë
;

514 
çlg_ñem
 *
ñem
;

515 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

516 
¢d_c⁄fig_t
 *
n
;

517 c⁄° *
id
, *
vÆ
 = 
NULL
;

518 
widgë_ty≥
, 
îr
, 
ivÆ
;

520 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_DAPM_WIDGET
);

521 i‡(!
ñem
)

522  -
ENOMEM
;

524 
	`çlg_dbg
(" Widgë: %s", 
ñem
->
id
);

526 
widgë
 = 
ñem
->widget;

527 
	`¢d_°æ˝y
(
widgë
->
«me
, 
ñem
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

528 
widgë
->
size
 = 
ñem
->size;

530 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

532 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

533 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

537 i‡(
	`°rcmp
(
id
, "comment") == 0)

539 i‡(
id
[0] == '#')

542 i‡(
	`°rcmp
(
id
, "type") == 0) {

543 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆ
) < 0)

544  -
EINVAL
;

546 
widgë_ty≥
 = 
	`lookup_widgë
(
vÆ
);

547 i‡(
widgë_ty≥
 < 0){

548 
	`SNDERR
("widget '%s': Unsupported widgetÅype %s",

549 
ñem
->
id
, 
vÆ
);

550  -
EINVAL
;

553 
widgë
->
id
 = 
widgë_ty≥
;

554 
	`çlg_dbg
("\t%s: %s", 
id
, 
vÆ
);

558 i‡(
	`°rcmp
(
id
, "stream_name") == 0) {

559 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆ
) < 0)

560  -
EINVAL
;

562 
	`¢d_°æ˝y
(
widgë
->
¢ame
, 
vÆ
,

563 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

564 
	`çlg_dbg
("\t%s: %s", 
id
, 
vÆ
);

568 i‡(
	`°rcmp
(
id
, "no_pm") == 0) {

569 
ivÆ
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

570 i‡(
ivÆ
 < 0)

571  -
EINVAL
;

573 
widgë
->
ªg
 = 
ivÆ
 ? -1 : 0;

575 
	`çlg_dbg
("\t%s: %s", 
id
, 
vÆ
);

579 i‡(
	`°rcmp
(
id
, "shift") == 0) {

580 i‡(
	`çlg_gë_öãgî
(
n
, &
ivÆ
, 0))

581  -
EINVAL
;

583 
widgë
->
shi·
 = 
ivÆ
;

584 
	`çlg_dbg
("\t%s: %d", 
id
, 
widgë
->
shi·
);

588 i‡(
	`°rcmp
(
id
, "reg") == 0) {

589 i‡(
	`çlg_gë_öãgî
(
n
, &
ivÆ
, 0))

590  -
EINVAL
;

592 
widgë
->
ªg
 = 
ivÆ
;

593 
	`çlg_dbg
("\t%s: %d", 
id
, 
widgë
->
ªg
);

597 i‡(
	`°rcmp
(
id
, "invert") == 0) {

598 
ivÆ
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

599 i‡(
ivÆ
 < 0)

600  -
EINVAL
;

602 
widgë
->
övît
 = 
ivÆ
;

603 
	`çlg_dbg
("\t%s: %d", 
id
, 
widgë
->
övît
);

607 i‡(
	`°rcmp
(
id
, "ignore_suspend") == 0) {

608 
ivÆ
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

609 i‡(
ivÆ
 < 0)

610  -
EINVAL
;

612 
widgë
->
ign‹e_su•íd
 = 
ivÆ
;

614 
	`çlg_dbg
("\t%s: %s", 
id
, 
vÆ
);

618 i‡(
	`°rcmp
(
id
, "subseq") == 0) {

619 i‡(
	`çlg_gë_öãgî
(
n
, &
ivÆ
, 0))

620  -
EINVAL
;

622 
widgë
->
sub£q
 = 
ivÆ
;

623 
	`çlg_dbg
("\t%s: %d", 
id
, 
widgë
->
sub£q
);

627 i‡(
	`°rcmp
(
id
, "event_type") == 0) {

628 i‡(
	`çlg_gë_öãgî
(
n
, &
ivÆ
, 0))

629  -
EINVAL
;

631 
widgë
->
evít_ty≥
 = 
ivÆ
;

632 
	`çlg_dbg
("\t%s: %d", 
id
, 
widgë
->
evít_ty≥
);

636 i‡(
	`°rcmp
(
id
, "event_flags") == 0) {

637 i‡(
	`çlg_gë_öãgî
(
n
, &
ivÆ
, 0))

638  -
EINVAL
;

640 
widgë
->
evít_Êags
 = 
ivÆ
;

641 
	`çlg_dbg
("\t%s: %d", 
id
, 
widgë
->
evít_Êags
);

645 i‡(
	`°rcmp
(
id
, "enum") == 0) {

646 
îr
 = 
	`çlg_∑r£_ªfs
(
n
, 
ñem
, 
SND_TPLG_TYPE_ENUM
);

647 i‡(
îr
 < 0)

648  
îr
;

653 i‡(
	`°rcmp
(
id
, "mixer") == 0) {

654 
îr
 = 
	`çlg_∑r£_ªfs
(
n
, 
ñem
, 
SND_TPLG_TYPE_MIXER
);

655 i‡(
îr
 < 0)

656  
îr
;

661 i‡(
	`°rcmp
(
id
, "bytes") == 0) {

662 
îr
 = 
	`çlg_∑r£_ªfs
(
n
, 
ñem
, 
SND_TPLG_TYPE_BYTES
);

663 i‡(
îr
 < 0)

664  
îr
;

669 i‡(
	`°rcmp
(
id
, "data") == 0) {

670 
îr
 = 
	`çlg_∑r£_ªfs
(
n
, 
ñem
, 
SND_TPLG_TYPE_DATA
);

671 i‡(
îr
 < 0)

672  
îr
;

678 
	}
}

681 
	$çlg_ßve_d≠m_widgë
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

682 
çlg_ñem
 *
ñem
,

683 
çlg_buf
 *
d°
, c⁄° *
pfx
)

685 
¢d_soc_çlg_d≠m_widgë
 *
widgë
 = 
ñem
->widget;

686 c⁄° *
s
;

687 
pfx2
[16];

688 
îr
;

690 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s' {\n", 
ñem
->
id
);

691 i‡(
îr
 >0 && 
ñem
->
ödex
)

692 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tindex %u\n",

693 
ñem
->
ödex
);

694 i‡(
îr
 >= 0) {

695 
s
 = 
	`gë_widgë_«me
(
widgë
->
id
);

696 i‡(
s
)

697 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\ây≥ %s\n", 
s
);

699 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\ttype %u\n",

700 
widgë
->
id
);

702 i‡(
îr
 >0 && 
widgë
->
¢ame
[0])

703 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tstream_name '%s'\n",

704 
widgë
->
¢ame
);

705 i‡(
îr
 >0 && 
widgë
->
ªg
)

706 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tno_pm 1\n");

707 i‡(
îr
 >0 && 
widgë
->
shi·
)

708 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tshift %u\n",

709 
widgë
->
shi·
);

710 i‡(
îr
 >0 && 
widgë
->
övît
)

711 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tinvert %u\n",

712 
widgë
->
övît
);

713 i‡(
îr
 >0 && 
widgë
->
ign‹e_su•íd
)

714 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tignore_suspend %u\n",

715 
widgë
->
ign‹e_su•íd
);

716 i‡(
îr
 >0 && 
widgë
->
sub£q
)

717 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tsubseq %u\n",

718 
widgë
->
sub£q
);

719 i‡(
îr
 >0 && 
widgë
->
evít_ty≥
)

720 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tevent_type %u\n",

721 
widgë
->
evít_ty≥
);

722 i‡(
îr
 >0 && 
widgë
->
evít_Êags
)

723 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tevent_flags %u\n",

724 
widgë
->
evít_Êags
);

725 
	`¢¥ötf
(
pfx2
, ’fx2), "%s\t", 
pfx
 ?: "");

726 i‡(
îr
 >= 0)

727 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_ENUM
,

728 "íum", 
d°
, 
pfx2
);

729 i‡(
îr
 >= 0)

730 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_MIXER
,

731 "mixî", 
d°
, 
pfx2
);

732 i‡(
îr
 >= 0)

733 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_BYTES
,

734 "byãs", 
d°
, 
pfx2
);

735 i‡(
îr
 >= 0)

736 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_DATA
,

737 "d©a", 
d°
, 
pfx2
);

738 i‡(
îr
 >= 0)

739 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

740  
îr
;

741 
	}
}

743 
	$çlg_add_rouã
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_gøph_ñem
 *
t
, 
ödex
)

745 
çlg_ñem
 *
ñem
;

746 
¢d_soc_çlg_d≠m_gøph_ñem
 *
löe
;

748 i‡(!
t
->
§c
 || !t->
sök
)

749  -
EINVAL
;

751 
ñem
 = 
	`çlg_ñem_√w_rouã
(
çlg
, 
ödex
);

752 i‡(!
ñem
)

753  -
ENOMEM
;

755 
löe
 = 
ñem
->
rouã
;

756 
	`¢d_°æ˝y
(
löe
->
sour˚
, 
t
->
§c
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

757 i‡(
t
->
˘l
)

758 
	`¢d_°æ˝y
(
löe
->
c⁄åﬁ
, 
t
->
˘l
,

759 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

760 
	`¢d_°æ˝y
(
löe
->
sök
, 
t
->sök, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

763 
	}
}

765 
	$çlg_add_gøph_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
)

767 
¢d_çlg_gøph_ãm∂©e
 *
gt
 = 
t
->
gøph
;

768 
i
, 
ªt
;

770 
i
 = 0; i < 
gt
->
cou¡
; i++) {

771 
ªt
 = 
	`çlg_add_rouã
(
çlg
, 
gt
->
ñem
 + 
i
, 
t
->
ödex
);

772 i‡(
ªt
 < 0)

773  
ªt
;

777 
	}
}

779 
	$çlg_add_widgë_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
)

781 
¢d_çlg_widgë_ãm∂©e
 *
wt
 = 
t
->
widgë
;

782 
¢d_soc_çlg_d≠m_widgë
 *
w
;

783 
çlg_ñem
 *
ñem
;

784 
i
, 
ªt
 = 0;

786 
	`çlg_dbg
("Widgë: %s", 
wt
->
«me
);

788 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
, 
wt
->
«me
,

789 
SND_TPLG_TYPE_DAPM_WIDGET
);

790 i‡(!
ñem
)

791  -
ENOMEM
;

794 
w
 = 
ñem
->
widgë
;

795 
w
->
size
 = 
ñem
->size;

797 
w
->
id
 = 
wt
->id;

798 
	`¢d_°æ˝y
(
w
->
«me
, 
wt
->«me, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

799 i‡(
wt
->
¢ame
)

800 
	`¢d_°æ˝y
(
w
->
¢ame
, 
wt
->¢ame, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

801 
w
->
ªg
 = 
wt
->reg;

802 
w
->
shi·
 = 
wt
->shift;

803 
w
->
mask
 = 
wt
->mask;

804 
w
->
sub£q
 = 
wt
->subseq;

805 
w
->
övît
 = 
wt
->invert;

806 
w
->
ign‹e_su•íd
 = 
wt
->ignore_suspend;

807 
w
->
evít_Êags
 = 
wt
->event_flags;

808 
w
->
evít_ty≥
 = 
wt
->event_type;

811 i‡(
wt
->
¥iv
 !
NULL
 && wt->¥iv->
size
 > 0) {

812 
ªt
 = 
	`çlg_add_d©a
(
çlg
, 
ñem
, 
wt
->
¥iv
,

813 (*
wt
->
¥iv
Ë+ wt->¥iv->
size
);

814 i‡(
ªt
 < 0) {

815 
	`çlg_ñem_‰ì
(
ñem
);

816  
ªt
;

821 
i
 = 0 ; i < 
wt
->
num_˘ls
; i++) {

822 
¢d_çlg_˘l_ãm∂©e
 *
˘
 = 
wt
->
˘l
[
i
];

823 
çlg_ñem
 *
ñem_˘l
;

824 
¢d_çlg_mixî_ãm∂©e
 *
mt
;

825 
¢d_çlg_byãs_ãm∂©e
 *
bt
;

826 
¢d_çlg_íum_ãm∂©e
 *
ë
;

828 i‡(!
˘
) {

829 
	`çlg_ñem_‰ì
(
ñem
);

830  -
EINVAL
;

833 
˘
->
ty≥
) {

834 
SND_SOC_TPLG_TYPE_MIXER
:

835 
mt
 = 
	`c⁄èöî_of
(
˘
, 
¢d_çlg_mixî_ãm∂©e
, 
hdr
);

836 
ªt
 = 
	`çlg_add_mixî
(
çlg
, 
mt
, &
ñem_˘l
);

839 
SND_SOC_TPLG_TYPE_BYTES
:

840 
bt
 = 
	`c⁄èöî_of
(
˘
, 
¢d_çlg_byãs_ãm∂©e
, 
hdr
);

841 
ªt
 = 
	`çlg_add_byãs
(
çlg
, 
bt
, &
ñem_˘l
);

844 
SND_SOC_TPLG_TYPE_ENUM
:

845 
ë
 = 
	`c⁄èöî_of
(
˘
, 
¢d_çlg_íum_ãm∂©e
, 
hdr
);

846 
ªt
 = 
	`çlg_add_íum
(
çlg
, 
ë
, &
ñem_˘l
);

850 
	`SNDERR
("widget %s: invalidÅype %d for ctl %d",

851 
wt
->
«me
, 
˘
->
ty≥
, 
i
);

852 
ªt
 = -
EINVAL
;

856 i‡(
ªt
 < 0) {

857 
	`çlg_ñem_‰ì
(
ñem
);

858  
ªt
;

861 
ªt
 = 
	`çlg_ªf_add_ñem
(
ñem
, 
ñem_˘l
);

862 i‡(
ªt
 < 0) {

863 
	`çlg_ñem_‰ì
(
ñem
);

864  
ªt
;

869 
	}
}

872 
	$çlg_decode_d≠m_widgë
(
¢d_çlg_t
 *
çlg
,

873 
size_t
 
pos
,

874 
¢d_soc_çlg_hdr
 *
hdr
,

875 *
bö
, 
size_t
 
size
)

877 
li°_hód
 
hóp
;

878 
¢d_soc_çlg_d≠m_widgë
 *
w
;

879 
¢d_çlg_obj_ãm∂©e_t
 
t
;

880 
¢d_çlg_widgë_ãm∂©e
 *
wt
;

881 
¢d_çlg_mixî_ãm∂©e
 *
mt
;

882 
¢d_çlg_íum_ãm∂©e
 *
ë
;

883 
¢d_çlg_byãs_ãm∂©e
 *
bt
;

884 
¢d_soc_çlg_˘l_hdr
 *
chdr
;

885 
¢d_soc_çlg_mixî_c⁄åﬁ
 *
mc
;

886 
¢d_soc_çlg_íum_c⁄åﬁ
 *
ec
;

887 
¢d_soc_çlg_byãs_c⁄åﬁ
 *
bc
;

888 
size_t
 
size2
;

889 
ödex
;

890 
îr
;

892 
îr
 = 
	`çlg_decode_ãm∂©e
(
çlg
, 
pos
, 
hdr
, &
t
);

893 i‡(
îr
 < 0)

894  
îr
;

896 
√xt
:

897 
	`INIT_LIST_HEAD
(&
hóp
);

898 
w
 = 
bö
;

900 i‡(
size
 < (*
w
)) {

901 
	`SNDERR
("d≠m widgë: smÆ»sizê%d", 
size
);

902  -
EINVAL
;

904 i‡((*
w
Ë!w->
size
) {

905 
	`SNDERR
("dapm widget: unknownÉlement size %d (expected %zd)",

906 
w
->
size
, (*w));

907  -
EINVAL
;

909 i‡(
w
->
num_kc⁄åﬁs
 > 16) {

910 
	`SNDERR
("dapm widget:Åoo many kcontrols %d",

911 
w
->
num_kc⁄åﬁs
);

912  -
EINVAL
;

915 
	`çlg_log
(
çlg
, 'D', 
pos
, "dapm widget: size %dÖrivate size %d kcontrols %d",

916 
w
->
size
, w->
¥iv
.size, w->
num_kc⁄åﬁs
);

918 
wt
 = 
	`çlg_ˇŒoc
(&
hóp
, (*wtË+ (*Ë* 
w
->
num_kc⁄åﬁs
);

919 i‡(
wt
 =
NULL
)

920  -
ENOMEM
;

921 
wt
->
id
 = 
w
->id;

922 
wt
->
«me
 = 
w
->name;

923 
wt
->
¢ame
 = 
w
->sname;

924 
wt
->
ªg
 = 
w
->reg;

925 
wt
->
shi·
 = 
w
->shift;

926 
wt
->
mask
 = 
w
->mask;

927 
wt
->
sub£q
 = 
w
->subseq;

928 
wt
->
övît
 = 
w
->invert;

929 
wt
->
ign‹e_su•íd
 = 
w
->ignore_suspend;

930 
wt
->
evít_Êags
 = 
w
->event_flags;

931 
wt
->
evít_ty≥
 = 
w
->event_type;

933 
	`çlg_log
(
çlg
, 'D', 
pos
, "dapm widget:Çame '%s' sname '%s'",

934 
wt
->
«me
, wt->
¢ame
);

936 i‡((*
w
Ë+ w->
¥iv
.
size
 > size) {

937 
	`SNDERR
("dapm widget: wrongÖrivate data size %d",

938 
w
->
¥iv
.
size
);

939  -
EINVAL
;

942 
	`çlg_log
(
çlg
, 'D', 
pos
 + 
	`off£tof
(
¢d_soc_çlg_d≠m_widgë
, 
¥iv
),

945 
wt
->
¥iv
 = &
w
->priv;

946 
bö
 +(*
w
Ë+ w->
¥iv
.
size
;

947 
size
 -(*
w
Ë+ w->
¥iv
.size;

948 
pos
 +(*
w
Ë+ w->
¥iv
.
size
;

950 
ödex
 = 0; index < 
w
->
num_kc⁄åﬁs
; index++) {

951 
chdr
 = 
bö
;

952 
chdr
->
ty≥
) {

953 
SND_SOC_TPLG_TYPE_MIXER
:

954 
mt
 = 
	`çlg_ˇŒoc
(&
hóp
, (*mt));

955 i‡(
mt
 =
NULL
) {

956 
îr
 = -
ENOMEM
;

957 
ªtvÆ
;

959 
wt
->
˘l
[
ödex
] = (*)
mt
;

960 
wt
->
num_˘ls
++;

961 
mc
 = 
bö
;

962 
size2
 = 
mc
->
size
 + mc->
¥iv
.size;

963 
	`çlg_log
(
çlg
, 'D', 
pos
, "kc⁄åﬁ mixî sizê%zd", 
size2
);

964 i‡(
size2
 > 
size
) {

965 
	`SNDERR
("dapm widget: small mixer size %d",

966 
size2
);

967 
îr
 = -
EINVAL
;

968 
ªtvÆ
;

970 
îr
 = 
	`çlg_decode_c⁄åﬁ_mixî1
(
çlg
, &
hóp
, 
mt
, 
pos
,

971 
bö
, 
size2
);

973 
SND_SOC_TPLG_TYPE_ENUM
:

974 
ë
 = 
	`çlg_ˇŒoc
(&
hóp
, (*
mt
));

975 i‡(
ë
 =
NULL
) {

976 
îr
 = -
ENOMEM
;

977 
ªtvÆ
;

979 
wt
->
˘l
[
ödex
] = (*)
ë
;

980 
wt
->
num_˘ls
++;

981 
ec
 = 
bö
;

982 
size2
 = 
ec
->
size
 +Éc->
¥iv
.size;

983 
	`çlg_log
(
çlg
, 'D', 
pos
, "kc⁄åﬁÉnum sizê%zd", 
size2
);

984 i‡(
size2
 > 
size
) {

985 
	`SNDERR
("dapm widget: smallÉnum size %d",

986 
size2
);

987 
îr
 = -
EINVAL
;

988 
ªtvÆ
;

990 
îr
 = 
	`çlg_decode_c⁄åﬁ_íum1
(
çlg
, &
hóp
, 
ë
, 
pos
, 
ec
);

992 
SND_SOC_TPLG_TYPE_BYTES
:

993 
bt
 = 
	`çlg_ˇŒoc
(&
hóp
, (*bt));

994 i‡(
bt
 =
NULL
) {

995 
îr
 = -
ENOMEM
;

996 
ªtvÆ
;

998 
wt
->
˘l
[
ödex
] = (*)
bt
;

999 
wt
->
num_˘ls
++;

1000 
bc
 = 
bö
;

1001 
size2
 = 
bc
->
size
 + bc->
¥iv
.size;

1002 
	`çlg_log
(
çlg
, 'D', 
pos
, "kc⁄åﬁ byã†sizê%zd", 
size2
);

1003 i‡(
size2
 > 
size
) {

1004 
	`SNDERR
("dapm widget: small bytes size %d",

1005 
size2
);

1006 
îr
 = -
EINVAL
;

1007 
ªtvÆ
;

1009 
îr
 = 
	`çlg_decode_c⁄åﬁ_byãs1
(
çlg
, 
bt
, 
pos
,

1010 
bö
, 
size2
);

1013 
	`SNDERR
("dapm widget: wrong controlÅype %d",

1014 
chdr
->
ty≥
);

1015 
îr
 = -
EINVAL
;

1016 
ªtvÆ
;

1018 i‡(
îr
 < 0)

1019 
ªtvÆ
;

1020 
bö
 +
size2
;

1021 
size
 -
size2
;

1022 
pos
 +
size2
;

1025 
t
.
widgë
 = 
wt
;

1026 
îr
 = 
	`¢d_çlg_add_obje˘
(
çlg
, &
t
);

1027 
	`çlg_‰ì
(&
hóp
);

1028 i‡(
îr
 < 0)

1029  
îr
;

1030 i‡(
size
 > 0)

1031 
√xt
;

1034 
ªtvÆ
:

1035 
	`çlg_‰ì
(&
hóp
);

1036  
îr
;

1037 
	}
}

1040 
	$çlg_decode_d≠m_gøph
(
¢d_çlg_t
 *
çlg
,

1041 
size_t
 
pos
,

1042 
¢d_soc_çlg_hdr
 *
hdr
,

1043 *
bö
, 
size_t
 
size
)

1045 
¢d_soc_çlg_d≠m_gøph_ñem
 *
g
;

1046 
¢d_çlg_obj_ãm∂©e_t
 
t
;

1047 
¢d_çlg_gøph_ãm∂©e
 *
gt
;

1048 
¢d_çlg_gøph_ñem
 *
ge
;

1049 
size_t
 
asize
;

1050 
îr
;

1052 
îr
 = 
	`çlg_decode_ãm∂©e
(
çlg
, 
pos
, 
hdr
, &
t
);

1053 i‡(
îr
 < 0)

1054  
îr
;

1056 
asize
 = (*
gt
Ë+ (
size
 / (*
g
)Ë* (*
ge
);

1057 
gt
 = 
	`Æloˇ
(
asize
);

1058 
	`mem£t
(
gt
, 0, 
asize
);

1059 
ge
 = 
gt
->
ñem
; 
size
 > 0; ge++) {

1060 
g
 = 
bö
;

1061 i‡(
size
 < (*
g
)) {

1062 
	`SNDERR
("d≠m gøph: smÆ»sizê%d", 
size
);

1063  -
EINVAL
;

1065 
ge
->
§c
 = 
g
->
sour˚
;

1066 
ge
->
˘l
 = 
g
->
c⁄åﬁ
;

1067 
ge
->
sök
 = 
g
->sink;

1068 
gt
->
cou¡
++;

1069 
	`çlg_log
(
çlg
, 'D', 
pos
, "dapm graph: src='%s' ctl='%s' sink='%s'",

1070 
ge
->
§c
, ge->
˘l
, ge->
sök
);

1071 
bö
 +(*
g
);

1072 
size
 -(*
g
);

1073 
pos
 +(*
g
);

1076 
t
.
gøph
 = 
gt
;

1077  
	`¢d_çlg_add_obje˘
(
çlg
, &
t
);

1078 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/data.c

20 
	~"çlg_loˇl.h
"

21 
	~<˘y≥.h
>

23 
	#UUID_FORMAT
 "\
%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:\
%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x"

	)

28 
¢d_soc_çlg_¥iv©e
 *
	$gë_¥iv_d©a
(
çlg_ñem
 *
ñem
)

30 
¢d_soc_çlg_¥iv©e
 *
¥iv
 = 
NULL
;

32 
ñem
->
ty≥
) {

33 
SND_TPLG_TYPE_MANIFEST
:

34 
¥iv
 = &
ñem
->
m™i„°
->priv;

37 
SND_TPLG_TYPE_MIXER
:

38 
¥iv
 = &
ñem
->
mixî_˘æ
->priv;

41 
SND_TPLG_TYPE_ENUM
:

42 
¥iv
 = &
ñem
->
íum_˘æ
->priv;

45 
SND_TPLG_TYPE_BYTES
:

46 
¥iv
 = &
ñem
->
byãs_ext
->priv;

49 
SND_TPLG_TYPE_DAPM_WIDGET
:

50 
¥iv
 = &
ñem
->
widgë
->priv;

53 
SND_TPLG_TYPE_DAI
:

54 
¥iv
 = &
ñem
->
dai
->priv;

56 
SND_TPLG_TYPE_BE
:

57 
¥iv
 = &
ñem
->
lök
->priv;

59 
SND_TPLG_TYPE_PCM
:

60 
¥iv
 = &
ñem
->
pcm
->priv;

63 
	`SNDERR
("'%s':Ço support forÖrivate data forÅype %d",

64 
ñem
->
id
,ÉÀm->
ty≥
);

67  
¥iv
;

68 
	}
}

73 
	$çlg_∑r£_ªfs
(
¢d_c⁄fig_t
 *
cfg
, 
çlg_ñem
 *
ñem
,

74 
ty≥
)

76 
¢d_c⁄fig_ty≥_t
 
cfg_ty≥
;

77 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

78 
¢d_c⁄fig_t
 *
n
;

79 c⁄° *
vÆ
 = 
NULL
;

80 
îr
, 
cou¡
;

82 
cfg_ty≥
 = 
	`¢d_c⁄fig_gë_ty≥
(
cfg
);

85 i‡(
cfg_ty≥
 =
SND_CONFIG_TYPE_STRING
) {

86 i‡(
	`¢d_c⁄fig_gë_°rög
(
cfg
, &
vÆ
) < 0)

87  -
EINVAL
;

89 
	`çlg_dbg
("\åe‡d©a: %s", 
vÆ
);

90 
îr
 = 
	`çlg_ªf_add
(
ñem
, 
ty≥
, 
vÆ
);

91 i‡(
îr
 < 0)

92  
îr
;

96 i‡(
cfg_ty≥
 !
SND_CONFIG_TYPE_COMPOUND
) {

97 
	`SNDERR
("compoundÅy≥Éx≥˘ed f‹ %s", 
ñem
->
id
);

98  -
EINVAL
;

102 
cou¡
 = 0;

103 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

104 c⁄° *
vÆ
;

106 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

107 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆ
) < 0)

110 
	`çlg_dbg
("\åe‡d©a: %s", 
vÆ
);

111 
îr
 = 
	`çlg_ªf_add
(
ñem
, 
ty≥
, 
vÆ
);

112 i‡(
îr
 < 0)

113  
îr
;

114 
cou¡
++;

117  
cou¡
;

118 
	}
}

121 
	$çlg_ßve_ªfs
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

122 
çlg_ñem
 *
ñem
, 
ty≥
,

123 c⁄° *
id
, 
çlg_buf
 *
d°
,

124 c⁄° *
pfx
)

126 
çlg_ªf
 *
ªf
, *
œ°
;

127 
li°_hód
 *
pos
;

128 
îr
, 
cou¡
;

130 
cou¡
 = 0;

131 
œ°
 = 
NULL
;

132 
	`li°_f‹_óch
(
pos
, &
ñem
->
ªf_li°
) {

133 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

134 i‡(
ªf
->
ty≥
 ==Åype) {

135 
œ°
 = 
ªf
;

136 
cou¡
++;

140 i‡(
cou¡
 == 0)

143 i‡(
cou¡
 == 1)

144  
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "%†'%s'\n", 
id
, 
œ°
->id);

146 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "%†[\n", 
id
);

147 i‡(
îr
 < 0)

148  
îr
;

149 
	`li°_f‹_óch
(
pos
, &
ñem
->
ªf_li°
) {

150 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

151 i‡(
ªf
->
ty≥
 ==Åype) {

152 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t'%s'\n", 
ªf
->
id
);

153 i‡(
îr
 < 0)

154  
îr
;

158  
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "]\n");

159 
	}
}

162 
	$çlg_∑r£_d©a_fûe
(
¢d_c⁄fig_t
 *
cfg
, 
çlg_ñem
 *
ñem
)

164 
¢d_soc_çlg_¥iv©e
 *
¥iv
 = 
NULL
;

165 c⁄° *
vÆue
 = 
NULL
;

166 
fûíame
[
PATH_MAX
];

167 *
ív
 = 
	`gëív
(
ALSA_CONFIG_TPLG_VAR
);

168 
FILE
 *
Â
;

169 
size_t
 
size
, 
byãs_ªad
;

170 
ªt
 = 0;

172 
	`çlg_dbg
("d©®D©aFûe: %s", 
ñem
->
id
);

174 i‡(
	`¢d_c⁄fig_gë_°rög
(
cfg
, &
vÆue
) < 0)

175  -
EINVAL
;

178 i‡(
ív
)

179 
	`¢¥ötf
(
fûíame
, (fûíame), "%s/%s", 
ív
, 
vÆue
);

181 
	`¢¥ötf
(
fûíame
, (filename), "%s/topology/%s",

182 
	`¢d_c⁄fig_t›dú
(), 
vÆue
);

184 
Â
 = 
	`f›í
(
fûíame
, "r");

185 i‡(
Â
 =
NULL
) {

186 
	`SNDERR
("övÆid d©®fûê∑th '%s'", 
fûíame
);

187  -
î∫o
;

190 
	`f£ek
(
Â
, 0L, 
SEEK_END
);

191 
size
 = 
	`·ñl
(
Â
);

192 
	`f£ek
(
Â
, 0L, 
SEEK_SET
);

193 i‡(
size
 <= 0) {

194 
	`SNDERR
("övÆid d©®fûêsizê%zu", 
size
);

195 
ªt
 = -
EINVAL
;

196 
îr
;

198 i‡(
size
 > 
TPLG_MAX_PRIV_SIZE
) {

199 
	`SNDERR
("d©®fûêtoÿbig %zu", 
size
);

200 
ªt
 = -
EINVAL
;

201 
îr
;

204 
¥iv
 = 
	`ˇŒoc
(1, (*¥ivË+ 
size
);

205 i‡(!
¥iv
) {

206 
ªt
 = -
ENOMEM
;

207 
îr
;

210 
byãs_ªad
 = 
	`‰ód
(&
¥iv
->
d©a
, 1, 
size
, 
Â
);

211 i‡(
byãs_ªad
 !
size
) {

212 
ªt
 = -
î∫o
;

213 
îr
;

216 
ñem
->
d©a
 = 
¥iv
;

217 
¥iv
->
size
 = size;

218 
ñem
->
size
 = (*
¥iv
) + size;

220 i‡(
	`f˛o£
(
Â
Ë=
EOF
) {

221 
	`SNDERR
("Cannot close data file.");

222  -
î∫o
;

226 
îr
:

227 
	`f˛o£
(
Â
);

228 i‡(
¥iv
)

229 
	`‰ì
(
¥iv
);

230  
ªt
;

231 
	}
}

233 
	$dump_¥iv_d©a
(
çlg_ñem
 *
ñem
 
ATTRIBUTE_UNUSED
)

235 #ifde‡
TPLG_DEBUG


236 
¢d_soc_çlg_¥iv©e
 *
¥iv
 = 
ñem
->
d©a
;

237 *
p
 = (*)
¥iv
->
d©a
;

238 
buf
[128], 
buf2
[8];

239 
i
;

241 
	`çlg_dbg
("Élem size = %d,Öriv data size = %d",

242 
ñem
->
size
, 
¥iv
->size);

244 
buf
[0] = '\0';

245 
i
 = 0; i < 
¥iv
->
size
; i++) {

246 i‡(
i
 > 0 && (i % 16) == 0) {

247 
	`çlg_dbg
("%s", 
buf
);

248 
buf
[0] = '\0';

251 
	`¢¥ötf
(
buf2
, (buf2), " %02x", *
p
++);

252 
	`°rˇt
(
buf
, 
buf2
);

255 i‡(
buf
[0])

256 
	`çlg_dbg
("%s", 
buf
);

258 
	}
}

260 
ölöe
 
	$check_nibbÀ
(
c
)

262  (
c
 >= '0' && c <= '9') ||

263 (
c
 >= 'a' && c <= 'f') ||

264 (
c
 >= 'A' && c <= 'F');

265 
	}
}

268 
	$gë_hex_num
(c⁄° *
°r
)

270 
dñims
, 
vÆues
, 
Àn
 = 
	`°æí
(
°r
);

271 c⁄° *
s
, *
íd
 = 
°r
 + 
Àn
;

274 
s
 = 
°r
;

275 
dñims
 = 
vÆues
 = 0;

276 
s
 < 
íd
) {

278 i‡(
	`is•a˚
(*
s
)) {

279 
s
++;

283 i‡(*
s
 == ':') {

284 
dñims
++;

285 
s
++;

289 i‡(
s
 + 1 <
íd
) {

290 i‡(
	`check_nibbÀ
(
s
[0]) && check_nibble(s[1])) {

291 
vÆues
++;

293 
f‹m©2
;

295 
s
++;

297 
s
++;

299 
íd
;

301 
f‹m©2
:

303 
s
 = 
°r
;

304 
dñims
 = 
vÆues
 = 0;

305 
s
 < 
íd
) {

308 i‡(
	`is•a˚
(*
s
)) {

309 
s
++;

314 i‡(*
s
 == ',') {

315 
dñims
++;

316 
s
++;

321 i‡(*
s
 ='0' && s + 2 <
íd
) {

322 i‡(
s
[1] ='x' && 
	`check_nibbÀ
(s[2])) {

323 i‡(
	`check_nibbÀ
(
s
[3]))

324 
s
++;

325 
vÆues
++;

326 
s
 += 2;

330 
s
++;

333 
íd
:

335 i‡(
vÆues
 - 1 !
dñims
)

336  -
EINVAL
;

338  
vÆues
;

339 
	}
}

342 
	$gë_uuid
(c⁄° *
°r
, *
uuid_À
)

344 
vÆ
;

345 *
tmp
, *
s
 = 
NULL
;

346 
vÆues
 = 0, 
ªt
 = 0;

348 
tmp
 = 
	`°rdup
(
°r
);

349 i‡(
tmp
 =
NULL
)

350  -
ENOMEM
;

352 i‡(
	`°rchr
(
tmp
, ':'Ë=
NULL
)

353 
d©a2
;

355 
s
 = 
	`°πok
(
tmp
, ":");

356 
s
 !
NULL
) {

357 
î∫o
 = 0;

358 
vÆ
 = 
	`°πoul
(
s
, 
NULL
, 16);

359 i‡((
î∫o
 =
ERANGE
 && 
vÆ
 =
ULONG_MAX
)

360 || (
î∫o
 !0 && 
vÆ
 == 0)

361 || (
vÆ
 > 
UCHAR_MAX
)) {

362 
	`SNDERR
("invalid value for uuid");

363 
ªt
 = -
EINVAL
;

364 
out
;

367 *(
uuid_À
 + 
vÆues
Ë()
vÆ
;

369 
vÆues
++;

370 i‡(
vÆues
 >= 16)

373 
s
 = 
	`°πok
(
NULL
, ":");

375 
out
;

377 
d©a2
:

378 
s
 = 
	`°πok
(
tmp
, ",");

380 
s
 !
NULL
) {

381 
î∫o
 = 0;

382 
vÆ
 = 
	`°πoul
(
s
, 
NULL
, 0);

383 i‡((
î∫o
 =
ERANGE
 && 
vÆ
 =
ULONG_MAX
)

384 || (
î∫o
 !0 && 
vÆ
 == 0)

385 || (
vÆ
 > 
UCHAR_MAX
)) {

386 
	`SNDERR
("invalid value for uuid");

387 
ªt
 = -
EINVAL
;

388 
out
;

391 *(
uuid_À
 + 
vÆues
Ë()
vÆ
;

393 
vÆues
++;

394 i‡(
vÆues
 >= 16)

397 
s
 = 
	`°πok
(
NULL
, ",");

400 i‡(
vÆues
 < 16) {

401 
	`SNDERR
("lessÅhan 16 integers for uuid");

402 
ªt
 = -
EINVAL
;

405 
out
:

406 
	`‰ì
(
tmp
);

407  
ªt
;

408 
	}
}

410 
	$wrôe_hex
(*
buf
, *
°r
, 
width
)

412 
vÆ
;

413 *
p
 = &
vÆ
;

415 
î∫o
 = 0;

416 i‡(
	`ß„_°πﬁ_ba£
(
°r
, &
vÆ
, 16) < 0)

417  -
EINVAL
;

419 
width
) {

421 *(*)
buf
 = *(*)
p
;

424 *(*)
buf
 = *(*)
p
;

427 *(*)
buf
 = *(*)
p
;

430  -
EINVAL
;

434 
	}
}

436 
	$c›y_d©a_hex
(*
d©a
, 
off
, c⁄° *
°r
, 
width
)

438 *
tmp
, *
s
 = 
NULL
, *
p
 = 
d©a
;

439 
ªt
;

441 
tmp
 = 
	`°rdup
(
°r
);

442 i‡(
tmp
 =
NULL
)

443  -
ENOMEM
;

445 
p
 +
off
;

446 
s
 = 
	`°πok
(
tmp
, ",:");

448 
s
 !
NULL
) {

449 
ªt
 = 
	`wrôe_hex
(
p
, 
s
, 
width
);

450 i‡(
ªt
 < 0) {

451 
	`‰ì
(
tmp
);

452  
ªt
;

455 
s
 = 
	`°πok
(
NULL
, ",:");

456 
p
 +
width
;

459 
	`‰ì
(
tmp
);

461 
	}
}

463 
	$çlg_∑r£_d©a_hex
(
¢d_c⁄fig_t
 *
cfg
, 
çlg_ñem
 *
ñem
,

464 
width
)

466 
¢d_soc_çlg_¥iv©e
 *
¥iv
;

467 c⁄° *
vÆue
 = 
NULL
;

468 
size
, 
esize
, 
off
, 
num
;

469 
ªt
;

471 
	`çlg_dbg
(" d©a: %s", 
ñem
->
id
);

473 i‡(
	`¢d_c⁄fig_gë_°rög
(
cfg
, &
vÆue
) < 0)

474  -
EINVAL
;

476 
num
 = 
	`gë_hex_num
(
vÆue
);

477 i‡(
num
 <= 0) {

478 
	`SNDERR
("mÆf‹med hex v¨übÀÜi° %s", 
vÆue
);

479  -
EINVAL
;

482 
size
 = 
num
 * 
width
;

483 
¥iv
 = 
ñem
->
d©a
;

485 i‡(
size
 > 
TPLG_MAX_PRIV_SIZE
) {

486 
	`SNDERR
("d©®toÿbig %d", 
size
);

487  -
EINVAL
;

490 i‡(
¥iv
 !
NULL
) {

491 
off
 = 
¥iv
->
size
;

492 
esize
 = 
ñem
->
size
 + size;

493 
¥iv
 = 
	`ªÆloc
’riv, 
esize
);

495 
off
 = 0;

496 
esize
 = (*
¥iv
Ë+ 
size
;

497 
¥iv
 = 
	`ˇŒoc
(1, 
esize
);

500 i‡(!
¥iv
)

501  -
ENOMEM
;

503 
ñem
->
d©a
 = 
¥iv
;

504 
¥iv
->
size
 += size;

505 
ñem
->
size
 = 
esize
;

507 
ªt
 = 
	`c›y_d©a_hex
(
¥iv
->
d©a
, 
off
, 
vÆue
, 
width
);

509 
	`dump_¥iv_d©a
(
ñem
);

510  
ªt
;

511 
	}
}

514 
	$gë_tokí_vÆue
(c⁄° *
tokí_id
,

515 
çlg_víd‹_tokís
 *
tokís
)

517 
i
;

519 
i
 = 0; i < 
tokís
->
num_tokís
; i++) {

520 i‡(
	`°rcmp
(
tokí_id
, 
tokís
->
tokí
[
i
].
id
) == 0)

521  
tokís
->
tokí
[
i
].
vÆue
;

524 
	`SNDERR
("ˇ¬Ÿ födÅokí id '%s'", 
tokí_id
);

526 
	}
}

529 
çlg_ñem
 *
	$gë_tokís
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
)

531 
çlg_ªf
 *
ªf
;

532 
li°_hód
 *
ba£
, *
pos
;

534 
ba£
 = &
ñem
->
ªf_li°
;

535 
	`li°_f‹_óch
(
pos
, 
ba£
) {

537 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

539 i‡(
ªf
->
ty≥
 !
SND_TPLG_TYPE_TOKEN
)

542 i‡(!
ªf
->
ñem
) {

543 
ªf
->
ñem
 = 
	`çlg_ñem_lookup
(&
çlg
->
tokí_li°
,

544 
ªf
->
id
, 
SND_TPLG_TYPE_TOKEN
, 
ñem
->
ödex
);

547  
ªf
->
ñem
;

550  
NULL
;

551 
	}
}

554 
boﬁ
 
	$has_tu∂es
(
çlg_ñem
 *
ñem
)

556 
çlg_ªf
 *
ªf
;

557 
li°_hód
 *
ba£
, *
pos
;

559 
ba£
 = &
ñem
->
ªf_li°
;

560 
	`li°_f‹_óch
(
pos
, 
ba£
) {

562 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

563 i‡(
ªf
->
ty≥
 =
SND_TPLG_TYPE_TUPLE
)

564  
åue
;

567  
Ál£
;

568 
	}
}

571 
	$çlg_gë_tu∂e_size
(
ty≥
)

573 
ty≥
) {

575 
SND_SOC_TPLG_TUPLE_TYPE_UUID
:

576  (
¢d_soc_çlg_víd‹_uuid_ñem
);

578 
SND_SOC_TPLG_TUPLE_TYPE_STRING
:

579  (
¢d_soc_çlg_víd‹_°rög_ñem
);

582  (
¢d_soc_çlg_víd‹_vÆue_ñem
);

584 
	}
}

587 
	$c›y_tu∂es
(
çlg_ñem
 *
ñem
,

588 
çlg_víd‹_tu∂es
 *
tu∂es
,

589 
çlg_víd‹_tokís
 *
tokís
)

591 
¢d_soc_çlg_¥iv©e
 *
¥iv
 = 
ñem
->
d©a
, *
¥iv2
;

592 
çlg_tu∂e_£t
 *
tu∂e_£t
;

593 
çlg_tu∂e
 *
tu∂e
;

594 
¢d_soc_çlg_víd‹_¨øy
 *
¨øy
;

595 
¢d_soc_çlg_víd‹_uuid_ñem
 *
uuid
;

596 
¢d_soc_çlg_víd‹_°rög_ñem
 *
°rög
;

597 
¢d_soc_çlg_víd‹_vÆue_ñem
 *
vÆue
;

598 
£t_size
, 
size
, 
off
;

599 
i
, 
j
;

600 
tokí_vÆ
;

602 
size
 = 
¥iv
 ?Öriv->size : 0;

605 
i
 = 0; i < 
tu∂es
->
num_£ts
 ; i++) {

606 
tu∂e_£t
 = 
tu∂es
->
£t
[
i
];

607 
£t_size
 = (
¢d_soc_çlg_víd‹_¨øy
)

608 + 
	`çlg_gë_tu∂e_size
(
tu∂e_£t
->
ty≥
)

609 * 
tu∂e_£t
->
num_tu∂es
;

610 
size
 +
£t_size
;

611 i‡(
size
 > 
TPLG_MAX_PRIV_SIZE
) {

612 
	`SNDERR
("d©®toÿbig %d", 
size
);

613  -
EINVAL
;

616 i‡(
¥iv
 !
NULL
) {

617 
¥iv2
 = 
	`ªÆloc
(
¥iv
, (*¥ivË+ 
size
);

618 i‡(
¥iv2
 =
NULL
) {

619 
	`‰ì
(
¥iv
);

620 
¥iv
 = 
NULL
;

622 
¥iv
 = 
¥iv2
;

625 
¥iv
 = 
	`ˇŒoc
(1, (*¥ivË+ 
size
);

627 i‡(!
¥iv
)

628  -
ENOMEM
;

630 
off
 = 
¥iv
->
size
;

631 
¥iv
->
size
 = size;

632 
ñem
->
d©a
 = 
¥iv
;

634 
¨øy
 = (
¢d_soc_çlg_víd‹_¨øy
 *)(
¥iv
->
d©a
 + 
off
);

635 
	`mem£t
(
¨øy
, 0, 
£t_size
);

636 
¨øy
->
size
 = 
£t_size
;

637 
¨øy
->
ty≥
 = 
tu∂e_£t
->type;

638 
¨øy
->
num_ñems
 = 
tu∂e_£t
->
num_tu∂es
;

641 
j
 = 0; j < 
tu∂e_£t
->
num_tu∂es
; j++) {

642 
tu∂e
 = &
tu∂e_£t
->tu∂e[
j
];

643 
tokí_vÆ
 = 
	`gë_tokí_vÆue
(
tu∂e
->
tokí
, 
tokís
);

644 i‡(
tokí_vÆ
 < 0)

645  -
EINVAL
;

647 
tu∂e_£t
->
ty≥
) {

648 
SND_SOC_TPLG_TUPLE_TYPE_UUID
:

649 
uuid
 = &
¨øy
->uuid[
j
];

650 
uuid
->
tokí
 = 
tokí_vÆ
;

651 
	`mem˝y
(
uuid
->uuid, 
tu∂e
->uuid, 16);

654 
SND_SOC_TPLG_TUPLE_TYPE_STRING
:

655 
°rög
 = &
¨øy
->°rög[
j
];

656 
°rög
->
tokí
 = 
tokí_vÆ
;

657 
	`¢d_°æ˝y
(
°rög
->°rög, 
tu∂e
->string,

658 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

662 
vÆue
 = &
¨øy
->vÆue[
j
];

663 
vÆue
->
tokí
 = 
tokí_vÆ
;

664 
vÆue
->vÆuê
tu∂e
->value;

671 
	}
}

674 
	$buûd_tu∂es
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
)

676 
çlg_ªf
 *
ªf
;

677 
li°_hód
 *
ba£
, *
pos
;

678 
çlg_ñem
 *
tu∂es
, *
tokís
;

679 
îr
;

681 
ba£
 = &
ñem
->
ªf_li°
;

682 
	`li°_f‹_óch
(
pos
, 
ba£
) {

684 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

686 i‡(
ªf
->
ty≥
 !
SND_TPLG_TYPE_TUPLE
)

689 
	`çlg_dbg
("tu∂e†'%s' u£d by d©®'%s'", 
ªf
->
id
, 
ñem
->id);

691 i‡(!
ªf
->
ñem
)

692 
ªf
->
ñem
 = 
	`çlg_ñem_lookup
(&
çlg
->
tu∂e_li°
,

693 
ªf
->
id
, 
SND_TPLG_TYPE_TUPLE
, 
ñem
->
ödex
);

694 
tu∂es
 = 
ªf
->
ñem
;

695 i‡(!
tu∂es
) {

696 
	`SNDERR
("ˇ¬Ÿ födÅu∂e†%s", 
ªf
->
id
);

697  -
EINVAL
;

700 
tokís
 = 
	`gë_tokís
(
çlg
, 
tu∂es
);

701 i‡(!
tokís
) {

702 
	`SNDERR
("ˇ¬Ÿ födÅokí f‹ %s", 
ªf
->
id
);

703  -
EINVAL
;

707 
îr
 = 
	`c›y_tu∂es
(
ñem
, 
tu∂es
->tu∂es, 
tokís
->tokens);

708 i‡(
îr
 < 0)

709  
îr
;

713 
	}
}

715 #i‚de‡
DOC_HIDDEN


716 
	stu∂e_ty≥
 {

717 
	mty≥
;

718 c⁄° *
	m«me
;

719 
	msize
;

723 
tu∂e_ty≥
 
	gtu∂e_ty≥s
[] = {

725 .
ty≥
 = 
SND_SOC_TPLG_TUPLE_TYPE_UUID
,

726 .
	g«me
 = "uuid",

727 .
	gsize
 = 4,

730 .
	gty≥
 = 
SND_SOC_TPLG_TUPLE_TYPE_STRING
,

731 .
	g«me
 = "string",

732 .
	gsize
 = 6,

735 .
	gty≥
 = 
SND_SOC_TPLG_TUPLE_TYPE_BOOL
,

736 .
	g«me
 = "bool",

737 .
	gsize
 = 4,

740 .
	gty≥
 = 
SND_SOC_TPLG_TUPLE_TYPE_BYTE
,

741 .
	g«me
 = "byte",

742 .
	gsize
 = 4,

745 .
	gty≥
 = 
SND_SOC_TPLG_TUPLE_TYPE_SHORT
,

746 .
	g«me
 = "short",

747 .
	gsize
 = 5,

750 .
	gty≥
 = 
SND_SOC_TPLG_TUPLE_TYPE_WORD
,

751 .
	g«me
 = "word",

752 .
	gsize
 = 4

756 
	$gë_tu∂e_ty≥
(c⁄° *
«me
)

758 
tu∂e_ty≥
 *
t
;

759 
i
;

762 (*
«me
 >= '0' && *name <= '9') || *name == '_')

763 
«me
++;

764 
i
 = 0; i < 
	`ARRAY_SIZE
(
tu∂e_ty≥s
); i++) {

765 
t
 = &
tu∂e_ty≥s
[
i
];

766 i‡(
	`°∫ˇ£cmp
(
t
->
«me
,Çame,Å->
size
) == 0)

767  
t
->
ty≥
;

769  -
EINVAL
;

770 
	}
}

772 c⁄° *
	$gë_tu∂e_ty≥_«me
(
ty≥
)

774 
i
;

776 
i
 = 0; i < 
	`ARRAY_SIZE
(
tu∂e_ty≥s
); i++)

777 i‡(
tu∂e_ty≥s
[
i
].
ty≥
 ==Åype)

778  
tu∂e_ty≥s
[
i
].
«me
;

779  
NULL
;

780 
	}
}

782 
	$∑r£_tu∂e_£t
(
¢d_c⁄fig_t
 *
cfg
,

783 
çlg_tu∂e_£t
 **
s
)

785 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

786 
¢d_c⁄fig_t
 *
n
;

787 c⁄° *
id
, *
vÆue
;

788 
çlg_tu∂e_£t
 *
£t
;

789 
num_tu∂es
 = 0;

790 
çlg_tu∂e
 *
tu∂e
;

791 
tu∂e_vÆ
;

792 
ty≥
, 
ivÆ
;

794 
	`¢d_c⁄fig_gë_id
(
cfg
, &
id
);

796 
ty≥
 = 
	`gë_tu∂e_ty≥
(
id
);

797 i‡(
ty≥
 < 0) {

798 
	`SNDERR
("övÆidÅu∂êty≥ '%s'", 
id
);

799  
ty≥
;

802 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
)

803 
num_tu∂es
++;

804 i‡(!
num_tu∂es
)

807 
	`çlg_dbg
("\à%d %†tu∂es:", 
num_tu∂es
, 
id
);

808 
£t
 = 
	`ˇŒoc
(1, (*£tË+ 
num_tu∂es
 * (
çlg_tu∂e
));

809 i‡(!
£t
)

810  -
ENOMEM
;

812 
£t
->
ty≥
 =Åype;

814 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

816 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

819 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

822 
tu∂e
 = &
£t
->tu∂e[£t->
num_tu∂es
];

823 
	`¢d_°æ˝y
(
tu∂e
->
tokí
, 
id
,

824 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

826 
ty≥
) {

827 
SND_SOC_TPLG_TUPLE_TYPE_UUID
:

828 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆue
) < 0)

830 i‡(
	`gë_uuid
(
vÆue
, 
tu∂e
->
uuid
) < 0)

831 
îr
;

834 
SND_SOC_TPLG_TUPLE_TYPE_STRING
:

835 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆue
) < 0)

837 
	`¢d_°æ˝y
(
tu∂e
->
°rög
, 
vÆue
,

838 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

839 
	`çlg_dbg
("\t\t%†%s", 
tu∂e
->
tokí
,Åu∂e->
°rög
);

842 
SND_SOC_TPLG_TUPLE_TYPE_BOOL
:

843 
ivÆ
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

844 i‡(
ivÆ
 < 0)

846 
tu∂e
->
vÆue
 = 
ivÆ
;

847 
	`çlg_dbg
("\t\t%†%d", 
tu∂e
->
tokí
,Åu∂e->
vÆue
);

850 
SND_SOC_TPLG_TUPLE_TYPE_BYTE
:

851 
SND_SOC_TPLG_TUPLE_TYPE_SHORT
:

852 
SND_SOC_TPLG_TUPLE_TYPE_WORD
:

853 
ivÆ
 = 
	`çlg_gë_unsig√d
(
n
, &
tu∂e_vÆ
, 0);

854 i‡(
ivÆ
 < 0) {

855 
	`SNDERR
("tu∂ê%s: %s", 
id
, 
	`¢d_°ªº‹
(
ivÆ
));

856 
îr
;

861 (
ty≥
 =
SND_SOC_TPLG_TUPLE_TYPE_SHORT


862 && 
tu∂e_vÆ
 > 
USHRT_MAX
) ||

863 (
ty≥
 =
SND_SOC_TPLG_TUPLE_TYPE_BYTE


864 && 
tu∂e_vÆ
 > 
UCHAR_MAX
)) {

865 
	`SNDERR
("tu∂ê%s: invÆid vÆue", 
id
);

866 
îr
;

869 
tu∂e
->
vÆue
 = 
tu∂e_vÆ
;

870 
	`çlg_dbg
("\t\t%†0x%x", 
tu∂e
->
tokí
,Åu∂e->
vÆue
);

877 
£t
->
num_tu∂es
++;

880 *
s
 = 
£t
;

883 
îr
:

884 
	`‰ì
(
£t
);

885  -
EINVAL
;

886 
	}
}

889 
	$çlg_ßve_tu∂e_£t
(
çlg_víd‹_tu∂es
 *
tu∂es
,

890 
£t_ödex
,

891 
çlg_buf
 *
d°
, c⁄° *
pfx
)

893 
çlg_tu∂e_£t
 *
£t
;

894 
çlg_tu∂e
 *
tu∂e
;

895 c⁄° *
s
, *
fmt
;

896 
buf
[32];

897 
i
;

898 
îr
;

900 
£t
 = 
tu∂es
->£t[
£t_ödex
];

901 i‡(
£t
->
num_tu∂es
 == 0)

903 
s
 = 
	`gë_tu∂e_ty≥_«me
(
£t
->
ty≥
);

904 i‡(
s
 =
NULL
)

905  -
EINVAL
;

906 i‡(
tu∂es
->
num_£ts
 < 10)

907 
fmt
 = "%u_";

908 i‡(
tu∂es
->
num_£ts
 < 100)

909 
fmt
 = "%02u_";

910 i‡(
tu∂es
->
num_£ts
 < 1000)

911 
fmt
 = "%03u_";

913  -
EINVAL
;

914 i‡(
£t
->
num_tu∂es
 > 1) {

915 
	`¢¥ötf
(
buf
, (buf), "tu∂es.%s%%†{\n", 
fmt
);

916 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, 
buf
, 
£t_ödex
, 
s
);

917 i‡(
îr
 < 0)

918  
îr
;

920 
i
 = 0; i < 
£t
->
num_tu∂es
; i++) {

921 
tu∂e
 = &
£t
->tu∂e[
i
];

922 i‡(
£t
->
num_tu∂es
 == 1) {

923 
	`¢¥ötf
(
buf
, (buf), "tu∂es.%s%%s.'%%s' ", 
fmt
);

924 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, 
buf
,

925 
£t_ödex
, 
s
, 
tu∂e
->
tokí
);

927 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t'%s' ",

928 
tu∂e
->
tokí
);

930 i‡(
îr
 < 0)

931  
îr
;

932 
£t
->
ty≥
) {

933 
SND_SOC_TPLG_TUPLE_TYPE_UUID
:

934 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'" 
UUID_FORMAT
 "'\n",

935 
tu∂e
->
uuid
[0],Åuple->uuid[1],

936 
tu∂e
->
uuid
[2],Åuple->uuid[3],

937 
tu∂e
->
uuid
[4],Åuple->uuid[5],

938 
tu∂e
->
uuid
[6],Åuple->uuid[7],

939 
tu∂e
->
uuid
[8],Åuple->uuid[9],

940 
tu∂e
->
uuid
[10],Åuple->uuid[11],

941 
tu∂e
->
uuid
[12],Åuple->uuid[13],

942 
tu∂e
->
uuid
[14],Åuple->uuid[15]);

944 
SND_SOC_TPLG_TUPLE_TYPE_STRING
:

945 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s'\n",

946 
tu∂e
->
°rög
);

948 
SND_SOC_TPLG_TUPLE_TYPE_BOOL
:

949 
SND_SOC_TPLG_TUPLE_TYPE_BYTE
:

950 
SND_SOC_TPLG_TUPLE_TYPE_SHORT
:

951 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "%u\n", 
tu∂e
->
vÆue
);

953 
SND_SOC_TPLG_TUPLE_TYPE_WORD
:

954 
	`çlg_ni˚_vÆue_f‹m©
(
buf
, (buf), 
tu∂e
->
vÆue
);

955 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "%s\n", 
buf
);

958  -
EINVAL
;

960 i‡(
îr
 < 0)

961  
îr
;

963 i‡(
£t
->
num_tu∂es
 > 1)

964  
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

966 
	}
}

968 
	$∑r£_tu∂e_£ts
(
¢d_c⁄fig_t
 *
cfg
,

969 
çlg_víd‹_tu∂es
 *
tu∂es
)

971 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

972 
¢d_c⁄fig_t
 *
n
;

973 c⁄° *
id
;

974 
num_tu∂e_£ts
 = 0;

975 
îr
;

977 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

978 i‡(
	`¢d_c⁄fig_gë_id
(
cfg
, &
id
) >= 0)

979 
	`SNDERR
("compoundÅy≥Éx≥˘ed f‹ %s", 
id
);

980  -
EINVAL
;

983 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

984 
num_tu∂e_£ts
++;

987 i‡(!
num_tu∂e_£ts
)

990 
tu∂es
->
£t
 = 
	`ˇŒoc
(1, 
num_tu∂e_£ts
 * (*));

991 i‡(!
tu∂es
->
£t
)

992  -
ENOMEM
;

994 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

995 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

996 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

997 
	`SNDERR
("compoundÅypeÉxpected for %s, is %d",

998 
id
, 
	`¢d_c⁄fig_gë_ty≥
(
n
));

999  -
EINVAL
;

1002 
îr
 = 
	`∑r£_tu∂e_£t
(
n
, &
tu∂es
->
£t
[tu∂es->
num_£ts
]);

1003 i‡(
îr
 < 0)

1004  
îr
;

1007 i‡(
tu∂es
->
£t
[tu∂es->
num_£ts
])

1008 
tu∂es
->
num_£ts
++;

1012 
	}
}

1015 
	$çlg_ßve_tu∂e_£ts
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

1016 
çlg_ñem
 *
ñem
,

1017 
çlg_buf
 *
d°
, c⁄° *
pfx
)

1019 
çlg_víd‹_tu∂es
 *
tu∂es
 = 
ñem
->tuples;

1020 
i
;

1021 
îr
 = 0;

1023 
i
 = 0; i < 
tu∂es
->
num_£ts
; i++) {

1024 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "");

1025 i‡(
îr
 < 0)

1027 
îr
 = 
	`çlg_ßve_tu∂e_£t
(
tu∂es
, 
i
, 
d°
, 
pfx
);

1028 i‡(
îr
 < 0)

1031  
îr
;

1032 
	}
}

1036 
	$çlg_∑r£_tokís
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

1037 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

1039 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1040 
¢d_c⁄fig_t
 *
n
;

1041 c⁄° *
id
;

1042 
çlg_ñem
 *
ñem
;

1043 
çlg_víd‹_tokís
 *
tokís
;

1044 
num_tokís
 = 0, 
vÆue
;

1046 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_TOKEN
);

1047 i‡(!
ñem
)

1048  -
ENOMEM
;

1050 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1051 
num_tokís
++;

1054 i‡(!
num_tokís
)

1057 
	`çlg_dbg
(" Víd‹Åokís: %s, %dÅokís", 
ñem
->
id
, 
num_tokís
);

1059 
tokís
 = 
	`ˇŒoc
(1, (*tokens)

1060 + 
num_tokís
 * (
çlg_tokí
));

1061 i‡(!
tokís
)

1062  -
ENOMEM
;

1063 
ñem
->
tokís
 =Åokens;

1065 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1067 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1068 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1071 i‡(
	`çlg_gë_öãgî
(
n
, &
vÆue
, 0))

1074 
	`¢d_°æ˝y
(
tokís
->
tokí
[tokís->
num_tokís
].
id
, id,

1075 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1076 
tokís
->
tokí
[tokís->
num_tokís
].
vÆue
 = value;

1077 
	`çlg_dbg
("\t\à%†: %d", 
tokís
->
tokí
[tokís->
num_tokís
].
id
,

1078 
tokís
->
tokí
[tokís->
num_tokís
].
vÆue
);

1079 
tokís
->
num_tokís
++;

1083 
	}
}

1086 
	$çlg_ßve_tokís
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

1087 
çlg_ñem
 *
ñem
,

1088 
çlg_buf
 *
d°
, c⁄° *
pfx
)

1090 
çlg_víd‹_tokís
 *
tokís
 = 
ñem
->tokens;

1091 
i
;

1092 
îr
;

1094 i‡(!
tokís
 ||Åokís->
num_tokís
 == 0)

1097 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s' {\n", 
ñem
->
id
);

1098 i‡(
îr
 < 0)

1099  
îr
;

1100 
i
 = 0; 
îr
 >0 && i < 
tokís
->
num_tokís
; i++)

1101 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t'%s' %u\n",

1102 
tokís
->
tokí
[
i
].
id
,

1103 
tokís
->
tokí
[
i
].
vÆue
);

1104 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

1105 i‡(
îr
 < 0)

1106  
îr
;

1108 
	}
}

1112 
	$çlg_∑r£_tu∂es
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

1113 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

1115 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1116 
¢d_c⁄fig_t
 *
n
;

1117 c⁄° *
id
, *
vÆue
;

1118 
çlg_ñem
 *
ñem
;

1119 
çlg_víd‹_tu∂es
 *
tu∂es
;

1120 
îr
;

1122 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_TUPLE
);

1123 i‡(!
ñem
)

1124  -
ENOMEM
;

1126 
	`çlg_dbg
(" Víd‹ Tu∂es: %s", 
ñem
->
id
);

1128 
tu∂es
 = 
	`ˇŒoc
(1, (*tuples));

1129 i‡(!
tu∂es
)

1130  -
ENOMEM
;

1131 
ñem
->
tu∂es
 =Åuples;

1133 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1135 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1136 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1139 i‡(
	`°rcmp
(
id
, "tokens") == 0) {

1140 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆue
) < 0)

1141  -
EINVAL
;

1142 
	`çlg_ªf_add
(
ñem
, 
SND_TPLG_TYPE_TOKEN
, 
vÆue
);

1143 
	`çlg_dbg
("\àª„∏tÿvíd‹Åokís: %s", 
vÆue
);

1146 i‡(
	`°rcmp
(
id
, "tuples") == 0) {

1147 
îr
 = 
	`∑r£_tu∂e_£ts
(
n
, 
tu∂es
);

1148 i‡(
îr
 < 0)

1149  
îr
;

1154 
	}
}

1157 
	$çlg_ßve_tu∂es
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

1158 
çlg_ñem
 *
ñem
,

1159 
çlg_buf
 *
d°
, c⁄° *
pfx
)

1161 
pfx2
[16];

1162 
îr
;

1164 i‡(!
ñem
->
tu∂es
)

1167 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s' {\n", 
ñem
->
id
);

1168 
	`¢¥ötf
(
pfx2
, ’fx2), "%s\t", 
pfx
 ?: "");

1169 i‡(
îr
 >= 0)

1170 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_TOKEN
,

1171 "tokís", 
d°
, 
pfx2
);

1172 i‡(
îr
 >= 0)

1173 
îr
 = 
	`çlg_ßve_tu∂e_£ts
(
çlg
, 
ñem
, 
d°
, 
pfx2
);

1174 i‡(
îr
 >= 0)

1175 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

1177 
	}
}

1180 
	$çlg_‰ì_tu∂es
(*
obj
)

1182 
çlg_víd‹_tu∂es
 *
tu∂es
 = (çlg_víd‹_tu∂e†*)
obj
;

1183 
i
;

1185 i‡(!
tu∂es
 || !tu∂es->
£t
)

1188 
i
 = 0; i < 
tu∂es
->
num_£ts
; i++)

1189 
	`‰ì
(
tu∂es
->
£t
[
i
]);

1191 
	`‰ì
(
tu∂es
->
£t
);

1192 
	}
}

1196 
	$çlg_∑r£_m™i„°_d©a
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

1197 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

1199 
¢d_soc_çlg_m™i„°
 *
m™i„°
;

1200 
çlg_ñem
 *
ñem
;

1201 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1202 
¢d_c⁄fig_t
 *
n
;

1203 c⁄° *
id
;

1204 
îr
;

1206 i‡(!
	`li°_em±y
(&
çlg
->
m™i„°_li°
)) {

1207 
	`SNDERR
("already has manifest data");

1208  -
EINVAL
;

1211 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_MANIFEST
);

1212 i‡(!
ñem
)

1213  -
ENOMEM
;

1215 
m™i„°
 = 
ñem
->manifest;

1216 
m™i„°
->
size
 = 
ñem
->size;

1218 
	`çlg_dbg
(" M™i„°: %s", 
ñem
->
id
);

1220 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1221 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1222 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1226 i‡(
	`°rcmp
(
id
, "comment") == 0)

1228 i‡(
id
[0] == '#')

1232 i‡(
	`°rcmp
(
id
, "data") == 0) {

1233 
îr
 = 
	`çlg_∑r£_ªfs
(
n
, 
ñem
, 
SND_TPLG_TYPE_DATA
);

1234 i‡(
îr
 < 0)

1235  
îr
;

1241 
	}
}

1244 
	$çlg_ßve_m™i„°_d©a
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

1245 
çlg_ñem
 *
ñem
, 
çlg_buf
 *
d°
,

1246 c⁄° *
pfx
)

1248 
li°_hód
 *
pos
;

1249 
çlg_ªf
 *
ªf
;

1250 
îr
, 
ödex
, 
cou¡
;

1253 
cou¡
 = 0;

1254 
	`li°_f‹_óch
(
pos
, &
ñem
->
ªf_li°
) {

1255 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

1256 i‡(
ªf
->
ty≥
 !
SND_TPLG_TYPE_DATA
)

1258 
cou¡
++;

1260 i‡(
cou¡
 == 0)

1261  
	`çlg_ßve_¥ötf
(
d°
, 
NULL
,

1262 "'%s'.commíà'em±y'\n", 
ñem
->
id
);

1263 i‡(
cou¡
 > 1) {

1264 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s'.d©®[\n", 
ñem
->
id
);

1265 i‡(
îr
 < 0)

1266  
îr
;

1268 
ödex
 = 0;

1269 
	`li°_f‹_óch
(
pos
, &
ñem
->
ªf_li°
) {

1270 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

1271 i‡(
ªf
->
ty≥
 !
SND_TPLG_TYPE_DATA
)

1273 i‡(
cou¡
 == 1) {

1274 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s'.data.%u '%s'\n",

1275 
ñem
->
id
, 
ödex
, 
ªf
->id);

1277 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t'%s'\n", 
ªf
->
id
);

1279 i‡(
îr
 < 0)

1280  
îr
;

1281 
ödex
++;

1283 i‡(
cou¡
 > 1) {

1284 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "]\n");

1285 i‡(
îr
 < 0)

1286  
îr
;

1289 
	}
}

1292 
	$çlg_buûd_m™i„°_d©a
(
¢d_çlg_t
 *
çlg
)

1294 
li°_hód
 *
ba£
, *
pos
;

1295 
çlg_ñem
 *
ñem
 = 
NULL
;

1296 
çlg_ªf
 *
ªf
;

1297 
¢d_soc_çlg_m™i„°
 *
m™i„°
;

1298 
îr
 = 0;

1300 
ba£
 = &
çlg
->
m™i„°_li°
;

1301 
	`li°_f‹_óch
(
pos
, 
ba£
) {

1303 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

1307 i‡(!
ñem
)

1310 
ba£
 = &
ñem
->
ªf_li°
;

1313 
	`li°_f‹_óch
(
pos
, 
ba£
) {

1315 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

1316 i‡(
ªf
->
ñem
)

1319 i‡(
ªf
->
ty≥
 =
SND_TPLG_TYPE_DATA
) {

1320 
îr
 = 
	`çlg_c›y_d©a
(
çlg
, 
ñem
, 
ªf
);

1321 i‡(
îr
 < 0)

1322  
îr
;

1326 
m™i„°
 = 
ñem
->manifest;

1327 i‡(!
m™i„°
->
¥iv
.
size
)

1330 
çlg
->
m™i„°_pd©a
 = 
	`mÆloc
(
m™i„°
->
¥iv
.
size
);

1331 i‡(!
çlg
->
m™i„°_pd©a
)

1332  -
ENOMEM
;

1334 
çlg
->
m™i„°
.
¥iv
.
size
 = manifest->priv.size;

1335 
	`mem˝y
(
çlg
->
m™i„°_pd©a
, 
m™i„°
->
¥iv
.
d©a
, m™i„°->¥iv.
size
);

1337 
	}
}

1344 
	$çlg_∑r£_d©a
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

1345 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

1347 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1348 
¢d_c⁄fig_t
 *
n
;

1349 c⁄° *
id
;

1350 
îr
 = 0, 
ivÆ
;

1351 
çlg_ñem
 *
ñem
;

1353 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_DATA
);

1354 i‡(!
ñem
)

1355  -
ENOMEM
;

1357 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1359 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1360 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0) {

1364 i‡(
	`°rcmp
(
id
, "file") == 0) {

1365 
îr
 = 
	`çlg_∑r£_d©a_fûe
(
n
, 
ñem
);

1366 i‡(
îr
 < 0) {

1367 
	`SNDERR
("failedÅoÖarse data file");

1368  
îr
;

1373 i‡(
	`°rcmp
(
id
, "bytes") == 0) {

1374 
îr
 = 
	`çlg_∑r£_d©a_hex
(
n
, 
ñem
, 1);

1375 i‡(
îr
 < 0) {

1376 
	`SNDERR
("failedÅoÖarse data bytes");

1377  
îr
;

1382 i‡(
	`°rcmp
(
id
, "shorts") == 0) {

1383 
îr
 = 
	`çlg_∑r£_d©a_hex
(
n
, 
ñem
, 2);

1384 i‡(
îr
 < 0) {

1385 
	`SNDERR
("failedÅoÖarse data shorts");

1386  
îr
;

1391 i‡(
	`°rcmp
(
id
, "words") == 0) {

1392 
îr
 = 
	`çlg_∑r£_d©a_hex
(
n
, 
ñem
, 4);

1393 i‡(
îr
 < 0) {

1394 
	`SNDERR
("failedÅoÖarse data words");

1395  
îr
;

1400 i‡(
	`°rcmp
(
id
, "tuples") == 0) {

1401 
îr
 = 
	`çlg_∑r£_ªfs
(
n
, 
ñem
, 
SND_TPLG_TYPE_TUPLE
);

1402 i‡(
îr
 < 0)

1403  
îr
;

1407 i‡(
	`°rcmp
(
id
, "type") == 0) {

1408 i‡(
	`çlg_gë_öãgî
(
n
, &
ivÆ
, 0))

1409  -
EINVAL
;

1411 
ñem
->
víd‹_ty≥
 = 
ivÆ
;

1412 
	`çlg_dbg
("\t%s: %d", 
id
, 
ñem
->
ödex
);

1417  
îr
;

1418 
	}
}

1421 
	$çlg_ßve_d©a
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

1422 
çlg_ñem
 *
ñem
,

1423 
çlg_buf
 *
d°
, c⁄° *
pfx
)

1425 
¢d_soc_çlg_¥iv©e
 *
¥iv
 = 
ñem
->
d©a
;

1426 
li°_hód
 *
pos
;

1427 
çlg_ªf
 *
ªf
;

1428 
pfx2
[16];

1429 
i
, 
cou¡
;

1430 
îr
;

1432 
cou¡
 = 0;

1433 i‡(
¥iv
 &&Öriv->
size
 > 0)

1434 
cou¡
++;

1435 
	`li°_f‹_óch
(
pos
, &
ñem
->
ªf_li°
) {

1436 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

1437 i‡(
ªf
->
ty≥
 =
SND_TPLG_TYPE_TUPLE
)

1438 
cou¡
++;

1440 i‡(
ñem
->
víd‹_ty≥
 > 0)

1441 
cou¡
++;

1443 i‡(
cou¡
 > 1) {

1444 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s' {\n", 
ñem
->
id
);

1445 i‡(
îr
 >= 0)

1446 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "");

1448 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s'.", 
ñem
->
id
);

1450 i‡(
îr
 >0 && 
¥iv
 &&Öriv->
size
 > 0) {

1451 i‡(
cou¡
 > 1) {

1452 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "");

1453 i‡(
îr
 < 0)

1454  
îr
;

1456 i‡(
¥iv
->
size
 > 8) {

1457 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "bytes\n");

1458 i‡(
îr
 >= 0)

1459 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t'");

1461 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "bytes '");

1463 i‡(
îr
 < 0)

1464  
îr
;

1465 
i
 = 0; i < 
¥iv
->
size
; i++) {

1466 i‡(
i
 > 0 && (i % 8) == 0) {

1467 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, ":\n");

1468 i‡(
îr
 < 0)

1469  
îr
;

1470 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t ");

1471 i‡(
îr
 < 0)

1472  
îr
;

1474 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "%s%02x",

1475 (
i
 % 8) == 0 ? "" : ":",

1476 ()
¥iv
->
d©a
[
i
]);

1477 i‡(
îr
 < 0)

1478  
îr
;

1480 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'\n");

1482 
	`¢¥ötf
(
pfx2
, ’fx2), "%s\t", 
pfx
 ?: "");

1483 i‡(
îr
 >= 0)

1484 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_TUPLE
,

1485 "tu∂es", 
d°
,

1486 
cou¡
 > 1 ? 
pfx2
 : 
NULL
);

1487 i‡(
îr
 >0 && 
ñem
->
víd‹_ty≥
 > 0)

1488 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "type %u",

1489 
ñem
->
víd‹_ty≥
);

1490 i‡(
îr
 >0 && 
cou¡
 > 1)

1491 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

1492  
îr
;

1493 
	}
}

1500 
	$çlg_c›y_d©a
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

1501 
çlg_ªf
 *
ªf
)

1503 
çlg_ñem
 *
ªf_ñem
;

1504 
¢d_soc_çlg_¥iv©e
 *
¥iv
, *
ﬁd_¥iv
;

1505 
¥iv_d©a_size
, 
ﬁd_¥iv_d©a_size
;

1506 *
obj
;

1508 
ªf_ñem
 = 
	`çlg_ñem_lookup
(&
çlg
->
pd©a_li°
,

1509 
ªf
->
id
, 
SND_TPLG_TYPE_DATA
, 
ñem
->
ödex
);

1510 i‡(!
ªf_ñem
) {

1511 
	`SNDERR
("cannot find data '%s'Ñeferenced by"

1512 "ÉÀmíà'%s'", 
ªf
->
id
, 
ñem
->id);

1513  -
EINVAL
;

1516 
	`çlg_dbg
("D©®'%s' u£d by '%s'", 
ªf
->
id
, 
ñem
->id);

1518 i‡(!
ªf_ñem
->
d©a
 || !ªf_ñem->d©a->
size
) {

1519 
ªf
->
ñem
 = 
ªf_ñem
;

1523 
ﬁd_¥iv
 = 
	`gë_¥iv_d©a
(
ñem
);

1524 i‡(!
ﬁd_¥iv
)

1525  -
EINVAL
;

1526 
ﬁd_¥iv_d©a_size
 = 
ﬁd_¥iv
->
size
;

1528 
¥iv_d©a_size
 = 
ªf_ñem
->
d©a
->
size
;

1529 
obj
 = 
	`ªÆloc
(
ñem
->obj,

1530 
ñem
->
size
 + 
¥iv_d©a_size
);

1531 i‡(!
obj
)

1532  -
ENOMEM
;

1533 
ñem
->
obj
 = obj;

1535 
¥iv
 = 
	`gë_¥iv_d©a
(
ñem
);

1536 i‡(!
¥iv
)

1537  -
EINVAL
;

1540 
ñem
->
size
 +
¥iv_d©a_size
;

1541 
¥iv
->
size
 = 
¥iv_d©a_size
 + 
ﬁd_¥iv_d©a_size
;

1542 
ªf_ñem
->
compound_ñem
 = 1;

1543 
	`mem˝y
(
¥iv
->
d©a
 + 
ﬁd_¥iv_d©a_size
,

1544 
ªf_ñem
->
d©a
->d©a, 
¥iv_d©a_size
);

1546 
ªf
->
ñem
 = 
ªf_ñem
;

1548 
	}
}

1551 
	$çlg_buûd_d©a
(
¢d_çlg_t
 *
çlg
)

1553 
li°_hód
 *
ba£
, *
pos
;

1554 
çlg_ñem
 *
ñem
;

1555 
îr
 = 0;

1557 
ba£
 = &
çlg
->
pd©a_li°
;

1558 
	`li°_f‹_óch
(
pos
, 
ba£
) {

1560 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

1561 i‡(
	`has_tu∂es
(
ñem
)) {

1562 
îr
 = 
	`buûd_tu∂es
(
çlg
, 
ñem
);

1563 i‡(
îr
 < 0)

1564  
îr
;

1569 
	}
}

1572 
	$çlg_decode_m™i„°_d©a
(
¢d_çlg_t
 *
çlg
,

1573 
size_t
 
pos
,

1574 
¢d_soc_çlg_hdr
 *
hdr
,

1575 *
bö
, 
size_t
 
size
)

1577 
¢d_soc_çlg_m™i„°
 *
m
 = 
bö
;

1578 
çlg_ñem
 *
ñem
;

1579 
size_t
 
off
;

1581 i‡(
hdr
->
ödex
 != 0) {

1582 
	`SNDERR
("m™i„° - wr⁄g index %d", 
hdr
->
ödex
);

1583  -
EINVAL
;

1586 i‡((*
m
Ë> 
size
) {

1587 
	`SNDERR
("manifest - wrong size %zd (minimal %zd)",

1588 
size
, (*
m
));

1589  -
EINVAL
;

1592 i‡(
m
->
size
 != (*m)) {

1593 
	`SNDERR
("m™i„° - wr⁄g sru˘uª sizê%d", 
m
->
size
);

1594  -
EINVAL
;

1597 
off
 = 
	`off£tof
(
¢d_soc_çlg_m™i„°
, 
¥iv
);

1598 i‡(
off
 + 
m
->
¥iv
.
size
 > size) {

1599 
	`SNDERR
("m™i„° - wr⁄gÖriv©êsizê%d", 
m
->
¥iv
.
size
);

1600  -
EINVAL
;

1603 
çlg
->
m™i„°
 = *
m
;

1605 
bö
 +
off
;

1606 
size
 -
off
;

1607 
pos
 +
off
;

1609 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
, "manifest",

1610 
SND_TPLG_TYPE_MANIFEST
);

1611 i‡(!
ñem
)

1612  -
ENOMEM
;

1614 
	`çlg_log
(
çlg
, 'D', 
pos
, "m™i„°:Öriv©êsizê%zd", 
size
);

1615  
	`çlg_add_d©a
(
çlg
, 
ñem
, 
bö
, 
size
);

1616 
	}
}

1618 
	$çlg_add_tokí
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
∑ª¡
,

1619 
tokí
,

1620 
°r_ªf
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
])

1622 
çlg_ñem
 *
ñem
;

1623 
çlg_tokí
 *
t
;

1624 
çlg_víd‹_tokís
 *
tokís
;

1625 
i
;

1626 
size_t
 
size
;

1628 
ñem
 = 
	`çlg_ñem_lookup
(&
çlg
->
tokí_li°
, 
∑ª¡
->
id
,

1629 
SND_TPLG_TYPE_TOKEN
, 
∑ª¡
->
ödex
);

1630 i‡(
ñem
 =
NULL
) {

1631 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
, 
∑ª¡
->
id
,

1632 
SND_TPLG_TYPE_TOKEN
);

1633 i‡(!
ñem
)

1634  -
ENOMEM
;

1637 
tokís
 = 
ñem
->tokens;

1638 i‡(
tokís
) {

1639 
i
 = 0; i < 
tokís
->
num_tokís
; i++) {

1640 
t
 = &
tokís
->
tokí
[
i
];

1641 i‡(
t
->
vÆue
 =
tokí
)

1642 
found
;

1644 
size
 = (*
tokís
) +

1645 (
tokís
->
num_tokís
 + 1Ë* (
çlg_tokí
);

1646 
tokís
 = 
	`ªÆloc
—okís, 
size
);

1648 
size
 = (*
tokís
Ë+ 1 * (
çlg_tokí
);

1649 
tokís
 = 
	`ˇŒoc
(1, 
size
);

1652 i‡(!
tokís
)

1653  -
ENOMEM
;

1655 
	`mem£t
(&
tokís
->
tokí
[tokís->
num_tokís
], 0, (
çlg_tokí
));

1656 
ñem
->
tokís
 =Åokens;

1657 
t
 = &
tokís
->
tokí
[tokís->
num_tokís
];

1658 
tokís
->
num_tokís
++;

1659 
	`¢¥ötf
(
t
->
id
, —->id), "tokí%u", 
tokí
);

1660 
t
->
vÆue
 = 
tokí
;

1661 
found
:

1662 
	`¢d_°æ˝y
(
°r_ªf
, 
t
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1664 
	}
}

1666 
	$çlg_vîify_tu∂e_£t
(
¢d_çlg_t
 *
çlg
, 
size_t
 
pos
,

1667 c⁄° *
bö
, 
size_t
 
size
)

1669 c⁄° 
¢d_soc_çlg_víd‹_¨øy
 *
va
;

1670 
j
;

1672 
va
 = 
bö
;

1673 i‡(
size
 < (*
va
) || size < va->size) {

1674 
	`çlg_log
(
çlg
, 'A', 
pos
, "tu∂ê£àvîify: wr⁄g sizê%zd", 
size
);

1675  -
EINVAL
;

1678 
va
->
ty≥
) {

1679 
SND_SOC_TPLG_TUPLE_TYPE_UUID
:

1680 
SND_SOC_TPLG_TUPLE_TYPE_STRING
:

1681 
SND_SOC_TPLG_TUPLE_TYPE_BOOL
:

1682 
SND_SOC_TPLG_TUPLE_TYPE_BYTE
:

1683 
SND_SOC_TPLG_TUPLE_TYPE_WORD
:

1684 
SND_SOC_TPLG_TUPLE_TYPE_SHORT
:

1687 
	`çlg_log
(
çlg
, 'A', 
pos
, "tu∂ê£àvîify: unknow¿¨øyÅy≥ %d", 
va
->
ty≥
);

1688  -
EINVAL
;

1691 
j
 = 
	`çlg_gë_tu∂e_size
(
va
->
ty≥
Ë* va->
num_ñems
;

1692 i‡(
j
 + (*
va
Ë!va->
size
) {

1693 
	`çlg_log
(
çlg
, 'A', 
pos
, "tuple set verify: wrong vendorárray size %d "

1695 
va
->
size
, 
j
 + (*va), va->
ty≥
, va->
num_ñems
);

1696  -
EINVAL
;

1699 i‡(
va
->
num_ñems
 > 4096) {

1700 
	`çlg_log
(
çlg
, 'A', 
pos
, "tu∂ê£àvîify:Åu∂e†ovîÊow %d", 
va
->
num_ñems
);

1701  -
EINVAL
;

1705 
	}
}

1707 
	$çlg_decode_tu∂e_£t
(
¢d_çlg_t
 *
çlg
,

1708 
size_t
 
pos
,

1709 
çlg_ñem
 *
∑ª¡
,

1710 
çlg_tu∂e_£t
 **
_£t
,

1711 c⁄° *
bö
, 
size_t
 
size
)

1713 c⁄° 
¢d_soc_çlg_víd‹_¨øy
 *
va
;

1714 
çlg_tu∂e_£t
 *
£t
;

1715 
çlg_tu∂e
 *
tu∂e
;

1716 
j
;

1717 
îr
;

1719 
va
 = 
bö
;

1720 i‡(
size
 < (*
va
) || size < va->size) {

1721 
	`SNDERR
("tu∂es: wr⁄g sizê%zd", 
size
);

1722  -
EINVAL
;

1725 
va
->
ty≥
) {

1726 
SND_SOC_TPLG_TUPLE_TYPE_UUID
:

1727 
SND_SOC_TPLG_TUPLE_TYPE_STRING
:

1728 
SND_SOC_TPLG_TUPLE_TYPE_BOOL
:

1729 
SND_SOC_TPLG_TUPLE_TYPE_BYTE
:

1730 
SND_SOC_TPLG_TUPLE_TYPE_WORD
:

1731 
SND_SOC_TPLG_TUPLE_TYPE_SHORT
:

1734 
	`SNDERR
("tu∂es: unknow¿¨øyÅy≥ %d", 
va
->
ty≥
);

1735  -
EINVAL
;

1738 
j
 = 
	`çlg_gë_tu∂e_size
(
va
->
ty≥
Ë* va->
num_ñems
;

1739 i‡(
j
 + (*
va
Ë!va->
size
) {

1740 
	`SNDERR
("tuples: wrong vendorárray size %d "

1742 
va
->
size
, 
j
 + (*va), va->
ty≥
, va->
num_ñems
);

1743  -
EINVAL
;

1746 i‡(
va
->
num_ñems
 > 4096) {

1747 
	`SNDERR
("tu∂es:Åu∂e†ovîÊow %d", 
va
->
num_ñems
);

1748  -
EINVAL
;

1751 
£t
 = 
	`ˇŒoc
(1, (*£tË+ 
va
->
num_ñems
 * (
çlg_tu∂e
));

1752 i‡(!
£t
)

1753  -
ENOMEM
;

1755 
£t
->
ty≥
 = 
va
->type;

1756 
£t
->
num_tu∂es
 = 
va
->
num_ñems
;

1758 
	`çlg_log
(
çlg
, 'A', 
pos
, "tu∂ê£t:Åy≥ %d (%sËtu∂e†%d sizê%d", 
£t
->
ty≥
,

1759 
	`gë_tu∂e_ty≥_«me
(
£t
->
ty≥
), së->
num_tu∂es
, 
va
->
size
);

1760 
j
 = 0; j < 
£t
->
num_tu∂es
; j++) {

1761 
tu∂e
 = &
£t
->tu∂e[
j
];

1762 
va
->
ty≥
) {

1763 
SND_SOC_TPLG_TUPLE_TYPE_UUID
:

1764 
îr
 = 
	`çlg_add_tokí
(
çlg
, 
∑ª¡
, 
va
->
uuid
[
j
].
tokí
,

1765 
tu∂e
->
tokí
);

1766 i‡(
îr
 < 0)

1767 
ªtvÆ
;

1768 
	`mem˝y
(
tu∂e
->
uuid
, 
va
->uuid[
j
].uuid,

1769 (
va
->
uuid
[
j
].uuid));

1771 
SND_SOC_TPLG_TUPLE_TYPE_STRING
:

1772 
îr
 = 
	`çlg_add_tokí
(
çlg
, 
∑ª¡
, 
va
->
°rög
[
j
].
tokí
,

1773 
tu∂e
->
tokí
);

1774 i‡(
îr
 < 0)

1775 
ªtvÆ
;

1776 
	`¢d_°æ˝y
(
tu∂e
->
°rög
, 
va
->°rög[
j
].string,

1777 (
tu∂e
->
°rög
));

1779 
SND_SOC_TPLG_TUPLE_TYPE_BOOL
:

1780 
SND_SOC_TPLG_TUPLE_TYPE_BYTE
:

1781 
SND_SOC_TPLG_TUPLE_TYPE_WORD
:

1782 
SND_SOC_TPLG_TUPLE_TYPE_SHORT
:

1783 
îr
 = 
	`çlg_add_tokí
(
çlg
, 
∑ª¡
, 
va
->
vÆue
[
j
].
tokí
,

1784 
tu∂e
->
tokí
);

1785 i‡(
îr
 < 0)

1786 
ªtvÆ
;

1787 
tu∂e
->
vÆue
 = 
va
->vÆue[
j
].value;

1792 *
_£t
 = 
£t
;

1795 
ªtvÆ
:

1796 
	`‰ì
(
£t
);

1797  
îr
;

1798 
	}
}

1801 
	$çlg_vîify_tu∂es
(
¢d_çlg_t
 *
çlg
, 
size_t
 
pos
,

1802 c⁄° *
bö
, 
size_t
 
size
)

1804 c⁄° 
¢d_soc_çlg_víd‹_¨øy
 *
va
;

1805 
îr
;

1807 i‡(
size
 < (*
va
)) {

1808 
	`çlg_log
(
çlg
, 'A', 
pos
, "tu∂es: smÆ»sizê%zd", 
size
);

1809  -
EINVAL
;

1812 
√xt
:

1813 
va
 = 
bö
;

1814 i‡(
size
 < (*
va
)) {

1815 
	`çlg_log
(
çlg
, 'A', 
pos
, "tu∂es: u√x≥˘ed víd‹áºy sizê%zd", 
size
);

1816  -
EINVAL
;

1819 
îr
 = 
	`çlg_vîify_tu∂e_£t
(
çlg
, 
pos
, 
va
, va->
size
);

1820 i‡(
îr
 < 0)

1821  
îr
;

1823 
bö
 +
va
->
size
;

1824 
size
 -
va
->size;

1825 
pos
 +
va
->
size
;

1826 i‡(
size
 > 0)

1827 
√xt
;

1830 
	}
}

1833 
	$çlg_decode_tu∂es
(
¢d_çlg_t
 *
çlg
,

1834 
size_t
 
pos
,

1835 
çlg_ñem
 *
∑ª¡
,

1836 
çlg_víd‹_tu∂es
 *
tu∂es
,

1837 c⁄° *
bö
, 
size_t
 
size
)

1839 c⁄° 
¢d_soc_çlg_víd‹_¨øy
 *
va
;

1840 
çlg_tu∂e_£t
 *
£t
;

1841 
îr
;

1843 i‡(
size
 < (*
va
)) {

1844 
	`SNDERR
("tu∂es: smÆ»sizê%zd", 
size
);

1845  -
EINVAL
;

1848 
√xt
:

1849 
va
 = 
bö
;

1850 i‡(
size
 < (*
va
)) {

1851 
	`SNDERR
("tu∂es: u√x≥˘ed víd‹áºy sizê%zd", 
size
);

1852  -
EINVAL
;

1855 i‡(
tu∂es
->
num_£ts
 >tu∂es->
Æloc_£ts
) {

1856 
	`SNDERR
("tu∂es: index ovîÊow (%d)", 
tu∂es
->
num_£ts
);

1857  -
EINVAL
;

1860 
îr
 = 
	`çlg_decode_tu∂e_£t
(
çlg
, 
pos
, 
∑ª¡
, &
£t
, 
va
, va->
size
);

1861 i‡(
îr
 < 0)

1862  
îr
;

1863 
tu∂es
->
£t
[tu∂es->
num_£ts
++] = set;

1865 
bö
 +
va
->
size
;

1866 
size
 -
va
->size;

1867 
pos
 +
va
->
size
;

1868 i‡(
size
 > 0)

1869 
√xt
;

1872 
	}
}

1875 
	$çlg_add_d©a
(
¢d_çlg_t
 *
çlg
,

1876 
çlg_ñem
 *
∑ª¡
,

1877 c⁄° *
bö
, 
size_t
 
size
)

1879 c⁄° 
¢d_soc_çlg_¥iv©e
 *
ç
;

1880 c⁄° 
¢d_soc_çlg_víd‹_¨øy
 *
va
;

1881 
çlg_ñem
 *
ñem
 = 
NULL
, *
ñem2
 = NULL;

1882 
çlg_víd‹_tu∂es
 *
tu∂es
 = 
NULL
;

1883 
id
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

1884 
suffix
[16];

1885 
size_t
 
pos
 = 0, 
off
;

1886 
îr
, 
num_tu∂es
 = 0, 
block
 = 0;

1888 i‡(
size
 == 0)

1891 
off
 = 
	`off£tof
(
¢d_soc_çlg_¥iv©e
, 
¨øy
);

1893 
√xt
:

1894 
ç
 = 
bö
;

1895 i‡(
off
 + 
size
 < 
ç
->size) {

1896 
	`SNDERR
("d©a: u√x≥˘edÉÀmíàsizê%zd", 
size
);

1897  -
EINVAL
;

1900 i‡(
	`çlg_vîify_tu∂es
(
çlg
, 
pos
, 
ç
->
¨øy
,Åp->
size
) < 0) {

1901 i‡(
tu∂es
) {

1902 
îr
 = 
	`çlg_ªf_add
(
ñem
, 
SND_TPLG_TYPE_TOKEN
, 
∑ª¡
->
id
);

1903 i‡(
îr
 < 0)

1904  
îr
;

1905 
îr
 = 
	`çlg_ªf_add
(
ñem2
, 
SND_TPLG_TYPE_TUPLE
, 
id
);

1906 i‡(
îr
 < 0)

1907  
îr
;

1908 
îr
 = 
	`çlg_ªf_add
(
∑ª¡
, 
SND_TPLG_TYPE_DATA
, 
id
);

1909 i‡(
îr
 < 0)

1910  
îr
;

1911 
tu∂es
 = 
NULL
;

1913 
	`çlg_log
(
çlg
, 'A', 
pos
, "add byãs: sizê%d", 
ç
->
size
);

1914 
	`¢¥ötf
(
suffix
, (suffix), "d©a%u", 
block
++);

1915 
îr
 = 
	`çlg_add_d©a_byãs
(
çlg
, 
∑ª¡
, 
suffix
, 
ç
->
¨øy
,Åp->
size
);

1917 i‡(!
tu∂es
) {

1918 
	`¢¥ötf
(
id
, (id), "%.30s:tu∂e%d", 
∑ª¡
->id, (
block
++) & 0xffff);

1919 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
, 
id
, 
SND_TPLG_TYPE_TUPLE
);

1920 i‡(!
ñem
)

1921  -
ENOMEM
;

1923 
ñem2
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
, 
id
, 
SND_TPLG_TYPE_DATA
);

1924 i‡(!
ñem2
)

1925  -
ENOMEM
;

1927 
tu∂es
 = 
	`ˇŒoc
(1, (*tuples));

1928 i‡(!
tu∂es
)

1929  -
ENOMEM
;

1930 
ñem
->
tu∂es
 =Åuples;

1932 
tu∂es
->
Æloc_£ts
 = (
size
 / (*
va
)) + 1;

1933 
tu∂es
->
£t
 = 
	`ˇŒoc
(1,Åu∂es->
Æloc_£ts
 * (*));

1934 i‡(!
tu∂es
->
£t
) {

1935 
tu∂es
->
Æloc_£ts
 = 0;

1936  -
ENOMEM
;

1939 
	`çlg_log
(
çlg
, 'A', 
pos
, "decodêtu∂es: sizê%d", 
ç
->
size
);

1940 
îr
 = 
	`çlg_decode_tu∂es
(
çlg
, 
pos
, 
∑ª¡
, 
tu∂es
, 
ç
->
¨øy
,Åp->
size
);

1941 
num_tu∂es
++;

1943 i‡(
îr
 < 0)

1944  
îr
;

1946 
bö
 +
off
 + 
ç
->
size
;

1947 
size
 -
off
 + 
ç
->size;

1948 
pos
 +
off
 + 
ç
->
size
;

1949 i‡(
size
 > 0)

1950 
√xt
;

1952 i‡(
tu∂es
 && 
ñem
 && 
ñem2
) {

1953 
îr
 = 
	`çlg_ªf_add
(
ñem
, 
SND_TPLG_TYPE_TOKEN
, 
∑ª¡
->
id
);

1954 i‡(
îr
 < 0)

1955  
îr
;

1956 
îr
 = 
	`çlg_ªf_add
(
ñem2
, 
SND_TPLG_TYPE_TUPLE
, 
id
);

1957 i‡(
îr
 < 0)

1958  
îr
;

1959 
îr
 = 
	`çlg_ªf_add
(
∑ª¡
, 
SND_TPLG_TYPE_DATA
, 
id
);

1960 i‡(
îr
 < 0)

1961  
îr
;

1965 
	}
}

1968 
	$çlg_add_d©a_byãs
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
∑ª¡
,

1969 c⁄° *
suffix
, c⁄° *
bö
, 
size_t
 
size
)

1971 
¢d_soc_çlg_¥iv©e
 *
¥iv
;

1972 
çlg_ñem
 *
ñem
;

1973 
id
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

1975 i‡(
suffix
)

1976 
	`¢¥ötf
(
id
, (id), "%.30s:%.12s", 
∑ª¡
->id, 
suffix
);

1978 
	`¢d_°æ˝y
(
id
, 
∑ª¡
->id, (id));

1979 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
, 
id
, 
SND_TPLG_TYPE_DATA
);

1980 i‡(!
ñem
)

1981  -
ENOMEM
;

1983 
¥iv
 = 
	`mÆloc
((*¥ivË+ 
size
);

1984 i‡(!
¥iv
)

1985  -
ENOMEM
;

1986 
	`mem˝y
(
¥iv
->
d©a
, 
bö
, 
size
);

1987 
¥iv
->
size
 = size;

1988 
ñem
->
d©a
 = 
¥iv
;

1990  
	`çlg_ªf_add
(
∑ª¡
, 
SND_TPLG_TYPE_DATA
, 
id
);

1991 
	}
}

1994 
	$çlg_decode_d©a
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

1995 
size_t
 
pos
 
ATTRIBUTE_UNUSED
,

1996 
¢d_soc_çlg_hdr
 *
hdr
 
ATTRIBUTE_UNUSED
,

1997 *
bö
 
ATTRIBUTE_UNUSED
,

1998 
size_t
 
size
 
ATTRIBUTE_UNUSED
)

2000 
	`SNDERR
("dataÅypeÇotÉxpected");

2001  -
EINVAL
;

2002 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/decoder.c

18 
	~"çlg_loˇl.h
"

20 
	$çlg_decode_ãm∂©e
(
¢d_çlg_t
 *
çlg
,

21 
size_t
 
pos
,

22 
¢d_soc_çlg_hdr
 *
hdr
,

23 
¢d_çlg_obj_ãm∂©e_t
 *
t
)

25 
ty≥
;

27 
ty≥
 = 
	`çlg_gë_ty≥
(
hdr
->type);

28 
	`çlg_log
(
çlg
, 'D', 
pos
, "template:ásocÅype %dÜibraryÅype %d",

29 
hdr
->
ty≥
,Åype);

30 i‡(
ty≥
 < 0)

31  
ty≥
;

33 
	`mem£t
(
t
, 0, (*t));

34 
t
->
ty≥
 =Åype;

35 
t
->
ödex
 = 
hdr
->index;

36 
t
->
vîsi⁄
 = 
hdr
->version;

37 
t
->
víd‹_ty≥
 = 
hdr
->vendor_type;

38 
	`çlg_log
(
çlg
, 'D', 
pos
, "template: index %d version %d vendor_type %d",

39 
hdr
->
ödex
, hdr->
vîsi⁄
, hdr->
víd‹_ty≥
);

41 
	}
}

43 
	$¢d_çlg_decode
(
¢d_çlg_t
 *
çlg
, *
bö
, 
size_t
 
size
, 
dÊags
)

45 
¢d_soc_çlg_hdr
 *
hdr
;

46 
çlg_èbÀ
 *
çå
;

47 
size_t
 
pos
;

48 *
b
 = 
bö
;

49 
ödex
;

50 
îr
;

52 i‡(
dÊags
 != 0)

53  -
EINVAL
;

54 i‡(
çlg
 =
NULL
 || 
bö
 == NULL)

55  -
EINVAL
;

57 
pos
 = 
b
 - 
bö
;

58 i‡(
size
 =
pos
) {

59 
	`çlg_log
(
çlg
, 'D', 
pos
, "block: suc˚s†—ŸÆ %zd)", 
size
);

62 i‡(
size
 - 
pos
 < (*
hdr
)) {

63 
	`çlg_log
(
çlg
, 'D', 
pos
, "block: small size");

64 
	`SNDERR
("incomplete header dataÅo decode");

65  -
EINVAL
;

67 
hdr
 = 
b
;

68 i‡(
hdr
->
magic
 !
SND_SOC_TPLG_MAGIC
) {

69 
	`SNDERR
("bad block magi¯%08x", 
hdr
->
magic
);

70  -
EINVAL
;

73 
	`çlg_log
(
çlg
, 'D', 
pos
, "block:ábi %d size %dÖayload size %d",

74 
hdr
->
abi
, hdr->
size
, hdr->
∑ylﬂd_size
);

75 i‡(
hdr
->
abi
 !
SND_SOC_TPLG_ABI_VERSION
) {

76 
	`SNDERR
("unsuµ‹ãd ABI vîsi⁄ %d", 
hdr
->
abi
);

77  -
EINVAL
;

79 i‡(
hdr
->
size
 != (*hdr)) {

80 
	`SNDERR
("header size mismatch");

81  -
EINVAL
;

84 i‡(
size
 - 
pos
 < 
hdr
->sizê+ hdr->
∑ylﬂd_size
) {

85 
	`SNDERR
("incompleteÖayload dataÅo decode");

86  -
EINVAL
;

89 i‡(
hdr
->
∑ylﬂd_size
 < 8) {

90 
	`SNDERR
("wr⁄gÖaylﬂd sizê%d", 
hdr
->
∑ylﬂd_size
);

91  -
EINVAL
;

95 i‡(
b
 =
bö
) {

96 i‡(
hdr
->
ty≥
 !
SND_SOC_TPLG_TYPE_MANIFEST
) {

97 
	`SNDERR
("fú° block mu° bêm™i„° (vÆuê%d)", 
hdr
->
ty≥
);

98  -
EINVAL
;

100 
îr
 = 
	`¢d_çlg_£t_vîsi⁄
(
çlg
, 
hdr
->
vîsi⁄
);

101 i‡(
îr
 < 0)

102  
îr
;

105 
pos
 +
hdr
->
size
;

106 
ödex
 = 0; index < 
çlg_èbÀ_ôems
; index++) {

107 
çå
 = &
çlg_èbÀ
[
ödex
];

108 i‡(
çå
->
tsoc
 =()
hdr
->
ty≥
)

111 i‡(
ödex
 >
çlg_èbÀ_ôems
 || 
çå
->
decod
 =
NULL
) {

112 
	`SNDERR
("unknow¿blockÅy≥ %d", 
hdr
->
ty≥
);

113  -
EINVAL
;

115 
	`çlg_log
(
çlg
, 'D', 
pos
, "block:Åy≥ %d - %s", 
hdr
->
ty≥
, 
çå
->
«me
);

116 
îr
 = 
çå
->
	`decod
(
çlg
, 
pos
, 
hdr
, 
b
 + hdr->
size
, hdr->
∑ylﬂd_size
);

117 i‡(
îr
 < 0)

118  
îr
;

119 
b
 +
hdr
->
size
 + hdr->
∑ylﬂd_size
;

121 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/elem.c

20 
	~"çlg_loˇl.h
"

22 
çlg_èbÀ
 
	gçlg_èbÀ
[] = {

24 .
«me
 = "manifest",

25 .
	gid
 = "SectionManifest",

26 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
m™i„°_li°
),

27 .
	gty≥
 = 
SND_TPLG_TYPE_MANIFEST
,

28 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_MANIFEST
,

29 .
	gsize
 = (
¢d_soc_çlg_m™i„°
),

30 .
	gíew
 = 1,

31 .
	g∑r£
 = 
çlg_∑r£_m™i„°_d©a
,

32 .
	gßve
 = 
çlg_ßve_m™i„°_d©a
,

33 .
	gdecod
 = 
çlg_decode_m™i„°_d©a
,

36 .
	g«me
 = "control mixer",

37 .
	gid
 = "SectionControlMixer",

38 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
mixî_li°
),

39 .
	gty≥
 = 
SND_TPLG_TYPE_MIXER
,

40 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_MIXER
,

41 .
	gsize
 = (
¢d_soc_çlg_mixî_c⁄åﬁ
),

42 .
	gbuûd
 = 1,

43 .
	gíew
 = 1,

44 .
	g∑r£
 = 
çlg_∑r£_c⁄åﬁ_mixî
,

45 .
	gßve
 = 
çlg_ßve_c⁄åﬁ_mixî
,

46 .
	gdecod
 = 
çlg_decode_c⁄åﬁ_mixî
,

49 .
	g«me
 = "controlÉnum",

50 .
	gid
 = "SectionControlEnum",

51 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
íum_li°
),

52 .
	gty≥
 = 
SND_TPLG_TYPE_ENUM
,

53 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_ENUM
,

54 .
	gsize
 = (
¢d_soc_çlg_íum_c⁄åﬁ
),

55 .
	gbuûd
 = 1,

56 .
	gíew
 = 1,

57 .
	g∑r£
 = 
çlg_∑r£_c⁄åﬁ_íum
,

58 .
	gßve
 = 
çlg_ßve_c⁄åﬁ_íum
,

59 .
	gdecod
 = 
çlg_decode_c⁄åﬁ_íum
,

62 .
	g«me
 = "controlÉxtended (bytes)",

63 .
	gid
 = "SectionControlBytes",

64 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
byãs_ext_li°
),

65 .
	gty≥
 = 
SND_TPLG_TYPE_BYTES
,

66 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_BYTES
,

67 .
	gsize
 = (
¢d_soc_çlg_byãs_c⁄åﬁ
),

68 .
	gbuûd
 = 1,

69 .
	gíew
 = 1,

70 .
	g∑r£
 = 
çlg_∑r£_c⁄åﬁ_byãs
,

71 .
	gßve
 = 
çlg_ßve_c⁄åﬁ_byãs
,

72 .
	gdecod
 = 
çlg_decode_c⁄åﬁ_byãs
,

75 .
	g«me
 = "dapm widget",

76 .
	gid
 = "SectionWidget",

77 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
widgë_li°
),

78 .
	gty≥
 = 
SND_TPLG_TYPE_DAPM_WIDGET
,

79 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_DAPM_WIDGET
,

80 .
	gsize
 = (
¢d_soc_çlg_d≠m_widgë
),

81 .
	gbuûd
 = 1,

82 .
	gíew
 = 1,

83 .
	g∑r£
 = 
çlg_∑r£_d≠m_widgë
,

84 .
	gßve
 = 
çlg_ßve_d≠m_widgë
,

85 .
	gdecod
 = 
çlg_decode_d≠m_widgë
,

88 .
	g«me
 = "pcm",

89 .
	gid
 = "SectionPCM",

90 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
pcm_li°
),

91 .
	gty≥
 = 
SND_TPLG_TYPE_PCM
,

92 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_PCM
,

93 .
	gsize
 = (
¢d_soc_çlg_pcm
),

94 .
	gbuûd
 = 1,

95 .
	gíew
 = 1,

96 .
	g∑r£
 = 
çlg_∑r£_pcm
,

97 .
	gßve
 = 
çlg_ßve_pcm
,

98 .
	gdecod
 = 
çlg_decode_pcm
,

101 .
	g«me
 = "physical dai",

102 .
	gid
 = "SectionDAI",

103 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
dai_li°
),

104 .
	gty≥
 = 
SND_TPLG_TYPE_DAI
,

105 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_DAI
,

106 .
	gsize
 = (
¢d_soc_çlg_dai
),

107 .
	gbuûd
 = 1,

108 .
	gíew
 = 1,

109 .
	g∑r£
 = 
çlg_∑r£_dai
,

110 .
	gßve
 = 
çlg_ßve_dai
,

111 .
	gdecod
 = 
çlg_decode_dai
,

114 .
	g«me
 = "be",

115 .
	gid
 = "SectionBE",

116 .
	gid2
 = "SectionLink",

117 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
be_li°
),

118 .
	gty≥
 = 
SND_TPLG_TYPE_BE
,

119 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_BACKEND_LINK
,

120 .
	gsize
 = (
¢d_soc_çlg_lök_c⁄fig
),

121 .
	gbuûd
 = 1,

122 .
	gíew
 = 1,

123 .
	g∑r£
 = 
çlg_∑r£_lök
,

124 .
	gßve
 = 
çlg_ßve_lök
,

125 .
	gdecod
 = 
çlg_decode_lök
,

128 .
	g«me
 = "cc",

129 .
	gid
 = "SectionCC",

130 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
cc_li°
),

131 .
	gty≥
 = 
SND_TPLG_TYPE_CC
,

132 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_CODEC_LINK
,

133 .
	gsize
 = (
¢d_soc_çlg_lök_c⁄fig
),

134 .
	gbuûd
 = 1,

135 .
	gíew
 = 1,

136 .
	g∑r£
 = 
çlg_∑r£_cc
,

137 .
	gßve
 = 
çlg_ßve_cc
,

138 .
	gdecod
 = 
çlg_decode_cc
,

141 .
	g«me
 = "route (dapm graph)",

142 .
	gid
 = "SectionGraph",

143 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
rouã_li°
),

144 .
	gty≥
 = 
SND_TPLG_TYPE_DAPM_GRAPH
,

145 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_DAPM_GRAPH
,

146 .
	gbuûd
 = 1,

147 .
	g∑r£
 = 
çlg_∑r£_d≠m_gøph
,

148 .
	ggßve
 = 
çlg_ßve_d≠m_gøph
,

149 .
	gdecod
 = 
çlg_decode_d≠m_gøph
,

152 .
	g«me
 = "private data",

153 .
	gid
 = "SectionData",

154 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
pd©a_li°
),

155 .
	gty≥
 = 
SND_TPLG_TYPE_DATA
,

156 .
	gtsoc
 = 
SND_SOC_TPLG_TYPE_PDATA
,

157 .
	gbuûd
 = 1,

158 .
	gíew
 = 1,

159 .
	g∑r£
 = 
çlg_∑r£_d©a
,

160 .
	gßve
 = 
çlg_ßve_d©a
,

161 .
	gdecod
 = 
çlg_decode_d©a
,

164 .
	g«me
 = "text",

165 .
	gid
 = "SectionText",

166 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
ãxt_li°
),

167 .
	gty≥
 = 
SND_TPLG_TYPE_TEXT
,

168 .
	gsize
 = (
çlg_ãxts
),

169 .
	gíew
 = 1,

170 .
	g∑r£
 = 
çlg_∑r£_ãxt
,

171 .
	gßve
 = 
çlg_ßve_ãxt
,

174 .
	g«me
 = "tlv",

175 .
	gid
 = "SectionTLV",

176 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
év_li°
),

177 .
	gty≥
 = 
SND_TPLG_TYPE_TLV
,

178 .
	gsize
 = (
¢d_soc_çlg_˘l_év
),

179 .
	gíew
 = 1,

180 .
	g∑r£
 = 
çlg_∑r£_év
,

181 .
	gßve
 = 
çlg_ßve_év
,

184 .
	g«me
 = "stream config",

185 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
pcm_c⁄fig_li°
),

186 .
	gty≥
 = 
SND_TPLG_TYPE_STREAM_CONFIG
,

187 .
	gsize
 = (
¢d_soc_çlg_°ªam
),

188 .
	gíew
 = 1,

191 .
	g«me
 = "stream capabilities",

192 .
	gid
 = "SectionPCMCapabilities",

193 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
pcm_ˇps_li°
),

194 .
	gty≥
 = 
SND_TPLG_TYPE_STREAM_CAPS
,

195 .
	gsize
 = (
¢d_soc_çlg_°ªam_ˇps
),

196 .
	gíew
 = 1,

197 .
	g∑r£
 = 
çlg_∑r£_°ªam_ˇps
,

198 .
	gßve
 = 
çlg_ßve_°ªam_ˇps
,

201 .
	g«me
 = "token",

202 .
	gid
 = "SectionVendorTokens",

203 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
tokí_li°
),

204 .
	gty≥
 = 
SND_TPLG_TYPE_TOKEN
,

205 .
	gíew
 = 1,

206 .
	g∑r£
 = 
çlg_∑r£_tokís
,

207 .
	gßve
 = 
çlg_ßve_tokís
,

210 .
	g«me
 = "tuple",

211 .
	gid
 = "SectionVendorTuples",

212 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
tu∂e_li°
),

213 .
	gty≥
 = 
SND_TPLG_TYPE_TUPLE
,

214 .
	g‰ì
 = 
çlg_‰ì_tu∂es
,

215 .
	gíew
 = 1,

216 .
	g∑r£
 = 
çlg_∑r£_tu∂es
,

217 .
	gßve
 = 
çlg_ßve_tu∂es
,

220 .
	g«me
 = "hw config",

221 .
	gid
 = "SectionHWConfig",

222 .
	gloff
 = 
off£tof
(
¢d_çlg_t
, 
hw_cfg_li°
),

223 .
	gty≥
 = 
SND_TPLG_TYPE_HW_CONFIG
,

224 .
	gsize
 = (
¢d_soc_çlg_hw_c⁄fig
),

225 .
	gíew
 = 1,

226 .
	g∑r£
 = 
çlg_∑r£_hw_c⁄fig
,

227 .
	gßve
 = 
çlg_ßve_hw_c⁄fig
,

231 
	gçlg_èbÀ_ôems
 = 
ARRAY_SIZE
(
çlg_èbÀ
);

233 
	$çlg_gë_ty≥
(
asoc_ty≥
)

235 
ödex
;

237 
ödex
 = 0; index < 
çlg_èbÀ_ôems
; index++)

238 i‡(
çlg_èbÀ
[
ödex
].
tsoc
 =
asoc_ty≥
)

239  
çlg_èbÀ
[
ödex
].
ty≥
;

240 
	`SNDERR
("uknow¿aso¯ty≥ %d", 
asoc_ty≥
);

241  -
EINVAL
;

242 
	}
}

244 
	$çlg_ªf_add
(
çlg_ñem
 *
ñem
, 
ty≥
, c⁄° * 
id
)

246 
çlg_ªf
 *
ªf
;

248 
ªf
 = 
	`ˇŒoc
(1, (*ref));

249 i‡(!
ªf
)

250  -
ENOMEM
;

252 
	`°∫˝y
(
ªf
->
id
, id, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

253 
ªf
->
id
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
 - 1] = 0;

254 
ªf
->
ty≥
 =Åype;

256 
	`li°_add_èû
(&
ªf
->
li°
, &
ñem
->
ªf_li°
);

258 
	}
}

261 
	$çlg_ªf_add_ñem
(
çlg_ñem
 *
ñem
, çlg_ñem *
ñem_ªf
)

263 
çlg_ªf
 *
ªf
;

265 
ªf
 = 
	`ˇŒoc
(1, (*ref));

266 i‡(!
ªf
)

267  -
ENOMEM
;

269 
ªf
->
ty≥
 = 
ñem_ªf
->type;

270 
ªf
->
ñem
 = 
ñem_ªf
;

271 
	`¢d_°æ˝y
(
ªf
->
id
, 
ñem_ªf
->id, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

273 
	`li°_add_èû
(&
ªf
->
li°
, &
ñem
->
ªf_li°
);

275 
	}
}

277 
	$çlg_ªf_‰ì_li°
(
li°_hód
 *
ba£
)

279 
li°_hód
 *
pos
, *
≈os
;

280 
çlg_ªf
 *
ªf
;

282 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, 
ba£
) {

283 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

284 
	`li°_dñ
(&
ªf
->
li°
);

285 
	`‰ì
(
ªf
);

287 
	}
}

289 
çlg_ñem
 *
	$çlg_ñem_√w
()

291 
çlg_ñem
 *
ñem
;

293 
ñem
 = 
	`ˇŒoc
(1, (*elem));

294 i‡(!
ñem
)

295  
NULL
;

297 
	`INIT_LIST_HEAD
(&
ñem
->
ªf_li°
);

298  
ñem
;

299 
	}
}

301 
	$çlg_ñem_‰ì
(
çlg_ñem
 *
ñem
)

303 
	`li°_dñ
(&
ñem
->
li°
);

305 
	`çlg_ªf_‰ì_li°
(&
ñem
->
ªf_li°
);

310 i‡(
ñem
->
obj
) {

311 i‡(
ñem
->
‰ì
)

312 
ñem
->
	`‰ì
”Àm->
obj
);

314 
	`‰ì
(
ñem
->
obj
);

317 
	`‰ì
(
ñem
);

318 
	}
}

320 
	$çlg_ñem_‰ì_li°
(
li°_hód
 *
ba£
)

322 
li°_hód
 *
pos
, *
≈os
;

323 
çlg_ñem
 *
ñem
;

325 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, 
ba£
) {

326 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

327 
	`çlg_ñem_‰ì
(
ñem
);

329 
	}
}

331 
çlg_ñem
 *
	$çlg_ñem_lookup
(
li°_hód
 *
ba£
, c⁄° * 
id
,

332 
ty≥
, 
ödex
)

334 
li°_hód
 *
pos
;

335 
çlg_ñem
 *
ñem
;

337 i‡(!
ba£
 || !
id
)

338  
NULL
;

340 
	`li°_f‹_óch
(
pos
, 
ba£
) {

342 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

344 i‡(!
	`°rcmp
(
ñem
->
id
, idË&&ÉÀm->
ty≥
 ==Åype)

345  
ñem
;

348 i‡((
ödex
 !
SND_TPLG_INDEX_ALL
)

349 && (
ñem
->
ödex
 > index))

353  
NULL
;

354 
	}
}

357 
çlg_ñem
 *
	$çlg_ñem_ty≥_lookup
(
¢d_çlg_t
 *
çlg
,

358 
¢d_çlg_ty≥
 
ty≥
)

360 
çlg_èbÀ
 *
çå
;

361 
li°_hód
 *
pos
, *
li°
;

362 
çlg_ñem
 *
ñem
;

363 
ödex
;

365 
ödex
 = 0; index < 
çlg_èbÀ_ôems
; index++) {

366 
çå
 = &
çlg_èbÀ
[
ödex
];

367 i‡(!
çå
->
íew
)

369 i‡(()
ty≥
 !
çå
->type)

373 i‡(
ödex
 >
çlg_èbÀ_ôems
)

374  
NULL
;

376 
li°
 = (
li°_hód
 *)((*)
çlg
 + 
çå
->
loff
);

379 
	`li°_f‹_óch
(
pos
, 
li°
) {

380 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

381  
ñem
;

383  
NULL
;

384 
	}
}

387 
	$çlg_ñem_ö£π
(
çlg_ñem
 *
ñem_p
, 
li°_hód
 *
li°
)

389 
li°_hód
 *
pos
, *
p
 = &(
ñem_p
->
li°
);

390 
çlg_ñem
 *
ñem
;

392 
	`li°_f‹_óch
(
pos
, 
li°
) {

393 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

394 i‡(
ñem_p
->
ödex
 < 
ñem
->index)

398 
	`li°_ö£π
(
p
, 
pos
->
¥ev
,Öos);

399 
	}
}

402 
çlg_ñem
* 
	$çlg_ñem_√w_comm⁄
(
¢d_çlg_t
 *
çlg
,

403 
¢d_c⁄fig_t
 *
cfg
,

404 c⁄° *
«me
,

405 
¢d_çlg_ty≥
 
ty≥
)

407 
çlg_èbÀ
 *
çå
;

408 
çlg_ñem
 *
ñem
;

409 
li°_hód
 *
li°
;

410 c⁄° *
id
;

411 
obj_size
 = 0;

412 
ödex
;

413 *
obj
;

414 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

415 
¢d_c⁄fig_t
 *
n
;

417 i‡(!
cfg
 && !
«me
)

418  
NULL
;

420 
ñem
 = 
	`çlg_ñem_√w
();

421 i‡(!
ñem
)

422  
NULL
;

425 i‡(
cfg
) {

426 
	`¢d_c⁄fig_gë_id
(
cfg
, &
id
);

427 
	`¢d_°æ˝y
(
ñem
->
id
, id, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

428 
ñem
->
id
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
 - 1] = 0;

431 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

432 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

433 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
))

435 i‡(
	`°rcmp
(
id
, "index") == 0) {

436 i‡(
	`çlg_gë_öãgî
(
n
, &
ñem
->
ödex
, 0)) {

437 
	`‰ì
(
ñem
);

438  
NULL
;

440 i‡(
ñem
->
ödex
 < 0) {

441 
	`‰ì
(
ñem
);

442  
NULL
;

446 } i‡(
«me
 !
NULL
)

447 
	`¢d_°æ˝y
(
ñem
->
id
, 
«me
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

449 
ödex
 = 0; index < 
çlg_èbÀ_ôems
; index++) {

450 
çå
 = &
çlg_èbÀ
[
ödex
];

451 i‡(!
çå
->
íew
)

453 i‡(()
ty≥
 !
çå
->type)

457 i‡(
ödex
 >
çlg_èbÀ_ôems
) {

458 
	`‰ì
(
ñem
);

459  
NULL
;

462 
li°
 = (
li°_hód
 *)((*)
çlg
 + 
çå
->
loff
);

463 
	`çlg_ñem_ö£π
(
ñem
, 
li°
);

464 
obj_size
 = 
çå
->
size
;

465 
ñem
->
‰ì
 = 
çå
->free;

466 
ñem
->
èbÀ
 = 
çå
;

469 i‡(
obj_size
 > 0) {

470 
obj
 = 
	`ˇŒoc
(1, 
obj_size
);

471 i‡(
obj
 =
NULL
) {

472 
	`‰ì
(
ñem
);

473  
NULL
;

476 
ñem
->
obj
 = obj;

477 
ñem
->
size
 = 
obj_size
;

480 
ñem
->
ty≥
 =Åype;

481  
ñem
;

482 
	}
}

484 #i‚de‡
DOC_HIDDEN


485 
	sçlg_Æloc
 {

486 
li°_hód
 
	mli°
;

487 *
	md©a
[0];

491 *
	$çlg_ˇŒoc
(
li°_hód
 *
hóp
, 
size_t
 
size
)

493 
çlg_Æloc
 *
a
;

495 
a
 = 
	`ˇŒoc
(1, (*aË+ 
size
);

496 i‡(
a
 =
NULL
)

497  
NULL
;

498 
	`li°_add_èû
(&
a
->
li°
, 
hóp
);

499  
a
->
d©a
;

500 
	}
}

502 
	$çlg_‰ì
(
li°_hód
 *
hóp
)

504 
li°_hód
 *
pos
, *
≈os
;

505 
çlg_Æloc
 *
a
;

507 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, 
hóp
) {

508 
a
 = 
	`li°_íåy
(
pos
, 
çlg_Æloc
, 
li°
);

509 
	`li°_dñ
(&
a
->
li°
);

510 
	`‰ì
(
a
);

512 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/log.c

18 
	~"çlg_loˇl.h
"

21 
	$çlg_log_
(
¢d_çlg_t
 *
çlg
, 
ty≥
, 
size_t
 
pos
, c⁄° *
fmt
, ...)

23 
va_li°
 
va
;

25 i‡(!
çlg
->
vîbo£
)

28 
	`va_°¨t
(
va
, 
fmt
);

29 
	`Ârötf
(
°dout
, "%c0x%6.6zx/%6.6zd - ", 
ty≥
, 
pos
,Öos);

30 
	`vÂrötf
(
°dout
, 
fmt
, 
va
);

31 
	`va_íd
(
va
);

32 
	`putc
('\n', 
°dout
);

33 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/ops.c

20 
	~"çlg_loˇl.h
"

23 c⁄° 
m≠_ñem
 
	gc⁄åﬁ_m≠
[] = {

24 {"vﬁsw", 
SND_SOC_TPLG_CTL_VOLSW
},

25 {"vﬁsw_sx", 
SND_SOC_TPLG_CTL_VOLSW_SX
},

26 {"vﬁsw_xr_sx", 
SND_SOC_TPLG_CTL_VOLSW_XR_SX
},

27 {"íum", 
SND_SOC_TPLG_CTL_ENUM
},

28 {"byãs", 
SND_SOC_TPLG_CTL_BYTES
},

29 {"íum_vÆue", 
SND_SOC_TPLG_CTL_ENUM_VALUE
},

30 {"ønge", 
SND_SOC_TPLG_CTL_RANGE
},

31 {"°robe", 
SND_SOC_TPLG_CTL_STROBE
},

34 
	$lookup_›s
(c⁄° *
c
)

36 
i
;

37 
ªt
;

39 
i
 = 0; i < ()
	`ARRAY_SIZE
(
c⁄åﬁ_m≠
); i++) {

40 i‡(
	`°rcmp
(
c⁄åﬁ_m≠
[
i
].
«me
, 
c
) == 0)

41  
c⁄åﬁ_m≠
[
i
].
id
;

45 
i
 = 
	`ß„_°πﬁ
(
c
, &
ªt
);

46 i‡(
i
 < 0) {

47 
	`SNDERR
("wr⁄g kc⁄åﬁ op†vÆuê°rög '%s'", 
c
);

48  
i
;

51  
ªt
;

52 
	}
}

54 c⁄° *
	$çlg_›s_«me
(
ty≥
)

56 
i
;

58 
i
 = 0; i < 
	`ARRAY_SIZE
(
c⁄åﬁ_m≠
); i++) {

59 i‡(
c⁄åﬁ_m≠
[
i
].
id
 =
ty≥
)

60  
c⁄åﬁ_m≠
[
i
].
«me
;

63  
NULL
;

64 
	}
}

69 
	$çlg_∑r£_›s
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
, 
¢d_c⁄fig_t
 *
cfg
,

70 *
¥iv©e
)

72 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

73 
¢d_c⁄fig_t
 *
n
;

74 
¢d_soc_çlg_˘l_hdr
 *
hdr
 = 
¥iv©e
;

75 c⁄° *
id
, *
vÆue
;

76 
ivÆ
;

78 
	`çlg_dbg
("\tOps");

79 
hdr
->
size
 = (*hdr);

81 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

83 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

86 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

90 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë=
SND_CONFIG_TYPE_STRING
) {

91 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆue
) < 0)

93 
ivÆ
 = 
	`lookup_›s
(
vÆue
);

95 i‡(
	`çlg_gë_öãgî
(
n
, &
ivÆ
, 0))

99 i‡(
	`°rcmp
(
id
, "info") == 0)

100 
hdr
->
›s
.
öfo
 = 
ivÆ
;

101 i‡(
	`°rcmp
(
id
, "put") == 0)

102 
hdr
->
›s
.
put
 = 
ivÆ
;

103 i‡(
	`°rcmp
(
id
, "get") == 0)

104 
hdr
->
›s
.
gë
 = 
ivÆ
;

106 
	`çlg_dbg
("\t\t%†%d", 
id
, 
ivÆ
);

110 
	}
}

113 
	$çlg_ßve_›s
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

114 
¢d_soc_çlg_˘l_hdr
 *
hdr
,

115 
çlg_buf
 *
d°
, c⁄° *
pfx
)

117 c⁄° *
s
;

118 
îr
;

120 i‡(
hdr
->
›s
.
öfo
 + hdr->›s.
gë
 + hdr->›s.
put
 == 0)

122 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "ops.0 {\n");

123 i‡(
îr
 >0 && 
hdr
->
›s
.
öfo
 > 0) {

124 
s
 = 
	`çlg_›s_«me
(
hdr
->
›s
.
öfo
);

125 i‡(
s
 =
NULL
)

126 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tinfo %u\n",

127 
hdr
->
›s
.
öfo
);

129 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\töfÿ%s\n", 
s
);

131 i‡(
îr
 >0 && 
hdr
->
›s
.
gë
 > 0) {

132 
s
 = 
	`çlg_›s_«me
(
hdr
->
›s
.
gë
);

133 i‡(
s
 =
NULL
)

134 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tget %u\n",

135 
hdr
->
›s
.
gë
);

137 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tgë %s\n", 
s
);

139 i‡(
îr
 >0 && 
hdr
->
›s
.
put
 > 0) {

140 
s
 = 
	`çlg_›s_«me
(
hdr
->
›s
.
put
);

141 i‡(
s
 =
NULL
)

142 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tput %u\n",

143 
hdr
->
›s
.
put
);

145 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\çuà%s\n", 
s
);

147 i‡(
îr
 >= 0)

148 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

149  
îr
;

150 
	}
}

155 
	$çlg_∑r£_ext_›s
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

156 
¢d_c⁄fig_t
 *
cfg
, *
¥iv©e
)

158 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

159 
¢d_c⁄fig_t
 *
n
;

160 
¢d_soc_çlg_byãs_c⁄åﬁ
 *
be
 = 
¥iv©e
;

161 c⁄° *
id
, *
vÆue
;

162 
ivÆ
;

164 
	`çlg_dbg
("\tExt Ops");

166 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

168 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

171 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

175 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë=
SND_CONFIG_TYPE_STRING
) {

176 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆue
) < 0)

178 
ivÆ
 = 
	`lookup_›s
(
vÆue
);

180 i‡(
	`çlg_gë_öãgî
(
n
, &
ivÆ
, 0))

184 i‡(
	`°rcmp
(
id
, "info") == 0)

185 
be
->
ext_›s
.
öfo
 = 
ivÆ
;

186 i‡(
	`°rcmp
(
id
, "put") == 0)

187 
be
->
ext_›s
.
put
 = 
ivÆ
;

188 i‡(
	`°rcmp
(
id
, "get") == 0)

189 
be
->
ext_›s
.
gë
 = 
ivÆ
;

191 
	`çlg_dbg
("\t\t%†%s", 
id
, 
vÆue
);

195 
	}
}

198 
	$çlg_ßve_ext_›s
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

199 
¢d_soc_çlg_byãs_c⁄åﬁ
 *
be
,

200 
çlg_buf
 *
d°
, c⁄° *
pfx
)

202 c⁄° *
s
;

203 
îr
;

205 i‡(
be
->
ext_›s
.
öfo
 + be->ext_›s.
gë
 + be->ext_›s.
put
 == 0)

207 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "extops.0 {\n");

208 i‡(
îr
 >0 && 
be
->
ext_›s
.
öfo
 > 0) {

209 
s
 = 
	`çlg_›s_«me
(
be
->
ext_›s
.
öfo
);

210 i‡(
s
 =
NULL
)

211 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tinfo %u\n",

212 
be
->
ext_›s
.
öfo
);

214 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\töfÿ%s\n", 
s
);

216 i‡(
îr
 >0 && 
be
->
ext_›s
.
gë
 > 0) {

217 
s
 = 
	`çlg_›s_«me
(
be
->
ext_›s
.
gë
);

218 i‡(
s
 =
NULL
)

219 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tget %u\n",

220 
be
->
ext_›s
.
gë
);

222 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tgë %s\n", 
s
);

224 i‡(
îr
 >0 && 
be
->
ext_›s
.
put
 > 0) {

225 
s
 = 
	`çlg_›s_«me
(
be
->
ext_›s
.
put
);

226 i‡(
s
 =
NULL
)

227 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tput %u\n",

228 
be
->
ext_›s
.
put
);

230 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\çuà%s\n", 
s
);

232 i‡(
îr
 >= 0)

233 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

234  
îr
;

235 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/parser.c

20 
	~"çlg_loˇl.h
"

21 
	~<sys/°©.h
>

26 
	$çlg_gë_öãgî
(
¢d_c⁄fig_t
 *
n
, *
vÆ
, 
ba£
)

28 c⁄° *
°r
;

29 
lvÆ
;

30 
îr
;

32 
	`¢d_c⁄fig_gë_ty≥
(
n
)) {

33 
SND_CONFIG_TYPE_INTEGER
:

34 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
lvÆ
);

35 i‡(
îr
 < 0)

36  
îr
;

37 
__ªtvÆ
;

38 
SND_CONFIG_TYPE_STRING
:

39 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
);

40 i‡(
îr
 < 0)

41  
îr
;

42 
îr
 = 
	`ß„_°πﬁ_ba£
(
°r
, &
lvÆ
, 
ba£
);

43 i‡(
îr
 < 0)

44  
îr
;

45 
__ªtvÆ
;

47  -
EINVAL
;

49 
__ªtvÆ
:

50 i‡(
lvÆ
 < 
INT_MIN
 ||ÜvÆ > 
INT_MAX
)

51  -
ERANGE
;

52 *
vÆ
 = 
lvÆ
;

54 
	}
}

59 
	$çlg_gë_unsig√d
(
¢d_c⁄fig_t
 *
n
, *
vÆ
, 
ba£
)

61 c⁄° *
°r
;

62 
lvÆ
;

63 
ŒvÆ
;

64 
uvÆ
;

65 
îr
;

67 
	`¢d_c⁄fig_gë_ty≥
(
n
)) {

68 
SND_CONFIG_TYPE_INTEGER
:

69 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
lvÆ
);

70 i‡(
îr
 < 0)

71  
îr
;

72 i‡(
lvÆ
 < 0 &&ÜvÆ >
INT_MIN
)

73 
lvÆ
 = 
UINT_MAX
 +Üval + 1;

74 i‡(
lvÆ
 < 0 ||ÜvÆ > 
UINT_MAX
)

75  -
ERANGE
;

76 *
vÆ
 = 
lvÆ
;

77  
îr
;

78 
SND_CONFIG_TYPE_INTEGER64
:

79 
îr
 = 
	`¢d_c⁄fig_gë_öãgî64
(
n
, &
ŒvÆ
);

80 i‡(
îr
 < 0)

81  
îr
;

82 i‡(
ŒvÆ
 < 0 &&ÜlvÆ >
INT_MIN
)

83 
ŒvÆ
 = 
UINT_MAX
 +Ülval + 1;

84 i‡(
ŒvÆ
 < 0 ||ÜlvÆ > 
UINT_MAX
)

85  -
ERANGE
;

86 *
vÆ
 = 
ŒvÆ
;

87  
îr
;

88 
SND_CONFIG_TYPE_STRING
:

89 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
);

90 i‡(
îr
 < 0)

91  
îr
;

92 
î∫o
 = 0;

93 
uvÆ
 = 
	`°πoul
(
°r
, 
NULL
, 
ba£
);

94 i‡(
î∫o
 =
ERANGE
 && 
uvÆ
 =
ULONG_MAX
)

95  -
ERANGE
;

96 i‡(
î∫o
 && 
uvÆ
 == 0)

97  -
EINVAL
;

98 i‡(
uvÆ
 > 
UINT_MAX
)

99  -
ERANGE
;

100 *
vÆ
 = 
uvÆ
;

103  -
EINVAL
;

105 
	}
}

110 
çlg_∑r£_compound
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

111 (*
f˙
)(
¢d_çlg_t
 *, 
¢d_c⁄fig_t
 *, *),

112 *
¥iv©e
)

114 c⁄° *
id
;

115 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

116 
¢d_c⁄fig_t
 *
n
;

117 
îr
 = -
EINVAL
;

119 i‡(
	`¢d_c⁄fig_gë_id
(
cfg
, &
id
) < 0)

120  -
EINVAL
;

122 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

123 
	`SNDERR
("compoundÅy≥Éx≥˘ed f‹ %s", 
id
);

124  -
EINVAL
;

128 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

129 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

131 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

132 
	`SNDERR
("compoundÅypeÉxpected for %s, is %d",

133 
id
, 
	`¢d_c⁄fig_gë_ty≥
(
cfg
));

134  -
EINVAL
;

137 
îr
 = 
	`f˙
(
çlg
, 
n
, 
¥iv©e
);

138 i‡(
îr
 < 0)

139  
îr
;

142  
îr
;

143 
	}
}

145 
	$çlg_∑r£_c⁄fig
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
)

147 (*
∑r£r
)(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

148 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

149 
¢d_c⁄fig_t
 *
n
;

150 c⁄° *
id
;

151 
çlg_èbÀ
 *
p
;

152 
idx
;

153 
îr
;

155 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

156 
	`SNDERR
("compoundÅypeÉxpectedátÅopÜevel");

157  -
EINVAL
;

161 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

163 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

164 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

167 
∑r£r
 = 
NULL
;

168 
idx
 = 0; idx < 
çlg_èbÀ_ôems
; idx++) {

169 
p
 = &
çlg_èbÀ
[
idx
];

170 i‡(
p
->
id
 && 
	`°rcmp
(id,Ö->id) == 0) {

171 
∑r£r
 = 
p
->
∑r£
;

174 i‡(
p
->
id2
 && 
	`°rcmp
(
id
,Ö->id2) == 0) {

175 
∑r£r
 = 
p
->
∑r£
;

180 i‡(
∑r£r
 =
NULL
) {

181 
	`SNDERR
("unknow¿£˘i⁄ %s", 
id
);

185 
îr
 = 
	`çlg_∑r£_compound
(
çlg
, 
n
, 
∑r£r
, 
NULL
);

186 i‡(
îr
 < 0)

187  
îr
;

190 
	}
}

192 
	$çlg_lﬂd_c⁄fig
(
¢d_çlg_t
 *
çlg
, 
¢d_öput_t
 *
ö
)

194 
¢d_c⁄fig_t
 *
t›
;

195 
ªt
;

197 
ªt
 = 
	`¢d_c⁄fig_t›
(&
t›
);

198 i‡(
ªt
 < 0)

199  
ªt
;

201 
ªt
 = 
	`¢d_c⁄fig_lﬂd
(
t›
, 
ö
);

202 i‡(
ªt
 < 0) {

203 
	`SNDERR
("couldÇotÜoad configuration");

204 
	`¢d_c⁄fig_dñëe
(
t›
);

205  
ªt
;

208 
ªt
 = 
	`çlg_∑r£_c⁄fig
(
çlg
, 
t›
);

209 
	`¢d_c⁄fig_dñëe
(
t›
);

210 i‡(
ªt
 < 0) {

211 
	`SNDERR
("failedÅoÖarseÅopology");

212  
ªt
;

216 
	}
}

218 
	$çlg_buûd_öãg
(
¢d_çlg_t
 *
çlg
)

220 
îr
;

222 
îr
 = 
	`çlg_buûd_d©a
(
çlg
);

223 i‡(
îr
 < 0)

224  
îr
;

226 
îr
 = 
	`çlg_buûd_m™i„°_d©a
(
çlg
);

227 i‡(
îr
 < 0)

228  
îr
;

230 
îr
 = 
	`çlg_buûd_c⁄åﬁs
(
çlg
);

231 i‡(
îr
 < 0)

232  
îr
;

234 
îr
 = 
	`çlg_buûd_widgës
(
çlg
);

235 i‡(
îr
 < 0)

236  
îr
;

238 
îr
 = 
	`çlg_buûd_pcms
(
çlg
, 
SND_TPLG_TYPE_PCM
);

239 i‡(
îr
 < 0)

240  
îr
;

242 
îr
 = 
	`çlg_buûd_dais
(
çlg
, 
SND_TPLG_TYPE_DAI
);

243 i‡(
îr
 < 0)

244  
îr
;

246 
îr
 = 
	`çlg_buûd_löks
(
çlg
, 
SND_TPLG_TYPE_BE
);

247 i‡(
îr
 < 0)

248  
îr
;

250 
îr
 = 
	`çlg_buûd_löks
(
çlg
, 
SND_TPLG_TYPE_CC
);

251 i‡(
îr
 < 0)

252  
îr
;

254 
îr
 = 
	`çlg_buûd_rouãs
(
çlg
);

255 i‡(
îr
 < 0)

256  
îr
;

258  
îr
;

259 
	}
}

261 
	$¢d_çlg_lﬂd
(
¢d_çlg_t
 *
çlg
, c⁄° *
buf
, 
size_t
 
size
)

263 
¢d_öput_t
 *
ö
;

264 
îr
;

266 
îr
 = 
	`¢d_öput_buf„r_›í
(&
ö
, 
buf
, 
size
);

267 i‡(
îr
 < 0) {

268 
	`SNDERR
("couldÇot create input buffer");

269  
îr
;

272 
îr
 = 
	`çlg_lﬂd_c⁄fig
(
çlg
, 
ö
);

273 
	`¢d_öput_˛o£
(
ö
);

274  
îr
;

275 
	}
}

277 
	$çlg_buûd
(
¢d_çlg_t
 *
çlg
)

279 
îr
;

281 
îr
 = 
	`çlg_buûd_öãg
(
çlg
);

282 i‡(
îr
 < 0) {

283 
	`SNDERR
("failedÅo checkÅopology integrity");

284  
îr
;

287 
îr
 = 
	`çlg_wrôe_d©a
(
çlg
);

288 i‡(
îr
 < 0) {

289 
	`SNDERR
("ÁûedÅÿwrôêd©®%d", 
îr
);

290  
îr
;

293 
	}
}

295 
	$¢d_çlg_buûd_fûe
(
¢d_çlg_t
 *
çlg
,

296 c⁄° *
öfûe
,

297 c⁄° *
outfûe
)

299 
FILE
 *
Â
;

300 
¢d_öput_t
 *
ö
;

301 
îr
;

303 
Â
 = 
	`f›í
(
öfûe
, "r");

304 i‡(
Â
 =
NULL
) {

305 
	`SNDERR
("couldÇŸ o≥¿c⁄figuøti⁄ fûê%s", 
öfûe
);

306  -
î∫o
;

309 
îr
 = 
	`¢d_öput_°dio_©èch
(&
ö
, 
Â
, 1);

310 i‡(
îr
 < 0) {

311 
	`f˛o£
(
Â
);

312 
	`SNDERR
("couldÇŸáâach stdiÿ%s", 
öfûe
);

313  
îr
;

316 
îr
 = 
	`çlg_lﬂd_c⁄fig
(
çlg
, 
ö
);

317 
	`¢d_öput_˛o£
(
ö
);

318 i‡(
îr
 < 0)

319  
îr
;

321  
	`¢d_çlg_buûd
(
çlg
, 
outfûe
);

322 
	}
}

324 
	$¢d_çlg_add_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
)

326 
t
->
ty≥
) {

327 
SND_TPLG_TYPE_MIXER
:

328  
	`çlg_add_mixî_obje˘
(
çlg
, 
t
);

329 
SND_TPLG_TYPE_ENUM
:

330  
	`çlg_add_íum_obje˘
(
çlg
, 
t
);

331 
SND_TPLG_TYPE_BYTES
:

332  
	`çlg_add_byãs_obje˘
(
çlg
, 
t
);

333 
SND_TPLG_TYPE_DAPM_WIDGET
:

334  
	`çlg_add_widgë_obje˘
(
çlg
, 
t
);

335 
SND_TPLG_TYPE_DAPM_GRAPH
:

336  
	`çlg_add_gøph_obje˘
(
çlg
, 
t
);

337 
SND_TPLG_TYPE_PCM
:

338  
	`çlg_add_pcm_obje˘
(
çlg
, 
t
);

339 
SND_TPLG_TYPE_DAI
:

340  
	`çlg_add_dai_obje˘
(
çlg
, 
t
);

341 
SND_TPLG_TYPE_LINK
:

342 
SND_TPLG_TYPE_BE
:

343 
SND_TPLG_TYPE_CC
:

344  
	`çlg_add_lök_obje˘
(
çlg
, 
t
);

346 
	`SNDERR
("övÆid obje˘Åy≥ %d", 
t
->
ty≥
);

347  -
EINVAL
;

349 
	}
}

351 
	$¢d_çlg_buûd
(
¢d_çlg_t
 *
çlg
, c⁄° *
outfûe
)

353 
fd
, 
îr
;

354 
ssize_t
 
r
;

356 
îr
 = 
	`çlg_buûd
(
çlg
);

357 i‡(
îr
 < 0)

358  
îr
;

360 
fd
 = 
	`›í
(
outfûe
, 
O_RDWR
 | 
O_CREAT
 | 
O_TRUNC
, 
S_IRUSR
 | 
S_IWUSR
);

361 i‡(
fd
 < 0) {

362 
	`SNDERR
("ÁûedÅÿ›í %†î∏%d", 
outfûe
, -
î∫o
);

363  -
î∫o
;

365 
r
 = 
	`wrôe
(
fd
, 
çlg
->
bö
,Å∂g->
bö_size
);

366 
	`˛o£
(
fd
);

367 i‡(
r
 < 0) {

368 
îr
 = -
î∫o
;

369 
	`SNDERR
("wrôêîr‹: %s", 
	`°ªº‹
(
î∫o
));

370  
îr
;

372 i‡((
size_t
)
r
 !
çlg
->
bö_size
) {

373 
	`SNDERR
("∑πü»wrôê(%zd !%zd)", 
r
, 
çlg
->
bö_size
);

374  -
EIO
;

377 
	}
}

379 
	$¢d_çlg_buûd_bö
(
¢d_çlg_t
 *
çlg
,

380 **
bö
, 
size_t
 *
size
)

382 
îr
;

384 
îr
 = 
	`çlg_buûd
(
çlg
);

385 i‡(
îr
 < 0)

386  
îr
;

388 *
bö
 = 
çlg
->bin;

389 *
size
 = 
çlg
->
bö_size
;

390 
çlg
->
bö
 = 
NULL
;

391 
çlg
->
bö_size
 =Å∂g->
bö_pos
 = 0;

393 
	}
}

395 
	$¢d_çlg_£t_m™i„°_d©a
(
¢d_çlg_t
 *
çlg
, c⁄° *
d©a
, 
Àn
)

397 
çlg_ñem
 *
ñem
;

399 
ñem
 = 
	`çlg_ñem_ty≥_lookup
(
çlg
, 
SND_TPLG_TYPE_MANIFEST
);

400 i‡(
ñem
 =
NULL
) {

401 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
, "manifest",

402 
SND_TPLG_TYPE_MANIFEST
);

403 i‡(!
ñem
)

404  -
ENOMEM
;

405 
çlg
->
m™i„°
.
size
 = 
ñem
->size;

408 i‡(
Àn
 <= 0)

411  
	`çlg_add_d©a_byãs
(
çlg
, 
ñem
, 
NULL
, 
d©a
, 
Àn
);

412 
	}
}

414 
	$¢d_çlg_£t_vîsi⁄
(
¢d_çlg_t
 *
çlg
, 
vîsi⁄
)

416 
çlg
->
vîsi⁄
 = version;

419 
	}
}

421 
	$¢d_çlg_vîbo£
(
¢d_çlg_t
 *
çlg
, 
vîbo£
)

423 
çlg
->
vîbo£
 = verbose;

424 
	}
}

426 
boﬁ
 
	$is_lôée_ídün
()

428 #i‡
__BYTE_ORDER__
 =
__ORDER_LITTLE_ENDIAN__
 && 
__SIZEOF_INT__
 == 4

429  
åue
;

431  
Ál£
;

432 
	}
}

434 
¢d_çlg_t
 *
	$¢d_çlg_¸óã
(
Êags
)

436 
¢d_çlg_t
 *
çlg
;

438 i‡(!
	`is_lôée_ídün
()) {

439 
	`SNDERR
("cannot support big-endian machines");

440  
NULL
;

443 
çlg
 = 
	`ˇŒoc
(1, (
¢d_çlg_t
));

444 i‡(!
çlg
)

445  
NULL
;

447 
çlg
->
vîbo£
 = !!(
Êags
 & 
SND_TPLG_CREATE_VERBOSE
);

448 
çlg
->
d≠m_s‹t
 = (
Êags
 & 
SND_TPLG_CREATE_DAPM_NOSORT
) == 0;

450 
çlg
->
m™i„°
.
size
 = (
¢d_soc_çlg_m™i„°
);

452 
	`INIT_LIST_HEAD
(&
çlg
->
év_li°
);

453 
	`INIT_LIST_HEAD
(&
çlg
->
widgë_li°
);

454 
	`INIT_LIST_HEAD
(&
çlg
->
pcm_li°
);

455 
	`INIT_LIST_HEAD
(&
çlg
->
dai_li°
);

456 
	`INIT_LIST_HEAD
(&
çlg
->
be_li°
);

457 
	`INIT_LIST_HEAD
(&
çlg
->
cc_li°
);

458 
	`INIT_LIST_HEAD
(&
çlg
->
rouã_li°
);

459 
	`INIT_LIST_HEAD
(&
çlg
->
pd©a_li°
);

460 
	`INIT_LIST_HEAD
(&
çlg
->
m™i„°_li°
);

461 
	`INIT_LIST_HEAD
(&
çlg
->
ãxt_li°
);

462 
	`INIT_LIST_HEAD
(&
çlg
->
pcm_c⁄fig_li°
);

463 
	`INIT_LIST_HEAD
(&
çlg
->
pcm_ˇps_li°
);

464 
	`INIT_LIST_HEAD
(&
çlg
->
mixî_li°
);

465 
	`INIT_LIST_HEAD
(&
çlg
->
íum_li°
);

466 
	`INIT_LIST_HEAD
(&
çlg
->
byãs_ext_li°
);

467 
	`INIT_LIST_HEAD
(&
çlg
->
tokí_li°
);

468 
	`INIT_LIST_HEAD
(&
çlg
->
tu∂e_li°
);

469 
	`INIT_LIST_HEAD
(&
çlg
->
hw_cfg_li°
);

471  
çlg
;

472 
	}
}

474 
¢d_çlg_t
 *
	$¢d_çlg_√w
()

476  
	`¢d_çlg_¸óã
(0);

477 
	}
}

479 
	$¢d_çlg_‰ì
(
¢d_çlg_t
 *
çlg
)

481 
	`‰ì
(
çlg
->
bö
);

482 
	`‰ì
(
çlg
->
m™i„°_pd©a
);

484 
	`çlg_ñem_‰ì_li°
(&
çlg
->
év_li°
);

485 
	`çlg_ñem_‰ì_li°
(&
çlg
->
widgë_li°
);

486 
	`çlg_ñem_‰ì_li°
(&
çlg
->
pcm_li°
);

487 
	`çlg_ñem_‰ì_li°
(&
çlg
->
dai_li°
);

488 
	`çlg_ñem_‰ì_li°
(&
çlg
->
be_li°
);

489 
	`çlg_ñem_‰ì_li°
(&
çlg
->
cc_li°
);

490 
	`çlg_ñem_‰ì_li°
(&
çlg
->
rouã_li°
);

491 
	`çlg_ñem_‰ì_li°
(&
çlg
->
pd©a_li°
);

492 
	`çlg_ñem_‰ì_li°
(&
çlg
->
m™i„°_li°
);

493 
	`çlg_ñem_‰ì_li°
(&
çlg
->
ãxt_li°
);

494 
	`çlg_ñem_‰ì_li°
(&
çlg
->
pcm_c⁄fig_li°
);

495 
	`çlg_ñem_‰ì_li°
(&
çlg
->
pcm_ˇps_li°
);

496 
	`çlg_ñem_‰ì_li°
(&
çlg
->
mixî_li°
);

497 
	`çlg_ñem_‰ì_li°
(&
çlg
->
íum_li°
);

498 
	`çlg_ñem_‰ì_li°
(&
çlg
->
byãs_ext_li°
);

499 
	`çlg_ñem_‰ì_li°
(&
çlg
->
tokí_li°
);

500 
	`çlg_ñem_‰ì_li°
(&
çlg
->
tu∂e_li°
);

501 
	`çlg_ñem_‰ì_li°
(&
çlg
->
hw_cfg_li°
);

503 
	`‰ì
(
çlg
);

504 
	}
}

506 c⁄° *
	$¢d_çlg_vîsi⁄
()

508  
SND_LIB_VERSION_STR
;

509 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/pcm.c

20 
	~"çlg_loˇl.h
"

22 
	#RATE
(
v
Ë[
SND_PCM_RATE_
##v] = #v

	)

24 c⁄° *c⁄° 
	g¢d_pcm_øã_«mes
[] = {

25 
RATE
(5512),

26 
RATE
(8000),

27 
RATE
(11025),

28 
RATE
(16000),

29 
RATE
(22050),

30 
RATE
(32000),

31 
RATE
(44100),

32 
RATE
(48000),

33 
RATE
(64000),

34 
RATE
(88200),

35 
RATE
(96000),

36 
RATE
(176400),

37 
RATE
(192000),

38 
RATE
(
CONTINUOUS
),

39 
RATE
(
KNOT
),

42 
çlg_ñem
 *
	$lookup_pcm_dai_°ªam
(
li°_hód
 *
ba£
, c⁄° * 
id
)

44 
li°_hód
 *
pos
;

45 
çlg_ñem
 *
ñem
;

46 
¢d_soc_çlg_pcm
 *
pcm
;

48 
	`li°_f‹_óch
(
pos
, 
ba£
) {

50 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

51 i‡(
ñem
->
ty≥
 !
SND_TPLG_TYPE_PCM
)

52  
NULL
;

54 
pcm
 = 
ñem
->pcm;

56 i‡(
pcm
 && !
	`°rcmp
’cm->
dai_«me
, 
id
))

57  
ñem
;

60  
NULL
;

61 
	}
}

64 
	$c›y_°ªam_ˇps
(c⁄° *
id
 
ATTRIBUTE_UNUSED
,

65 
¢d_soc_çlg_°ªam_ˇps
 *
ˇps
,

66 
çlg_ñem
 *
ªf_ñem
)

68 
¢d_soc_çlg_°ªam_ˇps
 *
ªf_ˇps
 = 
ªf_ñem
->
°ªam_ˇps
;

70 
	`çlg_dbg
("CopyÖcm caps (%ld bytes) from '%s'Åo '%s'",

71 (*
ˇps
), 
ªf_ñem
->
id
, id);

73 *
ˇps
 = *
ªf_ˇps
;

74 
	}
}

77 
	$çlg_buûd_°ªam_ˇps
(
¢d_çlg_t
 *
çlg
,

78 c⁄° *
id
, 
ödex
,

79 
¢d_soc_çlg_°ªam_ˇps
 *
ˇps
)

81 
çlg_ñem
 *
ªf_ñem
 = 
NULL
;

82 
i
;

84 
i
 = 0; i < 2; i++) {

85 
ªf_ñem
 = 
	`çlg_ñem_lookup
(&
çlg
->
pcm_ˇps_li°
,

86 
ˇps
[
i
].
«me
, 
SND_TPLG_TYPE_STREAM_CAPS
, 
ödex
);

88 i‡(
ªf_ñem
 !
NULL
)

89 
	`c›y_°ªam_ˇps
(
id
, &
ˇps
[
i
], 
ªf_ñem
);

93 
	}
}

96 
	$buûd_pcm
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
)

98 
çlg_ªf
 *
ªf
;

99 
li°_hód
 *
ba£
, *
pos
;

100 
îr
;

102 
îr
 = 
	`çlg_buûd_°ªam_ˇps
(
çlg
, 
ñem
->
id
,ÉÀm->
ödex
,

103 
ñem
->
pcm
->
ˇps
);

104 i‡(
îr
 < 0)

105  
îr
;

108 
ba£
 = &
ñem
->
ªf_li°
;

109 
	`li°_f‹_óch
(
pos
, 
ba£
) {

111 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

112 i‡(
ªf
->
ty≥
 =
SND_TPLG_TYPE_DATA
) {

113 
îr
 = 
	`çlg_c›y_d©a
(
çlg
, 
ñem
, 
ªf
);

114 i‡(
îr
 < 0)

115  
îr
;

117 i‡(!
ªf
->
ñem
) {

118 
	`SNDERR
("cannot find '%s'Ñeferenced by"

119 " PCM '%s'", 
ªf
->
id
, 
ñem
->id);

120  -
EINVAL
;

125 
	}
}

128 
	$çlg_buûd_pcms
(
¢d_çlg_t
 *
çlg
, 
ty≥
)

130 
li°_hód
 *
ba£
, *
pos
;

131 
çlg_ñem
 *
ñem
;

132 
îr
 = 0;

134 
ba£
 = &
çlg
->
pcm_li°
;

135 
	`li°_f‹_óch
(
pos
, 
ba£
) {

137 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

138 i‡(
ñem
->
ty≥
 !=Åype) {

139 
	`SNDERR
("övÆidÉÀm '%s'", 
ñem
->
id
);

140  -
EINVAL
;

143 
îr
 = 
	`buûd_pcm
(
çlg
, 
ñem
);

144 i‡(
îr
 < 0)

145  
îr
;

148 
çlg
->
m™i„°
.
pcm_ñems
++;

152 
	}
}

155 
	$çlg_buûd_dai
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
)

157 
çlg_ªf
 *
ªf
;

158 
li°_hód
 *
ba£
, *
pos
;

159 
îr
 = 0;

162 
îr
 = 
	`çlg_buûd_°ªam_ˇps
(
çlg
, 
ñem
->
id
,ÉÀm->
ödex
,

163 
ñem
->
dai
->
ˇps
);

164 i‡(
îr
 < 0)

165  
îr
;

168 
ba£
 = &
ñem
->
ªf_li°
;

169 
	`li°_f‹_óch
(
pos
, 
ba£
) {

171 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

173 i‡(
ªf
->
ty≥
 =
SND_TPLG_TYPE_DATA
) {

174 
îr
 = 
	`çlg_c›y_d©a
(
çlg
, 
ñem
, 
ªf
);

175 i‡(
îr
 < 0)

176  
îr
;

181 
çlg
->
m™i„°
.
dai_ñems
++;

184 
	}
}

187 
	$çlg_buûd_dais
(
¢d_çlg_t
 *
çlg
, 
ty≥
)

189 
li°_hód
 *
ba£
, *
pos
;

190 
çlg_ñem
 *
ñem
;

191 
îr
 = 0;

193 
ba£
 = &
çlg
->
dai_li°
;

194 
	`li°_f‹_óch
(
pos
, 
ba£
) {

196 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

197 i‡(
ñem
->
ty≥
 !=Åype) {

198 
	`SNDERR
("övÆidÉÀm '%s'", 
ñem
->
id
);

199  -
EINVAL
;

202 
îr
 = 
	`çlg_buûd_dai
(
çlg
, 
ñem
);

203 i‡(
îr
 < 0)

204  
îr
;

208 
	}
}

210 
	$çlg_buûd_°ªam_cfg
(
¢d_çlg_t
 *
çlg
,

211 
¢d_soc_çlg_°ªam
 *
°ªam
,

212 
num_°ªams
, 
ödex
)

214 
¢d_soc_çlg_°ªam
 *
°rm
;

215 
çlg_ñem
 *
ªf_ñem
;

216 
i
;

218 
i
 = 0; i < 
num_°ªams
; i++) {

219 
°rm
 = 
°ªam
 + 
i
;

220 
ªf_ñem
 = 
	`çlg_ñem_lookup
(&
çlg
->
pcm_c⁄fig_li°
,

221 
°rm
->
«me
, 
SND_TPLG_TYPE_STREAM_CONFIG
, 
ödex
);

223 i‡(
ªf_ñem
 &&Ñef_ñem->
°ªam_cfg
)

224 *
°rm
 = *
ªf_ñem
->
°ªam_cfg
;

228 
	}
}

230 
	$buûd_lök
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
)

232 
¢d_soc_çlg_lök_c⁄fig
 *
lök
 = 
ñem
->link;

233 
çlg_ªf
 *
ªf
;

234 
li°_hód
 *
ba£
, *
pos
;

235 
num_hw_c⁄figs
 = 0, 
îr
 = 0;

237 
îr
 = 
	`çlg_buûd_°ªam_cfg
(
çlg
, 
lök
->
°ªam
,

238 
lök
->
num_°ªams
, 
ñem
->
ödex
);

239 i‡(
îr
 < 0)

240  
îr
;

243 
ba£
 = &
ñem
->
ªf_li°
;

244 
	`li°_f‹_óch
(
pos
, 
ba£
) {

246 
ªf
 = 
	`li°_íåy
(
pos
, 
çlg_ªf
, 
li°
);

248 
ªf
->
ty≥
) {

249 
SND_TPLG_TYPE_HW_CONFIG
:

250 
ªf
->
ñem
 = 
	`çlg_ñem_lookup
(&
çlg
->
hw_cfg_li°
,

251 
ªf
->
id
, 
SND_TPLG_TYPE_HW_CONFIG
, 
ñem
->
ödex
);

252 i‡(!
ªf
->
ñem
) {

253 
	`SNDERR
("cannot find HW config '%s'"

255 
ªf
->
id
, 
ñem
->id);

256  -
EINVAL
;

259 
	`mem˝y
(&
lök
->
hw_c⁄fig
[
num_hw_c⁄figs
],

260 
ªf
->
ñem
->
hw_cfg
,

261 (
¢d_soc_çlg_hw_c⁄fig
));

262 
num_hw_c⁄figs
++;

265 
SND_TPLG_TYPE_DATA
:

266 
îr
 = 
	`çlg_c›y_d©a
(
çlg
, 
ñem
, 
ªf
);

267 i‡(
îr
 < 0)

268  
îr
;

269 
lök
 = 
ñem
->link;

278 
çlg
->
m™i„°
.
dai_lök_ñems
++;

281 
	}
}

284 
	$çlg_buûd_löks
(
¢d_çlg_t
 *
çlg
, 
ty≥
)

286 
li°_hód
 *
ba£
, *
pos
;

287 
çlg_ñem
 *
ñem
;

288 
îr
 = 0;

290 
ty≥
) {

291 
SND_TPLG_TYPE_LINK
:

292 
SND_TPLG_TYPE_BE
:

293 
ba£
 = &
çlg
->
be_li°
;

295 
SND_TPLG_TYPE_CC
:

296 
ba£
 = &
çlg
->
cc_li°
;

299  -
EINVAL
;

302 
	`li°_f‹_óch
(
pos
, 
ba£
) {

304 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

305 
îr
 = 
	`buûd_lök
(
çlg
, 
ñem
);

306 i‡(
îr
 < 0)

307  
îr
;

311 
	}
}

313 
	$•lô_f‹m©
(
¢d_soc_çlg_°ªam_ˇps
 *
ˇps
, *
°r
)

315 *
s
 = 
NULL
;

316 
¢d_pcm_f‹m©_t
 
f‹m©
;

317 
i
 = 0;

319 
s
 = 
	`°πok
(
°r
, ",");

320 (
s
 !
NULL
Ë&& (
i
 < 
SND_SOC_TPLG_MAX_FORMATS
)) {

321 
f‹m©
 = 
	`¢d_pcm_f‹m©_vÆue
(
s
);

322 i‡(
f‹m©
 =
SND_PCM_FORMAT_UNKNOWN
) {

323 
	`SNDERR
("unsuµ‹ãd såóm f‹m© %s", 
s
);

324  -
EINVAL
;

327 
ˇps
->
f‹m©s
 |1uŒ << 
f‹m©
;

328 
s
 = 
	`°πok
(
NULL
, ", ");

329 
i
++;

333 
	}
}

335 
	$gë_øã_vÆue
(c⁄° * 
«me
)

337 
øã
;

338 
øã
 = 0;Ñ©ê<
SND_PCM_RATE_LAST
;Ñate++) {

339 i‡(
¢d_pcm_øã_«mes
[
øã
] &&

340 
	`°rˇ£cmp
(
«me
, 
¢d_pcm_øã_«mes
[
øã
]) == 0) {

341  
øã
;

345  
SND_PCM_RATE_UNKNOWN
;

346 
	}
}

348 c⁄° *
	$gë_øã_«me
(
øã
)

350 i‡(
øã
 >0 &&Ñ©ê<
SND_PCM_RATE_LAST
)

351  
¢d_pcm_øã_«mes
[
øã
];

352  
NULL
;

353 
	}
}

355 
	$•lô_øã
(
¢d_soc_çlg_°ªam_ˇps
 *
ˇps
, *
°r
)

357 *
s
 = 
NULL
;

358 
¢d_pcm_øãs_t
 
øã
;

359 
i
 = 0;

361 
s
 = 
	`°πok
(
°r
, ",");

362 
s
) {

363 
øã
 = 
	`gë_øã_vÆue
(
s
);

365 i‡(
øã
 =
SND_PCM_RATE_UNKNOWN
) {

366 
	`SNDERR
("unsuµ‹ãd såómÑ©ê%s", 
s
);

367  -
EINVAL
;

370 
ˇps
->
øãs
 |1 << 
øã
;

371 
s
 = 
	`°πok
(
NULL
, ", ");

372 
i
++;

376 
	}
}

378 
	$∑r£_unsig√d
(
¢d_c⁄fig_t
 *
n
, *
d°
)

380 
ivÆ
;

382 i‡(
	`çlg_gë_öãgî
(
n
, &
ivÆ
, 0) < 0)

383  -
EINVAL
;

385 
	`u«lig√d_put32
(
d°
, 
ivÆ
);

386 #i‡
TPLG_DEBUG


388 c⁄° *
id
;

389 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) >= 0)

390 
	`çlg_dbg
("\t\t%s: %d", 
id
, 
ivÆ
);

394 
	}
}

397 
	$çlg_∑r£_°ªam_ˇps
(
¢d_çlg_t
 *
çlg
,

398 
¢d_c⁄fig_t
 *
cfg
,

399 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

401 
¢d_soc_çlg_°ªam_ˇps
 *
sc
;

402 
çlg_ñem
 *
ñem
;

403 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

404 
¢d_c⁄fig_t
 *
n
;

405 c⁄° *
id
, *
vÆ
;

406 *
s
;

407 
îr
;

409 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_STREAM_CAPS
);

410 i‡(!
ñem
)

411  -
ENOMEM
;

413 
sc
 = 
ñem
->
°ªam_ˇps
;

414 
sc
->
size
 = 
ñem
->size;

415 
	`¢d_°æ˝y
(
sc
->
«me
, 
ñem
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

417 
	`çlg_dbg
(" PCM C≠abûôõs: %s", 
ñem
->
id
);

419 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

420 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

421 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

425 i‡(
	`°rcmp
(
id
, "comment") == 0)

427 i‡(
id
[0] == '#')

430 i‡(
	`°rcmp
(
id
, "formats") == 0) {

431 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆ
) < 0)

432  -
EINVAL
;

434 
s
 = 
	`°rdup
(
vÆ
);

435 i‡(
s
 =
NULL
)

436  -
ENOMEM
;

438 
îr
 = 
	`•lô_f‹m©
(
sc
, 
s
);

439 
	`‰ì
(
s
);

441 i‡(
îr
 < 0)

442  
îr
;

444 
	`çlg_dbg
("\t\t%s: %s", 
id
, 
vÆ
);

448 i‡(
	`°rcmp
(
id
, "rates") == 0) {

449 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆ
) < 0)

450  -
EINVAL
;

452 
s
 = 
	`°rdup
(
vÆ
);

453 i‡(!
s
)

454  -
ENOMEM
;

456 
îr
 = 
	`•lô_øã
(
sc
, 
s
);

457 
	`‰ì
(
s
);

459 i‡(
îr
 < 0)

460  
îr
;

462 
	`çlg_dbg
("\t\t%s: %s", 
id
, 
vÆ
);

466 i‡(
	`°rcmp
(
id
, "rate_min") == 0) {

467 i‡(
	`∑r£_unsig√d
(
n
, &
sc
->
øã_mö
))

468  -
EINVAL
;

472 i‡(
	`°rcmp
(
id
, "rate_max") == 0) {

473 i‡(
	`∑r£_unsig√d
(
n
, &
sc
->
øã_max
))

474  -
EINVAL
;

478 i‡(
	`°rcmp
(
id
, "channels_min") == 0) {

479 i‡(
	`∑r£_unsig√d
(
n
, &
sc
->
ch™√ls_mö
))

480  -
EINVAL
;

484 i‡(
	`°rcmp
(
id
, "channels_max") == 0) {

485 i‡(
	`∑r£_unsig√d
(
n
, &
sc
->
ch™√ls_max
))

486  -
EINVAL
;

490 i‡(
	`°rcmp
(
id
, "periods_min") == 0) {

491 i‡(
	`∑r£_unsig√d
(
n
, &
sc
->
≥riods_mö
))

492  -
EINVAL
;

496 i‡(
	`°rcmp
(
id
, "periods_max") == 0) {

497 i‡(
	`∑r£_unsig√d
(
n
, &
sc
->
≥riods_max
))

498  -
EINVAL
;

502 i‡(
	`°rcmp
(
id
, "period_size_min") == 0) {

503 i‡(
	`∑r£_unsig√d
(
n
, &
sc
->
≥riod_size_mö
))

504  -
EINVAL
;

508 i‡(
	`°rcmp
(
id
, "period_size_max") == 0) {

509 i‡(
	`∑r£_unsig√d
(
n
, &
sc
->
≥riod_size_max
))

510  -
EINVAL
;

514 i‡(
	`°rcmp
(
id
, "buffer_size_min") == 0) {

515 i‡(
	`∑r£_unsig√d
(
n
, &
sc
->
buf„r_size_mö
))

516  -
EINVAL
;

520 i‡(
	`°rcmp
(
id
, "buffer_size_max") == 0) {

521 i‡(
	`∑r£_unsig√d
(
n
, &
sc
->
buf„r_size_max
))

522  -
EINVAL
;

526 i‡(
	`°rcmp
(
id
, "sig_bits") == 0) {

527 i‡(
	`∑r£_unsig√d
(
n
, &
sc
->
sig_bôs
))

528  -
EINVAL
;

535 
	}
}

538 
	$çlg_ßve_°ªam_ˇps
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

539 
çlg_ñem
 *
ñem
,

540 
çlg_buf
 *
d°
, c⁄° *
pfx
)

542 
¢d_soc_çlg_°ªam_ˇps
 *
sc
 = 
ñem
->
°ªam_ˇps
;

543 c⁄° *
s
;

544 
i
;

545 
îr
, 
fú°
;

547 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s' {\n", 
ñem
->
id
);

548 i‡(
îr
 >0 && 
sc
->
f‹m©s
) {

549 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tformats '");

550 
fú°
 = 1;

551 
i
 = 0; 
îr
 >0 && i <
SND_PCM_FORMAT_LAST
; i++) {

552 i‡(
sc
->
f‹m©s
 & (1ULL << 
i
)) {

553 
s
 = 
	`¢d_pcm_f‹m©_«me
(
i
);

554 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "%s%s",

555 !
fú°
 ? ", " : "", 
s
);

556 
fú°
 = 0;

559 i‡(
îr
 >= 0)

560 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'\n");

562 i‡(
îr
 >0 && 
sc
->
øãs
) {

563 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\trates '");

564 
fú°
 = 1;

565 
i
 = 0; 
îr
 >0 && i <
SND_PCM_RATE_LAST
; i++) {

566 i‡(
sc
->
øãs
 & (1ULL << 
i
)) {

567 
s
 = 
	`gë_øã_«me
(
i
);

568 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "%s%s",

569 !
fú°
 ? ", " : "", 
s
);

570 
fú°
 = 0;

573 i‡(
îr
 >= 0)

574 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'\n");

576 i‡(
îr
 >0 && 
sc
->
øã_mö
)

577 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\trate_min %u\n",

578 
sc
->
øã_mö
);

579 i‡(
îr
 >0 && 
sc
->
øã_max
)

580 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\trate_max %u\n",

581 
sc
->
øã_max
);

582 i‡(
îr
 >0 && 
sc
->
ch™√ls_mö
)

583 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tchannels_min %u\n",

584 
sc
->
ch™√ls_mö
);

585 i‡(
îr
 >0 && 
sc
->
ch™√ls_max
)

586 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tchannels_max %u\n",

587 
sc
->
ch™√ls_max
);

588 i‡(
îr
 >0 && 
sc
->
≥riods_mö
)

589 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tperiods_min %u\n",

590 
sc
->
≥riods_mö
);

591 i‡(
îr
 >0 && 
sc
->
≥riods_max
)

592 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tperiods_max %u\n",

593 
sc
->
≥riods_max
);

594 i‡(
îr
 >0 && 
sc
->
≥riod_size_mö
)

595 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tperiod_size_min %u\n",

596 
sc
->
≥riod_size_mö
);

597 i‡(
îr
 >0 && 
sc
->
≥riod_size_max
)

598 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tperiod_size_max %u\n",

599 
sc
->
≥riod_size_max
);

600 i‡(
îr
 >0 && 
sc
->
buf„r_size_mö
)

601 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tbuffer_size_min %u\n",

602 
sc
->
buf„r_size_mö
);

603 i‡(
îr
 >0 && 
sc
->
buf„r_size_max
)

604 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tbuffer_size_max %u\n",

605 
sc
->
buf„r_size_max
);

606 i‡(
îr
 >0 && 
sc
->
sig_bôs
)

607 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tsig_bits %u\n",

608 
sc
->
sig_bôs
);

609 i‡(
îr
 >= 0)

610 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

611  
îr
;

612 
	}
}

615 
	$çlg_∑r£_°ªams
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

616 
¢d_c⁄fig_t
 *
cfg
, *
¥iv©e
)

618 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

619 
¢d_c⁄fig_t
 *
n
;

620 
çlg_ñem
 *
ñem
 = 
¥iv©e
;

621 
¢d_soc_çlg_pcm
 *
pcm
;

622 
¢d_soc_çlg_dai
 *
dai
;

623 *
∂ayback
, *
ˇ±uª
;

624 
¢d_soc_çlg_°ªam_ˇps
 *
ˇps
;

625 c⁄° *
id
, *
vÆue
;

626 
°ªam
;

628 
	`¢d_c⁄fig_gë_id
(
cfg
, &
id
);

630 
	`çlg_dbg
("\t%s:", 
id
);

632 
ñem
->
ty≥
) {

633 
SND_TPLG_TYPE_PCM
:

634 
pcm
 = 
ñem
->pcm;

635 
∂ayback
 = &
pcm
->playback;

636 
ˇ±uª
 = &
pcm
->capture;

637 
ˇps
 = 
pcm
->caps;

640 
SND_TPLG_TYPE_DAI
:

641 
dai
 = 
ñem
->dai;

642 
∂ayback
 = &
dai
->playback;

643 
ˇ±uª
 = &
dai
->capture;

644 
ˇps
 = 
dai
->caps;

648  -
EINVAL
;

651 i‡(
	`°rcmp
(
id
, "playback") == 0) {

652 
°ªam
 = 
SND_SOC_TPLG_STREAM_PLAYBACK
;

653 
	`u«lig√d_put32
(
∂ayback
, 1);

654 } i‡(
	`°rcmp
(
id
, "capture") == 0) {

655 
°ªam
 = 
SND_SOC_TPLG_STREAM_CAPTURE
;

656 
	`u«lig√d_put32
(
ˇ±uª
, 1);

658  -
EINVAL
;

660 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

662 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

665 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

668 i‡(
	`°rcmp
(
id
, "capabilities") == 0) {

669 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆue
) < 0)

674 
	`¢d_°æ˝y
(
ˇps
[
°ªam
].
«me
, 
vÆue
,

675 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

677 
	`çlg_dbg
("\t\t%s\n\t\t\t%s", 
id
, 
vÆue
);

683 
	}
}

686 
	$çlg_ßve_°ªams
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

687 
çlg_ñem
 *
ñem
,

688 
çlg_buf
 *
d°
, c⁄° *
pfx
)

690 c⁄° *
°ªam_ids
[2] = {

694 
°ªam_ty≥s
[2] = {

695 
SND_SOC_TPLG_STREAM_PLAYBACK
,

696 
SND_SOC_TPLG_STREAM_CAPTURE


698 
¢d_soc_çlg_°ªam_ˇps
 *
ˇps
;

699 
°ªams
[2], 
°ªam
;

700 c⁄° *
s
;

701 
îr
;

703 
ñem
->
ty≥
) {

704 
SND_TPLG_TYPE_PCM
:

705 
°ªams
[0] = 
ñem
->
pcm
->
∂ayback
;

706 
°ªams
[1] = 
ñem
->
pcm
->
ˇ±uª
;

707 
ˇps
 = 
ñem
->
pcm
->caps;

709 
SND_TPLG_TYPE_DAI
:

710 
°ªams
[0] = 
ñem
->
dai
->
∂ayback
;

711 
°ªams
[1] = 
ñem
->
dai
->
ˇ±uª
;

712 
ˇps
 = 
ñem
->
dai
->caps;

715  -
EINVAL
;

718 
°ªam
 = 0; stream < 2; stream++) {

719 i‡(
°ªams
[
°ªam
] == 0)

721 i‡(!
ˇps
)

723 
s
 = 
ˇps
[
°ªam_ty≥s
[
°ªam
]].
«me
;

724 i‡(
s
[0] == '\0')

726 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "pcm.%†{\n", 
°ªam_ids
[
°ªam
]);

727 i‡(
îr
 < 0)

728  
îr
;

729 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tˇ∑bûôõ†'%s'\n", 
s
);

730 i‡(
îr
 < 0)

731  
îr
;

732 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

733 i‡(
îr
 < 0)

734  
îr
;

738 
	}
}

741 
	$çlg_∑r£_„_dai
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

742 
¢d_c⁄fig_t
 *
cfg
, *
¥iv©e
)

744 
çlg_ñem
 *
ñem
 = 
¥iv©e
;

745 
¢d_soc_çlg_pcm
 *
pcm
 = 
ñem
->pcm;

746 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

747 
¢d_c⁄fig_t
 *
n
;

748 c⁄° *
id
;

749 
dai_id
;

751 
	`¢d_c⁄fig_gë_id
(
cfg
, &
id
);

752 
	`çlg_dbg
("\t\tFE DAI %s:", 
id
);

753 
	`¢d_°æ˝y
(
pcm
->
dai_«me
, 
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

755 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

757 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

760 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

763 i‡(
	`°rcmp
(
id
, "id") == 0) {

764 i‡(
	`çlg_gë_unsig√d
(
n
, &
dai_id
, 0)) {

765 
	`SNDERR
("invalid fe dai ID");

766  -
EINVAL
;

769 
	`u«lig√d_put32
(&
pcm
->
dai_id
, dai_id);

770 
	`çlg_dbg
("\t\t\tödex: %d", 
dai_id
);

775 
	}
}

778 
	$çlg_ßve_„_dai
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

779 
çlg_ñem
 *
ñem
,

780 
çlg_buf
 *
d°
, c⁄° *
pfx
)

782 
¢d_soc_çlg_pcm
 *
pcm
 = 
ñem
->pcm;

783 
îr
 = 0;

785 i‡(
	`°æí
(
pcm
->
dai_«me
))

786 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "dai.'%s'.id %u\n", 
pcm
->
dai_«me
,Öcm->
dai_id
);

787 i‡(
pcm
->
dai_id
 > 0)

788 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "dai.0.id %u\n", 
pcm
->
dai_id
);

789  
îr
;

790 
	}
}

793 
	$∑r£_Êag
(
¢d_c⁄fig_t
 *
n
, 
mask_ö
,

794 *
mask
, *
Êags
)

796 
ªt
;

798 
ªt
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

799 i‡(
ªt
 < 0)

800  
ªt
;

802 
	`u«lig√d_put32
(
mask
, 
	`u«lig√d_gë32
(maskË| 
mask_ö
);

803 i‡(
ªt
)

804 
	`u«lig√d_put32
(
Êags
, 
	`u«lig√d_gë32
(ÊagsË| 
mask_ö
);

806 
	`u«lig√d_put32
(
Êags
, 
	`u«lig√d_gë32
(ÊagsË& (~
mask_ö
));

809 
	}
}

811 
	$ßve_Êags
(
Êags
, 
mask
,

812 
çlg_buf
 *
d°
, c⁄° *
pfx
)

814 
Êag_masks
[4] = {

815 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_RATES
,

816 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_CHANNELS
,

817 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_SAMPLEBITS
,

818 
SND_SOC_TPLG_LNK_FLGBIT_VOICE_WAKEUP
,

820 c⁄° *
Êag_ids
[4] = {

826 
i
;

827 
îr
 = 0;

829 
i
 = 0; 
îr
 >0 && i < 
	`ARRAY_SIZE
(
Êag_masks
); i++) {

830 i‡(
mask
 & 
Êag_masks
[
i
]) {

831 
v
 = (
Êags
 & 
Êag_masks
[
i
]) ? 1 : 0;

832 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "%s %u\n",

833 
Êag_ids
[
i
], 
v
);

836  
îr
;

837 
	}
}

840 
	$çlg_∑r£_pcm
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

841 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

843 
¢d_soc_çlg_pcm
 *
pcm
;

844 
çlg_ñem
 *
ñem
;

845 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

846 
¢d_c⁄fig_t
 *
n
;

847 c⁄° *
id
;

848 
îr
, 
ivÆ
;

850 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_PCM
);

851 i‡(!
ñem
)

852  -
ENOMEM
;

854 
pcm
 = 
ñem
->pcm;

855 
pcm
->
size
 = 
ñem
->size;

856 
	`¢d_°æ˝y
(
pcm
->
pcm_«me
, 
ñem
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

858 
	`çlg_dbg
(" PCM: %s", 
ñem
->
id
);

860 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

862 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

863 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

867 i‡(
	`°rcmp
(
id
, "comment") == 0)

869 i‡(
id
[0] == '#')

872 i‡(
	`°rcmp
(
id
, "id") == 0) {

873 i‡(
	`∑r£_unsig√d
(
n
, &
pcm
->
pcm_id
))

874  -
EINVAL
;

878 i‡(
	`°rcmp
(
id
, "pcm") == 0) {

879 
îr
 = 
	`çlg_∑r£_compound
(
çlg
, 
n
,

880 
çlg_∑r£_°ªams
, 
ñem
);

881 i‡(
îr
 < 0)

882  
îr
;

886 i‡(
	`°rcmp
(
id
, "compress") == 0) {

887 
ivÆ
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

888 i‡(
ivÆ
 < 0)

889  -
EINVAL
;

891 
pcm
->
com¥ess
 = 
ivÆ
;

893 
	`çlg_dbg
("\t%s: %d", 
id
, 
ivÆ
);

897 i‡(
	`°rcmp
(
id
, "dai") == 0) {

898 
îr
 = 
	`çlg_∑r£_compound
(
çlg
, 
n
,

899 
çlg_∑r£_„_dai
, 
ñem
);

900 i‡(
îr
 < 0)

901  
îr
;

906 i‡(
	`°rcmp
(
id
, "symmetric_rates") == 0) {

907 
îr
 = 
	`∑r£_Êag
(
n
,

908 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_RATES
,

909 &
pcm
->
Êag_mask
, &pcm->
Êags
);

910 i‡(
îr
 < 0)

911  
îr
;

915 i‡(
	`°rcmp
(
id
, "symmetric_channels") == 0) {

916 
îr
 = 
	`∑r£_Êag
(
n
,

917 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_CHANNELS
,

918 &
pcm
->
Êag_mask
, &pcm->
Êags
);

919 i‡(
îr
 < 0)

920  
îr
;

924 i‡(
	`°rcmp
(
id
, "symmetric_sample_bits") == 0) {

925 
îr
 = 
	`∑r£_Êag
(
n
,

926 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_SAMPLEBITS
,

927 &
pcm
->
Êag_mask
, &pcm->
Êags
);

928 i‡(
îr
 < 0)

929  
îr
;

933 i‡(
	`°rcmp
(
id
, "ignore_suspend") == 0) {

934 
îr
 = 
	`∑r£_Êag
(
n
,

935 
SND_SOC_TPLG_LNK_FLGBIT_VOICE_WAKEUP
,

936 &
pcm
->
Êag_mask
, &pcm->
Êags
);

937 i‡(
îr
 < 0)

938  
îr
;

943 i‡(
	`°rcmp
(
id
, "data") == 0) {

944 
îr
 = 
	`çlg_∑r£_ªfs
(
n
, 
ñem
, 
SND_TPLG_TYPE_DATA
);

945 i‡(
îr
 < 0)

946  
îr
;

952 
	}
}

955 
	$çlg_ßve_pcm
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

956 
çlg_ñem
 *
ñem
,

957 
çlg_buf
 *
d°
, c⁄° *
pfx
)

959 
¢d_soc_çlg_pcm
 *
pcm
 = 
ñem
->pcm;

960 
pfx2
[16];

961 
îr
;

963 
	`¢¥ötf
(
pfx2
, ’fx2), "%s\t", 
pfx
 ?: "");

964 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s' {\n", 
ñem
->
id
);

965 i‡(
îr
 >0 && 
ñem
->
ödex
)

966 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tindex %u\n",

967 
ñem
->
ödex
);

968 i‡(
îr
 >0 && 
pcm
->
pcm_id
)

969 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tid %u\n",

970 
pcm
->
pcm_id
);

971 i‡(
îr
 >0 && 
pcm
->
com¥ess
)

972 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tcompress 1\n");

973 
	`¢¥ötf
(
pfx2
, ’fx2), "%s\t", 
pfx
 ?: "");

974 i‡(
îr
 >= 0)

975 
îr
 = 
	`çlg_ßve_„_dai
(
çlg
, 
ñem
, 
d°
, 
pfx2
);

976 i‡(
îr
 >= 0)

977 
îr
 = 
	`çlg_ßve_°ªams
(
çlg
, 
ñem
, 
d°
, 
pfx2
);

978 i‡(
îr
 >= 0)

979 
îr
 = 
	`ßve_Êags
(
pcm
->
Êags
,Öcm->
Êag_mask
, 
d°
, 
pfx
);

980 i‡(
îr
 >= 0)

981 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_DATA
,

982 "d©a", 
d°
, 
pfx2
);

983 i‡(
îr
 >= 0)

984 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

985  
îr
;

986 
	}
}

989 
	$çlg_∑r£_dai
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

990 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

992 
¢d_soc_çlg_dai
 *
dai
;

993 
çlg_ñem
 *
ñem
;

994 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

995 
¢d_c⁄fig_t
 *
n
;

996 c⁄° *
id
;

997 
îr
;

999 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_DAI
);

1000 i‡(!
ñem
)

1001  -
ENOMEM
;

1003 
dai
 = 
ñem
->dai;

1004 
dai
->
size
 = 
ñem
->size;

1005 
	`¢d_°æ˝y
(
dai
->
dai_«me
, 
ñem
->
id
,

1006 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1008 
	`çlg_dbg
(" DAI: %s", 
ñem
->
id
);

1010 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1012 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1013 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1017 i‡(
	`°rcmp
(
id
, "comment") == 0)

1019 i‡(
id
[0] == '#')

1022 i‡(
	`°rcmp
(
id
, "id") == 0) {

1023 i‡(
	`∑r£_unsig√d
(
n
, &
dai
->
dai_id
))

1024  -
EINVAL
;

1028 i‡(
	`°rcmp
(
id
, "playback") == 0) {

1029 i‡(
	`∑r£_unsig√d
(
n
, &
dai
->
∂ayback
))

1030  -
EINVAL
;

1035 i‡(
	`°rcmp
(
id
, "capture") == 0) {

1036 i‡(
	`∑r£_unsig√d
(
n
, &
dai
->
ˇ±uª
))

1037  -
EINVAL
;

1043 i‡(
	`°rcmp
(
id
, "pcm") == 0) {

1044 
îr
 = 
	`çlg_∑r£_compound
(
çlg
, 
n
,

1045 
çlg_∑r£_°ªams
, 
ñem
);

1046 i‡(
îr
 < 0)

1047  
îr
;

1052 i‡(
	`°rcmp
(
id
, "symmetric_rates") == 0) {

1053 
îr
 = 
	`∑r£_Êag
(
n
,

1054 
SND_SOC_TPLG_DAI_FLGBIT_SYMMETRIC_RATES
,

1055 &
dai
->
Êag_mask
, &dai->
Êags
);

1056 i‡(
îr
 < 0)

1057  
îr
;

1061 i‡(
	`°rcmp
(
id
, "symmetric_channels") == 0) {

1062 
îr
 = 
	`∑r£_Êag
(
n
,

1063 
SND_SOC_TPLG_DAI_FLGBIT_SYMMETRIC_CHANNELS
,

1064 &
dai
->
Êag_mask
, &dai->
Êags
);

1065 i‡(
îr
 < 0)

1066  
îr
;

1070 i‡(
	`°rcmp
(
id
, "symmetric_sample_bits") == 0) {

1071 
îr
 = 
	`∑r£_Êag
(
n
,

1072 
SND_SOC_TPLG_DAI_FLGBIT_SYMMETRIC_SAMPLEBITS
,

1073 &
dai
->
Êag_mask
, &dai->
Êags
);

1074 i‡(
îr
 < 0)

1075  
îr
;

1079 i‡(
	`°rcmp
(
id
, "ignore_suspend") == 0) {

1080 
îr
 = 
	`∑r£_Êag
(
n
,

1081 
SND_SOC_TPLG_LNK_FLGBIT_VOICE_WAKEUP
,

1082 &
dai
->
Êag_mask
, &dai->
Êags
);

1083 i‡(
îr
 < 0)

1084  
îr
;

1089 i‡(
	`°rcmp
(
id
, "data") == 0) {

1090 
îr
 = 
	`çlg_∑r£_ªfs
(
n
, 
ñem
, 
SND_TPLG_TYPE_DATA
);

1091 i‡(
îr
 < 0)

1092  
îr
;

1098 
	}
}

1101 
	$çlg_ßve_dai
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

1102 
çlg_ñem
 *
ñem
,

1103 
çlg_buf
 *
d°
, c⁄° *
pfx
)

1105 
¢d_soc_çlg_dai
 *
dai
 = 
ñem
->dai;

1106 
pfx2
[16];

1107 
îr
;

1109 i‡(!
dai
)

1111 
	`¢¥ötf
(
pfx2
, ’fx2), "%s\t", 
pfx
 ?: "");

1112 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s' {\n", 
ñem
->
id
);

1113 i‡(
îr
 >0 && 
ñem
->
ödex
)

1114 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tindex %u\n",

1115 
ñem
->
ödex
);

1116 i‡(
îr
 >0 && 
dai
->
dai_id
)

1117 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tid %u\n",

1118 
dai
->
dai_id
);

1119 i‡(
îr
 >0 && 
dai
->
∂ayback
)

1120 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tplayback %u\n",

1121 
dai
->
∂ayback
);

1122 i‡(
îr
 >0 && 
dai
->
ˇ±uª
)

1123 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tcapture %u\n",

1124 
dai
->
ˇ±uª
);

1125 i‡(
îr
 >= 0)

1126 
îr
 = 
	`çlg_ßve_°ªams
(
çlg
, 
ñem
, 
d°
, 
pfx2
);

1127 i‡(
îr
 >= 0)

1128 
îr
 = 
	`ßve_Êags
(
dai
->
Êags
, dai->
Êag_mask
, 
d°
, 
pfx
);

1129 i‡(
îr
 >= 0)

1130 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_DATA
,

1131 "d©a", 
d°
, 
pfx2
);

1132 i‡(
îr
 >= 0)

1133 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

1134  
îr
;

1135 
	}
}

1138 
	$∑r£_hw_c⁄fig_ªfs
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

1139 
¢d_c⁄fig_t
 *
cfg
,

1140 
çlg_ñem
 *
ñem
)

1142 
¢d_soc_çlg_lök_c⁄fig
 *
lök
 = 
ñem
->link;

1143 
îr
;

1145 
îr
 = 
	`çlg_∑r£_ªfs
(
cfg
, 
ñem
, 
SND_TPLG_TYPE_HW_CONFIG
);

1146 i‡(
îr
 < 0)

1147  
îr
;

1148 
lök
->
num_hw_c⁄figs
 = 
îr
;

1150 
	}
}

1153 
	$çlg_∑r£_lök
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

1154 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

1156 
¢d_soc_çlg_lök_c⁄fig
 *
lök
;

1157 
çlg_ñem
 *
ñem
;

1158 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1159 
¢d_c⁄fig_t
 *
n
;

1160 c⁄° *
id
, *
vÆ
 = 
NULL
;

1161 
îr
;

1163 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_BE
);

1164 i‡(!
ñem
)

1165  -
ENOMEM
;

1167 
lök
 = 
ñem
->link;

1168 
lök
->
size
 = 
ñem
->size;

1169 
	`¢d_°æ˝y
(
lök
->
«me
, 
ñem
->
id
, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1171 
	`çlg_dbg
(" Lök: %s", 
ñem
->
id
);

1173 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1175 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1176 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1180 i‡(
	`°rcmp
(
id
, "comment") == 0)

1182 i‡(
id
[0] == '#')

1185 i‡(
	`°rcmp
(
id
, "id") == 0) {

1186 i‡(
	`∑r£_unsig√d
(
n
, &
lök
->
id
))

1187  -
EINVAL
;

1191 i‡(
	`°rcmp
(
id
, "stream_name") == 0) {

1192 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆ
) < 0)

1193  -
EINVAL
;

1195 
	`¢d_°æ˝y
(
lök
->
°ªam_«me
, 
vÆ
,

1196 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1197 
	`çlg_dbg
("\t%s: %s", 
id
, 
vÆ
);

1201 i‡(
	`°rcmp
(
id
, "hw_configs") == 0) {

1202 
îr
 = 
	`∑r£_hw_c⁄fig_ªfs
(
çlg
, 
n
, 
ñem
);

1203 i‡(
îr
 < 0)

1204  
îr
;

1208 i‡(
	`°rcmp
(
id
, "default_hw_conf_id") == 0) {

1209 i‡(
	`∑r£_unsig√d
(
n
, &
lök
->
deÁu…_hw_c⁄fig_id
))

1210  -
EINVAL
;

1215 i‡(
	`°rcmp
(
id
, "symmetric_rates") == 0) {

1216 
îr
 = 
	`∑r£_Êag
(
n
,

1217 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_RATES
,

1218 &
lök
->
Êag_mask
, &lök->
Êags
);

1219 i‡(
îr
 < 0)

1220  
îr
;

1224 i‡(
	`°rcmp
(
id
, "symmetric_channels") == 0) {

1225 
îr
 = 
	`∑r£_Êag
(
n
,

1226 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_CHANNELS
,

1227 &
lök
->
Êag_mask
, &lök->
Êags
);

1228 i‡(
îr
 < 0)

1229  
îr
;

1233 i‡(
	`°rcmp
(
id
, "symmetric_sample_bits") == 0) {

1234 
îr
 = 
	`∑r£_Êag
(
n
,

1235 
SND_SOC_TPLG_LNK_FLGBIT_SYMMETRIC_SAMPLEBITS
,

1236 &
lök
->
Êag_mask
, &lök->
Êags
);

1237 i‡(
îr
 < 0)

1238  
îr
;

1242 i‡(
	`°rcmp
(
id
, "ignore_suspend") == 0) {

1243 
îr
 = 
	`∑r£_Êag
(
n
,

1244 
SND_SOC_TPLG_LNK_FLGBIT_VOICE_WAKEUP
,

1245 &
lök
->
Êag_mask
, &lök->
Êags
);

1246 i‡(
îr
 < 0)

1247  
îr
;

1252 i‡(
	`°rcmp
(
id
, "data") == 0) {

1253 
îr
 = 
	`çlg_∑r£_ªfs
(
n
, 
ñem
, 
SND_TPLG_TYPE_DATA
);

1254 i‡(
îr
 < 0)

1255  
îr
;

1261 
	}
}

1264 
	$çlg_ßve_lök
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

1265 
çlg_ñem
 *
ñem
,

1266 
çlg_buf
 *
d°
, c⁄° *
pfx
)

1268 
¢d_soc_çlg_lök_c⁄fig
 *
lök
 = 
ñem
->link;

1269 
pfx2
[16];

1270 
îr
;

1272 i‡(!
lök
)

1274 
	`¢¥ötf
(
pfx2
, ’fx2), "%s\t", 
pfx
 ?: "");

1275 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s' {\n", 
ñem
->
id
);

1276 i‡(
îr
 >0 && 
ñem
->
ödex
)

1277 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tindex %u\n",

1278 
ñem
->
ödex
);

1279 i‡(
îr
 >0 && 
lök
->
id
)

1280 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tid %u\n",

1281 
lök
->
id
);

1282 i‡(
îr
 >0 && 
lök
->
°ªam_«me
[0])

1283 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tstream_name '%s'\n",

1284 
lök
->
°ªam_«me
);

1285 i‡(
îr
 >0 && 
lök
->
deÁu…_hw_c⁄fig_id
)

1286 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tdefault_hw_conf_id %u\n",

1287 
lök
->
deÁu…_hw_c⁄fig_id
);

1288 i‡(
îr
 >= 0)

1289 
îr
 = 
	`ßve_Êags
(
lök
->
Êags
,Üök->
Êag_mask
, 
d°
, 
pfx
);

1290 i‡(
îr
 >= 0)

1291 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_HW_CONFIG
,

1292 "hw_c⁄figs", 
d°
, 
pfx2
);

1293 i‡(
îr
 >= 0)

1294 
îr
 = 
	`çlg_ßve_ªfs
(
çlg
, 
ñem
, 
SND_TPLG_TYPE_DATA
,

1295 "d©a", 
d°
, 
pfx2
);

1296 i‡(
îr
 >= 0)

1297 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

1298  
îr
;

1299 
	}
}

1302 
	$çlg_∑r£_cc
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

1303 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

1305 
¢d_soc_çlg_lök_c⁄fig
 *
lök
;

1306 
çlg_ñem
 *
ñem
;

1307 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1308 
¢d_c⁄fig_t
 *
n
;

1309 c⁄° *
id
;

1311 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_CC
);

1312 i‡(!
ñem
)

1313  -
ENOMEM
;

1315 
lök
 = 
ñem
->link;

1316 
lök
->
size
 = 
ñem
->size;

1318 
	`çlg_dbg
(" CC: %s", 
ñem
->
id
);

1320 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1322 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1323 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1327 i‡(
	`°rcmp
(
id
, "comment") == 0)

1329 i‡(
id
[0] == '#')

1332 i‡(
	`°rcmp
(
id
, "id") == 0) {

1333 i‡(
	`∑r£_unsig√d
(
n
, &
lök
->
id
))

1334  -
EINVAL
;

1341 
	}
}

1344 
	$çlg_ßve_cc
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

1345 
çlg_ñem
 *
ñem
,

1346 
çlg_buf
 *
d°
, c⁄° *
pfx
)

1348 
¢d_soc_çlg_lök_c⁄fig
 *
lök
 = 
ñem
->link;

1349 
pfx2
[16];

1350 
îr
;

1352 i‡(!
lök
)

1354 
	`¢¥ötf
(
pfx2
, ’fx2), "%s\t", 
pfx
 ?: "");

1355 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s' {\n", 
ñem
->
id
);

1356 i‡(
îr
 >0 && 
ñem
->
ödex
)

1357 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tindex %u\n",

1358 
ñem
->
ödex
);

1359 i‡(
îr
 >0 && 
lök
->
id
)

1360 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tid %u\n",

1361 
lök
->
id
);

1362 i‡(
îr
 >= 0)

1363 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

1364  
îr
;

1365 
	}
}

1367 #i‚de‡
DOC_HIDDEN


1368 
	saudio_hw_f‹m©
 {

1369 
	mty≥
;

1370 c⁄° *
	m«me
;

1374 
audio_hw_f‹m©
 
	gaudio_hw_f‹m©s
[] = {

1376 .
ty≥
 = 
SND_SOC_DAI_FORMAT_I2S
,

1377 .
	g«me
 = "I2S",

1380 .
	gty≥
 = 
SND_SOC_DAI_FORMAT_RIGHT_J
,

1381 .
	g«me
 = "RIGHT_J",

1384 .
	gty≥
 = 
SND_SOC_DAI_FORMAT_LEFT_J
,

1385 .
	g«me
 = "LEFT_J",

1388 .
	gty≥
 = 
SND_SOC_DAI_FORMAT_DSP_A
,

1389 .
	g«me
 = "DSP_A",

1392 .
	gty≥
 = 
SND_SOC_DAI_FORMAT_DSP_B
,

1393 .
	g«me
 = "DSP_B",

1396 .
	gty≥
 = 
SND_SOC_DAI_FORMAT_AC97
,

1397 .
	g«me
 = "AC97",

1400 .
	gty≥
 = 
SND_SOC_DAI_FORMAT_PDM
,

1401 .
	g«me
 = "PDM",

1405 
	$gë_audio_hw_f‹m©
(c⁄° *
vÆ
)

1407 
i
;

1409 i‡(
vÆ
[0] == '\0')

1410  -
EINVAL
;

1412 
i
 = 0; i < 
	`ARRAY_SIZE
(
audio_hw_f‹m©s
); i++)

1413 i‡(
	`°rˇ£cmp
(
audio_hw_f‹m©s
[
i
].
«me
, 
vÆ
) == 0)

1414  
audio_hw_f‹m©s
[
i
].
ty≥
;

1416 
	`SNDERR
("övÆidáudiÿHW f‹m© %s", 
vÆ
);

1417  -
EINVAL
;

1418 
	}
}

1420 c⁄° *
	$gë_audio_hw_f‹m©_«me
(
ty≥
)

1422 
i
;

1424 
i
 = 0; i < 
	`ARRAY_SIZE
(
audio_hw_f‹m©s
); i++)

1425 i‡(
audio_hw_f‹m©s
[
i
].
ty≥
 ==Åype)

1426  
audio_hw_f‹m©s
[
i
].
«me
;

1427  
NULL
;

1428 
	}
}

1430 
	$çlg_∑r£_hw_c⁄fig
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

1431 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

1434 
¢d_soc_çlg_hw_c⁄fig
 *
hw_cfg
;

1435 
çlg_ñem
 *
ñem
;

1436 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1437 
¢d_c⁄fig_t
 *
n
;

1438 c⁄° *
id
, *
vÆ
 = 
NULL
;

1439 
ªt
, 
ivÆ
;

1440 
boﬁ
 
¥ovidî_Àgacy
;

1442 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_HW_CONFIG
);

1443 i‡(!
ñem
)

1444  -
ENOMEM
;

1446 
hw_cfg
 = 
ñem
->hw_cfg;

1447 
hw_cfg
->
size
 = 
ñem
->size;

1449 
	`çlg_dbg
(" Lök HW c⁄fig: %s", 
ñem
->
id
);

1451 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1453 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1454 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1458 i‡(
	`°rcmp
(
id
, "comment") == 0)

1460 i‡(
id
[0] == '#')

1463 i‡(
	`°rcmp
(
id
, "id") == 0) {

1464 i‡(
	`∑r£_unsig√d
(
n
, &
hw_cfg
->
id
))

1465  -
EINVAL
;

1469 i‡(
	`°rcmp
(
id
, "format") == 0 ||

1470 
	`°rcmp
(
id
, "fmt") == 0) {

1471 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆ
) < 0)

1472  -
EINVAL
;

1474 
ªt
 = 
	`gë_audio_hw_f‹m©
(
vÆ
);

1475 i‡(
ªt
 < 0)

1476  
ªt
;

1477 
hw_cfg
->
fmt
 = 
ªt
;

1481 
¥ovidî_Àgacy
 = 
Ál£
;

1482 i‡(
	`°rcmp
(
id
, "bclk_master") == 0) {

1483 
	`SNDERR
("dïªˇãd o±i⁄ %s,ÖÀa£ u£ 'b˛k'", 
id
);

1484 
¥ovidî_Àgacy
 = 
åue
;

1487 i‡(
¥ovidî_Àgacy
 ||

1488 
	`°rcmp
(
id
, "bclk") == 0) {

1490 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆ
) < 0)

1491  -
EINVAL
;

1493 i‡(!
	`°rcmp
(
vÆ
, "master")) {

1497 
	`SNDERR
("dïªˇãd b˛k vÆuê'%s'", 
vÆ
);

1499 
hw_cfg
->
b˛k_¥ovidî
 = 
SND_SOC_TPLG_BCLK_CC
;

1500 } i‡(!
	`°rcmp
(
vÆ
, "codec_slave")) {

1501 
	`SNDERR
("dïªˇãd b˛k vÆuê'%s', u£ 'codec_c⁄sumî'", 
vÆ
);

1503 
hw_cfg
->
b˛k_¥ovidî
 = 
SND_SOC_TPLG_BCLK_CC
;

1504 } i‡(!
	`°rcmp
(
vÆ
, "codec_consumer")) {

1505 
hw_cfg
->
b˛k_¥ovidî
 = 
SND_SOC_TPLG_BCLK_CC
;

1506 } i‡(!
	`°rcmp
(
vÆ
, "codec_master")) {

1507 
	`SNDERR
("dïªˇãd b˛k vÆuê'%s', u£ 'codec_¥ovidî", 
vÆ
);

1509 
hw_cfg
->
b˛k_¥ovidî
 = 
SND_SOC_TPLG_BCLK_CP
;

1510 } i‡(!
	`°rcmp
(
vÆ
, "codec_provider")) {

1511 
hw_cfg
->
b˛k_¥ovidî
 = 
SND_SOC_TPLG_BCLK_CP
;

1516 i‡(
	`°rcmp
(
id
, "bclk_freq") == 0 ||

1517 
	`°rcmp
(
id
, "bclk_rate") == 0) {

1518 i‡(
	`∑r£_unsig√d
(
n
, &
hw_cfg
->
b˛k_øã
))

1519  -
EINVAL
;

1523 i‡(
	`°rcmp
(
id
, "bclk_invert") == 0 ||

1524 
	`°rcmp
(
id
, "invert_bclk") == 0) {

1525 
ivÆ
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

1526 i‡(
ivÆ
 < 0)

1527  -
EINVAL
;

1529 
hw_cfg
->
övît_b˛k
 = 
ivÆ
;

1533 
¥ovidî_Àgacy
 = 
Ál£
;

1534 i‡(
	`°rcmp
(
id
, "fsync_master") == 0) {

1535 
	`SNDERR
("dïªˇãd o±i⁄ %s,ÖÀa£ u£ 'fsync'", 
id
);

1536 
¥ovidî_Àgacy
 = 
åue
;

1539 i‡(
¥ovidî_Àgacy
 ||

1540 
	`°rcmp
(
id
, "fsync") == 0) {

1542 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆ
) < 0)

1543  -
EINVAL
;

1545 i‡(!
	`°rcmp
(
vÆ
, "master")) {

1549 
	`SNDERR
("dïªˇãd fsyn¯vÆuê'%s'", 
vÆ
);

1551 
hw_cfg
->
fsync_¥ovidî
 = 
SND_SOC_TPLG_FSYNC_CC
;

1552 } i‡(!
	`°rcmp
(
vÆ
, "codec_slave")) {

1553 
	`SNDERR
("dïªˇãd fsyn¯vÆuê'%s', u£ 'codec_c⁄sumî'", 
vÆ
);

1555 
hw_cfg
->
fsync_¥ovidî
 = 
SND_SOC_TPLG_FSYNC_CC
;

1556 } i‡(!
	`°rcmp
(
vÆ
, "codec_consumer")) {

1557 
hw_cfg
->
fsync_¥ovidî
 = 
SND_SOC_TPLG_FSYNC_CC
;

1558 } i‡(!
	`°rcmp
(
vÆ
, "codec_master")) {

1559 
	`SNDERR
("dïªˇãd fsyn¯vÆuê'%s', u£ 'codec_¥ovidî'", 
vÆ
);

1561 
hw_cfg
->
fsync_¥ovidî
 = 
SND_SOC_TPLG_FSYNC_CP
;

1562 } i‡(!
	`°rcmp
(
vÆ
, "codec_provider")) {

1563 
hw_cfg
->
fsync_¥ovidî
 = 
SND_SOC_TPLG_FSYNC_CP
;

1568 i‡(
	`°rcmp
(
id
, "fsync_invert") == 0 ||

1569 
	`°rcmp
(
id
, "invert_fsync") == 0) {

1570 
ivÆ
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

1571 i‡(
ivÆ
 < 0)

1572  -
EINVAL
;

1574 
hw_cfg
->
övît_fsync
 = 
ivÆ
;

1578 i‡(
	`°rcmp
(
id
, "fsync_freq") == 0 ||

1579 
	`°rcmp
(
id
, "fsync_rate") == 0) {

1580 i‡(
	`∑r£_unsig√d
(
n
, &
hw_cfg
->
fsync_øã
))

1581  -
EINVAL
;

1585 i‡(
	`°rcmp
(
id
, "mclk_freq") == 0 ||

1586 
	`°rcmp
(
id
, "mclk_rate") == 0) {

1587 i‡(
	`∑r£_unsig√d
(
n
, &
hw_cfg
->
m˛k_øã
))

1588  -
EINVAL
;

1592 i‡(
	`°rcmp
(
id
, "mclk") == 0 ||

1593 
	`°rcmp
(
id
, "mclk_direction") == 0) {

1594 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆ
) < 0)

1595  -
EINVAL
;

1597 i‡(!
	`°rcmp
(
vÆ
, "master")) {

1601 
	`SNDERR
("dïªˇãd m˛k vÆuê'%s'", 
vÆ
);

1603 
hw_cfg
->
m˛k_dúe˘i⁄
 = 
SND_SOC_TPLG_MCLK_CI
;

1604 } i‡(!
	`°rcmp
(
vÆ
, "codec_mclk_in")) {

1605 
hw_cfg
->
m˛k_dúe˘i⁄
 = 
SND_SOC_TPLG_MCLK_CI
;

1606 } i‡(!
	`°rcmp
(
vÆ
, "codec_mclk_out")) {

1607 
hw_cfg
->
m˛k_dúe˘i⁄
 = 
SND_SOC_TPLG_MCLK_CO
;

1612 i‡(
	`°rcmp
(
id
, "pm_gate_clocks") == 0 ||

1613 
	`°rcmp
(
id
, "clock_gated") == 0) {

1614 
ivÆ
 = 
	`¢d_c⁄fig_gë_boﬁ
(
n
);

1615 i‡(
ivÆ
 < 0)

1616  -
EINVAL
;

1618 i‡(
ivÆ
)

1619 
hw_cfg
->
˛ock_g©ed
 =

1620 
SND_SOC_TPLG_DAI_CLK_GATE_GATED
;

1622 
hw_cfg
->
˛ock_g©ed
 =

1623 
SND_SOC_TPLG_DAI_CLK_GATE_CONT
;

1627 i‡(
	`°rcmp
(
id
, "tdm_slots") == 0) {

1628 i‡(
	`∑r£_unsig√d
(
n
, &
hw_cfg
->
tdm_¶Ÿs
))

1629  -
EINVAL
;

1633 i‡(
	`°rcmp
(
id
, "tdm_slot_width") == 0) {

1634 i‡(
	`∑r£_unsig√d
(
n
, &
hw_cfg
->
tdm_¶Ÿ_width
))

1635  -
EINVAL
;

1639 i‡(
	`°rcmp
(
id
, "tx_slots") == 0) {

1640 i‡(
	`∑r£_unsig√d
(
n
, &
hw_cfg
->
tx_¶Ÿs
))

1641  -
EINVAL
;

1645 i‡(
	`°rcmp
(
id
, "rx_slots") == 0) {

1646 i‡(
	`∑r£_unsig√d
(
n
, &
hw_cfg
->
rx_¶Ÿs
))

1647  -
EINVAL
;

1651 i‡(
	`°rcmp
(
id
, "tx_channels") == 0) {

1652 i‡(
	`∑r£_unsig√d
(
n
, &
hw_cfg
->
tx_ch™√ls
))

1653  -
EINVAL
;

1657 i‡(
	`°rcmp
(
id
, "rx_channels") == 0) {

1658 i‡(
	`∑r£_unsig√d
(
n
, &
hw_cfg
->
rx_ch™√ls
))

1659  -
EINVAL
;

1666 
	}
}

1669 
	$çlg_ßve_hw_c⁄fig
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

1670 
çlg_ñem
 *
ñem
,

1671 
çlg_buf
 *
d°
, c⁄° *
pfx
)

1673 
¢d_soc_çlg_hw_c⁄fig
 *
hc
 = 
ñem
->
hw_cfg
;

1674 
îr
;

1676 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s' {\n", 
ñem
->
id
);

1677 i‡(
îr
 >0 && 
hc
->
id
)

1678 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tid %u\n",

1679 
hc
->
id
);

1680 i‡(
îr
 >0 && 
hc
->
fmt
)

1681 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tformat '%s'\n",

1682 
	`gë_audio_hw_f‹m©_«me
(
hc
->
fmt
));

1683 i‡(
îr
 >0 && 
hc
->
b˛k_¥ovidî
)

1684 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tbclk '%s'\n",

1685 
hc
->
b˛k_¥ovidî
 =
SND_SOC_TPLG_BCLK_CC
 ?

1687 i‡(
îr
 >0 && 
hc
->
b˛k_øã
)

1688 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tbclk_freq %u\n",

1689 
hc
->
b˛k_øã
);

1690 i‡(
îr
 >0 && 
hc
->
övît_b˛k
)

1691 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tbclk_invert 1\n");

1692 i‡(
îr
 >0 && 
hc
->
fsync_¥ovidî
)

1693 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tfsync_provider '%s'\n",

1694 
hc
->
fsync_¥ovidî
 =
SND_SOC_TPLG_FSYNC_CC
 ?

1696 i‡(
îr
 >0 && 
hc
->
fsync_øã
)

1697 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tfsync_freq %u\n",

1698 
hc
->
fsync_øã
);

1699 i‡(
îr
 >0 && 
hc
->
övît_fsync
)

1700 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tfsync_invert 1\n");

1701 i‡(
îr
 >0 && 
hc
->
m˛k_øã
)

1702 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tmclk_freq %u\n",

1703 
hc
->
m˛k_øã
);

1704 i‡(
îr
 >0 && 
hc
->
m˛k_dúe˘i⁄
)

1705 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tmclk '%s'\n",

1706 
hc
->
m˛k_dúe˘i⁄
 =
SND_SOC_TPLG_MCLK_CI
 ?

1708 i‡(
îr
 >0 && 
hc
->
˛ock_g©ed
)

1709 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\tpm_gate_clocks 1\n");

1710 i‡(
îr
 >0 && 
hc
->
tdm_¶Ÿs
)

1711 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\ttdm_slots %u\n",

1712 
hc
->
tdm_¶Ÿs
);

1713 i‡(
îr
 >0 && 
hc
->
tdm_¶Ÿ_width
)

1714 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\ttdm_slot_width %u\n",

1715 
hc
->
tdm_¶Ÿ_width
);

1716 i‡(
îr
 >0 && 
hc
->
tx_¶Ÿs
)

1717 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\ttx_slots %u\n",

1718 
hc
->
tx_¶Ÿs
);

1719 i‡(
îr
 >0 && 
hc
->
rx_¶Ÿs
)

1720 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\trx_slots %u\n",

1721 
hc
->
rx_¶Ÿs
);

1722 i‡(
îr
 >0 && 
hc
->
tx_ch™√ls
)

1723 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\ttx_channels %u\n",

1724 
hc
->
tx_ch™√ls
);

1725 i‡(
îr
 >0 && 
hc
->
rx_ch™√ls
)

1726 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\trx_channels %u\n",

1727 
hc
->
rx_ch™√ls
);

1728 i‡(
îr
 >= 0)

1729 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "}\n");

1730  
îr
;

1731 
	}
}

1734 
	$çlg_add_°ªam_obje˘
(
¢d_soc_çlg_°ªam
 *
°rm
,

1735 
¢d_çlg_°ªam_ãm∂©e
 *
°rm_çl
)

1737 
	`¢d_°æ˝y
(
°rm
->
«me
, 
°rm_çl
->name,

1738 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1739 
°rm
->
f‹m©
 = 
°rm_çl
->format;

1740 
°rm
->
øã
 = 
°rm_çl
->rate;

1741 
°rm
->
≥riod_byãs
 = 
°rm_çl
->period_bytes;

1742 
°rm
->
buf„r_byãs
 = 
°rm_çl
->buffer_bytes;

1743 
°rm
->
ch™√ls
 = 
°rm_çl
->channels;

1744 
	}
}

1746 
	$çlg_add_°ªam_ˇps
(
¢d_çlg_t
 *
çlg
,

1747 
¢d_çlg_°ªam_ˇps_ãm∂©e
 *
ˇps_çl
)

1749 
¢d_soc_çlg_°ªam_ˇps
 *
ˇps
;

1750 
çlg_ñem
 *
ñem
;

1752 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
, 
ˇps_çl
->
«me
,

1753 
SND_TPLG_TYPE_STREAM_CAPS
);

1754 i‡(!
ñem
)

1755  -
ENOMEM
;

1757 
ˇps
 = 
ñem
->
°ªam_ˇps
;

1759 
	`¢d_°æ˝y
(
ˇps
->
«me
, 
ˇps_çl
->«me, 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1761 
ˇps
->
f‹m©s
 = 
ˇps_çl
->formats;

1762 
ˇps
->
øãs
 = 
ˇps_çl
->rates;

1763 
ˇps
->
øã_mö
 = 
ˇps_çl
->rate_min;

1764 
ˇps
->
øã_max
 = 
ˇps_çl
->rate_max;

1765 
ˇps
->
ch™√ls_mö
 = 
ˇps_çl
->channels_min;

1766 
ˇps
->
ch™√ls_max
 = 
ˇps_çl
->channels_max;

1767 
ˇps
->
≥riods_mö
 = 
ˇps_çl
->periods_min;

1768 
ˇps
->
≥riods_max
 = 
ˇps_çl
->periods_max;

1769 
ˇps
->
≥riod_size_mö
 = 
ˇps_çl
->period_size_min;

1770 
ˇps
->
≥riod_size_max
 = 
ˇps_çl
->period_size_max;

1771 
ˇps
->
buf„r_size_mö
 = 
ˇps_çl
->buffer_size_min;

1772 
ˇps
->
buf„r_size_max
 = 
ˇps_çl
->buffer_size_max;

1773 
ˇps
->
sig_bôs
 = 
ˇps_çl
->sig_bits;

1775 
	}
}

1778 
	$çlg_add_pcm_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
)

1780 
¢d_çlg_pcm_ãm∂©e
 *
pcm_çl
 = 
t
->
pcm
;

1781 
¢d_soc_çlg_¥iv©e
 *
¥iv
;

1782 
¢d_soc_çlg_pcm
 *
pcm
;

1783 
çlg_ñem
 *
ñem
;

1784 
ªt
, 
i
;

1786 
	`çlg_dbg
("PCM: %s, DAI %s", 
pcm_çl
->
pcm_«me
,Öcm_çl->
dai_«me
);

1788 i‡(
pcm_çl
->
num_°ªams
 > 
SND_SOC_TPLG_STREAM_CONFIG_MAX
)

1789  -
EINVAL
;

1791 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
, 
pcm_çl
->
pcm_«me
,

1792 
SND_TPLG_TYPE_PCM
);

1793 i‡(!
ñem
)

1794  -
ENOMEM
;

1796 
pcm
 = 
ñem
->pcm;

1797 
pcm
->
size
 = 
ñem
->size;

1799 
	`¢d_°æ˝y
(
pcm
->
pcm_«me
, 
pcm_çl
->pcm_name,

1800 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1801 
	`¢d_°æ˝y
(
pcm
->
dai_«me
, 
pcm_çl
->dai_name,

1802 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1803 
pcm
->
pcm_id
 = 
pcm_çl
->pcm_id;

1804 
pcm
->
dai_id
 = 
pcm_çl
->dai_id;

1805 
pcm
->
∂ayback
 = 
pcm_çl
->playback;

1806 
pcm
->
ˇ±uª
 = 
pcm_çl
->capture;

1807 
pcm
->
com¥ess
 = 
pcm_çl
->compress;

1809 
i
 = 0; i < 2; i++) {

1810 i‡(!
pcm_çl
->
ˇps
[
i
] || !pcm_çl->ˇps[i]->
«me
)

1812 
ªt
 = 
	`çlg_add_°ªam_ˇps
(
çlg
, 
pcm_çl
->
ˇps
[
i
]);

1813 i‡(
ªt
 < 0)

1814  
ªt
;

1815 
	`¢d_°æ˝y
(
pcm
->
ˇps
[
i
].
«me
, 
pcm_çl
->caps[i]->name,

1816 (
pcm
->
ˇps
[
i
].
«me
));

1819 
pcm
->
Êag_mask
 = 
pcm_çl
->flag_mask;

1820 
pcm
->
Êags
 = 
pcm_çl
->flags;

1822 
pcm
->
num_°ªams
 = 
pcm_çl
->num_streams;

1823 
i
 = 0; i < 
pcm_çl
->
num_°ªams
; i++)

1824 
	`çlg_add_°ªam_obje˘
(&
pcm
->
°ªam
[
i
], &
pcm_çl
->stream[i]);

1827 
¥iv
 = 
pcm_çl
->priv;

1828 i‡(
¥iv
 &&Öriv->
size
 > 0) {

1829 
ªt
 = 
	`çlg_add_d©a
(
çlg
, 
ñem
, 
¥iv
,

1830 (*
¥iv
Ë+Öriv->
size
);

1831 i‡(
ªt
 < 0)

1832  
ªt
;

1836 
	}
}

1839 
	$£t_lök_hw_c⁄fig
(
¢d_soc_çlg_hw_c⁄fig
 *
cfg
,

1840 
¢d_çlg_hw_c⁄fig_ãm∂©e
 *
çl
)

1842 
i
;

1844 
cfg
->
size
 = (*cfg);

1845 
cfg
->
id
 = 
çl
->id;

1847 
cfg
->
fmt
 = 
çl
->fmt;

1848 
cfg
->
˛ock_g©ed
 = 
çl
->clock_gated;

1849 
cfg
->
övît_b˛k
 = 
çl
->invert_bclk;

1850 
cfg
->
övît_fsync
 = 
çl
->invert_fsync;

1851 
cfg
->
b˛k_¥ovidî
 = 
çl
->bclk_provider;

1852 
cfg
->
fsync_¥ovidî
 = 
çl
->fsync_provider;

1853 
cfg
->
m˛k_dúe˘i⁄
 = 
çl
->mclk_direction;

1854 
cfg
->
ª£rved
 = 
çl
->reserved;

1855 
cfg
->
m˛k_øã
 = 
çl
->mclk_rate;

1856 
cfg
->
b˛k_øã
 = 
çl
->bclk_rate;

1857 
cfg
->
fsync_øã
 = 
çl
->fsync_rate;

1859 
cfg
->
tdm_¶Ÿs
 = 
çl
->tdm_slots;

1860 
cfg
->
tdm_¶Ÿ_width
 = 
çl
->tdm_slot_width;

1861 
cfg
->
tx_¶Ÿs
 = 
çl
->tx_slots;

1862 
cfg
->
rx_¶Ÿs
 = 
çl
->rx_slots;

1864 i‡(
cfg
->
tx_ch™√ls
 > 
SND_SOC_TPLG_MAX_CHAN


1865 || 
cfg
->
rx_ch™√ls
 > 
SND_SOC_TPLG_MAX_CHAN
)

1866  -
EINVAL
;

1868 
cfg
->
tx_ch™√ls
 = 
çl
->tx_channels;

1869 
i
 = 0; i < 
cfg
->
tx_ch™√ls
; i++)

1870 
cfg
->
tx_ch™m≠
[
i
] = 
çl
->tx_chanmap[i];

1872 
cfg
->
rx_ch™√ls
 = 
çl
->rx_channels;

1873 
i
 = 0; i < 
cfg
->
rx_ch™√ls
; i++)

1874 
cfg
->
rx_ch™m≠
[
i
] = 
çl
->rx_chanmap[i];

1877 
	}
}

1880 
	$çlg_add_lök_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
)

1882 
¢d_çlg_lök_ãm∂©e
 *
lök_çl
 = 
t
->
lök
;

1883 
¢d_soc_çlg_lök_c⁄fig
 *
lök
;

1884 
¢d_soc_çlg_¥iv©e
 *
¥iv
;

1885 
çlg_ñem
 *
ñem
;

1886 
i
;

1887 
ªt
;

1889 i‡(
t
->
ty≥
 !
SND_TPLG_TYPE_LINK
 &&Å->ty≥ !
SND_TPLG_TYPE_BE


1890 && 
t
->
ty≥
 !
SND_TPLG_TYPE_CC
)

1891  -
EINVAL
;

1893 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
, 
lök_çl
->
«me
, 
t
->
ty≥
);

1894 i‡(!
ñem
)

1895  -
ENOMEM
;

1897 
	`çlg_dbg
("Lök: %s", 
lök_çl
->
«me
);

1899 
lök
 = 
ñem
->link;

1900 
lök
->
size
 = 
ñem
->size;

1903 
lök
->
id
 = 
lök_çl
->id;

1904 
	`¢d_°æ˝y
(
lök
->
«me
, 
lök_çl
->name,

1905 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1906 
	`¢d_°æ˝y
(
lök
->
°ªam_«me
, 
lök_çl
->stream_name,

1907 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1910 i‡(
lök_çl
->
num_°ªams
 > 
SND_SOC_TPLG_STREAM_CONFIG_MAX
)

1911  -
EINVAL
;

1912 
lök
->
num_°ªams
 = 
lök_çl
->num_streams;

1913 
i
 = 0; i < 
lök
->
num_°ªams
; i++)

1914 
	`çlg_add_°ªam_obje˘
(&
lök
->
°ªam
[
i
], &
lök_çl
->stream[i]);

1917 i‡(
lök_çl
->
num_hw_c⁄figs
 > 
SND_SOC_TPLG_HW_CONFIG_MAX
)

1918  -
EINVAL
;

1919 
lök
->
num_hw_c⁄figs
 = 
lök_çl
->num_hw_configs;

1920 
lök
->
deÁu…_hw_c⁄fig_id
 = 
lök_çl
->default_hw_config_id;

1921 
i
 = 0; i < 
lök
->
num_hw_c⁄figs
; i++)

1922 
	`£t_lök_hw_c⁄fig
(&
lök
->
hw_c⁄fig
[
i
], &
lök_çl
->hw_config[i]);

1925 
lök
->
Êag_mask
 = 
lök_çl
->flag_mask;

1926 
lök
->
Êags
 = 
lök_çl
->flags;

1929 
¥iv
 = 
lök_çl
->priv;

1930 i‡(
¥iv
 &&Öriv->
size
 > 0) {

1931 
ªt
 = 
	`çlg_add_d©a
(
çlg
, 
ñem
, 
¥iv
,

1932 (*
¥iv
Ë+Öriv->
size
);

1933 i‡(
ªt
 < 0)

1934  
ªt
;

1938 
	}
}

1940 
	$çlg_add_dai_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
)

1942 
¢d_çlg_dai_ãm∂©e
 *
dai_çl
 = 
t
->
dai
;

1943 
¢d_soc_çlg_dai
 *
dai
;

1944 
¢d_soc_çlg_¥iv©e
 *
¥iv
;

1945 
çlg_ñem
 *
ñem
;

1946 
ªt
, 
i
;

1948 
	`çlg_dbg
("DAI %s", 
dai_çl
->
dai_«me
);

1950 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
NULL
, 
dai_çl
->
dai_«me
,

1951 
SND_TPLG_TYPE_DAI
);

1952 i‡(!
ñem
)

1953  -
ENOMEM
;

1955 
dai
 = 
ñem
->dai;

1956 
dai
->
size
 = 
ñem
->size;

1958 
	`¢d_°æ˝y
(
dai
->
dai_«me
, 
dai_çl
->dai_name,

1959 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

1960 
dai
->
dai_id
 = 
dai_çl
->dai_id;

1963 
dai
->
∂ayback
 = 
dai_çl
->playback;

1964 
dai
->
ˇ±uª
 = 
dai_çl
->capture;

1966 
i
 = 0; i < 2; i++) {

1967 i‡(!
dai_çl
->
ˇps
[
i
] || !dai_çl->ˇps[i]->
«me
)

1969 
ªt
 = 
	`çlg_add_°ªam_ˇps
(
çlg
, 
dai_çl
->
ˇps
[
i
]);

1970 i‡(
ªt
 < 0)

1971  
ªt
;

1972 
	`¢d_°æ˝y
(
dai
->
ˇps
[
i
].
«me
, 
dai_çl
->caps[i]->name,

1973 (
dai
->
ˇps
[
i
].
«me
));

1977 
dai
->
Êag_mask
 = 
dai_çl
->flag_mask;

1978 
dai
->
Êags
 = 
dai_çl
->flags;

1981 
¥iv
 = 
dai_çl
->priv;

1982 i‡(
¥iv
 &&Öriv->
size
 > 0) {

1983 
ªt
 = 
	`çlg_add_d©a
(
çlg
, 
ñem
, 
¥iv
,

1984 (*
¥iv
Ë+Öriv->
size
);

1985 i‡(
ªt
 < 0)

1986  
ªt
;

1990 
	}
}

1993 
	$çlg_decode_pcm
(
¢d_çlg_t
 *
çlg
,

1994 
size_t
 
pos
,

1995 
¢d_soc_çlg_hdr
 *
hdr
,

1996 *
bö
, 
size_t
 
size
)

1998 
¢d_soc_çlg_pcm
 *
pcm
;

1999 
¢d_çlg_obj_ãm∂©e_t
 
t
;

2000 
¢d_çlg_pcm_ãm∂©e
 *
±
;

2001 
¢d_çlg_°ªam_ˇps_ãm∂©e
 
ˇps
[2], *
ˇp
;

2002 
¢d_çlg_°ªam_ãm∂©e
 *
°ªam
;

2003 
i
;

2004 
size_t
 
asize
;

2005 
îr
;

2007 
îr
 = 
	`çlg_decode_ãm∂©e
(
çlg
, 
pos
, 
hdr
, &
t
);

2008 i‡(
îr
 < 0)

2009  
îr
;

2011 
asize
 = (*
±
Ë+ 
SND_SOC_TPLG_STREAM_CONFIG_MAX
 * (*
°ªam
);

2012 
±
 = 
	`Æloˇ
(
asize
);

2014 
√xt
:

2015 
	`mem£t
(
±
, 0, 
asize
);

2016 
pcm
 = 
bö
;

2018 i‡(
size
 < (*
pcm
)) {

2019 
	`SNDERR
("pcm: smÆ»sizê%d", 
size
);

2020  -
EINVAL
;

2022 i‡((*
pcm
Ë!pcm->
size
) {

2023 
	`SNDERR
("pcm: unknownÉlement size %d (expected %zd)",

2024 
pcm
->
size
, (*pcm));

2025  -
EINVAL
;

2027 i‡(
pcm
->
num_°ªams
 > 
SND_SOC_TPLG_STREAM_CONFIG_MAX
) {

2028 
	`SNDERR
("pcm: wr⁄gÇumbî o‡°ªam†%d", 
pcm
->
num_°ªams
);

2029  -
EINVAL
;

2031 i‡((*
pcm
Ë+Öcm->
¥iv
.
size
 > size) {

2032 
	`SNDERR
("pcm: wr⁄gÖriv©êd©®sizê%d", 
pcm
->
¥iv
.
size
);

2033  -
EINVAL
;

2036 
	`çlg_log
(
çlg
, 'D', 
pos
, "pcm: size %dÖrivate size %d streams %d",

2037 
pcm
->
size
,Öcm->
¥iv
.size,Öcm->
num_°ªams
);

2039 
±
->
pcm_«me
 = 
pcm
->pcm_name;

2040 
	`çlg_log
(
çlg
, 'D', 
pos
, "pcm:Öcm_«mê'%s'", 
±
->
pcm_«me
);

2041 
±
->
dai_«me
 = 
pcm
->dai_name;

2042 
	`çlg_log
(
çlg
, 'D', 
pos
, "pcm: dai_«mê'%s'", 
±
->
dai_«me
);

2043 
±
->
pcm_id
 = 
pcm
->pcm_id;

2044 
±
->
dai_id
 = 
pcm
->dai_id;

2045 
	`çlg_log
(
çlg
, 'D', 
pos
, "pcm:Öcm_id %d dai_id %d", 
±
->
pcm_id
,Öt->
dai_id
);

2046 
±
->
∂ayback
 = 
pcm
->playback;

2047 
±
->
ˇ±uª
 = 
pcm
->capture;

2048 
±
->
com¥ess
 = 
pcm
->compress;

2049 
	`çlg_log
(
çlg
, 'D', 
pos
, "pcm:Ölayback %d capture %d compress %d",

2050 
±
->
∂ayback
,Öt->
ˇ±uª
,Öt->
com¥ess
);

2051 
±
->
num_°ªams
 = 
pcm
->num_streams;

2052 
±
->
Êag_mask
 = 
pcm
->flag_mask;

2053 
±
->
Êags
 = 
pcm
->flags;

2054 
i
 = 0; i < 
pcm
->
num_°ªams
; i++) {

2055 
°ªam
 = &
±
->°ªam[
i
];

2056 i‡(
pcm
->
°ªam
[
i
].
size
 != (pcm->stream[0])) {

2057 
	`SNDERR
("pcm: unknown stream structure size %d",

2058 
pcm
->
°ªam
[
i
].
size
);

2059  -
EINVAL
;

2061 
°ªam
->
«me
 = 
pcm
->°ªam[
i
].name;

2062 
	`çlg_log
(
çlg
, 'D', 
pos
 + 
	`off£tof
(
¢d_soc_çlg_pcm
, 
°ªam
[
i
]),

2063 "°ªam %d: '%s'", 
i
, 
°ªam
->
«me
);

2064 
°ªam
->
f‹m©
 = 
pcm
->°ªam[
i
].format;

2065 
°ªam
->
øã
 = 
pcm
->°ªam[
i
].rate;

2066 
°ªam
->
≥riod_byãs
 = 
pcm
->°ªam[
i
].period_bytes;

2067 
°ªam
->
buf„r_byãs
 = 
pcm
->°ªam[
i
].buffer_bytes;

2068 
°ªam
->
ch™√ls
 = 
pcm
->°ªam[
i
].channels;

2070 
i
 = 0; i < 2; i++) {

2071 i‡(
i
 =0 && !
pcm
->
∂ayback
)

2073 i‡(
i
 =1 && !
pcm
->
ˇ±uª
)

2075 
ˇp
 = &
ˇps
[
i
];

2076 
±
->
ˇps
[
i
] = 
ˇp
;

2077 i‡(
pcm
->
ˇps
[
i
].
size
 != (pcm->caps[0])) {

2078 
	`SNDERR
("pcm: unknown caps structure size %d",

2079 
pcm
->
ˇps
[
i
].
size
);

2080  -
EINVAL
;

2082 
ˇp
->
«me
 = 
pcm
->
ˇps
[
i
].name;

2083 
	`çlg_log
(
çlg
, 'D', 
pos
 + 
	`off£tof
(
¢d_soc_çlg_pcm
, 
ˇps
[
i
]),

2084 "ˇp†%d: '%s'", 
i
, 
ˇp
->
«me
);

2085 
ˇp
->
f‹m©s
 = 
pcm
->
ˇps
[
i
].formats;

2086 
ˇp
->
øãs
 = 
pcm
->
ˇps
[
i
].rates;

2087 
ˇp
->
øã_mö
 = 
pcm
->
ˇps
[
i
].rate_min;

2088 
ˇp
->
øã_max
 = 
pcm
->
ˇps
[
i
].rate_max;

2089 
ˇp
->
ch™√ls_mö
 = 
pcm
->
ˇps
[
i
].channels_min;

2090 
ˇp
->
ch™√ls_max
 = 
pcm
->
ˇps
[
i
].channels_max;

2091 
ˇp
->
≥riods_mö
 = 
pcm
->
ˇps
[
i
].periods_min;

2092 
ˇp
->
≥riods_max
 = 
pcm
->
ˇps
[
i
].periods_max;

2093 
ˇp
->
≥riod_size_mö
 = 
pcm
->
ˇps
[
i
].period_size_min;

2094 
ˇp
->
≥riod_size_max
 = 
pcm
->
ˇps
[
i
].period_size_max;

2095 
ˇp
->
buf„r_size_mö
 = 
pcm
->
ˇps
[
i
].buffer_size_min;

2096 
ˇp
->
buf„r_size_max
 = 
pcm
->
ˇps
[
i
].buffer_size_max;

2097 
ˇp
->
sig_bôs
 = 
pcm
->
ˇps
[
i
].sig_bits;

2100 
	`çlg_log
(
çlg
, 'D', 
pos
 + 
	`off£tof
(
¢d_soc_çlg_pcm
, 
¥iv
),

2102 
±
->
¥iv
 = &
pcm
->priv;

2104 
bö
 +(*
pcm
Ë+Öcm->
¥iv
.
size
;

2105 
size
 -(*
pcm
Ë+Öcm->
¥iv
.size;

2106 
pos
 +(*
pcm
Ë+Öcm->
¥iv
.
size
;

2108 
t
.
pcm
 = 
±
;

2109 
îr
 = 
	`¢d_çlg_add_obje˘
(
çlg
, &
t
);

2110 i‡(
îr
 < 0)

2111  
îr
;

2113 i‡(
size
 > 0)

2114 
√xt
;

2117 
	}
}

2120 
	$çlg_decode_dai
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

2121 
size_t
 
pos
 
ATTRIBUTE_UNUSED
,

2122 
¢d_soc_çlg_hdr
 *
hdr
 
ATTRIBUTE_UNUSED
,

2123 *
bö
 
ATTRIBUTE_UNUSED
,

2124 
size_t
 
size
 
ATTRIBUTE_UNUSED
)

2126 
	`SNDERR
("not implemented");

2127  -
ENXIO
;

2128 
	}
}

2131 
	$çlg_decode_cc
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

2132 
size_t
 
pos
 
ATTRIBUTE_UNUSED
,

2133 
¢d_soc_çlg_hdr
 *
hdr
 
ATTRIBUTE_UNUSED
,

2134 *
bö
 
ATTRIBUTE_UNUSED
,

2135 
size_t
 
size
 
ATTRIBUTE_UNUSED
)

2137 
	`SNDERR
("not implemented");

2138  -
ENXIO
;

2139 
	}
}

2142 
	$çlg_decode_lök
(
¢d_çlg_t
 *
çlg
,

2143 
size_t
 
pos
,

2144 
¢d_soc_çlg_hdr
 *
hdr
,

2145 *
bö
, 
size_t
 
size
)

2147 
¢d_soc_çlg_lök_c⁄fig
 *
lök
;

2148 
¢d_çlg_obj_ãm∂©e_t
 
t
;

2149 
¢d_çlg_lök_ãm∂©e
 
…
;

2150 
¢d_çlg_°ªam_ãm∂©e
 
°ªams
[
SND_SOC_TPLG_STREAM_CONFIG_MAX
];

2151 
¢d_çlg_°ªam_ãm∂©e
 *
°ªam
;

2152 
¢d_çlg_hw_c⁄fig_ãm∂©e
 
hws
[
SND_SOC_TPLG_HW_CONFIG_MAX
];

2153 
¢d_çlg_hw_c⁄fig_ãm∂©e
 *
hw
;

2154 
i
, 
j
;

2155 
îr
;

2157 
îr
 = 
	`çlg_decode_ãm∂©e
(
çlg
, 
pos
, 
hdr
, &
t
);

2158 i‡(
îr
 < 0)

2159  
îr
;

2161 
√xt
:

2162 
	`mem£t
(&
…
, 0, (lt));

2163 
	`mem£t
(
°ªams
, 0, (streams));

2164 
	`mem£t
(
hws
, 0, (hws));

2165 
lök
 = 
bö
;

2167 i‡(
size
 < (*
lök
)) {

2168 
	`SNDERR
("lök: smÆ»sizê%d", 
size
);

2169  -
EINVAL
;

2171 i‡((*
lök
Ë!lök->
size
) {

2172 
	`SNDERR
("link: unknownÉlement size %d (expected %zd)",

2173 
lök
->
size
, (*link));

2174  -
EINVAL
;

2176 i‡(
lök
->
num_°ªams
 > 
SND_SOC_TPLG_STREAM_CONFIG_MAX
) {

2177 
	`SNDERR
("lök: wr⁄gÇumbî o‡°ªam†%d", 
lök
->
num_°ªams
);

2178  -
EINVAL
;

2180 i‡(
lök
->
num_hw_c⁄figs
 > 
SND_SOC_TPLG_HW_CONFIG_MAX
) {

2181 
	`SNDERR
("lök: wr⁄gÇumbî o‡°ªam†%d", 
lök
->
num_°ªams
);

2182  -
EINVAL
;

2184 i‡((*
lök
Ë+Üök->
¥iv
.
size
 > size) {

2185 
	`SNDERR
("lök: wr⁄gÖriv©êd©®sizê%d", 
lök
->
¥iv
.
size
);

2186  -
EINVAL
;

2189 
	`çlg_log
(
çlg
, 'D', 
pos
, "link: size %dÖrivate size %d streams %d "

2191 
lök
->
size
,Üök->
¥iv
.size,Üök->
num_°ªams
,

2192 
lök
->
num_hw_c⁄figs
);

2194 
…
.
id
 = 
lök
->id;

2195 
…
.
«me
 = 
lök
->name;

2196 
	`çlg_log
(
çlg
, 'D', 
pos
, "lök:Çamê'%s'", 
…
.
«me
);

2197 
…
.
°ªam_«me
 = 
lök
->stream_name;

2198 
	`çlg_log
(
çlg
, 'D', 
pos
, "lök: såóm_«mê'%s'", 
…
.
°ªam_«me
);

2199 
…
.
num_°ªams
 = 
lök
->num_streams;

2200 
…
.
num_hw_c⁄figs
 = 
lök
->num_hw_configs;

2201 
…
.
deÁu…_hw_c⁄fig_id
 = 
lök
->default_hw_config_id;

2202 
…
.
Êag_mask
 = 
lök
->flag_mask;

2203 
…
.
Êags
 = 
lök
->flags;

2204 
i
 = 0; i < 
lök
->
num_°ªams
; i++) {

2205 
°ªam
 = &
°ªams
[
i
];

2206 i‡(
lök
->
°ªam
[
i
].
size
 != (link->stream[0])) {

2207 
	`SNDERR
("link: unknown stream structure size %d",

2208 
lök
->
°ªam
[
i
].
size
);

2209  -
EINVAL
;

2211 
°ªam
->
«me
 = 
lök
->°ªam[
i
].name;

2212 
	`çlg_log
(
çlg
, 'D',

2213 
pos
 + 
	`off£tof
(
¢d_soc_çlg_lök_c⁄fig
, 
°ªam
[
i
]),

2214 "°ªam %d: '%s'", 
i
, 
°ªam
->
«me
);

2215 
°ªam
->
f‹m©
 = 
lök
->°ªam[
i
].format;

2216 
°ªam
->
øã
 = 
lök
->°ªam[
i
].rate;

2217 
°ªam
->
≥riod_byãs
 = 
lök
->°ªam[
i
].period_bytes;

2218 
°ªam
->
buf„r_byãs
 = 
lök
->°ªam[
i
].buffer_bytes;

2219 
°ªam
->
ch™√ls
 = 
lök
->°ªam[
i
].channels;

2221 
…
.
°ªam
 = 
°ªams
;

2222 
i
 = 0; i < 
lök
->
num_hw_c⁄figs
; i++) {

2223 
hw
 = &
hws
[
i
];

2224 i‡(
lök
->
hw_c⁄fig
[
i
].
size
 != (link->hw_config[0])) {

2225 
	`SNDERR
("link: unknown hw_config structure size %d",

2226 
lök
->
hw_c⁄fig
[
i
].
size
);

2227  -
EINVAL
;

2229 
hw
->
id
 = 
lök
->
hw_c⁄fig
[
i
].id;

2230 
hw
->
fmt
 = 
lök
->
hw_c⁄fig
[
i
].fmt;

2231 
hw
->
˛ock_g©ed
 = 
lök
->
hw_c⁄fig
[
i
].clock_gated;

2232 
hw
->
övît_b˛k
 = 
lök
->
hw_c⁄fig
[
i
].invert_bclk;

2233 
hw
->
övît_fsync
 = 
lök
->
hw_c⁄fig
[
i
].invert_fsync;

2234 
hw
->
b˛k_¥ovidî
 = 
lök
->
hw_c⁄fig
[
i
].bclk_provider;

2235 
hw
->
fsync_¥ovidî
 = 
lök
->
hw_c⁄fig
[
i
].fsync_provider;

2236 
hw
->
m˛k_dúe˘i⁄
 = 
lök
->
hw_c⁄fig
[
i
].mclk_direction;

2237 
hw
->
m˛k_øã
 = 
lök
->
hw_c⁄fig
[
i
].mclk_rate;

2238 
hw
->
b˛k_øã
 = 
lök
->
hw_c⁄fig
[
i
].bclk_rate;

2239 
hw
->
fsync_øã
 = 
lök
->
hw_c⁄fig
[
i
].fsync_rate;

2240 
hw
->
tdm_¶Ÿs
 = 
lök
->
hw_c⁄fig
[
i
].tdm_slots;

2241 
hw
->
tdm_¶Ÿ_width
 = 
lök
->
hw_c⁄fig
[
i
].tdm_slot_width;

2242 
hw
->
tx_¶Ÿs
 = 
lök
->
hw_c⁄fig
[
i
].tx_slots;

2243 
hw
->
rx_¶Ÿs
 = 
lök
->
hw_c⁄fig
[
i
].rx_slots;

2244 
hw
->
tx_ch™√ls
 = 
lök
->
hw_c⁄fig
[
i
].tx_channels;

2245 i‡(
hw
->
tx_ch™√ls
 > 
SND_SOC_TPLG_MAX_CHAN
) {

2246 
	`SNDERR
("lök: wr⁄gÅx ch™√l†%d", 
hw
->
tx_ch™√ls
);

2247  -
EINVAL
;

2249 
j
 = 0; j < 
hw
->
tx_ch™√ls
; j++)

2250 
hw
->
tx_ch™m≠
[
j
] = 
lök
->
hw_c⁄fig
[
i
].tx_chanmap[j];

2251 
hw
->
rx_ch™√ls
 = 
lök
->
hw_c⁄fig
[
i
].rx_channels;

2252 i‡(
hw
->
rx_ch™√ls
 > 
SND_SOC_TPLG_MAX_CHAN
) {

2253 
	`SNDERR
("lök: wr⁄gÑx ch™√l†%d", 
hw
->
tx_ch™√ls
);

2254  -
EINVAL
;

2256 
j
 = 0; j < 
hw
->
rx_ch™√ls
; j++)

2257 
hw
->
rx_ch™m≠
[
j
] = 
lök
->
hw_c⁄fig
[
i
].rx_chanmap[j];

2259 
…
.
hw_c⁄fig
 = 
hws
;

2261 
	`çlg_log
(
çlg
, 'D', 
pos
 + 
	`off£tof
(
¢d_soc_çlg_pcm
, 
¥iv
),

2263 
…
.
¥iv
 = &
lök
->priv;

2265 
bö
 +(*
lök
Ë+Üök->
¥iv
.
size
;

2266 
size
 -(*
lök
Ë+Üök->
¥iv
.size;

2267 
pos
 +(*
lök
Ë+Üök->
¥iv
.
size
;

2269 
t
.
lök
 = &
…
;

2270 
îr
 = 
	`¢d_çlg_add_obje˘
(
çlg
, &
t
);

2271 i‡(
îr
 < 0)

2272  
îr
;

2274 i‡(
size
 > 0)

2275 
√xt
;

2278 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/save.c

18 
	~"çlg_loˇl.h
"

20 
	#SAVE_ALLOC_SHIFT
 (13Ë

	)

21 
	#PRINT_ALLOC_SHIFT
 (10Ë

	)

22 
	#PRINT_BUF_SIZE_MAX
 (1024 * 1024)

	)

23 
	#NEXT_CHUNK
(
vÆ
, 
shi·
Ë((((vÆË>> (shi·)Ë+ 1Ë<< (shi·))

	)

25 
	$çlg_buf_öô
(
çlg_buf
 *
buf
)

27 
buf
->
d°
 = 
NULL
;

28 
buf
->
d°_Àn
 = 0;

29 
buf
->
¥ötf_buf
 = 
NULL
;

30 
buf
->
¥ötf_buf_size
 = 0;

31 
	}
}

33 
	$çlg_buf_‰ì
(
çlg_buf
 *
buf
)

35 
	`‰ì
(
buf
->
d°
);

36 
	`‰ì
(
buf
->
¥ötf_buf
);

37 
	}
}

39 *
	$çlg_buf_dëach
(
çlg_buf
 *
buf
)

41 *
ªt
 = 
buf
->
d°
;

42 
	`‰ì
(
buf
->
¥ötf_buf
);

43  
ªt
;

44 
	}
}

46 
	$çlg_ßve_¥ötf
(
çlg_buf
 *
d°
, c⁄° *
pfx
, c⁄° *
fmt
, ...)

48 
va_li°
 
va
;

49 *
s
;

50 
size_t
 
n
, 
l
, 
t
, 
∂
;

51 
ªt
 = 0;

53 i‡(
pfx
 =
NULL
)

54 
pfx
 = "";

56 
	`va_°¨t
(
va
, 
fmt
);

57 
n
 = 
	`v¢¥ötf
(
d°
->
¥ötf_buf
, d°->
¥ötf_buf_size
, 
fmt
, 
va
);

58 
	`va_íd
(
va
);

60 i‡(
n
 >
PRINT_BUF_SIZE_MAX
) {

61 
ªt
 = -
EOVERFLOW
;

62 
íd
;

65 i‡(
n
 >
d°
->
¥ötf_buf_size
) {

66 
t
 = 
	`NEXT_CHUNK
(
n
 + 1, 
PRINT_ALLOC_SHIFT
);

67 
s
 = 
	`ªÆloc
(
d°
->
¥ötf_buf
, 
t
);

68 i‡(!
s
) {

69 
ªt
 = -
ENOMEM
;

70 
íd
;

72 
d°
->
¥ötf_buf
 = 
s
;

73 
d°
->
¥ötf_buf_size
 = 
t
;

74 
	`va_°¨t
(
va
, 
fmt
);

75 
n
 = 
	`v¢¥ötf
(
d°
->
¥ötf_buf
,Ç + 1, 
fmt
, 
va
);

76 
	`va_íd
(
va
);

79 
∂
 = 
	`°æí
(
pfx
);

80 
l
 = 
d°
->
d°_Àn
;

81 
t
 = 
l
 + 
∂
 + 
n
 + 1;

83 i‡(
d°
->d° =
NULL
 ||

84 (
l
 >> 
SAVE_ALLOC_SHIFT
Ë!(
t
 >> SAVE_ALLOC_SHIFT)) {

85 
s
 = 
	`ªÆloc
(
d°
->d°, 
	`NEXT_CHUNK
(
t
, 
SAVE_ALLOC_SHIFT
));

86 i‡(
s
 =
NULL
) {

87 
ªt
 = -
ENOMEM
;

88 
íd
;

91 
s
 = 
d°
->dst;

94 i‡(
∂
 > 0)

95 
	`°r˝y
(
s
 + 
l
, 
pfx
);

96 
	`°r˝y
(
s
 + 
l
 + 
∂
, 
d°
->
¥ötf_buf
);

97 
d°
->d° = 
s
;

98 
d°
->
d°_Àn
 = 
t
 - 1;

99 
íd
:

100  
ªt
;

101 
	}
}

103 
	$çlg_ni˚_vÆue_f‹m©
(*
d°
, 
size_t
 
d°_size
, 
vÆue
)

105 i‡((
vÆue
 % 1000) != 0) {

106 i‡(
vÆue
 > 0xfffffff0)

107  
	`¢¥ötf
(
d°
, 
d°_size
, "%d", ()
vÆue
);

108 i‡(
vÆue
 >= 0xffff0000)

109  
	`¢¥ötf
(
d°
, 
d°_size
, "0x%x", 
vÆue
);

111  
	`¢¥ötf
(
d°
, 
d°_size
, "%u", 
vÆue
);

112 
	}
}

114 
	$çlg_µröt_öãgî
(
¢d_c⁄fig_t
 *
n
, **
ªt
)

116 
lvÆ
;

117 
îr
, 
ty≥
;

118 
buf
[16];

120 
ty≥
 = 
	`¢d_c⁄fig_gë_ty≥
(
n
);

121 i‡(
ty≥
 =
SND_CONFIG_TYPE_INTEGER
) {

122 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
lvÆ
);

123 i‡(
îr
 < 0)

124  
îr
;

125 i‡(
lvÆ
 < 
INT_MIN
 ||ÜvÆ > 
UINT_MAX
)

126  
	`¢d_c⁄fig_gë_ascii
(
n
, 
ªt
);

127 } i‡(
ty≥
 =
SND_CONFIG_TYPE_INTEGER64
) {

128 
ŒvÆ
;

129 
îr
 = 
	`¢d_c⁄fig_gë_öãgî64
(
n
, &
ŒvÆ
);

130 i‡(
îr
 < 0)

131  
îr
;

132 i‡(
ŒvÆ
 < 
INT_MIN
 ||ÜlvÆ > 
UINT_MAX
)

133  
	`¢d_c⁄fig_gë_ascii
(
n
, 
ªt
);

134 
lvÆ
 = 
ŒvÆ
;

136 
lvÆ
 = 0;

138 
îr
 = 
	`çlg_ni˚_vÆue_f‹m©
(
buf
, (buf), ()
lvÆ
);

139 i‡(
îr
 < 0)

140  
îr
;

141 *
ªt
 = 
	`°rdup
(
buf
);

142 i‡(*
ªt
 =
NULL
)

143  -
ENOMEM
;

145 
	}
}

147 
	$_com∑r
(c⁄° *
a
, c⁄° *
b
)

149 c⁄° 
¢d_c⁄fig_t
 *
c1
 = *(¢d_c⁄fig_à**)
a
;

150 c⁄° 
¢d_c⁄fig_t
 *
c2
 = *(¢d_c⁄fig_à**)
b
;

151 c⁄° *
id1
, *
id2
;

152 i‡(
	`¢d_c⁄fig_gë_id
(
c1
, &
id1
))  0;

153 i‡(
	`¢d_c⁄fig_gë_id
(
c2
, &
id2
))  0;

154  
	`°rcmp
(
id1
, 
id2
);

155 
	}
}

157 
¢d_c⁄fig_t
 *
	$s‹t_c⁄fig
(c⁄° *
id
, 
¢d_c⁄fig_t
 *
§c
)

159 
¢d_c⁄fig_t
 *
d°
, **
a
;

160 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

161 
ödex
, 
¨øy
, 
cou¡
;

163 i‡(
	`¢d_c⁄fig_gë_ty≥
(
§c
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

164 i‡(
	`¢d_c⁄fig_c›y
(&
d°
, 
§c
) >= 0)

165  
d°
;

166  
NULL
;

168 
cou¡
 = 0;

169 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
§c
)

170 
cou¡
++;

171 
a
 = 
	`mÆloc
((
d°
Ë* 
cou¡
);

172 i‡(
a
 =
NULL
)

173  
NULL
;

174 
¨øy
 = 
	`¢d_c⁄fig_is_¨øy
(
§c
);

175 
ödex
 = 0;

176 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
§c
) {

177 
¢d_c⁄fig_t
 *
s
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

178 
a
[
ödex
++] = 
s
;

180 i‡(
¨øy
 <= 0)

181 
	`qs‹t
(
a
, 
cou¡
, ◊[0]), 
_com∑r
);

182 i‡(
	`¢d_c⁄fig_make_compound
(&
d°
, 
id
, 
cou¡
 == 1))

183 
Àº
;

184 
ödex
 = 0; index < 
cou¡
; index++) {

185 
¢d_c⁄fig_t
 *
s
 = 
a
[
ödex
];

186 c⁄° *
id2
;

187 i‡(
	`¢d_c⁄fig_gë_id
(
s
, &
id2
)) {

188 
	`¢d_c⁄fig_dñëe
(
d°
);

189 
Àº
;

191 
s
 = 
	`s‹t_c⁄fig
(
id2
, s);

192 i‡(
s
 =
NULL
 || 
	`¢d_c⁄fig_add
(
d°
, s)) {

193 i‡(
s
)

194 
	`¢d_c⁄fig_dñëe
(
s
);

195 
	`¢d_c⁄fig_dñëe
(
d°
);

196 
Àº
;

199 
	`‰ì
(
a
);

200  
d°
;

201 
Àº
:

202 
	`‰ì
(
a
);

203  
NULL
;

204 
	}
}

206 
	$çlg_check_quŸed
(c⁄° *
p
)

208  ; *
p
 != '\0';Ö++) {

209 *
p
) {

221 i‡(*
p
 <= 31 || *p >= 127)

227 
	}
}

229 
	$çlg_ßve_quŸed
(
çlg_buf
 *
d°
, c⁄° *
°r
)

231 c⁄° 
nibbÀ
[16] = "0123456789abcdef";

232 *
p
, *
d
, *
t
;

233 
c
;

235 
d
 = 
t
 = 
	`Æloˇ
(
	`°æí
(
°r
) * 5 + 1 + 1);

236 
p
 = (*)
°r
; *p != '\0';Ö++) {

237 
c
 = *
p
;

238 
c
) {

240 *
t
++ = '\\';

241 *
t
++ = 'n';

244 *
t
++ = '\\';

245 *
t
++ = 't';

248 *
t
++ = '\\';

249 *
t
++ = 'v';

252 *
t
++ = '\\';

253 *
t
++ = 'b';

256 *
t
++ = '\\';

257 *
t
++ = 'r';

260 *
t
++ = '\\';

261 *
t
++ = 'f';

264 *
t
++ = '\\';

265 *
t
++ = 
c
;

268 i‡(
c
 >= 32 && c <= 126) {

269 *
t
++ = 
c
;

271 *
t
++ = '\\';

272 *
t
++ = 'x';

273 *
t
++ = 
nibbÀ
[(
c
 >> 4) & 0x0f];

274 *
t
++ = 
nibbÀ
[(
c
 >> 0) & 0x0f];

279 *
t
 = '\0';

280  
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "'%s'", 
d
);

281 
	}
}

283 
	$çlg_ßve_°rög
(
çlg_buf
 *
d°
, c⁄° *
°r
, 
id
)

285 c⁄° *
p
 = (c⁄° *)
°r
;

287 i‡(!
p
 || !*p)

288  
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "''");

290 i‡(!
id
 && ((*
p
 >= '0' && *p <= '9') || *p == '-'))

291  
	`çlg_ßve_quŸed
(
d°
, 
°r
);

293 i‡(
	`çlg_check_quŸed
(
p
))

294  
	`çlg_ßve_quŸed
(
d°
, 
°r
);

296  
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "%s", 
°r
);

297 
	}
}

299 
	$ßve_c⁄fig
(
çlg_buf
 *
d°
, 
Àvñ
, c⁄° *
dñim
, 
¢d_c⁄fig_t
 *
§c
)

301 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

302 
¢d_c⁄fig_t
 *
s
;

303 c⁄° *
id
;

304 *
pfx
;

305 
cou¡
;

306 
ty≥
, 
îr
, 
quŸed
, 
¨øy
;

308 i‡(
dñim
 =
NULL
)

309 
dñim
 = "";

311 
ty≥
 = 
	`¢d_c⁄fig_gë_ty≥
(
§c
);

312 i‡(
ty≥
 !
SND_CONFIG_TYPE_COMPOUND
) {

313 *
vÆ
;

314 i‡(
ty≥
 =
SND_CONFIG_TYPE_INTEGER
 ||

315 
ty≥
 =
SND_CONFIG_TYPE_INTEGER64
) {

316 
îr
 = 
	`çlg_µröt_öãgî
(
§c
, &
vÆ
);

318 
îr
 = 
	`¢d_c⁄fig_gë_ascii
(
§c
, &
vÆ
);

320 i‡(
îr
 < 0)

321  
îr
;

322 i‡(
ty≥
 =
SND_CONFIG_TYPE_STRING
) {

324 
id
 = 
	`°rchr
(
vÆ
, '\n');

325 i‡(
id
) {

326 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "\n");

327 i‡(
îr
 < 0)

328 
ªtvÆ
;

329 
id
++; *id == '\t'; id++) {

330 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "\t");

331 i‡(
îr
 < 0)

332 
ªtvÆ
;

334 
dñim
 = "";

336 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "%s'%s'\n", 
dñim
, 
vÆ
);

338 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "%s%s\n", 
dñim
, 
vÆ
);

340 
ªtvÆ
:

341 
	`‰ì
(
vÆ
);

342  
îr
;

345 
cou¡
 = 0;

346 
quŸed
 = 0;

347 
¨øy
 = 
	`¢d_c⁄fig_is_¨øy
(
§c
);

348 
s
 = 
NULL
;

349 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
§c
) {

350 
s
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

351 
îr
 = 
	`¢d_c⁄fig_gë_id
(
s
, &
id
);

352 i‡(
îr
 < 0)

353  
îr
;

354 i‡(!
quŸed
 && 
	`çlg_check_quŸed
((*)
id
))

355 
quŸed
 = 1;

356 
cou¡
++;

358 i‡(
cou¡
 == 0)

361 i‡(
cou¡
 == 1) {

362 
îr
 = 
	`¢d_c⁄fig_gë_id
(
s
, &
id
);

363 i‡(
îr
 >0 && 
Àvñ
 > 0)

364 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, ".");

365 i‡(
îr
 >= 0)

366 
îr
 = 
	`çlg_ßve_°rög
(
d°
, 
id
, 1);

367 i‡(
îr
 >= 0)

368 
îr
 = 
	`ßve_c⁄fig
(
d°
, 
Àvñ
, " ", 
s
);

369  
îr
;

372 
pfx
 = 
	`Æloˇ
(
Àvñ
 + 1);

373 
	`mem£t
(
pfx
, '\t', 
Àvñ
);

374 
pfx
[
Àvñ
] = '\0';

376 i‡(
Àvñ
 > 0) {

377 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
NULL
, "%s%s\n", 
dñim
,

378 
¨øy
 > 0 ? "[" : "{");

379 i‡(
îr
 < 0)

380  
îr
;

383 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
§c
) {

384 
s
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

385 c⁄° *
id
;

386 
îr
 = 
	`¢d_c⁄fig_gë_id
(
s
, &
id
);

387 i‡(
îr
 < 0)

388  
îr
;

389 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "");

390 i‡(
îr
 < 0)

391  
îr
;

392 i‡(
¨øy
 <= 0) {

393 
dñim
 = " ";

394 i‡(
quŸed
) {

395 
îr
 = 
	`çlg_ßve_quŸed
(
d°
, 
id
);

397 
îr
 = 
	`çlg_ßve_°rög
(
d°
, 
id
, 1);

399 i‡(
îr
 < 0)

400  
îr
;

402 
dñim
 = "";

404 
îr
 = 
	`ßve_c⁄fig
(
d°
, 
Àvñ
 + 1, 
dñim
, 
s
);

405 i‡(
îr
 < 0)

406  
îr
;

409 i‡(
Àvñ
 > 0) {

410 
pfx
[
Àvñ
 - 1] = '\0';

411 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "%s\n",

412 
¨øy
 > 0 ? "]" : "}");

413 i‡(
îr
 < 0)

414  
îr
;

418 
	}
}

420 
	$çlg_ßve
(
¢d_çlg_t
 *
çlg
, 
çlg_buf
 *
d°
,

421 
gödex
, c⁄° *
¥efix
)

423 
çlg_èbÀ
 *
çå
;

424 
çlg_ñem
 *
ñem
;

425 
li°_hód
 *
li°
, *
pos
;

426 
pfx2
[16];

427 
ödex
;

428 
îr
, 
cou¡
;

430 
	`¢¥ötf
(
pfx2
, ’fx2), "%s\t", 
¥efix
 ?: "");

433 
ödex
 = 0; index < 
çlg_èbÀ_ôems
; index++) {

434 
çå
 = &
çlg_èbÀ
[
ödex
];

435 
li°
 = (
li°_hód
 *)((*)
çlg
 + 
çå
->
loff
);

438 
cou¡
 = 0;

439 
	`li°_f‹_óch
(
pos
, 
li°
) {

440 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

441 i‡(
gödex
 >0 && 
ñem
->
ödex
 != gindex)

443 i‡(
çå
->
ßve
 =
NULL
 &&Å±r->
gßve
 == NULL) {

444 
	`SNDERR
("unableÅo create %s block (no callback)",

445 
çå
->
id
);

446 
îr
 = -
ENXIO
;

447 
_îr
;

449 i‡(
çå
->
ßve
)

450 
cou¡
++;

453 i‡(
cou¡
 == 0)

456 i‡(
cou¡
 > 1) {

457 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
¥efix
, "%s {\n",

458 
ñem
->
èbÀ
 ?

459 
ñem
->
èbÀ
->
id
 : "_NOID_");

461 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
¥efix
, "%s.",

462 
ñem
->
èbÀ
 ?

463 
ñem
->
èbÀ
->
id
 : "_NOID_");

466 i‡(
îr
 < 0)

467 
_îr
;

469 
	`li°_f‹_óch
(
pos
, 
li°
) {

470 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

471 i‡(
gödex
 >0 && 
ñem
->
ödex
 != gindex)

473 i‡(
cou¡
 > 1) {

474 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx2
, "");

475 i‡(
îr
 < 0)

476 
_îr
;

478 
îr
 = 
çå
->
	`ßve
(
çlg
, 
ñem
, 
d°
, 
cou¡
 > 1 ? 
pfx2
 : 
¥efix
);

479 i‡(
îr
 < 0) {

480 
	`SNDERR
("failedÅo save %sÉlements: %s",

481 
çå
->
id
, 
	`¢d_°ªº‹
(-
îr
));

482 
_îr
;

485 i‡(
cou¡
 > 1) {

486 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
¥efix
, "}\n");

487 i‡(
îr
 < 0)

488 
_îr
;

493 
ödex
 = 0; index < 
çlg_èbÀ_ôems
; index++) {

494 
çå
 = &
çlg_èbÀ
[
ödex
];

495 i‡(
çå
->
gßve
) {

496 
îr
 = 
çå
->
	`gßve
(
çlg
, 
gödex
, 
d°
, 
¥efix
);

497 i‡(
îr
 < 0)

498 
_îr
;

504 
_îr
:

505  
îr
;

506 
	}
}

508 
	$çlg_ödex_com∑r
(c⁄° *
a
, c⁄° *
b
)

510 c⁄° *
a1
 = 
a
, *
b1
 = 
b
;

511  *
a1
 - *
b1
;

512 
	}
}

514 
	$çlg_ödex_groups
(
¢d_çlg_t
 *
çlg
, **
ödexes
)

516 
çlg_èbÀ
 *
çå
;

517 
çlg_ñem
 *
ñem
;

518 
li°_hód
 *
li°
, *
pos
;

519 
ödex
, 
j
, 
cou¡
, 
size
;

520 *
a
, *
b
;

522 
cou¡
 = 0;

523 
size
 = 16;

524 
a
 = 
	`mÆloc
(
size
 * (a[0]));

526 
ödex
 = 0; index < 
çlg_èbÀ_ôems
; index++) {

527 
çå
 = &
çlg_èbÀ
[
ödex
];

528 
li°
 = (
li°_hód
 *)((*)
çlg
 + 
çå
->
loff
);

529 
	`li°_f‹_óch
(
pos
, 
li°
) {

530 
ñem
 = 
	`li°_íåy
(
pos
, 
çlg_ñem
, 
li°
);

531 
j
 = 0; j < 
cou¡
; j++) {

532 i‡(
a
[
j
] =
ñem
->
ödex
)

535 i‡(
j
 < 
cou¡
)

537 i‡(
cou¡
 + 1 >
size
) {

538 
size
 += 8;

539 
b
 = 
	`ªÆloc
(
a
, 
size
 * (a[0]));

540 i‡(
b
 =
NULL
) {

541 
	`‰ì
(
a
);

542  -
ENOMEM
;

544 
a
 = 
b
;

546 
a
[
cou¡
++] = 
ñem
->
ödex
;

549 
a
[
cou¡
] = -1;

551 
	`qs‹t
(
a
, 
cou¡
, ◊[0]), 
çlg_ödex_com∑r
);

553 *
ödexes
 = 
a
;

555 
	}
}

557 
	$¢d_çlg_ßve
(
¢d_çlg_t
 *
çlg
, **
d°
, 
Êags
)

559 
çlg_buf
 
buf
, 
buf2
;

560 
¢d_öput_t
 *
ö
;

561 
¢d_c⁄fig_t
 *
t›
, *
t›2
;

562 *
ödexes
, *
a
;

563 
îr
;

565 
	`as£π
(
çlg
);

566 
	`as£π
(
d°
);

567 *
d°
 = 
NULL
;

569 
	`çlg_buf_öô
(&
buf
);

571 i‡(
Êags
 & 
SND_TPLG_SAVE_GROUPS
) {

572 
îr
 = 
	`çlg_ödex_groups
(
çlg
, &
ödexes
);

573 i‡(
îr
 < 0)

574  
îr
;

575 
a
 = 
ödexes
; 
îr
 >= 0 && *a >= 0;á++) {

576 
îr
 = 
	`çlg_ßve_¥ötf
(&
buf
, 
NULL
,

578 *
a
);

579 i‡(
îr
 >= 0)

580 
îr
 = 
	`çlg_ßve
(
çlg
, &
buf
, *
a
, "\t");

581 i‡(
îr
 >= 0)

582 
îr
 = 
	`çlg_ßve_¥ötf
(&
buf
, 
NULL
, "}\n");

584 
	`‰ì
(
ödexes
);

586 
îr
 = 
	`çlg_ßve
(
çlg
, &
buf
, -1, 
NULL
);

589 i‡(
îr
 < 0)

590 
_îr
;

592 i‡(
buf
.
d°
 =
NULL
) {

593 
îr
 = -
EINVAL
;

594 
_îr
;

597 i‡(
Êags
 & 
SND_TPLG_SAVE_NOCHECK
) {

598 *
d°
 = 
	`çlg_buf_dëach
(&
buf
);

603 
îr
 = 
	`¢d_öput_buf„r_›í
(&
ö
, 
buf
.
d°
, 
	`°æí
(buf.dst));

604 i‡(
îr
 < 0) {

605 
	`SNDERR
("couldÇot create input buffer");

606 
_îr
;

609 
îr
 = 
	`¢d_c⁄fig_t›
(&
t›
);

610 i‡(
îr
 < 0) {

611 
	`¢d_öput_˛o£
(
ö
);

612 
_îr
;

615 
îr
 = 
	`¢d_c⁄fig_lﬂd
(
t›
, 
ö
);

616 
	`¢d_öput_˛o£
(
ö
);

617 i‡(
îr
 < 0) {

618 
	`SNDERR
("couldÇotÜoad configuration");

619 
	`¢d_c⁄fig_dñëe
(
t›
);

620 
_îr
;

623 i‡(
Êags
 & 
SND_TPLG_SAVE_SORT
) {

624 
t›2
 = 
	`s‹t_c⁄fig
(
NULL
, 
t›
);

625 i‡(
t›2
 =
NULL
) {

626 
	`SNDERR
("couldÇot sort configuration");

627 
	`¢d_c⁄fig_dñëe
(
t›
);

628 
îr
 = -
EINVAL
;

629 
_îr
;

631 
	`¢d_c⁄fig_dñëe
(
t›
);

632 
t›
 = 
t›2
;

635 
	`çlg_buf_öô
(&
buf2
);

636 
îr
 = 
	`ßve_c⁄fig
(&
buf2
, 0, 
NULL
, 
t›
);

637 
	`¢d_c⁄fig_dñëe
(
t›
);

638 i‡(
îr
 < 0) {

639 
	`SNDERR
("couldÇot save configuration");

640 
_îr
;

643 
	`çlg_buf_‰ì
(&
buf
);

644 *
d°
 = 
	`çlg_buf_dëach
(&
buf2
);

647 
_îr
:

648 
	`çlg_buf_‰ì
(&
buf
);

649 *
d°
 = 
NULL
;

650  
îr
;

651 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/text.c

21 
	~"çlg_loˇl.h
"

23 
	#TEXT_SIZE_MAX
 \

24 (
SND_SOC_TPLG_NUM_TEXTS
 * 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
)

	)

26 
	$∑r£_ãxt_vÆues
(
¢d_c⁄fig_t
 *
cfg
, 
çlg_ñem
 *
ñem
)

28 
çlg_ãxts
 *
ãxts
 = 
ñem
->texts;

29 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

30 
¢d_c⁄fig_t
 *
n
;

31 c⁄° *
vÆue
 = 
NULL
;

32 
j
 = 0;

34 
	`çlg_dbg
(" TexàVÆues: %s", 
ñem
->
id
);

36 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

37 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

39 i‡(
j
 =
SND_SOC_TPLG_NUM_TEXTS
) {

40 
	`çlg_dbg
("ãxà°rögÇumbîÉx˚ed†%d", 
j
);

41  -
ENOMEM
;

45 i‡(
	`¢d_c⁄fig_gë_°rög
(
n
, &
vÆue
) < 0)

48 
	`¢d_°æ˝y
(&
ãxts
->
ôems
[
j
][0], 
vÆue
,

49 
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
);

50 
	`çlg_dbg
("\t%s", &
ãxts
->
ôems
[
j
][0]);

52 
j
++;

55 
ãxts
->
num_ôems
 = 
j
;

57 
	}
}

60 
	$çlg_∑r£_ãxt
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

61 *
¥iv©e
 
ATTRIBUTE_UNUSED
)

63 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

64 
¢d_c⁄fig_t
 *
n
;

65 c⁄° *
id
;

66 
îr
 = 0;

67 
çlg_ñem
 *
ñem
;

69 
ñem
 = 
	`çlg_ñem_√w_comm⁄
(
çlg
, 
cfg
, 
NULL
, 
SND_TPLG_TYPE_TEXT
);

70 i‡(!
ñem
)

71  -
ENOMEM
;

73 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

75 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

76 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

79 i‡(
	`°rcmp
(
id
, "values") == 0) {

80 
îr
 = 
	`∑r£_ãxt_vÆues
(
n
, 
ñem
);

81 i‡(
îr
 < 0) {

82 
	`SNDERR
("error: failedÅoÖarseÅext values");

83  
îr
;

89  
îr
;

90 
	}
}

93 
	$çlg_ßve_ãxt
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

94 
çlg_ñem
 *
ñem
,

95 
çlg_buf
 *
d°
, c⁄° *
pfx
)

97 
çlg_ãxts
 *
ãxts
 = 
ñem
->texts;

98 
i
;

99 
îr
;

101 i‡(!
ãxts
 ||Åexts->
num_ôems
 == 0)

103 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "'%s'.vÆue†[\n", 
ñem
->
id
);

104 
i
 = 0; 
îr
 >0 && i < 
ãxts
->
num_ôems
; i++)

105 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "\t'%s'\n", 
ãxts
->
ôems
[
i
]);

106 i‡(
îr
 >= 0)

107 
îr
 = 
	`çlg_ßve_¥ötf
(
d°
, 
pfx
, "]\n");

108  
îr
;

109 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/tplg_local.h

13 
	~"loˇl.h
"

15 
	~<limôs.h
>

16 
	~<°döt.h
>

17 
	~<°dboﬁ.h
>

19 
	~"li°.h
"

20 
	~"bsw≠.h
"

21 
	~"t›ﬁogy.h
"

23 
	~<sound/ty≥_com∑t.h
>

24 
	~<sound/asound.h
>

25 
	~<sound/asoc.h
>

26 
	~<sound/év.h
>

28 #ifde‡
TPLG_DEBUG


29 
	#çlg_dbg
 
SNDERR


	)

31 
	#çlg_dbg
(
fmt
, 
¨g
...Ëdÿ{ } 0)

	)

34 
	#TPLG_MAX_PRIV_SIZE
 (1024 * 128)

	)

37 
	#ALSA_CONFIG_TPLG_VAR
 "ALSA_CONFIG_TPLG"

	)

39 
	gçlg_ªf
;

40 
	gçlg_ñem
;

41 
	gçlg_èbÀ
;

43 
	e_¢d_pcm_øãs
 {

44 
	mSND_PCM_RATE_UNKNOWN
 = -1,

45 
	mSND_PCM_RATE_5512
 = 0,

46 
	mSND_PCM_RATE_8000
,

47 
	mSND_PCM_RATE_11025
,

48 
	mSND_PCM_RATE_16000
,

49 
	mSND_PCM_RATE_22050
,

50 
	mSND_PCM_RATE_32000
,

51 
	mSND_PCM_RATE_44100
,

52 
	mSND_PCM_RATE_48000
,

53 
	mSND_PCM_RATE_64000
,

54 
	mSND_PCM_RATE_88200
,

55 
	mSND_PCM_RATE_96000
,

56 
	mSND_PCM_RATE_176400
,

57 
	mSND_PCM_RATE_192000
,

58 
	mSND_PCM_RATE_CONTINUOUS
 = 30,

59 
	mSND_PCM_RATE_KNOT
 = 31,

60 
	mSND_PCM_RATE_LAST
 = 
SND_PCM_RATE_KNOT
,

61 } 
	t¢d_pcm_øãs_t
;

63 
	s¢d_çlg
 {

65 *
	mbö
;

66 
size_t
 
	mbö_pos
;

67 
size_t
 
	mbö_size
;

69 
	mvîbo£
;

70 
	md≠m_s‹t
: 1;

71 
	mvîsi⁄
;

74 
size_t
 
	m√xt_hdr_pos
;

75 
	mödex
;

76 
	mch™√l_idx
;

79 
¢d_soc_çlg_m™i„°
 
	mm™i„°
;

80 *
	mm™i„°_pd©a
;

83 
li°_hód
 
	mév_li°
;

84 
li°_hód
 
	mwidgë_li°
;

85 
li°_hód
 
	mpcm_li°
;

86 
li°_hód
 
	mdai_li°
;

87 
li°_hód
 
	mbe_li°
;

88 
li°_hód
 
	mcc_li°
;

89 
li°_hód
 
	mrouã_li°
;

90 
li°_hód
 
	mãxt_li°
;

91 
li°_hód
 
	mpd©a_li°
;

92 
li°_hód
 
	mtokí_li°
;

93 
li°_hód
 
	mtu∂e_li°
;

94 
li°_hód
 
	mm™i„°_li°
;

95 
li°_hód
 
	mpcm_c⁄fig_li°
;

96 
li°_hód
 
	mpcm_ˇps_li°
;

97 
li°_hód
 
	mhw_cfg_li°
;

100 
li°_hód
 
	mmixî_li°
;

101 
li°_hód
 
	míum_li°
;

102 
li°_hód
 
	mbyãs_ext_li°
;

106 
	sçlg_ªf
 {

107 
	mty≥
;

108 
çlg_ñem
 *
	mñem
;

109 
	mid
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

110 
li°_hód
 
	mli°
;

113 
	sçlg_ãxts
 {

114 
	mnum_ôems
;

115 
	môems
[
SND_SOC_TPLG_NUM_TEXTS
][
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

119 
	sçlg_tokí
 {

120 
	mid
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

121 
	mvÆue
;

124 
	sçlg_víd‹_tokís
 {

125 
	mnum_tokís
;

126 
çlg_tokí
 
	mtokí
[0];

130 
	sçlg_tu∂e
 {

131 
	mtokí
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

133 
	m°rög
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

134 
	muuid
[16];

135 
	mvÆue
;

139 
	sçlg_tu∂e_£t
 {

140 
	mty≥
;

141 
	mnum_tu∂es
;

142 
çlg_tu∂e
 
	mtu∂e
[0];

145 
	sçlg_víd‹_tu∂es
 {

146 
	mnum_£ts
;

147 
	mÆloc_£ts
;

148 
çlg_tu∂e_£t
 **
	m£t
;

152 
	sçlg_ñem
 {

154 
çlg_èbÀ
 *
	mèbÀ
;

156 
	mid
[
SNDRV_CTL_ELEM_ID_NAME_MAXLEN
];

158 
	mödex
;

159 
¢d_çlg_ty≥
 
	mty≥
;

161 
	msize
;

162 
	mcompound_ñem
;

163 
	mvíd‹_ty≥
;

167 *
	mobj
;

168 
¢d_soc_çlg_mixî_c⁄åﬁ
 *
	mmixî_˘æ
;

169 
¢d_soc_çlg_íum_c⁄åﬁ
 *
	míum_˘æ
;

170 
¢d_soc_çlg_byãs_c⁄åﬁ
 *
	mbyãs_ext
;

171 
¢d_soc_çlg_d≠m_widgë
 *
	mwidgë
;

172 
¢d_soc_çlg_pcm
 *
	mpcm
;

173 
¢d_soc_çlg_dai
 *
	mdai
;

174 
¢d_soc_çlg_lök_c⁄fig
 *
	mlök
;

175 
¢d_soc_çlg_d≠m_gøph_ñem
 *
	mrouã
;

176 
¢d_soc_çlg_°ªam
 *
	m°ªam_cfg
;

177 
¢d_soc_çlg_°ªam_ˇps
 *
	m°ªam_ˇps
;

178 
¢d_soc_çlg_hw_c⁄fig
 *
	mhw_cfg
;

181 
¢d_soc_çlg_˘l_év
 *
	mév
;

182 
çlg_ãxts
 *
	mãxts
;

183 
¢d_soc_çlg_¥iv©e
 *
	md©a
;

184 
çlg_víd‹_tokís
 *
	mtokís
;

185 
çlg_víd‹_tu∂es
 *
	mtu∂es
;

186 
¢d_soc_çlg_m™i„°
 *
	mm™i„°
;

194 
li°_hód
 
	mªf_li°
;

195 
li°_hód
 
	mli°
;

197 (*
	m‰ì
)(*
	mobj
);

200 
	sm≠_ñem
 {

201 c⁄° *
	m«me
;

202 
	mid
;

206 
	sçlg_buf
 {

207 *
	md°
;

208 
size_t
 
	md°_Àn
;

209 *
	m¥ötf_buf
;

210 
size_t
 
	m¥ötf_buf_size
;

214 
	sçlg_èbÀ
 {

215 c⁄° *
	m«me
;

216 c⁄° *
	mid
;

217 c⁄° *
	mid2
;

218 
off_t
 
	mloff
;

219 
size_t
 
	msize
;

220 
	mty≥
;

221 
	mtsoc
;

222 
	mbuûd
: 1;

223 
	míew
: 1;

224 (*
	m‰ì
)(*);

225 (*
	m∑r£
)(
¢d_çlg_t
 *
	mçlg
, 
¢d_c⁄fig_t
 *
	mcfg
, *
	m¥iv
);

226 (*
	mßve
)(
¢d_çlg_t
 *
	mçlg
, 
çlg_ñem
 *
	mñem
,

227 
çlg_buf
 *
	md°
, c⁄° *
	m¥efix
);

228 (*
	mgßve
)(
¢d_çlg_t
 *
	mçlg
, 
	mödex
,

229 
çlg_buf
 *
	md°
, c⁄° *
	m¥efix
);

230 (*
	mdecod
)(
¢d_çlg_t
 *
	mçlg
, 
size_t
 
	mpos
,

231 
¢d_soc_çlg_hdr
 *
	mhdr
,

232 *
	mbö
, 
size_t
 
	msize
);

235 
çlg_èbÀ
Åplg_table[];

236 
çlg_èbÀ_ôems
;

238 #i‡
__SIZEOF_INT__
 == 4

239 
ölöe
 
	$u«lig√d_gë32
(*
§c
)

241 
ªt
;

242 
	`mem˝y
(&
ªt
, 
§c
, (ret));

243 #i‡
__BYTE_ORDER__
 =
__ORDER_BIG_ENDIAN__


244 
ªt
 = 
	`bsw≠_32
(ret);

246  
ªt
;

247 
	}
}

248 
ölöe
 
	$u«lig√d_put32
(*
d°
, 
vÆ
)

250 #i‡
__BYTE_ORDER__
 =
__ORDER_BIG_ENDIAN__


251 
vÆ
 = 
	`bsw≠_32
(val);

253 
	`mem˝y
(
d°
, &
vÆ
, (val));

254 
	}
}

257 
	#çlg_log
(
çlg
, 
ty≥
, 
pos
, 
fmt
, 
¨gs
...) do { \

258 i‡((
çlg
)->
vîbo£
) \

259 
	`çlg_log_
((
çlg
), (
ty≥
), (
pos
), (
fmt
), ##
¨gs
); \

260 } 0)

	)

262 
çlg_log_
(
¢d_çlg_t
 *
çlg
, 
ty≥
, 
size_t
 
pos
, c⁄° *
fmt
, ...);

264 *
çlg_ˇŒoc
(
li°_hód
 *
hóp
, 
size_t
 
size
);

265 
çlg_‰ì
(
li°_hód
 *
hóp
);

267 
çlg_gë_ty≥
(
asoc_ty≥
);

269 
çlg_∑r£_compound
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
,

270 (*
f˙
)(
¢d_çlg_t
 *, 
¢d_c⁄fig_t
 *, *),

271 *
¥iv©e
);

273 
	`çlg_wrôe_d©a
(
¢d_çlg_t
 *
çlg
);

275 
	`çlg_∑r£_év
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

276 
	`çlg_∑r£_ãxt
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

277 
	`çlg_∑r£_d©a
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

278 
	`çlg_∑r£_tokís
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

279 
	`çlg_∑r£_tu∂es
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

280 
	`çlg_∑r£_m™i„°_d©a
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

281 
	`çlg_∑r£_c⁄åﬁ_byãs
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

282 
	`çlg_∑r£_c⁄åﬁ_íum
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

283 
	`çlg_∑r£_c⁄åﬁ_mixî
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

284 
	`çlg_∑r£_d≠m_gøph
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

285 
	`çlg_∑r£_d≠m_widgë
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

286 
	`çlg_∑r£_°ªam_ˇps
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

287 
	`çlg_∑r£_pcm
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

288 
	`çlg_∑r£_dai
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

289 
	`çlg_∑r£_lök
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

290 
	`çlg_∑r£_cc
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

291 
	`çlg_∑r£_hw_c⁄fig
(
¢d_çlg_t
 *
çlg
, 
¢d_c⁄fig_t
 *
cfg
, *
¥iv
);

293 
	`çlg_gë_tu∂e_size
(
ty≥
);

294 
	`çlg_‰ì_tu∂es
(*
obj
);

296 
	`çlg_buûd_d©a
(
¢d_çlg_t
 *
çlg
);

297 
	`çlg_buûd_m™i„°_d©a
(
¢d_çlg_t
 *
çlg
);

298 
	`çlg_buûd_c⁄åﬁs
(
¢d_çlg_t
 *
çlg
);

299 
	`çlg_buûd_widgës
(
¢d_çlg_t
 *
çlg
);

300 
	`çlg_buûd_rouãs
(
¢d_çlg_t
 *
çlg
);

301 
	`çlg_buûd_pcm_dai
(
¢d_çlg_t
 *
çlg
, 
ty≥
);

303 
	`çlg_c›y_d©a
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

304 
çlg_ªf
 *
ªf
);

306 
	`çlg_∑r£_ªfs
(
¢d_c⁄fig_t
 *
cfg
, 
çlg_ñem
 *
ñem
,

307 
ty≥
);

309 
	`çlg_ªf_add
(
çlg_ñem
 *
ñem
, 
ty≥
, c⁄° * 
id
);

310 
	`çlg_ªf_add_ñem
(
çlg_ñem
 *
ñem
, çlg_ñem *
ñem_ªf
);

312 
çlg_ñem
 *
	`çlg_ñem_√w
();

313 
	`çlg_ñem_‰ì
(
çlg_ñem
 *
ñem
);

314 
	`çlg_ñem_‰ì_li°
(
li°_hód
 *
ba£
);

315 
	`çlg_ñem_ö£π
(
çlg_ñem
 *
ñem_p
, 
li°_hód
 *
li°
);

316 
çlg_ñem
 *
	`çlg_ñem_lookup
(
li°_hód
 *
ba£
,

317 c⁄° * 
id
,

318 
ty≥
,

319 
ödex
);

320 
çlg_ñem
 *
	`çlg_ñem_ty≥_lookup
(
¢d_çlg_t
 *
çlg
,

321 
¢d_çlg_ty≥
 
ty≥
);

322 
çlg_ñem
* 
	`çlg_ñem_√w_comm⁄
(
¢d_çlg_t
 *
çlg
,

323 
¢d_c⁄fig_t
 *
cfg
, c⁄° *
«me
, 
¢d_çlg_ty≥
 
ty≥
);

325 
	`çlg_gë_öãgî
(
¢d_c⁄fig_t
 *
n
, *
vÆ
, 
ba£
);

326 
	`çlg_gë_unsig√d
(
¢d_c⁄fig_t
 *
n
, *
vÆ
, 
ba£
);

328 c⁄° *
	`çlg_ch™√l_«me
(
ty≥
);

329 
	`çlg_∑r£_ch™√l
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

330 
¢d_c⁄fig_t
 *
cfg
, *
¥iv©e
);

332 c⁄° *
	`çlg_›s_«me
(
ty≥
);

333 
	`çlg_∑r£_›s
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

334 
¢d_c⁄fig_t
 *
cfg
, *
¥iv©e
);

335 
	`çlg_∑r£_ext_›s
(
¢d_çlg_t
 *
çlg
 
ATTRIBUTE_UNUSED
,

336 
¢d_c⁄fig_t
 *
cfg
, *
¥iv©e
);

338 
çlg_ñem
 *
	`lookup_pcm_dai_°ªam
(
li°_hód
 *
ba£
,

339 c⁄° * 
id
);

341 
	`çlg_add_d©a
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
∑ª¡
,

342 c⁄° *
bö
, 
size_t
 
size
);

343 
	`çlg_add_d©a_byãs
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
∑ª¡
,

344 c⁄° *
suffix
, c⁄° *
bö
, 
size_t
 
size
);

345 
	`çlg_add_mixî_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
);

346 
	`çlg_add_íum_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
);

347 
	`çlg_add_byãs_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
);

348 
	`çlg_add_widgë_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
);

349 
	`çlg_add_gøph_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
);

351 
	`çlg_add_mixî
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_mixî_ãm∂©e
 *
mixî
,

352 
çlg_ñem
 **
e
);

353 
	`çlg_add_íum
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_íum_ãm∂©e
 *
íum_˘l
,

354 
çlg_ñem
 **
e
);

355 
	`çlg_add_byãs
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_byãs_ãm∂©e
 *
byãs_˘l
,

356 
çlg_ñem
 **
e
);

358 
	`çlg_buûd_pcms
(
¢d_çlg_t
 *
çlg
, 
ty≥
);

359 
	`çlg_buûd_dais
(
¢d_çlg_t
 *
çlg
, 
ty≥
);

360 
	`çlg_buûd_löks
(
¢d_çlg_t
 *
çlg
, 
ty≥
);

361 
	`çlg_add_lök_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
);

362 
	`çlg_add_pcm_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
);

363 
	`çlg_add_dai_obje˘
(
¢d_çlg_t
 *
çlg
, 
¢d_çlg_obj_ãm∂©e_t
 *
t
);

365 
	`çlg_ni˚_vÆue_f‹m©
(*
d°
, 
size_t
 
d°_size
, 
vÆue
);

367 
	`çlg_ßve_¥ötf
(
çlg_buf
 *
d°
, c⁄° *
¥efix
, c⁄° *
fmt
, ...);

368 
	`çlg_ßve_ªfs
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
, 
ty≥
,

369 c⁄° *
id
, 
çlg_buf
 *
d°
, c⁄° *
pfx
);

370 
	`çlg_ßve_ch™√ls
(
¢d_çlg_t
 *
çlg
, 
¢d_soc_çlg_ch™√l
 *
ch™√l
,

371 
ch™√l_cou¡
, 
çlg_buf
 *
d°
, c⁄° *
pfx
);

372 
	`çlg_ßve_›s
(
¢d_çlg_t
 *
çlg
, 
¢d_soc_çlg_˘l_hdr
 *
hdr
,

373 
çlg_buf
 *
d°
, c⁄° *
pfx
);

374 
	`çlg_ßve_ext_›s
(
¢d_çlg_t
 *
çlg
, 
¢d_soc_çlg_byãs_c⁄åﬁ
 *
be
,

375 
çlg_buf
 *
d°
, c⁄° *
pfx
);

376 
	`çlg_ßve_m™i„°_d©a
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

377 
çlg_buf
 *
d°
, c⁄° *
pfx
);

378 
	`çlg_ßve_c⁄åﬁ_mixî
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

379 
çlg_buf
 *
d°
, c⁄° *
pfx
);

380 
	`çlg_ßve_c⁄åﬁ_íum
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

381 
çlg_buf
 *
d°
, c⁄° *
pfx
);

382 
	`çlg_ßve_c⁄åﬁ_byãs
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

383 
çlg_buf
 *
d°
, c⁄° *
pfx
);

384 
	`çlg_ßve_év
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

385 
çlg_buf
 *
d°
, c⁄° *
pfx
);

386 
	`çlg_ßve_d©a
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

387 
çlg_buf
 *
d°
, c⁄° *
pfx
);

388 
	`çlg_ßve_ãxt
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

389 
çlg_buf
 *
d°
, c⁄° *
pfx
);

390 
	`çlg_ßve_tokís
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

391 
çlg_buf
 *
d°
, c⁄° *
pfx
);

392 
	`çlg_ßve_tu∂es
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

393 
çlg_buf
 *
d°
, c⁄° *
pfx
);

394 
	`çlg_ßve_d≠m_gøph
(
¢d_çlg_t
 *
çlg
, 
ödex
,

395 
çlg_buf
 *
d°
, c⁄° *
pfx
);

396 
	`çlg_ßve_d≠m_widgë
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

397 
çlg_buf
 *
d°
, c⁄° *
pfx
);

398 
	`çlg_ßve_lök
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

399 
çlg_buf
 *
d°
, c⁄° *
pfx
);

400 
	`çlg_ßve_cc
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

401 
çlg_buf
 *
d°
, c⁄° *
pfx
);

402 
	`çlg_ßve_pcm
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

403 
çlg_buf
 *
d°
, c⁄° *
pfx
);

404 
	`çlg_ßve_hw_c⁄fig
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

405 
çlg_buf
 *
d°
, c⁄° *
pfx
);

406 
	`çlg_ßve_°ªam_ˇps
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

407 
çlg_buf
 *
d°
, c⁄° *
pfx
);

408 
	`çlg_ßve_dai
(
¢d_çlg_t
 *
çlg
, 
çlg_ñem
 *
ñem
,

409 
çlg_buf
 *
d°
, c⁄° *
pfx
);

411 
	`çlg_decode_ãm∂©e
(
¢d_çlg_t
 *
çlg
,

412 
size_t
 
pos
,

413 
¢d_soc_çlg_hdr
 *
hdr
,

414 
¢d_çlg_obj_ãm∂©e_t
 *
t
);

415 
	`çlg_decode_m™i„°_d©a
(
¢d_çlg_t
 *
çlg
, 
size_t
 
pos
,

416 
¢d_soc_çlg_hdr
 *
hdr
,

417 *
bö
, 
size_t
 
size
);

418 
	`çlg_decode_c⁄åﬁ_mixî1
(
¢d_çlg_t
 *
çlg
,

419 
li°_hód
 *
hóp
,

420 
¢d_çlg_mixî_ãm∂©e
 *
mt
,

421 
size_t
 
pos
,

422 *
bö
, 
size_t
 
size
);

423 
	`çlg_decode_c⁄åﬁ_mixî
(
¢d_çlg_t
 *
çlg
, 
size_t
 
pos
,

424 
¢d_soc_çlg_hdr
 *
hdr
,

425 *
bö
, 
size_t
 
size
);

426 
	`çlg_decode_c⁄åﬁ_íum1
(
¢d_çlg_t
 *
çlg
,

427 
li°_hód
 *
hóp
,

428 
¢d_çlg_íum_ãm∂©e
 *
ë
,

429 
size_t
 
pos
,

430 
¢d_soc_çlg_íum_c⁄åﬁ
 *
ec
);

431 
	`çlg_decode_c⁄åﬁ_íum
(
¢d_çlg_t
 *
çlg
, 
size_t
 
pos
,

432 
¢d_soc_çlg_hdr
 *
hdr
,

433 *
bö
, 
size_t
 
size
);

434 
	`çlg_decode_c⁄åﬁ_byãs1
(
¢d_çlg_t
 *
çlg
,

435 
¢d_çlg_byãs_ãm∂©e
 *
bt
,

436 
size_t
 
pos
,

437 *
bö
, 
size_t
 
size
);

438 
	`çlg_decode_c⁄åﬁ_byãs
(
¢d_çlg_t
 *
çlg
, 
size_t
 
pos
,

439 
¢d_soc_çlg_hdr
 *
hdr
,

440 *
bö
, 
size_t
 
size
);

441 
	`çlg_decode_d©a
(
¢d_çlg_t
 *
çlg
, 
size_t
 
pos
,

442 
¢d_soc_çlg_hdr
 *
hdr
,

443 *
bö
, 
size_t
 
size
);

444 
	`çlg_decode_d≠m_gøph
(
¢d_çlg_t
 *
çlg
, 
size_t
 
pos
,

445 
¢d_soc_çlg_hdr
 *
hdr
,

446 *
bö
, 
size_t
 
size
);

447 
	`çlg_decode_d≠m_widgë
(
¢d_çlg_t
 *
çlg
, 
size_t
 
pos
,

448 
¢d_soc_çlg_hdr
 *
hdr
,

449 *
bö
, 
size_t
 
size
);

450 
	`çlg_decode_lök
(
¢d_çlg_t
 *
çlg
, 
size_t
 
pos
,

451 
¢d_soc_çlg_hdr
 *
hdr
,

452 *
bö
, 
size_t
 
size
);

453 
	`çlg_decode_cc
(
¢d_çlg_t
 *
çlg
, 
size_t
 
pos
,

454 
¢d_soc_çlg_hdr
 *
hdr
,

455 *
bö
, 
size_t
 
size
);

456 
	`çlg_decode_pcm
(
¢d_çlg_t
 *
çlg
, 
size_t
 
pos
,

457 
¢d_soc_çlg_hdr
 *
hdr
,

458 *
bö
, 
size_t
 
size
);

459 
	`çlg_decode_dai
(
¢d_çlg_t
 *
çlg
, 
size_t
 
pos
,

460 
¢d_soc_çlg_hdr
 *
hdr
,

461 *
bö
, 
size_t
 
size
);

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/main.c

33 
	~"ucm_loˇl.h
"

34 
	~"../c⁄åﬁ/c⁄åﬁ_loˇl.h
"

35 
	~<°dboﬁ.h
>

36 
	~<˘y≥.h
>

37 
	~<°d¨g.h
>

38 
	~<±hªad.h
>

39 
	~<sys/°©.h
>

40 
	~<sys/waô.h
>

41 
	~<limôs.h
>

47 
gë_vÆue
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

48 c⁄° *
idítifõr
,

49 **
vÆue
,

50 c⁄° *
mod_dev_«me
,

51 c⁄° *
vîb_«me
,

52 
exa˘
);

53 
gë_vÆue1
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, **
vÆue
,

54 
li°_hód
 *
vÆue_li°
, c⁄° *
idítifõr
);

55 
gë_vÆue3
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

56 **
vÆue
,

57 c⁄° *
idítifõr
,

58 
li°_hód
 *
vÆue_li°1
,

59 
li°_hód
 *
vÆue_li°2
,

60 
li°_hód
 *
vÆue_li°3
);

62 
execuã_£quí˚
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

63 
u£_ˇ£_vîb
 *
vîb
,

64 
li°_hód
 *
£q
,

65 
li°_hód
 *
vÆue_li°1
,

66 
li°_hód
 *
vÆue_li°2
,

67 
li°_hód
 *
vÆue_li°3
);

69 
execuã_comp⁄ít_£q
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

70 
comp⁄ít_£quí˚
 *
cm±_£q
,

71 
li°_hód
 *
vÆue_li°1
,

72 
li°_hód
 *
vÆue_li°2
,

73 
li°_hód
 *
vÆue_li°3
,

74 *
cdev
);

76 
ölöe
 
u£_ˇ£_devi˚
 *

77 
föd_devi˚
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
u£_ˇ£_vîb
 *
vîb
,

78 c⁄° *
devi˚_«me
, 
check_suµ‹ãd
);

80 
	$check_idítifõr
(c⁄° *
idítifõr
, c⁄° *
¥efix
)

82 
Àn
;

84 
Àn
 = 
	`°æí
(
¥efix
);

85 i‡(
	`°∫cmp
(
idítifõr
, 
¥efix
, 
Àn
) != 0)

88 i‡(
idítifõr
[
Àn
] == 0 || identifier[len] == '/')

92 
	}
}

94 
	$li°_cou¡
(
li°_hód
 *
li°
)

96 
li°_hód
 *
pos
;

97 
cou¡
 = 0;

99 
	`li°_f‹_óch
(
pos
, 
li°
) {

100 
cou¡
 += 1;

102  
cou¡
;

103 
	}
}

105 
	$Æloc_°r_li°
(
li°_hód
 *
li°
, 
mu…
, **
ªsu…
[])

107 **
ªs
;

108 
˙t
;

110 
˙t
 = 
	`li°_cou¡
(
li°
Ë* 
mu…
;

111 i‡(
˙t
 == 0) {

112 *
ªsu…
 = 
NULL
;

113  
˙t
;

115 
ªs
 = 
	`ˇŒoc
(
mu…
, 
˙t
 * (*));

116 i‡(
ªs
 =
NULL
)

117  -
ENOMEM
;

118 *
ªsu…
 = 
ªs
;

119  
˙t
;

120 
	}
}

128 *
	$¢d_u£_ˇ£_idítifõr
(c⁄° *
fmt
, ...)

130 *
°r
, *
ªs
;

131 
size
 = 
	`°æí
(
fmt
) + 512;

132 
va_li°
 
¨gs
;

134 
°r
 = 
	`mÆloc
(
size
);

135 i‡(
°r
 =
NULL
)

136  
NULL
;

137 
	`va_°¨t
(
¨gs
, 
fmt
);

138 
	`v¢¥ötf
(
°r
, 
size
, 
fmt
, 
¨gs
);

139 
	`va_íd
(
¨gs
);

140 
°r
[
size
-1] = '\0';

141 
ªs
 = 
	`ªÆloc
(
°r
, 
	`°æí
(str) + 1);

142 i‡(
ªs
)

143  
ªs
;

144  
°r
;

145 
	}
}

153 
	$¢d_u£_ˇ£_‰ì_li°
(c⁄° *
li°
[], 
ôems
)

155 
i
;

156 i‡(
li°
 =
NULL
)

158 
i
 = 0; i < 
ôems
; i++)

159 
	`‰ì
((*)
li°
[
i
]);

160 
	`‰ì
(
li°
);

162 
	}
}

164 
	$ªad_év_fûe
(**
ªs
,

165 c⁄° *
fûï©h
)

167 
îr
 = 0;

168 
fd
;

169 
°©64
 
°
;

170 
size_t
 
sz
;

171 
ssize_t
 
sz_ªad
;

172 
¢d_˘l_év
 *
év
;

174 
fd
 = 
	`›í
(
fûï©h
, 
O_RDONLY
);

175 i‡(
fd
 < 0) {

176 
îr
 = -
î∫o
;

177  
îr
;

179 i‡(
	`f°©64
(
fd
, &
°
) == -1) {

180 
îr
 = -
î∫o
;

181 
__Áû
;

183 
sz
 = 
°
.
°_size
;

184 i‡(
sz
 > 16 * 1024 * 1024 || sz < 8 || sz % 4) {

185 
	`uc_îr‹
("File size should beÜessÅhan 16 MB "

187 
îr
 = -
EINVAL
;

188 
__Áû
;

190 *
ªs
 = 
	`mÆloc
(
sz
);

191 i‡(
ªs
 =
NULL
) {

192 
îr
 = -
ENOMEM
;

193 
__Áû
;

195 
sz_ªad
 = 
	`ªad
(
fd
, *
ªs
, 
sz
);

196 i‡(
sz_ªad
 < 0 || (
size_t
)sz_ªad !
sz
) {

197 
îr
 = -
EIO
;

198 
	`‰ì
(*
ªs
);

199 *
ªs
 = 
NULL
;

202 
év
 = (
¢d_˘l_év
 *)(*
ªs
);

203 i‡(
év
->
Àngth
 + 2 * (Ë!
sz
) {

204 
	`uc_îr‹
("InvÆidÅlv size: %d", 
év
->
Àngth
);

205 
îr
 = -
EINVAL
;

206 
	`‰ì
(*
ªs
);

207 *
ªs
 = 
NULL
;

210 
__Áû
:

211 
	`˛o£
(
fd
);

212  
îr
;

213 
	}
}

215 
	$bö¨y_fûe_∑r£
(
¢d_˘l_ñem_vÆue_t
 *
d°
,

216 
¢d_˘l_ñem_öfo_t
 *
öfo
,

217 c⁄° *
fûï©h
)

219 
îr
 = 0;

220 
fd
;

221 
°©64
 
°
;

222 
size_t
 
sz
;

223 
ssize_t
 
sz_ªad
;

224 *
ªs
;

225 
¢d_˘l_ñem_ty≥_t
 
ty≥
;

226 
idx
, 
cou¡
;

228 
ty≥
 = 
	`¢d_˘l_ñem_öfo_gë_ty≥
(
öfo
);

229 i‡(
ty≥
 !
SND_CTL_ELEM_TYPE_BYTES
) {

230 
	`uc_îr‹
("only support byteÅype!");

231 
îr
 = -
EINVAL
;

232  
îr
;

234 
fd
 = 
	`›í
(
fûï©h
, 
O_RDONLY
);

235 i‡(
fd
 < 0) {

236 
îr
 = -
î∫o
;

237  
îr
;

239 i‡(
	`°©64
(
fûï©h
, &
°
) == -1) {

240 
îr
 = -
î∫o
;

241 
__Áû
;

243 
sz
 = 
°
.
°_size
;

244 
cou¡
 = 
	`¢d_˘l_ñem_öfo_gë_cou¡
(
öfo
);

245 i‡(
sz
 !
cou¡
 || sz > (
d°
->
vÆue
.
byãs
)) {

246 
	`uc_îr‹
("övÆidÖ¨amëî sizê%d!", 
sz
);

247 
îr
 = -
EINVAL
;

248 
__Áû
;

250 
ªs
 = 
	`mÆloc
(
sz
);

251 i‡(
ªs
 =
NULL
) {

252 
îr
 = -
ENOMEM
;

253 
__Áû
;

255 
sz_ªad
 = 
	`ªad
(
fd
, 
ªs
, 
sz
);

256 i‡(
sz_ªad
 < 0 || (
size_t
)sz_ªad !
sz
) {

257 
îr
 = -
î∫o
;

258 
__Áû_ªad
;

260 
idx
 = 0; idx < 
sz
; idx++)

261 
	`¢d_˘l_ñem_vÆue_£t_byã
(
d°
, 
idx
, *(
ªs
 + idx));

262 
__Áû_ªad
:

263 
	`‰ì
(
ªs
);

264 
__Áû
:

265 
	`˛o£
(
fd
);

266  
îr
;

267 
	}
}

269 c⁄° *
	$∑r£_ty≥
(c⁄° *
p
, c⁄° *
¥efix
, 
size_t
 
Àn
,

270 
¢d_˘l_ñem_öfo_t
 *
öfo
)

272 i‡(
	`°∫ˇ£cmp
(
p
, 
¥efix
, 
Àn
))

273  
p
;

274 
p
 +
Àn
;

275 i‡(
öfo
->
ty≥
 !
SND_CTL_ELEM_TYPE_NONE
)

276  
NULL
;

277 i‡(
	`°∫ˇ£cmp
(
p
, "bool", ("bool") - 1) == 0)

278 
öfo
->
ty≥
 = 
SND_CTL_ELEM_TYPE_BOOLEAN
;

279 i‡(
	`°∫ˇ£cmp
(
p
, "integer64", ("integer64") - 1) == 0)

280 
öfo
->
ty≥
 = 
SND_CTL_ELEM_TYPE_INTEGER64
;

281 i‡(
	`°∫ˇ£cmp
(
p
, "int64", ("int64") - 1) == 0)

282 
öfo
->
ty≥
 = 
SND_CTL_ELEM_TYPE_INTEGER64
;

283 i‡(
	`°∫ˇ£cmp
(
p
, "int", ("int") - 1) == 0)

284 
öfo
->
ty≥
 = 
SND_CTL_ELEM_TYPE_INTEGER
;

285 i‡(
	`°∫ˇ£cmp
(
p
, "enum", ("enum") - 1) == 0)

286 
öfo
->
ty≥
 = 
SND_CTL_ELEM_TYPE_ENUMERATED
;

287 i‡(
	`°∫ˇ£cmp
(
p
, "bytes", ("bytes") - 1) == 0)

288 
öfo
->
ty≥
 = 
SND_CTL_ELEM_TYPE_BYTES
;

290  
NULL
;

291 
	`ißÕha
(*
p
))

292 
p
++;

293  
p
;

294 
	}
}

296 c⁄° *
	$∑r£_uöt
(c⁄° *
p
, c⁄° *
¥efix
, 
size_t
 
Àn
,

297 
mö
, 
max
, *
rvÆ
)

299 
v
;

300 *
íd
;

302 i‡(
	`°∫ˇ£cmp
(
p
, 
¥efix
, 
Àn
))

303  
p
;

304 
p
 +
Àn
;

305 
v
 = 
	`°πﬁ
(
p
, &
íd
, 0);

306 i‡(*
íd
 != '\0' && *end != ' ' && *end != ',') {

307 
	`uc_îr‹
("u«bÀÅÿ∑r£ '%s'", 
¥efix
);

308  
NULL
;

310 i‡(()
v
 < 
mö
 || ()v > 
max
) {

311 
	`uc_îr‹
("vÆuê'%s' ouào‡øngê%u-%u %(%ld)", 
mö
, 
max
, 
v
);

312  
NULL
;

314 *
rvÆ
 = 
v
;

315  
íd
;

316 
	}
}

318 c⁄° *
	$∑r£_œbñs
(c⁄° *
p
, c⁄° *
¥efix
, 
size_t
 
Àn
,

319 
¢d_˘l_ñem_öfo_t
 *
öfo
)

321 c⁄° *
s
;

322 *
buf
, *
bp
;

323 
size_t
 
l
;

324 
c
;

326 i‡(
öfo
->
ty≥
 !
SND_CTL_ELEM_TYPE_ENUMERATED
)

327  
NULL
;

328 i‡(
	`°∫ˇ£cmp
(
p
, 
¥efix
, 
Àn
))

329  
p
;

330 
p
 +
Àn
;

331 
s
 = 
p
;

332 
c
 = *
s
;

333 
l
 = 0;

334 i‡(
c
 == '\'' || c == '\"') {

335 
s
++;

336 *
s
 && *†!
c
) {

337 
s
++, 
l
++;

339 i‡(*
s
 =
c
)

340 
s
++;

342 *
s
 && *s != ',')

343 
l
++;

345 i‡(
l
 == 0)

346  
NULL
;

347 
buf
 = 
	`mÆloc
(
l
 + 1);

348 i‡(
buf
 =
NULL
)

349  
NULL
;

350 
	`mem˝y
(
buf
, 
p
 + ((
c
 ='\'' || c ='\"'Ë? 1 : 0), 
l
);

351 
buf
[
l
] = '\0';

352 
öfo
->
vÆue
.
íumî©ed
.
ôems
 = 1;

353 
bp
 = 
buf
; *bp; bp++) {

354 i‡(*
bp
 == ';') {

355 i‡(
bp
 =
buf
 || bp[1] == ';') {

356 
	`‰ì
(
buf
);

357  
NULL
;

359 
öfo
->
vÆue
.
íumî©ed
.
ôems
++;

360 *
bp
 = '\0';

363 
öfo
->
vÆue
.
íumî©ed
.
«mes_±r
 = (
uöçå_t
)
buf
;

364 
öfo
->
vÆue
.
íumî©ed
.
«mes_Àngth
 = 
l
 + 1;

365  
s
;

366 
	}
}

368 
	$∑r£_c£t_√w_öfo
(
¢d_˘l_ñem_öfo_t
 *
öfo
, c⁄° *
s
, c⁄° **
pos
)

370 c⁄° *
p
 = 
s
, *
›
;

372 
öfo
->
cou¡
 = 1;

373 *
s
) {

374 
›
 = 
p
;

375 
p
 = 
	`∑r£_ty≥
’, "ty≥=", ("ty≥="Ë- 1, 
öfo
);

376 i‡(
p
 !
›
)

377 
√xt
;

378 
p
 = 
	`∑r£_uöt
’, "ñemíts=", ("ñemíts="Ë- 1, 1, 128, (*)&
öfo
->
ow√r
);

379 i‡(
p
 !
›
)

380 
√xt
;

381 
p
 = 
	`∑r£_uöt
’, "cou¡=", ("cou¡="Ë- 1, 1, 128, &
öfo
->
cou¡
);

382 i‡(
p
 !
›
)

383 
√xt
;

384 
p
 = 
	`∑r£_œbñs
’, "œbñs=", ("œbñs="Ë- 1, 
öfo
);

385 
√xt
:

386 i‡(
p
 =
NULL
)

387 
î
;

388 i‡(*
p
 == ',')

389 
p
++;

390 i‡(
	`is•a˚
(*
p
))

392 i‡(
›
 =
p
)

393 
î
;

395 *
pos
 = 
p
;

397 
î
:

398 
	`uc_îr‹
("unknow¿sy¡ax '%s'", 
p
);

399  -
EINVAL
;

400 
	}
}

402 
	$execuã_c£t
(
¢d_˘l_t
 *
˘l
, c⁄° *
c£t
, 
ty≥
)

404 c⁄° *
pos
;

405 
îr
;

406 
¢d_˘l_ñem_id_t
 *
id
;

407 
¢d_˘l_ñem_vÆue_t
 *
vÆue
;

408 
¢d_˘l_ñem_öfo_t
 *
öfo
, *
öfo2
 = 
NULL
;

409 *
ªs
 = 
NULL
;

411 
	`¢d_˘l_ñem_id_mÆloc
(&
id
);

412 
	`¢d_˘l_ñem_vÆue_mÆloc
(&
vÆue
);

413 
	`¢d_˘l_ñem_öfo_mÆloc
(&
öfo
);

415 
îr
 = 
	`__¢d_˘l_ascii_ñem_id_∑r£
(
id
, 
c£t
, &
pos
);

416 i‡(
îr
 < 0)

417 
__Áû
;

418 *
pos
 && 
	`is•a˚
(*pos))

419 
pos
++;

420 i‡(
ty≥
 =
SEQUENCE_ELEMENT_TYPE_CSET_NEW
) {

421 
	`¢d_˘l_ñem_öfo_mÆloc
(&
öfo2
);

422 
	`¢d_˘l_ñem_öfo_£t_id
(
öfo2
, 
id
);

423 
îr
 = 
	`∑r£_c£t_√w_öfo
(
öfo2
, 
pos
, &pos);

424 i‡(
îr
 < 0 || !*
pos
) {

425 
	`uc_îr‹
("undeföed o∏wr⁄g id c⁄fig f‹ c£t-√w", 
c£t
);

426 
îr
 = -
EINVAL
;

427 
__Áû
;

429 *
pos
 && 
	`is•a˚
(*pos))

430 
pos
++;

432 i‡(!*
pos
) {

433 i‡(
ty≥
 !
SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
) {

434 
	`uc_îr‹
("undeföed vÆuêf‹ c£à>%s<", 
c£t
);

435 
îr
 = -
EINVAL
;

436 
__Áû
;

438 } i‡(
ty≥
 =
SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
) {

439 
	`uc_îr‹
("exå®vÆuêf‹ cé-ªmovê>%s<", 
c£t
);

440 
îr
 = -
EINVAL
;

441 
__Áû
;

444 
	`¢d_˘l_ñem_öfo_£t_id
(
öfo
, 
id
);

445 
îr
 = 
	`¢d_˘l_ñem_öfo
(
˘l
, 
öfo
);

446 i‡(
ty≥
 =
SEQUENCE_ELEMENT_TYPE_CSET_NEW
 ||

447 
ty≥
 =
SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
) {

448 i‡(
îr
 >= 0) {

449 
îr
 = 
	`¢d_˘l_ñem_ªmove
(
˘l
, 
id
);

450 i‡(
îr
 < 0) {

451 
	`uc_îr‹
("unableÅoÑemove control");

452 
îr
 = -
EINVAL
;

453 
__Áû
;

456 i‡(
ty≥
 =
SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
)

457 
__ok
;

458 
îr
 = 
	`__¢d_˘l_add_ñem_£t
(
˘l
, 
öfo2
, info2->
ow√r
, info2->
cou¡
);

459 i‡(
îr
 < 0) {

460 
	`uc_îr‹
("unableÅo createÇew control");

461 
__Áû
;

464 
	`¢d_˘l_ñem_öfo_gë_id
(
öfo2
, 
id
);

465 
	`¢d_˘l_ñem_öfo_£t_id
(
öfo
, 
id
);

466 } i‡(
îr
 < 0)

467 
__Áû
;

468 i‡(
ty≥
 =
SEQUENCE_ELEMENT_TYPE_CSET_TLV
) {

469 i‡(!
	`¢d_˘l_ñem_öfo_is_év_wrôabÀ
(
öfo
)) {

470 
îr
 = -
EINVAL
;

471 
__Áû
;

473 
îr
 = 
	`ªad_év_fûe
(&
ªs
, 
pos
);

474 i‡(
îr
 < 0)

475 
__Áû
;

476 
îr
 = 
	`¢d_˘l_ñem_év_wrôe
(
˘l
, 
id
, 
ªs
);

477 i‡(
îr
 < 0)

478 
__Áû
;

480 
	`¢d_˘l_ñem_vÆue_£t_id
(
vÆue
, 
id
);

481 
îr
 = 
	`¢d_˘l_ñem_ªad
(
˘l
, 
vÆue
);

482 i‡(
îr
 < 0)

483 
__Áû
;

484 i‡(
ty≥
 =
SEQUENCE_ELEMENT_TYPE_CSET_BIN_FILE
)

485 
îr
 = 
	`bö¨y_fûe_∑r£
(
vÆue
, 
öfo
, 
pos
);

487 
îr
 = 
	`¢d_˘l_ascii_vÆue_∑r£
(
˘l
, 
vÆue
, 
öfo
, 
pos
);

488 i‡(
îr
 < 0)

489 
__Áû
;

490 
îr
 = 
	`¢d_˘l_ñem_wrôe
(
˘l
, 
vÆue
);

491 i‡(
îr
 < 0)

492 
__Áû
;

493 i‡(
ty≥
 =
SEQUENCE_ELEMENT_TYPE_CSET_NEW
) {

494 
idx
;

495 
idx
 = 1; idx < ()
öfo2
->
ow√r
; idx++) {

496 
vÆue
->
id
.
numid
 += 1;

497 
îr
 = 
	`¢d_˘l_ñem_wrôe
(
˘l
, 
vÆue
);

498 i‡(
îr
 < 0)

499 
__Áû
;

503 
__ok
:

504 
îr
 = 0;

505 
__Áû
:

506 
	`‰ì
(
id
);

507 
	`‰ì
(
vÆue
);

508 i‡(
öfo2
) {

509 i‡(
öfo2
->
ty≥
 =
SND_CTL_ELEM_TYPE_ENUMERATED
)

510 
	`‰ì
((*)(
size_t
)
öfo2
->
vÆue
.
íumî©ed
.
«mes_±r
);

511 
	`‰ì
(
öfo2
);

513 
	`‰ì
(
öfo
);

514 
	`‰ì
(
ªs
);

516  
îr
;

517 
	}
}

519 
	$execuã_sysw
(c⁄° *
sysw
)

521 
∑th
[
PATH_MAX
];

522 c⁄° *
e
;

523 *
s
, *
vÆue
;

524 
ssize_t
 
wÀn
;

525 
size_t
 
Àn
;

526 
fd
, 
myî∫o
;

527 
boﬁ
 
ign‹e_îr‹
 = 
Ál£
;

529 i‡(
sysw
 =
NULL
 || *sysw == '\0')

532 i‡(
sysw
[0] == '-') {

533 
ign‹e_îr‹
 = 
åue
;

534 
sysw
++;

537 i‡(
sysw
[0] == ':')

538  -
EINVAL
;

540 
s
 = 
	`°rdup
(
sysw
[0] != '/' ? sysw : sysw + 1);

541 i‡(
s
 =
NULL
)

542  -
ENOMEM
;

544 
vÆue
 = 
	`°rchr
(
s
, ':');

545 i‡(!
vÆue
) {

546 
	`‰ì
(
s
);

547  -
EINVAL
;

549 *
vÆue
 = '\0';

550 
vÆue
++;

551 
Àn
 = 
	`°æí
(
vÆue
);

552 i‡(
Àn
 < 1) {

553 
	`‰ì
(
s
);

554  -
EINVAL
;

557 
e
 = 
	`uc_mgr_sysfs_roŸ
();

558 i‡(
e
 =
NULL
) {

559 
	`‰ì
(
s
);

560  -
EINVAL
;

562 
	`¢¥ötf
(
∑th
, ’©h), "%s/%s", 
e
, 
s
);

564 
fd
 = 
	`›í
(
∑th
, 
O_WRONLY
|
O_CLOEXEC
);

565 i‡(
fd
 < 0) {

566 
	`‰ì
(
s
);

567 i‡(
ign‹e_îr‹
)

569 
	`uc_îr‹
("u«bÀÅÿ›í '%s' f‹ wrôe", 
∑th
);

570  -
EINVAL
;

572 
wÀn
 = 
	`wrôe
(
fd
, 
vÆue
, 
Àn
);

573 
myî∫o
 = 
î∫o
;

574 
	`˛o£
(
fd
);

576 i‡(
ign‹e_îr‹
)

577 
__íd
;

579 i‡(
wÀn
 !(
ssize_t
)
Àn
) {

580 
	`uc_îr‹
("u«bÀÅÿwrôê'%s'Åÿ'%s': %s", 
vÆue
, 
∑th
, 
	`°ªº‹
(
myî∫o
));

581 
	`‰ì
(
s
);

582  -
EINVAL
;

585 
__íd
:

586 
	`‰ì
(
s
);

588 
	}
}

590 
_¢d_c⁄fig_ßve_node_vÆue
(
¢d_c⁄fig_t
 *
n
, 
¢d_ouçut_t
 *
out
, 
Àvñ
);

592 
	$execuã_cfgßve
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
fûíame
)

594 
¢d_c⁄fig_t
 *
c⁄fig
 = 
uc_mgr
->
loˇl_c⁄fig
;

595 *
fûe
, *
roŸ
;

596 
¢d_ouçut_t
 *
out
;

597 
boﬁ
 
wôh_roŸ
 = 
Ál£
;

598 
îr
 = 0;

600 
fûe
 = 
	`°rdup
(
fûíame
);

601 i‡(!
fûe
)

602  -
ENOMEM
;

603 
roŸ
 = 
	`°rchr
(
fûe
, ':');

604 i‡(
c⁄fig
 && 
roŸ
) {

605 *
roŸ
++ = '\0';

606 i‡(*
roŸ
 == '+') {

607 
wôh_roŸ
 = 
åue
;

608 
roŸ
++;

610 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, 
roŸ
, &config);

611 i‡(
îr
 < 0) {

612 
	`uc_îr‹
("U«bÀÅÿföd subåì '%s'", 
roŸ
);

613 
_îr
;

617 
îr
 = 
	`¢d_ouçut_°dio_›í
(&
out
, 
fûe
, "w+");

618 i‡(
îr
 < 0) {

619 
	`uc_îr‹
("u«bÀÅÿ›í fûê'%s': %s", 
fûe
, 
	`¢d_°ªº‹
(
îr
));

620 
_îr
;

622 i‡(!
c⁄fig
 || 
	`¢d_c⁄fig_is_em±y
(config)) {

623 
	`¢d_ouçut_˛o£
(
out
);

624 
_îr
;

626 i‡(
wôh_roŸ
) {

627 
	`¢d_ouçut_¥ötf
(
out
, "%†", 
roŸ
);

628 
îr
 = 
	`_¢d_c⁄fig_ßve_node_vÆue
(
c⁄fig
, 
out
, 0);

630 
îr
 = 
	`¢d_c⁄fig_ßve
(
c⁄fig
, 
out
);

632 
	`¢d_ouçut_˛o£
(
out
);

633 i‡(
îr
 < 0) {

634 
	`uc_îr‹
("u«bÀÅÿßvêc⁄figuøti⁄: %s", 
	`¢d_°ªº‹
(
îr
));

635 
_îr
;

637 
_îr
:

638 
	`‰ì
(
fûe
);

639  
îr
;

640 
	}
}

642 
	$ªwrôe_devi˚_vÆue
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
«me
, **
vÆue
)

644 *
svÆ
;

645 
size_t
 
l
;

646 c⁄° **
s
, *
_¥efix
[] = {

653 
NULL


656 i‡(!
	`uc_mgr_has_loˇl_c⁄fig
(
uc_mgr
))

658 
s
 = 
_¥efix
; *†&& *
vÆue
; s++) {

659 i‡(
	`°rcmp
(*
s
, 
«me
) != 0)

661 
l
 = 
	`°æí
(*
vÆue
) + 9 + 1;

662 
svÆ
 = 
	`mÆloc
(
l
);

663 i‡(
svÆ
 =
NULL
) {

664 
	`‰ì
(*
vÆue
);

665 *
vÆue
 = 
NULL
;

666  -
ENOMEM
;

668 
	`¢¥ötf
(
svÆ
, 
l
, "_ucm%04X.%s", 
uc_mgr
->
ucm_ˇrd_numbî
, *
vÆue
);

669 
	`‰ì
(*
vÆue
);

670 *
vÆue
 = 
svÆ
;

674 
	}
}

676 
	$run_devi˚_£quí˚
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
u£_ˇ£_vîb
 *
vîb
,

677 c⁄° *
«me
, 
boﬁ
 
íabÀ
)

679 
u£_ˇ£_devi˚
 *
devi˚
;

681 i‡(
vîb
 =
NULL
) {

682 
	`uc_îr‹
("error:Énadev2 / disdev2 must beÉxecuted insideÅhe verb context");

683  -
ENOENT
;

686 
devi˚
 = 
	`föd_devi˚
(
uc_mgr
, 
vîb
, 
«me
, 0);

687 i‡(
devi˚
 =
NULL
) {

688 
	`uc_îr‹
("îr‹: u«bÀÅÿföd devi˚ '%s'\n", 
«me
);

689  -
ENOENT
;

692  
	`execuã_£quí˚
(
uc_mgr
, 
vîb
,

693 
íabÀ
 ? &
devi˚
->
íabÀ_li°
 : &devi˚->
dißbÀ_li°
,

694 &
devi˚
->
vÆue_li°
,

695 &
vîb
->
vÆue_li°
,

696 &
uc_mgr
->
vÆue_li°
);

697 
	}
}

699 
	$run_devi˚_Æl_£quí˚
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
u£_ˇ£_vîb
 *
vîb
)

701 
u£_ˇ£_devi˚
 *
devi˚
;

702 
li°_hód
 *
pos
;

703 
îr
;

705 i‡(
vîb
 =
NULL
) {

706 
	`uc_îr‹
("error: disdevall must beÉxecuted insideÅhe verb context");

707  -
ENOENT
;

710 
	`li°_f‹_óch
(
pos
, &
vîb
->
devi˚_li°
) {

711 
devi˚
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_devi˚
, 
li°
);

713 
îr
 = 
	`execuã_£quí˚
(
uc_mgr
, 
vîb
,

714 &
devi˚
->
dißbÀ_li°
,

715 &
devi˚
->
vÆue_li°
,

716 &
vîb
->
vÆue_li°
,

717 &
uc_mgr
->
vÆue_li°
);

718 i‡(
îr
 < 0)

719  
îr
;

722 
	}
}

730 
	$execuã_£quí˚
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

731 
u£_ˇ£_vîb
 *
vîb
,

732 
li°_hód
 *
£q
,

733 
li°_hód
 *
vÆue_li°1
,

734 
li°_hód
 *
vÆue_li°2
,

735 
li°_hód
 *
vÆue_li°3
)

737 
li°_hód
 *
pos
;

738 
£quí˚_ñemít
 *
s
;

739 *
cdev
 = 
NULL
;

740 
¢d_˘l_t
 *
˘l
 = 
NULL
;

741 
˘l_li°
 *ctl_list;

742 
boﬁ
 
ign‹e_îr‹
;

743 
îr
 = 0;

745 i‡(
uc_mgr
->
£quí˚_h›s
 > 100) {

746 
	`uc_îr‹
("error:Åoo many inner sequences!");

747  -
EINVAL
;

749 
uc_mgr
->
£quí˚_h›s
++;

750 
	`li°_f‹_óch
(
pos
, 
£q
) {

751 
s
 = 
	`li°_íåy
(
pos
, 
£quí˚_ñemít
, 
li°
);

752 
s
->
ty≥
) {

753 
SEQUENCE_ELEMENT_TYPE_CDEV
:

754 
cdev
 = 
	`°rdup
(
s
->
d©a
.cdev);

755 i‡(
cdev
 =
NULL
)

756 
__Áû_nomem
;

757 i‡(
	`ªwrôe_devi˚_vÆue
(
uc_mgr
, "PœybackCTL", &
cdev
))

758 
__Áû_nomem
;

760 
SEQUENCE_ELEMENT_TYPE_CSET
:

761 
SEQUENCE_ELEMENT_TYPE_CSET_BIN_FILE
:

762 
SEQUENCE_ELEMENT_TYPE_CSET_TLV
:

763 
SEQUENCE_ELEMENT_TYPE_CSET_NEW
:

764 
SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
:

765 i‡(
cdev
 =
NULL
 && 
uc_mgr
->
ö_comp⁄ít_domaö
) {

769 i‡(
uc_mgr
->
cdev
 =
NULL
) {

770 
	`uc_îr‹
("cdev isÇot defined!");

771  
îr
;

774 
cdev
 = 
	`°∫dup
(
uc_mgr
->cdev, 
PATH_MAX
);

775 i‡(!
cdev
)

776  -
ENOMEM
;

777 } i‡(
cdev
 =
NULL
) {

778 *
∂ayback_˘l
 = 
NULL
;

779 *
ˇ±uª_˘l
 = 
NULL
;

781 
îr
 = 
	`gë_vÆue3
(
uc_mgr
, &
∂ayback_˘l
, "PlaybackCTL",

782 
vÆue_li°1
,

783 
vÆue_li°2
,

784 
vÆue_li°3
);

785 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

786 
	`uc_îr‹
("cdev isÇot defined!");

787  
îr
;

789 
îr
 = 
	`gë_vÆue3
(
uc_mgr
, &
ˇ±uª_˘l
, "CaptureCTL",

790 
vÆue_li°1
,

791 
vÆue_li°2
,

792 
vÆue_li°3
);

793 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

794 
	`‰ì
(
∂ayback_˘l
);

795 
	`uc_îr‹
("cdev isÇot defined!");

796  
îr
;

798 i‡(
∂ayback_˘l
 =
NULL
 &&

799 
ˇ±uª_˘l
 =
NULL
) {

800 
	`uc_îr‹
("cdev isÇot defined!");

801  -
EINVAL
;

803 i‡(
∂ayback_˘l
 !
NULL
 &&

804 
ˇ±uª_˘l
 !
NULL
 &&

805 
	`°rcmp
(
∂ayback_˘l
, 
ˇ±uª_˘l
) != 0) {

806 
	`‰ì
(
∂ayback_˘l
);

807 
	`‰ì
(
ˇ±uª_˘l
);

808 
	`uc_îr‹
("cdev isÇotÉqual forÖlaybackánd capture!");

809  -
EINVAL
;

811 i‡(
∂ayback_˘l
 !
NULL
) {

812 
cdev
 = 
∂ayback_˘l
;

813 
	`‰ì
(
ˇ±uª_˘l
);

815 
cdev
 = 
ˇ±uª_˘l
;

818 i‡(
˘l
 =
NULL
) {

819 
îr
 = 
	`uc_mgr_›í_˘l
(
uc_mgr
, &
˘l_li°
, 
cdev
, 1);

820 i‡(
îr
 < 0) {

821 
	`uc_îr‹
("u«bÀÅÿ›í cé devi˚ '%s'", 
cdev
);

822 
__Áû
;

824 
˘l
 = 
˘l_li°
->ctl;

826 
îr
 = 
	`execuã_c£t
(
˘l
, 
s
->
d©a
.
c£t
, s->
ty≥
);

827 i‡(
îr
 < 0) {

828 
	`uc_îr‹
("u«bÀÅÿexecuã c£à'%s'", 
s
->
d©a
.
c£t
);

829 
__Áû
;

832 
SEQUENCE_ELEMENT_TYPE_SYSSET
:

833 
îr
 = 
	`execuã_sysw
(
s
->
d©a
.
sysw
);

834 i‡(
îr
 < 0)

835 
__Áû
;

837 
SEQUENCE_ELEMENT_TYPE_SLEEP
:

838 
	`u¶ìp
(
s
->
d©a
.
¶ìp
);

840 
SEQUENCE_ELEMENT_TYPE_EXEC
:

841 i‡(
s
->
d©a
.
exec
 =
NULL
)

843 
ign‹e_îr‹
 = 
s
->
d©a
.
exec
[0] == '-';

844 
îr
 = 
	`uc_mgr_exec
(
s
->
d©a
.
exec
 + (
ign‹e_îr‹
 ? 1 : 0));

845 i‡(
ign‹e_îr‹
 =
Ál£
 && 
îr
 != 0) {

846 
	`uc_îr‹
("exe¯'%s' faûed (exô codê%d)", 
s
->
d©a
.
exec
, 
îr
);

847 
__Áû
;

850 
SEQUENCE_ELEMENT_TYPE_SHELL
:

851 i‡(
s
->
d©a
.
exec
 =
NULL
)

853 
ign‹e_îr‹
 = 
s
->
d©a
.
exec
[0] == '-';

854 
shñl_ªåy
:

855 
îr
 = 
	`sy°em
(
s
->
d©a
.
exec
 + (
ign‹e_îr‹
 ? 1 : 0));

856 i‡(
	`WIFSIGNALED
(
îr
)) {

857 
îr
 = -
EINTR
;

858 } i‡(
	`WIFEXITED
(
îr
)) {

859 i‡(
ign‹e_îr‹
 =
Ál£
 && 
	`WEXITSTATUS
(
îr
) != 0) {

860 
	`uc_îr‹
("comm™d '%s' faûed (exô codê%d)", 
s
->
d©a
.
exec
, 
	`WEXITSTATUS
(
îr
));

861 
îr
 = -
EINVAL
;

862 
__Áû
;

864 } i‡(
îr
 < 0) {

865 i‡(
î∫o
 =
EAGAIN
)

866 
shñl_ªåy
;

867 
îr
 = -
î∫o
;

868 
__Áû
;

871 
SEQUENCE_ELEMENT_TYPE_CMPT_SEQ
:

875 
îr
 = 
	`execuã_comp⁄ít_£q
(
uc_mgr
,

876 &
s
->
d©a
.
cm±_£q
,

877 
vÆue_li°1
,

878 
vÆue_li°2
,

879 
vÆue_li°3
,

880 
cdev
);

881 i‡(
îr
 < 0)

882 
__Áû
;

884 
SEQUENCE_ELEMENT_TYPE_CFGSAVE
:

885 
îr
 = 
	`execuã_cfgßve
(
uc_mgr
, 
s
->
d©a
.
cfgßve
);

886 i‡(
îr
 < 0)

887 
__Áû
;

889 
SEQUENCE_ELEMENT_TYPE_DEV_ENABLE_SEQ
:

890 
SEQUENCE_ELEMENT_TYPE_DEV_DISABLE_SEQ
:

891 
îr
 = 
	`run_devi˚_£quí˚
(
uc_mgr
, 
vîb
, 
s
->
d©a
.
devi˚
,

892 
s
->
ty≥
 =
SEQUENCE_ELEMENT_TYPE_DEV_ENABLE_SEQ
);

893 i‡(
îr
 < 0)

894 
__Áû
;

896 
SEQUENCE_ELEMENT_TYPE_DEV_DISABLE_ALL
:

897 
îr
 = 
	`run_devi˚_Æl_£quí˚
(
uc_mgr
, 
vîb
);

898 i‡(
îr
 < 0)

899 
__Áû
;

902 
	`uc_îr‹
("unknow¿£quí˚ comm™d %i", 
s
->
ty≥
);

906 
	`‰ì
(
cdev
);

907 
uc_mgr
->
£quí˚_h›s
--;

909 
__Áû_nomem
:

910 
îr
 = -
ENOMEM
;

911 
__Áû
:

912 
	`‰ì
(
cdev
);

913 
uc_mgr
->
£quí˚_h›s
--;

914  
îr
;

916 
	}
}

927 
	$execuã_comp⁄ít_£q
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

928 
comp⁄ít_£quí˚
 *
cm±_£q
,

929 
li°_hód
 *
vÆue_li°1
 
ATTRIBUTE_UNUSED
,

930 
li°_hód
 *
vÆue_li°2
 
ATTRIBUTE_UNUSED
,

931 
li°_hód
 *
vÆue_li°3
 
ATTRIBUTE_UNUSED
,

932 *
cdev
)

934 
u£_ˇ£_devi˚
 *
devi˚
 = 
cm±_£q
->device;

935 
li°_hód
 *
£q
;

936 
îr
;

939 
uc_mgr
->
ö_comp⁄ít_domaö
 = 1;

940 
uc_mgr
->
cdev
 = cdev;

943 i‡(
cm±_£q
->
íabÀ
)

944 
£q
 = &
devi˚
->
íabÀ_li°
;

946 
£q
 = &
devi˚
->
dißbÀ_li°
;

949 
îr
 = 
	`execuã_£quí˚
(
uc_mgr
, uc_mgr->
a˘ive_vîb
, 
£q
,

950 &
devi˚
->
vÆue_li°
,

951 &
uc_mgr
->
a˘ive_vîb
->
vÆue_li°
,

952 &
uc_mgr
->
vÆue_li°
);

955 
uc_mgr
->
ö_comp⁄ít_domaö
 = 0;

956 
uc_mgr
->
cdev
 = 
NULL
;

958  
îr
;

959 
	}
}

961 
	$add_auto_vÆue
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
key
, *
vÆue
)

963 *
s
;

964 
îr
;

966 
îr
 = 
	`gë_vÆue1
(
uc_mgr
, &
vÆue
, &uc_mgr->
vÆue_li°
, 
key
);

967 i‡(
îr
 =-
ENOENT
) {

968 
s
 = 
	`°rdup
(
vÆue
);

969 i‡(
s
 =
NULL
)

970  -
ENOMEM
;

971  
	`uc_mgr_add_vÆue
(&
uc_mgr
->
vÆue_li°
, 
key
, 
s
);

972 } i‡(
îr
 < 0) {

973  
îr
;

975 
	`‰ì
(
vÆue
);

977 
	}
}

979 
	$add_auto_vÆues
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

981 
˘l_li°
 *ctl_list;

982 c⁄° *
id
;

983 
buf
[40];

984 
îr
;

986 
˘l_li°
 = 
	`uc_mgr_gë_ma°î_˘l
(
uc_mgr
);

987 i‡(
˘l_li°
) {

988 
id
 = 
	`¢d_˘l_ˇrd_öfo_gë_id
(
˘l_li°
->
˘l_öfo
);

989 
	`¢¥ötf
(
buf
, (buf), "hw:%s", 
id
);

990 
îr
 = 
	`add_auto_vÆue
(
uc_mgr
, "PœybackCTL", 
buf
);

991 i‡(
îr
 < 0)

992  
îr
;

993 
îr
 = 
	`add_auto_vÆue
(
uc_mgr
, "C≠tuªCTL", 
buf
);

994 i‡(
îr
 < 0)

995  
îr
;

998 
	}
}

1006 
	$£t_deÁu…s
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
boﬁ
 
f‹˚
)

1008 
îr
;

1010 i‡(!
f‹˚
 && 
uc_mgr
->
deÁu…_li°_execuãd
)

1012 
îr
 = 
	`execuã_£quí˚
(
uc_mgr
, 
NULL
, &uc_mgr->
deÁu…_li°
,

1013 &
uc_mgr
->
vÆue_li°
, 
NULL
, NULL);

1014 i‡(
îr
 < 0) {

1015 
	`uc_îr‹
("UnableÅoÉxecute default sequence");

1016  
îr
;

1018 
uc_mgr
->
deÁu…_li°_execuãd
 = 1;

1020 
	}
}

1027 
	$imp‹t_ma°î_c⁄fig
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

1029 
îr
;

1031 
îr
 = 
	`uc_mgr_imp‹t_ma°î_c⁄fig
(
uc_mgr
);

1032 i‡(
îr
 < 0)

1033  
îr
;

1034  
	`add_auto_vÆues
(
uc_mgr
);

1035 
	}
}

1042 
	$check_em±y_c⁄figuøti⁄
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

1044 
îr
;

1045 *
vÆue
;

1047 
îr
 = 
	`gë_vÆue
(
uc_mgr
, "Löked", &
vÆue
, 
NULL
, NULL, 1);

1048 i‡(
îr
 >= 0) {

1049 
îr
 = 
	`°rˇ£cmp
(
vÆue
, "true") == 0 ||

1050 
	`°rcmp
(
vÆue
, "1") == 0;

1051 
	`‰ì
(
vÆue
);

1052 i‡(
îr
)

1055 i‡(!
	`li°_em±y
(&
uc_mgr
->
vîb_li°
))

1057 i‡(!
	`li°_em±y
(&
uc_mgr
->
fixedboŸ_li°
))

1059 i‡(!
	`li°_em±y
(&
uc_mgr
->
boŸ_li°
))

1061  -
ENXIO
;

1062 
	}
}

1072 *
	$föd0
(
li°_hód
 *
li°
,

1073 
off£t
,

1074 
soff£t
,

1075 c⁄° *
m©ch
)

1077 
li°_hód
 *
pos
;

1078 *
±r
, *
°r
;

1080 
	`li°_f‹_óch
(
pos
, 
li°
) {

1081 
±r
 = 
	`li°_íåy_off£t
(
pos
, , 
off£t
);

1082 
°r
 = *((**)(
±r
 + 
soff£t
));

1083 i‡(
	`°rcmp
(
°r
, 
m©ch
) == 0)

1084  
±r
;

1086  
NULL
;

1087 
	}
}

1089 
	#föd
(
li°
, 
ty≥
, 
membî
, 
vÆue
, 
m©ch
) \

1090 
	`föd0
(
li°
, ()(&((
ty≥
 *)0)->
membî
), \

1091 ()(&((
ty≥
 *)0)->
vÆue
), 
m©ch
)

	)

1101 
	$gë_li°0
(
li°_hód
 *
li°
,

1102 c⁄° **
ªsu…
[],

1103 
off£t
,

1104 
s1off£t
)

1106 **
ªs
;

1107 
˙t
;

1108 
li°_hód
 *
pos
;

1109 *
±r
, *
°r1
;

1111 
˙t
 = 
	`Æloc_°r_li°
(
li°
, 1, &
ªs
);

1112 i‡(
˙t
 <= 0) {

1113 *
ªsu…
 = 
NULL
;

1114  
˙t
;

1116 *
ªsu…
 = (c⁄° **)
ªs
;

1117 
	`li°_f‹_óch
(
pos
, 
li°
) {

1118 
±r
 = 
	`li°_íåy_off£t
(
pos
, , 
off£t
);

1119 
°r1
 = *((**)(
±r
 + 
s1off£t
));

1120 i‡(
°r1
 !
NULL
) {

1121 *
ªs
 = 
	`°rdup
(
°r1
);

1122 i‡(*
ªs
 =
NULL
)

1123 
__Áû
;

1125 *
ªs
 = 
NULL
;

1127 
ªs
++;

1129  
˙t
;

1130 
__Áû
:

1131 
	`¢d_u£_ˇ£_‰ì_li°
(*
ªsu…
, 
˙t
);

1132  -
ENOMEM
;

1133 
	}
}

1135 
	#gë_li°
(
li°
, 
ªsu…
, 
ty≥
, 
membî
, 
s1
) \

1136 
	`gë_li°0
(
li°
, 
ªsu…
, \

1137 ()(&((
ty≥
 *)0)->
membî
), \

1138 ()(&((
ty≥
 *)0)->
s1
))

	)

1149 
	$gë_li°20
(
li°_hód
 *
li°
,

1150 c⁄° **
ªsu…
[],

1151 
off£t
,

1152 
s1off£t
,

1153 
s2off£t
)

1155 **
ªs
;

1156 
˙t
;

1157 
li°_hód
 *
pos
;

1158 *
±r
, *
°r1
, *
°r2
;

1160 
˙t
 = 
	`Æloc_°r_li°
(
li°
, 2, &
ªs
);

1161 i‡(
˙t
 <= 0) {

1162 *
ªsu…
 = 
NULL
;

1163  
˙t
;

1165 *
ªsu…
 = (c⁄° **)
ªs
;

1166 
	`li°_f‹_óch
(
pos
, 
li°
) {

1167 
±r
 = 
	`li°_íåy_off£t
(
pos
, , 
off£t
);

1168 
°r1
 = *((**)(
±r
 + 
s1off£t
));

1169 i‡(
°r1
 !
NULL
) {

1170 *
ªs
 = 
	`°rdup
(
°r1
);

1171 i‡(*
ªs
 =
NULL
)

1172 
__Áû
;

1174 *
ªs
 = 
NULL
;

1176 
ªs
++;

1177 
°r2
 = *((**)(
±r
 + 
s2off£t
));

1178 i‡(
°r2
 !
NULL
) {

1179 *
ªs
 = 
	`°rdup
(
°r2
);

1180 i‡(*
ªs
 =
NULL
)

1181 
__Áû
;

1183 *
ªs
 = 
NULL
;

1185 
ªs
++;

1187  
˙t
;

1188 
__Áû
:

1189 
	`¢d_u£_ˇ£_‰ì_li°
(*
ªsu…
, 
˙t
);

1190  -
ENOMEM
;

1191 
	}
}

1193 
	#gë_li°2
(
li°
, 
ªsu…
, 
ty≥
, 
membî
, 
s1
, 
s2
) \

1194 
	`gë_li°20
(
li°
, 
ªsu…
, \

1195 ()(&((
ty≥
 *)0)->
membî
), \

1196 ()(&((
ty≥
 *)0)->
s1
), \

1197 ()(&((
ty≥
 *)0)->
s2
))

	)

1205 
ölöe
 
u£_ˇ£_vîb
 *
	$föd_vîb
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1206 c⁄° *
vîb_«me
)

1208  
	`föd
(&
uc_mgr
->
vîb_li°
,

1209 
u£_ˇ£_vîb
, 
li°
, 
«me
,

1210 
vîb_«me
);

1211 
	}
}

1213 
	$is_devli°_suµ‹ãd
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1214 
dev_li°
 *dev_list)

1216 
dev_li°_node
 *
devi˚
;

1217 
u£_ˇ£_devi˚
 *
adev
;

1218 
li°_hód
 *
pos
, *
pos1
;

1219 
found_ªt
;

1221 
dev_li°
->
ty≥
) {

1222 
DEVLIST_NONE
:

1225 
DEVLIST_SUPPORTED
:

1226 
found_ªt
 = 1;

1228 
DEVLIST_CONFLICTING
:

1229 
found_ªt
 = 0;

1233 
	`li°_f‹_óch
(
pos
, &
dev_li°
->
li°
) {

1234 
devi˚
 = 
	`li°_íåy
(
pos
, 
dev_li°_node
, 
li°
);

1236 
	`li°_f‹_óch
(
pos1
, &
uc_mgr
->
a˘ive_devi˚s
) {

1237 
adev
 = 
	`li°_íåy
(
pos1
, 
u£_ˇ£_devi˚
,

1238 
a˘ive_li°
);

1239 i‡(!
	`°rcmp
(
devi˚
->
«me
, 
adev
->name))

1240  
found_ªt
;

1243  1 - 
found_ªt
;

1244 
	}
}

1246 
ölöe
 
	$is_modifõr_suµ‹ãd
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1247 
u£_ˇ£_modifõr
 *
modifõr
)

1249  
	`is_devli°_suµ‹ãd
(
uc_mgr
, &
modifõr
->
dev_li°
);

1250 
	}
}

1252 
ölöe
 
	$is_devi˚_suµ‹ãd
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1253 
u£_ˇ£_devi˚
 *
devi˚
)

1255  
	`is_devli°_suµ‹ãd
(
uc_mgr
, &
devi˚
->
dev_li°
);

1256 
	}
}

1264 
ölöe
 
u£_ˇ£_devi˚
 *

1265 
	$föd_devi˚
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
u£_ˇ£_vîb
 *
vîb
,

1266 c⁄° *
devi˚_«me
, 
check_suµ‹ãd
)

1268 
u£_ˇ£_devi˚
 *
devi˚
;

1269 
li°_hód
 *
pos
;

1271 
	`li°_f‹_óch
(
pos
, &
vîb
->
devi˚_li°
) {

1272 
devi˚
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_devi˚
, 
li°
);

1274 i‡(
	`°rcmp
(
devi˚_«me
, 
devi˚
->
«me
))

1277 i‡(
check_suµ‹ãd
 &&

1278 !
	`is_devi˚_suµ‹ãd
(
uc_mgr
, 
devi˚
))

1281  
devi˚
;

1283  
NULL
;

1284 
	}
}

1292 
u£_ˇ£_modifõr
 *

1293 
	$föd_modifõr
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
u£_ˇ£_vîb
 *
vîb
,

1294 c⁄° *
modifõr_«me
, 
check_suµ‹ãd
)

1296 
u£_ˇ£_modifõr
 *
modifõr
;

1297 
li°_hód
 *
pos
;

1299 
	`li°_f‹_óch
(
pos
, &
vîb
->
modifõr_li°
) {

1300 
modifõr
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_modifõr
, 
li°
);

1302 i‡(
	`°rcmp
(
modifõr
->
«me
, 
modifõr_«me
))

1305 i‡(
check_suµ‹ãd
 &&

1306 !
	`is_modifõr_suµ‹ãd
(
uc_mgr
, 
modifõr
))

1309  
modifõr
;

1311  
NULL
;

1312 
	}
}

1314 
	$devi˚_°©us
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1315 c⁄° *
devi˚_«me
)

1317 
u£_ˇ£_devi˚
 *
dev
;

1318 
li°_hód
 *
pos
;

1320 
	`li°_f‹_óch
(
pos
, &
uc_mgr
->
a˘ive_devi˚s
) {

1321 
dev
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_devi˚
, 
a˘ive_li°
);

1322 i‡(
	`°rcmp
(
dev
->
«me
, 
devi˚_«me
) == 0)

1326 
	}
}

1328 
	$modifõr_°©us
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1329 c⁄° *
modifõr_«me
)

1331 
u£_ˇ£_modifõr
 *
mod
;

1332 
li°_hód
 *
pos
;

1334 
	`li°_f‹_óch
(
pos
, &
uc_mgr
->
a˘ive_modifõrs
) {

1335 
mod
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_modifõr
, 
a˘ive_li°
);

1336 i‡(
	`°rcmp
(
mod
->
«me
, 
modifõr_«me
) == 0)

1340 
	}
}

1349 
	$£t_vîb
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1350 
u£_ˇ£_vîb
 *
vîb
,

1351 
íabÀ
)

1353 
li°_hód
 *
£q
;

1354 
îr
;

1356 i‡(
íabÀ
) {

1357 
îr
 = 
	`£t_deÁu…s
(
uc_mgr
, 
Ál£
);

1358 i‡(
îr
 < 0)

1359  
îr
;

1360 
£q
 = &
vîb
->
íabÀ_li°
;

1362 
£q
 = &
vîb
->
dißbÀ_li°
;

1364 
îr
 = 
	`execuã_£quí˚
(
uc_mgr
, 
vîb
, 
£q
,

1365 &
vîb
->
vÆue_li°
,

1366 &
uc_mgr
->
vÆue_li°
,

1367 
NULL
);

1368 i‡(
íabÀ
 && 
îr
 >= 0)

1369 
uc_mgr
->
a˘ive_vîb
 = 
vîb
;

1370  
îr
;

1371 
	}
}

1380 
	$£t_modifõr
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1381 
u£_ˇ£_modifõr
 *
modifõr
,

1382 
íabÀ
)

1384 
li°_hód
 *
£q
;

1385 
îr
;

1387 i‡(
	`modifõr_°©us
(
uc_mgr
, 
modifõr
->
«me
Ë=
íabÀ
)

1390 i‡(
íabÀ
) {

1391 
£q
 = &
modifõr
->
íabÀ_li°
;

1393 
£q
 = &
modifõr
->
dißbÀ_li°
;

1395 
îr
 = 
	`execuã_£quí˚
(
uc_mgr
, uc_mgr->
a˘ive_vîb
, 
£q
,

1396 &
modifõr
->
vÆue_li°
,

1397 &
uc_mgr
->
a˘ive_vîb
->
vÆue_li°
,

1398 &
uc_mgr
->
vÆue_li°
);

1399 i‡(
íabÀ
 && 
îr
 >= 0) {

1400 
	`li°_add_èû
(&
modifõr
->
a˘ive_li°
, &
uc_mgr
->
a˘ive_modifõrs
);

1401 } i‡(!
íabÀ
) {

1402 
	`li°_dñ
(&
modifõr
->
a˘ive_li°
);

1404  
îr
;

1405 
	}
}

1414 
	$£t_devi˚
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1415 
u£_ˇ£_devi˚
 *
devi˚
,

1416 
íabÀ
)

1418 
li°_hód
 *
£q
;

1419 
îr
;

1421 i‡(
	`devi˚_°©us
(
uc_mgr
, 
devi˚
->
«me
Ë=
íabÀ
)

1424 i‡(
íabÀ
) {

1425 
£q
 = &
devi˚
->
íabÀ_li°
;

1427 
£q
 = &
devi˚
->
dißbÀ_li°
;

1429 
îr
 = 
	`execuã_£quí˚
(
uc_mgr
, uc_mgr->
a˘ive_vîb
, 
£q
,

1430 &
devi˚
->
vÆue_li°
,

1431 &
uc_mgr
->
a˘ive_vîb
->
vÆue_li°
,

1432 &
uc_mgr
->
vÆue_li°
);

1433 i‡(
íabÀ
 && 
îr
 >= 0) {

1434 
	`li°_add_èû
(&
devi˚
->
a˘ive_li°
, &
uc_mgr
->
a˘ive_devi˚s
);

1435 } i‡(!
íabÀ
) {

1436 
	`li°_dñ
(&
devi˚
->
a˘ive_li°
);

1438  
îr
;

1439 
	}
}

1446 
	$do_ª£t
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

1448 
îr
;

1450 
îr
 = 
	`£t_deÁu…s
(
uc_mgr
, 
åue
);

1451 
	`INIT_LIST_HEAD
(&
uc_mgr
->
a˘ive_modifõrs
);

1452 
	`INIT_LIST_HEAD
(&
uc_mgr
->
a˘ive_devi˚s
);

1453 
uc_mgr
->
a˘ive_vîb
 = 
NULL
;

1454  
îr
;

1455 
	}
}

1463 c⁄° *
	$∑r£_›í_v¨übÀs
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
«me
)

1465 c⁄° *
íd
, *
id
;

1466 *
¨gs
, *
v¨
;

1467 
¢d_c⁄fig_t
 *
cfg
, *
n
;

1468 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1469 
v«me
[128];

1470 
size_t
 
l
;

1471 
îr
;

1473 
íd
 = 
	`°r°r
(
«me
, ">>>");

1474 i‡(
íd
 =
NULL
)

1475  
«me
;

1476 
l
 = 
íd
 - 
«me
 - 3;

1477 
¨gs
 = 
	`Æloˇ
(
l
 + 1);

1478 
	`°∫˝y
(
¨gs
, 
«me
 + 3, 
l
);

1479 
¨gs
[
l
] = '\0';

1481 
îr
 = 
	`¢d_c⁄fig_lﬂd_°rög
(&
cfg
, 
¨gs
, 0);

1482 i‡(
îr
 < 0) {

1483 
	`uc_îr‹
("îr‹: o≥¿¨gumít†¨ênŸ vÆid (%s)", 
¨gs
);

1484 
skù
;

1488 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1489 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1490 
îr
 = 
	`¢d_c⁄fig_gë_id
(
n
, &
id
);

1491 i‡(
îr
 < 0)

1492 
skù
;

1493 
îr
 = 
	`¢d_c⁄fig_gë_ascii
(
n
, &
v¨
);

1494 i‡(
îr
 < 0)

1495 
skù
;

1496 
	`¢¥ötf
(
v«me
, (v«me), "@%s", 
id
);

1497 
îr
 = 
	`uc_mgr_£t_v¨übÀ
(
uc_mgr
, 
v«me
, 
v¨
);

1498 
	`‰ì
(
v¨
);

1499 i‡(
îr
 < 0)

1500 
skù
;

1503 
skù
:

1504 
	`¢d_c⁄fig_dñëe
(
cfg
);

1505  
íd
 + 3;

1506 
	}
}

1508 
	$¢d_u£_ˇ£_mgr_›í
(
¢d_u£_ˇ£_mgr_t
 **
uc_mgr
,

1509 c⁄° *
ˇrd_«me
)

1511 
¢d_u£_ˇ£_mgr_t
 *
mgr
;

1512 
îr
;

1515 
mgr
 = 
	`ˇŒoc
(1, (
¢d_u£_ˇ£_mgr_t
));

1516 i‡(
mgr
 =
NULL
)

1517  -
ENOMEM
;

1518 
	`INIT_LIST_HEAD
(&
mgr
->
vîb_li°
);

1519 
	`INIT_LIST_HEAD
(&
mgr
->
fixedboŸ_li°
);

1520 
	`INIT_LIST_HEAD
(&
mgr
->
boŸ_li°
);

1521 
	`INIT_LIST_HEAD
(&
mgr
->
deÁu…_li°
);

1522 
	`INIT_LIST_HEAD
(&
mgr
->
vÆue_li°
);

1523 
	`INIT_LIST_HEAD
(&
mgr
->
a˘ive_modifõrs
);

1524 
	`INIT_LIST_HEAD
(&
mgr
->
a˘ive_devi˚s
);

1525 
	`INIT_LIST_HEAD
(&
mgr
->
˘l_li°
);

1526 
	`INIT_LIST_HEAD
(&
mgr
->
v¨übÀ_li°
);

1527 
	`±hªad_muãx_öô
(&
mgr
->
muãx
, 
NULL
);

1529 i‡(
ˇrd_«me
 && *card_name == '-') {

1530 
ˇrd_«me
++;

1531 
mgr
->
suµªss_nodev_îr‹s
 = 1;

1534 i‡(
ˇrd_«me
 && card_name[0] == '<' && card_name[1] == '<' && card_name[2] == '<')

1535 
ˇrd_«me
 = 
	`∑r£_›í_v¨übÀs
(
mgr
, card_name);

1537 
îr
 = 
	`uc_mgr_ˇrd_›í
(
mgr
);

1538 i‡(
îr
 < 0) {

1539 
	`uc_mgr_‰ì
(
mgr
);

1540  
îr
;

1543 
mgr
->
ˇrd_«me
 = 
	`°rdup
(card_name);

1544 i‡(
mgr
->
ˇrd_«me
 =
NULL
) {

1545 
îr
 = -
ENOMEM
;

1546 
_îr
;

1550 
îr
 = 
	`imp‹t_ma°î_c⁄fig
(
mgr
);

1551 i‡(
îr
 < 0) {

1552 i‡(
îr
 =-
ENXIO
 && 
mgr
->
suµªss_nodev_îr‹s
)

1553 
_îr
;

1554 
	`uc_îr‹
("error: failedÅo import %s use case configuration %d",

1555 
ˇrd_«me
, 
îr
);

1556 
_îr
;

1559 
îr
 = 
	`check_em±y_c⁄figuøti⁄
(
mgr
);

1560 i‡(
îr
 < 0) {

1561 
	`uc_îr‹
("îr‹: faûedÅÿimp‹à%†”m±y c⁄figuøti⁄)", 
ˇrd_«me
);

1562 
_îr
;

1565 *
uc_mgr
 = 
mgr
;

1568 
_îr
:

1569 
	`uc_mgr_ˇrd_˛o£
(
mgr
);

1570 
	`uc_mgr_‰ì
(
mgr
);

1571  
îr
;

1572 
	}
}

1574 
	$¢d_u£_ˇ£_mgr_ªlﬂd
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

1576 
îr
;

1578 
	`±hªad_muãx_lock
(&
uc_mgr
->
muãx
);

1580 
	`do_ª£t
(
uc_mgr
);

1582 
	`uc_mgr_‰ì_vîb
(
uc_mgr
);

1584 
uc_mgr
->
deÁu…_li°_execuãd
 = 0;

1587 
îr
 = 
	`imp‹t_ma°î_c⁄fig
(
uc_mgr
);

1588 i‡(
îr
 < 0) {

1589 
	`uc_îr‹
("error: failedÅoÑeload use cases");

1590 
	`±hªad_muãx_u∆ock
(&
uc_mgr
->
muãx
);

1591  -
EINVAL
;

1594 
	`±hªad_muãx_u∆ock
(&
uc_mgr
->
muãx
);

1595  
îr
;

1596 
	}
}

1598 
	$¢d_u£_ˇ£_mgr_˛o£
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

1600 
	`uc_mgr_ˇrd_˛o£
(
uc_mgr
);

1601 
	`uc_mgr_‰ì
(
uc_mgr
);

1604 
	}
}

1609 
	$dism™ée_u£_ˇ£
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

1611 
li°_hód
 *
pos
, *
≈os
;

1612 
u£_ˇ£_modifõr
 *
modifõr
;

1613 
u£_ˇ£_devi˚
 *
devi˚
;

1614 
îr
;

1616 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, &
uc_mgr
->
a˘ive_modifõrs
) {

1617 
modifõr
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_modifõr
,

1618 
a˘ive_li°
);

1619 
îr
 = 
	`£t_modifõr
(
uc_mgr
, 
modifõr
, 0);

1620 i‡(
îr
 < 0)

1621 
	`uc_îr‹
("U«bÀÅÿdißbÀ modifõ∏%s", 
modifõr
->
«me
);

1623 
	`INIT_LIST_HEAD
(&
uc_mgr
->
a˘ive_modifõrs
);

1625 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, &
uc_mgr
->
a˘ive_devi˚s
) {

1626 
devi˚
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_devi˚
,

1627 
a˘ive_li°
);

1628 
îr
 = 
	`£t_devi˚
(
uc_mgr
, 
devi˚
, 0);

1629 i‡(
îr
 < 0)

1630 
	`uc_îr‹
("U«bÀÅÿdißbÀ devi˚ %s", 
devi˚
->
«me
);

1632 
	`INIT_LIST_HEAD
(&
uc_mgr
->
a˘ive_devi˚s
);

1634 
îr
 = 
	`£t_vîb
(
uc_mgr
, uc_mgr->
a˘ive_vîb
, 0);

1635 i‡(
îr
 < 0) {

1636 
	`uc_îr‹
("U«bÀÅÿdißbÀ vîb %s", 
uc_mgr
->
a˘ive_vîb
->
«me
);

1637  
îr
;

1639 
uc_mgr
->
a˘ive_vîb
 = 
NULL
;

1641 
îr
 = 
	`£t_deÁu…s
(
uc_mgr
, 
åue
);

1643  
îr
;

1644 
	}
}

1646 
	$¢d_u£_ˇ£_mgr_ª£t
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

1648 
îr
;

1650 
	`±hªad_muãx_lock
(&
uc_mgr
->
muãx
);

1651 
îr
 = 
	`do_ª£t
(
uc_mgr
);

1652 
	`±hªad_muãx_u∆ock
(&
uc_mgr
->
muãx
);

1653  
îr
;

1654 
	}
}

1661 
	$gë_vîb_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° **
li°
[])

1663  
	`gë_li°2
(&
uc_mgr
->
vîb_li°
, 
li°
,

1664 
u£_ˇ£_vîb
, 
li°
,

1665 
«me
, 
commít
);

1666 
	}
}

1674 
	$gë_devi˚_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° **
li°
[],

1675 *
vîb«me
)

1677 
u£_ˇ£_vîb
 *
vîb
;

1679 i‡(
vîb«me
) {

1680 
vîb
 = 
	`föd_vîb
(
uc_mgr
, 
vîb«me
);

1682 
vîb
 = 
uc_mgr
->
a˘ive_vîb
;

1684 i‡(
vîb
 =
NULL
)

1685  -
ENOENT
;

1686  
	`gë_li°2
(&
vîb
->
devi˚_li°
, 
li°
,

1687 
u£_ˇ£_devi˚
, 
li°
,

1688 
«me
, 
commít
);

1689 
	}
}

1697 
	$gë_modifõr_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° **
li°
[],

1698 *
vîb«me
)

1700 
u£_ˇ£_vîb
 *
vîb
;

1701 i‡(
vîb«me
) {

1702 
vîb
 = 
	`föd_vîb
(
uc_mgr
, 
vîb«me
);

1704 
vîb
 = 
uc_mgr
->
a˘ive_vîb
;

1706 i‡(
vîb
 =
NULL
)

1707  -
ENOENT
;

1708  
	`gë_li°2
(&
vîb
->
modifõr_li°
, 
li°
,

1709 
u£_ˇ£_modifõr
, 
li°
,

1710 
«me
, 
commít
);

1711 
	}
}

1720 
	$gë_supc⁄_devi˚_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1721 c⁄° **
li°
[], *
«me
,

1722 
dev_li°_ty≥
 
ty≥
)

1724 *
°r
;

1725 
u£_ˇ£_vîb
 *
vîb
;

1726 
u£_ˇ£_modifõr
 *
modifõr
;

1727 
u£_ˇ£_devi˚
 *
devi˚
;

1729 i‡(!
«me
)

1730  -
ENOENT
;

1732 
°r
 = 
	`°rchr
(
«me
, '/');

1733 i‡(
°r
) {

1734 *
°r
 = '\0';

1735 
vîb
 = 
	`föd_vîb
(
uc_mgr
, 
°r
 + 1);

1738 
vîb
 = 
uc_mgr
->
a˘ive_vîb
;

1740 i‡(!
vîb
)

1741  -
ENOENT
;

1743 
modifõr
 = 
	`föd_modifõr
(
uc_mgr
, 
vîb
, 
«me
, 0);

1744 i‡(
modifõr
) {

1745 i‡(
modifõr
->
dev_li°
.
ty≥
 !=Åype) {

1746 *
li°
 = 
NULL
;

1749  
	`gë_li°
(&
modifõr
->
dev_li°
.
li°
,Üist,

1750 
dev_li°_node
, 
li°
,

1751 
«me
);

1754 
devi˚
 = 
	`föd_devi˚
(
uc_mgr
, 
vîb
, 
«me
, 0);

1755 i‡(
devi˚
) {

1756 i‡(
devi˚
->
dev_li°
.
ty≥
 !=Åype) {

1757 *
li°
 = 
NULL
;

1760  
	`gë_li°
(&
devi˚
->
dev_li°
.
li°
,Üist,

1761 
dev_li°_node
, 
li°
,

1762 
«me
);

1765  -
ENOENT
;

1766 
	}
}

1774 
	$gë_suµ‹ãd_devi˚_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1775 c⁄° **
li°
[], *
«me
)

1777  
	`gë_supc⁄_devi˚_li°
(
uc_mgr
, 
li°
, 
«me
, 
DEVLIST_SUPPORTED
);

1778 
	}
}

1786 
	$gë_c⁄Êi˘ög_devi˚_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1787 c⁄° **
li°
[], *
«me
)

1789  
	`gë_supc⁄_devi˚_li°
(
uc_mgr
, 
li°
, 
«me
, 
DEVLIST_CONFLICTING
);

1790 
	}
}

1792 #i‚de‡
DOC_HIDDEN


1793 
	smyvÆue
 {

1794 
li°_hód
 
	mli°
;

1795 c⁄° *
	mãxt
;

1805 
	$myvÆue_to_°r_li°
(
li°_hód
 *
li°
, ***
ªs
)

1807 
li°_hód
 *
pos
;

1808 
myvÆue
 *
vÆue
;

1809 **
p
;

1810 
˙t
;

1812 
˙t
 = 
	`Æloc_°r_li°
(
li°
, 1, 
ªs
);

1813 i‡(
˙t
 < 0)

1814  
˙t
;

1815 
p
 = *
ªs
;

1816 
	`li°_f‹_óch
(
pos
, 
li°
) {

1817 
vÆue
 = 
	`li°_íåy
(
pos
, 
myvÆue
, 
li°
);

1818 *
p
 = 
	`°rdup
(
vÆue
->
ãxt
);

1819 i‡(*
p
 =
NULL
) {

1820 
	`¢d_u£_ˇ£_‰ì_li°
((c⁄° **)
p
, 
˙t
);

1821  -
ENOMEM
;

1823 
p
++;

1825  
˙t
;

1826 
	}
}

1832 
	$myvÆue_li°_‰ì
(
li°_hód
 *
li°
)

1834 
li°_hód
 *
pos
, *
≈os
;

1835 
myvÆue
 *
vÆue
;

1837 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, 
li°
) {

1838 
vÆue
 = 
	`li°_íåy
(
pos
, 
myvÆue
, 
li°
);

1839 
	`li°_dñ
(&
vÆue
->
li°
);

1840 
	`‰ì
(
vÆue
);

1842 
	}
}

1850 
	$mîge_vÆue
(
li°_hód
 *
li°
, c⁄° *
ãxt
)

1852 
li°_hód
 *
pos
;

1853 
myvÆue
 *
vÆue
;

1855 
	`li°_f‹_óch
(
pos
, 
li°
) {

1856 
vÆue
 = 
	`li°_íåy
(
pos
, 
myvÆue
, 
li°
);

1857 i‡(
	`°rcmp
(
vÆue
->
ãxt
,Åext) == 0)

1860 
vÆue
 = 
	`mÆloc
((*value));

1861 i‡(
vÆue
 =
NULL
)

1862  -
ENOMEM
;

1863 
vÆue
->
ãxt
 =Åext;

1864 
	`li°_add_èû
(&
vÆue
->
li°
,Üist);

1866 
	}
}

1874 
	$add_idítifõrs
(
li°_hód
 *
li°
,

1875 
li°_hód
 *
sour˚
)

1877 
ucm_vÆue
 *
v
;

1878 
li°_hód
 *
pos
;

1879 
îr
;

1881 
	`li°_f‹_óch
(
pos
, 
sour˚
) {

1882 
v
 = 
	`li°_íåy
(
pos
, 
ucm_vÆue
, 
li°
);

1883 
îr
 = 
	`mîge_vÆue
(
li°
, 
v
->
«me
);

1884 i‡(
îr
 < 0)

1885  
îr
;

1888 
	}
}

1896 
	$add_vÆues
(
li°_hód
 *
li°
,

1897 c⁄° *
idítifõr
,

1898 
li°_hód
 *
sour˚
)

1900 
ucm_vÆue
 *
v
;

1901 
li°_hód
 *
pos
;

1902 
îr
;

1904 
	`li°_f‹_óch
(
pos
, 
sour˚
) {

1905 
v
 = 
	`li°_íåy
(
pos
, 
ucm_vÆue
, 
li°
);

1906 i‡(
	`check_idítifõr
(
idítifõr
, 
v
->
«me
)) {

1907 
îr
 = 
	`mîge_vÆue
(
li°
, 
v
->
d©a
);

1908 i‡(
îr
 < 0)

1909  
îr
;

1913 
	}
}

1918 
	$idítifõr_cmp
(c⁄° *
_a
, c⁄° *
_b
)

1920 c⁄° * c⁄° *
a
 = 
_a
;

1921 c⁄° * c⁄° *
b
 = 
_b
;

1922  
	`°rcmp
(*
a
, *
b
);

1923 
	}
}

1931 
	$gë_idítifõrs_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1932 c⁄° **
li°
[], *
«me
)

1934 
u£_ˇ£_vîb
 *
vîb
;

1935 
u£_ˇ£_modifõr
 *
modifõr
;

1936 
u£_ˇ£_devi˚
 *
devi˚
;

1937 
li°_hód
 
myli°
;

1938 
li°_hód
 *
vÆue_li°
;

1939 *
°r
, **
ªs
;

1940 
îr
;

1942 i‡(!
«me
)

1943  -
ENOENT
;

1945 
°r
 = 
	`°rchr
(
«me
, '/');

1946 i‡(
°r
) {

1947 *
°r
 = '\0';

1948 
vîb
 = 
	`föd_vîb
(
uc_mgr
, 
°r
 + 1);

1951 
vîb
 = 
uc_mgr
->
a˘ive_vîb
;

1953 i‡(!
vîb
)

1954  -
ENOENT
;

1956 
vÆue_li°
 = 
NULL
;

1957 
modifõr
 = 
	`föd_modifõr
(
uc_mgr
, 
vîb
, 
«me
, 0);

1958 i‡(
modifõr
) {

1959 
vÆue_li°
 = &
modifõr
->value_list;

1961 
devi˚
 = 
	`föd_devi˚
(
uc_mgr
, 
vîb
, 
«me
, 0);

1962 i‡(
devi˚
)

1963 
vÆue_li°
 = &
devi˚
->value_list;

1965 i‡(
vÆue_li°
 =
NULL
)

1966  -
ENOENT
;

1968 
	`INIT_LIST_HEAD
(&
myli°
);

1969 
îr
 = 
	`add_idítifõrs
(&
myli°
, &
uc_mgr
->
vÆue_li°
);

1970 i‡(
îr
 < 0)

1971 
__Áû
;

1972 
îr
 = 
	`add_idítifõrs
(&
myli°
, &
vîb
->
vÆue_li°
);

1973 i‡(
îr
 < 0)

1974 
__Áû
;

1975 
îr
 = 
	`add_idítifõrs
(&
myli°
, 
vÆue_li°
);

1976 i‡(
îr
 < 0)

1977 
__Áû
;

1978 
îr
 = 
	`myvÆue_to_°r_li°
(&
myli°
, &
ªs
);

1979 i‡(
îr
 > 0)

1980 *
li°
 = (c⁄° **)
ªs
;

1981 i‡(
îr
 == 0)

1982 *
li°
 = 
NULL
;

1983 
__Áû
:

1984 
	`myvÆue_li°_‰ì
(&
myli°
);

1985 i‡(
îr
 <= 0)

1986  
îr
;

1987 
	`qs‹t
(*
li°
, 
îr
, (*), 
idítifõr_cmp
);

1988  
îr
;

1989 
	}
}

1997 
	$gë_vÆue_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1998 c⁄° *
idítifõr
,

1999 c⁄° **
li°
[],

2000 *
vîb«me
)

2002 
li°_hód
 
myli°
, *
pos
;

2003 
u£_ˇ£_vîb
 *
vîb
;

2004 
u£_ˇ£_devi˚
 *
dev
;

2005 
u£_ˇ£_modifõr
 *
mod
;

2006 **
ªs
;

2007 
îr
;

2009 i‡(
vîb«me
) {

2010 
vîb
 = 
	`föd_vîb
(
uc_mgr
, 
vîb«me
);

2012 
vîb
 = 
uc_mgr
->
a˘ive_vîb
;

2014 i‡(
vîb
 =
NULL
)

2015  -
ENOENT
;

2016 
	`INIT_LIST_HEAD
(&
myli°
);

2017 
îr
 = 
	`add_vÆues
(&
myli°
, 
idítifõr
, &
uc_mgr
->
vÆue_li°
);

2018 i‡(
îr
 < 0)

2019 
__Áû
;

2020 
îr
 = 
	`add_vÆues
(&
myli°
, 
idítifõr
, &
vîb
->
vÆue_li°
);

2021 i‡(
îr
 < 0)

2022 
__Áû
;

2023 
	`li°_f‹_óch
(
pos
, &
vîb
->
devi˚_li°
) {

2024 
dev
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_devi˚
, 
li°
);

2025 
îr
 = 
	`add_vÆues
(&
myli°
, 
idítifõr
, &
dev
->
vÆue_li°
);

2026 i‡(
îr
 < 0)

2027 
__Áû
;

2029 
	`li°_f‹_óch
(
pos
, &
vîb
->
modifõr_li°
) {

2030 
mod
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_modifõr
, 
li°
);

2031 
îr
 = 
	`add_vÆues
(&
myli°
, 
idítifõr
, &
mod
->
vÆue_li°
);

2032 i‡(
îr
 < 0)

2033 
__Áû
;

2035 
îr
 = 
	`myvÆue_to_°r_li°
(&
myli°
, &
ªs
);

2036 i‡(
îr
 > 0)

2037 *
li°
 = (c⁄° **)
ªs
;

2038 i‡(
îr
 == 0)

2039 *
li°
 = 
NULL
;

2040 
__Áû
:

2041 
	`myvÆue_li°_‰ì
(&
myli°
);

2042  
îr
;

2043 
	}
}

2051 
	$gë_íabÀd_devi˚_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2052 c⁄° **
li°
[])

2054 i‡(
uc_mgr
->
a˘ive_vîb
 =
NULL
)

2055  -
EINVAL
;

2056  
	`gë_li°
(&
uc_mgr
->
a˘ive_devi˚s
, 
li°
,

2057 
u£_ˇ£_devi˚
, 
a˘ive_li°
,

2058 
«me
);

2059 
	}
}

2067 
	$gë_íabÀd_modifõr_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2068 c⁄° **
li°
[])

2070 i‡(
uc_mgr
->
a˘ive_vîb
 =
NULL
)

2071  -
EINVAL
;

2072  
	`gë_li°
(&
uc_mgr
->
a˘ive_modifõrs
, 
li°
,

2073 
u£_ˇ£_modifõr
, 
a˘ive_li°
,

2074 
«me
);

2075 
	}
}

2077 
	$¢d_u£_ˇ£_gë_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2078 c⁄° *
idítifõr
,

2079 c⁄° **
li°
[])

2081 *
°r
, *
°r1
;

2082 
îr
;

2084 i‡(
uc_mgr
 =
NULL
 || 
idítifõr
 == NULL)

2085  
	`uc_mgr_sˇn_ma°î_c⁄figs
(
li°
);

2086 
	`±hªad_muãx_lock
(&
uc_mgr
->
muãx
);

2087 i‡(
	`°rcmp
(
idítifõr
, "_verbs") == 0)

2088 
îr
 = 
	`gë_vîb_li°
(
uc_mgr
, 
li°
);

2089 i‡(
	`°rcmp
(
idítifõr
, "_enadevs") == 0)

2090 
îr
 = 
	`gë_íabÀd_devi˚_li°
(
uc_mgr
, 
li°
);

2091 i‡(
	`°rcmp
(
idítifõr
, "_enamods") == 0)

2092 
îr
 = 
	`gë_íabÀd_modifõr_li°
(
uc_mgr
, 
li°
);

2094 
°r1
 = 
	`°rchr
(
idítifõr
, '/');

2095 i‡(
°r1
) {

2096 
°r
 = 
	`°rdup
(
°r1
 + 1);

2097 i‡(
°r
 =
NULL
) {

2098 
îr
 = -
ENOMEM
;

2099 
__íd
;

2102 
°r
 = 
NULL
;

2104 i‡(
	`check_idítifõr
(
idítifõr
, "_devices"))

2105 
îr
 = 
	`gë_devi˚_li°
(
uc_mgr
, 
li°
, 
°r
);

2106 i‡(
	`check_idítifõr
(
idítifõr
, "_modifiers"))

2107 
îr
 = 
	`gë_modifõr_li°
(
uc_mgr
, 
li°
, 
°r
);

2108 i‡(
	`check_idítifõr
(
idítifõr
, "_identifiers"))

2109 
îr
 = 
	`gë_idítifõrs_li°
(
uc_mgr
, 
li°
, 
°r
);

2110 i‡(
	`check_idítifõr
(
idítifõr
, "_supporteddevs"))

2111 
îr
 = 
	`gë_suµ‹ãd_devi˚_li°
(
uc_mgr
, 
li°
, 
°r
);

2112 i‡(
	`check_idítifõr
(
idítifõr
, "_conflictingdevs"))

2113 
îr
 = 
	`gë_c⁄Êi˘ög_devi˚_li°
(
uc_mgr
, 
li°
, 
°r
);

2114 i‡(
idítifõr
[0] == '_')

2115 
îr
 = -
ENOENT
;

2117 
îr
 = 
	`gë_vÆue_li°
(
uc_mgr
, 
idítifõr
, 
li°
, 
°r
);

2118 i‡(
°r
)

2119 
	`‰ì
(
°r
);

2121 
__íd
:

2122 
	`±hªad_muãx_u∆ock
(&
uc_mgr
->
muãx
);

2123  
îr
;

2124 
	}
}

2126 
	$gë_vÆue1
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, **
vÆue
,

2127 
li°_hód
 *
vÆue_li°
, c⁄° *
idítifõr
)

2129 
ucm_vÆue
 *
vÆ
;

2130 
li°_hód
 *
pos
;

2131 
îr
;

2133 i‡(!
vÆue_li°
)

2134  -
ENOENT
;

2136 
	`li°_f‹_óch
(
pos
, 
vÆue_li°
) {

2137 
vÆ
 = 
	`li°_íåy
(
pos
, 
ucm_vÆue
, 
li°
);

2138 i‡(
	`check_idítifõr
(
idítifõr
, 
vÆ
->
«me
)) {

2139 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 2) {

2140 *
vÆue
 = 
	`°rdup
(
vÆ
->
d©a
);

2141 i‡(*
vÆue
 =
NULL
)

2142  -
ENOMEM
;

2145 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, 
vÆue
, 
vÆ
->
d©a
);

2146 i‡(
îr
 < 0)

2147  
îr
;

2148  
	`ªwrôe_devi˚_vÆue
(
uc_mgr
, 
vÆ
->
«me
, 
vÆue
);

2151  -
ENOENT
;

2152 
	}
}

2154 
	$gë_vÆue3
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2155 **
vÆue
,

2156 c⁄° *
idítifõr
,

2157 
li°_hód
 *
vÆue_li°1
,

2158 
li°_hód
 *
vÆue_li°2
,

2159 
li°_hód
 *
vÆue_li°3
)

2161 
îr
;

2163 
îr
 = 
	`gë_vÆue1
(
uc_mgr
, 
vÆue
, 
vÆue_li°1
, 
idítifõr
);

2164 i‡(
îr
 >0 ||Éº !-
ENOENT
)

2165  
îr
;

2166 
îr
 = 
	`gë_vÆue1
(
uc_mgr
, 
vÆue
, 
vÆue_li°2
, 
idítifõr
);

2167 i‡(
îr
 >0 ||Éº !-
ENOENT
)

2168  
îr
;

2169 
îr
 = 
	`gë_vÆue1
(
uc_mgr
, 
vÆue
, 
vÆue_li°3
, 
idítifõr
);

2170 i‡(
îr
 >0 ||Éº !-
ENOENT
)

2171  
îr
;

2172  -
ENOENT
;

2173 
	}
}

2183 
	$gë_vÆue
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2184 c⁄° *
idítifõr
,

2185 **
vÆue
,

2186 c⁄° *
mod_dev_«me
,

2187 c⁄° *
vîb_«me
,

2188 
exa˘
)

2190 
u£_ˇ£_vîb
 *
vîb
;

2191 
u£_ˇ£_modifõr
 *
mod
;

2192 
u£_ˇ£_devi˚
 *
dev
;

2193 
îr
;

2195 i‡(
mod_dev_«me
 || 
vîb_«me
 || !
exa˘
) {

2196 i‡(
vîb_«me
 && 
	`°æí
(verb_name)) {

2197 
vîb
 = 
	`föd_vîb
(
uc_mgr
, 
vîb_«me
);

2199 
vîb
 = 
uc_mgr
->
a˘ive_vîb
;

2201 i‡(
vîb
) {

2202 i‡(
mod_dev_«me
) {

2203 
mod
 = 
	`föd_modifõr
(
uc_mgr
, 
vîb
,

2204 
mod_dev_«me
, 0);

2205 i‡(
mod
) {

2206 
îr
 = 
	`gë_vÆue1
(
uc_mgr
, 
vÆue
,

2207 &
mod
->
vÆue_li°
,

2208 
idítifõr
);

2209 i‡(
îr
 >0 ||Éº !-
ENOENT
)

2210  
îr
;

2213 
dev
 = 
	`föd_devi˚
(
uc_mgr
, 
vîb
,

2214 
mod_dev_«me
, 0);

2215 i‡(
dev
) {

2216 
îr
 = 
	`gë_vÆue1
(
uc_mgr
, 
vÆue
,

2217 &
dev
->
vÆue_li°
,

2218 
idítifõr
);

2219 i‡(
îr
 >0 ||Éº !-
ENOENT
)

2220  
îr
;

2223 i‡(
exa˘
)

2224  -
ENOENT
;

2227 
îr
 = 
	`gë_vÆue1
(
uc_mgr
, 
vÆue
, &
vîb
->
vÆue_li°
, 
idítifõr
);

2228 i‡(
îr
 >0 ||Éº !-
ENOENT
)

2229  
îr
;

2232 i‡(
exa˘
)

2233  -
ENOENT
;

2236 
îr
 = 
	`gë_vÆue1
(
uc_mgr
, 
vÆue
, &uc_mgr->
vÆue_li°
, 
idítifõr
);

2237 i‡(
îr
 >0 ||Éº !-
ENOENT
)

2238  
îr
;

2240  -
ENOENT
;

2241 
	}
}

2249 
	$gë_Æibcfg
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, **
°r
)

2251 
¢d_ouçut_t
 *
out
;

2252 
size_t
 
size
;

2253 
îr
;

2255 
îr
 = 
	`¢d_ouçut_buf„r_›í
(&
out
);

2256 i‡(
îr
 < 0)

2257  
îr
;

2258 
îr
 = 
	`¢d_c⁄fig_ßve
(
uc_mgr
->
loˇl_c⁄fig
, 
out
);

2259 i‡(
îr
 >= 0) {

2260 
size
 = 
	`¢d_ouçut_buf„r_°ól
(
out
, 
°r
);

2261 i‡(*
°r
)

2262 (*
°r
)[
size
] = '\0';

2264 
	`¢d_ouçut_˛o£
(
out
);

2266 
	}
}

2274 
	$gë_Æib¥ef
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, **
°r
)

2276 c⁄° 
size_t
 
l
 = 10;

2277 *
s
;

2279 
s
 = 
	`mÆloc
(
l
);

2280 i‡(
s
 =
NULL
)

2281  -
ENOMEM
;

2282 
	`¢¥ötf
(
s
, 
l
, "_ucm%04X.", 
uc_mgr
->
ucm_ˇrd_numbî
);

2283 *
°r
 = 
s
;

2285 
	}
}

2287 
	$¢d_u£_ˇ£_gë
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2288 c⁄° *
idítifõr
,

2289 c⁄° **
vÆue
)

2291 c⁄° *
¶ash1
, *
¶ash2
, *
mod_dev_a·î
;

2292 c⁄° *
idít
, *
mod_dev
, *
vîb
;

2293 
exa˘
 = 0;

2294 
îr
;

2296 
	`±hªad_muãx_lock
(&
uc_mgr
->
muãx
);

2297 i‡(
idítifõr
 =
NULL
) {

2298 *
vÆue
 = 
	`°rdup
(
uc_mgr
->
ˇrd_«me
);

2299 i‡(*
vÆue
 =
NULL
) {

2300 
îr
 = -
ENOMEM
;

2301 
__íd
;

2303 
îr
 = 0;

2304 } i‡(
	`°rcmp
(
idítifõr
, "_verb") == 0) {

2305 i‡(
uc_mgr
->
a˘ive_vîb
 =
NULL
) {

2306 
îr
 = -
ENOENT
;

2307 
__íd
;

2309 *
vÆue
 = 
	`°rdup
(
uc_mgr
->
a˘ive_vîb
->
«me
);

2310 i‡(*
vÆue
 =
NULL
) {

2311 
îr
 = -
ENOMEM
;

2312 
__íd
;

2314 
îr
 = 0;

2315 } i‡(
	`°rcmp
(
idítifõr
, "_file") == 0) {

2317 i‡((
uc_mgr
->
ˇrd_«me
 =
NULL
) ||

2318 (
uc_mgr
->
c⁄f_fûe_«me
 =
NULL
) ||

2319 (
uc_mgr
->
c⁄f_fûe_«me
[0] == '\0')) {

2320 
îr
 = -
ENOENT
;

2321 
__íd
;

2323 *
vÆue
 = 
	`°rdup
(
uc_mgr
->
c⁄f_fûe_«me
);

2324 i‡(*
vÆue
 =
NULL
) {

2325 
îr
 = -
ENOMEM
;

2326 
__íd
;

2328 
îr
 = 0;

2330 } i‡(
	`°rcmp
(
idítifõr
, "_alibcfg") == 0) {

2331 
îr
 = 
	`gë_Æibcfg
(
uc_mgr
, (**)
vÆue
);

2332 } i‡(
	`°rcmp
(
idítifõr
, "_alibpref") == 0) {

2333 
îr
 = 
	`gë_Æib¥ef
(
uc_mgr
, (**)
vÆue
);

2334 } i‡(
idítifõr
[0] == '_') {

2335 
îr
 = -
ENOENT
;

2337 i‡(
idítifõr
[0] == '=') {

2338 
exa˘
 = 1;

2339 
idítifõr
++;

2342 
¶ash1
 = 
	`°rchr
(
idítifõr
, '/');

2343 i‡(
¶ash1
) {

2344 
idít
 = 
	`°∫dup
(
idítifõr
, 
¶ash1
 - identifier);

2346 
¶ash2
 = 
	`°rchr
(
¶ash1
 + 1, '/');

2347 i‡(
¶ash2
) {

2348 
mod_dev_a·î
 = 
¶ash2
;

2349 
vîb
 = 
¶ash2
 + 1;

2352 
mod_dev_a·î
 = 
¶ash1
 + 
	`°æí
(slash1);

2353 
vîb
 = 
NULL
;

2356 i‡(
mod_dev_a·î
 =
¶ash1
 + 1)

2357 
mod_dev
 = 
NULL
;

2359 
mod_dev
 = 
	`°∫dup
(
¶ash1
 + 1,

2360 
mod_dev_a·î
 - (
¶ash1
 + 1));

2363 
idít
 = 
idítifõr
;

2364 
mod_dev
 = 
NULL
;

2365 
vîb
 = 
NULL
;

2368 
îr
 = 
	`gë_vÆue
(
uc_mgr
, 
idít
, (**)
vÆue
, 
mod_dev
, 
vîb
,

2369 
exa˘
);

2370 i‡(
idít
 !
idítifõr
)

2371 
	`‰ì
((*)
idít
);

2372 i‡(
mod_dev
)

2373 
	`‰ì
((*)
mod_dev
);

2375 
__íd
:

2376 
	`±hªad_muãx_u∆ock
(&
uc_mgr
->
muãx
);

2377  
îr
;

2378 
	}
}

2383 
	#gëi
(
uc_mgr
, 
°©us
, 
iföd
, 
°r
, 
vÆue
) ({ \

2384 
vÆ
 = -
EINVAL
; \

2385 i‡(
°r
) { \

2386 
vÆ
 = (
°©us
)((
uc_mgr
), (
°r
)); \

2387 i‡(
vÆ
 >= 0) { \

2388 i‡((
iföd
)((
uc_mgr
), (uc_mgr)->
a˘ive_vîb
, (
°r
), 0)) { \

2389 *(
vÆue
Ë
vÆ
; \

2390 
vÆ
 = 0; \

2392 
vÆ
 = -
ENOENT
; \

2396 ; 
vÆ
; \

2397 })

	)

2399 
	$¢d_u£_ˇ£_gëi
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2400 c⁄° *
idítifõr
,

2401 *
vÆue
)

2403 *
°r
, *
°r1
;

2404 
îr
;

2406 
	`±hªad_muãx_lock
(&
uc_mgr
->
muãx
);

2410 
°r1
 = 
	`°rchr
(
idítifõr
, '/');

2411 i‡(
°r1
) {

2412 
°r
 = 
	`°rdup
(
°r1
 + 1);

2413 i‡(
°r
 =
NULL
) {

2414 
îr
 = -
ENOMEM
;

2415 
__íd
;

2418 
°r
 = 
NULL
;

2420 i‡(
	`check_idítifõr
(
idítifõr
, "_devstatus")) {

2421 
îr
 = 
	`gëi
(
uc_mgr
, 
devi˚_°©us
, 
föd_devi˚
, 
°r
, 
vÆue
);

2422 } i‡(
	`check_idítifõr
(
idítifõr
, "_modstatus")) {

2423 
îr
 = 
	`gëi
(
uc_mgr
, 
modifõr_°©us
, 
föd_modifõr
, 
°r
, 
vÆue
);

2429 } i‡(
idítifõr
[0] == '_') {

2430 
îr
 = -
ENOENT
;

2433 
îr
 = -
ENOENT
;

2434 i‡(
°r
)

2435 
	`‰ì
(
°r
);

2437 
__íd
:

2438 
	`±hªad_muãx_u∆ock
(&
uc_mgr
->
muãx
);

2439  
îr
;

2440 
	}
}

2442 
	$£t_fixedboŸ_u£r
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2443 c⁄° *
vÆue
)

2445 
îr
;

2447 i‡(
vÆue
 !
NULL
 && *value) {

2448 
	`uc_îr‹
("îr‹: wr⁄g vÆuêf‹ _fboŸ (%s)", 
vÆue
);

2449  -
EINVAL
;

2451 i‡(
	`li°_em±y
(&
uc_mgr
->
fixedboŸ_li°
))

2452  -
ENOENT
;

2453 
îr
 = 
	`execuã_£quí˚
(
uc_mgr
, 
NULL
, &uc_mgr->
fixedboŸ_li°
,

2454 &
uc_mgr
->
vÆue_li°
, 
NULL
, NULL);

2455 i‡(
îr
 < 0) {

2456 
	`uc_îr‹
("UnableÅoÉxecute force boot sequence");

2457  
îr
;

2459  
îr
;

2460 
	}
}

2462 
	$£t_boŸ_u£r
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2463 c⁄° *
vÆue
)

2465 
îr
;

2467 i‡(
vÆue
 !
NULL
 && *value) {

2468 
	`uc_îr‹
("îr‹: wr⁄g vÆuêf‹ _boŸ (%s)", 
vÆue
);

2469  -
EINVAL
;

2471 i‡(
	`li°_em±y
(&
uc_mgr
->
boŸ_li°
))

2472  -
ENOENT
;

2473 
îr
 = 
	`execuã_£quí˚
(
uc_mgr
, 
NULL
, &uc_mgr->
boŸ_li°
,

2474 &
uc_mgr
->
vÆue_li°
, 
NULL
, NULL);

2475 i‡(
îr
 < 0) {

2476 
	`uc_îr‹
("UnableÅoÉxecute boot sequence");

2477  
îr
;

2479  
îr
;

2480 
	}
}

2482 
	$£t_deÁu…s_u£r
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2483 c⁄° *
vÆue
)

2485 i‡(
vÆue
 !
NULL
 && *value) {

2486 
	`uc_îr‹
("îr‹: wr⁄g vÆuêf‹ _deÁu…†(%s)", 
vÆue
);

2487  -
EINVAL
;

2489  
	`£t_deÁu…s
(
uc_mgr
, 
Ál£
);

2490 
	}
}

2492 
	$h™dÀ_å™sôi⁄_vîb
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2493 
u£_ˇ£_vîb
 *
√w_vîb
)

2495 
li°_hód
 *
pos
;

2496 
å™sôi⁄_£quí˚
 *
å™s
;

2497 
îr
;

2499 
	`li°_f‹_óch
(
pos
, &
uc_mgr
->
a˘ive_vîb
->
å™sôi⁄_li°
) {

2500 
å™s
 = 
	`li°_íåy
(
pos
, 
å™sôi⁄_£quí˚
, 
li°
);

2501 i‡(
	`°rcmp
(
å™s
->
«me
, 
√w_vîb
->name) == 0) {

2502 
îr
 = 
	`execuã_£quí˚
(
uc_mgr
, uc_mgr->
a˘ive_vîb
,

2503 &
å™s
->
å™sôi⁄_li°
,

2504 &
uc_mgr
->
a˘ive_vîb
->
vÆue_li°
,

2505 &
uc_mgr
->
vÆue_li°
,

2506 
NULL
);

2507 i‡(
îr
 >= 0)

2509  
îr
;

2513 
	}
}

2515 
	$£t_vîb_u£r
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2516 c⁄° *
vîb_«me
)

2518 
u£_ˇ£_vîb
 *
vîb
;

2519 
îr
 = 0;

2521 i‡(
uc_mgr
->
a˘ive_vîb
 &&

2522 
	`°rcmp
(
uc_mgr
->
a˘ive_vîb
->
«me
, 
vîb_«me
) == 0)

2524 i‡(
	`°rcmp
(
vîb_«me
, 
SND_USE_CASE_VERB_INACTIVE
) != 0) {

2525 
vîb
 = 
	`föd_vîb
(
uc_mgr
, 
vîb_«me
);

2526 i‡(
vîb
 =
NULL
)

2527  -
ENOENT
;

2529 
vîb
 = 
NULL
;

2531 i‡(
uc_mgr
->
a˘ive_vîb
) {

2532 
îr
 = 
	`h™dÀ_å™sôi⁄_vîb
(
uc_mgr
, 
vîb
);

2533 i‡(
îr
 == 0) {

2534 
îr
 = 
	`dism™ée_u£_ˇ£
(
uc_mgr
);

2535 i‡(
îr
 < 0)

2536  
îr
;

2537 } i‡(
îr
 == 1) {

2538 
uc_mgr
->
a˘ive_vîb
 = 
vîb
;

2539 
vîb
 = 
NULL
;

2541 
vîb
 = 
NULL
;

2544 i‡(
vîb
) {

2545 
îr
 = 
	`£t_vîb
(
uc_mgr
, 
vîb
, 1);

2546 i‡(
îr
 < 0)

2547 
	`uc_îr‹
("error: failedÅo initializeÇew use case: %s",

2548 
vîb_«me
);

2550  
îr
;

2551 
	}
}

2554 
	$£t_devi˚_u£r
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2555 c⁄° *
devi˚_«me
,

2556 
íabÀ
)

2558 
u£_ˇ£_devi˚
 *
devi˚
;

2560 i‡(
uc_mgr
->
a˘ive_vîb
 =
NULL
)

2561  -
ENOENT
;

2562 
devi˚
 = 
	`föd_devi˚
(
uc_mgr
, uc_mgr->
a˘ive_vîb
, 
devi˚_«me
, 1);

2563 i‡(
devi˚
 =
NULL
)

2564  -
ENOENT
;

2565  
	`£t_devi˚
(
uc_mgr
, 
devi˚
, 
íabÀ
);

2566 
	}
}

2568 
	$£t_modifõr_u£r
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2569 c⁄° *
modifõr_«me
,

2570 
íabÀ
)

2572 
u£_ˇ£_modifõr
 *
modifõr
;

2574 i‡(
uc_mgr
->
a˘ive_vîb
 =
NULL
)

2575  -
ENOENT
;

2577 
modifõr
 = 
	`föd_modifõr
(
uc_mgr
, uc_mgr->
a˘ive_vîb
, 
modifõr_«me
, 1);

2578 i‡(
modifõr
 =
NULL
)

2579  -
ENOENT
;

2580  
	`£t_modifõr
(
uc_mgr
, 
modifõr
, 
íabÀ
);

2581 
	}
}

2583 
	$swôch_devi˚
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2584 c⁄° *
ﬁd_devi˚
,

2585 c⁄° *
√w_devi˚
)

2587 
u£_ˇ£_devi˚
 *
xﬁd
, *
x√w
;

2588 
å™sôi⁄_£quí˚
 *
å™s
;

2589 
li°_hód
 *
pos
;

2590 
îr
, 
£q_found
 = 0;

2592 i‡(
uc_mgr
->
a˘ive_vîb
 =
NULL
)

2593  -
ENOENT
;

2594 i‡(
	`devi˚_°©us
(
uc_mgr
, 
ﬁd_devi˚
) == 0) {

2595 
	`uc_îr‹
("îr‹: devi˚ %†nŸÉ«bÀd", 
ﬁd_devi˚
);

2596  -
EINVAL
;

2598 i‡(
	`devi˚_°©us
(
uc_mgr
, 
√w_devi˚
) != 0) {

2599 
	`uc_îr‹
("îr‹: devi˚ %†ÆªadyÉ«bÀd", 
√w_devi˚
);

2600  -
EINVAL
;

2602 
xﬁd
 = 
	`föd_devi˚
(
uc_mgr
, uc_mgr->
a˘ive_vîb
, 
ﬁd_devi˚
, 1);

2603 i‡(
xﬁd
 =
NULL
)

2604  -
ENOENT
;

2605 
	`li°_dñ
(&
xﬁd
->
a˘ive_li°
);

2606 
x√w
 = 
	`föd_devi˚
(
uc_mgr
, uc_mgr->
a˘ive_vîb
, 
√w_devi˚
, 1);

2607 
	`li°_add_èû
(&
xﬁd
->
a˘ive_li°
, &
uc_mgr
->
a˘ive_devi˚s
);

2608 i‡(
x√w
 =
NULL
)

2609  -
ENOENT
;

2610 
îr
 = 0;

2611 
	`li°_f‹_óch
(
pos
, &
xﬁd
->
å™sôi⁄_li°
) {

2612 
å™s
 = 
	`li°_íåy
(
pos
, 
å™sôi⁄_£quí˚
, 
li°
);

2613 i‡(
	`°rcmp
(
å™s
->
«me
, 
√w_devi˚
) == 0) {

2614 
îr
 = 
	`execuã_£quí˚
(
uc_mgr
, uc_mgr->
a˘ive_vîb
,

2615 &
å™s
->
å™sôi⁄_li°
,

2616 &
xﬁd
->
vÆue_li°
,

2617 &
uc_mgr
->
a˘ive_vîb
->
vÆue_li°
,

2618 &
uc_mgr
->
vÆue_li°
);

2619 i‡(
îr
 >= 0) {

2620 
	`li°_dñ
(&
xﬁd
->
a˘ive_li°
);

2621 
	`li°_add_èû
(&
x√w
->
a˘ive_li°
, &
uc_mgr
->
a˘ive_devi˚s
);

2623 
£q_found
 = 1;

2627 i‡(!
£q_found
) {

2628 
îr
 = 
	`£t_devi˚
(
uc_mgr
, 
xﬁd
, 0);

2629 i‡(
îr
 < 0)

2630  
îr
;

2631 
îr
 = 
	`£t_devi˚
(
uc_mgr
, 
x√w
, 1);

2632 i‡(
îr
 < 0)

2633  
îr
;

2635  
îr
;

2636 
	}
}

2638 
	$swôch_modifõr
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2639 c⁄° *
ﬁd_modifõr
,

2640 c⁄° *
√w_modifõr
)

2642 
u£_ˇ£_modifõr
 *
xﬁd
, *
x√w
;

2643 
å™sôi⁄_£quí˚
 *
å™s
;

2644 
li°_hód
 *
pos
;

2645 
îr
, 
£q_found
 = 0;

2647 i‡(
uc_mgr
->
a˘ive_vîb
 =
NULL
)

2648  -
ENOENT
;

2649 i‡(
	`modifõr_°©us
(
uc_mgr
, 
ﬁd_modifõr
) == 0) {

2650 
	`uc_îr‹
("îr‹: modifõ∏%†nŸÉ«bÀd", 
ﬁd_modifõr
);

2651  -
EINVAL
;

2653 i‡(
	`modifõr_°©us
(
uc_mgr
, 
√w_modifõr
) != 0) {

2654 
	`uc_îr‹
("îr‹: modifõ∏%†ÆªadyÉ«bÀd", 
√w_modifõr
);

2655  -
EINVAL
;

2657 
xﬁd
 = 
	`föd_modifõr
(
uc_mgr
, uc_mgr->
a˘ive_vîb
, 
ﬁd_modifõr
, 1);

2658 i‡(
xﬁd
 =
NULL
)

2659  -
ENOENT
;

2660 
x√w
 = 
	`föd_modifõr
(
uc_mgr
, uc_mgr->
a˘ive_vîb
, 
√w_modifõr
, 1);

2661 i‡(
x√w
 =
NULL
)

2662  -
ENOENT
;

2663 
îr
 = 0;

2664 
	`li°_f‹_óch
(
pos
, &
xﬁd
->
å™sôi⁄_li°
) {

2665 
å™s
 = 
	`li°_íåy
(
pos
, 
å™sôi⁄_£quí˚
, 
li°
);

2666 i‡(
	`°rcmp
(
å™s
->
«me
, 
√w_modifõr
) == 0) {

2667 
îr
 = 
	`execuã_£quí˚
(
uc_mgr
, uc_mgr->
a˘ive_vîb
,

2668 &
å™s
->
å™sôi⁄_li°
,

2669 &
xﬁd
->
vÆue_li°
,

2670 &
uc_mgr
->
a˘ive_vîb
->
vÆue_li°
,

2671 &
uc_mgr
->
vÆue_li°
);

2672 i‡(
îr
 >= 0) {

2673 
	`li°_dñ
(&
xﬁd
->
a˘ive_li°
);

2674 
	`li°_add_èû
(&
x√w
->
a˘ive_li°
, &
uc_mgr
->
a˘ive_modifõrs
);

2676 
£q_found
 = 1;

2680 i‡(!
£q_found
) {

2681 
îr
 = 
	`£t_modifõr
(
uc_mgr
, 
xﬁd
, 0);

2682 i‡(
îr
 < 0)

2683  
îr
;

2684 
îr
 = 
	`£t_modifõr
(
uc_mgr
, 
x√w
, 1);

2685 i‡(
îr
 < 0)

2686  
îr
;

2688  
îr
;

2689 
	}
}

2691 
	$¢d_u£_ˇ£_£t
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2692 c⁄° *
idítifõr
,

2693 c⁄° *
vÆue
)

2695 *
°r
, *
°r1
;

2696 
îr
 = 0;

2698 
	`±hªad_muãx_lock
(&
uc_mgr
->
muãx
);

2699 i‡(
	`°rcmp
(
idítifõr
, "_fboot") == 0)

2700 
îr
 = 
	`£t_fixedboŸ_u£r
(
uc_mgr
, 
vÆue
);

2701 i‡(
	`°rcmp
(
idítifõr
, "_boot") == 0)

2702 
îr
 = 
	`£t_boŸ_u£r
(
uc_mgr
, 
vÆue
);

2703 i‡(
	`°rcmp
(
idítifõr
, "_defaults") == 0)

2704 
îr
 = 
	`£t_deÁu…s_u£r
(
uc_mgr
, 
vÆue
);

2705 i‡(
	`°rcmp
(
idítifõr
, "_verb") == 0)

2706 
îr
 = 
	`£t_vîb_u£r
(
uc_mgr
, 
vÆue
);

2707 i‡(
	`°rcmp
(
idítifõr
, "_enadev") == 0)

2708 
îr
 = 
	`£t_devi˚_u£r
(
uc_mgr
, 
vÆue
, 1);

2709 i‡(
	`°rcmp
(
idítifõr
, "_disdev") == 0)

2710 
îr
 = 
	`£t_devi˚_u£r
(
uc_mgr
, 
vÆue
, 0);

2711 i‡(
	`°rcmp
(
idítifõr
, "_enamod") == 0)

2712 
îr
 = 
	`£t_modifõr_u£r
(
uc_mgr
, 
vÆue
, 1);

2713 i‡(
	`°rcmp
(
idítifõr
, "_dismod") == 0)

2714 
îr
 = 
	`£t_modifõr_u£r
(
uc_mgr
, 
vÆue
, 0);

2716 
°r1
 = 
	`°rchr
(
idítifõr
, '/');

2717 i‡(
°r1
) {

2718 
°r
 = 
	`°rdup
(
°r1
 + 1);

2719 i‡(
°r
 =
NULL
) {

2720 
îr
 = -
ENOMEM
;

2721 
__íd
;

2724 
îr
 = -
EINVAL
;

2725 
__íd
;

2727 i‡(
	`check_idítifõr
(
idítifõr
, "_swdev"))

2728 
îr
 = 
	`swôch_devi˚
(
uc_mgr
, 
°r
, 
vÆue
);

2729 i‡(
	`check_idítifõr
(
idítifõr
, "_swmod"))

2730 
îr
 = 
	`swôch_modifõr
(
uc_mgr
, 
°r
, 
vÆue
);

2732 
îr
 = -
EINVAL
;

2733 i‡(
°r
)

2734 
	`‰ì
(
°r
);

2736 
__íd
:

2737 
	`±hªad_muãx_u∆ock
(&
uc_mgr
->
muãx
);

2738  
îr
;

2739 
	}
}

2748 
	$¢d_u£_ˇ£_∑r£_˘l_ñem_id
(
¢d_˘l_ñem_id_t
 *
d°
,

2749 c⁄° *
ucm_id
,

2750 c⁄° *
vÆue
)

2752 
¢d_˘l_ñem_iÁ˚_t
 
iÁ˚
;

2753 
jack_c⁄åﬁ
;

2755 
jack_c⁄åﬁ
 = 
	`°rcmp
(
ucm_id
, "JackControl") == 0;

2756 i‡(!
jack_c⁄åﬁ
 &&

2757 
	`°rcmp
(
ucm_id
, "PlaybackVolume") &&

2758 
	`°rcmp
(
ucm_id
, "PlaybackSwitch") &&

2759 
	`°rcmp
(
ucm_id
, "CaptureVolume") &&

2760 
	`°rcmp
(
ucm_id
, "CaptureSwitch"))

2761  -
EINVAL
;

2762 
	`¢d_˘l_ñem_id_˛ór
(
d°
);

2763 i‡(
	`°rˇ£°r
(
vÆue
, "name="))

2764  
	`__¢d_˘l_ascii_ñem_id_∑r£
(
d°
, 
vÆue
, 
NULL
);

2765 
iÁ˚
 = 
SND_CTL_ELEM_IFACE_MIXER
;

2766 i‡(
jack_c⁄åﬁ
)

2767 
iÁ˚
 = 
SND_CTL_ELEM_IFACE_CARD
;

2768 
	`¢d_˘l_ñem_id_£t_öãrÁ˚
(
d°
, 
iÁ˚
);

2769 
	`¢d_˘l_ñem_id_£t_«me
(
d°
, 
vÆue
);

2771 
	}
}

2780 
	$¢d_u£_ˇ£_∑r£_£Àm_id
(
¢d_mixî_£Àm_id_t
 *
d°
,

2781 c⁄° *
ucm_id
,

2782 c⁄° *
vÆue
)

2784 #ifde‡
BUILD_MIXER


2785 i‡(
	`°rcmp
(
ucm_id
, "PlaybackMixerId") == 0 ||

2786 
	`°rcmp
(
ucm_id
, "CaptureMixerId") == 0)

2787  
	`¢d_mixî_£Àm_id_∑r£
(
d°
, 
vÆue
);

2789  -
EINVAL
;

2790 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/parser.c

33 
	~"ucm_loˇl.h
"

34 
	~<sys/°©.h
>

35 
	~<°dboﬁ.h
>

36 
	~<dúít.h
>

37 
	~<limôs.h
>

39 
fûíame_fûãr
(c⁄° 
dúít64
 *
dúít
);

41 
∑r£_£quí˚
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

42 
li°_hód
 *
ba£
,

43 
¢d_c⁄fig_t
 *
cfg
);

48 
	$ucm_fûíame
(*
‚
, 
size_t
 
‚_Àn
, 
vîsi⁄
,

49 c⁄° *
dú
, c⁄° *
fûe
)

51 c⁄° *
ív
 = 
	`gëív
(
vîsi⁄
 > 1 ? 
ALSA_CONFIG_UCM2_VAR
 : 
ALSA_CONFIG_UCM_VAR
);

53 i‡(
fûe
[0] == '/')

54 
fûe
++;

55 i‡(
ív
 =
NULL
)

56 
	`¢¥ötf
(
‚
, 
‚_Àn
, "%s/%s/%s%s%s",

57 
	`¢d_c⁄fig_t›dú
(), 
vîsi⁄
 > 1 ? "ucm2" : "ucm",

58 
dú
 ?: "", dú ? "/" : "", 
fûe
);

60 
	`¢¥ötf
(
‚
, 
‚_Àn
, "%s/%s%s%s",

61 
ív
, 
dú
 ?: "", dú ? "/" : "", 
fûe
);

62 
	}
}

67 
	$uc_mgr_c⁄fig_lﬂd_fûe
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

68 c⁄° *
fûe
, 
¢d_c⁄fig_t
 **
cfg
)

70 
fûíame
[
PATH_MAX
];

71 
îr
;

73 
	`ucm_fûíame
(
fûíame
, (fûíame), 
uc_mgr
->
c⁄f_f‹m©
,

74 
fûe
[0] ='/' ? 
NULL
 : 
uc_mgr
->
c⁄f_dú_«me
,

75 
fûe
);

76 
îr
 = 
	`uc_mgr_c⁄fig_lﬂd
(
uc_mgr
->
c⁄f_f‹m©
, 
fûíame
, 
cfg
);

77 i‡(
îr
 < 0) {

78 
	`uc_îr‹
("îr‹: faûedÅÿ›í fûê%s: %d", 
fûíame
, 
îr
);

79  
îr
;

82 
	}
}

87 *
	$ª∂a˚_°rög
(**
d°
, c⁄° *
vÆue
)

89 
	`‰ì
(*
d°
);

90 *
d°
 = 
vÆue
 ? 
	`°rdup
(vÆueË: 
NULL
;

91  *
d°
;

92 
	}
}

97 
	$∑r£_°rög
(
¢d_c⁄fig_t
 *
n
, **
ªs
)

99 
îr
;

101 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, (c⁄° **)
ªs
);

102 i‡(
îr
 < 0)

103  
îr
;

104 *
ªs
 = 
	`°rdup
(*res);

105 i‡(*
ªs
 =
NULL
)

106  -
ENOMEM
;

108 
	}
}

113 
	$∑r£_°rög_sub°ôuã
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

114 
¢d_c⁄fig_t
 *
n
, **
ªs
)

116 c⁄° *
°r
;

117 *
s
;

118 
îr
;

120 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
°r
);

121 i‡(
îr
 < 0)

122  
îr
;

123 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s
, 
°r
);

124 i‡(
îr
 >= 0)

125 *
ªs
 = 
s
;

126  
îr
;

127 
	}
}

132 
	$∑r£_°rög_sub°ôuã3
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

133 
¢d_c⁄fig_t
 *
n
, **
ªs
)

135 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 3)

136  
	`∑r£_°rög
(
n
, 
ªs
);

137  
	`∑r£_°rög_sub°ôuã
(
uc_mgr
, 
n
, 
ªs
);

138 
	}
}

143 
	$∑r£_öãgî_sub°ôuã
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

144 
¢d_c⁄fig_t
 *
n
, *
ªs
)

146 *
s1
, *
s2
;

147 
îr
;

149 
îr
 = 
	`¢d_c⁄fig_gë_ascii
(
n
, &
s1
);

150 i‡(
îr
 < 0)

151  
îr
;

152 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s2
, 
s1
);

153 i‡(
îr
 >= 0)

154 
îr
 = 
	`ß„_°πﬁ
(
s2
, 
ªs
);

155 
	`‰ì
(
s2
);

156 
	`‰ì
(
s1
);

157  
îr
;

158 
	}
}

163 
	$∑r£_öãgî_sub°ôuã3
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

164 
¢d_c⁄fig_t
 *
n
, *
ªs
)

166 *
s1
, *
s2
;

167 
îr
;

169 
îr
 = 
	`¢d_c⁄fig_gë_ascii
(
n
, &
s1
);

170 i‡(
îr
 < 0)

171  
îr
;

172 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 3)

173 
s2
 = 
s1
;

175 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s2
, 
s1
);

176 i‡(
îr
 >= 0)

177 
îr
 = 
	`ß„_°πﬁ
(
s2
, 
ªs
);

178 i‡(
s1
 !
s2
)

179 
	`‰ì
(
s2
);

180 
	`‰ì
(
s1
);

181  
îr
;

182 
	}
}

187 
	$∑r£_is_«me_ß„
(c⁄° *
«me
)

189 i‡(
	`°rchr
(
«me
, '.')) {

190 
	`uc_îr‹
("ch¨ '.'ÇŸáŒowed i¿'%s'", 
«me
);

194 
	}
}

196 
	$gë_°rög3
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
s1
, **
s
)

198 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 3) {

199 *
s
 = 
	`°rdup
(
s1
);

200 i‡(*
s
 =
NULL
)

201  -
ENOMEM
;

204  
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, 
s
, 
s1
);

205 
	}
}

207 
	$∑r£_gë_ß„_«me
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
n
,

208 c⁄° *
Æt
, **
«me
)

210 c⁄° *
id
;

211 
îr
;

213 i‡(
Æt
) {

214 
id
 = 
Æt
;

216 
îr
 = 
	`¢d_c⁄fig_gë_id
(
n
, &
id
);

217 i‡(
îr
 < 0)

218  
îr
;

220 
îr
 = 
	`gë_°rög3
(
uc_mgr
, 
id
, 
«me
);

221 i‡(
îr
 < 0)

222  
îr
;

223 i‡(!
	`∑r£_is_«me_ß„
(*
«me
)) {

224 
	`‰ì
(*
«me
);

225  -
EINVAL
;

228 
	}
}

233 
	$îr‹_node
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
cfg
)

235 
îr
;

236 *
s
;

238 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
cfg
, &
s
);

239 i‡(
îr
 < 0) {

240 
	`uc_îr‹
("error: failedÅo get Error string");

241  
îr
;

243 i‡(!
uc_mgr
->
suµªss_nodev_îr‹s
)

244 
	`uc_îr‹
("%s", 
s
);

245 
	`‰ì
(
s
);

246  -
ENXIO
;

247 
	}
}

252 
	$∑r£_sy¡ax_fõld
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

253 
¢d_c⁄fig_t
 *
cfg
, c⁄° *
fûíame
)

255 
¢d_c⁄fig_t
 *
n
;

256 
l
;

257 
îr
;

259 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
cfg
, "Sy¡ax", &
n
);

260 i‡(
îr
 < 0) {

261 
	`uc_îr‹
("Sy¡ax fõldÇŸ found i¿%s", 
fûíame
);

262  -
EINVAL
;

264 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
n
, &
l
);

265 i‡(
îr
 < 0) {

266 
	`uc_îr‹
("Sy¡ax fõld i†övÆid i¿%s", 
fûíame
);

267  
îr
;

269 i‡(
l
 < 2 ||Ü > 
SYNTAX_VERSION_MAX
) {

270 
	`uc_îr‹
("Incom∑tibÀ sy¡ax %ld i¿%s", 
l
, 
fûíame
);

271  -
EINVAL
;

274 
	`¢d_c⁄fig_dñëe
(
n
);

275 
uc_mgr
->
c⁄f_f‹m©
 = 
l
;

276  
l
;

277 
	}
}

282 
	$evÆu©e_ªgex
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

283 
¢d_c⁄fig_t
 *
cfg
)

285 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

286 
¢d_c⁄fig_t
 *
d
, *
n
;

287 c⁄° *
id
;

288 
îr
;

290 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
cfg
, "DeföeRegex", &
d
);

291 i‡(
îr
 =-
ENOENT
)

293 i‡(
îr
 < 0)

294  
îr
;

296 i‡(
	`¢d_c⁄fig_gë_ty≥
(
d
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

297 
	`uc_îr‹
("compoundÅypeÉxpected for DefineRegex");

298  -
EINVAL
;

301 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 3) {

302 
	`uc_îr‹
("DefineRegex is supported in v3+ syntax");

303  -
EINVAL
;

306 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
d
) {

307 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

308 
îr
 = 
	`¢d_c⁄fig_gë_id
(
n
, &
id
);

309 i‡(
îr
 < 0)

310  
îr
;

311 i‡(
id
[0] == '@') {

312 
	`uc_îr‹
("error: valueÇames starting with '@'áreÑeserved forápplication variables");

313  -
EINVAL
;

315 
îr
 = 
	`uc_mgr_deföe_ªgex
(
uc_mgr
, 
id
, 
n
);

316 i‡(
îr
 < 0)

317  
îr
;

320 
	`¢d_c⁄fig_dñëe
(
d
);

322 
	}
}

327 
	$evÆu©e_deföe
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

328 
¢d_c⁄fig_t
 *
cfg
)

330 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

331 
¢d_c⁄fig_t
 *
d
, *
n
;

332 c⁄° *
id
;

333 *
v¨
, *
s
;

334 
îr
;

336 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
cfg
, "Deföe", &
d
);

337 i‡(
îr
 =-
ENOENT
)

338  
	`evÆu©e_ªgex
(
uc_mgr
, 
cfg
);

339 i‡(
îr
 < 0)

340  
îr
;

342 i‡(
	`¢d_c⁄fig_gë_ty≥
(
d
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

343 
	`uc_îr‹
("compoundÅypeÉxpected for Define");

344  -
EINVAL
;

347 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 3) {

348 
	`uc_îr‹
("Define is supported in v3+ syntax");

349  -
EINVAL
;

352 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
d
) {

353 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

354 
îr
 = 
	`¢d_c⁄fig_gë_id
(
n
, &
id
);

355 i‡(
îr
 < 0)

356  
îr
;

357 
îr
 = 
	`¢d_c⁄fig_gë_ascii
(
n
, &
v¨
);

358 i‡(
îr
 < 0)

359  
îr
;

360 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s
, 
v¨
);

361 
	`‰ì
(
v¨
);

362 i‡(
îr
 < 0)

363  
îr
;

364 i‡(
id
[0] == '@') {

365 
	`‰ì
(
s
);

366 
	`uc_îr‹
("error: valueÇames starting with '@'áreÑeserved forápplication variables");

367  -
EINVAL
;

369 
îr
 = 
	`uc_mgr_£t_v¨übÀ
(
uc_mgr
, 
id
, 
s
);

370 
	`‰ì
(
s
);

371 i‡(
îr
 < 0)

372  
îr
;

375 
	`¢d_c⁄fig_dñëe
(
d
);

377  
	`evÆu©e_ªgex
(
uc_mgr
, 
cfg
);

378 
	}
}

383 
	$evÆu©e_deföe_ma¸o
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

384 
¢d_c⁄fig_t
 *
cfg
)

386 
¢d_c⁄fig_t
 *
d
;

387 
îr
;

389 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
cfg
, "DeföeMa¸o", &
d
);

390 i‡(
îr
 =-
ENOENT
)

392 i‡(
îr
 < 0)

393  
îr
;

395 i‡(
	`¢d_c⁄fig_gë_ty≥
(
d
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

396 
	`uc_îr‹
("compoundÅypeÉxpected for DefineMacro");

397  -
EINVAL
;

400 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 6) {

401 
	`uc_îr‹
("DefineMacro is supported in v6+ syntax");

402  -
EINVAL
;

405 
îr
 = 
	`¢d_c⁄fig_mîge
(
uc_mgr
->
ma¸os
, 
d
, 0);

406 i‡(
îr
 < 0)

407  
îr
;

409 
	}
}

411 
	$evÆu©e_ma¸o1
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

412 
¢d_c⁄fig_t
 *
d°
,

413 
¢d_c⁄fig_t
 *
¨gs
)

415 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

416 
¢d_c⁄fig_t
 *
m
, *
mc
, *
a
, *
n
;

417 c⁄° *
mid
, *
id
;

418 
«me
[128], *
v¨
, *
v¨2
;

419 c⁄° *
s
;

420 
îr
;

422 
îr
 = 
	`¢d_c⁄fig_gë_id
(
¨gs
, &
mid
);

423 i‡(
îr
 < 0)

424  
îr
;

425 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
uc_mgr
->
ma¸os
, 
mid
, &
m
);

426 i‡(
îr
 < 0) {

427 
	`uc_îr‹
("Ma¸ÿ'%s' i†nŸ deföed", 
mid
);

428  
îr
;

431 
a
 = 
¨gs
;

432 i‡(
	`¢d_c⁄fig_gë_ty≥
(
¨gs
Ë=
SND_CONFIG_TYPE_STRING
) {

433 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
¨gs
, &
s
);

434 i‡(
îr
 < 0)

435  
îr
;

436 
îr
 = 
	`¢d_c⁄fig_lﬂd_°rög
(&
a
, 
s
, 0);

437 i‡(
îr
 < 0)

438  
îr
;

439 } i‡(
	`¢d_c⁄fig_gë_ty≥
(
¨gs
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

440  -
EINVAL
;

444 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
a
) {

445 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

446 
îr
 = 
	`¢d_c⁄fig_gë_id
(
n
, &
id
);

447 i‡(
îr
 < 0)

448 
__îr_∑th
;

449 
	`¢¥ötf
(
«me
, “ame), "__%s", 
id
);

450 i‡(
	`uc_mgr_gë_v¨übÀ
(
uc_mgr
, 
«me
)) {

451 
	`uc_îr‹
("Ma¸ÿ¨gumíà'%s' i†Æªady deföed", 
«me
);

452 
__îr_∑th
;

454 
îr
 = 
	`¢d_c⁄fig_gë_ascii
(
n
, &
v¨
);

455 i‡(
îr
 < 0)

456 
__îr_∑th
;

457 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 7) {

458 
îr
 = 
	`uc_mgr_£t_v¨übÀ
(
uc_mgr
, 
«me
, 
v¨
);

459 
	`‰ì
(
v¨
);

461 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
v¨2
, 
v¨
);

462 
	`‰ì
(
v¨
);

463 i‡(
îr
 >= 0) {

464 
îr
 = 
	`uc_mgr_£t_v¨übÀ
(
uc_mgr
, 
«me
, 
v¨2
);

465 
	`‰ì
(
v¨2
);

468 i‡(
îr
 < 0)

469 
__îr_∑th
;

473 
îr
 = 
	`¢d_c⁄fig_c›y
(&
mc
, 
m
);

474 i‡(
îr
 < 0)

475 
__îr_∑th
;

476 
îr
 = 
	`uc_mgr_evÆu©e_ö∂a˚
(
uc_mgr
, 
mc
);

477 i‡(
îr
 < 0) {

478 
	`¢d_c⁄fig_dñëe
(
mc
);

479 
__îr_∑th
;

481 
îr
 = 
	`uc_mgr_c⁄fig_åì_mîge
(
uc_mgr
, 
d°
, 
mc
, 
NULL
, NULL);

482 
	`¢d_c⁄fig_dñëe
(
mc
);

485 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
a
) {

486 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

487 
îr
 = 
	`¢d_c⁄fig_gë_id
(
n
, &
id
);

488 i‡(
îr
 < 0)

489 
__îr_∑th
;

490 
	`¢¥ötf
(
«me
, “ame), "__%s", 
id
);

491 
îr
 = 
	`uc_mgr_dñëe_v¨übÀ
(
uc_mgr
, 
«me
);

492 i‡(
îr
 < 0)

493 
__îr_∑th
;

496 
__îr_∑th
:

497 i‡(
a
 !
¨gs
)

498 
	`¢d_c⁄fig_dñëe
(
a
);

499  
îr
;

500 
	}
}

505 
	$evÆu©e_ma¸o
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

506 
¢d_c⁄fig_t
 *
cfg
)

508 
¢d_c⁄fig_ôî©‹_t
 
i
, 
i2
, 
√xt
, 
√xt2
;

509 
¢d_c⁄fig_t
 *
d
, *
n
, *
n2
;

510 
îr
, 
ªt
;

512 
ªt
 = 
	`evÆu©e_deföe_ma¸o
(
uc_mgr
, 
cfg
);

513 i‡(
ªt
 < 0)

514  
ªt
;

516 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
cfg
, "Ma¸o", &
d
);

517 i‡(
îr
 =-
ENOENT
)

518  
ªt
;

519 i‡(
îr
 < 0)

520  
îr
;

522 i‡(
	`¢d_c⁄fig_gë_ty≥
(
d
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

523 
	`uc_îr‹
("compoundÅypeÉxpected for DefineMacro");

524  -
EINVAL
;

527 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 6) {

528 
	`uc_îr‹
("Macro is supported in v6+ syntax");

529  -
EINVAL
;

532 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
d
) {

533 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

534 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

535 c⁄° *
id
;

536 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
))

537 
id
 = "";

538 
	`uc_îr‹
("compoundÅy≥Éx≥˘ed f‹ Ma¸o.%s", 
id
);

539  -
EINVAL
;

541 
	`¢d_c⁄fig_f‹_óch
(
i2
, 
√xt2
, 
n
) {

542 
n2
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i2
);

543 
îr
 = 
	`evÆu©e_ma¸o1
(
uc_mgr
, 
cfg
, 
n2
);

544 i‡(
îr
 < 0)

545  
îr
;

549 
	`¢d_c⁄fig_dñëe
(
d
);

552 
	}
}

557 
	$evÆu©e_ö˛ude
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

558 
¢d_c⁄fig_t
 *
cfg
)

560 
¢d_c⁄fig_t
 *
n
;

561 
îr
;

563 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
cfg
, "In˛ude", &
n
);

564 i‡(
îr
 =-
ENOENT
)

566 i‡(
îr
 < 0)

567  
îr
;

569 
îr
 = 
	`uc_mgr_evÆu©e_ö˛ude
(
uc_mgr
, 
cfg
, 
n
);

570 
	`¢d_c⁄fig_dñëe
(
n
);

571  
îr
;

572 
	}
}

577 
	$evÆu©e_c⁄dôi⁄
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
cfg
)

579 
¢d_c⁄fig_t
 *
n
;

580 
îr
;

582 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
cfg
, "If", &
n
);

583 i‡(
îr
 =-
ENOENT
)

585 i‡(
îr
 < 0)

586  
îr
;

588 
îr
 = 
	`uc_mgr_evÆu©e_c⁄dôi⁄
(
uc_mgr
, 
cfg
, 
n
);

589 
	`¢d_c⁄fig_dñëe
(
n
);

590  
îr
;

591 
	}
}

596 
	$evÆu©e_v¨ü¡
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
cfg
)

598 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

599 
¢d_c⁄fig_t
 *
n
, *
c
;

600 c⁄° *
id
;

601 
îr
;

603 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
cfg
, "V¨ü¡", &
c
);

604 i‡(
îr
 =-
ENOENT
)

606 i‡(
îr
 < 0)

607  
îr
;

609 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 6) {

610 
	`uc_îr‹
("Variant is supported in v6+ syntax");

611  -
EINVAL
;

614 i‡(
uc_mgr
->
∑r£_ma°î_£˘i⁄
)

617 i‡(
uc_mgr
->
∑r£_v¨ü¡
 =
NULL
)

618 
__ªt
;

620 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c
) {

621 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

623 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

624  -
EINVAL
;

626 i‡(
	`°rcmp
(
id
, 
uc_mgr
->
∑r£_v¨ü¡
))

629 
îr
 = 
	`uc_mgr_evÆu©e_ö∂a˚
(
uc_mgr
, 
n
);

630 i‡(
îr
 < 0)

631  
îr
;

633 
îr
 = 
	`uc_mgr_c⁄fig_åì_mîge
(
uc_mgr
, 
cfg
, 
n
, 
NULL
, NULL);

634 i‡(
îr
 < 0)

635  
îr
;

636 
	`¢d_c⁄fig_dñëe
(
c
);

640 
__ªt
:

641 
	`¢d_c⁄fig_dñëe
(
c
);

643 
	}
}

648 
	$uc_mgr_evÆu©e_ö∂a˚
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

649 
¢d_c⁄fig_t
 *
cfg
)

651 
ôî©i⁄s
 = 10000;

652 
îr1
 = 0, 
îr2
 = 0, 
îr3
 = 0, 
îr4
 = 0, 
îr5
 = 0;

654 
îr1
 =0 || 
îr2
 =0 || 
îr3
 =0 || 
îr4
 =0 || 
îr5
 == 0) {

655 i‡(
ôî©i⁄s
 == 0) {

656 
	`uc_îr‹
("Maximal inplaceÉvaluation iterationsÇumberÑeached (recursiveÑeferences?)");

657  -
EINVAL
;

659 
ôî©i⁄s
--;

661 
îr1
 = 
	`evÆu©e_deföe
(
uc_mgr
, 
cfg
);

662 i‡(
îr1
 < 0)

663  
îr1
;

665 
îr2
 = 
	`evÆu©e_ö˛ude
(
uc_mgr
, 
cfg
);

666 i‡(
îr2
 < 0)

667  
îr2
;

670 i‡(
îr2
 == 0)

672 
îr3
 = 
	`evÆu©e_v¨ü¡
(
uc_mgr
, 
cfg
);

673 i‡(
îr3
 < 0)

674  
îr3
;

675 i‡(
îr3
 == 0)

677 
uc_mgr
->
ma¸o_h›s
++;

678 i‡(
uc_mgr
->
ma¸o_h›s
 > 100) {

679 
	`uc_îr‹
("Maximal macro hopsÑeached!");

680  -
EINVAL
;

682 
îr4
 = 
	`evÆu©e_ma¸o
(
uc_mgr
, 
cfg
);

683 
uc_mgr
->
ma¸o_h›s
--;

684 i‡(
îr4
 < 0)

685  
îr4
;

686 i‡(
îr4
 == 0)

688 
îr5
 = 
	`evÆu©e_c⁄dôi⁄
(
uc_mgr
, 
cfg
);

689 i‡(
îr5
 < 0)

690  
îr5
;

693 
	}
}

698 
	$∑r£_libc⁄fig1
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
cfg
)

700 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

701 
¢d_c⁄fig_t
 *
n
, *
c⁄fig
 = 
NULL
;

702 c⁄° *
id
, *
fûe
 = 
NULL
;

703 
boﬁ
 
sub°fûe
 = 
Ál£
, 
sub°c⁄fig
 = false;

704 
îr
;

706 i‡(
	`¢d_c⁄fig_gë_id
(
cfg
, &
id
) < 0)

707  -
EINVAL
;

709 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

710 
	`uc_îr‹
("compoundÅy≥Éx≥˘ed f‹ %s", 
id
);

711  -
EINVAL
;

714 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

715 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

717 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

718  -
EINVAL
;

720 i‡(
	`°rcmp
(
id
, "File") == 0 ||

721 
	`°rcmp
(
id
, "SubstiFile") == 0) {

722 
sub°fûe
 = 
id
[0] == 'S';

723 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
n
, &
fûe
);

724 i‡(
îr
 < 0)

725  
îr
;

729 i‡(
	`°rcmp
(
id
, "Config") == 0 ||

730 
	`°rcmp
(
id
, "SubstiConfig") == 0) {

731 
sub°c⁄fig
 = 
id
[0] == 'S';

732 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_COMPOUND
)

733  -
EINVAL
;

734 
c⁄fig
 = 
n
;

738 
	`uc_îr‹
("unknow¿fõld %s", 
id
);

739  -
EINVAL
;

742 i‡(
fûe
) {

743 i‡(
sub°fûe
) {

744 
¢d_c⁄fig_t
 *
cfg
;

745 
îr
 = 
	`uc_mgr_c⁄fig_lﬂd
(
uc_mgr
->
c⁄f_f‹m©
, 
fûe
, &
cfg
);

746 i‡(
îr
 < 0)

747  
îr
;

748 
îr
 = 
	`uc_mgr_sub°ôuã_åì
(
uc_mgr
, 
cfg
);

749 i‡(
îr
 < 0) {

750 
	`¢d_c⁄fig_dñëe
(
cfg
);

751  
îr
;

753 
îr
 = 
	`¢d_c⁄fig_mîge
(
uc_mgr
->
loˇl_c⁄fig
, 
cfg
, 0);

754 i‡(
îr
 < 0) {

755 
	`¢d_c⁄fig_dñëe
(
cfg
);

756  
îr
;

759 
fûíame
[
PATH_MAX
];

761 
	`ucm_fûíame
(
fûíame
, (fûíame), 
uc_mgr
->
c⁄f_f‹m©
,

762 
fûe
[0] ='/' ? 
NULL
 : 
uc_mgr
->
c⁄f_dú_«me
,

763 
fûe
);

764 
îr
 = 
	`uc_mgr_c⁄fig_lﬂd_öto
(
uc_mgr
->
c⁄f_f‹m©
, 
fûíame
, uc_mgr->
loˇl_c⁄fig
);

765 i‡(
îr
 < 0)

766  
îr
;

770 i‡(
c⁄fig
) {

771 i‡(
sub°c⁄fig
) {

772 
îr
 = 
	`uc_mgr_sub°ôuã_åì
(
uc_mgr
, 
c⁄fig
);

773 i‡(
îr
 < 0)

774  
îr
;

776 
îr
 = 
	`¢d_c⁄fig_mîge
(
uc_mgr
->
loˇl_c⁄fig
, 
c⁄fig
, 0);

777 i‡(
îr
 < 0)

778  
îr
;

782 
	}
}

787 
	$∑r£_libc⁄fig
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
cfg
)

789 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

790 
¢d_c⁄fig_t
 *
n
;

791 c⁄° *
id
;

792 
îr
;

794 i‡(
	`¢d_c⁄fig_gë_id
(
cfg
, &
id
) < 0)

795  -
EINVAL
;

797 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

798 
	`uc_îr‹
("compoundÅy≥Éx≥˘ed f‹ %s", 
id
);

799  -
EINVAL
;

802 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

803 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

805 
îr
 = 
	`∑r£_libc⁄fig1
(
uc_mgr
, 
n
);

806 i‡(
îr
 < 0)

807  
îr
;

811 
	}
}

816 
	$∑r£_å™sôi⁄
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

817 
li°_hód
 *
éi°
,

818 
¢d_c⁄fig_t
 *
cfg
)

820 
å™sôi⁄_£quí˚
 *
t£q
;

821 c⁄° *
id
;

822 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

823 
¢d_c⁄fig_t
 *
n
;

824 
îr
;

826 i‡(
	`¢d_c⁄fig_gë_id
(
cfg
, &
id
) < 0)

827  -
EINVAL
;

829 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

830 
	`uc_îr‹
("compoundÅy≥Éx≥˘ed f‹ %s", 
id
);

831  -
EINVAL
;

834 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

835 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

837 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

838  -
EINVAL
;

840 
t£q
 = 
	`ˇŒoc
(1, (*tseq));

841 i‡(
t£q
 =
NULL
)

842  -
ENOMEM
;

843 
	`INIT_LIST_HEAD
(&
t£q
->
å™sôi⁄_li°
);

845 
îr
 = 
	`gë_°rög3
(
uc_mgr
, 
id
, &
t£q
->
«me
);

846 i‡(
îr
 < 0) {

847 
	`‰ì
(
t£q
);

848  
îr
;

851 
îr
 = 
	`∑r£_£quí˚
(
uc_mgr
, &
t£q
->
å™sôi⁄_li°
, 
n
);

852 i‡(
îr
 < 0) {

853 
	`uc_mgr_‰ì_å™sôi⁄_ñemít
(
t£q
);

854  
îr
;

857 
	`li°_add
(&
t£q
->
li°
, 
éi°
);

860 
	}
}

865 
∑r£_compound
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
cfg
,

866 (*
f˙
)(
¢d_u£_ˇ£_mgr_t
 *, 
¢d_c⁄fig_t
 *, *, *),

867 *
d©a1
, *
d©a2
)

869 c⁄° *
id
;

870 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

871 
¢d_c⁄fig_t
 *
n
;

872 
îr
;

874 i‡(
	`¢d_c⁄fig_gë_id
(
cfg
, &
id
) < 0)

875  -
EINVAL
;

877 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

878 
	`uc_îr‹
("compoundÅy≥Éx≥˘ed f‹ %s", 
id
);

879  -
EINVAL
;

882 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

883 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

885 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

886 
	`uc_îr‹
("compoundÅy≥Éx≥˘ed f‹ %s, i†%d", 
id
, 
	`¢d_c⁄fig_gë_ty≥
(
cfg
));

887  -
EINVAL
;

890 
îr
 = 
	`f˙
(
uc_mgr
, 
n
, 
d©a1
, 
d©a2
);

891 i‡(
îr
 < 0)

892  
îr
;

896 
	}
}

898 
	$°rù_Àgacy_dev_ödex
(*
«me
)

900 *
dŸ
 = 
	`°rchr
(
«me
, '.');

901 i‡(!
dŸ
)

903 i‡(
dŸ
[1] != '0' || dot[2] != '\0') {

904 
	`uc_îr‹
("deviceÇame %s containsá '.',"

905 "ánd i†nŸÜegacy foo.0 f‹m©", 
«me
);

906  -
EINVAL
;

908 *
dŸ
 = '\0';

910 
	}
}

915 
	$∑r£_devi˚_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
 
ATTRIBUTE_UNUSED
,

916 
dev_li°
 *dev_list,

917 
dev_li°_ty≥
 
ty≥
,

918 
¢d_c⁄fig_t
 *
cfg
)

920 
dev_li°_node
 *
sdev
;

921 c⁄° *
id
;

922 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

923 
¢d_c⁄fig_t
 *
n
;

924 
îr
;

926 i‡(
dev_li°
->
ty≥
 !
DEVLIST_NONE
) {

927 
	`uc_îr‹
("error: multiple supported or"

929  -
EEXIST
;

932 i‡(
	`¢d_c⁄fig_gë_id
(
cfg
, &
id
) < 0)

933  -
EINVAL
;

935 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

936 
	`uc_îr‹
("compoundÅy≥Éx≥˘ed f‹ %s", 
id
);

937  -
EINVAL
;

940 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

941 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

943 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

944  -
EINVAL
;

946 
sdev
 = 
	`ˇŒoc
(1, (
dev_li°_node
));

947 i‡(
sdev
 =
NULL
)

948  -
ENOMEM
;

949 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &
sdev
->
«me
);

950 i‡(
îr
 < 0) {

951 
	`‰ì
(
sdev
);

952  
îr
;

954 
îr
 = 
	`°rù_Àgacy_dev_ödex
(
sdev
->
«me
);

955 i‡(
îr
 < 0) {

956 
	`‰ì
(
sdev
->
«me
);

957 
	`‰ì
(
sdev
);

958  
îr
;

960 
	`li°_add
(&
sdev
->
li°
, &
dev_li°
->list);

963 
dev_li°
->
ty≥
 =Åype;

966 
	}
}

980 
u£_ˇ£_devi˚
 *
	$föd_comp⁄ít_dev
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

981 c⁄° *
«me
)

983 
li°_hód
 *
pos
, *
posdev
, *
_posdev
;

984 
u£_ˇ£_vîb
 *
vîb
;

985 
u£_ˇ£_devi˚
 *
dev
;

987 
	`li°_f‹_óch
(
pos
, &
uc_mgr
->
vîb_li°
) {

988 
vîb
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_vîb
, 
li°
);

991 
	`li°_f‹_óch
(
posdev
, &
vîb
->
cm±_devi˚_li°
) {

992 
dev
 = 
	`li°_íåy
(
posdev
, 
u£_ˇ£_devi˚
, 
li°
);

993 i‡(!
	`°rcmp
(
dev
->
«me
,Çame))

994  
dev
;

998 
	`li°_f‹_óch_ß„
(
posdev
, 
_posdev
, &
vîb
->
devi˚_li°
) {

999 
dev
 = 
	`li°_íåy
(
posdev
, 
u£_ˇ£_devi˚
, 
li°
);

1000 i‡(!
	`°rcmp
(
dev
->
«me
,Çame)) {

1005 
	`li°_dñ
(&
dev
->
li°
);

1006 
	`li°_add_èû
(&
dev
->
li°
,

1007 &
vîb
->
cm±_devi˚_li°
);

1008  
dev
;

1013  
NULL
;

1014 
	}
}

1021 
	$∑r£_comp⁄ít_£q
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1022 
¢d_c⁄fig_t
 *
n
, 
íabÀ
,

1023 
comp⁄ít_£quí˚
 *
cm±_£q
)

1025 *
vÆ
;

1026 
îr
;

1028 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &
vÆ
);

1029 i‡(
îr
 < 0)

1030  
îr
;

1032 
cm±_£q
->
devi˚
 = 
	`föd_comp⁄ít_dev
(
uc_mgr
, 
vÆ
);

1033 i‡(!
cm±_£q
->
devi˚
) {

1034 
	`uc_îr‹
("îr‹: C™nŸ föd comp⁄íàdevi˚ %s", 
vÆ
);

1035 
	`‰ì
(
vÆ
);

1036  -
EINVAL
;

1038 
	`‰ì
(
vÆ
);

1041 
cm±_£q
->
íabÀ
 =Énable;

1044 
	}
}

1064 
	$∑r£_£quí˚
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1065 
li°_hód
 *
ba£
,

1066 
¢d_c⁄fig_t
 *
cfg
)

1068 
£quí˚_ñemít
 *
cuº
;

1069 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1070 
¢d_c⁄fig_t
 *
n
;

1071 
îr
, 
idx
 = 0;

1072 c⁄° *
cmd
 = 
NULL
;

1074 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1075 
	`uc_îr‹
("error: compound isÉxpected for sequence definition");

1076  -
EINVAL
;

1079 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1080 c⁄° *
id
;

1081 
idx
 ^= 1;

1082 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1083 
îr
 = 
	`¢d_c⁄fig_gë_id
(
n
, &
id
);

1084 i‡(
îr
 < 0)

1086 i‡(
idx
 == 1) {

1087 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_STRING
) {

1088 
	`uc_îr‹
("error: stringÅype isÉxpected for sequence command");

1089  -
EINVAL
;

1091 
	`¢d_c⁄fig_gë_°rög
(
n
, &
cmd
);

1096 
cuº
 = 
	`ˇŒoc
(1, (
£quí˚_ñemít
));

1097 i‡(
cuº
 =
NULL
)

1098  -
ENOMEM
;

1099 
	`li°_add_èû
(&
cuº
->
li°
, 
ba£
);

1101 i‡(
	`°rcmp
(
cmd
, "cdev") == 0) {

1102 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_CDEV
;

1103 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &
cuº
->
d©a
.
cdev
);

1104 i‡(
îr
 < 0) {

1105 
	`uc_îr‹
("error: cdevÑequiresá string!");

1106  
îr
;

1111 i‡(
	`°rcmp
(
cmd
, "cset") == 0) {

1112 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_CSET
;

1113 
c£t
:

1114 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &
cuº
->
d©a
.
c£t
);

1115 i‡(
îr
 < 0) {

1116 
	`uc_îr‹
("îr‹: %†ªquúe†®°rög!", 
cmd
);

1117  
îr
;

1122 i‡(
	`°rcmp
(
cmd
, "enadev") == 0 ||

1123 
	`°rcmp
(
cmd
, "disdev") == 0) {

1125 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_CMPT_SEQ
;

1126 
îr
 = 
	`∑r£_comp⁄ít_£q
(
uc_mgr
, 
n
,

1127 
	`°rcmp
(
cmd
, "enadev") == 0,

1128 &
cuº
->
d©a
.
cm±_£q
);

1129 i‡(
îr
 < 0) {

1130 
	`uc_îr‹
("îr‹: %†ªquúe†®vÆid devi˚!", 
cmd
);

1131  
îr
;

1136 i‡(
	`°rcmp
(
cmd
, "enadev2") == 0) {

1137 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_DEV_ENABLE_SEQ
;

1138 
devi˚
;

1141 i‡(
	`°rcmp
(
cmd
, "disdev2") == 0) {

1142 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_DEV_DISABLE_SEQ
;

1143 
devi˚
:

1144 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &
cuº
->
d©a
.
devi˚
);

1145 i‡(
îr
 < 0) {

1146 
	`uc_îr‹
("îr‹: %†ªquúe†®vÆid devi˚!", 
cmd
);

1147  
îr
;

1152 i‡(
	`°rcmp
(
cmd
, "disdevall") == 0) {

1153 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_DEV_DISABLE_ALL
;

1157 i‡(
	`°rcmp
(
cmd
, "cset-bin-file") == 0) {

1158 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_CSET_BIN_FILE
;

1159 
c£t
;

1162 i‡(
	`°rcmp
(
cmd
, "cset-tlv") == 0) {

1163 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_CSET_TLV
;

1164 
c£t
;

1167 i‡(
	`°rcmp
(
cmd
, "cset-new") == 0) {

1168 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_CSET_NEW
;

1169 
c£t
;

1172 i‡(
	`°rcmp
(
cmd
, "ctl-remove") == 0) {

1173 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
;

1174 
c£t
;

1177 i‡(
	`°rcmp
(
cmd
, "sysw") == 0) {

1178 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_SYSSET
;

1179 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &
cuº
->
d©a
.
sysw
);

1180 i‡(
îr
 < 0) {

1181 
	`uc_îr‹
("error: syswÑequiresá string!");

1182  
îr
;

1187 i‡(
	`°rcmp
(
cmd
, "usleep") == 0) {

1188 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_SLEEP
;

1189 
îr
 = 
	`∑r£_öãgî_sub°ôuã3
(
uc_mgr
, 
n
, &
cuº
->
d©a
.
¶ìp
);

1190 i‡(
îr
 < 0) {

1191 
	`uc_îr‹
("error: usleepÑequires integer!");

1192  
îr
;

1197 i‡(
	`°rcmp
(
cmd
, "msleep") == 0) {

1198 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_SLEEP
;

1199 
îr
 = 
	`∑r£_öãgî_sub°ôuã3
(
uc_mgr
, 
n
, &
cuº
->
d©a
.
¶ìp
);

1200 i‡(
îr
 < 0) {

1201 
	`uc_îr‹
("error: msleepÑequires integer!");

1202  
îr
;

1204 
cuº
->
d©a
.
¶ìp
 *= 1000L;

1208 i‡(
	`°rcmp
(
cmd
, "exec") == 0) {

1209 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_EXEC
;

1210 
exec
:

1211 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &
cuº
->
d©a
.
exec
);

1212 i‡(
îr
 < 0) {

1213 
	`uc_îr‹
("error:ÉxecÑequiresá string!");

1214  
îr
;

1219 i‡(
	`°rcmp
(
cmd
, "shell") == 0) {

1220 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_SHELL
;

1221 
exec
;

1224 i‡(
	`°rcmp
(
cmd
, "cfg-save") == 0) {

1225 
cuº
->
ty≥
 = 
SEQUENCE_ELEMENT_TYPE_CFGSAVE
;

1226 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &
cuº
->
d©a
.
cfgßve
);

1227 i‡(
îr
 < 0) {

1228 
	`uc_îr‹
("error: syswÑequiresá string!");

1229  
îr
;

1234 i‡(
	`°rcmp
(
cmd
, "comment") == 0)

1235 
skù
;

1237 
	`uc_îr‹
("îr‹: sequí˚ comm™d '%s' i†ign‹ed", 
cmd
);

1239 
skù
:

1240 
	`li°_dñ
(&
cuº
->
li°
);

1241 
	`uc_mgr_‰ì_£quí˚_ñemít
(
cuº
);

1245 
	}
}

1250 
	$uc_mgr_add_vÆue
(
li°_hód
 *
ba£
, c⁄° *
key
, *
vÆ
)

1252 
ucm_vÆue
 *
cuº
;

1254 
cuº
 = 
	`ˇŒoc
(1, (
ucm_vÆue
));

1255 i‡(
cuº
 =
NULL
)

1256  -
ENOMEM
;

1257 
cuº
->
«me
 = 
	`°rdup
(
key
);

1258 i‡(
cuº
->
«me
 =
NULL
) {

1259 
	`‰ì
(
cuº
);

1260  -
ENOMEM
;

1262 
	`li°_add_èû
(&
cuº
->
li°
, 
ba£
);

1263 
cuº
->
d©a
 = 
vÆ
;

1265 
	}
}

1279 
	$∑r£_vÆue
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
 
ATTRIBUTE_UNUSED
,

1280 
li°_hód
 *
ba£
,

1281 
¢d_c⁄fig_t
 *
cfg
)

1283 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1284 
¢d_c⁄fig_t
 *
n
;

1285 *
s
;

1286 
¢d_c⁄fig_ty≥_t
 
ty≥
;

1287 
îr
;

1289 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1290 
	`uc_îr‹
("error: compound isÉxpected for value definition");

1291  -
EINVAL
;

1295 
îr
 = 
	`uc_mgr_evÆu©e_ö∂a˚
(
uc_mgr
, 
cfg
);

1296 i‡(
îr
 < 0)

1297  
îr
;

1299 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1300 c⁄° *
id
;

1301 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1302 
îr
 = 
	`¢d_c⁄fig_gë_id
(
n
, &
id
);

1303 i‡(
îr
 < 0)

1306 
ty≥
 = 
	`¢d_c⁄fig_gë_ty≥
(
n
);

1307 
ty≥
) {

1308 
SND_CONFIG_TYPE_INTEGER
:

1309 
SND_CONFIG_TYPE_INTEGER64
:

1310 
SND_CONFIG_TYPE_REAL
:

1311 
îr
 = 
	`¢d_c⁄fig_gë_ascii
(
n
, &
s
);

1312 i‡(
îr
 < 0) {

1313 
	`uc_îr‹
("îr‹: u«bÀÅÿ∑r£ vÆuêf‹ id '%s': %s!", 
id
, 
	`¢d_°ªº‹
(
îr
));

1314  
îr
;

1317 
SND_CONFIG_TYPE_STRING
:

1318 
îr
 = 
	`∑r£_°rög_sub°ôuã
(
uc_mgr
, 
n
, &
s
);

1319 i‡(
îr
 < 0) {

1320 
	`uc_îr‹
("îr‹: u«bÀÅÿ∑r£á såög f‹ id '%s'!", 
id
);

1321  
îr
;

1325 
	`uc_îr‹
("îr‹: invÆidÅy≥ %òö VÆuêcompound '%s'", 
ty≥
, 
id
);

1326  -
EINVAL
;

1328 
îr
 = 
	`uc_mgr_add_vÆue
(
ba£
, 
id
, 
s
);

1329 i‡(
îr
 < 0) {

1330 
	`‰ì
(
s
);

1331  
îr
;

1336 
	}
}

1380 
	$∑r£_modifõr
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1381 
¢d_c⁄fig_t
 *
cfg
,

1382 *
d©a1
, *
d©a2
)

1384 
u£_ˇ£_vîb
 *
vîb
 = 
d©a1
;

1385 
u£_ˇ£_modifõr
 *
modifõr
;

1386 *
«me
;

1387 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1388 
¢d_c⁄fig_t
 *
n
;

1389 
îr
;

1391 i‡(
	`∑r£_gë_ß„_«me
(
uc_mgr
, 
cfg
, 
d©a2
, &
«me
) < 0)

1392  -
EINVAL
;

1395 
modifõr
 = 
	`ˇŒoc
(1, (*modifier));

1396 i‡(
modifõr
 =
NULL
) {

1397 
	`‰ì
(
«me
);

1398  -
ENOMEM
;

1400 
	`INIT_LIST_HEAD
(&
modifõr
->
íabÀ_li°
);

1401 
	`INIT_LIST_HEAD
(&
modifõr
->
dißbÀ_li°
);

1402 
	`INIT_LIST_HEAD
(&
modifõr
->
å™sôi⁄_li°
);

1403 
	`INIT_LIST_HEAD
(&
modifõr
->
dev_li°
.
li°
);

1404 
	`INIT_LIST_HEAD
(&
modifõr
->
vÆue_li°
);

1405 
	`li°_add_èû
(&
modifõr
->
li°
, &
vîb
->
modifõr_li°
);

1406 
modifõr
->
«me
 =Çame;

1409 
îr
 = 
	`uc_mgr_evÆu©e_ö∂a˚
(
uc_mgr
, 
cfg
);

1410 i‡(
îr
 < 0)

1411  
îr
;

1413 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1414 c⁄° *
id
;

1415 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1416 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1419 i‡(
	`°rcmp
(
id
, "Comment") == 0) {

1420 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &
modifõr
->
commít
);

1421 i‡(
îr
 < 0) {

1422 
	`uc_îr‹
("error: failedÅo get modifier comment");

1423  
îr
;

1428 i‡(
	`°rcmp
(
id
, "SupportedDevice") == 0) {

1429 
îr
 = 
	`∑r£_devi˚_li°
(
uc_mgr
, &
modifõr
->
dev_li°
,

1430 
DEVLIST_SUPPORTED
, 
n
);

1431 i‡(
îr
 < 0) {

1432 
	`uc_îr‹
("error: failedÅoÖarse supported"

1434  
îr
;

1438 i‡(
	`°rcmp
(
id
, "ConflictingDevice") == 0) {

1439 
îr
 = 
	`∑r£_devi˚_li°
(
uc_mgr
, &
modifõr
->
dev_li°
,

1440 
DEVLIST_CONFLICTING
, 
n
);

1441 i‡(
îr
 < 0) {

1442 
	`uc_îr‹
("error: failedÅoÖarse conflicting"

1444  
îr
;

1448 i‡(
	`°rcmp
(
id
, "EnableSequence") == 0) {

1449 
îr
 = 
	`∑r£_£quí˚
(
uc_mgr
, &
modifõr
->
íabÀ_li°
, 
n
);

1450 i‡(
îr
 < 0) {

1451 
	`uc_îr‹
("error: failedÅoÖarse modifier"

1453  
îr
;

1458 i‡(
	`°rcmp
(
id
, "DisableSequence") == 0) {

1459 
îr
 = 
	`∑r£_£quí˚
(
uc_mgr
, &
modifõr
->
dißbÀ_li°
, 
n
);

1460 i‡(
îr
 < 0) {

1461 
	`uc_îr‹
("error: failedÅoÖarse modifier"

1463  
îr
;

1468 i‡(
	`°rcmp
(
id
, "TransitionSequence") == 0) {

1469 
îr
 = 
	`∑r£_å™sôi⁄
(
uc_mgr
, &
modifõr
->
å™sôi⁄_li°
, 
n
);

1470 i‡(
îr
 < 0) {

1471 
	`uc_îr‹
("error: failedÅoÖarseÅransition"

1473  
îr
;

1478 i‡(
	`°rcmp
(
id
, "Value") == 0) {

1479 
îr
 = 
	`∑r£_vÆue
(
uc_mgr
, &
modifõr
->
vÆue_li°
, 
n
);

1480 i‡(
îr
 < 0) {

1481 
	`uc_îr‹
("error: failedÅoÖarse Value");

1482  
îr
;

1489 
	}
}

1526 
	$∑r£_devi˚
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1527 
¢d_c⁄fig_t
 *
cfg
,

1528 *
d©a1
, *
d©a2
)

1530 
u£_ˇ£_vîb
 *
vîb
 = 
d©a1
;

1531 *
«me
;

1532 
u£_ˇ£_devi˚
 *
devi˚
;

1533 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1534 
¢d_c⁄fig_t
 *
n
;

1535 
îr
;

1537 i‡(
	`∑r£_gë_ß„_«me
(
uc_mgr
, 
cfg
, 
d©a2
, &
«me
) < 0)

1538  -
EINVAL
;

1540 
devi˚
 = 
	`ˇŒoc
(1, (*device));

1541 i‡(
devi˚
 =
NULL
) {

1542 
	`‰ì
(
«me
);

1543  -
ENOMEM
;

1545 
	`INIT_LIST_HEAD
(&
devi˚
->
íabÀ_li°
);

1546 
	`INIT_LIST_HEAD
(&
devi˚
->
dißbÀ_li°
);

1547 
	`INIT_LIST_HEAD
(&
devi˚
->
å™sôi⁄_li°
);

1548 
	`INIT_LIST_HEAD
(&
devi˚
->
dev_li°
.
li°
);

1549 
	`INIT_LIST_HEAD
(&
devi˚
->
vÆue_li°
);

1550 
	`li°_add_èû
(&
devi˚
->
li°
, &
vîb
->
devi˚_li°
);

1551 
devi˚
->
«me
 =Çame;

1554 
îr
 = 
	`uc_mgr_evÆu©e_ö∂a˚
(
uc_mgr
, 
cfg
);

1555 i‡(
îr
 < 0)

1556  
îr
;

1558 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1559 c⁄° *
id
;

1560 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1561 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1564 i‡(
	`°rcmp
(
id
, "Comment") == 0) {

1565 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &
devi˚
->
commít
);

1566 i‡(
îr
 < 0) {

1567 
	`uc_îr‹
("error: failedÅo get device comment");

1568  
îr
;

1573 i‡(
	`°rcmp
(
id
, "SupportedDevice") == 0) {

1574 
îr
 = 
	`∑r£_devi˚_li°
(
uc_mgr
, &
devi˚
->
dev_li°
,

1575 
DEVLIST_SUPPORTED
, 
n
);

1576 i‡(
îr
 < 0) {

1577 
	`uc_îr‹
("error: failedÅoÖarse supported"

1579  
îr
;

1583 i‡(
	`°rcmp
(
id
, "ConflictingDevice") == 0) {

1584 
îr
 = 
	`∑r£_devi˚_li°
(
uc_mgr
, &
devi˚
->
dev_li°
,

1585 
DEVLIST_CONFLICTING
, 
n
);

1586 i‡(
îr
 < 0) {

1587 
	`uc_îr‹
("error: failedÅoÖarse conflicting"

1589  
îr
;

1593 i‡(
	`°rcmp
(
id
, "EnableSequence") == 0) {

1594 
	`uc_dbg
("EnableSequence");

1595 
îr
 = 
	`∑r£_£quí˚
(
uc_mgr
, &
devi˚
->
íabÀ_li°
, 
n
);

1596 i‡(
îr
 < 0) {

1597 
	`uc_îr‹
("error: failedÅoÖarse deviceÉnable"

1599  
îr
;

1604 i‡(
	`°rcmp
(
id
, "DisableSequence") == 0) {

1605 
	`uc_dbg
("DisableSequence");

1606 
îr
 = 
	`∑r£_£quí˚
(
uc_mgr
, &
devi˚
->
dißbÀ_li°
, 
n
);

1607 i‡(
îr
 < 0) {

1608 
	`uc_îr‹
("error: failedÅoÖarse device disable"

1610  
îr
;

1615 i‡(
	`°rcmp
(
id
, "TransitionSequence") == 0) {

1616 
	`uc_dbg
("TransitionSequence");

1617 
îr
 = 
	`∑r£_å™sôi⁄
(
uc_mgr
, &
devi˚
->
å™sôi⁄_li°
, 
n
);

1618 i‡(
îr
 < 0) {

1619 
	`uc_îr‹
("error: failedÅoÖarseÅransition"

1621  
îr
;

1626 i‡(
	`°rcmp
(
id
, "Value") == 0) {

1627 
îr
 = 
	`∑r£_vÆue
(
uc_mgr
, &
devi˚
->
vÆue_li°
, 
n
);

1628 i‡(
îr
 < 0) {

1629 
	`uc_îr‹
("error: failedÅoÖarse Value");

1630  
îr
;

1636 
	}
}

1647 
	$∑r£_dev_«me_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1648 
¢d_c⁄fig_t
 *
cfg
,

1649 
li°_hód
 *
li°
)

1651 
¢d_c⁄fig_t
 *
n
;

1652 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1653 c⁄° *
id
, *
«me1
;

1654 *
«me1s
, *
«me2
;

1655 
ucm_dev_«me
 *
dev
;

1656 
¢d_c⁄fig_ôî©‹_t
 
pos
;

1657 
îr
;

1659 i‡(
	`¢d_c⁄fig_gë_id
(
cfg
, &
id
) < 0)

1660  -
EINVAL
;

1662 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1663 
	`uc_îr‹
("compoundÅy≥Éx≥˘ed f‹ %s", 
id
);

1664  -
EINVAL
;

1667 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1668 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1670 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
«me1
) < 0)

1671  -
EINVAL
;

1673 
îr
 = 
	`gë_°rög3
(
uc_mgr
, 
«me1
, &
«me1s
);

1674 i‡(
îr
 < 0)

1675  
îr
;

1677 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &
«me2
);

1678 i‡(
îr
 < 0) {

1679 
	`‰ì
(
«me1s
);

1680 
	`uc_îr‹
("îr‹: faûedÅÿgëÅ¨gë devi˚Çamêf‹ '%s'", 
«me1
);

1681  
îr
;

1685 
	`li°_f‹_óch
(
pos
, 
li°
) {

1686 
dev
 = 
	`li°_íåy
(
pos
, 
ucm_dev_«me
, 
li°
);

1687 i‡(
	`°rcmp
(
dev
->
«me1
, 
«me1s
) == 0) {

1688 
	`‰ì
(
«me2
);

1689 
	`‰ì
(
«me1s
);

1694 
	`‰ì
(
«me1s
);

1696 
dev
 = 
	`ˇŒoc
(1, (*dev));

1697 i‡(
dev
 =
NULL
) {

1698 
	`‰ì
(
«me2
);

1699  -
ENOMEM
;

1701 
dev
->
«me1
 = 
	`°rdup
(name1);

1702 i‡(
dev
->
«me1
 =
NULL
) {

1703 
	`‰ì
(
dev
);

1704 
	`‰ì
(
«me2
);

1705  -
ENOMEM
;

1707 
dev
->
«me2
 =Çame2;

1708 
	`li°_add_èû
(&
dev
->
li°
,Üist);

1712 
	}
}

1714 
∑r£_compound_check_Àgacy
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1715 
¢d_c⁄fig_t
 *
cfg
,

1716 (*
f˙
)(
¢d_u£_ˇ£_mgr_t
 *, 
¢d_c⁄fig_t
 *, *, *),

1717 *
d©a1
)

1719 c⁄° *
id
, *
idchûd
;

1720 
chûd_˘r
 = 0, 
Àgacy_f‹m©
 = 1;

1721 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1722 
¢d_c⁄fig_t
 *
chûd
;

1723 
îr
;

1725 
îr
 = 
	`¢d_c⁄fig_gë_id
(
cfg
, &
id
);

1726 i‡(
îr
 < 0)

1727  
îr
;

1729 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1730 
chûd_˘r
++;

1731 i‡(
chûd_˘r
 > 1) {

1735 
chûd
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1737 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

1738 
Àgacy_f‹m©
 = 0;

1742 i‡(
	`¢d_c⁄fig_gë_id
(
chûd
, &
idchûd
) < 0)

1743  -
EINVAL
;

1745 i‡(
	`°rcmp
(
idchûd
, "0")) {

1746 
Àgacy_f‹m©
 = 0;

1750 i‡(
chûd_˘r
 != 1) {

1751 
Àgacy_f‹m©
 = 0;

1754 i‡(
Àgacy_f‹m©
)

1755  
	`∑r£_compound
(
uc_mgr
, 
cfg
, 
f˙
, 
d©a1
, (*)
id
);

1757  
	`f˙
(
uc_mgr
, 
cfg
, 
d©a1
, 
NULL
);

1758 
	}
}

1760 
	$∑r£_devi˚_«me
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1761 
¢d_c⁄fig_t
 *
cfg
,

1762 *
d©a1
,

1763 *
d©a2
 
ATTRIBUTE_UNUSED
)

1765  
	`∑r£_compound_check_Àgacy
(
uc_mgr
, 
cfg
, 
∑r£_devi˚
, 
d©a1
);

1766 
	}
}

1768 
	$∑r£_modifõr_«me
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1769 
¢d_c⁄fig_t
 *
cfg
,

1770 *
d©a1
,

1771 *
d©a2
 
ATTRIBUTE_UNUSED
)

1773  
	`∑r£_compound_check_Àgacy
(
uc_mgr
, 
cfg
, 
∑r£_modifõr
, 
d©a1
);

1774 
	}
}

1776 
	$vîb_dev_li°_add
(
u£_ˇ£_vîb
 *
vîb
,

1777 
dev_li°_ty≥
 
d°_ty≥
,

1778 c⁄° *
d°
,

1779 c⁄° *
§c
)

1781 
u£_ˇ£_devi˚
 *
devi˚
;

1782 
li°_hód
 *
pos
;

1784 
	`li°_f‹_óch
(
pos
, &
vîb
->
devi˚_li°
) {

1785 
devi˚
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_devi˚
, 
li°
);

1786 i‡(
	`°rcmp
(
devi˚
->
«me
, 
d°
) != 0)

1788 i‡(
devi˚
->
dev_li°
.
ty≥
 !
d°_ty≥
) {

1789 i‡(
	`li°_em±y
(&
devi˚
->
dev_li°
.
li°
)) {

1790 
devi˚
->
dev_li°
.
ty≥
 = 
d°_ty≥
;

1792 
	`uc_îr‹
("error: incompatible deviceÜistÅype ('%s', '%s')",

1793 
devi˚
->
«me
, 
§c
);

1794  -
EINVAL
;

1797  
	`uc_mgr_put_to_dev_li°
(&
devi˚
->
dev_li°
, 
§c
);

1799 
	`uc_îr‹
("îr‹: u«bÀÅÿföd devi˚ '%s'", 
d°
);

1800  -
ENOENT
;

1801 
	}
}

1803 
	$vîb_dev_li°_check
(
u£_ˇ£_vîb
 *
vîb
)

1805 
li°_hód
 *
pos
, *
pos2
;

1806 
u£_ˇ£_devi˚
 *
devi˚
;

1807 
dev_li°_node
 *
dli°
;

1808 
îr
;

1810 
	`li°_f‹_óch
(
pos
, &
vîb
->
devi˚_li°
) {

1811 
devi˚
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_devi˚
, 
li°
);

1812 
	`li°_f‹_óch
(
pos2
, &
devi˚
->
dev_li°
.
li°
) {

1813 
dli°
 = 
	`li°_íåy
(
pos2
, 
dev_li°_node
, 
li°
);

1814 
îr
 = 
	`vîb_dev_li°_add
(
vîb
, 
devi˚
->
dev_li°
.
ty≥
,

1815 
dli°
->
«me
, 
devi˚
->name);

1816 i‡(
îr
 < 0)

1817  
îr
;

1821 
	}
}

1823 
	$vîb_devi˚_m™agemít
(
u£_ˇ£_vîb
 *
vîb
)

1825 
li°_hód
 *
pos
;

1826 
ucm_dev_«me
 *
dev
;

1827 
îr
;

1830 
	`li°_f‹_óch
(
pos
, &
vîb
->
ª«me_li°
) {

1831 
dev
 = 
	`li°_íåy
(
pos
, 
ucm_dev_«me
, 
li°
);

1832 
îr
 = 
	`uc_mgr_ª«me_devi˚
(
vîb
, 
dev
->
«me1
, dev->
«me2
);

1833 i‡(
îr
 < 0) {

1834 
	`uc_îr‹
("îr‹: c™nŸÑíamêdevi˚ '%s'Åÿ'%s'", 
dev
->
«me1
, dev->
«me2
);

1835  
îr
;

1840 
	`li°_f‹_óch
(
pos
, &
vîb
->
ªmove_li°
) {

1841 
dev
 = 
	`li°_íåy
(
pos
, 
ucm_dev_«me
, 
li°
);

1842 
îr
 = 
	`uc_mgr_ªmove_devi˚
(
vîb
, 
dev
->
«me2
);

1843 i‡(
îr
 < 0) {

1844 
	`uc_îr‹
("îr‹: c™nŸÑemovêdevi˚ '%s'", 
dev
->
«me2
);

1845  
îr
;

1850 
	`uc_mgr_‰ì_dev_«me_li°
(&
vîb
->
ª«me_li°
);

1851 
	`uc_mgr_‰ì_dev_«me_li°
(&
vîb
->
ªmove_li°
);

1854  
	`vîb_dev_li°_check
(
vîb
);

1855 
	}
}

1894 
	$∑r£_vîb
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1895 
u£_ˇ£_vîb
 *
vîb
,

1896 
¢d_c⁄fig_t
 *
cfg
)

1898 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1899 
¢d_c⁄fig_t
 *
n
;

1900 
îr
;

1903 
îr
 = 
	`uc_mgr_evÆu©e_ö∂a˚
(
uc_mgr
, 
cfg
);

1904 i‡(
îr
 < 0)

1905  
îr
;

1908 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

1909 c⁄° *
id
;

1910 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

1911 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

1914 i‡(
	`°rcmp
(
id
, "EnableSequence") == 0) {

1915 
	`uc_dbg
("Parse EnableSequence");

1916 
îr
 = 
	`∑r£_£quí˚
(
uc_mgr
, &
vîb
->
íabÀ_li°
, 
n
);

1917 i‡(
îr
 < 0) {

1918 
	`uc_îr‹
("error: failedÅoÖarse verbÉnable sequence");

1919  
îr
;

1924 i‡(
	`°rcmp
(
id
, "DisableSequence") == 0) {

1925 
	`uc_dbg
("Parse DisableSequence");

1926 
îr
 = 
	`∑r£_£quí˚
(
uc_mgr
, &
vîb
->
dißbÀ_li°
, 
n
);

1927 i‡(
îr
 < 0) {

1928 
	`uc_îr‹
("error: failedÅoÖarse verb disable sequence");

1929  
îr
;

1934 i‡(
	`°rcmp
(
id
, "TransitionSequence") == 0) {

1935 
	`uc_dbg
("Parse TransitionSequence");

1936 
îr
 = 
	`∑r£_å™sôi⁄
(
uc_mgr
, &
vîb
->
å™sôi⁄_li°
, 
n
);

1937 i‡(
îr
 < 0) {

1938 
	`uc_îr‹
("error: failedÅoÖarseÅransition sequence");

1939  
îr
;

1944 i‡(
	`°rcmp
(
id
, "Value") == 0) {

1945 
	`uc_dbg
("Parse Value");

1946 
îr
 = 
	`∑r£_vÆue
(
uc_mgr
, &
vîb
->
vÆue_li°
, 
n
);

1947 i‡(
îr
 < 0)

1948  
îr
;

1954 
	}
}

1967 
	$∑r£_vîb_fûe
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

1968 c⁄° *
u£_ˇ£_«me
,

1969 c⁄° *
commít
,

1970 c⁄° *
fûe
)

1972 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

1973 
¢d_c⁄fig_t
 *
n
;

1974 
u£_ˇ£_vîb
 *
vîb
;

1975 
¢d_c⁄fig_t
 *
cfg
;

1976 
îr
;

1979 
vîb
 = 
	`ˇŒoc
(1, (
u£_ˇ£_vîb
));

1980 i‡(
vîb
 =
NULL
)

1981  -
ENOMEM
;

1982 
	`INIT_LIST_HEAD
(&
vîb
->
íabÀ_li°
);

1983 
	`INIT_LIST_HEAD
(&
vîb
->
dißbÀ_li°
);

1984 
	`INIT_LIST_HEAD
(&
vîb
->
å™sôi⁄_li°
);

1985 
	`INIT_LIST_HEAD
(&
vîb
->
devi˚_li°
);

1986 
	`INIT_LIST_HEAD
(&
vîb
->
cm±_devi˚_li°
);

1987 
	`INIT_LIST_HEAD
(&
vîb
->
modifõr_li°
);

1988 
	`INIT_LIST_HEAD
(&
vîb
->
vÆue_li°
);

1989 
	`INIT_LIST_HEAD
(&
vîb
->
ª«me_li°
);

1990 
	`INIT_LIST_HEAD
(&
vîb
->
ªmove_li°
);

1991 
	`li°_add_èû
(&
vîb
->
li°
, &
uc_mgr
->
vîb_li°
);

1992 i‡(
u£_ˇ£_«me
 =
NULL
)

1993  -
EINVAL
;

1994 
vîb
->
«me
 = 
	`°rdup
(
u£_ˇ£_«me
);

1995 i‡(
vîb
->
«me
 =
NULL
)

1996  -
ENOMEM
;

1998 i‡(
commít
 !
NULL
) {

1999 
vîb
->
commít
 = 
	`°rdup
(comment);

2000 i‡(
vîb
->
commít
 =
NULL
)

2001  -
ENOMEM
;

2005 
îr
 = 
	`uc_mgr_c⁄fig_lﬂd_fûe
(
uc_mgr
, 
fûe
, &
cfg
);

2006 i‡(
îr
 < 0)

2007  
îr
;

2010 
îr
 = 
	`uc_mgr_evÆu©e_ö∂a˚
(
uc_mgr
, 
cfg
);

2011 i‡(
îr
 < 0)

2012 
_îr
;

2015 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

2016 c⁄° *
id
;

2017 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

2018 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

2022 i‡(
	`°rcmp
(
id
, "SectionVerb") == 0) {

2023 
îr
 = 
	`∑r£_vîb
(
uc_mgr
, 
vîb
, 
n
);

2024 i‡(
îr
 < 0) {

2025 
	`uc_îr‹
("error: %s failedÅoÖarse verb",

2026 
fûe
);

2027 
_îr
;

2033 i‡(
	`°rcmp
(
id
, "SectionDevice") == 0) {

2034 
îr
 = 
	`∑r£_compound
(
uc_mgr
, 
n
,

2035 
∑r£_devi˚_«me
, 
vîb
, 
NULL
);

2036 i‡(
îr
 < 0) {

2037 
	`uc_îr‹
("error: %s failedÅoÖarse device",

2038 
fûe
);

2039 
_îr
;

2045 i‡(
	`°rcmp
(
id
, "SectionModifier") == 0) {

2046 
îr
 = 
	`∑r£_compound
(
uc_mgr
, 
n
,

2047 
∑r£_modifõr_«me
, 
vîb
, 
NULL
);

2048 i‡(
îr
 < 0) {

2049 
	`uc_îr‹
("error: %s failedÅoÖarse modifier",

2050 
fûe
);

2051 
_îr
;

2057 i‡(
	`°rcmp
(
id
, "RenameDevice") == 0) {

2058 
îr
 = 
	`∑r£_dev_«me_li°
(
uc_mgr
, 
n
, &
vîb
->
ª«me_li°
);

2059 i‡(
îr
 < 0) {

2060 
	`uc_îr‹
("error: %s failedÅoÖarse deviceÑename",

2061 
fûe
);

2062 
_îr
;

2068 i‡(
	`°rcmp
(
id
, "RemoveDevice") == 0) {

2069 
îr
 = 
	`∑r£_dev_«me_li°
(
uc_mgr
, 
n
, &
vîb
->
ªmove_li°
);

2070 i‡(
îr
 < 0) {

2071 
	`uc_îr‹
("error: %s failedÅoÖarse deviceÑemove",

2072 
fûe
);

2073 
_îr
;

2079 i‡(
uc_mgr
->
c⁄f_f‹m©
 > 3 && 
	`°rcmp
(
id
, "LibraryConfig") == 0) {

2080 
îr
 = 
	`∑r£_libc⁄fig
(
uc_mgr
, 
n
);

2081 i‡(
îr
 < 0) {

2082 
	`uc_îr‹
("error: failedÅoÖarse LibConfig");

2083 
_îr
;

2089 
	`¢d_c⁄fig_dñëe
(
cfg
);

2092 i‡(
	`li°_em±y
(&
vîb
->
devi˚_li°
)) {

2093 
	`uc_îr‹
("îr‹:Çÿu£ ca£ devi˚ deföed", 
fûe
);

2094  -
EINVAL
;

2098 
îr
 = 
	`vîb_devi˚_m™agemít
(
vîb
);

2099 i‡(
îr
 < 0) {

2100 
	`uc_îr‹
("îr‹: devi˚ m™agemíàîr‹ i¿vîb '%s'", 
vîb
->
«me
);

2101  
îr
;

2106 
_îr
:

2107 
	`¢d_c⁄fig_dñëe
(
cfg
);

2108  
îr
;

2109 
	}
}

2114 
	$∑r£_v¨ü¡
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
cfg
,

2115 **
_vfûe
, **
_vcommít
)

2117 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

2118 
¢d_c⁄fig_t
 *
n
;

2119 *
fûe
 = 
NULL
, *
commít
 = NULL;

2120 
îr
;

2123 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

2124 c⁄° *
id
;

2125 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

2126 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

2130 i‡(
	`°rcmp
(
id
, "File") == 0) {

2131 i‡(
_vfûe
) {

2132 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &
fûe
);

2133 i‡(
îr
 < 0) {

2134 
	`uc_îr‹
("failedÅo get File");

2135 
__îr‹
;

2142 i‡(
	`°∫cmp
(
id
, "Comment", 7) == 0) {

2143 i‡(
_vcommít
) {

2144 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &
commít
);

2145 i‡(
îr
 < 0) {

2146 
	`uc_îr‹
("error: failedÅo get Comment");

2147 
__îr‹
;

2153 
	`uc_îr‹
("unknow¿fõld '%s' i¿V¨ü¡ se˘i⁄", 
id
);

2154 
îr
 = -
EINVAL
;

2155 
__îr‹
;

2158 i‡(
_vfûe
)

2159 *
_vfûe
 = 
fûe
;

2160 i‡(
_vcommít
)

2161 *
_vcommít
 = 
commít
;

2164 
__îr‹
:

2165 
	`‰ì
(
fûe
);

2166 
	`‰ì
(
commít
);

2167  
îr
;

2168 
	}
}

2173 
	$∑r£_ma°î_£˘i⁄
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
cfg
,

2174 *
d©a1
 
ATTRIBUTE_UNUSED
,

2175 *
d©a2
 
ATTRIBUTE_UNUSED
)

2177 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

2178 
¢d_c⁄fig_t
 *
n
, *
v¨ü¡
 = 
NULL
;

2179 *
u£_ˇ£_«me
, *
fûe
 = 
NULL
, *
commít
 = NULL;

2180 
boﬁ
 
v¨ü¡_ok
 = 
Ál£
;

2181 
îr
;

2183 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

2184 
	`uc_îr‹
("compoundÅypeÉxpected for use case section");

2185  -
EINVAL
;

2188 
îr
 = 
	`∑r£_gë_ß„_«me
(
uc_mgr
, 
cfg
, 
NULL
, &
u£_ˇ£_«me
);

2189 i‡(
îr
 < 0) {

2190 
	`uc_îr‹
("unableÅo getÇame for use case section");

2191  
îr
;

2195 
uc_mgr
->
∑r£_ma°î_£˘i⁄
 = 1;

2196 
îr
 = 
	`uc_mgr_evÆu©e_ö∂a˚
(
uc_mgr
, 
cfg
);

2197 
uc_mgr
->
∑r£_ma°î_£˘i⁄
 = 0;

2198 i‡(
îr
 < 0)

2199 
__îr‹
;

2202 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

2203 c⁄° *
id
;

2204 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

2205 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

2209 i‡(
	`°rcmp
(
id
, "File") == 0) {

2210 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &
fûe
);

2211 i‡(
îr
 < 0) {

2212 
	`uc_îr‹
("failedÅo get File");

2213 
__îr‹
;

2219 i‡(
	`°∫cmp
(
id
, "Comment", 7) == 0) {

2220 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &
commít
);

2221 i‡(
îr
 < 0) {

2222 
	`uc_îr‹
("error: failedÅo get Comment");

2223 
__îr‹
;

2228 i‡(
uc_mgr
->
c⁄f_f‹m©
 >6 && 
	`°rcmp
(
id
, "Variant") == 0) {

2229 
¢d_c⁄fig_ôî©‹_t
 
i2
, 
√xt2
;

2230 
v¨ü¡
 = 
n
;

2231 
	`¢d_c⁄fig_f‹_óch
(
i2
, 
√xt2
, 
n
) {

2232 c⁄° *
id2
;

2233 
¢d_c⁄fig_t
 *
n2
;

2234 
n2
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i2
);

2235 i‡(
	`¢d_c⁄fig_gë_id
(
n2
, &
id2
) < 0)

2237 
îr
 = 
	`uc_mgr_evÆu©e_ö∂a˚
(
uc_mgr
, 
n2
);

2238 i‡(
îr
 < 0)

2239 
__îr‹
;

2240 i‡(
	`°rcmp
(
u£_ˇ£_«me
, 
id2
) == 0)

2241 
v¨ü¡_ok
 = 
åue
;

2246 
	`uc_îr‹
("unknow¿fõld '%s' i¿Se˘i⁄U£Ca£", 
id
);

2249 i‡(
v¨ü¡
 && !
v¨ü¡_ok
) {

2250 
	`uc_îr‹
("îr‹: undeföed v¨ü¡ '%s'", 
u£_ˇ£_«me
);

2251 
îr
 = -
EINVAL
;

2252 
__îr‹
;

2255 i‡(!
v¨ü¡
) {

2256 
	`uc_dbg
("u£_ˇ£_«mê%†fûê'%s'", 
u£_ˇ£_«me
, 
fûe
);

2259 i‡(!
fûe
) {

2260 
	`uc_îr‹
("error: use case missing file");

2261 
îr
 = -
EINVAL
;

2262 
__îr‹
;

2266 
îr
 = 
	`∑r£_vîb_fûe
(
uc_mgr
, 
u£_ˇ£_«me
, 
commít
, 
fûe
);

2269 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
v¨ü¡
) {

2270 *
vfûe
, *
vcommít
;

2271 c⁄° *
id
;

2272 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

2273 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

2275 i‡(!
	`∑r£_is_«me_ß„
(
id
)) {

2276 
îr
 = -
EINVAL
;

2277 
__îr‹
;

2279 
îr
 = 
	`∑r£_v¨ü¡
(
uc_mgr
, 
n
, &
vfûe
, &
vcommít
);

2280 i‡(
îr
 < 0)

2282 
uc_mgr
->
∑r£_v¨ü¡
 = 
id
;

2283 
îr
 = 
	`∑r£_vîb_fûe
(
uc_mgr
, 
id
,

2284 
vcommít
 ? vcommíà: 
commít
,

2285 
vfûe
 ? vfûê: 
fûe
);

2286 
uc_mgr
->
∑r£_v¨ü¡
 = 
NULL
;

2287 
	`‰ì
(
vfûe
);

2288 
	`‰ì
(
vcommít
);

2292 
__îr‹
:

2293 
	`‰ì
(
u£_ˇ£_«me
);

2294 
	`‰ì
(
fûe
);

2295 
	`‰ì
(
commít
);

2296  
îr
;

2297 
	}
}

2302 
	$∑r£_c⁄åﬁs_fixedboŸ
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
cfg
)

2304 
îr
;

2306 i‡(!
	`li°_em±y
(&
uc_mgr
->
fixedboŸ_li°
)) {

2307 
	`uc_îr‹
("FixedBootÜist isÇotÉmpty");

2308  -
EINVAL
;

2310 
îr
 = 
	`∑r£_£quí˚
(
uc_mgr
, &uc_mgr->
fixedboŸ_li°
, 
cfg
);

2311 i‡(
îr
 < 0) {

2312 
	`uc_îr‹
("UnableÅoÖarse FixedBootSequence");

2313  
îr
;

2317 
	}
}

2322 
	$∑r£_c⁄åﬁs_boŸ
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
cfg
)

2324 
îr
;

2326 i‡(!
	`li°_em±y
(&
uc_mgr
->
boŸ_li°
)) {

2327 
	`uc_îr‹
("BootÜist isÇotÉmpty");

2328  -
EINVAL
;

2330 
îr
 = 
	`∑r£_£quí˚
(
uc_mgr
, &uc_mgr->
boŸ_li°
, 
cfg
);

2331 i‡(
îr
 < 0) {

2332 
	`uc_îr‹
("UnableÅoÖarse BootSequence");

2333  
îr
;

2337 
	}
}

2342 
	$∑r£_c⁄åﬁs
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
cfg
)

2344 
îr
;

2346 i‡(!
	`li°_em±y
(&
uc_mgr
->
deÁu…_li°
)) {

2347 
	`uc_îr‹
("DefaultÜist isÇotÉmpty");

2348  -
EINVAL
;

2350 
îr
 = 
	`∑r£_£quí˚
(
uc_mgr
, &uc_mgr->
deÁu…_li°
, 
cfg
);

2351 i‡(
îr
 < 0) {

2352 
	`uc_îr‹
("UnableÅoÖarse SectionDefaults");

2353  
îr
;

2357 
	}
}

2407 
	$∑r£_ma°î_fûe
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
cfg
)

2409 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

2410 
¢d_c⁄fig_t
 *
n
;

2411 c⁄° *
id
;

2412 
îr
;

2414 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

2415 
	`uc_îr‹
("compoundÅypeÉxpected for master file");

2416  -
EINVAL
;

2419 i‡(
uc_mgr
->
c⁄f_f‹m©
 >= 2) {

2420 
îr
 = 
	`∑r£_sy¡ax_fõld
(
uc_mgr
, 
cfg
, uc_mgr->
c⁄f_fûe_«me
);

2421 i‡(
îr
 < 0)

2422  
îr
;

2426 
îr
 = 
	`uc_mgr_evÆu©e_ö∂a˚
(
uc_mgr
, 
cfg
);

2427 i‡(
îr
 < 0)

2428  
îr
;

2431 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

2433 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

2434 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

2437 i‡(
	`°rcmp
(
id
, "Comment") == 0) {

2438 
îr
 = 
	`∑r£_°rög_sub°ôuã3
(
uc_mgr
, 
n
, &uc_mgr->
commít
);

2439 i‡(
îr
 < 0) {

2440 
	`uc_îr‹
("error: failedÅo get master comment");

2441  
îr
;

2447 i‡(
	`°rcmp
(
id
, "SectionUseCase") == 0) {

2448 
îr
 = 
	`∑r£_compound
(
uc_mgr
, 
n
,

2449 
∑r£_ma°î_£˘i⁄
,

2450 
NULL
, NULL);

2451 i‡(
îr
 < 0)

2452  
îr
;

2457 i‡(
	`°rcmp
(
id
, "FixedBootSequence") == 0) {

2458 
îr
 = 
	`∑r£_c⁄åﬁs_fixedboŸ
(
uc_mgr
, 
n
);

2459 i‡(
îr
 < 0)

2460  
îr
;

2465 i‡(
	`°rcmp
(
id
, "BootSequence") == 0) {

2466 
îr
 = 
	`∑r£_c⁄åﬁs_boŸ
(
uc_mgr
, 
n
);

2467 i‡(
îr
 < 0)

2468  
îr
;

2473 i‡(
	`°rcmp
(
id
, "SectionDefaults") == 0) {

2474 
îr
 = 
	`∑r£_c⁄åﬁs
(
uc_mgr
, 
n
);

2475 i‡(
îr
 < 0)

2476  
îr
;

2481 i‡(
	`°rcmp
(
id
, "ValueDefaults") == 0) {

2482 
îr
 = 
	`∑r£_vÆue
(
uc_mgr
, &uc_mgr->
vÆue_li°
, 
n
);

2483 i‡(
îr
 < 0) {

2484 
	`uc_îr‹
("error: failedÅoÖarse ValueDefaults");

2485  
îr
;

2491 i‡(
uc_mgr
->
c⁄f_f‹m©
 > 3 && 
	`°rcmp
(
id
, "LibraryConfig") == 0) {

2492 
îr
 = 
	`∑r£_libc⁄fig
(
uc_mgr
, 
n
);

2493 i‡(
îr
 < 0) {

2494 
	`uc_îr‹
("error: failedÅoÖarse LibraryConfig");

2495  
îr
;

2501 i‡(
	`°rcmp
(
id
, "Error") == 0)

2502  
	`îr‹_node
(
uc_mgr
, 
n
);

2505 i‡(
	`°rcmp
(
id
, "Syntax") == 0)

2508 
	`uc_îr‹
("unknow¿ma°î fûêfõld %s", 
id
);

2511 
	}
}

2514 
	$gë_ˇrd_öfo
(
¢d_u£_ˇ£_mgr_t
 *
mgr
,

2515 c⁄° *
˘l_«me
,

2516 
¢d_˘l_ˇrd_öfo_t
 **
öfo
)

2518 
˘l_li°
 *ctl_list;

2519 
îr
;

2521 
îr
 = 
	`uc_mgr_›í_˘l
(
mgr
, &
˘l_li°
, 
˘l_«me
, 0);

2522 i‡(
îr
 < 0)

2523  
îr
;

2525 i‡(
öfo
)

2526 *
öfo
 = 
˘l_li°
->
˘l_öfo
;

2527  
îr
;

2528 
	}
}

2531 
	$gë_by_ˇrd_«me
(
¢d_u£_ˇ£_mgr_t
 *
mgr
, c⁄° *
ˇrd_«me
)

2533 
ˇrd
, 
îr
;

2534 
¢d_˘l_ˇrd_öfo_t
 *
öfo
;

2535 c⁄° *
_drivî
, *
_«me
, *
_l⁄g_«me
;

2537 
	`¢d_˘l_ˇrd_öfo_Æloˇ
(&
öfo
);

2539 
ˇrd
 = -1;

2540 i‡(
	`¢d_ˇrd_√xt
(&
ˇrd
) < 0 || card < 0) {

2541 
	`uc_îr‹
("no soundcards found...");

2545 
ˇrd
 >= 0) {

2546 
«me
[32];

2549 
	`uc_mgr_‰ì_˘l_li°
(
mgr
);

2551 
	`•rötf
(
«me
, "hw:%d", 
ˇrd
);

2552 
îr
 = 
	`gë_ˇrd_öfo
(
mgr
, 
«me
, &
öfo
);

2554 i‡(
îr
 == 0) {

2555 
_drivî
 = 
	`¢d_˘l_ˇrd_öfo_gë_drivî
(
öfo
);

2556 
_«me
 = 
	`¢d_˘l_ˇrd_öfo_gë_«me
(
öfo
);

2557 
_l⁄g_«me
 = 
	`¢d_˘l_ˇrd_öfo_gë_l⁄g«me
(
öfo
);

2558 i‡(!
	`°rcmp
(
ˇrd_«me
, 
_drivî
) ||

2559 !
	`°rcmp
(
ˇrd_«me
, 
_«me
) ||

2560 !
	`°rcmp
(
ˇrd_«me
, 
_l⁄g_«me
))

2564 i‡(
	`¢d_ˇrd_√xt
(&
ˇrd
) < 0) {

2565 
	`uc_îr‹
("snd_card_next");

2570 
	`uc_mgr_‰ì_˘l_li°
(
mgr
);

2573 
	}
}

2576 
ölöe
 
	$gë_by_ˇrd
(
¢d_u£_ˇ£_mgr_t
 *
mgr
, c⁄° *
˘l_«me
)

2578  
	`gë_ˇrd_öfo
(
mgr
, 
˘l_«me
, 
NULL
);

2579 
	}
}

2581 
	$∑r£_t›Àvñ_∑th
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2582 *
fûíame
,

2583 
¢d_c⁄fig_t
 *
cfg
)

2585 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
, 
i2
, 
√xt2
;

2586 
¢d_c⁄fig_t
 *
n
, *
n2
;

2587 c⁄° *
id
;

2588 *
dú
 = 
NULL
, *
fûe
 = NULL, 
‚
[
PATH_MAX
];

2589 
°©64
 
°
;

2590 
vîsi⁄
;

2591 
îr
;

2593 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

2594 
	`uc_îr‹
("compoundÅypeÉxpected for UseCasePathÇode");

2595  -
EINVAL
;

2599 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

2600 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

2602 i‡(
	`¢d_c⁄fig_gë_ty≥
(
n
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

2603 
	`uc_îr‹
("compoundÅypeÉxpected for UseCasePath.somethingÇode");

2604  -
EINVAL
;

2607 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

2610 
vîsi⁄
 = 2;

2613 
	`¢d_c⁄fig_f‹_óch
(
i2
, 
√xt2
, 
n
) {

2615 
n2
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i2
);

2616 i‡(
	`¢d_c⁄fig_gë_id
(
n2
, &
id
) < 0)

2619 i‡(
	`°rcmp
(
id
, "Version") == 0) {

2620 
îr
 = 
	`∑r£_öãgî_sub°ôuã
(
uc_mgr
, 
n2
, &
vîsi⁄
);

2621 i‡(
îr
 < 0) {

2622 
	`uc_îr‹
("unableÅoÖarse UcmDirectory");

2623 
__îr‹
;

2625 i‡(
vîsi⁄
 < 1 || version > 2) {

2626 
	`uc_îr‹
("Version must be 1 or 2");

2627 
îr
 = -
EINVAL
;

2628 
__îr‹
;

2633 i‡(
	`°rcmp
(
id
, "Directory") == 0) {

2634 
îr
 = 
	`∑r£_°rög_sub°ôuã
(
uc_mgr
, 
n2
, &
dú
);

2635 i‡(
îr
 < 0) {

2636 
	`uc_îr‹
("unableÅoÖarse Directory");

2637 
__îr‹
;

2642 i‡(
	`°rcmp
(
id
, "File") == 0) {

2643 
îr
 = 
	`∑r£_°rög_sub°ôuã
(
uc_mgr
, 
n2
, &
fûe
);

2644 i‡(
îr
 < 0) {

2645 
	`uc_îr‹
("unableÅoÖarse File");

2646 
__îr‹
;

2651 
	`uc_îr‹
("unknow¿U£Ca£P©h fõld %s", 
id
);

2654 i‡(
dú
 =
NULL
) {

2655 
	`uc_îr‹
("Dúe˘‹y i†nŸ deföed i¿%s!", 
fûíame
);

2656 
__√xt
;

2658 i‡(
fûe
 =
NULL
) {

2659 
	`uc_îr‹
("Fûêi†nŸ deföed i¿%s!", 
fûíame
);

2660 
__√xt
;

2663 
	`ucm_fûíame
(
‚
, (‚), 
vîsi⁄
, 
dú
, 
fûe
);

2664 i‡(
	`ac˚ss
(
‚
, 
R_OK
Ë=0 && 
	`l°©64
(‚, &
°
) == 0) {

2665 i‡(
	`S_ISLNK
(
°
.
°_mode
)) {

2666 
ssize_t
 
r
;

2667 *
lök
, *
dú2
, *
p
;

2669 
lök
 = 
	`mÆloc
(
PATH_MAX
);

2670 i‡(
lök
 =
NULL
)

2671 
__íomem
;

2672 
r
 = 
	`ªadlök
(
‚
, 
lök
, 
PATH_MAX
 - 1);

2673 i‡(
r
 <= 0) {

2674 
	`‰ì
(
lök
);

2675 
__√xt
;

2677 
lök
[
r
] = '\0';

2678 
p
 = 
	`°ºchr
(
lök
, '/');

2679 i‡(
p
) {

2680 *
p
 = '\0';

2681 
dú2
 = 
	`mÆloc
(
PATH_MAX
);

2682 i‡(
dú2
 =
NULL
) {

2683 
	`‰ì
(
lök
);

2684 
__íomem
;

2686 
	`°∫˝y
(
dú2
, 
dú
, 
PATH_MAX
 - 1);

2687 
	`°∫ˇt
(
dú2
, "/", 
PATH_MAX
 - 1);

2688 
	`°∫ˇt
(
dú2
, 
lök
, 
PATH_MAX
 - 1);

2689 
‚
[
PATH_MAX
 - 1] = '\0';

2690 
	`‰ì
(
dú
);

2691 
dú
 = 
dú2
;

2693 
	`‰ì
(
lök
);

2695 i‡(
	`ª∂a˚_°rög
(&
uc_mgr
->
c⁄f_dú_«me
, 
dú
Ë=
NULL
)

2696 
__íomem
;

2697 i‡(
	`ª∂a˚_°rög
(&
uc_mgr
->
c⁄f_fûe_«me
, 
fûe
Ë=
NULL
)

2698 
__íomem
;

2699 
	`°∫˝y
(
fûíame
, 
‚
, 
PATH_MAX
);

2700 
fûíame
[
PATH_MAX
 - 1] = '\0';

2701 
uc_mgr
->
c⁄f_f‹m©
 = 
vîsi⁄
;

2702 
__ok
;

2705 
__√xt
:

2706 
	`‰ì
(
fûe
);

2707 i‡(
dú
 !
‚
)

2708 
	`‰ì
(
dú
);

2709 
dú
 = 
NULL
;

2710 
fûe
 = 
NULL
;

2713 
îr
 = -
ENOENT
;

2714 
__îr‹
;

2716 
__íomem
:

2717 
îr
 = -
ENOMEM
;

2718 
__îr‹
;

2720 
__ok
:

2721 
îr
 = 0;

2722 
__îr‹
:

2723 
	`‰ì
(
fûe
);

2724 i‡(
dú
 !
‚
)

2725 
	`‰ì
(
dú
);

2726  
îr
;

2727 
	}
}

2729 
	$∑r£_t›Àvñ_c⁄fig
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2730 *
fûíame
,

2731 
¢d_c⁄fig_t
 *
cfg
)

2733 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

2734 
¢d_c⁄fig_t
 *
n
;

2735 c⁄° *
id
;

2736 
îr
;

2738 i‡(
	`¢d_c⁄fig_gë_ty≥
(
cfg
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

2739 
	`uc_îr‹
("compoundÅypeÉxpected forÅoplevel file");

2740  -
EINVAL
;

2743 
îr
 = 
	`∑r£_sy¡ax_fõld
(
uc_mgr
, 
cfg
, 
fûíame
);

2744 i‡(
îr
 < 0)

2745  
îr
;

2748 
îr
 = 
	`uc_mgr_evÆu©e_ö∂a˚
(
uc_mgr
, 
cfg
);

2749 i‡(
îr
 < 0)

2750  
îr
;

2753 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
cfg
) {

2755 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

2756 i‡(
	`¢d_c⁄fig_gë_id
(
n
, &
id
) < 0)

2759 i‡(
	`°rcmp
(
id
, "UseCasePath") == 0) {

2760 
îr
 = 
	`∑r£_t›Àvñ_∑th
(
uc_mgr
, 
fûíame
, 
n
);

2761 i‡(
îr
 == 0)

2762  
îr
;

2767 i‡(
uc_mgr
->
c⁄f_f‹m©
 > 3 && 
	`°rcmp
(
id
, "LibraryConfig") == 0) {

2768 
îr
 = 
	`∑r£_libc⁄fig
(
uc_mgr
, 
n
);

2769 i‡(
îr
 < 0) {

2770 
	`uc_îr‹
("error: failedÅoÖarse LibConfig");

2771  
îr
;

2777 i‡(
	`°rcmp
(
id
, "Syntax") == 0)

2780 
	`uc_îr‹
("unknow¿t›Àvñ fõld %s", 
id
);

2783  -
ENOENT
;

2784 
	}
}

2786 
	$lﬂd_t›Àvñ_c⁄fig
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

2787 
¢d_c⁄fig_t
 **
cfg
)

2789 
fûíame
[
PATH_MAX
];

2790 
¢d_c⁄fig_t
 *
tcfg
;

2791 
îr
;

2793 
	`ucm_fûíame
(
fûíame
, (fûíame), 2, 
NULL
, "ucm.conf");

2795 i‡(
	`ac˚ss
(
fûíame
, 
R_OK
) != 0) {

2796 
	`uc_îr‹
("U«bÀÅÿfödÅhêt›-Àvñ c⁄figuøti⁄ fûê'%s'.", 
fûíame
);

2797  -
ENOENT
;

2800 
îr
 = 
	`uc_mgr_c⁄fig_lﬂd
(2, 
fûíame
, &
tcfg
);

2801 i‡(
îr
 < 0)

2802 
__îr‹
;

2805 
îr
 = 
	`∑r£_t›Àvñ_c⁄fig
(
uc_mgr
, 
fûíame
, 
tcfg
);

2806 
	`¢d_c⁄fig_dñëe
(
tcfg
);

2807 i‡(
îr
 < 0)

2808 
__îr‹
;

2810 
îr
 = 
	`uc_mgr_c⁄fig_lﬂd
(
uc_mgr
->
c⁄f_f‹m©
, 
fûíame
, 
cfg
);

2811 i‡(
îr
 < 0) {

2812 
	`uc_îr‹
("error: couldÇotÖarse configuration for card %s",

2813 
uc_mgr
->
ˇrd_«me
);

2814 
__îr‹
;

2819 
__îr‹
:

2820  
îr
;

2821 
	}
}

2825 
	$uc_mgr_imp‹t_ma°î_c⁄fig
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

2827 
¢d_c⁄fig_t
 *
cfg
;

2828 c⁄° *
«me
;

2829 
îr
;

2831 
îr
 = 
	`¢d_c⁄fig_t›
(&
uc_mgr
->
loˇl_c⁄fig
);

2832 i‡(
îr
 < 0)

2833  
îr
;

2835 
îr
 = 
	`¢d_c⁄fig_t›
(&
uc_mgr
->
ma¸os
);

2836 i‡(
îr
 < 0)

2837  
îr
;

2839 
«me
 = 
uc_mgr
->
ˇrd_«me
;

2840 i‡(
	`°∫cmp
(
«me
, "hw:", 3) == 0) {

2841 
îr
 = 
	`gë_by_ˇrd
(
uc_mgr
, 
«me
);

2842 i‡(
îr
 < 0) {

2843 
	`uc_îr‹
("ˇrd '%s' i†nŸ vÆid", 
«me
);

2844 
__îr‹
;

2846 } i‡(
	`°∫cmp
(
«me
, "strict:", 7)) {

2849 
	`gë_by_ˇrd_«me
(
uc_mgr
, 
«me
);

2852 
îr
 = 
	`lﬂd_t›Àvñ_c⁄fig
(
uc_mgr
, &
cfg
);

2853 i‡(
îr
 < 0)

2854 
__îr‹
;

2856 
îr
 = 
	`∑r£_ma°î_fûe
(
uc_mgr
, 
cfg
);

2857 i‡(
uc_mgr
->
ma¸os
) {

2858 
	`¢d_c⁄fig_dñëe
(
uc_mgr
->
ma¸os
);

2859 
uc_mgr
->
ma¸os
 = 
NULL
;

2861 
	`¢d_c⁄fig_dñëe
(
cfg
);

2862 i‡(
îr
 < 0) {

2863 
	`uc_mgr_‰ì_˘l_li°
(
uc_mgr
);

2864 
	`uc_mgr_‰ì_vîb
(
uc_mgr
);

2867  
îr
;

2869 
__îr‹
:

2870 
	`uc_mgr_‰ì_˘l_li°
(
uc_mgr
);

2871 
	`ª∂a˚_°rög
(&
uc_mgr
->
c⁄f_dú_«me
, 
NULL
);

2872  
îr
;

2873 
	}
}

2875 
	$fûíame_fûãr
(c⁄° 
dúít64
 *
dúít
)

2877 i‡(
dúít
 =
NULL
)

2879 i‡(
dúít
->
d_ty≥
 =
DT_DIR
) {

2880 i‡(
dúít
->
d_«me
[0] == '.') {

2881 i‡(
dúít
->
d_«me
[1] == '\0')

2883 i‡(
dúít
->
d_«me
[1] == '.' &&

2884 
dúít
->
d_«me
[2] == '\0')

2890 
	}
}

2900 
	$uc_mgr_sˇn_ma°î_c⁄figs
(c⁄° **
_li°
[])

2902 
fûíame
[
PATH_MAX
], 
dÊ
[PATH_MAX], 
‚
[
FILENAME_MAX
];

2903 *
ív
 = 
	`gëív
(
ALSA_CONFIG_UCM2_VAR
);

2904 
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
;

2905 c⁄° **
li°
, *
d_«me
;

2906 *
s
;

2907 
¢d_c⁄fig_t
 *
cfg
, *
c
;

2908 
i
, 
j
, 
˙t
, 
îr
, 
ˇrds
;

2909 
l
;

2910 
ssize_t
 
ss
;

2911 
dúít64
 **
«mñi°
;

2913 
i
 = -1;

2914 
ˇrds
 = 0;

2916 
îr
 = 
	`¢d_ˇrd_√xt
(&
i
);

2917 i‡(
îr
 < 0)

2918  
îr
;

2919 i‡(
i
 < 0)

2921 
ˇrds
++;

2923 
ˇrds
 += 4;

2925 i‡(
ív
)

2926 
	`¢¥ötf
(
fûíame
, (fûíame), "%s/c⁄f.vút.d", 
ív
);

2928 
	`¢¥ötf
(
fûíame
, (filename), "%s/ucm2/conf.virt.d",

2929 
	`¢d_c⁄fig_t›dú
());

2931 #i‡
	`deföed
(
_GNU_SOURCE
Ë&& !deföed(
__NëBSD__
Ë&& !deföed(
__FªeBSD__
Ë&& !deföed(
__O≥nBSD__
Ë&& !deföed(
__Døg⁄Fly__
Ë&& !deföed(
__sun
Ë&& !deföed(
__ANDROID__
)

2932 
	#SORTFUNC
 
vîsi⁄s‹t64


	)

2934 
	#SORTFUNC
 
Æphas‹t64


	)

2936 
îr
 = 
	`sˇndú64
(
fûíame
, &
«mñi°
, 
fûíame_fûãr
, 
SORTFUNC
);

2937 i‡(
îr
 < 0) {

2938 
îr
 = -
î∫o
;

2939 
	`uc_îr‹
("error: couldÇot scan directory %s: %s",

2940 
fûíame
, 
	`°ªº‹
(-
îr
));

2941  
îr
;

2943 
˙t
 = 
îr
;

2945 
dÊ
[0] = '\0';

2946 i‡(
	`°æí
(
fûíame
) + 8 < (filename)) {

2947 
	`°rˇt
(
fûíame
, "/default");

2948 
ss
 = 
	`ªadlök
(
fûíame
, 
dÊ
, (dfl)-1);

2949 i‡(
ss
 >= 0) {

2950 
dÊ
[
ss
] = '\0';

2951 
dÊ
[(dfl)-1] = '\0';

2952 i‡(
dÊ
[0] && dÊ[
	`°æí
(dfl)-1] == '/')

2953 
dÊ
[
	`°æí
(dfl)-1] = '\0';

2955 
dÊ
[0] = '\0';

2959 
j
 = 0;

2960 
li°
 = 
	`ˇŒoc
(1, (
ˇrds
 + 
˙t
) * 2 * (*));

2961 i‡(
li°
 =
NULL
) {

2962 
îr
 = -
ENOMEM
;

2963 
__îr
;

2966 
i
 = -1;

2967 
j
 / 2 < 
ˇrds
) {

2968 
îr
 = 
	`¢d_ˇrd_√xt
(&
i
);

2969 i‡(
îr
 < 0)

2970 
__îr
;

2971 i‡(
i
 < 0)

2973 
	`¢¥ötf
(
‚
, (‚), "-hw:%d", 
i
);

2974 
îr
 = 
	`¢d_u£_ˇ£_mgr_›í
(&
uc_mgr
, 
‚
);

2975 i‡(
îr
 =-
ENOENT
 ||Éº =-
ENXIO
)

2977 i‡(
îr
 < 0) {

2978 
	`uc_îr‹
("U«bÀÅÿ›í '%s': %s", 
‚
, 
	`¢d_°ªº‹
(
îr
));

2979 
__îr
;

2981 
îr
 = 
	`¢d_u£_ˇ£_gë
(
uc_mgr
, "commít", (c⁄° **)&
s
);

2982 i‡(
îr
 < 0) {

2983 
îr
 = 
	`¢d_ˇrd_gë_l⁄g«me
(
i
, &
s
);

2984 i‡(
îr
 < 0)

2985 
__îr
;

2987 
	`¢d_u£_ˇ£_mgr_˛o£
(
uc_mgr
);

2988 
li°
[
j
] = 
	`°rdup
(
‚
 + 1);

2989 i‡(
li°
[
j
] =
NULL
) {

2990 
	`‰ì
(
s
);

2991 
îr
 = -
ENOMEM
;

2992 
__îr
;

2994 
li°
[
j
 + 1] = 
s
;

2995 
j
 += 2;

2998 
i
 = 0; i < 
˙t
; i++) {

3000 
d_«me
 = 
«mñi°
[
i
]->d_name;

3002 
	`¢¥ötf
(
‚
, (‚), "%s.c⁄f", 
d_«me
);

3003 
	`ucm_fûíame
(
fûíame
, (fûíame), 2, 
d_«me
, 
‚
);

3004 #ifde‡
HAVE_EACCESS


3005 i‡(
	`óc˚ss
(
fûíame
, 
R_OK
))

3007 i‡(
	`ac˚ss
(
fûíame
, 
R_OK
))

3011 
îr
 = 
	`uc_mgr_c⁄fig_lﬂd
(2, 
fûíame
, &
cfg
);

3012 i‡(
îr
 < 0)

3013 
__îr
;

3014 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
cfg
, "Sy¡ax", &
c
);

3015 i‡(
îr
 < 0) {

3016 
	`uc_îr‹
("Sy¡ax fõldÇŸ found i¿%s", 
d_«me
);

3017 
	`¢d_c⁄fig_dñëe
(
cfg
);

3020 
îr
 = 
	`¢d_c⁄fig_gë_öãgî
(
c
, &
l
);

3021 i‡(
îr
 < 0) {

3022 
	`uc_îr‹
("Sy¡ax fõld i†övÆid i¿%s", 
d_«me
);

3023 
	`¢d_c⁄fig_dñëe
(
cfg
);

3024 
__îr
;

3026 i‡(
l
 < 2 ||Ü > 
SYNTAX_VERSION_MAX
) {

3027 
	`uc_îr‹
("Incom∑tibÀ sy¡ax %d i¿%s", 
l
, 
d_«me
);

3028 
	`¢d_c⁄fig_dñëe
(
cfg
);

3029 
__îr
;

3031 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
cfg
, "Commít", &
c
);

3032 i‡(
îr
 >= 0) {

3033 
îr
 = 
	`∑r£_°rög
(
c
, (**)&
li°
[
j
+1]);

3034 i‡(
îr
 < 0) {

3035 
	`¢d_c⁄fig_dñëe
(
cfg
);

3036 
__îr
;

3039 
	`¢d_c⁄fig_dñëe
(
cfg
);

3040 
li°
[
j
] = 
	`°rdup
(
d_«me
);

3041 i‡(
li°
[
j
] =
NULL
) {

3042 
îr
 = -
ENOMEM
;

3043 
__îr
;

3045 i‡(
	`°rcmp
(
dÊ
, 
li°
[
j
]) == 0) {

3047 c⁄° *
ßve1
 = 
li°
[
j
];

3048 c⁄° *
ßve2
 = 
li°
[
j
 + 1];

3049 
	`memmove
(
li°
 + 2,Üi°, 
j
 * (*));

3050 
li°
[0] = 
ßve1
;

3051 
li°
[1] = 
ßve2
;

3053 
j
 += 2;

3055 
îr
 = 0;

3057 
__îr
:

3058 
i
 = 0; i < 
˙t
; i++)

3059 
	`‰ì
(
«mñi°
[
i
]);

3060 
	`‰ì
(
«mñi°
);

3061 i‡(
îr
 < 0) {

3062 
i
 = 0; i < 
j
; i++) {

3063 
	`‰ì
((*)
li°
[
i
 * 2]);

3064 
	`‰ì
((*)
li°
[
i
 * 2 + 1]);

3066 
	`‰ì
(
li°
);

3067  
îr
;

3070 *
_li°
 = 
li°
;

3071  
j
;

3072 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_cond.c

27 
	~"ucm_loˇl.h
"

28 
	~<ªgex.h
>

30 
	$gë_°rög
(
¢d_c⁄fig_t
 *
compound
, c⁄° *
key
, c⁄° **
°r
)

32 
¢d_c⁄fig_t
 *
node
;

33 
îr
;

35 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
compound
, 
key
, &
node
);

36 i‡(
îr
 < 0)

37  
îr
;

38  
	`¢d_c⁄fig_gë_°rög
(
node
, 
°r
);

39 
	}
}

41 
	$if_evÆ_°rög
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
evÆ
)

43 c⁄° *
°rög1
 = 
NULL
, *
°rög2
 = NULL;

44 *
s1
, *
s2
;

45 
îr
;

47 i‡(
uc_mgr
->
c⁄f_f‹m©
 >= 3) {

48 
îr
 = 
	`gë_°rög
(
evÆ
, "Em±y", &
°rög1
);

49 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

50 
	`uc_îr‹
("StringÉrror (If.Condition.Empty)");

51  -
EINVAL
;

54 i‡(
°rög1
) {

55 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s1
, 
°rög1
);

56 i‡(
îr
 < 0)

57  
îr
;

58 
îr
 = 
s1
 =
NULL
 || s1[0] == '\0';

59 
	`‰ì
(
s1
);

60  
îr
;

64 
îr
 = 
	`gë_°rög
(
evÆ
, "Såög1", &
°rög1
);

65 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

66 
	`uc_îr‹
("StringÉrror (If.Condition.String1)");

67  -
EINVAL
;

70 
îr
 = 
	`gë_°rög
(
evÆ
, "Såög2", &
°rög2
);

71 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

72 
	`uc_îr‹
("StringÉrror (If.Condition.String2)");

73  -
EINVAL
;

76 i‡(
°rög1
 || 
°rög2
) {

77 i‡(
°rög1
 =
NULL
) {

78 
	`uc_îr‹
("If.Condition.String1Çot defined");

79  -
EINVAL
;

81 i‡(
°rög2
 =
NULL
) {

82 
	`uc_îr‹
("If.Condition.String2Çot defined");

83  -
EINVAL
;

85 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s1
, 
°rög1
);

86 i‡(
îr
 < 0)

87  
îr
;

88 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s2
, 
°rög2
);

89 i‡(
îr
 < 0) {

90 
	`‰ì
(
s1
);

91  
îr
;

93 
îr
 = 
	`°rˇ£cmp
(
s1
, 
s2
) == 0;

94 
	`‰ì
(
s2
);

95 
	`‰ì
(
s1
);

96  
îr
;

99 
îr
 = 
	`gë_°rög
(
evÆ
, "Hay°ack", &
°rög1
);

100 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

101 
	`uc_îr‹
("StringÉrror (If.Condition.Haystack)");

102  -
EINVAL
;

105 
îr
 = 
	`gë_°rög
(
evÆ
, "NìdÀ", &
°rög2
);

106 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

107 
	`uc_îr‹
("StringÉrror (If.Condition.Needle)");

108  -
EINVAL
;

111 i‡(
°rög1
 || 
°rög2
) {

112 i‡(
°rög1
 =
NULL
) {

113 
	`uc_îr‹
("If.Condition.HaystackÇot defined");

114  -
EINVAL
;

116 i‡(
°rög2
 =
NULL
) {

117 
	`uc_îr‹
("If.Condition.NeedleÇot defined");

118  -
EINVAL
;

120 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s1
, 
°rög1
);

121 i‡(
îr
 < 0)

122  
îr
;

123 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s2
, 
°rög2
);

124 i‡(
îr
 < 0) {

125 
	`‰ì
(
s1
);

126  
îr
;

128 
îr
 = 
	`°r°r
(
s1
, 
s2
Ë!
NULL
;

129 
	`‰ì
(
s2
);

130 
	`‰ì
(
s1
);

131  
îr
;

134 
	`uc_îr‹
("Unknown String conditionárguments");

135  -
EINVAL
;

136 
	}
}

138 
	$if_evÆ_ªgex_m©ch
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
evÆ
)

140 c⁄° *
°rög
, *
ªgex_°rög
;

141 *
s
;

142 
ªgex_t
 
ª
;

143 
›ti⁄s
 = 
REG_EXTENDED
 | 
REG_ICASE
;

144 
ªgm©ch_t
 
m©ch
[1];

145 
îr
;

147 
îr
 = 
	`gë_°rög
(
evÆ
, "Såög", &
°rög
);

148 i‡(
îr
 < 0) {

149 
	`uc_îr‹
("RegexMatchÉrror (If.Condition.String)");

150  -
EINVAL
;

153 
îr
 = 
	`gë_°rög
(
evÆ
, "Regex", &
ªgex_°rög
);

154 i‡(
îr
 < 0) {

155 
	`uc_îr‹
("RegexMatchÉrror (If.Condition.Regex)");

156  -
EINVAL
;

159 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s
, 
ªgex_°rög
);

160 i‡(
îr
 < 0)

161  
îr
;

162 
îr
 = 
	`ªgcomp
(&
ª
, 
s
, 
›ti⁄s
);

163 i‡(
îr
) {

164 
	`uc_îr‹
("Regex '%s' compû©i⁄ faûed (codê%d)", 
s
, 
îr
);

165 
	`‰ì
(
s
);

166  -
EINVAL
;

168 
	`‰ì
(
s
);

170 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s
, 
°rög
);

171 i‡(
îr
 < 0) {

172 
	`ªg‰ì
(&
ª
);

173  
îr
;

175 
îr
 = 
	`ªgexec
(&
ª
, 
s
, 
	`ARRAY_SIZE
(
m©ch
), match, 0);

176 
	`‰ì
(
s
);

177 
	`ªg‰ì
(&
ª
);

178  
îr
 == 0;

179 
	}
}

181 
	$if_evÆ_c⁄åﬁ_exi°s
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
evÆ
)

183 
¢d_˘l_t
 *
˘l
;

184 
˘l_li°
 *ctl_list;

185 c⁄° *
devi˚
 = 
NULL
, *
˘ldef
, *
íumvÆ
 = NULL, *
«me
;

186 
¢d_˘l_ñem_id_t
 *
ñem_id
;

187 
¢d_˘l_ñem_öfo_t
 *
ñem_öfo
;

188 
¢d_˘l_ñem_ty≥_t
 
ty≥
;

189 *
s
;

190 
îr
, 
i
, 
ôems
;

192 
	`¢d_˘l_ñem_id_Æloˇ
(&
ñem_id
);

193 
	`¢d_˘l_ñem_öfo_Æloˇ
(&
ñem_öfo
);

195 
îr
 = 
	`gë_°rög
(
evÆ
, "Devi˚", &
devi˚
);

196 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

197 
	`uc_îr‹
("ControlExistsÉrror (If.Condition.Device)");

198  -
EINVAL
;

201 
îr
 = 
	`gë_°rög
(
evÆ
, "C⁄åﬁ", &
˘ldef
);

202 i‡(
îr
 < 0) {

203 
	`uc_îr‹
("ControlExistsÉrror (If.Condition.Control)");

204  -
EINVAL
;

207 
îr
 = 
	`gë_°rög
(
evÆ
, "C⁄åﬁEnum", &
íumvÆ
);

208 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

209 
	`uc_îr‹
("ControlExistsÉrror (If.Condition.ControlEnum)");

210  -
EINVAL
;

213 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s
, 
˘ldef
);

214 i‡(
îr
 < 0)

215  
îr
;

216 
îr
 = 
	`¢d_˘l_ascii_ñem_id_∑r£
(
ñem_id
, 
s
);

217 
	`‰ì
(
s
);

218 i‡(
îr
 < 0) {

219 
	`uc_îr‹
("u«bÀÅÿ∑r£ÉÀmíàidítifiˇt‹ (%s)", 
˘ldef
);

220  -
EINVAL
;

223 i‡(
devi˚
 =
NULL
) {

224 
˘l
 = 
	`uc_mgr_gë_˘l
(
uc_mgr
);

225 i‡(
˘l
 =
NULL
) {

226 
	`uc_îr‹
("cannot determine control device");

227  -
EINVAL
;

230 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s
, 
devi˚
);

231 i‡(
îr
 < 0)

232  
îr
;

233 
îr
 = 
	`uc_mgr_›í_˘l
(
uc_mgr
, &
˘l_li°
, 
s
, 1);

234 
	`‰ì
(
s
);

235 i‡(
îr
 < 0)

236  
îr
;

237 
˘l
 = 
˘l_li°
->ctl;

240 
	`¢d_˘l_ñem_öfo_£t_id
(
ñem_öfo
, 
ñem_id
);

241 
îr
 = 
	`¢d_˘l_ñem_öfo
(
˘l
, 
ñem_öfo
);

242 i‡(
îr
 < 0)

245 i‡(
íumvÆ
) {

246 
ty≥
 = 
	`¢d_˘l_ñem_öfo_gë_ty≥
(
ñem_öfo
);

247 i‡(
ty≥
 !
SND_CTL_ELEM_TYPE_ENUMERATED
)

249 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s
, 
íumvÆ
);

250 i‡(
îr
 < 0)

251  
îr
;

252 
ôems
 = 
	`¢d_˘l_ñem_öfo_gë_ôems
(
ñem_öfo
);

253 
i
 = 0; i < 
ôems
; i++) {

254 
	`¢d_˘l_ñem_öfo_£t_ôem
(
ñem_öfo
, 
i
);

255 
îr
 = 
	`¢d_˘l_ñem_öfo
(
˘l
, 
ñem_öfo
);

256 i‡(
îr
 < 0) {

257 
	`‰ì
(
s
);

258  
îr
;

260 
«me
 = 
	`¢d_˘l_ñem_öfo_gë_ôem_«me
(
ñem_öfo
);

261 i‡(
	`°rˇ£cmp
(
«me
, 
s
) == 0) {

262 
	`‰ì
(
s
);

266 
	`‰ì
(
s
);

271 
	}
}

273 
	$if_evÆ_∑th
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
evÆ
)

275 c⁄° *
∑th
, *
mode
 = "";

276 
îr
, 
amode
 = 
F_OK
;

277 *
s
;

279 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 4) {

280 
	`uc_îr‹
("Path condition is supported in v4+ syntax");

281  -
EINVAL
;

284 
îr
 = 
	`gë_°rög
(
evÆ
, "P©h", &
∑th
);

285 i‡(
îr
 < 0) {

286 
	`uc_îr‹
("PathÉrror (If.Condition.Path)");

287  -
EINVAL
;

290 
îr
 = 
	`gë_°rög
(
evÆ
, "Mode", &
mode
);

291 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

292 
	`uc_îr‹
("PathÉrror (If.Condition.Mode)");

293  -
EINVAL
;

296 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 7) {

297 
s
 = (*)
mode
;

299 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s
, 
mode
);

300 i‡(
îr
 < 0)

301  
îr
;

303 i‡(
	`°∫ˇ£cmp
(
s
, "exist", 5) == 0) {

304 
amode
 = 
F_OK
;

305 } i‡(
	`°rˇ£cmp
(
s
, "read") == 0) {

306 
amode
 = 
R_OK
;

307 } i‡(
	`°rˇ£cmp
(
s
, "write") == 0) {

308 
amode
 = 
W_OK
;

309 } i‡(
	`°rˇ£cmp
(
s
, "exec") == 0) {

310 
amode
 = 
X_OK
;

312 
	`uc_îr‹
("P©h unknow¿modê'%s' (If.C⁄dôi⁄.Mode)", 
s
);

313 
	`‰ì
(
s
);

314  -
EINVAL
;

316 i‡(
s
 !
mode
)

317 
	`‰ì
(
s
);

319 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 7) {

320 
s
 = (*)
∑th
;

322 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s
, 
∑th
);

323 i‡(
îr
 < 0)

324  
îr
;

326 #ifde‡
HAVE_EACCESS


327 
îr
 = 
	`óc˚ss
(
s
, 
amode
);

329 
îr
 = 
	`ac˚ss
(
s
, 
amode
);

331 i‡(
s
 !
∑th
)

332 
	`‰ì
(
s
);

333  
îr
 ? 0 : 1;

334 
	}
}

336 
	$if_evÆ
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
evÆ
)

338 c⁄° *
ty≥
;

339 
îr
;

341 i‡(
	`¢d_c⁄fig_gë_ty≥
(
evÆ
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

342 
	`uc_îr‹
("compoundÅypeÉxpected for If.Condition");

343  -
EINVAL
;

346 
îr
 = 
	`gë_°rög
(
evÆ
, "Ty≥", &
ty≥
);

347 i‡(
îr
 < 0) {

348 
	`uc_îr‹
("type blockÉrror (If.Condition)");

349  -
EINVAL
;

352 i‡(
	`°rcmp
(
ty≥
, "AlwaysTrue") == 0)

355 i‡(
	`°rcmp
(
ty≥
, "String") == 0)

356  
	`if_evÆ_°rög
(
uc_mgr
, 
evÆ
);

358 i‡(
	`°rcmp
(
ty≥
, "ControlExists") == 0)

359  
	`if_evÆ_c⁄åﬁ_exi°s
(
uc_mgr
, 
evÆ
);

361 i‡(
	`°rcmp
(
ty≥
, "RegexMatch") == 0)

362  
	`if_evÆ_ªgex_m©ch
(
uc_mgr
, 
evÆ
);

364 i‡(
	`°rcmp
(
ty≥
, "Path") == 0)

365  
	`if_evÆ_∑th
(
uc_mgr
, 
evÆ
);

367 
	`uc_îr‹
("unknown If.Condition.Type");

368  -
EINVAL
;

369 
	}
}

371 
	$if_evÆ_⁄e
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

372 
¢d_c⁄fig_t
 *
c⁄d
,

373 
¢d_c⁄fig_t
 **
ªsu…
,

374 
¢d_c⁄fig_t
 **
bef‹e
,

375 
¢d_c⁄fig_t
 **
a·î
)

377 
¢d_c⁄fig_t
 *
ex¥
, *
_åue
 = 
NULL
, *
_Ál£
 = NULL;

378 
îr
;

380 *
ªsu…
 = 
NULL
;

382 i‡(
	`¢d_c⁄fig_gë_ty≥
(
c⁄d
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

383 
	`uc_îr‹
("compoundÅypeÉxpected for If.1");

384  -
EINVAL
;

387 i‡(
	`¢d_c⁄fig_£¨ch
(
c⁄d
, "C⁄dôi⁄", &
ex¥
) < 0) {

388 
	`uc_îr‹
("condition blockÉxpected (If)");

389  -
EINVAL
;

392 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
c⁄d
, "True", &
_åue
);

393 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

394 
	`uc_îr‹
("true blockÉrror (If)");

395  -
EINVAL
;

398 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
c⁄d
, "FÆ£", &
_Ál£
);

399 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

400 
	`uc_îr‹
("false blockÉrror (If)");

401  -
EINVAL
;

404 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
c⁄d
, "Bef‹e", 
bef‹e
);

405 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

406 
	`uc_îr‹
("before block identifierÉrror");

407  -
EINVAL
;

410 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
c⁄d
, "A·î", 
a·î
);

411 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

412 
	`uc_îr‹
("before block identifierÉrror");

413  -
EINVAL
;

416 
îr
 = 
	`if_evÆ
(
uc_mgr
, 
ex¥
);

417 i‡(
îr
 > 0) {

418 *
ªsu…
 = 
_åue
;

420 } i‡(
îr
 == 0) {

421 *
ªsu…
 = 
_Ál£
;

424  
îr
;

426 
	}
}

429 
	$c⁄fig_dump
(
¢d_c⁄fig_t
 *
cfg
)

431 
¢d_ouçut_t
 *
out
;

432 
	`¢d_ouçut_°dio_©èch
(&
out
, 
°dîr
, 0);

433 
	`¢d_ouçut_¥ötf
(
out
, "-----\n");

434 
	`¢d_c⁄fig_ßve
(
cfg
, 
out
);

435 
	`¢d_ouçut_˛o£
(
out
);

436 
	}
}

442 
	$uc_mgr_evÆu©e_c⁄dôi⁄
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

443 
¢d_c⁄fig_t
 *
∑ª¡
,

444 
¢d_c⁄fig_t
 *
c⁄d
)

446 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

447 
¢d_c⁄fig_t
 *
a
, *
n
, *
bef‹e
, *
a·î
;

448 
îr
;

450 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 2) {

451 
	`uc_îr‹
("conditionsáreÇot supported for v1 syntax");

452  -
EINVAL
;

455 i‡(
	`¢d_c⁄fig_gë_ty≥
(
c⁄d
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

456 
	`uc_îr‹
("compoundÅypeÉxpected for If");

457  -
EINVAL
;

460 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c⁄d
) {

461 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

462 
bef‹e
 = 
a·î
 = 
NULL
;

463 
îr
 = 
	`if_evÆ_⁄e
(
uc_mgr
, 
n
, &
a
, &
bef‹e
, &
a·î
);

464 i‡(
îr
 < 0)

465  
îr
;

466 i‡(
a
 =
NULL
)

468 
îr
 = 
	`uc_mgr_evÆu©e_ö∂a˚
(
uc_mgr
, 
a
);

469 i‡(
îr
 < 0)

470  
îr
;

471 
îr
 = 
	`uc_mgr_c⁄fig_åì_mîge
(
uc_mgr
, 
∑ª¡
, 
a
, 
bef‹e
, 
a·î
);

472 i‡(
îr
 < 0)

473  
îr
;

474 
	`¢d_c⁄fig_dñëe
(
a
);

477 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_confdoc.h

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_exec.c

30 
	~"ucm_loˇl.h
"

31 
	~<sys/°©.h
>

32 
	~<sys/waô.h
>

33 
	~<limôs.h
>

34 
	~<dúít.h
>

36 #i‡
deföed
(
__NëBSD__
Ë|| deföed(
__O≥nBSD__
Ë|| deföed(
__FªeBSD__
Ë|| deföed(
__Døg⁄Fly__
)

37 
	~<sig«l.h
>

38 #i‡
deföed
(
__Døg⁄Fly__
)

39 
	#ívú⁄
 
NULL


	)

41 **
ívú⁄
;

45 
±hªad_muãx_t
 
	gf‹k_lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

50 
	$föd_exec
(c⁄° *
«me
, *
out
, 
size_t
 
Àn
)

52 
ªt
 = 0;

53 
bö
[
PATH_MAX
];

54 *
∑th
, *
tmp
, *
tmp2
 = 
NULL
;

55 
DIR
 *
dú
;

56 
dúít64
 *
de
;

57 
°©64
 
°
;

58 i‡(
«me
[0] == '/') {

59 i‡(
	`l°©64
(
«me
, &
°
))

61 i‡(!
	`S_ISREG
(
°
.
°_mode
Ë|| !(°.°_modê& 
S_IEXEC
))

63 
	`¢d_°æ˝y
(
out
, 
«me
, 
Àn
);

66 i‡(!(
tmp
 = 
	`gëív
("PATH")))

68 
∑th
 = 
	`Æloˇ
(
	`°æí
(
tmp
) + 1);

69 i‡(!
∑th
)

71 
	`°r˝y
(
∑th
, 
tmp
);

72 
tmp
 = 
	`°πok_r
(
∑th
, ":", &
tmp2
);

73 
tmp
 && !
ªt
) {

74 i‡((
dú
 = 
	`›ídú
(
tmp
))) {

75 (
de
 = 
	`ªaddú64
(
dú
))) {

76 i‡(
	`°r°r
(
de
->
d_«me
, 
«me
) != de->d_name)

78 
	`¢¥ötf
(
bö
, (bö), "%s/%s", 
tmp
,

79 
de
->
d_«me
);

80 i‡(
	`l°©64
(
bö
, &
°
))

82 i‡(!
	`S_ISREG
(
°
.
°_mode
)

83 || !(
°
.
°_mode
 & 
S_IEXEC
))

85 
	`¢d_°æ˝y
(
out
, 
bö
, 
Àn
);

86 
	`˛o£dú
(
dú
);

89 
	`˛o£dú
(
dú
);

91 
tmp
 = 
	`°πok_r
(
NULL
, ":", &
tmp2
);

93  
ªt
;

94 
	}
}

96 
	$‰ì_¨gs
(**
¨gv
)

98 **
a
;

100 
a
 = 
¨gv
; *a;á++)

101 
	`‰ì
(*
a
);

102 
	`‰ì
(
¨gv
);

103 
	}
}

105 
	$∑r£_¨gs
(***
¨gv
, 
¨gc
, c⁄° *
cmd
)

107 *
s
, *
f
;

108 
i
 = 0, 
l
, 
eow
;

110 i‡(!
¨gv
 || !
cmd
)

113 
s
 = 
	`Æloˇ
(
	`°æí
(
cmd
) + 1);

114 i‡(!
s
)

116 
	`°r˝y
(
s
, 
cmd
);

117 *
¨gv
 = 
	`ˇŒoc
(
¨gc
, (*));

119 *
s
 && 
i
 < 
¨gc
 - 1) {

120 *
s
 == ' ')

121 
s
++;

122 
f
 = 
s
;

123 
eow
 = 0;

124 *
s
) {

125 i‡(*
s
 == '\\') {

126 
l
 = *(
s
 + 1);

127 i‡(
l
 == 'b')

128 
l
 = '\b';

129 i‡(
l
 == 'f')

130 
l
 = '\f';

131 i‡(
l
 == 'n')

132 
l
 = '\n';

133 i‡(
l
 == 'r')

134 
l
 = '\r';

135 i‡(
l
 == 't')

136 
l
 = '\t';

138 
l
 = 0;

139 i‡(
l
) {

140 *
s
++ = 
l
;

141 
	`memmove
(
s
, s + 1, 
	`°æí
(s));

143 
	`memmove
(
s
, s + 1, 
	`°æí
(s));

144 i‡(*
s
)

145 
s
++;

147 } i‡(
eow
) {

148 i‡(*
s
 =
eow
) {

149 
	`memmove
(
s
, s + 1, 
	`°æí
(s));

150 
eow
 = 0;

152 
s
++;

154 } i‡(*
s
 == '\'' || *s == '"') {

155 
eow
 = *
s
;

156 
	`memmove
(
s
, s + 1, 
	`°æí
(s));

157 } i‡(*
s
 == ' ') {

160 
s
++;

163 i‡(
f
 !
s
) {

164 i‡(*
s
) {

165 *(*)
s
 = '\0';

166 
s
++;

168 (*
¨gv
)[
i
] = 
	`°rdup
(
f
);

169 i‡((*
¨gv
)[
i
] =
NULL
) {

170 
	`‰ì_¨gs
(*
¨gv
);

171  -
ENOMEM
;

173 
i
++;

176 (*
¨gv
)[
i
] = 
NULL
;

178 
	}
}

184 
	$uc_mgr_exec
(c⁄° *
¥og
)

186 
pid_t
 
p
, 
f
, 
maxfd
;

187 
îr
 = 0, 
°©us
;

188 
bö
[
PATH_MAX
];

189 
siga˘i⁄
 
ß
;

190 
siga˘i⁄
 
öå
, 
quô
;

191 
sig£t_t
 
omask
;

192 **
¨gv
;

194 i‡(
	`∑r£_¨gs
(&
¨gv
, 32, 
¥og
))

195  -
EINVAL
;

197 
¥og
 = 
¨gv
[0];

198 i‡(
¥og
 =
NULL
) {

199 
îr
 = -
EINVAL
;

200 
__îr‹
;

202 i‡(
¥og
[0] != '/' &&Örog[0] != '.') {

203 i‡(!
	`föd_exec
(
¨gv
[0], 
bö
, (bin))) {

204 
îr
 = -
ENOEXEC
;

205 
__îr‹
;

207 
¥og
 = 
bö
;

210 
maxfd
 = 
	`sysc⁄f
(
_SC_OPEN_MAX
);

217 
	`mem£t
(&
ß
, 0, (sa));

218 
ß
.
ß_h™dÀr
 = 
SIG_IGN
;

219 
	`sigem±y£t
(&
ß
.
ß_mask
);

220 
	`sigadd£t
(&
ß
.
ß_mask
, 
SIGCHLD
);

222 
	`±hªad_muãx_lock
(&
f‹k_lock
);

224 
	`sig¥ocmask
(
SIG_BLOCK
, &
ß
.
ß_mask
, &
omask
);

226 
	`siga˘i⁄
(
SIGINT
, &
ß
, &
öå
);

227 
	`siga˘i⁄
(
SIGQUIT
, &
ß
, &
quô
);

229 
p
 = 
	`f‹k
();

231 i‡(
p
 == -1) {

232 
îr
 = -
î∫o
;

233 
	`±hªad_muãx_u∆ock
(&
f‹k_lock
);

234 
	`uc_îr‹
("U«bÀÅÿf‹k(Ëf‹ \"%s\" -- %s", 
¥og
,

235 
	`°ªº‹
(
î∫o
));

236 
__îr‹
;

239 i‡(
p
 == 0) {

240 
f
 = 
	`›í
("/dev/nuŒ", 
O_RDWR
);

241 i‡(
f
 == -1) {

242 
	`uc_îr‹
("pid %d cannot open /dev/null forÑedirect %s -- %s",

243 
	`gëpid
(), 
¥og
, 
	`°ªº‹
(
î∫o
));

244 
	`exô
(1);

247 
	`˛o£
(0);

248 
	`˛o£
(1);

249 
	`˛o£
(2);

251 
	`dup2
(
f
, 0);

252 
	`dup2
(
f
, 1);

253 
	`dup2
(
f
, 2);

255 
	`˛o£
(
f
);

257 
f
 = 3; f < 
maxfd
; f++)

258 
	`˛o£
(
f
);

261 
	`sig«l
(
SIGINT
, 
SIG_DFL
);

262 
	`sig«l
(
SIGQUIT
, 
SIG_DFL
);

264 
	`execve
(
¥og
, 
¨gv
, 
ívú⁄
);

265 
	`exô
(1);

268 
	`siga˘i⁄
(
SIGINT
, &
öå
, 
NULL
);

269 
	`siga˘i⁄
(
SIGQUIT
, &
quô
, 
NULL
);

270 
	`sig¥ocmask
(
SIG_SETMASK
, &
omask
, 
NULL
);

272 
	`±hªad_muãx_u∆ock
(&
f‹k_lock
);

277 
	`£çgid
(
p
,Ö);

280 
f
 = 
	`waôpid
(
p
, &
°©us
, 0);

281 i‡(
f
 == -1) {

282 i‡(
î∫o
 =
EAGAIN
)

284 
îr
 = -
î∫o
;

285 
__îr‹
;

287 i‡(
	`WIFSIGNALED
(
°©us
)) {

288 
îr
 = -
EINTR
;

291 i‡(
	`WIFEXITED
(
°©us
)) {

292 
îr
 = 
	`WEXITSTATUS
(
°©us
);

297 
__îr‹
:

298 
	`‰ì_¨gs
(
¨gv
);

299  
îr
;

300 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_include.c

27 
	~"ucm_loˇl.h
"

29 
	$gë_°rög
(
¢d_c⁄fig_t
 *
compound
, c⁄° *
key
, c⁄° **
°r
)

31 
¢d_c⁄fig_t
 *
node
;

32 
îr
;

34 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
compound
, 
key
, &
node
);

35 i‡(
îr
 < 0)

36  
îr
;

37  
	`¢d_c⁄fig_gë_°rög
(
node
, 
°r
);

38 
	}
}

40 
	$ö˛ude_evÆ_⁄e
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

41 
¢d_c⁄fig_t
 *
öc
,

42 
¢d_c⁄fig_t
 **
ªsu…
,

43 
¢d_c⁄fig_t
 **
bef‹e
,

44 
¢d_c⁄fig_t
 **
a·î
)

46 c⁄° *
fûe
;

47 *
s
;

48 
îr
;

50 *
ªsu…
 = 
NULL
;

52 i‡(
	`¢d_c⁄fig_gë_ty≥
(
öc
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

53 
	`uc_îr‹
("compoundÅypeÉxpected for Include.1");

54  -
EINVAL
;

57 
îr
 = 
	`gë_°rög
(
öc
, "Fûe", &
fûe
);

58 i‡(
îr
 < 0) {

59 
	`uc_îr‹
("fileÉxpected (Include)");

60  -
EINVAL
;

63 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
öc
, "Bef‹e", 
bef‹e
);

64 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

65 
	`uc_îr‹
("before block identifierÉrror");

66  -
EINVAL
;

69 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
öc
, "A·î", 
a·î
);

70 i‡(
îr
 < 0 &&Éº !-
ENOENT
) {

71 
	`uc_îr‹
("before block identifierÉrror");

72  -
EINVAL
;

75 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s
, 
fûe
);

76 i‡(
îr
 < 0)

77  
îr
;

78 
îr
 = 
	`uc_mgr_c⁄fig_lﬂd_fûe
(
uc_mgr
, 
s
, 
ªsu…
);

79 
	`‰ì
(
s
);

80  
îr
;

81 
	}
}

84 
	$c⁄fig_dump
(
¢d_c⁄fig_t
 *
cfg
)

86 
¢d_ouçut_t
 *
out
;

87 
	`¢d_ouçut_°dio_©èch
(&
out
, 
°dîr
, 0);

88 
	`¢d_ouçut_¥ötf
(
out
, "-----\n");

89 
	`¢d_c⁄fig_ßve
(
cfg
, 
out
);

90 
	`¢d_ouçut_˛o£
(
out
);

91 
	}
}

94 
	$föd_posôi⁄_node
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

95 
¢d_c⁄fig_t
 **
ªs
, snd_c⁄fig_à*
d°
,

96 c⁄° *
id
, 
¢d_c⁄fig_t
 *
pos
)

98 c⁄° *
s
;

99 *
s1
;

100 
îr
;

102 
îr
 = 
	`gë_°rög
(
pos
, 
id
, &
s
);

103 i‡(
îr
 < 0 &&Éº !-
ENOENT
)

104  
îr
;

105 i‡(
îr
 == 0) {

106 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s1
, 
s
);

107 i‡(
îr
 < 0)

108  
îr
;

109 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
d°
, 
s1
, 
ªs
);

110 
	`‰ì
(
s1
);

111 i‡(
îr
 < 0 &&Éº !-
ENOENT
)

112  
îr
;

115 
	}
}

117 
	$mîge_ô
(
¢d_c⁄fig_t
 *
d°
, snd_c⁄fig_à*
n
, snd_c⁄fig_à**
_dn
)

119 
¢d_c⁄fig_t
 *
dn
;

120 c⁄° *
id
;

121 
îr
;

123 
îr
 = 
	`¢d_c⁄fig_gë_id
(
n
, &
id
);

124 i‡(
îr
 < 0)

125  
îr
;

126 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
d°
, 
id
, &
dn
);

127 i‡(
îr
 < 0)

128  
îr
;

129 
îr
 = 
	`¢d_c⁄fig_mîge
(
dn
, 
n
, 0);

130 i‡(
îr
 < 0)

131 
	`¢d_c⁄fig_dñëe
(
n
);

133 *
_dn
 = 
dn
;

134  
îr
;

135 
	}
}

137 
	$compound_mîge
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
id
,

138 
¢d_c⁄fig_t
 *
d°
, snd_c⁄fig_à*
§c
,

139 
¢d_c⁄fig_t
 *
bef‹e
, snd_c⁄fig_à*
a·î
)

141 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

142 
¢d_c⁄fig_t
 *
n
, *
_bef‹e
 = 
NULL
, *
_a·î
 = NULL;

143 
tmpid
[32];

144 
îr
, 
¨øy
, 
idx
;

146 i‡(
	`¢d_c⁄fig_gë_ty≥
(
§c
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

147 
	`uc_îr‹
("compoundÅypeÉxpected forÅhe merged block");

148  -
EINVAL
;

151 i‡(
bef‹e
) {

152 
îr
 = 
	`föd_posôi⁄_node
(
uc_mgr
, &
_bef‹e
, 
d°
, 
id
, 
bef‹e
);

153 i‡(
îr
 < 0)

154  
îr
;

156 i‡(
a·î
) {

157 
îr
 = 
	`föd_posôi⁄_node
(
uc_mgr
, &
_a·î
, 
d°
, 
id
, 
a·î
);

158 i‡(
îr
 < 0)

159  
îr
;

163 i‡(!
_bef‹e
 && !
_a·î
)

164  
	`¢d_c⁄fig_mîge
(
d°
, 
§c
, 0);

166 i‡(
_bef‹e
 && 
_a·î
) {

167 
	`uc_îr‹
("defined both beforeándáfter identifiers inÅhe If or Include block");

168  -
EINVAL
;

171 
¨øy
 = 
	`¢d_c⁄fig_is_¨øy
(
d°
);

172 i‡(
¨øy
 < 0) {

173 
	`uc_îr‹
("destination configurationÇode isÇotá compound");

174  
¨øy
;

176 i‡(
¨øy
 && 
	`¢d_c⁄fig_is_¨øy
(
§c
) <= 0) {

177 
	`uc_îr‹
("source configurationÇode isÇotánárray");

178  -
EINVAL
;

181 
idx
 = 0;

184 i‡(
¨øy
 > 0) {

185 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
d°
) {

186 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

187 
	`¢¥ötf
(
tmpid
, —mpid), "_tmp_%d", 
idx
++);

188 
îr
 = 
	`¢d_c⁄fig_£t_id
(
n
, 
tmpid
);

189 i‡(
îr
 < 0)

190  
îr
;

194 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
§c
) {

195 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

196 
îr
 = 
	`¢d_c⁄fig_ªmove
(
n
);

197 i‡(
îr
 < 0)

198  
îr
;

200 i‡(
¨øy
 > 0) {

201 
	`¢¥ötf
(
tmpid
, —mpid), "_tmp_%d", 
idx
++);

202 
îr
 = 
	`¢d_c⁄fig_£t_id
(
n
, 
tmpid
);

203 i‡(
îr
 < 0)

204  
îr
;

206 i‡(
_bef‹e
) {

207 
îr
 = 
	`¢d_c⁄fig_add_bef‹e
(
_bef‹e
, 
n
);

208 i‡(
îr
 =-
EEXIST
)

209 
îr
 = 
	`mîge_ô
(
d°
, 
n
, &n);

210 i‡(
îr
 < 0)

211  
îr
;

212 
_bef‹e
 = 
NULL
;

213 
_a·î
 = 
n
;

214 } i‡(
_a·î
) {

215 
îr
 = 
	`¢d_c⁄fig_add_a·î
(
_a·î
, 
n
);

216 i‡(
îr
 =-
EEXIST
)

217 
îr
 = 
	`mîge_ô
(
d°
, 
n
, &n);

218 i‡(
îr
 < 0)

219  
îr
;

220 
_a·î
 = 
n
;

225 i‡(
¨øy
 > 0) {

226 
idx
 = 0;

227 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
d°
) {

228 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

229 
	`¢¥ötf
(
tmpid
, —mpid), "%d", 
idx
++);

230 
îr
 = 
	`¢d_c⁄fig_£t_id
(
n
, 
tmpid
);

231 i‡(
îr
 < 0)

232  
îr
;

236 
	`¢d_c⁄fig_dñëe
(
§c
);

238 
	}
}

240 
	$uc_mgr_c⁄fig_åì_mîge
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

241 
¢d_c⁄fig_t
 *
∑ª¡
, snd_c⁄fig_à*
√w_˘x
,

242 
¢d_c⁄fig_t
 *
bef‹e
, snd_c⁄fig_à*
a·î
)

244 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

245 
¢d_c⁄fig_t
 *
n
, *
∑ª¡2
;

246 c⁄° *
id
;

247 
îr
;

249 
îr
 = 
	`uc_mgr_sub°ôuã_åì
(
uc_mgr
, 
√w_˘x
);

250 i‡(
îr
 < 0)

251  
îr
;

253 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
√w_˘x
) {

254 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

255 
îr
 = 
	`¢d_c⁄fig_ªmove
(
n
);

256 i‡(
îr
 < 0)

257  
îr
;

258 
îr
 = 
	`¢d_c⁄fig_gë_id
(
n
, &
id
);

259 i‡(
îr
 < 0) {

260 
__add
:

261 
îr
 = 
	`¢d_c⁄fig_add
(
∑ª¡
, 
n
);

262 i‡(
îr
 < 0)

263  
îr
;

265 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
∑ª¡
, 
id
, &
∑ª¡2
);

266 i‡(
îr
 =-
ENOENT
)

267 
__add
;

268 
îr
 = 
	`compound_mîge
(
uc_mgr
, 
id
, 
∑ª¡2
, 
n
, 
bef‹e
, 
a·î
);

269 i‡(
îr
 < 0) {

270 
	`¢d_c⁄fig_dñëe
(
n
);

271  
îr
;

276 
	}
}

281 
	$uc_mgr_evÆu©e_ö˛ude
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

282 
¢d_c⁄fig_t
 *
∑ª¡
,

283 
¢d_c⁄fig_t
 *
öc
)

285 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

286 
¢d_c⁄fig_t
 *
a
, *
n
, *
bef‹e
, *
a·î
;

287 
îr
;

289 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 3) {

290 
	`uc_îr‹
("in-place include is supported in v3+ syntax");

291  -
EINVAL
;

294 i‡(
	`¢d_c⁄fig_gë_ty≥
(
öc
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

295 
	`uc_îr‹
("compoundÅypeÉxpected for Include");

296  -
EINVAL
;

299 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
öc
) {

300 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

301 
bef‹e
 = 
a·î
 = 
NULL
;

302 
îr
 = 
	`ö˛ude_evÆ_⁄e
(
uc_mgr
, 
n
, &
a
, &
bef‹e
, &
a·î
);

303 i‡(
îr
 < 0)

304  
îr
;

305 i‡(
a
 =
NULL
)

307 
îr
 = 
	`uc_mgr_evÆu©e_ö∂a˚
(
uc_mgr
, 
a
);

308 i‡(
îr
 < 0) {

309 
	`¢d_c⁄fig_dñëe
(
a
);

310  
îr
;

312 
îr
 = 
	`uc_mgr_c⁄fig_åì_mîge
(
uc_mgr
, 
∑ª¡
, 
a
, 
bef‹e
, 
a·î
);

313 
	`¢d_c⁄fig_dñëe
(
a
);

314 i‡(
îr
 < 0)

315  
îr
;

318 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_local.h

36 
	#UC_MGR_DEBUG


	)

39 
	~"loˇl.h
"

40 
	~<±hªad.h
>

41 
	~"u£-ˇ£.h
"

43 
	#SYNTAX_VERSION_MAX
 7

	)

45 
	#MAX_CARD_SHORT_NAME
 32

	)

46 
	#MAX_CARD_LONG_NAME
 80

	)

48 
	#SEQUENCE_ELEMENT_TYPE_CDEV
 1

	)

49 
	#SEQUENCE_ELEMENT_TYPE_CSET
 2

	)

50 
	#SEQUENCE_ELEMENT_TYPE_SLEEP
 3

	)

51 
	#SEQUENCE_ELEMENT_TYPE_EXEC
 4

	)

52 
	#SEQUENCE_ELEMENT_TYPE_SHELL
 5

	)

53 
	#SEQUENCE_ELEMENT_TYPE_CSET_BIN_FILE
 6

	)

54 
	#SEQUENCE_ELEMENT_TYPE_CSET_TLV
 7

	)

55 
	#SEQUENCE_ELEMENT_TYPE_CSET_NEW
 8

	)

56 
	#SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
 9

	)

57 
	#SEQUENCE_ELEMENT_TYPE_CMPT_SEQ
 10

	)

58 
	#SEQUENCE_ELEMENT_TYPE_SYSSET
 11

	)

59 
	#SEQUENCE_ELEMENT_TYPE_CFGSAVE
 12

	)

60 
	#SEQUENCE_ELEMENT_TYPE_DEV_ENABLE_SEQ
 13

	)

61 
	#SEQUENCE_ELEMENT_TYPE_DEV_DISABLE_SEQ
 14

	)

62 
	#SEQUENCE_ELEMENT_TYPE_DEV_DISABLE_ALL
 15

	)

64 
	sucm_vÆue
 {

65 
li°_hód
 
	mli°
;

66 *
	m«me
;

67 *
	md©a
;

71 
	scomp⁄ít_£quí˚
 {

72 
u£_ˇ£_devi˚
 *
	mdevi˚
;

73 
	míabÀ
;

76 
	s£quí˚_ñemít
 {

77 
li°_hód
 
	mli°
;

78 
	mty≥
;

80 
	m¶ìp
;

81 *
	mcdev
;

82 *
	mc£t
;

83 *
	mexec
;

84 *
	msysw
;

85 *
	mcfgßve
;

86 *
	mdevi˚
;

87 
comp⁄ít_£quí˚
 
	mcm±_£q
;

88 } 
	md©a
;

94 
	så™sôi⁄_£quí˚
 {

95 
li°_hód
 
	mli°
;

96 *
	m«me
;

97 
li°_hód
 
	må™sôi⁄_li°
;

103 
	edev_li°_ty≥
 {

104 
	mDEVLIST_NONE
,

105 
	mDEVLIST_SUPPORTED
,

106 
	mDEVLIST_CONFLICTING


109 
	sdev_li°_node
 {

110 
li°_hód
 
	mli°
;

111 *
	m«me
;

114 
	sdev_li°
 {

115 
dev_li°_ty≥
 
	mty≥
;

116 
li°_hód
 
	mli°
;

119 
	s˘l_dev
 {

120 
li°_hód
 
	mli°
;

121 *
	mdevi˚
;

124 
	s˘l_li°
 {

125 
li°_hód
 
	mli°
;

126 
li°_hód
 
	mdev_li°
;

127 
¢d_˘l_t
 *
	m˘l
;

128 
¢d_˘l_ˇrd_öfo_t
 *
	m˘l_öfo
;

129 
	m¶ave
;

130 
	mucm_group
;

133 
	sucm_dev_«me
 {

134 
li°_hód
 
	mli°
;

135 *
	m«me1
;

136 *
	m«me2
;

143 
	su£_ˇ£_modifõr
 {

144 
li°_hód
 
	mli°
;

145 
li°_hód
 
	ma˘ive_li°
;

147 *
	m«me
;

148 *
	mcommít
;

151 
li°_hód
 
	míabÀ_li°
;

152 
li°_hód
 
	mdißbÀ_li°
;

155 
li°_hód
 
	må™sôi⁄_li°
;

158 
dev_li°
 
	mdev_li°
;

161 
li°_hód
 
	mvÆue_li°
;

168 
	su£_ˇ£_devi˚
 {

169 
li°_hód
 
	mli°
;

170 
li°_hód
 
	ma˘ive_li°
;

172 *
	m«me
;

173 *
	mcommít
;

176 
li°_hód
 
	míabÀ_li°
;

177 
li°_hód
 
	mdißbÀ_li°
;

180 
li°_hód
 
	må™sôi⁄_li°
;

183 
dev_li°
 
	mdev_li°
;

186 
li°_hód
 
	mvÆue_li°
;

193 
	su£_ˇ£_vîb
 {

194 
li°_hód
 
	mli°
;

196 
	ma˘ive
: 1;

198 *
	m«me
;

199 *
	mcommít
;

202 
li°_hód
 
	míabÀ_li°
;

203 
li°_hód
 
	mdißbÀ_li°
;

206 
li°_hód
 
	må™sôi⁄_li°
;

208 
li°_hód
 
	mdevi˚_li°
;

211 
li°_hód
 
	mcm±_devi˚_li°
;

214 
li°_hód
 
	mmodifõr_li°
;

217 
li°_hód
 
	mvÆue_li°
;

220 
li°_hód
 
	mª«me_li°
;

221 
li°_hód
 
	mªmove_li°
;

227 
	s¢d_u£_ˇ£_mgr
 {

228 *
	mˇrd_«me
;

229 *
	mc⁄f_fûe_«me
;

230 *
	mc⁄f_dú_«me
;

231 *
	mcommít
;

232 
	mc⁄f_f‹m©
;

233 
	mucm_ˇrd_numbî
;

234 
	msuµªss_nodev_îr‹s
;

235 c⁄° *
	m∑r£_v¨ü¡
;

236 
	m∑r£_ma°î_£˘i⁄
;

237 
	m£quí˚_h›s
;

240 
li°_hód
 
	mˇrds_li°
;

243 
li°_hód
 
	mvîb_li°
;

246 
li°_hód
 
	mfixedboŸ_li°
;

249 
li°_hód
 
	mboŸ_li°
;

252 
li°_hód
 
	mdeÁu…_li°
;

253 
	mdeÁu…_li°_execuãd
;

256 
li°_hód
 
	mvÆue_li°
;

259 
u£_ˇ£_vîb
 *
	ma˘ive_vîb
;

260 
li°_hód
 
	ma˘ive_devi˚s
;

261 
li°_hód
 
	ma˘ive_modifõrs
;

264 
±hªad_muãx_t
 
	mmuãx
;

267 
li°_hód
 
	mv¨übÀ_li°
;

270 
li°_hód
 
	m˘l_li°
;

273 
¢d_c⁄fig_t
 *
	mma¸os
;

274 
	mma¸o_h›s
;

277 
¢d_c⁄fig_t
 *
	mloˇl_c⁄fig
;

284 
	mö_comp⁄ít_domaö
;

285 *
	mcdev
;

288 
	#uc_îr‹
 
SNDERR


	)

290 #ifde‡
UC_MGR_DEBUG


291 
	#uc_dbg
 
SNDERR


	)

293 
	#uc_dbg
(
fmt
, 
¨g
...Ëdÿ{ } 0)

	)

296 
uc_mgr_îr‹
(c⁄° *
fmt
, ...);

297 
uc_mgr_°dout
(c⁄° *
fmt
, ...);

299 c⁄° *
uc_mgr_sysfs_roŸ
();

300 c⁄° *
uc_mgr_c⁄fig_dú
(
f‹m©
);

301 
uc_mgr_c⁄fig_lﬂd_öto
(
f‹m©
, c⁄° *
fûe
, 
¢d_c⁄fig_t
 *
cfg
);

302 
uc_mgr_c⁄fig_lﬂd
(
f‹m©
, c⁄° *
fûe
, 
¢d_c⁄fig_t
 **
cfg
);

303 
uc_mgr_c⁄fig_lﬂd_fûe
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
fûe
, 
¢d_c⁄fig_t
 **
cfg
);

304 
uc_mgr_imp‹t_ma°î_c⁄fig
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
);

305 
uc_mgr_sˇn_ma°î_c⁄figs
(c⁄° **
_li°
[]);

307 
uc_mgr_put_to_dev_li°
(
dev_li°
 *dev_li°, c⁄° *
«me
);

308 
uc_mgr_ªmove_devi˚
(
u£_ˇ£_vîb
 *
vîb
, c⁄° *
«me
);

309 
uc_mgr_ª«me_devi˚
(
u£_ˇ£_vîb
 *
vîb
, c⁄° *
§c
,

310 c⁄° *
d°
);

312 
uc_mgr_‰ì_dev_«me_li°
(
li°_hód
 *
ba£
);

313 
uc_mgr_‰ì_£quí˚_ñemít
(
£quí˚_ñemít
 *
£q
);

314 
uc_mgr_‰ì_å™sôi⁄_ñemít
(
å™sôi⁄_£quí˚
 *
£q
);

315 
uc_mgr_‰ì_vîb
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
);

316 
uc_mgr_‰ì
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
);

318 
ölöe
 
	$uc_mgr_has_loˇl_c⁄fig
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

320  
uc_mgr
 && 
	`¢d_c⁄fig_ôî©‹_fú°
(uc_mgr->
loˇl_c⁄fig
) !=

321 
	`¢d_c⁄fig_ôî©‹_íd
(
uc_mgr
->
loˇl_c⁄fig
);

322 
	}
}

324 
uc_mgr_ˇrd_›í
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
);

325 
uc_mgr_ˇrd_˛o£
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
);

327 
uc_mgr_›í_˘l
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

328 
˘l_li°
 **ctl_list,

329 c⁄° *
devi˚
,

330 
¶ave
);

332 
˘l_li°
 *
uc_mgr_gë_ma°î_˘l
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
);

333 
˘l_li°
 *
uc_mgr_gë_˘l_by_ˇrd
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
ˇrd
);

334 
˘l_li°
 *
uc_mgr_gë_˘l_by_«me
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

335 c⁄° *
«me
, 
idx
);

336 
¢d_˘l_t
 *
uc_mgr_gë_˘l
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
);

337 
uc_mgr_‰ì_˘l_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
);

339 
uc_mgr_add_vÆue
(
li°_hód
 *
ba£
, c⁄° *
key
, *
vÆ
);

341 c⁄° *
uc_mgr_gë_v¨übÀ
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

342 c⁄° *
«me
);

344 
uc_mgr_£t_v¨übÀ
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

345 c⁄° *
«me
,

346 c⁄° *
vÆ
);

348 
uc_mgr_dñëe_v¨übÀ
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
«me
);

350 
uc_mgr_gë_sub°ôuãd_vÆue
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

351 **
_rvÆue
,

352 c⁄° *
vÆue
);

354 
uc_mgr_sub°ôuã_åì
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

355 
¢d_c⁄fig_t
 *
node
);

357 
uc_mgr_c⁄fig_åì_mîge
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

358 
¢d_c⁄fig_t
 *
∑ª¡
, snd_c⁄fig_à*
√w_˘x
,

359 
¢d_c⁄fig_t
 *
bef‹e
, snd_c⁄fig_à*
a·î
);

361 
uc_mgr_evÆu©e_ö∂a˚
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

362 
¢d_c⁄fig_t
 *
cfg
);

364 
uc_mgr_evÆu©e_ö˛ude
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

365 
¢d_c⁄fig_t
 *
∑ª¡
,

366 
¢d_c⁄fig_t
 *
öc
);

368 
uc_mgr_evÆu©e_c⁄dôi⁄
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

369 
¢d_c⁄fig_t
 *
∑ª¡
,

370 
¢d_c⁄fig_t
 *
c⁄d
);

372 
uc_mgr_deföe_ªgex
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

373 c⁄° *
«me
,

374 
¢d_c⁄fig_t
 *
evÆ
);

376 
uc_mgr_exec
(c⁄° *
¥og
);

379 
	#ALSA_CONFIG_UCM_VAR
 "ALSA_CONFIG_UCM"

	)

382 
	#ALSA_CONFIG_UCM2_VAR
 "ALSA_CONFIG_UCM2"

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_regex.c

27 
	~"ucm_loˇl.h
"

28 
	~<˘y≥.h
>

29 
	~<ªgex.h
>

31 
	$gë_°rög
(
¢d_c⁄fig_t
 *
compound
, c⁄° *
key
, c⁄° **
°r
)

33 
¢d_c⁄fig_t
 *
node
;

34 
îr
;

36 
îr
 = 
	`¢d_c⁄fig_£¨ch
(
compound
, 
key
, &
node
);

37 i‡(
îr
 < 0)

38  
îr
;

39  
	`¢d_c⁄fig_gë_°rög
(
node
, 
°r
);

40 
	}
}

42 *
	$exåa˘_sub°rög
(c⁄° *
d©a
, 
ªgm©ch_t
 *
m©ch
)

44 *
s
;

45 
size_t
 
Àn
;

47 
Àn
 = 
m©ch
->
rm_eo
 - m©ch->
rm_so
;

48 
s
 = 
	`mÆloc
(
Àn
 + 1);

49 i‡(
s
 =
NULL
)

50  
NULL
;

51 
	`mem˝y
(
s
, 
d©a
 + 
m©ch
->
rm_so
, 
Àn
);

52 
s
[
Àn
] = '\0';

53  
s
;

54 
	}
}

56 
	$£t_v¨übÀs
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
d©a
,

57 
m©ch_size
, 
ªgm©ch_t
 *
m©ch
,

58 c⁄° *
«me
)

60 
size_t
 
«me2_Àn
 = 
	`°æí
(
«me
) + 16;

61 *
«me2
 = 
	`Æloˇ
(
«me2_Àn
);

62 *
s
;

63 
i
;

64 
îr
;

66 i‡(
m©ch
[0].
rm_so
 < 0 || m©ch[0].
rm_eo
 < 0)

68 
s
 = 
	`exåa˘_sub°rög
(
d©a
, &
m©ch
[0]);

69 i‡(
s
 =
NULL
)

70  -
ENOMEM
;

71 
îr
 = 
	`uc_mgr_£t_v¨übÀ
(
uc_mgr
, 
«me
, 
s
);

72 
	`‰ì
(
s
);

73 i‡(
îr
 < 0)

74  
îr
;

75 
i
 = 1; i < 
m©ch_size
; i++) {

76 i‡(
m©ch
[0].
rm_so
 < 0 || m©ch[0].
rm_eo
 < 0)

78 
s
 = 
	`exåa˘_sub°rög
(
d©a
, &
m©ch
[
i
]);

79 i‡(
s
 =
NULL
)

80  -
ENOMEM
;

81 
	`¢¥ötf
(
«me2
, 
«me2_Àn
, "%s%u", 
«me
, 
i
);

82 
îr
 = 
	`uc_mgr_£t_v¨übÀ
(
uc_mgr
, 
«me2
, 
s
);

83 
	`‰ì
(
s
);

84 i‡(
îr
 < 0)

85  
îr
;

88 
	}
}

90 
	$uc_mgr_deföe_ªgex
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
«me
,

91 
¢d_c⁄fig_t
 *
evÆ
)

93 c⁄° *
°rög
, *
ªgex_°rög
, *
Êags_°rög
;

94 *
s
;

95 
ªgex_t
 
ª
;

96 
›ti⁄s
 = 0;

97 
ªgm©ch_t
 
m©ch
[20];

98 
îr
;

100 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 3) {

101 
	`uc_îr‹
("defineÑegex is supported in v3+ syntax");

102  -
EINVAL
;

105 i‡(
	`¢d_c⁄fig_gë_ty≥
(
evÆ
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

106 
	`uc_îr‹
("compoundÅypeÉxpected for DefineRegex");

107  -
EINVAL
;

110 
îr
 = 
	`gë_°rög
(
evÆ
, "Såög", &
°rög
);

111 i‡(
îr
 < 0) {

112 
	`uc_îr‹
("DefineRegexÉrror (String)");

113  -
EINVAL
;

116 
îr
 = 
	`gë_°rög
(
evÆ
, "Regex", &
ªgex_°rög
);

117 i‡(
îr
 < 0) {

118 
	`uc_îr‹
("DefineRegexÉrror (Regex string)");

119  -
EINVAL
;

122 
îr
 = 
	`gë_°rög
(
evÆ
, "Fœgs", &
Êags_°rög
);

123 i‡(
îr
 =-
ENOENT
) {

124 
›ti⁄s
 = 
REG_EXTENDED
;

125 } i‡(
îr
 < 0) {

126 
	`uc_îr‹
("DefineRegexÉrror (Flags string)");

127  -
EINVAL
;

129 *
Êags_°rög
) {

130 
	`tﬁowî
(*
Êags_°rög
)) {

132 
›ti⁄s
 |
REG_EXTENDED
;

135 
›ti⁄s
 |
REG_ICASE
;

138 
›ti⁄s
 |
REG_NOSUB
;

141 
›ti⁄s
 |
REG_NEWLINE
;

144 
	`uc_îr‹
("DeföeRegexÉº‹ (unknow¿Êag '%c')", *
Êags_°rög
);

145  -
EINVAL
;

147 
Êags_°rög
++;

151 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s
, 
ªgex_°rög
);

152 i‡(
îr
 < 0)

153  
îr
;

154 
îr
 = 
	`ªgcomp
(&
ª
, 
s
, 
›ti⁄s
);

155 
	`‰ì
(
s
);

156 i‡(
îr
) {

157 
	`uc_îr‹
("Regex '%s' compû©i⁄ faûed (codê%d)", 
îr
);

158  -
EINVAL
;

161 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s
, 
°rög
);

162 i‡(
îr
 < 0) {

163 
	`ªg‰ì
(&
ª
);

164  
îr
;

166 
îr
 = 
	`ªgexec
(&
ª
, 
s
, 
	`ARRAY_SIZE
(
m©ch
), match, 0);

167 i‡(
îr
 < 0)

168 
îr
 = -
î∫o
;

169 i‡(
îr
 =
REG_NOMATCH
)

170 
îr
 = 0;

172 
îr
 = 
	`£t_v¨übÀs
(
uc_mgr
, 
s
, 
	`ARRAY_SIZE
(
m©ch
), m©ch, 
«me
);

173 
	`‰ì
(
s
);

174 
	`ªg‰ì
(&
ª
);

175  
îr
;

176 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_subs.c

27 
	~"ucm_loˇl.h
"

28 
	~<°dboﬁ.h
>

29 
	~<sys/°©.h
>

30 
	~<limôs.h
>

31 
	~<ªgex.h
>

33 *
	$rvÆ_›í_«me
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

35 c⁄° *
«me
;

36 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 3)

37  
NULL
;

38 
«me
 = 
uc_mgr
->
ˇrd_«me
;

39 i‡(
«me
) {

40 i‡(
	`°∫cmp
(
«me
, "strict:", 7) == 0)

41 
«me
 += 7;

42  
	`°rdup
(
«me
);

44  
NULL
;

45 
	}
}

47 *
	$rvÆ_c⁄f_libdú
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

49 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 4)

50  
NULL
;

51  
	`°rdup
(
	`¢d_c⁄fig_t›dú
());

52 
	}
}

54 *
	$rvÆ_c⁄f_t›dú
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

56 c⁄° *
dú
;

58 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 3)

59  
NULL
;

60 
dú
 = 
	`uc_mgr_c⁄fig_dú
(
uc_mgr
->
c⁄f_f‹m©
);

61 i‡(
dú
 && dir[0])

62  
	`°rdup
(
dú
);

63  
NULL
;

64 
	}
}

66 *
	$rvÆ_c⁄f_dú
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

68 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 3)

69  
NULL
;

70 i‡(
uc_mgr
->
c⁄f_dú_«me
 && uc_mgr->conf_dir_name[0])

71  
	`°rdup
(
uc_mgr
->
c⁄f_dú_«me
);

72  
NULL
;

73 
	}
}

75 *
	$rvÆ_c⁄f_«me
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

77 i‡(
uc_mgr
->
c⁄f_fûe_«me
 && uc_mgr->conf_file_name[0])

78  
	`°rdup
(
uc_mgr
->
c⁄f_fûe_«me
);

79  
NULL
;

80 
	}
}

82 *
	$gë_ˇrd_numbî
(
˘l_li°
 *ctl_list)

84 
num
[16];

86 i‡(
˘l_li°
 =
NULL
)

87  
	`°rdup
("");

88 
	`¢¥ötf
(
num
, “um), "%i", 
	`¢d_˘l_ˇrd_öfo_gë_ˇrd
(
˘l_li°
->
˘l_öfo
));

89  
	`°rdup
(
num
);

90 
	}
}

92 *
	$rvÆ_ˇrd_numbî
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

94 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 3)

95  
NULL
;

96  
	`gë_ˇrd_numbî
(
	`uc_mgr_gë_ma°î_˘l
(
uc_mgr
));

97 
	}
}

99 *
	$rvÆ_ˇrd_id
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

101 
˘l_li°
 *ctl_list;

103 
˘l_li°
 = 
	`uc_mgr_gë_ma°î_˘l
(
uc_mgr
);

104 i‡(
˘l_li°
 =
NULL
)

105  
NULL
;

106  
	`°rdup
(
	`¢d_˘l_ˇrd_öfo_gë_id
(
˘l_li°
->
˘l_öfo
));

107 
	}
}

109 *
	$rvÆ_ˇrd_drivî
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

111 
˘l_li°
 *ctl_list;

113 
˘l_li°
 = 
	`uc_mgr_gë_ma°î_˘l
(
uc_mgr
);

114 i‡(
˘l_li°
 =
NULL
)

115  
NULL
;

116  
	`°rdup
(
	`¢d_˘l_ˇrd_öfo_gë_drivî
(
˘l_li°
->
˘l_öfo
));

117 
	}
}

119 *
	$rvÆ_ˇrd_«me
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

121 
˘l_li°
 *ctl_list;

123 
˘l_li°
 = 
	`uc_mgr_gë_ma°î_˘l
(
uc_mgr
);

124 i‡(
˘l_li°
 =
NULL
)

125  
NULL
;

126  
	`°rdup
(
	`¢d_˘l_ˇrd_öfo_gë_«me
(
˘l_li°
->
˘l_öfo
));

127 
	}
}

129 *
	$rvÆ_ˇrd_l⁄g«me
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

131 
˘l_li°
 *ctl_list;

133 
˘l_li°
 = 
	`uc_mgr_gë_ma°î_˘l
(
uc_mgr
);

134 i‡(
˘l_li°
 =
NULL
)

135  
NULL
;

136  
	`°rdup
(
	`¢d_˘l_ˇrd_öfo_gë_l⁄g«me
(
˘l_li°
->
˘l_öfo
));

137 
	}
}

139 *
	$rvÆ_ˇrd_comp⁄íts
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

141 
˘l_li°
 *ctl_list;

143 
˘l_li°
 = 
	`uc_mgr_gë_ma°î_˘l
(
uc_mgr
);

144 i‡(
˘l_li°
 =
NULL
)

145  
NULL
;

146  
	`°rdup
(
	`¢d_˘l_ˇrd_öfo_gë_comp⁄íts
(
˘l_li°
->
˘l_öfo
));

147 
	}
}

149 
˘l_li°
 *
	$gë_˘l_li°_by_«me
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
id
)

151 *
«me
, *
ödex
;

152 
idx
 = 0;

154 
«me
 = 
	`Æloˇ
(
	`°æí
(
id
) + 1);

155 
	`°r˝y
(
«me
, 
id
);

156 
ödex
 = 
	`°rchr
(
«me
, '#');

157 i‡(
ödex
) {

158 *
ödex
 = '\0';

159 i‡(
	`ß„_°πﬁ
(
ödex
 + 1, &
idx
))

160  
NULL
;

162  
	`uc_mgr_gë_˘l_by_«me
(
uc_mgr
, 
«me
, 
idx
);

163 
	}
}

165 *
	$rvÆ_ˇrd_numbî_by_«me
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
id
)

167 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 3) {

168 
	`uc_îr‹
("CardNumberByName substitution is supported in v3+ syntax");

169  
NULL
;

172 
	`uc_îr‹
("${CardNumberByName} substitution is obsolete - use ${find-card}!");

174  
	`gë_ˇrd_numbî
(
	`gë_˘l_li°_by_«me
(
uc_mgr
, 
id
));

175 
	}
}

177 *
	$rvÆ_ˇrd_id_by_«me
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
id
)

179 
˘l_li°
 *ctl_list;

181 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 3) {

182 
	`uc_îr‹
("CardIdByName substitution is supported in v3+ syntax");

183  
NULL
;

186 
	`uc_îr‹
("${CardIdByName} substitution is obsolete - use ${find-card}!");

188 
˘l_li°
 = 
	`gë_˘l_li°_by_«me
(
uc_mgr
, 
id
);

189 i‡(
˘l_li°
 =
NULL
)

190  
NULL
;

191  
	`°rdup
(
	`¢d_˘l_ˇrd_öfo_gë_id
(
˘l_li°
->
˘l_öfo
));

192 
	}
}

194 #i‚de‡
DOC_HIDDEN


195 
	glookup_ôî©e
 *(*
	tlookup_ôî_f˙_t
)

196 (
	t¢d_u£_ˇ£_mgr_t
 *
	tuc_mgr
, 
	tlookup_ôî©e
 *
	tôî
);

197 c⁄° *(*
	tlookup_f˙_t
)(*);

199 
	slookup_f˙
 {

200 *
	m«me
;

201 c⁄° *(*
	mf˙
)(*
	m›aque
);

204 
	slookup_ôî©e
 {

205 (*
	möô
)(
¢d_u£_ˇ£_mgr_t
 *
	muc_mgr
, 
lookup_ôî©e
 *
	môî
,

206 
¢d_c⁄fig_t
 *
	mc⁄fig
);

207 (*
	md⁄e
)(
lookup_ôî©e
 *
	môî
);

208 
lookup_ôî_f˙_t
 
	mfú°
;

209 
lookup_ôî_f˙_t
 
	m√xt
;

210 *(*
	mªtf˙
)(
lookup_ôî©e
 *
	môî
, 
¢d_c⁄fig_t
 *
	mc⁄fig
);

211 
lookup_f˙
 *
	mf˙s
;

212 
lookup_f˙_t
 
	mf˙
;

213 
˘l_li°
 *
	m˘l_li°
;

214 *
	möfo
;

218 *
	$rvÆ_lookup_maö
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

219 c⁄° *
quîy
,

220 
lookup_ôî©e
 *
ôî
)

222 
¢d_c⁄fig_t
 *
c⁄fig
, *
d
;

223 
lookup_f˙
 *
f˙
;

224 
lookup_ôî©e
 *
cuº
;

225 c⁄° *
s
;

226 *
ªsu…
;

227 
ªgm©ch_t
 
m©ch
[1];

228 
ªgex_t
 
ª
;

229 
îr
;

231 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 4) {

232 
	`uc_îr‹
("Lookupsáre supported in v4+ syntax");

233  
NULL
;

236 
îr
 = 
	`¢d_c⁄fig_lﬂd_°rög
(&
c⁄fig
, 
quîy
, 0);

237 i‡(
îr
 < 0) {

238 
	`uc_îr‹
("Thêlooku∞¨gumít†'%s'áª invÆid", 
quîy
);

239  
NULL
;

241 i‡(
ôî
->
öô
 && iãr->
	`öô
(
uc_mgr
, iãr, 
c⁄fig
))

242 
nuŒ
;

243 i‡(
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, "fõld", &
d
)) {

244 
	`uc_îr‹
("LookupsÑequire field!");

245 
nuŒ
;

247 i‡(
	`¢d_c⁄fig_gë_°rög
(
d
, &
s
))

248 
nuŒ
;

249 
f˙
 = 
ôî
->
f˙s
 ; fcn; fcn++) {

250 i‡(
	`°rˇ£cmp
(
f˙
->
«me
, 
s
) == 0) {

251 
ôî
->
f˙
 = fcn->fcn;

255 i‡(
ôî
->
f˙
 =
NULL
) {

256 
	`uc_îr‹
("Unknow¿fõld vÆuê'%s'", 
s
);

257 
nuŒ
;

259 i‡(
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, "ªgex", &
d
)) {

260 
	`uc_îr‹
("LookupsÑequireÑegex!");

261 
nuŒ
;

263 i‡(
	`¢d_c⁄fig_gë_°rög
(
d
, &
s
))

264 
nuŒ
;

265 
îr
 = 
	`ªgcomp
(&
ª
, 
s
, 
REG_EXTENDED
 | 
REG_ICASE
);

266 i‡(
îr
) {

267 
	`uc_îr‹
("Regex '%s' compû©i⁄ faûed (codê%d)", 
s
, 
îr
);

268 
nuŒ
;

271 
ªsu…
 = 
NULL
;

272 
cuº
 = 
ôî
->
	`fú°
(
uc_mgr
, iãr); cuº; cuº = iãr->
	`√xt
(uc_mgr, iter)) {

273 
s
 = 
cuº
->
	`f˙
(
ôî
->
öfo
);

274 i‡(
s
 =
NULL
)

276 i‡(
	`ªgexec
(&
ª
, 
s
, 
	`ARRAY_SIZE
(
m©ch
), match, 0) == 0) {

277 
ªsu…
 = 
cuº
->
	`ªtf˙
(
ôî
, 
c⁄fig
);

281 
	`ªg‰ì
(&
ª
);

282 
fö
:

283 
	`¢d_c⁄fig_dñëe
(
c⁄fig
);

284 i‡(
ôî
->
d⁄e
)

285 
ôî
->
	`d⁄e
(iter);

286  
ªsu…
;

287 
nuŒ
:

288 
ªsu…
 = 
NULL
;

289 
fö
;

290 
	}
}

292 
lookup_ôî©e
 *
	$rvÆ_ˇrd_lookup1
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

293 
lookup_ôî©e
 *
ôî
,

294 
ˇrd
)

296 i‡(
	`¢d_ˇrd_√xt
(&
ˇrd
) < 0 || card < 0)

297  
NULL
;

298 
ôî
->
˘l_li°
 = 
	`uc_mgr_gë_˘l_by_ˇrd
(
uc_mgr
, 
ˇrd
);

299 i‡(
ôî
->
˘l_li°
 =
NULL
)

300  
NULL
;

301 
ôî
->
öfo
 = iãr->
˘l_li°
->
˘l_öfo
;

302  
ôî
;

303 
	}
}

305 
lookup_ôî©e
 *
	$rvÆ_ˇrd_lookup_fú°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

306 
lookup_ôî©e
 *
ôî
)

308  
	`rvÆ_ˇrd_lookup1
(
uc_mgr
, 
ôî
, -1);

309 
	}
}

311 
lookup_ôî©e
 *
	$rvÆ_ˇrd_lookup_√xt
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

312 
lookup_ôî©e
 *
ôî
)

314  
	`rvÆ_ˇrd_lookup1
(
uc_mgr
, 
ôî
, 
	`¢d_˘l_ˇrd_öfo_gë_ˇrd
(ôî->
öfo
));

315 
	}
}

317 *
	$rvÆ_ˇrd_lookup_ªtu∫
(
lookup_ôî©e
 *
ôî
, 
¢d_c⁄fig_t
 *
c⁄fig
)

319 
¢d_c⁄fig_t
 *
d
;

320 c⁄° *
s
;

322 i‡(
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, "ªtu∫", &
d
))

323  
	`°rdup
(
	`¢d_˘l_ˇrd_öfo_gë_id
(
ôî
->
öfo
));

324 i‡(
	`¢d_c⁄fig_gë_°rög
(
d
, &
s
))

325  
NULL
;

326 i‡(
	`°rˇ£cmp
(
s
, "id") == 0)

327  
	`°rdup
(
	`¢d_˘l_ˇrd_öfo_gë_id
(
ôî
->
öfo
));

328 i‡(
	`°rˇ£cmp
(
s
, "number") == 0) {

329 
num
[16];

330 
	`¢¥ötf
(
num
, “um), "%d", 
	`¢d_˘l_ˇrd_öfo_gë_ˇrd
(
ôî
->
öfo
));

331  
	`°rdup
(
num
);

333 
	`uc_îr‹
("Unknow¿ªtu∫Åy≥ '%s'", 
s
);

334  
NULL
;

336 
	}
}

338 *
	$rvÆ_ˇrd_lookup
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
quîy
)

340 
lookup_f˙
 
f˙s
[] = {

341 { .
«me
 = "id", (
lookup_f˙_t
)
¢d_˘l_ˇrd_öfo_gë_id
 },

342 { .
«me
 = "drivî", (
lookup_f˙_t
)
¢d_˘l_ˇrd_öfo_gë_drivî
 },

343 { .
«me
 = "«me", (
lookup_f˙_t
)
¢d_˘l_ˇrd_öfo_gë_«me
 },

344 { .
«me
 = "l⁄g«me", (
lookup_f˙_t
)
¢d_˘l_ˇrd_öfo_gë_l⁄g«me
 },

345 { .
«me
 = "mixî«me", (
lookup_f˙_t
)
¢d_˘l_ˇrd_öfo_gë_mixî«me
 },

346 { .
«me
 = "comp⁄íts", (
lookup_f˙_t
)
¢d_˘l_ˇrd_öfo_gë_comp⁄íts
 },

349 
lookup_ôî©e
 
ôî
 = {

350 .
fú°
 = 
rvÆ_ˇrd_lookup_fú°
,

351 .
√xt
 = 
rvÆ_ˇrd_lookup_√xt
,

352 .
ªtf˙
 = 
rvÆ_ˇrd_lookup_ªtu∫
,

353 .
f˙s
 = fcns,

355  
	`rvÆ_lookup_maö
(
uc_mgr
, 
quîy
, &
ôî
);

356 
	}
}

358 
lookup_ôî©e
 *
	$rvÆ_pcm_lookup1
(
lookup_ôî©e
 *
ôî
,

359 
devi˚
)

361 
¢d_pcm_öfo_t
 *
pcmöfo
;

362 
¢d_˘l_t
 *
˘l
 = 
ôî
->
˘l_li°
->ctl;

363 
îr
;

365 
√xt
:

366 i‡(
	`¢d_˘l_pcm_√xt_devi˚
(
˘l
, &
devi˚
) < 0 || device < 0)

367  
NULL
;

368 
pcmöfo
 = 
ôî
->
öfo
;

369 
	`¢d_pcm_öfo_£t_devi˚
(
pcmöfo
, 
devi˚
);

370 
îr
 = 
	`¢d_˘l_pcm_öfo
(
˘l
, 
pcmöfo
);

371 i‡(
îr
 < 0) {

372 i‡(
îr
 =-
ENOENT
)

373 
√xt
;

374 
	`uc_îr‹
("U«bÀÅÿobèö PCM infÿ(devi˚ %d)", 
devi˚
);

375  
NULL
;

377  
ôî
;

378 
	}
}

380 
lookup_ôî©e
 *
	$rvÆ_pcm_lookup_fú°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
 
ATTRIBUTE_UNUSED
,

381 
lookup_ôî©e
 *
ôî
)

383  
	`rvÆ_pcm_lookup1
(
ôî
, -1);

384 
	}
}

386 
lookup_ôî©e
 *
	$rvÆ_pcm_lookup_√xt
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
 
ATTRIBUTE_UNUSED
,

387 
lookup_ôî©e
 *
ôî
)

389  
	`rvÆ_pcm_lookup1
(
ôî
, 
	`¢d_pcm_öfo_gë_devi˚
(ôî->
öfo
));

390 
	}
}

392 *
	$rvÆ_pcm_lookup_ªtu∫
(
lookup_ôî©e
 *
ôî
,

393 
¢d_c⁄fig_t
 *
c⁄fig
 
ATTRIBUTE_UNUSED
)

395 
num
[16];

396 
	`¢¥ötf
(
num
, “um), "%d", 
	`¢d_pcm_öfo_gë_devi˚
(
ôî
->
öfo
));

397  
	`°rdup
(
num
);

398 
	}
}

400 
	$rvÆ_pcm_lookup_öô
(
lookup_ôî©e
 *
ôî
,

401 
¢d_c⁄fig_t
 *
c⁄fig
)

403 
lookup_f˙
 
pcm_f˙s
[] = {

404 { .
«me
 = "id", (
lookup_f˙_t
)
¢d_pcm_öfo_gë_id
 },

405 { .
«me
 = "«me", (
lookup_f˙_t
)
¢d_pcm_öfo_gë_«me
 },

406 { .
«me
 = "sub«me", (
lookup_f˙_t
)
¢d_pcm_öfo_gë_subdevi˚_«me
 },

409 
¢d_c⁄fig_t
 *
d
;

410 c⁄° *
s
;

411 
¢d_pcm_öfo_t
 *
pcmöfo
;

412 
¢d_pcm_°ªam_t
 
°ªam
 = 
SND_PCM_STREAM_PLAYBACK
;

414 i‡(
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, "°ªam", &
d
) == 0 &&

415 
	`¢d_c⁄fig_gë_°rög
(
d
, &
s
) == 0) {

416 i‡(
	`°rˇ£cmp
(
s
, "playback") == 0)

417 
°ªam
 = 
SND_PCM_STREAM_PLAYBACK
;

418 i‡(
	`°rˇ£cmp
(
s
, "capture") == 0)

419 
°ªam
 = 
SND_PCM_STREAM_CAPTURE
;

421 
	`uc_îr‹
("Unknow¿°ªamÅy≥ '%s'", 
s
);

422  -
EINVAL
;

425 i‡(
	`¢d_pcm_öfo_mÆloc
(&
pcmöfo
))

426  -
ENOMEM
;

427 
	`¢d_pcm_öfo_£t_devi˚
(
pcmöfo
, 0);

428 
	`¢d_pcm_öfo_£t_subdevi˚
(
pcmöfo
, 0);

429 
	`¢d_pcm_öfo_£t_°ªam
(
pcmöfo
, 
°ªam
);

430 
ôî
->
fú°
 = 
rvÆ_pcm_lookup_fú°
;

431 
ôî
->
√xt
 = 
rvÆ_pcm_lookup_√xt
;

432 
ôî
->
ªtf˙
 = 
rvÆ_pcm_lookup_ªtu∫
;

433 
ôî
->
f˙s
 = 
pcm_f˙s
;

434 
ôî
->
öfo
 = 
pcmöfo
;

436 
	}
}

438 
	$rvÆ_devi˚_lookup_öô
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

439 
lookup_ôî©e
 *
ôî
,

440 
¢d_c⁄fig_t
 *
c⁄fig
)

443 c⁄° *
«me
;

444 (*
öô
)(
lookup_ôî©e
 *
ôî
, 
¢d_c⁄fig_t
 *
c⁄fig
);

445 } *
t
, 
ty≥s
[] = {

446 { .
«me
 = "pcm", .
öô
 = 
rvÆ_pcm_lookup_öô
 },

449 
¢d_c⁄fig_t
 *
d
;

450 c⁄° *
s
;

451 
îr
;

453 i‡(
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, "˘l", &
d
Ë|| 
	`¢d_c⁄fig_gë_°rög
(d, &
s
)) {

454 
ôî
->
˘l_li°
 = 
	`uc_mgr_gë_ma°î_˘l
(
uc_mgr
);

455 i‡(
ôî
->
˘l_li°
 =
NULL
) {

456 
	`uc_îr‹
("Control device isÇot defined!");

457  -
EINVAL
;

460 
îr
 = 
	`uc_mgr_›í_˘l
(
uc_mgr
, &
ôî
->
˘l_li°
, 
s
, 1);

461 i‡(
îr
 < 0) {

462 
	`uc_îr‹
("C⁄åﬁ devi˚ '%s'ÇŸ found", 
s
);

463  -
EINVAL
;

466 i‡(
	`¢d_c⁄fig_£¨ch
(
c⁄fig
, "ty≥", &
d
Ë|| 
	`¢d_c⁄fig_gë_°rög
(d, &
s
)) {

467 
	`uc_îr‹
("Missing deviceÅype!");

468  -
EINVAL
;

470 
t
 = 
ty≥s
;Å->
«me
;Å++)

471 i‡(
	`°rˇ£cmp
(
t
->
«me
, 
s
) == 0)

472  
t
->
	`öô
(
ôî
, 
c⁄fig
);

473 
	`uc_îr‹
("Devi˚Åy≥ '%s' i†övÆid", 
s
);

474  -
EINVAL
;

475 
	}
}

477 
	$rvÆ_devi˚_lookup_d⁄e
(
lookup_ôî©e
 *
ôî
)

479 
	`‰ì
(
ôî
->
öfo
);

480 
	}
}

482 *
	$rvÆ_devi˚_lookup
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
quîy
)

484 
lookup_ôî©e
 
ôî
 = {

485 .
öô
 = 
rvÆ_devi˚_lookup_öô
,

486 .
d⁄e
 = 
rvÆ_devi˚_lookup_d⁄e
,

488  
	`rvÆ_lookup_maö
(
uc_mgr
, 
quîy
, &
ôî
);

489 
	}
}

491 *
	$rvÆ_ív
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
 
ATTRIBUTE_UNUSED
, c⁄° *
id
)

493 *
e
;

495 i‡(*
id
 == '-') {

496 
e
 = 
	`gëív
(
id
 + 1);

497 i‡(
e
 =
NULL
)

498 
e
 = "";

500 
e
 = 
	`gëív
(
id
);

502 i‡(
e
)

503  
	`°rdup
(
e
);

504  
NULL
;

505 
	}
}

507 *
	$rvÆ_sysfs
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
 
ATTRIBUTE_UNUSED
, c⁄° *
id
)

509 
∑th
[
PATH_MAX
], 
lök
[PATH_MAX + 1];

510 
°©64
 
sb
;

511 
ssize_t
 
Àn
;

512 c⁄° *
e
;

513 
fd
;

515 
e
 = 
	`uc_mgr_sysfs_roŸ
();

516 i‡(
e
 =
NULL
)

517  
NULL
;

518 i‡(
id
[0] == '/')

519 
id
++;

520 
	`¢¥ötf
(
∑th
, ’©h), "%s/%s", 
e
, 
id
);

521 i‡(
	`l°©64
(
∑th
, &
sb
) != 0)

522  
NULL
;

523 i‡(
	`S_ISLNK
(
sb
.
°_mode
)) {

524 
Àn
 = 
	`ªadlök
(
∑th
, 
lök
, (link) - 1);

525 i‡(
Àn
 <= 0) {

526 
	`uc_îr‹
("sysfs: c™nŸÑódÜök '%s' (%d)", 
∑th
, 
î∫o
);

527  
NULL
;

529 
lök
[
Àn
] = '\0';

530 
e
 = 
	`°ºchr
(
lök
, '/');

531 i‡(
e
)

532  
	`°rdup
(
e
 + 1);

533  
NULL
;

535 i‡(
	`S_ISDIR
(
sb
.
°_mode
))

536  
NULL
;

537 i‡((
sb
.
°_mode
 & 
S_IRUSR
) == 0)

538  
NULL
;

540 
fd
 = 
	`›í
(
∑th
, 
O_RDONLY
);

541 i‡(
fd
 < 0) {

542 
	`uc_îr‹
("sysf†›í faûed f‹ '%s' (%d)", 
∑th
, 
î∫o
);

543  
NULL
;

545 
Àn
 = 
	`ªad
(
fd
, 
∑th
, (path)-1);

546 
	`˛o£
(
fd
);

547 i‡(
Àn
 < 0) {

548 
	`uc_îr‹
("sysf†u«bÀÅÿªad vÆuê'%s' (%d)", 
∑th
, 
î∫o
);

549  
NULL
;

551 
Àn
 > 0 && 
∑th
[len-1] == '\n')

552 
Àn
--;

553 
∑th
[
Àn
] = '\0';

554  
	`°rdup
(
∑th
);

555 
	}
}

557 *
	$rvÆ_v¨
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
id
)

559 c⁄° *
v
;

560 
boﬁ
 
ign‹e_nŸ_found
 = 
Ál£
;

562 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 3) {

563 
	`uc_îr‹
("variable substitution is supported in v3+ syntax");

564  
NULL
;

567 i‡(
id
[0] == '-') {

568 
ign‹e_nŸ_found
 = 
åue
;

569 
id
++;

570 } i‡(
id
[0] == '@') {

571 
ign‹e_nŸ_found
 = 
åue
;

573 
v
 = 
	`uc_mgr_gë_v¨übÀ
(
uc_mgr
, 
id
);

574 i‡(
v
 =
NULL
 && 
ign‹e_nŸ_found
)

575 
v
 = "";

576 i‡(
v
)

577  
	`°rdup
(
v
);

578  
NULL
;

579 
	}
}

581 
_¢d_evÆ_°rög
(
¢d_c⁄fig_t
 **
d°
, c⁄° *
s
,

582 
¢d_c⁄fig_ex∑nd_f˙_t
 
f˙
, *
¥iv©e_d©a
);

584 
	$rvÆ_evÆ_v¨_cb
(
¢d_c⁄fig_t
 **
d°
, c⁄° *
s
, *
¥iv©e_d©a
)

586 
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
 = 
¥iv©e_d©a
;

587 c⁄° *
v
;

589 
v
 = 
	`uc_mgr_gë_v¨übÀ
(
uc_mgr
, 
s
);

590 i‡(
v
 =
NULL
)

591  -
ENOENT
;

592  
	`¢d_c⁄fig_imake_°rög
(
d°
, 
NULL
, 
v
);

593 
	}
}

595 *
	$rvÆ_evÆ
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
e
)

597 
¢d_c⁄fig_t
 *
d°
;

598 *
r
;

599 
îr
;

601 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 5) {

602 
	`uc_îr‹
("variableÉvaluation is supported in v5+ syntax");

603  
NULL
;

605 
îr
 = 
	`_¢d_evÆ_°rög
(&
d°
, 
e
, 
rvÆ_evÆ_v¨_cb
, 
uc_mgr
);

606 i‡(
îr
 < 0) {

607 
	`uc_îr‹
("u«bÀÅÿevÆu©ê'%s'", 
e
);

608  
NULL
;

610 
îr
 = 
	`¢d_c⁄fig_gë_ascii
(
d°
, &
r
);

611 
	`¢d_c⁄fig_dñëe
(
d°
);

612 i‡(
îr
 < 0)

613  
NULL
;

614  
r
;

615 
	}
}

617 
	$rvÆ_evÆi
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
node
, c⁄° *
e
)

619 
¢d_c⁄fig_t
 *
d°
;

620 c⁄° *
id
;

621 *
s
;

622 
size_t
 
l
;

623 
îr
;

625 i‡(
uc_mgr
->
c⁄f_f‹m©
 < 6) {

626 
	`uc_îr‹
("variableÉvaluation is supported in v6+ syntax");

627  -
EINVAL
;

629 
îr
 = 
	`¢d_c⁄fig_gë_id
(
node
, &
id
);

630 i‡(
îr
 < 0)

631  
îr
;

632 
l
 = 
	`°æí
(
e
);

633 i‡(
e
[
l
-1] != '}')

634  -
EINVAL
;

635 
s
 = 
	`mÆloc
(
l
 + 1);

636 i‡(
s
 =
NULL
)

637  -
ENOMEM
;

638 
	`°r˝y
(
s
, 
e
);

639 
s
[
l
-1] = '\0';

640 
îr
 = 
	`_¢d_evÆ_°rög
(&
d°
, 
s
 + 8, 
rvÆ_evÆ_v¨_cb
, 
uc_mgr
);

641 
	`‰ì
(
s
);

642 i‡(
îr
 < 0) {

643 
	`uc_îr‹
("u«bÀÅÿevÆu©ê'%s'", 
e
);

644  
îr
;

646 
îr
 = 
	`¢d_c⁄fig_£t_id
(
d°
, 
id
);

647 i‡(
îr
 < 0)

648  
îr
;

649  
	`¢d_c⁄fig_sub°ôuã
(
node
, 
d°
);

650 
	}
}

652 
	#MATCH_VARIABLE
(
«me
, 
id
, 
f˙
, 
em±y_ok
) \

653 i‡(
	`°∫cmp
((
«me
), (
id
), (id) - 1) == 0) { \

654 
rvÆ
 = 
	`f˙
(
uc_mgr
); \

655 
idsize
 = (
id
) - 1; \

656 
Ælow_em±y
 = (
em±y_ok
); \

657 
__rvÆ
; \

658 }

	)

660 
	#MATCH_VARIABLE2
(
«me
, 
id
, 
f˙
, 
em±y_ok
) \

661 i‡(
	`°∫cmp
((
«me
), (
id
), (id) - 1) == 0) { \

662 
idsize
 = (
id
) - 1; \

663 
Ælow_em±y
 = (
em±y_ok
); \

664 
f˙2
 = (
f˙
); \

665 
__m©ch2
; \

666 }

	)

671 
ölöe
 c⁄° *
	$°rchr_wôh_esˇ≥
(c⁄° *
°r
, 
c
)

673 *
s
;

676 
s
 = 
	`°rchr
(
°r
, 
c
);

677 i‡(
s
 && s !
°r
) {

678 i‡(*(
s
 - 1) == '\\') {

679 
°r
 = 
s
 + 1;

683  
s
;

685 
	}
}

690 
ölöe
 
	$°∫˝y_wôh_esˇ≥
(*
d°
, c⁄° *
§c
, 
size_t
 
Àn
)

692 
c
;

694 
c
 = *
§c
++;

695 
c
 !'\0' && 
Àn
 > 0) {

696 i‡(
c
 ='\\' && *
§c
 == '}') {

697 
c
 = *
§c
++;

698 
Àn
--;

700 *
d°
++ = 
c
;

701 
Àn
--;

702 
c
 = *
§c
++;

704 *
d°
 = '\0';

705 
	}
}

707 
	$uc_mgr_gë_sub°ôuãd_vÆue
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

708 **
_rvÆue
,

709 c⁄° *
vÆue
)

711 
size_t
 
size
, 
nsize
, 
idsize
, 
rvÆsize
, 
dpos
 = 0;

712 c⁄° *
tmp
;

713 *
r
, *
ƒ
, *
rvÆ
, 
v2
[128];

714 
boﬁ
 
ign‹e_îr‹
, 
Ælow_em±y
;

715 *(*
f˙2
)(
¢d_u£_ˇ£_mgr_t
 *, c⁄° *
id
);

716 
îr
;

718 i‡(
vÆue
 =
NULL
)

719  -
ENOENT
;

721 
size
 = 
	`°æí
(
vÆue
) + 1;

722 
r
 = 
	`mÆloc
(
size
);

723 i‡(
r
 =
NULL
)

724  -
ENOMEM
;

726 *
vÆue
) {

727 i‡(*
vÆue
 != '$') {

728 
__°d
:

729 
r
[
dpos
++] = *
vÆue
;

730 
vÆue
++;

733 
ign‹e_îr‹
 = 
Ál£
;

734 i‡(
vÆue
[1] ='$' && vÆue[2] ='{' && 
uc_mgr
->
c⁄f_f‹m©
 >= 3) {

735 
vÆue
++;

736 
ign‹e_îr‹
 = 
åue
;

737 } i‡(
vÆue
[1] != '{') {

738 
__°d
;

740 
f˙2
 = 
NULL
;

741 
	`MATCH_VARIABLE
(
vÆue
, "${O≥nName}", 
rvÆ_›í_«me
, 
Ál£
);

742 
	`MATCH_VARIABLE
(
vÆue
, "${C⁄fLibDú}", 
rvÆ_c⁄f_libdú
, 
Ál£
);

743 
	`MATCH_VARIABLE
(
vÆue
, "${C⁄fT›Dú}", 
rvÆ_c⁄f_t›dú
, 
Ál£
);

744 
	`MATCH_VARIABLE
(
vÆue
, "${C⁄fDú}", 
rvÆ_c⁄f_dú
, 
Ál£
);

745 
	`MATCH_VARIABLE
(
vÆue
, "${C⁄fName}", 
rvÆ_c⁄f_«me
, 
Ál£
);

746 
	`MATCH_VARIABLE
(
vÆue
, "${C¨dNumbî}", 
rvÆ_ˇrd_numbî
, 
åue
);

747 
	`MATCH_VARIABLE
(
vÆue
, "${C¨dId}", 
rvÆ_ˇrd_id
, 
Ál£
);

748 
	`MATCH_VARIABLE
(
vÆue
, "${C¨dDrivî}", 
rvÆ_ˇrd_drivî
, 
Ál£
);

749 
	`MATCH_VARIABLE
(
vÆue
, "${C¨dName}", 
rvÆ_ˇrd_«me
, 
Ál£
);

750 
	`MATCH_VARIABLE
(
vÆue
, "${C¨dL⁄gName}", 
rvÆ_ˇrd_l⁄g«me
, 
Ál£
);

751 
	`MATCH_VARIABLE
(
vÆue
, "${C¨dComp⁄íts}", 
rvÆ_ˇrd_comp⁄íts
, 
åue
);

752 
	`MATCH_VARIABLE2
(
vÆue
, "${ív:", 
rvÆ_ív
, 
Ál£
);

753 
	`MATCH_VARIABLE2
(
vÆue
, "${sys:", 
rvÆ_sysfs
, 
Ál£
);

754 
	`MATCH_VARIABLE2
(
vÆue
, "${v¨:", 
rvÆ_v¨
, 
åue
);

755 
	`MATCH_VARIABLE2
(
vÆue
, "${evÆ:", 
rvÆ_evÆ
, 
Ál£
);

756 
	`MATCH_VARIABLE2
(
vÆue
, "${föd-ˇrd:", 
rvÆ_ˇrd_lookup
, 
Ál£
);

757 
	`MATCH_VARIABLE2
(
vÆue
, "${föd-devi˚:", 
rvÆ_devi˚_lookup
, 
Ál£
);

758 
	`MATCH_VARIABLE2
(
vÆue
, "${C¨dNumbîByName:", 
rvÆ_ˇrd_numbî_by_«me
, 
Ál£
);

759 
	`MATCH_VARIABLE2
(
vÆue
, "${C¨dIdByName:", 
rvÆ_ˇrd_id_by_«me
, 
Ál£
);

760 
__mîr
:

761 
îr
 = -
EINVAL
;

762 
tmp
 = 
	`°rchr
(
vÆue
, '}');

763 i‡(
tmp
) {

764 
	`°∫˝y
(
r
, 
vÆue
, 
tmp
 + 1 - value);

765 
r
[
tmp
 + 1 - 
vÆue
] = '\0';

766 
	`uc_îr‹
("v¨übÀ '%s' i†nŸ known!", 
r
);

768 
	`uc_îr‹
("v¨übÀÑe„ªn˚ '%s' i†nŸ com∂ëe", 
vÆue
);

770 
__îr‹
;

771 
__m©ch2
:

772 
tmp
 = 
	`°rchr_wôh_esˇ≥
(
vÆue
 + 
idsize
, '}');

773 i‡(
tmp
) {

774 
rvÆsize
 = 
tmp
 - (
vÆue
 + 
idsize
);

775 i‡(
rvÆsize
 >(
v2
)) {

776 
îr
 = -
ENOMEM
;

777 
__îr‹
;

779 
	`°∫˝y_wôh_esˇ≥
(
v2
, 
vÆue
 + 
idsize
, 
rvÆsize
);

780 
idsize
 +
rvÆsize
 + 1;

781 i‡(*
v2
 ='$' && 
uc_mgr
->
c⁄f_f‹m©
 >= 3) {

782 i‡(
	`°∫cmp
(
vÆue
, "${eval:", 7) == 0)

783 
__dúe˘_f˙2
;

784 
tmp
 = 
	`uc_mgr_gë_v¨übÀ
(
uc_mgr
, 
v2
 + 1);

785 i‡(
tmp
 =
NULL
) {

786 
	`uc_îr‹
("deföê'%s' i†nŸÑóchabÀ i¿thi†c⁄ãxt!", 
v2
 + 1);

787 
rvÆ
 = 
NULL
;

789 
rvÆ
 = 
	`f˙2
(
uc_mgr
, 
tmp
);

792 
__dúe˘_f˙2
:

793 
rvÆ
 = 
	`f˙2
(
uc_mgr
, 
v2
);

795 
__rvÆ
;

797 
__mîr
;

798 
__rvÆ
:

799 i‡(
rvÆ
 =
NULL
 || (!
Ælow_em±y
 &&Ñval[0] == '\0')) {

800 
	`‰ì
(
rvÆ
);

801 i‡(
ign‹e_îr‹
) {

802 
vÆue
 +
idsize
;

805 
	`°∫˝y
(
r
, 
vÆue
, 
idsize
);

806 
r
[
idsize
] = '\0';

807 
	`uc_îr‹
("v¨übÀ '%s' i†%†öÅhi†c⁄ãxt!", 
r
,

808 
rvÆ
 ? "empty" : "not defined");

809 
îr
 = -
EINVAL
;

810 
__îr‹
;

812 
vÆue
 +
idsize
;

813 
rvÆsize
 = 
	`°æí
(
rvÆ
);

814 
nsize
 = 
size
 + 
rvÆsize
 - 
idsize
;

815 i‡(
nsize
 > 
size
) {

816 
ƒ
 = 
	`ªÆloc
(
r
, 
nsize
);

817 i‡(
ƒ
 =
NULL
) {

818 
	`‰ì
(
rvÆ
);

819 
îr
 = -
ENOMEM
;

820 
__îr‹
;

822 
size
 = 
nsize
;

823 
r
 = 
ƒ
;

825 
	`°r˝y
(
r
 + 
dpos
, 
rvÆ
);

826 
dpos
 +
rvÆsize
;

827 
	`‰ì
(
rvÆ
);

829 
r
[
dpos
] = '\0';

831 *
_rvÆue
 = 
r
;

834 
__îr‹
:

835 
	`‰ì
(
r
);

836  
îr
;

837 
	}
}

839 
ölöe
 
	$uc_mgr_sub°ôuã_check
(c⁄° *
s
)

841  
s
 && 
	`°r°r
(s, "${"Ë!
NULL
;

842 
	}
}

844 
	$uc_mgr_sub°ôuã_åì
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
¢d_c⁄fig_t
 *
node
)

846 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

847 
¢d_c⁄fig_t
 *
n
;

848 c⁄° *
id
, *
s2
;

849 *
s
;

850 
îr
;

852 
îr
 = 
	`¢d_c⁄fig_gë_id
(
node
, &
id
);

853 i‡(
îr
 < 0)

854  
îr
;

855 i‡(
	`uc_mgr_sub°ôuã_check
(
id
)) {

856 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s
, 
id
);

857 i‡(
îr
 < 0)

858  
îr
;

859 
îr
 = 
	`¢d_c⁄fig_£t_id
(
node
, 
s
);

860 i‡(
îr
 < 0) {

861 
	`uc_îr‹
("u«bÀÅÿ£àsub°ôuãd id '%s' (ﬁd id '%s')", 
s
, 
id
);

862 
	`‰ì
(
s
);

863  
îr
;

865 
	`‰ì
(
s
);

867 i‡(
	`¢d_c⁄fig_gë_ty≥
(
node
Ë!
SND_CONFIG_TYPE_COMPOUND
) {

868 i‡(
	`¢d_c⁄fig_gë_ty≥
(
node
Ë=
SND_CONFIG_TYPE_STRING
) {

869 
îr
 = 
	`¢d_c⁄fig_gë_°rög
(
node
, &
s2
);

870 i‡(
îr
 < 0)

871  
îr
;

872 i‡(!
	`uc_mgr_sub°ôuã_check
(
s2
))

874 i‡(
	`°∫cmp
(
s2
, "${evali:", 8) == 0)

875  
	`rvÆ_evÆi
(
uc_mgr
, 
node
, 
s2
);

876 
îr
 = 
	`uc_mgr_gë_sub°ôuãd_vÆue
(
uc_mgr
, &
s
, 
s2
);

877 i‡(
îr
 < 0)

878  
îr
;

879 
îr
 = 
	`¢d_c⁄fig_£t_°rög
(
node
, 
s
);

880 
	`‰ì
(
s
);

881 i‡(
îr
 < 0)

882  
îr
;

887 
îr
 = 
	`¢d_c⁄fig_gë_id
(
node
, &
id
);

888 i‡(
îr
 < 0)

889  
îr
;

890 i‡(
id
 && 
	`°rcmp
(id, "DefineMacro") == 0)

892 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
node
) {

893 
n
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

894 
îr
 = 
	`uc_mgr_sub°ôuã_åì
(
uc_mgr
, 
n
);

895 i‡(
îr
 < 0)

896  
îr
;

899 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/utils.c

33 
	~"ucm_loˇl.h
"

35 
	$uc_mgr_îr‹
(c⁄° *
fmt
,...)

37 
va_li°
 
va
;

38 
	`va_°¨t
(
va
, 
fmt
);

39 
	`Ârötf
(
°dîr
, "ucm: ");

40 
	`vÂrötf
(
°dîr
, 
fmt
, 
va
);

41 
	`va_íd
(
va
);

42 
	}
}

44 
	$uc_mgr_°dout
(c⁄° *
fmt
,...)

46 
va_li°
 
va
;

47 
	`va_°¨t
(
va
, 
fmt
);

48 
	`vÂrötf
(
°dout
, 
fmt
, 
va
);

49 
	`va_íd
(
va
);

50 
	}
}

52 c⁄° *
	$uc_mgr_sysfs_roŸ
()

54 c⁄° *
e
 = 
	`gëív
("SYSFS_PATH");

55 i‡(
e
 =
NULL
)

57 i‡(*
e
 == '\0')

58 
	`uc_îr‹
("no sysfsÑoot!");

59  
e
;

60 
	}
}

62 
˘l_li°
 *
	$uc_mgr_gë_ma°î_˘l
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

64 
li°_hód
 *
pos
;

65 
˘l_li°
 *˘l_li° = 
NULL
, *
˘l_li°2
;

67 
	`li°_f‹_óch
(
pos
, &
uc_mgr
->
˘l_li°
) {

68 
˘l_li°2
 = 
	`li°_íåy
(
pos
, 
˘l_li°
, 
li°
);

69 i‡(
˘l_li°2
->
¶ave
)

71 i‡(
˘l_li°
) {

72 
	`uc_îr‹
("multiple control deviceÇames were found!");

73  
NULL
;

75 
˘l_li°
 = 
˘l_li°2
;

77  
˘l_li°
;

78 
	}
}

80 
˘l_li°
 *
	$uc_mgr_gë_˘l_by_ˇrd
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, 
ˇrd
)

82 
˘l_li°
 *ctl_list;

83 
˙ame
[32];

84 
îr
;

86 
	`•rötf
(
˙ame
, "hw:%d", 
ˇrd
);

87 
îr
 = 
	`uc_mgr_›í_˘l
(
uc_mgr
, &
˘l_li°
, 
˙ame
, 1);

88 i‡(
îr
 < 0)

89  
NULL
;

90  
˘l_li°
;

91 
	}
}

93 
˘l_li°
 *
	$uc_mgr_gë_˘l_by_«me
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
«me
, 
idx
)

95 
li°_hód
 *
pos
;

96 
˘l_li°
 *ctl_list;

97 c⁄° *
s
;

98 
idx2
, 
ˇrd
;

100 
idx2
 = 
idx
;

101 
	`li°_f‹_óch
(
pos
, &
uc_mgr
->
˘l_li°
) {

102 
˘l_li°
 = 
	`li°_íåy
(
pos
, ˘l_li°, 
li°
);

103 
s
 = 
	`¢d_˘l_ˇrd_öfo_gë_«me
(
˘l_li°
->
˘l_öfo
);

104 i‡(
s
 =
NULL
)

106 i‡(
	`°rcmp
(
s
, 
«me
) == 0) {

107 i‡(
idx2
 == 0)

108  
˘l_li°
;

109 
idx2
--;

113 
idx2
 = 
idx
;

114 
ˇrd
 = -1;

115 i‡(
	`¢d_ˇrd_√xt
(&
ˇrd
) < 0 || card < 0)

116  
NULL
;

118 
ˇrd
 >= 0) {

119 
˘l_li°
 = 
	`uc_mgr_gë_˘l_by_ˇrd
(
uc_mgr
, 
ˇrd
);

120 i‡(
˘l_li°
 =
NULL
)

122 
s
 = 
	`¢d_˘l_ˇrd_öfo_gë_«me
(
˘l_li°
->
˘l_öfo
);

123 i‡(
s
 && 
	`°rcmp
(s, 
«me
) == 0) {

124 i‡(
idx2
 == 0)

125  
˘l_li°
;

126 
idx2
--;

128 i‡(
	`¢d_ˇrd_√xt
(&
ˇrd
) < 0)

132  
NULL
;

133 
	}
}

135 
¢d_˘l_t
 *
	$uc_mgr_gë_˘l
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

137 
˘l_li°
 *ctl_list;

139 
˘l_li°
 = 
	`uc_mgr_gë_ma°î_˘l
(
uc_mgr
);

140 i‡(
˘l_li°
)

141  
˘l_li°
->
˘l
;

142  
NULL
;

143 
	}
}

145 
	$uc_mgr_‰ì_˘l
(
˘l_li°
 *ctl_list)

147 
li°_hód
 *
pos
, *
≈os
;

148 
˘l_dev
 *ctl_dev;

150 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, &
˘l_li°
->
dev_li°
) {

151 
˘l_dev
 = 
	`li°_íåy
(
pos
, ˘l_dev, 
li°
);

152 
	`‰ì
(
˘l_dev
->
devi˚
);

153 
	`‰ì
(
˘l_dev
);

155 
	`¢d_˘l_ˇrd_öfo_‰ì
(
˘l_li°
->
˘l_öfo
);

156 
	`‰ì
(
˘l_li°
);

157 
	}
}

159 
	$uc_mgr_‰ì_˘l_li°
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

161 
li°_hód
 *
pos
, *
≈os
;

162 
˘l_li°
 *ctl_list;

164 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, &
uc_mgr
->
˘l_li°
) {

165 
˘l_li°
 = 
	`li°_íåy
(
pos
, ˘l_li°, 
li°
);

166 
	`¢d_˘l_˛o£
(
˘l_li°
->
˘l
);

167 
	`li°_dñ
(&
˘l_li°
->
li°
);

168 
	`uc_mgr_‰ì_˘l
(
˘l_li°
);

170 
	}
}

172 
	$uc_mgr_˘l_add_dev
(
˘l_li°
 *˘l_li°, c⁄° *
devi˚
)

174 
li°_hód
 *
pos
;

175 
˘l_dev
 *ctl_dev;

178 
	`li°_f‹_óch
(
pos
, &
˘l_li°
->
dev_li°
) {

179 
˘l_dev
 = 
	`li°_íåy
(
pos
, ˘l_dev, 
li°
);

180 i‡(
	`°rcmp
(
˘l_dev
->
devi˚
, device) == 0)

185 
˘l_dev
 = 
	`mÆloc
((*ctl_dev));

186 i‡(
˘l_dev
 =
NULL
)

187  -
ENOMEM
;

188 
˘l_dev
->
devi˚
 = 
	`°rdup
(device);

189 i‡(
˘l_dev
->
devi˚
 =
NULL
) {

190 
	`‰ì
(
˘l_dev
);

191  -
ENOMEM
;

193 
	`li°_add_èû
(&
˘l_dev
->
li°
, &
˘l_li°
->
dev_li°
);

195 
	}
}

197 
	$uc_mgr_˘l_add
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

198 
˘l_li°
 **ctl_list,

199 
¢d_˘l_t
 *
˘l
, 
ˇrd
,

200 
¢d_˘l_ˇrd_öfo_t
 *
öfo
,

201 c⁄° *
devi˚
,

202 
¶ave
)

204 
˘l_li°
 *
˛
 = 
NULL
;

205 c⁄° *
id
 = 
	`¢d_˘l_ˇrd_öfo_gë_id
(
öfo
);

206 
dev
[
MAX_CARD_LONG_NAME
];

207 
îr
, 
hô
 = 0;

209 i‡(
id
 =
NULL
 || id[0] == '\0')

210  -
ENOENT
;

211 i‡(!(*
˘l_li°
)) {

212 
˛
 = 
	`mÆloc
((*cl));

213 i‡(
˛
 =
NULL
)

214  -
ENOMEM
;

215 
	`INIT_LIST_HEAD
(&
˛
->
dev_li°
);

216 
˛
->
˘l
 = ctl;

217 i‡(
	`¢d_˘l_ˇrd_öfo_mÆloc
(&
˛
->
˘l_öfo
) < 0) {

218 
	`‰ì
(
˛
);

219  -
ENOMEM
;

221 
	`¢d_˘l_ˇrd_öfo_c›y
(
˛
->
˘l_öfo
, 
öfo
);

222 
˛
->
¶ave
 = slave;

223 *
˘l_li°
 = 
˛
;

225 i‡(!
¶ave
)

226 (*
˘l_li°
)->
¶ave
 = slave;

228 i‡(
ˇrd
 >= 0) {

229 
	`¢¥ötf
(
dev
, (dev), "hw:%d", 
ˇrd
);

230 
hô
 |!!(
devi˚
 && (
	`°rcmp
(
dev
, device) == 0));

231 
îr
 = 
	`uc_mgr_˘l_add_dev
(*
˘l_li°
, 
dev
);

232 i‡(
îr
 < 0)

233 
__nomem
;

235 
	`¢¥ötf
(
dev
, (dev), "hw:%s", 
id
);

236 
hô
 |!!(
devi˚
 && (
	`°rcmp
(
dev
, device) == 0));

237 
îr
 = 
	`uc_mgr_˘l_add_dev
(*
˘l_li°
, 
dev
);

238 i‡(
îr
 < 0)

239 
__nomem
;

241 i‡(!
hô
 && 
devi˚
) {

242 
îr
 = 
	`uc_mgr_˘l_add_dev
(*
˘l_li°
, 
devi˚
);

243 i‡(
îr
 < 0)

244 
__nomem
;

247 
	`li°_add_èû
(&(*
˘l_li°
)->
li°
, &
uc_mgr
->ctl_list);

250 
__nomem
:

251 i‡(*
˘l_li°
 =
˛
) {

252 
	`uc_mgr_‰ì_˘l
(
˛
);

253 *
˘l_li°
 = 
NULL
;

255  -
ENOMEM
;

256 
	}
}

258 
	$uc_mgr_›í_˘l
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
,

259 
˘l_li°
 **
˘Œ
,

260 c⁄° *
devi˚
,

261 
¶ave
)

263 
li°_hód
 *
pos1
, *
pos2
;

264 
¢d_˘l_t
 *
˘l
;

265 
˘l_li°
 *ctl_list;

266 
˘l_dev
 *ctl_dev;

267 
¢d_˘l_ˇrd_öfo_t
 *
öfo
;

268 c⁄° *
id
;

269 
îr
, 
ˇrd
, 
ucm_group
, 
ucm_off£t
;

271 
	`¢d_˘l_ˇrd_öfo_Æloˇ
(&
öfo
);

273 
ucm_group
 = 
	`_¢d_is_ucm_devi˚
(
devi˚
);

274 
ucm_off£t
 = 
ucm_group
 ? 8 : 0;

277 
	`li°_f‹_óch
(
pos1
, &
uc_mgr
->
˘l_li°
) {

278 
˘l_li°
 = 
	`li°_íåy
(
pos1
, ˘l_li°, 
li°
);

279 i‡(
˘l_li°
->
ucm_group
 != ucm_group)

281 
	`li°_f‹_óch
(
pos2
, &
˘l_li°
->
dev_li°
) {

282 
˘l_dev
 = 
	`li°_íåy
(
pos2
, ˘l_dev, 
li°
);

283 i‡(
	`°rcmp
(
˘l_dev
->
devi˚
, devi˚ + 
ucm_off£t
) == 0) {

284 *
˘Œ
 = 
˘l_li°
;

285 i‡(!
¶ave
)

286 
˘l_li°
->
¶ave
 = 0;

292 
îr
 = 
	`¢d_˘l_›í
(&
˘l
, 
devi˚
, 0);

293 i‡(
îr
 < 0)

294  
îr
;

296 
id
 = 
NULL
;

297 
îr
 = 
	`¢d_˘l_ˇrd_öfo
(
˘l
, 
öfo
);

298 i‡(
îr
 == 0)

299 
id
 = 
	`¢d_˘l_ˇrd_öfo_gë_id
(
öfo
);

300 i‡(
îr
 < 0 || 
id
 =
NULL
 || id[0] == '\0') {

301 
	`uc_îr‹
("c⁄åﬁ h¨dw¨êöfÿ(%s): %s", 
devi˚
, 
	`¢d_°ªº‹
(
îr
));

302 
	`¢d_˘l_˛o£
(
˘l
);

303  
îr
 >0 ? -
EINVAL
 :Érr;

307 
	`li°_f‹_óch
(
pos1
, &
uc_mgr
->
˘l_li°
) {

308 
˘l_li°
 = 
	`li°_íåy
(
pos1
, ˘l_li°, 
li°
);

309 i‡(
˘l_li°
->
ucm_group
 != ucm_group)

311 i‡(
	`°rcmp
(
id
, 
	`¢d_˘l_ˇrd_öfo_gë_id
(
˘l_li°
->
˘l_öfo
)) == 0) {

312 
ˇrd
 = 
	`¢d_ˇrd_gë_ödex
(
id
);

313 
îr
 = 
	`uc_mgr_˘l_add
(
uc_mgr
, &
˘l_li°
, 
˘l
, 
ˇrd
, 
öfo
, 
devi˚
 + 
ucm_off£t
, 
¶ave
);

314 i‡(
îr
 < 0)

315 
__nomem
;

316 
	`¢d_˘l_˛o£
(
˘l
);

317 
˘l_li°
->
ucm_group
 = ucm_group;

318 *
˘Œ
 = 
˘l_li°
;

323 
˘l_li°
 = 
NULL
;

324 
îr
 = 
	`uc_mgr_˘l_add
(
uc_mgr
, &
˘l_li°
, 
˘l
, -1, 
öfo
, 
devi˚
 + 
ucm_off£t
, 
¶ave
);

325 i‡(
îr
 < 0)

326 
__nomem
;

328 
˘l_li°
->
ucm_group
 = ucm_group;

329 *
˘Œ
 = 
˘l_li°
;

332 
__nomem
:

333 
	`¢d_˘l_˛o£
(
˘l
);

334  -
ENOMEM
;

335 
	}
}

337 c⁄° *
	$uc_mgr_c⁄fig_dú
(
f‹m©
)

339 c⁄° *
∑th
;

341 i‡(
f‹m©
 >= 2) {

342 
∑th
 = 
	`gëív
(
ALSA_CONFIG_UCM2_VAR
);

343 i‡(!
∑th
 ||Öath[0] == '\0')

344 
∑th
 = 
ALSA_CONFIG_DIR
 "/ucm2";

346 
∑th
 = 
	`gëív
(
ALSA_CONFIG_UCM_VAR
);

347 i‡(!
∑th
 ||Öath[0] == '\0')

348 
∑th
 = 
ALSA_CONFIG_DIR
 "/ucm";

350  
∑th
;

351 
	}
}

353 
	$uc_mgr_c⁄fig_lﬂd_öto
(
f‹m©
, c⁄° *
fûe
, 
¢d_c⁄fig_t
 *
t›
)

355 
FILE
 *
Â
;

356 
¢d_öput_t
 *
ö
;

357 c⁄° *
deÁu…_∑ths
[2];

358 
îr
;

360 
Â
 = 
	`f›í
(
fûe
, "r");

361 i‡(!
Â
) {

362 
îr
 = -
î∫o
;

363 
__îr_›í
:

364 
	`uc_îr‹
("couldÇŸ o≥¿c⁄figuøti⁄ fûê%s", 
fûe
);

365  
îr
;

367 
îr
 = 
	`¢d_öput_°dio_©èch
(&
ö
, 
Â
, 1);

368 i‡(
îr
 < 0)

369 
__îr_›í
;

371 
deÁu…_∑ths
[0] = 
	`uc_mgr_c⁄fig_dú
(
f‹m©
);

372 
deÁu…_∑ths
[1] = 
NULL
;

373 
îr
 = 
	`_¢d_c⁄fig_lﬂd_wôh_ö˛ude
(
t›
, 
ö
, 0, 
deÁu…_∑ths
);

374 i‡(
îr
 < 0) {

375 
	`uc_îr‹
("couldÇŸÜﬂd c⁄figuøti⁄ fûê%s", 
fûe
);

376 i‡(
ö
)

377 
	`¢d_öput_˛o£
(
ö
);

378  
îr
;

380 
îr
 = 
	`¢d_öput_˛o£
(
ö
);

381 i‡(
îr
 < 0)

382  
îr
;

384 
	}
}

386 
	$uc_mgr_c⁄fig_lﬂd
(
f‹m©
, c⁄° *
fûe
, 
¢d_c⁄fig_t
 **
cfg
)

388 
¢d_c⁄fig_t
 *
t›
;

389 
îr
;

391 
îr
 = 
	`¢d_c⁄fig_t›
(&
t›
);

392 i‡(
îr
 < 0)

393  
îr
;

394 
îr
 = 
	`uc_mgr_c⁄fig_lﬂd_öto
(
f‹m©
, 
fûe
, 
t›
);

395 i‡(
îr
 < 0) {

396 
	`¢d_c⁄fig_dñëe
(
t›
);

397  
îr
;

399 *
cfg
 = 
t›
;

401 
	}
}

403 
	$uc_mgr_‰ì_vÆue1
(
ucm_vÆue
 *
vÆ
)

405 
	`‰ì
(
vÆ
->
«me
);

406 
	`‰ì
(
vÆ
->
d©a
);

407 
	`li°_dñ
(&
vÆ
->
li°
);

408 
	`‰ì
(
vÆ
);

409 
	}
}

411 
	$uc_mgr_‰ì_vÆue
(
li°_hód
 *
ba£
)

413 
li°_hód
 *
pos
, *
≈os
;

414 
ucm_vÆue
 *
vÆ
;

416 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, 
ba£
) {

417 
vÆ
 = 
	`li°_íåy
(
pos
, 
ucm_vÆue
, 
li°
);

418 
	`uc_mgr_‰ì_vÆue1
(
vÆ
);

420 
	}
}

422 
	$uc_mgr_‰ì_dev_li°
(
dev_li°
 *dev_list)

424 
li°_hód
 *
pos
, *
≈os
;

425 
dev_li°_node
 *
dli°
;

427 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, &
dev_li°
->
li°
) {

428 
dli°
 = 
	`li°_íåy
(
pos
, 
dev_li°_node
, 
li°
);

429 
	`‰ì
(
dli°
->
«me
);

430 
	`li°_dñ
(&
dli°
->
li°
);

431 
	`‰ì
(
dli°
);

433 
	}
}

435 
	$uc_mgr_put_to_dev_li°
(
dev_li°
 *dev_li°, c⁄° *
«me
)

437 
li°_hód
 *
pos
;

438 
dev_li°_node
 *
dli°
;

439 *
n
;

441 
	`li°_f‹_óch
(
pos
, &
dev_li°
->
li°
) {

442 
dli°
 = 
	`li°_íåy
(
pos
, 
dev_li°_node
, 
li°
);

443 i‡(
	`°rcmp
(
dli°
->
«me
,Çame) == 0)

447 
dli°
 = 
	`ˇŒoc
(1, (*dlist));

448 i‡(
dli°
 =
NULL
)

449  -
ENOMEM
;

450 
n
 = 
	`°rdup
(
«me
);

451 i‡(
n
 =
NULL
) {

452 
	`‰ì
(
dli°
);

453  -
ENOMEM
;

455 
dli°
->
«me
 = 
n
;

456 
	`li°_add
(&
dli°
->
li°
, &
dev_li°
->list);

458 
	}
}

460 
	$uc_mgr_ª«me_ö_dev_li°
(
dev_li°
 *dev_li°, c⁄° *
§c
,

461 c⁄° *
d°
)

463 
li°_hód
 *
pos
;

464 
dev_li°_node
 *
dli°
;

465 *
d°1
;

467 
	`li°_f‹_óch
(
pos
, &
dev_li°
->
li°
) {

468 
dli°
 = 
	`li°_íåy
(
pos
, 
dev_li°_node
, 
li°
);

469 i‡(
	`°rcmp
(
dli°
->
«me
, 
§c
) == 0) {

470 
d°1
 = 
	`°rdup
(
d°
);

471 i‡(
d°1
 =
NULL
)

472  -
ENOMEM
;

473 
	`‰ì
(
dli°
->
«me
);

474 
dli°
->
«me
 = 
d°1
;

478  -
ENODEV
;

479 
	}
}

481 
	$uc_mgr_ªmove_‰om_dev_li°
(
dev_li°
 *dev_li°, c⁄° *
«me
)

483 
li°_hód
 *
pos
;

484 
dev_li°_node
 *
dli°
;

486 
	`li°_f‹_óch
(
pos
, &
dev_li°
->
li°
) {

487 
dli°
 = 
	`li°_íåy
(
pos
, 
dev_li°_node
, 
li°
);

488 i‡(
	`°rcmp
(
dli°
->
«me
,Çame) == 0) {

489 
	`‰ì
(
dli°
->
«me
);

490 
	`li°_dñ
(&
dli°
->
li°
);

491 
	`‰ì
(
dli°
);

495  -
ENODEV
;

496 
	}
}

498 
	$uc_mgr_‰ì_£quí˚_ñemít
(
£quí˚_ñemít
 *
£q
)

500 i‡(
£q
 =
NULL
)

502 
£q
->
ty≥
) {

503 
SEQUENCE_ELEMENT_TYPE_CDEV
:

504 
	`‰ì
(
£q
->
d©a
.
cdev
);

506 
SEQUENCE_ELEMENT_TYPE_CSET
:

507 
SEQUENCE_ELEMENT_TYPE_CSET_NEW
:

508 
SEQUENCE_ELEMENT_TYPE_CSET_BIN_FILE
:

509 
SEQUENCE_ELEMENT_TYPE_CSET_TLV
:

510 
SEQUENCE_ELEMENT_TYPE_CTL_REMOVE
:

511 
	`‰ì
(
£q
->
d©a
.
c£t
);

513 
SEQUENCE_ELEMENT_TYPE_SYSSET
:

514 
	`‰ì
(
£q
->
d©a
.
sysw
);

516 
SEQUENCE_ELEMENT_TYPE_EXEC
:

517 
SEQUENCE_ELEMENT_TYPE_SHELL
:

518 
	`‰ì
(
£q
->
d©a
.
exec
);

520 
SEQUENCE_ELEMENT_TYPE_CFGSAVE
:

521 
	`‰ì
(
£q
->
d©a
.
cfgßve
);

523 
SEQUENCE_ELEMENT_TYPE_DEV_ENABLE_SEQ
:

524 
SEQUENCE_ELEMENT_TYPE_DEV_DISABLE_SEQ
:

525 
	`‰ì
(
£q
->
d©a
.
devi˚
);

530 
	`‰ì
(
£q
);

531 
	}
}

533 
	$uc_mgr_‰ì_£quí˚
(
li°_hód
 *
ba£
)

535 
li°_hód
 *
pos
, *
≈os
;

536 
£quí˚_ñemít
 *
£q
;

538 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, 
ba£
) {

539 
£q
 = 
	`li°_íåy
(
pos
, 
£quí˚_ñemít
, 
li°
);

540 
	`li°_dñ
(&
£q
->
li°
);

541 
	`uc_mgr_‰ì_£quí˚_ñemít
(
£q
);

543 
	}
}

545 
	$uc_mgr_‰ì_å™sôi⁄_ñemít
(
å™sôi⁄_£quí˚
 *
t£q
)

547 
	`‰ì
(
t£q
->
«me
);

548 
	`uc_mgr_‰ì_£quí˚
(&
t£q
->
å™sôi⁄_li°
);

549 
	`‰ì
(
t£q
);

550 
	}
}

552 
	$uc_mgr_‰ì_å™sôi⁄
(
li°_hód
 *
ba£
)

554 
li°_hód
 *
pos
, *
≈os
;

555 
å™sôi⁄_£quí˚
 *
t£q
;

557 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, 
ba£
) {

558 
t£q
 = 
	`li°_íåy
(
pos
, 
å™sôi⁄_£quí˚
, 
li°
);

559 
	`li°_dñ
(&
t£q
->
li°
);

560 
	`uc_mgr_‰ì_å™sôi⁄_ñemít
(
t£q
);

562 
	}
}

564 
	$uc_mgr_‰ì_dev_«me_li°
(
li°_hód
 *
ba£
)

566 
li°_hód
 *
pos
, *
≈os
;

567 
ucm_dev_«me
 *
dev
;

569 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, 
ba£
) {

570 
dev
 = 
	`li°_íåy
(
pos
, 
ucm_dev_«me
, 
li°
);

571 
	`li°_dñ
(&
dev
->
li°
);

572 
	`‰ì
(
dev
->
«me1
);

573 
	`‰ì
(
dev
->
«me2
);

574 
	`‰ì
(
dev
);

576 
	}
}

578 
	$uc_mgr_‰ì_modifõr
(
li°_hód
 *
ba£
)

580 
li°_hód
 *
pos
, *
≈os
;

581 
u£_ˇ£_modifõr
 *
mod
;

583 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, 
ba£
) {

584 
mod
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_modifõr
, 
li°
);

585 
	`‰ì
(
mod
->
«me
);

586 
	`‰ì
(
mod
->
commít
);

587 
	`uc_mgr_‰ì_£quí˚
(&
mod
->
íabÀ_li°
);

588 
	`uc_mgr_‰ì_£quí˚
(&
mod
->
dißbÀ_li°
);

589 
	`uc_mgr_‰ì_å™sôi⁄
(&
mod
->
å™sôi⁄_li°
);

590 
	`uc_mgr_‰ì_dev_li°
(&
mod
->
dev_li°
);

591 
	`uc_mgr_‰ì_vÆue
(&
mod
->
vÆue_li°
);

592 
	`li°_dñ
(&
mod
->
li°
);

593 
	`‰ì
(
mod
);

595 
	}
}

597 
	$uc_mgr_‰ì_devi˚
(
u£_ˇ£_devi˚
 *
dev
)

599 
	`‰ì
(
dev
->
«me
);

600 
	`‰ì
(
dev
->
commít
);

601 
	`uc_mgr_‰ì_£quí˚
(&
dev
->
íabÀ_li°
);

602 
	`uc_mgr_‰ì_£quí˚
(&
dev
->
dißbÀ_li°
);

603 
	`uc_mgr_‰ì_å™sôi⁄
(&
dev
->
å™sôi⁄_li°
);

604 
	`uc_mgr_‰ì_dev_li°
(&
dev
->
dev_li°
);

605 
	`uc_mgr_‰ì_vÆue
(&
dev
->
vÆue_li°
);

606 
	`li°_dñ
(&
dev
->
li°
);

607 
	`‰ì
(
dev
);

608 
	}
}

610 
	$uc_mgr_‰ì_devi˚_li°
(
li°_hód
 *
ba£
)

612 
li°_hód
 *
pos
, *
≈os
;

613 
u£_ˇ£_devi˚
 *
dev
;

615 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, 
ba£
) {

616 
dev
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_devi˚
, 
li°
);

617 
	`uc_mgr_‰ì_devi˚
(
dev
);

619 
	}
}

621 
	$uc_mgr_ª«me_devi˚
(
u£_ˇ£_vîb
 *
vîb
, c⁄° *
§c
,

622 c⁄° *
d°
)

624 
u£_ˇ£_devi˚
 *
devi˚
;

625 
li°_hód
 *
pos
, *
≈os
;

626 *
d°1
;

629 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, &
vîb
->
devi˚_li°
) {

630 
devi˚
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_devi˚
, 
li°
);

631 i‡(
	`°rcmp
(
devi˚
->
«me
, 
§c
) == 0) {

632 
d°1
 = 
	`°rdup
(
d°
);

633 i‡(
d°1
 =
NULL
)

634  -
ENOMEM
;

635 
	`‰ì
(
devi˚
->
«me
);

636 
devi˚
->
«me
 = 
d°1
;

639 
	`uc_mgr_ª«me_ö_dev_li°
(&
devi˚
->
dev_li°
, 
§c
, 
d°
);

642 
	}
}

644 
	$uc_mgr_ªmove_devi˚
(
u£_ˇ£_vîb
 *
vîb
, c⁄° *
«me
)

646 
u£_ˇ£_devi˚
 *
devi˚
;

647 
li°_hód
 *
pos
, *
≈os
;

648 
îr
, 
found
 = 0;

650 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, &
vîb
->
devi˚_li°
) {

651 
devi˚
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_devi˚
, 
li°
);

652 i‡(
	`°rcmp
(
devi˚
->
«me
,Çame) == 0) {

653 
	`uc_mgr_‰ì_devi˚
(
devi˚
);

654 
found
++;

657 
îr
 = 
	`uc_mgr_ªmove_‰om_dev_li°
(&
devi˚
->
dev_li°
, 
«me
);

658 i‡(
îr
 < 0 &&Éº !-
ENODEV
)

659  
îr
;

660 i‡(
îr
 == 0)

661 
found
++;

663  
found
 =0 ? -
ENODEV
 : 0;

664 
	}
}

666 c⁄° *
	$uc_mgr_gë_v¨übÀ
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
«me
)

668 
li°_hód
 *
pos
;

669 
ucm_vÆue
 *
vÆue
;

671 
	`li°_f‹_óch
(
pos
, &
uc_mgr
->
v¨übÀ_li°
) {

672 
vÆue
 = 
	`li°_íåy
(
pos
, 
ucm_vÆue
, 
li°
);

673 i‡(
	`°rcmp
(
vÆue
->
«me
,Çame) == 0)

674  
vÆue
->
d©a
;

676  
NULL
;

677 
	}
}

679 
	$uc_mgr_£t_v¨übÀ
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
«me
,

680 c⁄° *
vÆ
)

682 
li°_hód
 *
pos
;

683 
ucm_vÆue
 *
cuº
;

684 *
vÆ2
;

686 
	`li°_f‹_óch
(
pos
, &
uc_mgr
->
v¨übÀ_li°
) {

687 
cuº
 = 
	`li°_íåy
(
pos
, 
ucm_vÆue
, 
li°
);

688 i‡(
	`°rcmp
(
cuº
->
«me
,Çame) == 0) {

689 
vÆ2
 = 
	`°rdup
(
vÆ
);

690 i‡(
vÆ2
 =
NULL
)

691  -
ENOMEM
;

692 
	`‰ì
(
cuº
->
d©a
);

693 
cuº
->
d©a
 = 
vÆ2
;

698 
cuº
 = 
	`ˇŒoc
(1, (
ucm_vÆue
));

699 i‡(
cuº
 =
NULL
)

700  -
ENOMEM
;

701 
cuº
->
«me
 = 
	`°rdup
(name);

702 i‡(
cuº
->
«me
 =
NULL
) {

703 
	`‰ì
(
cuº
);

704  -
ENOMEM
;

706 
cuº
->
d©a
 = 
	`°rdup
(
vÆ
);

707 i‡(
cuº
->
d©a
 =
NULL
) {

708 
	`‰ì
(
cuº
->
«me
);

709 
	`‰ì
(
cuº
);

710  -
ENOMEM
;

712 
	`li°_add_èû
(&
cuº
->
li°
, &
uc_mgr
->
v¨übÀ_li°
);

714 
	}
}

716 
	$uc_mgr_dñëe_v¨übÀ
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
, c⁄° *
«me
)

718 
li°_hód
 *
pos
;

719 
ucm_vÆue
 *
cuº
;

721 
	`li°_f‹_óch
(
pos
, &
uc_mgr
->
v¨übÀ_li°
) {

722 
cuº
 = 
	`li°_íåy
(
pos
, 
ucm_vÆue
, 
li°
);

723 i‡(
	`°rcmp
(
cuº
->
«me
,Çame) == 0) {

724 
	`uc_mgr_‰ì_vÆue1
(
cuº
);

729  -
ENOENT
;

730 
	}
}

732 
	$uc_mgr_‰ì_vîb
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

734 
li°_hód
 *
pos
, *
≈os
;

735 
u£_ˇ£_vîb
 *
vîb
;

737 i‡(
uc_mgr
->
loˇl_c⁄fig
) {

738 
	`¢d_c⁄fig_dñëe
(
uc_mgr
->
loˇl_c⁄fig
);

739 
uc_mgr
->
loˇl_c⁄fig
 = 
NULL
;

741 i‡(
uc_mgr
->
ma¸os
) {

742 
	`¢d_c⁄fig_dñëe
(
uc_mgr
->
ma¸os
);

743 
uc_mgr
->
ma¸os
 = 
NULL
;

745 
	`li°_f‹_óch_ß„
(
pos
, 
≈os
, &
uc_mgr
->
vîb_li°
) {

746 
vîb
 = 
	`li°_íåy
(
pos
, 
u£_ˇ£_vîb
, 
li°
);

747 
	`‰ì
(
vîb
->
«me
);

748 
	`‰ì
(
vîb
->
commít
);

749 
	`uc_mgr_‰ì_£quí˚
(&
vîb
->
íabÀ_li°
);

750 
	`uc_mgr_‰ì_£quí˚
(&
vîb
->
dißbÀ_li°
);

751 
	`uc_mgr_‰ì_å™sôi⁄
(&
vîb
->
å™sôi⁄_li°
);

752 
	`uc_mgr_‰ì_vÆue
(&
vîb
->
vÆue_li°
);

753 
	`uc_mgr_‰ì_devi˚_li°
(&
vîb
->
devi˚_li°
);

754 
	`uc_mgr_‰ì_devi˚_li°
(&
vîb
->
cm±_devi˚_li°
);

755 
	`uc_mgr_‰ì_modifõr
(&
vîb
->
modifõr_li°
);

756 
	`uc_mgr_‰ì_dev_«me_li°
(&
vîb
->
ª«me_li°
);

757 
	`uc_mgr_‰ì_dev_«me_li°
(&
vîb
->
ªmove_li°
);

758 
	`li°_dñ
(&
vîb
->
li°
);

759 
	`‰ì
(
vîb
);

761 
	`uc_mgr_‰ì_£quí˚
(&
uc_mgr
->
fixedboŸ_li°
);

762 
	`uc_mgr_‰ì_£quí˚
(&
uc_mgr
->
boŸ_li°
);

763 
	`uc_mgr_‰ì_£quí˚
(&
uc_mgr
->
deÁu…_li°
);

764 
	`uc_mgr_‰ì_vÆue
(&
uc_mgr
->
vÆue_li°
);

765 
	`uc_mgr_‰ì_vÆue
(&
uc_mgr
->
v¨übÀ_li°
);

766 
	`‰ì
(
uc_mgr
->
commít
);

767 
	`‰ì
(
uc_mgr
->
c⁄f_dú_«me
);

768 
	`‰ì
(
uc_mgr
->
c⁄f_fûe_«me
);

769 
uc_mgr
->
commít
 = 
NULL
;

770 
uc_mgr
->
c⁄f_dú_«me
 = 
NULL
;

771 
uc_mgr
->
c⁄f_fûe_«me
 = 
NULL
;

772 
uc_mgr
->
a˘ive_vîb
 = 
NULL
;

773 
	`INIT_LIST_HEAD
(&
uc_mgr
->
a˘ive_devi˚s
);

774 
	`INIT_LIST_HEAD
(&
uc_mgr
->
a˘ive_modifõrs
);

775 
	}
}

777 
	$uc_mgr_‰ì
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

779 
	`uc_mgr_‰ì_vîb
(
uc_mgr
);

780 
	`uc_mgr_‰ì_˘l_li°
(
uc_mgr
);

781 
	`‰ì
(
uc_mgr
->
ˇrd_«me
);

782 
	`‰ì
(
uc_mgr
);

783 
	}
}

789 
±hªad_muãx_t
 
	gucm_ˇrds_muãx
 = 
PTHREAD_MUTEX_INITIALIZER
;

790 
LIST_HEAD
(
ucm_ˇrds
);

791 
	gucm_ˇrd_assign
;

793 
¢d_u£_ˇ£_mgr_t
 *
	$uc_mgr_ˇrd_föd
(
ˇrd_numbî
)

795 
li°_hód
 *
pos
;

796 
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
;

798 
	`li°_f‹_óch
(
pos
, &
ucm_ˇrds
) {

799 
uc_mgr
 = 
	`li°_íåy
(
pos
, 
¢d_u£_ˇ£_mgr_t
, 
ˇrds_li°
);

800 i‡(
uc_mgr
->
ucm_ˇrd_numbî
 =
ˇrd_numbî
)

801  
uc_mgr
;

803  
NULL
;

804 
	}
}

806 
	$uc_mgr_ˇrd_›í
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

808 
¥ev
;

810 
	`±hªad_muãx_lock
(&
ucm_ˇrds_muãx
);

811 
¥ev
 = 
ucm_ˇrd_assign
++;

812 
	`uc_mgr_ˇrd_föd
(
ucm_ˇrd_assign
)) {

813 
ucm_ˇrd_assign
++;

814 
ucm_ˇrd_assign
 &= 0xffff;

816 i‡(
ucm_ˇrd_assign
 == 0)

817 
ucm_ˇrd_assign
++;

818 i‡(
ucm_ˇrd_assign
 =
¥ev
) {

819 
	`±hªad_muãx_u∆ock
(&
ucm_ˇrds_muãx
);

820  -
ENOMEM
;

823 
uc_mgr
->
ucm_ˇrd_numbî
 = 
ucm_ˇrd_assign
;

824 
	`li°_add
(&
uc_mgr
->
ˇrds_li°
, &
ucm_ˇrds
);

825 
	`±hªad_muãx_u∆ock
(&
ucm_ˇrds_muãx
);

827 
	}
}

829 
	$uc_mgr_ˇrd_˛o£
(
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
)

831 
	`±hªad_muãx_lock
(&
ucm_ˇrds_muãx
);

832 
	`li°_dñ
(&
uc_mgr
->
ˇrds_li°
);

833 
	`±hªad_muãx_u∆ock
(&
ucm_ˇrds_muãx
);

834 
	}
}

844 c⁄° *
	$uc_mgr_Æibcfg_by_devi˚
(
¢d_c⁄fig_t
 **
t›
, c⁄° *
«me
)

846 
buf
[5];

847 
ˇrd_num
;

848 
¢d_c⁄fig_t
 *
c⁄fig
;

849 
¢d_u£_ˇ£_mgr_t
 *
uc_mgr
;

850 
îr
;

852 i‡(
	`°∫cmp
(
«me
, "_ucm", 4Ë|| 
	`°æí
(name) < 12 ||Çame[8] != '.')

853  
NULL
;

854 
	`°∫˝y
(
buf
, 
«me
 + 4, 4);

855 
buf
[4] = '\0';

856 
îr
 = 
	`ß„_°πﬁ_ba£
(
buf
, &
ˇrd_num
, 16);

857 i‡(
îr
 < 0 || 
ˇrd_num
 < 0 || card_num > 0xffff)

858  
NULL
;

859 
c⁄fig
 = 
NULL
;

860 
	`±hªad_muãx_lock
(&
ucm_ˇrds_muãx
);

861 
uc_mgr
 = 
	`uc_mgr_ˇrd_föd
(
ˇrd_num
);

863 i‡(
	`uc_mgr_has_loˇl_c⁄fig
(
uc_mgr
)) {

864 
c⁄fig
 = 
uc_mgr
->
loˇl_c⁄fig
;

865 
	`¢d_c⁄fig_ªf
(
c⁄fig
);

867 
	`±hªad_muãx_u∆ock
(&
ucm_ˇrds_muãx
);

868 i‡(!
c⁄fig
)

869  
NULL
;

870 *
t›
 = 
c⁄fig
;

871  
«me
 + 9;

872 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/userfile.c

21 
	~"c⁄fig.h
"

22 
	~<°rög.h
>

23 
	~<î∫o.h
>

24 
	~<as£π.h
>

36 #ifde‡
HAVE_WORDEXP


37 
	~<w‹dexp.h
>

38 
	$¢d_u£r_fûe
(c⁄° *
fûe
, **
ªsu…
)

40 
w‹dexp_t
 
we
;

41 
îr
;

43 
	`as£π
(
fûe
 && 
ªsu…
);

44 
îr
 = 
	`w‹dexp
(
fûe
, &
we
, 
WRDE_NOCMD
);

45 
îr
) {

46 
WRDE_NOSPACE
:

47 
	`w‹d‰ì
(&
we
);

48  -
ENOMEM
;

50 i‡(
we
.
we_w‹dc
 == 1)

52 
	`w‹d‰ì
(&
we
);

55  -
EINVAL
;

57 *
ªsu…
 = 
	`°rdup
(
we
.
we_w‹dv
[0]);

58 
	`w‹d‰ì
(&
we
);

59 i‡(*
ªsu…
 =
NULL
)

60  -
ENOMEM
;

62 
	}
}

66 
	~<sys/ty≥s.h
>

67 
	~<uni°d.h
>

68 
	~<pwd.h
>

69 
	~<°dio.h
>

70 
	~<°dlib.h
>

72 
	$¢d_u£r_fûe
(c⁄° *
fûe
, **
ªsu…
)

74 
îr
;

75 
size_t
 
Àn
;

76 *
buf
 = 
NULL
;

78 
	`as£π
(
fûe
 && 
ªsu…
);

79 *
ªsu…
 = 
NULL
;

82 i‡(
fûe
[0] == '~' && file[1] == '/') {

83 c⁄° *
home
 = 
	`gëív
("HOME");

84 i‡(
home
 =
NULL
) {

85 
∑sswd
 
pwít
, *
p
 = 
NULL
;

86 
uid_t
 
id
 = 
	`gëuid
();

87 
size_t
 
bufsize
 = 1024;

89 
buf
 = 
	`mÆloc
(
bufsize
);

90 i‡(
buf
 =
NULL
)

91 
out
;

93 (
îr
 = 
	`gëpwuid_r
(
id
, &
pwít
, 
buf
, 
bufsize
, &
p
)Ë=
ERANGE
) {

94 *
√wbuf
;

95 
bufsize
 += 1024;

96 i‡(
bufsize
 < 1024)

98 
√wbuf
 = 
	`ªÆloc
(
buf
, 
bufsize
);

99 i‡(
√wbuf
 =
NULL
)

100 
out
;

101 
buf
 = 
√wbuf
;

103 
home
 = 
îr
 ? "" : 
pwít
.
pw_dú
;

105 
Àn
 = 
	`°æí
(
home
Ë+ såÀn(&
fûe
[2]) + 2;

106 *
ªsu…
 = 
	`mÆloc
(
Àn
);

107 i‡(*
ªsu…
)

108 
	`¢¥ötf
(*
ªsu…
, 
Àn
, "%s/%s", 
home
, &
fûe
[2]);

110 *
ªsu…
 = 
	`°rdup
(
fûe
);

113 
out
:

114 i‡(
buf
)

115 
	`‰ì
(
buf
);

117 i‡(*
ªsu…
 =
NULL
)

118  -
ENOMEM
;

120 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/audio_time.c

7 
	~"c⁄fig.h
"

8 
	~<°dio.h
>

9 #i‡
HAVE_MALLOC_H


10 
	~<mÆloc.h
>

12 
	~<uni°d.h
>

13 
	~<°dlib.h
>

14 
	~<°rög.h
>

15 
	~<gë›t.h
>

16 
	~<f˙é.h
>

17 
	~<˘y≥.h
>

18 
	~<î∫o.h
>

19 
	~<limôs.h
>

20 
	~<time.h
>

21 
	~<loˇÀ.h
>

22 
	~<m©h.h
>

23 
	~"../ö˛ude/asoundlib.h
"

25 *
	gpcm_«me
 = "hw:0";

26 
¢d_ouçut_t
 *
	gouçut
 = 
NULL
;

28 
	$ußge
(*
comm™d
)

30 
	`¥ötf
("Usage: %s [OPTION]... \n"

39 , 
comm™d
);

40 
	}
}

43 
	$time°amp2ns
(
¢d_htime°amp_t
 
t
)

45 
n£c
;

47 
n£c
 = 
t
.
tv_£c
 * 1000000000ULL;

48 
n£c
 +
t
.
tv_n£c
;

50  
n£c
;

51 
	}
}

53 
	$timediff
(
¢d_htime°amp_t
 
t1
, snd_htime°amp_à
t2
)

55 
n£c1
, 
n£c2
;

57 
n£c1
 = 
	`time°amp2ns
(
t1
);

58 
n£c2
 = 
	`time°amp2ns
(
t2
);

60  
n£c1
 - 
n£c2
;

61 
	}
}

63 
	$_gëtime°amp
(
¢d_pcm_t
 *
h™dÀ
, 
¢d_htime°amp_t
 *
time°amp
,

64 
¢d_htime°amp_t
 *
åiggî_time°amp
,

65 
¢d_htime°amp_t
 *
audio_time°amp
,

66 
¢d_pcm_audio_t°amp_c⁄fig_t
 *
audio_t°amp_c⁄fig
,

67 
¢d_pcm_audio_t°amp_ªp‹t_t
 *
audio_t°amp_ªp‹t
,

68 
¢d_pcm_u‰ames_t
 *
avaû
, 
¢d_pcm_s‰ames_t
 *
dñay
)

70 
îr
;

71 
¢d_pcm_°©us_t
 *
°©us
;

73 
	`¢d_pcm_°©us_Æloˇ
(&
°©us
);

75 
	`¢d_pcm_°©us_£t_audio_ht°amp_c⁄fig
(
°©us
, 
audio_t°amp_c⁄fig
);

77 i‡((
îr
 = 
	`¢d_pcm_°©us
(
h™dÀ
, 
°©us
)) < 0) {

78 
	`¥ötf
("Såóm sètu†îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

79 
	`exô
(0);

81 
	`¢d_pcm_°©us_gë_åiggî_ht°amp
(
°©us
, 
åiggî_time°amp
);

82 
	`¢d_pcm_°©us_gë_ht°amp
(
°©us
, 
time°amp
);

83 
	`¢d_pcm_°©us_gë_audio_ht°amp
(
°©us
, 
audio_time°amp
);

84 
	`¢d_pcm_°©us_gë_audio_ht°amp_ªp‹t
(
°©us
, 
audio_t°amp_ªp‹t
);

85 *
avaû
 = 
	`¢d_pcm_°©us_gë_avaû
(
°©us
);

86 *
dñay
 = 
	`¢d_pcm_°©us_gë_dñay
(
°©us
);

87 
	}
}

89 
	#TIMESTAMP_FREQ
 8

	)

90 
	#SAMPLE_FREQ
 48000

	)

91 
	#PERIOD
 (
SAMPLE_FREQ
/
TIMESTAMP_FREQ
)

	)

92 
	#PCM_LINK


	)

93 
	#TRACK_CAPTURE


	)

94 
	#TRACK_PLAYBACK


	)

96 
	#PLAYBACK_BUFFERS
 4

	)

97 
	#TSTAMP_TYPE
 
SND_PCM_TSTAMP_TYPE_MONOTONIC_RAW


	)

100 
	$maö
(
¨gc
, *
¨gv
[])

102 
c
;

103 
îr
;

104 
i
;

105 
¢d_pcm_t
 *
h™dÀ_p
 = 
NULL
;

106 
¢d_pcm_t
 *
h™dÀ_c
 = 
NULL
;

107 
¢d_pcm_s‰ames_t
 
‰ames
;

108 
¢d_htime°amp_t
 
t°amp_c
, 
t°amp_p
;

109 
¢d_htime°amp_t
 
åiggî_t°amp_c
, 
åiggî_t°amp_p
;

110 
¢d_htime°amp_t
 
audio_t°amp_c
, 
audio_t°amp_p
;

111 
buf„r_p
[
PERIOD
*4*4];

112 
buf„r_c
[
PERIOD
*4*4];

114 
¢d_pcm_hw_∑øms_t
 *
hw∑øms_p
;

115 
¢d_pcm_hw_∑øms_t
 *
hw∑øms_c
;

117 
¢d_pcm_sw_∑øms_t
 *
sw∑øms_p
;

118 
¢d_pcm_sw_∑øms_t
 *
sw∑øms_c
;

120 
¢d_pcm_u‰ames_t
 
‰ame_cou¡_c
 = 0;

121 
¢d_pcm_u‰ames_t
 
‰ame_cou¡_p
 = 0;

123 
¢d_pcm_s‰ames_t
 
dñay_p
, 
dñay_c
;

124 
¢d_pcm_u‰ames_t
 
avaû_p
, 
avaû_c
;

126 
¢d_pcm_audio_t°amp_c⁄fig_t
 
audio_t°amp_c⁄fig_p
;

127 
¢d_pcm_audio_t°amp_c⁄fig_t
 
audio_t°amp_c⁄fig_c
;

128 
¢d_pcm_audio_t°amp_ªp‹t_t
 
audio_t°amp_ªp‹t_p
;

129 
¢d_pcm_audio_t°amp_ªp‹t_t
 
audio_t°amp_ªp‹t_c
;

131 
›ti⁄_ödex
;

132 c⁄° 
sh‹t_›ti⁄s
[] = "hcpdrD:t:";

134 c⁄° 
›ti⁄
 
l⁄g_›ti⁄s
[] = {

137 {"devi˚", 
ªquúed_¨gumít
, 0, 'D'},

138 {"hñp", 
no_¨gumít
, 0, 'h'},

140 {"ts_ty≥", 
ªquúed_¨gumít
, 0, 't'},

145 
do_dñay
 = 0;

146 
do_∂ayback
 = 0;

147 
do_ˇ±uª
 = 0;

148 
ty≥
 = 0;

149 
do_ªp‹t
 = 0;

151 (
c
 = 
	`gë›t_l⁄g
(
¨gc
, 
¨gv
, 
sh‹t_›ti⁄s
, 
l⁄g_›ti⁄s
, &
›ti⁄_ödex
)) != -1) {

152 
c
) {

154 
	`ußge
(
¨gv
[0]);

157 
do_∂ayback
 = 1;

160 
do_ˇ±uª
 = 1;

163 
do_dñay
 = 1;

166 
pcm_«me
 = 
›èrg
;

169 
ty≥
 = 
	`©oi
(
›èrg
);

172 
do_ªp‹t
 = 1;

176 
	`mem£t
(&
audio_t°amp_c⁄fig_p
, 0, (
¢d_pcm_audio_t°amp_c⁄fig_t
));

177 
	`mem£t
(&
audio_t°amp_c⁄fig_c
, 0, (
¢d_pcm_audio_t°amp_c⁄fig_t
));

178 
	`mem£t
(&
audio_t°amp_ªp‹t_p
, 0, (
¢d_pcm_audio_t°amp_ªp‹t_t
));

179 
	`mem£t
(&
audio_t°amp_ªp‹t_c
, 0, (
¢d_pcm_audio_t°amp_ªp‹t_t
));

181 i‡(
do_∂ayback
) {

182 i‡((
îr
 = 
	`¢d_pcm_›í
(&
h™dÀ_p
, 
pcm_«me
, 
SND_PCM_STREAM_PLAYBACK
, 0)) < 0) {

183 
	`¥ötf
("Pœyback o≥¿îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

184 
_exô
;

187 i‡((
îr
 = 
	`¢d_pcm_£t_∑øms
(
h™dÀ_p
,

188 
SND_PCM_FORMAT_S16
,

189 
SND_PCM_ACCESS_RW_INTERLEAVED
,

191 
SAMPLE_FREQ
,

193 4*1000000/
TIMESTAMP_FREQ
)) < 0) {

194 
	`¥ötf
("Pœyback o≥¿îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

195 
_exô
;

198 
	`¢d_pcm_hw_∑øms_Æloˇ
(&
hw∑øms_p
);

200 
îr
 = 
	`¢d_pcm_hw_∑øms_cuºít
(
h™dÀ_p
, 
hw∑øms_p
);

201 i‡(
îr
 < 0) {

202 
	`¥ötf
("U«bÀÅÿdëîmöêcuºíàhw∑øms_p: %s\n", 
	`¢d_°ªº‹
(
îr
));

203 
_exô
;

206 i‡(
	`¢d_pcm_hw_∑øms_suµ‹ts_audio_ts_ty≥
(
hw∑øms_p
, 
SND_PCM_AUDIO_TSTAMP_TYPE_COMPAT
))

207 
	`¥ötf
("Playback supportsáudio compatÅimestamps\n");

208 i‡(
	`¢d_pcm_hw_∑øms_suµ‹ts_audio_ts_ty≥
(
hw∑øms_p
, 
SND_PCM_AUDIO_TSTAMP_TYPE_DEFAULT
))

209 
	`¥ötf
("Playback supportsáudio defaultÅimestamps\n");

210 i‡(
	`¢d_pcm_hw_∑øms_suµ‹ts_audio_ts_ty≥
(
hw∑øms_p
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK
))

211 
	`¥ötf
("Playback supportsáudioÜinkÅimestamps\n");

212 i‡(
	`¢d_pcm_hw_∑øms_suµ‹ts_audio_ts_ty≥
(
hw∑øms_p
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_ABSOLUTE
))

213 
	`¥ötf
("Playback supportsáudioÜinkábsoluteÅimestamps\n");

214 i‡(
	`¢d_pcm_hw_∑øms_suµ‹ts_audio_ts_ty≥
(
hw∑øms_p
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_ESTIMATED
))

215 
	`¥ötf
("Playback supportsáudioÜinkÉstimatedÅimestamps\n");

216 i‡(
	`¢d_pcm_hw_∑øms_suµ‹ts_audio_ts_ty≥
(
hw∑øms_p
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_SYNCHRONIZED
))

217 
	`¥ötf
("Playback supportsáudioÜink synchronizedÅimestamps\n");

219 
	`¢d_pcm_sw_∑øms_Æloˇ
(&
sw∑øms_p
);

221 
îr
 = 
	`¢d_pcm_sw_∑øms_cuºít
(
h™dÀ_p
, 
sw∑øms_p
);

222 i‡(
îr
 < 0) {

223 
	`¥ötf
("U«bÀÅÿdëîmöêcuºíàsw∑øms_p: %s\n", 
	`¢d_°ªº‹
(
îr
));

224 
_exô
;

228 
îr
 = 
	`¢d_pcm_sw_∑øms_£t_t°amp_mode
(
h™dÀ_p
, 
sw∑øms_p
, 
SND_PCM_TSTAMP_ENABLE
);

229 i‡(
îr
 < 0) {

230 
	`¥ötf
("U«bÀÅÿ£àt°am∞modê: %s\n", 
	`¢d_°ªº‹
(
îr
));

231 
_exô
;

234 
îr
 = 
	`¢d_pcm_sw_∑øms_£t_t°amp_ty≥
(
h™dÀ_p
, 
sw∑øms_p
, 
TSTAMP_TYPE
);

235 i‡(
îr
 < 0) {

236 
	`¥ötf
("U«bÀÅÿ£àt°am∞ty≥ : %s\n", 
	`¢d_°ªº‹
(
îr
));

237 
_exô
;

241 
îr
 = 
	`¢d_pcm_sw_∑øms
(
h™dÀ_p
, 
sw∑øms_p
);

242 i‡(
îr
 < 0) {

243 
	`¥ötf
("U«bÀÅÿ£àsw∑øms_∞: %s\n", 
	`¢d_°ªº‹
(
îr
));

244 
_exô
;

249 i‡(
do_ˇ±uª
) {

251 i‡((
îr
 = 
	`¢d_pcm_›í
(&
h™dÀ_c
, 
pcm_«me
, 
SND_PCM_STREAM_CAPTURE
, 
SND_PCM_NONBLOCK
)) < 0) {

252 
	`¥ötf
("C≠tuª o≥¿îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

253 
_exô
;

255 i‡((
îr
 = 
	`¢d_pcm_£t_∑øms
(
h™dÀ_c
,

256 
SND_PCM_FORMAT_S16
,

257 
SND_PCM_ACCESS_RW_INTERLEAVED
,

259 
SAMPLE_FREQ
,

261 4*1000000/
TIMESTAMP_FREQ
)) < 0) {

262 
	`¥ötf
("C≠tuª o≥¿îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

263 
_exô
;

266 
	`¢d_pcm_hw_∑øms_Æloˇ
(&
hw∑øms_c
);

268 
îr
 = 
	`¢d_pcm_hw_∑øms_cuºít
(
h™dÀ_c
, 
hw∑øms_c
);

269 i‡(
îr
 < 0) {

270 
	`¥ötf
("U«bÀÅÿdëîmöêcuºíàhw∑øms_c: %s\n", 
	`¢d_°ªº‹
(
îr
));

271 
_exô
;

274 i‡(
	`¢d_pcm_hw_∑øms_suµ‹ts_audio_ts_ty≥
(
hw∑øms_c
, 
SND_PCM_AUDIO_TSTAMP_TYPE_COMPAT
))

275 
	`¥ötf
("Capture supportsáudio compatÅimestamps\n");

276 i‡(
	`¢d_pcm_hw_∑øms_suµ‹ts_audio_ts_ty≥
(
hw∑øms_c
, 
SND_PCM_AUDIO_TSTAMP_TYPE_DEFAULT
))

277 
	`¥ötf
("Capture supportsáudio defaultÅimestamps\n");

278 i‡(
	`¢d_pcm_hw_∑øms_suµ‹ts_audio_ts_ty≥
(
hw∑øms_c
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK
))

279 
	`¥ötf
("Capture supportsáudioÜinkÅimestamps\n");

280 i‡(
	`¢d_pcm_hw_∑øms_suµ‹ts_audio_ts_ty≥
(
hw∑øms_c
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_ABSOLUTE
))

281 
	`¥ötf
("Capture supportsáudioÜinkábsoluteÅimestamps\n");

282 i‡(
	`¢d_pcm_hw_∑øms_suµ‹ts_audio_ts_ty≥
(
hw∑øms_c
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_ESTIMATED
))

283 
	`¥ötf
("Capture supportsáudioÜinkÉstimatedÅimestamps\n");

284 i‡(
	`¢d_pcm_hw_∑øms_suµ‹ts_audio_ts_ty≥
(
hw∑øms_c
, 
SND_PCM_AUDIO_TSTAMP_TYPE_LINK_SYNCHRONIZED
))

285 
	`¥ötf
("Capture supportsáudioÜink synchronizedÅimestamps\n");

287 
	`¢d_pcm_sw_∑øms_Æloˇ
(&
sw∑øms_c
);

289 
îr
 = 
	`¢d_pcm_sw_∑øms_cuºít
(
h™dÀ_c
, 
sw∑øms_c
);

290 i‡(
îr
 < 0) {

291 
	`¥ötf
("U«bÀÅÿdëîmöêcuºíàsw∑øms_c: %s\n", 
	`¢d_°ªº‹
(
îr
));

292 
_exô
;

296 
îr
 = 
	`¢d_pcm_sw_∑øms_£t_t°amp_mode
(
h™dÀ_c
, 
sw∑øms_c
, 
SND_PCM_TSTAMP_ENABLE
);

297 i‡(
îr
 < 0) {

298 
	`¥ötf
("U«bÀÅÿ£àt°am∞modê: %s\n", 
	`¢d_°ªº‹
(
îr
));

299 
_exô
;

302 
îr
 = 
	`¢d_pcm_sw_∑øms_£t_t°amp_ty≥
(
h™dÀ_c
, 
sw∑øms_c
, 
TSTAMP_TYPE
);

303 i‡(
îr
 < 0) {

304 
	`¥ötf
("U«bÀÅÿ£àt°am∞ty≥ : %s\n", 
	`¢d_°ªº‹
(
îr
));

305 
_exô
;

309 
îr
 = 
	`¢d_pcm_sw_∑øms
(
h™dÀ_c
, 
sw∑øms_c
);

310 i‡(
îr
 < 0) {

311 
	`¥ötf
("U«bÀÅÿ£àsw∑øms_¯: %s\n", 
	`¢d_°ªº‹
(
îr
));

312 
_exô
;

316 i‡(
do_∂ayback
 && 
do_ˇ±uª
) {

317 #ifde‡
PCM_LINK


318 i‡((
îr
 = 
	`¢d_pcm_lök
(
h™dÀ_c
, 
h™dÀ_p
)) < 0) {

319 
	`¥ötf
("Såóm†lökÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

320 
	`exô
(0);

325 i‡(
do_∂ayback
) {

326 
i
 = 
PLAYBACK_BUFFERS
;

327 
i
--) {

328 
‰ames
 = 
	`¢d_pcm_wrôei
(
h™dÀ_p
, 
buf„r_p
, 
PERIOD
);

329 i‡(
‰ames
 < 0) {

330 
	`¥ötf
("¢d_pcm_wrôeòÁûed: %s\n", 
	`¢d_°ªº‹
(
‰ames
));

331 
_exô
;

333 
‰ame_cou¡_p
 +
‰ames
;

336 i‡(
PLAYBACK_BUFFERS
 != 4)

337 
	`¢d_pcm_°¨t
(
h™dÀ_p
);

340 i‡(
do_ˇ±uª
) {

341 #i‚de‡
PCM_LINK


343 
	`¢d_pcm_°¨t
(
h™dÀ_c
);

345 i‡(!
do_∂ayback
)

347 
	`¢d_pcm_°¨t
(
h™dÀ_c
);

353 i‡(
do_ˇ±uª
) {

355 
‰ames
 = 
	`¢d_pcm_waô
(
h™dÀ_c
, -1);

356 i‡(
‰ames
 < 0) {

357 
	`¥ötf
("¢d_pcm_waô faûed: %s\n", 
	`¢d_°ªº‹
(
‰ames
));

358 
_exô
;

361 
‰ames
 = 
	`¢d_pcm_ªadi
(
h™dÀ_c
, 
buf„r_c
, 
PERIOD
);

362 i‡(
‰ames
 < 0) {

363 
	`¥ötf
("¢d_pcm_ªadòÁûed: %s\n", 
	`¢d_°ªº‹
(
‰ames
));

364 
_exô
;

366 
‰ame_cou¡_c
 +
‰ames
;

368 #i‡
	`deföed
(
TRACK_CAPTURE
)

369 
audio_t°amp_c⁄fig_c
.
ty≥_ªque°ed
 = 
ty≥
;

370 
audio_t°amp_c⁄fig_c
.
ªp‹t_dñay
 = 
do_dñay
;

371 
	`_gëtime°amp
(
h™dÀ_c
, &
t°amp_c
, &
åiggî_t°amp_c
,

372 &
audio_t°amp_c
, &
audio_t°amp_c⁄fig_c
, &
audio_t°amp_ªp‹t_c
,

373 &
avaû_c
, &
dñay_c
);

374 #i‡
	`deföed
(
TRACK_SAMPLE_COUNTS
)

375 
cuº_cou¡_c
 = 
‰ame_cou¡_c
 + 
dñay_c
;

378 
	`¥ötf
("capture: curr_count %lli driver count %lli, delta %lli\n",

379 ()
cuº_cou¡_c
 * 1000000000LL / 
SAMPLE_FREQ
 ,

380 
	`time°amp2ns
(
audio_t°amp_c
),

381 ()
cuº_cou¡_c
 * 1000000000LL / 
SAMPLE_FREQ
 - 
	`time°amp2ns
(
audio_t°amp_c
)

384 i‡(
do_ªp‹t
) {

385 i‡(
audio_t°amp_ªp‹t_c
.
vÆid
 == 0)

386 
	`¥ötf
("Audio captureÅimestampÑeport invalid - ");

387 i‡(
audio_t°amp_ªp‹t_c
.
accuøcy_ªp‹t
 == 0)

388 
	`¥ötf
("Audio captureÅimestampáccuracyÑeport invalid");

389 
	`¥ötf
("\n");

393 
	`¥ötf
("\t capture: systime: %lliÇsec,áudioÅime %lliÇsec, \tsystime delta %lli \tÑesolution %dÇs \n",

394 
	`timediff
(
t°amp_c
, 
åiggî_t°amp_c
),

395 
	`time°amp2ns
(
audio_t°amp_c
),

396 
	`timediff
(
t°amp_c
, 
åiggî_t°amp_c
Ë- 
	`time°amp2ns
(
audio_t°amp_c
), 
audio_t°amp_ªp‹t_c
.
accuøcy


401 i‡(
do_∂ayback
) {

402 
‰ames
 = 
	`¢d_pcm_wrôei
(
h™dÀ_p
, 
buf„r_p
, 
PERIOD
);

403 i‡(
‰ames
 < 0) {

404 
	`¥ötf
("¢d_pcm_wrôeòÁûed: %s\n", 
	`¢d_°ªº‹
(
‰ames
));

405 
_exô
;

408 
‰ame_cou¡_p
 +
‰ames
;

410 #i‡
	`deföed
(
TRACK_PLAYBACK
)

412 
audio_t°amp_c⁄fig_p
.
ty≥_ªque°ed
 = 
ty≥
;

413 
audio_t°amp_c⁄fig_p
.
ªp‹t_dñay
 = 
do_dñay
;

414 
	`_gëtime°amp
(
h™dÀ_p
, &
t°amp_p
, &
åiggî_t°amp_p
,

415 &
audio_t°amp_p
, &
audio_t°amp_c⁄fig_p
, &
audio_t°amp_ªp‹t_p
,

416 &
avaû_p
, &
dñay_p
);

418 #i‡
	`deföed
(
TRACK_SAMPLE_COUNTS
)

419 
cuº_cou¡_p
 = 
‰ame_cou¡_p
 - 
dñay_p
;

421 
	`¥ötf
("playback: curr_count %lli driver count %lli, delta %lli\n",

422 ()
cuº_cou¡_p
 * 1000000000LL / 
SAMPLE_FREQ
 ,

423 
	`time°amp2ns
(
audio_t°amp_p
),

424 ()
cuº_cou¡_p
 * 1000000000LL / 
SAMPLE_FREQ
 - 
	`time°amp2ns
(
audio_t°amp_p
)

427 i‡(
do_ªp‹t
) {

428 i‡(
audio_t°amp_ªp‹t_p
.
vÆid
 == 0)

429 
	`¥ötf
("AudioÖlaybackÅimestampÑeport invalid - ");

430 i‡(
audio_t°amp_ªp‹t_p
.
accuøcy_ªp‹t
 == 0)

431 
	`¥ötf
("AudioÖlaybackÅimestampáccuracyÑeport invalid");

432 
	`¥ötf
("\n");

435 
	`¥ötf
("playback: systime: %lliÇsec,áudioÅime %lliÇsec, \tsystime delta %lliÑesolution %dÇs\n",

436 
	`timediff
(
t°amp_p
, 
åiggî_t°amp_p
),

437 
	`time°amp2ns
(
audio_t°amp_p
),

438 
	`timediff
(
t°amp_p
, 
åiggî_t°amp_p
Ë- 
	`time°amp2ns
(
audio_t°amp_p
), 
audio_t°amp_ªp‹t_p
.
accuøcy


446 
_exô
:

447 i‡(
h™dÀ_p
)

448 
	`¢d_pcm_˛o£
(
h™dÀ_p
);

449 i‡(
h™dÀ_c
)

450 
	`¢d_pcm_˛o£
(
h™dÀ_c
);

453 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/chmap.c

5 
	~"c⁄fig.h
"

6 
	~<°dio.h
>

7 
	~<°dlib.h
>

8 
	~<°rög.h
>

9 
	~<˘y≥.h
>

10 
	~<gë›t.h
>

11 
	~"../ö˛ude/asoundlib.h
"

13 
	$ußge
()

15 
	`¥ötf
("usage: chmap [options] query\n"

24 
	}
}

26 
	$¥öt_ch™√ls
(c⁄° 
¢d_pcm_chm≠_t
 *
m≠
)

28 
tmp
[128];

29 i‡(
	`¢d_pcm_chm≠_¥öt
(
m≠
, (
tmp
),Åmp) > 0)

30 
	`¥ötf
(" %s\n", 
tmp
);

31 
	}
}

33 
	$quîy_chm≠s
(
¢d_pcm_t
 *
pcm
)

35 
¢d_pcm_chm≠_quîy_t
 **
m≠s
 = 
	`¢d_pcm_quîy_chm≠s
(
pcm
);

36 
¢d_pcm_chm≠_quîy_t
 **
p
, *
v
;

38 i‡(!
m≠s
) {

39 
	`¥ötf
("Cannot query maps\n");

42 
p
 = 
m≠s
; (
v
 = *pË!
NULL
;Ö++) {

43 
	`¥ötf
("Type = %s, Channels = %d\n",

44 
	`¢d_pcm_chm≠_ty≥_«me
(
v
->
ty≥
),

45 
v
->
m≠
.
ch™√ls
);

46 
	`¥öt_ch™√ls
(&
v
->
m≠
);

48 
	`¢d_pcm_‰ì_chm≠s
(
m≠s
);

50 
	}
}

52 
	$£tup_pcm
(
¢d_pcm_t
 *
pcm
, 
f‹m©
, 
ch™√ls
, 
øã
)

54 
¢d_pcm_hw_∑øms_t
 *
∑øms
;

56 
	`¢d_pcm_hw_∑øms_Æloˇ
(&
∑øms
);

57 i‡(
	`¢d_pcm_hw_∑øms_™y
(
pcm
, 
∑øms
) < 0) {

58 
	`¥ötf
("Cannot init hw_params\n");

61 i‡(
f‹m©
 !
SND_PCM_FORMAT_UNKNOWN
) {

62 i‡(
	`¢d_pcm_hw_∑øms_£t_f‹m©
(
pcm
, 
∑øms
, 
f‹m©
) < 0) {

63 
	`¥ötf
("Cannot set format %s\n",

64 
	`¢d_pcm_f‹m©_«me
(
f‹m©
));

68 i‡(
ch™√ls
 > 0) {

69 i‡(
	`¢d_pcm_hw_∑øms_£t_ch™√ls
(
pcm
, 
∑øms
, 
ch™√ls
) < 0) {

70 
	`¥ötf
("C™nŸ së ch™√l†%d\n", 
ch™√ls
);

74 i‡(
øã
 > 0) {

75 i‡(
	`¢d_pcm_hw_∑øms_£t_øã_√¨
(
pcm
, 
∑øms
, (*)&
øã
, 0) < 0) {

76 
	`¥ötf
("C™nŸ sëÑ©ê%d\n", 
øã
);

80 i‡(
	`¢d_pcm_hw_∑øms
(
pcm
, 
∑øms
) < 0) {

81 
	`¥ötf
("Cannot set hw_params\n");

85 
	}
}

87 
	$gë_chm≠
(
¢d_pcm_t
 *
pcm
, 
f‹m©
, 
ch™√ls
, 
øã
)

89 
¢d_pcm_chm≠_t
 *
m≠
;

91 i‡(
	`£tup_pcm
(
pcm
, 
f‹m©
, 
ch™√ls
, 
øã
))

93 
m≠
 = 
	`¢d_pcm_gë_chm≠
(
pcm
);

94 i‡(!
m≠
) {

95 
	`¥ötf
("Cannot get chmap\n");

98 
	`¥ötf
("Ch™√l†%d\n", 
m≠
->
ch™√ls
);

99 
	`¥öt_ch™√ls
(
m≠
);

100 
	`‰ì
(
m≠
);

102 
	}
}

104 
	$£t_chm≠
(
¢d_pcm_t
 *
pcm
, 
f‹m©
, 
ch™√ls
, 
øã
,

105 
«rgs
, **
¨g
)

107 
i
;

108 
¢d_pcm_chm≠_t
 *
m≠
;

110 i‡(
ch™√ls
 && ch™√l†!
«rgs
) {

111 
	`¥ötf
("Inc⁄si°íàch™√l†%d v†%d\n", 
ch™√ls
, 
«rgs
);

114 i‡(!
ch™√ls
) {

115 i‡(!
«rgs
) {

116 
	`¥ötf
("No channelsáre given\n");

119 
ch™√ls
 = 
«rgs
;

121 i‡(
	`£tup_pcm
(
pcm
, 
f‹m©
, 
ch™√ls
, 
øã
))

123 
m≠
 = 
	`mÆloc
((Ë* (
ch™√ls
 + 1));

124 i‡(!
m≠
) {

125 
	`¥ötf
("cannot malloc\n");

128 
m≠
->
ch™√ls
 = channels;

129 
i
 = 0; i < 
ch™√ls
; i++) {

130 
vÆ
 = 
	`¢d_pcm_chm≠_‰om_°rög
(
¨g
[
i
]);

131 i‡(
vÆ
 < 0)

132 
vÆ
 = 
SND_CHMAP_UNKNOWN
;

133 
m≠
->
pos
[
i
] = 
vÆ
;

135 i‡(
	`¢d_pcm_£t_chm≠
(
pcm
, 
m≠
) < 0) {

136 
	`¥ötf
("Cannot set chmap\n");

139 
	`‰ì
(
m≠
);

141 
m≠
 = 
	`¢d_pcm_gë_chm≠
(
pcm
);

142 i‡(!
m≠
) {

143 
	`¥ötf
("Cannot get chmap\n");

146 
	`¥ötf
("Gë ch™√l†%d\n", 
m≠
->
ch™√ls
);

147 
	`¥öt_ch™√ls
(
m≠
);

148 
	`‰ì
(
m≠
);

150 
	}
}

152 
	$maö
(
¨gc
, **
¨gv
)

154 *
devi˚
 = 
NULL
;

155 
°ªam
 = 
SND_PCM_STREAM_PLAYBACK
;

156 
f‹m©
 = 
SND_PCM_FORMAT_UNKNOWN
;

157 
ch™√ls
 = 0;

158 
øã
 = 0;

159 
¢d_pcm_t
 *
pcm
;

160 
c
;

162 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "D:s:f:c:r:")) != -1) {

163 
c
) {

165 
devi˚
 = 
›èrg
;

168 i‡(*
›èrg
 == 'c' || *optarg == 'C')

169 
°ªam
 = 
SND_PCM_STREAM_CAPTURE
;

171 
°ªam
 = 
SND_PCM_STREAM_PLAYBACK
;

174 
f‹m©
 = 
	`¢d_pcm_f‹m©_vÆue
(
›èrg
);

177 
ch™√ls
 = 
	`©oi
(
›èrg
);

180 
øã
 = 
	`©oi
(
›èrg
);

183 
	`ußge
();

188 i‡(
¨gc
 <
›töd
) {

189 
	`ußge
();

193 i‡(!
devi˚
) {

194 
	`¥ötf
("No device is specified\n");

198 i‡(
	`¢d_pcm_›í
(&
pcm
, 
devi˚
, 
°ªam
, 
SND_PCM_NONBLOCK
) < 0) {

199 
	`¥ötf
("C™nŸ o≥¿PCM såóm %†f‹ %s\n", 
devi˚
,

200 
	`¢d_pcm_°ªam_«me
(
°ªam
));

204 *
¨gv
[
›töd
]) {

206  
	`quîy_chm≠s
(
pcm
);

208  
	`gë_chm≠
(
pcm
, 
f‹m©
, 
ch™√ls
, 
øã
);

210  
	`£t_chm≠
(
pcm
, 
f‹m©
, 
ch™√ls
, 
øã
,

211 
¨gc
 - 
›töd
 - 1, 
¨gv
 + optind + 1);

213 
	`ußge
();

215 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/client_event_filter.c

1 
	~<Æß/asoundlib.h
>

3 
	$dump_evít_fûãr
(
¢d_£q_˛õ¡_öfo_t
 *
˛õ¡_öfo
) {

4 
i
, 
b
;

6 
i
 = 0; i <= 255;) {

7 
b
 = 
	`¢d_£q_˛õ¡_öfo_evít_fûãr_check
(
˛õ¡_öfo
, 
i
);

8 
i
++;

9 
	`¥ötf
("%c%s%s", (
b
 ? 'X' : '.'),

10 (
i
 % 8 == 0 ? " " : ""),

11 (
i
 % 32 == 0 ? "\n" : ""));

13 
	`¥ötf
("\n");

14 
	}
}

16 
	$maö
() {

17 
¢d_£q_˛õ¡_öfo_t
 *
˛õ¡_öfo
;

19 
	`¢d_£q_˛õ¡_öfo_Æloˇ
(&
˛õ¡_öfo
);

21 
	`¥ötf
("first client_info_event_filter :\n");

22 
	`dump_evít_fûãr
(
˛õ¡_öfo
);

24 
	`¢d_£q_˛õ¡_öfo_evít_fûãr_add
(
˛õ¡_öfo
, 
SND_SEQ_EVENT_NOTEON
);

25 
	`¥ötf
("after snd_seq_client_info_event_filter_add(client_info, SND_SEQ_EVENT_NOTEON);\n");

26 
	`dump_evít_fûãr
(
˛õ¡_öfo
);

28 
	`¢d_£q_˛õ¡_öfo_evít_fûãr_add
(
˛õ¡_öfo
, 
SND_SEQ_EVENT_PGMCHANGE
);

29 
	`¥ötf
("after snd_seq_client_info_event_filter_add(client_info, SND_SEQ_EVENT_PGMCHANGE);\n");

30 
	`dump_evít_fûãr
(
˛õ¡_öfo
);

32 
	`¢d_£q_˛õ¡_öfo_evít_fûãr_dñ
(
˛õ¡_öfo
, 
SND_SEQ_EVENT_NOTEON
);

33 
	`¥ötf
("after snd_seq_client_info_event_filter_del(client_info, SND_SEQ_EVENT_NOTEON);\n");

34 
	`dump_evít_fûãr
(
˛õ¡_öfo
);

36 
	`¢d_£q_˛õ¡_öfo_evít_fûãr_˛ór
(
˛õ¡_öfo
);

37 
	`¥ötf
("after snd_seq_client_info_event_filter_clear(client_info);\n");

38 
	`dump_evít_fûãr
(
˛õ¡_öfo
);

40 
	`¢d_£q_˛õ¡_öfo_evít_fûãr_add
(
˛õ¡_öfo
, 
SND_SEQ_EVENT_NOTEON
);

41 
	`¥ötf
("after snd_seq_client_info_event_filter_add(client_info, SND_SEQ_EVENT_NOTEON);\n");

42 
	`dump_evít_fûãr
(
˛õ¡_öfo
);

45 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/control.c

1 
	~"c⁄fig.h
"

2 
	~<°dio.h
>

3 
	~<°rög.h
>

4 
	~"../ö˛ude/asoundlib.h
"

6 
	$maö
()

8 
idx
, 
dev
, 
îr
;

9 
¢d_˘l_t
 *
h™dÀ
;

10 
¢d_˘l_ˇrd_öfo_t
 *
öfo
;

11 
¢d_pcm_öfo_t
 *
pcmöfo
;

12 
¢d_øwmidi_öfo_t
 *
øwmidiöfo
;

13 
°r
[128];

15 
	`¢d_˘l_ˇrd_öfo_Æloˇ
(&
öfo
);

16 
	`¢d_pcm_öfo_Æloˇ
(&
pcmöfo
);

17 
	`¢d_øwmidi_öfo_Æloˇ
(&
øwmidiöfo
);

19 
idx
 = -1;

21 i‡((
îr
 = 
	`¢d_ˇrd_√xt
(&
idx
)) < 0) {

22 
	`¥ötf
("C¨dÇexàîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

25 i‡(
idx
 < 0)

27 
	`•rötf
(
°r
, "hw:CARD=%i", 
idx
);

28 i‡((
îr
 = 
	`¢d_˘l_›í
(&
h™dÀ
, 
°r
, 0)) < 0) {

29 
	`¥ötf
("O≥¿îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

32 i‡((
îr
 = 
	`¢d_˘l_ˇrd_öfo
(
h™dÀ
, 
öfo
)) < 0) {

33 
	`¥ötf
("HW infÿîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

36 
	`¥ötf
("Soundˇrd #%i:\n", 
idx
 + 1);

37 
	`¥ötf
(" c¨d - %i\n", 
	`¢d_˘l_ˇrd_öfo_gë_ˇrd
(
öfo
));

38 
	`¥ötf
(" id - '%s'\n", 
	`¢d_˘l_ˇrd_öfo_gë_id
(
öfo
));

39 
	`¥ötf
(" drivî - '%s'\n", 
	`¢d_˘l_ˇrd_öfo_gë_drivî
(
öfo
));

40 
	`¥ötf
("Çamê- '%s'\n", 
	`¢d_˘l_ˇrd_öfo_gë_«me
(
öfo
));

41 
	`¥ötf
("Ü⁄g«mê- '%s'\n", 
	`¢d_˘l_ˇrd_öfo_gë_l⁄g«me
(
öfo
));

42 
	`¥ötf
(" mixî«mê- '%s'\n", 
	`¢d_˘l_ˇrd_öfo_gë_mixî«me
(
öfo
));

43 
	`¥ötf
(" comp⁄ít†- '%s'\n", 
	`¢d_˘l_ˇrd_öfo_gë_comp⁄íts
(
öfo
));

44 
dev
 = -1;

46 
¢d_pcm_sync_id_t
 
sync
;

47 i‡((
îr
 = 
	`¢d_˘l_pcm_√xt_devi˚
(
h™dÀ
, &
dev
)) < 0) {

48 
	`¥ötf
(" PCMÇexàdevi˚Éº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

51 i‡(
dev
 < 0)

53 
	`¢d_pcm_öfo_£t_devi˚
(
pcmöfo
, 
dev
);

54 
	`¢d_pcm_öfo_£t_subdevi˚
(
pcmöfo
, 0);

55 
	`¢d_pcm_öfo_£t_°ªam
(
pcmöfo
, 
SND_PCM_STREAM_PLAYBACK
);

56 i‡((
îr
 = 
	`¢d_˘l_pcm_öfo
(
h™dÀ
, 
pcmöfo
)) < 0) {

57 
	`¥ötf
(" PCM infÿîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

60 
	`¥ötf
("PCM info, devi˚ #%i:\n", 
dev
);

61 
	`¥ötf
(" devi˚ - %i\n", 
	`¢d_pcm_öfo_gë_devi˚
(
pcmöfo
));

62 
	`¥ötf
(" subdevi˚ - %i\n", 
	`¢d_pcm_öfo_gë_subdevi˚
(
pcmöfo
));

63 
	`¥ötf
(" såóm - %i\n", 
	`¢d_pcm_öfo_gë_°ªam
(
pcmöfo
));

64 
	`¥ötf
(" c¨d - %i\n", 
	`¢d_pcm_öfo_gë_ˇrd
(
pcmöfo
));

65 
	`¥ötf
(" id - '%s'\n", 
	`¢d_pcm_öfo_gë_id
(
pcmöfo
));

66 
	`¥ötf
("Çamê- '%s'\n", 
	`¢d_pcm_öfo_gë_«me
(
pcmöfo
));

67 
	`¥ötf
(" subdevi˚Çamê- '%s'\n", 
	`¢d_pcm_öfo_gë_subdevi˚_«me
(
pcmöfo
));

68 
	`¥ötf
(" cœs†- 0x%x\n", 
	`¢d_pcm_öfo_gë_˛ass
(
pcmöfo
));

69 
	`¥ötf
(" sub˛as†- 0x%x\n", 
	`¢d_pcm_öfo_gë_sub˛ass
(
pcmöfo
));

70 
	`¥ötf
(" subdevi˚†cou¡ - %i\n", 
	`¢d_pcm_öfo_gë_subdevi˚s_cou¡
(
pcmöfo
));

71 
	`¥ötf
(" subdevi˚†avaû - %i\n", 
	`¢d_pcm_öfo_gë_subdevi˚s_avaû
(
pcmöfo
));

72 
sync
 = 
	`¢d_pcm_öfo_gë_sync
(
pcmöfo
);

73 
	`¥ötf
(" syn¯- 0x%x,0x%x,0x%x,0x%x\n", 
sync
.
id32
[0], sync.id32[1], sync.id32[2], sync.id32[3]);

75 
dev
 = -1;

77 i‡((
îr
 = 
	`¢d_˘l_øwmidi_√xt_devi˚
(
h™dÀ
, &
dev
)) < 0) {

78 
	`¥ötf
(" RAWMIDIÇexàdevi˚Éº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

81 i‡(
dev
 < 0)

83 
	`¢d_øwmidi_öfo_£t_devi˚
(
øwmidiöfo
, 
dev
);

84 
	`¢d_øwmidi_öfo_£t_subdevi˚
(
øwmidiöfo
, 0);

85 
	`¢d_øwmidi_öfo_£t_°ªam
(
øwmidiöfo
, 
SND_RAWMIDI_STREAM_OUTPUT
);

86 i‡((
îr
 = 
	`¢d_˘l_øwmidi_öfo
(
h™dÀ
, 
øwmidiöfo
)) < 0) {

87 
	`¥ötf
(" RAWMIDI infÿîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

90 
	`¥ötf
("RAWMIDI info, devi˚ #%i:\n", 
dev
);

91 
	`¥ötf
(" devi˚ - %i\n", 
	`¢d_øwmidi_öfo_gë_devi˚
(
øwmidiöfo
));

92 
	`¥ötf
(" subdevi˚ - %i\n", 
	`¢d_øwmidi_öfo_gë_subdevi˚
(
øwmidiöfo
));

93 
	`¥ötf
(" såóm - %i\n", 
	`¢d_øwmidi_öfo_gë_°ªam
(
øwmidiöfo
));

94 
	`¥ötf
(" c¨d - %i\n", 
	`¢d_øwmidi_öfo_gë_ˇrd
(
øwmidiöfo
));

95 
	`¥ötf
(" fœg†- 0x%x\n", 
	`¢d_øwmidi_öfo_gë_Êags
(
øwmidiöfo
));

96 
	`¥ötf
(" id - '%s'\n", 
	`¢d_øwmidi_öfo_gë_id
(
øwmidiöfo
));

97 
	`¥ötf
("Çamê- '%s'\n", 
	`¢d_øwmidi_öfo_gë_«me
(
øwmidiöfo
));

98 
	`¥ötf
(" sub«mê- '%s'\n", 
	`¢d_øwmidi_öfo_gë_subdevi˚_«me
(
øwmidiöfo
));

99 
	`¥ötf
(" subdevi˚†cou¡ - %i\n", 
	`¢d_øwmidi_öfo_gë_subdevi˚s_cou¡
(
øwmidiöfo
));

100 
	`¥ötf
(" subdevi˚†avaû - %i\n", 
	`¢d_øwmidi_öfo_gë_subdevi˚s_avaû
(
øwmidiöfo
));

102 
	`¢d_˘l_˛o£
(
h™dÀ
);

105 
	`¢d_c⁄fig_upd©e_‰ì_globÆ
();

107 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/latency.c

30 
	~"c⁄fig.h
"

31 
	~<°dio.h
>

32 
	~<°dlib.h
>

33 
	~<°rög.h
>

34 
	~<sched.h
>

35 
	~<î∫o.h
>

36 
	~<gë›t.h
>

37 
	~<time.h
>

38 
	~"../ö˛ude/asoundlib.h
"

39 
	~<sys/time.h
>

40 
	~<m©h.h
>

42 #i‚de‡
CLOCK_MONOTONIC_RAW


43 
	#CLOCK_MONOTONIC_RAW
 
CLOCK_MONOTONIC


	)

46 #i‡
deföed
(
__O≥nBSD__
)

47 
	#sched_gë∑øm
(
pid
, 
∑rm
Ë(-1)

	)

48 
	#sched_£tscheduÀr
(
pid
, 
pﬁicy
, 
∑rm
Ë(-1)

	)

51 
time•ec
 
	ttime°amp_t
;

53 *
	gsched_pﬁicy
 = "rr";

54 *
	gpdevi˚
 = "hw:0,0";

55 *
	gcdevi˚
 = "hw:0,0";

56 
¢d_pcm_f‹m©_t
 
	gf‹m©
 = 
SND_PCM_FORMAT_S16_LE
;

57 
	gøã
 = 22050;

58 
	gch™√ls
 = 2;

59 
	gbuf„r_size
 = 0;

60 
	g≥riod_size
 = 0;

61 
	gœãncy_mö
 = 32;

62 
	gœãncy_max
 = 2048;

63 
	glo›_£c
 = 30;

64 
	gblock
 = 0;

65 
	gu£_pﬁl
 = 0;

66 
	gu¶ìp_vÆ
 = 0;

67 
	gªßm∂e
 = 1;

68 
	gsys_œãncy
 = 0;

69 
	gpos_dump
 = 0;

70 
	gªÆtime_check
 = 0;

71 
	glo›_limô
;

72 
¢d_pcm_u‰ames_t
 
	g∂ayback_buf„r_size
;

74 
¢d_ouçut_t
 *
	gouçut
 = 
NULL
;

76 
ölöe
 
	$‰ames_to_mi¸o
(
size_t
 
‰ames
)

78  ()((
‰ames
 * 1000000LLË+ (
øã
 / 2)) /Ñate;

79 
	}
}

81 
	$time°amp_now
(
time°amp_t
 *
t°amp
)

83 i‡(
	`˛ock_gëtime
(
CLOCK_MONOTONIC_RAW
, 
t°amp
))

84 
	`¥ötf
("clock_gettime() failed\n");

85 
	}
}

87 
	$time°amp_diff_mi¸o
(
time°amp_t
 *
t°amp
)

89 
time°amp_t
 
now
, 
diff
;

90 
	`time°amp_now
(&
now
);

91 i‡(
t°amp
->
tv_n£c
 > 
now
.tv_nsec) {

92 
diff
.
tv_£c
 = 
now
.tv_£¯- 
t°amp
->tv_sec - 1;

93 
diff
.
tv_n£c
 = (
now
.tv_n£¯+ 1000000000LË- 
t°amp
->tv_nsec;

95 
diff
.
tv_£c
 = 
now
.tv_£¯- 
t°amp
->tv_sec;

96 
diff
.
tv_n£c
 = 
now
.tv_n£¯- 
t°amp
->tv_nsec;

99  (
diff
.
tv_£c
 * 1000000Ë+ ((diff.
tv_n£c
 + 500L) / 1000L);

100 
	}
}

102 
	$£ç¨ams_°ªam
(
¢d_pcm_t
 *
h™dÀ
,

103 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

104 c⁄° *
id
)

106 
îr
;

107 
º©e
;

109 
îr
 = 
	`¢d_pcm_hw_∑øms_™y
(
h™dÀ
, 
∑øms
);

110 i‡(
îr
 < 0) {

111 
	`¥ötf
("Brokí c⁄figuøti⁄ f‹ %†PCM:Çÿc⁄figuøti⁄†avaûabÀ: %s\n", 
	`¢d_°ªº‹
(
îr
), 
id
);

112  
îr
;

114 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_øã_ªßm∂e
(
h™dÀ
, 
∑øms
, 
ªßm∂e
);

115 i‡(
îr
 < 0) {

116 
	`¥ötf
("Reßm∂ê£tu∞Áûed f‹ %†(vÆ %i): %s\n", 
id
, 
ªßm∂e
, 
	`¢d_°ªº‹
(
îr
));

117  
îr
;

119 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_ac˚ss
(
h™dÀ
, 
∑øms
, 
SND_PCM_ACCESS_RW_INTERLEAVED
);

120 i‡(
îr
 < 0) {

121 
	`¥ötf
("Ac˚s†ty≥ÇŸávaûabÀ f‹ %s: %s\n", 
id
, 
	`¢d_°ªº‹
(
îr
));

122  
îr
;

124 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_f‹m©
(
h™dÀ
, 
∑øms
, 
f‹m©
);

125 i‡(
îr
 < 0) {

126 
	`¥ötf
("Sam∂êf‹m©ÇŸávaûabÀ f‹ %s: %s\n", 
id
, 
	`¢d_°ªº‹
(
îr
));

127  
îr
;

129 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_ch™√ls
(
h™dÀ
, 
∑øms
, 
ch™√ls
);

130 i‡(
îr
 < 0) {

131 
	`¥ötf
("Ch™√l†cou¡ (%iËnŸávaûabÀ f‹ %s: %s\n", 
ch™√ls
, 
id
, 
	`¢d_°ªº‹
(
îr
));

132  
îr
;

134 
º©e
 = 
øã
;

135 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_øã_√¨
(
h™dÀ
, 
∑øms
, &
º©e
, 0);

136 i‡(
îr
 < 0) {

137 
	`¥ötf
("R©ê%iHzÇŸávaûabÀ f‹ %s: %s\n", 
øã
, 
id
, 
	`¢d_°ªº‹
(
îr
));

138  
îr
;

140 i‡(()
º©e
 !
øã
) {

141 
	`¥ötf
("R©êd€¢'àm©ch (ªque°ed %iHz, gë %iHz)\n", 
øã
, 
îr
);

142  -
EINVAL
;

145 i‡(
sys_œãncy
 > 0 && 
	`¢d_pcm_hw_∑øms_ˇn_dißbÀ_≥riod_wakeup
(
∑øms
)) {

146 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_≥riod_wakeup
(
h™dÀ
, 
∑øms
, 0);

147 i‡(
îr
 < 0) {

148 
	`¥ötf
("C™nŸ dißbÀÖîiod wakeup†f‹ %s\n", 
id
);

149  
îr
;

153 
	}
}

155 
	$£ç¨ams_bufsize
(
¢d_pcm_t
 *
h™dÀ
,

156 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

157 
¢d_pcm_hw_∑øms_t
 *
ç¨ams
,

158 
¢d_pcm_u‰ames_t
 
bufsize
,

159 c⁄° *
id
)

161 
îr
;

162 
¢d_pcm_u‰ames_t
 
≥riodsize
;

164 
	`¢d_pcm_hw_∑øms_c›y
(
∑øms
, 
ç¨ams
);

165 
≥riodsize
 = 
bufsize
 * 2;

166 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_buf„r_size_√¨
(
h™dÀ
, 
∑øms
, &
≥riodsize
);

167 i‡(
îr
 < 0) {

168 
	`¥ötf
("U«bÀÅÿ£àbuf„∏sizê%lòf‹ %s: %s\n", 
bufsize
 * 2, 
id
, 
	`¢d_°ªº‹
(
îr
));

169  
îr
;

171 i‡(
≥riod_size
 > 0)

172 
≥riodsize
 = 
≥riod_size
;

174 
≥riodsize
 /= 2;

175 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_≥riod_size_√¨
(
h™dÀ
, 
∑øms
, &
≥riodsize
, 0);

176 i‡(
îr
 < 0) {

177 
	`¥ötf
("U«bÀÅÿ£à≥riod sizê%lòf‹ %s: %s\n", 
≥riodsize
, 
id
, 
	`¢d_°ªº‹
(
îr
));

178  
îr
;

181 
	}
}

183 
	$£ç¨ams_£t
(
¢d_pcm_t
 *
h™dÀ
,

184 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

185 
¢d_pcm_sw_∑øms_t
 *
sw∑øms
,

186 c⁄° *
id
)

188 
îr
;

189 
¢d_pcm_u‰ames_t
 
vÆ
;

191 
îr
 = 
	`¢d_pcm_hw_∑øms
(
h™dÀ
, 
∑øms
);

192 i‡(
îr
 < 0) {

193 
	`¥ötf
("U«bÀÅÿ£àhwÖ¨am†f‹ %s: %s\n", 
id
, 
	`¢d_°ªº‹
(
îr
));

194  
îr
;

196 
îr
 = 
	`¢d_pcm_sw_∑øms_cuºít
(
h™dÀ
, 
sw∑øms
);

197 i‡(
îr
 < 0) {

198 
	`¥ötf
("U«bÀÅÿdëîmöêcuºíàsw∑øm†f‹ %s: %s\n", 
id
, 
	`¢d_°ªº‹
(
îr
));

199  
îr
;

201 
îr
 = 
	`¢d_pcm_sw_∑øms_£t_°¨t_thªshﬁd
(
h™dÀ
, 
sw∑øms
, 0x7fffffff);

202 i‡(
îr
 < 0) {

203 
	`¥ötf
("U«bÀÅÿ£à°¨àthªshﬁd modêf‹ %s: %s\n", 
id
, 
	`¢d_°ªº‹
(
îr
));

204  
îr
;

206 i‡(!
block
)

207 
vÆ
 = 4;

209 
	`¢d_pcm_hw_∑øms_gë_≥riod_size
(
∑øms
, &
vÆ
, 
NULL
);

210 
îr
 = 
	`¢d_pcm_sw_∑øms_£t_avaû_mö
(
h™dÀ
, 
sw∑øms
, 
vÆ
);

211 i‡(
îr
 < 0) {

212 
	`¥ötf
("U«bÀÅÿ£àavaû mö f‹ %s: %s\n", 
id
, 
	`¢d_°ªº‹
(
îr
));

213  
îr
;

215 
îr
 = 
	`¢d_pcm_sw_∑øms
(
h™dÀ
, 
sw∑øms
);

216 i‡(
îr
 < 0) {

217 
	`¥ötf
("U«bÀÅÿ£àswÖ¨am†f‹ %s: %s\n", 
id
, 
	`¢d_°ªº‹
(
îr
));

218  
îr
;

221 
	}
}

223 
	$£ç¨ams
(
¢d_pcm_t
 *
ph™dÀ
, snd_pcm_à*
ch™dÀ
, *
bufsize
)

225 
îr
, 
œ°_bufsize
 = *
bufsize
;

226 
¢d_pcm_hw_∑øms_t
 *
±_∑øms
, *
˘_∑øms
;

227 
¢d_pcm_hw_∑øms_t
 *
p_∑øms
, *
c_∑øms
;

228 
¢d_pcm_sw_∑øms_t
 *
p_sw∑øms
, *
c_sw∑øms
;

229 
¢d_pcm_u‰ames_t
 
p_size
, 
c_size
, 
p_psize
, 
c_psize
;

230 
p_time
, 
c_time
;

231 
vÆ
;

233 
	`¢d_pcm_hw_∑øms_Æloˇ
(&
p_∑øms
);

234 
	`¢d_pcm_hw_∑øms_Æloˇ
(&
c_∑øms
);

235 
	`¢d_pcm_hw_∑øms_Æloˇ
(&
±_∑øms
);

236 
	`¢d_pcm_hw_∑øms_Æloˇ
(&
˘_∑øms
);

237 
	`¢d_pcm_sw_∑øms_Æloˇ
(&
p_sw∑øms
);

238 
	`¢d_pcm_sw_∑øms_Æloˇ
(&
c_sw∑øms
);

239 i‡((
îr
 = 
	`£ç¨ams_°ªam
(
ph™dÀ
, 
±_∑øms
, "playback")) < 0) {

240 
	`¥ötf
("U«bÀÅÿ£à∑ømëî†f‹Öœyback såóm: %s\n", 
	`¢d_°ªº‹
(
îr
));

241 
	`exô
(0);

243 i‡((
îr
 = 
	`£ç¨ams_°ªam
(
ch™dÀ
, 
˘_∑øms
, "capture")) < 0) {

244 
	`¥ötf
("U«bÀÅÿ£à∑ømëî†f‹Öœyback såóm: %s\n", 
	`¢d_°ªº‹
(
îr
));

245 
	`exô
(0);

248 i‡(
buf„r_size
 > 0) {

249 *
bufsize
 = 
buf„r_size
;

250 
__£t_ô
;

253 
__agaö
:

254 i‡(
buf„r_size
 > 0)

256 i‡(
œ°_bufsize
 =*
bufsize
)

257 *
bufsize
 += 4;

258 
œ°_bufsize
 = *
bufsize
;

259 i‡(*
bufsize
 > 
œãncy_max
)

261 
__£t_ô
:

262 i‡((
îr
 = 
	`£ç¨ams_bufsize
(
ph™dÀ
, 
p_∑øms
, 
±_∑øms
, *
bufsize
, "playback")) < 0) {

263 
	`¥ötf
("U«bÀÅÿ£àhwÖ¨amëî†f‹Öœyback såóm: %s\n", 
	`¢d_°ªº‹
(
îr
));

264 
	`exô
(0);

266 i‡((
îr
 = 
	`£ç¨ams_bufsize
(
ch™dÀ
, 
c_∑øms
, 
˘_∑øms
, *
bufsize
, "capture")) < 0) {

267 
	`¥ötf
("U«bÀÅÿ£àhwÖ¨amëî†f‹ c≠tuª såóm: %s\n", 
	`¢d_°ªº‹
(
îr
));

268 
	`exô
(0);

271 
	`¢d_pcm_hw_∑øms_gë_≥riod_size
(
p_∑øms
, &
p_psize
, 
NULL
);

272 i‡(
p_psize
 > ()*
bufsize
)

273 *
bufsize
 = 
p_psize
;

274 
	`¢d_pcm_hw_∑øms_gë_≥riod_size
(
c_∑øms
, &
c_psize
, 
NULL
);

275 i‡(
c_psize
 > ()*
bufsize
)

276 *
bufsize
 = 
c_psize
;

277 
	`¢d_pcm_hw_∑øms_gë_≥riod_time
(
p_∑øms
, &
p_time
, 
NULL
);

278 
	`¢d_pcm_hw_∑øms_gë_≥riod_time
(
c_∑øms
, &
c_time
, 
NULL
);

279 i‡(
p_time
 !
c_time
)

280 
__agaö
;

282 
	`¢d_pcm_hw_∑øms_gë_buf„r_size
(
p_∑øms
, &
p_size
);

283 
∂ayback_buf„r_size
 = 
p_size
;

284 i‡(
p_psize
 * 2 < 
p_size
) {

285 
	`¢d_pcm_hw_∑øms_gë_≥riods_mö
(
p_∑øms
, &
vÆ
, 
NULL
);

286 i‡(
vÆ
 > 2) {

287 
	`¥ötf
("playback device doesÇot support 2ÖeriodsÖer buffer\n");

288 
	`exô
(0);

290 
__agaö
;

292 
	`¢d_pcm_hw_∑øms_gë_buf„r_size
(
c_∑øms
, &
c_size
);

293 i‡(
c_psize
 * 2 < 
c_size
) {

294 
	`¢d_pcm_hw_∑øms_gë_≥riods_mö
(
c_∑øms
, &
vÆ
, 
NULL
);

295 i‡(
vÆ
 > 2 ) {

296 
	`¥ötf
("capture device doesÇot support 2ÖeriodsÖer buffer\n");

297 
	`exô
(0);

299 
__agaö
;

301 i‡((
îr
 = 
	`£ç¨ams_£t
(
ph™dÀ
, 
p_∑øms
, 
p_sw∑øms
, "playback")) < 0) {

302 
	`¥ötf
("U«bÀÅÿ£àswÖ¨amëî†f‹Öœyback såóm: %s\n", 
	`¢d_°ªº‹
(
îr
));

303 
	`exô
(0);

305 i‡((
îr
 = 
	`£ç¨ams_£t
(
ch™dÀ
, 
c_∑øms
, 
c_sw∑øms
, "capture")) < 0) {

306 
	`¥ötf
("U«bÀÅÿ£àswÖ¨amëî†f‹Öœyback såóm: %s\n", 
	`¢d_°ªº‹
(
îr
));

307 
	`exô
(0);

310 i‡((
îr
 = 
	`¢d_pcm_¥ï¨e
(
ph™dÀ
)) < 0) {

311 
	`¥ötf
("Pª∑ªÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

312 
	`exô
(0);

315 
	`¢d_pcm_dump
(
ph™dÀ
, 
ouçut
);

316 
	`¢d_pcm_dump
(
ch™dÀ
, 
ouçut
);

317 
	`fÊush
(
°dout
);

319 
	}
}

321 
	$show°©
(
¢d_pcm_t
 *
h™dÀ
, 
size_t
 
‰ames
)

323 
îr
;

324 
¢d_pcm_°©us_t
 *
°©us
;

326 
	`¢d_pcm_°©us_Æloˇ
(&
°©us
);

327 i‡((
îr
 = 
	`¢d_pcm_°©us
(
h™dÀ
, 
°©us
)) < 0) {

328 
	`¥ötf
("Såóm sètu†îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

329 
	`exô
(0);

331 
	`¥ötf
("*** føme†%lò***\n", ()
‰ames
);

332 
	`¢d_pcm_°©us_dump
(
°©us
, 
ouçut
);

333 
	}
}

335 
	$showœãncy
(
size_t
 
œãncy
)

337 
d
;

338 
œãncy
 *= 2;

339 
d
 = ()
œãncy
 / ()
øã
;

340 
	`¥ötf
("TryögÜ©ícy %lò‰ames, %.3fus, %.6fm†(%.4fHz)\n", ()
œãncy
, 
d
 * 1000000, d * 1000, ()1 / d);

341 
	}
}

343 
	$showömax
(
size_t
 
ö_max
)

345 
d
;

347 
	`¥ötf
("MaximumÑód: %lò‰ames\n", ()
ö_max
);

348 
d
 = ()
ö_max
 / ()
øã
;

349 
	`¥ötf
("MaximumÑódÜ©ícy: %.3fus, %.6fm†(%.4fHz)\n", 
d
 * 1000000, d * 1000, ()1 / d);

350 
	}
}

352 
	$gëtime°amp
(
¢d_pcm_t
 *
h™dÀ
, 
¢d_time°amp_t
 *
time°amp
)

354 
îr
;

355 
¢d_pcm_°©us_t
 *
°©us
;

357 
	`¢d_pcm_°©us_Æloˇ
(&
°©us
);

358 i‡((
îr
 = 
	`¢d_pcm_°©us
(
h™dÀ
, 
°©us
)) < 0) {

359 
	`¥ötf
("Såóm sètu†îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

360 
	`exô
(0);

362 
	`¢d_pcm_°©us_gë_åiggî_t°amp
(
°©us
, 
time°amp
);

363 
	}
}

365 
	$£tscheduÀr
()

367 
sched_∑øm
 sched_param;

368 
pﬁicy
 = 
SCHED_RR
;

369 c⁄° *
•ﬁicy
 = "Round Robin";

371 i‡(
	`°rˇ£cmp
(
sched_pﬁicy
, "fifo") == 0) {

372 
pﬁicy
 = 
SCHED_FIFO
;

373 
•ﬁicy
 = "FIFO";

374 } i‡(
	`°rˇ£cmp
(
sched_pﬁicy
, "other") == 0) {

375 
pﬁicy
 = 
SCHED_OTHER
;

376 
•ﬁicy
 = "OTHER";

378 i‡(
	`sched_gë∑øm
(0, &
sched_∑øm
) < 0) {

379 
	`¥ötf
("Scheduler getparam failed...\n");

382 
sched_∑øm
.
sched_¥i‹ôy
 = 
	`sched_gë_¥i‹ôy_max
(
pﬁicy
);

383 i‡(!
	`sched_£tscheduÀr
(0, 
pﬁicy
, &
sched_∑øm
)) {

384 
	`¥ötf
("ScheduÀ∏£àtÿ%†wôhÖri‹ôy %i...\n", 
•ﬁicy
, 
sched_∑øm
.
sched_¥i‹ôy
);

385 
	`fÊush
(
°dout
);

388 
	`¥ötf
("!!!ScheduÀ∏£àtÿ%†wôhÖri‹ôy %òFAILED!!!\n", 
•ﬁicy
, 
sched_∑øm
.
sched_¥i‹ôy
);

389 
	}
}

391 
	$timediff
(
¢d_time°amp_t
 
t1
, snd_time°amp_à
t2
)

393 sig√d 
l
;

395 
t1
.
tv_£c
 -
t2
.tv_sec;

396 
l
 = (sig√d Ë
t1
.
tv_u£c
 - (sig√d Ë
t2
.tv_usec;

397 i‡(
l
 < 0) {

398 
t1
.
tv_£c
--;

399 
l
 = 1000000 +Ü;

400 
l
 %= 1000000;

402  (
t1
.
tv_£c
 * 1000000Ë+ 
l
;

403 
	}
}

405 
	$ªadbuf
(
¢d_pcm_t
 *
h™dÀ
, *
buf
, 
Àn
, 
size_t
 *
‰ames
, size_à*
max
)

407 
r
;

409 i‡(!
block
) {

411 
r
 = 
	`¢d_pcm_ªadi
(
h™dÀ
, 
buf
, 
Àn
);

412 } 
r
 =-
EAGAIN
);

413 i‡(
r
 > 0) {

414 *
‰ames
 +
r
;

415 i‡(()*
max
 < 
r
)

416 *
max
 = 
r
;

420 
‰ame_byãs
 = (
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
Ë/ 8Ë* 
ch™√ls
;

422 
r
 = 
	`¢d_pcm_ªadi
(
h™dÀ
, 
buf
, 
Àn
);

423 i‡(
r
 > 0) {

424 
buf
 +
r
 * 
‰ame_byãs
;

425 
Àn
 -
r
;

426 *
‰ames
 +
r
;

427 i‡(()*
max
 < 
r
)

428 *
max
 = 
r
;

431 } 
r
 >1 && 
Àn
 > 0);

434  
r
;

435 
	}
}

437 
	$wrôebuf
(
¢d_pcm_t
 *
h™dÀ
, *
buf
, 
Àn
, 
size_t
 *
‰ames
)

439 
r
;

440 
‰ame_byãs
 = (
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
Ë/ 8Ë* 
ch™√ls
;

442 
Àn
 > 0) {

443 
r
 = 
	`¢d_pcm_wrôei
(
h™dÀ
, 
buf
, 
Àn
);

444 i‡(
r
 =-
EAGAIN
)

447 i‡(
r
 < 0)

448  
r
;

450 
buf
 +
r
 * 
‰ame_byãs
;

451 
Àn
 -
r
;

452 *
‰ames
 +
r
;

455 
	}
}

457 
	#FILTERSWEEP_LFO_CENTER
 2000.

	)

458 
	#FILTERSWEEP_LFO_DEPTH
 1800.

	)

459 
	#FILTERSWEEP_LFO_FREQ
 0.2

	)

460 
	#FILTER_BANDWIDTH
 50

	)

463 
	glfo
,
	gdlfo
,
	gfs
,
	gfc
,
	gBW
,
	gC
,
	gD
,
	ga0
,
	ga1
,
	ga2
,
	gb1
,
	gb2
,*
	gx
[3],*
	gy
[3];

465 
	$≠∂yef„˘
(* 
buf„r
,
r
)

467 * 
ßm∂es
 = (*Ë
buf„r
;

468 
i
;

469 
i
=0;i<
r
;i++)

471 
chn
;

473 
fc
 = 
	`sö
(
lfo
)*
FILTERSWEEP_LFO_DEPTH
+
FILTERSWEEP_LFO_CENTER
;

474 
lfo
 +
dlfo
;

475 i‡(
lfo
>2.*
M_PI
)Üfo -= 2.*M_PI;

476 
C
 = 1./
	`èn
(
M_PI
*
BW
/
fs
);

477 
D
 = 2.*
	`cos
(2*
M_PI
*
fc
/
fs
);

478 
a0
 = 1./(1.+
C
);

479 
a1
 = 0;

480 
a2
 = -
a0
;

481 
b1
 = -
C
*
D
*
a0
;

482 
b2
 = (
C
-1)*
a0
;

484 
chn
=0;chn<
ch™√ls
;chn++)

486 
x
[
chn
][2] = x[chn][1];

487 
x
[
chn
][1] = x[chn][0];

489 
y
[
chn
][2] = y[chn][1];

490 
y
[
chn
][1] = y[chn][0];

492 
x
[
chn
][0] = 
ßm∂es
[
i
*
ch™√ls
+chn];

493 
y
[
chn
][0] = 
a0
*
x
[chn][0] + 
a1
*x[chn][1] + 
a2
*x[chn][2]

494 - 
b1
*
y
[
chn
][1] - 
b2
*y[chn][2];

495 
ßm∂es
[
i
*
ch™√ls
+
chn
] = 
y
[chn][0];

498 
	}
}

500 
ssize_t
 
	$gë_avaû
(
¢d_pcm_t
 *
pcm
)

502 
ssize_t
 
avaû
;

505 
avaû
 = 
	`¢d_pcm_avaû
(
pcm
);

506 i‡(
avaû
 =-
EAGAIN
)

510  
avaû
;

511 
	}
}

513 
	$hñp
()

515 
k
;

516 
	`¥ötf
(

540 
	`¥ötf
("Recognized sample formatsáre:");

541 
k
 = 0; k < 
SND_PCM_FORMAT_LAST
; ++k) {

542 c⁄° *
s
 = 
	`¢d_pcm_f‹m©_«me
(
k
);

543 i‡(
s
)

544 
	`¥ötf
(" %s", 
s
);

546 
	`¥ötf
("\n\n");

547 
	`¥ötf
(

554 
	}
}

556 
	$maö
(
¨gc
, *
¨gv
[])

558 
›ti⁄
 
l⁄g_›ti⁄
[] =

560 {"hñp", 0, 
NULL
, 'h'},

561 {"pdevi˚", 1, 
NULL
, 'P'},

562 {"cdevi˚", 1, 
NULL
, 'C'},

563 {"mö", 1, 
NULL
, 'm'},

564 {"max", 1, 
NULL
, 'M'},

565 {"upd©es", 1, 
NULL
, 'U'},

566 {"‰ames", 1, 
NULL
, 'F'},

567 {"f‹m©", 1, 
NULL
, 'f'},

568 {"ch™√ls", 1, 
NULL
, 'c'},

569 {"øã", 1, 
NULL
, 'r'},

570 {"buf„r", 1, 
NULL
, 'B'},

571 {"≥riod", 1, 
NULL
, 'E'},

572 {"£c⁄ds", 1, 
NULL
, 's'},

573 {"block", 0, 
NULL
, 'b'},

574 {"pﬁl", 0, 
NULL
, 'p'},

575 {"u¶ìp", 1, 
NULL
, 'y'},

576 {"ef„˘", 0, 
NULL
, 'e'},

577 {"posdump", 0, 
NULL
, 'x'},

578 {"ªÆtime", 0, 
NULL
, 'X'},

579 {"pﬁicy", 1, 
NULL
, 'O'},

580 {
NULL
, 0, NULL, 0},

582 
¢d_pcm_t
 *
ph™dÀ
, *
ch™dÀ
;

583 *
buf„r
;

584 
îr
, 
œãncy
, 
m‹ehñp
;

585 
ok
;

586 
¢d_time°amp_t
 
p_t°amp
, 
c_t°amp
;

587 
ssize_t
 
r
, 
ˇp_avaû
, 
ˇp_avaû_max
, 
pbk_fûl
, 
pbk_fûl_mö
;

588 
size_t
 
‰ames_ö
, 
‰ames_out
, 
ö_max
;

589 
time°amp_t
 
t°amp_°¨t
;

590 
ef„˘
 = 0;

591 
m‹ehñp
 = 0;

593 
c
;

594 i‡((
c
 = 
	`gë›t_l⁄g
(
¨gc
, 
¨gv
, "hP:C:m:M:U:F:f:c:r:B:E:s:y:O:b≥nxX", 
l⁄g_›ti⁄
, 
NULL
)) < 0)

596 
c
) {

598 
m‹ehñp
++;

601 
pdevi˚
 = 
	`°rdup
(
›èrg
);

604 
cdevi˚
 = 
	`°rdup
(
›èrg
);

607 
îr
 = 
	`©oi
(
›èrg
) / 2;

608 
œãncy_mö
 = 
îr
 >= 4 ?Érr : 4;

609 i‡(
œãncy_max
 < 
œãncy_mö
)

610 
œãncy_max
 = 
œãncy_mö
;

613 
îr
 = 
	`©oi
(
›èrg
) / 2;

614 
œãncy_max
 = 
œãncy_mö
 > 
îr
 ?Üatency_min :Érr;

617 
îr
 = 
	`©oi
(
›èrg
);

618 
sys_œãncy
 = 
îr
 <= 0 ? 0 :Érr;

621 
f‹m©
 = 
	`¢d_pcm_f‹m©_vÆue
(
›èrg
);

622 i‡(
f‹m©
 =
SND_PCM_FORMAT_UNKNOWN
) {

623 
	`¥ötf
("Unknown format, settingÅo default S16_LE\n");

624 
f‹m©
 = 
SND_PCM_FORMAT_S16_LE
;

628 
îr
 = 
	`©oi
(
›èrg
);

629 
ch™√ls
 = 
îr
 >= 1 &&Érr < 1024 ?Érr : 1;

632 
îr
 = 
	`©oi
(
›èrg
);

633 
øã
 = 
îr
 >= 4000 &&Érr < 200000 ?Érr : 44100;

636 
îr
 = 
	`©oi
(
›èrg
);

637 
buf„r_size
 = 
îr
 >= 32 &&Érr < 200000 ?Érr : 0;

640 
îr
 = 
	`©oi
(
›èrg
);

641 
≥riod_size
 = 
îr
 >= 32 &&Érr < 200000 ?Érr : 0;

644 
îr
 = 
	`©oi
(
›èrg
);

645 
lo›_£c
 = 
îr
 >= 1 &&Érr <= 100000 ?Érr : 30;

648 
block
 = 1;

651 
u£_pﬁl
 = 1;

654 
u¶ìp_vÆ
 = 
	`©oi
(
›èrg
);

657 
ef„˘
 = 1;

660 
ªßm∂e
 = 0;

663 
pos_dump
 = 1;

666 
ªÆtime_check
 = 1;

669 
sched_pﬁicy
 = 
›èrg
;

674 i‡(
m‹ehñp
) {

675 
	`hñp
();

678 
îr
 = 
	`¢d_ouçut_°dio_©èch
(&
ouçut
, 
°dout
, 0);

679 i‡(
îr
 < 0) {

680 
	`¥ötf
("OuçuàÁûed: %s\n", 
	`¢d_°ªº‹
(
îr
));

684 
lo›_limô
 = 
lo›_£c
 * 
øã
;

685 
œãncy
 = 
œãncy_mö
 - 4;

686 
buf„r
 = 
	`mÆloc
((
œãncy_max
 * 2 * 
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
Ë/ 8Ë* 
ch™√ls
);

689 i‡(
sys_œãncy
 > 0) {

690 
block
 = 0;

691 
u£_pﬁl
 = 0;

694 
	`£tscheduÀr
();

696 
	`¥ötf
("Pœyback devi˚ i†%s\n", 
pdevi˚
);

697 
	`¥ötf
("C≠tuª devi˚ i†%s\n", 
cdevi˚
);

698 
	`¥ötf
("Parametersáre %iHz, %s, %i channels, %s mode, useÖoll %s\n",

699 
øã
, 
	`¢d_pcm_f‹m©_«me
(
f‹m©
),

700 
ch™√ls
, 
block
 ? "blocking" : "non-blocking",

701 
u£_pﬁl
 ? "yes" : "no");

702 
	`¥ötf
("LoopÜimit is %lu frames, minimumÜatency = %i, maximumÜatency = %i",

703 
lo›_limô
, 
œãncy_mö
 * 2, 
œãncy_max
 * 2);

704 i‡(
sys_œãncy
 > 0)

705 
	`¥ötf
(", I/O upd©e†%ims", 
sys_œãncy
);

706 i‡(!
block
 && !
u£_pﬁl
)

707 
	`¥ötf
(", I/O u¶ì∞%ius", 
u¶ìp_vÆ
);

708 
	`¥ötf
("\n");

710 i‡((
îr
 = 
	`¢d_pcm_›í
(&
ph™dÀ
, 
pdevi˚
, 
SND_PCM_STREAM_PLAYBACK
, 
block
 ? 0 : 
SND_PCM_NONBLOCK
)) < 0) {

711 
	`¥ötf
("Pœyback o≥¿îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

714 i‡((
îr
 = 
	`¢d_pcm_›í
(&
ch™dÀ
, 
cdevi˚
, 
SND_PCM_STREAM_CAPTURE
, 
block
 ? 0 : 
SND_PCM_NONBLOCK
)) < 0) {

715 
	`¥ötf
("Rec‹d o≥¿îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

720 i‡(
ef„˘
) {

721 
fs
 = (Ë
øã
;

722 
BW
 = 
FILTER_BANDWIDTH
;

724 
lfo
 = 0;

725 
dlfo
 = 2.*
M_PI
*
FILTERSWEEP_LFO_FREQ
/
fs
;

727 
x
[0] = (*Ë
	`mÆloc
(
ch™√ls
*());

728 
x
[1] = (*Ë
	`mÆloc
(
ch™√ls
*());

729 
x
[2] = (*Ë
	`mÆloc
(
ch™√ls
*());

730 
y
[0] = (*Ë
	`mÆloc
(
ch™√ls
*());

731 
y
[1] = (*Ë
	`mÆloc
(
ch™√ls
*());

732 
y
[2] = (*Ë
	`mÆloc
(
ch™√ls
*());

735 
ˇp_avaû_max
 = 0;

736 
pbk_fûl_mö
 = 
œãncy
 * 2;

739 
‰ames_ö
 = 
‰ames_out
 = 0;

740 i‡(
	`£ç¨ams
(
ph™dÀ
, 
ch™dÀ
, &
œãncy
) < 0)

742 
	`showœãncy
(
œãncy
);

743 i‡((
îr
 = 
	`¢d_pcm_lök
(
ch™dÀ
, 
ph™dÀ
)) < 0) {

744 
	`¥ötf
("Såóm†lökÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

745 
	`exô
(0);

747 i‡(
	`¢d_pcm_f‹m©_£t_sûí˚
(
f‹m©
, 
buf„r
, 
œãncy
 * 
ch™√ls
) < 0) {

748 
	`Ârötf
(
°dîr
, "silenceÉrror\n");

751 i‡(
	`wrôebuf
(
ph™dÀ
, 
buf„r
, 
œãncy
, &
‰ames_out
) < 0) {

752 
	`Ârötf
(
°dîr
, "writeÉrror\n");

755 i‡(
	`wrôebuf
(
ph™dÀ
, 
buf„r
, 
œãncy
, &
‰ames_out
) < 0) {

756 
	`Ârötf
(
°dîr
, "writeÉrror\n");

760 i‡(
ªÆtime_check
)

761 
	`time°amp_now
(&
t°amp_°¨t
);

762 i‡((
îr
 = 
	`¢d_pcm_°¨t
(
ch™dÀ
)) < 0) {

763 
	`¥ötf
("Gÿîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

764 
	`exô
(0);

766 i‡(
ªÆtime_check
)

767 
	`¥ötf
("[%Œdus] Såóm sèπ\n", 
	`time°amp_diff_mi¸o
(&
t°amp_°¨t
));

768 
	`gëtime°amp
(
ph™dÀ
, &
p_t°amp
);

769 
	`gëtime°amp
(
ch™dÀ
, &
c_t°amp
);

771 
	`¥ötf
("Playback:\n");

772 
	`show°©
(
ph™dÀ
, 
‰ames_out
);

773 
	`¥ötf
("Capture:\n");

774 
	`show°©
(
ch™dÀ
, 
‰ames_ö
);

777 
ok
 = 1;

778 
ö_max
 = 0;

779 
ok
 && 
‰ames_ö
 < 
lo›_limô
) {

780 
ˇp_avaû
 = 
œãncy
;

781 i‡(
sys_œãncy
 > 0) {

782 
	`pﬁl
(
NULL
, 0, 
sys_œãncy
);

783 
ˇp_avaû
 = 
	`gë_avaû
(
ch™dÀ
);

784 i‡(
ˇp_avaû
 < 0) {

785 
	`¥ötf
("Avaû faûed: %s\n", 
	`¢d_°ªº‹
(
ˇp_avaû
));

786 
ok
 = 0;

789 } i‡(
u£_pﬁl
) {

791 
	`¢d_pcm_waô
(
ch™dÀ
, 1000);

792 } i‡(!
block
 && 
u¶ìp_vÆ
 > 0) {

793 
	`u¶ìp
(
u¶ìp_vÆ
);

795 i‡(
pos_dump
 || 
ªÆtime_check
) {

796 i‡(
sys_œãncy
 <= 0)

797 
ˇp_avaû
 = 
	`gë_avaû
(
ch™dÀ
);

798 
pbk_fûl
 = 
	`gë_avaû
(
ph™dÀ
);

799 i‡(
pbk_fûl
 >= 0)

800 
pbk_fûl
 = 
∂ayback_buf„r_size
 -Öbk_fill;

801 i‡(
ˇp_avaû
 > 
ˇp_avaû_max
)

802 
ˇp_avaû_max
 = 
ˇp_avaû
;

803 i‡(
pbk_fûl
 >0 &&Öbk_fû»< 
pbk_fûl_mö
)

804 
pbk_fûl_mö
 = 
pbk_fûl
;

805 i‡(
ªÆtime_check
) {

806 
diff
 = 
	`time°amp_diff_mi¸o
(&
t°amp_°¨t
);

807 
ˇp_pos
 = 
	`‰ames_to_mi¸o
(
‰ames_ö
 + 
ˇp_avaû
);

808 
pbk_pos
 = 
	`‰ames_to_mi¸o
(
‰ames_out
 - 
pbk_fûl
);

809 
	`¥ötf
("[%lldus] POS:Ö=%zd (min=%zd,Ñt=%lldus) c=%zd (max=%zd,Ñt=%lldus)\n",

810 
diff
, 
pbk_fûl
, 
pbk_fûl_mö
, 
pbk_pos
 - diff,

811 
ˇp_avaû
, 
ˇp_avaû_max
, 
ˇp_pos
 - 
diff
);

812 } i‡(
pos_dump
) {

813 
	`¥ötf
("POS:Ö=%zd (min=%zd), c=%zd (max=%zd)\n",

814 
pbk_fûl
, 
pbk_fûl_mö
, 
ˇp_avaû
, 
ˇp_avaû_max
);

817 i‡((
r
 = 
	`ªadbuf
(
ch™dÀ
, 
buf„r
, 
ˇp_avaû
, &
‰ames_ö
, &
ö_max
)) < 0)

818 
ok
 = 0;

820 i‡(
ef„˘
)

821 
	`≠∂yef„˘
(
buf„r
, 
r
);

822 i‡(
	`wrôebuf
(
ph™dÀ
, 
buf„r
, 
r
, &
‰ames_out
) < 0)

823 
ok
 = 0;

826 i‡(
ok
)

827 
	`¥ötf
("Success\n");

829 
	`¥ötf
("Failure\n");

830 
	`¥ötf
("Playback:\n");

831 
	`show°©
(
ph™dÀ
, 
‰ames_out
);

832 
	`¥ötf
("Capture:\n");

833 
	`show°©
(
ch™dÀ
, 
‰ames_ö
);

834 
	`showömax
(
ö_max
);

835 i‡(
p_t°amp
.
tv_£c
 =
c_t°amp
.tv_sec &&

836 
p_t°amp
.
tv_u£c
 =
c_t°amp
.tv_usec)

837 
	`¥ötf
("Hardware sync\n");

838 i‡(
ªÆtime_check
) {

839 
diff
 = 
	`time°amp_diff_mi¸o
(&
t°amp_°¨t
);

840 
mtime
 = 
	`‰ames_to_mi¸o
(
‰ames_ö
);

841 
	`¥ötf
("Eœp£dÑó»time: %Œdus\n", 
diff
);

842 
	`¥ötf
("Eœp£d devi˚Åime: %Œdus\n", 
mtime
);

843 
	`¥ötf
("Te°Åimêdif‡(devi˚ -Ñól): %Œdus\n", 
mtime
 - 
diff
);

845 
	`¢d_pcm_dr›
(
ch™dÀ
);

846 
	`¢d_pcm_n⁄block
(
ph™dÀ
, 0);

847 
	`¢d_pcm_døö
(
ph™dÀ
);

848 
	`¢d_pcm_n⁄block
(
ph™dÀ
, !
block
 ? 1 : 0);

849 i‡(
ok
) {

851 
	`¥ötf
("PlaybackÅime = %li.%i, RecordÅime = %li.%i, diff = %li\n",

852 ()
p_t°amp
.
tv_£c
,

853 ()
p_t°amp
.
tv_u£c
,

854 ()
c_t°amp
.
tv_£c
,

855 ()
c_t°amp
.
tv_u£c
,

856 
	`timediff
(
p_t°amp
, 
c_t°amp
));

860 
	`¢d_pcm_u∆ök
(
ch™dÀ
);

861 
	`¢d_pcm_hw_‰ì
(
ph™dÀ
);

862 
	`¢d_pcm_hw_‰ì
(
ch™dÀ
);

864 
	`¢d_pcm_˛o£
(
ph™dÀ
);

865 
	`¢d_pcm_˛o£
(
ch™dÀ
);

866 
	`¢d_ouçut_˛o£
(
ouçut
);

867 
	`¢d_c⁄fig_upd©e_‰ì_globÆ
();

868 
	`‰ì
(
buf„r
);

869 
	`‰ì
(
pdevi˚
);

870 
	`‰ì
(
cdevi˚
);

872 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/lsb/config.c

1 
	~<°dlib.h
>

2 
	~<°rög.h
>

3 
	~<î∫o.h
>

4 
	~"ã°.h
"

6 
c⁄figs_equÆ
(
¢d_c⁄fig_t
 *
c1
, snd_c⁄fig_à*
c2
);

9 
	$sub£t_of
(
¢d_c⁄fig_t
 *
c1
, snd_c⁄fig_à*
c2
)

11 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

12 
¢d_c⁄fig_t
 *
e1
, *
e2
;

13 c⁄° *
id
;

15 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c1
) {

16 
e1
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

17 i‡(
	`¢d_c⁄fig_gë_id
(
e1
, &
id
) < 0 || !id)

19 i‡(
	`¢d_c⁄fig_£¨ch
(
c2
, 
id
, &
e2
) < 0)

21 i‡(!
	`c⁄figs_equÆ
(
e1
, 
e2
))

25 
	}
}

28 
	$c⁄figs_equÆ
(
¢d_c⁄fig_t
 *
c1
, snd_c⁄fig_à*
c2
)

30 
i1
, 
i2
;

31 
i641
, 
i642
;

32 c⁄° *
s1
, *
s2
;

34 i‡(
	`¢d_c⁄fig_gë_ty≥
(
c1
Ë!¢d_c⁄fig_gë_ty≥(
c2
))

36 
	`¢d_c⁄fig_gë_ty≥
(
c1
)) {

37 
SND_CONFIG_TYPE_INTEGER
:

38  
	`¢d_c⁄fig_gë_öãgî
(
c1
, &
i1
) >= 0 &&

39 
	`¢d_c⁄fig_gë_öãgî
(
c2
, &
i2
) >= 0 &&

40 
i1
 =
i2
;

41 
SND_CONFIG_TYPE_INTEGER64
:

42  
	`¢d_c⁄fig_gë_öãgî64
(
c1
, &
i641
) >= 0 &&

43 
	`¢d_c⁄fig_gë_öãgî64
(
c2
, &
i642
) >= 0 &&

44 
i641
 =
i642
;

45 
SND_CONFIG_TYPE_STRING
:

46  
	`¢d_c⁄fig_gë_°rög
(
c1
, &
s1
) >= 0 &&

47 
	`¢d_c⁄fig_gë_°rög
(
c2
, &
s2
) >= 0 &&

48 !
s1
 =!
s2
 &&

49 (!
s1
 || !
	`°rcmp
(s1, 
s2
));

50 
SND_CONFIG_TYPE_COMPOUND
:

51  
	`sub£t_of
(
c1
, 
c2
) && subset_of(c2, c1);

53 
	`Ârötf
(
°dîr
, "unknown configurationÇodeÅype %d\n",

54 ()
	`¢d_c⁄fig_gë_ty≥
(
c1
));

57 
	}
}

59 
	$ã°_t›
()

61 
¢d_c⁄fig_t
 *
t›
;

62 c⁄° *
id
;

64 i‡(
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
t›
)) < 0)

67 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_ty≥
(
t›
Ë=
SND_CONFIG_TYPE_COMPOUND
);

68 
	`TEST_CHECK
(
	`¢d_c⁄fig_ôî©‹_fú°
(
t›
Ë=
	`¢d_c⁄fig_ôî©‹_íd
(top));

69 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_id
(
t›
, &
id
Ë>0 && id =
NULL
);

71 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
t›
));

72 
	}
}

74 
	$ã°_lﬂd
()

76 c⁄° *
c⁄fig_ãxt1
 = "s='world';";

77 c⁄° *
c⁄fig_ãxt2
 = "c.elem 0";

78 
¢d_c⁄fig_t
 *
lﬂded
, *
made
, *
c
, *
c2
;

79 
¢d_öput_t
 *
öput
;

81 
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
lﬂded
));

82 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_öãgî
(&
c
, "i", 42));

83 
	`ALSA_CHECK
(
	`¢d_c⁄fig_add
(
lﬂded
, 
c
));

84 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_°rög
(&
c
, "s", "hello"));

85 
	`ALSA_CHECK
(
	`¢d_c⁄fig_add
(
lﬂded
, 
c
));

87 
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
made
));

88 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_°rög
(&
c
, "s", "world"));

89 
	`ALSA_CHECK
(
	`¢d_c⁄fig_add
(
made
, 
c
));

90 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_öãgî
(&
c
, "i", 42));

91 
	`ALSA_CHECK
(
	`¢d_c⁄fig_add
(
made
, 
c
));

93 
	`ALSA_CHECK
(
	`¢d_öput_buf„r_›í
(&
öput
, 
c⁄fig_ãxt1
, 
	`°æí
(config_text1)));

94 
	`ALSA_CHECK
(
	`¢d_c⁄fig_lﬂd
(
lﬂded
, 
öput
));

95 
	`ALSA_CHECK
(
	`¢d_öput_˛o£
(
öput
));

96 
	`TEST_CHECK
(
	`c⁄figs_equÆ
(
lﬂded
, 
made
));

98 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_compound
(&
c
, "c", 0));

99 
	`ALSA_CHECK
(
	`¢d_c⁄fig_add
(
made
, 
c
));

100 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_öãgî
(&
c2
, "elem", 0));

101 
	`ALSA_CHECK
(
	`¢d_c⁄fig_add
(
c
, 
c2
));

103 
	`ALSA_CHECK
(
	`¢d_öput_buf„r_›í
(&
öput
, 
c⁄fig_ãxt2
, 
	`°æí
(config_text2)));

104 
	`ALSA_CHECK
(
	`¢d_c⁄fig_lﬂd
(
lﬂded
, 
öput
));

105 
	`ALSA_CHECK
(
	`¢d_öput_˛o£
(
öput
));

106 
	`TEST_CHECK
(
	`c⁄figs_equÆ
(
lﬂded
, 
made
));

108 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
lﬂded
));

109 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
made
));

110 
	}
}

112 
	$ã°_ßve
()

114 c⁄° *
ãxt
 =

119 
¢d_c⁄fig_t
 *
‹ig
, *
ßved
;

120 
¢d_öput_t
 *
öput
;

121 
¢d_ouçut_t
 *
ouçut
;

122 *
buf
;

123 
size_t
 
buf_size
;

125 
	`ALSA_CHECK
(
	`¢d_öput_buf„r_›í
(&
öput
, 
ãxt
, 
	`°æí
(text)));

126 
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
‹ig
));

127 
	`ALSA_CHECK
(
	`¢d_c⁄fig_lﬂd
(
‹ig
, 
öput
));

128 
	`ALSA_CHECK
(
	`¢d_öput_˛o£
(
öput
));

129 
	`ALSA_CHECK
(
	`¢d_ouçut_buf„r_›í
(&
ouçut
));

130 
	`ALSA_CHECK
(
	`¢d_c⁄fig_ßve
(
‹ig
, 
ouçut
));

131 
buf_size
 = 
	`¢d_ouçut_buf„r_°rög
(
ouçut
, &
buf
);

132 
	`ALSA_CHECK
(
	`¢d_öput_buf„r_›í
(&
öput
, 
buf
, 
buf_size
));

133 
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
ßved
));

134 
	`ALSA_CHECK
(
	`¢d_c⁄fig_lﬂd
(
ßved
, 
öput
));

135 
	`ALSA_CHECK
(
	`¢d_öput_˛o£
(
öput
));

136 
	`ALSA_CHECK
(
	`¢d_ouçut_˛o£
(
ouçut
));

137 
	`TEST_CHECK
(
	`c⁄figs_equÆ
(
‹ig
, 
ßved
));

138 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
‹ig
));

139 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
ßved
));

140 
	}
}

142 
	$ã°_upd©e
()

144 
	`ALSA_CHECK
(
	`¢d_c⁄fig_upd©e_‰ì_globÆ
());

145 
	`TEST_CHECK
(
¢d_c⁄fig
 =
NULL
);

146 
	`ALSA_CHECK
(
	`¢d_c⁄fig_upd©e
());

147 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_ty≥
(
¢d_c⁄fig
Ë=
SND_CONFIG_TYPE_COMPOUND
);

148 
	`ALSA_CHECK
(
	`¢d_c⁄fig_upd©e
());

149 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_ty≥
(
¢d_c⁄fig
Ë=
SND_CONFIG_TYPE_COMPOUND
);

150 
	`ALSA_CHECK
(
	`¢d_c⁄fig_upd©e_‰ì_globÆ
());

151 
	`TEST_CHECK
(
¢d_c⁄fig
 =
NULL
);

152 
	}
}

154 
	$ã°_£¨ch
()

156 c⁄° *
ãxt
 =

164 
¢d_öput_t
 *
öput
;

165 
¢d_c⁄fig_t
 *
t›
, *
c
;

166 c⁄° *
id
;

168 
	`ALSA_CHECK
(
	`¢d_öput_buf„r_›í
(&
öput
, 
ãxt
, 
	`°æí
(text)));

169 
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
t›
));

170 
	`ALSA_CHECK
(
	`¢d_c⁄fig_lﬂd
(
t›
, 
öput
));

171 
	`ALSA_CHECK
(
	`¢d_öput_˛o£
(
öput
));

173 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£¨ch
(
t›
, "a", &
c
));

174 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_id
(
c
, &
id
));

175 
	`TEST_CHECK
(!
	`°rcmp
(
id
, "a"));

176 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£¨ch
(
t›
, "b.d.e", &
c
));

177 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_id
(
c
, &
id
));

178 
	`TEST_CHECK
(!
	`°rcmp
(
id
, "e"));

179 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£¨ch
(
t›
, "b.c", 
NULL
));

180 
	`TEST_CHECK
(
	`¢d_c⁄fig_£¨ch
(
t›
, "x", 
NULL
Ë=-
ENOENT
);

181 
	`TEST_CHECK
(
	`¢d_c⁄fig_£¨ch
(
t›
, "b.y", &
c
Ë=-
ENOENT
);

182 
	`TEST_CHECK
(
	`¢d_c⁄fig_£¨ch
(
t›
, "a.z", &
c
Ë=-
ENOENT
);

184 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
t›
));

185 
	}
}

187 
	$ã°_£¨chv
()

189 c⁄° *
ãxt
 =

197 
¢d_öput_t
 *
öput
;

198 
¢d_c⁄fig_t
 *
t›
, *
c
;

199 c⁄° *
id
;

201 
	`ALSA_CHECK
(
	`¢d_öput_buf„r_›í
(&
öput
, 
ãxt
, 
	`°æí
(text)));

202 
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
t›
));

203 
	`ALSA_CHECK
(
	`¢d_c⁄fig_lﬂd
(
t›
, 
öput
));

204 
	`ALSA_CHECK
(
	`¢d_öput_˛o£
(
öput
));

206 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£¨chv
(
t›
, &
c
, "a", 
NULL
));

207 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_id
(
c
, &
id
));

208 
	`TEST_CHECK
(!
	`°rcmp
(
id
, "a"));

209 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£¨chv
(
t›
, &
c
, "b", "d.e", 
NULL
));

210 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_id
(
c
, &
id
));

211 
	`TEST_CHECK
(!
	`°rcmp
(
id
, "e"));

212 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£¨chv
(
t›
, 
NULL
, "b.c", NULL));

213 
	`TEST_CHECK
(
	`¢d_c⁄fig_£¨chv
(
t›
, 
NULL
, "x", NULLË=-
ENOENT
);

214 
	`TEST_CHECK
(
	`¢d_c⁄fig_£¨chv
(
t›
, &
c
, "b.y", 
NULL
Ë=-
ENOENT
);

215 
	`TEST_CHECK
(
	`¢d_c⁄fig_£¨chv
(
t›
, &
c
, "a", "z", 
NULL
Ë=-
ENOENT
);

217 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
t›
));

218 
	}
}

220 
	$ã°_add
()

222 
¢d_c⁄fig_t
 *
c1
, *
c2
, *
c3
, *
c4
, *
c5
;

223 
¢d_c⁄fig_ôî©‹_t
 
i
;

224 
cou¡
 = 0;

226 
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
c1
));

227 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_öãgî
(&
c2
, "c2", 0xc2));

228 
	`ALSA_CHECK
(
	`¢d_c⁄fig_add
(
c1
, 
c2
));

229 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_°rög
(&
c3
, "c3", "c3"));

230 
	`ALSA_CHECK
(
	`¢d_c⁄fig_add
(
c1
, 
c3
));

231 
i
 = 
	`¢d_c⁄fig_ôî©‹_fú°
(
c1
);

232 
i
 !
	`¢d_c⁄fig_ôî©‹_íd
(
c1
);

233 
i
 = 
	`¢d_c⁄fig_ôî©‹_√xt
(i))

234 ++
cou¡
;

235 
	`TEST_CHECK
(
cou¡
 == 2);

236 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£¨ch
(
c1
, "c2", &
c2
));

237 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£¨ch
(
c1
, "c3", &
c3
));

238 
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
c4
));

239 
	`TEST_CHECK
(
	`¢d_c⁄fig_add
(
c1
, 
c4
Ë=-
EINVAL
);

240 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_öãgî
(&
c5
, "c5", 5));

241 
	`ALSA_CHECK
(
	`¢d_c⁄fig_add
(
c4
, 
c5
));

242 
	`TEST_CHECK
(
	`¢d_c⁄fig_add
(
c1
, 
c5
Ë=-
EINVAL
);

243 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c4
));

244 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_öãgî
(&
c3
, "c3", 333));

245 
	`TEST_CHECK
(
	`¢d_c⁄fig_add
(
c1
, 
c3
Ë=-
EEXIST
);

246 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c3
));

247 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c1
));

248 
	}
}

250 
	$ã°_dñëe
()

252 
¢d_c⁄fig_t
 *
c
;

254 
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
c
));

255 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

256 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_°rög
(&
c
, "s", "..."));

257 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

258 
	}
}

260 
	$ã°_c›y
()

262 
¢d_c⁄fig_t
 *
c1
, *
c2
, *
c3
;

263 
vÆue
;

265 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_öãgî
(&
c1
, "c1", 123));

266 
	`ALSA_CHECK
(
	`¢d_c⁄fig_c›y
(&
c2
, 
c1
));

267 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£t_öãgî
(
c1
, 456));

268 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_ty≥
(
c2
Ë=
SND_CONFIG_TYPE_INTEGER
);

269 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_öãgî
(
c2
, &
vÆue
));

270 
	`TEST_CHECK
(
vÆue
 == 123);

271 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c1
));

272 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c2
));

273 
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
c1
));

274 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_öãgî
(&
c2
, "a", 1));

275 
	`ALSA_CHECK
(
	`¢d_c⁄fig_add
(
c1
, 
c2
));

276 
	`ALSA_CHECK
(
	`¢d_c⁄fig_c›y
(&
c3
, 
c1
));

277 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£t_öãgî
(
c2
, 2));

278 
	`TEST_CHECK
(!
	`c⁄figs_equÆ
(
c1
, 
c3
));

279 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£¨ch
(
c3
, "a", &
c2
));

280 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£t_öãgî
(
c2
, 2));

281 
	`TEST_CHECK
(
	`c⁄figs_equÆ
(
c1
, 
c3
));

282 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c1
));

283 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c3
));

284 
	}
}

286 
	$ã°_make_öãgî
()

288 
¢d_c⁄fig_t
 *
c
;

289 c⁄° *
id
;

290 
vÆue
;

292 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_öãgî
(&
c
, "i"));

293 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_ty≥
(
c
Ë=
SND_CONFIG_TYPE_INTEGER
);

294 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_id
(
c
, &
id
));

295 
	`TEST_CHECK
(!
	`°rcmp
(
id
, "i"));

296 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_öãgî
(
c
, &
vÆue
));

297 
	`TEST_CHECK
(
vÆue
 == 0);

298 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

299 
	}
}

301 
	$ã°_make_öãgî64
()

303 
¢d_c⁄fig_t
 *
c
;

304 c⁄° *
id
;

305 
vÆue
;

307 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_öãgî64
(&
c
, "i"));

308 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_ty≥
(
c
Ë=
SND_CONFIG_TYPE_INTEGER64
);

309 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_id
(
c
, &
id
));

310 
	`TEST_CHECK
(!
	`°rcmp
(
id
, "i"));

311 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_öãgî64
(
c
, &
vÆue
));

312 
	`TEST_CHECK
(
vÆue
 == 0);

313 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

314 
	}
}

316 
	$ã°_make_°rög
()

318 
¢d_c⁄fig_t
 *
c
;

319 c⁄° *
id
;

320 c⁄° *
vÆue
;

322 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_°rög
(&
c
, "s"));

323 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_ty≥
(
c
Ë=
SND_CONFIG_TYPE_STRING
);

324 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_id
(
c
, &
id
));

325 
	`TEST_CHECK
(!
	`°rcmp
(
id
, "s"));

326 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_°rög
(
c
, &
vÆue
));

327 
	`TEST_CHECK
(
vÆue
 =
NULL
);

328 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

329 
	}
}

331 
	$ã°_make_compound
()

333 
¢d_c⁄fig_t
 *
c
;

334 c⁄° *
id
;

336 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_compound
(&
c
, "c", 0));

337 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_ty≥
(
c
Ë=
SND_CONFIG_TYPE_COMPOUND
);

338 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_id
(
c
, &
id
));

339 
	`TEST_CHECK
(!
	`°rcmp
(
id
, "c"));

340 
	`TEST_CHECK
(
	`¢d_c⁄fig_ôî©‹_fú°
(
c
Ë=
	`¢d_c⁄fig_ôî©‹_íd
(c));

341 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

342 
	}
}

344 
	$ã°_imake_öãgî
()

346 
¢d_c⁄fig_t
 *
c
;

347 c⁄° *
id
;

348 
vÆue
;

350 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_öãgî
(&
c
, "i", 123));

351 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_ty≥
(
c
Ë=
SND_CONFIG_TYPE_INTEGER
);

352 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_id
(
c
, &
id
));

353 
	`TEST_CHECK
(!
	`°rcmp
(
id
, "i"));

354 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_öãgî
(
c
, &
vÆue
));

355 
	`TEST_CHECK
(
vÆue
 == 123);

356 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

357 
	}
}

359 
	$ã°_imake_öãgî64
()

361 
¢d_c⁄fig_t
 *
c
;

362 c⁄° *
id
;

363 
vÆue
;

365 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_öãgî64
(&
c
, "i", 123456789012345LL));

366 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_ty≥
(
c
Ë=
SND_CONFIG_TYPE_INTEGER64
);

367 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_id
(
c
, &
id
));

368 
	`TEST_CHECK
(!
	`°rcmp
(
id
, "i"));

369 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_öãgî64
(
c
, &
vÆue
));

370 
	`TEST_CHECK
(
vÆue
 == 123456789012345LL);

371 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

372 
	}
}

374 
	$ã°_imake_°rög
()

376 
¢d_c⁄fig_t
 *
c
;

377 c⁄° *
id
;

378 c⁄° *
vÆue
;

380 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_°rög
(&
c
, "s", "xyzzy"));

381 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_ty≥
(
c
Ë=
SND_CONFIG_TYPE_STRING
);

382 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_id
(
c
, &
id
));

383 
	`TEST_CHECK
(!
	`°rcmp
(
id
, "s"));

384 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_°rög
(
c
, &
vÆue
));

385 
	`TEST_CHECK
(!
	`°rcmp
(
vÆue
, "xyzzy"));

386 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

387 
	}
}

389 
	$ã°_gë_ty≥
()

391 
¢d_c⁄fig_t
 *
c
;

393 
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
c
));

394 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_ty≥
(
c
Ë=
SND_CONFIG_TYPE_COMPOUND
);

395 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

396 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_öãgî
(&
c
, "i"));

397 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_ty≥
(
c
Ë=
SND_CONFIG_TYPE_INTEGER
);

398 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

399 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_°rög
(&
c
, "s"));

400 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_ty≥
(
c
Ë=
SND_CONFIG_TYPE_STRING
);

401 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

402 
	}
}

404 
	$ã°_£t_öãgî
()

406 
¢d_c⁄fig_t
 *
c
;

407 
vÆue
;

409 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_öãgî
(&
c
, "i"));

410 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£t_öãgî
(
c
, 123));

411 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_öãgî
(
c
, &
vÆue
));

412 
	`TEST_CHECK
(
vÆue
 == 123);

413 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

414 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_°rög
(&
c
, "s"));

415 
	`TEST_CHECK
(
	`¢d_c⁄fig_£t_öãgî
(
c
, 123Ë=-
EINVAL
);

416 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

417 
	}
}

419 
	$ã°_£t_öãgî64
()

421 
¢d_c⁄fig_t
 *
c
;

422 
vÆue
;

424 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_öãgî64
(&
c
, "i"));

425 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£t_öãgî64
(
c
, 123456789012345LL));

426 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_öãgî64
(
c
, &
vÆue
));

427 
	`TEST_CHECK
(
vÆue
 == 123456789012345LL);

428 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

429 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_°rög
(&
c
, "s"));

430 
	`TEST_CHECK
(
	`¢d_c⁄fig_£t_öãgî64
(
c
, 123Ë=-
EINVAL
);

431 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

432 
	}
}

434 
	$ã°_£t_°rög
()

436 
¢d_c⁄fig_t
 *
c
;

437 c⁄° *
vÆue
;

439 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_°rög
(&
c
, "s"));

440 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£t_°rög
(
c
, "string"));

441 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_°rög
(
c
, &
vÆue
));

442 
	`TEST_CHECK
(!
	`°rcmp
(
vÆue
, "string"));

443 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£t_°rög
(
c
, 
NULL
));

444 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_°rög
(
c
, &
vÆue
));

445 
	`TEST_CHECK
(
vÆue
 =
NULL
);

446 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

447 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_öãgî
(&
c
, "i"));

448 
	`TEST_CHECK
(
	`¢d_c⁄fig_£t_°rög
(
c
, ""Ë=-
EINVAL
);

449 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

450 
	}
}

452 
	$ã°_£t_ascii
()

454 
¢d_c⁄fig_t
 *
c
;

455 c⁄° *
s
;

456 
i
;

458 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_°rög
(&
c
, "s"));

459 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£t_ascii
(
c
, "foo"));

460 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_°rög
(
c
, &
s
));

461 
	`TEST_CHECK
(!
	`°rcmp
(
s
, "foo"));

462 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

463 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_öãgî
(&
c
, "i"));

464 
	`ALSA_CHECK
(
	`¢d_c⁄fig_£t_ascii
(
c
, "23"));

465 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_öãgî
(
c
, &
i
));

466 
	`TEST_CHECK
(
i
 == 23);

467 
	`TEST_CHECK
(
	`¢d_c⁄fig_£t_ascii
(
c
, "hÆ‡blue"Ë=-
EINVAL
);

468 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

469 
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
c
));

470 
	`TEST_CHECK
(
	`¢d_c⁄fig_£t_ascii
(
c
, "0"Ë=-
EINVAL
);

471 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

472 
	}
}

474 
	$ã°_gë_id
()

476 
¢d_c⁄fig_t
 *
c
;

477 c⁄° *
id
;

479 
	`ALSA_CHECK
(
	`¢d_c⁄fig_make_öãgî
(&
c
, "my_id"));

480 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_id
(
c
, &
id
));

481 
	`TEST_CHECK
(!
	`°rcmp
(
id
, "my_id"));

482 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

483 
	}
}

485 
	#ã°_gë_öãgî
 
ã°_£t_öãgî


	)

486 
	#ã°_gë_öãgî64
 
ã°_£t_öãgî64


	)

487 
	#ã°_gë_°rög
 
ã°_£t_°rög


	)

489 
	$ã°_gë_ascii
()

491 
¢d_c⁄fig_t
 *
c
;

492 *
vÆue
;

494 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_öãgî
(&
c
, "i", 123));

495 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_ascii
(
c
, &
vÆue
));

496 
	`TEST_CHECK
(!
	`°rcmp
(
vÆue
, "123"));

497 
	`‰ì
(
vÆue
);

498 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

499 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_°rög
(&
c
, "s", "bar"));

500 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_ascii
(
c
, &
vÆue
));

501 
	`TEST_CHECK
(!
	`°rcmp
(
vÆue
, "bar"));

502 
	`‰ì
(
vÆue
);

503 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

504 
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
c
));

505 
	`TEST_CHECK
(
	`¢d_c⁄fig_gë_ascii
(
c
, &
vÆue
Ë=-
EINVAL
);

506 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

507 
	}
}

509 
	$ã°_ôî©‹s
()

511 
¢d_c⁄fig_t
 *
c
, *
c2
;

512 
¢d_c⁄fig_ôî©‹_t
 
i
;

513 
v
;

515 
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
c
));

516 
i
 = 
	`¢d_c⁄fig_ôî©‹_fú°
(
c
);

517 
	`TEST_CHECK
(
i
 =
	`¢d_c⁄fig_ôî©‹_íd
(
c
));

518 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_öãgî
(&
c2
, "one", 1));

519 
	`ALSA_CHECK
(
	`¢d_c⁄fig_add
(
c
, 
c2
));

520 
i
 = 
	`¢d_c⁄fig_ôî©‹_fú°
(
c
);

521 
	`TEST_CHECK
(
i
 !
	`¢d_c⁄fig_ôî©‹_íd
(
c
));

522 
c2
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

523 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_öãgî
(
c2
, &
v
));

524 
	`TEST_CHECK
(
v
 == 1);

525 
i
 = 
	`¢d_c⁄fig_ôî©‹_√xt
(i);

526 
	`TEST_CHECK
(
i
 =
	`¢d_c⁄fig_ôî©‹_íd
(
c
));

527 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

528 
	}
}

530 
	$ã°_f‹_óch
()

532 
¢d_c⁄fig_t
 *
c
, *
c2
;

533 
¢d_c⁄fig_ôî©‹_t
 
i
, 
√xt
;

534 
v
;

535 
cou¡
 = 0;

537 
	`ALSA_CHECK
(
	`¢d_c⁄fig_t›
(&
c
));

538 
	`ALSA_CHECK
(
	`¢d_c⁄fig_imake_öãgî
(&
c2
, "one", 1));

539 
	`ALSA_CHECK
(
	`¢d_c⁄fig_add
(
c
, 
c2
));

540 
	`¢d_c⁄fig_f‹_óch
(
i
, 
√xt
, 
c
) {

541 
	`TEST_CHECK
(
i
 !
	`¢d_c⁄fig_ôî©‹_íd
(
c
));

542 
c2
 = 
	`¢d_c⁄fig_ôî©‹_íåy
(
i
);

543 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_öãgî
(
c2
, &
v
));

544 
	`TEST_CHECK
(
v
 == 1);

545 ++
cou¡
;

547 
	`TEST_CHECK
(
cou¡
 == 1);

548 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
c
));

549 
	}
}

551 
	$_ex∑nd_f˙
(
¢d_c⁄fig_t
 **
d°
, c⁄° *
s
, *
¥iv©e_d©a
 
ATTRIBUTE_UNUSED
)

553 i‡(
	`°rcmp
(
s
, "var10") == 0)

554  
	`¢d_c⁄fig_imake_öãgî
(
d°
, 
NULL
, 10);

555 i‡(
	`°rcmp
(
s
, "var50") == 0)

556  
	`¢d_c⁄fig_imake_öãgî
(
d°
, 
NULL
, 50);

557  
	`¢d_c⁄fig_imake_°rög
(
d°
, 
NULL
, "");

558 
	}
}

560 
	$ã°_evÆu©e_°rög
()

563 c⁄° *
ex¥
;

564 
ªsu…
;

565 } *
p
, 
e
[] = {

566 { .
ex¥
 = "$v¨10", .
ªsu…
 = 10 },

567 { .
ex¥
 = "$v¨50", .
ªsu…
 = 50 },

568 { .
ex¥
 = "$[1+1]", .
ªsu…
 = 2 },

569 { .
ex¥
 = "$[10-5]", .
ªsu…
 = 5 },

570 { .
ex¥
 = "$[10*5]", .
ªsu…
 = 50 },

571 { .
ex¥
 = "$[15/5]", .
ªsu…
 = 3 },

572 { .
ex¥
 = "$[12%5]", .
ªsu…
 = 2 },

573 { .
ex¥
 = "$[0xØ|0x55]", .
ªsu…
 = 0xff },

574 { .
ex¥
 = "$[0xff&0xfc]", .
ªsu…
 = 0xfc },

575 { .
ex¥
 = "$[4294967296+10]", .
ªsu…
 = 4294967306LL },

576 { .
ex¥
 = "$[$v¨10+1]", .
ªsu…
 = 11 },

577 { .
ex¥
 = "$[$v¨10 + $v¨50]", .
ªsu…
 = 60 },

578 { .
ex¥
 = "$[ $v¨10 + $[ $v¨50 + 10 ] ]", .
ªsu…
 = 70 },

579 { .
ex¥
 = "$[ ( $v¨10 + ( $v¨50 + 112 ) ) + 5 ]", .
ªsu…
 = 177 },

580 { .
ex¥
 = 
NULL
, .
ªsu…
 = 0 },

582 
¢d_c⁄fig_t
 *
d°
;

583 
l
;

584 
Œ
;

586 
p
 = 
e
;Ö->
ex¥
;Ö++) {

587 
	`ALSA_CHECK
(
	`¢d_c⁄fig_evÆu©e_°rög
(&
d°
, 
p
->
ex¥
, 
_ex∑nd_f˙
, 
NULL
));

588 i‡(
	`¢d_c⁄fig_gë_ty≥
(
d°
Ë=
SND_CONFIG_TYPE_INTEGER
) {

589 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_öãgî
(
d°
, &
l
));

590 
	`TEST_CHECK
(
l
 =
p
->
ªsu…
);

591 } i‡(
	`¢d_c⁄fig_gë_ty≥
(
d°
Ë=
SND_CONFIG_TYPE_INTEGER64
) {

592 
	`ALSA_CHECK
(
	`¢d_c⁄fig_gë_öãgî64
(
d°
, &
Œ
));

593 
	`TEST_CHECK
(
Œ
 =
p
->
ªsu…
);

595 
	`ALSA_CHECK
(0);

597 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
d°
));

599 
	}
}

601 
	$ã°_lﬂd_°rög
()

603 c⁄° **
cfg
, *
c⁄figs
[] = {

607 
NULL


609 
¢d_c⁄fig_t
 *
d°
;

611 
cfg
 = 
c⁄figs
; *cfg; cfg++) {

612 
	`ALSA_CHECK
(
	`¢d_c⁄fig_lﬂd_°rög
(&
d°
, *
cfg
, 0));

613 
	`ALSA_CHECK
(
	`¢d_c⁄fig_dñëe
(
d°
));

615 
	}
}

617 
	$maö
()

619 
	`ã°_t›
();

620 
	`ã°_lﬂd
();

621 
	`ã°_ßve
();

622 
	`ã°_upd©e
();

623 
	`ã°_£¨ch
();

624 
	`ã°_£¨chv
();

625 
	`ã°_add
();

626 
	`ã°_dñëe
();

627 
	`ã°_c›y
();

628 
	`ã°_make_öãgî
();

629 
	`ã°_make_öãgî64
();

630 
	`ã°_make_°rög
();

631 
	`ã°_make_compound
();

632 
	`ã°_imake_öãgî
();

633 
	`ã°_imake_öãgî64
();

634 
	`ã°_imake_°rög
();

635 
	`ã°_gë_ty≥
();

636 
	`ã°_£t_öãgî
();

637 
	`ã°_£t_öãgî64
();

638 
	`ã°_£t_°rög
();

639 
	`ã°_£t_ascii
();

640 
	`ã°_gë_id
();

641 
	`ã°_gë_öãgî
();

642 
	`ã°_gë_öãgî64
();

643 
	`ã°_gë_°rög
();

644 
	`ã°_gë_ascii
();

645 
	`ã°_ôî©‹s
();

646 
	`ã°_f‹_óch
();

647 
	`ã°_evÆu©e_°rög
();

648 
	`ã°_lﬂd_°rög
();

649  
	`TEST_EXIT_CODE
();

650 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/lsb/midi_event.c

1 
	~<°dlib.h
>

2 
	~<°rög.h
>

3 
	~<î∫o.h
>

4 
	~<ªgex.h
>

5 
	~"ã°.h
"

11 
	$midi_m©ches_ªgex
(*
midi
, 
cou¡
, c⁄° *
ªgex
)

13 *
ãxt
;

14 
ªgex_t
 
ª
;

15 
ªgm©ch_t
 
m©ch
;

16 
i
;

18 
ãxt
 = 
	`mÆloc
(2 * 
cou¡
 + 1);

19 i‡(!
ãxt
)

21 
i
 = 0; i < 
cou¡
; ++i)

22 
	`•rötf
(
ãxt
 + 2 * 
i
, "%02x", 
midi
[i]);

23 i‡(
	`ªgcomp
(&
ª
, 
ªgex
, 
REG_EXTENDED
) != 0) {

24 
	`‰ì
(
ãxt
);

27 
i
 = 
	`ªgexec
(&
ª
, 
ãxt
, 1, &
m©ch
, 0);

28 
i
 = i =0 && 
m©ch
.
rm_so
 =0 && m©ch.
rm_eo
 =
	`°æí
(
ãxt
);

29 
	`ªg‰ì
(&
ª
);

30 
	`‰ì
(
ãxt
);

31  
i
;

32 
	}
}

34 
	$ã°_decode
()

36 
¢d_midi_evít_t
 *
midi_evít
;

37 
¢d_£q_evít_t
 
ev
;

38 
buf
[50];

39 
cou¡
;

41 i‡(
	`ALSA_CHECK
(
	`¢d_midi_evít_√w
(256 , &
midi_evít
)) < 0)

44 
	#DECODE
(Ë
	`¢d_midi_evít_decode
(
midi_evít
, 
buf
, (buf), &
ev
)

	)

45 
	#BUF_MATCHES
(
°r
Ë
	`midi_m©ches_ªgex
(
buf
, 
cou¡
, så)

	)

46 
	#DECODES_TO
(
°r
Ë((
cou¡
 = 
	`DECODE
()), 
	`BUF_MATCHES
(°r))

	)

48 
	`¢d_£q_ev_˛ór
(&
ev
);

50 
	`¢d_£q_ev_£t_fixed
(&
ev
);

51 
ev
.
ty≥
 = 
SND_SEQ_EVENT_NONE
;

52 
	`TEST_CHECK
(
	`DECODE
(Ë=-
ENOENT
);

54 
	`¢d_£q_ev_£t_nŸeoff
(&
ev
, 1, 2, 3);

55 
	`TEST_CHECK
(
	`DECODES_TO
("810203"));

57 
	`¢d_£q_ev_£t_nŸe⁄
(&
ev
, 4, 5, 6);

58 
	`TEST_CHECK
(
	`DECODES_TO
("940506"));

60 
	`¢d_£q_ev_£t_key¥ess
(&
ev
, 7, 8, 9);

61 
	`TEST_CHECK
(
	`DECODES_TO
("a70809"));

63 
	`¢d_£q_ev_£t_c⁄åﬁÀr
(&
ev
, 10, 11, 12);

64 
	`TEST_CHECK
(
	`DECODES_TO
("ba0b0c"));

66 
	`¢d_£q_ev_£t_pgmch™ge
(&
ev
, 13, 14);

67 
	`TEST_CHECK
(
	`DECODES_TO
("cd0e"));

69 
	`¢d_£q_ev_£t_ch™¥ess
(&
ev
, 15, 16);

70 
	`TEST_CHECK
(
	`DECODES_TO
("df10"));

72 
	`¢d_£q_ev_£t_pôchbíd
(&
ev
, 1, 0x222);

73 
	`TEST_CHECK
(
	`DECODES_TO
("e12244"));

75 
	`¢d_£q_ev_£t_sy£x
(&
ev
, 6, "\xf0\x7e\x7f\x06\x01\xf7");

76 
	`TEST_CHECK
(
	`DECODES_TO
("f07e7f0601f7"));

78 
	`¢d_£q_ev_£t_fixed
(&
ev
);

79 
ev
.
ty≥
 = 
SND_SEQ_EVENT_QFRAME
;

80 
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 = 3;

81 
	`TEST_CHECK
(
	`DECODES_TO
("f103"));

83 
ev
.
ty≥
 = 
SND_SEQ_EVENT_SONGPOS
;

84 
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 = 0x444;

85 
	`TEST_CHECK
(
	`DECODES_TO
("f24408"));

87 
ev
.
ty≥
 = 
SND_SEQ_EVENT_SONGSEL
;

88 
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 = 5;

89 
	`TEST_CHECK
(
	`DECODES_TO
("f305"));

91 
ev
.
ty≥
 = 
SND_SEQ_EVENT_TUNE_REQUEST
;

92 
	`TEST_CHECK
(
	`DECODES_TO
("f6"));

94 
ev
.
ty≥
 = 
SND_SEQ_EVENT_CLOCK
;

95 
	`TEST_CHECK
(
	`DECODES_TO
("f8"));

97 
ev
.
ty≥
 = 
SND_SEQ_EVENT_START
;

98 
	`TEST_CHECK
(
	`DECODES_TO
("fa"));

100 
ev
.
ty≥
 = 
SND_SEQ_EVENT_CONTINUE
;

101 
	`TEST_CHECK
(
	`DECODES_TO
("fb"));

103 
ev
.
ty≥
 = 
SND_SEQ_EVENT_STOP
;

104 
	`TEST_CHECK
(
	`DECODES_TO
("fc"));

106 
ev
.
ty≥
 = 
SND_SEQ_EVENT_SENSING
;

107 
	`TEST_CHECK
(
	`DECODES_TO
("fe"));

109 
ev
.
ty≥
 = 
SND_SEQ_EVENT_RESET
;

110 
	`TEST_CHECK
(
	`DECODES_TO
("ff"));

112 
ev
.
ty≥
 = 
SND_SEQ_EVENT_CONTROL14
;

113 
ev
.
d©a
.
c⁄åﬁ
.
ch™√l
 = 6;

114 
ev
.
d©a
.
c⁄åﬁ
.
∑øm
 = 7;

115 
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 = 0x888;

120 
	`TEST_CHECK
(
	`DECODES_TO
("b6(0711(b6)?2708|2708(b6)?0711)"));

122 
ev
.
ty≥
 = 
SND_SEQ_EVENT_NONREGPARAM
;

123 
ev
.
d©a
.
c⁄åﬁ
.
ch™√l
 = 9;

124 
ev
.
d©a
.
c⁄åﬁ
.
∑øm
 = 0xaaa;

125 
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 = 0xbbb;

126 
	`TEST_CHECK
(
	`DECODES_TO
("b9(622a(b9)?6315|6315(b9)?622a)(b9)?(0617(b9)?263b|263b(b9)?0617)"));

128 
ev
.
ty≥
 = 
SND_SEQ_EVENT_REGPARAM
;

129 
ev
.
d©a
.
c⁄åﬁ
.
ch™√l
 = 12;

130 
ev
.
d©a
.
c⁄åﬁ
.
∑øm
 = 0xddd;

131 
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 = 0xeee;

132 
	`TEST_CHECK
(
	`DECODES_TO
("bc(645d(bc)?651b|651b(bc)?645d)(bc)?(061d(bc)?266e|266e(bc)?061d)"));

135 
	`¢d_£q_ev_£t_pgmch™ge
(&
ev
, 0, 0x11);

136 
	`TEST_CHECK
(
	`DECODES_TO
("c011"));

137 
	`¢d_£q_ev_£t_sy£x
(&
ev
, 6, "\xf0\x7e\x7f\x09\x02\xf7");

138 
	`TEST_CHECK
(
	`DECODES_TO
("f07e7f0902f7"));

139 
	`¢d_£q_ev_£t_pgmch™ge
(&
ev
, 0, 0x11);

140 
	`TEST_CHECK
(
	`DECODES_TO
("c011"));

143 
ev
.
ty≥
 = 
SND_SEQ_EVENT_QFRAME
;

144 
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 = 0x11;

145 
	`TEST_CHECK
(
	`DECODES_TO
("f111"));

146 
	`TEST_CHECK
(
	`DECODES_TO
("f111"));

149 
	`TEST_CHECK
(
	`¢d_midi_evít_decode
(
midi_evít
, 
buf
, 1, &
ev
Ë=-
ENOMEM
);

151 
	`¢d_midi_evít_‰ì
(
midi_evít
);

152 
	}
}

154 
	$ã°_ª£t_decode
()

156 
¢d_midi_evít_t
 *
midi_evít
;

157 
¢d_£q_evít_t
 
ev
;

158 
buf
[50];

159 
cou¡
;

161 i‡(
	`ALSA_CHECK
(
	`¢d_midi_evít_√w
(256 , &
midi_evít
)) < 0)

164 
	`¢d_£q_ev_˛ór
(&
ev
);

166 
	`¢d_£q_ev_£t_nŸe⁄
(&
ev
, 1, 2, 3);

167 
	`TEST_CHECK
(
	`DECODES_TO
("910203"));

169 
	`¢d_midi_evít_ª£t_decode
(
midi_evít
);

171 
	`TEST_CHECK
(
	`DECODES_TO
("910203"));

173 
	`¢d_midi_evít_‰ì
(
midi_evít
);

174 
	}
}

176 
	$ã°_ícode
()

178 
¢d_midi_evít_t
 *
midi_evít
;

179 
¢d_£q_evít_t
 
ev
;

181 i‡(
	`ALSA_CHECK
(
	`¢d_midi_evít_√w
(256, &
midi_evít
)) < 0)

184 
	#ENCODE
(
°r
Ë
	`¢d_midi_evít_ícode
(
midi_evít
, \

185 (c⁄° *)
°r
, \

186 (
°r
Ë- 1, &
ev
)

	)

187 
	`TEST_CHECK
(
	`ENCODE
("\x81\x02\x03") == 3);

188 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_NOTEOFF
);

189 
	`TEST_CHECK
((
ev
.
Êags
 & 
SND_SEQ_EVENT_LENGTH_MASK
Ë=
SND_SEQ_EVENT_LENGTH_FIXED
);

190 
	`TEST_CHECK
(
ev
.
d©a
.
nŸe
.
ch™√l
 == 1);

191 
	`TEST_CHECK
(
ev
.
d©a
.
nŸe
.note == 2);

192 
	`TEST_CHECK
(
ev
.
d©a
.
nŸe
.
vñocôy
 == 3);

194 
	`TEST_CHECK
(
	`ENCODE
("\x94\x05\x06") == 3);

195 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_NOTEON
);

196 
	`TEST_CHECK
(
ev
.
d©a
.
nŸe
.
ch™√l
 == 4);

197 
	`TEST_CHECK
(
ev
.
d©a
.
nŸe
.note == 5);

198 
	`TEST_CHECK
(
ev
.
d©a
.
nŸe
.
vñocôy
 == 6);

200 
	`TEST_CHECK
(
	`ENCODE
("\xa7\x08\x09") == 3);

201 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_KEYPRESS
);

202 
	`TEST_CHECK
(
ev
.
d©a
.
nŸe
.
ch™√l
 == 7);

203 
	`TEST_CHECK
(
ev
.
d©a
.
nŸe
.note == 8);

204 
	`TEST_CHECK
(
ev
.
d©a
.
nŸe
.
vñocôy
 == 9);

206 
	`TEST_CHECK
(
	`ENCODE
("\xba\x0b\x0c") == 3);

207 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_CONTROLLER
);

208 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
ch™√l
 == 10);

209 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
∑øm
 == 11);

210 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 == 12);

212 
	`TEST_CHECK
(
	`ENCODE
("\xcd\x0e") == 2);

213 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_PGMCHANGE
);

214 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
ch™√l
 == 13);

215 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 == 14);

217 
	`TEST_CHECK
(
	`ENCODE
("\xdf\x10") == 2);

218 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_CHANPRESS
);

219 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
ch™√l
 == 15);

220 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 == 16);

222 
	`TEST_CHECK
(
	`ENCODE
("\xe1\x22\x33") == 3);

223 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_PITCHBEND
);

224 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
ch™√l
 == 1);

225 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 == -1630);

227 
	`TEST_CHECK
(
	`ENCODE
("\xf0\x7f\x7f\x04\x01\x7f\x7f\xf7") == 8);

228 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_SYSEX
);

229 
	`TEST_CHECK
((
ev
.
Êags
 & 
SND_SEQ_EVENT_LENGTH_MASK
Ë=
SND_SEQ_EVENT_LENGTH_VARIABLE
);

230 
	`TEST_CHECK
(
ev
.
d©a
.
ext
.
Àn
 == 8);

231 
	`TEST_CHECK
(!
	`memcmp
(
ev
.
d©a
.
ext
.
±r
, "\xf0\x7f\x7f\x04\x01\x7f\x7f\xf7", 8));

233 
	`TEST_CHECK
(
	`ENCODE
("\xf1\x04") == 2);

234 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_QFRAME
);

235 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 == 4);

237 
	`TEST_CHECK
(
	`ENCODE
("\xf2\x55\x66") == 3);

238 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_SONGPOS
);

239 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 == 13141);

241 
	`TEST_CHECK
(
	`ENCODE
("\xf3\x07") == 2);

242 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_SONGSEL
);

243 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 == 7);

245 
	`TEST_CHECK
(
	`ENCODE
("\xf6") == 1);

246 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_TUNE_REQUEST
);

248 
	`TEST_CHECK
(
	`ENCODE
("\xf8") == 1);

249 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_CLOCK
);

251 
	`TEST_CHECK
(
	`ENCODE
("\xfa") == 1);

252 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_START
);

254 
	`TEST_CHECK
(
	`ENCODE
("\xfb") == 1);

255 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_CONTINUE
);

257 
	`TEST_CHECK
(
	`ENCODE
("\xfc") == 1);

258 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_STOP
);

260 
	`TEST_CHECK
(
	`ENCODE
("\xfe") == 1);

261 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_SENSING
);

263 
	`TEST_CHECK
(
	`ENCODE
("\xff") == 1);

264 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_RESET
);

266 
	`TEST_CHECK
(
	`ENCODE
("\xc1\xf8") == 2);

267 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_CLOCK
);

268 
	`TEST_CHECK
(
	`ENCODE
("\x22") == 1);

269 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_PGMCHANGE
);

270 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
ch™√l
 == 1);

271 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 == 0x22);

272 
	`TEST_CHECK
(
	`ENCODE
("\xf8") == 1);

273 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_CLOCK
);

274 
	`TEST_CHECK
(
	`ENCODE
("\x33") == 1);

275 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_PGMCHANGE
);

276 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
ch™√l
 == 1);

277 
	`TEST_CHECK
(
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 == 0x33);

279 
	`TEST_CHECK
(
	`ENCODE
("\xc1\xf6") == 2);

280 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_TUNE_REQUEST
);

281 
	`TEST_CHECK
(
	`ENCODE
("\x44\x44") == 2);

282 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_NONE
);

284 
	`¢d_midi_evít_‰ì
(
midi_evít
);

285 
	}
}

287 
	$ã°_ª£t_ícode
()

289 
¢d_midi_evít_t
 *
midi_evít
;

290 
¢d_£q_evít_t
 
ev
;

292 i‡(
	`ALSA_CHECK
(
	`¢d_midi_evít_√w
(256, &
midi_evít
)) < 0)

295 
	`TEST_CHECK
(
	`ENCODE
("\x91\x02") == 2);

296 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_NONE
);

298 
	`¢d_midi_evít_ª£t_ícode
(
midi_evít
);

300 
	`TEST_CHECK
(
	`ENCODE
("\x03") == 1);

301 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_NONE
);

303 
	`¢d_midi_evít_‰ì
(
midi_evít
);

304 
	}
}

306 
	$ã°_öô
()

308 
¢d_midi_evít_t
 *
midi_evít
;

309 
¢d_£q_evít_t
 
ev
;

310 
buf
[50];

311 
cou¡
;

313 i‡(
	`ALSA_CHECK
(
	`¢d_midi_evít_√w
(256, &
midi_evít
)) < 0)

316 
	`¢d_£q_ev_£t_nŸe⁄
(&
ev
, 1, 2, 3);

317 
	`TEST_CHECK
(
	`DECODES_TO
("910203"));

319 
	`TEST_CHECK
(
	`ENCODE
("\x94\x05") == 2);

320 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_NONE
);

322 
	`¢d_midi_evít_öô
(
midi_evít
);

324 
	`¢d_£q_ev_£t_nŸe⁄
(&
ev
, 1, 2, 3);

325 
	`TEST_CHECK
(
	`DECODES_TO
("910203"));

327 
	`TEST_CHECK
(
	`ENCODE
("\x06") == 1);

328 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_NONE
);

330 
	`¢d_midi_evít_‰ì
(
midi_evít
);

331 
	}
}

333 
	$ã°_ícode_byã
()

335 
¢d_midi_evít_t
 *
midi_evít
;

336 
¢d_£q_evít_t
 
ev
;

338 i‡(
	`ALSA_CHECK
(
	`¢d_midi_evít_√w
(256, &
midi_evít
)) < 0)

341 
	#ENCODE_BYTE
(
c
Ë
	`¢d_midi_evít_ícode_byã
(
midi_evít
, c, &
ev
)

	)

342 
	`TEST_CHECK
(
	`ENCODE_BYTE
(0x81) == 0);

343 
	`TEST_CHECK
(
	`ENCODE_BYTE
(0x02) == 0);

344 
	`TEST_CHECK
(
	`ENCODE_BYTE
(0x03) == 1);

345 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_NOTEOFF
);

346 
	`TEST_CHECK
((
ev
.
Êags
 & 
SND_SEQ_EVENT_LENGTH_MASK
Ë=
SND_SEQ_EVENT_LENGTH_FIXED
);

347 
	`TEST_CHECK
(
ev
.
d©a
.
nŸe
.
ch™√l
 == 1);

348 
	`TEST_CHECK
(
ev
.
d©a
.
nŸe
.note == 2);

349 
	`TEST_CHECK
(
ev
.
d©a
.
nŸe
.
vñocôy
 == 3);

350 
	`TEST_CHECK
(
	`ENCODE_BYTE
(0x04) == 0);

351 
	`TEST_CHECK
(
	`ENCODE_BYTE
(0xf8) == 1);

352 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_CLOCK
);

353 
	`TEST_CHECK
(
	`ENCODE_BYTE
(0x05) == 1);

354 
	`TEST_CHECK
(
ev
.
ty≥
 =
SND_SEQ_EVENT_NOTEOFF
);

355 
	`TEST_CHECK
(
ev
.
d©a
.
nŸe
.
ch™√l
 == 1);

356 
	`TEST_CHECK
(
ev
.
d©a
.
nŸe
.note == 4);

357 
	`TEST_CHECK
(
ev
.
d©a
.
nŸe
.
vñocôy
 == 5);

359 
	`¢d_midi_evít_‰ì
(
midi_evít
);

360 
	}
}

362 
	$maö
()

364 
	`ã°_decode
();

365 
	`ã°_ª£t_decode
();

366 
	`ã°_ícode
();

367 
	`ã°_ª£t_ícode
();

368 
	`ã°_ícode_byã
();

369 
	`ã°_öô
();

370  
	`TEST_EXIT_CODE
();

371 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/lsb/test.h

1 #i‚de‡
TEST_H_INCLUDED


2 
	#TEST_H_INCLUDED


	)

4 
	~<°dio.h
>

5 
	~<Æß/asoundlib.h
>

8 
	g™y_ã°_Áûed
;

10 
	#TEST_CHECK
(
c⁄d
) do \

11 i‡(!(
c⁄d
)) { \

12 
	`Ârötf
(
°dîr
, "%s:%d:Åe° faûed: %s\n", 
__FILE__
, 
__LINE__
, #cond); \

13 
™y_ã°_Áûed
 = 1; \

15 0)

	)

17 
	#ALSA_CHECK
(
‚
) ({ \

18 
îr
 = 
‚
; \

19 i‡(
îr
 < 0) { \

20 
	`Ârötf
(
°dîr
, "%s:%d: ALSA function call failed (%s): %s\n", \

21 
__FILE__
, 
__LINE__
, 
	`¢d_°ªº‹
(
îr
), #fn); \

22 
™y_ã°_Áûed
 = 1; \

24 
îr
; \

25 })

	)

27 
	#TEST_EXIT_CODE
(Ë
™y_ã°_Áûed


	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/midifile.c

52 
	#NO_LC_DEFINES


	)

53 
	~"midifûe.h
"

54 #ifde‡
NO_LC_DEFINES


55 
	#sy°em_ex˛usive
 0xf0

	)

56 
	#mëa_evít
 0xFF

	)

57 
	#£t_ãmpo
 0x51

	)

58 
	#lowîbyã
(
x
Ë(()(x & 0xff))

	)

59 
	#uµîbyã
(
x
Ë(()((x & 0xff00)>>8))

	)

62 
	#NULLFUNC
 0

	)

64 
	#NULL
 0

	)

67 
	#THINK


	)

69 #ifde‡
THINK


70 
	~<°dlib.h
>

73 
	~<°dio.h
>

74 
	~<limôs.h
>

76 
	~<°rög.h
>

82 (*
	gMf_gëc
Ë(Ë
NULLFUNC
;

83 (*
	gMf_îr‹
Ë(Ë
NULLFUNC
;

84 (*
	gMf_hódî
Ë(Ë
NULLFUNC
;

85 (*
	gMf_åack°¨t
Ë(Ë
NULLFUNC
;

86 (*
	gMf_åackíd
Ë(Ë
NULLFUNC
;

87 (*
	gMf_nŸe⁄
Ë(Ë
NULLFUNC
;

88 (*
	gMf_nŸeoff
Ë(Ë
NULLFUNC
;

89 (*
	gMf_¥essuª
Ë(Ë
NULLFUNC
;

90 (*
	gMf_∑ømëî
Ë(Ë
NULLFUNC
;

91 (*
	gMf_pôchbíd
Ë(Ë
NULLFUNC
;

92 (*
	gMf_¥ogøm
Ë(Ë
NULLFUNC
;

93 (*
	gMf_ch™¥essuª
Ë(Ë
NULLFUNC
;

94 (*
	gMf_sy£x
Ë(Ë
NULLFUNC
;

95 (*
	gMf_¨bôøry
Ë(Ë
NULLFUNC
;

96 (*
	gMf_mëamisc
Ë(Ë
NULLFUNC
;

97 (*
	gMf_£qnum
Ë(Ë
NULLFUNC
;

98 (*
	gMf_eŸ
Ë(Ë
NULLFUNC
;

99 (*
	gMf_sm±e
Ë(Ë
NULLFUNC
;

100 (*
	gMf_ãmpo
Ë(Ë
NULLFUNC
;

101 (*
	gMf_timesig
Ë(Ë
NULLFUNC
;

102 (*
	gMf_keysig
Ë(Ë
NULLFUNC
;

103 (*
	gMf_£q•ecific
Ë(Ë
NULLFUNC
;

104 (*
	gMf_ãxt
Ë(Ë
NULLFUNC
;

107 (*
	gMf_putc
Ë(Ë
NULLFUNC
;

108 (*
	gMf_wrôëøck
Ë(Ë
NULLFUNC
;

109 (*
	gMf_wrôëempŸøck
Ë(Ë
NULLFUNC
;

111 
	gMf_nomîge
 = 0;

113 
	gMf_öãø˘ive
 = 0;

114 
	gMf_cuºtime
 = 0L;

115 
	gMf_ªÆtime
 = 0L;

116 
	gMf_f_ªÆtime
 = 0;

117 
	gﬁd_f_ªÆtime
 = 0;

118 
	gMf_divisi⁄
 = 96;

119 
	gMf_cuºãmpo
 = 500000;

120 
	gﬁd_cuºãmpo
 = 500000;

121 
	gﬁd_ªÆtime
 = 0;

122 
	gﬁd_cuºtime
 = 0;

123 
	gªvi£d_time
 = 0;

124 
	gãmpo_ch™ge_time
 = 0;

126 
	#MAX_HISTORY
 512

	)

127 
	gãmpo_hi°‹y
[
MAX_HISTORY
];

128 
	gãmpo_hi°‹y_time
[
MAX_HISTORY
];

129 
	gãmpo_hi°‹y_cou¡
 = 0;

132 
	gMf_tobîód
 = 0L;

133 
	gMf_numbyãswrôãn
 = 0L;

135 
ªadv¨öum
 ();

136 
ªad32bô
 ();

137 
to32bô
 ();

138 
ªad16bô
 ();

139 
to16bô
 ();

140 *
msg
 ();

141 
ªadhódî
 ();

142 
ªadåack
 ();

143 
badbyã
 ();

144 
më´vít
 ();

145 
sy£x
 ();

146 
ch™mesßge
 ();

147 
msgöô
 ();

148 
msgÀng
 ();

149 
msgadd
 ();

150 
biggîmsg
 ();

151 
ïutc
 ();

153 
mf_ticks2£c
 (
ticks
, 
divisi⁄
, 
ãmpo
);

154 
mf_wrôe_mëa_evít
 ();

155 
mf_wrôe_ãmpo
 ();

156 
mf_wrôe_£qnum
 ();

157 
WrôeV¨Lí
 ();

159 #ifde‡
READ_MODS


160 
	~"mp_mod.c
"

161 
	gmod_fûe_Êag
 = 0;

163 
	gf‹˚_exô
;

166 
	$m‰ód
 ()

168 
f‹˚_exô
 = 0;

169 i‡(
Mf_gëc
 =
NULLFUNC
)

170 
	`m„º‹
 ("mfread() called without setting Mf_getc");

172 
	`ªadhódî
 ();

173 #ifde‡
READ_MODS


174 i‡(
mod_fûe_Êag
)

175 
	`do_moduÀ
();

178 
	`ªadåack
 (Ë&& !
f‹˚_exô
)

180 
	}
}

184 
	$midifûe
 ()

186 
	`m‰ód
 ();

187 
	}
}

191 
	$ªadmt
 (
s
)

192 *
s
;

194 
n
 = 0;

195 *
p
 = 
s
;

196 
c
;

198 
n
++ < 4 && (
c
 = (*
Mf_gëc
Ë()Ë!
EOF
)

200 i‡(
c
 !*
p
++)

202 
buff
[32];

203 i‡(!
c
Ë(
EOF
);

204 i‡(
c
 =0x1aË(
EOF
);

205 (Ë
	`°r˝y
 (
buff
, "expecting ");

206 (Ë
	`°rˇt
 (
buff
, 
s
);

207 
	`m„º‹
 (
buff
);

211  (
c
);

212 
	}
}

216 
	$egëc
 ()

218 
c
 = (*
Mf_gëc
) ();

220 i‡(
c
 =
EOF
) {

221 
	`m„º‹
 ("premature EOF");

222 
f‹˚_exô
 = 1;

224 
Mf_tobîód
--;

225  (
c
);

226 
	}
}

230 
	$ªadhódî
 ()

232 
f‹m©
, 
¡rks
, 
divisi⁄
;

235 
Mf_divisi⁄
 = 96;

236 
Mf_cuºãmpo
 = 500000;

237 
ﬁd_cuºãmpo
 = 500000;

238 
ãmpo_hi°‹y_cou¡
 = 0;

239 
ãmpo_hi°‹y
[
ãmpo_hi°‹y_cou¡
] = 
Mf_cuºãmpo
;

240 
ãmpo_hi°‹y_time
[
ãmpo_hi°‹y_cou¡
] = 0;

242 i‡(
Mf_öãø˘ive
)

244 
Mf_tobîód
 = 0;

245 
f‹m©
 = 0;

246 
¡rks
 = 1;

247 
divisi⁄
 = 96;

250 #ifde‡
READ_MODS


251 i‡(!
	`°∫cmp
(
Mf_fûe_c⁄ã¡s
, "MThd", 4))

254 i‡(
	`ªadmt
 ("MThd"Ë=
EOF
)

257 
Mf_tobîód
 = 
	`ªad32bô
 ();

258 
f‹m©
 = 
	`ªad16bô
 ();

259 
¡rks
 = 
	`ªad16bô
 ();

260 
Mf_divisi⁄
 = 
divisi⁄
 = 
	`ªad16bô
 ();

262 #ifde‡
READ_MODS


265 
f‹m©
 = 0;

266 
¡rks
 = 1;

267 
divisi⁄
 = 
Mf_divisi⁄
;

268 
Mf_tobîód
 = 0;

269 
mod_fûe_Êag
 = 1;

273 i‡(
Mf_hódî
)

274 (*
Mf_hódî
Ë(
f‹m©
, 
¡rks
, 
divisi⁄
);

277 
Mf_tobîód
 > 0 && !
f‹˚_exô
)

278 (Ë
	`egëc
 ();

279 
	}
}

285 
	$föd_ãmpo
()

287 
i
;

288 
ﬁd_ãmpo
 = 
Mf_cuºãmpo
;

289 
√w_ãmpo
 = 
Mf_cuºãmpo
;

291 
i
 = 0; i <
ãmpo_hi°‹y_cou¡
; i++) {

292 i‡(
ãmpo_hi°‹y_time
[
i
] <
Mf_cuºtime
Ë
ﬁd_ãmpo
 = 
ãmpo_hi°‹y
[i];

293 
√w_ãmpo
 = 
ãmpo_hi°‹y
[
i
];

294 i‡(
ãmpo_hi°‹y_time
[
i
] > 
ªvi£d_time
) ;

296 i‡(
i
 > 
ãmpo_hi°‹y_cou¡
 || 
ãmpo_hi°‹y_time
[i] > 
Mf_cuºtime
) {

297 #ifde‡
DEBUG_TIMES


298 
	`¥ötf
("[∑° %lu, old_ãmpÿ%lu]\n", 
ãmpo_hi°‹y_time
[
i
], 
ﬁd_ãmpo
);

300 
ªvi£d_time
 = 
Mf_cuºtime
;

301 (
ﬁd_ãmpo
);

303 
ãmpo_ch™ge_time
 = 
ªvi£d_time
 = 
ãmpo_hi°‹y_time
[
i
];

304 #ifde‡
DEBUG_TIMES


305 
	`¥ötf
("[ªvi£d_timê%lu,Çew_ãmpÿ%lu]\n", 
ªvi£d_time
, 
√w_ãmpo
);

307 (
√w_ãmpo
);

308 
	}
}

312 
	$ªadåack
 ()

317 
ch™ty≥
[] =

322 
lookf‹
;

323 
c
, 
c1
, 
ty≥
;

324 
sy£xc⁄töue
 = 0;

325 
ru¬ög
 = 0;

326 
°©us
 = 0;

327 
√eded
;

329 i‡(
Mf_öãø˘ive
)

331 
Mf_tobîód
 = 
INT_MAX
;

335 i‡(
	`ªadmt
 ("MTrk"Ë=
EOF
)

338 
Mf_tobîód
 = 
	`ªad32bô
 ();

340 
Mf_cuºtime
 = 
Mf_ªÆtime
 = 0;

341 
Mf_f_ªÆtime
 = 
ﬁd_f_ªÆtime
 = 0;

342 
ﬁd_cuºtime
 = 
ﬁd_ªÆtime
 = 0;

343 
Mf_cuºãmpo
 = 
	`föd_ãmpo
();

345 i‡(
Mf_åack°¨t
)

346 (*
Mf_åack°¨t
) ();

348 !
f‹˚_exô
 && (
Mf_öãø˘ive
 || 
Mf_tobîód
 > 0))

351 i‡(
Mf_öãø˘ive
)

352 
Mf_cuºtime
 += 1;

355 
dñè_£cs
;

356 
dñè_ticks
 = 
	`ªadv¨öum
 ();

357 
ªvi£d_time
 = 
Mf_cuºtime
;

358 
Mf_cuºtime
 +
dñè_ticks
;

365 
ªvi£d_time
 < 
Mf_cuºtime
) {

366 
ßve_time
 = 
ªvi£d_time
;

367 
ßve_ãmpo
 = 
Mf_cuºãmpo
;

368 
Mf_cuºãmpo
 = 
	`föd_ãmpo
();

370 i‡(
Mf_cuºãmpo
 !
ﬁd_cuºãmpo
) {

371 
ﬁd_cuºãmpo
 = 
Mf_cuºãmpo
;

372 
ﬁd_ªÆtime
 = 
Mf_ªÆtime
;

373 i‡(
ªvi£d_time
 !
ãmpo_ch™ge_time
) {

374 
ﬁd_f_ªÆtime
 = 
Mf_f_ªÆtime
;

375 
ﬁd_cuºtime
 = 
ßve_time
;

377 
dñè_£cs
 = 
	`mf_ticks2£c
 (
ªvi£d_time
-
ﬁd_cuºtime
, 
Mf_divisi⁄
, 
ßve_ãmpo
);

378 #ifde‡
DEBUG_TIMES


379 
	`¥ötf
("d(rev %lu - old %lu, div %d,Åempo %lu) = %.3f\n",

380 
ªvi£d_time
, 
ﬁd_cuºtime
, 
Mf_divisi⁄
, 
ßve_ãmpo
, 
dñè_£cs
 * 1600.0);

382 
Mf_f_ªÆtime
 = 
ﬁd_f_ªÆtime
 + 
dñè_£cs
 * 1600.0;

383 
Mf_ªÆtime
 = ()(0.5 + 
Mf_f_ªÆtime
);

384 #ifde‡
DEBUG_TIMES


385 
	`¥ötf
("\â=%luÅick†–%lu c£c/16 < old %.2‡+ %.2f)\n", 
Mf_cuºtime
, 
Mf_ªÆtime
,

386 
ﬁd_f_ªÆtime
, 
dñè_£cs
 * 1600.0);

388 i‡(
ªvi£d_time
 =
ãmpo_ch™ge_time
) {

389 
ﬁd_cuºtime
 = 
ªvi£d_time
;

390 
ﬁd_f_ªÆtime
 = 
Mf_f_ªÆtime
;

394 
dñè_£cs
 = 
	`mf_ticks2£c
 (
ªvi£d_time
-
ﬁd_cuºtime
, 
Mf_divisi⁄
, 
Mf_cuºãmpo
);

395 #ifde‡
DEBUG_TIMES


396 
	`¥ötf
("d(rev %lu - old %lu, div %d,Åempo %lu) = %.3f\n",

397 
ªvi£d_time
, 
ﬁd_cuºtime
, 
Mf_divisi⁄
, 
Mf_cuºãmpo
, 
dñè_£cs
 * 1600.0);

399 
Mf_f_ªÆtime
 = 
ﬁd_f_ªÆtime
 + 
dñè_£cs
 * 1600.0;

400 
Mf_ªÆtime
 = ()(0.5 + 
Mf_f_ªÆtime
);

401 #ifde‡
DEBUG_TIMES


402 
	`¥ötf
("\â=%luÅick†–%lu c£c/16 < old %.2‡+ %.2f)\n", 
Mf_cuºtime
, 
Mf_ªÆtime
,

403 
ﬁd_f_ªÆtime
, 
dñè_£cs
 * 1600.0);

411 
c
 = 
	`egëc
 ();

413 i‡(
sy£xc⁄töue
 && 
c
 != 0xf7)

414 
	`m„º‹
 ("didn't findÉxpected continuation ofá sysex");

416 i‡((
c
 & 0x80) == 0)

418 i‡(
°©us
 == 0)

419 
	`m„º‹
 ("unexpectedÑunning status");

420 
ru¬ög
 = 1;

424 
°©us
 = 
c
;

425 
ru¬ög
 = 0;

428 
√eded
 = 
ch™ty≥
[(
°©us
 >> 4) & 0xf];

430 i‡(
√eded
)

433 i‡(
ru¬ög
)

434 
c1
 = 
c
;

436 
c1
 = 
	`egëc
 ();

437 
	`ch™mesßge
 (
°©us
, 
c1
, (
√eded
 > 1Ë? 
	`egëc
 () : 0);

441 
c
)

446 
ty≥
 = 
	`egëc
 ();

447 
lookf‹
 = 
Mf_tobîód
 - 
	`ªadv¨öum
 ();

448 
	`msgöô
 ();

450 
Mf_tobîód
 > 
lookf‹
)

451 
	`msgadd
 (
	`egëc
 ());

453 
	`më´vít
 (
ty≥
);

458 
lookf‹
 = 
Mf_tobîód
 - 
	`ªadv¨öum
 ();

459 
	`msgöô
 ();

460 
	`msgadd
 (0xf0);

462 
Mf_tobîód
 > 
lookf‹
)

463 
	`msgadd
 (
c
 = 
	`egëc
 ());

465 i‡(
c
 =0xf7 || 
Mf_nomîge
 == 0)

466 
	`sy£x
 ();

468 
sy£xc⁄töue
 = 1;

473 
lookf‹
 = 
Mf_tobîód
 - 
	`ªadv¨öum
 ();

475 i‡(!
sy£xc⁄töue
)

476 
	`msgöô
 ();

478 
Mf_tobîód
 > 
lookf‹
)

479 
	`msgadd
 (
c
 = 
	`egëc
 ());

481 i‡(!
sy£xc⁄töue
)

483 i‡(
Mf_¨bôøry
)

484 (*
Mf_¨bôøry
Ë(
	`msgÀng
 (), 
	`msg
 ());

486 i‡(
c
 == 0xf7)

488 
	`sy£x
 ();

489 
sy£xc⁄töue
 = 0;

493 
	`badbyã
 (
c
);

497 i‡(
Mf_åackíd
)

498 (*
Mf_åackíd
) ();

500 
	}
}

504 
	$badbyã
 (
c
)

505 
c
;

507 
buff
[32];

509 (Ë
	`•rötf
 (
buff
, "u√x≥˘ed byã: 0x%02x", 
c
);

510 
	`m„º‹
 (
buff
);

511 
	}
}

515 
	$më´vít
 (
ty≥
)

517 
Àng
 = 
	`msgÀng
 ();

518 *
m
 = 
	`msg
 ();

520 
ty≥
)

523 i‡(
Mf_£qnum
)

524 (*
Mf_£qnum
Ë(
	`to16bô
 (
m
[0], m[1]));

542 i‡(
Mf_ãxt
)

543 (*
Mf_ãxt
Ë(
ty≥
, 
Àng
, 
m
);

546 i‡(
Mf_eŸ
)

547 (*
Mf_eŸ
) ();

550 i‡(
Mf_ãmpo
)

551 (*
Mf_ãmpo
Ë(
Mf_cuºãmpo
 = 
	`to32bô
 (0, 
m
[0], m[1], m[2]));

552 i‡(
ãmpo_hi°‹y
[
ãmpo_hi°‹y_cou¡
] =
Mf_cuºãmpo
) ;

553 i‡(
ãmpo_hi°‹y_time
[
ãmpo_hi°‹y_cou¡
] > 
Mf_cuºtime
) ;

554 i‡(
ãmpo_hi°‹y_cou¡
 < 
MAX_HISTORY
 - 1)Åempo_history_count++;

555 
ãmpo_hi°‹y
[
ãmpo_hi°‹y_cou¡
] = 
Mf_cuºãmpo
;

556 
ãmpo_hi°‹y_time
[
ãmpo_hi°‹y_cou¡
] = 
Mf_cuºtime
;

559 i‡(
Mf_sm±e
)

560 (*
Mf_sm±e
Ë(
m
[0], m[1], m[2], m[3], m[4]);

563 i‡(
Mf_timesig
)

564 (*
Mf_timesig
Ë(
m
[0], m[1], m[2], m[3]);

567 i‡(
Mf_keysig
)

568 (*
Mf_keysig
Ë(
m
[0], m[1]);

571 i‡(
Mf_£q•ecific
)

572 (*
Mf_£q•ecific
Ë(
Àng
, 
m
);

575 i‡(
Mf_mëamisc
)

576 (*
Mf_mëamisc
Ë(
ty≥
, 
Àng
, 
m
);

578 
	}
}

582 
	$sy£x
 ()

584 i‡(
Mf_sy£x
)

585 (*
Mf_sy£x
Ë(
	`msgÀng
 (), 
	`msg
 ());

586 
	}
}

590 
	$ch™mesßge
 (
°©us
, 
c1
, 
c2
)

591 
°©us
;

592 
c1
, 
c2
;

594 
ch™
 = 
°©us
 & 0xf;

598 i‡(
c1
 > 127) ;

599 i‡(
c2
 > 127) c2 = 127;

601 
°©us
 & 0xf0)

604 i‡(
Mf_nŸeoff
)

605 (*
Mf_nŸeoff
Ë(
ch™
, 
c1
, 
c2
);

608 i‡(
Mf_nŸe⁄
)

609 (*
Mf_nŸe⁄
Ë(
ch™
, 
c1
, 
c2
);

612 i‡(
Mf_¥essuª
)

613 (*
Mf_¥essuª
Ë(
ch™
, 
c1
, 
c2
);

616 i‡(
Mf_∑ømëî
)

617 (*
Mf_∑ømëî
Ë(
ch™
, 
c1
, 
c2
);

620 i‡(
Mf_pôchbíd
)

621 (*
Mf_pôchbíd
Ë(
ch™
, 
c1
, 
c2
);

624 i‡(
Mf_¥ogøm
)

625 (*
Mf_¥ogøm
Ë(
ch™
, 
c1
);

628 i‡(
Mf_ch™¥essuª
)

629 (*
Mf_ch™¥essuª
Ë(
ch™
, 
c1
);

632 
	}
}

638 
	$ªadv¨öum
 ()

640 
vÆue
;

641 
c
;

643 
c
 = 
	`egëc
 ();

644 
vÆue
 = 
c
;

645 i‡(
c
 & 0x80)

647 
vÆue
 &= 0x7f;

650 
c
 = 
	`egëc
 ();

651 
vÆue
 = (vÆuê<< 7Ë+ (
c
 & 0x7f);

653 
c
 & 0x80);

655  (
vÆue
);

656 
	}
}

659 
	$to32bô
 (
c1
, 
c2
, 
c3
, 
c4
)

661 
vÆue
 = 0L;

663 
vÆue
 = (
c1
 & 0xff);

664 
vÆue
 = (vÆuê<< 8Ë+ (
c2
 & 0xff);

665 
vÆue
 = (vÆuê<< 8Ë+ (
c3
 & 0xff);

666 
vÆue
 = (vÆuê<< 8Ë+ (
c4
 & 0xff);

667  (
vÆue
);

668 
	}
}

671 
	$to16bô
 (
c1
, 
c2
)

672 
c1
, 
c2
;

674  ((
c1
 & 0xffË<< 8Ë+ (
c2
 & 0xff);

675 
	}
}

678 
	$ªad32bô
 ()

680 
c1
, 
c2
, 
c3
, 
c4
;

682 
c1
 = 
	`egëc
 ();

683 
c2
 = 
	`egëc
 ();

684 
c3
 = 
	`egëc
 ();

685 
c4
 = 
	`egëc
 ();

686  
	`to32bô
 (
c1
, 
c2
, 
c3
, 
c4
);

687 
	}
}

690 
	$ªad16bô
 ()

692 
c1
, 
c2
;

693 
c1
 = 
	`egëc
 ();

694 
c2
 = 
	`egëc
 ();

695  
	`to16bô
 (
c1
, 
c2
);

696 
	}
}

700 
	$m„º‹
 (
s
)

701 *
s
;

703 i‡(
Mf_îr‹
)

704 (*
Mf_îr‹
Ë(
s
);

705 
	`exô
 (1);

706 
	}
}

712 
	#MSGINCREMENT
 128

	)

713 *
	gMsgbuff
 = 
NULL
;

714 
	gMsgsize
 = 0;

715 
	gMsgödex
 = 0;

719 
	$msgöô
 ()

721 
Msgödex
 = 0;

722 
	}
}

725 
	$msg
 ()

727  (
Msgbuff
);

728 
	}
}

732 
	$msgÀng
 ()

734  (
Msgödex
);

735 
	}
}

739 
	$msgadd
 (
c
)

740 
c
;

743 i‡(
Msgödex
 >
Msgsize
)

744 
	`biggîmsg
 ();

745 
Msgbuff
[
Msgödex
++] = 
c
;

746 
	}
}

750 
	$biggîmsg
 ()

753 *
√wmess
;

754 *
ﬁdmess
 = 
Msgbuff
;

755 
ﬁdÀng
 = 
Msgsize
;

757 
Msgsize
 +
MSGINCREMENT
;

758 
√wmess
 = (*Ë
	`mÆloc
 ((Ë( (Ë* 
Msgsize
));

760 i‡(
√wmess
 =
NULL
)

761 
	`m„º‹
 ("mallocÉrror!");

764 i‡(
ﬁdmess
 !
NULL
)

766 *
p
 = 
√wmess
;

767 *
q
 = 
ﬁdmess
;

768 *
ídq
 = &
ﬁdmess
[
ﬁdÀng
];

770 ; 
q
 !
ídq
; 
p
++, q++)

771 *
p
 = *
q
;

772 
	`‰ì
 (
ﬁdmess
);

774 
Msgbuff
 = 
√wmess
;

775 
	}
}

777 
	gœ°°©us
 = 0;

808 
	$mfwrôe
 (
f‹m©
, 
¡øcks
, 
divisi⁄
, 
Â
)

809 
f‹m©
, 
¡øcks
, 
divisi⁄
;

810 
FILE
 *
Â
;

812 
i
;

813 
	`mf_wrôe_åack_chunk
 (), 
	`mf_wrôe_hódî_chunk
 ();

815 i‡(
Mf_putc
 =
NULLFUNC
)

816 
	`m„º‹
 ("mfmf_write() called without setting Mf_putc");

818 i‡(
Mf_wrôëøck
 =
NULLFUNC
)

819 
	`m„º‹
 ("mfmf_write() called without setting Mf_mf_writetrack");

821 
œ°°©us
 = 0;

824 
	`mf_wrôe_hódî_chunk
 (
f‹m©
, 
¡øcks
, 
divisi⁄
);

826 
œ°°©us
 = 0;

829 i‡(
f‹m©
 =1 && (
Mf_wrôëempŸøck
))

831 (*
Mf_wrôëempŸøck
) ();

835 
i
 = 0; i < 
¡øcks
; i++)

836 
	`mf_wrôe_åack_chunk
 (
i
, 
Â
);

837 
	}
}

840 
	$mf_wrôe_åack_chunk
 (
which_åack
, 
Â
)

841 
which_åack
;

842 
FILE
 *
Â
;

844 
åkhdr
, 
åkÀngth
;

845 
off£t
, 
∂a˚_m¨kî
;

846 
	`wrôe16bô
 (), 
	`wrôe32bô
 ();

849 
œ°°©us
 = 0;

851 
åkhdr
 = 
MTrk
;

852 
åkÀngth
 = 0;

856 
off£t
 = 
	`·ñl
 (
Â
);

858 #ifde‡
DEBUG


859 
	`¥ötf
 ("off£à%d\n", (Ë
off£t
);

863 
	`wrôe32bô
 (
åkhdr
);

864 
	`wrôe32bô
 (
åkÀngth
);

866 
Mf_numbyãswrôãn
 = 0L;

868 i‡(
Mf_wrôëøck
)

870 (*
Mf_wrôëøck
Ë(
which_åack
);

888 
∂a˚_m¨kî
 = 
	`·ñl
 (
Â
);

895 #ifde‡
DEBUG


896 
	`¥ötf
 ("Àngth = %d\n", (Ë
åkÀngth
);

899 i‡(
	`f£ek
 (
Â
, 
off£t
, 0) < 0)

900 
	`m„º‹
 ("error seeking during final stage of write");

902 
åkÀngth
 = 
Mf_numbyãswrôãn
;

905 
	`wrôe32bô
 (
åkhdr
);

906 
	`wrôe32bô
 (
åkÀngth
);

908 
	`f£ek
 (
Â
, 
∂a˚_m¨kî
, 0);

909 
	}
}

913 
	$mf_wrôe_hódî_chunk
 (
f‹m©
, 
¡øcks
, 
divisi⁄
)

914 
f‹m©
, 
¡øcks
, 
divisi⁄
;

916 
idít
, 
Àngth
;

917 
	`wrôe16bô
 (), 
	`wrôe32bô
 ();

919 
idít
 = 
MThd
;

920 
Àngth
 = 6;

924 
	`wrôe32bô
 (
idít
);

925 
	`wrôe32bô
 (
Àngth
);

926 
	`wrôe16bô
 (
f‹m©
);

927 
	`wrôe16bô
 (
¡øcks
);

928 
	`wrôe16bô
 (
divisi⁄
);

929 
	}
}

951 
	$mf_wrôe_midi_evít
 (
dñè_time
, 
ty≥
, 
ch™
, 
d©a
, 
size
)

952 
dñè_time
;

953 
ch™
, 
ty≥
;

954 
size
;

955 *
d©a
;

957 
i
;

958 
c
;

960 
	`WrôeV¨Lí
 (
dñè_time
);

964 i‡(
ty≥
 =
sy°em_ex˛usive
 ||Åype == 0xf7)

966 
c
 = 
ty≥
;

967 
œ°°©us
 = 0;

970 
c
 = 
ty≥
 | 
ch™
;

972 i‡(
ch™
 > 15)

973 
	`≥º‹
 ("error: MIDI channel greaterÅhan 16\n");

975 i‡(
œ°°©us
 !
c
)

976 
	`ïutc
 (
œ°°©us
 = 
c
);

978 i‡(
ty≥
 =
sy°em_ex˛usive
 ||Åype == 0xf7)

979 
	`WrôeV¨Lí
 (
size
);

982 
i
 = 0; i < ()
size
; i++)

983 
	`ïutc
 (
d©a
[
i
]);

985  (
size
);

986 
	}
}

1003 
	$mf_wrôe_mëa_evít
 (
dñè_time
, 
ty≥
, 
d©a
, 
size
)

1004 
dñè_time
;

1005 *
d©a
, 
ty≥
;

1006 
size
;

1008 
i
;

1010 
	`WrôeV¨Lí
 (
dñè_time
);

1013 
	`ïutc
 (
œ°°©us
 = 
mëa_evít
);

1016 
	`ïutc
 (
ty≥
);

1019 
	`WrôeV¨Lí
 (
size
);

1021 
i
 = 0; i < ()
size
; i++)

1023 i‡(
	`ïutc
 (
d©a
[
i
]) != data[i])

1026  (
size
);

1027 
	}
}

1030 
	$mf_wrôe_ãmpo
 (
dñè_time
, 
ãmpo
)

1031 
dñè_time
;

1032 
ãmpo
;

1038 
	`WrôeV¨Lí
 (
dñè_time
);

1039 
	`ïutc
 (
œ°°©us
 = 
mëa_evít
);

1040 
	`ïutc
 (
£t_ãmpo
);

1042 
	`ïutc
 (3);

1043 
	`ïutc
 ((Ë(0xf‡& (
ãmpo
 >> 16)));

1044 
	`ïutc
 ((Ë(0xf‡& (
ãmpo
 >> 8)));

1045 
	`ïutc
 ((Ë(0xf‡& 
ãmpo
));

1046 
	}
}

1049 
	$mf_wrôe_£qnum
 (
dñè_time
, 
£qnum
)

1050 
dñè_time
;

1051 
£qnum
;

1054 
	`WrôeV¨Lí
 (
dñè_time
);

1055 
	`ïutc
 (
œ°°©us
 = 
mëa_evít
);

1056 
	`ïutc
 (0);

1058 
	`ïutc
 ((Ë(0xf‡& (
£qnum
 >> 8)));

1059 
	`ïutc
 ((Ë(0xf‡& 
£qnum
));

1060 
	}
}

1063 
	$mf_£c2ticks
 (
£cs
, 
divisi⁄
, 
ãmpo
)

1064 
divisi⁄
;

1065 
ãmpo
;

1066 
£cs
;

1068  (Ë(((
£cs
 * 1000.0Ë/ 4.0 * 
divisi⁄
Ë/ 
ãmpo
);

1069 
	}
}

1075 
	$WrôeV¨Lí
 (
vÆue
)

1076 
vÆue
;

1078 
buf„r
;

1080 
buf„r
 = 
vÆue
 & 0x7f;

1081 (
vÆue
 >>= 7) > 0)

1083 
buf„r
 <<= 8;

1084 
buf„r
 |= 0x80;

1085 
buf„r
 +(
vÆue
 & 0x7f);

1089 
	`ïutc
 ((Ë(
buf„r
 & 0xff));

1091 i‡(
buf„r
 & 0x80)

1092 
buf„r
 >>= 8;

1096 
	}
}

1105 
	$mf_ticks2£c
 (
ticks
, 
divisi⁄
, 
ãmpo
)

1106 
divisi⁄
;

1107 
ãmpo
;

1108 
ticks
;

1110 
sm±e_f‹m©
, 
sm±e_ªsﬁuti⁄
;

1112 i‡(
divisi⁄
 > 0)

1113  ((Ë(((Ë(
ticks
Ë* (Ë(
ãmpo
)Ë/ ((Ë(
divisi⁄
) * 1000000.0)));

1116 
sm±e_f‹m©
 = 
	`uµîbyã
 (
divisi⁄
);

1117 
sm±e_ªsﬁuti⁄
 = 
	`lowîbyã
 (
divisi⁄
);

1118  (Ë((Ë
ticks
 / (
sm±e_f‹m©
 * 
sm±e_ªsﬁuti⁄
 * 1000000.0));

1120 
	}
}

1136 
	$wrôe32bô
 (
d©a
)

1137 
d©a
;

1139 
	`ïutc
 ((Ë((
d©a
 >> 24) & 0xff));

1140 
	`ïutc
 ((Ë((
d©a
 >> 16) & 0xff));

1141 
	`ïutc
 ((Ë((
d©a
 >> 8) & 0xff));

1142 
	`ïutc
 ((Ë(
d©a
 & 0xff));

1143 
	}
}

1146 
	$wrôe16bô
 (
d©a
)

1147 
d©a
;

1149 
	`ïutc
 ((Ë((
d©a
 & 0xff00) >> 8));

1150 
	`ïutc
 ((Ë(
d©a
 & 0xff));

1151 
	}
}

1155 
	$ïutc
 (
c
)

1156 
c
;

1158 
ªtu∫_vÆ
;

1160 i‡((
Mf_putc
Ë=
NULLFUNC
)

1162 
	`m„º‹
 ("Mf_putc undefined");

1166 
ªtu∫_vÆ
 = (*
Mf_putc
Ë(
c
);

1168 i‡(
ªtu∫_vÆ
 =
EOF
)

1169 
	`m„º‹
 ("error writing");

1171 
Mf_numbyãswrôãn
++;

1172  (
ªtu∫_vÆ
);

1173 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/midifile.h

2 (*
Mf_gëc
)();

3 (*
Mf_hódî
)();

4 (*
Mf_åack°¨t
)();

5 (*
Mf_åackíd
)();

6 (*
Mf_nŸe⁄
)();

7 (*
Mf_nŸeoff
)();

8 (*
Mf_¥essuª
)();

9 (*
Mf_∑ømëî
)();

10 (*
Mf_pôchbíd
)();

11 (*
Mf_¥ogøm
)();

12 (*
Mf_ch™¥essuª
)();

13 (*
Mf_sy£x
)();

14 (*
Mf_mëamisc
)();

15 (*
Mf_£q•ecific
)();

16 (*
Mf_£qnum
)();

17 (*
Mf_ãxt
)();

18 (*
Mf_eŸ
)();

19 (*
Mf_timesig
)();

20 (*
Mf_sm±e
)();

21 (*
Mf_ãmpo
)();

22 (*
Mf_keysig
)();

23 (*
Mf_¨bôøry
)();

24 (*
Mf_îr‹
)();

25 
Mf_cuºtime
;

26 
Mf_ªÆtime
;

27 
Mf_cuºãmpo
;

28 
Mf_divisi⁄
;

29 
Mf_nomîge
;

30 #ifde‡
READ_MODS


31 *
Mf_fûe_c⁄ã¡s
;

32 
Mf_fûe_size
;

36 (*
Mf_putc
)();

37 (*
Mf_wrôëøck
)();

38 (*
Mf_wrôëempŸøck
)();

40 
midifûe
();

41 
mf_£c2ticks
();

42 
mfwrôe
();

43 
mf_wrôe_mëa_evít
();

44 
mf_wrôe_midi_evít
(
dñè_time
, 
ty≥
,

45 
ch™
, *
d©a
, 
size
);

46 
mf_ticks2£c
(
ticks
,
divisi⁄
,
ãmpo
);

47 
mf_wrôe_ãmpo
();

48 
mf_wrôe_£qnum
();

49 
m‰ód
();

50 
m„º‹
(*
s
);

52 #i‚de‡
NO_LC_DEFINES


54 
	#nŸe_off
 0x80

	)

55 
	#nŸe_⁄
 0x90

	)

56 
	#pﬁy_a·îtouch
 0xa0

	)

57 
	#c⁄åﬁ_ch™ge
 0xb0

	)

58 
	#¥ogøm_chng
 0xc0

	)

59 
	#ch™√l_a·îtouch
 0xd0

	)

60 
	#pôch_whìl
 0xe0

	)

61 
	#sy°em_ex˛usive
 0xf0

	)

62 
	#dñay_∑ckë
 (1111)

	)

65 
	#dam≥r_≥dÆ
 0x40

	)

66 
	#p‹èmíto
 0x41

	)

67 
	#su°íuto
 0x42

	)

68 
	#so·_≥dÆ
 0x43

	)

69 
	#gíîÆ_4
 0x44

	)

70 
	#hﬁd_2
 0x45

	)

71 
	#gíîÆ_5
 0x50

	)

72 
	#gíîÆ_6
 0x51

	)

73 
	#gíîÆ_7
 0x52

	)

74 
	#gíîÆ_8
 0x53

	)

75 #i‚de‡
PLAYMIDI


76 
	#åemﬁo_dïth
 0x5c

	)

77 
	#˘æ_ch‹us_dïth
 0x5d

	)

78 
	#dëu√
 0x5e

	)

79 
	#pha£r_dïth
 0x5f

	)

83 
	#d©a_öc
 0x60

	)

84 
	#d©a_dec
 0x61

	)

87 
	#n⁄_ªg_lsb
 0x62

	)

88 
	#n⁄_ªg_msb
 0x63

	)

89 
	#ªg_lsb
 0x64

	)

90 
	#ªg_msb
 0x65

	)

93 
	#mëa_evít
 0xFF

	)

94 
	#£quí˚_numbî
 0x00

	)

95 
	#ãxt_evít
 0x01

	)

96 
	#c›yright_nŸi˚
 0x02

	)

97 
	#£quí˚_«me
 0x03

	)

98 
	#ö°rumít_«me
 0x04

	)

99 
	#lyric
 0x05

	)

100 
	#m¨kî
 0x06

	)

101 
	#cue_poöt
 0x07

	)

102 
	#ch™√l_¥efix
 0x20

	)

103 
	#íd_of_åack
 0x2f

	)

104 
	#£t_ãmpo
 0x51

	)

105 
	#sm±e_off£t
 0x54

	)

106 
	#time_sig«tuª
 0x58

	)

107 
	#key_sig«tuª
 0x59

	)

108 
	#£quí˚r_•ecific
 0x74

	)

111 
	#Seq_Cúcuôs
 (0x01Ë

	)

112 
	#Big_Brür
 (0x02Ë

	)

113 
	#O˘ave
 (0x03Ë

	)

114 
	#Moog
 (0x04Ë

	)

115 
	#Pas•‹t
 (0x05Ë

	)

116 
	#Lexic⁄
 (0x06Ë

	)

117 
	#Tempi
 (0x20Ë

	)

118 
	#Sõl
 (0x21Ë

	)

119 
	#Kawai
 (0x41)

	)

120 
	#Rﬁ™d
 (0x42)

	)

121 
	#K‹g
 (0x42)

	)

122 
	#Yamaha
 (0x43)

	)

126 
	#MThd
 0x4d546864

	)

127 
	#MTrk
 0x4d54726b

	)

129 #i‚de‡
NO_LC_DEFINES


130 
	#lowîbyã
(
x
Ë(()(x & 0xff))

	)

131 
	#uµîbyã
(
x
Ë(()((x & 0xff00)>>8))

	)

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/midiloop.c

1 
	~<°dlib.h
>

2 
	~<°dio.h
>

3 
	~<˘y≥.h
>

4 
	~<sys/time.h
>

5 
	~"../ö˛ude/asoundlib.h
"

6 
	~<°rög.h
>

7 
	~<sig«l.h
>

9 
	$ußge
()

11 
	`Ârötf
(
°dîr
, "Usage: midiloop [options]\n");

12 
	`Ârötf
(
°dîr
, " options:\n");

13 
	`Ârötf
(
°dîr
, " -v: verbose mode\n");

14 
	`Ârötf
(
°dîr
, " -i <rawmidi device> :Åest input device\n");

15 
	`Ârötf
(
°dîr
, " -o <rawmidi device> :Åest output device\n");

16 
	}
}

18 
	g°›
 = 0;

20 
	$sigh™dÀr
(
dummy
 
ATTRIBUTE_UNUSED
)

22 
°›
=1;

23 
	}
}

25 
	$timediff
(
timevÆ
 
t1
, timevÆ 
t2
)

27 sig√d 
l
;

29 
t1
.
tv_£c
 -
t2
.tv_sec;

30 
l
 = (sig√d Ë
t1
.
tv_u£c
 - (sig√d Ë
t2
.tv_usec;

31 i‡(
l
 < 0) {

32 
t1
.
tv_£c
--;

33 
l
 = -l;

34 
l
 %= 1000000;

36  (()
t1
.
tv_£c
 * ()1000000Ë+ ()
l
;

37 
	}
}

39 
	$wrôï©ã∫
(
¢d_øwmidi_t
 *
h™dÀ_out
, *
obuf
)

41 
∑tsize
, 
i
;

43 
∑tsize
 = 0;

44 
i
 = 0; i < 15; i++) {

45 
obuf
[
∑tsize
++] = 0x90 + 
i
;

46 
obuf
[
∑tsize
++] = 0x40;

47 
obuf
[
∑tsize
++] = 0x3f;

48 
obuf
[
∑tsize
++] = 0xb0 + 
i
;

49 
obuf
[
∑tsize
++] = 0x2e;

50 
obuf
[
∑tsize
++] = 0x7a;

51 
obuf
[
∑tsize
++] = 0x80 + 
i
;

52 
obuf
[
∑tsize
++] = 0x23;

53 
obuf
[
∑tsize
++] = 0x24;

54 
obuf
[
∑tsize
++] = 0xf0;

55 
obuf
[
∑tsize
++] = 
i
;

56 
obuf
[
∑tsize
++] = 0xf7;

58 
i
 = 
	`¢d_øwmidi_wrôe
(
h™dÀ_out
, 
obuf
, 
∑tsize
);

59 i‡(
i
 !
∑tsize
) {

60 
	`¥ötf
("Wrôã¿⁄ly %òbyã†‰om %òbyãs\n", 
i
, 
∑tsize
);

61 
	`exô
(
EXIT_FAILURE
);

63  
∑tsize
;

64 
	}
}

66 
	$maö
(
¨gc
, ** 
¨gv
)

68 
i
, 
j
, 
k
, 
›os
, 
ùos
, 
∑tsize
;

69 
îr
;

70 
vîbo£
 = 0;

71 
¢d_øwmidi_t
 *
h™dÀ_ö
 = 
NULL
, *
h™dÀ_out
 = NULL;

72 
ibuf
[512], 
obuf
[512];

73 *
öame
 = "hw:0,0", *
⁄ame
 = "hw:0,0";

74 
timevÆ
 
°¨t
, 
íd
;

75 
diff
;

76 
¢d_øwmidi_°©us_t
 *
i°©
, *
o°©
;

78 
i
 = 1 ; i<
¨gc
 ; i++) {

79 i‡(
¨gv
[
i
][0]=='-') {

80 i‡(!
	`°rcmp
(
¨gv
[
i
], "--help")) {

81 
	`ußge
();

84 
¨gv
[
i
][1]) {

86 
	`ußge
();

89 
vîbo£
 = 1;

92 i‡(
i
 + 1 < 
¨gc
)

93 
öame
 = 
¨gv
[++
i
];

96 i‡(
i
 + 1 < 
¨gc
)

97 
⁄ame
 = 
¨gv
[++
i
];

103 i‡(
öame
 =
NULL
)

104 
öame
 = 
⁄ame
;

105 i‡(
⁄ame
 =
NULL
)

106 
⁄ame
 = 
öame
;

108 i‡(
vîbo£
) {

109 
	`Ârötf
(
°dîr
, "Using: \n");

110 
	`Ârötf
(
°dîr
, " I≈ut: %† Ouçut: %s\n", 
öame
, 
⁄ame
);

113 
îr
 = 
	`¢d_øwmidi_›í
(&
h™dÀ_ö
, 
NULL
, 
öame
, 
SND_RAWMIDI_NONBLOCK
);

114 i‡(
îr
) {

115 
	`Ârötf
(
°dîr
,"¢d_øwmidi_›í %†Áûed: %d\n",
öame
,
îr
);

116 
	`exô
(
EXIT_FAILURE
);

119 
îr
 = 
	`¢d_øwmidi_›í
(
NULL
, &
h™dÀ_out
, 
⁄ame
, 0);

120 i‡(
îr
) {

121 
	`Ârötf
(
°dîr
,"¢d_øwmidi_›í %†Áûed: %d\n",
⁄ame
,
îr
);

122 
	`exô
(
EXIT_FAILURE
);

125 
	`sig«l
(
SIGINT
, 
sigh™dÀr
);

127 
i
 = 
	`¢d_øwmidi_ªad
(
h™dÀ_ö
, 
ibuf
, (ibuf));

128 i‡(
i
 > 0) {

129 
	`¥ötf
("Ródáhód: %i\n", 
i
);

130 
j
 = 0; j < 
i
; j++)

131 
	`¥ötf
("%02x:", 
ibuf
[
j
]);

132 
	`¥ötf
("\n");

133 
	`exô
(
EXIT_FAILURE
);

136 
	`¢d_øwmidi_n⁄block
(
h™dÀ_ö
, 0);

138 
∑tsize
 = 
	`wrôï©ã∫
(
h™dÀ_out
, 
obuf
);

139 
	`gëtimeofday
(&
°¨t
, 
NULL
);

140 
∑tsize
 = 
	`wrôï©ã∫
(
h™dÀ_out
, 
obuf
);

142 
k
 = 
ùos
 = 
›os
 = 
îr
 = 0;

143 !
°›
) {

144 
i
 = 
	`¢d_øwmidi_ªad
(
h™dÀ_ö
, 
ibuf
, (ibuf));

145 
j
 = 0; j < 
i
; j++, 
ùos
++)

146 i‡(
obuf
[
k
] !
ibuf
[
j
]) {

147 
	`¥ötf
("ùo†%i, i[0x%x] !o[0x%x]\n", 
ùos
, 
ibuf
[
j
], 
obuf
[
k
]);

148 i‡(
›os
 > 0)

149 
°›
 = 1;

151 
	`¥ötf
("m©ch suc˚ss: ipo†%i, opo†%ò[%i:0x%x]\n", 
ùos
, 
›os
, 
k
, 
obuf
[k]);

152 
k
++; 
›os
++;

153 i‡(
k
 >
∑tsize
) {

154 
∑tsize
 = 
	`wrôï©ã∫
(
h™dÀ_out
, 
obuf
);

155 
k
 = 0;

160 
	`gëtimeofday
(&
íd
, 
NULL
);

162 
	`¥ötf
("End...\n");

164 
	`¢d_øwmidi_°©us_Æloˇ
(&
i°©
);

165 
	`¢d_øwmidi_°©us_Æloˇ
(&
o°©
);

166 
îr
 = 
	`¢d_øwmidi_°©us
(
h™dÀ_ö
, 
i°©
);

167 i‡(
îr
 < 0)

168 
	`Ârötf
(
°dîr
, "öpuà°ªam sètu†îr‹: %d\n", 
îr
);

169 
îr
 = 
	`¢d_øwmidi_°©us
(
h™dÀ_out
, 
o°©
);

170 i‡(
îr
 < 0)

171 
	`Ârötf
(
°dîr
, "ouçuà°ªam sètu†îr‹: %d\n", 
îr
);

172 
	`¥ötf
("öput.°©us.avaû = %zi\n", 
	`¢d_øwmidi_°©us_gë_avaû
(
i°©
));

173 
	`¥ötf
("öput.°©us.xrun†%zi\n", 
	`¢d_øwmidi_°©us_gë_xruns
(
i°©
));

174 
	`¥ötf
("ouçut.°©us.avaû = %zi\n", 
	`¢d_øwmidi_°©us_gë_avaû
(
o°©
));

175 
	`¥ötf
("ouçut.°©us.xrun†%zi\n", 
	`¢d_øwmidi_°©us_gë_xruns
(
o°©
));

177 
diff
 = 
	`timediff
(
íd
, 
°¨t
);

178 
	`¥ötf
("Timêdiff: %Œiu£¯(%Œòbyãs/£c)\n", 
diff
, (()
›os
 * 1000000) / diff);

180 i‡(
vîbo£
) {

181 
	`Ârötf
(
°dîr
,"Closing\n");

184 
	`¢d_øwmidi_døö
(
h™dÀ_ö
);

185 
	`¢d_øwmidi_˛o£
(
h™dÀ_ö
);

186 
	`¢d_øwmidi_døö
(
h™dÀ_out
);

187 
	`¢d_øwmidi_˛o£
(
h™dÀ_out
);

190 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/mixtest.c

1 
	~<°dlib.h
>

2 
	~<°dio.h
>

3 
	~<°rög.h
>

4 
	~<uni°d.h
>

5 
	~<sched.h
>

6 
	~<time.h
>

8 
	#rdts˛l
(
vÆ
) \

9 
__asm__
 
	`__vﬁ©ûe__
("rdtsc" : "=A" (
vÆ
))

	)

11 
	#likñy
(
x
Ë
	`__buûtö_ex≥˘
((x),1)

	)

12 
	#u∆ikñy
(
x
Ë
	`__buûtö_ex≥˘
((x),0)

	)

14 
	ts16
;

15 
	ts32
;

18 
	#CONFIG_SMP


	)

21 #ifde‡
CONFIG_SMP


22 
	#LOCK_PREFIX
 "lock ; "

	)

24 
	#LOCK_PREFIX
 ""

	)

27 
	s__xchg_dummy
 { 
	ma
[100]; };

28 
	#__xg
(
x
Ë((
__xchg_dummy
 *)(x))

	)

30 
ölöe
 
	$__cmpxchg
(vﬁ©ûê*
±r
, 
ﬁd
,

31 
√w
, 
size
)

33 
¥ev
;

34 
size
) {

36 
__asm__
 
	`__vﬁ©ûe__
(
LOCK_PREFIX
 "cmpxchgb %b1,%2"

37 : "˜"(
¥ev
)

38 : "q"(
√w
), "m"(*
	`__xg
(
±r
)), "0"(
ﬁd
)

40  
¥ev
;

42 
__asm__
 
	`__vﬁ©ûe__
(
LOCK_PREFIX
 "cmpxchgw %w1,%2"

43 : "˜"(
¥ev
)

44 : "q"(
√w
), "m"(*
	`__xg
(
±r
)), "0"(
ﬁd
)

46  
¥ev
;

48 
__asm__
 
	`__vﬁ©ûe__
(
LOCK_PREFIX
 "cmpxchgl %1,%2"

49 : "˜"(
¥ev
)

50 : "q"(
√w
), "m"(*
	`__xg
(
±r
)), "0"(
ﬁd
)

52  
¥ev
;

54  
ﬁd
;

55 
	}
}

57 
	#cmpxchg
(
±r
,
o
,
n
)\

58 ((
	`__ty≥of__
(*(
±r
)))
	`__cmpxchg
(’å),()(
o
),\

59 ()(
n
),(*(
±r
))))

	)

61 
ölöe
 
	$©omic_add
(vﬁ©ûê*
d°
, 
v
)

63 
__asm__
 
	`__vﬁ©ûe__
(

64 
LOCK_PREFIX
 "addl %1,%0"

65 :"=m" (*
d°
)

66 :"ú" (
v
), "m" (*
d°
));

67 
	}
}

69 
	$dëe˘_˝u_˛ock
()

71 
time•ec
 
tm_begö
, 
tm_íd
;

72 
tsc_begö
, 
tsc_íd
;

75 
	`˛ock_gëtime
(
CLOCK_MONOTONIC
, &
tm_begö
);

77 
	`rdts˛l
(
tsc_begö
);

78 
	`˛ock_gëtime
(
CLOCK_MONOTONIC
, &
tm_begö
);

80 
	`u¶ìp
(1000000);

82 
	`rdts˛l
(
tsc_íd
);

83 
	`˛ock_gëtime
(
CLOCK_MONOTONIC
, &
tm_íd
);

85  (
tsc_íd
 - 
tsc_begö
Ë/ (
tm_íd
.
tv_£c
 - 
tm_begö
.tv_£¯+ (tm_íd.
tv_n£c
 -Åm_begin.tv_nsec) / 1e9);

86 
	}
}

88 
	$mix_¨ós_§v
(
size
,

89 c⁄° 
s16
 *
§c
,

90 vﬁ©ûê
s32
 *
sum
,

91 
§c_°ï
, 
sum_°ï
)

93 
§c_°ï
 /(*
§c
);

94 
sum_°ï
 /(*
sum
);

95 
size
-- > 0) {

96 
	`©omic_add
(
sum
, *
§c
);

97 
§c
 +
§c_°ï
;

98 
sum
 +
sum_°ï
;

100 
	}
}

102 
	$ßtuøã
(
size
,

103 
s16
 *
d°
, c⁄° 
s32
 *
sum
,

104 
d°_°ï
, 
sum_°ï
)

106 
d°_°ï
 /(*
d°
);

107 
sum_°ï
 /(*
sum
);

108 
size
-- > 0) {

109 
s32
 
ßm∂e
 = *
sum
;

110 i‡(
	`u∆ikñy
(
ßm∂e
 < -0x8000))

111 *
d°
 = -0x8000;

112 i‡(
	`u∆ikñy
(
ßm∂e
 > 0x7fff))

113 *
d°
 = 0x7fff;

115 *
d°
 = 
ßm∂e
;

116 
d°
 +
d°_°ï
;

117 
sum
 +
sum_°ï
;

119 
	}
}

121 
	$mix_¨ós0
(
size
,

122 vﬁ©ûê
s16
 *
d°
, s16 *
§c
,

123 vﬁ©ûê
s32
 *
sum
,

124 
d°_°ï
,

125 
§c_°ï
,

126 
sum_°ï
)

128 
d°_°ï
 /(*
d°
);

129 
§c_°ï
 /(*
§c
);

130 
sum_°ï
 /(*
sum
);

131 
size
-- > 0) {

132 
s32
 
ßm∂e
 = *
d°
 + *
§c
;

133 i‡(
	`u∆ikñy
(
ßm∂e
 < -0x8000))

134 *
d°
 = -0x8000;

135 i‡(
	`u∆ikñy
(
ßm∂e
 > 0x7fff))

136 *
d°
 = 0x7fff;

138 *
d°
 = 
ßm∂e
;

139 
d°
 +
d°_°ï
;

140 
§c
 +
§c_°ï
;

141 
sum
 +
sum_°ï
;

143 
	}
}

145 
	#MIX_AREAS_16
 
mix_¨ós1


	)

146 
	#MIX_AREAS_16_MMX
 
mix_¨ós1_mmx


	)

147 
	#MIX_AREAS_32
 
mix_¨ós1_32


	)

148 
	#MIX_AREAS_24
 
mix_¨ós1_24


	)

149 
	#MIX_AREAS_24_CMOV
 
mix_¨ós1_24_cmov


	)

150 
	#XADD
 "addl"

	)

151 
	#XSUB
 "subl"

	)

152 
	~"../§c/pcm/pcm_dmix_i386.h
"

153 *
±r_mix_¨ós1_32
 
__©åibuã__
((
unu£d
)Ë&
mix_¨ós1_32
;

154 *
±r_mix_¨ós1_24
 
__©åibuã__
((
unu£d
)Ë&
mix_¨ós1_24
;

155 *
±r_mix_¨ós1_24_cmov
 
__©åibuã__
((
unu£d
)Ë&
mix_¨ós1_24_cmov
;

157 
	$mix_¨ós2
(
size
,

158 vﬁ©ûê
s16
 *
d°
, c⁄° s16 *
§c
,

159 vﬁ©ûê
s32
 *
sum
,

160 
d°_°ï
,

161 
§c_°ï
)

163 
d°_°ï
 /(*
d°
);

164 
§c_°ï
 /(*
§c
);

165 
size
-- > 0) {

166 
s32
 
ßm∂e
 = *
§c
;

167 
s32
 
ﬁd_ßm∂e
 = *
sum
;

168 i‡(
	`cmpxchg
(
d°
, 0, 1) == 0)

169 
ßm∂e
 -
ﬁd_ßm∂e
;

170 
	`©omic_add
(
sum
, 
ßm∂e
);

172 
ßm∂e
 = *
sum
;

173 i‡(
	`u∆ikñy
(
ßm∂e
 < -0x8000))

174 *
d°
 = -0x8000;

175 i‡(
	`u∆ikñy
(
ßm∂e
 > 0x7fff))

176 *
d°
 = 0x7fff;

178 *
d°
 = 
ßm∂e
;

179 } 
	`u∆ikñy
(
ßm∂e
 !*
sum
));

180 
sum
++;

181 
d°
 +
d°_°ï
;

182 
§c
 +
§c_°ï
;

184 
	}
}

186 
	$£tscheduÀr
()

188 
sched_∑øm
 sched_param;

190 i‡(
	`sched_gë∑øm
(0, &
sched_∑øm
) < 0) {

191 
	`¥ötf
("Scheduler getparam failed...\n");

194 
sched_∑øm
.
sched_¥i‹ôy
 = 
	`sched_gë_¥i‹ôy_max
(
SCHED_RR
);

195 i‡(!
	`sched_£tscheduÀr
(0, 
SCHED_RR
, &
sched_∑øm
)) {

196 
	`¥ötf
("ScheduÀ∏£àtÿRound Robö wôhÖri‹ôy %i...\n", 
sched_∑øm
.
sched_¥i‹ôy
);

197 
	`fÊush
(
°dout
);

200 
	`¥ötf
("!!!ScheduÀ∏£àtÿRound Robö wôhÖri‹ôy %òFAILED!!!\n", 
sched_∑øm
.
sched_¥i‹ôy
);

201 
	}
}

203 
	gˇche_size
 = 1024*1024;

205 
	$öô
(
s16
 *
d°
, 
s32
 *
sum
, 
size
)

207 
cou¡
;

208 *
a
;

210 
cou¡
 = 
size
 - 1; count >= 0; count--)

211 *
sum
++ = 0;

212 
cou¡
 = 
size
 - 1; count >= 0; count--)

213 *
d°
++ = 0;

214 
a
 = 
	`mÆloc
(
ˇche_size
);

215 
cou¡
 = 
ˇche_size
 - 1; count >= 0; count--) {

216 
a
[
cou¡
] = count & 0xff;

217 
a
[
cou¡
] ^= 0x55;

218 
a
[
cou¡
] ^= 0xaa;

220 
	`‰ì
(
a
);

221 
	}
}

223 
	$maö
(
¨gc
, **
¨gv
)

225 
size
 = 2048, 
n
 = 4, 
max
 = 32267;

226 
LOOP
 = 100;

227 
i
, 
t
;

228 
begö
, 
íd
, 
diff
, 
diffS
, 
diff0
, 
diff1
, 
diff1_mmx
, 
diff2
;

229 
˝u_˛ock
 = 
	`dëe˘_˝u_˛ock
();

230 
s16
 *
d°
 = 
	`mÆloc
((*d°Ë* 
size
);

231 
s32
 *
sum
 = 
	`ˇŒoc
(
size
, (*sum));

232 
s16
 **
§cs
 = 
	`mÆloc
((*§csË* 
n
);

234 
	`£tscheduÀr
();

235 #i‚de‡
CONFIG_SMP


236 
	`¥ötf
("CPU clock: %fMhz (UP)\n\n", 
˝u_˛ock
 / 10e5);

238 
	`¥ötf
("CPU clock: %fMhz (SMP)\n\n", 
˝u_˛ock
 / 10e5);

240 i‡(
¨gc
 > 3) {

241 
size
 = 
	`©oi
(
¨gv
[1]);

242 
n
 = 
	`©oi
(
¨gv
[2]);

243 
max
 = 
	`©oi
(
¨gv
[3]);

245 i‡(
¨gc
 > 4)

246 
ˇche_size
 = 
	`©oi
(
¨gv
[4]) * 1024;

247 
i
 = 0; i < 
n
; i++) {

248 
k
;

249 
s16
 *
s
;

250 
§cs
[
i
] = 
s
 = 
	`mÆloc
((
s16
Ë* 
size
);

251 
k
 = 0; k < 
size
; ++k, ++
s
) {

252 *
s
 = (
	`ønd
(Ë% (
max
 * 2)) - max;

256 
t
 = 0, 
diffS
 = -1;Å < 
LOOP
;Å++) {

257 
	`öô
(
d°
, 
sum
, 
size
);

258 
	`rdts˛l
(
begö
);

259 
i
 = 0; i < 
n
; i++) {

260 
	`mix_¨ós_§v
(
size
, 
§cs
[
i
], 
sum
, 2, 4);

262 
	`ßtuøã
(
size
, 
d°
, 
sum
, 2, 4);

263 
	`rdts˛l
(
íd
);

264 
diff
 = 
íd
 - 
begö
;

265 i‡(
diff
 < 
diffS
)

266 
diffS
 = 
diff
;

267 
	`¥ötf
("mix_¨ós_§v : %Œu \r", 
diff
); 
	`fÊush
(
°dout
);

270 
t
 = 0, 
diff0
 = -1;Å < 
LOOP
;Å++) {

271 
	`öô
(
d°
, 
sum
, 
size
);

272 
	`rdts˛l
(
begö
);

273 
i
 = 0; i < 
n
; i++) {

274 
	`mix_¨ós0
(
size
, 
d°
, 
§cs
[
i
], 
sum
, 2, 2, 4);

276 
	`rdts˛l
(
íd
);

277 
diff
 = 
íd
 - 
begö
;

278 i‡(
diff
 < 
diff0
)

279 
diff0
 = 
diff
;

280 
	`¥ötf
("mix_¨ós0 : %Œu \r", 
diff
); 
	`fÊush
(
°dout
);

283 
t
 = 0, 
diff1
 = -1;Å < 
LOOP
;Å++) {

284 
	`öô
(
d°
, 
sum
, 
size
);

285 
	`rdts˛l
(
begö
);

286 
i
 = 0; i < 
n
; i++) {

287 
	`mix_¨ós1
(
size
, 
d°
, 
§cs
[
i
], 
sum
, 2, 2, 4);

289 
	`rdts˛l
(
íd
);

290 
diff
 = 
íd
 - 
begö
;

291 i‡(
diff
 < 
diff1
)

292 
diff1
 = 
diff
;

293 
	`¥ötf
("mix_¨ós1 : %Œu \r", 
diff
); 
	`fÊush
(
°dout
);

296 
t
 = 0, 
diff1_mmx
 = -1;Å < 
LOOP
;Å++) {

297 
	`öô
(
d°
, 
sum
, 
size
);

298 
	`rdts˛l
(
begö
);

299 
i
 = 0; i < 
n
; i++) {

300 
	`mix_¨ós1_mmx
(
size
, 
d°
, 
§cs
[
i
], 
sum
, 2, 2, 4);

302 
	`rdts˛l
(
íd
);

303 
diff
 = 
íd
 - 
begö
;

304 i‡(
diff
 < 
diff1_mmx
)

305 
diff1_mmx
 = 
diff
;

306 
	`¥ötf
("mix_¨ós1_mmx: %Œu \r", 
diff
); 
	`fÊush
(
°dout
);

309 
t
 = 0, 
diff2
 = -1;Å < 
LOOP
;Å++) {

310 
	`öô
(
d°
, 
sum
, 
size
);

311 
	`rdts˛l
(
begö
);

312 
i
 = 0; i < 
n
; i++) {

313 
	`mix_¨ós2
(
size
, 
d°
, 
§cs
[
i
], 
sum
, 2, 2);

315 
	`rdts˛l
(
íd
);

316 
diff
 = 
íd
 - 
begö
;

317 i‡(
diff
 < 
diff2
)

318 
diff2
 = 
diff
;

319 
	`¥ötf
("mix_¨ós2 : %Œu \r", 
diff
); 
	`fÊush
(
°dout
);

322 
	`¥ötf
(" \r");

323 
	`¥ötf
("Summary (the bestÅimes):\n");

324 
	`¥ötf
("mix_¨ós_§v : %8Œu %f%%\n", 
diffS
, 100*2*44100.0*diffS/(
size
*
n
*
˝u_˛ock
));

325 
	`¥ötf
("mix_¨ós0 : %8Œu %f%%\n", 
diff0
, 100*2*44100.0*diff0/(
size
*
n
*
˝u_˛ock
));

326 
	`¥ötf
("mix_¨ós1 : %8Œu %f%%\n", 
diff1
, 100*2*44100.0*diff1/(
size
*
n
*
˝u_˛ock
));

327 
	`¥ötf
("mix_¨ós1_mmx : %8Œu %f%%\n", 
diff1_mmx
, 100*2*44100.0*diff1_mmx/(
size
*
n
*
˝u_˛ock
));

328 
	`¥ötf
("mix_¨ós2 : %8Œu %f%%\n", 
diff2
, 100*2*44100.0*diff2/(
size
*
n
*
˝u_˛ock
));

330 
	`¥ötf
("\n");

331 
	`¥ötf
("¨ós1/§vÑ©iÿ : %f\n", ()
diff1
 / 
diffS
);

332 
	`¥ötf
("¨ós1_mmx/§vÑ©iÿ: %f\n", ()
diff1_mmx
 / 
diffS
);

335 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/namehint.c

1 
	~"../ö˛ude/asoundlib.h
"

2 
	~<îr.h
>

4 
	$maö
(
¨gc
, *
¨gv
[])

6 c⁄° *
iÁ˚
 = "pcm";

7 **
höts
;

8 **
n
;

9 
îr
;

11 i‡(
¨gc
 > 1)

12 
iÁ˚
 = 
¨gv
[1];

13 
îr
 = 
	`¢d_devi˚_«me_höt
(-1, 
iÁ˚
, &
höts
);

14 i‡(
îr
 < 0)

15 
	`îrx
(1, "¢d_devi˚_«me_höàîr‹: %s", 
	`¢d_°ªº‹
(
îr
));

16 
n
 = (**)
höts
;

17 *
n
 !
NULL
) {

18 
	`¥ötf
("%s\n", *
n
);

19 
n
++;

21 
	`¢d_devi˚_«me_‰ì_höt
(
höts
);

23 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/oldapi.c

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~<°rög.h
>

26 
	~<sched.h
>

27 
	~<î∫o.h
>

28 
	~<gë›t.h
>

29 
	#ALSA_PCM_OLD_HW_PARAMS_API


	)

30 
	#ALSA_PCM_OLD_SW_PARAMS_API


	)

31 
	~"../ö˛ude/asoundlib.h
"

32 
	~<sys/time.h
>

34 (
	tmyf˙
)(c⁄° 
	t¢d_pcm_hw_∑øms_t
 *);

36 
	$maö
(
¨gc
 
ATTRIBUTE_UNUSED
, *
¨gv
[] ATTRIBUTE_UNUSED)

38 
myf˙
 *
f˙
;

39 
	`¢d_pcm_hw_∑øms_gë_ac˚ss
(
NULL
);

40 
f˙
 = &
¢d_pcm_hw_∑øms_gë_ac˚ss
;

42 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/omixer.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<°rög.h
>

4 
	~<sched.h
>

5 
	~<î∫o.h
>

6 
	~<gë›t.h
>

7 
	~"../ö˛ude/mixî_‹dö¨y.h
"

8 
	~<sys/time.h
>

9 
	~<m©h.h
>

11 
	$hñp
()

13 
	`¥ötf
(

19 
	}
}

21 
	$maö
(
¨gc
, *
¨gv
[])

23 
›ti⁄
 
l⁄g_›ti⁄
[] =

25 {"hñp", 0, 
NULL
, 'h'},

26 {"≤ame", 1, 
NULL
, 'P'},

27 {"˙ame", 1, 
NULL
, 'C'},

28 {
NULL
, 0, NULL, 0},

30 
îr
, 
m‹ehñp
, 
ªsu…
 = 
EXIT_SUCCESS
;

31 *
≤ame
 = "deÁu…", *
˙ame
 = "default";

32 
¢d_pcm_t
 *
ph™dÀ
 = 
NULL
, *
ch™dÀ
 = NULL;

33 
¢do_mixî_t
 *
h™dÀ
;

35 
m‹ehñp
 = 0;

37 
c
;

38 i‡((
c
 = 
	`gë›t_l⁄g
(
¨gc
, 
¨gv
, "hP:C:", 
l⁄g_›ti⁄
, 
NULL
)) < 0)

40 
c
) {

42 
m‹ehñp
++;

45 
≤ame
 = 
	`°rdup
(
›èrg
);

48 
˙ame
 = 
	`°rdup
(
›èrg
);

53 i‡(
m‹ehñp
) {

54 
	`hñp
();

58 i‡(
	`°rcmp
(
≤ame
, "-")) {

59 
îr
 = 
	`¢d_pcm_›í
(&
ph™dÀ
, 
≤ame
, 
SND_PCM_STREAM_PLAYBACK
, 0);

60 i‡(
îr
 < 0) {

61 
	`Ârötf
(
°dîr
, "Pœyback PCM o≥¿îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

62 
ªsu…
 = 
EXIT_FAILURE
;

63 
__íd
;

67 i‡(
	`°rcmp
(
˙ame
, "-")) {

68 
îr
 = 
	`¢d_pcm_›í
(&
ch™dÀ
, 
˙ame
, 
SND_PCM_STREAM_CAPTURE
, 0);

69 i‡(
îr
 < 0) {

70 i‡(
ph™dÀ
)

71 
	`¢d_pcm_˛o£
(
ph™dÀ
);

72 
	`Ârötf
(
°dîr
, "C≠tuª PCM o≥¿îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

73 
ªsu…
 = 
EXIT_FAILURE
;

74 
__íd
;

78 
îr
 = 
	`¢do_mixî_›í_pcm
(&
h™dÀ
, 
ph™dÀ
, 
ch™dÀ
, 
NULL
);

79 i‡(
îr
 < 0) {

80 
	`Ârötf
(
°dîr
, "mixî o≥¿îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

81 
ªsu…
 = 
EXIT_FAILURE
;

83 
	`¢do_mixî_˛o£
(
h™dÀ
);

85 
__íd
:

86 i‡(
ch™dÀ
)

87 
	`¢d_pcm_˛o£
(
ch™dÀ
);

88 i‡(
ph™dÀ
)

89 
	`¢d_pcm_˛o£
(
ph™dÀ
);

90 
	`¢d_c⁄fig_upd©e_‰ì_globÆ
();

91  
ªsu…
;

92 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/pcm-multi-thread.c

20 
	~<°dio.h
>

21 
	~<±hªad.h
>

22 
	~<gë›t.h
>

23 
	~"../ö˛ude/asoundlib.h
"

25 
	#MAX_THREADS
 10

	)

28 
	mMODE_AVAIL_UPDATE
,

29 
	mMODE_STATUS
,

30 
	mMODE_HWSYNC
,

31 
	mMODE_TIMESTAMP
,

32 
	mMODE_DELAY
,

33 
	mMODE_RANDOM


36 
	gmode_suffix
[] = {

40 c⁄° *
	gpcmdev
 = "default";

41 
	g°ªam
 = 
SND_PCM_STREAM_PLAYBACK
;

42 
	gnum_thªads
 = 1;

43 
	g≥riodsize
 = 16 * 1024;

44 
	gbufsize
 = 16 * 1024 * 4;

45 
	gch™√ls
 = 2;

46 
	gøã
 = 48000;

47 
¢d_pcm_f‹m©_t
 
	gf‹m©
 = 
SND_PCM_FORMAT_S16_LE
;

49 
	gru¬ög_mode
 = 
MODE_AVAIL_UPDATE
;

50 
	gshow_vÆue
 = 0;

51 
	gquõt
 = 0;

53 
±hªad_t
 
	g≥ïî_thªads
[
MAX_THREADS
];

54 
	gru¬ög
 = 1;

55 
¢d_pcm_t
 *
	gpcm
;

57 *
	$≥ïî
(*
d©a
)

59 
thªad_no
 = ()
d©a
;

60 
¢d_pcm_s‰ames_t
 
vÆ
;

61 
¢d_pcm_°©us_t
 *
°©
;

62 
¢d_htime°amp_t
 
t°amp
;

63 
mode
 = 
ru¬ög_mode
, 
îr
;

65 
	`¢d_pcm_°©us_Æloˇ
(&
°©
);

67 
ru¬ög
) {

68 i‡(
ru¬ög_mode
 =
MODE_RANDOM
)

69 
mode
 = 
	`ønd
(Ë% 
MODE_RANDOM
;

70 
mode
) {

71 
MODE_AVAIL_UPDATE
:

72 
vÆ
 = 
	`¢d_pcm_avaû_upd©e
(
pcm
);

73 
îr
 = 0;

75 
MODE_STATUS
:

76 
îr
 = 
	`¢d_pcm_°©us
(
pcm
, 
°©
);

77 
vÆ
 = 
	`¢d_pcm_°©us_gë_avaû
(
°©
);

79 
MODE_HWSYNC
:

80 
îr
 = 
	`¢d_pcm_hwsync
(
pcm
);

82 
MODE_TIMESTAMP
:

83 
îr
 = 
	`¢d_pcm_htime°amp
(
pcm
, (
¢d_pcm_u‰ames_t
 *)&
vÆ
,

84 &
t°amp
);

87 
îr
 = 
	`¢d_pcm_dñay
(
pcm
, &
vÆ
);

91 i‡(
quõt
)

93 i‡(
ru¬ög_mode
 =
MODE_RANDOM
) {

94 
	`Ârötf
(
°dîr
, "%d%c%s", 
thªad_no
, 
mode_suffix
[
mode
],

95 
îr
 ? "!" : "");

97 i‡(
show_vÆue
 && 
mode
 !
MODE_HWSYNC
)

98 
	`Ârötf
(
°dîr
, "\r%d ", ()
vÆ
);

100 
	`Ârötf
(
°dîr
, "%d%s", 
thªad_no
,

101 
îr
 ? "!" : "");

104  
NULL
;

105 
	}
}

107 
	$ußge
()

109 
	`Ârötf
(
°dîr
, "usage: multi-thread [-options]\n");

110 
	`Ârötf
(
°dîr
, " -D str Set deviceÇame\n");

111 
	`Ârötf
(
°dîr
, " -r val Set sampleÑate\n");

112 
	`Ârötf
(
°dîr
, " -p val SetÖeriod size (in frame)\n");

113 
	`Ârötf
(
°dîr
, " -b val Set buffer size (in frame)\n");

114 
	`Ârötf
(
°dîr
, " -c val SetÇumber of channels\n");

115 
	`Ârötf
(
°dîr
, " -f str Set PCM format\n");

116 
	`Ârötf
(
°dîr
, " -s str Set stream direction (playback or capture)\n");

117 
	`Ârötf
(
°dîr
, " -t val SetÇumber ofÅhreads\n");

118 
	`Ârötf
(
°dîr
, " -m str Running mode (avail, status, hwsync,Åimestamp, delay,Ñandom)\n");

119 
	`Ârötf
(
°dîr
, " -v Show value\n");

120 
	`Ârötf
(
°dîr
, " -q Quiet mode\n");

121 
	}
}

123 
	$∑r£_›ti⁄s
(
¨gc
, **
¨gv
)

125 
c
, 
i
;

127 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "D:r:f:p:b:s:t:m:vq")) >= 0) {

128 
c
) {

130 
pcmdev
 = 
›èrg
;

133 
øã
 = 
	`©oi
(
›èrg
);

136 
≥riodsize
 = 
	`©oi
(
›èrg
);

139 
bufsize
 = 
	`©oi
(
›èrg
);

142 
ch™√ls
 = 
	`©oi
(
›èrg
);

145 
f‹m©
 = 
	`¢d_pcm_f‹m©_vÆue
(
›èrg
);

148 i‡(*
›èrg
 == 'p' || *optarg == 'P')

149 
°ªam
 = 
SND_PCM_STREAM_PLAYBACK
;

150 i‡(*
›èrg
 == 'c' || *optarg == 'C')

151 
°ªam
 = 
SND_PCM_STREAM_CAPTURE
;

153 
	`Ârötf
(
°dîr
, "invalid stream direction\n");

158 
num_thªads
 = 
	`©oi
(
›èrg
);

159 i‡(
num_thªads
 < 1 ||Çum_thªad†> 
MAX_THREADS
) {

160 
	`Ârötf
(
°dîr
, "invalidÇumber ofÅhreads\n");

165 
i
 = 0; i <
MODE_RANDOM
; i++)

166 i‡(
mode_suffix
[
i
] =*
›èrg
)

168 i‡(
i
 > 
MODE_RANDOM
) {

169 
	`Ârötf
(
°dîr
, "invalid modeÅype\n");

172 
ru¬ög_mode
 = 
i
;

175 
show_vÆue
 = 1;

178 
quõt
 = 1;

181 
	`ußge
();

186 
	}
}

188 
	$£tup_∑øms
()

190 
¢d_pcm_hw_∑øms_t
 *
hw
;

193 
	`¢d_pcm_hw_∑øms_Æloˇ
(&
hw
);

194 
	`¢d_pcm_hw_∑øms_™y
(
pcm
, 
hw
);

195 
	`¢d_pcm_hw_∑øms_£t_ac˚ss
(
pcm
, 
hw
, 
SND_PCM_ACCESS_RW_INTERLEAVED
);

196 
	`¢d_pcm_hw_∑øms_£t_f‹m©
(
pcm
, 
hw
, 
f‹m©
);

197 
	`¢d_pcm_hw_∑øms_£t_ch™√ls
(
pcm
, 
hw
, 
ch™√ls
);

198 
	`¢d_pcm_hw_∑øms_£t_øã
(
pcm
, 
hw
, 
øã
, 0);

199 
	`¢d_pcm_hw_∑øms_£t_≥riod_size
(
pcm
, 
hw
, 
≥riodsize
, 0);

200 
	`¢d_pcm_hw_∑øms_£t_buf„r_size
(
pcm
, 
hw
, 
bufsize
);

201 i‡(
	`¢d_pcm_hw_∑øms
(
pcm
, 
hw
) < 0) {

202 
	`Ârötf
(
°dîr
, "snd_pcm_hw_paramsÉrror\n");

206 
	}
}

208 
	$maö
(
¨gc
, **
¨gv
)

210 *
buf
;

211 
i
, 
îr
;

213 i‡(
	`∑r£_›ti⁄s
(
¨gc
, 
¨gv
))

216 
îr
 = 
	`¢d_pcm_›í
(&
pcm
, 
pcmdev
, 
°ªam
, 0);

217 i‡(
îr
 < 0) {

218 
	`Ârötf
(
°dîr
, "ˇ¬Ÿ o≥¿pcm %s\n", 
pcmdev
);

222 i‡(
	`£tup_∑øms
())

225 
buf
 = 
	`ˇŒoc
(1, 
	`¢d_pcm_f‹m©_size
(
f‹m©
, 
bufsize
Ë* 
ch™√ls
);

226 i‡(!
buf
) {

227 
	`Ârötf
(
°dîr
, "cannotálloc buffer\n");

231 
i
 = 0; i < 
num_thªads
; i++) {

232 i‡(
	`±hªad_¸óã
(&
≥ïî_thªads
[
i
], 
NULL
, 
≥ïî
, (*)()i)) {

233 
	`Ârötf
(
°dîr
, "pthread_createÉrror\n");

238 i‡(
°ªam
 =
SND_PCM_STREAM_CAPTURE
)

239 
	`¢d_pcm_°¨t
(
pcm
);

241 
size
 = 
	`ønd
(Ë% (
bufsize
 / 2);

242 i‡(
°ªam
 =
SND_PCM_STREAM_PLAYBACK
)

243 
îr
 = 
	`¢d_pcm_wrôei
(
pcm
, 
buf
, 
size
);

245 
îr
 = 
	`¢d_pcm_ªadi
(
pcm
, 
buf
, 
size
);

246 i‡(
îr
 < 0) {

247 
	`Ârötf
(
°dîr
, "ªad/wrôêîr‹ %d\n", 
îr
);

248 
îr
 = 
	`¢d_pcm_ªcovî
(
pcm
,Érr, 0);

249 i‡(
îr
 < 0)

251 i‡(
°ªam
 =
SND_PCM_STREAM_CAPTURE
)

252 
	`¢d_pcm_°¨t
(
pcm
);

256 
ru¬ög
 = 0;

257 
i
 = 0; i < 
num_thªads
; i++)

258 
	`±hªad_ˇn˚l
(
≥ïî_thªads
[
i
]);

259 
i
 = 0; i < 
num_thªads
; i++)

260 
	`±hªad_joö
(
≥ïî_thªads
[
i
], 
NULL
);

263 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/pcm.c

5 
	~"c⁄fig.h
"

7 
	~<°dio.h
>

8 
	~<°dlib.h
>

9 
	~<°rög.h
>

10 
	~<sched.h
>

11 
	~<î∫o.h
>

12 
	~<gë›t.h
>

13 
	~"../ö˛ude/asoundlib.h
"

14 
	~<sys/time.h
>

15 
	~<m©h.h
>

17 #i‚de‡
ESTRPIPE


18 
	#ESTRPIPE
 
ESPIPE


	)

21 *
	gdevi˚
 = "plughw:0,0";

22 
¢d_pcm_f‹m©_t
 
	gf‹m©
 = 
SND_PCM_FORMAT_S16
;

23 
	gøã
 = 44100;

24 
	gch™√ls
 = 1;

25 
	gbuf„r_time
 = 500000;

26 
	g≥riod_time
 = 100000;

27 
	g‰eq
 = 440;

28 
	gvîbo£
 = 0;

29 
	gªßm∂e
 = 1;

30 
	g≥riod_evít
 = 0;

32 
¢d_pcm_s‰ames_t
 
	gbuf„r_size
;

33 
¢d_pcm_s‰ames_t
 
	g≥riod_size
;

34 
¢d_ouçut_t
 *
	gouçut
 = 
NULL
;

36 
	$gíî©e_söe
(c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
,

37 
¢d_pcm_u‰ames_t
 
off£t
,

38 
cou¡
, *
_pha£
)

40 
max_pha£
 = 2. * 
M_PI
;

41 
pha£
 = *
_pha£
;

42 
°ï
 = 
max_pha£
*
‰eq
/()
øã
;

43 *
ßm∂es
[
ch™√ls
];

44 
°ïs
[
ch™√ls
];

45 
chn
;

46 
f‹m©_bôs
 = 
	`¢d_pcm_f‹m©_width
(
f‹m©
);

47 
maxvÆ
 = (1 << (
f‹m©_bôs
 - 1)) - 1;

48 
bps
 = 
f‹m©_bôs
 / 8;

49 
phys_bps
 = 
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
) / 8;

50 
big_ídün
 = 
	`¢d_pcm_f‹m©_big_ídün
(
f‹m©
) == 1;

51 
to_unsig√d
 = 
	`¢d_pcm_f‹m©_unsig√d
(
f‹m©
) == 1;

52 
is_Êﬂt
 = (
f‹m©
 =
SND_PCM_FORMAT_FLOAT_LE
 ||

53 
f‹m©
 =
SND_PCM_FORMAT_FLOAT_BE
);

56 
chn
 = 0; ch¿< 
ch™√ls
; chn++) {

57 i‡((
¨ós
[
chn
].
fú°
 % 8) != 0) {

58 
	`¥ötf
("¨ós[%u].fú° =%u,áb‹tög...\n", 
chn
, 
¨ós
[chn].
fú°
);

59 
	`exô
(
EXIT_FAILURE
);

61 
ßm∂es
[
chn
] = (((*)
¨ós
[chn].
addr
Ë+ (¨ós[chn].
fú°
 / 8));

62 i‡((
¨ós
[
chn
].
°ï
 % 16) != 0) {

63 
	`¥ötf
("¨ós[%u].°ï =%u,áb‹tög...\n", 
chn
, 
¨ós
[chn].
°ï
);

64 
	`exô
(
EXIT_FAILURE
);

66 
°ïs
[
chn
] = 
¨ós
[chn].
°ï
 / 8;

67 
ßm∂es
[
chn
] +
off£t
 * 
°ïs
[chn];

70 
cou¡
-- > 0) {

72 
f
;

73 
i
;

74 } 
fvÆ
;

75 
ªs
, 
i
;

76 i‡(
is_Êﬂt
) {

77 
fvÆ
.
f
 = 
	`sö
(
pha£
);

78 
ªs
 = 
fvÆ
.
i
;

80 
ªs
 = 
	`sö
(
pha£
Ë* 
maxvÆ
;

81 i‡(
to_unsig√d
)

82 
ªs
 ^1U << (
f‹m©_bôs
 - 1);

83 
chn
 = 0; ch¿< 
ch™√ls
; chn++) {

85 i‡(
big_ídün
) {

86 
i
 = 0; i < 
bps
; i++)

87 *(
ßm∂es
[
chn
] + 
phys_bps
 - 1 - 
i
Ë(
ªs
 >> i * 8) & 0xff;

89 
i
 = 0; i < 
bps
; i++)

90 *(
ßm∂es
[
chn
] + 
i
Ë(
ªs
 >> i * 8) & 0xff;

92 
ßm∂es
[
chn
] +
°ïs
[chn];

94 
pha£
 +
°ï
;

95 i‡(
pha£
 >
max_pha£
)

96 
pha£
 -
max_pha£
;

98 *
_pha£
 = 
pha£
;

99 
	}
}

101 
	$£t_hw∑øms
(
¢d_pcm_t
 *
h™dÀ
,

102 
¢d_pcm_hw_∑øms_t
 *
∑øms
,

103 
¢d_pcm_ac˚ss_t
 
ac˚ss
)

105 
º©e
;

106 
¢d_pcm_u‰ames_t
 
size
;

107 
îr
, 
dú
;

110 
îr
 = 
	`¢d_pcm_hw_∑øms_™y
(
h™dÀ
, 
∑øms
);

111 i‡(
îr
 < 0) {

112 
	`¥ötf
("Brokí c⁄figuøti⁄ f‹Öœyback:Çÿc⁄figuøti⁄†avaûabÀ: %s\n", 
	`¢d_°ªº‹
(
îr
));

113  
îr
;

116 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_øã_ªßm∂e
(
h™dÀ
, 
∑øms
, 
ªßm∂e
);

117 i‡(
îr
 < 0) {

118 
	`¥ötf
("Reßm∂ög sëu∞Áûed f‹Öœyback: %s\n", 
	`¢d_°ªº‹
(
îr
));

119  
îr
;

122 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_ac˚ss
(
h™dÀ
, 
∑øms
, 
ac˚ss
);

123 i‡(
îr
 < 0) {

124 
	`¥ötf
("Ac˚s†ty≥ÇŸávaûabÀ f‹Öœyback: %s\n", 
	`¢d_°ªº‹
(
îr
));

125  
îr
;

128 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_f‹m©
(
h™dÀ
, 
∑øms
, 
f‹m©
);

129 i‡(
îr
 < 0) {

130 
	`¥ötf
("Sam∂êf‹m©ÇŸávaûabÀ f‹Öœyback: %s\n", 
	`¢d_°ªº‹
(
îr
));

131  
îr
;

134 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_ch™√ls
(
h™dÀ
, 
∑øms
, 
ch™√ls
);

135 i‡(
îr
 < 0) {

136 
	`¥ötf
("Ch™√l†cou¡ (%uËnŸávaûabÀ f‹Öœybacks: %s\n", 
ch™√ls
, 
	`¢d_°ªº‹
(
îr
));

137  
îr
;

140 
º©e
 = 
øã
;

141 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_øã_√¨
(
h™dÀ
, 
∑øms
, &
º©e
, 0);

142 i‡(
îr
 < 0) {

143 
	`¥ötf
("R©ê%uHzÇŸávaûabÀ f‹Öœyback: %s\n", 
øã
, 
	`¢d_°ªº‹
(
îr
));

144  
îr
;

146 i‡(
º©e
 !
øã
) {

147 
	`¥ötf
("R©êd€¢'àm©ch (ªque°ed %uHz, gë %iHz)\n", 
øã
, 
îr
);

148  -
EINVAL
;

151 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_buf„r_time_√¨
(
h™dÀ
, 
∑øms
, &
buf„r_time
, &
dú
);

152 i‡(
îr
 < 0) {

153 
	`¥ötf
("U«bÀÅÿ£àbuf„∏timê%u f‹Öœyback: %s\n", 
buf„r_time
, 
	`¢d_°ªº‹
(
îr
));

154  
îr
;

156 
îr
 = 
	`¢d_pcm_hw_∑øms_gë_buf„r_size
(
∑øms
, &
size
);

157 i‡(
îr
 < 0) {

158 
	`¥ötf
("U«bÀÅÿgë buf„∏sizêf‹Öœyback: %s\n", 
	`¢d_°ªº‹
(
îr
));

159  
îr
;

161 
buf„r_size
 = 
size
;

163 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_≥riod_time_√¨
(
h™dÀ
, 
∑øms
, &
≥riod_time
, &
dú
);

164 i‡(
îr
 < 0) {

165 
	`¥ötf
("U«bÀÅÿ£à≥riodÅimê%u f‹Öœyback: %s\n", 
≥riod_time
, 
	`¢d_°ªº‹
(
îr
));

166  
îr
;

168 
îr
 = 
	`¢d_pcm_hw_∑øms_gë_≥riod_size
(
∑øms
, &
size
, &
dú
);

169 i‡(
îr
 < 0) {

170 
	`¥ötf
("U«bÀÅÿgëÖîiod sizêf‹Öœyback: %s\n", 
	`¢d_°ªº‹
(
îr
));

171  
îr
;

173 
≥riod_size
 = 
size
;

175 
îr
 = 
	`¢d_pcm_hw_∑øms
(
h™dÀ
, 
∑øms
);

176 i‡(
îr
 < 0) {

177 
	`¥ötf
("U«bÀÅÿ£àhwÖ¨am†f‹Öœyback: %s\n", 
	`¢d_°ªº‹
(
îr
));

178  
îr
;

181 
	}
}

183 
	$£t_sw∑øms
(
¢d_pcm_t
 *
h™dÀ
, 
¢d_pcm_sw_∑øms_t
 *
sw∑øms
)

185 
îr
;

188 
îr
 = 
	`¢d_pcm_sw_∑øms_cuºít
(
h™dÀ
, 
sw∑øms
);

189 i‡(
îr
 < 0) {

190 
	`¥ötf
("U«bÀÅÿdëîmöêcuºíàsw∑øm†f‹Öœyback: %s\n", 
	`¢d_°ªº‹
(
îr
));

191  
îr
;

195 
îr
 = 
	`¢d_pcm_sw_∑øms_£t_°¨t_thªshﬁd
(
h™dÀ
, 
sw∑øms
, (
buf„r_size
 / 
≥riod_size
) *Öeriod_size);

196 i‡(
îr
 < 0) {

197 
	`¥ötf
("U«bÀÅÿ£à°¨àthªshﬁd modêf‹Öœyback: %s\n", 
	`¢d_°ªº‹
(
îr
));

198  
îr
;

202 
îr
 = 
	`¢d_pcm_sw_∑øms_£t_avaû_mö
(
h™dÀ
, 
sw∑øms
, 
≥riod_evít
 ? 
buf„r_size
 : 
≥riod_size
);

203 i‡(
îr
 < 0) {

204 
	`¥ötf
("U«bÀÅÿ£àavaû mö f‹Öœyback: %s\n", 
	`¢d_°ªº‹
(
îr
));

205  
îr
;

208 i‡(
≥riod_evít
) {

209 
îr
 = 
	`¢d_pcm_sw_∑øms_£t_≥riod_evít
(
h™dÀ
, 
sw∑øms
, 1);

210 i‡(
îr
 < 0) {

211 
	`¥ötf
("U«bÀÅÿ£à≥riodÉvít: %s\n", 
	`¢d_°ªº‹
(
îr
));

212  
îr
;

216 
îr
 = 
	`¢d_pcm_sw_∑øms
(
h™dÀ
, 
sw∑øms
);

217 i‡(
îr
 < 0) {

218 
	`¥ötf
("U«bÀÅÿ£àswÖ¨am†f‹Öœyback: %s\n", 
	`¢d_°ªº‹
(
îr
));

219  
îr
;

222 
	}
}

228 
	$xrun_ªcovîy
(
¢d_pcm_t
 *
h™dÀ
, 
îr
)

230 i‡(
vîbo£
)

231 
	`¥ötf
("streamÑecovery\n");

232 i‡(
îr
 =-
EPIPE
) {

233 
îr
 = 
	`¢d_pcm_¥ï¨e
(
h™dÀ
);

234 i‡(
îr
 < 0)

235 
	`¥ötf
("C™'àªcovîy from undîrun,Öª∑ª faûed: %s\n", 
	`¢d_°ªº‹
(
îr
));

237 } i‡(
îr
 =-
ESTRPIPE
) {

238 (
îr
 = 
	`¢d_pcm_ªsume
(
h™dÀ
)Ë=-
EAGAIN
)

239 
	`¶ìp
(1);

240 i‡(
îr
 < 0) {

241 
îr
 = 
	`¢d_pcm_¥ï¨e
(
h™dÀ
);

242 i‡(
îr
 < 0)

243 
	`¥ötf
("C™'àªcovîy from su•íd,Öª∑ª faûed: %s\n", 
	`¢d_°ªº‹
(
îr
));

247  
îr
;

248 
	}
}

254 
	$wrôe_lo›
(
¢d_pcm_t
 *
h™dÀ
,

255 sig√d *
ßm∂es
,

256 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
)

258 
pha£
 = 0;

259 sig√d *
±r
;

260 
îr
, 
˝å
;

263 
	`gíî©e_söe
(
¨ós
, 0, 
≥riod_size
, &
pha£
);

264 
±r
 = 
ßm∂es
;

265 
˝å
 = 
≥riod_size
;

266 
˝å
 > 0) {

267 
îr
 = 
	`¢d_pcm_wrôei
(
h™dÀ
, 
±r
, 
˝å
);

268 i‡(
îr
 =-
EAGAIN
)

270 i‡(
îr
 < 0) {

271 i‡(
	`xrun_ªcovîy
(
h™dÀ
, 
îr
) < 0) {

272 
	`¥ötf
("Wrôêîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

273 
	`exô
(
EXIT_FAILURE
);

277 
±r
 +
îr
 * 
ch™√ls
;

278 
˝å
 -
îr
;

281 
	}
}

287 
	$waô_f‹_pﬁl
(
¢d_pcm_t
 *
h™dÀ
, 
pﬁlfd
 *
ufds
, 
cou¡
)

289 
ªvíts
;

292 
	`pﬁl
(
ufds
, 
cou¡
, -1);

293 
	`¢d_pcm_pﬁl_des¸ùt‹s_ªvíts
(
h™dÀ
, 
ufds
, 
cou¡
, &
ªvíts
);

294 i‡(
ªvíts
 & 
POLLERR
)

295  -
EIO
;

296 i‡(
ªvíts
 & 
POLLOUT
)

299 
	}
}

301 
	$wrôe_™d_pﬁl_lo›
(
¢d_pcm_t
 *
h™dÀ
,

302 sig√d *
ßm∂es
,

303 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
)

305 
pﬁlfd
 *
ufds
;

306 
pha£
 = 0;

307 sig√d *
±r
;

308 
îr
, 
cou¡
, 
˝å
, 
öô
;

310 
cou¡
 = 
	`¢d_pcm_pﬁl_des¸ùt‹s_cou¡
 (
h™dÀ
);

311 i‡(
cou¡
 <= 0) {

312 
	`¥ötf
("InvalidÖoll descriptors count\n");

313  
cou¡
;

316 
ufds
 = 
	`mÆloc
((
pﬁlfd
Ë* 
cou¡
);

317 i‡(
ufds
 =
NULL
) {

318 
	`¥ötf
("NoÉnough memory\n");

319  -
ENOMEM
;

321 i‡((
îr
 = 
	`¢d_pcm_pﬁl_des¸ùt‹s
(
h™dÀ
, 
ufds
, 
cou¡
)) < 0) {

322 
	`¥ötf
("U«bÀÅÿobèöÖﬁ»des¸ùt‹†f‹Öœyback: %s\n", 
	`¢d_°ªº‹
(
îr
));

323  
îr
;

326 
öô
 = 1;

328 i‡(!
öô
) {

329 
îr
 = 
	`waô_f‹_pﬁl
(
h™dÀ
, 
ufds
, 
cou¡
);

330 i‡(
îr
 < 0) {

331 i‡(
	`¢d_pcm_°©e
(
h™dÀ
Ë=
SND_PCM_STATE_XRUN
 ||

332 
	`¢d_pcm_°©e
(
h™dÀ
Ë=
SND_PCM_STATE_SUSPENDED
) {

333 
îr
 = 
	`¢d_pcm_°©e
(
h™dÀ
Ë=
SND_PCM_STATE_XRUN
 ? -
EPIPE
 : -
ESTRPIPE
;

334 i‡(
	`xrun_ªcovîy
(
h™dÀ
, 
îr
) < 0) {

335 
	`¥ötf
("Wrôêîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

336 
	`exô
(
EXIT_FAILURE
);

338 
öô
 = 1;

340 
	`¥ötf
("Wait forÖoll failed\n");

341  
îr
;

346 
	`gíî©e_söe
(
¨ós
, 0, 
≥riod_size
, &
pha£
);

347 
±r
 = 
ßm∂es
;

348 
˝å
 = 
≥riod_size
;

349 
˝å
 > 0) {

350 
îr
 = 
	`¢d_pcm_wrôei
(
h™dÀ
, 
±r
, 
˝å
);

351 i‡(
îr
 < 0) {

352 i‡(
	`xrun_ªcovîy
(
h™dÀ
, 
îr
) < 0) {

353 
	`¥ötf
("Wrôêîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

354 
	`exô
(
EXIT_FAILURE
);

356 
öô
 = 1;

359 i‡(
	`¢d_pcm_°©e
(
h™dÀ
Ë=
SND_PCM_STATE_RUNNING
)

360 
öô
 = 0;

361 
±r
 +
îr
 * 
ch™√ls
;

362 
˝å
 -
îr
;

363 i‡(
˝å
 == 0)

367 
îr
 = 
	`waô_f‹_pﬁl
(
h™dÀ
, 
ufds
, 
cou¡
);

368 i‡(
îr
 < 0) {

369 i‡(
	`¢d_pcm_°©e
(
h™dÀ
Ë=
SND_PCM_STATE_XRUN
 ||

370 
	`¢d_pcm_°©e
(
h™dÀ
Ë=
SND_PCM_STATE_SUSPENDED
) {

371 
îr
 = 
	`¢d_pcm_°©e
(
h™dÀ
Ë=
SND_PCM_STATE_XRUN
 ? -
EPIPE
 : -
ESTRPIPE
;

372 i‡(
	`xrun_ªcovîy
(
h™dÀ
, 
îr
) < 0) {

373 
	`¥ötf
("Wrôêîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

374 
	`exô
(
EXIT_FAILURE
);

376 
öô
 = 1;

378 
	`¥ötf
("Wait forÖoll failed\n");

379  
îr
;

384 
	}
}

390 
	sasync_¥iv©e_d©a
 {

391 sig√d *
	mßm∂es
;

392 
¢d_pcm_ch™√l_¨ó_t
 *
	m¨ós
;

393 
	mpha£
;

396 
	$async_ˇŒback
(
¢d_async_h™dÀr_t
 *
ah™dÀr
)

398 
¢d_pcm_t
 *
h™dÀ
 = 
	`¢d_async_h™dÀr_gë_pcm
(
ah™dÀr
);

399 
async_¥iv©e_d©a
 *
d©a
 = 
	`¢d_async_h™dÀr_gë_ˇŒback_¥iv©e
(
ah™dÀr
);

400 sig√d *
ßm∂es
 = 
d©a
->samples;

401 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
 = 
d©a
->areas;

402 
¢d_pcm_s‰ames_t
 
avaû
;

403 
îr
;

405 
avaû
 = 
	`¢d_pcm_avaû_upd©e
(
h™dÀ
);

406 
avaû
 >
≥riod_size
) {

407 
	`gíî©e_söe
(
¨ós
, 0, 
≥riod_size
, &
d©a
->
pha£
);

408 
îr
 = 
	`¢d_pcm_wrôei
(
h™dÀ
, 
ßm∂es
, 
≥riod_size
);

409 i‡(
îr
 < 0) {

410 
	`¥ötf
("Wrôêîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

411 
	`exô
(
EXIT_FAILURE
);

413 i‡(
îr
 !
≥riod_size
) {

414 
	`¥ötf
("Wrôêîr‹: wrôã¿%òex≥˘ed %li\n", 
îr
, 
≥riod_size
);

415 
	`exô
(
EXIT_FAILURE
);

417 
avaû
 = 
	`¢d_pcm_avaû_upd©e
(
h™dÀ
);

419 
	}
}

421 
	$async_lo›
(
¢d_pcm_t
 *
h™dÀ
,

422 sig√d *
ßm∂es
,

423 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
)

425 
async_¥iv©e_d©a
 
d©a
;

426 
¢d_async_h™dÀr_t
 *
ah™dÀr
;

427 
îr
, 
cou¡
;

429 
d©a
.
ßm∂es
 = samples;

430 
d©a
.
¨ós
 =áreas;

431 
d©a
.
pha£
 = 0;

432 
îr
 = 
	`¢d_async_add_pcm_h™dÀr
(&
ah™dÀr
, 
h™dÀ
, 
async_ˇŒback
, &
d©a
);

433 i‡(
îr
 < 0) {

434 
	`¥ötf
("UnableÅoÑegisterásync handler\n");

435 
	`exô
(
EXIT_FAILURE
);

437 
cou¡
 = 0; count < 2; count++) {

438 
	`gíî©e_söe
(
¨ós
, 0, 
≥riod_size
, &
d©a
.
pha£
);

439 
îr
 = 
	`¢d_pcm_wrôei
(
h™dÀ
, 
ßm∂es
, 
≥riod_size
);

440 i‡(
îr
 < 0) {

441 
	`¥ötf
("Inôü»wrôêîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

442 
	`exô
(
EXIT_FAILURE
);

444 i‡(
îr
 !
≥riod_size
) {

445 
	`¥ötf
("Inôü»wrôêîr‹: wrôã¿%òex≥˘ed %li\n", 
îr
, 
≥riod_size
);

446 
	`exô
(
EXIT_FAILURE
);

449 i‡(
	`¢d_pcm_°©e
(
h™dÀ
Ë=
SND_PCM_STATE_PREPARED
) {

450 
îr
 = 
	`¢d_pcm_°¨t
(
h™dÀ
);

451 i‡(
îr
 < 0) {

452 
	`¥ötf
("SèπÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

453 
	`exô
(
EXIT_FAILURE
);

460 
	`¶ìp
(1);

462 
	}
}

468 
	$async_dúe˘_ˇŒback
(
¢d_async_h™dÀr_t
 *
ah™dÀr
)

470 
¢d_pcm_t
 *
h™dÀ
 = 
	`¢d_async_h™dÀr_gë_pcm
(
ah™dÀr
);

471 
async_¥iv©e_d©a
 *
d©a
 = 
	`¢d_async_h™dÀr_gë_ˇŒback_¥iv©e
(
ah™dÀr
);

472 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
my_¨ós
;

473 
¢d_pcm_u‰ames_t
 
off£t
, 
‰ames
, 
size
;

474 
¢d_pcm_s‰ames_t
 
avaû
, 
commôªs
;

475 
¢d_pcm_°©e_t
 
°©e
;

476 
fú°
 = 0, 
îr
;

479 
°©e
 = 
	`¢d_pcm_°©e
(
h™dÀ
);

480 i‡(
°©e
 =
SND_PCM_STATE_XRUN
) {

481 
îr
 = 
	`xrun_ªcovîy
(
h™dÀ
, -
EPIPE
);

482 i‡(
îr
 < 0) {

483 
	`¥ötf
("XRUNÑecovîy faûed: %s\n", 
	`¢d_°ªº‹
(
îr
));

484 
	`exô
(
EXIT_FAILURE
);

486 
fú°
 = 1;

487 } i‡(
°©e
 =
SND_PCM_STATE_SUSPENDED
) {

488 
îr
 = 
	`xrun_ªcovîy
(
h™dÀ
, -
ESTRPIPE
);

489 i‡(
îr
 < 0) {

490 
	`¥ötf
("SUSPENDÑecovîy faûed: %s\n", 
	`¢d_°ªº‹
(
îr
));

491 
	`exô
(
EXIT_FAILURE
);

494 
avaû
 = 
	`¢d_pcm_avaû_upd©e
(
h™dÀ
);

495 i‡(
avaû
 < 0) {

496 
îr
 = 
	`xrun_ªcovîy
(
h™dÀ
, 
avaû
);

497 i‡(
îr
 < 0) {

498 
	`¥ötf
("avaû upd©êÁûed: %s\n", 
	`¢d_°ªº‹
(
îr
));

499 
	`exô
(
EXIT_FAILURE
);

501 
fú°
 = 1;

504 i‡(
avaû
 < 
≥riod_size
) {

505 i‡(
fú°
) {

506 
fú°
 = 0;

507 
îr
 = 
	`¢d_pcm_°¨t
(
h™dÀ
);

508 i‡(
îr
 < 0) {

509 
	`¥ötf
("SèπÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

510 
	`exô
(
EXIT_FAILURE
);

517 
size
 = 
≥riod_size
;

518 
size
 > 0) {

519 
‰ames
 = 
size
;

520 
îr
 = 
	`¢d_pcm_mm≠_begö
(
h™dÀ
, &
my_¨ós
, &
off£t
, &
‰ames
);

521 i‡(
îr
 < 0) {

522 i‡((
îr
 = 
	`xrun_ªcovîy
(
h™dÀ
,Érr)) < 0) {

523 
	`¥ötf
("MMAP begöávaûÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

524 
	`exô
(
EXIT_FAILURE
);

526 
fú°
 = 1;

528 
	`gíî©e_söe
(
my_¨ós
, 
off£t
, 
‰ames
, &
d©a
->
pha£
);

529 
commôªs
 = 
	`¢d_pcm_mm≠_commô
(
h™dÀ
, 
off£t
, 
‰ames
);

530 i‡(
commôªs
 < 0 || (
¢d_pcm_u‰ames_t
)commôª†!
‰ames
) {

531 i‡((
îr
 = 
	`xrun_ªcovîy
(
h™dÀ
, 
commôªs
 >0 ? -
EPIPE
 : commitres)) < 0) {

532 
	`¥ötf
("MMAP commôÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

533 
	`exô
(
EXIT_FAILURE
);

535 
fú°
 = 1;

537 
size
 -
‰ames
;

540 
	}
}

542 
	$async_dúe˘_lo›
(
¢d_pcm_t
 *
h™dÀ
,

543 sig√d *
ßm∂es
 
ATTRIBUTE_UNUSED
,

544 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
 
ATTRIBUTE_UNUSED
)

546 
async_¥iv©e_d©a
 
d©a
;

547 
¢d_async_h™dÀr_t
 *
ah™dÀr
;

548 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
my_¨ós
;

549 
¢d_pcm_u‰ames_t
 
off£t
, 
‰ames
, 
size
;

550 
¢d_pcm_s‰ames_t
 
commôªs
;

551 
îr
, 
cou¡
;

553 
d©a
.
ßm∂es
 = 
NULL
;

554 
d©a
.
¨ós
 = 
NULL
;

555 
d©a
.
pha£
 = 0;

556 
îr
 = 
	`¢d_async_add_pcm_h™dÀr
(&
ah™dÀr
, 
h™dÀ
, 
async_dúe˘_ˇŒback
, &
d©a
);

557 i‡(
îr
 < 0) {

558 
	`¥ötf
("UnableÅoÑegisterásync handler\n");

559 
	`exô
(
EXIT_FAILURE
);

561 
cou¡
 = 0; count < 2; count++) {

562 
size
 = 
≥riod_size
;

563 
size
 > 0) {

564 
‰ames
 = 
size
;

565 
îr
 = 
	`¢d_pcm_mm≠_begö
(
h™dÀ
, &
my_¨ós
, &
off£t
, &
‰ames
);

566 i‡(
îr
 < 0) {

567 i‡((
îr
 = 
	`xrun_ªcovîy
(
h™dÀ
,Érr)) < 0) {

568 
	`¥ötf
("MMAP begöávaûÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

569 
	`exô
(
EXIT_FAILURE
);

572 
	`gíî©e_söe
(
my_¨ós
, 
off£t
, 
‰ames
, &
d©a
.
pha£
);

573 
commôªs
 = 
	`¢d_pcm_mm≠_commô
(
h™dÀ
, 
off£t
, 
‰ames
);

574 i‡(
commôªs
 < 0 || (
¢d_pcm_u‰ames_t
)commôª†!
‰ames
) {

575 i‡((
îr
 = 
	`xrun_ªcovîy
(
h™dÀ
, 
commôªs
 >0 ? -
EPIPE
 : commitres)) < 0) {

576 
	`¥ötf
("MMAP commôÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

577 
	`exô
(
EXIT_FAILURE
);

580 
size
 -
‰ames
;

583 
îr
 = 
	`¢d_pcm_°¨t
(
h™dÀ
);

584 i‡(
îr
 < 0) {

585 
	`¥ötf
("SèπÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

586 
	`exô
(
EXIT_FAILURE
);

592 
	`¶ìp
(1);

594 
	}
}

600 
	$dúe˘_lo›
(
¢d_pcm_t
 *
h™dÀ
,

601 sig√d *
ßm∂es
 
ATTRIBUTE_UNUSED
,

602 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
 
ATTRIBUTE_UNUSED
)

604 
pha£
 = 0;

605 c⁄° 
¢d_pcm_ch™√l_¨ó_t
 *
my_¨ós
;

606 
¢d_pcm_u‰ames_t
 
off£t
, 
‰ames
, 
size
;

607 
¢d_pcm_s‰ames_t
 
avaû
, 
commôªs
;

608 
¢d_pcm_°©e_t
 
°©e
;

609 
îr
, 
fú°
 = 1;

612 
°©e
 = 
	`¢d_pcm_°©e
(
h™dÀ
);

613 i‡(
°©e
 =
SND_PCM_STATE_XRUN
) {

614 
îr
 = 
	`xrun_ªcovîy
(
h™dÀ
, -
EPIPE
);

615 i‡(
îr
 < 0) {

616 
	`¥ötf
("XRUNÑecovîy faûed: %s\n", 
	`¢d_°ªº‹
(
îr
));

617  
îr
;

619 
fú°
 = 1;

620 } i‡(
°©e
 =
SND_PCM_STATE_SUSPENDED
) {

621 
îr
 = 
	`xrun_ªcovîy
(
h™dÀ
, -
ESTRPIPE
);

622 i‡(
îr
 < 0) {

623 
	`¥ötf
("SUSPENDÑecovîy faûed: %s\n", 
	`¢d_°ªº‹
(
îr
));

624  
îr
;

627 
avaû
 = 
	`¢d_pcm_avaû_upd©e
(
h™dÀ
);

628 i‡(
avaû
 < 0) {

629 
îr
 = 
	`xrun_ªcovîy
(
h™dÀ
, 
avaû
);

630 i‡(
îr
 < 0) {

631 
	`¥ötf
("avaû upd©êÁûed: %s\n", 
	`¢d_°ªº‹
(
îr
));

632  
îr
;

634 
fú°
 = 1;

637 i‡(
avaû
 < 
≥riod_size
) {

638 i‡(
fú°
) {

639 
fú°
 = 0;

640 
îr
 = 
	`¢d_pcm_°¨t
(
h™dÀ
);

641 i‡(
îr
 < 0) {

642 
	`¥ötf
("SèπÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

643 
	`exô
(
EXIT_FAILURE
);

646 
îr
 = 
	`¢d_pcm_waô
(
h™dÀ
, -1);

647 i‡(
îr
 < 0) {

648 i‡((
îr
 = 
	`xrun_ªcovîy
(
h™dÀ
,Érr)) < 0) {

649 
	`¥ötf
("¢d_pcm_waôÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

650 
	`exô
(
EXIT_FAILURE
);

652 
fú°
 = 1;

657 
size
 = 
≥riod_size
;

658 
size
 > 0) {

659 
‰ames
 = 
size
;

660 
îr
 = 
	`¢d_pcm_mm≠_begö
(
h™dÀ
, &
my_¨ós
, &
off£t
, &
‰ames
);

661 i‡(
îr
 < 0) {

662 i‡((
îr
 = 
	`xrun_ªcovîy
(
h™dÀ
,Érr)) < 0) {

663 
	`¥ötf
("MMAP begöávaûÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

664 
	`exô
(
EXIT_FAILURE
);

666 
fú°
 = 1;

668 
	`gíî©e_söe
(
my_¨ós
, 
off£t
, 
‰ames
, &
pha£
);

669 
commôªs
 = 
	`¢d_pcm_mm≠_commô
(
h™dÀ
, 
off£t
, 
‰ames
);

670 i‡(
commôªs
 < 0 || (
¢d_pcm_u‰ames_t
)commôª†!
‰ames
) {

671 i‡((
îr
 = 
	`xrun_ªcovîy
(
h™dÀ
, 
commôªs
 >0 ? -
EPIPE
 : commitres)) < 0) {

672 
	`¥ötf
("MMAP commôÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

673 
	`exô
(
EXIT_FAILURE
);

675 
fú°
 = 1;

677 
size
 -
‰ames
;

680 
	}
}

686 
	$dúe˘_wrôe_lo›
(
¢d_pcm_t
 *
h™dÀ
,

687 sig√d *
ßm∂es
,

688 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
)

690 
pha£
 = 0;

691 sig√d *
±r
;

692 
îr
, 
˝å
;

695 
	`gíî©e_söe
(
¨ós
, 0, 
≥riod_size
, &
pha£
);

696 
±r
 = 
ßm∂es
;

697 
˝å
 = 
≥riod_size
;

698 
˝å
 > 0) {

699 
îr
 = 
	`¢d_pcm_mm≠_wrôei
(
h™dÀ
, 
±r
, 
˝å
);

700 i‡(
îr
 =-
EAGAIN
)

702 i‡(
îr
 < 0) {

703 i‡(
	`xrun_ªcovîy
(
h™dÀ
, 
îr
) < 0) {

704 
	`¥ötf
("Wrôêîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

705 
	`exô
(
EXIT_FAILURE
);

709 
±r
 +
îr
 * 
ch™√ls
;

710 
˝å
 -
îr
;

713 
	}
}

719 
	så™s„r_mëhod
 {

720 c⁄° *
	m«me
;

721 
¢d_pcm_ac˚ss_t
 
	mac˚ss
;

722 (*
	må™s„r_lo›
)(
¢d_pcm_t
 *
	mh™dÀ
,

723 sig√d *
	mßm∂es
,

724 
¢d_pcm_ch™√l_¨ó_t
 *
	m¨ós
);

727 
å™s„r_mëhod
 
	gå™s„r_mëhods
[] = {

728 { "wrôe", 
SND_PCM_ACCESS_RW_INTERLEAVED
, 
wrôe_lo›
 },

729 { "wrôe_™d_pﬁl", 
SND_PCM_ACCESS_RW_INTERLEAVED
, 
wrôe_™d_pﬁl_lo›
 },

730 { "async", 
SND_PCM_ACCESS_RW_INTERLEAVED
, 
async_lo›
 },

731 { "async_dúe˘", 
SND_PCM_ACCESS_MMAP_INTERLEAVED
, 
async_dúe˘_lo›
 },

732 { "dúe˘_öãæóved", 
SND_PCM_ACCESS_MMAP_INTERLEAVED
, 
dúe˘_lo›
 },

733 { "dúe˘_n⁄öãæóved", 
SND_PCM_ACCESS_MMAP_NONINTERLEAVED
, 
dúe˘_lo›
 },

734 { "dúe˘_wrôe", 
SND_PCM_ACCESS_MMAP_INTERLEAVED
, 
dúe˘_wrôe_lo›
 },

735 { 
NULL
, 
SND_PCM_ACCESS_RW_INTERLEAVED
, NULL }

738 
	$hñp
()

740 
k
;

741 
	`¥ötf
(

756 
	`¥ötf
("Recognized sample formatsáre:");

757 
k
 = 0; k < 
SND_PCM_FORMAT_LAST
; ++k) {

758 c⁄° *
s
 = 
	`¢d_pcm_f‹m©_«me
(
k
);

759 i‡(
s
)

760 
	`¥ötf
(" %s", 
s
);

762 
	`¥ötf
("\n");

763 
	`¥ötf
("RecognizedÅransfer methodsáre:");

764 
k
 = 0; 
å™s„r_mëhods
[k].
«me
; k++)

765 
	`¥ötf
(" %s", 
å™s„r_mëhods
[
k
].
«me
);

766 
	`¥ötf
("\n");

767 
	}
}

769 
	$maö
(
¨gc
, *
¨gv
[])

771 
›ti⁄
 
l⁄g_›ti⁄
[] =

773 {"hñp", 0, 
NULL
, 'h'},

774 {"devi˚", 1, 
NULL
, 'D'},

775 {"øã", 1, 
NULL
, 'r'},

776 {"ch™√ls", 1, 
NULL
, 'c'},

777 {"‰equícy", 1, 
NULL
, 'f'},

778 {"buf„r", 1, 
NULL
, 'b'},

779 {"≥riod", 1, 
NULL
, 'p'},

780 {"mëhod", 1, 
NULL
, 'm'},

781 {"f‹m©", 1, 
NULL
, 'o'},

782 {"vîbo£", 1, 
NULL
, 'v'},

783 {"n‹eßm∂e", 1, 
NULL
, 'n'},

784 {"≥vít", 1, 
NULL
, 'e'},

785 {
NULL
, 0, NULL, 0},

787 
¢d_pcm_t
 *
h™dÀ
;

788 
îr
, 
m‹ehñp
;

789 
¢d_pcm_hw_∑øms_t
 *
hw∑øms
;

790 
¢d_pcm_sw_∑øms_t
 *
sw∑øms
;

791 
mëhod
 = 0;

792 sig√d *
ßm∂es
;

793 
chn
;

794 
¢d_pcm_ch™√l_¨ó_t
 *
¨ós
;

796 
	`¢d_pcm_hw_∑øms_Æloˇ
(&
hw∑øms
);

797 
	`¢d_pcm_sw_∑øms_Æloˇ
(&
sw∑øms
);

799 
m‹ehñp
 = 0;

801 
c
;

802 i‡((
c
 = 
	`gë›t_l⁄g
(
¨gc
, 
¨gv
, "hD:r:c:f:b:p:m:o:v√", 
l⁄g_›ti⁄
, 
NULL
)) < 0)

804 
c
) {

806 
m‹ehñp
++;

809 
devi˚
 = 
	`°rdup
(
›èrg
);

812 
øã
 = 
	`©oi
(
›èrg
);

813 
øã
 =Ñate < 4000 ? 4000 :Ñate;

814 
øã
 =Ñate > 196000 ? 196000 :Ñate;

817 
ch™√ls
 = 
	`©oi
(
›èrg
);

818 
ch™√ls
 = channels < 1 ? 1 : channels;

819 
ch™√ls
 = channels > 1024 ? 1024 : channels;

822 
‰eq
 = 
	`©oi
(
›èrg
);

823 
‰eq
 = freq < 50 ? 50 : freq;

824 
‰eq
 = freq > 5000 ? 5000 : freq;

827 
buf„r_time
 = 
	`©oi
(
›èrg
);

828 
buf„r_time
 = buffer_time < 1000 ? 1000 : buffer_time;

829 
buf„r_time
 = buffer_time > 1000000 ? 1000000 : buffer_time;

832 
≥riod_time
 = 
	`©oi
(
›èrg
);

833 
≥riod_time
 =Öeriod_time < 1000 ? 1000 :Öeriod_time;

834 
≥riod_time
 =Öeriod_time > 1000000 ? 1000000 :Öeriod_time;

837 
mëhod
 = 0; 
å™s„r_mëhods
[mëhod].
«me
; method++)

838 i‡(!
	`°rˇ£cmp
(
å™s„r_mëhods
[
mëhod
].
«me
, 
›èrg
))

840 i‡(
å™s„r_mëhods
[
mëhod
].
«me
 =
NULL
)

841 
mëhod
 = 0;

844 
f‹m©
 = 0; f‹m© < 
SND_PCM_FORMAT_LAST
; format++) {

845 c⁄° *
f‹m©_«me
 = 
	`¢d_pcm_f‹m©_«me
(
f‹m©
);

846 i‡(
f‹m©_«me
)

847 i‡(!
	`°rˇ£cmp
(
f‹m©_«me
, 
›èrg
))

850 i‡(
f‹m©
 =
SND_PCM_FORMAT_LAST
)

851 
f‹m©
 = 
SND_PCM_FORMAT_S16
;

852 i‡(!
	`¢d_pcm_f‹m©_löór
(
f‹m©
) &&

853 !(
f‹m©
 =
SND_PCM_FORMAT_FLOAT_LE
 ||

854 
f‹m©
 =
SND_PCM_FORMAT_FLOAT_BE
)) {

855 
	`¥ötf
("Invalid (non-linear/float) format %s\n",

856 
›èrg
);

861 
vîbo£
 = 1;

864 
ªßm∂e
 = 0;

867 
≥riod_evít
 = 1;

872 i‡(
m‹ehñp
) {

873 
	`hñp
();

877 
îr
 = 
	`¢d_ouçut_°dio_©èch
(&
ouçut
, 
°dout
, 0);

878 i‡(
îr
 < 0) {

879 
	`¥ötf
("OuçuàÁûed: %s\n", 
	`¢d_°ªº‹
(
îr
));

883 
	`¥ötf
("Pœyback devi˚ i†%s\n", 
devi˚
);

884 
	`¥ötf
("SåómÖ¨amëî†¨ê%uHz, %s, %u ch™√ls\n", 
øã
, 
	`¢d_pcm_f‹m©_«me
(
f‹m©
), 
ch™√ls
);

885 
	`¥ötf
("Söêwavêøã i†%.4fHz\n", 
‰eq
);

886 
	`¥ötf
("UsögÅøns„∏mëhod: %s\n", 
å™s„r_mëhods
[
mëhod
].
«me
);

888 i‡((
îr
 = 
	`¢d_pcm_›í
(&
h™dÀ
, 
devi˚
, 
SND_PCM_STREAM_PLAYBACK
, 0)) < 0) {

889 
	`¥ötf
("Pœyback o≥¿îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

893 i‡((
îr
 = 
	`£t_hw∑øms
(
h™dÀ
, 
hw∑øms
, 
å™s„r_mëhods
[
mëhod
].
ac˚ss
)) < 0) {

894 
	`¥ötf
("Sëtög o‡hw∑øm†Áûed: %s\n", 
	`¢d_°ªº‹
(
îr
));

895 
	`exô
(
EXIT_FAILURE
);

897 i‡((
îr
 = 
	`£t_sw∑øms
(
h™dÀ
, 
sw∑øms
)) < 0) {

898 
	`¥ötf
("Sëtög o‡sw∑øm†Áûed: %s\n", 
	`¢d_°ªº‹
(
îr
));

899 
	`exô
(
EXIT_FAILURE
);

902 i‡(
vîbo£
 > 0)

903 
	`¢d_pcm_dump
(
h™dÀ
, 
ouçut
);

905 
ßm∂es
 = 
	`mÆloc
((
≥riod_size
 * 
ch™√ls
 * 
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
)) / 8);

906 i‡(
ßm∂es
 =
NULL
) {

907 
	`¥ötf
("NoÉnough memory\n");

908 
	`exô
(
EXIT_FAILURE
);

911 
¨ós
 = 
	`ˇŒoc
(
ch™√ls
, (
¢d_pcm_ch™√l_¨ó_t
));

912 i‡(
¨ós
 =
NULL
) {

913 
	`¥ötf
("NoÉnough memory\n");

914 
	`exô
(
EXIT_FAILURE
);

916 
chn
 = 0; ch¿< 
ch™√ls
; chn++) {

917 
¨ós
[
chn
].
addr
 = 
ßm∂es
;

918 
¨ós
[
chn
].
fú°
 = ch¿* 
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
);

919 
¨ós
[
chn
].
°ï
 = 
ch™√ls
 * 
	`¢d_pcm_f‹m©_physiˇl_width
(
f‹m©
);

922 
îr
 = 
å™s„r_mëhods
[
mëhod
].
	`å™s„r_lo›
(
h™dÀ
, 
ßm∂es
, 
¨ós
);

923 i‡(
îr
 < 0)

924 
	`¥ötf
("Tøns„∏Áûed: %s\n", 
	`¢d_°ªº‹
(
îr
));

926 
	`‰ì
(
¨ós
);

927 
	`‰ì
(
ßm∂es
);

928 
	`¢d_pcm_˛o£
(
h™dÀ
);

930 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/pcm_min.c

5 
	~"../ö˛ude/asoundlib.h
"

7 *
	gdevi˚
 = "default";

8 
	gbuf„r
[16*1024];

10 
	$maö
()

12 
îr
;

13 
i
;

14 
¢d_pcm_t
 *
h™dÀ
;

15 
¢d_pcm_s‰ames_t
 
‰ames
;

17 
i
 = 0; i < (
buf„r
); i++)

18 
buf„r
[
i
] = 
	`øndom
() & 0xff;

20 i‡((
îr
 = 
	`¢d_pcm_›í
(&
h™dÀ
, 
devi˚
, 
SND_PCM_STREAM_PLAYBACK
, 0)) < 0) {

21 
	`¥ötf
("Pœyback o≥¿îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

22 
	`exô
(
EXIT_FAILURE
);

24 i‡((
îr
 = 
	`¢d_pcm_£t_∑øms
(
h™dÀ
,

25 
SND_PCM_FORMAT_U8
,

26 
SND_PCM_ACCESS_RW_INTERLEAVED
,

31 
	`¥ötf
("Pœyback o≥¿îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

32 
	`exô
(
EXIT_FAILURE
);

35 
i
 = 0; i < 16; i++) {

36 
‰ames
 = 
	`¢d_pcm_wrôei
(
h™dÀ
, 
buf„r
, (buffer));

37 i‡(
‰ames
 < 0)

38 
‰ames
 = 
	`¢d_pcm_ªcovî
(
h™dÀ
, frames, 0);

39 i‡(
‰ames
 < 0) {

40 
	`¥ötf
("¢d_pcm_wrôeòÁûed: %s\n", 
	`¢d_°ªº‹
(
‰ames
));

43 i‡(
‰ames
 > 0 && føme†< ()(
buf„r
))

44 
	`¥ötf
("Sh‹àwrôê”x≥˘ed %li, wrŸê%li)\n", ()(
buf„r
), 
‰ames
);

48 
îr
 = 
	`¢d_pcm_døö
(
h™dÀ
);

49 i‡(
îr
 < 0)

50 
	`¥ötf
("¢d_pcm_døö faûed: %s\n", 
	`¢d_°ªº‹
(
îr
));

51 
	`¢d_pcm_˛o£
(
h™dÀ
);

53 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/playmidi1.c

37 
	~"c⁄fig.h
"

39 
	~<°dio.h
>

40 
	~<˘y≥.h
>

41 
	~<f˙é.h
>

42 
	~<°dlib.h
>

43 
	~<sys/io˘l.h
>

44 
	~<uni°d.h
>

45 
	~<î∫o.h
>

46 
	~<°rög.h
>

48 
	~"midifûe.h
"

49 
	~"midifûe.c
"

51 
	~"../ö˛ude/asoundlib.h
"

54 
	gu£_ªÆtime
 = 0;

57 
	gu£_blockög_mode
 = 1;

60 
	#DEST_CLIENT_NUMBER
 65

	)

61 
	#DEST_PORT_NUMBER
 0

	)

64 
	#WRITE_POOL_SIZE
 200

	)

65 
	#WRITE_POOL_SPACE
 10

	)

66 
	#READ_POOL_SIZE
 10

	)

68 
FILE
 *
	gF
;

69 
¢d_£q_t
 *
	g£q_h™dÀ
 = 
NULL
;

70 
	gµq
 = 96;

71 
	g¶ave_µq
 = 96;

73 
	gloˇl_£cs
 = 0;

74 
	gloˇl_ticks
 = 0;

75 
	gloˇl_ãmpo
 = 500000;

77 
	gde°_queue
 = -1;

78 
	gsh¨ed_queue
 = 0;

79 
	gtick_off£t
 = 0;

80 
	gde°_˛õ¡
 = 
DEST_CLIENT_NUMBER
;

81 
	gde°_p‹t
 = 
DEST_PORT_NUMBER
;

82 
	gmy_p‹t
 = 0;

84 
	gvîbo£
 = 0;

85 
	g¶ave
 = 0;

87 
	#VERB_INFO
 1

	)

88 
	#VERB_MUCH
 2

	)

89 
	#VERB_EVENT
 3

	)

91 
Æß_°¨t_timî
();

92 
Æß_°›_timî
();

93 
waô_°¨t
();

96 
ölöe
 
	$tick2time_dbl
(
tick
)

98  
loˇl_£cs
 + ((Ë(
tick
 - 
loˇl_ticks
Ë* (Ë
loˇl_ãmpo
 * 1.0E-6 / (Ë
µq
);

99 
	}
}

101 
	$tick2time
(
¢d_£q_ªÆ_time_t
 * 
tm
, 
tick
)

103 
£cs
 = 
	`tick2time_dbl
(
tick
);

104 
tm
->
tv_£c
 = 
£cs
;

105 
tm
->
tv_n£c
 = (
£cs
 -Åm->
tv_£c
) * 1.0E9;

106 
	}
}

108 
	$wrôe_ev
(
¢d_£q_evít_t
 *
ev
)

110 
rc
;

112 i‡(
u£_blockög_mode
) {

113 
rc
 = 
	`¢d_£q_evít_ouçut
(
£q_h™dÀ
, 
ev
);

114 i‡(
rc
 < 0) {

115 
	`¥ötf
("wrôã¿%ò(%s)\n", 
rc
, 
	`¢d_°ªº‹
(rc));

116 
	`exô
(1);

120 (
rc
 = 
	`¢d_£q_evít_ouçut
(
£q_h™dÀ
, 
ev
)) < 0) {

121 
≈fds
 = 
	`¢d_£q_pﬁl_des¸ùt‹s_cou¡
(
£q_h™dÀ
, 
POLLOUT
);

122 
pﬁlfd
 *
pfds
 = 
	`Æloˇ
((*pfdsË* 
≈fds
);

123 
	`¢d_£q_pﬁl_des¸ùt‹s
(
£q_h™dÀ
, 
pfds
, 
≈fds
, 
POLLOUT
);

124 i‡((
rc
 = 
	`pﬁl
(
pfds
, 
≈fds
, -1)) < 0) {

125 
	`¥ötf
("pﬁ»îr‹ = %ò(%s)\n", 
rc
, 
	`¢d_°ªº‹
(
î∫o
));

126 
	`exô
(1);

129 
	}
}

132 
	$mygëc
()

134  
	`gëc
(
F
);

135 
	}
}

138 
	$myãxt
(
ty≥
 
ATTRIBUTE_UNUSED
, 
Àng
, *
msg
)

140 *
p
;

141 *
ï
 = 
msg
 + 
Àng
;

143 i‡(
vîbo£
 >
VERB_INFO
) {

144 
p
 = 
msg
;Ö < 
ï
;Ö++)

145 
	`putch¨
(
	`i•röt
(*
p
) ? *p : '?');

146 
	`putch¨
('\n');

148 
	}
}

150 
	$do_hódî
(
f‹m©
, 
¡øcks
, 
divisi⁄
)

152 
¢d_£q_queue_ãmpo_t
 *
ãmpo
;

154 i‡(
vîbo£
 >
VERB_INFO
)

155 
	`¥ötf
("sm‡f‹m© %d, %dÅøcks, %dÖpq\n", 
f‹m©
, 
¡øcks
, 
divisi⁄
);

156 
µq
 = 
divisi⁄
;

158 i‡(
f‹m©
 !0 || 
¡øcks
 != 1) {

159 
	`¥ötf
("ThisÖlayer doesÇot support merging ofÅracks.\n");

160 i‡(! 
sh¨ed_queue
)

161 
	`Æß_°›_timî
();

162 
	`exô
(1);

165 
	`¢d_£q_queue_ãmpo_Æloˇ
(&
ãmpo
);

167 i‡(
	`¢d_£q_gë_queue_ãmpo
(
£q_h™dÀ
, 
de°_queue
, 
ãmpo
) < 0) {

168 
	`≥º‹
("get_queue_tempo");

169 
	`exô
(1);

171 i‡((
¶ave_µq
 = 
	`¢d_£q_queue_ãmpo_gë_µq
(
ãmpo
)Ë!
µq
) {

172 
	`¢d_£q_queue_ãmpo_£t_µq
(
ãmpo
, 
µq
);

173 i‡(
	`¢d_£q_£t_queue_ãmpo
(
£q_h™dÀ
, 
de°_queue
, 
ãmpo
) < 0) {

174 
	`≥º‹
("set_queue_tempo");

175 i‡(!
¶ave
 && !
sh¨ed_queue
)

176 
	`exô
(1);

178 
	`¥ötf
("dif„ª¡ PPQ %d i¿SMF from queuêPPQ %d\n", 
µq
, 
¶ave_µq
);

180 
¶ave_µq
 = 
µq
;

181 i‡(
vîbo£
 >
VERB_INFO
)

182 
	`¥ötf
("ALSA Timî upd©ed, PPQ = %d\n", 
	`¢d_£q_queue_ãmpo_gë_µq
(
ãmpo
));

186 i‡(
¶ave
) {

187 i‡(
vîbo£
 >
VERB_INFO
)

188 
	`¥ötf
("WaitÅillÅimer starts...\n");

189 
	`waô_°¨t
();

190 i‡(
vîbo£
 >
VERB_INFO
)

191 
	`¥ötf
("Go!\n");

192 } i‡(
sh¨ed_queue
) {

193 
¢d_£q_queue_°©us_t
 *
°©
;

194 
	`¢d_£q_queue_°©us_Æloˇ
(&
°©
);

195 
	`¢d_£q_gë_queue_°©us
(
£q_h™dÀ
, 
de°_queue
, 
°©
);

196 
tick_off£t
 = 
	`¢d_£q_queue_°©us_gë_tick_time
(
°©
);

197 
	`Ârötf
(
°dîr
, "tick off£à%d\n", 
tick_off£t
);

199 
	`Æß_°¨t_timî
();

200 
tick_off£t
 = 0;

202 
	}
}

205 
	$£t_evít_time
(
¢d_£q_evít_t
 *
ev
, 
cuºtime
)

207 i‡(
u£_ªÆtime
) {

208 
¢d_£q_ªÆ_time_t
 
πime
;

209 i‡(
µq
 !
¶ave_µq
)

210 
cuºtime
 = (cuºtimê* 
¶ave_µq
Ë/ 
µq
;

211 
	`tick2time
(&
πime
, 
cuºtime
);

212 
	`¢d_£q_ev_scheduÀ_ªÆ
(
ev
, 
de°_queue
, 0, &
πime
);

214 i‡(
µq
 !
¶ave_µq
)

215 
cuºtime
 = (cuºtimê* 
¶ave_µq
Ë/ 
µq
;

216 
cuºtime
 +
tick_off£t
;

217 
	`¢d_£q_ev_scheduÀ_tick
(
ev
, 
de°_queue
, 0, 
cuºtime
);

219 
	}
}

222 
	$£t_evít_hódî
(
¢d_£q_evít_t
 *
ev
)

224 
	`¢d_£q_ev_˛ór
(
ev
);

225 
	`¢d_£q_ev_£t_de°
(
ev
, 
de°_˛õ¡
, 
de°_p‹t
);

226 
	`¢d_£q_ev_£t_sour˚
(
ev
, 
my_p‹t
);

227 
	`£t_evít_time
(
ev
, 
Mf_cuºtime
);

228 
	}
}

231 
	$Æß_°¨t_timî
()

233 
	`¢d_£q_°¨t_queue
(
£q_h™dÀ
, 
de°_queue
, 
NULL
);

234 
	}
}

237 
	$Æß_°›_timî
()

239 
¢d_£q_evít_t
 
ev
;

240 
	`£t_evít_hódî
(&
ev
);

241 
	`¢d_£q_°›_queue
(
£q_h™dÀ
, 
de°_queue
, &
ev
);

242 
	}
}

245 
	$do_ãmpo
(
us
)

247 
¢d_£q_evít_t
 
ev
;

249 i‡(
vîbo£
 >
VERB_MUCH
) {

250 
bpm
;

251 
bpm
 = 60.0E6 / (Ë
us
;

252 
	`¥ötf
("Tempÿ%d us/bót, %.2‡bpm\n", 
us
, 
bpm
);

256 
loˇl_£cs
 = 
	`tick2time_dbl
(
Mf_cuºtime
);

257 
loˇl_ticks
 = 
Mf_cuºtime
;

258 
loˇl_ãmpo
 = 
us
;

260 
	`£t_evít_hódî
(&
ev
);

261 i‡(!
¶ave
)

262 
	`¢d_£q_ch™ge_queue_ãmpo
(
£q_h™dÀ
, 
de°_queue
, 
us
, &
ev
);

263 
	}
}

265 
	$do_nŸe⁄
(
ch™
, 
pôch
, 
vﬁ
)

267 
¢d_£q_evít_t
 
ev
;

269 i‡(
vîbo£
 >
VERB_EVENT
)

270 
	`¥ötf
("%lu: NŸeO¿(%dË%d %d\n", 
Mf_cuºtime
, 
ch™
, 
pôch
, 
vﬁ
);

271 
	`£t_evít_hódî
(&
ev
);

272 
	`¢d_£q_ev_£t_nŸe⁄
(&
ev
, 
ch™
, 
pôch
, 
vﬁ
);

273 
	`wrôe_ev
(&
ev
);

274 
	}
}

277 
	$do_nŸeoff
(
ch™
, 
pôch
, 
vﬁ
)

279 
¢d_£q_evít_t
 
ev
;

281 i‡(
vîbo£
 >
VERB_EVENT
)

282 
	`¥ötf
("%lu: NŸeOf‡(%dË%d %d\n", 
Mf_cuºtime
, 
ch™
, 
pôch
, 
vﬁ
);

283 
	`£t_evít_hódî
(&
ev
);

284 
	`¢d_£q_ev_£t_nŸeoff
(&
ev
, 
ch™
, 
pôch
, 
vﬁ
);

285 
	`wrôe_ev
(&
ev
);

286 
	}
}

289 
	$do_¥ogøm
(
ch™
, 
¥ogøm
)

291 
¢d_£q_evít_t
 
ev
;

293 i‡(
vîbo£
 >
VERB_EVENT
)

294 
	`¥ötf
("%lu: Progøm (%dË%d\n", 
Mf_cuºtime
, 
ch™
, 
¥ogøm
);

295 
	`£t_evít_hódî
(&
ev
);

296 
	`¢d_£q_ev_£t_pgmch™ge
(&
ev
, 
ch™
, 
¥ogøm
);

297 
	`wrôe_ev
(&
ev
);

298 
	}
}

301 
	$do_∑ømëî
(
ch™
, 
c⁄åﬁ
, 
vÆue
)

303 
¢d_£q_evít_t
 
ev
;

305 i‡(
vîbo£
 >
VERB_EVENT
)

306 
	`¥ötf
("%lu: C⁄åﬁ (%dË%d %d\n", 
Mf_cuºtime
, 
ch™
, 
c⁄åﬁ
, 
vÆue
);

307 
	`£t_evít_hódî
(&
ev
);

308 
	`¢d_£q_ev_£t_c⁄åﬁÀr
(&
ev
, 
ch™
, 
c⁄åﬁ
, 
vÆue
);

309 
	`wrôe_ev
(&
ev
);

310 
	}
}

313 
	$do_pôchbíd
(
ch™
, 
lsb
, 
msb
)

315 
¢d_£q_evít_t
 
ev
;

317 i‡(
vîbo£
 >
VERB_EVENT
)

318 
	`¥ötf
("%lu: Pôchbíd (%dË%d %d\n", 
Mf_cuºtime
, 
ch™
, 
lsb
, 
msb
);

319 
	`£t_evít_hódî
(&
ev
);

320 
	`¢d_£q_ev_£t_pôchbíd
(&
ev
, 
ch™
, (
lsb
 + (
msb
 << 7)) - 8192);

321 
	`wrôe_ev
(&
ev
);

322 
	}
}

324 
	$do_¥essuª
(
ch™
, 
pôch
, 
¥essuª
)

326 
¢d_£q_evít_t
 
ev
;

328 i‡(
vîbo£
 >
VERB_EVENT
)

329 
	`¥ötf
("%lu: KeyPªs†(%dË%d %d\n", 
Mf_cuºtime
, 
ch™
, 
pôch
, 
¥essuª
);

330 
	`£t_evít_hódî
(&
ev
);

331 
	`¢d_£q_ev_£t_key¥ess
(&
ev
, 
ch™
, 
pôch
, 
¥essuª
);

332 
	`wrôe_ev
(&
ev
);

333 
	}
}

335 
	$do_ch™¥essuª
(
ch™
, 
¥essuª
)

337 
¢d_£q_evít_t
 
ev
;

339 i‡(
vîbo£
 >
VERB_EVENT
)

340 
	`¥ötf
("%lu: Ch™Pªs†(%dË%d\n", 
Mf_cuºtime
, 
ch™
, 
¥essuª
);

341 
	`£t_evít_hódî
(&
ev
);

342 
	`¢d_£q_ev_£t_ch™¥ess
(&
ev
, 
ch™
, 
¥essuª
);

343 
	`wrôe_ev
(&
ev
);

344 
	}
}

346 
	$do_sy£x
(
Àn
, *
msg
)

348 
¢d_£q_evít_t
 
ev
;

350 i‡(
vîbo£
 >
VERB_MUCH
) {

351 
c
;

352 
	`¥ötf
("%lu: Sy£x,Üí=%d\n", 
Mf_cuºtime
, 
Àn
);

353 
c
 = 0; c < 
Àn
; c++) {

354 
	`¥ötf
(" %02x", ()
msg
[
c
]);

355 i‡(
c
 % 16 == 15)

356 
	`putch¨
('\n');

358 i‡(
c
 % 16 != 15)

359 
	`putch¨
('\n');

362 
	`£t_evít_hódî
(&
ev
);

363 
	`¢d_£q_ev_£t_sy£x
(&
ev
, 
Àn
, 
msg
);

364 
	`wrôe_ev
(&
ev
);

365 
	}
}

367 
¢d_£q_evít_t
 *
	$waô_f‹_evít
()

369 
À·
;

370 
¢d_£q_evít_t
 *
öput_evít
;

372 i‡(
u£_blockög_mode
) {

374 
À·
 = 
	`¢d_£q_evít_öput
(
£q_h™dÀ
, &
öput_evít
);

377 (
À·
 = 
	`¢d_£q_evít_öput
(
£q_h™dÀ
, &
öput_evít
)) >= 0 &&

378 
öput_evít
 =
NULL
) {

379 
≈fds
 = 
	`¢d_£q_pﬁl_des¸ùt‹s_cou¡
(
£q_h™dÀ
, 
POLLIN
);

380 
pﬁlfd
 *
pfds
 = 
	`Æloˇ
((*pfdsË* 
≈fds
);

381 
	`¢d_£q_pﬁl_des¸ùt‹s
(
£q_h™dÀ
, 
pfds
, 
≈fds
, 
POLLIN
);

382 i‡((
À·
 = 
	`pﬁl
(
pfds
, 
≈fds
, -1)) < 0) {

383 
	`¥ötf
("pﬁ»îr‹ = %ò(%s)\n", 
î∫o
, 
	`¢d_°ªº‹
(errno));

384 
	`exô
(1);

389 i‡(
À·
 < 0) {

390 
	`¥ötf
("Æß_syn¯îr‹!:%s\n", 
	`¢d_°ªº‹
(
À·
));

391  
NULL
;

394  
öput_evít
;

395 
	}
}

398 
	$Æß_sync
()

401 i‡(
vîbo£
 >
VERB_MUCH
)

402 
	`¥ötf
("alsa_sync syncing...\n");

404 
	`¢d_£q_døö_ouçut
(
£q_h™dÀ
);

405 
	`¢d_£q_sync_ouçut_queue
(
£q_h™dÀ
);

406 i‡(
vîbo£
 >
VERB_MUCH
)

407 
	`¥ötf
("alsa_sync synced\n");

408 
	`¶ìp
(1);

409 
	}
}

413 
	$waô_°¨t
()

415 
¢d_£q_evít_t
 *
öput_evít
;

419 
öput_evít
 = 
	`waô_f‹_evít
();

420 i‡(
öput_evít
) {

421 i‡(
vîbo£
 >
VERB_MUCH
)

422 
	`¥ötf
("wait_start gotÉvent.Åype=%d, flags=%d\n",

423 
öput_evít
->
ty≥
, i≈ut_evít->
Êags
);

424 i‡(
öput_evít
->
ty≥
 =
SND_SEQ_EVENT_START
 &&

425 
öput_evít
->
d©a
.
queue
.queuê=
de°_queue
) {

426 
	`¢d_£q_‰ì_evít
(
öput_evít
);

429 
	`¢d_£q_‰ì_evít
(
öput_evít
);

432 i‡(
vîbo£
 >
VERB_MUCH
)

433 
	`¥ötf
("startÑeceived\n");

434 
	}
}

438 
	$ußge
()

440 
	`Ârötf
(
°dîr
, "usage:Ölaymidi1 [options] [file]\n");

441 
	`Ârötf
(
°dîr
, " options:\n");

442 
	`Ârötf
(
°dîr
, " -v: verbose mode\n");

443 
	`Ârötf
(
°dîr
, " -a client:port : set destinationáddress (default=%d:%d)\n",

444 
DEST_CLIENT_NUMBER
, 
DEST_PORT_NUMBER
);

445 
	`Ârötf
(
°dîr
, " -q queue: useÅhe specified queue\n");

446 
	`Ârötf
(
°dîr
, " -s queue: slave mode (allowÉxternal clock synchronization)\n");

447 
	`Ârötf
(
°dîr
, " -r :Ölay onÑeal-time mode\n");

448 
	`Ârötf
(
°dîr
, " -b :Ölay onÇon-blocking mode\n");

449 
	}
}

451 
	$maö
(
¨gc
, *
¨gv
[])

453 
tmp
;

454 
c
;

455 
¢d_£q_addr_t
 
de°_addr
;

456 c⁄° *
addr
 = "65:0";

458 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "s:a:p:q:vrb")) != -1) {

459 
c
) {

461 
vîbo£
++;

465 
addr
 = 
›èrg
;

468 
de°_queue
 = 
	`©oi
(
›èrg
);

469 i‡(
de°_queue
 < 0) {

470 
	`Ârötf
(
°dîr
, "övÆid queuênumbî %d\n", 
de°_queue
);

471 
	`exô
(1);

475 
¶ave
 = 1;

476 
de°_queue
 = 
	`©oi
(
›èrg
);

477 i‡(
de°_queue
 < 0) {

478 
	`Ârötf
(
°dîr
, "övÆid queuênumbî %d\n", 
de°_queue
);

479 
	`exô
(1);

483 
u£_ªÆtime
 = 1;

486 
u£_blockög_mode
 = 0;

489 
	`ußge
();

490 
	`exô
(1);

494 i‡(
vîbo£
 >
VERB_INFO
) {

495 i‡(
u£_ªÆtime
)

496 
	`¥ötf
("ALSA MIDI Player, feedingÉventsÅoÑeal-time queue\n");

498 
	`¥ötf
("ALSA MIDI Player, feedingÉventsÅo song queue\n");

503 
tmp
 = 
	`¢d_£q_›í
(&
£q_h™dÀ
, "hw", 
¶ave
 ? 
SND_SEQ_OPEN_DUPLEX
 : 
SND_SEQ_OPEN_OUTPUT
, 0);

504 i‡(
tmp
 < 0) {

505 
	`≥º‹
("open /dev/snd/seq");

506 
	`exô
(1);

509 
tmp
 = 
	`¢d_£q_n⁄block
(
£q_h™dÀ
, !
u£_blockög_mode
);

510 i‡(
tmp
 < 0) {

511 
	`≥º‹
("block_mode");

512 
	`exô
(1);

518 i‡(
¶ave
)

519 
	`¢d_£q_£t_˛õ¡_evít_fûãr
(
£q_h™dÀ
, 
SND_SEQ_EVENT_START
);

520 
	`¢d_£q_£t_˛õ¡_«me
(
£q_h™dÀ
, "MIDI fileÖlayer");

523 
my_p‹t
 = 
	`¢d_£q_¸óã_sim∂e_p‹t
(
£q_h™dÀ
, "Port 0",

524 
SND_SEQ_PORT_CAP_WRITE
 |

525 
SND_SEQ_PORT_CAP_READ
,

526 
SND_SEQ_PORT_TYPE_MIDI_GENERIC
);

527 i‡(
my_p‹t
 < 0) {

528 
	`≥º‹
("createÖort");

529 
	`exô
(1);

532 i‡(
	`¢d_£q_∑r£_addªss
(
£q_h™dÀ
, &
de°_addr
, 
addr
) < 0) {

533 
	`≥º‹
("invalid destinationáddress");

534 
	`exô
(1);

536 
de°_˛õ¡
 = 
de°_addr
.
˛õ¡
;

537 
de°_p‹t
 = 
de°_addr
.
p‹t
;

540 i‡(
de°_queue
 >= 0) {

541 
sh¨ed_queue
 = 1;

542 i‡(
	`¢d_£q_£t_queue_ußge
(
£q_h™dÀ
, 
de°_queue
, 1) < 0) {

543 
	`≥º‹
("use queue");

544 
	`exô
(1);

547 
sh¨ed_queue
 = 0;

548 
de°_queue
 = 
	`¢d_£q_Æloc_queue
(
£q_h™dÀ
);

549 i‡(
de°_queue
 < 0) {

550 
	`≥º‹
("alloc queue");

551 
	`exô
(1);

556 
tmp
 = 
	`¢d_£q_c⁄√˘_to
(
£q_h™dÀ
, 
my_p‹t
, 
de°_˛õ¡
, 
de°_p‹t
);

557 i‡(
tmp
 < 0) {

558 
	`≥º‹
("subscribe");

559 
	`exô
(1);

563 i‡(
¶ave
) {

564 
tmp
 = 
	`¢d_£q_c⁄√˘_‰om
(
£q_h™dÀ
, 
my_p‹t
,

565 
SND_SEQ_CLIENT_SYSTEM
,

566 
de°_queue
 + 16 );

567 i‡(
tmp
 < 0) {

568 
	`≥º‹
("subscribe");

569 
	`exô
(1);

574 i‡(
	`¢d_£q_£t_˛õ¡_poﬁ_ouçut
(
£q_h™dÀ
, 
WRITE_POOL_SIZE
) < 0 ||

575 
	`¢d_£q_£t_˛õ¡_poﬁ_öput
(
£q_h™dÀ
, 
READ_POOL_SIZE
) < 0 ||

576 
	`¢d_£q_£t_˛õ¡_poﬁ_ouçut_room
(
£q_h™dÀ
, 
WRITE_POOL_SPACE
) < 0) {

577 
	`≥º‹
("pool");

578 
	`exô
(1);

581 i‡(
›töd
 < 
¨gc
) {

582 
F
 = 
	`f›í
(
¨gv
[
›töd
], "r");

583 i‡(
F
 =
NULL
) {

584 
	`Ârötf
(
°dîr
, "∂aymidi1: c™'à›í fûê%s\n", 
¨gv
[
›töd
]);

585 
	`exô
(1);

588 
F
 = 
°dö
;

590 
Mf_hódî
 = 
do_hódî
;

591 
Mf_ãmpo
 = 
do_ãmpo
;

592 
Mf_gëc
 = 
mygëc
;

593 
Mf_ãxt
 = 
myãxt
;

595 
Mf_nŸe⁄
 = 
do_nŸe⁄
;

596 
Mf_nŸeoff
 = 
do_nŸeoff
;

597 
Mf_¥ogøm
 = 
do_¥ogøm
;

598 
Mf_∑ømëî
 = 
do_∑ømëî
;

599 
Mf_pôchbíd
 = 
do_pôchbíd
;

600 
Mf_¥essuª
 = 
do_¥essuª
;

601 
Mf_ch™¥essuª
 = 
do_ch™¥essuª
;

602 
Mf_sy£x
 = 
do_sy£x
;

605 
	`m‰ód
();

607 
	`Æß_sync
();

608 i‡(! 
sh¨ed_queue
)

609 
	`Æß_°›_timî
();

611 
	`¢d_£q_˛o£
(
£q_h™dÀ
);

613 i‡(
vîbo£
 >
VERB_INFO
) {

614 
	`¥ötf
("Stoppingát %f s,Åick %f\n",

615 
	`tick2time_dbl
(
Mf_cuºtime
 + 1), () (Mf_currtime + 1));

618 
	`exô
(0);

619 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/queue_timer.c

1 
	~<uni°d.h
>

2 
	~<sys/time.h
>

3 
	~<Æß/asoundlib.h
>

4 
	~<Æß/£q.h
>

6 
	$n‹mÆize
(
timevÆ
 *
tv
)

8 i‡(
tv
->
tv_£c
 == 0) {

9 
tv
->
tv_u£c
 <-1000000Ë{Åv->tv_u£¯+1000000; --tv->
tv_£c
; }

10 
tv
->
tv_u£c
 >1000000Ë{Åv->tv_u£¯-1000000; ++tv->
tv_£c
; }

11 } i‡(
tv
->
tv_£c
 < 0) {

12 
tv
->
tv_u£c
 <-1000000Ë{Åv->tv_u£¯+1000000; --tv->
tv_£c
; }

13 
tv
->
tv_u£c
 > 0Ë{Åv->tv_u£¯-1000000; ++tv->
tv_£c
; }

15 
tv
->
tv_u£c
 >1000000Ë{Åv->tv_u£¯-1000000; ++tv->
tv_£c
; }

16 
tv
->
tv_u£c
 < 0Ë{Åv->tv_u£¯+1000000; --tv->
tv_£c
; }

18 
	}
}

21 
	$maö
(
¨gc
 
ATTRIBUTE_UNUSED
, **
¨gv
 ATTRIBUTE_UNUSED)

23 
¢d_£q_t
 *
h™dÀ
;

24 
p‹tid
;

28 
queue
;

32 
timevÆ
 
°¨âv
, 
¥evdiff
;

33 
cou¡down
 = -1;

38 i‡(
	`¢d_£q_›í
(&
h™dÀ
, "hw", 
SND_SEQ_OPEN_DUPLEX
, 0) < 0) {

39 
	`Ârötf
(
°dîr
, "failedÅo open ALSA sequencer interface\n");

43 
	`¢d_£q_£t_˛õ¡_«me
(
h™dÀ
, "generator");

45 i‡((
p‹tid
 = 
¢d_£q_¸óã_sim∂e_p‹t


46 (
h™dÀ
, "generator",

47 
SND_SEQ_PORT_CAP_READ
 | 
SND_SEQ_PORT_CAP_SUBS_READ
, 0)) < 0) {

48 
	`Ârötf
(
°dîr
, "failedÅo create ALSA sequencerÖort\n");

52 i‡((
queue
 = 
	`¢d_£q_Æloc_queue
(
h™dÀ
)) < 0) {

53 
	`Ârötf
(
°dîr
, "failedÅo create ALSA sequencer queue\n");

68 
	`¢d_£q_°¨t_queue
(
h™dÀ
, 
queue
, 0);

69 
	`¢d_£q_døö_ouçut
(
h™dÀ
);

71 
	`gëtimeofday
(&
°¨âv
, 0);

72 
¥evdiff
.
tv_£c
 = 0;

73 
¥evdiff
.
tv_u£c
 = 0;

75 
cou¡down
 != 0) {

77 
¢d_£q_queue_°©us_t
 *
°©us
;

78 c⁄° 
¢d_£q_ªÆ_time_t
 *
πime
;

79 
timevÆ
 
tv
, 
diff
, 
diffdiff
;

80 
time•ec
 
ts
;

82 
	`¢d_£q_queue_°©us_Æloˇ
(&
°©us
);

84 
	`¢d_£q_gë_queue_°©us
(
h™dÀ
, 
queue
, 
°©us
);

85 
πime
 = 
	`¢d_£q_queue_°©us_gë_ªÆ_time
(
°©us
);

87 
	`gëtimeofday
(&
tv
, 0);

89 
tv
.
tv_£c
 -
°¨âv
.tv_sec;

90 
tv
.
tv_u£c
 -
°¨âv
.tv_usec;

91 
	`n‹mÆize
(&
tv
);

93 
diff
.
tv_£c
 = 
tv
.tv_£¯- 
πime
->tv_sec;

94 
diff
.
tv_u£c
 = 
tv
.tv_u£¯- 
πime
->
tv_n£c
 / 1000;

95 
	`n‹mÆize
(&
diff
);

97 
diffdiff
.
tv_£c
 = 
diff
.tv_£¯- 
¥evdiff
.tv_sec;

98 
diffdiff
.
tv_u£c
 = 
diff
.tv_u£¯- 
¥evdiff
.tv_usec;

99 
	`n‹mÆize
(&
diffdiff
);

100 
¥evdiff
 = 
diff
;

102 
	`Ârötf
(
°dîr
, "ÑealÅime: %12ld sec %8ld usec\nqueueÅime: %12ld sec %8ld usec\n diff: %12ld sec %8ld usec\n diffdiff: %12ld sec %8ld usec\n",

103 ()
tv
.
tv_£c
,Åv.
tv_u£c
,

104 ()
πime
->
tv_£c
, (Ïtime->
tv_n£c
 / 1000,

105 ()
diff
.
tv_£c
, diff.
tv_u£c
,

106 ()
diffdiff
.
tv_£c
, ()diffdiff.
tv_u£c
);

108 i‡(
diffdiff
.
tv_u£c
 > 5000 ||

109 
diffdiff
.
tv_u£c
 < -5000) {

110 
	`Ârötf
(
°dîr
, "oops! queue slipped\n");

111 i‡(
tv
.
tv_£c
 < 5) {

112 
	`Ârötf
(
°dîr
, "(ignoring in first few seconds)\n");

114 
cou¡down
 = 2;

117 i‡(
cou¡down
 > 0) --countdown;

120 
	`Ârötf
(
°dîr
, "\n");

122 
ts
.
tv_£c
 = 0;

123 
ts
.
tv_n£c
 = 500000000;

124 
	`«no¶ìp
(&
ts
, 0);

126  
EXIT_SUCCESS
;

127 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/rawmidi.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<˘y≥.h
>

4 
	~"../ö˛ude/asoundlib.h
"

5 
	~<sig«l.h
>

7 
	$ußge
()

9 
	`Ârötf
(
°dîr
, "usage:Ñawmidi [options]\n");

10 
	`Ârötf
(
°dîr
, " options:\n");

11 
	`Ârötf
(
°dîr
, " -v: verbose mode\n");

12 
	`Ârötf
(
°dîr
, " -i device-id :Åest ALSA input device\n");

13 
	`Ârötf
(
°dîr
, " -o device-id :Åest ALSA output device\n");

14 
	`Ârötf
(
°dîr
, " -IÇode :Åest inputÇode\n");

15 
	`Ârötf
(
°dîr
, " -OÇode :Åest outputÇode\n");

16 
	`Ârötf
(
°dîr
, " -c clock : kernel clockÅype (0=none, 1=realtime, 2=monotonic, 3=monotonicÑaw)\n");

17 
	`Ârötf
(
°dîr
, " -t:Åest midiÅhru\n");

18 
	`Ârötf
(
°dîr
, "Éxample:\n");

19 
	`Ârötf
(
°dîr
, "Ñawmidi -i hw:0,0 -O /dev/midi1\n");

20 
	`Ârötf
(
°dîr
, "Åests input for card 0, device 0, using snd_rawmidi API\n");

21 
	`Ârötf
(
°dîr
, "ánd /dev/midi1 using file descriptors\n");

22 
	}
}

24 
	g°›
=0;

26 
	$sigh™dÀr
(
dum
)

28 
°›
=1;

29 
	}
}

31 
	$maö
(
¨gc
,** 
¨gv
)

33 
i
;

34 
îr
;

35 
thru
=0;

36 
vîbo£
 = 0;

37 *
devi˚_ö
 = 
NULL
;

38 *
devi˚_out
 = 
NULL
;

39 *
node_ö
 = 
NULL
;

40 *
node_out
 = 
NULL
;

41 
˛ock_ty≥
 = -1;

43 
fd_ö
 = -1,
fd_out
 = -1;

44 
¢d_øwmidi_t
 *
h™dÀ_ö
 = 0,*
h™dÀ_out
 = 0;

46 i‡(
¨gc
==1) {

47 
	`ußge
();

48 
	`exô
(0);

51 
i
 = 1 ; i<
¨gc
 ; i++) {

52 i‡(
¨gv
[
i
][0]=='-') {

53 
¨gv
[
i
][1]) {

55 
	`ußge
();

58 
vîbo£
 = 1;

61 
thru
 = 1;

64 i‡(
i
 + 1 < 
¨gc
)

65 
˛ock_ty≥
 = 
	`©oi
(
¨gv
[++
i
]);

68 i‡(
i
 + 1 < 
¨gc
)

69 
devi˚_ö
 = 
¨gv
[++
i
];

72 i‡(
i
 + 1 < 
¨gc
)

73 
node_ö
 = 
¨gv
[++
i
];

76 i‡(
i
 + 1 < 
¨gc
)

77 
devi˚_out
 = 
¨gv
[++
i
];

80 i‡(
i
 + 1 < 
¨gc
)

81 
node_out
 = 
¨gv
[++
i
];

87 i‡(
vîbo£
) {

88 
	`Ârötf
(
°dîr
,"Using: \n");

89 
	`Ârötf
(
°dîr
,"Input: ");

90 i‡(
devi˚_ö
) {

91 
	`Ârötf
(
°dîr
,"devi˚ %s\n",
devi˚_ö
);

92 }i‡(
node_ö
){

93 
	`Ârötf
(
°dîr
,"%s\n",
node_ö
);

95 
	`Ârötf
(
°dîr
,"NONE\n");

97 
	`Ârötf
(
°dîr
,"Output: ");

98 i‡(
devi˚_out
) {

99 
	`Ârötf
(
°dîr
,"devi˚ %s\n",
devi˚_out
);

100 }i‡(
node_out
){

101 
	`Ârötf
(
°dîr
,"%s\n",
node_out
);

103 
	`Ârötf
(
°dîr
,"NONE\n");

107 i‡(
devi˚_ö
) {

108 
îr
 = 
	`¢d_øwmidi_›í
(&
h™dÀ_ö
,
NULL
,
devi˚_ö
,0);

109 i‡(
îr
) {

110 
	`Ârötf
(
°dîr
,"¢d_øwmidi_›í %†Áûed: %d\n",
devi˚_ö
,
îr
);

113 i‡(
node_ö
 && (!
node_out
 || 
	`°rcmp
(node_out,node_in))) {

114 
fd_ö
 = 
	`›í
(
node_ö
,
O_RDONLY
);

115 i‡(
fd_ö
<0) {

116 
	`Ârötf
(
°dîr
,"›í %†f‹ i≈uàÁûed\n",
node_ö
);

120 
	`sig«l
(
SIGINT
,
sigh™dÀr
);

122 i‡(
devi˚_out
) {

123 
îr
 = 
	`¢d_øwmidi_›í
(
NULL
,&
h™dÀ_out
,
devi˚_out
,0);

124 i‡(
îr
) {

125 
	`Ârötf
(
°dîr
,"¢d_øwmidi_›í %†Áûed: %d\n",
devi˚_out
,
îr
);

128 i‡(
node_out
 && (!
node_ö
 || 
	`°rcmp
(node_out,node_in))) {

129 
fd_out
 = 
	`›í
(
node_out
,
O_WRONLY
);

130 i‡(
fd_out
<0) {

131 
	`Ârötf
(
°dîr
,"›í %†f‹ ouçuàÁûed\n",
node_out
);

135 i‡(
node_ö
 && 
node_out
 && 
	`°rcmp
(node_out,node_in)==0) {

136 
fd_ö
 = 
fd_out
 = 
	`›í
(
node_out
,
O_RDWR
);

137 i‡(
fd_out
<0) {

138 
	`Ârötf
(
°dîr
,"›í %†f‹ i≈uà™d ouçuàÁûed\n",
node_out
);

142 i‡(!
thru
) {

143 i‡(
h™dÀ_ö
 || 
fd_ö
!=-1) {

144 i‡(
˛ock_ty≥
 != -1) {

145 
¢d_øwmidi_∑øms_t
 *
∑øms
;

146 
	`¢d_øwmidi_∑øms_mÆloc
(&
∑øms
);

147 i‡(!
h™dÀ_ö
) {

148 
	`Ârötf
(
°dîr
, "-c only usable with -i");

149 
˛ock_ty≥
 = -1;

151 i‡(
˛ock_ty≥
 != -1) {

152 
	`Ârötf
(
°dîr
, "E«bÀ kî√»˛ockÅy≥ %d\n", 
˛ock_ty≥
);

153 
	`¢d_øwmidi_∑øms_cuºít
(
h™dÀ_ö
, 
∑øms
);

154 
îr
 = 
	`¢d_øwmidi_∑øms_£t_ªad_mode
(
h™dÀ_ö
, 
∑øms
, 
SND_RAWMIDI_READ_TSTAMP
);

155 i‡(
îr
) {

156 
	`Ârötf
(
°dîr
,"¢d_øwmidi_∑øms_£t_ªad_modêÁûed: %d\n", 
îr
);

157 
˛ock_ty≥
 = -1;

160 i‡(
˛ock_ty≥
 != -1) {

161 
îr
 = 
	`¢d_øwmidi_∑øms_£t_˛ock_ty≥
(
h™dÀ_ö
, 
∑øms
, 
˛ock_ty≥
);

162 i‡(
îr
) {

163 
	`Ârötf
(
°dîr
, "¢d_øwmidi_∑øms_£t_˛ock_ty≥ faûed: %d\n", 
îr
);

164 
˛ock_ty≥
 = -1;

167 i‡(
˛ock_ty≥
 != -1) {

168 
îr
 = 
	`¢d_øwmidi_∑øms
(
h™dÀ_ö
, 
∑øms
);

169 i‡(
îr
) {

170 
	`Ârötf
(
°dîr
, "¢d_øwmidi_∑øm†Áûed: %d\n", 
îr
);

171 
˛ock_ty≥
 = -1;

174 
	`¢d_øwmidi_∑øms_‰ì
(
∑øms
);

177 
	`Ârötf
(
°dîr
,"Read midi in\n");

178 
	`Ârötf
(
°dîr
,"Press ctrl-cÅo stop\n");

181 i‡(
h™dÀ_ö
) {

182 
buf
[1024];

183 
ssize_t
 
ªt
;

184 !
°›
) {

185 i‡(
˛ock_ty≥
 != -1) {

186 
time•ec
 
t°amp
;

187 
ªt
 = 
	`¢d_øwmidi_åód
(
h™dÀ_ö
, &
t°amp
, 
buf
, (buf));

188 i‡(
ªt
 < 0)

189 
	`Ârötf
(
°dîr
, "ªadÅime°am∞îr‹: %d - %s\n", ()
ªt
, 
	`¢d_°ªº‹
(ret));

190 i‡(
ªt
 > 0 && 
vîbo£
) {

191 
	`Ârötf
(
°dîr
, "ªad [%Œd:%09Œd]", ()
t°amp
.
tv_£c
, (È°amp.
tv_n£c
);

192 
i
 = 0; i < 
ªt
; i++)

193 
	`Ârötf
(
°dîr
, " %02x", 
buf
[
i
]);

194 
	`Ârötf
(
°dîr
, "\n");

197 
ªt
 = 
	`¢d_øwmidi_ªad
(
h™dÀ_ö
, 
buf
, (buf));

198 i‡(
ªt
 < 0)

199 
	`Ârötf
(
°dîr
, "ªadÉº‹: %d - %s\n", ()
ªt
, 
	`¢d_°ªº‹
(ret));

200 i‡(
ªt
 > 0 && 
vîbo£
)

201 
i
 = 0; i < 
ªt
; i++)

202 
	`Ârötf
(
°dîr
,"ªad %02x\n",
buf
[
i
]);

206 i‡(
fd_ö
!=-1) {

207 
ch
;

208 !
°›
) {

209 
	`ªad
(
fd_ö
,&
ch
,1);

210 i‡(
vîbo£
) {

211 
	`Ârötf
(
°dîr
,"ªad %02x\n",
ch
);

216 i‡(
h™dÀ_out
 || 
fd_out
!=-1) {

217 
	`Ârötf
(
°dîr
,"WritingÇote on /Çote off\n");

220 i‡(
h™dÀ_out
) {

221 
ch
;

222 
ch
=0x90; 
	`¢d_øwmidi_wrôe
(
h™dÀ_out
,&ch,1);

223 
ch
=60; 
	`¢d_øwmidi_wrôe
(
h™dÀ_out
,&ch,1);

224 
ch
=100; 
	`¢d_øwmidi_wrôe
(
h™dÀ_out
,&ch,1);

225 
	`¢d_øwmidi_døö
(
h™dÀ_out
);

226 
	`¶ìp
(1);

227 
ch
=0x90; 
	`¢d_øwmidi_wrôe
(
h™dÀ_out
,&ch,1);

228 
ch
=60; 
	`¢d_øwmidi_wrôe
(
h™dÀ_out
,&ch,1);

229 
ch
=0; 
	`¢d_øwmidi_wrôe
(
h™dÀ_out
,&ch,1);

230 
	`¢d_øwmidi_døö
(
h™dÀ_out
);

232 i‡(
fd_out
!=-1) {

233 
ch
;

234 
ch
=0x90; 
	`wrôe
(
fd_out
,&ch,1);

235 
ch
=60; 
	`wrôe
(
fd_out
,&ch,1);

236 
ch
=100; 
	`wrôe
(
fd_out
,&ch,1);

237 
	`¶ìp
(1);

238 
ch
=0x90; 
	`wrôe
(
fd_out
,&ch,1);

239 
ch
=60; 
	`wrôe
(
fd_out
,&ch,1);

240 
ch
=0; 
	`wrôe
(
fd_out
,&ch,1);

243 i‡((
h™dÀ_ö
 || 
fd_ö
!=-1Ë&& (
h™dÀ_out
 || 
fd_out
!=-1)) {

244 i‡(
vîbo£
) {

245 
	`Ârötf
(
°dîr
,"Testing midiÅhru in\n");

247 !
°›
) {

248 
ch
;

250 i‡(
h™dÀ_ö
) {

251 
	`¢d_øwmidi_ªad
(
h™dÀ_ö
,&
ch
,1);

253 i‡(
fd_ö
!=-1) {

254 
	`ªad
(
fd_ö
,&
ch
,1);

256 i‡(
vîbo£
) {

257 
	`Ârötf
(
°dîr
,"thru: %02x\n",
ch
);

260 i‡(
h™dÀ_out
) {

261 
	`¢d_øwmidi_wrôe
(
h™dÀ_out
,&
ch
,1);

262 
	`¢d_øwmidi_døö
(
h™dÀ_out
);

264 i‡(
fd_out
!=-1) {

265 
	`wrôe
(
fd_out
,&
ch
,1);

269 
	`Ârötf
(
°dîr
,"Testing midiÅhruÇeeds both inputánd output\n");

270 
	`exô
(-1);

274 i‡(
vîbo£
) {

275 
	`Ârötf
(
°dîr
,"Closing\n");

278 i‡(
h™dÀ_ö
) {

279 
	`¢d_øwmidi_døö
(
h™dÀ_ö
);

280 
	`¢d_øwmidi_˛o£
(
h™dÀ_ö
);

282 i‡(
h™dÀ_out
) {

283 
	`¢d_øwmidi_døö
(
h™dÀ_out
);

284 
	`¢d_øwmidi_˛o£
(
h™dÀ_out
);

286 i‡(
fd_ö
!=-1) {

287 
	`˛o£
(
fd_ö
);

289 i‡(
fd_out
!=-1) {

290 
	`˛o£
(
fd_out
);

294 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/seq-decoder.c

5 *
	gevít_«mes
[256] = {

6 [
SND_SEQ_EVENT_SYSTEM
]= "System",

7 [
SND_SEQ_EVENT_RESULT
]= "Result",

8 [
SND_SEQ_EVENT_NOTE
]= "Note",

9 [
SND_SEQ_EVENT_NOTEON
]= "Note On",

10 [
SND_SEQ_EVENT_NOTEOFF
]= "Note Off",

11 [
SND_SEQ_EVENT_KEYPRESS
]= "Key Pressure",

12 [
SND_SEQ_EVENT_CONTROLLER
]= "Controller",

13 [
SND_SEQ_EVENT_PGMCHANGE
]= "Program Change",

14 [
SND_SEQ_EVENT_CHANPRESS
]= "Channel Pressure",

15 [
SND_SEQ_EVENT_PITCHBEND
]= "Pitchbend",

16 [
SND_SEQ_EVENT_CONTROL14
]= "Control14",

17 [
SND_SEQ_EVENT_NONREGPARAM
]= "Nonregparam",

18 [
SND_SEQ_EVENT_REGPARAM
]= "Regparam",

19 [
SND_SEQ_EVENT_SONGPOS
]= "Song Position",

20 [
SND_SEQ_EVENT_SONGSEL
]= "Song Select",

21 [
SND_SEQ_EVENT_QFRAME
]= "Qframe",

22 [
SND_SEQ_EVENT_TIMESIGN
]= "SMF Time Signature",

23 [
SND_SEQ_EVENT_KEYSIGN
]= "SMF Key Signature",

24 [
SND_SEQ_EVENT_START
]= "Start",

25 [
SND_SEQ_EVENT_CONTINUE
]= "Continue",

26 [
SND_SEQ_EVENT_STOP
]= "Stop",

27 [
SND_SEQ_EVENT_SETPOS_TICK
]= "Set Position Tick",

28 [
SND_SEQ_EVENT_SETPOS_TIME
]= "Set Position Time",

29 [
SND_SEQ_EVENT_TEMPO
]= "Tempo",

30 [
SND_SEQ_EVENT_CLOCK
]= "Clock",

31 [
SND_SEQ_EVENT_TICK
]= "Tick",

32 [
SND_SEQ_EVENT_TUNE_REQUEST
]= "Tune Request",

33 [
SND_SEQ_EVENT_RESET
]= "Reset",

34 [
SND_SEQ_EVENT_SENSING
]= "Active Sensing",

35 [
SND_SEQ_EVENT_ECHO
]= "Echo",

36 [
SND_SEQ_EVENT_OSS
]= "OSS",

37 [
SND_SEQ_EVENT_CLIENT_START
]= "Client Start",

38 [
SND_SEQ_EVENT_CLIENT_EXIT
]= "Client Exit",

39 [
SND_SEQ_EVENT_CLIENT_CHANGE
]= "Client Change",

40 [
SND_SEQ_EVENT_PORT_START
]= "Port Start",

41 [
SND_SEQ_EVENT_PORT_EXIT
]= "Port Exit",

42 [
SND_SEQ_EVENT_PORT_CHANGE
]= "Port Change",

43 [
SND_SEQ_EVENT_PORT_SUBSCRIBED
]= "Port Subscribed",

44 [
SND_SEQ_EVENT_PORT_UNSUBSCRIBED
]= "Port Unsubscribed",

46 [
SND_SEQ_EVENT_SAMPLE
]= "Sample",

47 [
SND_SEQ_EVENT_SAMPLE_CLUSTER
]= "Sample Cluster",

48 [
SND_SEQ_EVENT_SAMPLE_START
]= "Sample Start",

49 [
SND_SEQ_EVENT_SAMPLE_STOP
]= "Sample Stop",

50 [
SND_SEQ_EVENT_SAMPLE_FREQ
]= "Sample Freq",

51 [
SND_SEQ_EVENT_SAMPLE_VOLUME
]= "Sample Volume",

52 [
SND_SEQ_EVENT_SAMPLE_LOOP
]= "Sample Loop",

53 [
SND_SEQ_EVENT_SAMPLE_POSITION
]= "Sample Position",

54 [
SND_SEQ_EVENT_SAMPLE_PRIVATE1
]= "Sample Private1",

56 [
SND_SEQ_EVENT_USR0
]= "User 0",

57 [
SND_SEQ_EVENT_USR1
]= "User 1",

58 [
SND_SEQ_EVENT_USR2
]= "User 2",

59 [
SND_SEQ_EVENT_USR3
]= "User 3",

60 [
SND_SEQ_EVENT_USR4
]= "User 4",

61 [
SND_SEQ_EVENT_USR5
]= "User 5",

62 [
SND_SEQ_EVENT_USR6
]= "User 6",

63 [
SND_SEQ_EVENT_USR7
]= "User 7",

64 [
SND_SEQ_EVENT_USR8
]= "User 8",

65 [
SND_SEQ_EVENT_USR9
]= "User 9",

67 [
SND_SEQ_EVENT_INSTR_BEGIN
]= "Instr Begin",

68 [
SND_SEQ_EVENT_INSTR_END
]= "Instr End",

69 [
SND_SEQ_EVENT_INSTR_INFO
]= "Instr Info",

70 [
SND_SEQ_EVENT_INSTR_INFO_RESULT
]= "Instr Info Result",

71 [
SND_SEQ_EVENT_INSTR_FINFO
]= "Instr Font Info",

72 [
SND_SEQ_EVENT_INSTR_FINFO_RESULT
]= "Instr Font Info Result",

73 [
SND_SEQ_EVENT_INSTR_RESET
]= "Instr Reset",

74 [
SND_SEQ_EVENT_INSTR_STATUS
]= "Instr Status",

75 [
SND_SEQ_EVENT_INSTR_STATUS_RESULT
]= "Instr Status Result",

76 [
SND_SEQ_EVENT_INSTR_PUT
]= "Instr Put",

77 [
SND_SEQ_EVENT_INSTR_GET
]= "Instr Get",

78 [
SND_SEQ_EVENT_INSTR_GET_RESULT
]= "Instr Get Result",

79 [
SND_SEQ_EVENT_INSTR_FREE
]= "Instr Free",

80 [
SND_SEQ_EVENT_INSTR_LIST
]= "Instr List",

81 [
SND_SEQ_EVENT_INSTR_LIST_RESULT
]= "Instr List Result",

82 [
SND_SEQ_EVENT_INSTR_CLUSTER
]= "Instr Cluster",

83 [
SND_SEQ_EVENT_INSTR_CLUSTER_GET
]= "Instr Cluster Get",

84 [
SND_SEQ_EVENT_INSTR_CLUSTER_RESULT
]= "Instr Cluster Result",

85 [
SND_SEQ_EVENT_INSTR_CHANGE
]= "Instr Change",

87 [
SND_SEQ_EVENT_SYSEX
]= "Sysex",

88 [
SND_SEQ_EVENT_BOUNCE
]= "Bounce",

89 [
SND_SEQ_EVENT_USR_VAR0
]= "User Var0",

90 [
SND_SEQ_EVENT_USR_VAR1
]= "User Var1",

91 [
SND_SEQ_EVENT_USR_VAR2
]= "User Var2",

92 [
SND_SEQ_EVENT_USR_VAR3
]= "User Var3",

93 [
SND_SEQ_EVENT_USR_VAR4
]= "User Var4",

95 [
SND_SEQ_EVENT_IPCSHM
]= "IPC Shm",

96 [
SND_SEQ_EVENT_USR_VARIPC0
]= "User IPC0",

97 [
SND_SEQ_EVENT_USR_VARIPC1
]= "User IPC1",

98 [
SND_SEQ_EVENT_USR_VARIPC2
]= "User IPC2",

99 [
SND_SEQ_EVENT_USR_VARIPC3
]= "User IPC3",

100 [
SND_SEQ_EVENT_USR_VARIPC4
]= "User IPC4",

102 [
SND_SEQ_EVENT_NONE
]= "None",

105 
	$decode_evít
(
¢d_£q_evít_t
 * 
ev
)

107 *
•a˚
 = " ";

109 
	`¥ötf
("EVENT>>> Ty≥ = %d, fœg†0x%x", 
ev
->
ty≥
,Év->
Êags
);

110 
ev
->
Êags
 & 
SND_SEQ_TIME_STAMP_MASK
) {

111 
SND_SEQ_TIME_STAMP_TICK
:

112 
	`¥ötf
(",Åime = %dÅicks",

113 
ev
->
time
.
tick
);

115 
SND_SEQ_TIME_STAMP_REAL
:

116 
	`¥ötf
(",Åime = %d.%09d",

117 ()
ev
->
time
.time.
tv_£c
,

118 ()
ev
->
time
.time.
tv_n£c
);

121 
	`¥ötf
("\n%sSource = %d.%d, dest = %d.%d, queue = %d\n",

122 
•a˚
,

123 
ev
->
sour˚
.
˛õ¡
,

124 
ev
->
sour˚
.
p‹t
,

125 
ev
->
de°
.
˛õ¡
,

126 
ev
->
de°
.
p‹t
,

127 
ev
->
queue
);

129 i‡(
evít_«mes
[
ev
->
ty≥
])

130 
	`¥ötf
("%sEvíà%s", 
•a˚
, 
evít_«mes
[
ev
->
ty≥
]);

132 
	`¥ötf
("%sEvíàRe£rved %d\n", 
•a˚
, 
ev
->
ty≥
);

134 
ev
->
ty≥
) {

135 
SND_SEQ_EVENT_NOTE
:

136 
	`¥ötf
("; ch=%d,Çote=%d, velocity=%d, off_velocity=%d, duration=%d\n",

137 
ev
->
d©a
.
nŸe
.
ch™√l
,

138 
ev
->
d©a
.
nŸe
.note,

139 
ev
->
d©a
.
nŸe
.
vñocôy
,

140 
ev
->
d©a
.
nŸe
.
off_vñocôy
,

141 
ev
->
d©a
.
nŸe
.
duøti⁄
);

144 
SND_SEQ_EVENT_NOTEON
:

145 
SND_SEQ_EVENT_NOTEOFF
:

146 
SND_SEQ_EVENT_KEYPRESS
:

147 
	`¥ötf
("; ch=%d,Çote=%d, velocity=%d\n",

148 
ev
->
d©a
.
nŸe
.
ch™√l
,

149 
ev
->
d©a
.
nŸe
.note,

150 
ev
->
d©a
.
nŸe
.
vñocôy
);

153 
SND_SEQ_EVENT_CONTROLLER
:

154 
	`¥ötf
("; ch=%d,Öaram=%i, value=%i\n",

155 
ev
->
d©a
.
c⁄åﬁ
.
ch™√l
,

156 
ev
->
d©a
.
c⁄åﬁ
.
∑øm
,

157 
ev
->
d©a
.
c⁄åﬁ
.
vÆue
);

160 
SND_SEQ_EVENT_PGMCHANGE
:

161 
	`¥ötf
("; ch=%d,Örogram=%i\n",

162 
ev
->
d©a
.
c⁄åﬁ
.
ch™√l
,

163 
ev
->
d©a
.
c⁄åﬁ
.
vÆue
);

166 
SND_SEQ_EVENT_CHANPRESS
:

167 
SND_SEQ_EVENT_PITCHBEND
:

168 
	`¥ötf
("; ch=%d, value=%i\n",

169 
ev
->
d©a
.
c⁄åﬁ
.
ch™√l
,

170 
ev
->
d©a
.
c⁄åﬁ
.
vÆue
);

173 
SND_SEQ_EVENT_SYSEX
:

175 *
sy£x
 = (*Ë
ev
 + (
¢d_£q_evít_t
);

176 
c
;

178 
	`¥ötf
(";Üí=%d [", 
ev
->
d©a
.
ext
.
Àn
);

180 
c
 = 0; c < 
ev
->
d©a
.
ext
.
Àn
; c++) {

181 
	`¥ötf
("%02x%s", 
sy£x
[
c
], c < 
ev
->
d©a
.
ext
.
Àn
 - 1 ? ":" : "");

183 
	`¥ötf
("]\n");

187 
SND_SEQ_EVENT_QFRAME
:

188 
	`¥ötf
("; føme=0x%02x\n", 
ev
->
d©a
.
c⁄åﬁ
.
vÆue
);

191 
SND_SEQ_EVENT_CLOCK
:

192 
SND_SEQ_EVENT_START
:

193 
SND_SEQ_EVENT_CONTINUE
:

194 
SND_SEQ_EVENT_STOP
:

195 
	`¥ötf
("; queuê%i\n", 
ev
->
d©a
.
queue
.queue);

198 
SND_SEQ_EVENT_SENSING
:

199 
	`¥ötf
("\n");

202 
SND_SEQ_EVENT_ECHO
:

204 
i
;

206 
	`¥ötf
("; ");

207 
i
 = 0; i < 8; i++) {

208 
	`¥ötf
("%02i%s", 
ev
->
d©a
.
øw8
.
d
[
i
], i < 7 ? ":" : "\n");

213 
SND_SEQ_EVENT_CLIENT_START
:

214 
SND_SEQ_EVENT_CLIENT_EXIT
:

215 
SND_SEQ_EVENT_CLIENT_CHANGE
:

216 
	`¥ötf
("; clõ¡=%i\n", 
ev
->
d©a
.
addr
.
˛õ¡
);

219 
SND_SEQ_EVENT_PORT_START
:

220 
SND_SEQ_EVENT_PORT_EXIT
:

221 
SND_SEQ_EVENT_PORT_CHANGE
:

222 
	`¥ötf
("; clõ¡=%i,Ö‹à%i\n", 
ev
->
d©a
.
addr
.
˛õ¡
,Év->d©a.addr.
p‹t
);

225 
SND_SEQ_EVENT_PORT_SUBSCRIBED
:

226 
SND_SEQ_EVENT_PORT_UNSUBSCRIBED
:

227 
	`¥ötf
("; %i:%i -> %i:%i\n",

228 
ev
->
d©a
.
c⁄√˘
.
£ndî
.
˛õ¡
,Év->d©a.c⁄√˘.£ndî.
p‹t
,

229 
ev
->
d©a
.
c⁄√˘
.
de°
.
˛õ¡
,Év->d©a.c⁄√˘.de°.
p‹t
);

233 
	`¥ötf
(";Çot implemented\n");

237 
ev
->
Êags
 & 
SND_SEQ_EVENT_LENGTH_MASK
) {

238 
SND_SEQ_EVENT_LENGTH_FIXED
:

239  (
¢d_£q_evít_t
);

241 
SND_SEQ_EVENT_LENGTH_VARIABLE
:

242  (
¢d_£q_evít_t
Ë+ 
ev
->
d©a
.
ext
.
Àn
;

246 
	}
}

248 
	$evít_decodî_°¨t_timî
(
¢d_£q_t
 *
h™dÀ
, 
queue
,

249 
˛õ¡
 
ATTRIBUTE_UNUSED
,

250 
p‹t
 
ATTRIBUTE_UNUSED
)

252 
îr
;

254 i‡((
îr
 = 
	`¢d_£q_°¨t_queue
(
h™dÀ
, 
queue
, 
NULL
))<0)

255 
	`Ârötf
(
°dîr
, "TimîÉvíàouçuàîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

256 
	`¢d_£q_døö_ouçut
(
h™dÀ
)>0)

257 
	`¶ìp
(1);

258 
	}
}

260 
	$evít_decodî
(
¢d_£q_t
 *
h™dÀ
, 
¨gc
, *
¨gv
[])

262 
¢d_£q_evít_t
 *
ev
;

263 
¢d_£q_p‹t_öfo_t
 *
pöfo
;

264 
¢d_£q_p‹t_subs¸ibe_t
 *
sub
;

265 
¢d_£q_addr_t
 
addr
;

266 
˛õ¡
, 
p‹t
, 
queue
, 
max
, 
îr
, 
v1
, 
v2
;

267 *
±r
;

268 
pﬁlfd
 *
pfds
;

270 i‡((
˛õ¡
 = 
	`¢d_£q_˛õ¡_id
(
h™dÀ
))<0) {

271 
	`Ârötf
(
°dîr
, "C™nŸ dëîmöê˛õ¡Çumbî: %s\n", 
	`¢d_°ªº‹
(
˛õ¡
));

274 
	`¥ötf
("Clõ¡ ID = %i\n", 
˛õ¡
);

275 i‡((
queue
 = 
	`¢d_£q_Æloc_queue
(
h™dÀ
))<0) {

276 
	`Ârötf
(
°dîr
, "C™nŸáŒoˇã queue: %s\n", 
	`¢d_°ªº‹
(
queue
));

279 
	`¥ötf
("QueuêID = %i\n", 
queue
);

280 i‡((
îr
 = 
	`¢d_£q_n⁄block
(
h™dÀ
, 1))<0)

281 
	`Ârötf
(
°dîr
, "C™nŸ sëÇ⁄block mode: %s\n", 
	`¢d_°ªº‹
(
îr
));

282 
	`¢d_£q_p‹t_öfo_Æloˇ
(&
pöfo
);

283 
	`¢d_£q_p‹t_öfo_£t_«me
(
pöfo
, "Input");

284 
	`¢d_£q_p‹t_öfo_£t_ty≥
(
pöfo
, 
SND_SEQ_PORT_TYPE_MIDI_GENERIC
);

285 
	`¢d_£q_p‹t_öfo_£t_ˇ∑bûôy
(
pöfo
, 
SND_SEQ_PORT_CAP_WRITE
 | 
SND_SEQ_PORT_CAP_READ
 | 
SND_SEQ_PORT_CAP_SUBS_WRITE
);

288 
	`¢d_£q_p‹t_öfo_£t_time°ampög
(
pöfo
, 1);

289 
	`¢d_£q_p‹t_öfo_£t_time°amp_ªÆ
(
pöfo
, 1);

290 
	`¢d_£q_p‹t_öfo_£t_time°amp_queue
(
pöfo
, 
queue
);

292 i‡((
îr
 = 
	`¢d_£q_¸óã_p‹t
(
h™dÀ
, 
pöfo
)) < 0) {

293 
	`Ârötf
(
°dîr
, "C™nŸ cª©êöpuàp‹t: %s\n", 
	`¢d_°ªº‹
(
îr
));

296 
p‹t
 = 
	`¢d_£q_p‹t_öfo_gë_p‹t
(
pöfo
);

297 
	`evít_decodî_°¨t_timî
(
h™dÀ
, 
queue
, 
˛õ¡
, 
p‹t
);

299 
	`¢d_£q_p‹t_subs¸ibe_Æloˇ
(&
sub
);

300 
addr
.
˛õ¡
 = 
SND_SEQ_CLIENT_SYSTEM
;

301 
addr
.
p‹t
 = 
SND_SEQ_PORT_SYSTEM_ANNOUNCE
;

302 
	`¢d_£q_p‹t_subs¸ibe_£t_£ndî
(
sub
, &
addr
);

303 
addr
.
˛õ¡
 = client;

304 
addr
.
p‹t
 =Öort;

305 
	`¢d_£q_p‹t_subs¸ibe_£t_de°
(
sub
, &
addr
);

306 
	`¢d_£q_p‹t_subs¸ibe_£t_queue
(
sub
, 
queue
);

307 
	`¢d_£q_p‹t_subs¸ibe_£t_time_upd©e
(
sub
, 1);

308 
	`¢d_£q_p‹t_subs¸ibe_£t_time_ªÆ
(
sub
, 1);

309 i‡((
îr
 = 
	`¢d_£q_subs¸ibe_p‹t
(
h™dÀ
, 
sub
))<0) {

310 
	`Ârötf
(
°dîr
, "C™nŸ subs¸ibê™noun˚Ö‹t: %s\n", 
	`¢d_°ªº‹
(
îr
));

314 
addr
.
˛õ¡
 = 
SND_SEQ_CLIENT_SYSTEM
;

315 
addr
.
p‹t
 = 
SND_SEQ_PORT_SYSTEM_TIMER
;

316 
	`¢d_£q_p‹t_subs¸ibe_£t_£ndî
(
sub
, &
addr
);

317 i‡((
îr
 = 
	`¢d_£q_subs¸ibe_p‹t
(
h™dÀ
, 
sub
))<0) {

318 
	`Ârötf
(
°dîr
, "C™nŸ subs¸ibêtimîÖ‹t: %s\n", 
	`¢d_°ªº‹
(
îr
));

322 
max
 = 0; max < 
¨gc
; max++) {

323 
±r
 = 
¨gv
[
max
];

324 i‡(!
±r
)

326 
	`¢d_£q_p‹t_subs¸ibe_£t_time_ªÆ
(
sub
, 0);

327 i‡(
	`tﬁowî
(*
±r
) == 'r') {

328 
	`¢d_£q_p‹t_subs¸ibe_£t_time_ªÆ
(
sub
, 1);

329 
±r
++;

331 i‡(
	`ssˇnf
(
±r
, "%i.%i", &
v1
, &
v2
) != 2) {

332 
	`Ârötf
(
°dîr
, "Wr⁄gárgumíà'%s'...\n", 
¨gv
[
max
]);

335 
addr
.
˛õ¡
 = 
v1
;

336 
addr
.
p‹t
 = 
v2
;

337 
	`¢d_£q_p‹t_subs¸ibe_£t_£ndî
(
sub
, &
addr
);

338 i‡((
îr
 = 
	`¢d_£q_subs¸ibe_p‹t
(
h™dÀ
, 
sub
))<0) {

339 
	`Ârötf
(
°dîr
, "C™nŸ subs¸ibêp‹à%ò‰om clõ¡ %i: %s\n", 
v2
, 
v1
, 
	`¢d_°ªº‹
(
îr
));

344 
max
 = 
	`¢d_£q_pﬁl_des¸ùt‹s_cou¡
(
h™dÀ
, 
POLLIN
);

345 
pfds
 = 
	`Æloˇ
((*pfdsË* 
max
);

347 
	`¢d_£q_pﬁl_des¸ùt‹s
(
h™dÀ
, 
pfds
, 
max
, 
POLLIN
);

348 i‡(
	`pﬁl
(
pfds
, 
max
, -1) < 0)

351 i‡((
îr
 = 
	`¢d_£q_evít_öput
(
h™dÀ
, &
ev
))<0)

353 i‡(!
ev
)

355 
	`decode_evít
(
ev
);

356 
	`¢d_£q_‰ì_evít
(
ev
);

357 } 
îr
 > 0);

359 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/seq-sender.c

2 #ifde‡
USE_PCM


7 
	gpˇrd
 = 0;

8 
	gpdevi˚
 = 0;

9 
	g≥riod_size
 = 1024;

11 
	$£t_hw∑øms
(
¢d_pcm_t
 *
ph™dÀ
)

13 
îr
;

14 
¢d_pcm_hw_∑øms_t
 *
∑øms
;

16 
îr
 = 
	`¢d_ouçut_°dio_©èch
(&
log
, 
°dîr
, 0);

17 i‡(
îr
 < 0) {

18 
	`Ârötf
(
°dîr
, "cannotáttach output stdio\n");

19 
	`exô
(0);

22 
	`¢d_pcm_hw_∑øms_Æloˇ
(&
∑øms
);

23 
îr
 = 
	`¢d_pcm_hw_∑øms_™y
(
ph™dÀ
, 
∑øms
);

24 i‡(
îr
 < 0) {

25 
	`Ârötf
(
°dîr
, "Broken configuration forÅhis PCM:Ço configurationsávailable\n");

26 
	`exô
(0);

29 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_ac˚ss
(
ph™dÀ
, 
∑øms
,

30 
SND_PCM_ACCESS_RW_INTERLEAVED
);

31 i‡(
îr
 < 0) {

32 
	`Ârötf
(
°dîr
, "AccessÅypeÇotávailable\n");

33 
	`exô
(0);

35 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_f‹m©
(
ph™dÀ
, 
∑øms
, 
SND_PCM_FORMAT_S16_LE
);

36 i‡(
îr
 < 0) {

37 
	`Ârötf
(
°dîr
, "cannot set format\n");

38 
	`exô
(0);

40 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_ch™√ls
(
ph™dÀ
, 
∑øms
, 2);

41 i‡(
îr
 < 0) {

42 
	`Ârötf
(
°dîr
, "cannot set channels 2\n");

43 
	`exô
(0);

45 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_øã_√¨
(
ph™dÀ
, 
∑øms
, 44100, 0);

46 i‡(
îr
 < 0) {

47 
	`Ârötf
(
°dîr
, "cannot setÑate\n");

48 
	`exô
(0);

50 
îr
 = 
	`¢d_pcm_hw_∑øms_£t_≥riod_size_√¨
(
ph™dÀ
, 
∑øms
, 
≥riod_size
);

51 i‡(
îr
 < 0) {

52 
	`Ârötf
(
°dîr
, "cannot setÖeriod size\n");

53 
	`exô
(0);

55 
îr
 = 
	`¢d_pcm_hw_∑øms
(
ph™dÀ
, 
∑øms
);

56 i‡(
îr
 < 0) {

57 
	`Ârötf
(
°dîr
, "UnableÅo install hwÖarams:\n");

58 
	`exô
(0);

60 
	`¢d_pcm_hw_∑øms_dump
(
∑øms
, 
log
);

61 
	}
}

68 
	$evít_£ndî_°¨t_timî
(
¢d_£q_t
 *
h™dÀ
,

69 
˛õ¡
 
ATTRIBUTE_UNUSED
,

70 
queue
,

71 
¢d_pcm_t
 *
ph™dÀ
 
ATTRIBUTE_UNUSED
)

73 
îr
;

75 #ifde‡
USE_PCM


76 i‡(
ph™dÀ
) {

77 
¢d_pcm_∂ayback_öfo_t
 
pöfo
;

78 
¢d_£q_queue_timî_t
 
qtimî
;

80 i‡((
îr
 = 
	`¢d_pcm_∂ayback_öfo
(
ph™dÀ
, &
pöfo
)) < 0) {

81 
	`Ârötf
(
°dîr
, "Pœyback infÿîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

82 
	`exô
(0);

84 
	`bzîo
(&
qtimî
, (qtimer));

85 
qtimî
.
ty≥
 = 
SND_SEQ_TIMER_MASTER
;

88 
qtimî
.
numbî
 = 
	`SND_TIMER_PCM
(
pˇrd
, 
pdevi˚
, 
pöfo
.
subdevi˚
 << 1);

89 i‡((
îr
 = 
	`¢d_£q_£t_queue_timî
(
h™dÀ
, 
queue
, &
qtimî
)) < 0) {

90 
	`Ârötf
(
°dîr
, "Sequí˚∏PCMÅimî sëu∞Áûed: %s\n", 
	`¢d_°ªº‹
(
îr
));

91 
	`exô
(0);

95 i‡((
îr
 = 
	`¢d_£q_°¨t_queue
(
h™dÀ
, 
queue
, 
NULL
))<0)

96 
	`Ârötf
(
°dîr
, "TimîÉvíàouçuàîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

97 
	`¢d_£q_døö_ouçut
(
h™dÀ
);

98 
	}
}

100 
	$evít_£ndî_fûãr
(
¢d_£q_t
 *
h™dÀ
)

102 
îr
;

104 i‡((
îr
 = 
	`¢d_£q_£t_˛õ¡_evít_fûãr
(
h™dÀ
, 
SND_SEQ_EVENT_ECHO
)) < 0) {

105 
	`Ârötf
(
°dîr
, "U«bÀÅÿ£à˛õ¡ info: %s\n", 
	`¢d_°ªº‹
(
îr
));

108 
	}
}

110 
	$£nd_evít
(
¢d_£q_t
 *
h™dÀ
, 
queue
, 
˛õ¡
, 
p‹t
,

111 
¢d_£q_addr_t
 *
de°
, *
time
)

113 
îr
;

114 
¢d_£q_evít_t
 
ev
;

116 
	`bzîo
(&
ev
, (ev));

117 
ev
.
queue
 = queue;

118 
ev
.
sour˚
.
˛õ¡
 =Év.
de°
.client = client;

119 
ev
.
sour˚
.
p‹t
 =Év.
de°
.port =Öort;

120 
ev
.
Êags
 = 
SND_SEQ_TIME_STAMP_REAL
 | 
SND_SEQ_TIME_MODE_ABS
;

121 
ev
.
time
.time.
tv_£c
 = *time; (*time)++;

122 
ev
.
ty≥
 = 
SND_SEQ_EVENT_ECHO
;

123 i‡((
îr
 = 
	`¢d_£q_evít_ouçut
(
h™dÀ
, &
ev
))<0)

124 
	`Ârötf
(
°dîr
, "Evíàouçuàîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

125 
ev
.
de°
 = *dest;

126 
ev
.
ty≥
 = 
SND_SEQ_EVENT_PGMCHANGE
;

127 
ev
.
d©a
.
c⁄åﬁ
.
ch™√l
 = 0;

128 
ev
.
d©a
.
c⁄åﬁ
.
vÆue
 = 16;

129 i‡((
îr
 = 
	`¢d_£q_evít_ouçut
(
h™dÀ
, &
ev
))<0)

130 
	`Ârötf
(
°dîr
, "Evíàouçuàîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

131 
ev
.
ty≥
 = 
SND_SEQ_EVENT_NOTE
;

132 
ev
.
d©a
.
nŸe
.
ch™√l
 = 0;

133 
ev
.
d©a
.
nŸe
.nŸê64 + (
queue
*2);

134 
ev
.
d©a
.
nŸe
.
vñocôy
 = 127;

135 
ev
.
d©a
.
nŸe
.
off_vñocôy
 = 127;

136 
ev
.
d©a
.
nŸe
.
duøti⁄
 = 500;

137 i‡((
îr
 = 
	`¢d_£q_evít_ouçut
(
h™dÀ
, &
ev
))<0)

138 
	`Ârötf
(
°dîr
, "Evíàouçuàîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

139 i‡((
îr
 = 
	`¢d_£q_døö_ouçut
(
h™dÀ
))<0)

140 
	`Ârötf
(
°dîr
, "EvíàdøöÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

141 
	}
}

143 
	$evít_£ndî
(
¢d_£q_t
 *
h™dÀ
, 
¨gc
, *
¨gv
[])

145 
¢d_£q_evít_t
 *
ev
;

146 
¢d_£q_p‹t_öfo_t
 *
pöfo
;

147 
¢d_£q_p‹t_subs¸ibe_t
 *
sub
;

148 
¢d_£q_addr_t
 
addr
;

149 
pﬁlfd
 *
pfds
;

150 
˛õ¡
, 
p‹t
, 
queue
, 
max
, 
îr
, 
v1
, 
v2
, 
time
 = 0, 
pcm_Êag
 = 0;

151 *
±r
;

152 
¢d_pcm_t
 *
ph™dÀ
 = 
NULL
;

154 i‡(
¨gc
 < 1) {

155 
	`Ârötf
(
°dîr
, "Invalid destination...\n");

159 i‡((
˛õ¡
 = 
	`¢d_£q_˛õ¡_id
(
h™dÀ
))<0) {

160 
	`Ârötf
(
°dîr
, "C™nŸ dëîmöê˛õ¡Çumbî: %s\n", 
	`¢d_°ªº‹
(
˛õ¡
));

163 
	`¥ötf
("Clõ¡ ID = %i\n", 
˛õ¡
);

164 i‡((
queue
 = 
	`¢d_£q_Æloc_queue
(
h™dÀ
))<0) {

165 
	`Ârötf
(
°dîr
, "C™nŸáŒoˇã queue: %s\n", 
	`¢d_°ªº‹
(
queue
));

168 
	`¥ötf
("QueuêID = %i\n", 
queue
);

169 
	`evít_£ndî_fûãr
(
h™dÀ
);

170 i‡((
îr
 = 
	`¢d_£q_n⁄block
(
h™dÀ
, 1))<0)

171 
	`Ârötf
(
°dîr
, "C™nŸ sëÇ⁄block mode: %s\n", 
	`¢d_°ªº‹
(
îr
));

173 
	`¢d_£q_p‹t_öfo_Æloˇ
(&
pöfo
);

174 
	`¢d_£q_p‹t_öfo_£t_ˇ∑bûôy
(
pöfo
, 
SND_SEQ_PORT_CAP_WRITE
 | 
SND_SEQ_PORT_CAP_READ
);

175 
	`¢d_£q_p‹t_öfo_£t_«me
(
pöfo
, "Output");

176 i‡((
îr
 = 
	`¢d_£q_¸óã_p‹t
(
h™dÀ
, 
pöfo
)) < 0) {

177 
	`Ârötf
(
°dîr
, "C™nŸ cª©êouçuàp‹t: %s\n", 
	`¢d_°ªº‹
(
îr
));

180 
p‹t
 = 
	`¢d_£q_p‹t_öfo_gë_p‹t
(
pöfo
);

182 
	`¢d_£q_p‹t_subs¸ibe_Æloˇ
(&
sub
);

183 
addr
.
˛õ¡
 = client;

184 
addr
.
p‹t
 =Öort;

185 
	`¢d_£q_p‹t_subs¸ibe_£t_£ndî
(
sub
, &
addr
);

187 
max
 = 0; max < 
¨gc
; max++) {

188 
±r
 = 
¨gv
[
max
];

189 i‡(!
±r
)

191 i‡(!
	`°rcmp
(
±r
, "pcm")) {

192 
pcm_Êag
 = 1;

195 i‡(
	`ssˇnf
(
±r
, "%i.%i", &
v1
, &
v2
) != 2) {

196 
	`Ârötf
(
°dîr
, "Wr⁄gárgumíà'%s'...\n", 
¨gv
[
max
]);

199 
addr
.
˛õ¡
 = 
v1
;

200 
addr
.
p‹t
 = 
v2
;

201 
	`¢d_£q_p‹t_subs¸ibe_£t_de°
(
sub
, &
addr
);

202 i‡((
îr
 = 
	`¢d_£q_subs¸ibe_p‹t
(
h™dÀ
, 
sub
))<0) {

203 
	`Ârötf
(
°dîr
, "C™nŸ subs¸ibêp‹à%ò‰om clõ¡ %i: %s\n", 
v2
, 
v1
, 
	`¢d_°ªº‹
(
îr
));

208 
	`¥ötf
("De°ö©i⁄ clõ¡ = %i,Ö‹à%i\n", 
addr
.
˛õ¡
,áddr.
p‹t
);

210 #ifde‡
USE_PCM


211 i‡(
pcm_Êag
) {

212 i‡((
îr
 = 
	`¢d_pcm_›í
(&
ph™dÀ
, "deÁu…", 
SND_PCM_STREAM_PLAYBACK
, 0)) < 0) {

213 
	`Ârötf
(
°dîr
, "Pœyback o≥¿îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

214 
	`exô
(0);

216 
	`£t_hw∑øms
(
ph™dÀ
);

217 
pbuf
 = 
	`ˇŒoc
(1, 
≥riod_size
 * 4);

218 i‡(
pbuf
 =
NULL
) {

219 
	`Ârötf
(
°dîr
, "NoÉnough memory...\n");

220 
	`exô
(0);

224 
	`evít_£ndî_°¨t_timî
(
h™dÀ
, 
˛õ¡
, 
queue
, 
ph™dÀ
);

227 
	`£nd_evít
(
h™dÀ
, 
queue
, 
˛õ¡
, 
p‹t
, &
addr
, &
time
);

228 #ifde‡
USE_PCM


229 i‡(
ph™dÀ
)

230 
max
 +
	`¢d_pcm_pﬁl_des¸ùt‹s_cou¡
(
ph™dÀ
);

232 
pfds
 = 
	`Æloˇ
((*pfdsË* 
max
);

234 
n£qs
 = 
	`¢d_£q_pﬁl_des¸ùt‹s_cou¡
(
h™dÀ
, 
POLLOUT
|
POLLIN
);

235 i‡(
	`¢d_£q_evít_ouçut_≥ndög
(
h™dÀ
))

236 
	`¢d_£q_pﬁl_des¸ùt‹s
(
h™dÀ
, 
pfds
, 
n£qs
, 
POLLOUT
|
POLLIN
);

238 
	`¢d_£q_pﬁl_des¸ùt‹s
(
h™dÀ
, 
pfds
, 
n£qs
, 
POLLIN
);

239 
max
 = 
n£qs
;

240 #ifde‡
USE_PCM


241 i‡(
ph™dÀ
) {

242 
pmax
 = 
	`¢d_pcm_pﬁl_des¸ùt‹s_cou¡
(
ph™dÀ
);

243 
	`¢d_£q_pﬁl_des¸ùt‹s
(
ph™dÀ
, 
pfds
 + 
max
, 
pmax
);

244 
max
 +
pmax
;

247 i‡(
	`pﬁl
(
pfds
, 
max
, -1) < 0)

249 #ifde‡
USE_PCM


250 i‡(
ph™dÀ
 && (
pfds
[
n£qs
].
ªvíts
 & 
POLLOUT
)) {

251 i‡(
	`¢d_pcm_wrôei
(
ph™dÀ
, 
pbuf
, 
≥riod_size
) !=Öeriod_size) {

252 
	`Ârötf
(
°dîr
, "Playback writeÉrror!!\n");

253 
	`exô
(0);

257 i‡(
pfds
[0].
ªvíts
 & 
POLLOUT
)

258 
	`¢d_£q_døö_ouçut
(
h™dÀ
);

259 i‡(
pfds
[0].
ªvíts
 & 
POLLIN
) {

261 i‡((
îr
 = 
	`¢d_£q_evít_öput
(
h™dÀ
, &
ev
))<0)

263 i‡(!
ev
)

265 i‡(
ev
->
ty≥
 =
SND_SEQ_EVENT_ECHO
)

266 
	`£nd_evít
(
h™dÀ
, 
queue
, 
˛õ¡
, 
p‹t
, &
addr
, &
time
);

267 
	`decode_evít
(
ev
);

268 
	`¢d_£q_‰ì_evít
(
ev
);

269 } 
îr
 > 0);

272 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/seq.c

1 
	~"c⁄fig.h
"

3 
	~<°dio.h
>

4 
	~<°dlib.h
>

5 
	~<°rög.h
>

6 
	~<î∫o.h
>

7 
	~<˘y≥.h
>

8 
	~<gë›t.h
>

9 
	~"../ö˛ude/asoundlib.h
"

11 
	~"£q-decodî.c
"

12 
	~"£q-£ndî.c
"

14 
	#SEQ_VERSION
 "0.0.1"

	)

16 
	#HELPID_HELP
 1000

	)

17 
	#HELPID_DEBUG
 1001

	)

18 
	#HELPID_VERBOSE
 1002

	)

19 
	#HELPID_VERSION
 1003

	)

21 
	gmax_˛õ¡s
;

22 
	gmax_p‹ts
;

23 
	gmax_queues
;

24 
	gdebug
 = 0;

25 
	gvîbo£
 = 0;

27 
	$£t_«me
(
¢d_£q_t
 *
h™dÀ
)

29 
îr
;

30 
«me
[64];

32 
	`•rötf
(
«me
, "SeqUtû - %i", 
	`gëpid
());

33 i‡((
îr
 = 
	`¢d_£q_£t_˛õ¡_«me
(
h™dÀ
, 
«me
)) < 0) {

34 
	`Ârötf
(
°dîr
, "Së clõ¡ infÿîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

35 
	`exô
(0);

37 
	}
}

39 
	$sy°em_öfo
(
¢d_£q_t
 *
h™dÀ
)

41 
îr
;

42 
¢d_£q_sy°em_öfo_t
 *
sysöfo
;

44 
	`¢d_£q_sy°em_öfo_Æloˇ
(&
sysöfo
);

45 i‡((
îr
 = 
	`¢d_£q_sy°em_öfo
(
h™dÀ
, 
sysöfo
))<0) {

46 
	`Ârötf
(
°dîr
, "Sy°em infÿîr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

47 
	`exô
(0);

49 
max_˛õ¡s
 = 
	`¢d_£q_sy°em_öfo_gë_˛õ¡s
(
sysöfo
);

50 
max_p‹ts
 = 
	`¢d_£q_sy°em_öfo_gë_p‹ts
(
sysöfo
);

51 
max_queues
 = 
	`¢d_£q_sy°em_öfo_gë_p‹ts
(
sysöfo
);

52 
	}
}

54 
	$show_sy°em_öfo
(
¢d_£q_t
 *
h™dÀ
 
ATTRIBUTE_UNUSED
)

56 
	`¥ötf
("System info\n");

57 
	`¥ötf
(" Max queue† : %i\n", 
max_queues
);

58 
	`¥ötf
(" Max clõ¡† : %i\n", 
max_˛õ¡s
);

59 
	`¥ötf
(" MaxÖ‹t† : %i\n", 
max_p‹ts
);

60 
	}
}

62 
	$show_queue_°©us
(
¢d_£q_t
 *
h™dÀ
, 
queue
)

64 
îr
, 
idx
, 
mö
, 
max
;

65 
¢d_£q_queue_°©us_t
 *
°©us
;

67 
	`¢d_£q_queue_°©us_Æloˇ
(&
°©us
);

68 
mö
 = 
queue
 < 0 ? 0 : queue;

69 
max
 = 
queue
 < 0 ? 
max_queues
 : queue + 1;

70 
idx
 = 
mö
; idx < 
max
; idx++) {

71 i‡((
îr
 = 
	`¢d_£q_gë_queue_°©us
(
h™dÀ
, 
idx
, 
°©us
))<0) {

72 i‡(
îr
 =-
ENOENT
)

74 
	`Ârötf
(
°dîr
, "Clõ¡ %òöfÿîr‹: %s\n", 
idx
, 
	`¢d_°ªº‹
(
îr
));

75 
	`exô
(0);

77 
	`¥ötf
("Queuê%òöfo\n", 
	`¢d_£q_queue_°©us_gë_queue
(
°©us
));

78 
	`¥ötf
(" Tick : %u\n", 
	`¢d_£q_queue_°©us_gë_tick_time
(
°©us
));

79 
	`¥ötf
(" Realtime : %i.%i\n",

80 
	`¢d_£q_queue_°©us_gë_ªÆ_time
(
°©us
)->
tv_£c
,

81 
	`¢d_£q_queue_°©us_gë_ªÆ_time
(
°©us
)->
tv_n£c
);

82 
	`¥ötf
(" Fœg† : 0x%x\n", 
	`¢d_£q_queue_°©us_gë_°©us
(
°©us
));

84 
	}
}

86 
	$show_p‹t_öfo
(
¢d_£q_t
 *
h™dÀ
, 
˛õ¡
, 
p‹t
)

88 
îr
, 
idx
, 
mö
, 
max
;

89 
¢d_£q_p‹t_öfo_t
 *
öfo
;

91 
	`¢d_£q_p‹t_öfo_Æloˇ
(&
öfo
);

92 
mö
 = 
p‹t
 < 0 ? 0 :Öort;

93 
max
 = 
p‹t
 < 0 ? 
max_p‹ts
 :Öort + 1;

94 
idx
 = 
mö
; idx < 
max
; idx++) {

95 i‡((
îr
 = 
	`¢d_£q_gë_™y_p‹t_öfo
(
h™dÀ
, 
˛õ¡
, 
idx
, 
öfo
))<0) {

96 i‡(
îr
 =-
ENOENT
)

98 
	`Ârötf
(
°dîr
, "P‹à%i/%òöfÿîr‹: %s\n", 
˛õ¡
, 
idx
, 
	`¢d_°ªº‹
(
îr
));

99 
	`exô
(0);

101 
	`¥ötf
(" P‹à%òöfo\n", 
idx
);

102 
	`¥ötf
(" Clõ¡ : %i\n", 
	`¢d_£q_p‹t_öfo_gë_˛õ¡
(
öfo
));

103 
	`¥ötf
(" P‹à : %i\n", 
	`¢d_£q_p‹t_öfo_gë_p‹t
(
öfo
));

104 
	`¥ötf
(" Namê : %s\n", 
	`¢d_£q_p‹t_öfo_gë_«me
(
öfo
));

105 
	`¥ötf
(" C≠abûôy : 0x%x\n", 
	`¢d_£q_p‹t_öfo_gë_ˇ∑bûôy
(
öfo
));

106 
	`¥ötf
(" Ty≥ : 0x%x\n", 
	`¢d_£q_p‹t_öfo_gë_ty≥
(
öfo
));

109 
	`¥ötf
(" Ouçuàsub† : %i\n", 
	`¢d_£q_p‹t_öfo_gë_wrôe_u£
(
öfo
));

110 
	`¥ötf
(" I≈uàsub† : %i\n", 
	`¢d_£q_p‹t_öfo_gë_ªad_u£
(
öfo
));

112 
	}
}

114 
	$show_˛õ¡_öfo
(
¢d_£q_t
 *
h™dÀ
, 
˛õ¡
)

116 
îr
, 
idx
, 
mö
, 
max
;

117 
¢d_£q_˛õ¡_öfo_t
 *
öfo
;

119 
	`¢d_£q_˛õ¡_öfo_Æloˇ
(&
öfo
);

120 
mö
 = 
˛õ¡
 < 0 ? 0 : client;

121 
max
 = 
˛õ¡
 < 0 ? 
max_˛õ¡s
 : client + 1;

122 
idx
 = 
mö
; idx < 
max
; idx++) {

123 i‡((
îr
 = 
	`¢d_£q_gë_™y_˛õ¡_öfo
(
h™dÀ
, 
idx
, 
öfo
))<0) {

124 i‡(
îr
 =-
ENOENT
)

126 
	`Ârötf
(
°dîr
, "Clõ¡ %òöfÿîr‹: %s\n", 
idx
, 
	`¢d_°ªº‹
(
îr
));

127 
	`exô
(0);

129 
	`¥ötf
("Clõ¡ %òöfo\n", 
idx
);

130 i‡(
vîbo£
)

131 
	`¥ötf
(" Clõ¡ : %i\n", 
	`¢d_£q_˛õ¡_öfo_gë_˛õ¡
(
öfo
));

132 
	`¥ötf
(" Ty≥ : %s\n", 
	`¢d_£q_˛õ¡_öfo_gë_ty≥
(
öfo
Ë=
SND_SEQ_KERNEL_CLIENT
 ? "kernel" : "user");

133 
	`¥ötf
(" Namê : %s\n", 
	`¢d_£q_˛õ¡_öfo_gë_«me
(
öfo
));

135 
	}
}

137 
	$hñp
()

139 
	`¥ötf
("Usage: seq <options> command\n");

140 
	`¥ötf
("\nAvailable options:\n");

141 
	`¥ötf
(" -h,--helpÅhis help\n");

142 
	`¥ötf
(" -d,--debug debug mode\n");

143 
	`¥ötf
(" -v,--verbose verbose mode\n");

144 
	`¥ötf
(" -V,--versionÖrint version ofÅhisÖrogram\n");

145 
	`¥ötf
("\nAvailable commands:\n");

146 
	`¥ötf
(" system show basic sequencer info\n");

147 
	`¥ötf
(" queue [#] showáll queues or specified queue\n");

148 
	`¥ötf
(" client [#] showáll clients or specified client\n");

149 
	`¥ötf
("Öort <client> [#] showállÖorts or specifiedÖort for specified client\n");

150 
	`¥ötf
(" decoderÉvent decoder\n");

151 
	`¥ötf
(" sender <client.port> [<client.port>] ...Évent sender\n");

152 
	}
}

154 
	$maö
(
¨gc
, *
¨gv
[])

156 
m‹ehñp
, 
îr
, 
¨g
, 
¨g1
;

157 
¢d_£q_t
 *
h™dÀ
;

158 
›ti⁄
 
l⁄g_›ti⁄
[] =

160 {"hñp", 0, 
NULL
, 
HELPID_HELP
},

161 {"debug", 0, 
NULL
, 
HELPID_DEBUG
},

162 {"vîbo£", 0, 
NULL
, 
HELPID_VERBOSE
},

163 {"vîsi⁄", 0, 
NULL
, 
HELPID_VERSION
},

164 {
NULL
, 0, NULL, 0},

167 
m‹ehñp
 = 0;

170 
c
;

172 i‡((
c
 = 
	`gë›t_l⁄g
(
¨gc
, 
¨gv
, "hdvV", 
l⁄g_›ti⁄
, 
NULL
)) < 0)

174 
c
) {

176 
HELPID_HELP
:

177 
m‹ehñp
++;

180 
HELPID_DEBUG
:

181 
debug
 = 1;

184 
HELPID_VERBOSE
:

185 
vîbo£
 = 1;

188 
HELPID_VERSION
:

189 
	`¥ötf
("Æß˘»vîsi⁄ " 
SEQ_VERSION
 "\n");

192 
	`Ârötf
(
°dîr
, "\07Invalid switch or optionÇeedsánárgument.\n");

193 
m‹ehñp
++;

196 i‡(
m‹ehñp
) {

197 
	`hñp
();

200 i‡(
¨gc
 - 
›töd
 <= 0) {

201 
	`Ârötf
(
°dîr
, "seq: Specify command...\n");

204 i‡((
îr
 = 
	`¢d_£q_›í
(&
h™dÀ
, "hw", 
SND_SEQ_OPEN_DUPLEX
, 0))<0) {

205 
	`Ârötf
(
°dîr
, "O≥¿îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

206 
	`exô
(0);

208 
	`£t_«me
(
h™dÀ
);

209 
	`sy°em_öfo
(
h™dÀ
);

211 i‡(!
	`°rcmp
(
¨gv
[
›töd
], "system")) {

212 
	`show_sy°em_öfo
(
h™dÀ
);

213 } i‡(!
	`°rcmp
(
¨gv
[
›töd
], "queue")) {

214 
¨g
 = 
¨gc
 - 
›töd
 > 1 ? 
	`©oi
(
¨gv
[optind + 1]) : -1;

215 
	`show_queue_°©us
(
h™dÀ
, 
¨g
);

216 } i‡(!
	`°rcmp
(
¨gv
[
›töd
], "client")) {

217 
¨g
 = 
¨gc
 - 
›töd
 > 1 ? 
	`©oi
(
¨gv
[optind + 1]) : -1;

218 
	`show_˛õ¡_öfo
(
h™dÀ
, 
¨g
);

219 } i‡(!
	`°rcmp
(
¨gv
[
›töd
], "port")) {

220 
¨g
 = 
¨gc
 - 
›töd
 > 1 ? 
	`©oi
(
¨gv
[optind + 1]) : -1;

221 i‡(
¨g
 < 0) {

222 
	`Ârötf
(
°dîr
, "SpecifyÖort...\n");

223 
	`exô
(0);

225 
¨g1
 = 
¨gc
 - 
›töd
 > 2 ? 
	`©oi
(
¨gv
[optind + 2]) : -1;

226 
	`show_p‹t_öfo
(
h™dÀ
, 
¨g
, 
¨g1
);

227 } i‡(!
	`°rcmp
(
¨gv
[
›töd
], "decoder")) {

228 
	`evít_decodî
(
h™dÀ
, 
¨gc
 - 
›töd
 - 1, 
¨gv
 + optind + 1);

229 } i‡(!
	`°rcmp
(
¨gv
[
›töd
], "sender")) {

230 
	`evít_£ndî
(
h™dÀ
, 
¨gc
 - 
›töd
 - 1, 
¨gv
 + optind + 1);

232 
	`hñp
();

234 
	`exô
(1);

235 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/timer.c

1 
	~"c⁄fig.h
"

2 
	~<°dio.h
>

3 
	~<°dlib.h
>

4 
	~<°rög.h
>

5 
	~<sys/time.h
>

6 
	~"../ö˛ude/asoundlib.h
"

8 
	$show_°©us
(*
h™dÀ
)

10 
îr
;

11 
¢d_timî_°©us_t
 *
°©us
;

13 
	`¢d_timî_°©us_Æloˇ
(&
°©us
);

14 i‡((
îr
 = 
	`¢d_timî_°©us
(
h™dÀ
, 
°©us
)) < 0) {

15 
	`Ârötf
(
°dîr
, "timî sètu†%ò(%s)\n", 
îr
, 
	`¢d_°ªº‹
(err));

18 
	`¥ötf
("STATUS:\n");

19 
	`¥ötf
("Ñesﬁuti⁄ = %li\n", 
	`¢d_timî_°©us_gë_ªsﬁuti⁄
(
°©us
));

20 
	`¥ötf
("Üo° = %li\n", 
	`¢d_timî_°©us_gë_lo°
(
°©us
));

21 
	`¥ötf
(" ovîru¿%li\n", 
	`¢d_timî_°©us_gë_ovîrun
(
°©us
));

22 
	`¥ötf
(" queuê%li\n", 
	`¢d_timî_°©us_gë_queue
(
°©us
));

23 
	}
}

25 
	$ªad_lo›
(*
h™dÀ
, 
ma°î_ticks
, 
timeout
)

27 
cou¡
, 
îr
;

28 
pﬁlfd
 *
fds
;

29 
¢d_timî_ªad_t
 
å
;

31 
cou¡
 = 
	`¢d_timî_pﬁl_des¸ùt‹s_cou¡
(
h™dÀ
);

32 
fds
 = 
	`ˇŒoc
(
cou¡
, (
pﬁlfd
));

33 i‡(
fds
 =
NULL
) {

34 
	`Ârötf
(
°dîr
, "mallocÉrror\n");

35 
	`exô
(
EXIT_FAILURE
);

37 
ma°î_ticks
-- > 0) {

38 i‡((
îr
 = 
	`¢d_timî_pﬁl_des¸ùt‹s
(
h™dÀ
, 
fds
, 
cou¡
)) < 0) {

39 
	`Ârötf
(
°dîr
, "¢d_timî_pﬁl_des¸ùt‹†îr‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

40 
	`exô
(
EXIT_FAILURE
);

42 i‡((
îr
 = 
	`pﬁl
(
fds
, 
cou¡
, 
timeout
)) < 0) {

43 
	`Ârötf
(
°dîr
, "pﬁ»îr‹ %ò(%s)\n", 
îr
, 
	`°ªº‹
(err));

44 
	`exô
(
EXIT_FAILURE
);

46 i‡(
îr
 == 0) {

47 
	`Ârötf
(
°dîr
, "timerÅime out!!\n");

48 
	`exô
(
EXIT_FAILURE
);

50 
	`¢d_timî_ªad
(
h™dÀ
, &
å
, (tr)) == (tr)) {

51 
	`¥ötf
("TIMER:Ñesolution = %uns,Åicks = %u\n",

52 
å
.
ªsﬁuti⁄
,År.
ticks
);

55 
	`‰ì
(
fds
);

56 
	}
}

58 
	$async_ˇŒback
(
¢d_async_h™dÀr_t
 *
ah™dÀr
)

60 
¢d_timî_t
 *
h™dÀ
 = 
	`¢d_async_h™dÀr_gë_timî
(
ah™dÀr
);

61 *
acou¡
 = 
	`¢d_async_h™dÀr_gë_ˇŒback_¥iv©e
(
ah™dÀr
);

62 
¢d_timî_ªad_t
 
å
;

64 
	`¢d_timî_ªad
(
h™dÀ
, &
å
, (tr)) == (tr)) {

65 
	`¥ötf
("TIMER:Ñesolution = %uns,Åicks = %u\n",

66 
å
.
ªsﬁuti⁄
,År.
ticks
);

68 (*
acou¡
)++;

69 
	}
}

71 
	$maö
(
¨gc
, *
¨gv
[])

73 
idx
, 
îr
;

74 
˛ass
 = 
SND_TIMER_CLASS_GLOBAL
;

75 
s˛ass
 = 
SND_TIMER_CLASS_NONE
;

76 
ˇrd
 = 0;

77 
devi˚
 = 
SND_TIMER_GLOBAL_SYSTEM
;

78 
subdevi˚
 = 0;

79 
li°
 = 0;

80 
async
 = 0;

81 
acou¡
 = 0;

82 
¢d_timî_t
 *
h™dÀ
;

83 
¢d_timî_id_t
 *
id
;

84 
¢d_timî_öfo_t
 *
öfo
;

85 
¢d_timî_∑øms_t
 *
∑øms
;

86 
timî«me
[64];

87 
¢d_async_h™dÀr_t
 *
ah™dÀr
;

89 
	`¢d_timî_id_Æloˇ
(&
id
);

90 
	`¢d_timî_öfo_Æloˇ
(&
öfo
);

91 
	`¢d_timî_∑øms_Æloˇ
(&
∑øms
);

93 
idx
 = 1;

94 
idx
 < 
¨gc
) {

95 i‡(!
	`°∫cmp
(
¨gv
[
idx
], "class=", 5)) {

96 
˛ass
 = 
	`©oi
(
¨gv
[
idx
]+6);

97 } i‡(!
	`°∫cmp
(
¨gv
[
idx
], "sclass=", 6)) {

98 
s˛ass
 = 
	`©oi
(
¨gv
[
idx
]+7);

99 } i‡(!
	`°∫cmp
(
¨gv
[
idx
], "card=", 5)) {

100 
ˇrd
 = 
	`©oi
(
¨gv
[
idx
]+5);

101 } i‡(!
	`°∫cmp
(
¨gv
[
idx
], "device=", 7)) {

102 
devi˚
 = 
	`©oi
(
¨gv
[
idx
]+7);

103 } i‡(!
	`°∫cmp
(
¨gv
[
idx
], "subdevice=", 10)) {

104 
subdevi˚
 = 
	`©oi
(
¨gv
[
idx
]+10);

105 } i‡(!
	`°rcmp
(
¨gv
[
idx
], "list")) {

106 
li°
 = 1;

107 } i‡(!
	`°rcmp
(
¨gv
[
idx
], "async")) {

108 
async
 = 1;

110 
idx
++;

112 i‡(
˛ass
 =
SND_TIMER_CLASS_SLAVE
 && 
s˛ass
 =
SND_TIMER_SCLASS_NONE
) {

113 
	`Ârötf
(
°dîr
, "slave class isÇot set\n");

114 
	`exô
(
EXIT_FAILURE
);

116 i‡(
li°
) {

117 
¢d_timî_quîy_t
 *
qh™dÀ
;

118 i‡((
îr
 = 
	`¢d_timî_quîy_›í
(&
qh™dÀ
, "hw", 0)) < 0) {

119 
	`Ârötf
(
°dîr
, "¢d_timî_quîy_›íÉº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

120 
	`exô
(
EXIT_FAILURE
);

122 
	`¢d_timî_id_£t_˛ass
(
id
, 
SND_TIMER_CLASS_NONE
);

124 i‡((
îr
 = 
	`¢d_timî_quîy_√xt_devi˚
(
qh™dÀ
, 
id
)) < 0) {

125 
	`Ârötf
(
°dîr
, "timîÇexàdevi˚Éº‹: %s\n", 
	`¢d_°ªº‹
(
îr
));

128 i‡(
	`¢d_timî_id_gë_˛ass
(
id
) < 0)

130 
	`¥ötf
("Timer device: class %i, sclass %i, card %i, device %i, subdevice %i\n",

131 
	`¢d_timî_id_gë_˛ass
(
id
),

132 
	`¢d_timî_id_gë_s˛ass
(
id
),

133 
	`¢d_timî_id_gë_ˇrd
(
id
),

134 
	`¢d_timî_id_gë_devi˚
(
id
),

135 
	`¢d_timî_id_gë_subdevi˚
(
id
));

137 
	`¢d_timî_quîy_˛o£
(
qh™dÀ
);

138 
	`exô
(
EXIT_SUCCESS
);

140 
	`•rötf
(
timî«me
, "hw:CLASS=%i,SCLASS=%i,CARD=%i,DEV=%i,SUBDEV=%i", 
˛ass
, 
s˛ass
, 
ˇrd
, 
devi˚
, 
subdevi˚
);

141 i‡((
îr
 = 
	`¢d_timî_›í
(&
h™dÀ
, 
timî«me
, 
SND_TIMER_OPEN_NONBLOCK
))<0) {

142 
	`Ârötf
(
°dîr
, "timî o≥¿%ò(%s)\n", 
îr
, 
	`¢d_°ªº‹
(err));

143 
	`exô
(
EXIT_FAILURE
);

145 
	`¥ötf
("UsögÅimî cœs†%i, sœvê˛as†%i, c¨d %i, devi˚ %i, subdevi˚ %i\n", 
˛ass
, 
s˛ass
, 
ˇrd
, 
devi˚
, 
subdevi˚
);

146 i‡((
îr
 = 
	`¢d_timî_öfo
(
h™dÀ
, 
öfo
)) < 0) {

147 
	`Ârötf
(
°dîr
, "timî infÿ%ò(%s)\n", 
îr
, 
	`¢d_°ªº‹
(err));

148 
	`exô
(0);

150 
	`¥ötf
("Timer info:\n");

151 
	`¥ötf
(" sœvê%s\n", 
	`¢d_timî_öfo_is_¶ave
(
öfo
) ? "yes" : "no");

152 
	`¥ötf
(" c¨d = %i\n", 
	`¢d_timî_öfo_gë_ˇrd
(
öfo
));

153 
	`¥ötf
(" id = '%s'\n", 
	`¢d_timî_öfo_gë_id
(
öfo
));

154 
	`¥ötf
("Çamê'%s'\n", 
	`¢d_timî_öfo_gë_«me
(
öfo
));

155 
	`¥ötf
("ávîagêªsﬁuti⁄ = %li\n", 
	`¢d_timî_öfo_gë_ªsﬁuti⁄
(
öfo
));

156 
	`¢d_timî_∑øms_£t_auto_°¨t
(
∑øms
, 1);

157 i‡(!
	`¢d_timî_öfo_is_¶ave
(
öfo
)) {

158 
	`¢d_timî_∑øms_£t_ticks
(
∑øms
, (1000000000 / 
	`¢d_timî_öfo_gë_ªsﬁuti⁄
(
öfo
)) / 50);

159 i‡(
	`¢d_timî_∑øms_gë_ticks
(
∑øms
) < 1)

160 
	`¢d_timî_∑øms_£t_ticks
(
∑øms
, 1);

161 
	`¥ötf
("Usög %lòtick(s)\n", 
	`¢d_timî_∑øms_gë_ticks
(
∑øms
));

163 
	`¢d_timî_∑øms_£t_ticks
(
∑øms
, 1);

165 i‡((
îr
 = 
	`¢d_timî_∑øms
(
h™dÀ
, 
∑øms
)) < 0) {

166 
	`Ârötf
(
°dîr
, "timîÖ¨am†%ò(%s)\n", 
îr
, 
	`¢d_°ªº‹
(err));

167 
	`exô
(0);

169 
	`show_°©us
(
h™dÀ
);

170 i‡(
async
) {

171 
îr
 = 
	`¢d_async_add_timî_h™dÀr
(&
ah™dÀr
, 
h™dÀ
, 
async_ˇŒback
, &
acou¡
);

172 i‡(
îr
 < 0) {

173 
	`Ârötf
(
°dîr
, "u«bÀÅÿaddásyn¯h™dÀ∏%ò(%s)\n", 
îr
, 
	`¢d_°ªº‹
(err));

174 
	`exô
(
EXIT_FAILURE
);

177 i‡((
îr
 = 
	`¢d_timî_°¨t
(
h™dÀ
)) < 0) {

178 
	`Ârötf
(
°dîr
, "timî sèπ %ò(%s)\n", 
îr
, 
	`¢d_°ªº‹
(err));

179 
	`exô
(
EXIT_FAILURE
);

181 i‡(
async
) {

184 
acou¡
 < 25)

185 
	`¶ìp
(1);

186 
	`¢d_timî_°›
(
h™dÀ
);

188 
	`ªad_lo›
(
h™dÀ
, 25, 
	`¢d_timî_öfo_is_¶ave
(
öfo
) ? 10000 : 25);

190 
	`show_°©us
(
h™dÀ
);

191 
	`¢d_timî_˛o£
(
h™dÀ
);

192 
	`¥ötf
("Done\n");

193  
EXIT_SUCCESS
;

194 
	}
}

	@/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/user-ctl-element-set.c

10 
	~"c⁄fig.h
"

11 
	~"../ö˛ude/asoundlib.h
"

12 
	~<sound/év.h
>

13 
	~<°dboﬁ.h
>

15 
	sñem_£t_åül
 {

16 
¢d_˘l_t
 *
	mh™dÀ
;

18 
¢d_˘l_ñem_ty≥_t
 
	mty≥
;

19 
	mmembî_cou¡
;

20 
	mñemít_cou¡
;

22 
¢d_˘l_ñem_id_t
 *
	mid
;

24 (*
	madd_ñem_£t
)(
ñem_£t_åül
 *
	måül
,

25 
¢d_˘l_ñem_öfo_t
 *
	möfo
);

26 (*
	mcheck_ñem_¥›s
)(
ñem_£t_åül
 *
	måül
,

27 
¢d_˘l_ñem_öfo_t
 *
	möfo
);

28 (*
	mch™ge_ñem_membîs
)(
ñem_£t_åül
 *
	måül
,

29 
¢d_˘l_ñem_vÆue_t
 *
	mñem_d©a
);

30 (*
	mÆloˇã_ñem_£t_év
)(
ñem_£t_åül
 *
	måül
,

31 **
	mév
);

33 
boﬁ
 
	mév_ªadabÀ
;

36 
	schm≠_íåy
 {

37 
	mty≥
;

38 
	mÀngth
;

39 
	mm≠s
[0];

57 
	$add_boﬁ_ñem_£t
(
ñem_£t_åül
 *
åül
,

58 
¢d_˘l_ñem_öfo_t
 *
öfo
)

60  
	`¢d_˘l_add_boﬁón_ñem_£t
(
åül
->
h™dÀ
, 
öfo
,

61 
åül
->
ñemít_cou¡
,Årül->
membî_cou¡
);

62 
	}
}

64 
	$ch™ge_boﬁ_ñem_membîs
(
ñem_£t_åül
 *
åül
,

65 
¢d_˘l_ñem_vÆue_t
 *
ñem_d©a
)

67 
vÆ
;

68 
i
;

70 
i
 = 0; i < 
åül
->
membî_cou¡
; ++i) {

71 
vÆ
 = 
	`¢d_˘l_ñem_vÆue_gë_boﬁón
(
ñem_d©a
, 
i
);

72 
	`¢d_˘l_ñem_vÆue_£t_boﬁón
(
ñem_d©a
, 
i
, !
vÆ
);

74 
	}
}

76 
	$Æloˇã_boﬁ_ñem_£t_év
(
ñem_£t_åül
 *
åül
,

77 **
év
)

83 c⁄° 
	`SNDRV_CTL_TLVD_DECLARE_DB_MINMAX
(
ønge
, -10000, 0);

85 *
év
 = 
	`mÆloc
((
ønge
));

86 i‡(*
év
 =
NULL
)

87  -
ENOMEM
;

88 
	`mem˝y
(*
év
, 
ønge
, (range));

91 
	}
}

94 
	$add_öt_ñem_£t
(
ñem_£t_åül
 *
åül
,

95 
¢d_˘l_ñem_öfo_t
 *
öfo
)

97  
	`¢d_˘l_add_öãgî_ñem_£t
(
åül
->
h™dÀ
, 
öfo
,

98 
åül
->
ñemít_cou¡
,Årül->
membî_cou¡
,

100 
	}
}

102 
	$check_öt_ñem_¥›s
(
ñem_£t_åül
 *
åül
,

103 
¢d_˘l_ñem_öfo_t
 *
öfo
)

105 i‡(
	`¢d_˘l_ñem_öfo_gë_mö
(
öfo
) != 0)

106  -
EIO
;

107 i‡(
	`¢d_˘l_ñem_öfo_gë_max
(
öfo
) != 25)

108  -
EIO
;

109 i‡(
	`¢d_˘l_ñem_öfo_gë_°ï
(
öfo
) != 1)

110  -
EIO
;

113 
	}
}

115 
	$ch™ge_öt_ñem_membîs
(
ñem_£t_åül
 *
åül
,

116 
¢d_˘l_ñem_vÆue_t
 *
ñem_d©a
)

118 
vÆ
;

119 
i
;

121 
i
 = 0; i < 
åül
->
membî_cou¡
; ++i) {

122 
vÆ
 = 
	`¢d_˘l_ñem_vÆue_gë_öãgî
(
ñem_d©a
, 
i
);

123 
	`¢d_˘l_ñem_vÆue_£t_öãgî
(
ñem_d©a
, 
i
, ++
vÆ
);

125 
	}
}

127 
	$Æloˇã_öt_ñem_£t_év
(
ñem_£t_åül
 *
åül
,

128 **
év
)

130 
cou¡
, 
pos
;

131 
i
, 
j
;

132 
chm≠_íåy
 *
íåy
;

135 
cou¡
 = 0;

136 
i
 = 1; i <= 25; ++i) {

137 
cou¡
 += 2;

138 
cou¡
 +
i
;

141 *
év
 = 
	`mÆloc
((2 + 
cou¡
) * ());

142 i‡(!*
év
)

143  -
ENOMEM
;

149 (*
év
)[0] = 
SNDRV_CTL_TLVT_CONTAINER
;

150 (*
év
)[1] = 
cou¡
 * ();

151 
pos
 = 2;

153 
i
 = 1; i <25 && 
pos
 < 
cou¡
; ++i) {

154 
íåy
 = (
chm≠_íåy
 *)&(*
év
)[
pos
];

156 
íåy
->
ty≥
 = 
SNDRV_CTL_TLVT_CHMAP_FIXED
;

157 
íåy
->
Àngth
 = 
i
 * ();

158 
pos
 += 2;

160 
j
 = 0; j < 
i
; ++j)

161 
íåy
->
m≠s
[
j
] = 
SND_CHMAP_MONO
 + j;

162 
pos
 +
i
;

166 
	}
}

169 c⁄° *c⁄° 
	gœbñs
[] = {

177 
	$add_íum_ñem_£t
(
ñem_£t_åül
 *
åül
,

178 
¢d_˘l_ñem_öfo_t
 *
öfo
)

180  
	`¢d_˘l_add_íumî©ed_ñem_£t
(
åül
->
h™dÀ
, 
öfo
,

181 
åül
->
ñemít_cou¡
,Årül->
membî_cou¡
,

182 (
œbñs
) / (labels[0]),

183 
œbñs
);

184 
	}
}

186 
	$check_íum_ñem_¥›s
(
ñem_£t_åül
 *
åül
,

187 
¢d_˘l_ñem_öfo_t
 *
öfo
)

189 
ôems
;

190 
i
;

191 c⁄° *
œbñ
;

192 
îr
;

194 
ôems
 = 
	`¢d_˘l_ñem_öfo_gë_ôems
(
öfo
);

195 i‡(
ôems
 !(
œbñs
) / (labels[0]))

196  -
EIO
;

199 
i
 = 0; i < 
ôems
; ++i) {

200 
	`¢d_˘l_ñem_öfo_£t_ôem
(
öfo
, 
i
);

201 
îr
 = 
	`¢d_˘l_ñem_öfo
(
åül
->
h™dÀ
, 
öfo
);

202 i‡(
îr
 < 0)

203  
îr
;

205 
œbñ
 = 
	`¢d_˘l_ñem_öfo_gë_ôem_«me
(
öfo
);

206 i‡(
	`°∫cmp
(
œbñ
, 
œbñs
[
i
], 
	`°æí
(labels[i])) != 0)

207  -
EIO
;

211 
	}
}

213 
	$ch™ge_íum_ñem_membîs
(
ñem_£t_åül
 *
åül
,

214 
¢d_˘l_ñem_vÆue_t
 *
ñem_d©a
)

216 
vÆ
;

217 
i
;

219 
i
 = 0; i < 
åül
->
membî_cou¡
; ++i) {

220 
vÆ
 = 
	`¢d_˘l_ñem_vÆue_gë_íumî©ed
(
ñem_d©a
, 
i
);

221 
	`¢d_˘l_ñem_vÆue_£t_íumî©ed
(
ñem_d©a
, 
i
, ++
vÆ
);

223 
	}
}

226 
	$add_byãs_ñem_£t
(
ñem_£t_åül
 *
åül
,

227 
¢d_˘l_ñem_öfo_t
 *
öfo
)

229  
	`¢d_˘l_add_byãs_ñem_£t
(
åül
->
h™dÀ
, 
öfo
,

230 
åül
->
ñemít_cou¡
,Årül->
membî_cou¡
);

231 
	}
}

233 
	$ch™ge_byãs_ñem_membîs
(
ñem_£t_åül
 *
åül
,

234 
¢d_˘l_ñem_vÆue_t
 *
ñem_d©a
)

236 
vÆ
;

237 
i
;

239 
i
 = 0; i < 
åül
->
membî_cou¡
; ++i) {

240 
vÆ
 = 
	`¢d_˘l_ñem_vÆue_gë_byã
(
ñem_d©a
, 
i
);

241 
	`¢d_˘l_ñem_vÆue_£t_byã
(
ñem_d©a
, 
i
, ++
vÆ
);

243 
	}
}

245 
	$Æloˇã_byãs_ñem_£t_év
(
ñem_£t_åül
 *
åül
,

246 **
év
)

253 c⁄° 
	`SNDRV_CTL_TLVD_DECLARE_DB_LINEAR
(
ønge
, -4813, 0);

255 *
év
 = 
	`mÆloc
((
ønge
));

256 i‡(*
év
 =
NULL
)

257  -
ENOMEM
;

258 
	`mem˝y
(*
év
, 
ønge
, (range));

261 
	}
}

264 
	$add_õc958_ñem_£t
(
ñem_£t_åül
 *
åül
,

265 
¢d_˘l_ñem_öfo_t
 *
öfo
)

267 
îr
;

269 
	`¢d_˘l_ñem_öfo_gë_id
(
öfo
, 
åül
->
id
);

271 
îr
 = 
	`¢d_˘l_ñem_add_õc958
(
åül
->
h™dÀ
,Årül->
id
);

272 i‡(
îr
 < 0)

273  
îr
;

279  
	`¢d_˘l_ñem_öfo
(
åül
->
h™dÀ
, 
öfo
);

280 
	}
}

282 
	$ch™ge_õc958_ñem_membîs
(
ñem_£t_åül
 *
åül
,

283 
¢d_˘l_ñem_vÆue_t
 *
ñem_d©a
)

285 
¢d_´s_õc958_t
 
d©a
;

288 
åül
->
ñemít_cou¡
 = 1;

290 
	`¢d_˘l_ñem_vÆue_gë_õc958
(
ñem_d©a
, &
d©a
);

292 
d©a
.
∑d
 = 10;

293 
	`¢d_˘l_ñem_vÆue_£t_õc958
(
ñem_d©a
, &
d©a
);

294 
	}
}

297 
	$add_öt64_ñem_£t
(
ñem_£t_åül
 *
åül
,

298 
¢d_˘l_ñem_öfo_t
 *
öfo
)

300  
	`¢d_˘l_add_öãgî64_ñem_£t
(
åül
->
h™dÀ
, 
öfo
,

301 
åül
->
ñemít_cou¡
,Årül->
membî_cou¡
,

303 
	}
}

305 
	$check_öt64_ñem_¥›s
(
ñem_£t_åül
 *
åül
,

306 
¢d_˘l_ñem_öfo_t
 *
öfo
)

308 i‡(
	`¢d_˘l_ñem_öfo_gë_mö64
(
öfo
) != 0)

309  -
EIO
;

310 i‡(
	`¢d_˘l_ñem_öfo_gë_max64
(
öfo
) != 10000)

311  -
EIO
;

312 i‡(
	`¢d_˘l_ñem_öfo_gë_°ï64
(
öfo
) != 1)

313  -
EIO
;

316 
	}
}

318 
	$ch™ge_öt64_ñem_membîs
(
ñem_£t_åül
 *
åül
,

319 
¢d_˘l_ñem_vÆue_t
 *
ñem_d©a
)

321 
vÆ
;

322 
i
;

324 
i
 = 0; i < 
åül
->
membî_cou¡
; ++i) {

325 
vÆ
 = 
	`¢d_˘l_ñem_vÆue_gë_öãgî64
(
ñem_d©a
, 
i
);

326 
	`¢d_˘l_ñem_vÆue_£t_öãgî64
(
ñem_d©a
, 
i
, ++
vÆ
);

328 
	}
}

330 
	$Æloˇã_öt64_ñem_£t_év
(
ñem_£t_åül
 *
åül
,

331 **
év
)

348 c⁄° 
	`SNDRV_CTL_TLVD_DECLARE_DB_RANGE
(
ønge
,

349 0, 4, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(-5940, 44, 1),

350 4, 22, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(-5636, 60, 0),

351 22, 33, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(-4556, 76, 0),

352 33, 37, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(-4072, 44, 0),

353 37, 48, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(-3832, 76, 0),

354 48, 66, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(-2996, 60, 0),

355 66, 84, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(-2204, 44, 0),

356 84, 95, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
( -836, 60, 0),

357 95, 99, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
( -176, 76, 0),

358 100, 10000, 
	`SNDRV_CTL_TLVD_DB_SCALE_ITEM
(0, 0, 0),

361 *
év
 = 
	`mÆloc
((
ønge
));

362 i‡(*
év
 =
NULL
)

363  -
ENOMEM
;

364 
	`mem˝y
(*
év
, 
ønge
, (range));

367 
	}
}

370 
	$add_ñem_£t
(
ñem_£t_åül
 *
åül
)

372 
¢d_˘l_ñem_öfo_t
 *
öfo
;

373 
«me
[64] = {0};

374 
îr
;

376 
	`¢¥ötf
(
«me
, 64, "userspace-control-element-%s",

377 
	`¢d_˘l_ñem_ty≥_«me
(
åül
->
ty≥
));

379 
	`¢d_˘l_ñem_öfo_Æloˇ
(&
öfo
);

380 
	`¢d_˘l_ñem_öfo_£t_öãrÁ˚
(
öfo
, 
SND_CTL_ELEM_IFACE_MIXER
);

381 
	`¢d_˘l_ñem_öfo_£t_«me
(
öfo
, 
«me
);

383 
îr
 = 
åül
->
	`add_ñem_£t
—rül, 
öfo
);

384 i‡(
îr
 >= 0)

385 
	`¢d_˘l_ñem_öfo_gë_id
(
öfo
, 
åül
->
id
);

387  
îr
;

388 
	}
}

390 
	$check_evít
(
ñem_£t_åül
 *
åül
, 
mask
,

391 
ex≥˘ed_cou¡
)

393 
pﬁlfd
 
pfds
;

394 
cou¡
;

395 
ªvíts
;

396 
¢d_˘l_evít_t
 *
evít
;

397 
îr
;

399 
	`¢d_˘l_evít_Æloˇ
(&
evít
);

401 i‡(
	`¢d_˘l_pﬁl_des¸ùt‹s_cou¡
(
åül
->
h™dÀ
) != 1)

402  -
ENXIO
;

404 i‡(
	`¢d_˘l_pﬁl_des¸ùt‹s
(
åül
->
h™dÀ
, &
pfds
, 1) != 1)

405  -
ENXIO
;

407 
ex≥˘ed_cou¡
 > 0) {

408 
cou¡
 = 
	`pﬁl
(&
pfds
, 1, 1000);

409 i‡(
cou¡
 < 0)

410  
î∫o
;

412 i‡(
cou¡
 == 0)

413  -
ETIMEDOUT
;

415 
îr
 = 
	`¢d_˘l_pﬁl_des¸ùt‹s_ªvíts
(
åül
->
h™dÀ
, &
pfds
,

416 
cou¡
, &
ªvíts
);

417 i‡(
îr
 < 0)

418  
îr
;

419 i‡(
ªvíts
 & 
POLLERR
)

420  -
EIO
;

421 i‡(!(
ªvíts
 & 
POLLIN
))

424 
îr
 = 
	`¢d_˘l_ªad
(
åül
->
h™dÀ
, 
evít
);

425 i‡(
îr
 < 0)

426  
îr
;

427 i‡(
	`¢d_˘l_evít_gë_ty≥
(
evít
Ë!
SND_CTL_EVENT_ELEM
)

433 i‡((
	`¢d_˘l_evít_ñem_gë_mask
(
evít
Ë& 
mask
) != mask)

435 --
ex≥˘ed_cou¡
;

438 i‡(
ex≥˘ed_cou¡
 != 0)

439  -
EIO
;

442 
	}
}

444 
	$check_ñem_li°
(
ñem_£t_åül
 *
åül
)

446 
¢d_˘l_ñem_li°_t
 *
li°
;

447 
¢d_˘l_ñem_id_t
 *
id
;

448 
e
;

449 
i
;

450 
îr
;

452 
	`¢d_˘l_ñem_li°_Æloˇ
(&
li°
);

453 
	`¢d_˘l_ñem_id_Æloˇ
(&
id
);

455 
îr
 = 
	`¢d_˘l_ñem_li°
(
åül
->
h™dÀ
, 
li°
);

456 i‡(
îr
 < 0)

457  
îr
;

460 i‡(
	`¢d_˘l_ñem_li°_gë_cou¡
(
li°
) == 0)

461  -
EIO
;

463 
îr
 = 
	`¢d_˘l_ñem_li°_Æloc_•a˚
(
li°
,

464 
	`¢d_˘l_ñem_li°_gë_cou¡
(
li°
));

465 i‡(
îr
 < 0)

466  
îr
;

468 
îr
 = 
	`¢d_˘l_ñem_li°
(
åül
->
h™dÀ
, 
li°
);

469 i‡(
îr
 < 0)

470 
íd
;

472 i‡(
åül
->
ñemít_cou¡
 > 
	`¢d_˘l_ñem_li°_gë_cou¡
(
li°
)) {

473 
îr
 = -
EIO
;

474 
íd
;

477 
i
 = 0;

478 
e
 = 0;É < 
	`¢d_˘l_ñem_li°_gë_cou¡
(
li°
); ++e) {

479 
	`¢d_˘l_ñem_li°_gë_id
(
li°
, 
e
, 
id
);

481 i‡(
	`°rcmp
(
	`¢d_˘l_ñem_id_gë_«me
(
id
),

482 
	`¢d_˘l_ñem_id_gë_«me
(
åül
->
id
)) != 0)

484 i‡(
	`¢d_˘l_ñem_id_gë_öãrÁ˚
(
id
) !=

485 
	`¢d_˘l_ñem_id_gë_öãrÁ˚
(
åül
->
id
))

487 i‡(
	`¢d_˘l_ñem_id_gë_devi˚
(
id
) !=

488 
	`¢d_˘l_ñem_id_gë_devi˚
(
åül
->
id
))

490 i‡(
	`¢d_˘l_ñem_id_gë_subdevi˚
(
id
) !=

491 
	`¢d_˘l_ñem_id_gë_subdevi˚
(
åül
->
id
))

498 i‡(
	`¢d_˘l_ñem_id_gë_numid
(
id
) !=

499 
	`¢d_˘l_ñem_id_gë_numid
(
åül
->
id
Ë+ 
i
)

501 i‡(
	`¢d_˘l_ñem_id_gë_ödex
(
id
) !=

502 
	`¢d_˘l_ñem_id_gë_ödex
(
åül
->
id
Ë+ 
i
)

505 ++
i
;

508 i‡(
i
 !
åül
->
ñemít_cou¡
)

509 
îr
 = -
EIO
;

510 
íd
:

511 
	`¢d_˘l_ñem_li°_‰ì_•a˚
(
li°
);

513  
îr
;

514 
	}
}

516 
	$check_ñem_£t_¥›s
(
ñem_£t_åül
 *
åül
)

518 
¢d_˘l_ñem_id_t
 *
id
;

519 
¢d_˘l_ñem_öfo_t
 *
öfo
;

520 
numid
;

521 
ödex
;

522 
i
;

523 
j
;

524 
îr
;

526 
	`¢d_˘l_ñem_id_Æloˇ
(&
id
);

527 
	`¢d_˘l_ñem_öfo_Æloˇ
(&
öfo
);

529 
	`¢d_˘l_ñem_öfo_£t_id
(
öfo
, 
åül
->
id
);

530 
numid
 = 
	`¢d_˘l_ñem_id_gë_numid
(
åül
->
id
);

531 
ödex
 = 
	`¢d_˘l_ñem_id_gë_ödex
(
åül
->
id
);

533 
i
 = 0; i < 
åül
->
ñemít_cou¡
; ++i) {

534 
	`¢d_˘l_ñem_öfo_£t_ödex
(
öfo
, 
ödex
 + 
i
);

540 i‡(
numid
 > 0)

541 
	`¢d_˘l_ñem_öfo_£t_numid
(
öfo
, 
numid
 + 
i
);

543 
îr
 = 
	`¢d_˘l_ñem_öfo
(
åül
->
h™dÀ
, 
öfo
);

544 i‡(
îr
 < 0)

545  
îr
;

548 i‡(
	`¢d_˘l_ñem_öfo_gë_ty≥
(
öfo
Ë!
åül
->
ty≥
)

549  -
EIO
;

550 i‡(
	`¢d_˘l_ñem_öfo_gë_cou¡
(
öfo
Ë!
åül
->
membî_cou¡
)

551  -
EIO
;

557 i‡(
	`¢d_˘l_ñem_öfo_gë_ow√r
(
öfo
Ë!
	`gëpid
())

558  -
EIO
;

564 i‡(!
	`¢d_˘l_ñem_öfo_is_locked
(
öfo
))

565  -
EIO
;

573 i‡(
åül
->
ty≥
 !
SND_CTL_ELEM_TYPE_IEC958
 &&

574 !
	`¢d_˘l_ñem_öfo_is_év_wrôabÀ
(
öfo
))

575  -
EIO
;

578 i‡(
åül
->
check_ñem_¥›s
 !
NULL
) {

579 
îr
 = 
åül
->
	`check_ñem_¥›s
—rül, 
öfo
);

580 i‡(
îr
 < 0)

581  
îr
;

584 
	`¢d_˘l_ñem_öfo_gë_id
(
öfo
, 
id
);

585 
îr
 = 
	`¢d_˘l_ñem_u∆ock
(
åül
->
h™dÀ
, 
id
);

586 i‡(
îr
 < 0)

587  
îr
;

595 i‡(
	`¢d_˘l_ñem_öfo_is_év_ªadabÀ
(
öfo
)) {

596 
d©a
[32];

597 
îr
 = 
	`¢d_˘l_ñem_év_ªad
(
åül
->
h™dÀ
,Årül->
id
,

598 
d©a
, (data));

599 i‡(
îr
 >= 0)

600  -
EIO
;

601 i‡(
îr
 !-
ENXIO
)

602  
îr
;

604 
åül
->
év_ªadabÀ
 = 
åue
;

610 
	}
}

612 
	$check_ñems
(
ñem_£t_åül
 *
åül
)

614 
¢d_˘l_ñem_vÆue_t
 *
d©a
;

615 
numid
;

616 
ödex
;

617 
i
;

618 
îr
;

620 
	`¢d_˘l_ñem_vÆue_Æloˇ
(&
d©a
);

622 
	`¢d_˘l_ñem_vÆue_£t_id
(
d©a
, 
åül
->
id
);

623 
numid
 = 
	`¢d_˘l_ñem_id_gë_numid
(
åül
->
id
);

624 
ödex
 = 
	`¢d_˘l_ñem_id_gë_ödex
(
åül
->
id
);

626 
i
 = 0; i < 
åül
->
ñemít_cou¡
; ++i) {

627 
	`¢d_˘l_ñem_vÆue_£t_ödex
(
d©a
, 
ödex
 + 
i
);

633 i‡(
numid
 > 0)

634 
	`¢d_˘l_ñem_vÆue_£t_numid
(
d©a
, 
numid
 + 
i
);

636 
îr
 = 
	`¢d_˘l_ñem_ªad
(
åül
->
h™dÀ
, 
d©a
);

637 i‡(
îr
 < 0)

638  
îr
;

641 
åül
->
	`ch™ge_ñem_membîs
—rül, 
d©a
);

643 
îr
 = 
	`¢d_˘l_ñem_wrôe
(
åül
->
h™dÀ
, 
d©a
);

644 i‡(
îr
 < 0)

645  
îr
;

649 
	}
}

651 
	$check_év
(
ñem_£t_åül
 *
åül
)

653 *
év
;

654 
mask
;

655 
cou¡
;

656 
Àn
;

657 *
cuº
;

658 
îr
;

660 
îr
 = 
åül
->
	`Æloˇã_ñem_£t_év
—rül, &
év
);

661 i‡(
îr
 < 0)

662  
îr
;

664 
Àn
 = 
év
[
SNDRV_CTL_TLVO_LEN
] + () * 2;

665 
cuº
 = 
	`mÆloc
(
Àn
);

666 i‡(
cuº
 =
NULL
) {

667 
	`‰ì
(
év
);

668  -
ENOMEM
;

676 
îr
 = 
	`¢d_˘l_ñem_év_wrôe
(
åül
->
h™dÀ
,Årül->
id
,

677 (c⁄° *)
év
);

678 i‡(
îr
 < 0)

679 
íd
;

686 i‡(!
åül
->
év_ªadabÀ
) {

687 
mask
 = 
SND_CTL_EVENT_MASK_INFO
 | 
SND_CTL_EVENT_MASK_TLV
;

688 
cou¡
 = 
åül
->
ñemít_cou¡
;

690 
mask
 = 
SND_CTL_EVENT_MASK_TLV
;

691 
cou¡
 = 1;

693 
îr
 = 
	`check_evít
(
åül
, 
mask
, 
cou¡
);

694 i‡(
îr
 < 0)

695 
íd
;

696 i‡(!
åül
->
év_ªadabÀ
) {

697 
¢d_˘l_ñem_öfo_t
 *
öfo
;

698 
	`¢d_˘l_ñem_öfo_Æloˇ
(&
öfo
);

700 
	`¢d_˘l_ñem_öfo_£t_id
(
öfo
, 
åül
->
id
);

701 
îr
 = 
	`¢d_˘l_ñem_öfo
(
åül
->
h™dÀ
, 
öfo
);

702 i‡(
îr
 < 0)

703  
îr
;

704 i‡(!
	`¢d_˘l_ñem_öfo_is_év_ªadabÀ
(
öfo
))

705  -
EIO
;

708 
åül
->
év_ªadabÀ
 = 
åue
;

711 
îr
 = 
	`¢d_˘l_ñem_év_ªad
(
åül
->
h™dÀ
,Årül->
id
, 
cuº
, 
Àn
);

712 i‡(
îr
 < 0)

713 
íd
;

715 i‡(
	`memcmp
(
cuº
, 
év
, 
Àn
) != 0)

716 
îr
 = -
EIO
;

717 
íd
:

718 
	`‰ì
(
év
);

719 
	`‰ì
(
cuº
);

721 
	}
}

723 
	$maö
()

725 
ñem_£t_åül
 
åül
 = {0};

726 
i
;

727 
îr
;

729 
	`¢d_˘l_ñem_id_Æloˇ
(&
åül
.
id
);

731 
îr
 = 
	`¢d_˘l_›í
(&
åül
.
h™dÀ
, "hw:0", 0);

732 i‡(
îr
 < 0)

733  
EXIT_FAILURE
;

735 
îr
 = 
	`¢d_˘l_subs¸ibe_evíts
(
åül
.
h™dÀ
, 1);

736 i‡(
îr
 < 0)

737  
EXIT_FAILURE
;

740 
i
 = 0; i < 
SND_CTL_ELEM_TYPE_LAST
; ++i) {

741 
åül
.
ty≥
 = 
i
 + 1;

744 
åül
.
ty≥
) {

745 
SND_CTL_ELEM_TYPE_BOOLEAN
:

746 
åül
.
ñemít_cou¡
 = 900;

747 
åül
.
membî_cou¡
 = 128;

748 
åül
.
add_ñem_£t
 = 
add_boﬁ_ñem_£t
;

749 
åül
.
check_ñem_¥›s
 = 
NULL
;

750 
åül
.
ch™ge_ñem_membîs
 = 
ch™ge_boﬁ_ñem_membîs
;

751 
åül
.
Æloˇã_ñem_£t_év
 =

752 
Æloˇã_boﬁ_ñem_£t_év
;

753 
åül
.
év_ªadabÀ
 = 
Ál£
;

755 
SND_CTL_ELEM_TYPE_INTEGER
:

756 
åül
.
ñemít_cou¡
 = 900;

757 
åül
.
membî_cou¡
 = 128;

758 
åül
.
add_ñem_£t
 = 
add_öt_ñem_£t
;

759 
åül
.
check_ñem_¥›s
 = 
check_öt_ñem_¥›s
;

760 
åül
.
ch™ge_ñem_membîs
 = 
ch™ge_öt_ñem_membîs
;

761 
åül
.
Æloˇã_ñem_£t_év
 =

762 
Æloˇã_öt_ñem_£t_év
;

763 
åül
.
év_ªadabÀ
 = 
Ál£
;

765 
SND_CTL_ELEM_TYPE_ENUMERATED
:

766 
åül
.
ñemít_cou¡
 = 900;

767 
åül
.
membî_cou¡
 = 128;

768 
åül
.
add_ñem_£t
 = 
add_íum_ñem_£t
;

769 
åül
.
check_ñem_¥›s
 = 
check_íum_ñem_¥›s
;

770 
åül
.
ch™ge_ñem_membîs
 = 
ch™ge_íum_ñem_membîs
;

771 
åül
.
Æloˇã_ñem_£t_év
 = 
NULL
;

772 
åül
.
év_ªadabÀ
 = 
Ál£
;

774 
SND_CTL_ELEM_TYPE_BYTES
:

775 
åül
.
ñemít_cou¡
 = 900;

776 
åül
.
membî_cou¡
 = 512;

777 
åül
.
add_ñem_£t
 = 
add_byãs_ñem_£t
;

778 
åül
.
check_ñem_¥›s
 = 
NULL
;

779 
åül
.
ch™ge_ñem_membîs
 = 
ch™ge_byãs_ñem_membîs
;

780 
åül
.
Æloˇã_ñem_£t_év
 =

781 
Æloˇã_byãs_ñem_£t_év
;

782 
åül
.
év_ªadabÀ
 = 
Ál£
;

784 
SND_CTL_ELEM_TYPE_IEC958
:

785 
åül
.
ñemít_cou¡
 = 1;

786 
åül
.
membî_cou¡
 = 1;

787 
åül
.
add_ñem_£t
 = 
add_õc958_ñem_£t
;

788 
åül
.
check_ñem_¥›s
 = 
NULL
;

789 
åül
.
ch™ge_ñem_membîs
 = 
ch™ge_õc958_ñem_membîs
;

790 
åül
.
Æloˇã_ñem_£t_év
 = 
NULL
;

791 
åül
.
év_ªadabÀ
 = 
Ál£
;

793 
SND_CTL_ELEM_TYPE_INTEGER64
:

795 
åül
.
ñemít_cou¡
 = 900;

796 
åül
.
membî_cou¡
 = 64;

797 
åül
.
add_ñem_£t
 = 
add_öt64_ñem_£t
;

798 
åül
.
check_ñem_¥›s
 = 
check_öt64_ñem_¥›s
;

799 
åül
.
ch™ge_ñem_membîs
 = 
ch™ge_öt64_ñem_membîs
;

800 
åül
.
Æloˇã_ñem_£t_év
 =

801 
Æloˇã_öt64_ñem_£t_év
;

802 
åül
.
év_ªadabÀ
 = 
Ál£
;

807 
îr
 = 
	`add_ñem_£t
(&
åül
);

808 i‡(
îr
 < 0) {

809 
	`¥ötf
("FailÅoáddánÉlement set with %sÅype.\n",

810 
	`¢d_˘l_ñem_ty≥_«me
(
åül
.
ty≥
));

813 
îr
 = 
	`check_evít
(&
åül
, 
SND_CTL_EVENT_MASK_ADD
,

814 
åül
.
ñemít_cou¡
);

815 i‡(
îr
 < 0) {

816 
	`¥ötf
("FailÅo check someÉventsÅoáddÉlements with "

818 
	`¢d_˘l_ñem_ty≥_«me
(
åül
.
ty≥
));

823 
îr
 = 
	`check_ñem_li°
(&
åül
);

824 i‡(
îr
 < 0) {

825 
	`¥ötf
("FailÅoÜistÉachÉlement with %sÅype.\n",

826 
	`¢d_˘l_ñem_ty≥_«me
(
åül
.
ty≥
));

831 
îr
 = 
	`check_ñem_£t_¥›s
(&
åül
);

832 i‡(
îr
 < 0) {

833 
	`¥ötf
("FailÅo checkÖroperties ofÉachÉlement with "

835 
	`¢d_˘l_ñem_ty≥_«me
(
åül
.
ty≥
));

843 
îr
 = 
	`check_ñems
(&
åül
);

844 i‡(
îr
 < 0) {

845 
	`¥ötf
("FailÅo change status ofÉachÉlement with %s "

847 
	`¢d_˘l_ñem_ty≥_«me
(
åül
.
ty≥
));

850 
îr
 = 
	`check_evít
(&
åül
, 
SND_CTL_EVENT_MASK_VALUE
,

851 
åül
.
ñemít_cou¡
);

852 i‡(
îr
 < 0) {

853 
	`¥ötf
("FailÅo check someÉventsÅo change status of "

855 
	`¢d_˘l_ñem_ty≥_«me
(
åül
.
ty≥
));

863 i‡(
åül
.
Æloˇã_ñem_£t_év
 !
NULL
) {

864 
îr
 = 
	`check_év
(&
åül
);

865 i‡(
îr
 < 0) {

866 
	`¥ötf
("FailÅo change TLV data ofánÉlement "

868 
	`¢d_˘l_ñem_ty≥_«me
(
åül
.
ty≥
));

874 
îr
 = 
	`¢d_˘l_ñem_ªmove
(
åül
.
h™dÀ
,Årül.
id
);

875 i‡(
îr
 < 0) {

876 
	`¥ötf
("FailÅoÑemoveÉlements with %sÅype.\n",

877 
	`¢d_˘l_ñem_ty≥_«me
(
åül
.
ty≥
));

880 
îr
 = 
	`check_evít
(&
åül
, 
SND_CTL_EVENT_MASK_REMOVE
,

881 
åül
.
ñemít_cou¡
);

882 i‡(
îr
 < 0) {

883 
	`¥ötf
("FailÅo check someÉventsÅoÑemoveÉach "

885 
	`¢d_˘l_ñem_ty≥_«me
(
åül
.
ty≥
));

890 i‡(
îr
 < 0) {

891 
	`¥ötf
("%s\n", 
	`¢d_°ªº‹
(
îr
));

894 
	`¢d_˘l_ñem_ªmove
(
åül
.
h™dÀ
,Årül.
id
);

895  
EXIT_FAILURE
;

898  
EXIT_SUCCESS
;

899 
	}
}

	@
1
.
0
239
17358
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/alsalisp/alsalisp.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/aserver/aserver.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/alisp.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/alsa-symbols.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/aserver.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/asoundef.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/asoundlib-head.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/asoundlib-tail.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/bswap.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/conf.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/control.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/control_external.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/control_plugin.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/error.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/global.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/hwdep.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/input.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/list.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/mixer.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/mixer_abst.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/output.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_external.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_extplug.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_ioplug.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_old.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_plugin.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/pcm_rate.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/rawmidi.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/search.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seq.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seq_event.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seq_midi_event.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/seqmid.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asequencer.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asoc.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asound.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/asound_fm.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/emu10k1.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/hdsp.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/hdspm.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/sb16_csp.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/sscape_ioctl.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/tlv.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/type_compat.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asequencer.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asoc.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asound.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/asound_fm.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/emu10k1.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/hdsp.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/hdspm.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/sb16_csp.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/sscape_ioctl.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sound/uapi/tlv.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/sys.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/timer.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/topology.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/type_compat.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/ump.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/ump_msg.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/include/use-case.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/ac97.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/hda.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/python.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/sbase.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/sbase.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/modules/mixer/simple/sbasedl.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/alisp/alisp.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/alisp/alisp_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/alisp/alisp_snd.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/async.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/conf.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/confeval.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/confmisc.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/cards.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_empty.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_ext.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_hw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_plugin.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_remap.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_shm.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/control_symbols.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/ctlparse.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/eld.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/hcontrol.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/namehint.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/setup.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/control/tlv.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/dlmisc.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/error.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep_hw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/hwdep/hwdep_symbols.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/input.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/bag.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/mixer.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/mixer_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/mixer_simple.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/simple.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/simple_abst.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/mixer/simple_none.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/names.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/output.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/interval.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/interval.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/interval_inline.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/ladspa.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/mask.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/mask.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/mask_inline.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_adpcm.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_alaw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_asym.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_copy.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_direct.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_direct.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_generic.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_i386.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_i386.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_x86_64.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dmix_x86_64.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dshare.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_dsnoop.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_empty.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_ext_parm.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_extplug.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_file.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_generic.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_generic.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_hooks.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_hw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_iec958.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_ioplug.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_ladspa.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_lfloat.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_linear.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_meter.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_misc.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_mmap.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_mmap_emul.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_mulaw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_multi.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_null.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_params.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_plug.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_plugin.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_plugin.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_rate.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_rate_linear.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_route.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_share.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_shm.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_simple.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_softvol.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/pcm_symbols.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/plugin_ops.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/pcm/scopes/level.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_hw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_symbols.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/rawmidi_virt.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/ump.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/rawmidi/ump_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_event.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_hw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_midi_event.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_old.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seq_symbols.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/seq/seqmid.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/shmarea.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/socket.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_hw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_query.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_query_hw.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/timer/timer_symbols.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/builder.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/channel.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/ctl.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/dapm.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/data.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/decoder.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/elem.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/log.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/ops.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/parser.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/pcm.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/save.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/text.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/topology/tplg_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/main.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/parser.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_cond.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_confdoc.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_exec.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_include.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_local.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_regex.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/ucm_subs.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/ucm/utils.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/src/userfile.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/audio_time.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/chmap.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/client_event_filter.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/control.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/latency.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/lsb/config.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/lsb/midi_event.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/lsb/test.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/midifile.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/midifile.h
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/midiloop.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/mixtest.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/namehint.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/oldapi.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/omixer.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/pcm-multi-thread.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/pcm.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/pcm_min.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/playmidi1.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/queue_timer.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/rawmidi.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/seq-decoder.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/seq-sender.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/seq.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/timer.c
/home/gaspa/kth/assert/galapagos/use_cases/alsa-lib/test/user-ctl-element-set.c
